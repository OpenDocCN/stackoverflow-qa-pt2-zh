# StackOverflow 问答 13088000-13088999

# python - 当输出填满python中的屏幕时如何停止程序？

> ID：13088000
> 
> 赞同：2
> 
> 时间：2012-10-26T13:36:32.950
> 
> 标签：python, user-interface, command-line-interface

如何从 Python 程序中获取终端的状态？我希望程序在屏幕已满时停止在屏幕上打印行并等待用户输入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T13:47:04.507

最简单（无代码）的方法是通过分页程序（如`less`或`more`（假设为 *nix））通过管道传输程序的输出，例如：

### 无穷大.py

```
import random

while 1:
   print random.randint(0, 0xffffffff) 
```

### 命令行

```
python infinty.py | less 
```

...给出如下输出：

```
848605718
899092472
2576425641
3098821373
259379057
164782822
416064876
2488878735
1216764788
2682214542
531576871
2175787865
869960770
: 
```

...并等待用户输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T13:39:19.233

如果您需要对终端窗口进行更多控制，并且假设您使用的是 Linux/*BSD/MacOSX，那么您将需要为此使用[curses](http://docs.python.org/howto/curses.html)。这只是一个简单的例子：

```
import curses
stdscr = curses.initscr()
stdscr.getmaxyx() #returns the width and height of the terminal screen
stdscr.getyx()    #returns the current x,y position. 
```

您应该查看库[参考](http://docs.python.org/library/curses.html)以获取更多功能。

# c# - 如何使用 NetOffice 重命名 Excel 工作表？

> ID：13088002
> 
> 赞同：2
> 
> 时间：2012-10-26T13:36:34.440
> 
> 标签：c#, excel, excel-interop

我正在尝试使用 NetOffice 在我的 c# 应用程序中创建 excel 工作簿，但在尝试重命名工作表和对单元格范围使用排序时遇到了麻烦。NetOffice 无法识别以下代码行，我正在努力寻找一种使用 NetOffice 重命名工作表和对单元格范围进行排序的方法。

```
workbook.Worksheets[sheetCountPlusONe].name = "Event " + sheetCountPlusONe.ToString() + " Results"; 
```

这也行不通。这是我声明和排序一系列单元格的地方：

```
Excel.Range valueRange;
Excel.Range placeRange;
placeRange = worksheet.get_Range("A14", "A" + (14 + (registrationForm.numberofCompetitors - 1)).ToString());
valueRange = worksheet.get_Range("A14", "K"+(14+(registrationForm.numberofCompetitors-1)).ToString());
valueRange.Sort(valueRange.Columns[3, Type.Missing], Excel.XlSortOrder.xlDescending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlGuess, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal);
placeRange.Sort(placeRange.Columns[1, Type.Missing], Excel.XlSortOrder.xlAscending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlGuess, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T00:06:21.213

我想知道你的问题。以下代码工作正常：

```
Excel.Application excelApplication = new Excel.Application();
Excel.Workbook workBook = excelApplication.Workbooks.Add();
Excel.Worksheet workSheet = workBook.Worksheets[1] as Excel.Worksheet;
workSheet.Name = "AnyNameYouWant"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-06T22:36:05.390

"sheetCountPlusOne" 是比您的集合大小大 1 的整数吗？您必须先添加工作表，然后才能重命名。

对于排序，我建议尽可能使用 .NET 4 的命名参数，并避免 Type.Missing 列表带来的麻烦。

# ios - 如何一次为很多文件添加-fobjc-arc

> ID：13088005
> 
> 赞同：3
> 
> 时间：2012-10-26T13:36:39.120
> 
> 标签：ios, xmpp, automatic-ref-counting

我想将 xmppframework 添加到我的项目中，如何一次将 -fobjc-arc 添加到所有 xmpp 文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T13:44:00.450

这并不完美，但通常足够好：

1.  选择项目窗口左上角的项目。
2.  选择目标。
3.  打开构建阶段窗格。
4.  选择“编译源”
5.  在过滤区域输入“xmpp”
6.  选择所需的文件。
7.  点击 Enter，然后在对话框中输入 -fobjc_arc。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T13:45:33.900

很简单，在您的编译器源代码中选择需要标志的第一项，向下滚动并在按住 shift 键的同时单击最后一项。然后，您所要做的就是双击任何一个突出显示的单元格并添加标志，当您按 Enter 时，它将应用于所有突出显示的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T13:40:28.517

据我所知，你不能这样做。你必须一次做一个文件。您可能想查看您的 name.xcodeproj 目录，也许您可​​以编辑 project.pbxproj 文件，尽管我不会这样做

# r - 如何仅选择R中具有相同值的行中的第一个元素？

> ID：13088011
> 
> 赞同：0
> 
> 时间：2012-10-26T13:36:58.477
> 
> 标签：r, selection

我有两个向量

```
 x<-c(1,1,1,2,2,2,3,3,4,5,5,6)
 y<-c("a","b","c","d","e","f","g","h","i","j","k","l") 
```

我只想选择 y 中的那些，它们与 x 中相等值序列中的第一个元素重合所以，在我的情况下，最终解决方案应该是这样的：

```
 y x
 1  a 1
 4  d 2
 7  g 3
 9  i 4
 10 j 5
 12 l 6 
```

我们编写了一个脚本，它可以工作，但需要添加和删除额外的行（以便稍后使用 cbind），这对我来说是一团糟。

```
aaa<-data.frame(y,x)
df<-NULL
for (i in 2:length(aaa$x)){   # you may see it stars from the second element because 
                               # of x[i-1]
   bbb<-ifelse((aaa$x[i]!= aaa$x[i-1]), aaa$x[i], NA)
     df<-rbind(df,bbb)
}
df
df<-rbind(1,df)
aaa$x<-df[,1]
bbb<-na.omit(aaa)
bbb 
```

我已经尝试应用 rle() ，因为它是我之前推荐的[如何只选择非中断号码？](https://stackoverflow.com/questions/12790378/how-to-choose-non-interruped-numbers-only) 但在这种情况下失败了。

很想听听你的建议，

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T13:44:25.903

这是一个简单的解决方案：

```
aaa <- data.frame(y, x)
aaa[!duplicated(aaa$x), ]

#    y x
# 1  a 1
# 4  d 2
# 7  g 3
# 9  i 4
# 10 j 5
# 12 l 6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T13:57:41.227

也许是这样的：

```
justFirst <- function(x, y){
    stopifnot(length(x) > 1 && length(y) > 1 && length(x) == length(y))
    newX <- newY <- vector()
    for (i in 1:length(x)){
        if (i == 1){
            newX <- c(newX, x[i])
            newY <- c(newY, y[i])
        }
        else{
            if (x[i] != x[i-1]){
                newX <- c(newX, x[i])
                newY <- c(newY, y[i])
            }
        }
    }
    return(data.frame(newX, newY))
}

x<-c(1,1,1,2,2,2,3,3,4,5,5,6)
y<-c("a","b","c","d","e","f","g","h","i","j","k","l")

justFirst(x, y) 
```

我把它放在这里作为替代方案，以防出现 x 和 y 看起来像这样（无序且混乱）的情况：

```
x<-c(1,1,1,2,1,2,3,3,4,5,5,6,7,4,4,4,4,3,2,3)
y<-c("a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t") 
```

但是，也许还有更好的方法来处理这种情况......

# sql-server-2012 - 从 DDL 脚本创建数据库

> ID：13088012
> 
> 赞同：3
> 
> 时间：2012-10-26T13:37:01.783
> 
> 标签：sql-server-2012, ddl

好的，这可能是个有点傻的问题，但我似乎找不到任何可行的参考来说明我需要什么。

我正在阅读 NHibernate 教程，并通过代码获得了这个 DDL 脚本数据库。我对 DDL 知之甚少，但老实说从未使用过它。所以我不知道如何在我的服务器上创建一个数据库。当然，我刚刚尝试运行它但没有任何反应（正如预期的那样......）。

注意：我正在运行 SQL Server 2012。

请帮忙，即使这可能太愚蠢而不能问。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T15:30:24.507

“DDL”代表“数据定义语言”；它是创建和修改模式对象的 SQL 语句的总称——诸如`CREATE TABLE ...`and`ALTER TABLE ...`之类`CREATE INDEX ...`的语句。（它与“DML”、“数据操作语言”相反，后者是仅修改这些对象中的数据*的*SQL 语句——诸如`INSERT INTO ...`、`UPDATE ...`和`DELETE ...`. 的语句）

您的`.ddl`文件可能只是一个由 DDL 语句组成的普通 SQL 脚本；该扩展`.ddl`是为了人类读者的利益，所以他们知道它是什么类型的 SQL 脚本。但是，如果您知道如何运行`.sql`脚本，那么您可能可以`.ddl`以相同的方式运行您的脚本。

（如果您担心，您可以先尝试`.ddl`在记事本中打开文件，并确认它包含的内容是`CREATE TABLE ...`–type 语句，然后再在数据库中实际运行它。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-18T07:23:16.470

如果你想要创建数据库的脚本，它应该是这种格式

```
CREATE TABLE <table name> ( 
    <attribute name 1> <data type 1>,
    ...
    <attribute name n> <data type n>
    ); 
```

*   用您的值完全替换尖括号及其内容*

参考：[http](http://www.tomjewett.com/dbdesign/dbdesign.php?page=ddldml.php) ://www.tomjewett.com/dbdesign/dbdesign.php?page= ddldml.php 祝你好运:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-12T21:16:02.457

这听起来可能很愚蠢，但我最近在 mssqlmm 中做了一些非常相似的事情，并且对于为什么我无法从我刚刚运行的脚本中找到新创建的数据库感到非常困惑。原来我只需要单击左侧窗格上的刷新按钮，它就会出现在数据库树中。

# c++ - 具有链接树结构的命令模式（使用指针）

> ID：13088015
> 
> 赞同：3
> 
> 时间：2012-10-26T13:37:11.717
> 
> 标签：c++, design-patterns, undo-redo

我正在为某种二叉树结构开发一个编辑器，我需要一个撤消功能。我考虑过使用命令模式来实现这一点。但是，我还没有找到一种方法来将命令模式与我的二叉树结构一起使用。

二叉树结构是通过指针组成的。所以一个节点知道它的父节点和子节点。当我现在想添加一个节点时，我会`NodeAdd`以父节点作为参数构造一个对象并将其传递给`UndoStack`. 为了删除现有节点，将使用指向as 参数的指针`NodeRemove`将对象传递给。两者，and都必须实现and （当对象放在时调用where ）。`UndoStack``Node``NodeAdd``NodeRemove``undo()``redo()``redo()``UndoStack`

我面临的问题是，处理删除节点然后撤消添加同一节点的情况：

1.  重做节点添加
2.  重做节点删除
3.  撤消节点删除
4.  撤消节点添加

一旦执行了*重做 NodeRemove*`Node` ，对象就会被销毁。在*undo NodeRemove*`Node`中，可以再次构造一个新对象，但无法执行*undo NodeAdd*，因为它没有指向新构造的指针`Node`。

我想我试图以错误的方式使用命令模式。我可能应该`Node`在命令的构造函数/析构函数中而不是在`undo()`/中销毁或构造对象`redo()`。不幸的是，我不知道如何使用这种结构来做到这一点，我能找到的所有示例和建议都与文本编辑或编辑没有带有指针的动态结构的东西有关。

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:59:51.510

命令模式可能不足以用于撤消。对于撤消，您应该使用 memento 模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:28:58.470

一种选择是让您的`Command`对象通过某个唯一标识符（例如表示为 a 的索引`size_t`）而不是通过内存地址来引用它们的操作数，正如您所发现的那样，内存地址可能会波动。

然后，通过维护某处（例如，例如`unordered_map< size_t, Node* >`静态成员），您的对象可以获得给定的当前实施例并根据需要添加/删除/操作它。`Node``Command``Node`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T19:20:18.447

模式可以组合，甚至在它们内部。给你的命令一个执行方法和一个撤销方法。调用命令时，将实例放入双向责任链中，具有撤消和重做方向和方法。

# objective-c - JSON iOS 中的图像

> ID：13088021
> 
> 赞同：-1
> 
> 时间：2012-10-26T13:37:30.763
> 
> 标签：objective-c, ios, json

我尝试将图像放入 中`JSON`，但如何将图像放入 中`NSData`？我得到的只是`__NSCFArray`我的二进制数据，但是如何转换它呢？

编辑：这是我在 json 中的结果

```
Printing description of resDict:
{
Details = "Foo";
GroupingInfo = LRU;
HeaderLeft = "Bar";
HeaderRight = "Foo";
Id = "cb217aeb-14e3-4bd5-8895-3217238deb2c";
IsGray = 0;
AnotherId = "<null>";
MainImage =     (
    137,
    80,
    78,
    71,
 ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:42:30.670

您首先必须解析 JSON，然后将二进制部分放入 NSData。UIImage 有一种方法可以将 NSData 更改为图像

```
UIImage *myimage = [UIImage imageWithData:mydata]; 
```

更新：（希望没人介意）在自己做了一个这样的演示后，NSJSONSerialization 总是返回字符串，并且在下面进行了一个小的来回对话之后。我尝试将图像作为 Base64 编码字符串发送并使用 base64 解码作为数据读回。这是一种魅力。

这是我使用的代码（因为它适用于所有 iOS 版本，从 3.0 及更高版本）：

NSData+PHBase64.h

```
@interface NSData (PHBase64)

+ (id)dataWithBase64EncodedString:(NSString *)string;     //  Padding '=' characters are optional. Whitespace is ignored.
- (NSString *)base64Encoding;
@end 
```

NSData+PHBase64.m

```
#import "NSData+Base64.h"

static const char encodingTable[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";

@implementation NSData (PHBase64)

+ (id)dataWithBase64EncodedString:(NSString *)string;
{
    if (string == nil)
        [NSException raise:NSInvalidArgumentException format:nil];
    if ([string length] == 0)
        return [NSData data];

    static char *decodingTable = NULL;
    if (decodingTable == NULL)
    {
        decodingTable = malloc(256);
        if (decodingTable == NULL)
            return nil;
        memset(decodingTable, CHAR_MAX, 256);
        NSUInteger i;
        for (i = 0; i < 64; i++)
            decodingTable[(short)encodingTable[i]] = i;
    }

    const char *characters = [string cStringUsingEncoding:NSASCIIStringEncoding];
    if (characters == NULL)     //  Not an ASCII string!
        return nil;
    char *bytes = malloc((([string length] + 3) / 4) * 3);
    if (bytes == NULL)
        return nil;
    NSUInteger length = 0;

    NSUInteger i = 0;
    while (YES)
    {
        char buffer[4];
        short bufferLength;
        for (bufferLength = 0; bufferLength < 4; i++)
        {
            if (characters[i] == '\0')
                break;
            if (isspace(characters[i]) || characters[i] == '=')
                continue;
            buffer[bufferLength] = decodingTable[(short)characters[i]];
            if (buffer[bufferLength++] == CHAR_MAX)      //  Illegal character!
            {
                free(bytes);
                return nil;
            }
        }

        if (bufferLength == 0)
            break;
        if (bufferLength == 1)      //  At least two characters are needed to produce one byte!
        {
            free(bytes);
            return nil;
        }

        //  Decode the characters in the buffer to bytes.
        bytes[length++] = (buffer[0] << 2) | (buffer[1] >> 4);
        if (bufferLength > 2)
            bytes[length++] = (buffer[1] << 4) | (buffer[2] >> 2);
        if (bufferLength > 3)
            bytes[length++] = (buffer[2] << 6) | buffer[3];
    }

    realloc(bytes, length);
    return [NSData dataWithBytesNoCopy:bytes length:length];
}

- (NSString *)base64Encoding;
{
    if ([self length] == 0)
        return @"";

  char *characters = malloc((([self length] + 2) / 3) * 4);
    if (characters == NULL)
        return nil;
    NSUInteger length = 0;

    NSUInteger i = 0;
    while (i < [self length])
    {
        char buffer[3] = {0,0,0};
        short bufferLength = 0;
        while (bufferLength < 3 && i < [self length])
            buffer[bufferLength++] = ((char *)[self bytes])[i++];

        //  Encode the bytes in the buffer to four characters, including padding "=" characters if necessary.
        characters[length++] = encodingTable[(buffer[0] & 0xFC) >> 2];
        characters[length++] = encodingTable[((buffer[0] & 0x03) << 4) | ((buffer[1] & 0xF0) >> 4)];
        if (bufferLength > 1)
            characters[length++] = encodingTable[((buffer[1] & 0x0F) << 2) | ((buffer[2] & 0xC0) >> 6)];
        else characters[length++] = '=';
        if (bufferLength > 2)
            characters[length++] = encodingTable[buffer[2] & 0x3F];
        else characters[length++] = '=';    
    }

    return [[NSString alloc] initWithBytesNoCopy:characters length:length encoding:NSASCIIStringEncoding freeWhenDone:YES];
}

@end 
```

# html - 画布单线，形状为笔划

> ID：13088030
> 
> 赞同：1
> 
> 时间：2012-10-26T13:37:58.137
> 
> 标签：html, canvas

我正在使用 HTML5 Canvas 开发一个显示形状集合的应用程序。在每个形状上，我希望其中一个形状边有一个笔触，但是如果不给所有边一个笔触或使用单独的线条并破坏形状，阻止它进行填充，就无法做到这一点。

我将如何绘制一个在一侧有一个笔触和一个填充的形状？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:45:04.143

一种方法是在您没有完全完成路径时调用 stroke ，从而只抚摸您已经绘制的内容。显然，如果你不先画出你想要抚摸的边，这是行不通的，所以下面还有另一个选项。

```
​var canvas = document.getElementById("canvas"),
    ctx = canvas.getContext("2d");

canvas.width = canvas.height = 256;

​ctx.fillStyle = "red";
ctx.strokeStyle = "black";
ctx.lineWidth = 2;

ctx.beginPath();
ctx.moveTo(50,50);
ctx.lineTo(100,100);
ctx.stroke();
ctx.lineTo(100,200);
ctx.lineTo(50,100);
ctx.lineTo(50,50);
ctx.fill(); 
```

**​<a href="http://jsfiddle.net/BVtLL/" rel="nofollow">现场演示**

这只是一个快速的概念验证功能，作为实现您正在寻找的另一种方式。

**[现场演示 2](http://jsfiddle.net/BVtLL/1/)**

```
var shape = [{x:50,y:50}, {x:100, y:100}, {x:100, y:200}, {x:50,y:100}, {x:50, y:50}];

function drawShape(shape, strokeIndex){
    ctx.beginPath();
    ctx.moveTo(shape[0].x, shape[0].y);

    for(var i = 1; i < shape.length; i++){
        ctx.lineTo(shape[i].x, shape[i].y);   
    }
    ctx.closePath();
    ctx.fill();

    // stroke
    ctx.beginPath();
    ctx.moveTo(shape[strokeIndex-1].x, shape[strokeIndex-1].y);
    ctx.lineTo(shape[strokeIndex].x, shape[strokeIndex].y);
    ctx.stroke();
}

drawShape(shape, 3); 
```

​</p>

# c# - 在 WinRT 中使用 RichTextBlock 或其他组件显示 Html

> ID：13088034
> 
> 赞同：10
> 
> 时间：2012-10-26T13:38:46.587
> 
> 标签：c#, html, windows-8, windows-runtime, converter

我想用一些组件在字符串中显示 html。现在我正在使用 RichTextBlock 并且我尝试了一些将 html 转换为 xaml 或 rtf 的扩展，但我没有发现任何可以使用 WinRT。我知道我可以使用 WebView，但它不是那么漂亮。我只想对`ItemDetailPage`（使用 RichTextBlock 的地方）做些小改动，以向用户展示基本的 html（粗体、斜体、链接、图像……）。

是否有一些组件或某种方式可以做到这一点（不是 webview）？还是有工作转换器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T20:20:44.997

我终于厌倦了缺乏 WinRT 支持的 Html 到 Xaml 的转换并编写了我自己的。为了好玩，我把它放在[codeplex](http://winrthtml2xaml.codeplex.com/)上。为了更进一步，为了试验 NuGet，我也在那里发布了它......

显然，这不是 Html 到 Xaml 转换的全部结束，但它是一个开始......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T10:34:08.917

你有两种方式

1.  构建或获取您自己的 html 到 xaml 解析器以将内容用作 RichTextBox 源
2.  使用 WebView 显示 html 内容

我推荐 WebView 因为这个组件有很多特性很难作为解析器实现

*   javascript 支持
*   CSS 支持
*   不良格式（真实世界）html 支持
*   ETC

因此，在 WebView 控件中，您可以使用 WebView.NavigateToString 方法来显示存储在字符串中的 html 内容。

你甚至可以修改字符串以更改样式、添加脚本等，因为您需要自定义 webview 的外观和感觉。

NavigateToString 不支持绑定，但我写了一篇文章（西班牙语）教如何使用附加属性：http: [//blogs.msdn.com/b/juank/archive/2012/10/29/tutorial-crear-app-讲师-rss-winrt-parte-7.aspx](http://blogs.msdn.com/b/juank/archive/2012/10/29/tutorial-crear-app-lector-rss-winrt-parte-7.aspx)

**使用此代码（plex）进行解析**，如果它不完全适合您可以更改您自己的代码。;) [http://html2xaml.codeplex.com/](http://html2xaml.codeplex.com/)

否则，您将自己创建 ode，如果您想在列文本中分页（横向阅读），您必须使用 RichTextBlock，使用 RichTextColumns hepler 类（当您从模板启动应用程序时包含在 Common/ 文件夹中）并尝试解析HTML 到 XAML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-22T08:01:40.447

我已经实现了一个解析 HTML 并使用本机控件呈现 HTML 的库。该组件非常灵活且可扩展。

看一下：

*   [http://mytoolkit.codeplex.com/wikipage?title=HtmlTextBlock](http://mytoolkit.codeplex.com/wikipage?title=HtmlTextBlock)

# twilio - Twilio 是否有用于向我的帐户添加资金的 API？

> ID：13088038
> 
> 赞同：3
> 
> 时间：2012-10-26T13:39:33.103
> 
> 标签：twilio

如何使用 Twilio API 补充我的 Twilio 帐户余额？有没有办法使用 API 以编程方式做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T17:17:16.550

无法使用 API 充值/补充您的 Twilio 帐户余额。从 Twilio 网站，如果您登录到您的帐户：

[https://www.twilio.com/login](https://www.twilio.com/login)

在右上角选择您的姓名，将出现一个下拉菜单，其中包含一个名为“结算设置和历史记录”的选项。单击此选项，您将进入计费页面，您可以在其中配置自动充值选项。

因此，一旦余额降至指定阈值以下，您就可以让您的帐户自动充值至指定值。

**自动充值网址**

[https://www.twilio.com/user/billing/auto-recharge](https://www.twilio.com/user/billing/auto-recharge)

# vb.net - .net Word 互操作关闭问题

> ID：13088039
> 
> 赞同：2
> 
> 时间：2012-10-26T13:39:34.410
> 
> 标签：vb.net, ms-word, office-interop

我正在 vb.net 中开发一个应用程序，`Microsoft.Office.Interop.Word`用于在 Word 文档中打印输出。如果我关闭应用程序，我想关闭文档（使用“另存为...”对话框）。如果用户想在应用程序结束之前关闭文档，这应该是可能的。一切似乎都很好，但是在关闭之后（在这两种情况下）我得到了这个错误：

> 此文件正被其他应用程序或用户使用。
> 
> (C:...\Templates\Normal.dotm)

我认为问题在于文档所有者是应用程序，因此用户无法关闭它......但是当应用程序关闭文档时也会发生错误（使用退出方法）。我运行的代码`frmMain_FormClosing`是：

```
If _objWord IsNot Nothing Then
    Try
        _objWord.Quit()
        System.Runtime.InteropServices.Marshal.FinalReleaseComObject(_objDoc)
        System.Runtime.InteropServices.Marshal.FinalReleaseComObject(_objWord)
    Catch ex As Exception
    End Try
End If 
```

我对 Excel 做同样的事情，我没有任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-03T05:41:01.020

添加文档时，请确保使用

```
Dim d As Word.Document = w.Documents.Add() 
```

并不是

```
d = New Word.Document 'this syntax can cause a memory leak!' 
```

# c# - 实体框架对象集

> ID：13088041
> 
> 赞同：0
> 
> 时间：2012-10-26T13:39:37.940
> 
> 标签：c#, entity-framework, c#-4.0

快速提问。采用我为我的 EF 存储库编写的以下方法：

```
public virtual IEnumerable<T> SelectWhere(Expression<Func<T, bool>> predicate)
{
    using (CAMHS_DB db = new CAMHS_DB())
    {
        return db.CreateObjectSet<T>().Where(predicate).ToList<T>();
    }
} 
```

EF 会在我的谓词进入数据库之前应用我的谓词并使用它只返回我要求的记录，还是会返回所有内容然后应用谓词？

谢谢，威尔基。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:20:33.643

在您的代码示例中，他将使用谓词作为 select 语句的一部分并仅选择询问的记录。

但是，您应该知道，在使用“ToList()”方法之后，如果您将从该方法中获取返回值并对其使用“Where”扩展方法，它将与已经存在的数据相冲突记忆。

# php - 如何附加长的html代码？

> ID：13088044
> 
> 赞同：0
> 
> 时间：2012-10-26T13:39:43.760
> 
> 标签：php, jquery

以下代码可以将 div 元素添加到正文中。但有时 HTML 很长。如果它很长，比如 300 行 html 代码，那么这样写就很难了：

```
$("body").append($("<div id='dzndiv'><div style='position:absolute;left:0px;top:0px;width:100%;height:800px;'><img src='img/transparent.png' width='100%' height='100%'/></div>"); 
```

我认为应该是这样的：

```
$("body").append($.load("longstuff.html"); 
```

我怎样才能做到这一点？但重要的是 html 代码在标签之间可以有空格。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T13:41:07.850

你可以使用这个：

```
$.get('longstuff.html', function(data) {
    $('body').append(data);
}, 'html'); 
```

但是，如果您总是/经常需要该 HTML 并且它是静态的，那么在不通过 AJAX 加载它的情况下存储它的一种非常常见的方法是使用脚本标签：

```
<script type="text/html" id="long-stuff">
    <!-- simply put your HTML here -->
</script> 
```

然后您可以通过以下方式访问它`$('#long-stuff').html()`

根据您要执行的操作，另一种选择是简单地将 HTML 放在它所属的位置并使用它隐藏它`style="display: none;"`，然后再隐藏它`.show()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T19:05:58.357

$.get('longstuff.html', function(data) {data=data.replace(/> 此代码可以删除html代码中的所有空格，并将html代码附加到现有的body标签中。感谢所有的asnwers。

# actionscript-3 - as3 XMLSocket 不请求策略文件

> ID：13088049
> 
> 赞同：5
> 
> 时间：2012-10-26T13:39:55.570
> 
> 标签：actionscript-3

我在这里找到了很多类似的帖子，但似乎都没有解决我遇到的确切问题。

我只是想将一个 XMLSocket 连接到我的服务器，在我尝试连接大约 10 秒后，我收到一个 SecurityErrorEvent：错误 #2048：安全沙箱违规（无法从 ##.##.##.## 加载数据： 9024）。

在服务器端，我有一个侦听端口 9024 的 php 脚本。我很确定它工作正常，因为我可以使用其他 php 脚本连接到它。此外，当我的客户端 php 发出策略文件请求时，我的服务器脚本会返回该策略。这是as3：

```
private var sock:XMLSocket  = new XMLSocket();

// in my connection method
Security.allowDomain("domain.com");
Security.loadPolicyFile("dubDomain.domain.com/crossdomain.xml");
Security.loadPolicyFile("xmlsocket://domain.com:9024");
sock.connect("11.11.11.11", 9024); 
```

在调用 sock.connect 之前，我在 as3 中将侦听器设置为套接字，但我认为任何错误都会在它们被触发之前发生。

我的理解是，在第二个 Security.loadPolicyFile 或 socket.connect 应该尝试连接到套接字 9024 的服务器并请求策略文件。我相信 sock.connect 只会在无法从端口 843 获得响应后发送请求。

但是，在服务器端，它显示没有尝试连接。我已经从 IDE（FlashDevelop）和上传到服务器时从 swf 尝试过这个。

我会在端口 843 上尝试它，但我在我的服务器上没有管理员权限。如果重要的话，这里有一些 php 脚本：

```
$client = socket_accept($sock);
if (socket_getpeername($client, $address, $theirport))
{
echo "Client $address: $theirport is now connected to us\n";
}
$input = socket_read($client, 1024000);
echo "[client] $input"; 
```

$sock 似乎设置得很好，因为我可以使用另一个 php 脚本进行连接，但是当我尝试连接 as3 时它只会永远等待。

有什么建议么？我是不是误会了什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:51:14.973

```
Security.loadPolicyFile("subDomain.domain.com/crossdomain.xml");
sock.connect("11.11.11.11", 9024); 
```

您正在为子域请求跨域文件。它最多允许您连接到 subdomain.domain.com。它绝对不允许您连接到 domain.com。

XMLSocket 会做什么，是加载它认为可以的跨域，与你给它的主机 ip 相关。这将是第一个在`11.11.11.11/crossdomain.xml`。如果找不到，它会尝试访问`11.11.11.11:843`. 如果失败，您将抛出一个安全错误。

因此，您要么需要直接连接到您的子域：

```
 sock.connect("subDomain.domain.com", 9024); 
```

或者添加一个 crossdomain.xml，它允许您在 11.11.11.11:9024 上连接 11.11.11.11/crossdomain.xml ：

```
<allow-access-from domain="YOURSWFDOMAIN" to-ports="9024"/> 
```

然后，您将在服务器上收到来自 flash 的请求。那你可以走了。

# ajax - 通过用户控件调用父类中的子对象时的空对象引用

> ID：13088051
> 
> 赞同：0
> 
> 时间：2012-10-26T13:39:58.110
> 
> 标签：ajax, vb.net, user-controls

我有一个包含 LinkBut​​ton 的用户控件，单击该控件时会调用父类中的子类。当我单击 LinkBut​​ton 时，该子被调用 OK，但该子中引用的对象都触发了空对象引用错误。我究竟做错了什么？

为了使事情尽可能简短，我只在他们的类中显示相关的子项。

这是用户控件的**LinkClick**子：

```
Public Class Dashboard
    Inherits System.Web.UI.UserControl

        ...(Other code here)...

        Private Sub LinkClick(sender As Object, e As CommandEventArgs)

            Dim action = e.CommandArgument
            Dim cls As New MainPage
            cls.Dashboard_Clicked(action)

        End Sub
End Class 
```

这是通过 LinkClick 调用子类的父类：

```
Imports System.IO

Public Class MainPage
    Inherits System.Web.UI.UserControl

    ...(Other code here)...

    Public Sub Dashboard_Clicked(action)

        mpe.Show()

    End Sub

End Class 
```

这是父控件上的标记，它显示了用户控件的标记和我在子控件中尝试引用失败的对象的标记：

```
<%@ Control Language="vb" AutoEventWireup="false" CodeBehind="TSEnterHours.ascx.vb"
Inherits="App.MainPage" %>
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %>
<%@ Register Src="Dashboard.ascx" TagName="Dashboard" TagPrefix="uc" %>

<uc:Dashboard SourceProcName="Dashboard.QueryName" runat="server">
    <DashboardParameters>
        <dashboardparameter name="aID" useenvironmentvalue="aID" />
    </DashboardParameters>
    <Items>
        <item type="hyperlink" Action="PTO_Clicked" label="YTD PTO Taken" field="TotalPTO" />
    </Items>
</uc:Dashboard>

<!-- Other code... -->

<asp:ModalPopupExtender ID="mpe" runat="server" TargetControlID="btnDummy" PopupControlID="PTOPanel"
BackgroundCssClass="ModalPopupBG" OkControlID="btnDummy" CancelControlID="btnDummy"
BehaviorID="mpeBehavior_PTO" /> 
```

顺便说一句，“父”类本身就是一个在选项卡容器内操作的用户控件。我不认为这有什么不同，但我认为我应该提一下以防万一。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T16:27:03.170

正如 WozzeC 所说，新 MainPage 意味着它与 Dashboard 实例相关联，而不是其父级。

目前我对网络内容不太感兴趣，但我想说 MainPage 包含一个仪表板。如果是这种情况，更好的设计是为 Dashboard 提供对 MainPage 的引用，然后使用该引用调用 Dashboard_Clicked() 方法。

或者也许让 Dashboard 引发 MainPage 可以监听的事件？

# javascript - Google 字体无法正确加载

> ID：13088055
> 
> 赞同：0
> 
> 时间：2012-10-26T13:40:09.060
> 
> 标签：javascript, html, css, google-webfonts

有人可以帮我检查一下吗？

在除 Firefox 之外的所有浏览器中定义的行为是 web 字体在加载之前是不可见的（但节省了空间）。

在我可以测试的 Chrome 和 IE9 中，您可以看到一个奇怪的错误，IE9 将其展示得最好。

页面加载时，会显示标题文本，然后在加载 Web 字体时将其变为不可见一秒钟。

奇怪的是，我相信最先闪现的字体是网页字体。

由于刷新，我发现它在 Chrome 中有点难以看到，而在 IE9 上，背景不会刷新，因此您可以很容易地看到文本变得古怪。

这是我正在处理的演示站点的链接：-----

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:46:49.957

像这样使用

```
<link href='http://fonts.googleapis.com/css?family=BenchNine' rel='stylesheet' type='text/css'>

use this in css font-family: 'BenchNine', sans-serif; 
```

简单的

# ios - Openssl 编译错误在 cryptlib.c:117 包含的文件中：cryptlib.h:62:20：错误：stdlib.h：没有这样的文件或目录

> ID：13088061
> 
> 赞同：1
> 
> 时间：2012-10-26T13:40:27.940
> 
> 标签：ios, openssl

我尝试使用此[http://x2on.de/2010/12/16/tutorial-script-for-building-openssl-for-ios-iphoneipad/](http://x2on.de/2010/12/16/tutorial-script-for-building-openssl-for-ios-iphoneipad/)编译 openssl 库，但得到了

```
In file included from cryptlib.c:117:
cryptlib.h:62:20: error: stdlib.h: No such file or directory
cryptlib.h:63:20: error: string.h: No such file or directory
In file included from cryptlib.h:65,
                 from cryptlib.c:117:
../e_os.h:444:30: error: unistd.h: No such file or directory
../e_os.h:449:29: error: sys/types.h: No such file or directory
In file included from cryptlib.h:72,
                 from cryptlib.c:117:
../include/openssl/crypto.h:125:19: error: stdio.h: No such file or directory
In file included from cryptlib.h:72,
                 from cryptlib.c:117:
../include/openssl/crypto.h:175: error: expected specifier-qualifier-list before ‘size_t’
../include/openssl/crypto.h:465: warning: parameter names (without types) in function declaration
../include/openssl/crypto.h:465: error: expected declaration specifiers or ‘...’ before ‘size_t’
../include/openssl/crypto.h:466: warning: parameter names (without types) in function declaration
../include/openssl/crypto.h:467: error: expected ‘)’ before ‘const’
../include/openssl/crypto.h:468: error: expected ‘;’, ‘,’ or ‘)’ before ‘void’
../include/openssl/crypto.h:470: error: expected ‘)’ before ‘const’
../include/openssl/crypto.h:471: error: expected ‘;’, ‘,’ or ‘)’ before ‘void’
../include/openssl/crypto.h:477: warning: parameter names (without types) in function declaration
../include/openssl/crypto.h:477: error: expected declaration specifiers or ‘...’ before ‘size_t’
../include/openssl/crypto.h:478: warning: parameter names (without types) in function declaration
../include/openssl/crypto.h:479: error: expected ‘)’ before ‘const’
../include/openssl/crypto.h:480: error: expected ‘;’, ‘,’ or ‘)’ before ‘void’
../include/openssl/crypto.h:482: error: expected ‘)’ before ‘const’
../include/openssl/crypto.h:483: error: expected ‘;’, ‘,’ or ‘)’ before ‘void’
../include/openssl/crypto.h:500: error: expected declaration specifiers or ‘...’ before ‘size_t’
../include/openssl/crypto.h:535: error: expected ‘)’ before ‘*’ token
In file included from cryptlib.h:74,
                 from cryptlib.c:117:
../include/openssl/bio.h:634: error: expected ‘)’ before ‘*’ token
../include/openssl/bio.h:706: error: expected ‘)’ before ‘*’ token
../include/openssl/bio.h:707: error: expected ‘)’ before ‘*’ token
In file included from ../include/openssl/err.h:127,
                 from cryptlib.h:75,
                 from cryptlib.c:117:
../include/openssl/lhash.h:186: error: expected declaration specifiers or ‘...’ before ‘FILE’
../include/openssl/lhash.h:187: error: expected declaration specifiers or ‘...’ before ‘FILE’
../include/openssl/lhash.h:188: error: expected declaration specifiers or ‘...’ before ‘FILE’
In file included from cryptlib.h:75,
                 from cryptlib.c:117:
../include/openssl/err.h:140:19: error: errno.h: No such file or directory
In file included from cryptlib.h:75,
                 from cryptlib.c:117:
../include/openssl/err.h:343: error: expected ‘)’ before ‘*’ token
cryptlib.c: In function ‘CRYPTO_THREADID_set_numeric’:
cryptlib.c:430: warning: incompatible implicit declaration of built-in function ‘memset’
cryptlib.c: In function ‘CRYPTO_THREADID_set_pointer’:
cryptlib.c:441: warning: incompatible implicit declaration of built-in function ‘memset’
cryptlib.c: In function ‘CRYPTO_THREADID_current’:
cryptlib.c:507: error: ‘errno’ undeclared (first use in this function)
cryptlib.c:507: error: (Each undeclared identifier is reported only once
cryptlib.c:507: error: for each function it appears in.)
cryptlib.c: In function ‘CRYPTO_THREADID_cpy’:
cryptlib.c:518: warning: incompatible implicit declaration of built-in function ‘memcpy’
cryptlib.c: In function ‘OPENSSL_showfatal’:
cryptlib.c:906: error: ‘stderr’ undeclared (first use in this function)
cryptlib.c: In function ‘OpenSSLDie’:
cryptlib.c:918: warning: incompatible implicit declaration of built-in function ‘abort’
cryptlib.c: In function ‘OPENSSL_stderr’:
cryptlib.c:926: error: ‘stderr’ undeclared (first use in this function)
make[1]: *** [cryptlib.o] Error 1
make: *** [build_crypto] Error 1
What can I fix it 
```

如果您知道请帮助我，请如何解决此错误。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-02T07:38:40.990

> 我尝试使用此[http://x2on.de/2010/12/16/tutorial-script-for-building-openssl-for-ios-iphoneipad/](http://x2on.de/2010/12/16/tutorial-script-for-building-openssl-for-ios-iphoneipad/)编译 openssl 库，但得到了

您的问题是由于路径和 sysroot 问题造成的。从外观上看，该脚本是一个可怕的 hack。

OpenSSL 项目有一个脚本，用于设置环境并为 iOS 设备构建库。你可以在这里找到它：[setenv-ios,sh](http://wiki.openssl.org/images/a/ac/Setenv-ios-11.sh.tar.gz)。不幸的是，网络上或其 wiki 中没有文档。[OpenSSL FIPS 用户指南 2.0](http://openssl.org/docs/fips/UserGuide-2.0.pdf%E2%80%8E)对此进行了介绍（请参阅附录 E）。

这是我用来构建库（使用脚本）的配方。确保 OpenSSL tar 球和脚本位于同一目录中（下面的“根”目录）。

```
# Start fresh
$ rm -rf openssl-1.0.1e/
$ chmod a+x setenv-ios-11.sh

# From the 'root' directory
$ . ./setenv-ios-11.sh
$ tar xzf openssl-1.0.1e.tar.gz
$ cd openssl-1.0.1e/

$ perl -pi -e 's/install: all install_docs install_sw/install:install_docs install_sw/g' Makefile.org
$ ./config shared -no-ssl2 -no-ssl3 -no-comp -no-hw -no-engine --openssldir=/usr/local/ssl/ios-6.1

$ make depend
$ make all
$ sudo -E make install 
```

一定要包括前导“。” (dot) 设置环境时。安装后，您的头文件和库将位于`/usr/local/ssl/ios-6.1`.

如果您有任何问题，请查阅[OpenSSL FIPS 用户指南 2.0](http://openssl.org/docs/fips/UserGuide-2.0.pdf%E2%80%8E)，但忽略 FIPS 相关内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T00:23:28.377

取决于你需要什么，你可以考虑在你的项目中使用 Cocoapods，然后你可以像这样使用 pod：[https ://github.com/krzak/OpenSSL](https://github.com/krzak/OpenSSL)

只需添加到 Podfile：

```
pod 'OpenSSL', :podspec => 'https://raw.github.com/krzak/OpenSSL/master/OpenSSL.podspec' 
```

并进行编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-17T09:19:17.047

如果您同时安装了 Windows SDK 10 和 Windows Driver SDK 10，也可能会发生该错误。在这种情况下，VCVARS 似乎会设置错误的包含路径

# php - Drupal 导入文件

> ID：13088062
> 
> 赞同：0
> 
> 时间：2012-10-26T13:40:36.803
> 
> 标签：php, drupal, import, drupal-7, drupal-modules

我已经使用 Drupal 大约一个月了，我非常喜欢它所做的很多事情......但是，它处理文件的方式不是我喜欢的东西，它正在导致我为自己构建的媒体服务器感到头疼。

我的本地磁盘上有几千个视频文件（请记住，这是一台 Windows 机器，drupal 安装到 C: 并且我想要的文件在 D:) 我希望 Drupal 为我服务。

这是我到目前为止所做的：

1.  我编写了一个 python 脚本，它从我的文件所在的视频目录中解析成 csv 格式的相关信息。它输出一个分类文件和一个视频文件（带有名称/文件路径/父标签）。

2.  使用 Feed 正确导入了分类。

3.  把我的头撞在墙上几个小时，试图弄清楚如何让 Feed 消化我的视频 csv 文件（名称、文件路径、parent_tag）来跟踪我的视频而不将它们从当前目录中移动

我对您的简单问题是：如何让 Drupal 提供这些视频文件，而无需将所有文件复制到 public:// 或 private:// 目录。我希望文件保存在 D: 上，而 Drupal 保存在 C: 上。目前，我有一个我想要跟踪的所有视频的 CSV，其中包含我想要放入视频内容类型的相关数据。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T22:16:17.133

如果您使用标准提要文件处理，我不知道您是否可以阻止它移动/复制文件。但是您可能会在指向您的 D 驱动器的文件目录中创建一个符号链接。然后文件将在 D: 上结束。windows下使用mklink命令创建链接。您可能需要先将文件移动到一个临时目录，以免它试图覆盖每个文件。

# c++ - 如何在不使用键或同时关闭的情况下更新 cv::namedWindow

> ID：13088068
> 
> 赞同：2
> 
> 时间：2012-10-26T13:40:54.243
> 
> 标签：c++, opencv

我在 C++ 中使用 opencv，我有一个问题。

我想显示一个`cv::Mat`图像，这很容易使用`cv::imshow`和`cv::namedWindow`。但我希望能够看到它并能够`cv::Mat`同时更新。

实际上，我想经常（自动）运行创建图像的代码，并且我想在窗口中查看图像的更新版本。此窗口显示在投影仪上，并且每时每刻都应该有一个最新的图像可见。当代码完成后，我希望能够看到最后一张图像，直到我关闭那个窗口。

我的代码的简化版本：

```
for (int i=1; i < 1000; ++i){
cv::Mat output_projector = cv::Mat::zeros(480, 848, CV_8UC3);
//..
//change the output_projector
//..
cv::namedWindow("Send to projector", CV_WINDOW_AUTOSIZE|CV_WINDOW_FREERATIO);
cv::imshow("Send to projector", output_projector);
cv::waitKey(1);
} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:11:39.363

就像你做的那样，但尝试在 waitKey 参数中增加一点时间。例如，标准电影是 25 fps，即 4 毫秒，因此请尝试 waitKey(4)，如果太快则使用更大的值。

为了在最后看到你的图像，你应该在循环之前初始化它（顺便说一下窗口），并`waitKey(0)`最终调用。

```
cv::Mat output_projector = cv::Mat::zeros(480, 848, CV_8UC3);
cv::namedWindow("Send to projector", CV_WINDOW_AUTOSIZE|CV_WINDOW_FREERATIO);

for (int i=1; i < 1000; ++i){
//..
//change the output_projector
//..
cv::imshow("Send to projector", output_projector);
cv::waitKey(10);
}
cv::imshow("Send to projector", output_projector);
cv::waitKey(0); 
```

# php - php循环通过scandir输出不同的文件名

> ID：13088069
> 
> 赞同：0
> 
> 时间：2012-10-26T13:40:58.300
> 
> 标签：php, mysql, loops, scandir

我正在尝试生成稍后将插入的 SQL 命令列表。此时我似乎被困住的唯一部分是循环文件名。我需要我的 scandir 循环遍历 nofilter 目录并在每次给出新行或 sql 查询时更改 $image。我有下面的代码和输出。基本上没有 sql 查询应该有相同的 $image 被回显到其中

```
for ($i=1351314000; $i<=1351400400; $i+= 14400) {
    $images = scandir("/home/fb/public_html/post/uploads/nofilter/");
    foreach($images as $image) {

    }

//copy file over from no filter
$orig = "/home/fb/public_html/post/uploads/nofilter/".$image."";
$dest =   "/home/fb/public_html/post/uploads/".$image."";
//copy($orig, $dest);

//output
  echo "The number is " . $i . "<br />";
echo $image;
echo "<br>";
echo "<br>";
echo "<br>";

echo "

INSERT INTO `fb_fb`.`postcron_schedule` (
`id` ,
`status_message` ,
`link` ,
`photo_url` ,
`status_name` ,
`status_caption` ,
`status_description` ,
`uid` ,
`page_id` ,
`access_token` ,
`post_to` ,
`status_type` ,
`schedule_type` ,
`is_process` ,
`process_time` ,
`process_at` ,
`display_time` ,
`created_by`
)
VALUES (
NULL , '', '', '/home/fb/public_html/post/includes/../uploads/". $image ."', NULL , NULL , NULL , '0', '135031429962113', 'AAAGLZAMh7YSUBALRMCW60Rdol1kD80ZBNymqkgyQfBXDour2KsvVWKFcnZB9cU9OSLRMQjnEuKHZCTNoTZC4jf9GFtMU11BTD8JZAUFl0EVgZDZD', 'page', 'photo', 'schedule', '0', '". $i ."', NULL , '". $i ."', '100000103637895'
);
";

echo "<br>";
echo "<br>";

 } 
```

输出看起来像这样

```
号码是1351314000 8120925654_4041b7c50f_o.jpg

插入`fb_fb`.`postcron_schedule`（`id`，`status_message`，`link`，`photo_url`，`status_name`，`status_caption`，`status_description`，`uid`，`page_id`，`access_token`， `post_to`，`status_type`，`schedule_type`，`is_process`，`process_time`，`process_at`，`display_time`，`created_by`）值（NULL，''，''，'/home/fb/public_html/交/包括/../上传/ 8120925654_4041b7c50f_o.jpg 'NULL，NULL，NULL， '0'， '135031429962113'， 'AAAGLZAMh7YSUBALRMCW60Rdol1kD80ZBNymqkgyQfBXDour2KsvVWKFcnZB9cU9OSLRMQjnEuKHZCTNoTZC4jf9GFtMU11BTD8JZAUFl0EVgZDZD'， '页'， '照片'， '日程'， '0'，' 1351314000 ', NULL , '1351314000', '100000103637895' );

号码是1351328400 8120925654_4041b7c50f_o.jpg

插入`fb_fb`.`postcron_schedule`（`id`，`status_message`，`link`，`photo_url`，`status_name`，`status_caption`，`status_description`，`uid`，`page_id`，`access_token`， `post_to`，`status_type`，`schedule_type`，`is_process`，`process_time`，`process_at`，`display_time`，`created_by`）值（NULL，''，''，'/home/fb/public_html/交/包括/../上传/ 8120925654_4041b7c50f_o.jpg 'NULL，NULL，NULL， '0'， '135031429962113'， 'AAAGLZAMh7YSUBALRMCW60Rdol1kD80ZBNymqkgyQfBXDour2KsvVWKFcnZB9cU9OSLRMQjnEuKHZCTNoTZC4jf9GFtMU11BTD8JZAUFl0EVgZDZD'， '页'， '照片'， '日程'， '0'，' 1351328400 ', NULL , '1351328400', '100000103637895' );

号码是1351342800 8120925654_4041b7c50f_o.jpg

插入`fb_fb`.`postcron_schedule`（`id`，`status_message`，`link`，`photo_url`，`status_name`，`status_caption`，`status_description`，`uid`，`page_id`，`access_token`， `post_to`，`status_type`，`schedule_type`，`is_process`，`process_time`，`process_at`，`display_time`，`created_by`）值（NULL，''，''，'/home/fb/public_html/交/包括/../上传/ 8120925654_4041b7c50f_o.jpg 'NULL，NULL，NULL， '0'， '135031429962113'， 'AAAGLZAMh7YSUBALRMCW60Rdol1kD80ZBNymqkgyQfBXDour2KsvVWKFcnZB9cU9OSLRMQjnEuKHZCTNoTZC4jf9GFtMU11BTD8JZAUFl0EVgZDZD'， '页'， '照片'， '日程'， '0'，' 1351342800 ', NULL , '1351342800', '100000103637895' );

号码是1351357200 8120925654_4041b7c50f_o.jpg

插入`fb_fb`.`postcron_schedule`（`id`，`status_message`，`link`，`photo_url`，`status_name`，`status_caption`，`status_description`，`uid`，`page_id`，`access_token`， `post_to`，`status_type`，`schedule_type`，`is_process`，`process_time`，`process_at`，`display_time`，`created_by`）值（NULL，''，''，'/home/fb/public_html/交/包括/../上传/ 8120925654_4041b7c50f_o.jpg 'NULL，NULL，NULL， '0'， '135031429962113'， 'AAAGLZAMh7YSUBALRMCW60Rdol1kD80ZBNymqkgyQfBXDour2KsvVWKFcnZB9cU9OSLRMQjnEuKHZCTNoTZC4jf9GFtMU11BTD8JZAUFl0EVgZDZD'， '页'， '照片'， '日程'， '0'，' 1351357200 ', NULL , '1351357200', '100000103637895' );

号码是1351371600 8120925654_4041b7c50f_o.jpg

插入`fb_fb`.`postcron_schedule`（`id`，`status_message`，`link`，`photo_url`，`status_name`，`status_caption`，`status_description`，`uid`，`page_id`，`access_token`， `post_to`，`status_type`，`schedule_type`，`is_process`，`process_time`，`process_at`，`display_time`，`created_by`）值（NULL，''，''，'/home/fb/public_html/交/包括/../上传/ 8120925654_4041b7c50f_o.jpg 'NULL，NULL，NULL， '0'， '135031429962113'， 'AAAGLZAMh7YSUBALRMCW60Rdol1kD80ZBNymqkgyQfBXDour2KsvVWKFcnZB9cU9OSLRMQjnEuKHZCTNoTZC4jf9GFtMU11BTD8JZAUFl0EVgZDZD'， '页'， '照片'， '日程'， '0'，' 1351371600 ', NULL , '1351371600', '100000103637895' );

号码是1351386000 8120925654_4041b7c50f_o.jpg

插入`fb_fb`.`postcron_schedule`（`id`，`status_message`，`link`，`photo_url`，`status_name`，`status_caption`，`status_description`，`uid`，`page_id`，`access_token`， `post_to`，`status_type`，`schedule_type`，`is_process`，`process_time`，`process_at`，`display_time`，`created_by`）值（NULL，''，''，'/home/fb/public_html/交/包括/../上传/ 8120925654_4041b7c50f_o.jpg 'NULL，NULL，NULL， '0'， '135031429962113'， 'AAAGLZAMh7YSUBALRMCW60Rdol1kD80ZBNymqkgyQfBXDour2KsvVWKFcnZB9cU9OSLRMQjnEuKHZCTNoTZC4jf9GFtMU11BTD8JZAUFl0EVgZDZD'， '页'， '照片'， '日程'， '0'，' 1351386000 ', NULL , '1351386000', '100000103637895' );

号码是1351400400 8120925654_4041b7c50f_o.jpg

插入`fb_fb`.`postcron_schedule`（`id`，`status_message`，`link`，`photo_url`，`status_name`，`status_caption`，`status_description`，`uid`，`page_id`，`access_token`， `post_to`，`status_type`，`schedule_type`，`is_process`，`process_time`，`process_at`，`display_time`，`created_by`）值（NULL，''，''，'/home/fb/public_html/交/包括/../上传/ 8120925654_4041b7c50f_o.jpg 'NULL，NULL，NULL， '0'， '135031429962113'， 'AAAGLZAMh7YSUBALRMCW60Rdol1kD80ZBNymqkgyQfBXDour2KsvVWKFcnZB9cU9OSLRMQjnEuKHZCTNoTZC4jf9GFtMU11BTD8JZAUFl0EVgZDZD'， '页'， '照片'， '日程'， '0'，' 1351400400 ', 空值, '1351400400', '100000103637895');
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:43:37.597

你把牙套弄混了：

```
// does nothing
for( $images as $image ) {

} 
```

我开始格式化你的代码，一旦它被格式化，你可以看到你的一个循环没有做任何事情。如果您格式化代码，那么更容易看到这些东西。

您的外部循环使用该`$images`变量，然后有一个内部循环（见上文）除了定义该变量之外什么都不做`$image`，然后您会得到意想不到的结果，因为您正在使用该变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:52:36.300

根据您的评论，为什么不这样做呢？

```
<php
$time = time();
$images = scandir("/home/fb/public_html/post/uploads/nofilter/");
foreach($images as $image) {
    if ($image == '.' || $image == '..') {
        continue;
    }

    $time += 14400; //add 4 hours every interval

    //copy file over from no filter
    $orig = "/home/fb/public_html/post/uploads/nofilter/".$image."";
    $dest =   "/home/fb/public_html/post/uploads/".$image."";
    //copy($orig, $dest);

    //output
      echo "The number is " . $time . "<br />";
    echo $image;
    echo "<br>";
    echo "<br>";
    echo "<br>";

    echo "

    INSERT INTO `fb_fb`.`postcron_schedule` (
    `id` ,
    `status_message` ,
    `link` ,
    `photo_url` ,
    `status_name` ,
    `status_caption` ,
    `status_description` ,
    `uid` ,
    `page_id` ,
    `access_token` ,
    `post_to` ,
    `status_type` ,
    `schedule_type` ,
    `is_process` ,
    `process_time` ,
    `process_at` ,
    `display_time` ,
    `created_by`
    )
    VALUES (
    NULL , '', '', '/home/fb/public_html/post/includes/../uploads/". $image ."', NULL , NULL , NULL , '0', '135031429962113', 'AAAGLZAMh7YSUBALRMCW60Rdol1kD80ZBNymqkgyQfBXDour2KsvVWKFcnZB9cU9OSLRMQjnEuKHZCTNoTZC4jf9GFtMU11BTD8JZAUFl0EVgZDZD', 'page', 'photo', 'schedule', '0', '". $time ."', NULL , '". $time ."', '100000103637895'
    );
    ";

    echo "<br>";
    echo "<br>";

 } 
```

# c# - 自定义 UserControl 中的标签内容未更新

> ID：13088070
> 
> 赞同：2
> 
> 时间：2012-10-26T13:41:01.200
> 
> 标签：c#, wpf, custom-controls

我创建了一个包含 12 个标签的自定义 UserControl。

![在此处输入图像描述](../Images/ea596f0c6821e963102368d5a5788f9a.png)

现在，当程序加载时，需要更改以“默认”为内容的标签。

```
// This is called in my main forms constructor, right before InitializeComponent()
public void ShowRigInfo()
{
    // This is here because if I try to call PopluateLabels, I get an "Object not
    // set to an instance of object" error
    grdRigInfo = new RigInfoGrid();

    var contractor = SplitString("contractor", _rigInfo);
    var projectName = SplitString("projectname", _rigInfo);
    var location = SplitString("location", _rigInfo);
    var operatorName = SplitString("operator", _rigInfo);
    var rigName = SplitString("rigsite_name", _rigInfo);
    var rigManager = SplitString("rigmanager", _rigInfo);

    grdRigInfo.PopulateLabels(contractor, projectName, location, operatorName,
                              rigName, rigManager);
    }

// A public method of my custom UserControl to update label content
public void PopulateLabels(string contractor, string project, string location, 
                           string operatorName, string rigName, string manager)
{
    lblContractor.Content = contractor;
    lblProjectName.Content = project;
    lblLocation.Content = location;
    lblOperator.Content = operatorName;
    lblRigName.Content = rigName;
    lblRigManager.Content = manager;            
} 
```

我的问题是，如何在程序启动时更新标签？感谢您的任何帮助。

**编辑**

我试图在我的主要形式`ShowRigInfo()`之前和之后打电话。`InitializeComponent()`他们都没有改变标签。

**编辑 2**

好的，我在真正看到答案之前解决了这个问题。我所做的是将我的移动`ShowRigInfo()`到我的自定义用户控件中，而不是我的主窗体。我不知道为什么我没有从一开始就这样做，但它确实存在。我将研究答案的 DataBinding 部分。谢谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:08:48.030

好吧，因为这是 WPF，我建议将这些标签绑定到某种支持（实现）INotifyPropertyChanged 的​​模型中的属性。

如果你用这些词谷歌，你会走得很远。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T13:50:35.130

为什么不在`Loaded`事件处理程序中尝试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T14:09:20.460

AD.Net 是对的：将您的初始设置放入 Loaded 事件中。在构造函数中，您可以使用局部变量，但通常不能使用视觉元素。一旦“Loaded”事件被触发，你所有的 UI 组件都应该可以使用了。

但是，我强烈建议您在标签上使用 DataBinding 和 DataContext，而不是通过公共方法填充它们。最终，如果您开始使用数据网格、树视图和列表视图，您将意识到 WPF 系统是如何围绕绑定构建的。

# c#-4.0 - 为什么在自定义模型绑定器中使用“ModelBindingContext”而不是“ControllerContext”？

> ID：13088073
> 
> 赞同：1
> 
> 时间：2012-10-26T13:41:09.267
> 
> 标签：c#-4.0, asp.net-mvc-4, modelbinders

试图将其表述为一个问题，因为在我目前正在处理的问题中，我不确定使用 ModelBindingContext 给我带来的好处超过了 ControllerContext。每个示例似乎都在说使用 ModelBindingContext 获取值更好，但并不清楚为什么（在我的情况下，它似乎不会做我想要的）。

*注意：这个例子是为了说明这个解释而简化的，以说明我在这两个方面遇到的主要问题，在完整场景中还有很多，这意味着默认模型绑定器是一个选项。*

在最基本的情况下，我们发布了以下（子集）FORM数据：

```
id=Question12 value='x'
id=Question45 value='y'
id=Question999 value='z' 
```

如果我要访问“ControllerContext”中的请求对象，我可以访问 FORM.Keys 以获取所有发布的数据键，我会知道有 3 个和它们的 id（并且可以获取它们的值）。这真的很容易。每页可能发布 0 个或 1+ 个问题（*问题类型对于为什么默认模型活页夹对我们不起作用很重要，但在这个问题中很重要*）。

如果我在“ModelBindingContext”上使用“ValueProvider”，我可以调用“ContainsPrefix”或“GetValue”，就是这样。所以我可以找出它是否具有“问题*”的值 - 但要找到发布的 3 个值，看来我必须通过检查“问题 1”到“问题 999”才能找到 3 个值，但我仍然不知道我有没有全部！

正如我所说的很多我读过的例子都说你应该考虑使用 ModelBindingContext，但它似乎在功能上受到限制，所以只是想知道如果我们使用 ControllerContext 是否会将自己编码成一个洞？

# c# - 显示页面时更改 html 中的 GridView 列名不会更改列名

> ID：13088082
> 
> 赞同：1
> 
> 时间：2012-10-26T13:42:01.087
> 
> 标签：c#, asp.net, html, gridview

我有一个我继承的项目。我被要求删除网站上 GridView 中的两列，并用另外两列替换它们。我已经更改了 html 以用新的替换原件，但是列标题名称似乎不想更改。我已经在调试器打开的情况下运行了代码，并在代码 c# 代码的第一行中断，然后再执行任何操作并检查 gridview 对象。它已经分配了这些列名，我不知道如何。我已经搜索了原始列名，但无法在任何地方找到它们。

基本上，我的问题是在页面真正加载之前控制列的名称是什么？每次我对此进行搜索时，都会有人想以编程方式对其进行更改，但这似乎并不是我所知道的问题所在。[我试图像这里](https://stackoverflow.com/questions/7703548/changing-the-column-name-in-gridview-using-html-or-c-sharp)建议的那样进入对象的属性，但它显示的是新字段而不是旧字段。

以下是创建此网格视图和对象的相关（我相信）HTML 代码。

```
<asp:GridView ID="gvTopSearch" runat="server" AllowPaging="True" 
    AllowSorting="True" PageSize="15" AutoGenerateColumns="False"
    DataKeyNames="NID,CID" Width="100%" OnPageIndexChanging="gvTopSearch_PageIndexChanging"
    OnSorting="gvTopSearch_Sorting" 
    onrowdatabound="gvTopSearch_RowDataBound" 
    meta:resourcekey="gvTopSearchResource1" >
    <Columns>
         <asp:TemplateField SortExpression="NewField1" HeaderText="NewField1" 
            meta:resourcekey="TemplateFieldResource5">
            <ItemTemplate>
                <%#Eval("NewField1")%>
            </ItemTemplate>
             <HeaderStyle Width="75px" />
        </asp:TemplateField>
        <asp:TemplateField SortExpression="NewField2" HeaderText="NewField2" 
            meta:resourcekey="TemplateFieldResource6">
            <ItemTemplate>
                <%#Eval("NewField2")%>
            </ItemTemplate>
            <HeaderStyle Width="75px" />
        </asp:TemplateField>
    </Columns>
    <AlternatingRowStyle CssClass="fieldName" HorizontalAlign="Left" />
    <EmptyDataTemplate>
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td align="center" style="padding-top: 50px; padding-bottom: 50px; padding-left: 60px;">
                    <img src="" alt="" />
                    <b>
                        </b>
                </td>
            </tr>
        </table>
    </EmptyDataTemplate>
    <HeaderStyle CssClass="fieldNamewithbgcolor" HorizontalAlign="Left" />
    <PagerStyle CssClass="Paging" />
    <RowStyle CssClass="gridbgcolor" HorizontalAlign="Left" />
</asp:GridView> 
```

“NewField1”和“NewField2”应该显示但没有显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:58:32.070

呸！我讨厌这个愚蠢的项目。我终于找到了问题所在（只花了大约 3 天）。

在同一目录中显然有一个 App_LocalResources 文件夹，其中包含一个 resx 文件。在该文件中是键值对，包括上面看到的“TemplateFieldResource5”和“TemplaceFieldResource6”，它们与旧的列名链接。我已将它们更改为新的列名，并且可以正常工作。

感谢那些试图帮助我发表评论的人。如果这就是史蒂夫背后的代码的意思，那我就误解了。

# c++ - 用于 pthreads 的对象定义中指向对象的指针的草率解决方案

> ID：13088083
> 
> 赞同：0
> 
> 时间：2012-10-26T13:42:02.713
> 
> 标签：c++, struct, header-files

在类 Foo 中，我需要一个类成员，它是一个包含指向 Foo 对象的指针的结构 S。

Foo.h

```
Struct S{
    ...
    Foo *ptrToFoo
}

class Foo{ 
    Foo();
    ~Foo();
    ...
    S sname;
}; 
```

现在这显然失败了，因为 sname 的定义包含一个指向它尚未看到的对象的指针。

我的解决方案是为 S 创建一个对象（在头文件中），然后使用前向声明：

嘘

```
class Foo;
class S{
    Foo *ptrtoFoo;
    ...
} 
```

Foo.h

```
// can use S as an object as a data member in Foo 
```

这对我来说似乎真的很草率。**有一个更好的方法吗？**S 不“保证”它自己的对象，因为它没有方法；结构体就可以了。

现在，如果您不在乎为什么而只想提供帮助，请跳过其余部分。如果您在想“这对我来说似乎是糟糕的设计！”，请继续阅读。

我这样做的原因是 pThreads_create 不将非静态类成员函数作为参数。常见的解决方案（正如许多stackoverflow帖子）指出的那样，是创建一个静态成员函数来调用您想要的真实函数，然后传递调用者对象，如下所示：

```
void *Foo::callerHelper(void *arg)
{
    //http://stackoverflow.com/questions/7820653/pthread-create-parameter-function-pointer
    //http://stackoverflow.com/questions/86046/best-way-to-start-a-thread-as-a-member-of-a-c-class
    Foo *ptr = (Foo *)(arg);
    ptr->RealFnctnToCall();
    return 0;
}

...
pthread_create(&threads[id], NULL, &Foo::callerHelper, this) 
```

但是，我不仅需要传递这个参数，还需要传递其他参数。我的“S”对象代表参数有效载荷。它包含指向这个的指针，以及我需要的“RealFnctnToCall”的真实参数

```
S package;
S.FooPtr = this;
S.intINeed = ...
... 
//recast S as (void *) 
```

然后做

```
pthread_create(&threads[id], NULL, &Foo::callerHelper, S)
// in callerHelper, depackage S and get everything I want. 
```

我对这部分的解决方案感到满意，只要对我上面的真正问题有一种不那么草率的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:49:40.093

`Foo`直接在现有代码中进行前向声明怎么样？这是规范的 C++ 方式。

```
class Foo;
Struct S{
    ...
    Foo *ptrToFoo;
};

class Foo{ 
    Foo();
    ~Foo();
    ...
    S sname;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:50:43.447

你可以`S`在本地声明里面`Foo`。

```
class Foo
{
    struct S
    {
        Foo *ptrToFoo;
    };

    S sname;
}; 
```

# eclipse - 更改 Struts 2 中的 jqGrid 选项

> ID：13088084
> 
> 赞同：0
> 
> 时间：2012-10-26T13:42:02.463
> 
> 标签：eclipse, jqgrid, struts2

我在哪里可以更改此选项： [http](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:options) ://www.trirand.com/jqgridwiki/doku.php?id=wiki:options 在 jqGrid Struts 2 插件 + Eclipse 中。

我需要这个来更改 ignoreCase 选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:43:03.197

如果标签不支持它，那么您可以尝试在 javascript 中更改它。从 DOM 获取 jqGrid 对象并对其应用选项。

**更新**

```
$(document).ready(function() { 
  $("#id_of_element").jqGrid({
    // options here 
  });
}); 
```

# iphone - 将块作为参数的函数并不总是返回

> ID：13088086
> 
> 赞同：0
> 
> 时间：2012-10-26T13:42:02.540
> 
> 标签：iphone, ios, objective-c-blocks

我写了一个从网上下载图像的函数。它以块作为参数。一切正常，直到我添加了一些内存缓存。如果图像已经在缓存中，则函数不会返回（但块不是零）。

```
- (void) downloadImageFromURL:(NSURL *) url completionBlock:(void (^)(UIImage *image, NSError *error)) block {

dataHandler = [DataHandler sharedInstance];

UIImage *img=[dataHandler.avatarImages objectForKey:[url absoluteString]];
//image is in cache
if (img) {
    block(img, nil);
}
//not in cache, download it (works ok)
else {

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0ul), ^{
        NSData *imageData = [NSData dataWithContentsOfURL:url];
        UIImage *picture=[UIImage imageWithData:imageData];
        if(picture) {
            //save to cache
            [dataHandler.avatarImages setObject:picture forKey:[url absoluteString]];
            block(picture, nil);
        }
        else {
            NSError *error = [NSError errorWithDomain:@"image_download_error" code:1
                                             userInfo:[NSDictionary dictionaryWithObject:@"Can't fetch data" forKey:NSLocalizedDescriptionKey]];
            block(nil, error);
        }

    });
} 
```

该块的名称如下：

```
 ImageDownloader *idl=[[ImageDownloader alloc] init];

        NSURL *imageUrl=[NSURL URLWithString:ta.avatarUrl];
        [idl downloadImageFromURL:imageUrl completionBlock:^(UIImage *image, NSError *error)
         {
             if(!error) {
                 dispatch_async(dispatch_get_main_queue(), ^(void) {
                     logo.image=image;
                 });
             } else {
                 NSLog(@"error %@", error);
             }

         }]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:47:49.963

当缓存中的图像看起来像这样时，更改您对块的调用：

```
if (img) {
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        block(img, nil);
    });
} 
```

用户不应该关心图像是否在缓存中，并且无论如何您的块应该被称为异步。

# excel - 计算工作表中的行数

> ID：13088090
> 
> 赞同：8
> 
> 时间：2012-10-26T13:42:14.493
> 
> 标签：excel, vba

我想从 Sheet2 代码模块计算 Sheet1 中的行数。

在*sheet1*代码模块中，以下代码可以正常工作

```
ctr = Range("B2", Range("B2").End(xlDown)).Count 
```

*我在Sheet2*代码模块中尝试了相同的代码

```
recct = ThisWorkbook.Sheets("Sheet1").Range("B2", Range("B2").End(xlDown)).Count 
```

我正进入（状态`run time error 1004 Application -Defined or Defined error`

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T13:49:47.423

错误发生在 中的第二个范围参考中`recct`。因为您引用的是不同的工作表，所以您需要在两个范围引用中告诉 VBA 工作表名称。

试试这个：

```
With ThisWorkbook.Sheets("Sheet1")    
    recct = .Range("B2", .Range("B2").End(xlDown)).Rows.Count    
End With 
```

或者，这也可以（虽然有点草率）。

```
recct = ThisWorkbook.Sheets("Sheet1").Range("B2", ThisWorkbook.Sheets("Sheet1").Range("B2").End(xlDown)).Rows.Count 
```

**更新**

由于围绕工作表上的行数的实际含义进行了很多讨论，因此请使用上面的代码从 B2 开始并直接计算下面的连续单元格的数量

但是，如果您想在 B 列中找到最后一个“真实”使用的单元格（通过真实，我的意思是其中包含数据），请执行以下操作：

```
With ThisWorkbook.Sheets("Sheet1")

    recct = .Range("B2", .Range("B" & .Rows.Count).End(xlUp)).Rows.Count

End With 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T13:48:19.287

例如，您可以使用它：

```
rowsInThere = Sheets("Sheet1").UsedRange.Rows.Count 
```

这在没有范围的情况下有效。您也可以将`ActiveSheet`其用作工作表进行检查，以防您需要更改当前工作表并检查其行数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T13:56:48.683

两件事情

1.  在表外工作时，您需要完全限定您的范围
2.  始终自下而上测量最后一个单元格，而不是自上而下 - 您可能有间隙

**代码**

```
Sub GetB()
Dim ws As Worksheet
Set ws = Sheets(1)
Dim lngCnt As Long
lngCnt = ws.Range(ws.[b2], ws.Cells(Rows.Count, "b").End(xlUp)).Count
End Sub 
```

**更健壮**

干净地处理所有情况`Find`会更容易

```
Sub GetB()
    Dim ws As Worksheet
    Dim rng1 As Range
    Set ws = Sheets(1)
    Set rng1 = ws.Range("B:B").Find("*", ws.[b1], xlValues, , , xlPrevious)
    If Not rng1 Is Nothing Then
    Select Case rng1.Row
    Case 1
    MsgBox "Only B1 has data", vbCritical
    Case 2
    MsgBox "No used cells past B2"
    Case Else
    MsgBox rng1.Row - 1 & " cells between B2 and B" & rng1.Row
    End Select
    Else
        MsgBox ws.Name & " column B Is blank", vbCritical
    End If
End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-03T17:02:54.220

不知道这是否有帮助，但我一直在我的模块中使用它：

```
Dim TR as long, TC as long

TR = [Sheet1!A1].CurrentRegion.Rows.count
TC = [Sheet1!A1].CurrentRegion.Columns.count 
```

如果我知道如果我正在处理的数据集没有空行或空列，例如从另一个程序中提取或其他内容，那么它很快并且效果很好！从这里我可以指定一个范围选择或执行一个 vlookup。

```
TR = [Sheet1!A1].CurrentRegion.Rows.count
[I2] = "=vlookup($C2,'sheet1'!A$2:B$" & TR & ",2,FALSE)" 
```

# android - 在运行时创建两个视图并在第一个视图中放置一个

> ID：13088097
> 
> 赞同：0
> 
> 时间：2012-10-26T13:42:35.423
> 
> 标签：android, android-view

所以我在运行时创建 ImageView 和 TextView，我希望将 TextView 放在 ImageView 的右侧。

我正在尝试这个简单的代码：

```
private void loadContent(Module module) {
    this.removeAllViewsInLayout();      
    this.addView(getModuleIconView(module));
    this.addView(getModuleNameView(module));
}

private ImageView getModuleIconView(Module module) {
    ImageView view = new ImageView(context);
    view.setImageResource(module.getIconResId());   
    android.view.ViewGroup.LayoutParams params = new LayoutParams(120, 120);                
    view.setLayoutParams(params);
    view.setId(1); //seting some id for the view
    return view;
}

private TextView getModuleNameView(Module module) {
    TextView view = new TextView(context);
    view.setText(module.getName()); 
    params.addRule(RelativeLayout.RIGHT_OF, 1); //hoping for view to be placed right of the ImageView which id was set to 1
    return view;
} 
```

我在这里做错了什么？TextView 放置在我的 ImageView 上，忽略 RIGHT_OF

需要提一下类继承自RelativeLayout

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T16:04:40.957

这是我愚蠢的错误。第三种方法泄漏 setLayoutParams

所以正确的方法体是：

```
private TextView getModuleNameView(Module module) {
    TextView view = new TextView(context);
    view.setText(module.getName()); 
    params.addRule(RelativeLayout.RIGHT_OF, 1);
    view.setLayoutParams(params);
    return view;
} 
```

# c++ - C++ 继承：基类型的函数签名不适用于派生类型

> ID：13088099
> 
> 赞同：2
> 
> 时间：2012-10-26T13:42:41.793
> 
> 标签：c++, inheritance, function-signature

我有以下代码：

```
class STFDataPoint {
public:

    virtual ImagePoint get_patch_top_left() const = 0;
    virtual ImagePoint get_patch_bottom_right() const = 0;
    virtual std::string get_image_filename() const = 0;

    virtual ~STFDataPoint() = 0;
};
inline STFDataPoint::~STFDataPoint() {}

class TrainingDataPoint : public STFDataPoint{
private:
    int row;
    int col;
    std::string class_label;
    ImagePoint patch_top_left;
    ImagePoint patch_bottom_right;
    std::string image_filename;
public:
    TrainingDataPoint(int row, int col, std::string class_label, 
            const ImagePoint & top_left, 
            const ImagePoint & bottom_right, 
            std::string image_filename);

    std::string get_class_label() const;

    inline bool operator==(const TrainingDataPoint& other) const{
        return other.class_label == this->class_label;
    }
    inline bool operator!=(const TrainingDataPoint& other) const{
        return !(*this == other);
    }

    virtual ImagePoint get_patch_top_left() const;
    virtual ImagePoint get_patch_bottom_right() const;
    virtual std::string get_image_filename() const;

}; 
```

我正在尝试运行以下命令：

```
bool do_something(vector<STFDataPoint>& data_point){
    return true;
}

int main(int argc, char* argv[]) {

    ImagePoint left = ImagePoint(2,3);
    ImagePoint right = ImagePoint(2,3);

    TrainingDataPoint a = TrainingDataPoint(1,2,"",left, right, "");
    vector<TrainingDataPoint> b;
    b.push_back(a);

    do_something(b);
} 
```

但是得到以下错误：

```
invalid initialization of reference of type ‘std::vector<STFDataPoint>&’ from expression of type `std::vector<TrainingDataPoint>` 
```

但是，如果我将签名更改`do_something()`为接受一个`STFDataPoint`（不是它们的向量），它运行正常。有人可以解释为什么会这样以及是否有解决方法？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T13:51:15.600

因为`vector<TrainingDataPoint>`不是`vector<STFDataPoint>`你的子类型，所以不能这样做。向量在参数类型中不是[协变的。](http://en.wikipedia.org/wiki/Covariance_and_contravariance_%28computer_science%29)

但是，您可以使用模板`do_something`使其工作：

```
template <typename T>
bool do_something(vector<T>& data_point){
   //common actions like
   ImagePoint leftPatch = data_point[0].get_patch_top_left();
   return true;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T13:48:54.413

类型`vector<TrainingDataPoint>`不一样，`vector<STFDataPoint>`两者之间没有转换。`vector<A>`不是 的基类型`vector<B>`，即使`A`是 的基`B`。

可行的是拥有一个指向基本类型的指针或智能指针容器，并更改函数以使用它：

```
bool do_something(vector<std::unique_ptr<STFDataPoint>>& data_point){
    return true;
}

std::vector<std::unique_ptr<STFDataPoint>> b;
b.push_back( std::unique_ptr<STFDataPoint>(new TrainingDataPoint(1,2,"",left, right, "") ); // fill with any derived types of STFDataPoint
do_something(b); 
```

# nullpointerexception - 带有文件选择器的 NullPointerException？

> ID：13088101
> 
> 赞同：0
> 
> 时间：2012-10-26T13:42:47.490
> 
> 标签：nullpointerexception, jfilechooser

我的代码对我来说足够好，但我不断收到空指针异常。我正在输入一个如下所示的文本文件：

克米特 D.Frogge 17.25 5.25 0.0 8.0 1.5 8.0 2.25 7.75 0.0 8.0 2.0

这是我的一些代码：

```
private static BufferedReader br;
private static StringTokenizer strTkn;

private static String st, firstName, middleInitial, lastName;
private static double monRegHours, monOverHours, tuesRegHours, tuesOverHours,      wedRegHours, wedOverHours,
thurRegHours, thurOverHours, friRegHours, friOverHours;
private static double totalRegHours, totalOverHours, hourlyWage, regularPay, overtimePay, weeklyPay;
private static JFileChooser chooser;

public static void main (String args []) throws IOException 
{
chooser();
getData();
calcpay();
printresult();
}

public static void chooser() throws IOException
{
JFileChooser chooser=new  JFileChooser();
int returnVal = chooser.showOpenDialog(null);
if(returnVal == JFileChooser.APPROVE_OPTION) 
{
  File f = chooser.getSelectedFile();
  br=new BufferedReader(new FileReader(f));
  st="";
  while((st=br.readLine())!=null);
  {
    System.out.println ("Data Line = " + st ); //print the whole line
  }
  }
  }

public static void getData() throws IOException
{
 strTkn = new StringTokenizer(st, " .");

 firstName = strTkn.nextToken();
 middleInitial = strTkn.nextToken();
 lastName = strTkn.nextToken();
 hourlyWage = Double.parseDouble(strTkn.nextToken());

 monRegHours = Double.parseDouble(strTkn.nextToken());
 monOverHours = Double.parseDouble(strTkn.nextToken());

 tuesRegHours = Double.parseDouble(strTkn.nextToken());
 tuesOverHours = Double.parseDouble(strTkn.nextToken());

 wedRegHours = Double.parseDouble(strTkn.nextToken());
 wedOverHours = Double.parseDouble(strTkn.nextToken());

 thurRegHours = Double.parseDouble(strTkn.nextToken());
 thurOverHours = Double.parseDouble(strTkn.nextToken());

 friRegHours = Double.parseDouble(strTkn.nextToken());
 friOverHours = Double.parseDouble(strTkn.nextToken());

}

public static void calcpay()
{
totalRegHours = monRegHours + tuesRegHours + wedRegHours + thurRegHours + friRegHours;
totalOverHours = monOverHours + tuesOverHours + wedOverHours + thurOverHours +    friOverHours;

overtimePay = round(totalOverHours * (1.5 * hourlyWage));
regularPay  = round(hourlyWage * totalRegHours);
weeklyPay = regularPay + overtimePay;
}

public static void printresult()
{
System.out.println("Name: " + firstName + " " + middleInitial + " " + lastName);
System.out.printf("Weekly Pay: " + "$%.2f\n", weeklyPay);
//this allows me to print $x.50 instead of $x.5, and not have repeating decimals
}

public static double round(double num) 
{
// rounding to two decimal places
num *= 100;
int rounded = (int) Math.round(num);
return rounded/100.0; 
```

对不起，如果它看起来不好，我的电脑不喜欢复制粘贴

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:01:47.053

It is a very simple error. You have placed a semicolon after your while loop.

```
while((st=br.readLine())!=null); 
```

Remove the semi-colon and it will work fine.

# c# - 列出持有参考

> ID：13088103
> 
> 赞同：4
> 
> 时间：2012-10-26T13:42:51.273
> 
> 标签：c#

我有一个对象（我创建的类）的列表（在 C# 中）。我可以使用该列表，但问题是我只创建了（实例化我认为是正确的术语）我的一个对象类，并且我一直将它添加到列表中，即使该对象的属性随着代码的迭代而改变. 我希望能够将硬编码对象添加到我的列表中，而不是引用对象。

这是我目前正在做的事情：

```
public class SaveData
{
    public double save_property1;
    public double save_property2;    
}

in the application

SaveData newSaveData = new SaveData();
List<SaveData> newSaveDataList = new List<SaveData>;

if ( some condition)
{
    newSaveData.save_property1 = x
}

if (some condition 2) 
{
    newSaveData.save_property2 = y 
    newSaveDataList.Add(SaveData);  // 
} 
```

由于 X 和 Y 在迭代中发生变化，我希望`SaveDate`我添加到列表中的对象不会随着每次迭代而改变（因此我可以保留 Data 对象的历史记录），即硬编码而不用作参考。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T13:46:17.477

你不能这样做，每次你想添加到列表时都需要创建一个新对象，否则你将继续修改旧对象。

请记住，当您向列表添加引用类型时，您只是将其`reference`放入列表中，而不是被引用的对象。这意味着如果你总是推送同一个实例，列表中的所有“项目”实际上都是同一个项目。考虑：

```
newSaveData                        1000
+-----------+                      +--------------------+
| 1000      |--------------------->| save_property1     |
+-----------+                      | save_property2     | 
                                   +--------------------+
newSaveDataList                               ^
+-----------+                                 |
| 1000      |---------------------------------+
+-----------+                                 |
| 1000      |---------------------------------+
+-----------+                                 |
| 1000      |---------------------------------+
+-----------+                                 |
| 1000      |---------------------------------+
+-----------+ 
```

因此，您需要为每个添加到列表中的对象创建一个新的对象实例，以便它们都是可以变化的不同对象：

```
while (yourLoopCondition)
{
    // each item you want to add, create a new instance.
    newSaveData = new SaveData();
    if (someCondition1)
    {
        newSaveData.save_property1 = x
    }

    if (someCondition2) 
    {
        newSaveData.save_property2 = y 
        newSaveDataList.Add(newSaveData);  
    }
} 
```

以上假设每个对象都是不同的，而不是循环的多次迭代中的“飞行中的对象”。

现在，如果您有一个主要对象并且您只是想将该对象的“快照”放入列表中，您可以使用某种克隆方法或“复制构造函数”来做到这一点：

```
public class SaveData
{
    public double save_property1;
    public double save_property2;

    public SaveData(SaveData other)
    {
        save_property1 = other.save_proerty1;
        save_property2 = other.save_property2;
    }
} 
```

然后，如果您想将 a`snapshot`放在飞行中的对象列表中，您可以这样做：

```
newSaveDataList.Add(new SaveData(newSaveData)); 
```

或者，您*可以*使用 a`struct`代替，它是一种值类型，因此会在列表中放置一个*副本*，但`struct`有很多有趣的怪癖，在使用它们之前应该非常仔细地考虑这些怪癖。我在[这里有一个关于这个主题的帖子](http://geekswithblogs.net/BlackRabbitCoder/archive/2010/07/29/c-fundamentals-the-differences-between-struct-and-class.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T13:46:59.620

我想我明白你在问什么。您会发现自己拥有一个对同一对象的引用列表，该对象反映了最新状态（`x`和的值`y`），而不是一组对历史值的引用。

这样做的原因是您正在向列表中添加对同一对象的引用，并且您正在更改这个引用的对象，而不是每次都创建新对象。您应该能够`SaveData`在每次迭代中创建一个新的来解决您的问题。

```
var history = new List<SaveData>();
while (someCondition)
{
    var sd = new SaveData(...);

    if (someOtherCondition)
    {
        sd.saveProperty1 = someValue;
    }

    ...

    history.Add(sd);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T13:54:33.500

我认为您的示例代码不太正确，因为您有

```
SaveData.save_property1 = x; 
```

我认为你的意思

```
newSaveData.save_property1 = x; 
```

试试这个，它展示了如何创建多个具有不同字段值的 SaveData 对象，并将对象添加到您的列表中。

```
List<SaveData> newSaveDataList = new List<SaveData>();
for (int index = 0; index < 10; index++)
{
    SaveData saveData = new SaveData();
    saveData.save_property1 = (double)index;
    saveData.save_property2 = (double)index * 2;
    newSaveDataList.Add(saveData);
}

foreach (SaveData saveData in newSaveDataList)
{
    Console.WriteLine(saveData.save_property1);
    Console.WriteLine(saveData.save_property2);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T13:55:10.883

为了使事情起作用，您需要创建一个新对象并将先前对象中的所有字段复制到新对象中，然后更改所需的属性。复制操作是你需要自己实现的。此操作称为“克隆”。

看看这两个问题：

[在 C# 中克隆对象](https://stackoverflow.com/questions/78536/cloning-objects-in-c-sharp)
[如何在 .Net（特别是 C#）中对对象进行深度复制？](https://stackoverflow.com/questions/129389/how-do-you-do-a-deep-copy-an-object-in-net-c-specifically)

[`Object.MemberwiseClone`](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)如果您不需要深拷贝，您也可以使用：

```
public class SaveData : ICloneable
{
    public double save_property1;
    public double save_property2;    

    public object Clone()
    {
        return this.MemberwiseClone();
    }
} 
```

接着：

```
if (some condition 2) 
{
    SaveData copySaveData = newSaveData.Clone();
    copySaveData.save_property2 = y;
    newSaveDataList.Add(copySaveData);
} 
```

或其他方式：

```
if (some condition 2) 
{
    newSaveData.save_property2 = y;
    newSaveDataList.Add(newSaveData);
    newSaveData = newSaveData.Clone();
    // from now on all the new changes will happen to a new object, not the one in the list.
} 
```

# c# - 使用 Linkbutton 和 C# 和 javascript 在数据列表中隐藏面板

> ID：13088104
> 
> 赞同：2
> 
> 时间：2012-10-26T13:42:51.293
> 
> 标签：c#, javascript, hide, panel, datalist

我是一个新的程序员，所以任何帮助或建议将不胜感激。

我有一个数据列表，其中包含一个显示一行数据的链接按钮。单击链接按钮时，应取消隐藏包含数据列表（也包含链接按钮）的面板，该面板显示更详细的信息。我遇到的问题是，当我单击摘要链接按钮时，它不会触发 javascript 来隐藏或显示详细信息面板。我没有得到任何异常，我的程序构建并运行，所以我不确定为什么 javascript 不会触发。仅供参考， DBClass 和 DbClass 对象是内部类，它们工作正常。这是我的代码：

```
using System;
usingSystem.Collections;
usingSystem.Configuration;
usingSystem.Data;
usingSystem.Linq;
usingSystem.Web;
usingSystem.Web.Security;
usingSystem.Web.UI;
usingSystem.Web.UI.HtmlControls;
usingSystem.Web.UI.WebControls;
usingSystem.Web.UI.WebControls.WebParts;
usingSystem.Xml.Linq;
usingDBClass;

namespaceTimeLogging.pages
{
  publicpartialclassdbEntry:System.Web.UI.Page
  {
    QueryClassqc=newQueryClass();

  protectedvoidPage_Load(objectsender,EventArgse)
  {
    bindDlReportProjSum_devSummary();
  }

  //getsthelinkbuttonattributefortheemployeeidsothatitcanbeboundtothedatalist
protectedvoiddlReportProjSum_devSummary_OnItemDataBound(objectsender,DataListItemEventArgse)
{
  if(e.Item.ItemType == ListItemType.Item 
    || e.Item.ItemType == ListItemType.AlternatingItem)
  {
    DataListnestedDataList=(DataList)e.Item.FindControl("dlReportProjSum_devDetail");
    LinkButtonlinkbtn=(LinkButton)e.Item.FindControl("lbReportProjSum_devSummary");
    bindDlReportProjSum_devDetail(nestedDataList,linkbtn.Attributes["empid"]);
    //Panelpan=(Panel)e.Item.FindControl("panReportProjSum_devDetail");
  }
}

//hidesthedevedetailpanelonlinkbutttonclick
protectedvoiddlReportProjSum_devSummary_OnItemCommand(objectsender,DataListCommandEventArgse){

LinkButtonlb=(LinkButton)e.Item.FindControl("lbReportProjSum_devSummary");
Panelpan=(Panel)e.Item.FindControl("panReportProjSum_devDetail");
}

//thedatalistthatshowsasummaryofeachemployeewhohasworkedonaproject
protectedvoidbindDlReportProjSum_devSummary(){
DbClassdb=newDbClass();
DataTabledt=newDataTable();
stringsqlString=@"selectname,empid,sum(actualtime)astotal
fromTime_logging_vwProjDevDetail
whereprojid=1
groupbyempid,name";
db.OpenConnection();
db.Execute(sqlString);
dt=db.GetData.Table;
dlReportProjSum_devSummary.DataSource=dt;
dlReportProjSum_devSummary.DataBind();
db.CloseConnection();
db.Dispose();
}

//bindthenesteddatalistinthedevSummaryOnItemDataBoundevent
privatevoidbindDlReportProjSum_devDetail(DataListdl,stringdevEmpid)
{
DbClassdb=newDbClass();
DataTabledt=newDataTable();
stringsqlString=string.Format(@"selectDAYOF,ESTTIME,ACTUALTIME,NOTES,TASK
fromtime_logging_resourceswhere
projid=1andempid={0}",devEmpid);
db.OpenConnection();
db.Execute(sqlString);
dt=db.GetData.Table;
dl.DataSource=dt;
dl.DataBind();

db.CloseConnection();
db.Dispose();
}

////whenthedeveloperssummaryoftotalhoursonaprojectisclicked
protectedvoidlbReportProjSum_devSummary_Click(objectsender,EventArgse)
{
ClientScript.RegisterStartupScript(GetType(),"Javascript","HidePanel()",true);

}

}
}

ASPXpage////////////////////////////////////////////////////////////////////////////////

<%@PageLanguage="C#"AutoEventWireup="true"CodeBehind="dbEntry.aspx.cs"Inherits="TimeLogging.pages.dbEntry"%>

<%@RegisterAssembly="AjaxControlToolkit"Namespace="AjaxControlToolkit"TagPrefix="asp"%>

<!DOCTYPEhtmlPUBLIC"-//W3C//DTDXHTML1.0Transitional//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<htmlxmlns="http://www.w3.org/1999/xhtml">
<headrunat="server">
<title>UntitledPage</title>
<linkhref="../css/Main.css"rel="stylesheet"type="text/css"/>

<scripttype="text/javascript"language="javascript">
functionHidePanel()
{
alert("hello");
varpanel=document.getElementById('panReportProjSum_devDetail');
if(panel.style.display=='none')
{
panel.style.display='block';
}
else
{
panel.style.display='none';
}
}
</script>

</head>
<body>
<formid="form1"runat="server">

<asp:ToolkitScriptManagerID="ToolkitScriptManager1"runat="server">
</asp:ToolkitScriptManager>
<div>
<asp:PanelID="panMainReportsHolder"runat="server">

<asp:DataListID="dlReportProjSum_devSummary"runat="server"RepeatDirection="Vertical"
ShowFooter="False"ShowHeader="False"OnItemDataBound="dlReportProjSum_devSummary_OnItemDataBound"
OnItemCommand="dlReportProjSum_devSummary_OnItemCommand">
<HeaderTemplate>
</HeaderTemplate>
<ItemTemplate>
<div>
<asp:LinkButtonID="lbReportProjSum_devSummary"OnClick="lbReportProjSum_devSummary_Click"
runat="server"empid='<%#DataBinder.Eval(Container.DataItem,"empid")%>'name='<%#DataBinder.Eval(Container.DataItem,"name")%>'
total='<%#DataBinder.Eval(Container.DataItem,"total")%>'CssClass="developerSummaryLinkButton"><%#DataBinder.Eval(Container.DataItem,"name")%>'stotalhoursspentdevelopingtheproject:<%#DataBinder.Eval(Container.DataItem,"total")%>

</asp:LinkButton>

<asp:PanelID="panReportProjSum_devDetail"runat="server">

<asp:DataListID="dlReportProjSum_devDetail"runat="server"RepeatDirection="Vertical"
ShowFooter="False"ShowHeader="False">
<HeaderTemplate>
</HeaderTemplate>
<ItemTemplate>
<div>
<asp:LinkButtonID="LinkButton1"CssClass="developerDetailLinkButton"runat="server"
Enabled="false">Dateworked:<%#DataBinder.Eval(Container.DataItem,"dayof")%>task:<%#DataBinder.Eval(Container.DataItem,"task")%>numberofhoursworked:<%#DataBinder.Eval(Container.DataItem,"actualtime")%>anynotes:<%#DataBinder.Eval(Container.DataItem,"notes")%>
</asp:LinkButton>
</div>
</ItemTemplate>
<FooterTemplate>
</FooterTemplate>
</asp:DataList>
</asp:Panel>

</div>
</ItemTemplate>
<FooterTemplate>
</FooterTemplate>
</asp:DataList>
</asp:Panel>
</div>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:51:16.033

您需要连接您的 Linkbutton1 以触发 Javascript 事件。您可以使用 OnClientClick 属性执行此操作，如下所示：

```
<asp:LinkButtonID="LinkButton1"CssClass="developerDetailLinkButton"runat="server" Enabled="false" onclientclick="HidePanel();return false;"/> 
```

Return False 阻止它调用 onclick 中设置的服务器端事件（如果有的话）。

阅读有关 onclient 的更多信息单击此处在此处[输入链接描述](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.onclientclick.aspx)

# javascript - 无法为变量设置新值

> ID：13088107
> 
> 赞同：1
> 
> 时间：2012-10-26T13:43:10.450
> 
> 标签：javascript, jquery, ajax, json, variables

我可能遗漏了一些非常明显的东西，但我并没有解决这个问题。

在从 json 提要获取值后，我试图设置变量的值很简单。

我正在使用 jquery 获取 jsonp 提要，然后将值存储在我以后可以使用的变量中，但它不起作用并且值没有被存储。如果我 console.log 它返回它的值。

```
jQuery(document).ready(function($){
    serverip = "<?php echo $_SERVER['SERVER_ADDR']; ?>";
    stream_domain = "";

    $.ajax({url: 'http://load.cache.is/inspired.php?ip=' + serverip, dataType:'jsonp',
      success:  function(data){
        $.each(data, function(key, val) {
            if (key == serverip){
               stream_domain = val;
               console.log("val: " + val);
            }
        });
      }
    });

    console.log(stream_domain);
}); 
```

[这是jsfiddle.net](http://jsfiddle.net/einar/vSmjZ/)上的相同代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:45:49.110

ajax 调用是异步的，所以事件的时间线是：

1.  进行ajax调用
2.  控制台日志
3.  ajax调用成功，变量赋值

在使用变量之前等待成功事件。这是您更新的[jsFiddle](http://jsfiddle.net/vSmjZ/2/)，我在其中添加了一个在成功回调函数中调用的函数：

```
 function continueWorking(){            
        console.log(stream_domain);
        $("<span>" + stream_domain + "</span>").appendTo(".variable");
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T13:46:00.373

您正在发出异步请求。因此，附加 HTML 的代码在分配变量的成功之前执行。

ajax 请求之后的代码在请求发出后立即执行。因此，如果您需要响应数据，那么您应该将附加代码从成功方法中执行，类似于以下内容：

```
if (key == serverip){
    stream_domain = val;
    console.log("val: " + val);
    $("<span>" + val + "</span>").appendTo(".json");
    $("<span>" + stream_domain + "</span>").appendTo(".variable");
} 
```

### [演示](http://jsfiddle.net/vSmjZ/1/)

# android - 安卓活动/TabActivity

> ID：13088109
> 
> 赞同：0
> 
> 时间：2012-10-26T13:43:19.010
> 
> 标签：android, android-intent, android-activity

我正在构建的 Android 应用程序使用一个不断将数据推送到远程服务器的库。在一个演示中，MyMainactivity 正是这样做的，没有任何用户界面，并且该活动运行良好。现在我正在使用 TabView 围绕此活动构建 UI，我很困惑如何执行 MyMainActivity - 在我的清单中，我现在将 MyTabActivity 作为 LAUNCHER 那么如何让 MyMainActivity 和 MyTabActivity 都在启动时启动？（MyMainActivity 应该在用户能够滚动选项卡时运行，并且稍后应该会影响 MyMainActivity 如何将数据发送到我们的服务器）。

```
 <activity
        android:name=".MyTabActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:49:22.433

您可以将 放在`MyMainActivity`第一个可见选项卡中，以便在选项卡可见时启动。

或者您可以启动`MyMainActivity`您需要做的事情，然后将您的应用程序转发到`MyTabActivity`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:49:29.717

每个带有 GUI 的活动都有一个 onCreate 方法，您可以覆盖该方法来定义活动启动时会发生什么。创建 MyTabActivity 时，您将添加代码以运行后台服务。

```
class MyTabActivity extends Activity {
 protected void onCreate(Bundle savedInstanceState){
     Intent myIntent = new Intent(getApplicationContext(), MyMainActivity.class);
       startService(myIntent);
    setContentView(viewid);
 }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T13:49:41.687

你可以试试这个。

```
<activity
    android:name=".MyTabActivity"
    android:label="@string/app_name" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />

        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>

     <activity
        android:name=".MyMainactivity " >

    </activity>
   </activity> 
```

您也可以在选项卡活动中通过这种方式尝试另一种方式。在这里，你使用你的东西。

```
 <receiver android:name=".AutoConnection" >
        <intent-filter>
            <action android:name="android.intent.action.AIRPLANE_MODE" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
      </receiver

public class AutoConnection extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) { 
```

# tfs - TFS 2012、TFSBuild.proj、UpgradeTemplate.xaml 流程定义和编码的 UI 测试

> ID：13088114
> 
> 赞同：2
> 
> 时间：2012-10-26T13:43:31.007
> 
> 标签：tfs, coded-ui-tests

如果有人甚至可以远程提供帮助，还有几个 TFS 问题:-)

我们目前安装了 TFS 2012。我们有 2 台服务器（两台 VM 都运行 Windows Server 2008 R2 x64）。一台服务器是安装了应用层和数据库（运行 SQL Server 2008 R2）的 TFS。另一台服务器是我们的 BUILD 服务器，上面安装了构建控制器和构建代理。

我们可以使用 Visual Studio 2012 Ultimate 从本地开发人员 PC 连接到 TFS 2012 OK。

然后我们有各种复杂的构建定义来编译我们的代码、运行单元测试、生成实时沙堡文档并使用 InstallShield 安装到我们的多层、多服务器 TEST 或 LIVE 环境（采用 SSL 并执行预安装条件等）

我们将 UpgradeTemplate.xaml 构建过程定义与 TFSBuild.proj 文件一起使用。仅供参考，它最初是在 TFS 2008 中开发的，并且为我们提供了很好的服务，因此我们不想升级到修改后的 defaulttemplate.xaml

我们现在希望以编码 UI 测试的形式包含“部署后测试”（我相信也称为冒烟测试或系统测试或端到端测试）。

1.  我们可以在本地记录这些测试，添加断言等并将它们签入 TFS 等，但我的问题是如何在构建序列结束时从 TFS Build 调用它们而不升级到 defaulttemplate.xaml？我们使用真正的构建属性来调用我们的单元测试，但这是在部署之前运行的。我还需要设置哪些其他属性？这是可能吗？

2.  我用谷歌搜索/MSDN 相信我们可能需要第三台服务器，上面有一个测试控制器和测试代理（没有被屏幕保护程序锁定，构建服务帐户具有权限，并且构建服务配置为作为一个交互过程运行而不是服务）。这个对吗？

3.  如果我们想在测试运行时对测试进行视频记录，人们发现这很有用吗？它的功能/配置是否像文章所暗示的那样简单？

4.  Visual Studio 2012 Ultimate 可以做 Microsoft Test Manager 2012 做的所有事情吗？反之亦然？我没有用过这个，想知道这是否真的只是一个测试工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T23:17:22.667

> 1\. 我们可以在本地记录这些测试，添加断言等并将它们签入 TFS 等，但我的问题是如何在我们的构建序列结束时从 TFS Build 调用它们而不升级到 defaulttemplate.xaml？我们使用真正的构建属性来调用我们的单元测试，但这是在部署之前运行的。我还需要设置哪些其他属性？这是可能吗？

如果将编码的 ui 测试用作 unittest dll 中的独立单元测试，则 mstest 应该选择编码的 ui 测试。然而，如果编码的 ui 测试是测试用例的自动化，另一种方法是使用 TCM 命令行工具来启动测试用例，从而执行编码的 ui 测试。

> 2\. 我用谷歌搜索/MSDN 相信我们可能需要第三台服务器，上面有一个测试控制器和测试代理（没有被屏幕保护程序锁定，构建服务帐户具有权限，并且构建服务配置为作为交互式过程而不是服务）。这个对吗？

是的：您需要一个交互式构建代理。否：当前构建代理也可以设置为交互式。

> 3\. 如果我们想在测试运行时对测试进行视频记录，人们发现这很有用吗？它的功能/配置是否像文章所暗示的那样简单？

是：正如文章所暗示的那样工作 否：智能跟踪收集器和日志通常比视频记录更有用。这些文章还忘记提到，如果不小心处理，您的 TFS 服务器可能会不成比例地增长。[http://geekswithblogs.net/terje/archive/2011/11/15/guide-to-reduce-tfs-database-growth-using-the-test-attachment.aspx](http://geekswithblogs.net/terje/archive/2011/11/15/guide-to-reduce-tfs-database-growth-using-the-test-attachment.aspx)

> 4\. Visual Studio 2012 Ultimate 可以做 Microsoft Test Manager 2012 做的所有事情吗？反之亦然？我没有用过这个，想知道这是否真的只是一个测试工具？

不，不一样，不要试图假装（如混合）。工具的侧重点不同；MTM 专注于由测试人员进行测试（功能性、手动、探索性），Visual Studio 中的测试专注于作为开发人员进行测试（单元测试、Web 测试、自动化测试）。因此，Visual Studio Ultimate 无法编辑和创建测试用例和套件。MTM 无法创建开发（编码）单元测试测试。安装 Visual Studio Ultimate 还会安装 MTM，因此如果需要，您可以同时使用两者。

# python - 用一个变量找到大量函数的根

> ID：13088115
> 
> 赞同：11
> 
> 时间：2012-10-26T13:43:32.603
> 
> 标签：python, numpy, scipy, raytracing

我正在使用 Python/numpy/scipy 编写一个小型光线追踪器。表面被建模为二维函数，给出高于法线平面的高度。我将寻找射线和表面之间的交点的问题简化为找到具有一个变量的函数的根。函数是连续且连续可微的。

有没有办法比使用 scipy 根查找器（并且可能使用多个进程）简单地遍历所有函数更有效地做到这一点？

编辑：函数是表示光线的线性函数和表面函数之间的差异，被约束到一个相交平面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T03:16:37.217

以下示例显示了使用二分法并行计算函数 x**(a+1) - b（均具有不同的 a 和 b）的 100 万份的根。这里大约需要 12 秒。

```
import numpy

def F(x, a, b):
    return numpy.power(x, a+1.0) - b

N = 1000000

a = numpy.random.rand(N)
b = numpy.random.rand(N)

x0 = numpy.zeros(N)
x1 = numpy.ones(N) * 1000.0

max_step = 100
for step in range(max_step):
    x_mid = (x0 + x1)/2.0
    F0 = F(x0, a, b)
    F1 = F(x1, a, b)
    F_mid = F(x_mid, a, b)
    x0 = numpy.where( numpy.sign(F_mid) == numpy.sign(F0), x_mid, x0 )
    x1 = numpy.where( numpy.sign(F_mid) == numpy.sign(F1), x_mid, x1 )
    error_max = numpy.amax(numpy.abs(x1 - x0))
    print "step=%d error max=%f" % (step, error_max)
    if error_max < 1e-6: break 
```

基本思想是简单地在变量向量上并行运行根查找器的所有常用步骤，使用可以在变量向量和定义各个组件函数的参数的等效向量上评估的函数。条件被替换为掩码和 numpy.where() 的组合。这可以一直持续到所有根都找到了所需的精度，或者直到找到了足够的根，值得将它们从问题中删除，并继续处理排除这些根的较小问题。

我选择解决的函数是任意的，但如果函数表现良好，它会有所帮助；在这种情况下，族中的所有函数都是单调的，并且只有一个正根。此外，对于二分法，我们需要对给出函数不同符号的变量进行猜测，而这些恰好在这里也很容易得出（x0 和 x1 的初始值）。

上面的代码可能使用了最简单的求根器（二分法），但同样的技术可以很容易地应用于 Newton-Raphson、Ridder's 等。求根方法中的条件越少，就越适合这种方法。但是，您将不得不重新实现您想要的任何算法，无法直接使用现有的库根查找器函数。

上面的代码片段是为了清晰而不是速度而编写的。避免重复某些计算，特别是每次迭代仅评估函数一次而不是 3 次，将其加速到 9 秒，如下所示：

```
...
F0 = F(x0, a, b)
F1 = F(x1, a, b)

max_step = 100
for step in range(max_step):
    x_mid = (x0 + x1)/2.0
    F_mid = F(x_mid, a, b)
    mask0 = numpy.sign(F_mid) == numpy.sign(F0)
    mask1 = numpy.sign(F_mid) == numpy.sign(F1)
    x0 = numpy.where( mask0, x_mid, x0 )
    x1 = numpy.where( mask1, x_mid, x1 )
    F0 = numpy.where( mask0, F_mid, F0 )
    F1 = numpy.where( mask1, F_mid, F1 )
... 
```

作为比较，使用 scipy.bisect() 一次查找一个根需要大约 94 秒：

```
for i in range(N):
    x_root = scipy.optimize.bisect(lambda x: F(x, a[i], b[i]), x0[i], x1[i], xtol=1e-6) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-11-24T06:48:44.383

在过去几年的某个时候，`scipy.optimize.newton`获得了矢量化支持。使用另一个答案中的示例现在看起来像：

```
import numpy as np
from scipy import optimize

def F(x, a, b):
    return np.power(x, a+1.0) - b

N = 1000000

a = np.random.rand(N)
b = np.random.rand(N)

optimize.newton(F, np.zeros(N), args=(a, b)) 
```

这与另一个答案中的矢量化二分法一样快。

# sql - DB2 sql 查询以查找字符串中的非 ascii 字符

> ID：13088119
> 
> 赞同：2
> 
> 时间：2012-10-26T13:43:39.243
> 
> 标签：sql, character-encoding, db2

我有一个表（比如`ELEMENTS`），其中包含一个名为 VARCHAR 字段的`NAME`编码`ccsid 1144`。我需要在`NAME`字段中找到包含“非 ascii 字符”的所有字符串，即字符`ccsid 1144`集中没有 ascii 字符的字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:11:58.707

我认为您应该能够创建这样的函数：

```
CREATE FUNCTION CONTAINS_NON_ASCII(INSTR VARCHAR(4000))
  RETURNS CHAR(1)
  DETERMINISTIC NO EXTERNAL ACTION CONTAINS SQL
  BEGIN ATOMIC
  DECLARE POS, LEN INT;
  IF INSTR IS NULL THEN
    RETURN NULL;
  END IF;
  SET (POS, LEN) = (1, LENGTH(INSTR));
  WHILE POS <= LEN DO
    IF ASCII(SUBSTR(INSTR, POS, 1)) > 128 THEN
      RETURN 'Y';
    END IF;
    SET POS = POS + 1;
  END WHILE;
  RETURN 'N';
END 
```

然后写：

```
SELECT NAME
  FROM ELEMENTS
 WHERE CONTAINS_NON_ASCII(NAME) = 'Y'
; 
```

（免责声明：*完全*未经测试。）

顺便说一句——从文档来看，这似乎`VARCHAR`是一串字节，而不是 Unicode 字符。（字节范围从 0 到 0xFF；Unicode 字符范围从 0 到 0x10FFFD。）如果您对支持 Unicode 感兴趣，您可能想要使用不同的数据类型。

# ios - Http直播：EXT-X-DISCONTINUITY标签使之后的所有片段只有音频

> ID：13088123
> 
> 赞同：5
> 
> 时间：2012-10-26T13:43:56.687
> 
> 标签：ios, ios5, video-streaming, http-live-streaming

我在 iOS 设备系列上播放 HTTP Live Streaming，在 iOS 5 和 6 上使用 Apple 的 AVPlayer 库。

由于我在内容剪辑之间播放广告，因此我使用#EXT-X-DISCONTINUITY 标签，正如帮助回答前一个问题的出色人士所建议的那样。

这一直适用于单一比特率，但**只有**在使用带有多个比特率的子播放列表的变体播放列表时才会遇到问题。只有在第一个不连续标签之后，我才会收到带有音频的黑屏，即使在广告结束后它也永远不会恢复。（我能听到广告）。

这已经在 iPhone 4、4S、5 和 iPod Touch 第 4 代上进行了测试和复制。iphone 4 在 iOS 5 上，其余的是 iOS 6。它大部分时间都会发生，但不是每次都发生。但可以肯定的是，我想强调的是，**只有当我的变体播放列表包含多个比特率子播放列表时才会发生这种情况。**

这是我使用的播放列表的示例（这是 400kbps 版本，我有一个 200 和 800kbps 版本，其对应的播放列表看起来与下面完全一样，但将所有“400”替换为“200”和“800”。（好吧，实际的播放列表更长，但这是一个示例）。

```
#EXTM3U
#EXT-X-TARGETDURATION:10
#EXT-X-MEDIA-SEQUENCE:0
#EXTINF:10,
400-clipA-0.ts
#EXTINF:10,
400-clipA-1.ts
#EXTINF:5,
400-clipA-2.ts

#EXT-X-DISCONTINUITY
#EXTINF:10,
400-advert0.ts
#EXTINF:3,
400-advert1.ts

#EXT-X-DISCONTINUITY
#EXTINF:10,
400-clipB-0.ts
#EXTINF:10,
400-clipB-1.ts
#EXTINF:5,
400-clipB-2.ts

#EXT-X-ENDLIST 
```

我有在子播放列表之间进行选择的变体播放列表：

```
#EXTM3U
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=240000
clips-200.m3u8
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=440000
clips-400.m3u8
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=840000
clips-800.m3u8 
```

请注意，发生的情况（大约 75% 的时间）是，当我播放此视频时，视频将在第一个不连续标记之后（就在广告之前）变黑，并且再也不会恢复，尽管我可以听到广告。例如，如果我制作了只有一个比特率变体的变体播放列表：

```
#EXTM3U
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=280000
clips-200.m3u8 
```

然后我根本没有遇到这个问题！很奇怪。此外，如果我删除了所有不连续性标签，并且仍然将其他比特率保留在变体播放列表中，那么它可以正常工作（通常），但有时它会出于某种原因跳过整个 .ts 文件，可能是因为它需要那些不连续性标签。

此外，当我直接在 Amazon Cloudfront 上播放文件时，这种情况发生得更频繁，而不是从它们最初所在的 Amazon S3 存储桶中播放。

其他一些可能有帮助的信息：我的原始文件（剪辑和广告）都是从 iPhone 4 获取的 .mov 文件，每个文件的分辨率相同。我的输出（.ts 文件）都是从这些生成的——对于每个比特率类，我在剪辑和广告中都有相同的编码设置。否则输出都是相同的分辨率和帧率。

最后一件事，Apple提供的mediasegmentvalidator在我使用它进行检查时没有给出任何警告。

我非常感谢你们可以提供的任何帮助！这对我来说是一个令人费解的问题:-(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T00:20:06.483

我要检查的东西（没有任何特定的顺序，只是我想到的顺序）。

1.  这些段实际上是 M3U8 声称的长度吗
2.  里面的音视频流是不是一样长
3.  advert0.ts 是否以视频关键帧开头（这是一个大问题！）
4.  视频和音频编解码器和参数是否相同（尤其是音频 - 完全不能改变）
5.  流是否在其他兼容 HLS 的设备或应用程序上播放？例如，您可以使用 VLC 播放流吗？
6.  有什么方法可以让您查看服务器日志以查看故障发生之前和之后您正在玩什么级别，如果是这样，这可能指向一个答案（例如，如果设备在不连续性上切换级别​​，也许您可以减少第一个段块的段大小，以便您获得一个额外的段，从而提供更早切换的机会。

抱歉，我没有一个答案，但有很多微小的事情会绊倒你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-27T00:14:15.877

如果您`#EXT-X-DISCONTINUITY`在变体流中使用，那么您应该`#EXT-X-DISCONTINUITY-SEQUENCE:<number>`在每个变体中都有。

见：[https ://datatracker.ietf.org/doc/html/draft-pantos-http-live-streaming-18#section-4.3.3.3](https://datatracker.ietf.org/doc/html/draft-pantos-http-live-streaming-18#section-4.3.3.3)

# ios - 快速截图ios

> ID：13088131
> 
> 赞同：0
> 
> 时间：2012-10-26T13:44:17.013
> 
> 标签：ios, performance, screenshot, blur, low-level

在我的项目中，我必须制作屏幕截图并应用模糊来创建磨砂玻璃的效果。可以在玻璃下移动内容并改变模糊的图片。

我使用 Accelerate.framework 来加速模糊，我也使用 OpenGL 将 CIImage 直接绘制到 GLView。

现在我正在寻找一种优化获取屏幕截图的方法。我使用这种方法来获取屏幕底部某些区域的屏幕截图：

```
 CGSize size = CGSizeMake(rect.size.width, rect.size.height);

    // get screenshot of self.view
    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    CGContextRef ctx = CGBitmapContextCreate(nil, size.width, size.height, 8, 0, colorSpaceRef, kCGImageAlphaPremultipliedFirst);
    CGContextClearRect(ctx, rect);
    CGColorSpaceRelease(colorSpaceRef);
    CGContextSetInterpolationQuality(ctx, kCGInterpolationNone);
    CGContextSetShouldAntialias(ctx, NO);
    CGContextSetAllowsAntialiasing(ctx, NO);
    CGContextTranslateCTM(ctx, 0.0, someView.frame.size.height);
    CGContextScaleCTM(ctx, 1, -1);

    //add mask
    CGImageRef maskImage = [UIImage imageNamed:@"mask.png"].CGImage;
    CGContextClipToMask(ctx, rect, maskImage);

    [someView.layer renderInContext:ctx];

    //get screenshot image
    CGImageRef imageRef = CGBitmapContextCreateImage(ctx); 
```

如果 self.view 有 1-2 个子视图，它工作得又快又好，但是如果有几个子视图（或者它是 tableview），那么一切都开始变慢。

所以我试图找到一种快速的方法来从屏幕上的某个矩形中获取像素。也许使用低级 API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-17T08:41:15.747

如果只是做一些动画，试试这种方式，调用`-snapshotViewAfterScreenUpdates:`或者`-resizableSnapshotViewFromRect:afterScreenUpdates:withCapInsets:`UIView提供的方法，这些方法返回UIView对象而不渲染成位图图像，这样效率更高。

# jquery - 按验证规则分组，而不是按类

> ID：13088136
> 
> 赞同：0
> 
> 时间：2012-10-26T13:44:25.500
> 
> 标签：jquery, jquery-validate

我正在使用带有[验证](http://docs.jquery.com/Plugins/Validation)插件的 jQuery 来验证表单。我还使用 jQuery-ui 的[自动完成功能](http://jqueryui.com/autocomplete/#remote)为其中一个字段提供可接受值的列表。两个字段，`prov_type`并`prov_date`控制自动完成列表的内容。`prov_type`是一个单选按钮，是一个附加了[日期选择器](http://jqueryui.com/datepicker/)`prov_date`的文本输入。

## 目标

1.  在与正常规则不同的位置显示来自失败`hasantecedent`规则的消息
2.  仅显示`hasantecedent`一次失败消息，即使它适用于 2 个字段

## 问题

我已将`prov_type`and添加`prov_date`为`$.validator.groups`实现第二个目标的“hasant”。问题是他们实际上只是`hasantecedent`规则的一个群体。适用于它们的任何其他规则（例如，在 上的日期验证`prov_date`）实际上应该表现得好像元素没有被分组一样。我*认为*这可能可以在 in`errorPlacement`或 in 中解决，`showError`但我不知道如何解决。

想法？

## 代码

### 验证默认值

```
$.validator.setDefaults({
    debug: true,
    ignore: ":hidden", // do not validate form fields in invisible sections
    focusCleanup: true,
    errorPlacement: function(error, element) {

        //something here to determine for placement of group rules?

        if ( element.is(":radio") ) {
            error.appendTo( element.parent().next().next() );
        }else if(element.is(":checkbox") && element.parent().is('li')){
            error.insertBefore(element.closest("ul.horiz"));
        }else{
            error.appendTo(element.parent());
        };
    },
    success:'checked',// set this class to error-labels to indicate valid fields
    validClass:'checked'//set this to same so valid class will be removed from fields that become errors
}); 
```

### 有先例规则

```
$.validator.addMethod("hasantecedent", function( value, element ) {
    set_possible_antecedents();
    var type=$('input[name="prov_type"]:checked').val();

    var r = $('#prov_date').data(type).length;
    if(r){
        $('.antecedent',$('#'+ type)).removeAttr('disabled');
    } else {
        $('.antecedent',$('#'+ type)).attr('disabled','disabled');
    }

    return r;
}, 'No fish are available for the current provenance date.'); 
```

### 表单验证

```
$("form[name='provenance']").validate({
    onkeyup: function(element, event){ //no keyup validation for fields with UI widgets
        if(jQuery.inArray( element.name,['prov_date','dam', 'sire','reuse'])>-1) return;
         $.validator.defaults.onkeyup.call(this, element, event);
    },
    groups:{hasant: 'prov_type prov_date'},
    rules: {
        prov_type: {hasantecedent: {depends: function(e){ return jQuery.inArray( $('input[name="prov_type"]:checked').val(),['cross','reuse']) > -1;}}},
        prov_date: {
            dateCan:true,
            hasantecedent: {
                depends: function(e){return jQuery.inArray( $('input[name="prov_type"]:checked').val(),['cross','reuse']) > -1;}
            }
        },
        fish_id: { required: true, pkey: true},
        dam_id: {
            required: function(e) {return $('input[name="prov_type"]:checked').val()=='cross';},
            pkey: true
        },
        sire_id: {
            required: function(e) {return $('input[name="prov_type"]:checked').val()=='cross';},
            pkey: true
        },
        dam: {
            required: function(e) {return $('input[name="prov_type"]:checked').val()=='cross';},
            isantecedent: {
                depends: function(e){return $('input[name="prov_type"]:checked').val()=='cross';}
            }
        },
        sire:{
            required: function(e) {return $('input[name="prov_type"]:checked').val()=='cross';},
            isantecedent: {
                depends: function(e){return $('input[name="prov_type"]:checked').val()=='cross';}
            },
        },
        dam_count: {
            digits: function(e) {return $('input[name="prov_type"]:checked').val()=='cross';},
            min:0
        },
        sire_count: {
            digits: function(e) {return $('input[name="prov_type"]:checked').val()=='cross';},
            min:0
        },
        supplier_id:{
            required: function(e) {return $('input[name="prov_type"]:checked').val()=='delivery';},
            pkey: true
        },
        removal_id:{
            required: function(e) {return $('input[name="prov_type"]:checked').val()=='reuse';},
            pkey: true
        },
        removal: {
            required: function(e) {return $('input[name="prov_type"]:checked').val()=='reuse';},
            isantecedent: {
                depends: function(e){return $('input[name="prov_type"]:checked').val()=='reuse';}
            }
        },
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T16:00:30.520

我最终要做的是删除组，在消息可以去的地方`hasant`添加一个静态div，并在规则中添加一个切换 vis。像这样：`#hasant``hasantecedent`

# javascript

```
$.validator.addMethod("hasantecedent", function( value, element ) {
    set_possible_antecedents();
    var type=$('input[name="prov_type"]:checked').val();
    var r = $('#prov_date').data(type).length;
    if(r){
        $('input.antecedent').removeAttr('disabled').removeClass('warning');
        $( "#hasant" ).hide();
    } else {
        $('input.antecedent').attr('disabled','disabled').addClass('warning');
                $( "#hasant" ).show();
    }
    return r;
},  ' '); 
```

# css

```
#hasant {
    display:none;
    color:#C7252B;
    border: 2px solid #C7252B;
    position: absolute;
    top:100%;
    left:65%;
    width: 15em;
    padding: 1em;
} 
```

# html

```
<div id='hasant'>No fish are available for the current provenance date.</div> 
```

# asp.net - 当您更改字符串资源时，需要部署的最低限度是多少？

> ID：13088137
> 
> 赞同：3
> 
> 时间：2012-10-26T13:44:25.533
> 
> 标签：asp.net, .net

最近我修正了一个 .resx 文件中的错字。编译并将 MyApp.resources.dll 放在我们测试服务器的 bin\en 文件夹中，然后进行 iisreset。文字没有改变。甚至反编译以确保我的更改在那里。

所以我做了一个全面的部署，然后我看到了变化。我想我需要的不仅仅是资源 dll，我想知道我至少需要部署什么。

谢谢，迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T10:05:20.440

这是因为 ASP.NET 一直使用缓存在“Temporary asp.net files”文件夹中的 DLL。

清理该文件夹应该会有所帮助。此外，“触摸”主项目 DLL 将导致 IIS/ASP.NET 从“bin”文件夹中获取文件并更新“临时”文件。

```
"C:\WINDOWS\Microsoft.NET\Framework\vXXXXXXX\Temporary ASP.NET Files" 
```

# javascript - Javascript Call 和 Apply 一起使用

> ID：13088139
> 
> 赞同：4
> 
> 时间：2012-10-26T13:44:40.370
> 
> 标签：javascript

我知道**调用**并在 javascript 中**应用**，但是 javascript Call 和 Apply 之间的区别到底是什么？？另一件事我发现一些代码像这样一起使用它：

```
 function doSomething() {
    return Function.prototype.call.apply(Array.prototype.slice, arguments);
} 
```

是一样的..

```
Array.prototype.slice.apply(arguments) 
```

为什么我们要同时使用 call 和 apply 呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T13:48:46.067

不，不一样。`Array.prototype.slice.apply(arguments)`在当前`argument`对象上应用切片函数，同时`Function.prototype.call.apply(Array.prototype.slice, arguments);`在作为第一个参数提供的数组上调用切片函数。

使用新的 EcmaScript 语法，这样的事情可能会变得更容易。你`doSomething`的相当于

```
function doSomething(array, ...)
    array.slice(...); // assuming array is really an array
} 
```

而第二个相当于

```
function (...) {
    arguments.slice(); // assuming argument objects are actual arrays
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T06:40:45.177

一样

```
Array.prototype.slice.apply(arguments) 
```

是的，我也认为它是一样的..!!

# java - Java：如何严格解析日期？

> ID：13088140
> 
> 赞同：21
> 
> 时间：2012-10-26T13:44:41.197
> 
> 标签：java, validation, parsing, date

[SimpleDateFormat](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)是一个非常友好的解析器，它滚动生成的日期而不是抛出错误。如何在没有正则表达式等的情况下严格解析日期？

```
fmt = new SimpleDateFormat("dd.MM.yyyy")
fmt.parse("10.11.2012")   // it works
fmt.parse("10.1150.2012") // it works but it's unwanted 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-10-26T13:46:42.760

[`fmt.setLenient(false);`](http://docs.oracle.com/javase/7/docs/api/java/text/DateFormat.html#setLenient(boolean))就是你要找的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-06-14T14:23:57.657

# java.time

您还可以在 Java 8 及更高版本（[教程](http://docs.oracle.com/javase/tutorial/datetime/index.html)）中使用[java.time 包。](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)它的解析严格检查日期值。

例如：

```
String strDate = "20091504";
TemporalAccessor ta = DateTimeFormatter.ofPattern("yyyyMMdd").parse(strDate); 
```

直接给出：

```
Exception in thread "main" java.time.format.DateTimeParseException:
Text '20091504' could not be parsed:
Invalid value for MonthOfYear (valid values 1 - 12): 15 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-05T20:07:51.460

不幸的是 fmt.setLenient(false); 不会实现严格的日期格式。它可以帮助一些人，例如，如果 lenient==true，使用格式“yyyyMMdd”解析“2010-09-01”将成功，但结果非常奇怪：2009/12/09。

即使 lenient==false parse() 仍然表现得很宽松。模式“yyyy/MM/dd”允许使​​用“2010/01/5”。对于“yyyy/yyyy”模式，像“1999/2011”这样的数据分歧是可以容忍的（产生于 2011 年）。模式匹配后也允许垃圾。例如：“20100901”和“20100901andGarbage”都将匹配“yyyyMMdd”。

我编写了 SimpleDateFormat 的扩展，它强制执行严格的模式匹配。你可以在这里找到它：

[SimpleDateFormat.parse() 忽略模式中的字符数](https://stackoverflow.com/questions/16014488/simpledateformat-parse-ignores-the-number-of-characters-in-pattern/19503019#19503019)

在我的版本中，format() 和 parse() 是函数的逆函数。这是我认为大多数人所期望的。

# iphone - 合并 2 个 CMTimeRanges 数组 - Objective C

> ID：13088141
> 
> 赞同：0
> 
> 时间：2012-10-26T13:44:48.400
> 
> 标签：iphone, objective-c, ios, ipad

我的应用程序有一部分必须在其中处理时间跨度对象数组并将它们与 1 优先于另一个合并，例如数组 1 可能是：

> 0：0-4
> 
> 1：4-6
> 
> 2：6-9

我要合并的那个优先

> 0：2-7
> 
> 1：7-8

所以我需要合并 2 并最终得到：

> 0：0-2
> 
> 1：2-7
> 
> 2：7-8
> 
> 3：8-9

我对如何递归处理这样的任务有点坚持，每个数组中可能有几个时间范围，但也可能有数百个。有什么建议么？

# regex - 如何用PERL中的另一个变量替换一个变量？

> ID：13088144
> 
> 赞同：2
> 
> 时间：2012-10-26T13:44:59.820
> 
> 标签：regex, perl, search, replace, match

我正在尝试替换文本中的所有单词，除了我在数组中的一些单词。这是我的代码：

```
my $text = "This is a text!And that's some-more text,text!";
while ($text =~ m/([\w']+)/g) {

    next if $1 ~~ @ignore_words;

    my $search  = $1;
    my $replace = uc $search;
    $text =~ s/$search/$replace/e;
} 
```

但是，该程序不起作用。基本上我试图让所有单词都大写，但跳过@ignore_words 中的那些。我知道这是正则表达式中使用的变量的问题，但我无法解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:54:59.153

```
#!/usr/bin/perl

my $text = "This is a text!And that's some-more text,text!";

my @ignorearr=qw(is some);

my %h1=map{$_ => 1}@ignorearr;
$text=~s/([\w']+)/($h1{$1})?$1:uc($1)/ge;

print $text; 
```

在运行这个，

```
THIS is A TEXT!AND THAT'S some-MORE TEXT,TEXT! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T16:39:54.687

如果不是将表达式应用于循环的同一控制变量，您可以从代码中找出问题`while`，只需让`s/../../eg`全局为您执行此操作：

```
my $text = "This is a text!And that's some-more text,text!";

my @ignore_words = qw{ is more };

$text =~ s/([\w']+)/$1 ~~ @ignore_words ? $1 : uc($1)/eg;

print $text; 
```

在运行时：

```
THIS is A TEXT!AND THAT'S SOME-more TEXT,TEXT! 
```

# powershell - Powershell 构建日志表

> ID：13088146
> 
> 赞同：0
> 
> 时间：2012-10-26T13:45:03.627
> 
> 标签：powershell

好的，所以这可能是一个奇怪的请求，但我是 powershell 的新手，但已经玩了几天，并且有一个想法，但不确定如何去做。我想制作一个如下所示的结果表。

```
Computer Name(s)   Attempt(s)   Result          Last Attempt
Computer1          1            Successful      9:31 25 Oct 12
Computer2          24           Unsuccessful    12:08 25 Oct 12
Computer3          9            Successful      11:22 25 Oct 12
Computer4          11           Unsuccessful    04:11 25 Oct 12
Computer5          12           Unsuccessful    07:19 25 Oct 12 
```

我整理了一个命令，似乎可以得到我想要的结果，但需要一些调整才能获得我需要的附加功能。

```
( Get-Content .\~temp.txt ) | Foreach-Object {$_ -replace "$Computername,.*", ($Computername + "," + $Attempts + "," + $Result + "," + $Time.ToShortTimeString() + "," + $Time.ToShortDateString())} | Set-Content .\~temp.txt 
```

第一件事第一。我需要从文本文件（Computers.txt）中加载所有计算机并将它们中的每一台加载到新文件（~temp.txt）中，我正在考虑以下内容。

（注意：未经测试，只是一个想法）

```
$Computers = Get-Content .\computers.txt
IF (Test-Path .\~temp.txt) {
      IF ( Select-String .\~temp.txt -pattern $Computer -quiet ) {} ELSE { Add-Content ./~test.txt "$Computer," }
} ELSE {
      ForEach ($Computer in $Computers) {
      add-content .\~temp.txt "$Computer,"
} 
```

接下来是从行中提取尝试次数和最后一个结果。老实说，我找不到如何做到这一点，希望有人可以通过一些解释他们如何做到这一点的评论来告诉我如何做到这一点，或者对于我应该在谷歌上搜索的一些方向。感谢您花时间阅读本文，非常感谢您提供任何/所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:24:17.773

想通了:) 对于任何想知道的人

```
$UpdateLog = Select-String .\~Temp.txt -pattern $ComputerName 
$Attempts = $UpdateLog.ToString().Split(",")[1] 
$Result = $UpdateLog.ToString().Split(",")[2] 
```

# http - 如何使用 AngularJS 进行 $http 同步调用

> ID：13088153
> 
> 赞同：132
> 
> 时间：2012-10-26T13:45:46.153
> 
> 标签：http, angularjs

有没有办法用 AngularJS 进行同步调用？

AngularJS 文档对于找出一些基本的东西不是很明确或广泛。

在服务上：

```
myService.getByID = function (id) {
    var retval = null;

    $http({
        url: "/CO/api/products/" + id,
        method: "GET"
    }).success(function (data, status, headers, config) {

        retval = data.Data;

    });

    return retval;
} 
```

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-10-26T14:00:52.260

不是现在。如果您[查看源代码（从 2012 年 10 月的这个时间点开始）](https://github.com/angular/angular.js/blob/e0a54f6b206dc2b6595f2bc3a17c5932e7477545/src/ng/httpBackend.js#L56)，您会发现对 XHR open 的调用实际上是硬编码为异步的（第三个参数为 true）：

```
 xhr.open(method, url, true); 
```

您需要编写自己的服务来进行同步调用。通常这不是你通常想做的事情，因为 JavaScript 执行的性质你最终会阻塞其他一切。

...但是..如果实际上需要阻止其他所有内容，也许您应该查看 promises 和[$q 服务](https://docs.angularjs.org/api/ng/service/$q)。它允许您等到一组异步操作完成，然后在它们全部完成后执行某些操作。我不知道您的用例是什么，但这可能值得一看。

除此之外，如果您要自己动手，[可以在此处找到](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Synchronous_and_Asynchronous_Requests)有关如何进行同步和异步 ajax 调用的更多信息。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-06-26T08:57:26.003

我曾与一家集成了谷歌地图自动完成和承诺的工厂合作过，我希望你能服务。

[http://jsfiddle.net/the_pianist2/vL9nkfe3/1/](http://jsfiddle.net/the_pianist2/vL9nkfe3/1/)

您只需要在工厂之前使用 $ http incuida 替换此请求的 autocompleteService 即可。

```
app.factory('Autocomplete', function($q, $http) { 
```

和 $ http 请求

```
 var deferred = $q.defer();
 $http.get('urlExample').
success(function(data, status, headers, config) {
     deferred.resolve(data);
}).
error(function(data, status, headers, config) {
     deferred.reject(status);
});
 return deferred.promise;

<div ng-app="myApp">
  <div ng-controller="myController">
  <input type="text" ng-model="search"></input>
  <div class="bs-example">
     <table class="table" >
        <thead>
           <tr>
              <th>#</th>
              <th>Description</th>
           </tr>
        </thead>
        <tbody>
           <tr ng-repeat="direction in directions">
              <td>{{$index}}</td>
              <td>{{direction.description}}</td>
           </tr>
        </tbody>
     </table>
  </div>

'use strict';
 var app = angular.module('myApp', []);

  app.factory('Autocomplete', function($q) {
    var get = function(search) {
    var deferred = $q.defer();
    var autocompleteService = new google.maps.places.AutocompleteService();
    autocompleteService.getPlacePredictions({
        input: search,
        types: ['geocode'],
        componentRestrictions: {
            country: 'ES'
        }
    }, function(predictions, status) {
        if (status == google.maps.places.PlacesServiceStatus.OK) {
            deferred.resolve(predictions);
        } else {
            deferred.reject(status);
        }
    });
    return deferred.promise;
};

return {
    get: get
};
});

app.controller('myController', function($scope, Autocomplete) {
$scope.$watch('search', function(newValue, oldValue) {
    var promesa = Autocomplete.get(newValue);
    promesa.then(function(value) {
        $scope.directions = value;
    }, function(reason) {
        $scope.error = reason;
    });
 });

}); 
```

问题本身将针对：

```
deferred.resolve(varResult); 
```

当你做得很好并且请求：

```
deferred.reject(error); 
```

当出现错误时，然后：

```
return deferred.promise; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-09-04T10:37:43.543

```
var EmployeeController = ["$scope", "EmployeeService",
        function ($scope, EmployeeService) {
            $scope.Employee = {};
            $scope.Save = function (Employee) {                
                if ($scope.EmployeeForm.$valid) {
                    EmployeeService
                        .Save(Employee)
                        .then(function (response) {
                            if (response.HasError) {
                                $scope.HasError = response.HasError;
                                $scope.ErrorMessage = response.ResponseMessage;
                            } else {

                            }
                        })
                        .catch(function (response) {

                        });
                }
            }
        }]

var EmployeeService = ["$http", "$q",
            function ($http, $q) {
                var self = this;

                self.Save = function (employee) {
                    var deferred = $q.defer();                
                    $http
                        .post("/api/EmployeeApi/Create", angular.toJson(employee))
                        .success(function (response, status, headers, config) {
                            deferred.resolve(response, status, headers, config);
                        })
                        .error(function (response, status, headers, config) {
                            deferred.reject(response, status, headers, config);
                        });

                    return deferred.promise;
                }; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-07-21T15:01:20.603

我最近遇到了一种情况，我想通过页面重新加载触发 $http 调用。我采用的解决方案：

1.  将两个调用封装成函数
2.  将第二个 $http 调用作为回调传递给第二个函数
3.  调用 apon .success 中的第二个函数

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-02T13:51:11.543

这是一种您可以异步执行并像平常一样管理事情的方法。一切仍然是共享的。您将获得对要更新的对象的引用。每当您在服务中更新它时，它都会在全球范围内更新，而无需观看或返回承诺。这非常好，因为您可以从服务内部更新底层对象，而无需重新绑定。以应有的方式使用 Angular。我认为使 $http.get/post 同步可能是一个坏主意。您会在脚本中看到明显的延迟。

```
app.factory('AssessmentSettingsService', ['$http', function($http) {
    //assessment is what I want to keep updating
    var settings = { assessment: null };

    return {
        getSettings: function () {
             //return settings so I can keep updating assessment and the
             //reference to settings will stay in tact
             return settings;
        },
        updateAssessment: function () {
            $http.get('/assessment/api/get/' + scan.assessmentId).success(function(response) {
                //I don't have to return a thing.  I just set the object.
                settings.assessment = response;
            });
        }
    };
}]);

    ...
        controller: ['$scope', '$http', 'AssessmentSettingsService', function ($scope, as) {
            $scope.settings = as.getSettings();
            //Look.  I can even update after I've already grabbed the object
            as.updateAssessment(); 
```

在某个视图中：

```
<h1>{{settings.assessment.title}}</h1> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-12T07:35:47.230

由于[同步 XHR](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests#Synchronous_request)已被弃用，因此最好不要依赖它。如果您需要执行同步 POST 请求，您可以在服务内部使用以下帮助程序来模拟表单发布。

它通过创建一个带有隐藏输入的表单来工作，该表单发布到指定的 URL。

```
//Helper to create a hidden input
function createInput(name, value) {
  return angular
    .element('<input/>')
    .attr('type', 'hidden')
    .attr('name', name)
    .val(value);
}

//Post data
function post(url, data, params) {

    //Ensure data and params are an object
    data = data || {};
    params = params || {};

    //Serialize params
    const serialized = $httpParamSerializer(params);
    const query = serialized ? `?${serialized}` : '';

    //Create form
    const $form = angular
        .element('<form/>')
        .attr('action', `${url}${query}`)
        .attr('enctype', 'application/x-www-form-urlencoded')
        .attr('method', 'post');

    //Create hidden input data
    for (const key in data) {
        if (data.hasOwnProperty(key)) {
            const value = data[key];
            if (Array.isArray(value)) {
                for (const val of value) {
                    const $input = createInput(`${key}[]`, val);
                    $form.append($input);
                }
            }
            else {
                const $input = createInput(key, value);
                $form.append($input);
            }
        }
    }

    //Append form to body and submit
    angular.element(document).find('body').append($form);
    $form[0].submit();
    $form.remove();
} 
```

根据您的需要进行修改。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2017-05-24T13:23:56.857

将您的呼叫包装在一个`Promise.all()`方法中怎么样？

`Promise.all([$http.get(url).then(function(result){....}, function(error){....}])`

根据[MDN](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise/all)

> Promise.all 等待所有的履行（或第一次拒绝）

# entity-framework - 使用 LINQ 多对多 (MTM) 关联进行查询时遇到的困难

> ID：13088163
> 
> 赞同：1
> 
> 时间：2012-10-26T13:46:31.830
> 
> 标签：entity-framework, linq-to-entities

恕我直言，我认为这对我来说是最难得到的——LINQ 的整个 MTM 方面，我需要帮助。

在 SQL 中，我有 3 个表`Accounts`：`AccountsInFeatures`和`Features`. `AccountsInFeatures`只是有两个链接到的主键`Accounts`列`Features`。

在 EF 中，`AccountsInFeatures`不可见 - 我明白为什么 - 但我在创建 LINQ 时遇到问题：

这是我正在尝试做的事情：

```
return (from a in _Store.Accounts
        where a.AccountGUID == _AccountGUID
        select new AccountDetails
        {
            AccountGUID = a.AccountGUID
            AccountName = a.AccountName,
            SelectedFeatures = a.Features.Select(f => f.FeatureGUID).ToList()
        }).ToList(); 
```

这是 的定义`AccountDetails`：

```
public class AccountDetails
{
    public Guid AccountGUID { get; set; }
    public string AccountName { get; set; }  
    public List<Guid> SelectedFeatures { get; set; }    
} 
```

如何填写`"SelectedFeatures"`功能列表 - 这可能吗？我即将将其拆分为两个查询 =)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:51:30.077

做这个：

```
public class AccountDetails
{
    public Guid AccountGUID { get; set; }
    public string AccountName { get; set; }  
    public Collection<Features> SelectedFeatures { get; set; }    
} 
```

和

```
return (from a in _Store.Accounts
        where a.AccountGUID == _AccountGUID
        select new AccountDetails
        {
            AccountGUID = a.AccountGUID
            AccountName = a.AccountName,
            SelectedFeatures = a.Features
        }).ToList(); 
```

# c# - 如何只为一列设置源

> ID：13088168
> 
> 赞同：1
> 
> 时间：2012-10-26T13:46:46.387
> 
> 标签：c#, wpf, xaml, datagrid

我有一个`DataGrid`其主要目的是允许用户在其单元格中输入数据。

但是，此网格中的第一个字段应显示列表的内容。

我将如何为一列设置数据源？

**编辑**：我想实现这样的目标：

![在此处输入图像描述](../Images/561aa009fd289d33270e99a5abf426b5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:58:44.067

除了我的评论之外，一种简单的方法是包装您的 itemssource 集合并为每个项目添加一个列表 - 使用您期望的数据。

好消息是您不必为第一列设置不同的来源，您只需绑定到新的列表属性

编辑：

我希望我有你的问题。

假设您的网格有一个 itemssource：

```
List<MyObject> _list; 
```

您的 myobject 包含 Asc/Desc、GroupBy、Having、Dispplayorder 属性。

所以我会创建一个 MyObjectWrapper 并添加 Field 属性

```
 public class MyObjectWrapper
  {
     public MyObject WrappedOject {get;set;}
     public string Fields {get;set}
  } 
```

你最终得到了一个新的

```
 List<MyObjectWrapper> _wrapperlist; 
```

这些集合包含您需要显示的所有信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T15:40:43.060

在 中指定您自己`DataGridTemplateColumn`的`DataGrid.Columns`，并将 设置`DataGridTemplateColumn.CellTemplate`为您要放置在该列中的任何内容。

例如，如果您希望它`ComboBox`指向其他字段列表：

```
<DataGrid.Columns>
    <DataGridTemplateColumn Header="Fields">
        <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
                <ComboBox ItemsSource="{Binding ElementName=MyWindow, Path=DataContext.SomeCategoryList}"
                          SelectedItem="{Binding SomePropertyOnDataItemInRow}" />
        </DataGridTemplateColumn.CellTemplate>
    </DataGridTemplateColumn>
</DataGrid.Columns> 
```

我正在使用一个名为`SomeCategoryList`that's on的属性`MyWindow.DataContext`，但是您可以将绑定设置为指向存储字段列表的位置

# c# - 如何在 FedEx 地址验证 Web 服务中获得类似的地址建议？

> ID：13088171
> 
> 赞同：-2
> 
> 时间：2012-10-26T13:46:56.770
> 
> 标签：c#, fedex

我正在使用 FedEx 地址验证 Web 服务。我知道当地址不正确时，它应该提示我一些正确的地址建议。

请指导我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T17:15:58.407

根据 API 规范，它返回多个结果，您应该遍历这些结果并显示给用户，然后重新验证。

> 当未找到完全匹配时，您会收到多个地址结果。在使用地址运送包裹之前，您应该确认地址的准确性。要缩小结果范围，您可以提供更具体的地址信息并再次检查地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-27T09:45:35.800

FedEx 服务没有直接更正的建议地址。您可以从 FedEx 网站下载所需语言的服务代码。并在验证地址后，服务返回多个属性，例如：

1.  国家支持：真
2.  ZIP11 匹配：真
3.  SuiteRequiredButMissing：真
4.  无效套件编号：假
5.  多重匹配：假
6.  已解决：真
7.  ZIP4Match：真
8.  DPV：错误
9.  有效多单元：假
10.  邮政信箱：假
11.  多单元基础：真
12.  街道地址：假
13.  POBoxOnlyZIP：假
14.  唯一邮编：假
15.  拆分邮编：假
16.  RR转换：假

在这些属性的基础上，您可以查看地址验证失败的原因。您可以在 FedEx 地址验证服务文档文件中找到每个属性的详细信息。

# php - 如何在 PHP 中显示服务器和用户时间？

> ID：13088177
> 
> 赞同：1
> 
> 时间：2012-10-26T13:47:29.753
> 
> 标签：php

我有一个页面显示一些信息和它的创建日期（服务器时间）。我需要一些方法来显示服务器和用户时间的日期。

示例：
10 月 26 日 13:48:23（服务器）
10 月 26 日 14:48:23（您的时间）-> 信息

到目前为止我所拥有的：

```
<?php
    $sql=mysql_query("SELECT * FROM table") or die("Come back later");
    while($row=mysql_fetch_array($sql)) {
        echo date('M, d H:i:s', strtotime ($row['date'])).' -> '.$row['info'];
    }
?> 
```

谢谢你。

**编辑：** 我认为我没有正确解释这一点。日期存储在数据库中（日期是未来事件的未来点），我想在用户时区显示日期。

例如，第 26 天 12:10:22（服务器时间）将发生一些事情，我想显示转换为用户时间的情况，以使他们更轻松。

**编辑 2** 示例：我想检测用户时区的差异。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:01:35.540

PHP是一种服务器语言，所以无法获取用户计算机的时间。如果这不是您的意图，您可以做的是通过 javascript 将这段时间存储在该用户的数据库中。花时间 javascript 很简单：

```
var date = new Date();
hour = date.getHours();
minutes = date.getMinutes();
seconds = getSeconds(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T16:27:37.347

我以前从来没有这样做过，老实说，我很难看到你想要做什么，这使得回答它有点困难。尽管如此，我会尝试（以某种方式）回答它，并希望你能填补空白。

**服务器时间**

要获取服务器时间，请使用 time() 或 date() 函数（还有其他方法，但它们应该足够了）。但是，time() 调用可能会很慢，与其他获取当前时间的函数相同（因为它需要系统调用来获取时间）。您还应该知道，如果脚本在调用之间的执行时间超过 1 秒，它会因调用而异。这会导致一致性问题。一种解决方法是尽可能使用 $_SERVER['REQUEST_TIME'] 并修复可能由主动获取当前系统时间的重复调用 time()、date() 等引起的恒定性错误和速度问题。

**客户时间**

这必须在 JavaScript 中使用“new Date()”来完成。

在 onload 事件之后（或者更好的是，在 DOM 加载之后）执行一个 ajax 请求来发布 javascript（客户端）时间。然后，处理 AJAX 请求的 PHP 脚本将知道客户端时间和服务器时间（但它不会 100% 准确，因为由于延迟和其他开销，服务器时间总是略早于提供的客户端时间。 ajax 请求本身）。

**你的代码**

根据我的理解，您想获取用户和服务器时间，然后为该成员保存在数据库中？使用上面的这些解决方案可以让你们俩都受益，但是由于您的问题有点难以理解，我将不得不将其余的实施留给您，一旦您获得它们，您将如何处理这两个日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T19:19:28.123

我建议采用完全不同的方法：

**地理位置**

您使用用户的 IP 地址来获取用户的时区。好处是如果用户改变国家，他们仍然会看到正确的时间。然而，缺点是有时地理定位会失败。代理也规避了这种定位用户。

在这里阅读它：

*   [维基百科：IP 地址位置](http://en.wikipedia.org/wiki/IP_address_location)
*   [我可以使用哪些服务来根据用户的 IP 地址查找用户位置](https://stackoverflow.com/questions/37015/what-services-can-i-used-to-find-a-users-location-based-on-their-ip-address)

**或使用 Javascript 将通用时间转换为本地时间**

使用 Javascript，您可以通过优雅的降级来实现此功能，这总是一件好事，对吧？理想情况下，您会在特定标签中提供时间（或使用类）

```
<date>Fri, 26 Oct 2012 20:52:05 +0000</date>
<time>Fri, 26 Oct 2012 20:52:05 +0000</time> 
```

您可以使用您最喜欢的 javascript 库（我在这里使用 jQuery）和*标准* [`Date`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)对象轻松修改它：

```
$("date").each(function(self) {
    var date = new Date($(this).text());
    $(this).text(date.toLocaleString());
});

$("time").each(function(self) {
    var date = new Date($(this).text());
    $(this).text(date.toTimeString()+
        " ("+date.getHours()+":"+date.getMinutes()+")");
}); 
```

这是一个小提琴：http: [//jsfiddle.net/FdQRH/](http://jsfiddle.net/FdQRH/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T13:50:31.987

`mysql_*`除了您不应该使用函数的事实之外，[请参见此处的评论](https://stackoverflow.com/questions/13088177/how-to-show-server-and-user-time-in-php#comment17783744_13088177)

* * *

您可以通过回显显示服务器时间`date()`，您可以使用客户端浏览器中的 javascript 从客户端时间获取客户端时间`new Date()`

# ios - 在CALayer中逐行绘制图形的有效方法

> ID：13088181
> 
> 赞同：1
> 
> 时间：2012-10-26T13:47:50.717
> 
> 标签：ios, core-graphics, calayer, quartz-graphics, quartz-2d

我需要根据每半秒出现一次的值绘制折线图。我已经为该图提出了我的自定义 CALayer，它存储了所有先前的行，并且每两秒重绘所有先前的行并添加一个新行。我发现这个解决方案不是最佳的，因为只需要在图层上画一条额外的线，没有理由重新绘制可能数千条之前的线。

您认为在这种情况下最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:56:59.993

使用您自己的`NSBitmapContext`或`UIImage`作为后备商店。每当新数据进入此上下文并将图层的`contents`属性设置为上下文的图像时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T11:03:08.707

I am looking at an identical implementation. Graph updates every 500 ms. Similarly I felt uncomfortable drawing the entire graph each iteration. I implemented a solution 'similar' to what Nikolai Ruhe proposed as follows:

First some declarations:

```
#define TIME_INCREMENT 10
@property (nonatomic) UIImage *lastSnapshotOfPlot; 
```

and then the drawLayer:inContext method of my CALayer delegate

```
- (void) drawLayer:( CALayer*)layer inContext:(CGContextRef)ctx
{

    // Restore the image of the layer from the last time through, if it exists

    if( self.lastSnapshotOfPlot )
    {
        // For some reason the image is being redrawn upside down!
        // This block of code adjusts the context to correct it.

        CGContextSaveGState(ctx);
        CGContextTranslateCTM(ctx, 0, layer.bounds.size.height);
        CGContextScaleCTM(ctx, 1.0, -1.0);

        // Now we can redraw the image right side up but shifted over a little bit
        // to allow space for the new data

        CGRect r = CGRectMake( -TIME_INCREMENT, 0, layer.bounds.size.width, layer.bounds.size.height );  
        CGContextDrawImage(ctx, r, self.lastSnapshotOfPlot.CGImage );

        // And finally put the context back the way it was

        CGContextRestoreGState(ctx); 
    }

    CGContextStrokePath(ctx);

    CGContextSetLineWidth(ctx, 2.0);
    CGContextSetStrokeColorWithColor(ctx, [UIColor blueColor].CGColor );
    CGContextBeginPath( ctx );

    // This next section is where I draw the line segment on the extreme right end
    // which matches up with the stored graph on the image.  This part of the code 
    // is application specific and I have only left it here for
    // conceptual reference.  Basically I draw a tiny line segment
    // from the last value to the new value at the extreme right end of the graph.

    CGFloat ppy = layer.bounds.size.height - _lastValue / _displayRange * layer.bounds.size.height;
    CGFloat cpy = layer.bounds.size.height - self.sensorData.currentvalue  / _displayRange * layer.bounds.size.height;

    CGContextMoveToPoint(ctx,layer.bounds.size.width - TIME_INCREMENT, ppy ); // Move to the previous point
    CGContextAddLineToPoint(ctx, layer.bounds.size.width, cpy );  // Draw to the latest point

    CGContextStrokePath(ctx);

    // Finally save the entire current layer to an image.  This will include our latest
    // drawn line segment 

    UIGraphicsBeginImageContext(layer.bounds.size);
    [layer renderInContext: UIGraphicsGetCurrentContext()];
    self.lastSnapshotOfPlot = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

} 
```

Is this the most efficient way? I have not been programming in ObjectiveC long enough to know so all suggestions/improvements welcome.

# c# - C#：静默访问打开的文件

> ID：13088183
> 
> 赞同：-6
> 
> 时间：2012-10-26T13:48:10.310
> 
> 标签：c#, file, file-io, readonly

> **可能重复：**
> [读取正在使用的文件？](https://stackoverflow.com/questions/3709104/read-file-which-is-in-use)

我有这样的情况/问题：

1.  某个程序当前打开的一个 txt 文件。该程序将一些日志内容写入文件。
2.  我的 C# 程序应该以只读模式打开该文件，但访问应该是静默的，并且不应阻止对文件的访问。

哪些 C# 函数可以帮助我？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:50:45.537

您只需将适当的参数传递给该`File.Open()`方法：

```
using (var stream = File.Open("path", 
   FileMode.Open, 
   FileAccess.Read, 
   FileShare.ReadWrite))
{
    // You can read, they (logger) can write
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:52:26.287

FileShare 标志允许打开已打开的文件。

# ruby-on-rails - 表单中的嵌套对象未验证

> ID：13088186
> 
> 赞同：0
> 
> 时间：2012-10-26T13:48:24.230
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2, nested-attributes, simple-form

我有一个嵌套表单，用户可以在其中预约。但是，我注意到表单存在问题，用户可以填写所需的`Client`模型字段而不是所需的`Appointment`模型字段，并且由于某种原因`Appointment`未触发模型验证，因此表单仍会提交。触发验证的唯一时间`Appointment`是填充关联的表单字段时。如何获取嵌套表单以验证是否`Appointment`正在填写字段？由于客户可以拥有多个

客户型号：

```
class Customer < ActiveRecord::Base
  has_many :appointments
  accepts_nested_attributes_for :appointments

  attr_accessible :name, :email, :appointments_attributes

  validates_presence_of :name, :email

  validates :email, :format => {:with => /^[^@][\w.-]+@[\w.-]+[.][a-z]{2,4}$/i}
  validates :email, :uniqueness => true
end 
```

预约型号：

```
class Appointment < ActiveRecord::Base
  belongs_to :customer

  attr_accessible :date

  validates_presence_of :date
end 
```

客户控制器：

```
class CustomersController < ApplicationController
  def new
    @customer = Customer.new
    @appointment = @customer.appointments.build
  end

  def create
    @customer = Customer.find_or_initialize_by_email(params[:customer])
    if @customer.save
      redirect_to success_customers_path
    else
      # Throw error
      @appointment = @customer.appointments.select{ |appointment| appointment.new_record? }.first
      render :new
    end
  end

  def success
  end
end 
```

客户表格视图：

```
= simple_form_for @customer, :url => customers_path, :method => :post, :html => { :class => "form-horizontal" } do |customer_form|
  = customer_form.input :name
  = customer_form.input :email
  = customer_form.simple_fields_for :appointments, @appointment do |appointment_form|
    = appointment_form.input :date 
```

更新：提供路线

```
resources :customers, :only => [:new, :create] do
  get :success, :on => :collection
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T17:16:33.620

如果客户必须预约：

```
class Customer < ActiveRecord::Base
   has_many :appointments
   accepts_nested_attributes_for :appointments

   attr_accessible :name, :email, :appointments_attributes

   validates_presence_of :name, :email, :appointment # <- add your appointment
   ....
end 
```

这将要求每位客户至少有一次预约。

**根据评论编辑**

我认为您可以使用`create`而不是在控制器中使用构建，而是使用它将将该约会与客户相关联并强制验证。

客户控制器：

```
def edit
    @customer = Customer.find_or_initialize_by_email(params[:customer])
    @appointment = @customer.appointments.create
end 
```

你会在你的`new`方法中做同样的事情

# xcode - NSUbiquitousKeyValueStore 错误：com.xxxxx.xxxxx 没有有效的 com.apple.developer.ubiquity-kvstore-identifier 权利

> ID：13088187
> 
> 赞同：0
> 
> 时间：2012-10-26T13:48:24.383
> 
> 标签：xcode, in-app-purchase, entitlements

设置 MKStorekit，也有 Share kit，我的 store 不在根视图控制器中。我已正确添加和连接安全和 storekit 框架，但出现以下错误：

```
NSUbiquitousKeyValueStore error: com.xxxx.xxxx has no valid com.apple.developer.ubiquity-kvstore-identifier entitlement 
```

其他人有此错误，并被告知等待几个小时。好吧，我在 3 周前在 iTunes Connect 中设置了我的产品（他们都说等待审核）。银行账户信息是正确的，因为我已经将钱存入银行账户以确保，并且我一直小心地按照所有说明进行操作。

我的应用与 iCloud 无关，因此未启用 iCloud。

我一直在努力让 IAP 连接 3 周，并且我即将永远放弃 xcode 编程，哈哈... plllllllllease 有人帮助我：/

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T14:02:51.663

MKStoreManger.m 文件中有一堆 iCloud 内容，只是将其注释掉并修复了错误。仍然没有商店，但似乎不是因为这个

# ios - iOS 在 UIWebViews 之间切换导致内存警告

> ID：13088188
> 
> 赞同：0
> 
> 时间：2012-10-26T13:48:25.177
> 
> 标签：ios, uiwebview, webview

嗨，我创建了一个自定义选项卡栏，它隐藏和显示某些 Web 视图，具体取决于您当前在操作队列上加载所有三个 Web 视图的选项卡，然后根据所选选项卡使它们可见和不可见。问题是加载和滚动速度太慢了，我收到了内存警告

这是我到目前为止所做的

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    NSArray *subviews = [cell subviews];
        for(UIView *subview in subviews) if([subview tag] == 4) [subview removeFromSuperview];

        UIView *loadingView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 800)];
        UIView *sendingMessage = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];
        UIActivityIndicatorView *sendingSpinner = [[UIActivityIndicatorView alloc] initWithFrame:CGRectMake(25, 15, 50, 50)];
        UILabel *sendingLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 65, 100, 20)];

        int sendingViewLeft = (loadingView.frame.size.width/2) - (sendingMessage.frame.size.width/2);
        int sendingViewTop = 160 - (sendingMessage.frame.size.height/2);

        loadingView.backgroundColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:0.5];

        sendingMessage.frame = CGRectMake(sendingViewLeft, sendingViewTop, sendingMessage.frame.size.width, sendingMessage.frame.size.height);
        sendingMessage.backgroundColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:0.5];
        sendingMessage.layer.cornerRadius = 10;

        sendingSpinner.activityIndicatorViewStyle = UIActivityIndicatorViewStyleWhiteLarge;

        sendingLabel.textColor = [UIColor whiteColor];
        sendingLabel.backgroundColor = [UIColor clearColor];
        sendingLabel.text = @"Loading...";
        sendingLabel.textAlignment = UITextAlignmentCenter;
        sendingLabel.font = [UIFont boldSystemFontOfSize:12];
        sendingLabel.shadowColor = [UIColor blackColor];
        sendingLabel.shadowOffset = CGSizeMake(0, -1);

        [sendingSpinner startAnimating];
        [sendingMessage addSubview:sendingLabel];
        [sendingMessage addSubview:sendingSpinner];
        [loadingView addSubview:sendingMessage];

        [loadingView setTag:4];

       cell.textLabel.text = @"";

    if([self.webViewStatus isEqualToString:@"FALSE"]){
        [cell addSubview:loadingView];
        self.tableView.userInteractionEnabled = NO;
    } else {
        [cell addSubview:self.fixturesWebView];
        [cell addSubview:self.resultsWebView];
        [cell addSubview:self.tablesWebView];
        self.tableView.userInteractionEnabled = YES;
    }

    if(self.selectedTabNumber == 1){
        self.fixturesWebView.alpha = 1;
        self.resultsWebView.alpha = 0;
        self.tablesWebView.alpha = 0;
    }

    if(self.selectedTabNumber == 2){
        self.fixturesWebView.alpha = 0;
        self.resultsWebView.alpha = 1;
        self.tablesWebView.alpha = 0;
    }

    if(self.selectedTabNumber == 3){
        self.fixturesWebView.alpha = 0;
        self.resultsWebView.alpha = 0;
        self.tablesWebView.alpha = 1;

    }

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:54:56.290

首先，您应该考虑创建一个自定义单元格，而不是在 tableview 数据源中创建它。其次，当您获取 webview 内容时，请考虑使用异步调用来避免锁定。这也可以在一个块中完成。如果您在自定义单元格上编写委托方法，您可以让 tableview 知道什么时候加载或不加载等等。

但是当 tableview 需要绘制一个单元格时，看起来你正在让它做太多的工作。

# spring - 如何在 OSGI 环境中使用 Spring？

> ID：13088189
> 
> 赞同：0
> 
> 时间：2012-10-26T13:48:30.700
> 
> 标签：spring, jakarta-ee, transactions, osgi

基本上，我希望能够在 OSGI 包中使用 Spring 来执行此操作：

*   使用 applicationContext.xml 定义 bean 和代理并装饰它们
*   在方法上使用 @Transactional 给它一个事务（Spring 需要代理它）

我知道有 Spring DM 已经退役到 Eclipse Gemini 中。我仍然可以使用 spring DM 2.0，这将允许我使用 spring 蓝图点 1？有没有办法使用“常规”春天来做到这一点？

我该怎么做第 2 点？是否可以在 OSGI 包中使用 Spring 来提供事务？有没有人成功做到这一点？

我应该远离 OSGI 中的 Spring，还是有更多我不知道的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T20:31:22.180

好吧，即使是“旧”1.2.1，您仍然可以使用 Spring-DM，尽管我真的建议切换到 Blueprint，它在 OSGi 上运行顺畅，与 Spring 本身并没有太大区别。特别是因为你想对你的 bean 进行交易。我最喜欢的设置是带有 OpenJPA 的 Blueprint（Aries 或 Gemini），它在 OSGi 环境中效果最好。

这是一个关于如何使用 Aries Blueprint 执行此操作的简单示例

```
<bean id="myDao" class="my.project.dao.jpa.MyJpaDao">
<jpa:context property="em" unitname="persistenc-unit" />
<tx:transaction method="*" value="Required" />
</bean> 
```

有了它，您就可以在该类上进行任何方法事务。我通常将这些 DAO 对象保存在一个单独的包中，仅包含我的实体类和 DAO。为了在我的应用程序中获取这些 DAO，我注册为服务

```
<service id="myDAO" ref="myDao" interface="my.project.dao.MyDao" /> 
```

现在对你来说，仍然可以用它来“软”转移到蓝图。如果你像我一样将你的实体单独放在一个额外的包中，你只需要从你的 Spring 中引用那些 DAO 服务（与 Spring-DM 一起，在这种情况下，建议坚持使用 spring-dm 1.2.1，你'否则会遇到非常糟糕的问题），然后从那里开始使用你的标准。春季应用。这就是 OSGi 的真正美妙之处，您可以随意混合所有这些服务框架。

# vb.net - 在运行时已知的字段上连接两个数据表

> ID：13088193
> 
> 赞同：0
> 
> 时间：2012-10-26T13:48:58.053
> 
> 标签：vb.net, datatable, inner-join, dynamic-tables

简而言之：如何在 VS 仅在运行时知道并且我一直都知道的字段上加入两个数据表？有没有类似的解决方案

```
 Dim result = From t1 In dt, t2 In dt2 _  
                     Where t1.Field < DateTime > ("timestamp") = t2.Field < DateTime > ("samplestamp")  
                     Select t1, t2 
```

这些表的名称仅在运行时才知道，因为这两个表都是动态创建的。

长版：
在角落 A，我有一个 Historian 服务器，我可以在其中获取一些数据。该数据代表在给定时间内为给定过程创建的所有样本
。该数据代表在给定时间内运行的所有批次。

该项目需要将这 2 个表格显示在图表控件中。

现在是有趣的部分。只有在运行时，我才能知道哪些列可用。我不知道我会收到多少列，因为我不知道是 1 批运行还是 100 批运行。我所知道的是我可以接收所有这些“数据”（我只在运行时看到）可以放入 2 个数据表（vb.net，因为它是一个旧项目）
我“知道”例如数据表 1（角落A) 始终存在于第一列名为时间戳的表中。（这也是我在这里知道的唯一一列）
而且我还知道 datatable2 中的第一列（角 B）被命名为 sampletime

所以倒计时来了：我如何将给定名称上的这两个数据表连接到一个华丽的数据表中，然后我将其用作图表控件的数据源。因此问题就解决了。

我试图完成这个并在 SQL-server 中创建一个单一的 sql 表，这里的问题是我使用的服务器不喜欢事务，所以没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T13:57:10.543

没有阅读*Longversion*并且希望没有忽略一些东西：

您可以将这些表传递给以两个`DataTables`作为参数的方法。

然后你可以使用这个代码返回一个可重用的`IEnumerable(Of Tuple(Of DataRow, DataRow))`：

```
Public Function getSomething(dt1 As DataTable, dt2 As DataTable) As IEnumerable(Of Tuple(Of DataRow, DataRow))
    Return From r1 In dt1
           Join r2 In dt2
            On r1.Field(Of DateTime)("timestamp") Equals r2.Field(Of DateTime)("samplestamp")
           Select Tuple.Create(r1, r2)
End Function 
```

匿名类型不打算在创建它们的方法之外使用。因此我使用了这种元组方法。您可以通过这种方式评估返回值：

```
Dim rowInfos = getSomething(tbl1, tbl2)
For Each rowInfo In rowInfos
    Dim row1 = rowInfo.Item1
    Dim row2 = rowInfo.Item2
    Dim timestamp = row1.Field(Of DateTime)("timestamp")
    Dim samplestamp = row2.Field(Of DateTime)("samplestamp")
Next 
```

# c# - 没有为依赖项触发 AssemblyResolve

> ID：13088199
> 
> 赞同：20
> 
> 时间：2012-10-26T13:49:25.520
> 
> 标签：c#, assemblyresolve

我正在为 AssenblyResolve 事件苦苦挣扎一段时间。我搜索了 stackoverflow 并进行了其他谷歌搜索并尝试了所有我认为相关的内容。以下是更接近我的问题的链接（在我看来）：

1.  [序列化期间未调用 AssemblyResolve 并引发 FileNotFoundException](https://stackoverflow.com/questions/6493371/assemblyresolve-is-not-invoked-and-filenotfoundexception-is-thrown-during-serial)

2.  [在类库中哪里处理 AssemblyResolve 事件？](https://stackoverflow.com/questions/9099309/where-to-handle-assemblyresolve-event-in-a-class-library)

我有一个带有静态方法的 Bootstrapper 类（为了清楚起见，我将删除我们拥有的线程安全代码：

```
public static void Initialize()
{
    AppDomain.CurrentDomain.AssemblyResolve += CustomResolve;
}

private static Assembly CustomResolve(object sender, ResolveEventArgs args)
{
    // There is a lot code here but basicall what it does.
    // Is determining which architecture the computer is running on and
    // extract the correct embedded dll (x86 or x64). The code was based
    // on milang on GitHub (https://github.com/milang/P4.net). And it's the same
    // purpose we want to be able to load the x86 or x64 version of the perforce dll
    // but this time with the officially Perforce supported p4api.net.
    // Once the dll is extracted we assign it to the boostrapper
    Bootstrapper._p4dnAssembly = Assembly.LoadFile(targetFileName);

    // Make sure we can satisfy the requested reference with the embedded assembly (now extracted).
    AssemblyName reference = new AssemblyName(args.Name);
    if (AssemblyName.ReferenceMatchesDefinition(reference, Bootstrapper._p4dnAssembly.GetName()))
    {
        return Bootstrapper._p4dnAssembly;
    }
} 
```

如果我有一个带有 main 方法和静态构造函数的简单类，我就能使代码工作。静态构造函数只是调用 Boostrapper.Initialize() 方法。之后，我可以使用我的库并且它按预期工作：

```
public static class Test
{
    static Test()
    {
        Bootstrapper.Initialize();
    }

    public static void Main()
    {
         // Using the library here is working fine. The AssemblyResolve event was
         // fired (confirmed by a breakpoint in Visual Studio)
    }
} 
```

我遇到的问题是是否至少存在一层依赖关系。基本上代码保持不变，但这次我的库代码在另一个库中：

```
public static class Test
{
    static Test()
    {
        Bootstrapper.Initialize();
    }

    public static void Main()
    {
        Class1 myClass = new Class1();

        // The following line is using the code of the extracted library, but
        // The AssemblyResolve event is not fired (or fired before I register the  
        // callback) and therefore the library is not found : result  
        // BadImageFormatException() error could not load libary because one
        myClass.Connect();
    }
} 
```

听起来我之前提到的链接中的#2 解释了我所看到的，但它不起作用。永远不会命中 AssemblyResove 回调上的 Visual Studio 断点。

知道发生了什么吗？

弗朗西斯

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-09-23T09:00:14.053

我知道这个问题被问和回答已经有一段时间了，但我还是想补充一下我对这个问题的看法（因为我只是为此浪费了几个小时，也许多亏了这个，其他人就不必这样做了）

问题基本上是这样的事实，即应用程序试图在该方法的开头解析执行该方法所需的所有程序集：

```
static void main(string[] args)
{
    // <-- here the app tries to resolve MyAssembly
    // and as MyAssembly.Class1 is not found, the app crashes

    // this next line is never called:
    AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(ResolveAssembly);

    // class contained in an assemnly that we need to resolve
    MyAssembly.Class1 myClass = new MyAssembly.Class1();
} 
```

这就是上面会崩溃的原因：永远不会调用 ResolveAssembly 事件处理程序，因为它从未连接过。

这也是以下解决方案有效的原因（由 OP 发布）：

```
static void main(string[] args)
{
    Initialize();
    RealMain();
}

static void Initialize()
{
    AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(ResolveAssembly);
}

static void RealMain()
{
   // <-- here the app tries to resolve MyAssembly
   // class contained in an assemnly that we need to resolve      
   MyAssembly.Class1 myClass = new MyAssembly.Class1();
   // and everything is OK
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-30T18:27:06.513

有人回答了，但答案已被删除。所以我不能将其标记为已回答。基本上代码不需要在“main”方法之外的事实是有效的。从一个新项目开始，解决这个问题，所以我想我的 dll 有一些问题（可能是 x64 文件夹中的 x86 dll，反之亦然）

```
static void main(string[] args)
{
    Boostrapper.Initialize();
    RealMain();
}

static void RealMain()
{
    Class1 myClass = new Class1();
    myClass.Connect();
} 
```

# events - 在 Meteor 中将事件从服务器发送到客户端

> ID：13088205
> 
> 赞同：8
> 
> 时间：2012-10-26T13:49:42.530
> 
> 标签：events, meteor

有没有办法在不使用集合的情况下将事件从服务器发送到所有或部分客户端。

我想向客户发送带有一些自定义数据的事件。虽然流星非常擅长使用集合来执行此操作，但在这种情况下，不需要增加复杂性和存储。

在服务器上不需要 Mongo 存储或本地集合。客户端只需要被提醒它从服务器接收到一个事件并根据数据采取相应的行动。

我知道这对 sockjs 来说相当容易，但从服务器访问 sockjs 却非常困难。

`Meteor.Error`做类似的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-06T04:33:17.683

> 该软件包现已弃用，不适用于 >0.9 的版本

您可以使用以下最初旨在从客户端-服务器-客户端广播消息的包

[http://arunoda.github.io/meteor-streams/](http://arunoda.github.io/meteor-streams/)

没有collection，后面没有mongodb，用法如下（未测试）：

```
stream = new Meteor.Stream('streamName'); // defined on client and server side

if(Meteor.isClient) {
    stream.on("channelName", function(message) {
      console.log("message:"+message);
    });
}

if(Meteor.isServer) {
    setInterval(function() {
      stream.emit("channelName", 'This is my message!');
    }, 1000);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T19:02:59.823

您*应该*使用集合。

如果您所做的只是创建一个集合，向其中添加一个属性并对其进行更新，那么“增加的复杂性和存储空间”就不是一个因素。

集合只是服务器和客户端之间数据通信的一种形式，它们恰好建立在 mongo 之上，如果你想像数据库一样使用它们，这真的很好。但在最基本的情况下，它们只是一种说“我想存储一些称为 X 的信息”的方式，它与您应该想要利用的发布/订阅架构挂钩。

未来除了Mongo之外，还会暴露其他数据库。我可以看到在某个阶段有一个智能包，可以将 Collections 剥离到它们最基本的功能，就像你提议的那样。也许你可以写出来！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-24T15:22:59.150

我觉得 @Rui 和使用 Collection*只是*为了发送消息的事实感觉很麻烦。
同时，一旦您有几条这样的消息要发送，就可以方便地将一个名为“*设置*”或类似名称的集合保存在其中。

* * *

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-23T16:47:05.043

我找到的最好的包是 Streamy。它允许您发送给每个人，或者只发送给一个特定的用户

[https://github.com/YuukanOO/streamy](https://github.com/YuukanOO/streamy)

```
meteor add yuukan:streamy 
```

给大家发消息：

```
Streamy.broadcast('ddpEvent', { data: 'something happened for all' }); 
```

在客户端监听消息：

```
// Attach an handler for a specific message
Streamy.on('ddpEvent', function(d, s) {
  console.log(d.data);
}); 
```

向一位用户发送消息（按 id）

```
var socket = Streamy.socketsForUsers(["nJyQvECmkBSXDZEN2"])._sockets[0]
Streamy.emit('ddpEvent', { data: 'something happened for you' }, socket); 
```

# python - 从程序程序员的角度来看，学习和掌握 Python 的最佳方式是什么？

> ID：13088206
> 
> 赞同：2
> 
> 时间：2012-10-26T13:49:43.030
> 
> 标签：python, c, user-interface, functional-programming, procedural-programming

我是数学家，目前主要从事运筹学领域的工作，构建用于解决数学规划或优化问题的算法。

当我还是学生的时候，我学习了 Fortran、Pascal 和 C（哦，还有 Visual Basic），不是很深入，但在 CI 的情况下，它可以很好地管理指针、结构等。

后来，我一直在使用 Visual C++ 进行研究，为我的问题构建算法等等。我无法创建任何 GUI，并且我不使用对象，而是使用经典的过程视角，所以实际上我使用具有 C++ 的一些特性的 C。

有一段时间我尝试学习 Python。它看起来那么*友好*，新鲜，有趣，简单但强大......但最后，我有点困惑，因为很多不同的原因，例如：

1.  我习惯了过程语言，而 Python 是面向函数的，至少有一点点。

2.  我习惯了可以创建`.exe`文件的语言（*编译*），而 Python 是*解释*的。另外，当我们谈论创建复杂的算法等等时，我了解到，由于这个原因，C ——一般来说——比 Pyhton 快。

3.  有不同版本的 Python，它们都是稳定且最新的！我的意思是，有 Python 2.x 和 Python 3.x。有些东西在版本 3 中有效，但在版本 2 中无效，等等。

4.  也许这比前面的原因更主观，但我发现C 中的库比 Python 中的更多、更好、更*稳定*或更*可靠。*

5.  *此外，我发现在 Python 编程的不同 GUI 和不同风格*之间进行选择有点困难，如 Python IDE、Tkinter、IronPython ......

我*确实*认为 Python 是一种强大的语言，尽管它被解释了。而且我仍然认为它比 C 更*漂亮*。我喜欢 Python，但我希望我更喜欢它！

所以，最后，我的问题是，我怎样才能真正学习和掌握 Python，以一种*确定*的方式，以便我能够将它用作编程数学算法的*主要*选择？

当我说*“确定”*时，我的意思是，哪些是（在您看来）以可靠的方式学习和使用 Python 的最安全的途径和工具？哪些是更成熟和稳定的库、GUI 等等？

对不起，如果这个问题有点奇怪，但我想可能会有更多的人对 Python 有同样的疑问。

# python - Python/SQLAlchemcy“或”功能

> ID：13088213
> 
> 赞同：1
> 
> 时间：2012-10-26T13:50:12.230
> 
> 标签：python, sqlalchemy, wtforms, flask-sqlalchemy

我似乎无法找出为什么“或”的行为方式是这样的。我正在使用 SQLAlchemy 并且`WTForms.ext.sqlalchemy.QuerySelectField`可以`QuerySelectField`设置`query_factory`，但是如果缺少它应该回退到 fields`query`方法：

例如

```
class Form1(Form):
    fielda = QuerySelectField('Field A') 
```

您还可以`query_factory`像这样设置参数：

```
class Form1(Form):
    fielda = QuerySelectField('Field A', query_factory=somefunction) 
```

然后在其他地方你使用这样的表格：

```
form = Form1(request.form)
form.fielda.query = MyObjects.query.all() 
```

我看到的是，如果`MyObjects.query.all()`返回一个空列表，我会`NoneType not callable`在 QuerySelectField _get_object_list() 方法的这一行上得到一个异常：

```
query = self.query or self.query_factory() 
```

基本上，无论 的值是多少`self.query`，即使它被分配给 ，它`or`仍然在调用。`self.query_factory()``None`

所以，我的问题是，这是预期的行为`or`吗？它似乎对两者都进行了评估，*然后*决定是否需要使用第二个值（如果第一个值是 ）`None`。这个对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:59:48.083

这是正确的，在布尔上下文中 None 是错误的。如果 self.query 为 None 则值由 self.query_factory() 确定

[关于什么是真假的 Python 文档](http://docs.python.org/reference/expressions.html#booleans)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T13:59:03.757

`or`短路。这意味着

```
query = self.query or self.query_factory() 
```

评估如下：

1.  检查是否`self.query`评估为`False`. 如果不是，则引用的对象`self.query`绑定到`query`. 在这种情况下`self.query_factory()` *不调用。*
2.  如果它*是*一个`False`y 值（包括`None`），则`self.query_factory()`调用 then 并将其结果绑定到`query`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T13:57:03.430

您可以简明扼要地说明以下行为`or`：

> 如果左对象是 True-like，则返回左对象，否则返回右对象。

* * *

在这种情况下，left 对象是 false-like ( `None`)，因此它需要调用该函数才能让 right 对象返回。

# java - 为什么同步在以下代码中不起作用？

> ID：13088214
> 
> 赞同：-1
> 
> 时间：2012-10-26T13:50:18.143
> 
> 标签：java, multithreading, jakarta-ee, synchronized

即使我在运行`synchronized`方法块中使用了方法，此代码有时也会抛出异常 ，我正在添加和删除.`removeFirst``synchronized``synchronizedList`

```
public class NameDropper extends Thread {

    private NameList n1;

    public NameDropper(List list) {
        this.n1 = new NameList(list);
    }

    public static void main(String[] args) {
        List l = Collections.synchronizedList(new LinkedList());
        NameDropper n = new NameDropper(l);
        n.n1.add("Ozymandias");
        Thread[] t = new NameDropper[10];
        for (int i = 1; i <= 10; i++) {
            t[i - 1] = new NameDropper(l);
            t[i - 1].setName("T" + Integer.toString(i - 1));
            t[i - 1].start();
        }
    }

    public void run() {
        synchronized (this) {
            try {
                Thread.sleep(50);
                String name = n1.removeFirst();
                System.out.println(Thread.currentThread().getName() + ": "
                    + name);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
     }
}

class NameList {
    private List names = null;

    public NameList(List list) {
        this.names = list;
    }

    public synchronized void add(String name) {
        names.add(name);
    }

    public synchronized String removeFirst() {
        if (names.size() > 0)
            return (String) names.remove(0);
        else
            return null;
      }
} 
```

它抛出的异常：

```
T1: Ozymandias    
T2: null    
*Exception in thread "T3" java.lang.IndexOutOfBoundsException: Index: 0, Size: 0    
    at java.util.LinkedList.entry(Unknown Source)
    at java.util.LinkedList.remove(Unknown Source)
    at java.util.Collections$SynchronizedList.remove(Unknown Source)
    at NameList.removeFirst(NameDropper.java:57)*
T0: null    
T8: null    
*at NameDropper.run(NameDropper.java:33)*      
T6: null    
T4: null    
T9: null    
T7: null    
T5: null 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T13:54:02.760

您正在`NameDropper`为每个线程创建一个新实例。
因此，这些`synchronized`方法实际上并没有锁定，因为每个实例都不会被两个线程使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:25:26.140

正如其他人指出的那样，您有一个竞争条件，因为您的所有线程都在自己同步。您需要一个公共对象来进行同步。

我建议您在列表本身上进行同步。这将意味着任何争用同一列表的实例都会相互阻塞，而任何没有竞争的线程都不会被阻塞。您的添加和删除方法应该是：

```
public void add(String name) {
    synchronized (name) {
        names.add(name);
    }
}

public String removeFirst() {
    synchronized (name) {
        if (names.size() > 0)
            return (String) names.remove(0);
        else
            return null;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T14:03:08.040

即使您正在使用`Collections.synchronizedList`，您的代码中也存在竞争条件。

以下是您的代码中的竞赛代码示例。

```
lock(NameDropper[0])                            lock(NameDropper[1])
 names.size() > 0 is true                       names.size() > 0 is true  
                                                names.remove(0)
 names.remove(0) <--- Error here. 
```

由于您正在`NameDropper`为每个线程创建实例， `which shares single instance of List`因此您有此竞争条件。

您可以做的是为每个创建单独的列表`NameDropper`

```
 List l1 = Collections.synchronizedList(new LinkedList());
        t[i - 1] = new NameDropper(l1); 
```

这样每个`NameDropper`人都会有自己的`List`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T14:04:42.057

一般来说：
1）由于您每次都在创建类的新实例，因此基本上没有所有线程可以锁定的“公共”对象。您应该定义如下内容：

```
static final Object lock = new Object(); 
```

而`synchronize`在这个对象上。

2）恕我直言，最好实施`Runnable`而不是扩展`Thread`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T16:27:34.417

正如其他人所说，NameList 没有被共享。这是一种用最少的重新编码来修复代码的方法（还有其他方法）：

将构造函数更改为采用 NameList（而不是 List）。

```
public NameDropper(NameList list) {
    this.n1 = list;
} 
```

在您当前创建列表的位置创建 NameList。

```
NameList l = new NameList(Collections.synchronizedList(new LinkedList())); 
```

# windows-8 - 有没有人能够在 Tiles and Badges App 示例中使用 Web 图像？

> ID：13088218
> 
> 赞同：0
> 
> 时间：2012-10-26T13:50:35.350
> 
> 标签：windows-8, microsoft-metro, windows-runtime

我一直试图让我的应用程序的磁贴显示来自网络的图像，但无法让它工作。然后我尝试了[Tiles and Badges 应用示例](http://code.msdn.microsoft.com/windowsapps/App-tiles-and-badges-sample-5fc49148)，在场景 3 中，您可以发送使用 Web 图像的磁贴通知。无论我在文本框中粘贴哪个图像 url，磁贴都拒绝更新。显然，该示例也不起作用，或者出现了非常错误的情况。

图像均小于 1024x1024 且小于 200KB。有趣的事实：如果我下载了一张我尝试提供示例但未成功的图像，将其添加到项目中，然后使用它作为本地图像发送通知，磁贴就会更新。所以显然图像不是问题。

有没有人能够得到这个工作？我不明白我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T09:50:11.363

应用清单中是否有互联网许可票？也许只有您的应用程序无权从网络下载您的图像。

# javascript - 未捕获的类型错误：无法调用未定义的方法“substr”（Chrome/IE）

> ID：13088224
> 
> 赞同：1
> 
> 时间：2012-10-26T13:50:45.333
> 
> 标签：javascript, jquery, internet-explorer, debugging, google-chrome

所以只是调试别人的代码，我已经修复了 Firefox 中的所有内容，现在又修复了 Chrome，但是当我尝试选择一个选项来选择所有子节点并打开它们的相关图表时，我收到了一个奇怪的错误：

> 未捕获的类型错误：无法调用未定义的方法“substr”

我知道问题是（显然）这一行：

```
var graph={id:seqId,entityName:flags[6].substr(1).substr(0,flags[6].length-2),entity:flags[5].substr(1).substr(0,flags[5].length-2),idCounter:flags[4],counterName:flags[3].substr(1).substr(0,flags[3].length-2),ivmanager:flags[7].substr(1).substr(0,flags[7].length-2),chart:null,pointsToShowX:null,borneInf:null,unite:"",idInstance:flagsInstance[2].substr(1).substr(0,flagsInstance[2].length-2),instanceName:flagsInstance[3].substr(1).substr(0,flagsInstance[3].length-2),listPdsNull:new Array(), countInstance:idTreeview+"_"+i, countGraph:-1}; 
```

但我不知道为什么这会导致错误，因为一切对我来说都是正确的？！substr 在函数之前和之后被无数次使用，所以我不知道为什么 Chrome 会向我抛出这个错误。

完整的**功能**如下。我相信问题出在第二部分。

```
function loadGraphs(idTreeview,idSelectGraph)
{

    var count=0;
    var fn=$('#'+idSelectGraph)[0].attributes[1].value;
    fn=fn.substr(12).substr(0,fn.length-2);
    var flags=fn.split(new RegExp(","));
    var data=''; 

    var idInstanceTreeview = idTreeview;

if($('#counterTreeviewUL'+idInstanceTreeview).length == 0)      
{

    var fnInstance=$('#'+idSelectGraph)[0].attributes[1].value;

    var flagsInstance=fnInstance.split(new RegExp(","));

    var graph = {
            id: seqId,
            entityName: flags[6].substr(1).substr(0, flags[6].length - 2),
            entity: flags[5].substr(1).substr(0, flags[5].length - 2),
            idCounter: flags[4],
            counterName: flags[3].substr(1).substr(0, flags[3].length - 2),
            ivmanager: flags[7].substr(1).substr(0, flags[7].length - 2),
            chart: null,
            pointsToShowX: null,
            borneInf: null,
            unite: "",
            idInstance: flagsInstance[2].substr(1).substr(0, flagsInstance[2].length - 2),
            instanceName: flagsInstance[3].substr(1).substr(0, flagsInstance[3].length - 2),
            listPdsNull: new Array(),
            countInstance: idTreeview + "_" + i,
            countGraph: -1
        };

    seqId++;
    graphs[graphsLastId]=graph;
    graphsLastId++;

    }

else 
  {
    for(var i=0;i<$('#counterTreeviewUL'+idInstanceTreeview)[0].children.length;i++)
        ($('#counterTreeviewUL'+idInstanceTreeview)[0].children[i].children[0].checked)?++count:count;

    if ($('#counterTreeviewUL'+idInstanceTreeview)[0].children.length == count)
    {
        $('#'+idSelectGraph)[0].checked=true;
        $('#'+idSelectGraph)[0].indeterminate=false;
    }
    else if (count==0)
    {
        $('#'+idSelectGraph)[0].checked=true;       
        $('#'+idSelectGraph)[0].indeterminate=false;        
    }
    else
    {
        $('#'+idSelectGraph)[0].checked=true;
        $('#'+idSelectGraph)[0].indeterminate=false;
    }   
        for (var i=0;i<$('#counterTreeviewUL'+idTreeview)[0].children.length;i++)
    {   
        if (!$('#counterTreeviewUL'+idTreeview)[0].children[i].children[0].checked)
        {   
            $('#counterTreeviewUL'+idTreeview)[0].children[i].children[0].checked=true;

       var fnInstance=$('#counterTreeviewUL'+idTreeview)[0].children[i].children[0].attributes[1].value;

       fnInstance=fnInstance.substr(15).substr(0,fnInstance.length-2);  
       var flagsInstance=fnInstance.split(new RegExp(","));

            var graph = {
                    id: seqId,
                    entityName: flags[6].substr(1).substr(0, flags[6].length - 2),
                    entity: flags[5].substr(1).substr(0, flags[5].length - 2),
                    idCounter: flags[4],
                    counterName: flags[3].substr(1).substr(0, flags[3].length - 2),
                    ivmanager: flags[7].substr(1).substr(0, flags[7].length - 2),
                    chart: null,
                    pointsToShowX: null,
                    borneInf: null,
                    unite: "",
                    idInstance: flagsInstance[2].substr(1).substr(0, flagsInstance[2].length - 2),
                    instanceName: flagsInstance[3].substr(1).substr(0, flagsInstance[3].length - 2),
                    listPdsNull: new Array(),
                    countInstance: idTreeview + "_" + i,
                    countGraph: -1
                };

            seqId++;            
            graphs[graphsLastId]=graph;             
            graphsLastId++;
        }
    }

 }
    graphsToLoad=false;
    updateAllGraphs();
    loading=false;

    if($('#counterTreeviewUL'+idInstanceTreeview).length == 0)
    {

      if($('#'+idSelectGraph)[0].checked)
        {
        countSelectedGraphs(graphsLastId, flags[5].substr(1).substr(0,flags[5].length-2), 0);
        }
      else 
        {
        countSelectedGraphs(graphsLastId, flags[5].substr(1).substr(0,flags[5].length-2), 0);
        }
    }

    else 
    {
    countSelectedGraphs(graphsLastId, flags[5].substr(1).substr(0,flags[5].length-2), 0);       
    }
} 
```

任何有关导致此看似随机错误的原因的见解都将不胜感激，因为我在网上找不到太多关于此错误的信息（我看到它发生的情况与我的情况完全不同），谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:29:15.830

线

```
fn=fn.substr(12).substr(0,fn.length-2); 
```

从创建一个子字符串开始，有效地从字符串中剥离前 12 个字母，并留下“5”。（在这种情况下，第二个`substr`实际上什么都不做）

因为 fn 在您分配时`flags`为`flags`“5”，所以也是“5”，这是一个 1 字符的字符串，因此`flags[6] == undefined`（或任何大于 0 的索引）。只需在控制台中尝试以下 3 行：

```
var x = "5"; 
x[0]; // returns "5"
x[1]; // returns undefined 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:54:29.300

这是您的可读代码：

```
var graph = {
    id: seqId,
    entityName: flags[6].substr(1).substr(0, flags[6].length - 2),
    entity: flags[5].substr(1).substr(0, flags[5].length - 2),
    idCounter: flags[4],
    counterName: flags[3].substr(1).substr(0, flags[3].length - 2),
    ivmanager: flags[7].substr(1).substr(0, flags[7].length - 2),
    chart: null,
    pointsToShowX: null,
    borneInf: null,
    unite: "",
    idInstance: flagsInstance[2].substr(1).substr(0, flagsInstance[2].length - 2),
    instanceName: flagsInstance[3].substr(1).substr(0, flagsInstance[3].length - 2),
    listPdsNull: new Array(),
    countInstance: idTreeview + "_" + i,
    countGraph: -1
}; 
```

您**需要**确保每次调用时`substr`，您调用它的“字符串”都存在。

# android - 将编辑的图像发送到下一个活动

> ID：13088225
> 
> 赞同：1
> 
> 时间：2012-10-26T13:50:56.020
> 
> 标签：android, draw, paint

我已经编写了代码来在图像上绘制文本并将其发送到下一个活动。在同一活动中，它正在显示图像，但在下一个活动中，它不显示图像。

```
Canvas canvas = new Canvas(photo);
                Paint paint = new Paint();
                paint.setColor(Color.WHITE);
                paint.setStrokeWidth(12); // Text Size
                canvas.drawBitmap(photo, 0, 0, paint);
                canvas.drawText(topaste, 15, 150, paint);
                image.setImageBitmap(photo);
                Intent i1=new Intent(FullScreen.this,EditImage.class);
                i1.putExtra("photoo", photo);
                startActivity(i1); 
```

和接收活动是

```
image=(ImageView)findViewById(R.id.image);
        Intent intent = getIntent();
        photo = (Bitmap) intent.getParcelableExtra("photooo");
        image.setImageBitmap(photo); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:53:58.827

当您检索额外内容时，您拼错了关键字。当您将照片放入意图时，您使用了“photoo”，当您在下一个活动中获得它时，您使用了“photooo”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T13:54:08.610

发生这种情况是因为 photoo != photooo

# data-structures - DoubleUpperTriMatrix 结构类型位于何处？

> ID：13088229
> 
> 赞同：0
> 
> 时间：2012-10-26T13:51:07.923
> 
> 标签：data-structures, vb.net-2010

我需要在我的应用程序中创建一个 DoubleUpperTriMatrix 数据结构，但我找不到它的位置，因此我可以导入所需的库。使用谷歌发现人们通过它包含它，`System.Object.CenterSpace.NMath.Matrix.DoubleUpperTriMatrix`但它似乎在 Visual Studio 2010 上不再存在。我如何包含它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:59:00.090

[此组件](http://www.centerspace.net/doc/NMathSuite/ref/html/T_CenterSpace_NMath_Matrix_DoubleUpperTriMatrix.htm)不是 Visual Studio 的一部分，也不是由 Microsoft 发布的。它由名为[CenterSpace Software](http://www.centerspace.net/)的第 3 方发布，作为其[NMath](http://www.centerspace.net/products/nmath/)软件包的一部分，您需要购买该软件包。

# iphone - 需要帮助了解我在第一个 iPhone 应用上的错误

> ID：13088230
> 
> 赞同：0
> 
> 时间：2012-10-26T13:51:09.843
> 
> 标签：iphone, ios, xcode, sdk, interface-builder

> **可能重复：**
> [应用程序应具有根视图控制器控制台](https://stackoverflow.com/questions/8190567/applications-expected-to-have-a-root-view-controller-console)

我正在尝试按照一本书一步一步地构建第一个应用程序，但我想我犯了一个错误。这是一个简单的视图应用程序，只有一个徽标和一个标签，然后我单击构建并运行，它说“构建成功”，但是当 ios 模拟器弹出时，应用程序仍然是空白的，即使我回到家并将应用程序绳索什么也没有改变。我在调试窗口中看到这条语句：

> 2012-10-26 04:07:03.376 Welcome[1219:c07] 应用程序窗口应在应用程序启动结束时有一个根视图控制器

据我了解，我的应用缺少根视图控制器，但我该如何实现呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:53:21.073

您在 appDelegate 类中指定根视图控制器。它应该看起来像这样：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
    self.viewController = [[[ViewController alloc] initWithNibName:@"theNameOfMyXib" bundle:nil] autorelease];
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

您需要添加的重要行是：

```
self.viewController = [[[ViewController alloc] initWithNibName:@"theNameOfMyXib" bundle:nil] autorelease];
self.window.rootViewController = self.viewController; 
```

在 initWithNibName 下，您输入创建界面的 xib 的名称。

**注意：**`autorelease`仅当您的项目不使用 ARC时才添加。

# php - 限制 Magento SOAP 查询的结果集

> ID：13088231
> 
> 赞同：4
> 
> 时间：2012-10-26T13:51:10.127
> 
> 标签：php, api, magento, soap

如何为 Magento SOAP 查询指定最大结果集？

我正在通过 SOAP API 查询 Magento 以获取与给定状态匹配的订单列表。我们有一些远程主机需要很长时间才能返回列表，所以我想限制结果集但是我没有看到这个参数。

```
$orderListRaw = $proxy -> call ( $sessionId, 'sales_order.list', array ( array ( 'status' => array ( 'in' => $orderstatusarray ) ) ) ); 
```

我能够看到我们确实取回了数据（6 分钟后）并且已经能够处理超时等，但更愿意只强制一个最大结果集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T23:52:21.020

似乎不能使用限制来完成，（另外你必须做一些复杂的分页逻辑来获取所有记录，因为你需要知道记录的总数，而 api 没有这样的方法）查看 api 调用列表 @ [http://www.magentocommerce.com/api/soap/sales/salesOrder/sales_order.list.html](http://www.magentocommerce.com/api/soap/sales/salesOrder/sales_order.list.html)

但是您可以做的一种解决方法是使用复杂的过滤器，以根据创建日期限制结果集。（根据订单量调整为每小时、每天或每周）。

此外，由于您使用的是状态类型（假设您排除更多只是取消订单），您可能需要考虑获取所有订单并在本地跟踪 order_id/status（仅处理具有上述状态的那些）和未进行的其余部分将是稍后可能需要您注意的订单 ID 列表

伪代码示例

```
$params = array(array(
        'filter' => array(
            array(
                'key' => 'status',
                'value' => array(
                    'key' => 'in',
                    'value' => $orderstatusarray,
                ),
            ),
        ),
        'complex_filter' => array(
            array(
                'key' => 'created_at',
                'value' => array(
                    'key' => 'gteq',
                    'value' => '2012-11-25 12:00:00'
                ),
            ),
            array(
                'key' => 'created_at',
                'value' => array(
                    'key' => 'lteq',
                    'value' => '2012-11-26 11:59:59'
                ),
            ),
        )
    ));

    $orderListRaw = $proxy -> call ( $sessionId, 'sales_order.list', $params); 
```

阅读更多关于过滤@http [://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-8-varien-data-collections](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-8-varien-data-collections)

# capybara - 在 Capybara 我想看看字符串是否不在表格中

> ID：13088236
> 
> 赞同：0
> 
> 时间：2012-10-26T13:51:25.910
> 
> 标签：capybara

我想检查给定的字符串是否不在表格行中。但是当使用下面的代码时：

```
page.should have_xpath('//td', :text => r) 
```

它也匹配表中的文本。例如，表中没有带“G”的值，但有“PG”，因此上面的代码也为“G”返回正数。如何使用 Capybara 检查精确的字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T16:05:42.780

用这个解决了它：

```
regex = Regexp.new("(^#{r}$)")
page.should_not have_xpath('//td', :text => regex) 
```

# php - 在php中对多维数组进行排序

> ID：13088238
> 
> 赞同：-3
> 
> 时间：2012-10-26T13:51:32.307
> 
> 标签：php, sorting, multidimensional-array

> **可能重复：**
> [PHP - 多个 uasort 函数中断排序](https://stackoverflow.com/questions/5198276/php-multiple-uasort-functions-breaks-sorting)

我在php中有3列的多维数组。我需要按“awarded_units”对其进行排序，如果两个用户具有相同的awarded_units（tiebreaker），那么选择最少的单位将首先出现。

```
user_id awarded_units selected_units

15       5               2
22       5               1
3        4               2
4        4               5
5        4               1 
```

正如你所看到的，我已经使用一些多维排序函数基于award_units 对数组进行了排序。现在，我需要解决决胜局条件。由于 user_id=15 和 user_id=22 具有相同的奖励单位，因此 user_id 22 必须排在第一位。

正确的顺序将是

```
user_id awarded_units selected_units

22       5               1
15       5               2
5        4               1
3        4               2
4        4               5 
```

请告诉我该怎么做。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:58:18.437

您可以使用[`array_multisort`](http://php.net/array_multisort)：

```
$cols = array();
foreach ($multiArray as $key => $value) 
{
    $cols['awarded_units'][$key]  = $value['awarded_units'];
    $cols['selected_units'][$key] = $value['selected_units'];
}
array_multisort($cols['awarded_units'], SORT_DESC, $cols['selected_units'], SORT_ASC, $multiArray); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:59:18.680

使用[带有 usort 的自定义排序功能](http://no.php.net/usort)：

```
usort($data, function($a, $b) {
    if ($a['awarded_units'] == $b['awarded_units'])
    {
        return $b['selected_units'] - $a['selected_units'];
    }

    return $b['awarded_units'] - $a['awarded_units'];
}); 
```

您也可以为此使用[array_multisort ，但我更喜欢使用 usort - 更大的灵活性和更好的可读性。](http://no.php.net/array_multisort)

# java - java jackson解析包含泛型对象的对象

> ID：13088239
> 
> 赞同：2
> 
> 时间：2012-10-26T13:51:38.610
> 
> 标签：java, json, parsing, generics, jackson

我有以下问题。

我必须将 json 请求解析为包含通用类型字段的对象。

**编辑**

我已经使用常规类类型进行了一些测试（所以我在用泛型替换它之前让它工作）。现在解析单个元素效果很好。

问题是当我需要从该类中解析出一个列表对象时。

所以我必须以某种方式通知杰克逊，我的 T 是类型列表，而不仅仅是 AlbumModel。

这是我尝试过的。

```
 @Override
    public ListResponseModel<AlbumModel> parse(String responseBody) throws Exception {
    JavaType type = mapper.getTypeFactory().constructParametricType(ResponseModel.class,
        AlbumModel.class);
    return mapper.readValue(responseBody,
        mapper.getTypeFactory().constructParametricType(ResponseModel.class, type));
    } 
```

但是上面的代码不起作用。这样的解决方案是什么？

我在 ListResponseModel 中的泛型类型定义如下：`List<T> data`

成功如：

```
public class BaseResponseModel<T> {

    @JsonProperty("data")
    private T data;

    @JsonProperty("paginations")
    private PaginationModel pagination;
} 
```

到目前为止，我有以下代码，但它总是解析成一个哈希。

```
public class ResponseParser extends BaseJacksonMapperResponseParser<ResponseModel<AlbumModel>> {

    public static final String TAG = ResponseParser.class.getSimpleName();

    @Override
    public ResponseModel<AlbumModel> parse(String responseBody) throws Exception {
        return mapper.readValue(responseBody,
                mapper.getTypeFactory().constructParametricType(ResponseModel.class, AlbumModel.class));
    }
}

public abstract class BaseJacksonMapperResponseParser<T> implements HttpResponseParser<T> {

    public static final String TAG = BaseJacksonMapperResponseParser.class.getSimpleName();

    public static ObjectMapper mapper = new ObjectMapper();

    static {
        mapper.disable(Feature.FAIL_ON_UNKNOWN_PROPERTIES);
        mapper.enable(Feature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT);
        mapper.configure(SerializationConfig.Feature.WRAP_ROOT_VALUE, true);
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T15:29:40.973

我同意尤金的回答，但只是想稍微扩展一下。第一步是重构你的 parse 方法，让它接受第二个参数。您需要调用者传入一个 TypeReference 实例，而不是在您的方法中分配类型引用。

```
public BaseResponseModel<T> parse(String responseBody, TypeReference<T> ref) throws Exception {
    return mapper.readValue(responseBody, ref);
} 
```

不幸的是，您的代码段没有显示调用 parse 的代码 - 所以我会编造一些东西：

```
BaseResponseParser<Collection<Person>> parser = new BaseResponseParser<Collection<Person>>();
BaseResponseModel<Collection<Person>> result = parser.parse(jsonText, new TypeReference<Collection<Person>>(){}); 
```

请注意，在这种情况下编译 TypeReference 实例时，它是对我们期望的真实具体类的类型引用。

你可以在运行时传入一个 Class 做同样的事情，但是 TypeReference 更强大一些，因为它甚至在类型 T 是一个泛型集合时也能工作。TypeReference 实现中有一些魔力，允许它保留通常会被擦除的类型信息。

[更新]

更新使用`Collection<Person>`。注意 - 据我所知，它`List<Whatever>`也应该可以工作，但我仔细检查了一个我使用杰克逊反序列化集合的项目。基类 Collection 确实有效，所以我坚持了下来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:27:12.163

您的类型 T 将在运行时“擦除”，因此 Jackson 不知道 T 的真实类型是什么，并将其反序列化为 Map。您的 parse 方法需要第二个参数，即`Class<T> clazz`or`TypeReference<T>`或`java.lang.reflect.Type`。

**编辑**

关于 TypeReference 魔力的小解释。当您执行 new XX() **{}**时，您正在创建一个匿名类，因此如果它是一个具有类型变量的类（如果您愿意，可以进行参数化）， new`X<List<Y>>() {},`您将能够`List<Y>`在运行时检索为 java 类型。就好像您已经完成了非常相似：

```
abstract class MyGenericClass<T> {}
class MySpecializedClass extends MyGenericClass<List<Y>> {} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:14:21.563

由于您使用的是 Jackson，您可能需要创建自定义 JsonDeserializer 或 JsonSerializer，具体取决于您是在处理响应还是请求。我已经用 Dates 做到了这一点，因为在我的回复中我想要一个标准视图。我不是 100% 肯定它会与通用字段一起工作。这是我正在做的一个例子：

```
public class DateSerializer extends JsonSerializer<Date> {

    private SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZZ");

    @Override
    public void serialize(Date value, JsonGenerator jgen, SerializerProvider provider) throws IOException, JsonProcessingException {
        String dateString = dateFormat.format(value);
        jgen.writeString(dateString);
    }

} 
```

然后我就像这样将它添加到我的类中：

```
@JsonSerialize(using = DateSerializer.class)
public Date getModifiedDate() {
    return modifiedDate;
} 
```

# javascript - Dojo FilteringSelect 加载数据

> ID：13088240
> 
> 赞同：1
> 
> 时间：2012-10-26T13:51:53.057
> 
> 标签：javascript, dojo, dijit.form

我在下面有以下代码，它将创建一个**FilteringSelect**并设置第一个选定项：

```
// Store initialization:
var jsonStore = custom.store.JsonRest({ ... });
var memoryStore = dojo.store.Memory();
var myStore = dojo.store.Cache( jsonStore, memoryStore);
var dataStore = custom.store.MyObjStore({ objectStore: myStore, ...  });

// FilteringSelect initialization:
var fsel = new dijit.form.FilteringSelect({
             id: 'fsel',
             searchAttr: 'id',
             store: dataStore
           });

// Setting the first item on FilteringSelect, retrieved from store objects
fsel.store.fetch({ query: {id:""},
  onComplete: function (items, request) {
    var val = "";
    if (items.length>0) val = items[0].id;
    fsel.set('value', val);
  }
}); 
```

1.  第一个问题是，如果是`items[0].id = 0`，FilteringSelect 上没有设置此项。

2.  `fsel.store.fetch({ ... })`查询服务器，没问题。问题是检索到的项目没有保存在内存中，或者它们是，但在下一个事件中没有被 FilteringSelect 检索。我的意思是，当我第一次单击 FilteringSelect 的下拉菜单时，另一个查询被发送到服务器以获取项目，随后它们从内存中获取。

谁能帮我解决这两个问题？

注意：我使用的是 Dojo 版本 1.7.2 (27913)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T23:40:07.393

与dojo的某人交谈后，我通过以下方式解决了我的问题：

1.  切换到最后一个版本（**1.8.1**），修复了第一个问题。

2.  在 FilteringSelect 上使用*memoryStore*，而不是缓存存储 ( *myStore* )，只会使用内存中的对象。*在myStore* （缓存存储）上进行查询会将对象从服务器加载到内存。

```
// Store initialization:
var jsonStore = new JsonRest({ ... });
var memoryStore = new Memory();
var myStore = new Cache(jsonStore, memoryStore);
// Note: ObjectStore was removed.

// FilteringSelect initialization:
var fsel = new FilteringSelect({
         id: 'fsel',
         searchAttr: 'id',
         store: memoryStore
       });

// Setting the first item on FilteringSelect and loading items to memory
when (myStore.query({id:""}),
  function (items, request) {
    var val = "";
    if (items.length>0) val = items[0].id;
    fsel.set('value', val);
  }
); 
```

# sql - OLEDB 命名参数和分组方式：“？” 行不通

> ID：13088241
> 
> 赞同：2
> 
> 时间：2012-10-26T13:51:55.773
> 
> 标签：sql, excel, oledb

> **可能重复：**
> [GROUP BY 在 SQL 中使用参数](https://stackoverflow.com/questions/8857090/group-by-using-parameters-in-sql)

这是我的 .xlsx 文件的 OLEDB 查询的 SQL 字符串

```
szSQL = "SELECT cawo_wo_id, wows_step_id, wows_description, wffj_cur_state_desc, cawo_wo_id & wows_step_id AS p5_id FROM [" & SourceSheet$ & "$" & sourceRange$ & "] WHERE [wows_description] like '%ECR%';" 
```

我知道 OLEDB 不支持命名参数，但为什么它不能与使用“？”的“分组依据”一起使用？作为参数？

像这样：

```
szSQL = "SELECT cawo_wo_id, wows_step_id, wows_description, wffj_cur_state_desc, cawo_wo_id & wows_step_id AS p5_id FROM [" & SourceSheet$ & "$" & sourceRange$ & "] WHERE [wows_description] like '%ECR%' GROUP BY ?;" 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:05:36.590

这样做会根据您作为参数值发送的值进行分组，并且不允许对文字值进行分组。

如果要动态地对不同的字段进行分组，则必须动态地创建查询，而不是将字段名称放在参数中。

# facebook - facebook 应用程序 php 发布到朋友墙

> ID：13088242
> 
> 赞同：-1
> 
> 时间：2012-10-26T13:52:01.573
> 
> 标签：facebook, facebook-php-sdk

我有一个脚本可以成功发布到我的朋友墙链接和消息，但是当我像这样打开循环时：

```
for ($i = $from; $i <= $to; $i++) {
        $sendTo = $userid[$i];

        echo '<p>sending user '.$i.'</p>';

        if($result = $facebook->api("/$sendTo/feed/",'post', $attachment))                        

                    {
            echo '<p>sended user '.$i.'</p>';
        } else {
            echo 'Oops something went wrong';
        }} 
```

它只发布 4 或 5 条消息，然后中断。我认为问题在于 facebook 不允许在短时间内发送很多消息。我怎样才能制作一些超时功能或发布至少 100 条消息的东西？当我只发布 5 条消息时，我设法以 5×5 的方式发布 100 条信息，但我需要以 100×100 的方式发布。你能帮我吗？

感谢您的时间和最好的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T15:47:50.307

Facebook 不鼓励像这样在多个用户的墙上发帖。如果您想向多个用户发送消息，他们建议您使用[请求对话框](https://developers.facebook.com/docs/reference/dialogs/requests/)。

要延迟发送请求，您可以`sleep(300)`在每 5 个帖子之后添加一个命令，以在帖子之间延迟 5 分钟。您将遇到脚本超时问题。最好让您的脚本[创建一个 cron 作业](https://stackoverflow.com/questions/4765454/how-to-set-up-a-cron-job-via-php-not-cpanel)，一次发布 5 个项目，并且每 5 分钟运行一次。

使用这两种方法中的任何一种，您都会向用户发送垃圾邮件，并且存在应用程序被禁用的风险。有关详细信息，请参阅此[Facebook 开发人员博客文章](https://developers.facebook.com/blog/post/516/)。

# django - Django urlpatterns 用 ugettext lazy 翻译 - 如果 404 如何再次检查 url 是否与另一种语言匹配？

> ID：13088245
> 
> 赞同：4
> 
> 时间：2012-10-26T13:52:09.390
> 
> 标签：django, internationalization, url-pattern

读栈溢出很久了，第一次来这里请教一下。

该应用程序是双语的。我在 urlpatterns 中定义了要使用 ugettext_lazy 翻译的 url。用户选择第一种语言并且 url 可以正常工作，如果他将 lang 更改为第二种语言，它也可以正常工作。

但是如果用户选择第一种语言并在第二种语言中输入 url，他会得到 404，因为没有匹配，因为 urlpatterns 被翻译为第一种语言。

我怎么能强迫 Django 再次检查翻译成第二语言的 urlpatterns？我想显示一个页面（如果存在），就好像 url 将在第一个语言中输入一样。

我使用 LocaleMiddleware。

我想过设置 cookie 和重定向，但如果没有找到，在用户 url 中将显示翻译为第二语言的 url，而不是用户输入的内容，这可能会产生误导。

有任何想法吗？

问候，迈克

**编辑：**我不使用那些 i18n 模式。我有类似的东西：

url(_(r'^contact/'), 包括('contact.urls')),

并希望 Django 无论选择何种语言都显示适当的视图。如果用户输入 /contact/ 或翻译成第二语言 /kontakt/，则应显示视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T18:57:05.620

我真的不喜欢翻译 URL 的想法，但尝试这样的事情：

zh/django.po：

```
msgid "^contact/"
msgstr "^en/contact/"

msgid "^wrong_lang/(?P<url_part>.+)"
msgstr "^ru/(?P<url_part>.+)" 
```

网址.py：

```
url(_(r'^contact/'), include('contact.urls')), # matches "en/contact/" URL
url(_(r'^wrong_lang/(?P<url_part>.+)', redirect_to_current_lang), # matches "ru/..." URLs 
```

视图.py：

```
def redirect_to_current_lang(request, url_part):
   return HttpResponseRedirect(_('^%s' % url_part)) 
```

# web-services - 用于多平台应用程序的可发现 Grails Web 服务

> ID：13088247
> 
> 赞同：0
> 
> 时间：2012-10-26T13:52:16.503
> 
> 标签：web-services, grails

我有以下内容： - Grails Web 应用程序 - 绑定为包含在 Web 应用程序中的插件的域类。- Android 和 iphone 应用程序使用 web 应用程序的 restful url 进行服务器调用（json 请求/响应）。

这就是问题所在：这两个移动应用程序都无法知道它们可以进行哪些调用（什么是有效属性等）。开发人员只需查看 Web 应用程序代码即可确定要命中的 url 和要在请求中设置的域模型属性。

我想知道是否有一些 grails 插件允许您通过 xml（或其他格式）定义域模型，然后生成可以打包为 jar 的 grrovy 类（存根类）。然后可以将这个 jar 作为依赖项包含在 android 应用程序中。

同样，xml 也可以用于为 iphone 应用程序生成类（我怀疑很可能没​​有插件）。

对这种方法有一些想法会很棒。这是个好主意吗？有没有更好的方法来解决它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:09:47.800

您可以使用 Java DTO 定义 JSON 接口。然后，您可以将它们包含在您的 Android 应用程序中。我刚刚做了一个这样的应用程序。但下一次我认为我不会为 DTO 烦恼——我想，麻烦多于好处。

最好的，安德斯

# c# - WPF 无法在 DataGridTemplateColumn 中显示椭圆

> ID：13088252
> 
> 赞同：1
> 
> 时间：2012-10-26T13:52:27.800
> 
> 标签：c#, wpf, wpfdatagrid, ellipse, datagridtemplatecolumn

我在 DataGridTemplateColumn 中有一个 Ellipse，它绑定的数据在下一列中正确显示，但我的椭圆列始终为空，没有显示任何内容。

```
<DataGridTemplateColumn CanUserResize="False" Header="StateEllipse">
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <StackPanel>
                <Ellipse Fill="{Binding Path=State, Converter={StaticResource StateToBrush}}" Width="10" Height="10" />
                <TextBlock Text="{Binding Path=State}" />
            </StackPanel>
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn>
<DataGridTextColumn Header="State" Binding="{Binding Path=State}" /> 
```

我的转换器看起来像这样：

```
using System;
using System.Globalization;
using System.Windows.Data;
using System.Windows.Media;

namespace ThisNS.NS.Converter
{
    [ValueConversion(typeof(int), typeof(Brush))]
    public sealed class StateToBrush : IValueConverter
    {

    #region IValueConverter Members

        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            Color stateColor = Colors.Yellow;
            switch ((int)value)
            {
                case 0:
                    stateColor = Colors.Green;
                    break;
                case 1:
                    stateColor = Colors.Red;
                    break;
            }
            return new SolidColorBrush(Colors.Yellow);
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }

    #endregion
    }
} 
```

我显示状态值的第二列没问题，但带有椭圆的第一列始终为空。

**转换器永远不会被调用，因此绑定永远不会被绑定。**

有人有想法/建议吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T11:03:18.287

我只是尝试重新创建您的问题，但在我的情况下它工作得很好。请看下文。

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:WpfApplication1="clr-namespace:WpfApplication1"
    Title="MainWindow" Height="350" Width="525">
<Window.Resources>
    <WpfApplication1:StateToBrush x:Key="StateToBrush"/>
</Window.Resources>
<Grid>
    <DataGrid ItemsSource="{Binding Items}" >
        <DataGrid.Columns>
            <DataGridTemplateColumn CanUserResize="False" Header="StateEllipse">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <Ellipse Fill="{Binding Converter={StaticResource StateToBrush}}" Width="10" Height="10" />
                            <TextBlock FontWeight="Bold" Foreground="Blue" Text="{Binding}" />
                        </StackPanel>
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
            <DataGridTextColumn Header="State" Binding="{Binding}" />
            <DataGridTemplateColumn CanUserResize="False" Header="StateEllipse 2">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <Ellipse Fill="{Binding Converter={StaticResource StateToBrush}}" Width="10" Height="10" />
                            <TextBlock FontWeight="Bold" Foreground="Green" Text="{Binding}" />
                        </StackPanel>
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
        </DataGrid.Columns>
    </DataGrid>
</Grid> 
```

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        DataContext = this;
        InitializeComponent();
        Items = new ObservableCollection<int>();
        for (int i = 0; i < 100; i++)
        {
            Items.Add(i);
        }
    }

    public ObservableCollection<int> Items
    {
        get { return (ObservableCollection<int>)GetValue(ItemsProperty); }
        set { SetValue(ItemsProperty, value); }
    }

    public static readonly DependencyProperty ItemsProperty =
        DependencyProperty.Register("Items", typeof(ObservableCollection<int>), typeof(MainWindow));

}

[ValueConversion(typeof(int), typeof(Brush))]
public sealed class StateToBrush : IValueConverter
{

    #region IValueConverter Members

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        Color stateColor = Colors.Yellow;
        switch ((int)value)
        {
            case 0:
                stateColor = Colors.Green;
                break;
            case 1:
                stateColor = Colors.Red;
                break;
        }
        return new SolidColorBrush(stateColor);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }

    #endregion
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:19:36.350

看起来你没有设置椭圆的大小？

您必须设置它的 Width 和 Height 属性才能显示我相信...

# java - 如何在 Android 中使用 JarJar 来更改外部 jar 的包名？

> ID：13088255
> 
> 赞同：8
> 
> 时间：2012-10-26T13:52:36.613
> 
> 标签：java, android, ant, jarjar

我似乎找不到任何关于如何在Android 项目中使用[JarJar的明确说明。](http://code.google.com/p/jarjar/)

我有一个场景，我的应用程序项目依赖于两个独立的库，它们都碰巧使用相同的外部 .jar 文件。如果我尝试编译应用程序，我会得到“转换为 Dalvik 格式失败，错误 1”。

有人可以告诉我如何在 Android 上使用 JarJar，使用 build.xml 文件来更改第三方 .jar 文件夹的包名吗？

* * *

## 回答 #1

> 赞同：-7
> 
> 时间：2012-10-26T13:59:57.460

请按照以下步骤尝试：

1.  首先，您将自己的 jar 文件复制到文件夹中的项目中。
2.  现在您进入您的项目，右键单击您的项目并单击构建路径 - 再次选择配置构建路径，
3.  现在您选择库并选择外部 jar 文件，浏览您的 jar 文件夹后，选择那些 jar 文件。
4.  点击完成

# c# - 捕获当前线程中的所有异常

> ID：13088257
> 
> 赞同：4
> 
> 时间：2012-10-26T13:52:42.570
> 
> 标签：c#, asp.net, wcf, exception-handling

在我的 Web 应用程序中，我有一个单向异步 WCF 服务。在此服务中，我想像在 global.asax Application_Error 中那样捕获所有异常。我试图处理这些事件：

```
AppDomain.CurrentDomain.UnhandledException += (s,e) => { //some logic };
AppDomain.CurrentDomain.FirstChanceException += (s,e) => { //some logic }; 
```

甚至尝试过：

```
//this one is for Win Forms Application
Application.ThreadException += (s,e) => { //some logic }; 
```

和

```
//this one is for Web Application
HttpContext.Current.ApplicationInstance.Error += (s,e) => { //some logic }; 
```

但是这些处理程序都没有到达。

任何想法，我还能尝试什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:03:21.740

If you put those lines of code into a web page they will be lost. Why?

Because Web Page has a limited lifetime. To keep your event handling survive you need to put it into the global asax file.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:06:51.180

WCF 允许您将实现 IErrorHandler 的对象插入到 Dispatcher 的错误处理程序中。

[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)有示例代码。

# asp.net-mvc - 实体框架 One-Zer-One 不同的行为

> ID：13088260
> 
> 赞同：0
> 
> 时间：2012-10-26T13:53:04.880
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first

假设您想在用户表中创建一个父子关系，其类型为 0 到 1，我们希望以同样的方式进一步添加性别。

```
public class Gender
{
    [Key]
    public virtual int GenderID { get; set; }

    public virtual string GenderName { get; set; }

    public virtual ICollection<UserProfile> UserProfiles { get; set; }
} 
```

和用户资料

```
public class UserProfile
{

    [Key]
    public virtual int UserId { get; set; }

    public virtual UserProfile UserParent { get; set; }

    public virtual int? ParentUserId { get; set; }

    public virtual String UserName { get; set; }

    public virtual Gender Gender { get; set; }

    public virtual int? GenderID { get; set; }

  } 
```

为了清楚起见

```
 modelBuilder.Entity<UserProfile>()
            .HasOptional(c => c.UserParent);

        // User -> Gender
        modelBuilder.Entity<UserProfile>()
            .HasOptional(g => g.Gender); 
```

![在此处输入图像描述](../Images/c0fe2dee5ce3ec277ce55f3a9996e0ad.png)

一切看起来都不错，但目前我无法检索从父用户名获得的数据。

```
 public IQueryable<UserProfileListViewModel> UserAllVM
    {
        get
        {
            var uservm = context.UserProfiles
                .Select(l => new UserProfileListViewModel
                { 
                    UserId = l.UserId,
                    UserName = l.UserName,
                    ParentUserId = l.ParentUserId ?? 0,
                    //ParentUserName = this.context.UserProfiles.Where(e => e.UserId == l.ParentUserId).FirstOrDefault().UserName ?? "",
                    ParentUserName = l.UserParent.UserName, **// this way make always null**
                    GenderID = l.GenderID ?? 0,
                    GenderName = l.Gender.GenderName ?? "",
                });

            return uservm;
        }
    } 
```

注释掉现在获取父用户名的方式。问题是为什么我无法检索 Parent UserName - 我想念某事？

Tx 寻求帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:37:18.900

您的模型配置不完整，[请参阅此问题的答案](https://stackoverflow.com/questions/6322005/problem-modelling-relationship-in-entity-framework-using-code-first)。

您可以在其中一个或（与/相同）上使用`[ForeignKey]`属性（[MSDN](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.foreignkeyattribute.aspx)）`UserProfile.UserParent``UserProfile.ParentUserId``UserProfile.Gender``UserProfile.GenderId`

或者您可以通过 Fluent API 定义关系：

```
modelBuilder.Entity<UserProfile>()
  .HasOptional(u => u.UserParent)
  .WithMany()
  .AsForeignKey(u => u.ParentUserId)

// User -> Gender
modelBuilder.Entity<UserProfile>()
  .HasOptional(u => u.Gender)
  .WithMany(g => g.UserProfiles)
  .AsForeignKey(u => u.GenderID); 
```

# ajax - 在 ajax 更新时更改组件类型

> ID：13088261
> 
> 赞同：1
> 
> 时间：2012-10-26T13:53:09.640
> 
> 标签：ajax, jsf-2, primefaces

我的表单上有一个组件（*id="theDocument"*），我想在某些情况下以不同的方式呈现。

如果“ *myBean.theDocument* ”存在，我希望它呈现为*p:commandLink*，但如果它不存在，我希望它呈现为纯文本，例如*h:outputText*。

这种情况会在文件上传后改变（上传后，*myBean.theDocument*将存在，所以我希望它呈现为*p:commandLink*）。

所以在我的*p:fileUpload*上，我有这样的事情：

```
<p:fileUpload fileUploadListener="#{myBean.handleFileUpload}" update="theDocument"> 
```

我一直在使用 render="..."，并且 update 可以很好地刷新现有组件的值。但是如何在 ajax 更新后更改组件的**类型**（或者我是否需要刷新整个页面并决定以更一般的方式呈现为文本或链接？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:14:44.427

只需在一个公共父级中有两个有条件渲染的组件并更新公共父级。

```
<h:panelGroup id="theDocument">
    <p:commandLink ... rendered="#{not empty myBean.theDocument}" />
    <h:outputText ... rendered="#{empty myBean.theDocument}" />
</h:panelGroup> 
```

# jquery - 如何让多个jQuery动画同时运行？

> ID：13088262
> 
> 赞同：8
> 
> 时间：2012-10-26T13:53:10.620
> 
> 标签：jquery, jquery-animate

就目前而言，我们两者之间存在差异，我希望它们同时运行。这是代码：

```
$(selector1).animate({
    height: '670'
}, 2000, function() {
    // Animation complete.  
});

$(selector2).animate({
    top: '670'
}, 2000, function() {
    // Animation complete.
});​ 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-26T13:55:41.223

使用`queue:false`. 您可以在此处查看完整[文档](http://api.jquery.com/animate/)。

```
$(selector1).animate({
    height: '670'
}, {
    duration: 2000,
    queue: false,
    complete: function() { /* Animation complete */ }
});

$(selector2).animate({
    top: '670'
}, {
    duration: 2000,
    queue: false,
    complete: function() { /* Animation complete */ }
}); 
```

## 文件：

> **.animate(properties, options)** 版本添加：1.0
> 
> * * *
> 
> **properties**动画将向其移动的 CSS 属性的映射。
> **options**要传递给方法的附加选项的映射。支持的键：
> `duration:`确定动画将运行多长时间的字符串或数字。
> `easing:`一个字符串，指示用于转换的缓动函数。
> `complete:`动画完成后调用的函数。
> `step:`在动画的每个步骤之后调用的函数。
> **`queue:`**一个布尔值，指示是否将动画放置在效果队列中。如果为 false，动画将立即开始。从 jQuery 1.7 开始， queue 选项也可以接受一个字符串，在这种情况下，动画被添加到由该字符串表示的队列中。
> `specialEasing:`由 properties 参数定义的一个或多个 CSS 属性及其相应的缓动函数的映射（添加 1.4）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T13:57:37.780

使用队列变量作为假...

```
$(function () {
    $("selector1").animate({
     height: '200px'
   }, { duration: 2000, queue: false });
    $("selector2").animate({
     height: '600px'
   }, { duration: 2000, queue: false });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-11T23:00:04.583

虽然对动画的连续调用确实会呈现出它们同时运行的外观，但基本事实是它们是非常接近并行运行的不同动画。

为确保动画确实同时运行，请使用：

```
$(function() {
    $('selector1').animate({..., queue: 'selector-animation'});
    $('selector2').animate({..., queue: 'selector-animation'}).dequeue('selector-animation');
}); 
```

可以将更多动画添加到“选择器动画”队列中，并且所有动画都可以在最后一个动画出列的情况下启动。

干杯，安东尼

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T13:58:59.523

您可以创建一个选择器表达式来选择两个元素，请参见此处的工作示例：[DEMO](http://jsfiddle.net/EF4wJ/2/)。

HTML

```
<div id="blah">Blah</div>
<div id="bleh">Bleh</div>
<input type="button" id="btn" value="animate" />
​ 
```

Javascript

```
function anim() {
    $('#blah, #bleh').animate({
        height: '670'
    }, 2000, function() {
        // Animation complete.  
    });
}
$(function(){
    $('#btn').on('click', anim);
});​ 
```

# url - URL 文件格式多个目标

> ID：13088263
> 
> 赞同：1
> 
> 时间：2012-10-26T13:53:13.710
> 
> 标签：url, file-format

.url 文件（互联网快捷方式）的普遍接受的文件格式如下：

```
[InternetShortcut]
URL=http://example.com
WorkingDirectory=C:\WINDOWS\
ShowCommand=7
IconIndex=1
IconFile=C:\WINDOWS\SYSTEM\url.dll
Modified=20F06BA06D07BD014D
HotKey=1601 
```

有没有办法，最有可能是黑客，让一个互联网快捷方式文件打开多个标签？我试过这个：

```
...
URL=http://example.com
URL=http://example.com
... 
```

这： ... URL= [http://example.com](http://example.com)；[http://example.com](http://example.com) ... 用逗号代替分号也是一样。我还尝试在分号/逗号后使用空格。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:00:31.183

您可以使用 HTML 和 JS 执行此操作，此处解释：http: [//www.bloggersentral.com/2009/11/opening-multiple-links-in-single-click.html](http://www.bloggersentral.com/2009/11/opening-multiple-links-in-single-click.html)

# c++ - 获取网卡地址

> ID：13088280
> 
> 赞同：0
> 
> 时间：2012-10-26T13:54:43.740
> 
> 标签：c++, nic

嗨，谁能指导我如何使用 C++ 在用户计算机上获取 NIC 地址？我不完全确定这是否可行，作为初学者，我不太确定从哪里开始

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:58:43.567

在 Windows 中，您可以使用 GetAdaptersAddresses 函数来检索物理地址。

```
std::string ConvertPhysicalAddressToString(BYTE* p_Byte, int iSize)
{
    string strRetValue;

    char cAux[3];
    for(int i=0; i<iSize; i++)
    {
        sprintf_s(cAux,"%02X", p_Byte[i]);
        strRetValue.append(cAux);
        if(i < (iSize - 1))
            strRetValue.append("-");
    }

    return strRetValue;
}

void GetEthernetDevices(std::vector<std::string> &vPhysicalAddress)
{       
    // Call the Function with 0 Buffer to know the size of the buffer required 
    unsigned long ulLen = 0;
    IP_ADAPTER_ADDRESSES* p_adapAddress = NULL;
    if(GetAdaptersAddresses(AF_INET, 0, NULL, p_adapAddress,&ulLen) == ERROR_BUFFER_OVERFLOW)
    {
        p_adapAddress = (PIP_ADAPTER_ADDRESSES)malloc(ulLen);
        if(p_adapAddress)
        {
            DWORD dwRetValue = GetAdaptersAddresses(AF_INET, 0, NULL, p_adapAddress,&ulLen);
            if(dwRetValue == NO_ERROR)
            {               
                IP_ADAPTER_ADDRESSES* p_adapAddressAux = p_adapAddress;
                do
                {
                    // Only Ethernet
                    if(p_adapAddressAux->IfType == IF_TYPE_ETHERNET_CSMACD)                 
                        vPhysicalAddress.push_back(ConvertPhysicalAddressToString(p_adapAddressAux->PhysicalAddress, p_adapAddressAux->PhysicalAddressLength));

                    p_adapAddressAux = p_adapAddressAux->Next;
                }
                while(p_adapAddressAux != NULL);                        
            }
            free(p_adapAddress);
        }
    }
}

int _tmain(int argc, _TCHAR* argv[])
{
    std::vector<std::string> vPhysicalAddress;
    GetEthernetDevices(vPhysicalAddress);
} 
```

# breadcrumbs - 带有 Schema.org 的面包屑未显示在 Google Rich Snippets 测试工具中

> ID：13088284
> 
> 赞同：5
> 
> 时间：2012-10-26T13:54:52.693
> 
> 标签：breadcrumbs, schema.org, microdata, google-rich-snippets

我已经`breadcrumb`使用 Google Rich Snippets 测试工具测试了 Schema.org 示例。

```
<div itemprop="breadcrumb">
  <a href="category/books.html">Books</a> >
  <a href="category/books-literature.html">Literature & Fiction</a> >
  <a href="category/books-classics">Classics</a>
</div> 
```

结果是工具无法识别它。

那么，是否存在错误或语法问题？如果是这样，正确的语法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-09-07T01:25:21.070

您的问题与此问题有点相同[如何为面包屑实现 schema.org 标记？](https://stackoverflow.com/questions/10120096/how-to-implement-schema-org-markup-for-a-breadcrumb/25706256#25706256)

根据[Google Webmaster Central Help Forum](https://productforums.google.com/forum/#!topic/webmasters/XJi_yTNtgzs)的说法，专家暂时不建议使用 schema.org 面包屑标记，似乎“schema.org 面包屑结构存在某种故障”。相反，建议使用 data-vocabulary.org 面包屑标记，Google 和其他搜索引擎也可以轻松阅读该标记。

一个 data-vocabulary.org 面包屑标记示例：

```
<div>
  <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://www.example.com/" itemprop="url">
      <span itemprop="title">example</span>
    </a> >
  </span>  
  <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://www.example.com/fashion/" itemprop="url">
      <span itemprop="title">Fashion</span>
    </a> >
  </span>  
  <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://www.example.com/fashion/women/" itemprop="url">
      <span itemprop="title">Women</span>
    </a> >
  </span>
  <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
    <a href="http://www.example.com/fashion/women/boots/" itemprop="url">
      <span itemprop="title">Boots</span>
    </a>
  </span>
</div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:31:47.877

[您可以按照此 Google 链接](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=185417)中的建议使用面包屑的微数据标记

它肯定会反映在 Google Rich Snippets 测试工具中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T13:24:42.010

你有一个容器元素`itemtype="http://schema.org/WebPage"`吗？[请参阅http://schema.org/WebPage](http://schema.org/WebPage)上的示例。

您还可以看到问题[如何为面包屑实现 schema.org 标记？](https://stackoverflow.com/questions/10120096/how-to-implement-schema-org-markup-for-a-breadcrumb)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-24T15:11:18.323

WebPage 或 MedicalWebPage 应在页面上设置为 itemtype。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-08T02:36:22.557

现在，您实际上可以开始使用基于 schema.org 的面包屑标记。谷歌支持它，这很好。您可以选择格式 JSON-LD（首选）、RDFa、微数据。另一个好处是，如果您的产品需要它，您可以定义多个面包屑，这通常是这种情况。

借助微数据支持，您可以执行以下操作：

```
<ol itemscope itemtype="http://schema.org/BreadcrumbList">
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemprop="item" href="https://www.yoursite.com">
        <span itemprop="name">Home</span></a>
    <meta itemprop="position" content="1" />
  </li>
  ›
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemprop="item" href="https://www.yoursie.com/category/books.html">
      <span itemprop="name">Books</span></a>
    <meta itemprop="position" content="2" />
  </li>
  ›
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemprop="item" href="https://www.yoursie.com/category/books-literature.html">
      <span itemprop="name">Literature & Fiction</span></a>
    <meta itemprop="position" content="3" />
  </li>
  ›
  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemprop="item" href="https://www.yoursie.com/category/books-classics.html">
      <span itemprop="name">Classics</span></a>
    <meta itemprop="position" content="4" />
  </li>
</ol> 
```

注意位置值的使用，建议使用有序列表（'ol'）。

完成此操作后，您可以要求 google 显示您的站点名称，而不是位置 #1 的“主页”。为此，请在您的主页上使用它：

```
<head itemscope itemtype="http://schema.org/WebSite">
<title itemprop='name'>Your Site Name</title>
<link rel="canonical" href="http://www.yoursite.com" itemprop="url"> 
```

对于任何事情，请参阅此处：[https ://developers.google.com/structured-data](https://developers.google.com/structured-data)

# objective-c - 从网络服务获取数据真的很慢

> ID：13088290
> 
> 赞同：0
> 
> 时间：2012-10-26T13:55:04.457
> 
> 标签：objective-c, ios, database, core-data, fetch

我有以下网络服务。

```
"club": {

    "staff": [ … ],
    "trainingen": [ … ],
    "team": [
        {
            "name": "Baerts Lennert",
            "number": "0",
            "position": "Doelman",
            "birthdate": "1996-09-01",
            "red_cards": 0,
            "yellow_cards": 0,
            "news": [
                {
                    "nid": "1158",
                    "player_id": 1
                },
                {
                    "nid": "1148",
                    "player_id": 1
                },

            ]
        }, 
```

我用以下方法得到这个。

```
+ (NSArray *)getPlayNewsWithIndex:(int)index
{
    NSLog(@"index is hier %d",index);
    NSString *request = [NSString stringWithFormat:@"http://www.krcgenk.be/mobile/json/request/club/type/ipad"];
    NSLog(@"log1");
    NSArray *arr = [[self executeGenkFetch:request] valueForKeyPath:@"club.team"];
    NSLog(@"log2");
    NSArray *arr2 = [[arr objectAtIndex:index] valueForKey:@"news"];
    NSLog(@"log3");
    return arr2;
} 
```

在它记录“log1”之后。功能继续需要一段时间。我现在的问题是，这怎么可能？

**编辑**

这是我的 executeGenkFetch

```
+ (NSDictionary *)executeGenkFetch:(NSString *)query
{
    query = [NSString stringWithFormat:@"%@", query];
    query = [query stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
    // NSLog(@"[%@ %@] sent %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd), query);
    NSData *jsonData = [[NSString stringWithContentsOfURL:[NSURL URLWithString:query] encoding:NSUTF8StringEncoding error:nil] dataUsingEncoding:NSUTF8StringEncoding];
    NSError *error = nil;
    NSDictionary *results = jsonData ? [NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers|NSJSONReadingMutableLeaves error:&error] : nil;
    if (error) NSLog(@"[%@ %@] JSON error: %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd), error.localizedDescription);
    // NSLog(@"[%@ %@] received %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd), results);
    return results;
} 
```

# c++ - 根据属性值擦除结构向量中的元素

> ID：13088297
> 
> 赞同：0
> 
> 时间：2012-10-26T13:55:44.317
> 
> 标签：c++, stl, vector, struct

> **可能重复：**
> [erase_if 在哪里？](https://stackoverflow.com/questions/3424962/where-is-erase-if)

我的结构如下：

```
struct V {
 int x;
 int y;
}: 
```

我有一个结构元素的 stl 向量

```
vector<struct V> v1; 
```

我想从向量中删除属性 y 小于某个值的所有元素。

我怎么`std::remove_if`能通过定义与结构关联的谓词来做到这一点。

那是我定义的谓词，但似乎不正确。

```
struct less_than_value
{
 const int value;

 bool operator()(const struct V p) const
 {
    return p.y < value;
 }
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T14:02:48.213

您可以使用带有合适谓词的[擦除删除习语：](http://en.wikipedia.org/wiki/Erase-remove_idiom)

```
bool my_predicate(const V& item)
{
   // apply some logic and return true or false
   return item.x == 42;
}

#include <algorithm>

std::vector<V> v1 = ....;
v1.erase( remove_if(v1.begin(), v1.end(), my_predicate), v1.end() ); 
```

在上面的示例中，所有数据成员`x`等于 42 的元素都将被删除。

**编辑**：看看你的例子，你需要做类似的事情

```
less_than_value pred = {5};
v1.erase( remove_if(v1.begin(), v1.end(), pred), v1.end() ); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T14:07:29.903

在 C++11 中，使用 lambda 很简单：

```
v1.erase( std::remove_if( v1.begin(), v1.end(), [](V const& v) { return v.y<value; }),
          v1.end()); 
```

在 C++03 中，它有点复杂，可以通过多种方式之一完成：创建与上面的 lambda 具有相同行为的函子；使用*装订魔法*（考虑`boost::bind`一种稍微简单的方法）。在这里使用装订魔法会非常复杂，所以我会避免它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:04:49.530

你会想要使用 remove_if （没有erase_if：你将如何实现一个不知道容器被删除的擦除？）

这是一个（编译，测试）程序，演示了如何做到这一点：

```
#include <vector>
#include <iostream>
#include <algorithm>

using namespace std;

struct V
{
    int x; 
    int y;
};

bool y_less_than_5(V const &v)
{
    return v.y < 5;
}

int main()
{
    vector<V> vec;
    V v;
    v.x = 4;  v.y = 1; vec.push_back(v);
    v.x = 17; v.y = 3; vec.push_back(v);
    v.x = 21; v.y = 5; vec.push_back(v);
    v.x = 36; v.y = 7; vec.push_back(v);
    v.x = 25; v.y = 9; vec.push_back(v);

    vec.erase(
        remove_if(vec.begin(), vec.end(), y_less_than_5),
        vec.end());

    for(vector<V>::const_iterator it = vec.begin(); it != vec.end(); ++it)
    {
        cout << "[" << it->x << "," << it->y << "]" << endl;
    }
} 
```

输出：

```
[21,5]
[36,7]
[25,9] 
```

您提供谓词的确切方法可能会有所不同，但这是一个不同的问题；）

# haskell - Haskell Parsec 跳过所有未预定义的单词

> ID：13088301
> 
> 赞同：5
> 
> 时间：2012-10-26T13:55:56.097
> 
> 标签：haskell, parsec

学习使用 Parsec 库，这是家庭作业的一部分。

**编辑：**欢迎提出使用其他库的建议，重点是解析。

我想要的是从任何句子中提取所有带有大写字母和四个罗盘方向的单词。例如：“比利时完全位于荷兰南部。” 应该找到并返回“比利时南荷兰”。

我想不通的是如何忽略（吃掉）任何不是指南针方向的输入。我正在寻找类似的东西

```
'many (not compassDirection >> space)' 
```

但是 g(h)oogle 并没有帮助我。

以下代码显然停留在“许多”功能上。

```
readExpr :: String -> String
readExpr input = case parse (parseLine) "" input of
    Left err -> "No match: " ++ show err
    Right val -> "Found: " ++ showVal val

parseLine :: Parser GraphValue
parseLine = do
            x <- parseCountry
            space
            many ( some (noneOf " ") >> space )
            y <- parseCompass
            space
            many ( some (noneOf " ") >> space )
            z <- parseCountry
            return $ Direction [x,y,z]

compassDirection :: Parser String
compassDirection = string "north" <|>
                   string "south" <|>
                   string "east" <|>
                   string "west"

parseCountry :: Parser GraphValue
parseCountry = do 
                c <- upper 
                x <- many (lower)
                return $ Country (c:x)

parseCompass :: Parser GraphValue
parseCompass = do 
                x <- compassDirection
                return $ Compass x 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T18:20:29.733

我将告诉你我将如何开始，然后建议我将如何继续。

我将其基于抽象数据结构 - 当您添加额外的单词时，您可以更仔细地对它们进行分类：

```
data Word = Country String | Direction NSEW | Unclassified String
data NESW = North | East | South | West 
```

所以我对你如何跳过你不知道的单词的回答是你不需要 - 将它们保留为未分类。

applicative 风格比 monadic 风格更好。

我认为`compassDirection`应该允许大写：

```
compassDirection :: Parser NESW
compassDirection = north <|> south <|> east <|> west where
    north = North <$ (string "north" <|> string "North")
    east = ... 
```

您可以定义`country`使用`Country <$> ((:) <$> upper <*> many lower)`

然后你可以有一个包罗万象的`Unclassified <$> many letter`。

您的单词解析器当前可以是

```
word = compassDirection <|> country <|> unclassified 
```

但请注意`compassDirection`必须在前面`country`，否则`country`会匹配`North`。

你可以做

```
words = word `sepBy1` space 
```

目前没关系，但你一定不能使用`word`或`words`当你更正确地分析句子时，因为你无法控制单词是什么。那时您需要`noun`, `adjective`, `nounPhrase`, `verb`, `adjective`,`adjectivalPhrase`等来传递句子结构。您无法解析的句子意味着您需要在语法中添加新的结构。

值得让单词解析器在它们之后（或之前）吞下空格，或者使用将单词从空格和标点符号中分离出来的预处理器进行重构。`fullStop`如果您是英国人，请考虑使用`period`解析器；如果您是美国人，请考虑使用解析器。创建句子解析器时使用它。

使用 applicative 和更高阶的函数将使你的语法更清晰，因为你不会把它与一元符号混在一起，它看起来像句子。示例：`nvn = NVN <$> noun <*> verb <*> noun`如果您想使用主要是抽象数据结构 (AST) 方法，每个语法对象有一个构造函数，您可以这样做。如果你只是喜欢有一堆相同类型的单词，你可以这样做`nvn = sequence [noun,verb,noun]`。

大多数计算机语言都是使用 AST 方法解析的，但除了从我妻子的语言学学位中获得的二手知识之外，我没有直接的自然语言解析经验。

如果您坐下来写下如何将单词、短语、从句和句子的类别组合在一起，您将能够相当快地编写解析器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T16:11:47.733

我不会详细说明，因为这是家庭作业，并且 OP 说“重要的是解析”。

* * *

我解决这个问题的方法：

*   标记输入。把它分解成文字；这将使真正的解析步骤不必担心令牌定义（即“是 %#@[ 是单词的一部分吗？”）或空格。这可以很简单，`words`或者您可以使用 Parsec 进行标记化。然后你就会拥有`[Token]`（或者`[String]`如果你愿意）。

*   指南针方向的解析器。你已经有了这个（干得好），但如果输入`[String]`不是`String`.

*   以大写字母开头的单词的解析器。

*   其他一切的解析器，只要它看到不是指南针方向或以大写字母开头的单词的标记，就会成功。

*   一种适用于任何标记的解析器，但可以区分好东西和坏东西，可能使用代数数据类型。

*   一个适用于大量令牌的解析器

希望这很清楚，但*不太*清楚；例如，您仍然需要担心何时丢弃垃圾。基本思想是将问题分解为许多小子问题，解决子问题，然后将这些解决方案粘合在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T17:24:43.680

您不能将字符串拆分为以大写字母开头或指南针方向的字符串`words`，`filter`然后将`unwords`它们重新组合在一起吗？不需要`Parsec`拔枪。

# php - 防止我的 Logger 向我发送消息

> ID：13088302
> 
> 赞同：1
> 
> 时间：2012-10-26T13:56:08.000
> 
> 标签：php, logging, monolog

我在我的 PHP 项目中构建了一个 Logger ( [Monolog](https://github.com/Seldaek/monolog) )，它被配置为记录系统事件 (info/debug) 以及错误 (error/critical)

我进行了设置，以便在发生严重错误时调用 2 个系统，一个发送邮件，另一个发送短信。

现在，如果数据库死亡，则会记录一个关键事件，因此会发送邮件和短信。但是由于该站点可能会吸引一些流量，因此该事件可能每分钟触发几次，甚至在高峰时间甚至每秒触发一次。实际上可能是针对站点的每个请求。

我怎样才能防止这种情况发生，防止短信和邮件泛滥/发送垃圾邮件？我是否应该通过某种节流来更改我的代码，即在给定的时间跨度内没有发送相同的错误消息（有点难以区分错误类型），我是否应该收集所有错误并每隔几分钟发送一次（速度较慢响应时间）或者是否有系统可以将我的错误发送到它会为我处理这个问题？我正在考虑一个日志收集器的方向，它可以配置为在某些严重性下发送 SMS/邮件，但有某种限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:04:09.827

我会让它的行为与 ignore_repeated_errors 和 ignore_repeated_source [http://ca2.php.net/manual/en/errorfunc.configuration.php#ini.ignore-repeated-errors相同](http://ca2.php.net/manual/en/errorfunc.configuration.php#ini.ignore-repeated-errors)

无需一遍又一遍地通知相同的错误。如果我收到一条短信和一封电子邮件（备份），表明数据库已关闭，那么对于系统管理员来说应该足够了。

如果您必须让它在一两个小时内发送最多 3 次。

# php - 循环相关项目列表

> ID：13088303
> 
> 赞同：0
> 
> 时间：2012-10-26T13:56:08.620
> 
> 标签：php, wordpress, foreach

我正在尝试打印与显示它们的页面的产品相关的产品列表。排序标准是产品标签。

但是循环让我很痛苦。如何更改下面的代码以使其打印一份与标签完全匹配的产品列表？

```
<?php $wpsc_product_tags = get_the_product_tags( wpsc_the_product_id() );
if ($wpsc_product_tags) {
foreach ($wpsc_product_tags as $wpsc_product_tag) {
$tagname[] = $wpsc_product_tag->name;
echo do_shortcode( "[wpsc_products tag='" . echo implode($tagname) . "']");
}
else
{ echo 'No tags exist for this product.';
} ?> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:58:31.260

您需要将`echo`-oart 移出循环：

```
$tagnames = array();

foreach( (array) get_the_product_tags( wpsc_the_product_id() ) as $wpsc_product_tag )
{
    $tagnames[] = $wpsc_product_tag->name;
}

if( !empty( $tagnames ) )
{
    echo do_shortcode( "[wpsc_products tag='" . implode( ',', $tagnames ) . "']" );
}
else
{
    echo '<p class="error">No tags exist for this product.</p>';
} 
```

# php - 检查 APC 是否已安装并正常工作的正确方法是什么？

> ID：13088309
> 
> 赞同：15
> 
> 时间：2012-10-26T13:56:29.283
> 
> 标签：php, apc

我正在编写一个 wordpress 插件，其中 CSS 被动态编译，因此我实施了各种策略来缓存它。到目前为止，缓存的首选是 APC（如果已安装）。

这就是我检查它的方式

```
 $is_apc_installed = function_exists('apc_store')
        && function_exists('apc_fetch') && ini_get('apc.enabled');
    $sapi_type = php_sapi_name();
    if (substr($sapi_type, 0, 3) === 'cgi') {
        $is_apc_installed = false;
    } 
```

但在某些安装中，我仍然得到 apc_fetch() 总是返回 false。我还应该检查什么以确保 APC 正常工作？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-26T14:00:40.607

你可以试试[extension_loaded](http://php.net/manual/en/function.extension-loaded.php)功能

```
$is_apc_installed = extension_loaded('apc'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-06-28T15:55:59.400

还有其他2种可能性

```
$is_apc_installed = ini_get('apc.enabled') && extension_loaded('apc'); 
```

或简单地使用控制台

```
php -i | grep apc 
```

# java - 字符串中的单词数无限循环

> ID：13088310
> 
> 赞同：0
> 
> 时间：2012-10-26T13:56:34.430
> 
> 标签：java

有人可以告诉我这有什么问题吗？我试图让程序返回字符串中的单词数。它陷入了无限循环......

```
int NumberNames(String wholename)

{    
    String testname=wholename;

    int numnames=0;

     int posBlank= testname.indexOf(' ');

     while(testname.length()>0)
    {   
       testname = testname.trim();

       testname=testname.substring(posBlank+1,testname.length());

       numnames++;

       System.out.println(testname);
    }    

    return numnames;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T13:58:22.193

两个问题。您没有在循环中重置 posBlank 的值，如果您传入一个没有空格的字符串，您的子字符串总是只返回整个字符串。你需要解决这两个问题。试试这个：

```
int NumberNames(String wholename)
{
    String testname=wholename;
    int numnames=1;
    int posBlank= testname.indexOf(' ');

    while(posBlank > 0)
    {   
       testname = testname.trim();
       testname=testname.substring(posBlank+1,testname.length());
       posBlank= testname.indexOf(' ');
       numnames++;
       System.out.println(testname);
    }    

    return numnames;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T13:59:14.283

`wholeName.trim().split(" ").length`改为使用

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T14:02:29.970

为什么不直接使用呢`String.split(\\s)`？？

```
 String testname=wholename;
 String[] words = testname.split("\\s");
 sysout(words.length); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T14:05:45.783

```
return wholename.length() - wholename.replace(" ", "").length() + 1 
```

# ruby-on-rails - Rails同时搜索位置和附近的地理编码

> ID：13088311
> 
> 赞同：0
> 
> 时间：2012-10-26T13:56:35.520
> 
> 标签：ruby-on-rails, ruby, search, where, geocode

有没有一种方法可以同时搜索 where 条件和 near 条件，显示两者的结果。基本上，我想要一个搜索栏，用户可以在其中输入一个人的姓名，但他们也可以输入一个位置，搜索将显示匹配两者的结果。我尝试了 where 查询，然后是一个单独的 near 查询，并遍历地理编码结果并将它们添加到主要结果中，但这会产生重复并且不太理想。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T15:52:12.473

您使用的是哪个地理编码 gem？我的猜测是，`query.where.near`您可以设置选择器生成`query.where`的等效选项，而不是这样做。`near`

这是一个不同的问题，理论上与您所问的问题正交......但是您的控制器是否在将查询传递到 ActiveRecord 之前做出任何决定？例如，如果用户输入`New York, NY`，您的控制器是否“猜测”它是一个位置？还是只是尝试进行名称匹配搜索和地理编码尝试，无论输入是什么？我问这个是因为如果你解析输入，你可能会遇到 if/else 情况， where`if query is a location, do a geocode`或`else do a search by name`.

我想知道在访问数据库之前有一个不区分人名和地点名称的搜索框是否明智的设计，但也许你有一个创造性的用例。

# qt - C++插件代码编辑器实时解析错误

> ID：13088313
> 
> 赞同：3
> 
> 时间：2012-10-26T13:56:53.660
> 
> 标签：qt, netbeans, java-native-interface, netbeans-7

我在 NetBeans 上的实时解析有一个简单的问题，它只影响编辑器；

代码正常工作，所有依赖项都得到满足。但是代码编辑器似乎无法正常工作。

我在网上做了几次搜索，但没有找到任何东西，只是一些 C++ 插件的旧错误，但都已解决。

**我的设置是这样的（*QT 库*）：**

*   操作系统：薄荷 13 - 32x86
*   NetBeans：7.2
*   插件 C++：1.18.1.1
*   制作：4.7
*   项目类型：动态QT C++库
*   包括 JNI 参考：是；
*   包括 QT 参考：是的；

[NetBeans 错误-> http://s1322.beta.photobucket.com/user/RTOSkit/media/Screenshot-10262012-021945PM.png.html](http://s1322.beta.photobucket.com/user/RTOSkit/media/Screenshot-10262012-021945PM.png.html)

*您还可以在第一张图片中看到，它在“导航器”中缺少函数原型*

**在这种类型的配置中（*带有 QT 的 C++ 库*），错误消失了：**

*   操作系统：薄荷 13 - 32x86
*   NetBeans：7.2
*   插件 C++：1.18.1.1
*   海湾合作委员会：4.6
*   项目类型：C++动态库
*   包括 JNI 参考：是；
*   包括 QT 参考：是的；

这只是一个图形问题，该项目运行良好，但是在我编写的每一行代码中，代码编辑器都将我标记为完全不存在的错误。

这个问题有什么解决办法吗？还是我只是在 IDE 的配置中遗漏了一些东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T13:32:49.667

**解决了！**

幸运的是，该问题不是由 C++ 插件中的任何错误引起的。

***但是，是的！*由于 NetBeansIDE 上的 QT 项目中包含优先级。**

JNI' 包含应在窗口内进行

> “选项->C/C++->代码辅助->C编译器”

否则包含在

> “选项->C/C++->代码辅助->C++编译器”

或在

> "属性->构建->QT->专家->自定义定义-> "INCLUDEPATH += "/..."

只会在编译步骤进行评估，让编译器正确编译；但是“代码帮助”将无法解决 JNI 的依赖关系。

在 C++ 标准项目（不是 QT）的情况下，JNI' 包含在

> “选项->C/C++->代码辅助->C++编译器”

![在此处输入图像描述](../Images/89697dbc91688e9331321cd2cb41b3f6.png)

# domain-driven-design - DDD：一个或两个有界上下文？

> ID：13088318
> 
> 赞同：4
> 
> 时间：2012-10-26T13:57:13.663
> 
> 标签：domain-driven-design, bounded-contexts

假设我为我的客户建立了一个系统，允许赌徒维护一个赌注组合并随着时间的推移跟踪他们的收益/损失。该系统支持许多复杂的领域逻辑 - 投注不同的运动，将胜利滚动到其他投注等。

接下来，我的客户想要支持提示者的想法。提示者实际上并不赌博，而是创建“提示表”，这是他们关于下注的提示。提示表可以有不同的种类——有些可以包括任何可投注赛事的提示，其他的只提供赛马提示，等等。我的客户希望系统以与跟踪赌徒表现相同的方式跟踪推销员的表现，并且能够比较不同类型的推销员内部和之间的表现（例如，谁是最好的赛马推销员？他们通常比足球提示者表现更好吗？）

现在，赌徒和推销员之间的领域语言完全不同，并且还有赌徒投资组合不存在的小费表的额外分类。这表明这些是单独的有界上下文。但是，有很多共享逻辑，因为它们都随着时间的推移跟踪性能。

所以我的问题是：

1.  这些真的是独立的有界上下文吗？我对在赌徒上下文中添加分类持谨慎态度（感觉就像一个滑坡）。
2.  如果它们是不同的上下文，我应该：
    *   在它们之间共享性能跟踪逻辑（即共享 DLL、jar 等）？这在感觉错误的上下文之间创建了紧密的实现耦合。
    *   将性能跟踪逻辑留在赌博有界上下文中，将分类逻辑放在提示者边界上下文中，并让它要求赌博上下文跟踪性能？在这种情况下，提示者上下文似乎会将命令发送到赌博上下文，这再次让人感觉不对（我对事件更满意）。
    *   做其他事情......某种在两个上下文之间进行通信和关联的组合层？

## 澄清

赌徒的投资组合和提示者的提示表几乎相同 - 唯一的区别是提示表可以分类（例如赛马、足球等）。

绩效跟踪是关于衡量投资组合/提示表的损益。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T16:26:11.537

1.  如果您看到两个明显独立的模型，只有技术重叠，那么我同意您有两个 BC。但是，请注意，拥有多个 BC，尤其是当它们需要通信时，可能会有点“昂贵”。使用模块要“便宜”得多，这就是为什么你不应该轻易决定拥有多个 BC。

2.  [蓝皮书](https://rads.stackoverflow.com/amzn/click/com/0321125215)第4 部分（战略设计）第 15 章（蒸馏）介绍了非常适合您的场景的通用子域的概念。性能计算可以被视为一个通用的子域，因为虽然它们对于模型的整体功能至关重要，但它们可以被隔离到一个可供两个 BC 使用的库中。这是一种用于提炼模型并保持技术问题抽象的模式。您不需要在 BC 之间实现复杂的消息传递或 RPC 通信，只需使用具有意图显示接口的共享库即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T08:13:34.047

这显然是（至少）2个有界上下文（BC）的情况，它们具有不同的域语言这一事实​​是最大的线索。

如果我理解正确，性能跟踪是一个领域概念，可能它应该是 BC 本身。您可以在通用接口类型的项目中定义通用跟踪和特定跟踪（用于提示者）的接口，这些接口将由其他 BC 的实体实现。因此，PerformanceTracking BC 不会关心具体的赌徒或提示者，并且其他 BC 不会耦合到特定的性能跟踪器。

是的，您将需要同步 BC 和域事件正是为此目的。它并不完全简单，但如果仔细完成它并不那么复杂，并且您会从松散耦合的代码中获得巨大的好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T14:26:59.747

我确实认为它们是两种不同的背景，你也这么认为，对吧？

我个人会使用赌博环境中的领域事件来生成性能跟踪信息。代码仍然是松耦合的（因为逻辑只依赖于领域事件）。

您当然可以在它们之间创建不属于任何这些 jars/dll 的适配器。即订阅context1 中的域事件，调整信息，然后调用context2 中的东西。这样，您就可以在上下文之间获得 100% 的透明度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-29T13:42:40.350

我可能同意 Mike 的观点，Performance Tracking 听起来像是他自己的有界上下文。这看起来像是更明显的边界。

Betters and Tipsters might act on different aggregates of the same bounded context or different bounded contexts. I'd be inclined to choose the latter, according to what you say about the language, and about project evolution.

# c# - 将 ObservableCollection 中的项目“分箱”到单独的 ListBox 中

> ID：13088319
> 
> 赞同：2
> 
> 时间：2012-10-26T13:57:17.340
> 
> 标签：c#, wpf, wpf-controls

我最近遇到了一个相当严重的性能问题，即我如何将 ObservableCollection 中的项目“分箱”到单个 ListBox 中。这在其当前迭代中有效，当用户想要放大/缩小时间轴时，我的问题就出现了。

缩放会改变时间轴上每个块所代表的时间量，并且可能需要将一个 ListBox 中的一些元素移动到相邻的 ListBox 中。它有时还需要添加或删除 ListBox。

我猜问题可能在于我如何重新洗牌 OnZoomChanged 方法中的条目。另一个问题是每次添加一个条目时似乎都会重新绘制所有条目。这两者都可以在更新过程（添加/缩放）过程中产生相当大的延迟。当我超过大约 50-60 个条目时，我真的开始注意到缩放对性能的影响。

我在这里的最终目标是能够将彼此重叠的条目分类到单独的箱（StackPanel/ListBox 等）中，并允许用户在需要时仍然能够浏览所有条目。这些条目是固定大小的（这是造成重叠问题的原因）。

感谢您的任何见解/建议！

以下是所有设置方式的细分：

**View** - 授予这是控件的简化版本。DateTime（GroupingTime）在我的自定义视图中用于放置在时间轴上（这有效）。然后将时间线条目列表 (GroupEntries) 馈送到 TimelineEntryControl 以在 ListBox 中适当地绘制条目。

```
<ItemsControl ItemsSource="{Binding TimelineEntries}">
  <ItemsControl.ItemTemplate>
    <DataTemplate>
      <Views:CustomView>
        <ListBox>
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <Controls:TimelineEntryControl TimelineEntry="{Binding}" Height="50" Width="50" Margin="0,0,0,12"/>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ListBox>
      </Views:CustomView>
    </DataTemplate>
  </ItemsControl.ItemTemplate>
</ItemsControl> 
```

**ViewModel** - TimelineEntryViewModel

```
internal class TimelineEntryViewModel : ViewModel, IDisposable
{
  private readonly ObservableList<TimelineEntry> _groupEntries = new ObservableList<TimelineEntry>();
  private readonly ObservableCollectionHandler<TimelineEntry> _groupEntriesHandler;

  public TimelineEntryViewModel( TimelineViewModel timelineViewModel )
  {
    Tvm = timelineViewModel;
    _groupEntriesHandler = new ObservableCollectionHandler<TimelineEntry>(_groupEntries, OnAdded, OnRemoved);
    GroupEntries = _groupEntries.CreateView();
    GroupEntries.SortDescriptions.Add( new SortDescription( "TimeOccured", ListSortDirection.Ascending) );
  }

  private void OnAdded( TimelineEntry tle )
  {
    GroupEntries.Refresh();
  }

  private void OnRemoved( TimelineEntry tle )
  {
    GroupEntries.Refresh();
  }

  public void AddEntry( TimelineEntry tle )
  {
    _groupEntries.Add( tle );
  }

  public void Dispose()
  {
    _groupEntriesHandler.Dispose();
  }

  public TimelineViewModel Tvm {get; private set;}
  public DateTime GroupingTime {get; set;}
  public ICollectionView GroupEntries {get; private set;}
} 
```

**TimelineViewModel** - 控制条目/缩放处理的部分。我使用 eventAggregator 响应包含进入这些条目的信息的特定消息，并通过创建调用 AddEntry 函数以将其放置在视图中的适当位置的条目来响应。

```
internal sealed class TimelineViewModel : ViewModel, IDisposable
{
  private readonly ObservableList<TimelineEntryViewModel> _timelineEntries = new ObservableList<TimelineEntryViewModel>();
  private readonly ObservableHandler _timelineEntriesHandler;

  public TimelineViewModel ( )
  {
    // Omitting unnecessary code here
    _timelineEntriesHandler = new ObservableHandler( _timelineEntries );
    TimelineEntries = _timelineEntries.CreateView();
    TimelineEntries.SortDescription.Add( new SortDescription( "GroupingTime", ListSortDirection.Ascending ) );
    TimelineEntries.Refresh();
  }

  private void AddEntry( TimelineEntry tle )
  {
    var timeForNoOverlap = Projection.UnprojectDuration( 90 ); //This just gets the number of pixels needed for no overlap between panel groups.
    if( _timelineEntries.Count == 0 )
    {
      _timelineEntries.Add( new TimelineEntryViewModel( this ) );
      _timelineEntries[0].GroupingTime = tle.TimeOccured;
      _timelineEntries[0].AddEntry( tle );
    }
    else if ( tle.TimeOccured > _timelineEntries.Last().GroupingTime + timeForNoOverlap )
    {
      _timelineEntries.Add( new TimeLineViewModel( this );
      _timelineEntries.Last().GroupingTime = tle.TimeOccured;
      _timelineEntries.Last().AddEntry( tle );
    }
    else
    {
      foreach( TimelineEntryViewModel tevm in _timelineEntries )
      {
        if( tle.TimeOccured >= tevm.GroupingTime && tle.TimeOccured <= tevm.GroupingTime + timeForNoOverlap)
        {
          tevm.AddEntry( tle );
          break;
        }
      }
    }
    TimelineEntries.Refresh();
  }

  private void OnZoomChanged()
  {
    var tempEntries = new ObservableList<TimelineEntryViewModel>( _timelineEntries );

    foreach( var group in _timelineEntries )
      group.Dispose();
    _timelineEntries.Clear();

    foreach( var group in tempEntries )
    {
      foreach( var item in group.GroupEntries )
        AddEntry( (TimelineEntry)item );
    }

    foreach( var group in tempEntries )
      group.Dispose();
    tempEntries.Clear();
  }
} 
```

# java - 在java中重绘文本

> ID：13088323
> 
> 赞同：0
> 
> 时间：2012-10-26T13:57:38.197
> 
> 标签：java, text

我的代码中有一个“textlabel”，它`HStaticText`通过 init 函数激活并绘制带有文本的标签 ( )。

但是，我想在按下按钮时更改文本（字符串）。我知道如何制作一个按下按钮的功能，但我怎样才能在我的场景中重绘这个标签？scene.add(tekstlabel2) 不起作用：

```
 tekstLabel2 = new HStaticText("U heeft nog niets bestelt");
      tekstLabel2.setLocation(350,130);
      tekstLabel2.setSize(300,50);
      tekstLabel2.setBackground(new DVBColor(0,0,0,250));
      tekstLabel2.setBackgroundMode(HVisible.BACKGROUND_FILL); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:45:17.563

由于您使用的是`HStaticText`, which extends `HVisible`，您可以`.setTextContent()`在现有标签上使用（不要创建新标签）：

```
 tekstLabel.setTextContent("New Text Goes Here"); 
```

或者，您可以回退到使用`JLabel`：

```
 tekstLabel.setText("New Text Goes Here"); 
```

参考：

**HStaticText**：[http ://www.jarvana.com/jarvana/view/com/googlecode/jinahya/ocap-api/1.2/ocap-api-1.2-javadoc.jar!/org/havi/ui/HStaticText.html](http://www.jarvana.com/jarvana/view/com/googlecode/jinahya/ocap-api/1.2/ocap-api-1.2-javadoc.jar!/org/havi/ui/HStaticText.html)

**HVisible.setTextContent**：[http ://www.jarvana.com/jarvana/view/com/googlecode/jinahya/ocap-api/1.2/ocap-api-1.2-javadoc.jar!/org/havi/ui/HVisible.html #setTextContent(java.lang.String](http://www.jarvana.com/jarvana/view/com/googlecode/jinahya/ocap-api/1.2/ocap-api-1.2-javadoc.jar!/org/havi/ui/HVisible.html#setTextContent(java.lang.String) , int)

# php - 需要一个使用 mysqli 创建数据库连接 php 的类

> ID：13088328
> 
> 赞同：0
> 
> 时间：2012-10-26T13:57:57.220
> 
> 标签：php, mysql, mysqli

我需要创建一个用于连接数据库的类。我知道硬编码数据库信息很糟糕，例如：

```
$user = "xxx";
$password = "yyy";
$server = "zzz";
$dbname = "name";

mysql_connect($user,$password,$server);
mysql_select_db($dbname); 
```

这就是为什么我使用“包含”，例如：

```
include "config.php" 
```

其中包含所有需要的变量，然后我可以将 mysql_connect 与它们一起使用。但据我所知，这也是一种不好的做法。我怎样才能使用 mysqli 类（扩展它？）最简单的方法，当然也是最安全的？

感谢任何提示

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:02:08.280

At the end you have to put your connections configuration parameters inside your code. Doesn't matter if it is in a constant, a class, etc....

I don't think hardcoding those values a security risk. Your php scripts ar in the server. So they are protected by the file system permissions and the system permissions as well. If somebody can access your files the security is issue is in the server and not in the php script.

Use PDO, it has classes to handle db access.

From the [PDO php manual](http://php.net/manual/en/book.pdo.php):

> The PHP Data Objects (PDO) extension defines a lightweight, consistent interface for accessing databases in PHP.
> 
> Connections are established by creating instances of the PDO base class.
> 
> Example #1 Connecting to MySQL
> 
> ```
>  <?php
>  $dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass);
>  ?> 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:02:16.660

I can't really answer your question right now, but as a tip, watch this video.

It's a PHP Security series that may help you there:

[https://www.youtube.com/watch?v=Nx-g-0ynP_I](https://www.youtube.com/watch?v=Nx-g-0ynP_I)

If it doesn't work search for PHP Security part 1 on youtube!

Hope it helps!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T14:59:32.370

硬编码数据库常量没有什么非常不安全的（正如其他人所说，它们必须在某个地方......）尽管就像你注意到的那样，将这些值放在单独的文件中是个好主意。我建议更进一步，不要在源代码管理中跟踪此文件，而是创建一个模板，例如`config.base.php`复制到`config.php`每个服务器并配置该模板。还有其他选项（在我工作的地方，我们跟踪这些文件，但命名它们`$(hostname).php`允许一些巧妙的导入链接，但不是必需的）但这是一个简单、安全的选项，其优点是可以将这些值排除在外你的版本控制。这允许在不提供这些密码的情况下分发代码。

您需要关注的更大的安全问题是锁定您的前置 MySQL 用户，使其仅拥有您的 webapp 所需的权限。例如，一般来说，让您的网站`CREATE`ing 或`ALTER`ing 表是一个坏主意，因此最好不要将这些权限授予您的网站使用的用户，并拥有一个您直接使用的不同的、更高权限的用户使架构更改脱机。

对于您的问题，我在`common.php`课堂上执行以下操作来创建我的 MySQLi 连接：

```
require_once($_SERVER['DOCUMENT_ROOT'].'/includes/config.php');
$db = @new mysqli(MYSQL_HOST,MYSQL_USER,MYSQL_PASS,MYSQL_DB);
if(mysqli_connect_errno())
{
    if(DEBUG_MODE)
        $template->error('Failed To Connect To Database: '.mysqli_connect_errno().': '.mysqli_connect_error());
    else
        $template->error('Failed To Connect To Database.  Try reloading the page.  If this error persists, <a href="/contact.php">let me know</a>.');
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T20:01:45.620

我猜所有建议的答案都可能是正确的，但出于我的目的和情况，我创建了一个文件，其中包括 mysqli 对象创建和与数据库的连接以及一些用于转义数据的功能。我只是将文件包含在需要数据库连接的所有其他 .php 文件中，而且它非常易于使用和执行查询。如果有人需要更多信息或示例，请告诉我。

谢谢大家

# haskell - 如何让 netwire 网络在一组离散的瞬间上模拟执行？

> ID：13088329
> 
> 赞同：3
> 
> 时间：2012-10-26T13:58:02.243
> 
> 标签：haskell, frp

我一直在研究使用 netwire，但看不到如何通过一系列不依赖于实际时间的电线来泵送瞬间。也就是说，有什么方法可以获取 type 的线和 type`Wire e m a b`的变量`[(Time, a)]`，然后取回 type 的东西`[b]`吗？示例中的所有内容似乎都旨在让实时时钟生成瞬间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T16:11:03.223

看看`Control.Wire.Session`模块。在那里，您将找到构建您自己的时钟的实用程序。特别是，您需要查看`Session`数据类型和`genSession`辅助函数。这是关于时钟的。第二个问题是输入：在某一时刻传递什么输入由主循环的作者决定。

事实上，如果你只有一个时间列表和输入，我建议计算时间增量，然后`stepWire`直接使用（而不是`stepSession`），绕过整个会话机制。唯一的限制是时间总是类型`Double`。例子：

```
loop :: [(Time, a)] -> Time -> Wire e m a b -> m [Either e b]
loop [] _ _ = return []
loop ((t, x):ins) t' w' = do
    (mx, w) <- stepWire w' (t - t') x
    fmap (mx:) (loop ins t w) 
```

未经测试的代码，但应该可以工作。第二个参数是开始时间。

# android - 自定义 Android 下载服务 - 为每个文件提供进度通知行

> ID：13088330
> 
> 赞同：7
> 
> 时间：2012-10-26T13:58:06.077
> 
> 标签：android, service, notifications, android-service, android-notifications

我希望能够在通知栏中显示文件的多个下载，这也可以取消。

我已经实现了一个自定义服务，它使用 AsyncTasks 并行执行多个下载。OnPublishProgress 我正在尝试更新通知栏中的各个行以显示每个文件的下载进度。两天来，我一直在尝试解决行闪烁、交换顺序以及有时只是空白或仅更新一行的问题。此外，点击该行取消例程并不总是有效。

这是我的代码：

```
 protected void showProgressNotification(final File item, int progress, boolean isDownloading) {
    String message = null;
    int smallIcon = 0;
    Bitmap largeIcon = null;
    int flags = 0;
    flags |= Notification.FLAG_ONGOING_EVENT; 
    //flags |= Notification.FLAG_FOREGROUND_SERVICE;
    //flags |= Notification.FLAG_ONLY_ALERT_ONCE;
    //flags |= Notification.FLAG_AUTO_CANCEL; 

    NotificationCompat.Builder builder =
            new NotificationCompat.Builder(getApplicationContext());
    builder.setAutoCancel(true);

    if (progress == 100) {
        largeIcon = BitmapFactory.decodeResource(getResources(),
                O2FolderListAdapter.getIconForItem(item, false));
        smallIcon = R.drawable.ic_cloud_upto_date;

        if (isDownloading) {
            message = "Download completed. Tap to clear.";
        } else {
            message = "Upload completed. Tap to clear.";
        }
    } else if (progress >= 0) {
        largeIcon = BitmapFactory.decodeResource(getResources(),
                O2FolderListAdapter.getIconForItem(item, true));
        if (isDownloading) {
            smallIcon = R.drawable.ic_cloud_downloading;
            message = "Downloading: " + progress + "%. Tap to cancel.";
        } else {
            smallIcon = R.drawable.ic_cloud_uploading;
            message = "Uploading: " + progress + "%. Tap to cancel.";
        }
        builder.setProgress(100, progress, false);
    } else {
        largeIcon = BitmapFactory.decodeResource(getResources(),
                O2FolderListAdapter.getIconForItem(item, true));
        smallIcon = R.drawable.ic_cloud_conflict;
        if (isDownloading)
            message = "Cancelled download. Tap to clear.";
        else
            message = "Cancelled upload. Tap to clear.";
    }

    if (mResultIntent == null) {
        mResultIntent = new Intent(getApplicationContext(), CustomDownloadService.class);
        mResultIntent.addFlags(Notification.FLAG_ONGOING_EVENT);
    }
    mResultIntent.putExtra("cancel", item.getPath().hashCode());
    Log.d("O2AbstractDownloadService", "Setup task id " + item.GetPath().hashCode());
    if (mContentIntent == null)
        mContentIntent = PendingIntent.getService(getApplicationContext(), PI_REQ_CODE, mResultIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    builder.setContentIntent(mContentIntent);

    builder.setLargeIcon(largeIcon);
    builder.setSmallIcon(smallIcon);
    builder.setContentTitle(item.GetName());
    builder.setContentText(message);

    //if (progress != 100)
        //builder.addAction(R.drawable.ic_action_dark_cancel, "Cancel", contentIntent);

    final Notification notification = builder.build();
    notification.flags = flags;
    notification.defaults = Notification.DEFAULT_LIGHTS;

    NotificationManager mNotificationManager =
        (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
    // Id allows you to update the notification later on.
    //mNotificationManager.notify(item.getPath().hashCode(), notification);
    //startForeground(item.getPath().hashCode(), notification);

    // only update notification every 100ms (unless cancel or complete)
    long notificationDelay = 100;
    long now = System.currentTimeMillis();
    if (mFutureCallTime == 0 || now > mFutureCallTime || progress == -1 || progress == 100) {
        startForeground(item.getPath().hashCode(), notification);
            //mNotificationManager.notify(item.GetPath().hashCode(), notification);
    } else
        Log.d("CustomDownloadService", "Called too often to notification");

    mFutureCallTime = now + notificationDelay;
} 
```

所以我试图设置在点击通知时调用服务的操作，传递文件的 id 以取消下载。谁能看到我做错了什么？我所追求的真的可能吗？在 Xoom 平板电脑上，通知闪烁很多，但在 Nexus 7 上则不经常闪烁。所有设备最终都会不断地交换行，这意味着几乎不可能取消您想要的下载。

任何建议将不胜感激。

**更新 1：**我认为这可能导致我的问题之一： [Android Service.startForeground 不尊重通知 ID 唯一性](https://stackoverflow.com/questions/9927938/android-service-startforeground-does-not-respect-notification-id-uniqueness)

**更新 2：**通过调用 builder.setWhen(fixedTime) 修复了换出问题。显然，新的 dateTime 会导致行在每次刷新时重新排序。只需修复 Xoom 上的闪烁和“点击取消”功能即可。

**更新 3：** Xoom 上的闪烁已通过限制刷新调用得到修复。最后的代码防止通知在每 100 毫秒内被更新一次以上。剩下的问题与取消有关。点击取消第一次有效，但不适用于后续文件。我也无法清除行。

**更新 4：**单个取消问题是由 resultIntent 字段处于类级别引起的。每次刷新通知时，当我创建一个新通知时，ID 都会绑定。我还将标志更改为仅 Notification.FLAG_ONLY_ALERT_ONCE 并且仅使用了 .notify() 而不是 startForeground()。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T13:42:31.017

所有问题都已修复。我已在原始帖子中添加了更新。总结： 1) 小心 builder.setWhen(fixedTime)。2）不要每 100 毫秒刷新一次以上 3）设置正确的标志。

# enterprise-library - Enterprise Library 5 如何更改事件日志格式？

> ID：13088331
> 
> 赞同：2
> 
> 时间：2012-10-26T13:58:11.457
> 
> 标签：enterprise-library, event-log, enterprise-library-5

虽然 Ent Lib 5 很容易让日志记录工作；当数据被记录到事件日志时，它的格式是（通过 XML 选项卡看到的）为 <EventData> ABCD </>“。我需要以 <EventData><Data Name=A/>< 的形式获取它数据名称=B/>...."。有谁知道是否有办法使用 Ent Lib 5 日志记录块或类似的东西来做到这一点...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:06:27.397

您可以自定义文本格式化程序以将其编写为 xml。像这样的东西：

```
<add template="&lt;Timestamp&gt;{timestamp}&lt;/Timestamp&gt;" type="Microsoft.Practices.EnterpriseLibrary.Logging.Formatters.TextFormatter, Microsoft.Practices.EnterpriseLibrary.Logging" name="Text Formatter" /> 
```

所以输出是这样的：

```
<EventData><Data><Timestamp>2/13/2013 7:59:32 PM</Timestamp></Data></EventData> 
```

如果要将对象序列化为 xml，可以编写自定义格式化程序并使用它。从 LogFormatter 派生并覆盖 Format 方法。并将您的 LogEntry 序列化为 xml。

# r - 皮尔逊相关性检验

> ID：13088332
> 
> 赞同：0
> 
> 时间：2012-10-26T13:58:14.517
> 
> 标签：r

我有这样的情况：

```
Gene       SAMPLE1   SAMPLE2 
 G1         0.33      0.21  
 G2         0.45      0.324 
 G3         0.765     0.654 
 G4         0.98      0.543 
 G5         0.565     0.13
 G6         0.123     0.943
 G7         0.321     0.572
....       ...       ...... 
```

数据不是真实数据。我需要：计算两侧 Pearson 相关检验的 p 值。

任何人都可以帮助我吗？我在R中很新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:02:04.330

You can use `cor.test` to peform this correlation test. This is part of any standard R distribution. In your case `with(dat, cor.test(Sample1, Sample2))` will perform the test you need.

Googling for `R correlation test` returned the documentation of `cor.test` as the first result.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-31T02:51:57.753

如上所述，您可以使用 cor.test() 函数：

```
 cor.test(data$SAMPLE1, data$SAMPLE2) 
```

如果您是 R 的初学者，这里将详细描述两个变量之间的相关性检验：

[http://www.sthda.com/english/wiki/correlation-test-between-two-variables](http://www.sthda.com/english/wiki/correlation-test-between-two-variables)

您也可以在线进行 pearson 相关性测试，无需任何安装：

[http://www.sthda.com/english/rsthda/correlation.php](http://www.sthda.com/english/rsthda/correlation.php)

# java - Hibernate 错误 IllegalArgumentException：要遍历的节点不能为空

> ID：13088341
> 
> 赞同：1
> 
> 时间：2012-10-26T13:58:44.023
> 
> 标签：java, hibernate, cascading-deletes

我的`DELETE`查询失败。

**这是我的代码：**

```
String q = "SELECT p.id FROM Person p, DomainGroup g WHERE 
   p member of g.coordinators" + " AND g.id = :groupId 
   AND p.id = :personId";

List<Long> test = getEntityManager()
  .createQuery(q).setParameter("groupId", followingId)
  .setParameter("personId", followerId).getResultList();

log.debug("test = " + test);

String deleteGroupCoordinatorQuery = 
  "DELETE FROM Person p, DomainGroup g WHERE p member 
     of g.coordinators" + " AND g.id = :groupId 
        AND p.id = :personId";

List<Long> test = getEntityManager()
      .createQuery(deleteGroupCoordinatorQuery).setParameter
      ("groupId", followingId)
      .setParameter("personId", followerId).executeUpdate(); 
```

**输出：**

```
test = [1,2,3]

2012-10-26 13:44:56,437 ERROR org.company.commons.server.service.ServiceActionController - Error occurred performing transaction. java.lang.IllegalArgumentException: node to traverse cannot be null!
        at org.hibernate.hql.ast.util.NodeTraverser.traverseDepthFirst(NodeTraverser.java:55)
        at org.hibernate.hql.ast.QueryTranslatorImpl.parse(QueryTranslatorImpl.java:280)
        at org.hibernate.hql.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:182)
        at org.hibernate.hql.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:136) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T15:45:37.703

您定义了多个“查询根”（`Person p`和`DomainGroup g`），但一个 DELETE 查询只能有一个这样的根。

你想要这样的东西：

```
delete Person p
where p.id in (
    select c.id
    from DomainGroup g
        join g.coordinators c
    where g.id = :groupId
      and c.id = :personId
) 
```

或者

```
delete Person p
where p.id = :personId
  and p.id in (
    select c.id
    from DomainGroup g
        join g.coordinators c
    where g.id = :groupId
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T16:27:18.213

如果您不使用`on delete cascade`功能，那么您应该在删除之前删除对该对象的所有引用。

# jquery - http://docs.jquery.com/Plugins/Authoring 错了吗？

> ID：13088343
> 
> 赞同：1
> 
> 时间：2012-10-26T13:58:56.487
> 
> 标签：jquery

我正在学习如何创建自己的插件，并强烈关注[http://docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)上的文章。我有一个问题的特定部分与向元素添加事件有关，如[http://docs.jquery.com/Plugins/Authoring#Events](http://docs.jquery.com/Plugins/Authoring#Events)所示。

[http://jsfiddle.net/bhcEk/](http://jsfiddle.net/bhcEk/)包含现场演示。基本相同，除了绑定 click() 事件而不是 resize 事件，并将插件应用于给定类的多个元素，除了一个元素。

单击元素会导致 (3) 警报。从文章中的以下脚本可以看出，该事件是在 each() 循环中添加的，因此这是意料之中的。

编辑。哎呀！虽然比我还差。它将它添加到 windows 元素中，因此单击时所有元素都会触发它。也许只是用 $(this) 返回 $(window)？

在我看来，这篇文章是错误的，应该只添加一次（并在销毁下删除）。然而，写这篇文章的人比我更有经验，我怀疑他们可能是愚蠢的。是文章错了，还是我错了？

```
init : function( options ) {
 return this.each(function(){
  $(window).bind('resize.tooltip', methods.reposition);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:29:17.660

文章看起来不错。在您的小提琴中，所需的行为会有所不同，因此应用它的上下文也必须如此 - 您假设`this`现在更合适是正确的。

听起来你一直盯着屏幕太久了;-)

编辑（回应评论）：

jQuery 中的几乎所有内容都被封装以避免冲突。冒着混淆事情的风险，“绑定”就像一个先进先出堆栈（先进先出数组）。

在文章中的示例中，您将行为应用于彼此不知道（并且不需要）的多个单独元素，它们只是共享一个公共事件 - 当示例中的函数绑定到event 它实际上是在窗口的事件堆栈中添加多个处理程序。

可能过于简化的伪：

```
window.events [ // array [ event, namespace, function ]
  [ 'resize', 'tooltip', function(){ /* specific to element 1 */ }],
  [ 'resize', 'tooltip', function(){ /* specific to element 2 */ }],
  [ 'resize', 'tooltip', function(){ /* specific to element 3 */ }]
] 
```

当 window resize 事件被触发时，它会依次运行堆栈中的每个函数。“工具提示”命名空间不引用特定的事件处理程序，它是一组类似的处理程序的名称，这些处理程序最终彼此独立。

我希望这是有道理的，很难用语言来表达。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:29:40.873

您的插件实例与文章实例之间的区别在于，该元素只有一个`$(window)`和一个`resize()`同时发生的事件。然后，本文将其用作`reposition()`方法何时触发的基础。

在您的实例中，有 3 个`.tooltip`元素。通过返回`.each()`3 个元素并回调`click`绑定到 的函数，`$(window)`它实际上会为每个元素触发事件。

不是绑定到`$(window)`，而是绑定到`$(this)`（仅将事件绑定到当前目标（单击的`.tooltip`）。

[这是](http://jsfiddle.net/scrimothy/T6H84/)我提到的一个更改的原始文件。

# jquery - 用于预览文本区域的 Contenteditable div 在开始时不会触发

> ID：13088346
> 
> 赞同：1
> 
> 时间：2012-10-26T13:59:00.200
> 
> 标签：jquery, textarea, contenteditable

我有一个这样的 div：`<div class='textarea_preview' contenteditable='false'></div>`当我编辑它时，它显示另一个文本区域的渲染预览，这是代码：

```
$('textarea').keyup(function()
{
    var keyed = $(this).val().replace(/\n/g, '<br/>');
    $(this).prevAll('.textarea_preview').html(keyed);
}); 
```

所以现在我想在 DOM 准备好时进行预览，而不仅仅是在我编辑 textarea 时。

有什么诀窍吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:02:32.457

Write it as -

```
$('.textarea_preview').each(function(){
    $(this).html($(this).next('textarea').val());
}); 
```

[**Updated Demo**](http://jsfiddle.net/CvuhF/2/)

# php - 具有不同目标的按钮在表单内具有动作

> ID：13088347
> 
> 赞同：0
> 
> 时间：2012-10-26T13:59:03.047
> 
> 标签：php, javascript, jquery, html, pdo

我有一个关于表格的问题。我创建了一个带有动作的表单，表单内部有两个按钮，一个用于提交表单，一个用于提交但也提交到不同的 php 文件，我该怎么做？这是我的代码：

```
<form action="viewmember.php">
<input type="text" value="Clyde">
<input type="submit" value="View" id="viewbutton">
<input type="submit" value="Delete" id="deleteButton">
 </form> 
```

viewbutton 有效，但我想要发生的是当我单击 deletebutton 时，它会提交到不同的 php 文件，比如说 delete.php 。如果您问为什么我在带有 addmember 操作的表单中包含 deletebutton 是，当我单击 deletebutton 时，我还可以获得值为“Clyde”的文本字段的值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T14:02:42.510

Give it a name:

```
<form action="viewmember.php" method="POST"> 
<input type="text" value="Clyde">
<input type="submit" name="action" value="Add" id="viewbutton">
<input type="submit" name="action" value="Delete" id="deleteButton">
 </form> 
```

Then

```
<?php

$action = $_POST['action'];

if($action == "Add")
{
   // add
}
elseif($action == "Delete")
{
   // delete
}

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:03:39.130

You would need some javascript magic.

```
$(function(){
     var form = $('form').on('submit', function(){
          return false;
    });
    $('input[value="View"]', form).on('click', function(){
          form.attr('action', 'viewmember.php')[0].submit();
    });
    $('input[value="Delete"]', form).on('click', function(){
          form.attr('action', 'deletemember.php')[0].submit();
    });
}); 
```

Above is all untested, but in theory, it should work.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:02:42.430

An HTML form always has one action. If you need to provide different actions from one form use something like a controller dispatcher, which reads the button values and processes accordingly.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T14:04:52.243

您可以做的是拥有一个 php 文件，而不是拥有两个单独的 php 文件。然后在该文件中，您有：

```
<?php if (isset($_POST['View'])) { Do all your view stuff here } ?> 
```

那么你可以做另一个：

```
<?php if (isset($_POST['Delete'])) { Do delete stuff here } ?> 
```

请记住，您需要在表单中添加一个方法，POST 或 GET。在这种情况下，您将需要使用 POST。

我猜这是一种方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-26T10:20:03.853

你可以添加这个。它会工作

```
 <form action="viewMember.php" name='form1"><input type="submit" onclick="form1.action='otherUrl'; return true;" /><input type="submit"/></form> 
```

# ruby - Ruby：是否可以重新定义方法但保持子类不变？

> ID：13088352
> 
> 赞同：3
> 
> 时间：2012-10-26T13:59:16.350
> 
> 标签：ruby

假设您有以下 Ruby 类：

```
class A
  def self.greet
    puts 'hi'
  end
end

class B < A; end;
class C < B; end; 
```

是否有可能以仍然使用原始定义而不修改`greet`的`B`方式重新定义？`C``C`

（我知道“你做错了”是一种可能的反应，但请暂时假设这样做是有充分理由的。）

## 更新

很高兴看到另一个演示 Ruby 可以让您为所欲为。但是，对于任何发现这个问题并想这样做的人，我应该说**我最终意识到我做错了**；C 需要直接继承 A。

继续阅读以接收您的霰弹枪，并注意您的目标。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:05:27.747

您可以执行以下操作：

```
def B.greet
  puts self == B ? 'beeeee' : super
end 
```

这意味着 B 知道您要更改其版本，`greet`但仅适用于其他已故类，`B`而不是其他已故类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:16:39.810

当类是“B”时，做你的事，否则调用super：

```
class B
  def self.greet
    if self == B
      puts "my new self"
    else
      super
    end
  end
end 
```

如果继承不断推动你添加这样的棘手的东西，你可能会玩模块。[这是关于 Ruby 继承与模块](http://ducktypo.blogspot.com/2010/08/why-inheritance-sucks.html)的有趣读物

# ruby-on-rails - 如何使用空格传递参数并在rails的另一个页面中访问相同的值？

> ID：13088357
> 
> 赞同：-1
> 
> 时间：2012-10-26T13:59:22.633
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想通过 url 传递一个值来访问下一页中的相同值。当我传递值时，我可以在我的 url 中看到

> 价值=示例+价值

但是当我在视图中使用以下内容时，它在传递到下一页后只发送值的第一部分。

```
 <%= link_to edit, edit_post_path(post, :value => params[:value]) %> 
```

单击编辑按钮时，它会执行操作，当它转到下一页时，我只能`value=example`在 url 中看到。我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:30:21.820

我认为最好的方法是使用永久链接……要做到这一点，你有一些[宝石](https://www.ruby-toolbox.com/categories/rails_permalinks___slugs)，或者你可以看到[这个](http://railscasts.com/episodes/63-model-name-in-url)railscast 来做到这一点。

# c# - MVVM，使用新的 Windows 或视图？

> ID：13088358
> 
> 赞同：0
> 
> 时间：2012-10-26T13:59:24.073
> 
> 标签：c#, wpf, mvvm, caliburn.micro

在完成了一些手工项目之后，我最近的项目使用 Caliburn.Micro 实现了 MVVM 模式——但我仍然遇到一些架构问题。主要是：

我的ViewModel 包含一个`BindableCollection` `ProfilesCollection`. `Profiles`我的视图有一个添加新配置文件的按钮。但由于配置文件很复杂，我希望单击按钮打开一个新窗口，我可以在其中填写详细信息，然后返回主窗口。

在我之前的手动方法中，我制作了`ProfilesCollection`静态文件，以便在整个应用程序中都可以访问它，并且作为点击事件，我只是打开了一个新窗口，然后我将新的配置文件存储在静态文件中`Collection`。

什么是正确的 MVVM 方法？创建一个新的视图/视图模型而不是一个新窗口？我如何管理它们，以及如何将`Profile`我创建的内容传递回 MainViewModel？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:25:08.780

我首先将a 和`ProfilesCollection`a`ProfilesViewModel`一起传递`ProfilesView`给选择要编辑的配置文件以及添加/删除配置文件。

其次，我会有一个单独的`ProfileViewModel`and `ProfileView`。将`ProfileViewModel`有一个`ShowDialog`调用子窗口`ShowDialog`的方法。`ProfileView`这将允许在然后调用`ProfilesViewModel`上设置配置文件，这将非常适合 MVVM 模式。`ProfileViewModel``ShowDialog`

有关这方面的更多信息，请查看[Wpf 应用程序框架](http://waf.codeplex.com/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T17:47:10.093

您可以简单地打开一个新的对话框/窗口来填写您的详细信息。[在这里](https://stackoverflow.com/questions/3801681/good-or-bad-practise-for-dialogs-in-wpf-with-mvvm)查看我的方法

# batch-file - 限制用户在批处理程序中使用空格键

> ID：13088360
> 
> 赞同：0
> 
> 时间：2012-10-26T13:59:31.133
> 
> 标签：batch-file, set, delimiter

除了我想限制用户输入任何空格键之外，我使用以下内容可以很好地满足我的需求，我该怎么做？

```
SET /P GET_ADMIN_PASSWORD_MISSMATCH_OPTION= Selection: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T16:03:26.183

您不能限制他们批量按空格，但是您可以在他们输入内容后摆脱空格

```
set /p GET_ADMIN_PASSWORD_MISSMATCH_OPTION=Selection: 
set GET_ADMIN_PASSWORD_MISSMATCH_OPTION=%GET_ADMIN_PASSWORD_MISSMATCH_OPTION: =% 
```

我还建议使用较短的变量名！:)

# tomcat - 带有 curl 和自签名证书的 Tomcat 7 管理器文本不起作用

> ID：13088362
> 
> 赞同：0
> 
> 时间：2012-10-26T13:59:36.217
> 
> 标签：tomcat, curl, deployment, tomcat-manager

所以，我在这里遇到了一个有趣的困境。我有一个带有管理器应用程序的 Tomcat 7 服务器设置。

我正在运行的确切命令[在合理范围内]如下：

> curl -k --upload-file ~/[build.directory]/ROOT.war [https://[ManagerLoginName]:[ManagerLoginPwd]@[fqdn-serverName]:8443/manager/text/deploy?war=ROOT.war&path =/&更新=真](https://[ManagerLoginName]:[ManagerLoginPwd]@[fqdn-serverName]:8443/manager/text/deploy?war=ROOT.war&path=/&update=true)

我遇到了失败 - 指定了无效的上下文路径 null

如果我运行`/manager/text/reload?path=/`它会重新加载上下文，就像我运行 undeploy 命令一样，它会正确地取消部署。似乎我无法使用以下方法进行部署：

`deploy?war=ROOT.war&path=/&update=true`

语法是正确的，我有点难过为什么这不会部署。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:42:21.923

这是防火墙上基于权限的问题。

# java - 如何使用 ReentrantReadWriteLock 等待数据？

> ID：13088363
> 
> 赞同：6
> 
> 时间：2012-10-26T13:59:35.927
> 
> 标签：java, concurrency, java.util.concurrent, reentrantreadwritelock

据说，这`ReentrantReadWriteLock`是为一位作家和多位读者准备的。

然而，读者应该等到缓冲区中存在一些数据。

那么，要锁定什么？

我创建了如下并发对象：

```
private final ReentrantReadWriteLock rwl = new ReentrantReadWriteLock();
protected final Lock readLock = rwl.readLock();
protected final Lock writeLock = rwl.writeLock();
protected final Condition hasData = writeLock.newCondition(); 
```

现在在写方法我做：

```
writeLock.lock();

// writing first portion and updating variables

hasData.signalAll();

// if required then writing second portion and updating variables

hasData.signalAll(); 
```

但是如何写一个读者呢？它应该只获取`readLock`吗？但它怎么能等待信号呢？如果它还需要一个`writeLock`，那么读/写锁定的至高无上的地位在哪里？

如果它们仅受保护，如何确保所需的变量在读取期间不会改变`writeLock`？

**队列与任务不匹配**

这是关于`ReentrantReadWriteLock`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T15:01:08.327

ReentrantReadWriteLock 确实有点令人困惑，因为 readLock 没有条件。您必须在阅读器中升级到 writeLock 才能等待条件。

在作家。

```
writeLock.lock(); //locks all readers and writers
// do write data
hasData.signalAll();
writeLock.unlock(); 
```

在阅读器中，您可以：

```
readLock.lock(); //blocks writers only
try{
 if(!checkData()) //check if there's data, don't modify shared variables
 {
  readLock.unlock();
  writeLock.lock(); // need to lock the writeLock to allow to use the condition.
                    // only one reader will get the lock, other readers will wait here      
  try{
   while(!checkData()) // check if there' still no data
   {
     hasData.await(); //will unlock and re-lock after writer has signalled and unlocked.
   }
   readLock.lock();    // continue blocking writer
  }
  finally
  {
    writeLock.unlock(); //let other readers in
  }
 }
 //there should be data now
 readData(); // don't modify variables shared by readers.
}
finally
{
  readlock.unlock(); //let writers in
} 
```

为了完整起见，当然，每个 unlock() 都应该在 finally 块中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T14:10:53.260

> 但是如何写一个读者呢？它应该只获取 readLock 吗？但它怎么能等待信号呢？如果它还需要一个 writeLock，那么读/写锁定的至高无上的地位在哪里？

我会改用一个[`BlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)可以为你处理所有这些的。您的读者可以调用`queue.take()`哪些块等待队列中有元素。

你的作家有点复杂。我要做的是如下所示：

```
// initially try to put an element into the queue
if (!queue.offer(element)) {
   // if the queue is full then take an element off the head and just drop it
   // this won't block and may not remove anything due to race conditions
   queue.poll();
   // this put will never block because now there will be space in the queue
   queue.put(element);
} 
```

如果有多个作家，这将不起作用。那你需要一把`synchronized`锁。如果您正在处理固定大小的队列，那么[`ArrayBlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ArrayBlockingQueue.html)应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:19:31.577

您需要的是**提供两个独立的锁**和.[`LinkedBlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/LinkedBlockingQueue.html) **`takeLock``putLock`**

 **`Offer`,`put`队列的方法总是使用`putLock`where as`take`方法总是使用`takeLock`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T14:08:37.033

您无法使用具有阻塞行为的原语来实现非阻塞行为。如果你真的希望作者“写而不等任何人”，他甚至不应该知道你提到的锁存在。

当你执行

```
 rwl.writeLock().lock(); 
```

如果有读者在操作，作者将等待。

如果您想尊重“从不等待”条件，您应该尝试使用无等待（至少无锁）原语。例如，使用[ConcurrentLinkedQueue](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)和锁定机制，该机制仅用于管理读取器之间的竞争条件。**

# c# - Linq to Datatable 和 Linq to XML

> ID：13088364
> 
> 赞同：2
> 
> 时间：2012-10-26T13:59:38.780
> 
> 标签：c#, xml, linq, c#-4.0, datatable

> **可能重复：**
> [从 DataTable 创建 XML](https://stackoverflow.com/questions/13072927/create-an-xml-from-a-datatable)

如何使用 LINQ 从 DataTable 创建 XML。我对 LINQ 没有足够的经验。

我可以遵循的任何好的教程。

使用 LINQ 将以下数据表转换为 xml。忽略行中的错误作为其测试数据。我之前在stackoverflow上问过这个问题。得到了一种很好的迭代数据行和列的解决方案。但如果我使用 LINQ 来做会更好。

![数据表](../Images/ce7e890346b0207db4b89b99971e95b4.png)

![XML](../Images/b341f7bd48d9cd50f526b1ff767dfcaf.png)

# header-files - Automake: How to use a header from one library in a another library in a sister directory

> ID：13088365
> 
> 赞同：0
> 
> 时间：2012-10-26T13:59:37.773
> 
> 标签：header-files, automake

My directory set up:

```
libone
  one.c
  one.h
  Makefile.am

libtwo
  two.c #includes one.h
  two.h
  Makefile.am

...
Makefile.am
configure.ac
... 
```

Now when I do autoreconf -fvi and configure and make, I get the error from two.c: could not find one.h. How do I setup the include paths in Makefile.am's? Any help appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T19:43:38.267

要么做它快速'n'dirty的方式

```
#include "../libone/one.h" 
```

或（首选，因为无论`one.h`是安装还是在源代码树中还是拆分到不同的项目中都没有关系）

```
#include <libone/one.h> 
```

在你的`Makefile.am`

```
libtwo_a_SOURCES = two.c two.h
libtwo_a_CPPFLAGS = -I$(top_srcdir) 
```

# linux - 如何从 Bash 中对包含公共前缀和后缀的字符串进行数字排序？

> ID：13088370
> 
> 赞同：36
> 
> 时间：2012-10-26T13:59:48.777
> 
> 标签：linux, bash, unix, sorting

以下是文件列表：

```
some.string_100_with_numbers.in-it.txt
some.string_101_with_numbers.in-it.txt
some.string_102_with_numbers.in-it.txt
some.string_23_with_numbers.in-it.txt
some.string_24_with_numbers.in-it.txt
some.string_25_with_numbers.in-it.txt 
```

现在我想对它进行数字排序。以 *23* 开头，以 *102* 结尾。

我试过`-n`和`-g`. `-t`对这些凌乱的字符串没有帮助。

我可以通过选项忽略数字的前导字符串还是必须聪明和脚本？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-26T14:06:13.710

利用`ls -lv`

从手册页：

```
-v     natural sort of (version) numbers within text 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-10-26T14:06:34.063

尝试以下操作：

```
sort -t '_' -k 2n 
```

*   `-t '_'`（将分隔符设置为下划线字符）
*   `-k 2n`（使用数字排序按第二列排序）

**[演示](http://ideone.com/yS33h3)**。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-02-19T15:14:37.810

如果可用，只需使用`sort -V`. 这是对版本号的排序，但作为“自然排序”选项效果很好。

```
$ ff=$( echo some.string_{100,101,102,23,24,25}_with_numbers.in-it.txt ) 
```

无排序：

```
$ for f in $ff ; do echo $f ; done
some.string_100_with_numbers.in-it.txt
some.string_101_with_numbers.in-it.txt
some.string_102_with_numbers.in-it.txt
some.string_23_with_numbers.in-it.txt
some.string_24_with_numbers.in-it.txt
some.string_25_with_numbers.in-it.txt 
```

使用排序-V：

```
$ for f in $ff ; do echo $f ; done | sort -V
some.string_23_with_numbers.in-it.txt
some.string_24_with_numbers.in-it.txt
some.string_25_with_numbers.in-it.txt
some.string_100_with_numbers.in-it.txt
some.string_101_with_numbers.in-it.txt
some.string_102_with_numbers.in-it.txt 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-15T08:04:43.640

在一般情况下，请尝试[Schwartzian 变换](https://en.wikipedia.org/wiki/Schwartzian_transform)。

简而言之，将数字分解为自己的字段，对其进行排序，然后丢弃添加的字段。

```
# In many shells, use ctrl-v tab to insert a literal tab after the first \2
sed 's/^\([^0-9]*\)\([0-9][0-9]*\)/\2   \1\2/' file |
sort -n |
cut -f2- 
```

如果输入没有明显的分隔符，这很好用，例如以下输入。

```
abc1
abc10
abc2 
```

您希望排序将最后一行移到第一行之后。

# c# - 双击 ListView 时调整大小无法正常工作

> ID：13088373
> 
> 赞同：1
> 
> 时间：2012-10-26T14:00:00.613
> 
> 标签：c#, forms, listview

我有自己的 ListView 类，继承自 Forms.ListView。双击列之间的线时，列会调整大小以全尺寸显示列项。

但是，对我来说，这不能正常工作-有些词被部分隐藏了。

我的理论是，这是由于项目具有不同的字体，并且 ListView 并没有查看所有项目，导致一些较大的字体项目仍然被部分隐藏。

任何人都可以解决这个问题（在列之间双击时我似乎找不到任何事件）？我的理论可信吗？

最好的祝福

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:35:34.707

我认为您可以尝试使用此代码，我现在编写了它，经过测试并且对我有用。请注意，在我的计算机上，`ColumnwidthChanging`事件在每个像素更改时触发（当您使用鼠标调整列大小时），双击它会更改两个以上像素。我正在传递为列表设置的字体。您应该使用特定 ListViewItem 的字体来执行此操作。试试看，如果它对你有用，那就是它。

```
 private void listView1_ColumnWidthChanging(object sender, ColumnWidthChangingEventArgs e)
        {
            ListView lv = (ListView)sender;
            int widthDifference = Math.Abs(lv.Columns[ e.ColumnIndex].Width - e.NewWidth);
            if( widthDifference>2)
            {
                int maxWidth = 0;
                Graphics g = lv.CreateGraphics();
                for(int i = 0;i<lv.Items.Count;i++) 
                {
                    string text = string.Empty;
                    if (e.ColumnIndex == 0)
                    {
                        text = lv.Items[i].Text;
                    }
                    else
                    {
                        text = lv.Items[i].SubItems[e.ColumnIndex - 1].Text;
                    }
                    SizeF sizeF = g.MeasureString(text, lv.Font);
                    if (maxWidth < (int)(sizeF.Width + 0.5))
                        maxWidth = (int)(sizeF.Width + 0.5);
                }
                g.Dispose();
                e.NewWidth = maxWidth;
            }
        } 
```

编辑：这些是我`ListView`在 Form1.Designer.cs 中的设置，我认为这可以帮助你：

```
 this.listView1.FullRowSelect = true;
 this.listView1.GridLines = true;
 this.listView1.Location = new System.Drawing.Point(253, 160);
 this.listView1.Name = "listView1";
 this.listView1.Size = new System.Drawing.Size(428, 97);
 this.listView1.TabIndex = 9;
 this.listView1.UseCompatibleStateImageBehavior = false;
 this.listView1.View = System.Windows.Forms.View.Details;
 this.listView1.ColumnWidthChanging += new System.Windows.Forms.ColumnWidthChangingEventHandler(this.listView1_ColumnWidthChanging); 
```

# ios - 在iphone中单击按钮时将图像保存在相册中

> ID：13088377
> 
> 赞同：1
> 
> 时间：2012-10-26T14:00:20.647
> 
> 标签：ios, iphone, xcode, photolibrary, save-image

在我的应用程序中有一个 galary。我不知道在 UIImageWriteToSavedPhotosAlbum 方法的图像（UIImage *image）部分中放入什么，我想将图像保存在 iphone 相册中。我正在使用此代码

```
- (void)savePhoto
{
    UIImageWriteToSavedPhotosAlbum(((IndicatorImageView *)[self._imageViews objectAtIndex:_selectedImage])._imageView.image, nil, nil, nil);

} 
```

但它显示了这个错误......

> 2012-10-26 18:48:00.596 PhotoGallery[2683:15203] -[GalleryItemView _imageView]：无法识别的选择器发送到实例 0x8e7cc90 2012-10-26 18:48:00.665 PhotoGallery[2683:15203] *** 由于未捕获而终止应用程序异常“NSInvalidArgumentException”，原因：“-[GalleryItemView _imageView]：无法识别的选择器发送到实例 0x8e7cc90”***第一次抛出调用堆栈：

如果您知道这一点，请帮助我...在此先感谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:13:30.297

```
UIImageWriteToSavedPhotosAlbum(YOUR_IMAGE(UIImage), self, @selector(finishUIImageWriteToSavedPhotosAlbum:didFinishSavingWithError:contextInfo:), nil); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T03:09:28.557

这是您需要的代码。您需要选择 imageview.image .....不是实际的图像变量。

```
- (IBAction)saveImageButton:(id)sender {
UIImageWriteToSavedPhotosAlbum(_processedImageView.image, nil, nil, nil);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-19T03:37:53.380

```
- (void)savePhoto
{
    UIImageWriteToSavedPhotosAlbum(((IndicatorImageView *)[self.imageViews objectAtIndex:_selectedImage]).image, nil, nil, nil);
} 
```

如果您的数组`self._imageViews`包含 imageViews ，为什么您尝试`_imageView`再次访问？

还有，是`_imageViews`属性吗？使用`self.imageViews`更好。

# jquery-ui - 具有多种语言的 Jqueryui 对话框

> ID：13088379
> 
> 赞同：2
> 
> 时间：2012-10-26T14:00:28.320
> 
> 标签：jquery-ui, jquery-ui-dialog, multilingual

例如，我使用带有此代码的 jqueryui，对话框插件。

```
$( "#showUser-form" ).dialog(
                    {
                        buttons: {
                            "OK": function()
                            {
                                    $( this ).dialog( "close" );
                            },
                            cancel: function()
                            {
                                $( this ).dialog( "close" );
                            }
                        },
                        close: function() {}
                    }); 
```

例如，如何更改多语言网站的“取消”按钮的文本？

问候

雨果

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:47:02.437

您必须创建一个新对象来包含按钮并将其传递给`buttons`参数。然后您可以动态设置按钮的文本。

[jsFiddle在这里](http://jsfiddle.net/4zHuW/)

像这样：

```
//You can dynamically change button text here
var buttons = [,];
buttons['OK'] = 'OK :)';
buttons['Cancel'] = 'Cancel :(';

var buttonArray = {};
buttonArray[buttons['OK']] = function() {
    //Set OK function here
    $(this).dialog('close');
};
buttonArray[buttons['Cancel']] = function() {
    //Set Cancel function here
    $(this).dialog('close');
};

$(function () {
    $('#dialog').dialog({
        buttons: buttonArray
    });
}); 
```

# c++ - 通过类指向字符串的 C++ 指针

> ID：13088386
> 
> 赞同：0
> 
> 时间：2012-10-26T14:00:58.370
> 
> 标签：c++, string, pointers

我有一个类，在那里我有一个包含字符串的结构。在 main 中，我声明了该类，然后创建一个结构来访问该字符串。它的样子：

```
Class *myClass = new Class;
Class::Struct *myStruct;

myStruct = &myClass->getStruct(); // the struct is in a vector so I get it through a function

cout << myStruct->string << "\n"; 
```

因此，使用这种方法我无法访问结构中的字符串，但我可以访问 int、float 等。如果我将代码更改为：

```
Class::Struct myStruct;

myStruct = myClass->getStruct();

cout << myStruct.string << "\n"; 
```

然后它工作。

我的问题是，为什么第二个有效，而第一个无效，为什么只有字符串？这与生死无关，因为我真的不需要那个字符串，我只是测试了程序，但我真的很好奇发生了什么，因为我还在学习语言，尤其是指针。

提前致谢！

编辑：好的，所以定义

```
class Class {
public:
    struct Struct {
        string name;
        float data;
    };

    Class();
    Struct getStruct( int i );

private:
    vector<Struct>  tempStruct;
};

Class::Class() {
    Struct str;
    str.name = "test";
    str.data = 1.0f;

    tempStruct.push_back( str );
}

struct Class::getStruct( int i ) {
    return tempStruct[i];
} 
```

**EDIT2：** 这是一个小错误，但我忘记了 &。但是你帮我找到了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:06:12.803

这是因为`getStruct()`返回结构的副本。这被称为“临时”。临时工立即死亡。所以现在你有一个指向死临时的指针。它不再存在，因此指向它的指针无效。要么返回一个指针或对 in 结构`getStruct()`的引用，要么持有对其返回值的引用，如下所示：

```
const Class::Struct& myStruct = myClass->getStruct(); 
```

# php - Cake PHP 控制器/模型问题

> ID：13088388
> 
> 赞同：2
> 
> 时间：2012-10-26T14:01:03.880
> 
> 标签：php, cakephp, model

我已经开始在 CakePhP 中开发一个应用程序。我以前没用过，除了教程。因此，为了明智和“白痴检查”，我已经完成了一些框架代码，到目前为止，它已经很好地复制/粘贴到代码中。然而：我遇到了一个障碍。

我遵循 cakePHP 为标准继承规定的命名约定。似乎是正确的实现看起来像是在使用默认值。任何人都可以看到一个陷阱，或者有什么建议吗？

控制器 -> app/controller/VenuesController.php

查看 -> 应用程序/查看/场地/view.ctp

模型 -> 应用/模型/Venue.php

控制器和视图似乎连接得很好，我可以按照您的期望操作变量/数组。

出于测试目的，我通过在模型中声明这一点进行测试：

```
public static function VenueModelTest() {
 return true;
} 
```

我正试图在控制器中运行它：

```
Venue::VenueModelTest(); 
```

我得到的错误如下：

错误：找不到类 'Venue'
文件：C:[...]\app\Controller\VenuesController.php
行：43

我尝试过调试：例如 - 我在控制器内部做了一个 var_dump($this->Model) （传递给视图），它只是打印 NULL。这让我觉得路由存在某种形式的问题。

但谁能明白为什么？

提前喝彩。瑞克

*编辑：我可以确认模型没有加载。如果我包括：

```
$this->loadModel('Venue'); 
```

...在控制器的正确位置，它可以工作。

显然这并不理想......任何人都可以窥探为什么它不起作用？干杯瑞克

根据要求，这是完整的主控制器：

```
<?php

// Venue model
// /app/Model/Venue.php

class Venue extends AppModel // implements ModelInterface
{

    public static function VenueModelTest() {
     return true;
    }

}

?> 
```

*编辑 - 由于金发复制粘贴问题添加了静态。重申这是一个 STATIC 对象（所以应该可以从任何地方访问 - 我认为！）并且调用是：

```
$venue = Venue::VenueModelTest(); 
```

错误如上所述。此外 - 如果您手动强制模型的负载 - 它可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:27:13.727

请发布您的模型文件。

确保它使用后缀 .php 而不是 .ctp 并且您没有声明 $this->name = 'xxxx';

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T15:34:14.490

该模型正在自动加载（您的命名约定是正确的），只是您访问它不正确：

在控制器中，您可以像这样访问模型方法：

```
$this->Model->action(); 
```

因此，在您的情况下，您将使用：

```
$this->Venue->VenueModelTest(); 
```

# c# - 在 Mono For Android 中，在 OpenRawResourceFd 中指定 mp3 文件时，播放错误的文件

> ID：13088391
> 
> 赞同：1
> 
> 时间：2012-10-26T14:01:22.727
> 
> 标签：c#, android, mono, media-player

我对 Mono for Android (4.2.5) 有一个严重的问题。我的 RAW 文件夹中有几个 mp3 文件，全部设置为 AndroidResource。

这是我的代码：

```
idPlayer.SetDataSource(this.Resources.OpenRawResourceFd(Resource.Raw.m1991).FileDescriptor);
idPlayer.SetOnCompletionListener(this);
idPlayer.Prepare();
idPlayer.Start(); 
```

无论设置了哪个文件（在本例中为 m1991），当我在 Galaxy Note 上部署和运行时，它总是会播放其中一个 mp3，并且只播放这个。只有当我从文件夹中删除所有其他 mp3 文件但我想播放的文件时，它才会同意播放我想要的文件。

这是一个已知的问题？我做错了吗？我尝试调试并设置断点以查看 Resource.Raw.m1991 是什么以及它与其他原始文件不同的数字。

任何帮助都将不胜感激！

干杯家伙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-12T16:13:56.853

看到这篇文章： http: [//mbcdev.com/2012/04/03/psa-assetfiledescriptor-and-filedescriptor-android-raw-resources/](http://mbcdev.com/2012/04/03/psa-assetfiledescriptor-and-filedescriptor-android-raw-resources/)

“似乎正在发生的事情是 AssetFileDescriptor 确实描述了实际文件，但您从中获得的 FileDescriptor 描述了包含您的特定文件的整个 blob。”

# ruby-on-rails - Rails：pjax 错误“未捕获的类型错误：对象 [object Object] 没有方法 'pjax'”

> ID：13088392
> 
> 赞同：0
> 
> 时间：2012-10-26T14:01:27.387
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, pjax

宝石文件：

> 宝石'pjax_rails'

应用程序/assets/javascripts/application.js ：

```
//= require jquery 
//= require jquery_ujs 
//= require_tree . 
//= require jquery.pjax

$(function() {
 $('a').pjax('[data-pjax-container]');
}); 
```

应用程序/视图/布局/application.html.erb：

```
<div id="data-pjax-container" data-pjax-container>
        <%= yield %>
</div> 
```

我在 chrome 中遇到的错误是：

> 未捕获的类型错误：对象 [对象对象] 没有方法“pjax”

它指的是 application.js 文件。这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T16:04:16.717

我认为您可以将导入更改为：

```
//= require jquery 
//= require jquery_ujs 
//= require jquery.pjax
//= require_tree . 
```

我也相信你应该将它绑定到你的 ready 事件中，如下所示：

```
$(document).ready(function() {
 $('a').pjax('[data-pjax-container]');
}); 
```

希望能帮助到你

# android - 媒体按钮接收器android

> ID：13088393
> 
> 赞同：0
> 
> 时间：2012-10-26T14:01:30.423
> 
> 标签：android, broadcastreceiver, android-mediaplayer

我对以下用于获取媒体按钮操作的代码有疑问。

类 MediaButtonIntentReceiver：

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.util.Log;
import android.view.KeyEvent;

public class MediaButtonIntentReceiver extends BroadcastReceiver {

public MediaButtonIntentReceiver() {
    super();
}

@Override
public void onReceive(Context context, Intent intent) {
    String intentAction = intent.getAction();
    if (Intent.ACTION_MEDIA_BUTTON.equals(intentAction)) {
        KeyEvent event = (KeyEvent) intent
                .getParcelableExtra(Intent.EXTRA_KEY_EVENT);
        int action = event.getAction();
        if (action == KeyEvent.ACTION_DOWN) {
            Log.i("ok", "media button pressed");
        }

    }

    if (isOrderedBroadcast()) {
        abortBroadcast();
    }
}
} 
```

在我的主要我有这个：

```
MediaButtonIntentReceiver mMediaButtonReceiver = new MediaButtonIntentReceiver();
IntentFilter mediaFilter = new IntentFilter(Intent.ACTION_MEDIA_BUTTON);
mediaFilter.setPriority(IntentFilter.SYSTEM_HIGH_PRIORITY);
registerReceiver(mMediaButtonReceiver, mediaFilter); 
```

这是我清单上的接收者

```
<receiver android:name="ch.bono88.Ederly.MediaButtonIntentReceiver">
     <intent-filter>
          <action android:name="android.intent.action.MEDIA_BUTTON"/>
     </intent-filter>
</receiver> 
```

所以当我尝试执行我的应用程序时，我得到了这个异常

```
java.lang.RuntimeException: Unable to start receiver ch.bono88.Ederly.MediaButtonIntentReceiver: java.lang.NullPointerException
Caused by: java.lang.NullPointerException
at ch.bono88.Ederly.MediaButtonIntentReceiver.onReceive(MediaButtonIntentReceiver.java:26) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-16T01:44:24.027

您需要检查 MediaButtonIntentReceiver 源中的确切第 26 行。我只能间接得出结论，您需要为事件检查 null，因为它可以为 null。

# google-api - 我可以将我的谷歌帐户配置为始终接受来自我的应用程序的请求吗？

> ID：13088394
> 
> 赞同：3
> 
> 时间：2012-10-26T14:01:31.423
> 
> 标签：google-api, google-drive-api

在我的我们的应用程序中，我想为我的用户提供谷歌电子表格，他们可以在其中填写信息，我的应用程序可以从那里解析它。**我想成为电子表格的所有者**，只需将其配置为对拥有链接的任何人（即我的用户）都可编辑。

我不需要访问用户的 Google Drive 信息（他们甚至可以没有！），我只需要访问我团队的 Google Drive 信息，然后为他们提供正确的链接。

是否可以使此帐户（我的团队的）始终接受来自我的应用程序的请求？（为了不每小时刷新访问令牌）

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T17:01:55.237

几点，

1.  刷新访问令牌应该是无缝的，因为您具有“离线”访问权限，并且客户端库应该自动完成。

2.  如果您真的想要无人访问，您可以使用服务帐户，它是与 API 控制台关联的电子邮件地址。[https://developers.google.com/accounts/docs/OAuth2ServiceAccount](https://developers.google.com/accounts/docs/OAuth2ServiceAccount)

# haskell - 存在类型。为异构映射编写类的实例

> ID：13088395
> 
> 赞同：2
> 
> 时间：2012-10-26T14:01:34.807
> 
> 标签：haskell, existential-type

使用以下类型和类定义，我不明白为什么在创建`instance`以下内容时会出现错误。

我需要 MyMap 来保存异构值的映射。

```
{-# LANGUAGE ExistentialQuantification #-}
module Scratch.SO_ExtistentialTypes where

import Data.Map

type MyMap a = Map String a

class MyClass c where 
    getMyMap :: forall a. c -> MyMap a

data MyData = forall a. MyData {
    myMap ::  MyMap a
}

instance MyClass MyData where
    getMyMap = myMap -- <= ERROR 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T14:20:18.067

一方面，`forall`这里是多余的：

```
class MyClass c where 
    getMyMap :: forall a. c -> MyMap a 
```

没有显式绑定的类型变量在最外层被普遍量化，所以这与 just 完全相同`c -> MyMap a`。

除此之外，普遍量化的类型肯定不会匹配存在量化的类型。的类型`getMyMap`表示，给定一个类型的值`c`，它将`MyMap a`为任何可能的类型选择产生一个类型的值`a`。另一方面，访问器`myMap`说，给定一个 type 的值`MyData`，它将`MyMap a`为一些特定但未知的 type生成一个 type 的值`a`。

无法让展开的存在类型自行浮动（这将需要`exists`对应于 的量词`forall`），因此无法重写有效实现`getMyMap`的类型。`myMap`

对于具有存在类型的东西，您所能做的就是将其包装在另一个隐藏存在量词的数据类型中，或者将其提供给具有通用量化类型的参数的函数。例如，您可以在具有存在类型`length`的列表上使用。`[a]``a`

在您的情况下，`Map`存在类型的值没有其他结构或约束，因此它们几乎没有用，也可能是`()`.

# ruby - Why do variations of regular expression lookaround -- lookahead and lookbehind not work for commafication?

> ID：13088397
> 
> 赞同：1
> 
> 时间：2012-10-26T14:01:36.867
> 
> 标签：ruby, regex

The following works in Ruby for commafication (adding `,` to a number, so `12345` becomes `12,345`)

```
def r(s)
  s.gsub(/(?<=\d)(?=(\d\d\d)+\b)/, ",")
end

s = ""
1.upto(20) do |i|
  s += (i % 10).to_s
  puts r(s)
end 
```

But I wonder why the variations `r2` and `r3` won't work?

```
def r2(s)
  s.gsub(/(?<=\d)(?=(\d\d\d)+)\b/, ",")
end

def r3(s)
  s.gsub(/(?<=\d)(?=\d\d\d)+\b/, ",")
end 
```

Nothing is modified at all, and I would think that `1234` does match `(?<=\d)(?=(\d\d\d)+)\b` so it is a bit strange. (I tried it using Perl as well, so it is not peculiar to Ruby).

**Update:** The following is the output for `r`, while for `r2` and `r3`, no `,` is added at all:

```
1
12
123
1,234
12,345
123,456
1,234,567
12,345,678
123,456,789
1,234,567,890
12,345,678,901
123,456,789,012
1,234,567,890,123
12,345,678,901,234
123,456,789,012,345
1,234,567,890,123,456
12,345,678,901,234,567
123,456,789,012,345,678
1,234,567,890,123,456,789
12,345,678,901,234,567,890 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:10:57.697

好吧，在 r2 中，您的前瞻是说接下来的三个字符必须是数字，但是您立即尝试匹配单词边界。它们是相互排斥的。

在 r3 中，您正在重复前瞻一次或多次，但是，作为前瞻，这是无稽之谈。您一遍又一遍地重复“接下来的三个字符必须是数字”，但它们要么会是，要么不会。说不止一次是无稽之谈。而且您仍然有单词边界的问题。

前瞻就像堆栈上的 peek 函数。它不会向前移动指针，因为它不消耗任何东西。它匹配一个位置（将其视为字符之间的空格）。所以你的前瞻匹配三个数字后面的位置。但是接下来的语句 (the `\b`) 匹配左侧字符是单词字符（通常`[a-zA-Z0-9_]`或类似的字符）而右侧字符不是（空格、句点等）的位置，反之亦然。由于先前的向后查找要求该位置之前有数字，而向前查找需要一系列数字，因此在定义的位置处不可能有单词边界。

**例子**

以下正则表达式将始终失败：

```
^(?=\d\d\d)\d\d\b 
```

表示匹配必须从输入的`^`开头开始。前瞻断言接下来的三个字符必须是数字（但不消耗它们）。下面的表达式表示接下来的两个字符必须是数字（并消耗它们，将指针向前移动），然后是非数字（单词边界）。但这违反了要求接下来的三个字符必须是数字的前瞻。因此，匹配失败。

见：[http ://www.regular-expressions.info/lookaround.html](http://www.regular-expressions.info/lookaround.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:15:04.417

r2 用单词表示的是“匹配一个单词边界，它后面有多个数字，可以被 3 整除，并且前面有一个数字”。这是一个矛盾，因为没有边界可以在它之前和之后有数字。它不会是一个边界。因此，这个表达式没有什么可以匹配的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:11:42.950

`r2`并且在前瞻之后直接`r3`有[单词边界，而不是在里面。`\b`](http://www.regular-expressions.info/wordboundaries.html)这永远不会匹配，因为您还希望它前面有一个数字 - 它肯定在一个单词中。

顺便说一句，我认为`+`前瞻之后是无效的。如果[前瞻](http://www.regular-expressions.info/lookaround.html)匹配，它当然会重复匹配。如果要重复 3 位数字，则必须在前瞻内。

# c++ - C program terminating

> ID：13088405
> 
> 赞同：2
> 
> 时间：2012-10-26T14:02:13.510
> 
> 标签：c++, c, linux

I am trying to write a program in C (in Linux 64bit with GCC 4.1.2).

```
int program_instances(char *cmdname)
{
   char buf[32], *ret;
   char cmdbuf[512];
   FILE *cmdpipe;

   sprintf(cmdbuf, "/bin/ps -eo comm | /bin/grep -c '%s'",
      cmdname);
   cmdpipe = popen(cmdbuf, "r");

   if (!cmdpipe)
   {
      return -1;
   }

   memset(buf, 0, sizeof(buf));
   ret = fgets(buf, sizeof(buf), cmdpipe);
   pclose(cmdpipe);

   if (!ret)
   {
      return -1;
   }

   int nr = atoi(buf);
   return nr;
} 
```

Tried to debug the issue through gdb but after the line

```
sprintf(cmdbuf, "/bin/ps -eo comm | /bin/grep -c '%'",cmdname); 
```

The programm is not crossing the above line , throwing the below lines..

```
Executing new program: /bin/bash
Error in re-setting breakpoint 1: No symbol table is loaded.  Use the "file" command.
[New process 2437]
Executing new program: /bin/ps

```

Please help us to resolve this issue.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:15:52.683

尝试使用 -g 编译代码并删除 -O [编译器标志]。优化编译器（gcc）时会更改指令顺序以提高速度。重新编译后再次附加调试器。

# database - Postgresql: inner join takes 70 seconds

> ID：13088407
> 
> 赞同：2
> 
> 时间：2012-10-26T14:02:25.520
> 
> 标签：database, performance, postgresql, postgresql-performance

I have two tables -

Table A : 1MM rows, AsOfDate, Id, BId (foreign key to table B)

Table B : 50k rows, Id, Flag, ValidFrom, ValidTo

Table A contains multiple records per day between 2011/01/01 and 2011/12/31 across 100 BId's. Table B contains multiple non overlapping (between validfrom and validto) records for 100 Bids.

The task of the join will be to return the flag that was active for the BId on the given AsOfDate.

```
select 
    a.AsOfDate, b.Flag 
from 
    A a inner Join B b on 
        a.BId = b.BId and b.ValidFrom <= a.AsOfDate and b.ValidTo >= a.AsOfDate
where
    a.AsOfDate >= 20110101 and a.AsOfDate <= 20111231 
```

This query takes ~70 seconds on a very high end server (+3Ghz) with 64Gb of memory.

I have indexes on every combination of field as I'm testing this - to no avail.

Indexes : a.AsOfDate, a.AsOfDate+a.bId, a.bid Indexes : b.bid, b.bid+b.validfrom

Also tried the range queries suggested below (62seconds)

This same query on the free version of Sql Server running in a VM takes ~1 second to complete.

any ideas?

Postgres 9.2

Query Plan

```
QUERY PLAN                                       
---------------------------------------------------------------------------------------
Aggregate  (cost=8274298.83..8274298.84 rows=1 width=0)
->  Hash Join  (cost=1692.25..8137039.36 rows=54903787 width=0)
    Hash Cond: (a.bid = b.bid)
     Join Filter: ((b.validfrom <= a.asofdate) AND (b.validto >= a.asofdate))
     ->  Seq Scan on "A" a  (cost=0.00..37727.00 rows=986467 width=12)
           Filter: ((asofdate > 20110101) AND (asofdate < 20111231))
     ->  Hash  (cost=821.00..821.00 rows=50100 width=12)
           ->  Seq Scan on "B" b  (cost=0.00..821.00 rows=50100 width=12) 
```

see [http://explain.depesz.com/s/1c5](http://explain.depesz.com/s/1c5) for the analyze output

![here is the query plan from sqlserver for the same query](../Images/1d4ffda0813512a3b2d718e3eb289a13.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:46:41.320

考虑使用 postgresql 9.2 中可用的范围类型：

```
create index on a using gist(int4range(asofdate, asofdate, '[]'));
create index on b using gist(int4range(validfrom, validto, '[]')); 
```

您可以查询匹配范围内的日期，如下所示：

```
select * from a
where int4range(asofdate,asofdate,'[]') && int4range(20110101, 20111231, '[]'); 
```

对于 b 中的行与 a 中的记录重叠，如下所示：

```
select *
from b
    join a on int4range(b.validfrom,b.validto,'[]') @> a.asofdate
where a.id = 1 
```

（`&&`表示“重叠”，`@>`表示“包含”，并`'[]'`表示创建一个包含两个端点的范围）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:32:18.807

问题出在索引上-由于某种原因我不清楚，查询分析器没有正确引用表上的索引-我将它们全部删除，将它们添加回来（完全相同-通过脚本），现在查询需要约 303 毫秒。

感谢您对这个非常令人沮丧的问题的所有帮助。

# xaml - 文本框多重绑定

> ID：13088414
> 
> 赞同：0
> 
> 时间：2012-10-26T14:02:42.793
> 
> 标签：xaml, binding

在我的 WPF 应用程序中，一个文档有两个属性，报告名称和文件名称。在 UI 中，用户填写报告名称，文件名将自动填充报告名称作为默认值。在创建新文档的对话框中，我有

```
<TextBox x:Name="tbReportName" Grid.Row="0" Grid.Column="1" Style="{StaticResource DialogInputStyle}"
         Text="{Binding UpdateSourceTrigger=PropertyChanged, Path=ReportName,
                ValidatesOnDataErrors=true, NotifyOnValidationError=true}" /> 
```

和

```
 <TextBox  Grid.Row="5" Grid.Column="1" Text="{Binding Text,ElementName=tbReportName,UpdateSourceTrigger=PropertyChanged,Mode=OneWay,Converter={StaticResource safefilenamConverter}}"  Style="{StaticResource DialogInputStyle}" > 
```

报告名称绑定到视图模型中的属性，我需要对文件名执行相同操作

用户可以选择使用默认文件名或在文本框中更改它。我需要将文件名文本框的值绑定到我的视图模型中的属性，但该绑定已用于从报告名称文本框中获取值。

如果我想保留 MVVM，不知道该使用什么

Multibinging，触发器....有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T21:07:17.127

它必须在 XAML 中吗？如果在设置 ReportName 时它为空，则可以只设置 FileName 属性：

```
private string _reportName;
public string ReportName
{
    get { return _reportName; }
    set
    {
        _reportName = value;
        if(string.IsNullOrEmpty(FileName))
        {
            FileName = _reportName;
        }
        OnPropertyChanged("ReportName");
    }
}

private string _fileName;
public string FileName
{
    get { return _fileName; }
    set
    {
        _fileName = value;
        OnPropertyChanged("FileName");
    }
} 
```

# php - How should I proceed to capitalize the first letter of a filter when it is on the beginning of the sentence?

> ID：13088419
> 
> 赞同：0
> 
> 时间：2012-10-26T14:02:56.563
> 
> 标签：php, regex

I have some filters on my forums, something like: when a user posts "hello" the filter modifies the word to "ohai!".

But when a user posts Hello the filter still modify the word to "ohai!", not "Ohai!".

I know this is fixed using regex, but I don't know how.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:10:36.317

如果你使用 PHP，你可以使用 ucfirst(); （大写首字母）

例如：

```
$filter= "ohai";
echo ucfirst($filter); 
```

# axapta - Dynamics AX 2009 - 自定义自动报告

> ID：13088429
> 
> 赞同：0
> 
> 时间：2012-10-26T14:03:39.897
> 
> 标签：axapta, dynamics-ax-2009

我已经创建了一个包含各种字段的自定义自动报告（通过单击文件>打印 - 然后修改以创建新报告），但是在物理打印报告时，第一列将文本换行，因此它看起来像这样：

```
Item #  | Item Name  | Qty
--------------------------
5439988 |  Test Item |  2
0049E 
```

其他列不换行这样的文本，有没有办法改变列宽来阻止这种行为，这样我就可以提高报告的美感？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:13:11.280

检查`DisplayLength`相应字段的扩展数据类型的属性。

# c# - 从类中调用方法 - 不起作用

> ID：13088431
> 
> 赞同：0
> 
> 时间：2012-10-26T14:03:42.103
> 
> 标签：c#, asp.net

所以我有一个类、commenter 和该类中的两个方法，SaveBtn_Click - 主要不是由我创建，然后还有 PeerReview，主要由我创建。

无论如何，代码是这样开始的（在各种 using 语句之后）：

```
public partial class commenter : System.Web.UI.Page

    {
        string employee_reviewed;
        PeerReview pr = new PeerReview();
        public void SaveBtn_Click(object sender, EventArgs e)
        {
           //all the information for the SaveBtn_Click method. 
        } 
```

之后，我有 PeerReview：

```
 public void PeerReview(System.Web.UI.WebControls.ListBox listbox)
    {
        MySqlConnection con = new MySqlConnection("server=localhost;database=hourtracking;uid=username;password=password");
        MySqlCommand cmd = new MySqlCommand("select first_name from employee where active_status=1", con);
        con.Open();
        MySqlDataReader r = cmd.ExecuteReader();

        Console.WriteLine("Another test!");
        Console.WriteLine(r);
        Console.WriteLine("Hi, this is a test!");
        while (r.Read())
        {
            listbox.Items.Add(new ListItem(Convert.ToString(r["first_name"]), Convert.ToString(r["first_name"])));

        }
        con.Close();
    } 
```

我将它与 ASP.NET 连接起来，我可以显示列表框，但不能显示列表框中的各个项目。我正在使用 console.writeline 命令对其进行测试，以查看它是否输出任何内容 - 但 ASP 页面上没有输出任何内容。

我不确定我应该如何引用这些特定部分（C# 新手，问了 3 打关于这个的问题）。

ASP 代码如下所示：

```
<asp:ListBox ID="listBox1" runat="server"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:09:25.030

你有一些令人困惑的声明。

您声明了一个名为 PeerReview 的*方法*，但您也尝试创建 PeerReview 的实例，就好像它是一个*type*一样。我认为您真的只想从按钮单击事件中调用 PeerReview 方法，例如

```
public void SaveBtn_Click(object sender, EventArgs e)
        {
           PeerReview();
        } 
```

然后消除“PeerReview pr = new PeerReview();” 线。此外，由于这是在页面上，因此您在分部类中通过其 ID 对列表框进行了隐式引用，因此您无需将其作为参数传递。并且 Console.WriteLines 在 Web 应用程序中没有用 - 如果您想将其添加到输出以进行调试，您可以尝试 Response.Write。

**基于 OP 响应的编辑**

您应该在 Page_Load 事件处理程序中调用 PeerReview：

```
public void Page_Load(object sender, EventArgs e)
{
    // You need to determine if you should call PeerReview every time the page 
    // loads, or only on the initial call of the page, thus determining whether
    // you need the IsPostBack() test. My instinct is that you *do* want to constrain
    // it to the first pass, but only you can make that determination for
    // certain based on your requirements.

    if (!Page.IsPostBack)  //Do you need this check?
    {
        PeerReview();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:21:43.853

您正在尝试将项目添加到列表框，尽管您的 listBox 的 id 为 listBox1

为什么不将数据源绑定到列表框，然后在列表框上设置 DataTextField 和 DataValueField，而不是循环遍历数据并添加项目。

例如（可能存在错别字..抱歉..自从我写 C# 以来已经有一段时间了）

```
MySqlConnection con = new MySqlConnection("server=localhost;database=hourtracking;uid=username;password=password");
    MySqlCommand cmd = new MySqlCommand("select first_name from employee where active_status=1", con);
    con.Open();
    MySqlDataReader r = cmd.ExecuteReader();

    listBox1.DataSource = r;
    listBox1.DataBind();
    con.Close(); 
```

如果您无法绑定到阅读器（不记得了..），则先将结果转储到数据表中，然后绑定到 listBox1

```
 DataTable dTable = New DataTable();
    dTable.Load(reader);
    listBox1.DataSource = dTable;
    listBox1.DataBind(); 
```

在您的 asp 中，将 listBox 字段设置为：

```
<asp:ListBox ID="listBox1" runat="server" DataTextField="first_name" DataValueField="first_name"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:07:12.033

快速查看这里是您添加项目`listbox`而不是`listBox1`

改变：

```
 listbox.Items.Add(new ListItem(Convert.ToString(r["first_name"]), Convert.ToString(r["first_name"]))); 
```

至：

```
 listBox1.Items.Add(new ListItem(Convert.ToString(r["first_name"]), Convert.ToString(r["first_name"]))); 
```

# wpf - 如何在 twitterizer 中为 WPF 获取公共时间线

> ID：13088435
> 
> 赞同：0
> 
> 时间：2012-10-26T14:04:05.067
> 
> 标签：wpf, twitterizer

我可以在我的 WPF 应用程序中获取用户的推文。我尝试使用所有重载方法的 publictimeline 但都给出了相同的问题 System.NullReferenceException 但是当我尝试获取公共推文（公共时间线）时；它失败。下面是我的代码。使用 Twitterizer；

```
 TwitterResponse<TwitterStatusCollection> myTweets;
            TwitterResponse<TwitterStatusCollection> publicTweets;
            myTweets = TwitterTimeline.HomeTimeline(tokens);

            foreach (var item in myTweets.ResponseObject)
            {
                String textStatus = item.Text;
                myTweetsTB.AppendText(textStatus + Environment.NewLine);
            }
            publicTweets = TwitterTimeline.PublicTimeline();
            foreach (var item in publicTweets.ResponseObject)
            {
                if (item != null)
                {
                    string textStatus = item.Text;
                    publicTweetsTB.AppendText(textStatus + Environment.NewLine);
                }
                else return;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T13:28:29.413

`PublicTimeline()`已弃用。 [https://dev.twitter.com/docs/api/1/get/statuses/public_timeline](https://dev.twitter.com/docs/api/1/get/statuses/public_timeline)

你知道这会返回 20 条随机的公开推文吗？如果这是你想要的，你可以使用新的 GET，'statuses/sample'： [https ://dev.twitter.com/docs/api/1.1/get/statuses/sample](https://dev.twitter.com/docs/api/1.1/get/statuses/sample)

# c# - 如何在多线程环境中只执行一次代码块？

> ID：13088436
> 
> 赞同：8
> 
> 时间：2012-10-26T14:04:08.797
> 
> 标签：c#, wpf, multithreading, thread-safety

以下代码块在 C# 中执行对象的加载。

```
public bool IsModelLoaded { get; set; }
public override MyObject Load()
{
    if (!IsModelLoaded)
    {
        Model = MyService.LoadMyObject(Model);
        IsModelLoaded = true;
    }
    return Model;
} 
```

我的意图是只运行这个块一次，因此`Model`只加载一次。然而，这个代码块从 2 个不同的线程运行了两次。

我怎样才能确保这个块只运行一次？（在多个线程上）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:06:37.483

使用[Lazy<T> 类](http://msdn.microsoft.com/en-us/library/dd642331.aspx)：

```
private readonly Lazy<MyObject> myObject;

public MyClass()
{
    myObject = new Lazy<MyObject>(() =>
    {
        return MyService.LoadMyObject();
    }, LazyThreadSafetyMode.ExecutionAndPublication);
}

public bool IsModelLoaded
{
    get { return myObject.IsValueCreated; }
}

public override MyObject Load()
{
    return myObject.Value;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:08:59.827

如果你想编写线程安全的代码并确保块只运行一次，你可以这样写：

```
private System.Object lockThis = new System.Object(); 
public override MyObject Load()
{
    lock (lockThis) {
        if (!IsModelLoaded)
        {
            Model = MyService.LoadMyObject(Model);
            IsModelLoaded = true;
        }
    }
    return Model;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T14:06:36.253

最简单的方法是添加

```
[MethodImpl(MethodImplOptions.Synchronized)]
public override MyObject Load()
{
   //snip
} 
```

但请注意，这会锁定整个对象，而不仅仅是方法。不是很好的练习。

[http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.methodimploptions.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.methodimploptions.aspx)

同步的

指定该方法一次只能由一个线程执行。静态方法锁定类型，而实例方法锁定实例。只有一个线程可以在任何实例函数中执行，并且只有一个线程可以在任何类的静态函数中执行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-26T14:06:46.190

我正在尝试实现`singleton`模式。但是您的版本不是线程安全的。在此处阅读更多信息：http: [//www.dofactory.com/Patterns/PatternSingleton.aspx](http://www.dofactory.com/Patterns/PatternSingleton.aspx)。尝试使用此实现：

```
public sealed class Singleton
{
    static Singleton instance=null;
    static readonly object padlock = new object();

    Singleton()
    {
    }

    public static Singleton Instance
    {
        get
        {
            lock (padlock)
            {
                if (instance==null)
                {
                    instance = new Singleton();
                }
                return instance;
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-26T14:07:12.943

```
Action myCodeBlock = ()=>
{
  //do your job
  //...
  myCodeBlock = ()=>{};
} 
```

调用`myCodeBlock()`一次后，它将被什么都不做的方法重写。您仍然需要确保安全地调用此方法 - 使用`lock`或其他。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-26T14:07:14.397

您可以使用[lock 语句（C# 参考）](http://msdn.microsoft.com/en-us/library/c5kehkcz%28v=vs.80%29.aspx)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-10-26T14:06:08.367

创建一个静态对象（如布尔值），通过将其放入 if 语句来确定代码是否已运行：)

编辑：我不确定这是否是线程安全的，所以它可能不是你的解决方案。

# asp.net - 是什么导致对等错误重置连接

> ID：13088438
> 
> 赞同：0
> 
> 时间：2012-10-26T14:04:12.313
> 
> 标签：asp.net, apache-flex, connection

我有一个 flex 应用程序，它通过对 asp 应用程序的 httpservice 调用获取数据。我收到对等点 104 重置连接，（502 错误网关）错误。这是随机发生的，并不总是在同一个 httpservice 上。确定这是连接问题，我该如何解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:07:37.120

这意味着服务器已经向您发送了 RST 数据包，这意味着立即断开连接。

> “由对等方重置连接”是 TCP/IP 等价物，相当于将电话重新挂上。这比仅仅不回复，留下一个悬而未决更有礼貌。但这不是真正有礼貌的 TCP/IP 话务员所期望的 FIN-ACK。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-09T16:14:23.023

由于配置错误，我也遇到过 2 台设备共享同一个 IP 的情况。这是一个非常令人沮丧的错误，因为一个人可能正在传输一个大文件，并且在大多数情况下，一切都会正常工作，但有时会断开连接。使用 iperf 进行的测试表明，双方每隔一段时间都会收到一个 RST 数据包。

我的猜测是，在某些时候，发往与设备 A 的开放会话的数据包被传递到设备 B，而设备 B 没有为它们找到现有会话，正在发回一个 RST 数据包。

# mysql - mysql中高效的多行插入

> ID：13088441
> 
> 赞同：1
> 
> 时间：2012-10-26T14:04:19.437
> 
> 标签：mysql, performance, insert

> **可能重复：**
> [哪个更快：多个单个 INSERT 或一个多行 INSERT？](https://stackoverflow.com/questions/1793169/which-is-faster-multiple-single-inserts-or-one-multiple-row-insert)

在浏览一本关于 mysql 的书时，我发现了两种在数据库中插入行的方法。

```
Method 1 

INSERT INTO tableName (col1, col2, col3) VALUES('a', 'b', 'c');
INSERT INTO tableName (col1, col2, col3) VALUES('d', 'b', 'c');
INSERT INTO tableName (col1, col2, col3) VALUES('e', 'b', 'c');

Method 2

INSERT INTO tableName (col1, col2, col3) VALUES('a', 'b', 'c'), ('d', 'b', 'c'), ('e', 'b', 'c'); 
```

第二种方法比第一种更有效吗？或者它只是简单地调用`Method 1`多次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:05:36.877

二是效率更高。

第一种方法在您每次要插入行时创建一个连接，而第二种方法使用单个连接来插入所有行。但是，有一个`max_allowed_packet`限制客户`INSERT`陈述的长度。

# android-holo-everywhere - HoloEverywhere 在应用程序中不起作用

> ID：13088443
> 
> 赞同：1
> 
> 时间：2012-10-26T14:04:28.383
> 
> 标签：android-holo-everywhere

当我尝试在我的设置活动中使用 HoloEverywhere 时，我在 logcat 中收到此错误：

```
10-26 09:56:59.653: E/AndroidRuntime(3552): android.view.InflateException: Binary XML file line #2: Error inflating class <unknown>
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.LayoutInflater.createView(LayoutInflater.java:518)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at com.WazaBe.HoloEverywhere.LayoutInflater.onCreateView(LayoutInflater.java:195)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:568)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.LayoutInflater.inflate(LayoutInflater.java:386)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at com.WazaBe.HoloEverywhere.preference.Preference.onCreateView(Preference.java:514)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at com.WazaBe.HoloEverywhere.preference.Preference.getView(Preference.java:404)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at com.WazaBe.HoloEverywhere.preference.PreferenceGroupAdapter.getView(PreferenceGroupAdapter.java:158)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.AbsListView.obtainView(AbsListView.java:1430)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.ListView.makeAndAddView(ListView.java:1745)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.ListView.fillDown(ListView.java:670)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.ListView.fillFromTop(ListView.java:727)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.ListView.layoutChildren(ListView.java:1598)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.AbsListView.onLayout(AbsListView.java:1260)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.layout(View.java:7175)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.layout(View.java:7175)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.layoutHorizontal(LinearLayout.java:1243)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1049)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.layout(View.java:7175)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.layout(View.java:7175)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.layout(View.java:7175)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.layout(View.java:7175)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.layout(View.java:7175)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.layout(View.java:7175)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.ViewRoot.performTraversals(ViewRoot.java:1140)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1859)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.os.Handler.dispatchMessage(Handler.java:99)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.os.Looper.loop(Looper.java:130)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.app.ActivityThread.main(ActivityThread.java:3683)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at java.lang.reflect.Method.invokeNative(Native Method)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at java.lang.reflect.Method.invoke(Method.java:507)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at dalvik.system.NativeStart.main(Native Method)
10-26 09:56:59.653: E/AndroidRuntime(3552): Caused by: java.lang.reflect.InvocationTargetException
10-26 09:56:59.653: E/AndroidRuntime(3552):     at java.lang.reflect.Constructor.constructNative(Native Method)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at java.lang.reflect.Constructor.newInstance(Constructor.java:415)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.LayoutInflater.createView(LayoutInflater.java:505)
10-26 09:56:59.653: E/AndroidRuntime(3552):     ... 46 more
10-26 09:56:59.653: E/AndroidRuntime(3552): Caused by: java.lang.UnsupportedOperationException: Can't convert to dimension: type=0x2
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.content.res.TypedArray.getDimensionPixelSize(TypedArray.java:463)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.<init>(View.java:2108)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.View.<init>(View.java:1899)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.view.ViewGroup.<init>(ViewGroup.java:286)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at android.widget.LinearLayout.<init>(LinearLayout.java:120)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at com.WazaBe.HoloEverywhere.widget.LinearLayout.<init>(LinearLayout.java:37)
10-26 09:56:59.653: E/AndroidRuntime(3552):     at com.WazaBe.HoloEverywhere.widget.LinearLayout.<init>(LinearLayout.java:33)
10-26 09:56:59.653: E/AndroidRuntime(3552):     ... 49 more 
```

我从溢出菜单项开始我的 settingsActivity。我可以向 HoloEverywhere-Demo 添加一个溢出菜单，并在选择时开始我的活动并且它可以工作。这是我的设置活动：

```
public class SettingsActivity extends com.WazaBe.HoloEverywhere.sherlock.SPreferenceActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.settings);
    }   
    @Override
    public void onStart() {
        super.onStart();
        initActionBar();
    }

    @Override
    public void onResume() {
        super.onResume();
    }

    @Override
    public void onPause() {
        super.onPause();
    }

    @Override
    public void onStop() {
        super.onStop();
    }

    private void initActionBar() {
        ActionBar actionBar = getSupportActionBar();
        actionBar.setBackgroundDrawable(getResources().getDrawable(R.drawable.action_bar_gradient));
        actionBar.setTitle(R.string.settings);
        actionBar.setDisplayHomeAsUpEnabled(true);
        actionBar.setDisplayUseLogoEnabled(true);
    }
} 
```

任何想法为什么我可以在演示中毫无问题地使用此活动，但是当我添加到我的应用程序时，我收到了我发布的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:11:53.453

您的 settings.xml 是否使用全息属性？您必须将 xmlns 更改为 holo 并将所有 android: 更改为 holo:

像这样：

```
<PreferenceScreen xmlns:holo="http://schemas.android.com/apk/res-auto" >

<PreferenceCategory holo:title="title" >
    <Preference
        holo:key="key"
        holo:summary="summary"
        holo:title="title" />
</PreferenceCategory>

<Preference
    holo:key="key"
    holo:title="title"
    holo:selectable="true" />
</PreferenceScreen> 
```

# javascript - 使用 JQuery 条件来模拟单击切换

> ID：13088447
> 
> 赞同：1
> 
> 时间：2012-10-26T14:04:42.353
> 
> 标签：javascript, jquery, if-statement, click, toggle

我正在构建一个具有多个面板的项目，由三个按钮之一触发。单击按钮时，面板会滑出，并且所有现有面板都会滑开。我开始使用切换，但我需要所有切换相互配合，所以我将事件更改为单击。

一切都很好，但我在关闭面板时遇到了问题。你可以在这里看到一个 jsfiddle 演示：http: [//jsfiddle.net/3W4uG/1/](http://jsfiddle.net/3W4uG/1/)

如您所见，面板打开得很好。但是，您无法通过再次按下按钮来关闭它们。

我的 JQuery 看起来像这样：

```
$("a.button").on("click", function(e){
        idClick = $(this).attr("id");
        newSelector = $("#pane"+idClick);

        //close panes and remove active classes
        $(".pane").removeClass("panelUp");
        $("a.button").removeClass("activeBtn");

        //make active
        $(this).addClass("activeBtn");
        newSelector.addClass("panelUp");

        e.preventDefault();
});​ 
```

我正在考虑实现一个条件语句，所以模拟一个这样的切换：

```
var thisBtn = $(this);

if(thisBtn.hasClass("activeBtn")){
    $(this).removeClass("activeBtn");   //remove active state
    newSelector.removeClass("panelUp"); //remove panel with css3
}

else{
    $(".pane").removeClass("panelUp"); //closes down any other pane
    $("a.button").removeClass("activeBtn"); //removes all other active classes
    $(this).addClass("activeBtn");  //add active class to button just clicked
    newSelector.addClass("panelUp"); //slides up new pane with css3
} 
```

这没有用。事实上，它阻止了所有面板一起工作。在不切换到切换的情况下，我能做些什么来完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:21:15.193

[http://jsfiddle.net/3W4uG/5/](http://jsfiddle.net/3W4uG/5/)

```
$("a.button").on("click", function(e){

    var idClick = $(this).attr("id");
    var newSelector = $("#pane"+idClick);
    var isCurrentPane=    $(this).hasClass("activeBtn"); 

        $(".pane").removeClass("panelUp");
        $(".button").removeClass("activeBtn");

    if(!isCurrentPane)
    {
        $(this).addClass("activeBtn");
        newSelector.addClass("panelUp");
    }           
    e.preventDefault();      
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:09:22.447

一种可能的解决方案是记住当前面板的原始状态（见下文`wasActive`），如果面板最初是打开的，则不重新打开它。

```
$("a.button").on("click", function(e) {

    idClick = $(this).attr("id");
    newSelector = $("#pane" + idClick);

    var wasActive = newSelector.hasClass('panelUp');  // newly added

    //close panes and remove active classes
    $(".pane").removeClass("panelUp");
    $("a.button").removeClass("activeBtn");

    if (!wasActive) {                                 // newly added

        //make active
        $(this).addClass("activeBtn");
        newSelector.addClass("panelUp");
    }

    e.preventDefault();

});​ 
```

更新[了 FIDDLE](http://jsfiddle.net/3W4uG/2/)。

# queue - “远程计算机不可用。” 是从远程公共 windows server 2003 队列读取时抛出的错误

> ID：13088450
> 
> 赞同：0
> 
> 时间：2012-10-26T14:04:50.030
> 
> 标签：queue, msmq, windows-server-2003

我不断收到错误“远程计算机不可用”。从远程公共 Windows Server 2003 队列读取时。队列在服务器 B 上。我的应用程序在服务器 A 上；

*   令人惊讶的是，服务器 A 可以将消息放在服务器 B 上的任何队列上，我只是无法从 B 读取消息。
*   两台服务器 A 和 B 在同一个域中。
*   所有其他服务器都可以在 B 的队列上读写
*   它发生在我重新启动服务器 A 之后
*   我又徒劳地重新启动了A
*   msmq 在 A 和 B 上运行 在线建议都不起作用。

它看起来不像服务器 A 和 B 之间的信任问题。请帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T12:27:25.883

我得到了解决方案。我上面评论中的方法奏效了。问题是，我们的 IT 网络人员封锁了 135 端口。这不会立即影响拉取消息。由于 RPC 请求失败，B 必须在重新启动服务器 A 之后拒绝其请求。再次感谢[管道工伙伴的 MSMQ](http://blogs.msdn.com/b/johnbreakwell/archive/2008/07/10/getting-msmq-messages-out-of-windows-server-2008.aspx?CommentPosted=true#commentmessage)

# uitableview - 如何向原型单元格中的 UIButton 添加方法？

> ID：13088451
> 
> 赞同：1
> 
> 时间：2012-10-26T14:04:50.153
> 
> 标签：uitableview, prototype

您好正在创建一个包含两个原型单元格的表格。按钮“Cell One”连接到方法*btnCellOneTouched*，按钮“Cell Two”连接到*btnCellTwoTouched*。每个原型单元格中的按钮都有标签 0，文本字段有标签 1。

每个原型单元都有自己的标识符——分别*是 cellOne*和*cellTwo*。这是我的**.m**文件中的代码。变量都是正确的，没有错误。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    intNumRows = 0;
    numSections = 1;
}

- (NSInteger)numberOfSectionsInTableView: (UITableView *)tableView
{
    return numSections;
}

- (NSInteger)tableView: (UITableView *)tableView numberOfRowsInSection: (NSInteger)section
{
    return intNumRows;
}

- (void)displayRowNum:(id)sender
{
    UIButton *btn = (UIButton *)sender;
    NSLog(@"%d", btn.tag);
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:strCellType];
    if(cell == nil)
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:strCellType];

    [(UIButton *)[cell viewWithTag:0] addTarget:self action:@selector(displayRowNum:) forControlEvents:UIControlEventTouchUpInside];

    return cell;
}

- (IBAction)btnCellOneTouched:(id)sender
{
    strCellType = @"cellOne";
    intLastRow = [tblMain numberOfRowsInSection:0];
    indexPath = [NSIndexPath indexPathForRow:intLastRow inSection:0];
    intNumRows++;
    [tblMain insertRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationRight];
}
- (IBAction)btnCellTwoTouched:(id)sender
{
    strCellType = @"cellTwo";
    intLastRow = [tblMain numberOfRowsInSection:0];
    indexPath = [NSIndexPath indexPathForRow:intLastRow inSection:0];
    intNumRows++;
    [tblMain insertRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationRight];
} 
```

**由于未捕获的异常“NSInvalidArgumentException”，**我收到错误终止应用程序，原因：“-[UITableViewCell addTarget:action:forControlEvents:]: unrecognized selector sent to instance 0x90638e0”当我运行程序时。

我为在运行时创建的单元格中的按钮分配方法的方式有什么问题？

如果我注释掉添加目标的行，它可以正常工作。

这个让我困惑了一段时间。请帮忙。

谢谢，安贾恩。

# php - 如何在 PHP 中 DST 切换前的最后一小时内从 DateTime 对象中检索 unix 时间戳？

> ID：13088455
> 
> 赞同：7
> 
> 时间：2012-10-26T14:05:06.683
> 
> 标签：php, datetime, unix-timestamp, dst

有一个示例代码

```
<?php
$dt = new \DateTime();
$dt->setTimezone(new \DateTimeZone('Europe/London'));

$timestamp = 1351383400;    
echo "$timestamp \n";

$dt->setTimestamp($timestamp);
echo $dt->getTimestamp(); 
```

它输出 2 个不同的时间戳**1351383400**（星期日，2012 年 10 月 28 日 01:16:40 +0100，就在 DST 切换之前）和**1351387000**（星期日，2012 年 10 月 28 日 01:16:40 +0000，1 小时后，在 DST 切换之后）

问题是如何让 Timestamp getter 返回与之前传递给 Timestamp setter 1 行的整数完全相同的整数？

PHP 5.3.6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T19:04:47.353

希望这可以帮助：

```
 $dt = new DateTime();
    $dt->setTimezone(new \DateTimeZone('Europe/London'));
    $timestamp = 1181503727;
    echo $timestamp . '<br />';

    $dt->setTimestamp($timestamp);
    echo $dt->format('U'); 
```

输出：1181503727 1181503727

# python - Matplotlib 底图在立体投影上绘制两条平行线

> ID：13088458
> 
> 赞同：2
> 
> 时间：2012-10-26T14:05:22.057
> 
> 标签：python, matplotlib, matplotlib-basemap

这是我关于 Stack Overflow 的第一个问题，所以如果我忽略了任何内容，我深表歉意。我正在绘制巡航位置图，并且在北纬 60 度处发生双平行，其中一条是直线（在立体投影上）。

有人知道我在做什么来造成这种情况吗？

我的绘图脚本（引用外部数据）：

```
from mpl_toolkits.basemap import Basemap
import numpy as np
import matplotlib.pyplot as plt
import sys
import csv

dataFile = sys.argv[1]
dataStream = open(dataFile, 'rb')
dataReader = csv.reader(dataStream, delimiter=',')
numRows = sys.argv[2]

dataLat = []
dataLon = []

dataReader.next()
for row in dataReader:
    dataLon.append(float(row[5]))
    dataLat.append(float(row[6]))

m = Basemap(width=450000,height=150000,
        resolution='f',projection='stere',\
        lat_ts=65.4,lat_0=60.4,lon_0=1.91)

m.drawcoastlines(linewidth=0.2)
m.fillcontinents(color='white', lake_color='aqua')

x, y = m(dataLat,dataLon)
m.scatter(x,y,.5,marker='.',color='k')

m.drawparallels(np.arange(0.,81,1.), labels=[1,0,0,0], fontsize=10)
m.drawmeridians(np.arange(-180.,181.,5.), labels=[0,0,0,1], fontsize=10)
m.drawmapboundary(fill_color='aqua')

plt.title("Cruise Track")
plt.show() 
```

**例子：** ![示例图](../Images/6410049c59a79323a9a1fc37f14616a6.png)

另一个小问题：绘图的宽度/高度的单位是什么？它似乎不在文档中，我在任何教程等中都找不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T18:43:10.313

由于试图修复另一个错误，这似乎是一个错误。

我不使用底图，但尝试解决问题的第一步是尽可能减少它们：

```
from mpl_toolkits.basemap import Basemap
import matplotlib.pyplot as plt

scale = 1
m = Basemap(width=450000*scale,height=150000,
        resolution='i',projection='stere',
        lat_ts=65.4,lat_0=60.4,lon_0=1.91)

parallels = [60]
ret = m.drawparallels(parallels)
plt.show() 
```

您可以在返回 dict 的[文档](http://matplotlib.org/basemap/api/basemap_api.html#mpl_toolkits.basemap.Basemap.drawparallels)中看到`drawparallels`，我们可以恢复实际的 Line2D（并行）及其数据点：

```
l = ret[60][0][0]
x, y = l.get_data() 
```

如果我们看一下这些点，除非我们链接它们，否则它看起来不错，然后我们可以看到烦人的双重并行！

```
plt.plot(x, y, '+')
plt.show() 
```

![+点](../Images/f901d149eff628d8f3cd99c2caf0ea05.png)

```
plt.plot(x, y)
plt.show() 
```

![链接点](../Images/3cd61e0f961482f8a5b2b0149eba39d1.png)

现在让我们尝试通过调试器 ( `python -m pdb small_example.py`) 运行这个小示例。

如果您进入对 drawparallels 的调用，您很快就会看到[此代码](https://github.com/matplotlib/basemap/blob/master/lib/mpl_toolkits/basemap/__init__.py#L2242-2251)。它看起来不太好，所以让我们跳过突出显示的行（使用`jump`，如果你从未使用过 Python 调试器，你应该阅读一下它）。

瞧，这就是结果：

![已解决的问题](../Images/f10b3296a1d688c488627dee208e93bf.png)

考虑到问题出在哪里，很容易猜到改变地图的宽度或高度（顺便说一下，以米为单位）可以解决问题。确实，设置`scale>=1.0485`有效。其他宽度和高度的组合似乎也可以正常工作。

# java - 数组的内存泄漏

> ID：13088469
> 
> 赞同：1
> 
> 时间：2012-10-26T14:05:45.253
> 
> 标签：java, android, arrays, heap-memory, android-memory

我的 Android 应用程序有一个非常奇怪的内存问题。我的应用程序使用以下 3 个类：

```
public class RGB 
{
    public int R;
    public int G;
    public int B;
}

public class CMYK 
{
    public int C;
    public int M;
    public int Y;
    public int K;
}

public class COLOR 
{
    public String id;
    public CMYK cmyk = new CMYK();
    public RGB rgb = new RGB();

    public COLOR(String id, int c, int m, int y, int k, int r, int g, int b)
    {
        this.id = id;

        this.cmyk.C = c;
        this.cmyk.M = m;
        this.cmyk.Y = y;
        this.cmyk.K = k;

        this.rgb.R = r;
        this.rgb.G = g;
        this.rgb.B = b;
    }
} 
```

然后在代码中，我必须从文件中加载 2000 种颜色（文件长约 65K，正好有 2000 条记录）并放在 assets 文件夹中

```
public COLOR[] color_list = new COLOR[2000];
...
...
do
{
    s = reader.readLine();
    if (s != null)
    {
        String[] x = s.split(" ");
        COLOR c = new COLOR(x[0], Integer.parseInt(x[1]), Integer.parseInt(x[2]), Integer.parseInt(x[3]), Integer.parseInt(x[4]), Integer.parseInt(x[5]), Integer.parseInt(x[6]), Integer.parseInt(x[7]));
        color_list[j++] = c;
    }

} while (s != null); 
```

在此之后，应用程序将崩溃并停止工作。如果我删除 do..while 一切正常，所以我认为我的阵列会越来越多，然后 65K，我做错了什么？在 Android LogCat 上，我已经达到了完整的 HEAP 空间（26MB）！！！

最好的问候 GMG

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:21:46.297

尝试使用[ArrayList](http://developer.android.com/reference/java/util/ArrayList.html)而不是基本数组，它使内存管理更加容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:29:37.310

我不认为代码对`OutOfMemoryException`. 也许还有其他领域你没有提到，但不运行代码就无法分辨。

但是，当您创建 ID 时，可能会有*少量泄漏。*每当您`String`从现有的（`substring()`基于 - 或 regex 包中的方法）创建一个时，返回的字符串都会保留**对旧字符串**[的内部引用](https://stackoverflow.com/a/1281569/315306) ：它只是旧字符序列的一个薄包装，只是具有不同的开始和不同长度。这意味着您最好像这样创建您的 ID

 **```
String id = new String(x[0]); 
```

这样，您就不会为了存储几个字符而将整行保存在内存中。

但是，这是一种优化，因为您声明您的文件为 65KB，因此即使您将其全部保留在内存中，它也不会使您的应用程序崩溃。发布整个代码，以便我们可以运行和分析它。

顺便说一句，您可以通过这种方式保存缩进级别：

```
String line;
Pattern pattern = Pattern.compile(" "); // Help the GC ;)

while ((line = in.readLine()) != null) {
    String[] data = pattern.split(line);

    // Ugly, but still better than a 8-args constructor
    RGB rgb = new RGB(data, 1, 3);
    CMYK cmyk = new CMYK(data, 4, 4);

    // the best would be a constructor like Color(String[8])
    colors[j++] = new Color(new String(data[0]), rgb, cmyk);
} 
```

我还稍微更改了 API（我发现这更舒服）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T14:34:55.983

没有错误很难说，但我假设你得到一个 IndexOutofBoundExceptions 或其他东西。您将数组初始化为 2000 个元素，但继续阅读您的文件，直到到达末尾。如果里面有 2001 个条目怎么办？然后你会吹过终点。或者如果只有 100 个呢？那你就浪费了很多空间。

就像 Ralgha 所说，使用[ArrayList](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)，而不是数组。

对于文件解析，您可能需要考虑[Scanner](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)类。**

# jquery - Jqplot 日期渲染器填充问题

> ID：13088470
> 
> 赞同：3
> 
> 时间：2012-10-26T14:05:46.137
> 
> 标签：jquery, jqplot

我面临一个关于以日期为 X 轴的[jqplot的问题。](http://jsfiddle.net/33jEG/)

我的代码是

```
var data = [
    ["10/23/2011", 266522], 
    ["10/24/2011", 170287], 
    ["10/25/2011", 2175], 
    ["10/26/2011", 1794]
];

$.jqplot('chart1', [data], {

    axes: {
        xaxis: {
            renderer: $.jqplot.DateAxisRenderer,
        }
    }
});​ 
```

我的日期范围从 2011 年 10 月 23 日开始。

**但是，呈现的图表始终从 2011 年 10 月 22 日开始。**

我知道替代方案是使用最小值和最大值。

但我也希望刻度间隔均匀分布。以下是我尝试通过在图表中均匀间隔日期标签来实现的目标。

```
var chart = $('chart1');
chart.resetAxesScale();
var tickInterval = Math.ceil(chart._plotData[0].length / chart.axes.xaxis._numberTicks);
    var newTickInterval = tickInterval * 24 * 60 * 60 * 1000;
    chart.axes.xaxis.tickInterval = newTickInterval;
chart.replot(); 
```

这基本上会平衡tickIntervals，并且x轴不会混乱。

我什至尝试使用最小值和最大值设置图表，并使用上面的代码来平均间隔日期，但我没有运气。最小值和最大值在“ `chart.resetAxesScale()`”上重置。即使我在 resetAxesScale 方法中设置了使用现有 min,max 的选项，该图也不支持这些值。轴选项中的 'pad' 属性不适用于 DateTimeAxisRenderer。

从开始日期总是有一个刻度。如果有人能指出我的错误，那将非常有帮助。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T08:29:11.447

我尝试使用“ `pad`”、“ `padMin`”和“ `PadMax`”选项，但似乎“ `$.jqplot.DateAxisRenderer`”插件不允许使用这些选项。

这是一个使用`pad`但没有“ `$.jqplot.DateAxisRenderer`”的小提琴：http: [//jsfiddle.net/33jEG/4/](http://jsfiddle.net/33jEG/4/)

最好的方法是使用`min / max`选项，对不起

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-24T11:10:11.473

我在日期轴上填充时遇到了类似的问题，所以最后使用 min max 来设置范围并使用[momentjs](http://momentjs.com/)库调整范围来解析日期。希望能帮助到你。

```
var padding = 0.05;
var min = moment(data[0][0]);
var max = moment(data[data.length - 1][0]);
var pad = (max.valueOf() - min.valueOf()) * padding;
min = moment.unix((min.valueOf() - pad)/1000);
max = moment.unix((max.valueOf() + pad)/1000);

<...>

axes: {
  xaxis: {
    min: min.format("YYYY-MM-DD HH:mm:ss"),
    max: max.format("YYYY-MM-DD HH:mm:ss"),
    renderer: $.jqplot.DateAxisRenderer,
    rendererOptions: {
       tickRenderer: $.jqplot.CanvasAxisTickRenderer
    },
   }
} 
```

# android - 具有将自行删除的功能的对象

> ID：13088471
> 
> 赞同：0
> 
> 时间：2012-10-26T14:05:46.143
> 
> 标签：android, button

我有一个名为 LabelButton 的类，带有一个 onClickListener。在我的 Activity 类中，当用户单击一个按钮时，它会创建一个 LabelButton 和一个字符串。然后将 LabelButton 添加到布局中。

在附加到 LabelButton 的 onClickListener 内部，它调用 setVisibility(View.GONE)，它负责处理 LabelButton，但我还需要删除之前创建的那个字符串。

这可能吗？

# c# - 变量值之间的差异

> ID：13088472
> 
> 赞同：2
> 
> 时间：2012-10-26T14:06:04.847
> 
> 标签：c#, casting

我在 C# 中编写了一个用于检查类型转换的代码。以下代码：

```
using System;
class Convert{
    public static void Main(){
        double a=14.25,b=26.12;
        var z=(int)(a*b);
        Console.WriteLine("z= "+z);
        Console.ReadKey(true);
    }
} 
```

给出输出：

```
z=372 
```

但是当我稍微修改一下代码时，我发现之前和修改后的 z 值之间存在很大差异。

```
using System;
    class Convert{
        public static void Main(){
            double a=14.25,b=26.12;
            var z=(int)a*b;  // Modified part
            Console.WriteLine("z= "+z);
            Console.ReadKey(true);
        }
    } 
```

给出输出：

```
z=365.68 
```

我不明白为什么从原始代码中删除括号后会有这么大的区别？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T14:07:04.863

没有外括号，强制转换仅`(int)`适用于`a`。
因此，你最终将一个截断的整数乘以一个普通的双精度数，然后类型推断`var`变成`double`.

使用括号，强制转换适用于乘法的结果。因此，整个结果被截断，类型推断`var`变成`int`.

* * *

因此，更改`var`为`double`对这两个示例都没有影响。（在第二种情况下，它将截断分配`int`给一个`double`变量）

更改`var`为`int`会将第二个示例变成编译器错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:08:00.087

括号设置优先级

```
var z=(int)(a*b);//(a*b) cast to int
var z=(int)a*b;//a cast to int and myltiply with b 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:09:42.507

会话操作的优先级`()`大于乘法优先级。在第一种情况下，您有：

```
double tmp = a*b;
int z = (int)tmp; 
```

第二：

```
int tmp = (int)a;
double z = tmp * b; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T14:10:29.610

在行中

```
var z=(int)a*b; 
```

a 在相乘之前被转换为 int。所以它将是 14*26.12。在第二种情况下，您将 a*b 相乘，然后将结果转换为 int。

# javascript - jQuery 将 div 的高度设置为包含多少文本

> ID：13088477
> 
> 赞同：1
> 
> 时间：2012-10-26T14:06:13.693
> 
> 标签：javascript, jquery, html, css

我已经构建了一个简单的动画功能，您可以在其中单击扩展框，如果可能的话，我宁愿不使用插件。

目前它看起来像这样：

```
$('#one').css("height", "22");
    $('#t1').click(function() {
      if ($('#one').hasClass("extended")) {
        $('#one').stop(true, true).animate({height: '22px'},500);
        $('#one').removeClass("extended");
        $('#a1').stop(true, true).animate({opacity: '1'},500);
      } else {
        $('#one').animate({height: '120px'},500);
        $('#one').addClass("extended");
        $('#a1').animate({opacity: '0'},300);
      }
}); 
```

但问题是，如果 div 内的文本溢出，那么如何将其设置为文本的高度？我希望这是有道理的！

的HTML：

```
<div class="rightBox">
    <div id="one" style="overflow:hidden;">
        <h3><a href="#" id="t1">Availability</a></h3><p id="a1"><a href="#" title="Slide Down"><img src="<?php echo home_url(); ?>/img/arrow.png" alt="Arrow" /></a></p>
        <?php include 'availability.php'; ?>
    </div>
</div><!-- END.#rightBox --> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:15:34.693

我接近这个的方法是计算所有孩子的高度，然后开始动画到那个特定的高度。见下文。

看到这个[jsFiddle](http://jsfiddle.net/TheJoeFletch/235pC/)。

```
<div class="rightBox">
    <div id="one" style="overflow:hidden;">
        <h3><a href="#" id="t1">Availability</a></h3><p id="a1"><a href="#" title="Slide Down"><img src="/img/arrow.png" alt="Arrow" /></a></p>
        <p>Sample text</p>        
                <p>Sample text</p>        
                <p>Sample text</p>        
                <p>Sample text</p>        
                <p>Sample text</p>        
                <span>More Sample text</span>        
    </div> </div>​ 
```

jQuery/javascript

```
$('#one').css({"height": "22px", "background-color": "red"});

    $('#t1').click(function() {

      if ($('#one').hasClass("extended")) {
        $('#one').stop(true, true).animate({height: '22px'},500);
        $('#one').removeClass("extended");
        $('#a1').stop(true, true).animate({opacity: '1'},500);
      } else {
        var height = 0;//initialize a height
        $(this).closest("div").children().each(function(){//this loops through each child element
           height += $(this).outerHeight(true);//this sums up the height
        });
        $('#one').animate({height: height + 'px'},500);//set the height
        $('#one').addClass("extended");
        $('#a1').animate({opacity: '0'},300);
      } });​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:20:52.227

如果您有权访问 HTML，则可以`#one`用另一个包装内容`<div>`并动态获取其高度。

示例：http: [//jsfiddle.net/88u76/](http://jsfiddle.net/88u76/)

我还在那个例子中展示了一些你可以用你的代码做的链接，这样你就不必连续调用`$( '#one' )`每次都会导致 DOM 查找。比这更好的方法是将它设置为一个你可以重用的变量：

```
var $one = $( '#one' ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:28:33.270

为什么不把文本放在一个包装器中？ap 或 div，并在其上执行 .slideToggle()？消除所有不必要的计算？

```
<div class="rightBox">
    <div id="one" style="overflow:hidden;">
        <h3><a href="#" id="t1">Availability</a></h3><p id="a1"><a href="#" title="Slide Down"> .. </a></p>
        <p class="content" style="display:none">afasdfasdfasdfasdfasdf
        as
        df
        asd <br />
        f
        asd
        f
        asd <br />
        f
        asd
        f
        asdf <br />
            afasdfasdfasdfasdfasdf
        as
        df
        asd <br />
        f
        asd
        f
        asd <br />
        f
        asd
        f
        asdf <br />
            afasdfasdfasdfasdfasdf
        as
        df
        asd <br />
        f
        asd
        f
        asd <br />
        f
        asd
        f
        asdf <br />
            afasdfasdfasdfasdfasdf
        as
        df
        asd <br />
        f
        asd
        f
        asd <br />
        f
        asd
        f
        asdf <br />
            afasdfasdfasdfasdfasdf
        as
        df
        asd <br />
        f
        asd
        f
        asd <br />
        f
        asd
        f
        asdf <br />
        </p>
    </div>
</div><!-- END.#rightBox -->​ 
```

Javascript：

```
$('#t1').click(function() {
          if ($('#one').hasClass("extended")) {
            $('#one p.content').slideToggle();
              //$('#one').stop(true, true).animate({height: '22px'},500);
            $('#one').removeClass("extended");
            $('#a1').stop(true, true).animate({opacity: '1'},500);
          } else {
            //$('#one').animate({height: 'auto'},500);
            $('#one p.content').slideToggle();
              $('#one').addClass("extended");
            $('#a1').animate({opacity: '0'},300);
          }
    });​ 
```

[http://jsfiddle.net/NxwL8/](http://jsfiddle.net/NxwL8/)

# php - 如何在 PHP 中关闭大括号

> ID：13088478
> 
> 赞同：7
> 
> 时间：2012-10-26T14:06:21.540
> 
> 标签：php, wordpress-theming

在PHP中可以按如下方式关闭大括号吗？

```
<?php function myfunction() { ?>

   // stuff

<?php } ?>                 
<?php 

// more stuff 
```

我刚刚发现这会破坏我的 Wordpress 网站，但是如果我像这样关闭括号：

```
<?php function myfunction() { ?>

   // stuff

<?php }                  

// more stuff 
```

不会引起任何问题。

这是一个令人困惑的下午！非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:08:15.863

这样做通常是个坏主意：

```
?>
<?php 
```

这会将输出添加到页面，并防止添加任何标题，如果任何代码*尝试*添加标题，这可能会导致错误。

然而：

```
//nothing 
```

才不是。

# css - 如何固定`的位置` 的引导程序？html代码： <select class="input-small"><option>1</option></select>  但是select的位置不对。你可以从 http://jsfiddle.net/SUJpH/ 看到现

> ID：13088483
> 
> 赞同：2
> 
> 时间：2012-10-26T14:06:35.893
> 
> 标签：css, twitter-bootstrap, position

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:38:32.810

只需添加`form`带有 class 的标签`form-inline`：

```
<form class="form-inline"> 
    <button class="btn">hello</button>
    <select class="input-small"><option>1</option></select>
    <button class="btn">world</button>
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:11:37.727

在**bootstrap.css**行号中。- 951 在这个班级 -

```
select, textarea, input[type="text"], input[type="password"], input[type="datetime"], input[type="datetime-local"], input[type="date"], input[type="month"], input[type="time"], input[type="week"], input[type="number"], input[type="email"], input[type="url"], input[type="search"], input[type="tel"], input[type="color"], .uneditable-input 
```

有`margin-bottom: 9px;`

删除它，一切都会按预期工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:40:02.467

一种`bootstrap.css`保持不变的方法是这样写：

```
<select class="input-small" style="margin-top:10px"><option>1</option></select> 
```

# ruby-on-rails - Rails 使用他的 getter 覆盖属性

> ID：13088489
> 
> 赞同：2
> 
> 时间：2012-10-26T14:06:50.977
> 
> 标签：ruby-on-rails, ruby, model, attributes, getter-setter

我的模型中有一个`price`属性。

我可以使用attribute-getter吗，它的命名就像属性一样

```
def price
   ... logic logic ..
   return something
end 
```

为了覆盖属性本身？

目前它不起作用。如果我称它为`model.price`有效，但是当它通过 保存对象时`model.save`，它会存储默认值。

它可以以无痛的方式完成，还是我应该进行`before_save`回调？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T14:10:15.037

如果你在 Ruby 中设置一个值，你就可以访问 setter 方法。如果要覆盖设置器，则必须执行以下操作：

```
def price=(_price)
  # do some logic
  write_attribute(:price, _price)
end 
```

这当然是一个讨论点。有时您可以更好地使用回调。像这样的东西：

```
before_save :format_price

private

def format_price
  # Do some logic, for example make it cents.
  self.price = price * 100
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T14:16:48.297

由于您似乎希望将“真实”值存储在数据库中，因此您可能想要做的是修改设置器。这样实际值就被存储了，`price`getter 可以不加修改地返回它。

您可以通过较低级别的`write_attribute`方法执行此操作。就像是：

```
def price=(value)
  # logic logic
  self.write_attribute(:price, value)
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T14:13:04.947

如果您想在保存属性值之前对其进行操作，那么使用回调将是更好的方法，因为这就是回调的用途。

# javascript - Javascript 函数无法访问 CSS 样式

> ID：13088490
> 
> 赞同：2
> 
> 时间：2012-10-26T14:06:52.737
> 
> 标签：javascript

Javascript 函数无法访问 CSS 样式

我不明白为什么下面的 Javascript 函数无法访问任何 CSS 样式！演示脚本的想法是在您右键单击时在鼠标坐标处显示一个小的选项菜单。代码如下...

```
 <style type="text/css">

      .MiniMenuText {
      Font-family: "Comic Sans MS";
      Font-size: 11px;
      Font-weight: Normal;
      Font-style: Normal;
      Text-decoration: None;
      Text-align: Left;
      Color: #FFFFFF;
      Height:0;}

      .MiniMenuBox {
      -moz-box-shadow: 3px 3px 4px #000;
      -webkit-box-shadow: 3px 3px 4px #000;
      box-shadow: 3px 3px 4px #000;
      Padding: 1px;
      Width: 175px;
      Height: 80px;
      Background-color: #686868;
      Border-style: Solid;
      Border-color: #A0AAA0;
      Border-width: 1px;
      Text-align: Center;}

      <!--
      A:hover {Color:Black; Background-color:#FFFFFF;}
      -->

      </style> 
```

```
<script type="text/javascript">

      function RunMiniMenu() {

      var X=window.event.clientX;
      var Y=window.event.clientY;

      document.write('<div Class="MiniMenuBox"; Style="Position:Absolute; Left:'+X+'px;              Top:'+Y+'px;";>');
      document.write('<a Href=""; Target="_blank"; Class="MiniMenuText";>Option 1</a><br>');
      document.write('<a Href=""; Target="_blank"; Class="MiniMenuText";>Option 2</a><br>');
      document.write('<a Href=""; Target="_blank"; Class="MiniMenuText";>Option 3</a><br>');
      document.write('<a Href=""; Target="_blank"; Class="MiniMenuText";>Option 4</a><br>');
      document.write('<a Href=""; Target="_blank"; Class="MiniMenuText";>Option 5</a></div>');
      }

      </script>

      <body oncontextmenu="RunMiniMenu(); return false;"; </body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:09:46.613

一个错误是`;`您在每个 HTML 属性之后放置。Michael Berkowski 提到了另一个（标签中的缺失）`>`。`body`

还有一件事要记住：当您`document`在页面完全加载后（即文档关闭后）写入时，写入它会产生一个缺少样式的新文档。

**编辑**

```
<style>
    /* Your styles here */
</style>

...
<body oncontextmenu="runMiniMenu();">
    <!-- Whatever markup you need comes here! -->

    <script type="text/javascript">
        function runMiniMenu(e) {
            var X = e.clientX,
                Y = e.clientY;

            var div = document.createElement('div');

            div.createAttribute('class', 'MiniMenuBox');
            div.createAttribute('style', 'position: absolute; left:'+X+'px ...

            for ( var i=1; i < 6; i++ ) {
                var a = document.createElement('a');
                a.createAttribute('target', '_blank');

                // You get the point!
                ...

                div.appendChild(a);
            }

            document.getElementsByTagName("body")[0].appendChild(div);

            return false;
        }
    </script>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:45:26.993

对于您的语法和 document.write 中的错误，每个人都是正确的。放弃 document.write，你会好很多。

如果您只是想在页面加载后将该 html 放在 body 标记中，那么我会使用`innerHTML`

所以它看起来像这样：

```
<script type="text/javascript">

  function RunMiniMenu() {

  var X=window.event.clientX;
  var Y=window.event.clientY;
  var body = document.getElementsByTagName("body");

  body.innerHTML = "<div class='MiniMenuBox' style='position:absolute; left:"+X+"px;
          top:"+Y+"px;'><a href=''; target='_blank'; class='MiniMenuText'>Option 1</a><br/></div>";
  }

  </script>

  <body onload="RunMiniMenu(); return false;"> </body> 
```

# java - Android HTTPS 和 Cookie，API 级别 8

> ID：13088491
> 
> 赞同：2
> 
> 时间：2012-10-26T14:06:59.637
> 
> 标签：java, android, session, cookies, https

我正在编写一个必须通过 HTTPS 连接到服务器的 Android 应用程序。我尝试的第一个解决方案是这个：（不要介意安全漏洞）

```
final static HostnameVerifier DO_NOT_VERIFY = new HostnameVerifier() {
    public boolean verify(String hostname, SSLSession session) {
        return true;
    }
};
private static void trustAllHosts() {
    // Create a trust manager that does not validate certificate chains
    TrustManager[] trustAllCerts = new TrustManager[] { new X509TrustManager() {
        public java.security.cert.X509Certificate[] getAcceptedIssuers() {
            return new java.security.cert.X509Certificate[] {};
        }

        public void checkClientTrusted(X509Certificate[] chain,
                String authType) throws CertificateException {
        }

        public void checkServerTrusted(X509Certificate[] chain,
                String authType) throws CertificateException {
        }
    } };

    // Install the all-trusting trust manager
    try {
        SSLContext sc = SSLContext.getInstance("TLS");
        sc.init(null, trustAllCerts, new java.security.SecureRandom());
             HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());
    } catch (Exception e) {
        Log.d("USR_SSL", e.getMessage());
    }
}
//...

@Override
protected String doInBackground(String... params) {
    try {

        URL url = new URL(params[0]);
                    //This is an HTTPS url
        String jsonStr = "";
        if(params.length > 1) {
            jsonStr = params[1];
        }
        HttpsURLConnection urlConn = (HttpsURLConnection) url.openConnection();
        trustAllHosts();
        urlConn.setHostnameVerifier(DO_NOT_VERIFY);
        urlConn.setRequestProperty("Content-Type", "application/json");
        urlConn.setRequestProperty("Accept", "application/json");
        urlConn.setRequestMethod("POST");

        OutputStream os = urlConn.getOutputStream();
        os.write(jsonStr.getBytes());
        os.flush();
//... 
```

一切都很好（几乎），直到我意识到我还必须使用身份验证、会话和所有这些好东西。使用它应该真的很好：

```
CookieManager cookieManager = new CookieManager();  
CookieHandler.setDefault(cookieManager); 
```

但不幸的是我们必须支持Android API level 8，这意味着上面两行代码将不起作用。鉴于此，我已经在 Internet 上搜索了几个小时，试图使用 Apache 类构建解决方案，这些类似乎同时支持 HTTPS 和 Cookie。

这是我设法缝合在一起的代码：

```
public class ConnectionMediator {
public class MySSLSocketFactory extends SSLSocketFactory {
    SSLContext sslContext = SSLContext.getInstance("TLS");

    public MySSLSocketFactory(KeyStore truststore) throws NoSuchAlgorithmException, KeyManagementException, KeyStoreException, UnrecoverableKeyException {
        super(truststore);

        TrustManager tm = new X509TrustManager() {
            public void checkClientTrusted(X509Certificate[] chain, String authType) {
            }

            public void checkServerTrusted(X509Certificate[] chain, String authType) {
            }

            public X509Certificate[] getAcceptedIssuers() {
                return null;
            }
        };
        sslContext.init(null, new TrustManager[] { tm }, null);
    }

    @Override
    public Socket createSocket(Socket socket, String host, int port, boolean autoClose) throws IOException, UnknownHostException {
        return sslContext.getSocketFactory().createSocket(socket, host, port, autoClose);
    }

    @Override
    public Socket createSocket() throws IOException {
        return sslContext.getSocketFactory().createSocket();
    }
}
public void tryConnect(String url, String data) {
    try {
        //SSL Stuff
        KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
        trustStore.load(null, null);

        SSLSocketFactory sf = new MySSLSocketFactory(trustStore);
        sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);

        HttpParams params = new BasicHttpParams();
        HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
        HttpProtocolParams.setContentCharset(params, HTTP.UTF_8);

        SchemeRegistry registry = new SchemeRegistry();
        registry.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
        registry.register(new Scheme("https", sf, 443));

        ClientConnectionManager ccm = new ThreadSafeClientConnManager(params, registry);

        DefaultHttpClient httpClient = new  DefaultHttpClient(ccm, params);

        //Cookie stuff
        HttpContext localContext = new BasicHttpContext();
        HttpResponse response = null;
        HttpPost httpPost = null;
        StringEntity tmp = null;

        httpClient.getParams().setParameter(ClientPNames.COOKIE_POLICY, CookiePolicy.RFC_2109);
        httpPost = new HttpPost(url);

        tmp = new StringEntity(data,"UTF-8");
        httpPost.setEntity(tmp);

        response = httpClient.execute(httpPost,localContext);
    } catch(Exception e) {
        Log.d("USR_DEBUG", e.getClass().toString() + ": " + e.getMessage());
    }

}
} 
```

在写这篇文章的时候，我得到了一个`NetworkOnMainThreadException`，但这并不重要；重要的是我想指出的是，*我不知道自己在做什么*，例如，通过 HTTPS 简单地连接并使用 cookie，必须使用 13 个我从未听说过的不同类的。显然，我对 HTTPS/Java 网络类的了解几乎为零，但尽管如此，我还是希望得到更直观的东西。因此，我的问题不是“这不起作用”类型的问题，而是“我应该做什么”，甚至是“我如何学习我必须做的事情？”。

非常感谢，

一个非常困惑的编码器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T08:45:07.000

我最初的问题有两个部分：首先，如何使用 HTTPS，其次，如何同时使用 cookie。

我的问题不够彻底，因为我已经部分回答了它 - 我最初发布的代码适用于 HTTPS，并且`NetworkOnMainThreadException`发生这种情况是因为我没有在单独的线程中运行代码，例如，使用`AsyncTask`.

但是，要正确使用 cookie，应该使用类似于以下的解决方案：

```
public class State {
    private static HttpContext httpContext;
    public static HttpContext getHttpContext() {
        if(httpContext == null) {
            httpContext = new BasicHttpContext();
            CookieStore cookieStore = getCookieStore();
            httpContext.setAttribute(ClientContext.COOKIE_STORE, cookieStore);
        }
        return httpContext;
    }
    private static CookieStore cookieStore;
    public static CookieStore getCookieStore() {
        if(cookieStore == null) {
            cookieStore = new BasicCookieStore();
        }
        return cookieStore;
    }
} 
```

我不确定这是否是“Android”的做法（使用静态类），但它有效：

```
 //...
    //Connection objects
    DefaultHttpClient httpClient = new DefaultHttpClient(ccm, params);
    HttpPost httpPost = null;

    //Cookie stuff
    HttpContext httpContext = State.getHttpContext();
    httpClient.getParams().setParameter(ClientPNames.COOKIE_POLICY, CookiePolicy.RFC_2109);
    //.... 
```

似乎`HttpClient`每次都使用另一个会保留会话，前提是使用相同的`CookieStore`和`HttpContext`。虽然这个答案使“事情正常”（这是我现在需要的），但它并不是一个彻底的答案，因为它根本没有解释为什么需要 10 多个类来将所有东西连接在一起。

# java - 会话 bean 中的 EntityManager 异常处理

> ID：13088499
> 
> 赞同：4
> 
> 时间：2012-10-26T14:07:20.200
> 
> 标签：java, mysql, jpa, entitymanager

我有一个注入 EntityManager em 的托管无状态会话 bean。

我想要做的是拥有一个具有唯一列的数据库表。然后我运行一些试图插入实体的算法。但是，如果实体存在，它将更新它或跳过它。

我想要这样的东西：

```
try {   
em.persist(cd);     
em.flush();     
} catch (PersistenceException e) {  
// Check if the exception is DatabaseException and ConstraintViolation
    // Update instead or skip it
} 
```

问题是我只能抓到`PersistenceException`. `DatabaseException`没有被抓住。很遗憾，因为只有一个`DatabaseException`名为`getDatabaseErrorCode()`我想用来检查重复条目的方法。我不明白，因为`PersistenceException.getCause()`退货`DatabaseException`。

所以我的问题是：如何捕获`DatabaseException`和检查 MySQL 错误代码？

感谢您对此提出任何想法和经验。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T17:05:44.093

我有一个在我的应用程序中使用的建议。我们可以检索`SQLException`from `PersistenceException`。之后，尝试`sql error code`获取`SQLException`. 如果您的要求是获得`sql error code`，您可以按照我的示例进行操作；

```
public void insert(Group group) throws DAOException {
    try {
        //your operation
        em.flush();
        logger.debug("insert() method has been successfully finisehd.");
    } catch (PersistenceException pe) {
        String sqlErroCode = getErrorCode(pe);
        // do your operation based on sql errocode
    }
}

protected String getErrorCode(RuntimeException e) {
    Throwable throwable = e;
    while (throwable != null && !(throwable instanceof SQLException)) {
        throwable = throwable.getCause();
    }
    if (throwable instanceof SQLException) {
        Properties properties = --> load sql error code form configuration file.
        SQLException sqlex = (SQLException) throwable;
        String errorCode = properties.getProperty(sqlex.getErrorCode() + "");
        return errorCode;
    }
    return "NONE";
} 
```

mysql错误码配置示例

mysql_error_code.properties

```
#MySQL Database
1062=DUPLICATE_KEY_FOUND
1216=CHILD_RECORD_FOUND
1217=PARENT_RECORD_NOT_FOUND
1048=NULL_VALUE_FOUND
1205=RECORD_HAS_BEEN_LOCKED 
```

# android - webview上的后退按钮退出应用程序而不是显示以前的listview结果

> ID：13088500
> 
> 赞同：0
> 
> 时间：2012-10-26T14:07:23.460
> 
> 标签：android

我正在开发一个应用程序，它最初在 onPostExecute 中加载项目的列表视图。选择项目后，在 webview 上打开更完整的详细信息（仍在 onPostExeceute 中）没​​有问题。但是，点击 webview 中的返回按钮只会退出整个应用程序。

有人可以帮忙吗。

因此事件的方案是 Activity Create 建立网络广播 --> onStart --> AsyncTask --> 检索数据 --> onPostExecute --> setContentView (ListView) --> onClickListener --> WebView --> 回退按钮然后 stage 退出整个应用程序。

我相信有人可以在这方面帮助我，我将非常感谢任何努力。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:15:47.860

这种行为是正常的。onBackPressed() 事件在您的活动中调用 finish() 方法并将您带回到您刚开始的地方。

你仍然有可能捕捉到这个事件并告诉你的应用接下来要做什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:56:26.233

Android 中返回键的默认行为是返回上一个 Activity，或者如果您已经在根 Activity，则退出应用程序。听起来您的 WebView 与您的 ListView 位于同一个 Activity 中，因此当您单击“返回”键时，应用程序正在退出，因为没有以前的 Activity 可以返回。

一种解决方案是创建一个新的 Activity 来显示 WebView 并传入您想要显示的数据。在单独的 Activity 中加载 WebView 后，按下“Back”按钮将完成 WebView Activity，将您带回列表。您还可以通过这种方式获得屏幕转换的额外好处。

另一种解决方案是覆盖 ListView Activity 中的 onKeyUp 方法并手动处理按下后退键。（我个人建议使用 onKeyUp 而不是 onKeyDown，因为这样可以更轻松地处理长按）捕获事件并在单击列表中的项目时撤消您正在执行的任何操作。

# sql - SQL 选择查询超时

> ID：13088501
> 
> 赞同：0
> 
> 时间：2012-10-26T14:07:26.003
> 
> 标签：sql, sql-server-2008, timeout

我的 SQL Server 2008 数据库中有一个名为**dbo.app_additional_info**的表，其中包含大约 130,000 条记录。下面显示了表的结构。

![在此处输入图像描述](../Images/cfecd3c75896170315663037bc3d2297.png)

当我在 SQL Server Management Studio 2008 中运行如下查询时

```
select app_additional_text
from app_additional_info
where application_id = 2665 --Could be any ID here 
```

我的查询需要很长时间才能执行（最多 5 分钟），有时会超时。此数据库还连接到 Web 应用程序，当它运行上述查询时，我总是收到超时错误。

我可以做些什么来加快查询的性能吗？

非常感谢您对此提供的帮助，因为这使我的 Web 应用程序停止运行。

谢谢。

**更新**

下面显示了我的 SSMS 执行计划（我为质量不佳道歉）

![在此处输入图像描述](../Images/d80f9948f824b54d1f924c5afb780c9d.png) ![在此处输入图像描述](../Images/112f7bd5437d58e4649a659164fccb03.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:39:59.623

根据问题中的有限信息，您似乎正在执行表扫描，因为 application_id 上没有索引。所以，试试这个：

```
CREATE INDEX IX_app_additional_info_application_id on 
                app_additional_info (application_id) 
```

您的查询现在应该运行得更快。

# java - Mac OSX 上的 Java 7（更新 7 和 9） - 打印小字体的小程序

> ID：13088504
> 
> 赞同：4
> 
> 时间：2012-10-26T14:07:35.253
> 
> 标签：java, applet

从 Java 7 开始，当您从 Applet 打印时，字体不再可读（超小）。屏幕上相同内容的预览不是问题，仅在打印内容时显示字体问题。

要查看此失败的实际效果，您可以使用此页面进行测试：

[https://www.peernet.com/PEERNETReportsServer3/ademos.htm](https://www.peernet.com/PEERNETReportsServer3/ademos.htm)

在本页面，：

1.  按预览按钮显示要打印的页面
2.  按“打印...”按钮，打印到任何打印机，您会看到文本信息仅打印为破折号（超小字体）。

有关如何从小程序更正 Java 7 打印的任何建议。

顺便说一句：这是使用 Java 7 的 Lion 和 Mountain Lion 上的问题，它可以在完整的 Java 应用程序以及在 Windows 和 OSX 中使用 Java 6 运行的小程序中正常工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-02T14:38:37.163

这可能与[这个问题](https://stackoverflow.com/questions/18827868/why-are-fonts-in-java-1-7-different-to-1-6)类似，尽管在这种情况下它是 mac 上的 Oracle 与 Windows 上的 oracle。听起来 Java 7 的渲染实现方式不同，并且您正在使用更小的字体。

# javascript - ExtJs grid.Panel store：加载/重新加载后保持滚动条位置

> ID：13088506
> 
> 赞同：17
> 
> 时间：2012-10-26T14:07:49.967
> 
> 标签：javascript, extjs4.1

我在 Sencha ExtJs 4.0.2a 中使用**grid.Panel**，每 60 秒重新加载一次 Json Store。

我想知道是否有办法在数据加载后保留滚动条的位置。
*这样用户就可以继续查看他在加载之前查看的记录..*

我使用任务重新加载网格中的数据：

```
var task = {
    run: function(){
        Ext.getCmp(panelGridId).getStore().load({
            //Callback function after loaded records
            callback: function(records) {
                //Hide grid if empty records
                if (Ext.isEmpty(records)) {
                    Ext.getCmp(panelGridId).setVisible(false);
                }
                else {
                    if (Ext.getCmp(panelGridId).isHidden()) {
                        Ext.getCmp(panelGridId).setVisible(true);
                        Ext.getCmp(panelGridId).doComponentLayout();
                    }
                }
            }
        });
    },
    interval: 60000 //60 seconds
};

Ext.TaskManager.start(task); 
```

数据加载后，滚动条位置重置为顶部。

**Q：**有没有办法在数据加载后保持滚动条位置？

提前致谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-30T23:25:51.750

试试这个坏男孩在刷新时保持滚动位置：

[http://docs-devel.sencha.com/extjs/4.2.1/#!/api/Ext.grid.View-cfg-preserveScrollOnRefresh](http://docs-devel.sencha.com/extjs/4.2.1/#!/api/Ext.grid.View-cfg-preserveScrollOnRefresh)

这适用于我的树视图。

```
viewConfig: {
   preserveScrollOnRefresh: true
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-12-02T09:47:49.310

以下是在 Grid 中使用**preserveScrollOnRefresh的方法：**

```
Ext.define('js.grid.MyGrid', {

    extend: 'Ext.grid.Panel',

    viewConfig: {
        preserveScrollOnRefresh: true
    } 
```

这是一个 JSFiddle，它演示了这一点：

[http://jsfiddle.net/cdbm6r0o/7/](http://jsfiddle.net/cdbm6r0o/7/)

但是，当您选择一行时，它似乎不太正常。我不确定这是否是一个错误。

'refresh' 事件由此代码触发：

```
grid.store.loadData(dataToLoad); 
```

我不知道触发“刷新”的任何其他事件

补充笔记 ：

*   我需要**Ext.toolbar.Paging**。即使我没有使用它，当我选择了一行或多行时，它也会破坏滚动保留，因此请确保从您的要求中删除分页。
*   如果我同时在桌子上使用**bufferedrenderer**插件，滚动保留似乎不起作用。
*   **tablePanel.getView().focusRow(recrow)**也很有趣，但也不适用于 bufferedrenderer。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-20T12:14:41.407

您可以使用`preserveScrollOnReload`视图配置属性：

```
viewConfig: {
    preserveScrollOnReload: true
}, 
```

# java - Java - 信号事件模式

> ID：13088507
> 
> 赞同：1
> 
> 时间：2012-10-26T14:07:57.297
> 
> 标签：java, android, actionscript-3, class, interface

我受到[AS3 中的 Signals 事件模式的](http://www.developria.com/2010/10/an-introduction-to-as3-signals.html)启发，它取代了 flash 的原生事件。它在性能和可读性方面都做得更好。

所以我试图用Java实现它。

这种模式的主要思想是您使用对象而不是类型，从而节省了查找“Dispatcher”类来处理事件调度的时间。（调度事件是将事件发送到所有侦听器）

所以让我们进入代码：在这个示例中，我将创建 AlarmManager 并处理他的警报事件。

首先我们需要为这个事件创建我们的接口

```
public interface IAlarmEvent {
    void alarmEventHandler(String alert);
} 
```

现在事件本身：

```
public class AlarmEvent extends Signal<IAlarmEvent> implements IAlarmEvent {

    public void alarmEventHandler(String alert) {
        dispatch("alarmEventHandler", alert);
    }
} 
```

这是警报管理器：

```
public class AlarmManager {

    public final AlarmEvent alarmEvent = new AlarmEvent();

    public void init(){
        // Dispatching the event
        alarmEvent.alarmEventHandler("Wake up");
    }

} 
```

这是一个正在监听此事件的 Activity：

```
public class MainActivity extends Activity implements IAlarmEvent{

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        AlarmManager alarmManager = new AlarmManager();
        alarmManager.alarmEvent.addListener(this);

        alarmManager.init();
    }

    public void alarmEventHandler(String alert) {
        Log.d("MyLog", "Event : " + alert);
    }
} 
```

这就是我编写 Signal 类的方式

```
public abstract class Signal<T> {
    private LinkedHashMap<T, T> listeners = new LinkedHashMap<T, T>();

    protected void dispatch(String methodName, Object...arguments){
        Set<T> keySet = listeners.keySet();
        if(keySet.size() == 0){
            return;
        }

        Iterator<T> iterator = keySet.iterator();

        Method method = null;
        do{
            T listener = iterator.next();
            if(method == null){
                try {
                    Class<?>[] classes = new Class<?>[arguments.length];
                    for(int i = 0; i < arguments.length; i++){
                        classes[i] = arguments[i].getClass();
                    }
                    method = listener.getClass().getMethod(methodName, classes);
                } catch (NoSuchMethodException e) {
                    e.printStackTrace();
                }
            }

            try {
                method.invoke(listener, arguments);
            } catch (IllegalArgumentException e) {
                e.printStackTrace();
            } catch (IllegalAccessException e) {
                e.printStackTrace();
            } catch (InvocationTargetException e) {
                e.printStackTrace();
            }

        }while(iterator.hasNext());
    }

    public void addListener(T listener) {
        listeners.put(listener, listener);
    }

    public void removeListener(T listener) {
        listeners.remove(listener);
    }
} 
```

这种模式是：

*   快速 - 无需搜索类型并触发 eventDispatcher，它立即完成。
*   具有很好的可读性 - 只需查看类，您就可以确切地知道他发送了哪些事件，以及每个事件的外观。

但是，它运行得不好。如果我在接口中使用原语，则 Signal 无法找到方法并调用它。而且我不喜欢将方法名称传递给信号的想法。任何想法如何改善这一点？您如何看待这种模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:41:07.073

似乎这种模式已经在这些类中实现了

```
 java.util.Observable
 java.util.Observer 
```

# c# - 检测 Ctrl + 单击按钮和单击按钮

> ID：13088511
> 
> 赞同：0
> 
> 时间：2012-10-26T14:08:02.210
> 
> 标签：c#, visual-studio-2010

`ctrl`对于按钮，如何在click事件处理程序中检测是否是+点击按钮？我正在使用 C# 使用 VS 2010。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:10:38.373

我们是在谈论 winforms、wpf 还是 asp 应用程序？我将快速假设它是winforms，所以这里是：

```
Form Form1;
button.Click += click;

private void click(object s, EventArgs e)
{
    if(Form1.ModifierKeys == Keys.Control)
    ... // Whatever you need here
} 
```

# django - Django-South 迁移期间的 ValidationError

> ID：13088512
> 
> 赞同：3
> 
> 时间：2012-10-26T14:08:08.243
> 
> 标签：django, django-models, django-south

所以，我正在学习使用 South 并且我一直在运行一些问题。我使用如下模型进行了初始应用程序迁移：

```
class Poll(models.Model):
    pass 
```

然后添加了我的字段...

```
class Poll(models.Model):
    question = models.CharField(max_length=200)
    pub_date = models.DateTimeField() 
```

在迁移过程中，南方抱怨这些字段没有默认值，所以我输入了一些但它没有用......现在当我尝试从模型中删除它们并迁移回空模式时，我得到以下回溯：

```
mirkocrocop@Mirkos-MacBook-Pro:~/workspace/toastdriven$ python manage.py migrate polls
Running migrations for polls:
 - Migrating forwards to 0007_auto__del_field_poll_question.
 > polls:0003_auto__add_field_poll_question__add_field_poll_pub_date
Traceback (most recent call last):
  File "manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/django/core/management/base.py", line 232, in execute
    output = self.handle(*args, **options)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/management/commands/migrate.py", line 108, in handle
    ignore_ghosts = ignore_ghosts,
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/migration/__init__.py", line 213, in migrate_app
    success = migrator.migrate_many(target, workplan, database)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/migration/migrators.py", line 235, in migrate_many
    result = migrator.__class__.migrate_many(migrator, target, migrations, database)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/migration/migrators.py", line 310, in migrate_many
    result = self.migrate(migration, database)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/migration/migrators.py", line 133, in migrate
    result = self.run(migration)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/migration/migrators.py", line 106, in run
    dry_run.run_migration(migration)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/migration/migrators.py", line 191, in run_migration
    self._run_migration(migration)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/migration/migrators.py", line 178, in _run_migration
    raise exceptions.FailedDryRun(migration, sys.exc_info())
south.exceptions.FailedDryRun:  ! Error found during dry run of '0003_auto__add_field_poll_question__add_field_poll_pub_date'! Aborting.
Traceback (most recent call last):
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/migration/migrators.py", line 175, in _run_migration
    migration_function()
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/migration/migrators.py", line 57, in <lambda>
    return (lambda: direction(orm))
  File "/Users/mirkocrocop/workspace/toastdriven/polls/migrations/0003_auto__add_field_poll_question__add_field_poll_pub_date.py", line 19, in forwards
    keep_default=False)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/db/sqlite3.py", line 31, in add_column
    field.column: self._column_sql_for_create(table_name, name, field, False),
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/db/sqlite3.py", line 189, in _column_sql_for_create
    sql = self.column_sql(table_name, name, field, with_name=False, field_prepared=True)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/south/db/generic.py", line 688, in column_sql
    default = field.get_db_prep_save(default, connection=self._get_connection())
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/django/db/models/fields/__init__.py", line 292, in get_db_prep_save
    prepared=False)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/django/db/models/fields/__init__.py", line 816, in get_db_prep_value
    value = self.get_prep_value(value)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/django/db/models/fields/__init__.py", line 801, in get_prep_value
    value = self.to_python(value)
  File "/Users/mirkocrocop/.virtualenvs/toastdriven/lib/python2.7/site-packages/django/db/models/fields/__init__.py", line 785, in to_python
    raise exceptions.ValidationError(msg)
ValidationError: [u"'0' value has an invalid format. It must be in YYYY-MM-DD HH:MM[:ss[.uuuuuu]][TZ] format."] 
```

我该如何解决这个问题，添加这些字段+从空模型迁移到字段填充模型的正确方法是什么？我一直在阅读 South 的文档，但我不明白...我[根据文档](http://south.readthedocs.org/en/0.7.6/tutorial/part2.html#tutorial-part-2)做了所有事情，但我不确定我应该将 DateTimeField 的默认设置为...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:30:42.963

在您必须提供默认值时，您正在与 python 解释器进行交互。如前所述，该`datetime`模块在那个时间点可用。在这种情况下，要为 a 提供默认值`DateTimeField`，只需提供一个`datetime`对象：

```
# Use the current date and time
datetime.datetime.now()
# Or a specific date and time
datetime.datetime(2012, 10, 1, 17, 30, 0, 0) 
```

# git - git stash list 或 git show ，返回 ( most +s +'/---': 1: most: not found ) 这是什么？

> ID：13088513
> 
> 赞同：3
> 
> 时间：2012-10-26T14:08:12.477
> 
> 标签：git, git-stash

不确定我是否需要升级 git 或者我有什么配置或损坏？

我可以推、拉、标记其他所有东西，只是似乎无法列出藏匿处和其他东西。如果它是一个错误（**git stash list**或**git show** return console output: " **most +s +'/---': 1: most: not found** " ），我似乎无法找到它。

我实际上可以存储和弹出项目。使用 git 版本：1.7.5.4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T15:06:32.027

您已将 git 配置为`most`用作寻呼机，但未安装该命令。要么安装它，要么选择一个不同的寻呼机。寻呼机设置可能来自`core.pager`git 配置文件之一中的设置或`$GIT_PAGER`环境变量。

# c++ - C++菱形接口继承

> ID：13088519
> 
> 赞同：3
> 
> 时间：2012-10-26T14:08:26.940
> 
> 标签：c++, interface, multiple-inheritance

我有一个层次结构：

```
class ICommand
{
    public:
        virtual void start() = 0;
};

class IExtendedCommand : public ICommand
{
    public:
        virtual void doSomethingElse() = 0;
};

class ConcreteCommand : public ICommand
{
    public:
        virtual void start() {};
}    
class ExtendedConcreteCommand : public ConcreteCommand, public IExtendedCommand
{
    public:
        virtual void doSomethingElse() {};
} 
```

工厂正在创建 ICommand 和 IExtendedCommand 对象。

由于某种原因，当编译器说所有 ICommand 的方法在 ExtendedConcreteCommand 中都是纯的...

任何想法为什么以及如何解决这个问题？

**PS：**是的，我正在将我的 Android 应用程序移植到 C++/Qt（我已经 3 年没用过了）。无论如何，我想听听你将如何应对。

**编辑：**

我正在移植的是 MPC 和 VLC 的远程控制应用程序。这个想法是创建可以通过工厂发送给玩家的命令。Factory 返回一个指向实现 ICommand 的对象的指针。因此，通过切换工厂实现可以创建不同的命令。ICommand 声明了所有主要的方法和信号。IExtendedCommand 添加了一些跨玩家的通用信息。所以我想做的是通过工厂实例化 IExtendedCommand，设置一些属性，然后使用 start() 方法启动它。另外我想重用 ConcreteCommand 的功能。这导致了我描述的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:13:52.797

你没有钻石。你有这个：

```
 +----------------------------------- missing start() !
   V
pv start()     pv doSomethingElse()     concrete doSomethingElse()

ICommand  ---> IExtendedCommand   ---\
                                      > ExtendedConcreteCommand
ICommand  ---> ConcreteCommand    ---/

pv start()     concrete start() 
```

这意味着您有**两个**type 基类`ICommand`，并且您需要覆盖它们的纯方法。但仅`ConcreteCommand`覆盖 的“底部”版本`start`，而另一个保持未被覆盖。

如果你想要一个真正的钻石，你需要通过使用虚拟继承来使`ICommand`基类成为*虚拟*`class IExtendedCommand : virtual public ICommand`的： ，同样地 for `ConcreteCommand`。`start`或者，您可以为in提供另一个覆盖器`ExtendedConcreteCommand`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:14:27.740

如果我理解你的符号，`ExtendedConcreteCommand`应该是一个具体的类，这意味着你试图做的某个地方

```
ExtendedConcreteCommand command; 
```

但是，在您上传的代码中，`ExtendedConcreteCommand`是一个纯虚拟类，因为该方法`IExtendedCommand::start()`是纯虚拟的。

实际上，菱形继承是不好的编码实践，**应该避免**。如果您坚持这样做，为避免出现编译器问题，您必须定义`IExtendedCommand::start()`. 通过将您的课程修改为

```
class IExtendedCommand : public ICommand
{
    public:
        virtual void doSomethingElse() = 0;
        virtual void start() {};
}; 
```

你的代码编译。

您也可以使用`virtual`继承。在这种情况下，您将**只有一个 的实例** `ICommand`和一颗真正的钻石。在您的示例中，您有**两个**实例`ICommand`：一个来自`IExtendedCommand`，另一个来自`ConcreteCommand`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:14:00.830

`virtual`只需从接口继承ly 即可。

这确实有运行时成本。

# dns - 已卸载 POW 服务器，但现在无法访问外部 .dev 站点

> ID：13088520
> 
> 赞同：0
> 
> 时间：2012-10-26T14:08:34.737
> 
> 标签：dns, rack-pow

我尝试了安装 Pow 的 Mac OSX 的 Anvil 服务器附件。我在尝试后决定我对它没有任何实际用途，所以运行了卸载。

除了现在我无法再访问我公司的任何 .dev 网站！在 DNS 级别，我猜 POW 仍在劫持 .dev 调用，当然会失败。

我需要从我的系统中删除该软件的所有痕迹，以便我可以访问我们所有的 .dev 站点并像往常一样进行开发。就目前而言，我现在已经死在水里了。

我在 10.8.2。我也尝试重新启动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T19:28:49.767

在撰写本文时，卸载程序中有一个错误。它留下了一个路由器文件`/etc/resolvers/dev`。我将此文件重命名为`dev1`并重新启动，问题消失了。

# matlab - 最小（x，y）对值的Matlab矩阵索引

> ID：13088523
> 
> 赞同：2
> 
> 时间：2012-10-26T14:08:38.713
> 
> 标签：matlab, indexing, minimum

我得到了一个 5 * 5 矩阵。我想找到 (i,j) 的最小值，它对应于距网格固定点的最小距离。

我用过： `MATRICE(find(MATRICE(1,:))== min(MATRICE(1,:)),:)` 和：

```
[minVal, minInd] = min(MATRICE(:,1));
MATRICE(minInd,1);
[~,MATRICE_2] = min(MATRICE(:,:)); 
```

`disp(MATRICE_2)`让我得到正确`row(i)`的 MATRICE 但`column(j)`根本不显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:35:18.097

我不确定我是否理解正确，但如果你想找到`(row,col)`数组中最小条目的索引，你可以使用这个

```
[i,j] = ind2sub(size(MATRICE), find(MATRICE==min(MATRICE(:)))) 
```

`A`你的矩阵在哪里。这通过将矩阵更改为 25 个元素的向量，查找最小值的位置，并`(row,col)`使用`ind2sub`.

您所写的内容会在矩阵的每一列中找到最少的条目。因此，中的每个`i`条目都`MATRICE_2`显示列中最小值的行索引`i`。换句话说，列和行索引是

```
cols = 1:numel(MATRICE_2);
rows = MATRICE_2; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T17:35:57.847

好的，我想通了：

```
[MinValue, MinIndex] = min(MATRICE(:));
MinSub =ind2sub(size(MATRICE), MinIndex); 
```

MinValue 是 MATRICE 的最小值，MinIndex 是它的索引加上直接指向固定点。

# wpf - 使用 XAML 资源减少重复

> ID：13088524
> 
> 赞同：3
> 
> 时间：2012-10-26T14:08:39.120
> 
> 标签：wpf, silverlight, xaml

我有一个场景，我将相同的值传递给数据模板中不同按钮的多值转换器，这一切都很好。但是想知道通过删除可重复元素来使代码更好的方法，因为我将相同的内容传递给

```
<telerik:RadButton.Visibility>
    <MultiBinding Converter="{StaticResource multiValueToBooleanConverter}" ConverterParameter="ViewCommentsDialog">
        <Binding Path="DataContext.CanEdit" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
        <Binding Path="DataContext.CanView" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
        <Binding Path="Comment"/>
        <Binding Path="ExecutionId"/>
    </MultiBinding>
</telerik:RadButton.Visibility> 
```

代码：

```
<DataTemplate>
    <StackPanel Orientation="Horizontal">
        <telerik:RadButton Margin="2" Command="{Binding DataContext.ViewCommentCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" CommandParameter="{Binding}">
            <telerik:RadButton.Visibility>
                <MultiBinding Converter="{StaticResource multiValueToBooleanConverter}" ConverterParameter="ViewCommentsDialog">
                    <Binding Path="DataContext.CanEdit" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                    <Binding Path="DataContext.CanView" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                    <Binding Path="Comment"/>
                    <Binding Path="ExecutionId"/>
                </MultiBinding>
            </telerik:RadButton.Visibility>
            <telerik:RadButton.Content>
                <Image Width="20" Height="20" Source="pack://application:,,,/Mizuho.Minar.UI.Common;component/png/Comments.png" />
            </telerik:RadButton.Content>
        </telerik:RadButton>
        <telerik:RadButton Margin="2" Command="{Binding  DataContext.AddCommentCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" CommandParameter="{Binding}">
            <telerik:RadButton.Visibility>
                <MultiBinding Converter="{StaticResource multiValueToBooleanConverter}" ConverterParameter="AddCommentDialog">
                    <Binding Path="DataContext.CanEdit" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                    <Binding Path="DataContext.CanView" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                    <Binding Path="Comment"/>
                    <Binding Path="ExecutionId"/>
                </MultiBinding>
            </telerik:RadButton.Visibility>
            <telerik:RadButton.Content>
                <Image Width="20" Height="20" Source="pack://application:,,,/Mizuho.Minar.UI.Common;component/png/Comment-Add.png" />
            </telerik:RadButton.Content>
        </telerik:RadButton>
        <telerik:RadButton Margin="2" Command="{Binding DataContext.ViewBreaksCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" CommandParameter="{Binding}">
            <telerik:RadButton.Visibility>
                <MultiBinding Converter="{StaticResource multiValueToBooleanConverter}" ConverterParameter="ViewBreaksDialog">
                    <Binding Path="DataContext.CanEdit" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                    <Binding Path="DataContext.CanView" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                    <Binding Path="Comment"/>
                    <Binding Path="ExecutionId"/>
                </MultiBinding>
            </telerik:RadButton.Visibility>
            <telerik:RadButton.Content>
                <Image Width="20" Height="20" Source="pack://application:,,,/Mizuho.Minar.UI.Common;component/png/Folder-Bug.png" />
            </telerik:RadButton.Content>
        </telerik:RadButton>
    </StackPanel>
</DataTemplate> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-29T14:32:05.797

基本上有两种非常简单的方法。

### 选项 1 - 绑定到其他属性。

您可以在其他一些依赖属性上设置您的绑定（实际上是多重绑定），然后将您的按钮可见性绑定到该属性。如果您没有此类属性的任何好的候选者，您可以使用一些简单的对象，该对象具有放置在 Resources 集合中的单个依赖项属性。这是此类对象的类代码：

```
public class VisibilityValueHolder : ValueHolder<Visibility> { }

public abstract class ValueHolder<T> : DependencyObject
{
    public static readonly DependencyProperty ValueProperty = DependencyProperty.Register(
        "Value", typeof(T), typeof(ValueHolder<T>), null);
    public T Value
    {
        get { return (T)GetValue(ValueProperty); }
        set { SetValue(ValueProperty, value); }
    }

    public ValueHolder() { }

    public ValueHolder(T value)
    {
        Value = value;
    }
} 
```

以及代码中的用法：

```
<DataTemplate>
    <StackPanel Orientation="Horizontal">
        <StackPanel.Resources>
            <common:VisibilityValueHolder x:Key="VisibilityHolder">
                <common:VisibilityValueHolder.Value>
                     <MultiBinding Converter="{StaticResource multiValueToBooleanConverter}" ConverterParameter="ViewCommentsDialog">
                        <Binding Path="DataContext.CanEdit" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                        <Binding Path="DataContext.CanView" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                        <Binding Path="Comment"/>
                        <Binding Path="ExecutionId"/>
                    </MultiBinding>
                </common:VisibilityValueHolder.Value>
            </common:VisibilityValueHolder.Value>
        </StackPanel.Resources>

        <telerik:RadButton Margin="2" Command="{Binding DataContext.ViewCommentCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" CommandParameter="{Binding}"
                Visibility={Binding Value, Source={StaticResource VisibilityHolder}}>
            <telerik:RadButton.Content>
                <Image Width="20" Height="20" Source="pack://application:,,,/Mizuho.Minar.UI.Common;component/png/Comments.png" />
            </telerik:RadButton.Content>
        </telerik:RadButton> 
```

### 选项 2 - 在 Setter 中使用带有绑定的样式

您可以声明隐式或显式样式（如果您想对所有按钮应用相同的可见性，或者只对选定的按钮应用相同的可见性）。

您的代码如下所示：

```
<DataTemplate>
    <StackPanel Orientation="Horizontal">
        <StackPanel.Resources>
            <Style TargetType="telerik:RadButton">
                <Setter Property="Visibility">
                    <Setter.Value>
                        <MultiBinding Converter="{StaticResource multiValueToBooleanConverter}" ConverterParameter="ViewCommentsDialog">
                            <Binding Path="DataContext.CanEdit" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                            <Binding Path="DataContext.CanView" RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                            <Binding Path="Comment"/>
                            <Binding Path="ExecutionId"/>
                        </MultiBinding>
                    </Setter.Value>
                </Setter>
            </Style>
        </StackPanel.Resources>

        <telerik:RadButton Margin="2" Command="{Binding DataContext.ViewCommentCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" CommandParameter="{Binding}">
            <telerik:RadButton.Content>
                <Image Width="20" Height="20" Source="pack://application:,,,/Mizuho.Minar.UI.Common;component/png/Comments.png" />
            </telerik:RadButton.Content>
        </telerik:RadButton> 
```

# asp.net - asp.net webservice返回嵌入在xml中的json ...？

> ID：13088534
> 
> 赞同：-1
> 
> 时间：2012-10-26T14:09:01.740
> 
> 标签：asp.net, xml, json, web-services

我有带有 json 返回数据的 asp.net webservice，当我调用它时，它以 json 格式返回数据，但将其嵌入到 xml 中。

[![](../Images/c5c4130089c638d09e5412eeceb30165.png)](https://i.stack.imgur.com/5r58h.jpg)

我应该在服务器端做什么来确保我的 web 服务只返回 json？

**我的 .asmx 服务如下**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.Web.Script.Services;
using System.Web.Script.Serialization;
using System.Text;
using System.Collections;
using System.IO;
using System.Xml;

[WebMethod(Description = "DemoMethod to get Total.")]
public string GetTotal(string a, string b, string c)
{
    List<Hashtable> objMyclass = new List<Hashtable>();
    JSonOutPutProperties jsonProperty = new JSonOutPutProperties();
    // 
    int total = Convert.ToInt32(a) + Convert.ToInt32(b) + Convert.ToInt32(c);
    jsonProperty.Properties.Add("Total", total);
    objMyclass.Add(jsonProperty.Properties);
    //
    JsonOutput objjson = new JsonOutput();
    objjson.objectcount = objMyclass.Count;
    objjson.objectname = "Total";
    objjson.objectvalues = objMyclass;
    //
    JavaScriptSerializer js = new JavaScriptSerializer();
    string strJSON = js.Serialize(objjson);
    return strJSON;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T11:19:34.893

如果您在方法中添加以下行，则问题可能会得到解决：

```
[WebMethod(Description = "DemoMethod to get Total.")]
[ScriptMethod(UseHttpGet = false, ResponseFormat = ResponseFormat.Json)]
public string GetTotal(string a, string b, string c)
{
    ... 
```

而且您可能必须确保您使用的是[post 而不是 get。](http://weblogs.asp.net/scottgu/archive/2007/04/04/json-hijacking-and-how-asp-net-ajax-1-0-mitigates-these-attacks.aspx). Scott Guthrie 有[另一个关于 json 的好帖子](http://weblogs.asp.net/scottgu/archive/2007/10/01/tip-trick-building-a-tojson-extension-method-using-net-3-5.aspx)

请查看以下问题[how-to-let-an-asmx-file-output-json](https://stackoverflow.com/questions/211348/how-to-let-an-asmx-file-output-json)或该帖子中的[其他链接](http://forums.asp.net/p/1327142/2652827.aspx)。我曾经遇到[过类似的问题](https://stackoverflow.com/questions/493209/calling-net-webservice-with-jquery-is-causing-woe-when-trying-to-post-data/6512404#6512404)。

# ruby-on-rails - 将 SQL 转换为 Rails 查询

> ID：13088536
> 
> 赞同：0
> 
> 时间：2012-10-26T14:09:12.510
> 
> 标签：ruby-on-rails, activerecord

如何以“Rails 方式”编写此 SQL 语句？

```
SELECT users.*, count(invitations.id) AS invitations_count 
FROM users
LEFT OUTER JOIN invitations ON invitations.sender_id = users.id
GROUP BY users.id
HAVING count(invitations.sender_id) < 5 AND users.email_address NOTNULL
ORDER BY invitations_count 
```

我应该对这些类型的查询使用 squeel gem 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T18:10:49.873

如果您只想传输 SQL，这是可用的：

```
User.find_by_sql("...") 
```

但是，如果您在命名 (invitations.user_id) 时遵循 Rails 约定，并将邀请计数存储在用户上（并在添加邀请时更新它），而不是每次都进行加入以获取它，您可以这样做：

对用户：

```
scope :emailable, where('users.email_address IS NOT NULL')
scope :low_invitations, where('users.invitation_count < 5') 
```

然后查询少于 5 个邀请和电子邮件地址的用户，按邀请数排序：

```
@users = User.emailable.low_invitations.order('invitation_count asc') 
```

然后使用以下内容访问用户的邀请：

```
@user.invitations
@user.invitations.count 
etc 
```

对于上述情况，您必须向用户添加一个invitation_count col，将sender_id 更改为user_id，并向用户模型添加一些范围。您也可以使用联接来获取计数，而无需非规范化的邀请计数。

如果您打算使用 Rails，那么遵循这些约定要比反对它们容易得多，并且您可能会发现值得设置一个小型实验性应用程序并使用关系，并阅读关联指南：

[http://guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T18:01:25.553

您需要为邀请和用户定义适当的模型，然后通过 n*1 或 n*n 关系（通过 belongs_to、has_many 等）连接它们。然后，您将能够编写代码来“在后台”生成这个或类似的查询。

使用 Rails 时，您必须停止思考 SQL，而开始思考模型、视图、控制器。

# mutt - mutt：邮件标题中的垃圾字符

> ID：13088537
> 
> 赞同：0
> 
> 时间：2012-10-26T14:09:15.677
> 
> 标签：mutt

我从源代码编译了[Mutt 。](http://www.mutt.org/)当我连接到我的 IMAP 邮箱时，一些邮件（但不是全部）的标题不正确：

```
21   F 10/19 To Someone      (0.4K)     M-b~T~LM-b~T~@>
22 r + 10/19 Someone         (1.0K)   M-b~T~LM-b~T~@>
23   F 10/19 To Someone      (0.2K) M-b~T~LM-b~T~@> 
```

mutt 版本和编译选项：

```
Mutt 1.5.21 (2010-09-15)

System: Linux 3.2.0-30-generic-pae (i686)
ncurses: ncurses 5.9.20110404 (compiled with 5.9)
hcache backend: Berkeley DB 4.8.30: (April  9, 2010)
Compile options:
-DOMAIN
-DEBUG
-HOMESPOOL  +USE_SETGID  +USE_DOTLOCK  +DL_STANDALONE  +USE_FCNTL  -USE_FLOCK
-USE_POP  +USE_IMAP  -USE_SMTP
+USE_SSL_OPENSSL  -USE_SSL_GNUTLS  -USE_SASL  -USE_GSS  +HAVE_GETADDRINFO
+HAVE_REGCOMP  -USE_GNU_REGEX
+HAVE_COLOR  +HAVE_START_COLOR  +HAVE_TYPEAHEAD  +HAVE_BKGDSET
+HAVE_CURS_SET  +HAVE_META  +HAVE_RESIZETERM
+CRYPT_BACKEND_CLASSIC_PGP  +CRYPT_BACKEND_CLASSIC_SMIME  -CRYPT_BACKEND_GPGME
-EXACT_ADDRESS  -SUN_ATTACHMENT
+ENABLE_NLS  -LOCALES_HACK  +HAVE_WC_FUNCS  +HAVE_LANGINFO_CODESET  +HAVE_LANGINFO_YESEXPR
+HAVE_ICONV  -ICONV_NONTRANS  -HAVE_LIBIDN  +HAVE_GETSID  +USE_HCACHE
-ISPELL
SENDMAIL="/usr/sbin/sendmail"
MAILPATH="/var/mail"
PKGDATADIR="/usr/local/share/mutt"
SYSCONFDIR="/usr/local/etc"
EXECSHELL="/bin/sh"
-MIXMASTER 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-29T05:28:29.657

我在这里找到了答案：http: [//dev.mutt.org/trac/wiki/MuttFaq/Charset](http://dev.mutt.org/trac/wiki/MuttFaq/Charset)

基本上出了什么问题是链接到错误的 ncurses 库。你想要的是链接`libncursesw`：

```
$ ldd `which mutt` | grep curses
libncursesw.so.5 => /lib/i386-linux-gnu/libncursesw.so.5 (0xb7752000) 
```

不只是`libncurses`。检查我的配置脚本，输出类似于：

```
checking for ncurses/ncurses.h... no
checking for waddnwstr in -lncursesw... no 
```

安装`libncursesw5-dev`（Ubuntu / Debian）后，找到了正确的库，链接到并且标题看起来很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T06:43:23.143

在尝试通过 SSH 使用 mutt 时，我遇到了与 Putty 类似的问题。解决方案是更改使用的字符集。

Putty->设置->窗口->翻译

将字符集从 ISO-8859-1 (Latin-1) 更改为 UTF-8。

顺便说一句，同一页面也有关于 Putty 如何处理画线字符的设置，但这对我没有任何作用。

# windows-xp - 在 Windows XP 上更新 MonoDevelop 3.0.3.5

> ID：13088542
> 
> 赞同：1
> 
> 时间：2012-10-26T14:09:25.053
> 
> 标签：windows-xp, monodevelop

我刚刚在 Windows XP VM 上安装了 Monodevelop 3.0.3.2，但尝试更新时出现错误：

![在此处输入图像描述](../Images/00c9da59df173f17d34820f7486e19b2.png)

Windows XP 是否支持 MonoDevelop 3？我会从源头构建更多成功吗？

# php - 如果在 int 和 int 之间，则显示行

> ID：13088545
> 
> 赞同：0
> 
> 时间：2012-10-26T14:09:39.313
> 
> 标签：php, if-statement

好吧，我已经搞砸了大约 6 个小时，但我无法让它正常工作。我确定这只是我在做的一些愚蠢的事情，也许你们的新鲜眼睛可以指出这一点。

```
$i = 0;
$sql = mysql_query("SELECT type, info, url FROM alerts WHERE username = '$user_logged_in' ORDER BY id ASC LIMIT 40");
$div_grid = '<div style="float:left;">';

while ($row = mysql_fetch_array($sql))
{
    if ($i < 11){
    $display = '<a href="' . $row['info'] . '"><div class="' . $row['type'] . "_alert" . '" style="float:left; margin-left:-22px;"></div></a>';

    $div_grid .='<div style="float:left;">' . $display . '</div>';
    $i++;
    } 
    if ($i > 11){
        $display = '<a href="' . $row['info'] . '"><div class="' . $row['type'] . "_alert" . '" style="float:left; margin-left:-22px; margin-top:14px;"></div></a>';

    $div_grid .='<div style="float:left;">' . $display . '</div>';
    $i++;
    }

}
$div_grid .= '</div>';

echo $div_grid; 
```

出于某种原因，我得到了这些 div 输出的整个第一行，但第二行没有出现。除非我设置 $i >= 11{ 然后给我两个 id 11s。显然我在这里遗漏了一些重要的东西。有任何想法吗？

另外，最后，我想让 if 语句 >= 10 && <= 20; 到目前为止似乎还没有起作用，但我猜首先在其他地方存在问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:13:22.290

您`$i`在两个`if`语句中都在递增。什么时候`$i`是 10，它增加到 11。但是你的第二`if`个大于 11，这意味着它`$i`必须是 12，并且没有任何地方`$i`增加。

两个建议：

1.  增加`$i`外部`if`的
2.  做`if {} else {}`声明

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:13:54.503

你增加`$i++`了两次。它也是必要的，`>=`因为否则您将丢失第 11 行，并且循环将在没有输出的情况下运行 ( `$1==11`，因此它不小于或大于 11)，直到记录集结束。

```
while ($row = mysql_fetch_array($sql)) {
    if ($i < 11){
        // first row
    } else {
        // second row
    }
    $i++; //increment
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:21:15.563

一些重构可以帮助你更清楚地看到你的代码。

```
$i = 0;
$sql = mysql_query("SELECT type, info, url FROM alerts WHERE username = '$user_logged_in' ORDER BY id ASC LIMIT 40");
$div_grid = '<div style="float:left;">';

while ($row = mysql_fetch_array($sql))
{
    $displayStyle = 'float:left; margin-left:-22px;';

    if ($i > 11) $displayStyle .= ' margin-top:14px;';

    $display = '<a href="' . $row['info'] . '"><div class="' . $row['type'] . "_alert" . '" style="' . $displayStyle . '"></div></a>';
    $div_grid .='<div style="float:left;">' . $display . '</div>';
    $i++;

}

$div_grid .= '</div>';

echo $div_grid; 
```

if/elseif 块中的大部分代码都是重复的。提取相似之处并仅在 if 语句中存在差异最终会大大简化事情。

# linux - uint32_t 或 uint64_t 用于 linux 计数器

> ID：13088550
> 
> 赞同：0
> 
> 时间：2012-10-26T14:09:51.080
> 
> 标签：linux

我正在研究一个 Linux 计数器，它应该计算迄今为止（以及将来）所有已安装的 Linux 机器（所有基于 linux 内核的，包括 Android 等）。这是我所拥有的：

```
#include <stdint.h>

int main(int argc, char ** argv)
{
     uint32_t num_linux_machines = count_current_linux_machines();

     while (1) {
        wait_for_next_linux_machine_installed();
        num_linux_machines++;
     }
} 
```

不用担心`count()`and`wait()`函数，我稍后会做。问题是：您认为这`uint32_t`对于接下来的（比如 5 年）是否足够，还是我应该立即使用`uint64_t`？感谢您的任何见解；）

更难回答的真正问题是如何实现这两个缺失的功能（即使用哪种启发式方法）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:16:22.773

一个 64 位计数器只消耗 4 个额外的字节，为什么不呢？这不像多 4 个字节会使程序膨胀。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T13:14:46.483

根据[这个故事](http://news.yahoo.com/total-shipments-android-phones-surpass-1-billion-2013-230036024.html)，Uint32 将在 2017 年左右溢出。

# java - 无法使用 JSON 和 JQuery 显示从 Spring MVC 控制器返回的响应

> ID：13088552
> 
> 赞同：1
> 
> 时间：2012-10-26T14:10:03.210
> 
> 标签：java, jquery, json, jsp, spring-mvc

我有一个简单的`JQuery`函数调用我的`Spring MVC`控制器：

```
function createDatabaseRecord() {
    if (isFormValid()) {
        $.getJSON(
                "${pageContext.servletContext.contextPath}${databaseConfigUrl}",
                {name:$('#idName').val(),
                    databaseName:$('#idDatabaseName').val(),
                    hostName:$('#idHostName').val(),
                    username:$('#idUsername').val(),
                    password:$('#idPassword').val()},
                function (data) {
                    var html = '<span>' + data + '</span>';
                    $('#idMessage').html(html);
                }
        );
    }
} 
```

当我单击按钮时调用该函数，一切都很好。问题是这条线：`$('#idMessage').html(html);`没有按预期工作。我`<div>`在同一`JSP`页面中有一个元素。

```
<div id="idMessage">
</div> 
```

我的 Spring 控制器方法由该函数调用：

```
@RequestMapping(value = DATABASE_CONFIG_RECORD_MAPPING, method = RequestMethod.GET)
public
@ResponseBody
String createDatabaseConfiguration(@RequestParam(value = "name", required = true) String name,
                                   @RequestParam(value = "databaseName", required = true) String databaseName,
                                   @RequestParam(value = "hostName", required = true) String hostName,
                                   @RequestParam(value = "username", required = true) String username,
                                   @RequestParam(value = "password", required = true) String password) {
    try {
        DatabaseConfig config = new DatabaseConfig();
        config.setName(name);
        config.setDatabaseName(databaseName);
        config.setHostName(hostName);
        config.setUsername(username);
        config.setPassword(password);
        configService.save(config);
    } catch (Exception ex) {
        LOGGER.error("Exception while create database configuration record.", ex);
        return "Error occurred while creating database configuration record: " + ex.getMessage();
    }
    return "Database configuration record successfully created.";
} 
```

我可以在 FireBug 中看到对我的响应：

![在此处输入图像描述](../Images/b2893144b7ef07be36bf7d0affff8922.png). 这是消息：已**成功创建数据库配置记录。**我希望在该`<div>`元素中显示，但未显示。有人知道问题出在哪里吗？如果您需要更多代码，请询问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:18:32.607

我绝对不是 Java 专家（虽然它看起来不错），但认为您的问题来自您使用 jQuery 的`getJSON`方法但您的视图只是返回纯文本这一事实。

您需要将响应转换为 JSON，或者使用 or 切换到更手动的 AJAX`$.get`请求`$.ajax`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:23:28.947

您的回复不是 JSON 格式。

在您的控制器中尝试此代码段：

```
return Collections.singletonMap("result", "Database configuration record successfully created"); 
```

并像这样在javascript中使用它：

```
var html = '<span>' + data.result + '</span>'; 
```

# php - 相对路径：向下和向上

> ID：13088553
> 
> 赞同：3
> 
> 时间：2012-10-26T14:10:06.590
> 
> 标签：php, include, relative-path

我有一堆目录，但在包含一些文件时遇到了麻烦。这是我的结构。

> 索引.php
> 
> 维安/维安.php
> 
> 包括/整体/head_content.php
> 
> 包括/整体/head.php

这是我的`head_content.php`。

```
testing text
<?php include 'includes/overall/head.php'; ?>
<div class="wrapper row3">
    <div id="container" class="clear"> 
        <div id="content"> 
```

我想将该文件包含在`vian/vian.php`

我使用`'../includes/overall/head_content.php';`，并且自从出现“测试文本”以来，路径就可以工作。但它不能包括`includes/overall/head.php`. 我隐约明白为什么它不起作用，但我不知道如何解决它。

`'../includes/overall/head_content.php';`用于我的所有页面，包括`index.php`位于我的根目录中的 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:19:27.347

在你的结构中：

```
 + index.php
 + vian
 |  ` vian.php
 ` includes
    + overall
        + head_content.php
        ` head.php 
```

每个文件与另一个文件都有特定的关系。因此，您可以使用从一个文件到另一个文件的相对链接。

在 PHP 中的帮助是[`__DIR__`魔法常数](http://php.net/language.constants.predefined)。它自动包含每个文件中的目录。您可以使用它来使相对路径成为绝对路径。绝对路径非常健壮。

例子：

*   从*index.php*到*includes/overall/head.php*：
    `__DIR__ . '/includes/overall/head.php'`
*   从*include/overall/head.php*到*vian/vian.php*：
    `__DIR__ . '/../../vian/vian.php'`
*   从*includes/overall/head_content.php*到*includes/overall/head.php*：
    `__DIR__ . '/head.php'`

等等等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:18:57.030

尝试

```
<?php include 'head.php'; ?> 
```

# gxt - 调整容器大小时允许滚动条

> ID：13088555
> 
> 赞同：0
> 
> 时间：2012-10-26T14:10:18.890
> 
> 标签：gxt

我正在使用 GWT 2.3.0 和 GXT 2.2.5 开发应用程序。

我有一个 LayoutContainer，其 ScrollMode 设置为 AUTO，布局设置为 RowLayout，水平方向。它用作我的应用程序的显示窗口。

问题是当浏览器调整大小以显示垂直滚动条时，内容不会调整大小以解决它，导致即使不需要水平滚动条也会出现。

有没有办法让布局在渲染小部件时考虑滚动条占用的空间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T09:48:32.393

好的，这有点棘手。我会这样做：在入口点（以便您知道它始终处于活动状态）向窗口添加调整大小处理程序

```
Window.addResizeHandler(new ResizeHandler() {
    @Override
    public void onResize(ResizeEvent event) {
         // Fire Event containing the new size informing the application of the change
         // Or resize the Layout container
    }
} 
```

如果您选择触发事件并且您使用的是 MVP 模式，那么通过事件总线触发事件并在应用程序中您喜欢的任何位置捕获它是非常简单的。

这里唯一的问题是您可能希望在`onResize()`计时器内运行函数，因为在许多情况下报告的窗口宽度/高度不是最终值，因为在调整大小完成之前触发了事件。

# ant - Ant 构建脚本没有看到 refid

> ID：13088556
> 
> 赞同：2
> 
> 时间：2012-10-26T14:10:21.957
> 
> 标签：ant, build, reference

我有一个 build.xml 文件，其中包含一个定义一些 refid 值的 common.xml 文件。但是，我的任务看不到 refid 值。我无法在网上找到解决方案，正在寻求帮助。

我在 build.xml 文件中调用 genbeans 目标。它在 xmlbean taskdef 上失败，并显示消息 Reference my_classpath_jars not found。

构建.xml

```
----------------------------
[includes common.xml]

**my_classpath_jars fails to be seen at this point - defined in common.xml**

    <taskdef name="xmlbean" classname="org.apache.xmlbeans.impl.tool.XMLBean">
        <classpath refid="my_classpath_jars"/>
    </taskdef>

    <!-- Generate the XMLBeans java code from our source XSD file(s) -->
    <target name="genbeans" description="Generate XML Bean files" depends="build_my_jar_cpath">
        <mkdir dir="${lib}"/>
        <xmlbean destfile="${lib}/${appname}Beans.jar" failonerror="true">
            <classpath refid="my_classpath_jars"/>
            <fileset dir="src/XSD Files" includes="*.xsd, *.wsdl"/>
        </xmlbean>
    </target>

common.xml
-----------------------------
  <target name="build_my_jar_cpath">
    <path id="my_classpath_jars">
      <fileset dir="${jardir}"  includes="**/*.jar" />
    </path>
    <pathconvert pathsep="${path.separator}" property="myjar.clpath" refid="my_classpath_jars"/>
  </target> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T18:34:20.173

如有疑问，请`ant -d`在呼叫目标时使用开关。你会看到大量的输出。将其保存到文件并解析它。

这样做，你会在输出中注意到的第一件事是它`taskdef`**在**你定义你的`my_classpath_jars`. 该`my_classpath_jars`refid 仅在您调用该`greenbeans`目标时设置。`<taskdef>`在调用任何目标之前执行您的。

要么`my_classpath_jars`从目标中取出定义，`greenbeans`要么把你的定义放在`<taskdef>`那里。

# visual-studio-2010 - 如何将dll复制到lib文件夹并将exe复制到bin文件夹并使其仍然有效？

> ID：13088564
> 
> 赞同：2
> 
> 时间：2012-10-26T14:10:54.010
> 
> 标签：visual-studio-2010

理想情况下，我们希望我们的自动构建（使用 jenkins 调用 build.bat，它现在调用 msbuild）以包含这些文件夹的 zip 文件结束

*   product/bin - 包含启动程序的 exe 文件
*   product/lib - 包含 exe 所需的 dll 文件
*   product/conf - 包含配置文件

如何让 Visual Studio 将所有文件放在正确的位置，以便 exe 仍然可以正常工作，因为现在 dll 似乎必须在同一个文件夹中才能工作:( :(。我不想在 GAC 中安装 dll。我只想要上面的结构，以便用户可以立即解压缩并运行程序。

当我在调试模式下运行以及在 Visual Studio 外部运行构建时，我希望它能够在 Visual Studio 中工作（如果需要，我可以在 build.bat 中轻松地添加压缩）。

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:12:07.843

您需要处理`AppDomain.AssemblyResolve`事件并`Assembly.Load`使用目录路径进行调用`lib`。

请注意，您必须在 JIT 使用您需要加载的程序集中类型的任何方法或类之前添加处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-02T09:50:23.750

您可以在 app.config 文件中使用“探测”。
[https://msdn.microsoft.com/en-us/library/823z9h8w(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/823z9h8w(v=vs.110).aspx)
我刚刚测试过，它可以工作。

# jquery - 调整颜色框大小以适应屏幕宽度

> ID：13088565
> 
> 赞同：0
> 
> 时间：2012-10-26T14:10:55.590
> 
> 标签：jquery, mobile, resize, colorbox, responsive-design

当用户首次访问页面（使用 cookie）时，我使用颜色框打开。该框包含 520x520 图像。我的CSS如下：

```
#hunger-count{
padding: 5px;
overflow: hidden;
}

#hunger-count img{
width: 100%;
height: auto;
} 
```

函数调用：

```
if (visited == null) {
        $.cookie('visited', 'yes'); 
        $.colorbox.settings.height = 560;
        $.colorbox.settings.width = 520;
        $.colorbox({html:"<div>...</div>"});
} 
```

我希望它们是 maxWidth 和 maxHeight，并将宽度设置为屏幕的 80% 左右。这里的问题是，根据我设置的高度百分比，图像在不同设备上的倾斜很有趣。我有一部华为安卓手机，当我在手机上设置好的高宽比时，在 iPhone 上看起来很有趣，反之亦然。设置 80% 的宽度和自动高度得到了相同的结果。

关于我如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T15:15:36.730

Why you don't use:

```
$.colorbox({html:"<div>...</div>", width: '100%' }); 
```

to fit screen?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-23T11:25:39.650

您可以设置颜色框参数

```
innerWidth:'80%', innerHeight:'80%' 
```

如果您使用 colorbox 作为 iframe。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-14T14:00:54.097

我开发了一个小东西，可以让我的 iFrame 保持 16/9 比例的彩盒视频。我从[Find the exact height and width of the viewport in a cross-browser way (no Prototype/jQuery)](https://stackoverflow.com/questions/1766861/find-the-exact-height-and-width-of-the-viewport-in-a-cross-browser-way-no-proto)中获取了一个函数来获取视口尺寸并使用它们来计算我的颜色框尺寸。我选择只在页面加载而不是页面调整大小时进行此计算。如果您不希望它的宽度大于 520px，那么可能会出现这样一种情况，如果视口比 520 宽，则为 520 宽度，如果小于 520，则为视口宽度的 80%，然后将高度设为相同的。查看下面的代码示例：

```
function getViewport() {
    var viewPortWidth;
    var viewPortHeight;
    // the more standards compliant browsers (mozilla/netscape/opera/IE7) use window.innerWidth and window.innerHeight
    if (typeof window.innerWidth != 'undefined') {
      viewPortWidth = window.innerWidth,
      viewPortHeight = window.innerHeight
    }
    // IE6 in standards compliant mode (i.e. with a valid doctype as the first line in the document)
    else if (typeof document.documentElement != 'undefined'
    && typeof document.documentElement.clientWidth !=
    'undefined' && document.documentElement.clientWidth != 0) {
        viewPortWidth = document.documentElement.clientWidth,
        viewPortHeight = document.documentElement.clientHeight
    }
    // older versions of IE
    else {
        viewPortWidth = document.getElementsByTagName('body')[0].clientWidth,
        viewPortHeight = document.getElementsByTagName('body')[0].clientHeight
    }
    return [viewPortWidth, viewPortHeight];
}    
var viewPortDim = getViewport();
var viewPortWidth = viewPortDim[0];
var viewPortHeight = viewPortDim[1];

//colorbox init
var colorboxWidth = 520;
if (viewPortWidth < 520) {
    colorboxWidth = viewPortWidth * 0.8;
}
//now initialize colorbox in your square ratio (your image is 520x520)
$('a.lightboxVid').colorbox({
    iframe: true, 
    innerWidth: colorboxWidth, 
    innerHeight: colorboxWidth
}); 
```

# android - 安卓服务生命周期

> ID：13088568
> 
> 赞同：3
> 
> 时间：2012-10-26T14:11:11.090
> 
> 标签：android, service, lifetime

我的问题是。

在 Android 中有一种方法可以创建一个服务，即使您重新启动手机也可以保持活动状态，直到它不执行其任务，

例如报警应用。如果您重新启动手机，它将被触发而没有任何问题。

在 android 所有服务的行为都是这样，还是我们有一些解决方案？

请详细解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:23:11.840

这将需要两个步骤：

（1）首先创建一个BroadcastReceiver，并在这个接收器的onReceive()方法中启动服务：

```
 public class MyReceiver extends BroadcastReceiver {

     @Override
     public void onReceive(Context context, Intent intent) {
        Intent service = new Intent(context, YourService.class);
        context.startService(service);
     }
  } 
```

(2) 现在像这样在清单中标记这个接收器：

```
 <receiver android:name=".MyReceiver" >
        <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED" />
        </intent-filter>
    </receiver> 
```

这样，即使手机重新启动，您的服务也将始终运行并启动。有关更多详细信息，请参阅此链接：

[http://www.vogella.com/articles/AndroidServices/article.html](http://www.vogella.com/articles/AndroidServices/article.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:24:36.527

> 有没有办法创建一个即使你重启手机也能保持活力的服务

不会。关闭手机时，所有正在运行的服务都会被终止。

> 例如报警应用。如果您重新启动手机，它将被触发而没有任何问题。

是的，但这并不是因为服务还活着。这是因为警报应用程序会响应`android.intent.action.BOOT_COMPLETED`意图。

您可以做的是创建一个响应此意图并启动您的服务的 BoradcastReceiver。

问题是用户可以手动终止此服务。如果你想建立一个闹钟，你不应该**让**服务总是在后台运行。

您应该使用[AlarmManager](https://developer.android.com/reference/android/app/AlarmManager.html)和[PendingIntent](https://developer.android.com/reference/android/app/PendingIntent.html)。

清单中的内容：

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />

<receiver
    android:name=".broadcasts.InitReceiver"
    android:exported="false" >
    <intent-filter>
        <action android:name="android.intent.action.BOOT_COMPLETED" />
        <action android:name="android.intent.action.TIME_SET" />
        <action android:name="android.intent.action.TIMEZONE_CHANGED" />
    </intent-filter>
</receiver> 
```

像这样的广播。

```
public class InitReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {

            // Schedule your alarms again.

    }
} 
```

你应该安排这样的警报：

```
Intent intent = new Intent(context, Ring.class);
intent.setData(alarmUri);

PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, intent, PendingIntent.FLAG_CANCEL_CURRENT);

AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
alarmManager.set(AlarmManager.RTC_WAKEUP, ringTime, pendingIntent ); 
```

`Ring`处理警报响铃的广播在哪里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:21:48.280

查看[服务文档](http://developer.android.com/guide/components/services.html)。您需要[START_STICKY](http://developer.android.com/reference/android/app/Service.html#START_STICKY)标志，如果它因内存不足等原因而终止，它将使系统重新启动您的服务。

处理设备重启...

**显现**

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />

    <service
        android:name=".BootService"
        android:label="Boot Service" >
        <intent-filter>
            <action android:name="com.my.package.BootService" />
        </intent-filter>
    </service>

    <receiver
        android:name=".receiver.BootReceiver"
        android:enabled="true"
        android:exported="true"
        android:label="Boot Receiver" >
        <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED" />
        </intent-filter>
    </receiver> 
```

**资源**

```
public class BootReceiver extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    Log.d(this.getClass().getName(), "Boot Receiver onReceive()");
    if ("android.intent.action.BOOT_COMPLETED".equals(intent.getAction())) 
    {
        // Fire up your service.
        Intent serviceIntent = new Intent("com.my.package.BootService");
        serviceIntent.putExtra(Constants.BOOT_LAUNCH_EXTRA, true);
        context.startService(serviceIntent);
    }
}

}

public class BootService extends IntentService {

public BootService()
{
    super("BootService");
}

@Override
protected void onHandleIntent(Intent intent) {
    Log.d(this.getClass().getName(), "Boot Service onHandleIntent()");
    if(intent.hasExtra(Constants.BOOT_LAUNCH_EXTRA))
    {
                 //...
    }
}

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T14:23:17.620

> 在 Android 中有一种方法可以创建一个服务，即使您重新启动手机也可以保持活动状态，直到它不执行其任务，

不，如果我们从字面上解释您的请求。当您重新启动设备时，所有进程都将终止，就像您关闭设备时所有进程都将终止一样。

> 例如报警应用。如果您重新启动手机，它将被触发而没有任何问题。

这是因为“警报应用程序”在启动时通过 获得控制权`ACTION_BOOT_COMPLETED` `BroadcastReceiver`，并使用 重新安排警报`AlarmManager`。

类似地，实现下载队列的服务将在启动时通过 获得控制权，`ACTION_BOOT_COMPLETED` `BroadcastReceiver`此时它将确定还需要下载什么并返回该工作。

# java - 如何使用提供的密钥库对 jar 文件进行签名

> ID：13088569
> 
> 赞同：2
> 
> 时间：2012-10-26T14:11:10.683
> 
> 标签：java, security, applet, signing

我的客户给了我一个用于签署 Java 小程序 jar 文件的密钥库。我从中导出了一个 .cer 文件，然后将其导入 cacerts，但我不断收到“找不到证书链”错误。它还说“别名必须引用包含私钥和相应公钥证书链的有效 KeyStore 密钥条目。”

我在下面尝试了 Gaston 的建议，结果如下：

```
jarsigner -keystore "D:\My Documents\keystore\MyKeyStore.jks" -storepass mypass -signedjar my_signed_jar.jar" unsigned.jar myalias

Warning:
The signer's certificate chain is not validated. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T20:14:27.347

整个情况无效。

1.  您应该使用自己的私钥签署 JAR 文件，而不是其他人的。

2.  您的客户通过泄露他的私钥犯下了**重大安全漏洞。**

3.  您提到的未验证签名者证书链的问题完全是客户的问题。他提供了证书：其有效性完全取决于他。

不是你的问题，但根本不是真正的问题，因为整个情况都是无效的。您应该使用自己的证书签署自己的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:40:14.393

如果您只想从密钥库签署 jar，则应在命令行中运行以下命令：

%JAVA_HOME%\bin\jarsigner -keystore YOUR_KEY_STORE.ks -storepass KS_PASS YOUR_JAR KS_ALIAS

我希望它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T23:55:07.020

> 我从中导出了一个 .cer 文件，然后将其导入 cacerts，但我不断收到“找不到证书链”错误。

当然，不会找到该链:) 您**不应该导出**它，因为要签署一个 jar，但您必须使用原始密钥库密钥 - 生成证书的密钥......

如果您拥有所有权限作为密码等，您应该使用客户端给您的原始密钥库密钥来签署 jar。接下来，您必须使用[jarsigner](http://docs.oracle.com/javase/1.3/docs/tooldocs/win32/jarsigner.html)常用命令，例如

```
jarsigner -keystore C:\working\mystore -storepass myspass
      -keypass dukekeypasswd MyJarFile.jar duke 
```

PS>

请报告是否有帮助

# sql-server - Microsoft Project REAL - SSAS 连接

> ID：13088573
> 
> 赞同：0
> 
> 时间：2012-10-26T14:11:32.690
> 
> 标签：sql-server, ssas

我正在使用 SQL Server 2008 R2 设置 Microsoft Project REAL。

附加关系数据库并创建 olap 多维数据集后，我无法处理它，因为它报告 OLE DB 连接失败。

我可以将我自己的用户连接到两者，但在我的用户下处理会产生相同的结果。

哪些用户需要运行 Analysis Services，是否有我应该使用的模拟模式？

本地服务下的 SQL Server 代理 本地服务下的分析服务

# java - 将对象传递给 SOAPHandler 而无需在 JAX-WS 中进行强制转换

> ID：13088578
> 
> 赞同：0
> 
> 时间：2012-10-26T14:11:44.170
> 
> 标签：java, spring, soap, jax-ws

我正在寻找一种在客户端将对象传递给我的 SOAPHandler 而不将我的 Port 对象转换为 BindingProvider 以获取请求上下文的方法。通常你会看到如下代码：

```
Map<String,Object> requestContext = ((BindingProvider)port).getRequestContext();
requestContext.put("key", object); 
```

处理程序中的代码如下所示：

```
public boolean handleMessage(SOAPMessageContext context) {
    Boolean isRequest = (Boolean) context.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY);

    if (isRequest) {
        // Do stuff to SOAP header based on "object"
    }
    return true;
} 
```

我不喜欢强制转换，因为我使用 Spring 的 AOP 来包装来自客户端 Port 对象的调用，并且强制转换会导致错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T16:44:29.670

您使用的是 2.5.6 之前的 spring 版本吗？如果是这种情况，您可能只需要升级 spring。此[更改日志](https://src.springframework.org/svn/spring-maintenance/trunk/changelog.txt)显示他们在 2.5.6 版中添加了对 BindingProvider 接口的支持。

# rake - ruby rake rspec simplecov....再次

> ID：13088582
> 
> 赞同：1
> 
> 时间：2012-10-26T14:12:08.217
> 
> 标签：rake, code-coverage, ruby-1.9

我很难找到一个关于如何将 simplecov 与 rake/rspec 一起使用的简单示例。

这是我设置的仓库： [https ://github.com/stensonb/simplecov-playground](https://github.com/stensonb/simplecov-playground)

如果你克隆它，然后“捆绑安装”、“rake 覆盖”，你会看到 0/0 LOC ......这令人失望。

由于项目现在（8e5fa35983），我预计会有 0/XX LOC（其中 XX 是我拥有的实际代码行......显然超过零 - 看看 /lib/mytest.rb）

我尝试过的事情：

1.  将“require 'simplecov'”和“SimpleCov.start”添加到我的spec_helper.rb
2.  将组添加到 simplecov 配置

有人对如何让这个东西工作有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T15:50:57.557

解决了！

我缺少的主要项目是在我的测试中“需要”我的 lib 文件。

我曾假设 simplecov 会通过查看目录结构来提取我的所有文件……但这似乎没有发生。它只会评估显式加载到类路径中的代码（使用java术语）......我假设使用“requires”或“load”或“include”。

我将在今天晚些时候将我的解决方案推回到这个 github 位置。

# asp.net-mvc - 在局部视图中加载 MVC 错误页面

> ID：13088593
> 
> 赞同：2
> 
> 时间：2012-10-26T14:13:02.040
> 
> 标签：asp.net-mvc, error-handling, partial-views

我有一个错误页面，其布局在大多数情况下都可以正常工作，但是当返回部分视图的控制器中出现错误时，错误页面及其布局被放置在部分视图中。我想这是合乎逻辑的，但我希望将错误页面作为整页加载。如何在不更改所有错误处理的情况下实现这一点。

网络配置：

```
<customErrors mode="On" defaultRedirect="~/Error">
  <error statusCode="500" redirect="~/SystemPages/ErrorPage" />
  <error statusCode="403" redirect="~/SystemPages/FileNotFound" />
  <error statusCode="404" redirect="~/SystemPages/FileNotFound" />
</customErrors> 
```

全球.asax：

```
Shared Sub RegisterGlobalFilters(ByVal filters As GlobalFilterCollection)
    filters.Add(New HandleErrorAttribute())
End Sub 
```

基础控制器：

```
Protected Overrides Sub OnException(ByVal filterContext As ExceptionContext)

    If filterContext Is Nothing Then Return

    If TypeOf (filterContext.Exception) Is FaultException Then
        Dim CodeName As String = 
        CType(filterContext.Exception, FaultException).Code.Name
        Dim Message As String = CType(filterContext.Exception, FaultException).Message
        TempData("ErrorMessage") = Message
    Else
        Logging.LogDebugData(HamtaDebugInformation(filterContext.RouteData))
        Logging.WriteExceptionLog(filterContext.Exception)
        TempData("ErrorMessage") = filterContext.Exception.Message
    End If

    Response.Redirect("/SystemPages/ErrorPage")

End Sub 
```

搜索控制器：

```
 Function GetData() As ActionResult
   ...
   Return PartialView("_Tab", vmData) 
```

错误页面：

```
@Code
ViewData("Title") = "ErrorPage"
Layout = "~/Views/Shared/_Layout.vbhtml"
End Code

<div id="mainContent" class="oneColumn">
<div class="panel">
    <span class="panelTLC"></span>
    <span class="panelTRC"></span>
    <div id="inputPanel" class="panelContent">
        <div class="modul">
            <div class="modulHead">
                <span class="TLC"></span>
                <span class="TRC"></span>
            </div>
            <div class="modulContent">
                <span class="TLC"></span><span class="TRC"></span>
                <p>@ViewBag.ErrorMessage</p>
                <p>@TempData("ErrorMessage")</p>
                <span class="BLC"></span>
                <span class="BRC"></span>
            </div>
        </div>
    </div>
    <span class="panelBLC"></span><span class="panelBRC"></span>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T19:52:57.213

您可以只使用 try catch 块并在 catch 中返回 View() 而不是 PartialView()。

```
Function GetData() As ActionResult
Try
...
Return PartialView("_Tab", vmData)
Catch ex as Exception
//Handle exception here ( send to error log, etc)
Return View("~/SystemPages/ErrorPage")
End Try 
```

或者

网络配置：

```
<customErrors mode="On"/> 
```

基础控制器：

```
Protected Overrides Sub OnException(ByVal filterContext As ExceptionContext)

    If filterContext Is Nothing Then Return

    Dim Message As String

    If TypeOf (filterContext.Exception) Is FaultException Then
        Dim CodeName As String = 
        CType(filterContext.Exception, FaultException).Code.Name
        Message = CType(filterContext.Exception, FaultException).Message
    Else
        Logging.LogDebugData(HamtaDebugInformation(filterContext.RouteData))
        Logging.WriteExceptionLog(filterContext.Exception)
        Message = filterContext.Exception.Message
    End If

    Response.Redirect(String.Format("~/Error/HttpError/?message={1}", "HttpError", Message))

End Sub 
```

错误控制器：

```
public class ErrorController : Controller
{
    // GET: /Error/HttpError
    public ActionResult HttpError(string message) {
       return View("ErrorTest", message);
} 
```

这篇文章：[ASP.NET MVC 自定义错误处理 Application_Error Global.asax？](https://stackoverflow.com/questions/1171035/asp-net-mvc-custom-error-handling-application-error-global-asax)

进入如何分别处理每种类型的错误。请记住，您是在 basecontroller 而不是 global.asax 文件中处理异常。如果您能够更改异常处理，那将是更好的方法。

# javascript - .aspx 页面中的 if 语句

> ID：13088597
> 
> 赞同：2
> 
> 时间：2012-10-26T14:13:12.310
> 
> 标签：javascript, html

我试图在我的 .aspx 页面上的某些 Javascript 中包含 If 语句。

我在页面开头声明 FinishedPacking 为 False。然后，当用户单击 orderSubmit 按钮时，if 语句会评估该值是否确实为 false，如果是，则显示警报。到目前为止，if 语句不起作用。如果我只使用没有 if 语句的警报，它会显示警报：

```
 var FinishedPacking = false;

    $("#orderSubmit").click(function (e) {
       if (FinishedPacking = false) {
       alert("The order is not finished.")
       }
       ClearScreen();
       GetOrder();
    }): 
```

如前所述，如果我不包含 if 语句，则当我单击订单按钮时​​警报会起作用。不知道为什么没有选择这个简单的 If 语句。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T14:14:28.950

你需要双等号

`if (FinishedPacking = false)`

应该

`if (FinishedPacking == false)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:14:51.623

试试这个

```
var FinishedPacking = false;

$("#orderSubmit").click(function (e) {
   if (FinishedPacking == false) {
   alert("The order is not finished.")
   }
   ClearScreen();
   GetOrder();
}): 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T14:15:30.370

你需要 2 个 = 的符号

```
if (FinishedPacking == false) { 
```

您正在尝试将 false 分配给您想要比较值的条件（这是错误的）中的变量 FinishedPacking。

# c++ - c++ 中是否有任何查询库

> ID：13088600
> 
> 赞同：0
> 
> 时间：2012-10-26T14:13:26.033
> 
> 标签：c++, map

如果我有一些属性的表（例如 5）。

```
Property1   Property2  Property3 Property4 Property5
ex11        ex12        ex13     ex14       ex15
ex21        ex22        ex23     ex24       ex25
ex31        ex32        ex33     ex34       ex35 
```

所有这些属性都是不同的类型。是否有任何好的方法或好的库，以便如果我们有任何属性的任何示例，那么可以在有效的时间内获取示例的所有其他属性。

例如：

```
Property2Of(ex31);
Property4of(ex31); 
```

上面的调用应该返回它们各自的属性，并且只有 property1 是唯一的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:06:55.430

您可以使用 Boost.MultiIndex。它应该是相当有效的。 [http://www.boost.org/doc/libs/1_51_0/libs/multi_index/doc/index.html](http://www.boost.org/doc/libs/1_51_0/libs/multi_index/doc/index.html)

# kohana-3 - Kohana ErrorException [致命错误]：调用未定义的方法 Request::redirect()

> ID：13088601
> 
> 赞同：5
> 
> 时间：2012-10-26T14:13:27.617
> 
> 标签：kohana-3

我正在使用 Kohana 3.3.0，并且我有一个控制器，它应该将博客文章保存到数据库然后重定向到主页，我的代码如下：-

```
class Controller_Article extends Controller {

const INDEX_PAGE = 'index.php/article';

public function action_post() {

$article_id = $this->request->param('id');
$article = new Model_Article($article_id);
$article->values($_POST); // populate $article object from $_POST array
$article->save(); // saves article to database

$this->request->redirect(self::INDEX_PAGE);
} 
```

文章保存到数据库，但重定向行给出了错误：-

```
ErrorException [ Fatal Error ]: Call to undefined method Request::redirect() 
```

请让我知道如何进行重定向。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T06:08:15.463

你得到 Exception 因为从 Kohana 3.3 开始，`Request`不再有 method `redirect`。

您可以通过替换来修复您的示例

`$this->request->redirect(self::INDEX_PAGE);`

和

`HTTP::redirect(self::INDEX_PAGE);`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T06:34:56.530

是的，Request::redirect 不再存在。因此，为了轻松地从 3.2 迁移到 3.3，我扩展了 Kohana_Request 类并添加了重定向方法。只需在**classes文件夹中创建****Request.php**并编写

 **> ```
> class Request extends Kohana_Request {
> 
>     /**
>      * Kohana Redirect Method
>      * @param string $url
>      */
>     public function redirect($url) {
>        HTTP::redirect($url);
>     }
> 
> } 
> ```

所以你将能够同时使用**Request::redirect**和**$this->request->redirect**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-08T00:45:18.060

在你的控制器中`$this->redirect('page');`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-06T06:08:57.637

$this->redirect('文章/索引');**

# c++ - 在某些条件下无法返回有意义值的 c++ 函数

> ID：13088605
> 
> 赞同：3
> 
> 时间：2012-10-26T14:13:37.657
> 
> 标签：c++, function, pointers, null

我有一个以对象类型作为返回值类型的成员函数：

```
MyObject myfunction(parameters) {
    if (some condition) { 
        return MyObject(parameters);
    } else { 
        ... no valid object can be created ... 
    } 
} 
```

在某些情况下（在函数体中检查），无法创建和返回 MyObject 类型的对象。

作为一个偶尔的 c++ 程序员，我可以自发地提出三个解决方案：

1.  将返回值类型更改为 * MyObject 并在无法创建有效对象时返回 nullptr (C++11)，然后在调用代码中检查与 nullptr 的相等性。
2.  如果无法创建对象并在调用代码中捕获该对象，则抛出异常。
3.  使用我定义为无效的一些值创建一个对象，并在使用返回的对象之前检查它。

处理这种情况的标准方法和性能方面的最佳解决方案是什么？...或一些我看不到的明显解决方法...

最先进的 C++11 解决方案将是完美的 :-)

到目前为止我的想法：
解决方案 1 似乎还可以，但仅适用于 C++11，我必须在堆上创建返回的对象才能将其传递给主程序（将对象本身返回给调用函数，因此将其保留在堆栈中对于小对象可能会更快？）。
解决方案 2 可能会更慢，并导致主程序中的编码冗长。
解决方案 3 可能是最慢的（徒劳地创建了一个对象）并且在主程序中检查不是很方便。

对于我的代码，没有有效的返回对象是默认情况而不是异常，并且创建的对象相当小，但是考虑不同情况的一般考虑对于其他读者的应用程序肯定有用......

非常感谢大家的帮助:-)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T14:17:56.803

在通常情况下，返回[Boost.Optional](http://www.boost.org/libs/optional/doc/html/index.html)有效：

```
boost::optional<MyObject> myfunction(parameters) {
    if (some condition) { 
        return MyObject(parameters);
    } else { 
        return boost::none;
    } 
} 
```

在通话现场：

```
auto ret = myfunction(...);
if(ret)
  // use '*ret'  or 'ret.get()' 
```

但正如 R. Martinho 所提到的，这个解决方案有一些缺点（即，仅移动类型不起作用，因为 Boost.Optional 尚未更新以支持移动语义）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T14:23:19.663

由于您的问题是笼统的，我也将笼统地回答。

如果你有一个函数，它的工作是创建和返回一个对象，那么*这*就是它的工作。

现在，如果您想以这样一种方式设计此函数，以便在不满足构建对象所需的某些条件时*不*返回该对象，您实际上已经更改了此函数的语义。现在，它只承担一项职责，它具有三个职责：

1.  确定是否存在构建对象的正确条件
2.  如果是，则构造并返回对象
3.  如果否，则不返回任何内容，或指示未创建的某些条件值

“[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)”表明，一般来说，好的设计规定一个功能（或类或你有什么）应该有一项工作要做。在这里，您的功能有三个。

我建议您建议的方法一般都不是最好的。相反，我会选择：

> 4：实现一个单独的函数来确定构造对象的资格。如果该函数返回 true，则调用 `myFunction`构造对象并返回它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-26T14:31:44.880

根据具体情况，您建议的所有 3 个解决方案都是有效且常见的。

如果无法创建对象是可能导致调用函数不得不中止、备份和重试或采取其他极端措施的错误条件，则抛出异常。

如果无法创建对象是例行事件，并且您希望调用者检查对象是否已创建并在任何一种情况下都正常进行，则返回 null 是一个很好的解决方案。

如果可以创建一个合理的虚拟或空白对象，那是一个很好的解决方案。但这非常罕见。仅当调用者将实际处理虚拟对象时，您才应该这样做。

如果你返回一个空指针，然后你发现你调用这个函数的每个地方都在写

```
MyObject* myobject=myfunction(whatever);
if (myobject==null) throw new PanicException; 
```

那么你不妨在函数内部抛出异常。

更糟糕的是，如果您正在编写：

```
MyObject* myobject=myfunction(whatever);
if (myobject!=null)
{
  ... process it ...
}
else
{
   ... display error message ...
} 
```

然后，您只是使用 IF 语句模拟异常处理。使用真正的例外。

另一方面，如果你抛出一个异常，然后你发现你经常写：

```
MyObject* myobject;
try
{
  myobject=myfunction(whatever);
}
catch (PanicException pe)
{
  myobject=null;
} 
```

那么，你最好只返回空值。

我偶尔会创建虚拟对象。最常见的情况是当一个函数返回一个集合（如数组或链表）时，如果我找不到要放入集合中的数据，则返回一个包含零元素的集合。然后调用者循环遍历集合中的元素，如果没有，那很好。我遇到过一些情况，其中我返回了一个带有零长度字符串的对象，用于名称或客户 ID 或其他任何内容。但总的来说，如果您只是返回一个虚拟对象，以便调用者可以测试并说，哦，这是一个虚拟对象，然后将其丢弃，我认为您最好返回 null。

顺便说一句，当您说只能在 C++11 中返回空指针时，不确定您的意思。传递空值的能力可以追溯到我见过的最早的 C++ 版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-26T14:17:44.103

除非阻止创建对象的条件**异常**，否则应使用第一种解决方案。否则返回 NULL 指针是一个完全有效的解决方案......即使在 C++11 中也是如此。

“指针”当然应该使用 RAII 容器（例如 std::unique_ptr）进行包装。真的应该是你代码的常见做法。

如果您问我，第三种解决方案是完全浪费资源。您将不得不创建一个无效（无用）的对象，并将其复制为返回值......只是为了将其丢弃。

# actionscript-3 - 如何重复 TimelineLite 时间线的一部分

> ID：13088607
> 
> 赞同：1
> 
> 时间：2012-10-26T14:13:45.713
> 
> 标签：actionscript-3, gsap

我正在使用 Greensocks 库“TimelineLite”进行补间。

我一直在寻找解决方案，但没有任何运气。如何使我的时间线成为我的时间线的一部分。假设我在时间线上有 10 个补间，我想让 3-10 无限循环，前三个只循环一个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-27T14:57:35.250

使用“onComplete:loop;”向 tweenLite 补间添加事件监听器；

```
var myTimeline:TimelineLite = new TimelineLite({onComplete:loop}); 
```

您在要开始循环的点添加标签：

```
//Add a "spin" label 3-seconds into the timeline
myTimeline.addLabel("spin", 3); 
```

然后创建循环函数

```
function loop():void
{
  //go to the "spin" label and play the timeline from there
  myTimeline.gotoAndPlay("spin");
} 
```

编辑：或者不必创建单独的`loop`函数：

```
var myTimeline:TimelineLite = new TimelineLite({
    onComplete: tl.gotoAndPlay,
    onCompleteScope: tl,
    onCompleteParams: ["spin"],
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T14:58:29.107

使用[TimelineMax](http://www.greensock.com/timelinemax/)。您可以将子时间线附加到 TimelineMax。因此，您可以将循环补间放在一个时间轴上（设置为重复）并将其附加到也具有非循环补间的父时间轴上。

# crash - JpCapWriter 使 JVM 崩溃

> ID：13088612
> 
> 赞同：0
> 
> 时间：2012-10-26T14:13:59.217
> 
> 标签：crash, jvm, writer, jpcap

当我尝试使用 JpCap Writer 将数据包保存到文件时，它会导致 JVM 崩溃。

代码：

```
captor=JpcapCaptor.openDevice(interfaceList[interfaceNumber], 65535, true, 20);
captor.setFilter("ip and tcp",true);

JpcapWriter writer=JpcapWriter.openDumpFile(captor,"write.txt");
for(int i=0;i<10;i++){
    Packet packet=captor.getPacket();
    writer.writePacket(packet);
  }
writer.close(); 
```

崩溃信息：

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007f283105953a, pid=3060, tid=139810797537024
#
# JRE version: 6.0_24-b24
# Java VM: OpenJDK 64-Bit Server VM (20.0-b12 mixed mode linux-amd64 compressed oops)
# Derivative: IcedTea6 1.11.4
# Distribution: Ubuntu 12.04 LTS, package 6b24-1.11.4-1ubuntu0.12.04.1
# Problematic frame:
# v  ~BufferBlob::jni_fast_GetLongField
#
# An error report file with more information is saved as:
# /root/workspace/Sniff/hs_err_pid3060.log
#
# If you would like to submit a bug report, please include
# instructions how to reproduce the bug and visit:
#   https://bugs.launchpad.net/ubuntu/+source/openjdk-6/
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
# 
```

知道如何解决吗？或者以 TCPDump 格式保存数据包的任何其他替代方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T17:56:19.993

我看到你对我的问题的评论。我遇到了同样的问题，这是在我试图关闭已经关闭的作家时引起的。你可能会在不知不觉中关闭它。检查您的代码，并查看删除`writer.close();`对您有什么影响。

如果您不需要操作数据包，我建议使用[Wireshark](http://www.wireshark.org/)。它使得将数据包捕获为 TCPDump 并添加捕获过滤器变得非常容易。

# python - wmi 重启后一段时间不可用

> ID：13088618
> 
> 赞同：5
> 
> 时间：2012-10-26T14:14:27.063
> 
> 标签：python, wmi, pywin32

我在登录时遇到 WMI 可用性问题。

重新启动后，我打开 cmd 并使用 python 解释器：

```
>>> import wmi
>>> c = wmi.WMI()
>>> c.Win32_OperatingSystem()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python27\lib\site-packages\wmi.py", line 1147, in __getattr__
    return getattr (self._namespace, attribute)
  File "C:\Python27\lib\site-packages\win32com\client\dynamic.py", line 516, in
__getattr__
    raise AttributeError("%s.%s" % (self._username_, attr))
AttributeError: winmgmts:.Win32_OperatingSystem
>>> 
```

5 分钟后，我打开**另一个**cmd 和 python 解释器：

```
Python 2.7.3 (default, Apr 10 2012, 23:31:26) [MSC v.1500 32 bit (Intel)] on win
32
Type "help", "copyright", "credits" or "license" for more information.
>>> import wmi
>>> c = wmi.WMI()
>>> c.Win32_OperatingSystem()
[<_wmi_object: \\W520-ALEX-WIN7\root\cimv2:Win32_OperatingSystem=@>]
>>> 
```

注意：即使 5 分钟后，第一个 cmd 仍然会说***AttributeError 。***

注意 2：如果我注销并登录 wmi 可用，那么它会受到重新启动的影响

使用进程资源管理器检查*环境变量*，它们对于两个 cmd 都是相同的

那会是什么？请帮忙。

**更新：**显然问题在于连接到 wbem 服务：

```
>>> import win32com.client
>>> win32com.client.Dispatch('WbemScripting.SWbemLocator')
<COMObject WbemScripting.SWbemLocator>
>>> wmi_service= win32com.client.Dispatch('WbemScripting.SWbemLocator')
>>> wbem_service =  wmi_service.ConnectServer('.','root/cimv2')
>>> wbem_service
<COMObject <unknown>>
>>> items = wbem_service.ExecQuery('Select * from Win32_OperatingSystem')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<COMObject <unknown>>", line 3, in ExecQuery
  File "C:\Python27\lib\site-packages\win32com\client\dynamic.py", line 282, in
_ApplyTypes_
    result = self._oleobj_.InvokeTypes(*(dispid, LCID, wFlags, retType, argTypes
) + args)
pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, u'SWbemServicesEx
', u'Generic failure ', None, 0, -2147217407), None)
>>> 
```

注3：`wmic os`一直有效。

注意 4：重新安装 pywin32 包没有帮助。重新注册/重新编译 WMI 组件和重置 WMI 数据库也没有（如此[处](https://stackoverflow.com/a/7078421/1167879)推荐）

**注意 5：我的 4 台其他笔记本电脑没有这个问题。**

wmiprov.log**也**有：

```
(Mon Oct 29 11:40:07 2012.248587) : ***************************************
(Mon Oct 29 11:40:07 2012.248587) : Could not get pointer to binary resource for file:
(Mon Oct 29 11:40:07 2012.248587) : C:\Windows\system32\drivers\ndis.sys[MofResourceName](Mon Oct 29 11:40:07 2012.248587) : 
(Mon Oct 29 11:40:07 2012.248587) : ***************************************
(Mon Oct 29 11:40:07 2012.248587) : ***************************************
(Mon Oct 29 11:40:07 2012.248587) : Could not get pointer to binary resource for file:
(Mon Oct 29 11:40:07 2012.248587) : C:\Windows\system32\drivers\en-US\ndis.sys.mui[MofResourceName](Mon Oct 29 11:40:07 2012.248587) : 
(Mon Oct 29 11:40:07 2012.248587) : ***************************************
(Mon Oct 29 11:40:07 2012.248603) : ***************************************
(Mon Oct 29 11:40:07 2012.248603) : Could not get pointer to binary resource for file:
(Mon Oct 29 11:40:07 2012.248603) : C:\Windows\system32\DRIVERS\wmiacpi.sys[MofResource](Mon Oct 29 11:40:07 2012.248603) : 
(Mon Oct 29 11:40:07 2012.248603) : ***************************************
(Mon Oct 29 11:40:07 2012.248603) : ***************************************
(Mon Oct 29 11:40:07 2012.248603) : Could not get pointer to binary resource for file:
(Mon Oct 29 11:40:07 2012.248603) : C:\Windows\system32\DRIVERS\monitor.sys[MonitorWMI](Mon Oct 29 11:40:07 2012.248603) : 
(Mon Oct 29 11:40:07 2012.248603) : *************************************** 
```

注 6：WMIDiag 工具报告在[我的保管箱中](http://dl.dropbox.com/u/61886092/WMIDIAG-V2.1_WIN7_.CLI.SP1.64_W520-ALEX-WIN7_2012.10.26_18.34.00-REPORT.TXT)

# sql - sql server 根据同一张表中的另一列更新新列

> ID：13088621
> 
> 赞同：0
> 
> 时间：2012-10-26T14:14:33.117
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我有一个基于三列的复合主键表。

`(Unit, Account, service)`

我还有另外两列：（`DOB`这包含出生日期）& `Age`（这是一个新的 int 列，需要根据 DOB 进行更新，结果将是年的整数值）

我知道如何检索年龄的结果

```
select datediff(Year,DOB,GETDATE()) as AGE 
```

但不确定如何根据行 DOB 数据更新整个表。

列是`Unit, Account, Service, DOB, Age`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:32:02.333

根据评论，坚持 Age 是不明智的，因为它每天都在变化（如果用户在不同的时区，可能更频繁）。

此外，您的 Age vs DOB 算法不准确 - 请参阅[此处](https://stackoverflow.com/questions/1572110/how-to-calculate-age-in-years-based-on-date-of-birth-and-getdate)以获得更好的算法

因此，IMO 这是一种非持久性[COMPUTED](http://msdn.microsoft.com/en-us/library/ms191250(v=sql.105).aspx)列有意义的场景，如下所示：

```
ALTER TABLE Person add Age 
AS DateDiff(yy,DOB,CURRENT_TIMESTAMP) 
- CASE WHEN DATEPART  (mm,DOB) <= DATEPART(mm,CURRENT_TIMESTAMP) 
       and DATEPART(dd, DOB) <= DATEPART(dd,CURRENT_TIMESTAMP)
    THEN 0 
    ELSE 1
  END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:28:12.683

Get rid of the `age` column and calculate the age like so:

```
SELECT DATEDIFF(yy, DOB, getdate()) AS age FROM daffyduck 
```

There are very rare cases that you need to store items such as age. Since age changes daily, you will have to update your records often. It is instead better to store a fixed value, such as the date of birth that can be calculated. Most DBMS's provide the functionality for doing the date arithmetic for this reason.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T14:50:33.513

要回答您的问题：

```
UPDATE dob.MyTable SET Age = datediff(Year,DOB,GETDATE()); 
```

这将根据您的要求更新整个表格。

但是，我强烈建议您在这里查看所有其他答案。尤其是上面公式中的计算误差。

# java - 如何防止玩家进入“被阻塞的瓷砖” - java

> ID：13088627
> 
> 赞同：0
> 
> 时间：2012-10-26T14:14:50.343
> 
> 标签：java, collision, slick2d

我正在使用 Slick2d 在 Java 中创建游戏，但我遇到了问题。我不知道如何防止用户输入“被阻止的瓷砖”。有没有人有关于如何做到这一点的任何提示？

编辑：这不是实际检查是否存在问题的碰撞，而是阻止玩家移动，我有一个浮点类型的速度变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T16:39:39.767

有两种基本方法：

*   预处理：收到移动命令后，检查玩家移动到的地块是否被挡住，防止用户进入被挡住的地块。（我推荐这种方法）

或者

*   后处理：立即移动播放器，检测当前图块的状态，并在需要时将播放器移回。

* * *

同样的原则也适用于非平铺游戏：在实际移动之前或之后检查是否存在碰撞，然后执行相应的操作。

# javascript - Javascript参数传递不起作用

> ID：13088631
> 
> 赞同：3
> 
> 时间：2012-10-26T14:15:20.797
> 
> 标签：javascript, parameters

该代码动态创建一个可以工作的列表视图，但我想制作它，因此当单击列表视图项目时，它会将 url 参数发送到另一个方法。当我设置参数时，它不会提醒参数，但是当我没有给出参数时它会起作用。

```
var output = 
"<li onclick='openURL()'><h3> Module Code: " + 
results.rows.item(i).module 
+ "</h3>Room: " 
+ results.rows.item(i).room +
"</li>"; 
```

以上工作 - openURL() 中没有参数；

```
var output = 
    "<li onclick='openURL('" + results.rows.item(i).url + "')'><h3> Module Code: " + 
    results.rows.item(i).module 
    + "</h3>Room: " 
    + results.rows.item(i).room +
    "</li>"; 
```

以上不起作用 - 我已经完成了 alert(results.rows.item(i).url) 并且它有一个值。

```
function openURL(url) {
    alert("opening url " + url);
} 
```

有人可以解释我做错了什么，我已经尝试解决这个问题好几个小时了。

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:18:22.477

您使用单引号打开 HTML 属性，不能将其用作 JavaScript 字符串，因为您将关闭 HTML 属性，请使用双引号：

```
var output = 
    "<li onclick='openURL(\"" + results.rows.item(i).url + "\")'><h3> Module Code: " + 
    results.rows.item(i).module 
    + "</h3>Room: " 
    + results.rows.item(i).room +
    "</li>"; 
```

# c# - 当 form[].element 被禁用时，Form.Key 消失

> ID：13088633
> 
> 赞同：1
> 
> 时间：2012-10-26T14:15:33.213
> 
> 标签：c#, javascript, asp.net, forms

当我禁用

```
document.forms["Form1"].elements[okbn].disabled = true; 
```

中的相应条目

```
this.Request.Form.AllKeys 
```

消失。如何禁用按钮但保留 AllKeys 中的条目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:21:43.413

`disable`表示“不要将其包含在提交的数据中”。

也许你想要`readonly`呢？

# sql - 检测时间序列中的状态变化

> ID：13088636
> 
> 赞同：0
> 
> 时间：2012-10-26T14:15:39.283
> 
> 标签：sql

我有一个表，其中所有记录都有一个 id、时间戳和一个布尔值。我需要发现在哪些记录中，布尔值在同一 ID 为真后的 1 秒内变为假。

我一直在研究以下语句，但在做了一些研究之后，我觉得 CASE 与 FETCH 语句结合起来可能会更好，但我还没有找到一个很好的例子，它们一起使用。

```
SELECT *  
FROM Table_1  
WHERE timestamp IN(  
    SELECT DATEADD(Second, 1, timestamp)  
    from Table_1  
    where Boolean = 1)  
AND ID in (  
    SELECT ID   
    from Table_1 where Boolean = 1)  
AND Boolean = 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:20:05.927

怎么样：

```
Select Distinct
  t1.id
From
  Table_1 t1
    Inner Join
  Table_1 t2
    On
      t1.Id = t2.Id And 
      t1.Boolean = True And 
      t2.Boolean = False And
      DateDiff(Second, t1.Timestamp, t2.Timestamp) Between 0 And 1 
```

关于您在 join 子句中放入多少以及在 where 子句中放入多少的品味问题。

编辑

*   添加了不同的
*   设置日期差异的最小界限

# php - 使用 DateInterval 将周数添加到 DateTime 对象

> ID：13088638
> 
> 赞同：9
> 
> 时间：2012-10-26T14:15:47.130
> 
> 标签：php, datetime

目前我的代码增加了一周，但我使用的是 Days 而不是 Weeks。我已经阅读了[文档](http://www.php.net/manual/en/class.dateinterval.php#dateinterval.props.y)并且不太了解它是如何工作的。

[`PHP: DateInterval`](http://www.php.net/manual/en/class.dateinterval.php#dateinterval.props.y)

```
# Adds 7 days to the project launch date.
$project_launch_date->add(new DateInterval('P7D')); 
```

我如何指定“添加一周”或“添加 n 周”，而不是手动添加 7 天？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-10-26T14:19:58.420

如果您不清楚 DateInterval，您可以使用更清晰的 DateTime 类**修改**。

```
$date = new DateTime();
$date->modify('+1 day');
$date->modify('+5 week'); 
```

我更喜欢使用修改，因为它使代码在没有注释的情况下更具可读性

如果您更喜欢使用 DateInterval，这里有一个很好的参考：[http ://www.php.net/manual/en/dateinterval.construct.php](http://www.php.net/manual/en/dateinterval.construct.php)

所以 5 周是 P5W，3 个月是 P3M，5 周和 3 个月是 P3M5W，依此类推。

# ruby-on-rails - 关于我在 Heroku 上的应用更新

> ID：13088643
> 
> 赞同：0
> 
> 时间：2012-10-26T14:16:07.223
> 
> 标签：ruby-on-rails, heroku

```
 Results logged to /tmp/build_207lfem2op1z3/vendor/bundle/ruby/1.9.1/gems/linecache19-0.5.12/ext/trace_nums/gem_make.out
       An error occurred while installing linecache19 (0.5.12), and Bundler cannot continue.
       Make sure that `gem install linecache19 -v '0.5.12'` succeeds before bundling.
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app

To git@heroku.com:intense-garden-9145.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:intense-garden-9145.git' 
```

所以请帮助我解决这个我是 Heroku 和 Ruby on rails 的新手

我已按照以下步骤更新我的应用程序 git init git add。git commit -m '.' git push heroku 大师

我有以下运行错误

```
 saasbook@saasbook:~/hw2_rottenpotatoes$ git push heroku master
Counting objects: 462, done.
Compressing objects: 100% (240/240), done.
Writing objects: 100% (462/462), 76.71 KiB, done.
Total 462 (delta 185), reused 427 (delta 172)

-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.2.1
       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment
       Fetching gem metadata from http://rubygems.org/.........
       Fetching gem metadata from http://rubygems.org/..
       Installing rake (0.9.2.2)
       Installing multi_json (1.0.4)
       Installing activesupport (3.1.0)
       Installing bcrypt-ruby (3.0.1) with native extensions
       Installing builder (3.0.0)
       Installing i18n (0.6.0)
       Installing activemodel (3.1.0)
       Installing erubis (2.7.0)
       Installing rack (1.3.6)
       Installing rack-cache (1.0.3)
       Installing rack-mount (0.8.3)
       Installing rack-test (0.6.1)
       Installing hike (1.2.1)
       Installing tilt (1.3.3)
       Installing sprockets (2.0.3)
       Installing actionpack (3.1.0)
       Installing mime-types (1.17.2)
       Installing polyglot (0.3.3)
       Installing treetop (1.4.10)
       Installing mail (2.3.0)
       Installing actionmailer (3.1.0)
       Installing arel (2.2.1)
       Installing tzinfo (0.3.31)
       Installing activerecord (3.1.0)
       Installing activeresource (3.1.0)
       Installing archive-tar-minitar (0.5.2)
       Installing coffee-script-source (1.2.0)
       Installing execjs (1.2.13)
       Installing coffee-script (2.2.0)
       Installing rack-ssl (1.3.2)
       Installing json (1.6.5) with native extensions
       Installing rdoc (3.12)
       Installing thor (0.14.6)
       Installing railties (3.1.0)
       Installing coffee-rails (3.1.1)
       Installing columnize (0.3.6)
       Installing haml (3.1.4)
       Installing jquery-rails (1.0.19)
       Installing libv8 (3.3.10.4)
       Installing ruby_core_source (0.1.5)
       Installing linecache19 (0.5.12) with native extensions
       Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.
       /usr/local/bin/ruby extconf.rb
       checking for vm_core.h... no
       checking for vm_core.h... no
       *** extconf.rb failed ***
       Could not create Makefile due to some reason, probably lack of
       necessary libraries and/or headers.  Check the mkmf.log file for more
       details.  You may need configuration options.
       Provided configuration options:
       --with-opt-dir
       --without-opt-dir
       --with-opt-include
       --without-opt-include=${opt-dir}/include
       --with-opt-lib
       --without-opt-lib=${opt-dir}/lib
       --with-make-prog
       --without-make-prog
       --srcdir=.
       --curdir
       --ruby=/usr/local/bin/ruby
       --with-ruby-dir
       --without-ruby-dir
       --with-ruby-include
       --without-ruby-include=${ruby-dir}/include
       --with-ruby-lib
       --without-ruby-lib=${ruby-dir}/lib
       /usr/local/lib/ruby/1.9.1/fileutils.rb:243:in `mkdir': Read-only file system - /usr/local/include/ruby-1.9.1/ruby-1.9.2-p290 (Errno::EROFS)
       from /usr/local/lib/ruby/1.9.1/fileutils.rb:243:in `fu_mkdir'
       from /usr/local/lib/ruby/1.9.1/fileutils.rb:217:in `block (2 levels) in mkdir_p'
       from /usr/local/lib/ruby/1.9.1/fileutils.rb:215:in `reverse_each'
       from /usr/local/lib/ruby/1.9.1/fileutils.rb:215:in `block in mkdir_p'
       from /usr/local/lib/ruby/1.9.1/fileutils.rb:201:in `each'
       from /usr/local/lib/ruby/1.9.1/fileutils.rb:201:in `mkdir_p'
       from /tmp/build_lt34ecl4ewpm/vendor/bundle/ruby/1.9.1/gems/ruby_core_source-0.1.5/lib/ruby_core_source.rb:59:in `block in create_makefile_with_core'
       from /usr/local/lib/ruby/1.9.1/tempfile.rb:320:in `open'
       from /tmp/build_lt34ecl4ewpm/vendor/bundle/ruby/1.9.1/gems/ruby_core_source-0.1.5/lib/ruby_core_source.rb:51:in `create_makefile_with_core'
       from extconf.rb:19:in `<main>'
       Requesting http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p290.tar.gz
       Downloading http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p290.tar.gz
       Gem files will remain installed in /tmp/build_lt34ecl4ewpm/vendor/bundle/ruby/1.9.1/gems/linecache19-0.5.12 for inspection.
       Results logged to /tmp/build_lt34ecl4ewpm/vendor/bundle/ruby/1.9.1/gems/linecache19-0.5.12/ext/trace_nums/gem_make.out
       An error occurred while installing linecache19 (0.5.12), and Bundler cannot continue.
       Make sure that `gem install linecache19 -v '0.5.12'` succeeds before bundling.
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app

To git@heroku.com:intense-garden-9145.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:intense-garden-9145.git' 
```

我在下面发布我的 Gem 文件

```
source 'http://rubygems.org'

gem 'rails', '3.1.0'

# Bundle edge Rails instead:
# gem 'rails',     :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'therubyracer'              
  gem 'sass-rails', "  ~> 3.1.0"
  gem 'coffee-rails', "~> 3.1.0"
  gem 'uglifier'
end

gem 'jquery-rails'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
gem 'ruby-debug19', :require => 'ruby-debug'
gem 'haml' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:50:26.217

> 安装 linecache19 (0.5.12) 时出错，Bundler 无法继续。

通常，您只会`ruby-debug`在开发中使用 gem，而不是在生产中使用。确保`ruby-debug`在您`:development`的.`:test``Gemfile`

```
group :development, :test do
  gem 'ruby-debug19', :require => 'ruby-debug'
end 
```

然后尝试以下

1.  `bundle`再次运行
2.  提交你的`Gemfile`和`Gemfile.lock`
3.  再次推送到 Heroku

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T16:33:41.747

`linecache19`安装为 的依赖项`ruby-debug19`，无论如何您都不希望在生产中拥有它。

在您的 Gemfile 中，替换显示的行

```
gem 'ruby-debug19', :require => 'ruby-debug' 
```

有了这个

```
group :development, :test do
  gem 'ruby-debug19', require: 'ruby-debug'
end 
```

这意味着调试器仅在开发和测试环境中加载。

您还将遇到`sqlite3`Heroku 也不支持的问题...请参阅[此问题](https://stackoverflow.com/questions/13083399/heroku-deployment-failed-because-of-sqlite3-gem-error/)

# sass - SASS - 带有 var args 和 shared args 的转换 mixin

> ID：13088644
> 
> 赞同：3
> 
> 时间：2012-10-26T14:16:09.767
> 
> 标签：sass, mixins

这是我正在尝试做的事情，我想创建一个允许可变数量的属性的 mixin，并且还允许我使用单个 DRY val 进行（在此示例中）转换。所以我可以说，“在 .2s 处轻松转换 box-shadow、border 和 width。”

这是我脑海中一些非常严重的伪代码。我最不确定的部分是如何获取列表以便它以正确的方式编译。我不确定 append 是否是正确的方法，或者我是否需要连接一个字符串 var，或者什么？

```
/* move object*/
.moveit{
    @include grouped-trans((box-shadow, border, width), 0.2s, ease-in);
}

/* mixin */
@mixin grouped-trans($list, $time, $ease)
{
    @each $prop in $list {
        //transition: append($prop, $time, $ease);
        // - or -
        //$tmp_var + $list, $time, $ease;
} 
```

我知道有一些方法可以使用字符串插值 #{} 之类的方法来合并变量 args，并将 '...' 作为参数包含在内。但我 - 理想情况下 - 想找到一种按照我描述的方式执行此操作的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T20:12:03.227

下面是你如何构建你正在寻找的 mixin。请注意，这确实需要使用[Compass](http://compass-style.org/)，但是不使用 Compass 就使用 Sass 是愚蠢的。

```
@import "compass";

@mixin grouped-trans($list, $time, $ease) {
  @include transition-property($list);
  @include transition-duration($time);
  @include transition-timing-function($ease);
}

.moveit {
  @include grouped-trans((box-shadow, border, width), 0.2s, ease-in);
} 
```

上面的 SCSS 将编译为以下 CSS：

```
.moveit {
  -webkit-transition-property: box-shadow, border, width;
  -moz-transition-property: box-shadow, border, width;
  -o-transition-property: box-shadow, border, width;
  transition-property: box-shadow, border, width;
  -webkit-transition-duration: 0.2s;
  -moz-transition-duration: 0.2s;
  -o-transition-duration: 0.2s;
  transition-duration: 0.2s;
  -webkit-transition-timing-function: ease-in;
  -moz-transition-timing-function: ease-in;
  -o-transition-timing-function: ease-in;
  transition-timing-function: ease-in;
} 
```

# java - 双原始类型数据的意外行为

> ID：13088648
> 
> 赞同：7
> 
> 时间：2012-10-26T14:16:34.073
> 
> 标签：java, floating-point

我想了解 Java`double`类型如何将其值存储在 Java 的内存中。当我运行以下代码时，我得到了意外的输出：

```
public static void main(String[] args)  {

    float a = 1.5f;
    float b= 0.5f;
    double c= 1.5;
    double d = 0.5;

    float a1 = 1.4f;
    float b1= 0.5f;
    double c1= 1.4;
    double d1 = 0.5;

    System.out.println(" a- b is " + (a-b));
    System.out.println(" c- d is " + (c-d));
    System.out.println("a1-b1 is " + (a1-b1));
    System.out.println("c1-d1 is " + (c1-d1)); 
```

}

输出：

```
a-b 是 1.0
 c-d 为 1.0
a1-b1 为 0.9
c1-d1 为 0.8999999999999999

```

为什么`c1-d1`不等于`0.9`？

我还尝试了其他不同的值，但有时它会返回预期结果，有时则不会。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:51:33.633

虽然您可能听说过舍入错误，但您可能想知道为什么这里有舍入错误。

```
float a1 = 1.4f;
float b1 = 0.5f;
double c1 = 1.4;
double d1 = 0.5;

System.out.println(new BigDecimal(a1) + " - " + new BigDecimal(b1) + " is " +
        new BigDecimal(a1).subtract(new BigDecimal(b1)) + " or as a float is " + (a1 - b1));
System.out.println(new BigDecimal(c1) + " - " + new BigDecimal(d1) + " is " +
        new BigDecimal(c1).subtract(new BigDecimal(d1)) + " or as a double is " + (c1 - d1)); 
```

印刷

```
1.39999997615814208984375 - 0.5 is 0.89999997615814208984375 or as a float is 0.9
1.399999999999999911182158029987476766109466552734375 - 0.5 is
     0.899999999999999911182158029987476766109466552734375 
     or as a double is 0.8999999999999999 
```

如您所见，既不`float`也`double`不能准确地表示这些值，并且当打印 float 或 double 时，会发生一些舍入以向您隐藏它。在这种浮点数的情况下，四舍五入到小数点后 7 位会产生您期望的数字。在具有 16 位精度的 double 的情况下，舍入误差是可见的。

作为@Eric Postpischil，注意`float`or`double`操作是否有舍入误差完全取决于使用的值。在这种情况下，即使表示的值比双精度值更远离 0.9，浮点数似乎更准确。

简而言之：如果您要使用`float`或`double`应该使用明智的舍入策略。如果您不能这样做，请使用 BigDecimal。

```
System.out.printf("a1 - b1 is %.2f%n", (a1 - b1));
System.out.printf("c1 - d1 is %.2f%n", (c1 - d1)); 
```

印刷

```
a1 - b1 is 0.90
c1 - d1 is 0.90 
```

当您打印浮点数或双精度时，它假定最接近的短十进制值是您真正想要的值。即在 0.5 ulp 以内。

例如

```
double d = 1.4 - 0.5;
float f = d;
System.out.println("d = " + d + " f = " + f); 
```

印刷

```
d = 0.8999999999999999 f = 0.9 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:32:44.517

的 Java 文档`println`（通过多个链接）参考`toString`. 的[文档`toString`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Float.html#toString%28float%29)`float`说，为or打印的位数`double`是唯一区分该值与同一类型中相邻可表示值所需的数字。

当“1.4f”转换为float时，结果为1.39999997615814208984375（十六进制浮点数，0x1.666666p+0）。当减去 0.5 时，结果为 0.89999997615814208984375 (0x1.ccccccp-1)。碰巧，这个浮点数也是最接近 0.9 的浮点数。因此，在打印时，会打印“.9”。

当“1.4”转换为double时，结果为1.399999999999999911182158029987476766109466552734375（0x1.6666666666666p+0）。当减去 0.5 时，结果为 0.899999999999999911182158029987476766109466552734375 (0x1.cccccccccccccp-1)。这**不是**最接近 0.9 的双精度数，因为 0.90000000000000002220446049250313080847263336181640625 (0x1.ccccccccccccdp-1) 更接近。因此，在打印时，Java 规范要求将值打印得更精细，与 0.9 区分开来。结果“0.8999999999999999”准确地代表了实际值。

# c++ - c++没有匹配的调用函数：传递迭代器？

> ID：13088650
> 
> 赞同：1
> 
> 时间：2012-10-26T14:16:44.383
> 
> 标签：c++, templates, iterator

我在我的 C++ 代码中遇到了一个奇怪的问题。我已经定义了一个名为 TemplateClass

```
StateTemplate<T> 
```

此外，我定义

```
typedef StateTemplate<double> StateDouble. 
```

然后我定义了一个朋友函数

```
template<class S>
friend S partialEntangledScalarProduct(
    const typename std::vector<StateTemplate<T> >::const_iterator s1,
    const typename std::vector<StateTemplate<T> >::const_iterator s2,
    const typename std::vector<StateTemplate<T> >::const_iterator sSub1,
    const typename std::vector<StateTemplate<T> >::const_iterator sSub2,
    vector<unsigned int> const &pos,
    vector<unsigned int> const &posNot); 
```

如果我现在做

```
std::vector<StateDouble>::const_iterator s1;
std::vector<StateDouble>::const_iterator s2;
std::vector<StateDouble>::const_iterator sSub1;
std::vector<StateDouble>::const_iterator sSub2;

vector<unsigned int> vui;

Doub test=partialEntangledScalarProduct(s1,s2,sSub1,sSub2,vui,vui); 
```

我收到以下错误：

```
no matching function for call to 
    'partialEntangledScalarProduct(
         __gnu_cxx::__normal_iterator<
             const StateTemplate<double>*,
             std::vector<
                 StateTemplate<double>,
                 std::allocator<StateTemplate<double> > > >&,
         __gnu_cxx::__normal_iterator<
             const StateTemplate<double>*,
             std::vector<
                 StateTemplate<double>,
                 std::allocator<StateTemplate<double> > > >&,
         __gnu_cxx::__normal_iterator<
             const StateTemplate<double>*,
             std::vector<
                 StateTemplate<double>,
                 std::allocator<StateTemplate<double> > > >&,
         __gnu_cxx::__normal_iterator<
             const StateTemplate<double>*,
             std::vector<
                 StateTemplate<double>,
                 std::allocator<StateTemplate<double> > > >&,
         const std::vector<unsigned int, std::allocator<unsigned int> >&,
         std::vector<unsigned int, std::allocator<unsigned int> >&)' 
```

我已经尝试了几个小时来找到问题，但似乎我忽略了一些东西。也许有人可以帮助我？

最好的问候多米尼克

ps：如果您需要有关我的代码的更多信息，请告诉我。此刻我只想给你重要的部分。

这是一个具有相同错误的小示例。

```
#include <iostream>
#include <vector>

template<class T>
class StateTemplate{
    template<class S>
    friend S testFunction(
        const typename std::vector<StateTemplate<S> >::const_iterator s1);
public:
StateTemplate();
};

template<class T>
StateTemplate<T>::StateTemplate(){}

template<class T>
T testFunction(
        const typename std::vector<StateTemplate<T> >::const_iterator s1)
{
    return T(1);
}

int main(){
    std::vector<double>::const_iterator s1;
    double s=testFunction<double>(s1);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:42:43.583

如果您`partialEntangledScalarProduct`正确地提供了声明，则模板参数`S`不会在函数参数列表中的任何地方使用。因此，编译器永远不会推断它，您必须明确提供它。

```
partialEntangledScalarProduct<SomeClass>(s1,s2,sSub1,sSub2,vui,vui); 
```

`SomeClass`只是一个例子，除非您提供更多详细信息，否则确切名称不清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:35:07.297

*(I don't have g++ on this machine, so this is conjecture.)*

I think the issue is that the compiler can't deduce `S` and you're getting an unhelpful error message. Change your usage to the following:

```
double test = partialEntangledScalarProduct<double>(s1,s2,sSub1,sSub2,vui,vui); 
```

As a side note, make sure your examples compile for you before you post them. I'm assuming `Doub` was supposed to be `double`?

# java - 验证拦截器中的排除方法在 strut 2 中不起作用

> ID：13088654
> 
> 赞同：0
> 
> 时间：2012-10-26T14:16:55.960
> 
> 标签：java, validation, struts2, interceptor, struts-validation

我是 struct 2.0 的新手。我正在尝试使用拦截器运行我的第一个小型应用程序，并希望仅对执行方法使用验证。

但它在填充和执行方法之前调用验证函数。谁能告诉我我错过了什么。

以下是我的 SampleAction 类。

```
package demo;

import com.opensymphony.xwork2.ActionSupport;

public class SampleAction extends ActionSupport {

private static final long serialVersionUID = 1L;
    public void validate()
    {
        System.out.println("validate() method called");
    }

    public String populate()
    {
        System.out.println("populate() method called");
        return "populate";
    }

    public String execute()
    {
        System.out.println("execute() method called");
        return SUCCESS;
    }
} 
```

以下是我的 struct.xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
    <package name="default" extends="struts-default">       
        <action name="*Sample" method="{1}" class="demo.SampleAction">
        <interceptor-ref name="defaultStack" >
        <param name="validation.excludeMethods"> populate</param>
        <result name="populate">/first.jsp</result>
        <result name="success">/success.jsp</result>
        </action>
    </package>
</struts> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:37:18.147

将您声明`excludeMethods`参数的部分更改为：

```
<interceptor-ref name="defaultStack">
    <param name="validation.excludeMethods">populate</param>
</interceptor-ref> 
```

**更新**

来自`ValidationInterceptor`javadoc

> alwaysInvokeValidate - 默认为 true。如果为真 validate() 方法将始终被调用，否则不会。
> 
> 程序化 - 默认为 true。如果为 true 并且操作是 Validateable，则调用 validate() 以及任何以“validate”开头的方法。
> 
> 声明性 - 默认为 true。基于 xml 或注释执行验证。

另请阅读 Struts2 [http://struts.apache.org/2.x/docs/validation.html](http://struts.apache.org/2.x/docs/validation.html)中的验证。

# .net - 用于更改/编辑 Windows“主机”或“lmhost”文件的 API

> ID：13088656
> 
> 赞同：1
> 
> 时间：2012-10-26T14:17:03.070
> 
> 标签：.net, winapi

我想知道是否有一个 .Net 甚至是本机 API 可以让我们编辑 Windows 主机文件。与原始访问相比，首选 API 的原因当然是不必处理文件和验证的多个位置。

谢谢！

# c# - Apple 键盘上的 Ctrl+Break

> ID：13088658
> 
> 赞同：6
> 
> 时间：2012-10-26T14:17:04.883
> 
> 标签：c#, visual-studio, visual-studio-2010, keyboard, keyboard-shortcuts

我通常使用`ctrl`+`break`来中断 Visual Studio 中的编译，现在我的新苹果（macbook pro）笔记本电脑没有中断键。有没有可以在苹果笔记本电脑上使用的快捷方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:22:45.660

我不知道是否存在`Fn`复制 PC Break 键的键组合或其他键组合，但您可以使用 Visual Studio 将任何您喜欢的热键分配给 Build.Cancel 命令。只需转到选项对话框（在工具下拉菜单下可用），找到 Build.Cancel 命令并为该命令分配一个新的快捷方式。

# emacs - 如何在 Emacs (*nix) 中运行 F# 交互

> ID：13088660
> 
> 赞同：3
> 
> 时间：2012-10-26T14:17:08.107
> 
> 标签：emacs, f#, mono, f#-interactive

我已经尝试了一周让 F# 交互式在 Emacs 中工作，但我没能做到。

问题是，每当我运行“fsi”或“fsharpi”（使用 fsharp 模式或在 shell 缓冲区中）时，缓冲区都会变得无响应。我检查系统监视器并看到一个使用 100% CPU 的单声道进程，显然我输入的任何内容都没有得到评估。

我在 Emacs 24.1 和 23.2 上试过这个；也在 OS X、Linux Mint 和 Fedora 上，并且都会导致相同的问题。

我尝试过不同版本的单声道（OS X 上的 2.10.9、3.0 和 2.8；Linux Mint 上的 2.10.8.1，在 Fedora 上不记得了）。我也尝试过 F# 2.0 和 3.0；都具有相同的结果。

我也试过在启动解释器时传入“--no-gui”和“--readline”，但没有用。

这基本上是发生了什么

```
bash-3.2$ fsharpi

Microsoft (R) F# 3.0 Interactive version (Mono build)
Copyright (c) Microsoft Corporation. All Rights Reserved.

For help type #help;;

> - 1+2;;
# after waiting for a minute, I kill the mono process
Killed: 9
bash-3.2$ bash: syntax error near unexpected token `;;' 
```

但是，解释器在“ansi-term”缓冲区上运行时确实可以工作：

```
bash-3.2$ fsharpi

Microsoft (R) F# 3.0 Interactive version (Mono build)
Copyright (c) Microsoft Corporation. All Rights Reserved.

For help type #help;;

> - 1+2;;
val it : int = 3 
```

我想将它与 fsharp 模式一起使用，以便我可以轻松地将代码发送到解释器。

我还没有看到有人在网上遇到过这种问题，解决这个问题会让开发变得更加方便。

关于如何使它工作的任何想法？

编辑：正如预期的那样，在 comint 模式下运行它也会“挂起”（comint 是 fsharp 模式使用的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T18:01:29.053

你用的是什么版本的`fsharp-mode`？最后一次更新 (v0.3) 是在 VS2010 (F# 2.0) 发布之后，并且[发布说明](http://laurent.le-brun.eu/site/index.php/2010/06/25/58-new-fsharp-mode-for-emacs)提到在该版本中修复了一个无限循环错误。

`fsharp-mode`另一种可能性——在Mono 对 F# 的支持之前的最后一次更新，所以我的猜测是 Intellisense 帮助程序项目中的一些代码（在代码`/src`文件夹中`fsharp-mode`）依赖于 Windows 特定的行为并且在你运行它时会中断单核细胞增多症。

我认为你最好的办法是在[fsharp-opensource](https://groups.google.com/forum/?fromgroups#!forum/fsharp-opensource)邮件列表上重新发布你的问题，因为那里有很多人在 Mono 上运行 F#，并且可能知道如何解决这个问题。

编辑：[邮件列表帖子](https://groups.google.com/forum/?fromgroups=#!topic/fsharp-opensource/0fQOCBTjFng)的答案是传递`--readline-`标志。尾随`-`关闭 readline 并解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T13:58:34.707

答案是使用“--readline-”选项运行 F# 解释器。

[应该在 Github 存储库https://github.com/fsharp/fsharp](https://github.com/fsharp/fsharp)中解决（不需要这个命令行参数）

# php - 提交和使用 XmlHttpRequest 时 $_FILES 结构的差异

> ID：13088661
> 
> 赞同：2
> 
> 时间：2012-10-26T14:17:24.930
> 
> 标签：php, javascript

我正在使用 javascript FileAPI 和 XmlHttpRequest 构建一个文件上传器，并回退到通过隐藏的 iframe 上传。两个上传都使用 PHP 处理。

然而，我发现 $_FILES 数组的结构方式存在令人讨厌的差异。

使用 iframe 后备时，数组将如下所示：

```
$_FILES = array(
    'files' => array(
        'name' => array(
            0 => 'name.jpg'
        ),
        'type' => array(
            0 => 'image/jpeg'
        )
        ...
    )
) 
```

（我正在使用称为文件 [] 的多个输入）

当我使用 XmlHttpRequest 上传时，数组如下所示：

```
$_FILES = array(
    'filename' => array(
        'name' => 'name.jpg',
        'type' => 'image/jpeg'
        ...
    ),
    ...
) 
```

有什么方法可以使这种行为方式相同吗？您可以在下面找到我如何构建我的 xhr 请求：

```
var data = new FormData(), xhr = new XMLHttpRequest();

data.append(file.name, file);

xhr.open('POST', 'process.php', true);

xhr.onload = function(e) {
    ...
};
xhr.send(data); 
```

目前我像这样解析两个不同的数组，这似乎有效。

```
 if(isset($_FILES['files']['name']))
 { // old skool $_FILES array
    foreach($_FILES['files'] as $key => $values)
    {
        foreach($values as $index => $value)
        {
            $files[$index][$key] = $value;
        }
    }
 } 
 else
 { // XMLHttpRequest $_FILES
    $files = $_FILES;
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:41:44.487

不，这是 PHP 处理基于数组的文件字段命名的完全愚蠢的方式。如果你有

```
<input type="file" name="whatever[]" />
                                 ^^--- 
```

你会得到你所看到的愚蠢的基于子阵列的版本。没有办法解决这个问题 - 它内置在 PHP 的核心中。

# php - PHP 代码分析器确定使用的类/扩展

> ID：13088665
> 
> 赞同：6
> 
> 时间：2012-10-26T14:17:36.673
> 
> 标签：php, code-analysis, lexical-analysis

### 问题

我有一个遗留代码库，我需要分析和确定*依赖关系*。特别是对类（内部/外部）和扩展（Memcache、PDO 等）的依赖。

### 我试过的

我已经查看了是否有 PHP 文件的静态代码分析器中列出的工具[*？*](https://stackoverflow.com/questions/378959/is-there-a-static-code-analyzer-like-lint-for-php-files). 不幸的是，这篇文章已经过时了，大多数有前途的工具，如[phpCallGraph](http://phpcallgraph.sourceforge.net)不再起作用。

我的想法是从词法上分析代码并寻找*类*标记。查看这些列表至少可以让我直观地确定*依赖关系*。但是在以下代码中查找*OtherClass可能很复杂：*

```
$classname = 'OtherClass';
echo $classname::doubleColon(); 
```

最后，我怀疑我是第一个需要这个的人。我确信存在一种工具或工具组合来提供我需要的东西。所以我在自己写这篇文章之前询问了 SO 社区。

### 更新

理想情况下，该*工具*将分析具有完整代码覆盖率的多个文件。因此，像 Xdebug 这样的工具虽然很棒，但并不能解决这个确切的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:28:24.727

Instead of phpCallGraph you could use Gopal Vijayaraghavan's [inclued extension](http://pecl.php.net/package/inclued) which in combination with [Graphviz](http://www.graphviz.org/) gives you a nice looking graph of all included files for a certain execution path.

Example:

![enter image description here](../Images/a828a441ae19147497522e8f8adf3f59.png)

Moreover, I'd recommend [Xdebug](http://xdebug.org/) (a PHP debugger) which offers a profiler that outputs data consumable by [Valgrind](http://valgrind.org/docs/manual/cg-manual.html). Use the debugger with a compatible IDE to follow the execution path (which helped me a lot to wade thru e.g. Drupal's massive call-stack).

Combine both and you should get a fairly thourough overview.

**EDIT**

Searched the web and found [nWire for PHP](http://www.nwiresoftware.com/products/nwire-php) - an eclipse plugin that looks like it could be the right tool for you (30 day free trial which should be enough to give you a head start).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-28T20:53:39.430

我认为 PhpCodeAnalyzer 正是您正在寻找的 - [https://github.com/wapmorgan/PhpCodeAnalyzer](https://github.com/wapmorgan/PhpCodeAnalyzer) 它打印代码库中所有使用的外部扩展的列表。

# c++ - 使用 automake 安装标头

> ID：13088672
> 
> 赞同：3
> 
> 时间：2012-10-26T14:18:08.980
> 
> 标签：c++, autotools, automake

我正在编写一个使用自动工具进行编译/安装的库。我的目录树有点像这样

```
/src/
    file1.cpp
    file2.cpp
/include/
    dir/
        header1.hpp
        header2.hpp
        subdir/
            header.hpp
configure.ac
Makefile.am 
```

我想将标题安装`include/subdir/*`在`$(includedir)/subdir/`. 我怎么做？不，递归生成文件不是一种选择。递归使被认为是有害的。 [http://miller.emu.id.au/pmiller/books/rmch/](http://miller.emu.id.au/pmiller/books/rmch/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T15:48:30.027

尝试：

```
subdirheadersdir = $(includedir)/subdir
subdirheaders_HEADERS = include/subdir/header.hpp 
```

请注意，您不能使用通配符（如`include/subdir/*.hpp`）。您必须列出所有文件。此外，`subdirheaders`只是一个示例名称。你可以使用任何你想要的东西。

# ruby-on-rails - 设计/删除用户错误

> ID：13088674
> 
> 赞同：0
> 
> 时间：2012-10-26T14:18:11.790
> 
> 标签：ruby-on-rails, devise

我正在创建一个表单供管理员进入并列出、编辑和删除用户。我尝试了许多不同的变体来删除用户，但没有任何效果。我想知道是不是因为我需要在我的routes.rb中使用`devise_for :users`and 。`resources :users`这是因为我有链接到用户的上传/附件。但这是我的链接

```
<%= link_to 'Delete',user, :method => 'delete',  :confirm => 'Are you sure?' %> 
```

还有我的 routes.rb

```
# devise_for :users
devise_for :users do
  get "/users/sign_out" => "devise/sessions#destroy", :as => :destroy_user_session
end
resources :users  do
  resources :attachments
end 
```

我收到的错误是`The action 'destroy' could not be found for UsersController.`

但是我的用户控制器有

```
def destroy
  @user = User.find(params[:id]).destroy
  redirect_to admin_index, :flash => { :success => 'User was successfully deleted.' }
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T16:34:35.210

如果您没有对请求使用 ajax，那么问题在于您使用的是`link_to`

为了发送 :method => 'delete' 你必须使用一个按钮，就像这样：

```
<%= button_to 'Delete', user, :method => 'delete',  :confirm => 'Are you sure?' %> 
```

因为必须通过表单提交来执行破坏性操作：

[http://www.w3.org/2001/tag/doc/whenToUseGet.html#checklist](http://www.w3.org/2001/tag/doc/whenToUseGet.html#checklist)

# c++ - 使用 OSX 和 Eclipse 获得一个有效的 C++11 工具链而不破坏任何东西

> ID：13088675
> 
> 赞同：2
> 
> 时间：2012-10-26T14:18:15.223
> 
> 标签：c++, eclipse, gcc, c++11, homebrew

我目前开始认真使用 C++。我听说过 C++11 的新特性，我喜欢它们。所以我想知道我是否应该按照新标准来编写我的新项目。我当前的工具链（我猜是 XCode 附带的）不支持`auto`类型推断的关键字等功能。

```
> g++

i686-apple-darwin11-llvm-g++-4.2 
```

因此，我正在寻找一种简单安全的方法来获取 C++11 工具链来试用它。我不能冒险破坏我的旧工具链。

我知道在哪里可以获得[Mountain Lion 的 GCC 4.8 的二进制文件](http://hpc.sourceforge.net/)，但我不知道如何手动安装所有文件（并且宁愿让包管理器为我执行此操作）。[这个讨论](https://apple.stackexchange.com/questions/38222/how-do-i-install-gcc-via-homebrew)解释了如何通过自制软件安装 GCC，但我担心这会覆盖并破坏我现有的工具链。

另外，我不知道如何在安装后在 Eclipse 中配置新的工具链，以便可以将它与 Eclipse/CDT 一起使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T14:32:20.787

您可以使用 OSX 的自制包管理器：http: [//mxcl.github.com/homebrew/](http://mxcl.github.com/homebrew/)

看看[https://github.com/mxcl/homebrew/wiki/Custom-GCC-and-cross-compilers](https://github.com/mxcl/homebrew/wiki/Custom-GCC-and-cross-compilers)，更具体地说是 homebrew dupes，它有 OS X 提供的软件的重复（但更新版本）。

为了获得合理的 C++11 体验，您应该寻找 gcc 4.6 或 gcc 4.7。当你安装了最新版本的 gcc 后，你可以在你的 Makefiles 中使用它。请注意，您必须使用`-std=c++0x`(gcc-4.6) 或`-std=c++11`(gcc-4.7+) 进行编译。

如果您在 Eclipse CDT中遇到 C++11 结构的语法错误和警告，也可以查看此处的[Eclipse CDT C++11/C++0x 支持。](https://stackoverflow.com/questions/9131763/eclipse-cdt-c11-c0x-support)

# c# - （是否有一种）简单的方法来检查（复杂）pocomodel 中的属性是否已更改？

> ID：13088676
> 
> 赞同：3
> 
> 时间：2012-10-26T14:18:17.083
> 
> 标签：c#

我想知道是否有一种“简单”/好方法来检查属性是否已更改。就像下面的层次结构中 Child.Name 已更改（isDirty）一样，我想知道。

```
GrantParent
- Parent
-- Child 
```

在我目前的情况下，我需要浏览模型以查看是否有任何变化。

ps：我正在使用`IChangeTracking`.

一直在考虑缓存序列化对象的哈希。（太慢了？）

或者创建调用的父级的changedevent，直到它到达授权父级。（健谈？）

```
 public class Parent: BaseEntity
  {
    private Child _child;
    public Child Child
    {
      get { return _child; }
      set { _child = value; OnPropertyChanged("Child"); }
    }
  }

  public class Child : BaseEntity
  {
    private  int _id;
    public int Id {
      get { return _id; }
      set { _id = value; OnPropertyChanged("Id"); }
    }
  }

 [DataContract]
  [Serializable]
  public abstract class BaseEntity : INotifyPropertyChanged
  {
    protected BaseEntity()
    {
      PropertyChanged += PropertyChangedEventHandler;
    }

    private void PropertyChangedEventHandler(object sender, PropertyChangedEventArgs e)
    {
      if (e != null && !String.Equals(e.PropertyName, "IsChanged", StringComparison.Ordinal))
      {
        this.IsChanged = true;
      }
    }

    protected void OnPropertyChanged<T>(Expression<Func<T>> property)
    {
      MemberExpression me = property.Body as MemberExpression;
      if (me == null || me.Expression != property.Parameters[0]
            || me.Member.MemberType != MemberTypes.Property)
      {
        throw new InvalidOperationException(
            "Now tell me about the property");
      }
      var handler = PropertyChanged;
      if (handler != null) handler(this,
        new PropertyChangedEventArgs(me.Member.Name));
    }

    [Browsable(false), DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    public bool IsChanged
    {
      get
      {
        lock (_notifyingObjectIsChangedSyncRoot)
        {
          return _notifyingObjectIsChanged;
        }
      }

      protected set
      {
        lock (_notifyingObjectIsChangedSyncRoot)
        {
          if (!Boolean.Equals(_notifyingObjectIsChanged, value))
          {
            _notifyingObjectIsChanged = value;

            if (IsDirtyChanged != null)
              IsDirtyChanged();

            this.OnPropertyChanged("IsChanged");
          }
        }
      }
    }

    private bool _notifyingObjectIsChanged;
    private readonly object _notifyingObjectIsChangedSyncRoot = new Object();

    public void AcceptChanges()
    {
      this.IsChanged = false;
    }
  } 
```

**最后，**我对已经使用的 XML 序列化程序中的 XML 模型进行了比较。我不需要每秒（左右）一次即时更改检测就足够了。现在我用上次保存后的那个来检查 XML 模型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:23:45.740

您需要让每个属性自己跟踪它，并存储一些指示哪些属性已更改的信息，或者可能在项目更改时触发事件。

基本上每个属性都会有类似的逻辑：

```
public class MyClass : INotifyPropertyChanged
{
    private int _value;
    public int Value
    {
        get
        {
            return _value;
        }
        set
        {
            _value = value;
            PropertyChanged(this, new PropertyChangedEventArgs("Value"));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

这将允许您向 PropertyChanged 事件添加事件处理程序，以便在更改属性时触发代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:35:32.177

我最近在一个项目中工作，我们让所有节点/叶子实现一个`node.Modified`属性并用于`INotifyPropertyChanged`引发`node.Modified`. 然后所有的父母都订阅了他们孩子的财产变更，如果`node.Modified`曾经设置为真，那么他们会将自己的设置`node.Modified`为真。

就像你说的，它有点啰嗦，但还没有接近成为我们的性能瓶颈，因为我们没有看到每秒成千上万的变化，而且我们的层次结构只有 3 级深。

这是一个快速示例：

```
class Node : INotifyPropertyChanged
{

    public Node()
    {
        Children = new List<Node>();
    }
    public event PropertyChangedEventHandler PropertyChanged;
    protected void OnPropertyChanged(string name)
    {
        var temp = PropertyChanged;
        if (temp != null)
            temp(this, new PropertyChangedEventArgs(name));
    }

    public IList<Node> Children { get; private set; }
    public void AddChild(Node node)
    {
        node.PropertyChanged += ChildPropertyChanged;
        Children.Add(node);
    }

    void ChildPropertyChanged(object sender, PropertyChangedEventArgs args)
    {
        if (args.PropertyName == "Modified")
            Modified |= ((Node)sender).Modified;
    }

    bool _modified = false; 
    public bool Modified 
    {
        get { return _modified; } 
        set 
        {
            if (_modified != value)
            {
                _modified = value;
                OnPropertyChanged("Modified");
            }

        } 
    } 
```

编辑：还有另一种使用消息总线的方法。它可能并不完美，但它是解决问题的另一种方法，所以我也会分享。我很快就破解了一个微不足道的消息总线......

```
static class Bus<T>
{

    public static Dictionary<object, Action<object, T>> Subscriptions = new Dictionary<object, Action<object, T>>();
    public static void Raise(object sender, T message)
    {
        foreach (Action<object, T> action in Subscriptions.Values)
        {
            action(sender, message);
        }
    }

    public static void Subscribe(object subscriber, Action<object, T> action)
    {
        Subscriptions[subscriber] = action;
    }

    public static void Unsubscribe(object subscriber)
    {
        if (Subscriptions.ContainsKey(subscriber))
            Subscriptions.Remove(subscriber);
    }

}

public class WasModified { } 
```

和修改后的节点

```
class Node
{

    public Node()
    {
        Children = new List<Node>();
    }

    public IList<Node> Children { get; private set; }

    bool _modified = false; 
    public bool Modified 
    {
        get { return _modified; } 
        set 
        {
            if (_modified != value)
            {
                _modified = value;

                if (_modified == true)
                    Bus<WasModified>.Raise(this, new WasModified());
            }

        } 
    }
} 
```

最后，它的用途。

```
 static void Main(string[] args)
    {

        Node parent = new Node();
        Bus<WasModified>.Subscribe(parent, (s,a)=> parent.Modified = true);
        Node child = new Node();
        Node gchild = new Node();
        parent.Children.Add(child);
        parent.Children.Add(gchild);
        gchild.Modified = true;
        Console.WriteLine(parent.Modified);

        Console.ReadLine();
    } 
```

消息总线不需要冒泡到父对象，并且每次您想查看 Modified 是否已更改时都不需要递归到它们，所以也许这就是您要查找的内容。

# javascript - Angular 未在自定义指令中编译

> ID：13088678
> 
> 赞同：2
> 
> 时间：2012-10-26T14:18:22.460
> 
> 标签：javascript, angularjs

我有一个看起来像这样的指令：

```
app.directive('fieldsetCollapse', function() {
return {
    restrict: 'A',
    scope: {},
    compile: function(tElement, tAttrs, transclude) {
        var wrapperElement = angular.element('<div ng-show="isOpen"></div>'),
            legendElement = tElement.find('legend'),
            collapsibleContent = tElement.children().not('legend'),
            toggleBtn = angular.element('<a href="#" class="twisty" ng-class="{ true: \'twisty-open\', false: \'twisty-closed\' }[isOpen]" ng-click="toggle()"></a>');

        legendElement.css('cursor', 'pointer')
                      .attr('ng-click', 'toggle()');

        tElement.css({
            'position': 'relative',
            'marginLeft': '20px'
        });
        tElement.prepend(toggleBtn);

        angular.forEach(collapsibleContent, function(obj, i) {
            $(obj).remove();
            wrapperElement.append(obj);
        });

        tElement.append(wrapperElement);

        return function(scope, element, attrs) {
            var directiveValue = (scope.$eval(attrs.gaigCollapsibleFieldset));
            scope.isOpen = (directiveValue == undefined) ? true : directiveValue;

            scope.toggle = function() {
                scope.isOpen = !scope.isOpen;
            }

        }
    }
} 
```

});

与此标记一起使用：

```
<fieldset fieldset-collapse> ... </fieldset> 
```

如果我尝试在 <fieldset> 中添加任何内容，例如：

```
<fieldset fieldset-collapse>{{foo}}</fieldset> 
```

...在我的控制器范围内定义 foo 的地方，输出是

```
{{foo}} 
```

Angular 不会编译我在带有指令的标签之间添加的任何内容。我是否遗漏了一些东西来使我的指令发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T16:00:05.103

您正在指令定义对象中创建一个隔离范围

```
return {
    restrict: 'A',
    scope: {} // <--- isolated scope
} 
```

这意味着您的指令无权访问值`foo`所在的父范围。

把它注释掉就行了。示例[http://jsfiddle.net/jaimem/RE7Jj/1/](http://jsfiddle.net/jaimem/RE7Jj/1/)

如果您不希望指令具有对父范围的完全访问权限，您可以在本地范围属性`foo`和父范围属性之间设置双向绑定`foo`。文档中的更多详细信息：http: [//docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)

# sql-server-2008 - 如何通过 CSV 更新/编辑表格？

> ID：13088681
> 
> 赞同：0
> 
> 时间：2012-10-26T14:18:40.573
> 
> 标签：sql-server-2008, csv, stored-procedures

我将 2 个联系电话存储在与 companycontactno 中的一个 companyID 对应的表中。桌子。我在存储过程中使用从 CSV 中提取值来做到这一点。

如果我想编辑那些与公司 ID 相对应的联系电话，我该怎么做？

这是我将用于编辑联系号码的存储过程..我在更新它时遇到了困难..请帮忙

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================

CREATE PROCEDURE dbo.EditCompanyDetails
(
@OldCompanyName varchar(max),
@NewCompanyName varchar(max),
@newAddress varchar(max),
@newMailID varchar(max),
@Temp varchar(8000)
)

AS
BEGIN
SET NOCOUNT ON;

declare @compID int

DECLARE @c int, @a varchar(max), @id int, @variable varchar(8000), @max int

DECLARE @Temp_Table table (serial_no int Identity(1,1), value varchar(max))

--PROCEDURE--

--Editing Company Table--
set @compID=(Select Company.CompanyID from Company where Company.CompanyName=@OldCompanyName)

update Company
set CompanyName=@NewCompanyName, [Address]=@newAddress, Email=@newMailID
where Company.CompanyID=@compID

--For CONTACT NUMBERS

    --Using Table to store CSV seperately in each row--
select @c = CHARINDEX(',', @Temp)

while @c > 0
BEGIN
    insert into @Temp_Table
    select LEFT(@Temp, @c - 1)

    select @Temp = right(@Temp, LEN(@Temp) - @c)
    select @c = CHARINDEX(',', @Temp)
END

--Update Table CompanyContactNo
  --CompanyContactNo have following Columns:
   --CNoID (PK)
   --CompanyID (references PK in Company table
   --ContactNumber

set @max= (select MAX(serial_no) from @Temp_Table)

while @max > 0
BEGIN
set @variable = (select value from @Temp_Table where serial_no=@max)

update CompanyContactNo
set ContactNumber=@variable
where CompanyID=@compID
set @max = @max-1
END

End

GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T00:06:21.403

假设您只有 2 行，并且您知道 CompanyContactNo 表中有 2 个联系人行，您可以执行 2 个 Update 语句，每个语句都会影响不同的行：

```
UPDATE CompanyContactNo
Set ContactNumber=
    (SELECT value FROM @Temp_Table WHERE serial_no = (SELECT MAX(serial_no) FROM @Temp_Table))
WHERE 
    CompanyID=@compID
    AND (CNoId = select MAX(CNoId) FROM CompanyContactNo WHERE CompanyID = @compID) 
```

然后是第二个联系电话：

```
UPDATE CompanyContactNo
SET ContactNumber=
        (SELECT value FROM @Temp_Table WHERE serial_no = (SELECT MIN(serial_no) FROM @Temp_Table))
WHERE 
    CompanyID=@compID
    AND (CNoId = select MIN(CNoId) FROM CompanyContactNo WHERE CompanyID = @compID) 
```

# iphone - 如何自定义 facebook 分享框中的文字（见图）？

> ID：13088683
> 
> 赞同：0
> 
> 时间：2012-10-26T14:18:51.010
> 
> 标签：iphone, ios, facebook

如何自定义分享对话框文本（见图）？我正在使用下面的代码来分享文本。但是我得到了像图像一样的空盒子。这个怎么做？可能吗？提前致谢。

```
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                               @"Test name", @"name",
                               @"Test caption", @"caption",
                               @"Test Description", @"description",
                               @"http://www.facebook.com", @"link",
                               @"", @"picture",
                   @"Test Message", @"message",
                               nil];

[[delegate facebook] dialog:@"feed"
                  andParams:params
                andDelegate:self]; 
```

![在此处输入图像描述](../Images/a129cad7e84a73a6e990e10377b1d65f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T21:02:21.710

[https://developers.facebook.com/docs/reference/dialogs/feed/](https://developers.facebook.com/docs/reference/dialogs/feed/)

似乎表明你做对了。

给出的示例用于提要对话框

```
NSMutableDictionary* params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
kAppId, @"app_id",
@"https://developers.facebook.com/docs/reference/dialogs/", @"link",
@"http://fbrell.com/f8.jpg", @"picture",
@"Facebook Dialogs", @"name",
@"Reference Documentation", @"caption",
@"Using Dialogs to interact with users.", @"description",
nil];

[_facebook dialog:@"feed" andParams:params andDelegate:self]; 
```

# jakarta-ee - 如何编写/部署“类似守护进程”的应用程序到 glassfish

> ID：13088697
> 
> 赞同：0
> 
> 时间：2012-10-26T14:19:36.037
> 
> 标签：jakarta-ee, servlets, glassfish, daemon

我有以下问题：
我必须编写一个对数据库进行修改的应用程序。我必须在 Glassfish 2 上部署它。
这个应用程序不会接收任何外部调用，它只是查看数据库，假设每 10 秒进行一次修改。我不应该编写 servlet，因为它们不打算用于这些目的。（从 init() 开始一个线程，它为我们工作）。我读到，这是违反标准的。
你有什么建议？
在 Java EE 标准的“边界”内，我应该编写什么样的 EE 应用程序来解决这个问题？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:38:12.723

通过 ServerletContextListener 类创建您的任务，然后可以运行一个线程（通过 ExecutorService 安全地）来监视您的数据库。它应该与此类似。它是在 Tomcat 中完成的，但在 Glassfish 上应该不会有所不同。

[http://kahimyang.info/kauswagan/howto_blogs/1314-asynchronous_tasks_in_jsf_applications](http://kahimyang.info/kauswagan/howto_blogs/1314-asynchronous_tasks_in_jsf_applications)

# java - 虽然延迟为真

> ID：13088698
> 
> 赞同：5
> 
> 时间：2012-10-26T14:19:42.433
> 
> 标签：java, while-loop

我通常使用无限循环，如下所示：

```
public static boolean start = false;

while(!start) {
    doMyLogic();
} 
```

但是一位朋友说您需要在 while-true 循环内有一个小的延迟（如下所示），否则可能会导致内存问题，这也不是一个好习惯。

建议方式：

```
while(!start) { 
    Thread.sleep(few_miliseconds);  // 500 ms
    doMyLogic();
} 
```

请告诉我建议方式的影响。我做对了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:41:41.683

我会使用 ScheduledExecutorService

```
ScheduledExecutorService service = Executors.newSingleThreadScheduledExecutor();
service.scheduleAtFixedRate(new Runnable() {
    @Override
    public void run() {
        doMyLogic();
    }
}, 500, 500, TimeUnit.MILLISECONDS); 
```

该服务可以重复用于许多重复或延迟的任务，并且可以`shutdown()`根据需要进行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:22:05.227

不是内存问题，而是您阻塞了 CPU。绝对使用延迟。

这也取决于`doMyLogic()`方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T14:22:07.747

在（半）无限循环中插入睡眠总是一个好习惯，这样当代码执行到睡眠时，其他线程也可以执行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-26T14:23:19.917

如果你没有暂停，你的 CPU 就一直在做某事。您实际上是在阻塞 CPU。然而，如果你添加一个暂停 (sleep())，你就会让 CPU 休息一下来做其他事情。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-26T14:24:01.940

好吧，我认为它不会有内存问题（除非您的 doMyLogic 方法有内存问题），因为无论延迟如何，任何内存泄漏都会表现出来。睡眠的真正好处是，在大多数情况下，代码不需要像计算机一样快地执行 doMyLogic。例如，假设 doMyLogic 正在检查是否在目录中创建了文件。对于这种情况，没有必要让计算机每秒检查数百次（这将需要大量 CPU 和磁盘 I/O），而每秒 1 次可能就足够了。

没有计时的最大影响是使用额外的 CPU 时间和逻辑功能拥有的其他资源，在大多数情况下，对最终用户没有明显的影响。

# ms-access - 更改表单过滤器时访问崩溃

> ID：13088701
> 
> 赞同：1
> 
> 时间：2012-10-26T14:19:51.430
> 
> 标签：ms-access, ms-access-2010

这是我的表格。

![在此处输入图像描述](../Images/114824c21e95716c257aa2265d321946.png)

如果我执行以下步骤，访问总是崩溃：

1.  搜索 2012 年
2.  然后搜索提案编号 12-100（存在）

无论如何，如果我进行年份搜索，则搜索提案编号，反之亦然。它会崩溃。通过崩溃，我的意思是访问停止工作并且必须重新启动。

如果我之前关闭表单来做第二个，它们都可以工作。

这是我的查找和清除按钮的代码（这几乎是我表单的所有代码）。

```
 Private Sub btnFind_Click()
    If (Not IsNull(txtResearch) And txtResearch <> "") Then
        Me.Filter = "ProposalNo = '" & txtResearch & "'"
        Me.FilterOn = True
    ElseIf (Not IsNull(txtYear) And txtYear <> "") Then
        Me.Filter = "pyear = " & txtYear
        Me.FilterOn = True
    Else
        Me.Filter = ""
        Me.FilterOn = False
    End If

End Sub

Private Sub btnClear_Click()
    txtResearch = ""
    txtYear = ""
    Me.Filter = ""
    Me.FilterOn = False
End Sub 
```

问题是我设置过滤器的方式吗？我不确定`Me.FilterOn`

另外，我确实尝试过压缩和修复，但没有运气

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:47:11.850

显然过滤器和 SQL Server 可能存在一些问题，但我对这个主题还不够了解。您可能还想在这里查看 Allen Browne 的笔记：[http ://www.pcreview.co.uk/forums/access-crashes-remove-filter-sub-form-t2772609.html](http://www.pcreview.co.uk/forums/access-crashes-remove-filter-sub-form-t2772609.html)

您可能希望考虑使用 where 语句而不是使用过滤器来设置记录源。

# java - 数据库中的 PHP 与 Java 字符串比较

> ID：13088711
> 
> 赞同：0
> 
> 时间：2012-10-26T14:20:39.230
> 
> 标签：java, php, mysql, arrays, string-comparison

所以，假设我有 500 个字符串，例如：

*   `<script>something here</script>`
*   `get_magic_quotes_gpc(` ...

假设这些字符串存储在数据库（mysql）中

递归遍历目录、子目录和查找数据库提供的字符串时，Java 或 Php 通常更快吗？

两者都可以同样快（基于编写代码的质量）吗？

我一直在尝试研究它，似乎 java 更快，但是如果说字符串存储在本地数组中（而不是数据库中），php 是否可以同样快？

我不是想在这里创建 java vs php 战争，但我想要一些证据，如果一个比另一个快，或者两者在很大程度上可以同样快（基于编写的代码）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:24:16.800

您在这里看到的称为过早优化。不要这样做。选择您最了解的语言（或最适合您当前项目的语言）并从那里开始。

进一步阅读：

*   [https://softwareengineering.stackexchange.com/questions/80084/is-premature-optimization-really-the-root-of-all-evil](https://softwareengineering.stackexchange.com/questions/80084/is-premature-optimization-really-the-root-of-all-evil)
*   [http://en.wikipedia.org/wiki/Program_optimization](http://en.wikipedia.org/wiki/Program_optimization)

# matlab - 无法让 FFT 在 Octave 中工作

> ID：13088712
> 
> 赞同：0
> 
> 时间：2012-10-26T14:20:46.910
> 
> 标签：matlab, audio, fft, octave

我一直在做一个（可能超级简单的）任务，其中一个步骤是获得傅里叶变换。我按照我大学的指南转换了[可以在此处找到](https://skydrive.live.com/redir?resid=96DF3D17A10A5F7D!254&authkey=!AEBwu1_FFQOe-ns)的波声（通道：2，样本：17600，样本频率：16KHz）。

查看图表，它似乎有效：

```
[y,fs,wmode,fidx]=readwav('piano.wav','r',-1,0);
left=y(:,1);
amountOfSlices = 6;
samplesPerSlice = fix(length(left) / 6);
frames=enframe(left, samplesPerSlice);
frames=transpose(frames);
fftdata=rfft(frames);
fftdata=fftdata.*conj(fftdata);
plot(fftdata); 
```

![教程 FFT](../Images/91c9ed4993b22f314d135ae1e7541f98.png)

接下来，我创建了一个以教程代码为基础的代码文件，并添加了接受参数（分配所需的参数，但为简洁起见省略了）。

```
samplerate = 512;
% Read the file with raw unscaled audio data from begin to end
[multiData,fs,wmode,fidx]=readwav(filename,'r',-1,0);
disp(sprintf('Number of channels: %d', fidx(5)))
disp(sprintf('Number of samples: %d', fidx(4)))
disp(sprintf('Sample frequency: %d Hz', fs))

% Extract the left channel of the data
leftData = multiData(:, 1);

% Slice the left channel into pieces of the size of 'samplerate'
samplesPerSlice = samplerate

% Splits the leftData vector up into frames of length equal to sample rate
slicedLeftData = enframe(leftData, samplerate)';

% Apply the real data fast fourrier transformation on each data slice
fftdata=rfft(slicedLeftData);
fftdata=fftdata.*conj(fftdata);

plot(fftdata); 
```

![赋值 FFT](../Images/848f5df4a99c794e747cb8cf11901b15.png)

你们知道我在这里做错了什么吗？

*我的实际问题是：*为什么第二个数据不在 0 到 16.000 Hz 的频域中？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T15:09:44.093

我猜“这里有什么问题”是指多种颜色？如果是这样，看起来两个图像中的 fftdata plottet 都是矩阵（你想要一个数组，对吗？）。.* 不是对每个元素都执行操作吗？检查您传入参数的尺寸。

此外，请记住奈奎斯特定理：您永远无法解析任何大于采样频率一半的频率。在采样频率为 16KHz 的情况下，您可能有超过 8kHz 的数据点，但它不会包含任何信息，因此无需将其包含在频域图中。

# jquery - 仅在不存在 cookie 时加载 jQuery 脚本

> ID：13088730
> 
> 赞同：0
> 
> 时间：2012-10-26T14:21:33.580
> 
> 标签：jquery, css, cookies

我很好奇。在我正在构建的网站上工作时，我有一点淡出 div。您访问该站点，存在一个 div，其中包含该站点的标题，然后在一段时间后淡出。简单的。

```
<div class="loader"><h1><?php bloginfo('name'); ?> <?php wp_title(); ?></h1></div>

$(window).load(function() {
    $('.loader').delay(2000).fadeOut();
}); 
```

我所追求的是，​​这个 div 和 jQuery 只会在用户第一次访问该站点或自上次访问后清除其缓存/cookie 时才会显示/运行。

有任何想法吗？我确信 cookies.js 会很有用，但现在似乎正在开发中。

干杯，R

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:26:34.660

```
 <?php if(!isset($_COOKIE['visited'])) { ?>

      <div class="loader"><h1><?php bloginfo('name'); ?> <?php wp_title(); ?></h1></div>

      <script type="text/javascript">
        $(window).load(function() {
        $('.loader').delay(2000).fadeOut();
        });
      </script>

    <?php 
     setcookie ("visited", "", time() + 31536000,"/");
} ?> 
```

# php - 为什么 Geocoder google 不想识别更多地址？

> ID：13088735
> 
> 赞同：0
> 
> 时间：2012-10-26T14:21:46.330
> 
> 标签：php, javascript, location, coordinates, google-geocoder

我有一个带有坐标（纬度，经度）的数组......这个数组有大约 60-80 个项目......

在我的 foreach 循环中有...

```
...{
$lat = substr($xx[1],0,8);
$long = substr($xx[0],0,8);

?>

<script type="text/javascript">
// <![CDATA[
$(function() {

   var geocoder = new google.maps.Geocoder();

function geocodePosition(pos,pos2) {
  geocoder.geocode({
    latLng: new google.maps.LatLng(pos,pos2)
  }, function(responses) {
if (responses && responses.length > 0) {
   console.log(responses[0].formatted_address);
} else {
   console.log('Cannot determine address at this location.');
    }
  });
}
geocodePosition(<?php echo $lat ?>,<?php echo $long ?>);

}); 

// ]]>
</script>

<?php } ... 
```

地理编码器最多可在 5 个坐标处进行地理编码，其他则带有输出“无法确定此位置的地址”。

当我采用其中一些“无法确定”时，我手动使用它们（仅 1 项 = 纬度和经度，而不是整个数组）它可以工作。

那么问题出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:25:31.937

你不能连续请求地址太快（被谷歌阻止），你需要在循环中使用小的 setTimeout() 。另请注意，您每天只能使用基本 api 请求 2500 个地址，[来自 google 的业务超过 100000 个源。](https://developers.google.com/maps/documentation/geocoding/)

[如何避免谷歌地图地理编码限制](https://gis.stackexchange.com/questions/15052/how-to-avoid-google-map-geocode-limit)

[设置超时以模拟暂停](http://rizsharif.blogspot.fi/2010/10/recursion-settimeout-to-simulate-pause.html)

[来自 PHP 数组的地理编码标记](https://stackoverflow.com/questions/8169494/google-maps-with-multiple-markers-from-a-php-array)

[避免地理编码限制 - js / html 源](https://stackoverflow.com/questions/7649155/avoid-geocode-limit-on-custom-google-map-with-multiple-markers)

# nhibernate - NHibernate syscache 过期

> ID：13088738
> 
> 赞同：0
> 
> 时间：2012-10-26T14:21:59.400
> 
> 标签：nhibernate, syscache

NHibernate 的 syscache 到期如何工作？

如果我将过期时间设置为 10 分钟，并且每分钟添加一个实体，那么当前 10 分钟（应用程序启动后）结束时，是全部删除 10 个实体，还是只删除第一个？

是从缓存中完全删除所有数据，还是每个实体都有时间戳？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-18T12:42:41.870

我刚刚查看[了 SysCache 源代码](https://nhcontrib.svn.sourceforge.net/svnroot/nhcontrib/trunk/src/NHibernate.Caches/SysCache/NHibernate.Caches.SysCache/SysCache.cs)，这一行清楚地表明它是绝对过期的：

```
cache.Add(
    cacheKey,
    new DictionaryEntry(key, value),
    new CacheDependency(null, new[] {rootCacheKey}),
    DateTime.Now.Add(expiration),
    System.Web.Caching.Cache.NoSlidingExpiration,
    priority,
    null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T18:11:35.163

正如 Rippo 所指出的，滑动到期。

[http://docs.huihoo.com/hibernate/nhibernate-reference-1.2.0/caches.html](http://docs.huihoo.com/hibernate/nhibernate-reference-1.2.0/caches.html)

# asp.net-mvc-3 - Colorbox 未加载 ajax 内容

> ID：13088740
> 
> 赞同：2
> 
> 时间：2012-10-26T14:22:05.503
> 
> 标签：asp.net-mvc-3, firefox, google-chrome, jquery, colorbox

```
<a href="/Search/ReadChain/?CategoryID=123&ParentID=5587&LogDate=10/12/2012" class="ReadChainDL">Read Chain</a>

$(".ReadChainDL").colorbox(); 
```

当我单击读取链时，它会运行 ajax 并加载颜色框，但颜色框是空白的！我可以确认 ajax 正在运行并通过 firebug 提取正确的内容。它只是没有将生成的 ajax 内容填充到颜色框中。我已经通过萤火虫确认颜色框是空白的。

我已经在 Firefox 和 Chrome 中尝试过

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:06:47.253

它必须是 URL；你的代码工作正常。证明：http: [//jsfiddle.net/HP8tN/](http://jsfiddle.net/HP8tN/)

我认为主要有两种可能：

*   没有文件名，所以可能 Colorbox 不知道要使用什么内容类型。或者 URL 错误，或者目标的内容类型错误。我认为这是最有可能的选择。试试看`$(".ReadChainDL").colorbox({photo: true});`是不是照片。否则，[请查看文档中的内容类型部分。](http://www.jacklmoore.com/colorbox)

*   Colorbox 应该确定您是否向它传递了 URL 或 jQuery 样式的 XPath 选择器。这`10/12/2012`可能会弄乱它用来识别 URL 的任何逻辑。这似乎不太可能，因为您已经确认某些东西正在恢复，但值得一试。试试`10%2F12%2F2012`吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T06:08:20.370

您可以发布 ajax 调用返回的内容吗？如果存在无效或格式错误的问题，jQuery 可能无法将其附加到您的文档中。

尝试验证您的内容。

# android - iOS，以非故事模式启动邮件客户端。如何？

> ID：13088745
> 
> 赞同：0
> 
> 时间：2012-10-26T14:22:20.700
> 
> 标签：android, ios, openurl

我的应用程序上有一个按钮，允许用户发送带有目标地址的电子邮件，并且 BODY 已经填写。我正在这样做.... [[UIApplication sharedApplication] openURL:]; 但是这种方法是在 EDIT 模式下启动 Mail 应用程序。用户可以选择编辑正文和目的地。

我正在寻找一种无需进入编辑模式即可发送电子邮件的方法。我不希望用户在 EMAIL 中编辑任何内容...我只想让他单击“发送电子邮件”按钮，然后发送电子邮件。

这是如何在 iOS 中完成的......另外，这将如何在 ANDROID 中完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:34:07.457

You cant do that. For such a solution, do a HTTP post to your server, and make it forward the info to a email address.

No other solution. This is for both Android and iOS.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:34:04.080

Only way to send an email without allowing the user to edit the contents in iOS would be to send the email via a web based script that you call remotely from the app. Doing so you wouldn't have the users email address to be the 'from' address though, so this also has its limitations.

The iOS SDK does not allow you to send emails automatically from your users account without them pressing the Send button on the compose email screen.

# spring - 就 Spring 验证而言，错误代码和消息代码之间的区别？

> ID：13088746
> 
> 赞同：1
> 
> 时间：2012-10-26T14:22:23.117
> 
> 标签：spring, spring-mvc

我参考了以下方法`BindingResult`：

[`BindingResult.html#resolveMessageCodes(java.lang.String, java.lang.String)`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/validation/BindingResult.html#resolveMessageCodes%28java.lang.String,%20java.lang.String%29)

我试图找出错误代码和消息代码之间的区别。有人可以提供一个示例，尤其是一个可以说明**为什么给定错误代码可能有多个消息代码的**示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T17:35:23.243

因为 Web 应用程序是国际化的，所以当您拒绝一个对象并希望为其显示一条消息时，您不要使用硬编码文本，因为无论使用哪种语言，它都会显示相同的内容。

相反，您指定一个错误代码，稍后将其作为从包中检索正确消息的键（现在错误代码是从必须找到正确消息文本的方法的角度来看的消息代码）。

您的错误代码解析为更多消息代码，因为 Spring（基于实现）为您添加了一些额外的消息代码。[这是Spring 文档](http://static.springsource.org/spring/docs/3.0.0.M3/reference/html/ch06s03.html)中的一个片段：

> [...] 它注册的错误代码由使用的 MessageCodesResolver 确定。默认情况下，使用 DefaultMessageCodesResolver，例如，它不仅使用您提供的代码注册消息，而且还注册包含您传递给拒绝方法的字段名称的消息。因此，如果您使用rejectValue("age", "too.darn.old") 拒绝一个字段，除了too.darn.old 代码之外，Spring 还会注册too.darn.old.age 和too.darn.old .age.int（所以第一个将包含字段名称，第二个将包含字段的类型）；这样做是为了方便开发人员定位错误消息等。[...]

最后一条语句是有更多消息代码的原因，以控制向用户显示的消息，从通用代码（例如“需要值”）到给定上下文的更具体的代码（例如“一个值是字段 XXX 必填”）。

[javadoc`DefaultMessageCodesResolver`](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/validation/DefaultMessageCodesResolver.html)进一步解释它并给出了一个例子：

> 例如，在代码“typeMismatch”、对象名称“user”、字段“age”的情况下：
> 
> 1.  尝试“typeMismatch.user.age”
> 2.  尝试“typeMismatch.age”
> 3.  尝试“typeMismatch.int”
> 4.  尝试“类型不匹配”
> 
> 因此，可以利用此解析算法，例如显示绑定错误的特定消息，如“required”和“typeMismatch”：
> 
> at the object + field level ("age" field, but only on "user"); at the field level (all "age" fields, no matter which object name); or at the general level (all fields, on any object).

# validation - 使用 XSD+XMLCatalog 的 Xmllint 找不到 uri

> ID：13088747
> 
> 赞同：4
> 
> 时间：2012-10-26T14:22:24.197
> 
> 标签：validation, xsd, schema, xmllint, xmlcatalog

我正在尝试使用`xmllint`一个 XSD 文件，该文件使用一个 xs:import 而没有 @schemaLocation 属性集。（在 OxygenXMLEditor 这个设置工作正常）

*XSD 相关部分：*

```
...
<!-- this one is the trouble -->
<xs:import namespace="http://www.w3.org/1999/xhtml" />
<!-- this one is resolved fine -->
<xs:import namespace="http://www.idpf.org/2007/ops" schemaLocation="conf/b.xsd"/>
... 
```

*鉴于此 XML 目录文件：*

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE catalog PUBLIC "-//OASIS//DTD XML Catalogs V1.1//EN" "http://www.oasis-open.org/committees/entity/release/1.1/catalog.dtd">
<catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog">      
    <uri name="http://www.w3.org/1999/xhtml" uri="file:///home/me/code/base5html.xsd"/> 

</catalog> 
```

**好的，然后我运行它：**

```
$ export XML_CATALOG_FILES=~/code/mycatalog.xml
$ export XML_DEBUG_CATALOG=1
$ xmllint --load-trace  --noout --schema myschema.xsd test_doc.xml 
```

结果（大约）：

```
Loaded URL="myschema.xsd" ID="(null)"
Loaded URL="conf/b.xsd" ID="(null)"
Loaded URL="c.xsd" ID="(null)"
c.xsd:17: element element: Schemas parser error : Element     '{http://www.w3.org/2001/XMLSchema}element', attribute 'ref': The QName value '{http://www.w3.org/1999/xhtml}p' does not resolve to a(n) element declaration.
c.xsd:18: element element: Schemas parser error : Element '{http://www.w3.org/2001/XMLSchema}element', attribute 'ref': The QName value '{http://www.w3.org/1999/xhtml}cite' does not resolve to a(n) element declaration.
c.xsd:26: element attributeGroup: Schemas parser error : Element '{http://www.w3.org/2001/XMLSchema}attributeGroup', attribute 'ref': The QName value '{http://www.w3.org/1999/xhtml}normAttrGrp' does not resolve to a(n) attribute group definition.
... 
(more taken out)
...
WXS schema public/ctrl/lov.xsd failed to compile
Loaded URL="myschema.xml" ID="(null)" 
```

***问：XSD+XMLCat 不是 libxml2 中支持的功能吗？***

（主页上没有任何提示：http: [//xmlsoft.org/catalog.html](http://xmlsoft.org/catalog.html)）

# qt - AVFrame到QImage的高效转换

> ID：13088749
> 
> 赞同：6
> 
> 时间：2012-10-26T14:22:37.750
> 
> 标签：qt, ffmpeg

我需要从基于 Qt 的应用程序中的视频中提取帧。使用 ffmpeg 库，我能够将帧作为 AVFrame 获取，我需要将其转换为 QImage 以在我的应用程序的其他部分中使用。这种转换需要高效。到目前为止，它似乎`sws_scale()`是正确的功能，但我不确定要指定什么源和目标像素格式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T14:44:35.610

提出了以下两步过程，首先将解码的 RGB 颜色空间转换`AVFame`为另一个，然后转换为. 它工作并且相当快。`AVFrame``QImage`

```
src_frame = get_decoded_frame();

AVFrame *pFrameRGB = avcodec_alloc_frame(); // intermediate pframe
if(pFrameRGB==NULL) {
    ;// Handle error
}

int numBytes= avpicture_get_size(PIX_FMT_RGB24,
      is->video_st->codec->width, is->video_st->codec->height);
uint8_t *buffer = (uint8_t*)malloc(numBytes);

avpicture_fill((AVPicture*)pFrameRGB, buffer, PIX_FMT_RGB24,
              is->video_st->codec->width, is->video_st->codec->height);

int dst_fmt = PIX_FMT_RGB24;
int dst_w = is->video_st->codec->width;
int dst_h = is->video_st->codec->height;

// TODO: cache following conversion context for speedup,
//       and recalculate only on dimension changes
SwsContext *img_convert_ctx_temp;
img_convert_ctx_temp = sws_getContext(
is->video_st->codec->width, is->video_st->codec->height,
is->video_st->codec->pix_fmt,
dst_w, dst_h, (PixelFormat)dst_fmt,
SWS_BICUBIC, NULL, NULL, NULL);

QImage *myImage = new QImage(dst_w, dst_h, QImage::Format_RGB32);

sws_scale(img_convert_ctx_temp,
          src_frame->data, src_frame->linesize, 0, is->video_st->codec->height,
          pFrameRGB->data,
          pFrameRGB->linesize);

uint8_t *src = (uint8_t *)(pFrameRGB->data[0]);
for (int y = 0; y < dst_h; y++)
{
    QRgb *scanLine = (QRgb *) myImage->scanLine(y);
    for (int x = 0; x < dst_w; x=x+1)
    {
        scanLine[x] = qRgb(src[3*x], src[3*x+1], src[3*x+2]);
    }
    src += pFrameRGB->linesize[0];
} 
```

如果您找到更有效的方法，请在评论中告诉我

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-09T08:30:19.000

我知道，为时已晚，但也许有人会发现它有用。从[这里](https://code.google.com/p/qtffmpegwrapper/source/browse/#svn%2Ftrunk%2Fexample)我得到了做同样转换的线索，它看起来有点短。

所以我创建了 QImage ，它被重复用于每个解码的帧：

```
QImage img( width, height, QImage::Format_RGB888 ); 
```

创建帧RGB：

```
frameRGB = av_frame_alloc();    
//Allocate memory for the pixels of a picture and setup the AVPicture fields for it.
avpicture_alloc( ( AVPicture *) frameRGB, AV_PIX_FMT_RGB24, width, height); 
```

第一帧解码后，我以这种方式创建转换上下文 SwsContext（它将用于所有下一帧）：

```
mImgConvertCtx = sws_getContext( codecContext->width, codecContext->height, codecContext->pix_fmt, width, height, AV_PIX_FMT_RGB24, SWS_BICUBIC, NULL, NULL, NULL); 
```

最后对每个解码的帧进行转换：

```
if( 1 == framesFinished && nullptr != imgConvertCtx )
{
//conversion frame to frameRGB
sws_scale(imgConvertCtx, frame->data, frame->linesize, 0, codecContext->height, frameRGB->data, frameRGB->linesize);
//setting QImage from frameRGB
for( int y = 0; y < height; ++y )
   memcpy( img.scanLine(y), frameRGB->data[0]+y * frameRGB->linesize[0], mWidth * 3 );
} 
```

具体见[链接](https://code.google.com/p/qtffmpegwrapper/source/browse/trunk/QTFFmpegWrapper/QVideoDecoder.cpp)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-03-06T00:08:09.597

我认为一种更简单的方法：

```
void takeSnapshot(AVCodecContext* dec_ctx, AVFrame* frame)
{
    SwsContext* img_convert_ctx;

    img_convert_ctx = sws_getContext(dec_ctx->width,
                                     dec_ctx->height,
                                     dec_ctx->pix_fmt,
                                     dec_ctx->width,
                                     dec_ctx->height,
                                     AV_PIX_FMT_RGB24,
                                     SWS_BICUBIC, NULL, NULL, NULL);

    AVFrame* frameRGB = av_frame_alloc();
    avpicture_alloc((AVPicture*)frameRGB,
                    AV_PIX_FMT_RGB24,
                    dec_ctx->width,
                    dec_ctx->height);

    sws_scale(img_convert_ctx, 
              frame->data, 
              frame->linesize, 0, 
              dec_ctx->height, 
              frameRGB->data, 
              frameRGB->linesize);

    QImage image(frameRGB->data[0], 
                 dec_ctx->width, 
                 dec_ctx->height, 
                 frameRGB->linesize[0], 
                 QImage::Format_RGB888);

    image.save("capture.png");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-11T15:35:02.773

今天测试了**直接通过**`image->bit()`to ，终于成功了`swscale`，不需要复制到内存。例如：

```
/* 1\. Get frame and QImage to show */
struct my_frame *frame = get_frame(source);
QImage *myImage = new QImage(dst_w, dst_h, QImage::Format_RGBA8888);

/* 2\. Convert and write into image buffer  */
uint8_t *dst[] = {myImage->bits()};
int linesizes[4];
av_image_fill_linesizes(linesizes, AV_PIX_FMT_RGBA, frame->width);

sws_scale(myswscontext, frame->data, (const int*)frame->linesize,
          0, frame->height, dst, linesizes); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-23T15:25:28.593

我刚刚发现 scanLine 只是通过缓冲区寻找..您所需要的只是将 AV_PIX_FMT_RGB32 用于 AVFrame，将 QImage::FORMAT_RGB32 用于 QImage。

然后解码后只做一个memcpy

`memcpy(img.scanLine(0), pFrameRGB->data[0], pFrameRGB->linesize[0] * pFrameRGB->height());`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-01T15:30:24.887

我对其他建议的解决方案有疑问：

*   他们没有提到释放 AVFrame、SwsContext 或分配的缓冲区，这会导致大量内存泄漏（我有数千帧要处理）。这些问题都不能轻易解决，因为 QImage 依赖于底层数据，并且不会复制它。如果直接释放缓冲区，QImage 指向释放的数据并中断。这可以通过使用 QImage 的 cleanupFunction 在不再需要图像时释放缓冲区来解决，但是对于其他问题，无论如何它都不好。
*   在某些情况下，将 QImage.bits 直接传递给 sws_scale 的建议之一将不起作用，因为 QImage 至少 32 位对齐。因此，对于某些尺寸，它与 sws_scale 的预期宽度不匹配，并且输出每条线移动了一点。
*   第三个问题是他们使用了已弃用的 AVPicture 元素。

我在另一个问题[Converting an AVFrame to QImage with conversion of pixel format](https://stackoverflow.com/q/68048292/7360943)中列出了问题，最后找到了使用临时缓冲区的解决方案，可以将其复制到 QImage，然后安全释放。

因此，请参阅我的答案以获得完全有效、高效且没有弃用函数调用的实现：[https ://stackoverflow.com/a/68212609/7360943](https://stackoverflow.com/a/68212609/7360943)

# c++ - 为什么没有声明从 .cpp 文件中提取模板函数的完全专业化？

> ID：13088751
> 
> 赞同：2
> 
> 时间：2012-10-26T14:22:42.497
> 
> 标签：c++, templates, template-specialization, language-lawyer

以下代码不会生成编译/链接器错误/警告：

```
// A.h
#include<iostream>
struct A
{
  template<typename T>
  static void foo (T t)
  {
    std::cout << "A::foo(T)\n";
  }
};
void other ();

// main.cpp
#include"A.h"
int main ()
{
  A::foo(4.7);
  other();
}

// other.cpp
#include"A.h"
template<>
void A::foo (double d)
{
  cout << "A::foo(double)\n";
}

int other ()
{
  A::foo(4.7);
} 
```

令人惊讶的输出是：

```
A::foo(T)
A::foo(double) 
```

`A::foo(double)`为什么编译器在 的情况下无法选择正确的`main.cpp`？

同意，如果有`A.h`如下声明，则没有预期的问题：

```
template<> void A::foo (double); 
```

但这不是问题，因为在链接时，编译器有专门的版本。

此外，是否具有相同功能的 2 个不同版本的**未定义行为**？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T14:25:39.753

所有显式特化声明必须在模板实例化时*可见*。由于您的显式特化声明`A::foo<double>`在一个翻译单元中可见，但在另一个翻译单元中不可见，因此该程序格式错误。

（实际上，编译器将在 中实例化主模板，在 中实例化`main.cpp`显式专用模板`other.cpp`。无论如何，这仍然会违反 ODR。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:26:58.433

`main.cpp`看不到里面的代码`other.cpp`。模板特化属于文件范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T15:17:59.737

> 为什么编译器无法在 main.cpp 的情况下选择正确的 A::foo(double) ？

问题在于，在一个单独的编译模型中，在标头中没有可用的声明，编译器可能不知道任何翻译单元中是否存在稍后将链接的特化，或者它是否需要实例化模板。语言中的决定是没有声明意味着没有手动专门化模板，因此编译器现在需要生成一个。

> 是否有相同功能的 2 个不同版本是未定义的行为？

是的。无论是否自动生成其中一种特化，事实是它是未定义的行为，因为它违反了单一定义规则（同一符号有多个定义）。

# .net - 是否可以创建一个作为许多其他属性组合的属性？

> ID：13088752
> 
> 赞同：0
> 
> 时间：2012-10-26T14:22:44.287
> 
> 标签：.net, asp.net-mvc-4, custom-attributes

我基本上是在问我们是否可以在属性类上伪造某种多重继承。我有一些具有很多属性的视图模型，它们都获得了相同的字段长度、格式、一些自定义内容等属性组合。可能有大约 50 个这样的字段。一些属性中包含常量。

这看起来真的很糟糕，因为代码重复。如果我想稍微更改格式或任何这些常量，我必须单独查找并修复每个字段。我是否可以创建一些单一的 [MyCustomFieldType] 属性，它的行为就像所有其他属性的组合一样，所以它保持干燥？

编辑：关于代码重复，我的意思是每个属性都有*多个属性*；我不是指有多个属性的事实。我明白，即使我要放置一个属性，我也必须放置很多次。但至少我有一个地方（属性类）来更改格式字符串或其他数字常量参数之类的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T16:16:57.120

我想我知道你在这里得到了什么，对于视图模型属性，恐怕你将无法组合你想要的那些。请更新您的问题以显示您想要组合的属性和常量的一些示例。您是否考虑过将常量存储在 Resources resx 文件中？然后，您可以使用一些属性属性从该文件中检索常量，这应该使其成为 DRYer。但是，您仍然需要在每个属性上拥有属性组合。

# c# - ASP.Net 异步 HTTP 文件上传处理程序

> ID：13088753
> 
> 赞同：4
> 
> 时间：2012-10-26T14:22:44.233
> 
> 标签：c#, javascript, asp.net, asynchronous, httphandler

我正在尝试在 C# 中创建一个异步的文件上传处理程序，并且可以通过 AJAX 异步请求提供有关文件进度的更新。基本上，如果请求是 POST，它会将一些信息加载到会话中，然后开始上传，如果请求是 GET，它会返回上传的当前状态（上传的字节数、总字节数等）。我不完全确定它是否需要是一个异步处理程序，但文件可能非常大，所以我认为这将是最好的。[对于基本异步处理程序，我使用了与这篇MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc164128.aspx)中的处理程序非常相似的东西。我在下面我的代码的一些关键部分下面发布了。我遇到的问题是在 POST 完成之前我没有收到任何 GET 信息。用于 GET 请求，[BlueImp](https://github.com/blueimp/jQuery-File-Upload)用于发布文件。

HTML 和 JavaScript

```
<input id="somefile" type="file" />

$(function () {
  name = 'MyUniqueId130';
  var int = null;
  $('#somefile').fileupload({
    url: '/fileupload.axd?key='+name,
    done: function (e, data) { clearInterval(int); }
  });

  $('#somefile').ajaxStart(function(){
    int = setInterval(function(){
    $.ajax({
      url: '/fileupload.axd?key='+name,
      dataType: 'json',
      async: true
    })
    .done(function(e1, data1){
      if(!e1.InProgress || e1.Complete || e1.Canceled)
        clearInterval(int);
    });
  }, 10000)});
}); 
```

异步处理请求方法只是调用正确的方法，无论是 POST 还是 GET 到以下之一，然后调用 CompleteRequest 来结束请求：

```
private static void GetFilesStatuses(HttpContext context)
{
  string key = context.Request.QueryString["key"];
  //A dictionary of <string, UploadStatus> in the session
  var Statuses = GetSessionStore(context);
  UploadStatus ups;

  if (!String.IsNullOrWhiteSpace(key))
  {
    if (Statuses.TryGetValue(key, out ups))
    {
      context.Response.StatusCode = (int)HttpStatusCode.OK;
      context.Response.Write(CreateJson(ups));
    }
    else
    {
      context.Response.StatusCode = (int)HttpStatusCode.NotFound;
    }
  }
  else
  {
    context.Response.StatusCode = (int)HttpStatusCode.OK;
    context.Response.Write(CreateJson(Statuses.Values));
  }
}

private static void UploadFile(HttpContext context)
{
 var Statuses = GetSessionStore(context);
 string key = context.Request.QueryString["key"];

 if (String.IsNullOrWhiteSpace(key))
 {
   context.Response.StatusCode = (int)HttpStatusCode.BadRequest;
   return;
 }

 HttpPostedFile file = context.Request.Files[0];
 string extn = file.FileName.LastIndexOf('.') == -1 ? "" :
    file.FileName.Substring(file.FileName.LastIndexOf('.'), (file.FileName.Length - file.FileName.LastIndexOf('.')));
 string temp = GetTempFileName(path, extn);
 UploadStatus status = new UploadStatus()
 {
   FileName = file.FileName,
   TempFileName = temp,
   Path = path,
   Complete = false,
   Canceled = false,
   InProgress = false,
   Success = true,
   BytesLoaded = 0,
   TotalBytes = file.ContentLength
 };
 Statuses.Add(key, status);
 byte[] buffer = new byte[bufferSize];
 int byteCount = 0;

 using (var fStream = System.IO.File.OpenWrite(context.Request.MapPath(path + temp)))
 {
   uploads.Add(status);

   while ((byteCount = file.InputStream.Read(buffer, 0, bufferSize)) > 0 && !status.Canceled)
   {
     status.InProgress = true;
     status.BytesLoaded += byteCount;
     fStream.Write(buffer, 0, byteCount);
   }

   status.Complete = !status.Canceled;
   status.InProgress = false;
   status.Success = true;

   if (status.Canceled)
   {
     Statuses.Remove(temp);
   }

   context.Response.StatusCode = (int)HttpStatusCode.OK;
 }
} 
```

我已经尝试了很多东西，例如非异步处理程序、异步处理程序，确保 JavaScript 正在异步运行，但在这一点上，我认为我需要对这个问题有不同的看法，所以感谢任何人提供的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:46:36.617

我假设您使用的是默认的 ASP.Net 会话管理器，并且我看到您调用`GetSessionStore`以获取会话。不幸的是，当调用需要对 Session Store 进行写访问时，默认的 Session 管理器会序列化所有请求。这个[StackOverflow question](https://stackoverflow.com/questions/3629709 "我刚刚发现了为什么所有 ASP.Net 网站都很慢，我正在尝试解决这个问题")和这个[MSDN arcle on Session State](http://msdn.microsoft.com/en-us/magazine/cc163730.aspx "为您的 Web 应用程序提供快速、可扩展和安全的会话状态管理")有一些关于 Session State 及其锁定行为的非常有用的信息。

现在，为了解决您的问题，您将不得不做几件事，这取决于您是使用 MVC 控制器还是编写自定义 IHttpHandler。

*   如果您正在编写自己的 IHttpHandler，请确保您*没有*将`IRequiresSessionState`或`IReadOnlySessionState`接口添加到您的处理程序中。这样做时，管道将跳过寻找会话并直接进行处理。`context.Session`在这种情况下将为空。
*   如果您使用 MVC 处理请求，则需要使用传入[SessionStateBehavior](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.sessionstatebehavior.aspx "SessionStateBehavior 枚举")的[SessionState 属性](http://msdn.microsoft.com/en-us/library/system.web.mvc.sessionstateattribute.aspx "会话状态属性")来装饰您的控制器类。`SessionStateBehavior.Disabled`

在任何一种情况下，您都无法依赖 Session 对象来存储您的上传状态。您可以创建一个静态 ConcurrentDictionary 键控其 SessionID（您需要传入上传查询字符串或自己读取 cookie，调用 Session.SessionId 只会再次阻止您）并将您的上传状态存储在其中（其中看起来他们也是并发*）。

另一种选择是将 SessionStateProvider 替换为您自己的自定义提供程序，但在这种情况下这可能是矫枉过正。

# php - PHP 新行：\n 不工作

> ID：13088756
> 
> 赞同：1
> 
> 时间：2012-10-26T14:22:46.060
> 
> 标签：php

假设我有这个变量：

```
$Include = "Line 1;
            //some Line 2 here"; 
```

我想将该变量写入文件并得到这样的两行：

```
Line1;
//some Line 2 here 
```

但是当我尝试使用此代码来做到这一点时：

```
$Filename = 'somefile.php';
$Handle = fopen($Filename, "r");
$Contents = fread($Handle, filesize($Filename));
fclose($Handle);

$Contents = str_replace ('replace this', $Include, $Contents); 
```

我只看到这样一行：

```
Line 1; //some Line 2 here 
```

如何使用 1 个变量制作 2 行？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:26:18.063

如果您将内容显示`echo`为 html 内容，则需要使用[nl2br()](http://php.net/manual/en/function.nl2br.php)函数。

```
echo nl2br($file_content); 
```

此函数会将所有 \n 转换为`<br />`html 标记，这些标记将按预期显示在 html 页面上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T14:24:30.947

尝试这个：

```
$Include = "Line 1; \r\n" .
           "        //some Line 2 here"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:25:17.767

您必须在`\n`字符串中添加 才能看到换行符。我在上面的示例中看不到任何内容。 `$Include = "Line 1;\n//some Line 2 here";`

# jquery-mobile - Sprint 网络干扰移动网站？

> ID：13088758
> 
> 赞同：0
> 
> 时间：2012-10-26T14:22:56.917
> 
> 标签：jquery-mobile

我知道这听起来很疯狂，但我坐在这里，使用不同网络上的各种电话，并且 sprint 网络上的所有电话都无法正常工作。

看起来好像没有应用 LESS 样式表。有没有人遇到过这样的事情？

还刚刚访问了 LESS 网站，发现所有样式都将使用 LESS 创建，并且它做同样的事情。未能加载/应用 LESS。

我在 sprint 网络上试用过的具体手机是两部 iphone 和一部 android optimus V。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T21:04:33.393

我强烈建议将您的 LESS 文件预处理为 CSS 并在您的网站上提供。

它的效率要高得多，因为在页面加载期间，即使是中等大小的文件也可能需要数百毫秒来处理。它也是在生产中下载的少一个 javascript 文件。最后，移动设备上的处理器开销要少得多，不仅需要解析 javascript，还需要解析 less 文件。一些移动设备没有缓存或本地存储，因此它们有可能在每次页面加载时重新处理较少的文件。

使用 lessc 编译器（需要 Node.js）或[SimpLESS](http://wearekiss.com/simpless)来预编译您的 css 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T15:13:48.553

您可以尝试通过直接加载它们的 URL 来查看它是否阻止了 less javascript 或样式表本身的下载。

对于 lesscss.org 将是[http://lesscss.org/less/main.less](http://lesscss.org/less/main.less)和[http://lesscss.org/js/less.js](http://lesscss.org/js/less.js)

# android - 如何将字符串从片段传递到android中的服务

> ID：13088759
> 
> 赞同：1
> 
> 时间：2012-10-26T14:23:04.227
> 
> 标签：android, android-intent, android-service

我想将字符串从片段传递给服务。我尝试了 setvalue 和 bind 但它适用于活动而不是 startservice 对吗？什么是“ServiceConnection”，通过使用 ServiceConnection 是否可以传递字符串？这是我开始服务的片段代码。

```
 **Solved ** 
```

我已经把我的代码改成了这个，它工作得很好

```
Intent intent = new Intent(getActivity(), myPlayService.class);
            Bundle b = new Bundle(); 
            b.putString("link", "http://94.23.154/bbc");  
            intent.putExtras(b);
            getActivity().startService(intent); 
```

在我使用的服务中

```
public int onStartCommand(Intent intent, int flags, int startId) {
    // TODO Auto-generated method stub
    if(intent != null){
        Bundle bundle = intent.getExtras();
        link = bundle.getString("link");
           } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T15:59:52.163

您可以通过 Intent 将字符串从 Fragment 传递给 Service，并使用以下`putExtra()`方法：

```
Intent intent = new Intent(getActivity(), myPlayService.class));
intent.putExtra("string param 1", "String for the Service");
getActivity().startService(intent); 
```

在服务中，您将检索字符串`onStartCommand()`：

```
public int onStartCommand(Intent intent, int flags, int startId) {
    String stringFromFragment = intent.getStringExtra("string param 1");
    // TODO do something with the string
    startPlayer();
    return START_STICKY;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-10-18T08:43:41.687

`OnAttach`在片段中写入代码

```
@Override
    public void onAttach(Context context) {
        super.onAttach(context);
        Intent i = new Intent(getActivity(), ServiceName.class);
        i.putExtra("key",value);
        getActivity().startService(i);
  } 
```

# vb.net - vb.net 访问当前正在循环的 streamreader.readline

> ID：13088766
> 
> 赞同：0
> 
> 时间：2012-10-26T14:23:25.840
> 
> 标签：vb.net

在 C# 中，似乎以下方法有效，它允许您调用 Streamreader.readline() ，然后在下一个循环中访问同一行。

```
 string line;
    double score = 0;
    count = 0;
    while ((line = sr.ReadLine()) != null)
    {
        score += double.Parse (line);
        count++;
    }
    averageScore = (double)inValue / count; 
```

这在 vb.net 中不起作用，即使使用了我尝试过的所有转换器。

这个完全炸毁并抛出“找不到页面” [http://converter.telerik.com/](http://converter.telerik.com/)

这个：

[http://www.developerfusion.com/tools/convert/csharp-to-vb/?batchId=3356dd81-818a-43d1-8c23-be584e40d15e](http://www.developerfusion.com/tools/convert/csharp-to-vb/?batchId=3356dd81-818a-43d1-8c23-be584e40d15e) 结果：

```
Dim line As String
Dim score As Double = 0
count = 0
While (InlineAssignHelper(line, sr.ReadLine())) IsNot Nothing
    score += Double.Parse(line)
    count += 1
End While
averageScore = CDbl(inValue) / count 
```

InlineAssignHelper 是我没有的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:28:45.580

如果您有文件名，而不仅仅是一个流，您可以使用`System.IO.File.ReadLines`最简洁的方式：

```
Dim score As Double = 0
count = 0

For Each line In File.ReadLines(filename)
    score += Double.Parse(sr.ReadLine())
    count += 1
Next

averageScore = CDbl(inValue) / count 
```

或使用 LINQ：

```
Dim averageScore = File.ReadLines(filename).Average(AddressOf Double.Parse) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:30:36.343

使用带有退出语句的 Do-Loop，如下所示：

```
 Do
        Dim line = sr.ReadLine()
        If line Is Nothing Then Exit Do
        score += Double.Parse(line)
        count += 1
    Loop 
```

请注意这样做比接受的答案的优势，它非常依赖内存使用，并且不需要整个文件适合内存。

# r - 如何根据线性独立列在矩阵中写入线性相关列？

> ID：13088770
> 
> 赞同：8
> 
> 时间：2012-10-26T14:23:45.513
> 
> 标签：r, matrix, linear-algebra

我有一个很大的 mxn 矩阵，并且我已经确定了线性相关的列。但是，我想知道 R 中是否有一种方法可以根据线性独立列来编写线性相关列。由于它是一个大矩阵，因此无法根据检查进行。

这是我拥有的矩阵类型的玩具示例。

```
> mat <- matrix(c(1,1,0,1,0,1,1,0,0,1,1,0,1,1,0,1,0,1,0,1), byrow=TRUE, ncol=5, nrow=4)
> mat
      [,1] [,2] [,3] [,4] [,5]
[1,]    1    1    0    1    0
[2,]    1    1    0    0    1
[3,]    1    0    1    1    0
[4,]    1    0    1    0    1 
```

这里很明显 x3 = x1-x2, x5=x1-x4。我想知道是否有一种自动化的方法来获得更大的矩阵。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T15:19:04.383

我确信有更好的方法，但我想玩这个。我基本上在开始时检查输入矩阵是否是满列秩，以避免在满秩的情况下进行不必要的计算。之后，我从前两列开始并检查该子矩阵是否具有满列等级，如果是，则检查前列，依此类推。一旦我们找到一些不是全列等级的子矩阵，我就会将该子矩阵中的最后一列回归到前一列，这告诉我们如何构造第一列的线性组合以获得最后一列。

我的功能现在不是很干净，可以做一些额外的检查，但至少这是一个开始。

```
mat <- matrix(c(1,1,0,1,0,1,1,0,0,1,1,0,1,1,0,1,0,1,0,1), byrow=TRUE, ncol=5, nrow=4)

linfinder <- function(mat){
    # If the matrix is full rank then we're done
    if(qr(mat)$rank == ncol(mat)){
        print("Matrix is of full rank")
        return(invisible(seq(ncol(mat))))
    }
    m <- ncol(mat)
    # cols keeps track of which columns are linearly independent
    cols <- 1
    for(i in seq(2, m)){
        ids <- c(cols, i)
        mymat <- mat[, ids]
        if(qr(mymat)$rank != length(ids)){
            # Regression the column of interest on the previous
            # columns to figure out the relationship
            o <- lm(mat[,i] ~ mat[,cols] + 0)
            # Construct the output message
            start <- paste0("Column_", i, " = ")
            # Which coefs are nonzero
            nz <- !(abs(coef(o)) <= .Machine$double.eps^0.5)
            tmp <- paste("Column", cols[nz], sep = "_")
            vals <- paste(coef(o)[nz], tmp, sep = "*", collapse = " + ")
            message <- paste0(start, vals)
            print(message)
        }else{
            # If the matrix subset was of full rank
            # then the newest column in linearly independent
            # so add it to the cols list
            cols <- ids
        }
    }
    return(invisible(cols))
}

linfinder(mat) 
```

这使

```
> linfinder(mat)
[1] "Column_3 = 1*Column_1 + -1*Column_2"
[1] "Column_5 = 1*Column_1 + -1*Column_4" 
```

# linux - MPI_SEND 占用大量虚拟内存

> ID：13088772
> 
> 赞同：7
> 
> 时间：2012-10-26T14:23:59.677
> 
> 标签：linux, mpi, infiniband, intel-mpi

在大量内核上调试我的程序时，我遇到了非常奇怪的`insufficient virtual memory`. 我的调查导致代码和平，主人向每个奴隶发送小消息。然后我写了一个小程序，其中 1 个 master 简单地发送 10 个整数，`MPI_SEND`所有的 slave 用`MPI_RECV`. `/proc/self/status`之前和之后的文件比较`MPI_SEND`显示，内存大小之间的差异是巨大的！最有趣的事情（这使我的程序崩溃）是该内存不会在之后释放`MPI_Send`并且仍然占用大量空间。

有任何想法吗？

```
 System memory usage before MPI_Send, rank: 0
Name:   test_send_size                                                                                
State:  R (running)                                                                                  
Pid:    7825                                                                                           
Groups: 2840                                                                                        
VmPeak:   251400 kB                                                                                 
VmSize:   186628 kB                                                                                 
VmLck:        72 kB                                                                                  
VmHWM:      4068 kB                                                                                  
VmRSS:      4068 kB                                                                                  
VmData:    71076 kB                                                                                 
VmStk:        92 kB                                                                                  
VmExe:       604 kB                                                                                  
VmLib:      6588 kB                                                                                  
VmPTE:       148 kB                                                                                  
VmSwap:        0 kB                                                                                 
Threads:    3                                                                                          

 System memory usage after MPI_Send, rank 0
Name:   test_send_size                                                                                
State:  R (running)                                                                                  
Pid:    7825                                                                                           
Groups: 2840                                                                                        
VmPeak:   456880 kB                                                                                 
VmSize:   456872 kB                                                                                 
VmLck:    257884 kB                                                                                  
VmHWM:    274612 kB                                                                                  
VmRSS:    274612 kB                                                                                  
VmData:   341320 kB                                                                                 
VmStk:        92 kB                                                                                  
VmExe:       604 kB                                                                                  
VmLib:      6588 kB                                                                                  
VmPTE:       676 kB                                                                                  
VmSwap:        0 kB                                                                                 
Threads:    3 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-26T15:20:17.627

这是几乎所有在 InfiniBand 上运行的 MPI 实现的预期行为。IB RDMA 机制要求应注册数据缓冲区，即首先将它们锁定到物理内存中的固定位置，然后驱动程序告诉 InfiniBand HCA 如何将虚拟地址映射到物理内存。注册内存以供 IB HCA 使用是非常复杂且因此非常**缓慢**的过程，这就是为什么大多数 MPI 实现从不取消注册曾经注册的内存，希望稍后将相同的内存用作源或数据目标。如果注册的内存是堆内存，它永远不会返回给操作系统，这就是为什么你的数据段只会增加大小。

尽可能重用发送和接收缓冲区。请记住，通过 InfiniBand 进行的通信会产生高内存开销。大多数人并没有真正考虑过这一点，并且通常没有很好的文档记录，但是 InfiniBand 使用了许多特殊的数据结构（队列），这些数据结构被分配在进程的内存中，并且这些队列随着进程的数量而显着增长。在某些完全连接的情况下，队列内存量可能非常大，以至于实际上没有内存可供应用程序使用。

有一些参数可以控制英特尔 MPI 使用的 IB 队列。在您的情况下，最重要的是`I_MPI_DAPL_BUFFER_NUM`控制预分配和预注册内存的数量。它的默认值为`16`，因此您可能需要减小它。请注意可能的性能影响。您还可以尝试通过设置为来使用动态预分配缓冲区`I_MPI_DAPL_BUFFER_ENLARGEMENT`大小`1`。启用此选项后，英特尔 MPI 将首先注册小缓冲区，然后在需要时增加它们。另请注意，IMPI 会延迟打开连接，这就是为什么您仅在调用`MPI_Send`.

如果不使用 DAPL 传输，例如使用`ofa`传输，则您无能为力。`I_MPI_OFA_USE_XRC`您可以通过设置来启用 XRC 队列`1`。这应该以某种方式减少使用的内存。如果您的程序的通信图没有完全连接（完全连接的程序是每个等级与所有其他等级对话的程序），那么通过设置`I_MPI_OFA_DYNAMIC_QPS`为启用动态队列对创建可能会减少内存使用量。`1`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T15:40:25.407

Hristo 的回答大多是正确的，但由于您使用的是小消息，所以会有一点不同。消息最终到达急切路径：它们首先被复制到一个已经注册的缓冲区，然后该缓冲区用于传输，接收者将消息从其末端的急切缓冲区中复制出来。在代码中重用缓冲区只会帮助处理大消息。

这样做正是为了避免注册用户提供的缓冲区的缓慢。对于大消息，复制所需的时间比注册时间长，因此使用会合协议。

这些急切的缓冲区有些浪费。例如，在英特尔 MPI 上，它们默认为 16kB，带有 OF 动词。除非使用消息聚合，否则每条 10 整数大小的消息都会占用四个 4kB 页面。但是无论如何，在与多个接收者交谈时，聚合都无济于事。

那么该怎么办？减小急切缓冲区的大小。这是通过设置急切/集合阈值（`I_MPI_RDMA_EAGER_THRESHOLD`环境变量）来控制的。试试 2048 甚至更小。请注意，这可能会导致延迟增加。或者更改`I_MPI_DAPL_BUFFER_NUM`变量来控制这些缓冲区的数量，或者尝试 Hristo 建议的动态调整大小功能。这假设您的 IMPI 正在使用 DAPL（默认值）。如果您直接使用 OF 动词，DAPL 变量将不起作用。

* * *

**编辑：**所以让它运行的最终解决方案是设置`I_MPI_DAPL_UD=enable`. 我可以推测魔法的起源，但我无法访问英特尔的代码来实际确认这一点。

IB可以有不同的传输模式，其中两种是RC（Reliable Connected）和UD（Unreliable Datagram）。RC 需要主机之间的显式连接（如 TCP），并且每个连接都会消耗一些内存。更重要的是，每个连接都有与之相关的急切缓冲区，这确实加起来了。这是您使用英特尔的默认设置所获得的。

有一个优化可能：在连接之间共享急切的缓冲区（这称为 SRQ - 共享接收队列）。还有一个名为 XRC (eXtended RC) 的 Mellanox 专用扩展，它进一步实现了队列共享：在同一节点上的进程之间。默认情况下，英特尔的 MPI 通过 DAPL 访问 IB 设备，而不是直接通过 OF 动词。我的猜测是这排除了这些优化（我没有使用 DAPL 的经验）。可以通过设置`I_MPI_FABRICS=shm:ofa`和启用 XRC 支持`I_MPI_OFA_USE_XRC=1`（使英特尔 MPI 使用 OFA 接口而不是 DAPL）。

当您切换到 UD 传输时，您会在缓冲区共享之上获得进一步优化：不再需要跟踪连接。在这个模型中，缓冲区共享是很自然的：因为没有连接，所有的内部缓冲区都在一个共享池中，就像 SRQ 一样。因此，可以进一步节省内存，但要付出一定的代价：数据报传递可能会失败，这取决于软件，而不是 IB 硬件来处理重传。当然，这对于使用 MPI 的应用程序代码来说都是透明的。

# h.264 - C++ 中的开源 H.264 解码器

> ID：13088774
> 
> 赞同：0
> 
> 时间：2012-10-26T14:24:03.073
> 
> 标签：h.264, decoding, live555

我正在使用 live555 通过 RTSP 接收网络摄像机视频，该数据是 H264 编码的。是否有任何开源软件可以对接收到的数据包进行解码并将其解析为不同的视频帧？

此致，

迪达克·佩雷斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T07:08:15.420

Yes, ffmpeg can decode the data. Infact you can use ffmpeg directly recieve the data, transcode /transform it to your desired form and send it out again or dump it into a file if you wish. If you want to use live555 for recieving it and ffmpeg for decoding simply write output of live555 to a pipe and feed it to ffmpeg to do the decoding.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T02:24:35.330

I'm confused by your question. live 555 is built on top of ffmpeg, so it has all access to the decoders built into ffmpeg.

# javascript - 在python服务器上执行程序并在html网页上动态更新结果

> ID：13088775
> 
> 赞同：0
> 
> 时间：2012-10-26T14:24:04.363
> 
> 标签：javascript, python, ajax

我有经典的 python 服务器。我制作了一个 CGI 脚本。我想通过单击客户端，在服务器端执行脚本并在客户端动态筛选同一页面中的结果。

我知道如何在客户端动态更新页面，但我没有找到从服务器端进行更新的方法。

例如我的初始网页：

```
print 'Content-type: text/html'# image/svg+xml'
print '''
    <html>
    <head>
    </head>

    <body>
    <h1>My PAGE</h1>

    <a href=#1" onclick="launcher(arg);">Execute my program</a>
    <div id="1" style="display: none;" name="resul1"></div>
    </body>
    </html>
    ''' 
```

当我们点击这种执行时，我想在服务器中执行一个脚本：

```
command = "python myscriptinLocal.py -a %s"%(arg)
process = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
process.wait() 
```

在服务器中生成了一个结果文件，我想在当前页面中筛选结果而不生成新页面....

可能吗？有没有办法用 python 或其他语言做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:36:32.657

您可以使用任何一种 python WSGI 框架来做到这一点。只需使用 Google App Engine 注册一个免费帐户，您就可以立即进行操作。尽管您可能无法生成自己的进程，但没有什么可以阻止您执行 python 脚本并将其输出为 html！Stack 中的 Google 应用引擎页面： [https ://stackoverflow.com/questions/tagged/google-app-engine?sort=votes](https://stackoverflow.com/questions/tagged/google-app-engine?sort=votes)

# php - PHP JS将日期转换为用户时区

> ID：13088778
> 
> 赞同：2
> 
> 时间：2012-10-26T14:24:15.403
> 
> 标签：php, javascript

我有一个页面显示未来事件以及日期（服务器时间）。我需要一些方法来显示用户时间的日期。

示例：
10 月 26 日 13:48:23（服务器）
10 月 26 日 14:48:23（用户时间 (UTC +1)）-> 事件信息

到目前为止我所拥有的：

```
<?php
    $sql=mysql_query("SELECT * FROM table") or die("Come back later");
    while($row=mysql_fetch_array($sql)) {
        echo date('M, d H:i:s', strtotime ($row['date'])).' -> '.$row['info'];
    }
?> 
```

不同的是，我想检测用户时区。

谢谢你。

**编辑** 我知道我不应该使用 mysql_*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:56:19.873

如果您可以在 JavaScript 中转换为用户的时区，您可以执行以下操作：

**PHP**

```
<?php
    $sql=mysql_query("SELECT * FROM table") or die("Come back later");
    while($row=mysql_fetch_array($sql)) {
        echo '<span class="date">' . date('M, d H:i:s', strtotime ($row['date'])) . ' UTC</span> -> '.$row['info'];
    }
?> 
```

**JavaScript**（使用 jQuery 提高可读性）

```
$(function(){
    $('.date').each(function(){
        var $this = $(this);

        // Parse the date string (the format you've given will 
        // work, and the added UTC above will give JavaScript 
        // some context)
        var dateVal = new Date($this.text());

        // JavaScript will convert it to the user's timezone when 
        // stringifying it (helped by the server timezone specified
        // in the PHP.
        $this.text(dateVal.toString()); 
    });
}); 
```

如果您想以格式呈现日期：`Oct, 26 13:48:23`，您可以这样做：

```
var dateString = dateVal.toLocaleString();
var parts = /^\w+ (\w+ \d{1,2}) \d{4} (\d{2}:\d{2}:\d{2})/.exec(dateString);
dateString = parts[1] + ' ' + parts[2]; 
```

然后使用`$this.text(dateString);`将其注入到dom中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:33:55.273

您需要从该日期创建[DateTime](http://php.net/manual/en/class.datetime.php)对象，然后将[DateTimeZone](http://php.net/manual/en/class.datetimezone.php)应用于该对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:40:39.670

您需要从用户那里获取时区。

您可以通过提供一个包含用户可以选择和提交的时区的下拉菜单来完成此操作。为了使这更加用户友好，您可以使用一些 geoip 功能来检测国家和地区，然后确定用户的默认时区。通过 IP 保持在我的那个位置并不是 100% 准确的，而是对用户可能位于何处的有根据的猜测。

或者，您可以使用 ajax 将时区发送到服务器，然后进行相应更新。

# android - 控制 wordpress 类别

> ID：13088782
> 
> 赞同：0
> 
> 时间：2012-10-26T14:24:22.370
> 
> 标签：android, wordpress, android-widget

我正在编写一个用于发布到 wordpress 的 android 应用程序。我已经掌握了博客中的所有类别，但现在希望用户选择应该发布新博客文章的类别。用户可以选择多个类别。

是否有任何树状组件，我可以要求用户展开树并根据需要选择类别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:31:09.353

您可以使用 ExpandableListView。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:28:24.803

您想[使用带有持久列表的对话框](http://developer.android.com/guide/topics/ui/dialogs.html#AddingAList)。

# ssl - IIS 7.5 问题的应用程序初始化模块

> ID：13088788
> 
> 赞同：8
> 
> 时间：2012-10-26T14:24:47.940
> 
> 标签：ssl, initialization, iis-7.5

作为利用 IIS 7.5 的应用程序初始化模块来提高 Web 应用程序初始化速度的概念验证的一部分，我创建了一个托管在启用了 SSL 的 IIS 7.5 (Windows Server 2008 R2) 上的简单 Web 应用程序。请参阅下面的全局和本地设置。

如果我正确理解应用程序初始化模块的工作方式，我希望 IIS 向 appinit.aspx ( `https://localhost/alwaysrunning/appinit.aspx`) 发出请求以初始化 Web 应用程序。然而，这永远不会发生。

有任何想法吗？

属性initializationPage的目的是什么？

对此的任何帮助将不胜感激。

**编辑：**当我禁用 SSL 时，应用程序初始化模块会按预期向 appinit.aspx 发出请求。我需要让它在启用 SSL 的情况下工作。

禅

**applicationHost.config 文件中的全局设置：**

```
<add name="appinit" autoStart="true" startMode="AlwaysRunning">
    <recycling logEventOnRecycle="Time, Requests, Schedule, Memory, IsapiUnhealthy, OnDemand, ConfigChange, PrivateMemory">
        <periodicRestart requests="0" time="00:05:00">
            <schedule>
                <clear />
            </schedule>
        </periodicRestart>
    </recycling>
    <processModel identityType="NetworkService" idleTimeout="00:00:00" />
</add>

<application path="/alwaysrunning" preloadEnabled="true" applicationPool="appinit">
    <virtualDirectory path="/" physicalPath="C:\inetpub\wwwroot\alwaysrunnig" />
</application> 
```

**应用程序的 web.config 文件中的本地设置：**

```
<applicationInitialization remapManagedRequestsTo="splashscreen.htm" skipManagedModules="true" >
    <add initializationPage="/appinit.aspx" />
</applicationInitialization> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-11T20:53:01.483

（我知道，过时的问题，但它没有得到回答，并出现在我自己的谷歌搜索中。）

请参阅 Microsoft 支持的以下文章： [当网站需要 SSL (KB2843964) 时应用程序初始化模块失败](http://support.microsoft.com/kb/2843964)。引用：

> **原因**
> 
> 此行为是设计使然。
> 
> **解析度**
> 
> 要解决此限制，您可以考虑启用 HTTP（取消选中 IIS 管理器/SSL 设置中的“需要 SSL”设置）并使用 URL 重写规则将 HTTP 请求重定向到 HTTPS，但来自预热模块的请求除外：

```
 <rewrite>
   <rules>
     <rule name="No redirect on warmup request (request from localhost with warmup user agent)" stopProcessing="true">
       <match url=".*" />
       <conditions>
         <add input="{HTTP_HOST}" pattern="localhost" /> 
         <add input="{HTTP_USER_AGENT}" pattern="Initialization" /> 
       </conditions> 
       <action type="Rewrite" url="{URL}" /> 
     </rule> 
     <rule name="HTTP to HTTPS redirect for all requests" stopProcessing="true"> 
       <match url="(.*)" /> 
       <conditions> 
         <add input="{HTTPS}" pattern="off" /> 
       </conditions> 
       <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" /> 
     </rule> 
   </rules> 
 </rewrite> 
```

一定会喜欢*“这种行为是设计使然。”* 叹。遗憾的是，我发现的有关此应用程序初始化功能的热门搜索结果并未提及此限制——除非将“HTTP 请求”解释为严格意义上的非安全请求。

# jquery - 在图库中循环图像

> ID：13088790
> 
> 赞同：0
> 
> 时间：2012-10-26T14:25:08.497
> 
> 标签：jquery, fancybox

我正在使用 jquery 创建一个使用**fancybox**的自定义画廊，现在我遇到了问题。每当用户单击下一个/上一个按钮时，我都会调用一个 javascript 方法，该方法将检索有关照片的所有详细信息并动态显示它。但是使用当前的方法我无法实现图像的无限循环。

例如，如果我们有 10 张图片，当用户在第 10 张图片之后点击下一张时，它应该转到第一张图片，并且对于上一个按钮也以这种方式继续循环。我已经尽我所能，但我无法弄清楚。我的代码是

*photoArray 是一个 JSON 数组，其中包含我将在图库中显示的所有照片的信息。*

```
function showNextPrevious(value) {
    var presentPhotoId = $('#presentId').val();
    var length = photoArray.length;
    if(value == "next") {
        for(var i=0; i<photoArray.length; i++) {
            if(i!=length-1) {               
                var id = photoArray[i].photo_id;
                if(id == presentPhotoId) {      
                    var tags = (typeof photoArray[i+1].tags!= "undefined")?photoArray[i+1].tags:"";

                    var caption = photoArray[i+1].caption;
                    var source = photoArray[i+1].owner;
                    var mainPhoto = photoArray[i+1].main_photo;
                    var photoId = photoArray[i+1].photo_id;
                    var path = photoArray[i+1].path;
                    var mediumpath = replaceAll(path,".jpg", "_medium.jpg");
                    var ownerlink = photoArray[i+1].source_link;
                    var owner = photoArray[i+1].owner;

                    $('#tag').text(tags);
                    $('#caption').text(caption);
                    $("#photoCount").text(((i+1)+1)+"/"+photoArray.length);
                    $('#presentId').val(photoId);
                    $('#owner').text(owner);
                    $('#mainphoto').attr("src" , mediumpath);
                    if(owner!='NULL' || owner.length>0) {
                        $('#ownerlink').attr("href" , "http://flickr.com/search/people/?q="+owner);
                        $('#ownerlink').attr("target" , "_blank");
                    } else {
                        $('#ownerlink').attr("href" , "javascript:void('0')");
                        $('#ownerlink').attr("target" , "_self");
                    }

                    if(mainPhoto == "Yes"){
                        $('#mainP').html('<div style="display:block;color:#000000;">Currently the main photo for this city.</div>');
                    } else {
                        $('#mainP').html('<div style="display:block;"><input name="" type="button" class="button-small" value="Make this the main photo for this city" onclick="javascript:changeMainPhoto(\''+photoArray[i+1].photo_id+'\','+photoArray[i+1].city+')" /></div>');
                    }                   
                } // End of if(id == presentPhotoId)
            } 
        }
    } else if(value == "previous") {
        for(var i = 0;i<photoArray.length;i++){
            var id = photoArray[i].photo_id;            
            if(id == presentPhotoId){
                var tags = (typeof photoArray[i-1].tags!="undefined")?photoArray[i-1].tags:"";
                var caption = photoArray[i-1].caption;
                var source = photoArray[i-1].owner;
                var mainPhoto = photoArray[i-1].main_photo;
                var photoId = photoArray[i-1].photo_id;
                var path = photoArray[i-1].path;
                var mediumpath = replaceAll(path,".jpg", "_medium.jpg");
                var ownerlink = photoArray[i-1].source_link;
                var owner = photoArray[i-1].owner;

                $('#tag').text(tags);
                $('#caption').text(caption);
                $('#presentId').val(photoId);
                $('#owner').text(owner);
                $("#photoCount").text(((i-1)+1)+"/"+photoArray.length);
                $('#mainphoto').attr("src" , mediumpath);
                if(owner!='NULL' || owner.length>0) {
                    $('#ownerlink').attr("href" , "http://flickr.com/search/people/?q="+owner);
                    $('#ownerlink').attr("target" , "_blank");
                } else {
                    $('#ownerlink').attr("href" , "javascript:void(0)");
                    $('#ownerlink').attr("target" , "_self");
                }       
                if(mainPhoto == "Yes") {
                    $('#mainP').html('<div style="display:block;">Currently the main photo for this city.</div>');
                } else {
                    $('#mainP').html('<div style="display:block;"><input name="" type="button" class="button-small" value="Make this the main photo for this city" onclick="javascript:changeMainPhoto(\''+photoArray[i-1].photo_id+'\','+photoArray[i-1].city+')" /></div>');
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:02:19.087

如果您的目标是模拟无限循环，那么我建议您执行以下操作之一：

1.  到达数组中的最后一个元素后，将第一个图像“返回”到“起始位置”（换句话说，将其从数组的开头删除并将其添加到末尾）
2.  复制第一个图像并在到达最后一个元素后将其添加到数组的末尾（这可能会导致性能问题，具体取决于 fancybox 的工作方式 - 我不知道它是否真的从 DOM 中删除了已查看的元素，一次它们不再可见）
3.  通过复制第一个元素，将其添加到数组的末尾，然后等到它不再可见以将其从阵列中删除。

我建议您使用选项三 - 它具有最佳安全性，并且它说明您在重复之前没有足够的元素来填充整个滑块。想法是`.offset()`在第一个元素滑动时调用该方法（我假设您可以使用步进函数 - 否则您可能需要一个计时器），然后将`left`偏移量属性的值添加到元素的宽度获取元素的当前结束 x 坐标。将其与滑动容器的起始坐标（静态位置，如果你知道的话，或者容器的偏移量的`left`属性）进行比较，如果容器的偏移量更大，则移除元素。

如果您有任何问题或需要澄清，请告诉我。祝你好运！:)

# php - 如何使用 php Excel 生成漂亮的 PDF？

> ID：13088793
> 
> 赞同：2
> 
> 时间：2012-10-26T14:25:18.470
> 
> 标签：php, pdf, phpexcel

我正在使用最后一个 PHPExcel 版本（我认为是 7.7）。我能够生成我的excel。我必须用tcpdf生成pdf版本，这里没有选择。

但结果是丑陋的和过大的。

![在此处输入图像描述](../Images/527069e768772e38c0e38245aaeb2d81.png)

请参阅 2012-000012 的巨大字体大小，在 excel 中为 11。

如您所见，这里有两个问题。文件过大，边框很烂。

为了摆脱过大的一面，我尝试了这个：

```
$this->printer->getActiveSheet()->getPageSetup()->setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A4); 
```

和这个 ：

```
 $this->printer->getActiveSheet()->getPageSetup()->setScale(50); 
```

比例设置为 50，但不影响输出。那么我怎样才能摆脱这两个问题呢？

这是一个屏幕，我的 excel[如何设置自动换行符 PhpExcel？](https://stackoverflow.com/questions/13071752/how-to-set-auto-line-break-phpexcel).

**更新 ：**

通过将单元格间距设置为 0 边界几乎可以按预期处理，仍然是一个小问题，可能是由过大的问题引起的。

看 ：

![在此处输入图像描述](../Images/b85ed2fa6950ee8ea93da0b4f90cf668.png)

是否有选项或方法调用将其设置为 0 ？

这位于 writer\html.php 第 915 行，因为我不显示网格线。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-02-05T03:08:28.170

要删除您认为令人反感的边框，请关闭要在 pdf 中呈现的每张纸上的网格线。

例如：$objPHPExcel->getActiveSheet()->->setShowGridlines(false);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-24T09:31:55.810

为了解决这个问题，我做了两个操作。

第一步是为 PHPexcel 对象设置方向

```
$objPHPExcel->getActiveSheet()->getPageSetup()->setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE); 
```

第二步 - 为 PHPExcel 对象设置不同的纸张大小：

```
$objPHPExcel->getActiveSheet()->getPageSetup()->setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A2_PAPER); 
```

然后将 PHPExcel 对象转换为对象编写器

```
$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'PDF');

$objWriter->setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);

$objWriter->setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A2_PAPER); 
```

这对我有用。我还更改了 PHPExcel 对象内的字体大小 - 就像标题一样

```
$objPHPExcel->setActiveSheetIndex($lastsheet)->getStyle("A1:K3")->applyFromArray(
         array(
            'font'  => array(
                'size'  => 8
            )
         )
        ); 
```

对于其余数据：

```
$objPHPExcel->getDefaultStyle()->getFont()->setName('Arial')->setSize(8); 
```

现在我试图获得 tcPDF 生成的丑陋边框和文件末尾的另一行......

# c++ - C++ 录制音频并压缩到 GSM

> ID：13088795
> 
> 赞同：1
> 
> 时间：2012-10-26T14:25:20.417
> 
> 标签：c++, audio, gsm

我正在开发一个记录音频并将其压缩为 GSM 的 C++ 程序。我能够录制音频并将原始数据写入文件。但我无法让 GSM 压缩工作。我正在尝试使用在此网站[ftp://ftp.cs.cmu.edu/project/fgdata/speech-compression/GSM/gsm_13200bps](ftp://ftp.cs.cmu.edu/project/fgdata/speech-compression/GSM/gsm_13200bps)上找到的源代码进行压缩。

我认为我的问题是使用 gsm_encode() 函数时。播放此文件时，将压缩数据编码并保存到文件后，它是听不见的。我知道原始音频数据是正确的，但压缩的音频数据是不正确的。

gsm_encode() 将 160 个 13 位样本的数组（以 gsm_signal 的形式给出，至少 16 位的有符号整数值）编码为 33 字节的 gsm_frame。

这是我的函数我是否将数据错误地发送到 gsm_encode() 中？或者我的功能还有其他问题吗？谢谢您的帮助 ：）

```
int CAudioGSM::CompressAudio(unsigned char * pRawBuffer, _int32 uiRawBufferSize, unsigned char  * pCompressedBuffer, _int32 uiCompressedBufferSize)
{
// Note: uiRawBufferSize must be a multiple of 640 (AUDIO_DMA_DESCRITOR_LEN)
if(!pRawBuffer || uiRawBufferSize == 0 || !pCompressedBuffer || uiCompressedBufferSize == 0 ||  uiRawBufferSize % AUDIO_DMA_DESCRITOR_LEN != 0)
{
    return -1; //invalid parameters
}

_int32 uiBytesCompressed = 0; // Number of bytes that have been compressed. At the end of the function this should be equal to iRawBufferSize meaning we have compressed the whole raw buffer
_int32 uiCompBuffOffset = 0; // Offset into the compressed buffer

while(uiBytesCompressed < uiRawBufferSize)
{
    if(uiCompressedBufferSize - uiCompBuffOffset < GSM_OUTPUT_SIZE || uiCompBuffOffset >= uiCompressedBufferSize)
    {
       return -2; // Compressed buffer is too small
    }

    gsm_encode(&m_GSM_EncodeStruture,(long *)pRawBuffer,m_Buffer);
    //Now we need to move the data to compressed buffer
    if(m_bFirstHalfOfBlockRecord)
    {
       //Just copy the data over
       memcpy(&pCompressedBuffer[uiCompBuffOffset],m_Buffer,GSM_OUTPUT_SIZE_FIRST_HALF);
       m_bFirstHalfOfBlockRecord = false;
       uiCompBuffOffset += GSM_OUTPUT_SIZE_FIRST_HALF;
    }
    else
    {
       memcpy(&pCompressedBuffer[uiCompBuffOffset],m_Buffer,GSM_OUTPUT_SIZE);
       m_bFirstHalfOfBlockRecord = true;
       uiCompBuffOffset += GSM_OUTPUT_SIZE;
    }

    uiBytesCompressed += AUDIO_DMA_DESCRITOR_LEN;
}

return uiCompBuffOffset; // Success, we have compressed the buffer return compressed data size
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:00:48.697

没关系，我发现它 pRawBuffer 永远不会增加它应该是

```
gsm_encode(&m_GSM_EncodeStruture,(long *)&pRawBuffer[uiBytesCompressed],m_Buffer); 
```

# linux - linux中要执行的文件顺序以及如何更改它

> ID：13088800
> 
> 赞同：1
> 
> 时间：2012-10-26T14:25:32.053
> 
> 标签：linux, execution

执行命令时，linux搜索可执行文件以执行的顺序是什么。我有以下内容：

1.  /bin/播放
2.  /home/prabhat/playframework/play

以上两个文件都在路径中。

当我从我的主目录执行它时，如下所示

```
prabhat@localhost~/home/prabhat/$ play 
```

/bin/play 被执行。

linux搜索要执行的文件的顺序是什么。有没有办法改变它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T14:26:49.173

The order is defined by the entry order in your [PATH](http://www.linfo.org/path_env_var.html) variable.

Note that your shell may cache this info and when you change the PATH you may need to refresh this cache. In `bash` this is done by the `hash` command. See [here](http://www.thegeekstuff.com/2010/08/bash-shell-builtin-commands/) for more information.

> hash command maintains a hash table, which has the used command’s path names. When you execute a command, it searches for a command in the variable $PATH. But if the command is available in the hash table, it picks up from there and executes it

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:28:24.237

you need to move /home/prabhat/playframework/ before /bin in your path. you should be able to do this in your .bashrc or .bash_profile

something along the lines of:

```
export PATH=/home/prabhat/playframework/play:$PATH 
```

hope this helps

# symfony - Symfony 2 文件约束

> ID：13088805
> 
> 赞同：0
> 
> 时间：2012-10-26T14:25:54.783
> 
> 标签：symfony

我有一个处理创建文件上传表单的标准类，我想为字段添加一些验证，例如 maxSize。

这是我的 $collectionConstraint。这不起作用。

```
$collectionConstraint = new Collection(
    array(
        'fields' => array(
            'file_1'            => array(new FileValidator(array('maxSize' => '4M'))),
            'file_2'            => array()
        )
    )
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T15:48:36.397

我认为您的 $collectionConstraints 应该如下所示：

```
$collectionConstraints = new \Symfony\Component\Validator\Constraints\Collection(array(
    'fields' => array(
        'file1' => new \Symfony\Component\Validator\Constraints\File(array('maxSize' => '4M'),
    ),
); 
```

有关使用约束集合的更多信息，[请参见此处。](http://symfony.com/doc/master/reference/constraints/Collection.html)

# c - Shell 脚本与 C 性能

> ID：13088807
> 
> 赞同：11
> 
> 时间：2012-10-26T14:26:03.820
> 
> 标签：c, performance, bash, shell

我想知道从 C 迁移到 shell 脚本的程序的性能会有多糟糕。

我有密集的 I/O 操作。

例如，在 C 语言中，我有一个从文件系统文件读取并写入另一个文件的循环。我在没有任何一致关系的情况下占用每条线的一部分。我正在使用指针来执行此操作。一个非常简单的程序。

在 Shell 脚本中，为了移动一行，我使用`${var:(char):(num_bytes)}`. 处理完每一行后，我只需将其连接到另一个文件。

```
"$out" >> "$filename" 
```

该程序执行以下操作：

```
while read line; do
    out="$out${line:10:16}.${line:45:2}"
    out="$out${line:106:61}"
    out="$out${line:189:3}"
    out="$out${line:215:15}"
    ...
    echo "$out" >> "outFileName"

done < "$fileName" 
```

问题是，C 处理一个 400MB 的文件需要半分钟，而 shell 脚本需要 15 分钟。

我不知道我做错了什么或没有在 shell 脚本中使用正确的运算符。

编辑：我不能使用 awk 因为没有模式来处理该行

我尝试评论“echo $out”>>“$outFileName”，但并没有变得更好。我认为问题在于 ${line:106:61} 操作。有什么建议么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:29:24.740

根据您的描述，我怀疑您正在 shell 脚本中生成新进程。如果是这样的话，那么这就是你的时间去的地方。[分叉/执行](http://www.bottomupcs.com/fork_and_exec.html)一个新进程需要大量操作系统资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-02T16:33:01.153

正如捐赠者和迪特里希所建议的那样，我对 AWK 语言做了一些研究，而且，正如他们所说，这是完全成功的。这是 AWK 程序的一个小例子：

```
#!/bin/awk -f
{
    option=substr($0, 5, 9);

    if (option=="SOMETHING"){
        type=substr($0, 80, 1)
        if (type=="A"){
            type="01";
        }else if (type=="B"){
            type="02";
        }else if (type=="C"){
            type="03";
        }

        print substr($0, 7, 3) substr($0, 49, 8) substr($0, 86, 8) type\
        substr($0, 568, 30) >> ARGV[2]

    }
} 
```

它就像一个魅力。处理一个 500mb 的文件只需要 1 分钟

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T15:12:16.810

C程序有什么问题？它坏了吗？维护太难？太不灵活？您更像是壳牌专家而不是 C 专家？

**如果它没有坏，就不要修理它。**

看看 Perl 也可能是一种选择。比 C 更容易修改，而且 I/O 速度仍然很快；在 Perl 中创建无用的分支比在 shell 中要困难得多。

如果您确切地告诉我们 C 程序的作用，也许在 Unix 工具箱中有一个简单且比光速更快的解决方案，其中包含 sed、grep、awk 或其他 gizmo。换句话说，告诉我们*您真正想要实现的目标*，不要要求我们解决您在追求您认为朝着实际目标迈出的一步时遇到的一些随机问题。

好的，您的 shell 脚本的一个问题是重复`open`的`echo "$out" >> "outFileName"`. 改用这个：

```
while read line; do
    echo "${line:10:16}.${line:45:2}${line:106:61}${line:189:3}${line:215:15}..." 
done < "$fileName" > "$outFileName" 
```

作为替代方案，只需使用该`cut`实用程序（但请注意，它不会在第一部分之后插入点）：

```
cut -c 10-26,45-46,106-166 "$fileName" > "$outFileName" 
```

你明白吗？

# javascript - RAILS3 // JS 执行；咖啡不

> ID：13088825
> 
> 赞同：-2
> 
> 时间：2012-10-26T14:27:42.757
> 
> 标签：javascript, ruby-on-rails-3, coffeescript

很高兴在某些 Rails 应用程序中开始使用 coffescript。但是，经过一些项目，有些困难。

下面的代码翻译得很好，但是咖啡没有做任何事情

JS：

```
(function(){
  var wf = document.createElement('script');
  wf.src = "/assets/libraries/webfonts.js";
  wf.type = 'text/javascript';
  wf.async = 'true';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(wf, s);
})();
WebFontConfig = {
  custom:{
    families: ['tb', 'tr'],
    urls: [ '/assets/1.fonts.css' ]
  }
} 
```

咖啡 ：

```
(->
  wf = document.createElement("script")
  wf.src = "/assets/libraries/webfonts.js"
  wf.type = "text/javascript"
  wf.async = "true"
  s = document.getElementsByTagName("script")[0]
  s.parentNode.insertBefore wf, s
)()
WebFontConfig = custom:
  families: ["tb", "tr"]
  urls: ["/assets/1.fonts.css"] 
```

我可以列出其他示例，但我经常面对这个“js 有效/咖啡无效”问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T15:56:56.530

您的 Coffee 代码将转换为这样的 javascript：

```
(function(){
  var WebFontConfig;

  (function() {
    var s, wf;
    wf = document.createElement("script");
    wf.src = "/assets/libraries/webfonts.js";
    wf.type = "text/javascript";
    wf.async = "true";
    s = document.getElementsByTagName("script")[0];
    return s.parentNode.insertBefore(wf, s);
  })();

  WebFontConfig = {
    custom: {
      families: ["tb", "tr"],
      urls: ["/assets/1.fonts.css"]
    }
  };
}) 
```

如您所见，您使用的是上下文的 WebFontConfig，而不是窗口上下文。

所以，我建议你做这样的事情：

```
window.WebFontConfig = custom:
  families: ["tb", "tr"]
  urls: ["/assets/1.fonts.css"] 
```

我坚信这将解决您的问题。此外，您的 Coffee 文件已执行，它只是不符合您的预期。

希望能帮助到你。

# visual-studio - 使用 Visual Studio 2012 找不到页面“312e8a59-2712-48a1-863e-0ef4e67961fc”

> ID：13088826
> 
> 赞同：61
> 
> 时间：2012-10-26T14:27:55.643
> 
> 标签：visual-studio

当我单击 Team Explorer 的主页图标时，出现以下错误：

> 找不到页面“312e8a59-2712-48a1-863e-0ef4e67961fc”而不是所有选项。

因为我重新安装了 Visual Studio 2012 Ultimate 试用版并安装了 Visual Studio 2012 Premium 版，所以我遇到了这个错误。修复和重新安装没有成功。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2014-02-12T13:00:29.673

要解决此问题，请以管理员身份从 Visual Studio 命令提示符运行：

```
devenv /setup 
```

它不会弄乱您的环境，之后您可以继续使用 Visual Studio，这是我的经验。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2016-03-23T16:27:13.307

我在 Visual Studio 2013 中遇到了同样的错误并尝试了：

*控制面板*→*程序*.... → *Visual Studio* →*修复*

*它不起作用*

```
devenv /setup 
```

*它不起作用*

```
devenv /clearcache
devenv /updateconfiguration 
```

*它不起作用*

然后解决方案：

*   *关闭所有 Visual Studio 实例
*   删除 %LOCALAPPDATA%\Microsoft\VisualStudio\12.0\ComponentModelCache 文件夹
*   启动 Visual Studio

在这篇博文中有更详细的解释：*[当 EditorPackage 没有正确加载时](http://www.rajapet.com/2014/02/when-the-editorpackage-does-not-load-correctly.html)*

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-05-02T15:49:28.903

我在 Visual Studio 2013 Ultimate - Windows 8 上遇到此错误：

![团队资源管理器错误](../Images/5465742a3bffbe0442090d74d33e4d76.png)

我运行这个命令解决了这个问题：

```
X64: devenv.exe /resetskippkgs
x86: C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\IDE\devenv.exe /resetskippkgs 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-01-08T17:02:01.967

> 我遇到了类似的问题。跑步`devenv /setup`对我没有帮助。

只是想分享一些额外的信息：

起初，`devenv /setup`也没有帮助我。然后我意识到我使用了错误的 Visual Studio 命令提示符版本。

确保`devenv /setup`为适当的 Visual Studio 版本运行。

例如：对于 Visual Studio 2013，使用 Visual Studio 2013“Visual Studio Tools”文件夹下的“开发人员命令提示符”。

*就像所选答案中所述，以管理员身份运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-12T01:07:36.700

我运行了建议的命令：**devenv /setup**。它对我不起作用。（视觉工作室 2015）

然后我尝试了一些不同的东西：

-> 以管理员身份运行 Visual Studio，运行命令后。

**然后问题就解决了。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-13T13:43:42.123

以管理员身份运行 Visual Studio 为我解决了这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-29T10:08:10.750

重新安装 Visual Studio 2012 试用版后，我从未删除过文档目录。在这个目录中有一些备份文件。这可能导致了问题。

删除此目录并再次安装 Visual Studio 2012 Premium 后，问题就解决了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-14T23:54:30.830

我遇到了类似的问题。运行**devenv /setup**对我没有帮助。

我发现*[Fixing 312e8a59-2712-48a1-863e-0ef4e67961fc-not-found-vs-2012](http://hjerpbakk.com/blog/2014/7/25/no-content-in-solution-explorer-using-visual-studio-201)*。此链接表明我最近可能安装了一些 Visual Studio 扩展，这可能损坏了 Visual Studio 维护的缓存。我卸载了几个最新的 Visual Studio 扩展，它在 Visual Studio 重新启动后解决了这个问题。Visual Studio 能够与 TFS 连接 :-)。

*可以在菜单工具*→ *“扩展和更新...”中找到 Visual Studio 扩展。转到*已安装*部分下的*“全部”*部分。它将显示所有 Visual Studio 扩展。

 ** * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-10T15:06:38.357

我有一个类似的错误，然后我尝试运行“devenv /setup”，但没有好的结果。那是因为您没有尝试使用特定版本的 Visual Studio 命令提示符。然后我打开特定版本“Visual Studio 2013”​​的命令提示符，问题就解决了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-29T17:24:39.993

我在 Visual Studio 2013 中遇到了同样的问题。我重命名`ComponentModelCache`为`ComponentModelCache2`，它修复了它。

```
C:\Users\{..}\AppData\Local\Microsoft\VisualStudio\12.0\ComponentModelCache 
```*

# c# - 带有事件名称 lambda 表达式和自定义事件访问器的 WeakEventManager

> ID：13088829
> 
> 赞同：6
> 
> 时间：2012-10-26T14:28:08.810
> 
> 标签：c#, .net, weak-events

我一直在寻找使用弱事件模式订阅事件。使用 .NET 4.5 框架，我们有一个看起来很漂亮的[WeakEventManager](http://msdn.microsoft.com/en-us/library/hh199438.aspx)类。弱订阅事件就像

```
WeakEventManager<EventSource, SomeEventEventArgs>.AddHandler(source, "SomeEvent", source_SomeEvent); 
```

但是，我不是“字符串类型”代码的忠实拥护者。我一直在尝试找到一种方法来使用要订阅的事件的字符串名称。我发现获取事件名称的[唯一方法](https://stackoverflow.com/questions/2392152/retrieving-event-name-from-lambda-expression)是在定义事件的类中使用 lambda 表达式。在我的场景中，我拥有定义事件的类，因此我可以随意更改它。我一直在尝试找到一种干净的方式来订阅和取消订阅我的活动，这是我最不喜欢的。

```
public event EventHandler<EventArgs> LoggingOn;
public event EventHandler<EventArgs> LoggingOn_Weak
{
    add
    {
        var eventName = this.GetEventName(() => this.LoggingOn);
        WeakEventManager<CurrentUser, EventArgs>.AddHandler(this, eventName, value);
    }

    remove
    {
        var eventName = this.GetEventName(() => this.LoggingOn);
        WeakEventManager<CurrentUser, EventArgs>.RemoveHandler(this, eventName, value);
    }
}

// In a base class view model in my scenario
private string GetEventName<T>(System.Linq.Expressions.Expression<Func<T>> expression)
{
    return (expression.Body as System.Linq.Expressions.MemberExpression).Member.Name;
}

protected void OnLoggingOn(object sender, EventArgs e)
{
    var handler = this.LoggingOn;
    if (handler != null)
    {
        handler(sender, e);
    }
} 
```

Using [custom event accessors](http://msdn.microsoft.com/en-us/library/bb882534.aspx) I was able to avoid clunky (in my opinion) methods like LoggingOn_Subscribe(EventHandler) or adding name properties for each event. Unfortunately it is not so intuitive in that people subscribing to the event are doing so in the classic manner but have no idea other than the "_Weak" part of the name that indicates it is being subscribed to weakly.

As for my questions..

1) I have never used weak events or custom event accessors before. The code above appears to work, however, I would just like to make sure there is nothing technically wrong with it. Is there anything I'm doing here to shoot myself in the foot?

2) From a design perspective, is this a terrible idea? Are there any major design concerns I should consider? Is there better alternative? Should i just suck it up and subscribe from my subscriber using a stringly-typed event name?

Thoughts?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-12-05T00:49:18.417

With .NET 4.6 you can now use the nameof() expression:

```
WeakEventManager<IMyGrid, MyEventArgs>.AddHandler(myGrid, nameof(IMyGrid.MouseDown), OnMouseDown); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-26T18:10:58.817

What you could do is use the built-in System.ComponentModel.EventHandlerList. This class is a container for all of your object's event handler delegates. The primary benefit is that no storage is allocated on your object for each event unless there is actually someone subscribed to an event.

The secondary benefit is that in order to use it, you must provide a key for your event.

```
class MyObject
{
    protected EventHandlerList Events = new EventHandlerList();

    public static Event1Key = new object();
    public event Event1
    {
        add { Events.AddHandler(Event1Key, value); }
        remove { Events.RemoveHandler(Event1Key, value); }
    }
} 
```

Now you could create a variation of WeakEventManager that accepted keys rather than string names. So the consumer could say

```
WeakEventManager<EventSource, SomeEventEventArgs>.AddHandler(source, EventSource.Event1Key, source_SomeEvent); 
```

# spring - Spring中“addError(ObjectError error)”和“rejectValue(String field, String errorCode)”的区别

> ID：13088835
> 
> 赞同：2
> 
> 时间：2012-10-26T14:28:24.503
> 
> 标签：spring, spring-mvc

我试图了解以下之间的区别：

*   **void addError(ObjectError error) (来自 org.springframework.validation.Errors)**
*   **void rejectValue(String field, errorCode) (来自 org.springframework.validation.BindingResult)**

我确实阅读了 Spring javadocs，但无法理解两者之间的区别。

谁能提供解释或代码示例？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-27T09:46:19.423

`rejectValue`简单地封装对 addError() 提供`ObjectError`或`FieldError`实例的调用。

根据 javadoc`addError()`只支持`ObjectError`And `FieldError`，所以它不是关于创建自定义 ObjectErrors

> 无效 org.springframework.validation.BindingResult.addError（ObjectError 错误）
> 
> 将自定义 ObjectError 或 FieldError 添加到错误列表中。旨在通过 BindingErrorProcessor 等合作策略使用。

所以`addError()`更适合框架开发者并且`rejectValue()`是要走的路。

# c# - 使用泛型类型的方法的单元测试

> ID：13088837
> 
> 赞同：1
> 
> 时间：2012-10-26T14:28:27.910
> 
> 标签：c#, unit-testing, generics

我正在使用 Microsoft Unit Test 对我的 .NET 类进行单元测试。我有使用泛型类型的方法，当我使用向导时，它会创建两种方法，一种是使用 GenericParameterHelper 的助手。

我可以将测试更新为特定类型，但我想知道测试泛型的最佳方法是什么。

以下是单元测试向导生成的两种测试方法：

```
 public void ContainsKeyTestHelper<TKey, TValue>()
    {
        IDictionary<TKey, TValue> dictionaryToWrap = null; // TODO: Initialize to an appropriate value
        ReadOnlyDictionary<TKey, TValue> target = new ReadOnlyDictionary<TKey, TValue>(dictionaryToWrap); // TODO: Initialize to an appropriate value
        TKey key = default(TKey); // TODO: Initialize to an appropriate value
        bool expected = false; // TODO: Initialize to an appropriate value
        bool actual;
        actual = target.ContainsKey(key);
        Assert.AreEqual(expected, actual);
    }

    [TestMethod()]
    public void ContainsKeyTest()
    {
        ContainsKeyTestHelper<GenericParameterHelper, GenericParameterHelper>();
    } 
```

我正在测试的方法（来自自定义 ReadOnlyDictionary （[https://cuttingedge.it/blogs/steven/pivot/entry.php?id=29](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=29)））：

```
/// <summary>Determines whether the <see cref="T:ReadOnlyDictionary`2" />
/// contains the specified key.</summary>
/// <returns>
/// True if the <see cref="T:ReadOnlyDictionary`2" /> contains
/// an element with the specified key; otherwise, false.
/// </returns>
/// <param name="key">The key to locate in the
/// <see cref="T:ReadOnlyDictionary`2"></see>.</param>
/// <exception cref="T:System.ArgumentNullException">
/// Thrown when the key is null.
/// </exception>
public bool ContainsKey(TKey key)
{
    return this.source.ContainsKey(key);
} 
```

我应该使用什么值来初始化每个具有 TODO 的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T20:14:34.363

您正在自定义版本的 ReadOnlyDictionary 中测试 ContainsKey 方法。在这种情况下，我相信要测试的主要点是，一旦将键添加到字典中，该方法在使用该键调用时返回 true。

在这种情况下，只要在检查已添加 / 未添加的键时获得正确的真 / 假响应，具体是实际放入字典中的内容并不重要。

因此，在您的测试中，您可以只删除 TODO，因为您不关心数据是什么。

再深入一点，您的自定义类似乎只是**源**成员的包装器（至少对于此方法而言）。对你的类进行单元测试的另一种方法可能是注入源代码并使用模拟来确定源代码是否被正确操作，而不是测试实际的字典功能是否正常工作。在不了解您的班级的情况下，目前很难说哪种方法更好。

# android - 计算不同移动设备中每个点的固定比率

> ID：13088840
> 
> 赞同：0
> 
> 时间：2012-10-26T14:28:34.073
> 
> 标签：android, cordova, touch, resolution

我想为显示中的每个点设置一个固定比率，以便我可以识别它们并采取适当的措施。我有一个 xml 文件，它向我展示了当我在特定点接触时该怎么做，例如：

```
<page num="1">
    <touch coordinate_x="3/4" coordinate_y="1/4">
        <sound>/Sounds/BTSP/p1/1.wav</sound>
    </touch>
</page> 
```

我应该检测（计算）那些 x 和 y 坐标比。我使用这种技术检测触摸：

```
document.addEventListener("touchstart", Clicked, false);
function Clicked(){
    var x = event.touches[0].pageX;
    var y = event.touches[0].pageY;
    alert(x+"::::"+y);
    } 
```

但我应该将我从 event.touches 获得的这些 x 和 y 除以某些东西（显示分辨率），这给了我一些独特的数字。你有什么建议？

# drop-down-menu - jQuery 切换菜单正在滑动

> ID：13088845
> 
> 赞同：1
> 
> 时间：2012-10-26T14:28:56.177
> 
> 标签：drop-down-menu, jquery

我有一个菜单：http: [//jsfiddle.net/paTNz/2/](http://jsfiddle.net/paTNz/2/)

如果你在“English”这个词的正下方看到一两个像素，菜单就会砰地一声关上。我无法理解，因为该事件绑定到`li`涵盖其中所有内容的外部项目：“英语”href 和子菜单。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:37:09.990

那只是因为你的菜单之间有几个像素的空间。

轻松修复只需在链接中添加一些填充以占用空间，

[http://jsfiddle.net/paTNz/3/](http://jsfiddle.net/paTNz/3/)

```
.info li.lang a {padding-bottom:3px} 
```

# algorithm - 使用动态规划的装箱

> ID：13088849
> 
> 赞同：1
> 
> 时间：2012-10-26T14:29:09.323
> 
> 标签：algorithm, bin-packing

> **问题陈述**：您有 n1 件尺寸为 s1 的物品，n2 件尺寸为 s2 的物品，以及 n3 件尺寸为 s3 的物品。您希望将所有这些物品装入每个容量为 C 的箱子中，以使使用的箱子总数最小化。

我的解决方案：

```
Bin(C,N1,N2,N3) = max{Bin(C-N1,N1-1,N2,N3)+N1 if N1<=C and N1>0,
                      Bin(C-N2,N1,N2-1,N3)+N2 if N2<=C and N2>0,
                      Bin(C-N3,N1,N2,N3-1)+N3 if N3<=C and N3>0,
                      0 otherwise} 
```

上述解决方案仅有效地填充单个箱。有人可以建议如何修改上述关系，以便我有效地获得用于包装物品的总箱吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-17T14:33:29.240

**问题** 你有 n1 件大小为 s1 的物品和 n2 件大小为 s2 的物品。您必须将所有这些物品打包到每个容量 C 的箱子中，以使使用的箱子总数最小化。为这种包装设计一个多项式时间算法。

这是我对这个问题的解决方案，它与您所要求的非常相似。

**DP方法** 假设Bin(i, j)给出使用的最小bin总数，那么Bin(i, j) = min{Bin(i′, j′) + Bin(i - i′,j - j′)}其中 i + j > i′ + j′ > 0。将有 n^2 - 2 个不同的 (i′,j′) 组合和一对 (n1,n2) 组合。所以复杂度约为 O(n^2)。

**复杂度** O(n^2)

示例：设 s1 = 3，n1 = 2，s2 = 2，n2 = 2，C = 4。找到所需的最小 bin，即 b。

```
<pre>
i j b
- - -
0 1 1
0 2 2
1 0 1
1 1 1
1 2 2
2 0 2
2 1 3
2 2 3  -> (n1,n2) pair
</pre> 
```

如您所见，需要 3 个垃圾箱。

```
<pre>
Note that Bin(2,2) = min{
  Bin(2,1) + Bin(0,1), 
  Bin(2,0) + Bin(0,2),
  Bin(1,2) + Bin(1,0),
  Bin(1,1) + Bin(1,1)} 
= min{3, 4} 
= 3
</pre> 
```

# c# - 如何在 C# 中读取 Windows.UI.XAML.Style 属性

> ID：13088851
> 
> 赞同：4
> 
> 时间：2012-10-26T14:29:09.887
> 
> 标签：c#, xaml, windows-runtime, winrt-xaml

我正在编写一个类，它将 HTML 文档转换为可与 Windows 8 应用程序中的 RichTextBlock 一起使用的 Paragrpahs 列表。我希望能够为类提供在 XAML 中定义的样式列表，并且该类将从样式中读取有用的属性并应用它们。

如果我有 Windows.UI.XAML.Style`style`我如何从中读取属性？我试过

```
var fontWeight = style.GetValue(TextElement.FontWeightProperty) 
```

对于`style`在 XAML 中定义的 TargetProperty="TextBlock" 但这会失败并出现异常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T16:58:00.813

你可以试试这个：

```
var fontWeightSetter =
    style.Setters.Cast<Setter>().FirstOrDefault(
        setter => setter.Property == TextElement.FontWeightProperty);

var fontWeight =
    fontWeightSetter != null ?
        (FontWeight)fontWeightSetter.Value :
        FontWeights.Normal; 
```

或检查是否有效：

```
public static class StyleExtensions
{
    // Untested
    public static object GetPropertyValue(this Style style, DependencyProperty property)
    {
        var setter =
            style.Setters.Cast<Setter>().FirstOrDefault(
                s => s.Property == property);
        var value = setter != null ? setter.Value : null;

        if (setter == null &&
            style.BasedOn != null)
        {
            value = style.BasedOn.GetPropertyValue(property);
        }

        return value;
    }
} 
```

# sql - SQL Server：添加 CSV 可编程

> ID：13088856
> 
> 赞同：0
> 
> 时间：2012-10-26T14:29:18.107
> 
> 标签：sql, sql-server, sql-server-2008

我有以下代码将 CSV 文件插入临时表：

```
USE [websitehere.com].[dbo]
GO
CREATE TABLE [websitehere.com].[dbo].[tmpTable]
(ID INT,
    Caller_Number VARCHAR(100),
    Caller_Name VARCHAR(100),
    GroupBy VARCHAR(100),
    Campaign_Name VARCHAR(100),
    DateAndTime VARCHAR(100),
    Duration VARCHAR(100),
    Call_Status VARCHAR(100))
GO;

BULK
INSERT tmpTable 
FROM 'C:\Users\namehere\Documents\CallLog.csv' 
WITH
(
    FIELDTERMINATOR = ',',
    ROWTERMINATOR = '\n'
)
GO 
```

但...

1.  它似乎没有添加`tmpTable`. 它给了我一个错误

    > *消息 102，级别 15，状态 1，第 1 行
    > '.' 附近的语法不正确。*

2.  它不会添加插入命令说

    > *Msg 4834, Level 16, State 4, Line 8
    > 您没有使用批量加载语句的权限。*

任何帮助都可以解决这两个错误！

**更新**

![db 用户安全](../Images/7708a150953acde0adfc8e68e9fa06fd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:33:16.250

线

```
USE [websitehere.com].[dbo] 
```

应该说

```
USE [websitehere.com] 
```

第二个错误应该通过为您的用户分配适当的权限或角色成员来修复。您需要 INSERT 和 ADMINISTER BULK OPERATIONS 权限。也许更多，这取决于您的批量插入语句可能具有的其他选项。

您可能想使用一些测试用户帐户尝试此操作：

```
USE master;
GO
CREATE LOGIN bulkuser WITH PASSWORD = 'P@ssw0rd';
GRANT ADMINISTER BULK OPERATIONS to bulkuser;

USE [websitehere.com]
GO
CREATE USER bulkuser FOR LOGIN bulkuser;
EXEC sp_addrolemember 'db_datareader', 'bulkuser'
GRANT INSERT ON [dbo].[tmpTable] TO bulkuser; 
```

然后以“bulkuser”身份登录并尝试运行 BULK INSERT 语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T20:53:42.410

啊找到了我需要授予访问权限才能使用它的地方！

![](../Images/a99b55c9deaae7c04530581f3e96557d.png)

```
Right-click on your database table > 
properties > 
select Permissions from the left panel >
click the blue link "View server permissions" >
check "Grant" for "Administer bulk operations" >
Ok > Ok > Done! 
```

# android - 在片段中滑动

> ID：13088860
> 
> 赞同：0
> 
> 时间：2012-10-26T14:29:33.160
> 
> 标签：android, android-fragments, android-tabhost

我正在构建一个使用 tabhost 的应用程序。在每个选项卡中都有一个片段，因此用户可以滑动浏览每个片段。我想要每个片段中的不同按钮，但它们在 tabhost 上，这样它们就不会滑动。因此，我动态更改了 tabhost 的 onTabChanged() 方法中的每个按钮。但这会导致速度变慢，实际上会冻结一点。我什至试着把它放在一个线程上，但它没有任何区别。你知道我可以用什么方法让屏幕上的滑动再次变得流畅吗？感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:08:27.743

你的解释真的很模糊，但据我所知，你想要做的是将按钮移动到标签主机之外，并在点击事件中使用类似的东西：

```
 switch(tabHost.getCurrentTab(){
        // do stuff 
    } 
```

# ruby - 红宝石，二叉树大小

> ID：13088866
> 
> 赞同：0
> 
> 时间：2012-10-26T14:29:49.233
> 
> 标签：ruby

下面是我的代码。我想找到二叉树的大小。到目前为止的代码输出一个随机数。

```
def size
    size=1
    size +=@lchild.size unless @lchild.nil?
    size +=@rchild.size unless @richild.nil?
    size
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:45:12.803

试试这个。

```
默认大小（节点）
  如果node.nil？
    0
  别的
    大小（node.left）+ 1 + 大小（node.right）
  结尾
结尾

```

.

# javascript - 无法使用 javascript 在 ie7 中关闭当前选项卡

> ID：13088869
> 
> 赞同：0
> 
> 时间：2012-10-26T14:29:57.547
> 
> 标签：javascript, internet-explorer-7

我试过很多东西

`window.close(), self.close(), var win = window.open("","_self"); win.close();`

也试过

function close_window() { if (confirm("关闭窗口？")) { close(); } }

但最后我没有得到这个解决方案，因为这是我们的客户要求，我们必须以任何方式做到这一点，请建议是否有其他可能的方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:54:19.407

我用了

window.parent.close(),

现在工作正常。

但我在关闭选项卡时不想要任何警报消息。

# c# - Type.GetType 不区分大小写 - WinRT

> ID：13088870
> 
> 赞同：6
> 
> 时间：2012-10-26T14:30:01.810
> 
> 标签：c#, types, windows-runtime, case-insensitive, objectinstantiation

根据[microsoft 文档](http://msdn.microsoft.com/en-us/library/a87che9d.aspx)，`Type.GetType`在 .NET 4.5 中可以不区分大小写。不幸的是，这在 WinRT（Metro/Modern UI/Store 应用程序）中不可用。

有已知的解决方法吗？因为我必须从一个协议中实例化对象，该协议的所有字符串表示形式都是大写的。

示例：从“MYOBJECT”，我必须实例化`MyObject`.

我目前使用`Activator.CreateInstance(Type.GetType("MYOBJECT"))`，但由于区分大小写，它不起作用。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T14:33:21.450

您知道要从中加载类型的程序集吗？如果是这样，您可以通过调用一次来创建不区分大小写的`Dictionary<string, Type>`（使用）。然后你根本不需要使用- 只需查阅字典：`StringComparer.OrdinalIgnoreCase``Assembly.GetTypes()``Type.GetType()`

```
// You'd probably do this once and cache it, of course...
var typeMap = someAssembly.GetTypes()
                          .ToDictionary(t => t.FullName, t => t,
                                        StringComparer.OrdinalIgnoreCase);

...

Type type;
if (typeMap.TryGetValue(name, out type))
{
    ...
}
else
{
    // Type not found
} 
```

编辑：看到这些都在同一个命名空间中，您可以轻松过滤：

```
var typeMap = someAssembly.GetTypes()
                          .Where(t => t.Namespace == "Foo.Bar")
                          .ToDictionary(t => t.Name, t => t,
                                        StringComparer.OrdinalIgnoreCase); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T14:33:52.210

您可以使用[`GetTypes()`](http://msdn.microsoft.com/en-us/library/a87che9d.aspx)方法来获取您的类型所在的程序集中的所有可能类型，然后检查哪种类型大写等于您的类型大写，然后在`GetType`方法中使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-03T08:48:46.123

考虑到您的实际类名是`Car`并且您的查询字符串是`CAR`. 由于它们在区分大小写方面有所不同，因此 Type.GetType() 将返回 null。`Car`要解决这个问题，首先从（假设命名空间是`Vehicle`）的命名空间中过滤所有类。

```
var varClasses = from t in Assembly.GetExecutingAssembly().GetTypes()
                 where t.IsClass && t.Namespace == "Vehicles"
                 select t; 
```

转换为`List`

```
List<Type> lstClasses = varClasses.ToList(); 
```

声明一个变量以获取类的实际名称，并使用循环来比较字符串，不区分大小写。

```
string strActualName = "";
foreach (Type t in lstClasses )
{
     if (t.Name.ToLower() == "CAR".ToLower())
     {
           strActualName = t.Name;
           break;
     }
} 
```

现在使用新字符串，使用 Type.GetType()

```
Type t1 = Type.GetType("Vehicles." + strActualName); 
```

# matlab - matlab词干参数

> ID：13088872
> 
> 赞同：0
> 
> 时间：2012-10-26T14:30:13.757
> 
> 标签：matlab

我正在使用“ **stem** ”命令将离散值绘制成图形。我不知道如何删除将点连接到 x 轴的线。我发现很多参数可以改变线条的形状和颜色，但没有一个可以将其移除。

```
stem(X, Y) 
```

有没有办法做到这一点，还是我使用了错误的命令？情节和酒吧不是我要找的...

我在某处看到了这个：

```
stem(X, Y, 'none') 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T15:05:14.067

```
t = linspace(-2*pi,2*pi,10);
h = stem(t,cos(t),'LineStyle','none'); 
```

# android - 如何对齐可扩展列表视图按钮？

> ID：13088874
> 
> 赞同：2
> 
> 时间：2012-10-26T14:30:14.020
> 
> 标签：android, expandablelistview

我创建了可扩展的列表视图应用程序。该应用程序运行良好；我的问题是我的可展开视图单击按钮。它不在列表视图的中心。如何显示屏幕的中心。文本居中，但按钮位于屏幕底部。这是个问题...

这是我的 xml 代码：

```
<?xml version="1.0" encoding="utf-8"?>  
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"  
      android:orientation="vertical"   
      android:layout_width="fill_parent"  
      android:layout_height="fill_parent"
      >  

      <ExpandableListView   
        android:layout_width="fill_parent"  
        android:layout_height="wrap_content"   
        android:layout_weight="0"  

        android:id="@+id/ExpandableListView">  
      </ExpandableListView>  
    </RelativeLayout> 
```

# objective-c - NSMutableArray：将所有对象向前推一个索引？

> ID：13088875
> 
> 赞同：0
> 
> 时间：2012-10-26T14:30:15.843
> 
> 标签：objective-c, cocos2d-iphone

我的游戏中需要某种排队系统，试图找出正确的方法。

如果我有一个名为 customerQueue 的 NSMutableArray，并向该数组添加 4 个对象。现在将有对象添加索引，[0]，[1]，[2]，[3]。

然后我想处理 1 号客户，即 customerQueue 中的索引 [0]。由于客户不再在队列中，我可以将其从阵列中移除。到现在为止还挺好。

但是，现在我希望队列中的剩余 3 个对象向前迈出“一步”，例如索引 [1] 处的对象移动到索引 [0] 并且索引 [2] 处的对象转到 [1] ...，你明白这点。

我在 NSMutableArray.h 中找不到为此的方法，那么，可以这样做吗？有没有类似的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:34:50.710

[这里解释了](https://stackoverflow.com/questions/817469/how-do-i-make-and-use-a-queue-in-objective-c)将 NSMutableArray 转换为队列的类别。

在您的情况下，您真正​​需要做的就是[删除第一个对象](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableArray/removeObjectAtIndex:)：

```
[customerQueue removeObjectAtIndex:0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:33:39.543

这会在您删除第一个元素时自动完成。你永远不能有一个没有第一个索引的数组。当您删除索引 0 处的对象时，索引 1 处的对象会自动移动到索引 0。

# django - 我有两个 Django 站点：如何让站点 B 的用户使用站点 A 上的凭据登录？

> ID：13088882
> 
> 赞同：1
> 
> 时间：2012-10-26T14:30:30.633
> 
> 标签：django, oauth

我有一个母站点，称为 A。我正在计划一个新站点 B，我不希望用户必须创建新帐户。

我希望 A 的所有用户也是 B 的用户，而相反的不一定也是。

我想这需要某种形式的 OAuth？

您能告诉我在 Django 中执行此操作的最佳方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T17:44:05.963

如果要使用 OAuth，则需要在站点 A 上实现 OAuth“提供者”，生成应用密钥和应用密钥，并让站点 B 在对用户进行身份验证时使用它。这样，站点 B 将只是一个使用站点 A 作为 OAuth 提供者的应用程序（在 OAuth 术语中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T17:40:12.040

您可以为新站点 B 提供自定义身份验证后端。请看这里：自定义身份[验证后端](https://docs.djangoproject.com/en/dev/topics/auth/#specifying-authentication-backends)。这样，当您的旧用户无法针对站点 B 上的第一个用户进行身份验证时，您可以尝试使用第二个身份验证后端对他们进行身份验证。

# jquery - 这个语法用于什么：$('#myID,obj)

> ID：13088885
> 
> 赞同：1
> 
> 时间：2012-10-26T14:30:59.917
> 
> 标签：jquery

我不熟悉下面的语法。添加对象的目的是什么？

```
selectIt = $('<div />', {text : $this.attr('title')}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:33:17.980

问题正文中的代码创建了一个`div`节点，并将其设置`text`（即其内部 HTML）设置为`$this.attr('title')`. div 节点将分配给`selectIt`变量，但尚未附加到 DOM 的任何部分。

您的问题标题中的代码也是有效的，但未闭合的字符串除外。它选择具有 id 的元素`myID`，仅在 DOM 节点内搜索`obj`。通过 ID 选择时传递上下文节点是多余的，因为 ID 在文档中是唯一的，并且通过 ID 选择足够快，但是对于其他元素，它可能是增加精度的有用方法，而不必搜索整个文档。

注意传递一点 HTML 的区别，它将指示 jQuery 创建匹配的节点树，以便您可以将其附加到 DOM，或者传递一个选择器，它将指示 jQuery 在当前 DOM 中查找匹配的节点。

```
$('<div />') // create a div
$('div') // find a div 
```

# ipad - iPad mini 和第四代机器id

> ID：13088889
> 
> 赞同：4
> 
> 时间：2012-10-26T14:31:12.570
> 
> 标签：ipad, ipad-mini

有人知道这些新设备的机器 ID 吗？例如，第三代 iPad 可能是 iPad3,1 iPad3,2, iPad3,5 iPad3,6，具体取决于型号。我正在用这个找到字符串

```
struct utsname systemInfo;
uname(&systemInfo);
NSString *dev = [NSString stringWithCString:systemInfo.machine encoding:NSUTF8StringEncoding]; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T10:56:00.823

我有一个新的 Ipad 4th Wifi，机器型号是`iPad3,4`

此外，Ipad mini Wifi 是`iPad2,5`

**已编辑**

11 月中旬将推出其余的新 Ipad 型号：（作为 Ipad 3th gen）

*   `iPad3,5`适用于 iPad 第 4 代 GSM
*   `iPad3,6`适用于 iPad 第 4 代 CDMA
*   `iPad2,6`适用于 iPad mini Wifi GSM
*   `iPad2,7`适用于 iPad mini Wifi CDMA

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-02T17:12:25.520

刚拿到我的 iPad mini。“iPad2,5”
UIDevice 模型只是“iPad”。我怀疑较大的 iPad 2 将被淘汰，因为它没有照明端口，而新的 iPad mini Retina 将是 iPad2,6

# android - 将图像保存在 sdcard 中

> ID：13088890
> 
> 赞同：0
> 
> 时间：2012-10-26T14:31:16.720
> 
> 标签：android, sd-card

我已经编写了编辑图像的代码现在我想将编辑后的图像保存在 SD 卡中

```
image=(ImageView)findViewById(R.id.image);
        Intent intent = getIntent();
        File sdCardDirectory = Environment.getExternalStorageDirectory();
        photo = (Bitmap) intent.getParcelableExtra("photoo");
        image.setImageBitmap(photo); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:43:34.053

试试这个，

```
 void saveImage() {

    String root = Environment.getExternalStorageDirectory().toString();
    File myDir = new File(root + "/saved_images");

    String fname = "Image.jpg";
    File file = new File (myDir, fname);
    if (file.exists ()) file.delete (); 
    try {
           FileOutputStream out = new FileOutputStream(file);
           myBitmap.compress(Bitmap.CompressFormat.JPEG, 90, out);
           out.flush();
           out.close();

    } catch (Exception e) {
           e.printStackTrace();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:59:00.727

好的，首先您需要在 AndroidManifest.xml 中提供写入权限，如下所示，

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

现在让我们看看实际编写编辑图像的代码，

```
// Getting the SDCard Path
File sdcard = Environment.getExternalStorageDirectory();
File editedFile = new File( sdcard, "myphoto.jpeg" );

// if file is already exists then first delete it
if ( editedFile.exists() ) 
{   
    editedFile.delete(); 
}

FileOutputStream fOut = new FileOutputStream( editedFile );
photo.compress( Bitmap.CompressFormat.JPEG, 90, fOut ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T14:39:45.133

这很简单。

```
File outpt = new File( sdCardDirectory, "photo.jpeg" );
FileOutputStream outptOs = new FileOutputStream( outpt );
photo.compress( Bitmap.CompressFormat.JPEG, 90, outptOs ); 
```

# visual-studio-2010 - 如何创建包含 XML 智能感知数据的 NuGet 包

> ID：13088893
> 
> 赞同：18
> 
> 时间：2012-10-26T14:31:32.710
> 
> 标签：visual-studio-2010, visual-studio, intellisense, nuget, nuget-package

此链接[如何为我的 DLL 创建 XML Intellisense 文件？](https://stackoverflow.com/questions/4893745/how-do-i-create-an-xml-intellisense-file-for-my-dll)解释如何构建您的 dll，以便包含一个包含所有文档标题的 XML 文件，以便它们在这些 IntelliSense 弹出窗口中可用。

在我的公司，我们经常使用内部 NuGet 包源分发我们自己的 dll。当我为包源创建 NuGet 包时，如何确保其他人从包源获取 dll，IntelliSense 会为他们显示文档标题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-27T12:50:14.033

如果您将 XML 文件与*NuGet 包*一起分发到与您的相同文件夹中，`Dlls`那么 Visual Studio 将找到这些 XML 文件并为您的程序集显示 IntelliSense。

要分发 IntelliSense XML 文件，您需要将它们添加到您的`.nuspec file`.，例如：

```
<files>
    <file src="bin\IronPython.dll" target="lib\Net40" />
    <file src="bin\IronPython.xml" target="lib\Net40" />
</files> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-23T20:55:43.353

**`.xml`tl **;博士**文档文件不需要`.XML`**

 **通过首先使用 Build 选项卡启用生产，检查输出部分中的 XML 文档文件，我能够获得包含的 XML 文件。注意：出于某种原因，我不得不手动将扩展名从 .XML 更改为小写的 .xml。YMMV。这与您引用的问题相同，[如何为我的 DLL 创建 XML Intellisense 文件？](https://stackoverflow.com/questions/4893745/how-do-i-create-an-xml-intellisense-file-for-my-dll).

完成后，我在项目目录中创建了 Nuspec 文件。这是一个示例，您也可以使用它生成它`nuget spec MyAssembly.dll`- 但请确保对其进行编辑并适当地设置值。

```
<?xml version="1.0"?>
<package >
  <metadata>
    <id>$id$</id>
    <version>1.0.0</version>
    <title>Title for your package</title>
    <authors>Package Author</authors>
    <owners>Package Owner</owners>
    <requireLicenseAcceptance>false</requireLicenseAcceptance>
    <description>A description of your library</description>
    <releaseNotes>Release notes for this version.</releaseNotes>
    <copyright>Copyright 2013</copyright>
    <tags>tag1 tag2</tags>
  </metadata>
</package> 
```

完成后，我使用 Nuget 进行打包。注意我必须指定平台，因为我使用的是 64 位操作系统，但我在项目中没有 x64 的任何目标，只有 AnyCPU

```
nuget pack MyAssembly.csproj -Prop Configuration=Release;Platform=AnyCPU -build 
```

程序集及其相关文档自动包含在包中。此外，您在项目中使用的任何包都将添加到依赖项列表中。

有关详细信息，请参阅[http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package)。**

# javascript - 有没有办法只在 HTML 表单中的某些字段上使用 tabindex？

> ID：13088895
> 
> 赞同：5
> 
> 时间：2012-10-26T14:31:36.193
> 
> 标签：javascript, html, forms, tabindex

我有一组 8 个复杂的表单（70 多个字段）用于存储团队报告。表格的一部分在 4 列宽和 2 列高的表格中包含团队成员姓名（名字在上面，姓在下面）。当用户填写表单时，Tab 键将它们带入名字，然后转到姓氏，因为这是它们在源中的顺序（一个 TR 中的名字和下一个 TR 中的姓氏）。显然，如果 tab 键从名字到姓氏，然后再到下一个名字，对我的用户来说会更容易。

我知道我可以用 tabindex 解决这个问题，但我真的不想对所有 500 多个字段进行 tabindex，所以修复这 4 个字段。

有什么方法可以让我只对表单的一部分进行制表索引吗？我试过了，但它不会跳到其他字段。有一些聪明的JS解决方案吗？或者以某种方式对这些字段进行分组，以便默认选项卡将我带入组中，然后我可以在那里进行 tabindex？

如果你愿意，可以叫我懒惰……但我正在努力为自己节省许多时间剪切和粘贴以及犯错误。

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:51:34.700

您能做的最好的事情是在名称输入相同的 tabIndex 之前为您的所有输入提供相同的 tabIndex，这比第一个名称输入小 1，然后在名称输入相同的 tabIndex 之后为所有输入提供高 1比姓氏输入。

```
<input type="text" tabIndex="1"><br>
<input type="text" tabIndex="1"><br>
...
<table>
    <tr>
        <td><input type="text" tabIndex="2"></td>
        <td><input type="text" tabIndex="4"></td>
        <td><input type="text" tabIndex="6"></td>
        <td><input type="text" tabIndex="8"></td>
    </tr>
    <tr>
        <td><input type="text" tabIndex="3"></td>
        <td><input type="text" tabIndex="5"></td>
        <td><input type="text" tabIndex="7"></td>
        <td><input type="text" tabIndex="9"></td>
    </tr>
</table>
<input type="text" tabIndex="10"><br>
<input type="text" tabIndex="10"><br>
... 
```

我认为这就是你想要的：http: [//jsfiddle.net/9ffWs/](http://jsfiddle.net/9ffWs/)

它仍然需要您为每个输入添加一个 tabIndex，但至少它是非常可控的并且应该不会导致错误。

# sql - 多次加入表会导致性能大幅下降

> ID：13088905
> 
> 赞同：0
> 
> 时间：2012-10-26T14:32:06.193
> 
> 标签：sql, oracle10g

我有一个很大的疑问。

性能一直是可以接受的，但我现在遇到了这个问题。

我需要多次加入一个表，当然使用别名，但这样做会导致巨大的性能损失。

这是一个巨大的查询，所以我不会全部发布，但要点是：

```
SELECT table1.name,
       ALIAS1.CODE AS "Sequence"
...
FROM table1
...
LEFT JOIN table2 ALIAS1
ON ALIAS1.COLUMN1 = table1.key1
AND ALIAS1.COLUMN2 = 'aaba'
AND ALIAS1.COLUMN3 = '00001'
... 
```

这个很好，运行大约 90 秒。但是，如果我再次添加相同的表，如下所示，执行时间会成倍增加（到目前为止 2 小时并且仍在运行）：

```
SELECT table1.name,
       ALIAS1.CODE AS "Sequence",
       ALIAS2.CODE AS "Rating"
...
FROM table1
...
LEFT JOIN table2 ALIAS1
ON ALIAS1.COLUMN1 = table1.key1
AND ALIAS1.COLUMN2 = 'aaba'
AND ALIAS1.COLUMN3 = '00001'

LEFT JOIN table2 ALIAS2
ON ALIAS2.COLUMN1 = table1.key1
AND ALIAS2.COLUMN2 = 'ffhr'
AND ALIAS2.COLUMN3 = '00107' 
```

我需要知道的是，什么因素可能导致这种情况？

在我看来，索引应该没问题，否则第一次加入将是一个问题。

为什么第二次加入会成为这样的问题？

我实际上需要第三次加入同一张桌子，但显然这是不行的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:15:17.697

```
ON ALIAS1.COLUMN1 = table1.key1
AND ALIAS1.COLUMN2 = 'aaba'
AND ALIAS1.COLUMN3 = '00001' 
```

当您同时加入三列时，您应该有一个包含所有三列的多列索引。

也许您可以将这些过滤器放在 WHERE 子句中，而不是加入常量值。

# php - 多个 IF 语句条件

> ID：13088908
> 
> 赞同：5
> 
> 时间：2012-10-26T14:32:13.130
> 
> 标签：php, function, if-statement, conditional-statements, statements

我有一个 PHP 脚本，它通过我自己的自定义函数运行一组值，该函数使用 PHP 函数 preg_match。它正在寻找与我的正则表达式为 $valueA 的匹配项，我要搜索的字符串为 $valueB，如果找到匹配项，则将其返回给 $match，否则我不希望我的 IF 语句运行。

现在，如果函数找到匹配项（换句话说，为 TRUE），则运行此 IF 语句没有问题；

```
if ($match = match_this($valueA, $valueB))
{
    //do this
} 
```

但是，如果我想比较一个附加条件以检查它是否也是 TRUE，并且只在两者都为 TRUE 时运行 IF 语句，我就会遇到问题；

```
if ($match = match_this($valueA, $valueB) && $x == 'x')
{
    //do this
} 
```

当两个条件都为 TRUE 时，语句不会正常运行，而是最终从 $match 输出 1 而不是我的 $match 值应该是什么。

我可以看到发生了什么。我的 IF 语句只是将文字布尔值 TRUE 返回到 $match 中，而不是从 match_this() 返回的值；

这是因为我只能返回一种 TRUE 的感觉吗？

我可以通过使用两个嵌套的 IF 语句来解决这个问题，但是为了简洁的代码，我希望能够比较我的 IF 中的多个条件，其中包括返回值的函数。

有不同种类的 TRUE 吗？如果是这样，我该如何以这种方式比较它们？或者有没有更简单的方法？我想我可以在我的函数中放置第二个 IF 语句并通过函数传递我的第二个条件，但是我的函数就其用途而言不会被非常明确地定义。

我以前遇到过这个问题，不太清楚我在找什么。希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:34:19.667

```
if (($match = match_this($valueA, $valueB)) && $x == 'x') 
    ^                                     ^ 
```

你错过了一组额外的括号。如果没有额外的括号`$match = match_this($valueA, $valueB)`，首先执行 的评估，`&&`最后将结果分配给`$match`。

**或者**，您可以使用`and`（优先级低于 assignment `=`）而不是`&&`

**[PHP 运算符优先级](http://php.net/manual/en/language.operators.precedence.php)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:34:31.587

```
if ($match = match_this($valueA, $valueB))
           ^---wrong operator 
```

您应该`==`用于相等测试。现在您只是分配 match_this 的返回值。你的另一个 if() 也一样

as per the comments below, if you actually ARE wanting to do assignments within the if() structure, then you should slap a very-large-blinking-neon-bright comment/warning above the code to say that this is intended behavior. In most any language and most any other person looking at this code later on will assume it's a typo and change the assignment to an equality test.

# iphone - xcode 中的共享和 iOS 版本

> ID：13088910
> 
> 赞同：0
> 
> 时间：2012-10-26T14:32:21.320
> 
> 标签：iphone, ios, xcode, twitter, ios6

我正在制作一个输出文本的应用程序，并希望用户可以选择在 twitter 和/或 Facebook 上共享此文本......我知道 iOS6 与 twitter 和 Facebook 相关联。但是，如果拥有 iOS 5.1 的用户安装该应用程序会发生什么？我想我想看看我是否应该使用 ios6 和内置的共享功能或 ios5 并使用 sharekit 在 twitter 和 facebook 上共享。我的另一个问题也相关。

如果我在 xcode 中使用 ios6 构建我的应用程序，安装了 ios5 的用户仍然可以安装这个应用程序吗？那么，只有在 ios6 中才有的功能（如共享）会发生什么？感谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:48:37.730

如果您将应用程序的目标设置为 iOS 6，则在以前的 iOS 版本上运行的用户将无法安装它。此外，例如，如果您将目标设置为 iOS 5，您将无法使用 facebook 原生 facebook 集成。因此，在我看来，您应该为 iOS 5 设置目标，将 facebook 框架设置为可选，并在启动应用程序时检查它运行的 iOS 版本。如果不是 iOS 6，请使用 shareKit。

# php - 在 Magento 中传输整个目录

> ID：13088913
> 
> 赞同：0
> 
> 时间：2012-10-26T14:32:28.777
> 
> 标签：php, zend-framework, magento, magento-1.7

我有一个 Magento 驱动的网站，目录中有 300 种产品和 20 个类别。现在我需要将这些类别和产品移动到另一个 Magento 安装。最好的方法是什么？我发现了许多关于导入/导出 Magento 工具的材料，但它们不起作用。可能有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T00:53:14.340

您能否详细说明什么对导入/导出不起作用？

我首先建议在导入/导出实用程序上使用数据流配置文件，特别是导出/导入所有产品。从一个 Magento 安装到另一个安装**不应该是**使用数据流的问题（假设版本不是太多样化）。通常它会弄乱来自非 Mage 安装的数据，这是最困难的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T15:48:47.903

您应该使用 Unirgy 的 uRapidFlow。它有点贵，但它做得很好而且很快！

# html - HTML5 appcache 比使用过期标头或本地存储更好吗？

> ID：13088914
> 
> 赞同：2
> 
> 时间：2012-10-26T14:32:29.353
> 
> 标签：html, local-storage, html5-appcache, expires-header

考虑以下场景：

*   网站/应用程序仅在线使用 - 需要有效的互联网连接；
*   所有文件都有适当的过期标头设置；
*   强制文件刷新可以通过类似 myFile.css?v=2 和 location.reload(true);

如果我使用 HTML5 的 appcache（清单），我的网站/应用程序实际上会加载得更快吗？为什么？我环顾四周，但似乎对这个问题没有一致的答案。

HTML5Rocks 建议使用 appcache 但我认为这主要是由于缓存重新加载管理。

追问：在localstorage缓存文件怎么办？与其他两个相比，它在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T15:34:57.433

您缓存的文件有多大，您的目标浏览器和设备是什么？对于普通的桌面浏览器，它可能不会有太大的不同。在移动浏览器上，它已被使用/推荐作为[iPhone 缓存资源的 25kb 限制](http://yuiblog.com/blog/2008/02/06/iphone-cacheability/)的解决方法，另请参阅这两篇后续文章：[移动浏览器缓存限制：Android、iOS 和 webOS](http://www.yuiblog.com/blog/2010/06/28/mobile-browser-cache-limits/)和[移动浏览器缓存限制，重新访问](http://www.yuiblog.com/blog/2010/07/12/mobile-browser-cache-limits-revisited/)。appcache 中的项目将在电源循环和其他浏览器缓存可能无法实现的自动清除情况下存活。

所以答案是：视情况而定。是否值得在您的网站上进行，只有您可以通过一些测试来解决。

至于您的后续问题。：我希望存储在这方面提供与 appcache 相同的优势，区别在于您必须编写的代码量来自己在客户端管理东西而不是绝对表现。

# c# - 多个线程使用 yield 访问 IEnumerable

> ID：13088915
> 
> 赞同：5
> 
> 时间：2012-10-26T14:32:30.900
> 
> 标签：c#, ienumerable, ienumerator

我正在使用第三方库来迭代一些非常大的平面文件，这可能需要几分钟。该库提供了一个枚举器，因此您可以在枚举器提取平面文件中的下一项时产生每个结果并对其进行处理。

例如：

```
IEnumerable<object> GetItems()
{
    var cursor = new Cursor;

    try
    {
        cursor.Open();

        while (!cursor.EOF)
        {
            yield return new //object;

            cursor.MoveNext();
        }

    }
    finally
    {
        if (cursor.IsOpen)
        {
            cursor.Close();
        }
    }
} 
```

我想要实现的是拥有相同 Enumerable 的两个消费者，因此我不必两次提取信息，因此每个消费者仍然可以在每个项目到达时对其进行处理，而不必一直等待到达一次。

```
IEnumerable<object> items = GetItems();

new Thread(SaveToDateBase(items)).Start();
new Thread(SaveSomewhereElse(items)).Start(); 
```

我想我想要达到的目标是

“如果消费者要求的项目已经被提取，那么就放弃它，否则移动下一步并等待”，但我意识到两个线程之间可能存在 MoveNext() 冲突。

如果没有任何关于如何实现的想法，这样的事情是否已经存在？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T14:35:29.787

`BlockingCollection<T>`您正在寻找使用 .NET 4和 TPL 任务的[管道模式实现。](http://msdn.microsoft.com/en-us/library/ff963548.aspx)[请参阅此 StackOverflow 帖子中](https://stackoverflow.com/a/9895150/485076)的完整示例的答案。

**示例：3 个同时使用的消费者**

```
BlockingCollection<string> queue = new BlockingCollection<string>();    
public void Start()
{
    var producerWorker = Task.Factory.StartNew(() => ProducerImpl());
    var consumer1 = Task.Factory.StartNew(() => ConsumerImpl());
    var consumer2 = Task.Factory.StartNew(() => ConsumerImpl());
    var consumer3 = Task.Factory.StartNew(() => ConsumerImpl());

    Task.WaitAll(producerWorker, consumer1, consumer2, consumer3);
}

private void ProducerImpl()
{
   // 1\. Read a raw data from a file
   // 2\. Preprocess it
   // 3\. Add item to a queue
   queue.Add(item);
}

// ConsumerImpl must be thrad safe 
// to allow launching multiple consumers simulteniously
private void ConsumerImpl()
{
    foreach (var item in queue.GetConsumingEnumerable())
    {
        // TODO
    }
} 
```

如果还有什么不清楚的地方，请告诉我。

管道流程的高级图：

![在此处输入图像描述](../Images/eac7a391f40376270500b6ca1812fe1e.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T14:41:35.380

本质上，您想要的是缓存`IEnumerable<T>`的数据，但在存储之前无需等待它完成。你可以这样做：

```
public static IEnumerable<T> Cache<T>(this IEnumerable<T> source)
{
    return new CacheEnumerator<T>(source);
}

private class CacheEnumerator<T> : IEnumerable<T>
{
    private CacheEntry<T> cacheEntry;
    public CacheEnumerator(IEnumerable<T> sequence)
    {
        cacheEntry = new CacheEntry<T>();
        cacheEntry.Sequence = sequence.GetEnumerator();
        cacheEntry.CachedValues = new List<T>();
    }

    public IEnumerator<T> GetEnumerator()
    {
        if (cacheEntry.FullyPopulated)
        {
            return cacheEntry.CachedValues.GetEnumerator();
        }
        else
        {
            return iterateSequence<T>(cacheEntry).GetEnumerator();
        }
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
}

private static IEnumerable<T> iterateSequence<T>(CacheEntry<T> entry)
{
    for (int i = 0; entry.ensureItemAt(i); i++)
    {
        yield return entry.CachedValues[i];
    }
}

private class CacheEntry<T>
{
    public bool FullyPopulated { get; private set; }
    public IEnumerator<T> Sequence { get; set; }

    //storing it as object, but the underlying objects will be lists of various generic types.
    public List<T> CachedValues { get; set; }

    private static object key = new object();
    /// <summary>
    /// Ensure that the cache has an item a the provided index.  If not, take an item from the 
    /// input sequence and move to the cache.
    /// 
    /// The method is thread safe.
    /// </summary>
    /// <returns>True if the cache already had enough items or 
    /// an item was moved to the cache, 
    /// false if there were no more items in the sequence.</returns>
    public bool ensureItemAt(int index)
    {
        //if the cache already has the items we don't need to lock to know we 
        //can get it
        if (index < CachedValues.Count)
            return true;
        //if we're done there's no race conditions hwere either
        if (FullyPopulated)
            return false;

        lock (key)
        {
            //re-check the early-exit conditions in case they changed while we were
            //waiting on the lock.

            //we already have the cached item
            if (index < CachedValues.Count)
                return true;
            //we don't have the cached item and there are no uncached items
            if (FullyPopulated)
                return false;

            //we actually need to get the next item from the sequence.
            if (Sequence.MoveNext())
            {
                CachedValues.Add(Sequence.Current);
                return true;
            }
            else
            {
                Sequence.Dispose();
                FullyPopulated = true;
                return false;
            }
        }
    }
} 
```

示例用法：

```
private static IEnumerable<int> interestingIntGenertionMethod(int maxValue)
{
    for (int i = 0; i < maxValue; i++)
    {
        Thread.Sleep(1000);
        Console.WriteLine("actually generating value: {0}", i);
        yield return i;
    }
}

public static void Main(string[] args)
{
    IEnumerable<int> sequence = interestingIntGenertionMethod(10)
        .Cache();

    int numThreads = 3;
    for (int i = 0; i < numThreads; i++)
    {
        int taskID = i;
        Task.Factory.StartNew(() =>
        {
            foreach (int value in sequence)
            {
                Console.WriteLine("Task: {0} Value:{1}",
                    taskID, value);
            }
        });
    }

    Console.WriteLine("Press any key to exit...");
    Console.ReadKey(true);
} 
```

# wcf - 将 OData 升级到 v3

> ID：13088916
> 
> 赞同：3
> 
> 时间：2012-10-26T14:32:37.623
> 
> 标签：wcf, wcf-data-services, odata

我有一个刚刚升级到 V3（从 V2）的 WCF 数据服务。不破坏现有客户的最佳方法是什么？

请注意，某些客户端使用 .Net < 4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T16:30:05.073

只要他们正确发送 MaxDataServiceVersion 请求标头，您就不会破坏您当前的客户端。所以基本上客户端可以告诉服务器它想要使用什么版本。

# sql - SQL 嵌套替换

> ID：13088921
> 
> 赞同：4
> 
> 时间：2012-10-26T14:32:55.907
> 
> 标签：sql, sql-server

我有一个复杂的嵌套替换，我用它来连接 MSSQL 中的两个表。

```
select * from A
  left outer join 
select * from B
on
  replace(
     replace(
        replace(
           replace(
              replace(A.Column1, '1114', ''),
             '1160', ''), 
          '1162', ''),
        '1167', ''),
      '1176', ''),
    '1177', '')  = B.Column1 
```

我这样做的全部原因是因为 Table1 中的数据包含一些*噪音*- 数字如*1160*、*1162*等，其中 Table2 是干净的字符。

```
Eg. - Table 1 - 'HELLO1160WORLD'
      Table 2 - 'HELLOWORLD' 
```

现在在我的情况下，我应该能够将它们作为一个条目进行**匹配。**

我目前的嵌套替换方法确实有效，但我不相信这是一种优雅的方法。任何帮助都感激不尽。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:45:08.420

也许使用一个函数来去[除非数字字符](https://stackoverflow.com/questions/1007697/how-to-strip-all-non-alphabetic-characters-from-string-in-sql-server/1008566#1008566)：

```
Create Function [dbo].[RemoveNonAlphaCharacters](@Temp VarChar(1000))
Returns VarChar(1000)
AS
Begin

    While PatIndex('%[^a-z]%', @Temp) > 0
        Set @Temp = Stuff(@Temp, PatIndex('%[^a-z]%', @Temp), 1, '')

    Return @Temp
End 
```

然后你将在你的加入中引用这个函数：

```
select a.col1 a, b.col1 b
from tablea a
left join tableb b
  on dbo.RemoveNonAlphaCharacters(a.col1) = b.col1 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/85a85/1)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T15:27:50.073

问题是 T-SQL 不允许用名称标记表达式，因此您可以从不同的地方引用它们。有一种方法可以做到这一点：

```
select replaceN
from T
cross apply (select replace1 = replace(T.col, 'x', 'y')) r1
cross apply (select replace2 = replace(replace1, 'x', 'y')) r2
cross apply (select replace3 = replace(replace2, 'x', 'y')) r3
... 
```

这至少摆脱了疯狂的嵌套。它对性能没有负面影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T15:10:46.450

Bluefeet 的建议肯定会很好地使您的查询更简单。但是，如果您不想打扰一个函数并将所有代码保存在一个地方，试试这个。在进行联接之前，您可以将表 A 转储到临时表中：

```
DECLARE @TmpA TABLE(
     Column1 [nvarchar] (50)),
     ...
     )

Insert into @tmpA select * from A

Update @TmpA set Column1=Replace(Replace(Replace(Column1,...)))

Select * from tmpA
  left outer join 
Select * from B
  on tmpA.Column1=B.Column1 
```

# perl - Parse CSV cell by cell

> ID：13088923
> 
> 赞同：2
> 
> 时间：2012-10-26T14:33:02.227
> 
> 标签：perl, parsing, csv

I have a CSV file with a lot of columns and rows but I need to sum cells of certain column:

```
Samples | Name | Value1 | Value2 | Value3

A-Sample | A-Name | 1 | 32 | 27 | 21

B-Sample | B-Name | 2 | 23 | 12 | 13

C-Sample | C-Name | 3 | 10 | 98 | 59

D-Sample | D-Name | 4 | 21 | 78 | 72

E-Sample | E-Name | 5 | 32 | 72 | 27 
```

I need Sum of cells in column `Value 1`, Sum of cells in column `Value2`. I'm trying to use Text::CSV, but I only get the result as lines.

Could anyone help me?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T22:58:15.050

对于这类事情，我最喜欢的模块是 Tie::Array::CSV

```
use Tie::Array::CSV;
tie my @csv, 'Tie::Array::CSV', 'filename.csv' or die;
my @answer;         # store the results
for (my $row = 1; $row < @csv; $row++) # each row if the csv
{
    next unless $row->[2] =~ /^\s*\d+\s*$/; # Not rows where 3rd field isn't numeric
    for (my $i = 2; $i < @$row; $i++)  # cols 2 onwards
    {
        $answer[$i] += $row->[$i];  # sum the results
    }
 }
 say "@answer[2 .. $#answer]"; # display the sums 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T23:40:38.080

I work with a lot of CSV files and my favorite modules by far are [Tie::Handle::CSV](http://search.cpan.org/~danboo/Tie-Handle-CSV/lib/Tie/Handle/CSV.pm) and [DBD::CSV](http://search.cpan.org/~hmbrand/DBD-CSV/lib/DBD/CSV.pm).

perlmeme.org has a fantastic [tutorial](http://perlmeme.org/tutorials/parsing_csv.html) on parsing CSV files.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T18:20:34.817

试试 Spreadsheet::Read，也许它适合您的需求。使用此模块，您可以像使用任何其他电子表格一样使用 csv。有关更多信息，请参阅 perldoc Spreadsheet::Read 或[https://metacpan.org/module/Spreadsheet::Read](https://metacpan.org/module/Spreadsheet::Read)。

```
#! /usr/bin/env perl
use Modern::Perl '2012';

use Spreadsheet::Read;
use Data::Dumper;

my $spreadsheet = my $ref = ReadData ("test.csv", sep => "|"); 
my @rows = Spreadsheet::Read::rows ($spreadsheet->[1]);
my @values = map {$_->[4] } @rows; # columns starting with 0
say Dumper (\@values); 
```

**输出**

```
$VAR1 = [
      'Value3',
      '27',
      '12',
      '98',
      '78',
      '72'
    ]; 
```

# objective-c - 目标 C：将数组拆分为子数组

> ID：13088929
> 
> 赞同：1
> 
> 时间：2012-10-26T14:33:23.270
> 
> 标签：objective-c, arrays

我有一个看起来像这样的文本文件：

```
#AAA:x
12
34
7
...
#BBB:y
-74.7
-33.2
14
...
#CCC:z
32.4
17
...
#END 
```

我可以把所有东西放在一个大的`NSArray`（使用`componentsSeparatedByString:@"\n"`）

现在我想要：

AAA 浮动 NSArray，包含标签下的所有值`#AAA:x`；

BBB 使用标签下的所有值浮动 NSArray `#BBB:y`；ETC..

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:54:34.477

要详细说明我的评论，请尝试以下操作：

```
NSMutableArray *subarrays = [[myTest componentsSeparatedByString:@"#"] mutableCopy];
for (int i = 0; i < subarray.length; i++) {
    NSArray *subarray = [subarrays[i] componentsSeparatedByString:@"\n"];
    subarray = [subarray subarrayWithRange:NSMakeRange(1, subarray.length-1)];
    subarrays[i] = subarray;
} 
```

这应该会产生一个字符串数组的数组。

包含以下元素的字符串数组也是如此`subarrays[0]`：12、34、7。 subarrays[1][2] 将是字符串“14”

如果您想要浮点数而不是字符串，则必须另外迭代所有条目并将它们转换为浮点数。您可以使用`NSString`'`floatValue`方法来做到这一点。

# c# - how to trigger appropriate xaml page with button

> ID：13088931
> 
> 赞同：1
> 
> 时间：2012-10-26T14:33:40.087
> 
> 标签：c#, wpf, xml, xaml

i'm using example take from project "japf_fr_slide_animation". i've added button to trigger appropriate page but is stuck and dont know how to trigger them. Here are all the pages to the referenced project with the added buttons. Can anyone help on how I can trigger the pages based on the button?

view1.xaml

```
<UserControl x:Class="FirstTry.view1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300">
    <Grid Background="LightBlue">
        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Top" Text="view1" />
        <Button Name="show2" Content="show second xaml" VerticalAlignment="Center" Width="150"></Button>
    </Grid>
</UserControl> 
```

view2.xaml

```
<UserControl x:Class="FirstTry.view2"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300">
    <Grid Background="LightCoral">
        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Top" Text="view2"/>
        <Button Name="show3" Content="show third xaml" VerticalAlignment="Center" Width="150"></Button>
    </Grid>
</UserControl> 
```

view3.xaml

```
<UserControl x:Class="FirstTry.view3"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300">
    <Grid Background="LightGreen">
        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Top" Text="view3"/>
        <Button Name="show1" Content="show first xaml" VerticalAlignment="Center" Width="150"></Button>
    </Grid>
</UserControl> 
```

Window1.xaml

```
<Window x:Class="FirstTry.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" SizeToContent="WidthAndHeight" ResizeMode="NoResize">

    <Window.Resources>
        <XmlDataProvider x:Key="views">
            <x:XData>
                <Views xmlns="">
                    <View Title="View1">
                        <Page Source="view1.xaml"/> 
                    </View>
                    <View Title="View2">
                        <Page Source="view2.xaml"/>
                    </View>
                    <View Title="View3">
                        <Page Source="view3.xaml"/>
                    </View>
                </Views>
            </x:XData>
        </XmlDataProvider>

        <Storyboard x:Key="slideLeftToRight"  
                    TargetProperty="RenderTransform.(TranslateTransform.X)"
                    AccelerationRatio=".4"
                    DecelerationRatio=".4">
            <DoubleAnimation Storyboard.TargetName="viewer" Duration="0:0:0.6" From="300" To="0"/>
            <DoubleAnimation Storyboard.TargetName="bordervisual" Duration="0:0:0.6" From="0" To="-300"/>
        </Storyboard>

        <Storyboard x:Key="slideRightToLeft" 
                    TargetProperty="RenderTransform.(TranslateTransform.X)"
                    AccelerationRatio=".4"
                    DecelerationRatio=".4">
            <DoubleAnimation Storyboard.TargetName="viewer" Duration="0:0:0.6" From="-300" To="0"/>
            <DoubleAnimation Storyboard.TargetName="bordervisual" Duration="0:0:0.6" From="0" To="300"/>
        </Storyboard>

        <VisualBrush x:Key="VisualBrush1" Visual="{Binding ElementName=viewer}"/>

    </Window.Resources>

    <Grid>
        <StackPanel>

            <StackPanel Orientation="Horizontal">
                <ListBox x:Name="viewList" Height="20" Width="300" SelectedIndex="0"
                    ItemsSource="{Binding Source={StaticResource views}, XPath=Views/View}"
                    DisplayMemberPath="@Title"                    
                    SelectionChanged="viewList_SelectionChanged">
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                </ListBox>
            </StackPanel>

            <Grid Width="300" Height="300">

                <Border x:Name="bordervisual" Width="300">
                    <Rectangle x:Name="rectanglevisual"/>
                    <Border.RenderTransform>
                        <TranslateTransform/>
                    </Border.RenderTransform>
                </Border>

                <ItemsControl x:Name="viewer" DataContext="{Binding Path=SelectedItem, ElementName=viewList}"
                    ItemsSource="{Binding XPath=Page}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Frame x:Name="frame" Source="{Binding XPath=@Source}"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.RenderTransform>
                        <TranslateTransform/>
                    </ItemsControl.RenderTransform>
                </ItemsControl>
            </Grid>
        </StackPanel>       
    </Grid>
</Window> 
```

Window1.xaml.cs

```
public partial class Window1 : Window
    {
        private static int oldSelectedIndex = 0;

        public Window1()
        {
            InitializeComponent();
        }

        public RenderTargetBitmap RenderBitmap(FrameworkElement element)
        {
            double topLeft = 0;
            double topRight = 0;
            int width = (int)element.ActualWidth;
            int height = (int)element.ActualHeight;
            double dpiX = 96; // this is the magic number
            double dpiY = 96; // this is the magic number

            PixelFormat pixelFormat = PixelFormats.Default;
            VisualBrush elementBrush = new VisualBrush(element);
            DrawingVisual visual = new DrawingVisual();
            DrawingContext dc = visual.RenderOpen();

            dc.DrawRectangle(elementBrush, null, new Rect(topLeft, topRight, width, height));
            dc.Close();

            RenderTargetBitmap bitmap = new RenderTargetBitmap(width, height, dpiX, dpiY, pixelFormat);

            bitmap.Render(visual);
            return bitmap;
        } 

        private void viewList_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            XmlElement root = (XmlElement)viewer.DataContext;
            XmlNodeList xnl = root.SelectNodes("Page");

            if (viewer.ActualHeight > 0 && viewer.ActualWidth > 0)
            {
                RenderTargetBitmap rtb = RenderBitmap(viewer);
                rectanglevisual.Fill = new ImageBrush(BitmapFrame.Create(rtb));
            }

            viewer.ItemsSource = xnl;

            if (oldSelectedIndex < viewList.SelectedIndex)
            {
                viewer.BeginStoryboard((Storyboard)this.Resources["slideLeftToRight"]);
            }
            else
            {
                viewer.BeginStoryboard((Storyboard)this.Resources["slideRightToLeft"]);
            }

            oldSelectedIndex = viewList.SelectedIndex;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T21:53:45.957

一个非常简单的方法是在每个按钮被点击时触发一个命令。应该选择的新页码可以通过向命令传递参数来发送给命令。

在 Window 中，我们可以创建与命令的绑定，以便在单击按钮时接收通知，然后我们可以在 ListBox 中选择新页面，这会导致动画运行。

我已经编写了一些代码来演示这一点，并且只是对您已经拥有的内容添加了一点：

view1.xml

```
<UserControl x:Class="FirstTry.view1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:FirstTry"
    Height="300" Width="300">
    <Grid Background="LightBlue">
        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Top" Text="view1" />

        <!-- Button fires command with the value 1 as next pageindex --> 
        <Button Name="show2" Content="show second xaml" VerticalAlignment="Center" Width="150"
                Command="{x:Static local:Commands.SlideToPage}" CommandParameter="1"></Button>
    </Grid>
</UserControl> 
```

view2.xml

```
<UserControl x:Class="FirstTry.view2"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:FirstTry"
    Height="300" Width="300">
    <Grid Background="LightCoral">
        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Top" Text="view2"/>

        <!-- Button fires command with the value 2 as next pageindex -->
        <Button Name="show3" Content="show third xaml" VerticalAlignment="Center" Width="150"
                Command="{x:Static local:Commands.SlideToPage}" CommandParameter="2 </Button>
    </Grid>
</UserControl> 
```

view3.xaml

```
<UserControl x:Class="FirstTry.view3"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:FirstTry"
    Height="300" Width="300">
    <Grid Background="LightGreen">
        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Top" Text="view3"/>

        <!-- Button fires command with the value 0 as next pageindex -->
        <Button Name="show1" Content="show first xaml" VerticalAlignment="Center" Width="150"
                Command="{x:Static local:Commands.SlideToPage}" CommandParameter="0"></Button>
    </Grid>
</UserControl> 
```

Window1.xaml

```
<Window x:Class="FirstTry.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:FirstTry"
        Title="MainWindow" SizeToContent="WidthAndHeight" ResizeMode="NoResize">
    <Window.CommandBindings>
        <!-- Make the window listen for the SlideToPage command -->
        <CommandBinding Command="{x:Static local:Commands.SlideToPage}"
                        CanExecute="SlideToPage_CanExecute"
                        Executed="SlideToPage_Executed" />
    </Window.CommandBindings>

    <Window.Resources>
        <XmlDataProvider x:Key="views">
            <x:XData>
                <Views xmlns="">
                    <View Title="View1">
                        <Page Source="view1.xaml"/> 
                    </View>
                    <View Title="View2">
                        <Page Source="view2.xaml"/>
                    </View>
                    <View Title="View3">
                        <Page Source="view3.xaml"/>
                    </View>
                </Views>
            </x:XData>
        </XmlDataProvider>

        <Storyboard x:Key="slideLeftToRight"  
                    TargetProperty="RenderTransform.(TranslateTransform.X)"
                    AccelerationRatio=".4"
                    DecelerationRatio=".4">
            <DoubleAnimation Storyboard.TargetName="viewer" Duration="0:0:0.6" From="300" To="0"/>
            <DoubleAnimation Storyboard.TargetName="bordervisual" Duration="0:0:0.6" From="0" To="-300"/>
        </Storyboard>

        <Storyboard x:Key="slideRightToLeft" 
                    TargetProperty="RenderTransform.(TranslateTransform.X)"
                    AccelerationRatio=".4"
                    DecelerationRatio=".4">
            <DoubleAnimation Storyboard.TargetName="viewer" Duration="0:0:0.6" From="-300" To="0"/>
            <DoubleAnimation Storyboard.TargetName="bordervisual" Duration="0:0:0.6" From="0" To="300"/>
        </Storyboard>

        <VisualBrush x:Key="VisualBrush1" Visual="{Binding ElementName=viewer}"/>
    </Window.Resources>

    <Grid>
        <StackPanel>

            <StackPanel Orientation="Horizontal">
                <ListBox x:Name="viewList" Height="20" Width="300" SelectedIndex="0"
                    ItemsSource="{Binding Source={StaticResource views}, XPath=Views/View}"
                    DisplayMemberPath="@Title"                    
                    SelectionChanged="viewList_SelectionChanged">
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                </ListBox>
            </StackPanel>

            <Grid Width="300" Height="300">
                <Border x:Name="bordervisual" Width="300">
                    <Rectangle x:Name="rectanglevisual"/>
                    <Border.RenderTransform>
                        <TranslateTransform/>
                    </Border.RenderTransform>
                </Border>

                <ItemsControl x:Name="viewer" DataContext="{Binding Path=SelectedItem, ElementName=viewList}"
                    ItemsSource="{Binding XPath=Page}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Frame x:Name="frame" Source="{Binding XPath=@Source}"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.RenderTransform>
                        <TranslateTransform/>
                    </ItemsControl.RenderTransform>
                </ItemsControl>
            </Grid>
        </StackPanel>       
    </Grid>
</Window> 
```

Window1.xaml.cs

```
public partial class Window1 : Window
{
    private static int oldSelectedIndex = 0;

    public Window1()
    {
        InitializeComponent();
    }

    public RenderTargetBitmap RenderBitmap(FrameworkElement element)
    {
        double topLeft = 0;
        double topRight = 0;
        int width = (int)element.ActualWidth;
        int height = (int)element.ActualHeight;
        double dpiX = 96; // this is the magic number
        double dpiY = 96; // this is the magic number

        PixelFormat pixelFormat = PixelFormats.Default;
        VisualBrush elementBrush = new VisualBrush(element);
        DrawingVisual visual = new DrawingVisual();
        DrawingContext dc = visual.RenderOpen();

        dc.DrawRectangle(elementBrush, null, new Rect(topLeft, topRight, width, height));
        dc.Close();

        RenderTargetBitmap bitmap = new RenderTargetBitmap(width, height, dpiX, dpiY, pixelFormat);

        bitmap.Render(visual);
        return bitmap;
    }

    private void viewList_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        XmlElement root = (XmlElement)viewer.DataContext;
        XmlNodeList xnl = root.SelectNodes("Page");

        if (viewer.ActualHeight > 0 && viewer.ActualWidth > 0)
        {
            RenderTargetBitmap rtb = RenderBitmap(viewer);
            rectanglevisual.Fill = new ImageBrush(BitmapFrame.Create(rtb));
        }

        viewer.ItemsSource = xnl;

        if (oldSelectedIndex < viewList.SelectedIndex)
        {
            viewer.BeginStoryboard((Storyboard)this.Resources["slideLeftToRight"]);
        }
        else
        {
            viewer.BeginStoryboard((Storyboard)this.Resources["slideRightToLeft"]);
        }

        oldSelectedIndex = viewList.SelectedIndex;
    }

    private void SlideToPage_CanExecute(object sender, CanExecuteRoutedEventArgs e)
    {
        //The command can always be executed
        e.CanExecute = true;
    }

    private void SlideToPage_Executed(object sender, ExecutedRoutedEventArgs e)
    {
        //When the command is executed, we find the new pagenumber passed as a parameter
        //and switch the selected item of the ListBox, so the animation will run.
        int pagenumber = 0;

        if (int.TryParse(e.Parameter.ToString(), out pagenumber))
        {
            viewList.SelectedIndex = pagenumber;
        }
    } 
} 
```

命令.cs

```
using System;
using System.Windows.Input;

namespace FirstTry
{
    public static class Commands
    {
        public static readonly RoutedCommand SlideToPage = new RoutedCommand();
    }
} 
```

# java - JFace Databinding using a Comboviewer

> ID：13088932
> 
> 赞同：2
> 
> 时间：2012-10-26T14:33:40.837
> 
> 标签：java, data-binding, jface

I want to use JFace Databinding for a ComboViewer but I can't figure out how to do this correctly.

That's my current progress:

```
 CCombo c= new CCombo(grpCpu, SWT.BORDER);
    c.setEditable(false);

    ComboViewer c_viewer = new ComboViewer(text_6);
    c_viewer.setContentProvider(new ArrayContentProvider());
    c_viewer.setLabelProvider(new LabelProvider() {

        @Override
        public String getText(Object element) {
            return Activator.getSomeService().key2Value((Integer) element);
        }

    });
    c.setInput(new int[]{1, 2, 3}); 
```

The key2Value method (simple map to convert int values to strings):

```
public String key2Value(int key){
    return someHashMap.get(key);
} 
```

And the Databinding:

```
// IObservableValue target = SWTObservables.observeSelection(c);
IObservableValue target = ViewersObservables.observeSingleSelection(c_viewer);
IObservableValue model = BeansObservables.observeValue(getInputObject(), "id");
    ctx.bindValue(target, model, null, null); 
```

The binding already works correctly. If the selection in the UI is changed the value in the model is changed, too. But there is NO INITIAL SELECTION!

I really need some help here. Thx in advance!

By the way: If I bind the CCombo and not the Viewer, there is a correct initial selection (see the commented line in the second snippet)! But if I select any other item from the CCombo-box the value of the model is NOT CHANGED!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T15:34:43.463

Okay, I got it now. My code was correct all along. But I didn't realize that my model kept the the observableValue as long. And because the viewer input is an int array it didn't work correctly. All I had to do was simply write a custom UpdateValueStrategy:

```
IObservableValue target = ViewersObservables.observeSingleSelection(c_viewer);
IObservableValue model = BeansObservables.observeValue(getInputObject(), "id");

    UpdateValueStrategy u = new UpdateValueStrategy().setConverter(new IConverter() {

        @Override
        public Object getFromType() {
            return long.class;
        }

        @Override
        public Object getToType() {
            return int.class;
        }

        @Override
        public Object convert(Object fromObject) {
            return Integer.parseInt(fromObject.toString());
        }
    });
    ctx.bindValue(target, model, null, u); 
```

# sql - Multiple sed replace with back reference (parse SQL for joined tables)

> ID：13088933
> 
> 赞同：0
> 
> 时间：2012-10-26T14:33:48.917
> 
> 标签：sql, unix, sed

I'm trying to parse through some massive SQL query logs using sed and want to extract the names of all the tables that are joined in each query. Here's what I'm trying:

```
echo '[SQL_STMT="SELECT A FROM TABLEA JOIN TABLEB ON SOMETHING JOIN TABLEC ON SOMETHINGELSE WHERE A = 1"]' \
| sed -e 's/SQL_STMT=.*JOIN \([A-Z0-9_]*\) .*\]$/SQL_JOINS="\1"]/g' 
```

but this only returns the following:

```
[SQL_JOINS="TABLEC"] 
```

what I'd like to see is something like this:

```
[SQL_JOINS="TABLEB TABLEC"] 
```

and have it work for any number of joins

So how do I structure the backreference so that it gets all the joined tables?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:13:59.490

如果你对 perl 解决方案没问题，试试这个：

```
$ echo "......" | perl -ne '@x=/JOIN (\w+)/g;print "[SQL_JOINS=\""."@x"."\"]";' 
```

在上面的测试中：

```
$ echo "[SQL_STMT=\"SELECT A FROM TABLEA JOIN TABLEB ON SOMETHING JOIN TABLEC ON SOMETHINGELSE WHERE A = 1\"]" | perl -ne '@x=/JOIN (\w+)/g;print "[SQL_JOINS=\""."@x"."\"]";'
[SQL_JOINS="TABLEB TABLEC"] 
```

sed解决方案：

```
echo ...|sed -n ':a;/JOIN/{s/[^J]*JOIN \([A-Z0-9_]*\)/\1\n/;P;D;ta}' | sed -e ':a;N;s/\n/ /;ta' | sed  's/.*/[SQL_JOINS=\"&\"]/' 
```

第一个 sed 打印所有表名，第二个将表名的所有行合并为一个，最后一个将其格式化为所需的格式。

# java - Interacting between JSP page and Java object?

> ID：13088937
> 
> 赞同：0
> 
> 时间：2012-10-26T14:34:04.317
> 
> 标签：java, javascript, html, jsp, jakarta-ee

I am working on a project that runs a java back-end and has a web page UI.Basically, the java system runs in on the server and keeps a log of rules that are created in the web page. What I need it to do is take inputs from the text fields on the web page and call a function to pass them to the java object to create a new rule. I also need to be able to call a function to return an array of the rule objects I have created so I can build a table of them on the web page.

I have the UI built as a JSP page and the back-end java classes and functions are all built but I am lost as to how to connect the two.

This is my first attempt at creating a system like this and I have never written anything with Java EE or JSP before.

What I was thinking I could do would be to call a java function when I click the "submit" button to add a new rule and pass the field values to it. I had the same feeling for when I click a button to display the current rules, calling a java function to get the array of objects back and build it into a table.

Does anyone have any insight onto this?

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:48:07.153

我希望您想知道您是否可以在 JSP 中创建后端 Java 类的对象并调用这些对象的函数。为此，您可以使用：

**脚本标签** `<% any java code in between%>`

```
<% A a=new A();
a.funtion_of_class_A();%> 
```

要显示内容，您可以使用表达式标签。

```
<%=a.someotherfuntion()%> 
```

您可以使用指令来导入、初始化和定义变量

```
<%@ page import="com.a" %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T15:06:51.037

正如戴夫牛顿所说，有多种方法可以解决这个问题。最简单的一种是使用 Web 框架。你可以谷歌`Java Web Framework`或阅读[这篇文章](https://stackoverflow.com/questions/742223/what-is-the-most-commonly-used-java-web-framework)。

如果您正在寻找可与 JSP 一起使用的、轻量级且非常易于使用的东西，我会选择[Stripes](http://www.stripesframework.org/)。

# jquery - How to refer script in sitemaster

> ID：13088941
> 
> 赞同：3
> 
> 时间：2012-10-26T14:34:19.837
> 
> 标签：jquery, asp.net-mvc-3

I know in mvc the site master page shares resource(html elements) with aspx file.Like this it is possible to refer the script file in site master that will share with aspx?If so how to do that?

In other word am using script file in all my aspx. `<script src="../../../Src/Scripts/jquery.ui.widget.js" type="text/javascript"></script>`

Whether it is possible to refer in my sitemaster page that will make that script reference in all my aspx?(Excluding my apsx page)

thanks in Advance

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:56:58.263

对的，这是可能的。在站点管理员脚本块中写入

```
<script src="~/Scripts/jquery.ui.widget.js"></script> 
```

并且您所有拥有此母版的 aspx 页面都将使用此参考。

# php - 获取下拉选择以将用户引导至新页面（MySQL && P4A 应用程序框架）

> ID：13088946
> 
> 赞同：1
> 
> 时间：2012-10-26T14:34:36.140
> 
> 标签：php, mysql, zend-framework

我正在使用P4A应用程序框架，我已经制作了一个下拉选择框，允许用户选择所选时的位置（按下继续按钮）将用户带到新页面（取决于选择）。我被困的地方是在数据库中进行查询以获取位置的 ID 以将用户引导到正确的页面，这是我得到的代码：-

```
$this->build("p4a_db_source", "login")
    ->setTable("meetingrooms")
    ->load()
    ->firstRow();

    $this->build('p4a_field','location')
    ->setSource($this->login)
    ->setLabel('location')
    ->setType('select')
    ->setSourceValueField("ID")
    ->setSourceDescriptionField("MeetingRoom")
    ->setWidth(120);

    $this->build("p4a_fieldset","Book")
    ->anchor($this->location)
    //->anchor($this->booking)
    ->anchor($this->continue)
    ->setLabel('Meeting room bookings');
    $this->display("main",$this->Book);

}
public function change()
{
$location = $this->MeetingRoom->getNewValue();

$sql = "SELECT * FROM meetingrooms
    WHERE
            MeetingRoom = ?";
$row = p4a_db::singleton()->fetchRow($sql, array($location));

if ($row['MeetingRoom'] == "AreaOne")           
    {       
    p4a::singleton()->openmask("Area_One");
}
else 
{
    $this->setTitle("Process Failed");
{
    elseif ($location=="AreaTwo")
    {
        p4a::singleton()->openmask("AreaTwo");
    }
        elseif ($location=="AreaThree")
        {
            p4a::singleton()->openmask("AreaThree");
        } 
```

我很茫然，因为这是我需要的会议室系统应用程序的最后一点（减去一些非常小的细节。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T11:46:12.903

我认为这很重要，但是有一种更好的方法可以让这个系统使用小部件并将它们转移到活动页面，请查看 p4a 链接了解详细信息:)

[p4a](https://github.com/fballiano/p4a/wiki/FAQ)阅读文档以获取帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T16:13:19.177

忽略它，它不重要:)

# c - c pointer array argument

> ID：13088947
> 
> 赞同：1
> 
> 时间：2012-10-26T14:34:40.023
> 
> 标签：c, pointers

I have a function(in some library) whose signature is this:

```
extern LIB3DSAPI void lib3ds_mesh_calculate_face_normals(Lib3dsMesh *mesh, float (*face_normals)[3]); 
```

what does it expect in second argument?

I tried this:

```
 float   *norm_verts[3];
        norm_verts=(float(*)[3])malloc(3*sizeof(float[3])*mesh->nfaces);
        lib3ds_mesh_calculate_face_normals(mesh, norm_faces); 
```

on the second line, it says `Expression must be modifiable value` and the third line says `argument of type float** is incompatible with parameter of type float(*)[3]`

My intuition was that `float* [3]` is just 3 pointers but why the hell is the `*` wrapped in brackets?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:37:57.140

```
float (*face_normals)[3] // face_normals is a pointer (to an array of 3 floats)
float *norm_verts[3];    // norm_verts is an array of 3 pointers (to float) 
```

指针不是数组，数组不是指针。我建议您从第 6 节开始阅读[comp.lang.c 常见问题解答。](http://c-faq.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:37:36.150

包裹在`*`括号中以使其绑定更紧密。第二个参数`lib3ds_mesh_calculate_face_normals`被读取为“face_normals 是指向 3 个浮点数组的指针。

尝试：

```
float   (*norm_verts)[3];
norm_verts=(float(*)[3])malloc(sizeof(*norm_verts)*mesh->nfaces);
lib3ds_mesh_calculate_face_normals(mesh, norm_vets); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T14:36:49.183

> 我的直觉是这`float* [3]`只是 3 个指针

这是。

这也不是代码所说的。

该函数要求一个指向三个浮点数数组的指针。括号确保通过“绑定”`*`到名称而不是类型来解析它。

```
Lib3dsMesh *mesh    = getMeshFromSomewhere();
float norm_faces[3] = {};

lib3ds_mesh_calculate_face_normals(mesh, &norm_faces); 
```

以这种方式，函数`lib3ds_mesh_calculate_face_normals`知道它正在处理原始的实际数组`norm_faces`，而不是某些副本，也不是某个名称衰减到没有维度信息的指针。

这是使用数组“输出”参数*的*方法，而无需传递`float*`一个单独的长度参数。

# asp.net-mvc - 没有绑定的 MVC 3 模型属性

> ID：13088948
> 
> 赞同：0
> 
> 时间：2012-10-26T14:34:46.130
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3

是否可以在未绑定到数据库的模型中包含属性？例如：

```
Public Class Tbl_Forum_Topic

    <Key()> Public Property FTopic_ID() As Integer
    <ForeignKey("Tbl_Forum")> _
    Public Property FTopic_Forum_ID() As Integer
    Public Property FTopic_Employee_ID() As Integer
    Public Property FTopic_Resource_ID() As Integer
    Public Property FTopic_Title() As String
    Public Property FTopic_Content() As String
    Public Property FTopic_Create_Date() As Nullable(Of Date)
    Public Property FTopic__Deleted() As Nullable(Of Boolean)
    Public Property FTopic_Deleted_Date() As Nullable(Of Date)
    Public Property FTopic_Status() As Nullable(Of Boolean)
    Public Property FTopic_Publish() As Nullable(Of Boolean)

    Public Overridable Property Tbl_Forum() As Tbl_Forum

    Public Overridable Property Tbl_Forum_Replies() As ICollection(Of Tbl_Forum_Reply)

    Public Overridable Property Last_Reply_User_Name() As String

End Class 
```

最后一项称为`Last_Reply_User_Name()`。它不在我的数据库中，但我想循环并在我的控制器操作中执行计算，以根据其他数据库表中的值进行设置。`Invalid column name 'Last_Reply_User_Name'.`尝试此代码时出现错误。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:39:14.067

您需要将`<NotMapped>`属性应用于属性。

# c# - Does the machine configuration affect the accessibility of serialized output created using protobuf-net?

> ID：13088952
> 
> 赞同：1
> 
> 时间：2012-10-26T14:34:47.310
> 
> 标签：c#, protobuf-net

I am using protobuf-net to encrypt, serialize and store the contents of an object into a file and am using contents of the file after decrypting and desiralizing into the original object.

The object can be decrypted, and deserialized perfectly through my application on the machine on which it was created but when the exact same application reads the exact same file when executed on another machine, it throws an exception asking me to refer to one of the existing questions on stackoverflow. I am unable to post the exact stacktrace right now but will be doing so shortly.

My question is - does the physical configuration of the machine on which the serialization and storage of an object into a file takes place have any bearing on its availability elsewhere?

I think this should not be the case as it would defeat the purpose of serialization and that there is a gap in my understanding.

All help is sincerely appreciated.

Thanks!

**EDIT:**

Thanks Marc! - for both the reply and the awesome library itself. I'll post back more details regarding the stack trace, the encryption technique used, and the length and bytes of the contents. Though I doubt that there is a problem in the encryption/decryption code logic since the same code creates and uses the file successfully on one machine. Overwriting an existing file can also be ruled out as the created files are named using a guid so the name getting repeated is improbable. Could you please clarify on what exactly you mean by "by treating the file as text at some point"?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:59:24.267

不，不应该对机器配置有任何依赖。例如，在常规 .net 上序列化数据然后在 windows phone 上反序列化它是完全合理的，或者在浏览器中的 unity 上通过 MonoTouch 在 iOS 上反序列化它是完全合理的。

那么，我首先关心的是它是否真的是“完全相同的文件”。特别是解密**后**（因为一些加密技术*确实*使用机器配置，但这与protobuf-net无关）

我强烈建议在解密后检查长度和字节（或者如果它很大，则使用散列函数）。常见错误：

*   您的加密/解密代码中的错误
*   用更少的数据覆盖预先存在的文件，最后留下旧垃圾（在这种情况下：一定要截断文件）
*   在机器之间传输文件时损坏，例如在某些时候将文件视为文本

如果您有一个可重复的示例（在这里，或者如果您无法在此处公开发布，则通过电子邮件），可能会说更多。

# visual-studio-2010 - Generate WCF Proxy With Client Behaviors

> ID：13088954
> 
> 赞同：1
> 
> 时间：2012-10-26T14:34:55.170
> 
> 标签：visual-studio-2010, wcf, proxy, visual-studio-2012, svcutil.exe

A question someone asked in 2008, about [proxy-generation of client-side behaviors](http://www.vistax64.com/indigo/127576-behavior-attribute-client-proxy-without-any-coding.html), I'd like to repeat. I want custom client-side behaviors, decorated as attributes on service contracts or operations, to be "acknowledged" by Visual Studio (or svcutil) when I execute "discover" on the add-service-reference dialogue. The result would be a proxy that already has the client-side behaviors (and assembly references) added automagically.

That feature still seems unavailable as of VS 2010 SP1\. Does VS 2012 do that? Is there a 3rd party tool that does that?

p.s. To be clear, I am not asking about extending WSDL capabilities. I don't expect the above trick would ever work for that. I am talking strictly in the context of the "discover" button within Visual Studio's in-built proxy generation capability.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:30:48.390

我不确定是否可以使用 svcutil/add 服务引用，但作为替代方案，.NET Framework 有一个名为[MetadataResolver](http://msdn.microsoft.com/en-us/library/ms599505.aspx)的类，它允许您在运行时从 MEX / wsdl 端点获取配置。

具体来说，您调用该`Resolve`方法会返回一个[ServiceEndpointCollection](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.serviceendpointcollection.aspx)实例。ServiceEndpoint 有一个[Behaviors](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.serviceendpoint.behaviors.aspx)属性，该属性返回服务上定义的行为集合。

在这种情况下，您调用服务来检索您的行为，而不是用属性装饰类。这样做的好处是允许您在一个地方（服务）定义客户端和服务器的配置并使它们保持同步（与需要在客户端上完成的服务配置更新相反）。缺点是您现在在调用服务时进行了两次调用（尽管我过去通过拥有一个静态实例并将 Resolve 方法的响应保存在内存中来缓解）并且您需要公开服务元数据。

# mysql - Adding dependency to mysql-connector-java causes NoSuchMethodError: com.google.common.cache.CacheBuilder.maximumSize(I) in my Play framework2 app

> ID：13088956
> 
> 赞同：0
> 
> 时间：2012-10-26T14:34:57.827
> 
> 标签：mysql, playframework-2.0

As the title states I have added mysql dependency:

```
 val appName         = "report"
    val appVersion      = "1.0-SNAPSHOT"

    val appDependencies = Seq(
      "com.google.apis" % "google-api-services-analytics" % "v3-rev15-1.8.0-beta",
      "com.google.http-client" % "google-http-client-jackson2" % "1.11.0-beta",
      "com.google.oauth-client" % "google-oauth-client-jetty" % "1.11.0-beta",
      "mysql" % "mysql-connector-java" % "5.1.18",
     )

    val main = PlayProject(appName, appVersion, appDependencies, mainLang = JAVA).settings(
      resolvers += "Google Analytics" at "http://mavenrepo.google-api-java-client.googlecode.com/hg"
    ) 
```

This causes:

Caused by: java.lang.NoSuchMethodError: com.google.common.cache.CacheBuilder.maximumSize(I)Lcom/google/common/cache/CacheBuilder;

I guess there is something in the mysql dependencies that gets rid of that method... But what?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:38:57.030

这通常意味着 JAR 版本的方法签名与调用代码中的内容不匹配。检查 CacheBuilder JAR 的版本。你可能不同步。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-26T14:46:58.183

好的，找到了！

首先，自从 Guava 11 更改后，我需要更新 Guava：

```
CacheBuilder#maximumSize(int) has been replaced with CacheBuilder#maximumSize(long) 
```

因此，我将 Guava 更新到了最新版本 13.0.1，但仍然出现错误。这是因为反射仍然是错误的。将反射更改为 0.9.8，一切正常。

```
val appDependencies = Seq(
      "com.google.apis" % "google-api-services-analytics" % "v3-rev15-1.8.0-beta",
      "com.google.http-client" % "google-http-client-jackson2" % "1.11.0-beta",
      "com.google.oauth-client" % "google-oauth-client-jetty" % "1.11.0-beta",
      "mysql" % "mysql-connector-java" % "5.1.18",
      "org.reflections" % "reflections" % "0.9.8",
      "com.google.guava" % "guava" % "13.0.1"
     ) 
```

# ruby-on-rails - 为什么我收到“工厂未注册”错误？

> ID：13088959
> 
> 赞同：1
> 
> 时间：2012-10-26T14:35:06.827
> 
> 标签：ruby-on-rails, ruby-on-rails-3, factory-bot

我有一个模型答案：

```
class Answer < ActiveRecord::Base
  attr_accessible :content

  belongs_to :question
end 
```

在我的问题模型中，我定义了`has_many :answers`. 我的答案模型有三列：内容（文本）、问题 ID（整数）、正确（布尔）。`correct`列的默认值为`false`。

我创建了工厂来创建 Answer 对象：

```
factory :answer do
  content "Content of an answer"
  question

  factory :accept_answer do
    correct true
  end
end 
```

在我的 rspec 文件中，我使用以下代码成功创建了新的答案对象：

```
let(:answer) { FactoryGirl.create(:answer, question: question) }

subject { answer }
its(:correct) { should be_false } 
```

但是当我使用下面的代码创建 accept_answer 对象时：

```
describe "an accepted answer" do
  let(:accept_answer) { FactoryGirl.create(:accept_answer, question: question) } 
  it { accept_answer.correct.should be_true }
end 
```

它有错误

```
Failure/Error: let(:accept_answer) { FactoryGirl.create(:accept_answer, question: question) }
ArgumentError:
   Factory not registered: accept_answer 
```

我不知道我的代码有什么问题:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T10:07:21.743

问题是因为 spork 服务器无法重新确定我所做的更改，所以我重新启动了 spork 服务器并且它可以工作。

# seo - How do I incorporate microdata and rich snippets into an asp.net site with 47 pages for optimal SEO?

> ID：13088961
> 
> 赞同：1
> 
> 时间：2012-10-26T14:35:14.923
> 
> 标签：seo, search-engine, microdata, rich-snippets

I have a company website (asp.net/vb) in 10 different languages, although 97% of the users view it in English. I've been reading more and more about microdata and rich snippets, but I'm still confused about how to incorporate them into my website. I've read Google Webmaster Tools, but I'm still confounded.

Where do the **itemtype** and **itemprop** span tags go? I have 5 master pages. Should I just put them in there, or would I have to create unique rich snippeets in each of the 47 pages my website has? The main key phrase I want throughout search results is "**machine vision**".

For instance, the first couple sentences on my "about.aspx" page are:

```
USS Vision Inc. (USS) is a privately-owned company with headquarters in Detroit, 
Michigan, USA. We design, engineer, produce, and integrate special machine vision 
error-proofing products and services that create lean factories by improving the 
quality of manufactured products, and by significantly reducing manufacturing costs 
through advanced automation. 
```

Should I put rich snippets in there, or can I just use the about.aspx master page, which covers about 8 other pages? How would I do this? Should I use the **itemprop="url"** for every link in my website? Any guidance in this regard to help improve my SEO and SERPS would be greatly appreciated!

# http - Google Chrome Request - Negative connecting time

> ID：13088963
> 
> 赞同：0
> 
> 时间：2012-10-26T14:35:18.617
> 
> 标签：http, google-chrome, connection, request, httprequest

How come a connecting time in an http request made by Google Chrome, can be negative?

![Negative connecting time](../Images/59f5caa2cb3054e87e1d1dd893a75caa.png)

Best Regards

# javascript - JavaScript Hash Tag Parsing Function

> ID：13088965
> 
> 赞同：0
> 
> 时间：2012-10-26T14:35:23.150
> 
> 标签：javascript, regex, twitter

I already had two regex functions to parse url's and replies from a json twitter response but I tried to extend it to parse hash tags aswell but I am getting `undefined` displayed in palce of the hashtag:

```
// process links, reply and hash tags
tweet = tweet.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig, function(url) {
        return '<a href="'+url+'">'+url+'</a>';
    }).replace(/B@([_a-z0-9]+)/ig, function(reply) {
        return  reply.charAt(0)+'<a href="http://twitter.com/'+reply.substring(1)+'">'+reply.substring(1)+'</a>';
    }).replace(/#([a-zA-Z0-9]+)/g), function(hash) {
        return '<a class="hashtag" target="_blank" href="http://twitter.com/#search?q='+$1+'">#'+$1+'</a>';
    }; 
```

Any pointers on where I'm going wrong?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:41:46.940

**$1**变量未定义，将其替换为**hash.substring(1)**

此外，您需要在匿名函数声明之后关闭最后一个函数调用。

```
tweet = tweet.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig, function(url) {
    return '<a href="'+url+'">'+url+'</a>';
}).replace(/B@([_a-z0-9]+)/ig, function(reply) {
    return  reply.charAt(0)+'<a href="http://twitter.com/'+reply.substring(1)+'">'+reply.substring(1)+'</a>';
}).replace(/#([a-zA-Z0-9]+)/g, function(hash) {
    return '<a class="hashtag" target="_blank" href="http://twitter.com/#search?q='+hash.substring(1)+'">#'+hash.substring(1)+'</a>';
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:41:31.693

最后一个替换中的函数接受一个散列参数，在你的返回中使用它而不是 $1

# wpf - 将 FontWeight 设置为 Bold 会缩小文本大小

> ID：13088971
> 
> 赞同：4
> 
> 时间：2012-10-26T14:35:54.970
> 
> 标签：wpf, xaml

我一直在设置资源字典来设置 WPF 应用程序中所有控件的样式，并且在为标签设置字体粗细时发现了一些奇怪的行为。

我必须为标签设置样式，第一个具有正常字体粗细：

```
<Style x:Key="Label" TargetType="{x:Type Label}">
    <Setter Property="VerticalAlignment" Value="Center"/>
    <Setter Property="Margin" Value="10,0"/>
</Style> 
```

第二个设置为粗体：

```
<Style x:Key="LabelBold" TargetType="{x:Type Label}">
    <Setter Property="VerticalAlignment" Value="Center"/>
    <Setter Property="Margin" Value="10,0"/>
    <Setter Property="FontWeight" Value="Bold"/>
</Style> 
```

问题是当我使用粗体加权字体时，文本会缩小（或文本间距）：

![在此处输入图像描述](../Images/a4375d15e29d9de56ad040a9e6b95cf1.png)

我已经搜索过，但我似乎看不到任何原因，如果有什么我希望文本会因为字母厚度增加而扩大。这是要发生的吗？如果是这样，有办法解决吗？

**编辑：**窗口使用以下字体：

```
<Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
<Setter Property="FontFamily" Value="Calibri"/>
<Setter Property="FontSize" Value="12"/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-27T02:23:57.350

我不确定发生了什么，但我猜有些东西覆盖`FontSize`了粗体标签的选择。如果设置为 11 而不是 12，我可以获得与您的示例大致相同的间距`FontSize`。我得到这个图像，顶部 2 个标签设置为`FontSize`12，底部标签设置为`FontSize`11：

![在此处输入图像描述](../Images/775beccefd94174060e7f5d802ae16dc.png)

使用这个：

**应用程序.Xaml**

```
<Application x:Class="WpfApplication1.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
        <Style x:Key="Label" TargetType="{x:Type Label}">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="10,0"/>
        </Style>
        <Style x:Key="LabelBold" TargetType="{x:Type Label}">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="10,0"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
        <Style x:Key="WindowStyle" TargetType="{x:Type Window}">
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="FontFamily" Value="Calibri"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
    </Application.Resources>
</Application> 
```

**主窗口.xaml**

```
Window x:Class="WpfApplication1.MainWindow"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Style="{StaticResource WindowStyle}">
    <Grid>
        <Label Style="{StaticResource Label}" Height="32" HorizontalAlignment="Left" Margin="10,10,0,0" Name="label1" VerticalAlignment="Top">This is a test of font-weight:</Label>
        <Label Style="{StaticResource LabelBold}" Height="32" HorizontalAlignment="Left" Margin="10,30,0,0" Name="label2" VerticalAlignment="Top">This is a test of font-weight:</Label>
        <Label Style="{StaticResource LabelBold}" Height="32" HorizontalAlignment="Left" Margin="10,50,0,0" FontSize="11" Name="label5" VerticalAlignment="Top">This is a test of font-weight:</Label>
    </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-29T14:17:49.987

在对 Mark Hall 和 Sayed Saad 的评论进行了一些调查之后，我设法找出了造成这种情况的原因：TextOptions.TextFormattingMode = Display。

正如马克指出的那样，当您增大字体大小时，粗体文本确实会比正常字体文本更大。但是，如果我将 TextFormattingMode 更改为“Ideal”，那么无论字体大小如何，粗体字体都会比普通字体大。

**编辑：**根据我在这里的发现，我发布了另一个问题，可以在这里找到答案：[TextOptions.TextFormattingMode 影响带有粗体字重的文本](https://stackoverflow.com/questions/13140431/textoptions-textformattingmode-affecting-text-with-bold-font-weight)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T16:04:58.630

看起来您没有使用相同的字体大小。我尝试了两个具有相同字体大小和边距的标签。实际上粗体标签扩大了。

# sql-server - 使用 dtexec 运行 SSIS 包

> ID：13088974
> 
> 赞同：6
> 
> 时间：2012-10-26T14:36:01.713
> 
> 标签：sql-server, ssis, export-to-excel

我正在使用 dtexec 运行 SSIS 包。该软件包在我的系统上的 BIDS 中运行良好。当我创建 SQL Server 代理作业以按计划运行包时。包运行步骤被安排为 T-SQL 任务，而不是 SSIS 包）。该作业没有报告错误，但它甚至没有在服务器上创建输出 excel 文件@我想要的目标。

此外，当我在命令 shell 中单独运行命令时，它会返回如下所示的错误。间歇性地，它还会在我用来复制文件的文件系统任务上返回错误，说源或目标不存在！当我在 BIDS 中使用相同的变量值时，为什么 SQL 作业会失败？

```
Started:  7:33:27 PM
Error: 2012-10-26 19:33:27.60
   Code: 0xC0016016
   Source:
   Description: Failed to decrypt protected XML node "DTS:Password" with error 0
x8009000B "Key not valid for use in specified state.". You may not be authorized
to access this information. This error occurs when there is a cryptographic err
or. Verify that the correct key is available.
End Error
Error: 2012-10-26 19:33:27.78
   Code: 0xC00F9304
   Source: GICSReport Connection manager "Excel Connection Manager"
   Description: SSIS Error Code DTS_E_OLEDB_EXCEL_NOT_SUPPORTED: The Excel Conne
ction Manager is not supported in the 64-bit version of SSIS, as no OLE DB provi
der is available.
End Error
Error: 2012-10-26 19:33:27.78
   Code: 0xC020801C
   Source: Data Flow Task Excel Destination [22]
   Description: SSIS Error Code DTS_E_CANNOTACQUIRECONNECTIONFROMCONNECTIONMANAG
ER.  The AcquireConnection method call to the connection manager "Excel Connecti
on Manager" failed with error code 0xC00F9304\.  There may be error messages post
ed before this with more information on why the AcquireConnection method call fa
iled.
End Error
Error: 2012-10-26 19:33:27.78
   Code: 0xC0047017
   Source: Data Flow Task SSIS.Pipeline
   Description: component "Excel Destination" (22) failed validation and returne
d error code 0xC020801C.
End Error
Error: 2012-10-26 19:33:27.78
   Code: 0xC004700C
   Source: Data Flow Task SSIS.Pipeline
   Description: One or more component failed validation.
End Error
Error: 2012-10-26 19:33:27.79
   Code: 0xC0024107
   Source: Data Flow Task
   Description: There were errors during task validation.
End Error
DTExec: The package execution returned DTSER_FAILURE (1).
Started:  7:33:27 PM
Finished: 7:33:27 PM
Elapsed:  0.343 seconds 
```

请帮忙！:) .... 我应该将所有变量、连接管理器和所有内容添加到我的配置文件中吗？目前我只添加了变量和连接管理器的一些 ppty 值，但似乎没有组合有效。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-26T18:17:26.277

The first error I would address is "The Excel Connection Manager is not supported in the 64-bit version of SSIS, as no OLE DB provider is available."

The out of the box Excel drivers only exist in the 32 bit address space. BIDS/SSDT is a 32 bit application so Excel source and destinations work just fine. However, when you run them from the commandline/SQL Agent, then you need to explicitly use the 32 bit version of the DTEXEC program.

Step 1, will be to ensure you can run the package from the command line on the server the agent executes on as yourself. Assuming your SQL Server is installed in the customary location, you probably have one of the following DTEXEC.exe available to you

```
C:\Program Files\Microsoft SQL Server\90\DTS\Binn\DTExec.exe
c:\Program Files\Microsoft SQL Server\100\DTS\Binn\DTExec.exe
C:\Program Files\Microsoft SQL Server\110\DTS\Binn\DTExec.exe
C:\Program Files\Microsoft SQL Server\120\DTS\Binn\DTExec.exe
C:\Program Files (x86)\Microsoft SQL Server\90\DTS\Binn\DTExec.exe
C:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\DTExec.exe
C:\Program Files (x86)\Microsoft SQL Server\110\DTS\Binn\DTExec.exe
C:\Program Files (x86)\Microsoft SQL Server\120\DTS\Binn\DTExec.exe 
```

You will want to use the (x86) version. Future readers, if you happen to be on a 32 version of Windows (Windows 2003, maybe), the first 3 will be the only options available to you. As Vivek's error message has indicated, he is executing an SSIS package in 64 bit mode.

[dtexec](http://msdn.microsoft.com/en-us/library/ms162810%28v=sql.105%29.aspx) provides a command-line switch **/X86** to allow you to seamlessly use the same executable for both 32 and 64 bit operations. **LIES!** The documentation does call that out but who reads documentation?

> This option is only used by SQL Server Agent. This option is ignored if you run the dtexec utility at the command prompt.

So, you will need to run your package by providing the explicit path

`C:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\DTExec.exe /file C:\folder\GICSReport.dtsx`

I see "Failed to decrypt protected XML node" in your output and you also state you are using configuration files so you can most likely change your PackageProtectionLevel from the default EncryptSensitiveWithUserKey to DontSaveSensitive. That feature exists to prevent accidental exposure of sensitive data (passwords) but since you are already handling that with config files, that should not be an issue. ... That might actually be an error from one of the other package protection levels now that I think about it.

At any rate, try running from the 32 bit executable first. If that doesn't work try changing the package protection level as indicated. If either of those make the package run as expected, then attempt to run the same command from the SQL Agent.

If it all works, mark this as the answer. If not, please update the ticket with the current error being generated and we'll ask for more information.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-08T01:18:04.503

如果您尝试使用`dtexec`包含 excel 导入的 from transact SQL 运行 SSIS 包，这里是解决方案。

1.  创建一个包含以下代码的批处理文件。

    cd C:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\ DTEXEC.exe /DE "密码" /F "C:\mySSISfolder\package.dtsx"

2.  创建指向批处理文件`properties\advanced`的快捷方式，将快捷方式设置为以管理员身份运行。

3.  从您的事务处理 sql 过程中运行以下命令

    exec xp_cmdshell 'C:\myfolder\runssis_sc.lnk'

# php - Magento：每次循环运行时创建帮助类的新实例？

> ID：13088978
> 
> 赞同：1
> 
> 时间：2012-10-26T14:36:15.467
> 
> 标签：php, magento

我创建了一个自定义助手类模块，我正在调用它：

```
$bench = Mage::helper('benchmark');
// ... do stuff ...
$bench->addBenchmark();
// ... more stuff ...
$bench->logResults(); 
```

这会在数组中输出时间基准的结果。

该类非常简单，它基本上只是将当前添加到一个数组中，然后在调用`microtime()`时将该数组吐出。`logResults()`

问题是，我有一个循环，我在其中调用上面的代码，但不是在每个循环中记录一组“新”的基准数据，而是复合自身并添加到现有的基准数组中！

我希望它每次`Mage::helper('benchmark');`调用时都创建一组新的基准。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:44:58.827

使用不可能的助手，除非您在调用该`addBenchmark`方法时手动刷新数组的内容。

问题出在以下几点。在`Mage.php`您请求的帮助程序中存储在注册表中。在下一次调用时，将从注册表中检索完全相同的帮助对象，而不是新的。它仅在第一次调用助手时创建一个实例。

```
/**
 * Retrieve helper object
 *
 * @param string $name the helper name
 * @return Mage_Core_Helper_Abstract
 */
public static function helper($name)
{
    if (strpos($name, '/') === false) {
        $name .= '/data';
    }

    $registryKey = '_helper/' . $name;
    if (!self::registry($registryKey)) {
        $helperClass = self::getConfig()->getHelperClassName($name);
        self::register($registryKey, new $helperClass);
    }
    return self::registry($registryKey);
} 
```

您可以选择模型，因为`getModel()`每次调用工厂方法时都会返回一个新实例。尽管在我看来，这是一个糟糕的编程案例，也会损害你的性能。

我会选择在拨打新电话时刷新最新数据`addBenchmark`。如果您想将所有数据存储在帮助程序中以供以后处理，也许总是返回数组中的最新键？不过，那是选择和口味的问题，所以我将把这部分留给你。

希望这对您有所帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T14:47:02.740

添加基准密钥并制作类似

```
$this->benchmarks[$key]['start'] = microtime(true);
// ... 
$this->benchmarks[$key]['finish'] = microtime(true); 
```

所以每次迭代都会有一组开始-完成对

为什么不想使用 Varien_Profiler？

```
Varien_Profiler::start($_profilerKey);
// ...
Varien_Profiler::stop($_profilerKey); 
```

# c# - C#正则表达式拆分字符串并返回任一子字符串

> ID：13088979
> 
> 赞同：0
> 
> 时间：2012-10-26T14:36:24.173
> 
> 标签：c#, regex

我有一个需要使用正则表达式拆分的字符串。我可以在 .NET 中使用拆分方法，但要返回的字符串可能是第一个或第二个子字符串。此正则表达式将成为应用程序中的可配置设置。

一个典型的字符串是 9234567X123456-789

我创建了以下正则表达式

```
 [-09]([^X]*)X 
```

返回第一个子字符串。但是，我丢失了第一个数字，返回 234567。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:39:14.740

是的，您丢失了第一个数字，因为它被`[-09]`零件占用了。目前还不清楚为什么你有这个。我怀疑你只是想要：

```
([^X]*)X 
```

换句话说，“捕获第一个 X 之前的所有内容，并检查是否真的存在 X。”

示例代码：

```
using System;
using System.Text.RegularExpressions;

public class Test
{
    static void Main(string[] args)
    {
        Regex regex = new Regex("([^X]*)X");
        string input = "9234567X123456-789";
        Match match = regex.Match(input);
        // TODO: Check for success
        Console.WriteLine(match.Groups[1]); // 9234567
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:54:09.017

我假设您希望字符串以`-`,`0`或`9`. 如果这是真的，那么您需要的正则表达式（并且在这里使用正则表达式是矫枉过正，除非您还想执行某种验证）是

```
([-09]\d*)X 
```

或者

```
([-09][^X]*)X 
```

如果您在之前的部分中允许任何类型的字符（不仅是数字）`X`

**编辑**：

可能已经了解您在阅读示例字符串时要查找的内容：

```
9234567X123456-789 
```

您需要第一组或第二组，每个组都可以有数字或连字符 ( `-`)。您可以通过创建两个组来解决此问题：

```
([\d\-]+)X([\d\-]+) 
```

然后您可以查看 Jon Skeet 的答案以获取数据。你可以使用

```
match.Groups[1]); //to get 9234567 
```

或者

```
match.Groups[2]); //to get 123456-789 
```

# java - 通过 onDestroy() 事件存储变量

> ID：13088981
> 
> 赞同：0
> 
> 时间：2012-10-26T14:36:29.710
> 
> 标签：java, android, variables, state, ondestroy

我正在寻找一种方法来存储可能已**通过****onDestroy()**事件从启动变量（通过用户激活函数或其他）更改的变量的状态，以便如果我打开和关闭我的手机应用程序尚未重置变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:53:48.213

首先，这是来自 android 参考：“注意：不要指望调用 onDestroy 方法作为保存数据的地方！例如，如果活动正在内容提供程序中编辑数据，则应在 onPause 中提交这些编辑() 或 onSaveInstanceState(Bundle)"

为了保存变量，您可以像 SharedPreferences 之前所说的那样使用。

使用内部活动类的示例：

```
SharedPreferences prefs = getSharedPreferences("preference_file_name", Context.MODE_PRIVATE);
SharedPreferences.Editor editor = prefs.edit();
editor.putString("variable_key", variable);
editor.commit(); 
```

对于方法 onSaveInstanceState(Bundle) 只需使用 Bungle 参数来保存变量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:39:26.303

看`SharedPreferences`特征。它专为这种情况而设计。阅读的好网站在[这里](http://developer.android.com/guide/topics/data/data-storage.html)，[这个](http://alchemiaandroid.altervista.org/sharedPreferencesTutorial.html)和[这个](http://developer.android.com/reference/android/content/SharedPreferences.html)。看看[这个](https://stackoverflow.com/questions/3851560/how-to-use-sharedpreferences)问题。

# mysql - PDO 准备好的查询不返回任何内容

> ID：13088986
> 
> 赞同：2
> 
> 时间：2012-10-26T14:36:39.943
> 
> 标签：mysql, pdo, prepared-statement

这是上一个问题的后续：[何时使用 PDO 准备查询。mysql_real_escape 错误](https://stackoverflow.com/questions/13037853/when-to-use-pdo-prepared-queries-mysql-real-escape-error)

我是一个完全的初学者，在查询我的数据库之前，我在每个 GET 和 POST 变量上都使用了 mysql_real_escape。当我上传到我的主机时，我意识到你不应该将它与 PDO 一起使用。我正在将用户提交数据的所有查询更改为准备好的查询。

我像这样连接到我的数据库：

```
$hostname = "localhost";
$username = "root";
$password = "root";

try {
     $dbh = new PDO("mysql:host=$hostname;dbname=wmpt", $username, $password);

}
catch(PDOException $e)
    {
    echo $e->getMessage();
    } 
```

下面是一个示例查询：

```
$url = $_GET['q'];
$STH = $dbh->prepare("SELECT qid FROM tblurl WHERE url = :url");
$STH->bindParam(':url', $url);
$STH->setFetchMode(PDO::FETCH_ASSOC);  
$urlid = $STH->fetch();
print_r($urlid); 
```

print_r 绝对没有输出，我正在使用数据库中的测试值测试我的 GET 变量。任何想法我做错了什么？我确定我是个白痴，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:42:32.447

您只需要在获取结果之前[执行查询。](http://php.net/manual/en/pdostatement.execute.php)

```
$url = $_GET['q'];
$STH = $dbh->prepare("SELECT qid FROM tblurl WHERE url = :url");
$STH->bindParam(':url', $url);

$STH->execute();

$STH->setFetchMode(PDO::FETCH_ASSOC);  
$urlid = $STH->fetch();
print_r($urlid); 
```

# database - 通过同一电子表格中的其他表格更改谷歌电子表格中的数据

> ID：13088988
> 
> 赞同：1
> 
> 时间：2012-10-26T14:36:45.013
> 
> 标签：database, function, google-apps-script, google-sheets

**问题：**

Google 电子表格非常适合查看/过滤数据，也非常适合用作应用程序数据库。
但是是否可以通过另一个工作表编辑工作表上的数据？

***功能说明：***

我们是一个小组 (5) 非书呆子，他们跟踪我们所做的任务。我们通过谷歌电子表格执行此操作，效果很好:) 我们通过电话接收任务并将这些任务添加到工作表 1。当有人拿起任务时，他/她将他/她的名字添加到任务（行）的 sheet1 中的相应列中。我们跟踪每个任务的状态更新等。

***变化的原因：***

这个电子表格的 Sheet1 现在太大了，可以清楚地了解 1 个人的任务。所以我在大电子表格中有 20 个任务，但是由于添加新任务时排序不方便，所以每人有一张单独的工作表会很好。这可以通过 query() 函数轻松完成。但这是一条单行道。您无法更改此数据并将其返回到主工作表中。而且使用 sheet1 作为报表也不方便，因为如何添加新任务？

***问题改写：***

1.  那么是否可以通过同一电子表格的另一张表中可用的数据子集来更改“主”表中的数据？

2.  如果没有，是否可以使用谷歌电子表格作为界面（读/写/更新）到谷歌应用引擎中的 sqlite 数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T20:20:56.157

> 那么是否可以通过同一电子表格的另一张表中可用的数据子集来更改“主”表中的数据？

*对于 Google Apps 脚本解决方案*，我相当笼统的想法是：

1.  如果主表中的每一行都没有唯一标识符，请创建一个。这可能只是一个时间戳列，它本身可以使用 onEdit 函数自动生成。

2.  在查看表中，用户将通过运行脚本（可能来自自定义菜单）来编辑信息，该脚本将显示一个输入框来编辑活动单元格。当然，当确认编辑时，脚本会根据唯一标识符更新主表中的相应单元格；并且您的 QUERY 函数会将更改传播回查看表。（警告：当并发用户查看电子表格时，我发现获取活动单元格是不可预测的，您可能需要使用不同的方法来指定要编辑的内容。）

3.  如果您希望能够从查看表创建记录，而不是导航到主表并直接输入它们，您可能还需要一个“新记录”脚本。

* * *

*对于使用本机电子表格功能和工具的解决方案*：

根本没有办法完全按照您指定的方式执行“双向”任务。但是，您也许可以使用内置过滤器工具获得可行的解决方案。

1.  选择原始数据，然后单击过滤器按钮（或数据、过滤器）。然后使用出现的下拉箭头，您可以将数据过滤到您当时关注的内容。优点是可以在熟悉的电子表格界面中轻松编辑数据；缺点是所有并发查看者都看到相同的过滤器（即每个用户无法使用此方法拥有自己唯一的过滤视图）。

2.  或者，使用列表视图（视图，列表）。这是一个不同的界面，它提供了比选项 1 稍微更多的基本过滤和排序工具。但是，它有一个明显的优势，即并发查看器可以彼此不同地过滤数据。编辑有点笨拙（您需要单击左侧的编辑按钮），但仍然可以。

# javascript - 有没有办法选择使用特定 CSS3 属性的元素？

> ID：13088993
> 
> 赞同：1
> 
> 时间：2012-10-26T14:37:06.700
> 
> 标签：javascript, jquery, css

我想选择 DOM 中所有具有边框半径的元素！== 0。

你们知道这样做的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T14:38:33.130

是的。使用[.filter()](http://api.jquery.com/filter/)函数。

```
$(elements).filter(function(){
     return parseInt($(this).css("border-radius"),10) != 0;
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T14:38:29.230

使用 CSS 类定义边框半径，然后使用 jQuery 选择它们。

CSS：

```
.border-radius {
    border-radius: 4px;
} 
```

JS：

```
$('.border-radius') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-26T14:52:22.327

因为我喜欢彻底，我们应该考虑`border-radius`可以接受多个值来分别描述所有四个角的事实：

```
$('*').filter(function() {
    var br = $(this).css("border-radius").split(' '),
        test = false;
    for (var i = 0, j = br.length; i < j; i++) {
        test = test || parseInt(br[i], 10);
    };
    return test;
}) 
```

[http://jsfiddle.net/mblase75/SLUcb/](http://jsfiddle.net/mblase75/SLUcb/)

也就是说，过滤页面上的每个元素是非常低效的。更好的方法是将 分配`border-radius`给一个类并测试该类的对象是否存在。

# php - 在 PHP 中计算模 256 校验和

> ID：13088995
> 
> 赞同：1
> 
> 时间：2012-10-26T14:37:08.843
> 
> 标签：php, modulo, fix-protocol

我已经搜索过 Stackoverflow，不幸的是什么也没找到。我正在使用 FIX 协议，我需要生成一个模 256 校验和，如[http://fixwiki.fixprotocol.org/fixwiki/CheckSum](http://fixwiki.fixprotocol.org/fixwiki/CheckSum)中所述。

```
$count = strlen($message);
$count = $count % 256;
$checksum = 256 - $count;

if(strlen($checksum) == 1) {
    $checksum = '00' . $checksum;   
}

if(strlen($checksum) == 2) {
    $checksum = '0' . $checksum;    
} 
```

使用 FIX 字符串：

8=FIX.4.2|9=42|35=0|49=A|56=B|34=12|52=20100304-07:59:30

它应该返回：

8=FIX.4.2|9=42|35=0|49=A|56=B|34=12|52=20100304-07:59:30|10=185|

但是我的脚本返回：

8=FIX.4.2|9=42|35=0|49=A|56=B|34=12|52=20100304-07:59:30|10=199|

如果有人能指出我正确的方向，我将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T15:13:21.503

根据[http://fixwiki.fixprotocol.org/fixwiki/CheckSum](http://fixwiki.fixprotocol.org/fixwiki/CheckSum)校验和不仅仅是消息模 256 的长度。
它是每个字符的总和（作为 ascii 值）模 256。

```
<?php
define('SOH', chr(0x01));

$message = '8=FIX.4.2|9=42|35=0|49=A|56=B|34=12|52=20100304-07:59:30|';
$message = str_replace('|', SOH, $message);
echo $message, GenerateCheckSum($message);

function GenerateCheckSum($message) {
    $sum = array_sum(
        array_map(
            'ord', 
            str_split($message, 1)
        )
    );
    $sum %= 256;
    return sprintf('10=%03d%s', $sum, SOH);
} 
```

印刷

```
8=FIX.4.2 9=42 35=0 49=A 56=B 34=12 52=20100304-07:59:30 10=185 
```

* * *

或者更接近文档中的示例函数

```
<?php
define('SOH', chr(0x01));

$message = '8=FIX.4.2|9=42|35=0|49=A|56=B|34=12|52=20100304-07:59:30|';
$message = str_replace('|', SOH, $message);
echo $message, '10=', GenerateCheckSum($message, strlen($message)), SOH;

function GenerateCheckSum($buf, $bufLen )
{
   for( $idx=0, $cks=0; $idx < $bufLen; $cks += ord($buf[ $idx++ ]) );
   return sprintf( "%03d", $cks % 256);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:42:09.847

您的字符串可能有多个字节字符。试试`mb_strlen`。

# asp.net - 在编辑器初始化之前隐藏 TinyMCE 内容

> ID：13088997
> 
> 赞同：2
> 
> 时间：2012-10-26T14:37:16.177
> 
> 标签：asp.net, tinymce

我在 asp.net 应用程序中使用 TinyMCE，并在服务器上设置 textareas 的内容。问题是，一旦页面加载，我们会在 textareas 中看到原始 HTML 片刻，直到编辑器被初始化。我尝试在 textareas 上设置 display:none，然后在 oninit 例程中的每个文本区域上调用 .next().show() ，这有效，除了编辑器不是他们需要的大小（可能是因为底层初始化编辑器时 textarea 被隐藏了？）

其他人是如何解决这个问题的？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T08:57:40.347

您可以保存 textarea 内容，然后将其设置为空并在编辑器初始化后重置 tinymce 内容：

```
var content = $('textarea_id').html();
$('textarea_id').html('');

tinyMCE.init({
   ...
   setup : function(ed) {
    ed.onInit.add(function(ed, evt) {
           ed.setContent(content);
        });
   },
   ...

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-09T20:01:49.050

我刚刚遇到了这个问题，并决定将我的解决方案保留如下：

```
//Before loading, hide textarea element using visibility='hidden' so that the space the element takes will be maintained
document.querySelector('.editor').style.visibility = 'hidden';

tinyMCE.init({
    editor_selector: "editor",
    setup: function (ed) {
        ed.onInit.add(function (ed, evt) {
            //show the element again now that the editor is loaded.
            document.querySelector('.editor').style.visibility = 'visible';
        });
    }
}); 
```

# python - 自制，python安装

> ID：13088998
> 
> 赞同：30
> 
> 时间：2012-10-26T14:37:16.247
> 
> 标签：python, macos, osx-snow-leopard, homebrew

尝试通过自制软件安装 python 时出现错误。brew 说它无法链接 python ，这里是输出：

```
Linking /usr/local/Cellar/python/2.7.3... Warning: Could not link python. Unlinking...
Error: Could not symlink file: /usr/local/Cellar/python/2.7.3/bin/smtpd2.py
/usr/local/bin/smtpd2.py may already exist.
/usr/local/bin may not be writable. 
```

ls -la on /usr/bin 和 bin 权限：

```
The drwxrwxrwx  26 root             admin  884 26 Oct 16:03 bin 
```

并且 smtpd2.py 是存在的。我该如何解决？删除 smtpd2.py ？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-10-26T14:47:51.990

听起来像是 /usr/local 的权限问题。

```
### Makes you owner of /usr/local 
$ sudo chown -R `whoami` /usr/local

### Force uninstalls failed python
$ brew uninstall -f python

### Clear the brew cache
$ rm -rf `brew --cache`

### Recreate the brew cache
$ mkdir `brew --cache`

### Cleanup - cleans up old homebrew files
$ brew cleanup

### Prune - removes dead symlinks in homebrew
$ brew prune

### Doctor - runs homebrew checks for common error causing issues
$ brew doctor

########
### Google and follow steps to fix what `brew doctor` came back with
########

### Reinstall python
$ brew install python 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-03-04T06:15:19.540

你试过了`brew link --overwrite python`吗？这对我有用，而无需卸载 python - 有关更多详细信息，请参阅[此问题](https://stackoverflow.com/questions/13354207/how-to-symlink-python-in-homebrew)。