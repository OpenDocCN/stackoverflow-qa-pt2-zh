# StackOverflow 问答 16042000-16042999

# android - 应用未收到 android.intent.action.DOWNLOAD_COMPLETE 意图

> ID：16042000
> 
> 赞同：6
> 
> 时间：2013-04-16T16:12:55.840
> 
> 标签：android, download-manager

我正在编写一个简单的应用程序，当通过下载管理器在 android 设备上完成任何下载时会收到通知。我已经为它创建了一个广播接收器，并在我的清单文件中设置了如下意图过滤器。但是，当下载完成时，我的广播接收器不会被调用。我是否还需要设置其他一些权限，以便我的应用接收下载管理器发送的 DOWNLOAD_COMPLETE 意图？请注意：我的应用需要收听通过下载管理器完成的任何下载

```
<receiver
    android:name="com.example.filedownload.Downloadlistener" >
       <intent-filter>
        <action android:name="android.intent.action.DOWNLOAD_COMPLETE" />
        <action android:name="android.intent.action.DOWNLOAD_NOTIFICATION_CLICKED" />
       </intent-filter>
</receiver> 
```

以下是使用的权限：

```
<uses-permission android:name="android.permission.INTERNET" />
 <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
 <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-09-15T14:08:10.460

我终于通过在清单中添加以下权限来解决此问题：

```
<uses-permission android:name="android.permission.SEND_DOWNLOAD_COMPLETED_INTENTS" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:15:42.333

你的 BroadcastReceiver 真的被调用了`com.example.filedownload.Downloadlistener`吗？您可能需要更改它以匹配实际名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-03T09:35:04.880

晚了，但有机会查看下载管理器的源代码，并且下载完成广播似乎针对启动下载的应用程序，因此您似乎无法捕获其他应用程序的下载...

# hornetq - 使用 InVMConnectorFactory 为 HornetQ 获取 ClientSessionFactory

> ID：16042001
> 
> 赞同：0
> 
> 时间：2013-04-16T16:13:02.347
> 
> 标签：hornetq

我正在尝试运行 HornetQ 2.14 最终用户手册中提供的示例之一。下面是我在 Servlet 中执行的 java 代码（客户端和服务器都在同一个 VM 中）......

```
 TransportConfiguration transportConfiguration = new TransportConfiguration(InVMConnectorFactory.class.getName());

    ServerLocator locator = HornetQClient.createServerLocatorWithoutHA(transportConfiguration);

    ClientSessionFactory factory = locator.createSessionFactory(); //Causing error 
```

【用于创建ClientSessionFactory的Java代码】

以下是**standalone-full.xml**中的配置...

```
<acceptors>
   <netty-acceptor name="netty" socket-binding="messaging"/>

   <netty-acceptor name="netty-throughput" socket-binding="messaging-throughput">
    <param key="batch-delay" value="50"/>
    <param key="direct-deliver" value="false"/>
    </netty-acceptor>

   <in-vm-acceptor name="in-vm" server-id="0"/>
</acceptors> 
```

[独立-full.xml]

**不幸的是 locator.createSessionFactory() 抛出以下异常**-

WARN [org.hornetq.jms.server.recovery.HornetQXAResourceWrapper]（定期恢复）在恢复时无法连接到任何 hornetq 服务器 [XARecoveryConfig [hornetQConnectionFactory=HornetQConnectionFactory [serverLocator=ServerLocatorImpl [initialConnectors=[org-hornetq-core-remoting- impl-invm-InVMConnectorFactory?server-id=0]，discoveryGroupConfiguration=null]，clientID=null，dupsOKBatchSize=1048576，transactionBatchSize=1048576，readOnly=false]，username=null，password=null]]

**错误 [stderr] (http--127.0.0.1-8080-1) HornetQException[errorCode=2 message=无法连接到服务器。尝试了所有可用的服务器。]**

org.hornetq.core.client.impl.ServerLocatorImpl.createSessionFactory(ServerLocatorImpl.java:774) 处的错误 [stderr] (http--127.0.0.1-8080-1)

错误 [stderr] (http--127.0.0.1-8080-1) 在 test.jms.JMSReceiver.receive1(JMSReceiver.java:150)

错误 [stderr] (http--127.0.0.1-8080-1) 在 test.jms.JMSReceiver.doGet(JMSReceiver.java:48)

javax.servlet.http.HttpServlet.service(HttpServlet.java:734) 处的错误 [stderr] (http--127.0.0.1-8080-1)

javax.servlet.http.HttpServlet.service(HttpServlet.java:847) 处的错误 [stderr] (http--127.0.0.1-8080-1) .... 继续

不确定这有多相关，但在调试源代码时我发现

```
 public class InVMConnector implements Connector
  {
       public static final Logger log = Logger.getLogger(InVMConnector.class);

   public InVMConnector(final Map<String, Object> configuration,
                    final BufferHandler handler,
                    final ConnectionLifeCycleListener listener,
                    final Executor closeExecutor,
                    final Executor threadPool)
      {
         this.listener = listener;

        id =    ConfigurationHelper.getIntProperty(TransportConstants.SERVER_ID_PROP_NAME, 0, configuration);
  //Value of id = 0 in my case
        this.handler = handler;

        this.closeExecutor = closeExecutor;

         executorFactory = new OrderedExecutorFactory(threadPool);

         InVMRegistry registry = InVMRegistry.instance;

         acceptor = registry.getAcceptor(id);
     //acceptor is null here for me
       }

    } 
```

[复制自 Hornetq 的源代码 - 2.14 Final]

由于 acceptor = registry.getAcceptor(id) 对我来说是 null 它根本没有尝试创建与服务器的连接。

如果我缺少接受者的任何配置，请告诉我吗？

提前感谢您的所有帮助。

关于，-ak

# facebook - “无法访问受保护的属性 FacebookApiException ...”

> ID：16042002
> 
> 赞同：4
> 
> 时间：2013-04-16T16:13:04.087
> 
> 标签：facebook, facebook-graph-api

我每天在用户墙上发布的应用程序的 cron 今天崩溃了，我收到消息错误：

> “PHP 致命错误：无法访问受保护的属性 FacebookApiException::$message in...”

这发生在我收到来自 facebook 的开发者警报几分钟后

> 您的应用似乎同时请求读取和写入权限。相反，最初请求少量权限，并在用户决定共享时请求写入权限。您可以在 App Dashboard中查看此通知和其他与您的应用相关的开发者通知*** 。**

.

我解决不了那个问题。facebook 开发人员中的警报为空，并注明已解决。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T02:21:40.453

一位 Facebook 工程师在这里回答了这个问题。 [https://www.facebook.com/groups/fbdevelopers/permalink/534303256613193/](https://www.facebook.com/groups/fbdevelopers/permalink/534303256613193/)

Emil Hesslow 说：“警报错误地发出了，我们正在努力清理它。你可以忽略它。”

“但现在你可以忽略警报。如果我们更改它，那么它将是一个重大更改，就像其他重大更改一样。”

![在此处输入图像描述](https://i.stack.imgur.com/vwGoY.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T09:40:42.613

这两件事彼此没有任何关系。[在访问对象的私有或受保护字段](http://www.php.net/manual/en/language.oop5.visibility.php)时，这是面向对象编程中`Cannot access protected property`的[常见错误](https://stackoverflow.com/questions/6307107/php-cannot-acess-protected-property-error)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-18T21:42:24.087

我在[http://harganews.com/上进行 facebook 整合工作](http://harganews.com/)

而且我发现这种错误我也在谷歌上搜索“facebookApiException 为什么受保护”，但没有人有正确的答案。

基本上 facebook 保护了这个错误代码和所有结果，但你不能直接访问它。

您将能够通过使用 getResult() 函数来访问它，如下例所示：

```
try{
    $status = 1;
    $photo = $this->facebook->api($fanpage_id . '/photos', 'post', $content);
}catch(CurlException $e){
    $status = 0;
    $photo = $e;
}catch(FacebookApiException $e){
    $status = 0;
    $photo = $e->getResult();
} 
```

这就像一个魅力！

# mysql - 如何将此 Simple SQLServer 语句转换为 MySQL 语句？

> ID：16042004
> 
> 赞同：0
> 
> 时间：2013-04-16T16:13:14.723
> 
> 标签：mysql, sql, sql-server

给定一个包含 3 列的表：C1、C2、C3

```
C1 - C2 - C3
M - 是 - M1
N2 - 是 - N3
M2 - 是 - M3
M3 - 是 - M4
N1 - 是 - N2
M1 - 是 - M2
N - 是 - N1

```

如何将此 Simple SQLServer 语句转换为 MySQL 语句：

```
declare @searchString varchar(32) = 'M';
with cte(results) as
(
    select C3 from Tbl where C1 = @searchString
    union all
    select t.C3 from Tbl t inner join cte c on c.C3 = t.C1 
) select * from cte; 
```

# python - 查找函数的所有函数调用

> ID：16042005
> 
> 赞同：0
> 
> 时间：2013-04-16T16:13:16.440
> 
> 标签：python, function, inspect, code-inspection

查找函数进行的所有函数调用的最佳方法是什么？我想在运行时执行此操作（可能使用装饰器）。

是检索源代码的最佳方法`inspect`（这意味着我将不得不访问源代码......所以没有交互式解释器支持）然后用 解析它`ast`？有没有更好的办法？

首选 Python 2.7，但不是必需的。我希望它足够简单，可以自己做。如果其他人已经做到了，我会查看源代码以便弄清楚。

最终，我只会对使用特定装饰器的函数调用感兴趣，但在 SO 上已经有这部分的答案。

编辑：

```
def f():
    return g(1)

@Interesting
def g(x):
    return x + 1

print what_interesting_functions_does_this_call(f) 
```

印刷

```
(<function g at 0x7f2a1ec72a28>,) 
```

我现在意识到，由于 Python 的动态性，这在一般情况下是不可能的。但我可以涵盖一些案例吗？

仅供参考：“你是个白痴，你为什么会认为能够分辨出另一个函数调用了哪些函数，我想不出任何理由为什么这会有用，因此它一定对你没有用”是一个好的回应。我想知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:25:55.780

```
>>> def a():
...    float("1.2")
...    int("1")
...    b()
...
>>> def b():
...    sum([1,2,3])
...
>>> a()
>>> import dis
>>> dis
<module 'dis' from 'C:\Python26\lib\dis.pyc'>
>>> dis.dis(a)
  2           0 LOAD_GLOBAL              0 (float)
              3 LOAD_CONST               1 ('1.2')
              6 CALL_FUNCTION            1
              9 POP_TOP

  3          10 LOAD_GLOBAL              1 (int)
             13 LOAD_CONST               2 ('1')
             16 CALL_FUNCTION            1
             19 POP_TOP

  4          20 LOAD_GLOBAL              2 (b)
             23 CALL_FUNCTION            0
             26 POP_TOP
             27 LOAD_CONST               0 (None)
             30 RETURN_VALUE
>>> 
```

你可以只计算“CALL_FUNCTION”......

一般来说，我不认为你想在生产代码中做这样的事情......

# php - 如果变量 = 值，则勾选复选框

> ID：16042006
> 
> 赞同：0
> 
> 时间：2013-04-16T16:13:18.160
> 
> 标签：php, html, checkbox

```
 <li>
        Assign Task to Every User? &nbsp; &nbsp; 
        <input type="checkbox" name="display_insert_email" onchange="this.form['email'].hidden=this.checked" />
    </li>
    <li>
        <input type="text" name="email" style="width: 400px;" value="<?php if ($task_member_id > 0){ echo $task_member_email; } else 'Please enter email address of user'?>" onclick="if(this.value=='Please enter email address of user'){this.value=''}" onblur="if(this.value==''){this.value='Please enter email address of user'}" >
    </li> 
```

这是两个有问题的区域，如果`$project_member_id = 0`我希望复选框的值被选中..

我已经搜索和搜索，但我找不到与我相关的任何内容，我可能正在搜索错误的内容，但任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:14:35.777

```
<input type="checkbox" <?php if($var == '0'){ ?> checked <?php } ?>/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:15:32.937

只要`echo checked`条件为真

```
<input type="checkbox" value="1" <?php if($val == '1') {echo 'checked';} ?> /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T16:19:40.483

`<input type="checkbox" <?php if($variable == 1){ echo "checked"; } ?> >`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T17:55:45.377

`<input type="checkbox" value="1" <?php if($project_member_id == 0) echo 'checked="checked"'; ?> >`

# jquery - 根据 HREF 值切换父元素的类 jQuery

> ID：16042008
> 
> 赞同：3
> 
> 时间：2013-04-16T16:13:24.473
> 
> 标签：jquery, class, html-lists, toggle, href

正如您可能会说的，我今天正在学习 jQuery（以及其他网络内容）。

当我拥有的变量与 LI 中的 A 上的 HREF 的内容匹配时，我试图巧妙地将 LI 的类更改为活动。

它的结构如下：

```
<li><a href="foo.html">Foo</a></li> 
```

当我的“page”变量等于“foo.html”时，我想将 li 的类更改为活动。如下：

```
<li class="active"><a href="foo.html">Foo</a></li> 
```

我知道有一种适度简单的方法，但我这样做的方式似乎完全错误！

顺便说一句，值得记住（因为这是我摔倒的地方）这是一个菜单，并且有许多 LI，例如：

```
<li class="active"><a href="foo.html">Foo</a></li>
<li><a href="bar.html">Bar</a></li> 
```

非常感谢，克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:16:01.913

这应该有效：

```
$('a[href="foo.html"]').closest("li").addClass("active"); 
```

要使用您的页面变量：

```
$('a[href="' + hrefVariable + '"]').closest("li").addClass("active"); 
```

**编辑：**

解释这是如何工作的：

*   第一部分 $('a[href="foo.html"]') 将定位页面上所有链接的 href 值为 foo.html。
*   第二个对象 .closest("li") 将定位距第一部分中找到的元素最近的 li。
*   第三个对象将类添加到前面的元素，在本例中为 li。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:18:00.430

**第 1 步：获取正确的链接元素**

首先，您需要找到正确的`a`标签元素，您可以使用以下[属性选择器](http://api.jquery.com/attribute-equals-selector/)来做到这一点：

```
var href = "foo.html";
var a = $("[href='" + href + "']"); 
```

* * *

**步骤 2：获取父列表项元素**

[`parent()`](http://api.jquery.com/parent/)然后您可以使用以下函数找到直接父级：

```
var li = a.parent(); 
```

如果它不是直接父级，则可以使用该[`closest()`](http://api.jquery.com/closest/)函数来查找与提供的选择器匹配的第一个祖先。例如：

```
var li = a.closest("li"); 
```

* * *

**第 3 步：更改班级**

最后，您可以使用以下函数将类添加到任何给定元素[`addClass()`](http://api.jquery.com/addClass/)：

```
li.addClass("active"); 
```

如果您需要在任何时候删除该类，或删除现有类，您可以使用该[`removeClass()`](http://api.jquery.com/removeClass/)函数：

```
li.removeClass("active"); 
```

注意：如果您想“重置”所有活动列表元素，您可以轻松执行以下操作：

```
$("li.active").removeClass("active"); 
```

* * *

**最终结果**

[这是一个实际的工作示例](http://jsfiddle.net/9fKqH/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:29:42.627

Although you didn't specify it in your question, I assume you'll want to remove the active class from other LIs?

```
var li = $('.menuClass li'), // menuClass is whatever the class of your menu is (or #menuId for id)
    page = 'foo.html';

li.each(function () {
    var t = $(this); // better performance
    t.removeClass('active'); // remove active class from all
    if (t.find('a').attr('href') === page) { // if the href equals the value of your page variable, add active class
        t.addClass('active');
    }
}); 
```

# crontab - 使用 cron 从 shell_exec 运行 phantomjs

> ID：16042014
> 
> 赞同：0
> 
> 时间：2013-04-16T16:13:45.100
> 
> 标签：crontab, phantomjs, shell-exec

这真是令人沮丧。当被 crontab 调用时，像这样的简单事情将不起作用：

```
 $responseFull = shell_exec("phantomjs --version"); 
```

我必须说 phantomjs 在终端上运行良好，对于普通用户、*bokac*和 apache 用户*www-data*都适用。我得到的只是*null*。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T07:12:57.430

首先 - 这是我的命令，它可以在 cron 中完美运行：

```
shell_exec($this->cmd . " > " . $this->statusError . " 2>&1 &"); 
```

如您所见，我不读取输出，而是将其重定向到文件 - 这更适合我的需要，但它也可能是您的选择。

其次 - 尝试用另一个命令替换**phantomjs --version 。**例如：**日期**。在这种情况下你会收到输出吗？如果你不这样做 - 这不是 phantomjs 的问题。

干杯，安德烈

# python - 从模块 Python 导入数据时出错

> ID：16042015
> 
> 赞同：0
> 
> 时间：2013-04-16T16:13:46.350
> 
> 标签：python, python-2.7

我正在编写几个需要一些通用信息的脚本，因此我决定以 python 格式编写该信息并将其作为模块导入。但是，我的脚本现在拒绝识别所有项目。

如果我使用`dir(sumFile)`（其中 sumFile 是我调用模块的方式）查看模块的内容，我会得到以下列表。

```
['Cell', 'Isotope', 'Material', '__builtins__', '__doc__', '__file__', '__name__', '__package__', 'cellList', 'curCell', 'curMat', 'file', 'libStartNum', 'matList', 'orMode', 'power', 'stepList', 'takenTallyList'] 
```

其中Cell、Isotope、Material都是类，cellList到最后是变量

现在，那里应该有一个名为“索引”的项目，但不是。这是该模块的片段：

```
# 4\. ASSORTED FILE INFORMATION 
# Index of 2nd Blank Line: 
index = '47'

# Original File Name: 
file = 'sample.txt' 

# Taken Tally Numbers: 
takenTallyList = [ 
] 

# Origen Type: 
orMode = 'thermal' 

# XS Lib Start Num: 
libStartNum =  '219' 
```

所以我们可以看到它读取file、takeTallyList、orMode和libStartNum，很好，但是拒绝读取index。

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:18:17.897

模块中可以访问哪些对象在其`__init__.py`. 如果`index`在模块内的包中声明并且未显式公开，则将无法访问。

# php - 输入条件（两个数字之间）

> ID：16042020
> 
> 赞同：0
> 
> 时间：2013-04-16T16:14:12.180
> 
> 标签：php

我正在做一个包含应该包含 0 或 1 的输入的页面

如果字段为空，我做了停止的条件......我需要一种方法来制作第二个条件，即添加的变量仅为“1”或“0”。

```
if(empty($moviedisplay)){
    echo  "Movie display is a must";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:18:45.550

```
if(empty($moviedisplay) || ($moviedisplay != 0 && $moviedisplay != 1)) {
    echo  "Movie display is a must";
} 
```

如果您喜欢不同的消息：

```
if(empty($moviedisplay)) {
    echo  "Movie display is a must";
}
elseif($moviedisplay != 0 && $moviedisplay != 1) {
    echo  "Movie display must be 0 or 1";
} 
```

除此之外，请阅读 PHP 文档 - 这是一个*非常*基本的问题，您不应该在这里或任何其他网站上问。

# winapi - CreateTexture2D 和 CreateDepthStencilView 失败

> ID：16042023
> 
> 赞同：1
> 
> 时间：2013-04-16T16:14:24.967
> 
> 标签：winapi, directx-11

我正在尝试学习 Directx 11.0。我遇到了一个错误。这是代码。

```
// include the basic windows header files and the Direct3D header files
#include <windows.h>
#include <windowsx.h>
#include <d3d11.h>
#include <d3dx11.h>
#include <d3dx10.h>

// include the Direct3D Library file
#pragma comment (lib, "d3d11.lib")
#pragma comment (lib, "d3dx11.lib")
#pragma comment (lib, "d3dx10.lib")

// define the screen resolution
#define SCREEN_WIDTH  800
#define SCREEN_HEIGHT 600

// global declarations
IDXGISwapChain *swapchain = NULL;             // the pointer to the swap chain interface
ID3D11Device *dev = NULL;                     // the pointer to our Direct3D device interface
ID3D11DeviceContext *devcon = NULL;           // the pointer to our Direct3D device context
ID3D11RenderTargetView *backbuffer = NULL;    // the pointer to our back buffer
ID3D11InputLayout *pLayout = NULL;            // the pointer to the input layout
ID3D11VertexShader *pVS = NULL;               // the pointer to the vertex shader
ID3D11PixelShader *pPS = NULL;                // the pointer to the pixel shader
ID3D11Buffer *pVBuffer = NULL;                // the pointer to the vertex buffer
ID3D11Buffer *pIBuffer = NULL;                // the pointer to the index buffer
ID3D11DepthStencilView *pDView = NULL;        // the pointer to depth stencil view
ID3D11Texture2D *pDStencil = NULL;            // the pointer to depth stencil

// a struct to define a single vertex
struct VERTEX{FLOAT X, Y, Z; D3DXCOLOR Color;};

// function prototypes
void InitD3D(HWND hWnd);    // sets up and initializes Direct3D
void RenderFrame(void);     // renders a single frame
void CleanD3D(void);        // closes Direct3D and releases memory
void InitGraphics(void);    // creates the shape to render
void InitPipeline(void);    // loads and prepares the shaders

// the WindowProc function prototype
LRESULT CALLBACK WindowProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam);

// the entry point for any Windows program
int WINAPI WinMain(HINSTANCE hInstance,
                   HINSTANCE hPrevInstance,
                   LPSTR lpCmdLine,
                   int nCmdShow)
{
    HWND hWnd;
    WNDCLASSEX wc;

    ZeroMemory(&wc, sizeof(WNDCLASSEX));

    wc.cbSize = sizeof(WNDCLASSEX);
    wc.style = CS_HREDRAW | CS_VREDRAW;
    wc.lpfnWndProc = WindowProc;
    wc.hInstance = hInstance;
    wc.hCursor = LoadCursor(NULL, IDC_ARROW);
    wc.lpszClassName = "WindowClass";

    RegisterClassEx(&wc);

    RECT wr = {0, 0, SCREEN_WIDTH, SCREEN_HEIGHT};
    AdjustWindowRect(&wr, WS_OVERLAPPEDWINDOW, FALSE);

    hWnd = CreateWindowEx(NULL,
                          "WindowClass",
                          "Our First Direct3D Program",
                          WS_OVERLAPPEDWINDOW,
                          CW_USEDEFAULT,
                          CW_USEDEFAULT,
                          wr.right - wr.left,
                          wr.bottom - wr.top,
                          NULL,
                          NULL,
                          hInstance,
                          NULL);

    ShowWindow(hWnd, nCmdShow);

    // set up and initialize Direct3D
    InitD3D(hWnd);

    // enter the main loop:

    MSG msg;

    while(TRUE)
    {
        if(PeekMessage(&msg, NULL, 0, 0, PM_REMOVE))
        {
            TranslateMessage(&msg);
            DispatchMessage(&msg);

            if(msg.message == WM_QUIT)
                break;
        }

        RenderFrame();
    }

    // clean up DirectX and COM
    CleanD3D();

    return msg.wParam;
}

// this is the main message handler for the program
LRESULT CALLBACK WindowProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch(message)
    {
        case WM_DESTROY:
            {
                PostQuitMessage(0);
                return 0;
            } break;
    }

    return DefWindowProc (hWnd, message, wParam, lParam);
}

// this function initializes and prepares Direct3D for use
void InitD3D(HWND hWnd)
{
    // create a struct to hold information about the swap chain
    DXGI_SWAP_CHAIN_DESC scd;

    // clear out the struct for use
    ZeroMemory(&scd, sizeof(DXGI_SWAP_CHAIN_DESC));

    // fill the swap chain description struct
    scd.BufferCount = 1;                                   // one back buffer
    scd.BufferDesc.Format = DXGI_FORMAT_R8G8B8A8_UNORM;    // use 32-bit color
    scd.BufferDesc.Width = SCREEN_WIDTH;                   // set the back buffer width
    scd.BufferDesc.Height = SCREEN_HEIGHT;                 // set the back buffer height
    scd.BufferUsage = DXGI_USAGE_RENDER_TARGET_OUTPUT;     // how swap chain is to be used
    scd.OutputWindow = hWnd;                               // the window to be used
    scd.SampleDesc.Count = 4;                              // how many multisamples
    scd.Windowed = TRUE;                                   // windowed/full-screen mode
    scd.Flags = DXGI_SWAP_CHAIN_FLAG_ALLOW_MODE_SWITCH;    // allow full-screen switching

    // create a device, device context and swap chain using the information in the scd struct
    D3D11CreateDeviceAndSwapChain(NULL,
                                  D3D_DRIVER_TYPE_HARDWARE,
                                  NULL,
                                  D3D11_CREATE_DEVICE_DEBUG,
                                  NULL,
                                  NULL,
                                  D3D11_SDK_VERSION,
                                  &scd,
                                  &swapchain,
                                  &dev,
                                  NULL,
                                  &devcon);

    // get the address of the back buffer
    ID3D11Texture2D *pBackBuffer;
    swapchain->GetBuffer(0, __uuidof(ID3D11Texture2D), (LPVOID*)&pBackBuffer);

    // use the back buffer address to create the render target
    dev->CreateRenderTargetView(pBackBuffer, NULL, &backbuffer);
    pBackBuffer->Release();

    //Create depth stencil buffer
    D3D11_TEXTURE2D_DESC descDepth;
    descDepth.Width = SCREEN_WIDTH;
    descDepth.Height = SCREEN_HEIGHT;
    descDepth.MipLevels = 1;
    descDepth.ArraySize = 1;
    descDepth.Format = DXGI_FORMAT_R8G8B8A8_UNORM;
    descDepth.SampleDesc.Count = 4;
    descDepth.SampleDesc.Quality = 0;
    descDepth.Usage = D3D11_USAGE_DYNAMIC;
    descDepth.BindFlags = D3D11_BIND_DEPTH_STENCIL;
    descDepth.CPUAccessFlags = 0;
    descDepth.MiscFlags = 0;

    dev->CreateTexture2D( &descDepth, NULL, &pDStencil );

    // Create the depth stencil view
    D3D11_DEPTH_STENCIL_VIEW_DESC descDSV;
    descDSV.Format = descDepth.Format;
    descDSV.ViewDimension = D3D11_DSV_DIMENSION_TEXTURE2DMS;
    descDSV.Texture2DMS.UnusedField_NothingToDefine = 0;

    dev->CreateDepthStencilView( pDStencil, &descDSV, &pDView );

    // set the render target as the back buffer
    devcon->OMSetRenderTargets(1, &backbuffer, pDView);

    // Set the viewport
    D3D11_VIEWPORT viewport;
    ZeroMemory(&viewport, sizeof(D3D11_VIEWPORT));

    viewport.TopLeftX = 0;
    viewport.TopLeftY = 0;
    viewport.Width = SCREEN_WIDTH;
    viewport.Height = SCREEN_HEIGHT;
    viewport.MinDepth = 0.0f;
    viewport.MaxDepth = 1.0f;

    devcon->RSSetViewports(1, &viewport);

    InitPipeline();
    InitGraphics();
}

// this is the function used to render a single frame
void RenderFrame(void)
{
    // clear the back buffer to a deep blue
    devcon->ClearRenderTargetView(backbuffer, D3DXCOLOR(1.0f, 1.0f, 1.0f, 1.0f));

    //clear the depth stencil view
    devcon->ClearDepthStencilView(pDView, D3D11_CLEAR_DEPTH|D3D11_CLEAR_STENCIL, 1.0f, 0);

        // select which vertex buffer to display
        UINT stride = sizeof(VERTEX);
        UINT offset = 0;
        devcon->IASetVertexBuffers(0, 1, &pVBuffer, &stride, &offset);

        //set index buffer
        devcon->IASetIndexBuffer(pIBuffer, DXGI_FORMAT_R32_UINT, 0);

        // select which primtive type we are using
        devcon->IASetPrimitiveTopology(D3D10_PRIMITIVE_TOPOLOGY_TRIANGLELIST);

        // draw the vertex buffer to the back buffer
        devcon->DrawIndexed(9, 0, 0);

    // switch the back buffer and the front buffer
    swapchain->Present(0, 0);
}

// this is the function that cleans up Direct3D and COM
void CleanD3D(void)
{
    swapchain->SetFullscreenState(FALSE, NULL);    // switch to windowed mode

    // close and release all existing COM objects
    if(pLayout)pLayout->Release();
    if(pVS)pVS->Release();
    if(pPS)pPS->Release();
    if(pVBuffer)pVBuffer->Release();
    if(pIBuffer)pIBuffer->Release();
    if(swapchain)swapchain->Release();
    if(backbuffer)backbuffer->Release();
    if(dev)dev->Release();
    if(devcon)devcon->Release();
    if(pDStencil)pDStencil->Release();
    if(pDView)pDView->Release();
}

// this is the function that creates the shape to render
void InitGraphics()
{
    // create a triangle using the VERTEX struct
    VERTEX Vertices[] =
    {
        {-0.5f, 0.5f, 1.0f, D3DXCOLOR(1.0f, 0.0f, 0.0f, 1.0f)},
        {0.5f, 0.5f, 1.0f, D3DXCOLOR(1.0f, 0.0f, 0.0f, 1.0f)},
        {0.5f, -0.5f, 1.0f, D3DXCOLOR(1.0f, 0.0f, 0.0f, 1.0f)},
        {-0.5f, -0.5f, 1.0f, D3DXCOLOR(1.0f, 0.0f, 0.0f, 1.0f)},
        {0.75f, 0.75f, 0.0f, D3DXCOLOR(0.0f, 1.0f, 0.0f, 1.0f)},
        {0.75f, -0.5f, 0.0f, D3DXCOLOR(0.0f, 1.0f, 0.0f, 1.0f)},
        {0.0f, -0.5f, 0.0f, D3DXCOLOR(0.0f, 1.0f, 0.0f, 1.0f)},
    };

    DWORD Indices[]=
    {
        0,2,3,
        4,5,6,
    };

    // create the vertex buffer
    D3D11_BUFFER_DESC bd,id;
    ZeroMemory(&bd, sizeof(bd));
    ZeroMemory(&id, sizeof(id));

    bd.Usage = D3D11_USAGE_DYNAMIC;                // write access access by CPU and GPU
    bd.ByteWidth = sizeof(VERTEX) * 7;             // size is the VERTEX struct * 4
    bd.BindFlags = D3D11_BIND_VERTEX_BUFFER;       // use as a vertex buffer
    bd.CPUAccessFlags = D3D11_CPU_ACCESS_WRITE;    // allow CPU to write in buffer

    id.Usage = D3D11_USAGE_DYNAMIC;                // write access access by CPU and GPU
    id.ByteWidth = sizeof(DWORD) * 3*3;             // size is the DWORD struct * 2 * 3
    id.BindFlags = D3D11_BIND_INDEX_BUFFER;       // use as a index buffer
    id.CPUAccessFlags = D3D11_CPU_ACCESS_WRITE;    // allow CPU to write in buffer

    dev->CreateBuffer(&bd, NULL, &pVBuffer);       // create the buffer
    dev->CreateBuffer(&id, NULL, &pIBuffer);

    // copy the vertices into the buffer
    D3D11_MAPPED_SUBRESOURCE ms;
    devcon->Map(pVBuffer, NULL, D3D11_MAP_WRITE_DISCARD, NULL, &ms);    // map the buffer
    memcpy(ms.pData, Vertices, sizeof(Vertices));                       // copy the data
    devcon->Unmap(pVBuffer, NULL);                                      // unmap the buffer

     // copy the indices into the buffer
    D3D11_MAPPED_SUBRESOURCE ims;
    devcon->Map(pIBuffer, NULL, D3D11_MAP_WRITE_DISCARD, NULL, &ims);    // map the buffer
    memcpy(ims.pData, Indices, sizeof(Indices));                       // copy the data
    devcon->Unmap(pIBuffer, NULL);                                      // unmap the buffer
}

// this function loads and prepares the shaders
void InitPipeline()
{
    // load and compile the two shaders
    ID3D10Blob *VS, *PS;
    D3DX11CompileFromFile("shaders.hlsl", 0, 0, "VShader", "vs_5_0", 0, 0, 0, &VS, 0, 0);
    D3DX11CompileFromFile("shaders.hlsl", 0, 0, "PShader", "ps_5_0", 0, 0, 0, &PS, 0, 0);

    // encapsulate both shaders into shader objects
    dev->CreateVertexShader(VS->GetBufferPointer(), VS->GetBufferSize(), NULL, &pVS);
    dev->CreatePixelShader(PS->GetBufferPointer(), PS->GetBufferSize(), NULL, &pPS);

    // set the shader objects
    devcon->VSSetShader(pVS, 0, 0);
    devcon->PSSetShader(pPS, 0, 0);

    // create the input layout object
    D3D11_INPUT_ELEMENT_DESC ied[] =
    {
        {"POSITION", 0, DXGI_FORMAT_R32G32B32_FLOAT, 0, 0, D3D11_INPUT_PER_VERTEX_DATA, 0},
        {"COLOR", 0, DXGI_FORMAT_R32G32B32A32_FLOAT, 0, 12, D3D11_INPUT_PER_VERTEX_DATA, 0},
    };

    dev->CreateInputLayout(ied, 2, VS->GetBufferPointer(), VS->GetBufferSize(), &pLayout);
    devcon->IASetInputLayout(pLayout);
} 
```

调试告诉我程序在函数 CreateDepthStencilView 上失败，原因是“第一个参数已损坏或为空。”。

事实上，CreateTexture2D 让我的 Texture2D COM 对象为空，这是所有麻烦的原因。

**有人可以帮我解决为什么会这样吗？**

请参阅 InitD3D()。有上面提到的两个功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T14:00:03.587

如果您针对调试 DirectX 库编译应用程序，您将在 Texture2D 创建失败时收到更详细的错误消息。可能其中一个参数无效。

[将 DirectX 10/11 调试输出捕获到 Visual Studio](http://blog.rthand.com/post/2010/10/25/Capture-DirectX-1011-debug-output-to-Visual-Studio.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:21:19.923

我知道了！在 Depth Stencil View 的描述下，必须设置 Flags 字段。

```
descDSV.Flags = 0;            //0 for it 'not' being read only 
```

谢谢你们的时间，伙计们！

# image - 如何清除 Wordpress 3.5 上传的默认附件标题？

> ID：16042024
> 
> 赞同：1
> 
> 时间：2013-04-16T16:14:25.953
> 
> 标签：image, wordpress, attachment, uploader, wordpress-3.5

上传新图片时，我想从图片标题中清除默认的“文件名”。我尝试使用下面的代码没有运气。

```
 add_action( 'add_attachment', 'my_upload_title', 99 );
        function my_upload_title( $attachment_ID ) {
        $the_post = array();
        $the_post['ID'] = $attachment_ID;
        $the_post['post_title'] = '';
        wp_update_post( $the_post );    
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:08:45.877

首先检查[这个答案](https://wordpress.stackexchange.com/questions/6135/remove-title-attribute-from-images)，或者您也可以尝试以下代码片段（将代码粘贴到您的`functions.php`文件中）

```
add_filter( 'wp_get_attachment_image_attributes', 'remove_image_text');
function remove_image_text( $attr ) {
    unset($attr['alt']);
    unset($attr['title']);
    return $attr;
} 
```

# php - php邮件脚本不适用于cron

> ID：16042028
> 
> 赞同：1
> 
> 时间：2013-04-16T16:14:35.540
> 
> 标签：php, email, cron, ssmtp

我无法（正确）运行 cron 作业。

我创建了一个调用 mail() 的（非常大，但精简为空）php 页面

```
<?
    mail('my@email.com', 'subject', 'test');
    mail('other@address.com', 'subject', 'test');
?> 
```

然后我创建了运行该文件的 cron 作业。crontab -e 中的代码行如下：

```
12 0 * * * /opt/lampp/bin/php /opt/lampp/htdocs/atlantis/application/controllers/cron.php 
```

如果我从终端运行命令 /opt/lampp/bin/php /opt/lampp/htdocs/atlantis/application/controllers/cron.php，我会收到一封发送给自己的电子邮件。但是，如果我从 cron 作业运行同一行，它就不起作用。

我的下一站是检查日志。我正在使用 sSMTP 运行 Ubuntu。

```
Apr 16 11:49:17 drew-Virtual crontab[4722]: (drew) END EDIT (drew) //EDITED CRON

//Calling cron.php file from terminal
Apr 16 11:49:31 drew-Virtual sSMTP[4791]: Creating SSL connection to host
Apr 16 11:49:32 drew-Virtual sSMTP[4791]: SSL connection using RSA_AES_128_CBC_SHA1
Apr 16 11:49:34 drew-Virtual sSMTP[4791]: Sent mail for drew@drew-Virtual (221 ip-173-201-180-143.ip.secureserver.net closing connection) uid=1000 username=drew outbytes=444
Apr 16 11:49:34 drew-Virtual sSMTP[4794]: Creating SSL connection to host
Apr 16 11:49:35 drew-Virtual sSMTP[4794]: SSL connection using RSA_AES_128_CBC_SHA1
Apr 16 11:49:37 drew-Virtual sSMTP[4794]: Sent mail for drew@drew-Virtual (221 ip-173-201-180-143.ip.secureserver.net closing connection) uid=1000 username=drew outbytes=454
//I successfully received 2 emails, one to my work account, one to my personal account

//Calling cron.php from cron
Apr 16 11:50:01 drew-Virtual cron[857]: (drew) RELOAD (crontabs/drew)
Apr 16 11:51:01 drew-Virtual CRON[4808]: (drew) CMD (/opt/lampp/bin/php /opt/lampp/htdocs/atlantis/application/controllers/chron.php)
Apr 16 11:51:01 drew-Virtual sSMTP[4810]: Creating SSL connection to host
Apr 16 11:51:02 drew-Virtual sSMTP[4810]: SSL connection using RSA_AES_128_CBC_SHA1
Apr 16 11:51:04 drew-Virtual sSMTP[4810]: Sent mail for drew@drew-Virtual (221 ip-173-201-180-143.ip.secureserver.net closing connection) uid=1000 username=drew outbytes=698
//I did not receive any emails 
```

你可以看到它只尝试发送 1 封电子邮件，我认为它失败了，因为我从未收到它。但是，它并没有告诉我为什么失败，我也没有任何其他线索。我还注意到 cron 作业中的 outbytes 比命令行中的要大。

最后，php 文件对每个人都有完整的 rwx 权限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T03:35:00.350

The issue was that PHP was running as an apache module, rather than PHP-CGI. I suppose as a work-around I could have used something like

```
lynx -dump http://www.somedomain.com/cron.php 
```

For my use, I ended up installing php5-cli and then simply changing the cron job to

```
php /path/to/file.php 
```

fixed it.

# redis - 有没有办法使用通配符在 Redis 中获取 ZSet 成员？

> ID：16042037
> 
> 赞同：0
> 
> 时间：2013-04-16T16:15:13.600
> 
> 标签：redis

ZSet 成员的一些东西就像`KEYS`公共键的命令一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:22:19.680

使用基本命令是不可能的，也许您可​​以使用 lua 脚本解决问题。我个人更喜欢通过添加索引（将键/成员存储在单独的键中）在应用程序级别解决此类问题。

顺便说一句，您不应该将 KEYS 命令用于非开发环境（或者除非您的密钥数量非常有限）

# ruby-on-rails - Rails 3.2 - 未定义的方法 `where' 用于# 我正在尝试将给定字段与模型Header中的其他字段进行比较。Alarm正如您在代码中看到的，我通过 3 个不同的步骤过滤警报。前 2 个工作完美。但是，最后一个不起作用。它说： undefined method `wh 问问题 问问题 2013-04-16T16:15:21.333 8819 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在尝试将给定字段与模型Header中的其他字段进行比较。Alarm正如您在代码中看到的，我通过 3 个不同的步骤过滤警报。前 2 个工作完美。但是，最后一个不起作用。它说： undefined method `where' for #<Array:... 据我了解.where是一种适用于数组的类方法。为什么在这里不起作用？我也尝试过.find_all_by不同的东西......但无济于事。 @header = Header.find(1) # Extracts those alarms that are ACTIVE and have something in common with the tittles @alarmsT = Alarm.activated.where("keyword in (?)", [@header.title_es, @header.title_en, @header.title_en]) # Extracts alarms when Header has at least the same categories as an alarm @alarmsT = @alarmsT.select do |alarm| @header.category_ids.all?{|c| alarm.category_ids.include? c } end // this is the one that does NOT work # Extract alarms which share the same location as Header.events' town @alarmsF = [] @header.events.each do |e| @alarmsF = @alarmsF + @alarmsT.where("alarms.location LIKE ?", e.town) end 任何帮助发现我所缺少的东西都非常感谢。谢谢 在查询中将 getdate() - 7 小时设置为零 我有一个查询，其中我使用日期作为条件 ( paiddate)。 我想要从前 7 天到今天的记录。所以，我的陈述看起来像这样 PaidDate >= GETDATE() - 7 我以为我会像这样回到开始日的 0 小时 PaidDate > DATEADD(d,DATEDIFF(d,7,getdate()),0) 但是，我收到一条错误消息： varchar 值 '2224560081' 的转换溢出了一个 int 列。 知道为什么会发生这种情况以及如何解决吗？ ruby-on-railsruby-on-rails-3sqlitepostgresql 4 2 回答 2 This answer is useful 7 In your first line, you're successfully returning an ActiveRecordRelation object in @alarmsT # Extracts those alarms that are ACTIVE and have something in common with the tittles @alarmsT = Alarm.activated.where("keyword in (?)", [@header.title_es, @header.title_en, @header.title_en]) At this point you could apply additional .where(...) methods, conditions or scopes on @alarmsT to further build up the ARel expression and the results returned. However, you then run a filter over this relation, converting @alarmsT to an instance of Array # Extracts alarms when Header has at least the same categories as an alarm @alarmsT = @alarmsT.select do |alarm| @header.category_ids.all?{|c| alarm.category_ids.include? c } end You can no longer build up the ARel expression, since Array doesn't know about your ARel's .where(...) method, or any of your Alarm model's scopes or attributes. This is why in the code below you're getting the undefined method 'where' for #<Array:... error -- you're calling .where() on an instance of Array; a method that does not exist. @alarmsF = [] @header.events.each do |e| @alarmsF = @alarmsF + @alarmsT.where("alarms.location LIKE ?", e.town) end You can fix this by not doing the select to filter by category ids and instead using a join. Building such a join (to verify existence of at least a subset of values in a related table/column) is documented quite a bit on places easily found through google and here on StackOverflow. 于 2013-04-16T16:31:06.720 回答 This answer is useful 3 就像@Deefour 所说，select您正在收集数据Array而不是ActiveRecord::Relation对象。 你确定你需要LIKE查询吗？通过查看它，我想您可以进行简单的直接比较。如果我的假设是正确的，您可以重新排列代码的最后一部分： @alarmsF = [] towns_from_events = @header.events.collect(&:town) @alarmsT.each do |alarmsT| @alarmsF << alarmsT if towns_from_events.include?(alarmsT.location) end 于 2013-04-16T16:47:12.537 回答 Related 2 python - 低级 os.open、os.fdopen 和朋友的用例？ 7 java - Java中的文件截断操作 1 zend-framework2 - Zend 框架 2 - 普通类 1 lambda - CUDA中如何使用thrust::placeholders初始化设备向量？ 1 java - Junit+Hibernate+Spring+H2 :inserts 执行没有错误但是 select 没有返回数据 5 android - 我怎样才能实现这个布局？ 1 ruby-on-rails - 如何在控制器中为 IF 条件创建一个方法以在 ruby on rails 中调用视图？ 1 jquery - JQuery Post 调用返回服务器 500 错误 9 eclipse - 使用 Salesforce 在 Eclipse 中创建部件控件失败 0 regex - 使用平面文件在目录中的多个文件中搜索特定标签值 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：16042044
> 
> 赞同：0
> 
> 时间：
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sqlite, postgresql

我正在尝试将给定字段与模型`Header`中的其他字段进行比较。`Alarm`正如您在代码中看到的，我通过 3 个不同的步骤过滤警报。前 2 个工作完美。但是，最后一个不起作用。它说：

```
undefined method `where' for #<Array:... 
```

据我了解`.where`是一种适用于数组的类方法。为什么在这里不起作用？我也尝试过`.find_all_by`不同的东西......但无济于事。

```
@header = Header.find(1)

# Extracts those alarms that are ACTIVE and have something in common with the tittles
@alarmsT = Alarm.activated.where("keyword in (?)", [@header.title_es, @header.title_en, @header.title_en])

# Extracts alarms when Header has at least the same categories as an alarm
@alarmsT = @alarmsT.select do |alarm| 
   @header.category_ids.all?{|c| alarm.category_ids.include? c }
end

// this is the one that does NOT work
# Extract alarms which share the same location as Header.events' town
@alarmsF = [] 
@header.events.each do |e|
    @alarmsF =  @alarmsF + @alarmsT.where("alarms.location LIKE ?", e.town)
end 
```

任何帮助发现我所缺少的东西都非常感谢。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T16:31:06.720

In your first line, you're successfully returning an `ActiveRecordRelation` object in `@alarmsT`

```
# Extracts those alarms that are ACTIVE and have something in common with the tittles
@alarmsT = Alarm.activated.where("keyword in (?)", [@header.title_es, @header.title_en, @header.title_en]) 
```

At this point you could apply additional `.where(...)` methods, conditions or scopes on `@alarmsT` to further build up the ARel expression and the results returned.

However, you then run a filter over this relation, converting `@alarmsT` to an instance of `Array`

```
# Extracts alarms when Header has at least the same categories as an alarm
@alarmsT = @alarmsT.select do |alarm| 
   @header.category_ids.all?{|c| alarm.category_ids.include? c }
end 
```

You can no longer build up the ARel expression, since `Array` doesn't know about your ARel's `.where(...)` method, or any of your `Alarm` model's scopes or attributes. This is why in the code below you're getting the `undefined method 'where' for #<Array:...` error -- you're calling `.where()` on an instance of `Array`; a method that does not exist.

```
@alarmsF = [] 
@header.events.each do |e|
  @alarmsF =  @alarmsF + @alarmsT.where("alarms.location LIKE ?", e.town)
end 
```

You can fix this by not doing the select to filter by category ids and instead using a join. Building such a join (to verify existence of at least a subset of values in a related table/column) is documented quite a bit on places easily found through google and here on StackOverflow.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T16:47:12.537

就像@Deefour 所说，`select`您正在收集数据`Array`而不是`ActiveRecord::Relation`对象。

你确定你需要`LIKE`查询吗？通过查看它，我想您可以进行简单的直接比较。如果我的假设是正确的，您可以重新排列代码的最后一部分：

```
@alarmsF = []
towns_from_events = @header.events.collect(&:town)

@alarmsT.each do |alarmsT|
    @alarmsF << alarmsT if towns_from_events.include?(alarmsT.location)
end 
```

# c++ - 使用 Boost + libpng 读取 PNG 图像

> ID：16042046
> 
> 赞同：1
> 
> 时间：2013-04-16T16:15:23.727
> 
> 标签：c++, boost, png, boost-gil

我正在尝试编写一个简单的程序，该程序将使用 Boost 的 GIL Image I/O 库读取灰度 PNG 图像，然后获取每个像素的信息。我已经下载并提取了 libpng 和 zlib，将它们包含在我的 makefile 中，并链接了它们。

尝试执行以下代码时：

```
#include <boost/gil/gil_all.hpp>
#include <boost/gil/extension/io/png_dynamic_io.hpp>
#include <iostream>

int main()
{
    using std::cout;
    using std::endl;
    boost::gil::gray16_image_t image;
    cout << "TEST";
    boost::gil::png_read_and_convert_image("png16_example.png", image);
    cout << "test";
    return 0;
} 
```

“测试”打印语句都不起作用。事实上，什么也没有发生。我注释掉了这一行：

```
boost::gil::png_read_and_convert_image("png16_example.png", image); 
```

它再次运行良好。我不确定我做错了什么，因为似乎我已经正确地包含并链接了所有内容。

此外，如果有人知道加载 PNG 的更简单/更好的方法，我也愿意提供建议。

# sql - 在查询中将 getdate() - 7 小时设置为零

> ID：16042051
> 
> 赞同：0
> 
> 时间：2013-04-16T16:15:42.990
> 
> 标签：sql, tsql

我有一个查询，其中我使用日期作为条件 ( `paiddate`)。

我想要从前 7 天到今天的记录。所以，我的陈述看起来像这样

```
PaidDate >= GETDATE() - 7 
```

我以为我会像这样回到开始日的 0 小时

```
PaidDate > DATEADD(d,DATEDIFF(d,7,getdate()),0) 
```

但是，我收到一条错误消息：

*varchar 值 '2224560081' 的转换溢出了一个 int 列*。

知道为什么会发生这种情况以及如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:23:19.337

相反，只需投射到日期：

```
PaidDate >= cast((getdate() - 7) as date) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-05T18:57:53.567

我只是想结束这个问题。问题是因为应用了其他过滤器并且我错误地识别了它们（例如（7001、7002、7003）中的client.location。这些值应该是字符串而不是整数。感谢那些响应的人。

# python - 将单位信息存储在 numpy 结构化数组中的最佳方法？

> ID：16042055
> 
> 赞同：4
> 
> 时间：2013-04-16T16:15:53.297
> 
> 标签：python, numpy

将列的单位信息存储在 numpy 结构化数组中的最佳方法是什么？

根据[http://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html ，我在这里尝试过](http://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html)

> 字段名称也可以是字符串的 2 元组，其中第一个字符串是“标题”（可以是任何字符串或 unicode 字符串）或字段的元数据，可以是任何对象，第二个字符串是“名称”必须是有效的 Python 标识符。

但是我怎样才能访问/读取这个元数据呢？

```
import numpy as np

dtype = np.dtype([
    ('name', 'S64'),
    (('s', 'read_time'), 'uint16'),
    (('us', 'read_latency'), 'float'),
    (('B', 'read_data'), 'uint64'),
])
my_data = np.zeros(10, dtype=dtype) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:59:55.993

如果我了解您要查找的内容，则需要 dtype 的“descr”属性：

```
In [12]: my_data.dtype.descr
Out[12]: 
[('name', '|S64'),
 (('s', 'read_time'), '<u2'),
 (('us', 'read_latency'), '<f8'),
 (('B', 'read_data'), '<u8')]

In [13]: my_data.dtype.descr[1]
Out[13]: (('s', 'read_time'), '<u2')

In [14]: my_data.dtype.descr[1][0][0]
Out[14]: 's' 
```

您将其用于单元元数据的方法对我来说很有意义。请注意，dtype 也有一个“名称”元组，其中只有字段名称（没有单位）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T12:12:39.963

你可能想看看[品脱](https://pint.readthedocs.org/en/latest/)

在文档中，它声明为功能之一：

> NumPy 集成：当您选择使用 NumPy ndarray 时，支持其方法和 ufunc，包括自动转换单位。例如 numpy.arccos(q) 将需要一个无量纲的 q 并且输出量的单位将是弧度。

# javascript - 在范围上应用 If/Then (google-apps-script)

> ID：16042056
> 
> 赞同：1
> 
> 时间：2013-04-16T16:15:53.297
> 
> 标签：javascript, google-apps-script, google-sheets

我正在慢慢地了解如何制定一个通用的编程过程，但我需要一个愿意进一步教我如何钓鱼的人（在这个 JS 池塘中）。

我想测试一系列单元格（例如：A1:A10），如果在该范围内的单元格中找到“，”，我想在该单元格右侧的 5 列单元格中编写一个公式。

到目前为止，我已经能够在指定特定单元格时让它工作，但我不确定如何采用它来处理一系列单元格。

（顺便说一句，这是我理解如何在 VBA 中做的事情 - 尽管没有 SPLIT 功能 - 但这种语言显然是一种非常不同的动物）

这是我现在拥有的：

```
var defSheet1 = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1")   
var test1 = defSheet1.getRange("A1").getValue();
var splitCell = '=SPLIT(A1,",")';
if (test1.indexOf(",") !== -1)  
{
defSheet1.getRange("F1").setFormula(splitCell);
}
 else 
  { 
Browser.msgBox("NO SPLIT NECESSARY");   
  } 
```

（顺便说一句，实际范围将通过使用 getDataRange 确定，但为简单起见，我在这里使用预先确定的范围）

我已经在这里学到了很多东西，并且我逐渐获得了在 JS 中“思考”的能力，但是 VBA“ *For x = 1 to numLastRow* ”的概念在 JS 中并不适合我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:28:59.593

When you're working on multiple rows and/or columns from spreadsheets, one challenge is converting between indexes and the various ways that cell locations can be expressed.

*   In A1Notation, columns are expressed first, as a letter, followed by row, as a number starting at 1.
*   R1C1 notation flips the order of rows and columns, and both dimensions are numbers starting from 1.
*   Arrays in javascript start from index 0\. As you evolve your script to use `getDataRange().getValues()`, this will be important. In the two-dimensional array returned by `getValues()`, rows are expressed first, then column, as in `data[row][column]`. The upper bound of your loops will need to be adjusted accordingly, and you may need to `+1` if you're referencing Range methods like `setFormula()`.

The code snippet below will do what you're looking for, as a starting point. I've left out the `else` block to reduce noise. Note the use of `getA1Notation()` to build the `SPLIT` formula dynamically - a straight-forward evolution of your script.

You'll need to define `numLastRow` yourself, and since the script is accessing Range methods throughout, `10` would mean cell `A10`.

```
var defSheet1 = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1")

for (var x=1; x<=numLastRow; x++) {
  var srcRange = defSheet1.getRange(x,1);
  var value = srcRange.getValue();  // Get value at Row x, Column 1
  if (value.indexOf(",") !== -1) {
    var splitCell = '=SPLIT(' + srcRange.getA1Notation() + ',",")';
    defSheet1.getRange(x,5).setFormula(splitCell);
  }
}; 
```

# asp.net - 字符集的大问题

> ID：16042057
> 
> 赞同：0
> 
> 时间：2013-04-16T16:15:59.273
> 
> 标签：asp.net, iis

由于我将我们的 Intranet 移动到了一个新服务器（Windows Server 2008 / IIS 7）我有一个问题：而不是特殊字符，如 à、è、ì、ò、ù、€... 反向问号存储在数据库中.

我在 ASP.NET 和 PHP 应用程序中都有同样的问题。

我已经尝试过的：

*   编辑内网根目录下的web.config文件，添加.php和.aspx扩展名；
*   更改我的 .NET 应用程序的 web.config 文件中的字符集；
*   更改 php.ini 文件中的字符集；
*   更改 IIS 中的字符集（.NET 全球化部分）。

请注意，使用旧服务器（Window Server 2003 / IIS 6）一切正常。请注意，即使现​​在客户端-服务器应用程序也可以正常工作，所以这绝对只是 Web 应用程序的问题。

任何帮助将不胜感激，因为我完全被困住了！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:57:37.427

某些浏览器（特别是旧版）不能直接识别特殊字符

更好地存储 ascii 代码而不是特殊字符，
例如，而不是在数据库**中**存储**“à”**

1.  从用户/浏览器获取您的字符串
2.  转换为 ASCII
3.  将 ASCII 码存储在 db 中
4.  在每个浏览器/任何地方渲染

这是一些将特殊转换为ascii的链接

1.  [在Javascript中将特殊字符转换为HTML](https://stackoverflow.com/questions/784586/convert-special-characters-to-html-in-javascript)
2.  [如何使用纯 JavaScript 将字符转换为 HTML 实体](https://stackoverflow.com/questions/1354064/how-to-convert-characters-to-html-entities-using-plain-javascript)

# java - 根据单元格的内容为单个 JTable 单元格着色？

> ID：16042059
> 
> 赞同：0
> 
> 时间：2013-04-16T16:15:57.640
> 
> 标签：java, swing, colors, jtable, cell

好的，我知道这个问题已经被问过很多关于堆栈溢出的问题。我几乎阅读了每篇文章。我绝对不能得到这个太工作。我制作了一张表格，用作酒店的可用性日历，我想将 0 个可用房间的单元格着色为红色，而将超过 0 个房间的单元格着色为绿色。我尝试实现表格单元格渲染器无济于事。这是我所有的代码。我究竟做错了什么？

```
package gui;

import entity.Inventory;
import entity.Room;
import java.awt.Color;
import java.awt.Component;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.LinkedList;
import javax.swing.BorderFactory;

import javax.swing.JComboBox;
import javax.swing.JPanel;
import javax.swing.JTable;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;
import tools.DateCalc;

public class Calendar extends JPanel {

    String[] years = {"2013", "2014"};
    JComboBox yearBox = new JComboBox(years);
    String[] months = {"January", "February", "March", "April", "May", "June", "July", "August",
        "September", "October", "November", "December"};
    JComboBox monthBox = new JComboBox(months);
    LinkedList<String> lTypes = Room.getRoomTypes();
    String[] types = lTypes.toArray(new String[0]);
    JComboBox typeBox = new JComboBox(types);

    CalendarModel model = new CalendarModel();
    JTable table = new JTable(model);

    public Calendar() {
        super();

        yearBox.setBounds(10, 10, 100, 30);
        yearBox.setSelectedIndex(0);
        yearBox.addItemListener(new ComboHandler());

        int selected = DateCalc.getNumMonth(DateCalc.getCurrentDate());

        monthBox.setSelectedIndex(selected);
        monthBox.addItemListener(new ComboHandler());
        // table.setBounds(10, 150, 550, 200);
        model.setMonth(Integer.parseInt((String)yearBox.getSelectedItem()), monthBox.getSelectedIndex(), 0);
        typeBox.addItemListener(new ComboHandler());
        add(monthBox);
        add(yearBox);
        add(typeBox);
        table.setGridColor(Color.black);
        table.setShowGrid(true);
        table.setRowHeight(40);
        table.setBorder(BorderFactory.createLineBorder(Color.black));

        table.setDefaultRenderer(String.class, new MyCellRender());
        add(table);

        setSize(600, 800);
        setVisible(true);
    }

    public static void main(String[] args) {
        Calendar app = new Calendar();
    }

    public class ComboHandler implements ItemListener {

        public void itemStateChanged(ItemEvent e) {

            model.setMonth(Integer.parseInt((String)yearBox.getSelectedItem()), monthBox.getSelectedIndex(), typeBox.getSelectedIndex());
            table.repaint();

        }
    }

    public class MyCellRender extends DefaultTableCellRenderer {

        @Override
        public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column) {
            Component c = super.getTableCellRendererComponent(table, value,
                                          isSelected, hasFocus,
                                          row, column);
            for (int i =0; i < 7; i++){
                for (int j = 0; j < j; j++){
                    String positive = (String)table.getModel().getValueAt(i,j);
                    System.out.println(positive);
                    int val = positive.indexOf(" 0 ");
                    if (val < 0)
                       c.setBackground(Color.green);
                    else{
                        c.setBackground(Color.red);
                    }
                }
            }

            return c;
        }
    }

    class CalendarModel extends DefaultTableModel {

        String[] days = {"  Sun", "  Mon", "  Tue", "  Wed", "  Thu", "  Fri", "  Sat"};
        int[] numDays = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
        String[][] calendar = new String[7][7];

        public CalendarModel() {
            for (int i = 0; i < days.length; ++i) {
                calendar[0][i] = days[i];
            }
            for (int i = 1; i < 7; ++i) {
                for (int j = 0; j < 7; ++j) {
                    calendar[i][j] = " ";
                }
            }
        }

        @Override
        public boolean isCellEditable(int row, int column){
            return false;
        }
        public int getRowCount() {
            return 7;
        }

        public int getColumnCount() {
            return 7;
        }

        public String getValueAt(int row, int column) {
            return calendar[row][column];
        }

        public void setValueAt(String value, int row, int column) {
            calendar[row][column] = value;
        }

        public void setMonth(int year, int month, int flag) {
            for (int i = 1; i < 7; ++i) {
                for (int j = 0; j < 7; ++j) {
                    calendar[i][j] = " ";
                }
            }
            java.util.Calendar cal = java.util.Calendar.getInstance();
            cal.set(year, month, 1);
            Date date = cal.getTime();

            DateFormat df = new SimpleDateFormat("MMddyyyy");

            String start = df.format(date);
            int offset = cal.get(java.util.Calendar.DAY_OF_WEEK)-1;

            offset += 7;
            int num = daysInMonth(year, month);
            for (int i = 0; i < num; ++i) {
                String target = DateCalc.addDay(start, i);
                Inventory inventory = Inventory.fromDBObject(target);
                String type = (String)typeBox.getSelectedItem();
                String beds = inventory.getField(type);
                calendar[offset / 7][offset % 7] = "  " + Integer.toString(i + 1)
                        + ".  " + beds;
                ++offset;

            }
        }

        public boolean isLeapYear(int year) {
            if (year % 4 == 0) {
                return true;
            }
            return false;
        }

        public int daysInMonth(int year, int month) {
            int days = numDays[month];
            if (month == 1 && isLeapYear(year)) {
                ++days;
            }
            return days;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:35:32.263

如果`String`该类被用作列类

```
table.setDefaultRenderer(String.class, new MyCellRender()); 
```

那么，列类`TableModel`应该匹配：

```
@Override
public Class<?> getColumnClass(int columnIndex) {
   return String.class;
} 
```

* * *

此外，还有一个问题`getTableCellRendererComponent`，内部循环不会被执行

```
for (int i = 0; i < 7; i++) {
   for (int j = 0; j < j; j++) {
                   ^^^^^---------condition always false, loop will not execute 
```

目前尚不清楚为什么需要这些循环，因为`getTableCellRendererComponent`无论如何都会为每个单元组件调用这些循环。

# eclipse - wicket 异常开始过滤 wicket

> ID：16042061
> 
> 赞同：4
> 
> 时间：2013-04-16T16:16:01.233
> 
> 标签：eclipse, jakarta-ee, tomcat, wicket

我正在尝试使用 wicket 创建一个 Web 应用程序。这些是我遵循的步骤：

1.  我使用以下命令创建了一个 Maven 项目：

    mvn archetype:generate -DarchetypeGroupId=org.apache.wicket -DarchetypeArtifactId=wicket-archetype-quickstart -DarchetypeVersion=6.6.0 -DgroupId=com.mycompany -DartifactId=myproject -DarchetypeRepository= [https://repository.apache.org/](https://repository.apache.org/) - DinteractiveMode=false

2.  我将项目导入eclipse

3.  我通过右键单击启用了 Maven 依赖项
4.  我将我的项目转换为 Web 项目并设置了 Tomcat 7 服务器
5.  通过右键单击，我在此服务器上运行了项目，产生了以下消息：`HTTP Status 404 - The requested resource is not available.`

这是控制台上的错误消息：

```
SEVERE: Exception starting filter wicket.myproject
java.lang.ClassNotFoundException: org.apache.wicket.protocol.http.WicketFilter
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1713)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1558)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:527)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:509)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:137)
    at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:260)
    at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:107)
    at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4656)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5309)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:722) 
```

现在这是我的 pom.xml ：

http://maven.apache.org/maven-v4_0_0.xsd">4.0.0 com.amadeus RDA_2 战争 1.0-SNAPSHOT 快速入门

```
<licenses>
    <license>
        <name>The Apache Software License, Version 2.0</name>
        <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>
        <distribution>repo</distribution>
    </license>
</licenses>
<properties>
    <wicket.version>6.6.0</wicket.version>
    <jetty.version>7.6.3.v20120416</jetty.version>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
</properties>
<dependencies>
    <!--  WICKET DEPENDENCIES -->
    <!-- <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-core</artifactId>
        <version>${wicket.version}</version>
    </dependency>
    OPTIONAL DEPENDENCY
    <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-extensions</artifactId>
        <version>${wicket.version}</version>
    </dependency>
    -->

    <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-core</artifactId>
        <version>${wicket.version}</version>
    </dependency>

    <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-extensions</artifactId>
        <version>${wicket.version}</version>
    </dependency>

    <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-devutils</artifactId>
        <version>${wicket.version}</version>
    </dependency>

    <!-- LOGGING DEPENDENCIES - LOG4J -->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.6.4</version>
    </dependency>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.16</version>
    </dependency>

    <!--  JUNIT DEPENDENCY FOR TESTING -->
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.10</version>
        <scope>test</scope>
    </dependency>

    <!--  JETTY DEPENDENCIES FOR TESTING  -->
    <dependency>
        <groupId>org.eclipse.jetty.aggregate</groupId>
        <artifactId>jetty-all-server</artifactId>
        <version>${jetty.version}</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>wicket</groupId>
        <artifactId>wicket</artifactId>
        <version>1.2.7</version>
    </dependency>
</dependencies>
<build>
    <resources>
        <resource>
            <filtering>false</filtering>
            <directory>src/main/resources</directory>
        </resource>
        <resource>
            <filtering>false</filtering>
            <directory>src/main/java</directory>
            <includes>
                <include>**</include>
            </includes>
            <excludes>
                <exclude>**/*.java</exclude>
            </excludes>
        </resource>
    </resources>
    <testResources>
        <testResource>
            <filtering>false</filtering>
            <directory>src/test/resources</directory>
        </testResource>
        <testResource>
            <filtering>false</filtering>
            <directory>src/test/java</directory>
            <includes>
                <include>**</include>
            </includes>
            <excludes>
                <exclude>**/*.java</exclude>
            </excludes>
        </testResource>
    </testResources>
    <plugins>
        <plugin>
            <inherited>true</inherited>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.5.1</version>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
                <encoding>UTF-8</encoding>
                <showWarnings>true</showWarnings>
                <showDeprecation>true</showDeprecation>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.mortbay.jetty</groupId>
            <artifactId>jetty-maven-plugin</artifactId>
            <version>${jetty.version}</version>
            <configuration>
                <connectors>
                    <connector implementation="org.eclipse.jetty.server.nio.SelectChannelConnector">
                        <port>8080</port>
                        <maxIdleTime>3600000</maxIdleTime>
                    </connector>
                    <connector implementation="org.eclipse.jetty.server.ssl.SslSocketConnector">
                        <port>8443</port>
                        <maxIdleTime>3600000</maxIdleTime>
                        <keystore>${project.build.directory}/test-classes/keystore</keystore>
                        <password>wicket</password>
                        <keyPassword>wicket</keyPassword>
                    </connector>
                </connectors>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-eclipse-plugin</artifactId>
            <version>2.9</version>
            <configuration>
                <downloadSources>true</downloadSources>
            </configuration>
        </plugin>
    </plugins>
</build>

<repositories>
    <repository>
        <id>Apache Nexus</id>
        <url>https://repository.apache.org/content/repositories/snapshots/</url>
        <releases>
            <enabled>false</enabled>
        </releases>
        <snapshots>
            <enabled>true</enabled>
        </snapshots>
    </repository>
</repositories>
</project> 
```

这是我的 web.xml ：

```
<filter>
    <filter-name>wicket.myproject</filter-name>
    <filter-class>org.apache.wicket.protocol.http.WicketFilter</filter-class>
    <init-param>
        <param-name>applicationClassName</param-name>
        <param-value>com.mycompany.WicketApplication</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>wicket.myproject</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

任何人都可以帮助我吗？？？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-05-29T16:44:04.303

有点晚了，但这是解决问题的方法：

右键单击项目-> 属性-> 部署程序集

确保项目的库部署到 WEB-INF/lib 文件夹中。就我而言，根本没有库，所以我必须通过按来添加它们

添加 -> Java 构建路径条目

并选择图书馆（其中的检票口图书馆）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:25:24.207

你改变你的POM了吗？此类属于`wicket-core`，快速入门添加了以下内容：

```
<dependency>
  <groupId>org.apache.wicket</groupId>
  <artifactId>wicket-core</artifactId>
  <version>6.6.0</version>
</dependency> 
```

检查此声明是否在您的`pom.xml`.

# c++ - 任何向量的专业化

> ID：16042067
> 
> 赞同：3
> 
> 时间：2013-04-16T16:16:28.160
> 
> 标签：c++, templates, c++11, template-specialization, sfinae

我想在模板类中为 T 的不同情况定义一个函数。我的问题是定义 T 是向量的情况（无论它包含什么）。

这是我的第一次尝试：

```
template<typename T>
class Test{
protected:
    T *val;
public:
    Test(T* v):v(val){};
    static string typeName();
};

template<typename T>
string Test<T>::typeName(){
    return "other";
}

template<>
string Test<int>::typeName(){
    return "int";
}

template<typename T>
string Test<vector<T>>::typeName(){
//error: invalid use of incomplete type ‘class Test<vector<T>>’
    return "vector<" + Test<T>::typeName() + ">";
} 
```

我可以通过定义来解决这个错误：

```
template<typename T>
class Test<vector<T>>{
    // ... (the same thing)
} 
```

但我不想这样做，因为我的班级很大，我不想再次编写相同的函数。如果可能的话，我还想避免让我的类从另一个类继承。

通过在这里搜索，我了解了 SFINAE，但我是它的初学者。我尝试了所有可能的方法，但没有任何效果。这是另一个尝试：

```
#include <type_traits>

template<typename T,typename E=void>
class Test{
protected:
    T *val;
public:
    Test(T* v);
    static string typeName();
    static void bidon();
};

template<typename T,typename E>
string Test<T,E>::typeName(){
    return "other";
}

template<>
string Test<int>::typeName(){
    return "int";
}

template<typename T> struct IsVector            : public std::false_type{};
template<typename T> struct IsVector<vector<T>> : public std::true_type {};

template<typename T,typename E>
    string Test<T,typename std::enable_if<IsVector<T>::value,E>::type>::typeName(){
    return "vector<" + Test<typename T::value_type>::typeName() + ">";
} 
```

我有同样的错误。它出什么问题了 ？我在尝试做不可能的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:36:05.913

由于您的`typeName`方法是`static`and `public`，您可以使用这样的免费辅助函数：

```
template< typename T > struct is_vector : std::false_type {};

template< typename... Ts > struct is_vector<vector<Ts...>> : std::true_type {};

// Standard-confirming compilers will accept the above specialization, but
// if your compiler doesn't like the above, you need to manually provide all
// template arguments to detect std::vector properly:

// template< typename T, typename Allocator >
// struct is_vector<vector<T,Allocator>> : std::true_type {};

template<typename T>
typename std::enable_if< !is_vector<T>::value, string >::type testTypeName(){
    return "other";
}

template<typename T>
typename std::enable_if< is_vector<T>::value, string >::type testTypeName(){
    return "vector<" + Test<typename T::value_type>::typeName() + ">";
}

template<>
string Test<int>::typeName(){
    return "int";
}

template<typename T>
string Test<T>::typeName(){
    return testTypeName<T>();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T16:30:12.940

I think you can achieve what you want with this. The result is the same even though the approach is a little bit different.

```
template <typename V>
struct typeName {};

// Handle pointers
template <typename V>
struct typeName<V*> {
    static string name;
};
template <typename V>
string typeName<V*>::name = typeName<V>::name + "*";

template <>
struct typeName<string> {
    static string name;
};
string typeName<string>::name = "string";

template <>
struct typeName<int> {
    static string name;
};
string typeName<int>::name = "int";

template <typename V>
struct typeName<vector<V>> {
    static string name;
};

template <typename V>
string typeName<vector<V>>::name = "vector<" + typeName<V>::name + ">";

template <typename V>
struct typeName<set<V>> {
    static string name;
};

template <typename V>
string typeName<set<V>>::name = "set<" + typeName<V>::name + ">";

int main() {
    cout << typeName<vector<string>>::name << endl;   
    cout << typeName<set<string>>::name << endl;   
    cout << typeName<vector<set<string*>*>>::name;   
} 
```

* * *

```
stdout

vector<string>
set<string>
vector<set<string*>*> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T16:35:06.120

您可以制作一个单独的模板，其中包含该函数，并让主模板调用辅助模板的函数：

```
template <typename T>
struct tn_helper {
    static string typeName(){
        return "other";
    }
};

template <typename T>
string Test::typeName(){
    return tn_helper<T>::typeName();;
}

template<>
struct tn_helper<int> {
    static string typeName(){
        return "int";
    }
};

template<typename T>
struct tn_helper<vector<T> > {
    static string typeName(){
        return "vector<" + tn_helper<T>::typeName() + ">";
    }
};

// etc. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T16:35:18.987

我不知道为什么您最初的尝试不起作用（就像您希望它编译一样，希望其他人可以对此有所了解）但作为一种解决方法，您可以制作一个单独的模板类，其中仅包含您的静态函数，并在您的主类中使用该类。类似于以下内容：

```
template<typename T>
struct TypeName {
    static std::string typeName() { return "other"; }
};
template<>
struct TypeName<int> {
    static std::string typeName() { return "int"; }
};
template<typename T>
struct TypeName<std::vector<T>> {
    static std::string typeName() { return "vector<" + TypeName<T>::typeName() + ">"; }
};

template<typename T>
class Test {
public:
    static std::string typeName() { return TypeName<T>::typeName(); }
    // more stuff
}; 
```

# c++ - 使用 CppUnit 测试静态函数

> ID：16042068
> 
> 赞同：9
> 
> 时间：2013-04-16T16:16:32.700
> 
> 标签：c++, c, unit-testing, cppunit

我的项目包含 C 文件。在某些文件中，我将函数定义为静态。

我在单元测试中使用 CppUnit，我想测试这些静态函数。我知道不允许从文件外部（定义它的地方）调用函数。为了从我的 C++ 测试文件中调用这些静态函数，是否有避免此问题的解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T16:24:36.523

假设我们谈论的是 C 静态函数，那么最简单的解决方案是在编译调试版本时使函数非静态。这意味着您可以在单元测试中使用这些符号。这仅在没有符号别名的情况下才有效。

如果您`DEBUG`在所有调试版本上定义符号，则类似于：

```
#ifdef DEBUG
#define debug_export 
#else
#define debug_export static
#endif 
```

然后像这样定义你的静态函数

```
debug_export void foo(void)
{
...
} 
```

并且要么有条件地在头文件中包含声明，要么在您的单元测试文件中手动导入它们：

```
extern void foo(void); 
```

解决它的其他方法是将单元测试包含在源文件本身中（如果它失控会有点混乱），而不是对函数进行单元测试（有点逃避）或标记函数[作为 dll-local](http://gcc.gnu.org/wiki/Visibility)而不是静态的，并确保您的单元测试是该动态对象的一部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T15:41:23.990

我有一个通用头文件，我包含在我项目的所有源文件中。我添加了这些行，问题就解决了：

```
#ifdef TEST
#define static
#endif 
```

我什至可以避免在我的原始 C 代码中添加上述代码。我可以在 gcc 命令中添加标志`-Dstatic=`，我发现这也有效。

但是我们在使用这个解决方案时必须小心，因为：

*   我们可以在 2 个单独的文件中将相同的变量/函数名称定义为静态。
*   我们可以有一个包含定义为静态变量的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:28:15.447

有没有办法重构代码以消除对静态方法的需求？从 OO 设计的角度来看，静态是羊皮中的全局变量。

我知道这不一定是实际或最快的答案，但您可以通过消除它来改进您的设计。

# html - 有没有办法将类型选择器应用于元素？

> ID：16042069
> 
> 赞同：0
> 
> 时间：2013-04-16T16:16:34.690
> 
> 标签：html, css, razor

我有一个链接，我希望它看起来像一个按钮。我已经有一个类型选择器“按钮”形式的样式，并且它被全部使用。我可以通过 HTML 将其应用于我的链接吗？

剃刀：

```
@Ajax.ActionLink("Search", "Search", "N", null, new AjaxOptions() { UpdateTargetId = "NDiv", HttpMethod = "Post", OnComplete = "OnComplete" }, htmlAttributes: new { @class = "button" }) 
```

CSS：

```
button {
        background-color: #d3dce0;
        border: 1px solid #787878;
        cursor: pointer;
        font-size: 1.2em;
        font-weight: 600;
        padding: 7px;
        margin-right: 8px;
        width: auto;
    } 
```

我知道我可以复制样式并将名称更改为“.button”，但我不想复制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:18:42.377

您不需要复制样式。您可以简单地添加应用现有样式的更多元素：

```
button, .button {
    background-color: #d3dce0;
    border: 1px solid #787878;
    cursor: pointer;
    font-size: 1.2em;
    font-weight: 600;
    padding: 7px;
    margin-right: 8px;
    width: auto;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:18:33.737

唯一可行的解​​决方案是：

```
button, .button {
    background-color: #d3dce0;
    border: 1px solid #787878;
    cursor: pointer;
    font-size: 1.2em;
    font-weight: 600;
    padding: 7px;
    margin-right: 8px;
    width: auto;
} 
```

# sql - 数据透视表措辞 - SSMS 2012

> ID：16042076
> 
> 赞同：0
> 
> 时间：2013-04-16T16:16:51.607
> 
> 标签：sql, pivot, sql-server-2012, ssms, ssms-2012

我正在尝试旋转表的 PRODUCT 列。包含两个单词的值之间有一个下划线：

某些产品值的 EX：

```
PRODUCT
USSIC_Aviation
Avemco_Aviation
Property
Life 
```

这是我的枢轴代码：

```
select SIMULATION, [USSIC Aviation], [Avemco Aviation], [Property], [Life]
from CM.CorrelationData
pivot
(
min(Value)
for replace(PRODUCT,'_',' ') in ([USSIC Aviation], [Avemco Aviation], [Property], [Life])
) piv
where Product_Description='UW' 
```

它不喜欢，`replace(PRODUCT,'_',' ')`但我不知道如何摆脱下划线。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:40:15.333

您不能在`PIVOT`查询区域执行替换，因此您需要在子查询中执行它：

```
select SIMULATION, [USSIC Aviation], [Avemco Aviation], [Property], [Life]
from
(
  select SIMULATION, replace(PRODUCT,'_',' ') Product, value
  from  CM.CorrelationData
  where Product_Description='UW' 
) d
pivot
(
  min(Value)
  for PRODUCT in ([USSIC Aviation], [Avemco Aviation], [Property], [Life])
) piv 
```

# html - 覆盖 div，但保持元素可操作

> ID：16042079
> 
> 赞同：1
> 
> 时间：2013-04-16T16:17:03.530
> 
> 标签：html, css

我有一个元素`<div>`覆盖它以显示网格。我希望让网格保持在这个元素的顶部，但让元素中的所有内容仍然可以操作和交互（链接、选择文本等）。

我将如何编码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:19:02.637

添加`pointer-events:none;`到 CSS

请参阅此示例[http://jsfiddle.net/Zjq6H/](http://jsfiddle.net/Zjq6H/)

# java - 如何访问工厂方法创建的对象？

> ID：16042084
> 
> 赞同：0
> 
> 时间：2013-04-16T16:17:28.380
> 
> 标签：java, design-patterns, instance, factory-pattern

我的问题是如何通过没有名称的工厂方法访问实例创建这是我的代码

```
 public abstract class Vertex <T>{

int vertexId ;
T vertexValue ;

public  abstract  T computeVertexValue();} 
```

```
 public class ImageVertex extends Vertex<Map<String, Instance>>{

public ImageVertex(int id ) {
    this.vertexId=id;
}

@Override
public Map<String, Instance> computeVertexValue() {
//  
} 
```

```
 public abstract class AbstractVertexFactory<T extends Vertex>  {

public abstract  T createVertex(int id);} 
```

```
 public class ImageFactory extends AbstractVertexFactory<ImageVertex> {

@Override
public ImageVertex createVertex(int id) {
    // TODO Auto-generated method stub
    ImageVertex imVertex=new ImageVertex(id);
    imVertex.computeVertexValue();
    return imVertex;
}} 
```

```
 public class ImageFactorySimulator {
public static void main(String[] args) {

    AbstractVertexFactory<ImageVertex> immFactory = new ImageFactory();

    ImageVertex imVertex = immFactory.createVertex(1);}} 
```

如何从模拟器类或任何其他类访问 id 等于 1 的 ImageVertex 实例？

# python - 在 python 3 中使用全局变量

> ID：16042089
> 
> 赞同：1
> 
> 时间：2013-04-16T16:17:42.863
> 
> 标签：python, python-3.x

我如何在模块的任何位置使用和编辑全局变量？我的项目看起来像

```
project/
---- models/
---- ---- first.py
---- ---- second.py
---- run.py 
```

Run.py 是主要的，我在其中使用它来启动应用程序，全局变量 init。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:18:57.697

您必须将`import`它们放入要在其中使用它们的任何其他模块中。全局变量仅对它们所在的文件是全局的（除非在其他地方导入）。

请注意，如果您希望更改在您导入的模块之外传播，您需要执行以下两项操作之一：

*   使用非`from`导入语法（例如`import foo.bar`，然后`foo.bar = <value>`）
*   使用可变类型并就地修改它（例如字典）

这样做的原因是，如果您使用`from`导入，它会创建变量的本地版本，该版本独立于另一个模块的变量，但具有相同的值。对于可变类型，此值是一个引用，因此只要您就地修改对象，更改将随处可见（因为所有引用都指向同一个对象）。

# html - 为什么这些宽度为 50% 的表单元素不会显示在一行上？

> ID：16042093
> 
> 赞同：1
> 
> 时间：2013-04-16T16:17:57.240
> 
> 标签：html, css, forms, width

我有两个表单元素（一个文本输入和一个提交按钮），我想显示在一行上，宽度均为 50%。这不适用于以下 HTML/CSS：

HTML

```
 <form name="newsletter" target="#" method="post" class="group">
    <input name="email" type="text" placeholder="email here..." />
    <input name="submit" type="submit" class="button" value="subscribe" />
  </form> 
```

CSS

```
* {
    box-sizing:border-box;
}

input[type="text"] {
    margin: 0;
    width: 50%;
    font-size: 0.75rem; /* 16x0.75=12px */
    padding: 0.625em;
    border: 1px solid black;
    border-radius: 0.3125em 0.3125em 0.3125em 0.3125em;
}

input[type="submit"] {
    margin: 0;
    width: 50%;
    font-size: 0.75rem; /* 16x0.75=12px */
    padding: 0.625em;
    border: none;
    border-radius: 0.3125em 0.3125em 0.3125em 0.3125em;
    text-transform: uppercase;
} 
```

将它们设置为`display:block`或`inline-block`也无济于事。但是当我将它们都设置为`width:50%`,`float:left`并且`float:right`它们保持在一条线上时没有问题。

这是为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:25:59.310

您的元素之间有空格（换行符、制表符等）。删除它（或将其注释掉），它们符合您的预期：

[http://tinker.io/9a125](http://tinker.io/9a125)

```
 <form name="newsletter" target="#" method="post" class="group">
    <input name="email" type="text" placeholder="email here..." /><!--
    --><input name="submit" type="submit" class="button" value="subscribe" />
  </form> 
```

Inline* 元素尊重它们之间的空白。浮动起作用的原因是元素不再是内联的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:31:23.610

试试这种风格：

```
input{float:left} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:22:26.720

可能您还设置了 1px 的边框，这将添加到 50%。

# facebook-graph-api - category_lists 上是否有错误？

> ID：16042094
> 
> 赞同：0
> 
> 时间：2013-04-16T16:17:58.327
> 
> 标签：facebook-graph-api, categories

像这样的页面上的请求[https://graph.facebook.com/295212867812](https://graph.facebook.com/295212867812)曾经返回 category_lists，现在它们不再被返回。这是一个错误，还是某种奇怪的预期行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T19:40:56.487

category_lists 更改已从[2013 年 7 月的重大更改](https://developers.facebook.com/blog/post/2013/04/03/platform-updates--operation-developer-love/)中删除：

> 2013 年 4 月 9 日更新 -**我们将从此迁移中删除以下更改**：
> 
> 页面“类别”字段名称更改我们正在将 Pages Graph API 的“类别”字段重命名为“类别列表”

所以，听起来 category_lists 已经消失了。

但是，有趣的是查询 category_list（不带 s）确实返回了有效数据，所以将来可能会被正式重命名：

[https://graph.facebook.com/295212867812?fields=category_list](https://graph.facebook.com/295212867812?fields=category_list)

```
{
    "id": "295212867812",
    "category_list": [
       {
          "id": 128003127270269,
          "name": "Bike Shop"
       },
       {
          "id": 193198380699462,
          "name": "Repair Service"
       }
   ]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-13T10:31:38.753

作为对 Marty Dill 回答的补充，我认为这还没有真正记录在案。至少我没有找到任何 Graph API ( [https://developers.facebook.com/docs/reference/api/user/#likes](https://developers.facebook.com/docs/reference/api/user/#likes) ) 或 FQL ( [https://developers.facebook.com/docs/reference /fql/页面](https://developers.facebook.com/docs/reference/fql/page)）。

category_list 还附加到用户喜欢的 Graph API 响应中（我只是喜欢你的页面......）。查询[https://graph.facebook.com/123456789/?fields=id,likes](https://graph.facebook.com/123456789/?fields=id,likes)（将 123456789 替换为您的 user_id 并添加有效的 access_token）会导致

```
{
"id": "123456789",
"likes": {
    "data": [
        {
            "category": "Professional services",
            "category_list": [
                {
                    "id": "128003127270269",
                    "name": "Bike Shop"
                },
                {
                    "id": "193198380699462",
                    "name": "Repair Service"
                }
            ],
            "name": "Bicycle Tech",
            "id": "295212867812",
            "created_time": "2013-05-13T10:19:58+0000"
        }
    ],
    "paging": {
        "next": "https://graph.facebook.com/123456789/likes?limit=5000&offset=5000"
    }
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T00:29:40.843

好吧，去[https://graph.facebook.com/295212867812?fields=category_lists](https://graph.facebook.com/295212867812?fields=category_lists)返回：

```
{
   "error": {
      "message": "(#100) Unknown fields: category_lists",
      "type": "OAuthException",
      "code": 100
   }
} 
```

即使它是您可以在图形 api 中查询的字段之一（可在此处找到：developers.facebook.com/docs/reference/api/page/#fields）

所以，可能是一个错误。或者他们只是不再在页面的图形 API 中提供它。

但是，这会返回您页面的类别：

graph.facebook.com/295212867812?fields=category

# docpad - 如何 docpad 生成 --env static 以在子目录中部署

> ID：16042097
> 
> 赞同：4
> 
> 时间：2013-04-16T16:18:03.080
> 
> 标签：docpad

我确信我不是唯一一个不得不将静态站点部署到子目录的人。

事实上，我们有 www.example.com 和 mobile.example.com 以及 tablet.example.com。平板电脑和手机是主主机的子目录......所以实际上有一个重定向到 example.com/mobile 和 example.com/tablet

我正在将单独的 docpad 生成的站点部署到每个潜艇中。

能够为静态生成指定一个“基本目录”会很棒。可能吗？

LIKE: docpad generate --env static -base_path 'blahblah'

我在最新的 docpad 版本 6.30.4

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:57:20.063

您可以自定义[docpad 配置文件](https://docpad.org/docs/config)`outPath`中的属性以更改 docpad 网站输出到的目录。有问题的财产是：

```
# Out Path
# Where should we put our generated website files?
# If it is a relative path, it will have the resolved `rootPath` prepended to it
outPath: 'out'  # default 
```

如果您想更改输出的 url，您可以按照[这里 gist](https://gist.github.com/balupton/3939146)中的建议，将您的网站 url 添加到每个 url，创建一个绝对 url。您可以通过在环境配置中设置不同来自定义站点 url。您还可以像这样使用多个环境`docpad generate --env one,two`

# php - 解析错误：语法错误，意外的 T_EXIT 并且无法在 php 中跨页面使用登录会话

> ID：16042102
> 
> 赞同：-1
> 
> 时间：2013-04-16T16:18:12.490
> 
> 标签：php, mysql

出现错误：解析错误：语法错误，第 47 行 C:\wamp\www\login.php 中的意外 T_EXIT。需要一些帮助。昨天还在工作

```
<?php

require_once("config.php");

$email=$_POST['email'];
$password=$_POST['password'];

$email = stripslashes($email);
$password = stripslashes($password);
$email = mysql_real_escape_string(strip_tags($email));
$password = mysql_real_escape_string(strip_tags($password));

// Check occurence of email password combination
$sql="SELECT * FROM register WHERE email='$email'";
$result=mysql_query($sql); 

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);

// If result matched $email, table row must be 1 row
if($count==1)
{
$row = mysql_fetch_array($result);
if($password == $row['password'])
{
session_start();
$_SESSION['login'] = "1";
header("location:home.html");
exit;
}
else 
{
echo "Please enter correct Password";
header("location:login.html");
session_start();
$_SESSION['login'] = '' 
exit();
}
 }  
else
{
header("Location:register.html");
exit();
}

?> 
```

还添加了以下片段到 home.php 但无法使用登录会话

```
<?php

session_start();
require_once("config.php");

if (!(isset($_SESSION['login']) && $_SESSION['login'] != '')) {

header ("Location: login.html");

exit;

}
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T16:19:20.060

你忘了一个`;`：

```
echo "Please enter correct Password";
header("location:login.html");
session_start();
$_SESSION['login'] = ''    // <----here
exit(); 
```

这不可能在昨天工作，所以有些东西改变了这个脚本......

# sql - 在没有 PIVOT 的情况下在一行中显示针对输入 ID 的多行数据？

> ID：16042104
> 
> 赞同：1
> 
> 时间：2013-04-16T16:18:18.260
> 
> 标签：sql, sql-server

我有针对 ID 的考勤记录，显示他/她当天是否在场，我想通过 sql 查询在一行中显示数据，该行在多行中针对该 ID。所以请帮我尽快解决这个问题。

执行查询后从数据库中获取此结果：

```
abc   1/2/2013      Present

abc   2/2/2013      Present

abc   3/2/2013      Present

abc   4/2/2013      Present

abc   5/2/2013      Present

abc   6/2/2013      Present

Expected Result:

Name   Date1     Date2     Date3      Date4       Date5

abc    Present   Present   Present    Present     Present 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:36:57.680

如果您一定不能使用`PIVOT`，您可以使用行号和分组（[**DEMO**](http://www.sqlfiddle.com/#!3/9cb25/1)）获得相同的效果：

```
select
  name
  ,max(case when rn=1 then description end) as date1
  ,max(case when rn=2 then description end) as date2
  ,max(case when rn=3 then description end) as date3
  ,max(case when rn=4 then description end) as date4
  ,max(case when rn=5 then description end) as date5
from (
  select name, date, description,
    row_number() over (partition by name order by date) rn from Table1
) T
group by name 
```

请注意，这只会处理您硬编码到查询中的日期。如果它必须是动态的（即，您不知道提前需要多少日期列），那么您可能需要根据每组的最大日期计数动态生成上面的 SQL 代码。

# windows - 并排应用程序错误

> ID：16042116
> 
> 赞同：0
> 
> 时间：2013-04-16T16:18:58.003
> 
> 标签：windows, visual-c++, tidesdk, side-by-side

我有一个使用 TideSDK 构建的应用程序。

当尝试在打包的机器上运行应用程序（运行 Windows 8）时，应用程序运行没有问题。当我尝试在我拥有的 Windows Vista 机器上运行这个程序时，我得到一个

**“应用程序无法启动，因为它的并排配置不正确。有关详细信息，请参阅应用程序事件日志。”**

错误。

以下是事件查看器信息：

**“C:\Users[blah blah blah]\Program.exe”的激活上下文生成失败。相关程序集 Microsoft.VC80.CRT、processorArchitecture="x86"、publicKeyToken="1fc8b3b9a1e18e3"、type="win32"、version="8.0.50727.4053" 找不到。请使用 sxstrace.exe 进行详细诊断。**

一些解决方案说要更新 windows 或重新安装 visual c++ redist。

这些错误是否表示需要更新 Windows 或重新安装 Visual C++ Redist？

提前致谢！

文斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T15:32:37.223

您好 MSVC Redistibutable 文件在您的系统中已过时。您需要安装“Microsoft Visual Studio 2005 Service Pack 1”可再发行组件。

他们可以在这里找到：http: [//www.microsoft.com/en-us/download/details.aspx?id=14431](http://www.microsoft.com/en-us/download/details.aspx?id=14431)

# dotnetnuke - 创建没有数据库的 Dotnetnuke 模块

> ID：16042120
> 
> 赞同：0
> 
> 时间：2013-04-16T16:19:11.223
> 
> 标签：dotnetnuke, dotnetnuke-module

我从 DotNetNuke 7 中的模块开发开始，想开发一个简单的模块，一个读取外部 XML 并将其显示在页面上的模块。

我的问题是：对于一个不需要访问数据库的模块（正如我要开发的那样），是否需要在数据库中为该模块创建一个表？[（ http://www.dotnetnuke.com/Resources/Wiki/Page/Module-Development.aspx](http://www.dotnetnuke.com/Resources/Wiki/Page/Module-Development.aspx)中的步骤 6、7 和 8 ）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:41:28.560

不，这不是必需的，您可以删除任何 DataProvider/SqlDataProvider 引用。

更新：您还需要删除 .DNN 文件中对您从项目中删除的任何文件的引用。

# multithreading - 在Linux内核中，创建实时kthread的以下方法是否正确？

> ID：16042123
> 
> 赞同：5
> 
> 时间：2013-04-16T16:19:16.817
> 
> 标签：multithreading, linux-kernel, scheduled-tasks, real-time, scheduler

在Linux内核中，线程调度是实时的（如SCHED_FIFO）和普通的（SCHED_NORMAL）。

如果我想创建一个实时线程，该怎么做？我想像：

> 1、kthread_create
> 
> 2、给线程一个实时调度器
> 
> 3、分配实时优先级

这对于实时 kthread 是否合适？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T04:22:33.903

在线程本身中，调用：

```
struct sched_param param = { .sched_priority = prio };
sched_setscheduler(current, SCHED_FIFO, &param); 
```

`prio`你想要的优先级在哪里。

# php - 这是 PHP 中一个很好的散列密码函数吗？如果不是，为什么不呢？

> ID：16042128
> 
> 赞同：22
> 
> 时间：2013-04-16T16:19:39.423
> 
> 标签：php, security, passwords, cryptography, password-hash

我想知道这个功能（部分取自大约 2 岁的 phpBB 版本）是否足够好。

如果不是，为什么？
你将如何改变它（使现有用户无缝过渡）？

hash_pwd() 的结果将保存在数据库中。

```
function hash_pwd($password)
{
    $itoa64 = './0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';

    $random_state = $this->unique_id();
    $random = '';
    $count = 6;

    if (($fh = @fopen('/dev/urandom', 'rb')))
    {
        $random = fread($fh, $count);
        fclose($fh);
    }

    if (strlen($random) < $count)
    {
        $random = '';

        for ($i = 0; $i < $count; $i += 16)
        {
            $random_state = md5($this->unique_id() . $random_state);
            $random .= pack('H*', md5($random_state));
        }
        $random = substr($random, 0, $count);
    }

    $hash = $this->_hash_crypt_private($password, $this->_hash_gensalt_private($random, $itoa64), $itoa64);

    if (strlen($hash) == 34)
    {
        return $hash;
    }

    return false;
}

function unique_id()
{
    $val = microtime();
    $val = md5($val);

    return substr($val, 4, 16);
}

function _hash_crypt_private($password, $setting, &$itoa64)
{
    $output = '*';

    // Check for correct hash
    if (substr($setting, 0, 3) != '$H$')
    {
        return $output;
    }

    $count_log2 = strpos($itoa64, $setting[3]);

    if ($count_log2 < 7 || $count_log2 > 30)
    {
        return $output;
    }

    $count = 1 << $count_log2;
    $salt = substr($setting, 4, 8);

    if (strlen($salt) != 8)
    {
        return $output;
    }

    /**
    * We're kind of forced to use MD5 here since it's the only
    * cryptographic primitive available in all versions of PHP
    * currently in use.  To implement our own low-level crypto
    * in PHP would result in much worse performance and
    * consequently in lower iteration counts and hashes that are
    * quicker to crack (by non-PHP code).
    */
    if (PHP_VERSION >= 5)
    {
        $hash = md5($salt . $password, true);
        do
        {
            $hash = md5($hash . $password, true);
        }
        while (--$count);
    }
    else
    {
        $hash = pack('H*', md5($salt . $password));
        do
        {
            $hash = pack('H*', md5($hash . $password));
        }
        while (--$count);
    }

    $output = substr($setting, 0, 12);
    $output .= $this->_hash_encode64($hash, 16, $itoa64);

    return $output;
}

function _hash_gensalt_private($input, &$itoa64, $iteration_count_log2 = 6)
{
    if ($iteration_count_log2 < 4 || $iteration_count_log2 > 31)
    {
        $iteration_count_log2 = 8;
    }

    $output = '$H$';
    $output .= $itoa64[min($iteration_count_log2 + ((PHP_VERSION >= 5) ? 5 : 3), 30)];
    $output .= $this->_hash_encode64($input, 6, $itoa64);

    return $output;
}

function _hash_encode64($input, $count, &$itoa64)
{
    $output = '';
    $i = 0;

    do
    {
        $value = ord($input[$i++]);
        $output .= $itoa64[$value & 0x3f];

        if ($i < $count)
        {
            $value |= ord($input[$i]) << 8;
        }

        $output .= $itoa64[($value >> 6) & 0x3f];

        if ($i++ >= $count)
        {
            break;
        }

        if ($i < $count)
        {
            $value |= ord($input[$i]) << 16;
        }

        $output .= $itoa64[($value >> 12) & 0x3f];

        if ($i++ >= $count)
        {
            break;
        }

        $output .= $itoa64[($value >> 18) & 0x3f];
    }
    while ($i < $count);

    return $output;
} 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-04-16T18:04:30.017

您提供的代码是[PHPASS](http://www.openwall.com/phpass/)的一个端口，特别是“便携式”算法。注意 的资格`portable`。`phpass`如果您`true`作为第二个构造函数参数传递，这将仅适用于库。从这里开始，这个答案**只**`phpass`指可移植算法，而不是库本身。如果您没有明确指定，该库将默认执行 bcrypt ...**`portable`**

 **PHPBB 团队并没有自己开发这个（非常好的事情），而是直接从 phpass 移植过来的（有争议）。

我们应该在这里问几个问题：

# 坏吗？

简短的回答是否定的，这还不错。它提供了很好的安全性。如果你现在有这方面的代码，我不会急于下车。对于大多数用途来说已经足够了。但是话虽如此，如果你开始一个我不会选择的新项目，还有更好的选择。

# 有哪些弱点？

*   相对于[`pbkdf2`](http://en.wikipedia.org/wiki/PBKDF2)：`phpass`算法使用[`hash()`](http://www.php.net/hash)where`pbkdf2()`使用[`hash_hmac()`](http://www.php.net/hash_hmac)。现在，[HMAC](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)为内部的每个调用运行 2 个哈希，但 PHP 实现只需要大约执行单个调用的 1.6 倍`hash()`（C 不是很棒吗？）。因此，我们在执行 2 个哈希`hash_hmac`所需时间的 62% 中得到 2`hash()`个哈希。

    这意味着什么？好吧，对于*给定的运行时*，`pbkdf2`将比算法运行大约 37.5%**的**哈希`phpass`。在给定时间内更多的哈希 == 好，因为它会导致执行更多的计算。

    So`pbkdf2`大约`37.5%`比`phpass`使用相同原语时强（`md5`在这种情况下）。但`pbkdf2`也可以采用更强的原语。所以我们可以使用`pbkdf2`with`sha512`来获得相对于算法非常显着的优势`phpass`（主要是因为`sha512`它是一种*更难*的算法，计算量比 多`md5`）。

    这意味着不仅`pbkdf2`能够在相同的时间内产生更多的计算，而且能够产生*更难*的计算。

    话虽如此，差异并不*过分*显着。它非常可衡量，并且`pbkdf2`绝对比`phpass`.

*   相对于`bcrypt`：这很难进行比较。但让我们看看它的表面。`phpass`使用`md5`, 和 PHP 中的循环。`pbkdf2`使用任何原语（在 C 中）和 PHP 中的循环。`bcrypt`全部使用 C 中的自定义算法（这意味着它是与任何可用哈希不同的算法）。因此，蝙蝠的权利，`bcrypt`具有显着优势，因为算法全部在 C 中。这允许在单位时间内进行更多的“计算”。从而使其成为一种更高效的慢速算法（在给定的运行时间中计算更多）。

    但与它进行多少计算一样重要的是计算的质量。这可能是一篇完整的研究论文，但简而言之，它归结为 bcrypt 内部使用的计算比普通哈希函数更难执行的事实。

    一个更强大的例子是使用比普通散列函数大得多的内部状态`bcrypt`这一事实。使用 512 位内部状态来计算 1024 位块。而是使用大约 32kb 的内部状态来计算单个 576 位块。的内部状态比（和和）大得多的事实部分解释了.`bcrypt``SHA512``bcrypt``bcrypt``SHA512``md5``phpass``bcrypt`

# 应该避免

对于新项目，**绝对**。并不是说它不好。它不是。就是那里有明显更强大的算法（按数量级）。那么为什么不使用它们呢？

要进一步证明如何`bcrypt`更强大，请查看[来自 Password13 的幻灯片 (PDF)](http://passwords12.at.ifi.uio.no/Jeremi_Gosney_Password_Cracking_HPC_Passwords12.pdf)，它启动了一个 25 GPU 集群来破解密码哈希。以下是相关结果：

*   `md5($password)`
    *   每秒 1800 亿次猜测
    *   9.4 小时 - 所有可能的 8 个字符密码
*   `sha1($password)`
    *   每秒 610 亿次猜测
    *   27 小时 - 所有可能的 8 个字符密码
*   `md5crypt`（这与成本为 10 的 phpass*非常*相似）：
    *   每秒 7700 万次猜测
    *   2.5 年 - 所有可能的 8 个字符密码
*   `bcrypt`费用为`5`
    *   每秒 7.1 万次猜测
    *   2700 年 - 所有可能的 8 个字符密码

*注意：*所有可能的 8 个字符密码都使用 94 个字符集：

```
a-zA-Z0-9~`!@#$%^&*()_+-={}|[]\:";'<>,.?/ 
```

# 底线

因此，如果您正在编写新代码，毫无疑问使用`bcrypt`. 如果您现在已经`phpass`或`pbkdf2`正在生产中，您可能想要升级，但这并不是一个明确的“你很容易受到攻击”。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-04-16T16:25:13.480

**快速回答：**

使用[bcrypt（当它准备好时）](http://www.php.net/manual/en/ref.password.php)或来自 ircmaxell 的[password_compat](https://github.com/ircmaxell/password_compat)库——它是一个 bcrypt 库。

**长答案：**

这对于当前的技术来说太复杂和过时了。应该避免使用 Md5，仅仅加盐是不够的。使用 bcrypt 并免去您的头痛。

您可能会问自己为什么要使用特定的库？那么相同的功能将在 php 5.5 中可用，因此您不必更改任何编码。祝你好运，保持简单高效。慢也有利于登录和密码的东西。

> > 更新 1

@ Gumbo -> 没有 MD5 没有被破坏，但是像 MD5 这样的哈希现在和过去的主要目的是用于文件检查（你知道检查文件的内容是否可以信任而不是密码存储），因为哈希非常快速破译，因为你不会使用 Bcrypt 来检查文件的内容，因为你等待 30 - 45 秒......所以这意味着哈希是专门用来快速读取的。即使是 SHA512 与 bcrypt 相比仍然完全逊色。这就是为什么在 PHP 中推动像 Blowfish/Bcrypt 这样的强密码算法势在必行的原因。我们作为用户和程序员都必须扩展知识，即普通密码存储或低级散列算法不是答案 - 并且永远不应该用于此类敏感信息。

现在让 OP 过渡到新系统，您首先会向所有用户发送通知，说明“为了您的安全，密码加密系统已更新........”，然后您会问他们对于一次性密码更新，一旦您进行密码更新，您将使用名为 password_verify 的函数，如果您想最大限度地控制成本比率，您可以使用 password_needs_rehash，如果出于某种原因您选择更改与密码相关的成本.

这不需要大量代码来执行此操作，因为您在密码保护中获得的收益会权衡必须“重新编码”新密码系统的负面影响。

希望这能回答大多数问题，但 IRCmaxell 的答案在进一步深入不同算法的细节方面要好得多！祝你好运，非常感谢 ircmaxell！

> > 更新 2
> > 
> > 另外，这样存储的密码真的可以破解吗？如何？（我现在很好奇）

我的网络安全教授告诉我的任何事情和一切都被破坏了。我嘲笑他。现在我从他的眼里看到了东西……嗯，是的……那绝对是真的！

Bcrypt **CURRENTLY**是存储密码的最佳方法！但是，如果您研究 Scrypt，这似乎很有希望，但 PHP 不支持。尽管如此，任何东西都被破坏了，地下室的一些“极客”破解Bcrypt只是时间问题。但是现在我们是安全的.. 就像 IPv4 永远不会用完一样我们是安全的.. 哦等等？... ;)

希望这能回答您提出的问题，先生。也只是为了把它放在上下文中，我的系统的成本是 17，登录需要大约 20 - 大约 30 秒，但是当我将系统展示给我的教授和我的客户以及为什么它应该是强制性的时，他们喜欢它并且对他们受到保护感到放心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-21T17:01:56.247

我会选择 bcrypt。它很好 除了加入盐以防止彩虹表攻击之外，bcrypt 是一种自适应功能：随着时间的推移，可以增加迭代次数以使其变慢，因此它仍然可以抵抗暴力搜索攻击即使随着计算能力的增加。

实现：[如何在 PHP 中使用 bcrypt 对密码进行哈希处理？](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2013-04-20T01:42:15.880

（对不起我的英语一开始）

有几个问题，所有评论者在回答之前都必须问：

该代码将在哪里使用？

它将保护什么样的数据？

它会用于关键级别的系统吗？

好的，我们有一些用例。我正在为 out IS 使用简化的密码生成器，是的，它确实没有为“第三次世界大战做好准备”，但是该用户将密码告诉某人的机会，或者它会被他的计算机中的某些恶意软件泄露的机会仍然更大。

*   md5 很弱，使用最新的指纹生成器 (sha128,sha256,sha512)
*   使用随机长度的盐，如：

    ```
    private function generateSalt() {
      $salt = '';
      $i = rand(20, 40); //min,max length
      for($length = 0; $length < $i; $length++) {
        $salt .= chr(rand(33, 126));
      }        
      return $salt;
    } 
    ```

*   然后生成一些密码：

    ```
    private function generatePass() {
      $vocabulary = 'abcdefghijklmnopqrstuvwxyz0123456789';
      $password = '';
      $i = rand(7,10);
      for($length = 0; $length < $i; $length++) {
          $password .= substr($vocabulary,rand(0, 35),1);
      }        
      return $password.'-'; // avoid copy`n`paste :)
    } 
    ```

*   是的，密码应该更强，但用户永远不会记住它，它会被保存到浏览器或写在某个地方。期望和安全与现实。

    ```
    $newSalt = $this->generateSalt();
    $newPass = $this->generatePass();
    $newHash = hash('sha512', $newPass.':'.$newSalt); 
    // now store hash and salt into database 
    ```

*   有新的哈希，但还没有结束，真正的工作已经开始：

    1.  日志记录
    2.  会话保护
    3.  user,user+ip,ip temp/perm 禁止
    4.  ETC

**登录+注销+重新/生成密码：1 或 2 个 SQL 表和几 kb 的代码**

**关于安全性的其他事情：很多表，实际上不仅仅是几 kb 的代码****

# javascript - ExtJs - Javascript - 网格中的组合框（单元格编辑插件） - 网格/窗口后面的下拉列表

> ID：16042130
> 
> 赞同：1
> 
> 时间：2013-04-16T16:19:41.173
> 
> 标签：javascript, extjs, combobox, grid, behind

我有一个带有单元格编辑插件的网格。当我单击要编辑的单元格时，有时组合框的下拉列表位于网格/窗口后面（我看不到它，但如果我修改窗口大小，我可以看到它后面的组合框项目）。

我的代码如下所示（我有一个包含此表单的窗口）：

```
items: [{
    xtype: 'form',
    items: [
    me.currentMultipleValuesGrid = Ext.create('Ext.grid.Panel', {
        store: me.gridStoreToValidate,
        plugins: [Ext.create('Ext.grid.plugin.CellEditing', {
            clicksToEdit: 1,
            delay: 10
        })],
        listeners: {
            validateedit: function (editor, cell, eOpts) {
                //cell.cancel = true;
            }
        },
        columns: [{
            header: GTR(CLNAME(me), 'colSource.Text', 'Source'),
            dataIndex: 'source',
            flex: 1
        }, {
            dataIndex: 'name',
            header: GTR(CLNAME(me), 'colLinkDestination.Text', 'Link destination'),
            editor: {
                xtype: 'combobox',
                queryMode: 'local',
                valueField: 'nr',
                displayField: 'name',
                store: me.comboBoxEditorStore,
                listeners: {
                    change: function (thisCmb, newValue, oldValue) {

                    },
                    beforerender: function (thisCmb, eOpts) {

                    }
                }
            },
            flex: 1
        }, {
            dataIndex: 'linkdestination',
            hidden: true
        }]
    })]
}] 
```

我认为这是一个布局问题，所以我尝试了分配给窗口、网格或表单的不同布局（锚点和适合），以及它们的各种组合。至今没有成功。有任何想法吗？谢谢你。我正在使用 Extjs 4.0.7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-12T22:17:15.163

我不久前解决了这个问题。回来发布答案，以防有人需要。**这似乎是一个 Sencha 错误，当窗口是模态**时（就像我的情况一样），它会导致下拉列表显示在窗口后面。我设法通过在组合设置中添加一个 CSS 类到组合的下拉列表中来解决此问题：

```
listConfig: { cls: 'clsZIndexMax' } 
```

`clsZIndexMax`我的 CSS 类在哪里包含`z-index: 100000 !important;`

PS：我在4.0.7版本有这个bug，不知道他们是否已经在以后的版本中解决了。

# soap - 不能使用强制 uuid（或其他与模式相关的必须类型）作为 rpc 参数

> ID：16042132
> 
> 赞同：0
> 
> 时间：2013-04-16T16:19:48.263
> 
> 标签：soap, python-2.7, django-1.5, spyne

我有这样的网络服务：

```
class ExampleService(ServiceBase):
    __tns__ = 'http://xml.company.com/ns/example/'

    @rpc(Mandatory.Uuid, _returns=Unicode)
    def say_my_uuid(ctx, uuid):
        return 'Your UUID: %s' % uuid

    @classmethod
    def dispatch(cls):
        application = Application([cls],
            tns=cls.__tns__,
            interface=Wsdl11(),
            in_protocol=Soap11(validator='lxml'),
            out_protocol=Soap11(cleanup_namespaces=True)
        )
        return csrf_exempt(DjangoApplication(application)) 
```

我可以`Uuid`用作参数，但是当我尝试其强制版本时，服务器响应错误：

```
XMLSchemaParseError at /
simple type 'MandatoryUuid', attribute 'base': The QName value '{http://www.w3.org/2001/XMLSchema}MandatoryString' does not resolve to a(n) simple type definition., line 12
Exception Location: D:\Program Files\Python27\lib\site-packages\spyne\interface\xml_schema\_base.py in build_validation_schema, line 183 
```

为什么我不能自定义`Uuid`类型？如果我从其定义中删除模式，那么一切都很好，但无论如何都必须有 UUID 的模式。有什么解决方法吗？也许另一个肥皂框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T22:53:40.783

我刚刚发布了包含此问题的修复程序的 Spyne-2.9.5。

# google-tv - GoogleTV V3 QSB 建议，更改图像纵横比

> ID：16042133
> 
> 赞同：1
> 
> 时间：2013-04-16T16:19:51.483
> 
> 标签：google-tv, android-qsb

我遇到了一个有趣的问题；我的应用程序通过 SUGGEST_COLUMN_ICON_1 向 QSB 提供搜索建议以及电影海报。在 v3 之前的 GTV 版本中，我可以正确显示海报。在 v3 上，建议显示（在其他下），只有海报的一部分显示在正方形中。电视和电影建议，从黄金时段的 qsb 中适当大小的建议海报，有没有办法改变显示的建议图标的方面，或者可以用于建议的不同字段？

编辑：代码

我使用一个基本的内容提供者来阅读来自 sqlite 的建议；我使用以下预测；除此之外，我不做任何事情。

```
 projection = new String[] { Tables.MEDIA_SEARCH + ".rowid AS " + BaseColumns._ID,
                            SearchManager.SUGGEST_COLUMN_TEXT_1,
                            SearchManager.SUGGEST_COLUMN_TEXT_2,
                            SearchManager.SUGGEST_COLUMN_INTENT_DATA,
                            SearchManager.SUGGEST_COLUMN_INTENT_DATA_ID,
                            SearchManager.SUGGEST_COLUMN_INTENT_EXTRA_DATA, 
                            SearchManager.SUGGEST_COLUMN_ICON_1 }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:04:55.803

我就此与工程团队和设计团队进行了交谈。在 V3 上，决定将第 3 方提供给 QSB 的图像限制为您遇到的方形格式。将图像提供给 qsb 并保持纵横比的建议方法是提供一个方形图像，您可以在其中管理其内容（1:1 比例）。不幸的是，没有办法针对您的情况强制在最新版本中进行方面更正。

# java - HTTP 请求未返回所需的 json

> ID：16042134
> 
> 赞同：0
> 
> 时间：2013-04-16T16:19:53.073
> 
> 标签：java, json, http, httpclient

我正在尝试向应该返回 json 响应的网站发送 http 请求。问题是我没有得到 json 数据。但是当我将 url 粘贴到浏览器中时，它会显示 json 输出。我是新手。请帮忙。

这是我的代码

```
HttpClient client = new DefaultHttpClient();
String url="http://directclientvendors.com/news24/api/get.php?type=news";
HttpGet request = new HttpGet(url);
HttpResponse response;
response = client.execute(request);
BufferedReader br = 
    new BufferedReader(new InputStreamReader(response.getEntity().getContent()));

String line = "";

while(br.ready())
{
    line+=br.readLine();
}
System.out.println("line "+line); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:22:53.420

您应该执行一个`GET`请求，而不是一个`POST`. 请将请求类型更改为`HttpGet`。当您将 URL 粘贴到地址栏并按 Enter 时，浏览器会`GET`在[URL上执行。](http://directclientvendors.com/news24/api/get.php?type=news)

另外使用 Reader + StringBuilder / JsonReader / GSON 从 URL 的响应内容中读取。字符串连接会导致不必要地创建其他对象。

[编辑]

令我惊讶的是，即使`POST`调用了获取资源，API 调用也能正常工作。问题一定出在你的解析逻辑上。使用 a`JsonReader`对我来说很好。这只是模板代码，但您可以填写其余部分以获取其他 JSON 元素。无论是否`POST`有效，您仍然应该使用`GET`此调用。

```
 HttpClient client = new DefaultHttpClient();
        HttpGet request = new HttpGet("http://directclientvendors.com/news24/api/get.php?type=news");
        HttpResponse response = client.execute(request);
        InputStream content = response.getEntity().getContent();
        JsonReader jsonReader = new JsonReader(new InputStreamReader(content, "UTF-8"));
        jsonReader.beginObject();
        if(jsonReader.hasNext())
        {
            System.out.println(jsonReader.nextName()); // prints 'news'
            // BEGIN_ARRAY etc to parse the rest
        }
        // END_OBJECT and cleanup 
```

# string - 在 VBScript 中使用字符串中的子参数

> ID：16042136
> 
> 赞同：1
> 
> 时间：2013-04-16T16:20:03.817
> 
> 标签：string, vbscript, putty, string-concatenation

我有一个网页可以拉动服务器的动态列表，并且我希望能够使用选择的 Linux 框启动 putty/winSCP。我似乎无法有效地传递参数。

```
 <a href="#" onclick="putty('10.201.38.14');">link</a>
    <script language="vbscript"> 
    Sub putty(hostIP) 
        Set oShell = CreateObject("WScript.Shell") 
        oShell.run """C:\Program Files (x86)\putty\putty.exe"" -ssh hostIP" 
        Set oShell = Nothing 
    End sub 
    </script> 
```

有任何想法吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:49:33.323

您正在传递常量字符串“hostIP”，而不是`hostIP`参数值。

改为这样做：

```
oShell.run """C:\Program Files (x86)\putty\putty.exe"" -ssh " & hostIP 
```

在 VB 中，`&`is 字符串连接运算符和`hostIP`is 对参数的引用（与`"hostIP"`什么是字符串文字相反）。

# jquery - 动态新规则验证不起作用

> ID：16042140
> 
> 赞同：2
> 
> 时间：2013-04-16T16:20:31.223
> 
> 标签：jquery, asp.net-mvc, jquery-validate

我们最近决定迁移到`jquery 1.9.1`，并且由于我们的项目在`ASP.NET MVC 3`，它具有`jquery.validate`和`jquery.validate.unobtrusive`。一切正常，这些脚本和通过属性属性进行的 MVC 3 验证之间的默认集成运行良好。

然而，自从更新以来，我们还必须更新验证脚本，当我们这样做时，那些“即时”添加的规则停止工作。但更奇怪的是，它只发生在某些属性上。在其他人身上，通过`$(form).validate({//things to validate})`规则简单地适用。

让我给你一些代码来更好地解释它。这是 ViewModel 属性（这是一个简化的示例）：

```
[DataType(DataType.Password)]
        [Required(ErrorMessage = "*Required Field")]
        [Remote("ValidatePassword", "Validator", AdditionalFields = "User")]
        public string SenhaAnterior { get; set; }

[HiddenInput]
        public int VerificacaoSeguranca { get; set; } 
```

这是视图

```
 @using (Html.BeginForm("...", "...", null, FormMethod.Post, new { @id = "formMSenha" }))
        { 
    <div id="container">
    @Html.HiddenFor(model => model.VerificacaoSeguranca, new { @id = "hdSeguranca" })
@Html.ValidationMessageFor(model => model.VerificacaoSeguranca)
    <div>
                    <label>
                        Senha anterior:
                        @Html.PasswordFor(model => model.SenhaAnterior, new { @id = "txtSenhaAnterior" })
                        @Html.ValidationMessageFor(model => model.SenhaAnterior)
                    </label>
                </div>
    </div>
    } 
```

还有剧本

```
//Even if try this, it still doesn't work
$('#formMSenha').validate({
                rules: {
                    hdSeguranca: {
                        min: 4
                    }
                },
                messages: {
                    hdSeguranca: 'Your password lacks security. Try harder'
                }
            });

    //Since this is a partial view, i have to parse the new added form so the validation rules apply
    $.validator.unobtrusive.parse($("#formMSenha"));

                //Minimum security level
                $('#hdSeguranca').rules('add', { min: 4, messages: { min: 'Your password lack security. Try adding more numbers, letters ou symbols.'} }); 
```

在更新之前，新的添加规则有效，但现在无效。就像新规则永远不会被验证器解析或者它无法识别它一样。但奇怪的是如果我这样做

```
('#formMSenha').validate({
                rules: {
                    txtSenhaAnterior: {
                        min: 4
                    }
                },
                messages: {
                    hdSeguranca: 'New test'
                }
            });

$('#txtSenhaAnterior').rules('add', { min: 4, messages: { min: 'Newer teste'} }); 
```

验证适用！我完全不知道为什么。

**编辑**

正如@Sparky 所建议的那样，我正在展示这个 PartialView 的渲染 HTML（它是 jquery 对话框），并进行了一些小的修改。

```
<div id="msenhaContainer">
<form method="post" id="formMSenha" action="..." novalidate="novalidate">        <h2>
            Atualize sua senha para uma senha complexa</h2>
        <div id="campos">
            <input type="hidden" value="0" name="VerificacaoSeguranca" id="hdSeguranca" data-val-required="The VerificacaoSeguranca field is required." data-val-number="The field VerificacaoSeguranca must be a number." data-val="true">
            <div>
                <label>
                    Senha anterior:
                    <input type="password" name="SenhaAnterior" id="txtSenhaAnterior" data-val-required="*Campo obrigat&amp;#243;rio" data-val-remote-url="/Validator/ValidarSenhaAnterior" data-val-remote-additionalfields="*.SenhaAnterior,*.Usuario" data-val-remote="&amp;#39;SenhaAnterior&amp;#39; is invalid." data-val="true" class="input-validation-error">
                    <span data-valmsg-replace="true" data-valmsg-for="SenhaAnterior" class="field-validation-error"><span for="txtSenhaAnterior" class="">*Campo obrigatório</span></span>
                </label>
            </div>
            <div>
                <label>
                    Nova Senha: <input type="password" name="SenhaNova" maxlength="18" id="txtSenhaNova" data-val-required="*Campo obrigat&amp;#243;rio" data-val="true" class="valid">
                    <span data-valmsg-replace="true" data-valmsg-for="SenhaNova" class="field-validation-valid"></span>
                </label>
            </div>
            <div>
                <label>
                    Nova Senha Confirmação: <input type="password" name="SenhaNovaConfirmacao" maxlength="18" id="txtSenhaNovaConf" data-val-required="*Campo obrigat&amp;#243;rio" data-val-equalto-other="*.SenhaNova" data-val-equalto="As senhas n&amp;#227;o s&amp;#227;o as mesmas" data-val="true" class="valid">
                    <span data-valmsg-replace="true" data-valmsg-for="SenhaNovaConfirmacao" class="field-validation-valid"></span>
                </label>
            </div>
            <br>
            <label>
                Força da Senha</label>
            <div id="progressoSenha" class="ui-progressbar ui-widget ui-widget-content ui-corner-all" role="progressbar" aria-valuemin="0" aria-valuemax="6" aria-valuenow="2">
            <div class="ui-progressbar-value ui-widget-header ui-corner-left" style="display: block; width: 33%; background: none repeat scroll 0% 0% rgb(209, 125, 14);"></div></div>
            <span data-valmsg-replace="true" data-valmsg-for="VerificacaoSeguranca" class="field-validation-valid"></span>
            <div style="text-align: center" id="descricaoForcaSenha">Fraca</div>
            <a id="regrasSenha" href="#" title="Tooltip com as regras aqui!">Regras da senha complexa</a>
        </div>
<input type="hidden" name="freebird" data-val-required="If i stay, will still remember me" id="freebird"></form></div>

<script type="text/javascript">
    //Xhalent's function
    (function ($) {
        $.validator.unobtrusive.parseDynamicContent = function (selector) {
            //use the normal unobstrusive.parse method
            $.validator.unobtrusive.parse(selector);

            //get the relevant form
            var form = $(selector).first().closest('form');

            //get the collections of unobstrusive validators, and jquery validators
            //and compare the two
            var unobtrusiveValidation = form.data('unobtrusiveValidation');
            var validator = form.validate();

            $.each(unobtrusiveValidation.options.rules, function (elname, elrules) {
                if (validator.settings.rules[elname] == undefined) {
                    var args = {};
                    $.extend(args, elrules);
                    args.messages = unobtrusiveValidation.options.messages[elname];
                    //edit:use quoted strings for the name selector
                    $("[name='" + elname + "']").rules("add", args);
                } else {
                    $.each(elrules, function (rulename, data) {
                        if (validator.settings.rules[elname][rulename] == undefined) {
                            var args = {};
                            args[rulename] = data;
                            args.messages = unobtrusiveValidation.options.messages[elname][rulename];
                            //edit:use quoted strings for the name selector
                            $("[name='" + elname + "']").rules("add", args);
                        }
                    });
                }
            });
        }
    })($);
    //DOM ready
    $(function () {
    //Since this is a test, there's no reason to submit the form to the server
        $.validator.setDefaults({
            debug: true
        });

        //Trying to remove the validator to revalidate the form with the new added rule
        $("#formMSenha").removeData("validator").removeData("unobtrusiveValidation");

        $.validator.unobtrusive.parse($("#formMSenha"));

        $('#hdSeguranca').rules('add', { min: 4, messages: { min: 'Your password lacks security'} });

        //Got this example on Xhalent's blog, but it didn't work either
        //        $.validator.unobtrusive.parseDynamicContent($('#hdSeguranca'));

        $.validator.unobtrusive.parse($("#formMSenha"));

        $('#progressoSenha').progressbar({ max: 6, value: 0 });

        $('#txtSenhaNova').keyup(function () {
            VerifyPasswordStrength($(this).val());
        });

        $('#regrasSenha').tooltip({ content: function () {
            //            var texto = $('&lt;div style="display: inline" &gt;&lt;/div&gt;');
            //            texto.html('Regras da senha complexa:');
            //            texto.append("&lt;ul&gt;").append('&lt;li&gt;').append(
            //            $('&lt;span&gt;').html('Deve possuir pelo menos 6 caracteres')).insertAfter($('&lt;li&gt;').append('&lt;span&gt;').html('Deve ter ao menos um número')).
            //            insertAfter($('&lt;li&gt;').append('&lt;span&gt;').html('Deve ter ao menos um caractere especial. Ex:"! @ # $ % &amp;" '));
            //            return texto;

            var textoSenha = $('#descSenha').html();
            return textoSenha;
        }
        });

        $('#formMSenha').submit(function () {
            $.ajax({
                type: 'post',
                url: '...',
                data: $('#formMSenha').serialize(),
                dataType: 'json',
                success: function (data) {
                    $.growlUI('Sucesso', 'Sucesso', 'Flawlessly done!');

                    setTimeout(function () { window.location.replace('/') }, 2000);
                }
            });

            return false;
        });

    });                                   //JQUERY END
    function VerifyPasswordStrength(password) {
        //Removed the security code, but what it does is validate the input
        //to check if the user abide to the safety rules
        //When everything is done, it assigns a value to the hidden var
        //The mininum score required is 4\. So if the user don't hit 4 points
        //it can't let him proceed and submit the form
        $('#hdSeguranca').val(passwordScore);

        var progressbar = $("#progressoSenha");
        var progressbarValue = progressbar.find(".ui-progressbar-value");
        var cor = '#9c9999';

        switch (judite) {
            case 1:
                cor = '#790f0f'; //red
                break;
            case 2:
                cor = '#d17d0e'; //orange
                break;
            case 3:
                cor = '#e1e40b'; //yellow  
                break;
            case 4:
                cor = '#129f0a'; //green
                break;
            case 5:
                cor = '#0768c7'; //blue
                break;
            case 6:
                cor = '#92dae8'; //brighter blue
                break;
        }

        progressbarValue.css({ "background": '' + cor });

        $('#progressoSenha').progressbar("option", "value", passwordScore);

        $('#descricaoForcaSenha').html(desc[passwordScore]);
    }

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T20:58:33.823

您尚未显示呈现的 HTML，但看起来您*只是*在创建和引用`id`属性。您在其中`.validate()`用于声明规则的字段名称应该与输入的属性*匹配*，而**不是**.`name`**`id`**

 **为了让这个插件正常工作，所有输入元素都必须包含一个唯一的`name`属性。

**HTML**：

```
<input type="text" name="myfield" id="something" /> 
```

**jQuery** :

```
$(document).ready(function() {

    $('#myform').validate({
        rules: {
            myfield: { // <-- this is the NAME attribute
                required: true,
                minlength: 5
            }
        }
    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:58:57.823

看来 1.9 版本之后，**默认情况下 validate 脚本会忽略 hidden field validation**。所以我添加验证规则的尝试是正确的，问题是它被添加到隐藏字段。

您可以在此处查看更改日志：http: [//jquery.bassistance.de/validate/changelog.txt](http://jquery.bassistance.de/validate/changelog.txt)

但是如果您需要验证隐藏字段，您可以使用下面的代码更改脚本忽略

```
$.validator.setDefaults({ 
    ignore: [],
    // any other default options and/or rules
}); 
```**

# rest - 码头自定义状态消息？？

> ID：16042141
> 
> 赞同：1
> 
> 时间：2013-04-16T16:20:48.787
> 
> 标签：rest, clojure, jetty, embedded-jetty

我正在用 clojure 编写一个服务（使用 ring 和 compojure），它应该会改变状态消息。它在嵌入式 Jetty 8 上运行。例如我有

```
200 OK 
```

我想要类似的东西

```
200 <custome message> 
```

在 EJB 世界中，有可能设置标头“X-Http-Status-Message”，它在幕后发挥作用并更改消息作为响应。

Jetty 中是否有任何标题允许我做同样的事情？或者在clojure中有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:25:04.837

根据 Ring 文档，您只能设置状态码，而不是消息：

[https://github.com/mmcgrana/ring/wiki/Concepts](https://github.com/mmcgrana/ring/wiki/Concepts)

此外，该`ring.util.servlet/set-status`函数调用[`javax.servlet.http.HttpServletResponse .setStatus(int)`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html#setStatus%28int%29)：

```
(defn set-status
  "Update a HttpServletResponse with a status code."
  [^HttpServletResponse response, status]
  (.setStatus response status)) 
```

整个实现在这里：[https ://github.com/ring-clojure/ring/blob/master/ring-servlet/src/ring/util/servlet.clj#L64](https://github.com/ring-clojure/ring/blob/master/ring-servlet/src/ring/util/servlet.clj#L64)

更改 Ring 以添加对状态消息的可选支持应该是相当简单的。

我想可以将更改引入`ring.util.servlet/update-servlet-response`函数：

```
(defn update-servlet-response
  "Update the HttpServletResponse using a response map."
  [^HttpServletResponse response, {:keys [status headers body]}]
  (when-not response
    (throw (Exception. "Null response given.")))
  (when status
    (set-status response status))
  (doto response
    (set-headers headers)
    (set-body body))) 
```

例如，通过向响应映射添加状态消息键。

[https://github.com/ring-clojure/ring/blob/master/ring-servlet/src/ring/util/servlet.clj#L105](https://github.com/ring-clojure/ring/blob/master/ring-servlet/src/ring/util/servlet.clj#L105)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:22:46.483

不是这样的魔术头。

状态原因必须与 Jetty 中同一调用中的状态代码一起设置。
您可以使用[`javax.servlet.http.HttpServletResponse.setStatus(int, String)`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html#setStatus%28int,%20java.lang.String%29)或[`org.eclipse.jetty.server.Response.setStatus(int, String)`](http://download.eclipse.org/jetty/stable-8/apidocs/org/eclipse/jetty/server/Response.html#setStatus%28int,%20java.lang.String%29)。

例子：

```
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response)
throws ServletException, IOException
{
    response.setStatus(HttpServletResponse.SC_OK, "Alrighty");
} 
```

请注意，某些错误条件无法覆盖此状态原因。但通常，使用 of[`HttpServletResponse.sendError(int, String)`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html#sendError%28int,%20java.lang.String%29)会如您所愿。

# c# - 如何通过单击在网格视图下拉列表中创建组合框？

> ID：16042142
> 
> 赞同：2
> 
> 时间：2013-04-16T16:20:49.017
> 
> 标签：c#, winforms

我在网格视图中有一个组合框，需要单击 3 次才能打开下拉菜单。我想一键激活它。

据我所知，第一次单击选择单元格，第二次选择控件（组合框），第三次单击使组合框打开下拉菜单。随后单击同一单元格将按照用户的期望打开和关闭下拉菜单。

来自评论：

```
List<string> values = new List<string>();
values.Add("Text");
DataGridViewComboBoxColumn col = new DataGridViewComboBoxColumn();
col.DataSource = values;
dataGridView.Columns.Add(col);
dataGridView.Rows.Add(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T20:02:03.353

如果您指的是 DataGridView 控件，请尝试设置此属性：

```
dataGridView1.EditMode = DataGridViewEditMode.EditOnEnter; 
```

# ruby - eventmachine回调声明顺序

> ID：16042144
> 
> 赞同：0
> 
> 时间：2013-04-16T16:21:00.473
> 
> 标签：ruby, eventmachine

在我见过的所有 eventmachine 代码中，回调/错误返回是在方法的实际调用之后声明的。

这是一个简单的例子：

```
about = EventMachine::HttpRequest.new('http://google.ca/search?q=eventmachine').get
about.callback { # callback nesting, ad infinitum }
about.errback  { # error-handling code } 
```

*为什么要在AFTER*声明回调和错误返回？EM::HttpRequest 不可能已经完成并带有某种成功或错误状态吗？EM 如何保证回调和错误返回被实际捕获？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:54:29.400

1.  该`.get`调用仅设置请求。 [模块中的`get`请求](https://github.com/igrigorik/em-http-request/blob/master/lib/em-http/http_connection.rb#L4)方法`EM::HttpRequest`。

2.  `EM::HttpRequest`使用类似于开关的[`EM::Deferrable`模块。](https://github.com/eventmachine/eventmachine/blob/master/lib/em/deferrable.rb)

将这两者加在一起，您将获得一个功能，其中首先构建请求并等待收到响应。因此，对于`EM.run do..end`循环的第一次迭代，建立连接，注册回调，当收到响应时，将在下一次迭代中处理/每当收到响应时，`set_deferrable_status`设置为`:succeeded`or`:failed`和相应的回调/errback 被执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T18:03:22.690

拿下面的代码....

```
http = EM::HttpRequest.new('http://google.com').get

http.callback {puts "it was a great call"}
http.errback { puts "it was a bad call" } 
```

您可能会认为，如果异步请求发生的速度快于我们设置回调的速度，则可能永远不会调用回调。该请求是异步发生的，因此我们可能认为这是一种可能性。但事实并非如此。如果我们在实际设置回调之间放置一些运行时间很长的代码会怎样？我将演示并表明回调仍然有效。

```
http = EM::HttpRequest.new('http://google.com').get

#Some really long running code
100000000000.times do 
  #some really long running code
end

http.callback {puts "it was a great call"}
http.errback { puts "it was a bad call" } 
```

这种情况下的请求在真正长时间运行的代码完成之前很久就完成了，但仍然会调用回调？为什么？原因是因为 HttpRequest 是可延迟的。它继承自它。尽管 Deferable 是可以运行 asyc 的东西，但 Defferables 有一个状态。成功或失败，我们仍然在一个名为 http 的变量中引用了该可延迟对象。

当我们调用 http.callback {"puts "it was a great call"} 时，我们立即检查 deffereable 的状态，在本例中为 http，是否为成功。如果是，立即调用回调。否则设置它这样当 defferable 以“成功”状态结束时调用它。就这么简单。只要我们有对该 defferable 的引用，我们就可以随时设置回调。

当我实际查看 Defferable 的源代码时，我的猜测得到了证实。 [http://eventmachine.rubyforge.org/EventMachine/Deferrable.html#callback-instance_method](http://eventmachine.rubyforge.org/EventMachine/Deferrable.html#callback-instance_method)

罗伊斯

# javascript - phonegap 上的 db.transaction 问题

> ID：16042146
> 
> 赞同：1
> 
> 时间：2013-04-16T16:21:09.330
> 
> 标签：javascript, android, cordova, web-sql

我有一个函数可以将一些数据保存到我的数据库中，并且在 cordova 2.4 上一切正常，但是我升级到了 cordova 2.6，我的数据库开始出现一些问题，它变得很慢并且开始出现回调问题。

**我的第一个问题**是，当我调用 tx.executeSql 时，给 db.transaction 的回调会触发

```
function populateDB(tx) {
     tx.executeSql('DROP TABLE IF EXISTS DEMO'); /* <-- succesCB is fired */
     tx.executeSql('CREATE TABLE IF NOT EXISTS DEMO (id unique, data)'); /* <-- succesCB is fired again */
     tx.executeSql('INSERT INTO DEMO (id, data) VALUES (1, "First row")'); /* <-- succesCB is fired again */
     tx.executeSql('INSERT INTO DEMO (id, data) VALUES (2, "Second row")'); /* <-- succesCB is fired again */
}

function errorCB(err) {
    alert("Error processing SQL: "+err.code);
}

function successCB() {
    alert("success!");
}

var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);
db.transaction(populateDB, errorCB, successCB); 
```

在升级之前，它在事务函数结束时被触发（在本例中为 populateDB），在 chrome 上也被触发。

哪个是正确的行为？在 executeSql 或 populateDB 结束时触发？

我在 Galaxy S2 (4.1.2)、Asus Transformer TF101 (4.0.3)、Galaxy Tab (4.0.4) 上有相同的行为

我的第二个问题是，当我插入所有数据时，它需要很长时间，对于 13 000 条记录，我尝试插入类似的值大约需要 5 分钟`INSERT INTO mytable (id, x) VALUES (1, "sas"), (2, "dsfdsf"), ...`，而且速度要快得多，但它仅在使用 sqlite >= 3.7.11 时才有效，所以我尝试了 UNION SELECT 模式，但速度真的很慢。

一些想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T00:05:13.113

我不确定您的问题，但我看到了几个问题。

WebSQL 版本化打开被破坏。建议开启流程为无版本开启，然后使用版本变更事务，如下

```
var db = window.openDatabase("Database", '', "Cordova Demo", 200000)
if (db.version != '1.0') {
   db.versionChange(...)
} 
```

另一种是从请求回调中重用 tx。

```
tx.executeSql('DROP TABLE IF EXISTS DEMO', [], function (t, r) {
  t.executeSql('CREATE TABLE IF NOT EXISTS DEMO (id unique, data)');
}); 
```

从您的代码中，tx 执行没有排序。浏览器可以按任意顺序执行所有四个 then。

关于两个`window.openDatabase`，一个是浏览器原生（如果支持），另一个是通过插件通过 phonegap 进行的 polyfill。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:48:54.553

最好使用 html5 数据库而不是 phonegap 的数据库。

# ios - 使用 RestKit 解析复杂的错误对象

> ID：16042148
> 
> 赞同：2
> 
> 时间：2013-04-16T16:21:13.973
> 
> 标签：ios, restkit

我在弄清楚如何使用 RestKit 正确处理复杂的错误对象时遇到问题。我看到的所有示例都详细说明了如何将任意深度的嵌套字符串映射到 NSError *errorMessage 属性。例如：

```
{
  meta: {status: 406},
  error: {message: "email is invalid"}
} 
```

我见过人们谈论使用“error.message”->“errorMessage”的键映射，但我想要错误响应中的所有信息。例如，我想在以下 406 错误响应中访问整个 error_object 字典：

```
{
  meta: {code: 406},
  error_object: {attributes: {email: ["is invalid"]}}
} 
```

关于如何做到这一点的任何想法？我目前正在使用 [RKObjectManager sharedManager] postObject:... 。由于失败回调只需要 NSError，我知道我可能需要使用 RestKit 的其他一些机制来完成我想要的行为。

# api - 收集结果的 RESTful API 中应该如何处理异常？

> ID：16042152
> 
> 赞同：8
> 
> 时间：2013-04-16T16:21:42.260
> 
> 标签：api, rest, restful-url, api-design

我们正在设计一个 RESTful API 来返回文档集合。我们的初始实现使用 HTTP 状态代码来指示请求是否无法完成。这似乎是一种被广泛接受的最佳实践（例如，参见[此处](https://blog.apigee.com/detail/restful_api_design_what_about_errors)）。

我们最近遇到了一个用户提取 1000 个文档的问题。其中一个文档检索失败，因此我们返回了 HTTP 500 状态代码。

另一种方法是返回一个 HTTP 200 状态代码，其中包含我们能够检索到的 999 个文档的有效负载，然后是一个错误集合，指示失败的那个。

这种替代方法是否违反了 RESTful 原则？这种情况应该如何处理？除了这两种方法之外，还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:37:45.397

是的，我认为只要您记录您返回的数据可以包含“错误”集合，这是完全可以接受的。这意味着无论您使用什么语义媒体类型来描述此文档集合，都应该具有描述文档集合应该是什么样子以及错误集合应该是什么样子的文档。然后，客户可以决定如何处理这些信息。

例如，如果您将其作为 JSON 返回（只是一个示例），您可能有一个类似的媒体类型`application/json+documents`，它可能看起来像这样：

```
{ data : {
    documents: [ ... ], //document objects
    errors: [ ... ] //error objects
} 
```

然后，您将获得描述文档外观以及错误外观的文档。在真正的 RESTful API 中，记录的是媒体类型而不是调用，因为在真正的 RESTful API 中只有一个端点，其他所有内容都是通过该初始端点以及语义媒体类型“发现”的。因此，只要您记录了可能出现的错误，并描述了错误将被传递的格式，就应该没问题。

这也不是“异常”情况，因为在您的情况下，可以预见客户可能无法检索所有文档。因此，可以将这一事实告知客户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:37:33.050

在这样的特殊情况下，有时您必须跨越一条界限：让用户参与进来。

通知用户负载过大并返回内部服务器错误并非没有道理。

# javascript - 在页面加载时运行脚本

> ID：16042153
> 
> 赞同：1
> 
> 时间：2013-04-16T16:21:45.397
> 
> 标签：javascript, jquery

我正在使用 CMS 系统，并且对我可以放置代码的位置有限制（目前）。我尝试使用的脚本必须在表单之后加载，并且它可以在 Dreamweaver 中成功运行。但是现在我将内容移到 CMS 中，我必须在标题中而不是在表单之后运行脚本。我试图在页面加载后使用它来加载它，如下所示：

```
<script>
$(document).ready(function() {
//You should create the validator only after the definition of the HTML form
var frmvalidator  = new Validator("leadform");
frmvalidator.EnableOnPageErrorDisplaySingleBox();
frmvalidator.EnableMsgsTogether();
frmvalidator.addValidation("first_name","req","Please enter your first name.");
frmvalidator.addValidation("first_name","maxlen=40","Max length for first name is 40.");
frmvalidator.addValidation("first_name","alpha","Please enter your first name.");
frmvalidator.addValidation("last_name","req","Please enter your last name.");
frmvalidator.addValidation("last_name","maxlen=40","Max length for last name is 40.");
frmvalidator.addValidation("last_name","alpha","Please enter your last name.");
frmvalidator.addValidation("email","req","Please enter your e-mail address.");
frmvalidator.addValidation("email","email","Please enter your e-mail address.");
frmvalidator.addValidation("state","dontselect=0","Please select your state.");
});
</script> 
```

我必须相信我只是写错了，但我找不到任何可以帮助我做到这一点的例子。显然我是一个菜鸟编码器 - 任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:31:39.737

```
$(document).ready(function(event){

// insert code here

}); 
```

上面的代码将一直等到文档被加载（这意味着包括您的表单在内的所有 html 都被加载到页面中），无论它是在您的 html 的头部还是正文中。您只需要确保在使用 jQuery 时将带有 jQ​​uery 代码的脚本标签放在加载 jQuery 的脚本标签**之后。**这是一个加载 jQuery 1.9.1 版本的示例：

```
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<!-- make sure your code is added after jQuery -->
<script src='pathtoyourscript/yourScript.js'></script> 
```

# r - 通过 RasterStack 对象的单个单元的速度优化循环

> ID：16042154
> 
> 赞同：3
> 
> 时间：2013-04-16T16:21:45.620
> 
> 标签：r, parallel-processing, raster

我正在使用两个 RasterStack 对象，每个对象由代表单个时间步长的十层组成。

```
# Mock data
pred.rst.stck <- do.call("stack", lapply(seq(10), function(i) {
  pred.rst <- raster(nrows = 15, ncols = 15, xmn= 0, xmx = 10, ymn = 0, ymx = 10)
  pred.rst[] <- rnorm(225, 50, 10)
  return(pred.rst)
})
resp.rst.stck <- do.call("stack", lapply(seq(10), function(i) {
  resp.rst <- raster(nrows = 10, ncols = 10, xmn = 0, xmx = 10, ymn = 0, ymx = 10)
  resp.rst[] <- rnorm(100, 50, 10)
  return(resp.rst)
}) 
```

`pred.rst.stck`用作一组预测变量和`resp.rst.stck`一组响应变量。对于预测器 RasterStack 的每个单个单元格，我想在响应 RasterStack 的每个单元格上拟合一个线性模型，为每个拟合模型提取相应的 R 平方并将它们相加。长话短说，这是我迄今为止使用 R`parallel`包的最快方法：

```
# Parallelization
library(parallel)
n.cores <- detectCores()
clstr <- makePSOCKcluster(n.cores)

# Extract cell values from RasterStack objects
pred.vals <- getValues(pred)
resp.vals <- getValues(resp)
clusterExport(clstr, c("pred.vals", "resp.vals"))

# Loop through all predictor cells
rsq.sums <- parLapply(clstr, seq(nrow(pred.vals)), function(i) {
  # For each predictor cell, loop through all response cells, 
  # fit linear model, extract and sum up single R-squared 
  do.call("sum", lapply(seq(nrow(resp.vals)), function(j) {
    summary(lm(resp.vals[j, ] ~ pred.vals[i, ]))$r.squared
  }))
}) 
```

虽然`parLapply`与普通相比性能要好得多`lapply`，但我想知道是否有一种优雅的方式可以加快整个过程。有什么建议么？

干杯，
弗洛里安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T18:15:46.400

您可以尝试一些技巧。我不太明白您创建线性模型的方式，但是`r.squared`您从线性模型计算的结果相当于 Pearson 相关系数的平方（`cor`在 R 中使用默认参数），它的计算速度比线性模型快得多模型。

使用您的数据比较这两个函数：

```
# Finding r.squared using a lm
f1 <- function(n){summary(lm(resp.vals[n,] ~pred.vals[n,]))$r.squared}
# Finding r.squared using Pearson's
f2 <- function(n){ cor(resp.vals[n,],pred.vals[n,])^2}

# Both give the same result
f1(1)
[1] 0.0009032986
f2(1)
[1] 0.0009032986 
```

在计时这些函数的单个调用方面：

```
require(microbenchmark)
microbenchmark( f1(1) , f2(1) )
Unit: microseconds
  expr      min        lq   median        uq      max neval
 f1(1) 2009.328 2037.0680 2071.045 2124.9225 4102.079   100
 f2(2)   73.075   77.7365   84.690   89.7215 5485.368   100 
```

因此，您应该能够通过使用`cor`而不是`lm`.

交换原始函数以供使用的快速系统时间比较`cov()^2`表明情况如下：

```
#Using cov()
   user  system elapsed 
  0.013   0.002   1.085

#Using lm()
   user  system elapsed 
  0.159   0.028  26.334 
```

# java - 2个数组之间不可预测的冲突

> ID：16042156
> 
> 赞同：0
> 
> 时间：2013-04-16T16:21:54.090
> 
> 标签：java, android, andengine

我目前正在 AndEngine 中构建游戏，但我的碰撞检测似乎有点偏离。它可以工作..大多数时候，但似乎当与一个物体发生碰撞时，它不会做另一个。这很难解释，而且非常难以预测。如果汽车撞到雪地，它应该减速。如果汽车撞到冰上，它应该加速。

```
for (int i = 0; i < rManager.carArray.length; i++)
{
if (rManager.getInstance().snowArray[0].getSnowSprite().collidesWith(rManager.getInstance().carArray[i].getCarSprite()))
{
    Log.e("SNOW", "snow 0 collided with " + rManager.getInstance().carArray[i].ToString());
    rManager.getInstance().carArray[i].setCarSpeed(0.1f);
    break;
}

if (rManager.getInstance().iceArray[0].getIceSprite().collidesWith(rManager.getInstance().carArray[i].getCarSprite()))
{
    Log.e("ICE", "ice 0 collided with " + rManager.getInstance().carArray[i].ToString());
    rManager.getInstance().carArray[i].setCarSpeed(1f);
    break;
}

else
{
    rManager.getInstance().carArray[i].setCarSpeed(0.5f);
}
} 
```

我的代码有什么问题吗？目前，两个敌人数组都只有 1 个元素。这就是为什么我只检查 0。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T23:00:50.060

`break;`您应该在碰撞检测`if`测试中删除。（或者如果您只想要雪或冰，而不是同一辆车，则将其更改为继续......不太清楚您的游戏在这方面是如何运作的）。

# c# - MissingMethodException 插件 CRM2011

> ID：16042158
> 
> 赞同：0
> 
> 时间：2013-04-16T16:22:05.320
> 
> 标签：c#, exception, dynamics-crm-2011, missingmethodexception

我在这个问题上找到了一些建议，但我无法解决我的问题。

我们得到了一个 .ddl，它替换了 word 文件中的占位符并返回了一个内存流。这在带有 WPF 前端的交付测试应用程序中运行良好。

现在我们需要在 CRM2011 环境中使用这个解决方案。我在我的 CRM 项目中添加了对这个 .dll 文件的引用，完全按照示例中的方式构建逻辑，然后出现*MissingMethodException*。

我调试到抛出异常的地步，发现这样的东西：

```
 readonly Dictionary<Type, object> typeMap = new Dictionary<Type, object>();

/// <summary>
/// Returns an instance of the DataService implementing the <typeparamref name="TService"/> interface
/// </summary>
/// <typeparam name="TService">type of the interface for the DataService</typeparam>
/// <returns></returns>
public TService For<TService>()
{
  if (typeMap.ContainsKey(typeof(TService)))
  {
    object value = typeMap[typeof(TService)];
    if (value is Type)
    {
      return (TService)Activator.CreateInstance((Type)typeMap[typeof(TService)]);
    }

    return (TService)value;
  }

  return Activator.CreateInstance<TService>();
} 
```

行 Activator.CreateInstance(); 抛出异常。我完全不知道这里出了什么问题，以及为什么这段代码在测试应用程序上运行良好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:38:25.843

我假设这是因为您要么尝试创建静态类，要么尝试创建没有空构造函数的类。添加 try catch 以显示尝试创建的类型以缩小正在发生的事情。

# c#-4.0 - 附加实体的延迟加载问题

> ID：16042163
> 
> 赞同：0
> 
> 时间：2013-04-16T16:22:19.847
> 
> 标签：c#-4.0, entity-framework-5

我已将我的 DAL 代码库从 ObjectContext (EF4) 更改为 DbContext (EF5)。我的问题是，当我将实体附加到 DbSet 并访问导航属性时，我得到的是 null 而不是对象，但是在我的旧代码（ObjectContext 案例）中，它返回给我的是对象而不是 null。

我可以通过显式加载来解决问题，但是要找到所有使用附加实体的导航属性的代码会很痛苦。

有明确的解决方案吗？

谢谢

# php - 我如何发布由 jquery 动态创建的文本框值

> ID：16042164
> 
> 赞同：0
> 
> 时间：2013-04-16T16:22:20.353
> 
> 标签：php, javascript, jquery, html, codeigniter

我正在使用 codeigniter 框架我试图在用户单击按钮时使用 HTML 表单中的文本框，文本框将由 jquery 自动生成，但是当我提交表单时，其他文本框值正确发布但我无法发布 jquery 文本框价值。

这是jQuery代码：

```
 $("#button").live('click',function add(){ 
   $("#tblRel").append(
       '<tr ><td>'
    +'<input type="text" class="input_value_short" id="prova" name="jquery_txt" value="prova" />'+ 
       '</td><tr>'
   );
}); 
```

HTML：

```
 <?php echo form_open("validation/form_main");?>
  <table id="tblRel"  border="0">
      <tr>
          <td class="lable">Applicant Name:</td>
          <td colspan="3"><?php echo form_input(array('name'=>'applicant_name','class'=>'input_value_long','value'=>set_value('applicant_name'))) ?></td>
      </tr>
 </table>
 <?php echo form_submit(array('id'=>'submit','name'=>'Save','value'=>'Save record','class'=>'button_print'));?> 
```

在 form_main() 函数中，我这样发布：

```
 form_main(){
    $name        = $this->input->post('applicant_name');
    $jquery_txt  = $this->input->post('jquery_txt');
    } 
```

我可以得到 $name 的值，但是 $jquery_txt 是空的，谁能帮帮我！对不起，我的英语很差。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:43:54.013

```
 $("#button").live('click',function add(){ 
           $("#tblRel").append('<tr ><td><input type="text" class="input_value_short" id="jquery_txt" name="jquery_txt[]" value="prova" /></td><tr>');
       }); 
```

我猜你的名字和文本框不同。。让它相同，如果你有多个文本框，将文本框的名称更改为数组，否则发布后你只会得到一个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:32:14.753

将 jQuery 代码更改为此，它应该可以正常工作。您的问题是您通过单击“提交”按钮添加内容，这将提交表单并且内容将在提交请求后附加。

```
<script>
    $("form").live('submit',function add(){ 
   $("#tblRel").append(
       '<tr ><td>'
    +'<input type="text" class="input_value_short" id="prova" name="jquery_txt" value="prova" />'+ 
       '</td><tr>'
   );
       return true;
});
</script> 
```

# ruby-on-rails - 在 Rails 中执行 AJAX 调用的正确方法

> ID：16042167
> 
> 赞同：0
> 
> 时间：2013-04-16T16:22:26.840
> 
> 标签：ruby-on-rails, ajax, coffeescript

我目前正在以“oldschool php way”执行AJAX：

`/home/index.html`

```
 <%= button_to 'Get message', :id => 'get_message' %>
  <div id="message"></div> 
```

`assets/javascript/index.coffee`

```
$(document).ready ->
  $('#get_message').on(
    'click',
    ->
      $.post(
        '/home/message/',
        (data) ->
          $('#message').text(data.message)
      )
  ) 
```

`app/controllers/home`

```
def message
  respond_to do |format|
    format.json { render :json => { :message => 'Hello, world!' } }
  end
end 
```

我的做法是一种好的做法还是有更好的方法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:36:54.463

像这样的东西，你可以在[button_to](http://apidock.com/rails/ActionView/Helpers/UrlHelper/button_to)、[form_for](http://apidock.com/rails/ActionView/Helpers/FormHelper/form_for)和[link_to](http://apidock.com/rails/ActionView/Helpers/UrlHelper/link_to)标签中使用`:remote`选项。

# expect - 无法通过linux连接在windows服务器上调用命令

> ID：16042172
> 
> 赞同：1
> 
> 时间：2013-04-16T16:22:55.067
> 
> 标签：expect

我正在使用以下脚本从 Linux 连接到 Windows 服务器，但连接后我必须通过执行到 D 下的位置来调用 a 命令：windows 驱动器后跟一些文件夹（其中文件夹名称由空格组成，例如：d :\Rakesh Tatineni\无法执行\Manager.exe 1 1)

以上是我想要执行/调用带有 2 个参数 1 1 的命令的一些方法。

用于连接到 Windows 的脚本

```
#!/usr/bin/expect -f
# Expect script to supply username/admin password for remote ssh server
# and execute command.
# This script needs three argument to(s) connect to remote server:
# password = Password of remote Windows server, for Windows user.
# For example:
#  ./call_engine.sh password
# set Variables
set password [lrange $argv 0 0]
set timeout -1
# now connect to remote windows box (ipaddr/hostname) with given script to execute
spawn ssh userid@<WindowsserverName> 
match_max 100000
# Look for passwod prompt
expect "*?assword:*"
# Send password aka $password
send "$password\r"
# send blank line (\r) to make sure we get back to gui
send "\r"
expect eof 
```

感谢您的帮助，在我们必须包含什么样的代码来调用我上面提到的命令“d:\Rakesh Tatineni\not able to execute\Manager.exe 1 1”之间

谢谢，拉克什吨

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:14:55.383

我看到您已经为脚本提供了密码参数。因此，您可以稍微更改脚本以添加另外两个这样的参数：

```
set password [lrange $argv 0 0]
set arg1 [lrange $argv 1 1]
set arg2 [lrange $argv 2 2] 
```

# php - 向多个收件人发送电子邮件（PHP、My SQL）

> ID：16042173
> 
> 赞同：0
> 
> 时间：2013-04-16T16:23:01.340
> 
> 标签：php, email

嗨，我是新手，只对 PHP 有基本的了解，所以欢迎任何帮助。基本上我正在尝试通过 PHP 发送一封可以有多个收件人的电子邮件。内容还需要显示符合特定标准的用户列表。我有脚本来查看数据库并发送一封电子邮件，但是它只将其发送给一个人，并且只在内容中列出一个人。请有人建议如何将其更改为电子邮件/显示给多个收件人。我知道它应该至少发送给三个人。

任何帮助/指针都将受到欢迎。谢谢你。

```
<?php

session_start();

require_once('../config.php');

$errmsg_arr = array();

$errflag = false;

$link = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);
if(!$link) {
die('Failed to connect to server: ' . mysql_error());
}

$db = mysql_select_db(database_name);
if(!$db) {
die("Unable to select database");
}

$result = mysql_query("SELECT username FROM users WHERE user_type='admin'");

while($result_email = mysql_fetch_array($result))

$to = $result_email['username'];

$result2 = mysql_query("SELECT * FROM users
WHERE ticked='1' AND NOT user_type='super'");

while($result2 = mysql_fetch_array($result2))

$body = $result2['fname'] . " " . $result2['lname'] . " , " . $result2['username'];

mail ($to, 'Subject', $body);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:25:53.490

你可以这样做。它们只需要用逗号分隔。

`$to = "email@email.com, email2@email2.com";`

参考： http: [//php.net/manual/en/function.mail.php](http://php.net/manual/en/function.mail.php)

此外，您的代码粘贴方式有点令人困惑。但是，如果您在 while 循环中加载所有电子邮件。然后你想在一段时间后发送它。例如：

你希望它是：

```
//create an empty $to string
$to = '';

//add all the emails
while($emails as $email)
{
    $to .= $email . ',';
}

//remove the last comma
rtrim($to, ","); 

//send away
mail($to, $subject, $message); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:32:17.037

你的代码是错误的。如果你使用它，你会有错误。您需要使用 implode 在电子邮件之间添加逗号。检查你的 php。我更正了，但您必须正确使用 while 语句。您对一项工作有多个 mysql 查询。你也不应该使用mysql_query。改用 PDO...

你应该像这样使用它

```
<?php
    while($row = mysql_fetch_array($result2))
    {
       $addresses[] = $row['username'];
    }

    $to = implode(", ", $addresses);
?> 
```

用你的代码

```
 <?php

                session_start();

                require_once('../config.php');

                $errmsg_arr = array();

                $errflag = false;

                $link = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);
                if(!$link) {
                die('Failed to connect to server: ' . mysql_error());
                }

                $db = mysql_select_db(database_name);
                if(!$db) {
                die("Unable to select database");
                }

                $result = mysql_query("SELECT username FROM users WHERE user_type='admin'");

                while($row = mysql_fetch_array($result2))
                {
                    $addresses[] = $row['username'];
                }

                $to = implode(", ", $addresses);

                $result2 = mysql_query("SELECT * FROM users
                WHERE ticked='1' AND NOT user_type='super'");

                $body = mysql_fetch_array($result2);
                $body = $result2['fname'] . " " . $result2['lname'] . " , " . $result2['username'];

                mail ($to, 'Subject', $body);

            ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:45:01.643

您对 mail() 的调用不在循环中，因此它只会发送一封电子邮件。

而您设置 $to 的 while 循环只是在每次循环迭代时覆盖先前的值。

所以最后 $to 将被设置为第一个查询返回的最后一个用户名。您的 $body 将是您想要的第二个查询返回的最后一行的正文。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T16:38:17.570

您正在使用语句重复覆盖 $to 的值`$to = $result_email['username'];`。您应该改为创建一个逗号分隔的列表。但看在上帝的份上，

1.  考虑将地址设置为密件抄送，并将 TO 设置为无关紧要的内容，例如 noreply@[yourdomain] 以隐藏收件人的地址。
2.  使用未弃用的 DB 访问：[PDO](http://php.net/manual/en/book.pdo.php)

# ruby-on-rails - 非开发人员的博客后端 Rails

> ID：16042174
> 
> 赞同：0
> 
> 时间：2013-04-16T16:23:01.673
> 
> 标签：ruby-on-rails

我需要一个非常简单的后端视觉表示来创建博客文章。由于博客作者不是开发人员，我需要一些可以使博客发布变得容易的东西。我知道 RedCloth 可用，但我正在寻找更简单的东西，但不是 CMS，因为它会感染我的应用程序并像其他应用程序一样对其进行变异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:42:19.437

我会推荐[ActiveAdmin](http://activeadmin.info/) gem。

这是一个免费的（非常有用的）[RailsCast](http://railscasts.com/episodes/284-active-admin)，它介绍了 gem 的配置和功能。

[ActiveAdmin](http://activeadmin.info/)应该可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:02:31.787

查看 Comfy Blog 项目。

[https://github.com/comfy/comfy-blog](https://github.com/comfy/comfy-blog)

ComfyBlog 是一个用于 Rails 3.1 应用程序的简单博客管理引擎。它还与 ComfortableMexicanSofa CMS 引擎集成。这个项目的好处是它不会干扰您现有的控制器，并且“它只是 Rails”。

# windows-phone-8 - Windows Phone 8 自定义 VoIP 用户界面

> ID：16042175
> 
> 赞同：1
> 
> 时间：2013-04-16T16:23:01.953
> 
> 标签：windows-phone-8, voip

有人知道在 WP8 中自定义 VoIP 集成 UI 的任何方法吗？我只想更改“音频”和“视频”按钮的可见性和文本

谢谢

# visual-studio-2008 - 在内联ptx中加载函数参数

> ID：16042176
> 
> 赞同：2
> 
> 时间：2013-04-16T16:23:04.320
> 
> 标签：visual-studio-2008, cuda, ptx

我具有以下内联汇编功能，可在 32 位 Visual Studio 2008 的调试模式下正常工作：

```
__device__ void add(int* pa, int* pb)
{
  asm(".reg .u32   s<3>;"::);
  asm(".reg .u32   r<14>;"::);

  asm("ld.global.b32    s0, [%0];"::"r"(&pa));      //load addresses of pa, pb
  printf(...);
  asm("ld.global.b32    s1, [%0];"::"r"(&pb));
  printf(...);
  asm("ld.global.b32    r1, [s0+8];"::);
  printf(...);  
  asm("ld.global.b32    r2, [s1+8];"::);
  printf(...);

  ...// perform some operations
} 
```

pa 和 pb 在设备上全局分配，例如

```
__device__ int pa[3] = {0, 0x927c0000, 0x20000011};  
__device__ int pb[3] = {0, 0xbb900000, 0x2000000b}; 
```

但是，此代码在发布模式下失败，在线`asm("ld.global.b32 r1, [s0+8];"::);` 如何在发布模式下使用内联 ptx 正确加载函数参数？

PS 使用 -G 标志（生成 GPU 调试信息）构建发布模式会导致代码在发布模式下正确运行。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:05:53.083

希望这段代码会有所帮助。我仍在猜测您到底要做什么，但是我从您的代码开始，并决定在`pa`and`pb`数组中添加一些值并将它们存储回`pa[0]`and `pb[0]`。

此代码是为 64 位机器编写的，但将其转换为 32 位指针应该不难。我已经用注释标记了需要为 32 位指针更改的行。希望这将回答您有关如何使用作为设备内存指针的函数参数的问题：

```
#include <stdio.h>

__device__ int pa[3] = {0, 0x927c0000, 0x20000011};
__device__ int pb[3] = {0, 0xbb900000, 0x2000000b};

__device__ void add(int* mpa, int* mpb)
{
  asm(".reg .u64   s<2>;"::);  // change to .u32 for 32 bit pointers
  asm(".reg .u32   r<6>;"::);

  asm("mov.u64    s0, %0;"::"l"(mpa));      //change to .u32 and "r" for 32 bit
  asm("mov.u64    s1, %0;"::"l"(mpb));      //change to .u32 and "r" for 32 bit
  asm("ld.global.u32    r0, [s0+4];"::);
  asm("ld.global.u32    r1, [s1+4];"::);
  asm("ld.global.u32    r2, [s0+8];"::);
  asm("ld.global.u32    r3, [s1+8];"::);
  asm("add.u32    r4, r0, r2;"::);
  asm("add.u32    r5, r1, r3;"::);
  asm("st.global.u32    [s0], r4;"::);
  asm("st.global.u32   [s1], r5;"::);
}

__global__ void mykernel(){
  printf("pa[0] = %x, pb[0] = %x\n", pa[0], pb[0]);
  add(pa, pb);
  printf("pa[0] = %x, pb[0] = %x\n", pa[0], pb[0]);
}

int  main() {
  mykernel<<<1,1>>>();
  cudaDeviceSynchronize();
  return 0;
} 
```

当我运行此代码时，我得到：

```
$ ./t128
pa[0] = 0, pb[0] = 0
pa[0] = b27c0011, pb[0] = db90000b
$ 
```

我相信这是正确的输出。

我编译它：

```
nvcc -O3 -arch=sm_20 -o t128 t128.cu 
```

# android - 我在哪里可以看到“密钥库”的详细信息？

> ID：16042185
> 
> 赞同：1
> 
> 时间：2013-04-16T16:23:49.483
> 
> 标签：android

[根据 Google 指南https://developers.google.com/maps/documentation/android/start](https://developers.google.com/maps/documentation/android/start) ，我试图弄清楚如何查看 SHA-1 指纹，我应该执行以下操作

对于 Windows Vista 和 Windows 7，运行：

> > keytool -list -v -keystore "C:\Users\your_user_name.android\debug.keystore" -alias androiddebugkey -storepass android -keypass android "

但我不明白我应该在哪里运行这个试验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:45:52.747

您需要直接在`bin`您的 Java JDK 目录的子目录中运行它（例如，对我来说就是这样`C:\Java\jdk1.6.0_37\bin`），或者将该`bin`目录添加到您的`PATH`环境变量中。如果您执行后者，则可以从任何命令行提示符运行该命令。

# java - Java applet on website does not scan other websites

> ID：16042190
> 
> 赞同：0
> 
> 时间：2013-04-16T16:24:07.160
> 
> 标签：java, url, web, applet

Hello I have just finished my very first applet in Java : [http://st.fri.uniza.sk/~mudrak3/index2](http://st.fri.uniza.sk/~mudrak3/index2)

What it does is basicaly it goes through websites source code and finds any links and appends them into textArea.

If I put that website link into textField ([http://st.fri.uniza.sk/~mudrak3/index2](http://st.fri.uniza.sk/~mudrak3/index2)) and hit button it all works. Button event :

```
private void button1ActionPerformed(java.awt.event.ActionEvent evt) {                                        
    textArea1.setText("\f");
    try {
        ArrayList<String> array = new ArrayList<String>();
        ArrayList<String> vystup = new ArrayList<String>();
        URL adresa;
        adresa = new URL(textField1.getText());
        BufferedReader kod = new BufferedReader(new InputStreamReader(adresa.openStream()));
        String riadok;
        while ((riadok = kod.readLine()) != null) {
            array.add(riadok);
            String[] pom = riadok.split(" ");
            String xxx;
            Pattern pattern = Pattern.compile("http://[^ \"]+");
            for (int i = 0; i < pom.length; i++) {
                xxx = pom[i];
                Matcher matcher = pattern.matcher(xxx);
                if (matcher.find()) {
                    textArea1.append(matcher.group(0) + "\n");
                }
            }
        }
        textArea1.append("---------Koniec---------");
    } catch (MalformedURLException ex) {
        JOptionPane.showMessageDialog(null, "Zle zadana URL !");
    } catch (IOException ex) {
        JOptionPane.showMessageDialog(null, "IOException !");
    }

} 
```

Any other website doesn't work. This app works in NetBeans as I run the applet, but not on the website. Any help ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:25:30.410

In order to reach across domains, an applet needs to be:

1.  [Digitally signed](http://docs.oracle.com/javase/tutorial/deployment/jar/signindex.html) by you.
2.  Accepted by the user when [prompted](https://stackoverflow.com/questions/12986333/appearance-of-java-security-dialog).

# c# - C# 命名过程

> ID：16042194
> 
> 赞同：2
> 
> 时间：2013-04-16T16:24:14.610
> 
> 标签：c#, winforms, process

我需要帮助，当我在名称为“Game.exe”的 Windows c# 应用程序上运行时该怎么办，以便在任务栏中应用程序“Game.exe”的名称是例如“MegaCity.exe”？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T16:29:05.673

If I'm getting your question, I think you should change the assembly name in the project properties:

![Assembly Name](https://i.stack.imgur.com/uVtYU.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:28:46.477

`Project` | `Properties`, select the `Application` tab, and enter the desired EXE name into the "**Assembly Name**" field.

# visual-studio - 编译 C++/CLI 时缺少 MSBuild 任务

> ID：16042207
> 
> 赞同：2
> 
> 时间：2013-04-16T16:24:41.177
> 
> 标签：visual-studio, msbuild, c++-cli

我正在尝试使用 MSBuild 编译一些 C++/CLI。我收到一个错误：

> C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\Microsoft.CppClean。目标（74,5）：错误 MSB4062：**无法从程序集 Microsoft.Build.CppTasks.Common 加载“CppClean”任务**，版本 = 4.0.0.0，文化 = 中性，PublicKeyToken = b03f5f7f11d50a3a。无法加载文件或程序集“Microsoft.Build.CppTasks.Common, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a”或其依赖项之一。该系统找不到指定的文件。确认声明正确，程序集及其所有依赖项都可用，并且任务包含实现 Microsoft.Build.Framework.ITask 的公共类。

我的一位同事已通过在他的机器上安装 Visual Studio 2010 SP1 修复了此错误，但我已经安装了该错误（以及带有更新 1 的 Visual Studio 2012）但我收到此错误。我已经检查了错误消息中的路径，并且`Microsoft.CppClean.targets`和`Microsoft.Build.CPPTasks.Common.dll`文件都存在。

CPPClean 任务似乎是[特定于 Visual C++ 的 MSBuild 任务](http://msdn.microsoft.com/en-gb/library/vstudio/ff960151%28v=vs.100%29.aspx)的一部分。**有什么方法可以将其作为单独的安装程序来进行修复，或者作为另一组工具的安装程序的一部分？**如果做不到这一点，还有其他方法可以解决此错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:08:06.173

在 Lanorkin 的评论的提示下，我检查了 GAC，但`Microsoft.Build.CppTasks.Common.dll`程序集不在其中。我手动添加了它，它现在构建了。

# xcode - self.tableView reloadData 在 vi ewWillAppear 中不起作用

> ID：16042209
> 
> 赞同：1
> 
> 时间：2013-04-16T16:24:56.157
> 
> 标签：xcode, uitableview, reloaddata, viewwillappear

我有一个 Xcode 应用程序，它创建一个表视图，然后用来自 sqlite 数据库的数据填充它，这完美地工作并允许我将数据推送到新视图并删除等，

这个表视图是标签栏控制器上加载的第一个视图。当我移动到同一个控制器上的另一个视图时出现问题，即创建一个运动员，在这个视图中我可以向数据库添加一个新的运动员（工作正常）但是当我回到标签栏控制器上的 tableview 时，表是一样的，我必须注销并重新登录才能看到表中的变化，

我在 viewWillAppear 函数中尝试过 [self.tableView reloadData] ，但这什么也没做。我知道该函数被调用了，因为我在它们中放置了一个 NSLog 只是为了让您安心。

我找到了我认为可能是这里的解决方案，但我无法让它工作！

[viewWillAppear，viewDidAppear 没有被调用，没有触发](https://stackoverflow.com/questions/3560669/viewwillappear-viewdidappear-not-being-called-not-firing)

我将在下面发布我的代码和故事板的屏幕截图，因为我确信这是我设置控制器的糟糕方式导致了这个错误。任何帮助将不胜感激，因为我现在处于崩溃阶段：D

```
-(void)viewWillAppear:(BOOL)animated {

//[super viewWillAppear:animated];

//[self.tabBarController viewWillAppear:animated];

[self.tableView reloadData];
NSLog(@"i just ran viewwillAppear");

}

- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {

athleteObject *athObj3 = [athletes objectAtIndex:indexPath.row];

athleteIdDelete = athObj3.athId;

[self openDatabase];

[self deleteAthleteFromDataBase];

[athletes removeObjectAtIndex:indexPath.row];

[tableView reloadData];

} 
```

reloadData 在我的 commitEditing 函数中工作（当我通过滑动删除条目时会更新表格视图）

任何帮助将不胜感激，我会在下面发布屏幕截图。

（如果可能的话，无法弄清楚如何加载屏幕截图）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:31:52.440

看起来运动员（我假设是 NSMutableArray）没有在 viewWillAppear 中更新。在调用 reloadData 之前，您是否尝试过运行从数据库中填充数组的选择器？

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:32:18.340

我假设您根据从数据库返回的对象数量来设置代码中的行数/节数。

在此方法处设置断点，每次编译器中断时获取计数。您可能没有从数据库中获取任何对象，因此编译器永远不会运行其余的表视图 dataSource 方法。

# entity-framework - 需要 ServiceConfiguration.cscfg 来填充 web.config 会话状态和连接字符串

> ID：16042212
> 
> 赞同：1
> 
> 时间：2013-04-16T16:24:59.120
> 
> 标签：entity-framework, azure, asp.net-membership, connection-string, azure-configuration

当我在 Windows azure 中调整这些设置时，我需要在 web.config 中传播实体框架、asp.net 成员资格（都在 web.config 的 connectionstrings 部分中）和会话状态（在 sessonstate 的 sqlconnectionstring 中）的连接字符串更改服务配置。

在开发过程中，我们将我们的应用程序作为标准的 asp.net webforms 应用程序进行测试，但一旦部署，它就会在 azure 中运行。因此，我们需要允许站点在非天蓝色和天蓝色上下文中运行。这就是为什么我们现在只依赖 web.config 中的值。因为在我的代码中没有直接调用这些连接字符串，因此编写了一个实用程序类，该类从 azure 服务配置中获取（如果可用，或者从 web.config 中获取）是这些值不可能。

我意识到编辑 web.config 会导致服务中断——我只打算在非工作时间这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:34:12.203

我相信最好的方法是将您的配置信息包装在服务中。然后，在服务中，使用 RoleEnvironment 来确定要使用的设置。例如

```
public static class Config
{
    public static string ConnStr
    {
        get
        {
            if (RoleEnvironment.IsAvailable)
                return RoleEnvironment.GetConfigurationSettingValue("ConnStr");

            return ConfigurationManager.AppSettings["ConnStr"];
        }
    }
} 
```

如果这不起作用，并且您需要更改实际的 web.config（例如，使用命名连接字符串），那么您需要在运行时修改配置。在您的角色开始时，请执行以下操作：

```
var config = WebConfigurationManager.OpenWebConfiguration(null);
var connStrs = WebConfigurationManager.OpenWebConfiguration(null).GetSection("connectionStrings") as ConnectionStringsSection;
connStrs.ConnectionStrings["ConnStr"].ConnectionString = RoleEnvironment.GetConfigurationSettingValue("ConnStr");
config.Save(); 
```

要处理角色运行后配置更改的情况，只需从 RoleEnvironment.Changing 事件中调用与上述相同的代码即可。

祝你好运，

埃里克

# c# - 如何从自定义用户控件中删除属性

> ID：16042214
> 
> 赞同：0
> 
> 时间：2013-04-16T16:25:01.333
> 
> 标签：c#, winforms, visual-studio

向自定义用户控件添加了一个属性。从那时起，Visual Studio 将生成的代码插入到使用该用户控件的每个表单中。现在我们要删除该属性，因为它不会被使用。但显然这样做会导致编译错误。有没有办法告诉 Visual Studio 从所有生成的代码中删除该属性？在我看来，放置 [Obsolete()] 之类的内容应该足以告诉 Visual Studio 将其从生成的代码中删除。还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:29:38.357

看[`DesignerSerializationVisibilityAttribute`](http://msdn2.microsoft.com/en-us/library/system.componentmodel.designerserializationvisibilityattribute)，尤其是`DesignerSerializationVisibility.Hidden`选项。

**警告：**不幸的是，您必须在设计模式下打开每个表单/控件，以便可以重新生成代码（如果还没有这样做的话）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:27:22.950

您可以尝试使用一些重构工具，例如 Resharper。

[http://www.jetbrains.com/resharper/](http://www.jetbrains.com/resharper/)

添加“过时”属性只会生成编译器警告，但不会删除任何代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T20:00:11.463

正则表达式来救援！我通常做的是在文件对话框中打开替换（Ctrl+Shift+H），选中使用正则表达式复选框并`.+\.SomeProperty.+`用空字符串替换实例。

*请务必在此之前*将您的更改提交到存储库，以便在出现任何问题时恢复到工作状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T16:26:50.920

只需留下它并将其标记为[`Obsolete`](http://msdn.microsoft.com/en-us/library/22kk2b44%28v=vs.90%29.aspx)。

# asp.net-mvc - Mvc：自定义默认路由

> ID：16042227
> 
> 赞同：1
> 
> 时间：2013-04-16T16:25:52.213
> 
> 标签：asp.net-mvc, asp.net-mvc-4, routes

我有我自己的默认路线，像这样

```
routes.MapRoute(
            name: "Default",
            url: "{country}/{lang}/{controller}/{action}",
            defaults: new { controller = "Home", action = "Index" }
        ); 
```

但是当我的网站启动时它正在搜索 /Home 路线并且它不存在，我需要在它启动时传递那个国家和语言参数但我不知道在哪里？并使用 ES/es/Home 之类的东西获取我的默认路由。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:07:02.267

如果您正在寻找国家和语言的默认值，只需更改默认选项，

```
defaults: new { country="ES", lang="es", controller = "Home", action = "Index" } 
```

它将使用默认值填充国家和语言选项。

或者，如果您的要求是将应用程序的起始 url 设置为，

```
www.site.com/ES/es 
```

将以下代码放入 Application_BeginRequest

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    if (String.Compare(Request.Path, Request.ApplicationPath, StringComparison.InvariantCultureIgnoreCase) == 0)
            Response.Redirect(Request.Path + "ES/en");
} 
```

**编辑**

Application_BeginRequest 中的代码将为每个请求执行，包括资源（js/css）url。您可以删除 Application_BeginRequest 代码并将代码放在默认控制器的默认操作中的顶部以具有相同的效果。喜欢：

```
//Home Controller
public ActionResult Index(string country, string lang)
{
    if (String.Compare(Request.Path, Request.ApplicationPath, StringComparison.InvariantCultureIgnoreCase) == 0)
        return Redirect(Request.Path + string.Format("{0}/{1}", country, lang));
    return View();
} 
```

**编辑**

编码，

```
if (String.Compare(Request.Path, Request.ApplicationPath, StringComparison.InvariantCultureIgnoreCase) == 0)
        return Redirect(Request.Path + string.Format("{0}/{1}", country, lang)); 
```

检查传入的 url 是否是应用程序的根 url，如果是，则使用附加路由信息进行重定向。理想情况下，`Request.Path`and`Request.ApplicationPath`都将具有`/`启动 url 的价值。在这里，此检查仅在起始/默认 url 中完成，因此我认为此代码不会导致网站明显变慢。您可能会注释掉代码，并检查性能是否提高，以确保此代码是否是导致性能的原因。

# c# - 实体框架 - 我无法在我有关联的地方插入实体 一对多

> ID：16042234
> 
> 赞同：0
> 
> 时间：2013-04-16T16:26:06.530
> 
> 标签：c#, entity-framework, ado.net, entity, sql-server-ce

我只是使用 Entity Framework 4.0 制作桌面应用程序，并使用 Sql server Compact 3.5。我的示例驱动程序和总线中的实体很少。每个 Driver 都分配给一个 Bus，但每条 Bus 可以分配给多个 Driver。好的，让我们看看我如何构建我的实体。

驱动程序有 Id (PK, non-nullable, int32, StoreGeneratedPatter - Identity), FirstName (non-nullable, string), LastName (non-nullable, string), Addres (non-nullable, string), Age (non-nullable, int32) Bus 有 Id (PK, non-nullable, int32, StoreGeneratedPatter - NONE!), IsBig non-nullable, boolean), Mark (non-nullable, string), Year(non-nllabble, string)

现在的问题是我制作并添加了一些总线到 BusSet 但我不能用 Driver 来做到这一点.. 为什么？也许是因为

> 存储生成模式

?

这是代码：

```
 Bus aut = new Bus() { Id = 403, IsBig = true, Mark = "Solaris", Year = "1999" };
        Driver kier = new Driver() { FirstName = "s", LastName = "sdasd", Addres = "sdsa", Age = 50 };

using (KierowcyContext db = new KierowcyContext))
{
                            db.BusSet.AddObject(aut);
                            db.Drivers.AddObject(kier);
                            db.SaveChanges();
} 
```

# google-chrome - Fiddler 只显示来自 Chrome 第一页的流量？

> ID：16042238
> 
> 赞同：1
> 
> 时间：2013-04-16T16:26:22.883
> 
> 标签：google-chrome, fiddler

我正在尝试在 Chrome 中模拟慢速连接，以便我可以看到我的应用程序在低速下的行为。我已经下载并安装了 Fiddler 2，我可以和 Chrome 同时运行它。当我查看 Fiddler 中的日志时，它捕获了我的起始页面，即 google.com，但随后它无法捕获我在 Chrome 中发出的任何后续请求，甚至忽略了从它启动的同一页面的搜索。用于模拟调制解调器速度的 Fiddler 设置对 Chrome 也完全没有影响。我可以关闭 Chrome 并重新打开它，开始页面将再次被捕获，但除此之外什么都没有。它可以很好地从 IE 中捕获，甚至可以捕获来自 Desktop Earth 试图检索云数据的流量，但在 Chrome 中没有骰子。

我看过[这个问题](https://stackoverflow.com/questions/5740313/fiddler-doesnt-capture-traffic-from-chrome)，它有三个答案，但没有一个选择。第三个有这个代码：

```
ChromeOptions options = new ChromeOptions();
options.AddArgument(string.Format("--proxy-server=http={0}:{1};https={0}:{1}", proxyHost, port));
driver = new ChromeDriver(options); 
```

...但我不知道我会在哪里，因为我对 Fiddler 完全陌生。有人可以帮我吗？

# javascript - 如何在元素完成渲染后立即运行函数？

> ID：16042241
> 
> 赞同：2
> 
> 时间：2013-04-16T16:26:29.033
> 
> 标签：javascript, jquery, dom, dom-events

我需要根据另一个元素的高度来设置一个元素的高度。假设当该元素完成渲染时，它的高度为 490 像素。

如果我在函数 inside 的开头查询其他元素的高度`$(document).ready()`，它会返回 432px。

如果我在 a 中查询其他元素的高度`setTimeout(function, 100)`，它会返回大约 475px。

如果我`setTimeout`提高到 150 左右，则元素完成渲染，我得到 190。但显然我不能指望这一点。

如果可能的话，我不想等待整个页面完成加载；我只想等待这个元素。

似乎该`load`事件应该适用于任意元素，但据我所知，这在浏览器中没有实现，或者至少在 Chrome 中没有实现。

**编辑**：该元素不是图像，并且（几乎可以肯定）元素内部永远不会有图像。它只是一个`<div>`与其他一些`<div>`s 和`<p>`s 以及其中的东西。显然，在应用 CSS 或其他东西的中间会查询高度。代码示例即将发布。

**编辑 2**：这是一个从我的网站被黑掉的[小提琴。](http://jsfiddle.net/75th/YsQrd/)（请原谅可怕的标记；我还没有清理 Drupal 的输出。）不过，小提琴没有表现出我试图纠正的不良行为，因为整个片段在 Javascript 的相关部分之前被渲染是跑。

有没有办法做到这一点，还是我坚持`window.onload`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:30:22.717

You can do something like this:

```
<img src="myImage.gif" onload="loadImage()"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:30:09.560

You will want to use at least `$(window).load()` since you need to wait on additional resources like images and CSS sheets that can affect the dimensions of elements on the page.

`load()` can work on images as well. You should be able to get it right without needing `setTimeout`.

[http://api.jquery.com/load-event/](http://api.jquery.com/load-event/) contains a notice that it doesn't work reliably for images.

# php - PHP强制下载中断文件

> ID：16042245
> 
> 赞同：0
> 
> 时间：2013-04-16T16:26:38.150
> 
> 标签：php, file

我在 php 文档中使用以下代码来强制下载 pdf 表单，因为只有在本地机器上而不是在线提交后才能提交。

它可以正常下载文件，但会损坏它。我无法再打开 pdf 文档。

```
<?php 
$file_name = 'costumer.pdf';
$file_url = 'http://www.lopezi.com/forms/' . $file_name;
header('Content-Type: application/pdf');
header("Content-Transfer-Encoding: Binary"); 
header("Content-disposition: attachment; filename=\"".$file_name."\""); 
readfile($file_url);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:29:34.260

The `Content-Transfer-Encoding` header shouldn't be needed in this case. Further I suspect that you have corruption in the outputted file.

Download it somewhere, open notepad, and drag the file in there. If any PHP warnings or errors were generated you will see them at the top.

Also, try to avoid the option of having more content return from the script, causing problems with the download, end with something like:

```
die(file_get_contents($file_url)); 
```

This way you cannot accidentally break the code easily by adding more output.

# xml - 您能否让我知道如何检索 CDATA 部分下的 ip 地址节点并使用 vbscript 对其进行修改

> ID：16042249
> 
> 赞同：0
> 
> 时间：2013-04-16T16:26:59.230
> 
> 标签：xml, vbscript, cdata

```
<con:request>
- <![CDATA[ 
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:cli="http://client.webservice.sepm.symantec.com/">
   <soapenv:Header/>
   <soapenv:Body>
      <cli:getComputersByIP>
         <!--Zero or more repetitions:-->
         <ipAddresses>10.211.36.63</ipAddresses>
         <!--Optional:-->

         <!--Optional:-->

      </cli:getComputersByIP>
   </soapenv:Body>
</soapenv:Envelope>

  ]]> 
  </con:request> 
```

这是我正在使用的 xml，我每次都需要替换 ipaddresses 标记中的 ip，所以需要检索它，等待你的帮助，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:49:07.597

CDATA 不被视为标记。所以：

1.  提取`con:request`节点的值（这将是一个文本节点）
2.  将其解析为 XML
3.  对新的 XML 文档使用普通的 DOM 方法

# wpf - 将“未找到记录”行添加到 WPF DataGrid

> ID：16042254
> 
> 赞同：0
> 
> 时间：2013-04-16T16:27:11.573
> 
> 标签：wpf, c#-4.0, mvvm, datagrid, wpfdatagrid

当 ItemSource 为空时，我想向我的 DataGrid 添加一行。Aka - 当没有数据返回时。

我已经尝试过这个问题的解决方案

[如何在数据网格中显示“未找到项目”](https://stackoverflow.com/questions/7157152/how-to-display-no-items-found-in-a-datagrid)

但它将 DataGrid 的背景设置为显示消息而不是新行。

我也试过

[在 WPF DataGrid 为空时显示“未找到记录”消息](https://stackoverflow.com/questions/4687414/show-no-record-found-message-on-a-wpf-datagrid-when-its-empty)

但无济于事。（即使我应用了样式，该行也没有出现）

我只想显示一个包含“未找到记录”字样的空行。可能吗？

# asp.net-mvc - ASP.NET MVC 2 - 如何在 context.MapRoute 中使用 Url 属性编写 RouteUrl 修改？

> ID：16042256
> 
> 赞同：0
> 
> 时间：2013-04-16T16:27:24.740
> 
> 标签：asp.net-mvc, routes, actionlink, absolute-path, maproute

我有一个名为 User 的区域，我为它编写了 MapRoute：

```
 context.MapRoute(
      "User_Category",
      "User/Category/{categoryId}",
       new { controller = "Product", action = "Category", categoryId = UrlParameter.Optional },
       new { categoryId = @"\d+" }
  ); 
```

这是另一个例子，我有一个链接：

```
<%=Html.ActionLink("Điện thoại", "Category", new { area = "User", controller = "Product", id = 1  }, null) %>
(http://localhost:8578/User/Product/Category/1) 
```

当然，我不能这样做：

```
<%=Html.ActionLink("Điện thoại", "User/Category", new { area = "User", controller = "Product", id = 1  }, null) %> 
```

在上面的 MapRoute 之后，它被修改了。这意味着它在一个区域中，我不知道如何将区域名称传递给 ActionLink 以具有：`http://localhost:8587/User/Category/1`

但我想要的是将 ActionLink 替换为 RouteUrl 以获得绝对链接，例如`**http://localhost:8587/User/Category/1**`

***我应该怎么办？***以及如何删除 URL 中的用户名？感谢收看！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:07:38.867

我认为这是因为您的路线是使用 route 参数定义的，`categoryId`但您的操作链接仅使用该参数`id`？如果是这样，试试这个：

```
<%=Html.ActionLink("Điện thoại", "Category", new { area = "User", controller = "Product", categoryId= 1  }, null) %> 
```

如果你想要完整的绝对 URL，那么你可以这样做：

```
<a href="<%= Html.ViewContext.HttpContext.Request.Url.GetLeftPart(UriPartial.Authority) + Url.Action("Category", new { area = "User", controller = "Product", categoryId= 1  }) %>">Điện thoại</a> 
```

# sharepoint - 如何从 UpdateListItems SOAP 响应中获取错误详细信息？

> ID：16042259
> 
> 赞同：4
> 
> 时间：2013-04-16T16:27:39.793
> 
> 标签：sharepoint, soap

我正在为 Microsoft SharePoint 编写 iOS 客户端。我的目标是更新列表项的日期时间字段并获取有关错误的详细信息。我有一个带有自定义服务器端验证的日期时间字段。

这是对 /_vti_bin/Lists.asmx 的请求：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">
      <listName>{405FFE91-946E-4B2F-861E-DDB24F1629F2}</listName>
      <updates>
        <Batch OnError="Continue" ListVersion="1">
          <Method ID="1" Cmd="Update">
            <Field Name="ID">1</Field>
            <Field Name="DateTime_x0020_E">2000-08-08 07:00:00 +0000</Field>
          </Method>
        </Batch>
      </updates>
    </UpdateListItems>
  </soap:Body>
</soap:Envelope> 
```

这是一个回应：

```
?xml version="1.0" encoding="utf-8"?>
<soap:Envelope 
    xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <soap:Body>
        <UpdateListItemsResponse 
            xmlns="http://schemas.microsoft.com/sharepoint/soap/">
            <UpdateListItemsResult>
                <Results>
                    <Result ID="1,Update">
                        <ErrorCode>0x8102001c</ErrorCode>
                        <ErrorText>Invalid date/time value.

A date/time field contains invalid data. Please check the value and try again.</ErrorText>
                        <z:row ows_ContentTypeId="0x0100D3AA6E2413CF1645A9101D3421B797AE" ows_Title="test of time" ows_DateTi... skipped... 
```

此响应没有说明该字段的有效范围。但是，当我尝试在 SharePoint 网站上设置无效日期时，我得到了正确的错误：

![SharePoint 提供有关错误的详细信息](https://i.stack.imgur.com/rexeW.png)

**问：**如何获取有关使用 SharePoint SOAP 服务的错​​误的详细信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:08:04.463

我发现我的错误在哪里。该字段是仅限日期的，因此 SharePoint 可能不接受值为`2000-08-08 07:00:00 +0000`. 当我只发送日期时：

```
<Field Name="DateTime_x0020_E">1995-08-08</Field> 
```

我得到正确的错误文本：

```
<Result ID="1,Update">
   <ErrorCode>0x810200c5</ErrorCode>
   <ErrorText>[DateTime E] - [Date should be after July 1, 2007]</ErrorText>
   ...
</Result> 
```

# php - 从变量调用函数 (PHP)

> ID：16042264
> 
> 赞同：-2
> 
> 时间：2013-04-16T16:28:10.410
> 
> 标签：php, html, function, variables

我有一个作为学校项目制作的网站，看起来我已经跳入了一些太深的东西。我正在使用 PHP 为每个数组对象创建一个页面。在每个页面中，我想个性化内容以匹配页面。例如，我创建了一个名为的页面，`Darryl`它将包含我的所有图像。将创建其他页面，并且这些页面的内容将根据页面动态创建。

我想要做的是更改`img src`使用 PHP 并使用计数器来弹出不同的图像。这对我来说很难解释。

我有这行包含 php 的 html 代码（它决定了显示哪些图像：

```
 <td><img style="width:11em;" class="magnify" src="<?php print $imgSrc; ?>"/><br><?php print $pageName; ?></td> 
```

我遇到问题的部分是“ print $imgSrc; ”部分。这是我的 php 将创建 src 路径的区域。它使用这个变量 $imgSrc 来获得正确的路径。

该变量是：

```
 $imgSrc = "images"."/".$pageName."/".counter(); 
```

哪个写

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:42:11.500

看起来您对函数是什么或何时执行感到困惑。如果这是您页面上的所有代码：

```
$imgSrc = "images"."/".$pageName."/".counter();
<td>
    <img style="width:11em;" class="magnify" src="<?php print $imgSrc; ?>"/><br>
    <?php print $pageName; ?>
</td> 
```

然后`$imgSrc`只被写入一次。所以不管做什么`counter()`，它只做一次。您可以将整个事情包装在一个 for 循环中并取消`counter()`调用。您可以删除局部变量`$imageSrc`并动态定义属性，如下所示：

```
<td>
    <img style="width:11em;" class="magnify" src="<?php print "images"."/".$pageName."/".counter(); ?>"/><br>
    <?php print $pageName; ?>
</td> 
```

然后，如果`counter()`函数本身是有状态的（例如，每次调用它时它都会返回不同的值），那么您就完成了。

您可以创建一个有状态的函数，如下所示：

```
$counter_var = 0;

function counter() {
    global $counter_var;
    return $counter_var++;
} 
```

但是全局变量不受欢迎，因为它会产生难以追踪的副作用（以及其他原因）。大多数人会告诉你使用 for 循环。我只提到它是因为它看起来更接近您在原始代码中尝试做的事情。

# javascript - 如何管理 ASP.NET 参数和 Javascript 密钥

> ID：16042267
> 
> 赞同：3
> 
> 时间：2013-04-16T16:28:19.387
> 
> 标签：javascript, asp.net-mvc-3, visual-studio-2010

所以这是我的场景。

我使用 ASP.NET MVC 3 以及 HTML、CSS、JavaScript/JQuery 来制作 Web 应用程序。我正在使用 Visual Studio 2010

我们已经发布了产品（它在 1.0 中），但是现在我们处于项目的“维护”模式，我感觉随着项目添加了新功能，维护一组常量会更加困难在 C# (ASP.NET MVC) 和 JavaScript 之间。

例如，在 JavaScript 中，我会创建一个 $.post 并让它链接到 MVC url Controller/Action，然后我会传入参数 { key1: value1, key2: value2}

问题是，如果 C# 参数名称更改或签名中参数的位置更改，我只会在运行时知道 JavaScript 需要更新（我假设我是一个不了解架构的程序员足以在运行前执行此操作）。

所以我的问题是，您如何更轻松地管理 JavaScript 端，以便我可以与 C# 端所做的更改保持“同步”。编译器可以以某种方式为我做这件事，还是有一个插件可以帮助我？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:20:27.290

您的问题询问了有关同步 C# 常量和 JavaScript 常量的问题，但也谈到了参数名称和位置。

在 MVC 世界中，参数的位置比名称更重要，而且我还没有找到一种在没有大量单元和集成测试的情况下保持同步的好方法。你在做这些测试，对吧？;)

至于实际的常量和枚举，我已经开始使用 T4 模板为我需要的常量/枚举生成一个 .cs 和一个（命名空间的）.js 文件（在我的情况下，在数据库之外，但可能只是很容易成为其他任何东西）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T19:08:35.753

我想不出任何简单的方法，但这里有一些可能会有所帮助的方法。当我通常开发一些网站时，首先我尝试在视图中编写尽可能少的 javascript 代码并将它们全部放在 .js 文件中，这样你可以确保你可以重用许多代码，因为那里的所有代码都是纯 javascript不会是你提到的任何问题。我还将所有操作及其控制器和区域名称记录在数据库中，并将它们用于管理权限和安全问题。对于您的问题，您可以将所有这些方法添加到数据库中，然后使用一段代码检查该方法是否存在。

添加到数据库：（在基本控制器中，因此您无需手动执行任何操作）

```
protected override void OnActionExecuting(ActionExecutingContext filterContext)
        {
            var area = filterContext.RouteData.DataTokens["area"];
            string areaName = area != null ? area.ToString() : "";
            var controllerName = filterContext.ActionDescriptor.ControllerDescriptor.ControllerName;
            string actionName = filterContext.ActionDescriptor.ActionName;

           //Add to DB
            base.OnActionExecuting(filterContext);
        } 
```

检查是否存在：

```
bool exist = false;
 try
 {
      HttpWebRequest request = (HttpWebRequest)System.Net.WebRequest.Create("http://www.example.com/image.jpg");
      using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
      {
           exist = response.StatusCode == HttpStatusCode.OK;
      }
 }
 catch
 {
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-30T23:36:21.440

您最好的选择是集成测试。您将能够准确地测试您的用户会执行的操作。[Seleno](https://github.com/TestStack/TestStack.Seleno)是编写集成测试的好选择（它包装了 Selenium）。

这是值得做的。如果您有良好的集成测试覆盖率，您将在生产中遇到更少的错误。

# r - Where does twitteR PIN code appear during R oauth authentication?

> ID：16042271
> 
> 赞同：2
> 
> 时间：2013-04-16T16:28:33.047
> 
> 标签：r, twitter-oauth, roauth

I’m trying to use the twitteR package as I’ve gotten to the Twitter chapter in Jeffrey Stanton’s free e-book on Data science.

I use this code to register my credentials:

```
requestURL <-  "https://api.twitter.com/oauth/request_token"
accessURL =    "https://api.twitter.com/oauth/access_token"
authURL =      "https://api.twitter.com/oauth/authorize"
consumerKey =   "------------"
consumerSecret = "-----------"
twitCred <- OAuthFactory$new(consumerKey=consumerKey,
                         consumerSecret=consumerSecret,
                         requestURL=requestURL,
                         accessURL=accessURL,
                         authURL=authURL)
download.file(url="http://curl.haxx.se/ca/cacert.pem",
          destfile="cacert.pem")
twitCred$handshake(cainfo="cacert.pem") 
```

I then get the link to twitter:

> To enable the connection, please direct your web browser to: [https://api.twitter.com/oauth/authorize?oauth_token=xxxx](https://api.twitter.com/oauth/authorize?oauth_token=xxxx)

I follow the link and within the twitter page, and then click on the “Authorize app” button. This sends me back to the site I listed as the callback URL.

I don’t see the PIN number I was expecting anywhere. My question is: where does it appear? Or where should I be looking for it? I feel like this should be obvious, but somehow I'm missing it.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-12T14:33:10.703

我有类似的问题，不得不做两个改变。

1 - 如 SimonO101 所述，将所有 https 更改为 http

2 - 确保删除回调 URL - 否则不会显示 PIN 而是简单地移动到回调 URL 目标

# ruby-on-rails - 在没有图像的特定段落上截断

> ID：16042273
> 
> 赞同：0
> 
> 时间：2013-04-16T16:28:37.667
> 
> 标签：ruby-on-rails, ruby

**简单的一个 - 如何在（比如说）第 3 段截断博客文章的文本？并明确告诉它不渲染图像？**

我正在使用降价顺便说一句。这可以通过简单的代码以某种“优雅”的方式完成，并且在纯红宝石中没有外部宝石吗？

如果没有，如何最好地实施它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:47:40.200

对于截断段落，如下所示应该起作用：

```
def truncate_by_paragraph(text, num=3)
  # since I'm not sure if the text will have \r, \n or both I'm swapping
  # all \r characters for \n, then splitting at the newlines and removing
  # any blank characters from the array
  array = text.gsub("\r", "\n").split("\n").reject { |i| i == "" }
  array.take(num).join("\n") + ".." # only 2 dots since sentence will already have 1
end 
```

要删除图像，您可以执行以下操作：

```
def remove_images(text)
  text.gsub(/<img([^>])+/, "")
end 
```

然后你可以做

```
truncate_by_paragraph(@text) # will return first 3 paragraphs
truncate_by_paragraph(@text, 5) # will return first 5 paragraphs
remove_images(truncate_by_paragraph(@text)) # 3 paragraphs + no images 
```

根据您所采用的格式，您可能希望`join`在第一种方法中更改`join("\n\n")`以获得双倍间距。

此外，如果您真的想要`...`在文本的末尾，您可能想要测试第 3 段是否有一个点，或者它可能已经有 3 个。

# json - Json中空格的定义

> ID：16042274
> 
> 赞同：14
> 
> 时间：2013-04-16T16:28:39.183
> 
> 标签：json, parsing, unicode, utf-8, whitespace

JSON 指定“可以在任何一对标记之间插入空格”。它没有具体说明什么是空白。我应该将其读作“老式 ASCII 空白”还是“Unicode 空白的整个范围”？

换句话说，在解析 JSON 时，U+2000、U+2001、U+FEFF 等令牌之间的空白字符是否有效？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T16:31:36.147

[RFC4627 中为 JSON](http://www.ietf.org/rfc/rfc4627.txt)定义了无关紧要的空格：

> 在六个
> 结构字符中的任何一个之前或之后都允许有无关紧要的空格。

```
 ws = *(
            %x20 /              ; Space
            %x09 /              ; Horizontal tab
            %x0A /              ; Line feed or New line
            %x0D                ; Carriage return
        ) 
```

顺便说一句，默认编码是 UTF-8：

> JSON 文本应以 Unicode 编码。默认编码为 UTF-8。

话虽如此，我不认为他们打算在原始实现中接受所有形式的[Unicode 空间。](http://www.cs.tut.fi/~jkorpela/chars/spaces.html)

# python - 在python2.6中将整数转换为格式化的二进制字符串

> ID：16042280
> 
> 赞同：1
> 
> 时间：2013-04-16T16:28:57.403
> 
> 标签：python, type-conversion, string-formatting, python-2.6

在 python2.7`"{:010b}".format(25)`中，将返回`'0000011001'`数字 25 的 10 位二进制字符串表示。在 python2.6 中，相同的命令返回`ValueError: zero length field name in format`. 是否有不同的方式为 python2.6 进行简单的格式化转换

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:36:34.107

使用[`format()`函数](http://docs.python.org/2/library/functions.html#format)，更简单（不需要模板占位符部分，只需要格式化字符串）：

```
format(25, '010b') 
```

但是您在 Python 2.7 中遇到了简化，您不必指定位置参数。2.6 等价物是：

```
"{0:010b}".format(25) 
```

# vba - 使用一种验证方法验证多个列

> ID：16042289
> 
> 赞同：0
> 
> 时间：2013-04-16T16:29:30.497
> 
> 标签：vba, excel

这应该是一个简单的修复，但我是 VBA 世界和一般编程的新手。这是我必须验证包含调查条目值的特定列的代码。一些调查问题的值可能性是相同的，我不想为每个问题复制并粘贴相同的代码，然后更改列字母和数字。我确信有一种简单的方法可以做到这一点。

具体来说，我希望通过列 AC 对 I 列进行验证，以针对下面的案例进行验证。我真的很想让这段代码尽可能简单。非常感谢。

我喜欢我现在使用的方法，但如果需要从头开始重建，那就这样吧。

```
Sub MyCheck()

Application.ScreenUpdating = False

Dim i As Integer
    For i = 2 To Range("I65536").End(xlUp).Row
        Select Case Cells(i, 9).Value
            Case "1", "2", "3", "4", "5", "88", "99"
                Cells(i, 9).Interior.ColorIndex = xlNone
            Case Else
               Cells(i, 9).Interior.ColorIndex = 6
        End Select
    Next i
    Application.ScreenUpdating = True

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:58:36.553

像这样？

```
Option Explicit

Sub MyCheck()
    Application.ScreenUpdating = False

    Dim i As Long, lRow As Long
    Dim ws As Worksheet
    Dim rng As Range, aCell As Range
    Dim ColLetter As String

    Set ws = ThisWorkbook.Sheets("Sheet1")

    With ws
        '~~> From Col B to Col AC
        For i = 2 To 29
            ColLetter = Split(.Cells(, i).Address, "$")(1)

            '~~> Find the last row of the releavnt column
            lRow = .Range(ColLetter & .Rows.Count).End(xlUp).Row

            '~~> Set your range
            Set rng = .Range(ColLetter & "2:" & ColLetter & lRow)

            '~~> Remove all the color. Note we are not doing this
            '~~> in the loop
            rng.Interior.ColorIndex = xlNone

            For Each aCell In rng
                Select Case aCell.Value
                Case 1 To 5, 88, 89
                Case Else
                    aCell.Interior.ColorIndex = 6
                End Select
            Next
        Next i
    End With
    Application.ScreenUpdating = True
End Sub 
```

**截屏**

![在此处输入图像描述](https://i.stack.imgur.com/JmWZe.png)

# android - android OnEditorActionListener not working with custom soft keyboard

> ID：16042291
> 
> 赞同：3
> 
> 时间：2013-04-16T16:29:33.530
> 
> 标签：android, android-softkeyboard

i'm working on a project wich require the use of a custom soft keyboard developed by some one else. The problem is that the setOnEditorActionListener does not work in a specific windows where a fragment is used. Does not work means that the onEditorAction is not fired at all. The problem appens only with the custom keyboard, with the default one every thing is working well. The problem is that the soft keyboard project is very complex because i don't know soft keyboard logics and I need to solve the problem before tomoroow morning. Does anyone have an idea of this behavior? Please help

this is the part where i set the listener, this code is working all around the project but here, even the first listener's line is not reached

```
((EditText) getView().findViewById(R.seatDetailCommonHeader.txtName)).setOnEditorActionListener(new OnEditorActionListener() {

                    @Override
                    public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
                        if (event != null && event.getAction() != KeyEvent.ACTION_DOWN) {
                            return true;
                        }

                        // KeyboardHelper.setKeyboardVisibilty(v, false);
                        executeCheck();

                        return true;

                    }
                }); 
```

i went into further investigations, i put a breakpoint on every method's first line in the keyboard code (which is the one taken from the sdk samples with just some layout modification) and the same EditText in two different activities fires different methods:

in one case (the working one) this methods are fired when action button is clicked:

```
LatinKeyboard.isInside
LatinKeyboard.isInside
LatinKeyboard.isInside
LatinKeyboard.isInside
LatinKeyboard.isInside
LatinKeyboard.isInside
LatinKeyboard.isInside
LatinKeyboard.isInside
LatinKeyboard.isInside
SoftKeyboard.onKey
SoftKeyboard.isWordSeparator
SoftKeyboard.sendKey
SoftKeyboard.keyDownUp
SoftKeyboard.keyDownUp
SoftKeyboard.updateShiftKeyState 
```

in the other case (the one that is not working) the same methods are fired, plus these:

```
SoftKeyboard.onFinishInput
SoftKeyboard.onStartInput
SoftKeyboard.updateShiftKeyState
LatinKeyboard.setImeOptions
SoftKeyboard.onStartInputView 
```

hope someone has some idea of this behavior because i'm really in trouble

# apache-flex - 用于简单 getter 和 setter 的 Flex 和 OOP 自定义

> ID：16042293
> 
> 赞同：1
> 
> 时间：2013-04-16T16:29:37.280
> 
> 标签：apache-flex, oop

我正在玩 Flex，我对一些事情感到好奇。

首先，对于我的实例变量，我可以定义类似

```
private var _count:int = 0; 
```

然后似乎如果我有一个 getter 和 setter 用于计数，例如

```
 public function get count():int
    {
        return _count;
    }

    public function set count(value:int):void
    {
        _count = count;
    } 
```

我可以从另一个函数中调用类似

```
count++; 
```

这反过来又将 _count 设置为增加一。

IE 我似乎可以通过 count 或 _count 访问 count 因为我有一个 getter 和 setter ..

那是正确的理解吗？

对于像上面这样的事情，拥有 getter 和 setter 或简单地调用是很好的 OOP 实践`_count++;`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:39:14.053

我会指出，您的 set count 方法会更改变量 _points。如果这是一个错字，那么：

是的; 这是正确的理解。听起来您的测试已经证明了这一点。

引用您的类的实例的其他类将无法访问私有 var _count；但公众“计数”将是。

Getter 和 Setter 对于在类中执行其他功能很有用。在 Flex UI 组件的上下文中，您可以分派一个事件，或通过 Flex 组件失效方法之一使组件失效。

分离 get 和 set 方法还允许您创建只读属性或只写属性，只需省略相应的 get 或 set 方法。

如果这不是错字；然后我不知道为什么 count++ 会改变 _count 变量；你还没有向我们展示的计数正在发生其他事情。

# python - 如何从 IMDBPy 获取 IMDB url？

> ID：16042297
> 
> 赞同：3
> 
> 时间：2013-04-16T16:29:50.387
> 
> 标签：python, imdb, imdbpy

我一直在使用[IMDBpy](http://imdbpy.sourceforge.net/)使用 python 收集有关电影的信息。虽然在大多数情况下它工作得很好，但我不知道如何让它告诉我从搜索返回的电影的 IMDB url。IMDBpy 甚至有可能吗？

非常感谢，亚历克斯

编辑：根据 Aya 的说明，我使用了 get_imdbURL() 方法，如下所示：

```
import imdb
movie = "some movie"
ia = imdb.IMDb()
results = ia.search_movie(movie)
mv = results[0] #First result
URL = ia.get_imdbURL(mv) #URL for first result 
```

再次感谢绫。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:40:23.933

从[文档](http://imdbpy.sourceforge.net/docs/README.package.txt)...

> get_imdbURL(MovieOrPersonOrCharacterOrCompanyObject) 方法返回一个字符串，其中包含给定 Movie、Person、Character 或 Company 对象的主 IMDb URL；它会尽力检索 URL。

# c++ - C++ STL 容器。为每个不同的实例参数化一个比较器

> ID：16042299
> 
> 赞同：1
> 
> 时间：2013-04-16T16:29:56.843
> 
> 标签：c++, stl, priority-queue, predicate

我有一组表示地图中坐标的*n 个*对象，我希望它们中的每一个都保持一个**priority_queue**，其中*k*最接近它们的位置。

问题是**priority_queue**接收谓词类而不是函数对象，所以我还没有找到为每个**priority_queue指定不同***参考点的方法*

 **即类似的东西：

```
std::priority_queue<
  Vertex*, 
  std::vector<Vertex*>, 
  DistanceComparer(fromVertex)> 
  pqueue; // doesn't compile 
```

相对于：

```
DistanceComparer::from = fromVertex;
std::priority_queue<
  TRVertex*, 
  std::vector<TRVertex*>, 
  DistanceComparer> 
  pqueue; // compiles but unhelpful 
```

*从*静态制作真的没有帮助，因为我需要为每个**priority_queue使用不同的***点参考*

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:36:33.823

您需要将类作为模板参数传递，并将类的对象作为参数传递给构造函数，因此：

```
std::priority_queue<
    TRVertex*, 
    std::vector<TRVertex*>, 
    DistanceComparer> 
  pqueue(DistanceComparer(fromVertex)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:38:29.977

`std::priority_queue`具有构造函数重载，采用比较器类的一个 istance。因此，您只需将比较器设计为有状态的（您似乎已经这样做了），并相应地构造优先级队列：

```
struct Vertex
{
  std::priority_queue<Vertex*, std::vector<Vertex*>, DistanceComparer> pqueue;
  explicit Vertex(fromVertex *v) : pqueue(v) {}
}; 
```****

# java - Parse KML works ok on java but not in android

> ID：16042303
> 
> 赞同：1
> 
> 时间：2013-04-16T16:30:16.170
> 
> 标签：java, android, jar, inputstream, sax

I made some classes to read KML files, (using SAX) in Java. I test it, and it works fine. Then I made my jar, and imported it to android project. But when I try to read the SAME kML, I don't got any result. The parser returns me empty list(vector)

Thats how I made in Java:

```
Vector<Point> listPoints = new Vector<Point>();
String src = "C:/Users/A556520/Documents/Proyectos/PolygonDoubleKML/res/Glorias_def.kml";       
InputStream inputStream =new FileInputStream(src);      
ReaderKML kmlreader = new ReaderKML(inputStream);
time_start = System.currentTimeMillis();
listPoints = kmlreader.parseKML();
time_end = System.currentTimeMillis();
System.out.println("Tiempo de ejecución: "+ (time_end-time_start)/1000f); 
```

And the output its correct --> Tiempo de ejecución: 0.073 || Npoints = 401

Then as I told, I import the jar, to the Android project, and thats how I do:

```
Vector<Point> lista;
Polygon glorias;
ReaderKML kmlReader;
String pathKML = "~res/raw/glorias_def.kml";
InputStream input_kml;

@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);
input_kml = getResources().openRawResource(R.raw.glorias_def);
kmlReader = new ReaderKML(input_kml);
lista = kmlReader.parseKML();       
}

protected void onStart() {
    super.onStart();        
    tv_1.setText("Npoints = "+Integer.toString(lista.size()));
} 
```

And what I get in the textView is `Npoints = 0`, when it has to be `Npoints = 401`... I don't understand what is wrong... The kml file, is inside ~res/raw and it's the same that I used to test in Java.

# java - UTC 时间戳未返回正确时间

> ID：16042306
> 
> 赞同：1
> 
> 时间：2013-04-16T16:30:37.407
> 
> 标签：java, android, simpledateformat, date-formatting

我从服务器中获取日期字符串，`EST`因此我将其转换

示例日期`2013-04-16T11:56:07.15`

```
incidentDate = l.item(0).getTextContent();                                  
DateFormat dformat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS",Locale.US);
dformat.setTimeZone(TimeZone.getTimeZone("America/New York"));
Date timestamp;

try
{                                   
    timestamp = dformat.parse(incidentDate);
    incidentDateLong = timestamp.getTime();

}
catch (ParseException e1) {
    e1.printStackTrace();
} 
```

返回的时间戳是`1366113367015`

如果我将其插入本网站上的转换器以检查日期

[http://www.ruddwire.com/handy-code/date-to-millisecond-calculators/](http://www.ruddwire.com/handy-code/date-to-millisecond-calculators/)

毫秒似乎不是正确的日期，它给了我`Tue Apr 16 2013 07:56:07 GMT-0400 (Eastern Daylight Time)`不是从服务器发送给我的。

当我去转换日期时，它会将日期拉回更远离实际日期

```
Date incDate = new Date(dateInMili);

DateFormat dformat = new SimpleDateFormat("MM/dd/yyyy hh:mm:ss a",Locale.US);

String dateStr = dformat.format(incDate); 
```

我的格式化程序有问题吗？我不明白这个问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:35:21.790

这就是问题：

```
TimeZone.getTimeZone("America/New York") 
```

这不是有效的时区 ID。你要：

```
TimeZone.getTimeZone("America/New_York") 
```

注意下划线。就我个人而言，我认为`getTimeZone`没有任何迹象表明它实际上没有找到你所要求的时区是一种耻辱，但这种情况已经很久了:(

# mongodb - Mongo字段A大于字段B

> ID：16042315
> 
> 赞同：29
> 
> 时间：2013-04-16T16:31:26.940
> 
> 标签：mongodb

我正在 Mongo 中尝试一个简单的查询，在 MySQL 中看起来像这样。

```
select * from emails where bounceCount > sentCount; 
```

到目前为止我有。

```
db.email.find({ bounceCount : { $gt : sentCount } } ); 
```

但我得到这个错误

```
JS Error: ReferenceError: sentCount is not defined (shell):0 
```

如何在那个 shell 中引用 sentCount？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2018-04-02T19:05:59.453

它应该可以解决问题：

```
db.emails.find({ $expr: { $gt: [ "$bounceCount" , "$sentCount" ] } }); 
```

这是我找到它的参考： [https ://docs.mongodb.com/manual/reference/operator/query/expr/#op._S_expr](https://docs.mongodb.com/manual/reference/operator/query/expr/#op._S_expr)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-04-16T18:19:12.270

每个人似乎都在`$where`不知不觉中提到它：

*   减缓
*   不安全（评估）
*   JavaScript，而不是 MongoDB 内部
*   而且，在 2.4 之前的版本中，单线程和全局锁定

另一种对于大约 99% 的情况会更好的方法是使用聚合框架：

```
db.col.aggregate([
    {$project: {ab: {$cmp: ['$bounceCount','$sentCount']}}},
    {$match: {ab:{$gt:0}}}
]) 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-04-16T16:45:31.937

`db.so.find("this.bounceCount > this.sentCount")`就是你要找的。

相等的：`db.so.find({"$where":"this.bounceCount > this.sentCount"})`

文档：[http ://docs.mongodb.org/manual/reference/operator/where/](http://docs.mongodb.org/manual/reference/operator/where/)

外壳输出：

```
> db.so.insert({bounceCount:1, sentCount:2})
> db.so.insert({bounceCount:5, sentCount:3})
> db.so.insert({bounceCount:5, sentCount:4})
> db.so.insert({bounceCount:5, sentCount:7})
> db.so.insert({bounceCount:9, sentCount:7})

> db.so.find()
{ "_id" : ObjectId("516d7f30675a2a8d659d7594"), "bounceCount" : 1, "sentCount" : 2 }
{ "_id" : ObjectId("516d7f37675a2a8d659d7595"), "bounceCount" : 5, "sentCount" : 3 }
{ "_id" : ObjectId("516d7f3b675a2a8d659d7596"), "bounceCount" : 5, "sentCount" : 4 }
{ "_id" : ObjectId("516d7f3d675a2a8d659d7597"), "bounceCount" : 5, "sentCount" : 7 }
{ "_id" : ObjectId("516d7f40675a2a8d659d7598"), "bounceCount" : 9, "sentCount" : 7 }

> db.so.find({"bounceCount":5})
{ "_id" : ObjectId("516d7f37675a2a8d659d7595"), "bounceCount" : 5, "sentCount" : 3 }
{ "_id" : ObjectId("516d7f3b675a2a8d659d7596"), "bounceCount" : 5, "sentCount" : 4 }
{ "_id" : ObjectId("516d7f3d675a2a8d659d7597"), "bounceCount" : 5, "sentCount" : 7 }

> db.so.find("this.bounceCount > this.sentCount")
{ "_id" : ObjectId("516d7f37675a2a8d659d7595"), "bounceCount" : 5, "sentCount" : 3 }
{ "_id" : ObjectId("516d7f3b675a2a8d659d7596"), "bounceCount" : 5, "sentCount" : 4 }
{ "_id" : ObjectId("516d7f40675a2a8d659d7598"), "bounceCount" : 9, "sentCount" : 7 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T16:46:18.083

您可以使用 $where 运算符来执行此操作，这使您可以在查询中使用 Javascript 代码。

对于您的示例，您将执行以下操作：

```
db.email.find({ $where: "this.bounceCount > this.sentCount" }); 
```

有关 $where 运算符的更多详细信息，请参阅 MongoDB 文档页面：http: **[//docs.mongodb.org/manual/reference/operator/where/#op._S_where](http://docs.mongodb.org/manual/reference/operator/where/#op._S_where)**

# java - 队列上的最大活动 MQ 消费者数

> ID：16042317
> 
> 赞同：3
> 
> 时间：2013-04-16T16:31:32.017
> 
> 标签：java, jms, activemq

我正在设置一个需要扩展的应用程序。我将消息发布到 Active MQ 并从那里读取消息。

到目前为止，我已经使用了最多 3 个并发消费者指向一个队列（每个消费者从不同的物理机器上操作）。

我需要知道最多可以有多少消费者指向 Active MQ 中的队列。

它有最大限制吗？

我找到了这个链接：

[http://activemq.apache.org/multiple-consumers-on-a-queue.html](http://activemq.apache.org/multiple-consumers-on-a-queue.html)

但它没有说明关于最大连接数/会话数/消费者的任何信息。它只说每个连接一个会话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T09:30:10.857

JMS 规范没有规定对消费者数量的任何限制。您可以为给定的队列或主题添加任意数量的消费者。

问题是你真正需要多少消费者。增加消费者的数量将允许您进行更多的并行处理，但您将面临内存问题。例如，如果您在一台机器上启动数千个消费者，它只会启动数千个将消耗内存的线程。

此外，如果单个队列有多个消费者，最好让选择器从队列中过滤掉消息，这样您就可以对消息进行一些控制以及哪些侦听器应该使用它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T16:54:25.930

任意数量的消费者都可以指向该队列。但只有 1 个消费者能够访问该队列中的对象。一旦它检索到对象，该特定消费者将断开连接，其他消费者将连接到您的队列。您可以在 xml 文件中指定队列的大小。您可以在某些搜索引擎中轻松找到它。我不记得确切的标签名称。

# android - 自定义 Android 活动过渡

> ID：16042327
> 
> 赞同：-3
> 
> 时间：2013-04-16T16:31:54.027
> 
> 标签：android, android-activity, transitions

我正在尝试模仿 Android twitter 应用程序活动转换。但我没有得到同样的效果。有人可以建议一种方法来做到这一点。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T16:51:06.763

也许是这样的？

在您的第一个 Activity`onCreate()`方法中：

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button btn = (Button) findViewById(R.id.btnExample);
        btn.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                Intent i = new Intent(MainActivity.this, Test.class);
                startActivity(i);
                overridePendingTransition(R.anim.slide_in_right, R.anim.fade_out);
            }
        });

    } 
```

slide_in_right.xml：

```
<?xml version="1.0" encoding="utf-8"?>

<set xmlns:android="http://schemas.android.com/apk/res/android" >

    <translate
        android:duration="@android:integer/config_mediumAnimTime"
        android:fromXDelta="100%p"
        android:toXDelta="0" />

</set> 
```

淡出.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<alpha xmlns:android="http://schemas.android.com/apk/res/android"
    android:duration="@android:integer/config_mediumAnimTime"
    android:fromAlpha="1.0"
    android:interpolator="@android:interpolator/accelerate_quad"
    android:toAlpha="0.0" /> 
```

第一个活动现在将淡出，第二个活动将从右侧滑入。

# java - 设置背景图片

> ID：16042328
> 
> 赞同：1
> 
> 时间：2013-04-16T16:31:54.870
> 
> 标签：java, swing, jframe, jpanel, background-image

我怎样才能摆脱那个灰色的盒子？

这就是我所说的：

![](https://i.stack.imgur.com/3xGT5.png)

如果您能帮助我，我将不胜感激

完整代码在这里： http: [//pastebin.com/nrpCTjvV](http://pastebin.com/nrpCTjvV)

```
public final void initUI() {

    JPanel panel = new JPanel();
    panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));

    panel.setBorder(new EmptyBorder(new Insets(90, 155, 40, 60)));

    JButton NewGame = new JButton  ("New Game!");
    JButton Highscore = new JButton("Highscore");
    JButton Credits = new JButton  ("Credits");
    JButton Website = new JButton  ("Website");
    JButton Exit = new JButton     ("Exit");

    panel.add(NewGame);
    panel.add(Box.createRigidArea(new Dimension(0, 5)));
    panel.add(Highscore);
    panel.add(Box.createRigidArea(new Dimension(0, 5)));
    panel.add(Credits);
    panel.add(Box.createRigidArea(new Dimension(0, 5)));
    panel.add(Website);
    panel.add(Box.createRigidArea(new Dimension(0, 5)));
    panel.add(Exit);

    final ButtonGroup entreeGroup = new ButtonGroup();
    JRadioButton radioButton;
    panel.add(radioButton = new JRadioButton("Music1"));
    radioButton.setActionCommand("Music1");
    entreeGroup.add(radioButton);
    panel.add(radioButton = new JRadioButton("Music2"));
    radioButton.setActionCommand("Music2");
    entreeGroup.add(radioButton);
    panel.add(radioButton = new JRadioButton("No Music", true));
    radioButton.setActionCommand("No Music");
    entreeGroup.add(radioButton);

    add(panel);
    pack();

    setTitle("Title");
    JLabel background = new JLabel(new ImageIcon("background.png"));
add(background);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setLocationRelativeTo(null);
    setResizable(false);
    setSize(400, 400);

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:43:51.120

```
add(panel);
pack();
setTitle("Title");
JLabel background = new JLabel(new ImageIcon("background.png"));
add(background); 
```

JFrame 的默认布局管理器是 BorderLayout。当您在未指定约束的情况下添加组件时，该组件将添加到 CENTER。您不能将多个组件添加到单个位置。

相反，您需要使用不同的组件作为背景。然后将面板添加到此组件。查看[背景面板](http://tips4java.wordpress.com/2008/10/12/background-panel/)。然后代码将类似于：

```
Background background = new BackgroundPanel(...);
background.add(panel);
add(background);
setResizable(false);
pack();
... 
```

# python - 从中获取字符串 无标签

> ID：16042330
> 
> 赞同：2
> 
> 时间：2013-04-16T16:31:57.600
> 
> 标签：python, beautifulsoup

我有一个 HTML 代码如下：

```
<div class="content">
    <div class="title">
        <a id="hlAdv" class="title" href="./sample.aspx">
            <font size=2>Pretty Beauty Fiesta -1st Avenue Mall!</font>
        </a>
    </div>
    19<sup>th</sup> ~ 21<sup>st</sup> Apr 2013
</div> 
```

我现在正在使用 Python，并尝试使用 BeatifulSoup 找出日期。我期望的是：

```
19th ~ 21st Apr 2013 
```

我试过了：

```
find("div", {"class":"content"}).text 
```

输出：

```
Pretty Beauty Fiesta -1st Avenue Mall!19th ~ 21st Apr 2013 
```

和，

```
find("div", {"class":"content"}).div.nextSibling 
```

输出：

```
19 
```

我尝试使用更多 nextSibling 来获取内容，但我仍然无法正确获取“st Apr 2013”​​。

我怎样才能得到我想要的数据？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:51:21.797

您的问题是您*想要*在`div`.

你想[`.next_siblings`](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#next-siblings-and-previous-siblings)在这里循环使用：

```
content_div = soup.find('div', class_='content')
text = []
for elem in content_div.div.next_siblings:
    try:
        text.extend(elem.strings)
    except AttributeError:
        text.append(elem)
text = ' '.join(text).strip() 
```

`.next_siblings`是一个生成器，它简单地生成`.next_sibling`属性链，包括`NavigableString`元素。

结果是：

```
>>> ''.join(text).strip()
u'19th ~ 21st Apr 2013' 
```

在这里如何处理空格可能有点棘手；*之后*的剥离最适合这个特定的例子，但对于其他例子来说，使用`elem.stripped_strings`and`elem.strip()`也可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:52:15.690

这个怎么样？它用于`element.nextSiblingGenerator`遍历您关心的 div 后面的元素，并忽略最后的 None 。

```
d = s.find('div', {'class':'content'}).div

def all_text_after(element):
    for item in element.nextSiblingGenerator():
        if not item:
            continue
        elif hasattr(item, 'contents'):
            for c in item.contents:
                yield c
        else:
            yield item

text_parts = list(all_text_after(d))
# -> [u'\n    19', u'th', u' ~ 21', u'st', u' Apr 2013\n']

print ''.join(text_parts)
# ->     19th ~ 21st Apr 2013 
```

# c# - 如何在 WPF 中创建可编辑的树列表视图？

> ID：16042333
> 
> 赞同：3
> 
> 时间：2013-04-16T16:32:11.420
> 
> 标签：c#, .net, wpf, blend

我需要`TreeListView`为我的项目创建一个可编辑的。但据我所知，`WPF`它没有提供任何类型的树列表视图，而且我在网上找到的那些信息也不是很丰富。我想使用创建一些东西`blend`，然后将其应用到我的`WPF`项目中。

有人对此有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T13:51:36.023

我用过这样的东西，也许这会帮助你找到一个北方

```
<dxg:GridControl Name="GridName" Grid.Row="0">

<dxg:GridControl.Columns>

    <dxg:GridColumn FieldName="ID" Header="ID" 
                    AllowEditing="false" 
                    AllowMoving="False" AllowGrouping="False" AllowSorting="False"
                    >
    </dxg:GridColumn>

    <dxg:GridColumn Name="Name" FieldName="Name" Header="Name" AllowEditing="true"
                    AllowMoving="False" AllowGrouping="False" AllowSorting="False" >
    </dxg:GridColumn>

</dxg:GridControl.Columns>

<dxg:GridControl.View>
    <dxg:TreeListView Name="TreePeople" AutoWidth="True"
        KeyFieldName="Id" ParentFieldName="ParentId"
        TreeDerivationMode="Selfreference"
        MultiSelectMode="Row" EditorShowMode="MouseUpFocused" ShowingEditor="TreePeople_ShowingEditor" CellValueChanging="TreePeople_CellValueChanging" >
        <dxg:TreeListView.RowCellMenuCustomizations>
            <dxb:BarButtonItem BarItemName="btnAddRow"  />
            <dxb:BarButtonItem BarItemName="btnRemoveRow"  />
        </dxg:TreeListView.RowCellMenuCustomizations>
    </dxg:TreeListView>
</dxg:GridControl.View>

<i:Interaction.Behaviors>
    <dxg:TreeListDragDropManager AllowDrag="True" AllowDrop="True" AllowAutoExpand="True" Drop="TreeListDragDropManager_Drop" Dropped="TreeListDragDropManager_Dropped" />
</i:Interaction.Behaviors> 
```

您需要先启动一个列表

```
public void constructor()
{
    try
    {
        IPeople cli = ProxyFactory.GetPeopleSvc();
        List<People> list = cli.GetClassification();

        if (list.count > 0)
        {
            ObservableCollection<People> tmp = new ObservableCollection<People>(list);
            GridName.ItemsSource = tmp;
        }
    }
    catch (Exception e)
    {
        Message.Show(e);
    }
} 
```

# variables - 操作系统名称变量

> ID：16042339
> 
> 赞同：1
> 
> 时间：2013-04-16T16:32:19.810
> 
> 标签：variables, batch-file, operating-system, windows-7-x64, placeholder

我想运行一个脚本，我可以在其中获取公司中运行的所有计算机的 Windows 名称和系统版本，并将其放入文本文件中。然后用我的 windows name 制作一个系统变量。我知道要运行什么，但我遇到问题的地方是占位符。所以这是我的代码：

```
 :OS_NAME
    Set OS_NAME= systeminfo | find "OS Name"

    :OS_Ver
    Set OS_Version= systeminfo | findstr /B /C:"OS Version"

    systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /c:"BIOS Version" |  >> G:\Directory\%Computername%

    :OS_Arch
    IF exist "%programfiles(x86)% (SET OS_ARCH=X64)
    Else (SET OS_ARCH=X86)

    :Win_7
    systeminfo | find "Microsoft Windows 7" > nul
        if %ERRORLEVEL% == 0 (
            goto ver_7)

    :Ver_7
    Set Win7= systeminfo | find "Microsoft Windows 7"
    Echo %computername% is running %WIN7% in %OS_ARCH% Environment >> G:\Directory\Win7Comps.txt 
```

所以基本上我想要一个 Systeminfo 结果的占位符，当我制作我的系统变量时，我可以参考并解析我的 SET 命令。

谢谢，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T18:40:21.750

不完全确定您在寻找什么，但我看到的最大问题是它`systeminfo`需要永远运行并返回比您正在寻找的更多信息。您最好使用捕获 wmi 查询`wmic`。这基本上是对您的示例脚本的重写，只是使用`wmic`而不是`systeminfo`. 它应该快得多。

```
@echo off
setlocal
set prefix=G:\Directory

for /f "usebackq tokens=1,2 delims==|" %%I in (`wmic os get name^,version /format:list`) do 2>NUL set "%%I=%%J"
for /f "tokens=2 delims==" %%I in ('wmic bios get version /format:list') do set "bios=%%I"
for /f "tokens=2 delims==" %%I in ('wmic computersystem get model /format:list') do set "model=%%I"

>>"%prefix%\%COMPUTERNAME%" echo OS Name: %name%
>>"%prefix%\%COMPUTERNAME%" echo OS Version: %version%
>>"%prefix%\%COMPUTERNAME%" echo PC Model: %model%
>>"%prefix%\%COMPUTERNAME%" echo BIOS Version: %bios%

if defined PROGRAMFILES(x86) (set arch=X64) else set arch=X86

if "%name%" neq "%name:Windows 8=%" (
    set out=%prefix%\Win8Comps.txt
) else if "%name%" neq "%name:Windows 7=%" (
    set out=%prefix%\Win7Comps.txt
) else if "%name%" neq "%name:Windows Vista=%" (
    set out=%prefix%\WinVistaComps.txt
) else if "%name%" neq "%name:Windows XP=%" (
    set out=%prefix%\WinXPComps.txt
)

>>"%out%" echo %COMPUTERNAME% is running %name% in %arch% environment 
```

键入`wmic /?`以获取更多信息，并尝试`wmic computersystem get /?`或类似方式查看每个类下可以查询的项目列表。

* * *

`wmic`是 Windows 的瑞士军刀。有趣的事实：您甚至可以使用它`wmic`来[生成远程系统上已安装软件的网页](https://stackoverflow.com/a/14880444/1683264)表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:12:38.980

你给了批次太多的信用。如果你运行`echo %OS_NAME%`它，它会从字面上回显`systeminfo | find "OS Name"`。批处理中的变量总是会扩展，不会进一步处理。`find "OS Name"`当您尝试设置变量时，这也很可能会尝试运行，因为`|`没有转义也没有用双引号括起来。

如果要将命令的输出设置为一个值，则必须在`for`如下语句中捕获它：

```
for /f "tokens=2 delims=:" %%a in ('systeminfo ^| find "OS Name"') do set OS_Name=%%a 
```

然后像这样删除前导空格：（可能有更好的方法来做到这一点）

```
for /f "tokens=* delims= " %%a in ("%OS_Name%") do set OS_Name=%%a 
```

这里有几点需要注意。1.)`"tokens=2 delims=:"`将分隔符设置为`:`，它只选择第二部分，这将只拉出你想要的部分。2.)`|`用 a 转义`^`，这需要在`for`循环中完成，或者之后的任何操作都将尝试作为单独的命令执行。3.)`"tokens=* delims= "`这里的记号是*，它是所有记号。

我发现的其他一些问题。

```
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /c:"BIOS Version" |  >> G:\Directory\%Computername% 
```

这在最后有一个额外的`|`字符。

```
IF exist "%programfiles(x86)% (SET OS_ARCH=X64)
Else (SET OS_ARCH=X86) 
```

这里有两个问题，您没有完成路径周围的双引号，并且`else`必须与 if 语句的结尾括号位于同一行，如下所示：

```
IF exist "%programfiles(x86)% (SET OS_ARCH=X64
) Else (SET OS_ARCH=X86) 
```

否则它会尝试`else`按照自己的命令进行处理

# css - 跨度：悬停在 Firefox 中不起作用

> ID：16042340
> 
> 赞同：0
> 
> 时间：2013-04-16T16:32:23.913
> 
> 标签：css, hover, opacity, transition, html

我不知道为什么，但是 :hover 在我的代码上的 Firefox 中不起作用。它在 Chrome 和 Safari 中运行良好，即使在 IE 中也运行良好。

我也尝试过 .over ，但没有任何改变。

html代码：

```
<div id="proekti">
        <article id="red1" class="sliki">
            <span>
                <div class="text">
                <h3></h3>
                </div>
            </span>
            <div></div>

            <span>
                <div class="text">
                <h3></h3>
                </div>
            </span>
           <div></div>

            <span>
                <div class="text">
                <h3></h3>
                </div>
            </span>
            <div></div>

            <span>
                <div class="text">
                <h3></h3>
                </div>
            </span>
            <div></div>
        </article>
</div> 
```

CSS代码：

```
#proekti .sliki > div {
    width:25%;
    display:inline;
    float:left;
    position:relative;
    border:0;
    margin:0;
    padding:0;
    overflow:hidden;
}

article.sliki > span {
    width:25%;
    height:100%;
    display:inline-block;
    position:absolute;
    border:0;
    margin:0;
    padding:0;
    overflow:hidden;
    background: rgba(55,55,55,0.6);
    color:#FFF;
    opacity:0;
    z-index:1000;
}

article.sliki > span:hover {
    transition:all 1s ease-out;
    -webkit-transition:all 1s ease-out;
    -moz-transition:all 1s ease-out;
    -o-transition:all 1s ease-out;
    opacity:1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:56:06.650

你的代码是错误的。SPAN 是一个 INLINE 元素，但您在其中放置了 DIV（块元素）。这是无效的。您只能在另一个内联元素中使用内联元素。

这不是一个好的解决方案，但是如果您将 {display:block;} 属性添加到 span (article.sliki > span)， :hover 将为您工作。

# r - 转换错误 - .subset2(x, i, exact = exact) 中的错误

> ID：16042342
> 
> 赞同：5
> 
> 时间：2013-04-16T16:32:29.163
> 
> 标签：r, reshape2

感觉好像我在这里遗漏了一些明显的东西，所以提前道歉。无论如何，这里有一些`a`我正在尝试投射的数据：

```
acct_num     year_prem    prem       exc
001          2012         2763585 exclusive
001          2011         2377688 exclusive
001          2010         2083065 exclusive
001          2009         1751722 exclusive
001          2008         1639484 exclusive 
```

但是，铸造给了我一个我无法弄清楚/解释的错误：

```
b <- dcast(a, formula= acct_num + exc ~ year_prem, value.var= prem, fill= NA)

Error in .subset2(x, i, exact = exact) : invalid subscript type 'list' 
```

我不认为我需要`fill= NA`. 但是无论有没有它，我都会遇到同样的错误。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:38:13.337

你应该加上`prem`引号，然后它就可以工作了。函数`dcast()`期望`value.var=`将是列的名称（如此引用）。

```
> dcast(a, formula= acct_num + exc ~ year_prem, value.var= "prem", fill= NA)
  acct_num       exc    2008    2009    2010    2011    2012
1        1 exclusive 1639484 1751722 2083065 2377688 2763585 
```

# matlab - 矩阵除法元素matlab

> ID：16042344
> 
> 赞同：2
> 
> 时间：2013-04-16T16:32:32.077
> 
> 标签：matlab, matrix

我有以下向量：

```
a = [1 2];
b = [0.25 0.5]; 
```

我想获得一个 2x2 矩阵`c`：

```
c = [1/0.25+1/0.5  2/0.25+1/0.5  
     1/0.25+2/0.5  2/0.25+2/0.5]; 
```

我的目标是在以后用更多的值扩展这个模型

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:43:29.087

最好的线性代数：

```
(1./b')*a 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:38:06.003

`repmat(a,size(b,2),1)./repmat(b',1,size(a,2))`

# c# - 如何解决 c# winforms 中的“Invalid Printer Specified”错误？

> ID：16042346
> 
> 赞同：0
> 
> 时间：2013-04-16T16:32:35.403
> 
> 标签：c#, crystal-reports-2010

我确信这是一个经常被问到的问题，但我找不到任何适合我的答案。请考虑以下情况。

**场景**
我已经使用**SAP Crystal Report** for **VS2010**为餐厅开发了一个**C# Winform**应用程序。完成订单后，发票需要直接打印到打印机上。下面是我正在使用的代码。

 ****```
oMainOrder.SetDataSource(oDSOrderReport);

if (_sPrintOrShow.ToLower() == "print")
{
   oMainOrder.PrintOptions.PrinterName = printDialog.PrinterSettings.PrinterName;
   //Above line provides the name of the default printer, which is also my target printer

   oMainOrder.PrintToPrinter(1, false, 0, 0);
}

else
{
   frmShowReport reportViewerForm = new frmShowReport(oDSOrderReport);
   reportViewerForm.ShowDialog();
} 
```

**_sPrintOrShow**是一个变量，用于确定发票是直接发送到打印机还是加载到报表查看器表单中。当**_sPrintOrShow**设置为**print**时，很可能会将发票发送到打印机。在我和我的 USB 打印机上，这工作正常。但是当我向我的客户提供同样的解决方案时，他得到了异常“**指定的打印机无效**”。更令人沮丧的是，如果发票是在报表查看器表单中加载的，那么我可以从那里毫无问题地将发票打印到同一台打印机上。我完全不知道，为什么会这样？你们中的任何人都可以像以前那样帮助我吗？谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-16T17:04:02.640

经过快速搜索后，我发现了一个使用相同代码的示例，有人通过 SAP 论坛发布说它不能按预期工作，并为此提供了一行[Matt Ruma](http://www.mattruma.com/?p=258)。值得一试不确定它是否只是试图提供帮助。****

# spring - 在 Spring 中注入通用参数化属性

> ID：16042349
> 
> 赞同：1
> 
> 时间：2013-04-16T16:32:40.563
> 
> 标签：spring, generics, dependency-injection, autowired

注入通用参数化属性的最佳解决方法是什么？

[Spring Jira](https://jira.springsource.org/browse/SPR-5561)中记录的简单示例：

```
@Component
public abstract class AbstractFoo<V extends Bar> {

   @Autowired
   protected V bar;
}

@Component
public ConcreteFoo1 extends AbstractFoo<ConcreteBar1> {
}

@Component
public ConcreteFoo2 extends AbstractFoo<ConcreteBar2> {
} 
```

当我有这样的抽象`AbstractFoo`类并尝试确定应该通过generecis（`ConcreteFoo1`，`ConcreteFoo1`）注入的Spring bean时，Spring会抛出异常，例如：

```
org.springframework.beans.factory.BeanCreationException: 
Error creating bean with name 'foo.ConcreteFoo1'
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: 
No unique bean of type [bar.Bar] is defined: 
expected single matching bean but found 2: [concreteBar1, concreteBar2] 
```

我在 Spring 3.2.1 中测试了类似的场景。这个问题的最佳解决方法是什么？

2009 年 3 月 10 日报告了此问题。
为什么这个功能还没有在 Spring 中实现？是否有任何并发​​症阻止解决这个不足？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T05:51:06.480

就像你写的那样：

```
 @Autowired
  protected Bar bar; 
```

Spring 只是无法理解您要注入 ConcreteBar1

因此，您可以使用 setter 注入：

```
public abstract class AbstractFoo<V extends Bar> {
    protected V bar;
} 

@Component
public class ConcreteFoo1 extends AbstractFoo<ConcreteBar1>{

@Inject
private void setBar(ConcreteBar1 bar){
    this.bar = bar;
}
} 
```

# core-data - Core Data iPhone App - 在生产阶段更新记录

> ID：16042355
> 
> 赞同：0
> 
> 时间：2013-04-16T16:32:52.500
> 
> 标签：core-data, production-environment, updating

我目前正在开发我的第一个 Core Data iPhone 应用程序，希望您对如何在应用程序获得批准后在生产阶段更新记录/进行一般维护提出意见。

所有的公共场景当然都对用户可用，但是一些“只有管理员”可以访问的场景必须是私有的或被保护不被公共访问。您在这方面找到的最佳策略是什么？例如，我正在考虑，例如在主表视图和编辑/添加新行场景之间插入一个登录和密码场景以更新新行或标签标题。

如何推送这些更新，以便可以将更改重新部署到生产应用程序（应用商店）如何使用基于服务器的解决方案等外部源提交更新？在这种情况下如何更新持久存储？我有

这个应用程序是教师研讨会培训课程的简单表格视图列表（即数学 101、代数 I、代数 I、高级代数等），人们可以在参加课程后在详细视图中写下反馈说明通过单击任何行来创建场景。

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:04:42.930

一般来说，您应该避免在您的应用程序中使用“后门”。将所有不属于用户的控制器完全从生产目标中*删除。*

至于未来数据模型的变化，一旦你对 Core Data API 更加熟悉，你会发现你想做的事情非常简单。

至于数据模型的更新——除了最复杂的情​​况外，它可以是完全自动的。只需对您的数据模型进行版本化，确保在添加持久存储时启用自动迁移选项，并且您可以简单地在应用商店上使用新版本更新您的生产应用 - 所有迁移都将自动为您完成。

# javascript - 在 .row-fluid 容器中引导 .row

> ID：16042357
> 
> 赞同：2
> 
> 时间：2013-04-16T16:32:54.703
> 
> 标签：javascript, css, twitter-bootstrap, fluid-layout

我希望能够将固定跨度 div ( span1..span12) 放置在**.row-fluid**容器中。

```
<div class="row-fluid">
<div class="span5 red">

    <div class="row">
         <div class="span3 gray">
             I need this to span exactly 300px, not 31% of its parent
        </div>
    </div>
</div>

<div class="span5 blue">
</div> 
```

这是工作的 jsbin（遗憾的是，您需要放大输出窗格）--> [http://jsbin.com/uwecuv/1/edit](http://jsbin.com/uwecuv/1/edit)

这个想法是css选择器（.row-fluid span3）在这种情况下优先。

你们有什么想法可以让'div.span3.gray'跨度300px吗？

原因是在实际场景中它将是一个绝对定位的 div，我不希望它继承父级的大小（顺便说一句，它只是一个带有输入框的 div）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T13:39:54.127

Bootstrap 网格系统的设计`span3`意味着元素的宽度=容器宽度的 3/12（`row`或`row-fluid`）。因此，如果您需要固定宽度 = 300px（不是容器宽度的 3/12）的 div，您需要使用自己的宽度 = 300px 的 css 类。或者您可以使用没有响应式 css 的固定布局。

# python - pyodbc & MS SQL Server - “没有结果。以前的 SQL 不是查询。”

> ID：16042359
> 
> 赞同：4
> 
> 时间：2013-04-16T16:33:23.043
> 
> 标签：python, sql-server, pyodbc

我正在使用 pyodbc 从 Microsoft SQL Server 检索数据。查询格式如下

```
SET NOCOUNT ON --Ignore count statements

CREATE TABLE mytable ( ... )

EXEC some_stored_procedure
INSERT mytable

--Perform some processing...

SELECT *
FROM mytable 
```

存储过程对包含`NULLs`发出表单警告的值执行一些聚合`Warning: Null value is eliminated by an aggregate or other SET operation.`。这导致 pyodbc 无法使用错误消息检索数据`No results. Previous SQL was not a query.`

我试图通过设置来禁用警告`SET ANSI_WARNINGS OFF`。但是，查询随后会失败并显示错误消息`Heterogeneous queries require the ANSI_NULLS and ANSI_WARNINGS options to be set for the connection. This ensures consistent query semantics. Enable these options and then reissue your query.`。

是否有可能

*   禁用警告
*   还是让 pyodbc 忽略警告？

请注意，我没有更改存储过程的权限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T08:30:12.350

将查询结果存储在临时表中，并将语句作为两个查询执行：

```
with pyodbc.connect(connection_string) as connection:
    connection.execute(query1)            #Do the work
    result = connection.execute(query2)   #Select the data
    data = result.fetchall()              #Retrieve the data 
```

第一个查询完成繁重的工作，其形式为

```
--Do some work and execute complicated queries that issue warning messages

--Store the results in a temporary table
SELECT some, column, names
INTO #datastore
FROM some_table 
```

第二个查询检索数据，其形式为

```
SELECT * FROM #datastore 
```

因此，在执行第一个查询时发出所有警告消息。它们不会在执行第二个查询期间干扰数据检索。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-02-26T14:44:34.127

我通过在有问题的视图或存储过程周围打开和关闭 ansi_warnings 来减轻这个错误。

```
/* vw_someView aggregates away some nulls and presents warnings that blow up pyodbc */
set ANSI_WARNINGS off
select *
into #my_temp
from vw_someView
set ANSI_WARNINGS on

/* rest of query follows */ 
```

这假定产生聚合警告的实体也不需要打开警告。如果它抱怨，这可能意味着实体本身有一部分这样的代码需要切换 ansi_warnings（或重写以消除聚合。）

一个问题是，如果我尝试将其作为跨服务器查询运行，我发现此切换仍会返回“异构”警告。此外，在调试时，很容易进入 ansi_warnings 在您没有意识到的情况下被关闭的状态，并且您似乎无缘无故地开始出现异构错误。只需单独运行“set ANSI_WARNINGS on”行，即可让自己恢复到良好状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-08T06:21:41.930

最好的办法是添加 try: except: block

```
sql="sp_help stored_procedure;"
print(">>>>>executing {}".format(sql))
next_cursor=cursor.execute(sql)
while next_cursor:
try:
    row = cursor.fetchone()
    while row:
        print(row)
        row = cursor.fetchone()
except Exception as my_ex:
    print("stored procedure returning non-row {}".format(my_ex))
next_cursor=cursor.nextset() 
```

# php - PHP 卷曲错误 58

> ID：16042361
> 
> 赞同：2
> 
> 时间：2013-04-16T16:33:24.697
> 
> 标签：php, curl

需要一些帮助来理解普遍存在的 cURL 58 错误，在这种情况下，这是由于包含带有 cURL 请求的 PEM 文件。

```
 Error 58: unable to set private key file 
```

我的代码可以成功打开 .pem 文件（请参阅 fopen() 调用），但 cURL 抱怨它无法设置私钥文件。试图更好地了解这是客户端（我）上的东西还是从主机返回的东西。很确定它在我的尽头，但不确定是什么。

谢谢

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $this->apiURL);
$fh = fopen($this->certPath,'a+');

if($fh){
         echo "File opened!";
         fclose($fh);
       } else {
         echo "File not opened";
}

    curl_setopt($ch, CURLOPT_SSLCERT, $this->certPath);
    curl_setopt($ch, CURLOPT_POSTFIELDS, trim($SOAPrequest));
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    $result = curl_exec($ch);
    if (curl_error($ch)) {
        printf("Error %s: %s", curl_errno($ch), curl_error($ch));
    }
    curl_close ($ch);

    return $result;
} 
```

钥匙：

```
-----BEGIN CERTIFICATE-----
MIIE0zCCA7ugAwIBAgIQGNrRniZ96LtKIVjNzGs7SjANBgkqhkiG9w0BAQUFADCB
yjELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQL
[...]
-----END CERTIFICATE----- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T12:07:03.923

您的文件不包含任何私钥，只有公钥。
我认为您可能根本没有理由使用 CURLOPT_SSLCERT。

# knockout.js - Durandal 淘汰赛 jchartfx

> ID：16042362
> 
> 赞同：1
> 
> 时间：2013-04-16T16:33:32.887
> 
> 标签：knockout.js, durandal, jchartfx, knockout-extensions

我正在尝试将此组件 jchartfx 与 Durandel 集成。我有一个使用没有 Durandel 的淘汰赛的独立原型，它运行良好，所以我相信这个问题与 Durandel 相关。

这是我的视图模型代码：

```
define(function (require) {
    var http = require('durandal/http');
    var serverUrl = '/api/burndown';
    var chart1;

    function burnDownModel() {
        var self = this;
        self.initilize = true;
        self.displayName = 'Burndown Chart';
        self.description = 'Burndown Chart';
        self.chartData = ko.observableArray([]);
        self.viewAttached = function() {

        };

        // testing with fake data
        self.activate = function () {
            return http.get(serverUrl).then(function (response) {

                for (var i = 0; i < 10; i++) {
                    var data = {
                        "Date": '2013-02-18T00:00:00',
                        "DevCurrentEstimates": 6.5,
                        "TestCurrentEstimates": 7.5,
                        "DevOriginalEstimates": 8.5,
                        "TestOriginalEstimates": 9.5
                    };

                    self.chartData.push(data);
                }

                ko.bindingHandlers.jchartFx = {
                    init: function (element, valueAccessor) {
                        chart1 = new cfx.Chart();
                        chart1.getData().setSeries(4);
                        chart1.getAxisX().getLabelsFormat().setFormat(cfx.AxisFormat.Date);
                        chart1.getAxisX().getLabelsFormat().setCustomFormat("MMM-dd");
                        debugger;

                        var value = ko.utils.unwrapObservable(valueAccessor());
                        chart1.setDataSource(value);
                        chart1.create(element);
                    }
                };
            });
        };
    };

    return burnDownModel;
}); 
```

和我的 html 绑定

```
<div id="ChartDiv1" class="chartdiv"  data-bind="jchartFx:chartData"style="width:550px;height:400px;display:inline-block"></div> 
```

正如我所说，我在没有杜兰德尔的情况下也能完成这项工作。

这是该解决方案的脚本：

```
<script type="text/javascript">

    $(function () {
        var viewModel = {
            chartDatas: ko.observableArray([])
        };
        LoadChartData();

        function LoadChartData() {
            for (var i = 0; i < 10; i++) {
                var chartData = {
                    "Date": '2013-02-18T00:00:00',
                    "DevCurrentEstimates": 6.5,
                    "TestCurrentEstimates": 7.5,
                    "DevOriginalEstimates": 8.5,
                    "TestOriginalEstimates": 9.5
                };
                viewModel.chartDatas.push(chartData);
            }
        }

        ko.applyBindings(viewModel);
    });

</script> 
```

我能看到的唯一区别是这个脚本在页面加载时运行，而且我必须手动应用 ko 绑定，而不是 Durandel 为我做的。我没有收到任何错误，只是没有显示图表数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:13:12.630

代码的第一件事，将 chartData 更改为 Observable。使用**jchartfx**，它需要一个对象数组 (json)，而不是对象数组。我将单个数组传递给 chartData observable。

将“更新”添加到您的 Knockout **bindingHandler**并在那里执行图表创建方法。当您从**viewAttached**方法或**viewModel**中的 afterBind 获取数据时，这将被触发。由于**viewAttached**是在 Durandal 绑定到 DOM 之后，因此您的图表将按预期显示。

视图模型文件

```
define(function (require) {

    var system = require('durandal/system');
    var http = require('durandal/http');

    // KO observables & bindings
    var errorMessage = "";
    var pageTitle = "jChartFX Demo";
    var chartData = ko.observable();

    function LoadServerData() {

        // Your server request can go here;
        var items = [{
            "Date": '2013-02-18T00:00:00',
            "DevCurrentEstimates": 6.5,
            "TestCurrentEstimates": 7.5,
            "DevOriginalEstimates": 8.5,
            "TestOriginalEstimates": 9.5
        },{
            "Date": '2013-02-18T00:00:00',
            "DevCurrentEstimates": 6.5,
            "TestCurrentEstimates": 7.5,
            "DevOriginalEstimates": 8.5,
            "TestOriginalEstimates": 9.5
        },{
            "Date": '2013-02-18T00:00:00',
            "DevCurrentEstimates": 6.5,
            "TestCurrentEstimates": 7.5,
            "DevOriginalEstimates": 8.5,
            "TestOriginalEstimates": 9.5
        }]
       chartData(items);
    }

    var activate = function(view) {
        system.log("view activated");
        return;
    }

    var viewAttached = function (view) {
        LoadServerData();
        system.log("viewAttached loaded");
        return;
    }

    return {
        pageTitle: pageTitle,
        chartData: chartData,
        activate: activate,
        viewAttached: viewAttached
    }
});

ko.bindingHandlers.jchartFx = {
    init: function (element, valueAccessor) {
        chart1 = new cfx.Chart();
        chart1.getData().setSeries(4);
        chart1.getAxisX().getLabelsFormat().setFormat(cfx.AxisFormat.Date);
        chart1.getAxisX().getLabelsFormat().setCustomFormat("MMM-dd");
        debugger;
    },
    update: function (element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        chart1.setDataSource(value);
        chart1.create(element);
    }
}; 
```

和视图文件

```
<div>
    <h2 data-bind="text: pageTitle"></h2>
    <div id="ChartDiv1" class="chartdiv" data-bind="jchartFx: chartData" style="width:550px;height:400px;display:inline-block"></div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T20:23:16.983

问题似乎与尚未附加到 DOM 的视图有关。

一种可能的解决方案是在 viewModel 中创建一个属性，指示是否已附加视图，并修改绑定，以便在附加视图之前不会创建图表。

```
//in view model
isViewAttached = ko.observable(false);
self.viewAttached = function () {
    self.isViewAttached(true);
};

//in binding
ko.bindingHandlers.jchartFx = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {
        ...
        viewModel.isViewAttached.subscribe(function () {
            $(element).chart();
        });
        ... 
```

不过，这可能不是最好的主意，因为它依赖于视图模型中的“魔法”属性。

更好的方法可能是创建一个辅助绑定，您可以直接绑定到 isViewAttached 属性，并通过 allBindingsAccessor 参数从 jchartFx 绑定访问它。这样一来，所有的视图模型属性依赖项都是公开的，并且更容易判断发生了什么。

无论如何，我强烈建议将绑定移出激活函数 - 理想情况下移入在首次加载应用程序时执行的全局脚本。您真的只想设置`ko.bindingHandlers.jchartFx`一次 - 另外，您可能希望从其他视图模型中使用它。

# jquery - 使 Kendo ui 滑块的工具提示始终可见

> ID：16042365
> 
> 赞同：4
> 
> 时间：2013-04-16T16:33:38.917
> 
> 标签：jquery, kendo-ui

有谁知道如何使滑块上的工具提示始终可见并且不会消失？默认情况下，剑道滑块的工具提示是隐藏的，仅在发生某些交互时才会出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:41:29.813

如果没有您发布任何示例代码，很难说。我快速浏览了那里的网站并将其添加到您的 css 中应该始终显示工具提示。

```
.k-tooltip { display: block !important; } 
```

# vba - HTA 和查找函数 Excel VBA

> ID：16042366
> 
> 赞同：2
> 
> 时间：2013-04-16T16:33:39.310
> 
> 标签：vba, excel, hta

```
Sub search       
Set objExl = CreateObject("Excel.Application")
Set objWb = objExl.Workbooks
objWb.Open("C:\Documents and Settings\user\Desktop\book.xls")
Set strbol = objWb("C:\Documents and Settings\user\Desktop\book.xls").Sheets(1).Cells.Find(document.getElementById("q").Value, Range("A1"), xlValues, xlPart, xlByRows, xlNext, False, False)
Set objDiv = document.getElementById("content")
objDiv.innerText = "Result: " & objWb.Sheets(1).Cells(strbol.Row,strbol.Column).Offset(0,-4).Value      
objWb("C:\Documents and Settings\user\Desktop\book.xls").Close
Set objWb = Nothing
Set objExl  = Nothing
End Sub 
```

以上是 HTA 代码，它从 HTA 文本框中获取查询词，在 excel 中找到该词，并在名为 div 的内容中返回/显示结果偏移行值。我可以成功运行脚本，直到打开 excel 文件。但是脚本在以下行给出错误： Set strbol 。. . 错误消息：下标超出范围。

我在 excel vba 中测试了 find 方法，它可以正常工作，但不能在 HTA 注意：从 IE6 发布，所以请原谅缩进和格式错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:52:50.477

您必须完全限定该范围。

我也换成`xlValues, xlPart, xlByRows, xlNext`了他们的价值观。我不确定`hta`在 VBS 中是否可以在代码顶部定义一个常量

试试这个（**未经测试，因为我从未在 hta 工作过**）。

```
Sub search()
    Set objExl = CreateObject("Excel.Application")
    Set objWb = objExl.Workbooks.Open("C:\Documents and Settings\user\Desktop\book.xls")
    Set strbol = objWb.Sheets(1).Cells.Find(document.getElementById("q").Value, objWb.Sheets(1).Range("A1"), -4163, 2, 1, 1, False, False)
    Set objDiv = document.getElementById("content")
    objDiv.innerText = "Result: " & objWb.Sheets(1).Cells(strbol.Row, strbol.Column).Offset(0, -4).Value
    objWb.Close
    Set objWb = Nothing
    Set objExl = Nothing
End Sub 
```

**额外说明**：

由于您使用的是`.Find`，因此您还需要捕获代码以查看是否确实找到了匹配项，否则`objDiv.innerText = "Result: " & objWb.Sheets(1).Cells(strbol.Row, strbol.Column).Offset(0, -4).Value`将失败。

就像是

```
If Not strbol Is Nothing Then
    objDiv.innerText = "Result: " & _
                       objWb.Sheets(1).Cells(strbol.Row, strbol.Column).Offset(0, -4).Value
End If 
```

**跟进（来自下面的评论）**

在 VBS 中测试的代码。我创建一个文件`C:\Sample.xlsx`并在 Cell 中键入“Sid” `N95`，然后运行具有以下代码的 VBS 文件。它没有错误地工作，并向我显示了一个消息框`$N$95`

```
Dim objExl, objWb, strbol

Set objExl = CreateObject("Excel.Application")
Set objWb = objExl.Workbooks.Open("C:\Sample.xls")
Set strbol = objWb.Sheets(1).Cells.Find("Sid", objWb.Sheets(1).Range("A1"), _
             -4163, 2, 1, 1, False, False)

msgbox strbol.address

objWb.Close
Set objWb = Nothing
Set objExl = Nothing 
```

# knockout.js - knockoutjs 映射，在没有额外映射对象的情况下将新项目添加到子数组

> ID：16042371
> 
> 赞同：2
> 
> 时间：2013-04-16T16:34:03.343
> 
> 标签：knockout.js, knockout-mapping-plugin

使用这个测试代码，基于我的真实项目：

```
var test = ko.mapping.fromJS({ id: 1, kids: [{ name: "sue"}] });
test.kids.push({ name: "tim" });
test.kids.push(ko.mapping.fromJS({ name: "joe" }));
console.log(test);
console.log(test.kids()[0]);
console.log(test.kids()[1]);
console.log(test.kids()[2]);
test.kids()[2].__ko_mapping__ = undefined;
console.log(test.kids()[2]); 
```

Firebug 中的控制台输出显示：

```
Object { __ko-mapping__={...}, id=d(), kids=d() }
Object { name=d() }
Object { name="tim" }
Object { __ko-mapping__={...}, name=d() }
Object { name=d() } 
```

我的目标是在数据的初始映射之后将项目添加到`kids`数组中，并使这些项目看起来与添加的原始项目相同。如果我只是将一个对象直接推送到数组上，则属性不是可观察的。如果我使用它们推动对象，则会包含`ko.mapping.fromJS`一个额外的`__ko_mapping__`对象。我宁愿没有额外的对象，因为它似乎不需要（原始项目没有它并且工作正常），并且我可能会在稍后添加 1000 个项目的地方使用相同的设计。

将对象设置为`undefined`确实似乎删除了额外的对象，但如果可能的话，宁愿不首先创建它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T22:57:39.413

基于缺乏任何其他答案，唯一的答案可能是一个更好的设计实践，但实际上与我要求的相反（它为每个孩子添加了一个映射对象）..我想我已经有了答案在我最初的问题中，只是假设必须有更好的方法。

因此，对于未来的读者，这里是：

```
test.kids()[2].__ko_mapping__ = undefined; 
```

如果您想摆脱它，只需将**ko_mapping设置为未定义。**

请参阅评论和其他答案，了解为什么这通常不是一个好主意。对于我的需求，也许你也有同样的需求，这是个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T13:58:22.387

我通常发现为“Kids”创建一个强大的原型并告诉映射插件在映射初始数据时使用它很有用。这将导致数组的内容相同，并具有允许每个 Kid 进行计算和可观察的额外好处。

[http://jsfiddle.net/Z9GF5/](http://jsfiddle.net/Z9GF5/)

```
var Kid = function(json){
    ko.mapping.fromJS(json, {}, this);
}

var mapping = {
    'kids': {
        create: function(options) {
            return new Kid(options.data);
        }
    }
} 
```

现在，如果您必须添加项目，只需创建新的孩子。

```
var test = ko.mapping.fromJS({ id: 1, kids: [{ name: "sue"}] }, mapping);
test.kids.push(new Kid({ name: "tim" }));
test.kids.push(new Kid({ name: "joe" }));
console.log(test);
console.log(test.kids()[0]);
console.log(test.kids()[1]);
console.log(test.kids()[2]); 
```

Firebug 然后显示：

```
Object {id: function, kids: function, __ko_mapping__: Object}
Kid {name: function, __ko_mapping__: Object}
Kid {name: function, __ko_mapping__: Object}
Kid {name: function, __ko_mapping__: Object} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-10T19:05:20.893

[http://knockoutjs.com/documentation/plugins-mapping.html](http://knockoutjs.com/documentation/plugins-mapping.html)

您可以选择映射哪些属性以及如何映射。

# r - 合并数据帧并覆盖值

> ID：16042380
> 
> 赞同：21
> 
> 时间：2013-04-16T16:34:39.710
> 
> 标签：r, merge

如何合并 2 个相似的数据框，但有一个更重要？

例如：

数据框 1

```
Date      Col1    Col2
jan         2      1
feb         4      2
march       6      3
april       8      NA 
```

数据框 2

```
Date      Col2    Col3
jan         9      10
feb         8      20
march       7      30
april       6      40 
```

按日期合并这些，数据框 1 优先，但数据框 2 填充空白

数据框合并

```
Date      Col1    Col2    Col3
jan         2       1      10
feb         4       2      20
march       6       3      30
april       8       6      40 
```

编辑 - 解决方案

```
commonNames <- names(df1)[which(colnames(df1) %in% colnames(df2))]
commonNames <- commonNames[commonNames != "key"]
dfmerge<- merge(df1,df2,by="key",all=T)
for(i in commonNames){
  left <- paste(i, ".x", sep="")
  right <- paste(i, ".y", sep="")
  dfmerge[is.na(dfmerge[left]),left] <- dfmerge[is.na(dfmerge[left]),right]
  dfmerge[right]<- NULL
  colnames(dfmerge)[colnames(dfmerge) == left] <- i
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-16T16:40:41.750

```
merdat <- merge(dfrm1,dfrm2, by="Date")  # seems self-documenting

#  explanation for next line in text below.
merdat$Col2.y[ is.na(merdat$Col2.y) ] <- merdat$Col2.x[ is.na(merdat$Col2.y) ] 
```

然后只需将 'merdat$Col2.y' 重命名为 'merdat$Col2' 并删除 'merdat$Col2.x'。

作为对更多评论请求的回复：仅更新向量部分的一种方法是构造一个用于索引的逻辑向量，并使用“[”将其应用于赋值的两侧。另一种方法是设计一个仅在分配的 LHS 上的逻辑向量，然后使用`rep()`它制作一个与 具有相同长度的向量`sum(logical.vector)`。目标是两个实例的分配长度（和顺序）与被替换的项目相同。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-16T19:41:21.030

使用 data.table`on=`参数的 v1.9.6 更新（允许*临时连接*：

```
setDT(df1)[df2, `:=`(Col2 = ifelse(is.na(Col2), i.Col2, Col2), 
                     Col3 = i.Col3), on="Date"][] 
```

* * *

这是一个`data.table`解决方案。确保您的`df1`and列是具有所需水平的因子（用于订购`df2`）`Date`

```
require(data.table)
dt1 <- data.table(df1, key="Date")
dt2 <- data.table(df2, key="Date")
# Col2 refers to the Col2 of dt1 and i.col2 refers to that of dt2
dt1[dt2, `:=`(Col3 = Col3, Col1 = Col1, 
        Col2 = ifelse(is.na(Col2), i.Col2, Col2))]

# the result is stored in dt1
> dt1
#     Date Col1 Col2 Col3
# 1:   jan    2    1   10
# 2:   feb    4    2   20
# 3: march    6    3   30
# 4: april    8    6   40 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-02-25T23:39:47.080

这是一个`dplyr`解决方案。感谢@docendo discimus

```
df1 <- data.frame(y = c("A", "B", "C", "D"), x1 = c(1,2,NA, 4)) 

  y x1
1 A  1
2 B  2
3 C NA
4 D  4

df2 <- data.frame(y = c("A", "B", "C"), x1 = c(5, 6, 7))

  y x1
1 A  5
2 B  6
3 C  7 
```

`dplyr`

```
left_join(df1, df2, by="y") %>% 
transmute(y, x1 = ifelse(is.na(x1.y), x1.x, x1.y))

  y x1
1 A  5
2 B  6
3 C  7 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-16T16:40:19.293

考虑这个例子：

```
> d1 <- data.frame(x=1:4, a=2:5, b=c(3,4,5,NA))
> d1
  x a  b
1 1 2  3
2 2 3  4
3 3 4  5
4 4 5 NA
> d2 <- data.frame(x=1:4, b=c(6,7,8,9), c=11:14)
> d2
  x b  c
1 1 6 11
2 2 7 12
3 3 8 13
4 4 9 14 
```

现在使用`merge`and `within`, with `ifelse`:

```
> within(merge(d1, d2, by="x"), {b <- ifelse(is.na(b.x),b.y,b.x); b.x <- NULL; b.y <- NULL})
  x a  c b
1 1 2 11 3
2 2 3 12 4
3 3 4 13 5
4 4 5 14 9 
```

# android - Android - 保存每个对象的首选项

> ID：16042381
> 
> 赞同：0
> 
> 时间：2013-04-16T16:34:49.447
> 
> 标签：android, preferences

有没有办法保存每个复杂对象的首选项？
我有一个动态的对象列表，每个对象包含 3 个字符串和 2 个布尔值对的动态列表。有什么方法可以保存这些对象，比如首选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:16:57.520

您可以选择将复杂对象序列化为文件。然后反序列化以从文件中重新创建对象。这与保存到 SharedPreferences 没有太大区别。

你可以参考这里的代码。[https://stackoverflow.com/a/5816861/2107118](https://stackoverflow.com/a/5816861/2107118)

*注意*：一定要让你的复杂对象实现 Serializable 接口并提供一个 serialVersionUID。

# javascript - 下划线将数组的键映射到另一个

> ID：16042382
> 
> 赞同：1
> 
> 时间：2013-04-16T16:34:51.313
> 
> 标签：javascript, facebook-javascript-sdk, underscore.js

我想将一个大数组的键映射到另一个键，同时使用 Underscore.js 的 map() 函数删除原始键。

```
large_array = _.map(data, function(element) { 
  element.b = element.a;
  delete element.a;
  return element;
});
console.log(large_array) // Returns an array with length == 0 
```

为什么 large_array 的长度为零？

我觉得我错误地使用了 delete 语句，但我不确定。

**编辑：**

我可能过多地抽象了这段代码，因为简单的运行似乎工作得很好。

原始数据数组是来自`FB.api('/me/friends', function(response) {...}`

更具体地说，它是一个对象数组，例如 {id: "12345", name: "Bubba Watson"}

由于这是来自 Facebook 的响应，因此每个对象都保证具有“id”属性

实际代码是将“id”属性更改为“facebook_id”属性。

```
FB.api('/me/friends', function(response) { 
  console.log(response.data);   // Returns 600+ Array of Bubba Watson like objects, each with an id.
  large_array = _.map(response.data, function(element) { 
    element.facebook_id = element.id;
    delete element.id;
    return element;
   });
  console.log(large_array);   // Mysteriously Returns: {length: 0, __proto__: Array[0]}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:51:23.900

您使用`delete`正确，但您可能需要确保：

1.  `data`确实是类型并且数组`Array`中有元素`data`
2.  数组中的每个元素`data`都有名为的属性`a`

你的代码对我有用：http: [//jsfiddle.net/EJTgx/](http://jsfiddle.net/EJTgx/)

```
var data = [
    { a: 10 },
    { a: 20 },
    { a: 30 }
];

var large_array = _.map(data, function(element) {
   element.b = element.a;
   delete element.a;
   return element;
});

console.log(large_array.length);    // Returns 3 
```

# mysql - R 中的“read.sql”函数：使用 R 作为 SQL 浏览器？

> ID：16042384
> 
> 赞同：3
> 
> 时间：2013-04-16T16:34:54.863
> 
> 标签：mysql, sql, r

我有一个大的 .sql 文件，作为 MySQL 数据库（包含多个表）的备份创建，我想从 R 中搜索其中的元素。

理想情况下，会有一个 read.sql 函数将表转换为包含 data.frames 的 R 列表。有什么接近的吗？如果没有，RSQLite 或 RMySQL 可以提供帮助吗？（通过参考手册，我没有看到我所描述的简单功能）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T07:06:41.327

没办法，老大。对于 R 来解释您的 MySQL 数据库文件，它必须完成 DBMS 本身所做的大部分工作。这是一项艰巨的任务，在一般情况下是不可行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:06:46.713

这是否会返回您所寻求的（我认为在审查后您会承认尚未得到特别好的描述）：

```
 require(RMySQL)
 drv <- dbDriver("MySQL")
 con <- dbConnect(drv)
 dbListTables(con)
 # Or
 names(dbGetInfo(drv)) 
```

如果这些只是源代码，那么您需要的只是`readLines`. 如果您正在寻找可以获取 SQL 代码并产生有用结果的 R 引擎，那么 sqldf 包可能会提供一些帮助。它解析嵌入在引用字符串中的 SQL 代码，并将其应用于内存中的数据帧对象或磁盘驻留表（或两者）。其磁盘文件的默认驱动程序是 SQLite，但也可以使用其他驱动程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-30T09:23:08.790

到目前为止，我的解决方法（我也是 db 的新手）是在 phpMyAdmin 中将数据库导出为 .csv 文件（需要在“自定义”方法中勾选“将表导出为单独的文件”）。然后在我想使用的表上使用 read_csv() 。 [![自定义导出的快照，勾选最后一个框](https://i.stack.imgur.com/kCmuL.png)](https://i.stack.imgur.com/kCmuL.png)

这并不理想，因为我想导出数据库并在我的计算机上使用 R（创建在访问在线数据库时有效的函数）并在完成所有测试后访问真实数据库。但是从这里的答案看来，.sql 导出无论如何都无济于事（？）而且我需要在本地重新创建数据库......

# wordpress - 如何为顶级页面加载不同的 Bloginfo 值？

> ID：16042385
> 
> 赞同：0
> 
> 时间：2013-04-16T16:35:00.383
> 
> 标签：wordpress, if-statement

我不是 PHP 程序员，因此我在这个问题上已经摸索了两个小时，因为似乎有很多方法可以做到这一点。由于我的 PHP/Wordpress 语法和逻辑知识很差，我没有设法开始工作。

`<?php bloginfo('name') ?>`创建和调用仅在顶级页面上加载不同值的函数的最佳方法是什么？即顶级菜单标题。

我想知道是否有可能按照这些思路做一些事情：

```
<?php

if ( is_page( 'about' ) || == $post->post_parent ) {    
bloginfo = 'about';

} elseif ( is_page( 'work' ) || == $post->post_parent ) {   
bloginfo = 'work';

} elseif ( is_page( 'contact' ) || == $post->post_parent ) {    
    bloginfo = 'contact';

} else { 
  bloginfo('name');
}   

?> 
```

请将其视为伪代码，因为我仍然熟悉 wordpress 和 PHP 代码/语法，因此我无法得到任何工作。但基本上，我需要做的是使用主导航链接名称作为其部分中每个页面的 bloginfo 名称。其他任何东西都是一个例外，它默认回到主页 bloginfo 名称。

尝试将导航链接标题本身解析到函数中会更容易吗？

如果可以的话请帮忙！

**更新**

我完全放弃了之前的选择，走上了以下路线：

```
<?php if (is_page() || is_single( array( 62, 57, 51, 8 ) )) {

        echo wp_title('');
            }

            else{

            $category = get_the_category(); 
            echo $category[0]->cat_name;
            }?> 
```

这有点拙劣，但在阅读了 wordpress 网站上的大量参考资料后，我想我开始理解语法了。所以，`bloginfo()`我现在不是针对目标，而是针对页面标题。但是我不希望帖子有一个很大的标题，因此我让除顶级“ `pages`”之外的所有页面都选择第一个类别，除了少数实际上是自定义页面的帖子，因此需要显示`wp_title`值.

如果有人对将其转变为更灵活/高效的功能有任何提示，请发表帖子，否则我将在几个小时内解决此问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:11:03.883

语法是

```
<?php

if ( is_page( 'about' ) || == $post->post_parent ) {    
  bloginfo('about');

} elseif ( is_page( 'work' ) || == $post->post_parent ) {   
  bloginfo('work');

} elseif ( is_page( 'contact' ) || == $post->post_parent ) {    
  bloginfo('contact');

} else { 
  bloginfo('name');
}   

?> 
```

但是wordpress中的bloginfo函数没有关于，工作，联系这样的参数。有关 bloginfo 的更多信息，请查看此 url -> [http://codex.wordpress.org/Function_Reference/bloginfo](http://codex.wordpress.org/Function_Reference/bloginfo)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:30:59.777

您可以尝试过滤/更改`name`使用`bloginfo`过滤器（只需在文件中添加此代码段`functions.php`）

```
function my_custom_blogname( $output, $show )
{
    if( $show == 'name' )
    {
        if( is_page('about') ) $output = 'It\'s my about page';
        if( is_page('work') ) $output = 'It\'s my work page';
        if( is_page('contact') ) $output = 'It\'s my contact page';
    }
    return $output;
}
add_filter('bloginfo', 'my_custom_blogname', 10, 2); 
```

**更新：**您还可以检查页面是否是父/顶级页面使用

```
if( !$post->post_parent ) // To check only if it's a parent/top lavel page
if( is_page('about') && !$post->post_parent ) $output = 'about'; // To check if it's a parent/top lavel page and about page 
```

# css - 使用 CSS 定位 SVG spritesheet

> ID：16042387
> 
> 赞同：3
> 
> 时间：2013-04-16T16:35:09.720
> 
> 标签：css, google-chrome, svg, webkit, background-image

我一直在尝试找到一种解决方案来处理通过 CSS 用作背景图像的 SVG 元素：

```
.icon.arrow-down
{
    background-image: url( 'images/spritesheet.svg#arrow-down' );
} 
```

我`:target`直接在 SVG 文件中使用，以便在组合的 SVG spritesheet 中定位特定层（或“组”）。

```
<?xml version="1.0" encoding="utf-8" ?>
<svg class="icon" id="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="50px" height="50px" viewBox="0 0 50 50">
    <defs>
        <style>
            rect, line { shape-rendering: crispEdges; }
            svg .icon { display: none; }
            svg .icon:target { display: inline; }
        </style>
    </defs>

    <!-- Arrows -->
    <g class="icon" id="arrow-down" transform="translate(0,12.5)">
        <path fill="#F00" d="M 0,0 50,0 25,25 z" />
    </g>
    <g class="icon" id="arrow-up" transform="translate(0,12.5)">
        <path fill="#F00" d="M 0,25 50,25 25,0 z" />
    </g>
    ...
</svg> 
```

这适用于 Firefox 和 IE9+，但在 Chrome 中它似乎忽略了这`#profile`部分。但是，直接在浏览器中使用目标 id 访问 SVG 工作表会产生正确的图像。

这是 Chrome`:target`在背景图像中处理方式的错误吗？

我试图避免必须将所有内容分成自己的文件，因此只下载一个资源，但我不知道这是否可能。

请注意图标未在 Chrome 中显示，但在其他浏览器中显示：http: [//jsfiddle.net/sYL5F/1/](http://jsfiddle.net/sYL5F/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:02:06.997

这是一个已知问题，特定于将其用作背景，并且由于安全问题显然不会修复（Opera 也不会显示它）。如果您直接查看 SVG，它会按预期工作。

[https://code.google.com/p/chromium/issues/detail?id=128055#c6](https://code.google.com/p/chromium/issues/detail?id=128055#c6)

> 采用 CSS Image 值的 CSS 属性将不支持 SVG 堆栈。这包括但不限于背景图像、遮罩图像、边框图像。
> 
> 这是 SVG 和 CSS WG 在 CSS 解析期间资源（如 SVG 渐变、蒙版、clipPath）和图像值之间不同的分辨率。这是保护用户隐私和安全的安全要求。
> 
> 有关详细信息，请参阅以下讨论：
> 
> [http://lists.w3.org/Archives/Public/www-style/2012Oct/0406.html](http://lists.w3.org/Archives/Public/www-style/2012Oct/0406.html)
> 
> [http://lists.w3.org/Archives/Public/www-style/2012Oct/0765.html](http://lists.w3.org/Archives/Public/www-style/2012Oct/0765.html)

您将像处理老式 sprite 地图一样处理 SVG。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-20T17:32:04.937

对于我的最新项目，我使用我一直在研究的 PHP MVC 框架实现了我自己创建自定义 SVG 参数的方法。本质上，我创建了一个用于链接图标的控制器：

```
/icon/NAME_OF_ICON.svg?color=F00 
```

我的`icon`控制器获取文件名并将 GET 参数注入 SVG 文件。

```
//define( ROOT, "path/to/webroot" );
//$filename = ...get filename from URL...;

$svg = simplexml_load_file( ROOT . "/assets/icons/{$filename}" );
if( isset( $_GET['color'] ) )
{
    $svg->path->addAttribute( 'fill', '#' . $_GET['color'] );
}

header( "Content-type: image/svg+xml" );
echo $svg->asXML( ); 
```

最终，我将添加代码来缓存查询的自定义 SVG。

# php - 在选择区域看不到结果

> ID：16042388
> 
> 赞同：0
> 
> 时间：2013-04-16T16:35:11.027
> 
> 标签：php, select, mysqli

我在选择区域看不到结果

```
<?php
require 'config.php';
    $query = "SELECT cat_id, category FROM categories LIMIT 1";
    $result = mysqli_query($con,$query);
    if(!$result){
       echo 'Query failed : '.mysqli_error();
       exit(0);
    } 
                        while($row = mysqli_fetch_assoc($result)) {
                            echo '<select name="cat_id">
    ' . $row['cat_id'] . '
    </select>';
                        }
    mysqli_close($con);
?> 
```

我尝试添加 HTML`select`标签，但它仍然无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:39:23.930

这不是选择的好格式

```
echo '<select name="cat_id">
    ' . $row['cat_id'] . '
    </select>'; 
```

它应该是

```
echo '<select name="cat_id">';
while($row = mysqli_fetch_assoc($result)) {

    echo  '<option value="'.$row['cat_id'] .'">'.$row['cat_id'].'</option>';
   }
echo '</select>'; 
```

# php - 调用函数后捕获内容

> ID：16042392
> 
> 赞同：0
> 
> 时间：2013-04-16T16:35:20.193
> 
> 标签：php, html, profiling

是否有可能（在 PHP 中）调用一个触发某些捕获过程的函数，以便捕获该函数之后的所有 HTML 输出直到结束函数？例如，一些分析应用程序执行与此非常相似的过程，并且使用诸如 之类的功能 `ob_start()`，这对我来说似乎是合乎逻辑的。概念示例：

```
<?php beginSection("hello"); ?>
<b>Hi there!</b>
<?php endSecton("hello"); ?>
<!-- Section "hello" now contains "<b>Hi there!</b>" --> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:38:51.707

输出缓冲的工作方式不允许您以命名方式执行此操作 -`ob_start`并且它的朋友彼此*堆叠*，并按顺序展开。你可以像这样实现它：

```
<?php ob_start(); ?>
<b>Hi there!</b>
<?php $sections['hello'] = ob_end_clean(); ?> 
```

这将回答你的问题。

# java - 在 setText (Java Mail) 中发送文件内容

> ID：16042396
> 
> 赞同：0
> 
> 时间：2013-04-16T16:35:23.777
> 
> 标签：java, jakarta-mail

我有一个*jsp*文件：

**电子邮件.jsp**

```
<div id="foo">
    <span id="bar">test</span>
</div> 
```

现在我想通过Java Mail 的 setText 方法发送**email.jsp****的内容，如下所示：**

 **例如：

```
email.setText(getFileContent("email.jsp")); 
```

将导致类似：

```
email.setText("<div id="foo"><span id="bar">test</span></div>"); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:24:10.577

您可以编写一个实用方法：

```
 /**
 * @param fileName String: Path of the JSP file 
 * @return jspContent String : contents of the JSP file
 * @throws IOException
 */
private String readJSPContents(String fileName) throws IOException {
    InputStream io = getServletContext().getResourceAsStream(fileName);
    BufferedReader in = new BufferedReader(new InputStreamReader(io));
    String str;
    String jspContent = "";
    while ((str = in.readLine()) != null)
        jspContent+=str;
    in.close();
    return jspContent;
} 
```

然后 ，`email.setText(readJSPContents("email.jsp"), "utf-8", "html");`**

# wix - 在与 wixproj 相同的解决方案中引用 WiX 扩展

> ID：16042398
> 
> 赞同：2
> 
> 时间：2013-04-16T16:35:28.650
> 
> 标签：wix, wix3, wix-extension

我编写了一个快速的 WiX 预处理器扩展，以从我们保存在根文件夹中的文件中获取一些产品版本信息。

我想将此扩展保留在与我们的 WiX 设置项目相同的解决方案中，因为它更易于维护。但问题是，在测试时，我们使用`Debug`配置，而在发布构建时，我们切换到`Release`. 这意味着我有两个扩展要处理。

我将如何告诉 WiX 根据当前配置获取一个？

我一直在查看 WiX 项目属性中的[引用路径](http://wix.sourceforge.net/manual-wix3/votive_property_pages.htm)，并添加了“..\MyWiXExtensions\bin\$(Configuration)\”作为文件夹，希望它能够获取 MSBuild 属性，但事实并非如此似乎工作。

我还查看了构建事件。我可以将输出 dll 复制到我的设置项目的文件夹中，但是如果我清理我的解决方案，这不会破坏引用吗？

我正在使用 WiX 3.7 和 Visual Studio 2012。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T20:24:17.210

我最终在我的扩展上使用了一个构建后事件，它将输出复制到我的 wixproj 的文件夹中。

我只需要与解决方案的其余部分分开构建我的 wixproj，以防止在覆盖 dll 时出现文件锁定问题。如果确实出现文件锁定，我只需要关闭 VS 并重新打开解决方案。

作为旁注，引用项目本身而不是 dll 可能是 Votive 中的一个不错的功能。

# tsql - 多次更新时的 T-SQL 隔离

> ID：16042399
> 
> 赞同：0
> 
> 时间：2013-04-16T16:35:32.707
> 
> 标签：tsql, isolation-level

我需要更新一些具有不同值的条目，并在每次更新时进行 1 次查询。

在此之前，我会检查每个初始值以确保可以更新条目。

我什至不确定这是否会发生，但我想避免在我进行检查后让这些条目被另一个查询更改。

这是我要避免的示例

1) query1 检查初始值

2) query2 检查初始值

3) query1 应用更新

4) query2 应用更新

我听说过隔离级别，但不知道如何使用它来避免问题，你能帮我吗？

预先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T19:23:10.320

我想知道为什么您不只是使用原子更新在 WHERE 部分进行必要的检查，然后为此进行更新？

无论如何，如果您需要使用 Select 然后更新：我将您推荐给非常好的文章：[http ://samsaffron.com/blog/archive/2007/04/04/14.aspx](http://samsaffron.com/blog/archive/2007/04/04/14.aspx)

事务对于避免脏读等是必要的。但是您应该注意的另一件事是死锁。在分布式方法中，如果您不使用 UPDLOCK（锁定资源以进行进一步更新），您可以更新您读取的不同数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:52:04.160

使用事务。

```
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
GO
BEGIN TRANSACTION;

--check stuff

--update stuff

COMMIT TRANSACTION; 
```

REPEATABLE READ 将确保您读取（选择）的所有内容都将保持不变，直到您的代码到达提交事务。没有人可以更改您已阅读的记录。此处有关事务和隔离级别的更多信息：[SET TRANSACTION ISOLATION LEVEL](http://msdn.microsoft.com/en-us/library/ms173763.aspx)

# c# - DataGrid 中的单元格编辑策略

> ID：16042402
> 
> 赞同：2
> 
> 时间：2013-04-16T16:35:39.233
> 
> 标签：c#, .net, windows-mobile, compact-framework

我正在尝试在 .NET Compact Framework 中为 DataGrid 找到解决方案，用于单元格编辑。

甚至可以在 Windows Mobile 的 .NET Compact Framework 中编辑默认 DataGrid 中的单元格，以及如何做到这一点？

如果不可能，还有什么解决方案，如果有免费的话，也许还有其他控制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T04:31:04.503

在 Paul Yao 的“Programming the compact framework 3.5”一书中，第 4.4.9 章及以下章节中的数据网格是一个不错的就地编辑解决方案：

摘抄：

"... 4.4.9 提供就地编辑功能 .NET Compact Framework DataGrid 控件仅用于显示。与桌面控件不同，它不向用户提供任何数据修改功能。克服仅显示的限制对于 DataGrid 控件，您必须自己提供数据修改功能。您的应用程序必须采取两个步骤来为 DataGrid 控件提供就地编辑。1\. 呈现一个能够接受输入的控件，例如 TextBox，最好带有文本已经突出显示，每当用户表示他希望修改 CurrentCell 的内容时。 2\. 为用户提供一种机制来指示他已完成或正在取消更新。如果请求更新，则移动输入控件的内容进入 CurrentCell。如果合适，隐藏输入控件....。”

注册后代码可在[http://www.paulyao.com/res/code/login.aspx?ReturnUrl=%2fres%2fcode%2fdefault.aspx](http://www.paulyao.com/res/code/login.aspx?ReturnUrl=%2fres%2fcode%2fdefault.aspx)获得。Paul Yao 提供了一个使用数据网格上方显示的文本框对 DataGrid 进行手动和自动就地编辑的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:39:38.680

不，你不能。从[来源](http://msdn.microsoft.com/en-us/library/ms172499%28v=vs.90%29.aspx)：

> 在 .NET Compact Framework 中，您不能在运行时直接编辑 DataGrid 的内容。您必须将控件（例如 TextBox）绑定到数据源并使用 DataGrid 来显示和选择记录。

您在紧凑型设备上没有太多的屏幕空间，因此单元格编辑实际上会很奇怪。处理此问题的一种好方法是使用编辑器表单来表示行中的实体。您选择一行，然后使用按钮或上下文菜单启动编辑。您在此表单中打开选定的行/对象。完成编辑并单击“确定”后，您将更改的值提交给该行所代表的对象...

[这是一篇很好的文章](http://msdn.microsoft.com/en-us/library/ms229684%28v=vs.90%29.aspx)，详细介绍了我上面描述的编辑表单过程。从链接的文章：

> 此示例演示了将 DataGrid 控件与表单一起使用以查看和编辑在 DataGrid 控件中选择的记录以及将新记录添加到数据库中的技术。请注意，必须提供用户界面来编辑 DataGrid 值，因为在 .NET Compact Framework 中不支持编辑 DataGrid 单元格。此示例使用与 Visual Studio 一起安装的 Northwind 数据库。

# java - 如何将数据包从 vpn 隧道写入 pcap 文件

> ID：16042404
> 
> 赞同：1
> 
> 时间：2013-04-16T16:35:45.647
> 
> 标签：java, android, networking, network-programming, pcap

我使用 Android 的 ToyVpnClient 建立隧道并拦截传入和传出的数据包。我想将存储在 ByteBuffer 中的此隧道中的这些数据包写入 pcap 文件。我查看了 jpcap 和 jnetpcap，但它们似乎只支持从使用这些库捕获的数据包创建 pcap 文件，以首先侦听设备的网络接口。

是否有任何可用的 api 可以帮助我从存储在 ByteBuffer 中的隧道数据包数据创建 pcap 文件？如果我要创建自己的 pcap 编写器，我将如何从隧道中解析这个数据包并将其放入 pcap 格式？（我看过但没有找到任何例子）

以下是来自 ToyVpnClient 的相关代码示例：

```
 ...
    DatagramChannel tunnel = DatagramChannel.open();
    // Connect to the server.
    tunnel.connect(server);

    // Packets to be sent are queued in this input stream.
    FileInputStream in = new FileInputStream(mInterface.getFileDescriptor());

    // Packets received need to be written to this output stream.
    FileOutputStream out = new FileOutputStream(mInterface.getFileDescriptor());

    // Allocate the buffer for a single packet.
    ByteBuffer packet = ByteBuffer.allocate(32767);

    // keep forwarding packets till something goes wrong.
    while (true) {
        // Read the outgoing packet from the input stream.
        int length = in.read(packet.array());
        if (length > 0) {
        // Write the outgoing packet to the tunnel.
        packet.limit(length);
        tunnel.write(packet);

        //How to write to pcap file here?

        packet.clear();

        }
    ...
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T17:39:49.477

对于任何寻找类似解决方案的人，我使用 netutils 库的 PCapFileWriter 并对其进行修改以包含每个数据包的假以太网标头（[http://code.google.com/p/netutils/](http://code.google.com/p/netutils/)）

# powershell - 在 Powershell 中访问服务器根目录

> ID：16042405
> 
> 赞同：2
> 
> 时间：2013-04-16T16:35:54.490
> 
> 标签：powershell

我正在尝试通过 Powershell 访问工作中的一些服务器，因为我发现它使一切变得更容易。设置是这样的：

```
\\[Server1]\Folder 1
\\[Server1]\Folder 2
\\[Server1]\Folder 3
\\[Server2]\Folder 1
\\[Server2]\Folder 2
\\[Server3]\Folder 1 
```

我想要一种从其中一个文件夹切换到任何其他文件夹的方法，而无需设置功能来为我更改目录，也无需手动输入服务器名称和文件夹来进行切换。

当我尝试`cd ..`从时遇到的问题`\\[Server 1]\Folder 1`是

```
cd : Cannot find path 'Microsoft.PowerShell.Core\FileSystem::' because it does not exist. 
```

如果我尝试`cd '\\[Server Name]'`或`cd '\\[Server Name]\'`得到

```
cd : Cannot find path '\\[Server Name]' because it does not exist. 
```

或者

```
cd : Cannot find path '\\[Server Name]\' because it does not exist. 
```

我可以在资源管理器中浏览“根文件夹”并轻松选择我想要的任何子文件夹，但希望能够在 Powershell 中做同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:36:58.967

这是因为有效的 UNC 格式为 \server\share。Windows 资源管理器以某种方式（我不知道如何）查询服务器以获取它共享的所有内容。有一个用于在服务器[Get-NtfShares](http://technet.microsoft.com/en-us/library/jj603101%28v=wps.620%29.aspx)上查询共享的命令，但它适用于 Windows Server 2012

**更新** 我发现如何通过 WMI 和 powershell 执行此操作，只需键入：

```
Get-WmiObject Win32_Share -computerName HostName 
```

有关本文的更多信息：[使用 Microsoft PowerShell 编写文件共享脚本](http://www.computerperformance.co.uk/powershell/powershell_wmi_shares.htm)

# junit - 在 IntelliJ 中并行运行 junit 测试

> ID：16042407
> 
> 赞同：25
> 
> 时间：2013-04-16T16:35:55.510
> 
> 标签：junit, intellij-idea

是否可以在 IntelliJ 中并行运行 junit 测试？如果是这样，我该怎么做？

我将“fork”参数设置为类级别，但这并没有做任何事情 - 实际上，它让一切都变慢了，所以我不确定“fork”有什么好处？

*是否可以仅*使用 intelliJ来做到这一点，或者我是否需要一些花哨的测试框架以及这将涉及的所有 hoo-hah？

最后，假设这是可能的，可以控制分叉或线程的数量或他们想要调用的任何东西吗？

更新：有人链接到一个可能回答这个问题的问题。我在发布之前查看了该问题 - 我不确定该问题真正“回答”了什么。它只是说有一个问题跟踪器，并且这个问题已在 intelliJ 中实现。我看不到*如何*在任何地方实现它。

更新：“什么都没做”是什么意思？：它只是让事情变慢，这没有用。我的意思是，也许*你的*测试运行得非常快，你想放慢它们来欣赏一些巴赫？太棒了。我只是想让我的跑得更快，我受够了巴赫。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-09-23T14:36:12.647

您可以使用[junit-toolbox](https://github.com/michaeltamm/junit-toolbox)。这是 jUnit 站点本身上列出的 jUnit 扩展库。

这个扩展提供[了 ParallelSuite](https://junit-toolbox.googlecode.com/git/javadoc/com/googlecode/junittoolbox/ParallelSuite.html)。通过这个，您几乎可以毫不费力地创建一个并行执行测试的 AllTest 类。使用 junit-toolbox 引入的模式功能，最小的 AllTest 可能看起来像下面的代码。

```
@RunWith(ParallelSuite.class)
@SuiteClasses("**/*Test.class")
public class AllTests {} 
```

这将为并行执行创建尽可能多的线程，因为您的 JVM 通过[availableProcessors](http://docs.oracle.com/javase/7/docs/api/java/lang/Runtime.html#availableProcessors%28%29)报告。要覆盖它，您可以设置系统属性`maxParallelTestThreads`。

# lex - lex - 删除“/*”也会删除内部星号

> ID：16042424
> 
> 赞同：0
> 
> 时间：2013-04-16T16:36:55.043
> 
> 标签：lex

我正在尝试从 ac 文件中提取评论。但是我的代码会取出所有星星，而不仅仅是 /* 和 */。任何人都可以帮忙吗？

输入 `/**A**/`或`/***/`

所需的输出`*A*`和`*`

我的输出`*A`，什么都没有

代码

```
"/*"    /* comment */ BEGIN(Comment);
<Comment>{
    [^*]         /* not a '*' */ ECHO;
    "*"+[^/]      /* '*'s not followed by '/' */ ECHO;
    "*"+"/"       /* end of Comment */ BEGIN(INITIAL);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T23:17:06.843

将最后两个模式更改为

```
"*"+/[^/]
"*/" 
```

您的最后一个模式明确地将`*`注释末尾的 every 从注释中取出。如果您只更改最后一条规则，那么它将无法识别例如注释的结尾`/***/`，因为`/*`将开始注释，然后`**`与最后一个模式匹配，并且由`/`匹配`[^*]`。

`"*"+/[^/]`匹配除了 a 之外的所有序列，但不使用`*`后面的字符。`/`这是必要的，因为这可能是`*`关闭`*/`评论的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T23:54:18.713

此正则表达式匹配非嵌套 C 注释：

```
"/*"([^*]|[*]*[^*/])*"*"+"/" 
```

这是一个完整的 Lex 程序，它从输入中去除 C 注释，用空格替换每个注释。

```
%%

"/*"([^*]|[*]*[^*/])*"*"+"/" putc(' ', yyout);

%% 
```

但是，这无法提供有用的诊断。例如，如果发生类似`/* /* */`的事情，最好在评论中生成关于评论开头可疑的警告。此外，如果注释未终止，则检测该注释并生成有关该诊断是否已启动的诊断很有用。

由于这些原因，最好通过仅识别`/*`序列来处理 C 注释，然后使用一段自定义代码接管，该代码从`yyin`流中读取字符并识别注释的其余部分。

# wpf - WPF：如何将活动标题栏颜色设置为窗口背景？

> ID：16042428
> 
> 赞同：3
> 
> 时间：2013-04-16T16:37:04.510
> 
> 标签：wpf, colors, background, titlebar, brushes

我有一个没有标题栏和边框的 WPF 窗口。所以我想根据它是否处于活动状态来更改窗口背景。

我在下面写了代码，但我收到了消息`Cannot implicitly convert type 'System.Drawing.Brush' to 'System.Windows.Media.Brush'`。

你能帮我怎么做吗？谢谢！

```
 // This function used for both "Actived" and "Deactived" event
    private void window_Activated(object sender, EventArgs e)
    {
        Background = (IsActive)? System.Drawing.SystemBrushes.ActiveCaption :
            System.Drawing.SystemBrushes.InactiveCaption;
    } 
```

**编辑**
当前我的窗口标题栏如果处于活动状态，则具有石灰颜色，如果处于非活动状态，则为灰色，但其他用户可能不同。如何通过代码获取这些颜色？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:50:59.577

由于您使用的是`WPF`, 而不是使用`System.Drawing.SystemBrushes`该类，您应该使用[System.Windows.SystemColors](http://msdn.microsoft.com/en-us/library/system.windows.systemcolors.aspx)类。命名空间中的画笔与命名空间画笔`System.Drawing`不直接兼容`System.Windows.Media`。

```
Background = (IsActive)? System.Windows.SystemColors.ActiveCaptionBrush :
            System.Windows.SystemColors.InactiveCaptionBrush; 
```

如果你想在你的 中使用它`XAML`，你可以使用

```
Background="{x:Static SystemColors.ActiveCaptionBrush}" 
```

**根据更新的问题进行编辑**

如果要使用主题颜色，则必须使用 PInvoke。本机方法是[DwmGetColorizationColor](http://msdn.microsoft.com/en-us/library/aa969513.aspx)。这将返回一个整数，因此您可以`SolidColorBrush`使用该整数创建一个并将其分配给您的背景。

```
[DllImport("dwmapi.dll", PreserveSig = false)]
public static extern void DwmGetColorizationColor(out int pcrColorization, [MarshalAs(UnmanagedType.Bool)]out bool pfOpaqueBlend);

int col;
bool opac;
DwmGetColorizationColor(out col, out opac);

//convert the int to a colour
byte[] bytes = BitConverter.GetBytes(col);
Color color = Color.FromRgb(bytes[2], bytes[1], bytes[0]);

Background = new SolidColorBrush(color); 
```

那应该得到你的石灰绿色。

# arrays - 读取 LINQ 结果

> ID：16042429
> 
> 赞同：0
> 
> 时间：2013-04-16T16:37:05.233
> 
> 标签：arrays, linq, enumerate

我正在编写一个小型应用程序，它将通过 FTP 下载 .csv 文件并以特定格式将其读入 Excel。

我在这个网站上找到了下面的 LINQ 代码片段，它将 .csv 文件读入 var 'csv'。问题是我似乎无法弄清楚如何将 var 'csv' 枚举为字符串数组（然后我将使用它来填充相关的 Excel 单元格）。

任何人都可以帮忙吗？谢谢，加文

```
var lines = File.ReadAllLines(lblShowFileName.Text).Select(a => a.Split(','));
var csv = from line in lines select (from piece in line select piece); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:40:36.823

使用[`ToArray()`](http://msdn.microsoft.com/en-us/library/bb298736.aspx)扩展方法生成`string[]`而不是`IEnumerable<string>`

```
var csv = (from line in lines
           select (from piece in line
                   select piece).ToArray()).ToArray(); 
```

因为您调用`ToArray()`了两次 - 在内部和外部查询中，您的`csv`变量将是[锯齿状](http://msdn.microsoft.com/en-us/library/2s05feca.aspx)的字符串数组：`string[][]`

# vba - 一行宏按名称停止其他宏

> ID：16042430
> 
> 赞同：0
> 
> 时间：2013-04-16T16:37:18.383
> 
> 标签：vba, excel

我知道..

```
Application.Run ("Realcount2") 
```

将调用一个宏。你能用类似的东西结束一个宏吗

```
Application.Stop("Realcount2") 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T17:02:22.627

你也许可以做这样的事情，但我不确定它有多可靠。不过，它似乎在一些简单的测试中对我有用。

声明一个公共变量，如`StopMacro`

```
Public StopMacro as Boolean 
```

将此宏分配给设置公共变量的 Button/etc `StopMacro`。

```
Sub SetStopMacro()

StopMacro = True

End Sub 
```

这是一个示例循环结构。在循环中使用`DoEvents`and，每次迭代，检查`StopMacro`and的值`ExitSub`是否为真。

```
Sub Macro1()
Dim r As Long
StopMacro = False

For r = 1 To 100000
    DoEvents
    If StopMacro = True Then Exit Sub
    '''''''''''''''''''''''''''''''''''''
    '                                   '
    ' Your code inside the loop         '
    '                                   '
    '''''''''''''''''''''''''''''''''''''
Next

End Sub 
```

# android - 在android中获取联系人的高清照片

> ID：16042431
> 
> 赞同：1
> 
> 时间：2013-04-16T16:37:19.733
> 
> 标签：android, photo, contact

我想在 android 中获取联系人的高清照片，但我只能达到 96x96 的分辨率。我使用的是 Android 4.0 手机，并且设置了高清照片。当我打电话时，出现了高清照片。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:40:42.507

ContactsContract.Contacts.Photo 包含联系人的主要照片。照片最多可以以两种方式存储 - 默认“照片”是直接存储在数据行中的缩略图大小的图像，而“显示照片”（如果存在）是存储为文件的较大版本。

有关详细信息，请参阅此链接 [http://ContactsContract.Contacts.Photo](http://developer.android.com/reference/android/provider/ContactsContract.Contacts.Photo.html)

# sql - SQL 按月分组并增加 15 分钟

> ID：16042433
> 
> 赞同：0
> 
> 时间：2013-04-16T16:37:25.390
> 
> 标签：sql, sql-server, date

我每 15 分钟有一张数据表。

我有这个查询：

```
Select Sum(Value) From MyTable Group By month(myDate), year(myDate) 
```

但是结果不是我想要的，因为我有来自

'2013-01-01 00:00:00.000' 到 '2013-01-31 23:45:00.000' 我需要从

“2013-01-01 00:15:00.000”和“2013-02-01 00:00:00.000”

如何更改请求以获得正确的日期范围？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:46:23.990

使用[`DATEADD`](http://msdn.microsoft.com/en-us/library/ms186819.aspx)方法：

```
SELECT Sum(Value)
FROM MyTable
GROUP BY MONTH(DATEADD(minute,15,myDate)), YEAR(DATEADD(minute,15,myDate)) 
```

# php - MySQL获取第一行值

> ID：16042435
> 
> 赞同：-3
> 
> 时间：2013-04-16T16:37:31.233
> 
> 标签：php, mysql, sql

我的整个查询与此子查询不同：

```
"(SELECT a.NumSeats From Aircrafts a WHERE f.AircraftID =a.AircrafID)" 
```

我希望它返回一个数字，例如 5

当我选择一个整数 a.NumSeats 时，我不明白为什么这不起作用。

此查询还将返回 1 行的 MAX。

```
$subQuery1 = "(SELECT COUNT(*) from Seats s WHERE s.FlightID = f.FlightID)";
    $subQuery2 = "(SELECT a.NumSeats From Aircrafts a WHERE f.AircraftID =a.AircrafID)";
    $subQuery2 = 0;
    $query = mysql_query("SELECT * FROM Flights f WHERE f.DeptAirport = '".$dep."' AND f.ArrAirport = '".$arr.
            "' AND f.Date=STR_TO_DATE('".$depDate."', '%Y-%m-%d') AND ".$subQuery1\. "=" .$subQuery2); 
```

如果我删除 $subQuery2 = 0 它会中断

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:47:58.850

我认为`a.AircrafID`应该是`a.AircraftID`。

# sql-server - 哪个更快：MAX() 或 IDENT_CURRENT？

> ID：16042439
> 
> 赞同：-4
> 
> 时间：2013-04-16T16:37:45.453
> 
> 标签：sql-server

哪个更快：`Select Max(<IdentityKeyColumn>) + 1`OR `Select Ident_Current('<tablename>') +1`？

我有一个有 450 万行的表，一个旧的存储过程使用： `select @MaxID = Max(ID) + 1 from tablename`.

我想更新它以使用： `Select @MaxID = ident_current('tablename') + 1`

但是，我不确定从哪里`ident_current`获取表的最后一个标识值。它是从 master 或 msdb 数据库中的系统表中查询的，还是对表的数据进行某种最大聚合？

我需要提出一个`ident_current`应该更快的案例，但我还没有找到有关如何`ident_current`工作的详细信息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T17:39:40.430

`IDENT_CURRENT()`据我所知，用于检索当前身份值的实际方法没有记录。它有可能使用不允许运行的内部函数直接从内存中检索它。您可以想象它可能会做什么并在某种程度上模拟它，例如

```
SELECT COALESCE(last_value, seed_value)
  FROM sys.identity_columns
  WHERE [object_id] = OBJECT_ID('dbo.tablename')); 
```

您可以自己在系统上将性能与如下代码进行比较：

```
SELECT SYSDATETIME();
GO
DECLARE @i INT = IDENT_CURRENT('dbo.tablename');
GO 10000
SELECT SYSDATETIME();
GO
DECLARE @i INT = (SELECT MAX(column) FROM dbo.tablename);
GO 10000
SELECT SYSDATETIME();
GO
DECLARE @i SQL_VARIANT = (SELECT COALESCE(last_value,seed_value)
  FROM sys.identity_columns
  WHERE [object_id] = OBJECT_ID('dbo.tablename'));
GO 10000
SELECT SYSDATETIME(); 
```

（注意`seed_value`and`last_value`是 type `SQL_VARIANT`，因为`IDENTITY`列可以使用许多数字类型来实现，所以这就是为什么在这种情况下`@i`不是 an `INT`。）

我的猜测是你不会在那里看到任何微不足道的差异，除了`MAX`随着表格变大，该方法应该花费更长的时间（这就是为什么我不会费心发布我的测试结果 - 我不知道如何表中有很多行，用于 的索引的宽度`MAX`等）。您将不得不自己确定在您的场景中哪种方法更快，使用您的硬件和数据，或者它是否真的无关紧要。

## 然而...

...正如我在评论中所说，其中哪个更快是无关紧要的，因为您首先使用的逻辑来决定它们中的任何一个是有缺陷的。插入行，使用`SCOPE_IDENTITY()`or`OUTPUT`子句获取值，然后继续。不要试图玩弄系统并预测`IDENTITY`最终会插入什么值，因为我向你保证这***会***失败。这*不是*一个假设——它已经被证明了一遍又一遍，一遍又一遍……

例如：

*   [最后一次，不，你不能相信`IDENT_CURRENT()`](http://sqlperformance.com/2014/01/t-sql-queries/ident-current)。

# javascript - 自定义滑块的缩略图滚动值

> ID：16042441
> 
> 赞同：0
> 
> 时间：2013-04-16T16:37:55.860
> 
> 标签：javascript, jquery, module-pattern

在自定义图像轮播上弄脏了我的手。写了一些 jquery 让它工作，但遇到了一个问题。

单击“上一个”和“下一个”链接时出现问题：

*   单击“下一步”时，如果到达最后一个可见项目，则缩略图容器 DIV 将滚动到负左。
*   总滚动值取决于两个因素
*   首先，如果剩余的缩略图超过 5 个，则 DIV 应滚动到 (itemWidth x 5)
*   其次，如果剩余项目少于 5，则滚动值为 (itemWidth x remainingItems)

如果单击“上一个”和“下一个”按钮，如何计算单击时的滚动值？

供参考：http: [//jsfiddle.net/ylokesh/8bHZq/2/](http://jsfiddle.net/ylokesh/8bHZq/2/)

JavaScript 代码：

```
var extCarousel = {
        backBtn : $('.backward'),
        fwdBtn : $('.forward'),
        thumbItems : $('.slidetabcontent a'),
        carouselItem : $('.slide'),
        currentItemIndex : $('.currentIndex'),
        totalItemsCount : $('.currentMax'),
        lastItemIndex : $('.slidetabcontent a:last').index(),
        firstItemIndex : $('.slidetabcontent a:first').index(),
        defaultThumbnailSet : 5,

        generateCarousel : function() {
            var _this = this;
            _this.thumbItems.eq('0').addClass('current');
            _this.carouselItem.hide().filter(':first').addClass('active').show().find(_this.currentItemIndex).html($('.slide.active').index() + 1);

            _this.totalItemsCount.html(_this.thumbItems.length);
            _this.controlNavigation();              
        },

        controlNavigation : function() {

            var _this = this,
                currentIndex, lastItem, firstItem;

            // Back Button
            _this.backBtn.on('click', function(e){
                e.preventDefault();
                currentIndex = $('.slide.active').index() - 1,
                firstItem = _this.firstItemIndex - 1;

                if(currentIndex != firstItem) {
                    _this.moveCarousel(currentIndex);
                }
            });

            // Prev Button
            _this.fwdBtn.on('click', function(e){
                e.preventDefault();
                currentIndex = $('.slide.active').index() + 1,
                lastItem = _this.lastItemIndex + 1;

                if(currentIndex != lastItem) {
                    _this.moveCarousel(currentIndex);
                }
            });

            //Thumbnail Click
            this.thumbItems.on('click', function(e) {
                e.preventDefault();
                currentIndex = $('.slide.active').index();
                _this.moveCarousel(currentIndex);
            });

        },

        moveCarousel : function(currIndex) {
            var _this = this;
            _this.carouselItem.removeClass('active').fadeOut('fast').eq(currIndex).addClass('active').fadeIn('fast');
            _this.activateThumbnail(currIndex);
        },

        activateThumbnail : function(currIndex) {
            var _this = this;
            _this.thumbItems.removeClass('current').eq(currIndex).addClass('current');
            _this.setCurrentItemIndex(currIndex + 1);

            if(currIndex == _this.defaultThumbnailSet) {
                _this.slideThumbnails();
            }

        },

        slideThumbnails : function() {
            var _this = this;
            var remainingThumbnails = _this.thumbItems.length - _this.defaultThumbnailSet;
            var itemWidth = _this.thumbItems.width() + parseInt(_this.thumbItems.css('padding').split('px')[0]*2);
            if(remainingThumbnails > 5) {
                $('.slidetabcontent').animate({
                    'left' : -(itemWidth*5)
                }, 'slow');
            } else {
                $('.slidetabcontent').animate({
                    'left' : -(itemWidth*remainingThumbnails)
                },'slow');
            }
        },

        setCurrentItemIndex : function(currIndex) {
            var _this = this;
            _this.currentItemIndex.html(currIndex);
        },

        init : function() {
            var _this = this;
            _this.generateCarousel();
        }
    };
    $(document).ready(function(){
        var extensionCarousel = extCarousel.init();
    }) 
```

# excel - Excel 变量 X 值

> ID：16042445
> 
> 赞同：0
> 
> 时间：2013-04-16T16:38:16.517
> 
> 标签：excel, graph

我有两个工作日日期，first_date，second_date。

我有一个工作日期递减的数据表：

第二个日期值 1

第二个日期 - 1 值 2

第二个日期 - 2 值 3

…………

第一个日期值 n

第一个日期 -1 值 n + 1

……

（数据表不会在第一次约会时停止）。

我想绘制第一个和第二个日期之间的所有值，仅适用于工作日。

我找到了一些使用宏的方法，但我希望它是自动化的。

用 =NETWORKDAYS(firstdate,seconddate) 计算行数很容易，但我无法将这个函数输入到系列 X/Y 值中。

我有类似 ='sheet1!$D$4:$D$33 的东西。

我想要 ='Sheet1'!$D$4:$D$ & NETWORKDAYS(firstdate,seconddate)

有人知道怎么打吗？

我很想把 NETWORKDAYS(firstdate,seconddate) 放在一个单元格中，并在公式中使用 cell.value。它是如何工作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:07:53.993

您可以使用该`OFFSET`函数来定义动态命名范围。然后可以在系列公式中使用此名称。

在我的示例中，我分别在单元格 D1 和 E1 中有 start_date 和 end_date（如果没有，请根据需要修改公式）。

**第 1 步**打开名称管理器，添加一个新名称，如“Workdays_Data”，并在“引用到：”框中输入公式：

`=(OFFSET(Sheet1!$D$4,0,1,NETWORKDAYS(Sheet1!$D$1,Sheet1!$E$1),1))`

![名称管理器对话框](https://i.stack.imgur.com/QFpVE.jpg)

然后关闭名称管理器对话框。

**步骤 2**选择数据系列，并在公式栏中，将引用值的范围替换为新名称，`Workdays_Data`。您需要修改的部分突出显示：

![修改前的编辑栏截图](https://i.stack.imgur.com/YrjJU.jpg)

进行更改后，公式栏应如下所示：

![修改后的公式栏以使用命名范围](https://i.stack.imgur.com/wZHpg.jpg)

如果您这样做，那么图表应该会在您更改**结束日期时更新**。

通过对名称定义进行一些额外的调整，您可以对其进行修改以考虑动态开始日期。例如，您可以将 Name 公式中的“0”替换为 Match 函数，以便 name 公式显示为：

`=(OFFSET(Sheet8!$D$4,MATCH(Sheet8!$D$1,Sheet8!$D$4:$D$11,FALSE)-1,1,NETWORKDAYS(Sheet8!$D$1,Sheet8!$E$1),1))`

然后，您可以创建另一个名称`Weekdays_XValues`并将其用于图表中的类别标签，以便这些标签也更新：

`=(OFFSET(Sheet8!$D$4,MATCH(Sheet8!$D$1,Sheet8!$D$4:$D$11,FALSE)-1,0,NETWORKDAYS(Sheet8!$D$1,Sheet8!$E$1),1))`

最终结果应该是基于所选开始/结束日期的完全动态图表，例如：

![使用值和 XValue 的动态命名范围的 Excel 图表](https://i.stack.imgur.com/TDntW.jpg)

# regex - 附加到ant中文件的每一行

> ID：16042448
> 
> 赞同：0
> 
> 时间：2013-04-16T16:38:19.593
> 
> 标签：regex, ant

我正在尝试在 ant 中进行一些小的文件操作。我检索了一个表空间列表，我想在 ALTER TABLESPACE 前面加上 NOT LOGGED ，如下所示：

```
 <loadfile property="zos.prepend.tablespaces" srcFile="${basedir}/zos-tablespaces-DIRTY.txt">
      <filterchain>
        <!-- Order here is important -->
        <prefixlines prefix="ALTER TABLESPACE "/>
        <suffixlines suffix=" NOT LOGGED"/>
        <trim/>
        <replaceregex pattern=".*NAME.*|.*-----.*|.*record.*select.*|^ALTER TABLESPACE$" replace=""/>
        <trim/>
        <ignoreblank/>
      </filterchain>
    </loadfile>

    <echo file="${basedir}/zos-tablespaces-PREPEND.txt">
        ${zos.prepend.tablespaces}
    </echo> 
```

当我这样做时，我得到了前置，但附加似乎附加到下一行。任何想法如何做前缀和后缀？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T19:20:52.060

我其实只是想通了。我在输入的每一行末尾的 CRLF 之后添加后缀行，而不是在之前添加。所以我只需要在添加后缀后清除 CRLF。这就是最终奏效的方法。现在我只需要让它更干净一点

```
<filterchain>

  <tabstospaces/>
  <prefixlines prefix="ALTER TABLESPACE "/>
  <trim/>
  <replaceregex pattern=".*NAME.*|.*record.*select.*|.*-----.*|^ALTER TABLESPACE$" replace=""/>
  <suffixlines suffix=" NOT LOGGED @"/>
  <striplinebreaks/>
  <tokenfilter>
  <replacestring from="LOGGED @" to="LOGGED @${line.separator}"/>
  </tokenfilter>
  <tabstospaces/>
  <trim/>
  <replaceregex pattern="^NOT LOGGED @$" replace=""/>
  <tabstospaces/>
  <trim/>       
  <ignoreblank/>
  <fixcrlf eol="crlf" eof="add"/>

</filterchain> 
```

# pdf - 正确实现 Grails 的导出插件以将 GSP 导出为 PDF

> ID：16042450
> 
> 赞同：0
> 
> 时间：2013-04-16T16:38:23.043
> 
> 标签：pdf, grails, export, grails-plugin

我是使用 STS 3.2（grails 版本 2.2.0）的 Grails 中一个相当新的开发人员，我有一个应用程序，我想将数据从 GSP 导出为 PDF 格式。我已经安装了 Export 1.5 插件，并且有一个带有以下内容的 reportController：

```
def pdf = { results->
    def table = results['tables'][params.reportNum.toInteger()]
    def headers = table?.getAt(0).collect{ it.key }
    def rows = table*.collect{ cleanNull(it.value.toString()) } //data  
    exportService.export("$params.renderAs", response.outputStream, headers, rows, parameters)
} 
```

* * *

有人可以帮我正确连接吗？我确实知道 exportService 期望这个，但不确定我是否收集了所有我需要让它工作的东西：

导出（字符串类型，OutputStream outputStream，列表对象，地图格式化程序，地图参数）}

我希望我的问题已经很清楚了......在此先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:29:59.433

该插件的示例具有`params.format`导出类型。你的内容是`params.renderAs`什么？看来该值必须是 的键之一`grails.mime.types`。

```
if(params?.format && params.format != "html"){ 
    response.contentType = grailsApplication.config.grails.mime.types[params.format]
    response.setHeader("Content-disposition", "attachment; filename=books.${params.extension}")

    exportService.export(params.format, response.outputStream,Book.list(params), [:], [:]) 

} 
```

所以在你的情况下`renderAs`应该有`pdf`.

* * *

好的，所以查看 ExportService 和您的代码示例，我认为您要使用的方法的签名是：

```
export(String type, OutputStream outputStream, List objects, List fields, Map labels, Map formatters, Map parameters) 
```

*   对象：将被导出的对象列表
*   fields：字段的名称，存在于将要导出的对象中
*   标签：字段及其标签的地图
*   格式化程序：可以是空地图
*   参数：可以是空地图

考虑书籍领域类：

```
class Book {
    String title
    String author
} 
```

您可以创建如下操作：

```
def pdf() {
    List fields = ["author", "title"]
    Map labels = [author: "Author", title: "Title"]
    exportService.export(params.format, response.outputStream, Book.list(params), fields, labels, [:], [:])
} 
```

# r - Cox 危害模型和趋势检验

> ID：16042452
> 
> 赞同：2
> 
> 时间：2013-04-16T16:38:26.703
> 
> 标签：r, trend

如果我有一个 cox 比例风险模型，其中一个分类变量（以及其他协变量，如年龄等）作为事件的预测因子，假设我感兴趣的分类变量是肿瘤大小，可以是 0-10、10-例如，20、20-30，我看到随着肿瘤大小的增加，死亡 HR 有更高的趋势，我如何计算 r 并获得 ap？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:49:54.993

接受您的不完整规格有点危险，因为您可能有一个尺寸分类会搞砸，例如：0-10、10-20、20-30、30-80、80-120、120- 240。除非您仔细构建了因子以正确排序升序，否则我将建议作为捷径的方法将失败。

```
 survmdl <- coxph(Surv(tie,event) ~ as.numeric(fact), data=dat) 
```

您将获得一个“趋势测试”，这将被解释为日志（危险）中每个类别的增加，以增加大小，它将是一个单一的系数。因此，如果您希望得到更好的回复，请发布您的实际因素水平。

# c# - 尝试在按钮单击时触发代码中的方法

> ID：16042455
> 
> 赞同：2
> 
> 时间：2013-04-16T16:38:29.280
> 
> 标签：c#, asp.net

我正在处理一个 ASP.NET 项目，我有一个按钮，我想在代码中触发一个方法，以便在单击时使用更新的客户端数据更新数据库。

这是我的按钮：

```
<asp:Button ID="button1" runat="server" OnClick="submitChanges_OnClick" Text="Submit" /> 
```

**后面的代码：**

```
private void submitChanges_OnClick(object sender, EventArgs e)
{
    //Code here
} 
```

在页面加载时，我收到此**错误消息：**

```
Compiler Error Message: CS1061: 'ASP.account_heatingcontrols_aspx' does not contain a
definition for 'submitChanges_OnClick' and no extension method 'submitChanges_OnClick' 
accepting a first argument of type 'ASP.account_heatingcontrols_aspx' could be found
(are you missing a using directive or an assembly reference?) 
```

谁能告诉我我在这里做错了什么，我用谷歌搜索过，但没有运气。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:40:34.910

更改`private`为`protected`。

```
protected void submitChanges_OnClick(object sender, EventArgs e) 
```

# java - 不可见的 java 字节码行

> ID：16042457
> 
> 赞同：4
> 
> 时间：2013-04-16T16:38:36.250
> 
> 标签：java, bytecode, java-bytecode-asm

我想知道为什么 Java Bytecode 的行号不连续。

例如，在以下 getter 的（未列出的）第 2 行和第 3 行中会发生什么？

```
public java.lang.String getX();

Code:
0:   aload_0
1:   getfield        #2; //Field x:Ljava/lang/String;
4:   areturn 
```

我正在使用 ASM 框架来处理字节码。当使用树 API 访问方法的代码时，我也会得到这些“隐藏”指令（但是使用操作码 -1）。我想知道它们是干什么用的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T16:46:46.140

我不认为那`0, 1, 4`是行号，而是字节码中的字节偏移量。

*   `aload_0`是一个字节
*   `getfield`是三个字节（一个操作码，一个带有两个字节的“索引”参数）
*   `areturn`是一个字节

所以`2`和`3`只是`getfield`操作的一部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T16:53:39.037

一点解释

局部变量数组的大小在编译时确定，取决于局部变量和形式方法参数的数量和大小。操作数堆栈是一个 LIFO 堆栈，用于推送和弹出值。它的大小也是在编译时确定的。某些操作码指令将值压入操作数堆栈；其他人从堆栈中获取操作数，操作它们，然后推送结果。操作数栈也用于接收方法的返回值。

```
public String getBar(){ 
    return bar; 
  }

  public java.lang.String getBar();
    Code:
      0:   aload_0
      1:   getfield        #2; //Field bar:Ljava/lang/String;
      4:   areturn 
```

上述方法的字节码由三个操作码指令组成。第一个操作码 aload_0 将值从局部变量表的索引 0 压入操作数堆栈。this 引用始终存储在构造函数和实例方法的局部变量表的位置 0 处。下一个操作码指令 getfield 用于从对象中获取字段。最后一条指令 areturn 从方法返回一个引用。

每个方法都有一个对应的字节码数组。使用十六进制编辑器查看 .class 文件，您会在字节码数组中看到以下值：

也就是说，getBar 方法的字节码是 2A B4 00 02 B0。代码2A对应aload_0指令，B0对应areturn。该方法的字节码有 3 条指令，但字节数组包含 5 个元素，这可能看起来很奇怪。这是因为 getfield (B4) 需要提供 2 个参数 (00 02)，并且这些参数在数组中占据位置 2 和 3，因此数组大小为 5，并且 areturn 指令移动到位置 4。

[资源](http://arhipov.blogspot.co.uk/2011/01/java-bytecode-fundamentals.html)

[Java 字节码指令列表](http://en.wikipedia.org/wiki/Java_bytecode_instruction_listings)

# c# - 是否可以使用 OleDbDataAdapter 查询 excel 行号

> ID：16042458
> 
> 赞同：1
> 
> 时间：2013-04-16T16:38:38.063
> 
> 标签：c#, .net, excel, oledbdataadapter

是否可以使用 OleDbDataAdapter 查询 excel 行号？

图片在这里
![截屏](https://i.imgur.com/3pxr4J2.jpg)

```
OleDbCommand objCmd = new OleDbCommand("Select *, [Sheet1$].ExcelLineNumber From [Sheet1$]", objConn);

OleDbDataAdapter objDatAdap = new OleDbDataAdapter();
objDatAdap.SelectCommand = objCmd;
DataSet ds = new DataSet();
objDatAdap.Fill(ds); 
```

结果应该是

```
 Column A | column B | Column C | ExcelLineNumber
      1        pong         13              5
      2        pong          2              6 
```

…………

有可能吗？如果没有，有什么办法可以解决它？我一直在尝试很多东西，但它可能会消耗太多性能

# yii - 为什么 Yii 允许我使用 $this->property 访问私有的 $this->_property？

> ID：16042461
> 
> 赞同：1
> 
> 时间：2013-04-16T16:38:50.000
> 
> 标签：yii

我不确定这里发生了什么，也许有人有线索：

在我的布局中，我有这个：

```
<div id="main-content" class="<?= $this->getMainClass(); ?>"> 
```

在组件>控制器类我有这个：

```
 private $_mainCssClass;

    public function setMainCssClass($className) {

     if (is_string($className)) {
        $this->_mainCssClass = $className;
     } else {
        quickDump($className);
     }
    }

    public function getMainCssClass() {
     return $this->_mainClass;
    } 
```

我没有得到的是，尽管我们正在使用访问器，并且 mainCssClass 属性有一个下划线并且它被声明为私有，但我可以通过以下方式访问它：

```
$this->MainCssClass; 
```

与以下相同：`$this->getMainCssClass()`

这是为什么 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:46:52.883

您不访问私有方法`_mainCssClass`，而是访问`getMainCssClass()`公共方法。所以你可以从外部调用这个方法，你也可以访问`mainCssClass`（这只是 的简写`getMainCssClass()`）。

并且`getMainCssClass()`您可以访问同一类中的任何私有变量。没有限制您不能返回私有变量的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:47:42.873

它只是一个更短的语法，更方便读写。

有关“魔术”的一些印象，请参阅[Yii 框架指南](http://www.yiiframework.com/doc/guide/1.1/en/basics.component#component-property)了解详细信息和[源代码](https://github.com/yiisoft/yii/blob/1.1.13/framework/base/CComponent.php#L107)。

# python - 如何获取 Python3 中已注册的 atexit 函数列表？

> ID：16042463
> 
> 赞同：5
> 
> 时间：2013-04-16T16:38:52.740
> 
> 标签：python, python-3.x

在 Python 中，我可以使用[atexit](http://docs.python.org/3.2/library/atexit.html)模块来注册 Python 退出时要执行的函数。有没有办法检索已注册退出处理程序的列表？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2020-07-22T07:50:05.713

这是一种访问已注册函数（可调用对象）的纯 python 方式，但不是它们将被调用的参数。这有点 hack，但对于调试等，它会做得很好：

```
Python 3.5.3 (default, Jul  9 2020, 13:00:10) 
[GCC 6.3.0 20170516] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import atexit
>>> class Capture:
...     def __init__(self):
...         self.captured = []
...     def __eq__(self, other):
...         self.captured.append(other)
...         return False
... 
>>> c = Capture()
>>> atexit.unregister(c)
>>> print(c.captured)
[<function <lambda> at 0x7fc47631d730>, <built-in function write_history_file>]
>>> atexit.unregister(c.captured[0])  # this will work 
```

它是如何工作的：如文档所述，从回调列表`atexit.unregister(c)`中删除任何出现的。`c`它通过依次比较每个回调与`c`是否相等来做到这一点。这导致 call `c.__eq__(other)`，`other`作为回调（这个调用永远不会被跳过，就像 raises 的另一种方式一样`NotImplemented`）。`Capture.__eq__`然后复制它的论点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-16T16:42:01.953

在 Python 2 中，该模块仍然仅作为 Python 可用，该`atexit`模块有一个半私有列表：

```
atexit._exithandlers 
```

它包含所有已注册的退出处理程序。

在 Python 3 中，该模块已经用 C 重新编码，并且列表不再可访问，所以对于 Python 3，您恐怕完全不走运。

您必须将[Python 2 纯 Python 版本](http://hg.python.org/cpython/file/2.7/Lib/atexit.py)移植到 Python 3，并确保使用它而不是 C 版本以使列表再次可访问。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-09-09T14:18:17.320

这是@BCarvello 以函数形式提供的解决方案：

```
import atexit

def get_atexit_functions():
    funs = []

    class Capture:
        def __eq__(self, other):
            funs.append(other)
            return False

    c = Capture()
    atexit.unregister(c)
    return funs 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-12-16T19:12:33.633

在 Python 3 中，atexit._exithandlers 列表不可用，但如果您只需要计算注册的回调，您可以这样做：

```
atexit._ncallbacks() 
```

演示：

```
# python3
Python 3.5.3rc1 (default, Jan  3 2017, 04:40:57) 
[GCC 6.3.0 20161229] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import atexit
>>> atexit._ncallbacks()
2 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-04T18:59:59.440

有一个公开的功能请求来公开此信息（[bpo-32082](https://bugs.python.org/issue32082)）。[该请求在此处](https://github.com/sagemath/sage/blob/b5c9cf037cbce672101725f269470135b9b2c5c4/src/sage/cpython/atexit.pyx#L171)引用了 Cython 模块形式的解决方法，其中关键部分是：

```
from cpython.ref cimport PyObject

# Internal structures defined in the CPython source in
# Modules/atexitmodule.c and subject to (but unlikely to) change.  Watch
# https://bugs.python.org/issue32082 for a request to (eventually)
# re-expose more of the atexit module's internals to Python
ctypedef struct atexit_callback:
    PyObject* func
    PyObject* args
    PyObject* kwargs

ctypedef struct atexitmodule_state:
    atexit_callback** atexit_callbacks
    int ncallbacks
    int callback_len

cdef extern from "Python.h":
    void* PyModule_GetState(object module)

def _get_exithandlers():
    """Return list of exit handlers registered with the atexit module."""
    cdef atexitmodule_state* state
    cdef atexit_callback callback
    cdef list exithandlers
    cdef int idx
    cdef object kwargs

    state = <atexitmodule_state*>PyModule_GetState(atexit)

    if not state:
        raise RuntimeError("atexit module state missing or corrupt")

    exithandlers = []

    for idx in range(state.ncallbacks):
        callback = state.atexit_callbacks[idx][0]
        if callback.kwargs:
            kwargs = <object>callback.kwargs
        else:
            kwargs = {}
        exithandlers.append((<object>callback.func,
                             <object>callback.args,
                             kwargs))
    return exithandlers 
```

# c# - forloop 中的 NullReference

> ID：16042468
> 
> 赞同：-4
> 
> 时间：2013-04-16T16:39:13.350
> 
> 标签：c#

这段代码：

```
public void collide(int x, int y)
{
   int foodthen=0;
   for(int xt=0;xt<150;xt++)
   {
      for(int  yt=0;yt<55;yt++)
      {
~        if(MainClass.tilesSet[yt,xt].food=true)
         {
            foodthen++;
         }
      }
   }
   Debug.WriteLine("Food then: "+foodthen);
   if(this.Equals(MainClass.fridge)||this.Equals(MainClass.tree))
   {
      if(MainClass.tilesSet[y,x].food)
      {
         MainClass.tilesSet[y,x].food=false;
         MainClass.Log("You found some food!");
         MainClass.player.food++;
      }

      else
      {
         MainClass.Log("There is no food... :(");
      }
    }
    MainClass.player.updateFood();
 } 
```

这会在标有“~”的行处引发 NullReferenceException。与标有“#”的行中的相同代码似乎没问题，当我在没有抛出代码的情况下测试它时不会抛出异常。为什么它只发生在 for 循环中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:43:40.310

要么`MainClass`，`MainClass.tilesSet`要么`MainClass.tilesSet[yt,xt]`为空；

[使用 Visual Studio 调试器](http://www.dotnetperls.com/debugging)在该行上放置一个断点以查看它是哪一个

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:46:34.480

这意味着`MainClass`，`MainClass.tilesSet`或者`MainClass.tilesSet[yt,xt]`是`null`。假设`MainClass`实际上是一个类，它不可能是`null`，所以很可能是其他两个中的一个。我最好的猜测是多维数组没有完全初始化，它包含一些空引用。使用调试器[检查](http://msdn.microsoft.com/en-us/library/bhawk8xd.aspx)异常的值和发生时间`yt`。`xt`

如果`yt`和`xt`都为 0，`MainClass.tilesSet`或者`MainClass.tilesSet[0,0]`为空。对于任何其他值，数组未完全填充是一个问题。

另外，请注意，在您**分配** `true`给属性（或字段）的那行代码中`food`，不检查`true`. 这很可能不是您想要的。

```
if(MainClass.tilesSet[yt,xt].food=true) 
```

应该：

```
if(MainClass.tilesSet[yt,xt].food) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:45:28.707

如果你得到一个`NullReferenceException`then 则表明`tilesSet`数组尚未初始化。如果循环引用了超出范围的索引，您会得到一个异常，但您得到的异常是告诉您您正在请求一个不存在的数组对象。

我会看看在调用方法`MainClass`的上下文中如何初始化 的该属性。`collide`

# java - RichFaces 4.2 日历。如何通过 JavaScript 设置 Calendar 的 InputField？

> ID：16042471
> 
> 赞同：-1
> 
> 时间：2013-04-16T16:39:24.570
> 
> 标签：java

我必须将客户端的日期字符串复制到日历输入字段“renewal_date_input”。以下 JavaSript 不起作用：

```
document.getElementById('AddressDetails:renewal_date_input').value = renewalDateCombo.value.toString(); 
```

虽然有：

```
alert("written date is: " + document.getElementById('AddressDetails:renewal_date_input').value); 
```

我们可以读出之前写的正确的日期字符串。但是该字符串没有出现在输入字段中。手动输入启用：

```
enableManualInput="true" 
```

`setInputField: function(dateStr, event)`也许带有丰富面孔的 JavaScript 函数`calendar.js`会有所帮助，但我该如何使用它呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T15:04:37.837

`setValue()`在日期组件上使用函数，将`Date`对象作为参数传递

```
 var theCalendar = document.getElementById('AddressDetails:renewal_date_input');
 theCalendar.setValue(document.getElementById('AddressDetails:renewal_date_input').getValue()); //Here I assume renewal_date_input is also a calendar component 
```

# android - 调用 onLoadFinished 慢

> ID：16042473
> 
> 赞同：2
> 
> 时间：2013-04-16T16:39:35.837
> 
> 标签：android, android-contentprovider, android-sqlite, android-loader

我正在使用`Loader`并`Content Provider`用我的数据库中的数据填充列表视图。我的问题是，如果我使用下面的行`Content Provider`从数据库中获取数据，查询并`onLoadFinished`执行得非常快（填充列表视图没有问题）：

```
Cursor c = this.mDb.rawQuery("SELECT * FROM " + DATABASE_TABLE , null); 
```

但是，如果我将行更改为：

```
Cursor c = this.mDb.rawQuery("SELECT DISTINCT D._id, D.Name, D.Icon FROM Plain A, Test B, Exercise C, Group D WHERE A.ID=1 AND B.PlainID=A._id AND B.TestID=C._id AND C.ExerciseID=D._id", null); 
```

查询继续快速运行，但应用程序需要大约 2 秒来调用`onLoadFinished`和填充列表视图。

如果游标已经执行查询，为什么会出现这种延迟？

我的装载机：

```
public Loader<Cursor> onCreateLoader(int id, Bundle args) {

    Log.d(TAG, "onCreateLoader");

    Uri uri = ContentProviderGroup.CONTENT_URI;

    String[] projection = { Group.KEY_ROW_ID, Group.KEY_NAME, Group.KEY_ICON  };

    CursorLoader cursorLoader = new CursorLoader(this, // Parent activity context
            uri, // Table to query
            projection, // Projection to return
            null, // No selection clause
            null, // No selection arguments
            null); // Default sort order

    Log.d(TAG, "END onCreateLoader");

    return cursorLoader;

} 
```

我的内容提供者（查询功能）：

```
public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) { 

    Cursor cursor;

    if(uriMatcher.match(uri) == CODE){

        Log.d(TAG, "CALL SELECT");
        cursor = mCustomerDB.getGroup(selection, selectionArgs);
        Log.d(TAG, "END SELECT");

        return cursor;

    }else{          
        return null;
    }
} 
```

我的 DBAdapter（getGroup 函数）：

```
public Cursor getGroup(String selection, String[] selectionArgs){

    Log.d(TAG, "SELECT INIT");

            ///////  HERE I USE the rawQuery  /////////

    Log.d(TAG, "SELECT END");

    return c;

} 
```

谢谢你

# javascript - 使用 Raphael.fn 时，Raphael “未定义”

> ID：16042478
> 
> 赞同：0
> 
> 时间：2013-04-16T16:39:40.730
> 
> 标签：javascript, svg

我正在尝试使用 Raphael.fn 是一个外部 JavaScript .js 文件。我还在 FireFox 20.0 上使用 FireBug 进行调试。

```
Canvas.paper = Raphael(xOffset,yOffset,imageWidth,imageHeight); 
```

工作正常，但

```
Raphael.fn.arrow = function (x1, y1, x2, y2, size) {
    // Code
}; 
```

给出错误信息

```
Raphael is not defined 
```

在萤火虫。

# android - 从 Service、Activity、Fragment 等通知数据库对 Fragment 的更改

> ID：16042480
> 
> 赞同：1
> 
> 时间：2013-04-16T16:39:58.000
> 
> 标签：android, android-fragments

我的应用程序有许多片段，其中许多片段从 ListFragment 扩展而来，并具有用于读取数据库 (SQLite) 的适配器。我的应用程序只有一个 Activity（目前），并且在 Activity 启动时绑定了一个服务。

我的问题是如何在数据库中的服务或其他片段发生更改时通知片段。

## 我的应用程序架构示例

```
MainActivity
  tabhost
   fragment
     listfragment
     listfragment
   fragment
     fragment
     gridfragment
   fragment

MainService
  comunication_server
    send_data
    receive_data 
```

如您所见，我的应用程序有几个片段，我想通知片段数据已更改。或者至少启动内部广播可以通过[iNotifyPropertyChange .NET C#/WPF等片段听到](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:01:35.853

考虑实现 CursorLoaders。它们将使您能够异步加载列表，并且它们将监视数据源的更改并自动更新列表。它们非常容易实现。

[Lars Vogal 对它们有一个简洁的小教程。](http://www.vogella.com/articles/AndroidSQLite/article.html#todo)

# casting - 整数类型转换如何在 Java 互操作中工作？

> ID：16042481
> 
> 赞同：3
> 
> 时间：2013-04-16T16:39:58.433
> 
> 标签：casting, clojure, clojure-java-interop

```
public class Hello {
  public static void test(int i) {
    System.out.println("int");
  }

  public static void test(long l) {
    System.out.println("long");
  }
}

user=> (def foo 1)
#'user/foo

user=> (type foo)
java.lang.Long

user=> (Hello/test 1)
long
nil

user=> (Hello/test foo)
int
nil

user=> (Integer. 1)
1

user=> (Integer. foo)
1

user=> (Short. 1)
IllegalArgumentException No matching ctor found for class java.lang.Short  clojure.lang.Reflector.invokeConstructor (Reflector.java:183) 
```

我无法弄清楚规则。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:49:11.653

简而言之，Clojure 没有与 Java 相同的重载行为。它是一种不同的语言（在 JVM 上运行），有自己的一套规则。因此，如果您定义一个方法`test(short s)`，它将起作用，因为您有一个特定的匹配方法签名，但 Clojure 编译器不会对“最接近”的方法进行扩展转换。

有关链接的更完整讨论，请参阅我对这个问题的回答： [Clojure 重载方法解析用于 Longs](https://stackoverflow.com/questions/12586881/clojure-overloaded-method-resolution-for-longs/12589410#12589410)

# ajax - YouTube iframe API 官方示例给出错误

> ID：16042484
> 
> 赞同：0
> 
> 时间：2013-04-16T16:40:09.487
> 
> 标签：ajax, youtube, cross-browser, youtube-api

截至 2013-04-16 WEST，YouTube iframe API的[官方入门示例在 WinXP/SP3 上的 Chrome 25 中运行时会出现错误消息：](https://developers.google.com/youtube/iframe_api_reference#Getting_Started)

![带有错误消息的 Chrome](https://i.stack.imgur.com/Z4iY0.png)

我正在访问[托管](http://sites.inka.de/klee/youtube/getting_started.html)在 Web 服务器上的示例，即不通过本地文件系统。

难道我做错了什么？示例/API 是否损坏？你能重现这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T05:49:33.953

这个错误消息已经存在了很长一段时间——正如这个 Google Group 帖子所解释的，它是由于 WebKit 中一个未解决的（4 年未解决的！）错误：

[https://groups.google.com/forum/?fromgroups=#!topic/youtube-api-gdata/VKGl4ahBGyk](https://groups.google.com/forum/?fromgroups=#!topic/youtube-api-gdata/VKGl4ahBGyk)

它不应该影响任何东西——它当然不会影响我们的项目，并且在访问您发布的演示 URL 时，它看起来并没有影响那里的 API 功能（即在那个演示中，视频在 6 点后仍然停止根据代码说明的秒数）。不久前有一个 SO 问题认为它可能会影响分析：

[youtube“无法将消息发布到...”导致无法跟踪视频分析](https://stackoverflow.com/questions/13129902/youtube-unable-to-post-message-to-causing-video-analytics-to-not-be-tracked)

但它从未被证实是相关的。

看看 Chrome 迁移到 WebKit 的新 Blink 分支是否会导致 bug 本身得到解决，这将是一件有趣的事情。

# python - 在 python 处理时锁定 innoDB MySQL 中的记录

> ID：16042489
> 
> 赞同：0
> 
> 时间：2013-04-16T16:40:27.013
> 
> 标签：python, mysql, innodb

我有一个名为“未处理”的表，我想读取 2000 行，通过 HTTP 将它们发送到另一台服务器，然后将这些行插入“已处理”表并将它们从“未处理”表中删除。

我的python代码大致是这样的：

```
db = MySQLdb.connect("localhost","username","password","database" )

# prepare a cursor object using cursor() method
cursor = db.cursor()

# Select all the records not yet sent
sql = "SELECT * from unprocessed where SupplierIDToUse = 'supplier1' limit 0, 2000"
cursor.execute(sql)
results = cursor.fetchall()
for row in results:
  id = row[0]
  <code is here here for sending to other server - it takes about 1/2 a second>
  if sentcorrectly="1":
     sql = "INSERT into processed (id, dateprocessed) VALUES ('%s', NOW()')" % (id)
     try:
        inserted = cursor.execute(sql)
     except:
        print "Failed to insert"
     if inserted:
        print "Inserted"
        sql = "DELETE from unprocessed where id = '%s'" % (id)
        try:
            deleted = cursor.execute(sql)
        except:
            print "Failed to delete id from the unprocessed table, even though it was saved in the processed table."
db.close()
sys.exit(0) 
```

我希望能够同时运行此代码，以便提高通过 HTTP 将这些记录发送到其他服务器的速度。目前，如果我尝试同时运行代码，我会在另一个服务器上发送相同数据的多个副本并保存到“已处理”表中，因为选择查询在代码的多个实例中获得相同的 id。

如何在选择记录时锁定记录，然后将每条记录作为一行处理，然后再将它们移动到“已处理”表？该表是 MyISAM，但我今天已转换为 innoDB，因为我意识到可能有一种方法可以更好地使用 innoDB 锁定记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:01:13.247

根据您的评论回复。

两种解决方案之一是客户端 python 主进程，用于收集所有 2000 条记录的记录 ID，然后将其分成块以供子工作人员处理。

短版，您的选择是委派工作或依赖可能棘手的资产锁定机制。我会推荐前一种方法，因为它可以借助消息队列进行扩展。

委托逻辑将使用[多处理](http://docs.python.org/2/library/multiprocessing.html#multiprocessing.pool.multiprocessing.Pool.map)

```
import multiprocessing
records = get_all_unprocessed_ids()
pool = multiprocessing.Pool(5) #create 5 workers
pool.map(process_records, records) 
```

这将创建 2000 个任务并一次运行 5 个任务，或者您可以使用此处概述的解决方案将记录拆分为块 [如何将列表拆分为大小均匀的块？](https://stackoverflow.com/questions/312443/how-do-you-split-a-list-into-evenly-sized-chunks-in-python)

```
pool.map(process_records, chunks(records, 100)) 
```

将创建 20 个包含 100 条记录的列表，这些记录将以 5 条为一组进行处理

编辑：语法错误 - 签名是 map(func, iterable[, chunksize]) 我省略了 func 的参数。

# vba - 将单张幻灯片另存为 .ppt 的 VBA 代码

> ID：16042498
> 
> 赞同：2
> 
> 时间：2013-04-16T16:40:54.710
> 
> 标签：vba, save, powerpoint

我有一个将我指定的幻灯片保存为 PNG 的代码：

```
Dim userName As String
userName = Slide322.TextBox1.Text

'Save slide

ActivePresentation.Slides(302).Export _
        filename:="C:\Users\Jessica\Dropbox\Uni\DISSERTATION\Questionnaire\Tools\Results\" & userName & ".png", FilterName:="PNG" 
```

但是，我想将幻灯片另存为 .PPT，以便以后打开它并编辑该幻灯片上的文本。我曾尝试使用 .SaveAs 语法，但每次都会收到一条错误消息，而且它无法识别任何“保存”类型的表达式。

我已经搜索并搜索了这个问题的答案......有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T20:54:59.643

尝试：

```
ActivePresentation.Slides(1).Export "c:\temp\slide1.ppt", "PPT" 
```

选择：

使用 SaveCopy 保存演示文稿的副本 打开保存的副本（带或不带窗口） 删除所有幻灯片，直到要保留的那张幻灯片 删除要保留的幻灯片之后的所有幻灯片 再次保存。关闭演示文稿

像这样：

```
Sub TestMe()
    SaveSlide 5, "c:\temp\slide5.pptx"
End Sub

Sub SaveSlide(lSlideNum As Long, sFileName As String)

    Dim oTempPres As Presentation
    Dim x As Long

    ActivePresentation.SaveCopyAs sFileName
    ' open the saved copy windowlessly
    Set oTempPres = Presentations.Open(sFileName, , , False)

    For x = 1 To lSlideNum - 1
        oTempPres.Slides(1).Delete
    Next

    ' What was slide number lSlideNum is now slide 1
    For x = oTempPres.Slides.Count To 2 Step -1
        oTempPres.Slides(x).Delete
    Next

    oTempPres.Save
    oTempPres.Close

End Sub 
```

显然，您需要添加一些安全绳......不要尝试导出 12 张幻灯片演示文稿的第 15 张幻灯片等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T10:49:07.347

子拆分文件（）

```
Dim lSlidesPerFile As Long
Dim lTotalSlides As Long
Dim oSourcePres As Presentation
Dim otargetPres As Presentation
Dim sFolder As String
Dim sExt As String
Dim sBaseName As String
Dim lCounter As Long
Dim lPresentationsCount As Long     ' how many will we split it into
Dim x As Long
Dim lWindowStart As Long
Dim lWindowEnd As Long
Dim sSplitPresName As String

On Error GoTo ErrorHandler

Set oSourcePres = ActivePresentation
If Not oSourcePres.Saved Then
    MsgBox "Please save your presentation then try again"
    Exit Sub
End If

lSlidesPerFile = CLng(InputBox("How many slides per file?", "Split Presentation"))
lTotalSlides = oSourcePres.Slides.Count
sFolder = ActivePresentation.Path & "\"
sExt = Mid$(ActivePresentation.Name, InStr(ActivePresentation.Name, ".") + 1)
sBaseName = Mid$(ActivePresentation.Name, 1, InStr(ActivePresentation.Name, ".") - 1)

If (lTotalSlides / lSlidesPerFile) - (lTotalSlides \ lSlidesPerFile) > 0 Then
    lPresentationsCount = lTotalSlides \ lSlidesPerFile + 1
Else
    lPresentationsCount = lTotalSlides \ lSlidesPerFile
End If

If Not lTotalSlides > lSlidesPerFile Then
    MsgBox "There are fewer than " & CStr(lSlidesPerFile) & " slides in this presentation."
    Exit Sub
End If

For lCounter = 1 To lPresentationsCount

    ' which slides will we leave in the presentation?
    lWindowEnd = lSlidesPerFile * lCounter
    If lWindowEnd > oSourcePres.Slides.Count Then
        ' odd number of leftover slides in last presentation
        lWindowEnd = oSourcePres.Slides.Count
        lWindowStart = ((oSourcePres.Slides.Count \ lSlidesPerFile) * lSlidesPerFile) + 1
    Else
        lWindowStart = lWindowEnd - lSlidesPerFile + 1
    End If

    ' Make a copy of the presentation and open it
    sSplitPresName = sFolder & sBaseName & _
           "_" & CStr(lWindowStart) & "-" & CStr(lWindowEnd) & "." & sExt
    oSourcePres.SaveCopyAs sSplitPresName, ppSaveAsDefault
    Set otargetPres = Presentations.Open(sSplitPresName, , , True)

    With otargetPres
        For x = .Slides.Count To lWindowEnd + 1 Step -1
            .Slides(x).Delete
        Next
        For x = lWindowStart - 1 To 1 Step -1
            .Slides(x).Delete
        Next
        .Save
        .Close
    End With

Next    ' lpresentationscount 
```

NormalExit：Exit Sub ErrorHandler：MsgBox“遇到错误” Resume NormalExit End Sub

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:54:33.173

您可以尝试以下代码：

1.  创建新的演示文稿
2.  将幻灯片复制到它
3.  保存和关闭新的演示文稿。

    ```
    Sub SaveSeparateSlide()

        Dim curPres As Presentation
        Set curPres = ActivePresentation
        Dim newPres As Presentation
        Set newPres = Presentations.Add

    'change slide number here:
    curPres.Slides(1).Copy
    newPres.Slides.Paste

        'change your path and name here:
        newPres.SaveAs "single slide presentation.pptx"
        newPres.Close
    End Sub 
    ```

您将需要稍微调整该代码，但我认为您会应付:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-10T06:03:10.573

```
ActivePresentation.Slides(1).Export "1.ppt", "PPT" 
```

上面的代码将 Slide#1 导出为“旧”类型的 ppt 格式。以下 2 个宏中的第 2 个可以以更兼容的“新”pptx 格式保存副本。它实际上是史蒂夫的两种方法的混合。但它不会打扰删除其余的幻灯片。

```
Sub SaveEachPage2PPT()

Dim sld As Slide
Dim l#

With ActivePresentation
    For Each sld In .Slides
        l = l + 1
        sld.Export .Path & "\" & l & ".ppt", "PPT"
    Next sld
End With
End Sub

Sub SaveEachPage2PPTX()

Dim sld As Slide
Dim l#
Dim ppt As Presentation
Dim pptFile$

With ActivePresentation
    For Each sld In .Slides
        l = l + 1
        pptFile = .Path & "\" & l & ".ppt"
        sld.Export pptFile, "PPT"
        Set ppt = Presentations.Open(pptFile, , , False)
        ppt.SaveCopyAs pptFile & "x", ppSaveAsOpenXMLPresentation
        ppt.Close
        Kill pptFile
    Next sld
End With
If Not ppt Is Nothing Then Set ppt = Nothing

End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-19T04:34:18.863

以下脚本将帮助您将演示文稿的各个幻灯片保存为单独的 pptx 文件。我修改`@Steve Rindsberg`了代码来实现这一点。

只需在代码中更改以下内容

1.  更改`K:\PRESENTATION_YOU_ARE_EXPORTING.pptx`您要导出的演示文稿的文件路径。

2.  更改`K:\FOLDER PATH WHERE PPTX SHOULD BE EXPORTED\`应保存导出演示文稿的文件夹路径。

3.  请记住在步骤 2 中的文件夹路径末尾添加 \。

    ```
    Sub ExportSlidesToIndividualPPPTX()
      Dim oPPT As Presentation, oSlide As Slide
      Dim sPath As String
      Dim oTempPres As Presentation
      Dim x As Long

      ' Location of PPTX File
      Set oPPT = Presentations.Open(FileName:="K:\PRESENTATION_YOU_ARE_EXPORTING.pptx")
      ' Location Where Individual Slides Should Be Saved
      ' Add \ in the end
      sPath = "K:\FOLDER PATH WHERE PPTX SHOULD BE EXPORTED\"

      For Each oSlide In oPPT.Slides
         lSlideNum = oSlide.SlideNumber
         sFileName = sPath & "Slide - " & lSlideNum & ".pptx"
         oPPT.SaveCopyAs sFileName
         ' open the saved copy windowlessly
         Set oTempPres = Presentations.Open(sFileName, , , False)

         ' Delete all slides before the slide you want to save
         For x = 1 To lSlideNum - 1
             oTempPres.Slides(1).Delete
         Next

         ' Delete all slides after the slide you want to save
         For x = oTempPres.Slides.Count To 2 Step -1
             oTempPres.Slides(x).Delete
         Next

         oTempPres.Save
         oTempPres.Close

      Next

      Set oPPT = Nothing

    End Sub 
    ```

# c# - 带有 Dapper 存储过程的表值参数

> ID：16042499
> 
> 赞同：5
> 
> 时间：2013-04-16T16:40:54.873
> 
> 标签：c#, sql-server-2008, dapper

我正在尝试调用一个接受表值参数的存储过程。

我正在遵循[这个](https://stackoverflow.com/q/6232978/20048)问题的指导方针，实施自定义参数类型：

```
internal class IntDynamicParam
{
    string name;
    IEnumerable<int> numbers;

    public IntDynamicParam(string name,IEnumerable<int> numbers)
    {
        this.name = name;
        this.numbers = numbers;
    }

    public void AddParameters(IDbCommand command)
    {
        var sqlCommand = (SqlCommand)command;
        sqlCommand.CommandType = CommandType.StoredProcedure;

        List<Microsoft.SqlServer.Server.SqlDataRecord> number_list = new List<Microsoft.SqlServer.Server.SqlDataRecord>();

        // Create an SqlMetaData object that describes our table type.
        Microsoft.SqlServer.Server.SqlMetaData[] tvp_definition = { new Microsoft.SqlServer.Server.SqlMetaData("n", SqlDbType.Int) };

        foreach (int n in numbers)
        {
            // Create a new record, using the metadata array above.
            Microsoft.SqlServer.Server.SqlDataRecord rec = new Microsoft.SqlServer.Server.SqlDataRecord(tvp_definition);
            rec.SetInt32(0, n);    // Set the value.
            number_list.Add(rec);      // Add it to the list.
        }

        // Add the table parameter.
        var p = sqlCommand.Parameters.Add("@" +name, SqlDbType.Structured);
        p.Direction = ParameterDirection.Input;
        p.TypeName = "int_list_type";
        p.Value = number_list;

    }
} 
```

并尝试按如下方式使用它：

```
var p = new DynamicParameters();
 p.AddDynamicParams(new IntDynamicParam("@IDList", new int[] { 1000, 2000, 3000 }));
 p.Add("@StartRow", startRow);
 p.Add("@EndRow", endRow);
 p.Add("@OrderByField", orderByField.ToString());
 p.Add("@OrderBy", orderBy.ToString());
 p.Add("@TotalRows", 0, dbType: DbType.Int32, direction: ParameterDirection.Output);
 var v = cnn.Query<venue>(spName, p,
                    commandType: CommandType.StoredProcedure).ToList<IDBVenueLite>(); 
```

但是参数“ *@IDList* ”没有被传递。显然 AddDynamicParams 不是要走的路，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T07:07:16.877

从历史上看，表值参数并不是 dapper 的重点。主要是因为它们仅适用于`SqlConnection`（dapper 试图针对任意提供程序，包括“装饰”的 ADO.NET 提供程序 - 即 a`SqlConnection`隐藏在某个包装器下面的位置）。你*可以*做的是`IDynamicParameters`手动实现（或者只是借用现有的`DynamicParameters`类）来添加这个功能：

```
void SqlMapper.IDynamicParameters.AddParameters(System.Data.IDbCommand command,
                                                SqlMapper.Identity identity)
{
    ...
    // and then whatever the code is...
    ((SqlCommand)command).Parameters
        .AddWithValue(...,...).SqlDbType = System.Data.SqlDbType.Structured;
    ...
} 
```

我还将`DynamicParameters`在这里努力使具体类更具多态性，以便在将来的构建中，您可以只`override`使用一个方法，检测 TVP-ish 类型，然后手动添加参数。

# android - 在android中使用sdl

> ID：16042500
> 
> 赞同：1
> 
> 时间：2013-04-16T16:40:55.457
> 
> 标签：android, android-ndk, java-native-interface, sdl

我已经成功地交叉编译了 android 平台的 sdl 库，现在我想在 android 屏幕中显示我的 sdl 表单，如 SDL_Surface 和 SDL_Rect 。这怎么可能？

这是我的第一次尝试

```
 SDLRenderer::SDLRenderer    () :
         bmp            (NULL),
         screen         (NULL),
         imgConvertCtx  (NULL),
         isInit         (false),
         quitKeyPressed (false)
  {
  }
  SDLRenderer::~SDLRenderer   ()
  {
  }

  bool    SDLRenderer::init                   (int width, int height)
  {       LOGI("sdlrenderer init");
this->screen = SDL_SetVideoMode(width, height, 0, 0);

  if(!screen){
    LOGI("!screen");
    return false;
  }

this->bmp = SDL_CreateYUVOverlay(width, height, SDL_YV12_OVERLAY, this->screen);

LOGI("SDL_CreateYUVOverlay passed");

return true;
}
bool    SDLRenderer::processEvents          ()
{
 SDL_Event sdlEvent;
 while(SDL_PollEvent(&sdlEvent))
 {
     switch(sdlEvent.type)
     {
         case SDL_KEYDOWN:
             if(sdlEvent.key.keysym.sym == SDLK_ESCAPE)
                 this->quitKeyPressed = true;
             break;
         case SDL_QUIT: this->quitKeyPressed = true; break;
     } 
 }

 return true;
}
bool    SDLRenderer::isQuitKeyPressed       ()
{
return this->quitKeyPressed;
}
void    SDLRenderer::onVideoDataAvailable   (const uint8_t **data,         videoFrameProperties* props)
{LOGI("sdlrenderer data availabe");
   if(!this->isInit){
    this->isInit = this->init(props->width, props->height);
    LOGI("sdlrenderer data availabe calling render init"); 
   }
   LOGI("before     SDL_LockYUVOverlay(bmp);"); 

SDL_LockYUVOverlay(bmp);
LOGI("after     SDL_LockYUVOverlay(bmp);"); 

AVPicture pict;
LOGI("after    AVPicture pict;"); 

pict.data[0] = bmp->pixels[0];
pict.data[1] = bmp->pixels[2];
pict.data[2] = bmp->pixels[1];

pict.linesize[0] = bmp->pitches[0];
pict.linesize[1] = bmp->pitches[2];
pict.linesize[2] = bmp->pitches[1];
  LOGI("after     creating avpicture"); 

// Convert the image into YUV format that SDL uses
if(imgConvertCtx == NULL)
{
    int w = props->width;
    int h = props->height;

    imgConvertCtx = sws_getContext(props->width, props->height, (PixelFormat)props-     >pxlFmt, w, h, PIX_FMT_YUV420P, SWS_BICUBIC, NULL, NULL, NULL);

    if(imgConvertCtx == NULL)
    { LOGI("imgConvertCtx == NULL"); 

        fprintf(stderr, "Cannot initialize the conversion context!\n");
        exit(1);
    }
}

sws_scale(imgConvertCtx, data, props->linesize, 0, props->height, pict.data,   pict.linesize);
 LOGI("calling SDL_UnlockYUVOverlay(bmp);"); 

SDL_UnlockYUVOverlay(bmp);

rect.x = 0;
rect.y = 0;
rect.w = props->width;
rect.h = props->height;
LOGI("sdlrenderer displaying");
SDL_DisplayYUVOverlay(bmp, &rect);
} 
```

有我的主要

```
int main(int argc, char *argv[])
{
    SDLRenderer     *renderer = new SDLRenderer();
    DASHReceiver    *receiver = new DASHReceiver(30); 

    receiver->Init("http://www----custom url here");

    LibavDecoder *decoder = new LibavDecoder(receiver);

    decoder->attachVideoObserver(renderer);
    decoder->setFrameRate(24);
    decoder->init();

    bool eos = false;

    while(!renderer->isQuitKeyPressed() && !eos)
  {
      eos = !decoder->decode();
      renderer->processEvents();
   }

   decoder->stop();

return 0;
  } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T14:03:24.363

据我所知，您正在尝试移植 bitmovin 开源破折号播放器。我已经这样做了，一旦将 SDL 移植到 android，该软件的所有其他部分都可以正常工作。我的代码与您完全相同，这部分运行良好确保在 java 部分中定义表面尝试使用 SDLActivity google 并使用此处提供的 java 代码然后仔细查看此处[http://lists。 libsdl.org/pipermail/sdl-libsdl.org/2011-July/081481.html](http://lists.libsdl.org/pipermail/sdl-libsdl.org/2011-July/081481.html)对java代码做一些小的修改

```
 // The Unimplemented OpenGL ES API notices *always* indicate you have
    // the incorrect context version, which has to be fixed in SDLActivity.java .
    int EGL_CONTEXT_CLIENT_VERSION = 0x3098;
    int contextAttrs[] = new int[]{
                      EGL_CONTEXT_CLIENT_VERSION, majorVersion,
                      EGL10.EGL_NONE
                       };
     EGLContext ctx = egl.eglCreateContext(dpy, config,EGL10.EGL_NO_CONTEXT, contextAttrs);
     if (ctx == EGL10.EGL_NO_CONTEXT) {
          Log.e("SDL", "Couldn't create context");
          return false;
     }

    /*
    EGLContext ctx = egl.eglCreateContext(dpy, config, EGL10.EGL_NO_CONTEXT, null);
    if (ctx == EGL10.EGL_NO_CONTEXT) {
        Log.e("SDL", "Couldn't create context");
        return false;
    }
    */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:35:41.353

You are missing an [`SDL_Flip`](http://sdl.beuc.net/sdl.wiki/SDL_Flip) or an [`SDL_UpdateRect`](http://sdl.beuc.net/sdl.wiki/SDL_UpdateRect) to be called on your main SDL_surface, which will update it on the screen.

# spring - SpringMVC 3.0 到 ControllerClassNameHandlerMapping 的 3.1 迁移

> ID：16042502
> 
> 赞同：4
> 
> 时间：2013-04-16T16:40:57.167
> 
> 标签：spring, spring-mvc, url-mapping

我在 Sping 3.0 中有一个现有的应用程序，它使用 ControllerClassNameHandlerMapping 来映射控制器和方法，例如：

```
StartController.class is mapped to http://127.0.0.1/app/start/* 
```

然后

```
StartController.class has a method called init() that is mapped to http://127.0.0.1/app/start/init.html 
```

这是我的配置：

```
@Bean
public ControllerClassNameHandlerMapping classNameControllerMappings() {
     return new ControllerClassNameHandlerMapping() {{
        setCaseSensitive(true);
        setDefaultHandler(new UrlFilenameViewController());
        setInterceptors(new Object[]
                {callProgressionInterceptorHandler(),
                 callSessionInterceptorHandler(),
                 localeChangeInterceptor()});
     }};
} 
```

我的大多数控制器在每个控制器中都有 5-15 个请求映射方法。

但是当我升级到 Spring 3.1+ 时，每个控制器的请求映射变得不明确，并且没有正确映射。

我读过一种解决方案是明确添加方法名称：

```
@RequestMapping(method = RequestMethod.GET) 
```

现在将是：

```
@RequestMapping(method = RequestMethod.GET, value = "init") 
```

如果我不需要，我真的不想手动将 @RequestMapping 值添加到 100 多个方法。

任何人都可以提供更好的解决方案吗？

这是我不断收到的错误：

```
 47672 [btpool0-1] ERROR org.springframework.web.context.ContextLoader - Context initialization failed
    org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0': Invocation of init method failed; nested exception is java.lang.IllegalStateException: Ambiguous mapping found. Cannot map 'addressConfirmationController' bean method
    public void com.comcast.ivr.d2.web.controllers.AddressConfirmationController.houseNumber_rc(org.springframework.ui.ModelMap)
    to {[],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}: There is already 'addressConfirmationController' bean method 
```

我还添加了 setOrder(1); 到 ControllerClassNameHandlerMapping 并仍然收到此错误。

更新：我在[http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html)上看到了以下摘录：

在 Spring 3.1 之前，类型和方法级别的请求映射在两个独立的阶段进行检查——首先由 DefaultAnnotationHandlerMapping 选择控制器，然后由 AnnotationMethodHandlerAdapter 缩小要调用的实际方法。

使用 Spring 3.1 中的新支持类，RequestMappingHandlerMapping 是唯一决定哪个方法应该处理请求的地方。将控制器方法视为唯一端点的集合，每个方法的映射都派生自类型和方法级 @RequestMapping 信息。

这是否意味着我不能像在 <3.1 那样在 @RequestMapping 中添加映射详细信息的情况下保持相同的 @RequestMapping ？

我有数百种方法需要修改才能实现... :-(

# asp.net - 如何在 iOS 设备与 ASP.NET URL 之间发送和接收 JSON POST？

> ID：16042506
> 
> 赞同：0
> 
> 时间：2013-04-16T16:41:21.497
> 
> 标签：asp.net, ios, json

我正在开发需要与 Windows 服务器共享数据的 iDevice 应用程序。我查看了网络上的一些示例，并提出了下面列出的实现。iOS 应用程序将 JSON 发送到 Web 服务器并接收返回的 JSON 响应。然而，反应不是我所期望的。我收到`{"d": "{\"name\": \"John Doe\", \"email\": \"test@gmail.com\"}"}`，而不是`{\"name\": \"John Doe\", \"email\": \"test@gmail.com\"}`任何想法“d”来自哪里？

iOS 代码：

```
-(void)checkWithServer {
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];
    NSURL *postURL = [NSURL URLWithString: @"http://texas/WebSite3/Service.asmx/doSomething"];
    NSDictionary *jsonDict = [[NSDictionary alloc] initWithObjectsAndKeys:
                              @"test@gmail.com", @"email",
                              @"John Doe", @"name",
                              nil];

    NSError *error;
    NSData *jsonData = [NSJSONSerialization dataWithJSONObject:jsonDict options:0 error:&error];

    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL: postURL
                                                           cachePolicy: NSURLRequestUseProtocolCachePolicy
                                                       timeoutInterval: 60.0];

    [request setHTTPMethod: @"POST"];
    [request setValue: @"application/json" forHTTPHeaderField: @"Accept"];
    [request setValue: @"application/json; charset=utf-8" forHTTPHeaderField: @"content-type"];
    [request setHTTPBody: jsonData];

    [NSURLConnection sendAsynchronousRequest: request
                                       queue: queue
                           completionHandler: ^(NSURLResponse *response, NSData *data, NSError *error) {
                               if (error || !data) {
                                   // Handle the error
                               } else {
                                   // Handle the success
                               }
                           }
     ];
} 
```

网络服务器代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.Web.Services.Protocols;
using System.Web.Script.Services;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Json;
using System.Xml;
using System.Xml.Linq;
using System.Data;
using System.Data.SqlClient;

[WebService(Namespace = "http://texas/WebSite3")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment   the following line. 
[System.Web.Script.Services.ScriptService]
public class Service : System.Web.Services.WebService
{
    public Service () {

    //Uncomment the following line if using designed components 
    //InitializeComponent(); 
    }

    [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string doSomething(string email, string name)
    {
        return "{\"name\": \"" + name + "\", \"email\": \"" + email + "\"}";
    }
} 
```

显然，网络服务器足够聪明，可以将 JSON 分开并分配变量名称和电子邮件。

# javascript - 如何在 AngularJS 中使用 $resource 查询所有内容

> ID：16042508
> 
> 赞同：6
> 
> 时间：2013-04-16T16:41:32.263
> 
> 标签：javascript, rest, angularjs, jax-rs

我不相信我了解如何正确使用 Angular 的服务。我正在使用 JAX-RS 服务器端。

如果服务应该像这样工作（取自[phonecat 示例](https://github.com/angular/angular-phonecat/blob/master/app/js/services.js)）......

```
angular.module('workstation.services', ['ngResource']).
    factory('WorkflowService', function($resource, apiUrl){
        return $resource(apiUrl+'/api/workflow/:uuid', {uuid:'@uuid'}, {});
    }); 
```

那么如何查询所有工作流呢？我无法使用`WorkflowService`来完成此操作，因为它已经尝试过`/api/workflow/:uuid`. 我需要另一个基于另一个 URL 的服务。

这似乎不是很灵活，除非我用错了。

我习惯于看到`Service`所有查询数据的句柄，并且有`WorkflowService.getActiveWorkflows()`返回之类的方法`Workflow[]`

但是我不确定如何组织此服务，因为我仍然希望拥有与单个实体交互的方法，例如`WorkflowService.save(workflow);`. 由于`$resource`s 被设计成围绕特定的 RESTful URL，因此很难正确地构建它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-23T08:57:23.183

检查[$resource 的角度文档](https://docs.angularjs.org/api/ngResource/service/$resource)，阅读*操作*参数。它支持定义一个 url，该 url 将覆盖特定操作的基本 url。

使用默认操作“queryAll”，您可以从资源中查询*所有内容。*

例子：

```
angular.module('workstation.services', ['ngResource']).
factory('WorkflowService', function($resource, apiUrl){
    return $resource(apiUrl+'/api/workflow/:uuid', {uuid:'@uuid'}, {
        queryAll: {
            url: apiUrl + '/api/workflow/getAllActive',
            method: 'GET',
            cache: false,
            isArray: true
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T19:10:30.697

我最终得到了这个解决方案......

这使我可以在服务中构建我想要的任何解决方案，同时仍然可以访问可用资源。

```
'use strict';

/* Services */

angular.module('workstation.services', ['ngResource']).
    service('WorkflowService', function ($resource, $http, apiUrl) {
        var service = new BaseService($resource(apiUrl+'/api/workflow/:uuid', {uuid:'@uuid'}, {}));

        /* Get all available workflows */
        service.getWorkflows = function () {
            return $http.get(apiUrl+'/api/workflow/getAllActive').then(function (response) { return response.data });
        }

        return service;
    });

/* Base service */
function BaseService(resource) {
    this.resource = resource
};
BaseService.prototype.getResource = function () { return this.resource }
BaseService.prototype.newResourceInstance = function () { return new this.resource } 
```

# android - 使用 Fragments 更改 Android 布局

> ID：16042510
> 
> 赞同：2
> 
> 时间：2013-04-16T16:41:40.077
> 
> 标签：android, android-fragments, google-maps-android-api-2, onconfigurationchanged

我正在开发一个有两个片段的 Android 活动。Activity 有**两种可能的布局**，一种在 Portait，另一种在 Landscape。

我创建的片段运行良好，但是当我更改手机/平板电脑的方向时遇到了麻烦。

其中一个 Fragment 是**ListFragment**，带有一个 AsyncTask 来从 Web 加载列表数据。有了这个片段，我就没有问题了，因为我可以再次创建它。（虽然加载需要一段时间）。

另一个**Fragment**内部有一个 Google Map V2 片段：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <fragment
        android:id="@+id/mapInicio"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment" />

</LinearLayout> 
```

`onCreate`我从以下方法创建片段`FragmentActivity`：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_inicio);

    Fragment listFragment = new ListaEstaciones();
    FragmentTransaction transList = getSupportFragmentManager()
            .beginTransaction();
    transList.add(R.id.listaestaciones_f_container, listFragment);
    transList.commit();

    Fragment mapFragment = new MapaGoogleV2();
    FragmentTransaction transMap = getSupportFragmentManager()
            .beginTransaction();
    transMap.add(R.id.mapa_f_container, mapFragment);
    transMap.commit();

} 
```

在`onConfigurationChanged`方法中，我有这个代码。如在 中`onCreate`，我创建了片段，并更改了视图，因为现在我们处于横向/纵向：

```
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);

    setContentView(R.layout.activity_inicio);

    Fragment listFragment = new ListaEstaciones();
    FragmentTransaction transaction = getSupportFragmentManager()
            .beginTransaction();
    transaction.add(R.id.listaestaciones_f_container, listFragment);
    transaction.commit();

    Fragment mapFragment = new MapaGoogleV2();
    FragmentTransaction transMap = getSupportFragmentManager()
            .beginTransaction();
    transMap.add(R.id.mapa_f_container, mapFragment);
    transMap.commit();

} 
```

当我在此方法中创建 ListFragment 时效果很好，但不适用于 MapFragment。**带有 Map**`onCreateView`的 Fragment 方法中的应用程序崩溃。我想我不能再膨胀这个片段了：

 **> 04-16 18:20:32.795: E/AndroidRuntime(15543): android.view.InflateException: Binary XML file line #6: Error inflating class fragment

我的问题：

**有没有办法在更改布局时避免重新创建片段？**

**我怎样才能做到这一点？**

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:06:07.407

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:48:02.390

如果您所需要的只是纵向和横向的不同布局，那么有一种更简单的方法可以做到这一点。创建一个文件夹 layout-land 并将布局 XML 放在那里，用于您想要在横向中指定不同布局的任何片段/活动。Android 将根据方向处理要使用的布局。[查看](http://developer.android.com/guide/practices/screens_support.html)developer.android.com 上的此页面以获取更多信息。

这是我的意思[的另一个例子。](http://tekeye.biz/2012/android-portrait-landscape-screens)**

# php - Del 标签未关闭 WooCommerce 销售价格（仅限 IE）

> ID：16042512
> 
> 赞同：0
> 
> 时间：2013-04-16T16:41:51.297
> 
> 标签：php, mysql, css, woocommerce

在 Woocommerce 2 上，打折产品在`<del>`标签中显示正常价格，然后是销售价格（它本身在`<ins>`标签中）。IE8 会`<del>`在正常价格上显示一个标签，然后`<del>`在销售项目之后的所有文本上重新应用该标签（甚至一直到页脚）。只有常规项目应显示`<del>`标签。所有其他浏览器都正确显示。它似乎在 class-wc-product-variation.php 上。我看到了对标签插入的引用：

`public function get_price_html() {`

 ````
 if ( $this->price !== '' ) {
        if ( $this->price == $this->sale_price && $this->sale_price < $this->regular_price ) {

            $price = '<del>' . woocommerce_price( $this->regular_price ) . '</del> <ins>' . woocommerce_price( $this->sale_price ) . '</ins>';
            $price = apply_filters( 'woocommerce_variation_sale_price_html', $price, $this );

        } elseif ( $this->price > 0 ) {

            $price = woocommerce_price( $this->price );
            $price = apply_filters( 'woocommerce_variation_price_html', $price, $this );

        } else {

            $price = __( 'Free!', 'woocommerce' );
            $price = apply_filters( 'woocommerce_variation_free_price_html', $price, $this );

        }
    } else {
        $price = apply_filters( 'woocommerce_variation_empty_price_html', '', $this );
    }

    return $price;
} 
````  `我在那里看不到任何会使 IE 无法关闭`<del>`标签的东西。我在 WooCommerce 的 CSS 文件中没有看到任何与`<del>`,`<strike>`或`line-through`.

显然，我的白内障正在加班，我错过了一些明显的东西。任何人？布勒？`

# php - 使用 PDO 语句更新

> ID：16042513
> 
> 赞同：1
> 
> 时间：2013-04-16T16:41:53.640
> 
> 标签：php, mysql, pdo

我仍然对 PDO 语句感到困惑，但下面的代码并没有像我想象的那样做

```
 $temp = "6c ";    
  $weather_report = "Its currently $temp " ; 

  $qry = $pdo->exec("UPDATE data_weather SET text= '$weather_report' WHERE period='report' "); 
```

这确实更新了我的数据库，但仅使用“当前”并且缺少临时值，

在阅读了一些文章后，我相信我需要使用报价，但我不知道如何实现它？

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:44:39.103

请使用查询参数而不是将变量插入 SQL 字符串。
它更安全、更快、更容易。

```
$temp = "6c ";    
$weather_report = "It's currently $temp " ; 

$sql = "UPDATE data_weather SET text= ? WHERE period='report'";
$stmt = $pdo->prepare($sql);
$stmt->execute(array($weather_report)); 
```

请注意，您不需要引用字符串。事实上，您*不能*`?`在占位符周围加上引号。您可以安全地在天气报告字符串中使用撇号。

您可以在通常将单个标量值放在 SQL 表达式中的任何位置使用参数占位符。例如，代替带引号的字符串、带引号的日期或数字文字。但不适用于表名或列名，也不适用于值列表或 SQL 关键字。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-07-17T18:21:47.827

虽然比尔已经回答了这个问题，但我想补充一下：

**不要将命名参数与 TEXT 列一起使用，至少不要与 MySQL 一起使用。它行不通。请改用问号。**

# java - 如何使用java将ms word文件转换为pdf

> ID：16042520
> 
> 赞同：-2
> 
> 时间：2013-04-16T16:42:38.847
> 
> 标签：java

如何使用java将doc转换为pdf？

我正在寻找一个应用程序来自动将word文件转换为pdf，根本不需要用户交互，这可能吗？

实现这一目标的最佳方法是什么，以及一个例子？

而且我不能使用apache

我应该添加它只需要做文本，仅此而已

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:49:06.090

没有第三方库就无法做到这一点，除非您自己编写整个 PDF 渲染引擎。你*真的*不想尝试这样做。

Apache PDFBox 通常是解决此类问题的方法。

# php - 我需要一个查找表来解决这个问题吗？

> ID：16042521
> 
> 赞同：-1
> 
> 时间：2013-04-16T16:42:44.217
> 
> 标签：php, mysql

我正在用 MySQL 和 PHP 编写这个。我有三个表，它们是：

*   一个用户表 - user_id，用户名
*   字符表 - id_chars、char_1、char_2... char_8
*   职业表 - id_profession、职业、姓名...（列继续）

现在我只有PK没有FK。只是其中包含测试数据的主要结构。

我想要做的是让一个用户对多个职业和一个用户对多个角色。

这样，可以选择一个用户，然后从分配给该用户的角色列表中进行选择，然后在职业列表中标记一个或多个项目。这样，对于每个用户/角色配对，专业列表中的标记项目都会被唯一地跟踪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:45:28.003

简短的回答是肯定的。

长答案涉及您未指定的架构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:47:24.733

是的，您需要一个查找表。查找表在唯一键对应于本身可以是项目列表的值的情况下很有用。您的情况适合根据您告诉我们的内容进行查找

# javascript - 在Angularjs中有条件地添加表格元素

> ID：16042522
> 
> 赞同：1
> 
> 时间：2013-04-16T16:42:51.890
> 
> 标签：javascript, angularjs

我有一些 json 要呈现在一个看起来像的表中；

```
[{"title":"Super Event","date":"Mon 12 June"},
 {"title":"Another Event","date":"Tue 13 June"},
 {"title":"Something Else","date":"Tue 13 June"}] 
```

我想创建一个包含每一天事件的每个日期的表格，或者一个带有日期行后跟日期事件的表格。我最初在 jquery 中对此进行了编码，首先创建表，然后将事件附加到相应的日期表中。目前我只能显示每个事件的每个日期。

```
<table>
    <tr ng-repeat="event in events"><th>{{event.date}}</th>
    <td>{{event.title}}</td></tr>
  </table> 
```

有没有一种简单的方法可以在角度上做到这一点，还是应该用 jquery 来完成？

编辑：我需要的表输出必须有一行或带有日期的标题，然后是事件名称的行，例如

```
Mon 12 June
Super Event

Tue 13 June
Another Event
Something Else 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:05:36.757

有几种方法可以做到这一点。第一个是带过滤器的：

演示：http: [//jsfiddle.net/lucuma/DQ8PK/](http://jsfiddle.net/lucuma/DQ8PK/)

HTML：

```
<div ng-app ng-controller="Main">
    <table ng-repeat="event in eventsToFilter() | filter:filterDate">
        <tr><th>{{event.date}}</th></tr>
        <tr ng-repeat="e in events | filter: {date: event.date}">
            <td>{{e.title}} - {{e.date}}</td>
        </tr>
    </table>
</div> 
```

JS：

```
function Main($scope) {

    $scope.events = [{
        "title": "Super Event",
        "date": "Mon 12 June"
    }, {
        "title": "Another Event",
        "date": "Tue 13 June"
    }, {
        "title": "Something Else",
        "date": "Tue 13 June"
    }];

    var filterDates = [];
    $scope.eventsToFilter = function () {
        filterDates = [];
        return $scope.events;
    }

    $scope.filterDate = function (event) {
        dateIsNew = filterDates.indexOf(event.date) == -1;
        if (dateIsNew) {
            filterDates.push(event.date);
        }
        return dateIsNew;
    }
} 
```

第二个可以像下面这样检查 event.date 的值并在它发生变化时有条件地做一些事情。以下问题概述了该策略： [Angular ng-repeat with header views](https://stackoverflow.com/questions/15577791/angular-ng-repeat-with-header-views/15577881#15577881)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:05:15.377

像这样的东西怎么样：[http](http://plnkr.co/edit/3DvokKEvZeHS9gDMectM?p=preview) ://plnkr.co/edit/3DvokKEvZeHS9gDMectM?p=preview ？

我为 groupBy 创建了一个快速过滤器，它在传入的值上创建一个键：

```
ng-repeat="(date,list) in data | groupBy:'date'" 
```

如果你愿意，你可以添加一个排序。

代码如下所示：

```
app.filter('groupBy', function(){
  return function(items,by) {
    var out = {};
    for (var i = 0 ; i < items.length ; i++) {
      var o = out[items[i][by]];
      if (!o) {
        out[items[i][by]] = o = [];
      }
      o.push(items[i])
    }
    return out;
  };
}) 
```

希望有帮助。

# maven - 如何在 maven 项目的 Cucumber 测试下运行 GlassFish 和 Selenium？

> ID：16042525
> 
> 赞同：0
> 
> 时间：2013-04-16T16:43:03.120
> 
> 标签：maven, netbeans, selenium, glassfish, cucumber

如何在 POM 文件中映射所有内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T07:02:27.553

起居室：

```
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
            <modelVersion>4.0.0</modelVersion>
            <groupId>pl.cucumber.test</groupId>
            <artifactId>cucumber-with-glassfish</artifactId>
            <version>1.0.0</version>

            <properties>
                <jdk.version>1.7</jdk.version>
                <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
                <cucumber.version>1.1.3</cucumber.version>
                <junit.version>4.11</junit.version>
                <maven-compiler-plugin.version>3.1</maven-compiler-plugin.version>
                <maven-surefire-plugin.version>2.14.1</maven-surefire-plugin.version>
                <cargo-maven2-plugin.version>1.4.0</cargo-maven2-plugin.version>
                <glasfish.port>8080</glasfish.port>
                <glasfish.home>${project.build.directory}/glasfish</glasfish.home>
                <selenium.version>2.32.0</selenium.version>
            </properties>

            <dependencies>
                <dependency>
                    <groupId>info.cukes</groupId>
                    <artifactId>cucumber-java</artifactId>
                    <version>${cucumber.version}</version>
                    <scope>test</scope>
                </dependency>
                <dependency>
                    <groupId>info.cukes</groupId>
                    <artifactId>cucumber-junit</artifactId>
                    <version>${cucumber.version}</version>
                    <scope>test</scope>
                </dependency>

                <dependency>
                    <groupId>junit</groupId>
                    <artifactId>junit</artifactId>
                    <version>${junit.version}</version>
                    <scope>test</scope>
                </dependency>
                <dependency>
                    <groupId>org.seleniumhq.selenium</groupId>
                    <artifactId>selenium-java</artifactId>
                    <scope>test</scope>
                    <version>${selenium.version}</version>
                </dependency>
            </dependencies>

            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-compiler-plugin</artifactId>
                        <version>${maven-compiler-plugin.version}</version>
                        <configuration>
                            <source>${jdk.version}</source>
                            <target>${jdk.version}</target>
                        </configuration>
                    </plugin>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-failsafe-plugin</artifactId>
                        <version>${maven-surefire-plugin.version}</version>
                        <executions>
                            <execution>
                                <id>integration-test</id>
                                <goals>
                                    <goal>integration-test</goal>
                                    <goal>verify</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                    <plugin>
                        <groupId>org.codehaus.cargo</groupId>
                        <artifactId>cargo-maven2-plugin</artifactId>
                        <version>${cargo-maven2-plugin.version}</version>
                        <configuration>
                            <container>
                                <containerId>glassfish3x</containerId>
                                <zipUrlInstaller>
                                    <url>http://dlc.sun.com.edgesuite.net/glassfish/3.1.2.2/release/glassfish-3.1.2.2.zip</url>
                                    <downloadDir>${basedir}/downloads</downloadDir>
                                </zipUrlInstaller>
                                <output>${project.build.directory}/container.log</output>
                                <append>false</append>
                                <log>${project.build.directory}/cargo.log</log>
                                <systemProperties>
                                    <mySystemProperty>value</mySystemProperty>
                                </systemProperties>
                            </container>
                            <configuration>
                                <home>${glasfish.home}</home>
                                <properties>
                                    <cargo.servlet.port>${glasfish.port}</cargo.servlet.port>
                                    <cargo.logging>medium</cargo.logging>
                                </properties>
                            </configuration>
                            <!--
                            <deployables>
                                 <deployable>
                                                      <groupId>pl.cucumber.warproject</groupId>
                                                      <artifactId>warproject</artifactId>
                                                      <version>1.0</version>
                          <type>war</type>
                                   <properties>
                                     <context>mycontext</context>
                                  </properties>
                                </deployable>
                            </deployables>
                             -->
                        </configuration>
                        <executions>
                            <execution>
                                <id>start-container</id>
                                <phase>pre-integration-test</phase>
                                <goals>
                                    <goal>start</goal>
                                </goals>
                            </execution>
                            <execution>
                                <id>stop-container</id>
                                <phase>post-integration-test</phase>
                                <goals>
                                    <goal>stop</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </project> 
```

运行：

```
@RunWith(Cucumber.class)
public class RunIT {
    //
} 
```

测试标题页：

```
public class TestTitlePages {

    private WebDriver driver;

    @Given("^Connect to the given address$")
    public void a_User_has_no_money_in_their_current_account() {
        // Create a new instance of the html unit driver
        driver = new HtmlUnitDriver();

    }

    @When("^Address is (.*)$")
    public void connectTo(String address) {
        //Navigate to desired web page
        driver.get(address);
    }

    @Then("^Title is (.*)$")
    public void titleIs(String expectedTitle) {
        //get the title of the page
        String actualTitle = driver.getTitle();
        // verify title
        Assert.assertEquals(actualTitle,expectedTitle);
    }

} 
```

测试功能：

```
Feature: Check the title

Scenario: Connect to the given address and check the title
Given Connect to the given address
When Address is http://www.google.com
Then Title is Google 
```

项目结构：

```
src/test/
    java/
        pl/cucumber/test/
            RunIT.java
            TestTitlePages.java
    resources
        pl/cucumber/test
            test.feature 
```

称呼`mvn verify`

# r - 过程太耗时

> ID：16042527
> 
> 赞同：1
> 
> 时间：2013-04-16T16:43:23.683
> 
> 标签：r

我对 R 很陌生，我需要你的帮助来解决一个与非常耗时的过程相关的问题。

我有一个非常大的数据集，我正在尝试对其进行子集化以创建文件 dat。我编写的代码正在运行，但需要很长时间，而且我不知道如何让它更快。

这是我对数据集进行子集化的一段代码

```
df<-data.frame(a,b,c,d,e,f,g,h)

mylist <- list()

for(i in 1:(length(df$a))) {
  mylist[[i]] <- subset(df, a==df$a[i])   
  dep <- as.data.frame(mylist[i])
  SHYRMODY <- split(dep, data.frame(dep$a,dep$b, dep$c, dep$d), drop=TRUE)
  lapply(names(SHYRMODY),function(x, SHYRMODY)
    write.table(SHYRMODY[[x]],
                paste(x, ".dat", sep = ""),
                col.names=FALSE, 
                row.names=FALSE, 
                sep="\t",
                quote=FALSE),SHYRMODY)
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T18:10:20.143

像这样：

```
mylist    <- split(df, list(df$a, df$b, df$c, df$d), drop = TRUE)
filenames <- paste0(names(mylist), ".dat")

mapply(write.table, mylist, file = filenames,
      col.names = FALSE, row.names = FALSE, sep = "\t", quote = FALSE) 
```

该`drop = TRUE`选项是这样的，它不会为`(a,b,c,d)`没有数据的组合创建空文件。

# php - PHP邮件功能不工作..与客户端验证

> ID：16042533
> 
> 赞同：0
> 
> 时间：2013-04-16T16:43:42.120
> 
> 标签：php, jquery, email, validation, sendmail

不能让这 3 个脚本很好地发挥作用。试图让这个邮件功能正常工作并发送邮件。我已经删除了敏感信息并用通用术语替换了它。我还有另一个使用 preg_match 和其他验证方法的 php 邮件功能，但是它不起作用，所以我决定删除它直到它起作用，然后尝试再次添加验证服务器端..

我不太擅长 PHP，但我决定解决这个问题，所以任何帮助都将不胜感激。

我通常在我的 wamp 上测试所有这些，但有一个实时开发服务器 @marinetechegypt.com/contact.php/ 它可能不是最新的。

这是所有相关文件的内容。

**HTML 表单 (contact.php)**

```
 <div class="col one-half">
            <h3> Send us an Email </h3>
                <div class="ajax_message"></div>
                <form class="contact-form" method="post" action="php-mailer.php">
                    <input type="hidden" name="ac" value="login" />
                    <p>
                        <label for="fname"> Your Name <span class="required"> * </span> </label>
                        <input type="text" name="fname" class="input-short" id="fname" placeholder="Your Full Name" />
                        <?php if(isset($errName1)) echo $errName1; ?>
                    </p>
                    <p>
                        <label for="email"> Your Email <span class="required"> * </span> </label>
                        <input type="text" name="email" class="input-long" id="email" placeholder="Your Email" />
                        <?php if(isset($errEmail)) echo $errEmail; ?>
                    </p>
                    <p>
                        <label> Subject </label>
                        <input name="subject" type="text"  id="subject" class="input-short" placeholder="Subject"/>
                    </p>
                    <p>
                        <label for="message"> Your Message <span class="required"> * </span> </label>
                        <textarea name="message" class="textarea-message" id="textarea" placeholder="Your Message"></textarea>
                        <?php if(isset($errMessage)) echo $errMessage; ?>
                    </p>
                    <p><input name="submit" type="submit" value="Send Message" class="button small grey contact-submit" /></p> 
            </form>
            <div class="error-container" style="display:none;"> Please fill the above required fields correctly! </div>
        </div> 
```

**php-mailer.php 文件：**

```
<?php 
if(isset($_POST['submit'])) {
       $to = "RecipientEmailInbox";
       $subject = $_POST['subject'];
       $first_name_field = $_POST['fname'];
       $email_field = $_POST['email'];
       $message = $_POST['textarea'];
       $message = "
        Name: $first_name_field
        Email: $email_field
        Message: $message";
        $headers = 'MIME-Version: 1.0' . "\r\n";
        $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

        // Additional headers
    $headers .= 'To: <RecipientEmailInbox>' . "\r\n";
    $headers .= '[From] <SenderEmailInbox>' . "\r\n";

// Mail it
mail($to, $subject, $message, $headers);
include("OnCompleteURL");
ini_set("sendmail_from","EmailHeaderFrom");
ini_set("SMTP","SMTPAddress");
mail($to, $subject, $message, $headers);
         } else {
                 echo "Error phpmailer";
          }
?> 
```

**JS 客户端验证**

```
$(document).ready(function(){

$.validator.addMethod("notEqual", function(value, element, param) {
  return this.optional(element) || value != param;
}, "Please choose a value!");

$(".contact-form").each(function(){
    $container = $(this).next("div.error-container");
    //Validate Starts
    $(this).validate({
        onfocusout: function(element) { $(element).valid(); },
        errorContainer: $container,
        rules:{
          fname:{required:true,minlength:3,notEqual:'Your Full Name'},
          email:{required:true,email:true,notEqual:'Your Email'},
          subject:{notEqual:'Subject'},
          message:{notEqual:'Your Message'}

          ,message:{required:true,minlength:10}
        }
    });//Validate End

    //Submit Starts        
    $(this).submit(function(e){
        $frm = $(this);
        $name = $frm.find('*[name=fname]').val();
        $email = $frm.find('*[name=email]').val();
        $subject = $frm.find('*[name=subject]').val();
        $message = $frm.find('*[name=message]').val();

        if($frm.find('*[name=fname]').is('.valid') && $frm.find('*[name=email]').is('.valid')) {
            var action = $frm.attr('action');
            $frm.find('*[name=submit]').attr('disabled', 'disabled').after('');

            $frm.prev(".ajax_message").slideUp(750, function () {
                $ajax_container = $(this);
                $ajax_container.hide();

                $.post(action, {
                    name: $name,
                    email: $email,
                    subject: $subject,
                    message: $message
                    }, function (data) {
                        $ajax_container.html(data);
                        $ajax_container.slideDown('slow');
                        $frm.find('*[name=submit]').attr('disabled', '');
                        if (data.match('success') != null) $frm.slideUp('slow');
                    });
                });
        }
    e.preventDefault(); 
    }); 
}); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:49:12.693

您实际上并没有对 ini_set 函数做任何事情，您需要将有效的电子邮件和有效数据放入其中：

```
ini_set('SMTP' , 'smtp.yoursite.com');
ini_set('smtp_port' , '25');
ini_set('username' , 'example@example.com');
ini_set('password' , 'password');
ini_set('sendmail_from' , 'example@example.com'); 
```

此外，在设置这些设置之前发送电子邮件也没有任何意义。

您实际上是在设置之前和之后两次发送邮件。定义设置，然后发送电子邮件。

顺便一提，

```
this
won't
get a new line 
```

您必须将 \n 添加到文本中，除非您使用可以处理此操作的包装器。

# android - Android 2.2 MediaPlayer 替代 HTTPS 和直播

> ID：16042534
> 
> 赞同：4
> 
> 时间：2013-04-16T16:43:42.110
> 
> 标签：android, android-mediaplayer, android-networking

我创建了一个使用的服务`android.media.MediaPlayer`，它适用于 3.1+ 设备，并且正如预期的那样，它不能完全适用于较旧的 android 版本，因为[不支持 HTTPS 和实时流](http://developer.android.com/guide/appendix/media-formats.html)。本地文件没有问题。

我想做的是`android.media.MediaPlayer`用于 3.1+ 设备，我必须为其他设备创建一个替代方案（基础 SDK 是 8，Android 2.2）。

我发现了一篇有点有用的[文章](http://blog.pocketjourney.com/2008/04/04/tutorial-custom-media-streaming-for-androids-mediaplayer/)，我猜它不适用于直播（因为它将数据记录到文件中），我不确定它是否是 HTTPS 渐进式流媒体的好方法。

我想使用大小有限的内存缓冲区；加载内容的缓存和寻找位置的能力根本不如开始播放的能力重要。不幸的是，我无法找到关于内存缓冲`android.media.MediaPlayer`或任何`android.media.MediaPlayer`其自身的本机替代方案的信息。

所以问题是，是否有任何替代方案来`android.media.MediaPlayer`支持低级数据源（如流或缓冲区）或 HTTPS 和实时流的任何其他解决方法？如果 SDK 8+ 中没有这样的东西，那么也许有一个开源项目要分叉。

* * *

有一点类似的问题[android mediaplayer alternative?](https://stackoverflow.com/questions/13946088/android-mediaplayer-alternative) ，它要求我不需要的功能并且不要求我需要的功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-07T14:19:35.247

我不知道你是否还在寻找一种方法来做到这一点，但我猜本地代理服务器会解决你的问题。请参阅我的答案[here](https://stackoverflow.com/questions/12701249/getting-access-to-media-player-cache/18627606#18627606)了解一下。当然，正如您所指出的，您应该禁用任何搜索/特技播放功能，除非您打算通过代理实现它。您应该能够实现服务器，以便`MediaPlayer`只看到 HTTP 内容。那个时候应该问题不大。

# android - greendao 按相关表中的字段排序

> ID：16042535
> 
> 赞同：6
> 
> 时间：2013-04-16T16:43:46.217
> 
> 标签：android, greendao

有没有办法用greenDao按相关表中的字段排序？例如，我有一张汽车表和一张司机表。每辆车都有一名司机。现在我想查询（例如蓝色）汽车并按司机姓名排序

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T13:45:10.840

在 QueryBuilder 中，有一些方法可以指定排序顺序。查找以“order...”开头的方法，例如 orderAsc(Property)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-18T22:27:32.903

我现在也在玩 GreenDao，希望我对第一个答案中的评论和[greenDao 文档的查询部分中的](http://greendao-orm.com/documentation/queries/)描述有所帮助。

以下代码段应该可以工作（没有测试它:)）：

```
Query query = carsDao.queryRawCreate(   ", driver D WHERE T.COLOR='blue' AND T.DRIVER_ID=D._ID ORDER BY D.NAME ASC"); 
```

这在内部创建了一个与此类似的 SQL：

```
SELECT T.'id', T.'name', T.'color', T.'driver_id'
FROM cars T, driver D
WHERE T.COLOR='blue'
AND T.DRIVER_ID=D._ID
ORDER BY D.NAME ASC 
```

该语句的第一部分是由 queryRawCreate 方法为您创建的，其余部分是传递给的自定义 sql 语句`queryRawCreate`。

如果您想知道 JOIN 语句在哪里，请参阅[此问题。](https://stackoverflow.com/questions/1018822/inner-join-on-vs-where-clause)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-25T15:08:27.790

您可以将 QueryBuilders 与 Greendao ORM 生成的（数据访问对象）DAO 一起使用。

使用前定义（在活动中）

```
 ProductDao productDao;
 DaoSession daoSession; 
```

您应该将 DaoMaster 和 DaoSession 放在您的应用程序范围内。在扩展 Application 的类的 onCreate() 内部。

```
DaoMaster.DevOpenHelper helper = new DaoMaster.DevOpenHelper(getApplicationContext(), "app-db", null);
SQLiteDatabase db = helper.getWritableDatabase();
daoSession = new DaoMaster(db).newSession(); 
```

使用前初始化

```
 daoSession = ((MyApplication) getApplication()).getDaoSession();
 productDao = daoSession.getProductDao(); 
```

您可以像这样对结果进行排序以显示在活动中。

```
private void refreshProducts() {
        switch (sorted_by){
            case SORT_BY_DATE:
                cardItems = productDao.queryBuilder().orderAsc(ProductDao.Properties.Id).list();
                setupRecyclerView();
                break;

            case SORT_BY_PRICE:
                cardItems = productDao.queryBuilder().orderDesc(ProductDao.Properties.Price).list();
                setupRecyclerView();
                break;

            case SORT_BY_POPULARITY:
                cardItems = productDao.queryBuilder().orderDesc(ProductDao.Properties.Name).list();
                setupRecyclerView();
                break;
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-06T07:53:00.477

使用 QueryBuilder.orderRaw() 和 Join.getTablePrefix() 的简单解决方案

我的示例代码：

```
QueryBuilder.LOG_SQL = true;//Enable to see SQL result

  QueryBuilder<Item> query = daoSession.queryBuilder(Item.class);
  Join itemWithCollection = query.join(JoinItemWithCollection.class,
      JoinItemWithCollectionDao.Properties.ItemId);
  String joinedTable = itemWithCollection.getTablePrefix();
  Join collection = query.join(itemWithCollection, JoinItemWithCollectionDao.Properties.CollectionId,
      Collection.class, CollectionDao.Properties.Id);
  String orderCol = JoinItemWithCollectionDao.Properties.SomeOrderCol.columnName;
  collection.where(CollectionDao.Properties.Key.eq(collectionId));
  query.orderRaw(joinedTable+".\""+orderCol+"\" DESC");
  query.limit(limit);
  query.offset(from);

  List<Item> results = query.list(); 
```

# linux - 尝试创建一个带有 2 个菜单的 shell 脚本来做加法和减法

> ID：16042536
> 
> 赞同：0
> 
> 时间：2013-04-16T16:43:48.227
> 
> 标签：linux, shell, ubuntu, menu

这就是我到目前为止所拥有的。我真的不知道如何从另一个函数调用 Menu2。每当我尝试运行它时，我总是会遇到错误。同样由于第一个菜单中的某些原因，我需要在它实际退出之前输入两次“X”。还有一件事，在计算完成后，由于某种原因，当我需要它返回菜单时，它会返回菜单 2。

*编辑* 如果我用“Menu2”替换cpick（）中的“break”，它永远不会执行Menu2。它循环回到菜单。抱歉，我遇到的错误是因为我不确定如何在函数中调用函数。我正在尝试“Menu2()”而不是菜单。

*编辑 2*问题#1：“*****”只是为了隐藏我的名字:) 问题#2：谢谢你的工作！问题#3：我不太明白你在暗示什么... :S 问题#4：我目前拥有的方式似乎按照我想要的方式工作，所以我要改变它，它只是美学:P

计算完成后，我仍然无法弄清楚如何返回菜单。我无法在我的 apick() 中调用菜单函数。我想要它做的是在计算完成后返回菜单，而不是返回菜单 2。

```
#!/bin/sh
LOGO=" Shell Scripting - Created by *****"

cmenu="C)  Calculation";
xmenu="X)  Exit";
amenu="+)  Add";
smenu="-)  Substract";

badchoice () { MSG="Invalid Selection ... Please Try Again" ;} 

cpick () { clear
           read -p "Please enter an integer number or X to exit: " num1 
           clear
           break
           echo; }
apick () { clear
           read -p "Please enter an integer number or X to exit: " num2
           sum=$(($num1+$num2))
           echo The sum of $num1 plus $num2 equals $sum
           sleep 3;}
spick () { clear
           read -p "Please enter an integer number or X to exit: " num2
           diff=$(($num1-$num2))
           echo The difference of $num1 minus $num2 equals $diff
           sleep 3;}
xpick () { break;} 

Menu() {
 clear
 echo `date`
 echo
 echo "\t" $LOGO
 echo
 echo "Please Select:"
 echo
 echo "\t" $cmenu
 echo "\t" $xmenu
 echo $MSG
 echo Please choose a letter above then hit Enter;
  }

Menu2() {
clear
echo `date`
echo 
echo "Please Select:"
echo
echo "\t" $amenu
echo "\t" $smenu
echo "\t" $xmenu
echo $MSG
echo Please choose an option above then hit Enter; 
}

 while  true
 do

  Menu
   read answer

   MSG=

   case $answer in
       c|C) cpick;;
       x|X) break;;
       *) badchoice;;

   esac
done 

 while true
 do

 Menu2
   read answer

   MSG=

   case $answer in
       +) apick;;
       -) spick;;
       x|X) xpick;;
       *) badchoice;;

   esac
done 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:21:58.393

问题#1：LOGO 包含一个`*`字符。您应该在周围添加双引号。例子：

```
X="*"
echo $X
echo "$X" 
```

输出：

```
file1 file2 ...
* 
```

问题2：第一次`case`使用`exit`if`x`输入，

问题#3：`break`在 shell 函数中定义不会打破这种情况。`break`明确输入`case`。

问题#4。在linux中`echo "\t"`打印。`\t`进入`echo -e "\t"`打印标签。

然后它会工作......

# java - 查找字符串但如果它是另一个字符串的一部分则排除

> ID：16042545
> 
> 赞同：2
> 
> 时间：2013-04-16T16:44:09.150
> 
> 标签：java, regex

有以下字符串：

```
text TOKEN text TOKEN text <elem attr="text TOKEN text">text TOKEN text TOKEN</elem> text TOKEN text 
```

需要一个正则表达式，它将给我所有 TOKEN 但不在任何 elem 元素的任何部分

编辑：我确实有 RegEx 来收集所有元素元素。

```
<elem(.*?)>(.*?)</elem> 
```

我无法弄清楚如何从 RegEx 中排除这些以找到 TOKEN

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:43:51.633

`"TOKEN"`当`"</elem>"`出现在`"<elem"`字符串的前面时，以下内容将不匹配。

```
"TOKEN(?!(?:(?!<elem).)*</elem>)" 
```

如果字符串可能包含换行符，请添加`Pattern.DOTALL`标志。

应要求提供进一步解释。

# multithreading - 在 Visual C++ 2012 中并行化我的循环的有效方法是什么？哪个头文件：ppl.h， , 等使用？

> ID：16042546
> 
> 赞同：1
> 
> 时间：2013-04-16T16:44:17.020
> 
> 标签：multithreading, performance, visual-c++, c++11, parallel-processing

我是 C++ 编程和 Stackoverflow 方面的初学者，我需要让我的 BlackJack 赔率模拟器运行得更快，它使用 1 个内核和 25% 的 i5 CPU，运行速度更快 - 最好快 3-4 倍。我对并行化循环的所有不同方式感到不知所措，该程序的 CPU 最密集功能中的最外层循环一直运行良好，尽管速度很慢，但没有并行化。我在 Microsoft Visual Studio 2012 上运行我的程序，我尝试了由并发库提供的并行化 for 循环，但是当我测试它时，任务管理器显示，它并没有像我想要的那样获得 4 个线程和 100% 的 cpu 使用率该进程在不同数量的线程和不同数量的 CPU 使用情况下进行混洗，并且它的执行速度没有我想要的那么快。[http://msdn.microsoft.com/en-us/library/hh872235.aspx](http://msdn.microsoft.com/en-us/library/hh872235.aspx)），但是有很多限制（没有条件语句、函数调用、创建和分配变量、循环中间的增量等）阻止我使用它，所以我决定它可能不适用于我非常复杂的循环。尽管使用 Microsoft 的 #pragma loop(hint_parallel(0)) 自动并行化功能非常快，但从程序开始就自动创建了 4 个线程，每个内核一个，并且始终使用 100% 的 CPU 使用率，这是我认为最理想的——我认为它不适合我的任务。

我的程序中的每个模拟或循环都完全独立于其余部分，因为模拟结果所基于的所有变量 - 牌组中的卡片数量、2 的数量、3 的数量等 - 在模拟运行的结束，就像它们在模拟运行的开始时一样（如果每个变量和向量都没有完全按原样放回原样，则断言语句将关闭）。从最外层循环的一次迭代到下一次迭代的唯一变量是双重“预期结果”或“平均值”，出于我的目的，我想我想要每个元素（10个元素，1个用于绘制每种类型的卡片在 BlackJack 中，值 2 到 11）在最外层循环中具有自己的“预期结果” 变量或预期结果变量是由不同线程修改的原子双精度。在模拟结束时，如果有 10 个不同的线程本地“预期结果”变量，对于最初通过 ace 绘制价值 2 的牌，我希望将“预期结果”变量返回到 main 并与其他“预期结果”组合” 变量来获得最终结果 - 你的“房子边缘”。

那么我应该如何处理多线程呢？如果您处于我的位置，您会使用哪个库（库）？我可以让1个线程在循环中取第一个值，第二个线程取第二个，第三个线程取第三个，第四个线程取第四个，然后让线程#1取for循环中的第五个值循环的第一次迭代完成了吗？我应该使用固定数量的线程还是线程池（我还没有完全理解“线程池”之类的概念）？我应该制作单独的线程局部变量（expected_outcome_1、expected_outcome_2）还是应该使用带锁的东西？尽管它很复杂，但我可以在我的函数中进行自动并行化吗？

最后一件小事。我的这个程序的原始版本是递归的，其中有一个函数，经销商 Draws_Card，如果dealerScore < hard17 (|| soft16)，递归 Draw_Card。递归的好处是代码比使用一堆循环更紧凑，尽管它可能更慢。我还发现捕获和修复堆栈中间的错误比嵌套循环中间的错误更难。并且循环永远不会意外地进入超深或无限递归。但是如果我想让人们阅读我的代码，大概有 15 个嵌套循环可能不会很好，所以为了清楚起见，我可能想让它尾递归，然后将递归调用优化为循环。并行化（或自动并行化）尾递归函数是否容易，就像并行化“for”一样容易？环形？因为如果是这样，我希望一起摆脱嵌套循环。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:17:06.113

我有一个主意。假设自动矢量化将是循环的（每个线程需要 1 次循环迭代）。制作一个预期值数组，其中 10 次迭代中的每一次都写入数组中的位置，i=0 到 9。在自动矢量化循环完成后，平均数组 [0] 到数组 [9 中的 10 个值] 一起得到结果。

检查依赖性，然后让自动矢量化器通过提示完成其工作，然后在编译器抱怨时使用 ivdep 强制并行化。

并且忘记自动矢量化 - 因为如果只需要初始化数组值然后在循环完成并摆脱theads之后保持不使用，则无需将数组值放入寄存器。无论如何，如果我包含“if”语句，它就很挑剔并且不起作用。

没有库，或者手动将循环拆分为必要的线程。并且没有图形卡计算使用（还）。

# cocos2d-iphone - 从“CCTextureCache”创建一个 CCSprite

> ID：16042548
> 
> 赞同：0
> 
> 时间：2013-04-16T16:44:21.630
> 
> 标签：cocos2d-iphone

所以我将我的大部分资源预加载到 中`CCTextureCache`，我想知道如何从`CCTextureCache`. 我知道一般来说我通常只做`CCSprite spriteWithFile` 但是我不知道一旦它们被缓存后如何访问我的纹理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:55:10.507

出色地

```
CCSprite *spr = [CCSprite spriteWithFile:@"theSprite.png"]; 
```

实际上将纹理以文件名作为键放入缓存中。

所以

```
CCTexture2D * tex = [CCTextureCache sharedTextureCache:textureForKey:@"theSprite.png"]; 
```

实际上会给你返回精灵的纹理。

最后一点：在将纹理放入缓存之前，CCSprite 构造函数验证缓存是否已经包含带有密钥的纹理。如果是这样，它会跳过一大堆步骤并返回使用缓存纹理构造的精灵。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:58:20.023

尝试这个：

```
CCTexture2D *pText = [CCTextureCache sharedTextureCache:textureForKey: @"(your picture filename)"];

CCSprite *pSprite = [CCSprite spriteWithTexture: pText]; 
```

在此处阅读参考资料（您可以从参考资料中获得几乎所有您想要的内容）：

[http://www.cocos2d-iphone.org/api-ref/latest-stable/interface_c_c_sprite.html](http://www.cocos2d-iphone.org/api-ref/latest-stable/interface_c_c_sprite.html)

# java - 在 Vector 的开头插入一个元素

> ID：16042550
> 
> 赞同：1
> 
> 时间：2013-04-16T16:44:28.390
> 
> 标签：java, performance, collections, vector

我正在实现一个 Android 应用程序，它从 web 服务接收字符串的 json 数组。这个数组可能非常大（超过 500 个条目）。我正在将此数据解析为 Vector 对象。在应用程序中，用户可以将字符串添加到此向量中，但字符串必须添加到它的开头。

现在我正在做以下事情来实现它：

```
Collections.reverse(myVector);
myVector.add(newString);
Collections.reverse(myVector); 
```

有没有其他更便宜的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T16:46:45.757

你可以用 a[`java.util.LinkedList`](http://developer.android.com/reference/java/util/LinkedList.html)代替吗？然后你可以使用`addFirst`，因为它是一个双向链表，它应该更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:48:55.757

您可以使用该[`Vector#add(index, element)`](http://docs.oracle.com/javase/7/docs/api/java/util/Vector.html#add%28int,&20E%29)方法。但是，它仍然会产生每次向下移动元素的成本。

但是，为了尽可能避免成本，然后`Collections.reverse`在开始时使用，然后*保持*反转，让用户添加字符串，直到完成。添加到末尾（附加）不需要将现有元素移开。完成后，再将其反转一次以获得正确的顺序。总逆转——只有 2 次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T16:46:54.193

为什么我们不能使用 Vector.add(index,element) api，索引为 1？

还是我错过了什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T16:47:47.453

一种更快的方法是直接在向量的开头插入，使用[.add(int, E)](http://docs.oracle.com/javase/6/docs/api/java/util/Vector.html#add%28int,%20E%29) ...

```
myVector.add(0, newString); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T16:49:22.777

你必须使用向量吗？如果你使用 ArrayList 你可以在前面插入元素 `list.add(0, element)`

# c++ - OpenCV - FLANN算法没有获得足够的匹配点

> ID：16042554
> 
> 赞同：0
> 
> 时间：2013-04-16T16:44:51.473
> 
> 标签：c++, opencv, surf

我是计算机视觉的新手。我正在使用这个算法[http://docs.opencv.org/doc/tutorials/features2d/feature_flann_matcher/feature_flann_matcher.html](http://docs.opencv.org/doc/tutorials/features2d/feature_flann_matcher/feature_flann_matcher.html)由 Open CV 提出，以便在对拍摄图像的相机进行旋转平移后计算同一环境的 2 个场景（城市的鸟瞰图）之间的一些匹配点。相机和环境都是模拟的（因此没有亮度变化，没有失真等）显然帧速率足够高，可以使图像大部分重叠。之后，我必须使用这一点来计算描述相机所做运动的仿射变换矩阵（拍摄图像的高度不会随时间变化）。因此，对于每几张图像，我需要至少 2 个匹配点。我的问题是匹配点通常少于 3 个。是否存在一些更适合我的目的的稳健方法？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T07:43:27.413

我相信您给出的示例中实现的过滤非常幼稚。假设你得到了一个非常高的匹配（关于描述符之间的距离），那么`min_dist`它非常小并且可能会过滤掉好的匹配。换句话说，得分最高的匹配不一定是几何上最好的（两个特征可能看起来非常相似，但不是真实世界的对应）......

你可以尝试做的是：

*   删除过滤实现；保留所有比赛
*   使用计算单应矩阵`findHomography()`
    *   `findHomography()`允许您使用 a`mask`来跟踪内点
*   仅绘制标记为 inliers 的匹配项`mask`

这应该是一个更好的验证。

# c++ - x64 堆栈展开并检查 RIP 是否在 Epilog 中

> ID：16042558
> 
> 赞同：1
> 
> 时间：2013-04-16T16:45:05.300
> 
> 标签：c++, 64-bit, stack-unwinding

我想展开 x64 调用堆栈，所以我试图遵循我在这里找到的“UNWIND 过程”：http:
[//msdn.microsoft.com/en-us/library/8ydc79k6.aspx](http://msdn.microsoft.com/en-us/library/8ydc79k6.aspx)

我知道如果 RIP 在结语中，我们需要计算 RSP 的偏移量，考虑到仍然需要完成的操作，但我不清楚如何确定 RIP 是否在结语中（在第3.a)?
有人可以向我解释一下吗？（链接或代码示例也将不胜感激）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-08T16:28:25.850

从[放松程序](http://msdn.microsoft.com/en-us/library/8ydc79k6%28v=vs.80%29.aspx)

> 为了确定 RIP 是否在 Epilog 中，检查从 RIP 开始的代码流。如果该代码流可以匹配到合法 Epilog 的尾随部分，如 CNDJ6nn5us4RjIIAqgBLqQsCAAAACAAAAAA4AAABfAFIAZQBmADQAOQA2ADAAOQAyADQAMgA1AAAA REF _Ref496092425 \r \h 0 部分所述，那么它在 Epilog 中，并且 Epilog 的剩余部分被模拟，带有上下文记录在处理每条指令时更新

，以及来自[Prolog 和 Epilog](http://msdn.microsoft.com/en-US/library/tawsa7cb%28v=vs.80%29.aspx)（我推荐整篇文章以便更好地理解）

> 这些是结语的唯一合法形式。它必须由 add RSP,constant 或 lea RSP,constant[FPReg] 组成，后跟一系列零个或多个 8 字节寄存器 pop 和 return 或 jmp。（结语中只允许使用 jmp 语句的子集。[...]）。不能出现其他代码。特别是，不能在 Epilog 中安排任何内容，包括加载返回值。
> 
> 请注意，当不使用帧指针时，epilog 必须使用 add RSP,constant 来释放堆栈的固定部分。它可能不使用 lea RSP,constant[RSP] 代替。存在此限制，因此展开代码在搜索 Epilog 时识别的模式更少。

似乎如果代码发现自己处于这种情况下，它只会检查当前执行的代码以查找那些特定的指令，如果匹配，则认为自己在结语中。

# android - 调用 isFinishing() 或按下后退按钮？

> ID：16042562
> 
> 赞同：1
> 
> 时间：2013-04-16T16:45:21.050
> 
> 标签：disklrucache, lrucache, backpressed, android

我想清除从服务器下载照片并使用[disklrucache](/questions/tagged/disklrucache "显示标记为“disklrucache”的问题")和[lrucache](/questions/tagged/lrucache "显示标记为“lrucache”的问题")存储它们的活动缓存，我的活动将处于活动状态。我希望当用户离开此活动时清除缓存。那么我该如何处理呢？在 onPause 中检查 isFinishing() 的状态是否是一个好的解决方案，或者我应该覆盖[backpressed](/questions/tagged/backpressed "显示标记为“回压”的问题")。我知道当用户按下后退按钮时，不确定是否会调用 isfinishing ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:59:23.490

这取决于您希望应用程序的行为方式。

如果您想在活动完成时清除缓存并且现在将它们存储在 onCreate 中

```
public void onDestroy(){
    super.onDestroy();
    // clear your cache
} 
```

但是，如果您想在用户离开活动时清除缓存，这意味着当活动暂停时，您应该在`onPause`方法中清除缓存。但是那时您必须将数据存储在`onResume`方法中。我认为在后台释放活动内存也是一个更好的选择。

**编辑：**

来自onKeyDown的源码

```
public boolean onKeyDown(int keyCode, KeyEvent event)  {
1801        if (keyCode == KeyEvent.KEYCODE_BACK) {
1802            if (getApplicationInfo().targetSdkVersion
1803                    >= Build.VERSION_CODES.ECLAIR) {
1804                event.startTracking();
1805            } else {
1806                onBackPressed();
1807            }
1808            return true;
1809        } 
```

因此，您可以看到如果按下后退按钮，则调用 onBackPressed。所以我认为因为你只需要后退按钮处理所以更好地覆盖 onBackPressed 方法

# c# - PRISM - 为每个交互请求创建一个新的对话实例 -

> ID：16042564
> 
> 赞同：0
> 
> 时间：2013-04-16T16:45:24.100
> 
> 标签：c#, wpf, prism

我面临一个问题：

如果我对对话框执行第一个请求并将其添加到 Grid.Children ......有时我必须在这个激活的对话框中调用另一个对话框，在这种情况下，传递相同的实例抛出操作，并且应用程序尝试再次将相同的实例添加到 GRID 子项中......我得到了一个例外。

对于我在视图模型中执行的每个请求，我想创建一个“views:DialogControl”的新实例，我该如何完成这个？

关注我的观点互动：

```
 <i:Interaction.Triggers>
        <prism:InteractionRequestTrigger SourceObject="{Binding Path=NotificationToDialog}">
            <views:MessageAction>
                <views:MessageAction.Dialog>
                    <views:DialogControl />
                </views:MessageAction.Dialog>
            </views:MessageAction>
        </prism:InteractionRequestTrigger>
    </i:Interaction.Triggers> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T10:59:37.160

`Type`是什么`MessageAction.Dialog`？如果您`ContentControl`为每个显示对话框请求创建一个作为对话框元素，然后不将`DialogControl`模型的具体实例传递`ContentTemplate`给您刚刚创建的`ContentControl`.

这将使您的操作保持通用性，并为每个请求创建一个新实例。`Type`of`MessageAction.DialogTemplate`可以是例如`DataTemplate`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T10:47:40.693

您可以传递一个用于创建对话框的工厂，而不是对话框本身的实例。即你实现了一个`MessageAction.DialogFactory`属性，而不是`MessageAction.Dialog`. 然后在您的 (modified)`MessageAction`中，您可以在触发时从工厂创建一个全新的对话框。

但是，如果您只是将新对话框塞进父网格中（例如禁用其他对话框等），您可能会遇到其他问题。在操作中将交互请求排队可能会更好。

# php - 如何将保存的 localStorage Web 数据传递给 php 脚本？

> ID：16042565
> 
> 赞同：2
> 
> 时间：2013-04-16T16:45:24.220
> 
> 标签：php, javascript, mysql, google-maps, google-maps-api-3

好的，所以我在尝试找出如何将我保存在 localStorage 中的一些数据传递给我编写的 php 脚本时遇到了一些问题，这样我就可以将其发送到服务器上的数据库。我之前确实找到了一些代码（[https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest)），看起来它可以工作，但我没有运气。

这是我保存数据的代码，而不是试图通过我的 phpscript 传递它

```
function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(initialize, showError, takeSnap);
        }
        else {
            alert("Geolocation is not supported by this browser.");
        }
    }

function initialize(position) {
        var lat = position.coords.latitude,
            lon = position.coords.longitude;

        var mapOptions = {
            center: new google.maps.LatLng(lat, lon),
            zoom: 14,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: true
        }

        var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
        var marker = new google.maps.Marker({
            position: new google.maps.LatLng(lat, lon),
            map: map,
            title: "Current Location"
        });
    }

function showError(error) {
        switch (error.code) {
            case error.PERMISSION_DENIED:
                alert("User denied the request for Geolocation.");
                break;
            case error.POSITION_UNAVAILABLE:
                alert("Location information is unavailable.");
                break;
            case error.TIMEOUT:
                alert("The request to get user location timed out.");
                break;
            case error.UNKNOWN_ERROR:
                alert("An unkown error occurred.");
                break;
        }
    }

function storeLocal(position) {
        if (typeof (Storage) !== "undefined") {
            var lat = position.coords.latitude,
                lon = position.coords.longitude;

            localStorage.latitude = lat;
            localStorage.longitude = lon;
        }
        else {
            alert("Your Browser doesn't support web storage");
        }

        return
    }

    function snapShot() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(storeLocal, showError);
        }
        else {
            alert("Geolocation is not supported by this browser.");
        }

        var oReq = new XMLHttpRequest();
        oReq.onload = reqListener;
        oReq.open("post", "snap.php?lat=" + localStorage.latitude + "&lon=" + localStorage.longitude, true);
        oReq.send();            
    }

    function reqListener() {
        console.log(this.reponseText);
    } 
```

这是我编写的将值保存到数据库中的脚本

```
 <?php
    // Connecting to the database
    mysql_connect("localhost", "username", "password");
    mysql_select_db("db_name");

    $latitude = mysql_real_escape_string($_GET["lat"]);
    $longitude = mysql_real_escape_string($_GET["lon"]);

    // Submit query to insert new data
    $sql = "INSERT INTO locationsTbl(locID, lat, lon ) VALUES( 'NULL', '". $latitude ."', '". $longitude . "')";
    $result = mysql_query( $sql );

    // Inform user
    echo "<script>alert('Location saved.');</script>";

    // Close connection
    mysql_close();
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:53:32.183

怎么样：

```
oReq.open("get", "snap.php?lat=" + localStorage.latitude + "&lon=?" + localStorage.longitude, true); 
```

（你也有`localStorage.lon`代替`.longitude`）

由于值（字符串）在变量中，因此您需要将它们连接起来，而不是将它们放在字符串中。

此外，由于您似乎将这些东西传递给您的 PHP 以保存到数据库，从语义上讲，您应该使用 POST 请求......这与 AJAX 请求的处理方式不同。

在您的 PHP 中，您需要使用：

```
$latitude = $_GET["lat"];
$longitude = $_GET["lon"]; 
```

实际获取随 GET 请求发送的值。尽管应该对这些值进行转义以避免 SQL 注入。

另外，我不确定您为什么要设置`onload`AJAX 请求的属性。相反，使用`onreadystatechange`属性...类似：

```
oReq.onreadystatechange = function () {
    if (oReq.readyState === 4) {
        if (oReq.status > 199 && oReq.status < 400) {
            console.log("successful response");
        } else {
            console.log("failed response: " + oReq.status);
        }
    }
}; 
```

该`.readyState`属性是指它的状态，这`4`意味着它已完成（响应已返回）。该`.status`属性是指 HTTP 状态代码。通常在`200`&之间`400`是好的。我知道我见过人们**只**检查`200`（不是范围）。

**更新：**

为了在请求中传递 POST 参数，您不要将它们附加到 URL - 您在`.send()`方法中传递它们。这是您的代码示例：

```
oReq.open("POST", "snap.php", true);
oReq.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
oReq.send("lat=" + encodeURIComponent(localStorage.latitude) + "&lon=" + encodeURIComponent(localStorage.longitude)); 
```

要在 PHP 中检索它们，您可以使用：

```
$latitude = $_POST["lat"];
$longitude = $_POST["lon"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:53:46.090

你有代码错误

它应该是 oReq.onload = reqListener; oReq.open("get", "snap.php?lat="+localStorage.latitude+"&lon="+localStorage.lon, true); oReq.send();

# c# - C#中的多个游标

> ID：16042573
> 
> 赞同：1
> 
> 时间：2013-04-16T16:45:48.793
> 
> 标签：c#, cursor

我在一个 OpenSim 项目中工作，但遇到了一些麻烦。

我有一个 HMD 可以为用户的视图工作，还有一个带有跟踪器的手套来移动物体，问题是它们都被视为鼠标移动，所以当我移动手套时，看起来我在移动我的头。

我认为我可以制作两个光标，一个用于 HMD，另一个用于手套，但我找不到这样做的方法。

所以我希望你能帮助找到一种方法。（有 2 个光标）

我已经尝试过使用 Windows 的 SDK，但是没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T20:11:21.810

我的朋友在他的博客上写了一篇文章，解释了如何做到这一点。它有点长，所以我不能在这里粘贴整个文本。

[http://www.asawicki.info/news_1533_handling_multiple_mice_with_raw_input.html](http://www.asawicki.info/news_1533_handling_multiple_mice_with_raw_input.html)

# javascript - 微风立即自动保存

> ID：16042574
> 
> 赞同：1
> 
> 时间：2013-04-16T16:45:51.333
> 
> 标签：javascript, knockout.js, breeze

我正在使用 Knockout 和 Breadjs 实现一个表单，我想在用户更改焦点时保存每个字段。因此，每次更改都意味着对服务器的一次保存调用。问题是，如果用户在上一次保存调用完成时进行了一些更改，那么在第一次调用中未包含的更改将在服务器响应时恢复到其原始值。

这是我的经理的配置：

```
var manager = new breeze.EntityManager({
    serviceName : "/api/UserCentre/",
    saveOptions: new breeze.SaveOptions({allowConcurrentSaves: true})
});
manager.enableSaveQueuing(true); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:38:22.800

删除`saveOptions`，你会没事的。“SaveQueuing”`allowConcurrentSaves`是相互竞争的方法。

我强烈反对使用它，`allowConcurrentSaves`因为它会导致不稳定的数据库插入和更新。这就是为什么它默认为`false`. 这确实是一个我从未感到舒服的高级功能。

“SaveQueuing”是专为您的场景设计的插件。它作为示例的一部分作为单独的 JS 文件 ( *breeze.savequeuing.js* ) 提供。它将客户端应用程序保存请求排队，确保每个请求仅在前一个请求完成后发出。无论如何，它都不是万无一失的。它们是可能绊倒你的边缘条件。但这是我们发现的用于经常自动保存的最佳方法。

# mongodb - MongoDB 中的命令数量增加

> ID：16042581
> 
> 赞同：1
> 
> 时间：2013-04-16T16:46:11.117
> 
> 标签：mongodb

访问者数量的增加会导致在 MongoDB 上发出的命令数量增加。这使得数据库变慢并且整个系统无法使用。Mongostat 在那些高峰时期看起来像这样：

```
insert  query update delete getmore command flushes mapped  vsize    res faults locked % idx miss %     qr|qw   ar|aw  netIn netOut  conn       time
 0    266      0      0       3      19       0  58.7g   119g    13g      2        0          0       0|0     0|0    47k     1m   167   14:24:30
 0    308      4      0       0       8       0  58.7g   119g    13g      5      0.7          0       0|0     0|0    54k   880k   167   14:24:31
 0    177      3      0       0      34       0  58.7g   119g    13g      0      0.5          0       0|0     0|0    49k   559k   173   14:24:32
 0     73      2      0       0       8       0  58.7g   119g    13g      0      0.3          0       0|0     0|0    21k   288k   174   14:24:33
 0    201      5      0       0      27       0  58.7g   119g    13g      2      0.5          0       0|0     1|0    51k   639k   167   14:24:34
 0    232      4      0       0       9       0  58.7g   119g    13g      1      0.3          0       0|0     0|0    44k   456k   167   14:24:35
 0    102      2      0       0     109       0  58.7g   119g  13.1g      0      0.3          0       0|0     0|0    33k   269k   193   14:24:36
 0    265      3      0       0     103       0  58.7g   119g  13.1g      0      0.5          0       0|0     0|0    76k   714k   178   14:24:37
 1    277      4      0       0      16       0  58.7g   119g  13.1g      2      0.5          0       0|0     0|0    71k   501k   180   14:24:38
 0    237      3      0       0      92       0  58.7g   119g  13.1g      0      0.4          0       0|0     0|0    54k   670k   201   14:24:39 
```

问题是：我在我的代码中找不到这些命令的来源。我尝试打开完整的分析（记录所有查询），但找不到任何这些命令。我看到一些，但每秒只有几个，通常的东西。有时几分钟内每秒有 100-200 个命令，但我在日志和分析器中看到的只是身份验证命令（这是 php 脚本在超时后重新连接）。

如何调试此问题并找到太多命令的来源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:11:34.730

命令可以是[很多东西](http://docs.mongodb.org/manual/reference/command/)，包括 getLastError()、count()、分片或复制相关的命令。大多数命令（例如 count）不应该真正影响性能。其他人喜欢 group 或 distinct 可能会。但是它们应该出现在您已经提到的[分析器日志中。](http://docs.mongodb.org/manual/tutorial/manage-the-database-profiler/)mongostat 输出中的查询数量不是很令人印象深刻。如果每个查询都被索引，MongoDB 处理它们应该不会有任何问题。您确定问题真的是数据库而不是您的应用程序代码或其他正在运行的进程吗？

# javascript - 如何在启用拖放的 div 中启用鼠标拖动

> ID：16042583
> 
> 赞同：1
> 
> 时间：2013-04-16T16:46:16.333
> 
> 标签：javascript, jquery, html

我有一个 div 里面有几个元素（如预期的那样），我希望能够拖放这个 div ( `draggable=true`); 但是，一个元素是条形图，允许用户在其上拖动鼠标以选择特定范围的数据（有点像 Stack Overflow 允许您在特定日期范围内查看您的声誉 - 您可以在您的您的声誉选项卡下的个人资料）。`draggable`正如您可能想象的那样，当它的父 div设置为时，我无法拖动该图表`true`，因为它只是拖动 div 而不是更新图表。

我想了很多技巧来解决这个问题，但它们看起来都相当混乱。所以我想知道我有哪些不那么骇人听闻的选择。理想情况下，我只能通过拖动部分 div 来拖动整个 div。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:52:02.893

将“div”设置为可拖动将导致它在您拖动该 div 中包含的任何元素时被拖动。解决此问题的一种好方法是使用绝对定位将图形定位在 div 的空间内，而不是将其放在 div 标签内。

# .net - 使用 Filter 以编程方式运行 nUnit

> ID：16042590
> 
> 赞同：2
> 
> 时间：2013-04-16T16:46:38.257
> 
> 标签：.net, nunit

我正在尝试使用 nUnit API 以编程方式启动测试，并按夹具名称过滤。这是我的代码（其中“fixtureType”是一个 .Net System.Type）

```
TestPackage testPackage = new TestPackage(assemblyPath);
RemoteTestRunner remoteTestRunner = new RemoteTestRunner();
remoteTestRunner.Load(testPackage);
TestFilter filter = new NameFilter(new TestName() { Name = fixtureType.FullName, FullName = fixtureType.FullName });
TestResult testResult = remoteTestRunner.Run(new NullListener(), filter, true, LoggingThreshold.All); 
```

这似乎不起作用 - 没有进行任何测试。有什么简单的方法可以只执行属于特定夹具的测试吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T00:49:45.237

另请参阅：SimpleNameFilter（字符串名称）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T09:37:49.497

NameFilter does not simply work that way. See [http://nunit.net/blogs/?p=23](http://nunit.net/blogs/?p=23)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T12:21:28.213

你为什么不使用控制台运行器？它也很容易以编程方式控制。

我没有找到任何关于该`NameFilter`课程的公开文档。在源代码中，我发现了以下内容（请参阅单元测试`NameFilter`）：

```
TestFilter filter = new NameFilter();
filter.Add("Your.Test.Name"); 
```

# java - 反射 IllegalArgumentException 原因

> ID：16042591
> 
> 赞同：10
> 
> 时间：2013-04-16T16:46:43.027
> 
> 标签：java, reflection, classcastexception, illegalargumentexception

**更新**- 使问题更清楚。

通过反射调用方法时获得 ClassCastException 的可能原因是什么？

在尝试通过反射调用方法时，我将以下堆栈跟踪作为我的应用程序的一部分。

```
java.lang.IllegalArgumentException: java.lang.ClassCastException@21fea1fv
    at sun.reflect.GeneratedMethodAccessor332.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com..... 
    (remaining is my method stack trace) 
```

我尝试了一个示例类并将不同类型的各种参数传递给它，但我总是得到一个这个异常。

```
java.lang.IllegalArgumentException: argument type mismatch
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597) 
```

**更新 -** 这是我为尝试重新创建异常而编写的示例代码

创建代理类的接口

```
package my.tests;

public interface ReflectionsInterface { 
    public abstract void doSomething();
} 
```

这是测试课

```
package my.tests;

import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;

public class Reflections implements ReflectionsInterface {

    public static void main(String[] args) {
        Reflections reflections = new Reflections();
        ReflectionsInterface reflectionsProxy = reflections.createProxy(ReflectionsInterface.class);
        invokeMethod(reflectionsProxy, "doSomething", null);
    }

    public <T> T createProxy(Class<T> entityInterface) {
        EntityInvocationHandler eih = new EntityInvocationHandler(this);
        T cast = entityInterface.cast(Proxy.newProxyInstance(
                entityInterface.getClassLoader(), new Class[]{entityInterface}, eih));
        return cast;
    }

    public static void invokeMethod(Object obj, String methodName, Object... args) {
        Method[] methods = obj.getClass().getMethods();
        try {
            for (Method method : methods) {
                if (method.getName().equals(methodName)) {
                    method.invoke(obj, args);
                    break;
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void doSomething() {
        System.out.println("woo");
    }

    private final static class EntityInvocationHandler implements InvocationHandler,
            ReflectionsInterface {

        private Reflections reflectionObj;

        public EntityInvocationHandler(Reflections reflectionObj) {
            super();
            this.reflectionObj = reflectionObj;
        }

        @Override
        public void doSomething() {
            reflectionObj.doSomething();
        }

        @Override
        public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
            Object invoke = method.invoke(this, args);
            return invoke;
        }

    }
} 
```

我无法理解我什么时候会得到*参数类型不匹配*并且会导致 *ClassCastException 。***我无法重新创建异常，并想知道它为什么会出现。任何重新创建它的工作代码，或在这种情况下引发此异常的源代码参考都很好**

我已经浏览了 Method.class javadocs 和源代码，我无法弄清楚为什么会出现这个错误。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-22T13:32:27.970

`ClassCastException`我通过修改您的示例代码重新创建了：`invokeMethod`用正确的参数调用 10000 次，然后用错误的参数调用它。

类中的`main`方法`Reflections`

```
public static void main(String[] args) {
    Reflections reflections = new Reflections();
    ReflectionsInterface reflectionsProxy = reflections
            .createProxy(ReflectionsInterface.class);
    for (int i = 0; i < 10000; i++)
        invokeMethod(reflectionsProxy, ReflectionsInterface.class,
                "doSomething");

    invokeMethod(new Object(), ReflectionsInterface.class, "doSomething");
} 
```

类中的`invokeMethod`方法`Reflections`

```
public static void invokeMethod(Object obj, Class<?> clazz,
        String methodName, Object... args) {
    Method[] methods = clazz.getMethods();
    try {
        for (Method method : methods) {
            if (method.getName().equals(methodName)) {
                method.invoke(obj, args);
                break;
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

堆栈跟踪：

```
java.lang.IllegalArgumentException: java.lang.ClassCastException@603a3e21
    at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.twbbs.pccprogram.Reflections.invokeMethod(Reflections.java:33)
    at org.twbbs.pccprogram.Reflections.main(Reflections.java:16) 
```

我的解释`ClassCastException`：

当你第一次调用`invokeMethod`时，JVM 使用较慢的路由，这对程序员来说更容易调试（所以它更慢！），所以`argument type mismatch`当你传递一个错误的参数时它会显示一个更友好的消息。

当您`invokeMethod`多次调用时（在我的测试中 16 次就足够了），JVM`GeneratedMethodAccessor***`会在运行时生成一个，速度更快，错误检查更少。所以`java.lang.ClassCastException@603a3e21`当你传递一个糟糕的论点时，它会显示出如此丑陋的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:49:15.040

好吧，这就是问题所在：

```
reflections.invokeMethod("doInt", 1L); 
```

您正在调用`doInt`，但您正在传递一个`long`值。所以反射试图将 a`Long`转换为 a `Integer`，这是无效的。

我怀疑你的意思是：

```
reflections.invokeMethod("doLong", 1L); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T10:56:12.030

我对您的代码进行了一些修改以重现此错误：

```
java.lang.IllegalArgumentException: argument type mismatch 
```

这是界面

```
public interface ReflectionsInterface
{
  public abstract void doSomething1(Integer i);
  public abstract void doSomething2(String s);
} 
```

在类 Reflections 和 EntityInvocationHandler 中添加方法以便编译。然后将此方法添加到您的 main() 中。执行，我会产生错误运行时。

```
invokeMethod(reflectionsProxy, "doSomething1", "1"); 
```

我试图获得 un ClassCastException 但我没有成功。它可能出现在您的原始代码中，因为有更多对象并且将无效类型传递给该方法。添加日志并尝试调试以隔离 ClassCastException。

# html - CSS Div 框不会在彼此下方

> ID：16042605
> 
> 赞同：0
> 
> 时间：2013-04-16T16:47:40.547
> 
> 标签：html, css

我将这个 CSS 代码用于我主页上的几个 div 框：

```
#homepagebox {
    width:80%;
    margin:0 auto 0 auto;
}
#homepagebox .column {
    float: left;
    width: 25%;
}
#homepagebox .column div {
    margin: 15px;
    min-height: 300px;
    max-height:300px;
    color:#ffffff;
    background: #666666;
    border-radius:10px;
} 
```

当屏幕变得太小时，我需要它们开始在彼此下方显示，但显然如果屏幕足够大，那么所有显示都彼此相邻。

目前如果屏幕太小，盒子就会变小

这是一个小提琴：http: [//jsfiddle.net/LEvzs/](http://jsfiddle.net/LEvzs/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:50:52.810

```
#homepagebox .column {
    float: left;
    min-width: 25%;
} 
```

如果您以百分比设置宽度，它永远不会达到需要将内容换行到下一行的程度。将其设置为 min-width 可确保它们永远不会缩小到该点以下，因此会换行。

[编辑] 更新小提琴以具有固定宽度，但在需要时仍会换行。

```
#homepagebox .column {
    float: left;
    width: 25%;
    min-width: 200px;
} 
```

[http://jsfiddle.net/LEvzs/2/](http://jsfiddle.net/LEvzs/2/)

# php - 使用 PHP 将 varchar(16) 从 sql 转换为函数时间

> ID：16042608
> 
> 赞同：0
> 
> 时间：2013-04-16T16:47:44.027
> 
> 标签：php, datetime, time, casting

编辑以反映下面建议的一些更改。

我从我的数据库中提取了一些时间和几分钟。它们在数据库中看起来像这样

```
| taskID |    startTime     |      endTime     |   everyMinutes   |
|________|__________________|__________________|__________________|
|   10   | 05:00:00.0000000 | 16:59:00.0000000 | 00:15:00.0000000 | 
```

`startTime`, `endTime`, 和`everyMinutes`属于`varchar(16)`。不幸的是，我无法改变这一点。

我在变量中有这些值：

```
$strStartTime = $row['startTime'];
$strEndTime = $row['endTime'];
$strEveryMinutes = $row['everyMinutes'];

$startTime = date('H:i:s', strtotime($strStartTime));
$endTime = date('H:i:s', strtotime($strEndTime));
$everyMinutes = date('H:i:s', strtotime($strEveryMinutes));

$composite = $startTime + $everyMinutes;
echo $composite; # returns "5", should be "5:15" 
```

我的目标是把`$startTime`它添加到`$everyMinutes`这样，如果你

```
 echo $composite # displays "05:15:00" without all the extra 0's 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:54:17.123

使用[strtotime](http://php.net/manual/en/function.strtotime.php)：

```
<?php
echo date('Y-m-d H:i:s', strtotime('05:00:00.000000'))."<br/>\n";
echo date('Y-m-d H:i:s', strtotime('05:00:00.000000 + 15 minutes'))."<br/>\n";
?> 
```

输出：

```
2013-04-16 05:00:00
2013-04-16 05:15:00 
```

**编辑**：完整代码：

```
$startTime = date('H:i:s', strtotime($row['startTime']));
$minutes = substr($row['everyMinutes'], 3, 2); // this will cut out the minutes part. I am assuming everyMinutes is always only in minutes.
$composite = date('H:i:s', strtotime($row['startTime']." + $minutes minutes")); 
```

# java - 我需要知道如何在 Java 中将变量设置为此值

> ID：16042613
> 
> 赞同：-6
> 
> 时间：2013-04-16T16:47:50.303
> 
> 标签：java

* * *

```
 **NEVERMIND, I CHEATED** 
```

* * *

```
Movie[] movies = new Movie[8];
movies[0] = new Movie("The Godfather", 1972); 
```

假设我有一堆电影变量，我怎么能在电影 [] 变量中设置一个变量（称之为年份或其他东西）到年份？

（我在编程课上，我的任务是调试一个文件，我唯一的错误是我需要将年份变量设置为电影 [] 中的年份）

这是我的完整代码：

```
import javax.swing.*;
public class DebugNine2
{
public static void main(String[] args)
   {
  Movie[] movies = new Movie[8];
  Movie[] year;
  int i;
  String message, entry;
  movies[0] = new Movie("The Godfather", 1972);
  movies[1] = new Movie("The Good, the Bad, and the Ugly", 1966);
  movies[2] = new Movie("Pulp Fiction", 1994);
  movies[3] = new Movie("Shindler's List", 1993);
  movies[4] = new Movie("Casablanca", 1942);
  movies[5] = new Movie("Wizard of Oz", 1939);
  movies[6] = new Movie("Citizen Kane", 1941);
  movies[7] = new Movie("Some Like It Hot", 1959);
  entry = JOptionPane.showInputDialog(null,
    "Sort Movies by\n(N)ame, or (Y)ear");
  if(entry.equals("N"))
  {
     nameSort(movies);
     message = "Sorted by Name\n";
  }
  else
  {
      year=movies;
      yearSort(year);
      message = "Sorted by Year\n";
  }   
  display(movies, message);
  //System.out.println(movies+"\n"+message);
}
public static void nameSort(Movie[] array)
{
  int a, b;
  int highSub = array.length - 1;
  for(a = 0; a < highSub; ++a)
  {
     for(b = 0; b < highSub; ++b)
 {
         String first = array[b].getName();
         String second = array[b + 1].getName();
         if(first.compareTo(second) > 0)
     {

        Movie temp = array[b];
        array[b] = array[b + 1];
        array[b + 1] = temp;
     }
  }
   }
}
public static void yearSort(Movie[] array)
{
    int a, b;
    Movie temp;
    int highSub = array.length;
    for (a = 0; a < highSub; ++a)
    {
       for (b = 0; b < highSub; ++b)
       if (array[b].getYear() > array[b + 1].getYear())
       {
          temp = array[b];
          array[b] = array[b + 1];
          array[b + 1] = temp;
       }
    }
 }
 public static void display(Movie[] s,  String msg)
 {
    for (int i = 0; i < 8; i++)
       msg = msg + s[i].getName() + ", " + s[i].getYear() + "\n";
    JOptionPane.showMessageDialog(null, msg);
 }
} 
```

此外，还有一个名为 Movie.java 的文件，其中包含代码

```
public class Movie
{
private String name;
private int year;
Movie(String s, int y)
{
  name = s;
  year = y;
}
public String getName()
{ 
  return name;
}
public int getYear()
{
  return year;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:53:22.667

Movie 类可以有 String name 和 int year 字段。获取它们的 setter 和 getter 方法。通过构造函数初始化它们，比如 new Movie(String name , int year);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:52:42.600

您不能设置电影对象的年份，因为该变量是私有的。您需要创建一个公共方法来更改值或使变量本身公开。

# matlab - 如何在 MATLAB 中绘制非线性微分方程系统？

> ID：16042614
> 
> 赞同：1
> 
> 时间：2013-04-16T16:47:57.580
> 
> 标签：matlab, plot, differential-equations

其实我又在问同样的问题

DX=y

dy=-k*yx^3+9.8*cos(t)

inits=('x(0)=0,y(0)=0')

这些是我想要绘制的微分方程。

首先，我尝试求解微分方程，然后绘制图形。

Dsolve('Dx=y','Dy=-k*yx^3+9.8*cos(t)', inits)

然而，像这样，这个系统没有明确的解决方案。

现在我被困住了:(

你怎么能在不解方程的情况下绘制这个系统？

Chris Taylor 通过绘制 y vs t 和 x vs t 图解决了我的问题。

但是我想知道绘制 y vs x 图形的方法（这是对的吗？我的意思是带有垂直轴 y 和水平轴 x 的图形）

请帮我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T18:27:12.597

使用 Chris Taylor[回答](https://stackoverflow.com/questions/16023579/how-do-you-plot-nonlinear-differential-equations-in-matlab)中的代码如下：

```
k = 1;
f = @(t,x) [x(2); -k * x(2) - x(1)^3 + 9.8 * cos(t)];
tspan = [0, 10];
xinit = [0, 0];
[t, y] = ode45(f, tspan, xinit); 
```

为您提供值 x 和 y 作为 t 从 0 到 10 的函数，分别存储在 y 的第一列和第二列中。因此，您可以通过简单地调用来绘制 y(x)

```
plot(y(:,2),y(:,1)); 
```

# android - Android 虚拟设备屏幕截图（无 WiFi）

> ID：16042616
> 
> 赞同：-1
> 
> 时间：2013-04-16T16:47:58.967
> 
> 标签：android, wifi, screenshot, avd

我开发了一个应用程序，它连接到 LAN 上的设备并通过 Internet 连接。它已完成并准备发布。以前我只会在 AVD 上运行应用程序并以这种方式截屏。不过我这里有问题。我的应用程序需要 WiFi 连接到设备才能运行，但由于 AVD 不支持此功能，我无法以这种方式获取屏幕截图。有任何想法吗？我还没有看到一个非常好的安卓屏幕截图应用程序，如果你知道，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:56:33.057

虽然最近才支持设备上的屏幕截图，但从早期版本的 SDK 开始，当设备通过 ADB 连接到计算机时，您就能够通过 SDK 的 DDMS 工具对 Android 设备进行屏幕截图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:51:21.517

没关系。Android 在 Android 4.0 及更高版本中解决了这个问题。只需按住电源按钮和降低音量按钮，它将进行屏幕截图。希望这可以帮助某人。

# html - 图像未对齐到左对齐 div 的中心

> ID：16042617
> 
> 赞同：1
> 
> 时间：2013-04-16T16:48:02.183
> 
> 标签：html, css

下面是我的代码：

```
<div id="footer">
<div id="left_footer">
<div id="img_left" align="center">
<img src="separator_bar.jpg" align="middle"/>
</div>
</div>
<div id="right_footer">
<div id="img_right" align="center">
<img src="separator_bar.jpg" align="middle"/>
</div>
</div>
</div 
```

CSS：

```
#footer {
    width:500px;
    position:relative
}
#left_footer{
    float:left;
}
#right_footer{
    float:right;
} 
```

我正在尝试此代码，但我的图像未对齐以使其始终对齐左页脚中的左侧和右页脚中的右侧。请建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:57:24.043

我会这样处理布局：

[http://jsfiddle.net/yWmZ5/1/](http://jsfiddle.net/yWmZ5/1/)

**HTML**

```
<div id="footer">
    <div id="left_footer">
        <img src="http://placekitten.com/100/100" />
    </div>
    <div id="right_footer">
        <img src="http://placekitten.com/100/100" />
    </div>
</div> 
```

**CSS**

```
#footer { width:500px; position:relative; overflow:hidden; }
#left_footer{ width:250px; float:left; text-align:center; background:orange; }
#right_footer{ width:250px; float:right; text-align:center; background:yellow; } 
```

确保从 HTML 中去除所有样式（例如 - 对齐等）并将其放入 CSS 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:00:50.560

试试这种风格：

```
#footer > div{width:50%} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:01:53.960

你需要有一些宽度`div#left_footer`，`div#right_footer`以便在中间显示内容

将相应的 css 更改为：

```
#left_footer{
    text-align:center;
    float:left;
    width:50%;

    }
#right_footer{
    float:right;
    width:50%;

} 
```

看到这个[小提琴](http://jsfiddle.net/EjmBv/1/)

# c# - 不支持 sta 线程上的多个句柄的 waitall

> ID：16042623
> 
> 赞同：3
> 
> 时间：2013-04-16T16:48:14.583
> 
> 标签：c#, multithreading, exception

大家好，当我运行我的应用程序时，我遇到了这个异常。我在 .net 3.5 上工作，所以我不能使用`Task`

> 不支持 sta 线程上的多个句柄的 waitall

这是代码：-

```
private void ThreadPopFunction(ContactList SelectedContactList, List<User> AllSelectedUsers)
{
        int NodeCount = 0;

        AllSelectedUsers.EachParallel(user =>
        {
            NodeCount++;
            if (user != null)
            {
                if (user.OCSEnable)
                {
                    string messageExciption = string.Empty;
                    if (!string.IsNullOrEmpty(user.SipURI))
                    {
                        //Lync.Lync.Lync lync = new Lync.Lync.Lync(AdObjects.Pools);
                        List<Pool> myPools = AdObjects.Pools;
                        if (new Lync.Lync.Lync(myPools).Populate(user, SelectedContactList, out messageExciption))
                        {
                        }
                    }
                }
            }
        });
} 
```

这是我用来处理多线程的扩展方法

```
public static void EachParallel<T>(this IEnumerable<T> list, Action<T> action)
{
    // enumerate the list so it can't change during execution
    // TODO: why is this happening?
    list = list.ToArray();
    var count = list.Count();

    if (count == 0)
    {
        return;
    }
    else if (count == 1)
    {
        // if there's only one element, just execute it
        action(list.First());
    }
    else
    {
        // Launch each method in it's own thread
        const int MaxHandles = 64;
        for (var offset = 0; offset <= count/MaxHandles; offset++)
        {
            // break up the list into 64-item chunks because of a limitiation in WaitHandle
            var chunk = list.Skip(offset*MaxHandles).Take(MaxHandles);

            // Initialize the reset events to keep track of completed threads
            var resetEvents = new ManualResetEvent[chunk.Count()];

            // spawn a thread for each item in the chunk
            int i = 0;
            foreach (var item in chunk)
            {
                resetEvents[i] = new ManualResetEvent(false);
                ThreadPool.QueueUserWorkItem(new WaitCallback((object data) =>
                {
                    int methodIndex =
                        (int) ((object[]) data)[0];

                    // Execute the method and pass in the enumerated item
                    action((T) ((object[]) data)[1]);

                    // Tell the calling thread that we're done
                    resetEvents[methodIndex].Set();
                }), new object[] {i, item});
                i++;
            }

            // Wait for all threads to execute
            WaitHandle.WaitAll(resetEvents);
        }
    }
} 
```

如果你能帮助我，我会感谢你的支持

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:21:46.087

好的，因为您使用的是 .Net 3.5，所以不能使用 .Net 4.0 引入的 TPL。

STA 线程与否，在您的情况下，有一种比`WaitAll`. 你可以简单地拥有一个 counter 和一个 unique `WaitHandle`。这是一些代码（现在无法测试，但应该没问题）：

```
// No MaxHandle limitation ;)
for (var offset = 0; offset <= count; offset++)
{
    // Initialize the reset event
    var resetEvent = new ManualResetEvent();

    // Queue action in thread pool for each item in the list
    int counter = count;
    foreach (var item in list)
    {
        ThreadPool.QueueUserWorkItem(new WaitCallback((object data) =>
                      {
                          int methodIndex =
                              (int) ((object[]) data)[0];

                          // Execute the method and pass in the enumerated item
                          action((T) ((object[]) data)[1]);

                          // Decrements counter atomically
                          Interlocked.Decrement(ref counter);

                          // If we're at 0, then last action was executed
                          if (Interlocked.Read(ref counter) == 0)
                          {
                              resetEvent.Set();
                          }
                      }), new object[] {i, item});
    }

    // Wait for the single WaitHandle
    // which is only set when the last action executed
    resetEvent.WaitOne();
} 
```

另外仅供参考，`ThreadPool.QueueUserWorkItem`每次调用时都不会产生一个线程（我说这是因为评论“为块中的每个项目产生一个线程”）。它使用一个线程池，因此它主要重用现有线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-14T11:25:52.640

对于像我这样需要使用示例的人。ken2k 的解决方案很棒，它可以工作，但有一些更正（他说他没有测试过）。这是 ken2k 的工作示例（为我工作）：

```
// No MaxHandle limitation ;)
for (var offset = 0; offset <= count; offset++)
{
    // Initialize the reset event
    var resetEvent = new ManualResetEvent(false);

    // Queue action in thread pool for each item in the list
    long counter = count;
    // use a thread for each item in the chunk
    int i = 0;
    foreach (var item in list)
    {
        ThreadPool.QueueUserWorkItem(new WaitCallback((object data) =>
                      {
                          int methodIndex =
                              (int) ((object[]) data)[0];

                          // Execute the method and pass in the enumerated item
                          action((T) ((object[]) data)[1]);

                          // Decrements counter atomically
                          Interlocked.Decrement(ref counter);

                          // If we're at 0, then last action was executed
                          if (Interlocked.Read(ref counter) == 0)
                          {
                              resetEvent.Set();
                          }
                      }), new object[] {i, item});
    }

    // Wait for the single WaitHandle
    // which is only set when the last action executed
    resetEvent.WaitOne();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-14T12:05:52.900

实际上有一种方法可以在 .net 3.5 中使用（至少是很好的一部分）TPL。有一个为 Rx-Project 完成的反向移植。

你可以在这里找到它：[http ://www.nuget.org/packages/TaskParallelLibrary](http://www.nuget.org/packages/TaskParallelLibrary)

也许这会有所帮助。

# mysql - MySQL 子查询效率

> ID：16042625
> 
> 赞同：1
> 
> 时间：2013-04-16T16:48:22.313
> 
> 标签：mysql, performance

我有这个查询，它将大量值添加到“统计”表中。当查询运行时，它会选择值以在子查询中填充表。我想知道这是否可以更有效地进行，或者我是否做错了什么。我对 MySQL 不太熟悉，所以任何帮助都会很棒:)

这是查询：

```
UPDATE mediastats SET 
    mediastats_members = (SELECT count(*) FROM status WHERE status_media_id = :id),
    mediastats_avscore = (SELECT AVG(status_rating) FROM status WHERE status_media_id = :id),
    mediastats_done = (SELECT count(*) FROM status WHERE status_status = 'done' AND status_media_id = :id),
    mediastats_doing = (SELECT count(*) FROM status WHERE status_status = 'doing' AND status_media_id = :id),
    mediastats_redoing = (SELECT count(*) FROM status WHERE status_status = 'redoing' AND status_media_id = :id),
    mediastats_dropped = (SELECT count(*) FROM status WHERE status_status = 'dropped' AND status_media_id = :id),
    mediastats_wantto = (SELECT count(*) FROM status WHERE status_status = 'wantto' AND status_media_id = :id),
    mediastats_wont = (SELECT count(*) FROM status WHERE status_status = 'wont' AND status_media_id = :id),
    mediastats_stalled = (SELECT count(*) FROM status WHERE status_status = 'stalled' AND status_media_id = :id),
    mediastats_rating_1 = (SELECT count(*) FROM status WHERE status_rating = 1 AND status_media_id = :id),
    mediastats_rating_2 = (SELECT count(*) FROM status WHERE status_rating = 2 AND status_media_id = :id),
    mediastats_rating_3 = (SELECT count(*) FROM status WHERE status_rating = 3 AND status_media_id = :id),
    mediastats_rating_4 = (SELECT count(*) FROM status WHERE status_rating = 4 AND status_media_id = :id),
    mediastats_rating_5 = (SELECT count(*) FROM status WHERE status_rating = 5 AND status_media_id = :id),
    mediastats_rating_6 = (SELECT count(*) FROM status WHERE status_rating = 6 AND status_media_id = :id),
    mediastats_rating_7 = (SELECT count(*) FROM status WHERE status_rating = 7 AND status_media_id = :id),
    mediastats_rating_8 = (SELECT count(*) FROM status WHERE status_rating = 8 AND status_media_id = :id),
    mediastats_rating_9 = (SELECT count(*) FROM status WHERE status_rating = 9 AND status_media_id = :id),
    mediastats_rating_10 = (SELECT count(*) FROM status WHERE status_rating = 10 AND status_media_id = :id)
    WHERE mediastats_media_id = :id 
```

:id 是从 PHP 添加的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:05:15.813

下面是我在 PHP 中使用 PDO 的方法：

```
$sql = "
    SELECT
     COUNT(*) AS mediastats_members,
     AVG(status_rating) AS mediastats_avscore,
     SUM(status_status = 'done') AS mediastats_done,
     SUM(status_status = 'doing') AS mediastats_doing,
     SUM(status_status = 'redoing') AS mediastats_redoing,
     SUM(status_status = 'dropped') AS mediastats_dropped,
     SUM(status_status = 'wantto') AS mediastats_wantto,
     SUM(status_status = 'wont') AS mediastats_wont,
     SUM(status_status = 'stalled') AS mediastats_stalled,
     SUM(status_rating = 1) AS mediastats_rating_1,
     SUM(status_rating = 2) AS mediastats_rating_2,
     SUM(status_rating = 3) AS mediastats_rating_3,
     SUM(status_rating = 4) AS mediastats_rating_4,
     SUM(status_rating = 5) AS mediastats_rating_5,
     SUM(status_rating = 6) AS mediastats_rating_6,
     SUM(status_rating = 7) AS mediastats_rating_7,
     SUM(status_rating = 8) AS mediastats_rating_8,
     SUM(status_rating = 9) AS mediastats_rating_9,
     SUM(status_rating = 10) AS mediastats_rating_10
    FROM status
    WHERE status_media_id = :id";
$stmt = $pdo->prepare($sql);
$stmt->execute(array("id"=>$id));
$params = $stmt->fetch(PDO::FETCH_ASSOC); 
```

通过这种方式，您可以一次计算表中的所有聚合，而不是为每个计数使用单独的子查询。

我正在使用 MySQL 的技巧——布尔表达式的 SUM() 等于表达式为真的 COUNT()。这是因为 MySQL 布尔表达式总是返回 0 或 1，并且 0 和 1 的 SUM 等于 1 的 COUNT。

然后，您可以将上述查询的结果用作 UPDATE 语句的参数数组：

```
$sql = "
    UPDATE mediastats SET 
        mediastats_members = :mediastats_members,
        mediastats_avscore = :mediastats_avscore,
        mediastats_done = :mediastats_done,
        mediastats_doing = :mediastats_doing,
        mediastats_redoing = :mediastats_redoing,
        mediastats_dropped = :mediastats_dropped,
        mediastats_wantto = :mediastats_wantto,
        mediastats_wont = :mediastats_wont,
        mediastats_stalled = :mediastats_stalled,
        mediastats_rating_1 = :mediastats_rating_1,
        mediastats_rating_2 = :mediastats_rating_2,
        mediastats_rating_3 = :mediastats_rating_3,
        mediastats_rating_4 = :mediastats_rating_4,
        mediastats_rating_5 = :mediastats_rating_5,
        mediastats_rating_6 = :mediastats_rating_6,
        mediastats_rating_7 = :mediastats_rating_7,
        mediastats_rating_8 = :mediastats_rating_8,
        mediastats_rating_9 = :mediastats_rating_9,
        mediastats_rating_10 = :mediastats_rating_10
    WHERE mediastats_media_id = :id";

$stmt = $pdo->prepare($sql);
$params["id"] = $id;
$stmt->execute($params); 
```

自 PHP 5.3.4 起，PDO 接受不带前导的参数数组键`:`。在查询中声明参数占位符时需要冒号，但在提供给 execute() 的值数组中不需要冒号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:56:04.860

```
UPDATE  (
        SELECT  status_media_id,
                COUNT(*) AS cnt, AVG(status_rating) AS avg_rating,
                SUM(status_status = 'done') AS cnt_done,
                ...
        FROM    status
        WHERE   status_media_id = :id
        ) s
JOIN    mediastats ms
ON      ms.mediastats_media_id = s.status_media_id
SET     ms.mediastats_members = cnt,
        ms.mediastats_avscore = avg_rating,
        ms.mediastats_done = cnt_done,
        ... 
```

# php - PHP：从套接字或 STDIN 读取

> ID：16042626
> 
> 赞同：3
> 
> 时间：2013-04-16T16:48:25.470
> 
> 标签：php, stream, stdin

# 我正在学习 PHP 中的套接字编程，所以我正在尝试一个简单的 echo-chat 服务器。

我写了一个服务器，它可以工作。我可以将两个 netcat 连接到它，当我在一个 netcat 中写入时，我会在另一个 netcat 中接收它。现在，我想实现 NC 在 PHP 中所做的事情

我想使用 stream_select 来查看我是否在 STDIN 或套接字上有数据，以便将消息从 STDIN 发送到服务器或从服务器读取传入消息。不幸的是，php手册中的示例并没有给我任何线索。我试图简单地 $line = fgets(STDIN) 和 socket_write($socket, $line) 但它不起作用。所以我开始下降，只是希望 stream_select 在用户输入消息时起作用。

```
$read = array(STDIN);
$write = NULL;
$exept = NULL;

while(1){

    if(stream_select($read, $write, $exept, 0) > 0)
        echo 'read';
} 
```

给

> PHP 警告：stream_select()：第 18 行的 /home/user/client.php 中没有传递流数组

但是当我 var_dump($read) 它告诉我，它是一个带有流的数组。

```
array(1) {
  [0]=>
  resource(1) of type (stream)
} 
```

如何让 stream_select 工作？

* * *

PS：在Python中我可以做类似的事情

```
r,w,e = select.select([sys.stdin, sock.fd], [],[])
for input in r:
    if input == sys.stdin:
        #having input on stdin, we can read it now
    if input == sock.fd
        #there is input on socket, lets read it 
```

我在 PHP 中也需要同样的东西

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T08:36:18.010

我找到了解决方案。当我使用时，它似乎有效：

```
$stdin = fopen('php://stdin', 'r');
$read = array($sock, $stdin);
$write = NULL;
$exept = NULL; 
```

而不仅仅是标准输入。尽管 php.net 说，STDIN 已经打开并使用 $stdin = fopen('php://stdin', 'r'); 保存 如果你想将它传递给stream_select，它似乎不是。此外，应该使用 $sock = fsockopen($host); 创建到服务器的套接字。而不是在客户端使用 socket_create ......必须喜欢这种语言，它的合理性和清晰的手册......

这是一个使用 select 连接到 echo 服务器的客户端的工作示例。

```
<?php
$ip     = '127.0.0.1';
$port   = 1234;

$sock = fsockopen($ip, $port, $errno) or die(
    "(EE) Couldn't connect to $ip:$port ".socket_strerror($errno)."\n");

if($sock)
    $connected = TRUE;

$stdin = fopen('php://stdin', 'r'); //open STDIN for reading

while($connected){ //continuous loop monitoring the input streams
    $read = array($sock, $stdin);
    $write = NULL;
    $exept = NULL;

    if (stream_select($read, $write, $exept, 0) > 0){
    //something happened on our monitors. let's see what it is
        foreach ($read as $input => $fd){
            if ($fd == $stdin){ //was it on STDIN?
                $line = fgets($stdin); //then read the line and send it to socket
                fwrite($sock, $line);
            } else { //else was the socket itself, we got something from server
                $line = fgets($sock); //lets read it
                echo $line;
            }
        }
    }
} 
```

# java - log4j2 配置

> ID：16042628
> 
> 赞同：4
> 
> 时间：2013-04-16T16:48:28.440
> 
> 标签：java, logging, configuration, log4j, log4j2

有人可以说我如何更改我的 log4j2.xml 以添加 1 个日志文件：一级跟踪和一级信息？

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration status="debug">
    <appenders>
        <Console name="CONSOLE" target="SYSTEM_OUT">
            <PatternLayout pattern="%d %-5p %C{2} (%F:%L) - %m%n" />
        </Console>
        <File name="DEBUG_FILE" fileName="debug.txt">
            <PatternLayout pattern="%d %-5p %C{2} (%F:%L) - %m%n" />
        </File>
    </appenders>
    <loggers>
        <root level="debug">
            <appender-ref ref="CONSOLE" />
            <appender-ref ref="DEBUG_FILE" />
        </root>
    </loggers> 
</configuration> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T10:46:18.523

您可以将根记录器设置为 TRACE 级别（所有消息）并在控制台上放置一个 ThresholdFilter，以便在控制台上只显示一些消息。

此配置将仅将 ERROR 消息记录到控制台，同时将所有消息（TRACE、DEBUG、INFO、ERROR...）记录到 debug.txt 文件。控制台和文件中都记录了错误和更高级别的消息：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration status="ERROR">
    <appenders>
        <Console name="CONSOLE" target="SYSTEM_OUT">
            <ThresholdFilter level="ERROR" onMatch="ACCEPT" onMismatch="DENY"/>
            <PatternLayout pattern="%d %-5p %C{2} (%F:%L) - %m%n" />
        </Console>
        <File name="DEBUG_FILE" fileName="debug.txt">
            <PatternLayout pattern="%d %-5p %C{2} (%F:%L) - %m%n" />
        </File>
    </appenders>
    <loggers>
        <root level="trace">
            <appender-ref ref="CONSOLE" />
            <appender-ref ref="DEBUG_FILE" />
        </root>
    </loggers> 
</configuration> 
```

顺便说一句，请注意您的模式布局包含需要位置信息的转换模式（准确地说是**%C、%F 和 %L**）。这意味着对于每条日志消息，log4j2 需要对堆栈进行快照，然后遍历堆栈跟踪以查找进行日志记录的类和方法。

这是**非常非常缓慢**的。

同步日志记录将慢 2-5 倍，异步日志记录慢 4-20 倍。

如果性能不是问题，那也没关系，但这绝对是需要注意的事情。我个人只使用 %c （记录器名称），并且我的应用程序的日志消息足够独特，我可以快速找到消息的来源。只是我的2美分。

--- 更新 2013-04-27 --- 我已经学会了一种更简单的方法来做到这一点：你可以在 appender-ref 上设置一个级别。

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration status="debug">
    <appenders>
        <Console name="CONSOLE" target="SYSTEM_OUT">
            <PatternLayout pattern="%d %-5p %c{2} - %m%n" /> <!--without location-->
        </Console>
        <File name="DEBUG_FILE" fileName="debug.txt">
            <PatternLayout pattern="%d %-5p %c{2} - %m%n" />
        </File>
    </appenders>
    <loggers>
        <root level="debug">
            <appender-ref ref="CONSOLE" level="ERROR" />
            <appender-ref ref="DEBUG_FILE" />
        </root>
    </loggers> 
</configuration> 
```

# perl - Perl telnet 命令不发送每个命令

> ID：16042630
> 
> 赞同：0
> 
> 时间：2013-04-16T16:48:30.303
> 
> 标签：perl, network-programming, telnet, perl-module, telnetlib

我有以下程序，它可以远程登录到另一台设备并打印序列号和 Mac 地址。

我的问题是，由于某种原因，如果我在跳过第一个命令并发送第二个命令后发送命令，但是如果我将相同的命令复制两次，它将发送命令。

连续发送多个命令的正确方法是什么？

是否应该在发送每个命令后刷新缓冲区？

我的环境

```
Eclipse Ide
Ubuntu 12.10
perl 5, version 14, subversion 2 (v5.14.2) 
```

我的代码片段：

```
$telnet = Net::Telnet->new($remoteSystem);
$| = 1;
$telnet->buffer_empty();
$telnet->buffer_empty(); 
$result = $telnet->input_log($errorlog);
#$_ = "@lines";
@TSN =$telnet->cmd('export | grep -e SerialNumber..[A-Z] | cut -d"\"" -f2');
@TSN =$telnet->cmd('export | grep -e SerialNumber..[A-Z] | cut -d"\"" -f2');

@mac = $telnet->cmd('ifconfig  | grep eth0 | cut -d" "  -f 11');

print "@TSN AND @TSN @mac";

print FH "$remoteSystem\n";

print "Telnetting into $remoteSystem .\n";    # Prints names of the tcd

close(telnet);
}

foreach (@host) {
    checkStatus($_);
} 
```

OUTPUT 跳过第一个命令：

```
bash-2.02  AND bash-2.02  ifconfig  | grep eth0 | cut -d" "  -f 11
00:11:D9:3C:6E:02
bash-2.02 # 
bash-2.02 Telnetting into debug79-109 . 
```

输出这行得通，但我必须两次发送相同的命令：

```
export | grep -e SerialNumber..[A-Z] | cut -d"\"" -f2
AE20001901E2FD1
bash-2.02 # 
bash-2.02  AND export | grep -e SerialNumber..[A-Z] | cut -d"\"" -f2
AE20001901E2FD1
bash-2.02 # 
bash-2.02  ifconfig  | grep eth0 | cut -d" "  -f 11
00:11:D9:3C:6E:02
bash-2.02 # 
bash-2.02 Telnetting into debug79-109 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:58:30.847

在调用 cmd() 时指定命令提示符，例如`@TSN =$telnet->cmd('export | grep -e SerialNumber..[A-Z] | cut -d"\"" -f2', Prompt => 'bash-2.02 #');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:13:37.240

为模块 telnet 创建对象后尝试打开连接

```
$telnet->open($host); 
```

之后执行 waitFor 方法：（等到模式**bash-2.02 #**出现）

```
$telnet->waitFor(/^(bash-\d+.\d+ #)$/); 
```

然后执行你的命令，它会给你正确的输出。

# scala - 使用 Dispatch Databinder 0.10 处理 xml 时设置字符集

> ID：16042633
> 
> 赞同：2
> 
> 时间：2013-04-16T16:48:45.863
> 
> 标签：scala, scalatra, scala-dispatch

我正在使用 Scalatra 应用程序包装上游 API，并使用 Dispatch 发出异步请求。但是，我在将上游 XML 转换为`xml.Elems`使用 Dispatch 的内置 XML 处理支持时遇到了麻烦。

我正在尝试做一些与 Dispatch 文档中的内容非常相似的事情，即检索上游 XML 并进行一些重新处理。有问题的函数看起来像：

```
 def facilitiesSvc = {
    val myhost = host("upstream.api.co.uk") / "organisations" / "foo" / "123" / "bar" / "core.xml"
    myhost.addQueryParameter("apikey", "123456")
    myhost
  }

  def facilitiesXml: Future[Either[String, xml.Elem]] = {
    val res: Future[Either[Throwable, xml.Elem]] = Http((facilitiesSvc) OK as.xml.Elem).either
    for(exc <- res.left)
      yield "Can't connect to facilities service: \n" +
        exc.getMessage
  } 
```

这导致：

```
Left(Can't connect to facilities service: org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Content is not allowed in prolog.) 
```

上游 API 没有发回字符集，在检索它时，Dispatch 在 XML 开始之前用字节顺序标记显示它：`ï»¿<?xml version="1.0" encoding="utf-8"?>`。

我可以看到早期版本的 Dispatch 通过[以下方式](https://groups.google.com/forum/#!msg/dispatch-scala/0DMCsmLYCiY/mClejgg-QaAJ)解决了这个问题：

```
new Http apply(url(uri.toString).copy(defaultCharset = "iso-8859-1") as_str) 
```

但是我目前看不到使用 Dispatch 0.10 进行这项工作的方法。有没有人有任何关于在这个响应上设置字符集的提示，所以我可以解析返回的内容？

# asp.net-mvc-3 - XSocket 在 localhost 上运行良好，但在 Intranet 环境下却不行

> ID：16042634
> 
> 赞同：1
> 
> 时间：2013-04-16T16:48:46.457
> 
> 标签：asp.net-mvc-3, xsockets.net

我有一个使用 XSocket 的 asp.net mvc3 web 应用程序，它在本地运行良好，但它不在我的 Intranet 上。

我已经配置了 xsockets windows 服务并且运行良好。我已经将我的“插件”（DLL 和依赖项）复制到了正确的目录中并且运行良好。

问题是当我尝试通过 Intranet 访问应用程序时，连接总是显示已关闭。

我需要指向特定的 IP 地址/服务器名称吗？

我的 javascript 代码在 localhost 中运行良好：

```
var url = "ws://127.0.0.1:4507/";
var controller = "Chat";
var mensajes = $('#messages');
var mensaje = $('#message');

var ws = new XSockets.WebSocket(url + controller);

function send() {
    if (mensaje.val() != '') {
        ws.trigger('sendall', { message: mensaje.val() });
        mensaje.attr('value', '');
    }
}

$(function () {
    ws.bind(XSockets.Events.open, function () {
        console.log("opened");
    });
    ws.bind(XSockets.Events.close, function () {
        console.log("closed");
    });
    ws.bind(XSockets.Events.onError, function (err) {
        console.log("error", err);
    });
    ws.bind('sendall', function (mensaje) {
        console.log(mensaje);
        mensajes.prepend($('<div>').text(mensaje));
    });

    mensaje.on('keyup', function (e) {
        if (e.which == 13 || e.keyCode == 13) {
            e.preventDefault();
            send();
        }
    });

    $('#publish').click(function () {
        send();
    });
}); 
```

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T20:42:50.987

首先，您需要配置您的服务器以使 Uri 指向您的计算机地址*（不是 localhost，不是 127.0.0.1！）。然后这个：

```
var url = "ws://127.0.0.1:4507/"; 
```

需要与该地址完全匹配（可以是域名，但对于初学者，最好使用 ip）。

这个：

```
var ws = new XSockets.WebSocket(url + controller); 
```

需要看起来像这样：

```
var ws = new XSockets.WebSocket("ws://my.ip.add.res:myport/myController", myController, null); //null can contain an array of parameters that you want to send to a server, but if you are just starting, leave this with null 
```

此外，当我为我的配置而苦苦挣扎时，很多时候我咬着枕头，因为我尝试使用不同的端口而忘记了防火墙。所以不要忘记它。:)

我会在这里多呆 30-40 分钟，然后我要去睡觉，如果您有任何问题并会在这段时间内回复，我会留在这里并尽力帮助您，因为我也经历过这个，它疼得要命。:)

PS。您也可以联系开发人员`contact@xsockets.net`，他们真的很酷，一定会帮助您！

*编辑：*计算机地址*是指托管 xsockets 服务器的计算机。

# java - Storm中如何选择需要处理的stream源？

> ID：16042642
> 
> 赞同：1
> 
> 时间：2013-04-16T16:49:12.240
> 
> 标签：java, stream, rpc, apache-storm

我在 Storm 中为一件事而苦苦挣扎。所以整个想法是：

1.  向storm（可能是DRPC Server）发送请求。该请求将告诉 Storm 流的来源是什么。例如：我有两个文件`1 - '/var/log/syslog'`和`2- ' /var/log/udev`' 的图像。我希望能够将请求发送到“Storm”，告诉它要处理什么文件。

我不明白的是：

当我说向“风暴”发送请求时， - 我应该将它发送到哪里？（我假设 DRPC 服务器控制需要发送到拓扑的源。但是如何实现 DRPC 服务器？是否有类似的类`DRPCServer server = new DRPCServer()`？以及如何告诉 Spout 查看 DRPCServer？或者是请求需要直接发送到? if那么`Spout`如何让它开始使用指定的源呢？我的意思是我需要向`open()`方法发送请求吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T09:34:52.603

不是 DRPCServer，它的 DRPCClient

```
DRPCClient client = new DRPCClient("drpc-host", 3772); 
```

[我想你看到这个](https://github.com/nathanmarz/storm/wiki/Distributed-RPC)之后会很感兴趣

**更新：** 有关更多信息，您可以随时查看 nathanmarz 在 github 中的 Storm-starter 项目，尤其是[BasicDRPCTopology](https://github.com/nathanmarz/storm-starter/blob/master/src/jvm/storm/starter/BasicDRPCTopology.java)和[ReachTopology](https://github.com/nathanmarz/storm-starter/blob/master/src/jvm/storm/starter/ReachTopology.java)

# xml - Schematron 检查多个元素之间的唯一值

> ID：16042645
> 
> 赞同：0
> 
> 时间：2013-04-16T16:49:15.047
> 
> 标签：xml, schematron

我需要检查`siteId`整个文档中是否包含唯一记录 ID。例如：站点 11111 提交 id 为 1 和 2 和 3 和 4 的记录。站点 2222 提交记录 3 和 4。

好的：

```
<submission>
<site>
<siteId>11111</siteId>
<record><id>1</id></record>
<record><id>2</id></record>
</site>
<site>
<siteId>2222</siteId>
<record><id>3</id></record>
<record><id>4</id></record>
</site>
<site>
<siteId>1111</siteId>
<record><id>3</id></record>
<record><id>4</id></record>
</site>
</submission> 
```

坏的：

```
<submission>
<site>
<siteId>11111</siteId>
<record><id>1</id></record>
<record><id>2</id></record>
</site>
<site>
<siteId>2222</siteId>
<record><id>3</id></record>
<record><id>4</id></record>
</site>
<site>
<siteId>1111</siteId>
<record><id>3</id></record>
<record><id>4</id></record>
<record><id>4</id></record>
</site>
</submission> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-25T09:26:33.123

您的问题可以通过以下代码解决：-

```
 <iso:pattern id="site">
   <iso:rule context="id">
       <iso:assert test="count(id) != count(distinct-values(ancestor::site/record/id))">BAD</iso:assert>
   </iso:rule>
</iso:pattern> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T09:52:41.100

使用 count() 和 disting-values() 的测试模式取自这里：http://xml-buddy.com/xmltribune/?p=274[应该](http://xml-buddy.com/xmltribune/?p=274)是您正在寻找的。

# https - 反向代理告诉后端 SSL 被使用的事实标准是什么？

> ID：16042647
> 
> 赞同：39
> 
> 时间：2013-04-16T16:49:21.850
> 
> 标签：https, http-headers, reverse-proxy

我有一个反向代理，它在外部执行 HTTPS，但在内部执行 HTTP。

这意味着默认情况下，应用内 URL 将使用 HTTP 作为方案，因为这是联系它的方式。

代理如何告诉后端应该使用 HTTPS？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-04-16T16:49:21.850

代理可以向它接收的请求添加额外（或覆盖）标头并传递到后端。这些可用于将信息传达给后端。

到目前为止，我已经看到了一些用于在 URL 方案中强制使用 https 的方法：

```
X-Forwarded-Protocol: https
X-Forwarded-Ssl: on
X-Url-Scheme: https 
```

[维基百科](https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Common_non-standard_request_headers)还提到：

```
# a de facto standard:
X-Forwarded-Proto: https
# Non-standard header used by Microsoft applications and load-balancers:
Front-End-Https: on 
```

这是您应该添加到[apache](/questions/tagged/apache "显示标记为“apache”的问题")上的 VirtualHost 的内容：*其他代理应该具有类似的功能*

```
RequestHeader set X-FORWARDED-PROTOCOL https
RequestHeader set X-Forwarded-Ssl on
# etc. 
```

我认为最好将它们全部设置，或者设置一个有效并删除其他已知的。以防止邪恶的客户惹恼他们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-29T22:01:47.433

我花了几个小时在谷歌上搜索才能找到适合我的环境的神奇设置。我在码头应用服务器和 apache2 http 服务器前面有一个 SSL httpd Apache 反向代理。这个[答案](https://webmasters.stackexchange.com/a/107445/90232 "回答")实际上给了我有效的信息。对我来说，添加：

```
RequestHeader set "X-Forwarded-Proto" expr=%{REQUEST_SCHEME} 
```

到站点 conf 文件足以让目标在响应中构建链接时使用 https 而不是 http 作为协议。我尝试了`X-FORWARDED-PROTOCOL`上述方法，但没有奏效。希望这将有助于未来的谷歌搜索！

# c++ - 如何使用 NTL lib 将整数转换为 ZZ 数？

> ID：16042654
> 
> 赞同：1
> 
> 时间：2013-04-16T16:49:37.770
> 
> 标签：c++, ntl

这是问题。我需要将一些整数变量转换为 ZZ 类，反之亦然。我怎么能这样做？我尝试在整数之前使用 (ZZ) 或在 ZZ 类之前使用 (int) 但都失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:57:13.960

您还没有发布任何代码，但我相信您的问题可以在[这里](http://www.shoup.net/ntl/doc/tour-ex1.html)得到解答，逐字粘贴以供您娱乐：

也可以为 ZZ 分配一个 long 类型的值：

```
ZZ x;
x = 1; 
```

注意不能写

```
ZZ x = 1;  // error 
```

初始化 ZZ。相反，可以写

```
ZZ x = conv<ZZ>(1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-09T10:59:48.263

回答有点晚，但它可能会帮助那里的人。正如问题中所问的那样

> 我需要将一些整数变量转换为 ZZ 类，反之亦然

也在评论中

> 如果我想将 ZZ 中的整数转换回 'long' 类型怎么办？

这是答案，在 NTL 库中，工具名称空间中提供了转换。以下示例演示如何从 ZZ 转换回 long 反之亦然：

```
ZZ z1 = ZZ(2);
ZZ z2;
long a = 0;
conv(a, z1); //converts zz type to long

conv(z2,a); //converts long to zz type

cout << a; //prints 2

cout << zz2; //prints 2 
```

# java - 在 BufferedImage 中绘图困难

> ID：16042655
> 
> 赞同：1
> 
> 时间：2013-04-16T16:49:38.373
> 
> 标签：java, swing, paint, bufferedimage

我写了一个简单的 2D 游戏——推箱子（[http://www.game-sokoban.com/](http://www.game-sokoban.com/)）。我在屏幕上有一个二维字段。单独的JPanel Board 负责。

```
import java.awt.*;
import java.awt.image.BufferedImage;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.net.URL;
import javax.swing.ImageIcon;
import javax.swing.JPanel;
import java.util.ArrayList;
import java.util.Map;
import java.util.HashMap;
import java.io.IOException;
import java.util.Properties;

public class Board extends JPanel {

    private static final String CONFIG_FILE_NAME = "ImageConfig.txt";

    /** length px of a square cell */
    private static final int SPACE = 20;

    private Properties properties;

    private Map<Status, Image> Images = null;

    private Status[][] cells = null;

    private BufferedImage canvas = null;

    private Graphics2D g2d = null;

    public Board() {

        Properties properties = new Properties();
        try {
            //load a properties file
            properties.load(ClassLoader.getSystemResourceAsStream(CONFIG_FILE_NAME));
        }
        catch (IOException ex) {
            ex.printStackTrace();
        }

        Images = new HashMap<Status, Image>();
        for (String key : properties.stringPropertyNames()) {
            switch (key) {
                case "AREA" : {
                    Images.put(Status.AREA, null);
                    break;
                }
                case "BAGGAGE" : {
                    Images.put(Status.BAGGAGE, null);
                    break;
                }
                case "FREE" : {
                    Images.put(Status.FREE, null);
                    break;
                }
                case "SOKO" : {
                    Images.put(Status.SOKO, null);
                    break;
                }
                case "WALL" : {
                    Images.put(Status.WALL, null);
                    break;
                }
            }
        }
        this.properties = properties;
    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2d = (Graphics2D)g;
        g2d.drawImage(this.canvas, cells.length, cells[0].length, this);
    }

    public void setSize_(int height, int width) {
        canvas = new BufferedImage(width * SPACE, height * SPACE, BufferedImage.TYPE_INT_RGB);
        g2d = canvas.createGraphics();
        setPreferredSize(new Dimension(width * SPACE, height * SPACE));
        cells = new Status[height][width];
    }

    public void drawCell(int i, int j, Status status) {
        cells[i][j] = status;
        try {
            g2d.drawImage(getImage(cells[i][j]), j * SPACE, i * SPACE, this);
        }
        catch (Exception e) {
            e.printStackTrace();
        }
        repaint();
    }
} 
```

每次移动时，场上的玩家都会更新，只有两个或三个单元格。我不想重绘所有字段，并且只调用 g2d 上的 drawImage (...) 的一些调用，并且更改就在屏幕上显示。至于我来实现它（没有paintComponent（））？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T18:14:02.823

您可以利用剪辑来加快绘画过程。您可以使用方法设置剪辑`setClip()`。此外，还有一个重载版本，`repaint()`它需要参数来仅定义需要更新的区域。每当您打电话时，Swing 都会为您设置剪辑`repaint(x, y, width,height)`。然后在里面`paintComponent()`你可以选择尊重剪辑。你可以从`Graphics`with`getClipBounds()`方法中得到它。并只涂漆所需的区域。

查看[在 AWT 和 Swing 中的绘画以](http://www.oracle.com/technetwork/java/painting-140037.html)获取更多详细信息和示例。另请参阅[执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/summary.html)教程，有一个说明剪切绘画的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:02:44.323

使用类似的东西：

```
Rectangle rect = new Rectangle(i * SPACE, j * SPACE, SPACE, SPACE);
repaint(50L, rect); 
```

以 50 毫秒为单位的延迟对重绘过程来说是很好的。不确定 i,j 或 j,i。

# forms - 形式中的形式。Symfony

> ID：16042660
> 
> 赞同：0
> 
> 时间：2013-04-16T16:49:46.943
> 
> 标签：forms, symfony-1.4, propel

我使用 Symfony1.4 并推动我的应用程序。我有个问题。例如：我有一个数据库，我想在其中保存作者和书籍。我制定了以下方案：schema.yml

```
book:
    id: ~
    name: {type: varchar (100), required: true}

author:
    id: ~
    name: {type: varchar (100), required: true}

author_book:
    id_book: {type: integer, foreignTable: book, foreignReference: id, required: true, primaryKey: true, onDelete: cascade}
    id_author: {type: integer, foreignTable: author, foreignReference: id, required: true, primaryKey: true, onDelete: cascade} 
```

我想在添加作者的情况下，添加他写的书，而不离开添加作者的页面。这是一个简单的问题，但由于某种原因，我还没有找到解决方案。（我认为通过编写一个使用 ajax 加载“添加一本书”的形式的小部件来做到这一点，但不可能有现成的解决方案吗？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T07:13:34.630

您可以使用`sfForm::embedForm()`嵌入多种形式。看看这个文档：[http](http://symfony.com/legacy/doc/more-with-symfony/1_4/en/06-Advanced-Forms) ://symfony.com/legacy/doc/more-with-symfony/1_4/en/06-Advanced-Forms ，它被解释了。

# xslt - XSLT 将模板应用于树部分

> ID：16042664
> 
> 赞同：0
> 
> 时间：2013-04-16T16:49:56.243
> 
> 标签：xslt

我有 XML 树：

```
<text>
    <plain>abcd<c>efgh</c>ijklm</plain>
    <plain>nopq<c>rst</c>uvw<c>xyz</c></plain>
    <rp><first><c>asdasd</c>asf</first><second>asdasd</second></rp>
    <plain>aaaaa<c>bbbb</c>ccccc<c>xyz</c></plain>
</text> 
```

然后我的 XSLT 样式表中有代码（$product_text 包含上面的树）：

```
<xsl:template name="text_list">
<xsl:if test="$text_count &gt; 0">
    <xsl:apply-templates mode="text_item" select="$product_text/text">
        <xsl:sort select="@rating" order="descending" data-type="number" />
    </xsl:apply-templates>
</xsl:if>
</xsl:template>

<xsl:template mode="text_item" match="*">
    <div class="cmp-post">
        <xsl:copy-of select="./*" />
    </div>
</xsl:template> 
```

此片段按原样复制所有树。但我需要像这样替换/修改所有“c”节点：

```
<c>efgh</c>
to
<cmp attr="efgh">efgh</c>

<c>rst</c>
to
<cmp attr="rst">rst</c>
etc 
```

（已编辑）我期望的结果：

```
<div class="cmp-post">
    <plain>abcd<c attr="efgh">efgh</c>ijklm</plain>
    <plain>nopq<c attr="rst">rst</c>uvw<c attr="xyz">xyz</c></plain>
    <rp><first><c attr="asdasd">asdasd</c>asf</first><second>asdasd</second></rp>
    <plain>aaaaa<c attr="bbbb">bbbb</c>ccccc<c attr="xyz">xyz</c></plain>
</div> 
```

我应该如何修改 text_item 模板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:26:16.383

Basically, you want to do `apply-templates` instead of `copy-of`. `copy-of` just copies the node; it doesn't do template matching and invocation on the copied elements.

As such, you'll need a few additional templates to get what you want.

```
<!-- Copy attributes as-is -->
<xsl:template match="@*" mode="text_item">
    <xsl:copy-of select="."/>
</xsl:template>

<!-- By default, copy element and text as-is then apply matching on children -->
<xsl:template match="node()" mode="text_item">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()" mode="text_item"/>
    </xsl:copy>
</xsl:template>

<!-- For 'text' elements, use div instead of direct copy -->
<xsl:template match="text" mode="text_item">
    <div class="cmp-post">
        <xsl:apply-templates mode="text_item" />
    </div>
</xsl:template>

<xsl:template match="c" mode="text_item">
    <xsl:copy>
        <xsl:attribute name='attr'><xsl:value-of select="."/></xsl:attribute>
        <xsl:apply-templates mode="text_item" />
    </xsl:copy>
</xsl:template> 
```

(Note that the `@*` template is just for completeness. Your current input doesn't have any attributes, but if it did, this would copy them to the output.)

Running the above templates on your input with this as a caller

```
<xsl:template match="/">
    <xsl:apply-templates select="." mode="text_item">
  <xsl:sort select="@rating" order="descending" data-type="number" />
    </xsl:apply-templates>
</xsl:template> 
```

gives the output

```
<div class="cmp-post">
    <plain>abcd<c attr="efgh">efgh</c>ijklm</plain>
    <plain>nopq<c attr="rst">rst</c>uvw<c attr="xyz">xyz</c></plain>
    <rp><first><c attr="asdasd">asdasd</c>asf</first><second>asdasd</second></rp>
    <plain>aaaaa<c attr="bbbb">bbbb</c>ccccc<c attr="xyz">xyz</c></plain>
</div> 
```

It should be the same when called against a node variable.

# html - 为什么忽略左侧样式？

> ID：16042665
> 
> 赞同：2
> 
> 时间：2013-04-16T16:50:05.000
> 
> 标签：html, css, developer-tools

我在以下代码中的页面上有徽标

```
<h1 class="site-title">
   <a class="logo custom-logo" href="url" title="Go to Site"> 
      <img alt="Site" height="136" src="url" width="298"> 
   </a> 
</h1> 
```

我已将`left`属性添加到`logo`样式

```
.logo {
   display: inline-block;
   line-height: 1;
   vertical-align: middle;
} 
```

这个

```
left: 400px; 
```

但它被忽略了。Chrome`Developer tools`显示此样式处于活动状态，但图像显示在距浏览器窗口左侧零距离处。

为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T16:52:33.543

为了使`left, top, bottom, right`值生效，必须定位项目。

根据您的需要添加`position: absolute`或添加。`position: relative`

Absolute 将相对于它最近定位的父对象定位它。

相对将相对于自身定位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:53:32.337

您可以在 position:relative 的任一侧或将左侧填充设置为 400px

```
position:relative;
left: 400px; 
```

或者

```
padding-left:400px 
```

# php - 自动选择信用卡类型

> ID：16042670
> 
> 赞同：0
> 
> 时间：2013-04-16T16:50:15.040
> 
> 标签：php, sql, validation

我正在构建付款表格并希望自动选择第一个 4 位数字的信用卡类型我在 Visa Master AMEX Discover 上有有效范围

这里是 Discover one 的一个例子

```
validRanges":["6282","6283","6284","6285","67","66","6287","6286","6288","64","65","63888","6011","622","624","625","626"] 
```

我如何构建自动选择发现卡并出现发现图标并消除其他图标的输入

有人这样想

[https://www.panic.com/coda/buy.html](https://www.panic.com/coda/buy.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:57:02.750

你肯定需要 Javascript 来实现这种效果。假设您将该数据存储在服务器上（可能在数据库中），您将需要*AJAX*来查询数据库并确定输入的数字是否在数据库中的任何范围内。

对于 Javascript 部分，我建议您看一下[jQuery](http://jquery.com)：特别[`jQuery.ajax()`](http://api.jquery.com/jQuery.ajax/)是函数[`.fadeTo()`](http://api.jquery.com/fadeTo/)。

您要实现的基本思想基本上如下：

1.  检测任何用户数字输入
2.  获取`<input>`输入并将其（通过[AJAX](https://en.wikipedia.org/wiki/Ajax_%28programming%29)）发送到 PHP 脚本`x.php`
3.  `x.php`处理输入的数据（可能通过 POST 方法发送）并查询数据库，将卡片类型的[JSON](http://en.wikipedia.org/wiki/JSON)数组返回给客户端
4.  客户端将 JSON 字符串转换为实际的 JSON 对象，并使用它来隐藏或显示代表卡片的特定 div。

# ruby-on-rails - 克隆/复制对象的路由生成异常

> ID：16042671
> 
> 赞同：0
> 
> 时间：2013-04-16T16:50:15.527
> 
> 标签：ruby-on-rails, ruby, mongoid

我有以下对象

```
class BaseProject
  include Mongoid::Document
end 
```

现在假设我想通过创建它的副本`dup/clone`

```
p1 = Project.first
p2 = p1.clone #p1.dup has the same effect
project_path(p1) #works fine generating /projects/87358736587365 path
project_path(p2) #does not work resulting in an error 
```

`No route matches {:action=>"my_action", :controller=>"projects", :id=>#Project{}....`

请注意，`:id`参数是整个`p2`对象哈希，而不仅仅是一个`id`

这可能与mongoid有关。两者都`dup`产生`clone`相同的结果。我知道`ActiveRecord`这些版本的不同并`mongoid`重新定义了这些版本

**更新 1**

原来只有`persisted?`等于的对象`true`才能生成路由，因为需要`to_param`in`Journey::Routing`才能生成有效的路由。

我面临的问题是我无法持久化一个对象，因为它没有通过验证。我想我必须伪造返回的路线`/projects/new`才能解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:34:03.040

无法为未持久化的对象生成路由，即使对象被复制/克隆并且具有有效的`id`

# php - 我可以在不破坏 Google 分析跟踪的情况下排除特定国家/地区的用户吗？

> ID：16042674
> 
> 赞同：0
> 
> 时间：2013-04-16T16:50:18.887
> 
> 标签：php, geolocation, ip

我真的需要阻止美国访问者继续在我们仅限英国的网站上购买产品。我们从美国的 IP 那里得到了很多欺诈。我已经准备好上线这个不错的解决方案，但它会阻止 Google Analytics 和任何其他基于美国的跟踪脚本在我的网站上运行吗？有没有人有更好的解决方案？

```
 // Cut non UK countries out of going any further:
$ip = $_SERVER['REMOTE_ADDR'];
$country = getCountryFromIP($ip, " NamE ");

if (strtolower($country) == "united states") {
    $pageOutput =  file_get_contents("country.exclusion.html");
    $pageOutput = str_replace("<quote:site-wide-footer-tracking.html>", file_get_contents("../static-includes/site-wide-footer-tracking.php"), $pageOutput ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:23:10.547

我认为这样做的更好方法是阻止美国用户完成某些操作：

*   阻止他们将产品添加到购物篮
*   在产品页面上隐藏任何“添加到购物车”按钮并将其替换为一些简单的“该产品在您的国家/地区不可用”文本。

这将阻止他们购买产品，但仍确保 Google 和其他美国实体可以不受限制地浏览您的网站。

# ios - 从模态控制器刷新 UIViewController

> ID：16042675
> 
> 赞同：0
> 
> 时间：2013-04-16T16:50:19.317
> 
> 标签：ios

我有一个显示轮播控件（iCarousel）的视图控制器。正确渲染视图并显示轮播。之后立即显示一个模式，允许用户同意某些条款。我希望一旦他们同意我刷新包含轮播控件的视图控制器。基本上，我想将轮播旋转到某个随机索引。

```
- (IBAction)accept:(id)sender
{
    NewsViewController *newsViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"NewsStoryboard"];

    [newsViewController loadNews];  
    [newsViewController.view setNeedsDisplay]; 

    [self dismissViewControllerAnimated:YES completion:nil];
} 
```

上面的代码确实调用了 loadNews 并获取它，但视图永远不会刷新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T16:56:14.493

carousel 发生的事情应该取决于管理它的视图控制器，而不是模态视图控制器。让模态控制器做它的事情并将它收集到的任何数据返回给它的父级。然后父级（在本例中为轮播的控制器）可以查看该数据并决定下一步需要做什么（例如刷新）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:56:17.150

问题是这一行：

```
 NewsViewController *newsViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"NewsStoryboard"]; 
```

那不是旧的视图控制器；它是该视图控制器的一个新的、未使用的*副本*。您需要创建一条从模态视图控制器返回到*现有*视图控制器的通信线路。

执行此操作的典型方法是通过您在创建模式视图控制器时设置的委托。如果您查看 Xcode Utility 模板，您会发现它说明了这种架构。原始视图控制器将自己设置为模态视图控制器的委托，因此模态视图控制器能够在其被解除时与原始视图控制器对话。

这是一件非常重要的事情，我在书中详细讨论了它：

[http://www.aeth.com/iOSBook/ch19.html#_presented_view_controller](http://www.apeth.com/iOSBook/ch19.html#_presented_view_controller)

# asp.net-mvc-3 - 数据 URI 和潜在危险的 Request.Path 值

> ID：16042676
> 
> 赞同：3
> 
> 时间：2013-04-16T16:50:34.663
> 
> 标签：asp.net-mvc-3, security, data-uri

我尝试使用带有此 CSS 属性的数据 URI：

```
background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA9JREFUeNpiYGBg8AUIMAAAUgBOUWVeTwAAAABJRU5ErkJggg=="); 
```

在本地它工作正常。但是，当我调试该文件时，chrome 中似乎丢失了。如果我尝试导航到它，我会得到：从客户端 (:) 检测到潜在危险的 Request.Path 值。

所以很明显，我的应用程序认为这张图片的 URI 很可疑。

我如何让它显示？我尝试使用以下方法放松验证：

```
<httpRuntime requestPathInvalidCharacters="" requestValidationMode="2.0" />
<pages validateRequest="false"></pages> 
```

理想情况下，我不想过多地放松规则，只要足以让这些数据 URI 图像加载即可。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:47:17.687

我敢打赌，由于使用 Base-64 编码的 URI，应用程序认为请求可疑。在 Base-64 中编码恶意 URL 是攻击者通过去除和/或转义 URL 的前端过滤器获取 URL 并隐藏任何阅读代码的人的请求的常用策略。XSS 攻击通常通过将这些 URI 之一存储在数据库中并返回给其他用户来完成。

由于这些天 XSS 的高风险，我会犹豫禁用检查。如果可以，只需使用未编码的 URI。如果你不能，你应该问问自己为什么。如果您试图通过混淆 URI 来增强安全性，请知道这对于攻击者来说非常容易解码。它*不是*任何形式的加密，只是表示数据的不同方式。

# android - Caldroid、ActionBarSherlock 和 Maven

> ID：16042687
> 
> 赞同：1
> 
> 时间：2013-04-16T16:51:08.310
> 
> 标签：android, actionbarsherlock, caldroid

我正在尝试在我之前包含在 Maven 托管结构下的简单 HelloWorld 应用程序中使用[Caldroid 。](http://github.com/thomasdao/Caldroid)`ActionBarSherlock`

因为我需要为 ABS 和 Caldroid 使用支持包，所以我希望 Caldroid 使用相同的支持包。目前，它是最新的：`support-v4-r7.jar`

但是，在 Eclipse 中，我无法`getChildFragmentManager()`说该方法在`CaldroidFragment`. 因此，我无法继续。

另外，我不知道是否应该移植 Caldroid 的每个类来扩展 ABS 类以便正确使用。例如：

```
public class CaldroidFragment extends DialogFragment    
to
public class CaldroidFragment extends SherlockDialogFragment 
```

有什么想法可以整合它们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T16:28:40.190

我刚刚想出了如何使 Caldroid 与 ActionbarSherlock 一起工作（没有任何错误）。

1.  导入 ActionbarSherlock 库和 Caldroid 库。

2.  然后从**ActionbarSherlock 的 libs 文件夹中删除****support v4 jar**

***   添加**caldroid 作为 ActionbarSherlock 的依赖项**。

    *   将 ActionbarSherlock 添加为您的应用程序的依赖项。** 

 **现在，一切都会正常工作，没有任何错误！**

# hibernate - 如何使用 hibernate 为 erai 项目配置数据库

> ID：16042688
> 
> 赞同：0
> 
> 时间：2013-04-16T16:51:11.750
> 
> 标签：hibernate, errai

嗨，我正在创建 erai web 服务。我必须为这个项目配置数据库，但尝试了 erai kitchensink 但数据库配置不起作用。请建议解决方案。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T08:16:47.883

我真的很好奇你为什么要这么多地参与`Errai`数据库（通过`Hibernate`），`Errai`是一个**客户端/服务器总线**，你用它来来回传输数据，数据库访问通常应该在服务器端单独完成。您需要为`DAO`将由您的服务器端`Errai`服务实现调用的对象创建一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T23:14:54.883

你能说： 1.- 你正在使用的 Web 容器/应用服务器吗？

2.- 你把persistence.xml 放在哪里？

请展示：

1.-你的 persistence.xml 配置。

2.-配置数据库驱动程序的 xml。

3.-如果可以的话，一些 dao 和它的实现。

4.-堆栈跟踪，如果是这样的话。

# filter - 角度过滤解码字符

> ID：16042696
> 
> 赞同：0
> 
> 时间：2013-04-16T16:51:25.927
> 
> 标签：filter, angularjs, decode

在角度，如果

```
$scope.myStr = '&trade;'; 
```

{{myStr}} 产生 '$trade;' 而不是 TM 标记，我将如何使用过滤器解决这个问题？

在某些情况下，$amp;trade；也出现了，所以我绝对需要一个过滤器来运行程序，最终我希望能够在没有 dom 操作的情况下{{}}得到结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:07:10.810

您可以使用`ngBindUnsafeHtml`：http: [//jsfiddle.net/Xnp3J/](http://jsfiddle.net/Xnp3J/)

```
<div ng-app ng-controller="x">
    <span ng-bind-html-unsafe="myStr"></span>
</div> 
```

-

```
function x($scope) {
    $scope.myStr = '&trade;';
} 
```

# java - 如何查找（JDBC）JNDI 资源？

> ID：16042698
> 
> 赞同：2
> 
> 时间：2013-04-16T16:51:28.893
> 
> 标签：java, tomcat, jndi

我们有一个部署在 tomcat 服务器（v5.5 和 v6）上的**个人 java 库。**该库与许多 Web 应用程序共享，因此它部署在 tomcat 目录下的 shared/lib 上。

Exceptionaly，我必须在这个库中创建一个新类，它通过 JNDI 查找 jdbc 数据源。

为此，这里是我的代码：

```
Context initCtx = new InitialContext();
Context envCtx = (Context) initCtx.lookup("java:comp/env");
DataSource dataSource = (DataSource) envCtx.lookup("jdbc/corp.xx.xx.xxxxDS"); 
```

所有上下文都毫无问题地实例化。但是当它查找 jdbc 数据源时，我有一个异常： Name jdbc not Found in Context

我们不在网络应用程序中，这是一个问题吗？是否可以使用 ResourceLink 声明 context.xml ？如何 ？

注意：jndi 在 server.xml 中设置（GlobalNamingResources 中的资源）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T13:40:36.437

```
<Context ...>
  ...
  <ResourceLink name="linkToGlobalResource"
            global="simpleValue"
            type="java.lang.Integer"
  ...
</Context> 
```

其中*name*是新名称（相对于 java:comp/env 的名称），*global*是 server.xml 中配置的全局 jndi 名称

因此，从您的代码中查找**linkToGlobalResource**将为您提供**链接的全局资源**

参考：http: [//tomcat.apache.org/tomcat-5.5-doc/config/context.html#Resource_Links](http://tomcat.apache.org/tomcat-5.5-doc/config/context.html#Resource_Links)

**答案更新：**

您的 JNDI 访问将来自 web-app 而不是共享 jar，因为独立 jar 没有上下文的概念。

# arrays - 将序号分配给数组中的整数元素

> ID：16042700
> 
> 赞同：1
> 
> 时间：2013-04-16T16:51:32.397
> 
> 标签：arrays, matlab, replace, sequential

早安/午安~

我有一个这样的数组，

```
A= [12 0 0 0 0 3 0 0 0 66 0 0 0 0 20 0 0 2 0 31 0 0  42 0 32 0 38] 
```

输出应该是：

```
B= [ 1 0 0 0 0 2 0 0 0 3  0 0 0 0  4 0 0 5 0  6 0 0  7  0 8  0 9] 
```

我应该怎么做才能用序号替换 A 中的非零元素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T16:56:07.667

这将做到：

```
A(A ~= 0) = 1:nnz(A) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:32:06.693

```
B = cumsum(A ~= 0) .* (A ~= 0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:00:24.073

```
A(ismember(A,A(A(:) ~=0))) = 1:numel(A(A(:) ~=0)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:25:08.043

With the image processing toolbox (will give the same label to adjacent non-zero values, though):

```
B = bwlabel(A) 
```

# php - Magento - 使用 cronjob 将产品（使用 Dataflow）导出到 CSV

> ID：16042701
> 
> 赞同：1
> 
> 时间：2013-04-16T16:51:34.907
> 
> 标签：php, xml, magento, dataflow

我想每晚将 Magento 产品导出为 CSV 文件。Magento 中的数据流运行良好，但我无法使用它设置 cronjob。CSV 布局应与数据流导出相同。

你知道我该如何解决吗？我为此搜索了很多，但似乎以前没有人问过这个问题。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T11:12:39.650

也许以下链接可以满足您的需求：

[http://www.magentocommerce.com/boards/viewthread/113901/P30/#t277875](http://www.magentocommerce.com/boards/viewthread/113901/P30/#t277875)

希望能帮助到你。

问候，亚历山德罗

# matlab - Matlab 中的 Visual Studio 2012 编译器更新

> ID：16042703
> 
> 赞同：2
> 
> 时间：2013-04-16T16:51:43.190
> 
> 标签：matlab, visual-studio-2012

Visual Studio 2012 编译器 2012 年 11 月 CTP (VS2012+) 允许访问新的 C++11 功能。我想使用 VS2012+ 从 Matlab 2013a 构建 mex 文件；Matlab 2013a 支持普通的VS2012。是否可以使用 VS2012+ 构建 Matlab 2013a？

Visual Studio 2012 编译器 2012 年 11 月 CTP： [http ://www.microsoft.com/en-us/download/details.aspx?id=35515](http://www.microsoft.com/en-us/download/details.aspx?id=35515)

**附加信息：** 在 Visual Studio 2012 中，编译器更新通过进入项目设置激活，然后选择平台工具集为“Microsoft Visual C++ Compiler Nov 2012 CTP (v120_CTP_Nov2012)”。默认平台工具集是“Visual Studio 2012 (v110)”。我本来希望在编译器或链接器开关中看到这一点，但我无法发现任何差异。关键问题是如何通知 Visual Studio 2012 从命令行执行相同操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T11:24:33.950

Visual Studio 2012 Compiler Nov 2012 CTP 是一个单独的可执行文件，位于

```
C:\Program Files (x86)\Microsoft Visual C++ Compiler Nov 2012 CTP 
```

bin 子目录包含 cl.exe，它是新的编译器。Visual Studio 2012 安装目录中存在同名文件。要使 Matlab 引用更新的编译器，请打开（在纯文本编辑器中）文件

```
C:\Program Files\MATLAB\R2013a\bin\win64\mexopts\msvc110opts.bat 
```

并在编译器参数之前添加以下内容：

```
rem Override the compiler selection.
set COMPILERUPDATEDIR=C:\Program Files (x86)\Microsoft Visual C++ Compiler Nov 2012 CTP
set PATH=%COMPILERUPDATEDIR%\bin\amd64;%COMPILERUPDATEDIR%\bin;%PATH% 
```

这是有效的，因为 cl.exe 在 PATH 变量中是从左到右搜索的。

## 本地与全局选项文件

请注意，mexopts 目录中的选项文件不被 Matlab 直接使用；相反，它们被获取本地副本，然后将它们用作实际的选项文件。跑步时

```
mex -setup 
```

Matlab 获取全局选项文件的本地副本，并将其放置在可以通过运行带有 -v 选项的 mex 获得的目录中。这是默认选项文件。因此，如果您使用默认选项文件，则需要运行 mex -setup 以查看更改。

或者，您可能希望自己获取全局选项文件的本地副本，然后通过 mex 中的 -f 选项指定选项文件。这样你就不需要修改官方的选项文件了。

# c - 是否有可能某些网络数据包带有空字节？

> ID：16042704
> 
> 赞同：0
> 
> 时间：2013-04-16T16:51:47.670
> 
> 标签：c, network-programming

在网络编程中，我们通常使用`recv()`or`recvfrom()`来接收数据包，其中一个参数是字符串缓冲区，例如

```
 char buf[2000];
 recv(sockfd, buf, len, 0); 
```

我想知道数据包中是否有一些空字节（`0`或`\0`），如果有，如何处理？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:56:14.127

当然有可能。如何处理它们取决于通信协议。

但请记住，[recv](http://linux.die.net/man/2/recv)返回接收到的字节数，它可以小于缓冲区大小。

# dictionary - 如何以地图为参数调用 Freemarker 宏？

> ID：16042706
> 
> 赞同：2
> 
> 时间：2013-04-16T16:51:49.613
> 
> 标签：dictionary, parameters, macros, freemarker

我一直在闲逛，但找不到任何文档或示例代码。

# 介绍：

我有一个具有此键/值映射的 ftl 页面：

*   roomType.description["ES"] = "texto"
*   roomType.description["EN"] = "一些文字"
*   roomType.description["PT"] = "texto"

# 问题：

如何将地图作为参数传递给freemarker宏？

# 示例代码：

### 宏声明

```
<#macro descriptionMacro firstLang descriptionText>
    <#-- SOME CODE -->
    <textarea>
        <#if descriptionText[firstLang]??>
            ${descriptionText[firstLang]?trim}
        </#if>
    </textarea>
    <#-- SOME OTHER CODE -->
</#macro> 
```

### 宏调用（不工作）

```
<@descriptionMacro firstLang="es" descriptionText=roomType.description/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:27:00.740

我在您的代码中看到的唯一问题是映射中的键是大写的（“EN”、“ES”、“PT”），并且您尝试使用小写键“es”访问模板中的值”。

`Map`除此之外，我认为使用 a作为参数没有任何限制。

例如给定这张地图：

```
 Map<String, String> description = new HashMap<>();
  description.put("en", "Some text");
  description.put("es", "Testo");
  description.put("fr", "Texte");

  Map<String, Object> data = newHashMap();
  data.put("description", description);

  Template template = getTemplate();
  Writer out = new StringWriter();
  template.process(data, out); 
```

这个模板：

```
<#macro printDescription lang data>
    Description = ${data[lang]}
</#macro>
<@printDescription lang="es" data=description /> 
```

输出是：

```
Description = Testo 
```

# html - 在 html5 应用程序中使用图像和文本的常用方法

> ID：16042708
> 
> 赞同：0
> 
> 时间：2013-04-16T16:51:55.030
> 
> 标签：html, image

我想通过 Phonegap 构建一个 HTML5 应用程序，比如移动网站。我想知道在应用程序中嵌入带有文本的按钮的最佳方式是什么。问题是，它是响应式的，因此很难将图像作为背景并使用 html 文本。另一方面，如果设备的屏幕变大，图像可能会变得分散。另一点是几个图像需要的数据量。

在 HTML5 应用程序中使用带有文本的按钮的常用方法是什么？

谢谢 ：）

# objective-c - 嵌套 NSDictionary 描述转义字符问题

> ID：16042714
> 
> 赞同：6
> 
> 时间：2013-04-16T16:52:12.540
> 
> 标签：objective-c, escaping, nested, nsdictionary

我正在尝试打印出我保存在层次结构中的多个字典中的对象化 JSON 结构。我想通过 NSObject 的`description`方法来做到这一点，以便每个嵌套字典的描述方法也被调用并返回其值。

**期望的结果**

```
 //First Hierarchal Level
                //Second Hierarchal Level
                        //Third Hierarchal Level
People = 
(
    {
        Name = Person 1
        Gender = Male
        Addresses =
        (   
            {
                Address Name = Home Address
                Street = 123 Street St.
                City = NewCity
                State = AZ
                Zip = 12345
                Country = USA
             }
        )
        Cars = 
        (   
            {
                Make = Ford
                Model = NewFord
                Insured Drivers = 
                (
                    {
                        Name = Person 1
                    },
                    {
                        Name = Person 2
                    }
                )
            }
        )   
    }
)

//NOTE: Sample untested nested structure 
```

但是，我遇到了一个问题，即每个嵌套字典的返回字符串对于返回字符串通过的层次结构的每个级别都被转义一次。

**实际结果**

```
People = \n (\n {\n Name = Person 1\\\n Gender = Male\\\n Addresses =\\\n ( \\\n {\\\n Address Name = Home Address\\\n Street = 123 Street St.\\\n City = NewCity\\\n State = AZ\\\n Zip = 12345\\\n Country = USA\\\n }\\\n )\\\n Cars = \\\n ( \\\n {\\\\\\\n Make = Ford\\\\\\\n Model = NewFord\\\\\\\n Insured Drivers = \\\\\\\n (\\\\\\\n {\\\\\\\\\\\\\n Name = Person 1\\\\\\\\\\\\\n },\\\\\\\\\\\\\n {\\\\\\\\\\\\\n Name = Person 2\\\\\\\\\\\\\n }\\\\\\\n )\\\\\\\n }\\\n ) \n }\n ) 
```

我已经读到这与描述如何添加这些转义字符有关，因为它使用了类似 syslog 实用程序的东西，但是我相信我想要的功能是可用的，因为 NSArray 如何以与我想。我尝试遍历结果字符串并解析转义字符，但到目前为止，我想出的最好结果是所有字典中所有属性的非分层列表。

**最佳尝试**

```
People = 
(
{
Name = Person 1
Gender = Male
Addresses =
( 
{
Address Name = Home Address
Street = 123 Street St.
City = NewCity
State = AZ
Zip = 12345
Country = USA
}
)
Cars = 
( 
{
Make = Ford
Model = NewFord
Insured Drivers = 
(
{
Name = Person 1
},
{
Name = Person 2
}
)
}
) 
}
) 
```

我想知道是否有其他人遇到过这个问题以及他们是如何克服它的。

欢迎任何和所有建议。感谢您的关注。

更新 1：根据评论中的建议，我尝试使用以下 NSDictionary 类别方法将我的字典对象解析为 JSON 字符串以进行打印：

```
-(NSString*)JSONDescription
{
    NSError *error;
    NSData* jsonData = [NSJSONSerialization dataWithJSONObject:self options:NSJSONWritingPrettyPrinted error:&error];
    NSString* json = nil;

    if (! jsonData) {
        NSLog(@"WARNING: NSDictionary JSONDescription encountered error \"%@\"", error);
    } else {
        json = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];
    }

    return json;
} 
```

然后，在我的层次结构的每一层，我`JSONDescription`在每个`description`方法中调用我的字典对象。但是，似乎没有`description`调用嵌套对象的方法。这导致以下异常：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'Invalid type in JSON write (Address)' 
```

**示例实现**

```
#import "Person.h"

#define NAME @"Name"
#define GENDER @"Gender"
#define ADDRESSES @"Addresses"
#define CARS @"Cars"

@implementation Person

-(NSDictionary*)toDictionary{
    return @{ NAME: self.name,
              GENDER: self.gender,
              ADDRESSES: self.addresses,
              CARS: self.cars};
}

-(NSString*)description{
    return self.toDictionary.JSONDescription;
}

@end

#import "Address.h"

#define ADDRESS_NAME @"Address Name"
#define STREET @"Street"
#define CITY @"City"
#define STATE @"State"
#define ZIP @"Zip"
#define COUNTRY @"Country"

@implementation Address

-(NSDictionary*)toDictionary{
    return @{ ADDRESS_NAME: self.addressName,
              STREET: self.street,
              CITY: self.city,
              STATE: self.state,
              ZIP: self.zip,
              COUNTRY: self.country};
}

-(NSString*)description{
    return self.toDictionary.JSONDescription;
}

@end

#import "Car.h"

#define MAKE @"Make"
#define MODEL @"Model"
#define INSURED_DRIVERS @"Insured Drivers"

@implementation Car

-(NSDictionary*)toDictionary{
    return @{ MAKE: self.make,
              MODEL: self.model,
              INSURED_DRIVERS: self.drivers};
}

-(NSString*)description{
    return self.toDictionary.JSONDescription;
}

@end

#import "Driver.h"

#define NAME @"Name"

@implementation Car

-(NSDictionary*)toDictionary{
    return @{ NAME: self.name};
}

-(NSString*)description{
    return self.toDictionary.JSONDescription;
}

@end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T19:30:24.267

以下方法可能不是最优雅的，但它似乎产生了所需的输出：

```
@interface NSObject (MyPrettyPrint)
- (NSString *)prettyPrint;
@end

// === ADDED CODE FOR CUSTOM OBJECTS (1) ===
@protocol ObjectToDictionary <NSObject>
-(NSDictionary *)toDictionary;
@end
// === END OF ADDED CODE (1) ===

@implementation NSObject (MyPrettyPrint)

- (NSString *)prettyPrint
{
    BOOL isColl;
    return [self prettyPrintAtLevel:0 isCollection:&isColl];
}

- (NSString *)prettyPrintAtLevel:(int)level isCollection:(BOOL *)isCollection;
{

// === ADDED CODE FOR CUSTOM OBJECTS (2) ===
    if ([self respondsToSelector:@selector(toDictionary)]) {
        NSDictionary *dict = [(id <ObjectToDictionary>)self toDictionary];
        return [dict prettyPrintAtLevel:level isCollection:isCollection];
    }
// === END OF ADDED CODE (2) ===

    NSString *padding = [@"" stringByPaddingToLength:level withString:@" " startingAtIndex:0];
    NSMutableString *desc = [NSMutableString string];

    if ([self isKindOfClass:[NSArray class]]) {
        NSArray *array = (NSArray *)self;
        NSUInteger cnt = [array count];
        [desc appendFormat:@"%@(\n", padding];
        for (id elem in array) {
            BOOL isColl;
            NSString *s = [elem prettyPrintAtLevel:(level+3) isCollection:&isColl];
            if (isColl) {
                [desc appendFormat:@"%@", s];
            } else {
                [desc appendFormat:@"%@   %@", padding, s];
            }
            if (--cnt > 0)
                [desc appendString:@","];
            [desc appendString:@"\n"];
        }
        [desc appendFormat:@"%@)", padding ];
        *isCollection = YES;

    } else if ([self isKindOfClass:[NSDictionary class]]) {
        NSDictionary *dict = (NSDictionary *)self;
        [desc appendFormat:@"%@{\n", padding];
        for (id key in dict) {
            BOOL isColl;
            id value = dict[key];
            NSString *s = [value prettyPrintAtLevel:(level+3) isCollection:&isColl];
            if (isColl) {
                [desc appendFormat:@"   %@%@ =\n%@\n", padding, key, s];
            } else {
                [desc appendFormat:@"   %@%@ = %@\n", padding, key, s];
            }
        }
        [desc appendFormat:@"%@}", padding ];
        *isCollection = YES;

    } else {
        [desc appendFormat:@"%@", self];
        *isCollection = NO;
    }

    return desc;
} 
```

*例子：*

```
NSDictionary *dict = @{@"People": @[
    @{
        @"Name": @"Person 1",
        @"Gender": @"Male",
        @"Addresses": @[
            @{
                @"Address Name": @"Home Address",
                @"Street": @"123 Street St.",
                @"Zip": @12345
            },
        ],
        @"Cars": @[
           @{
                @"Make": @"Ford",
                @"Model": @"NewFord",
                @"Insured Drivers": @[
                    @{@"Name": @"Person 1"},
                    @{@"Name": @"Person 2"},
                ]
            },
        ],
   },

]};

NSLog(@"People =\n%@", [dict[@"People"] prettyPrint]); 
```

*输出：*

```
人=
(
   {
      姓名 = 人 1
      性别 = 男
      汽车 =
      (
         {
            型号 = 纽福特
            制造 = 福特
            受保司机 =
            (
               {
                  姓名 = 人 1
               },
               {
                  姓名 = 人 2
               }
            )
         }
      )
      地址 =
      (
         {
            邮编 = 12345
            地址名称 = 家庭地址
            街 = 123 街街。
         }
      )
   }
)

```

# drupal - Drupal db_query 获取所有行

> ID：16042716
> 
> 赞同：0
> 
> 时间：2013-04-16T16:52:25.313
> 
> 标签：drupal, drupal-modules

我开始为 Drupal 构建主题。

我有一个关于drupal查询的问题，但我没有找到任何答案......

我的一个模块中有一个 db_query，但只返回几行（总是 13 行，表有 20 行）如何从一个表中选择所有行？

我的查询是这样的

```
$result = db_query("SELECT * FROM bv_calendar c INNER JOIN bv_countries p ON c.country_id = p.country_id INNER JOIN bv_vaccinate v ON c.vaccinate_id = v.vaccinate_id ORDER BY $orderby ASC");

while ($class = $result->fetchAssoc()) {
    $classes[$class["calendar_id"]] = $class;
} 
```

如何获取所有行？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:17:45.600

From the looks of it I'd say you're not getting all the rows from the *bv_calendar* because you're using **INNER JOIN** on your SQL query which requires to be matching records on your *bv_countries* and *bv_vaccinate* tables.

Try replacing the **INNER JOIN** for **LEFT JOIN** as in the later "*If there is no matching row for the right table in the ON or USING part in a LEFT JOIN, a row with all columns set to NULL is used for the right table.*" from [http://dev.mysql.com/doc/refman/5.0/en/join.html](http://dev.mysql.com/doc/refman/5.0/en/join.html).

If that's the result you want then your SQL query should be:

```
SELECT * FROM bv_calendar c LEFT JOIN bv_countries p ON c.country_id = p.country_id LEFT JOIN bv_vaccinate v ON c.vaccinate_id = v.vaccinate_id ORDER BY $orderby ASC 
```

# jquery - 重置表单域，除了一个

> ID：16042720
> 
> 赞同：4
> 
> 时间：2013-04-16T16:52:33.937
> 
> 标签：jquery

我正在尝试重置除一个之外的所有表单字段。

```
$(':input','#myForm').not(':button, :submit, :reset, :hidden, input[ignoreField]').val('').removeAttr('checked').removeAttr('selected'); 
```

如何排除带有“ignoreField”类的输入？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:54:04.980

您可以使用 - `input[class=ignoreField]`

```
$(':input','#myForm').not(':button, :submit, :reset, :hidden, input[class=ignoreField]') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:54:55.383

```
$(':input','#myForm').not('.ignoreField').val('').removeAttr('checked').removeAttr('selected'); 
```

# php - 如何使用按 DESC 排序的主键创建 MySQL 表并在插入新行后保持这种状态？

> ID：16042721
> 
> 赞同：0
> 
> 时间：2013-04-16T16:52:36.400
> 
> 标签：php, mysql, sorting, sql-order-by, primary-key

我需要创建一个`InnoDB`表，用于向其中添加数据并不断获取**最近**添加的 10 行。为了避免必须对*每个*`ORDER BY`查询执行一次以获得最后 10 行，我希望表本身按顺序排序，以便我可以完全跳过并只执行 a ，这应该会自动拉出最近的 10 行添加到表中。 *`SELECT``Primary Key``DESC``ORDER BY``SELECT ... LIMIT 10`*

 *我怎样才能做到这一点？是否像添加`ORDER BY [PRIMARYKEY] DESC`到`CREATE TABLE`查询一样简单？即使在ing 新行之后，表格还会**继续**按顺序排序吗？`DESC``INSERT`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:30:10.313

A RDBMS never provides any guarantees on the order of the rows in any of the tables it manages. The only way to get a specific order is to ask for one. For the case of MySQL, the rows happens to be sorted by the primary key in ascending order often time when that key is in auto increment mode, but it's not a guaranteed property.

Use `ORDER BY` on your queries to get the desired result.

On the other hand, the ordering will be faster if the primary key type is BTREE (which is the default on most engine).

The sorting direction [isn't yet used on MySQL 5.5](http://dev.mysql.com/doc/refman/5.5/en/create-index.html).*

# cuda - cuda 内核在什么设备上运行

> ID：16042723
> 
> 赞同：1
> 
> 时间：2013-04-16T16:52:39.433
> 
> 标签：cuda, optix

有什么方法可以从内核（GPU 代码）找出代码在哪个设备上运行？您可以找到 blockIdx、threadIdx、blockDim 和 gridDim，但有什么方法可以找到 CUDA 设备 ID？

对于那些想知道的人，我计划在 OptiX 程序中使用它来更好地控制 OptiX 缓冲区。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-11T19:05:22.710

这在 OptiX 3.0 和 3.5 中有效，但我不能保证它会一直有效。我们应该在未来的版本中为此提供一个真正的 API。

```
namespace rti_internal_register
{
    __device__ unsigned reg_device_id;
}

rtBuffer<uchar4, 2> output_buffer;

RT_PROGRAM void pinhole_camera()
{
    if( rti_internal_register::reg_device_id == 0 )
        output_buffer[launch_index] = make_color( make_float3( 0.5, 0.0, 0.0 ) );
    else
        output_buffer[launch_index] = make_color( make_float3( 0.0, 0.5, 0.0 ) );
} 
```

# php - for循环从组合框中扣除一个值

> ID：16042726
> 
> 赞同：0
> 
> 时间：2013-04-16T16:52:45.103
> 
> 标签：php, for-loop, combobox

我有一个显示座位号的动态组合框。我有一个从组合框中扣除选定值的 for 循环。

```
function display_seatNo() {
 $query = "SELECT * FROM table1 WHERE ID = 1";
 $result = mysql_query($query) or die("Failed to fetch records");
 $rows = mysql_fetch_array($result);
 $seatNo = $rows['SeatNo']; 
 $totalSeat = $rows['TotalSeats'];
 $seatReserved = $rows['SeatsReserved'];

 $remain = $totalSeat - $seatReserved; 

 $length = count($remain);
 for($i=1; $i<=$remain-1; $i++){
   echo "<option value=\"$i\" ";
   echo " $i";
   echo "> $i </option>";   
  }
}

<select name="cbSeatNo" id="cbSeatNo" class="cb1">
   <?php display_seatNo(); ?>
</select> 
```

问题是所选值没有消除。示例：- 预留座位号 1 后，它不应显示在组合框中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:02:13.473

您遍历从 1 到 $remain-1 的所有数字。那是一个逻辑错误。示例：您有 10 个席位。座位 3 被占用。您循环 1 到 (10-1 = 9)。座位 3 将显示在列表中。

相反，您需要从数据库中获取实际可用（或已占用）的席位，而不仅仅是计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:18:33.920

在 $seatReserved 中搜索 $i 然后跳过它。

```
 $seatReserved = empty($seatReserved) ? array() : $seatReserved;
 for($i=1; $i<=$remain-1; $i++){
     if((array_search( $i,  $seatReserved)) !== false) {
         continue;
     }
   echo "<option value=\"$i\" ";
   echo " $i";
   echo "> $i </option>";   
  } 
```

编辑：以防0个座位被保留，我给$seatReserved一个array()的默认值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T18:02:03.357

而不是循环遍历结果集。

最好将您的查询更改为这样的内容

Select * from table1 where seatReserved = false ;

对于每个预订，将 seatReserved 值设置为 false。

# java - 使用一台服务器和多个客户端在 Java 套接字编程中创建会话

> ID：16042728
> 
> 赞同：0
> 
> 时间：2013-04-16T16:52:46.000
> 
> 标签：java, sockets, network-programming

我是java中的新手程序员。我创建了一个类似于使用套接字编程的聊天应用程序的程序。我没用过线程。

我的问题是：

每当客户端 1 想通过服务器与另一个客户端 2 通信时，我如何知道哪个客户端正在通信。

我想如果我可以通过使用会话将所有客户端与服务器端区分开来，那会更容易。只是一个偶然的想法。

为什么这么问？？

我想知道这一点，因为我已经将客户端的地址连同序列号一起存储在一个文件中，以使消息对全局可见。每当客户端发送一条消息时，它都会为其添加一个序列号，该序列号是从存储在该文件中的 client1 client2 对中获得的。

任何帮助将不胜感激。我只是一个java学习者。对于我的问题中的任何含糊之处，我深表歉意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-07T06:46:43.967

首先，尝试创建一个线程来打开一个套接字，因为它有助于您的 GUI 处理。您想查看客户名称的要点可以通过以下步骤完成：-

添加一个编辑框并输入您的姓名（客户端名称）并将此名称与消息一起发送，并在服务器端拆分消息和名称，以便您可以确定哪个消息由谁发送。

例如：- 客户名称是 Alex，消息是“hi”，那么将发送的数据类似于“Alex+hi”。现在在服务器端使用 java 中的**split()**函数拆分此消息。希望这种编码和解码对您有所帮助。

# nutch - 评分 Nutch 结果

> ID：16042729
> 
> 赞同：0
> 
> 时间：2013-04-16T16:52:50.080
> 
> 标签：nutch

我正在使用 Nutch 1.2 进行爬行，为旅行域提供种子链接。接下来我使用 Solr 3.1 进行索引。我在我的搜索引擎中得到搜索结果。但现在我想对索引结果进行评分并将其显示在搜索引擎中。我已经引用了 URL： 1) [http://wiki.apache.org/solr/QueryElevationComponent](http://wiki.apache.org/solr/QueryElevationComponent)这基本上是为了提升查询。2) [http://wiki.apache.org/solr/SolrRelevancyFAQ#index-time_boosts](http://wiki.apache.org/solr/SolrRelevancyFAQ#index-time_boosts)用于提升文档。如何在索引时提升结果并检索结果？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T20:25:44.433

您提高结果的标准是什么？

SOLR 在根据术语出现的频率计算文档相关性方面已经做得很好。

默认设置未涵盖您的哪些特定要求？

# xcode - Xcode 复制粘贴断点

> ID：16042732
> 
> 赞同：16
> 
> 时间：2013-04-16T16:52:57.727
> 
> 标签：xcode, debugging, development-environment

有没有办法在 Xcode 中复制粘贴断点？

我要问的原因是，我将断点设置为“**评估后自动继续**”，并关联了一些操作。我想在代码的多个位置有相同的断点行为/动作。而不是重新做（设置断点，自定义它）10次（甚至更多，这可能很麻烦），只需复制粘贴它！？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-07-11T20:17:20.310

我找到了一个解决方案，尽管它可能并不容易。所有断点都保存在 Xcode 项目中的 XML 文件中。要查找文件，请选择您的项目文件并选择“显示包内容”，然后转到：

`xcuserdata/(YourNameHere).xcuserdatad/xcdebugger/`

您可以打开断点文件并复制/粘贴其 XML。然后，您可以更改断点的文件和行号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-22T18:56:43.883

我遇到了这个问题，并且我想与我的团队中的人分享我的一些更详细的断点。

### 使用 CocoaPods 进行项目

您将在中找到*xcdebugger*目录

```
PROJECT_NAME.xcworkspace/xcshareddata/xcdebugger 
```

其次，您需要通过右键单击断点并单击**共享断点使断点成为共享断点**

[![在此处输入图像描述](https://i.stack.imgur.com/KuQvp.png)](https://i.stack.imgur.com/KuQvp.png)

然后，您应该在*xcdebugger*中找到带有共享断点的*Breakpoints_vX.xcbkptlist文件*

 *### 没有 CocoaPods 的项目

您应该在此处找到**共享断点的***xcdebugger*目录

 **```
PROJECT_NAME.xcodeproj/xcshareddata/xcdebugger 
```

在那里你会找到你寻找的相同的断点文件。*xcuserdata/USERNAME.xcuserdatad*中还有一个 xcdebugger 目录，但它们可能有一些编码文件路径，在共享其他设备时会出现问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-05T09:20:21.593

在一个文件的范围内，您可以轻松地从 Breakpoints Navigator (`⌘</kbd>+`8`). Just select a particular breakpoint and then copy and paste (`⌘</kbd>+`c`, `⌘</kbd>+`v`).```

它将在同一行上复制，因此您需要用鼠标将其移动到任何其他行。

不幸的是，目前无法在文件之间移动断点（Xcode 13.1）。***

# python - Django Forms：从 ModelChoiceField 中获取所选项目？

> ID：16042734
> 
> 赞同：1
> 
> 时间：2013-04-16T16:53:07.363
> 
> 标签：python, django, django-forms

我想从 ModelChoiceField 访问选定的项目，类似于：

表格.py

```
class ManageFeedsForms(forms.Form):
    active_feed = forms.ModelChoiceField(queryset=Feed.objects.all(),
                                         empty_label=None,
                                         widget=forms.Select(attrs={'onchange': 'this.form.submit();'}),
    )

    def __init__(self, *args, **kwargs):
        super(ManageFeedsForms, self).__init__(*args, **kwargs)
        self.fields['active_feed'].label = '' 
```

模板.html

```
 {% for entry in feed_form.active_feed.selected_item.entry_list %}
                    <tr>
                        <td>{{ entry.title }}</td>
                        <td>{{ entry.date }}</td>
                    </tr>
                {% endfor %} 
```

views.py（非常基础，仅用于测试）

```
def overview(request):
    if request.GET:
        form = ManageFeedsForms(request.GET)
        if form.is_valid():
            pass
        else:
            pass
    else:
        # Empty ManageFeedsForms
        form = ManageFeedsForms()

    return render_to_response('feed_management/home.html',
                              {'header_title': 'Feeds',
                               'feed_form' : form,
                               },
                              context_instance=RequestContext(request)) 
```

我正在寻找类似“.selected_item”的东西，所以我可以访问模型的属性。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T17:15:34.427

You should modify your view like so:

```
def overview(request):
    selection = None
    if request.GET:
        form = ManageFeedsForms(request.GET)
        if form.is_valid():
            selection = form.cleaned_data['active_feed']
    else:
        # Empty ManageFeedsForms
        form = ManageFeedsForms()

    return render_to_response('feed_management/home.html',
                              {'header_title': 'Feeds',
                               'feed_form' : form,
                               'selection' : selection,
                              },
                             context_instance=RequestContext(request)) 
```

And your template:

```
{% if selection %}
<tr>
    <td>{{ selection.title }}</td>
    <td>{{ selection.date }}</td>
</tr>
{% endif %} 
```

# objective-c - Xcode - 如何使用 AXUIElementSetAttributeValue 设置特定窗口 (kCGWindowNumber) 的高度和宽度

> ID：16042737
> 
> 赞同：-1
> 
> 时间：2013-04-16T16:53:12.620
> 
> 标签：objective-c, xcode, cocoa

在 Xcode 4.6.1 中工作时，我想获取所有窗口的列表，选择一个特定的窗口（可能通过 windowID）并指定其大小（宽度和高度）和原点（X 和 Y）。

我可以获得屏幕大小，NSStringFromRect 允许我在 NSLog 中查看结果。NSRect 是 {NSPoint 原点；NSSize size;} 并在我的显示 {{0, 0}, {2560, 1440}} 的上下文中。

我使用以下内容来获取我的显示器尺寸。（感谢 Guillaume 关于 C 结构和强制转换的评论）：

```
-(void)awakeFromNib
{
    NSRect screenRect = [[NSScreen mainScreen] frame];
    CGSize myScreenSize = screenRect.size;
    NSLog(@"myScreenSize = %d x %d", (int)myScreenSize.width, (int)myScreenSize.height);

    // returns: myScreenSize = 2560 x 1440
}
@end 
```

我想尝试设置另一个启动的应用程序窗口（不属于我的进程）的大小和原点。

所以首先我得到一个所有正在运行的应用程序的列表，以及每个窗口的 windowID，然后选择一个要移动/调整大小的窗口。

根据其他搜索，这可以使用 CGSPrivate.h 或 Accessibility api 来完成。我不知道如何使用其中任何一个来设置特定 windowID/Number 或 PID 的大小等

```
#import "rsAppDelegate.h"

@implementation rsAppDelegate

-(void)awakeFromNib
{
    // get the size of the main screen
    NSRect screenRect = [[NSScreen mainScreen] frame];    
    // devrived fromGuillaume's suggestion
    CGSize myScreenSize = screenRect.size;
    CGPoint myScreenOrigin = screenRect.origin;
    NSLog(@"myScreenSize = %d x %d", (int)myScreenSize.width, (int)myScreenSize.height);
    NSLog(@"Origin = %d , %d", (int)myScreenOrigin.x, (int)myScreenOrigin.y);

    // To get a list of Application windows, the PID of the window, the window number, and the window bounds (origin, height, width)   
    CFArrayRef windowList = CGWindowListCopyWindowInfo(kCGWindowListOptionOnScreenOnly | kCGWindowListExcludeDesktopElements, kCGNullWindowID);
    for (NSMutableDictionary* entry in (__bridge NSArray*)windowList)
    {
        NSArray *ownerName = [entry objectForKey:(id)kCGWindowOwnerName];
        NSInteger ownerPID = [[entry objectForKey:(id)kCGWindowOwnerPID] integerValue];
        NSInteger windowNumber = [[entry objectForKey:(id)kCGWindowNumber] integerValue];
        NSArray *ownerBounds = [entry objectForKey:(id)kCGWindowBounds];
        NSLog(@"\nApp = %@ \nAppPID = %ld \nwindowNumber = %ld \nProgramBounds = %@", ownerName, (long)ownerPID, (long)windowNumber, ownerBounds);
    }
    CFRelease(windowList);
    /*
    OUTPUT:
    myScreenSize = 2560 x 1440 | Origin = 0 , 0
    App = Xcode
    AppPID = 3260
    windowNumber = 4493
    ProgramBounds = {
        Height = 1285;
        Width = 1852;
        X = 339;
        Y = 32;
    }
    */

    // Knowing the name of the application, it's PID, window number, and bounds to a percentage of the screen:
    // Set it's origin and size

}
@end 
```

所以现在我知道了屏幕尺寸，并且掌握了每个应用程序中所有窗口的所有可用信息。 **如何使用 PID 3260、窗口编号 4493 指定应用程序的新原点、宽度、高度？**

```
newPos = AXValueCreate(kAXValueCGPointType, windowOrigin);
AXUIElementSetAttributeValue(chosenWindow, kAXPositionAttribute, newPos)

newSize = AXValueCreate(kAXValueCGSizeType, windowSize);
AXUIElementSetAttributeValue(chosenWindow, kAXSizeAttribute, newSize); 
```

**如何指定 selectedWindow ？我指定什么格式 windowOrigin & windowSize ？**

这是我找到的信息，但我不知道如何使用：

kAXValueCGPointType 是 CGPoint 的包装器；参见 CoreGraphics.h 在 AXValue.h 中声明

kAXValueCGSizeType 是 CGSize 的包装器；

这些是其他结构的 AXValueType 包装器。您必须使用 AXValueCreate 和 AXValueGetValue 函数在包装结构和本机结构之间进行转换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T13:29:35.743

首先你需要找出你的窗口在哪里。

从**NSWindow 类参考...**

**屏幕**

> 返回窗口所在的屏幕。

```
- (NSScreen *)screen 
```

**返回值**

> 大部分窗口打开的屏幕；当窗口不在屏幕上时为零。

**讨论**

> 当窗口部分在一个屏幕上，部分在另一个屏幕上时，将返回其大部分所在的屏幕。

**最深的屏幕**

> 返回窗口所在的最深屏幕（它可能被拆分为多个屏幕）。

`- (NSScreen *)deepestScreen`

**返回值**

> 窗口所在的最深屏幕；当窗口不在屏幕上时为零。

然后，当且仅当您的窗口位于一个屏幕上时，您才能确定其大小占某物的百分比。

不过，一般来说，如果不将窗口限制在主屏幕或某些用户选择的屏幕上，您的方法会遇到问题。

否则，您需要考虑如何处理不同的屏幕配置。

您还需要以下 NSApplication 委托方法

**applicationDidChangeScreen 参数：**

> 当连接到 > 计算机的显示器的配置发生更改时（以编程方式或当用户在 > 显示器控制面板中更改设置时），由默认通知中心发送。

`- (void)applicationDidChangeScreenParameters:(NSNotification *)aNotification` **参数**

> aNotification 一个名为 NSApplicationDidChangeScreenParametersNotification 的通知。调用此通知的对象方法会返回 NSApplication 对象本身。

`NSScreen`实例有一个`frame`方法，它返回一个`NSRect`就像`NSWindow`做一样。从中可以确定要设置 size.width 和 size.height 的适当高度和宽度，以便在创建用于设置窗口框架的 NSRect 时使用。

获取屏幕框架并访问其高度的示例：

```
NSRect mainScreenFrameRect = [[NSScreen mainScreen] frame];
CGFloat screenHeight = mainScreenFrameRect.size.height; 
```

从那里获得高度或宽度的百分比很容易计算。

`setFrame:display:animate:`我建议在您的 applicationDidFinishLaunching 或其他适当的地方使用 NSWindow 方法。（考虑你是否有一个你可能想要的 NSWindow 子类。）

# powershell - Powershell 将持续时间字符串解析为秒

> ID：16042741
> 
> 赞同：1
> 
> 时间：2013-04-16T16:53:28.303
> 
> 标签：powershell, powershell-2.0

我有一个这样的字符串：“00:02:37.6940000”。有没有一种简单的方法可以将其转换/解析为几秒钟？我是否必须将它正则表达式分成几部分并这样做？

我不在乎毫秒。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-16T17:20:07.510

Parse is the default method of the [TimeSpan] type, so:

```
([timespan]"00:02:37.6940000").TotalSeconds 
```

should work, too.

With error trapping:

```
$input_ts = "00:02:37.6940000" 

if ($input_ts -as [TimeSpan])
  {$time = ([TimeSpan]$input_ts).TotalSeconds}

else {Write-Warning "Input value $input_ts not valid for timespan"} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T16:55:34.990

这是您可以使用的时间跨度对象的格式

```
[Timespan]::Parse("00:02:37.6940000") 
```

# mysql - MySQL 当前日期

> ID：16042742
> 
> 赞同：3
> 
> 时间：2013-04-16T16:53:32.130
> 
> 标签：mysql, sql

我希望用户可以在个人资料页面上看到他们今天上传的照片。

这个对吗？

```
SELECT * FROM pictures 
WHERE userid = '$userid'
ORDER BY pictureuploaddate < DATE_ADD(NOW(), INTERVAL 1 DAY); 
```

还是行不通。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:33:37.940

我知道你已经选择了一个答案，但为了避免在同一天多次上传造成混淆，你也可以这样做：

```
SELECT * 
FROM pictures 
WHERE userid = '$userid'
ORDER BY pictureuploaddate DESC
LIMIT 1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:55:32.113

你会得到类似的东西：

```
SELECT * 
FROM pictures 
WHERE userid = '$userid' AND 
      DATE(pictureuploaddate) = CURDATE() # Match date without time
ORDER BY pictureuploaddate DESC 
```

你为什么要在里面`ORDER BY`用一个`=`？它应该是今天的日期，只需将其添加到 WHERE。如果您想先获取最新图片，您可以`ORDER BY pictureuploaddate DESC`

此外，如果您想要当前日期，最好比较日期而不是更小。因为匹配起来更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T16:56:13.210

这将按比较的布尔结果排序：

```
ORDER BY pictureuploaddate < DATE_ADD(NOW(), INTERVAL 1 DAY) 
```

我猜你想要`WHERE`子句中的比较：

```
WHERE userid = '$userid'
AND pictureuploaddate BETWEEN CURDATE() AND CURDATE() + INTERVAL 86399 SECOND
ORDER BY pictureuploaddate DESC 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T16:56:48.707

您现在正尝试通过日期的布尔测试的输出对结果进行排序。将该部分添加到 WHERE 子句中更有意义。

# c++ - 将文件中的数据输出到结构体和结构体数组中

> ID：16042748
> 
> 赞同：0
> 
> 时间：2013-04-16T16:53:51.967
> 
> 标签：c++, visual-c++

我在从文件中获取数据并将其输入到给定的结构和结构数组然后输出文件时遇到了很多麻烦。我们得到一个包含 96 行的文件，如下所示：

> 尼尔·阿尔津
> 2.3 6.0 5.0 6.7 7.8 5.6 8.9 7.6
> 查尔斯·巴贝奇
> 2.3 5.6 6.5 7.6 8.7 7.8 5.4 4.5

该文件针对 24 个不同的人继续，然后以不同的分数重复（第二行）。第一个数字，在这种情况下，两个人都是 2.3，是难度等级。接下来的6个数字是分数。

我们得到这些数据是为了设置我们的结构和数组以及我的代码：

```
#include <iostream>
#include <fstream>
#include <iomanip>
#include <string>
#include <cmath>
using namespace std;
int main ()
{

  ifstream inFile;
  inFile.open("C://diveData.txt");

  // checking to see if file opens correctly
  if (!inFile)
  {
      cout << "Error opening the file!" << endl;
  }

  const int numRounds = 2;              // variable to hold the number of rounds
  const int numScores = 7;              // variable to hold the number of rounds
  const int numDivers = 24;             // variable to hold the number of divers
  typedef double DifficultyList[numRounds];   // 1D array for storing difficulty                of dives on each round 
  typedef double ScoreTable [numRounds] [numScores]; // 2D array of dive scores

// struct to store information for one diver
  struct DiverRecord
{
   string name;
   double totalScore;
  double diveTotal;
  DifficultyList diff;
  ScoreTable scores;
};

DiverRecord DiverList[numDivers];

// my attempt at printing out the contents of the file
  while (!EOF)
 {
    for (int x = 0; x < 25; x++)
    { 
       infile >> DiverList[x].name;
       inFile >> DiverList[x].totalScore;
       inFile >> DiverList[x].diveTotal;

       cout << DiverList.[x].name << endl;
       cout << DiverList.[x].totalScore << endl;
       cout << DiverList.[x].diveTotal << endl;
    }
  }

return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T16:14:04.533

正如我在之前的评论中所说，我现在正试图专注于不使用结构和结构数组，并尝试使用其他函数来从文件中读取数据。我想将数据以逻辑形式放置，例如：

人名 第 1 轮：难度分数 第 2 轮：难度分数

但我无法从文件中访问特定元素。

我正在使用的代码是：

```
while(inFile)
{
   string name;
   getline(inFile, name);
   cout << name << endl;
} 
```

这会按原样输出数据文件，但是当我尝试为难度和七个分数声明不同的变量时，它根本无法正确输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:33:45.917

首先，>> 运算符在第一个空格字符处结束输入，因此当您读取名称时，您只会得到姓氏和逗号，它将尝试将名字放入 totalScore。要获得全名，请执行以下操作。

```
 string temp;
  infile >> DiverList[x].name; 
  infile >> temp;
  DiverList[x].name + " ";
  DiverList[x].name + temp; 
```

此外，在输出时，您不需要额外的 '.'

```
 cout << DiverList[x].name << endl; 
```

等等应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:29:36.587

Couple of questions:

1.  decide whether `ifstream` is open or not, use `ifstream::is_open`;
2.  decide whether `end of file` is encountered, try code below;
3.  If I get it right, your input file format should be:

    > name1,name2
    > difficulty score1 score2 ... score7

    In this sense, the `totalScore` should not be input from the stream, but calculated instead.

4.  you have two names for one record, so the definition of your record structure seems fuzzy.

Here is a revised version:

```
#include <string>
#include <vector>
#include <fstream>
#include <iostream>
using namespace std;

struct DiverRecord
{
    string a, b;
    double totalScore;
    double difficulty;
    double scores[7];
};

int main ()
{

    ifstream inFile("C://diveData.txt");

    // checking to see if file opens correctly
    if (!inFile.is_open()) {
        cout << "Error opening the file!" << endl;
    }

    vector<DiverRecord> DiverList;

    DiverRecord record;
    char ch;
    while (inFile) {
        inFile >> record.a >> ch >> record.b >> record.difficulty;
        record.totalScore = 0;
        for (int i = 0; i < 7; ++i) {
            inFile >> record.scores[i];
            record.totalScore += record.scores[i];
        }

        DiverList.push_back(record);
    }

    // output your DiverList here.

    return 0;
} 
```

# r - 如何更改R中几个虚拟变量的值？

> ID：16042751
> 
> 赞同：0
> 
> 时间：2013-04-16T16:54:01.387
> 
> 标签：r

我的数据框中有 167 个虚拟变量以及其他变量。为了创建一个新的预测数据，我希望将第一个虚拟变量的值更改为 1，并将所有其他变量的值替换为零。我的虚拟变量被称为 District_code2、 District_code3、 District_code4 等等。所以我想修复 District_code2 取值 1 和所有其他取值 0。

我使用因子创建了这些虚拟变量，并使用 model.matrix 将它们添加到我的数据中

```
 dummies = data.frame(model.matrix(~district_code, data=data_wht_81_09))
 #to get rid of the intercept
 dummies1<-dummies[,-1] 
```

我需要在我的数据中包含假人，因为在我运行回归之后，我不希望在我的预测中考虑所有假人的系数。我想绘制关于一个变量的拟合值，将所有其他变量保持在其平均值。对于地区假人，这意味着向所有拟合值添加一个常数。因此，我想将所有其他虚拟变量的值设置为 0。可能有更有效的方法来做到这一点。下面我将展示对象虚拟变量的示例。

```
 dput(head(dummies1,4))
 structure(list(district_code2 = c(0, 0, 0, 0), district_code3 = c(0, 
 0, 0, 0), district_code4 = c(0, 0, 0, 0), district_code5 = c(0, 
 0, 0, 0), district_code6 = c(0, 0, 0, 0), district_code7 = c(0,0, 0, 0), 
```

我只显示前 6 个变量。我怎样才能做到这一点？提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:15:07.360

很少需要自己操作虚拟变量（当您使用因子时，R 在幕后进行操作），但是，如果绝对需要，您可以简单地识别名称以 开头的列`discrict_code`，并更改它们的值：其他列将是保持原样。

```
d <- data.frame( 
  district_code2 = c(0, 0, 0, 0), 
  district_code3 = c(0, 0, 0, 0), 
  district_code4 = c(0, 0, 0, 0), 
  district_code5 = c(0, 0, 0, 0), 
  district_code6 = c(0, 0, 0, 0), 
  district_code7 = c(0,0, 0, 0), 
  x = 1:4
)
library(stringr)
d[,str_detect(names(d), "^district_code[0-9]+")] <- 0
d[,1] <- 1
d 
```

# java - 使用 useDelimiter 从 txt 文件中划分数据

> ID：16042752
> 
> 赞同：0
> 
> 时间：2013-04-16T16:54:03.320
> 
> 标签：java, file-io, while-loop, java.util.scanner, local-variables

我在文本文件中有一个数据，格式为：

```
AB-9, Gregson, Brian, R T, Mr 
```

我想将第一个 , 分成并存储`AB-9`在一个局部变量中，我已经完成了所有这些，但目前的问题是，当我打印 id 的值时，它会打印`,`. 我怎样才能摆脱多余的逗号？

另一个问题是数据中的第一行没有被读取。

```
public void readData()
{
 File theNewData = new File("new_data.txt");
        Scanner inputFrom = new Scanner(theNewData);
        while(inputFrom.hasNextLine())
        {
             String lineOftext = inputFrom.nextLine().trim();  
                Scanner scanner = new Scanner(lineOftext).useDelimiter(",[ ]*");

                 String id = inputFrom.next();

                 System.out.println(id);
        }

        inputFrom.close();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:01:13.627

查看 String.split() 详细信息： http: [//docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29)

# hadoop - 运行 Hadoop 文件命令生成错误

> ID：16042756
> 
> 赞同：0
> 
> 时间：2013-04-16T16:54:18.340
> 
> 标签：hadoop

我在 VirtualBox Unbutu 12.04 上创建了一个 hadoop 伪分布式集群。

运行 jps 命令显示 DataNode 和 NameNode 进程已启动。

我正在尝试执行以下 DFS 命令

***hadoop fs -put 配置输入***

但上述命令或任何其他 DFS 命令失败

***与 FS 的连接不良。命令中止。例外：方案没有文件系统：hsdf***

有什么建议可以使上述工作正常吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T00:07:45.267

请检查您尝试通过的 conf 和输入文件的路径。

# php - 使用 php 类保留一个单独的文件并将变量传递给它

> ID：16042757
> 
> 赞同：-6
> 
> 时间：2013-04-16T16:54:19.607
> 
> 标签：php, oop, class

我想像joomla configuration.php文件一样单独保留一个类。所以我可以创建一个包含一个类的php页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:07:46.780

将类放在一个文件中，然后使用以下任何选项包含它：

[包括：](http://us3.php.net/manual/en/function.include.php)

```
include ($_SERVER['DOCUMENT_ROOT'].'/includes/class.php'); 
```

[要求：](http://us3.php.net/manual/en/function.require.php)

```
require ($_SERVER['DOCUMENT_ROOT'].'/includes/class.php'); 
```

[要求一次：](http://us3.php.net/manual/en/function.require-once.php)

```
require_once ($_SERVER['DOCUMENT_ROOT'].'/includes/class.php'); 
```

或者您可以使用 ajax 或表单来定位该类：

```
/includes/class.php?var=input 
```

在类包括你会使用：

```
if(!empty($_GET['var'])){
   //Do some check here for validation
   //let's say I'm expecting a number
   if(is_numeric($_GET['var'])){
     $var = $_GET['var'];
   }
} 
```

然后在你的类中使用 var。

# javascript - 在 jQuery 选项卡中缓存页面加载？

> ID：16042758
> 
> 赞同：0
> 
> 时间：2013-04-16T16:54:21.410
> 
> 标签：javascript, jquery, jquery-ui-tabs

我的html：

```
<div id="tabs">
    <ul>
        <li><a href="~/WebAppOne">Web App One</a></li>
        <li><a href="~/WebAppTwo">Web App Two</a></li>
    </ul>
</div> 
```

还有我的 jQuery：

```
$( document ).ready( function () {
    $( "#tabs" ).tabs( {
        cache: true
    } );
} ); 
```

问题是我希望标签内容只加载一次。它第一次加载就好了，但是如果我在选项卡之间单击，它正在重新加载页面。因此，如果用户在 WebAppOne 上的表单中输入了一些内容，切换到 WebAppTwo 并返回将取消他们的更改。

那么首先，是`cache:true`我想要的吗？或者它只是像普通浏览器一样缓存页面？理想情况下，我希望在页面加载时异步加载所有选项卡内容区域，然后再也不会 - 无论它们如何点击。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T16:56:19.197

如果您的 Web 服务器发送缓存控制标头，并且浏览器尊重这些缓存将“神奇地发生”。

[http://condor.depaul.edu/dmumaugh/readings/handouts/SE435/HTTP/node24.html](http://condor.depaul.edu/dmumaugh/readings/handouts/SE435/HTTP/node24.html)

# python - 如何在 django 中强制异常以便在 django 中对其进行测试

> ID：16042762
> 
> 赞同：7
> 
> 时间：2013-04-16T16:54:34.297
> 
> 标签：python, django, unit-testing, exception, mocking

我真的在寻找如何修补 What.objects.get_or_create，但我无法得到任何建议或想法如何去做。

好吧，我的问题是我有这样的事情：

```
def create_and_get_object(
    name, request, save_url=True, data=None):

    try:
        (object_type_, created) = Object.objects.get_or_create(
            name=name)
        try:
        ...
    except Exception:
        obj = None
        msg = ("Failed to get or create object `Object` with"
                "name='%s'" % name)
        logger_.exception(msg, extra={'request': request})
    return obj 
```

所以，我想测试 Object.objects.get_or_create 在某个时候抛出异常......

我正在尝试，`Mock(side_effect=Exception())`但我真的不知道如何使用它来获得我所期望的。

所有这些都是为了获得该功能的 100% 覆盖（不包括异常行），以及许多其他类似的异常。

测试这个的正确方法是什么，以及这样的代码？

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-16T17:31:35.517

我喜欢将 python 的`with`语句与 mock 的[patch.object 一起](http://www.voidspace.org.uk/python/mock/patch.html#patch-object)使用。在你的情况下，它应该是这样的：

```
from mock import patch
from django.test import TestCase
from django.db.models.manager import Manager
from anothermodule import create_and_get_object

class TestCreateAndGetObject(TestCase):
    def test_exception_throwing(self):
        with patch.object(Manager, 'get_or_create') as mock_method:
            mock_method.side_effect = Exception("test error")

            result = create_and_get_object('test', 'test')
            self.assertIsNone(result) 
```

理论上应该可行，希望有所帮助。

# c# - 优雅地关闭系统托盘应用程序

> ID：16042763
> 
> 赞同：4
> 
> 时间：2013-04-16T16:54:43.587
> 
> 标签：c#, .net, winforms

我有一个在系统托盘（通知区域）中运行的非常基本的应用程序。该`Main`方法如下所示：

```
using (NotifyIcon notifyIcon = new NotifyIcon())
{
    notifyIcon.ContextMenuStrip = new ContextMenuStrip();
    notifyIcon.ContextMenuStrip.Items.Add(new ToolStripMenuItem(
        "Exit", 
        null, 
        delegate { App.Exit(); }
        )
    );

    notifyIcon.Icon = Properties.Resources.MyIcon;
    notifyIcon.Visible = true;

    Application.Run();
} 
```

到目前为止，这工作正常（我可以使用上下文菜单中的退出选项并且应用程序正确退出。但是，当软件卸载时我需要退出应用程序。现在我正在使用`taskkill`我的 WiX 安装程序来执行此操作（也许有更好的方法？）。问题是，如果我这样做`taskkill /im myapp.exe`，通知区域中的图标会消失但进程仍在运行。如果我强制关闭它，`taskkill /f /im myapp.exe`则进程结束但图标仍然存在（直到我将鼠标悬停在它上面）。有没有办法删除图标并从单独的进程中结束进程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:13:29.183

将隐藏表单添加到您的应用程序。这将是 Application.Run() 的一个参数。当表单关闭时，您的应用程序将退出。

为了让表单在 WiX 中关闭，我们使用 util:CloseApplication [1](http://wix.sourceforge.net/manual-wix3/util_xsd_closeapplication.htm)并将 CloseMessage 属性设置为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T18:17:06.887

我决定采取不同的方法。我添加了一个命令行参数来指示我要关闭。然后，此开关`SendMessage`将`PostMessage`使用`RegisterWindowMessage`. 然后，WiX 安装程序将使用此命令行参数执行进程，现在一切正常关闭。多么严重的痛苦……

# admob - 什么是 AdMob 默认 ID？

> ID：16042765
> 
> 赞同：1
> 
> 时间：2013-04-16T16:54:46.453
> 
> 标签：admob, mopub

我想通过 mobup 展示 admob 广告。所以我在 mopub 中创建了网络。所以我有一个问题，谁知道 AdMob 默认 ID 是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T00:04:19.610

没有默认的 AdMob 发布商 ID。您需要在[admob.com](http://www.admob.com)上注册一个 AdMob 帐户，然后创建一个网站/应用程序以获取发布商 ID。然后将该 ID 连接到 Mopub 的中介平台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-11T17:38:59.470

登录到 admob。您必须已经创建了一个应用程序。单击“站点和应用程序”选项卡。然后找到应用程序并单击“管理设置”。发布者 ID 位于页面的左上角。

干杯，伊莱恩 www.thechocolatelabapps.com

# ruby-on-rails - Rails 资产：预期的 ')' 得到 '}' - 命令失败，状态为 (1)

> ID：16042768
> 
> 赞同：0
> 
> 时间：2013-04-16T16:54:53.770
> 
> 标签：ruby-on-rails, debugging, less, asset-pipeline, twitter-bootstrap-rails

我最近开始在我的资产管道中遇到奇怪的行为。我正在使用 Ruby on Rails (3.2.3)。我正在使用的著名库：

```
# From Gemfile
gem 'jquery-rails'
gem 'therubyracer', :require => 'v8'
gem "less-rails"
gem 'twitter-bootstrap-rails', '>= 2.1.6'
gem 'sass-rails', '~> 3.2.3'
gem 'devise', '~> 2.2.3'        #   Note: Recently upgraded 
```

我最近去编译我的资产并且碰到了这堵墙：

```
$ bundle exec rake assets:precompile RAILS_ENV=development --trace
** Invoke assets:precompile (first_time)
** Execute assets:precompile
/Users/tim/.rvm/rubies/ruby-1.9.3-p374/bin/ruby /Users/tim/.rvm/gems/ruby-1.9.3-p374/bin/rake assets:precompile:all RAILS_ENV=development RAILS_GROUPS=assets --trace
** Invoke assets:precompile:all (first_time)
** Execute assets:precompile:all
** Invoke assets:precompile:primary (first_time)
** Invoke assets:environment (first_time)
** Execute assets:environment
** Invoke environment (first_time)
** Execute environment
** Invoke tmp:cache:clear (first_time)
** Execute tmp:cache:clear
** Execute assets:precompile:primary
expected ')' got '}'
Command failed with status (1): [/Users/tim/.rvm/rubies/ruby-1.9.3-p374/bin...] 
```

在过去的几个小时里，我一直在研究这个问题，试图找到关于这个问题发生在哪里的线索。在这一点上，我的主要问题是我从 rails 得到的反馈/错误输出。通过跟踪，我仍在查看我的许多资产文件/目录之一中似乎存在的问题。编译期间的其他调试或文件跟踪方法（可能是更详细的编译模式？）在这一点上会很棒。

我的下一步是查看我的 Git 提交日志，看看资产管道的哪些更改可能导致了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T20:26:41.530

这是 twitter bootstrap gem 中的错误。错误的 css 语法。尝试从清单文件 application.css 中删除它并重新启动资产预编译。如果它真的引导 gem 尝试使用最新版本

# python - 在python中的行和列中查找最小对值？

> ID：16042773
> 
> 赞同：2
> 
> 时间：2013-04-16T16:55:08.617
> 
> 标签：python

我的程序中有一个函数可以进行拆分和浮动。然后将矩阵传递给主程序。现在我有一个函数可以找到最小值的行和列。在 Martijn Pieters 的帮助下，我得到了最小值，但只有一对。下面给出了输出示例。E 是从 main 传递给此函数的方阵。

值存储在 txt 文件中并在单独的函数中读取，然后将矩阵传递给 main。从他们的矩阵传递给下面的函数。

```
0 2 8 9
2 4 9 9
4 7 4 8
3 4 8 9 
```

代码：

```
def closest_pair(e):
    '''for row in range(len(e)):
       for col in range(0,len(row),1):
          minrow = min(e[row])
          mincol = min(e[col])
          return ([minrow], [mincol])'''
       result = min((min((v, c) for c, v in enumerate(row)), r) for r, row in enumerate(e))
       return result[1], result[0][1] 
```

这帮助我找到了行和列的最小值，但是输出是得到这对。同样对于第一个值为 0 的值，0 将不计入，因此如果 (0, 0) 的值为 0，则不算作最小值。话虽如此，例如，如果第 1 行和第 1 列，值是 [2,2] 作为对，并且是唯一比输出 (1,1) 的最小对。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:51:39.950

你要这个？

```
>>> def closest_pair(e):
...     remapped = [(e[x][y], (x, y)) for x, row in enumerate(e) for y, col in enumerate(row)]
...     return min(remapped)
... 
>>> a = [[0, 2, 8, 9], [2, 4, 9, 9], [4, 7, 4, 8], [3, 4, 8, 9]]
>>> closest_pair(a)
(0, (0, 0)) 
```

或者：

```
def closest_pair(e):
    return min(
        (e[x][y], (x, y)) 
        for x, row in enumerate(e)
        for y, col in enumerate(row)
    ) 
```

# html - IE 条件注释和元内容标签的评估顺序

> ID：16042775
> 
> 赞同：0
> 
> 时间：2013-04-16T16:55:26.057
> 
> 标签：html, internet-explorer, internet-explorer-9

我有一个托管在本地 Intranet 上的网站*mysite.mycompany.com*，默认情况下它会触发 IE 使用兼容模式（在我的情况下为 IE-7）。

我想[使用最新的浏览器模式](https://stackoverflow.com/questions/6771258/whats-the-difference-if-meta-http-equiv-x-ua-compatible-content-ie-edge)（因此是`meta content="IE=Edge,chrome=1"`）并稳健地处理旧版本（显示低于 IE9 的消息）。

我的问题是条件注释在元标记之前被评估，所以在评估条件时我们仍然处于 IE-7 模式。例如，在本地 Intranet 上使用 IE9 的以下 HTML 显示：*'Tags LT IE9'*。

处理这个问题的正确、稳健的方法是什么？

```
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"><!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  </head>
  <body>
    <!--[if lt IE 9]><p>Tags LT IE9</p><![endif]-->
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:49:32.423

这些`http-equiv`值从未如此可靠。与其在事后尝试使用 HTML 元素设置 HTTP 标头，不如直接在其中一个[`.htaccess`](https://github.com/h5bp/server-configs/blob/master/apache/.htaccess#L91)或中设置 HTTP 标头[`web.config`](https://github.com/h5bp/server-configs/blob/master/iis/dotnet%204/webforms/web.config#L130)（取决于您是否分别拥有 Apache 或 IIS）。

# sharepoint-2010 - IE10 SharePoint 2010 模态对话框闪烁

> ID：16042779
> 
> 赞同：5
> 
> 时间：2013-04-16T16:55:37.743
> 
> 标签：sharepoint-2010, modal-dialog, internet-explorer-10

是否有其他人遇到过带有 IE10 的 SharePoint 2010 中的模态对话框问题？在 IE10 正常或与 IE8 标准文档模式兼容的浏览器模式下，OOB 和自定义模式都会导致持续闪烁。原本应该在页面上方的模态灰色最初不会出现，但是一旦您将鼠标移出模态，就会出现并开始闪烁。如果我将文档模式更改为 IE9 模式，问题似乎就消失了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-30T16:17:00.313

如果您仍然遇到此问题，这是我的解决方法。在您打开对话框的脚本中添加

```
$(".ms-dlgOverlay").css({
    'position': 'relative'
}); 
```

这将隐藏覆盖。我无法让它与可见的叠加层一起工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T18:13:48.850

我有同样的问题。我将它添加到我的 CSS 文件中，它消除了闪烁。

```
body.v4master
{
 overflow:hidden !important;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-30T08:39:52.983

`.ms-dlgOverlay`从更改为`position:absolute;`为`position:fixed;`我修复它。
顺便说一句，这种风格可以在 corev4.css 文件中找到。

# javascript - jQuery mouseover 在 mouseout 上运行

> ID：16042781
> 
> 赞同：6
> 
> 时间：2013-04-16T16:55:40.960
> 
> 标签：javascript, jquery

这是我的 jQuery

```
$('#samsungShine').mouseover(function () {
    $('#samsungShineImage').animate({
        "margin-left": "304px"
    }, 700);
}).mouseout(function () {
    $('#samsungShineImage').css("margin-left", "-304px");
}); 
```

当我将鼠标悬停时，它工作得很好，当我鼠标悬停时，它不会重置，它会重新播放鼠标悬停......这是问题的一个问题，所以你可以明白我的意思：

[http://jsfiddle.net/2tujd/](http://jsfiddle.net/2tujd/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T17:00:09.233

尝试改为：[http](http://jsfiddle.net/2tujd/11/)`mouseenter` : //jsfiddle.net/2tujd/11/`mouseleave`

```
$('#samsungShine').mouseenter(function () {
    $('#samsungShineImage').animate({
        "margin-left": "304px"
    }, 700);
}).mouseleave(function () {
    $('#samsungShineImage').stop().css("margin-left", "-304px");
}); 
```

在[jQuery 网站上](http://api.jquery.com/mouseout/)，它说关于 using`mouseout`和 simliarly for `mouseover`：

> 由于事件冒泡，这种事件类型会引起很多麻烦。例如，在本例中，当鼠标指针移出 Inner 元素时，将向该元素发送一个 mouseout 事件，然后滴流到 Outer。这可能会在不合时宜的时候触发绑定的 mouseout 处理程序。

**编辑：**添加`.stop()`内部`mouseleave`以确保在设置`margin-left`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T17:01:08.957

试试这个，`stop`也使用：

[演示](http://jsfiddle.net/2tujd/6/)

```
$('#samsungShine').mouseenter(function() {
    $('#samsungShineImage').animate({"margin-left":"304px"}, 700);
}).mouseleave(function(){
    $('#samsungShineImage').stop().css("margin-left", "-304px");
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-16T17:05:22.373

[http://jsfiddle.net/2tujd/10/](http://jsfiddle.net/2tujd/10/)

我认为最好只使用一个处理程序。所以你对异步方法没有任何冒泡或问题。

```
$('#samsungShine').mouseenter(function () {
    $('#samsungShineImage').animate({
        "margin-left": "304px"
    }, 700, function() {
  $('#samsungShineImage').css("margin-left", "-304px")
  });
}); 
```

# java - 抽象工厂模式依赖对象组合？

> ID：16042782
> 
> 赞同：3
> 
> 时间：2013-04-16T16:55:45.913
> 
> 标签：java, oop, design-patterns

当我阅读[Head first design pattern](https://rads.stackoverflow.com/amzn/click/com/0596007124)一书时，我发现抽象工厂一章中的“抽象工厂依赖于对象组合：对象创建是在工厂接口中公开的方法中实现的”。我的疑问是抽象工厂如何依赖对象组合？

如果我将在[维基百科](http://en.wikipedia.org/wiki/Abstract_factory_pattern#Java)中举个例子，那么 GUIFactory 是一个接口，WinFactory 实现了 GUIFactory。然后抽象工厂如何使用组合。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T13:04:21.837

我认为它们的意思是抽象工厂为客户描述了组合，并且在这个意义上依赖于对象组合。

再举一个例子，抽象工厂`BodyCreator`定义了方法`createArm`，`createLeg`等等`createHead`。具体工厂可以是`DinosaurCreator`和`HumanCreator`。它们产生所有元素来创建一个复合“主体”，以便客户端可以调用这些不同的方法来组合一个，但它不需要知道它究竟*是*什么类型的主体。就像在 wikipedia 示例中 GUIFactory 描述了 GUI 由哪些元素组成。

为了更清楚，他们应该添加更多方法 IMO: `CheckBox createCheckBox()`等`TextField createTextField()`。

但是，是的，也许“relies”不是最好的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:12:11.787

恕我直言，一个笼统的声明，比如

> 抽象工厂*依赖*对象组合

不准确。在这种情况下，我的感觉是，`object composition`在定义`Abstract Factory`.

Wikipedia 的对象组合条目：[http](http://en.wikipedia.org/wiki/Object_composition) ://en.wikipedia.org/wiki/Object_composition 在以下情况下很有帮助：

> 在计算机科学中，对象组合 [...] 是一种将简单对象或数据类型组合成更复杂对象的方法。

是否有任何迹象表明抽象工厂/工厂/工厂方法不能返回简单的对象或数据类型？

这是一个反问（我认为）。我什么也找不到。

# c++ - 为什么将函数参数声明为“X* const”

> ID：16042783
> 
> 赞同：3
> 
> 时间：2013-04-16T16:55:46.380
> 
> 标签：c++

让我们考虑这样的应用程序：

```
void foo (char* const constPointerToChar) {
    // compile-time error: you cannot assign to a variable that is const
    constPointerToChar = "foo";
}

int _tmain(int argc, _TCHAR* argv[])
{
    char* str = "hello";
    foo(str);
    printf(str);
    return 0;
} 
```

让我们删除`const`关键字：

```
void foo (char* pointerToChar) {
    pointerToChar = "foo";
}

int _tmain(int argc, _TCHAR* argv[])
{
    char* str = "hello";
    foo(str);
    printf(str);
    return 0;
} 
```

输出是`hello`. 因此，即使允许函数更改指针，它也会更改它的指针副本，而原始指针没有更改。

这是意料之中的，因为指针是按值传递的。

我确实理解为什么事情会这样工作，但我不明白为什么有人需要将参数声明为`X* const`.

当我们声明函数参数时，`X* const`我们说“好的，我保证在我的函数中我不会修改我自己的指针副本。” 但是为什么调用者应该关心他从未见过和使用的变量会发生什么？

我是否更正了声明函数参数`X* const`是无用的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T16:59:10.163

> 但是为什么调用者应该关心他从未见过和使用的变量会发生什么？

他没有。实际上，您可以将其`const`从函数声明中删除，而仅将其包含在实现中。

> 我是否更正了声明函数参数`X* const`是无用的？

不，它与声明任何其他局部变量一样有用`const`。阅读函数的人会知道指针值不应该改变，这可以使逻辑更容易理解；没有人会在不应该的时候通过更改逻辑来意外破坏逻辑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T16:58:30.880

顶级限定符将在函数声明中被丢弃（因此它不参与函数签名），但将在函数定义中强制执行。

有一些编码标准建议您应该将值参数作为`const`（并返回`const`值），以避免对参数进行潜在的不需要的修改。我不太同意这个理由，但确实如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T16:59:53.110

`const`有2个一般效果：

*   它迫使程序员遵守标准。由于您不能在不声明的情况下将非常量变量传递给 const 参数`mutable`，因此调用函数的程序员知道他的变量不会被函数更改。
*   更重要的是 - 编译器可以根据这些信息进行优化，并在内部保存一些副本，或进行内联扩展，或其他任何事情，如果没有事先知道被调用函数*永远不会*更改数据，这是不可能的，因为它只是可以不。

# database - 如何保存数据库以在 jsp Web 应用程序中使用

> ID：16042784
> 
> 赞同：0
> 
> 时间：2013-04-16T16:55:53.007
> 
> 标签：database, jsp, web, pgadmin

我正在尝试创建我的第一个非常简单的网络应用程序。我在 pgadmin 中创建了我的数据库，但我不知道如何保存它，因此我可以通过我的 Web 应用程序执行基本的 sql 操作，例如 INSERT、DELETE、ADD 等。请帮我。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:02:46.787

您应该在服务器端 Java 代码（即 Servlet）上执行 DB 操作。所以 JSP 只会接受用户请求并将其传递给相应的 Servlet。然后Servlet可以通过JDBC代码采取适当的行动与DB通信（或者你也可以使用像Hibernate这样的ORM工具）

# ruby - ruby（rubyinstaller）和cygwin在循环中使用gets方法的奇怪行为

> ID：16042785
> 
> 赞同：1
> 
> 时间：2013-04-16T16:55:54.380
> 
> 标签：ruby, while-loop, cygwin, cycle, gets

我一直在 windows xp 下的 cygwin 终端中运行相当多的 ruby​​ 控制台脚本，到目前为止使用 ruby​​installer 的 ruby​​ 1.9.3-p28 没有问题。

突然间，我注意到了这种奇怪的行为。我有以下简单的代码：

```
while input = gets
  puts input
  puts "ok"
end 
```

这在控制台中没有任何输出。似乎该`input = gets`部分由于某种原因使 while 循环挂起。如果我以这种方式更改脚本

```
while true
  puts "ok"
end 
```

*虽然循环*`input = gets`按预期工作，但如果我在它下面添加行`puts "ok"`再次挂起，奇怪的是它甚至没有在挂起之前将“ok”写入控制台。似乎它完全没有做任何事情，Windows 任务管理器显示 ruby​​ 进程根本没有活动。

我也尝试过`loop do end`循环，但行为完全相同。

相反，如果我根本不使用循环，一切都会正常。

我所能理解的是，它与循环内的 stdin 获取方法有关。

我想是否有人可以帮助我调试这里到底发生了什么。

更新（更多信息）：脚本在 Windows 命令外壳中正确工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:41:09.067

我修复了它：

```
require 'win32console' if RbConfig::CONFIG['host_os'].include? "mingw32" 
```

我不知道我必须将“win32console”gem 与 cygwin 终端一起使用，即使在 II 没有输出颜色的情况下，到目前为止我一直在使用“win32console”和“colorize”gem 来使颜色起作用windows xp 本机命令提示符。

我会在我的代码顶部提醒这一点......

# ios - @implementation 中的私有变量

> ID：16042793
> 
> 赞同：4
> 
> 时间：2013-04-16T16:56:14.447
> 
> 标签：ios, objective-c

在.m 中声明一些私有元素而不是在.h 上执行@property 是一种好习惯吗？

而且，如果可以，这些元素是否被视为`weak`？

示例：（在 .m 的顶部）

```
 @implementation ParticipantMaterials{
        UIImageView *imgBackground;
        UILabel *lblTitle;
        UITableView *tvTableContent;
        NSMutableDictionary *tblElements;
    } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-16T17:00:25.043

在`@implementation`区域中声明变量时，您声明的是实例变量，而不是属性。你没有`@synthesize`ivars。如果要声明对公共 .h 文件隐藏的私有属性，可以像这样创建它们：

```
@interface ParticipantMaterials ()

@property (nonatomic) NSUInteger uintProp;
@property (nonatomic, copy) NSString* strProp;

@end 
```

这称为类扩展。

默认情况下会考虑实例变量`strong`，除非您指定`__weak`类型修饰符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-16T17:11:26.930

如果你想声明私有变量，这些声明中的任何一个都可以：

```
@interface Animal : NSObject {
    @private
    NSObject *iPrivate;
}
@end

@interface Animal(){
    @public
    NSString *iPrivate2;
}
@property (nonatomic,strong) NSObject *iPrivate3;
@end

@implementation Animal {
    @public
    NSString *iPrivate4;
}
@end 
```

我添加了@public 以指出它没有区别。所有这些变量都是私有的，如果您尝试从子类或不同的类中设置它们，它将导致`compiler error: undeclared identifier`or，在第一种情况下`compiler error: variable is private`。

默认情况下，ARC 下的所有对象变量都是强变量，因此您可以根据需要`strong`从 @property 中省略。

Objective-C 中的变量不是 100% 私有的。您可以使用运行时函数`class_getInstanceVariable`和`object_getIvar`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:11:19.053

.h 文件中的内容越少越好。所以是的，在 .m 文件中声明私有 ivars 和私有属性是一种很好的做法。

.h 文件应该只有真正的公共声明。

例子：

SomeClass.h：

```
@interface SomeClass : NSObject <NSCoding> // publicly state conformance to NSCoding

@property (nonatomic, copy) NSString *publicProperty;

- (void)somePublicMethod;

@end 
```

SomeClass.m

```
@interface SomeClass () <UIAlertViewDelegate> // implementation detail

@property (nonatomic, assign) BOOL privateProperty;

@end

@implementation SomeClass {
    UIAlertView *_privateAlert; // private ivar
}

// all the methods

@end 
```

所有这些都利用了现代的 Objective-C 编译器。不需要明确的`@synthesize`行（尽管如果合适的话仍然可以使用它们）。无需为每个属性声明 ivars（尽管可以在适当的情况下声明）。

请注意，在 ARC 下，ivars 和局部变量是`strong`，而不是`weak`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T18:46:43.837

您还必须注意，在 64 位架构上，llvm 编译器为 @property 中声明的 iVar 保留内存，因为 Obj-C 2.0 和英特尔 64 位 CPU，我不再指定我的 iVar。

OOP 范式指定默认情况下，所有实现的 iVar 都是**私有的**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-08T09:44:53.923

```
@interface PassedAndCorrectTableVC ()
{
NSMutableArray *arrPassesdListName;

NSMutableArray *arrCorrectListNmae;

NSMutableArray *arrTotalName;
}
@end 
```

# ios - iOS GPS SDK 时间戳

> ID：16042805
> 
> 赞同：0
> 
> 时间：2013-04-16T16:56:53.527
> 
> 标签：ios, gps

我需要使用 iOS 位置 API 访问 GPS 时间戳。我知道 GPS 位置结构中有一个时间戳，但我似乎无法确认这是否来自 GPS 卫星。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:59:07.960

您无法获取原始 GPS 数据，并且in的`timestamp`属性是使用系统时钟设置的。这是几个测试运行`CLLocation``locationManager:didUpdateLocations:`

系统时钟正确：

```
16/04/2013 18:53:42
16/04/2013 18:53:42 
```

时钟设置（在 iPhone 设置中）提前 2 小时：

```
16/04/2013 20:55:55
16/04/2013 20:55:56 
```

# ebay-api - Ebay 交易 API - GetOrders 显示未支付的订单

> ID：16042808
> 
> 赞同：1
> 
> 时间：2013-04-16T16:56:59.793
> 
> 标签：ebay-api

我调用了交易 API 将方法 GetOrders 状态为“完成”（在 ebay 的文档中，该方法适用于结帐和付款已完成的其他人），但它显示未支付的订单，并且付款方式上显示“CCAccpeted” .

这`CCAccepeted`不是付款，在 ebay 的管理部分，这些订单位于“等待付款”中。

我怎样才能只得到那些支付的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:55:05.513

这是因为 `OrderStatus`您在调用中使用的字段`getOrders`将所有具有检查点的订单作为完成返回，无论它们是否已付款。

在这种情况下，eBay 通常会返回默认付款值。

要检查在哪些订单中支付了哪些订单，`complete`您需要查看节点`OrderArray.Order.OrderStatus`作为响应。如果订单完成，则付款。

您还可以查看`OrderArray.Order.PaidTime`订单何时付款

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-21T09:31:30.443

您可以使用 PaymentStatus 响应：

更多详情： [https ://developer.ebay.com/devzone/xml/docs/Reference/eBay/types/PaymentStatusCodeType.html](https://developer.ebay.com/devzone/xml/docs/Reference/eBay/types/PaymentStatusCodeType.html)

根据文档：此值表示买方的订单付款已结清。CheckoutStatus.eBayPaymentStatus 值“NoPaymentFailure”和 CheckoutStatus.Status 值“Complete”表示结帐已完成。

# ios - 在 Doxygen 文档中添加定义的值

> ID：16042818
> 
> 赞同：0
> 
> 时间：2013-04-16T16:57:27.473
> 
> 标签：ios, doxygen, c-preprocessor

我使用 Doxygen 来记录我的代码，但我找不到如何`#define`在文档中添加值。我试过这个[发现here](http://doxygen.10944.n7.nabble.com/Doxygen-for-multiple-defines-td493.html)：

```
 /**
  * @brief test
  */
   #define definedValue @"aValue" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:41:49.463

如果您希望定义的值出现在文档中，您可以使用[\showinitializer](http://www.doxygen.nl/manual/commands.html#cmdshowinitializer)命令。文档注释也可以与 using 出现在同一行`#define`：

```
#define definedValue @"aValue" /**< Description of defined variable */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-03T11:34:40.900

This should work:

```
/**
 * \def definedValue
 *
 * @brief test
 */
#define definedValue @"aValue" 
```

See also: [http://www.doxygen.nl/manual/commands.html#cmddef](http://www.doxygen.nl/manual/commands.html#cmddef)

# android - Admob 未显示

> ID：16042819
> 
> 赞同：0
> 
> 时间：2013-04-16T16:57:28.597
> 
> 标签：android, admob

我正在尝试在我开发的应用中添加 AdMob。

这是我的xml：

```
<LinearLayout 
    android:id="@+id/container"
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:orientation="vertical"
    tools:context=".MainActivity" >
    <com.google.ads.AdView
        xmlns:googleads="http://schemas.android.com/apk/lib/com.google.ads"
        android:id="@+id/ad"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        googleads:adSize="BANNER"
        googleads:adUnitId="###########" />
</LinearLayout> 
```

我在 onCreate 方法中的代码：

```
//ads
AdView adView = (AdView) findViewById(R.id.ad);
adView.loadAd(new AdRequest()); 
```

LogCat 提供如下内容：

```
Received ad url <url: http://googleads..... 
```

所以它以某种方式工作，但在我的应用程序上，我从来没有看到任何横幅。你知道发生了什么吗？

我遵循了本教程： [http:](http://androcode.es/2012/05/monetizando-nuestras-apps-admob-en-android/) //androcode.es/2012/05/monetizando-nuestras-apps-admob-en-android/ Aswel 为[http://developer.android.com/intl/es/training/monetization /ads-and-ux.html](http://developer.android.com/intl/es/training/monetization/ads-and-ux.html)

但没有一个幸运的。

**编辑：** 哦，忘了提到我在清单中有这两行：

```
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/> 
```

例如，如果我删除了这些权限中的任何一个，则会显示 AD**说**缺少一些权限。所以我认为布局很好。

**Edit2：** 还尝试将此代码设置为用于测试目的，并且发生的情况完全相同：

```
adRequest.addTestDevice("#############"); 
```

**Edit3：** 我读过第一次可能需要很长时间。可能需要多长时间？因为我已经等了大约30分钟。logcat 会说它收到了广告吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:59:03.907

解决了。显然它在模拟器上工作：在 xml 文件中添加了这个：

```
googleads:loadAdOnCreate="true" 
```

# git - git checkout 上一页

> ID：16042823
> 
> 赞同：3
> 
> 时间：2013-04-16T16:57:51.657
> 
> 标签：git, git-checkout, git-reflog

有没有一种简单的方法可以切换回您最近在当前分支之前所在的分支？与命令行中的“cd -”相同的概念。

在多个分支上工作时，这可能很有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:59:51.800

做就是了：

```
git checkout - 
```

注意破折号。这会检查您在当前分支之前所在的最新分支。

如您所见，语法类似于`cd -`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T03:27:36.730

如果没有@KlasMellbourn 的回答，我永远不会找到这个，但这实际上是在[git-checkout(1)](https://www.kernel.org/pub/software/scm/git/docs/git-checkout.html)手册页中提到的（在描述部分`<branch>`）：

```
As a special case, the "@{-N}" syntax for the N-th last branch checks out the
branch (instead of detaching). You may also specify - which is synonymous with
"@{-1}". 
```

# javascript - 在 crafty.js 中的精灵上显示背景

> ID：16042824
> 
> 赞同：1
> 
> 时间：2013-04-16T16:57:53.283
> 
> 标签：javascript, craftyjs

在一个小型的 crafty.js 项目中，我使用了一个精灵作为背景图像，但它呈现在其他精灵之上。我该如何解决？主场景代码如下：

```
 Crafty.scene('game', function () {
    Crafty.background('bg');
    Crafty.e("Background, DOM, 2D, bg")
          .attr({ x: 0, y: 0});
      drawStage();
    points = 0;
    updatePoints();

    var speed = 1; // Number of frames per second

    // Game objects

    var appleEvent = Crafty.bind('EnterFrame', function () {
      if (randomInt(0, 60) === 0) {
        Crafty.e('Apple')
              .attr({
                x: randomInt(1, 19) * cell,
                y: randomInt(1, 16) * cell
              });
      }
    });
  }, function () {
    Crafty.unbind('EnterFrame', appleEvent);
  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T18:47:22.090

目前尚不清楚“bg”的来源，但我遇到了类似的问题，背景图像覆盖了前景内容。这个论坛帖子有答案：[https ://groups.google.com/forum/?fromgroups=#!topic/craftyjs/pdxcYi8T_j8](https://groups.google.com/forum/?fromgroups=#!topic/craftyjs/pdxcYi8T_j8)

基本上，我没有将实体分配给背景，而是将图像 URL 路径分配给本地文件：

```
Crafty.background("url('path/to/image.png')"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-22T20:09:09.940

具体设置实体的z-index怎么样？

```
var img_w = 1024;
var img_h = 768;
var bg = Crafty.e("2D, DOM, Image").attr({ w: img_w, h: img_h });
bg.z = 0; 
```

稍后在代码中：

```
var player = Crafty.e();
player.z = 1; 
```

# c# - 在 C# 代码隐藏中更改 jQueryMobile CSS 属性

> ID：16042825
> 
> 赞同：0
> 
> 时间：2013-04-16T16:57:57.363
> 
> 标签：c#, asp.net, jquery-mobile

再会！

我有这个：

```
<div data-role="collapsible">
        <h3 runat="server" id="myID">
                ISA Testing
        </h3>
        <p>
                Important content.
        </p>
</div> 
```

我想根据 C# 代码隐藏中的一些逻辑更改 jQueryMobile 可折叠标题的“h3”背景颜色。在我获得“h3”节点的句柄后，我试图在我的代码隐藏中执行此操作：

```
h.Style["background"] = "red"; 
```

它不起作用。关于我如何能够完成这项工作的任何指示？.NET 运行时将“h3”节点分类为`HtmlGenericControl`，如果这有任何重要性的话。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:16:19.130

In your code behind you will want to do

```
 myID.Attributes.Add("CssToAdd","ValueForCss"); 
```

so for color:

```
 myID.Attributes.Add("Color","Red"); 
```

# winapi - Windows - 阻止吐司通知的代码？（Win32/MFC 桌面）

> ID：16042828
> 
> 赞同：10
> 
> 时间：2013-04-16T16:58:07.377
> 
> 标签：winapi, toast

我可以在 toast 通知上找到的所有内容都是关于如何发送它们或解决发送它们的问题。

我有一个全屏桌面应用程序，我想在它运行时阻止吐司弹出。

到目前为止，我发现这样做的唯一方法是手动 - 组策略，用户转到 Windows 设置。

在 toast 通知上的 MS 文档列出了一个属性来告诉你 toast 是否被阻止，但它是只读的，所以你不能用代码设置它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-08T08:18:06.837

**您可以使用NOC_GLOBAL_SETTING_TOASTS_ENABLED**值禁用通知（祝酒词）

# django - 如何在 Django 模型中存储 ForeignKey 列表？

> ID：16042829
> 
> 赞同：1
> 
> 时间：2013-04-16T16:58:07.907
> 
> 标签：django, django-models

我正在建立一个用户可以*购买*球员的平台（比如幻想联赛）。所以我有4个模型：

```
POSITION_CHOICES = ((1,'1'),
                    (2,'2'),
                    (3,'3'),
                    (4,'4'),
                    (5,'5'),
)

class Team(models.Model):
    ...

class Player(models.Model):
    team = models.ForeignKey(Team, blank=True, null=True, ...)
    position = MultiSelectField(
    user = models.ForeignKey(User, unique=True)
    player1 = models.ForeignKey(Player, related_name='+', blank=True,null=True,
                                limit_choices_to={'position__icontains':1},...)
    player2 = ...
    player3 = ...
    player4 = ...
    player5 = ...
    ...

class FantasyTeams(models.Model):
    user = models.ForeignKey(User, unique=True)
    team1 = models.ForeignKey(Team, verbose_name='Team', blank=True, null=True,
                              on_delete=models.SET_NULL)
    ... 
```

基本上 a`Team`包含 0 或更多`Players`。`FantasyPlayers`和都是`FantasyTeams`用户购买的球员和球队（他可以购买 0 到 5 名球员和 0 到 1 支球队，但这些数字可能会改变）。LUTION 我目前的做法很丑，即使它有效。我现在正在寻找更简洁的东西（因为我觉得这根本不是通用的），比如替换包含列表的`player#`字段。我也愿意将 2 个模型和合并为一个，其中包含一个球员列表（最多 5 个）、一个团队列表（最多 1 个）和它的用户。`players``ForeignKey``FantasyPlayers``FantasyTeams``ForeignKey`

在查看类似问题时，我看到多次提到*一对多字段*，但它所做的只是让我更加困惑于`OneToOneField`和`ManyToManyField`.

你有什么方向可以让我`ForeignKey`在 Django 模型中存储一个列表吗？

* * *

## 解决方案

以下是替换以前的`FantasyPlayers`and `FantasyTeams`：

```
class FantasyTeam(models.Model):
    user = models.ForeignKey(User, unique=True)
    players = models.ManyToManyField(Player, blank=True, null=True)
    teams = models.ManyToManyField(Team, blank=True, null=True)
    ... 
```

这就是我现在创建和保存模型的方式（通过`ModelForm`）：

```
def fantasy_create(request):
    # Handling form datas
    if request.method == "POST":
        form = EditFantasyTeamForm(request.POST)
        if form.is_valid():
            fantasy = FantasyTeam.objects.create(user=request.user)
            for player in form.cleaned_data['players']:
                fantasy.players.add(player)
            for team in form.cleaned_data['teams']:
                fantasy.teams.add(team)
            return redirect(...)
    # Form is not submitted yet
    else:
        form = EditFantasyTeamForm()

    return render_to_response(...)

def fantasy_edit(request):
    # Fetching the FantasyTeam object
    fantasy = ...
    # Handling form datas
    if request.method == "POST":
        form = EditFantasyTeamForm(request.POST, instance=fantasy)
        if form.isLUTION_valid():
            form.save()
        return redirect(...)
    # Form not submitted yet
    else:
        form = EditFantasyTeamForm(instance=fantasy)

    return render_to_response(...)choices=POSITION_CHOICES, max_length=10)
    ...

class FantasyPlayers(models.Model):
    user = models.ForeignKey(User, unique=True)
    player1 = models.ForeignKey(Player, related_name='+', blank=True,null=True,
                                limit_choices_to={'position__icontains':1},...)
    player2 = ...
    player3 = ...
    player4 = ...
    player5 = ...
    ...

class FantasyTeams(models.Model):
    user = models.ForeignKey(User, unique=True)
    team1 = models.ForeignKey(Team, verbose_name='Team', blank=True, null=True,
                              on_delete=models.SET_NULL)
    ... 
```

基本上 a`Team`包含 0 或更多`Players`。`FantasyPlayers`和都是`FantasyTeams`用户购买的球员和球队（他可以购买 0 到 5 名球员和 0 到 1 支球队，但这些数字可能会改变）。LUTION 我目前的做法很丑，即使它有效。我现在正在寻找更简洁的东西（因为我觉得这根本不是通用的），比如替换包含列表的`player#`字段。我也愿意将 2 个模型和合并为一个，其中包含一个球员列表（最多 5 个）、一个团队列表（最多 1 个）和它的用户。`players``ForeignKey``FantasyPlayers``FantasyTeams``ForeignKey`

在查看类似问题时，我看到多次提到*一对多字段*，但它所做的只是让我更加困惑于`OneToOneField`和`ManyToManyField`.

你有什么方向可以让我`ForeignKey`在 Django 模型中存储一个列表吗？

* * *

## 解决方案

以下是替换以前的`FantasyPlayers`and `FantasyTeams`：

```
class FantasyTeam(models.Model):
    user = models.ForeignKey(User, unique=True)
    players = models.ManyToManyField(Player, blank=True, null=True)
    teams = models.ManyToManyField(Team, blank=True, null=True)
    ... 
```

这就是我现在创建和保存模型的方式（通过`ModelForm`）：

```
def fantasy_create(request):
    # Handling form datas
    if request.method == "POST":
        form = EditFantasyTeamForm(request.POST)
        if form.is_valid():
            fantasy = FantasyTeam.objects.create(user=request.user)
            for player in form.cleaned_data['players']:
                fantasy.players.add(player)
            for team in form.cleaned_data['teams']:
                fantasy.teams.add(team)
            return redirect(...)
    # Form is not submitted yet
    else:
        form = EditFantasyTeamForm()

    return render_to_response(...)

def fantasy_edit(request):
    # Fetching the FantasyTeam object
    fantasy = ...
    # Handling form datas
    if request.method == "POST":
        form = EditFantasyTeamForm(request.POST, instance=fantasy)
        if form.isLUTION_valid():
            form.save()
        return redirect(...)
    # Form not submitted yet
    else:
        form = EditFantasyTeamForm(instance=fantasy)

    return render_to_response(...) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:27:34.540

你应该使用一个`ManyToManyField`

```
players = models.ManyToManyField(Player, ...) 
```

但是只有当一个`Player`实例可以属于多个`FantasyPlayers`实例时才可以（同样的事情`Team`）如果一个`Player`实例只能属于一个`FantasyPlayers`实例，您应该反转关系并将一个`ForeignKey`字段`FantasyPlayers`放入`Player`模型中，然后您可以使用`related_field`访问列表`Player`来自一个实例的`FantasyPlayers`实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T19:41:14.590

这个解决方案怎么样？（我不确定`ManyToManyField`是不是最好的选择。）

```
class FantasyPlayer(models.Model):
    user = models.ForeignKey(User, unique=True)
    player = models.ForeignKey(Player)
    position = models.MultiSelectField(choices=POSITION_CHOICES, max_length=10)

# To get a list of players
user_fantasy_players = user.fantasyplayer_set.all() 
```

它的一个缺点是无法在编辑时`limit_choices_to`仅允许选择`Player`匹配位置`FantasyPlayer`（如您的示例所示），但这可以通过另一种方式解决。从长远来看，拥有更优雅和健全的数据架构更为重要，IMO。

# c# - XML 子元素反序列化抛出 InvalidOperationException

> ID：16042841
> 
> 赞同：0
> 
> 时间：2013-04-16T16:58:48.623
> 
> 标签：c#, xml, ixmlserializable

我正在尝试手动反序列化数据对象的层次结构（下面的完整代码），但得到一个我不明白的异常。

*   `DEMDataSet`包含`DemographicReportGroup`对象的集合。
*   `DemographicReportGroup`实现`IXmlSerializable`，包含`Agency`对象。
*   `Agency`对象包含叶数据项`dAgency.01`，又名`EMSAgencyUniqueStateID`。

我正在努力实现 for 的`ReadXml`方法`DemographicReportGroup`，但我得到一个异常抛出如下：

```
#region ReadXml
public void ReadXml(System.Xml.XmlReader xmlReader)
{
    xmlReader.MoveToContent();
    this.timeStamp = DateTime.Parse(xmlReader.GetAttribute("timeStamp"));
    if (xmlReader.IsEmptyElement) return;
    xmlReader.ReadStartElement();
    if (xmlReader.Name == "dAgency") 
    { 
        xmlReader.ReadStartElement("dAgency");
        // **Exception here: System.InvalidOperationException**
        this.Agency = new XmlSerializer(typeof(Agency)).Deserialize(xmlReader) as Agency; 
        xmlReader.ReadEndElement(); 
    }
    xmlReader.ReadEndElement();
}
#endregion 
```

> System.InvalidOperationException: <dAgency.01 xmlns=' [http://www.nemsis.org](http://www.nemsis.org) '> 不是预期的。

到目前为止，我发现的所有代码示例都表明这应该可以工作......也许这是 XML 属性的错误配置？

希望有人可以提供帮助！

另外，如果你好奇：

*   **你为什么要实施`IXmlSerializable`？**
    *   该`timeStamp`属性是日期/时间。如果它是一个 plain `DateTime`，它在被序列化时总是有一个值 (1/1/0001)。该`DateTime?`类型让我知道它何时没有值，但它不能序列化为属性。该示例所属的数据标准规定时间戳***必须***是一个属性。
*   **实现一个 ShouldSerializetimeStampValue 怎么样？**
    *   这将产生一个额外的属性和额外的方法（timeStampValue 和 ShouldSerializetimeStampValue），这对于一个数据项来说是太多的代码。此外，这不是我要处理的唯一时间戳。

* * *

完整代码（作为 Visual Studio 的单元测试）：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Xml.Serialization;  // System.Xml.dll.
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace Tests.Xml
{
    [TestClass]
    public class TestIXmlSerializable
    {
        [TestMethod]
        public void DeserializeChildElement()
        {
            var xml = @"<DEMDataSet xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://www.nemsis.org http://nemsis.org/media/XSD_v3/_nemsis_v3.3.1/3.3.1.130201/XSDs/NEMSIS_XSDs_v3.3.1.130201/DEMDataSet_v3.xsd""  xmlns=""http://www.nemsis.org"">
    <DemographicReport timeStamp=""1969-03-14T07:38:20+07:00"">
        <dAgency>
            <dAgency.01>M</dAgency.01>
        </dAgency>
    </DemographicReport>
</DEMDataSet>";

            var xmlSerializer = new XmlSerializer(typeof(DEMDataSet));

            DEMDataSet demDataSet = null;

            using (var streamReader = new StringReader(xml))
                demDataSet = xmlSerializer.Deserialize(streamReader) as DEMDataSet;

        }
    }

    [Serializable]
    /// <summary>Root Tag For Demographic DataSet</summary>
    [XmlType(AnonymousType = true, Namespace = "http://www.nemsis.org")]
    [XmlRoot(Namespace = "http://www.nemsis.org", IsNullable = false)]
    public partial class DEMDataSet
    {
        #region DemographicReportGroup
        private List<DemographicReportGroup> _demographicReportGroup;

        /// <summary>Container Tag to hold each instance of a demographic record</summary>
        [XmlElement("DemographicReport")]
        public List<DemographicReportGroup> DemographicReportGroup
        {
            get
            {
                return this._demographicReportGroup;
            }
            set
            {
                this._demographicReportGroup = value;
            }
        }
        #endregion

    }

    [Serializable]
    public partial class DemographicReportGroup : IXmlSerializable
    {
        #region Agency
        private Agency _agency;

        /// <summary></summary>
        [XmlElement("dAgency", IsNullable = false)]
        public Agency Agency
        {
            get
            {
                return this._agency;
            }
            set
            {
                this._agency = value;
            }
        }
        #endregion

        #region timeStamp
        private DateTime? _timeStamp;

        /// <summary></summary>
        [XmlAttribute]
        public DateTime? timeStamp
        {
            get
            {
                return this._timeStamp;
            }
            set
            {
                this._timeStamp = value;
            }
        }
        #endregion

        #region GetSchema
        public System.Xml.Schema.XmlSchema GetSchema()
        {
            return null;
        }
        #endregion

        #region ReadXml
        public void ReadXml(System.Xml.XmlReader xmlReader)
        {
            xmlReader.MoveToContent();
            this.timeStamp = DateTime.Parse(xmlReader.GetAttribute("timeStamp"));
            if (xmlReader.IsEmptyElement) return;
            xmlReader.ReadStartElement();
            if (xmlReader.Name == "dAgency") { xmlReader.ReadStartElement("dAgency"); this.Agency = new XmlSerializer(typeof(Agency)).Deserialize(xmlReader) as Agency; xmlReader.ReadEndElement(); }
            xmlReader.ReadEndElement();
        }
        #endregion

        #region WriteXml
        public void WriteXml(System.Xml.XmlWriter xmlWriter)
        {
            if (this.timeStamp.HasValue) xmlWriter.WriteAttributeString("timeStamp", this.timeStamp.Value.ToString("o"));
            if (this.Agency != null) { xmlWriter.WriteStartElement("dAgency"); new XmlSerializer(typeof(Agency)); xmlWriter.WriteEndElement(); }
        }
        #endregion
    }

    [Serializable]
    /// <summary></summary>
    [XmlType(Namespace = "http://www.nemsis.org")]
    [XmlRoot(Namespace = "http://www.nemsis.org", IsNullable = true)]
    public partial class Agency
    {
        #region EMSAgencyUniqueStateID
        private string _emsAgencyUniqueStateID;

        /// <summary>The unique ID assigned to the EMS Agency which is associated with all state licensure numbers and information.</summary>
        [XmlElement("dAgency.01")]
        public string EMSAgencyUniqueStateID
        {
            get
            {
                return this._emsAgencyUniqueStateID;
            }
            set
            {
                this._emsAgencyUniqueStateID = value;
            }
        }
        #endregion
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:27:02.947

如何使用 Linq To Xml

```
var xml = @"<DEMDataSet xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://www.nemsis.org http://nemsis.org/media/XSD_v3/_nemsis_v3.3.1/3.3.1.130201/XSDs/NEMSIS_XSDs_v3.3.1.130201/DEMDataSet_v3.xsd""  xmlns=""http://www.nemsis.org"">
                <DemographicReport timeStamp=""1969-03-14T07:38:20+07:00"">
                    <dAgency>
                        <dAgency.01>M</dAgency.01>
                    </dAgency>
                </DemographicReport>
            </DEMDataSet>";

var xDoc = XDocument.Parse(xml);
XNamespace ns = "http://www.nemsis.org";
var result = xDoc.Descendants(ns + "DemographicReport")
                .Select(d => new DemographicReportGroup
                {
                    timeStamp = (DateTime)d.Attribute("timeStamp"),
                    Agency = new Agency{EMSAgencyUniqueStateID = d.Descendants(ns + "dAgency.01").First().Value}
                })
                .ToList(); 
```

* * *

```
public class DemographicReportGroup
{
    public Agency Agency { set; get; }
    public DateTime timeStamp;
}

public class Agency
{
    public string EMSAgencyUniqueStateID { set; get; }
} 
```

# android - 如何更改应用程序的默认存储

> ID：16042845
> 
> 赞同：0
> 
> 时间：2013-04-16T16:59:01.157
> 
> 标签：android

这是我的示例代码，它将从图库中选择的图像保存到应用程序内存中`/data/data/com.isummation.customgallery/files/`。但我想将文件路径更改为`/data/data/com.isummation.customgallery/files/photos`. 我需要做什么？我如何改变它？

```
package com.isummation.customgallery;

import com.database.DataBase;

public class AndroidCustomGalleryActivity extends Activity {

private int count;
private Bitmap[] thumbnails;
private boolean[] thumbnailsselection;
private String[] arrPath;
private ImageAdapter imageAdapter;

Cursor imagecursor;

int image_column_index;

Button selectBtn;

ProgressDialog myProgressDialog = null;

DataBase db;
        public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.gallery);

    showProgress();
    new Thread() {
        public void run() { 
             try
            {
                loadFeed();
                android.os.Message alertMessage = new android.os.Message();
                alertMessage.what = 1;
                handle.sendMessage(alertMessage);
            }
            catch(Exception e)
            {   
                android.os.Message alertMessage = new android.os.Message();
                alertMessage.what = 2;
                handle.sendMessage(alertMessage);       
            }
        }
     }.start();

    selectBtn = (Button) findViewById(R.id.selectBtn);
    selectBtn.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            // TODO Auto-generated method stub

            showProgress();
            new Thread() {
                public void run() { 
                     try
                    {
                        SelecedtPhotos();
                        android.os.Message alertMessage = new  
           android.os.Message();
                        alertMessage.what = 3;
                        handle.sendMessage(alertMessage);
                    }
                    catch(Exception e)
                    {   
                        android.os.Message alertMessage = new  
       android.os.Message();
                        alertMessage.what = 2;
                        handle.sendMessage(alertMessage);       
                    }
                }
            }.start();

        }
    });

}

public static byte[] getBitmapAsByteArray(Bitmap bitmap) {
    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    bitmap.compress(CompressFormat.PNG, 0, outputStream);       
    return outputStream.toByteArray();
}

public class ImageAdapter extends BaseAdapter {

    private LayoutInflater mInflater;

    public ImageAdapter() {
        mInflater = (LayoutInflater)  
          getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    public int getCount() {
        return count;
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;

        if (convertView == null) {

            holder = new ViewHolder();
            convertView = mInflater.inflate(R.layout.galleryitem,   
   null);
            holder.imageview = (ImageView)   
  convertView.findViewById(R.id.thumbImage);
            holder.checkbox = (CheckBox)  
  convertView.findViewById(R.id.itemCheckBox);

            convertView.setTag(holder);
        }
        else 
        {
            holder = (ViewHolder) convertView.getTag();
        }

        holder.checkbox.setId(position);
        holder.imageview.setId(position);

        holder.checkbox.setOnClickListener(new OnClickListener()  
       {            
            public void onClick(View v) {
                // TODO Auto-generated method stub
                CheckBox cb = (CheckBox) v;
                int id = cb.getId();

                if (thumbnailsselection[id])
                {
                    cb.setChecked(false);
                    thumbnailsselection[id] = false;
                } 
                else 
                {
                    cb.setChecked(true);
                    thumbnailsselection[id] = true;
                }
            }
        });

        /*holder.imageview.setOnClickListener(new OnClickListener()  
      {         
            public void onClick(View v) {
                // TODO Auto-generated method stub
                int id = v.getId();
                Intent intent = new Intent();
                intent.setAction(Intent.ACTION_VIEW);
                intent.setDataAndType(Uri.parse("file://" +  
          arrPath[id]), "image/*");
                startActivity(intent);
            }
        });*/

        holder.imageview.setImageBitmap(thumbnails[position]);
        holder.checkbox.setChecked(thumbnailsselection[position]);
        holder.id = position;

        return convertView;
    }
}
class ViewHolder {
    ImageView imageview;
    CheckBox checkbox;
    int id;
}

public void loadFeed()
{
    final String[] columns = { MediaStore.Images.Media.DATA,  
       MediaStore.Images.Media._ID };
    final String orderBy = MediaStore.Images.Media._ID;

    imagecursor = managedQuery(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,  
         columns, null,null, orderBy);

    image_column_index =  
       imagecursor.getColumnIndex(MediaStore.Images.Media._ID);

    this.count = imagecursor.getCount();

    this.thumbnails = new Bitmap[this.count];

    this.arrPath = new String[this.count];

    this.thumbnailsselection = new boolean[this.count];

    for (int i = 0; i < this.count; i++) 
    {
        imagecursor.moveToPosition(i);
        int id = imagecursor.getInt(image_column_index);
        int dataColumnIndex =  
     imagecursor.getColumnIndex(MediaStore.Images.Media.DATA);
        thumbnails[i] =  

    MediaStore.Images.Thumbnails.getThumbnail
   (getApplicationContext().getContentResolver(),  
   id,MediaStore.Images.Thumbnails.MICRO_KIND, null);
        arrPath[i]= imagecursor.getString(dataColumnIndex);
    }

    imagecursor.close();
  }

 private void showProgress()
    {
        myProgressDialog =   
 ProgressDialog.show(AndroidCustomGalleryActivity.this,null,
 "Loading Data...", true); 
    }

    private void hideProgress()
    {
        if (myProgressDialog != null)
            myProgressDialog.dismiss();
    }

   ///////////////////// Get File Name from path ////////////////////////////
public String FileName(String path)
{
    String f = " /";
    boolean c = false;

    for(int i=path.length()-1;i>0;i--)
    {
        if(c == false)
            if(path.charAt(i) == f.charAt(1))
            {
                c = true;
                return  
  path.substring(i+1,path.length());        
            }
    }

    return "";
}

///////////////////// Get Extension from path ////////////////////////////
   public String fileExt(String audio)
    {
    String fileName = "";
    String f = " .";
    boolean c = false;

    for(int i=audio.length()-1;i>0;i--)
    {
        if(c == false)

            if(audio.charAt(i) == f.charAt(1))
            {
                fileName = audio.substring(i+1,audio.length());
                c = true;
            }
    }

    return fileName;
  }

  public void SelecedtPhotos()
  {

    final int len = thumbnailsselection.length;
//  int cnt = 0;

    for (int i =0; i<len; i++)
    {
        if (thumbnailsselection[i])
        {
            //cnt++;

            BitmapFactory.Options options = new  
   BitmapFactory.Options();
            options.inSampleSize = 8; 
            options.inPreferredConfig = Bitmap.Config.ARGB_8888;

            Bitmap bitmap = BitmapFactory.decodeFile(arrPath[i],  
   options);

            try {

                FileOutputStream outputStream =  
   openFileOutput(FileName(arrPath[i]), Context.MODE_PRIVATE);
                outputStream.write(getBitmapAsByteArray(bitmap));
                outputStream.close();
            } catch (Exception e) {
                e.printStackTrace();
            }

            db = new DataBase(getBaseContext()); 
            try {
                db.createDataBase();
            } catch (IOException e1) {
                e1.printStackTrace();
            }

            db.insert_update("INSERT INTO Photos(name,ext,path) 
  VALUES  ('"+FileName(arrPath[i])+"','"+fileExt(arrPath[i])+"','"+arrPath[i]+"')");

            db.close();

            File file = new File(arrPath[i]);
            boolean t = file.delete();

        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:29:38.600

Instead of:

```
FileOutputStream outputStream = openFileOutput(FileName(arrPath[i]), Context.MODE_PRIVATE); 
```

you will need to do something more like this:

```
File photos=new File(getFilesDir(), "photos");
photos.mkdirs();
FileOutputStream outputStream=new FileOutputStream(new File(photos, FileName(arrPath[i]))); 
```

# arrays - 跟踪迭代数组中的元素数量？

> ID：16042847
> 
> 赞同：1
> 
> 时间：2013-04-16T16:59:09.203
> 
> 标签：arrays, perl, foreach, special-variables

有什么方法可以在 perl 中跟踪 for 循环中迭代的元素数量：就像使用特殊变量一样：

```
@arrayElements = (2,3,4,5,6,7,67);
foreach (@arrayElements) {
    # Do something
    # Want to know how may elements been iterated after 
    # some n number of elements processed without using another variable.
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:07:25.793

要么在你走的时候算数：

```
my $processed = 0;
foreach my $element (@array_elements) {
    ...
    ++$processed;
} 
```

或迭代索引：

```
foreach my $index (0..$#array_elements) {
    my $element = $array_elements[$index];
    ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T17:10:30.800

在 perl5 v12 及更高版本中，您可以使用`each`迭代器：

```
while(my($index, $element) = each @array_elements) {
  ...;
} 
```

然而，更便携的解决方案是迭代索引，并手动访问元素，如*ysth*所示。

在任何情况下，访问过的元素（包括当前元素）的数量都是`$index + 1`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T07:07:34.847

您可以将数组中的元素数设为

```
 my $num = @arrayElements;
    print $num; 
```

或者

```
 my $num = scalar (@arrayElements);
   print $num; 
```

或者

```
 my $num = $#arrayElements + 1;
   print $num; 
```

为了查找迭代的元素数量，我们可以使用以下代码：

```
my $count = 0;  #initially set the count to 0
foreach my $index(@arrayElements)
{
  $count++;
}
print $count; 
```

# c# - 使用 MVC Web API 发布对象数组

> ID：16042853
> 
> 赞同：29
> 
> 时间：2013-04-16T16:59:35.823
> 
> 标签：c#, deserialization, asp.net-web-api

我有一个基本的后期操作，适用于`RecordIem`. 我想做的是通过使用相同格式发布一组请求来批量执行相同的操作。

例如：

```
public HttpResponseMessage Post(RecordItem request)
{
    var recordItems = _recorder.RecordItem(request);
    return Request.CreateResponse(HttpStatusCode.OK, recordItems);
} 
```

当我发布 Json 时：

```
{
    Id : "7UP24fVkGOxSjrcclghe_mP2-po",
    System : 1,
    Environment : "Production"
} 
```

一切正常。我想发布类似于：

```
{
    Id : "7UP24fVkGOxSjrcclghe_mP2-po",
    System : 1,
    Environment : "Production"
},
{
    Id : "ClPE188H4TeD2LbQPeV_EzCsKVM",
    System : 1,
    Environment : "Production",
    Label : "RestTest1"
},
{
    Id : "SAWTMJzm-_AFqoNw70-gLeUzB4k",
    System : 1,
    Environment : "Production"
} 
```

并有一个类似于下面的方法来选择这个：

```
public HttpResponseMessage Post(RecordItem[] request)
{
    var recordItems = _recorder.RecordItems(request);
    return Request.CreateResponse(HttpStatusCode.OK, recordItems);
} 
```

我尝试在数组上同时使用`[FromBody]`和`[ModelBinding]`属性，并尝试使用不同的类型（List、IList、IEnumerable），但无济于事。使用`[FromBody]`请求参数`null`时为空，使用`[ModelBinding]`列表时为空。我试过两者都用，也不管用。

我宁愿不必求助于在我的客户中循环单个帖子。

谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2014-10-01T11:52:06.017

对于所有他们尝试得到一个空数组的人，试试这个：

```
var request = $.ajax({
  dataType: "json",
  url: "/api/users",
  method: "POST",
  data: { '': postData}
}); 
```

数据必须是单个匿名对象，而不是原始数组。

信息在[这里](http://kwilson.me.uk/blog/post-an-array-of-objects-to-webapi-using-jquery/)找到。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-04-16T17:46:56.413

由于您`Post`期望一个`RecordItem[]`，因此您的请求正文中的 JSON 内容也应该在一个数组中。

你所拥有的非常接近 - 尝试`[]`在数据周围添加一对方括号：

```
[{
    Id : "7UP24fVkGOxSjrcclghe_mP2-po",
    System : 1,
    Environment : "Production"
},
{
    Id : "ClPE188H4TeD2LbQPeV_EzCsKVM",
    System : 1,
    Environment : "Production",
    Label : "RestTest1"
},
{
    Id : "SAWTMJzm-_AFqoNw70-gLeUzB4k",
    System : 1,
    Environment : "Production"
}] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T17:02:48.193

重要的是您的 json 包含`request`参数名称。另一个注意事项：您必须将其作为数组发布。

你的 json 看起来像这样：

```
{
    "request": [
        {
            "Id": "...",
            "System": 1,
            ...
        },
        { ... }
    ]
} 
```

# xml - XSLT 副本不保留空格

> ID：16042854
> 
> 赞同：2
> 
> 时间：2013-04-16T16:59:49.800
> 
> 标签：xml, xslt

在使用 xsl:copy-of 转换以下 xml 时 - 我的转换丢失了原始文档的格式 - 我根本不希望它触及原始文档。从字面上看，只是复制节点 - 原封不动

源 XML

```
 <flow>
    <flow>
      <material><mattext fontface="Arial"><p style="white-space: pre-wrap"><font size="11">The moon is the only extraterrestrial body to be visited by humans?</font></p></mattext>
</material>
    </flow> 
```

我得到这个结果

```
<flow><flow><material><mattext fontface="Arial" texttype="text/plain"><p style="white-space: pre-wrap"><font size="11">The moon is the only extraterrestrial body to be visited by humans?</font></p></mattext></material></flow> 
```

正如你所看到的，它把它放在一行上——为了我的目的，我需要保留空格（漂亮的打印不是一个选项）

我的 XSL 看起来像这样

```
<xsl:for-each-group select="qti:item" group-adjacent="(position()-1)">

<!-- Output the file-->
<xsl:result-document  href="{$filename}">
<questtag>
<!-- Output the contents-->
<xsl:copy-of select="current-group()"/>
</questtag>
</xsl:result-document>
</xsl:for-each-group> 
```

更新：好的 - 我发现如果我删除源文件 DTD，则保留空格 - 但这不是解决方案的选项

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T22:01:39.137

XSLT 2.0 指出，当源由 DTD 或模式验证的文档构造时，仅元素内容中的空白在到达 XSLT 处理器之前会被忽略/去除。因此，当 XSLT 看到它时，已经没有空格了。如果您希望空白很重要，则需要将内容模型声明为混合内容。

# c# - 来自 C# 接口的 Oracle 更新查询

> ID：16042860
> 
> 赞同：0
> 
> 时间：2013-04-16T17:00:01.357
> 
> 标签：c#, oracle, sql-update

我在 C# 中遇到更新查询问题。对我来说很奇怪，我在更新时遇到问题，但是选择、删除和插入工作。

```
 public void updateTeacherInfo(string SSN, string Classroom, string salary, string tenured, string phone)
    {

        OracleConnection conn = new OracleConnection("myconnectionstring;");

        conn.Open();
        OracleCommand cmd = new OracleCommand("Update Teachers Set classroom_number = :TRM, Salary = :TSALARY, Tenured = :TTENURE, Phone_numer = :TPHONE Where SSN = :TSSN", conn);
        OracleCommand commit = new OracleCommand("COMMIT", conn);
        cmd.Parameters.Add(new OracleParameter(":TSSN", SSN));
        cmd.Parameters.Add(new OracleParameter(":TRM", Classroom));
        cmd.Parameters.Add(new OracleParameter(":TSALARY", salary));
        cmd.Parameters.Add(new OracleParameter(":TTENURE", tenured));
        cmd.Parameters.Add(new OracleParameter(":TPHONE", phone));

       int i = cmd.ExecuteNonQuery();
       int k = commit.ExecuteNonQuery();

       MessageBox.Show(i + " rows affected");
       MessageBox.Show(k + " rows affected");

        conn.Close();

    } 
```

***编辑********其余的方法来清除事情，而且，它不会抛出任何错误，但不会更新数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-23T09:04:59.300

将Parameters.Add按正确的顺序放置。在您的更新查询中

```
"Update Teachers Set classroom_number = :TRM, Salary = :TSALARY, Tenured = :TTENURE, Phone_numer = :TPHONE Where SSN = :TSSN" 
```

:TRM 首先发生，同样如此。所以保持Parameters.Add也以相同的顺序。它会起作用的。顺序将是：

```
cmd.Parameters.Add(new OracleParameter(":TRM", Classroom));
cmd.Parameters.Add(new OracleParameter(":TSALARY", salary)); 
cmd.Parameters.Add(new OracleParameter(":TTENURE", tenured));
cmd.Parameters.Add(new OracleParameter(":TPHONE", phone));
cmd.Parameters.Add(new OracleParameter(":TSSN", SSN)); 
```

# c# - 具有多个 Classid 的 ActiveX

> ID：16042861
> 
> 赞同：0
> 
> 时间：2013-04-16T17:00:01.590
> 
> 标签：c#, javascript, activex

我创建了这个 ActiveX 控件并向 COM 公开了几个类，`[ComVisible(true)]`因此每个类都有自己的 classid（例如 GUID）。我使用以下 .inf 将所有内容打包在一个 cab 文件中：

```
[version]
signature="$CHICAGO$"
AdvancedINF=2.0

[Add.Code]
ActiveXInstaller.msi=ActiveXInstaller.msi

[ActiveXInstaller.msi]
file-win32-x86=thiscab
clsid={ 11EABF82-A840-48AE-B11A-A05DCAFCD0D4 }
clsid = { 60A1606C-7382-4EC6-A8F1-05428FAABE72 }

[Setup Hooks]
install=install

[install]
run=msiexec.exe /package """%EXTRACT_DIR%\ActiveXInstaller.msi""" /qn 
```

在我的 Javascript 中，我创建了 2 个对象：

```
var x = new ActiveXObject("ActiveX.Class1");
var y =  new ActiveXObject("ActiveX.Class2"); 
```

第一个对象（x）工作正常，我能够调用该类的方法，但对于第二个对象，我得到“自动化服务器无法创建对象”。

我看了一遍，但找不到任何解决方案。有什么办法可以解决这个问题吗？

提前致谢。

# angularjs - AngularJS 从指令中获取 $event

> ID：16042863
> 
> 赞同：8
> 
> 时间：2013-04-16T17:00:07.093
> 
> 标签：angularjs, angularjs-directive

看起来很简单，但我不能让 $event 从我的指令中冒出来。当从,`test`调用时未定义，但在指令之外（通过 html），它是事件对象。`cb-click``$event`

如果我使用链接函数（未包含在我的小提琴中），我可以得到`$event`，但我不能 $parse/$eval 它针对正确的范围。

[http://jsfiddle.net/langdonx/KgcGY/](http://jsfiddle.net/langdonx/KgcGY/)

```
<div ng-app="app" ng-controller="x">
    <!-- via directive -->
    <checkbox cb-model="y" cb-click="test($event, b)"></checkbox>
    <!-- via html -->
    <div><input id="c2" type="checkbox" ng-model="x" ng-click="test($event, 'a')"> <label for="c2">{{x}}</label></div> 
</div> 
```

-

```
var app = angular.module('app', []);

app.directive('checkbox', function ($parse) {
    return {
        restrict: 'E',
        replace: true,
        scope: {
            cbModel: '=',
            cbClick: '&'
        },
        template: '<div><input id="c1" type="checkbox" ng-model="cbModel" ng-click="cbClick($event, \'a\')"> <label for="c1">{{cbModel}}</label></div>'
    };
});

app.controller('x', function x($scope) {
    $scope.x = true;
    $scope.y = true;
    $scope.test = function (ev, b) {
        console.log('test called, ev is', ev, 'b is', b);
        return 'xyz';
    }
}); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T17:12:04.287

您需要在指令中使用此语法：

```
ng-click="cbClick({ev: $event, b:\'a\'}) 
```

使用此 HTML：

```
cb-click="test(ev, b)" 
```

[小提琴](http://jsfiddle.net/mrajcok/uvuJX/)

从[指令页面](http://docs.angularjs.org/guide/directive)，“指令定义对象”部分：

> 通常希望通过表达式将数据从隔离范围传递到父范围，这可以通过将局部变量名称和值的映射传递到表达式包装器 fn 来完成。例如，如果表达式是，那么我们可以通过调用as`increment(amount)`来指定金额值`localFn``localFn({amount: 22})`

# android - 在android中自定义editext输入

> ID：16042865
> 
> 赞同：0
> 
> 时间：2013-04-16T17:00:13.403
> 
> 标签：android

![](https://i.stack.imgur.com/1lsBN.png)

如何自定义给定图中显示的 editext 的输入类型。基本上我的要求是 edittext 应该只显示最后 3 位或 4 位数字，只有最初的 12 位数字应该处于密码模式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:27:24.900

您需要添加一个`TextWatcher`到`EditText`：

```
int characterCount = 0;
int asteriskCount = 0;
CharSequence input = null;
input.addTextChangedListener(new TextWatcher() {
    @Override
    public void onTextChanged(CharSequence s, int start, int before, int count) {
        characterCount = count;
        //update input sequence based on changes.
    }

    @Override
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        //update input sequence based on changes.
    }

    @Override
    public void afterTextChanged(Editable s) {
        if (asteriskCount != characterCount) {
            //make the visible sequence here.
            CharSequence seq = "";
            for (int i = 0; i < (characterCount <= 12 ? characterCount : 12); i++) {
                seq = seq + "*";
            }
            if (characterCount > 12) {

                for (int i = 12; i < characterCount; i++) {
                    seq = seq + characterCount.charAt(i);
                }
            }
            asteriskCount = characterCount;
            input.setText(seq);
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:11:39.047

没有这样的内置功能。所以你必须自己做。更改文本时，您必须对文本进行更改。这样做。

如果您通过扩展创建自定义 editText，`EditText`则可以覆盖[onTextChanged](http://developer.android.com/reference/android/widget/TextView.html#onTextChanged%28java.lang.CharSequence,%20int,%20int,%20int%29)方法并处理更改。

或者您可以使用[TextWatcher](https://www.google.com.bd/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&sqi=2&ved=0CCwQFjAA&url=http://developer.android.com/reference/android/text/TextWatcher.html&ei=iIZtUeXgDcTHrQfK0ICQBA&usg=AFQjCNF5WNMSztKb7uY5NdI7TsXHDjv_QQ&bvm=bv.45175338,d.bmk)来处理更改。

因此，当文本更改时，将除最后 3 位以外的数据设置为 *。

但请记住，您必须使用 String 字段将原始数据存储在字段中。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-06-07T13:02:22.973

**下面是我的 TextWatcher 的代码片段：**

```
 private boolean spaceDeleted;
        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            characterCount = start;
            //update input sequence based on changes.

        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count,
                int after) {
             // check if a space was deleted
            CharSequence charDeleted = s.subSequence(start, start + count);
            spaceDeleted = " ".equals(charDeleted.toString());

        }

        @Override
        public void afterTextChanged(Editable s) {
            if(s.length()>12){
                return;
                }
            System.out.println("Character Count in afterTextChange->"+characterCount);
            System.out.println("Editable Character->"+s);
            ccNumber.removeTextChangedListener(this);
             // record cursor position as setting the text in the textview
            // places the cursor at the end
            int cursorPosition = ccNumber.getSelectionStart();
            String withSpaces = formatText(s);
            ccNumber.setText(withSpaces);
            // set the cursor at the last position + the spaces added since the
            // space are always added before the cursor
            ccNumber.setSelection(cursorPosition + (withSpaces.length() - s.length()));

            // if a space was deleted also deleted just move the cursor
            // before the space
            if (spaceDeleted) {
                ccNumber.setSelection(ccNumber.getSelectionStart() - 1);
                spaceDeleted = false;
            }

            // enable text watcher
            ccNumber.addTextChangedListener(this);

        }

        private String formatText(CharSequence s) {
            // TODO Auto-generated method stub

            StringBuilder formatted = new StringBuilder();
            int count = 0;
            /* if(s.length()<12){
                formatted.append("*");
            }else{
                formatted.append(s.charAt(characterCount));
            }*/
            for (int i = 0; i < s.length(); ++i)
            {

                formatted.append("*");

                /*if (Character.isDigit(s.charAt(i)))
                {
                    if (count % 4 == 0 && count > 0)
                        formatted.append(" ");
                    formatted.append(s.charAt(i));
                    ++count;
                }*/
            }
            return formatted.toString();
        }
    }); 
```

# java - 如何在 Java 中实现这个泛型方法？

> ID：16042867
> 
> 赞同：2
> 
> 时间：2013-04-16T17:00:16.513
> 
> 标签：java, generics

我有一个像这样的界面

```
public interface Reader<T> {
    T read(Class<T> type,InputStream in);
} 
```

它是一个通用接口，旨在从流中读取**T类型的对象。**然后我知道我将处理的所有对象都是子类，比如说**S**。所以我创造了这个

```
public class SReader implements Reader<S>{
    S read(Class<S> type, InputStream in){
        // do the job here
    }
} 
```

但即使**S1**是**S**`Class<S1>`的子类，也不能分配给。我如何优雅地实现这一点？有界类型参数？我不明白这一点。我唯一的解决方案就是删除类型参数，例如`Class<S>`

 ****```
public class SReader implements Reader{
    // the other stuff
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:02:14.227

听起来你想要

```
public interface Reader<T> {
    T read(Class<? extends T> type,InputStream in);
} 
```****

# c++ - 吞吐量从 4k 下降到 9 条消息，调整后的 adm 更改

> ID：16042870
> 
> 赞同：2
> 
> 时间：2013-04-16T17:00:23.747
> 
> 标签：c++, c, linux

我有一个网络客户端和服务器应用程序。数据流是这样的，客户端向服务器发送消息，服务器以确认响应。只有在收到确认后，客户端才会秒下一条消息。

客户端应用程序，用 C++ 编写，有 3 个线程，即网络线程（负责通过套接字发送消息）、主线程（负责发出请求消息）和计时器线程（每秒触发一次）。

服务器应用程序有 2 个线程，主线程和网络线程。

我运行 RHEL 6.3、2.6.32-279 内核。

配置1

1.  调整的 adm 配置文件延迟性能
2.  所有客户端的线程在同一个 CPU Core id 上
3.  所有服务器的线程都在相同的 CPU 核心 ID 上，但与客户端线程的核心 ID 不同
4.  客户端和服务器在同一台机器上运行

吞吐量：每秒 4500 条消息

配置2

1.  调整的 adm 配置文件吞吐量性能
2.  所有客户端的线程在同一个 CPU Core id 上
3.  所有服务器的线程都在相同的 CPU 核心 ID 上，但与客户端线程的核心 ID 不同
4.  客户端和服务器在同一台机器上运行

吞吐量：每秒 9-15 条消息

配置3

1.  调整的 adm 配置文件吞吐量性能
2.  不同 CPU Core id 上的所有客户端线程
3.  不同 CPU Core id 上的所有 Server 线程，以及来自 Client 线程的不同 Core Id
4.  客户端和服务器在同一台机器上运行

吞吐量：每秒 1100 条消息

机器的负载可以忽略不计。当配置文件从延迟性能切换到吞吐量性能时，有人可以解释每秒 4k 条消息下降到 9 条消息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-01T15:15:18.663

以下是 RHEL tune-adm 配置文件之间差异的基本时间表：

延迟性能将 I/O 升降机转移到截止日期，并将 CPU 调控器更改为“性能”设置。

吞吐量性能针对网络和磁盘性能进行了优化。具体看下面...

您的工作负载似乎对延迟敏感。

![在此处输入图像描述](https://i.stack.imgur.com/wIvj1.png)

这是`throughput-performance`带有评论的设置。`latency-performance`不修改任何这些。

```
# ktune sysctl settings for rhel6 servers, maximizing i/o throughput
#
# Minimal preemption granularity for CPU-bound tasks:
# (default: 1 msec#  (1 + ilog(ncpus)), units: nanoseconds)
kernel.sched_min_granularity_ns = 10000000

# SCHED_OTHER wake-up granularity.
# (default: 1 msec#  (1 + ilog(ncpus)), units: nanoseconds)
#
# This option delays the preemption effects of decoupled workloads
# and reduces their over-scheduling. Synchronous workloads will still
# have immediate wakeup/sleep latencies.
kernel.sched_wakeup_granularity_ns = 15000000

# If a workload mostly uses anonymous memory and it hits this limit, the entire
# working set is buffered for I/O, and any more write buffering would require
# swapping, so it's time to throttle writes until I/O can catch up.  Workloads
# that mostly use file mappings may be able to use even higher values.
#
vm.dirty_ratio = 40 
```

# java - RichFaces 4.2 日历 - 如何通过 JavaScript 设置日历的输入字段？

> ID：16042874
> 
> 赞同：0
> 
> 时间：2013-04-16T17:00:37.607
> 
> 标签：java, javascript, richfaces

我必须将客户端的日期字符串复制到日历输入字段“renewal_date_input”。以下 JavaSript 不起作用：

```
document.getElementById('AddressDetails:renewal_date_input').value = renewalDateCombo.value.toString(); 
```

虽然有：

```
alert("written date is: " + document.getElementById('AddressDetails:renewal_date_input').value); 
```

我们可以读出之前写的正确的日期字符串。但是该字符串没有出现在输入字段中。手动输入启用：

```
enableManualInput="true" 
```

`setInputField: function(dateStr, event)`也许带有丰富面孔的 JavaScript 函数`calendar.js`会有所帮助，但我该如何使用它呢？

# sql - 请解释TSQL代码：

> ID：16042875
> 
> 赞同：-4
> 
> 时间：2013-04-16T17:00:38.037
> 
> 标签：sql, tsql

有人可以帮助解释以下代码：

```
convert(datetime, substring(column, 0, 23)) 
```

这里发生了什么？代码是否转换日期时间字段并返回它？如果是这样，那么它应该返回什么格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:08:17.320

这个词的`CONVERT`意思是“将某些东西变成不同的形式”（参见[http://dictionary.reference.com/browse/convert](http://dictionary.reference.com/browse/convert)）。该`CONVERT`函数将第二个参数中给出的任何内容更改为第一个参数中给出的类型（如果可能）。

`SubString`检索开始和结束索引之间的字符串部分（在本例中为位置`0`和`23`）。

因此，该语句使用 SubString() 从给定的索引中检索列的一部分，并将该字符串值转换为`DATETIME`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:06:23.527

您的代码正在将可以在 substring 方法指定的列上找到的前 23 个字符转换为将具有日期时间作为其类型的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T18:04:53.993

把答案（检查）给艾伦，因为他是第一个
但这将帮助你理解

```
select convert(datetime, substring(column, 0, 23)), 
                         substring(column, 0, 23) , 
                                   column 
from ... 
```

# jquery - jQuery 如何正确设置间隔？

> ID：16042878
> 
> 赞同：0
> 
> 时间：2013-04-16T17:00:53.007
> 
> 标签：jquery, slider, setinterval, intervals

目前我有这个，但它一直返回“swapBKgnd is no defined”：

```
 var interval = self.setInterval("swapBKgnd()", 9000);

function swapBKgnd() {

    (direction === 'next') ? ++current : --current;

    if (current === 0) {
        current = imgsLenth;
        direction = 'next';
    } else if (current - 1 === imgsLenth) {
        current = 1;
        loc = 0;
    }

    transition(sliderUL, loc, direction);
}; 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:03:44.917

从 中删除引号`swapBKgnd()`。

使用可以做：

```
var interval = self.setInterval(swapBKgnd, 9000); 
```

你还没有声明`direction`，`current`或者`loc`-那些会抛出错误

# ruby-on-rails - 使用 redis 存储在 rails 和 node.js 之间共享身份验证

> ID：16042879
> 
> 赞同：6
> 
> 时间：2013-04-16T17:00:55.183
> 
> 标签：ruby-on-rails, node.js, authentication, devise, redis

我有一个 rails 应用程序和一个 node.js 应用程序，我使用 Devise 对用户进行身份验证。我用 Redis 存储会话。现在我希望当用户访问节点应用程序时，应用程序通过 socket.io 检查用户是否登录。我设法从 redis 获取会话数据，但我不知道如何解释它们以检查用户是否已登录。

这是我的节点应用程序代码，它检查数据库中是否存在 _session_id 并检索会话数据：

```
io.set('authorization', function (data, accept) {
    if (data.headers.cookie) {
        data.cookie = cookie.parse(data.headers.cookie);
        data.sessionID = data.cookie['_session_id'];
        redis.get(data.sessionID, function (err, session) {
            if (err || !session) {
                accept('Error', false);
            } else {
                data.session = session;
                console.log(session);
                accept(null, true);
            }
        });
    } else {
       return accept('No cookie transmitted.', false);
    }
}); 
```

这是 console.log(session) 给我的：

```
{I"_csrf_token:EFI"1HPglfkCCagvb1LLraU1CEEyx7AtDzztqAEPY5G5lNgY=;FI"warden.user.user.key;TI"    User;F[iI""$2a$10$IHq2WAhwbaqR4WWajRE/Yu;T 
```

如何检查用户是否使用节点应用程序登录 Rails 应用程序？谢谢

**编辑：**看来我使用的redis store gem 在将会话存储到数据库之前调用了Marshalling 方法。所以我通过重写 Marshalling 方法绕过了这个问题，并将会话数据存储为 JSON 格式。它不是很优雅，所以如果你找到更好的方法在 rails 和 node.js 之间共享会话，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T04:30:10.373

创建自己的 oauth api 可能更容易（有一个关于如何执行此 oauth 的 railscast）。据我所知，devise 是一个 ruby​​ gem，并不是真正的跨平台，但 oauth 几乎可以在任何语言中使用。您可以添加一个 oauth 令牌来设计应该允许您将该令牌传递给 node.js。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-26T06:22:20.663

[您可以轻松地对 Rails-Cookie-Parser for Express https://github.com/instore/rails-cookie-parser](https://github.com/instore/rails-cookie-parser)库中的 index.js 方法进行一些调整，以便在没有 Express 的情况下使用它。

该库使用 Marshal npm 作为其依赖项

注意：您可能需要 decodeURIComponent("cookie value") 因为原始 cookie 是 URL 编码的

# python - Python中hasattr的逆

> ID：16042880
> 
> 赞同：4
> 
> 时间：2013-04-16T17:01:00.407
> 
> 标签：python

`hasattr(obj, attribute)`用于检查一个对象是否具有指定的属性，但给定一个属性是否有办法知道它在哪里（全部）定义？

假设我的代码将属性（或类方法）的名称作为字符串获取，并且我想调用`classname.attribute`但我没有类名。

我想到的一个解决方案是

```
def finder(attr):
    for obj in globals():
        try:
            if globals()[obj].__dict__[attr]:
                return(globals()[obj])
        except:
            ... 
```

用法：

```
class Lime(object):
    @classmethod
    def lfunc(self):
        print('Classic')

getattr(finder('lfunc'),'lfunc')() #Runs lfunc method of Lime class 
```

我很确定这不是最好的（甚至是正确的方法）。有人可以提供更好的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:25:16.657

它总是“可能的”。是否可取是另一段历史。

一种快速而肮脏的方法是对所有类进行线性迭代，并检查是否有任何定义了您拥有的属性。当然，这会发生冲突，它将产生第一个具有这种命名属性的类。如果它存在多个，则由您决定您想要哪个：

```
def finder(attr):
    for cls in object.__subclasses__(): 
         if hasattr(cls, attr):
              return cls
    raise ValueError 
```

而不是在“全局”中搜索，而是搜索“对象”的所有子类 - 因此要找到的类不需要位于`finder`函数所在模块的命名空间中。

但是，如果您的方法在您正在搜索的一组类中是唯一的，也许您可​​以只组装所有方法的映射并使用它来调用它们。

假设您的所有类都来自名为“Base”的类：

```
mapper = {attr_name:getattr(cls, attr_name)  for cls in base.__subclasses__() for attr_name, obj in cls.__dict__.items()
             if isinstance(obj, classmethod) } 
```

你打电话给他们`mapper['attrname']()`

这避免了在每个方法调用时进行线性搜索，因此会好得多。

**- 编辑 -**

`__subclassess__`只需找到一个类的直接子类，而不是继承树 - 所以它在“现实生活”中没有用 - 也许它在特定情况下是 OP 掌握的。
如果需要在继承树中查找东西，还需要递归每个子类。

至于旧式类：当然这是行不通的——这是在新代码中默认破坏它们的动机之一。

至于非类属性：无论如何只能在检查实例时找到它们 - 所以必须考虑另一种方法 - 这里似乎不是 OP 关心的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:24:08.520

这可能会有所帮助：

```
import gc

def checker(checkee, maxdepth = 3):

    def onlyDict(ls):
        return filter(lambda x: isinstance(x, dict), ls)

    collection = []
    toBeInspected = {}
    tBI = toBeInspected
    gc.collect()
    for dic in onlyDict(gc.get_referrers(checkee)):
        for item, value in dic.iteritems():
            if value is checkee:
                collection.append(item)
            elif item != "checker":
                tBI[item] = value

    def _auxChecker(checkee, path, collection, checked, current, depth):
        if current in checked: return
        checked.append(current)
        gc.collect()
        for dic in onlyDict(gc.get_referents(current)):
            for item, value in dic.iteritems():
                currentPath = path + "." + item
                if value is checkee:
                    collection.append(currentPath)
                else:
                    try:
                        _auxChecker(checkee, currentPath, collection,
                                    checked, value, depth + 1)
                        if depth < maxdepth else None
                    except TypeError:
                        continue
    checked = []
    for item, value in tBI.iteritems():
        _auxChecker(checkee, item, collection, checked, value, 1)
    return collection 
```

**如何使用：**

```
referrer = []

class Foo:        
        pass          

noo = Foo()       
bar = noo         
import xml        
import libxml2    
import sys        
import os         
op = os.path      
xml.foo = bar     
foobar = noo      

for x  in checker(foobar, 5):
    try:
        y= eval(x)
        referrer.append(x)
    except:
        continue

del x, y 
```

*ps：被检查者的属性不会被进一步检查，对于被检查者本身的递归或嵌套引用。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:39:45.680

这应该适用于所有情况，但仍需要大量测试：

```
import inspect
import sys

def finder(attr, classes=None):
    result = []
    if classes is None:
        # get all accessible classes
        classes = [obj for name, obj in inspect.getmembers(
            sys.modules[__name__])]
    for a_class in classes:
        if inspect.isclass(a_class):
            if hasattr(a_class, attr):
                result.append(a_class)
            else:
                # we check for instance attributes
                if hasattr(a_class(), attr):
                    result.append(a_class)
            try:
                result += finder(attr, a_class.__subclasses__())
            except:
                # old style classes (that don't inherit from object) do not
                # have __subclasses; not the best solution though
                pass
    return list(set(result))  # workaround duplicates

def main(attr):
    print finder(attr)
    return 0

if __name__ == "__main__":
    sys.exit(main("some_attr")) 
```

# python - 为什么我的 wx.App 会干扰我的 matplotlib 绘图？

> ID：16042881
> 
> 赞同：0
> 
> 时间：2013-04-16T17:01:03.233
> 
> 标签：python, matplotlib, wxpython

我正在尝试使用 wxPython 构建一个 GUI 来控制一个相当稳定、完善的模型。该模型的标准输出包括一系列通过 matplotlib 完成的屏幕图。如果模型是从命令行运行的，这些图都是可以的。但是，如果我从新的 GUI 运行，它们都会显示出来，但我无法控制它们：我无法单击它们各自的“保存”按钮；如果它们被其他窗口覆盖，则在移开阻挡窗口时它们会“变灰”。像这样的东西。但是，如果我关闭我的 GUI 窗口，我将再次完全控制我的绘图。但这不是运行此代码的方法。

我认为我的程序非常标准。代码的基本轮廓是：

```
import wx
import model_code

class gui_for_model(wx.Frame):
    # lots of stuff with hooks into model_code,
    # including a "go" button that starts model_code running

#end of class

app=wx.App(False)
gm = gui_for_model()
app.MainLoop() 
```

有人知道我应该做些什么不同的事情吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T18:32:02.113

这是一个站点的链接，其中包含一些使用 matplotlib 和 wxPython GUI 的演示代码。 [eli.thegreenplace.net/2008/08/01/matplotlib-with-wxpython-guis](http://eli.thegreenplace.net/2008/08/01/matplotlib-with-wxpython-guis)

还有这个 - [matplotlib.org/faq/usage_faq.html](http://matplotlib.org/faq/usage_faq.html)谈论改变后端。

我在 pypi [pypi.python.org/pypi/wxmplot/0.9.12上找到了一个包](http://pypi.python.org/pypi/wxmplot/0.9.12)

# javascript - 不重复按钮中的操作

> ID：16042884
> 
> 赞同：0
> 
> 时间：2013-04-16T17:01:08.833
> 
> 标签：javascript, jquery, html, function, button

我正在一些按钮中进行一些转换，这些按钮将显示一些内容，当您按下按钮时，内容滑动和淡出，其他内容淡入并滑动到 vew，效果非常好，但是当您按两次相同的按钮时它只是滑动并淡出然后再次出现，如果已经显示该部分，我希望不能按下按钮。

我给你留下我用于该功能的代码：

```
 $(".btns-segur-desarr ul").on("click", changeArticule);

function changeArticule (data) {
    var target = data.target.className;
    var secciones = ["#seccion-fuego","#seccion-bateria","#seccion-sismo","#seccion-extintor"];
    $("#" + target).css("right", -"80");

    for (var i = 0; i < secciones.length; i++) {
        if($(secciones[i]).hasClass("aVista")){
            $(secciones[i]).animate({
                right: "40",
                opacity: "0"
            });
        $(secciones[i]).removeClass("aVista");
        }
    };

    $("#" + target).addClass("aVista");
    $("#" + target).animate({
        right:"0",
        opacity: "1"
    })

} 
```

如果有人能帮助我得到这个我将不胜感激我正在学习 java Script 和 j 查询并且只是卡住了：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:58:47.353

您可以使用 jQuery 的`.one()`绑定来确保事件触发一次且仅触发一次。但是，当您想要重新启用按钮时，这将要求您重新绑定事件。

更好的解决方案是让您的事件在单击时添加一个类，然后检查该类以查看它是否应该再次触发。例如： `$(data.target).addClass("clicked")` 和 `if ($(data.target).hasClass("clicked")) return false;`

当您想要重新启用该按钮时，这将为您提供更多的灵活性。

# dictionary - Swagger HashMap 属性类型

> ID：16042885
> 
> 赞同：20
> 
> 时间：2013-04-16T17:01:12.410
> 
> 标签：dictionary, swagger, openapi

有没有办法在模型部分定义 HashMap 或 Generic Object 类型？我有一个返回产品的 REST 服务，这些产品可以有不同的选项。options 属性基本上是一个 HashMap，其中 id 是选项名称，其值是选项值。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2016-04-19T07:30:14.277

是的，这是可能的。

在 OpenAPI (fka. Swagger) 2.0 和 3.0 中，hashmap 始终是一个`<string, something>`映射：

*   键始终是字符串，不需要定义。
*   值类型是您想要的，并用`additionalProperties`.

假设您想描述一个`<string, string>`像这样的哈希图：

```
{
  "key1": "value1",
  "key2": "value2"
} 
```

相应的 OpenAPI 2.0 定义将是：

```
definitions:
  StringStringMap:
    type: object
    additionalProperties:
      type: string 
```

在 OpenAPI 3.0 中，定义将是：

```
components:
  schemas:
    StringStringMap:
      type: object
      additionalProperties:
        type: string 
```

像这样的`<string, object>`哈希图

```
{
  "key1": {"someData": "data", "someOtherData": true},
  "key2": {"someData": "data2", "someOtherData": false}
} 
```

将在 OpenAPI 2.0 中以这种方式定义：

```
definitions:
  ComplexObject:
    type: object
    properties:
      someData:
        type: string
      someOtherData:
        type: boolean

  StringObjectMap:
    type: object
    additionalProperties:
      $ref: "#/definitions/ComplexObject" 
```

在 OpenAPI 3.0 中：

```
components:
  schemas:
    ComplexObject:
      type: object
      properties:
        someData:
          type: string
        someOtherData:
          type: boolean

    StringObjectMap:
      type: object
      additionalProperties:
        $ref: "#/definitions/ComplexObject" 
```

我刚刚在[我的 OpenAPI（fka Swagger 教程）的第 4 部分](http://apihandyman.io/writing-openapi-swagger-specification-tutorial-part-4-advanced-data-modeling/)中深入介绍了这一点。

OpenAPI [(fka. Swagger) 规范也简要说明了这一点](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#model-with-mapdictionary-properties)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-12T09:34:05.670

这对我有用。没有任何值类型限制

```
 definitions:
        dynamicFields:
          type: object
          additionalProperties: {} 
```

示例：您可以在此处传递任何类型的值

```
{
   "dynamicFields" : {
      "accountNo": "aaaaaa3455",
      "customerNo": 123455,
      "isApplicable": true,
      "phoneNo": [
        "38859379384",
        3948399448,
        true
      ]
    }
} 
```

# oracle - 如何在 Oracle 10g 中根据逗号分隔值显示逗号分隔描述？

> ID：16042889
> 
> 赞同：0
> 
> 时间：2013-04-16T17:01:23.873
> 
> 标签：oracle, oracle10g

我是 Oracle 技术的新手。早些时候，由于缺乏对要求的理解，我针对同一问题发布了 2 个帖子。

表格1：

```
MSGID
-----
1,2,3
2,3
4
null
null 
```

表 2：

```
MID   MSGDESC
----  -------
1     ONE
2     TWO
3     THREE
4     FOUR 
```

预期输出：

```
XCOL     DESC
-----    -----
1,2,3    ONE,TWO,THREE
2,3      TWO,THREE
4        FOUR 
```

我无法满足这个要求。请给我一个解决方案。

注意：表没有任何唯一或主键值。表 1 有 5000 条记录，表 2 只有 80 条带描述的记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:02:17.690

```
create table Table1 (MSGID varchar2(100));

insert into Table1 values ('1,2,3');
insert into Table1 values ('2,3');
insert into Table1 values ('4');
insert into Table1 values (null);
insert into Table1 values (null);

create table Table2 (MID varchar2(100), MSGDESC varchar2(100));

insert into Table2 values ('1','ONE');
insert into Table2 values ('2','TWO');
insert into Table2 values ('3','THREE');
insert into Table2 values ('4','FOUR'); 
```

* * *

```
select
  msgid as xcol, 
  "DESC", 
  col1, col2, ..., col12
from
  Table1
  left join (
    select
       msgid,
       wm_concat(msgdesc) as "DESC"
    from
       (
          select
             msgid,
             msgdesc
          from
             (select distinct msgid from Table1 where ...)
             cross join (
                select level as occ from dual connect by level <= 100)
             )
             left join Table2
                on mid = regexp_substr(msgid, '[^,]+', 1, occ)
          where
             occ <= regexp_count(msgid, ',') + 1
          order by msgid, occ
       )
    group by msgid
  ) using (msgid) 
```

# c# - URL 路由 C# mvc 和 Web 表单

> ID：16042892
> 
> 赞同：0
> 
> 时间：2013-04-16T17:01:31.947
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing, webforms

所以我有一个 webforms 和一个 mvc 应用程序组合，并试图让事情正确路由。我的默认路由按预期工作，但是当我在我的一个视图中单击操作链接时，它没有路由到正确的页面。

这是我的路由代码。

```
void RegisterRoutes(RouteCollection routes) {
           routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

           routes.MapPageRoute("",
               "", "~/Default.aspx", true);

            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Chips", action = "Index", id = UrlParameter.Optional }
            );

        }

        void Application_Start(object sender, EventArgs e)
        {
            // Code that runs on application startup

           AreaRegistration.RegisterAllAreas();

            WebApiConfig.Register(GlobalConfiguration.Configuration);
            FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
            RouteConfig.RegisterRoutes(RouteTable.Routes);
            RegisterRoutes(RouteTable.Routes);
            BundleConfig.RegisterBundles(BundleTable.Bundles);
            AuthConfig.RegisterAuth();

        } 
```

这是我要单击的操作链接：`@Html.ActionLink("Properties Editor", "Index", "Property")`

这是我的预期结果：`urlgoeshere.com/Property/Index`

这是我的实际结果：`urlgoeshere.com/?action=Index&controller=Property`

我不确定要改变什么来纠正这种情况？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T15:05:18.857

我最终不得不添加一个路由约束。这就是我最终做的事情。

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

          routes.MapPageRoute("",
               "", "~/Default.aspx", true, null, new RouteValueDictionary { { "outgoing", new PageConstraint() } });

            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Chips", action = "Index", id = UrlParameter.Optional }
            ); 
```

和页面约束。

```
public class PageConstraint : IRouteConstraint
    {
        public bool Match(HttpContextBase httpContext, Route route, string parameterName, RouteValueDictionary values, RouteDirection routeDirection)
        {
            if (routeDirection == RouteDirection.IncomingRequest)
                return true;
            return false;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T16:34:00.313

我认为这可能是因为第一个匹配的路由是 Default.aspx 路由，所以它使用 URL“”。在 MVC 中，任何提供但未包含在路径中的参数都会自动添加为查询字符串值。

路线按照它们定义的顺序被拾取，因此请尝试移动`routes.MapPageRoute("", "", "~/Default.aspx", true);`到默认路线之后。如果这样做，您可能需要删除控制器默认值，否则将为 URL "" 拾取此路由，该 URL "" 将传递给 Chips 控制器上的 Index 操作。

# php - 如何在 MySQL 中查找所有子行？

> ID：16042897
> 
> 赞同：0
> 
> 时间：2013-04-16T17:01:39.383
> 
> 标签：php, mysql

我有一个层次系统设置，将项目的级别和父 ID 存储在数据库中。我想弄清楚的是我将如何找到用户选择的所有子行。这是表结构的示例：

```
+----+---------+----------+-------+
| Id |  label  | parentid | level |
+----+---------+----------+-------+
|  1 | honda   |        0 |     1 |
|  2 | accord  |        1 |     2 |
|  3 | civic   |        1 |     2 |
|  4 | element |        1 |     2 |
|  5 | v4      |        2 |     3 |
|  6 | v6      |        2 |     3 |
+----+---------+----------+-------+ 
```

那么，如果有人删除`honda`，我将如何删除层次结构中的所有内容？数据库只会降到 3 级。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:04:24.847

参考，**[使用关系 innoDB 的递归 MySQL 查询](https://stackoverflow.com/questions/16019105/recursive-mysql-query-with-relational-innodb/16023509#16023509)**

我昨天发布了同样的答案

**更新：**

以下是`function`基于上述链接的，但已根据您的`DELETE`要求量身定制

```
CREATE PROCEDURE `delete_relations`(`_id` INT)
BEGIN
DECLARE  delete_row_ids varchar(200);
DECLARE id, id2 varchar(200);
DECLARE rows_affected int;

SET delete_row_ids  = _id;
SET id              = _id;
SET id2             = id;

WHILE id2 IS NOT NULL DO 
    SET id = NULL;
    SELECT GROUP_CONCAT( hierarchical_data.id ), CONCAT( GROUP_CONCAT( hierarchical_data.ID ),',',delete_row_ids) INTO id, delete_row_ids FROM hierarchical_data WHERE FIND_IN_SET( parentid , id2 ) GROUP BY parentid ;
    SET id2 = id;
END WHILE;  

DELETE FROM hierarchical_data where FIND_IN_SET(hierarchical_data.id, delete_row_ids);
SELECT row_count() INTO rows_affected;

if rows_affected > 0 THEN
SELECT delete_row_ids as row_ids_deleted;
ELSE
SELECT 'NO_ROWS_DELETED';
END IF;

END// 
```

[**SQLFiddle**](http://sqlfiddle.com/#!2/1bf54)

利用

```
CALL delete_relations(1) 
```

删除所有条目及其关系`id = 1 honda`

希望它有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:13:00.403

替换`:id`为以下要删除的根条目 id：

```
DELETE FROM table
WHERE
   id = :id 
   OR id IN (  
-- first level
SELECT DISTINCT id sid
FROM table
WHERE parentid = :id
-- second level
UNION
SELECT DISTINCT t2.id sid
FROM table t1
INNER JOIN table t2
ON t1.id = t2.parentid
WHERE t1.parentid = :id
-- third level
UNION
SELECT DISTINCT t3.id sid
FROM table t1
INNER JOIN table t2
ON t1.id = t2.parentid
INNER JOIN table t3
ON t2.id = t3.parentid
WHERE t1.id = :id
) 
```

请注意，您有 3 个级别，但根节点占据其中之一，这意味着您实际上只需要选择子孙。上面的查询多了一层（第三层），所以你可以删除`-- third level`右括号之后的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T19:19:50.243

假设您在具有触发器的 MySQL 5 上，您可以编写一个小的删除前触发器来轻松实现此目的。我没有完全检查语法，但会或多或少与以下内容匹配：

```
CREATE TRIGGER tr_tablename_bd BEFORE DELETE ON tablename
  FOR EACH ROW BEGIN
    DELETE FROM tablename WHERE parentID = deleted.id
END; 
```

上面的代码也适用于无限级别，而不仅仅是 3 个级别。您将需要删除一行，触发器将删除以下级别中的数据行或将已删除行标记为 parentID 的行。

然而，我隐约记得 MySQL 的一个问题，它无法启动级联触发器。这意味着 MySQL 由于另一个触发器上的操作而无法触发触发器。如果您正在使用的 MySQL 版本（甚至最新版本）中仍然存在该错误，则此代码将不起作用。但是，理论上它是完全可以的，并且肯定可以在所有其他具有触发器的数据库上工作。对于 MySQL，您只需要检查他们是否已设法解决该错误！

# c++ - 填充指针向量

> ID：16042899
> 
> 赞同：0
> 
> 时间：2013-04-16T17:01:48.303
> 
> 标签：c++, pointers, vector

请原谅我的菜鸟问题..

我有 ：

```
class A;
{
    public:
    A(int i) : m_i(i) {}
    int m_i;
}

A newA(i);
{
    return A(i);
} 
```

我想填充以下向量，但使用一个循环，其中一个对象 A 是用一个函数（newA）创建的：

```
vector<A*> list;

for (int i=0 ; i<3; ++i) {  A a = newA(i);  list.push_back(&a); } 
```

如果我使用 a`vector<A>`但不使用 a，那会起作用，`vector<A*>`因为我所做的只是更改 &a 处的值并将相同的指针 &a 推 3 次。

我怎样才能做到每次都创建一个新的 A ，而不是更改同一个指针的值。

我想出了以下方法，但我希望这不是唯一的方法，因为它包括动态分配..

```
A newA(i);
{
    return A(i);
}

vector<A*> list;

for (int i=0 ; i<3; ++i)
{
    A a = newA(i);
    list.push_back(new A(a));
} 
```

请注意，A 类实际上在内存中很大，因此有指针。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:05:02.643

您应该意识到第一种方法不好：

```
 for (int i=0 ; i<3; ++i) {  A a = newA(i);  list.push_back(&a); } 
```

您正在创建一个本地对象，然后存储一个指向它的指针。离开循环后，该对象将不再存在，并且您的行为未定义。正如约翰所说，如果不使用动态分配，就没有明智的方法来做你想做的事。正如比利所说，您可以使用`shared_ptr`or而不是使用原始指针`unique_ptr`，然后您不必担心内存管理，这可能是您想要避免动态分配的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:06:29.137

存储指针向量不会赋予 的结果实例的向量所有权`A`。为了填充这样的结构，将涉及动态分配。

（当然，在实际代码中，您可能应该创建 a`vector<unique_ptr<T>>`或 a`vector<shared_ptr<T>>`而不是 a，`vector<T*>`但这是另一个主题）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:06:02.200

这是唯一的方法，就像在您的第一个示例中一样，您存储指针的对象在 for 循环的每次迭代中都会立即销毁，因为它超出了范围。

# javascript - javascript - .replace() 正在处理一个字符串而不是另一个

> ID：16042901
> 
> 赞同：0
> 
> 时间：2013-04-16T17:01:57.763
> 
> 标签：javascript, jquery

使用 AJAX 将数据拉入数组中，一切正常，然后我有这个......

```
$.each(data, function (key, value){ 
            var add = value[5]+value[6];
            var sub = add.replace(" ","");
            var link = 'http://'+sub+'.mydomain.com';
}

//OUTPUT: http://RR1 Box 22USHIGHWAY 67.NextHomeTown.com 
```

这是行不通的。它不会替换任何空格字符。

现在，这就是有趣的地方。这适用于返回的具有空格的所有其他数据库条目。疯了吧？

是否存在某种类型的字符编码可能导致它无法识别此特定条目中使用的空格字符？MySQL 表将它们输入为`varchar`，但在此过程中，它们都只是文本字符串，对吗？所以应该没关系。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T17:03:33.123

这只会替换它将匹配的第一个空格键。使用它来替换所有空格键：

```
var sub = add.replace(/\s/g,""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:10:27.620

由于您使用其他表报告所需的行为，它可能不相关 - 但不要忘记在 javascript 中，字符串替换函数仅替换 searchString 的*第一个实例*，*除非*您使用正则表达式。

```
"red, red, red".replace(/ /g, "");
"red,red,red"

"red, red, red".replace(" ", "");
"red,red, red" 
```

# java - 使用带有 SqlJet 的 sqlite 虚拟表

> ID：16042913
> 
> 赞同：1
> 
> 时间：2013-04-16T17:02:27.290
> 
> 标签：java, sqlite, sqljet

我正在使用 SqlJet Java SqlLite 库。我创建了一个虚拟表，现在想在其中插入行。但是，我能找到的唯一插入方法适用于表对象，而不是虚拟表。当我尝试将虚拟表作为表访问时：

```
ISqlJetVirtualTableDef vtd =
     db.createVirtualTable(props.getProperty("CREATE_VIRTUAL_TABLE_QUERY"));
String virtual_table_name = vtd.getTableName();
ISqlJetTable table = db.getTable(virtual_table_name);
table.insert( etc. ) 
```

db.getTable(table_name) 方法抛出“找不到表”错误。这可能是意料之中的，但我不知道采取什么其他方法。

# dojo - 在 appcelerator Titan 中包含 dojo 工具包

> ID：16042925
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:02:52.993
> 
> 标签：dojo, titanium

我想在我的项目中使用 dojoToolkit。但是当我将它包含在 Ti.include('dojo/dojo/dojo.js') 中时，我收到一条错误消息“defineAlreadyDefined”。Titanium 在全局命名空间中有名为 define 的方法，在 dojo 中有类似名称的方法。还有一些其他名称相似的方法（例如，必需的）。我该如何使用它？

PS我为网络构建我的项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:38:51.973

Dojo 原样在 Titanium 中不起作用。Dojo 是一个浏览器工具包，而不是移动工具包，它可以访问仅适用于 Web 的东西。

[但是，这家伙把它移植到钛上，试试吧。](https://github.com/aehlke/titanium-dojo)

# postgresql - 在 Amazon EC2 上存储数据的建议，尤其是数据库

> ID：16042927
> 
> 赞同：7
> 
> 时间：2013-04-16T17:03:00.117
> 
> 标签：postgresql, amazon-web-services, amazon-ec2, amazon-ebs, lvm

我已经使用亚马逊的网络服务一年多了，但是我不太明白它是如何工作的。例如，当我从 EC2 控制台选择我选择的 AMI 并继续执行向导时，我会到达“存储配置选项卡”。这里有几个选项。

有根卷选项卡，然后是 EBS 卷选项卡。这两者有何不同？我可以为每个分配的最大大小是多少？如何配置 EBS 卷以与我的实例一起使用？例如，我决定创建 8 个 EBS 卷，每个卷具有 25 GB 的存储空间......现在对于自然存在于根设备上的 Postgresql 数据库之类的东西，我如何配置它以便数据库存储在所有 8 个 EBS 卷中？从某种意义上说，8 个 EBS 卷变成了一个 200 GB 的驱动器，而 postgres 数据库数据存储在整个驱动器上。

任何形式的澄清将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T23:32:36.727

您应该阅读[EBS 与实例存储的优势](https://stackoverflow.com/questions/3630506/benefits-of-ebs-vs-instance-store-and-vice-versa)。[我最近也在我的工作博客上](http://blog.2ndquadrant.com/postgresql_performance_on_ec2/)写了一点关于这个的 PostgreSQL 角度。另请参阅[用于新 EC2 实例的根设备](https://stackoverflow.com/questions/4500374/what-root-device-to-use-for-a-new-ec2-instance?rq=1)以及相关边栏中列出的其他问题。

除非您仔细设置复制和定期备份，否则实例存储最终会吃掉您的数据。如果实例失败或终止，如果它位于实例存储中，您将无法取回数据。无论如何，您都需要良好的备份，这对于实例存储更为重要，并且您需要更加小心地设置近实时复制。

另一方面，EBS 更容易受到中断和故障的影响，使其在一段时间内不可用；您的数据可能仍然存在，但如果您在几个小时内无法访问它，您将无法进行故障转移，直到故障得到修复。所以无论如何你真的需要好的备份和复制。

快速回答，我将在帖子中留下详细的解释：

*   根卷是 EBS 或实例存储，具体取决于 AMI 类型。

*   在卷选项卡中，您可以添加其他卷。无论 AMI 类型如何，您都可以在创建卷时选择这些是 EBS 还是实例存储卷。不同的实例大小对实例存储卷的数量和大小有不同的限制，但对 EBS 卷的限制都相同。

*   实例存储卷的最大大小由实例类型定义。请参阅您的实例的文档。[EBS 卷的最大大小在 EBS 文档](http://aws.amazon.com/ebs/)的第一段中：

    > Amazon EBS 卷在特定的可用区中创建，大小可以从 1 GB 到 1 TB。

*   PostgreSQL 数据库并没有真正“自然地存在于根卷上”。它住在你放的地方。如果您使用的是安装包管理器的版本，它通常会放在`/var/lib/pgsql`or`/var/lib/postgres`中，但您可以更改启动脚本选项以将其移动到其他位置，将其替换为指向所需位置的符号链接，或者在那一点。关于如何在 Stack Overflow、dba.stackexchange.com 和 serverfault 上移动 PostgreSQL 有很多讨论，所以我不会在这里重复所有这些。

*   要组合多个 EBS 卷，请使用 Linux 的软件 RAID (md)。就 Linux 而言，EBS 就像任何其他磁盘一样，因此请参阅设置 Linux 软件 RAID 的常用文档。

就我个人而言，我对 EC2 的性能非常不满意，至少对 PostgreSQL 来说是这样。您可以获得一个非常快速的数据库运行，但价格非常昂贵。如果您想为短期工作启动一些大型数据库，这非常方便，但作为长期托管选项并不经济，您最好寻找提供更好 I/O 性能的 VPS 提供商。搜索 ServerFault、dba.stackexchange.com 等。

最后，提醒一下：高 I/O 实例上的实例存储似乎比其他选项更快……但如果您必须关闭或重新启动实例或实例失败，您将丢失实例存储卷上的所有数据，因此，如果您要使用实例存储，则*必须*有良好的备份和实时复制。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-16T23:47:32.680

较短的答案是：

为了快速和肮脏，您可以在所有 EC2 实例上拥有实例存储，并备份到 S3。EBS 优于实例存储的优势在于，当您终止该服务器时，EBS 将保留并可以重复使用，而实例存储则不会。

200Gb 空间很小，你可以为它获取一个存储设备（实例存储），然后备份到 S3 或复制整个 200Gb 的东西。很有可能，您不会使用 RAID 或 haddrive 复制来提高数据库的可靠性/可用性。

tl;博士

除非您需要在服务器之间传输卷，否则请使用实例存储。

# c++ - 具有许可许可的稳健、快速的复杂多边形（带孔）三角剖分 c/c++ 库

> ID：16042940
> 
> 赞同：17
> 
> 时间：2013-04-16T17:03:41.450
> 
> 标签：c++, c, open-source, triangulation

我是开源游戏[Bitfighter](http://bitfighter.org)的开发者。根据以下 SO 帖子，我们使用了出色的“三角形”库来生成网格区域，以与我们的游戏内 AI（机器人）一起使用：

[带孔的多边形三角剖分](https://stackoverflow.com/questions/406301/polygon-triangulation-with-holes)

然而，当我们想为 Debian 打包我们的游戏时遇到了一个小障碍——使用“Triangle”库将使我们的游戏被认为是“非免费的”。

我们对“Triangle”库的性能非常满意，并不想放弃它；但是，我们也不喜欢处理许可证问题。因此，我们已经着手寻找合适的、获得许可的替代品，以在稳健性和速度方面与“Triangle”相媲美。

我们正在寻找用于将大而复杂的区域划分为三角形的 C 或 C++ 库，它可以处理以任何方式放置在一起的任何类型的不规则多边形以及孔。稳健性是我们的首要需求，速度几乎同样重要。

我找到[了 poly2tri](http://code.google.com/p/poly2tri/)，但它存在无法处理边缘重合的多边形的错误。

我们已经找到了几个库，但似乎都受到一件事或另一件事的影响：要么太慢，要么不处理漏洞，要么遭受一些错误。目前我们正在测试[polypartition](http://code.google.com/p/polypartition/)，我们寄予厚望。

什么是伟大的“三角形”库的最佳替代品，但拥有许可许可证？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-20T02:05:12.820

我找到了解决方案。毕竟它是[poly2tri](https://code.google.com/p/poly2tri/)，使用了出色的[Clipper](http://www.angusj.com/delphi/clipper.php)库，并在输入中添加了一些小的算法。

我们的流程如下：

1.  使用带有非零绕组的接头将我们所有的孔穿过 Clipper（这意味着内孔与外孔的缠绕方向相反）。Clipper 还保证很好的干净输入点，在 epsilon 内没有重复。
2.  将我们的孔过滤成逆时针和顺时针缠绕的孔。顺时针孔意味着孔是迂回的，并且内部还有另一个同心区域需要进行三角测量
3.  使用 poly2tri，对外部边界和找到的每个顺时针多边形进行三角测量，如果在其中一个边界内找到剩余的孔作为 poly2tri 的输入，则使用它们作为输入。

**结果：** poly2tri 似乎与 Triangle 一样快地进行三角剖分，并且到目前为止，我们对它所做的一切都非常健壮。

对于那些感兴趣的人，[这里是我们的代码更改](https://code.google.com/p/bitfighter/source/browse/zap/GeomUtils.cpp?spec=svnb9286436e08332dd50d7302bb111a6cf6654ad1a&r=b9286436e08332dd50d7302bb111a6cf6654ad1a#1046)。

**更新**

我已经尝试将我们的 Clipper-to-poly2tri 代码以及我们的稳健性添加到一个单独的库中，我从这里开始： [clip2tri](https://github.com/raptor/clip2tri)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T05:06:40.107

您可以查看 CGAL 的 2D Triangulations 包。[这里](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Triangulation_2/Chapter_main.html#Subsection_37.8.2)给出了一个用孔对多边形进行三角剖分的例子。该软件包的许可证是 GPLv3+。

请注意，如果需要，仅提取此包应该不会太难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-01T09:52:30.693

作为一个小旁注：

我最近不得不实现一个复杂的多边形剪裁器和三角剖分器，用于将窗框切割成房屋墙壁。

虽然我对 Vatti 剪裁器的结果很满意，但 poly2tri 中使用的 Delaunay 三角剖分太重，无法沿着墙壁表面的重心坐标平滑拖动窗框。在摸了摸头之后，我最终欺骗了这个更简单的三角形来处理孔：

[http://wiki.unity3d.com/index.php?title=Triangulator](http://wiki.unity3d.com/index.php?title=Triangulator)

我所做的是将墙面水平细分为最短剪裁多边形的高度。在我的情况下，它们总是矩形，但它们不一定是。无论如何，它会强制限幅器仅适用于常规或凹面多边形，因此您可以使用更便宜的三角测量方法。

以下是一些显示它工作的屏幕截图：

[https://www.dropbox.com/sh/zbzpvlkwj8b9gl3/sIBYCqa8ak](https://www.dropbox.com/sh/zbzpvlkwj8b9gl3/sIBYCqa8ak)

希望这可以帮助。

# objective-c - 如何使用本地 url 获取卷名（标签）？

> ID：16042941
> 
> 赞同：2
> 
> 时间：2013-04-16T17:03:41.840
> 
> 标签：objective-c, cocoa

我查看了 NSWorkSpace 和 NSFileManager 但我找不到我正在寻找的方法。

我有一个保存的网址（从 NSSavePanel 获取）。

IE。此 url 可以是 /Users/Josh/Some Folders/file.txt 或 /Volumes/My USB Key Name/file.txt

那么我可以使用这个 url 来找出显示的卷名吗？

`[[NSWorkspace sharedWorkspace] mountedLocalVolumePaths]`可以列出所有本地卷名，但在 os x 10.7 中已弃用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:46:15.447

找到了答案：

```
NSURL *savedPath = [NSURL fileURLWithPath:[saveURL.path stringByDeletingLastPathComponent]];
NSError *error;
NSString *volumeName;

[savedPath getResourceValue:&volumeName forKey:NSURLVolumeNameKey error:&error];
NSLog(@"volume name: %@ url: %@", volumeName, savedPath); 
```

# objective-c - 未调用 UIPopoverControllerDelegate 委托方法

> ID：16042942
> 
> 赞同：1
> 
> 时间：2013-04-16T17:03:43.000
> 
> 标签：objective-c, delegates, uipopovercontroller, popover, dismiss

我有一个带按钮的屏幕。单击该按钮将显示一个带有两个按钮的弹出框。当弹出框被解除时，我希望能够使用以下方法：

```
#pragma mark - UIPopoverControllerDelegate
- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController {
NSLog(@"OrderViewController.m -popoverControllerDidDismissPopover start");
} 
```

弹出视图有自己的类：

```
#import <UIKit/UIKit.h>
#import "MenuItemModel.h"

@interface SelectedItemsOptionsViewController : UIViewController
@property (weak) id <UIPopoverControllerDelegate> delegate;
@property (strong, nonatomic) MenuItemModel *item;

@end 
```

创建弹出框的类有：

```
@interface OrderViewController : UIViewController <PageViewControllerDelegate,                                        
UITableViewDataSource, UITableViewDelegate, ServiceConnectorDelegate,
UIPopoverControllerDelegate> 
```

所以 OrderViewController - 想知道 SelectedItemsOptionsViewController 何时被解雇。

我声明了方法（第一个代码块），并将委托设置为：

```
SelectedItemsOptionsViewController *destViewController = (SelectedItemsOptionsViewController *)segue.destinationViewController;

popSegue = (UIStoryboardPopoverSegue *)segue;

[destViewController setDelegate:self];
destViewController.item = toDisplay; 
```

因此，据我所知，我将委托设置为 OK ......委托属性在 SelectedItemsOptionsViewController.m 中是 @syntheized ，好吧，它让我有点发疯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:25:08.340

我可能在这里误解了一些东西，但看起来您正在为 UIViewController 类分配委托，但是您在情节提要中将 popOver 的委托分配到哪里？

# javascript - 无法在 phonegap 中使用 googlemaps 进行地理定位

> ID：16042943
> 
> 赞同：1
> 
> 时间：2013-04-16T17:03:43.493
> 
> 标签：javascript, cordova, jquery-mobile, jquery-plugins, google-maps-api-3

我尝试使用 jquery 在 Phonegap 的谷歌地图上进行地理定位。我尝试以下代码，但它不起作用。我得到了 alert("1") 但没有得到 alert("2") ：

```
alert("1");
            $('#map_canvas').gmap('getCurrentPosition', function(position, status) {
                  alert("2");
                  if ( status === 'OK' ) {
                  var clientPosition = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
                  $('#map_canvas').gmap({'center': clientPosition});
                  $('#map_canvas').gmap('addMarker', {'position': clientPosition, 'bounds': true});
                  $('#map_canvas').gmap('addShape', 'Circle', {
                                        'strokeWeight': 0,
                                        'fillColor': "#008595",
                                        'fillOpacity': 0.25,
                                        'center': clientPosition,
                                        'radius': 15,
                                        'clickable': false
                                        });
                  }
            }); 
```

一个主意 ？请 ：）

这些是我的 .js 文件：

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.ui.map.min.js"></script>
    <script type="text/javascript" src="js/jquery.ui.map.js"></script>
    <script type="text/javascript" src="js/jquery.ui.map.extensions.js"></script> 
```

map_canvas 在我的 html 中引用了这个 div： id="map_canvas" style="width:250px;height:250px"

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T21:31:38.910

为什么你使用`.gmap`函数来获取当前位置，而不是使用`navigator.geolocation`对象？此外，请确保您在设备准备就绪后调用地理定位 API——请参阅[此处](https://stackoverflow.com/a/5018461/1469208)了解更多详细信息。

# ruby - Ruby 的带有 [what?] 的 irb 相当于带有 IDLE 的 Python Shell？（在 Windows 上，如果相关。）

> ID：16042945
> 
> 赞同：1
> 
> 时间：2013-04-16T17:03:46.120
> 
> 标签：ruby, ide, irb

这是一个令人惊讶的难以找到答案的问题。

*（一些问题似乎在问至少类似的问题，例如：*

*[IRB 的 Ruby 控制台替代方案（Windows）](https://stackoverflow.com/questions/737497/ruby-console-alternative-for-irb-windows)*

*[IDLE 类似于 Ruby 的交互式控制台](https://stackoverflow.com/questions/3763140/idle-like-interactive-console-for-ruby)*

*[推荐的 Ruby 交互式控制台](https://stackoverflow.com/questions/11931498/a-recommended-ruby-interactive-console?rq=1)*

*但我无法从其中任何一个中得到我需要的东西。）*

另外，我有点不确定我应该使用的确切术语，所以我会在这里尽量具体：

假设您在 Python shell 中使用 IDLE。

您打开了 IDLE 的文本编辑器窗口之一，其中包含脚本“example.py”。

你按下 F5，Python shell 就会出现，如果你刚刚将“example.py”中的每一行逐行输入到 shell 中，它会做的事情。

从功能上讲，这正是它所做的就是自动输入每一行，而不会因为显示它们而弄乱屏幕。（此外，每次您执行此操作时，它都会将 shell 重置为新状态，但这并不是目前真正重要的一点；有时最好选择让它*不*重置 shell 的状态，无论如何。 )

所以结果是现在你可以在 shell 中玩耍了，你刚刚运行的脚本中的所有函数和变量等都在那里。

但是有了irb...

我如何获得相同的效果？

例如，我`irb example.rb`在 Windows 控制台中尝试过（等效的 ruby​​ 脚本），它只是将每一行逐个输入到 irb 中，将它们喷射到屏幕上，然后自动退出到 Windows 命令提示符。

（尽管这*确实*按我想要的方式工作（是否有一些选项标志性的参数可以使它在这里做更多我想要的事情？），我仍然需要从文本编辑器到控制台窗口的 alt-tab , 然后输入命令和文件名, 不如直接按 F5, obvs)

为了确保*我*清楚我的意思，这里有一些具体的例子：

1) “example.py”的 Python 脚本 2) 在 shell 中运行它然后在 shell 中做一些事情的示例（从实际 shell 复制粘贴）

3) 一个与 Python 等效的 Ruby 脚本 4) 在[repl.it](http://repl.it/Iaf/1/languages/Ruby)的 kludgy、缓慢的在线解释器中运行它的示例，并在该 irb shell 中执行完全相同的操作（再次，复制粘贴）

1）example.py：

```
x = "some value you don't want to keep reassigning to this variable"
y = "some other value like that"

def some_function(var):
    return "do something complicated with `"+var+"`"

print("example.py just ran") 
```

2）Python外壳：

```
Python 3.2.3 (default, Apr 11 2012, 07:15:24) [MSC v.1500 32 bit (Intel)] on win32
Type "copyright", "credits" or "license()" for more information.
>>> ================================ RESTART ================================
>>> 
example.py just ran
>>> x
"some value you don't want to keep reassigning to this variable"
>>> y
'some other value like that'
>>> print(some_function(x))
do something complicated with `some value you don't want to keep reassigning to this variable`
>>> x = "a frog"
>>> print(some_function(x))
do something complicated with `a frog`
>>> print("gonna run example.py again")
gonna run example.py again
>>> ================================ RESTART ================================
>>> 
example.py just ran
>>> print("x is back to: `\""+x+"\"`")
x is back to: `"some value you don't want to keep reassigning to this variable"` 
```

3）example.rb：

```
x = "some value you don't want to keep reassigning to this variable"
y = "some other value like that"

def some_function var
        "do something complicated with `#{var}`"
end

puts "test.rb just ran" 
```

[4) repl.it](http://repl.it/Iaf/1/languages/Ruby)上的在线 Ruby irb shell 东西：

```
Ruby 1.8.7 (2008-05-31 patchlevel 0) [x86-linux]
[GCC 4.2.1 (LLVM, Emscripten 1.5, Emscripted-Ruby)]

test.rb just ran
=> nil
   x
=> "some value you don't want to keep reassigning to this variable"
   y
=> "some other value like that"
   puts some_function x
do something complicated with `some value you don't want to keep reassigning to this variable`
=> nil
   x = "a frog"
=> "a frog"
   puts some_function x
do something complicated with `a frog`
=> nil
   puts "gonna run this script again..."
gonna run this script again...
=> nil

test.rb just ran
=> nil
   puts "x is back to: `\"#{x}\"`"
x is back to: `"some value you don't want to keep reassigning to this variable"`
=> nil 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T08:38:53.500

到目前为止，我发现的最佳答案似乎是安装**[pry](http://pryrepl.org/)**（`gem install pry`在命令提示符下输入）。

现在，如果您通过输入 运行脚本`pry scriptname.rb`，并且遇到异常，它将自动进入交互状态。

此外，如果您`require 'pry'`在顶部的脚本内添加，那么您可以在任意`binding.pry`位置放入脚本。

现在，当您运行脚本时（只需`scriptname.rb`在命令提示符下输入），它将停止执行并在此时进行交互式撬动。

按 ^D（即 ctrl-d）将恢复执行。

当您在编辑器（例如，Notepad++）中按 F5（或其他）时，让脚本在命令提示符窗口中运行显然有些棘手。[像这样的解决方案](http://scryptus.wordpress.com/2010/03/12/notepad-and-ruby/)有一些我还没有弄清楚如何调整的问题。

所以目前我只是 alt-tabbing 到命令提示符窗口并从那里运行脚本（同样，通过输入`pry scriptname.rb`或`scriptname.rb`，这取决于我到底想要什么以及我是否`binding.pry`在脚本中的任何地方放了 a 。向上箭头回忆，制表符完成，等等。）

我正在[努力弄清楚](https://stackoverflow.com/questions/16212147/ruby-pry-can-i-add-something-to-the-command-pry-example-rb-so-pry-automatica)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-21T14:13:05.893

我不是 100% 确定这是否是您想要的，但根据我的经验，使用`ruby scriptname.rb`将运行代码

# html - Google 协作平台 - 简单的内容和背景图片

> ID：16042946
> 
> 赞同：0
> 
> 时间：2013-04-16T17:03:48.620
> 
> 标签：html, image, google-sites

我正在尝试为我自己的个人网站设置 Google 协作平台：

```
<html>
<head>
<title>...</title>
</head>
    <body background="page_bg.png" text="#000000" bgcolor="#333333">
        <div align="center"><img src="content.jpg" border="0" alt=""></div>
    </body>
</html> 
```

所以我想要的只是一张背景图片（我在设置下完成了此操作），并且网站中间只有一张图片。我试图摆脱所有的噱头（例如侧边栏，框架的阴影等）但我失败了。甚至有可能做到这一点吗？

我使用 Google 协作平台的原因是，因为网址“ [https://sites.google.com/site/my_name_here/](https://sites.google.com/site/my_name_here/) ”很明确，它是免费的，它使我的网站出现在 google 搜索中。

* * *

编辑，我的解决方案：我找到了一个名为“空白模板（黑色）”的模板，其中不包含任何内容（没有侧边栏等）。我添加了自己的背景图片，插入了我的 content.jpg 并完成了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:26:46.243

我想你必须使用类似的东西：

```
<body style="background:#333333 url('page_bg.png'); color=#000000;">
<div style="text-align:center;"><img src="content.jpg" border="0" alt=""></div>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:08:24.607

哦，好的，对！我认为您不能使用 html/css 添加自己的样式。但是如果你去“管理网站”有一个“颜色和字体”选项，你可以对一些元素进行自定义，比如选择不同的背景颜色。这就是你要找的托马斯吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T01:09:21.987

我的解决方案：我找到了一个名为“空白模板（黑色）”的模板，其中不包含任何内容（没有侧边栏等）。我添加了自己的背景图片，插入了我的 content.jpg 并完成了。

# ruby-on-rails-3 - 克隆 github 存储库的最佳方法

> ID：16042947
> 
> 赞同：0
> 
> 时间：2013-04-16T17:04:00.707
> 
> 标签：ruby-on-rails-3, git, github

好的，这就是场景。

我犯了一个非常糟糕的新手错误。我正在编写一些代码，并没有创建一个开发分支来检查和测试开发。所以我已经对我机器上的 master 分支进行了所有这些更改，这些更改仍然损坏（正在开发中），我的老板希望我对生产中的应用程序进行一些更改。

我对如何做到这一点的想法是：

1.  重命名我的项目目录，这样我就有了它的备份
2.  git clone 最后一个远程版本到我的机器上
3.  进行他想要的细微更改并重新部署/提交
4.  整理出我在旧版本的应用程序中所做的更改，并将其放入新克隆的 master 分支的 dev 分支中。

对此有什么想法吗？我现在真的不想搞砸生产，我做了太多的更改来跟踪以恢复到代码稳定的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:10:18.107

无需经历那么多麻烦：

```
git checkout master              # get the 'bad' version
git branch bad-master            # make a new branch called 'bad-master', cut off master's current state
git fetch                        # make sure you're up to date with the remote
git reset --hard origin/master   # reset your master branch to origin/master's state
<work work work>
git checkout bad-master          # when you're ready to work on bad-master again 
```

请注意，这`git reset --hard origin/master`将丢弃您尚未签入的工作树中的任何工作......因此，如果您有尚未提交的工作，请务必这样`git stash`做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:10:05.777

这是一种完全正常的情况，您可以轻松恢复。

您需要做的就是：

1.  创建一个指向**您**当前版本的 master的新分支

    ```
    git checkout -b my-feature-branch 
    ```

2.  **将你的**主人重置为与原点/主人相同的东西

    ```
    git checkout master
    git reset --hard origin/master 
    ```

就是这样。现在您的 master 与您进行功能开发之前的状态相同，并且您有一个功能分支留出，您可以稍后签出以恢复开发。

# c++ - CCPoint 到浮点数的转换

> ID：16042949
> 
> 赞同：0
> 
> 时间：2013-04-16T17:04:02.757
> 
> 标签：c++, cocos2d-x

我正在尝试做的事情：将我触摸屏幕的坐标放入 2 个浮点数 x 和 y 中。

我的理解是，要获得我正在触摸的位置的坐标，我应该使用 getLocation()。所以我写了一小段代码：

```
CCTouch *pTouch;
CCPoint *xy = pTouch->getLocation(); 
```

我如何理解它（这很可能是错误的），这应该将变量 xy 设置为等于触摸屏幕位置的 opengl 坐标。如果是这种情况，我将如何将此 CCPoint 变量转换为一个或两个浮点数（x 和 y 浮点值）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T09:58:39.823

这是你可以做的。在场景类的 init() 函数中添加调用

```
setTouchEnabled( true ); 
```

告诉 cocos2d-x 通过在场景中适当调用 ccTouchBegan、ccTouchMoved、ccTouchCancelled 和 ccTouchEnded 来告诉你触摸事件。现在，当这些函数被调用时，你会得到一个

```
cocos2d::CCTouch *touch 
```

您可以使用它来获取触摸坐标。我在游戏中所做的是

```
CCPoint p = touch->getLocationInView();
p = CCDirector::sharedDirector()->convertToGL(p); 
```

p 将包含触摸的坐标。您可以通过执行获取触摸的 x 和 y 坐标的浮点值

```
float x = p.x;
float y = p.y; 
```

希望有帮助。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:06:04.917

尝试这个：

```
float x,y;
x = *xy->x;
y = *xy->y; 
```

PS：`getLocationInView()`比较推荐使用，因为这个函数会返回屏幕坐标中的位置，这是cocos2d-x主要使用的。以后不需要将 OpenGL 坐标转换为屏幕坐标。

读：

[http://www.cocos2d-x.org/reference/native-cpp/de/d9b/classcocos2d_1_1_c_c_touch.html](http://www.cocos2d-x.org/reference/native-cpp/de/d9b/classcocos2d_1_1_c_c_touch.html)

# session - 如何从 Dart HttpServer WebSocket 访问 HttpSession 数据？

> ID：16042953
> 
> 赞同：2
> 
> 时间：2013-04-16T17:04:13.077
> 
> 标签：session, websocket, dart

我有一个非常简单的 WebSocket 服务器：

```
class WsServer {
  WsServer();

  void runServer(int port) {
    ConnectionsHandler connectionsHandler = new ConnectionsHandler();

    HttpServer
      .bind('127.0.0.1', port)
      .then((HttpServer server) {
        print('listening for connections on $port');

        var sc = new StreamController();
        sc.stream.transform(new WebSocketTransformer()).listen(connectionsHandler.onConnection);

        server.listen((HttpRequest request) {
          if (request.uri.path == '/ws') {
            sc.add(request);
          }
          // we dont deal static files
        });
      },
      onError: (error) => print("Error starting HTTP server: $error"));
  }
}

class ConnectionsHandler {
  List<WebSocket> connections = new List<WebSocket>();

  ConnectionsHandler();

  void onConnection(WebSocket conn) {
    print('new ws conn');
    connections.add(conn);
    conn.listen(
      onMessage,
      onDone: () => connections.remove(conn),
      onError: (e) => connections.remove(conn)
    );
  }

  void onMessage(message) {
    print('new ws msg: $message');
  } 
} 
```

我需要`request.session`进去`ConnectionsHandler`。`WebSocketTransformer`似乎只发送`WebSocket`无权访问原始`HttpRequest`会话的连接。

有没有办法从 websocket 处理程序本身访问会话数据？即使客户端从 cookie 发送 dart 会话 id，那么如何检索和刷新 HttpSession 呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T05:24:19.700

你也许可以让它工作，但你只能看到 cookie，因此只能看到会话，如果 web 套接字连接使用与正常 HTTP 请求相同的来源。

请注意，`WebSocketTransformer`不必在流中使用。您一次可以升级一个请求。

你可以试试下面的代码吗？

```
import 'dart:io';
import 'dart:async';

class WsServer {
  WsServer();

  void runServer(int port) {
    ConnectionsHandler connectionsHandler = new ConnectionsHandler();

    HttpServer
      .bind('127.0.0.1', port)
      .then((HttpServer server) {
        print('listening for connections on $port');
        var connHandler = new ConnectionsHandler();
        var webSocketTransformer = new WebSocketTransformer();

        server.listen((HttpRequest request) {
          if (request.uri.path == '/ws') {
            webSocketTransformer.upgrade(request)
              .then((WebSocket ws) {
                connHandler.onConnection(ws, request);
              });
            // TODO handle error from update
          }
          // we dont deal static files
        });
      },
      onError: (error) => print("Error starting HTTP server: $error"));
  }
}

class ConnectionsHandler {
  List<WebSocket> connections = new List<WebSocket>();

  ConnectionsHandler();

  void onConnection(WebSocket conn, HttpRequest req) {
    print('new ws conn');
    connections.add(conn);
    conn.listen(
      (message) {
        print('new ws msg: $message and ${req.session.keys}');
      },
      onDone: () => connections.remove(conn),
      onError: (e) => connections.remove(conn)
    );
  }
}

main() {
  var server = new WsServer();
  server.runServer(3000);
} 
```

# api - Paypal Express Checkout for Payflow Pro、运费和税务更新

> ID：16042962
> 
> 赞同：1
> 
> 时间：2013-04-16T17:04:56.637
> 
> 标签：api, paypal, shipping, express-checkout

在我们的场景中，我们将为 Payflow Pro 使用 PayPal Express Checkout（很重要，因为它与 PayPal Express Checkout 不同）。

根据文档[https://www.paypalobjects.com/webstatic/en_US/developer/docs/pdf/pfp_expresscheckout_pp.pdf](https://www.paypalobjects.com/webstatic/en_US/developer/docs/pdf/pfp_expresscheckout_pp.pdf)，我们必须在知道客户的送货地址之前提供运费和税金值。

我认为这根本不实用，所以我的问题 - 选择地址后是否可以更新（使用现有令牌的 SetExpressCheckout）运费/税额？或者以某种方式更新（又名即时更新）PayPal 页面上的运费/税金值？

此外，如果客户将返回购物车页面并添加/删除产品，客户应该返回 Paypal 页面还是我们只能用新金额更新商品信息和 DoExpressCheckout？

谢谢，斯塔斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:11:40.010

通常，最通用的推荐 EC 流程是：

1.  客户在“查看购物车”页面上并单击使用 PayPal 结帐按钮，而没有在您的网站中输入任何地址或其他信息
2.  带有临时运费/税额的 SetEC（可能为 0）
3.  将客户重定向到 PayPal 网站
4.  客户在 PayPal 选择送货地址并退货
5.  GetEC第一次找出他们选择的地址
6.  计算任何新的运输或税收并在“订单审查”类型页面上显示摘要（这可以让他们从多个运输选项中进行选择，如空运/陆运，如果适用）
7.  当客户单击最终的“下订单”类按钮时，DoEC 会显示更新的运费和税额。

警告：默认情况下，DoEC 的总金额必须在原始 SetEC 金额的 115% 或 75 美元以内，以较小者为准。因此，如果您的任何定价方案将超过该阈值，则原始 SetEC 应包含一些占位符运费和税金金额，以便最终总额在 115%/75 美元以内。

# c++ - 在 C++ 中表示多遍抽象语法树 (AST)？

> ID：16042964
> 
> 赞同：13
> 
> 时间：2013-04-16T17:05:03.693
> 
> 标签：c++, compiler-construction, abstract-syntax-tree, parse-tree

我目前正在探索设计一个在多个阶段转换其 AST 的编译器。这个想法是，从解析树开始，每次传递都会转换树，直到生成的 AST 被优化并包含生成中间代码（在本例中为[LLVM](http://llvm.org/) IR）所需的树的每个节点中的所有必需信息。遍历树可能会显着改变其结构，例如通过[运算符优先级解析](http://en.wikipedia.org/wiki/Operator-precedence_parser)将运算符和操作数列表更改为有序操作的层次结构。请注意，通过可能会使结构的某些部分完全不变。

所以，我的问题是我如何最好地（阅读：最容易，尽可能少的重复）表示在 C++ 中具有多个中间表示的 AST？我希望每个阶段的 AST 版本中的节点类型在编译时尊重它们的不兼容性。我认为关键问题是我应该如何表示结构中在传递之间不发生变化的部分，同时避免重复代码？我想这是编译器作者过去多次解决的问题。

请注意，我目前在我的 AST 中使用[Boost Variant](http://www.boost.org/libs/variant/)而不是正常的运行时多态性，并且希望有一个与之兼容的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T04:38:14.730

AST nodes by themselves don't need huge amounts of complexity. I think all this AST node machinery is just overkill.

The problem with ASTs isn't node type safety; its *tree shape* safety. An AST represents (presumably) some valid instance of some language L. What you ideally want is for transformations on the AST to produce other valid ASTs (instances of the language L). You're not going to guarantee that by guaranteeing that any one node has a valid type; you can only do it by guaranteeing that any tree patch produces a valid *tree*. And this is very difficult to do if the tree operations are atomic (e.g., "change node that", "replace child", "replace parent") and applied seperately; after several such steps, what precisely can you say about the tree?

This is better done using a kind of tree-rewrite transaction, e.g., source-to-source transformations whose grammatical structure is valid for language L, and which are applied in places that are valid for that transformation.

Most standard [program transformation systems](http://en.wikipedia.org/wiki/Program_transformation) do this. They achieve this by holding a model of grammar for L, and checking that the proposed transforms are well-typed. This ensures that transformations of language L to language L stay well-formed.

This is harder to get right if the transformations map from one language A to another language B; if some such transformations are applied, you usually get a tree with mixed types that is not legal in either language. With care, one can define a set of transforms that map all subtrees of language A to language B, and apply them exhaustively; then you want the resulting tree to be well formed for B. You can ensure that by insisting whenever a B-patch is inserted in a mixed tree, if it is adjacent to another B-patch, that the resulting compound B-patch is well formed. This you can do using the same style of grammar checks.

Using these ideas, you can build a system that maps an AST through a series of "representations" (langauges A, B, C, ....) and have some faith that the result tree is well-shaped. This idea generalizes to graph rewrites.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T03:01:34.460

这是基于类型安全`boost::variant`的 AST 的快速测试。

我包含了一个简单的“结构保持转换”，它只是改变了存储在每个 AST 节点中的数据类型。然而，理论上，您可以编写一个任意的`astFunc`，既可以对节点进行结构转换，也可以基于数据的转换——只需编写一个`type_list`包含每个节点之前和之后的有效类型的 a。

```
template<typename... Ts>
struct type_list {};

// specialize data_type to store something special in your AST node:
// (by default, an entry means "the type of the data")
tempalte<typename T>
struct data_type { typedef T type; };
template<typename T>
using DataType = typename data_type<T>::type;

template<template<typename>class F, typename typelist>
struct map_types;
template<template<typename>class F, template<typename...>L, typename... Ts>
struct map_types<F, L<Ts...>> {
  typedef L< F<Ts>... > type;
};
template<template<typename>class F, typename typelist>
using MapTypes = typename map_types<F, typelist>::type;

template<template<typename...>class F, typename typelist>
struct apply_list;
template<template<typename...>class F, template<typename...>class L, typename... Ts>
struct apply_list<F, L<Ts...>> {
  typedef F<Ts...> type;
};
template<template<typename...>class F, typename typelist>
using ApplyList = typename apply_list<F, typelist>::type;
template<typename typelist>
using Var = ApplyList< boost::variant, MapTypes<DataType, typelist> >;

template<typename type_list>
struct AST_Node {
  typedef std::unique_ptr<AST_Node> upAST_Node;
  std::vector<upAST_Node> children;
  Var<type_list> data;
  template<typename T>
  AST_Node( T&& t ):data( std::forward<T>(t) ) {}
};
template<typename type_list>
using upAST_Node = typename AST_Node<type_list>::upAST_Node;

template<typename before_types, typename after_types>
using typeFunc = std::function< Var<after_types>(Var<before_types>) >;

template<typename before_types, typename after_types>
using astFunc = std::function< upAST_Node<after_types>(upAST_Node<before_types>) >;

template<typename before_types, typename after_types>
astFunc<before_types, after_types> elementWiseTransform( typeFunc<before_types, after_types> func ) {
  return [func]( upAST_Node<before_types> before )->upAST_Nodes<after_types> {
    upAST_Node<after_types> after( new AST_Node<after_types>( func( before ) ) );
    after->children.reserve( before->children.size() );
    for( auto& child: before->children ) {
      after->children.push_back( elementWiseTransform(func)(std::move(child)) );
    }
    return after;
  };
} 
```

现在这只是一个开始。

您可以更进一步，让每种类型的节点都有一组不同类型的子节点，甚至不同的数量。只需为每种类型的节点创建特征类，例如 my `data_type`，例如`children_types`. 然后使用与我定义的方式类似的技术来`Var`定义您孩子的类型。基本上，您通过`variant`. 哎呀，你可以将孩子和一起捆绑成一个变体。`std::vector< AST_Node<ChildType<type_list_element>>>``MapTypes``std::vector``data`

这将允许您为单个`AST_Node`类型（生成另一种`AST_Node`类型）编写映射，将它们聚合在一起并生成一个`AST_Node<before, after>`仿函数，然后遍历树。一些仿函数只对数据进行操作，然后让父逻辑接管孩子，一些会转换整个子树，一些会对数据进行操作并阻止父逻辑运行在孩子身上。

该技术变得棘手，因为您必须以不需要将它们全部堆积在一起的方式从您的各个函数中合成提升变体访问者。如果你看[这里](https://stackoverflow.com/questions/14972954/manual-signature-overload-resolution)，你会看到一些关于如何获取一堆`std::function<T(U)>`并将它们变成一个函子的技术，该函子接受`U`. 投入一些工作来计算返回类型的联合（一个简单`type_list`的删除重复类型，然后泵入 a `boost::variant`，可能会这样做）——这样的“合并函子”将是一个有效的访问者。

现在您可以编写“重新映射 operator_add 类型的 AST 节点”函子，以及“重新映射 operator_mult 类型的 AST 节点”以及其他一些函子，将它们绑定到一个巨型函子中，将它们扔给 AST 遍历算法，然后让它喷出一棵 AST 树，其中某些类型转换为其他类型...

但这将是很多工作。

哦，我们可能想要“阶段标记”，其中阶段 1 和阶段 2 AST 是不同的类型。我们可以用它的阶段标记每个类型`type_list`，或者我们可以只标记`AST`树本身。哎呀，我们可以为`AST`使用其他未使用`struct`的 s 命名阶段，并将通过阶段的进程定义为类型到类型的函子，该函子在 的签名中应用和强制执行`astFunc<before_phase, before_types, after_phase, after_types>`。

所以这还不错。我们创建一个`type_list`节点类型。这些类型不必是实际存储的数据。但它可以。

我们创建一个`data_type`特征类，将每个节点类型映射到存储的数据。我们创建一个`child_types`特征类，将每个节点类型映射到子 AST 的 type_list。

每个`AST_Node`存储一个`variant<AST_Concrete_Node<Ts>...>`. `AST_Concrete_Node`包含 a`DataType<T> data;`和 a `MapTypes< std::vector, MapTypes< AST_Node, ChildTypes<T> > > children;` （又名, `std::vector< AST_Node<ChildrenTypes...> >`，但你不能直接这么说）。

接下来，`AST_Concrete_Node<T>`转换功能在模板元编程的一个棘手位中结合在一起，以提升变体访问者。这一步真的很棘手，但我认为可行。完成了额外的工作以跳过未提及的类型，因此我们不必经常说“哦，我们不想转换节点 X”，而是必须说“如果我们命中节点 Y，不要改变它的孩子”。

在这一点上，我想说我在胡说八道——以前没有这样做过，在具体实现这种类型的体操时遇到的问题将压倒我抽象推理的能力。但是这个想法很有用——我们有类型安全的节点类型转换，我们将它们聚合在一起并生成一个类型安全的树转换。这棵树不仅仅是一棵通用变体的抽象树，而是一棵树，其中每个节点都知道其子节点允许的类型是什么，并且递归地知道相同的类型。如果我们在兔子洞里走得足够远，我们甚至可以处理“这必须正好有 3 个孩子，第一个是 an `int`，第二个是 a `Bob`，第三个是 a ”。`double`

# matlab - MatLab 提示错误

> ID：16042968
> 
> 赞同：0
> 
> 时间：2013-04-16T17:05:22.900
> 
> 标签：matlab, prompt

为什么我的程序不运行？

```
eyeGlassesColour=input ('Please, input your eye glasses colour:\n');
if eyeGlassesColour == 'red'
fprintf('They are pretty.\n');
else
fprintf('Buy another pair.\n');
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:09:58.073

您需要指定[输入命令](http://www.mathworks.com/help/matlab/ref/input.html)的用户条目应为字符串。所以你的代码的第一行应该是：

```
eyeGlassesColour=input ('Please, input your eye glasses colour:\n', 's'); 
```

使用 's' 标志作为第二个参数。

此外，使用 '==' 运算符要求要比较的两个字符串的长度完全相同，否则会产生运行时错误。因此，如果用户输入诸如“蓝色”或“绿色”之类的内容，它将产生错误，而不是返回 false 并执行 else 块。因此，最好使用“ [strcmp()](http://www.mathworks.com/help/matlab/ref/strcmp.html) ”来比较字符串，如下所示：

```
if strcmp(eyeGlassesColour, 'red') == true 
```

请注意，“strcmp()”区分大小写，因此如果您希望“Red”或“RED”等字符串也返回 true，请改用不区分大小写的“strcmpi()”。

# knockout.js - 使用敲除来确定 foreach 中的第一个元素

> ID：16042972
> 
> 赞同：2
> 
> 时间：2013-04-16T17:05:39.430
> 
> 标签：knockout.js

在淘汰模板绑定过程中，我需要检测何时处理每行中的第一个元素，因为它不应该有锚标记围绕它。

鉴于以下 js 用于淘汰赛...

```
function Model() {
    var self = this;
    self.gridData = ko.observableArray('{"GridData":[["Category foo","0","0"],["Category bar","0","0"]]}');
}

var model = new Model();
ko.applyBindings(model); 
```

而这个模板...

```
<script type="text/html" id="template">
    <table>
        <tbody data-bind="foreach: gridData">
            <tr data-bind="foreach: $data">
                <td><a href="" data-bind="text: $data"></a></td>
            </tr>
        </tbody>
    </table>
</script> 
```

而这个html...

```
<div data-bind="template: { name: 'template' }"></div> 
```

如果我们正在处理第一个元素，是否可以以某种方式使用“if”绑定？

另外，我发现了这个[SO Post](https://stackoverflow.com/questions/5371772/knockout-js-foreach-but-with-a-special-element-first)，但它并没有让我得到我想要的东西。

**更新：**

感谢您的两个答案。使用每个提供的信息，我能够为我的情况找到一个好的解决方案。我将模板更新为以下...

```
<script type="text/html" id="template">
        <tbody data-bind="foreach: gridData">
            <tr data-bind="foreach: $data">
                <!-- ko if:($index()===0) -->
                <td data-bind="text: $data"></td>
                <!-- /ko -->
                <!-- ko ifnot:($index()===0) -->
                <td><a href="" data-bind="text: $data"></a></td>
                <!-- /ko -->
            </tr>
        </tbody>
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T17:19:38.460

您可以简单地使用`$index`绑定上下文，它是一个可观察的，因此您需要调用它来获取它的值。

JS

```
var vm = {
    items: ['a', 'b', 'c', 'd', 'e', 'f']
};

ko.applyBindings(vm); 
```

HTML

```
<div data-bind="foreach: items">
    <div data-bind="css: { first: $index() == 0 }">
        <span data-bind="text: $index"></span>
        :
        <span data-bind="text: $data"></span>
    </div>
</div> 
```

小提琴：http: [//jsfiddle.net/xixonia/v8Eh2/](http://jsfiddle.net/xixonia/v8Eh2/)

Foreach 文档： http: [//knockoutjs.com/documentation/foreach-binding.html](http://knockoutjs.com/documentation/foreach-binding.html)

绑定上下文文档： http: [//knockoutjs.com/documentation/binding-context.html](http://knockoutjs.com/documentation/binding-context.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:24:49.773

你试过这样的事情吗？

```
<script type="text/html" id="template">
        <table>
            <tbody data-bind="foreach: gridData">
            <tr data-bind="foreach: $data">

                <td>
                    <span data-bind="text:$data,visible: ($index() === 0) " ></span>

                    <a href="" data-bind="text: $data ,visible: ($index() >=1)"></a>
                </td>
            </tr>
            </tbody>
        </table>
    </script> 
```

诀窍是“$index”的使用。我也建议你看看[这里](http://knockoutjs.com/documentation/binding-context.html)，你可以找到很多有用的特殊属性。

（另请注意，您需要使用淘汰赛 2.x+）

*[更新] 对不起克里斯托弗哈里斯，我意识到他在我回答的时候发布了他的答案，当然，他的所有权利*

# delphi - 将 TDbGrid 中的一些单元格设置为可编辑

> ID：16042975
> 
> 赞同：1
> 
> 时间：2013-04-16T17:05:55.447
> 
> 标签：delphi, tdbgrid

我只想在 TDBGrid 中编辑一些单元格。在给定的列中，某些但不是所有单元格都是可编辑的，因此我不能只为整个列设置 Column.ReadOnly ，然后保持这种状态。

最好使用哪些事件，这样我就可以在输入单元格时进行控制。我可能会使用 TDbGrid.ColumnEnter 来捕捉水平移动，并使用 TDataSet.AfterScroll 来捕捉网格中的垂直移动。或者我也许可以使用 TDBGrid.DrawColumnCell （我已经用它来改变某些单元格的颜色......）

而且我也无法找出更改单元格只读状态的最佳方法。我可以设置底层的 TTable.Field.ReadOnly 或 TDbGrid.Columns[].ReadOnly。

我可以尝试以上所有方法，但是我依赖于我的测试来确定网格是如何实现的，并且可能会忽略某些情况。我想知道 VCL 是否提供了一种管理这种需求的方法，是否有警告等。

相关：[Delphi 中的只读 TDBGrid/TwwDBGrid 单元格？](https://stackoverflow.com/questions/2005491/readonly-tdbgrid-twwdbgrid-cell-in-delphi)，但不处理通过键盘滚动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:28:16.827

您可以覆盖 CanEditModify 函数并添加您希望的条件。这可以通过添加新事件或仅通过 interposerclass 创建新组件来完成。

```
unit Unit6;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, DB, ADODB, Grids, DBGrids;

type
  TDBGrid=Class(DBGrids.TDBgrid)
    function CanEditModify: Boolean; override;
    Property Col; // make property col visible
  End;

  TForm6 = class(TForm)
    DBGrid1: TDBGrid;
    ADOConnection1: TADOConnection;
    ADODataSet1: TADODataSet;
    DataSource1: TDataSource;
    ADODataSet1Componame: TStringField;
    ADODataSet1TrackTitle: TStringField;
  private
    { Private-Deklarationen }
  public
    { Public-Deklarationen }
  end;

var
  Form6: TForm6;

implementation

{$R *.dfm}

{ TDBGrid }

function TDBGrid.CanEditModify: Boolean;
var
 f:TField;
 c:Integer;
begin
  Result := inherited CanEditModify;
  c := Col;
  if dgIndicator in Options then dec(c); 
  F := Columns[c].Field;
  if Assigned(F) then
    begin // here just an example condition
      if (f.FieldName='TrackTitle') then
        if Pos('aa',F.AsString)>0 then Result := False;
      // you also can access the dataset via
      // if f.DataSet.FieldByName('xy').SomeCondition then ....    
    end;
end;

end. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:28:58.767

DBGrid 根据大量输入决定是否显示文本编辑框：

1.  DBGrid 本身是否是只读的。
2.  数据集是否为只读
3.  列是否为只读
4.  该字段是否为只读
5.  数据集是否可以进入编辑模式

如果要使 DBGrid 列中的某些单元格可编辑，而同一列中的其他单元格不可编辑，则必须自己进行。DBGrid 通过网格范围和列覆盖来查找数据集的大部分线索。

我不记得是否可以将数据集字段 CanModify 配置为根据各个行数据返回不同的真或假。如果是这样，这可能是您最好的选择。DBGrid 将尊重 CanModify 返回的任何字段。

如果 CanModify 不是每行上下文相关的，您可以使用您的逻辑来决定哪些单元格应该在 CanEditModify 中可编辑。创建一个继承自 TDBGrid（或 TCustomDBGrid）的新网格类并覆盖 CanEditModify 虚拟方法。您可能应该先执行自定义逻辑，然后如果您的逻辑不适用，则调用继承的方法。您可能需要重写一些其他方法来微调外观，例如 CanEditShow。

# mysql - 转换一个不起眼的？将 sql 查询中的日期格式转换为人类可读的日期格式

> ID：16042979
> 
> 赞同：0
> 
> 时间：2013-04-16T17:06:07.447
> 
> 标签：mysql, sql, date, time

我在 bigint 字段中有一个日期格式，格式为“20130314123743” - YYYYMMDDHHMMSS，我需要对其进行 mysql 查询并将其以 yyyy-mm-dd hh:mm:ss 之类的形式返回给用户。

是否有一个本机 mysql 函数可以采用该日期格式并将其返回为人类可读的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T17:29:45.250

一种方法：

```
select cast(cast(bigintdateval as char(14)) as datetime) 
```

SQLFiddle[在这里](http://sqlfiddle.com/#!8/894c1/1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:22:13.020

要转换为日期时间，您可以使用 MySQL 函数**FROM_UNIXTIME**

```
FROM_UNIXTIME (unix_timestamp, [format ])

SELECT FROM_UNIXTIME(20130314123743, '%Y-%m-%d %h:%i:%s'); 
```

示例；

```
 SELECT FROM_UNIXTIME(birthDay/100000, "%Y-%m-%d %H:%i:%s") AS date 
    FROM  person; 
```

来源 [FROM_UNIXTIME](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_from-unixtime)

希望有所帮助

# vb6 - 图片框中的网页

> ID：16042980
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:06:15.997
> 
> 标签：vb6

我知道打开网页的一种方法是在 IE 窗口中，如下所示：

```
Shell _
    "C:\Program Files\Internet Explorer\IEXPLORE.EXE " _
    & "http://maps.google.com/maps?q= " & b & "" _
    , vbMaximizedFocus 
```

我想在图像或图片框中打开相同的内容。用户是否能够浏览地图并使用放大/缩小功能，例如在线进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:07:38.747

有几种方法可以做到这一点。

1.  ~~使用第三方库将网页转换为图像。~~
2.  使用 Web 浏览器控件。[这是有关如何使用它的视频。](http://www.youtube.com/watch?v=EhDi6-Rp_yM)

# ef-code-first - 您如何首先通过代码进行查找表

> ID：16042982
> 
> 赞同：0
> 
> 时间：2013-04-16T17:06:23.313
> 
> 标签：ef-code-first

我一直在寻找这个没有任何运气如何解决。我有一个可以在我的商店中使用的可用部门列表。由于商店不同，有些部门可能不存在，我想跟踪每个部门为每个商店有多少货架空间。创建这个的最佳方法是什么？

这是我的模型：

```
public class Store
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int ID { get; set; } //StoreNumber
    public virtual List<StoreDepartment> StoreDepartments { get; set; }
}

public class StoreDepartment
{
    [Key]
    public int ID { get; set; }
    public int StoreID { get; set; }
    public Department Department { get; set; }
    public int ShelvingLinealFT { get; set; }
}

public class Department
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int ID { get; set; } //DepartmentNumber
    public string Name { get; set; }
    public bool InActive { get; set; }
} 
```

我已经填充了我的部门表，但是当我尝试保存 StoreDepartment 对象时，我收到一条错误消息，指出它无法插入行，因为它试图创建重复键。这就像它试图创造一个新的记录。

任何帮助，将不胜感激。

这是我的 DbContext 的代码：

```
public class StoresRepository:DbContext
{
    public DbSet<Store> Stores { get; set; }
    public DbSet<StoreDepartment> StoreDepartments { get; set; }
    public DbSet<Department> Departments { get; set; }
} 
```

这是我的保存方法：

```
 /// <summary>
/// Saves a StoreDepartment Object to the store("dept.storeid")
/// Adds a new record if ID is 0
/// </summary>
/// <param name="dept"></param>
/// <returns></returns>
public bool Save(StoreDepartment dept)
{
    bool retval = false;
    try
    {
        using (var db = new StoresRepository())
        {
            if (dept.ID.Equals(0))
            {
                //Add Store Department
                db.StoreDepartments.Add(dept);                            
            }
            else
            {
                //this is an update
                StoreDepartment  department = db.StoreDepartments.Where(p => p.ID.Equals(dept.ID)).FirstOrDefault();
                department.Department = dept.Department;
                department.ShelvingLinealFT = dept.ShelvingLinealFT;
            }
            int rowsupdated = db.SaveChanges();
            retval = true;
        }
    }
    catch (Exception ex)
    {
        Utils.Trace(string.Format("StoresContext.cs: StoreDepartments.Save(). ID:{1}. Exception: {0}", ex, dept.ID), Utils.ErrorTypes.Error);
    }
    return retval;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T07:15:22.670

`Department`添加对象时，您可能会更改添加的`StoreDepartment`状态。像这样的东西：

```
using(var db = new MyContext())
{
    var storeDepartment = new StoreDepartment();
    storeDepartment.StoreId = storeId;
    storeDeparemtent.Department = department;
    db.StoreDepartments.Add(storeDepartment); // also marks Department as added
    db.SaveChanges();
} 
```

解决方案是向上移动添加对象的行：

```
using(var db = new MyContext())
{
    var storeDepartment = new StoreDepartment();
    db.StoreDepartments.Add(storeDepartment);
    storeDepartment.StoreId = storeId;
    ....
} 
```

您还可以将 a 添加`DepartmentId`到`StoreDepartment`类并设置其值，就像使用`StoreId`. 这与`Department`属性一起称为[外键关联](https://stackoverflow.com/questions/5281974/code-first-independent-associations-vs-foreign-key-associations)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T18:21:55.417

我想到了。

以下是正确的模型：

```
public class StoreDepartment
{
    [Key]
    public int ID { get; set; }
    public int DepartmentID { get; set; }
    public virtual Department Department { get; set; }
    public int ShelvingFootage { get; set; }
}

public class Department
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int ID { get; set; }
    public string Name { get; set; }
    public bool Active { get; set; }
    public virtual ICollection<StoreDepartment> StoreDepartments { get; set; }
} 
```

使用 Affluent API，我将我的关系设置如下：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<StoreDepartment>().HasRequired(d => d.Department);
    modelBuilder.Entity<Department>().HasMany(d => d.StoreDepartments);            
} 
```

完成此设置后，我遇到的主要问题之一就是填充对象。通常，您会执行以下操作：

```
StoreDepartment sd = new StoreDepartment();
sd.Department = new Department(){
    ID = 302,        
    Name = "Deli"
};
sd.ShelvingFootage = 100; 
```

但是，当尝试保存此对象时，Entity 会尝试在 Department 表中添加一条新记录，这当然会由于主键冲突而引发异常。

诀窍是不直接更新它并按如下方式构建我的 StoreDepartment 对象：

```
StoreDepartment sd = new StoreDepartment();
sd.DepartmentID = 302;
sd.ShelvingFootage = 100; 
```

通过这样做，您只是更新 StoreDepartment.Department 对象的外键。

# performance - 为什么在外部程序上使用内置命令（在 bash 脚本中）？

> ID：16042985
> 
> 赞同：2
> 
> 时间：2013-04-16T17:06:29.600
> 
> 标签：performance, bash, compatibility, built-in

这个问题与使用外部程序而不是内置结构的负面影响有关——特别是关于`sed`，以及一般的外部程序。

我的想法是，为了最大限度地提高跨 UNIX 系统的兼容性，应该使用内置命令。但是，有些程序实际上是标准的。考虑这个例子：

```
# Both functions print an array definition for use in 
#   assignments, for loops, etc.

uses_external() {
    declare -p $1  \
      | sed -e "s/declare \-a [^=]*=\'\(.*\)\'\$/\1/" \
      | sed "s/\[[0-9]*\]\=//g"
}

uses_builtin() {
    local r=$( declare -p $1 )
    r=${r#declare\ -a\ *=}
    echo ${r//\[[0-9]\]=}
} 
```

`uses_builtin()`在兼容性方面，和之间有很大区别`uses_external()`吗？

关于兼容性，是否有某一类几乎通用的外部程序？有没有提供这种信息的资源？（对于上面的示例，我必须阅读许多资料才能感到自在，认为这`sed`是比`awk`第二语言更兼容的选择。）

我真的很想权衡利弊，所以请随意指出内置命令和外部程序之间的其他考虑因素（即性能、健壮性、支持等）。或者，“内置与外部”的问题通常是每个程序的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:26:53.153

与直觉相反，对于您的示例，大型数据集的内置速度较慢

[大型数据集的参数扩展缓慢](https://stackoverflow.com/questions/14967299/parameter-expansion-slow-for-large-data-sets)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:28:35.173

Objectively speaking, using built-in commands is more efficient, since you don't need to fork any new processes for them. (Subjectively speaking, the overhead of such forking may be negligible.) Large numbers of built-in commands that could be subsumed by a *single* call to an external program may be slower.

Use of built-ins may or may not produce more readable code. It depends on who is reading the code.

# postgresql - 没有显式锁定的postgres死锁

> ID：16042988
> 
> 赞同：3
> 
> 时间：2013-04-16T17:06:41.233
> 
> 标签：postgresql, transactions, database-deadlocks

我使用 PostgreSQL 9.2，并且我不在任何地方使用显式锁定，无论是`LOCK`语句还是`SELECT ... FOR UPDATE`. 但是，最近我得到了`ERROR: 40P01: deadlock detected`. 但是，检测到死锁的查询被包装在事务块中。无论如何，它是怎么来的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T18:05:58.217

你不需要任何明确`LOCK`的进入死锁。这是一个从头开始的非常简单的演示，只有 INSERT：

```
create table a(i int primary key);
create table b(i int primary key); 
```

第 1 场会议：

```
begin;
insert into a values(1); 
```

然后会话＃2：

```
begin;
insert into b values(1);
insert into a values(1);
-- here it goes into waiting for session #1 to finish its transaction 
```

然后会话 #1 执行以下操作：

```
insert into b values(1); 
```

然后发生死锁：

> 错误：检测到死锁
> 细节：进程 9571 等待事务 4150 上的 ShareLock；被进程 9501 阻塞。
> 进程 9501 等待事务 4149 上的 ShareLock；被进程 9571 阻止。
> 提示：有关查询详细信息，请参阅服务器日志。

简单的 UPDATE 或 UPDATE 和 INSERT 的组合也会发生同样的情况。这些操作采用隐式锁，如果它们以不同的顺序发生在不同的会话中，它们可能会死锁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:51:08.390

我会首先怀疑哈希索引。

*   `hash`切换您必须的任何-indexes`B-tree`
*   [`Serializable`](http://www.postgresql.org/docs/9.2/static/transaction-iso.html#XACT-SERIALIZABLE)如果看起来合适，请使用隔离级别。

# java - Java - 从字符串 XML 信封中使用 SOAP Web 服务

> ID：16042993
> 
> 赞同：1
> 
> 时间：2013-04-16T17:06:53.790
> 
> 标签：java, xml, web-services, soap, envelope

使用 SoapUI，我构建了以下 XML 信封并将其封装在一个字符串中。

ProcessJournal 是一个没有参数的方法，它返回一个字符串。

```
String soapText = "<Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:upd=\"http://webservices.vm.vmc/UpdateCMA/\">" +
                    "<Header/>" +
                     "<Body>" +
                       "<upd:ProcessJournal/>" +
                     "</Body>" +
                  "</Envelope>"; 
```

现在...我只想调用上面定义的 Web 服务。并找到了一些示例代码

```
 // Create SoapMessage
                MessageFactory msgFactory     = MessageFactory.newInstance();
                SOAPMessage message           = msgFactory.createMessage();
                SOAPPart soapPart             = message.getSOAPPart();

                // Load the SOAP text into a stream source
                byte[] buffer                 = soapText.getBytes();
                ByteArrayInputStream stream   = new ByteArrayInputStream(buffer);
                StreamSource source           = new StreamSource(stream);

                // Set contents of message 
                soapPart.setContent(source);

                // -- DONE
                message.writeTo(System.out);

                //Try accessing the SOAPBody
                SOAPBody soapBody = message.getSOAPBody(); 
```

问题是，在 message.getSOAPBody();，我得到一个错误

```
XML-22103: (Fatal Error) DOMResult can not be this kind of node.
Apr 16, 2013 12:05:06 PM com.sun.xml.internal.messaging.saaj.soap.EnvelopeFactory createEnvelope
SEVERE: SAAJ0511: Unable to create envelope from given source 
```

我找到的所有各种示例在执行 getSOAPBody() 时最终都会出现相同类型的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-24T16:00:59.057

看起来问题出在您的 soapText 中的命名空间前缀。我能够毫无错误地执行您的示例，并且无需手动设置任何 TransformerFactory 只需修改您的 soapText 如下：

```
String soapText = 
     "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:upd=\"http://webservices.vm.vmc/UpdateCMA/\">" +
        "<soapenv:Header/>" +
        "<soapenv:Body>" +
          "<upd:ProcessJournal/>" +
        "</soapenv:Body>" +
     "</soapenv:Envelope>"; 
```

请注意在所有 Soap 元素中添加的*soapenv:*前缀与您的 Soap 服务命名空间中的*upd前缀形成对比。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-10T08:01:47.310

我不知道你是否找到了解决这个问题的方法。我最近刚刚看到完全相同的错误，这是由于未设置 TransformerFactory。

我使用了来自 Saxon 库的 TransformerFactory - 可以在[此处](http://mvnrepository.com/artifact/net.sf.saxon/saxon)获得它的 jar 。

然后我设置了一个引用 Saxon TransformerFactory 的系统属性：

```
System.setProperty("javax.xml.transform.TransformerFactory",    
        "net.sf.saxon.TransformerFactoryImpl"); 
```

当我重新运行我的代码时，错误就消失了。

以上只是设置 TransformerFactory 的一种方式。我在这里找到了许多其他方法可以做到这一点：[stackoverflow.com/questions/11314604/](https://stackoverflow.com/questions/11314604/how-to-set-saxon-as-the-xslt-processor-in-java)

# javascript - 为什么视频 defaultPlaybackRate 在 Chrome 中不起作用？

> ID：16042995
> 
> 赞同：1
> 
> 时间：2013-04-16T17:07:08.700
> 
> 标签：javascript, jquery, html5-video

我看到了一些 defaultPlaybackRate 的例子，他们说它可以在 Chrome 上运行。所以我使用他们的示例代码并在 Chrome 上运行，当我单击按钮时它不会将速度更改为 3.0x。谁能告诉我为什么？

这是我的javascript代码，

```
$(document).ready(function(){

    var video = document.getElementById('video');

    $("#speed").click(function() { // button function for 3x fast speed
            video.defaultPlaybackRate=3.0;
    });

}); 
```

HTML代码，

```
<button id="speed" type="button">3.0x</button> 
```

和

```
<video id="video" width="930" height="500" controls>
        <source src="caption.mp4" type="video/mp4">
        <source src="caption.ogg" type="video/ogg" >
        <source src="caption.webm" type="video/webm" >
</video> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:31:02.597

因为一旦您更改了 defaultPlaybackRate，您必须再次使用`video.load();`（或在视频加载之前设置它）加载视频。如果您想在视频播放时更改速率，请`playbackRate`改用。

```
 var video = document.getElementById('video');
 $("#speed").click(function () { // button function for 3x fast speed
     video.defaultPlaybackRate = 3.0;
     video.load();
 }); 
```

或者

```
 var video = document.getElementById('video');
 $("#speed").click(function () { // button function for 3x fast speed
     video.playbackRate  = 3.0;
 }); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/54gSP/)**

# linux - 使用 linux 系统调用在基本 TCP 服务器中获取 http 标头

> ID：16042996
> 
> 赞同：0
> 
> 时间：2013-04-16T17:07:08.733
> 
> 标签：linux, networking, tcp, system-calls, recv

我有一个基本的 TCP 服务器，它使用 linux 系统调用（setsockopt、bind、listen、accept、recv）。recv 命令返回给我的请求消息不过是完整的 URL。有什么方法可以从 recv 系统调用中接收的数据中检索 http 标头？基本上我想从 http 请求中提取用户代理。我的代码是 cpp cpde -谢谢 Rahul

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T22:42:56.390

HTTP 本身不包含完整的 URL。您需要自己将其从 Host 标头和请求 URI 组合在一起。

# ios - 为什么我的弯曲文本不居中？

> ID：16042998
> 
> 赞同：0
> 
> 时间：2013-04-16T17:07:15.797
> 
> 标签：ios, objective-c, math, geometry, core-animation

我有一个`UIView`名为`dpCurvedLabel`. 它用于`CATextLayers`围绕弧线弯曲文本。它工作得很好，除了我不能让它在图层父视图中完全居中。我希望弧的中心点位于视图的中心（即使视图较小），因此所有文本字符与中心的距离相同。

我可以让它关闭，但它总是至少有几个像素。它“关闭”的数量似乎受到我给每个`CATextLayer`. 数学有问题，但我不知道是什么问题。我的代码：

* * *

```
// instantiate a dpCurvedLabel in a super view
dpCurvedLabel *curvedLabel = [[dpCurvedLabel alloc] 
initWithFrame:CGRectMake(0, 0, 200, 200) arcSize:360 radius:50 
text:@"curve curve curve " font:[UIFont fontWithName:@"HelveticaNeue" size:18] 
textColor:[UIColor whiteColor]];

// You can animate a rotation to see a more pronounced effect
// [curvedLabel rotateContinously];

[self addSubview:curvedLabel]; 
```

* * *

**dpCurvedLabel.h**

```
#import <UIKit/UIKit.h>

@interface dpCurvedLabel : UIView

@property CGFloat arcSize;
@property CGFloat radius;
@property (strong) NSString *text;
@property (strong) UIFont *font;
@property (strong) UIColor *textColor;

- (id)initWithFrame:(CGRect)frame arcSize:(CGFloat)arcSize radius:(CGFloat)radius
text:(NSString *)text font:(UIFont *)font 
textColor:(UIColor *)textColor;
- (void)rotateContinously;

+ (void)makeCurvedText:(CALayer *)layer arcSize:(CGFloat)arcSize radius:(CGFloat)radius 
text:(NSString *)text font:(UIFont *)font textColor:(UIColor *)textColor;

@end 
```

**dpCurvedLabel.m**

```
#import "dpCurvedLabel.h"

@implementation dpCurvedLabel

- (id)initWithFrame:(CGRect)frame arcSize:(CGFloat)arcSize radius:(CGFloat)radius text:(NSString *)text font:(UIFont *)font textColor:(UIColor *)textColor
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code

        self.opaque = NO;
        self.clipsToBounds = NO;

        self.arcSize = arcSize;
        self.radius = radius;
        self.text = text;
        self.font = font;
        self.textColor = textColor;
    }
    return self;
}

- (void)layoutSublayersOfLayer:(CALayer *)layer
{
    [super layoutSublayersOfLayer:layer];

    NSLog(@"laying out sublayers!");
    [dpCurvedLabel makeCurvedText:layer arcSize:self.arcSize radius:self.radius text:self.text font:self.font textColor:self.textColor];
}

+ (void)makeCurvedText:(CALayer *)layer arcSize:(CGFloat)arcSize radius:(CGFloat)radius text:(NSString *)text font:(UIFont *)font textColor:(UIColor *)textColor
{

    layer.sublayers = nil;
    layer.masksToBounds = NO;

    CGFloat arcStart = 0;
    CGFloat shiftH = 0;
    CGFloat shiftV = 0;

    BOOL clockwise = YES;
    BOOL debugMode = YES;

    CGFloat xcenter = CGRectGetMidX(layer.bounds);
    CGFloat ycenter = CGRectGetMidY(layer.bounds);

    CGFloat angle = arcStart;
    CGFloat angleStep = arcSize / text.length;

    for ( NSUInteger i = 0; i < text.length; ++i )
    {
        NSRange range = { .location = i, .length = 1 };
        NSString *c = [text substringWithRange:range];

        CGFloat yoffset = sin( degreesToRadians(angle) ) * radius;
        CGFloat xoffset = cos( degreesToRadians(angle) ) * radius;

        CGFloat rotAngle = 90 - angle;

        if ( clockwise )
        {
            yoffset = -yoffset;
            rotAngle = -90 + angle;
        }

        CATextLayer* tl = [[CATextLayer alloc] init];
        tl.masksToBounds = NO;
        tl.wrapped = NO;
        tl.truncationMode = kCATruncationNone;

        if ( debugMode )
        {
            tl.borderWidth = 1;
            tl.cornerRadius = 3;
            tl.borderColor = [UIColor whiteColor].CGColor;
        }

        // Text layer frame determined here. Effects how arc is centered. 
        CGSize charSize = CGSizeMake(20, 20);
        tl.frame = CGRectMake( shiftH + xcenter - xoffset, shiftV + ycenter + yoffset, charSize.width, charSize.height );
        // *******

        tl.font = (__bridge CFTypeRef)(font.fontName);
        tl.fontSize = font.pointSize;
        tl.foregroundColor = textColor.CGColor;
        tl.string = c;
        tl.alignmentMode = @"center";

        tl.transform = CATransform3DMakeAffineTransform( CGAffineTransformMakeRotation( degreesToRadians(rotAngle) ) );
        [layer addSublayer:tl];
        angle += angleStep;
    }

    if ( debugMode )
    {
        layer.backgroundColor = RGBA(0x00, 0x00, 0x00, .6).CGColor;
    }
}

- (void)rotateContinously
{
    CABasicAnimation *rotationAnimation;
    rotationAnimation = [CABasicAnimation animationWithKeyPath:@"transform.rotation.z"];
    rotationAnimation.toValue = [NSNumber numberWithFloat: M_PI * 2.0 /* full rotation*/ * 1 * 1 ];
    rotationAnimation.duration = 5;
    rotationAnimation.cumulative = YES;
    rotationAnimation.repeatCount = INT_MAX;

    [self.layer addAnimation:rotationAnimation forKey:@"rotationAnimation"];
}
@end 
```

这里的数学有什么问题？为什么这个文本不会以自身为中心？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T10:07:36.747

问题来自您设置每个文本图层的框架而不是其位置的事实。这意味着您将左下角定位在该位置应该在的位置。改为这样做：

```
 tl.position = CGPointMake( shiftH + xcenter - xoffset, shiftV + ycenter + yoffset);
    tl.bounds   = CGRectMake(0,0,charSize.width,charSize.height); 
```

你会发现你的图层正好在你想要的地方。

# perforce - 在 perforce 中，一个文件可以有多个操作吗？

> ID：16042999
> 
> 赞同：1
> 
> 时间：2013-04-16T17:07:19.813
> 
> 标签：perforce

根据[文档`fstat`](http://www.perforce.com/perforce/doc.current/manuals/cmdref/fstat.html)，文件的操作可以是以下之一：添加、编辑、删除、分支、移动/添加、移动/删除、集成、导入、清除或存档。

我的工作区中的文件是否有可能同时具有多个操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T18:40:59.350

虽然您有时可以对一个文件执行多项操作（例如，对文件执行//`p4 integrate`操作，然后对其进行操作），但只会列出一个字段。`p4 move``p4 copy``p4 edit``p4 fstat``action`