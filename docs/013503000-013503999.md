# StackOverflow 问答 13503000-13503999

# jquery - 为什么jQuery异步触发就绪事件

> ID：13503003
> 
> 赞同：5
> 
> 时间：2012-11-21T22:18:33.407
> 
> 标签：jquery, domready

在 jQuery 就绪事件逻辑中：

```
// Catch cases where $(document).ready() is called after the
// browser event has already occurred.
if ( document.readyState === "complete" ) {
    // Handle it asynchronously to allow scripts the opportunity to delay ready
    return setTimeout( jQuery.ready, 1 );
} 
```

您能否解释一下评论：“异步处理它以允许脚本有机会延迟准备好”。

我不明白什么*脚本*以及为什么*要延迟准备好*？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T22:31:34.947

如果准备好的回调（触发`readyList`）会立即触发，那么一旦 DOM 准备好使用该[`holdReady`](http://api.jquery.com/jQuery.holdReady/)函数，您就无法阻止它的执行。

`jQuery.holdReady( hold )`
**描述：持有或释放jQuery的ready事件的执行。**

> **$.holdReady()**方法允许调用者延迟 jQuery 的就绪事件。
> 
> **这种高级功能通常由动态脚本加载器使用，这些加载器希望在允许发生 ready 事件之前加载额外的 JavaScript（例如 jQuery 插件），即使 DOM 可能已准备好。**
> 
> 此方法必须在文档的早期调用，例如在 jQuery 脚本标记之后立即调用。在 ready 事件已经触发后调用此方法将无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:33:55.247

它与[`$.holdReady()`](http://api.jquery.com/jQuery.holdReady/)，它允许您延迟就绪事件。一个用例可能是您想在所有其他脚本运行之前做一些初始化工作。您可以延迟准备好，直到您完成初始化。

# c# - 单击 2 次后按钮消失（单点触控 - iPhone）

> ID：13503004
> 
> 赞同：0
> 
> 时间：2012-11-21T22:18:36.587
> 
> 标签：c#, iphone, uiview, xamarin.ios

我在 iPhone 视图上有一个基于单声道触控的按钮。当它被点击时，它会触发一个动画，然后返回到主动画。两个动画都在 UIImageView 上触发，该 UIImageView 位于按钮所在的同一视图上。

但是当我点击两次后它消失了？我希望按钮始终在表面上。

```
partial void TurnLightOnOrOff (MonoTouch.Foundation.NSObject sender)
        {
            TAMAM.coreLife.SwitchLightsStatus ();
            dayPartType = DayPart.CurrentDayPart ();
            if (dayPartType != DayPart.DayPartType.Night) {
                playMainAnim ();
                return;
            }
            var sound = SystemSound.FromFile (@"sound/Click.caf");
            sound.PlaySystemSound ();

            if (!TAMAM.coreLife.LightsOn) {

                myImages = new List<UIImage> ();
                myImages.Add (UIImage.FromFile (@"image/babysleep/babysleeplightoff10000.png"));
                myImages.Add (UIImage.FromFile (@"image/babysleep/babysleeplightoff20000.png"));
                myImages.Add (UIImage.FromFile (@"image/babysleep/babysleeplightoff30000.png"));
            var myAnimatedView = new UIImageView (this.animFrameRectangle);
                myAnimatedView.AnimationImages = myImages.ToArray ();
                myAnimatedView.AnimationDuration = 1; // Seconds
                myAnimatedView.AnimationRepeatCount = 0; // 0 = Loops Forever
                myAnimatedView.StartAnimating ();
                if (this.svBabyAge.Subviews.Length > 0) {
                    this.svBabyAge.Subviews [0].RemoveFromSuperview ();
                }
                if(this.ivBabyAge.Subviews.Length > 0)
                {
                    this.ivBabyAge.Subviews [0].RemoveFromSuperview ();
                }
                this.ivBabyAge.AddSubview (myAnimatedView);
                this.svBabyAge.AddSubview (this.ivBabyAge); 

            } else {
                playMainAnim ();
            }

        } 
```

{

```
 [Register ("babyAge")]
    partial class babyAge
    {
        [Outlet]
        MonoTouch.UIKit.UIView svBabyAge { get; set; }

        [Outlet]
        MonoTouch.UIKit.UIImageView ivBabyAge { get; set; }

        [Outlet]
        MonoTouch.UIKit.UIButton butonInformation { get; set; }

        [Action ("ShowInformationAboutTamagotchiStatus:")]
        partial void ShowInformationAboutTamagotchiStatus (MonoTouch.Foundation.NSObject sender);

        [Action ("FeedBaby:")]
        partial void FeedBaby (MonoTouch.Foundation.NSObject sender);

        [Action ("PlayWithBaby:")]
        partial void PlayWithBaby (MonoTouch.Foundation.NSObject sender);

        [Action ("TurnLightOnOrOff:")]
        partial void TurnLightOnOrOff (MonoTouch.Foundation.NSObject sender);

        [Action ("Dance:")]
        partial void Dance (MonoTouch.Foundation.NSObject sender);

        [Action ("DoctorRepairBaby:")]
        partial void DoctorRepairBaby (MonoTouch.Foundation.NSObject sender);

        [Action ("DoWc:")]
        partial void DoWc (MonoTouch.Foundation.NSObject sender);

        void ReleaseDesignerOutlets ()
        {
            if (svBabyAge != null) {
                svBabyAge.Dispose ();
                svBabyAge = null;
            }

            if (ivBabyAge != null) {
                ivBabyAge.Dispose ();
                ivBabyAge = null;
            }

            if (butonInformation != null) {
                butonInformation.Dispose ();
                butonInformation = null;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T13:32:51.080

我现在承认这是我的错：这是因为我删除了子视图的元素。我的目的是控制要删除的不必要元素，但在该循环中删除了按钮。

谢谢你的时间。

# build - 持续构建和交付仅更改的组件

> ID：13503009
> 
> 赞同：2
> 
> 时间：2012-11-21T22:19:07.137
> 
> 标签：build, msbuild, continuous-integration, teamcity

我的团队构建了一个基于 .NET 的软件和其他几个组件。目前使用 TeamCity 进行持续集成，MSBuild 用于简单地编译 .sln 文件（以及其他一些小任务，例如单元测试）。

我们的源代码控制以某种方式构建，使得 repo 包含许多在单次提交后编译的小型“插件”项目。

这使得仅**构建**更改的组件变得困难，而且以后**仅交付**那些作为构建工件的组件。

诸如将构建目标设置为“构建”而不是“重建”之类的解决方案可能会有所帮助，但它似乎有点过于脆弱，尤其是在处理可能在任意数量的构建“代理”上进行构建的分布式构建环境时，甚至那些没有以前的编译输出的。

我想知道解决这种情况的正确方法是什么？显然，这是一个已知问题，可能已经被许多人处理过。

我们希望构建和交付（每次构建）一组由当前构建（通过代码签入）修改的 DLL/组件。

我们可以实施哪些技术来实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T18:17:40.527

这被称为增量构建，并且长期以来一直是 SCM 流程的一部分。您的 Nant/msbuild 脚本应该能够从 CLI 进行增量构建和完整构建，否则它不被称为发布过程的完整独立构建设置。

将这些脚本连接到 CIE，如 buildforge、jenkins、cnuisecontrol 等。

实现这一点的最佳方法是在 Nant/Ant/msbuild 中使用一个开关，这样当您运行增量构建时，它不会删除旧的二进制文件，而是只编译最新的更改以创建与代码更改相关的二进制文件。

RTC Enterprise build 确实有一个功能，它会在成功编译后构建本地工作区之后，将交付后交付到您的流/分支，包括增量构建和完整构建。

但是我建议我们使用构建脚本来实现这一点，而不是尝试通过 CIE 工具来实现，以便开发利益相关者可以完全控制他们的构建和打包逻辑，并消除对构建工程师（第三方独立实体）的依赖了解应用程序的编译逻辑，并将从大多数固有问题（如错误构建、人为错误等）中节省大量时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T16:00:14.563

一种解决方案是“构建”而不是“重建”。如果构建在多个代理上运行，则在构建过程结束时将构建工件存档在共享位置，并在下一次构建开始时将这些工件复制到构建工作区（即，在他结束时自动归档工件）在构建开始时构建并复制它）。第一个构建将失败，因为将没有要复制的工件......因此保持该步骤在失败时继续或之前手动创建。运行他首先构建。这肯定会使他的构建时间增加一两分钟......所以确保共享位置与您的构建代理在同一个网络中......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T19:21:25.707

您可能需要重组您的源代码控制，以便每个插件都位于自己的小项目中。他们都引用的共享代码将在它自己的项目中生成通用 DLL。

Liora 提到了一个资产存储库。这很重要，因为它将为您提供一个存储所有这些小库的地方。在 .Net 领域，我听到越来越多关于 NuGet 的消息。

这个想法是，当插件发生更改时，您的 CI 系统将接受它，拉入任何公共/共享库，然后执行构建，发布该插件的新版本。当共享代码更改时会发生什么更有趣。您可能只是构建它，或者您可能触发其所有依赖项的构建。

几年前，我在一篇关于减少构建管理痛苦的文章中谈到了这一点：[http ://www.urbancode.com/html/resources/articles/build-pain-relief/components.html](http://www.urbancode.com/html/resources/articles/build-pain-relief/components.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-23T11:54:10.230

我不确定我遇到了正确的问题。但是，据我所知，您需要使用某种资产库来管理您的构建结果工件。更新资产后，可以配置后续操作。

让我知道这是否能解决您的问题。

利奥拉

# php - Wordpress - 使用 wordpress 之外的函数

> ID：13503014
> 
> 赞同：2
> 
> 时间：2012-11-21T22:20:05.253
> 
> 标签：php, wordpress

我正在使用以下代码从另一个页面访问我的 wordpress：

```
 <?php

    include $_SERVER['DOCUMENT_ROOT'].'/wp-load.php';
    global $wpdb;

    $image_ID = $wpdb->get_var("SELECT post_id FROM $wpdb->postmeta WHERE meta_value = '6036' AND meta_key = '_wp_attached_file'");

    //regenerate thumbnail
    $fullsizepath = get_attached_file( $image_ID );
    $metadata = wp_generate_attachment_metadata( $image_ID, $fullsizepath );
    wp_update_attachment_metadata( $image_ID, $metadata );

    ?> 
```

我收到以下错误：

```
Fatal error: Call to undefined function wp_generate_attachment_metadata() 
```

$wpdb 查询工作正常，get_attached_file 也一样。唯一的问题是我不能使用[wp_generate_attachment_metadata](http://codex.wordpress.org/Function_Reference/wp_generate_attachment_metadata)。

有人知道为什么会这样吗？我忘了包括一些东西吗？

**编辑：**我才意识到我只是忘了`include( ABSPATH . 'wp-admin/includes/image.php' );`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T04:40:06.540

您需要包含 wp-blog-header.php 来设置 wordpress 环境。

```
 <?php 
    require('blog/wp-blog-header.php');
    $args = array( 'numberposts' => 5, 'post_status'=>"publish", 'post_type'=>"post", 'orderby'=>"post_date");
    $postslist = get_posts( $args );

    foreach ($postslist as $post) : setup_postdata($post); ?>
        <ul class="headline">
            <li class="title">
                <a href="<?php the_permalink(); ?>" title="<?php the_title(); ?>"><?php the_title(); ?></a></li>
        </ul>
    <?php endforeach; ?> 
```

# c# - 推荐使用的设计模式

> ID：13503015
> 
> 赞同：0
> 
> 时间：2012-11-21T22:20:06.200
> 
> 标签：c#, entity-framework, design-patterns

假设我有非常基本的**任务**类，如下所示：

```
public class Task
{
    string Title { get; set; }
} 
```

现在我想将规划“行为”添加到我的**一些**任务中。显然我将不得不有类似的东西：

```
public interface IPlannable
{
    public void CalculatePlan();
    public DateTime Start { get; }
    public DateTime Finish { get; }
} 
```

和两个具体算法，每个都有不同的输入参数：

```
public class PlanStrategyA : IPlannable
{
    private int parameter1;
    private int parameter2;
    private DateTime start;
    private DateTime finish;

    public PlanStrategyA(int p1, int p2)
    {
        parameter1 = p1;
        parameter2 = p2;
    }

    public void CalculatePlan()
    {
        // ... uses parameter1 & parameter2
        // ... to calculate start and finish
    }

    public DateTime Start { get { return this.start; } }

    public DateTime Finish { get { return this.finish; } }
}

public class PlanStrategyB : IPlannable
{
    public int parameter3;

    // ... the rest is similar to PlanningStrategyA

} 
```

问题是：

什么是用于将基本任务类连接到作为选项的具体计划策略的**最佳设计模式**，这意味着并非所有任务都需要进行计划，即。有规划行为吗？

用户应该有可能“促进”计划中的任务，也可以从特定任务中“删除”这种行为。

这一切如何适用于通过 EF 或其他 ORM 持久化到数据库，特别是在从数据库读取时？哪种模式最适合从 DB 读取并创建我的任务对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:25:49.313

似乎您在这里有两个不同的问题。一个是可计划任务的策略算法——您可以使用[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)来处理这个问题。关于不可计划的任务，我看到了两种可能的方法：

1.  将其排除在设计模式的范围之外。没关系，如果不需要，不应将模式强加于您的设计。
2.  有一个 2 级策略 - 上层选择任务是否可计划，下层（仅可计划）应用您的策略。

另一个是每个任务的一组可能行为。这可以通过[Composite 模式](http://en.wikipedia.org/wiki/Composite_pattern)来解决。没有行为也是一种行为。

# javascript - 如何启用 IE 全屏功能，如 firefox 和 chrome

> ID：13503016
> 
> 赞同：6
> 
> 时间：2012-11-21T22:20:12.647
> 
> 标签：javascript, jquery, fullscreen

我看了以下文章和 jquery 插件

[http://www.sitepoint.com/html5-full-screen-api/](http://www.sitepoint.com/html5-full-screen-api/)

[http://johndyer.name/native-fullscreen-javascript-api-plus-jquery-plugin/](http://johndyer.name/native-fullscreen-javascript-api-plus-jquery-plugin/)

[http://xme.im/display-fullscreen-website-using-javascript](http://xme.im/display-fullscreen-website-using-javascript)

[http://feross.org/html5-fullscreen-api-attack/](http://feross.org/html5-fullscreen-api-attack/)

[http://jquery.pupunzi.com/questions/696/ie-containerplus-full-screen](http://jquery.pupunzi.com/questions/696/ie-containerplus-full-screen)

[IE Chrome框架全屏](https://stackoverflow.com/questions/12539107/ie-chrome-frame-full-screen)

但是找不到。

所有这些主要文章都参考了，但我找不到任何直接谈论IE全屏功能的文章，有没有人找到相同的解决方法？

我尝试了 W3C 提案

```
// W3C Proposal
element.requestFullscreen();
document.exitFullscreen(); 
```

**更新** 我的期望是，我有一个图像轮播，我需要显示当前选择的图像以全屏显示，似乎 IE 不支持，我打算使用 jQuery 模型窗口（没有 jQuery UI）。就像[例子](http://www.queness.com/post/77/simple-jquery-modal-window-tutorial)一样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-11-26T10:36:32.497

sheelpriy 答案很好，只需稍作改动，已在 chrome、firefox、即 safari 和 opera 上成功测试（所有最新版本）

```
//HTML Button : <a href="#" id="fullscreen">Fullscreen</a>

<script type="text/javascript">
    //Get element id "fullscreen"
    var fullScreenButton = document.getElementById("fullscreen"); 

    //Activate click listener
    fullScreenButton.addEventListener("click", function () {

        //Toggle fullscreen off, activate it
        if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement ) {
            if (document.documentElement.requestFullscreen) {
                document.documentElement.requestFullscreen();
            } else if (document.documentElement.mozRequestFullScreen) {
            document.documentElement.mozRequestFullScreen(); // Firefox
            } else if (document.documentElement.webkitRequestFullscreen) {
                document.documentElement.webkitRequestFullscreen(); // Chrome and Safari
            } else if (document.documentElement.msRequestFullscreen) {
                document.documentElement.msRequestFullscreen(); // IE
            }

        //Toggle fullscreen on, exit fullscreen
        } else {

            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            } else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            }
        }

    });
</script> 
```

享受 ！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T10:28:02.390

[Internet Explorer 全屏模式？](https://stackoverflow.com/questions/464332/internet-explorer-full-screen-mode)

[通过 javascript 将窗口设置为全屏（真正的全屏；F11 功能）](https://stackoverflow.com/questions/7179535/set-window-to-fullscreen-real-fullscreen-f11-functionality-by-javascript)

SO的这两篇文章将对您有所帮助。

```
<script type="text/javascript">
    function max() {
        var wscript = new ActiveXObject("Wscript.shell");
        wscript.SendKeys("{F11}");
    }
</script> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T22:22:24.320

根据[这个站点](http://caniuse.com/fullscreen)，IE 不支持全屏 API。似乎也没有关于这是否会被 IE11 支持的信息。

根据 MDN[关于全屏的文章，](https://developer.mozilla.org/en-US/docs/DOM/Using_fullscreen_mode)似乎这种技术对于大多数浏览器来说仍然是非常实验性的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-03T06:41:17.887

这将解决您的所有问题展开是用于全屏的按钮的 ID

```
var fullScreenButton = document.getElementById("expand"); 
fullScreenButton.addEventListener("click", function () {
            if (mediaPlayer.requestFullscreen) {
                mediaPlayer.requestFullscreen();
            } else if (mediaPlayer.mozRequestFullScreen) {
                mediaPlayer.mozRequestFullScreen(); // Firefox
            } else if (mediaPlayer.webkitRequestFullscreen) {
                mediaPlayer.webkitRequestFullscreen(); // Chrome and Safari
            }
            else if (mediaPlayer.msRequestFullscreen) {
                mediaPlayer.msRequestFullscreen(); // IE
            }
        }); 
```

ps会链接对你有很大帮助。： http: [//msdn.microsoft.com/en-us/library/ie/dn254939 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/dn254939(v=vs.85).aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-16T08:52:42.617

在 IE10 及更低版本中，通过脚本切换全屏是不可能的，除非您不调整其安全设置，如下所示 -

```
Tools->Internet Options->Security tab->click Custom Level button ->
find "Initialize and script ActiveX control not marked as safe." option -> change it to Enable 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-31T05:21:22.623

从[MSDN 网站上](https://msdn.microsoft.com/en-us/library/ie/dn254939%28v=vs.85%29.aspx)获取（并进行了修改，因为它们有丑陋的编码实践，当你缩小时会让你陷入困境）

```
var someElement = document.getElementById('fullscreen-toggle');
someElement.addEventListener('click',function(e){
    var divObj = document.body;  //change to whatever element you want

    if (divObj.requestFullscreen){
        if (document.fullScreenElement) {
            document.cancelFullScreen();       
        } else {
          divObj.requestFullscreen();
        }   
    }   

    else if (divObj.msRequestFullscreen){
        if (document.msFullscreenElement) {
            document.msExitFullscreen();
        } else {
            divObj.msRequestFullscreen();
        }           
    }

    else if (divObj.mozRequestFullScreen){
        if (document.mozFullScreenElement) {
            document.mozCancelFullScreen();
        } else {
          divObj.mozRequestFullScreen();
        }
    }

    else if (divObj.webkitRequestFullscreen){
        if (document.webkitFullscreenElement) {
            document.webkitCancelFullScreen();
          } else {
          divObj.webkitRequestFullscreen();
        }   
    }
    e.stopPropagation();
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-03T13:42:29.680

我回顾了我上面所说的（0_0）

经过大量研究和测试，这里有一个在 IE、EDGE、CHROME、FIREFOX 和 OPERA 上运行良好的脚本。它不适用于 SAFARI 5.1 版。我希望这会对你有所帮助......测试它创建一个 html 按钮并调用该函数

设置完整：

```
 setfullscreen(true); 
```

超满：

```
 setfullscreen(false); 
```

*** 此脚本不需要 addEventListner。

```
var ensuredoc = null;  //reg your actual document is JS
function setfullscreen(isetting){

var domfull = (typeof(document.fullscreenElement)=='object')?1: 
(typeof(document.msFullscreenElement)=='object')?2: 
(typeof(document.mozFullScreenElement)=='object')?3: 
(typeof(document.webkitFullscreenElement)=='object')?4:0;

if(isetting){

if(domfull >0){ ensuredoc =document; }

var docE=document.documentElement;

                    if(domfull ==1){
                    docE.requestFullscreen();   
                    }else if(domfull ==2){
                    docE.msRequestFullscreen();
                    }else if(domfull ==3){
                    docE.mozRequestFullScreen();
                    }else if(domfull ==4){
                    docE.webkitRequestFullscreen();                     
                    }
 }else{
                    if(domfull==1){
                        if((typeof 
 ensuredoc.exitFullscreen)=='function') 
 {ensuredoc.exitFullscreen();
                        }else if((typeof 
 ensuredoc.cancelFullScreen)=='function') 
 {ensuredoc.cancelFullScreen();};   
                    }else if(domfull==2){
                    ensuredoc.msExitFullscreen();
                    }else if(domfull==3){
                    ensuredoc.mozCancelFullScreen();
                    }else if(domfull==4){
                    ensuredoc.webkitCancelFullScreen();
                    }
  }

  } 
```

如果您想检测 DIV 对象的键盘使用情况，只需添加一个简单的代码

```
var mediv = document.getElementById('mediv');
mediv.onkeyup = function(){ if(condition) {setfullscreen(false);}} 
```

** 我忘了告诉你 EDGE 使用 WEBKIT。Chrome 使用 DOM 激活屏幕，但使用“exitFullscreen”退出

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-13T16:47:23.560

当浏览器切换到全屏并且用户按下 ESCAPE 键时，它不会返回按键事件。

解决方案是使用计时器来检测是否在 DIV 或其他对象上发生了更改。

我们将更改为全屏的按钮的真或假值存储在变量中

我们启动计时器并仅在大小发生变化时运行代码。例子...

```
 var buttonclick = false;
 var MeInterval = null;

 function timerscreen(){
      if(buttonclicked){
           if(objectdiv.offsetHeight < screen.availHeight){
                 your code here.....

           //end timer
           clearInterval(MeInterval);
           }
      }
 }

 objectdiv.onmouseup(){
      buttonclicked = !buttonclicked;
      if(buttonclicked) MeInterval= setInterval(timerscreen, 1000);
 } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-03T09:44:23.037

这是 Opera 和 Chrome 的一个真实功能示例，因为它们具有相同的 API。IE 和 Safari 不支持。

`addEventListener`对已经有事件的对象没有用，这就是为什么它被称为`Object.addEventListener`.

对于一个 DIV 对象来说，`mediv.onmouseX = function () {code ...}`绰绰有余；不需要，`mediv.addEventListener`因为`div`对象已经有鼠标事件。

对于全屏检查这个例子：

```
function mefull(iffull){
var isfullscreenelement = typeof(document.fullscreenElement)=='object';

if(!isfullscreenelement || isfullscreenelement=="undefined"){
    alert('Message !');
    return;
}

if(iffull){
document.documentElement.requestFullscreen();

//your code here......

}else{
if (document.exitFullscreen) {
document.exitFullscreen();

//Yourcode here......

}
}
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-08T07:16:53.517

vidWha 是我的视频元素的 id。

全屏是我的全屏按钮的 ID。

此代码适用于所有浏览器。经过测试。

```
var video = document.getElementById('vidWha');
var fullScreenButton = document.getElementById('full-screen');

// Event listener for the full-screen button
fullScreenButton.addEventListener("click", function() {
if (video.requestFullscreen) {
    video.requestFullscreen();
}else if (video.mozRequestFullScreen) {
    video.mozRequestFullScreen(); // Firefox
}else if (video.webkitRequestFullscreen) {
    video.webkitRequestFullscreen(); // Chrome and Safari
}else if (video.msRequestFullscreen) {
    video.msRequestFullscreen(); // IE
}
}); 
```

# java - Netty 大字符串，没有足够的可读字节

> ID：13503017
> 
> 赞同：1
> 
> 时间：2012-11-21T22:20:13.583
> 
> 标签：java, string, byte, netty, indexoutofboundsexception

我试图从我的服务器向我的客户端写入一个“大”字符串（986 个字符），但在读取 16 个字符后出现以下错误：

```
not enough readable bytes - need 2, maximum is 0. 
```

它在发送较小的字符串时可以正常工作，但是对于这么多的字符会引发此错误。

我们使用[BigEndianHeapChannelBuffer](http://static.netty.io/3.5/api/org/jboss/netty/buffer/BigEndianHeapChannelBuffer.html)来接收我们的数据。

write 的 obj.length() 和 read 的 buffer.readUnsignedShort() 都给出了相同的（正确的）数字，但其余的它在 for 循环中崩溃。

Netty 版本是 3.5.10 FINAL

有人知道如何解决这个问题吗？请询问您是否需要更多信息。

以下是一些代码片段：

写信给流：

```
public void addString(String obj)
{
  try
  {
    bodystream.writeShort(obj.length());
    bodystream.writeChars(obj);
    System.out.println("Server wrote bytes: " + obj.length());
    message = message + ";STRING: " + obj;
    // bodystream.w(obj);
  }
  catch(IOException e)
  {
  }
} 
```

从流中阅读：

```
public String readString()
{
  try
  {
    int len = buffer.readUnsignedShort();
    System.out.println("Client can read bytes: " + len);

    char[] characters = new char[len];
    for(int i = 0; i < len; i++)
      characters[i] = buffer.readChar();

    return new String(characters);
  }
  catch(Exception e)
  {
    System.err.println(e.getMessage());
    return "";
  }
} 
```

解码：

```
public class NetworkDecoder extends FrameDecoder
{
  @Override
  protected Object decode(ChannelHandlerContext ctx, Channel channel, ChannelBuffer buffer)
  {
    try
    {
      int opcode = buffer.readUnsignedByte();
      System.out.println("[In] <- " + opcode);
      return new ServerMessage(buffer, opcode);
    }
    catch(Exception e)
    {
      e.printStackTrace();
    }
    return null;
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T19:58:12.400

在将缓冲区传递给 ServerMessage 之前，您需要确保缓冲区中有足够的数据。您还想调用 ChannelBuffer.readBytes(..) 来“复制数据，否则会占用内存。

# java - 按最接近零的数字对数组进行排序

> ID：13503021
> 
> 赞同：1
> 
> 时间：2012-11-21T22:20:45.537
> 
> 标签：java, arrays, sorting

如果您想知道，我不是想简单地首先对具有最小数字的数组进行排序，而是尝试通过首先显示数字最接近 0 的数组列表来对数组进行排序。

它适用于数组中的某些元素，但是当它需要向后遍历数组时，它不会......它只是抛出一个超出范围的异常

这是我的代码：

```
package SSTF;

public class test2 {

    public static void main (String[] args)
    {
        int[] temp_array = {9, 22, 3, -4, 5, 8};

        for(int i =0; i<temp_array.length; i++)
        {   

                System.out.print(temp_array[i] + "    ");
    }

    System.out.println("\n\nNumbers closest to 0:\n");

    closestToZero(temp_array);

    }

    public static void closestToZero(int[] array) 
    {
        int num = array[0];
        int absNum = Math.abs(num);

        for(int i = 1; i < array.length; ++i) 
        {
            int newAbs = Math.abs(array[i]);

            if(newAbs < absNum) 
            {

                absNum = newAbs;
                num = array[i];

                for(int j=0; j<array.length; j++)
                {
                    System.out.print(array[i+j] + "   ");
                }
            }   
        }
    }
} 
```

我真的希望这只是一件小事，有人可以提供帮助，因为我不知道如何解决它：S

输出：

```
9    22    3    -4    5    8    

Numbers closest to 0:

3   -4   5   8 Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 6
    at SSTF.test2.closestToZero(test2.java:42)
    at SSTF.test2.main(test2.java:18) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:24:38.200

这是你的问题：

```
System.out.print(array[i+j] + "   "); 
```

考虑以下情况，当：

*   `i == array.length - 1`和
*   `j == array.length - 1`， 然后
*   的总和`i+j`是`2 * array.length - 2`,

这很可能超出了数组的范围。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T22:25:22.177

这是您`i+j`在内部循环中使用的。我不完全确定您要在那里做什么，但是，由于这两个变量都可以达到`length-1`，显然总和会大于那个，因此边界异常。

您可能应该问自己*，为什么*每次找到接近零的元素时都要重新打印出数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T22:25:52.790

问题很可能出在这行代码上：

```
System.out.print(array[i+j] + "   "); 
```

你能保证它`i + j`始终是你的数组的有效索引吗？请记住，有效索引必须介于 0 和 之间`size - 1`，其中`size`是数组元素的数量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-21T22:33:12.003

正如其他人所指出的，它是用于`i+j`对导致异常的数组进行索引。

现在，我不会从头开始编写自己的排序例程，而是使用以下答案中的代码以及适当的比较器：

[https://stackoverflow.com/a/3699501/367273](https://stackoverflow.com/a/3699501/367273)

如果你可以使用`Integer[]`而不是`int[]`，你甚至不需要`ArrayUtils`，并且可以`Arrays.sort(T[] a, Comparator<? super T> c)`直接使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-22T00:26:42.203

**我认为这种方式更好**

```
 int[] temp_array = {9, 22, 3, -4, 5, 8};

        for(int i =0; i< temp_array.length; i++)
        {   

                System.out.print(temp_array[i] + "    ");

        }

    System.out.println("\n\nNumbers closest to 0:\n");

Arrays.sort(temp_array);

for (int i = 0 ; i < temp_array.length; i++){

    System.out.println(temp_array[i]);

}

} 
```

# mysql - 具有计算间隔值的 Doctrine 2 DATE_ADD mysql 函数

> ID：13503023
> 
> 赞同：3
> 
> 时间：2012-11-21T22:20:48.103
> 
> 标签：mysql, doctrine-orm, sql-date-functions

我有一个查询，它给我一个 unix 时间戳，计算选择表字段的日期时间值，然后添加表的另一个值。查询类似于以下内容：

```
SELECT UNIX_TIMESTAMP(DATE_ADD(mydatetimefield, INTERVAL m.myfield1 + m.myfield2 MINUTE)) FROM mytable AS m 
```

此查询从 phpMyAdmin 正确执行，但是当我尝试将它与 Doctrine 2 的 createQueryBuilder 方法一起使用时，我在“myfield”处收到错误。似乎它不支持 INTERVAL 关键字之后的计算值

```
Error: Expected Doctrine\ORM\Query\Lexer::T_COMMA, got 'm' 
```

那么我怎样才能通过使用学说获得相同的查询结果？我使用查询构建器，因为我有一些命名参数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:49:40.850

默认情况下，Doctrine 不支持特定供应商的所有功能，例如`DATE_ADD`. 但是，您可以使用自定义函数。该链接有一个专门用于添加日期的示例。

[在 Doctrine 2 中扩展 DQL：用户定义的函数](https://www.doctrine-project.org/2010/03/29/doctrine2-custom-dql-udfs.html)

另一个选项，取决于查询的复杂性，只是在应用程序代码中处理这个问题。如果您`mydatetimefield`实际上是日期时间，Doctrine 会将其转换为`DateTime`返回对象中的 php。

```
$myDateTimeField = $object->getMyDateTimeField();
$myDateTimeField->add(new DateInterval( $object->getMyField1() + $object->getMyField2() . 'M')); 
```

最后，您也可以随时使用`dbal`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:47:27.740

不确定这是否是原因，但由于它抱怨您有`m`别名的地方缺少逗号，我怀疑它无法正确解析用户定义的函数。

您是否将`DATE_ADD`and定义`UNIX_TIMESTAMP`为[DQL 用户定义函数](http://docs.doctrine-project.org/en/2.1/cookbook/dql-user-defined-functions.html#dql-user-defined-functions)？有关更多详细信息，请参阅[日期添加](http://docs.doctrine-project.org/en/2.1/cookbook/dql-user-defined-functions.html#date-add)示例。

# git - 使用 GIT 在 MAMP 上部署 Zend Framework 2

> ID：13503024
> 
> 赞同：1
> 
> 时间：2012-11-21T22:20:49.013
> 
> 标签：git, terminal, zend-framework2, mamp

我正在尝试查找有关如何`Zend Framework 2`使用Server 进行部署`git`并将`terminal`其设置为与`MAMP`Server 一起使用的信息。

我也想在我的终端中为`zf2`. 那可能吗？

任何帮助或指向解释如何操作的文章的链接都会有所帮助！

# objective-c - NSUserDefaults，不可靠？

> ID：13503030
> 
> 赞同：0
> 
> 时间：2012-11-21T22:21:15.430
> 
> 标签：objective-c, nsuserdefaults

我正在通过构建一个与 PHP/MySQL api 对话的小型应用程序来学习 obj-c 的项目。

每次用户做某事时，都会为该用户设置一个新的 auth-key 并发送给客户端。客户端接收到这个值并且应该将它设置为 NSUserDefaults。这是为了在每次程序启动时都不让用户登录；如果此密钥存在，它将尝试使用此密钥进行身份验证，然后自动登录。

有时这可行……我有两个功能，一个用于接收，一个用于设置。它们看起来像这样：

```
//GET
-(NSString*)GetValue:(NSString *)Name
{
    NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
    NSString *get = [prefs stringForKey:Name];

    if(get)
        return get;
    else
        return FALSE;
}
//SET
-(void)SetValue:(NSString*)Name:(NSString*)Value
{
    //Add new...    
    [[NSUserDefaults standardUserDefaults] setObject:Value forKey:Name];    
} 
```

这工作，几乎。
问题是这样的：

1）未设置 auth-key 值（在 NSUserDefaults 中）
2）我尝试登录用户，设置值（如“aaaaaaaaaaaaaaaa”），一切都很好。我重新启动程序，它使用这个存储的值，尝试登录，从 PHP 中得到一个肯定的结果以及一个新的密钥，当答案返回时必须设置它......就像这样......

```
if(NewKey.length > 0)
{
    NSLog(@"TRY SET KEY: %@", NewKey);
    [self SetValue:@"auth_key":NewKey];
    NSLog(@"TRY GET KEY: %@", [self GetValue:@"auth_key"]);
} 
```

3）上面的NSLog说“TRY SET KEY: bbbbbbbbbbbbbbbb”和“TRY GET KEY: bbbbbbbbbbbbbbbb”。看起来很完美！
4) 好吧，我杀了程序再试一次，现在它应该已经存储了“bbb...”，对吧？错误的！当我现在 NSLogs 这个值时，它仍然是“aaa ...”
5）我再次尝试登录，NSLog 显示“TRY SET KEY：ccc ...”和“TRY GET KEY：ccc ...” - 它说值被存储。但它不是......
6）我杀死程序，重新启动并得到“aaa......”。
7）我杀死程序，在AppDelegate中我手动设置这个值（具有相同的功能）喜欢“xxx”。我运行该程序，它将密钥设置为“xx”之类的东西。我删除了这一行，重新启动程序，“xxx”被正确存储，现在我又回到了#2；我可以进行一次登录，它会正确存储此值，然后我可以进行一次自动登录，但是在该登录时它会停止保存它...

那么，这里有什么问题？我已经尝试`[[NSUserDefaults standardUserDefaults] removeObjectForKey:Name];`在 SetValue 中作为第一行，但它没有帮助。

就像它设置了一样，然后无论如何都被遗忘了......我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T22:24:12.880

`NSUserDefaults`设置值时不会将更改写入文件。它会定期这样做，偶尔一次。如果您希望它立即将更改保存到磁盘，您应该同步它：

```
[[NSUserDefaults standardUserDefaults] setObject:Value forKey:Name];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

# c# - 将小数转换为双精度时意外截断

> ID：13503032
> 
> 赞同：2
> 
> 时间：2012-11-21T22:21:20.170
> 
> 标签：c#, double, type-conversion, decimal

将小数转换为双精度时，有时会出现一些意外的截断。例如：

```
 decimal dec = -96.31614743511301m;
        double dbl = Convert.ToDouble(dec);  // dbl = -96.316147435113, why? 
```

对于其他值，它按预期工作：

```
 decimal dec2 = -96.269592225955307m;
        double dbl2 = Convert.ToDouble(dec2); // dbl2 = -96.269592225955307, expected 
```

请注意，第二个有效的示例实际上比第一个无效的示例具有更多的小数位。此外，第一个值可以使用以下复杂代码成功转换为双精度值：

```
 dbl = Convert.ToDouble(dec.ToString()); // dbl = -96.31614743511301, expected 
```

那么为什么在第一个示例中会截断双精度值呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:23:30.050

Decimal 和 double 以不同的精度以不同的方式存储......请参见此处 - [.NET 中的 decimal、float 和 double 之间的区别？](https://stackoverflow.com/questions/618535/what-is-the-difference-between-decimal-float-and-double-in-c)

# python - 作为 sockjs brukva 使用异步服务器和客户端来识别和响应个人

> ID：13503036
> 
> 赞同：0
> 
> 时间：2012-11-21T22:21:52.553
> 
> 标签：python, websocket, tornado, sockjs

我正在构建一个实时 Web 应用程序。

**我只想连接客户端，使用 sockjs 从服务器识别并向每个客户端发送不同的消息**

到目前为止，我们实现的是从浏览器连接并发送一条消息，我回答了同一台服务器。

## 当前代码

服务器.py

```
# -*- coding: utf-8 -*-
from sockjs.tornado import SockJSRouter, SockJSConnection
from tornado import web, ioloop

class ConnectionHandler(SockJSConnection):

    def on_open(self, info):
        print 'new connection'

    def on_message(self, msg):
        print str("server receives: %s" % msg)
        self.send(u"server responds: %s" % msg)

if __name__ == "__main__":
    onopen = SockJSRouter(ConnectionHandler, r"/websocket")

    application = web.Application(onopen.urls)

    application.listen(8686)
    ioloop.IOLoop.instance().start() 
```

客户端.html

```
<!DOCTYPE html>
<html>
    <head>
        <title>SockJS</title>
    </head>
    <script src="http://cdn.sockjs.org/sockjs-0.3.min.js"></script>
    <script>
        con = new SockJS('http://localhost:8686/websocket');
        con.onmessage = function(evt){
            x = document.createElement("p");
            x.innerHTML = evt.data;
            document.getElementById("msgbox").appendChild(x);
        }
        function DispatchText(){
            var userInput = document.getElementById("message").value;
            document.getElementById("message").value = "";
            x = document.createElement("p");
            x.innerHTML = "message sent: " + userInput;
            document.getElementById("msgbox").appendChild(x);
            con.send(userInput);
        }
    </script>
    <body>
        <p style="width: 800px">Use form to communicate with the server.</p>
        <div id="msgbox" style="font-size: 14pt; height: 500px; width: 800px; overflow: scroll; border: 1px solid black"></div>
        <form id="communication" onsubmit="DispatchText()" action="javascript:void(0);">
            <input type="text" id="message" name="message" autocomplete="off" style="width:700px" />
            <input type="submit" id="sub" name="sub" value="send" style="width:90px" />
        </form>
    </body>
</html> 
```

## 问题

如何识别每个客户？

作为向单个客户端发送消息，所有连接的人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:30:05.483

您需要保留连接列表。现在，当收到一条消息时，它会发送到所有连接的客户端：

```
class ConnectionHandler(SockJSConnection):
    connections = set()

    def on_open(self, info):
        print 'new connection'
        self.connections.add(self)

    def on_message(self, msg):
        print str("server receives: %s" % msg)

        for conn in self.connections:
            conn.send(u"server responds: %s" % msg)

        # Note you could also use self.broadcast(self.connections, msg)

    def on_close(self):
        self.connections.remove(self) 
```

# c - 在 8 位 SFR（特殊寄存器）上定义引脚

> ID：13503037
> 
> 赞同：0
> 
> 时间：2012-11-21T22:21:54.847
> 
> 标签：c, pins

在 Infineon C509 中有一个叫做 S1CON 的寄存器，它是一个特殊的功能寄存器，看起来像这样。 ![在此处输入图像描述](../Images/9aa8c4f5892b50370772110dbe721bf5.png)

可以将 S1CON 上的位 0 定义为 RI1，以便在主程序中访问和引用它。我想在我的主程序中检查串行接口 1 的接收标志中断是高还是低。它没有在头文件中定义，但 S1CON 是

```
sfr   S1CON  = 0x9B; 
```

谢谢

或者是否可以只检查 S1CON 上位 0 的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:29:56.787

您可以为各个位定义掩码（它们可能已经在适当的头文件中为您定义），例如

```
#define RI1  0x01 // RI1 = bit 0
#define TI1  0x02 // TI1 = bit 1
#define RB81 0x04 // RB81 = bit 2
... 
```

然后测试 RI1：

```
if (SC1CON & RI1)
    ... 
```

设置 RI1：

```
SCICON |= RI1; 
```

清除 RI1：

```
SCICON &= ~RI1; 
```

# java - 使用 pcap 库打开 TCP 转储文件

> ID：13503038
> 
> 赞同：0
> 
> 时间：2012-11-21T22:21:57.647
> 
> 标签：java, c++, network-programming, pcap, tcpdump

我想通读一个 tcp 转储文件并打印出数据包长度及其开始和结束时间或只是时间戳。我知道 pcap 库可以做到这一点。但是我找不到打开转储文件并针对该信息进行处理的具体示例。我可以接受任何语言和平台。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:02:46.030

你想要 pcap_open_offline()。有一个手册页，[这里有一个使用它的例子](http://savagelook.com/blog/code/offline-packet-capture-processing-with-cc-and-libpcap)。

# python - Python-twitter - 意外的关键字参数“access_token_key”

> ID：13503043
> 
> 赞同：0
> 
> 时间：2012-11-21T22:22:41.080
> 
> 标签：python, json, twitter, oauth, python-twitter

```
#!/usr/bin/python
# -*- coding: iso-8859-15 -*-
import twitter

class twitt():
    def __init__(self):
        consumer_key = '...'
        consumer_secret = '...'
        access_key = '...'
        access_secret = '...'

        encoding = 'iso-8859-15'

        self.api = twitter.Api(consumer_key=consumer_key, consumer_secret=consumer_secret, access_token_key=access_key, access_token_secret=access_secret, input_encoding=encoding)

    def run(self):
        statuses = self.api.GetPublicTimeline()
        print statuses

h = twitt()
h.run() 
```

* * *

此代码不起作用，它直接取自自述文件和我找到的每个示例。我发现了一些关于“get_access_token.py”的东西，但没有提到它！？

user@host:~# updatedb
user@host:~# locate get_access_token
user@host:~#

**错误：** `TypeError: __init__() got an unexpected keyword argument 'access_token_key'`

参考：
- [http://code.google.com/p/python-twitter/issues/detail?id=215](http://code.google.com/p/python-twitter/issues/detail?id=215)
- [https://github.com/bear/python-twitter/tree/master/examples](https://github.com/bear/python-twitter/tree/master/examples)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:45:12.100

我只能认为这可能`twitter`不是您认为的 Twitter 库：

试着看看你是否得到类似的东西：

```
>>> import twitter
>>> twitter.__file__
'/usr/local/lib/python2.7/dist-packages/python_twitter-0.8.2-py2.7.egg/twitter.pyc'

>>> import inspect
>>> inspect.getargspec(twitter.Api.__init__)
ArgSpec(args=['self', 'consumer_key', 'consumer_secret', 'access_token_key', 'access_token_secret', 'input_encoding', 'request_headers', 'cache', 'shortner', 'base_url', 'use_gzip_compression', 'debugHTTP'], varargs=None, keywords=None, defaults=(None, None, None, None, None, None, <object object at 0x7f023505a220>, None, None, False, False)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:49:36.847

API 版本错误。主要（仅？）使用旧版本支持用户名/密码身份验证。

正在使用 twitter.py 的“0.6-devel”
更新到 0.8.X 并且它工作得更好..

**编辑：**

该 API 也已过时，它不支持通过 Twitter 的 Streaming API，这意味着您只会获得重要的帖子，我需要获取主题标签搜索中的所有帖子。

**我推荐：**
SixOhSix twitter API：[https](https://github.com/sixohsix/twitter) ://github.com/sixohsix/twitter 易于使用，像魅力一样工作，并为您提供所需的结果。

# php - 理解条件解决优先级内的赋值

> ID：13503044
> 
> 赞同：3
> 
> 时间：2012-11-21T22:22:42.483
> 
> 标签：php, loops, expression, variable-assignment

今天在工作中，我被困在一行我无法理解的代码中。我在 JavaScript 中有一个函数，为了确保获得唯一的时间戳，我做了那个丑陋的循环：

```
var ts = +new Date();
while (ts === (ts = +new Date())); 
```

我认为很清楚我们正在重新设置 ts 直到它的值变得不同。

但是当我尝试将函数迁移到 PHP 代码时 - 就像这样：

```
$ts = preg_replace('/^\d\.(\d+)\s(\d+)$/', '$2$1', microtime());
//regex extracts digits and re-positions them - ugly microtime :(
while ($ts === ($ts = preg_replace('/^\d\.(\d+)\s(\d+)$/', '$2$1', microtime()))); 
```

解释器进入无限循环。我所有的尝试似乎都表明 $ts 分配是在比较之前进行的，但我不明白为什么没有首先解决左侧表达式。我的 PHP 知识没有我的 JavaScript 知识那么大，所以我想知道是否有一些关于我泄露的 PHP 表达式和语句的关键提示。

建议：我不想通过制作“结构良好”的循环来修复我的代码——解决方案很明显——我很想了解这里发生了什么。非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:41:47.553

PHP 将在比较之前评估赋值，所以到它做的时候`$ts ===`，`$ts =`已经发生了。这是一个快速修复：

```
$ts = preg_replace('/^\d\.(\d+)\s(\d+)$/', '$2$1', microtime());

//regex extracts digits and re-positions them - ugly microtime :(
while ($ts === ($ts2 = preg_replace('/^\d\.(\d+)\s(\d+)$/', '$2$1', microtime()))) {
    $ts = $ts2;
} 
```

此外，PHP 有一个方便的函数，称为 uniqid()，它会为您做类似的事情。它每次都会给你一个唯一的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:52:46.647

PHP 需要先评估赋值，然后才能进行比较。通常，赋值运算符的优先级很低，所以当你写 时`$a = $b + $c`，首先计算加法，然后将结果分配给 $a。然而，这是一个特例，虽然它似乎没有很好地记录在案，但在文档中发现了一个类似的案例，说明：

> 尽管`=`优先级低于大多数其他运算符，但 PHP 仍然允许类似于以下的表达式：`if (!$a = foo())`，在这种情况下， 的返回值`foo()`被放入`$a`。

所以在这种情况下，PHP 确定它需要先进行赋值，然后才能否定赋值的结果。我认为这里正在发生类似的事情，尽管 PHP 以后应该能够完成分配是对的。

实际上，结果可能是不可预测的，就像其他一些表达式一样：

```
// mixing ++ and + produces undefined behavior
$a = 1;
echo ++$a + $a++; // may print 4 or 5 
```

# php - Mysqli“SELECT * FROM”循环

> ID：13503050
> 
> 赞同：2
> 
> 时间：2012-11-21T22:23:35.220
> 
> 标签：php, select, mysqli

我现在正在跳转到 mysqli/PDO，并将 SELECT 循环从“旧”方法转换为 mysqli。

“旧”方法：

```
$query="SELECT * FROM transactions ORDER BY id DESC LIMIT 10";
$result=mysql_query($query);
$num=mysql_num_rows($result);       

$i=0;

while ($i < $num) {
    $f1=mysql_result($result,$i,"name");
    $f2=mysql_result($result,$i,"surname");
    $f3=mysql_result($result,$i,"pcode");
    $f4=mysql_result($result,$i,"transaction_id");
    $f5=mysql_result($result,$i,"articles");
    $f6=mysql_result($result,$i, "delivery");

    //echo out to table here

    $i++;

} 
```

我已经了解了基本的 mysqli 查询，然后简单地尝试复制上面的 while 循环：

```
if ($pending_stmt=$mysqli->prepare('SELECT * FROM transactions WHERE status = ?')) {
    $pending_stmt->bind_param('s', $status); //$status is set prior to if statement
    $pending_stmt->execute();
    $pending_stmt->store_result();
    $pending_stmt->fetch_all();

    $rows=$pending_stmt->num_rows();

    $i=0;

    while ($i < $rows) {
        $f1=$pending_stmt->fetch($i,'pcode');

        //echo out to table here

        $i++;
    }
} 
```

不用说，它不起作用......经过大量搜索，我想知道是否有人愿意给我一些指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-12-02T21:07:03.473

难怪它不起作用。你把一切都混在一起了。你不需要`store_result()`,`fetch_all()`或`num_rows()`. `fetch()`无法像以前那样导航到特定的行和列`mysql_result()`。
你有两个选择如何解决它。

1.  使用`get_result()`

    ```
    $pending_stmt = $mysqli->prepare('SELECT columnA, columnB FROM transactions WHERE status = ?');
    $pending_stmt->bind_param('s', $status); //$status is set prior to if statement
    $pending_stmt->execute();
    $result = $pending_stmt->get_result();

    foreach ($result as $row) {
        echo $row['columnA'];
        echo $row['columnB'];
    } 
    ```

2.  使用`store_result()`,`bind_result()`和`fetch()`

    ```
    $pending_stmt = $mysqli->prepare('SELECT columnA, columnB FROM transactions WHERE status = ?');
    $pending_stmt->bind_param('s', $status); //$status is set prior to if statement
    $pending_stmt->execute();
    $pending_stmt->store_result(); // recommended, but not necessary
    $pending_stmt->bind_result($f1, $f2);

    while ($pending_stmt->fetch()) {
        echo $f1;
        echo $f2;
    } 
    ```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T22:27:56.057

尝试

```
$pending_stmt->execute(array($status));
$result = $pending_stmt->fetchAll(); 
```

我不明白您为什么使用 count var，请为每个尝试一个：

```
foreach($result as $item) {
    $f1 = $item['pcode'];
} 
```

# scorm2004 - ganesha <--> scorm 2004：选择控制模式？

> ID：13503052
> 
> 赞同：0
> 
> 时间：2012-11-21T22:23:43.137
> 
> 标签：scorm2004

我需要使用scorm 2004的选择控制模式，所以我做了这个非常基本的测试：

这是我的清单：

```
<?xml version="1.0" encoding="UTF-8"?>

<manifest xmlns="http://www.imsglobal.org/xsd/imscp_v1p1" xmlns:imsmd="http://ltsc.ieee.org/xsd/LOM" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:adlcp="http://www.adlnet.org/xsd/adlcp_v1p3" xmlns:imsss="http://www.imsglobal.org/xsd/imsss" xmlns:adlseq="http://www.adlnet.org/xsd/adlseq_v1p3" xmlns:adlnav="http://www.adlnet.org/xsd/adlnav_v1p3" identifier="MANIFEST-2F10A7A25FC691A6212BD9CB0B505D44" xsi:schemaLocation="http://www.imsglobal.org/xsd/imscp_v1p1 imscp_v1p1.xsd http://ltsc.ieee.org/xsd/LOM lom.xsd http://www.adlnet.org/xsd/adlcp_v1p3 adlcp_v1p3.xsd http://www.imsglobal.org/xsd/imsss imsss_v1p0.xsd http://www.adlnet.org/xsd/adlseq_v1p3 adlseq_v1p3.xsd http://www.adlnet.org/xsd/adlnav_v1p3 adlnav_v1p3.xsd http://www.imsglobal.org/xsd/imsss imsss_v1p0.xsd">
    <metadata>
        <schema>ADL SCORM</schema>
        <schemaversion>2004 3rd Edition</schemaversion>
    </metadata>
    <organizations default="ORG">
        <organization identifier="ORG" structure="hierarchical">
            <title>06 Navigation</title>
            <item identifier="page1" isvisible="true" identifierref="RES-page1">
                <title>page1</title>
                <item identifier="page2" isvisible="true" identifierref="RES-page2">
                    <title>page2</title>
                </item>
                <item identifier="page3" isvisible="true" identifierref="RES-page3">
                    <title>page3</title>
                </item>
                <imsss:sequencing>
                    <imsss:controlMode choice="true" choiceExit="false" flow="false" useCurrentAttemptObjectiveInfo="false" useCurrentAttemptProgressInfo="false"/>         
                </imsss:sequencing>
            </item>         
        </organization>
    </organizations>
    <resources>
        <resource identifier="RES-page1" adlcp:scormType="sco" type="webcontent" href="page1.html">
          <file href="page1.html" />
          <file href="js/jquery-1.8.3.min.js" />
          <file href="js/SCORM_API_wrapper.js" />
          <file href="js/lmsCommunication.js" />
        </resource>
        <resource identifier="RES-page2" adlcp:scormType="sco" type="webcontent" href="page2.html">
          <file href="page2.html" />
          <file href="js/jquery-1.8.3.min.js" />
          <file href="js/SCORM_API_wrapper.js" />
          <file href="js/lmsCommunication.js" />
        </resource>
        <resource identifier="RES-page3" adlcp:scormType="sco" type="webcontent" href="page3.html">
          <file href="page3.html" />
          <file href="js/jquery-1.8.3.min.js" />
          <file href="js/SCORM_API_wrapper.js" />
          <file href="js/lmsCommunication.js" />
        </resource>
    </resources>
</manifest> 
```

在第 1 页，我连接到 API 并成功获取用户名。

单击时，我尝试使用此 js 代码转到第 2 页：

```
var scorm = pipwerks.SCORM;

$( document ).ready( init );

function init()
{
    scorm.version = "2004";

    connect();

    var learnerName = getValue( "cmi.learner_name" );

    $( "#Name" ).html( "Bonjour " + learnerName + " !!!" );

    $( "#goto2" ).click( goto2 );

    $( window ).unload( disconnect );
}

function goto2()
{
    if( getValue( "adl.nav.request_valid.choice.{target=page2}" ) == "true" )
    {
        setValue( 'adl.nav.request', '{target=page2}choice' );
        disconnect();
    }

    /* if( getValue( "adl.nav.request_valid.continue" ) == "true" )
    {
        setValue( 'adl.nav.request', 'continue' );
        disconnect();
    } */
}

function connect()
{
    if( !scorm.connection.isActive )
    {
        var isSuccess = scorm.init();               
        var msg = "Connexion : " + ( ( isSuccess )? "succès" : "échec" );
        log( msg, isSuccess );
    }
}

function disconnect()
{
    if( scorm.connection.isActive )
    {
        var isSuccess = scorm.quit();               
        var msg = "Déconnexion : " + ( ( isSuccess )? "succès" : "échec" );
        log( msg, isSuccess );
    }
}

function save()
{
    if( scorm.connection.isActive )
    {
        var isSuccess = scorm.save();               
        var msg = "Sauvegarde : " + ( ( isSuccess )? "succès" : "échec" );
        log( msg, isSuccess );
    }
}

function getValue( parameter )
{
    var value = null;

    if( scorm.connection.isActive )
    {
        value = scorm.get( parameter );
        var msg = "Get " + parameter + " : " + ( ( value )? value : "échec" );
        var isSuccess = ( value )? true : false;
        log( msg, isSuccess );
    }

    return value;
}

function setValue( parameter, value )
{
    if( scorm.connection.isActive )
    {
        var isSuccess = scorm.set( parameter, value );
        var msg = "Set " + parameter + " = " + value + " : " + ( ( isSuccess )? "succès" : "échec" );
        log( msg, isSuccess );
    }
}

function log( msg, isSuccess )
{
    $( "#console" ).append( "<div style=\"color:" + ( ( isSuccess )? "blue" : "orangered" ) + ";\">" + msg + "</div>" );
} 
```

scorm.set( 'adl.nav.request', '{target=page2}choice' ) 不起作用，它返回一个空字符串。

为什么它不工作？也许是 js 中的错误或清单中的坏树？

我没有成功找到好的语法，我也不确定我探索了什么方式......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T09:48:34.337

以下行返回什么？

```
getValue("adl.nav.request_valid.choice.{target=page2}") 
```

# javascript - this._super() 函数的 Javascript 问题

> ID：13503058
> 
> 赞同：0
> 
> 时间：2012-11-21T22:24:26.333
> 
> 标签：javascript

我有以下 javascript

```
var helloworld == cc.layer.extend({
    ctor : function() { this._super(); }
    init : function() { this._super();  ........}
    onmix : function() { this._super(); this.layer.addChild(); }
}); 
```

我得到的错误是这`this._super()`在`onmix`功能上不知道，但其他地方`this._super()`都很好。如果我不放在`this._super()`里面，`onmix`那么它就不会知道`this.layer`对象。那么我该如何解决呢？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:36:29.650

```
var helloworld == <...> 
```

不是有效的 JS 语法。我认为您的意思只是'='。

# c# - C# 强制继承的类遍历列表

> ID：13503065
> 
> 赞同：0
> 
> 时间：2012-11-21T22:24:47.827
> 
> 标签：c#

例如，我有两个课程：

```
Class A
{
  string property1;
  string property2;
}

Class B : A
{
  string property3;
  string property4;
  ....
} 
```

所以 B 继承了类 A 的属性。他们坐在一个列表里，那是一本字典

```
Dictionary <string, List<A>> myDictionary = new Dictionary<string, List<A>>();

List<A> myList = new List<A>(); 
```

有一个字典，包含许多列表，都包含 A 类和 B 类对象的混合。循环时，我试图从 B 类对象中访问一些属性，我有一个 if 语句来查找它们，但程序仍然认为它们是 A 类类型，并在我尝试使用 property3 或 property4 时抛出错误。例如：

```
string key = string key in dictionary;
string index = object position in list;

myDictionary[key][index].property3.someMethod(); 
```

有没有办法告诉程序这是一个 B 类对象并允许使用属性 3 和 4？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T22:27:44.200

将对象安全地转换为 B 型对象，然后检查 null

```
var obj = myDictionary[key][index];

var bObj = obj as B;
if (bObj != null)
{
     bObj.someMethod();
} 
```

虽然，我也可能会说您的设计似乎已关闭。通常情况下，我不会期待这样的事情。通常，如果您使用继承，您会想要一个允许它们互换使用的设计。例如，您可能将 A 上的行为实现为无操作，但在 B 上覆盖它以实际执行某些操作。这将使消费类不必关心“A”事物是真正的 A 还是 B 实例。

# android - 具有延迟加载的 Android 图库

> ID：13503067
> 
> 赞同：0
> 
> 时间：2012-11-21T22:25:17.947
> 
> 标签：android

我有这个从 url 加载图像的画廊，我首先检索这样的 InputStream：

```
HttpParams httpparameters = new BasicHttpParams();
HttpConnectionParams.setConnectionTimeout(httpparameters, 3000);
HttpConnectionParams.setSoTimeout(httpparameters, 5000);

DefaultHttpClient httpClient = new DefaultHttpClient(httpparameters);
HttpGet request = new HttpGet(urlString);
HttpResponse response = httpClient.execute(request);
InputStream is = response.getEntity().getContent(); 
```

然后，我用 Bitmap bitmap = BitmapFactory.decodeStream(is, null, opts2); 读取流

这里的问题是有时我会出现内存不足错误。我通过修改 inSampleSize 进行了修复，但我认为这不是一个好的解决方法，因为图像质量不好。有没有办法加载图像列表而不会出现内存不足并且质量与服务器中的相同？例如，在facebook app中，当你进入图库时，它会做一个延迟加载，你可以在网格布局中看到，当你以全模式打开图片时，你可以滚动查看它是如何下载所有的图像，并且没有内存不足的问题，也没有在检索时出现延迟。

或者，如果您知道任何这样做的 android 库，所以我不需要重新发明轮子

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:23:46.560

在 Google IO 2012 上有一个关于 IO Gallery 应用程序的精彩演讲，您可以在 YouTube 上轻松找到您可以轻松下载的源代码，您可以从以下网址获得所有答案：[http ://code.google.com/p/画廊/](http://code.google.com/p/iogallery/)

# php - Mysqli 自动增量支持

> ID：13503072
> 
> 赞同：0
> 
> 时间：2012-11-21T22:25:49.220
> 
> 标签：php, database, phpmyadmin

在我的网站上，当新用户注册时，会为他们分配一个 ID，此 ID 是我的 PHPMYADMIN 数据库中的主键。

每添加一个新用户，它就会自动递增一。

现在我想知道的是如何在不必杀死桌子并将其带回来的情况下将其重置。

谢谢你的支持。

编辑：

目前我正在开发一个脚本，所以我正在测试我的注册页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:32:16.340

如果你真的必须：

```
ALTER TABLE `TABLE_NAME` AUTO_INCREMENT =VALUE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:28:45.703

在 phpmyadmin 中，您有表选项“操作”或“操作”。这就是您可以将 auto_increment 值重置为 0 的地方

# haskell - Haskell 将“case of”语句转换为尾递归代码

> ID：13503077
> 
> 赞同：-5
> 
> 时间：2012-11-21T22:26:10.493
> 
> 标签：haskell, recursion, tail

我需要帮助。我有那种形式的功能

```
myFunction = case myFunction of
    (Nothing) -> (Just)
    (Just) -> (Just) 
```

我想让它尾递归。一个人会怎么做？我知道根据递归调用的返回我们有不同的语句这一事实使它变得困难（我需要帮助的原因^^）。我可以提供原始功能，但我宁愿寻找更通用的解决方案。提前致谢

**编辑：**实际代码：

```
myFunction :: MyTree x -> (x, Maybe(MyTree x))
myFunction = (x, Nothing)
myFunction (MyNode left right) = case myFunction left of
                                      (x, Nothing)    -> (x, Just right)
                                      (x, Just left2) -> (x, Just (Node left2 right)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T02:42:32.003

我假设你定义了

```
data MyTree x = MyLeaf x | MyNode (MyTree x) (MyTree x) 
```

并且意味着

```
myFunction :: MyTree x -> (x, Maybe(MyTree x))
myFunction (MyLeaf x) = (x, Nothing)
myFunction (MyNode left right) = case myFunction left of
                                      (x, Nothing)    -> (x, Just right)
                                      (x, Just left2) -> (x, Just (MyNode left2 right)) 
```

这是一个拉出最左边的叶子并将相应的右分支缝合到它所在位置的函数。

你问如何使这个尾递归。这是为什么？在某些（严格的）语言中，尾递归代码效率更高，但 Haskell 使用惰性求值，这意味着递归调用发生的时间有多晚并不重要，而是它们产生输出的时间有多早。在这种情况下，头部递归`case myFunction left of`会沿着树向下缩放，直到找到最左边的叶子，您无法更快地找到它。然而，在返回的路上，它确实`x`绕过了一点而不是立即返回，但它还在适当的地方缝合了所有正确的分支，没有任何簿记，这是在递归数据结构上使用递归的乐趣.

请参阅[这个问题](https://stackoverflow.com/questions/13042353/does-haskell-have-tail-recursive-optimization)，了解为什么尾递归对于 Haskell 中的效率而言不是最重要的事情。

对节点处有数据的二叉树要做的三件事是： 1\. 前序遍历（先访问当前节点，然后访问左子树，然后访问右子树）- 双尾递归 2\. 中序遍历（访问左子树，然后是当前节点，然后是右） - 头尾递归 3\. 后序遍历（访问当前节点之前的左右子树） - 双头递归。

对于不习惯懒惰评估的人来说，发布顺序听起来令人担忧，但它是一种对树中的值求和的有效方法，例如，特别是如果您确保编译器知道它是严格的。

与往常一样，最好的算法给出最快的结果，如果你想打开优化，你应该用 -O2 编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:28:28.297

这些必须匹配。

```
myFunction = ...
myFunction (MyNode left right) = ... 
```

他们不匹配。你不能一起使用它们。为什么？其中一个接受零参数，另一个接受一个参数。它们必须采用相同数量的参数。如果您需要忽略参数，请使用`_`. 请注意，使用`_`的版本必须在不使用的版本之后`_`。

```
myFunction :: MyTree x -> Maybe (MyTree x)
myFunction (MyNode left right) =
  case myFunction left of
    Nothing -> Just right
    Just left2 -> Just (MyNode left2 right)
myFunction _ = Nothing 
```

我不知道`x`你的函数体应该是什么。它不受任何东西的约束。

这不是尾递归。并不是所有的函数都可以做成尾递归函数。

## 暗示

也许如果您描述了该功能应该做什么，我们可以帮助您做到这一点。

# php - PHPunit 测试不模拟依赖项

> ID：13503078
> 
> 赞同：3
> 
> 时间：2012-11-21T22:26:19.650
> 
> 标签：php, phpunit

我正在尝试使用 PHPunit 来模拟一些依赖项，但我的模拟对象似乎没有工作。

记录器.php

```
class Logger
{
    function __construct($log_path)
    {
        // make sure file exists, open file handle
    }
    function write($msg)
    {
        // write message to log 
    }
} 
```

MyCurl.php

```
class MyCurl
{
    function __construct($url)
    {
        // set my default curl options
    }
    function exec()
    {
        // execute curl request and capture output
    }
} 
```

函数_x.php

```
require_once("Logger.php");
require_once("MyCurl.php");
function function_x($params)
{
    // set some stuff up;
    $LoggerObj = new Logger($filepath);
    $CurlObj   = new MyCurl($url);
    // more stuff
    $LoggerObj->write($CurlObj->exec());
    // do stuff
    return $result;
} 
```

function_x_Test.php

```
require_once('function_x.php');
class functionXTest extends PHPUnit_Framework_TestCase
{
     public function testCleanRun()
     {

         $MockLogger = $this->getMockBuilder('Logger')->disableOriginalConstructor()->setMethods(array('write', '__destruct'))->getMock();
         $MockLogger->expects($this->any())->method('write')->will($this->returnValue(true));

         $MockCurl   = $this->getMockBuilder('MyCurl')->disableOriginalConstructor()->setMethods(array('exec', '__destruct'))->getMock();
         $MockCurl->expects($this->any())->method('exec')->will($this->returnValue('exec returnz'));

         $result = function_x($params);
         // start assertions with function_x results
    }
} 
```

当我运行测试时，它表明正在为我的 Logger 类调用原始构造函数。它似乎没有使用模拟类。我假设如果我在测试中声明模拟，那么对原始类的所有调用都会被模拟，从而消除这些依赖关系。显然，我做错了什么。任何人都可以向我伸出援助之手或为我指明正确的方向吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:01:04.087

模拟是替换一个对象（参见[文档](http://www.phpunit.de/manual/current/en/test-doubles.html#test-doubles.mock-objects)），而不是一个类。

因此，要让您的示例使用模拟，您应该注入对象（[依赖注入](https://stackoverflow.com/questions/130794/what-is-dependency-injection)）：

```
function function_x($params, $logger = null, $curl = null)
{
  //Here, you can set logger and curl if they are null.
  // only do this to make sure legacy code works.
  if(!$logger) {
    $logger = new Logger();
  }
  if(!$curl) {
    $curl = new MYCurl();
  }

  //rest of your code
} 
```

在你的测试中，你打电话

```
require_once('function_x.php');
class functionXTest extends PHPUnit_Framework_TestCase
{
  public function testCleanRun()
  {

    $MockLogger = $this->getMockBuilder('Logger')->disableOriginalConstructor()->setMethods(array('write', '__destruct'))->getMock();
    $MockLogger->expects($this->any())->method('write')->will($this->returnValue(true));

    $MockCurl   = $this->getMockBuilder('MyCurl')->disableOriginalConstructor()->setMethods(array('exec', '__destruct'))->getMock();
    $MockCurl->expects($this->any())->method('exec')->will($this->returnValue('exec returnz'));

    $result = function_x($params, $MockLogger, $MockCurl);
     // start assertions with function_x results
  }
} 
```

# python - 如何创建python函数的副本

> ID：13503079
> 
> 赞同：31
> 
> 时间：2012-11-21T22:26:19.903
> 
> 标签：python, deep-copy

是否有可能创建 python 函数的真实副本？最明显的选择是[http://docs.python.org/2/library/copy.html](http://docs.python.org/2/library/copy.html)但我在那里读到：

> 它通过返回原始对象不变来“复制”函数和类（浅层和深层）；

我需要一个真实的副本，因为我可能会更改函数的某些属性。

**更新：**

我知道评论中提到的所有可能性。我的用例基于元编程，我根据一些声明性规范构造类。完整的细节对于 SO 来说太长了，但基本上我有一个类似的功能

```
def do_something_usefull(self,arg):
    self.do_work() 
```

我会将这个方法添加到各种类中。这些类可以完全不相关。使用 mixin 类不是一种选择：我将拥有许多这样的函数，并且最终会为每个函数添加一个基类。我目前的“解决方法”是将这个函数包装在这样的“工厂”中：

```
def create_do_something():
    def do_something_usefull(self,arg):
        self.do_work() 
```

这样我总是得到一个新的 do_something_useful 函数，但我必须像这样包装我的所有函数。

你可以相信我，我知道，这不是“正常的”面向对象编程。我知道如何“正常”地解决这样的问题。但这是一个动态代码生成器，我希望一切都尽可能轻量和简单。而且由于python函数是很普通的对象，所以问如何复制它们我不觉得太奇怪！？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-11-21T22:43:29.007

在**Python3 中**：

```
import types
import functools

def copy_func(f):
    """Based on http://stackoverflow.com/a/6528148/190597 (Glenn Maynard)"""
    g = types.FunctionType(f.__code__, f.__globals__, name=f.__name__,
                           argdefs=f.__defaults__,
                           closure=f.__closure__)
    g = functools.update_wrapper(g, f)
    g.__kwdefaults__ = f.__kwdefaults__
    return g

def f(arg1, arg2, arg3, kwarg1="FOO", *args, kwarg2="BAR", kwarg3="BAZ"):
    return (arg1, arg2, arg3, args, kwarg1, kwarg2, kwarg3)
f.cache = [1,2,3]
g = copy_func(f)

print(f(1,2,3,4,5))
print(g(1,2,3,4,5))
print(g.cache)
assert f is not g 
```

产量

```
(1, 2, 3, (5,), 4, 'BAR', 'BAZ')
(1, 2, 3, (5,), 4, 'BAR', 'BAZ')
[1, 2, 3] 
```

* * *

在**Python2 中**：

```
import types
import functools
def copy_func(f):
    """Based on http://stackoverflow.com/a/6528148/190597 (Glenn Maynard)"""
    g = types.FunctionType(f.func_code, f.func_globals, name=f.func_name,
                           argdefs=f.func_defaults,
                           closure=f.func_closure)
    g = functools.update_wrapper(g, f)
    return g

def f(x, y=2):
    return x,y
f.cache = [1,2,3]
g = copy_func(f)

print(f(1))
print(g(1))
print(g.cache)
assert f is not g 
```

产量

```
(1, 2)
(1, 2)
[1, 2, 3] 
```

# css - 防止css继承

> ID：13503080
> 
> 赞同：-1
> 
> 时间：2012-11-21T22:26:42.197
> 
> 标签：css

我正在创建一个横幅，其中有一个表格可以在各种不同的网站上使用。但是，当它进入其他网站时，它会继承第一个网站的样式。所以有时候看起来很乱。有没有办法让css不会继承？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:29:47.673

使用 iframe 将其插入网站。除此之外，它可能很艰难。您可以尝试使用非常具体的选择器显式设置每种样式。那么就很难覆盖它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:36:37.440

您可能必须为表单重置父容器中的所有样式，然后将表单放入该容器中。

还要为您的类使用唯一的名称，例如`.myform-banner-mysitename`或其他东西。即便如此，听起来你正在设计通往痛苦世界的道路。

# sql-server - SQL Server 双向事务复制 - 这是一个很好的用例吗？

> ID：13503081
> 
> 赞同：4
> 
> 时间：2012-11-21T22:26:48.733
> 
> 标签：sql-server, sql-server-2008, replication, database-replication, transactional-replication

我们在使用 SQL Server 进行横向扩展时遇到问题。这主要是因为几个原因：1）数据结构设计不佳，2）繁重的工作和业务/处理逻辑都是在 T-SQL 中完成的。我们聘请了一位来自 Redmond 的 Microsoft SQL 人员验证了这一点，该人员在我们的服务器上执行分析。我们实际上是通过不断增加命令超时来解决问题，这很荒谬，而且不是一个好的长期解决方案。从那以后，我们制定了以下策略和一系列阶段：

### 第 1 阶段：将硬件/软件放在问题上以止血。

这包括一些不同的东西，比如缓存服务器，但我想在这里问每个人的具体内容与在新 SQL 服务器上实现双向事务复制有关。我们有两个想要实现它的用例：

1.  我们正在考虑在这个新的 SQL“处理框”上运行长时间运行（和表/行锁定）的 SELECT，并将它们放入缓存层并让 UI 从缓存中读取它们。这些 SELECT 生成报告并在网络上返回结果。

2.  大多数业务逻辑都在 SQL 中。我们对执行处理逻辑的 SELECT、INSERT、UPDATE 和 DELETE有一些*长时间运行的查询。*最终结果实际上只是处理完成后的一堆 INSERT、UPDATE 和 DELETE（大量游标）。想法是平衡这两个服务器之间的负载。

我有一些疑问：

1.  这些是双向事务复制的好用例吗？

2.  我需要确保这个解决方案能够“正常工作”，而不必担心冲突。在这个解决方案中哪里会出现冲突？我已经阅读了一些关于重置身份种子的增量以防止冲突的文章，这是有道理的，但是它如何处理更新/删除或其他可能发生冲突的地方？

3.  我可能会遇到哪些其他问题，我们需要注意什么？

4.  这个问题有更好的解决方案吗？

### 第 2 阶段：将逻辑重写到 .NET 中，并优化 SQL 存储过程以仅执行基于集合的操作，因为它也应该如此。

这显然需要一段时间，这就是为什么我们想看看是否可以采取一些初步措施来阻止用户所经历的痛苦。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T23:09:36.847

恕我直言，双向复制与“它会起作用”相去甚远。防止更新冲突需要精心规划，确保所有“处理”都经过精心安排，绝不会处理重叠数据。主-主复制是最难实现的解决方案之一。

考虑一下：您设想一种解决方案，它提供廉价的 2 倍横向扩展，几乎不需要修改代码。这样的解决方案将非常有用，人们会期望看到它*无处不在*。却无处可寻。

我建议您搜索许多描述关于（更流行的）MySQL 主-主部署的陷阱和警告的博客和文章（例如，[如果您*必须*部署多主复制，请先阅读此](http://scale-out-blog.blogspot.com/2012/04/if-you-must-deploy-multi-master.html)内容），自己判断问题是否存在值得。

我没有你做的所有细节，但我会专注于应用程序。如果您只想在短期内解决问题，我会确保在考虑横向扩展（SSD / Fusion驱动器，更多RAM）之前用尽廉价的纵向扩展。如果锁定是主要问题，还要首先调查快照隔离级别/读取提交的快照。

# windows-8 - Application.UnhandledException 和原始异常消息

> ID：13503084
> 
> 赞同：0
> 
> 时间：2012-11-21T22:27:03.777
> 
> 标签：windows-8, microsoft-metro

我正在尝试访问导致 UnhandledException 的原始异常，但我看到的只是 UnhandledExceptionEventArgs.Message 属性中包含的文本；

例如：

*   我有带有点击处理程序的按钮视图：

> ```
>  private void Button_Click_1(object sender, RoutedEventArgs e)
>  {
>      throw new NullReferenceException("Test exc");
>  } 
> ```

*   在 App 构造函数中，我订阅了 UnhandledException 异常

> ```
>  this.UnhandledException += App_UnhandledException;
> 
>  private void App_UnhandledException(object sender, UnhandledExceptionEventArgs e)
>  {
>      Debug.WriteLine(e.Message);
>      Debug.WriteLine(e.Exception.ToString()); 
>  } 
> ```

*   结果，我没有选择获取原始异常文本“Test exc”。我只有

> Message = System.NullReferenceException at W8.Controls.SearchControl.Button_Click_1（对象发送者，RoutedEventArgs e）
> 
> 异常 = System.NullReferenceException：对象引用未设置为对象的实例。

提前感谢您的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:17:23.037

传播到 UnhandledException 的内容有一些限制。[据记载](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.application.unhandledexception.aspx)：

> 另一个限制是 UnhandledException 事件参数不包含与原始异常一样多的详细信息。只要有可能，如果应用程序需要对某个异常进行特定处理，最好在异常传播时捕获它，因为可以获得更多详细信息。UnhandledException 事件参数通过 Exception 属性公开一个异常对象。但是，不能保证此异常对象的类型、消息和堆栈跟踪与引发的原始异常相匹配。事件参数还公开了 Message 属性。在大多数情况下，这将包含最初引发的异常的消息。

# javascript - 为什么这个三元运算符在 JS 中无效

> ID：13503086
> 
> 赞同：6
> 
> 时间：2012-11-21T22:27:17.867
> 
> 标签：javascript

```
​var truth = true;
(truth) ? console.log('It is true') : throw new Error('It is not true');​​​​​​​​​​​​​​​ 
```

三元运算符是否只接受特定类型的对象？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-21T22:29:26.223

javascript区分语句和表达式。三元运算符只处理表达式；throw 是一个声明。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T22:43:20.210

它确实有效，但问题是你的“else”分支中的 throw 语句。

采用

```
(truth) ? console.log('It is true') : (function(){throw 'It is not true'}()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T22:29:44.010

与所有其他运算符一样，条件运算符只能与表达式一起使用。

`throw x;`是一个*语句*，而不是一个表达式。

# ruby-on-rails - 回形针宝石文件大小列不正确

> ID：13503092
> 
> 赞同：1
> 
> 时间：2012-11-21T22:27:52.803
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip

我正在使用回形针 gem 来存储文件（照片、视频、音频等）。大多数文件上传的文件大小设置为零。几个 jpeg 上传具有正确的文件大小。有人见过这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-01T14:25:51.917

这是一个老问题，但我认为这与保存文件时发生的事情有关。Paperclip 在后台运行 imagemagik 以创建缩略图等，我认为这也是它获取文件大小的时候。

不确定，但怀疑您已经设置了选项，因此它不需要创建它们，因此它永远不会调用获取大小等的实用程序并将这些值拉回数据库。

# objective-c - iOS AVFoundation 将视频流式传输到 OpenGL 纹理

> ID：13503096
> 
> 赞同：2
> 
> 时间：2012-11-21T22:28:04.043
> 
> 标签：objective-c, ios, opengl-es, streaming, avfoundation

根据：

[我可以使用 AVFoundation 将下载的视频帧流式传输到 OpenGL ES 纹理中吗？](https://stackoverflow.com/questions/12500408/can-i-use-avfoundation-to-stream-downloaded-video-frames-into-an-opengl-es-textu)

可以从远程媒体获取帧。但是我一直在尝试这个建议，但是关于使用的文档`AVPlayerItemVideoOutput`不是很清楚，它似乎有一个委托方法`outputMediaDataWillChange`，它有指向`AVPlayerItemVideoOutput`实例的指针。

也许我做错了假设，但是每次数据发生变化时都会调用这个委托方法？这是获得`CVPixelBuffer`？的正确位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T09:28:38.403

可能不是。您将需要在与您的 GL 执行所有工作或其他具有共享上下文的线程相同的线程上更新纹理，而不是在您获得媒体数据已更新的委托回调的线程上。您可以在此回调中将一些布尔值设置为 true 以通知 GL 线程缓冲区已准备好并且应该收集它。或者，您可以推送一些“目标选择器对”以在 GL 线程上执行以收集数据（系统如“performSelectorOnMainThread”），但是您应该再次询问自己，如果媒体更新是这样的对已经存在于堆栈中更快地更改数据然后您的 GL 正在刷新...无论如何，如果您使用该委托并且没有正确处理它，它根本不会更新纹理，或者它会阻塞您的 GL 线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T09:44:59.967

方法`outputMediaDataWillChange`只会在注册后被调用`requestNotificationOfMediaDataChangeWithAdvanceInterval`，通常是当你暂停你的应用程序等时。

您可以在显示链接挂钩中访问像素缓冲区。在 Apple 示例中查找`hasNewPixelBufferForItemTime`和`copyPixelBufferForItemTime`（它适用于 OS X，但基本上适用于 iOS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T22:16:35.880

我认为，您应该使用 ffmpeg 库，因为该库可以连接任何流媒体服务器并获取原始数据中的图片。之后，您可以对那张照片做任何事情。

# android - Android HTTP 请求有时无响应，直到在电脑上打开页面

> ID：13503099
> 
> 赞同：1
> 
> 时间：2012-11-21T22:28:29.360
> 
> 标签：android

我在从 Android 中的 PHP 脚本获取数据时遇到了一个非常奇怪的问题。下面的示例接缝是每个人都建议用来获取数据的方法。它工作..一段时间。如果你运行它几次，它会得到完美的分数。但是，如果您等待一两个小时然后再试一次，它将一遍又一遍地失败。但实际上没有什么“失败”，我确实有适当的尝试解决这个问题，它在异步任务中运行，它只是在字符串中不返回任何内容。这将发生一百次，直到我在我的电脑上打开脚本。然后脚本向我显示数据，下次我在手机上打开时，它就可以工作了。直到几个小时后……

上周我浏览了互联网，尝试了从页面获取数据的不同示例，它们都做同样的事情。我虽然可能是我们所在的网络服务器，所以我换了一个新的，同样的问题。

如果您需要更多详细信息，请告诉我。如果您认为这会有所帮助，我可以给您 PHP 脚本。虽然它发生在我拥有的 5 个不同的脚本中。

```
 DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        InputStream is = httpEntity.getContent();

        BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        json = sb.toString();
        Log(json); 
```

# objective-c - 带有 ARC 的 Interface Builder 中的单例

> ID：13503103
> 
> 赞同：6
> 
> 时间：2012-11-21T22:28:48.813
> 
> 标签：objective-c, macos, interface-builder, singleton, automatic-ref-counting

我的问题与这个问题非常相似：[Use Singleton In Interface Builder?](https://stackoverflow.com/questions/4609609/use-singleton-in-interface-builder)

唯一的区别是我使用 ARC。因此，如果简化，我的单身人士看起来像这样：

*经理.m*

```
@implementation Manager

+ (instancetype)sharedManager {
    __strong static id sharedInstance = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        sharedInstance = [[self alloc] init];
    });
    return sharedInstance;
}

@end 
```

所以问题是是否有可能在仍然使用 ARC 的 Interface Builder 中采用它？

当然，我知道在没有 ARC 的情况下重写该类可能更简单，所以这个问题相当学术。:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T23:02:21.423

当 nib 未归档时，它将尝试`alloc`/`init`或`alloc`/`initWithCoder:`类的新实例。

因此，您可以做的是拦截该调用并重新路由它以返回您的单例：

```
+ (id)sharedInstance {
  static Singleton *sharedInstance = nil;
  static dispatch_once_t onceToken;
  dispatch_once(&onceToken, ^{
    sharedInstance = [[self actualAlloc] actualInit];
  });
  return sharedInstance;
}

+ (id)actualAlloc {
  return [super alloc];
}

+ (id)alloc {
  return [Singleton sharedInstance];
}

- (id)actualInit {
  self = [super init];
  if (self) {
    // singleton setup...
  }
  return self;
}

- (id)init {
  return self;
}

- (id)initWithCoder:(NSCoder *)decoder {
  return self;
} 
```

这允许`-init`并且`-initWithCoder:`可以安全地在同一个对象上多次调用。通常不建议允许这样做，但鉴于单身人士已经是“事情可能变得非常不稳定的地方”的情况，这并不是你能做的最糟糕的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T19:21:56.737

为了完整起见，这是一个可以从 Interface Builder 中使用的 Singleton 实现。区别在于`actualAlloc`方法。正如`[super alloc]`仍然会调用`[self allocWithZone:]`的那样——它不会分配对象。

*单例.h*

```
@interface Singleton : NSObject

+ (instancetype)sharedInstance;

@end 
```

*单身人士.m*

```
@implementation Singleton

+ (instancetype)sharedInstance {
    __strong static id _sharedInstance = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        _sharedInstance = [[self _alloc] _init];
    });
    return _sharedInstance;
}

+ (id)allocWithZone:(NSZone *)zone {
    return [self sharedInstance];
}

+ (id)alloc {
    return [self sharedInstance];
}

- (id)init {
    return self;
}

+ (id)_alloc {
    return [super allocWithZone:NULL]; //this is important, because otherwise the object wouldn't be allocated
}

- (id)_init {
    return [super init];
}

@end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-11T05:32:54.323

@Eugene，来自 iOS 文档集，“出于历史原因，`alloc`调用`allocWithZone:`.”，因此，无需重新实现该`alloc`方法。

# oracle - 乐透彩票如何计算每一行的中奖次数？

> ID：13503119
> 
> 赞同：2
> 
> 时间：2012-11-21T22:29:47.223
> 
> 标签：oracle

我有一个带有 plyyers 的表 zadanie1，每个都有 6 个随机数。

```
create table zadanie1(
  nazwisko varchar2(30),
  liczba1 number,
  liczba2 number,
  liczba3 number,
  liczba4 number,
  liczba5 number,
  liczba6 number,
  constraint stud2_nazw primary key (nazwisko)
  );

   Create or replace procedure "TOTOLOTEK3" is liczba number;
   cursor pierwszy_kursor is select num from (select num from (select rownum num from dual              connect by level <= 49 order by dbms_random.value) where rownum <= 6);
    begin
    for iter in 1..5
    loop
    open pierwszy_kursor;
    for iterator in 1..6
    loop
    fetch pierwszy_kursor into liczba;
    if iterator=1
    then update zadanie2 set liczba1=liczba where Id = iter;
    end if;
    if iterator=2
    then update zadanie2 set liczba2=liczba where Id = iter;
    end if;
    if iterator=3
    then update zadanie2 set liczba3=liczba where Id = iter;
    end if;
    if iterator=4
    then update zadanie2 set liczba4=liczba where Id = iter;
    end if;
    if iterator=5
    then update zadanie2 set liczba5=liczba where Id = iter;
    end if;
    if iterator=6
    then update zadanie2 set liczba6=liczba where Id = iter;
    end if;
    dbms_output.put_line( liczba||' liczba ');
    exit when pierwszy_kursor%notfound;
     end loop;
    close pierwszy_kursor;
    end loop;
    end; 
```

我在考虑分析功能，但我不知道在这种情况下如何使用。

当我有一张行优惠券时，我需要计算每个玩家的获胜次数吗？帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T14:01:14.820

我喜欢你的随机生成器查询，很聪明！

您需要将行转换为列。这可以通过`PIVOT`或来完成`MIN(DECODE)`。一旦将它放在一行中，您就不需要游标，并且可以将该行直接插入到目标表中：

```
create or replace procedure totolotek3 as    
begin
  for iter in 1..5 loop
    insert into zadanie2(liczba1,liczba2,liczba3,liczba4,liczba5,liczba6)
    select min(decode(rownum,1,num)) as num1,
           min(decode(rownum,2,num)) as num2,
           min(decode(rownum,3,num)) as num3,
           min(decode(rownum,4,num)) as num4,
           min(decode(rownum,5,num)) as num5,
           min(decode(rownum,6,num)) as num6
      from (select rownum num 
              from dual connect by level <= 49 
             order by dbms_random.value) 
     where rownum <= 6; 
  end loop;
end totolotek3;
/ 
```

如果表 zadanie2 也有主键，那么您当然也需要填写该列。

# c++ - SQLite 如何在列上使用 LIKE 并添加通配符

> ID：13503125
> 
> 赞同：1
> 
> 时间：2012-11-21T22:30:06.783
> 
> 标签：c++, visual-c++, sqlite

我正在尝试比较 SQLite 中 2 个表中的 2 个相似列。我写了这个不会抛出错误但也不会返回任何东西，我知道它应该。

```
SELECT t1.* from t1, t2 Where t1.col1 Like '%'||t2.col1||'%'; 
```

我正在寻找何时`t2.col1`嵌入`t1.col1`. 两列都是 TEXT 类型。

注意：我在 Visual Studio 2010 中使用 C++ 中的 C 接口。

想法？

编辑：

我一直在尝试从`t2.col1`匹配的东西中提取一个值`t1.col1`并写出这样的东西，

```
SELECT t1.* from t1, t2 Where t1.col1 Like '%ValueInT1%'; 
```

它可以工作并返回一些东西。

在语句中连接 '%' 字符时，SQLite 是否存在错误，`like`或者我应该使用不同的语法？我不知道为什么这不起作用。

我还看到了一个名为的 SQL 函数`Locate`，人们在不同的数据库中使用它来进行这种检查。SQLite 有定位功能吗？

编辑2：

我已经用我的一些数据在 SQLite Administrator 中运行了第一条 SQL 语句，它确实找到了它。会不会有更简单的问题？数据中有“_”会导致类似问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:16:54.070

(VV) 答案是我加入了真实表中的错误列。2 列的名称非常相似，我检查的是错误的。

谢谢您的帮助。

# c# - C#：替换列表视图中空白项的文本？

> ID：13503128
> 
> 赞同：1
> 
> 时间：2012-11-21T22:30:34.463
> 
> 标签：c#, windows, forms, listview

我将如何用“否”一词替换列表视图第 5 列中的空白项文本？

我试过这个，但它抛出了一个`InvalidArgument=Value of '4' is not valid for 'index'.`错误：

```
 foreach (ListViewItem i in listView1.Items)
 {
     if (i.SubItems[4].Text == " ")
     {
         i.SubItems[4].Text = i.SubItems[4].Text.Replace(" ", "No");
     }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:37:33.007

如果我是你，我会[使用调试器](http://www.dotnetperls.com/debugging)来弄清楚实际发生了什么。

您可以检查并查看 中的实际内容`i.SubItems`，并确保它确实是您认为的内容。

我能想到的唯一可能的事情是您在某处打错了字，或者`i.SubItems[4]`实际上是无效的。

也许您正在遍历您的一些列表项，但并非所有列表项都有 5 列，或者有些是空的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:43:05.210

上面提供的代码将获取其中的所有项目`ListView1.Items`并检查索引的子项目`4`及其属性`Text`是否相等，如果索引超出数组限制，则可能导致描述的错误。您可以通过确保该项目不是 来避免这种情况`Nothing`。

**例子**

```
foreach (ListViewItem i in listView1.Items) //Get all items in listView1.Items
{
   if (i.SubItems.Count > 3) //Continue if i.SubItems.Count is more than 3 (The array contains i.SubItems[3] which refers to an item within the 4th column (i.SubItems.Count is not an array. Therefore, it'll start with 1 instead of 0))
   {
       if (i.SubItems[3].Text == " ") //Continue if i.SubItems[3].Text is equal to  
       {
            i.SubItems[3].Text = i.SubItems[3].Text.Replace(" ", "No"); //Replace   with No
       }
   }
} 
```

**注意**：数组是零索引的，这意味着它们以 0 而不是 1 开头。
**注意**：如果您只有 4 列，`i.SubItems.Count`则为 4 而不是 3，因为`int` **考虑到所有列都已填充，**这是正常现象。

谢谢，
我希望你觉得这有帮助:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T22:43:27.677

一旦你弄清楚了第一个错误，你替换文本的逻辑可能会像这样更好地工作：

```
if (i.SubItems != null && string.IsNullOrEmpty(i.SubItems[4].Text))
{
    i.SubItems[4].Text = "No";
} 
```

# java - 在 Java EE 应用程序中使用 groovy？

> ID：13503129
> 
> 赞同：3
> 
> 时间：2012-11-21T22:30:43.647
> 
> 标签：java, jsf, jakarta-ee, groovy

有人在 Java EE Web 应用程序中使用过 Groovy 吗？是否值得深入研究，在使用 Java EE、JSF、Facelets 等时我会从中受益吗？

我特别寻找的是诸如 Groovy 自动生成 getter/setter 之类的东西，或者不必总是使用`object.getProperty`而只需编写诸如此类`object.list.property.prop`的管道。

这值得么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:45:12.150

如果您对用于 Web 应用程序的 Groovy 感兴趣，您可以尝试[Grails 。](http://grails.org/)这基本上是 Spring MVC/Hibernate/Sitemesh 框架之上的 Groovy。

使用更高效的语法、基于约定的设置、脚手架，开发可以更快，并且有很多插件可以添加功能。但是，在一个复杂的应用程序中，维护可能是一项挑战，当所有隐藏实现的魔法出现问题时，调试可能会很痛苦。

# c - 获取 sscanf 读取的字符数？

> ID：13503135
> 
> 赞同：33
> 
> 时间：2012-11-21T22:31:23.950
> 
> 标签：c, string-parsing, scanf

我正在解析一个字符串 (a `char*`)，并且我正在使用`sscanf`将字符串中的数字解析为双精度数，如下所示：

```
// char* expression;
double value = 0;
sscanf(expression, "%lf", &value); 
```

这很好用，但我想继续通过传统方式解析字符串。我需要知道已经解析了多少个字符，`sscanf`以便我可以从新的偏移量恢复手动解析。

显然，最简单的方法是以某种方式计算`sscanf`解析的字符数，但如果没有简单的方法可以做到这一点，我*愿意*接受替代的双重解析选项。但是，我目前正在使用`sscanf`它，因为它快速、简单且易读。无论哪种方式，我只需要一种方法来评估双精度并在它之后继续解析。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-11-21T22:32:57.307

您可以使用格式说明符`%n`并`int *`为`sscanf()`:

```
int pos;
sscanf(expression, "%lf%n", &value, &pos); 
```

`n`C99 标准中的格式说明符说明：

> 不消耗任何输入。**相应的参数应该是一个指向有符号整数的指针，通过这个函数****调用从输入流中读取的字符数将写入该整数`fscanf`**。指令的执行`%n`不会增加`fscanf`函数执行完成时返回的赋值计数。没有参数被转换，但有一个被消耗。如果转换规范包括分配抑制字符或字段宽度，则行为未定义。

始终检查 的返回值`sscanf()`以确保进行了赋值，并且后续代码不会错误地处理值未更改的变量：

```
/* Number of assignments made is returned,
   which in this case must be 1\. */
if (1 == sscanf(expression, "%lf%n", &value, &pos))
{
    /* Use 'value' and 'pos'. */
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T22:35:20.837

```
int i, j, k;
char s[20];

if (sscanf(somevar, "%d %19s %d%n", &i, s, &j, &k) != 3)
    ...something went wrong... 
```

该变量包含字符计数，直到扫描`k`存储在其中的整数的末尾为止。`j`

请注意，`%n`不计入成功的转换。如果需要，您可以`%n`在格式字符串中多次使用。

# memory - Play Framework 2 缓存出现 OOM 错误

> ID：13503136
> 
> 赞同：1
> 
> 时间：2012-11-21T22:31:30.710
> 
> 标签：memory, playframework-2.0, ehcache

我将 Play Framework 2 用于各种搜索引擎以及它附带的默认缓存。我缓存每个查询的结果。令人惊讶的是，我遇到了内存不足错误。我没有指定驱逐时间，但我的印象是 EhCache 将使用默认策略（[Play 2.0 ehcache.xml](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/resources/ehcache.xml)）驱逐条目。不是这样吗？我可以`ehcache.xml`通过指定自己的来覆盖 Play`conf/ehcache.xml`吗？我需要什么不同的配置？

更新：OOM 错误可能是由另一个组件引起的，经过更多挖掘。但问题仍然存在：当内存紧张时，Play 的 EHCache 会驱逐吗？启用缓存确实会导致我更快地出现 OOM 错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T18:01:36.470

根据您链接到的 ehcache.xml，当条目计数达到堆中的 10k 个条目时，ehcache 将逐出。现在您还使用了 diskStore，上限为 10M 条目。但是磁盘存储仍然需要所有密钥才能放入内存......这可能是您面临的问题。

另外，请注意 TTI/TTL 将被内联处理。也就是说，数据在访问时会检查新鲜度。Ehcache 不会产生一个线程，该线程将主动地从缓存中过期并过期元素。

希望这可以帮助...

# mysql - 如何在嵌套集合模型中搜索祖先？

> ID：13503146
> 
> 赞同：1
> 
> 时间：2012-11-21T22:32:14.060
> 
> 标签：mysql, sql, ruby-on-rails, search, nested-sets

我正在使用 Ruby on Rails v3.2.2、MySQL 数据库和[AwesomeNestedSet](https://github.com/collectiveidea/awesome_nested_set) gem 来处理地方（地址、城市、国家等）的[嵌套集合模型数据结构。](http://en.wikipedia.org/wiki/Nested_set_model)相关`places`数据库表中的列是`name`、`parent_id`和。`lft``rgt`

我想实现一种方法，以便按名称和相关祖先名称查找记录。也就是说，例如，当我搜索 " `Spacca Napoli Street, Naples`" （*注意*：字符串中的逗号`,`用作常量分隔符）时，我想返回具有 name`Spacca Napoli Street`的祖先（在我的例子中是一个城市）的地址`Naples`。

是否有可能（也许，通过使用一些 RoR 范围方法）？如果是这样，如何做到这一点？

# html - 替代图像属性高度：自动

> ID：13503148
> 
> 赞同：0
> 
> 时间：2012-11-21T22:32:20.580
> 
> 标签：html, css

我无法让我的网站在 IE 中正确显示。所有其他浏览器都可以很好地显示它我已将问题缩小到我在图像标签中设置的图像属性，也就是说，`height="auto"`如果我将值设置为`height`像 150px 这样的静态值，它将显示图片，但不会像我想要的那样按比例显示它到。有没有一种替代方法我是新手，并尝试寻找答案，但找不到我要寻找的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:37:55.437

没关系，我删除了该`height`属性，它工作得很好。

# javascript - 有没有办法使用 spotify WEB API 来检查是否安装了 spotify？

> ID：13503151
> 
> 赞同：2
> 
> 时间：2012-11-21T22:32:28.433
> 
> 标签：javascript, api, spotify

基本上我想要的是创建一个链接列表，如果安装了 Spotify，它将使用 Spotify URI 链接到 Spotify，如果没有安装，则只是纯文本。

据我所知：

> spotify:track:7yOKhepYf8pO8ILT2Z5KN1

如果在浏览器中输入并安装了 Spotify，它将立即启动曲目或您请求的任何内容。

如果未安装 Spotify，这只会运行正常的浏览器请求。

我已经在文档中查看了我可以挂钩的东西，但我找不到任何可以在外部应用程序上使用的东西，只是重申这个应用程序不是原生 Spotify 应用程序。

我正在寻找的最终结果是一种调用方法，该方法检查是否安装了 Spotify 以返回 true，如果未安装则返回 false。

要求仅使用 HTML CSS 和 JavaScript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T08:04:35.007

[除非您使用诸如firebreath](http://www.firebreath.org)之类的东西编写浏览器插件，否则出于安全原因，我认为这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T12:21:47.327

我还没有对此进行深入研究，但是您可以使用端口 4380 上的 spotilocal.com 域（只是对 127.0.0.1 的 DNS 引用）联系本地 Spotify 客户端。

如果它允许 CORS，那么您应该能够使用 javascript 调用此 URL：

[http://1234.spotilocal.com:4380/remote/status.json](http://1234.spotilocal.com:4380/remote/status.json)

看看结果如何。

这就是 Facebook 进行 Spotify 集成的方式，如下所示：

[拥有解析为 127.0.0.1 的域名（spotilocal）有什么好处？](https://stackoverflow.com/questions/7580175/what-is-the-advantage-of-having-a-domain-name-spotilocal-that-resolves-to-127)

更新

如果您在 Chrome 中，请在此页面上打开您的开发工具，然后在控制台中粘贴并运行它：

```
$.get('http://1234.spotilocal.com:4380/remote/status.json', function(data){console.log(data)}); 
```

~~响应标头包含`Access-Control-Allow-Origin:*`因此您应该能够从您的页面使用 AJAX 调用该 URL~~

更新 2 (24/07/13)

最新版本的 spotify 客户端（我在 0.9.1.57 上）不再包含`Access-Control-Allow-Origin`标题，因此上述方法不再有效。

# javascript - Backbone.js - 使用骨干路由器和 hashchange false 加载初始路由

> ID：13503154
> 
> 赞同：4
> 
> 时间：2012-11-21T22:32:54.607
> 
> 标签：javascript, internet-explorer, backbone.js

我遇到了一些麻烦，在我的应用程序中，我想在 IE 中使用时默认为页面重新加载而不是哈希 URL。这似乎可以使用 hashChange 选项并将其设置为 false。

然而，这使得路由器在 IE 中根本不加载，我们仍然希望骨干路由器加载与加载的 URL 关联的初始路由。

```
Backbone.history.start({pushState: true,  hashChange: false}); 
```

无论如何要这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-03T19:23:27.970

尝试根据历史支持设置 pushState：

```
$(function () {
  Backbone.history.start({
  root: '/',
  pushState: (window.history && window.history.pushState),
  hashChange: false,
  silent: false
  });
}); 
```

# regex - Perl 模式匹配“无”/空

> ID：13503160
> 
> 赞同：1
> 
> 时间：2012-11-21T22:33:02.910
> 
> 标签：regex, perl, pattern-matching

这让我发疯！

1.  我将一个 txt 文件读入一个名为 $filestring 的字符串。

    ```
    sysopen(handle, $filepath, O_RDONLY) or die "WHAT?";
    local $/ = undef;
    my $filestring = <handle>; 
    ```

2.  我创建了一个名为 $regex 的模式变量，它是动态生成的，但采用以下格式：

    ```
    (a)|(b)|(c) 
    ```

3.  我在文本中搜索由空格分隔的模式

    ```
    while($filestring =~ m/($regex)\s($regex)/g){
       print "Match: $1 $2\n";
       #...more stuff
    } 
    ```

大多数匹配都是有效的，但由于某种原因，我每隔一段时间就会得到如下匹配：

```
Match: and 
```

而正常匹配应该有两个输出，如下所示：

```
Match: , and 
```

有谁知道这可能是什么原因造成的？

编辑：看起来 NULL 字符正在模式中匹配。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T23:01:38.313

正则表达式中的每个替代项都是一个单独的捕获组。整个正则表达式看起来像：

```
((a)|(b)|(c))\s((a)|(b)|(c))
12   3   4     56   7   8 
```

我已经用每条正则表达式的捕获组号对其进行了注释。

所以如果`$filestring`是`b a`，`$1`将是`b`，`$2`将是空的尝试，因为没有匹配`(a)`。

为避免这种情况，您应该使用非捕获组作为替代方案：

```
((?:a)|(?:b)|(?:c))\s((?:a)|(?:b)|(?:c)) 
```

# javascript - jQuery第一次返回XML节点很好，但我第二次调用它，它是空的

> ID：13503166
> 
> 赞同：1
> 
> 时间：2012-11-21T22:33:40.723
> 
> 标签：javascript, jquery, xml

我通过 AJAX 和 jQuery 在外部加载的文件中有这个 XML：

```
<project>
    <title>Title Name 2</title>
    <tags>Tag1.Tag2</tags>
    <image src="img/portfolio/better/better01.jpg" title="Image title" tags="Tag1.Tag2"></image>
    <image src="img/portfolio/better/better02.jpg" title="Image title" tags="Tag1.Tag2"></image>
    <thumb src="img/portfolio/better/better01.jpg" title="Image title" tags="Tag1.Tag2"></thumb>
    <copy>
        <columnOne>
            <p>Lorem ipsum dolor sit amet, cons ectetur adipiscing elit. Nulla lobortis accumsan purus. Nulla at arcu est. Mauris iaculis ses tincidunt odio cursus accumsan. Morbi quis interdumes massa. Nulla eu ipsum nunc, necs gravida metus. Pelle ntesque utes ligula est nec ullamcorper nulla.</p>
            <p>Cras id hendrerit velit. Suspendisse arscibus libero. Pellentesqueses habitant morbi trtique senctus et netus etsuada fames ac turpis egestas. Aliquam sagittise euismod velit, quis pharetra lacus ibulum mollis saewesty.</p>
        </columnOne>
        <columnTwo>
            <p>Morbi quis inteumes massa. Nulla eu ipsum nunc, necs gravida metus. Pelle ntesqueessy ligula est nec ullamcorper nulla</p>
        </columnTwo>
     </copy>
</project> 
```

XML 文档中有几个节点。我已将所有节点推入一个名为“project_array”的数组中。当我做 ：

```
console.log(project_array[0].text()); 
```

我得到：

```
Title Name 2
    Tag1.Tag2

            Lorem ipsum dolor sit amet, cons ectetur adipiscing elit. Nulla lobortis accumsan purus. Nulla at arcu est. Mauris iaculis ses tincidunt odio cursus accumsan. Morbi quis interdumes massa. Nulla eu ipsum nunc, necs gravida metus. Pelle ntesque utes ligula est nec ullamcorper nulla.
            Cras id hendrerit velit. Suspendisse arscibus libero. Pellentesqueses habitant morbi trtique senctus et netus etsuada fames ac turpis egestas. Aliquam sagittise euismod velit, quis pharetra lacus ibulum mollis saewesty.

            Morbi quis inteumes massa. Nulla eu ipsum nunc, necs gravida metus. Pelle ntesqueessy ligula est nec ullamcorper nulla 
```

这是我所期望的，“项目”中节点的全部内容。第二次调用它时，我只得到“title”和“tags”节点，而“columnOne”和“columnTwo”节点是空的。

撞头场景。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:12:25.613

根据您的填充方式`project_array`，调用`project_array[0].text()`实际上可能正在删除`text`内容，尽管我不确定为什么`<title>`并且`<tags>`下次会通过。

尝试使用`$(project_array[0]).clone().text()`，将其存储在变量中，然后使用该变量进行重复引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:37:37.860

`.text()`是一种用于 jQuery 对象的方法

如果`project_array`它是一个节点数组，为什么要使用`project_array[0].text()`

看起来应该是

```
console.log($(project_array[0]).text()) 
```

# iphone - 触摸屏幕上的任何位置以激活方法

> ID：13503167
> 
> 赞同：0
> 
> 时间：2012-11-21T22:33:45.937
> 
> 标签：iphone, ios, uiview

我有一个 if 语句，它会显示一个 SVProgressHUD，让用户知道存在错误。我想以编程方式创建一个触摸事件，但是当我使用在界面生成器中设置的表格视图时，我不确定如何定义我的视图

这是我想使用的代码

```
[myView addTarget:self action:@selector(myAction:)forControlEvents:UIControlEventTouchUpInside]; 
```

但我不确定在使用 tableview 时如何创建 myView。处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T01:30:01.870

您可以添加一个具有透明颜色的 UIButton 并将其添加到您的视图中。然后，您将能够使用以下方法：

```
[myButton addTarget:self action:@selector(myAction:)forControlEvents:UIControlEventTouchUpInside]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:46:59.660

将 tapGestureRecognizer 添加到带有目标和事件的视图中以处理点击事件，这样当用户单击或触摸视图时，它会触发选择器。

```
UIGestureRecognizer *recognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(mySelector:)]
[myView addGestureRecognizer: recognizer]; 
```

然后你可以添加选择器，它只是将识别器作为发送者；

```
-(void)mySelector:(UIGestureRecognizer*)gr{
  // handling event  
} 
```

# python - scipy中的最小化，找到N维标量函数的所有局部最小值的算法

> ID：13503170
> 
> 赞同：6
> 
> 时间：2012-11-21T22:34:03.730
> 
> 标签：python, scipy, numerical-methods, minimize

有没有人知道一个强大的例程/算法（最好在 scipy/python 中）来定位 N 维向量空间的定义（“矩形”）区域中 N 个变量的标量实函数的“所有”局部最小值？

scipy 中的受约束和不受约束的最小化算法都只返回一个最小值（全局或局部）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-09-04T14:18:00.460

Scipy 的[盆地跳跃](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.basinhopping.html)有一个`callback`参数可以用来保存所有找到的最小值。

例如：

```
all_minima = []
def save_minima(x, f, accepted):
    all_minima.append(x)

basinhopping(func, x0, callback=save_minima) 
```

显然，这不一定会返回所有局部最小值。但它确实会返回它找到的所有内容。

# sencha-touch - 安装 Sencha SDK 并生成 GS 应用

> ID：13503171
> 
> 赞同：4
> 
> 时间：2012-11-21T22:34:10.517
> 
> 标签：sencha-touch, sencha-touch-2.1, sencha-command

我最近下载了 Sencha SDK 和 SDK 工具。我安装了 SDK 工具，并将文件 sencha-touch-2.1.0-commercial.zip 的内容解压缩到我的 Web 服务器。我 cd 进入目录并运行给出的命令来生成一个入门应用程序，但我收到了这条消息：

```
abe@Dubai:/var/www/sencha-touch-sdk$ sencha
[WARN] The current working directory (/var/www/sencha-touch-sdk) is not a recognized Sencha SDK or application folder. Running in backwards compatible mode.

Sencha Command v2.0.0 Beta 3
Copyright (c) 2012 Sencha Inc.

....followed by all the info on how to structure commands using sencha 
```

我用谷歌搜索，发现 sencha 知道它是 sencha sdk 文件夹的一种方法是它包含一个名为 .sencha 的隐藏文件，我的 sdk 目录丢失了该文件。创建空白 .senchasdk 文件后，我再次运行命令，但这次我得到了：

```
abe@Dubai:/var/www/sencha-touch-sdk$ sencha

node.js:201
    throw e; // process.nextTick error, or 'error' event on first tick
          ^
Error: Cannot find module '/var/www/sencha-touch-sdk/command/sencha.js'
    at Function._resolveFilename (module.js:332:11)
    at Function._load (module.js:279:25)
    at Array.0 (module.js:479:10)
    at EventEmitter._tickCallback (node.js:192:40) 
```

对我来说有趣的是它正在寻找我的 SDK 文件夹中不存在的“命令”目录。我下载/提取了错误的东西吗？我按照我从 Sencha 的电子邮件中获得的 sdk 的下载链接进行操作。

顺便说一句，我正在使用 Ubuntu linux。我希望这不是我想的那么愚蠢的问题，我已尽力研究这个问题

编辑：我只是想补充一点，我可以在浏览器中访问 sencha-touch-sdk 目录，并且确实看到了文档。这让我相信我毕竟有正确的包裹......所以我再一次被难住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T19:50:39.183

尝试对 Sencha SDK 版本使用 Sencha CMD 而不是 Sencha SDK Tools。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T06:52:07.600

下载 Sencha Command 最新版本，然后将 Sencha Command 安装到 Sencha SDK 工具的 Bin 文件夹中。

此后，您只需在命令提示符下键入“Sencha”即可。

```
**C:\Users\srinivasan.kk>sencha
Sencha Cmd v3.0.2.288** 
```

希望它可以帮助你。

# ios - 如果 iPhone 上安装了应用程序，则检查 Safari

> ID：13503173
> 
> 赞同：0
> 
> 时间：2012-11-21T22:34:27.960
> 
> 标签：ios, iphone, installation

有很多关于这个的问题，我找不到有用的答案。似乎 Twitter 已经有了解决方案：当我在 Safari 应用程序中访问 mobile.twitter.com 时，我可以看到一个栏，一个带有“已安装 Twitter”的窗口顶部和一个“打开”链接（我猜是因为Twitter 应用程序安装在我的 iPhone 上）。

是因为 Twitter 与 iOs 5 和 iOs 6 “半集成”（因此它们比简单的开发人员更强大），还是仅仅因为他们是天才？如果他们是天才，你知道他们是怎么做到的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T22:42:36.430

听起来您在描述 Apple 的“智能应用横幅”。Apple 详细介绍了他们在[开发者网站上的](http://developer.apple.com/library/ios/#documentation/AppleApplications/Reference/SafariWebContent/PromotingAppswithAppBanners/PromotingAppswithAppBanners.html)工作方式。基本上，您将这样的内容添加到您的网页中：

```
<meta name="apple-itunes-app" content="app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL"> 
```

...然后设备完成其余的工作。如果应用程序未安装，则按钮显示为“安装”，否则显示为“打开”。

# php - 分页过滤的 XML 文件

> ID：13503175
> 
> 赞同：0
> 
> 时间：2012-11-21T22:34:28.750
> 
> 标签：php, xml, pagination

我想对 xml 文件中的以下过滤结果进行分页：

```
<?php

//load up the XML file as the variable $xml (which is now an array)

$xml = simplexml_load_file('inventory.xml');

//create the function xmlfilter, and tell it which arguments it will be handling

function xmlfilter ($xml, $color, $weight, $maxprice)
{
    $res = array();
    foreach ($xml->widget as $w)
    {
        //initially keep all elements in the array by setting keep to 1
        $keep = 1;
        //now start checking to see if these variables have been set
        if ($color!='')
        {
        //if color has been set, and the element's color does not match, don't keep this element
            if ((string)$w->color != $color) $keep = 0;
        }
        //if the max weight has been set, ensure the elements weight is less, or don't keep this element
        if ($weight)
        {
            if ((int)$w->weight > $weight) $keep = 0;
        }
        //same goes for max price
        if ($maxprice)
        {
            if ((int)$w->price > $maxprice) $keep = 0;
        }
        if ($keep) $res[] = $w;
    }
    return $res;
}

//check to see if the form was submitted (the url will have '?sub=Submit' at the end)
if (isset($_GET['sub']))
{
    //$color will equal whatever value was chosen in the form (url will show '?color=Blue')
    $color = isset($_GET['color'])? $_GET['color'] : '';
    //same goes for these fellas
    $weight = $_GET['weight'];
    $price = $_GET['price'];

    //now pass all the variables through the filter and create a new array called $filtered
    $filtered = xmlfilter($xml ,$color, $weight, $price);
    //finally, echo out each element from $filtered, along with its properties in neat little spans
    foreach ($filtered as $widget) {
        echo "<div class='widget'>";
        echo "<span class='name'>" . $widget->name . "</span>";
        echo "<span class='color'>" . $widget->color . "</span>";
        echo "<span class='weight'>" . $widget->weight . "</span>";
        echo "<span class='price'>" . $widget->price . "</span>";
        echo "</div>";
    }
} 
```

其中`$xml->widget`代表以下xml：

```
<hotels xmlns="">
    <hotels>
        <hotel>
            <noofrooms>10</noofrooms>
            <website></website>
            <imageref>oias-sunset-2.jpg|villas-agios-nikolaos-1.jpg|villas-agios-nikolaos-24​.jpg|villas-agios-nikolaos-41.jpg</imageref>
            <descr>blah blah blah</descr>
            <hotelid>119</hotelid>
        </hotel>
    </hotels>
</hotels> 
```

有什么好主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:32:17.723

老实说，如果您已经在使用 XML 并且想要进行分页，那么请使用 XSL。它将允许对结果进行格式化并轻松进行分页。PHP 有一个内置的 XSL 转换器 iirc

请参阅[http://www.codeproject.com/Articles/11277/Pagination-using-XSL](http://www.codeproject.com/Articles/11277/Pagination-using-XSL)以获得一个不错的示例。

# entity-framework - 实体框架是否支持空对象模式？

> ID：13503182
> 
> 赞同：1
> 
> 时间：2012-11-21T22:35:15.633
> 
> 标签：entity-framework

在实体框架中使用空对象模式有哪些选择？我所有的业务对象都有一个静态的“空”空对象（类似于 Guid.Empty、String.Empty 等），当从数据库中选择空值时，这些对象被分配给相关对象的属性。

NHibernate 通过使用相应属性中的处理程序代码的字段访问来支持这种模式（[一个示例](http://journalofasoftwaredev.wordpress.com/2009/01/17/nhibernate-null-object-pattern-the-options/)）。实体框架如何支持这一点？一对多关系的空列表呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T09:58:30.470

本文仅使用映射字段和未映射属性 - 您可以在 EF 中使用具有两个属性的类似方法。该方法会带来一些复杂性，因为仅允许在映射属性上指定预加载，并且延迟加载也有一些要求（动态代理必须覆盖映射属性）。

null 对象的整体含义也可能有点复杂，因为 EF 的 null 表示未分配或未加载（如果您关闭延迟加载）。

# javascript - jQuery Validation - 在点击超链接按钮时验证表格字段并显示错误消息摘要

> ID：13503185
> 
> 赞同：1
> 
> 时间：2012-11-21T22:35:27.923
> 
> 标签：javascript, jquery, html, validation, html-table

我有一个包含各种表格的表格。单击下一个按钮时，这些表会显示或隐藏。因此，这实际上为用户提供了从一个页面到另一个页面的导航，而表单相同并且仅显示/隐藏表格。现在我需要的是在单击下一步按钮（超链接类型）时验证这些表，并每次显示验证摘要。我知道 validate 可以用于整个表单，但我只需要验证表格元素，然后显示摘要。

请记住，我使用的是非侵入式客户端验证，元素是使用该模型创建的。此外，它目前执行该验证，但在最后提交按钮。我的桌子的非常简短的样本

```
<table id= "table1">
    <tr>
        <td1>First coulmn</td1>
        <td2>value2</td2>
        <td3>
            <a id="Next" onclick= "javascript:function1()">Save</a>
        </td3>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:15:35.947

```
<table id= "table1">
    <tr>
        <td1>First coulmn</td1>
        <td2>value2</td2>
        <td3>
            <a id="Next" onclick= "javascript:validAndNext('1')">Save</a>
        </td3>
    </tr>
</table>
    .
    .
    .
<table id="tableN"> 

function validAndNext(table_id){
   var table = $('#table'+table_id);
   var inputs = table.find("input");
   var valid = true;
   inputs.each(function(){
       // A type of validation is:
       if($(this).val().length<=0) valid = false;                
   });
   if(valid){
      table.hide();
      $('#table'+(table_id+1)).show();
   }else alert('Your table is not valid!');
} 
```

# ios - 无法从第二台设备读取在第一台设备上写入的 iCloud 文件

> ID：13503194
> 
> 赞同：2
> 
> 时间：2012-11-21T22:36:51.537
> 
> 标签：ios, icloud

我无法从我的应用程序在一个设备上将简单文件写入 iCloud 容器，然后在我的应用程序**第一次**在第二台设备上运行时成功读取同一个文件。

我在一对新重置的设备上使用空的 Ubiquity Container 开始了这个测试场景。下面是演示我遇到的问题的测试用例代码和控制台日志记录。下面的所有代码都在后台线程上运行。

我在第一台设备上安装并运行测试用例。代码在 ubiquity 容器中查找某个文件，并在找不到时创建它。显然，这是它第一次在第一台设备上运行时的预期。我希望（并期待）当应用程序全新安装并在第二台设备上运行时，它能够找到并读取在第一台设备上创建的文件的内容。似乎在重置设备上新安装的应用程序永远无法找到和读取现有文件，并且总是认为它需要创建一个新文件，如果它已经存在，不幸的是最终替换了 ubiquity 容器中的文件。

但是，在第一次尝试（在第二台设备上）未能找到并读取文件后，如果我删除应用程序，重新安装然后在同一设备上重新运行它，它确实找到了文件并能够读取其当前内容。似乎应用程序的第一次运行导致文件被加载到普遍存在的缓存中，但不是处于应用程序可以找到的状态。该应用程序的第二次运行似乎在缓存中找到了该文件。

我知道您应该开始在 iOS 设备上下载文件，但在第一次使用设备时，它会报告“找不到文件”。这里还有什么需要做的吗？或者这看起来像是一个新的或已知的错误？

以下代码用于确定 ubiquity 容器中是否存在令牌文件并确保它可以被读取。

```
NSError *error;
BOOL rc;

NSFileManager *fm = [[NSFileManager alloc] init];
NSURL *ubiquityURL = [fm URLForUbiquityContainerIdentifier:nil];
NSURL *tokenURL = [ubiquityURL URLByAppendingPathComponent:@"iCloudTokenFile"];

NSLog(@"isTokenFilePresentAtUrl: Entered for Device Name: %@", [[UIDevice currentDevice] name]);

error = nil;
rc = [fm startDownloadingUbiquitousItemAtURL:tokenURL error:&error];
NSLog(@"startDownloadingUbiquitousItemAtURL: %d Error: %@(%d)", rc, error.domain, error.code);

rc = [fm isUbiquitousItemAtURL:tokenURL];
NSLog(@"isUbiquitousItemAtURL: %d", rc);

NSNumber *isUbiquitousItem = nil;
error = nil;
rc = [tokenURL getResourceValue:&isUbiquitousItem forKey:NSURLIsUbiquitousItemKey error:&error];
NSLog(@"getResourceValue: %d isUbiquitousItem: %@ Error: %@(%d)", rc, isUbiquitousItem, error.domain, error.code);

NSNumber *isDownloading = nil;
error = nil;
rc = [tokenURL getResourceValue:&isDownloading forKey:NSURLUbiquitousItemIsDownloadingKey error:&error];
NSLog(@"getResourceValue: %d isDownloading: %@ Error: %@(%d)", rc, isDownloading, error.domain, error.code);

NSNumber *isDownloaded = nil;
error = nil;
rc = [tokenURL getResourceValue:&isDownloaded forKey:NSURLUbiquitousItemIsDownloadedKey error:&error];
NSLog(@"getResourceValue: %d isDownloaded: %@ Error: %@(%d)", rc, isDownloaded, error.domain, error.code); 
```

以下代码用于尝试从 ubiquity 容器中读取令牌文件。

```
__block BOOL success = NO;
__block NSError *error = nil;

NSFileCoordinator *fc = [[NSFileCoordinator alloc] initWithFilePresenter:nil];
[fc coordinateReadingItemAtURL:tokenURL
                       options:NSFileCoordinatorReadingWithoutChanges
                         error:&error
                    byAccessor:^(NSURL *newURL)
 {
     NSLog(@"readTokenFileFromUrl: Trying to read Token File.");

     NSNumber *isDownloaded = nil;
     error = nil;
     BOOL rc = [tokenURL getResourceValue:&isDownloaded forKey:NSURLUbiquitousItemIsDownloadedKey error:&error];
     NSLog(@"getResourceValue: %d isDownloaded: %@ Error: %@(%d)", rc, isDownloaded, error.domain, error.code);

     NSString *uuidString =  nil;
     NSError *blockerror = nil;
     uuidString = [NSString stringWithContentsOfURL:newURL
                                           encoding:NSUTF8StringEncoding
                                              error:&blockerror];

     NSLog(@"readTokenFileFromUrl: Token read from file: %@", uuidString);
 }]; 
```

如果无法读取现有令牌文件，以下代码用于将令牌文件写入 ubiquity 容器。我期望此代码只会由第一个设备运行一次。

```
NSFileCoordinator *fc = [[NSFileCoordinator alloc] initWithFilePresenter:nil];
NSError *error = nil;
[fc coordinateWritingItemAtURL:tokenURL
                       options:NSFileCoordinatorWritingForReplacing
                         error:&error
                    byAccessor:^(NSURL *newURL)
 {
     NSUUID *uuid = [[NSUUID alloc] init];
     NSString *uuidString = [uuid UUIDString];

     NSError *blockerror = nil;
     NSLog(@"writeTokenFileToUrl: Writing token to file: %@", uuidString);

     [uuidString writeToURL:newURL
                 atomically:YES
                   encoding:NSUTF8StringEncoding
                      error:&blockerror];
 }]; 
```

该应用程序在“Red iPod touch”上首次安装并运行。

```
isTokenFilePresentAtUrl: Entered for Device Name: Red iPod touch 
startDownloadingUbiquitousItemAtURL: 0 Error: NSCocoaErrorDomain(4) 
isUbiquitousItemAtURL: 0 
getResourceValue: 0 isUbiquitousItem: (null) Error: NSPOSIXErrorDomain(2) 
getResourceValue: 0 isDownloading: (null) Error: NSPOSIXErrorDomain(2) 
getResourceValue: 0 isDownloaded: (null) Error: NSPOSIXErrorDomain(2) 
readTokenFileFromUrl: Trying to read Token File. 
getResourceValue: 0 isDownloaded: (null) Error: NSPOSIXErrorDomain(2) 
readTokenFileFromUrl: Token from File: (null) 
readTokenFileFromUrl: Error reading uuid Token from File: NSCocoaErrorDomain(260) 
loadiCloudStore: isUbiquitousItemAtURL: Token File actually does not appear to be present. 
writeTokenFileToUrl: Writing token to file: 6AAA8D81-4BB5-4BF4-AD31-E152D3BADD13 
```

此时，通过 developer.icloud.com 网站验证该文件存在于 Ubiquity 容器中。然后在名为“Blue iPod touch”的第二台设备上安装并首次运行该应用程序。

```
isTokenFilePresentAtUrl: Entered for Device Name: Blue iPod touch
startDownloadingUbiquitousItemAtURL: 0 Error: NSCocoaErrorDomain(4)
isUbiquitousItemAtURL: 0
getResourceValue: 0 isUbiquitousItem: (null) Error: NSPOSIXErrorDomain(2)
getResourceValue: 0 isDownloading: (null) Error: NSPOSIXErrorDomain(2)
getResourceValue: 0 isDownloaded: (null) Error: NSPOSIXErrorDomain(2)
readTokenFileFromUrl: Trying to read Token File.
getResourceValue: 0 isDownloaded: (null) Error: NSPOSIXErrorDomain(2)
readTokenFileFromUrl: Token from File: (null)
readTokenFileFromUrl: Error reading uuid Token from File: NSCocoaErrorDomain(260) 
```

对于本次测试，App 在尝试读取后停止，不允许尝试写入或替换令牌文件。然后该应用程序被杀死、删除并重新安装并在 Blue iPod touch 上再次运行。

```
isTokenFilePresentAtUrl: Entered for Device Name: Blue iPod touch
startDownloadingUbiquitousItemAtURL: 1 Error: (null)(0)
isUbiquitousItemAtURL: 1
getResourceValue: 1 isUbiquitousItem: 1 Error: (null)(0)
getResourceValue: 1 isDownloading: 1 Error: (null)(0)
getResourceValue: 1 isDownloaded: 0 Error: (null)(0)
readTokenFileFromUrl: Trying to read Token File.
getResourceValue: 1 isDownloaded: 0 Error: (null)(0)
readTokenFileFromUrl: Token read from file: 6AAA8D81-4BB5-4BF4-AD31-E152D3BADD13 
```

这次它找到并读取具有预期内容的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T01:03:13.943

好吧，我没有放弃，我现在认为我有一个可以接受的解决这个问题的方法。解决方案的关键是第二台设备能够成功检测到第一台设备写入泛在容器的令牌文件，而不是尝试写入文件本身。

以下是对我有用的步骤：

*   立即尝试从容器中读取令牌文件。
*   如果成功，请使用该文件并忽略其余步骤。
*   否则，启动元数据查询，其谓词将触发两个特定文件名（您尝试读取的令牌文件和“虚拟”文件）。
*   现在使用虚拟文件名将文件写入 ubiquity 容器。
*   当元数据查询的结果到达时，检查它报告的文件的上传/下载状态。
*   如果查询曾经报告看到令牌文件，那么这不是第一个设备，它应该继续尝试读取文件直到成功。这可能需要一段时间，但它最终会读到它。
*   如果元数据查询报告虚拟文件已完全上传并且仍然没有令牌文件的迹象，那么可以安全地假设这是第一个设备并且现在可以写入令牌文件了。
*   我发现等到令牌文件的状态完全上传后再尝试使用令牌很有用。否则，如果出现网络问题，另一台也启动此进程的设备可能会做同样的事情，并认为它是第一个设备。

似乎将虚拟文件写入通用容器“启动”了元数据查询，足以让它报告第二个设备上令牌文件的存在。没有它，元数据查询永远不会报告令牌文件在除第一台设备之外的任何设备上的存在。

# php - 使用定义（或类常量）调用变量方法？

> ID：13503196
> 
> 赞同：1
> 
> 时间：2012-11-21T22:37:07.097
> 
> 标签：php, variables, methods, call

是否有可能 ：

```
define('DEFAULT_METHOD', 'defaultMethod');

class Foo
{
    public function defaultMethod() { }
}

$foo = new Foo();
$foo->DEFAULT_METHOD(); 
```

还是我必须：

```
$method = DEFAULT_METHOD;
$foo->$method(); 
```

那么类常量而不是定义呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:40:39.673

如果使用变量或常量作为方法名，则必须将其放入大括号中：

```
$foo->{DEFAULT_METHOD}(); 
```

相同的技术适用于变量，包括静态类属性：

```
class Foo {
    public static $DEFAULT_METHOD = 'defaultMethod';
    public function defaultMethod() { echo "Cool!\n"; }
}

$foo = new Foo();
$foo->{FOO::$DEFAULT_METHOD}(); 
```

事实上，几乎可以使用任何产生有效方法名称的表达式：

```
$foo->{'default'.'Method'}(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T22:40:25.993

您可以先将其设置为变量，如您的示例中所示：)

示例：[http ://codepad.org/69W4dYP1](http://codepad.org/69W4dYP1)

```
<?php
  define('DEFAULT_METHOD', 'defaultMethod');

  class Foo {
      public function defaultMethod() { echo 'yay!'; }
  }

  $foo = new Foo();
  $method = DEFAULT_METHOD;
  $foo->$method();
?> 
```

# upload - 使用carrierwave时无法将文件保存到Amazon S3

> ID：13503206
> 
> 赞同：0
> 
> 时间：2012-11-21T22:37:38.843
> 
> 标签：upload, amazon-s3, carrierwave, rmagick, fog

请参阅下面的更新！

将图像文件上传到 Amazon S3 然后尝试保存文件后，我遇到了问题。

我使用 direct_fog_url(with_path: true) 来获取上传图片的 url。然后我收到以下错误：

ActiveRecord::RecordInvalid 验证失败：图像无法下载文件

我看到了这两种可能的解决方案：

[https://github.com/jnicklas/carrierwave/issues/700](https://github.com/jnicklas/carrierwave/issues/700)

[http://www.github.com/jnicklas/carrierwave/issues/888](http://www.github.com/jnicklas/carrierwave/issues/888)

但两者似乎都不起作用。

我使用较旧的已删除命令：覆盖方法 process_uri（在此处输入链接描述）：

```
def process_uri(uri) 
 URI.parse(URI.escape(URI.unescape(uri)).gsub("[", "%5B").gsub("]", "%5D").gsub("+", "%2B"))
end 
```

在我的应用程序中，我使用以下宝石：

宝石“雾”

宝石“载波”

宝石'carrierwave_direct'

宝石'rmagick'

谢谢！

更新：在下面实现@Alex的答案后，我们解决了这个问题，但是现在当我们上传时，我们得到以下错误：

Excon::Errors::MovedPermanently

PermanentRedirect 您尝试访问的存储桶必须使用指定的端点进行寻址。请将所有未来的请求发送到此端点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T14:28:31.743

你找到解决这个问题的方法了吗？

我在这里面临同样的问题，我正在尝试使用carrierwave（不在S3上）获取远程URL，并且我收到了臭名昭著的“无法下载文件”错误：

```
 Validation failed: Image could not download file
    [...]/gems/activerecord-3.2.9/lib/active_record/validations.rb:56:in `save!' 
```

你能张贴你的网址看看有什么特殊字符吗？

编辑：我找到了解决方案。我的情况要求我根本*没有*改变或逃避 uri。我发现通过在 'def process_uri(uri)' 方法中添加 'return' 可以正常工作。以防万一这对其他人有用，这是我在上传器类中的重写方法：

```
 def process_uri(uri)
      return URI.parse(uri)
    end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T22:15:28.983

对于您的**Excon::Errors::MovedPermanently**问题，请确保您在 carrierwave.rb 文件中配置了正确的数据中心区域。例如，如果您在 us-west 上托管，则需要将您的区域设置为 us-west。

# linux - 用数据填充 shell 脚本数组

> ID：13503207
> 
> 赞同：0
> 
> 时间：2012-11-21T22:37:39.443
> 
> 标签：linux, arrays, bash, shell

我想从文件中提取一些数据并将其保存在一个数组中，但我不知道该怎么做。

下面我从 /etc/group 中提取一些数据并将其保存在另一个文件中，然后打印每个项目：

```
awk -F: '/^'$GROUP'/ { gsub(/,/,"\n",$4) ; print $4 }' /etc/group > $FILE

for i in `awk '{ print $0 }' $FILE`
   do
     echo "member: "$i" "
   done 
```

但是，我不想将数据提取到文件中，而是提取到数组中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:53:15.307

```
members=( $(awk -F: '/^'$GROUP':/ { gsub(/,/,"\n",$4) ; print $4 }' /etc/group) ) 
```

带括号的赋值表示这`$members`是一个数组。原始`awk`命令包含在 中`$(...)`，并添加了冒号，因此如果您在文件中有`group`and`group1`并且您查找`group`，您也不会获得数据`group1`。当然，如果您想要两个条目，那么您可以删除我添加的冒号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T22:46:18.163

```
j=0
for i in `awk '{ print $0 }' $FILE`
do
  arr[$j] = $i
  j=`expr $j + 1`
done 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T22:50:20.483

```
arr=($(awk -F: -v g=$GROUP '$1 == g { gsub(/,/,"\n",$4) ; print $4 }' /etc/group)) 
```

# oop - Matlab相当于在静态类中调用

> ID：13503209
> 
> 赞同：5
> 
> 时间：2012-11-21T22:37:59.313
> 
> 标签：oop, class, matlab, static

授予以下代码：

```
classdef highLowGame
    methods(Static)
        function [wonAmount, noGuesses] = run(gambledAmount)
            noGuesses = 'something';
            wonAmount = highLowGame.getPayout(gambledAmount, noGuesses); % <---
        end
        function wonAmount = getPayout(gambledAmount, noGuesses)
            wonAmount = 'something';
        end
    end
end 
```

有没有办法调用同一个类的静态方法（在静态方法中）而不必写类名？像“self.getPayout(...)”这样的东西——以防类结果达到 500 行并且我想重命名它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-22T07:02:18.900

不是直接回答您的问题，但值得注意的是，您还可以`classdef`在文件中的块结束之后放置“本地函数”，这些函数的`class.m`行为类似于私有静态方法，但您不需要使用类调用它们姓名。IE

```
% myclass.m
classdef myclass
  methods ( Static )
    function x = foo()
      x = iMyFoo();
    end
  end
end
function x = iMyFoo()
  x = rand();
end
% end of myclass.m 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T22:45:14.347

据我所知，“不”带有“但是”。一般情况下，只能用类名指定静态方法。但是，由于 MATLAB 具有 feval，因此您可以绕过限制：

```
classdef testStatic

    methods (Static)
        function p = getPi()  %this is a static method
            p = 3.14;
        end
    end

    methods
        function self = testStatic()

            testStatic.getPi  %these are all equivalent
            feval(sprintf('%s.getPi',class(self)))
            feval(sprintf('%s.getPi',mfilename('class')))
        end
    end
end 
```

在这里，class(self) 和 mfilename 都评估为“testStatic”，因此上述函数最终评估“testStatic.getPi”。

或者，或者，您可以编写一个非静态方法 self.callStatic；然后总是使用它。在其中，只需调用 testStatic.getPi。然后你只需要改变那一行。

# r - 将 R 与英特尔 MKL 11.01.117 链接

> ID：13503211
> 
> 赞同：1
> 
> 时间：2012-11-21T22:38:19.990
> 
> 标签：r, intel-mkl

我似乎无法将它们链接起来，动态链接说明似乎已经过时了。有人对此有任何见解吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:01:41.213

rdevel 列表上有活动：[今年早些时候的这篇帖子](http://markmail.org/search/?q=r-devel%20list%3aorg.r-project.r-devel%20mkl%20intel#query%3ar-devel%20list%3aorg.r-project.r-devel%20mkl%20intel%20date:201205%20%20page:1%20mid:45d5z3p56nwcihdh%20state%3aresults)报告说，至少有一个人在 R 2.15.0 和 MKL 2011-sp1 上取得了成功。这是否适用于您的版本，我无法说。

# java - 如何从 HttpServletRequest 获取 URL 片段标识符

> ID：13503213
> 
> 赞同：13
> 
> 时间：2012-11-21T22:38:30.030
> 
> 标签：java, servlets, fragment-identifier

如何从中获取 URL 片段标识符`HttpServletRequest`？

[javadocs](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html)似乎没有提到它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-21T22:41:36.330

您无法以您想要的方式获取 URL 片段。

通常，浏览器不会将片段发送到服务器。这可以通过使用 tcpdump、[Ethereal](http://www.ethereal.com/)、[Wireshark](http://www.wireshark.org/)、[Charles](http://www.charlesproxy.com/)等网络协议分析器来验证。

但是，您可以在 JavaScript 请求中将片段字符串作为 GET/POST 参数发送。要使用 JavaScript 获取值，请使用`window.location.hash`. 然后，您可以将此值作为 AJAX 请求中的 GET 或 POST 参数传递，并使用 HttpServletRequest 上的 getParameter 方法进行 AJAX 请求。

这是[RFC3986：统一资源标识符 (URI)：通用语法](https://www.rfc-editor.org/rfc/rfc3986#section-3.5)必须说的：

> 片段标识符在解引用之前与 URI 的其余部分分离，因此片段本身内的标识信息仅由用户代理解引用，而不管 URI 方案如何。尽管这种单独的处理通常被认为是信息的丢失，特别是随着资源随着时间的推移而准确地重定向参考文献，但它也有助于防止信息提供者拒绝参考作者有选择地参考资源中的信息的权利。间接引用还为使用 URI 的系统提供了额外的灵活性和可扩展性，因为新的媒体类型比新的标识方案更容易定义和部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:42:51.970

看看下面的链接：[https ://www.rfc-editor.org/rfc/rfc2396](https://www.rfc-editor.org/rfc/rfc2396)

# excel - Excel 宏在调试模式下执行，但在选择不同的工作表时抛出错误

> ID：13503215
> 
> 赞同：1
> 
> 时间：2012-11-21T22:38:46.750
> 
> 标签：excel, excel-2010, vba

我正在编写一个宏来将数据从输入表单传输到存储表。
我已经制定了粗略的代码，并且可以运行。仅当我选择了目标工作表时。如果我尝试从包含表单的工作表中运行它，则会引发以下错误：
`Run-time error '1004': Select method of Range class failed`
但是，如果我从目标工作表中运行宏，它会完美执行。这是代码：

```
Sub ExpFormCharge()
    Dim pasteCell As Range
    Range("expenseTbl").ListObject.ListRows.Add AlwaysInsert:=False
    Range("ETBMARKER").Offset(-1, 0).Select
    Range("ExpFormBackend").Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End Sub 
```

后端表由另一个宏填充，然后将该表复制并粘贴到费用表（存储表）的新行中。调试选项突出显示的行是这一行：
`Range("ETBMARKER").Offset(-1, 0).Select`
那是指一个标记，存储表的总行偏移一，以便选择表的底部行。无论是从 vba 窗口还是从宏选择窗格执行代码，只要选择了目标工作表以外的工作表，就会发生此错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T04:32:54.150

某些操作只能在活动工作表上执行。

添加

```
Range("ETBMARKER").Parent.Activate 
```

在抛出错误的行之前。

顺便说一句，但是你 Dim 一个你从不使用的变量，导致错误的行没有做任何事情——你在下一行复制了一个不同的范围。您可以删除这两行，除非此代码示例中未包含其他功能。

# excel - Excel 单元格中的文本和日期 - 只读日期

> ID：13503218
> 
> 赞同：0
> 
> 时间：2012-11-21T22:39:12.703
> 
> 标签：excel, vba

我在一个 Excel 单元格中有一些文本和一个日期（用连字符分隔），例如“周年纪念 - 2012 年 12 月 12 日”

我希望能够仅读取日期，如果它大于当前日期 - 单元格应突出显示。

这可以通过excel函数完成还是我需要编写一些VBA？

MC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:53:07.673

用所有值标记该区域，然后选择“条件格式”。从“突出显示单元格规则”中选择“更多规则”，然后选择“使用公式确定要格式化的单元格”。将此公式放在规则描述字段中：

```
=DATEVALUE(MID($A1,FIND(" - ",$A1)+3,10))>TODAY() 
```

不要忘记使用“格式...”选择格式选项

# python - Python 覆盖字符串 __hash__

> ID：13503219
> 
> 赞同：6
> 
> 时间：2012-11-21T22:39:13.010
> 
> 标签：python, class, hash

我正在尝试为字符串创建自定义散列函数。我想通过权重的字符频率对字符串进行哈希处理。这样，`hi`就会`ih`产生相同的哈希值。我可以覆盖`__hash__`吗？

或者正在创建一个包含字符串和覆盖的包装类，`__hash__`并且`__eq__`是唯一的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T23:34:32.713

您需要具有不同相等语义的派生类型。通常采用的方法是定义相等性如何工作，然后从那里派生的结构构建散列方法，因为散列必须与相等性一致。那可能是：

```
import collections

class FrequencyString(str):
    @property
    def normalized(self):
        try:
            return self._normalized
        except AttributeError:
            self._normalized = normalized = ''.join(sorted(collections.Counter(self).elements()))
            return normalized

    def __eq__(self, other):
        return self.normalized == other.normalized

    def __hash__(self):
        return hash(self.normalized) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:43:11.830

您的假设是正确的，您不能覆盖 Python 中的基类。当然，虽然可以覆盖`str()`将要执行的操作，但它不适用于字符串文字。

如果您正在为 pre-python 2.2 编写代码，`UserString`如果您想创建自己的，请查看该类：http: [//docs.python.org/2/library/userdict.html#module-UserString](http://docs.python.org/2/library/userdict.html#module-UserString)

否则，您可以简单地继承`str`或`unicode`

`__hash__`在您的情况下，如果您想将其用作 dict 键，只需覆盖该方法就足够了。但是，如果您正在查看比较，则必须覆盖`__eq__`或`__cmp__`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:20:04.253

您可以从 继承`str`，但由于它们是不可变的，因此您必须以稍微不同的方式对它们进行子类化。您很可能希望从现有字符串创建新字符串，因此您还必须覆盖该`__new__`方法。您可能还必须使用额外的特殊方法来破坏 Python 所做的优化。

这是一个子类化 built-in 的示例，它允许在表单中轻松替换占位符`str`的[mapstr](http://code.google.com/p/pycopia/source/browse/trunk/aid/pycopia/aid.py#355)对象。

# ruby-on-rails - 更新字段时如何验证相关记录是否存在

> ID：13503222
> 
> 赞同：0
> 
> 时间：2012-11-21T22:39:49.017
> 
> 标签：ruby-on-rails

我很新，但正在尝试通过实践来学习。我有一个 Profile 模型和 Vendor 模型，它们的相关性如下：

```
class Profile < ActiveRecord::Base
  has_one :vendor, dependent: :destroy
end

class Vendor < ActiveRecord::Base
  belongs_to :profile
end 
```

Profile 模型有一个名为 :verified_vendor 的字段，它是一个布尔值，对于所有配置文件默认为 false。Vendor 模型目前只有一个字段，但我们稍后会添加更多，该字段是 :reference_account_num。一旦我们做了一些内部财务逻辑，我在我们的应用程序中设置了一条路线，管理员将进入并选择配置文件，选择将配置文件验证为供应商，然后输入他们在金融系统。然后应用程序创建一个供应商行并将配置文件更新为已验证为真。我想确保验证翻转标志时必须创建一行。我曾通过观察者研究过这样做，但那是正确的道路吗？由于标志在个人资料中，看来我可以更新：

1.  管理员选择一个配置文件并选择验证为供应商
2.  管理员输入财务参考号
3.  该事务创建一个供应商行并将配置文件 :verified_vendor 更新为 true

# php - odbc_exec 与 odbc_excute

> ID：13503223
> 
> 赞同：4
> 
> 时间：2012-11-21T22:39:52.983
> 
> 标签：php, odbc

来自php手册：

> **odbc_exec** — 准备并执行 SQL 语句
> 
> **odbc_execute** — 执​​行准备好的语句

由**odbc_prepare准备**

那么有什么不同呢？为什么不直接使用**odbc_exec**呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-24T12:29:20.083

如果你想用不同的参数多次执行同一个语句，那么你准备一次，然后多次执行准备好的语句。某些 RDBMS 会在您准备语句时对其进行编译，这样可以在您执行时节省时间。当您有一个循环在具有不同参数的循环内执行相同的查询时，这很有用。

例如：

```
$stm = odbc_prepare($conn, 'INSERT INTO users (id, name, email) VALUES (?, ?, ?)');
foreach($users as $user) {
  $success = odbc_execute($stm, array($user['id'], $user['name'], $user['email']));
} 
```

# c - 从 libpcap 捕获的数据包中获取错误的 ip 和端口号

> ID：13503224
> 
> 赞同：0
> 
> 时间：2012-11-21T22:39:54.117
> 
> 标签：c, libpcap

我的 Ubuntu 虚拟机的 IP 地址是 192.168.1.110。其他一切看起来都很好。我不知道代码有什么问题。也许我使用了错误的包头结构？下面是我的代码和输出。同样，我的主机 IP 应该是 192.168.1.110 并且端口现在肯定是错误的。

```
sudo ./sniffall 0
84.72.137.105:38055  192.168.1.105:56652
192.168.1.105:56652  174.141.213.124:28073
84.72.137.105:38055  192.168.1.105:56652
192.168.1.105:56652  174.141.213.124:28073
84.72.137.105:38055  192.168.1.105:56652

#include <pcap.h>
#include <stdio.h>
#include <stdlib.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netinet/ip.h>
#include <netinet/if_ether.h>
#include <netinet/ether.h>
#include <sys/socket.h>
#include <netinet/tcp.h>

void getPacket(u_char *args, const struct pcap_pkthdr *pkthdr, const u_char *packet){
    struct ip *ip;
    struct tcphdr *tcp;
    ip = (struct ip*)(packet+sizeof(struct ether_header));
    tcp = (struct tcphdr*)(packet+sizeof(struct ether_header)+sizeof(struct ip));

    char* src = inet_ntoa(ip->ip_src);

    printf("%s:%d ",src,tcp->source);
    char* dst = inet_ntoa(ip->ip_dst);
    printf(" %s:%d\n", dst, tcp->dest);

}

int main(int argc, char *argv[]){
    char errbuf[PCAP_ERRBUF_SIZE], *device;
    device = argv[1];
    pcap_t *handle;
    handle = pcap_open_live(device, BUFSIZ, 1, 1000, errbuf);
    if(!handle){
        device = pcap_lookupdev(errbuf);
        handle = pcap_open_live(device, BUFSIZ, 1, 1000, errbuf);
        if(!handle){
                printf("Couldn't open device %s: %s\n", device, errbuf);
        }
    }

    pcap_loop(handle, 5, getPacket, NULL);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:28:57.260

如果您处于混杂模式，Pcap 将显示系统以外的其他流量。为什么您会看到未从您的系统发送或接收的特定数据包将取决于您的网络配置。如果某些以太网交换机不确定它们应该去哪里等，它们偶尔会泄漏发往其他系统的数据包。

您还需要在字节顺序之间进行转换。在现在最常见的情况下，“网络字节顺序”与您机器的字节顺序不同。要打印出端口号，您需要执行以下操作：

```
printf("%s:%d ",src,ntohs(tcp->source)); 
```

此外，您可能想尝试`struct iphdr`而不是`struct ip`. 我以前见过这样的例子，`ip`在标题中命名的结构有多个定义，但`iphdr`对我来说总是正确的。

请记住，您始终可以`tcpdump`在另一个窗口中运行以查看实际进入的数据包，您可能会收到比预期更多的流量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T19:00:40.933

首先，在调用之后`pcap_open_live()`，调用`pcap_datalink()`，`handle`如果它没有返回`DLT_EN10MB`，则退出或重写你的程序，以便它可以处理它返回的值。请参阅[tcpdump.org 链接层标头类型页面](http://www.tcpdump.org/linktypes.html)，了解`pcap_datalink()`.

其次，*不要*假设数据包是 IPv4 数据包，除非您安装了过滤器`"ip"`或检查了数据包类型（例如，以太网报头中的类型字段）以确保数据包是 IPv4 数据包。

第三，*不要*假设 IPv4 数据包的标头正好是`sizeof(struct ip)`字节长。我假设`sizeof(struct ip)`将是 20，这是 IPv4 标头的*最小*长度，但标头可能包含选项 - 检查 IPv4 标头的“标头长度”字段（以 4 字节字为单位，因此值为 5表示“20 字节”）并将其用作标头的长度（确保它至少为 5 - 如果小于 5，则数据包无效 - 然后乘以 4 以获得标头的长度）。

第四，*不要*假设数据包是 TCP 数据包，除非您安装了过滤器`"ip and tcp"`或仅安装了过滤器`"tcp"`（使用后者，您仍然需要检查自己是否是 IPv4 数据包）或检查了“协议” IPv4 标头的字段以确保其值为 6（对于 TCP）。

# c# - 如何更改 GeckoFx 代理设置？

> ID：13503226
> 
> 赞同：1
> 
> 时间：2012-11-21T22:40:02.940
> 
> 标签：c#, .net, proxy, geckofx

我正在使用 GeckoFx 1.9.1.0 版、Mozilla XULRunner 12.0 版。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T06:37:39.060

[代理用户名和 GeckoFX 通行证的帮助？](https://stackoverflow.com/questions/2958351/help-with-proxy-username-pass-with-geckofx) 请参阅此答案以编程方式设置代理。`GeckoPreferences.Save(string fileName)`您可以使用以下方法将首选项保存并加载到文件中`GeckoPreferences.Load(string fileName)`

使用 XULRunner 12，在使用 XULRunner 创建任何应用程序之前，您无法存储首选项（参见：[https](https://developer.mozilla.org/en-US/docs/Mozilla/Preferences/A_brief_guide_to_Mozilla_preferences) ://developer.mozilla.org/en-US/docs/Mozilla/Preferences/A_brief_guide_to_Mozilla_preferences ）

**在 xulrunner 默认配置文件中手动插入代理设置：(XULRunner ~1.9)**

转到 d:\path\to\xulrunner\defaults\pref

打开`xulrunner.js`，添加您想要放置的首选项。

现在，您可以按照文件末尾的以下示例调用添加首选项：

```
pref("network.proxy.http", "web-proxy.domain.com");
pref("network.proxy.http_port", 8080);
pref("network.proxy.type", 1); 
```

如果您不知道确切的偏好是什么，或者您想了解所有偏好，请使用您的`GeckoWebBrowser`，导航到`about:config`。

**例如：** `geckoWebWebBrowser.Navigate("about:config");`。

如果浏览器提示`"This'll Void Warranty"`，请单击`"I understand .."`。现在，您可以看到列出的所有首选项。

# angularjs - Angular.JS 是否添加 CSS 样式或更改现有样式？

> ID：13503231
> 
> 赞同：0
> 
> 时间：2012-11-21T22:40:39.903
> 
> 标签：angularjs

这是一个奇怪的问题，我们目前正在将现有的 CakePHP 应用程序移植到 Angular.JS，CSS 是相同的，总体上一切看起来都一样，但是有一些小的变化，例如字体类型或大小，也注意到间距的微小差异，填充和边距。

Angular 是添加 CSS 样式还是覆盖现有样式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T08:59:27.247

AngularJS 不添加任何样式元素，也不添加或删除任何内联样式。然而，它确实将类添加到 DOM 元素，例如 ng-scope、ng-binding..等，所有这些都带有“ng”前缀。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T21:57:20.267

Angular 确实添加了一些 CSS 样式，但没有什么可以解释您所看到的。

特别是，为了在通过 ngCloak 指令加载元素时隐藏元素，Angular 添加了一个类来将 display 属性设置为“none”。

[您可以在https://github.com/angular/angular.js/blob/master/css/angular.css](https://github.com/angular/angular.js/blob/master/css/angular.css)中查看 Angular 的 CSS 。

# c# - WPF 中 RepositionThemeTransition 的等价物

> ID：13503233
> 
> 赞同：0
> 
> 时间：2012-11-21T22:40:47.457
> 
> 标签：c#, .net, wpf, layout, windows-store-apps

在 Windows 商店应用程序中，可以将 RepositionThemeTransition 添加到 UI 元素，以便在它们的位置发生变化时使它们俯冲而不是传送。还有其他类型的过渡。

```
<Rectangle>
    <Rectangle.Transitions>
        <TransitionCollection>
            <RepositionThemeTransition/>
        </TransitionCollection>
    </Rectangle>
</Rectangle> 
```

WPF 似乎不支持此功能。有没有办法做等效的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:06:17.190

我认为您可能正在寻找的是[Blend 的 SDK](http://www.microsoft.com/en-us/download/details.aspx?id=10801)`FluidMoveBehavior`中的行为。网络上有几个教程可用 -如果您不熟悉行为或此特定行为，[这里有一个。](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2010/10/12/blend-bits-14-fluid-movement.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T19:27:55.737

我最终只是自己模拟了该功能，通过在最初抵消位置变化的 LayoutUpdated 事件中应用动画。这是代码：

```
public static void AddRepositionTransitionsUsingRenderTransform(this FrameworkElement control, bool x = true, bool y = true, CancellationToken lifetime = default(CancellationToken)) {
    if (control == null) throw new ArgumentNullException("control");
    var approachPeriod = TimeSpan.FromMilliseconds(100);

    // animate when positions change, to give a 'swooping' effect instead of teleporting
    var transform = new TranslateTransform();
    var oldPosition = May<Point>.NoValue;
    EventHandler updated = (sender, arg) => {
        // determine where the control has moved to
        var newPosition = control.ActualWidth == 0 || control.ActualHeight == 0 || control.Visibility != Visibility.Visible
                        ? May<Point>.NoValue
                        : control.TranslatePoint(new Point(-transform.X, -transform.Y), Application.Current.MainWindow);
        if (oldPosition == newPosition) return;

        // adjust the animation to initially cancel the change in position, and finish at the new final position after the approach period
        var dif = (from o in oldPosition
                    from n in newPosition
                    select new Point(n.X - o.X, n.Y - o.Y)
                    ).ElseDefault();
        if (x) transform.BeginAnimation(TranslateTransform.XProperty, new DoubleAnimation(transform.X - dif.X, 0, approachPeriod));
        if (y) transform.BeginAnimation(TranslateTransform.YProperty, new DoubleAnimation(transform.Y - dif.Y, 0, approachPeriod));

        oldPosition = newPosition;
    };

    // register for events and replace transform, until lifetime ends
    var oldTransform = control.RenderTransform;
    control.RenderTransform = transform;
    control.LayoutUpdated += updated;
    lifetime.Register(() => {
        control.LayoutUpdated -= updated;
        control.RenderTransform = oldTransform;
    });
} 
```

请注意，“May”是自定义选项类型，因此该部分不会编译。你可以使用类型点吗？相反，使用显式空检查而不是查询。

# java - Java在bash中设置类路径

> ID：13503238
> 
> 赞同：0
> 
> 时间：2012-11-21T22:41:23.583
> 
> 标签：java, bash

我在正确设置 -classpath 以使项目运行时遇到了一些麻烦：

我认为我应该做的事情：

```
java -classpath /path/to/classes package.Main 
```

到目前为止唯一有效的方法：

```
cd /path/to/classes
java -classpath . package.Main 
```

我也尝试过`-classpath /path/to/classes:.`

我需要能够从不同的目录运行该类，所以我不能使用对我有用的解决方案。

我显然在这里错过了一些非常愚蠢的东西。

编辑：我正在使用 cygwin

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:11:10.790

问题是在 cygwin 中处理类路径的方式：

由于 java 是一个 windows 程序，它无法识别我给出的 cygwin 路径。

解决方法是：

```
java -classpath `cygpath -wp /path/to/classes/` package.Main 
```

希望它可以帮助别人。

# c# - Ninject GetAll Where Module = foo

> ID：13503239
> 
> 赞同：0
> 
> 时间：2012-11-21T22:41:24.977
> 
> 标签：c#, .net, ninject

是否有可能做这样的事情：

`var foos = Kernel.where(c=>c.module == myModule).GetAll<foo>;`

一个人会怎么做呢？

If(!possible)
在使用 GetAll() 方法时，如何区分绑定到同一个接口？
我知道`WithParameter`,`WithMetadata`和`WithConstructorArgument`; `WithPropertyValue`我应该使用哪一个，为什么？

干杯

* * *

**更多信息**

我需要这个，因为我正在创建一个插件框架。在路由期间，插件框架需要能够确定要查看哪个控制器。如果插件中有多个家庭控制器，它将无法按预期工作。
我需要能够区分哪个插件注册了哪个 IController 实现，以便控制器工厂知道将请求发送到特定插件中的控制器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:03:42.253

您是否考虑过使用When()，因此您不必这样做？

IE

```
Bind<IInterface>().To<YourConcreteTypeOne>().When(r => r.Target.Name == "concreteObjectOne"); 
```

正如[在](https://stackoverflow.com/questions/2396285/ninject-2-0-binding-to-a-object-that-uses-the-same-interface-more-than-once)接受的解决方案（更新部分）中所建议的那样。理想情况下，您在设置绑定后不应该真的需要访问内核，否则您会将自己与 DI 框架紧密耦合。如果这不适用，请扩大您的问题以包含更多代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T06:03:20.777

一种简单的方法是定义一个接口，即`IControllerProvider`具有一个`Name`和一个`GetController`方法。您的核心产品加载所有扫描的 IControllerProvider 实现并获取控制器并使用名称和内核中的 Icontroller 实例注册它们。通过这种方法，您的插件可以使用它们自己的容器，或者干脆做可怜的人 DI。然后，您的路由处理程序可以获得一个`IEnumerable<IController>`. 或者更好地简单地将名称放在`IController`界面上，这样您就不需要回退到 ninject 元数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T01:57:50.060

我最终将元数据附加到每个：

```
Bind<IController>().To<MyController>()
   .Named(implementation.GetType().Name.Replace("Controller", string.Empty))
   .WithMetadata("Plugin", PluginName);` 
```

然后像这样路由我的插件：

```
routes.MapRoute(
                name: "Plugin1",
                url: "Plugin1/{controller}/{action}/{id}",
                defaults: new { Plugin = PluginName, controller = "Home", action = "Index", id = UrlParameter.Optional }
            ); 
```

并在控制器工厂的GetControllerType方法中

```
object requestedModule;
if (requestContext.RouteData.Values.TryGetValue("Plugin", out requestedPlugin))
    controller = kernel.GetAll<IController>(c => c.Name == controllerName && c.Get<string>("module", string.Empty) == (string)requestedPlugin).SingleOrDefault(); 
```

# php - Vide.js：更改菜单标题

> ID：13503240
> 
> 赞同：-1
> 
> 时间：2012-11-21T22:41:25.737
> 
> 标签：php, jquery, flash, video, video.js

我有用于流媒体视频的 video.js 插件，我想在选择语言菜单中更改标题。

```
http://pokit.org/get/img/ed8bb4b0a13769a3105b1b9111c2b635.jpg 
```

我想将“CAPTIONS”更改为“Languages”。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T01:41:53.150

我设法做到了。以下是 3.2.0 版的第 4307-4310 行`video.js`（就在分隔符“Captions Button”之后）：

```
menu.el.appendChild(_V_.createElement("li", {
   className: "vjs-menu-title",
   innerHTML: _V_.uc(this.kind)
})); 
```

改成：

```
menu.el.appendChild(_V_.createElement("li", {
   className: "vjs-menu-title",
   innerHTML: "Languages"
})); 
```

看图片：

[http://i46.tinypic.com/ir53sg.png](http://i46.tinypic.com/ir53sg.png)

# java - 如何在 JPA 中对结果查询进行分页？

> ID：13503241
> 
> 赞同：0
> 
> 时间：2012-11-21T22:41:27.943
> 
> 标签：java, hibernate, jpa, pagination

我正在尝试使用 JPA 实现分页功能，但遇到了麻烦。

我可以获取并设置链接上的第一个和最后一个数字，例如 localhost:8000/?first=11&last=20。

如您所见，我试图从第 11 行开始并在第 20 行结束，但是，我得到的所有结果都是从第一个开始但最后的总数例如从 10 开始但有 20 个结果相反到所需的 10。

我在用：

```
query.setFirstResult(firstRowNumber - 1).setMaxResults(lastRowNumber); 
```

因此，我如何限制我的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:48:31.523

你要这个：

```
query
  .setFirstResult(firstRowNumber - 1)
  .setMaxResults(lastRowNumber - firstRowNumber + 1); 
```

请注意，该方法名为`setMaxResults()`（总数），而不是`setLastResult()`. 看看很棒[的 spring-data-jpa](/questions/tagged/spring-data-jpa "显示标记为“spring-data-jpa”的问题")，它可以很好地处理分页。

# caching - “脏标志”/“脏值”是什么意思？

> ID：13503243
> 
> 赞同：23
> 
> 时间：2012-11-21T22:41:30.643
> 
> 标签：caching, computer-architecture, dirty-data

我在工作中的一些源代码和一些其他代码中看到了一些名为“脏”的变量。这是什么意思？什么是脏标志？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-21T22:44:51.073

通常，[*脏标志*](http://en.wikipedia.org/wiki/Dirty_flag#Dirty)用于指示某些数据已更改并最终需要写入某个外部目的地。它不是立即写入的，因为相邻的数据也可能会发生变化，并且写入大量数据通常比写入单个值更有效。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-10T00:20:16.493

这里有一个更深层次的问题——而不是“脏是什么意思？” 在代码的上下文中，我认为我们真的应该问 - '脏' 是一个合适的术语来表达通常的意图。

“肮脏”可能会造成混淆和误导。它会向许多新程序员建议损坏或错误的表单数据。工作“脏”意味着有问题，需要清除或删除数据。毕竟，肮脏的东西是不受欢迎的、不干净的和不愉快的。

如果我们的意思是“表单已被触动”或“表单已被修改但更改尚未写入服务器”，那么为什么不使用“触动”或“writePending”而不是“脏”？

我认为，这是编程社区需要解决的问题。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-21T22:44:40.253

肮脏可能意味着很多事情，您需要提供更多上下文。但在非常一般的意义上，“脏标志”用于指示是否已触摸/修改某些内容。

例如，请参阅[页面表 wiki中内存管理上下文中“脏位”的用法](http://en.wikipedia.org/wiki/Page_table)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-23T02:41:35.223

“脏”通常用于缓存的上下文中，从应用程序级缓存到架构缓存。

一般来说，有两种缓存机制：（1）直写；(2) 回写。我们简称 WT 和 WB。

**WT**意味着对缓存和后备存储的写入是**同步完成的。**（例如，通过说缓存和后备存储，它们可以分别代表数据库上下文中的主内存和磁盘）。

相反，对于**WB**，最初，**只**对缓存进行写入。对后备存储的写入被推迟，直到包含**数据**的缓存块即将被新内容修改/替换。

**数据**是脏值。在实现 WB 缓存时，您可以设置脏位来指示缓存块是否包含脏值。

# multithreading - 使用克隆线程的函数和变量空间

> ID：13503244
> 
> 赞同：0
> 
> 时间：2012-11-21T22:41:33.013
> 
> 标签：multithreading, memory, gcc, clone

我目前打算使用 clone() 实现线程，一个问题是，如果我让所有线程使用相同的内存空间，我在给定线程中调用的每个函数，当相同的函数时，每个线程是否会使用不同的内存部分打电话，还是我必须做一些事情来确保发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:15:32.180

每个线程总体上将使用相同的内存映射，但为函数调用使用不同的、单独的线程本地堆栈。当不同的线程调用了同一个函数（它本身位于同一个可执行内存位置）时，任何局部变量都不会被共享，因为它们在进入函数时/根据需要分配在堆栈上，并且每个线程都有自己的默认堆栈。

对任何静态/全局内存的引用（即，未在线程本地堆栈上分配的任何内容，例如全局变量或对`mmap`调用后传递给线程/对线程可见的堆或内存区域的引用`clone`，通常是完整的内存映射和进程上下文本身）当然会被共享，并受到通常的多线程问题（即共享状态的同步）的影响。

请注意，在调用`clone`. 从手册页：

> 该`child_stack`参数指定子进程使用的堆栈的位置。由于子进程和调用进程可能共享内存，因此子进程不可能与调用进程在同一个堆栈中执行。因此，调用进程必须为子堆栈设置内存空间，并将指向该空间的指针传递给`clone()`. 堆栈在所有运行 Linux 的处理器（HP PA 处理器除外）上向下增长，因此`child_stack`通常指向为子堆栈设置的内存空间的最高地址。

该`child_stack`参数是 的第二个参数`clone`。调用者（即父线程）有责任确保通过创建的每个子线程`clone`为其堆栈接收一个单独且不重叠的内存块。

请注意，分配和设置这个线程本地堆栈内存区域一点也不简单。确保您的分配是页面对齐的（起始地址在 4K 边界上）、页面大小 (4K) 的倍数、足够大（如果您只有几个线程，则 2MB 是安全的），并且理想情况下包含“可用空间后面的守卫”部分。堆栈保护是一些没有访问权限的页面 - 不读取，不写入 - 在主堆栈区域之后保护虚拟内存地址空间的其余部分，如果线程动态超过其堆栈大小（例如，有一堆递归或具有非常大的临时缓冲区作为局部变量的函数）并尝试继续增长到堆栈保护区域，这将提前失败，因为线程将立即获得 SIGSEGV 而不是阴险的破坏。堆栈保护在技术上是可选的。您可能应该使用`mmap`分配你的堆栈，虽然`posix_memalign`也可以。

说了这么多，我不得不问：为什么要尝试实现线程`clone`？这里有一些非常具有挑战性的问题，POSIX 线程库已经解决了这些问题（也以可移植的方式）。`clone`如果是您想要的细粒度控制，请检查`pthread_attr_*`功能；它们几乎涵盖了所有非晦涩的用例（例如，如果您愿意，允许您分配自己的堆栈——从之前的讨论中，我认为您不会）。非常高性能的通用 Linux 实现，除其他外，完全包装`clone`和大量其他与线程相关的令人发指的系统调用——其中许多甚至没有 C 库包装器，必须通过`syscall`. 这一切都取决于你想做什么。

# cakephp - 带有分页器和文章的嵌套类别的 SEO 路由

> ID：13503245
> 
> 赞同：2
> 
> 时间：2012-11-21T22:41:34.713
> 
> 标签：cakephp, tree, routes, slug, cakephp-2.2

具有嵌套类别的人类可读 URL，例如 /category/subcategory/n-subcategories/article。我正在使用 CakePHP 2.2.3 并且找不到路由问题的合适解决方案。使用 2 个表：

*   **文章**（也可以是产品或帖子或...）
    *   只有一个正常的“单一”视图
    *   一篇文章属于一个类别
*   **类别**
    *   嵌套（具有 n 级的树行为）
    *   一个类别可以有很多文章
    *   category-view 列出与该类别相关的所有文章
    *   类别视图使用分页器来显示文章列表

我猜是一个非常常见的例子。但是我现在如何定义路由器，以获取具有嵌套类别的 URL 路径，如下所示：

```
/categoryname1                                         (showing category view)
/categoryname1/articlename1                            (showing article view)
/categoryname2/articlename2                            (showing article view)
/categoryname2/subcategoryname1                        (showing category view)
/categoryname2/subcategoryname2/articlename4           (showing article view)
/n-categoryname/././...n-subcategoryname               (showing category view)
/n-categoryname/././...n-subcategoryname/n-articlename         (article view) 
```

我试图在 routes.php 中修复所有路由，但这不是很舒服，我认为应该有一个动态解决方案。

我还尝试自动生成类别和文章别名之外的所有路由并将它们保存在单独的“路由”数据库表中 - 它有效，但我认为没有必要定义单个路由的 hunderets？！

我还尝试定义路由器中修复的所有类别，例如

```
Router::connect(
  '/any-category-name',
  array('controller' => 'categories', 'action' => 'view', 1)
); 
```

然后是文章

```
Router::connect(
  '/any-category-name/:slug',
  array('controller' => 'articles', 'action' => 'view'),
  array('pass' => array('slug'))
); 
```

但是使用这种方法，所有文章都可以在所有类别中找到，这不是一个好的解决方案。我考虑过使用

```
Router::connect(
  '/:slug', ... 
```

但我不知道如何继续，因为可能有两个不同的控制器和两个不同的视图（我也不知道分页在这种情况下是否仍然有效以及会发生什么，如果我还想使用更多控制器/安装中的操作）。

我认为在 Cake 中使用两个控制器（类别和文章）获取嵌套 url 应该不难？！感谢您提供任何有用的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T10:42:18.737

我认为您必须检查两件事：

1）检查url中的类别数
2）检查最后一个参数是类别还是文章

在（动态）路由中处理这两项检查可能非常困难。我建议为所有这些请求创建一个路由，并在控制器中检查 1) 和 2)。

路线可能是这样的：

```
Router::connect(
  '/*',
  array('controller' => 'outputs', 'action' => 'index')
); 
```

我为这条路由 OutputController 调用了控制器，因为这将是处理所有这些 url 的输出的控制器。

```
class OutputController extends AppController
{
  public $uses = array('Article', 'Category');

  public function index()
  {
    // Get n parameters from url (1)
    $args = func_get_args();
    $last_arg = $args[count($args) - 1];

    // Check if this is an article (2)
    $article = $this->Article->find('first', array(
      'conditions' => array('Article.slug' => $last_arg
    ));
    if (!empty($article)) {
      $this->set('article', $article);
      $this->render('article');
    }

    // Check if this is an category (2)
    $category = $this->Category->find('first', array(
      'conditions' => array('Category.slug' => $last_arg
    ));
    if (!empty($category)) {
      $this->set('category', $category);
      $this->render('category');
    }

    // Page not found
    if (empty($article) and empty($category)) {
      throw new NotFoundException();
    }
  }

  // ... 
```

为了显示一篇文章，使用了“Output/article.ctp”视图。对于一个类别，CakePHP 呈现“Output/category.ctp”。此外，您可以使用 $args 中的参数为您的（子）类别获取所有必要的数据。

# box-api - 从 Box 下载的照片使用低于原始分辨率的分辨率

> ID：13503250
> 
> 赞同：0
> 
> 时间：2012-11-21T22:41:45.290
> 
> 标签：box-api

是否可以使用 Box API v1 从 Box 文件夹下载低于原始分辨率的照片？我知道可以下载存储在 Box 中的正常和更大的缩略图版本的照片。但是有没有办法下载比缩略图大、分辨率比原始分辨率低的照片呢？在移动应用程序中通过 3G 下载全分辨率照片会破坏用户体验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:57:08.757

除了使用缩略图之外，目前在 v1 API 中没有办法做到这一点。

# ruby-on-rails - has_many 关系轨 3

> ID：13503254
> 
> 赞同：0
> 
> 时间：2012-11-21T22:41:51.970
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, has-many-through, has-many

嗨，我有三个表，如下所示：

```
 class Workitem < ActiveRecord::Base
      has_many :effort
      attr_protected
    end

    class Effort < ActiveRecord::Base
      attr_protected
      belongs_to :workitem
      belongs_to :person
    end

    class Person < ActiveRecord::Base
      attr_accessible :given_name, :mgrid, :surname, :id
      has_many :effort
    end 
```

这个想法是通过努力表来跟踪一个人在特定工作项目上花费了多少天。有人可以验证我的关系是否正确吗？但这似乎不起作用。我在这里错过了什么吗？另外，我无法理解`has_many :through`那种关联。如果这是我应该在这种情况下使用的，有人可以给我一个想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:04:59.827

您通常会将孩子作为复数对象：

```
class Workitem < ActiveRecord::Base
  has_many :efforts
  attr_protected
end

class Person < ActiveRecord::Base
  attr_accessible :given_name, :mgrid, :surname, :id
  has_many :efforts
end 
```

我建议使用 attr_accessible 而不是 attr_protected

如果一个 Foo 有许多 Bars 并且这些 Bars 属于许多 Foos，它可能看起来像这样：

```
class Foo < ActiveRecord::Base
  has_many :foo_bar
  has_many :bars, through => :foo_bar
end

class Bar < ActiveRecord::Base
  has_many :foo_bar
  has_many :foos, through => :foo_bar
end

class FooBar
  belongs_to :foo
  belongs_to :bar
end 
```

反正是这样的。这里有很多关于[Railcasts的帮助](http://railscasts.com/)

此外，还有一万亿个关于 SO 的示例。

希望有帮助

# sql - 使用更新 SQL Server 生成计数器

> ID：13503260
> 
> 赞同：0
> 
> 时间：2012-11-21T22:42:40.223
> 
> 标签：sql, sql-server-2008, sql-server-2008-r2

我有这个 T-SQL 代码：

```
DECLARE @DtsAcumGPSData VARCHAR (50);
SET @DtsAcumGPSData='To'+ @NAutobus + 'DtsAcumGPSData'
--
DECLARE @SQL_DtsAcumGPSData NVARCHAR(MAX);

SET @SQL_DtsAcumGPSData = N'SELECT 
      COUNTER = 0
      ,[iID]
      ,[iVehicleID]
      ,[fTripDistance]
      ,[dtDateTime]
      ,[fLongitude]
      ,[fLatitude]
      ,[bLatLongValid]
      ,[fSpeed]
      ,[bIgnition]
      ,[bStopFlag]
      ,[fTripTime]
      ,[bWorkHours]
      ,[iLogReason]
      ,[bLatLongValidGuess]
      ,[bAux1]
      ,[bAux2]
      ,[bAux3]
      ,[bAux4]
      ,[bAux5]
      ,[bAux6]
      ,[bAux7]
      ,[bAux8]
INTO '+ @DtsAcumGPSData +
N' FROM GPSData 
WHERE iVehicleID ='+ @NAutobus + --245
N'ORDER BY dtDateTime';
EXEC sp_executesql @SQL_DtsAcumGPSData;

-- ##########################################################
-- ACTUALIZANDO CONTADOR
DECLARE @COUNTER INT
SET @COUNTER = 0
DECLARE @SQL_UPDATE_DtsAcumGPSData NVARCHAR (MAX)
SET @SQL_UPDATE_DtsAcumGPSData=
N'UPDATE ' +@DtsAcumGPSData+ N'
SET '+ @COUNTER +N'= COUNTER = ' +@COUNTER+1
EXECUTE sp_executesql @SQL_UPDATE_DtsAcumGPSData 
```

我收到此错误：

> *消息 245，级别 16，状态 1，过程 AutobusGenerico，第 46 行将
> nvarchar 值“UPDATE To245DtsAcumGPSData SET”转换为数据类型 int 时转换失败*

有任何想法吗？

我想为列设置一个计数器`COUNTER`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:45:06.603

当您使用[Dynamic SQL](http://www.sommarskog.se/dynamic_sql.html)时，您的查询是一个字符串，因此当您将一个数值连接到它时，您必须使用`convert`它，否则您将收到错误。

您的`@Counter`值是`int`并且需要将它们转换为包含在您的查询字符串中：

```
DECLARE @COUNTER INT
SET @COUNTER = 0
DECLARE @SQL_UPDATE_DtsAcumGPSData NVARCHAR (MAX)
SET @SQL_UPDATE_DtsAcumGPSData=
N'UPDATE ' +@DtsAcumGPSData+ N'SET '+ cast(@COUNTER as varchar(50)) +N'= COUNTER = ' +cast(@COUNTER+1 as varchar(50))
EXECUTE sp_executesql @SQL_UPDATE_DtsAcumGPSData 
```

与此行相同 - 似乎`@NAutobus`是`int`：

```
WHERE iVehicleID ='+ convert(@NAutobus as varchar(50)) 
```

这些字段必须转换为字符串才能连接到您的查询字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:46:58.227

除非将数字转换为文本，否则不能将数字与文本连接

```
SET @DtsAcumGPSData='To'+ CAST(@NAutobus AS VARCHAR) + 'DtsAcumGPSData' 
```

和

```
INTO '+ CAST(@DtsAcumGPSData AS VARCHAR) + 
```

和

```
WHERE iVehicleID ='+ CAST(@NAutobus AS VARCHAR) + 
```

# ruby-on-rails - AWS 上的 Zeroclipboard 参考错误

> ID：13503262
> 
> 赞同：0
> 
> 时间：2012-11-21T22:42:43.447
> 
> 标签：ruby-on-rails, amazon-ec2, zeroclipboard, referenceerror

我在 /vendor/assets/javascripts/ 中有一个 ZeroClipboard.js。在本地桌面上，它可以完美运行。

在 AWS 上，它给了我错误：

```
GET /assets/ZeroClipboard-04f1243b0e15a4af694be581f7c87be8.js 404 (Not Found) 
```

和

```
Uncaught ReferenceError: ZeroClipboard is not defined 
```

为什么找不到 ZeroClipboard？例如，它可以找到位于 /app/assets/javascripts/ 中的 application.js。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T05:48:28.717

这意味着该对象在 S3 中不存在（再次检查路径和文件名）或者您没有为其设置适当的权限。转到 Amazon 控制台、S3 资源管理器，单击文件并编辑权限，以便所有人都可以查看。

# javascript - javascript视觉工作室制作一个对象

> ID：13503264
> 
> 赞同：3
> 
> 时间：2012-11-21T22:42:44.823
> 
> 标签：javascript, visual-studio-2010

我正在尝试通过 Visual Studio 在 javascript 中简单地制作一个对象。我在函数中被调用的语法很简单：

```
var d = new Object();
d.id = 8; 
```

当我从 Visual Studio 启动我的页面并单击我的按钮来触发其中包含这 2 行代码的函数时，我在 d.id 处收到一个错误，其中 d 仍然显示为未定义。我只想要一个可以为其分配属性的通用对象。我错过了什么？

没有更多的代码可以显示。截至目前的总功能：

```
function btnTest_onClick() {

    var d = new Object();
    d.id = 8;
} 
```

在我的 default.aspx 中，我删除了标签，因为 stackoverflow 似乎不喜欢它们

```
<input id="Button1" type="button" value="button" onclick="btnTest_onClick()" /> 
```

我只是想学习这些东西，所以我从非常基础和小的开始。这对我来说真的没有意义。该函数被调用得很好。

确切的错误是：JavaScript 运行时错误：无法设置未定义或空引用的属性“id”

整个 HTML 页面。这实际上是项目-> 新网站，然后添加一个按钮。

```
<%@ Page Title="Home Page" Language="VB" MasterPageFile="~/Site.Master"     AutoEventWireup="false"
    CodeFile="Default.aspx.vb" Inherits="_Default" %>

<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
    <script src="Scripts/jquery-1.4.1.js" type="text/javascript"></script>
    <script src="Scripts/Process.js" type="text/javascript" language="javascript">    </script>
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
    <h2>
        Welcome to ASP.NET!
    </h2>
    <p>
        To learn more about ASP.NET visit <a href="http://www.asp.net" title="ASP.NET Website">www.asp.net</a>.</p>
    <p>
        &nbsp;<input id="Button1" type="button" value="button" onclick="btnTest_onClick()" /></p>
    <p>
        You can also find <a href="http://go.microsoft.com/fwlink/?LinkID=152368&amp;clcid=0x409"
            title="MSDN ASP.NET Docs">documentation on ASP.NET at MSDN</a>.
    </p>
</asp:Content> 
```

# c# - ASP.NET 网站在 IE10 上看起来不同

> ID：13503267
> 
> 赞同：0
> 
> 时间：2012-11-21T22:42:54.010
> 
> 标签：c#, asp.net, css, vb.net, visual-studio

我有一个在 IE9 以及最新版本的 Firefox 和 Chrome 上看起来不错的 asp.net 网站。

出于某种原因，该网站在 IE10 上看起来不正确。字体太大，列设置为“不换行”的 html 表格被换行，等等。

单击 IE10 的“兼容性按钮”无济于事。字体大小可能会恢复正常，但会出现其他问题，例如图像或菜单不合适等。

我尝试覆盖兼容模式，但无济于事：

```
<meta http-equiv=“X-UA-Compatible” content=“IE=9” /> 
```

我还可以做些什么？

**编辑：**找到解决方案。应用了此处描述的修补程序：http: [//support.microsoft.com/kb/2600088](http://support.microsoft.com/kb/2600088)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:49:18.153

相当广泛的问题，但我建议您使用以下网站逐个检查每个有问题的元素并检查它们对 IE10 的兼容性：

[我可以用吗...](http://caniuse.com/)

它包含在桌面和移动浏览器中支持 HTML5、CSS3、SVG 等的兼容性表。我建议您使用类似 Firefox Web Dev Toolbar 插件来检查您的页面元素：

[切换 Web 开发人员工具栏](https://addons.mozilla.org/en-US/firefox/addon/toggle-web-developer-toolbar/)

# arrays - 从示例代码实现 CUDA VecAdd

> ID：13503272
> 
> 赞同：6
> 
> 时间：2012-11-21T22:43:11.560
> 
> 标签：arrays, c, parallel-processing, cuda, gpu

我正在尝试测试来自 CUDA 站点[http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#kernels](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#kernels)的示例代码。

我只想添加两个大小为 4 的数组 A 和 B，并将其存储在数组 C 中。这是我目前所拥有的：

```
#include <stdio.h>
#include "util.h"
void print_array(int* array, int size) {
int i;
for (i = 0; i < size; i++) {
    printf("%d ", array[i]);
}
printf("\n");
}

__global__ void VecAdd(int* A, int* B, int* C) {
int i = threadIdx.x;
C[i] = A[i] + B[i];
}

int main(int argc , char **argv) {
int N = 4;
    int i;
int *A = (int *) malloc(N * sizeof(int));
int *B = (int *) malloc(N * sizeof(int));
int *C = (int *) malloc(N * sizeof(int));

for (i = 0; i < N; i++) {
    A[i] = i + 1;
    B[i] = i + 1;
}

print_array(A, N);
print_array(B, N);

VecAdd<<<1, N>>>(A, B, C);
print_array(C, N);
    return 0;
} 
```

我期望 C 数组（输出的最后一行）为 2、4、6、8，但似乎没有添加：

```
1 2 3 4
1 2 3 4
0 0 0 0 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:59:02.423

您需要在 GPU 之间来回传输内存，例如

```
 int *a_GPU, *b_GPU, *c_GPU;

    cudaMalloc(&a_GPU, N*sizeof(int));
    cudaMalloc(&b_GPU, N*sizeof(int));
    cudaMalloc(&c_GPU, N*sizeof(int));

    cudaMemcpy(a_GPU, A, N*sizeof(int), cudaMemcpyHostToDevice);
    cudaMemcpy(b_GPU, B, N*sizeof(int), cudaMemcpyHostToDevice);

    VecAdd<<<1, N>>>(a_GPU, b_GPU, c_GPU);

    cudaMemcpy(C, c_GPU, N*sizeof(int), cudaMemcpyDeviceToHost);

    print_array(C, N);

    cudaFree(a_GPU);
    cudaFree(b_GPU);
    cudaFree(c_GPU); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T23:28:08.423

首先，您必须定义将保存要复制到 GPU 的数据**的指针：**

在您的示例中，我们要将数组 'a'、'b' 和 'c' 从复制`CPU`到`GPU's`全局内存中。

```
int a[array_size], b[array_size],c[array_size]; // your original arrays
int *a_cuda,*b_cuda,*c_cuda;                    // defining the "cuda" pointers 
```

定义每个数组将占用的大小。

```
int size = array_size * sizeof(int); // Is the same for the 3 arrays 
```

然后将空间分配给将在 cuda 中使用的数据：

**Cuda内存分配**：

```
msg_erro[0] = cudaMalloc((void **)&a_cuda,size);
msg_erro[1] = cudaMalloc((void **)&b_cuda,size);
msg_erro[2] = cudaMalloc((void **)&c_cuda,size); 
```

现在我们需要将这些数据从 CPU 复制到 GPU：

**从 CPU 复制到 GPU**：

```
msg_erro[3] = cudaMemcpy(a_cuda, a,size,cudaMemcpyHostToDevice);
msg_erro[4] = cudaMemcpy(b_cuda, b,size,cudaMemcpyHostToDevice);
msg_erro[5] = cudaMemcpy(c_cuda, c,size,cudaMemcpyHostToDevice); 
```

**执行内核**

```
int blocks = //;
int threads_per_block = //;
VecAdd<<<blocks, threads_per_block>>>(a_cuda, b_cuda, c_cuda); 
```

将结果**从 GPU 复制到 CPU**（在我们的示例数组 C 中）：

```
msg_erro[6] = cudaMemcpy(c,c_cuda,size,cudaMemcpyDeviceToHost); 
```

**空闲内存：**

```
cudaFree(a_cuda);
cudaFree(b_cuda);
cudaFree(c_cuda); 
```

出于调试目的，我通常将函数的状态保存在数组中，如下所示：

```
cudaError_t msg_erro[var]; 
```

但是，这并不是绝对必要的，但如果在分配或内存转移期间发生错误，它将为您节省时间。如果您愿意，可以从上面的代码中取出所有的 'msg_erro[x] ='。

如果您维护 'msg_erro[x] ='，并且如果确实发生错误，您可以使用如下函数来打印这些错误：

```
void printErros(cudaError_t *erros,int size)
{
 for(int i = 0; i < size; i++)
      printf("{%d} => %s\n",i ,cudaGetErrorString(erros[i]));
} 
```

# android - startService 如果当前正在运行，请重新启动我的服务，Android 文档说相反

> ID：13503273
> 
> 赞同：0
> 
> 时间：2012-11-21T22:43:15.657
> 
> 标签：android, service

在我的服务中，我从互联网上下载了很多东西，并希望每 x 小时执行一次（在首选项中选择）

我在主 Activity 中用这段代码编写的当前实现：

```
 Intent svc = new Intent(this, AlarmService.class);

    if (startService(svc)!=null) {
        Log.i(this.getClass().toString(), "Service already running");
    } else {
        Log.i(this.getClass().toString(), "Service Started");
    } 
```

因为，根据[文档](http://developer.android.com/reference/android/content/Context.html#startService%28android.content.Intent%29)

> 请求启动给定的应用程序服务。Intent 可以包含要启动的特定服务实现的完整类名，也可以包含要启动的服务种类的操作和其他字段的抽象定义。如果此服务尚未运行，它将被实例化并启动（如果需要，为它创建一个进程）；**如果它正在运行，那么它仍然在运行**。

我强调的最后一句话让我希望我可以在服务的 onCreate 中编写所有繁重的代码并且它不会受到影响，但不幸的是，每次用户启动应用程序时，服务都会再次启动并进行大量下载，耗尽电池。

服务是否正在运行的指示是否正确：

> 返回 如果服务正在启动或已经在运行，则返回实际启动的服务的 ComponentName；否则，如果服务不存在，则返回 null。

所以，我的问题是，如果服务已经启动，如何让服务保持不变，如果尚未启动，如何启动它？

谢谢

编辑：

服务从未停止：

```
public class AlarmService extends Service {

    Alarm alarm = new Alarm();

    public void onCreate() {
        super.onCreate();
        Log.i("**", "onCreate");
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.i("LocalService", "Received start id " + startId + ": " + intent);
        // DO NOTHING FOR TESTING alarm.SetAlarm(this);
        return START_STICKY;
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:48:20.470

> 在我的服务中，我从互联网上下载了很多东西，并希望每 x 小时执行一次（在首选项中选择）

希望您使用`IntentService`（可能是[我的`WakefulIntentService`](https://github.com/commonsguy/cwac-wakeful)）和`AlarmManager`.

> 我强调的最后一句话让我希望我可以在服务的 onCreate 中编写所有繁重的代码并且它不会受到影响，但不幸的是，每次用户启动应用程序时，服务都会再次启动并进行大量下载，耗尽电池。

那是因为服务已经停止（通过`stopService()`或`stopSelf()`），或者因为您的应用程序的进程已终止。

> 如果已经启动，如何让服务保持不变，如果尚未启动，如何启动它？

呼叫`startService()`，如文档所示。

但是，如果您真的在尝试“每 x 小时执行一次”，那么如果您的服务在此期间*没有*浪费 RAM 试图坚持下去，那么用户将非常感激。因此，用户或操作系统很可能会在“x 小时”内摆脱您的进程。如果您不想每“x 小时”进行一次“大量下载”，那么您需要将该信息本地保存到某种文件中。

# function - matlab中find函数的意外结果

> ID：13503275
> 
> 赞同：2
> 
> 时间：2012-11-21T22:43:20.373
> 
> 标签：function, matlab, find

```
t=find(str.tubetime >= str.time,1); 
```

假设 tubetime 是 1 x 1001 个元素的矩阵 假设 time 是 double =0.0012

根据我对代码的理解，它找到了 tubetime 矩阵的第一个值，该值等于或大于返回该值在 tubetime 中的位置的索引。

如果我是正确的，为什么我的索引值为 244。当 0.0012 的值包含在从 231 到索引点 250 的索引点处时。

**编辑：**

我刚刚仔细检查了我的变量是否准确，因为我目前处于调试模式，并从系统中读取它。感谢您的意见，您知道它可能有什么问题吗？

这是显示值的屏幕截图

![截屏](../Images/62252dcd1d7a67e409bc70ced043082f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:12:14.227

当您在 printscreen 中查看值时，它可能会在小数点后 4 位后被截断。请参阅我上面对您原始帖子的评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:50:16.813

您对 FIND 的描述是正确的，但您的变量之一与您描述的不同。例如，

```
t=find([1 1 2 3 4 5 6] >= 3,1) 
```

返回 4，因为它应该。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:07:04.363

您已明确要求它在您的语法中只返回一个元素

```
time = zeros(1,1001);
time(231:250) = 0.0012 % setting an array where indices 231 - 250 are 0.0012 else is zero
find(time>=0.0012)
% gives all indices
find(time>=0.0012,1)
%returns 231 only
find(time>=0.0012,2)
%returns 231,232 
```

PLUS 检查这些值是否以短格式显示，即它们是 0.001199 但显示为 0.0012。

# java - 换行 \n 在 JButton.setText("fnord\nfoo") 中不起作用；

> ID：13503280
> 
> 赞同：11
> 
> 时间：2012-11-21T22:43:35.943
> 
> 标签：java, swing, awt, jbutton, multiline

在 JButton 上，我想在多行上列出信息。我尝试`\n`作为换行符，但没有用。以下代码：

```
JButton.setText("fnord\nfoo") ; 
```

将显示为：

```
fnordfoo 
```

如何强制换行？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-21T22:43:35.943

JButton 接受 HTML，因此要使换行符起作用，请使用：

```
 JButton.setText("<html>fnord<br />foo</html>"); 
```

# java - 他们是让子类使用在父类中创建的变量的一种方法吗？

> ID：13503283
> 
> 赞同：0
> 
> 时间：2012-11-21T22:43:38.503
> 
> 标签：java, parent-child

我有一个子类来处理拖到屏幕上的图像。它将每个图像的名称和 x、y 位置存储在变量中。然后它有一种方法来缩放它们并执行其他操作。

我想有 2 个这样的类，但图像名称和 x、y 位置会不同。

我首先尝试创建一个将此类作为子类的类。在这个父类中，我尝试创建相同的变量，希望它会使用这些变量，而不是在子类中创建的变量。

子类仍然使用在其中创建的变量，而不是在父类中。

有没有办法做到这一点，还是我爬错了树？

```
public class cShapeParent extends cShapes {

    // would like the base class to use this data
    String[] mNames=
    {
        "ball_green.png",
        "ball_green.png",
        "ball_green.png"    
    };

    cShapeParent(Context context,int screenWidth, int screenHeight)
    {
        super(context, screenWidth, screenHeight);
    }
} 
```

儿童班

```
import java.io.IOException;
import java.io.InputStream;

import android.content.Context;
import android.content.res.AssetManager;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Rect;

public class cShapes {
    public 

    String[] mNames=
    {
        "ball_green.png",
        "ball_red.png",
        "ball_blue.png" 
    };

    int[] mX={200,300,400};
    int[] mY={200,200,200};
    int[] mW={0,0,0};
    int[] mH={0,0,0};

    int Amount=3;
    int MyScreenWidth=512;

    int[] BitMapId={ 
        R.drawable.ball_green,  R.drawable.ball_red,
        R.drawable.ball_blue,  R.drawable.ball_green
    };

    Bitmap MyImages[];
    Rect[] mBitmapSize;

    cShapes(Context context,int screenWidth, int screenHeight)
    {
        // Load in bitmaps
        MyImages=new Bitmap[4];

        AssetManager assetManager= context.getAssets();
        InputStream inputStream;
        mBitmapSize = new Rect[Amount];
        try {
            // set scaling ratio
            float r=(float)MyScreenWidth / (float)screenWidth;
            for(int i=0;i<Amount;i++)
            {
                inputStream=assetManager.open( mNames[i]);
                MyImages[i]=BitmapFactory.decodeStream(inputStream);

                int w=(int)( (float)MyImages[i].getWidth()*r);
                int h=(int)( (float)MyImages[i].getWidth()*r);
                mBitmapSize[i]=new Rect(0,0,w,h);
                mW[i]=w; mH[i]=h;

                mX[i]=(int) ( (float)mX[i]*r);
                mY[i]=(int) ( (float)mY[i]*r);

                inputStream.close();
            }
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }  
    }

    boolean Intersect(int id, int x,int y)
    {
        if ( x >= mX[id] && x <= mX[id]+128 && y >= mY[id] && y <= mY[id]+128 ) 
            return true;

        return false;
    }
}  // end class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:49:18.773

如果我正确理解你的问题，你想从你的子类访问你的超类中定义的变量。如果那是您的问题，那么是的，可以使用 super 关键字。

```
class Super{
public int i;
}
class Sub extends Super {
   public void method() {
    System.out.println(super.i); // you can access i as it is overriden by sub
   } 
} 
```

请注意，`i`即使没有**super**关键字，您也可以直接访问，我只是将其包括在内以使其更具表现力。但是，您只能`i`在未声明为时访问此示例`private`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:02:38.567

等等，您是否希望 Child ( `cShapeParent`) 类创建并保留 Parent ( `cShapes`) 类可以引用的变量？在这种情况下，我会遵循这种模式：

```
public class Child extends Parent {

    private String[] mNames= {
    "ball_green.png",
    "ball_red.png",
    "ball_blue.png" 
    };

    protected String[] getNames() {
        return mNames;
    }

}

public abstract class Parent {

    protected abstract ListString[] getNames();

    public void doX() {
        ...
        String[] names = getNames();
        ...
    }
} 
```

# python - Python 无法在内置自定义模块的 Linux 上编译

> ID：13503284
> 
> 赞同：0
> 
> 时间：2012-11-21T22:43:39.543
> 
> 标签：python, gcc, makefile, python-2.6

我正在尝试使用内置的自定义模块编译 Python 2.6.7，但遇到了问题。一切都很好，直到链接器尝试链接我的模块所具有的依赖项。make 文件生成得很好，安装库的路径是正确的。我配置 Python 以使用我的自定义模块进行编译的方式是这样的：

```
_myplugin _myplugin.c++ -I/home/me/Desktop/Depends/include -L/home/me/Desktop/Depends/lib -l libcrvs_pic.a -l libsb_pic.a -l liblmgr_dongle_stup_pic.a 
```

构建在此行失败：

```
/usr/bin/ld: cannot find -llibcrvs_pic.a 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:55:49.413

我认为您需要做的是指定没有`lib`前缀的库，也没有`.a`后缀。

像这样：

```
-lcrvs_pic 
```

# php - wordpress if ( have_posts() ) ，循环不工作

> ID：13503287
> 
> 赞同：2
> 
> 时间：2012-11-21T22:44:06.940
> 
> 标签：php, wordpress

只是想知道任何人都可以看到这段代码有什么问题。它在开发版本上完美运行，这是一个精确的副本。

我认为这可能是循环中的某些东西，但我什至`echo 'hello';`在 the 之后直接尝试了`if ( have_posts () ) :`，但什么也没出现，但我在`if`它出现之前立即做了同样的事情。

这是整体代码....

```
if ( have_posts() ) : 
            $the_query = new WP_Query( array ( 'posts_per_page' => 1, 'p' => 4998 ) ); /*  */
             while ($the_query->have_posts() ) : $the_query->the_post(); 
              the_content();
             endwhile;
                wp_reset_postdata();

                endif; 

            ?> 
```

谢谢你的帮助。

编辑：抱歉，如果我的问题听起来含糊不清，基本上什么不起作用是即使帖子 ID 是正确的，也没有出现任何其他关于 CSS 等问题的原因。即使在尝试只在 之后显示“你好”之类的词之后`if`，仍然没有。我只是对为什么这会突然停止工作感到困惑。再次感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:49:23.167

是的，我检查过。在您创建的查询上使用 have_posts()（在外部创建查询`if`）

[http://codex.wordpress.org/Class_Reference/WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)

作为全局调用，have_posts() 检查页面是否配置正确，是否有帖子。

# node.js - 列出降价文件

> ID：13503299
> 
> 赞同：1
> 
> 时间：2012-11-21T22:45:01.973
> 
> 标签：node.js, markdown

所以我决定重做一个博客并使用降价，我在一个名为 blog 的文件夹中有三个降价文件，我想按日期顺序列出它们。问题是我不确定我做了什么来搞砸我的阵列。

这是我的 routes.js 文件

```
exports.list = function(req, res){
  var walk = require('walk'), fs = require('fs'), options, walker;
  var walker = walk.walk('blog');
  var fs = new Array();
  walker.on("file", function(root,file,next){
    var f = root + "/" + file['name'].substring(0, file['name'].lastIndexOf('.'));
    // push without /blog prefix
    if (file['name'].substr(-2) == "md") {
        fs.push(f.substring(f.indexOf('/')));
        console.log(fs);

    }
    next();
  });
  walker.on("end", function() {
      var model = {
            layout:'home.hbs',
            title: 'Entries',
            files: fs
        };
    res.render('home.hbs', model)
  });
}; 
```

但我在终端返回的是：

```
[ '/first' ]
[ '/first', '/second' ]
[ '/first', '/second', '/third' ] 
```

假设我只想显示前两个并让它们在降价文件中按日期排序，如下所示：

```
Title:  Lorem Ipsum dolor sit amet
Date:   January 2d, 2012

# test message 
```

我的数组/其余代码有什么问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T03:37:28.977

我注意到的第一件事是重新声明`fs`变量。第 2 行是 Node 的文件系统模块，第 4 行是（如果你问我`new Array()`应该是）。`[]`

我也不确定什么是`walker`模块，因为它的[github repo](https://github.com/nshah/nodejs-walker)被删除并且[npm 包](https://npmjs.org/package/walker)已经过时，我建议你使用原始[文件系统模块](http://nodejs.org/api/fs.html)API 来列出文件，可能是[路径模块](http://nodejs.org/api/path.html)来处理你的文件位置和一些[异步](https://github.com/caolan/async)来粘合它一起：

```
// `npm install async` first.
// https://github.com/caolan/async
var fs    = require('fs');
var async = require('async');

// Lists directory entries in @dir,
// filters those which names ends with @extension.
// calls callback with (err, array of strings).
//
// FIXME:
// Mathes directories - solution is fs.stat()
// (could also sort here by mtime).
function listFiles(dir, extension, callback) {
  fs.readdir(dir, function(err, files) {
    if (err) {
      console.error('Failed to list files in `%s`: %s', dir, err);
      return callback(err);
    }

    var slicePos = -extension.length;
    callback(null, files.filter(function(filename) {
      return (extension == filename.slice(slicePos))
    }));
  });
}

// Sorts markdown based on date entry.
// Should be based on `mtime`, I think,
// since reading whole file isn't great idea.
// (See fs.Stats.)
// At lease add caching or something, you'll figure :)
//
// Also, you better get yourself a nice markdown parser,
// but for brevity I assume that first 2 lines are:
// Title:  Some Title
// Date:   Valid Javascript Datestring
function sortMarkdown(pathes, callback) {
  async.sortBy(pathes, function(fileName, cb) {
    // Following line is dirty!
    // You should probably pass absolute pathes here
    // to avoid errors. Path and Fs modules are your friends.
    var md = __dirname + '/blogs/' + fileName;

    fs.readFile(md, 'utf8', function(err, markdown) {
      if (err) {
        console.error('Failed to read `%s`: %s', md, err);
        return cb(err);
      }

      // Get second line of md.
      var date = markdown.split('\n')[1];

      // Get datestring with whitespaces removed.
      date = date.split(':')[1].trim();

      // Get timestamp. Change with -ts
      // to reverse sorting order.
      var ts = Date.parse(date);

      // Tell async how to sort; for details, see:
      // https://github.com/caolan/async#sortBy
      cb(null, ts);
    });
  }, callback);
}

function listSortedMarkdown(dir, callback) {
  // Async is just great!
  // https://github.com/caolan/async#waterfall
  async.waterfall([
    async.apply(listFiles, dir, '.md'),
    sortMarkdown,
  ], callback);
}

listSortedMarkdown(__dirname + '/blogs', function(err, sorted) {
  return err ? console.error('Error: %s', err)
             : console.dir(sorted);
}); 
```

# objective-c - 如何覆盖 MacOS 上特权位置的只读文件？

> ID：13503306
> 
> 赞同：2
> 
> 时间：2012-11-21T22:45:20.553
> 
> 标签：objective-c, macos, authorization, hosts, hosts-file

我正在编写一个需要覆盖只读文件的应用程序。特别是 /etc/hosts 文件。为此，我需要获得用户的许可才能获得 root 访问权限，从而获得覆盖主机文件的权限。

我在整个互联网上进行了搜索，但我无法理解如何做到这一点。我意识到曾经为此使用了一个名为 AuthorizationExecuteWithPrivileges() 的方法，但它在 OSX 10.7 中已被弃用。然后我遇到了一个叫SMJobBless的东西，但我真的不明白它的概念吗？

那么你能解释一下如何以正确的方式解决我的问题吗？

问候，拉斯穆斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:04:26.610

[http://atnan.com/blog/2012/02/29/modern-privileged-helper-tools-using-smjobbless-plus-xpc/](http://atnan.com/blog/2012/02/29/modern-privileged-helper-tools-using-smjobbless-plus-xpc/)

SMJobBless + XPC 是一个 os x 10.7+ 解决方案，可满足您的需求。

提供的链接也包含显示示例的源代码。

# macos - 在applescript中将文本设置为剪贴板

> ID：13503308
> 
> 赞同：-1
> 
> 时间：2012-11-21T22:45:39.927
> 
> 标签：macos, applescript

每当我尝试运行以下代码时：

`set RAccounts to (read POSIX file "/Users/student/Desktop/Accounts.txt") set word 1 of RAccounts to clipboard`

它给了我错误“无法将文本设置到剪贴板”任何帮助，而无需进行击键等，当我尝试时

`get word 1 of RAccounts and paste`

它告诉我不能将任何帮助变成布尔类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:10:06.537

如果您想将单词 1 放入剪贴板。

```
set the clipboard to word 1 of RAccounts 
```

# java - Eclipse 代码格式未正确对齐列中的字段

> ID：13503309
> 
> 赞同：1
> 
> 时间：2012-11-21T22:45:46.383
> 
> 标签：java, eclipse, code-formatting

当字段类型为或时，Eclipse 代码格式化程序未将字段与**Align fields in columns**选项同等对齐。以下是格式化后的显示方式：`int``boolean`

```
 private Rect                mTempRect;

    private int                     lastClickX;
    private int                     lastClickY;

    private int                     mMaxLinesCount;
    private boolean                 mWrapped;
    private boolean                 expanded;
    private SpannableString     mLinkHideText; 
```

我正在使用 Eclipse 版本：4.2.1 JUNO x64，Ubuntu 12.04 LTS 64 位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T02:28:19.090

解决了！

问题是 Eclipse 使用了可变宽度字体，因此在格式化代码时空格的宽度不同。解决了将字体更改为固定大小的问题。

参考：[在eclipse编辑器中不同的空白宽度](https://stackoverflow.com/questions/5126073/different-the-width-of-whitespace-in-eclipse-editor)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T18:50:24.180

我这样做了：

1.  转到窗口->首选项->常规->外观->颜色和字体，然后转到基本->文本字体
2.  将字体从 Monospace 8 更改为 Liberation Mono 8。

这对我行得通。

# objective-c - 情节提要：从情节提要中打开 UIViewController 作为 UITableViewCell 中图像的弹出框

> ID：13503319
> 
> 赞同：0
> 
> 时间：2012-11-21T22:46:27.693
> 
> 标签：objective-c, ios, uistoryboardsegue

我有一个自定义 UITableViewCell 类，并且自定义单元格中有一个图像按钮，该按钮链接回单元格类上的方法。触发此方法时，我想从弹出框内的情节提要中启动一个孤立的 UIViewController。我已经尝试了几种技术来做到这一点。如果我将 UIViewController 添加为原型单元上按钮的 segue，则 Interface Builder 将无法编译。有没有人有什么建议？

更新：我得到它与以下工作：

```
UITableView *tv = (UITableView *) self.superview;
UITableViewController *vc = (UITableViewController *) tv.dataSource;

UIStoryboard *storyboard = vc.storyboard;
UIViewController *actionView = [storyboard          
     instantiateViewControllerWithIdentifier:@"ActionView"];

popoverController = [[UIPopoverController alloc]
                                          initWithContentViewController:actionView];
popoverController.popoverContentSize = CGSizeMake(320, 416);

[popoverController presentPopoverFromRect:self.actionButton.bounds      
    inView:self.actionButton
permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:06:45.297

如果您正确识别了它，您应该能够使用`instantiateViewControllerWithIdentifier:`from来获取任何视图控制器。`UIStoryboard`（由于获取故事板引用的最简单方法是来自已经来自它的某个视图控制器，因此您可能希望单元格通知当前控制器执行此操作……这取决于您的对象是如何连接的。）

# python - Python 中的 Euler 项目 #3

> ID：13503320
> 
> 赞同：3
> 
> 时间：2012-11-21T22:46:33.343
> 
> 标签：python

我正在尝试在 Python 中解决 Project Euler 问题 3：

```
The prime factors of 13195 are 5, 7, 13 and 29.

What is the largest prime factor of the number 600851475143 ? 
```

我知道我的程序效率低下且过大，但我只是想知道为什么它不起作用？这是代码：

```
def check(z):

# checks if the given integer is prime

    for i in range(2, z):
        if z % i == 0:
            return False
            break
        i = i+1
    return True

def primegen(y):
# generates a list of prime integers in the given range

    tab = []
    while y >= 2:
        if check(y) == True:
            tab.append(y)
        i = i-1

def mainfuntion(x):
# main function; prints the largest prime factor of the given integer

    primegen(x)
    for i in range(len(tab)):
        if x % tab[i] == 0:
            print tab[i]
            break

mainfuntion(600851475143) 
```

这是错误：

```
for i in range(2, z):
OverflowError: range() result has too many items 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-21T22:56:04.580

原因是 Python 中的列表限制为 536,870,912 个元素（请参阅[Python 数组可以获取多大？](https://stackoverflow.com/questions/855191/how-big-can-a-python-array-get)），当您在示例中创建范围时，元素的数量超过了该数量，从而导致错误。

Project Euler 的乐趣在于您自己解决问题（我知道您正在这样做:)），所以我将给出一个非常小的提示来绕过该错误。想想一个数的因数是什么——你知道 600851475142 不可能是 600851475143 的因数。因此你不必一直检查到那个数。按照这个逻辑，有没有办法可以显着减少检查的范围？如果您对素数的性质进行一些研究，您可能会发现一些有趣的东西:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T02:59:46.897

这是我使用的代码！！

```
n = 600851475143
i = 2
while i * i < n:
     while n % i == 0:
         n = n / i
     i = i + 1

print n 
```

-M1K3

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T23:07:14.830

首先，在第一个代码块中，不要使用，`i = i+1`因为 for 循环会处理它。其次，用于`xrange`制作生成器而不是列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-13T16:47:51.303

@seamonkey8：您的代码可以改进。您可以将其增加 2 而不是 1。对于非常高的数字，它会产生速度差异：

```
n,i = 6008514751231312143,2

while i*i <= n:      
    if n%i == 0:
        n //= i
    else: 
        i+=[1,2][i>2] 
```

# javascript - 悬停数组元素以淡化另一个数组中的对应元素 [关闭问题]

> ID：13503324
> 
> 赞同：6
> 
> 时间：2012-11-21T22:47:01.687
> 
> 标签：javascript, jquery, arrays

我希望实现的是，当我将鼠标悬停在数组中的一个元素上时，`deptmts`数组中的相应元素`brnches`就会淡入淡出。我在下面添加了我认为应该的内容，但不确定我哪里出错了。任何帮助将非常感激。

```
var brnches = ["#branch01","#branch02","#branch03","#branch04"]
var deptmts = ["#depart01","#depart02","#depart03","#depart04"]

var brchhov = function() {
    for(var i=0; i<deptmts.length; i++){
        $(deptmts[i]).hover(
            function(){$(brnches[i]).stop(true).fadeTo("fast", 1);},
            function(){$(brnches[i]).stop(true).fadeTo("slow", 0);}
        );
    }
}; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T22:49:15.287

**经典关闭问题..**

```
var brchhov = function() {
    for(var i=0; i<deptmts.length; i++){
       (function(num){
             $(deptmts[num]).hover(
                 function(){$(brnches[num]).stop(true).fadeTo("fast", 1);},
                 function(){$(brnches[num]).stop(true).fadeTo("slow", 0);}
             );
       })(i);
    }
}; 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/JBGkg/)**

# graphics - 如何照亮物体，phong 模型

> ID：13503325
> 
> 赞同：3
> 
> 时间：2012-11-21T22:47:02.623
> 
> 标签：graphics, lighting, phong

我试图弄清楚如何使用 phong 模型通过照明照明来缩放颜色。例如，给定 I = KaAx，其中 ka 是环境系数，Ax 是环境光照强度，其中 x 可以是 rb 或 g，我想将其应用于纹理颜色为 (1,0,1) 的表面，例如. 我尝试将单个 rgb 值乘以 I，(r*Ka*Ar.r,r*Kb*Ag,r*Kg*Ab) 照明，但是唉，它可以完全改变我不想要的颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-14T21:57:33.997

好的，我看到了几件事：

*   环境光和漫射光不应相乘，而是使用加法
*   您不使用任何法线矢量或光线方向/位置（至少我无法在任何地方找到它）
*   你也应该使用 glColor 参数（除非你根本不使用它）

对每种颜色（.r,.g,.b）和像太阳这样的定向光试试这个：

```
pixel_color.r=clamp_to_1                                    // clamp to <0.0,1.1>
 (
 texture_color.r*glColor.r                                  // pixel color without lighting
 *(                                                            // apply lighting
   diffuse.r*((glNormal.xyz*NormalMatrix).light_dir.xyz) // diffuse * dot product of light source direction and normal vectors. If you need also consider distance just multiply by next term...
  +ambient.r                                                  // ambient light is additive !!!  
  )
 ); 
```

PS。

*   NormalMatrix 是模型视图，原点设置为 [0.0,0.0,0.0]（无位置偏移）
*   如果您还想添加反射率，那么不要忘记计算反射法线......它与用于漫射光的不同（除非天空盒的大小是无限的）。带有环境天空盒的立方体贴图也有很大帮助。

# ruby-on-rails - 我应该定义将由许多不同模型拥有的模型还是使用控制器和视图？

> ID：13503328
> 
> 赞同：0
> 
> 时间：2012-11-21T22:47:15.917
> 
> 标签：ruby-on-rails, ruby

我正在努力弄清楚如何在几个模型之间建立关系。我有我需要按公司和事件查看的 sales_leads。因此，如果有人查找公司线索，他们可以看到所有事件的所有内容，还可以按事件查看所有线索。不确定这是所有权还是在哪里？

应该是这样的

```
Company.sales_leads where("event.event_id = ?", "2356") 
```

或型号：

```
 sales_lead
  belongs_to event
  belongs_to company 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:57:14.390

另外，我可以建议你回到基础。首先，在一张纸上准确地画出您希望模型如何交互...

您希望您的模型“Foo”有一个或多个“条”吗？或者您是否希望 Foo 拥有许多 Bars 和 Bars 拥有许多 Foo。如果有道理！！

在您知道自己真正需要什么之前，不要编写任何代码。

也许从观看以下几个 Railscast 开始：

*   [http://railscasts.com/episodes/47-two-many-to-many](http://railscasts.com/episodes/47-two-many-to-many)

*   [http://railscasts.com/episodes/17-habtm-checkboxes](http://railscasts.com/episodes/17-habtm-checkboxes)

*   [http://railscasts.com/episodes/154-polymorphic-association-revised](http://railscasts.com/episodes/154-polymorphic-association-revised)

*   [http://railscasts.com/episodes/189-embedded-association](http://railscasts.com/episodes/189-embedded-association)

# android - GoogleAnalyticsTracker 商店已满

> ID：13503335
> 
> 赞同：1
> 
> 时间：2012-11-21T22:47:44.853
> 
> 标签：android, google-analytics-api

我在这个网站上看到了几篇类似的帖子，但都没有任何回应，所以我将发布我的问题。

我从 GoogleAnalyticsTracker 收到以下警告：存储已满。不存储最后一个事件。

我在我的 Android 应用程序中使用 GoogleAnalyticsTracker 来存储分析。除了上述警告之外，一切都执行得很好，但是似乎没有数据进入谷歌分析，因为每次我检查它时都没有任何数据。

```
GoogleAnalyticsTracker tracker;
tracker = GoogleAnalyticsTracker.getInstance();
tracker.startNewSession(GA_ID , this);

// i've got a bunch of these throughout my activity
tracker.trackEvent("BTN CLICK", "myactivity", "some info",n); 
```

谷歌的任何人都可以提供一些信息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:37:18.573

这是因为您没有在 startNewSession 方法中设置调度间隔。您可以在上述方法中设置它，也可以通过`tracker.dispatch()`方法手动设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:42:04.417

您需要手动调用调度来推送存储的事件，或者通过自动调度来推送存储的事件或更好的星号，并给出一个间隔。

将其更改为此，您的事件将每 10 秒推送一次分析。tracker.startNewSession(GA_ID, 10, this);

# android - 我应该担心在获得付款之前将 Apk 发送给客户吗？

> ID：13503340
> 
> 赞同：1
> 
> 时间：2012-11-21T22:48:21.240
> 
> 标签：android

我正在为客户开发一个 Android 应用程序。该应用程序实际上已完成，下周我将与客户开会介绍它。他会测试一切，批准后他会付款，我会给他源代码并在 Google Play 上发布。

今天他打电话给我要Apk，这样他就可以开始测试了。我担心如果我们不完成交易（出于某种原因），他可能会找人对 Apk 进行逆向工程并获得我的源代码/应用程序，即使被 ProGuard 混淆（我从未尝试过，但根据[这个 SO 线程](https://stackoverflow.com/questions/6260178/reverse-engineer-android-apk-to-get-code)对 Apk 进行逆向工程并不难）。

**我的问题**：我是不是很偏执，应该只向客户端发送 Apk（因为 ProGuard 混淆可能足以使源代码无用），还是我的担忧是合理的，我应该坚持在交付任何东西之前获得报酬？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:57:36.727

您是否曾经对 .apk 进行过逆向工程？可能你做到了，但你能重新创建整个应用程序吗？可能不是。按照您的逻辑，这意味着我可以“轻松”对任何流行的应用程序进行逆向工程并为我使用它。确实，您可以查看大多数代码，如果它没有被混淆的话，但该技术并不完美。有时它仍然无法将 Smali 转换为真正的 Java 代码。你的应用越复杂，就越难。回答您的问题：不，不要担心，但您仍然应该（始终）使用 ProGuard。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:55:07.553

很好的答案.. 我和一个付给我的钱总是比我要求的少的客户做了很多工作。

如果你问这个答案意味着你对客户没有信心，所以我的建议是和他一起测试第一个应用程序，所以下周。告诉他你发现了一个小错误，现在你不能给他 apk。

但我在意大利.. 客户给钱有麻烦.. 我不知道你在哪里.. :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T23:06:33.793

我之前做过这件事，并得出结论，混淆和“定时轰炸”（在给定的评估期后禁用应用程序）就足够了。我会 (a) 使用您的 MD5 指纹而不是调试签名者对应用程序进行签名，并且 (b) 确保您的应用程序中有 EULA 值得一提。如果涉及到它，那么您总是可以指出您同意安装 x、y 和 z 的说法——其中之一肯定是逆向工程。Google 在开发指南中与“准备发布”相关的部分提供了一些关于形成 EULA 的建议……现在在我的手机上写这个，所以不会链接。

有一个谷歌。我从我们行业的模板版本中获取了很多我的 EULA。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T22:56:05.860

实际上，可以从 apk 对代码进行逆向工程，但如果您使用 ProGuard 对其进行混淆，则几乎不可能对您的代码进行逆向工程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T23:15:52.650

从头开始重新创建软件通常比逆向工程更便宜和更快，除非您使用某种可能值得麻烦的非常昂贵/专利的算法。

对于通用 UI 应用程序（约 99% 的应用程序），逆向工程是不值得的。

# javascript - 隐藏元素的部分内容

> ID：13503342
> 
> 赞同：1
> 
> 时间：2012-11-21T22:48:30.280
> 
> 标签：javascript, text, hide, element

抱歉，这可能是一个奇怪的问题：

我有一个现有的 HTML 代码，我不能直接编辑或删除它的一部分。问题是：在这段代码的一个 div 元素中，有一些我想隐藏的文本。这个 div 内部还有另一个元素，我不想隐藏。它看起来像这样：

```
<div>
....Text I want to hide....
<table> ... Text I don't want to hide...</table>
</div> 
```

我的问题：是否可以隐藏“....我想隐藏的文本......”而不隐藏“......我不想隐藏的文本......”？（例如使用 javascript？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:49:59.023

```
var txt = div.childNodes[0];
var range = document.createRange();
range.selectNode(txt);
var span = document.createElement("span")
range.surroundContents(span);
span.style.display = "none"; 
```

在这里看到它：http: [//jsfiddle.net/KZVDf/](http://jsfiddle.net/KZVDf/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:54:43.487

如果要*删除*文本，可以编写：

```
div.removeChild(div.firstChild); 
```

（其中`div`是引用此`<div>`元素的变量）。

如果你想把它包装在一个`<span>`你可以随意隐藏和取消隐藏的地方，你可以写：

```
var span = document.createElement('span');
div.insertBefore(span, div.firstChild);
span.appendChild(div.firstChild); 
```

（哪里`div`和以前一样）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:56:53.643

环绕您要隐藏的文本`span`并设置为`span display:none`. 例子：

```
<div>
<span style="display:none">....Text I want to hide....</span>
<table> ... Text I don't want to hide...</table>
</div> 
```

或者用脚本隐藏：

```
$('div span').show(); // Show hidden text in span
$('div span').hide(); // Hide text in span 
```

# vim - 如何在 Vim 中跨多个文件有效地执行替换命令？

> ID：13503347
> 
> 赞同：2
> 
> 时间：2012-11-21T22:49:06.573
> 
> 标签：vim, substitution

我想在多个文件中执行以下类型的一些替换：

`"\includegraphics{all.png}"` →`"\includegraphics[width=\linewidth]{all.png}"`

我想在没有 Sed 的情况下只使用 Vim 来做到这一点。但是，当我这样做时，我总是不小心用空间之类的东西替换缓冲区，从而浪费了很多键。我怎样才能快速完成？

*最少的钥匙获胜！*

**从 Vim 内部开始：获取缓冲区的匹配项**

```
:grep -r "includegraphics" Sections/* 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:51:21.493

使用 Vim 在一组文件中执行某些操作的一种灵活方法是将它们的名称列表收集到参数列表中（请参阅 `:help arglist`参考资料），然后遍历它执行所需的命令。

为了执行第一步，请使用命令`:args`、`:argadd`和 `:argdelete`。例如，要将参数列表设置为`.tex`当前目录及其子目录中具有扩展名的所有文件的名称，请运行：

```
:args ./**/*.tex 
```

要执行第二步，请使用以下`:argdo`命令：

```
:argdo %s/\\includegraphics\zs\ze{all.png}/[width=\\linewidth]/g 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T22:54:30.117

替换所有缓冲区

`:bufdo %s/\\includegraphics\{all\.png\}/\includegraphics[width=\linewidth]{all.png}/ge`

# python - 在Python中将声波编码为图像和文本？

> ID：13503348
> 
> 赞同：1
> 
> 时间：2012-11-21T22:49:07.003
> 
> 标签：python, image, audio

所以我编写了以下代码，它将图像输入转换为声波输出，它工作得很好。

```
import wave

try:
    #change the file's name and format
    image_file = 'image.png'
    fin = open(image_file, "rb") #binary read
    data = fin.read()
    fin.close()
except IOError:
    print("Image file %s not found" % imageFile)
    raise SystemExit

#Give the name for wav file produced at run time corresponding to the input file
sound_output = wave.open('image.wav', 'w')
sound_output.setparams((2, 2, 44100, 10, 'NONE', 'not compressed'))

hex_str = bytes(data) #convert binary data to string of bytes
sound_output.writeframes(hex_str)

sound_output.close() 
```

现在我想使用该输出波形声音并将其转换回图像和文本（不是原始图像，而是它可以输出的任何图像）。我正在考虑我在上面使用的相同方法，它将波形声音文件作为输入并将其作为二进制数据读取。但后来我不知道如何将二进制数据保存为图像格式（jpg 或 png）和一串文本。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:59:48.633

PNG是一种结构化格式；转换为位图格式以从一组位中生成任意图像。但是，只需将文件扩展名从 .wav 切换到 .bmp 就可以完成同样的事情；没有实际的转换是有用的或必要的......除非你可能想在一个带有元数据的小标题上添加（声音的采样率等；图像的矩形尺寸）。对于“文本”，您甚至不需要它。

# .net - WCF 服务并发问题和超时

> ID：13503355
> 
> 赞同：2
> 
> 时间：2012-11-21T22:49:31.513
> 
> 标签：.net, wcf, wcf-binding, wcf-client

我有一个 WCF 服务，它从一个应用程序接收消息并向其他连接的客户端应用程序发送通知。

在我的第一个测试场景中，一个客户端应用程序每秒向服务发送大量消息，而另外两个应用程序正在从服务接收这些消息。在这次测试中，我的服务完美无缺。

但是，如果我添加另一个发送消息的客户端应用程序（2 个应用程序向服务发送消息）应用程序崩溃并抛出超时异常（大多数情况下是 SendTimeOut）。

第二次测试每秒的消息量低于第一次测试，因为我在请求之间使用了 Thread.Sleep()，所以我认为问题在于发送请求的应用程序数量多于请求数量，但我我不确定。

你知道为什么会出现这些问题吗？

我的服务和客户端应用程序编码如下：

服务合同：

```
[ServiceContract(CallbackContract = typeof(ICacheCommunicatorServiceCallback), SessionMode = SessionMode.Required)]
public interface ICacheCommunicatorService
{
    [OperationContract(IsInitiating = true, IsOneWay = true)]
    void Connect(string appName, string machineName);

    [OperationContract(IsTerminating = true, IsOneWay = true)]
    void DisconnectClient(ICacheCommunicatorServiceCallback callback);

    [OperationContract(AsyncPattern = true)]
    IAsyncResult BeginSendNotification(Notification notification, AsyncCallback callback, object state);
    void EndSendNotification(IAsyncResult result);
} 
```

请求方法代码：

```
public IAsyncResult BeginSendNotification(Notification notification, AsyncCallback callback, object state)
    {
        try
        {
            ICacheCommunicatorServiceCallback current = CurrentCallback;

            ClientInfo sender = clients[current];

            foreach (ICacheCommunicatorServiceCallback client in clients.Keys)
            {                   
                if (client != current)
                {                       
                    if (((ICommunicationObject)client).State == CommunicationState.Opened)
                    {
                        client.ReceiveNotification(notification);
                    }
                    else
                    {
                        DisconnectClient(client);
                    }
                }
            }
        }
        catch (Exception e)
        {
            Log(e);
        }
        return new CompletedAsyncResult();
    }

    public void EndSendNotification(IAsyncResult asyncResult) { } 
```

服务配置：

```
 <system.serviceModel>
<services>
  <service behaviorConfiguration="DefaultBehavior" name="CacheCommunicator.CacheCommunicatorService">
    <endpoint address="tcp" binding="netTcpBinding" bindingConfiguration="tcpBindingConfiguration"
      name="TcpEndpoint" contract="CacheCommunicator.ICacheCommunicatorService">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexTcpBinding" name="MexEndpoint" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="net.tcp://localhost:8733/CacheCommunicator/" />
        <add baseAddress="http://localhost:8732/CacheCommunicator/" />
      </baseAddresses>
    </host>
  </service>
</services>
<bindings>
  <netTcpBinding>
    <binding name="tcpBindingConfiguration"
             closeTimeout="00:00:05"
             maxBufferSize="1048576"
             maxBufferPoolSize="1048576"
             maxConnections="10"
             maxReceivedMessageSize="1048576"
             openTimeout="00:00:05"
             receiveTimeout="01:00:00"
             sendTimeout="01:00:00"
             transferMode="Buffered">
      <readerQuotas maxArrayLength="1048576" maxBytesPerRead="1048576" maxStringContentLength="1048576"/>
      <reliableSession enabled="false" inactivityTimeout="01:00:00"/>
    </binding>
  </netTcpBinding>
</bindings>
<behaviors>
  <serviceBehaviors>
    <behavior name="DefaultBehavior">
      <serviceMetadata httpGetEnabled="True"/>
      <serviceDebug includeExceptionDetailInFaults="True" />
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

客户端请求调用：

```
internal void SendNotification(Notification notification)
    {
        if (!isConnected()) this.Connect();

        Task.Factory.StartNew(() =>
        {
            proxy.SendNotification(notification);    
        }).HandleExceptions();
    } 
```

客户端应用程序配置：

```
 <system.serviceModel>
<bindings>
  <netTcpBinding>
    <binding name="TcpEndpoint" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions" hostNameComparisonMode="StrongWildcard" listenBacklog="10" maxBufferPoolSize="524288" maxBufferSize="65536" maxConnections="10" maxReceivedMessageSize="65536">
      <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384"/>
      <reliableSession ordered="true" inactivityTimeout="00:10:00" enabled="false"/>
      <security mode="Transport">
        <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign"/>
        <message clientCredentialType="Windows"/>
      </security>
    </binding>
  </netTcpBinding>
</bindings> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T22:05:13.990

Try out setting throttling settings explicitly for server WCF service:

```
<serviceBehaviors>
   <behavior name="ServiceBehavior">
       <serviceThrottling maxConcurrentCalls="200"
                          maxConcurrentInstances ="100" 
                          maxConcurrentSessions ="100"/>
   </behavior>
</serviceBehaviors> 
```

BTW, Which ConcurrrencyMode / InstanceMode is used for WCF service?

Suggested for read:

*   [WCF Instancing, Concurrency, and Throttling – Part 1](http://blogs.msdn.com/b/rickrain/archive/2009/06/17/wcf-instancing-concurrency-and-throttling-part-1.aspx)
*   [WCF Instancing, Concurrency, and Throttling – Part 2](http://blogs.msdn.com/b/rickrain/archive/2009/06/17/wcf-instancing-concurrency-and-throttling-part-2.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T16:55:14.847

确保每次通话后都在客户端代理上调用 .Close()。您可以通过一个代理实例进行多次调用，但在完成客户端调用后始终使用 .Close() 。

# javascript - Android股票浏览器中没有XMLHttpRequest 2进度

> ID：13503361
> 
> 赞同：5
> 
> 时间：2012-11-21T22:50:13.137
> 
> 标签：javascript, html, xmlhttprequest, android-browser, xmlhttprequest-level2

我有一个使用 XMLHttpRequest 2 将文件上传到 Transloadit（文件处理服务）的工作文件上传表单。进度事件在 Firefox 和 Chrome 中正确触发，无论是桌面版还是 Android 版。但是 Android (4.0) 股票浏览器不会触发这些事件，因此我的进度条不适用于我网站的那些用户。XHR2 和 ProgressEvent 据说从 3.0 开始在 Android 中得到支持，所以我不知道发生了什么。

代码是：

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Upload test</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link href="/assets/application.css" media="all" rel="stylesheet" type="text/css" /> <!-- twitter bootstrap -->
  <script type="text/javascript">

    var onprogress = function(e)
    {
      var $status = $('.status');
      $status.text('onprogress: ' + (e.loaded / e.total) * 75 + '<br>');

      if (e.lengthComputable) {
        setProgress((e.loaded / e.total) * 75);
      }
    }

    var setProgress = function(percent) {
      percent = percent+'%';
      var $progressBar = $('.progress .bar');
      var $status = $('.status');
      $progressBar.css('width', percent);
      $progressBar.text(percent);
      $status.text(percent);
    };

    var createAttachment = function(file) {
      var params = {"blocking": true,"auth":{"key":"XXX"},"template_id":"XXX"}
      var xhr = new XMLHttpRequest();
      var data = new FormData();

      data.append('params', JSON.stringify(params));
      data.append('attachment[file]', file);

      var evtReceiver = xhr.upload || xhr;
      evtReceiver.addEventListener('progress', onprogress, false);
      xhr.onload = function(e) {
        var resp = JSON.parse(e.target.response)
        $('.image').append($('<img src="' + resp.results['android-thumb'][0].url + '">'))
        setProgress(100);
      };

      xhr.open('POST', 'http://api2.transloadit.com/assemblies', true);
      xhr.send(data);

    };

    $(document).ready(function() {
      $('input[type=file]').on('change', function(event) {
        createAttachment(event.target.files[0]);
      });
    });
  </script>

</head>

<body>

<input type="file" name="my_file">

<div class="progress progress-striped active">
  <div class="bar" style="width: 0;"></div>
</div>

<div class="status"></div>

<div class="image"></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-01T18:24:17.223

Chromium 版本的 Android 浏览器支持进度事件：

> Android 4.4（API 级别 19）引入了基于 Chromium 的新版 WebView。此更改升级了对 HTML5、CSS3 和 JavaScript 的 WebView 性能和标准支持，以匹配最新的 Web 浏览器。在 Android 4.4 及更高版本上运行时，任何使用 WebView 的应用程序都将继承这些升级。

升级到 4.4 以使用此 API。

**参考**

*   [在 Android 4.4 中迁移到 WebView | 安卓开发者](https://developer.android.com/guide/webapps/migrating.html)

# c# - 如何迭代 T 对象以查找属性？

> ID：13503365
> 
> 赞同：0
> 
> 时间：2012-11-21T22:50:26.787
> 
> 标签：c#, nested-class, databinder

我有这段代码，我目前正在适应使用嵌套实体（实体框架）。我有一个包含 2 个属性的实体，它们是 2 个子实体。

第一步是读取两个类的元数据，从第一个类开始，建立一个属性列表。这就完成了。现在我需要遍历我的对象以找到执行 DataBinding 的好属性。

这是我目前拥有的：

变量示例：

```
datasource = namespace.A
propriete = {System.Nullable`1[System.Int32] count} 
propriete.DeclaringType {Name = "prop2" FullName = "Namespace.Metadata.prop2"} 
```

代码 ：

```
if (this.datasource != null)
{
    var y = (T)this.datasource;

    var propList = typeof(T).GetProperties();
    if (propList.ToList().Contains(propriete))
    {
        TextBox.Text = DataBinder.Eval(y, propriete.Name).ToString();
    }
    else
    {
        TextBox.Text = ":( need child-support!";
    }
} 
```

我的主要问题是我的对象类型在运行时（类型 T）之前是未知的，所以我不知道如何找到我的字段。

快速模型：

```
Class A {
  public B prop1;
  public C prop2;
}

Class B {
   int count;
   string name;
}

Class C {
   int count;
   string name;
}

A.prop1.count = 1;
A.prop1.name = "a";
A.prop2.count = 2;
A.prop2.name = "b"; 
```

现在，我的属性名称都是唯一的（比计数/名称更具体），但我希望它们在某些时候是相同的（计数/名称）。

propriete 可能必须使用 DeclaringType/ReflectedType “过滤”非唯一名称。

考虑唯一名称的蛮力解决方案虽然不优雅，但可能会被接受。

额外问题：在使用主类时使用命名空间`propriete`中包含的另一个部分类。`metadata``datasource`

（...如果您对该系统的功能感到好奇：它基于基于此 metadata.entity dataAttribute 的实体构建一个 html 表（带有 .net 控件）。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:53:25.597

您可以通过在实例上调用 GetType() 来获取类型信息。因此，在您的情况下，它将是：

```
var propList = this.datasource.GetType().GetProperties() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T22:15:25.283

这是我最终得到的结果：

```
if (this.datasource != null)
{
    var y = (T)this.datasource;

    var propList = typeof(T).GetProperties();
    //try to assign the prop but it might be on a child-prop.
    try 
    {           
        retour = DataBinder.Eval(y, propriete.Name).ToString();
    }
    catch 
    {
        foreach (PropertyInfo prop in propList)
        {
            if ((prop.PropertyType).FullName.Contains("Env."))
            {
                var childPropList = prop.PropertyType.GetProperties();
                foreach (PropertyInfo childProp in childPropList)
                {
                    if (((System.Reflection.MemberInfo)(childProp)).Name == propriete.Name)
                    {
                        var x = DataBinder.GetPropertyValue(y, prop.Name);
                        retour = DataBinder.Eval(x, propriete.Name).ToString();
                    }
                }
            }
        }
    }
} 
```

目前它可以工作，但在不久的将来它可能还不够通用。

# c - 将参数传递给共享函数 - C

> ID：13503367
> 
> 赞同：1
> 
> 时间：2012-11-21T22:50:40.180
> 
> 标签：c, arguments, dlsym

我曾经`dlopen`加载一个对象并`dlsym`获取一个指向共享对象函数的函数指针。一切正常。我已经测试了它调用然后共享函数（现在）只打印并且它在调用它的主程序中可以正常打印。现在我想将两个参数传递给这个函数。An`int`和 a `char *`. 谁能帮我理解如何将参数传递给共享函数？我在网上搜索过，但我不明白它是如何工作的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T22:59:41.973

加载函数：

```
int (*func)(int x, char *y) = dlsym(dl_handle, "your_function"); 
```

您很可能会决定需要从`dlsym()`; 它是动态加载库的丑陋之一。

调用它：

```
int i = 37;
char buffer[64];
int result1 = (*func)(i, buffer);  // Old school — pre-C89 (but still works and is explicit)
int result2 = func(i+1, buffer);   // New school — can leave you looking for the wrong thing. 
```

# spring-security - 春季“记住我”不适用于码头和会话复制

> ID：13503368
> 
> 赞同：0
> 
> 时间：2012-11-21T22:50:55.177
> 
> 标签：spring-security, jetty, remember-me, session-replication

我正在使用 Jetty 8，目前有两个实例设置并在循环负载均衡器后面运行。我已将其配置为通过 MongoDB 使用会话复制。我的应用程序使用弹簧安全性。它工作得很好，有两个例外。我将在这里包括一个，另一个在另一个问题中。

1.  Spring Security 的“记住我”不能正常工作。如果用户登录并请求“记住我”，那么它将正常工作，假设用户未来的身份验证请求命中了在原始登录期间命中的特定节点。但是，如果未来的身份验证请求命中另一个节点，则该节点似乎不知道“记住我”请求，因此会提示用户输入凭据。

有没有人有什么建议？我即将开始深入研究 spring security 的记住我代码和 jetty-nosql 的实现，但如果有人能节省我一些时间，我会很高兴的。

此外，我已经尝试了基于 cookie 哈希的“记住我”令牌以及数据库持久化“记住我”令牌方法，两者都有相同的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:33:39.083

解决方案是使用 db 持久化“记住我”令牌方法。在我们的情况下，我们使用`org.springframework.security.web.authentication.rememberme.PersistentTokenBasedRememberMeServices.`

事实证明，我们第一次尝试使用 db 持久令牌方法只是错误地实现了。当我们做得正确时，它运行良好并解决了我们记住我的问题。

# windows-phone-7 - 自定义 VideoSink 和 CaptureSource 帧编码

> ID：13503373
> 
> 赞同：3
> 
> 时间：2012-11-21T22:51:54.493
> 
> 标签：windows-phone-7, windows-phone

我正在使用 CaptureSource 来获取视频流。为了保存视频，我可以使用开箱即用的 FileSink，它允许我保存 mp4 编码文件，但在我的应用程序中，我想对视频流添加一些调整（添加一些工件、文本、徽标等），然后将其保存到隔离贮存。

我可以定义派生自 VideoSink 类并覆盖 OnSample 方法：

```
protected override void OnSample(long sampleTimeInHundredNanoseconds, long frameDurationInHundredNanoseconds, byte[] sampleData)
{
     //process sampleData
     //encode sampleData
     //save encoded sampleData
} 
```

但我不确定如何在 Windows Phone 上编码原始视频数据。我正在寻找任何适用于 WP 的视频编码器。

TIA 求建议！

# qt - 在子进程中获取 QTcpServer 端口的最佳方法？

> ID：13503377
> 
> 赞同：0
> 
> 时间：2012-11-21T22:52:03.990
> 
> 标签：qt, qtcpsocket, qtcpserver

`QTcpServer`假设我们不想为我们的 TCP 服务器使用固定端口号，那么在子进程中检索端口号 a 的最佳方法是什么？到目前为止，我一直在尝试以下两种方法：

*   在主进程中启动a `QTcpServer`，将子进程中TCP服务器的端口发送给父进程的TCP服务器。这可行，但很麻烦。
*   将子进程中的端口号打印到`QTcpServer`子进程`stdout`并读取标准输出，得到父进程中的端口号。

我忽略了另一个明显且干净的解决方案吗？

# sql - 将数据拆分为多个 SQLite 表或数据库是否会更快地检索数据

> ID：13503380
> 
> 赞同：1
> 
> 时间：2012-11-21T22:52:15.013
> 
> 标签：sql, sqlite

我正在为位置数据创建一个 SQLite 数据库。大约有 1000 万行，我想尽快获得 SELECT 语句。

我只需要发布一次数据库，我不在乎创建阶段需要多长时间。

用户一次只会查看地图的一部分，因此需要同时访问地理上彼此接近的数据。

我已将数据拆分为几个图块。每个瓦片对应一个[基于开放街道地图瓦片的纬度和经度区域](http://wiki.openstreetmap.org/wiki/Slippy_map_tilenames)

我的问题是，为了最快的查找时间，我应该：

1.  有多个数据库，每个图块一个数据库，或者
2.  拥有一个数据库，包含多个表，每个图块一个表，或者
3.  拥有一个只有一张表的大数据库，因为拆分数据不会使搜索变得更快。

我可以尝试每种方式，但我真的很想了解解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T09:05:53.827

如果您有多个数据库或多个表，则您的代码必须在执行实际搜索查询之前找出要搜索的一个。此外，如果搜索窗口与两个图块重叠，您必须进行两次搜索并合并结果。此外，拆分并不能帮助您在一个图块内进行搜索。

[要进行地理搜索，您应该使用像R-tree](http://www.sqlite.org/rtree.html)这样的二维索引。当您这样做时，搜索会自动限制在数据的适当部分，因此使用一个表既简单又最快。

# ruby - 比较两个字符串的相似性的最佳方法是什么？

> ID：13503384
> 
> 赞同：1
> 
> 时间：2012-11-21T22:52:26.683
> 
> 标签：ruby

所有这些字符串都指的是同一部电影。如何比较它们以检查相似性？

我从外部来源获得所有这些字符串：

*   蜘蛛侠

*   蜘蛛侠

*   蜘蛛侠 1

*   蜘蛛侠

*   蜘蛛侠

*   电影：蜘蛛侠

*   电影：蜘蛛侠

    对我来说，`"Spider man 1"`and是两个与and`"Spider man 2"`完全不同的字符串。`"spider-man"``"spider man"`

我想要一个函数，如果它比较所有这些字符串，它将返回“true”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:56:46.370

我认为[Smith-Waterman 算法](http://en.wikipedia.org/wiki/Smith%E2%80%93Waterman_algorithm)可以给你一些分数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:56:59.710

使用 Smith-Waterman 算法或其他字符串相似度算法。一种可能性是使用[FuzzBall](https://github.com/vincentchu/fuzz_ball)。

```
require 'fuzz_ball'
THRESHOLD_SCORE = 0.75
MATCHER = FuzzBall::Searcher.new [ 'Spider man' ]

def complies?( str )
  matchdata = MATCHER.search str
  return false if matchdata.nil? or matchdata.empty?
  score = matchdata[0][:score]
  puts "score is #{score}"
  score > THRESHOLD_SCORE
end

complies? 'man spider'
#=> score is 0.8
#=> true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:04:02.747

[Levenshtein distance](http://en.wikipedia.org/wiki/Levenshtein_distance)可以计算将一个字符串转换为另一个字符串需要多少更改。

# android - 高级 ViewHolder（带有侦听器和附加逻辑）

> ID：13503391
> 
> 赞同：1
> 
> 时间：2012-11-21T22:53:29.127
> 
> 标签：android, android-widget, android-listview

经典`ViewHolder`就像

```
private static class ViewHolder {
    public ImageButton btnEdit;
    public ImageButton btnDelete;
    public ImageButton btnCancel;
    public ImageButton btnAccept;
    public TextView txtLbTagName;
    public EditText txtEdTagName;
    public ViewSwitcher viewSwitcher;
} 
```

我想增强它：

1.store`onClickListener`用于我的按钮（可能只是切换我的 ViewSwitcher，或对 EditText 执行任何操作，或更新数据库中的值）

2.我有一个方法`ViewHolder`来做类似的事情

```
public void attach(Tag tag) {
    //assign value to my TextView, attach listeners if needed etc.
} 
```

1.  这行得通吗？
2.  与经典 ViewHolder 相比，性能会降低吗？
3.  这是一个好习惯吗？

# css - 对齐第二行数据

> ID：13503401
> 
> 赞同：0
> 
> 时间：2012-11-21T22:54:37.990
> 
> 标签：css

```
<table>
    <tr><td>test</td></tr>
    <tr>
        <td>
            <div style= height:200px;">
                <div  style="border:1px solid yellow; display: inline-block; width:100px">
                    <img src="orderedList4.png">
                </div>
                <div align="center" style="border:1px solid green;  display: inline-block; width:650px;height:100px;">
                    <div>center Test Header1</div>
                    <div>center Test Header2</div>
                </div>
                <div align="right" style="border:1px solid red;display: inline-block; width:100px">REL 1.0</div>
            </div>
        </td>
    </tr>
</table> 
```

在上面的代码中，图像大小为 75*75 像素。

1.  我想让所有三个单元格的高度都为 100 像素。
2.  我希望图像居中并左对齐。
3.  中间文本居中。
4.  第三个文本居中右对齐。

我无法让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:24:30.447

内联样式是维护的噩梦，您通常应该尝试将演示文稿与内容分开。我已将所有样式从实际标签中移出，并且由于您使用的是表格并将每个样式都`div`称为一个单元格，我猜您的意思是让每个样式都成为一个*实际*的单元格。

```
<style>
.product_table {
    width:  850px;
}
    .product_table td {
        height:         100px;
        border:         solid 1px #000;
        vertical-align: middle;
    }
        .product_table .image {
            width:      100px;
            border-color:   yellow;
            text-align: left;
        }
        .product_table .title {
            /* Automatically sizes its width */
            border-color:   green;
            text-align: center;
        }
        .product_table .release {
            width:      100px;
            border-color:   red;
            text-align: right;
        }
</style>

<table class="product_table">
    <tr>
        <th colspan="3">test</th>
    </tr>
    <tr>
        <td class="image">
            <img src="orderedList4.png" />
        </td>
        <td class="title">
            <div>center Test Header1</div>
            <div>center Test Header2</div>
        </td>
        <td class="release">
            REL 1.0
        </td>
    </tr>
</table> 
```

第一行可能是表格标题，因此您应该考虑将其移出表格作为`h2`将要使用的级别或任何级别。并确保表格是此处最合适的元素 - 除非您要无论这个项目是多行，你最好只使用`div`没有表格的 s 。

# git - 通过直接从 master 拉取来使 git 功能分支与 master 分支保持最新

> ID：13503404
> 
> 赞同：3
> 
> 时间：2012-11-21T22:55:00.747
> 
> 标签：git

我通过将主分支与我的功能分支合并遇到了问题。因此，我试图了解 git 如何处理合并以及使用 master 分支的更改更新功能分支的最佳方法是什么。我找到了 2 个解决方案。

1号：

```
git checkout feature_branch
git merge master 
```

2号：

```
git checkout feature_branch
git pull origin master // Read: pull the changes from origin/master into my current local branch 'feature_branch' 
```

我只读过第二个解决方案一次，而第一个解决方案经常出现在我的眼前。由于`git merge`总是以提交完成，所以我更喜欢第二个，但想知道它是否真的按照应有的方式工作。

我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T03:06:41.370

在第一个实例中，您将转到一个功能分支并拉入*本地*主分支的最新版本。*这个版本的 master 可能与跟踪*分支（origin/master）是最新的，也可能不是最新的，这取决于最近与远程的交互是普通获取还是拉取（获取和合并）。

在第二种情况下，基本上发生的事情是首先从远程获取主分支并放置在您的“跟踪”分支（源/主）中。然后将该版本合并到您当前的（开发）分支中。

有关 git 进程的更多信息，请参阅[git branch、fork、fetch、merge、rebase 和 clone，有什么区别？](https://stackoverflow.com/questions/3329943/what-is-the-difference-between-branch-fork-fetch-merge-rebase-and-clone-in-g/9204499#9204499)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T23:00:48.477

拉取只是合并的提取；在这两个示例中，您都在进行合并，只是第二个示例涉及第二个存储库。我认为他们之间没有太多选择。

如果您的功能分支对您来说是私有的，您可能会考虑将其重新基于 master 的新提示，而不是合并 master 以合并来自 master 的更改。这样，您可以在历史记录中没有合并的情况下拥有您的功能分支跟踪主控。

# php - 重写 URL 崩溃 facebook sdk for php

> ID：13503405
> 
> 赞同：0
> 
> 时间：2012-11-21T22:55:04.787
> 
> 标签：php, facebook, mod-rewrite

我有这种情况。在 MVC 网络应用程序上，我们正在重写 url：

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-l

RewriteRule ^(.+)$ index.php?url=$1 [QSA,L] 
```

所以网址可能是：

```
http://mysite.com/ControllerName/MethodName/Param1/Param2....... 
```

现在我们需要在应用程序上实现一个 facebook 登录。我们只需从 git 上的 sdk 页面复制并粘贴代码

```
require 'facebook-php-sdk/src/facebook.php';

$facebook = new Facebook(array(
  'appId'  => 'YOUR_APP_ID',
  'secret' => 'YOUR_APP_SECRET',
));

// Get User ID
$user = $facebook->getUser();
if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}
if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {
  $loginUrl = $facebook->getLoginUrl();
} 
```

完成此操作后，`$user` 始终为 0，因为 facebook 返回 `?key=parm`用户信息所在的“redirect_uri”。

Facebook 重定向到的实际 URL 如下所示：

```
http://localhost/tesis/?state=6713ce83f25b296abd372ccad20a244d&code=AQA6xxwPiiQt06luKaDD84dFxIXPuhO41RlCQcnV5K2ZtVjyKvZ3A7uqqOQlEX4To_CoT8nEmUjzS2YOVsdhU5CE3I_jfK2LsmkpLsty91-EeipIIvFQLqe6VFB_OHYcj_J0-jdhXfAdYFQ2jsA6Hejnw8bF1ezWtEaZCNnqgc_mQWhovkV8XmFzLFGsqjr52bq2b0wR8Au3ZOSvJUnperaT#_=_ 
```

所以我想我需要对 htaccess 做一些修改。但我不知道我需要做什么改变

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T05:02:16.043

我也有同样的问题。我只是重定向到登录网址中的主页，如下所示：

```
$params = array('scope' => 'email','redirect_uri' => 'http://www.page.com/index.php');
$loginUrl = $facebook->getLoginUrl($params); 
```

可能您可以重定向到“成功登录”页面（非 URL 友好）并包含指向历史记录的链接。

# json.net - JSON.Net 模式验证没有标记其他属性？

> ID：13503407
> 
> 赞同：2
> 
> 时间：2012-11-21T22:55:21.827
> 
> 标签：json.net, jsonschema

我正在使用 NewtonSoft.JSON 进行一些 JSON 模式验证。我看到如果 JSON 具有比架构中指定的数据更多的数据，则验证将返回“ISValid=true”。代码和数据如下。该模式没有名为“city”的属性的属性定义，传入的 JSON 数据具有属性和值。我希望下面的 IsValid 调用返回 false，但它返回 true。架构或类上是否有设置，例如“强制执行严格”或类似的设置，将强制数据包含架构中指定的所有数据且仅包含架构中指定的数据？

```
 public static void ValidateJsonSchema(string expectedSchema, string actualData)
   {
       JsonSchema validSchema = JsonSchema.Parse(expectedSchema);
       JObject actualJson = JObject.Parse(actualData);

       IList<string> messages;
       if (!actualJson.IsValid(validSchema, out messages))
       {
           throw new Exception("Returned data JSON schema validation failed." + messages.ToXml());
       }
   } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-25T22:09:21.413

将`additionalProperties`架构上的属性设置为 false，以便在您正在验证的数据上有其他属性时验证将失败。

例如，如果您使用街道名称和编号验证地址，但不是城市，那么它看起来像这样：

```
{
  "title": "Address",
  "type": "object"
  "additionalProperties": false,
  "properties": {
    "streetName": {
      "type": "string"
    },
    "streetNum": {
      "type": "integer"
    }
  }
} 
```

以上将确保如果数据中存在任何其他属性，则验证将失败。但是，如果您缺少一个属性（例如 streetName），它仍然会通过验证。为确保指定的所有属性都存在`required`于每个属性上，如下所示：

```
{
  "title": "Address",
  "type": "object"
  "additionalProperties": false,
  "properties": {
    "streetName": {
      "type": "string",
      "required": true
    },
    "streetNum": {
      "type": "integer",
      "required": true
    }
  }
} 
```

以上将确保数据包含每个属性并且仅包含这些属性。

顺便说一句，我无法找到任何特定于 JSON.Net 和模式验证的信息，但发现 json 模式[站点](http://json-schema.org/)对于复杂的模式验证非常有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-22T17:44:30.047

您也可以`AllowAdditionalProperties = false`在`validSchema`对象中设置

```
public static void ValidateJsonSchema(string expectedSchema, string actualData)
{
   JsonSchema validSchema = JsonSchema.Parse(expectedSchema);
   validSchema.AllowAdditionalProperties = false;
   JObject actualJson = JObject.Parse(actualData);

   IList<string> messages;
   if (!actualJson.IsValid(validSchema, out messages))
   {
       throw new Exception("Returned data JSON schema validation failed." + messages.ToXml());
   } 
```

}

# oracle - 如果函数 PLSQL 中不存在

> ID：13503408
> 
> 赞同：8
> 
> 时间：2012-11-21T22:55:33.367
> 
> 标签：oracle, plsql

我有一个函数，它在打开游标之前有三个 If/Then 语句。If/Then 语句在打开游标之前检查有效性。

我想再添加一个 If/The 有效性检查，但是，它比其他的要复杂一些。下面是一个示例，我已经块评论了我想添加的内容：

```
begin
    if not procedure.validation_function (<variable>, <condition>=TRUE) then
        return variable2;
    end if;

   /* if not exists
    (
       SELECT 'x' FROM table1
       WHERE table1_id = variable1_id
       AND trunc(sysdate) < trunc(table1_date + 60)
    ) then
        return variable2;
    end if; */

    open cursor(<argument>);
    fetch cursor into <variable>;
    close cursor;
    return <variable>;

end; 
```

我的问题是我来自 T-SQL 世界，我在 PL/SQL 中发现*if not exists*命令不起作用。有没有一种方法可以在函数中使用 SELECT 的 If NO_DATA_FOUND 语句？

有没有办法在其中嵌套另一个函数，所以我可以：

```
begin
     SELECT ....
     FROM ....
     WHERE ....
        if NO_DATA_FOUND then
           return variable2;
        end if;
end; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-22T04:25:05.957

`Exists`条件只能在 SQL 语句中使用，不能直接在 PL/SQL 中使用。有几种选择：

*   在语句中使用`case` 带有`exists`条件的`select`表达式：

    ```
    SQL> declare
      2    l_exists number(1);
      3  begin
      4    select case
      5             when exists(select 1
      6                           from employees
      7                          where department_id = 1)
      8             then 1
      9             else 0
     10           end into l_exists
     11      from dual;
     12  
     13     if (l_exists = 1)
     14     then
     15       dbms_output.put_line('exists');
     16     else
     17       dbms_output.put_line(q'[doesn't exist]');
     18     end if;
     19  end;
     20  /

     doesn't exist

     PL/SQL procedure successfully completed 
    ```

*   或者（`rownum`需要保证如果有多条记录满足匹配条件，则只返回一条记录）：

    ```
    SQL> declare
      2    l_exists number;
      3  begin
      4  
      5    select 1
      6      into l_exists
      7      from employees
      8     where department_id = 100
      9       and rownum = 1;
     10  
     11     dbms_output.put_line('exists');
     12  
     13  exception
     14    when no_data_found
     15    then dbms_output.put_line(q'[doesn't exist]');
     16  end;
     17  /

     exists

     PL/SQL procedure successfully completed 
    ```

# python - Python将每个子目录中的文件数输出到一个csv文件

> ID：13503409
> 
> 赞同：1
> 
> 时间：2012-11-21T22:55:34.607
> 
> 标签：python, csv

我正在尝试将 Linux 系统上每个子目录中的文件数汇总到 Excel 表中。

目录一般设置：`maindir/person/task/somedata/files`. 但是，设置的子目录会有所不同（即，某些文件可能没有 ' `task`' 目录），所以我需要让 python 遍历文件路径。

我的问题是我需要从“ `person`”开始的所有子目录名称，目前我的代码（如下）仅将最近的目录与文件计数附加在一起。如果有人能帮我解决这个问题，将不胜感激！

```
import os, sys, csv

outwriter = csv.writer(open("Subject_Task_Count.csv", 'w'))

dir_count=[]
os.chdir('./../../')
rootDir = "./" # set the directory you want to start from
for root, dirs, files in os.walk( rootDir ):
for d in dirs:
    a = str(d)
    count = 0
    for f in files:
        count+=1
    y= (a,count)
    dir_count.append(y)

for i in dir_count:
    outwriter.writerow(i) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T23:01:03.090

您应该尝试以下方式：

```
for root,dirs,files in os.walk( rootDir ) :
    print root, len(files) 
```

它打印子目录和文件数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:44:04.430

我不清楚你的问题，你可能想重新阅读 os.walk 文档。 `root`是被遍历的当前目录。 `dirs`是 中的子目录`root`，`files`是 中的文件`root`。由于您的代码现在是您计算相同的文件（从根目录）并将其记录为每个子目录中的文件数。

这就是我想出的。希望它接近你想要的。如果没有，请调整 :) 它会打印目录、目录中的文件数以及目录及其所有子目录中的文件数。

```
import os
import csv

# Open the csv and write headers.
with open("Subject_Task_Count.csv",'wb') as out:
    outwriter = csv.writer(out)
    outwriter.writerow(['Directory','FilesInDir','FilesIncludingSubdirs'])

    # Track total number of files in each subdirectory by absolute path
    totals = {}

    # topdown=False iterates lowest level (leaf) subdirectories first.
    # This way I can collect grand totals of files per subdirectory.
    for path,dirs,files in os.walk('.',topdown=False):
        files_in_current_directory = len(files)

        # Start with the files in the current directory and compute a
        # total for all subdirectories, which will be in the `totals`
        # dictionary already due to topdown=False.
        files_including_subdirs = files_in_current_directory
        for d in dirs:
            fullpath = os.path.abspath(os.path.join(path,d))

            # On my Windows system, Junctions weren't included in os.walk,
            # but would show up in the subdirectory list.  this try skips
            # them because they won't be in the totals dictionary.
            try:
                files_including_subdirs += totals[fullpath]
            except KeyError as e:
                print 'KeyError: {} may be symlink/junction'.format(e)

        totals[os.path.abspath(path)] = files_including_subdirs
        outwriter.writerow([path,files_in_current_directory,files_including_subdirs]) 
```

# iphone - presentPopover - EXC_BAD_ACCESS；使用僵尸对象

> ID：13503410
> 
> 赞同：0
> 
> 时间：2012-11-21T22:55:45.690
> 
> 标签：iphone, objective-c, ios, ipad, exc-bad-access

我正在尝试开始`presentPopoverFromRect`工作，但由于内存访问错误，我一直在崩溃。`(EXC_BAD_ACCESS)`.

这是代码，最后一行是它崩溃的地方：

```
- (void)showChat:(id)sender {

chat = [[PopupChatController alloc] initWithStyle:UITableViewStylePlain];

chat.chatDelegate = self;

self.chatPopover = [[UIPopoverController alloc] initWithContentViewController:chat];

CGRect myRect = CGRectMake(50, 0, 225, 25) ;

[self.chatPopover presentPopoverFromRect:myRect inView:self.view permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];

} 
```

使用 gdb 我检查了`self.view`和的保留计数`self.chatPopover`：

例如。

```
p (int)[self.view retainCount] 
```

他们都很好（> 0）。所以我完全不知道这里发生了什么？

如果有人可以提供帮助，我将不胜感激。

另外，顺便说一句，我在 XCode 中启用了 Zombie Objects （*Product > Edit scheme > Diagnostics > Enable Zombie Objects*），但我没有在控制台中的任何僵尸变量上获得任何输出。也许我找错地方了？

对此的任何建议也将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T01:19:06.990

**变量chat**存在内存泄漏。

尝试以下代码并将聊天设置为局部变量。

```
- (void)showChat:(id)sender {

  PopupChatController *chat = [[PopupChatController alloc]    initWithStyle:UITableViewStylePlain];

  chat.chatDelegate = self;

  self.chatPopover = [[UIPopoverController alloc] initWithContentViewController:chat];

  [chat release]; //since it's retained in the UIPopoverController

  CGRect myRect = CGRectMake(50, 0, 225, 25) ;

  [self.chatPopover presentPopoverFromRect:myRect inView:self.view permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES]; 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T01:22:14.567

顺便说一句，您是否将属性 chatPopover 定义为保留？

# r - 让 R 用回车写入 .txt

> ID：13503412
> 
> 赞同：1
> 
> 时间：2012-11-21T22:55:51.260
> 
> 标签：r

我从数据中获取 R 样本 100 次，然后将它们写入文本文件，然后我的老板可以将其加载到 Excel 中。我目前让 R 做样本，但是在写作时，我无法将结果放在不同的行中。我已经厌倦了 writeLines、write.table、write 和 write.csv。我能得到的最接近的是使用 write.table。

```
Dataset <- read.table("clipboard", header=FALSE, sep="", na.strings="", dec=".", strip.white=TRUE)
ThePath = ""
*Replace with where you want it to save
P = .25
*Put the Percentage Value you want to use here
X = round(nrow(Dataset)*P)
Boot1 = sum(sample(Dataset$V1, size=X))
Boot2 = sum(sample(Dataset$V1, size=X))
Boot3 = sum(sample(Dataset$V1, size=X))
Boot4 = sum(sample(Dataset$V1, size=X))
Boot5 = sum(sample(Dataset$V1, size=X))
Boot6 = sum(sample(Dataset$V1, size=X))
Boot7 = sum(sample(Dataset$V1, size=X))
Boot8 = sum(sample(Dataset$V1, size=X))
Boot9 = sum(sample(Dataset$V1, size=X))
Boot10 = sum(sample(Dataset$V1, size=X))
Boot11 = sum(sample(Dataset$V1, size=X))
Boot12 = sum(sample(Dataset$V1, size=X))
Boot13 = sum(sample(Dataset$V1, size=X))
Boot14 = sum(sample(Dataset$V1, size=X))
Boot15 = sum(sample(Dataset$V1, size=X))
Boot16 = sum(sample(Dataset$V1, size=X))
Boot17 = sum(sample(Dataset$V1, size=X))
Boot18 = sum(sample(Dataset$V1, size=X))
Boot19 = sum(sample(Dataset$V1, size=X))
Boot20 = sum(sample(Dataset$V1, size=X))
Boot21 = sum(sample(Dataset$V1, size=X))
Boot22 = sum(sample(Dataset$V1, size=X))
Boot23 = sum(sample(Dataset$V1, size=X))
Boot24 = sum(sample(Dataset$V1, size=X))
Boot25 = sum(sample(Dataset$V1, size=X))
Boot26 = sum(sample(Dataset$V1, size=X))
Boot27 = sum(sample(Dataset$V1, size=X))
Boot28 = sum(sample(Dataset$V1, size=X))
Boot29 = sum(sample(Dataset$V1, size=X))
Boot30 = sum(sample(Dataset$V1, size=X))
Boot31 = sum(sample(Dataset$V1, size=X))
Boot32 = sum(sample(Dataset$V1, size=X))
Boot33 = sum(sample(Dataset$V1, size=X))
Boot34 = sum(sample(Dataset$V1, size=X))
Boot35 = sum(sample(Dataset$V1, size=X))
Boot36 = sum(sample(Dataset$V1, size=X))
Boot37 = sum(sample(Dataset$V1, size=X))
Boot38 = sum(sample(Dataset$V1, size=X))
Boot39 = sum(sample(Dataset$V1, size=X))
Boot40 = sum(sample(Dataset$V1, size=X))
Boot41 = sum(sample(Dataset$V1, size=X))
Boot42 = sum(sample(Dataset$V1, size=X))
Boot43 = sum(sample(Dataset$V1, size=X))
Boot44 = sum(sample(Dataset$V1, size=X))
Boot45 = sum(sample(Dataset$V1, size=X))
Boot46 = sum(sample(Dataset$V1, size=X))
Boot47 = sum(sample(Dataset$V1, size=X))
Boot48 = sum(sample(Dataset$V1, size=X))
Boot49 = sum(sample(Dataset$V1, size=X))
Boot50 = sum(sample(Dataset$V1, size=X))
Boot51 = sum(sample(Dataset$V1, size=X))
Boot52 = sum(sample(Dataset$V1, size=X))
Boot53 = sum(sample(Dataset$V1, size=X))
Boot54 = sum(sample(Dataset$V1, size=X))
Boot55 = sum(sample(Dataset$V1, size=X))
Boot56 = sum(sample(Dataset$V1, size=X))
Boot57 = sum(sample(Dataset$V1, size=X))
Boot58 = sum(sample(Dataset$V1, size=X))
Boot59 = sum(sample(Dataset$V1, size=X))
Boot60 = sum(sample(Dataset$V1, size=X))
Boot61 = sum(sample(Dataset$V1, size=X))
Boot62 = sum(sample(Dataset$V1, size=X))
Boot63 = sum(sample(Dataset$V1, size=X))
Boot64 = sum(sample(Dataset$V1, size=X))
Boot65 = sum(sample(Dataset$V1, size=X))
Boot66 = sum(sample(Dataset$V1, size=X))
Boot67 = sum(sample(Dataset$V1, size=X))
Boot68 = sum(sample(Dataset$V1, size=X))
Boot69 = sum(sample(Dataset$V1, size=X))
Boot70 = sum(sample(Dataset$V1, size=X))
Boot71 = sum(sample(Dataset$V1, size=X))
Boot72 = sum(sample(Dataset$V1, size=X))
Boot73 = sum(sample(Dataset$V1, size=X))
Boot74 = sum(sample(Dataset$V1, size=X))
Boot75 = sum(sample(Dataset$V1, size=X))
Boot76 = sum(sample(Dataset$V1, size=X))
Boot77 = sum(sample(Dataset$V1, size=X))
Boot78 = sum(sample(Dataset$V1, size=X))
Boot79 = sum(sample(Dataset$V1, size=X))
Boot80 = sum(sample(Dataset$V1, size=X))
Boot81 = sum(sample(Dataset$V1, size=X))
Boot82 = sum(sample(Dataset$V1, size=X))
Boot83 = sum(sample(Dataset$V1, size=X))
Boot84 = sum(sample(Dataset$V1, size=X))
Boot85 = sum(sample(Dataset$V1, size=X))
Boot86 = sum(sample(Dataset$V1, size=X))
Boot87 = sum(sample(Dataset$V1, size=X))
Boot88 = sum(sample(Dataset$V1, size=X))
Boot89 = sum(sample(Dataset$V1, size=X))
Boot90 = sum(sample(Dataset$V1, size=X))
Boot91 = sum(sample(Dataset$V1, size=X))
Boot92 = sum(sample(Dataset$V1, size=X))
Boot93 = sum(sample(Dataset$V1, size=X))
Boot94 = sum(sample(Dataset$V1, size=X))
Boot95 = sum(sample(Dataset$V1, size=X))
Boot96 = sum(sample(Dataset$V1, size=X))
Boot97 = sum(sample(Dataset$V1, size=X))
Boot98 = sum(sample(Dataset$V1, size=X))
Boot99 = sum(sample(Dataset$V1, size=X))
Boot100 = sum(sample(Dataset$V1, size=X))
write.list(data.frame(sum(Boot1), sum(Boot2), sum(Boot3), sum(Boot4), sum(Boot5), sum(Boot6), sum(Boot7), sum(Boot8), sum(Boot9), sum(Boot10), sum(Boot11), sum(Boot12), sum(Boot13), sum(Boot14), sum(Boot15), sum(Boot16), sum(Boot17), sum(Boot18), sum(Boot19), sum(Boot20), sum(Boot21), sum(Boot22), sum(Boot23), sum(Boot24), sum(Boot25), sum(Boot26), sum(Boot27), sum(Boot28), sum(Boot29), sum(Boot30), sum(Boot31), sum(Boot32), sum(Boot33), sum(Boot34), sum(Boot35), sum(Boot36), sum(Boot37), sum(Boot38), sum(Boot39), sum(Boot40), sum(Boot41), sum(Boot42), sum(Boot43), sum(Boot44), sum(Boot45), sum(Boot46), sum(Boot47), sum(Boot48), sum(Boot49), sum(Boot50), sum(Boot51), sum(Boot52), sum(Boot53), sum(Boot54), sum(Boot55), sum(Boot56), sum(Boot57), sum(Boot58), sum(Boot59), sum(Boot60), sum(Boot61), sum(Boot62), sum(Boot63), sum(Boot64), sum(Boot65), sum(Boot66), sum(Boot67), sum(Boot68), sum(Boot69), sum(Boot70), sum(Boot71), sum(Boot72), sum(Boot73), sum(Boot74), sum(Boot75), sum(Boot76), sum(Boot77), sum(Boot78), sum(Boot79), sum(Boot80), sum(Boot81), sum(Boot82), sum(Boot83), sum(Boot84), sum(Boot85), sum(Boot86), sum(Boot87), sum(Boot88), sum(Boot89), sum(Boot90), sum(Boot91), sum(Boot92), sum(Boot93), sum(Boot94), sum(Boot95), sum(Boot96), sum(Boot97), sum(Boot98), sum(Boot99), sum(Boot100)), file=ThePath, row.name=FALSE, col.name=FALSE sep="/r") 
```

我曾尝试使用 write.list 并只写，但没有得到我正在寻找的输出。我也试着把它做成一个 csv 和一个 sep 的空间，结果都是这样

25026689/r19976650/r13281740/r15783000/r36507540/r15811400/r15799460

或 , 或 /r 所在的空格。
我正在寻找这样的东西

25026689
19976650
13281740
15783000
36507540
15811400
15799460

我知道我的代码是超级蛮力的，并且可以通过计数和循环以更简洁、更容易的方式完成，但我仍在学习大部分编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:07:57.233

您的问题是您正在创建一个具有单行的数据框。在 Excel 中，这将以相同的方式表示（即一行，而不是一列）。

解决方案是创建一个包含您的引导值的向量。

这是结识`sapply`或其近亲的最佳时机`replicate`：

```
boot <- data.frame(
  boot = replicate(100, sum(runif(100)))
)
head(boot)
      boot
1 50.84482
2 49.57098
3 52.75195
4 52.20751
5 48.55071
6 50.76622 
```

容易，不是吗？

* * *

现在你的代码变成：

```
Dataset <- read.table("clipboard", header=FALSE, sep="", na.strings="", 
                      dec=".", strip.white=TRUE)
ThePath <-  ""
#Replace with where you want it to save
P <- .25
#Put the Percentage Value you want to use here
X <- round(nrow(Dataset)*P)

boot <- data.frame(
  boot = replicate(100, sum(sample(Dataset$V1, size=X)))
)
write.csv(boot, file=="your_file_name", row.names=FALSE) 
```

**免责声明：未经测试 - 我没有你的数据**

# cakephp - CakePHP – 2 个控制器，1 个表单

> ID：13503418
> 
> 赞同：0
> 
> 时间：2012-11-21T22:56:15.537
> 
> 标签：cakephp, formhelper

我需要创建一个审核表。我有 2 个模型和 2 个控制器 - 产品和评论与“产品”有许多“评论”关系，评论表单将显示在当前产品页面上（产品控制器，“查看”操作），此表单将使用另一个控制器（评论）。

我还需要对此表单进行验证，并显示验证错误。

在我的 Products 控制器 view.ctp 我有：

```
// product page stuff...

echo $this->Form->create($model = 'Review', array('url' => '/reviews/add'));
echo $this->Form->input('name', array('label' => 'Your name:'));
echo $this->Form->input('email', array('label' => 'Your e-mail:'));
echo $this->Form->input('message', array('rows' => '6', 'label' => 'Your message:'));
echo $this->Form->hidden('product_id', array('default' => $product['Product']['id']));
echo $this->Form->end('Send');

echo $this->Session->flash(); 
```

评论控制器 -> 添加：

```
public function add() {
if ($this->request->is('post')) {
    $this->Review->save($this->request->data); 
    $this->redirect(array('controller' => 'products', 'action' => 'view', $this->request->data['Review']['product_id'], '#' => 'reviews'));
    }
} 
```

不知何故，这个可怕的代码工作......部分。查看保存，但未显示验证错误。

如果我在此操作中添加 If 语句：

评论控制器-> 添加：

```
public function add() {
if ($this->request->is('post')) {
    if ( $this->Review->save($this->request->data) ){ 
    $this->redirect(array('controller' => 'products', 'action' => 'view', $this->request->data['Review']['product_id'], '#' => 'reviews'));
    }}
} 
```

如果表单有错误并且没有验证我得到 MissingView 错误：缺少视图

```
Error: The view for ReviewsController::add() was not found. 
```

我的问题是如何正确处理这种情况以实现我需要的功能？我应该使用带有请求操作的元素还是应该移动操作以将评论添加到 ProductsController？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T17:14:26.303

您的问题之一是您仅在保存成功时才进行重定向，因此如果保存失败，您没有 Review/add.ctp ，因此它会给您一个缺少视图的错误。无论保存是否有效，您都需要进行重定向，以便您始终返回产品页面。

您不会在字段上收到错误的原因是因为您正在执行重定向，因此错误会丢失。您可以将错误作为操作的另一个参数传递给产品控制器。

**评论控制器**

```
public function add() {
    if (!empty($this->request->data)) {
        $errors = null;
        if (!$this->Review->save($this->request->data)) {
            $errors = $this->Review->validationErrors;
        }
        // Always redirect
        $this->redirect(array('controller' => 'products', 'action' => 'view', $this->request->data['Review']['product_id'], 'errors' => $errors, '#' => 'reviews'));
    }
} 
```

**产品控制器**

```
public function view($product_id, $errors = null) {
    if (!empty($errors)) {
        $this->Review->validationErrors = $errors;
    }
} 
```

当然我不知道你所有的代码是什么样子的，这是未经测试的，但想法是将 Review 模型的验证错误传递给产品控制器，然后在产品页面上再次将它们手动分配回 Review 模型.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T14:03:04.913

您似乎没有`add.ctp`为审核创建视图。

如果您不打算做任何特别的事情，那么添加条件是没有意义的。您总是希望用户返回产品视图吗？它不介意它是否验证。

当您使用条件并且它不验证时，控制器不会将您重定向到 products 控制器的视图操作，它会默认加载 add.ctp 视图。

只需继续使用重定向返回表单即可。

使用您的第一个添加操作。它是正确的。如果需要，您可以添加错误消息：

```
public function add() {
if ($this->request->is('post')) {
    if(!$this->Review->save($this->request->data)({ 
        $this->Session->setFlash(__('There was a problem adding the product. Please try again.'));
    }
    $this->redirect(array('controller' => 'products', 'action' => 'view', $this->request->data['Review']['product_id'], '#' => 'reviews'));
} 
```

请注意，重定向始终存在。

它可能不会在每个输入上显示红色错误框，因为您使用的是“重定向”而不是操作的默认视图。反正不太确定。

# java - 计数子串，while循环

> ID：13503421
> 
> 赞同：0
> 
> 时间：2012-11-21T22:56:28.720
> 
> 标签：java, string

```
public class SubstringCount
{
     public static void main(String[] args)
    { 
    Scanner scan = new Scanner(System.in);
    System.out.println("Enter a word longer than 4 characters, and press q to quit");
    int count = 0;

    while (scan.hasNextLine())
    {
        System.out.println("Enter a word longer than 4 characters, and press q to quit");
        String word = scan.next();

        if (word.substring(0,4).equals("Stir"))
        {
            count++;
            System.out.println("Enter a word longer than 4 characters, and press q to quit");
            scan.next();
        }

        else if (word.equals("q"))
        {
            System.out.println("You have " + count + ("words with 'Stir' in them"));
        }

        else if (!word.substring(0,4).equals("Stir")) 
        {
            System.out.println("Enter a word longer than 4 characters, and press q to quit");
            scan.next();
        }
    }
} 
```

}

在这里，我需要打印用户输入的单词中有多少包含子字符串“搅拌”。但是我不知道如何让它工作，或者我是否一开始就做对了！

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:04:56.183

在您的代码中，行：`Enter a word longer than 4 characters, and press q to quit`将在每次迭代中打印两次。另外，您使用了错误的函数来检查字符串是否包含子字符串。你的一些`if-else`陈述需要改变。这是您的代码的更好版本：

```
import java.util.Scanner;

    public class SubstringCount
    {
         public static void main(String[] args)
         { 
             Scanner scan = new Scanner(System.in);
             System.out.println("Enter a word longer than 4 characters, and press q to quit");
             int count = 0;
             while (scan.hasNextLine())
             {
                String word = scan.next();
                if (word.contains("Stir"))
                {
                  System.out.println("Enter a word longer than 4 characters, and press q to quit");
                  count++;
                }
                else if (word.equals("q"))
                {
                  System.out.println("You have " + count + ( "words with 'Stir' in them"));
                  System.out.println("Enter a word longer than 4 characters, and press q to quit");
                }   
                else
                {
                  System.out.println("Enter a word longer than 4 characters, and press q to quit");
                }
             } //end of while
        }      //end of main
    }          //end of class 
```

请注意，在这种情况下，您会陷入无限的 while 循环。为了在进入时真正“退出” `q`，您应该`break`从`while`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:57:33.107

你应该使用`String.contains ("Stir")`而不是`String.substring(0,4).equals("Stir")`

作为[String.contains 的 javadoc](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#contains%28java.lang.CharSequence%29)状态，此方法

> 当且仅当此字符串包含指定的 char 值序列时才返回 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:59:17.647

`String.contains("Stir")`

将对您的情况有所帮助。

# sublimetext2 - SublimeJava 在 Mac OS X 10.7 上根本不会做出反应

> ID：13503426
> 
> 赞同：1
> 
> 时间：2012-11-21T22:57:09.617
> 
> 标签：sublimetext2, code-completion

今天我尝试为 Sublime Text 2 安装和运行 SublimeJava 插件。这基本上是我所做的。

*   将[git 存储库克隆](https://github.com/quarnster/SublimeJava.git)到 ~/Library/Application Support/Sublime Text 2/Packages。
*   创建了一个 ProjectFile 来测试插件。

    ```
    {
        "folders":
        [
            {
                // The class files are in the same directory
                "path": "~/src/path_to_project/"
            }
        ],

        "settings":
        [
            {
            "sublimejava_classpath":
                [
                "~/src/path_to_project/",
                "/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Libraries/"
                ],
            "sublimejava_enabled":true
            }
        ]
    } 
    ```

但是，当我键入应该触发代码完成的内容时，什么也没有发生。我错过了什么？

# types - Haxe 是强类型还是弱类型（或者两者兼而有之？）

> ID：13503435
> 
> 赞同：1
> 
> 时间：2012-11-21T22:57:46.180
> 
> 标签：types, haxe

我开始学习 Haxe，我想知道 Haxe 是强类型还是弱类型。如果它的类型系统不强或不弱，那么它是否像[Dart 编程语言](http://en.wikipedia.org/wiki/Dart_%28programming_language%29)那样“可选类型” ？

我注意到这行代码似乎可以工作，尽管没有明确的类型声明：`var a = [["This is a nested array"], ["This is another nested array"], "This is not a nested array" ];`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T01:18:21.827

Haxe 在很大程度上是一种严格类型的语言，然而，它并不像你想象的那么严格。它比其他一些语言宽松得多，并且允许您在必要时突破类型系统。并且它不需要您每次都指定所有类型 - 编译器使用类型推断来“推断”类型 - 在您的示例中推断的类型是`Array<Dynamic>`

使用 Haxe：

*   编译器将默认为强类型。您可以提供类型信息（例如`var x:Array<Int>;`），也可以让编译器推断（例如`var x = [0,1,2]`， x 将是`Array:Int`）。

*   您可以通过使用来检查推断的类型`$type(myVariable);`这有助于弄清楚发生了什么。

*   如果类型推断让您感到困惑，或者编译器感到困惑，那么显式定义您的类型有时会更容易，因此不会造成混淆。

*   [您可以使用Dynamic](http://haxe.org/ref/dynamic)、[Reflection](http://haxe.org/api/reflect)或[untyped](http://haxe.org/ref/dynamic#untyped)来逃避类型系统（如果它妨碍了，或者如果您尝试使用本机库等）。

*   Haxe 的类型检查主要是编译时功能。编译代码时会检查类型并保证其正确性。但是，如果您尝试在运行时做一些奇怪的事情，则不会发生类型检查，并且您可能会破坏事情。

*   Haxe 的一些目标是弱类型的（例如 Javascript、Neko）。然而，因为 Haxe 的类型检查发生在编译时，您可以获得严格类型语言的所有好处 - 错误检查、自动完成等。编译后的 Javascript 或 Neko 字节码不会知道类型，但这没关系 - Haxe 确保一切正常。

为了帮助您了解它，这里有一些链接：

*   [类型推断](http://haxe.org/ref/type_infer)
*   [Haxe 语言参考](http://haxe.org/ref)本指南是我了解 Haxe 类型系统的大部分内容的地方 - 非常值得一读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T01:07:34.817

它是严格类型的，Haxe 编译器类型推断在查找数据的正确类型方面做得非常出色。

按照此处的示例：http: [//haxe.org/ref/type_infer](http://haxe.org/ref/type_infer) - 试试这个巧妙的技巧：

```
var a = [["This is a nested array"], ["This is another nested array"], "This is not a nested array" ];
var b = $type(a); 
```

它会给你一个警告信息

```
Warning : Array<Dynamic> 
```

从中，我们可以看到编译器正确地识别了您的两个数组和一个字符串的混合，并将其解析为一个动态数组，这意味着该数组基本上可以容纳抛出的任何对象。

因此，您的变量定义

```
var a = [["This is..."], ["This is another..."], "This is not..." ]; 
```

与以下完全同义，包括显式类型定义：

```
var a:Array<Dynamic> = [["This is..."], ["This is another..."], "This is not..." ]; 
```

# winapi - WPD MTP 数据流挂在 Release

> ID：13503436
> 
> 赞同：1
> 
> 时间：2012-11-21T22:58:21.517
> 
> 标签：winapi, com, wpd, mtp

在 Windows 8 下使用 WPD（Windows 便携式设备）API 从与 MTP 兼容的移动设备读取数据时遇到了一个奇怪的问题（尚未尝试任何其他 Windows 版本）。

症状是，在调用通过该函数获取`Release`的接口时，偶尔会挂起，直到设备与PC断开连接后才返回。`IStream``IPortableDeviceResources::GetStream``Release`

经过一些实验，我发现只要读取了流的全部内容，这种情况就**不会发生。**但如果流仅被部分读取（例如，文件的前 256Kb），它可能看似随机发生（尽管非常频繁）。

这已在 iPhone 和 Windows Phone 8 移动设备上重现，因此它似乎不是特定于设备的。

有没有人遇到过这种问题？更重要的是，除了总是阅读流的全部内容之外，有没有人知道解决它的方法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T23:53:33.820

我发现调用该`IPortableDeviceDataStream::Cancel`方法似乎可以解决这个问题。

# c# - 哪个正则表达式会捕获这个序列？

> ID：13503437
> 
> 赞同：-2
> 
> 时间：2012-11-21T22:58:22.407
> 
> 标签：c#, .net, regex

文字遵循这种模式

```
<tr class="text" (any sequence of characters here, except ABC)ABC(any sequence of characters here, except ABC)
<tr class="text" (any sequence of characters here, except ABC)ABC(any sequence of characters here, except ABC)
<tr class="text" (any sequence of characters here, except ABC)ABC(any sequence of characters here, except ABC)
<tr class="text" (any sequence of characters here, except ABC)ABC(any sequence of characters here, except ABC) 
```

所以基本上上面的行（可能包括换行符）可能会重复多次，这个想法是在 ABC 之后立即检索前 3 个字符。

我已经尝试过正则表达式

```
 \<tr class="text" [.\n]+ABC(?<capture>[.]{3}) 
```

但他们都失败了。有人可以给我一个提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:00:18.917

您有效地逃脱了通配符成为文字句点。只需使用

```
\<tr class="text" .+?ABC(?<capture>.{3}) 
```

确保您使用`RegexOptions.Singleline`, 以便也`.`匹配换行符！

[但是，您实际上根本不应该使用正则表达式。](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)相反，使用 DOM 解析器。我已经看到[HTML Agility Pack](http://htmlagilitypack.codeplex.com)经常被推荐用于 .NET。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:03:29.673

`"ABC"`这是一个正则表达式，它将在您的字符串中捕获前 3 个字母

```
".+ABC(...)" 
```

在 c# 中，您的匹配项将包含一组组，其中一个组将是 3 个字母

只要确保你`"ABC"`的字符串中没有任何意外的 s ，因为那会搞砸

这段代码

```
public static void Main()
{
    Regex regex = new Regex(".+ABC(...)");

    Match match = regex.Match("baln390nABCqlcln");
    foreach (Group group in match.Groups)
    {
        Console.WriteLine(group.Value);
    }
} 
```

给出这个输出

```
baln390nABCqlc
qlc
Press any key to continue . . . 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:04:13.073

```
<tr class="text" .+ABC(?<capture>.{3}) 
```

结合`RegexOptions.Singleline`（以便`.`匹配换行符）。

# php - 使用 javascript、php 和 ajax 提供更新建议列表

> ID：13503440
> 
> 赞同：0
> 
> 时间：2012-11-21T22:58:51.910
> 
> 标签：php, javascript, ajax

我正在尝试修改[此示例](http://www.w3schools.com/php/php_ajax_php.asp)以制作实时更新列表以将其与我的 API 集成。因此，我不想在带有表单的页面上使用 GET，而是想通过函数调用将其发送到该页面。

好的，所以问题是它没有返回任何东西。我不确定 gethint.php 是否真的收到了一个值。如果您在我提供的链接上查看 gethint.php，它会设置

```
$q = $_GET['q']. 
```

当我回显时没有显示任何内容，所以我认为它没有发送值，尽管警报消息显示了框中的内容（在 message.php 上）

所以，这是我的表格

```
// message.php

//function to display the hint sent from gethint.php
function message_hint($hint){
    echo $hint;
}

//displays the form for sending messages
function send_message_form($to_user,$title,$message){
    include 'gethint.php';
    ?>
    <table>
    <form name = "send_message" method="post">
    <td>Send A Message</td>
    <tr><td>To:</td><td><input type = "text" size="50" name="to_user" id = "to_user" value ="<? echo $to_user; ?>" onkeyup="showHint(this.value)"></td></tr>
    <tr><td>Title:</td><td><input type = "text" size="50" name="message_title"></td></tr>
    <tr><td>Message:</td><td><textarea rows="4" cols="50" name="message_details"></textarea></td></tr>
    <tr><td><input type="submit" name="submit_message"></td></tr>
    </table>
    </form>
    <?
} 
```

这是message.php的头

```
<head>
<script>
function showHint(str){
var to_user = document.getElementById("to_user").value //to_user is the id of the textbox
if (str.length==0){  
    to_user.innerHTML="";
    return;
}
if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
}else{// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.onreadystatechange=function(){
    if (xmlhttp.readyState==4 && xmlhttp.status==200){
            alert(to_user) //properly displays the name via alert box
        to_user.innerHTML=xmlhttp.responseText;
    }
}
xmlhttp.open("GET","gethint.php?q="+to_user,true);
xmlhttp.send();
}
</script>
</head> 
```

除了底部的这个之外，页面 gethint.php 完全相同。

```
//echo $response //this was the original output
$message = new messages;
$message->message_hint($response); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:14:03.320

首先，我推荐使用 jQuery 进行 AJAX 调用。请参阅[这些示例](https://stackoverflow.com/questions/13499559/make-div-text-change-on-click-based-on-php-data-using-ajax/13501242#13501242)。

接下来，我建议使用 jQueryUI 来实现自动完成功能。请参阅[此页面上的示例](http://jqueryui.com/autocomplete/)。

您的代码将减少 > 50%，您可能会发现它更容易理解。

# php - 验证和存储密码的问题

> ID：13503441
> 
> 赞同：-1
> 
> 时间：2012-11-21T22:59:00.977
> 
> 标签：php, mysqli

我最近在我的注册页面中为我的密码添加了加密。

注册页面提取：

```
$hashed_password = crypt('pass1'); 
mysqli_query($mysqli, "INSERT INTO Persons (Username, Password, Email, Gender) VALUES ('$euser', '$hashed_password', '$eemail', '$gender')"); 
```

这工作正常，据我所知，所有数据都正确输入到数据库中。

登录页面虽然不验证表单。

登录页面提取

```
if( $page_mode == 'Login' )
{
    $username = $_POST['username'];
    $password = $_POST['password'];
    if( trim($username) == '' || trim($password) == '' )
    {
        $error_string .= '<font color=red>You have left either the username or password field blank!</font>';
    }
    else
    {
        require "globe.php";
        $result = mysqli_query("SELECT PlayerID, Username, Password FROM Persons WHERE Username='" . mysqli_real_escape_string($username) . "'");
        $has_pass = crypt($password, $row['Password']); 
        if( !($row = mysqli_fetch_assoc($result)) || ($row['Password'] != $has_pass) )
        {
            $error_string .= '<font color=red>Please check your username or password. Your details weren\'t correct.</font> ';
        }
        else 
        {
        $error_string .= '<font color=red>login not ready </font> ';
        mysqli_close($mysqli);
        }
    }
} 
```

这似乎没有检查它。我也看不出为什么？任何人都知道

如果用户名和密码字段为空，则唯一有效的是错误消息。

编辑：

假设密码是“测试”，我输入测试验证它的页面（也是登录页面）只返回背景。

如果我输入其他内容，同样的问题。

编辑：

添加了所有的支持。但仍然没有运气

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:00:58.563

`$has_pass = crypt('$password');`

您正在尝试在单引号内插入变量。只需使用

`crypt($password);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:05:38.403

除了`crypt()`其他答案指出的错误之外，而不是

```
$mysqli_query(... 
```

写

```
mysqli_query(... 
```

更不用说您有条件地关闭 mysqli 连接，而您应该始终关闭它。

**编辑**

尝试这个

```
if( $page_mode == 'Login' )
{
    $username = trim($_POST['username']);
    $password = trim($_POST['password']);

    if( ($username == '') || ($password == '') ) {
        $error_string .= '<font color=red>You have left either the username or password field blank!</font>';
    } else {
        require "globe.php";

        $query = sprintf("SELECT PlayerID, Username, Password FROM Persons WHERE Username='%s' LIMIT 1",
                                                mysqli_real_escape_string($mysqli, $username) );

        $result = mysqli_query( $query );

        if( ($result !== false) && (mysqli_num_rows($result) == 1) ) { 
          $row = mysqli_fetch_assoc($result);
          if( $row['Password'] != crypt($password, $row['Password']) ) {
              $error_string .= '<font color=red>Please check your username or password. Your details weren\'t correct.</font> ';
          } else {

              // OK

          }
        } else {
            $error_string .= '<font color=red>Please try again</font> ';
        }

        mysqli_close($mysqli);
    }
} 
```

您仍然需要检查`$result`以确保查询成功，并`$row`确保该用户可以从中获取密码的输入，但我故意将其作为您的作业:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T23:09:44.950

您必须将原始盐提供给`crypt`.

```
$has_pass = crypt($password, $row['password']); 
```

编辑：您需要将数据库句柄传递给`mysqli_query`. 就像是：

```
$result = mysqli_query($mysqli, "SELECT PlayerID, Username, Password FROM Persons WHERE Username='" . mysqli_real_escape_string($username) . "'"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T00:22:22.033

尝试添加 mysqli 句柄作为 mysqli_real_escape_string 的第一个参数并检查你得到一行 - mysqli_real_esacpe_string($handle,$string)

# visual-studio - Visual Studio 键绑定配置文件

> ID：13503447
> 
> 赞同：5
> 
> 时间：2012-11-21T23:00:10.613
> 
> 标签：visual-studio, visual-studio-2008, visual-c++, keyboard-shortcuts

Visual Studio 是否有任何人工可编辑的配置文件用于其键绑定？Options->Environment->Keyboard 对话框完全损坏（或者至少使用起来太乏味），并且从 Visual C++ 5 开始，我真的只想转到 Visual Studio 将键绑定保存到的配置文件和直接编辑。

想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-28T13:41:21.537

不是最理想的格式，但您的个人资料中有 currentsettings.vssettings 文件。有一个部分看起来像这样

```
<UserShortcuts>
    <RemoveShortcut Command="Edit.LineOpenAbove" Scope="Text Editor">Ctrl+Enter</RemoveShortcut>
    ...
    <Shortcut Command="Refactor.Rename" Scope="Text Editor">F2</Shortcut>
    ...
</UserShortcuts> 
```

一旦你有了你可能感兴趣的所有命令的列表，在文件中编辑你的默认键盘设置应该是相当容易的。在工具菜单下是从 vssettings 文件导入/导出设置的选项。

# python - 稍后在模块中定义的方法的 Python NameError

> ID：13503448
> 
> 赞同：-3
> 
> 时间：2012-11-21T23:00:16.960
> 
> 标签：python

为什么python要求你在同一个模块中使用它们之前定义方法

例如

```
def a():
  b()
def b():
  ... 
```

不起作用，因为 b() 是在 a() 之后定义的，它在其主体内调用 b()

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T23:03:06.847

`a()`像这样的代码应该可以工作，除非您在 the`def a()`和`def b()`part之间调用，因为在这种情况下`a()`会被执行，试图执行`b()`，这在那个时间点还没有定义。

# twitter-bootstrap - 引导模式和 SEO

> ID：13503451
> 
> 赞同：1
> 
> 时间：2012-11-21T23:00:38.113
> 
> 标签：twitter-bootstrap, seo

我的整个网站都是基于 Bootstrap 的，我已经用[modals](http://twitter.github.com/bootstrap/javascript.html#modals)替换了实际页面。当访问者点击“关于、联系方式等”等按钮时。将弹出一个模式。我如何 SEO 优化这些？首先，我想在模态框内将 iframe 显示到 .html 页面（about.html、contact.html），它只包含内容和元标记，但如果访问者直接访问这些 URL，他们只会看到相应的内容.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:52:31.197

我建议您在不使用 javascript 和不使用 iframe 的情况下创建一个纯 HTML（`Back-end`PHP/ASP/.NET）网站（iframe 对 SEO 不利），然后使用`ajax`抓取这些子页面的内容并将这些模式和其他内容放在您的地点。

您还可以使用`Ajax`in实现分页`HASH`。

# oracle - 在不影响查询的情况下截断 oracle mview

> ID：13503454
> 
> 赞同：0
> 
> 时间：2012-11-21T23:00:48.923
> 
> 标签：oracle, locking, materialized-views

我在一个 Oracle 11g 数据库中有几个 MV，它们在非原子时会迅速完全刷新。一个新的要求意味着他们必须是。

我知道当非原子 DBMS_MVIEW.REFRESH 在一系列插入之前执行截断但是当 atomic => true 时，所有记录都首先被删除。仅删除记录需要一个多小时，而非原子版本只需几分钟。

我需要一种方法来允许对这个 MV 的查询在我刷新它时继续。FAST 刷新方法是不可能的，因为 MV 查询使用计数并且大多数记录无论如何都会有变化。

所以，我想出的结构是这样的：

```
LOCK TABLE FOOBAR_MVIEW_LOCK IN EXCLUSIVE MODE;
SELECT * FROM FOOBAR_MVIEW_DATA1,FOOBAR_MVIEW_DATA2;
COMMIT; 
```

和

```
LOCK TABLE FOOBAR_MVIEW_LOCK IN EXCLUSIVE MODE;
EXECUTE DBMS_MVIEW.REFRESH( 'FOOBAR_MVIEW_DATA1,FOOBAR_MVIEW_DATA2','cc');
COMMIT; 
```

有没有更好的办法？注意。当我开始谈论分区切换时，我的组长很紧张。:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:17:01.607

您注意到当您开始谈论分区切换时，您的团队负责人很紧张。这是否表明您已获得分区选项的许可，因此如果我们能够解决团队负责人的任何问题，这将是可能的吗？或者这是否表明我们应该放弃该选项？

如果分区切换不是一种选择，则方法是使用同义词，将指向一个表（或物化视图）的同义词翻转到另一个表。所以，例如

*   重命名`FOOBAR_MVIEW_DATA1`为`FOOBAR_MVIEW_DATA1_BASE1`
*   创建`FOOBAR_MVIEW_DATA1`同义词`FOOBAR_MVIEW_DATA1_BASE1`
*   `FOOBAR_MVIEW_DATA1_BASE2`创建一个结构相同的空表`FOOBAR_MVIEW_DATA1_BASE1`
*   当您想要刷新物化视图时，将数据插入`FOOBAR_MVIEW_DATA1_BASE2`并在预建表上创建物化视图。
*   刷新数据后，将同义词`FOOBAR_MVIEW_DATA1`指向`FOOBAR_MVIEW_DATA1_BASE2`
*   在未来某个时间点，当现有查询全部完成时，您可以 truncate `FOOBAR_MVIEW_DATA1_BASE1`。您可以选择重命名`FOOBAR_MVIEW_DATA1_BASE1`，`FOOBAR_MVIEW_DATA1_BASE2`以便您始终拥有相同的物化视图刷新起点（`_BASE1`有数据且`_BASE2`为空），或者您可以编写刷新代码来检查同义词指向的位置并加载任何不指向的表被同义词引用。

# javascript - 网络音频检查音频源是否有效

> ID：13503455
> 
> 赞同：2
> 
> 时间：2012-11-21T23:00:49.787
> 
> 标签：javascript, web-audio-api

我想知道是否有任何方法可以检查我得到的来源是有效的还是什么都没有。

我从数据库中获得了一个名称，但我不知道它是否存储为 mp3 或 wav 或其他任何内容。所以我需要一种方法，所以如果我将名称放在存储音频文件的路径之后，我可以检查是否必须在其后面添加 .mp3 或 .wav。

我没有使用 html5 音频标签！

这是我正在使用的代码片段

```
loadTracks = function(title,tracksrc) {
    sources.push({name: title, src: 'http://eng.studev.groept.be/web2.0/a12_web02/Katrijne/uPlay2audio/audio/tracks/' + tracksrc + '.mp3'}); 
    } 
```

有任何想法吗？

谢谢！

# android - 如何在手机应用程序之间进行通信？

> ID：13503458
> 
> 赞同：0
> 
> 时间：2012-11-21T23:00:57.753
> 
> 标签：android, networking, mobile

我在这里问这个是因为我什至不知道如何向谷歌表达它......

我想知道一个手机应用程序（例如，Android，限制范围）是否有某种方式可以通过电话网络与另一部手机上的同一应用程序进行通信（或仅发送一种方式数据）。

我想要的是一种短信（或者知道是否可以为此目的使用短信），我从手机中的应用程序发送的数据是远程电话上的对等应用程序可以理解的，远程电话将知道使用什么应用程序来处理该数据。

Internet似乎不是这种情况，因为我想通过电话号码识别消息的接收者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:04:59.583

您正在寻找 Google 云消息传递：

[http://developer.android.com/guide/google/gcm/index.html](http://developer.android.com/guide/google/gcm/index.html)

网站上有很多很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T21:29:17.537

我目前正在做类似的事情。如果您要发送相对较大的数据包，GCM 似乎是一个不错的选择。我正在追求使用 SMS 发送少量轮询或定期数据。至少在 Android 中，您可以创建一个广播接收器来接收短信通知（android.provider.Telephony.SMS_RECEIVED），并且您可以根据发送者、消息数据等中止广播，从而阻止向用户发送关于短信。

# java - 在java中处理多线程套接字连接

> ID：13503459
> 
> 赞同：0
> 
> 时间：2012-11-21T23:01:01.140
> 
> 标签：java, multithreading, io, thread-safety

我有一个服务器和一个客户端。服务器能够处理多个请求。客户端打开一个套接字并发送一个字节流。服务器正在处理时，它的行为不正确。从客户我发送以下几行

将此添加为您的客户

标题：客户1

5个不同的客户

我正在使用字符串生成器来构建如上所述的格式化字符串。

```
 for (i=0; i<6; i++)
 {
     Socket socket = new Socket(host, port);
     StringBuilder sb = new StringBuilder();
                    sb.append("ADD this as your client ");
                    sb.append("\r\n");
                    sb.append("Title: Client");
                    sb.append(i);
                    sb.append("\r\n");
                    String ToSend = sb.toString();

                    /// New Additions
                    byte[] byteArray = ToSend.getBytes();
                    OutputStream os = socket.getOutputStream();
                    DataOutputStream dos = new DataOutputStream(os);
                    dos.writeInt(byteArray.length);
                    dos.write(byteArray,0,byteArray.length);
                    socket.close();
                   } 
```

在服务器中，我正在这样阅读。

```
 public static void main(String[] args) {
    Sampleserver file_rec = new Sampleserver();
   try {
  ServerSocket listener = new ServerSocket(port);

  while (true) {
    file_rec.socket = listener.accept();  
    new Thread(file_rec).start();
  }
}
catch (java.lang.Exception ex) {
  ex.printStackTrace(System.out);
}

}
public void run() {
try {
    InputStream is = socket.getInputStream();
    DataInputStream dis = new DataInputStream(is);
    int length = dis.readInt();
    System.out.println("Length value is " + length);
    byte[] mybytearray = new byte[length];

   int bytesRead = is.read(mybytearray, 0, length);

    String s = new String(mybytearray, 0, length);
    System.out.println(s);
    if (s.contains("ADD"))
    {
        System.out.println("Inside ADD. ");

    }
    else
    {
        System.out.println("Default ");
    }

 }

catch (java.lang.Exception ex) {
  ex.printStackTrace(System.out);
} 
```

}

但是每次在服务器中我都会得到奇怪的输出。我认为在线程环境中（在运行方法中）处理它时，我没有正确处理字节数组或在服务器中错误地处理它。你能告诉我哪里出错了。

# google-chrome - 新的 Google Chrome 控制台不区分更新的记录对象

> ID：13503462
> 
> 赞同：5
> 
> 时间：2012-11-21T23:01:09.270
> 
> 标签：google-chrome, webkit, console

我正在运行版本 23.0.1271.64

这些最新更新之一更新了 Google Chrome 中的 Web 开发人员视图。

许多功能都很好，但控制台的更新似乎被破坏了。

如果你有一个对象

```
var object = {'one':true, 'two':false} 
```

和`console.log(object)`

然后对对象进行更改

```
object.one = false 
```

再`console.log(object)`一次（比如在点击事件之后）

更改不会反映，控制台将简单地增加对象名称旁边的计数器。

这是一个错误还是一个新的“功能”？旧控制台将反映对象更新。

# sql-server - 有没有办法要求/强制在查询字符串中使用特定服务器（在 SSMS 中运行时）？

> ID：13503463
> 
> 赞同：0
> 
> 时间：2012-11-21T23:01:12.167
> 
> 标签：sql-server, tsql, ssms

我知道您可以[使用 SSMS 中的 GUI](http://goo.gl/PZ3Ks "在 SSMS 中指定服务器")来指定要运行的服务器。

有没有一种请求特定服务器的方法，类似于在查询脚本中说“***使用 ServerA.[DBName] ”？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:25:35.500

**很确定这是不可能的。**（就像我们更改数据库名称所做的那样 `USE [db_name]`）

但是，有一种技术`Linked Server`允许您在查询中连接到第二个服务器并使用第二个数据源上的资源。

有关详细信息，请参阅此链接[http://msdn.microsoft.com/en-us/library/ms188279.aspx](http://msdn.microsoft.com/en-us/library/ms188279.aspx)

例如：

```
select foo.id 
from db1.table1 foo, 
     Server2.db_name.scheman_name.table_name bar 
where foo.name=bar.name 
```

另一个答案（OpenDataSource）中提到的是：

> 作为四部分对象名称的一部分的即席连接信息，而不使用链接服务器名称。

这几乎是一个隐含的`Linked Server`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:18:41.500

Using [OpenDataSource](http://msdn.microsoft.com/en-us/library/ms179856.aspx) might be a way to set which server instance to access within the scope of a query - you may want to consult [this SO question](https://stackoverflow.com/questions/545364/tsql-command-to-connect-to-another-server-sql-server-2005) for more background/details.

Another option might be a `TRY..CATCH` block where the query verifies that it's being run on the correct server using [`SERVERPROPERTY()`](http://msdn.microsoft.com/en-us/library/ms174396.aspx), and throws an exception if it isn't - this lets you put a more human-readable error message out for the user.

# actionscript-3 - 更改没有实例名称的影片剪辑的属性（仅具有类名称的字符串）

> ID：13503466
> 
> 赞同：0
> 
> 时间：2012-11-21T23:01:22.667
> 
> 标签：actionscript-3, flash

我有一个带有“myClass”类且没有实例名称的影片剪辑。我正在尝试使用此更改 alpha

```
var i:int = this.numChildren;
while(i--){
    if (this.getChildAt(i) is myClass){

        this.getChildAt(i).alpha = 0.5;
    }
} 
```

这种方法有两个问题：

1-我不能使用类的字符串名称。没有 getClass 或某种方法可以比较吗？

```
if (this.getChildAt(i) is "myClass"){ 
```

2- 当我找到影片剪辑并更改 alpha 时，我会破坏现有动画。为什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:21:16.033

`getDefinitionByName()` [(see docs here)](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/package.html#getDefinitionByName%28%29) is what you need.

```
var className:String = "com.MyClass";
var clazz:Class = flash.utils.getDefinitionByName(className) as Class;
var i:int = this.numChildren;

while(i--){
    if (this.getChildAt(i) is clazz){
        this.getChildAt(i).alpha = 0.5;
    }
} 
```

# c# - 当我处理 (COUNT) Int32 时，出现错误：从字符串转换日期和/或时间时转换失败

> ID：13503474
> 
> 赞同：-3
> 
> 时间：2012-11-21T23:02:28.233
> 
> 标签：c#, sql-server, tsql, exception-handling, ado.net

为什么我会收到此错误，我该如何解决？

ADO.NET 代码：

```
myConnection.Open();

string cmdStr = "SELECT COUNT(*) FROM Sale WHERE Date = '" + DateTime.Today + "' AND User = '" +     UserBox.Text + "'";

SqlCommand Pexist = new SqlCommand(cmdStr, myConnection3);

int P = Convert.ToInt32(Pexist.ExecuteScalar().ToString());

myConnection.Close(); 
```

错误：

> 从字符串转换日期和/或时间时转换失败。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T23:08:26.710

您收到此错误是因为您不使用参数。

```
string cmdStr = "SELECT COUNT(*) FROM Sale WHERE Date = @dt " + 
                 "AND User = @usr " +     
                 "AND Item = @itm " + 
                 "AND Name = @name";

 SqlCommand Pexist = new SqlCommand(cmdStr, myConnection3);
 Pexist.Parameter.AddWithValue("@dt", DateTime.Today);
 Pexist.Parameter.AddWithValue("@usr", UserBox.Text);
 Pexist.Parameter.AddWithValue("@itm", ID505.Text);
 Pexist.Parameter.AddWithValue("@name", DropDownList1.SelectedItem.ToString());
 object result = Pexist.ExecuteScalar();
 int P = (result == null ? 0 : Convert.ToInt32(result));
 myConnection.Close(); 
```

当您使用参数时，您让数据库引擎处理您的输入字符串。数据库引擎知道如何处理日期、字符串和数字。您无需解析问题，并且避免了[Sql 注入攻击。](https://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain)

例如，如果文本框 ID505 包含单引号，查询字符串中会发生什么情况？

此外，ExecuteScalar 返回一个对象

> 结果集中第一行的第一列，如果结果集为空，则为空引用（在 Visual Basic 中为 Nothing）

因此，最好在尝试将结果转换为整数之前检查 null。

**编辑**一段时间后回顾这个问题，我应该补充一点，在这种特殊情况下，来自 ExecuteScalar 的返回永远不会为空。之所以如此，是因为查询使用聚合函数 COUNT(*)，即使在未找到记录的情况下也将始终返回一个有效数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:05:40.373

一定要使用参数。它更安全，可以帮助您解决此类转换问题......

```
string cmdStr = " SELECT COUNT(*) FROM Sale WHERE Date = @d AND User = @u AND Item = @i AND Name = @n";
SqlCommand Pexist = new SqlCommand(cmdStr, myConnection3);
Pexist.Parameters.Add("d", SqlDataType.DateTime).Value = DateTime.Today; 
```

等等...

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-21T23:07:13.470

将 DateTime.Today 替换为 DateTime.Today.ToString("yyyy/MM/dd") 应该可以解决您的问题。

# c - 为什么一个空的 C 程序编译为 47902 字节？

> ID：13503475
> 
> 赞同：1
> 
> 时间：2012-11-21T23:02:29.800
> 
> 标签：c, windows, gcc

> **可能重复：**
> [为什么 C/C++ “Hello World” 以千字节为单位？](https://stackoverflow.com/questions/11815005/why-is-a-c-c-hello-world-in-the-kilobytes)

考虑以下用 ANSI C 编写的程序。

```
file: test.c
main() {} 
```

我在 Windows 7 上。我使用 MinGW 来编译这个文件。

```
$ gcc test.c 
```

然后，我想看看这个文件的大小。

```
$ ls -la a.exe
-rwxr-xr-x 1 Username Administrators 47902 Nov 21 15:57 a.exe 
```

看起来这个完全空的、毫无价值的 C 程序编译成一个*大小接近 50 KB*的二进制文件。为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T23:14:12.177

像`gcc -v test.c`. GCC（编译器驱动程序）产生`cc1`（编译器）、`as`（汇编器）和`ld`（链接器）。查看链接器命令行，您会看到在最终可执行文件中链接的几个文件（例如`crti.o`、`crt0.o`、`crtbegin.o`、`crtend.o`等）。其中一些可能会从`libgcc.a`或获取符号`libc.a`。这就解释了为什么大小不仅仅是几个字节。

您也可以运行它`-Wl,-Map=map.txt`来生成一个映射文件，该文件将显示每个对象和库中的每个函数或变量，这些对象和库包含在最终的可执行文件中。

# php - 寻找短期解决方案以通过附加服务器提高网站性能

> ID：13503476
> 
> 赞同：1
> 
> 时间：2012-11-21T23:02:31.683
> 
> 标签：php, mysql, performance, optimization, cluster-analysis

我正在与一个小团队合作运行一个使用 PHP 5.3.9、MySQL 5.0.77 运行的内部网站。所有文件和数据库都托管在具有以下配置的专用 Linux 机器上：

Intel Xeon E5450 8 CPU cores @3.00GHz, 2992.498 MHz, Cache 6148 KB, Cent OS – Red Hat Enterprise Linux Server 5.4 版

我们从小开始，然后数据库变得更大，现在网站性能显着下降。我们经常遇到服务器空间溢出、mysql 因调用过多而过载等问题。我们没有太多处理这些问题的经验。我们最近得到了另一台服务器，我们正在考虑使用它来提高性能。由于它具有更好的配置，我们中的一些人希望将所有东西完全转移到新机器上。但我试图找出我们如何利用这两台机器来优化性能。我找到了诸如 MySQL 集群、负载均衡器等选项。我想知道是否可以针对这种情况获得任何建议“如何在短期内利用两台机器以获得最佳性能”，那太好了。从短期来看，我们正在寻找可以在一个月左右部署的东西。

在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:08:51.453

使网站在具有某种负载平衡的两台服务器上运行比您预期的要困难得多......

我解决这个问题的方法是让团队中的某个人调查与数据库相关的问题，例如慢速查询（MySQL 可以配置为记录任何花费超过一定时间才能完成的查询），然后检查原因（使用 MySQL EXPLAIN）。很少有索引可以解决关键故障点，让您有时间提出可靠的长期解决方案。如果数据库的优化非常糟糕，这甚至可以消除现在做任何其他事情的需要！

您可以将 MySQL 移动到同一网络中的另一台机器上，这样您就可以分离 Web 服务器负载和 DB 负载。

考虑缓存一些不经常更改但在网站上的每个请求上加载的数据部分。Memcached、redis 缓存、文件缓存，什么都可以。

另一个短期解决方案（与开发人员的时间相比更便宜）是用 SSD 替换 HDD，特别是如果您有磁盘需要大量查找的查询。根据我的个人经验，这可能会产生巨大的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:28:52.340

*   您使用的是 2009 年 1 月发布的 MySQL 5.0.77。MySQL 的性能和可扩展性有了很大的改进。您应该升级到当前版本，即撰写本文时的 5.5.28。仅此一项就应该会给您带来很多性能改进。

*   您应该分析您的查询以确保您有精心选择的索引。这是提高性能的关键步骤。请参阅我的演示文稿[如何设计索引，真正](http://www.slideshare.net/billkarwin/how-to-design-indexes-really)了解如何做到这一点的一些技巧。

*   在现代版本的 MySQL 中，InnoDB 几乎总是比 MyISAM 更好的存储引擎选择。始终进行测试以确保，因为在某些极端情况下 MyISAM 可能仍然运行得更快。尽管 InnoDB 有更多的调优参数，但设置好它们很重要，因为默认值太低而无法获得良好的性能。[您可以在我的演示MySQL 5.5 Guide to InnoDB Status](http://www.slideshare.net/billkarwin/mysql-55-guide-to-innodb-status)中获得一些关于调整 InnoDB 配置参数的见解。

*   您应该将数据库放在与您的应用程序分开的专用服务器上。对性能的最佳单一改进通常是增加您投入的内存量`innodb_buffer_pool_size`（假设您使用 InnoDB 存储引擎）。

*   正如@Veseliq 建议的那样，为您的数据目录升级到 SSD 驱动器是提高性能的好方法。

*   也配置 MySQL`tmpdir`以使用您的 SSD 驱动器。

*   如果您无法获得 SSD 驱动器，那么下一个最好的选择是带有回写缓存的 RAID 控制器。

*   设置 MySQL 配置`skip_name_resolve`以消除应用程序连接时对 DNS 反向查找的依赖。如果这样做，则需要通过 IP 地址而不是主机名授予 SQL 权限。

*   其他各种 Linux 调优改进：

    *   在您的数据目录上使用**XFS**文件系统，而不是 Linux 默认的 ext3。
    *   **使用noatime**选项挂载文件系统。
    *   使用**截止日期**磁盘 I/O 调度程序，而不是 Linux 默认的 cfq。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:33:05.203

最简单的第一步是将数据库和前端应用程序进程分开，将它们放在不同的机器上。`mysqld`这通常使您可以通过修改设置为进程分配更多内存`my.cnf`。

与往常一样，更新到最新版本的堆栈和后端，以确保最大限度地利用硬件。

密切注意系统上运行的数据库调用，看看是否有任何方法可以加快这些调用。`EXAMINE`例如，通常可以显示任何给定调用的执行策略`SELECT`，并且会揭示您缺少索引的位置，这通常是最大的性能拖累。如果您遇到“表扫描”或“使用文件排序”的问题，那么您在大型数据集上基本上就死定了。您需要索引或不同的架构。

第二步是添加更多的前端应用服务器，并添加某种负载均衡器。这为您提供了额外的前端容量以更好地处理负载，但也会使您的数据库负载更多。

第三步是确保您在通话`JOIN`过程中没有进行任何不必要的操作。`SELECT`非常仔细地检查您需要从数据库中获取的内容，并尝试一次从一张表中获取所有内容。战术反规范化通常是这里的解决方案，但如果您不小心正确地执行此操作，则会出现同步问题。当你这样做时要密切注意，并确保你有广泛的测试覆盖率。

第四步通常是通过使用像[Memcached](http://memcached.org/)这样的缓存来缓冲数据库上的大量读取活动，以避免经常访问数据库。请记住，最快的数据库调用是您不调用的。

没有灵丹妙药，但如果你按照这个顺序做事，你应该有一个战斗的机会。

# php - 是可靠性数组键，它开始没有字母数字而不是破折号？

> ID：13503479
> 
> 赞同：-3
> 
> 时间：2012-11-21T23:03:12.337
> 
> 标签：php, arrays, key

我有这个代码

```
$arr['... key'] = 'value'; 
```

这有效并且不返回错误，但我感兴趣的是，数组键有多少合理性，像这样`'... key'` ？（这里，在点之后，也是空间）。由于这些密钥，可能会遇到一些问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T23:09:27.623

您没有理由不能使用您想要的任何字符串作为键名。它不会导致任何错误或其他问题。奇怪的键可能很难让您记住或跟踪，并且在设计方面使用它们可能不是一个好主意，但 PHP 不在乎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:08:18.817

好吧，认真地说：如果你想使用**......**没关系，任何刺痛都很好，但不常见，可能会让其他人感到困惑，某些字体\屏幕可能会使它们难以阅读 - 所以我不会，但如果你愿意，你可以到。

> 键可以是整数或字符串。该值可以是任何类型。此外，还会发生以下关键转换：
> 
> *   包含有效整数的字符串将被转换为整数类型。例如，键“8”实际上将存储在 8 下。另一方面，
>     “08”不会被强制转换，因为它不是有效的十进制整数。
> *   浮点数也被转换为整数，这意味着小数部分将被截断。例如，密钥 8.7 实际上将存储在 8 之下。
> *   布尔值也被转换为整数，即键 true 将实际存储在 1 下，而键 false 将存储在 0 下。
> *   Null 将被强制转换为空字符串，即键 null 将实际存储在 "" 下。
> *   数组和对象不能用作键。这样做会导致警告：非法偏移类型。

[http://www.php.net/manual/en/language.types.array.php](http://www.php.net/manual/en/language.types.array.php)

# xcode - 为什么 xcode 不显示 MainStoryBoard？

> ID：13503480
> 
> 赞同：0
> 
> 时间：2012-11-21T23:03:15.973
> 
> 标签：xcode

我很困惑。我正在学习应用程序开发课程，当我在学校的计算机上打开文件时，我们正在阅读“自学 iPhone OS 应用程序开发”，它显示了 mainstoryboard，但它没有显示在我的笔记本电脑上？我确保我使用的是相同版本的 Xcode 和相同的文件。

![在此处输入图像描述](../Images/01df0fc86cf3e3199b0a3a6ff378ea60.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:21:10.150

That's because you are looking at XIB files and not storyboard files.

XIB files usually contain single view controllers (and other objects), while storyboards (usually one storyboard per architecture) have multiple view controllers and segues to nicely get between them.

If you want to see changes to the UI within the program created by project you've created a screenshot of, you'll need to modify the files with the "`.xib`" extension. Both storyboards and XIB files are editable with Xcode's built in Interface Builder functionality.

# java - 阻止线程执行某些方法

> ID：13503482
> 
> 赞同：1
> 
> 时间：2012-11-21T23:03:18.403
> 
> 标签：java, multithreading, security, templating

我有一个模板系统，允许用户输入模板源代码并执行它们。模板源代码可以访问任意 Java 对象，包括 System、Runtime 和 IO 类。

问题是如何防止正在执行的线程调用某些方法，例如`System.exit`，`new FileOutputStream`等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:45:30.863

一种（相当繁重但可行）的方法是：

1.  使用 Java 代理转换所有已加载（过去和将来）的类，以便对列入黑名单的方法的调用实际上重定向到不同的方法。您可以为此使用[ClassFileTransformer](http://docs.oracle.com/javase/6/docs/api/java/lang/instrument/ClassFileTransformer.html)和[ASM](http://asm.ow2.org/asm40/javadoc/user/index.html)。因此，例如`System.exit`现在调用 to 将调用`MySystem.exit`. 当然`MySystem`不应该改造。
2.  的代码可以基于例如变量`MySystem.exit`有条件地调用。`System.exit``ThreadLocal`

```
    公共类我的系统{
        private static final ThreadLocal callOriginal = new ThreadLocal();

        静态公共最终无效退出（int代码）{
            if (Boolean.TRUE.equals (callOriginal.get ())) {
                System.exit（代码）；
            }
        }
    }

```

1.  对于要调用原始调用的线程，将其设置`ThreadLocal`为`true`，其他线程设置为`no`。

您可能想查看类似解决方案的[时间机器](http://www.javart.org/timemachine/)库源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T08:03:35.003

O 有一些方法可以做到这一点。但最体面的方法是使用安全管理器并编写自己的类加载器（不应该花太多时间，因为谷歌搜索会给你很多例子:)）。当您将一个类（在运行时编译和加载）加载到类加载器时，您需要指定安全管理器。在该代码中，您可以提供限制。

我不知道它是否是合法链接，但这[应该](http://docstore.mik.ua/orelly/java-ent/security/ch03_01.htm)会有所帮助。

[这](https://stackoverflow.com/questions/11606787/security-restrict-internal-access-by-third-party-software)也可以提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-23T10:31:04.687

假设我们谈论的是解释器而不是生成的代码。安装`SecurityManager`后，可以通过减少解释器代码权限的策略来减少权限。

如果您使用 的两个参数形式`java.security.AccessController.doPrivileged`，则调用方法会检查直接调用者并忽略传递给它的任何内容（例如，`AccessController.doPrivileged`）。

显然，托管不受信任的代码会暴露出*巨大*的攻击面。您可以通过使用在类加载器层次结构中彼此对等的类加载器来隐藏一些您自己的代码。安全属性 package.access 也很有用（尽管您仍然需要单独的类加载器）。

# eclipse - Eclipse 项目生成：向类路径条目添加“排除”属性

> ID：13503487
> 
> 赞同：0
> 
> 时间：2012-11-21T23:03:47.277
> 
> 标签：eclipse, gradle

Gradle 很好地生成了我的 eclipse .classpath 内容，其中包括：

```
<classpathentry kind="src" path="src/main/java"/>
<classpathentry kind="src" path="src/test/java"/> 
```

但我真正想要的是：

```
<classpathentry excluding="**/.DS_Store" kind="src" path="src/main/java"/>
<classpathentry excluding="**/.DS_Store" kind="src" path="src/test/java"/> 
```

如何在生成 eclipse 项目时自定义 gradle 以动态添加此“排除”属性？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:59:56.053

您可以使用手动执行此操作`withXml`

从 gradle 用户指南：

例 36.5。自定义 XML

构建.gradle：

```
apply plugin: 'eclipse-wtp'

eclipse.wtp.facet.file.withXml { provider ->
    provider.asNode().fixed.find { it.@facet == 'jst.java' }.@facet = 'jst2.java'
} 
```

链接在这里：

[http://gradle.org/docs/current/userguide/eclipse_plugin.html](http://gradle.org/docs/current/userguide/eclipse_plugin.html)

# ruby-on-rails - Rails 欢迎页面尝试在 Nginx + Passenger 中获取 rails.png 时出现错误 404

> ID：13503488
> 
> 赞同：0
> 
> 时间：2012-11-21T23:03:55.837
> 
> 标签：ruby-on-rails, ruby, ubuntu, nginx, passenger

## 我正在使用以下配置：

*   Ubuntu 12.04 桌面 i386
*   红宝石 1.9.3p327
*   导轨 3.2.9
*   节点JS 0.8.14
*   Nginx + Phusion 乘客

## 我按照以下步骤操作：

1.  创建一个新的 Ubuntu 虚拟机进行测试
2.  安装 Ruby + Rails + NodeJS
3.  [从这里](https://www.phusionpassenger.com/download)安装Passenger + Nginx
4.  **在/home/gerald/myapp**中创建一个没有 ActiveRecord 的新 Rails 应用程序（丢弃数据库问题）
5.  在开发模式下运行上述 Rails 应用程序（Rails 服务器）

它工作得很好，我什至可以看到 rails.png 图像。

## 问题是...

...当我将 Nginx 配置为运行上述应用程序时，**rails.png**图像中出现 404 错误。

这些是我添加到**/opt/nginx/conf/nginx.conf**文件的行：

```
http {
    ...
    server {
        listen 80;
        server_name www.mydomain.com;
        root /home/gerald/myapp/public;
        passenger_enabled on;
    }
    ...
} 
```

Nginx error.log 只说：

```
2012/11/19 15:07:06 [error] 17398#0: *1 open() "/home/gerald/myapp/public/assets/rails.png" failed (2: No such file or directory), client: 127.0.0.1, server: localhost, request: "GET /assets/rails.png HTTP/1.1", host: "127.0.0.1", referrer: "http://127.0.0.1/" 
```

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:30:02.183

rails.png 文件是一个资产，它在资产管道中，你应该配置你的 nginx 虚拟主机。

它是这样的：

```
location ~* ^/assets/ {
# Per RFC2616 - 1 year maximum expiry
# http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html
    expires 1y;
    add_header Cache-Control public;

# Some browsers still send conditional-GET requests if there's a
# Last-Modified header or an ETag header even if they haven't
# reached the expiry date sent in the Expires header.
    add_header Last-Modified "";
    add_header ETag "";
    break;
} 
```

检查这个：[链接](https://stackoverflow.com/questions/6402278/serving-precompiled-assets-with-nginx)

# gradle - gradle doLast 哲学

> ID：13503489
> 
> 赞同：21
> 
> 时间：2012-11-21T23:03:59.580
> 
> 标签：gradle, groovy

在 gradle 构建文件中，有多种方法可以指定为特定任务执行的项目。doFirst 方法将一个任务项放在任务堆栈的顶部，以便该项在任务堆栈的其余部分之前执行。如果您需要在主要任务之前做一些准备工作，这非常方便。事实上，如果你多次调用 doFirst，最后一次调用中添加的项是最先执行的。

理论上，doLast 应该做类似的事情，但是 doLast 应该在任务的主要执行完成之后被调用。但是，在 gradle 1.2 中，如果你调用 doLast，然后在 gradle.build 文件中的 doLast 之后向主任务添加一些内容，则主任务项是最后调用的项。例如，以下 gradle 构建文件：

```
task myTask

myTask << {
    println "myTask main execution block"
}

myTask.doFirst {
println "myTask doFirst call one"
}

myTask.doFirst {
    println "myTask doFirst call two"
}

myTask.doLast {
    println "myTask doLast"
}

myTask << {
    println "myTask more main execution block"
} 
```

产生以下输出：

```
:myTask
myTask doFirst call two
myTask doFirst call one
myTask main execution block
myTask doLast
myTask more main execution block

BUILD SUCCESSFUL

Total time: 1.585 secs 
```

我的问题是：doLast 的意图是简单地将步骤附加到任务的末尾（就像 doFirst 附加到开头）？如果是这样，除了提供与 doFirst 的对称性之外，doLast 似乎毫无意义。用户可以简单地执行 myTask << {...} 将某些内容附加到末尾。我原以为 doLast 会确保在主执行块之后完成任何“doLast”项目。

这仅仅是 gradle 的 doLast 应该工作的方式，还是这是一个错误？（或者我只是愚蠢地在调用 doLast 之后在主执行块上附加了一些东西——这是在添加另一个执行块之后的一个简单错误）。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-22T03:32:13.957

`<<`是 的别名`doLast`，所以这里的一切都按预期工作。

# css - 我可以在一个 CSS 元素上有两个背景图像和一个背景颜色吗？

> ID：13503492
> 
> 赞同：2
> 
> 时间：2012-11-21T23:04:07.627
> 
> 标签：css, background-image, background-color

> **可能重复：**
> [多个背景图像和背景颜色](https://stackoverflow.com/questions/5427371/multiple-background-images-and-a-background-color)

我可以有两个背景图像和一个背景颜色吗？

目前我只有这段代码来达到预期的效果：

```
#myelement {
   background: url("http://zbee.me/tz/bottom-right.png") no-repeat right bottom, 
   url("http://zbee.me/tz/top-left.png") no-repeat left top, 
   url("http://zbee.me/tz/bg.png");
} 
```

但我想使用这样的东西：

```
#myelement {
   background: url("http://zbee.me/tz/bottom-right.png") no-repeat right bottom, 
   url("http://zbee.me/tz/top-left.png") no-repeat left top;
   background-color: #35434E;
} 
```

可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:11:13.993

如果您希望同时拥有两张图片并且它们将保持这种状态，那么您可以查看这篇文章，它解释了您需要什么：[我可以使用 CSS 制作多个背景图片吗？](https://stackoverflow.com/questions/423172/can-i-have-multiple-background-images-using-css)

不幸的是，如果您想单独操作背景，则无法进行这样的组合，但是您可以重叠分区，例如在每个具有自己背景的图层中。

你最好的办法是在一个部门中有两个部门，每个部门都有自己的背景和位置，确保父母是相对的，孩子是绝对的：

```
<div id="wrapper">
  <div id="bg1"></div>
  <div id="bg2"></div>
</div> 
```

CSS：

```
#wrapper{
 position:relative;
 width:500px;
 height:500px;
 background: /* The bacground color you need */
}

#bg1{
 position:absolute;
 width: 250px;
 height:500px;
 right:0;
 background: /* The bacground you need and position */
}

#bg2{
 position:absolute;
 width: 250px;
 height:500px;
 left:0;
 background: /* The bacground you need and position */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:12:38.813

这很简单

```
#myelement {
   background: url("http://zbee.me/tz/bottom-right.png") no-repeat right bottom, 
   url("http://zbee.me/tz/top-left.png") no-repeat left top,
   #35434E;
} 
```

该`background`属性[由 background-layers 组成](http://www.w3.org/TR/css3-background/#background)，最后一层可以是颜色。

# java - 在主面板/框架中定位面板和组件

> ID：13503495
> 
> 赞同：0
> 
> 时间：2012-11-21T23:04:22.687
> 
> 标签：java, swing, user-interface, jpanel, layout-manager

我必须创建一个表单，其中包含用户名、密码和其他内容的输入值。这是一个链接到它的样子， http: [//img196.imageshack.us/img196/1727/empdesign.png](http://img196.imageshack.us/img196/1727/empdesign.png)

我希望所有这些属性都与屏幕边缘对齐，而不是居中。我尝试使用 JComponenet.setHorizo​​ntalAlignment(SwingConstants.LEFT) 方法，但这也无济于事。我在 JLabels 和 JPanel 上尝试了这种方法，但都没有效果。

这是我的代码：

```
public class tada extends GUIDesign{

  //making all the jlabels to be placed

JLabel usernameLabel = new JLabel("username");
JLabel passwordLabel = new JLabel("Name");
JLabel empIDLabel = new JLabel("empID");
JLabel SalaryLabel = new JLabel("Salary");
JLabel EmployerLabel = new JLabel(" Salary");
JLabel hoursLabel = new JLabel("Gender");

JLabel departmentLabel = new JLabel("Department");

 //making all the textfields, combo boxes, and etc. 
JTextField usernameField = new JTextField(20);
JTextField passwordField = new JTextField(20);
JTextField empIDField = new JTextField(20);

JTextField SalaryField = new JTextField(20);
JTextField EmployerField = new JTextField(20);
String[] hourss = {"Fall", "Spring", "Summer"};
JComboBox hoursBox = new JComboBox(hourss);

JCheckBox[] departmentCheckBoxesBoxs = {new JCheckBox("Department 1"), 
                                        new JCheckBox("Department 2"), 
                                        new JCheckBox("Department 3"), 
                                        new JCheckBox("Department 4"), 
                                        new JCheckBox("Department 5")};

String[] Salary = {"section", "combo", "box"};
JComboBox sectionBox = new JComboBox(Salary);

//making all the panels to be placed inside the main panel. 

JPanel usernamePanel = new JPanel();
JPanel passwordPanel = new JPanel();
JPanel empIDPanel = new JPanel();
JPanel SalaryPanel = new JPanel();
JPanel EmployerPanel = new JPanel();
JPanel hoursPanel = new JPanel();
JPanel departmentsPanel = new JPanel();

JPanel top, bottom;

JButton submitButton = new JButton("Submit");

public tada(){ 
```

//这从超类初始化面板。没有什么真正重要的继承自超类。super("雇主设计", 10);

```
 setPreferredSize(new Dimension(400,600)); 
```

//将所有标签，文本字段等添加到子面板，并将子面板添加到主面板，底部。setLayout(new BoxLayout(this,BoxLayout.PAGE_AXIS)); 顶部 = 新的 JPanel(); top.setSize(getWidth(), 30); 底部 = 新 JPanel(); bottom.setLayout(new BoxLayout(bottom,BoxLayout.Y_AXIS));

```
 top.setBackground(Color.red);
    title.setFont(new Font("Helvetica", 1,20));
    top.add(title);
    bottom.setBackground(Color.yellow);

    usernamePanel.add(usernameLabel);
    usernamePanel.add(usernameField);
    bottom.add(usernamePanel);

    passwordPanel.add(passwordLabel);
    passwordPanel.add(passwordField);
    bottom.add(passwordPanel);

    empIDPanel.add(empIDLabel);
    empIDPanel.add(empIDField);
    bottom.add(empIDPanel);

    SalaryPanel.add(SalaryLabel);
    SalaryPanel.add(SalaryField);
    bottom.add(SalaryPanel);

    EmployerPanel.add(EmployerLabel);
    EmployerPanel.add(EmployerField);
    bottom.add(EmployerPanel);

    hoursPanel.add(hoursLabel);
    hoursPanel.add(hoursBox);
    bottom.add(hoursPanel);

    departmentsPanel.add(departmentLabel);
    for(JCheckBox jbc: departmentCheckBoxesBoxs)
    {
        departmentsPanel.add(jbc);
    }
    bottom.add(departmentsPanel);

    add(top);
    add(bottom);

} 
```

//另外，由于我使用的是 boxLayout()，并且它与 y_axis 对齐，我认为它会自动执行 y 轴对齐，但事实并非如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:35:47.357

给定您的代码，我能看到的最简单的方法是简单地更改主容器布局管理器。在这里我使用了网格包布局，因为它允许我根据需要更改每个组件的单独要求

![在此处输入图像描述](../Images/a9fd24003a59c9385693155a3df954c0.png)

```
public class BadLayout05 {

    public static void main(String[] args) {
        new BadLayout05();
    }

    public BadLayout05() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new tada());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class tada extends JPanel {

        //making all the jlabels to be placed
        JLabel usernameLabel = new JLabel("username");
        JLabel passwordLabel = new JLabel("Name");
        JLabel empIDLabel = new JLabel("empID");
        JLabel SalaryLabel = new JLabel("Salary");
        JLabel EmployerLabel = new JLabel(" Salary");
        JLabel hoursLabel = new JLabel("Gender");
        JLabel departmentLabel = new JLabel("Department");
        //making all the textfields, combo boxes, and etc.
        JTextField usernameField = new JTextField(20);
        JTextField passwordField = new JTextField(20);
        JTextField empIDField = new JTextField(20);
        JTextField SalaryField = new JTextField(20);
        JTextField EmployerField = new JTextField(20);
        String[] hourss = {"Fall", "Spring", "Summer"};
        JComboBox hoursBox = new JComboBox(hourss);
        JCheckBox[] departmentCheckBoxesBoxs = {new JCheckBox("Department 1"),
            new JCheckBox("Department 2"),
            new JCheckBox("Department 3"),
            new JCheckBox("Department 4"),
            new JCheckBox("Department 5")};
        String[] Salary = {"section", "combo", "box"};
        JComboBox sectionBox = new JComboBox(Salary);
//making all the panels to be placed inside the main panel.
        JPanel usernamePanel = new JPanel();
        JPanel passwordPanel = new JPanel();
        JPanel empIDPanel = new JPanel();
        JPanel SalaryPanel = new JPanel();
        JPanel EmployerPanel = new JPanel();
        JPanel hoursPanel = new JPanel();
        JPanel departmentsPanel = new JPanel();
        JPanel top = new JPanel();
        JPanel bottom = new JPanel();
        JButton submitButton = new JButton("Submit");

        public tada() {

//this initializes the panel from superclass. nothing really important inherited from superclass. super("employer design", 10);

        // This is bad idea...
//            setPreferredSize(new Dimension(400, 600));

//adding all the labels, text fields, etc to the sub-panels, and adding subpanels to main pannel, bottom. setLayout(new BoxLayout(this,BoxLayout.PAGE_AXIS)); top = new JPanel(); top.setSize(getWidth(), 30); bottom = new JPanel(); bottom.setLayout(new BoxLayout(bottom,BoxLayout.Y_AXIS));

            top.setBackground(Color.red);
            JLabel title = new JLabel("Employer Design");
            // This is a bad idea - IHMO
            title.setFont(new Font("Helvetica", 1, 20));
            top.add(title);
            bottom.setBackground(Color.yellow);

            usernamePanel.add(usernameLabel);
            usernamePanel.add(usernameField);
            bottom.add(usernamePanel);

            passwordPanel.add(passwordLabel);
            passwordPanel.add(passwordField);
            bottom.add(passwordPanel);

            empIDPanel.add(empIDLabel);
            empIDPanel.add(empIDField);
            bottom.add(empIDPanel);

            SalaryPanel.add(SalaryLabel);
            SalaryPanel.add(SalaryField);
            bottom.add(SalaryPanel);

            EmployerPanel.add(EmployerLabel);
            EmployerPanel.add(EmployerField);
            bottom.add(EmployerPanel);

            hoursPanel.add(hoursLabel);
            hoursPanel.add(hoursBox);
            bottom.add(hoursPanel);

            departmentsPanel.add(departmentLabel);
            for (JCheckBox jbc : departmentCheckBoxesBoxs) {
                departmentsPanel.add(jbc);
            }

            GridBagConstraints gbc = new GridBagConstraints();
            setLayout(new GridBagLayout());
            gbc.gridx = 0;
            gbc.weightx = 1;
            gbc.fill = GridBagConstraints.HORIZONTAL;

            add(top, gbc);
            gbc.weightx = 0;
            gbc.fill = GridBagConstraints.NONE;
            gbc.anchor = GridBagConstraints.WEST;
            add(usernamePanel, gbc);
            add(passwordPanel, gbc);
            add(empIDPanel, gbc);
            add(SalaryPanel, gbc);
            add(EmployerPanel, gbc);
            add(hoursPanel, gbc);
            add(departmentsPanel, gbc);
            gbc.weightx = 1;
            gbc.fill = GridBagConstraints.HORIZONTAL;
            add(bottom, gbc);

        }
    }
} 
```

更好的解决方案可能是将主要字段添加到单个面板并`GridBagLayout`改用

![在此处输入图像描述](../Images/ae9ab98ce8dd640a94e06b0a5cda965e.png)

```
public class BadLayout05 {

    public static void main(String[] args) {
        new BadLayout05();
    }

    public BadLayout05() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new tada());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class tada extends JPanel {

        //making all the jlabels to be placed
        JLabel usernameLabel = new JLabel("username");
        JLabel passwordLabel = new JLabel("Name");
        JLabel empIDLabel = new JLabel("empID");
        JLabel SalaryLabel = new JLabel("Salary");
        JLabel EmployerLabel = new JLabel(" Salary");
        JLabel hoursLabel = new JLabel("Gender");
        JLabel departmentLabel = new JLabel("Department");
        //making all the textfields, combo boxes, and etc.
        JTextField usernameField = new JTextField(20);
        JTextField passwordField = new JTextField(20);
        JTextField empIDField = new JTextField(20);
        JTextField SalaryField = new JTextField(20);
        JTextField EmployerField = new JTextField(20);
        String[] hourss = {"Fall", "Spring", "Summer"};
        JComboBox hoursBox = new JComboBox(hourss);
        JCheckBox[] departmentCheckBoxesBoxs = {new JCheckBox("Department 1"),
            new JCheckBox("Department 2"),
            new JCheckBox("Department 3"),
            new JCheckBox("Department 4"),
            new JCheckBox("Department 5")};
        String[] Salary = {"section", "combo", "box"};
        JComboBox sectionBox = new JComboBox(Salary);
        JPanel fields = new JPanel();
        JPanel departmentsPanel = new JPanel();
        JPanel top = new JPanel();
        JPanel bottom = new JPanel();
        JButton submitButton = new JButton("Submit");

        public tada() {

            top.setBackground(Color.red);
            JLabel title = new JLabel("Employer Design");
            title.setFont(new Font("Helvetica", 1, 20));
            top.add(title);
            bottom.setBackground(Color.yellow);

            fields.setLayout(new GridBagLayout());
            GridBagConstraints gbcLabels = new GridBagConstraints();
            GridBagConstraints gbcFields = new GridBagConstraints();

            gbcLabels.gridx = 0;
            gbcLabels.gridy = 0;
            gbcLabels.anchor = GridBagConstraints.WEST;
            gbcLabels.insets = new Insets(2, 2, 2, 2);

            gbcFields.gridx = 1;
            gbcFields.gridy = 0;
            gbcFields.anchor = GridBagConstraints.WEST;
            gbcFields.weightx = 1;
            gbcFields.insets = new Insets(2, 2, 2, 2);

            fields.add(usernameLabel, gbcLabels);
            fields.add(usernameField, gbcFields);

            gbcFields.gridy = ++gbcLabels.gridy;

            fields.add(passwordLabel, gbcLabels);
            fields.add(passwordField, gbcFields);

            gbcFields.gridy = ++gbcLabels.gridy;

            fields.add(empIDLabel, gbcLabels);
            fields.add(empIDField, gbcFields);

            gbcFields.gridy = ++gbcLabels.gridy;

            fields.add(SalaryLabel, gbcLabels);
            fields.add(SalaryField, gbcFields);

            gbcFields.gridy = ++gbcLabels.gridy;

            fields.add(EmployerLabel, gbcLabels);
            fields.add(EmployerField, gbcFields);

            gbcFields.gridy = ++gbcLabels.gridy;

            fields.add(hoursLabel, gbcLabels);
            fields.add(hoursBox, gbcFields);

            departmentsPanel.add(departmentLabel);
            for (JCheckBox jbc : departmentCheckBoxesBoxs) {
                departmentsPanel.add(jbc);
            }

            GridBagConstraints gbc = new GridBagConstraints();
            setLayout(new GridBagLayout());
            gbc.gridx = 0;
            gbc.weightx = 1;
            gbc.fill = GridBagConstraints.HORIZONTAL;

            add(top, gbc);
            gbc.weightx = 0;
            gbc.fill = GridBagConstraints.NONE;
            gbc.anchor = GridBagConstraints.WEST;
            add(fields, gbc);
//            add(passwordPanel, gbc);
//            add(empIDPanel, gbc);
//            add(SalaryPanel, gbc);
//            add(EmployerPanel, gbc);
//            add(hoursPanel, gbc);
            add(departmentsPanel, gbc);
            gbc.weightx = 1;
            gbc.fill = GridBagConstraints.HORIZONTAL;
            add(bottom, gbc);

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:10:59.760

`BoxLayout` *确实*将面板与 Y 轴对齐。这是因为它们都是垂直堆叠的。

现在要让组件按您想要的方式排列在右侧，您需要将布局管理器添加到每个子面板（例如，usernamePanel、passwordPanel 等）。一种方法是`BoxLayout`为每个在 X 轴上对齐的新的。然后一定要打电话`setAlignment()`给每个人`JLabel`，`JTextField`让他们在左侧排队。

# zend-framework2 - 我将如何记录成功登录

> ID：13503496
> 
> 赞同：3
> 
> 时间：2012-11-21T23:04:29.780
> 
> 标签：zend-framework2, zfcuser

我将如何在 zfc-user 模块中记录成功登录，以便向用户显示他/她最后一次成功授权的时间？

我在想一个听众，因为 zfcuser 使用事件，但无法弄清楚

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-05T16:33:44.053

不幸的是，上面的答案对我没有帮助，而我继续努力并解决了它——我的不同里程的解决方案在这里：

[http://circlical.com/blog/2013/7/5/capturing-auth-events-with-zfcuser](http://circlical.com/blog/2013/7/5/capturing-auth-events-with-zfcuser)

希望它可以帮助另一个灵魂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T10:36:59.523

在模块中创建了一个身份验证事件，您可以将其挂钩（查看 AdapterChainServiceFactory 中的示例）

```
$chain = new AdapterChain;
$adapter = $serviceLocator->get('ZfcUser\Authentication\Adapter\Db');
$chain->getEventManager()->attach('authenticate', array($adapter, 'authenticate')); 
```

您可以挂钩该事件，然后在身份验证成功时进行一些日志记录，如下所示：

```
// Attach onto the event somewhere...
$chain->getEventManager()->attach('authenticate', array($myObject, 'logAuthenticate'));

// MyObject
public function logAuthenticate(AuthEvent $e)
{
    // logging magic here..
} 
```

# .net - 如何在 .NET 中使用 XML？

> ID：13503501
> 
> 赞同：0
> 
> 时间：2012-11-21T23:05:09.873
> 
> 标签：.net, xml

我可能在这里弄错了我的术语，因为我从未使用过 API、XML 或 Web 服务。我正在创建一个 MVC 应用程序，其中一小部分需要向远程服务器发送信息的功能，该服务器发送 XML 响应。响应类似于：

```
<VISResponse>
<ResponseType>resultsList</ResponseType>
<Matches>1</Matches>
<SessionID>9efa7c0cc9860f108190cc8e933095cf</SessionID>
<RecStart>1</RecStart>
<ClientCode/>
<Results/>
</VISResponse> 
```

我需要对该响应进行处理，例如以用户可读的形式在视图中显示它，并且我需要存储 sessionId 以供以后使用。我一直在研究并发现了一些关于 xml 类的迹象，但还没有找到一个好的教程。有人可以指导我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T02:21:51.380

LINQ to XML 有最好的 API。`XDocument.Load`从or开始`XElement.Parse`，您将找出需要调用的其他方法。

您可能会发现[这](http://www.i-think22.net/archives/2009/02/25/xml-made-easy-with-linq-to-xml/)是一个很好的起点，或者此[CodeProject 文章](http://www.codeproject.com/Articles/24376/LINQ-to-XML)。

# c++ - std::function 的大小 类型

> ID：13503511
> 
> 赞同：25
> 
> 时间：2012-11-21T23:06:44.600
> 
> 标签：c++, gcc, stl, c++11

`std::function<void(int&)>`来自 C++11 的它有什么魔力`sizeof = 32`？如果我将函数引用存储为指针，它只会花费`8 bytes`（在 64 位机器上）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-21T23:15:54.410

因为`std::function<Signature>`这是一个有趣的对象大小和分配之间的权衡：对于小型函数对象，最好避免分配。另一方面，这样做会增加对象的大小。为了使小函数优化有用并且在实际调用对象时不引入开销，对象大小需要至少是两个指针加上一些内存来存储简单的函数对象。似乎 32 字节的大小正是这个（在`sizeof(T*)`8 的系统上）。

也就是说，`std::function<Signature>`对象内部存储了继承层次结构：基类提供要调用的接口，委托给实现调用接口的模板化派生（可能还有一些`clone()`功能）。在针对大小优化的实现中，函数对象只会保留一个指向基址的指针，但为了避免分配，它会留出一些内部存储空间来分配整个对象并指向该对象（内部指针在实际调用时避免了一个条件函数对象）。对象所需的内存是一个虚函数指针加上`std::function<Signature>`初始化对象的实际函数对象的任何数据。为了使成员函数与它们的对象相适应，似乎再多两个词就相当小了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-21T23:19:42.373

`std::function`确实很神奇，因为它可以从*任何*可调用对象构造！它会很乐意为你存储任何数量的状态，即使在表面上你只保留了一个微不足道的`void(int&)`签名。

这种魔法肯定是有代价的，它通常在内部使用某种类型的擦除（即动态分配和虚拟调度）。细节各不相同，但生成的对象肯定是“沉重的”——这就是为什么应该避免使用它们，`auto`而在可行的情况下使用模板！

# arrays - AS3：如何将对象作为参数传递给 array.indexof

> ID：13503515
> 
> 赞同：0
> 
> 时间：2012-11-21T23:06:57.540
> 
> 标签：arrays, actionscript-3, object, point, indexof

考虑一个由 Sprite 类型的对象 m 组成的数组 p。我们如何将要检查的对象是否在数组中传递给 p.indexof( m? ) ？这段代码：

```
p=stage.getObjectsUnderPoint(new Point(ball.x, ball.y)); 
if (op.indexof(myClass.m) >= 0) { speedX *= -1; speedY *= -1; }
 p.splice(0); //empty p 
```

# java - Android上的犀牛

> ID：13503518
> 
> 赞同：3
> 
> 时间：2012-11-21T23:07:07.747
> 
> 标签：java, javascript, android, rhino

我有一个 JavaScript 文件，其中包含一些变量和一些我需要在我的 Android 应用程序中使用的数据。我是 JavaScript 新手，我知道 Rhino 引擎提供了在我的代码中使用 JavaScript 的方法。问题是我无法理解如何。有人可以指点我一个好的教程或举一个如何使用它的小例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T05:13:03.060

转到此链接以获取 rhino-1.7R3 api 文档。

[http://www.jarvana.com/jarvana/view/org/mozilla/rhino/1.7R3/rhino-1.7R3-javadoc.jar!/index.html](http://www.jarvana.com/jarvana/view/org/mozilla/rhino/1.7R3/rhino-1.7R3-javadoc.jar!/index.html)

对于 Rhino 教程，请访问此链接

[http://divineprogrammer.blogspot.in/2009/11/javascript-rhino-on-android.html](http://divineprogrammer.blogspot.in/2009/11/javascript-rhino-on-android.html)

**编辑于 2016 年 7 月 1 日**

以上链接内容已被其管理员删除。

请点击此链接获取犀牛教程

[https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino/Embedding_tutorial](https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino/Embedding_tutorial)

# asp.net - StepNavigationTemplate 在 CreateUserWizard 中不起作用？

> ID：13503524
> 
> 赞同：0
> 
> 时间：2012-11-21T23:07:23.370
> 
> 标签：asp.net, templates, createuserwizard

我正在尝试设置 StepNavigationTemplate，但它不起作用

```
<asp:CreateUserWizard ID="CreateUserWizard1" runat="server">
    <StepNavigationTemplate>
        <asp:Button ID="StepPreviousButton" runat="server" CausesValidation="False" CommandName="MovePrevious" Text="Cancel" />
        <asp:Button ID="StepNextButton" runat="server" CommandName="MoveNext" Text="I Agree" />
    </StepNavigationTemplate>
    <WizardSteps>
        <asp:WizardStep runat="server" Title="Agree to Terms of Use">
        </asp:WizardStep>
    </WizardSteps>
</asp:CreateUserWizard> 
```

它在这里什么都不做，但是当我把它放在里面时`<asp:WizardStep>`它可以工作，但是它添加了导航按钮，而以前的按钮仍然存在，所以它根本没有用。这个应该怎么用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T10:18:57.060

你的意思是这样的：

```
<WizardSteps>
<asp:WizardStep runat="server" Title="Your title" ID="wzsStep" StepType="Step"></asp:WizardStep >
.....
</WizardSteps>
<StepNavigationTemplate>

                        <asp:Button ID="uxPreviousStepBtn" Text="Previous" runat="server" CausesValidation="False"
                            Width="80" OnClick="uxPreviousStepBtn_Click" OnPreRender="uxPreviosStepBtn_PreRender" />

                        <asp:Button ID="uxNextStepBtn" Text="Next" runat="server" CausesValidation="True"
                            Width="80" ValidationGroup="MainData" OnClick="uxNextStepBtn_Click" OnPreRender="uxNextStepBtn_PreRender" />

            </StepNavigationTemplate>

protected void uxPreviousStepBtn_Click(object sender, EventArgs e)
{
//Previous step will show
 myWizard.ActiveStepIndex =myWizard.ActiveStepIndex>0? myWizard.ActiveStepIndex-1:0;
}        
protected void uxNextStepBtn_PreRender(object sender, EventArgs e)
    {
    //Check please if next step exists 
          myWizard.ActiveStepIndex =myWizard.ActiveStepIndex+1;
    } 
```

# linux - Clang OpenGL 和 Max

> ID：13503528
> 
> 赞同：-1
> 
> 时间：2012-11-21T23:07:39.733
> 
> 标签：linux, opengl, osx-lion, clang, glut

我曾经使用 GLUT 编写 OpenGL 程序，特别是对于我能够在 Linux 和 Mac 上编译的窗口。最近我将 Mac OS 升级到 Mountain Lion 并安装了最新版本的 XCode。当然事情已经发生了巨大的变化，现在我需要用 Clang 编译（gcc 被 Clang++ 取代）。似乎（阅读另一个 stackoverflow 问题）不再可以使用 GLUT，显然它可以被 FreeGLUT 或 GLW 取代？

[带有 OpenGL 3.2 核心配置文件的 OS X 上的 GLUT](https://stackoverflow.com/questions/11259328/glut-on-os-x-with-opengl-3-2-core-profile)

我的问题是：如果我想使用 OpenGL 并且需要一种简单/快速的方式来创建窗口、openGL 上下文等，就像我们之前使用 GLUT 所做的那样，那么现在使用 Clang/XCode 执行此操作的最佳方式是什么4.5.2？我发现真的很奇怪，我在网上找不到有关使用 Clang 编译 OpenGL 程序的信息，以及有关替代 GLUT 的更多信息？理想情况下，我想继续在 Linux 下编译这段代码？是否仍然可以选择使用 GLX 并自己编写窗口方面的内容？我还能在 Mac 上这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:25:40.730

编译器的选择并不重要。GLUT（也是旧版本）仍应与 Clang 一起使用，因为 ABI 没有改变。Clang 也可以在 Linux 中使用（AFAIK 你甚至可以使用 Clang 编译内核）。

MacOS X 不使用 GLX，它使用 Cocoa NSOpenGLView 类实例（或一些绕过 Cocoa 的全屏 API）。

继续做你已经做过的事情，并用 Clang 变体替换对编译器的所有调用。

# assembly - 将 arm cm3 汇编代码从闪存重新定位到 ram

> ID：13503529
> 
> 赞同：3
> 
> 时间：2012-11-21T23:07:42.230
> 
> 标签：assembly, arm, cortex-m3

我有一个带有特殊类型闪存的 Cortex M3 部件。零件在这个 FLASH 上启动，但我需要运行一个函数来优化 FLASH 的速度。做到这一点的唯一方法是跳转到 RAM 并在那里执行这些功能（因为如果在它正在优化的 FLASH 上运行该功能将会崩溃）。

ARM 允许分散加载。这是一个解决方案，因为我可以将函数放入 RAM 并在我进入 main 时运行它们。但我不想在未优化的 FLASH 的情况下执行所有分散加载。所以我想在 main 之前运行该函数，这意味着从重置处理程序或 SystemInit（从重置处理程序调用）。

我已经编写了一些位于 ROM 中的汇编函数。在启动时，我调用我编写的 Relocate 函数，然后将其他函数复制到 RAM，然后我跳转到它们。这是有效的。

我的问题是：

1.  这听起来很疯狂吗？有没有更简单的方法来完成这个（不等待分散加载）？
2.  在 .s 文件中，我有要重新定位的函数。为了使用这些重新定位的函数，我加载了 PROC 标签，然后减去（FLASH - RAM）的偏移量。这感觉不便携。是否有另一种方法来计算重定位函数的正确 PROC 地址？例如：

    ```
    foo     PROC
            ...
            ...
            ENDP 
    ```

foo 从 ROM 的 0x24000000 开始，我需要将它移动到 0x8000 的 RAM。有没有办法声明 foo 位于 0x8000，即使它必须存储在 ROM 中？或者有没有办法声明 foo_reloc 生活在 0x8000？这也适用于 THUMB 代码，因为 foo 可能从 0x24000001 开始，需要在 0x8001 处调用。

谢谢， 纳楚姆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T00:19:08.870

1.  不，这并不疯狂。
2.  不要担心重定位链接器应该为您处理所有这些。

将您的闪存配置函数放入分散文件中的单独执行区域。然后你唯一需要做的就是修改你的分散加载代码，首先为你的闪存配置函数设置执行区域，然后调用它，然后继续分散加载其他区域。

使用这样的分散文件：

```
LR 0x0
{
    ROM 0x0
    {
      * (+RO)
      * (+RW,+ZI)
    }

    RAM 0x18000 0x8000
    {
        foo.o (*)
    }
} 
```

然后，您应该得到一个以以下内容开头的图像：

```
$a
!!!main
__main
    0x00000000:    eb000000    ....    BL       __scatterload ; 0x8
    0x00000004:    eb000028    (...    BL       __rt_entry ; 0xac 
```

您可以使用“魔术”链接器符号（例如“Image$$RAM$$Base”）编写自己的 scatterloader，以手动执行 RO、RW 和 ZI 的加载（只需在链接器命令行上设置您自己的“入口”符号绕过默认的分散加载程序），然后调用 __rt_entry。

由于 Keil 工具实际上是 ARM 工具，您可以在此处查看更多信息。

[http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.kui0101a/armlink_chdcgbjd.htm](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.kui0101a/armlink_chdcgbjd.htm)

# eclipse - MinGW 还是 Cygwin GCC？

> ID：13503533
> 
> 赞同：7
> 
> 时间：2012-11-21T23:08:21.943
> 
> 标签：eclipse, gcc, cygwin, mingw

我想在 Windows 中为 Eclipse IDE 安装 GCC 编译器。我知道有两种选择：MinGW GCC 或 Cygwin GCC。哪个更适合 Eclipse CDT？任何经验或建议将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T23:12:51.637

使用 Cygwin 意味着您的程序将依赖于`cygwin1.dll`，它本质上是一个允许 POSIX 功能在 Windows 环境中使用的层。使用标准 MinGW GCC 编译不提供这种依赖性。但是，这意味着，如果您打算使用 MinGW GCC 进行编译，您将无法访问 POSIX 函数，例如`fork()`和`exec()`。

有关 Cygwin 和 MinGW 之间差异的更多信息，请参见[此处](https://stackoverflow.com/a/771774/1431696)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T23:59:15.563

我的临时想法是，如果你需要 cygwin，你就需要它。例如编译为 Unix 开发并在构建系统中具有符号链接和 shell 脚本的程序。

如果你不需要它，你就不要它。并且在虚拟机上在 linux 下编译通常是比走 cygwin 路线更好的选择。

所以mingw完全没问题。工作正常，使用简单。

另外：您可能会考虑使用 codelite (www.codelite.org) 而不是 Eclipse。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T23:12:48.187

我个人更喜欢 Cygwin，它有很多安装选项，感觉很像你在 Linux 机器上找到的终端。它提供了一组相当丰富的类似 Linux 的功能，而 Windows 却惨遭失败。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T23:19:31.760

Cygwin and Mingw are not interchangeable alternatives. Cygwin is used to compile POSIX API programs, Mingw is used compile Windows API programs.

Chose one or the other depending on what kind program you're going to write.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-10-05T15:33:50.587

**维基百科说：**

`MinGW`从 1.3.3 版分叉而来`Cygwin`。尽管两者`Cygwin`和`MinGW`都可以用于将`UNIX`软件移植到`Windows`，但它们有不同的方法：`Cygwin`旨在提供一个完整`POSIX layer`的，提供对存在于`Linux`、`UNIX`和`BSD`变体上的多个系统调用和库的模拟。`POSIX layer`运行在 之上，`Windows`在必要时牺牲性能以实现兼容性。因此，这种方法要求`Windows`用 编写的程序`Cygwin`在必须与程序一起分发的 copyleft 兼容库之上运行，以及程序的`source code`. `MinGW`旨在通过直接提供本机功能和性能`Windows API calls`。不同于`Cygwin`,`MinGW`不需要兼容层`DLL`，因此程序不需要与`source code`.

因为`MinGW`是依赖`Windows API calls`，它不能提供一个完整的`POSIX API`；它无法编译一些`UNIX applications`可以用`Cygwin`. 具体来说，这适用于需要`POSIX`类似 的功能的应用程序`fork()`，`mmap()`或者`ioctl()`那些期望在`POSIX environment`. 使用`cross-platform library`本身已被移植到的应用程序`MinGW`，例如`SDL`, `wxWidgets`,`Qt`或`GTK+`, 通常会像`MinGW`在`Cygwin`.

`MinGW`两者的结合`MSYS`提供了一个小型、独立的环境，可以将其加载到可移动媒体上，而无需在注册表或计算机上的文件中留下条目。`Cygwin`Portable 提供了类似的功能。通过提供更多功能，`Cygwin`安装和维护变得更加复杂。

也可以`cross-compile Windows applications`与`MinGW-GCC under POSIX systems`. 这意味着开发人员无需安装 Windows`MSYS`即可编译`Windows`无需`Cygwin`.

# c++ - 处理堆栈上的对象销毁

> ID：13503537
> 
> 赞同：1
> 
> 时间：2012-11-21T23:08:32.777
> 
> 标签：c++, stack, allocation, bnf, destruction

我目前正在为有关该主题的个人教育编写编译器前端，并且遇到了一个关于我通过运算符重载在 C++ 中处理 BNF 定义的方式的问题。

目前我的设置如下：

规则.h：

```
class Rule
{
public:
    ChainRule operator>>(Rule& right);
    OrRule operator|(Rule& right);
    KleeneRule operator*();
    OptionalRule Rule::operator+();

    virtual bool parse(TokenList::iterator& begin, TokenList::iterator end) = 0;
}; 
```

规则.cpp：

```
ChainRule Rule::operator>>(Rule& right) {
    return ChainRule(this, &right);
}

OrRule Rule::operator|(Rule& right) {
    return OrRule(this, &right);
}

KleeneRule Rule::operator*() {
    return KleeneRule(this);
}

OptionalRule Rule::operator+() {
    return OptionalRule(this);
} 
```

ChainRule、OrRule、KleeneRule、OptionalRule 和 EmptyRule 的定义很简单，如下所示：

```
class ChainRule : public Rule
{
private:
    Rule* next;
    Rule* _this;

public:
    ChainRule();
    ChainRule(Rule* _this, Rule* right);

    bool parse(TokenList::iterator& begin, TokenList::iterator end) override;
}; 
```

Rule 的每个子类显然都定义了 parse() 的合理实现。使用这些类，我可以如下定义我的语法：

```
OrRule assignment_exp   = logical_or_exp
                        | unary_exp >> StringRule("=") >> assignment_exp
                        ; 
```

现在问题来了：每个重载的运算符按值返回一个新对象。这意味着每当我使用 operator>> 或 operator| 从 Rule 类中，一旦我从对 operator>> 或 operator| 的调用返回，这些指针将是垃圾。因为堆栈已被清理并且对象已经消失。

我也不能在我的 Rule 子类的构造函数中使用按值传递，因为这不允许我定义递归语法。

所以我没有按值传递对象的选项，也没有按指针传递对象的选项。谁能指出一个不会强迫我像这样定义我的语法的解决方案？

```
StringRule s = StringRule("=");
OrRule assignment_exp;
ChainRule temp1 = s >> assignment_exp;
ChainRule temp2 = unary_exp >> temp1;
assignment_exp = logical_or_exp | temp2; 
```

PS 我知道各种解析器生成器和 Boost.Spirit，但我的目标是编写自己的解析器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:13:58.067

您可以在堆上分配返回对象（通过工厂）并将它们作为引用返回。工厂可以跟踪它们，因此您不会泄漏。就语法而言，它与按值返回它们时的工作方式相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:26:41.583

您可以通过用包装器对象替换您的`Rule*`（存在无法为它们重载运算符的问题）来解决此问题。即将`ChainRule`包含`RuleRef next`而不是`Rule * next`等，并且所有运算符都将定义为`RuleRef`。`RuleRef`将仅包含 a `Rule*`，并且可以从 a 构造`Rule*`。为了使内存处理更容易，您可以从智能指针类继承。

# jquery - Chrome说“无法读取未定义的属性”......即使它确实如此

> ID：13503540
> 
> 赞同：0
> 
> 时间：2012-11-21T23:08:47.897
> 
> 标签：jquery, arrays, google-chrome, object, undefined

不知道发生了什么。

从 $.ajax 成功消息中获取对象，将它们存储在新数组中以传递给插件，插件使用数据但报告不能使用我上面标题中的属性“ID”。

在 for 循环结束时停止并指向控制台中 for 循环的第一行。它使用数据和所有内容进行克隆。for 之后什么都没有。

**$.ajax() 中的片段**

```
var suppliers = [];
for(var i=0; i<5; i++){
    suppliers[i] = msg.d[i];
}
$.fn.appendSnapshots(suppliers); 
```

**失败的地方**

```
$.fn.appendSnapshots = function(snapshots) {
var accumulatedHeight = $("#suppliersTable").height();
var IDsShowing = new Array();

for (var i=0; i<snapshots.length; i++){

    if($("#supplierStatusDataRow\\." + snapshots[i].ID).length == 0){

        var $supplierStatusDataRow = $("#supplierStatusDataRow").clone(false)
        $supplierStatusDataRow.css('z-index', 1);
        $supplierStatusDataRow.find("*[id]").andSelf().each(function() { $(this).attr("id", $(this).attr("id") + "." + snapshots[i].ID); });

        $("#supplierStatusDataDiv").append($supplierStatusDataRow);

        $("#statusSupplierName\\." + snapshots[i].ID).append(snapshots[i].SupplierName);
        $("#statusSupplierNumber\\." + snapshots[i].ID).append(snapshots[i].SupplierNumber);
        $("#statusHostNumber\\." + snapshots[i].ID).append(snapshots[i].HostNumber);
        $("#statusSupplierType\\." + snapshots[i].ID).append(snapshots[i].SupplierType);
        $("#statusRecievedReportStatus\\." + snapshots[i].ID).append(snapshots[i].RecievedReportStatus);
        $("#statusBarCode\\." + snapshots[i].ID).append(snapshots[i].BarCode);
        $("#statusNumberOfUsers\\." + snapshots[i].ID).append(snapshots[i].NumberOfUsers);
        $("#statusOnBoardStatus\\." + snapshots[i].ID).append(snapshots[i].OnBoardStatus);
        $("#statusSupplierEmail\\." + snapshots[i].ID).append(snapshots[i].SupplierEmail);
        $("#statusPrimaryBuyer\\." + snapshots[i].ID).append(snapshots[i].PrimaryBuyer);
        $("#statusLastPODate\\." + snapshots[i].ID).append(snapshots[i].LastPODate);
        $("#statusPOMTD\\." + snapshots[i].ID).append(snapshots[i].POMTD);
        $("#statusPOYTD\\." + snapshots[i].ID).append(snapshots[i].POYTD);

        $supplierStatusDataRow.css('top', accumulatedHeight);

        $supplierStatusDataRow.animate({opacity: 1}, 500);

        }
        else{
            $("#supplierStatusDataRow\\." + snapshots[i].ID).animate({top: accumulatedHeight}, 500);
        }

        IDsShowing.push(parseInt(snapshots[i].ID));
        accumulatedHeight += $("#supplierStatusDataRow\\." + snapshots[i].ID).height() - 1;

    }

        $("#supplierStatusDataDiv").find('[id^="supplierStatusDataRow\\."]').each(function(i){ 
        var splitID = $(this).attr("id").split(".");
        if($.inArray(parseInt(splitID[1]), IDsShowing) == -1){
                $("#supplierStatusDataDiv").find('[id^="supplierStatusDataRow\\.' + splitID[1] + '"]').animate(
                    {opacity: 0}, 
                    500, 
                    function() { $("#supplierStatusDataRow\\." + splitID[1]).remove();
                });
            }
        });

        totalHeight = $("#supplierStatusRadioDiv").height() + $("#supplierStatusNameDiv").height() + $("#supplierStatusSlider").height() + accumulatedHeight;
        $("#suppliersSnapshot").animate({height: totalHeight}, 500);
        $("#supplierStatusDataDiv").animate({height: accumulatedHeight}, 500);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:12:49.657

听起来您正在查看`for`循环中数组的末尾。尝试：

```
for(var i=0; i< msg.d.length; i++){
    suppliers[i] = msg.d[i];
} 
```

# ios - HEADER 请求 allHeaderFields 不起作用

> ID：13503551
> 
> 赞同：3
> 
> 时间：2012-11-21T23:09:58.297
> 
> 标签：ios, asynchronous, header, request, synchronous

我的代码的目的是比较服务器文件和本地文件的修改日期，如果服务器文件较新，它将下载它。

[我的第一次尝试是使用来自http://iphoneincubator.com/blog/server-communication/how-to-download-a-file-only-if-it-has-been-updated](http://iphoneincubator.com/blog/server-communication/how-to-download-a-file-only-if-it-has-been-updated)的代码使用同步请求

但它没有奏效。之后我一直在努力寻找解决方案，尝试了异步请求，尝试了我在 stackoverflow、google 等周围找到的不同代码，但没有任何效果。

如果在终端中，我会`curl -I <url-to-file>`得到标题值，所以我知道这不是服务器问题。

这是我现在正在努力的代码（它写在 Appdelegate.m 中）

```
- (void)downloadFileIfUpdated {
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL: url
                                                       cachePolicy: NSURLRequestReloadIgnoringLocalCacheData
                                                   timeoutInterval: 10];
[request setHTTPMethod:@"HEAD"];

NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:YES];
  if(!connection) {
    NSLog(@"connection failed");
  } else {
    NSLog(@"connection succeeded");
  }
}

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [self downloadFileIfUpdated]
}

#pragma mark NSURLConnection delegate methods
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
NSString *lastModifiedString = nil;
NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse*)response;
  if ([response respondsToSelector:@selector(allHeaderFields)]) {
    lastModifiedString = [[response allHeaderFields] objectForKey:@"Last-Modified"];
  }
  [Here is where the formatting-date-code and downloading would take place]
} 
```

现在，它给了我错误`No visible @interface for 'NSURLResponse' declares de selector 'allHeaderFields'`。

当我使用同步方法时，错误是`NSLog(@"%@",lastModifiedString)`返回（null）。

PS：如果有更好的方法可以解释自己或代码，请告诉我。

**更新**

我使用的 URL 是类型的`ftp://`，这可能是我没有得到任何 HEADERS 的问题。但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:32:18.037

将您的代码更改为此...在“如果”条件下，您正在检查`response`而不是`httpResponse`：

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
NSString *lastModifiedString = nil;
NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse*)response;
  if ([httpResponse respondsToSelector:@selector(allHeaderFields)]) {
    lastModifiedString = [[httpResponse allHeaderFields] objectForKey:@"Last-Modified"];
  }
  // [Here is where the formatting-date-code and downloading would take place]
} 
```

...一旦您对响应始终是 NSHTTPURLResponse 感到满意，您可能就可以摆脱条件语句：

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
  NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse*)response;
  NSString *lastModifiedString = [[httpResponse allHeaderFields] objectForKey:@"Last-Modified"];
  // [Here is where the formatting-date-code and downloading would take place]
} 
```

# types - "Force" User Input and Checking for correct Input Type

> ID：13503553
> 
> 赞同：1
> 
> 时间：2012-11-21T23:10:06.700
> 
> 标签：types, input, python-3.x, eval

I have some functions calling for user input, sometimes string, int or whatever. so i noticed that if ENTER is pressed with NO INPUT i get an error. SO i did some research and i think i found that EVAL function may be what I'm looking for, but then again i read about its dangers.

SO here are my questions:

1.  How can i check/force user input? EX: repeating the input string or maybe even warning user that he didn't enter anything?

2.  how do i check for the correct type of input (int, float, string, etc) against whatever the user types without having my scripts returning errors?

I appreciate your feedback,

Cheers

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T06:48:14.743

For question 1: enter pressed when prompted for input results in an empty string returned (are you using input() in your scripts?). Apparently empty string is not a valid input for your functions. For all I know, whatever you enter as the input, you end up with a string returned by input(). To check if a string is empty and repeat the prompt, you may try:

```
while True:
    answer = input('Enter something: ')
    if answer: break 
```

And for question 2: for checking the type of argument provided, generally the Pythonic way is to handle it with try/except and not check explicitly for each valid/non-valid type. Also, in this scenario you have to do explicit manual conversion from string, so you only check the contents of the string, not deal with other types (at least not yet). Because of than, you might be interested in string methods or re (regular expressions) module for checking if some particular substring is present (or not).

[re module for python3.3](http://docs.python.org/3.3/library/re.html) and [string methods for python3.3](http://docs.python.org/3.3/library/stdtypes.html#string-methods) For other versions of python, just select an appropriate value in the menu in the top of the page.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-19T16:34:18.557

A reject all input unless of the correct type:

```
input_ = input('Enter some input: ')
try:
    input_ = int(input_) # or float(input_); str format is used with input() function by default
except ValueError: # can't convert
    pass # or some other friendly error message 
```

To prevent empty inputs:

```
while True:
    input_ = input('Enter something: ')
    if input_: # if this value is not empty, for example None or ''
        break
pass # continue the program 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T00:39:49.190

To answer your second part of the question you can use the `isinstance()` function in python to check if a variable is of a certain type.

# java - 搜索并获取某个时间范围内的推文

> ID：13503555
> 
> 赞同：2
> 
> 时间：2012-11-21T23:10:15.297
> 
> 标签：java, twitter, twitter4j

我正在尝试编写一个 java 代码来获取特定时间范围内的推文。我在twitter4j api中使用Since和Until函数。但是，它仅在最后几分钟内返回有限数量的推文。

有没有办法让它工作？有没有人有同样的经历？

# android - 片段中的Android动画不起作用

> ID：13503557
> 
> 赞同：2
> 
> 时间：2012-11-21T23:10:24.367
> 
> 标签：android, animation, fragment

我有三个重叠的滚动视图。出于某种原因，当我将其他两个设置为 View.Gone 并将一个滚动视图设置为 View.Visible，然后启动动画时，它不会被触发。这些滚动视图在一个片段中——我知道一些功能在片段中不能完全工作。动画看起来很基础。

这是我的按钮监听器的方法；

```
 sv2.setVisibility(View.GONE);
        sv3.setVisibility(View.GONE);
        sv1.setVisibility(View.VISIBLE);
        Animation fadeInAnimation = AnimationUtils.loadAnimation(getActivity(), R.anim.fade_in_scollview);
        //set your animation
        sv1.startAnimation(fadeInAnimation); 
```

还尝试设置不可见，加载动画，然后使其可见；

```
 sv1.setVisibility(View.INVISIBLE);
        Animation fadeInAnimation = AnimationUtils.loadAnimation(getActivity(), R.anim.fade_in_scollview);  
        //set your animation
        sv1.startAnimation(fadeInAnimation);
        sv1.setVisibility(View.VISIBLE); 
```

这是我的动画xml；

```
<?xml version="1.0" encoding="UTF-8"?>
  <set xmlns:android="http://schemas.android.com/apk/res/android">
    <alpha android:fromAlpha="0.0" android:toAlpha="1.0" 
     android:interpolator="@android:anim/accelerate_interpolator" 
   android:duration="500"
    android:repeatCount="infinite"/>
 </set> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-30T04:22:14.847

要在片段中使用动画，请尝试以下代码

这是我的布局文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <ImageView
        android:id="@+id/iv_banner"
        android:layout_width="fill_parent"
        android:layout_height="250dp"
        android:layout_gravity="center_horizontal" />
</LinearLayout> 
```

这是我的片段 java 类

```
 public class Fragment_Home extends Fragment {
    public int currentimageindex = 0;
    Handler mHandler = new Handler();
    Runnable mUpdateResults;

    //Array of drawable images
    private int[] IMAGE_IDS = {
            R.drawable.home_slider_stemer, R.drawable.home_slider_plane
    };

    //image view
    private ImageView iv_banner;
    private View rootView;

    public Fragment_Home() {
        // Required empty public constructor
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        rootView = inflater.inflate(R.layout.fragment_home, container, false);

        LoadUIElements();

        return rootView;
    }

    private void LoadUIElements() {
        iv_banner = (ImageView) rootView.findViewById(R.id.iv_banner);
        int delay = 1000; // delay for 1 sec.

        int period = 2000; // repeat every 4 sec.
        Timer timer = new Timer();

        timer.scheduleAtFixedRate(new TimerTask() {

            @Override
            public void run() {
                // TODO Auto-generated method stub
                mHandler.post(mUpdateResults);
            }
        }, delay, period);

        mUpdateResults = new Runnable() {
            @Override
            public void run() {
                // TODO Auto-generated method stub
                try {
                    AnimateandSlideShow();
                } catch (Exception e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

            }
        };
    }

    /**
     * Helper method to start the animation on the splash screen
     */
    protected void AnimateandSlideShow() {
        // TODO Auto-generated method stub
        try {
            iv_banner.setImageResource(IMAGE_IDS[currentimageindex
                    % IMAGE_IDS.length]);

            currentimageindex++;
            Animation rotateimage = AnimationUtils.loadAnimation(getActivity()
                    .getBaseContext().getApplicationContext(), R.anim.fade_in);
            iv_banner.startAnimation(rotateimage);
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

不要忘记将图像放在 res 中的 Drawable 文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T07:22:23.140

我通过设置一个动画监听器并管理其中的所有可见性内容来解决这个问题。

```
 sv1.setVisibility(View.INVISIBLE);
    //grab animation from anim folder in res/
    Animation fadeInAnimation = AnimationUtils.loadAnimation(getActivity(), R.anim.push_up_anim);
    fadeInAnimation.setAnimationListener(new AnimationListener() {
          //set other scroll views to invisible once done
          public void onAnimationEnd(Animation animation) {
            sv2.setVisibility(View.INVISIBLE);
            sv3.setVisibility(View.INVISIBLE);
            }

            public void onAnimationRepeat(Animation animation) {
            }
            //once our animation starts, we set our view to visible
            public void onAnimationStart(Animation animation) {
                sv1.setVisibility(View.VISIBLE);
            }
        });
        scrollViewAnimationActive = true;
        //start our animations for views that need to be removed. 
        //We know one of these views were showing by checking if it was "visible".
        if (sv2.getVisibility() == View.VISIBLE)
              sv2.startAnimation(AnimationUtils.loadAnimation(getActivity(), R.anim.pushed_out_anim));
        else if (sv3.getVisibility() == View.VISIBLE) {
              sv3.startAnimation(AnimationUtils.loadAnimation(getActivity(), R.anim.pushed_out_anim));
        }else if (wikiParentLL.getChildCount() > 1) {
                wikiParentLL.startAnimation(AnimationUtils.loadAnimation(getActivity(), R.anim.pushed_out_anim));
            }
//finally, start our "animation"
    sv1.startAnimation(fadeInAnimation); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-17T17:35:31.150

我确实遇到了问题，我通过使用***onWindoFocusChangeListener***和***Handler***解决了它。

```
mview.getViewTreeObserver().addOnWindowFocusChangeListener(new ViewTreeObserver.OnWindowFocusChangeListener() {
        @Override
        public void onWindowFocusChanged(final boolean hasFocus) {
            new Handler().postDelayed(new Runnable() {
                @Override
                public void run() {
                    startSeedAnimation();
                }
            }, 600);

        }
    }); 
```

您可以在哪里获取 onViewCreated 中的视图对象或简单地调用视图？/ getView() 来自任何地方。

# path - 为什么DOS“路径”命令重复输入？

> ID：13503559
> 
> 赞同：0
> 
> 时间：2012-11-21T23:10:44.960
> 
> 标签：path, dos

(WinXP 家庭版 SP2)

## CLI 的路径命令输出

![](../Images/371901e1219deb795b7a929cc68a993a.png)

## 我的电脑 > 属性 > 高级 > 环境变量中的路径变量值

![](../Images/0373ab7642b37df2cbb7f9fc93b9cd1c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T01:59:47.943

PATH 环境变量可以防止重复条目，并没有什么神奇之处。

通常，各个路径通过某种类型的安装程序添加到 PATH，但也可以手动添加。确保不输入重复项是安装程序的工作。一些安装程序很懒惰，不会在插入之前检查给定路径是否已经存在。

PATH 的初始值是通过结合注册表中的系统和用户环境设置来构建的。

通常，当且仅当它不存在时，批处理过程才会尝试使用附加条目来增加路径。[如何检查 %PATH% 中是否存在目录？](https://stackoverflow.com/questions/141344/how-to-check-if-directory-exists-in-path)是一个流行的 SO 批处理文件问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:00:55.127

PATH 变量本身可能包含在 PATH 中

# android - editTexts 在旋转设备时更改其值

> ID：13503566
> 
> 赞同：2
> 
> 时间：2012-11-21T23:11:24.117
> 
> 标签：android, layout, android-activity, android-fragments, android-edittext

**上下文**

当您创建一个新的 android 项目时，我的应用程序架构与默认的“Swipe Views”非常相似。一项活动，3个片段，您可以在其中滑动。它使用支持库。一切都是最新的。我正在测试的设备是运行 android 4.1.2 支持库 r11 和 SDK 版本 min=14 target=16 的 Galaxy nexus

**问题**

第二个片段包含一堆 EditText，其中包含从 sharedPreferences 读取的各种数值。首次创建 Activity 时，一切都很好，EditViews 都有正确的值，但是如果我将其中一个值修改为，例如 555，然后旋转设备，所有 EditText 现在都显示 555 ！

整个程序中只有**一个**setText 并在本文后面显示，我试图将其删除，正如预期的那样，在启动活动时所有 EditTexts 显示默认值（666），我修改一个并旋转设备，他们全部显示新值！

**细节**

一个带有 SectionsPagerAdapter、ViewPager 和每个页面的片段的活动。

在方法中的一个片段（ConfigurationFragment）中，我使用 and和 an`onViewCreated`动态创建行。`EditText``ImageButton`

这些行实际上是在一个布局（xml文件）中，我为每一行添加，然后我得到editText并调用setText将它的值设置为它应该是什么。

**onViewCreated 方法：**

```
public void onViewCreated(View view, Bundle savedInstanceState)
{
    // populate ports list on view creation
    ArrayList<String> listenPorts = mServerManagerThread.getListenPorts();
    for (String port : listenPorts)
    {
        EditText v = ((EditText) addListenPortItem().getChildAt(0));
        v.setText(port);
    }

    super.onViewCreated(view, savedInstanceState);
} 
```

自然，该方法`getListenPorts`每次调用时都会返回相同的列表（在启动时和设备旋转时）

**addListenPortItem 基本上是做什么的：**

```
 // Instantiate a new "row" view.
    final ViewGroup newView = (ViewGroup) LayoutInflater.from(viewGroup.getContext()).inflate(itemResource,
            viewGroup, false);

    // Set a click listener for the "X" button in the row that will remove
    // the row.
    newView.findViewById(R.id.delete_button).setOnClickListener(
            new OnRemoveClickListener(mContainer, viewGroup, newView, emptyListTextResource));

    viewGroup.addView(newView); 
```

viewGroup 是一个线性布局，它将保存新创建的视图 itemResource 是以下布局

**一行布局：**

```
<?xml version="1.0" encoding="utf-8"?>
<!--
     <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
-->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="?android:listPreferredItemHeightSmall"
    android:layout_marginTop="8dp"
    android:divider="?android:dividerVertical"
    android:dividerPadding="8dp"
    android:gravity="right"
    android:orientation="horizontal"
    android:showDividers="middle" >

    <EditText
        android:id="@+id/editPort"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:ems="10"
        android:inputType="number"
        android:text="666" >
    </EditText>

    <ImageButton
        android:id="@+id/delete_button"
        style="?android:attr/borderlessButtonStyle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:contentDescription="@string/action_remove_item"
        android:src="@drawable/content_remove" />
</LinearLayout> 
```

**任何的想法？**

我已经盯着这个错误几个小时了，我真的不知道发生了什么......我开始怀疑 SDK 或支持库中的错误，但我从经验中知道这个错误是最经常在我的脑海里:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T00:05:53.547

我找到了解决方案：我将代码从 onViewCreated 移动到 onViewStateRestored(..) 以便在状态恢复后用它们的值填充 EditTexts。

问题是所有的 EditTexts 都具有相同的 id，因此在恢复状态时它搞砸了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:25:50.730

这不是错误，所以不要担心。问题是，如果您旋转屏幕，将重新创建 Activity 和 Fragments。`onCreateView()`将再次被调用，这使事情变得混乱，因此您的行为如此奇怪。您可以通过覆盖以下两种方法来解决此问题：

```
@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
    // Read values from the "savedInstanceState"-object and put them in your textview
}

@Override
protected void onSaveInstanceState(Bundle outState) {
    // Save the values you need from your textview into "outState"-object
    super.onSaveInstanceState(outState);
} 
```

# c# - C# if else 快捷方式

> ID：13503567
> 
> 赞同：6
> 
> 时间：2012-11-21T23:11:33.287
> 
> 标签：c#

在 C# 中，如何使用更短的方法（使用？）来表达以下 if else 语句：

```
 if (condition1 == true && count > 6)
           {
               dothismethod(value);

           }
           else if (condition2 == false)
           {

               dothismethod(value);
           } 
```

我的代码与这些语句看起来真的很乱。有人可以指导我找到有关 if then else 快捷语法的好资源吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-21T23:13:05.457

听起来你正在尝试写

```
if ((condition1 && count > 6) || !condition2)
    SomeMethod(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-21T23:15:57.473

`?`不是“捷径” if/else。它被称为**三元运算符**，当您想根据条件为某个变量赋值时使用它，如下所示：

`string message = hasError ? "There's an error!" : "Everything seems fine...";`

MSDN：http: [//msdn.microsoft.com/en-us/library/ty67wk28%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/ty67wk28%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-21T23:24:25.983

你可以这样写：

```
if ((condition1 == true && count > 6) || condition2 == false)
{
    dothismethod(value);
} 
```

但就个人而言，我会将您的第一个表达式定义为另一个变量，因此您的 if 语句变得更加清晰：

```
bool meaningfulConditionName = (condition1 == true) && count > 6;
if (meaningfulConditionName || !condition2)
{
    dothismethod(value);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T23:15:17.947

条件运算符`?`仅适用于赋值。但是你绝对可以将两个 if 合二为一，因为两者的结果是相同的：

```
if ((condition1 == true && count > 6) || condition2 == false)
           {
               dothismethod(value);
           } 
```

或者更简洁：

```
if ((condition1 && count > 6) || !condition2) dothismethod(value); 
```

# java - java：为什么不允许 this 逃脱构造函数？

> ID：13503569
> 
> 赞同：6
> 
> 时间：2012-11-21T23:11:48.703
> 
> 标签：java, concurrency

在 JCIP 的第 3.2.1 节“安全构造函数实践”中，有一个警告，防止`this`从构造函数泄漏到另一个线程，“即使发布是构造函数中的最后一条语句”。最后一部分对我来说似乎太强了，而且没有任何理由。施工后会发生什么我必须非常小心避免的事情？有例外吗？我很感兴趣，因为我最近提交了一些代码，我在其中做了这件事，我想决定是否有理由回顾和重构。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T00:39:24.823

就Java内存模型而言，构造函数出口在最终字段语义中发挥作用，因此语句在构造函数出口之前还是之后存在差异。

```
This works                         This doesn't work
-------------------------------------------------------------

static Foo shared;                 static Foo shared;

class Foo                          class Foo
{                                  {   
    final int i;                       final int i; 
    Foo()                              Foo() 
    {                                  {
        i = 1;                             i = 1;
                                           shared = this;  
    }                                  }
}                                  }

shared = new Foo();                new Foo(); 
```

（注意：`shared`不是易失性的；该出版物是通过数据竞赛发布的。）

两个示例之间的唯一区别是`shared`在构造函数退出之前或之后分配。在第二个示例中，`i=1`允许在分配后重新排序。

但是，如果发布是同步操作，例如通过 volatile 变量，则可以；其他线程将观察一个完全初始化的对象；字段甚至不必`final`。

通过数据竞赛发布（或通过数据竞赛做任何事情）是一项非常棘手的业务，需要非常仔细的推理。如果避免数据竞争，事情就会简单得多。**如果您的代码不包含数据竞争，那么在构造函数退出之前立即泄漏和在构造函数退出后立即发布它****没有区别。`this`**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T23:22:35.813

你永远不应该`this`在任何时候从构造函数中泄漏，“甚至在最后一个语句中 [...]。” 由于`this`没有完全构建，可能会发生一些非常奇怪的事情。在一个非常相似的问题上看到[这个 SO 答案。](https://stackoverflow.com/a/9851843/278836)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-21T23:38:34.673

你永远不应该`this`离开构造函数（称为“泄漏`this`”）

即使是构造函数的最后一行，也不应该这样做的一个原因是，只要不影响对当前线程的影响，JVM 就可以重新排序语句。如果`this`传递给在另一个线程中运行的进程，重新排序可能会导致奇怪和微妙的错误。

另一个原因是子类可能会提供自己的初始化，因此在类的构造函数的最后一行可能没有完成构造。

# wordpress - 手动摘录自定义

> ID：13503572
> 
> 赞同：0
> 
> 时间：2012-11-21T23:12:05.267
> 
> 标签：wordpress

我目前正在使用最新的 WordPress 安装并使用[Todd Motto](https://github.com/toddmotto/HTML5-Blank-WordPress-Theme)的 HTML5 Blank WordPress 主题。我目前遇到 EXCEPT 功能的问题。我希望能够手动输入摘录并在句子后面有阅读更多链接。不知道该怎么做。空白主题默认很好，但我因为某些内容......我需要能够手动编写摘录。有谁知道我会怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:09:47.490

单击屏幕右上角的“屏幕选项”选项卡 -

应该有一个复选框来处理大约十几个不同的事情——自定义字段、讨论和......**摘录**。只需选中该框，摘录框将在帖子编辑器下弹出，允许您输入手动摘录

# authentication - j_security check 总是将我重定向到身份验证失败错误页面

> ID：13503574
> 
> 赞同：1
> 
> 时间：2012-11-21T23:12:09.733
> 
> 标签：authentication, tomcat, j-security-check

这是我第一次尝试在 Java Web 应用程序中使用 j_security 检查表单身份验证。我正在使用 Eclipse 3.6 和 Apache Tomcat 6.0.28。

问题描述：当我使用有效凭据提交登录表单时，j_security check 会将我重定向到 error.html 中定义的错误页面。当我使用无效凭据提交时，它也会将我带到 error.html 页面。这很好，但对于有效用户，我希望在登录后被带到受保护的资源。

**登录.html**

```
 <!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Login</title>
</head>
<body>
<form method=post action="j_security_check">
 Username   <input type="text" name="j_username"><br />
 Password   <input type="password" name= "j_password"><br />
    <input type="submit" value="submit">
</form>
</body>
</html> 
```

**web.xml**

```
 <?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xmlns="http://java.sun.com/xml/ns/javaee"
  xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
  xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
      http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
  version="2.5">

  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.jsf</url-pattern>
  </servlet-mapping>
  <context-param>
    <param-name>javax.faces.PROJECT_STAGE</param-name>
    <param-value>Development</param-value>
  </context-param>
  <welcome-file-list>
    <welcome-file>/ui/index.xhtml</welcome-file>
    <welcome-file>index.html</welcome-file>
  </welcome-file-list>

  <login-config>
    <auth-method>FORM</auth-method>
<form-login-config>
<form-login-page>/security/login.html</form-login-page>
<form-error-page>/security/error.html</form-error-page>
</form-login-config>
</login-config>

<security-constraint> 
    <display-name>URLsConstraintMechanism</display-name>
    <web-resource-collection>
        <web-resource-name>clientURL</web-resource-name>
        <url-pattern>/ui/*</url-pattern>
        <http-method>GET</http-method>
        <http-method>PUT</http-method>
        <http-method>POST</http-method>
        <http-method>DELETE</http-method>
    </web-resource-collection>
    <auth-constraint>
        <role-name>tomcat</role-name>
    </auth-constraint>
</security-constraint>

<security-role>
  <description>The Only Secure Role</description>
  <role-name>tomcat</role-name>
</security-role>

</web-app> 
```

**tomcat-users.xml**

```
 <role rolename="tomcat"/>
  <role rolename="role1"/>
  <user username="tomcat" password="tomcat" roles="tomcat"/>
  <user username="both" password="tomcat" roles="tomcat,role1"/>
  <user username="role1" password="tomcat" roles="role1"/> 
```

我在 IDE 的控制台或 $CATALINA_HOME/logs 文件夹中也没有看到任何错误

请原谅任何遗漏，因为我是这个论坛的新手。我已经搜索了现有的线程，但到目前为止没有任何建议对我有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T10:34:16.790

要检查的一件事是*tomcat-users.xml*文件，如果您从 eclipse 运行 tomcat，则 eclipse 会创建一对单独的*server.xml*和*tomcat-users.xml*，这与 tomcat 安装目录中的默认设置不同。尝试通过检查Server*配置路径找到正确的配置参数*在Servers选项卡下双击你的tomcat服务器

还要检查*server.xml*中的领域，如果您使用 tomcat-users.xml 文件存储用户和密码，请使用内存领域

```
<Realm className="org.apache.catalina.realm.MemoryRealm" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-20T12:01:47.157

我知道这个问题已经存在一年多了，但是您是否尝试在更改 tomcat-users.xml 文件后重新启动 Tomcat？我遇到了类似的问题，重新启动 Tomcat 后，它运行良好。

Tomcat 不会自动重新读取文件 tomcat-users.xml，需要重新启动 Tomcat 才能重新读取。

# objective-c - NSTableView 内的 resizableImageWithCapInsets（基于视图）

> ID：13503578
> 
> 赞同：0
> 
> 时间：2012-11-21T23:12:33.930
> 
> 标签：objective-c, cocoa, nstableview, nstablecellview

我尝试为 mac 做 resizableImageWithCapInsets （如在 iOS 中）。

```
 // right bubble
    NSLog(@"==================== OLD VALUES ==============");
    NSLog(@"size->%@",NSStringFromSize(size));
    NSLog(@"cellView.frame->%@",NSStringFromRect(cellView.frame));

    NSLog(@"message.frame->%@",NSStringFromRect(cellView.message.frame));
    NSLog(@"background.frame->%@",NSStringFromRect(cellView.background.frame));

    cellView.background.frame =  CGRectMake(cellView.frame.size.width - size.width,
                                            - size.height + cellView.date.frame.size.height * 1.8, size.width, size.height);

    necessaryBackgroundImage = [[NSImage imageNamed:@"OutgoingMessageBuble.png"] stretchableImageWithLeftCapWidth:20 topCapHeight:15];

    cellView.message.frame = CGRectMake(cellView.frame.size.width - size.width,
                                        - size.height + cellView.date.frame.size.height * 1.8, size.width, size.height);

    NSLog(@"==================== NEW VALUES ==============");
    NSLog(@"message.frame->%@",NSStringFromRect(cellView.message.frame));
    NSLog(@"background.frame->%@",NSStringFromRect(cellView.background.frame));
    NSLog(@"necessaryBackgroundImage.size->%@",NSStringFromSize(necessaryBackgroundImage.size));
   cellView.background.image = necessaryBackgroundImage; 
```

我确实从这里尝试 NSImage 子类： [https ://github.com/beefon/Mac---Stretchable-NSImage/blob/master/README](https://github.com/beefon/Mac---Stretchable-NSImage/blob/master/README)

但这不是成功：

![在此处输入图像描述](../Images/5078162fd4de9914f681083ad0789951.png)

一个类总是返回错误大小的图像：

```
> 2012-11-22 01:02:30.009[37363:303] necessaryBackgroundImage.size->{43,
> 32} 2012-11-22 01:02:30.004[37363:303]
> necessaryBackgroundImage.size->{43, 32} 
```

我希望图像大小为必要的框架：

```
> 2012-11-22 01:02:30.003[37363:303] background.frame->{{50.6875,
> -115.19999999999999}, {265.3125, 162}} 
```

请你能解释一下，我错在哪里？代码片段赞赏，我明白，我必须使用 NSDrawNinePartImage，但更好的是避免很长的路要走。我还发现，子类 NSImage 的 drawInRect 没有在任何地方调用，我不知道如何推送它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T10:10:20.517

Stretchable-NSImage did't change the image, but rewrite the `drawRect`

# r - 将计数数据帧转换为R中的比例

> ID：13503580
> 
> 赞同：4
> 
> 时间：2012-11-21T23:12:40.430
> 
> 标签：r

随着时间的推移，我有一个按地区计数的数据框。数据框的一行包含每列的计数总数。我想通过将每个列单元格除以相应列的总数来将数据框从计数转换为比例。某些列包含缺失的观察值。我在下面使用嵌套完成了此操作，`for-loops`但怀疑可能有更简单的方法，也许使用`lapply`. 我在提取计数总数行时也遇到了麻烦。

我发布这个部分是因为我是时候学习使用 apply 系列函数了，我怀疑它们在这里可能有用，部分是因为我在创建计数总数的向量时遇到了很多麻烦，并且怀疑使用`[[`会有所帮助。感谢您提供有关更有效地编写上述代码的任何建议。

```
my.data = read.table(text = "
state    y1970  y1980  y1990  y2000
Alaska       4      6     NA      7
Iowa        10     20     30     40
Nevada     100    100    100    100
Ohio        50     60     NA     80
total      172    195    215    238
Wyoming      8      9     10     11
", sep = "", header = TRUE)

desired.result = read.table(text = "
state         y1970       y1980       y1990       y2000
Alaska   0.02325581  0.03076923          NA  0.02941176  
Iowa     0.05813953  0.10256410  0.13953488  0.16806723  
Nevada   0.58139535  0.51282051  0.46511628  0.42016807  
Ohio     0.29069767  0.30769231          NA  0.33613445  
total    1.00000000  1.00000000  1.00000000  1.00000000  
Wyoming  0.04651163  0.04615385  0.04651163  0.04621849  
", sep = "", header = TRUE)

state  <- as.vector(unlist(my.data[, 1]))

my.totals <- as.vector(unlist(my.data[ my.data$state=='total', 2:5]))

proportions <- matrix(NA, nrow=nrow(my.data), ncol=ncol(my.data))
proportions <- as.data.frame(proportions)

for(i in 1:nrow(my.data)) {
 for(j in 1:ncol(my.data)) {

  if(j==1) proportions[i,1] <- state[i] 
  if(j> 1) proportions[i,j] <- my.data[i,j] / my.totals[j-1]

 }
}

colnames(proportions) <- names(my.data)
proportions

#     state      y1970      y1980      y1990      y2000
# 1  Alaska 0.02325581 0.03076923         NA 0.02941176
# 2    Iowa 0.05813953 0.10256410 0.13953488 0.16806723
# 3  Nevada 0.58139535 0.51282051 0.46511628 0.42016807
# 4    Ohio 0.29069767 0.30769231         NA 0.33613445
# 5   total 1.00000000 1.00000000 1.00000000 1.00000000
# 6 Wyoming 0.04651163 0.04615385 0.04651163 0.04621849 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T23:16:10.050

大概是这样的：

```
df[, -1] <- lapply( df[ , -1], function(x) x/sum(x, na.rm=TRUE) ) 
```

如果它是一个矩阵，你可以使用`prop.table(mat)`. 但是，在这种情况下，您需要限制仅处理数字列（通过排除第一个列）。

此外，我认为您需要排除“总计”行：

```
 my.data[-5, -1] <- lapply( my.data[ -5 , -1], function(x){ x/sum(x, na.rm=TRUE)} )
 my.data[ -5 , ]
    state      y1970      y1980      y1990      y2000
1  Alaska 0.02325581 0.03076923         NA 0.02941176
2    Iowa 0.05813953 0.10256410 0.21428571 0.16806723
3  Nevada 0.58139535 0.51282051 0.71428571 0.42016807
4    Ohio 0.29069767 0.30769231         NA 0.33613445
6 Wyoming 0.04651163 0.04615385 0.07142857 0.04621849 
```

# -------------

替代方法：

```
> my.data[,-1] <-lapply( my.data[  , -1], function(x){ x/x[5] } )
> my.data
    state      y1970      y1980      y1990      y2000
1  Alaska 0.02325581 0.03076923         NA 0.02941176
2    Iowa 0.05813953 0.10256410 0.13953488 0.16806723
3  Nevada 0.58139535 0.51282051 0.46511628 0.42016807
4    Ohio 0.29069767 0.30769231         NA 0.33613445
5   total 1.00000000 1.00000000 1.00000000 1.00000000
6 Wyoming 0.04651163 0.04615385 0.04651163 0.04621849 
```

这显示了当在两个边距上使用时 prop.table 将返回缺失值，然后分别在行和列上使用一个非常简单的矩阵：

```
> prop.table( matrix( c( 1,2,NA, 3),2) )
     [,1] [,2]
[1,]   NA   NA
[2,]   NA   NA
> prop.table( matrix( c( 1,2,NA, 3),2), 1 )
     [,1] [,2]
[1,]   NA   NA
[2,]  0.4  0.6
> prop.table( matrix( c( 1,2,NA, 3),2), 2 )
          [,1] [,2]
[1,] 0.3333333   NA
[2,] 0.6666667   NA 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-13T20:39:12.497

或者，您可以：

```
library(tidyverse)

my.data = read.table(text = "
state    y1970  y1980  y1990  y2000
Alaska       4      6     NA      7
Iowa        10     20     30     40
Nevada     100    100    100    100
Ohio        50     60     NA     80
total      172    195    215    238
Wyoming      8      9     10     11
", sep = "", header = TRUE)

my.data %>% 
  # Convert table into long format
  pivot_longer(cols = -state, names_to = "year") %>% 
  # (Optional) Convert year to numeric:
  mutate(year = as.numeric(gsub("^y", "", year))) %>%  
  # Convert data frame to a table
  xtabs(formula = value ~ state + year) %>% 
  # Calculate proportions: 
  prop.table
#>          year
#> state            1970        1980        1990        2000
#>   Alaska  0.002555911 0.003833866 0.000000000 0.004472843
#>   Iowa    0.006389776 0.012779553 0.019169329 0.025559105
#>   Nevada  0.063897764 0.063897764 0.063897764 0.063897764
#>   Ohio    0.031948882 0.038338658 0.000000000 0.051118211
#>   total   0.109904153 0.124600639 0.137380192 0.152076677
#>   Wyoming 0.005111821 0.005750799 0.006389776 0.007028754 
```

# jquery - jquery 选项卡无法摆脱格式中的“+”图标

> ID：13503581
> 
> 赞同：0
> 
> 时间：2012-11-21T23:12:42.760
> 
> 标签：jquery, tabs, icons

我正在使用 jquery 选项卡和自定义 jquery ui，但是由于某种原因，“+”号总是出现在每个选项卡的顶部，有人知道为什么以及如何摆脱它吗？

![在此处输入图像描述](../Images/838b9d7565f83bb109219290b891c516.png)

我没有在css中添加任何图标，我只是改变了背景等等。这是选项卡的 css 部分：

```
 .ui-tabs { position: relative; padding: .2em; zoom: 1; } /* position: relative prevents IE scroll bug (element with position: relative inside container with overflow: auto appear as "fixed") */
.ui-tabs .ui-tabs-nav { margin: 0; padding: .2em .2em 0; }
.ui-tabs .ui-tabs-nav li { list-style: none; float: left; position: relative; top: 0; margin: 1px .2em 0 0; text-align:center; width: 110px; border-bottom: 0;
                           padding: 0; white-space: nowrap; }
.ui-tabs .ui-tabs-nav li a { float: left; padding: .5em 1em; text-decoration: none; }
.ui-tabs .ui-tabs-nav li.ui-tabs-active a{color:#A7A88A}
.ui-tabs .ui-tabs-nav li.ui-tabs-active { margin-bottom: -1px; padding-bottom: 1px; background:green}
.ui-tabs .ui-tabs-nav li.ui-tabs-active a, .ui-tabs .ui-tabs-nav li.ui-state-disabled a, .ui-tabs .ui-tabs-nav li.ui-tabs-loading a { cursor: text; }
.ui-tabs .ui-tabs-nav li a, .ui-tabs-collapsible .ui-tabs-nav li.ui-tabs-active a { cursor: pointer; } /* first selector in group seems obsolete, but required to overcome bug in Opera applying cursor: text overall if defined elsewhere... */
.ui-tabs .ui-tabs-panel { display: block; border-width: 0; padding: 1em 1.4em; background: none; }
.ui-tooltip {
    padding: 8px;
    position: absolute;
    z-index: 9999;
    max-width: 300px;
    -webkit-box-shadow: 0 0 5px #aaa;
    box-shadow: 0 0 5px #aaa;
}

.ui-tabs-nav li img {

display: block;
margin-left: auto;
margin-right: auto

}

#mytabs{
    padding: 0px;
    background: none;
    border-width: 0px;
}
#mytabs .ui-tabs-nav {
    padding-left: 0px;
    background: transparent;
    border-width: 0px 0px 1px 0px;
    -moz-border-radius: 0px;
    -webkit-border-radius: 0px;
    border-radius: 0px;
}
#mytabs .ui-tabs-panel {
    background: url(images/ui-bg_highlight-hard_100_f5f3e5_1x100.png) repeat-x scroll 50% top #f5f3e5;
    border-width: 0px 1px 1px 1px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:41:47.363

它来自：

```
.art-postcontent ul > li:before
{
   content:url('images/postbullets.png');
   ...
} 
```

在第 3950 行，以及

```
.art-post ul > li::before {
    content: url('images/postbullets.png');
    ...
} 
```

在第 3938 行。您可以在 css 中删除这两个内容属性，+ 号应该会消失。

# matlab - ode 求解器中时间相关参数值的 for 循环仅适用于 t 的某些值

> ID：13503582
> 
> 赞同：1
> 
> 时间：2012-11-21T23:12:43.837
> 
> 标签：matlab, ode

我正在使用一个简单的 if 循环来更改我的 ode 脚本中的参数值。这是我编写的一个示例脚本，它表现出同样的问题。所以首先是有效的版本：

```
function aah = al(t,x)

if (t>10000 && t<10300)
    ab = [0; 150];
else
    ab = [150; 0];
end

aah = [ab]; 
```

这可以使用

```
t = [0:1:10400];
x0 = [0,0];
[t,x] = ode23tb(@al, t,x0); 
```

并可视化

```
plot(t,x(:,1))
plot(t,x(:,2)) 
```

好的，这是好的版本。现在，如果您所做的只是将 t 更改为

```
t = [0:1:12000]; 
```

整个事情都爆炸了。您可能认为这只是 matlab 对图形进行平均，但这不是因为如果您查看

```
x(10300,2) 
```

两种情况下的答案应该是相同的，因为代码没有改变。但是第二个版本输出 0，这是错误的！

到底是怎么回事？有人有想法吗？

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T03:56:38.970

您的函数是恒定的（除了 10000 < t < 10300），因此内部求解器开始以非常大的时间步长求解系统，默认为总时间的 10%。（在自适应 ODE 求解器中，如果系统是常数，则高阶和低阶解将给出相同的解，并且（估计的）误差为零。因此求解器假设当前时间步长足够好。）您可以看看你是否`tspan`只给出两个元素，开始时间和结束时间。

```
t = [0 12000]; 
```

通常`tspan`不影响求解器的内部时间步长。求解器使用其内部时间步长求解系统，然后在`tspan`用户给定的位置进行插值。因此，如果内部时间步不幸“跳过”区间 [10000, 10300]，求解器将不知道该区间。

所以你最好设置最大步长，相对小于 300。

```
options = odeset('MaxStep', 10);
[t, x] = ode23tb(@al, t, x0, options); 
```

如果您不想一直以小步长求解（并且如果您“知道”函数何时不恒定），则应单独求解。

```
t1 = [0 9990];
t2 = [9990 10310];
t3 = [10310 12000];

[T1, x1] = ode23tb(@al, t1, x0);
[T2, x2] = ode23tb(@al, t2, x1(end,:));
[T3, x3] = ode23tb(@al, t3, x2(end,:));

T = [T1; T2(2:end); T3(2:end)];
x = [x1; x2(2:end,:); x3(2:end,:)]; 
```

# assembly - 使用函数 x86 nasm 的段错误

> ID：13503585
> 
> 赞同：1
> 
> 时间：2012-11-21T23:12:48.360
> 
> 标签：assembly, segmentation-fault, nasm, calling-convention

我正在用野牛编写编译器，并尝试实现程序。我在网上找到了“global intpow”示例，它工作得很好，并且我根据它进行了自己的过程调用。此代码片段中的函数“bar”只接受一个整数参数，并打印它。当我编译的程序运行并执行时：

-intpow 将按预期运行，对于正常的程序终止，具有“bar”声明的函数将按预期运行，对于正常的函数终止，但是如果我调用 bar （因此添加三行评论说酒吧调用独有），程序将完全按照预期运行，直到最后，它会出现分段错误。

gdb 说它在**__bar_end**中的最后一个 pop ebp ......为什么这是段错误？

```
extern printf
extern scanf
extern pow
SECTION .data
printf_int:
    db "%d", 10, 0
printf_float:
    db "%lf", 10, 0
printf_str:
    db "%s", 10, 0
scan_int:
    db "%d", 0
scan_float:
    db "%lf", 0
esp_tmp:
    dd 0

SECTION .text
global intpow
intpow:
    push    ebp
    mov     ebp,esp
    mov     eax,[ebp+12]
    mov     ebx,[ebp+12]
    mov     ecx,[ebp+8]

loop:
    cmp     ecx,1
    cmp     ecx,1
    jle     finish
    dec     ecx
    imul    eax,ebx
    jmp     loop

finish:
    mov     esp,ebp
    pop     ebp
    ret
global main
main:
    push    ebp
    mov     ebp,esp
    jmp     __bar_END
global __bar
__bar:
    push    ebp
    mov     ebp,esp
    sub     esp,-4
    push    DWORD [ebp + 8]
    push    DWORD printf_int
    mov     [esp_tmp], esp
    add     DWORD [esp_tmp], 8
    call    printf
    mov     esp, DWORD [esp_tmp]
    mov     esp,ebp
    pop     ebp
    ret
__bar_END:
    push    DWORD 12 #Unique to bar call
    call    __bar    #unique to bar call
    add     esp,4    #unique to bar call
    push    DWORD str0
    push    DWORD printf_str
    mov     [esp_tmp], esp
    add     DWORD [esp_tmp],8
    call    printf
    mov     esp, DWORD [esp_tmp]
    mov     esp, ebp
    pop     ebp
    ret

SECTION .data

global_vars:    times 0 db 0

true:   db "true",0
false:  db "false",0
str0:   db "hello world",0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:20:21.890

问题是`sub esp, -4`. 它将堆栈指针向上移动（减去负数是加法）。并不是说您根本不需要分配任何空间，因为您没有使用它。现在去清理剩下的烂摊子；）

# java - 数据集中的 SQL 频率计数

> ID：13503587
> 
> 赞同：0
> 
> 时间：2012-11-21T23:12:54.633
> 
> 标签：java, sql, dataset, frequency

我有一个带有 ID 和值的数据集。对于每个值，我想在数据集中获取其相应的频率。**什么是最有效的基于纯 SQL 查询的解决方案？**（即不使用 java 等...）或者将 Java 与 SQL 一起使用会更有效吗？

1.  我正在使用 Derby SQL

这是我之前对这个问题的解决方案

1.  获取新表中的所有不同值并添加频率列
2.  编写 Java 代码以遍历此新表中的所有不同值，并对原始数据集运行计数查询

我真的很想避免额外的Java代码......

感谢所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:28:51.867

```
SELECT Value, COUNT(*) / (SELECT COUNT(*) FROM dataset) AS Frequency
FROM dataset
GROUP BY Value 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:15:08.897

```
SELECT COUNT(DISTINCT value)
  FROM dataset 
```

# jquery - 如何在 iframe 子元素上应用 3D 变换？

> ID：13503592
> 
> 赞同：1
> 
> 时间：2012-11-21T23:13:28.713
> 
> 标签：jquery, ios, css, html, cordova

在 Phonegap 2.0.0 iOS 6.0.1 应用程序上使用此处描述的技术：

[http://cantina.co/2012/03/06/ios-5-native-scrolling-grins-and-gothcas/](http://cantina.co/2012/03/06/ios-5-native-scrolling-grins-and-gothcas/)

我尝试了各种变体：

```
iframe * {
    -webkit-transform: translate3d(0,0,0);
} 
```

似乎我不能对 iframe 中的子元素应用硬件加速，这实际上是滚动的，但是以一种生涩的非平滑方式。

如何实现 iframe 内容的平滑滚动？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:54:45.040

如果 iframe 显示外部网站页面，则无法执行此操作。

而且您也不能为这样的 iframe 内容定义 css 规则。不可能。

但是有另一种方法`jQuery`，

```
$(document).ready(function() {
    $('iframe').contents().find("*").css("-webkit-transform","translate3d(0,0,0)");
});​ 
```

*但不要忘记，这仅适用于同一域。

# java - 调用 Hibernate 会话刷新

> ID：13503593
> 
> 赞同：0
> 
> 时间：2012-11-21T23:13:37.237
> 
> 标签：java, hibernate

我存储了一个实体，然后我需要执行本机查询（它是通过 完成的`doWork`），并且为了成功执行代表实体的查询记录 [s] 必须存在于数据库中（更准确地说，它必须在同一个事务中可用)，所以我想`flush`在这种情况下调用是有效的......

我对说flush的[hibernate文档感到困惑](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html#flush%28%29)

> 必须在工作单元结束时、提交事务和关闭会话之前调用

较新的版本[http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/#d5e976](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/#d5e976)有`flush`在循环中调用的示例。

可以在提交之前调用flush吗？如果没有，有什么替代方案？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:28:31.903

可以随时冲洗。请参阅[文档](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/objectstate.html#objectstate-flushing)。

# lucene - 使用 Lucene Highlighter 基础设施来标记任意文本

> ID：13503597
> 
> 赞同：0
> 
> 时间：2012-11-21T23:14:03.803
> 
> 标签：lucene, highlight

我在客户端-服务器架构中使用 Lucene 3.5，如下所示：客户端向服务器发出查询。服务器返回查询中使用的术语列表和命中列表，包括由应用程序生成的片段`Highlighter`到检索到的文档。然后用户可以请求显示完整的文档。该文档来自我正在构建的系统中的另一项服务。

当显示请求的文档时，我想突出显示用于检索它的相同术语。我可以在不涉及 Lucene 基础架构的情况下编写一些其他代码来执行此操作，但由于我已经有了生成代码片段的代码，我希望能够重用它。（干燥等等。）

所以我的问题是如何最好地做到这一点：当需要用搜索结果标记文档时，客户端有一组用于检索文档的术语和检索到的文档的 id。它还知道文档中的哪些字段可以用查询词进行标记。

一些可能的策略：

1.  创建仅选择所需文档的查询过滤器，然后仅在该文档上重新运行查询。

2.  不知何故（如何？）构造 a`Scorer`不依赖于 a`Query`但可以用我已经拥有的术语播种。

3.  完全跳过 Lucene 基础架构。

4.  还有什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:04:08.707

我相信您可以使用[TermVector](http://lucene.apache.org/core/4_0_0/core/index.html)为您的文档编制索引，它会告诉您每个术语在原始文档中的位置。使突出显示变得微不足道。或者简单地重复使用[contrib 荧光笔](http://lucene.apache.org/core/4_0_0/highlighter/index.html)

# javascript - 当轴标签映射为比例域的一部分时，如何在 d3 中修改堆积条形图的轴标签

> ID：13503600
> 
> 赞同：3
> 
> 时间：2012-11-21T23:14:23.367
> 
> 标签：javascript, d3.js

[我正在使用基于此](http://bl.ocks.org/3886208)的条形图，并且我想修改 x 轴标签（旋转它们或只显示每隔一个或每隔三分之一......这将允许我在不重叠的情况下拟合标签）。我花了很多时间研究这个，但似乎说起来容易做起来难（尽管我对 d3 还很陌生）。我相信有问题的代码段包括：

```
var x = d3.scale.ordinal()
  .rangeRoundBands([0, width], .1); 
```

...

```
var xAxis = d3.svg.axis()
  .scale(x)
  .orient("bottom"); 
```

...

```
x.domain(data.map(function(d) { return d.State; })); 
```

...上面是映射发生的地方（我假设基于“地图”功能）

```
svg.append("g")
  .attr("class", "x axis")
  .attr("transform", "translate(0," + height + ")")
  .call(xAxis); 
```

...

```
var state = svg.selectAll(".state")
  .data(data)
.enter().append("g")
  .attr("class", "g")
  .attr("transform", function(d) { return "translate(" + x(d.State) + ",0)"; }); 
```

...

```
 state.selectAll("rect")
  .data(function(d) { return d.ages; })
.enter().append("rect")
  .attr("width", x.rangeBand())
  .attr("y", function(d) { return y(d.y1); })
  .attr("height", function(d) { return y(d.y0) - y(d.y1); })
  .style("fill", function(d) { return color(d.name); }); 
```

问题是我不一定想要图表中的每个条形图都有一个 x 轴标签（它太杂乱了）。我已经尝试了几种不同的使用方式

```
axis.ticks
axis.tickValues
axis.tickSubdivide
axis.tickSize 
```

但我认为他们失败了，因为 d.State 与其各自的列结婚（我的图表使用日期而不是州名）......有什么见解吗？

对不起这个混乱的问题。我欢迎那些了解我所要求的内容的人进行编辑，以使我的问题更加清楚（我不确定提出问题的最佳方式）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T15:33:08.983

线

```
x.domain(data.map(function(d) { return d.State; })); 
```

正在为轴使用的比例设置域。因为比例是有序的，所以轴默认使用刻度的所有值。您应该能够使用上面提到的 axis.tickValues 函数设置实际的刻度值。您只需在设置比例域的调用之后设置它，因为我怀疑设置域会重置刻度值。只需添加如下内容：

```
xAxis.tickValues(data.map( function(d,i) 
  { 
    if(i % 2 ===0 ) return d.State; 
  })
    .filter(function (d) 
      { return !!d; } )); 
```

在这里，我将数据数据映射到单个选定的状态值数组，其中散布着“未定义”，然后过滤掉所有未定义的值。剩余的状态值成为刻度。

如果你使用下划线，你可能会使这条线更漂亮。

您可以在[此处](http://jsfiddle.net/9mmeg/)查看有效的解决方案。

# c# - TTransportException“无法读取，远程端已关闭”

> ID：13503601
> 
> 赞同：4
> 
> 时间：2012-11-21T23:14:26.010
> 
> 标签：c#, thrift

在我用 C# 编写的客户端中出现此错误。我的服务器在 python 中。这是我第一个使用 Thrift 的测试程序。看起来我的 python 服务器正在运行。这是我的客户代码。我在调用“Client.add(2,3)”时收到此错误

```
static void Main(string[] args)
    {
        try
        {
            var socket = new TSocket("localhost", 9089);
            var transport = new TBufferedTransport(socket);
            var protocol = new TBinaryProtocol(transport);
            var client = new CalculatorService.Client(protocol);
            transport.Open();
            if (transport.IsOpen)
            {
                //I am seeing this message
                Console.WriteLine("server is open for business");                    
            }
            Console.WriteLine(client.add(2, 3)); //this is the line that gives me the error
            transport.Close();
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        } 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-03T16:47:09.037

尝试使用，

```
client.InputProtocol.Transport.Open(); 
```

代替，

```
transport.Open(); 
```

顺便说一句，我的服务器是基于 Java 的

# java - Java - 使用多个数据报套接字和端口

> ID：13503604
> 
> 赞同：1
> 
> 时间：2012-11-21T23:15:02.017
> 
> 标签：java, networking, udp, port

我正在开发一个使用 UDP 进行通信的多客户端/单服务器应用程序。原因是我正在使用多播并且正在流式传输音频。

我在 UDP/TCP 方面没有很多经验，我不确定我是否可以使用多个`DatagramSockets`具有多个不同端口的多个端口。我有几个不同的对象需要从一个设备发送到另一个设备，因此我为每种类型的对象使用一个端口。

这个可以吗？我现在已经在使用大约 7 个不同的端口。如何使用尽可能少的端口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:17:42.353

With multiple clients and one server, you could have all clients send data to the same port on the server. The server would read all information from one socket (which is reading data on that port). Each client that sends data can send metadata along with each payload identifying the user, so the server can discern which received packet belongs to who. I actually think that you can already see the address that a packet comes from using built in functionality however. You could use these addresses to identify different clients, however down the road you might need a more robust solution to make your implementation more secure.

# google-apps-script - 读取错误信息

> ID：13503606
> 
> 赞同：0
> 
> 时间：2012-11-21T23:15:06.570
> 
> 标签：google-apps-script, error-correction

我如何查看在电子表格中运行脚本时收到的错误消息的更多详细信息（或就此而言）。例如; 当收到“红色失败脚本”消息时，它只会以红色突出显示它并提供指向 Dismiss 的链接。我想获得有关调试和故障排除错误的更多信息。

是否有一些工具可以查看这些信息？

如果不是，那么用于深入了解错误并确切找出导致它更好地找到解决方案的典型故障排除方法是什么？

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T03:06:56.923

您想在电子表格中打开脚本编辑器，以便查看脚本本身。从顶部的下拉列表中选择您尝试在电子表格中运行的功能，然后点击播放按钮。它应该给你一个失败的原因和一个行号。在那里放置一个断点并点击调试按钮并单步执行。

# ruby-on-rails - Elasticsearch with Tire on Rails 批量导入和索引问题

> ID：13503608
> 
> 赞同：1
> 
> 时间：2012-11-21T23:15:11.680
> 
> 标签：ruby-on-rails, mongodb, mongoid, elasticsearch, tire

我有一个带有基于 Elasticsearch 和 Tire 的全文搜索的 rails 应用程序，它已经在一个名为 Category 的 MongoDB 模型上工作，但现在我想添加一个基于[MongoID Embedded 1-n](http://mongoid.org/en/mongoid/docs/relations.html#embeds_many) model User 的更复杂的搜索，其中 embeds_many :关注列表

现在我必须批量导入和索引监视列表中的所有字段，我想知道：

1.  我怎样才能做到这一点 ？
2.  可以只索引监视列表子字段，而没有用户父字段吗？

Embedded 1-N MongoDB/MongoID 模型如下所示：

app/models/user.rb （父级）：

```
class User
  include Mongoid::Document

  include Tire::Model::Search
  include Tire::Model::Callbacks
  index_name 'users'

  field :nickname
  field ... many others

  embeds_many :watchlists
end 
```

app/models/watchlist.rb （嵌入的“许多”儿童）：

```
class Watchlist
  include Mongoid::Document

  include Tire::Model::Search
  include Tire::Model::Callbacks
  index_name 'watchlists'

  field :html_url
  embedded_in :user
end 
```

关于如何完成任务的任何建议？

**更新：** 这里是用 mongo shell 看到的模型的一部分

```
 > user = db.users.findOne({'nickname': 'lgs'})
    {
       "_id" : ObjectId("4f76a16cf2a6a12f88cbca43"),
       "encrypted_password" : "",
       "sign_in_count" : 0,
       "provider" : "github",
       "uid" : "1573",
       "name" : "Luca G. Soave",
       "email" : "luca.soave@gmail.com",
       "nickname" : "lgs",
       "watchlists" : [
           {
               "_id" : ObjectId("4f76997f1d41c81173000002"),
               "tags_array" : [ git, peristence ],
               "html_url" : "https://github.com/mojombo/grit",
               "description" : "Grit gives you object oriented read/write access to Git repositories via Ruby.",
               "fork_" : false,
               "forks" : 207,
               "watchers" : 1258,
               "created_at" : ISODate("2007-10-29T14:37:16Z"),
               "pushed_at" : ISODate("2012-01-27T01:05:45Z"),
               "avatar_url" : "https://secure.gravatar.com/avatar/25c7c18223fb42a4c6ae1c8db6f50f9b?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png"
           },
       ...
       ...
    } 
```

我想索引和查询嵌入式子监视列表文档拥有的任何字段：

```
 ... "tags_array", "html_url", "description", "forks" 
```

但我不希望 elasticsearch 包含父用户字段：

```
 ... "uid", "name", "email", "nickname" 
```

这样当我查询“git 持久性”时，它会查看原始 MongoDB 的每个“用户”的每个“关注列表”索引字段。

（对不起，这里的单数和复数不匹配，我只是指出文档对象名称）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T17:07:01.410

这实际上取决于您要如何为搜索引擎序列化数据，具体取决于您要如何查询它们。请更新问题，我会更新答案。（另外，最好只删除 ES 日志，它们在这里不相关。）

我不确定 Rake 任务如何与 Mongo 中的嵌入式文档一起工作，以及为什么它最后似乎“挂起”。运行任务时，您的数据是否在“用户”索引中？

请注意，当 Rake 任务不够灵活时，很容易提供您自己的索引代码。请参阅`Tire::Index#import`集成测试。

# python - 如何获取我的 python 脚本的路径？

> ID：13503610
> 
> 赞同：3
> 
> 时间：2012-11-21T23:15:27.697
> 
> 标签：python

我正在尝试获取我的 python 脚本的路径。

我知道 'sys.argv[0] 给了我 python 脚本的路径和名称。

我怎样才能得到路径？

我试过了：

```
 print sys.argv[0]
    path = sys.argv[0].split("/")
    scriptpath = "".join(path[0:-1]) 
```

但它不会添加回路径分隔符。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T23:37:15.283

更喜欢使用`__file__`，像这样：

```
os.path.dirname(os.path.realpath(__file__)) 
```

*注意：*如果您通过另一个目录中的另一个脚本调用脚本，则使用`sys.argv[0]`可能不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T23:17:06.883

你正在寻找[`os.path.dirname()`](http://docs.python.org/2/library/os.path.html#os.path.dirname)，如果你可能有一个相对路径，你也[`os.path.abspath()`](http://docs.python.org/2/library/os.path.html#os.path.abspath)需要

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T23:18:02.207

Don't try string operations on paths, use the `os.path` module instead. E.g.:

```
scriptpath = os.path.dirname(sys.argv[0]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T23:20:01.873

[From another Stackoverflow thread](https://stackoverflow.com/questions/595305/python-path-of-script)

```
import sys, os

print 'sys.argv[0] =', sys.argv[0]             
pathname = os.path.dirname(sys.argv[0])        
print 'path =', pathname
print 'full path =', os.path.abspath(pathname) 
```

# git - git：签出或克隆回购的多个子集

> ID：13503612
> 
> 赞同：1
> 
> 时间：2012-11-21T23:15:46.080
> 
> 标签：git

我有 3 个地方 A、B 和 C，我想在其中签出/克隆不同的、可能相交的 repo R 子集。我希望任何用于“标记”这些子集的方法都是 repo 的永久部分（而不是而不是我维护的外部列表）。

这是可能的，如果可以，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:18:05.760

First of all, when you clone a repo, you will get all content of it, you can't pull only a part of it.

In git, you can use branches to give a name to a commit. So you might start a new branch, compose it the way you want. Afterwards, you push that to the remote repository. Same with B and C.

When you first clone the repo, just select the respective branch you want to use. When you add commits to a branch, the HEAD of the branch will move with the commits, so you will always have the latest version once pushed.

If you look for a single, permanent mark, you can compose your branch, and use a tag. A tag is always associated with a single commit and won't move unless explicitly done by the user.

# sharepoint-2010 - 如何创建这种类型的任务列表，其中包含“状态”和“描述”列而不是“任务状态”和“正文”？

> ID：13503616
> 
> 赞同：0
> 
> 时间：2012-11-21T23:16:00.633
> 
> 标签：sharepoint-2010

我有 2 个网站集，A 和 B。

在网站集 A 中，当我创建一个新的任务列表时，列是（我将其称为“类型 A”）：

*   ％ 完全的
*   分配给
*   **身体**（这个不同）
*   截止日期
*   前辈
*   优先
*   开始日期
*   任务组
*   **任务状态**（这个不同）
*   标题
*   工作流程名称
*   由...制作
*   修改者

在站点集合 B 中，新创建的任务列表将具有这样的列（我将其称为“类型 B”）：

*   ％ 完全的
*   分配给
*   **说明**（这个不同）
*   截止日期
*   前辈
*   优先
*   开始日期
*   **状态**（这个不同）
*   任务组
*   标题
*   工作流程名称
*   由...制作
*   修改者

看起来这是两种类型的任务列表。我使用相同的方法来创建新的任务列表：

**站点操作 - 更多选项 -（按列表过滤）然后选择“任务”**

网站集 A 中有一些 B 类任务列表，但是当我创建新的时，它们始终是 A 类。如何在网站集 A 中创建 B 类任务列表？

我希望这不会太混乱......

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T06:38:45.640

您可以使用自定义[Content Types](http://msdn.microsoft.com/en-us/library/ms479905%28v=office.14%29.aspx)来完成此要求。您可以使用自定义内容类型继承任务内容类型，而不是显示您的需求字段。

这里显示了任务的[内容类型 ID ：http:](http://msdn.microsoft.com/en-us/library/aa543822.aspx) [//joelblogs.co.uk/2011/06/16/sharepoint-2010-base-types-list-template-and-definition-ids-and-content-types-ids /](http://joelblogs.co.uk/2011/06/16/sharepoint-2010-base-types-list-template-and-definition-ids-and-content-types-ids/)

从 VS2010 创建您的内容类型，例如：

```
 <ContentType ID="0x01080100FFbc98c2529347a5886b8d2576b954ef"
               Name="Workflow 1 Tasks 1"
               Group="Workflow 1 Tasks"
               Description="Content Type of Tasks 1 of Workflow 1">
    <FieldRefs>

      <!-- OOTB Task Content Type -->
      <FieldRef ID="{c042a256-787d-4a6f-8a8a-cf6ab767f12d}" Name="ContentType" />
      <FieldRef ID="{fa564e0f-0c70-4ab9-b863-0177e6ddd247}" Name="Title" Required="TRUE" ShowInNewForm="TRUE" ShowInEditForm="TRUE" />
      <FieldRef ID="{c3a92d97-2b77-4a25-9698-3ab54874bc6f}" Name="Predecessors" />
      <FieldRef ID="{a8eb573e-9e11-481a-a8c9-1104a54b2fbd}" Name="Priority" />
      <FieldRef ID="{c15b34c3-ce7d-490a-b133-3f4de8801b76}" Name="Status" />
      <FieldRef ID="{d2311440-1ed6-46ea-b46d-daa643dc3886}" Name="PercentComplete" />
      <FieldRef ID="{53101f38-dd2e-458c-b245-0c236cc13d1a}" Name="AssignedTo" />
      <FieldRef ID="{7662cd2c-f069-4dba-9e35-082cf976e170}" Name="Body" />
      <FieldRef ID="{64cd368d-2f95-4bfc-a1f9-8d4324ecb007}" Name="StartDate" />
      <FieldRef ID="{cd21b4c2-6841-4f9e-a23a-738a65f99889}" Name="DueDate" />
      <FieldRef ID="{58ddda52-c2a3-4650-9178-3bbc1f6e36da}" Name="WorkflowLink" />
      <FieldRef ID="{16b6952f-3ce6-45e0-8f4e-42dac6e12441}" Name="OffsiteParticipant" />
      <FieldRef ID="{4a799ba5-f449-4796-b43e-aa5186c3c414}" Name="OffsiteParticipantReason" />
      <FieldRef ID="{18e1c6fa-ae37-4102-890a-cfb0974ef494}" Name="WorkflowOutcome" />
      <FieldRef ID="{e506d6ca-c2da-4164-b858-306f1c41c9ec}" Name="WorkflowName" />
      <FieldRef ID="{ae069f25-3ac2-4256-b9c3-15dbc15da0e0}" Name="GUID" />
      <FieldRef ID="{8d96aa48-9dff-46cf-8538-84c747ffa877}" Name="TaskType" />
      <FieldRef ID="{17ca3a22-fdfe-46eb-99b5-9646baed3f16}" Name="FormURN" />
      <FieldRef ID="{78eae64a-f5f2-49af-b416-3247b76f46a1}" Name="FormData" />
      <FieldRef ID="{8cbb9252-1035-4156-9c35-f54e9056c65a}" Name="EmailBody" />
      <FieldRef ID="{47f68c3b-8930-406f-bde2-4a8c669ee87c}" Name="HasCustomEmailBody" />
      <FieldRef ID="{cb2413f2-7de9-4afc-8587-1ca3f563f624}" Name="SendEmailNotification" />
      <FieldRef ID="{4d2444c2-0e97-476c-a2a3-e9e4a9c73009}" Name="PendingModTime" />
      <FieldRef ID="{35363960-d998-4aad-b7e8-058dfe2c669e}" Name="Completed" />
      <FieldRef ID="{1bfee788-69b7-4765-b109-d4d9c31d1ac1}" Name="WorkflowListId" />
      <FieldRef ID="{8e234c69-02b0-42d9-8046-d5f49bf0174f}" Name="WorkflowItemId" />
      <FieldRef ID="{1c5518e2-1e99-49fe-bfc6-1a8de3ba16e2}" Name="ExtendedProperties" />
     <!-- OOTB Task Content Type -->

     <!-- Add your additional colums what you want. -->

    </FieldRefs>

    <XmlDocuments>
      <XmlDocument NamespaceURI="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
        <FormTemplates xmlns="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
          <Display>ListForm</Display>
          <Edit>ListForm</Edit>
          <New>ListForm</New>
        </FormTemplates>
      </XmlDocument>
    </XmlDocuments>
  </ContentType> 
```

> 在创建两个自定义内容类型之后。内容类型 A 和内容类型 B 并在列表中需要时将其设置为默认值。

啤酒花它的帮助！

# image-processing - 从图像文件中提取坐标

> ID：13503623
> 
> 赞同：1
> 
> 时间：2012-11-21T23:16:44.893
> 
> 标签：image-processing, opencv, image-recognition, imagej

如何获取图像中（绘制的）线的坐标数组？坐标应相对于图像边框。输入： *.img 。输出坐标数组（固定步长）。任何第三方软件可以做到这一点？例如存在高对比度差异 - 白色背景和彩色黑色线条；或红色和绿色等。

例子：
![在此处输入图像描述](../Images/cc26086b24741325e215e7ef25461185.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T09:40:59.753

哦，你的意思是非直线。您需要定义一条“线”。直观地说，您可能指的是图像的一个连接区域，其中轴长度与中轴与边缘之间的距离之间的纵横比很高（即相对较长和较窄，即使它环绕）。可能的方法：

*   阈值或按颜色选择。也许根据颜色直方图按颜色选择，或按照此处所述进行色调分离：[Adobe Photoshop-style posterization and OpenCV](https://stackoverflow.com/questions/11064454/adobe-photoshop-style-posterization-and-opencv)，然后调用 scipy.ndimage.measurements.label()

*   对于上面的每个区域，[skeletonize](http://en.wikipedia.org/wiki/Topological_skeleton)。有用的教程：“[使用 OpenCV-Python 进行骨架化](http://opencvpython.blogspot.com/2012/05/skeletonization-using-opencv-python.html)”。但是，您可能还需要到边缘的距离，因此请使用[skimage.morphology.medial_axis](http://scikit-image.org/docs/0.6/api/skimage.morphology.html#skimage.morphology.medial_axis) (..., return_distance=True)

*   对骨架进行某种清理/过滤以删除短分支等。考虑您的特定用途，并假设您的线条不循环，您可以在骨架中找到最长的单条路径。在这里，您还可以根据其骨架中最长路径的长度（相对于到边缘的距离）来确定形状是否为“线”。不确定如何在 opencv 中最好地做到这一点，但 Fiji/ImageJ 中的“Analyze Skeleton”可以让您按分支长度进行过滤。

*   剩下的是原始“线”形状的最细长的[中轴](http://en.wikipedia.org/wiki/Medial_axis)。您可以将其重新采样到您喜欢的某个步骤，或者使用样条曲线等进行拟合。

由于您想要做的事情的性质，很难想出一个适用于一系列图像的示例代码。这可能需要一些仔细的调整。我建议使用一小组图像（语料库），在它们上运行任何版本的算法并手动检查结果，直到结果非常好，然后在大型语料库上尝试。

**编辑：**原始答案，仅适用于直线：

您可能想要使用[霍夫变换](http://en.wikipedia.org/wiki/Hough_transform)（[OpenCV 教程](http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/hough_lines/hough_lines.html)）。

Python 示例代码：[使用 OpenCV 进行水平线检测](https://stackoverflow.com/questions/7227074/horizontal-line-detection-with-opencv)

**编辑：**与用于骨架化的示例代码的相关问题：[如何获得一条完整的中间轴线，其垂直线穿过它？](https://stackoverflow.com/questions/13407470/how-can-i-get-a-full-medial-axis-line-with-its-perpendicular-lines-crossing-it)

# objective-c - 空 NSIndexSet 传递给 NSArray objectsAtIndexes，返回 nil 还是空 NSArray？

> ID：13503624
> 
> 赞同：0
> 
> 时间：2012-11-21T23:16:45.323
> 
> 标签：objective-c, ios, nsarray

正如标题所述，如果我将一个空的 NSIndexSet 传递给 in`objectsAtIndexs:`方法`NSArray`，它返回 nil 还是一个空的 NSArray？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:24:34.647

文档指出，只要您的索引集不包含超出数组边界的索引，并且索引集不为零，您就会返回一个数组。如果索引集被认为是有效的，那么返回一个 nil 数组将是厚颜无耻的，因为这不是调用者和接收者之间的约定。

因此，您将返回一个空数组。

Source: [https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/occ/instm/NSArray/objectsAtIndexes](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/occ/instm/NSArray/objectsAtIndexes):

# java - Program layout - creating aptly sized arrays through System.in.read

> ID：13503631
> 
> 赞同：0
> 
> 时间：2012-11-21T23:17:50.130
> 
> 标签：java, arrays, loops

The following is obviously very impractical but my lecturer insists on teaching us a very fundamental understanding of programming. The exercise he gave us goes like this:

*Using only System.in.read, int, char, and loops, create a method that reads user input from the command line and returns a char[] that's exactly as big as the amount of characters that were entered. Do not use System.arraycopy() or other library methods.*

I'm clueless. Since there seems to be no way of buffering System.in.read input, the array would have to be perfectly sized before any chars are parsed. How in the world is this supposed to work?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:34:46.687

> 创建一个从命令行读取用户输入并返回 char[] 的方法

再想一想，我假设您应该通过自己增长`char[]`数组来进行自己的输入缓冲。`System.arraycopy()`这应该是被提及的原因。

增长一个数组就像

*   创建一个比现有数组长 1 项的新数组。
*   对于旧数组中的每个字符
    *   将字符从旧数组复制到新数组，保持位置
*   用成长的数组替换旧数组。

如果你将它与从输入流中读取所有字符的循环结合起来，你会得到以下内容，并且应该完成你的任务。

*   从长度为 0 的数组开始
*   而输入流中可用的字符
    *   将数组增大一倍
    *   将输入流中的字符放入数组的最后一个槽中
*   返回数组

* * *

甚至可以在没有循环和不断增长的数组的情况下做到这一点。只需创建一个正确大小的新数组一次。

```
private static char[] readToCharArray(int length) throws IOException {
    int read = System.in.read();
    char[] result;
    if (read == -1 || read == '\r' || read == '\n' ) {
        result = new char[length];
    } else {
        result = readToCharArray(length + 1);
        result[length] = (char) read;
    }
    return result;
}

char[] myArray = readToCharArray(0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:36:15.633

手动arraycopy怎么样，文本没有说明什么？如果允许，您可以执行以下操作：

```
 private static char[] readInput() throws IOException {
      System.out.println("type something terminated with '|'");
      char[] input = new char[0];
      int count = 0;
      int read;
      for (; ; ) {
        read = System.in.read();
        if (read == '|') {
          break;
        } else {
          char[] tmp = new char[input.length + 1];
          for (int i = 0; i < input.length; i++) {
            tmp[i] = input[i];
          }
          input = tmp;
        }
        input[count] = (char) read;
        count++;
      }
      return input;
    } 
```

你也可以检查`read == -1`而不是`read == '|'`但输入结束字符因系统而异。除了在每次迭代中复制 char[] 之外，您还可以在每 x 次迭代中执行一次，然后在最后创建一个正确大小的数组。你也可以使用while循环......

但是按照建议只返回一个正确大小的空数组肯定会更有趣`zapl`:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T00:38:12.133

我假设您的讲师的意思是：

*   char[] 应该包含从 System.in 读取的字符（不仅仅是正确的大小）
*   " `System.in.read`" 仅指`InputStream#read()`而不是指其他重载`read`方法 on `InputStream`，因此您只能一次读取一个字符。

你应该看看`ArrayList`是如何实现的。它由一个数组支持，但列表可以任意调整大小。当列表的大小超过数组大小时，`ArrayList`创建一个更大的新数组，然后将旧数组的内容复制到其中。以下是一些相关的摘录`ArrayList`：

```
/**
 * Appends the specified element to the end of this list.
 *
 * @param e element to be appended to this list
 * @return <tt>true</tt> (as specified by {@link Collection#add})
 */
public boolean add(E e) {
    ensureCapacityInternal(size + 1);  // Increments modCount!!
    elementData[size++] = e;
    return true;
}

private void ensureCapacityInternal(int minCapacity) {
    modCount++;
    // overflow-conscious code
    if (minCapacity - elementData.length > 0)
        grow(minCapacity);
}

/**
 * Increases the capacity to ensure that it can hold at least the
 * number of elements specified by the minimum capacity argument.
 *
 * @param minCapacity the desired minimum capacity
 */
private void grow(int minCapacity) {
    // overflow-conscious code
    int oldCapacity = elementData.length;
    int newCapacity = oldCapacity + (oldCapacity >> 1);
    if (newCapacity - minCapacity < 0)
        newCapacity = minCapacity;
    if (newCapacity - MAX_ARRAY_SIZE > 0)
        newCapacity = hugeCapacity(minCapacity);
    // minCapacity is usually close to size, so this is a win:
    elementData = Arrays.copyOf(elementData, newCapacity);
} 
```

由于您不能使用`System.arraycopy()`，因此您需要编写自己的方法来执行此操作。那只是一个`for`循环。

这实际上并不是那么低效。正如 javadoc 所描述的，`ArrayList#add(E)`以摊销的常数时间运行。

如果您`ArrayList`完全遵循该策略，那么您的结果数组将比它需要的更大，所以最后，您需要在最后再进行一次数组调整大小以将其截断为精确的输入大小。或者，您可以在每次读取字符时将数组增加 1，但运行时间将是输入长度的二次 (n^2) 而不是线性 (n)。

# django - Django 中的@permalink 和 get_absolute_url 是什么？

> ID：13503645
> 
> 赞同：43
> 
> 时间：2012-11-21T23:20:02.893
> 
> 标签：django

Django中的`@permalink`和是什么？`get_absolute_url`何时以及**为何**使用它？

请一个非常简单的例子（一个真正的实际例子）。谢谢

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2013-05-01T16:49:38.147

截至 2013 年，Django 文档不鼓励使用永久链接装饰器，并鼓励在 get_absolute_url 方法的主体中使用 reverse()。到 2015 年，永久链接装饰器似乎从 Django 文档中*消失*得无影无踪，最终在 2018 年[的 Django 2.1 版中被删除。](https://docs.djangoproject.com/en/2.1/releases/2.1/#features-removed-in-2-1)

因此，对于创建指向单个对象视图的永久链接的标准 DRY 方法，请在模型中使用 get_absolute_url() ，如下所示：

```
from django.db import models
from django.urls import reverse
#  NOTE: pre Django 1.10+ this is "from django.core.urlresolvers import reverse"

class MyModel(models.Model):
    slug = models.SlugField()

    def get_absolute_url(self):
        return reverse('mymodel_detail', args=(self.slug,)) 
```

然后在 urls.py 中有一个指向您的视图的条目：

```
url(r'^(?P<slug>[-\w\d\_]+)/$',
    MyModelDetailView.as_view(),
    name='mymodel_detail'), 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-11-21T23:54:11.890

`@permalink`是 python[装饰器](https://stackoverflow.com/questions/739654/understanding-python-decorators)，`get_absolute_url`而是 django 模型上的方法。

两者都涉及允许您反转特定对象的 URL，并且应该一起使用。只要您需要提供指向特定对象的链接或想要向用户显示该对象的特定 URL（如果有的话），就可以使用它们

你可以简单地编写你的`get_absolute_url`方法来返回一个硬编码的字符串，但这不符合 Django 的 DRY 哲学（不要重复你自己）。相反，`@permalink`可以让事情变得更加灵活。

如果您阅读[有关该主题的文档，](https://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs#get-absolute-url)您将了解它们之间的关系。装饰器挂钩到 django的URLconf 的后端，允许您使用[命名的 url 模式](https://docs.djangoproject.com/en/dev/topics/http/urls/#naming-url-patterns)`@permalink`编写更便携的代码。这比单独使用更可取：您的代码变得更加干燥，因为您不必指定路径。`get_absolute_url`

```
class BlogPost(models.Model):
    name = modelsCharField()
    slug = models.SlugField(...)

    @permalink
    def get_absolute_url(self):
        return ("blog-detail", [self.slug,]) 
```

并在 urls.py

```
 ...
    url(r'/blog/(?P<slug>[-w]+)/$', blog.views.blog_detail, name="blog-detail") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-08-13T21:13:38.477

> 在 Django 2.1 中删除了 django.db.models.permalink() 装饰器。

[来源](https://docs.djangoproject.com/en/2.2/releases/2.1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-05T16:04:18.803

更好的方法是在 urls.py 中为您的应用程序声明一个名称，然后引用它而不是硬编码任何内容：

在 urls.py 中：

```
app_name = 'my_app'

urlpatterns = [
    path('blogs/<int:slug>', blog.views.blog_detail, name='mymodel_detail'),
    ] 
```

在models.py中：

```
from django.urls import reverse

class BlogPost(models.Model):
    name = modelsCharField()
    slug = models.SlugField(...)

    def get_absolute_url(self):
        return ('my_app:mymodel_detail, args=[self.slug,]) 
```

# javascript - Slider displays CSS correctly on Chrome but not on Firefox &IE

> ID：13503649
> 
> 赞同：0
> 
> 时间：2012-11-21T23:20:21.010
> 
> 标签：javascript, jquery, html, css, firefox

I recently launched my new page but after doing some testing I found out that the Caption of the slider are not on the same position. I don't know whether it's the HTML or the CSS. Here's a screenshot of my problem:http://i.imgur.com/DoMf6.jpg and a link to my site [http://www.unscspartanteamomega.com/home](http://www.unscspartanteamomega.com/home). If anyone has an idea or any tips please let me know. Thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T05:22:49.817

我认为您的问题是您的字体不同。看起来您正在使用@font-face 字体，但它们在浏览器（IE，FF 的早期版本）中不起作用。

字体有不同的磅值。它们在两个浏览器中都位于相同的位置，但由于非@font-face 字体的磅值更大，它们相互叠加。

我建议定义一种与您的@font-face 字体的磅值更相似的字体作为下一个降级。

在您的 CSS 规则中，

**字体：fontfacefont，投石机**

确保第二种字体的磅值与@font-face 字体相似。

# android - 关于重命名 Android 项目的 gen 文件夹中的包的一些问题

> ID：13503650
> 
> 赞同：1
> 
> 时间：2012-11-21T23:20:29.323
> 
> 标签：android, eclipse

我从网上下载了一个项目，想重命名这个项目中的所有类。但是，gen 文件夹中有问题。我无法重命名 gen 文件夹中的类。无论我尽力改变它，我都能找到原因。请帮我整理一下，谢谢。

![重命名 gen 文件夹中的包](../Images/826cd874703bdac6ce190191a2e2952d.png)

![改名](../Images/2573d0ec2509e5bb125a786c416367ce.png)

![有错误](../Images/e0aa717aa331347ff2fcaee1b1254e3c.png)

![重命名完成，但旧名称仍然存在](../Images/66f56efb18f7de682c19eed40501ffe9.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T23:30:19.757

您应该首先在 AndroidManifest.xml 中重命名包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:34:12.803

重命名你的包。为了让 Eclipse 注意到这一点，最简单的方法是在 Package Explorer 中的项目名称上按鼠标右键，然后选择`Android Tools`then `Rename Application Package`。如果出现问题，您可以删除 gen 的所有内容，执行“Project”->“Clean”并尝试重建。

# javascript - 在javascript中通过引用返回对象的成员

> ID：13503653
> 
> 赞同：2
> 
> 时间：2012-11-21T23:20:43.670
> 
> 标签：javascript

我有一个可变的 json 对象（可能有无限的子结构）：

```
var myObject={
    s1:{
        s2:'2',
        s3:'3'
    },
    s4:'4',
    s5:{
        s6:undefined
    },
    s7:'7'
}; 
```

我想找到第一个未定义的成员并返回它的引用，以便能够随时修改它（通过事件触发函数）

```
function findFirstUndefined(obj){
    for (var key in obj){
        if (typeof(obj[key]) === 'object'){
            var recursion=findFirstUndefined(obj[key])
            if (recursion!==false){
                return recursion;
            }       
        }
        else if (obj[key]===undefined){
            return obj[key];
        }   
    }
    return false; 
} 
```

但它不返回成员的引用，但它的值：

```
var subObj=findFirstUndefined(myObject);
subObj="my updated cool var!!"; 
```

不修改对象。

我发现像[JsonPath](http://goessner.net/articles/JsonPath/ "JsonPath")这样的库可以做到这一点，但在我看来，对于这样一个简单的任务来说有点繁重。

难道不存在一种优雅的方式吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T23:24:19.433

JS 不这样做。您可以改为返回一个将分配给缺失条目的函数？

```
return function(v) { obj[key] = v; }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:23:55.060

在 JS 中，您无法手动控制是否传递了值或引用。

并且只有对象通过引用传递。

所以不幸的是你不能这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T16:23:06.010

正如您在评论中要求的那样，我将发布一种基于字符串路径获取/设置这些对象的方法。当然，您是否认为它太复杂取决于您，但就是这样。

```
function getValue(object, path) {
    value = object[path[0]];
    if (path.length > 1) {
        return getValue(value, path.slice(1, path.length))
    }
    return value;
}

function setValue(object, path, value) {
    if (path.length > 1) {
        setValue(object[path[0]], path.slice(1, path.length), value);
    }
    else {
        object[path[0]] = value
    }
} 
```

然后，您可以像这样使用它们：`getValue(myObject, ["s1", "s2"]);`/ `setValue(myObject, ["s1", "s2"], value);`。我还没有机会测试代码，但这种方法应该成立。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T23:25:37.733

如果您返回`obj[key]`，您显然会返回一个值，但尝试返回一个包含两个值的数组，`[obj, key]`并且您有一种引用该节点的方法。或者从您的递归函数中，您可以使用这些类型的对构建一个多维数组以供以后使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-25T11:29:47.460

```
function findFirstUndefinedPath(obj){
    for (var key in obj){
        var path=[key];
        if (typeof(obj[key]) === 'object'){
            var subPath=findFirstUndefinedPath(obj[key]);
            if (subPath!==false){
                return path.concat(subPath);
            }       
        }
        else if (obj[key]===undefined){
            return path;
        }   
    }
    return false; 
} 
```

# vbscript - Create a folder based on user input vbscript

> ID：13503656
> 
> 赞同：1
> 
> 时间：2012-11-21T23:21:08.423
> 
> 标签：vbscript, inputbox

Sorry very new to all of this. I am currently trying to put together a basic script to create a folder based on use input. I can get to the point where the input can be done and the folder is created but not with inputbox data.

```
dim UserName

UserName = InputBox ("Please enter user name")

if Username = "" then
MsgBox("No username entered")

do while(UserName = "")
UserName = InputBox ("Please enter user name")
    if Username = "" then
    MsgBox("No Username entered")
    else
    MsgBox("Please click OK to continue")
    end if
Loop

else
MsgBox ("Please click ok to continue")

end if

Set objShell = CreateObject("Wscript.Shell")
objShell.Run "cmd /c mkdir c:\temp\UserName" 
```

As I said am very new to this so am open to any tips or pointers in the right direction.

Cheers in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-19T16:25:29.573

我不明白为什么人们把一切都搞得这么复杂。一个非常简单的脚本在这里：

```
*strfolder = InputBox("Please enter a name for your new folder:")
set objFSO = CreateObject("Scripting.FileSystemObject")
objFSO.CreateFolder "c:\" & strfolder* 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T04:36:25.217

为了让它工作，你所要做的就是把最后一行改成这样：

```
objShell.Run "cmd /c mkdir c:\temp\" & UserName 
```

这样，您可以使用值`UserName`而不是单词 UserName。

通过提示...

您的流程有点多余，您可以通过更新循环来做同样的事情。这是一种可能的路线：

```
dim UserName
Do
   UserName = InputBox ("Please enter user name")
   If UserName = "" then
      Msgbox "No Username entered"
   end if
Loop Until UserName <> ""

MsgBox "Please click OK to continue"

Set objShell = CreateObject("Wscript.Shell")
objShell.Run "cmd /c mkdir c:\temp\" & UserName 
```

`UserName = ""`此外，如果单击取消`""`是 InputBox 的返回值，最好只结束脚本。

# python - 在pygame中更改颜色时出现TypeError

> ID：13503659
> 
> 赞同：0
> 
> 时间：2012-11-21T23:21:22.897
> 
> 标签：python, pygame, typeerror

所以我在 pygame 中试验并为一个慢慢改变颜色的矩形写了一些代码

```
a = 4
b = 3
c = 2

#some irrelevant code later

    if color[0]+a < 255:
        color[0] += a
    else:
        a *= -1
    if color[1]+b < 255:
        color[1] += b
    else:
        b *= -1
    if color[2]+c < 255:
        color[2] += c
    else:
        c *= -1 
```

a、b 和 c 作为红色、绿色和蓝色的变化速度。

问题是由于某种原因，它会在程序运行几秒钟后给我一个 TypeError: Invalid color 参数，通常是在颜色很蓝的时候。我看不出出现无效颜色参数的任何原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:34:15.157

我希望 a`ValueError`而不是 a `TypeError`，但看起来正在发生的事情是，如果我们采取`a = 4`并与之合作`color[0]`

*   `color[0]`== 250，因此更改为`254`
*   `color[0]`== 254，所以保持不变，`a`更改为`-4`
*   `color[0]`== 254，因此更改为`250`
*   ...不断减`4`...

而且我不确定 -4 是一种有效的颜色......

**也许看看使用**

```
>>> from itertools import izip, cycle
>>> a = range(0, 20, 4) + range(20, 0, -4)
>>> b = range(0, 20, 3) + range(20, 0, -3)
>>> c = range(0, 20, 2) + range(20, 0, -2)
>>> test = izip(cycle(a), cycle(b), cycle(c))
>>> for i in range(30):
    print next(test)

(0, 0, 0)
(4, 3, 2)
(8, 6, 4)
(12, 9, 6)
(16, 12, 8)
(20, 15, 10)
(16, 18, 12)
(12, 20, 14)
(8, 17, 16)
(4, 14, 18)
(0, 11, 20)
(4, 8, 18)
(8, 5, 16)
(12, 2, 14)
(16, 0, 12)
(20, 3, 10)
(16, 6, 8)
(12, 9, 6)
(8, 12, 4)
(4, 15, 2)
(0, 18, 0)
(4, 20, 2)
(8, 17, 4)
(12, 14, 6)
(16, 11, 8)
(20, 8, 10)
(16, 5, 12)
(12, 2, 14)
(8, 0, 16)
(4, 3, 18) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:34:07.333

你最终会得到 -ve 颜色。如果颜色太高，您可以反转方向，但如果颜色太低，则不会。检查以确保它也大于 0。

```
if 0 < color[0]+a < 255:
    color[0] += a
else:
    a *= -1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:35:00.477

由于您收到 TypeError，代码中的其他地方（可能远离`TypeError`实际发生的位置！），您正在重新定义`color`. 例如，像

```
color = 'blue' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T00:36:01.843

有一个[颜色类](http://www.pygame.org/docs/ref/color.html)

```
from pygame.locals import Color

def color_rand(c):
    try:
        c.r += random.randint(0,10)
    except ValueError:
        c.r = 0

bg = Color(0,0,0)
bg = color_rand(bg) 
```

# python - Python NLTK NGrams Error

> ID：13503660
> 
> 赞同：1
> 
> 时间：2012-11-21T23:21:26.167
> 
> 标签：python, nltk, assertion, n-gram

I'm running a code to get the perplexity, number of ngrams from a text corpus. While doing it, I got a weird error saying:

```
C:\Users\Rosenkrantz\Documents\NetBeansProjects\JavaApplication2>python ai7.py
C:\Users\Rosenkrantz\Documents\NetBeansProjects\JavaApplication2>python ai7.py
47510
203044
308837
Traceback (most recent call last):
  File "ai7.py", line 95, in <module>
    tt=NgramModel(1, tText, estimator)
  File "C:\Python27\lib\site-packages\nltk\model\ngram.py", line 81, in __init__
    assert(isinstance(pad_left, bool))
AssertionError 
```

The Code I am Running to get this is:

```
f_in = open("science.txt", 'r');
ln = f_in.read()
words = nltk.word_tokenize(ln)
tText = Text(words)
tt=NgramModel(1, tText, estimator)
tt1=NgramModel(2, tText1, estimator)
tt2=NgramModel(3, tText2, estimator) 
```

All the imports seem to be proper.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:50:45.153

你确定你`NgramModel`用正确的论据打电话吗？查看[当前版本的 NLTK 的源代码](https://github.com/nltk/nltk/blob/master/nltk/model/ngram.py)，`NgramModel`如下所示：

```
def __init__(self, n, train, pad_left=True, pad_right=False,
                 estimator=None, *estimator_args, **estimator_kwargs): 
```

这似乎与您调用该函数的方式不匹配。你`estimator`的代码中有什么？因为您当前正在`estimator`作为`pad_left`参数传递。

# android - android httpClient and httpPost issue with specific website

> ID：13503661
> 
> 赞同：0
> 
> 时间：2012-11-21T23:21:30.443
> 
> 标签：android, cookies, http-post, httpclient, http-get

I am attempting to help a student write an android app that will contact a specific webserver. From the looks of the website, you can issue a GET requestion with your web browser and you get back a cookie session and an "authenticity token" (see the source of the page as an invisible input)

We issue a GET request and then want to follow it up with the post, but we are receiving a status code of 404 on the post. On a side note, the first GET request returns a code of 200\.

Does anyone have any ideas? Below is the code that gets executed...

```
public void run()
    {
        HttpClient httpClient = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet("https://co22.herokuapp.com/login/");
        HttpPost httpPost = new HttpPost("https://co22.herokuapp.com/login/sessions");
        HttpResponse response;

        try
        {
            response = httpClient.execute(httpGet);

            Log.d("matt",response.getStatusLine().toString());

            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(new BasicNameValuePair("session[network_id]", username));
            nameValuePairs.add(new BasicNameValuePair("session[password]", password));
            nameValuePairs.add(new BasicNameValuePair("authenticity_token","9yvxPOUpRFdsTeHAZtISEfBHpElDTHzvMjAbQnxOHDM="));
            httpPost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            response = httpClient.execute(httpPost);
            Log.d("matt",response.getStatusLine().toString());

        } 
        catch (ClientProtocolException e)
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
        catch (IOException e)
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:20:04.817

上面的内容似乎可以正常工作，但我们只是将第二个发布请求发送到了错误的网站。

# c - snprintf() does not work for modifying a string in-place

> ID：13503662
> 
> 赞同：2
> 
> 时间：2012-11-21T23:21:43.627
> 
> 标签：c, string, char, concatenation

```
char symbols[16] = "";
int index = 0;
while (1)
{
     if (index % 2)
         snprintf(symbols, sizeof symbols, "a%s", symbols);
     else
         snprintf(symbols, sizeof symbols, "b%s", symbols);

     index++;

     printf("%s\n", symbols);
} 
```

How output looks: a => bb => aaa => bbbb

I want the output looks: a => ba => aba => baba

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T23:24:24.500

这是未定义的行为。来自 C99 标准第*7.19.6.5 节的 snprintf 函数*：

> snprintf 函数等价于 fprintf，除了输出写入数组（由参数 s 指定）而不是流。如果 n 为零，则不写入任何内容，并且 s 可能是空指针。否则，第 n-1 个以外的输出字符将被丢弃，而不是写入数组，并且在实际写入数组的字符的末尾写入一个空字符。**如果复制发生在重叠的对象之间，则行为未定义。**

您需要制作一个副本以`symbols`用作`snprintf()`调用中的参数：

```
char symbols[16] = "";
char symbols_copy[16];
int index = 0;
while (index++ < 15)
{
     memcpy(symbols_copy, symbols, sizeof(symbols));

     if (index % 2)
         snprintf(symbols, sizeof symbols, "a%s", symbols_copy);
     else
         snprintf(symbols, sizeof symbols, "b%s", symbols_copy);

     printf("%s\n", symbols);
} 
```

请参阅演示[http://ideone.com/GvnW7D](http://ideone.com/GvnW7D)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:10:34.150

当然，它也可以在没有的情况下完成`snprintf`：

```
char symbols[16] = "";
for(int i=0; i<15; ++i) {
    memmove(&symbols[1], symbols, i);

    if (i % 2) {
        symbols[0] = 'a';
    } else {
        symbols[0] = 'b';
    }
    printf("%s\n", symbols);
} 
```

# javascript - Jquery Transit 不工作

> ID：13503665
> 
> 赞同：3
> 
> 时间：2012-11-21T23:21:59.290
> 
> 标签：javascript, jquery, jquery-animate, transition, jquery-transit

我一直在玩 jquery 插件 Jquery Transit：[http](http://ricostacruz.com/jquery.transit/) ://ricostacruz.com/jquery.transit/但无论我做什么，代码的行为都不像我期望的那样（事实上，它根本没有表现）

```
 <!DOCTYPE html>
<html>
<head>
  <style>
  div {
background-color:yellow;
width:100px;
border:1px solid blue;
position:absolute;
left:50px;
}

</style>
<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js'></script>
<script scr='jquery.transit.js'></script>
</head>

<title>test</title>
</head><body>
 <button id="go"> Run</button>
<div id="block">Hello!</div>

    <script>
$(function() {
    $("#go").click(
function(){
 $("#block").transition({ x: '90px' }, 1500 );
});
});
</script>
</body>
</html> 
```

代码根本不起作用。我添加了 jquery 动画代码来比较它，它工作得很好。现在我知道 jquery 1.8 破坏了 jquery transit，但我在这里使用 jquery 1.7，所以这不应该是一个问题。

我在这里不知所措，有人有任何想法吗？

编辑：

我已经按照每个人的指示创建了这个： [http](http://web.uvic.ca/~markkoni/) : //web.uvic.ca/~markkoni/ 虽然这些示例似乎对 jsfiddle 有效，但在实践中却行不通。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:28:02.977

工作演示（也在**本地主机**上测试）：http: [//jsfiddle.net/fedmich/S2ube/](http://jsfiddle.net/fedmich/S2ube/)

缩小的脚本似乎不起作用。更改您的代码

```
http://ricostacruz.com/jquery.transit/jquery.transit.min.js 
```

到

```
http://ricostacruz.com/jquery.transit/jquery.transit.js 
```

也不要直接把javascript热链接放到你自己的网站上，因为以后他的网站down了，你用他网站的js，你的web_app也会down。

是的，把你的代码放在页面加载之后

```
$(function() {
    //your code here
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:50:30.837

[通过将 DOM 封装在jQuery 就绪处理程序](http://api.jquery.com/ready/)中，确保在操作之前加载您的 DOM ：

```
$(function(){
    $('#go').click(function(){
        $("#block").transition({x: '90px'}, 1500);
    });
});​ 
```

此外，更喜欢使用 css`left`属性而不是`x`不存在的属性。

```
div {    
    background-color: yellow;
    width: 100px;
    border: 1px solid blue;
    position: absolute;
    left: 50px;
} 
```

这是[一个工作小提琴](http://jsfiddle.net/E9GdT/)

还要确保你的脚本标签看起来像这样：

```
<script type="text/javascript"> 
```

代替

```
<script> 
```

**备注：**

我在我的小提琴中使用[**jQuery 1.7.2**](http://code.jquery.com/jquery-1.7.2.min.js)，看来[transit 与transit.js 不兼容](https://github.com/rstacruz/jquery.transit/pull/77)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T10:34:09.107

Transit 支持 backgroundColor 和 color 属性。查看示例：http: [//jsfiddle.net/PAnCh/](http://jsfiddle.net/PAnCh/)

```
$(function() {
    $("#block").mouseenter(
    function(){
        $("#block").transition({ x: '+=90px', backgroundColor: '#cacaca', color: '#000' }, 1000 );
    });

    $("#block").mouseleave(
    function(){
         $("#block").transition({ x: '-=90px', backgroundColor: '#036', color: '#fff'  }, 500 );
    });
}); 
```

# sql - Ms-Access 表中最受欢迎的电影组合

> ID：13503667
> 
> 赞同：0
> 
> 时间：2012-11-21T23:22:22.753
> 
> 标签：sql, ms-access, database-design

表有两列。第一个是人名，第二个是电影名称。本质上，第一个表格描述了每个人最喜欢的电影。

我想在 MS-Access 中完成的是这个。生成 2 个电影标题的前 10 位组合，按学生数量排名，将这两个电影标题列为他们的最爱。

该表是“FavoriteMovies”第一列是学生姓名是“ProfileID”第二列是电影标题是“FavoriteMovie”

每个组合不能有同一部电影两次，对于每个组合顺序无关紧要，这意味着泰坦尼克号和教父 = 教父和泰坦尼克号

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:28:22.973

像这样的东西应该可以工作，尽管我没有访问权限来测试它：

```
Select Top 10
  fm1.FavoriteMovie As Movie1,
  fm2.FavoriteMovie As Movie2,
  Count(*) As TotalLikes
From
  FavoriteMovies fm1
    Inner Join
  FavoriteMovies fm2
    On fm1.ProfileID = fm2.ProfileID And
       fm1.FavoriteMovie < fm2.FavoriteMovie
Group By
  fm1.FavoriteMovie,
  fm2.FavoriteMovie
Order By
  3 Desc 
```

# winforms - Windows 窗体 Windows 8 主题

> ID：13503668
> 
> 赞同：3
> 
> 时间：2012-11-21T23:22:30.600
> 
> 标签：winforms, visual-studio-2012

如何为 windows 窗体应用 windows 8 主题？

![在此处输入图像描述](../Images/0467969fdf15ac65cc07d61209e665d5.png)

注意：我想要实现的是清楚地使用该样式，以便任何安装了 [with\without] windows 8 的用户都可以使用 windows 8 样式查看我的应用程序。{就像任何其他风格一样？]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:53:28.153

不知道您为什么要这样做，因为它会使您的 UI 与操作系统中的其他应用程序不一致 - 用户可能会不高兴。为了帮助您转换整个操作系统，互联网上提供了第 3 方主题。对于 Windows 7，有[一个 by deviantart](http://mare-m.deviantart.com/art/Windows-8-RTM-Theme-for-Windows-7-318932206)。或者试试[Windows 8 Transformation pack](http://www.thememypc.com/windows-8-transformation-pack-6-0/)，据说它甚至可以在 XP 上运行。

如果您想为您的特定应用程序设置样式，您可以使用 3rd 方 UI 组件，但它们都是付费的（据我所知）。例如，一些供应商是[Devexpress](http://www.devexpress.com/Subscriptions/DXperience/DXv2/index.xml?page=47)和[Telerik](http://www.telerik.com/products/windows-8/overview.aspx)。

# c++ - 大于 100,000 的随机数

> ID：13503671
> 
> 赞同：5
> 
> 时间：2012-11-21T23:22:54.323
> 
> 标签：c++, c, random, numbers

我正在用 C/C++ 编写，我想创建很多大于 100,000 的随机数。我会怎么做？和`rand();`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-21T23:27:01.723

你不会这样做`rand`，但是使用较新的 C++ 附带的适当的随机数生成器，请参见例如[cppreference.com](http://en.cppreference.com/w/cpp/numeric/random)。

```
const int min = 100000;
const int max = 1000000;
std::default_random_engine generator;
std::uniform_int_distribution<int> distribution(min,max);
int random_int = distribution(generator);  // generate random int flat in [min, max] 
```

不要忘记正确播种您的发电机。

上面我暗示这`rand`不是一个“正确的”伪RNG，因为它通常带有许多缺点。在最好的情况下，它缺乏抽象，因此从不同的分布中挑选变得困难且容易出错（在网上搜索“随机范围模数”）。同样，替换用于生成随机数的底层引擎也是 AFAIK 设计上不可能的。在不太理想的情况下`rand`，因为伪 RNG 不能为许多/大多数用例提供足够长的序列长度。使用 TR1/C++11 生成高质量的随机数很容易始终使用正确的解决方案，因此当出现模糊的错误时，无需首先担心使用的伪随机数发生器的质量。微软'

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T23:26:42.477

```
// Initialize rand()'s sequence. A typical seed value is the return value of time()
srand(someSeedValue);

//...

long range = 150000; // 100000 + range is the maximum value you allow
long number = 100000 + (rand() * range) / RAND_MAX; 
```

您可能需要使用大于 long int 的东西`range`，`number`如果`(100000 + range)`将超过其最大值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T23:29:07.883

通常，您可以使用介于 0 和 1 之间的随机数生成器，并通过执行以下转换获得所需的任何范围：

```
x' = r x + b 
```

因此，如果您想要介于 100,000 和 300,000 之间的随机数，并且`x`您的随机数介于 0 和 1 之间，那么您将设置`r`为 200,000 和`b`100,000，并且`x'`将在您想要的范围内。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T23:36:51.307

如果您还没有访问 C++ 内置函数，Boost 在[Boost.Random](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_random.html)中有一堆真正的随机化器，包括针对您明显问题空间的[特定解决方案。](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_random/tutorial.html#boost_random.tutorial.generating_integers_in_a_range)

我会回应评论，澄清您问题中的编辑将提高答案的准确性，例如。“我需要从 100,001 到 1,000,000 的均匀分布整数”。

# string - 如何将字符串与整数进行比较？

> ID：13503673
> 
> 赞同：2
> 
> 时间：2012-11-21T23:22:57.137
> 
> 标签：string, batch-file, comparison, integer

我有这个：

```
@echo off
setlocal ENABLEDELAYEDEXPANSION
set bla="-666"
set zzz="333"
if !zzz! LSS !bla! echo lesser
pause 
```

给我“更少”这是错误的。我知道这是因为 ASCII 值。但是有什么办法可以把它们当作数字来比较呢？

**编辑：**

还有一些代码：

```
set mn=99999
for /f "tokens=1-9" %%a in (%%g) do (
set zzz=%%d
)
if "!zzz!" LSS "!mn!" set mn=!zzz! 
```

到目前为止，以下答案都没有给我正确的结果......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:08:54.877

这对我有用

```
@echo off
set bla=-666
set zzz=333
if %zzz% LSS %bla% echo lesser
pause >nul 
```

无需报价或延迟扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:03:26.967

您在设置 var 时错误地使用了黑引号， VAR="CONTENT" 仅适用于特殊情况，但不是这种情况。

```
@echo off
set /A "bla=-666"
set /A "zzz=333"
if %zzz% LSS %bla% echo lesser
pause 
```

请注意，我使用黑引号括住变量，内容没有任何黑引号。

还要记住在比较数字时不要在比较中使用黑引号，如下所示：

```
if "%zzz%" LSS "%bla%" echo lesser 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T16:05:58.530

这对我有用，删除引号然后比较。

```
@echo off
setlocal ENABLEDELAYEDEXPANSION
set bla="-666"
set zzz="333"
for %%a in (!bla!) do set /a bla=%%~a+0
for %%a in (!zzz!) do set /a zzz=%%~a+0
echo !bla! !zzz!
if !bla! LSS !zzz! (
    echo lesser
) else (
    echo greater
)   
pause 
```

# .htaccess - URL 重写 - 隐藏部分 url

> ID：13503682
> 
> 赞同：0
> 
> 时间：2012-11-21T23:23:57.043
> 
> 标签：.htaccess, mod-rewrite

我有一个这样的网址：

```
http://xxxx.com/cms/
....
http://xxxx.com/cms/about-us/concept/
http://xxxx.com/cms/something/ 
```

我想要的是隐藏 url 的 cms 文件夹。

因此，当我输入 url 时， `http://xxxx.com/`我应该被重定向到，`http://xxxx.com/cms/`但`cms`应该不可见。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:44:34.057

.htaccess 文件

```
RewriteEngine on

RewriteCond %{HTTP_HOST} ^(www.)?example.com$

RewriteCond %{REQUEST_URI} !^/cms/

RewriteCond %{REQUEST_FILENAME} !-f

RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ /cms/$1

RewriteCond %{HTTP_HOST} ^(www.)?example.com$

RewriteRule ^(/)?$ cms/index.php [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:31:13.457

最好的方法是更改​​ apache 配置中的 DocumentRoot。在配置文件中，只需将“/cms”添加到 DocumentRoot= 值并重新启动 apache。

# c# - 取消装箱到更大的值类型

> ID：13503693
> 
> 赞同：2
> 
> 时间：2012-11-21T23:24:39.500
> 
> 标签：c#, .net, boxing, unboxing

以下代码导致`InvalidCastException`.

```
 object x = (short) 1;
  int y = (int) x; 
```

我知道我可以`x`先转换为 a`short`然后转换为 an `int`，尽管这不是一个选项，因为装箱值的类型是未知的（但它肯定小于 an `int`）。

取消装箱到大于装箱类型的类型时，如何解决异常？

**编辑：** 我通过使用`dynamic`类型解决了我的问题（具有所有性能影响）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T23:27:20.200

您[只能将对象拆箱为其确切类型](http://blogs.msdn.com/b/ericlippert/archive/2009/03/19/representation-and-identity.aspx)。

相反，您应该调用`Convert.ToInt32()`，它适用于任何数字类型。

# java - Google 的 Scala 性能基准

> ID：13503694
> 
> 赞同：8
> 
> 时间：2012-11-21T23:24:50.710
> 
> 标签：java, scala, benchmarking

去年，谷歌发布了一个比较 C++、Java、Scala 和 Go 的基准测试。 [http://readwrite.com/2011/06/06/cpp-go-java-scala-performance-benchmark](http://readwrite.com/2011/06/06/cpp-go-java-scala-performance-benchmark) 表中的结果对我来说看起来很可疑，所以我从[https://code.google.com/下载了代码p/multi-language-bench/source/checkout](https://code.google.com/p/multi-language-bench/source/checkout)并自己运行代码。奇怪的是，我得到了非常不同的数字。我没有以任何方式修改代码。刚刚编译并运行它。根据谷歌的运行时间（以秒为单位）是：

```
C++ - 23
Java 64bit - 134
Scala - 82 
```

但是在我的机器上我得到

```
C++ - 13
Java - 14
Scala - 17 
```

速度差异要小得多。现在我想知道，这仅仅是因为谷歌在去年改进了这些基准的代码吗？或者可能与 JVM 的改进有关？顺便提一句。我使用 Java 1.7.0 64 位、Scala 2.10.0-RC2 和带有 -O2 的 gcc 4.7.0

# jquery - 我在 jQuery 中的滑动导航 div 有问题

> ID：13503698
> 
> 赞同：0
> 
> 时间：2012-11-21T23:25:08.200
> 
> 标签：jquery, jquery-animate

几天前我刚开始学习 jQuery/javascript，我喜欢边做边学，我创建了这些用于导航的 div。起初它们看起来不错，但如果我继续四处导航，它们会在点击几下后出现故障。

```
var home=$(".navHome");
home.mouseover(function(){
  home.animate({
   left:'30px',
   top:'25px',
   opacity:'0.75',
   });
  });
home.mouseout(function(){
 home.animate({
  left:'25px',
  top:'25px',
  opacity:'1',
 });
});
home.mouseover(function(){
  home.addClass("orangeText");
});
home.mouseout(function(){
  home.removeClass("orangeText");
}); 
```

有没有办法简化它，让它更好地工作？此外，当我的鼠标快速在 div 上来回移动几次时，就像 div 开始来回痉挛一样。有没有办法放一些东西来防止这种事情发生？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:57:22.330

而不是`home.animate()`使用`home.stop().animate()`.

使用`stop()`可防止动画一个接一个地排队。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:02:15.047

如果 $.animate().stop() 仍在堆叠动画队列，则使用 $.css() 因为它的渲染速度大约快 10 倍

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T00:00:22.100

当您来回移动鼠标时，您正在排队其他动画。防止这种使用`stop()`方法

```
home.mouseover(function(){
  home.stop(true,true)animate({/* settings*/})
}) 
```

API 参考：[http ://api.jquery.com/stop/](http://api.jquery.com/stop/)

# git - git - 如何从 git merge --log 获取完整消息

> ID：13503703
> 
> 赞同：6
> 
> 时间：2012-11-21T23:25:45.777
> 
> 标签：git, git-merge

使用`git merge --log --no-ff --no-commit`or后`git merge --log --squash`，会创建一个长提交消息。

但是该消息`...`在最后被删除，并且没有列出所有提交。

我如何获得完整的消息？

我检查了文件，`.git/MERGE_HEAD`它还`.git/SQUASH_HEAD`包含一条短消息`...`

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-22T07:41:20.527

请注意，该`--log`选项实际上是`--log<=n>`（来自[`git merge`](http://git-scm.com/docs/git-merge)）：

除了分支名称之外，使用来自`<n>`正在合并的最多实际提交的单行描述填充日志消息。另请参阅[`git-fmt-merge-msg`](http://git-scm.com/docs/git-fmt-merge-msg.html)。

因此，通过为 指定一个大数字`n`，您应该会在合并日志消息中看到所有提交。
默认情况下，仅列出前 20 个提交。

配置设置`merge.log`也可用于指定该数字。

# jquery - 通过jquery删除最后一个类

> ID：13503707
> 
> 赞同：-4
> 
> 时间：2012-11-21T23:26:09.743
> 
> 标签：jquery, wordpress

好的，我让它变得简单，我有很多这样的代码：

```
<span class="baba">aaaa</span>
<span class="baba">aaaa</span>
<span class="baba">aaaa</span>
.
.
.
.
.
<span class="baba">aaaa</span> 
```

我只想使用 jquery 删除最后一个我该`<span class="baba">aaaa</span>` 怎么做

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:28:11.367

尝试：

```
$('span.st_facebook_buttons:last').remove(); 
```

# java - 在 for 循环中打印特殊字符而不是数字

> ID：13503708
> 
> 赞同：0
> 
> 时间：2012-11-21T23:26:41.120
> 
> 标签：java, loops, for-loop

这是程序正在打印的内容：

```
(0,0)(0,1)(0,2)
(1,0)(1,1)(1,2)
(2,0)(2,1)(2,2) 
```

我想要它做的是打印（*）代替（1,1）。我知道涉及 if 语句，但我很难弄清楚我应该提出的条件。

```
public class loops {

public static void main(String[] args)
{
    int i=1;
    for (int k = i-1; i< 4; i++)
    {
        int j =1;
        for (int l = j-1; j < 4; j++)
        {
            if (k ==i+1 && l == j+1) System.out.print("( * )");

            else System.out.print("("+k+","+l+")");
            l++;
        }
        System.out.println();
        k++;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:32:05.603

if 条件是其中的一部分，但你也使你的 for 循环复杂化，试试这个：

```
public class loops {
   public static void main(String[] args)
   {
     for (int k = 0; k<3; k++)
     {
       for (int j = 0; j<3; j++)
       {
         if (k ==1 && j == 1)
         {
           System.out.print("( * )");
         } else {
           System.out.print("("+k+","+j+")");
         }
       }
       System.out.println("");
     }
   }
 } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T23:58:20.247

您应该只验证两个值是否等于 1 然后打印 (*) ，否则结果

# twitter-bootstrap - Twitter Bootstrap modal - 加载“远程”内容

> ID：13503711
> 
> 赞同：5
> 
> 时间：2012-11-21T23:26:42.673
> 
> 标签：twitter-bootstrap, modal-dialog

我正在尝试加载“远程”内容，基本上是通过 HTTP 请求（在同一站点上）发送的信息。返回的内容本身会抛出以下信息：

```
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;    </button>
<h3>Change Your Password</h3>
</div>
<div class="modal-body">
<form>
    <fieldset>
        <label>Your current password</label>
        <input type="password" placeholder="password">
        <label>Confirm current password</label>
        <input type="text" placeholder="password">

        <button type="submit" class="btn">Submit</button>
    </fieldset>
</form>
</div>
<div class="modal-footer">
    <a href="#" class="btn btn-primary" data-dismiss="modal">Close</a>
</div> 
```

但是，对于显示远程内容的模态框，我相信我应该已经显示`modal-body`该类：

```
<div class="modal fade hide" id="ajax">
    <div class="modal-body">
        <p>body content to be replaced</p>
    </div>
</div> 
```

我该如何解决这个问题，并提供完整的模态 div 内容并使其正确显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T22:35:22.140

似乎您想用网页填充模态正文。`a`您可以使用标签并使用 data-target 属性调用模式：

`<a id="file_attach" data-toggle="modal" href="http://fiddle.jshell.net/jhfrench/6K8rD/show/" data-target="#utility" class="btn">Modal 1</a>`

[Twitter](http://twitter.github.com/bootstrap/javascript.html#modals)文档说明

> 如果提供了远程 url，内容将通过 jQuery 的 load 方法加载并注入到 .modal-body 中。如果您使用的是数据 api，您也可以使用 href 标签来指定远程源。

有关示例，请参阅[http://jsfiddle.net/jhfrench/qv5u5/ （有关如何在多个调用链接之间重用一个模式的详细信息，请参阅](http://jsfiddle.net/jhfrench/qv5u5/)[如何重用一个 Bootstrap 模态 div？](https://stackoverflow.com/questions/14045515/how-can-i-reuse-one-bootstrap-modal-div)）。

# google-search-appliance - 为什么在使用 Google Search Appliance 编制索引时，属性 google:mimetype 无法处理 Web 内容？

> ID：13503712
> 
> 赞同：0
> 
> 时间：2012-11-21T23:26:56.673
> 
> 标签：google-search-appliance

我正在尝试显示由 Google Search Appliance 索引的文档的 mimetype，并且正在使用[https://developers.google.com/search-appliance/documentation/connectors/200/connector_dev/cdg_traversing](https://developers.google.com/search-appliance/documentation/connectors/200/connector_dev/cdg_traversing)`google:mimetype`中记录的属性。然而，我使用它的上下文是显示由 web 服务器提供的文档/文件的 mimetype，例如从 web 服务器提供的 PDF 文件，它似乎不起作用，即它不显示 mimetype查看元数据属性。

该属性`google:mimetye`是否可以与来自 Web 服务器的内容一起使用，不限于文件共享等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-05T14:06:35.017

由于您正在提供然后从 Web 服务器获取的内容。GSA 忽略了您对 mimetype 的建议。

# actionscript-3 - 在我调用 FaceboookDesktop.logout 后，FaceboookDesktop 用户保持登录状态

> ID：13503718
> 
> 赞同：1
> 
> 时间：2012-11-21T23:27:56.890
> 
> 标签：actionscript-3, facebook-graph-api

和这个用户有同样的问题

[As3 图形 API 注销](https://stackoverflow.com/questions/4828072/as3-graph-api-logout)

和这个用户 [Facebook Kiosk 注销](https://stackoverflow.com/questions/11998580/facebook-kiosk-logout?rq=1)

将 AS3 FacebookDesktop SDK 用于基于 AIR 桌面的信息亭应用程序

[http://facebook-actionscript-api.googlecode.com/svn/release/current/docs/com/facebook/graph/FacebookDesktop.html](http://facebook-actionscript-api.googlecode.com/svn/release/current/docs/com/facebook/graph/FacebookDesktop.html)

我可以登录，上传成功。

另外当我打电话时

```
FacebookDesktop.logout(handleLogout, APP_ORIGIN) 
```

handleLogout 中返回的响应对象 = 成功

我还将 APP_ORIGIN 定义为 = 与我的 APP_ID 关联的相同 url。并设置 FacebookDesktop.manageSession = false

问题是用户在我上传后保持登录状态，我需要在每次上传后自动将其注销。

该解决方案建议通过 ACCESS TOKEN 定位 logout.php。

```
https://stackoverflow.com/questions/7771821/log-out-from-facebook 
```

但我没有访问令牌，只有用户 ID。

谁能推荐一个适用于 AIR 桌面应用程序的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T19:54:43.647

看到这个线程

[https://code.google.com/p/facebook-actionscript-api/issues/detail?id=206](https://code.google.com/p/facebook-actionscript-api/issues/detail?id=206)

> '我遇到了这个问题，我使用这个解决方法解决了，你必须下载 1.7 dist 的源代码。然后打开 FacebookDesktop.as 文件并寻找注销功能（不是静态的），然后找到值 'params.next = "http://static.ak.fbcdn.net/connect/xd_proxy.php#origin= "+(appOrigin?appOrigin:"")' 并将其更改为 'params.next = "http://www.facebook.com/"'。

# php - PHP抽象类获取子文件名？

> ID：13503722
> 
> 赞同：1
> 
> 时间：2012-11-21T23:28:09.317
> 
> 标签：php, class, abstract

在为我的 CMS 制作模块系统时，我偶然发现了一个我希望以更好的方式解决的问题（如果可能的话）。

我有一个抽象类（简化）：

```
 abstract class aModule {   
     function __construct() {
        include(dirname(__FILE__).'/resources/content.php');
    }
} 
```

当我实例化这个类的孩子时，我期望会发生什么，例如：

```
class SomeModule extends aModule {
}

$sm = new SomeModule(); 
```

是**FILE**常量是 SomeModule 类文件的位置，但它需要父类文件，当然包含不起作用。*注意：两个类文件都包含在外部 ModuleManager 引擎中，因此我无法使用 $_SERVER['SCRIPT_FILENAME']。

我以丑陋的方式解决了这个问题，我制作了这样的抽象类构造函数：

```
function __construct($fileLoc) {
    include(dirname($fileLoc).'/resources/content.php');
} 
```

因此，要使模块工作，我需要使其具有自己的构造函数：

```
function __construct() {
    parent::__construct(__FILE__);
} 
```

这迫使任何制作模块的人在他的模块类定义中包含这个确切的构造函数，据我所知，编程中的任何重复都是不好的。

**那么，有没有一种方法可以让我的抽象类知道子类文件的位置，或者这是唯一的方法吗？**

# php - PHP：调用另一个类的方法

> ID：13503734
> 
> 赞同：39
> 
> 时间：2012-11-21T23:29:00.430
> 
> 标签：php, oop

我仍在学习 OOP，所以这甚至可能是不可能的（尽管如果这样我会感到惊讶），我需要一些帮助来调用另一个类方法。

例如在`ClassA I`有这个方法：

```
function getName()
{
    return $this->name;
} 
```

现在从`ClassB`（不同的文件，但在同一个目录中），我想调用`ClassA`'s `getName()`，我该怎么做？我试着做一个，`include()`但这不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-11-21T23:33:25.590

```
//file1.php
<?php

class ClassA
{
   private $name = 'John';

   function getName()
   {
     return $this->name;
   }   
}
?>

//file2.php
<?php
   include ("file1.php");

   class ClassB
   {

     function __construct()
     {
     }

     function callA()
     {
       $classA = new ClassA();
       $name = $classA->getName();
       echo $name;    //Prints John
     }
   }

   $classb = new ClassB();
   $classb->callA();
?> 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-11-21T23:36:17.640

如果它们是单独的类，您可以执行以下操作：

```
class A
{
    private $name;

    public function __construct()
    {
        $this->name = 'Some Name';
    }

    public function getName()
    {
        return $this->name;
    }
}

class B
{
    private $a;

    public function __construct(A $a)
    {
        $this->a = $a;
    }

    function getNameOfA()
    {
        return $this->a->getName();
    }
}

$a = new A();
$b = new B($a);

$b->getNameOfA(); 
```

我在这个例子中所做的是首先创建一个新的`A`类实例。之后，我创建了一个新的`B`类实例，我将实例传递给`A`构造函数。现在`B`可以`A`使用`$this->a`.

另请注意，我没有在`A`类中实例化类，`B`因为这意味着我将这两个类紧密结合。这使得很难：

1.  单元测试你的`B`班级
2.  将课程换成`A`另一个课程

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-11-21T23:33:00.880

您需要在 ClassB 中有一个 ClassA 的实例，或者让 ClassB 继承 ClassA

```
class ClassA {
    public function getName() {
      echo $this->name;
    }
}

class ClassB extends ClassA {
    public function getName() {
      parent::getName();
    }
} 
```

如果没有继承或实例方法，您需要 ClassA 有一个静态方法

```
class ClassA {
  public static function getName() {
    echo "Rawkode";
  }
} 
```

--- 其他文件 ---

`echo ClassA::getName();`

如果您只是想从类的实例中调用该方法：

```
class ClassA {
  public function getName() {
    echo "Rawkode";
  }
} 
```

--- 其他文件 ---

```
$a = new ClassA();
echo $a->getName(); 
```

无论您选择哪种解决方案，`require 'ClassA.php`都需要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T23:42:03.587

文件 1

```
class ClassA {

    public $name = 'A';

    public function getName(){
        return $this->name;
    }

} 
```

文件 2

```
include("file1.php");
class ClassB {

    public $name = 'B';

    public function getName(){
        return $this->name;
    }

    public function callA(){
        $a = new ClassA();
        return $a->getName();
    }

    public static function callAStatic(){
        $a = new ClassA();
        return $a->getName();
    }

}

$b = new ClassB();
echo $b->callA();
echo $b->getName();
echo ClassB::callAStatic(); 
```

# javascript - 我的画布不是仅在我的服务器上绘制图像

> ID：13503735
> 
> 赞同：0
> 
> 时间：2012-11-21T23:29:03.300
> 
> 标签：javascript, canvas, drawimage

所以我正在做一个小项目，只是为了好玩，我学到了一些关于画布的东西，我写了一个脚本（现在已经不见了）只是在画布上画一个图像，它不起作用所以我删除了它。所以我去了 w3schools 并拿了他们的示例代码，它仍然无法正常工作。您可以在这里查看：http: [//zach.muny.us/widgets/onlineedit](http://zach.muny.us/widgets/onlineedit)我没有收到任何错误，什么也没有。只是希望有人知道修复oO

```
<!DOCTYPE html>
<html>
<body>

<p>Image to use:</p>
<img id="scream" src="http://www.w3schools.com/html/img_the_scream.jpg" alt="The     Scream" width="220" height="277"><p>Canvas:</p>
<canvas id="myCanvas" width="250" height="300" style="border:1px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.</canvas>

<script>

var c=document.getElementById("myCanvas");
var ctx=c.getContext("2d");
var img=document.getElementById("scream");
ctx.drawImage(img,10,10);

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:33:04.793

图片可能还没有加载，加载时使用图片的load事件来绘制图片

```
<script>

var c=document.getElementById("myCanvas");
var ctx=c.getContext("2d");
document.getElementById("scream").onload = function(){
   ctx.drawImage(this,10,10);
};

</script> 
```

[http://jsfiddle.net/mowglisanu/DxT4u/](http://jsfiddle.net/mowglisanu/DxT4u/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:31:59.723

您需要将其包装在`window.onload()`.

```
window.onload = function() {
    var c=document.getElementById("myCanvas");
    var ctx=c.getContext("2d");
    var img=document.getElementById("scream");
    ctx.drawImage(img,10,10);
} 
```

# java - 如何在 CXF、Spring 和 Jackson 中使用多个 JSON 提供程序

> ID：13503742
> 
> 赞同：3
> 
> 时间：2012-11-21T23:30:18.397
> 
> 标签：java, spring, cxf, jackson, jax-rs

**要求** 我正在构建一个 REST API。它有两个 REST 调用。调用 /format 根据提供的参数输出格式化的 JSON。具有相同参数的调用 /raw 应该输出带有原始值的 JSON（不带格式）。此处的格式将是特定于区域设置的，例如日期更改、显示正确的货币、十进制格式、时间格式等值。

**工具** Java、Tomcat、Spring、Apache CXF、JAX-RS 和 Jackson。

**实施** REST 服务已设置并且工作正常。那里没有问题。我编写了单独的自定义序列化程序，在其中我使用 NumberFormat、DateFormat、DecimalFormat 等提供所需的格式。我扩展了 Jackson 的 SimpleModule 以注册上面提到的所有自定义序列化程序。我正在使用两个单独的 ObjectMapper（FomatOM 和 RawOM）。FormatOM 为格式化的 JSON 输出注册自定义模块，RawOM 根据要求用于原始 JSON 输出。这两个对象映射器注册到两个不同的 JacksonJsonProviders 并在我的 spring 配置 xml 中声明为 bean。对于 /format，我使用带有自定义序列化程序的 FormatOM，在 /raw 中我使用 RawOM。

**问题** 它不像我预期的那样工作。我希望当我通过 /format 调用发出请求时，将使用 FormatOM 并使用 /raw RawOM。发生的情况是，无论我先拨打哪个电话，后续电话都将使用相同的 ObjectMapper。因此，如果第一个调用是 /raw；随后对 /format 或 /raw 的调用呈现原始 JSON 输出。Tomcat 重新启动后，如果第一次调用是 /format，那么随后对任一 API 调用的调用都会呈现格式化的 JSON 输出

**问题** 1\. 你们如何实现我对渲染格式化+原始 JSON 输出的要求？2\. 我的实现有什么问题？3\. 有什么想法、建议或批评吗？4\. 还有其他方式来获得基于请求的映射器吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T12:08:02.047

感谢您的回答 StaxMan。由于我使用的是 Spring，因此我决定注入 `JacksonJsonProvider`并`JacksonJsonProvider.setMapper(mapper)`设置每个请求的映射器。如果有人尝试过上述方法并遇到问题，请告诉我。如果我遇到任何问题，我会更新这个答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:58:19.193

一种解决方法是只使用 a `StreamingOutput`，并在其中捆绑特定`ObjectMapper`，直接使用它 ( `ObjectMapper.writeValue(output, value);`)

# linux - linux线程和进程之间的优先级

> ID：13503749
> 
> 赞同：0
> 
> 时间：2012-11-21T23:31:33.153
> 
> 标签：linux, multithreading, linux-kernel, scheduler

如果我有两个进程，每个线程的优先级如下：

```
Process 1 - SCHED_FIFO - prio  10
    thread1  -  SCHED_FIFO - prio  20 
Process 2 - SCHED_FIFO - prio  15 
    thread2  -  SCHED_FIFO - prio  19 
```

现在如果它们都准备好同时运行，会选择哪一个，是基于线程优先级还是进程优先级？
我相信 Linux 内核将线程视为进程，因此我希望线程 1 获得 CPU，尽管进程 2 的优先级高于线程 1 的父进程。

# bash - 在 bash 函数中定位 + grep 变量

> ID：13503750
> 
> 赞同：0
> 
> 时间：2012-11-21T23:31:38.540
> 
> 标签：bash, function, grep, zshrc

zsh：*4.3.17*
GNU bash：*4.2.24*
GNU grep：*2.10*

我想知道我在这`grep`部分做错了什么->为什么`grep`在文件中使用时不突出显示结果`.zshrc`，实际上它根本没有输出任何东西。
当不使用变量或 .rc 文件（在 cli 上测试 cmd）时，`grep`可以正常工作。

```
function seek() { clear; echo $1; locate -ie "$PWD${1}" | grep "${1}"; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:59:28.730

.rc 文件中的 $GREP_COLORS 设置是否足够早？此外，您可以尝试`grep --color=always`通过管道输出 grep 的输出。

# opencv - 在图像集上使用 FeatureDetector 的第二个变体

> ID：13503751
> 
> 赞同：0
> 
> 时间：2012-11-21T23:31:43.330
> 
> 标签：opencv, sift, feature-detection

我能够成功地将许多图像加载到一个向量中，`vector<Mat>`. 加载后的图像可以使用该`imread`功能显示。

问题是我想使用第二种变体对这组图像应用 SIFT，如文档中所述：

```
void FeatureDetector::detect(const vector<Mat>& images, vector<vector<KeyPoint>>& keypoints, const vector<Mat>& masks=vector<Mat>() ) const 
```

这会产生以下错误：

```
error C2664: 'void cv::FeatureDetector::detect(const cv::Mat &,std::vector<_Ty> &,const cv::Mat &) const' : cannot convert parameter 1 from 'std::vector<_Ty>' to 'const cv::Mat &' 
```

我正在使用的代码：

```
vector<Mat> images;

/* code to add all images to vector not shown as its messy but it was performed with FindFirstFile of windows.h. All images loaded correctly as they can be read by imread*/

initModule_nonfree();

Ptr<FeatureDetector> get_keypoints = FeatureDetector::create("SIFT");
vector<KeyPoint> keypoints;
get_keypoints->detect(images , keypoints); 
```

检测到错误`get_keypoints->detect(images , keypoints);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T15:43:44.600

从`detect`签名来看，`keypoints`应该是`vector<vector<KeyPoint>>`，但您将其声明为`vector<KeyPoint>`。

# linux - 如果未指定文件，为什么 grep 不起作用？

> ID：13503753
> 
> 赞同：3
> 
> 时间：2012-11-21T23:31:49.930
> 
> 标签：linux, bash, shell, ubuntu, grep

我的 Linux grep 命令有问题，它不起作用！！！

我正在我的 Ubuntu 系统上尝试以下测试：

1.  我创建了以下文件夹：`/home/andrea/Scrivania/prova`

2.  在此文件夹中，我创建了一个名为 prova.txt 的 txt 文件，并在此文件中写入了字符串`test`并保存了它

3.  在 shell 中，我首先访问了该文件夹`/home/andrea/Scrivania/prova`，因此我以以下方式启动了 grep 命令：

    ```
    ~/Scrivania/prova$ grep test 
    ```

问题是光标继续不停地闪烁，找不到任何东西！为什么？问题是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T23:34:23.047

您没有提供文件供 grep 命令扫描

`grep "test" *`

或用于递归

`grep -r "test" *`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T23:34:18.023

因为如果没有给出文件，grep 会搜索标准输入。试试这个。

```
grep test * 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T23:36:42.257

您没有运行您正在寻找的命令。

`grep test *`将`test`在当前目录中的所有文件中查找。

`grep test prova.txt`会`test`专门找`prova.txt`

（字符串`grep test`会`grep`在中，直到 才会返回。）`test``stdin``EOF`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T23:35:02.547

你需要向 grep 输入一些东西——你不能只调用 grep test 而没有任何其他参数，因为它实际上什么也没做。尝试`grep test *`

grep 的另一个用途是通过管道输入命令

例如，这是我的主目录：

```
drwx------+  3 oliver  staff    102 12 Nov 21:57 Desktop
drwx------+ 10 oliver  staff    340 17 Nov 18:34 Documents
drwx------+ 17 oliver  staff    578 20 Nov 18:57 Downloads
drwx------@ 12 oliver  staff    408 13 Nov 20:53 Dropbox
drwx------@ 52 oliver  staff   1768 11 Nov 12:05 Library
drwx------+  3 oliver  staff    102 12 Nov 21:57 Movies
drwx------+  5 oliver  staff    170 17 Nov 10:40 Music
drwx------+  3 oliver  staff    102 20 Nov 19:17 Pictures
drwxr-xr-x+  4 oliver  staff    136 12 Nov 21:57 Public 
```

如果我跑

```
l | grep Do 
```

我得到结果

```
drwx------+ 10 oliver  staff    340 17 Nov 18:34 Documents
drwx------+ 17 oliver  staff    578 20 Nov 18:57 Downloads 
```

记得通过**管道**传递grep 命令

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T23:35:05.667

从 grep 手册页：

> Grep 搜索命名的输入文件（或标准输入，如果没有文件被命名，或文件名 - 给出）包含与给定 PATTERN 匹配的行。

如果您不提供文件名供它使用，它将尝试从标准输入读取。

尝试`grep test *`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-27T07:43:48.033

根据[**GNU Grep 3.0**](https://www.gnu.org/savannah-checkouts/gnu/grep/manual/grep.html)

> 一个名为的文件`-`代表标准输入。如果未指定输入，则 `grep`搜索工作目录（`.`如果给定指定递归的命令行选项）；否则，grep 搜索标准输入。

所以对于 OP 的命令，没有任何额外的规范，`grep`尝试在标准输入中搜索，而标准输入实际上并没有提供。

如上所述，一种简单的方法是`grep -r [pattern]`指定**递归**并`-r`在当前目录和子目录中搜索。

另请注意，通配符**`*`**仅包括文件，**而不包括目录**。如果使用，可能会显示提示提示：

> grep: [directory_name]: 是一个目录

# java - 如何在 HashMap 中移动值

> ID：13503755
> 
> 赞同：3
> 
> 时间：2012-11-21T23:31:58.027
> 
> 标签：java

我有课，比如说曲棍球。曲棍球类将设置曲棍球的分数，如下面的代码：

```
public class Hockey{
  private HashMap<String, Integer> hockeyScore;

  public Hockey(){
    hockeyScore = new HashMap<String, Integer>();
  }

  public void setHockeyScore(String clubName, int score){
    hockeyScore.put(clubName, score);  
  }
} 
```

一场曲棍球比赛只有两支球队和两个分数，可以交换分数吗？例如，当我们插入 hashmap 时，它会带有键和值......

> 团队'a' = 23
> 
> 团队'b' = 10

然后你交换哈希图中的值，看起来像......

> 团队'a' = 10
> 
> 团队'b' = 23

抱歉，我想知道是否有一种类似的方法可以交换分数，而无需手动使用“a”和“b”参考。就像一旦您将任何键和值插入哈希图中，此方法将交换值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T23:33:47.587

当然，您传统上交换值的方式：

```
Integer tmp = map.get(a);
map.put(a, map.get(b));
map.put(b, tmp); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:37:09.340

您可以使用此单线交换`Map`条目：

```
hockeyScore.put(a, hockeyScore.put(b, hockeyScore.get(a))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:38:24.500

I am having trouble imagining why you would want to do this, but it is only possible in the case of a Map with 2 entries--otherwise, swap is meaningless.

My Java is a bit rusty, and I am not going to pull out Eclipse just to check syntax but something quite similar to this should do the job for you:

```
Map<string, int> swapped(string key1, string key2, Map<string, int> m) {
    Map dummy = new HashMap<string, int>();

    dummy.put(key2, m.get(key1));
    dummy.put(key1, m.get(key2));

    return dummy;
} 
```

If you are more ambitious, you could iterate the entries to get the keys rather than having to have them available.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T23:46:36.043

```
Integer aScore = hockeyScore.get("a");
hockeyScore.put("a", map.get("b"));
hockeyScore.put("b", aScore); 
```

and the threadsafe variant

```
synchronized (hockeyScore) {
   Integer aScore = hockeyScore.get("a");
   hockeyScore.put("a", map.get("b"));
   hockeyScore.put("b", aScore);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T01:28:18.743

Thank you very much for your help!

I have figured out away to swap the values in the hashmap. First I collected the scores and put them into an arraylist and then i compared the arraylist to the hashmap and re set the hash map according the the arraylist.

```
public void swapScores(){ 
        for(Map.Entry<Team, Integer> getScores: winningTeam.entrySet()){
            if(scores.get(0).equals(getScores.getValue())){
                getScores.setValue(scores.get(1));
                System.out.println(getScores.getKey().getTeamName()+":"+getScores.getValue());
            }else if(scores.get(1).equals(getScores.getValue())){
                getScores.setValue(scores.get(0));
                System.out.println(getScores.getKey().getTeamName()+":"+getScores.getValue());
            }
        }

    } 
```

If there is a shorter way to do this please let me know.

Thank you again everyone!

# hadoop - MapReduce：使用 libjars 选项传递外部 jar 文件不起作用

> ID：13503762
> 
> 赞同：2
> 
> 时间：2012-11-21T23:32:25.340
> 
> 标签：hadoop

我的 map reduce 程序需要外部 jar 文件。我正在使用“-libjars”选项来提供那些外部 jar 文件 -

我使用了 hadoop 提供的 Tool、Configured 和 ToolRunner Utilities。

```
 public static void main(String[] args)throws Exception {
         int res = ToolRunner.run(newConfiguration(), new MapReduce(),args);
         System.exit(res);
  }

  @Override
  public int run(String[] args) throwsException {
         // Configuration processed by ToolRunner
   Configuration conf = getConf();
   Job job = new Job (conf, "MapReduce");
   ....
   } 
```

当我试图运行这项工作时 -

```
$ Hadoop jar myjob.jar jobClassName -libjars external.jar 
```

它引发了以下异常。

> 21 年 12 月 11 日 16:26:02 信息 mapred.JobClient：任务 ID：尝试_201211211620_0001_m_000000_1，状态：失败错误：java.lang.ClassNotFoundException：org.joda.time.format.DateTimeFormatterBuilder

我一直在尝试解决它一段时间。到目前为止似乎没有任何效果。我正在使用 CDH 4.1.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T23:38:04.453

似乎找不到 JodaTime。打开`/etc/hbase/hbase-env.sh`并将您的额外 jar 添加到`HADOOP_CLASSPATH`.

```
export HADOOP_CLASSPATH="<extra_entries>:$HADOOP_CLASSPATH" 
```

另一个效率较低且有时不可能的想法是将您需要的 jar 复制到`/usr/share/hadoop/lib`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:06:47.607

尝试使用 external.jar 的完全限定绝对文件名调用命令。还要确认缺少的类及其所有必备类都在 external.jar 中。

# javascript - javascript：弹出一个窗口并保存其html代码

> ID：13503763
> 
> 赞同：0
> 
> 时间：2012-11-21T23:32:31.503
> 
> 标签：javascript, popup

不确定这是否可能，但是......我可以从 one.html 弹出一个窗口（例如到 somesite.com/index.html）并将所有 HTML 保存在 one.html 的隐藏字段中吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:13:24.437

通过“弹出窗口”执行此操作将导致各种异常，因为浏览器具有针对跨域任何内容的规则。他们试图阻止诸如javascript之类的东西试图访问另一边的文档，有太多的黑客会去“哦，耶，另一个漏洞利用！”。

如果您正在寻找一种将 HTML 加载到页面元素中的方法，我建议您使用 AJAX。要使用浏览器的内置 ajax，可以使用 XMLHttpRequest 对象。其步骤是首先创建对象，然后告诉它您要获取什么以及如何获取，然后获取它，然后读取数据。

这是一个例子：

```
// Create the object
var xhr = new XMLHttpRequest();
// Open page
xhr.open( 'GET', '/index.html', true );
// Register your events
xhr.onsuccess = function() {
    // awesome, it loaded!
    destination.innerHTML = xhr.responseText;
};
xhr.onerror = function(e) {
   // the page denied my request because: e
};
// send any data if you want, or just execute the request
xhr.send( myData || null ); 
```

目的地将是这样的：

```
// jQuery version:
var destination = $( 'textarea#content-holder' );
// Equivalent to:
var destination = (function(tag, id) {
    var elms = document.getElementsByTagName(tag);
    for ( i = 0; i < elms.length; i++ ) {
        if ( elms[i].id === id ) return elms[i];
    }
    return undefined;
})('textarea', 'content-holder'); 
```

另一方面，一个很棒的支持 ajax 的库是 jQuery，你可以从[http://jquery.com/](http://jquery.com/)获得它。我推荐 ajax 的主要原因是它为不同类型的 ajax 请求提供了一些不同的 hack 和补丁，它非常简洁，您可以通过它避免很多痛苦。

要加载您正在尝试的内容，您的代码将如下所示：

```
$( destination ).load( '/index.html', function() {
    // do stuff after it's been loaded
); 
```

jQuery 将让您做的另一件非常酷的事情是从“index.html”加载页面的特定部分，即通过标准查询。例如，假设您只想从具有类“load-me”的元素加载标记，您应该这样做：

```
$( destination ).load( '/index.html .load-me', function() {
    // after load stuff
); 
```

完全绕过跨域限制的一种方法是使用 cURL，但这需要一些 PHP。这是一个简单的例子：

在 /ajax.php 中写：

```
<?php
    if ( ! $_POST['ajax'] ) die();

    // this doesn't consider errors
    $ch = curl_init();

    curl_setopt($ch, CURLOPT_URL, $_POST['url']);

    curl_exec($ch);
    curl_close($ch);
?> 
```

在你的 javascript 中写：

```
var xhr = new XMLHttpRequest();
// Open the script
xhr.open( 'POST', '/ajax.php', true);
// Register your events
xhr.onsuccess = function() {
    // awesome, it loaded!
    destination.innerHTML = xhr.responseText;
};
xhr.onerror = function(e) {
   // the page denied my request because: e
};
xhr.send( { 'ajax':'true', 'url':'http://somesite.com/index.html' } ); 
```

或者在 jQuery 中：

```
$( destination ).load( '/ajax.php', {ajax:true,url:'http://somesite.com/indexhtml'}, function() {
    // awesome, it loaded!
} ); 
```

需要考虑的事项： - 使用 AJAX，您仍然无法发出跨域请求，有办法，但没有完美的办法。（使用 XMLHttpRequest，您必须自己查找和编写 hack

*   如果没有 jQuery，将很难解析加载的数据。例如，如果你想抓住一个特定的元素，我希望你有疯狂的 RegExp 技能。

*   不同的浏览器有不同的ajax实现。在 IE 中，构造函数是 ActiveXObject.Create('XMLHttpRequest')。注意：所有这些都是 jQuery 的一部分。

希望你把事情弄清楚！XD

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:35:58.730

如果弹出窗口在同一个域中，您可以在弹出窗口中编写以下代码：

```
opener.document.getElementById('hidden').value = "the value you want"; 
```

# symfony - 创建一个动作 - Symfony2

> ID：13503770
> 
> 赞同：-2
> 
> 时间：2012-11-21T23:33:37.003
> 
> 标签：symfony

我创建了一个包后端/主/：

我的应用程序/routing.yml

```
backendmain:
    resource: "@backendmainBundle/Resources/config/routing.yml"
    prefix:   /main 
```

我的后端/Bundle/mainBundle/config/routing.yml：

```
backendmain_homepage:
    pattern:  /hello/{name}
    defaults: { _controller: backendmainBundle:Default:index } 
```

我的后端/Bundle/mainBundle/DefaultController.php：

```
namespace backend\Bundle\mainBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;

    class DefaultController extends Controller
    {
        public function indexAction($name)
        {
            return $this->render('backendmainBundle:Default:index.html.twig', array('name' => $name));
        }

            public function testAction($name)
        {
            return $this->render('backendmainBundle:Default:test.html.twig', array());
        }
    } 
```

如何在浏览器中调用动作测试？

抱歉，Fabien 在创建 Symfony2 时是否吸毒？Symfony 1.4 非常简单！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:41:35.077

测试操作的路由定义中没有任何匹配项。您添加的唯一路线是用于索引操作。所以你需要添加类似的东西，

```
backendmain_test:
    pattern:  /test
    defaults: { _controller: backendmainBundle:Default:test } 
```

在您的`backend/Bundle/mainBundle/config/routing.yml`文件中，以便您可以调用您的测试操作。

**更新：** 使用注释

**应用程序/配置/路由.yml**

```
backendmain:
    resource: "@backendmainBundle/Controller/DefaultController.php"
    prefix:   /main
    type:     annotation 
```

**DefaultController.php**

```
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
// ...

class DefaultController extends Controller
{
    /**
     * @Route("/test", name="backendmain_test")
     */
    public function testAction()
    {
        // ...
    }

    // ... 
```

# c++ - 非库类型的无序 key_type 需要 hash<> 特化？

> ID：13503773
> 
> 赞同：0
> 
> 时间：2012-11-21T23:33:53.687
> 
> 标签：c++, c++11, unordered-map, xerces-c

我正在尝试使用 xercesc::XMLUri 作为键类型创建一个 std::unordered_map。

```
#include <unordered_map>
#include "xercesc/util/XMLUri.hpp"

int main()
{
        std::unordered_map<xercesc::XMLUri,xercesc::XMLUri> uriMap;
} 
```

结果如下：

```
clang++ -std=c++11 -O0 -emit-llvm -g3 -Wall -c -fmessage-length=0 -I/usr/include ../xx.cpp 
In file included from ../xx.cpp:1:
In file included from /usr/bin/../lib/gcc/i686-linux-gnu/4.7/../../../../include/c++/4.7/unordered_map:43:
/usr/bin/../lib/gcc/i686-linux-gnu/4.7/../../../../include/c++/4.7/bits/functional_hash.h:59:7: error: static_assert failed "std::hash is not specialized for this type"
  static_assert(sizeof(_Tp) < 0,
  ^             ~~~~~~~~~~~~~~~
/usr/bin/../lib/gcc/i686-linux-gnu/4.7/../../../../include/c++/4.7/bits/unordered_map.h:45:32: note: in instantiation of template class 'std::hash<xercesc_3_1::XMLUri>' requested here
                       integral_constant<bool, !__is_final(_Hash)>,
                                                ^
/usr/bin/../lib/gcc/i686-linux-gnu/4.7/../../../../include/c++/4.7/bits/unordered_map.h:263:14: note: in instantiation of default argument for '__unordered_map<xercesc_3_1::XMLUri, xercesc_3_1::XMLUri, std::hash<xercesc_3_1::XMLUri>, std::equal_to<xercesc_3_1::XMLUri>, std::allocator<std::pair<const xercesc_3_1::XMLUri, xercesc_3_1::XMLUri> > >' required here
: public __unordered_map<_Key, _Tp, _Hash, _Pred, _Alloc>
         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
../xx.cpp:6:54: note: in instantiation of template class 'std::unordered_map<xercesc_3_1::XMLUri, xercesc_3_1::XMLUri, std::hash<xercesc_3_1::XMLUri>, std::equal_to<xercesc_3_1::XMLUri>, std::allocator<std::pair<const xercesc_3_1::XMLUri, xercesc_3_1::XMLUri> > >' requested here
    std::unordered_map<xercesc::XMLUri,xercesc::XMLUri> uriMap; 
```

我知道 C++0x 中的无序容器只`hash<>`为某些库类型提供专业化。如何创建所需的`hash<xercesc::XMLUri>`专业化`xercesc::XMLUri`？

编辑：我想出了这个。看起来合理吗？

```
#include "xercesc\util\XMLUri.hpp"
#include <string>

namespace std 
{

    size_t hash<xercesc::XMLUri>::operator()(const xercesc::XMLUri& uri) const
    {
        return hash<std::wstring>()(uri.getUriText());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:22:17.100

几乎。应该是这样的（感谢@jogojapan 指出缺少的类型定义！）：

```
#include <string>
#include <functional>

namespace std
{
    template <> struct hash<xercesc::XMLUri>
    {
        typedef size_t result_type;
        typedef xercesc::XMLUri argument_type;

        size_t operator()(xercesc::XMLUri const & uri) const noexcept
        {
            return hash<wstring>()(uri.getUriText());
        }
    };
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T00:24:58.347

`std::hash`是一个结构，你必须特化整个结构，而不仅仅是函数，那么你特化模板的方式也是错误的：

```
namespace std 
{
    template <>
    struct hash<xercesc::XMLUri>
    {
        size_t operator()(const xercesc::XMLUri& uri) const
        {
            return hash<std::wstring>()(uri.getUriText());
        }
    };
} 
```

# javascript - Backbone：（回调）函数甚至没有绑定到 Collection

> ID：13503774
> 
> 赞同：0
> 
> 时间：2012-11-21T23:33:54.250
> 
> 标签：javascript, backbone.js, underscore.js

我希望在 AJAX 调用成功时将 updatePlays 函数作为回调函数调用。我认为使用下划线绑定可以让我将“this”称为我真正想要更新的 Collection 对象，但我在这里遇到了麻烦。当我到达应该更新集合的函数时，它认为“this”指的是“window”。

在这种情况下，一个主干模型具有主干集合，它是由另一个主干模型组成的。

鉴于：

```
SomeView: Backbone.View.extend({
  someFunction: function(e) {
    var field = this
    this.picker = new PlayPicker({
      field:field,
      model: new PlaySet({
        plays: new Collections.Plays({}),
        slot: field.model
      })
    })
  }
}) 

PlayPicker:Backbone.View.extend({
 ...
  refresh: function () {
    this.model.update()
  },
.... 
```

作为模型 PlaySet 一部分的集合

```
Plays:Backbone.Collection.extend({
  model: Play ,
  initialize: function () {
    plays = this
    _.bind(this.updatePlays, plays) // Where I thought I should bind
  },
  updatePlays: function (plays) {
    new_plays = []

    var i; 
    for (i = 0; i < plays.length; i++){
      new_plays.push(new Play({
        id: plays[i]["id"],
        text: plays[i]["text"]
      }));
    }

    this.reset(new_plays) // Uncaught TypeError: Object [object Window] has no method 'reset' 
  }
}) 
```

模型玩具

```
PlaySet: Backbone.Model.extend({
  update: function() {
    this.get('slot').fetchAssociatedPlays(this.get('plays').updatePlays)
  },
}) 
```

模型插槽 - AJAX 调用

```
Slot:Backbone.Model.extend({

  ...

  fetchAssociatedPlays: function(update) {
    thisModel = this
    $.ajax({
      url: thisModel.associatedPlaysURL(),
      success: function (collection) {
        update(collection)
      }
    })
  }}) 
```

这是否可以通过下划线绑定来实现，正确的方法在哪里/如何？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T18:20:26.920

这个问题的答案帮助我解决了我的问题： [Binding a callback in Backbone.js and Underscore.js](https://stackoverflow.com/questions/9349666/binding-a-callback-in-backbone-js-and-underscore-js?rq=1)

```
callBack = _.bind(callBack, this); 
```

那是我需要使用一个函数，该函数是将第一个函数与某个对象绑定的结果。

# html - IE7 中的行内块元素之间没有空格

> ID：13503783
> 
> 赞同：2
> 
> 时间：2012-11-21T23:34:38.510
> 
> 标签：html, internet-explorer-7, css

[考虑以下代码：](http://jsfiddle.net/4twSs/)

HTML：

```
<div>Hello</div>
<div>Stack</div>
<div>Overflow</div> 
```

CSS：

```
div {
    display: inline-block;
    zoom: 1;
    *display: inline;
    background-color: #ccc;
} 
```

在 IE8 以及其他现代浏览器中，`div`s 之间有一个空格：

![在此处输入图像描述](../Images/2d971399eb9dcd6111e120117547b293.png)

但是，在 IE7 中，`div`s 是彼此相邻的。它们之间没有空间。

我怎样才能确保 IE7 有这个空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:47:45.080

您可以自己为 IE7 及更低版本添加空间：

```
div {
    display: inline-block;
    zoom: 1;
    *display: inline;
    *margin-right: 0.25em;
    background-color: #ccc;
} 
```

或者像这样：

```
div + div {
    *margin-left: 0.25em;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:39:49.390

以下是有关空格/内联块问题的一些背景：http: [//css-tricks.com/fighting-the-space-between-inline-block-elements/](http://css-tricks.com/fighting-the-space-between-inline-block-elements/)

因此，您可以实施其中一项修复（以删除空格），然后指定边距值。或者，您可以简单地将它们浮动并指定一个边距值：

```
div {
    background-color: #ccc;
    float: left;
    margin-right:5px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:47:56.610

IE7 仅部分支持 inline-block。基本上，IE6 和 IE7 仅在默认情况下显示“内联”的元素上支持内联块。

Divs 默认显示是块，所以 IE7 忽略你的内联块，只读取内联，因此没有空间问题。

`&nbsp;`要修复它，您可以尝试在元素之间添加不间断的空白`&nbsp;`（

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-12T23:14:52.593

似乎 IE7（及更早版本）会在“inline-block”元素之前插入一个空格（如果标记中有空格），如果它前面有一些文本（一个不间断的空格可以），并且会这样做*即使该文本有`display:none;`*（尽管它不会在“内联块”之后的任何文本之前插入空格）。

因此，将始终呈现跨浏览器的 OP 的解决方案是更改 HTML：

```
<div>Hello</div>
<!--[if lte IE 7]><span style='display:none;'>&nbsp;</span><![endif]-->
<div>Stack</div>
<!--[if lte IE 7]><span style='display:none;'>&nbsp;</span><![endif]-->
<div>Overflow</div> 
```

# java - 与 Java Swing Timer 混淆

> ID：13503788
> 
> 赞同：1
> 
> 时间：2012-11-21T23:35:01.720
> 
> 标签：java, swing, user-interface, timer, jframe

我真的对 Java 摆动计时器感到困惑。它需要一个动作监听器吗？有人可以给我一个例子吗？谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T23:37:06.610

下面是一个使用示例[`javax.swing.Timer`](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)：

![在此处输入图像描述](../Images/7b3d03f297032cd825a829228fdeaebf.png)

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.Timer;

public class SimpleTimer extends JFrame
{
    private JLabel label;
    private Timer timer;
    private int counter = 10; // the duration
    private int delay = 1000; // every 1 second
    private static final long serialVersionUID = 1L;

    public SimpleTimer()
    {
        super("Simple Timer");
        setDefaultCloseOperation(EXIT_ON_CLOSE);

        label = new JLabel("Wait for " + counter + " sec", JLabel.CENTER);
        JPanel contentPane = (JPanel) getContentPane();
        contentPane.add(label, BorderLayout.CENTER);
        contentPane.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
        pack();

        ActionListener action = new ActionListener()
        {   
            @Override
            public void actionPerformed(ActionEvent event)
            {
                if(counter == 0)
                {
                    timer.stop();
                    label.setText("The time is up!");
                }
                else
                {
                    label.setText("Wait for " + counter + " sec");
                    counter--;
                }
            }
        };

        timer = new Timer(delay, action);
        timer.setInitialDelay(0);
        timer.start();

        setVisible(true);
    }

    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                new SimpleTimer();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T23:38:37.627

设置计时器包括创建一个**Timer 对象**，在其上**注册一个或多个动作侦听**器，并使用 start 方法启动计时器。例如，以下代码创建并启动一个计时器，该计时器每秒触发一次动作事件（由 Timer 构造函数的第一个参数指定）。Timer 构造函数的第二个参数指定一个监听器来接收定时器的动作事件。**计时器是通过指定延迟参数和 ActionListener 来构造的**。（[来源](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)）

此外，计时器的计时是在与事件调度线程（或 EDT）不同的线程中完成的，后者是运行 ActionListener 中的代码的线程。因此，即使 actionPerformed 代码很慢，计时器仍将继续触发，并将其 actionPerformed 代码排入事件队列中，这可能会被备份，事件线程将被阻塞，应用程序将无响应或响应不佳，取消销售您将[合并](http://docs.oracle.com/javase/7/docs/api/javax/swing/Timer.html#setCoalesce%28boolean%29)设置为`true`（[source](https://stackoverflow.com/questions/7814511/timer-actionlistener-operation-in-java)）。

这是一个很好的教程[如何使用摆动计时器](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)

# javascript - 如何获得打印预览（如图像预览）

> ID：13503791
> 
> 赞同：1
> 
> 时间：2012-11-21T23:35:10.327
> 
> 标签：javascript, ajax, firefox

已经尝试过 window.print() 和 document..print() 等，但没有得到预览。我不需要显示打印对话框（即选择打印机等）；但需要预览。像 Alt + F + V （浏览器的打印预览）。

# sql - 如何在 powershell v1.0 中使用 SQL cmdlet？

> ID：13503797
> 
> 赞同：0
> 
> 时间：2012-11-21T23:35:55.393
> 
> 标签：sql, powershell

我想通过 Powershell v1.0 cmdlet 使用 SQL INSERT/DELETE/...。我的机器无法升级到 powershell v2.0。

因此，有没有办法在 Powershell v1.0 上安装 sqlps ？或者我可以使用哪些 cmdlet 来操作 SQL 数据？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:03:25.253

Powershell V2 或 V3 中没有用于查询 SQL 的内置 cmdlet。SQL Server 2008 及更高版本中包含一个名为 invoke-sqlcmd 的 cmdlet。要使用 invoke-sqlcmd，您需要安装 SQL Server Management Studio，但是如果您只想执行查询，您可以轻松创建自己的 Powershell 函数。这是我称之为invoke-sqlcmd2的一个：http: [//poshcode.org/3448](http://poshcode.org/3448)

# php - 用于从数据库中搜索的搜索算法或工具

> ID：13503798
> 
> 赞同：0
> 
> 时间：2012-11-21T23:35:57.517
> 
> 标签：php, mysql, search, search-engine

我有这个数据库表：

```
Column       Type

source       text            
news_id      int(12)             
heading      text            
body         text        
source_url   tinytext
time         timestamp
news_pic     char(100) 
location     char(128)
tags         text
time_created timestamp
hits         int(10) 
```

现在我正在寻找一种算法或工具来在这个包含新闻数据的表中搜索关键字。关键字应在标题、正文、标签和新闻点击次数中搜索，以获得最佳结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:59:46.733

MySQL 已经内置了你需要的工具：全文搜索。我将假设您知道如何使用 PHP 与 MySQL 交互。如果没有，请先查看。反正 ...

1）为要搜索的字段添加全文索引：

```
alter table TABLE_NAME add fulltext(heading);
alter table TABLE_NAME add fulltext(body);
alter table TABLE_NAME add fulltext(tags); 
```

2）使用`match ... against`语句进行全文搜索：

```
select * from TABLE_NAME where match(heading, body, tags, hits) against ('SEARCH_STRING'); 
```

显然，在这些示例中，将您的表名称替换为 TABLE_NAME，并将搜索字符串替换为 SEARCH_STRING。

我不明白你为什么要搜索点击数，因为它只是一个整数。但是，您可以通过在查询中添加子句来按命中数*排序：*`order`

```
select * from TABLE_NAME where match(heading, body, tags, hits) against ('SEARCH_STRING') order by hits desc; 
```

# gradle - 如何在 Gradle 中为 Groovydoc 设置字符编码？

> ID：13503802
> 
> 赞同：2
> 
> 时间：2012-11-21T23:36:11.587
> 
> 标签：gradle, groovydoc

我有带有 UTF-8 编码的 Groovy 代码，并且需要生成的 Groovydoc HTML 才能使用相同的代码。但是如何在 Gradle 中配置呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T03:49:48.677

Groovydoc 工具以及 Gradle 的`Groovydoc`任务目前不支持`encoding`选项。`file.encoding`不过，为 Gradle JVM设置系统属性应该可以工作。您可以通过`GRADLE_OPTS`环境变量或添加`systemProp.file.encoding=utf-8`到`gradle.properties`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-27T15:44:08.607

令人惊讶的是，经过六年和很多 Gradle 版本，这个问题仍然存在 :)

当我将 Unicode 字符（即箭头）添加到我的 Groovydoc 概述文件并尝试在具有默认 Windows-1251 编码的机器上组装 Groovydoc 时，我遇到了这个问题。

从 Gradle 4.10.2 开始，可以通过其方法[`AntGroovydoc`](https://github.com/gradle/gradle/blob/master/subprojects/language-groovy/src/main/java/org/gradle/api/internal/tasks/AntGroovydoc.java)为任务提供自己的实现，从而为 Groovydoc 使用其他选项。但是由于这种方法被认为是内部的，所以它会是一个有点 hacky 的解决方案。此外，显然不是为扩展而设计的，它的子类化需要大量复制粘贴原始类。`groovydoc`[`setAntGroovydoc`](https://github.com/gradle/gradle/blob/master/subprojects/language-groovy/src/main/java/org/gradle/api/tasks/javadoc/Groovydoc.java#L190)`AntGroovydoc`

# android - Android - 如何为 Canvas 的单个元素而不是整个画布或视图设置动画？

> ID：13503804
> 
> 赞同：0
> 
> 时间：2012-11-21T23:36:14.430
> 
> 标签：android, canvas, jquery-animate, paint, alpha

我有一个自定义视图，其中包含使用 drawLine 函数绘制的两条线。我想为第二行的 alpha 设置动画，但每当我尝试为它设置动画时，整个画布都在动画。到目前为止，我试图找到任何东西，但没有得到任何运气。

任何帮助将非常感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:04:44.680

我会这样做：

1.  在您的自定义视图中实现 onDraw()
2.  不要在 onDraw() 中创建任何对象
3.  为您在 onDraw() 中使用的 alpha 字段提供公共 set 和 get 方法
4.  使用[ObjectAnimator](http://developer.android.com/reference/android/animation/ObjectAnimator.html)为自定义视图的 alpha 属性设置动画

可能也使用[它](http://developer.android.com/reference/android/view/View.html#invalidate%28int,%20int,%20int,%20int%29)而不是调用 invalidate() 来仅重绘画布的一部分。

# javascript - 从谷歌地图自定义标记打开媒体

> ID：13503806
> 
> 赞同：0
> 
> 时间：2012-11-21T23:36:23.340
> 
> 标签：javascript, android, google-maps, google-maps-markers

所以我正在开发一个自定义的谷歌地图旅游类型应用程序，我想知道当我点击谷歌地图标记中的链接时如何让媒体弹出。理想情况下，这就是我希望发生的事情： 1\. 用户点击标记，正常的白框就会出现，就像在真正的谷歌地图上一样。2\. 在那个文本框中，我想有一个按钮来启动我存储在某处 SQL 服务器上的媒体。该媒体可以是音频、图片或视频。

我到目前为止的代码如下。如果有人可以让我知道如何做到这一点，或者指出我正确的方向，那就太棒了！

谢谢

```
<!doctype  html>

<html>
<head>
    <title>HuskyWalk Application Demo</title>
    <meta name="viewport" conmtent="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
        <style>
            html, body, #mapcanvas {
                margin: 0;
                padding: 0;
                height: 98%;
                }
        </style>
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
         <script>
  var map;
  var iteCoords = new google.maps.LatLng(41.806501, -72.252769);
  //var mapCoords = new google.maps.LatLng(navigator.getCurrentPosition().coords.latitude, navigator.getCurrentPosition().coords.longitude);
  //var mapCoords = new navigator.getCurrentPosition().coords;

  function initialize() {
    //var position = new navigator.geolocation.getCurrentLocation(showPosition);
    var mapOptions = {
      zoom: 18,
      center: iteCoords,
      mapTypeId: google.maps.MapTypeId.HYBRID
        };
    map = new google.maps.Map(document.getElementById('mapcanvas'), mapOptions);
    google.maps.event.addListenerOnce(map, "bounds_changed", watchStart);
    var marker = createMarker();  //creates marker
    }

    function watchStart() {
        if (navigator.geolocation) {
        navigator.geolocation.watchPosition(showPosition);
        } else {
        alert("Geolocation is not supported by this browser.");
        }
    }

    function createMarker() {
        var marker = new google.maps.Marker({
            position: iteCoords,
            map: map,
            title: 'ITEB',
            });         
        google.maps.event.addListener(marker, "click", onMarker_clicked);
        return marker;
    }

    function onMarker_clicked() {
        alert(this.get('id'));
        }

</script>
</head>
<body onload="initialize()">
    <div id="mapcanvas"></div>
    <div>
        <p>Maps provided by Google Maps</p>
        </div>
    </body>
</html> 
```

我知道在 onMarker_Clicked() 方法中很可能需要一些东西，我只是不确定是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T01:05:04.157

您需要使用 InfoWindow 并从 click 事件处理程序中调用其 open() 方法。

另请参阅谷歌地图开发人员指南中的部分[https://developers.google.com/maps/documentation/javascript/overlays#InfoWindows](https://developers.google.com/maps/documentation/javascript/overlays#InfoWindows)

# c++ - C++头文件中的add方法出错

> ID：13503807
> 
> 赞同：0
> 
> 时间：2012-11-21T23:36:34.853
> 
> 标签：c++, vector, header, add

嘿，我在头文件（Inventory.h）中有一个向量以及头文件（Inventory.h）的cpp（Inventory.cpp）文件。如果不创建一个名为 add 的单独函数，我无法弄清楚如何使用 push 和 pop 函数，看起来像这样。

```
vector<string>s Inventory ::add(string item)
{
inventory.push_back(item);
return item;
} 
```

但这样做向我展示了一个错误：

```
Error   1   error C2511: 'void Inventory::add(std::string)' : overloaded member function not found in 'Inventory'   c:\users\conor\documents\college\dkit - year 2 - repeat\dkit - year 2 - semester 1 - repeat\games programming\maroonedca2\maroonedca2\inventory.cpp 19  1   MaroonedCA2 
```

这是我的 Inventory.h

```
#ifndef INVENTORY_H
#define INVENTORY_H

class Inventory
{
public:
    //Constructor
    Inventory();

    //Methods.
    string add();
    void displayInventory();
    void showInventory();
private:
    //Data members
    };

#endif //INVENTORY_H 
```

还有我的 Inventory.cpp。

```
#include "Inventory.h"
#include <iostream>
#include <vector>   //  To enable the use of the vector class.
#include <string>

using namespace std;
vector<string> inventory;
vector<string>::iterator myIterator;
vector<string>::const_iterator iter;

Inventory::Inventory()
{

}

vector<string>s Inventory ::add(string item)
{
inventory.push_back(item);
return item;
}

void Inventory:: showInventory()
{
char input[80];
    cin >> input;
    char inventoryRequest[] = "i";
    int invent = strcmp (input,inventoryRequest);
    //compare the player input to inventoryRequest (i) to see if they want to look at inventory.
    if(invent == 0)
    {
        displayInventory();
    }

}
void Inventory:: displayInventory()
{
//vector<string> inventory;
    cout<< "You have " << inventory.size() << " items.\n";
    cout << "\n******Inventory******";
    cout<< "\nYour items:\n";
    for (int i= 0; i< inventory.size(); ++i)
        cout<< inventory[i] << endl;
} 
```

如果我能获得有关此功能的帮助或在头文件中使用主文件中的推送/弹出的解决方案，将不胜感激。提前致谢。

编辑：新错误。

```
Error   1   error C2146: syntax error : missing ';' before identifier 'add' c:\users\conor\documents\college\dkit - year 2 - repeat\dkit - year 2 - semester 1 - repeat\games programming\maroonedca2\maroonedca2\inventory.h   17  1   MaroonedCA2
Error   2   error C4430: missing type specifier - int assumed. Note: C++ does not support default-int   c:\users\conor\documents\college\dkit - year 2 - repeat\dkit - year 2 - semester 1 - repeat\games programming\maroonedca2\maroonedca2\inventory.h   17  1   MaroonedCA2
Error   3   error C2061: syntax error : identifier 'string' c:\users\conor\documents\college\dkit - year 2 - repeat\dkit - year 2 - semester 1 - repeat\games programming\maroonedca2\maroonedca2\inventory.h   17  1   MaroonedCA2
Error   5   error C2146: syntax error : missing ';' before identifier 'add' c:\users\conor\documents\college\dkit - year 2 - repeat\dkit - year 2 - semester 1 - repeat\games programming\maroonedca2\maroonedca2\inventory.h   17  1   MaroonedCA2
Error   6   error C4430: missing type specifier - int assumed. Note: C++ does not support default-int   c:\users\conor\documents\college\dkit - year 2 - repeat\dkit - year 2 - semester 1 - repeat\games programming\maroonedca2\maroonedca2\inventory.h   17  1   MaroonedCA2
Error   7   error C2061: syntax error : identifier 'string' c:\users\conor\documents\college\dkit - year 2 - repeat\dkit - year 2 - semester 1 - repeat\games programming\maroonedca2\maroonedca2\inventory.h   17  1   MaroonedCA2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T23:42:41.423

您必须确保您的**.h**和**.cpp**方法匹配

**。H**

> `string add(string item);`

**.cpp**

> `string Inventory::add(string item)`

它说未找到重载函数，因为您试图调用未在标题中定义的函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T23:43:04.297

似乎声明`add()`及其实现使用了不同的签名：

```
class Inventory
{
public:
    // ...
    string add();
};

vector<string>s Inventory ::add(string item)
{
    // ...
} 
```

无论如何，额外的's'`vector<string>`似乎完全不合适。

# ssl-certificate - 远程托管子域的 SSL 证书

> ID：13503810
> 
> 赞同：0
> 
> 时间：2012-11-21T23:36:49.947
> 
> 标签：ssl-certificate

场景：假设 www.test.com 是一个存在的域，我想在我的网络服务器上处理对 widgets.test.com 的请求。我与他们的管理员合作并调整他们的 DNS 记录以将 widgets.test.com 指向我的网络服务器上的 IP 地址。

问题：如果我想处理该子域的 https 请求，是否需要为 widgets.test.com 购买 SSL 证书并安装在我的网络服务器上？或者，是否必须为顶级域购买证书并安装在主网络服务器上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:44:55.930

不必为主域购买它，您可以为特定的子域购买 SSL 证书。SSL 证书被键入到您指定的确切域，因此如果您为“https://*.mysite.com”购买一个证书，那么它与“https://mysite.com”的证书不同。

如果您想获得涵盖两者的 SSL 证书，您可能需要考虑购买通配符 SSL 证书之类的东西。

# math - 如何计算两个 AABB 之间的 Minkowski 差（没有向量数学）？

> ID：13503811
> 
> 赞同：10
> 
> 时间：2012-11-21T23:36:49.370
> 
> 标签：math, language-agnostic, geometry, collision-detection

我正在实现[我的碰撞检测库的第二个版本](https://github.com/kikito/bump.lua/tree/2.0)。这个特定的库应该处理轴对齐框（AABB）。我想开始在这个版本上跟踪快速移动的盒子。我认为计算两者之间的 Minkowski 差异将是一个很好的起点。

当我说 Minkowsky 差异时，我指的是[Collision detection for Dummies](http://www.wildbunny.co.uk/blog/2011/04/20/collision-detection-for-dummies/#attachment_485)中描述的几何操作。

问题是：那里描述的过程和算法非常通用。它使用相当先进的矢量数学来计算任何两个多边形的 MD。

就我而言，我有 AABB。鉴于它们的数值简单，该库到目前为止不需要向量概念 - 例如，我不需要计算单个点积。如果可能的话，我希望它保持这种状态。

所以我的问题是：

**给定两个 AABB 的顶部、左侧、宽度和高度（`{t1,l1,w1,h1}`和`{t2,l2,w2,h2}`），我如何计算它们的 MD（如果可能，不使用向量数学）？**

只需使用 Dummies 的碰撞检测小部件，我几乎可以肯定 MD 宽度将是一个宽度`w1+w2`和高度的框`h1+h2`。但我不知道如何计算它的上角或左角。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-22T08:34:58.883

两个轴对齐矩形 {t1, l1, w1, h1} 和 {t2, l2, w2, h2} 的 Minkowski 差异本身就是一个轴对齐矩形：

```
l = l1 - l2 - w2
t = t2 - t1 - h1
w = w1 + w2
h = h1 + h2 
```

以下是一个简短的 javascript 演示，用于展示这一点。您可以拖动两个矩形中的任何一个。重叠时它们会改变颜色

演示：http: [//jsbin.com/afojes/2/](http://jsbin.com/afojes/2/)

代码：http: [//jsbin.com/afojes/2/edit](http://jsbin.com/afojes/2/edit)

![无碰撞](../Images/69745e52b36abf280b3994f15e80b402.png)

![检测到碰撞](../Images/fe0c2a4f21cbcde80616541637e6a404.png)

# api - Azure Rest API 从队列中删除消息返回 403（在其他方法中工作正常）

> ID：13503813
> 
> 赞同：0
> 
> 时间：2012-11-21T23:36:57.020
> 
> 标签：api, rest, azure, queue, storage

我只为 API REST 编写了 4 种方法，但我需要的最后一种方法不起作用。这是删除消息队列。我有这个代码：

```
public static string DeleteMessage(String queueName, string account, byte[] key, string endpoint, string popreceipt,string messageid)
    {
        string requestMethod = "DELETE";

        String urlPath = String.Format("{0}/messages/{1}?popreceipt={2}", queueName,Uri.EscapeDataString(messageid),Uri.EscapeDataString(popreceipt));

        String storageServiceVersion = "2009-09-19";
        String dateInRfc1123Format = DateTime.UtcNow.ToString("R", CultureInfo.InvariantCulture);
        String canonicalizedHeaders = String.Format(
              "x-ms-date:{0}\nx-ms-version:{1}",
              dateInRfc1123Format,
              storageServiceVersion);
        String canonicalizedResource = String.Format("/{0}/{1}", account, urlPath);
        //String canonicalizedResource = String.Format("/{0}/{1}\npopreceipt:{2}", account, urlPath, popreceipt);
        String stringToSign = String.Format(
              "{0}\n\n\n\n\n\n\n\n\n\n\n\n{1}\n{2}",
              requestMethod,
              canonicalizedHeaders,
              canonicalizedResource);
        String authorizationHeader = CreateAuthorizationHeader(stringToSign, account, key);

        Uri uri = new Uri(endpoint + urlPath);
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);
        request.Method = requestMethod;
        request.Headers.Add("x-ms-date", dateInRfc1123Format);
        request.Headers.Add("x-ms-version", storageServiceVersion);
        request.Headers.Add("Authorization", authorizationHeader);

        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
        {
            Stream dataStream = response.GetResponseStream();

            return response.StatusCode.ToString();

        }
    }

    public static string GetMessage(String queueName,string account, byte[] key,string endpoint)
    {
        string requestMethod = "GET";

        String urlPath = String.Format("{0}/messages", queueName);

        String storageServiceVersion = "2009-09-19";
        String dateInRfc1123Format = DateTime.UtcNow.ToString("R", CultureInfo.InvariantCulture);
        String canonicalizedHeaders = String.Format(
              "x-ms-date:{0}\nx-ms-version:{1}",
              dateInRfc1123Format,
              storageServiceVersion );
        String canonicalizedResource = String.Format("/{0}/{1}", account, urlPath);
        String stringToSign = String.Format(
              "{0}\n\n\n\n\n\n\n\n\n\n\n\n{1}\n{2}",
              requestMethod,
              canonicalizedHeaders,
              canonicalizedResource);
        String authorizationHeader = CreateAuthorizationHeader(stringToSign,account,key);

        Uri uri = new Uri(endpoint + urlPath);
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);
        request.Method = requestMethod;
        request.Headers.Add("x-ms-date", dateInRfc1123Format);
        request.Headers.Add("x-ms-version", storageServiceVersion );
        request.Headers.Add("Authorization", authorizationHeader);
        request.Accept = "application/atom+xml,application/xml";

        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
        {
            Stream dataStream = response.GetResponseStream();
            using (StreamReader reader = new StreamReader(dataStream))
            {
                String responseFromServer = reader.ReadToEnd();

                return responseFromServer;
            }
        }
    } 
```

GetMessage 正常工作，而 DeleteMessage 不工作，CreateAuthorithation 标头代码为：

```
 private static String CreateAuthorizationHeader(String canonicalizedString, string account, byte[] key)
    {
        String signature = string.Empty;
        using (HMACSHA256 hmacSha256 = new HMACSHA256(key))
        {
            Byte[] dataToHmac = System.Text.Encoding.UTF8.GetBytes(canonicalizedString);
            signature = Convert.ToBase64String(hmacSha256.ComputeHash(dataToHmac));
        }

        String authorizationHeader = String.Format(
              CultureInfo.InvariantCulture,
              "{0} {1}:{2}",
              "SharedKey",
              account,
              signature);

        return authorizationHeader;
    } 
```

我使用“Convert.FromBase64String(AccountSharedKey)”传递密钥，该密钥适用于 GetMessage（以及另一种放置消息的方法），但这不适用于删除消息。

我看到 MSDN 中的 API 和 DELETE 和 GET 消息使用相同的参数，除了查询字符串传递的参数。

解决了

问题是我不使用 UriEscape 作为 Uri 字符串中的参数，有时 URL 有效，有时无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T03:58:09.300

我尝试了以下代码，它对我来说很好。我创建了一个队列，插入了一条消息并在其上执行了“GET”消息以获取弹出回执，然后删除了该消息。我在您的代码中修改的唯一内容是基于我上面的回答的 canonicalizedResource 字符串：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net;
using System.Web;
using System.IO;
using System.Security.Cryptography;
using System.Globalization;

namespace ConsoleApplication15
{
    class Program
    {
        static void Main(string[] args)
        {
            string messageId = "<message id e.g. ba9bdbe6-cd10-465d-ab32-90756ea0471d>";
            string queueName = "<queue name e.g. abc>";
            string accountName = "<your account name>";
            string accountKey = "<you account key base64 encoded string>";
            string endpoint = "http://accountname.queue.core.windows.net/";
            string popreceipt = "<pop receipt e.g. AgAAAAEAAAAAAAAACuMLtGTIzQE=>";

            var result = DeleteMessage(queueName, accountName, Convert.FromBase64String(accountKey), endpoint,
                popreceipt, messageId);
        }

        public static string DeleteMessage(String queueName, string account, byte[] key, string endpoint, string popreceipt, string messageid)
        {
            string requestMethod = "DELETE";

            String urlPath = String.Format("{0}/messages/{1}?popreceipt={2}", queueName, Uri.EscapeDataString(messageid), Uri.EscapeDataString(popreceipt));

            String storageServiceVersion = "2009-09-19";
            String dateInRfc1123Format = DateTime.UtcNow.ToString("R", CultureInfo.InvariantCulture);
            String canonicalizedHeaders = String.Format(
                  "x-ms-date:{0}\nx-ms-version:{1}",
                  dateInRfc1123Format,
                  storageServiceVersion);
            String canonicalizedResource = string.Format("/{0}/{1}/messages/{2}\npopreceipt:{3}", account, queueName, messageid, popreceipt);
            String stringToSign = String.Format(
                  "{0}\n\n\n\n\n\n\n\n\n\n\n\n{1}\n{2}",
                  requestMethod,
                  canonicalizedHeaders,
                  canonicalizedResource);
            String authorizationHeader = CreateAuthorizationHeader(stringToSign, account, key);

            Uri uri = new Uri(endpoint + urlPath);
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);
            request.Method = requestMethod;
            request.Headers.Add("x-ms-date", dateInRfc1123Format);
            request.Headers.Add("x-ms-version", storageServiceVersion);
            request.Headers.Add("Authorization", authorizationHeader);

            using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
            {
                Stream dataStream = response.GetResponseStream();

                return response.StatusCode.ToString();

            }
        }

        private static String CreateAuthorizationHeader(String canonicalizedString, string account, byte[] key)
        {
            String signature = string.Empty;
            using (HMACSHA256 hmacSha256 = new HMACSHA256(key))
            {
                Byte[] dataToHmac = System.Text.Encoding.UTF8.GetBytes(canonicalizedString);
                signature = Convert.ToBase64String(hmacSha256.ComputeHash(dataToHmac));
            }

            String authorizationHeader = String.Format(
                  CultureInfo.InvariantCulture,
                  "{0} {1}:{2}",
                  "SharedKey",
                  account,
                  signature);

            return authorizationHeader;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T02:03:41.813

我相信您构建“canonicalizedResource”字符串的方式存在问题。根据此处的文档：http: [//msdn.microsoft.com/en-us/library/windowsazure/dd179428.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/dd179428.aspx)（向下滚动到标题为“构造规范化资源字符串”的部分），您不应该传递查询字符串参数作为主要规范化资源字符串的一部分。它们应单独附加。

你能看看是否使用以下作品：

```
 string canonicalizedResource = string.Format("/{0}/{1}/messages/{2}\npopreceipt:{3}", account, queueName, messageid, popreceipt); 
```

希望这可以帮助。

# matlab - MATLAB：创建没有“side NaN”列的较小矩阵

> ID：13503819
> 
> 赞同：2
> 
> 时间：2012-11-21T23:37:33.630
> 
> 标签：matlab

我正在使用一个 30*26000 大小的矩阵，该矩阵的开头和结尾都有 NaN。NaN 也散布在每一行中。我可以用线性插值填充 NaN，但这会将 NaN 留在每行的开头和结尾。推断在末端替换这些 NaN 对我的数据集来说并不理想。

我只想修剪矩阵。以 3 x 6 矩阵为例：

```
NaN NaN 1 2  3  NaN
NaN  1  2 3 NaN NaN
 1  NaN 2 3  4   5 
```

切断最左边和最右边的列，使**任何**行都以 NaN 开头**或**结尾。

```
1 2
2 3
2 3 
```

所以我们留下了一个 3 x 2 矩阵。

我怎样才能在 Matlab 中做到这一点？（速度优化；我需要将其应用于一百万大小的矩阵）

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T23:46:17.947

对于您的示例，您可以执行以下操作：

让您的矩阵带有 NaN 和数值。

`ind1 = sum(isnan(a),1); % count the NaN values along columns`

`s = find(ind1 == 0, 1, 'first'); % find the first column without any NaN`

`e = find(ind1 == 0, 1, 'last'); % find the last column without any NaN`

所以现在只需将这部分矩阵从第 s 列保留到第 e 列：

b = a(:,s:e);

如果没有一列不包含 NaN，则可能需要进行额外检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T11:52:19.670

早期提出的两种解决方案都很棒，为了完整起见，我发布了这个单行：

```
A(:,isfinite(sum(A)))

ans =

 1     2
 2     3
 2     3 
```

它通过首先计算行总和然后调用`isfinite`. 我还删除了`find`调用 - 它们不是必需的，因为您可以使用逻辑索引。

我这里没有我的电脑，所以我省略了性能测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-22T02:01:14.807

首先，argyris 的矢量化解决方案可以很好地工作 (+1)。我发布这个只是因为你强调你想要一个速度优化的解决方案。好吧，argyris 解决方案的缺点是`sum`and`isnan`操作是在整个矩阵上执行的。如果您必须在任一侧走很长一段路才能找到第一个非 NaN 列，这将是最佳选择。但如果你不这样做呢？一个基于循环的解决方案利用您可能只需要进入几列这一事实可能会做得更好（特别是考虑到 JIT 加速器在快速执行单个循环方面有多好）。我整理了一个速度测试，其中包括 argyris 和我的解决方案：

```
%#Set up an example case using the matrix size you indicated in the question
T = 30;
N = 26000;
X = rand(T, N);
TrueL = 8;
TrueR = N - 8;
X(:, 1:TrueL) = NaN;
X(:, TrueR:end) = NaN;

%#argyris solution
tic
I1 = sum(isnan(X));
argL = find(I1 == 0, 1, 'first');
argR = find(I1 == 0, 1, 'last');
Soln1 = X(:, argL:argR);
toc

%#My loop based solution (faster if TrueL and TrueR are small)
tic
for n = 1:N
    if ~any(isnan(X(:, n)))
        break
    end
end
ColinL = n;
for n = N:-1:1
    if ~any(isnan(X(:, n)))
        break
    end
end
ColinR = n;
Soln2 = X(:, ColinL:ColinR);
toc 
```

在上面的例子中，解决方案需要去掉前 8 列和后 8 列。速度测试的结果？

```
Elapsed time is 0.002919 seconds. %#argyris solution
Elapsed time is 0.001007 seconds. %#My solution 
```

基于循环的解决方案几乎快 3 倍。好的，现在让我们将两边需要删除的列数增加到 100：

```
Elapsed time is 0.002769 seconds. %#argyris solution
Elapsed time is 0.001999 seconds. %#My solution 
```

还在前面。两边各有 1000 列呢？

```
Elapsed time is 0.003597 seconds. %#argyris solution
Elapsed time is 0.003719 seconds. %#My solution 
```

所以我们找到了我们的临界点（至少在我的机器上——四核 i7、Linux Mint v12、Matlab R2012b）。一旦我们需要在任一侧输入大约 1000 列，我们最好使用矢量化解决方案。

最后一点注意事项：如果例程发生在另一个（可能不相关的）循环中，则应重新进行速度比较。这是因为我的解决方案现在将涉及双循环。即使循环是不相关的，JIT 加速器对双循环也不是很好。我在我的机器上做了一些快速测试，对于小型 TrueL 和 TrueR（即小于 100），我的解决方案仍然领先，但优势不如没有外部循环时那么大。

无论如何，希望这对您或其他任何来阅读的人有用。

干杯!

**编辑：**我做了一些速度测试，结合了 angainor 非常简洁的单线 (+1)。当要删除的列数很少时，它的性能几乎与我的基于循环的解决方案一样好。令人惊讶的是，与 argyris 的解决方案不同，当要删除的列数很大时，它的扩展性并不好。不过，这可能与我现在使用的计算机有关：工作 Windows 机器 - 我从来没有真正完全信任它 :-)

# mongodb - MONGO 如何将 2 个地理字段转换为一个“数组”？

> ID：13503823
> 
> 赞同：0
> 
> 时间：2012-11-21T23:38:01.267
> 
> 标签：mongodb, collections

我有一个 mongodb 集合，其中包含数千条带有纬度和经度的“记录”，例如：

```
{ "_id" : ObjectId("50ad4f686579e337e1ec2294"), "place" : "Portugal", "lat" : 41.8343, "lon" : -8.3342 } 
```

如何更新所有集合“记录”以将 lat 和 lon 放入一个名为 location 的新字段中，如下所示：

```
{ "_id" : ObjectId("50ad4f686579e337e1ec2294"), "place" : "Portugal", "location": {"lat" : 41.8343, "lon" : -8.3342 } } 
```

问候假

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T02:28:22.757

基本上你不能只使用更新来做到这一点。

您必须遍历所有文档并就地更新：

```
db.coll.find().forEach(
  function (doc) {
    doc.location = { lat: doc.lat, lon: doc.lon };
    delete doc.lat;
    delete doc.lon;
    db.coll.save(doc);
  }
) 
```

另一种选择是以编程方式执行此操作。遍历每个文档。使用您选择的编程语言复制它并以您想要的方式更新每个文档

PS 当你请人帮忙时——确保你的起始代码没有错误。我花了很长时间才发现失踪“

# signalr - IConnectionIdFactory - v1 中有什么？

> ID：13503834
> 
> 赞同：0
> 
> 时间：2012-11-21T23:39:05.967
> 
> 标签：signalr

此合约在 v1 中不再可用。 [可扩展性](https://github.com/SignalR/SignalR/wiki/Extensibility)没有什么相似之处。 [客户端 - JavaScript 库，持久连接](https://github.com/SignalR/SignalR/wiki/SignalR-JS-Client)声称能够这样做，但此代码不起作用：

```
connection.id = 'id_set_by_client_side_code'; 
```

文档说：

> 获取或设置当前连接的客户端 ID。

有问题还是我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T07:03:00.807

您不再可以控制 SignalR 中的连接 ID。人们滥用它，试图通过使其稳定（这会导致错误行为）跨多个页面共享连接 ID。在 SignalR 1.0 中，连接 ID 始终是随机的。您唯一能做的就是添加前缀。

# jquery - 响应式选择菜单目标 _blank

> ID：13503839
> 
> 赞同：1
> 
> 时间：2012-11-21T23:40:04.923
> 
> 标签：jquery, html, responsive-design

嗨，我有一个有效的响应式选择菜单，我希望能够只制作一个链接目标 _blank

```
<select onchange="if (this.value) window.location.href = this.value;">

    <option value="" selected="selected">Navigation</option> 
    <option value="#">Home</option> 
    <option value="lessons/">Lessons</option> 
    <option value="locations/">Locations</option> 
    <option value="accomodation/">Accommodation</option> 
    <option value="holidays/">Holidays</option> 
    <option value="shop/">Shop</option> 
    <option value="contact/">Contact</option> 
    <option value="kite-jobs/">Jobs</option> 

</select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:35:13.267

```
<select>

    <option value="" selected="selected">Navigation</option> 
    <option value="#">Home</option> 
    <option value="lessons/">Lessons</option> 
    <option value="locations/">Locations</option> 
    <option value="accomodation/">Accommodation</option> 
    <option value="holidays/">Holidays</option> 
    <option value="shop/">Shop</option> 
    <option value="contact/">Contact</option> 
    <option value="kite-jobs/">Jobs</option> 

</select> 
```

```
$(function(){
    $('select').on('change', function() {  
      var url = this.value;  
      if(url == 'shop/' ){            // or whatever
        window.open(url, '_blank');
      }else{
        window.location.href = url;
      }    
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:50:43.987

`window.open()`在您想要的情况下使用：

```
<select onchange="if (this.value === 'accomodation') window.open(this.value, '_blank') else if (this.value) window.location.href = this.value;"> 
```

# vbscript - 如果条件不满足，退出/停止 VBscript 运行的代码是什么？

> ID：13503840
> 
> 赞同：8
> 
> 时间：2012-11-21T23:40:14.790
> 
> 标签：vbscript

我在谷歌上看过，没有答案！

第一件事。WScript.Quit 不起作用！我不知道“WScript”是什么，但它显然与网页的客户端脚本无关。我以前在某个地方看到过这个“WScript”的东西，它只会产生错误（可能已经过时或其他什么）所以请不要建议它......

无论如何......我想做的就是在不满足条件的情况下完全停止脚本。显然我不想要“退出子”，因为如果嵌入了该子，代码将继续运行！

我知道“停止”命令，但我的印象是它仅用于调试。

希望是一个非常简单的问题。

更新和结论：在我结束这个主题之前，我将稍微扩展一下我正在尝试做的事情......

我有许多通过按钮单击启动的主要潜艇。为了使我不必编辑每个单独的子，我在每个子中嵌入了一个通用子，并进行了初步检查。

初步检查的一部分是在用户输入不正确的情况下停止程序。如果检测到错误，我想从那时起停止所有进展。“退出子”显然会跳过该初步子的其余部分，而主子将继续执行。

最后，这只是写入错误标志（在主子程序中检查）或在每个主程序中合并错误条件操作的情况。这样你退出主子，问题就解决了。

这不是懒惰——我只是想减少代码量。无论如何，谢谢您的回复。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-22T06:26:15.260

我发现如果使用 wscript.exe 或 cscript.exe 引擎运行 .vbs/.vbe/.wsf 脚本，WScript 始终可用。当 WScript 不可用时，如果使用不同的引擎运行。例如，在 HTA、网页、VBA 中或从托管的 COM 脚本控件中运行 VBScript。

要退出未从 wscript.exe 或 cscript.exe 运行的脚本，您可以执行以下操作：

```
main

Sub main
    ' execute code here

    ' oops a confition is not met:
    If Not condition then Exit Sub

    ' more code to execute if condition was met
End Sub 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-29T17:47:40.470

你可以使用这样的东西：

```
Sub MyFunc
    ----------
    My Code
    ----------
End Sub

Function Main
  On Error Resume Next
  MyFunc
  If Err.Number <> 0
  Exit Function
End Function 
```

它将停止执行代码，它发现异常或抛出错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-04T22:50:14.227

*只有在 Windows 脚本宿主 (wscript.exe,cscript.exe) 中运行时，Wscript 对象才可用。不是 Internet Explorer（iexplorer.exe、mshta.exe）*

一个简单的方法是声明一个全局变量，该变量设置为 false 直到发生错误，如果发生错误，则该变量将设置为 true，之后任何时候检查该变量，您都可以退出 sub\function \for\do\whatever。

例子：

```
Dim ErrorOccured
On Error Resume Next
ErrorOccured=False

Sub Main()
    If ErrorOccured Then Exit Sub
    'some code
    MsgBox "Main has run"
End Sub

Sub MakeAnError
    If ErrorOccured Then Exit Sub
    'some code
    Err.Raise 2
    If Err Then ErrorOccured=True
End Sub

Function TellMeRandom
    If ErrorOccured Then Exit Function
    'some code
    Randomize
    TellMeRandom =Int((100- 1+ 1) * Rnd + 1)*1
End Function

Function ResetError
    ErrorOccured=False
End Function

Call Main                 'Main will run because an error has not occured (ErrorOccured is False)

MsgBox TellMeRandom       'This will return a random number 1-100

Call MakeAnError          'This will set the Global ErrorOccured to true

MsgBox TellMeRandom       'This will be blank because the ErrorOccured prevented it from running

Call Main                 'This will not run because the ErrorOccured prevented it from running

Call ResetError           'This will set the Global ErrorOccured to false

Call Main                 'This will run because ErrorOccured is back to False

MsgBox TellMeRandom       'This will return a random number 1-100 because ErrorOccured is back to false 
```

只需记住`If ErrorOccured then Exit Sub`为子例程或`If ErrorOccured then Exit Function`函数添加。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-07-17T10:06:48.273

最简单的方法，我发现的是：`WScript.Quit`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-15T00:38:26.243

您还可以引发错误，例如：`Err.Raise 507`

此错误将退出您当前的脚本：`"An exception occurred".`

# java - 将数组列表的所有元素添加到单个对象

> ID：13503841
> 
> 赞同：-1
> 
> 时间：2012-11-21T23:40:18.417
> 
> 标签：java, generics, arraylist

我想将 arraylist 的每个元素添加到单个对象中（具有通用基类型 T ）

我试图这样做，但是当我打印出作为对象的最终输出时，我只打印了 arraylist 的最后一个元素。

所以它遍历每个元素，但存储和打印最后一个。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:52:14.627

假设您的 T 不是聚合类型，则不可能将多个对象合二为一。

如果您的 T 是一个集合并且您想要折叠集合，您可以迭代每个源集合并将每个值添加到目标集合。

但是，在我看来，您真正追求的是对象的可打印视图。如果这是为了调试，我建议找到许多 JSON 支持库之一，并打印对象的 JSON 转换，这将是可读的。我推出了自己的，因为我必须支持 Domino API 类型，所以我不能推荐一个。

我最近一直在做太多的 C#，现在不能用流利的 Java 思考，但与此相近的东西（至少在精神上，如果不是语法或 API 细节）就是你所追求的：

```
StringBuffer b = new StringBuffer();
boolean first = true;

for (var t : collectionType) {
   if (first) {
      first = false;
   }
   else {
      b.add(", ");
   }

   b.add(t.toString());  
}

// Aggregated printable values are now b.toString() 
```

# php - 如何在数组中使用 if/else

> ID：13503842
> 
> 赞同：1
> 
> 时间：2012-11-21T23:40:25.967
> 
> 标签：php, arrays, if-statement

基本上我有一段相对复杂的代码，其中有几个相互嵌套的数组。我相信我想做的事情并不是严格可行的：

```
$selector = true,
 $main_array = array(
  'general' = array(
   'another_array' = array(
    'option1' = array(
     'title' = 'Some Title',
     'type' = 'select',
       if ($selector == true) {
    'option2' = array(
     'title' = 'Some title',
     'type' = 'select',
     } else
    ... 
```

我知道以上是不可能的。我知道我可以使用三元运算符，但是尝试时它不起作用。我知道有更好的方法来解决这个问题，但据我所知，所有这些都需要我改变我不想做的整个结构（因为有很多数组相互嵌套），所以我的问题是，有没有一种方法可以让我在不改变整个事情的情况下使这个有条件的工作？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:57:39.150

我假设您实际上并没有尝试将数组分配给字符串文字，因此明智地添加了一些“>”

是的，如果我了解您要查找的内容，则可以通过三元运算来完成，如下所示：

```
$main_array = array(
 'general' => array(
  'another_array' => array(
   'option1' => array(
    'title' => 'Some Title',
    'type' => 'select',
   'option2' => (($selector == true) ?
    array(
     'title' => 'Some title',
     'type' => 'select',
    ) : 'It was false'
 ))))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:42:52.763

你是对的：你想做的事情不可能按照你想做的方式去做。您将不得不重组您的代码。您可以将每个元素单独推送到数组中，`if`在必要时使用语句来确定推送的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:57:14.793

使用三元运算符。使用三元运算符，这：

```
if($selector == true){
    $foo = 'something'; 
} else {
    $foo = 'something else';
} 
```

可以变成这样：

```
$foo = ($selector == true) ? 'something' : 'something else'; 
```

您的示例代码如下所示：

```
$selector = true;    
$main_array = array(
    'general' => array(
         'another_array' => array(
              'option1' => array(
                    'title' => 'Some Title',
                    'type' => 'select',
                    'option2' => ($selector == true) ? array('title' = 'Some title','type' = 'select') : array('title' => 'Some other title', 'type' => 'Some other type')
                ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T00:47:47.583

好吧，如果您决定使用 if/else 而不是三元组，那么您可以早一点得出一些结果。

```
       if ($selector == true) {
    $preset2 = 数组（
     'title' = '一些标题',
     '类型' = '选择'
     );
    }
    别的
    {
     $preset2 = 数组（...）；
    }

 $main_array = 数组（
  '一般' = 数组（
   '另一个数组' = 数组（
    'option1' = 数组（
     'title' = '一些标题',
     “类型”=“选择”），
    'option2' = $preset2,
```

# iphone - CGContextFillPath 似乎没有循环工作

> ID：13503843
> 
> 赞同：0
> 
> 时间：2012-11-21T23:40:32.137
> 
> 标签：iphone, objective-c

这是基本的简化代码，无论我尝试过什么颜色都不会改变我单独尝试了 0、1、2，它可以工作并用正确的颜色填充路径，但在循环中颜色不会改变。

我试过： mutablepath ，保存/恢复上下文，运行干净，代码的一些排列，到目前为止没有太大的成功，它看起来非常简单，但看不到我缺少什么。

```
for(looper=0; looper<MAX ; looper++)
{ 
        CGContextSetFillColorWithColor(context, [[self setMyColor:lopper] CGColor]);

        [self draw_a_path:context ... more dimension args];

        CGContextClosePath(context);
        CGContextFillPath(context);
}

-(UIColor *) setMyColor:(int ) for_this_idx
{
UIColor *cur_color;

switch(for_this_idx)
{
    case 0: 
        cur_color = [UIColor colorWithRed: 0xdf/255.0 green: 0x01/255.0 blue: 0x01/255.0 alpha: 1.0] ;  
                    break;
      ... more cases ...
}
return cur_color;
}      

-(void) draw_a_path:(CGContextRef) thisContext
            ... position args ... 
{
... more stuff with Arcs but basically is this and each case works individually with the proper colour ....

CGContextMoveToPoint(thisContext, x_start,y_start);
CGContextAddLineToPoint(thisContext, x_start + n1), y_start + n2) );
CGContextAddLineToPoint(thisContext, x_start + n1 + p1), y_start + n2 + p2) );
CGContextAddLineToPoint(thisContext, x_start, y_start); 
```

...
}

# node.js - 在 Node.js / Express 中流式传输 / 管道化 JSON.stringify 输出

> ID：13503844
> 
> 赞同：13
> 
> 时间：2012-11-21T23:40:52.400
> 
> 标签：node.js

我有一个场景，我需要从我的 Node.js/Express RESTful API 返回一个非常大的对象，转换为 JSON 字符串。

```
res.end(JSON.stringify(obj)); 
```

但是，这似乎不能很好地扩展。具体来说，它在我的测试机器上运行良好，有 1-2 个客户端连接，但我怀疑当许多客户端同时请求大型 JSON 对象时，此操作可能会占用 CPU 和内存。

我一直在寻找一个异步 JSON 库，但[我发现的唯一一个](https://github.com/ckknight/async-json)似乎有问题（具体来说，我得到一个 [RangeError]）。不仅如此，它还以一大块的形式返回字符串（例如，对整个字符串调用一次回调，这意味着内存占用不会减少）。

我真正想要的是 JSON.stringify 函数的完全异步管道/流版本，这样它就可以在将数据直接打包到流中时写入数据......从而节省了我的内存占用，也避免了消耗 CPU一种同步方式。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-22T00:09:32.813

理想情况下，您应该按自己的方式流式传输数据，而不是将所有内容都缓冲到一个大对象中。如果你不能改变它，那么你需要将 stringify 分解成更小的单元，并允许主事件循环使用[setImmediate](http://nodejs.org/api/timers.html#timers_setimmediate_callback_arg)处理其他事件。示例代码（我假设主对象有很多顶级属性并使用它们来拆分工作）：

```
function sendObject(obj, stream) {
    var keys = Object.keys(obj);
    function sendSubObj() {
       setImmediate(function(){
          var key = keys.shift();
          stream.write('"' + key + '":' + JSON.stringify(obj[key]));
          if (keys.length > 0) {
            stream.write(',');
            sendSubObj();
          } else {
            stream.write('}');
          }
       });
    })
    stream.write('{');
    sendSubObj();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T23:59:40.057

听起来您想要 Dominic Tarr 的[JSONStream](https://github.com/dominictarr/JSONStream)。显然，将它与 express 合并需要一些程序集。

但是，如果您试图序列化（*Stringify*）对象的 CPU 最大化，那么将该工作分成块可能并不能真正解决问题。流式处理可能会减少内存占用，但不会减少所需的“工作”总量。

# grails - 使用 SpringSecurity 核心进行身份验证

> ID：13503846
> 
> 赞同：0
> 
> 时间：2012-11-21T23:41:01.083
> 
> 标签：grails, spring-security, grails-plugin

我需要帮助为我的公司集成系统。我们创建了一个数据库，将所有信息集中在一个身份验证服务器中。

对于身份验证，我们使用这样的内部 url：

```
http://autentication/ServletAutentication?login=XXXXXXXXXX&password=YYYYYYYYY 
```

其中 XXXXXXX 是 MD5 算法中的 YYYYYYYYY 用户名和加密密码。如何获取返回 XML：

```
<autentication>
            <login> XXXXXXXX </ login>
            <password> true </ password>
</autentication> 
```

需要进行身份验证。权限由 SpringSecurity Core 控制。

认证后，将在上次访问日期存储。

有谁知道我如何在 SpringSecurity Core 插件中实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T01:59:58.743

鉴于您不认为自己需要真正安全，您当然可以实现自己的非安全安全方案 - 只需创建一个控制器，在数据库中查找用户名和密码哈希，然后返回xml，在响应中添加会话 cookie 以跟踪登录状态。

另一方面，试图破解 Spring Security 以完全做它不应该做的事情可能不值得付出努力。

# iphone - 已选择自定义单元格

> ID：13503847
> 
> 赞同：1
> 
> 时间：2012-11-21T23:41:08.043
> 
> 标签：iphone, objective-c, ios

我正在绘制一个自定义单元格，以实现我想要的某种外观。但是，我想根据单元格是否被选中来执行不同的绘图。我真的不只是想要默认颜色。

我在此方法中更改了内容视图的背景颜色：

```
- (void)setSelected:(BOOL)selected animated:(BOOL)animated 
```

但是，它只是没有正确显示，主要是没有考虑到附件，只是在附件指示器之前对其进行了着色。有没有更好的方法来实现这一点？

```
- (void)drawRect:(CGRect)rect
{        
    CGContextRef context = UIGraphicsGetCurrentContext();

    // Background
    CGContextSetFillColorWithColor(context, CELL_BACKGROUND_COLOR);
    CGContextMoveToPoint(context, 0.0f, 0.0f);
    CGContextAddLineToPoint(context, rect.size.width, 0.0f);
    CGContextAddLineToPoint(context, rect.size.width, rect.size.height);
    CGContextAddLineToPoint(context, 0.0f, rect.size.height);
    CGContextClosePath(context);
    CGContextFillPath(context);

    // Top line
    CGContextSetStrokeColorWithColor(context, CELL_TOP_LINE_COLOR);
    CGContextSetLineWidth(context, CELL_LINE_WIDTH);
    CGContextSetLineCap(context, kCGLineCapSquare);
    CGContextMoveToPoint(context, 0.0f, 0.0f);
    CGContextAddLineToPoint(context, rect.size.width, 0.0f);
    CGContextStrokePath(context);

    //Bottom line
    CGContextSetStrokeColorWithColor(context, CELL_BOTTOM_LINE_COLOR);
    CGContextSetLineWidth(context, CELL_LINE_WIDTH);
    CGContextSetLineCap(context, kCGLineCapSquare);
    CGContextMoveToPoint(context, 0.0f, rect.size.height);
    CGContextAddLineToPoint(context, rect.size.width, rect.size.height);
    CGContextStrokePath(context);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:51:18.203

我认为您应该修改方法并根据属性`drawRect`更改颜色的设置方式。`isSelected`在 setSelected 方法时更改内容的视图背景可能不会更改任何内容，因为它将被该`drawRect`方法覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:06:04.373

我正在使用这个：

```
if(self.highlighted || self.selected) {
    //set text color
    textColor = [UIColor colorWithRed:204.0/255.0 green:255.0/255.0 blue:0 alpha:1.0];

    //set background color
    [[UIColor colorWithRed:0.0 green:0.0 blue:0.0 alpha:0.7] set];
    CGContextFillRect(context, r);
} 
```

还要检查`selectionStyle`你的单元格的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T01:22:32.677

我找到了一个效果很好的解决方案，它还在默认附件视图下方绘制，例如附件指示器。我创建了名为 BackgroundView 和 SelectedBackgroundView 的自定义视图，我只是使用 drawRect 方法来创建自定义绘图。它工作得很好，性能似乎还可以。如果有人想查看完整代码，请告诉我。

```
[cell setBackgroundView:[[BackgroundView alloc] init]];
[cell setSelectedBackgroundView:[[SelectedBackgroundView alloc] init]]; 
```

# r - 用密文替换字母

> ID：13503848
> 
> 赞同：4
> 
> 时间：2012-11-21T23:41:19.647
> 
> 标签：r

我一直在玩 R 的 gsub2 函数[R: replace characters using gsub, 如何创建函数？](https://stackoverflow.com/questions/6954017/r-replace-characters-using-gsub-how-to-create-a-function)创建密文：

```
from<-c('s','l','k','u','m','i','x','j','o','p','n','q','b','v','w','z','f','y','t','g','h','a','e','d','c','r')
  to<-c('z','e','b','r','a','s','c','d','f','g','h','i','j','k','l','m','n','o','p','q','t','u','v','w','x','y') 
```

例如：

> 原文：《谁是1973》
> 
> 密文：ptv ltn'm 1973

问题是，gsub2 替换了一些字母两次（o->f->n 和 s->z->n），这弄乱了我的密文并且几乎无法解码。谁能指出我犯的错误？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-22T00:06:36.430

一种方法是使用命名向量作为编码密码。创建此类命名向量的一种简单方法是使用`setNames`：

```
cipher <- setNames(to, from)
cipher
  s   l   k   u   m   i   x   j   o   p   n   q   b   v   w   z   f   y   t   g   h   a   e   d   c   r 
"z" "e" "b" "r" "a" "s" "c" "d" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "t" "u" "v" "w" "x" "y" 
```

对于编码功能，您可以使用`strsplit`and `paste`：

```
encode <- function(x){
  splitx <- strsplit(x, "")[[1]]
  xx <- cipher[splitx]
  xx[is.na(xx)] <- splitx[is.na(xx)]
  paste(xx, collapse="")
}

encode("the who's 1973")
[1] "ptv ltf'z 1973" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-22T00:52:24.897

您还可以使用`chartr`（流行：12 ups）对您引用的问题的回答中提到的方法：

```
cipher <- function(x) 
    chartr( "slkumixjopnqbvwzfytghaedcr", "zebrascdfghijklmnopqtuvwxy", x ) 
```

# pascal - WHMCS API addticketreply 不适用于消息

> ID：13503850
> 
> 赞同：0
> 
> 时间：2012-11-21T23:41:29.010
> 
> 标签：pascal, indy, whmcs

我已经尝试了所有我能想到的方法，并且无法将换行符与 WHMCS API 的 addticketreply 命令一起使用。它来自窗口的应用程序，而不是 PHP 或任何东西。简单查询字符串，所有字符都包含在第一个换行符之前。在该换行符之后，不包含任何其他消息。

我试过 urlencode 方法，不行，API 只是插入所有文本，包括编码部分哈哈，并没有取消编码。我试过用换行符代替`\n`，`<br>`但WHMCS仍然只显示`<br>`哈哈

任何线索如何通过 API 获取完整消息，包括新行？这个文档真的很缺乏。

此外，变量 adminusername 根本不起作用！我试过全名，不，我试过用户名和用户 ID，不，仍然插入我登录的用户名来回复票证。我使用的用户是具有完全访问权限的超级管理员。

API 的查询字符串如下所示：

```
accesskey=key&adminusername=Name of Person&ticketid=488&message=asdf asdf
Nothing past that first line goes :(
sad sad sad&action=addticketreply&responsetype=json&username=admin&password=mypassword 
```

我应该提到我正在使用 Indy 作为 Post。其他一切正常，通过的任何其他命令都有效，甚至更新票证，更新消息。它只是不会超过第一个换行符。

**编辑代码：**正如我上面提到的，我确实让 IdHTTP 使用 post 参数对我的文本进行编码，所以它应该可以工作，并且正如我在上面也提到的，我尝试对其进行预编码，结果是 WHMCS 不会取消-然后编码，只显示`%20`'s和other's。既然有人问我应该提一下，我正在使用 Indy 10！所以我是最新的最新版本。

```
j := TStringList.Create;
ret := TStringStream.Create('');
j.Text := k+params+'action='+method+'&responsetype=json&username='+username1.Text+'&password='+password;
try
  htp1.Post('http'+s+'://'+url1.Text+'/includes/api.php', j, ret);
except
  on E: EIdHTTPProtocolException do
       result := '{"result":"error", "message":"'+htp1.ResponseText+'"}';
end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T03:05:27.290

换行符、空格和其他保留字符需要进行 URL 编码，例如：

```
accesskey=key&adminusername=Name%20of%20Person&ticketid=488&message=asdf%20asdf%0D%0ANothing%20past%20that%20first%20line%20goes%20%3A%28%0D%0Asad%20sad%20sad&action=addticketreply&responsetype=json&username=admin&password=mypassword 
```

如果您通过 POST 请求发送值，请确保您使用的是最新版本的 Indy。`TIdHTTP.Post(TStrings)`为您处理编码，例如：

```
var
  Params: TStringList;
begin
  Params := TStringList.Create;
  try
    Params.Add('accesskey=key');
    Params.Add('adminusername=Name of Person');
    Params.Add('ticketid=488');
    Params.Add('message=asdf asdf'+CRLF+'Nothing past that first line goes :('+CRLF+'sad sad sad');
    Params.Add('action=addticketreply');
    Params.Add('responsetype=json');
    Params.Add('username=admin');
    Params.Add('password=mypassword');
    IdHTTP1.Post(URL, Params);
  finally
    Params.Free;
  end;
end; 
```

但是，如果您通过 URL 查询字符串发送值，那么您必须手动编码 URL，`TdHTTP`不会为您处理，例如：

```
var
  URL: String;
begin
  URL := 'http://host/path?accesskey=key&adminusername=Name of Person&ticketid=488&message=asdf asdf'+CRLF+'Nothing past that first line goes :('+CRLF+'sad sad sad&action=addticketreply&responsetype=json&username=admin&password=mypassword';
  IdHTTP1.Get(TIdURI.URLEncode(URL));
end; 
```

或者：

```
var
  URL: String;
  Params: TStringList;
  I: Integer;
begin
  Params := TStringList.Create;
  try
    Params.Add('accesskey=key');
    Params.Add('adminusername=Name of Person');
    Params.Add('ticketid=488');
    Params.Add('message=asdf asdf'+CRLF+'Nothing past that first line goes :('+CRLF+'sad sad sad');
    Params.Add('action=addticketreply');
    Params.Add('responsetype=json');
    Params.Add('username=admin');
    Params.Add('password=mypassword');

    for I := 0 to Params.Count-1 do
      Params[i] := TIdURI.ParamsEncode(Params[i]);

    Params.Delimiter := '&';
    Params.StrictDelimiter := True;
    Params.Quotechar := #0;

    URL := 'http://host/' + TIdURI.PathEncode('path') + '?' + Params.DelimitedText;
    IdHTTP1.Get(URL);
  finally
    Params.Free;
  end;
end; 
```

# javascript - 在 XBOX 上检测 IE10

> ID：13503852
> 
> 赞同：1
> 
> 时间：2012-11-21T23:41:38.980
> 
> 标签：javascript, css, html5-video, xbox360, internet-explorer-10

如何在 XBOX 360 上检测 IE10？

一切格式都很好——UNICORN 完全通过了——但 HTML5 视频在我使用的样式的 XBOX 360 的 IE 上无法正确显示（不，样式必须保持不变）。所有其他桌面浏览器（IE9、IE10、Firefox、Chrome、Safari 和 Opera）都能完美处理。当检测到 iPad、Android 和 IE10 Metro 等移动设备时，我已经禁用了视频标签，因为它们有同样的问题，但我没有找到太多关于 IE for XBOX 捕获的主题的文章。当然，XBOX 的 IE 不是优先级，但它是我需要反程序的最后一个浏览器。感谢您的时间和知识！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T15:53:31.087

Xbox 上没有 IE10。它基于 IE9，因此理论上，如果您的网站在 IE9 桌面上运行，它应该在 XBox 上运行得相当好，除了需要进行调整以在您与其他输入方法远距离交互的屏幕上很好地显示。

[您可以在http://www.microsoft.com/en-us/download/details.aspx?id=30442](http://www.microsoft.com/en-us/download/details.aspx?id=30442)找到 XBox 开发人员指南的 IE

您应该只将用户代理字符串作为最后的手段进行检测。用于 Xbox 的 IE 的 UA 字符串是：

*   桌面模式：Mozilla/5.0（兼容；MSIE 9.0；Windows NT 6.1；Trident/5.0；Xbox）
*   移动模式：Mozilla/5.0（兼容；MSIE 9.0；Windows Phone OS 7.5；Trident/5.0；IEMobile/9.0；Xbox）

常规 UA 字符串是桌面模式。如果用户有标清电视，则用户可以切换到移动模式，如果给定移动版本，网页会更好地工作。要检测的关键令牌是“Xbox”。

# jquery - Jquery在div元素中切换文本

> ID：13503857
> 
> 赞同：1
> 
> 时间：2012-11-21T23:42:03.837
> 
> 标签：jquery, html

有没有一种好方法可以简单地将“添加到购物车”更改为“从购物车中删除”但保留所有按钮和链接属性，点击 Jquery？

**HTML**

```
<div class = "checkout_icon"> <a href="#" class="button">Add to cart</a> </div> 
```

**jQuery**

```
$('.checkout_icon a ').on('click', function(e) {  

    if($(this).hasClass('selected')){
         //
    }else{
        $('.checkout_icon').html($('<div>').append($('Remove from Cart', '#div')).html());
    }

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:46:14.717

简单地：

```
$('.checkout_icon a').text('Remove from Cart'); 
```

在`click`活动内部：

```
$('.checkout_icon a').click(function(){
    var $this = $(this);
    this.innerHTML = $this.hasClass('selected') ? 'Remove from Cart' 
                                                : 'Add to Cart';
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:46:53.627

您可以使用`.text()`方法来完成工作..

```
$('.checkout_icon a ').on('click', function(e) {
    e.preventDefault();
    var text = this.innerHTML; //  OR   $(this).text(); 
    var currText = 'Remove from Cart'
    if (text.indexOf('Remove') > -1) {
        currText = 'Add from Cart'
    }
    this.innerHTML = currtext;// OR   $(this).text(currText)
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/qQ3C5/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:55:08.507

## *[jsBin 演示](http://jsbin.com/okevem/1/edit)*

```
$('.checkout_icon a ').on('click', function(e) {
    e.preventDefault(); // prevent browser follow 'a' 

    $(this).text( $(this).hasClass('selected') ? 'Add to cart' : 'Remove from cart' );
    $(this).toggleClass('selected');     
}); 
```

# java - 为什么 HttpsURLConnection.getServerCertificates() 在 Java6 和 Java7 中返回不同的结果？

> ID：13503861
> 
> 赞同：5
> 
> 时间：2012-11-21T23:42:14.017
> 
> 标签：java, python, ssl, httpsurlconnection

我有这样的代码：

```
 // configure the SSLContext with a TrustManager
    SSLContext ctx = SSLContext.getInstance("TLS");
    ctx.init(new KeyManager[0], 
             new TrustManager[] {new DefaultTrustManager()}, 
             new SecureRandom());
    SSLContext.setDefault(ctx);

    URL url = new URL(urlString); // https://abc.myhost.com
    HttpsURLConnection conn = (HttpsURLConnection) url.openConnection();
    conn.setHostnameVerifier(new HostnameVerifier() {
            @Override
            public boolean verify(String arg0, SSLSession arg1) {
                System.out.println("verify:" + arg0);
                return true;
            }
        });

    System.out.println("HTTP status: " + conn.getResponseCode());
    Certificate[] certs = conn.getServerCertificates();
    int c=0;
    for (Certificate cert : certs){
        String t = cert.getType();
        System.out.println(String.format("\ncert[%d]: %s",c,t));
        c++;
        if (pi.verbose) {
            System.out.println(cert);
        }
        else if (cert instanceof X509Certificate) {
            X509Certificate x509cert = (X509Certificate) cert;
            System.out.println(x509cert.getSubjectDN().getName());
        }
    } 
```

在 Java 6 上针对特定网站运行此代码，我得到的证书与 Java 7 不同。假设主机名是 abc.myhost.com。

在 Java6 上我得到：

```
cert[0]: X.509
CN=example.com,OU=Secure Link SSL Pro,O=Company Name Here, 
    STREET=2001 Space Odyssey Dr,L=Weirton,ST=Wv,2.5.4.17=#13053330303034,C=US 
```

在 Java7 上，我得到：

```
cert[0]: X.509
CN=abc.myhost.com,OU=Secure Link SSL Pro,O=Company Name Here, 
    STREET=2001 Space Odyssey Dr,L=Weirton,ST=Wv,2.5.4.17=#13053330303034,C=US 
```

如果我打印出有效日期，那也是不同的。和序列号一样。这些是不同的证书。

在 Java 7 上看起来不错；在 Java 6 上，我在主机名和 CN 之间存在分歧。证书看起来不对。

该服务器完全有可能在代理后面。该服务器的所有者（我正在从事的项目中的合作伙伴）也有可能最近更改了证书。可能有 2 个证书，一个在代理服务器上，一个在代理服务器后面的服务器上。我让他们调查这个。

我的问题是，为什么我不能在 Java7 上得到与在 Java6 上相同的结果？Java 改变了什么[`HttpsURLConnection.getServerCertificates()`](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/HttpsURLConnection.html#getServerCertificates%28%29)？

* * *

对于好奇的人，这只是一种诊断工作。真正的错误是：

```
javax.net.ssl.SSLHandshakeException: java.security.cert.CertificateException: 
    No subject alternative DNS name matching abc.myhost.com found. 
```

这种情况下的问题通常是证书中的主机名和 CN 不一致。我已经验证了分歧，*但仅限于 Java 6*。我想了解为什么 Java6 和 Java7 不同。

* * *

*编辑*： [Python 2.7.1 脚本](http://phreakmonkey.com/index.php/archives/100)返回与 Java6 相同的证书。 `SSLConnection.get_peer_cert()`向我显示 CN 不匹配的证书。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-22T11:05:40.160

我怀疑这是由于 Java 7 在客户端引入了服务器名称指示支持。

SNI 允许客户端在 SSL/TLS 初始请求中指定主机名，特别是能够使用不同的证书在同一 IP 地址/端口上托管多个主机名（Apache Httpd 称之为基于名称的虚拟主机）。在 SSL/TLS 握手期间知道请求的主机名允许服务器在使用任何 HTTP 流量之前提供正确的证书（HTTP`Host`标头在 HTTP 级别使用，但对于 HTTPS 为时已晚）。

当客户端不支持它时，服务器不知道客户端真正需要哪个主机名，并且通常会退回到默认主机值并提供默认证书。

（请注意，在 Win XP 和某些移动浏览器上使用任何版本的 IE 都会遇到同样的问题。）

**编辑：**按照您的编辑 ( `URL url = new URL(urlString); // https://abc.myhost.com`)。

这似乎证实了 SNI 问题。（您可以使用 Wireshark 检查 TLS 客户端 Hello 消息中是否有服务器名称扩展。）

使用 Java 7 和任何支持 SNI 的客户端，在请求时`https://abc.myhost.com`，您确实会获得一个有效的证书`abc.myhost.com`（前提是服务器配置正确），因为`HttpsURLConnection`还会告诉 JSSE（Java SSL/TLS 堆栈）使用服务器名称扩展名和使用该 URL 的主机名启动 SSL/TLS 连接。

对于 Java 6 和任何不支持 SNI 的客户端（Python 2.7，至少没有其他库），您将获得服务器在连接到该 IP 地址和端口时默认提供的证书。

`HttpsURLConnection.getServerCertificates()`它与or无关`SSLConnection.get_peer_cert()`。相反，这是因为服务器希望客户端支持 SNI，而一些较旧的客户端/平台不支持。

如果您需要在 Windows XP 上支持 Java 6、Python 2.x、Internet Explorer（或其他使用默认 MS API 的客户端），您将无法使用 SNI。在这种情况下，您应该联系服务器管理员更改配置以不使用 SNI（如果需要这些多台主机，可能需要额外的 IP 地址）。

# css - 媒体查询分组而不是匹配的多个分散的媒体查询

> ID：13503862
> 
> 赞同：5
> 
> 时间：2012-11-21T23:42:38.360
> 
> 标签：css, less, media-queries, dotless

我正在尝试 LESS（不是 SASS 语法的粉丝），并且一直试图找出用它进行媒体查询的最佳方法是什么。

我通读了[这篇](http://alwaystwisted.com/post.php?s=2012-05-05-everyday-im-bubbling-with-media-queries-and-less)关于如何使用 LESS “进行”媒体查询的博文，但它指出了这样一个事实，即这会导致所有媒体查询在生成的 CSS 中被分离和分散。这并没有真正困扰我（我可能不太关心结果，而更多地关心它的工作）。令我困扰的是一条评论，该评论谈到了从 iOS 设备查看时出现的问题，评论者发现，一旦整合了媒体查询，问题就得到了解决。

有没有人找到一个使用 LESS 的媒体查询的好解决方案？

我设想这项工作的方式类似于......

```
//Have an overall structure...
.overall(){
    //Have ALL your CSS that would be modified by media queries and heavily use
    //variables that are set inside of each media queries.
}
@media only screen and (min-width: 1024px){
    //Define variables for this media query (widths/etc)
    .overall
} 
```

我知道这可能存在一些问题，但目前的设置似乎没有那么有益。

所以我想我的问题是是否有任何好的解决方案/黑客允许分组媒体查询？

（以防万一我使用 dotless 作为引擎来解析我的`.less`文件）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-29T02:32:32.050

首先，您在问题中给出的解决方案肯定有一些用处。

然而，我想的一件事是，将所有媒体查询变量定义为彼此“靠近”会很好（您的解决方案将在每个媒体查询调用下都有它们）。所以我建议以下作为替代解决方案。它也有缺点，一个可能是预先编码更多。

**更少的代码**

```
//define our break points as variables
@mediaBreak1: 800px;
@mediaBreak2: 1024px;
@mediaBreak3: 1280px;

//this mixin builds the entire media query based on the break number
.buildMediaQuery(@min) {
    @media only screen and (min-width: @min) { 

        //define a variable output mixin for a class included in the query
        .myClass1(@color) {
            .myClass1 {
               color: @color;
            }
        }

        //define a builder guarded mixin for each break point of the query
        //in these is where we change the variable for the media break (here, color)
        .buildMyClass1() when (@min = @mediaBreak1) {
           .myClass1(red);
        }
        .buildMyClass1() when (@min = @mediaBreak2) {
           .myClass1(green);
        }
        .buildMyClass1() when (@min = @mediaBreak3) {
           .myClass1(blue);
        }

        //call the builder mixin
        .buildMyClass1();

        //define a variable output mixin for a nested selector included in the query
        .mySelector1(@fontSize) {
           section {
              width: (@min - 40);
              margin: 0 auto;
              a {
                font-size: @fontSize;
              }
           } 
        }

        //Again, define a builder guarded mixin for each break point of the query
        //in these is where we change the variable for the media break (here, font-size)
        .buildMySelector1() when (@min = @mediaBreak1) {
           .mySelector1(10px);
        }
        .buildMySelector1() when (@min = @mediaBreak2) {
           .mySelector1(12px);
        }
        .buildMySelector1() when (@min = @mediaBreak3) {
           .mySelector1(14px);
        }

        //call the builder mixin
        .buildMySelector1();

        //ect., ect., etc. for as many parts needed in the media queries.
    }
}

//call our code to build the queries
.buildMediaQuery(@mediaBreak1);
.buildMediaQuery(@mediaBreak2);
.buildMediaQuery(@mediaBreak3); 
```

**CSS 输出**

```
@media only screen and (min-width: 800px) {
  .myClass1 {
    color: #ff0000;
  }
  section {
    width: 760px;
    margin: 0 auto;
  }
  section a {
    font-size: 10px;
  }
}
@media only screen and (min-width: 1024px) {
  .myClass1 {
    color: #008000;
  }
  section {
    width: 984px;
    margin: 0 auto;
  }
  section a {
    font-size: 12px;
  }
}
@media only screen and (min-width: 1280px) {
  .myClass1 {
    color: #0000ff;
  }
  section {
    width: 1240px;
    margin: 0 auto;
  }
  section a {
    font-size: 14px;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T09:25:17.183

对于响应式 Wordpress 网站，我使用 Eddie Machado ( [http://themble.com/bones/](http://themble.com/bones/) ) 的名为 Bones 的入门主题。我更喜欢它使用媒体查询的方式，它有针对不同断点（480+、768+ 等）的不同样式表，您可以根据您的设计进行更改。

然后，它使用 @import 将这些导入到相应媒体查询下方的一个样式表中。您在 LESS 中编辑所有这些，我使用 Simpless by Kiss ( [http://wearekiss.com/simpless](http://wearekiss.com/simpless) ) 将我的 .less 样式表自动编译为 .css。我真的觉得它是开发一个简单的响应式网站的一个很好的起点。即使你不是在 Wordpress 中开发，你也可能想看看他们是如何构建媒体查询的，因为即使使用 if LESS，它似乎也能正常工作。

# php - 正则表达式 preg_match 仅更改引号之间的特殊字符

> ID：13503866
> 
> 赞同：0
> 
> 时间：2012-11-21T23:42:45.133
> 
> 标签：php, regex, preg-replace

```
$value = "abrak'adabra' baba";

$pattern = array();
$replacement = array();

$pattern[] = '/(\'[^\']+\')|(a)/e';
$replacement = "strlen('\\2') ? 'i' : '\\0'"; 
```

上面的代码将**abrak'adabra' baba**更改为**ibrik'adabra' bibi**

我想做的是将**abrak'adabra' baba**更改为**abrak'idibri' baba**。怎么做？

老实说，我什至不太了解上面的正则表达式模式。有一些我知道但我不知道的代码：

*   在 $pattern 中说：（任何包含两个引号且中间没有引号的单词）或（字符“a”）。在替换中，像 strlen 这样的 php 代码将起作用，因为将使用 /e 修饰符。但我不明白为什么那里是“或”逻辑。
*   如果模式中第二部分的长度（a 字符）大于零，则将其替换为“i”，否则执行其他操作（我不明白 \0 的含义）

我会很感激任何帮助。这个正则表达式的东西让我很沮丧:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:23:35.620

在模式中使用`e`修饰符 (eval) 是危险的，因为有人可能会在您的服务器上执行恶意代码（有关更多信息，请参见[手册的](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)部分）。

相反，如果您需要对匹配的项目进行额外处理，您可以使用[`preg_replace_callback`](http://php.net/manual/en/function.preg-replace-callback.php)：

```
// Find all characters between single quotes
$result = preg_replace_callback('/\'(.*?)\'/', function($matches){
    // Replace 'a' with 'i' in found matches
    return '\''.str_replace('a', 'i', $matches[1]).'\'';
}, $value); 
```

如果您所做的只是在引号之间替换`a`，`i`则可能有更优化的方法来解决它，但这样您就有空间对引号之间的字符串进行更高级的处理。

# responsive-design - 调整布局以改变屏幕方向

> ID：13503867
> 
> 赞同：0
> 
> 时间：2012-11-21T23:42:48.040
> 
> 标签：responsive-design

我是自适应/响应式 Web 开发的新手。当设备的方向发生变化时，我对移动设备如何处理屏幕分辨率的变化感到困惑。

如果我创建两个媒体查询 - 一个用于 320（纵向），一个用于 480（横向），iphone 只加载 320 版本，无论方向如何，adn 只是缩放以填满屏幕。

当 iphone 以横向位置加载时，或者当 iphone 从纵向倾斜到横向时，有没有办法提供新的 480 样式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:59:17.660

首先，媒体查询有一个你可能发现的属性

```
@media all and (orientation:portrait) { … }
@media all and (orientation:landscape) { … } 
```

您可以通过强制在 iPhone 上渲染

```
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0"> 
```

然后使用一些CSS来定位横向模式

```
@media screen and (min-width: 321px){
  //styles
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T15:26:39.397

CSS 媒体查询在从一个设备到另一个设备的方向上有点棘手。你仍然有一个很好的 js 选项：

```
window.addEventListener('orientationchange', changeOrientation, false);

function changeOrientation() {
if (orientation == 0 || orientation == 180) {
  //portraitMode
}
else {
  //LandscapeMode
} 
```

# java - 按下按钮后使用 While 循环在多维数组中搜索值

> ID：13503869
> 
> 赞同：1
> 
> 时间：2012-11-21T23:42:57.227
> 
> 标签：java, android, button, while-loop

我对为 Android 手机制作应用程序相对较新，过去一周我一直在尝试解决一个问题。我想要做的是接受 4 个变量，其中 3 个来自微调器，并使用 while 循环和 case 语句来搜索数据库以将字符串发送到 TextView 框中。我遇到的主要问题是按钮按下后的while循环导致程序出错。我尝试过实现不同的方法，例如使用可运行对象和线程来完成它，但没有取得任何成功。我将不胜感激任何帮助。阵列的构建方式是 54x7。

```
public void onClick(View v) {
    // TODO Auto-generated method stub

    while(AutoDatabase[i][0] != YearSelect){
        i++;
    }

    while(AutoDatabase[i][1] != MakeSelect){
        i++;
    }

    while(AutoDatabase[i][2] != ModelSelect){
        i++;

    if (LightsOut == "FDTS"){
        Part = AutoDatabase[i][3];
    } else if (LightsOut == "FPTS"){
        Part = AutoDatabase[i][4];
    } else if (LightsOut == "RDTS"){
        Part = AutoDatabase[i][5];
    } else if (LightsOut == "RPTS"){
        Part = AutoDatabase[i][6];
    }

    PartDisplay.setText(Part);
} 
```

# wpf - 显示集合中成员的子属性值

> ID：13503871
> 
> 赞同：0
> 
> 时间：2012-11-21T23:43:21.047
> 
> 标签：wpf, data-binding, telerik-grid

我将 ObservableCollection 绑定到 Grid，我使用的类 T 将具有类似于此的结构：

```
public class MyObject {
    public int Id {get;set;}
    public string Name {get;set;}
    public Address MyAddress {get;set;}
}

public class Address {
    public String Street {get;set}
} 
```

因此，我将 ObservableCollection 绑定到 Telerik RadGridView，我想做的是为集合中的每个元素显示属性 Address.Street，但我无法弄清楚如何。

我尝试进行如下绑定：

```
{Binding MyAddress.Street}
{Binding MyAddress/Street}
{Binding Address.Street} 
```

但不是这些工作。有没有办法设置绑定的 Path 属性来做这样的事情？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:25:01.620

如果您使用`GridViewDataColumn`with `DataMemberBinding`，那么您可能必须使用单元格模板来呈现子成员属性（我原以为`DataMemberBinding="{Binding Address.Street}"`应该可以工作，但如果没有，那么......）：

```
<telerik:GridViewDataColumn DataMemberBinding="{Binding Address}">
    <telerik:GridViewColumn.CellTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Street}" />
        </DataTemplate>
    </telerik:GridViewColumn.CellTemplate>
</telerik:GridViewDataColumn> 
```

# ruby-on-rails - 切换到 Postgres 后，Ruby on Rails 应用程序中出现奇怪的“未定义方法”错误

> ID：13503874
> 
> 赞同：0
> 
> 时间：2012-11-21T23:43:45.650
> 
> 标签：ruby-on-rails, ruby, postgresql

这是`prompt.rb`：

```
class Prompt < ActiveRecord::Base
  attr_accessible :title, :teacherUrl, :studentUrl, :image, :text;

  validates :title, :length => { :minimum => 5 };

  has_attached_file :image ;

  def initialize(params = nil)
    super(params)
    after_initialize
  end

  def after_initialize()
    self.teacherUrl = 'T' + (0...4).map{65.+(rand(26)).chr}.join ;
    self.studentUrl = 'S' + (0...4).map{65.+(rand(26)).chr}.join ;
  end
end 
```

当我从 prompt_controller.rb （从默认的“新”方法）创建一个新的提示时，我得到：

```
undefined method `teacherUrl=' for #<Prompt:0x007fe3ac68adc0> 
```

使用应用程序跟踪

```
app/models/prompt.rb:14:in `after_initialize'
app/models/prompt.rb:10:in `initialize'
app/controllers/prompts_controller.rb:43:in `new'
app/controllers/prompts_controller.rb:43:in `new' 
```

这与 sqlite 完美配合。我刚刚将我的数据库切换到 Postgres，现在这个错误正在上升......似乎它无法相关，但这就是改变的全部（我可以返回一个修订版并且它再次完美运行）。

有什么问题？不是用 attr_accessible 定义的teacherUrl 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:59:30.250

你需要做`rake db:migrate`。并且可能`rake db:create`（首先）。

# c++ - 异构可变参数非类型模板参数计数是否灵活？

> ID：13503877
> 
> 赞同：0
> 
> 时间：2012-11-21T23:44:09.317
> 
> 标签：c++, templates, c++11, variadic-templates

下面定义了一个可变参数的非类型嵌套类模板，`DEF`. 根据为 提供的类型参数，非类型模板参数可能是异构的`Ts`。

```
template <typename ...Ts>
struct ABC {
  template <Ts ...Xs>
  struct DEF {};
}; 
```

一个`DEF`对象可以声明如下：

```
ABC<int,bool>::DEF<17,true> x; 
```

我的问题是，提供的非类型模板参数`DEF`的数量是否可以少于提供给的类型模板参数的数量`ABC`？例如，这些声明中的任何一个是否有效：

```
ABC<int,bool>::DEF<17> y;
ABC<int,bool>::DEF<  > z; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:28:12.317

不，因为`Ts...`是包扩展。

`§14.5.3 [temp.variadic]`

> p4*包扩展*由一个*模式*和一个省略号组成，其实例化会在列表中产生零个或多个模式的实例化（如下所述）。模式的形式取决于扩展发生的上下文。包扩展可能发生在以下情况下：
> 
> *   [...]
> *   在作为包扩展 (14.1) 的模板参数包中：
>     *   如果模板参数包是*参数声明*；模式是没有省略号的*参数声明；*
>     *   [...]
> 
> p6 包扩展的实例化 [...] 产生一个列表*E [1] , E [2] , ..., E [N]*，其中*`N`*是包扩展参数中的元素数。[...]

因此，您的两个示例都是格式错误的，因为`DEF`将完全采用`<int, bool>`.

# ruby - 启动时没有文件或目录

> ID：13503885
> 
> 赞同：0
> 
> 时间：2012-11-21T23:44:59.287
> 
> 标签：ruby, net-sftp

我正在尝试使用 ruby​​ 制作概念验证脚本，但似乎失败了......我已经授予脚本运行权限，但是当它运行时，我从终端得到“：没有这样的文件或目录”。

我确实通过 gem 安装了 net-sftp，所以我不知道它可能是什么。

```
#!/usr/bin/env ruby

require 'net/sftp'

Net::SFTP.start('10.0.0.8', 'jacob', :password=> 'password') do |sftp|
  #download a directory
  sftp.download!("/home/jacob/backups/*", "/home/pi")
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T20:26:00.543

原来这是我的系统的问题，而不是红宝石。对困惑感到抱歉。

# java - 如何从 PreferenceActivity 在 Preference 类中运行函数

> ID：13503886
> 
> 赞同：4
> 
> 时间：2012-11-21T23:45:11.663
> 
> 标签：java, android, preferenceactivity, dialog-preference

我们可以在 PreferenceActivity 中设置的 Preference 类型只有这么多。单击某个首选项后，我将尝试运行特定功能。有没有办法覆盖preferenceScreen 或editText onClick？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T00:19:22.693

是的你可以。这是一个简单示例，说明如何获取首选项引用并在单击事件上执行自定义代码。

```
public class ActivityPreferences extends PreferenceActivity
{
    protected void onCreate( Bundle savedInstanceState )
    {
        super.onCreate( savedInstanceState );
        addPreferencesFromResource( R.xml.preferences );

        Preference myPref = findPreference( "MY_PREF" );
        myPref.setOnPreferenceClickListener( new OnPreferenceClickListener()
        {
            public boolean onPreferenceClick( Preference pref )
            {
                  // Run your custom method
            }
        } );
    }
} 
```

# sitecore - 授予角色访问 Sitecore 6.5 中特定文件夹的权限

> ID：13503887
> 
> 赞同：0
> 
> 时间：2012-11-21T23:45:16.913
> 
> 标签：sitecore

我有一个用户被分配了 sitecore/Analytics Reporting 角色（Sitecore 客户用户的成员），当我使用该用户登录时，我可以看到营销中心、参与分析和执行仪表板。我现在想授予该用户对内容项的读取权限，但我无法使其工作。

首先，sitecore/Analytics Reporting 角色已经拥有对内容编辑器等的读取权限（继承自 Everyone 角色），为什么我看不到呢？我创建了另一个对内容项具有显式读取权限的角色，并将其分配给同一用户，但我仍然看不到它。有谁知道我需要做什么才能让用户看到内容项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T08:59:34.437

我之前在旧的 Sitecore 版本中看到过几次。当时执行 Sitecore 缓存清除或 IIS 重置解决了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T00:42:41.890

在与 Sitecore 支持人员核实后，他们告诉我您必须将 Sitecore Client Designer 添加到您的角色中（即使访问查看器显示您具有读取访问权限，在您添加此角色之前您仍然无法看到它）。

# android - Linux内核wait_for_completion_timeout未完成唤醒

> ID：13503888
> 
> 赞同：2
> 
> 时间：2012-11-21T23:45:27.273
> 
> 标签：android, kernel

我正在处理 i2c-omap 驱动程序的一个奇怪问题。我不确定问题是否发生在其他时间，但它发生在我尝试关闭系统电源的时间大约为 5%。在系统断电期间，我通过 I2C 写入 PMIC 中的一些寄存器。在 i2c-omap.c 中，我可以看到调用线程正在等待 wait_for_completion_timeout，超时值设置为 1 秒。我可以看到名为“完成”的 IRQ（我在“完成”之后添加了 printk）。但是，在调用“完成”之后，wait_for_completion_timeout 没有返回。相反，它最多需要 5 分钟才能返回。而wait_for_completion_timeout的返回值为正表示没有超时。并且整个I2C交易是成功的。

同时，我可以看到来自其他驱动程序的 printk 消息。串行控制台仍然有效。它在 Android 上，如果我使用“top”，我可以看到 system_server 占用了大约 95% 的 CPU。杀死 system_server 可以使 wait_for_completion_timeout 立即返回。

所以我的问题是用户空间应用程序（system_server）可以做什么来使内核“wait_for_completion_timeout”不被唤醒？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:26:21.647

wait_for_completion_timeout 仅保证当 (i) 完成发生或 (ii) 超时到期时，等待条件的线程将变为“可运行”。
之后，调度程序的工作就是调度该线程并将其状态从“可运行”更改为“运行”。线程本身（或完成框架）不负责使线程可运行，这是调度程序的工作。
正如您所指出的，system_server 消耗了 95% 的 cpu，因此很难安排完成线程。这就解释了为什么线程没有被安排。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T23:02:21.187

嗯，我有点想通了。在 CFS 调度中，在 enqueue_entity 中，它在某些条件下执行“vruntime += min_vruntime”，而在 dequeue_entity 中，它在某些条件下执行相反的操作。但是，这些并不总是成对执行。所以在一些未知的情况下，当min_vruntime 很大时，vruntime 会变得很大，所以任务会被放到rbtree 的右边，很长一段时间都不会被调度。我不确定从根本原因解决此问题的最佳方法是什么，我所做的是在 enqueue_entity 中进行破解，如果我发现 vruntime>min_vruntime 并且该函数被称为 WAKEUP，我总是设置 vruntime=min_vruntime，因此任务将被放在 rbtree 的相对左侧。我使用的内核版本是 2.6.37 有人对如何以更好的方式修复此问题有建议吗？

# c# - 非静态字段、方法或属性“WindowsFormsApplication1.Form1.label1”需要对象引用

> ID：13503897
> 
> 赞同：1
> 
> 时间：2012-11-21T23:46:26.170
> 
> 标签：c#, methods

我想重用一段代码，所以我想我会用一个包含该代码的方法创建一个类，然后我会在需要的地方调用该方法。

我做了一个简单的例子来说明我的问题：

**Form1.cs**

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        public void Form1_Load(object sender, EventArgs e)
        {
            LoadText.getText();
        }
    }
} 
```

**加载文本.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace WindowsFormsApplication1
{
    public class LoadText : Form1
    {
        public static void getText()
        {
            WindowsFormsApplication1.Form1.label1.Text = "New label1 text";
        }
    }
} 
```

如您所见，我有一个带有标签的表单，我想使用我的其他方法（LoadText 中的 getText）来更改标签的文本。

这是我的错误信息：

> 非静态字段、方法或属性“WindowsFormsApplication1.Form1.label1”需要对象引用**

我已经在设计**中将 label1**从私有更改为公共。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:55:22.283

问题是这`Form1`是一个类，而不是一个对象。`label1`不是类的静态成员，它是*实例*的成员`Form1`。因此出现错误，它告诉您需要一个（`Form1`类的）对象实例。

尝试以下操作：

**Form1.cs：**

```
LoadText.getText(label1); 
```

**加载文本.cs：**

```
public static void getText(Label lbl)
{
    lbl.Text = "New label1 text";
} 
```

您现在有一个静态方法，它将接受一个`Label`对象并将其文本设置为“新 label1 文本”。

`static`有关修饰符的更多信息，请参见以下链接：

[http://msdn.microsoft.com/en-us/library/98f28cdx.aspx](http://msdn.microsoft.com/en-us/library/98f28cdx.aspx)

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:56:41.147

这是 OO 编程新手的常见问题。

如果要使用对象的方法，则需要创建它的实例（使用 new）。除非，该方法不需要对象本身，在这种情况下，它可以（并且应该）被声明为静态的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:55:06.650

您需要对表单的引用才能访问其元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-13T00:12:14.440

我尝试了另一种也有效的方法：

**Form1.cs：**

```
 // here a static method is created to assign text to the public Label
 public static void textReplaceWith(String s, Label label)
 {
     label.Text = s;
 } 
```

**加载文本.cs：**

```
namespace WindowsFormsApplication1
{
    public class LoadText : Form1
    {
        //new label declared as a static var
        public static Label pLabel;

        //this method runs when your form opens
        public LoadTextForm() 
        {
            pLabel = Label1; //assign your private label to the static one
        }

        //Any time getText() is used, the label text updates no matter where it's used
        public static void getText()
        {
           Form1.textReplaceWith("New label1 text", pLabel); //Form1 method's used 
        }
    }
} 
```

这将允许您使用公共方法从几乎任何地方更改标签的文本变量。希望这可以帮助 ：）

# java - 在 WebLogic 12c 中部署独立 EJB

> ID：13503898
> 
> 赞同：2
> 
> 时间：2012-11-21T23:46:32.067
> 
> 标签：java, web-services, deployment, ejb, weblogic

我想部署一个我在 Netbeans 中开发的 EJB 模块。EJB 包含使用 JAX WS 库和无状态会话 Bean 的 Web 服务...会话 Bean 类使用位于另一个 JavaApplication 项目中的远程接口，并且在同一个 JavaApplication 项目中具有用作库的其他类。EJB 使用在 netbeans 中创建的数据源与 SQL SERVER 连接，一切正常！...我阅读了 weblogic 12c 的文档以部署具有 web 服务和连接到数据库的独立 EJB，但不太了解如何部署EJB...

我必须遵循哪些步骤来部署此 EJB？如何打包 ejb 以使用 JavaApplication 作为库？EJB 如何连接到数据库？wsdl 可以使用 Web 服务吗？

# node.js - 无法获得 POST 响应

> ID：13503900
> 
> 赞同：0
> 
> 时间：2012-11-21T23:46:35.867
> 
> 标签：node.js, post, towerjs

我正在使用 Tower.js 0.4.2-20。

我发送了 HTML FORM 标签的 GET 和 POST 请求。
'GET' 请求是没有问题的响应。但“POST”请求是返回以下错误。

我缺少路由器设置？

路线.咖啡：

```
Tower.Route.draw ->
  @resources 'service'
  @match '/service/add', to: 'service#add', via: 'post' 
```

服务控制器.coffee：

```
class ServiceController extends App.ApplicationController
  index: ->
    @render text: "GET"
  create: ->
    @render text: "POST"
  add: ->
    @render text: "ADD" 
```

索引.html：

```
<form method='POST' action='service/add'>
    <div><input type='submit' value='Add'></div>
</form> 
```

错误 ：

```
Error: Forbidden
at Object.exports.error (/var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/lib/utils.js:44:13)
at Object.module.exports [as handle] (/var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/lib/middleware/csrf.js:54:41)
at next (/var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/lib/proto.js:190:15)
at multipart (/var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/lib/middleware/multipart.js:57:27)
at module.exports (/var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/lib/middleware/bodyParser.js:57:9)
at IncomingMessage.module.exports (/var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/lib/middleware/urlencoded.js:68:11)
at IncomingMessage.EventEmitter.emit (events.js:115:20)
at Object.resume (/var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/node_modules/pause/index.js:25:18)
at store.get.next (/var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/lib/middleware/session.js:311:15)
at /var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/lib/middleware/session.js:333:9 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T05:06:31.287

第一个猜测：您的表单的相对 URL 是问题所在。将您`form`的`action`属性更改为`/service/add`，看看是否有帮助。您收到的 403 禁止错误可能意味着 POST 请求将转到您期望的不同 URL 路径。例如，如果您的表单位于，则由于相对 url `/pages/service`，表单将提交到。`/pages/service/service/add`

第二个猜测：啊。知道了。

```
at Object.module.exports [as handle] (/var/www/html/melissa/manage/development/yoshiaki-tanaka/node_modules/tower/node_modules/express/node_modules/connect/lib/middleware/csrf.js:54:41) 
```

该`crsf`模块可能正在检查您的表单中的跨站点请求伪造令牌，该令牌将采用`<input type="hidden" name="crsf_token" value="YOUR_CRSF_TOKEN">`标签（或类似的东西）的形式。阅读您正在使用的 CRSF 中间件上的文档，了解如何创建正确的`<form>`标记 HTML，包括 CRSF 令牌。

# wpf - 关于 WPF 树视图的问题

> ID：13503901
> 
> 赞同：0
> 
> 时间：2012-11-21T23:46:50.893
> 
> 标签：wpf

我是 WPF 新手，正在尝试使用树视图创建树。

我想要做的是动态生成一棵树。每个treeViewItem 都包含一个comboBox 和一个textBlock。当用户展开节点时，应用程序将从数据源中检索子节点信息。最后，用户可以使用复选框选择多个节点。

根据一些在线教程，我做了以下树：e 如下所示：

```
<Window.Resources>
    <Style TargetType="{x:Type TreeViewItem}">
        <Setter Property="HeaderTemplate">
            <Setter.Value>
                <HierarchicalDataTemplate DataType="{x:Type sotc:TaxNode}" ItemsSource="{Binding Path=Children}">
                    <StackPanel Orientation="Horizontal">
                        <CheckBox Name="chk" Margin="2" Tag="{Binding}"/>
                        <TextBlock Text="{Binding Path=TaxID}" ToolTip="{Binding Path=Lineage}" />
                    </StackPanel>
                </HierarchicalDataTemplate>
            </Setter.Value>
        </Setter>

    </Style>
</Window.Resources>

<Grid>
    <TreeView Margin="25,186,22,46">
        <TreeViewItem Header="Taxonomy Tree" x:Name="_TaxTree" x:FieldModifier="private">
            <TreeViewItem Header="Loading..." TextBlock.FontStyle="Italic"></TreeViewItem>
        </TreeViewItem>
    </TreeView>
</Grid> 
```

我有一种方法来获取选定的组合框

```
private List<CheckBox> GetSelectedCheckBoxes(ItemCollection items)
    {
        var list = new List<CheckBox>();
        foreach (TreeViewItem item in items)
        {
            UIElement element = GetChildControl(item, "chk");
            if (element != null)
            {
                var chk = (CheckBox)element;
                if (chk.IsChecked.HasValue && chk.IsChecked.Value)
                {
                    list.Add(chk);
                }
            }

            List<CheckBox> l = GetSelectedCheckBoxes(item.Items);
            list = list.Concat(l).ToList();
        }

        return list;
    }

    private UIElement GetChildControl(DependencyObject parentObject, string childName)
    {
        UIElement element = null;
        if (parentObject != null)
        {
            int totalChild = VisualTreeHelper.GetChildrenCount(parentObject);
            for (int i = 0; i < totalChild; i++)
            {
                DependencyObject childObject = VisualTreeHelper.GetChild(parentObject, i);

                if (childObject is FrameworkElement &&
                    ((FrameworkElement)childObject).Name == childName)
                {
                    element = childObject as UIElement;
                    break;
                }

                // get its child
                element = GetChildControl(childObject, childName);
                if (element != null) break;
            }
        }

        return element;
    } 
```

但是由于缺乏对 WPF 的了解，我不知道应该传递给该方法的 ItemCollection 是什么。

任何建议或教程将不胜感激。

假期愉快

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T01:30:34.877

在 XAML 中，您可以将 Name 属性添加到 TreeView：

```
<Grid>
    <TreeView Name="MyAwesomeTreeView" Margin="25,186,22,46">
        <TreeViewItem Header="Taxonomy Tree" x:Name="_TaxTree" x:FieldModifier="private">
            <TreeViewItem Header="Loading..." TextBlock.FontStyle="Italic"></TreeViewItem>
        </TreeViewItem>
    </TreeView>
</Grid> 
```

现在您可以像这样在代码隐藏中访问此树视图的项目：

```
ItemCollection myDataItems = MyAwesomeTreeView.Items
GetSelectedCheckBoxes(myDataItems, MyAwesomeTreeView); 
```

但是，您展示的方法不适用于带有数据模板的 TreeView。原因是 TreeView 只会在 TreeViewItems 在屏幕上真正可见时才生成它们。在那之前，它只包含基础数据。要解决这个问题，您需要使用 TreeView 的 ItemContainerGenerator。将您的复选框方法修改为：

```
private List<CheckBox> GetSelectedCheckBoxes(ItemCollection items, ItemsControl source)
{
    var list = new List<CheckBox>();
    foreach (object dataitem in items)
    {
        UIElement treeviewitem = source.ItemContainerGenerator.ContainerFromItem(dataitem)
        UIElement element = GetChildControl(treeviewitem, "chk");
        if (element != null)
        {
            var chk = (CheckBox)element;
            if (chk.IsChecked.HasValue && chk.IsChecked.Value)
            {
                list.Add(chk);
            }
        }

        List<CheckBox> l = GetSelectedCheckBoxes(item.Items, treeviewitem);
        list = list.Concat(l).ToList();
    }

    return list;
} 
```

但我想强调的是，这不是一个好的做事方式。我敢打赌，你想要实现的目标可以通过更简单、直接和可维护的方式实现，所以我建议你先解释一下它是什么。

# c++ - 使用可选参数重载 new 和 delete 运算符

> ID：13503902
> 
> 赞同：7
> 
> 时间：2012-11-21T23:46:51.767
> 
> 标签：c++, operator-overloading, new-operator, delete-operator

```
#include <new>
#include <cstdlib>
#include <iostream>
#include <stdexcept>

struct foo {};

inline void* operator new(size_t size, foo*) throw (std::bad_alloc)
{
    std::cout << "my new " << size << std::endl;
    return malloc(size);
}

inline void operator delete(void* p, foo*) throw()
{
    std::cout << "my delete" << std::endl;
    free(p);
}

int main()
{
    delete new((foo*)NULL) foo;
} 
```

输出（[通过ideone](http://ideone.com/bU6sNP)）：

```
my new 1 
```

我的想法是 C++ 会释放一个带有附加参数的新对象，并匹配删除相同的参数，但我显然是不正确的。

让上面的代码调用我的重载删除的正确方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T23:52:48.450

当您使用任何形式的放置 new（版本除外）时`std::nothrow_t`，您需要显式销毁对象并以您认为合适的任何方式释放其内存。但是，仍然需要存在的重载版本`operator delete()`，因为如果对象的构造引发异常，则使用它！在这种情况下，不会返回指针，因为抛出了异常。因此，在这个分配过程中必须摆脱内存。

也就是说，您`main()`应该看起来像这样：

```
int main()
{
    foo* p = new (static_cast<foo*>(0)) foo;
    p->~foo();
    operator delete(p, static_cast<foo*>(0));
} 
```

# r - 将两个因素合二为一？

> ID：13503908
> 
> 赞同：2
> 
> 时间：2012-11-21T23:47:34.113
> 
> 标签：r, factors

> **可能重复：**
> [R中两列的连接因子水平](https://stackoverflow.com/questions/4855425/joining-factor-levels-of-two-columns-in-r)

我对 R 相当陌生，我正在努力使我的重新编码脚本更有效和“正确”。我已经尝试搜索论坛，但这让我一无所获 - 也许我使用了错误的术语并错过了它，所以如果问题已经提出，请多多包涵。

我有两个因子变量，我希望将它们合并为一个因子变量。它们来自同一个调查，都衡量教育水平。首先我有两个变量的原因是不幸的调查结构，但这不是重点。要说明的要点是它们是相互排斥的（你只能在一个中）。

**我的数据如下所示：**

```
education       education2
9th grade       <NA>
9th grade       <NA>
<NA>            9th grade
<NA>            10th grade
10th grade      <NA>
11th grade      <NA>
<NA>            9th grade
<NA>            11th grade
<NA>            <NA> 
```

**我的脚本如下所示：**

```
highest.edu     <- vector(length=length(df$education))
a.grade       <- which(df$education=="9th grade")
a.grade2      <- which(df$education2=="9th grade")
b.grade      <- which(df$education=="10th grade")
b.grade2     <- which(df$education2=="10th grade")
c.grade      <- which(df$education=="11th grade")
c.grade2     <- which(df$education=="11th grade")

highest.edu[a.grade]      <- as.character(df$education)[a.grade]
highest.edu[a.grade2]     <- as.character(df$education2)[a.grade2]
highest.edu[b.grade]     <- as.character(df$education)[b.grade]
highest.edu[b.grade2]    <- as.character(df$education2)[b.grade2]
highest.edu[c.grade]     <- as.character(df$education)[c.grade]
highest.edu[c.grade2]    <- as.character(df$education2)[c.grade2]

highest.edu  <- factor(highest.edu)
highest.edu[highest.edu =="FALSE"] =NA
highest.edu  <- factor(highest.edu) 
```

当然，这还不错，但是当您有两个具有 15 个级别的因子变量几次或更多次时，您就会开始寻找更快的替代方案。

**我尝试过这样的事情，但没有任何运气：**

```
a.grade   <- which(df$education=="9th grade" | df$education2=="9th grade")
b.grade  <- which(df$education=="10th grade" | df$education=="10th grade")
c.grade  <- which(df$education=="11th grade" | df$education2=="11th grade")

highest.edu[a.grade]      <- as.character(df$education)  
[a.grade]|as.character(df$education2)[a.grade]
highest.edu[b.grade]      <- as.character(df$education)          
[b.grade]|as.character(df$education2)[b.grade] 
```

**给我这个：** as.character(df$education)[9 年级] 中的错误 | as.character(df$education2)[9th Grade]：只能对数字、逻辑或复杂类型进行操作

有没有办法克服这个问题？

感谢您提前提出任何建议

## 编辑：

**我的目标是这样的：**

```
highest.education
9th grade
9th grade
9th grade
10th grade
10th grade
11th grade
9th grade
11th grade
<NA> 
```

帖子：“R 中两列的连接因子水平”似乎是为了另一个结果

再次谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:54:46.283

您必须确保结果中存在所有因子水平：

```
levels(education) <- c(levels(education), levels(education2))
education[is.na(education)] <- education2[is.na(education)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T01:01:40.147

一旦它们是字符串，就很容易了

```
# make them character types
ed <- levels(df$education)[df$education]
ed2 <- levels(df$education2)[df$education2]
# make one new factor that integrates them
ed[is.na(ed)] <- ed2[is.na(ed)]
# make it a factor again
ed <- factor(ed) 
```

您可以通过首先将它们作为字符读入来加速该过程，特别是如果您已经在`read.table`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:58:12.240

基本上，您需要确保关卡既是独特关卡的“联合”或“交集”，并且顺序相同，然后您可以使用`c`. 搜索：[r] 因子联合级别。

# java - 电网计时问题

> ID：13503911
> 
> 赞同：0
> 
> 时间：2012-11-21T23:47:48.223
> 
> 标签：java, timer, grid

我正在沿着“网格”移动形状。我似乎终于弄清楚了，但是我遇到了一个小问题；无论我尝试获得每个动作之间的特定时间间隔有多近，似乎仍然脱离了网格。我想使用我正在使用的当前方法，因为我了解这些人是如何以这种方式工作的。我知道它有时会出现随机移动“故障”，因为如果我将它向后移动第四次，无论如何它都应该锁定在网格上。这是我的代码（对不起，我只是在测试代码，没有评论和奇怪的放置）：

主类：

```
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import javax.swing.JFrame;

public class WhyOhWhy {
public int x;
public int y;

public static void main(String[] args) {

    JFrame f = new JFrame();
    InputHandler input = new InputHandler();
    f.add(input);
    f.setVisible(true);
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.setSize(800,600);
    input.doStuff();
    }
} 
```

输入处理类：

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.awt.geom.*;
import java.util.logging.Level;
import java.util.logging.Logger;

public class InputHandler extends JPanel implements ActionListener, KeyListener {

Timer t = new Timer(5, this);
int x = 0, y = 0, velX = 0, velY = 0;
int i = 0, j = 0;
TimeKeeper timeStart;

public void doStuff(){
    velX = 0;
    velY = 0;
}
public InputHandler() {
    t.start();
    addKeyListener(this);
    setFocusable(true);
    setFocusTraversalKeysEnabled(false);
}

public void paintComponent(Graphics g) {
    super.paintComponent(g);
    Graphics2D g2 = (Graphics2D) g;
    g2.fill(new Ellipse2D.Double(x, y, 32, 32));
    for(int i = 0;i <500;i+=32){
        g2.drawRect(i, j, 32, 32);
        for(int j=0;j<500;j+=32){
            g2.drawRect(i, j, 32, 32);
        }
    }
}

public void actionPerformed(ActionEvent e) {

    repaint();
    x += velX;
    y += velY;

    if(TimeKeeper.isFinished() == true){
        System.out.println("DONE");
        TimeKeeper.resetTimer(false);
        velX = 0;
        velY = 0;
        setEnabled(true);
    }
}

public void up() {
    //System.out.println("Moving up");

    timeStart = new TimeKeeper(185);
    velY = -1;
    velX = 0;
    setEnabled(false);
}

public void down() {
    //System.out.println("Moving down");
    setEnabled(false);
    timeStart = new TimeKeeper(185);
    velY = 1;
    velX = 0;
}

public void left() {
    //System.out.println("Moving left");
    setEnabled(false);
    timeStart = new TimeKeeper(185);
    velY = 0;
    velX = -1;
}

public void right() {
    //System.out.println("Moving right");
    setEnabled(false);
    timeStart = new TimeKeeper(185);
    velY = 0;
    velX = 1;
}

public void keyPressed(KeyEvent e) {

    int code = e.getKeyCode();
    if (code == KeyEvent.VK_W) {
        up();
        }
    if (code == KeyEvent.VK_S) {   
        down();
        }
    if (code == KeyEvent.VK_A) {
        left();
        }
    if (code == KeyEvent.VK_D) {
        right();
        }
    }

public void keyTyped(KeyEvent e) {
    }

public void keyReleased(KeyEvent e) {
    velX = 0;
    velY = 0;
    }
} 
```

计时员类：

```
import java.util.Timer;
import java.util.TimerTask;

public class TimeKeeper {

Timer timer;
public static boolean isDone = false;

public TimeKeeper(int seconds) {

    timer = new Timer();
    isDone = false;
    timer.schedule(new RemindTask(), seconds );
}

class RemindTask extends TimerTask {

    public void run() {
        //System.out.println("Time's up!");
        isDone = true;
        timer.cancel(); //Terminate the timer thread
    }
}

public static boolean isFinished() {
    return isDone;
}

public static void resetTimer(boolean done) {
    isDone = done;
}
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:05:31.003

没关系，想通了。需要使用 % 运算符来查看形状移动的数字是否在 x 和 y 方向上每一步都可被 32 整除。

# c# - 共享资源锁

> ID：13503912
> 
> 赞同：4
> 
> 时间：2012-11-21T23:47:50.743
> 
> 标签：c#, asp.net, thread-safety, asp.net-web-api

我在 .NET 4.5 - Web API Self Host 上使用 C#。服务器端我有一个不是线程安全的进程：它一次只能处理一个请求。如何在控制器代码中锁定此资源（进程），以便按顺序为客户端提供服务，等待资源在使用前被释放？就像是：

```
while(true){
    if(!process.isLocked)
        break;
}

lock(process)
do(work)
unlock(process)
warn(others) 
```

任何代码片段或建议表示赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T00:08:12.520

如果您正在寻找要执行的每个线程，但一次只执行一个，那么您可以将`lock`语句与静态对象一起使用：

```
private static object lockobj = new object();

public void DoWorkWhenNotBusy()
{
    lock (lockobj)
    {
        // do work
        Console.WriteLine("Working #1 (should always complete)...");
        Thread.Sleep(500);
    }
} 
```

如果您希望线程在对象被锁定时立即返回，那么您可以这样写（双重检查锁定）：

```
private static object lockobj2 = new object();
private volatile bool locked = false;

public void DoWorkIfNotBusy()
{
    if (!locked)
    {
        lock (lockobj2)
        {
            if (!locked)
            {
                locked = true;
                // do work
                Thread.Sleep(500);
                Console.WriteLine("Working #2 (only if not busy)...");
            }
            locked = false;
        }
    }
} 
```

测试示例：

```
for (int i = 0; i < 10; i++)
{
    var ts = new ThreadStart(DoWorkWhenNotBusy);
    Thread t = new Thread(ts);
    t.Start();

    var ts2 = new ThreadStart(DoWorkIfNotBusy);
    Thread t2 = new Thread(ts2);
    t2.Start();

    Console.WriteLine("{0} started", i);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T00:57:47.797

我想在这里扩展 dbaseman 的答案。具体来说，他的`DoWorkIfNotBusy`方法。

我认为这是一个不好的例子（由于可能的竞争条件），并且想展示我认为正确的方式是：

```
private static readonly object lockobj = new object();

public bool DoWorkIfNotBusy()
{
    bool lockWasTaken = false;
    var temp = lockobj;
    try
    {
        Monitor.TryEnter(temp, ref lockWasTaken);

        if (lockWasTaken) // This crucial test was missing! (Added 2021-04-08)
        {
            //Do work here.. 
        }
    }
    finally
    {
        if (lockWasTaken) Monitor.Exit(temp);
    }
    return lockWasTaken;
} 
```

* * *

2021-04-08 更新：增加了当前线程是否成功获取锁的测试。如果不是，则不应执行关键部分中的代码。

* * *

2021-04-09 更新：下面的代码显示需要检查`lockWasTaken`，作为单元测试。

```
[TestClass]
public class DummyTests
{
    private static readonly object LockObj = new object();

    [TestMethod]
    public void TestMonitor()
    {
        Thread trd1 = StartThread();
        Thread.Sleep(100);
        Thread trd2 = StartThread();
        Thread.Sleep(1000);
        Thread trd3 = StartThread();

        while (trd1.IsAlive || trd2.IsAlive || trd3.IsAlive)
        {
            Thread.Sleep(100);
        }
    }

    private Thread StartThread()
    {
        var thread = new Thread(parameter => this.ThreadTask());
        thread.Start(nameof(thread));
        Trace.WriteLine($"Started thread {thread.ManagedThreadId}.");
        return thread;
    }

    private void ThreadTask()
    {
        bool lockAcquired = false;
        try
        {
            Monitor.TryEnter(LockObj, ref lockAcquired);
            if (lockAcquired)
            {
                Trace.WriteLine($"Lock acquired by thread {Thread.CurrentThread.ManagedThreadId}.");
                Thread.Sleep(1000);
            }
            else
            {
                Trace.WriteLine($"Lock denied to thread {Thread.CurrentThread.ManagedThreadId}.");
            }
        }
        finally
        {
            if (lockAcquired)
            {
                Monitor.Exit(LockObj);
                Trace.WriteLine($"Lock released by thread {Thread.CurrentThread.ManagedThreadId}.");
            }
        }
    }
} 
```

输出将是这样的：

```
Started thread 12.
Lock acquired by thread 12.
Started thread 13.
Lock denied to thread 13.
Lock released by thread 12.
Started thread 14.
Lock acquired by thread 14.
Lock released by thread 14. 
```

# javascript - 一次性转换类

> ID：13503924
> 
> 赞同：2
> 
> 时间：2012-11-21T23:49:56.713
> 
> 标签：javascript, jquery, class

我有四个班级`show`，，，`hide1`和`hide2`。`hide3`我想更改这些类中的每一个并将其替换为它旁边的类。换句话说，我的 jQuery 代码看起来像这样......

```
$(".show").removeClass("show").addClass("hide1");
$(".hide1").removeClass("hide1").addClass("hide2");
$(".hide2").removeClass("hide2").addClass("hide3");
$(".hide3").removeClass("hide3").addClass("show"); 
```

问题是这四个班级最终都有我不想要的表演班。我只希望 show 类转换为 hide1，hide1 转换为 hide2 等。我如何编写代码以使这四行同时发生，而不是一次发生一行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:52:57.050

只需先选择每个组，然后更改：

```
// read
var $show = $('.show');
var $hide1 = $('.hide1');
var $hide2 = $('.hide2');
var $hide3 = $('.hide3');

// write
$show.removeClass('show').addClass('hide1');
$hide1.removeClass('hide1').addClass('hide2');
$hide2.removeClass('hide2').addClass('hide3');
$hide3.removeClass('hide3').addClass('show'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:54:10.230

这样做，

```
function circulateClass(c){
    var i, cl=[];
    for(i=0;i<c.length;i++)
        cl[c[i]]=$("."+c[i]);

    for(i=0;i<c.length;i++)
        cl[c[i]].removeClass(c[i]).addClass(c[(i+1)%c.length]));
}

circulateClass(["show","hide1", "hide2", "hide3"]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T00:04:36.373

如果您将类保存在这样的数组中：

```
var classes = ['show','hide1','hide2','hide3']; 
```

你可以做这样的花哨的事情：

```
$('.'+classes.join(',.')).attr('class', function(i) {
   return classes[i+1] || classes[0];
});​ 
```

演示：http: [//jsfiddle.net/7DuEV/](http://jsfiddle.net/7DuEV/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T23:54:03.400

换个顺序就行了...

```
$(".show").removeClass("show").addClass("hide1");
$(".hide3").removeClass("hide3").addClass("show");
$(".hide2").removeClass("hide2").addClass("hide3"); 
```

对于最后一个，按类名过滤：

```
$(".hide1").filter(function(){
    return !$(this).hasClass('show');
}).removeClass("hide1").addClass("hide2"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T00:04:42.520

## *[jsBin 演示](http://jsbin.com/atufiz/1/edit)*

```
c = 0; // zero based index n (set initial one)

var $el = $( '#parent' ).find( 'div' );
$el.hide().eq( c ).show();

$( '#button' ).click( function() {
   $el.hide().eq( ++c % $el.length ).show(); 
}); 
```

# java - Java 套接字 - 本地端口

> ID：13503929
> 
> 赞同：10
> 
> 时间：2012-11-21T23:50:42.417
> 
> 标签：java, sockets

我正在学习使用 Java 进行套接字编程。我使用以下语句连接到网站：

```
s = new Socket("www.nba.com", 80); 
```

当我调试应用程序并查看 s 的内容时，我看到：

```
Socket[addr=www.nba.com/2.21.246.97,port=80,localport=7846] 
```

1）我想知道这个本地端口 7846 来自哪里以及它到底是什么。

2) 如果网站的 IP 地址是 2.21.246.97，为什么我在浏览器的地址栏中输入 2.21.246.97 就无法连接到网站？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T23:53:00.857

它是一个本地套接字端口号。它通常由系统分配。

请参阅[什么是套接字？](http://docs.oracle.com/javase/tutorial/networking/sockets/definition.html).

> 在客户端：客户端知道服务器正在运行的机器的主机名和服务器正在侦听的端口号。为了发出连接请求，客户端尝试在服务器的机器和端口上与服务器会合。客户端还需要向服务器标识自己，以便绑定到将在此连接期间使用的本地端口号。**这通常由系统分配。**

至于第二个问题：

我假设这个 IP 地址是您在查找时通过 DNS 服务器获得的`www.nba.com`（我的不同）。问题可能是该地址的 HTTP 服务器服务于多个虚拟主机和/或它关心`Host`您的浏览器发送的标头。在您的情况下，它是 IP 地址而不是`www.nba.com`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-17T13:43:04.043

`local port`只不过是一个套接字描述符（或一个非常高编号的端口）

每当一个进程进行 API 调用时，该请求通过内核创建一个套接字描述符，以便绑定（并识别）这个特定请求的响应。任何出站调用都会导致创建一个套接字，当响应到达 NIC（网络接口）然后到达内核时，内核会计算出此响应的目标应用程序。

这是通过检查与正在运行的进程 (pid) 具有一对一映射的端口来完成的。然后它检查响应元数据中附加的套接字描述符值（该值在创建连接时传递）并将响应流发送到套接字缓冲区。

然后 CPU 唤醒进程以收集响应。

所以回答你的主要问题，

*   `local port`只不过是一个`socket descriptor`
*   理想情况下，如果没有虚拟化并且您拥有硬件，那么您应该能够做到。通过ip连接到它。但通常情况并非如此，很多 NAT（网络地址转换）可能会阻止这种情况发生

尝试，`ls -li /proc/<pid>/fd/`查看所有打开的套接字描述符
，您的应用程序进程 ID 在哪里

# php - PHP套接字标准输入附加到接收到的数据

> ID：13503933
> 
> 赞同：2
> 
> 时间：2012-11-21T23:50:48.870
> 
> 标签：php, sockets, select, stdin

我在 PHP 中使用套接字来创建一个简单的基于命令行的聊天。它工作正常，但有一个主要问题使它几乎无法使用。当聊天中有多个人并且一个人正在键入消息而另一个人发送消息时，键入消息的人会收到附加到他们正在键入的内容的消息。有没有办法解决？我正在使用标准输入和流选择。下面是客户的一段话：

```
$uin = fopen("php://stdin", "r");
while (true) {
  $r = array($socket, $uin);
  $w = NULL;
  $e = NULL;

  if (0 < stream_select($r, $w, $e, 0)) {
    foreach ($r as $i => $fd) {
      if ($fd == $uin) {
        $text = (fgets($uin));
        fwrite($socket, $text);
      } else {
        $text = fgets($socket);
        print $text;
      }
    }
  }
} 
```

感谢所有帮助！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T23:51:41.647

每次在 $socket 中等待完整字符串时，代码都会向标准输出输出一条消息。

解决这个问题的唯一方法是将文本放入变量 ($outtext) 而不是打印它。然后，您可以在准备阅读时显示它，例如在写入传出套接字之前...

```
$uin = fopen("php://stdin", "r");
while (true) {
  $r = array($socket, $uin);
  $w = NULL;
  $e = NULL;
  $outtext = '';

  if (0 < stream_select($r, $w, $e, 0)) {
    foreach ($r as $i => $fd) {
      if ($fd == $uin) {
        $text = (fgets($uin));
        print $outtext;
        $outtext = '';
        fwrite($socket, $text);
      } else {
        $text = fgets($socket);
        $outtext .= $text;
      }
    }
  }
} 
```

缺点是它只会在您按下回车时显示传入的文本。解决这个问题的唯一方法是使用 fgets() 以外的东西。

我假设这只是一个实验——使用 Node.js 或类似的事件驱动编程对于这类事情会好得多。

# android - 基于 Fragments 在 ActionBar 下方滑动标签

> ID：13503937
> 
> 赞同：0
> 
> 时间：2012-11-21T23:51:33.163
> 
> 标签：android, tabs, android-actionbar, swipe

在我的应用程序中，我想在操作栏下方实现一些选项卡，这些选项卡应该是可滑动的（如 SongKick 应用程序）。我还在我的应用程序的其余部分使用片段，所以解决方案也应该基于片段。我对这种 UI 模式有点困惑，因为我不知道应该使用哪些组件来实现它。关于兼容性，这个解决方案也可以基于Android兼容库吗？有人可以建议一些资源/教程吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:00:55.707

您可以使用 ActionBar 选项卡（以及 ActionBarSherlock 选项卡以确保向后兼容性）并通过在 ViewPager 上使用 PageChangeListener 来实现滑动：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    ...
    mViewPager.setOnPageChangeListener(
            new ViewPager.SimpleOnPageChangeListener() {
                @Override
                public void onPageSelected(int position) {
                    // When swiping between pages, select the
                    // corresponding tab.
                    getActionBar().setSelectedNavigationItem(position);
                }
            });
    ...
} 
```

您可以阅读并从[此处](http://developer.android.com/training/implementing-navigation/lateral.html#swipe-tabs)下载示例项目。

# parameters - Why does the value of the parameter to this F# function seem to change to 0?

> ID：13503938
> 
> 赞同：2
> 
> 时间：2012-11-21T23:51:35.280
> 
> 标签：parameters, f#, matching

I'm trying to write a recursive function for building a specialized card deck. The first parameter, numOfCards is supposed to be the number of cards in the deck. The sourceDeck is a list of possible cards that can be used to build the deck and the currentDeck is my accumulator, which results in the final list of cards.

However, the problem I have is that when I send in a number value for numOfCards it gets set to 0 in the match statement. Or at least that's how it looks. I tried stepping through with the debugger, and when I enter the function, the value is correct. As soon as I start executing the match, however, it suddenly becomes 0, both if I hover over the value in the match and over the value in the parameters (which is at least consistent).

As such, the match triggers on 0 and just returns the empty currentDeck, rather than iterating.

Any tips on this one? Probably something simple, but I'm stumped. :)

```
let rec buildDungeon (numOfCards, sourceDeck : List<Card>, currentDeck : List<Card>) =
  match currentDeck.Length with
    | numOfCards  -> currentDeck
    | _           -> buildDungeon (numOfCards, sourceDeck, newCard(sourceDeck)::currentDeck) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T23:56:06.107

If you want to handle a case when `currentDeck.Length` *equals* `numOfCards` then you need to write:

```
let rec buildDungeon (numOfCards, sourceDeck : List<Card>, currentDeck : List<Card>) =
  match currentDeck.Length with
  | n when n = numOfCards -> currentDeck
  | _ -> buildDungeon (numOfCards, sourceDeck, newCard(sourceDeck)::currentDeck) 
```

The problem is that when you write a clause `| numOfCards -> (...)`, the pattern matching binds the value of `currentDeck.Length` to the symbol `numOfCards` (and the newly defined `numOfCards` value hides the previous value of the same name - that is, the value you got as a parameter).

The pattern matching I wrote above binds `currentDeck.Length` to a *new* symbol `n` and then checks that `n = numOfCards` (referring to the `numOfCards` passed as an argument).

So, pattern matching is not really the best tool for checking equality - and your code could be probably more easily written using normal `if`:

```
let rec buildDungeon (numOfCards, sourceDeck : List<Card>, currentDeck : List<Card>) =
  if currentDeck.Length = numOfCards then currentDeck
  else buildDungeon (numOfCards, sourceDeck, newCard(sourceDeck)::currentDeck) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:55:33.880

The `numOfCards` in the `match` expression is not the same as the one in the parameters: it's a new variable that's *shadowing* the old one. Since it's an unbounded variable pattern, it will match anything at all and bind itself to that thing. Thus, the second (wildcard) pattern is never reached, because the first one never fails.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T00:01:58.557

As far as I understand pattern matching in F# you should use

```
let rec buildDungeon (numOfCards, sourceDeck : List<Card>, currentDeck : List<Card>) =
  match currentDeck.Length with
  | n when n = numOfCards -> currentDeck
  | _ -> buildDungeon (numOfCards, sourceDeck, newCard(sourceDeck)::currentDeck) 
```

By specifying the pattern sort of create new variables (n in this example). You are not using the already defined.

# vb.net - VB.NET - 如何拆分字符串？

> ID：13503939
> 
> 赞同：0
> 
> 时间：2012-11-21T23:51:40.263
> 
> 标签：vb.net, string, visual-studio, split

在我的表单中，我在 var 中存储/创建一个命令行参数，以便稍后通过控制按钮使用它，以启动一个外部应用程序，并将该参数存储在我的 var 中，并且 var 内容是这样的字符串：

```
ExternalAPP.exe "Argument 1" "argument 2" "argument 3" "more arguments" 
```

PS：参数是对文件夹路径的引用。

我需要做的是拆分 var 以获取所有文件夹路径（参数），并制作如下内容：

```
' Pseudocode
For each folder in var.split(ControlChars.Quote)
    for each file in get.folder.files
     appendline.(new_text_file, file.Name)
  Next 
```

谢谢如果有人帮助我

**更新**：我需要拆分的 VAR 内容正是这样的：

> "F:-=Temporal=-\Documentos\DVD Temazos\Rock" "F:-=Temporal=-\Documentos\DVD Temazos\Techno" "F:-=Temporal=-\Documentos\DVD Temazos\Pop"

**请注意，论坛没有在驱动器字母 F 之后粘贴斜线 \：**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:00:47.330

试试这个

```
dim Var As String = Command.exe "Argument 1" "argument 2" "argument 3" "more arguments"

dim entries = Var.Split(" "c)

For i As Integer = 1 To entries.Length - 1
   dim files As String() = Directory.GetFiles(entries(i))
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T00:00:57.763

您的示例代码没有多大意义。它应该是命令行还是VB源代码？

但是，您似乎需要一个正则表达式来查找引号内的每个字符串。

正则表达式很难正确构建。我建议构建一个简单的正则表达式验证器，或者使用其中一个基于 Web 的验证器。

你的表达将是这样的（我不会验证这一点）：

```
.*(\"(?<filepath>[^"])\")*.* 
```

您将需要获取文件路径的所有匹配组值。

如果你控制你的程序输入，那么制作一个更容易解析的更友好的语法似乎是合适的。

如果这些是命令行参数，则命令 shell 将为您解析每个引用的参数，并且主例程的参数将包含它们。

我是一个 C# 人，所以一个快速的谷歌给了我这个：

子主（）

```
 Dim s() As String = System.Environment.GetCommandLineArgs()

  Console.WriteLine(s(1)) 
```

结束子

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T00:17:52.370

如果您要完成的是解析命令行参数，请尝试以下操作：

```
Dim files() As String = System.Environment.GetCommandLineArgs() 
```

[http://msdn.microsoft.com/en-us/library/system.environment.getcommandlineargs.aspx](http://msdn.microsoft.com/en-us/library/system.environment.getcommandlineargs.aspx)

这一行：

```
Var = Command.exe "Argument 1" "argument 2" "argument 3" "more arguments" 
```

可能不会做你想做的事。双引号字符需要将整个字符串括起来并进行转义：

```
Var = "Command.exe ""Argument 1"" ""argument 2"" ""argument 3"" ""more arguments""" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T06:49:50.870

你应该尝试这样的事情：

```
 Dim var As String = "Command.exe ""F:-=Temporal=-\Documentos\DVD Temazos\Rock"" ""F:-=Temporal=-\Documentos\DVD Temazos\Techno"" ""F:-=Temporal=-\Documentos\DVD Temazos\Pop"""
    var = var.Replace(":", ":\").Remove(0, var.IndexOf(" ") + 2)
    Dim dirs As New List(Of String)(var.Split(New String() {""" """}, StringSplitOptions.RemoveEmptyEntries))
    Dim files As New List(Of String)()

    For Each path As String In dirs
        Try
            If (Directory.Exists(path)) Then
                files.AddRange(Directory.GetFiles(path))
            Else
                Debug.Print(path & "path does not exists") ' check "Output Window"
            End If
        Catch ex As Exception
            Debug.Print(path & ": exception :" & ex.Message)  ' check "Output Window"
        End Try
    Next 
```

编辑：

我刚刚在您的问题中注意到了这一点：

```
NOTICE THAT THE FORUM DOES NOT PASTED THE SLASH \ AFTER DRIVE LETTER F: 
```

# javascript - 绝对定位块针对文档中的任何元素

> ID：13503941
> 
> 赞同：0
> 
> 时间：2012-11-21T23:52:11.773
> 
> 标签：javascript, css, html, css-position

示例代码：http: [//jsfiddle.net/ZAm2A/3/](http://jsfiddle.net/ZAm2A/3/)

`div.absolute-block`目标是针对（相对于）具有不同 html 结构的任何页面上的任何 dom 元素定位某个 popup( ) 窗口。为了能够绝对定位弹出窗口，我们需要将其嵌入到该 dom 元素中，之前已将 div.absolute-block 与相对或绝对定位的块包装在一起（`div.relative1`在我们的示例中）。
问题是，如果我们嵌入弹出窗口的 dom 元素`div.overflow1`在它的祖先中有带有 overfillw: hidden ( ) 的块，`div.overflow1`则可能会裁剪弹出窗口。 `div.overflow1`可能是相对定位的，我们无法在我们的情况下影响它。

第二种方法是将我们的弹出窗口附加到页面正文。在这种情况下，我们面临将弹出窗口相对于某个 dom 元素定位的问题。我们可以计算和设置文档就绪事件的弹出窗口的顶部和左侧属性。但是在调整窗口大小、ajax 内容更改或任何事件更改跟踪元素的位置的情况下，我们必须重新计算弹出位置。

我认为是否有一些新的 html 5 功能可以让我定位弹出窗口而不将其嵌入到 dom 元素中，我想相对于弹出窗口定位？任何其他想法表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:02:48.103

没有办法让子元素转义已`overflow`设置为的父元素`hidden`。如果你想让一个元素精确定位在页面上某个元素的顶部，你最安全的选择是把它放在文档的根部，使用 Javascript 计算和调整位置，并更新窗口调整大小等. 您可能有兴趣使用 jQuery 的[`position()`](http://api.jquery.com/position/)（相对于父级）或[`offset()`](http://api.jquery.com/offset/)（相对于整个文档）方法来帮助计算这一点。

此外，这里有一个与此问题相关的`overflow: hidden`问题，可能会有所帮助： [让孩子在溢出之外可见：隐藏的父母](https://stackoverflow.com/q/3387489/626682)

# java - Spring Security 请求匹配器不适用于正则表达式

> ID：13503944
> 
> 赞同：1
> 
> 时间：2012-11-21T23:52:16.627
> 
> 标签：java, regex, spring-security

使用 Spring MVC + Security 我有一个业务需求，即来自 SEC（安全团队）的用户对应用程序具有完全访问权限，而 FRAUD（反欺诈团队）只能访问 URL**不**包含“*块*”或“ *update* " 不区分大小写。

*下面是spring-security.xml*中使用的正则表达式的测试（我不是正则表达式专家，欢迎改进 =]）：

```
import java.util.Arrays;
import java.util.List;

public class RegexTest {

    public static void main(String[] args) {

        List<String> pathSamples = Arrays.asList(
                "/index",
                "/index.*",
                "/index/",
                "/cellphone/block",
                "/cellphone/block.*",
                "/cellphone/block/",
                "/cellphone/confirmBlock",
                "/cellphone/confirmBlock.*",
                "/cellphone/confirmBlock/",
                "/user/update",
                "/user/update.*",
                "/user/update/",
                "/user/index",
                "/user/index.*",
                "/user/index/",
                "/search",
                "/search.*",
                "/search/",
                "/doSearch",
                "/doSearch.*",
                "/doSearch/");

        for (String pathSample : pathSamples) {
            System.out.println("Path sample: " + pathSample
                    + " - SEC: " + pathSample.matches("^.*$")
                    + " | FRAUD: " + pathSample.matches("^(?!.*(?i)(block|update)).*$"));
        }
    }
} 
```

Bellow，上面Java类的控制台结果：

```
Path sample: /index - SEC: true | FRAUD: true
Path sample: /index.* - SEC: true | FRAUD: true
Path sample: /index/ - SEC: true | FRAUD: true
Path sample: /cellphone/block - SEC: true | FRAUD: false
Path sample: /cellphone/block.* - SEC: true | FRAUD: false
Path sample: /cellphone/block/ - SEC: true | FRAUD: false
Path sample: /cellphone/confirmBlock - SEC: true | FRAUD: false
Path sample: /cellphone/confirmBlock.* - SEC: true | FRAUD: false
Path sample: /cellphone/confirmBlock/ - SEC: true | FRAUD: false
Path sample: /user/update - SEC: true | FRAUD: false
Path sample: /user/update.* - SEC: true | FRAUD: false
Path sample: /user/update/ - SEC: true | FRAUD: false
Path sample: /user/index - SEC: true | FRAUD: true
Path sample: /user/index.* - SEC: true | FRAUD: true
Path sample: /user/index/ - SEC: true | FRAUD: true
Path sample: /search - SEC: true | FRAUD: true
Path sample: /search.* - SEC: true | FRAUD: true
Path sample: /search/ - SEC: true | FRAUD: true
Path sample: /doSearch - SEC: true | FRAUD: true
Path sample: /doSearch.* - SEC: true | FRAUD: true
Path sample: /doSearch/ - SEC: true | FRAUD: true 
```

# 测试

## 方案 1

*贝娄， spring-security.xml*的重要部分：

```
<security:http entry-point-ref="entryPoint" request-matcher="regex">

    <security:intercept-url pattern="^.*$" access="ROLE_SEC" />
    <security:intercept-url pattern="^(?!.*(?i)(block|update)).*$" access="ROLE_FRAUD" />

    <security:access-denied-handler error-page="/access-denied.html" />

    <security:form-login always-use-default-target="false"
        login-processing-url="/doLogin.html"
        authentication-failure-handler-ref="authFailHandler"
        authentication-success-handler-ref="authSuccessHandler" />
    <security:logout logout-url="/logout.html"
        success-handler-ref="logoutSuccessHandler" />
</security:http> 
```

行为：

*   FRAUD 组**不能”访问任何页面
*   SEC小组工作正常

## 方案 2

**请注意**，我只在下面的*spring-security.xml*中更改了*intercept-url*的顺序：

 *```
<security:http entry-point-ref="entryPoint" request-matcher="regex">

    <security:intercept-url pattern="^(?!.*(?i)(block|update)).*$" access="ROLE_FRAUD" />
    <security:intercept-url pattern="^.*$" access="ROLE_SEC" />

    <security:access-denied-handler error-page="/access-denied.html" />

    <security:form-login always-use-default-target="false"
        login-processing-url="/doLogin.html"
        authentication-failure-handler-ref="authFailHandler"
        authentication-success-handler-ref="authSuccessHandler" />
    <security:logout logout-url="/logout.html"
        success-handler-ref="logoutSuccessHandler" />
</security:http> 
```

行为：

*   SEC 组**不能”访问任何页面
*   FRAUD 组工作正常

## 结论

我做错了什么或弹簧安全有错误。

问题已经以非常糟糕的方式解决了，但我需要尽快解决。任何人都知道一些技巧可以在不打开框架代码的情况下更好地调试它？

干杯，

费利佩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T21:32:49.827

第一个配置是错误的，因为通用匹配器是第一个，所以第二个将被忽略。第二个配置将从第一个匹配的任何内容中排除 SEC 角色，所以听起来你想要更像

```
<intercept-url pattern="^(?!.*(?i)(block|update)).*$" access="ROLE_FRAUD,ROLE_SEC" />
<intercept-url pattern="^.*$" access="ROLE_SEC" /> 
```

它在两种模式中都具有 SEC 属性。

如果这仍然不是您需要的，请发布相关的调试日志，显示 Spring Security 为特定请求选择属性（详细记录）并解释它与您的期望有何不同。*

# google-maps - 谷歌地图上的样式标记现在全部更改为自 2012 年 11 月 21 日以来添加的最后一个标记的样式

> ID：13503948
> 
> 赞同：2
> 
> 时间：2012-11-21T23:52:50.680
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers

我有一张调用 Gabriel Schneider StyledMarker 代码的地图。 [http://google-maps-utility-library-v3.googlecode.com/svn/trunk/styledmarker/src/StyledMarker.js](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/styledmarker/src/StyledMarker.js)

从今天开始，它们现在在地图上的行为有所不同，示例代码的行为与预期的不同。

以前，您可以添加带有“A”和“B”作为文本显示的气泡标记。现在第一个显示“A”，如果它自己创建，但如果第二个标记添加了“B”作为文本，第一个也变为“B”。（类似地改变颜色）。

使用他的简单示例来显示问题 [http://google-maps-utility-library-v3.googlecode.com/svn/trunk/styledmarker/examples/simple.htm](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/styledmarker/examples/simple.htm)

这三个标记应该不同。

有人知道怎么修这个东西吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T06:56:48.517

截至 2012 年 11 月 26 日，对 StyledMarker.js 进行了部分修复，以使其更好地与 API v3.10 配合使用。
链接：

```
<script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/styledmarker/src/StyledMarker.js"></script> 
```

然而，它只解决了 3 个问题中的 2 个：

*   标记的颜色和标记中的文本现在可以在 v3.10 中正常使用
*   但是，标记的大小仍会被添加的每个附加标记覆盖。

我为此更新了Google Maps API v3 问题跟踪器中的[错误报告](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4594)，并希望它也能尽快得到修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T00:27:16.347

发布了新版本的 Google Maps API v3。如果您指定版本 3.9，它仍然有效：

[http://www.geocodezip.com/v3_styledmarker_examples_simple_v39.html](http://www.geocodezip.com/v3_styledmarker_examples_simple_v39.html)

v3.10 不起作用：

[https://developers.google.com/maps/documentation/javascript/basics#Versioning](https://developers.google.com/maps/documentation/javascript/basics#Versioning)

除非 v3.10 和 3.11 得到修复，否则当 v3.9 在大约 6 个月内退役时，这对于使用此库的任何人来说都是一个问题……

在 Google Maps API v3 问题跟踪器中[创建问题](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4594)

# prolog - DCG 和左递归

> ID：13503953
> 
> 赞同：3
> 
> 时间：2012-11-21T23:53:05.623
> 
> 标签：prolog, dcg, left-recursion, failure-slice

我正在尝试实现一个 dcg，它采用 {a,b,c,d}* 形式的一组字符串。我遇到的问题是，如果我有一个形式为 s([a,c,b], [])，它返回 true，这是正确的答案，但是当我有一个 s([a,c,f],[]) 形式的查询时，它不返回答案并且它用完了本地堆栈。

```
s --> [].
s --> s,num.
num --> [a].
num--> [b].
num--> [c].
num--> [d]. 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-22T00:59:57.603

# 利用`phrase/2`

让我们尝试`phrase(s,[a,b,c])`代替`s([a,b,c],[])`. 原因很简单：通过这种方式，我们清楚地表明我们使用的是 DCG ( [dcg](/questions/tagged/dcg "显示标记为“dcg”的问题") ) 而不是普通的谓词。`phrase/2`是语法的“官方”接口。

所以你的第一个问题是为什么在“给出正确答案”`phrase(s,[a,c,f])`时不终止——正如你所说。`phrase(s,[a,b,c])`现在，这很容易回答：**两者**都不会终止！但`phrase(s,[a,b,c])`找到了解决方案/答案。

# 通用端接

这是要区分的两件事：如果您输入查询并得到类似`true`or的答案`X = a`；您可能有兴趣获得*更多*。通常，您通过输入`SPACE`或`;``ENTER`在顶层执行此操作。因此，只有在找到第一个或多个答案后，查询才可能开始循环。随着时间的推移，这变得相当混乱：你是否应该永远记住这个谓词可能会产生答案？另一个谓词产生两个，只有稍后才会循环？

最简单的出路是建立**通用终止**的概念，这是这里最强大的概念。A`Goal`终止当且仅当`Goal, false`终止。这个`false`目标对应于`SPACE`无限期击球；直到整个查询失败的那一刻。

所以现在尝试：

```
?- 短语（s，[a，c，f]），错误。
** 循环 **

```

但是也：

```
?- 短语（s，[a，b，c]），错误。
** 循环 **

```

从通用终止的角度来看，两个查询都不会终止。在最常用的词中，**终止**等同于**普遍终止**。找到答案或解决方案就是这样，但不是终止。因此，只要您对答案感到满意，有些查询看起来无害，但实际上不会终止。但是很高兴您这么快就发现了这一点：如果您仅在正在运行的应用程序中发现这一点，那就更糟了。

# 找出原因

作为下一步，让我们确定未终止的原因。您可能会尝试使用调试器或跟踪器，但很可能它根本不会给您一个很好的解释。但是有一个更简单的方法：使用[failure-slice](/questions/tagged/failure-slice "显示标记为“故障切片”的问题")。只需将非终结符添加`{false}`到您的语法中；并将目标`false`转化为谓词。我们可以在这里利用一个非常漂亮的属性：

> **如果**故障片没有终止，**则**原始程序不会终止。

**因此，如果我们很幸运并且找到了这样一个切片，那么我们肯定知道只有在剩余的可见部分以某种方式**更改时才会发生终止。最有用的切片是：

```
?- 短语（s，[a，b，c]），假

s --> [], **{false}**。
s --> s, {false} , num。

```

您的程序所剩无几！没了`num//0`！没人在乎`num//0`。这意味着：`num//0`可以描述*任何东西*，无论如何——程序仍然会循环。

为了解决这个问题，我们必须改变可见部分的一些东西。所剩无几！正如您已经观察到的，我们这里有一个左递归。修复它的经典方法是：

# 重新制定语法

您可以轻松地将您的语法重新表述为正确的递归：

```
s --> []。
s --> 数量，s。

```

现在两个查询都终止了。这是编译器构造中的经典方式。

但是在某些情况下，语法的重新表述是不合适的。这个简单的例子不是这种类型的，但它经常出现在带有一些预期歧义的语法中。在这种情况下，您仍然可以：

# 添加终止诱导参数

```
?- Xs = [a,b,c], 短语(s(Xs,[]), Xs)。

s(Xs,Xs) --> []。
s([_|Xs0],Xs) --> s(Xs0,Xs1), 数量, {Xs1=Xs}。

```

# 固有的非终止查询

无论您做什么，请记住，并非每个查询都可以终止。如果你问： » 告诉我所有存在的自然数——真的是所有的，一个一个！« 那么回答这个问题的唯一方法就是从 0 开始，然后将它们数起来。所以有疑问，有无限的答案/解决方案，我们不能责怪可怜的 Prolog 试图实现我们的愿望。然而，在这种情况下，我们最喜欢的是以公平的方式列举所有的解决方案。我们可以使用具有良好终止属性的语法来做到这一点；也就是说，一种以固定长度列表终止的文法。像这样：

```
?- 长度（Xs，M），短语（s，Xs）。

```

有关如何应用失败切片的其他示例，请参阅标签[失败切片](/questions/tagged/failure-slice "显示标记为“故障切片”的问题")。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:06:30.663

我不知道这是否有帮助，因为我使用的序言似乎有一个非常不同的语法，但我只是编写了以下程序来尝试匹配你的程序，它工作正常。

**程序**

```
s([]).
s([X|Xs]) :- num(X), s(Xs).

num(a).
num(b).
num(c).
num(d). 
```

**输出**

```
?- [prologdcg].
% prologdcg compiled 0.00 sec, 2,480 bytes
true.

?- s([a,c,b]).
true.

?- s([a,c,f]).
false. 
```

*使用 SWI-prolog 运行。*

# django - 为 Django 教程同步 sqlite3

> ID：13503955
> 
> 赞同：1
> 
> 时间：2012-11-21T23:53:18.453
> 
> 标签：django, sqlite, syncdb, manage.py

我正在启动 Django 教程并安装了虚拟环境和 django。我正在使用已经安装 sqlite3 的 Mac 10.6.8。

我在虚拟环境中工作。我将 settings.py 文件更改为：

```
ENGINE -- 'django.db.backends.sqlite3' 
```

我`NAME`将 settings.py 文件中的 -- 留空（即`''`），因为教程说

> “如果文件不存在，第一次同步数据库时会自动创建。”

但是当我运行时`python manage.py syncdb`，我收到以下错误：

> django.core.exceptions.ImproperlyConfigured：使用数据库前请在设置模块中填写数据库名称。

为什么我的文件没有自动创建？或者我需要做什么来解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:56:25.933

它将为您创建，但[您必须指定要调用它的名称，](https://docs.djangoproject.com/en/dev/ref/settings/#databases)因此只需设置`NAME`为`sqlite.db`或类似的名称。您还可以指定一个路径，这样它就不会阻塞您的项目目录。我通常将开发数据库保存在我的项目之外。

# sql - Rails 中的简单关系查询

> ID：13503956
> 
> 赞同：0
> 
> 时间：2012-11-21T23:53:22.563
> 
> 标签：sql, ruby-on-rails, activerecord

假设我有以下表格：

```
 product              transaction
------------------     ------------------
| id |   name    |     | id |  product  |            
------------------     ------------------
| 1  | Product A |     | 1  |     2     |
| 2  | Product B |     | 2  |     3     |
| 3  | Product C |     | 3  |     2     |
------------------     ------------------ 
```

现在，假设我想列出`transaction`表格，但我想显示产品名称而不是产品 ID。

在原始 SQL 中，我会这样做：

```
SELECT product.name FROM transaction, product WHERE transaction.product = product.id 
```

我很难弄清楚如何使用 Rails 的 Active Record Query Interface 来完成。我相信这对你们那里的 Rails 专家来说是微不足道的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T01:08:03.763

如果您想通过“Rails 方式”解决它：

`product`首先：将transactions中的column改为`product_id`，表名应该是复数，否则必须`set_table_name 'transaction'`在models中加上eg，不改会错过很多Rails的future。

添加/更改这些模型：

```
class Product < ActiveRecord::Base
  has_many :transactions
end

class Transaction < ActiveRecord::Base
  belongs_to :product
end 
```

如果您坚持使用列名“产品”，则必须将其更改`belongs_to`为：

```
 belongs_to :product, :foreign_key => 'product' 
```

但这有点难看

最后，使用这个：

```
Transaction.includes(:product) 
```

或者，如果您只想要拥有产品的人

```
Transaction.joins(:product) 
```

注意：我不记得确切，但我认为我在某些应用程序中使用“事务”作为表名时遇到了问题。其他人可能知道这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T00:17:26.103

```
transaction.joins('LEFT OUTER JOIN product ON transaction.id = product.id') 
```

# mysql - SQL 不同的“分组依据”和“日期范围”子查询减慢了整个查询

> ID：13503959
> 
> 赞同：2
> 
> 时间：2012-11-21T23:54:06.727
> 
> 标签：mysql, sql

我从同一个表中提取所有子查询`a`，但需要列中的信息`b.7dayclicks`，`c.7dayclicks`并且`d.14dayclicks`。

查询是这样的：

```
select
  a.higher_tier_id,
  a.lower_tier_id,
  b.7dayclicks,
  c.7dayclicks,
  d.14dayclicks
from
  a,
  (select higher_tier_id, 7dayclicks
   from a
   where day >= curdate() - 7
   group by higher_tier_id) b,
  (select lower_tier_id, 7dayclicks
   from a where day >= curdate() - 7
   group by lower_tier_id) c,
  (select lower_tier_id, 14dayclicks
   from a where day >= curdate() - 14
   group by lower_tier_id) d
where
  day >= curdate() - 3 
  and a.higher_tier_id = b.higher_tier_id
  and a.lower_tier_id = c.lower_tier_id
  and a.lower_tier_id = d.lower_tier_id 
```

结果，它需要很长时间才能运行。我正在努力提高效率。任何帮助将不胜感激。

*   第一列给出了higher_id
*   第二列给出了lower_id
*   第 3 列给出了按 high_id 级别排序的 7 天点击次数
*   第 4 列给出了按 lower_id 级别排序的 7 天点击次数
*   第 5 列给出了按 lower_id 级别排序的 14 天点击次数

我确实认为肯定有一种方法可以在没有任何连接的情况下将所有内容放在一起，但我就是不知道如何..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T20:25:33.427

像这样的东西会起作用吗？您将获得更高和更低的等级 ID，然后是 7 天点击次数和 14 天点击次数的总和。

```
select
  a.higher_tier_id,
  a.lower_tier_id,
  SUM(CASE WHEN day >= curdate() - 7 THEN 7dayclicks ELSE 0 END),
  SUM(CASE WHEN day >= curdate() - 14 THEN 14dayclicks ELSE 0 END)
FROM a
GROUP BY a.higher_tier_id, a.lower_tier_id 
```

# xcode - 不需要时 Xcode 横向启动图像警告

> ID：13503963
> 
> 赞同：2
> 
> 时间：2012-11-21T23:54:26.713
> 
> 标签：xcode, image

我正在完成一个仅在 iPad 和 iPhone 上以纵向模式运行的应用程序。因此，我不提供任何横向启动图像 - 我*可以*包含它们，但它们永远不会被看到，所以我更愿意在我的应用程序中节省空间。

如何阻止 XCode 尝试将“Default.png”和“Default@2x.png”自动分配到 iPad 的横向图像中？这会导致出现警告，因为这些图像适用于 iPhone，因此尺寸错误。或者，抑制出现的警告的解决方案就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:59:17.497

按住 Control 键单击摘要窗口中不需要的 iPad 启动图像，然后选择删除。这将删除对图像的引用作为 iPad 的启动图像。更好的是，继续为不需要的启动图像包含纯黑色 PNG 图像。它们将在 Xcode 构建您的应用程序时被压缩，因此它们几乎不会占用应用程序包中的空间。

我认为 Xcode 会自动为 iPhone 而不是 iPad 创建默认启动图像这一事实是一个错误。我建议您在 bugreporter.apple.com 上投诉这种行为。

编辑：为了清楚起见，您想要的是一组具有以下名称的适当大小的图像：

*   默认.png
*   默认@2x.png
*   默认-568h@2x.png
*   Default-Portrait~ipad.png
*   默认-横向~ipad.png
*   Default-Portrait@2x~ipad.png
*   Default-Landscape@2x~ipad.png

这将阻止 Xcode 在 iPad 插槽中使用例如 iPhone 启动图像。

# haskell - 映射到 Either 的左侧

> ID：13503965
> 
> 赞同：25
> 
> 时间：2012-11-21T23:54:52.947
> 
> 标签：haskell, either

在我的应用程序的某个地方，我收到了`Either ParserError MyParseResult`来自 Parsec 的消息。在下游，此结果通过使用其他库完成了一些其他解析。在解析的第二阶段，也可能会发生某种错误，我想将其作为 a 传递`Left String`，但为此我需要将结果从 Parsec 转换为`String`。为了实现这一点，我需要一个允许我使用函数映射 a`Left`的`show`函数。

我正在考虑的映射函数看起来像这样：

```
mapLeft :: (a -> b) -> Either a c -> Either b c
mapLeft f (Left x) = Left $ f x
mapLeft _ x = x 
```

但我很惊讶没有在 hackage db 上找到任何匹配的东西。所以现在我怀疑我是否使用了正确的方法来解决我的问题。

为什么标准库中没有这样的功能？我的方法有什么问题？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-22T00:02:54.050

我们在标准库中有这样的功能，

```
Control.Arrow.left :: a b c -> a (Either b d) (Either c d) 
```

是对任意箭头的推广。替换`(->)`并`a`应用它的中缀，以获得专业化

```
left :: (b -> c) -> Either b d -> Either c d 
```

原则上您的方法没有错，这是处理这种情况的明智方法。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-11-22T08:11:33.253

另一种选择是[`Bifunctor`](https://hackage.haskell.org/package/base/docs/Data-Bifunctor.html)使用`Either`. 然后你有

```
first :: (a -> b) -> Either a c -> Either b c 
```

（也`Bifunctor`可以用来遍历第一部分`(a,b)`。）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-11-22T05:45:54.313

这可以通过[lens](http://hackage.haskell.org/package/lens)轻松完成：

```
import Control.Lens

over _Left (+1) $ Left 10   => Left 11
over _Left (+1) $ Right 10  => Right 10
over _Right (+1) $ Right 10 => Right 11 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-06-07T17:54:59.793

另一个简单的选择`mapLeft`是`Data.Either.Combinators`：

```
mapLeft :: (a -> c) -> Either a b -> Either c b 
```

# python - python bottle import a class

> ID：13503973
> 
> 赞同：3
> 
> 时间：2012-11-21T23:56:15.877
> 
> 标签：python, class, bottle

Hi I am new to both python and bottle

I have a site

here is the structure

```
|root
 index.py 
     |classes
      session.py 
```

from the index.py how do I access session.py

so I can use it as:

```
**from session import session** 
```

Or is there a better way (standard) to do this?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-25T22:45:24.433

Make everything under root into a [package](http://docs.python.org/2/tutorial/modules.html#packages). Its easy.

Place blank `__init__.py` files in the root and classes folders and you will be able to import `session.py` no problem.

The `__init__.py` file defines everything as part of the package and then you can import anything within the package.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:21:34.513

Read this instead of the answer below: [Import a module from a relative path](https://stackoverflow.com/questions/279237/python-import-a-module-from-a-folder)

**Ignore this:**

Depending on what you want all of the following methods are valid. I normally use the first one unless there are a lot of helper functions to use.

`import session` and then call functions by `session.function1()`

or `from session import *` and just call `function1()` naturally.

or even `import session as whateveryouwanthere` and call `whateveryouwanthere.function1()`

# ios - 同时实现捏合和 2 点触控平移手势时遇到问题

> ID：13503974
> 
> 赞同：1
> 
> 时间：2012-11-21T23:56:17.983
> 
> 标签：ios, cocoa-touch

我所拥有的是带有几个子视图的视图控制器视图。层次结构类似于：

```
[view controller view]
    [container view]
        [view1,view2,view3,view4,view5,etc...]
            [gesture view (full screen)] 
```

我正在尝试实现捏合和两指平移，但不能让它们同时工作：

```
UIPinchGestureRecognizer *pinch = [[UIPinchGestureRecognizer alloc]
                                 initWithTarget:self action:@selector(handlePinch:)];
pinch.delegate = self;

UIPanGestureRecognizer *pullDownContainerView = [[UIPanGestureRecognizer alloc]initWithTarget:self action:@selector(pullingDownContainerView:)];
pullDownContainerView.minimumNumberOfTouches = 2;
pullDownContainerView.maximumNumberOfTouches = 2;
pullDownContainerView.delegate = self;

[self.touchView addGestureRecognizer:pullingDownContainerView];
[self.touchView addGestureRecognizer:pinch];

- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer {
    return YES;
} 
```

另一个奇怪的事情是`shouldRecognizeSimultaneouslyWithGestureRecognizer`没有被调用（我已经实现了`UIGestureRecognizerDelegate`协议）。他们确实单独工作。我读过一些关于使用滚动视图的东西，其中平移和捏合都可以随时使用或其他东西。所以我需要`UIView`用一个替换容器视图`UIScrollView`

想要一些指导。

**更新：**

进行了快速清洁和构建，现在可以正常工作了！

# regex - 寻找可选标记之间的匹配？

> ID：13503978
> 
> 赞同：4
> 
> 时间：2012-11-21T23:56:47.243
> 
> 标签：regex, perl

对于字符串：

*   `text::handle:e@ma.il::text`
*   `text::chat_identifier:chat0123456789&text`

我有当前的正则表达式：

`m/(handle:|chat_identifier:)(.+?)(:{2}|&)/`

我目前正在使用`$2`以获得我希望的值（在第一个字符串`e@ma.il`和第二个字符串中`chat0123456789`）。

不过，有没有更好/更快/更简单的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T00:02:29.680

它是否“更好”取决于上下文，但您可以采用这种方法：将字符串拆分为“：”并获取结果列表的第四个元素。如果第三个字段可以是“handle”或“chat_identifier”以外的内容，那么这可以说比正则表达式更具可读性并且更健壮。

我认为这两种方法的速度都非常相似，但可能几乎适用于 perl 中的任何实现。在担心它之前，我想表明速度对于这一步至关重要......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T00:04:08.730

对于正则表达式解决方案，这个稍微简单一些，不需要回溯：

```
m/(handle|chat_identifier):([^:&]+)/ 
```

请注意细微的差别：您的值允许单个冒号，而我的不允许（它在遇到的第一个冒号处停止）。如果这不是问题，您可以使用我的变体。或者正如我在评论中提到的那样，拆分为`:`并使用结果中的第四个元素。

仅在双冒号处停止的等效版本是：

```
m/(handle|chat_identifier):((?:(?!::|&).)+)/ 
```

不是那么漂亮，但它仍然避免了回溯（不过，前瞻可能会使它变慢......如果速度很重要，您将需要对其进行分析）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T00:27:32.553

看起来您已经在这里分配了很多好的解决方案。split 方法似乎是最简单的。但是根据您的要求，您还可以使用更通用的正则表达式来破坏其基本部分的字符串。它适用于您的示例之外的其他数据类型和属性名称。

```
 ([^:]+)::([^:]+):([^:&]+)(?:::|&)\1 
```

捕获组如下：

*   第 1 组：数据类型。（您的示例中的关键字“文本”。）
*   第 2 组：属性名称。（示例中的关键字“handle”和“chat_identifier”。）
*   第 3 组：属性值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T02:00:46.810

如果您想要的值始终位于相同的位置并且可以安全地拆分`:`and `&`，那么以下内容可能对您有用：

```
use Modern::Perl;

say +( split /[:&]+/ )[2] for <DATA>;

__DATA__
text::handle:e@ma.il::text
text::chat_identifier:chat0123456789&text 
```

输出：

```
e@ma.il
chat0123456789 
```

# groovy - groovy 32bit Windows 无法解析大型 XML 文件

> ID：13503988
> 
> 赞同：2
> 
> 时间：2012-11-21T23:57:41.657
> 
> 标签：groovy, xml-parsing

我在 Windows 7 上设置 java_opts -Xmx512M; 该文件大约 15Mb 并且在 XMLParsing 中失败 - 我从命令终端执行（它也在 groovyConsole 中超时）同一文件的短版本在 W 7 上正确执行

顺便说一句，未更改的 XML 代码在 24 秒内在 SunOS 64Bit 上正确执行。

*   你能告诉我在Windows 7上我能做什么吗？

代码片段：

```
import groovy.util.XmlParser
import javax.xml.xpath.*
import groovy.time.*

inpXMLFile='c:/EnvFiles/CCC.xml'

entry=new File("$inpXMLFile")
assert   entry.exists()
println " ... file existence validated"

...

def node= new XmlParser().parse( new File( inpXMLFile ) ) // Line 23 

// .... the rest of the script 
```

完整的跟踪包括在内：

```
... file existence validated

    Caught: java.net.ConnectException: Connection timed out: connect
      java.net.ConnectException: Connection timed out: connect
        at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntity(XMLEntityManager.java:629)
        at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity(XMLEntityManager.java:1291)
        at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.startDTDEntity(XMLEntityManager.java:1258)
        at com.sun.org.apache.xerces.internal.impl.XMLDTDScannerImpl.setInputSource(XMLDTDScannerImpl.java:260)
        at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$DTDDriver.dispatch(XMLDocumentScannerImpl.java:1151)
        at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$DTDDriver.next(XMLDocumentScannerImpl.java:1047)
        at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:960)
        at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:607)
        at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:116)
        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:488)
        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:835)
        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:764)
        at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)
        at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1210)
        at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:568)
        at compCurrent.run(compCurrent.groovy:23) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T03:25:55.627

Looks like the error is accessing a DTD element and not related to large file size.

```
java.net.ConnectException: Connection timed out: connect
com.sun.org.apache.xerces.internal.impl.XMLEntityManager.startDTDEntity 
```

You have two options: 1\. You can remove or comment out DTD reference and entities in your XML file, or 2\. Disable parsing DTD and external entities on the XMLParser.

```
def parser = new XmlParser()
parser.setFeature("http://apache.org/xml/features/nonvalidating/load-dtd-grammar", false)
parser.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) 
```

# ios - 如何在 NSMutableDictionary 中查找重复项？

> ID：13503990
> 
> 赞同：2
> 
> 时间：2012-11-21T23:58:11.973
> 
> 标签：ios, nsarray, nsdictionary, nsmutabledictionary

伪代码：

```
NSArray *arr1 = {"mike","george","Tim","Tom"...}
NSArray *arr2 = {"mike","george","Chris","Adam"...}
NSArray *arr3 = {"Don","george","mike","Tom"...}
NSArray *arr4 = {"george","Nicole","Moe","mike"...}

//Add these arrays to the dictionary
for(int i=0; i<n, i++)
   [dictionary addObject:arr[i]]; 
```

我想找到所有数组中存在的重复值，而不是一些。在此示例中，该值将是 {"george","mike"}。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:09:33.003

```
NSArray *arr1 = @[@"mike",@"george",@"Tim",@"Tom" ];
NSArray *arr2 = @[@"mike",@"george",@"Chris",@"Adam" ];
NSArray *arr3 = @[@"Don",@"george",@"mike",@"Tom" ];
NSArray *arr4 = @[@"george",@"Nicole",@"Moe",@"mike" ];

NSMutableSet *intersection = [NSMutableSet setWithArray:arr1];
[intersection intersectSet:[NSSet setWithArray:arr2]];
[intersection intersectSet:[NSSet setWithArray:arr3]];
[intersection intersectSet:[NSSet setWithArray:arr4]];

NSArray *duplicates = [intersection allObjects];

NSLog(@"duplicates=%@", duplicates); 
```

duplicates 包含一个数组，其中的值全部出现在其中：

```
duplicates=(
  mike,
  george
) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-22T00:07:47.207

假设`dictionary`实际上是一个 NSMutableArray，那么这样的事情会起作用：

```
NSMutableArray *results = [[NSMutableArray alloc] init];

for(NSString *name in [dictionary objectAtIndex:0]) {
    bool valid = true;
    for(int i=1;i<[dictionary count];i++) {
        if([[dictionary objectAtIndex:i] indexOfObject:name]==NSNotFound) {
            valid=false;
            break;
        }
    }
    if(valid)
        [results addObject:name];
} 
```

# c++ - Sendmessage 在方法定义中无法正常工作

> ID：13503995
> 
> 赞同：-1
> 
> 时间：2012-11-21T23:58:40.430
> 
> 标签：c++, winapi

为了防止 WM_LBUTTONUP 事件被代码淹没，我决定创建一个包含最初在 WM_LBUTTONUP 上触发的代码的类方法。

例子：

```
 case WM_LBUTTONUP:
 {//Code that used to trigger on WM_LBUTTONUP below:
  x=4;
  y=2;
  SendMessage(hWnd, CUSTOM_WMMESSAGE, NULL, NULL);
}//The above SendMessage() call works 
```

方法定义：

```
void Dog::bark(HWND hindow, INT wm_message)
{//All code that used to trigger on WM_LBUTTON up was moved to this method
 x=4;
 y=2;
 SendMessage(hwindow, wm_message, NULL, NULL);
} 
```

之后：

```
case WM_LBUTTONUP:
{Object.bark();}
//When SendMessage was called this way (inside of a method definition)
//it did not work! 
```

**问题：**

当未在类方法中使用时，SendMessage() 对 WM_LBUTTONUP 起作用。但是，一旦我从 WM_LBUTTONUP 上的类方法调用 SendMessage()，消息就没有发送（这意味着 SendMessage() 没有，或者从类方法调用时不起作用）。

**请注意：**

方法定义与 WM_LBUTTON 不在同一个文件中（我想保持这种方式，以防止 main.cpp 填充太多代码:)）

**编辑**

包含类定义的文件名为 Dog.hpp 我将 Dog.hpp 包含在 main.cpp 中。我已经成功创建了其他有效的类方法（在 dog.hpp 内部），所以我知道类或头文件代码没有任何问题。唯一的问题是，当在 dog.hpp 中调用 SendMessage() 函数时，与在 main.cpp 中调用相反，它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:35:56.523

`Object.bark()`期望您没有传递给它的输入参数。你需要这样做：

```
case WM_LBUTTONUP:
{
    Object.bark(hWnd, CUSTOM_WMMESSAGE);
    break; // <-- this is missing in your original code as well!
} 
```

# sql - 显示一对多 SQL 查询中出现频率最高的项目

> ID：13503996
> 
> 赞同：1
> 
> 时间：2012-11-21T23:59:05.687
> 
> 标签：sql, sql-server, one-to-many

大家好，提前感谢您的帮助。这是我的场景：

我有三个链接表，显示每个表中使用的生产规格和墨水类型。每个规格可以有可变数量的墨水（从 1 到 10），这些墨水可能与其他规格相同，也可能不同。我的目标是让每个规范都能够显示规范名称和出现频率更高的墨水。

例如规格 XYZ：

```
|=====|=====|
¦SPEC ¦INK  ¦
|=====|=====|
¦XYZ  ¦blue ¦
¦XYZ  ¦red  ¦
¦XYZ  ¦red  ¦
¦XYZ  ¦red  ¦
¦XYZ  ¦brown¦
|=====|=====| 
```

我只想显示：

```
|=====|=====|
¦SPEC ¦INK  ¦
|=====|=====|
¦XYZ  ¦red  ¦
|=====|=====| 
```

这些表链接如下：

```
SELECT tblStudioInput.SpecNo
    , tblListInkSystem.Ink
FROM tblStudioInput
INNER JOIN tblStudioInputColour
    ON tblStudioInput.stID = tblStudioInputColour.StudioInputID
INNER JOIN tblListInkSystem
    ON tblStudioInputColour.InkSystem = tblListInkSystem.ID 
```

再次提前感谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:15:31.373

```
SELECT SPEC, INK
FROM
  (
    SELECT SPEC, INK,
           DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) rn
    FROM Table1
    GROUP BY SPEC, INK
  ) s
WHERE rn = 1 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!3/0cd4b/7)
*   [SQLFiddle 演示（带领*带*）](http://sqlfiddle.com/#!3/69199/9)

资源

*   [DENSE_RANK](http://msdn.microsoft.com/en-us/library/ms173825.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T10:38:45.087

[更新] 你可以试试这个：

```
select top 1 with ties
    spec, ink
from
    (
      select
          spec, ink, count(*) n
      from
          tmp
      group by
          spec, ink
    ) t
order by
    n desc 
```

[更新] [SQLFiddle 演示](http://sqlfiddle.com/#!3/303ff/7/0)

或者没有排序

```
with q as (
    select
        spec, ink, count(*) n
    from
        tmp
    group by
        spec, ink
)

select
    spec, ink
from
    q
where
    n = (
        select
            max(n)
        from
            q
    ) 
```

或没有 CTE

```
select
    spec, ink
from
    tmp
group by
    spec, ink
having
    count(*) = (
        select
            max(n)
        from
            (
                select
                    count(*) n
                from
                    tmp
                group by
                    spec, ink
            ) t
    ) 
```