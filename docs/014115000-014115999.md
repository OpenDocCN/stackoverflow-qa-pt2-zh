# StackOverflow 问答 14115000-14115999

# python - Gl3w Python 脚本错误：如何解决它/让它工作

> ID：14115001
> 
> 赞同：0
> 
> 时间：2013-01-01T22:56:46.290
> 
> 标签：python, windows

因此，在无法让 GLEW 工作近 2 天之后：尝试 Gl3w。

python 脚本抱怨语法错误，说所有的打印都表示语法错误，所以我把它们都删除了。现在它在抱怨进口......（基本上它似乎在抱怨整个代码）

我不知道 Python，但我找不到对 Gl3w 的支持……我是否应该继续尝试“更正脚本”，我认为这应该可以正常工作？我究竟做错了什么”？

谢谢！

这是脚本：[https ://github.com/skaslev/gl3w](https://github.com/skaslev/gl3w)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:57:50.727

您使用的是 Python 3，而脚本需要 Python 2：

> 它的主要部分是一个简单的`gl3w_gen.py`Python 2.6 脚本

在 python 2 中，print 是一个语句，在 3 中，它是一个函数。当尝试使用 python 3 运行 python 2 代码时，这种差异会导致语法错误：

```
$ python3.3
Python 3.3.0 (default, Sep 29 2012, 08:16:08) 
[GCC 4.2.1 Compatible Apple Clang 3.1 (tags/Apple/clang-318.0.58)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> print 'Hello world!'
  File "<stdin>", line 1
    print 'Hello world!'
                       ^
SyntaxError: invalid syntax 
```

# vb.net - 绑定一个GridView，缺少什么？

> ID：14115002
> 
> 赞同：0
> 
> 时间：2013-01-01T22:56:49.027
> 
> 标签：vb.net, xaml, gridview, binding, windows-8

（Windows 8）我试图让我的 GridView 绑定到导航到页面时加载的一些分组对象。基本上我想要的是在其他对象仍在加载时显示这些加载的对象。

以下代码显示网格仅显示所有已加载的项目：

```
Dim myItems As New ObservableCollection(Of SearchResultItem)
Dim group As New SearchResultGroup With {.Title = "Title"}
group.Items = myItems
' Loading code here
DefaultViewModel("Groups") = New ObservableCollection(Of SearchResultGroup)({group}) 
```

但是，以下内容根本没有显示任何内容：

```
Dim myItems As New ObservableCollection(Of SearchResultItem)
Dim group As New SearchResultGroup With {.Title = "Title"}
group.Items = myItems
DefaultViewModel("Groups") = New ObservableCollection(Of SearchResultGroup)({group})
' Loading code here 
```

（这是在 async LoadState 函数下）

这是页面的代码：

```
<common:LayoutAwarePage DataContext={Binding DefaultViewModel, RelativeSource={RelativeSource Self}} ... >
    <Page.Resources>
        <CollectionViewSource
            x:Name="groupedItemsViewSource"
            Source="{Binding Groups}"
            IsSourceGrouped="true"
            ItemsPath="Items"/>
        ...
    </Page.Resources>
    <Grid Style="{StaticResource LayoutRootStyle}">
        ....
        <GridView
            x:Name="itemGridView"
            AutomationProperties.AutomationId="ItemGridView"
            AutomationProperties.Name="Grouped Items"
            Grid.RowSpan="2"
            Padding="116,137,40,46"
            ItemsSource="{Binding Source={StaticResource groupedItemsViewSource},Mode=TwoWay}"
            ItemTemplate="{StaticResource ResultTemplate}"
            SelectionMode="None"
            IsSwipeEnabled="false"
            IsItemClickEnabled="True">
            ... 
```

这是我使用的自定义项目和组类：

```
Public Class SearchResultGroup
    Inherits BindableBase

    Public Sub New() ...
    Private _Title As String
    Property Title As String ...
    Private _Items As ObservableCollection(Of SearchResultItem)
    Property Items As ObservableCollection(Of SearchResultItem) ...
End Class

Public Class SearchResultItem
    Inherits BindableBase

    Private _Title As String       
    Property Title As String ...
    Private _Title2 As String
    Property Title2 As String ...
    Private _Subtitle As String
    Property Subtitle As String
End Class 
```

（只是在这里删掉一些不必要的代码......将根据需要进行编辑）

# excel - 地址拆分公式

> ID：14115004
> 
> 赞同：0
> 
> 时间：2013-01-01T22:57:03.240
> 
> 标签：excel, worksheet-function

关于如何在 Excel 中分隔地址的任何想法。目前我有大约 300 个流动格式的地址：

1234 地址城市，AL 55555

我在网上查了一下，我发现了如何区分城市和邮政编码。现在我在单独的单元格中获取城市和地址时遇到问题。关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T00:12:00.047

如果它总是采用这种精确的格式，那么如果这个城市只有一个单词（地址中的空格没有限制）：

```
Addr:  =LEFT(A5,
        FIND("~",SUBSTITUTE(A5," ","~",FIND(",",A5)-1-LEN(SUBSTITUTE(LEFT(A5,FIND(",",A5)-1)," ","")))))
City:  =MID(A5,
        FIND("~",SUBSTITUTE(A5," ","~",FIND(",",A5)-1-LEN(SUBSTITUTE(LEFT(A5, FIND(",",A5)-1)," ",""))))+1,
        FIND(",",A5) - 1 - FIND("~",SUBSTITUTE(A5," ","~",FIND(",",A5)-1-LEN(SUBSTITUTE(LEFT(A5, FIND(",",A5)-1)," ","")))))
State: =MID(A1,FIND(",",A1)+2,2)
Zip:   =RIGHT(A1,5) 
```

# android - 将 YouTubePlayerFragment 与 FragmentActivity 和 ActionBarSherlock 一起使用时出现异常

> ID：14115008
> 
> 赞同：4
> 
> 时间：2013-01-01T22:57:43.543
> 
> 标签：android, android-fragments, youtube-api, android-actionbar

我正在尝试使用新的[YouTube Player API for Android](https://developers.google.com/youtube/android/player/)实现布局。目前，我有一个简单的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">
  <fragment
      android:name="com.google.android.youtube.player.YouTubePlayerFragment"
      android:id="@+id/youtube_fragment"
      android:layout_width="match_parent"
      android:layout_height="wrap_content"/>
  <TextView
      android:layout_width="match_parent"
      android:layout_height="0dp"
      android:layout_weight="1"
      android:textAppearance="@android:style/TextAppearance.Small"
      android:gravity="center"
      android:text="Nothin"/>
</LinearLayout> 
```

现在，在我的活动中，我有以下内容：

```
public class MainActivity extends FragmentActivity implements YouTubePlayer.OnInitializedListener 
```

我的印象是在我的布局中使用片段意味着我需要使用 FragmentActivity（来自 android.support.v4.app.FragmentActivity）。但是，当我运行它时出现以下异常：

```
java.lang.ClassCastException: com.google.android.youtube.player.YouTubePlayerFragment cannot be cast to android.support.v4.app.Fragment 
```

这在我扩展 Activity 而不是 FragmentActivity 时有效。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-01T23:11:37.627

YouTubePlayerFragment 继承自 android.app.Fragment，您将它转换为 android.support.v4.app.Fragment。如果您想在较旧的 API 上使用此类，请使用 YouTubePlayerSupportFragment，否则请修复您的导入。

# java - 你能解释为什么@Transactional 不回滚吗

> ID：14115013
> 
> 赞同：1
> 
> 时间：2013-01-01T22:57:59.230
> 
> 标签：java, spring-jdbc, spring-transactions

我正在尝试在数据库中创建两个表（ABC，XYZ）。XYZ 语法故意具有错误的语法，并且假定会失败。这个想法是在尝试 XYZ 时应该回滚 ABC 的表创建。我是 Spring Transaction 的新手，并且四处搜索以提出这个简单的示例，日志似乎显示 TransactionManager 正在回滚，但最后我看到表 ABC 存在于数据库中。谁能解释为什么@Transactional 没有在这里回滚...

```
 package com.tango.db.dao;

    import org.springframework.context.support.ClassPathXmlApplicationContext;
    import org.springframework.jdbc.core.JdbcTemplate;
    import org.springframework.transaction.annotation.Transactional;

    public class DBDAO {

            private JdbcTemplate jdbcTemplate;

            public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
              this.jdbcTemplate = jdbcTemplate;
            }

            @Transactional(rollbackFor = Exception.class)
            public void createTables(){
              jdbcTemplate.execute("CREATE TABLE ABC(ID NUMBER NOT NULL,  NAME VARCHAR2(35), primary key(ID))");
              jdbcTemplate.execute("CREATE TABLE XYZ(ID NUMBER NOT NULL, NAME VARCHAR2(35), UPDATE DATE(7), primary key(ID))");
            }

            public static void main(String[] args) {
              ClassPathXmlApplicationContext ctx = new         ClassPathXmlApplicationContext("spring-context.xml");
              DBDAO dbdao = (DBDAO)ctx.getBean("dbDAO");
              dbdao.createTables();
            }    
    } 
```

弹簧上下文.xml

```
 <bean id="local.oracle.dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
            <property name="driverClassName" value="oracle.jdbc.driver.OracleDriver"/>
            <property name="url" value="jdbc:oracle:thin:@10.211.55.6:1521:xe"/>
            <property name="username" value="abc"/>
            <property name="password" value="1234"/>
            <property name="defaultAutoCommit" value="false"/>
    </bean>

    <bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
            <constructor-arg ref="local.oracle.dataSource"/>
    </bean>

    <bean id="dbDAO" class="com.tango.db.dao.DBDAO">
            <property name="jdbcTemplate" ref="jdbcTemplate"/>

    </bean>

    <tx:annotation-driven transaction-manager="txManager"/>

    <bean id="txManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
            <property name="dataSource" ref="local.oracle.dataSource"/>
    </bean> 
```

以下是日志：

```
 DEBUG SQLErrorCodeSQLExceptionTranslator - Translating SQLException with SQL state '42000', error code '904', message [ORA-00904: : invalid identifier
    ]; SQL was [CREATE TABLE XYZ(ID NUMBER NOT NULL, NAME VARCHAR2(35), UPDATE DATE(7), primary key(ID))] for task [StatementCallback]
    DEBUG DataSourceTransactionManager - Initiating transaction rollback
    DEBUG DataSourceTransactionManager - Rolling back JDBC transaction on Connection [jdbc:oracle:thin:@10.211.55.6:1521:xe, UserName=DBO, Oracle JDBC driver]
    DEBUG DataSourceTransactionManager - Releasing JDBC Connection [jdbc:oracle:thin:@10.211.55.6:1521:xe, UserName=DBO, Oracle JDBC driver] after transaction
    DEBUG DataSourceUtils - Returning JDBC Connection to DataSource
    Exception in thread "main" org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [CREATE TABLE XYZ(ID NUMBER NOT NULL, NAME VARCHAR2(35), UPDATE DATE(7), primary key(ID))]; nested exception is java.sql.SQLSyntaxErrorException: ORA-00904: : invalid identifier

        at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:233)
        at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:72)
        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:407)
        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:428)
        at com.tango.db.dao.DBDAO.createTables(DBDAO.java:19)
        at com.tango.db.dao.DBDAO$$FastClassByCGLIB$$112527a.invoke(<generated>)
        at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)
        at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:689)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
        at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
        at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:622)
        at com.tango.db.dao.DBDAO$$EnhancerByCGLIB$$7b0ac5f7.createTables(<generated>)
        at com.tango.db.dao.DBDAO.main(DBDAO.java:25)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)
    Caused by: java.sql.SQLSyntaxErrorException: ORA-00904: : invalid identifier

        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:440)
        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:396)
        at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:837)
        at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:445)
        at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:191)
        at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:523)
        at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:193)
        at oracle.jdbc.driver.T4CStatement.executeForRows(T4CStatement.java:999)
        at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1315)
        at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1890)
        at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1855)
        at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:304)
        at org.apache.commons.dbcp.DelegatingStatement.execute(DelegatingStatement.java:264)
        at org.apache.commons.dbcp.DelegatingStatement.execute(DelegatingStatement.java:264)
        at org.springframework.jdbc.core.JdbcTemplate$1ExecuteStatementCallback.doInStatement(JdbcTemplate.java:421)
        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:396)
        ... 16 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T00:44:43.540

在您的情况下，事务边界并不完全取决于 Spring。如果您更深入地研究 Oracle 文档，它会定义事务边界如下：

> 事务从第一个可执行的 SQL 语句开始。事务在提交或回滚时结束，可以使用 COMMIT 或 ROLLBACK 语句显式地结束，也可以在发出 DDL 语句时隐式地结束。

[http://docs.oracle.com/cd/B28359_01/server.111/b28318/transact.htm#i6564](http://docs.oracle.com/cd/B28359_01/server.111/b28318/transact.htm#i6564)

CREATE TABLE 是一个 DDL（数据定义语言）语句。因此，当您发布第一个 CREATE TABLE 时，Oracle 将其视为隐式事务结束。因此，当您的第二个 CREATE TABLE 发出并失败时，恢复第一个为时已晚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T23:28:31.317

这是因为*创建表*是一个**DDL**（数据定义语言）语句，并且**只有 DML**（数据修改语言）语句被回滚。每个 DDL 语句都有一个隐式提交，因此它们不能回滚。

完整地说，DML 语句是：*插入*、*更新*和*删除*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T23:27:19.880

看起来您正在使用 JDK 代理，但没有为 Spring 声明用于创建代理的任何接口。DBDAO 需要是一个具有 createTables 方法的接口，因此 Spring 可以创建包含事务代码的运行时实现。

# javascript - 在回调内部执行链接的默认操作

> ID：14115015
> 
> 赞同：0
> 
> 时间：2013-01-01T22:58:14.237
> 
> 标签：javascript, jquery, backbone.js, onclick

我的页面上有一个使用 facebook 登录的链接，我想操纵 onclick 的工作方式。目前我已经对其进行了更改，使其不会通过在末尾添加 return false 来执行默认操作：

```
$('#login').on('click', function(e) {
    FB.login(function(response) {
        //window.easyUserData.login = response;
        if (response.authResponse) {
            console.log('authorised');
            return true;
        } else {
            // cancelled
        }
    });
    return false;
}); 
```

发生的事情是在它调用 FB.login 打开对话框之后它会重定向页面，而不是我想要的。我正在寻找的是它执行我放置返回 true 的链接的默认操作。return true 位不起作用，因为当它到达那里时， return false 已经被处理了。关于如何做到这一点的任何提示？

该链接具有 href="#/home" 并且我正在使用主干.js 来处理路由。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:07:26.103

由于登录功能的异步性质，您必须使用 javscript 重定向：

```
$('#login').on('click', function(e) {
    var href=this.href;
    FB.login(function(response) {
        //window.easyUserData.login = response;
        if (response.authResponse) {
            console.log('authorised');
            /* redirect here*/
           window.location=href;
        } else {
            // cancelled
        }
    });
    return false;
}); 
```

# javascript - jQuery val() 无法处理通过 ajax 附加的选项

> ID：14115016
> 
> 赞同：1
> 
> 时间：2013-01-01T22:58:19.427
> 
> 标签：javascript, jquery, ajax

我有一个 jQuery/Ajax 函数，它将 2 附加`<option>`到`<select>`.

```
function addOption() {  
    var author = $("#authors").val();
    $('#books').empty(); 
    $('#books').html('<option value="">Please Select</option>'); 
$.ajax({ 
      type: "post", 
      url:  "books.php", 
      data: { author:author }, 
      success: function(response){ 
          $('#books').append(response); 
      } 
    }); 
} 
```

`response`回来 -

```
<option value="bookA">Book A</option>
<option value="bookB">Book B</option> 
```

现在`books`是——

```
<select id="books">
<option value="">Please Select</option>
<option value="bookA">Book A</option>
<option value="bookB">Book B</option>
</select> 
```

这很好用。

现在我想在调用后设置`selected` `option`使用-`.val()``addOption()`

```
$('#authors').change( function(){
addOption();
$('#books').val('bookB');
}); 
```

这不会被`Book B`选中。

如果我硬编码`.append()`它的工作原理 -

```
function addOption() {  
    var author = $("#author").val();
    $('#books').empty(); 
    $('#books').html('<option value="">Please Select</option>');
    $('#books').append('<option value="bookA">Book A</option>\n<option value="bookB">Book B</option>);
}

$('#authors').change( function(){
addOption();
$('#books').val('bookB');
}); 
```

是否有原因为什么`.ajax`无法使用 选择我附加在函数中的选项`.val()`，如果我直接附加它们可以吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:04:03.893

那是因为 AJAX 调用是异步的，所以当你尝试选择选项时，它还没有被添加到选择中。

在函数中使用回调，以便在响应到达时执行某些操作：

```
function addOption(callback) {  
  var author = $("#authors").val();
  $('#books').empty(); 
  $('#books').html('<option value="">Please Select</option>'); 
  $.ajax({ 
    type: "post", 
    url:  "books.php", 
    data: { author:author }, 
    success: function(response){ 
      $('#books').append(response); 
      callback();
    }
  }); 
} 
```

用法：

```
$('#authors').change( function(){
  addOption(function(){
    $('#dropdownB').val('bookB');
  });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T23:01:42.280

Ajax 是异步的，当您设置该值时，没有该值的选项，您可以将代码放在成功回调中。

```
 success: function(response){ 
      $('#books').append(response); 
      // ...
  } 
```

或者将`async`您的 Ajax 请求的属性值设置为`false`;

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-01T23:01:54.373

**JAX 是**异步****的**，这意味着当您调用 addOption() 方法时，它可能（并且可能会）在实际进行 Ajax 调用之前返回，因此您`$('#dropdownB').val('bookB');`在触发 Ajax 回调以附加选项之前调用。**

 **尝试将其`$('#dropdownB').val('bookB');`放入 ajax 调用的成功回调中，您应该会看到它正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-01T23:01:39.503

这是因为 ajax 是*异步*的。也就是说，当它返回并将新选项附加到选择列表时，浏览器引擎已经继续并尝试设置值（尚未添加）。尝试移动值设置逻辑以作为 ajax 响应的一部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-01T23:05:36.280

1）你应该把`$('#dropdownB').val('bookB');`你的ajax调用的成功事件放在里面，因为AJAX是异步的，当你试图改变选中的项目时你的请求可能没有完成，所以还没有项目可以选择。
2）您追加`#books`但更改所选项目`#dropdownB`。这是两个不同的 id，因此是两个不同的 DOM 元素。**

# video - PHP API YouTube 视频标签未检索

> ID：14115021
> 
> 赞同：1
> 
> 时间：2013-01-01T22:59:25.533
> 
> 标签：video, tags, youtube-api, feed

我很难从 PHP YouTube 视频提要中检索视频标签。

可以成功检索除视频标签之外的所有视频属性。

请帮助我，新年快乐！

我的部分代码如下：

```
foreach ($videoFeed as $videoEntry ) {
if ( $count < 50) {
$vidtitle[$count] = $videoEntry->getVideoTitle();  
$vidid[$count] = $videoEntry->getVideoId(); 
$vidcategory[$count] = $videoEntry->getVideoCategory();
$vidtags[$count] = implode(", ", $videoEntry->getVideoTags());
$vidwatchpage[$count] = $videoEntry->getVideoWatchPageUrl();
$vidduration[$count] = $videoEntry->getVideoDuration();
$vidviewcount[$count] = $videoEntry->getVideoViewCount(); 
```

# c++ - 如何将 CMake 中的 QtMain 与 Qt5 链接？

> ID：14115024
> 
> 赞同：20
> 
> 时间：2013-01-01T23:00:22.293
> 
> 标签：c++, qt, c++11, cmake, qt5

我将我的项目代码从 Qt4 升级到 Qt5。它使用 CMake。除了一行与 Qt 相关的 Cmake 命令外，转换很顺利。我在当前文档中找不到，例如

*   [http://qt-project.org/doc/qt-5.0/qtdoc/cmake-manual.html](http://qt-project.org/doc/qt-5.0/qtdoc/cmake-manual.html)
*   [http://qt-project.org/doc/qt-5.0/qtdoc/qtmain.html](http://qt-project.org/doc/qt-5.0/qtdoc/qtmain.html)

**如何从 CMake（使用 Qt5）与 QtMain 链接？**

这是转换我的项目的唯一缺失位。有人可以向我指出一个解释这一点的文档或解释如何用 Qt5 做到这一点吗？我的 Qt4 代码工作正常，但我找不到 Qt5 的 Cmake 宏。

编辑>这是我目前拥有的 CMake 文件：[https ://bitbucket.org/klaim/aos_qt5/src/593c195c4c6889f6968d68fca018ef425783a063/tools/aosdesigner/CMakeLists.txt?at=wip_qt5](https://bitbucket.org/klaim/aos_qt5/src/593c195c4c6889f6968d68fca018ef425783a063/tools/aosdesigner/CMakeLists.txt?at=wip_qt5)

我相信，所有 qt5 必要的 CMake 宏都已正确设置，唯一不起作用的是链接到 QtMain 什么都不做，正如预期的那样，因为应该有一种我在Qt5 文档。

您可以浏览文件历史记录以查看它是如何与 Qt4 一起工作的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-04T22:52:16.090

从您链接到的[Qt 文档](http://qt-project.org/doc/qt-5.0/qtdoc/cmake-manual.html)中，您似乎可以找到 Qt5Core 而不是 Qt5Widgets。这将创建一个名为`Qt5::WinMain`. 来自[Qt 文档](http://qt-project.org/doc/qt-5.0/qtdoc/cmake-manual.html#imported-targets)：

> 为每个 Qt 模块创建导入的目标。这意味着`Qt5<Module>_LIBRARIES`包含导入目标的名称，而不是库的路径。
> ...
> Qt 5 中的每个模块都有一个具有命名约定的库目标`Qt5::<Module>`

```
~~find_package( Qt5Widgets REQUIRED )~~
find_package( Qt5Core REQUIRED )
...
add_executable( aosdesigner WIN32 ${AOSDESIGNER_ALL_FILES} )
target_link_libraries( aosdesigner
    ${Boost_LIBRARIES}
    utilcpp
    aoslcpp
    Qt5::WinMain  # <-- New target available via find_package ( Qt5Core )
)

qt5_use_modules( aosdesigner Widgets )
```

我还建议您删除您的两个`link_libraries`调用，因为它是一个[已弃用的命令](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3alink_libraries)，并且我会在 CMakeLists.txt 顶部指定 CMake 版本 2.8.9 而不仅仅是 2.8 作为最低要求，因为[这是`qt5_use_modules`](http://qt-project.org/doc/qt-5.0/qtdoc/cmake-manual.html#using-qt-5-with-cmake-older-than-2-8-9).

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-18T12:37:33.647

从 CMake 2.8.11 和 Qt 5.1 开始，如果您在 add_executable 调用中指定 WIN32 或设置 WIN32_EXECUTABLE 目标属性，则链接到 Qt5::WinMain 是自动/隐式的。

演示文稿在

[https://devdays.kdab.com/wp-content/uploads/2012/cmake.pdf](https://devdays.kdab.com/wp-content/uploads/2012/cmake.pdf)

有视频在

[http://www.youtube.com/watch?feature=player_detailpage&v=GJ0kMsLbk6Q#t=751](http://www.youtube.com/watch?feature=player_detailpage&v=GJ0kMsLbk6Q#t=751)

描述了使其成为 CMake 2.8.11 的功能。

有关使用 Qt 的 CMake 的更多信息，请参见

[http://www.kdab.com/modern-cmake-with-qt-and-boost/](http://www.kdab.com/modern-cmake-with-qt-and-boost/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-04T20:07:28.513

编辑：感谢 Archi 评论（见下文），只需添加

```
target_link_libraries(<your_app> Qt5::WinMain) 
```

或者

```
target_link_libraries(<your_app> ${Qt5Core_QTMAIN_LIBRARIES}) 
```

在您的应用程序的 CMakeLists.txt 中。两种语法都对我有用。

# php - 隐藏根类别并将子类别显示为菜单

> ID：14115028
> 
> 赞同：0
> 
> 时间：2013-01-01T23:00:51.497
> 
> 标签：php, css, magento, drop-down-menu

请看图片。我的网站位于[此处](http://www.tenniskarma.com/)

![在此处输入图像描述](../Images/13bb839558b3594671a0277cab6ced3f.png)

转移域后，菜单搞砸了...我想隐藏根类别，我想将子类别显示为主菜单。我希望子子类别作为下拉菜单（这些已经是下拉菜单）

有人可以指导我怎么做吗？请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:24:17.583

发生这种情况可能有几个原因。

**原因 1 - 不正确的类别结构**

1.  您在 magento CMS 中的类别结构需要所有导航项类别都来自根类别。您可能需要将它们拖放到根类别中。请参阅下面的屏幕截图以获取示例：

![在此处输入图像描述](../Images/5344d2077aa292f0cc94fcb8476e7f2f.png)

**原因 2 - 主题更改**

1.  在您当前的主题布局文件夹（app/design/frontend/PACKAGE/THEME/layout/）中打开 page.xml。
2.  找到以 this 块开头的部分：
    `<block type="page/html_header" name="header" as="header">`然后在其中检查有关哪些模板呈现您的菜单的信息。在下面的情况下，它是 page/html/topmenu.phtml

    ```
    <block type="core/text_list" name="top.menu" as="topMenu" translate="label">
    <label>Navigation Bar</label>
    <block type="page/html_topmenu" name="catalog.topnav" template="page/html/topmenu.phtml"/>
    </block> 
    ```

3.  您使用的主题可能正在使用自定义导航模板。检查呈现顶部导航的模板：（app/design/frontend/PACKAGE/THEME/template/page/html/topmenu.phtml）。代码应如下所示：

    ```
    <?php $_menu = $this->renderCategoriesMenuHtml(0,'level-top') ?>
     <?php if($_menu): ?>
      <div class="nav-container">
        <ul id="nav">
         <?php echo $_menu ?>
        </ul>
      </div>
    <?php endif ?> 
    ```

# opengl-es-2.0 - GLKit 渲染和 iOS 设备方向（面朝上/朝下）

> ID：14115041
> 
> 赞同：1
> 
> 时间：2013-01-01T23:02:01.933
> 
> 标签：opengl-es-2.0, uiinterfaceorientation, glkit, uideviceorientation

我有一个应用程序，其中包含一些基于 Xcode 4.5.2 的 OpenGL 游戏模板的投影矩阵设置代码。在函数中，我通过查询以及和`update`设置适当的 z 平移值。这有效地让我可以根据每个设备的方向设置屏幕上呈现的区域的比例。我还要求在运行时为设备的每个方向保持正确的渲染比例。`baseModelViewMatrix``[[UIDevice currentDevice] userInterfaceIdiom]``UIDeviceOrientationIsLandscape:``UIDeviceOrientationIsPortrait:``update``willAnimateRotationToInterfaceOrientation:duration:`

这一切都很好，但是我注意到当设备面向上或面朝下时，我的场景不会显示，我只看到看起来是空的 GLKView。将设备旋转到垂直于地平面的任何方向，可以将场景恢复到预期的行为。我试过检查`UIDeviceOrientationIsValidInterfaceOrientation:`，它似乎应该处理我需要的东西，但没有发现行为有任何差异。

我的猜测是，当检测到方向发生变化时，GLKit 会对 GLKView 进行一些自动更新，但我没有找到任何可能导致这种特定行为的明确答案。有什么想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T08:07:51.853

如果您使用 GLKMatrix4MakeLookAt 之类的函数，则需要确保您的查看方向与向上方向不平行。在直接向上或向下看的情况下，您需要将相机的“向上”矢量调整为另一个值，例如 0,0,-1 或 0,0,1。

# django - 如何使用 Django 模型进行不区分大小写的查询

> ID：14115046
> 
> 赞同：22
> 
> 时间：2013-01-01T23:02:39.100
> 
> 标签：django, django-models

我有一个`member`包含一个`email`字段的模型。我最近意识到，如果电子邮件的一部分大写，如果我尝试按电子邮件过滤（多个成员对象具有相同的电子邮件，但它可能不大写），它将不会出现在 Django 查询中。我本可以在将所有电子邮件输入数据库时​​将它们设为小写，但现在为时已晚（因为该网站已经启动）。那么如何在不区分大小写的情况下检查谁拥有特定的电子邮件？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-01-01T23:09:52.417

只需使用[iexact](https://docs.djangoproject.com/en/dev/ref/models/querysets/#iexact)：

```
User.objects.filter(email__iexact='email@email.com') 
```

> 不区分大小写的完全匹配。如果为比较提供的值为 None，它将被解释为 SQL NULL（有关更多详细信息，请参见 isnull）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-01T23:10:49.587

```
Member.objects.filter(email__iexact=email) 
```

# c# - Azure 表存储：执行插入期间出现 404 错误

> ID：14115049
> 
> 赞同：0
> 
> 时间：2013-01-01T23:03:13.600
> 
> 标签：c#, .net, azure, http-status-code-404, azure-storage

我正在编写一个查询以向表中插入 300k 行，在执行插入期间我收到 404 File or Directory not found 错误。我是天蓝色的菜鸟，所以我可能写了一些愚蠢的代码

我在这里创建 DynamicTableEntity 对象：

```
 Test t = new Test();
       t.CreateTable("table2");
        Dictionary<string, EntityProperty> dic;
        Random random = new Random();

        ArrayList part1 = new ArrayList();
        ArrayList part2 = new ArrayList();
        ArrayList part3 = new ArrayList();
        ArrayList part4 = new ArrayList();
        ArrayList part5 = new ArrayList();
        ArrayList part6 = new ArrayList();
        DynamicTableEntity dte;
        Stopwatch sw = new Stopwatch();
        Guid guid;
        sw.Start();
        for (int i = 0; i < 300000; i++)
        {

            dic = new Dictionary<string, EntityProperty>();

            dic.Add("count", new EntityProperty(i));
            dic.Add("rand1", new EntityProperty(random.Next()));
            dic.Add("rand2", new EntityProperty(random.Next()));
            dic.Add("rand3", new EntityProperty(random.Next()));
            if(i!=5)
            dic.Add("rand4", new EntityProperty(random.Next()));
            else
                dic.Add("rand4", new EntityProperty(1234561));

            if (i % 2 == 0)

                dic.Add("randInt", new EntityProperty(random.Next()));
            else
                dic.Add("String", new EntityProperty("This is a string" + i));

            guid = Guid.NewGuid();

            dte = new DynamicTableEntity("0" + (i % 3), DateTime.UtcNow.Ticks.ToString() + guid + i);

            dte.Properties = dic;

            if (i % 6 == 0)
                part1.Add(dte);
            else if (i % 6 == 1)
                part2.Add(dte);
            else if(i%6==2)
                part3.Add(dte);
            else if (i % 6 == 3)
                part4.Add(dte);
            else if (i % 6 == 4)
                part5.Add(dte);
            else if (i % 6 == 5)
                part6.Add(dte);

            if( (i + 1) % 600 == 0)
            {

                t.Insert("table2", part1, part2, part3, part4, part5, part6);
                part1.RemoveRange(0,100 );
                part2.RemoveRange(0, 100);
                part3.RemoveRange(0, 100);
                part4.RemoveRange(0, 100);
                part5.RemoveRange(0, 100);
                part6.RemoveRange(0, 100);
            }

        } 
```

这是插入执行代码：

```
 CloudTable table = _tableClient.GetTableReference(tableName);
        TableBatchOperation tablebatchoperation;
        int i = 0, j = 0;
        if (created == false)
            table.CreateIfNotExists();

        foreach (ArrayList k in l)
        {
            tablebatchoperation = new TableBatchOperation();

            foreach (DynamicTableEntity dte in k)
            {
                tablebatchoperation.Insert(dte);
            }
            table.ExecuteBatch(tablebatchoperation);
        } 
```

我感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T07:40:27.693

我在这里看到的一个可能问题是您正在执行一个包含 100 多个项目的批处理操作。尝试这样的事情（代码没有优化，但你会得到图片）：

```
 foreach (ArrayList k in l)
    {
        foreach (DynamicTableEntity dte in k)
        {
            if (tablebatchoperation == null)
               tablebatchoperation = new TableBatchOperation();
            tablebatchoperation.Insert(dte);
            if (tablebatchoperation.Count == 100)
            {
               table.ExecuteBatch(tablebatchoperation);
               tablebatchoperation = new TableBatchOperation();
            }
        }
    }

    if (tablebatchoperation.Count > 0)
        table.ExecuteBatch(tablebatchoperation); 
```

另请记住，单个批处理操作中的所有实体都应属于同一分区。你在哪里设置分区和行键？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T23:11:59.420

如果您查看以下问题，您可能会找到您需要的内容。这也是关于在插入方面实现出色的性能：[如何使用 Azure 表存储实现每秒 10 次以上的插入](https://stackoverflow.com/questions/12750302/how-to-achive-more-10-inserts-per-second-with-azure-storage-tables/12750535#12750535)

# ruby-on-rails - 朋友使用 facebook graph api 和 rails 签到 - APIError

> ID：14115052
> 
> 赞同：2
> 
> 时间：2013-01-01T23:03:31.943
> 
> 标签：ruby-on-rails, ruby-on-rails-3, facebook-graph-api, koala, facebook-checkins

我正在尝试让用户朋友签到，我正在使用omniauth 和koala gem。

当用户被保存时，此方法会命中：

```
def add_friends
 friends_data = facebook.get_connections("me", "friends", :fields => "id, name, link, picture, gender, checkins")
     friends_data.map do |h|
        friend = Friend.new
        friend.uid = h["id"]
        friend.name = h["name"]
        friend.image = h["picture"]
        friend.gender = h["gender"]
        friend.urls = h["link"]
        friend.user_id = self.id
        friend.save!

        if (!h["checkins"].blank?)
           checkin = Checkin.new
           checkin.checkin_id = h["id"]
           checkin.user_id = h["checkins"]["data"]["from"]["id"] 
           checkin.user_name = h["checkins"]["data"]["from"]["name"] 
           checkin.tags = h["checkins"]["tags"]["data"]["name"]
           checkin.place_id = h["checkins"]["place"]["id"]
           checkin.place_name = h["checkins"]["place"]["name"]
           checkin.message = h["checkins"]["message"]
           checkin.created_time = h["checkins"]["created_time"]
           checkin.friend_id = friend.id
           checkin.save!
           end
         end
      end 
```

但我得到这个错误：

```
Koala::Facebook::APIError: HTTP 500: Response body: {"error_code":1,"error_msg":"An unknown error occurred"} 
```

我真的不知道这意味着什么，有什么想法吗？有人知道如何定义考拉宝石签到的限制吗？我试过这样的事情：

```
u.facebook.get_connections("me","friends", :fields => "checkins.limit(2)") 
```

但我得到了同样的错误！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T17:39:12.223

在字段中，您正在请求有关朋友的信息，但“签到”不是个人资料字段，而是完全不同的连接。

您必须做的是遍历所有朋友 ID 并获取每个 ID：

```
friend_checkins = []
friend_ids = u.facebook.get_connections("me","friends", :fields => "id")
friend_ids.each do |friend_id|
    friend_checkins << u.facebook.get_connections(friend_id,"checkins")
end 
```

此外，在执行此操作时，这将是[使用 Koala 查看批处理请求](https://github.com/arsduo/koala/wiki/Batch-requests)的好时机，因为您可能会在这里对 API 进行大量调用。

# c# - 为什么类型推断和隐式运算符在以下情况下不起作用？

> ID：14115059
> 
> 赞同：2
> 
> 时间：2013-01-01T23:04:36.960
> 
> 标签：c#, .net, generics, type-inference, implicit-conversion

我将尝试通过一个示例来解释我的问题：

```
class V<T>
{
    public readonly Func<T> Get;
    public readonly bool IsConstant;

    V(Func<T> get, bool isConstant)
    {
        Get = get;
        IsConstant = isConstant;
    }

    public static implicit operator V<T>(T value)
    {
        return new V<T>(() => value, true);
    }

    public static implicit operator V<T>(Func<T> getter)
    {
        return new V<T>(getter, false);
    }
}

void DoSomething<T>(V<T> v)
{
    //...
}

void Main()
{
    DoSomething<string>("test"); // (1) type inference is not working
    DoSomething<string>((V<string>)(() => "test")); // (2) implicit operator does not work
} 
```

在方法`Main`中，我有两种情况：

1.  我必须明确指定`<string>`方法的通用参数`DoSomething`。
2.  在这里，我必须添加显式强制转换`(V<string>)`，隐式运算符似乎不起作用。

为什么需要这个？编译器正在考虑哪些替代方案，因此无法选择正确的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T01:40:10.097

你的第二个问题是为什么隐式转换从`()=>""`to`V<string>`不成功，即使`()=>""`is convertible to`Func<string>`并且`Func<string>`is convertible to `V<string>`。

同样，我不知道如何回答“为什么不呢？” 问题，但我确实知道如何回答“规范的哪一行表明编译器应该拒绝此代码？”这个问题。相关线路是：

> 首先，如果需要，执行从源类型到用户定义或提升转换运算符的操作数类型的标准转换。

注意这里有一个小错误；*这应该说从源表达式*执行标准转换。源表达式可能没有类型。我相信在我离开团队之前我已经向规范维护者提供了该说明，因此希望这将在下一版本中得到解决。

无论如何，现在应该清楚这里发生了什么。没有从 lambda 到委托类型的**标准**转换，因此用户定义的转换被转换解析算法归类为*不适用。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-02T01:27:53.607

我假设您的代码打算调用 DoSomething，而不是 DumpValue。

你的问题是，首先，为什么

```
DoSomething(""); 
```

不推断该呼叫的目的是

```
DoSomething<string>((V<string>)""); 
```

正确的？

“为什么”的问题很难回答，而“为什么不呢？” 问题更难。相反，我将回答一个可以回答的问题：**规范的哪一行证明了这种行为？**

重载解析的工作方式如下：如果方法组包含泛型方法但没有提供泛型方法类型参数，则类型推断会尝试推断类型参数。如果无法推断类型参数，则将该方法从重载决议的考虑中删除。在您的情况下，由于方法组中只有一个方法，因此删除它会导致重载解析失败。

那么为什么类型推断会失败呢？T 无法推断，因为规范的控制线是：

> 如果 V 是一个构造类型`C<V1…Vk>`，并且存在一组唯一的类型 U1…Uk，使得存在从 U 到的标准隐式转换，`C<U1…Uk>`则从每个 Ui 对相应的 Vi 进行精确推断。

从to没有**标准的隐式转换**。那是**用户定义的隐式转换。**`string``V<string>`

 **因此类型推断失败。

我将在第二个答案中回答您的第二个问题。一般来说，同时提出两个问题是个坏主意。当您有两个问题时，发布两个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T04:50:49.287

我知道您的问题是“为什么类型推断不起作用”，但我只是想我会在最后解决您关于 2 个替代方案的陈述。在这种情况下，我相信隐式转换的更好替代方案（我讨厌那些）是静态工厂方法。IMO，当您调用`DumpValue`.

```
static class VFactory
{
    public static V<T> Create<T>(T value)
    {
        return new V<T>(() => value, true);
    }

    public static V<T> Create<T>(Func<T> getter)
    {
        return new V<T>(getter, false);
    }
}

class V<T>
{
    public readonly Func<T> Get;
    public readonly bool IsConstant;

    internal V(Func<T> get, bool isConstant)
    {
        Get = get;
        IsConstant = isConstant;
    }
}

void DumpValue<T>(V<T> v)
{
    //...
}

void Main()
{
    DumpValue(VFactory.Create("test"));
    DumpValue(VFactory.Create(() => "test"));
} 
```**

# file - 在 Matlab 中从 Mat 文件加载数据时变量变化的类型

> ID：14115060
> 
> 赞同：1
> 
> 时间：2013-01-01T23:04:38.480
> 
> 标签：file, matlab, variables

我在 Matlab 有一个变量，它是：

```
<2196x1 cell> 
```

我将其保存为：

```
save('var.mat','var'); 
```

我用负载读取它，但我拥有的变量是：

```
<1x1 struct> 
```

如何再次从文件中读取它作为单元向量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T23:25:47.637

我认为如果你使用

```
x = load('var.mat') 
```

你最终得到一个 1x1 结构，`x.var`原始的保存变量在哪里。要在保存它们时取回原始变量，请尝试使用

```
load('var.mat');  %No output argument 
```

这会将原始变量放回工作区。

如果需要，此行为允许您加载具有相同名称的多个变量（例如`x.var`和`y.var`）。

# ruby-on-rails - Rake des 不知道如何构建任务“编译”，如何跟踪此错误？

> ID：14115063
> 
> 赞同：4
> 
> 时间：2013-01-01T23:04:47.357
> 
> 标签：ruby-on-rails, ruby, rake

我收到错误“不知道如何构建任务'编译'”。我还是 ruby​​ 的新手，但是所有这些痕迹似乎都指向我没有编写的代码，那么我应该如何处理这个错误？

```
#> rake 编译 --trace
耙中止！
不知道如何构建任务“编译”
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/task_manager.rb:49:in `[]'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/application.rb:142:in `invoke_task'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/application.rb:101:in `block (2 levels) in top_level'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/application.rb:101:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/application.rb:101:in `block in top_level'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/application.rb:95:in `top_level'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/application.rb:73:in `block in run'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
/usr/local/rvm/gems/ruby-1.9.3-p286/gems/rake-10.0.3/bin/rake:33:in `'
/usr/local/rvm/gems/ruby-1.9.3-p286/bin/rake:23:in `load'
/usr/local/rvm/gems/ruby-1.9.3-p286/bin/rake:23:in `'

```

这是 Rakefile：

```
需要“捆绑器/gem_tasks”
需要“耙子”
需要“耙子/扩展任务”
$myDir = File.dirname(__FILE__)

需要 $myDir + '/lib/Q/console.rb'
需要 $myDir + '/lib/Q/version.rb'
需要 $myDir + '/lib/Q/rakeoverride.rb'
需要 $myDir + '/lib/Q/filetools.rb'

# 这只是打印出一个标题和 gems 版本号
puts Q::Console.txHead('Q-Pool Ruby Extension Q V' + Q::VERSION)

# 从 gemspec 加载规范并创建
# 每个扩展文件的任务
# 可执行文件。
规格 = Gem::Specification.load('Q.gemspec')
spec.executables.each 做 |f|
  Rake::ExtensionTask.new('Q', spec) 做 |ext|
    # 扩展文件是*.so，所以我们需要
    # 砍掉扩展名得到名字
    ext.name = f.gsub(/\.so$/,'')
    ext.tmp_dir = 'tmp'
    ext.lib_dir = 'bin'
  结尾
结尾

# 通过删除旧的二进制文件来清理环境
override_task :clean 做
  puts Q::Console.txNote('cleaning...')
  clear_tmp
  开始
    Rake::Task["clean:original"].invoke
    puts Q::Console.txConfirm('...cleaned!')
  救援
    puts Q::Console.txAlert('could not clean: ' + $!.to_s)
    出口
  结尾
结尾

# 初始化目录结构
任务：初始化做
  FileCheckCreateDirectory($myDir + '/bin')
  FileCheckCreateDirectory($myDir + '/tmp')
结尾

# 编译模块并安装到 lib
override_task ：编译做
  puts Q::Console.txNote('正在编译...')
  开始
    Rake::Task["compile:original"].invoke
    提出 Q::Console.txConfirm('...已编译！')
  救援异常
    puts Q::Console.txAlert('无法编译：' + $!.to_s)
    出口
  确保
    clear_tmp
    看跌期权
  结尾
结尾

# 显示命令
任务：帮助做
  显示帮助
结尾

# 构建模块并安装
任务 :build => [:init, :clean, :compile]

Bundler::GemHelper.install_tasks

# 删除所有临时文件
def clear_tmp
  FileUtils.rm_rf(Dir.glob($myDir + '/tmp/*'))
结尾

# 显示帮助画面
def show_help
  Q::Console.out(Q::Console.txCode('build') + ' 执行初始化、清理和编译。')
  Q::Console.out(Q::Console.txCode('clean') + ' 从 temp-dir 中删除任何旧的二进制文件。')
  Q::Console.out(Q::Console.txCode('compile') + ' 编译二进制文件。')
  Q::Console.out(Q::Console.txCode('help') + ' 登记 rake-commands (this page).')
  Q::Console.out(Q::Console.txCode('init') + ' 创建 gems 目录结构。')
  看跌期权
结尾

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T08:24:46.153

好吧，这个错误信息真的没什么用……</p>

问题是 Gem::Specification.executables 是空的，因为 gemspec 中的正则表达式不匹配。当我迭代它时（参见 Rakefile），没有扩展任务构建，因此产生了误导性错误。

# javascript - js/jquery - 如何获取没有索引的数组值

> ID：14115065
> 
> 赞同：1
> 
> 时间：2013-01-01T23:04:55.267
> 
> 标签：javascript, jquery, arrays

我有以下数组：

```
>>> var cars = new Array;
undefined

>>> cars[5] = 'Volvo';
"Volvo"

>>> cars[10] = 'Honda';
"Honda"

>>> cars
[undefined, undefined, undefined, undefined, undefined, "Volvo", undefined, undefined, undefined, undefined, "Honda"]

>>> cars.length
11 
```

有没有一种方法可以让新的数组从中得到`cars`不是稀疏的`['Volvo', 'Honda']`。实际上，在我的情况下，即使值的顺序也不重要。

当然，我可以通过循环来完成，但我正在寻找更优雅的解决方案。`jQuery`也是一种选择！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:13:40.977

[`jQuery.map`](http://api.jquery.com/jQuery.map/)数组会自动展平吗：

```
var flattenedArr = $.map(cars, function(v) {
    return v;
}); 
```

[**小提琴**](http://jsfiddle.net/9a8pB/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T23:10:41.903

```
cars = $.grep(arr, function(n){
    return(n);
}); 
```

这只会留下数组的已定义元素并忽略未定义的元素。

[更多信息](http://api.jquery.com/jQuery.grep/)

# c++ - 为什么我会收到缺少哨兵警告？

> ID：14115072
> 
> 赞同：1
> 
> 时间：2013-01-01T23:05:59.200
> 
> 标签：c++, operating-system, exec, fork

基本代码：

```
 char *args[3] = {NULL};
        args[0] = "ls";
        args[1] = "-l";
        args[2] = NULL; 
```

为什么会 ：

```
 int execution = execlp("ls", args[0], args[1], NULL); 
```

不引起警告，并且：

```
 int execution = execlp("ls", args[0], args[1], args[2]); 
```

引起警告：*函数调用中缺少哨兵？*

注意：我知道两者是相同的，但我只是好奇为什么一个会引起警告而不是另一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:08:41.693

因为[`The list of arguments must be terminated by a NULL pointer`](http://linux.die.net/man/3/execlp). 即使`args[2]`碰巧`NULL`在您的情况下，编译器也没有这种洞察力（如果您问我，也不应该）。

如果有人出现并改变`args[2]`了其他东西，却不知道它被用作哨兵怎么办？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T23:08:32.590

因为编译器不智能。

它期望哨兵是文字`0`或`NULL`（实际上只是`0`或`(void *)0`），其他任何东西都会产生警告。如果编译器更聪明并且它对代码执行了更多的静态分析，它可能会得出结论`args[2]`确实是一个常量 0，所以不需要警告，但显然它不能。

# php - 从两个已知单词生成随机单词

> ID：14115073
> 
> 赞同：3
> 
> 时间：2013-01-01T23:06:00.587
> 
> 标签：php

我可以用数字做到这一点：

```
<?=number_format(mt_rand(0,1));?> 
```

我想要做的是，而不是 0 或 1，回显单词**firstclass**或**secondclass**。

这是因为我不能在 CSS 中使用数字作为类标识符。

本质上，这只是为了在列表中显示随机的东西，并在类标识符前面加上 firstclass 或 secondclass。

```
.firstclass {display:none;} 
```

我不是 PHP 高手，所以我想我需要设置一个数组，并以某种方式属性：

0 = 一等
1 = 二等

在数组中，这样我就可以让我的小测试脚本正常工作。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T23:09:35.510

```
<?php echo (mt_rand(0,1) == 0 ? 'firstclass' : 'secondclass'); ?> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-01T23:08:15.200

像这样？：

```
$words = array('firstclass', 'secondclass');
$randomWord = $words[mt_rand(0,1)]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-01T23:17:01.333

或者...

```
class="a-prefix-<?=number_format(mt_rand(0,1));?>" 
```

CSS 类必须以下划线、破折号或字母开头，但后面可以有数字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-01T23:16:17.003

如果你要这么说`0 = firstclass`，`1 = secondclass`为什么不像这样使用[array_rand](http://php.net/manual/en/function.array-rand.php)：

```
$classes = array(
    'firstclass',
    'secondclass'
);

$randClass = $classes[array_rand($classes)];

echo $randClass; 
```

如果您需要，这也将使您可以添加更多类

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-01T23:08:52.433

如果您只有两种可能性，则可以使用[三元式 if 语句：](http://davidwalsh.name/php-shorthand-if-else-ternary-operators)

```
<?=(mt_rand(0,1) == 0) ? 'firstclass' : 'secondclass'?> 
```

# asp.net-mvc - 类不能用作泛型类型或方法中的类型参数，没有隐式引用转换

> ID：14115075
> 
> 赞同：1
> 
> 时间：2013-01-01T23:06:10.307
> 
> 标签：asp.net-mvc, generics, inheritance

我正在为我的 MVC 4 项目构建（尝试构建）通用存储库、任务和控制器，并使用它来学习泛型和接口。我已经走了很远，但坚持这个错误。CustomerContactsListViewModel 确实继承自 IViewModelList，这就是我感到困惑的原因。

错误：

```
The type 'OTIS.AppServ.OrderMgmt.ViewModels.CustomerContactsListViewModel' cannot be used as type parameter 'TViewModelList' in the generic type or method 'OTIS.AppServ.BaseAppServGrid<TRepository,TViewModelSingle,TViewModelList>'. There is no implicit reference conversion from 'OTIS.AppServ.OrderMgmt.ViewModels.CustomerContactsListViewModel' to 'OTIS.AppServ.IViewModelList<OTIS.domain.OrderMgmt.Customer,OTIS.AppServ.OrderMgmt.ViewModels.CustomerContactsListViewModel>'. 
```

界面：

```
public interface IViewModelList<TClass, TViewModelList>
    {
        IEnumerable<TClass> ConvertViewModelToClass(IEnumerable<TViewModelList> entityList);
        IEnumerable<TViewModelList> ConvertClassToViewModel(IEnumerable<TClass> entityList);
    } 
```

继承接口的视图模型：

```
 public class CustomerContactsListViewModel : IViewModelList<CustomerContact, CustomerContactsListViewModel>, IEntity 
```

被继承的通用任务（应用程序服务）类：

```
public class BaseAppServGrid<TRepository, TViewModelSingle, TViewModelList> : BaseAppServ<TRepository, TViewModelSingle>
            where TRepository : class, IEntity, IAuditStamps, new()
            where TViewModelSingle : class, IViewModelSingle<TRepository, TViewModelSingle>, new()
            where TViewModelList : class, IEntity, IViewModelList<TRepository, TViewModelList>, new() 
```

尝试继承 Base 的特定 Task/App 服务类会引发错误：

```
public class ManageCustomersAppServ : BaseAppServGrid<Customer, CustomerViewModel, CustomerContactsListViewModel> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:16:58.577

在`CustomerContactsListViewModel`您已经实现了`IViewModelList`类型的第一个参数`CustomerContact`。

但是，该类`ManageCustomersAppServ`已使用 type 声明`Customer`。

所以

```
IViewModelList<Customer, CustomerContactsListViewModel> 
```

不可分配给

```
IViewModelList<CustomerContact, CustomerContactsListViewModel> 
```

您需要：

1.  Change `BaseAppServGrid` to take another generic parameter like so:

    ```
    public class BaseAppServGrid<TModel, TRepository, TViewModelSingle, TViewModelList> :
        BaseAppServ<TRepository, TViewModelSingle>
        where TRepository : class, IEntity, IAuditStamps, new()
        where TViewModelSingle : class, IViewModelSingle<TRepository, TViewModelSingle>, new()
        where TViewModelList : class, IEntity, IViewModelList<TModel, TViewModelList>, new()

    public class ManageCustomersAppServ : BaseAppServGrid<CustomerContact, Customer, CustomerViewModel, CustomerContactsListViewModel> 
    ```

2.  Review whether Customer *and* CustomerContact can derive from some IRepository interface/class, if that was your intention when you passed Customer to a generic param called "TRepository".

# mysql - 在mysql表中检查年龄

> ID：14115078
> 
> 赞同：0
> 
> 时间：2013-01-01T10:06:53.523
> 
> 标签：mysql, sql, mysql-workbench

我是 Mysql 的新手，我需要帮助从 horse table 中找到 10 岁以上的马匹，其中仅包含“Born”和“Died”列，例如 Born (1986) Died (1998) ）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T12:14:01.943

纯种马被认为是在其出生年份的 1 月 1 日出生的。所以你只需要简单的减法就可以得到正确的答案。

```
select horse_name
from horses
where born < (year(current_date) - 10)
  and died is null; 
```

如果您真的想找到 10 岁或以上的马，请将运算符从“<”更改为“<=”。

# javascript - 检测对背景附件的支持：已修复？

> ID：14115080
> 
> 赞同：19
> 
> 时间：2013-01-01T23:06:42.547
> 
> 标签：javascript, jquery, css, modernizr

有没有办法检测浏览器对背景附件的支持：已修复？

编辑：虽然此功能在桌面浏览器上得到广泛支持，但在便携式设备上的支持很差，这就是为什么我希望能够检测到该功能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-02-10T06:52:28.490

当您使用 { background-attachment:fixed } 当前移动设备根本不会显示背景图像！为确保图像显示在所有移动设备上，您需要测试是否支持，如果不支持，请将 background-attachment 属性设置为“初始”（即默认状态）或“滚动”（默认状态） .

## 坏消息：

目前不可能*直接和专门*测试对固定背景的支持，因为移动浏览器会错误地报告他们确实支持它。要亲自查看此错误，请在移动浏览器中加载此测试：

[http://codepen.io/mattthew/pen/PwEqJa](http://codepen.io/mattthew/pen/PwEqJa)

```
function supportsCSS(value) {
    try {
        var style = document.body.style;
        if (!("backgroundAttachment" in style)) return false;
        var oldValue = style.backgroundAttachment;
        style.backgroundAttachment = "fixed";
        var isSupported = (style.backgroundAttachment === value);
        style.backgroundAttachment = oldValue;
        return isSupported;
    }
    catch (e) {
        return false;
    }
}

var el = document.getElementById('result');
var txt = '<b>This device &amp; broswer supports:</b><br>';
txt += '{ background-attachment:fixed; } : ' + supportsCSS('fixed') + '<br>';
txt +=  { background-attachment:foo; } : ' + supportsCSS('foo');

el.innerHTML = txt; 
```

基于最初编写的代码：@chao

* * *

## 有限的选项：

可以使用多种方法间接测试支持。

**选项 1：删除小屏幕上的固定背景**

此选项使用 CSS 媒体查询来定位较小的屏幕，以覆盖屏幕宽度为 1024 像素或更小的设备上的样式（设备可能会将固定背景呈现为不可见）。这个选项的优点是：它非常轻量级并且只需要一点 CSS：

```
#some_element {
     background-attachment: fixed;
}

@media all and (max-device-width: 1024px) {
     /* 
     overwrite property for devices with 
     screen width of 1024px or smaller  
     */
     #some_element {
          background-attachment: scroll;
     }
} 
```

不幸的是，有少数平板电脑品牌的屏幕宽度为 1280px 和 1366px，与最小的桌面屏幕重叠（按 CSS 高度排序[此列表）。](http://mydevice.io/devices/#sortTablets)最安全的做法是对这个重叠区域使用滚动背景，以保证显示背景图像。 **如果你想安全起见，请使用 max-device-width: 1366px。** 然而，使用这些巨型平板电脑的人数远远少于使用小屏幕笔记本电脑的人数。

**选项 2：测试触摸事件和鼠标事件**

此选项使用 JS 来测试浏览器是否支持触摸事件 API，因此*更有可能*在触摸屏设备上（该设备更有可能将固定背景渲染为不可见）。这是重量级选项。它需要[Modernizr](http://modernizr.com)和 jQuery：

```
if(Modernizr.touch) {
  // this browser claims to support touch, so remove fixed background
  $('#some_element').css('background-attachment','scroll');
} 
```

不幸的是，这个选项也有一个灰色区域。一些浏览器给出误报，一些浏览器给出误报。您可以测试鼠标事件，例如：

```
$('body').mousemove(function(event){
  // this device (touch or not) has a mouse, so revert to fixed background
  $('#some_element').css('background-attachment','fixed');
  $('body').unbind('mousemove');
}); 
```

但是，鼠标可能已连接到不支持固定背景的触摸屏笔记本电脑，因此代码增加了风险。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T00:02:49.657

您可能会查看`document.body.style`并确保

*   那里有一个名为“backgroundAttachment”的属性，并且
*   您可以将其设置为“固定”，并在您这样做时保留其值。

Chrome、FF、Opera 和 Safari 都会忽略将属性设置为无效值的尝试。当您尝试时，IE9 会引发异常。因此，如果发生任何一种情况，则绝对不支持该值。（如果浏览器只是盲目地设置值并保留它，那么它可能仍然无法正常工作。但到那时，你真的不能让浏览器告诉你太多。）

```
function supportsFixedBackground() {
    try {
        var style = document.body.style;
        if (!("backgroundAttachment" in style)) return false;
        var oldValue = style.backgroundAttachment;
        style.backgroundAttachment = "fixed";
        var isSupported = (style.backgroundAttachment === "fixed");
        style.backgroundAttachment = oldValue;
        return isSupported;
    }
    catch (e) {
        return false;
    }
} 
```

我不再使用 IE6，也没有其他不支持固定背景的浏览器，所以我无法测试设置“固定”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-27T13:02:02.323

我想我已经为所有设备找到了解决方案。可以检测到`clip`-support，所以我就这样做了，并在 DOM 中更改了`clip`支持的时间。如果不是，它会退回`background-attachment: fixed;`

**[请参阅https://codepen.io/AartdenBraber/pen/gGmdWK](https://codepen.io/AartdenBraber/pen/gGmdWK)**上的代码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-01T23:39:45.170

可以通过以下步骤检测对任何 CSS 属性值的支持：

1.  创建一个临时元素（例如`DIV`）；
2.  将其`style`DOM 属性的值（`element.style.backgroundAttachment`在您的情况下）设置为要检查的值（`fixed`在您的情况下）；
3.  将实际`style`值与指定字符串进行比较。

在你的情况下是这样的：

```
var elem = document.createElement('div');
elem.style.backgroundAttachment = 'fixed';
var isSupported = 'fixed' === elem.style.backgroundAttachment; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-02T04:22:42.390

`@supports (background-attachment: fixed)`将报告 true，因为浏览器引擎成功解释了属性和值。然后，移动 webkit 决定将您的背景绑定到与应用它的元素相同的*堆叠上下文*（相同的渲染平面），以获得“更好的性能”。（所有 z-index 都有自己的堆叠层，在桌面浏览器上，固定背景有自己的层。）

可以使用 JS 来检测具有这种呈现模式的浏览器，方法是检查用户代理中的`iPhone` `iPad` `iPod`& `Android`，这可能针对正确呈现固定背景的移动浏览器，例如不断发展的移动 Firefox。但是，我在纯 CSS 中找到了更好的方法：

**适用于移动 Safari 和 Chrome 的纯 CSS 解决方案：**

`@supports (-webkit-overflow-scrolling: touch)`针对拒绝将背景绑定到视口的所有相同版本的移动 webkit。

因此，考虑到这一点，您可以默认修复背景，然后附加此`@supports`规则以应用一种移动 polyfill：

**例子：**

```
body {
 background-image: url('bg.png');
 background-size: cover; background-attachment: fixed;
}

@supports (-webkit-overflow-scrolling: touch) {

 /* Detach problematic background */
 body { background: none !important; }

 /* Insert empty div at bottom of page */
 #lonelyDiv {
  position: fixed; top: 0px; left: 0px; z-index: -1;
  width: 100%; height: 100%;

  /* Using same background with size=cover may be possible in some situations */
  background-image: url('bg.png'); background-size: cover;

  /* Other designs may require a stretchable background...
   or cropped versions for mobile aspect ratios applied after @media (orientation) rules */
  background-image: url('mobile-bg.png'); background-size: 100%;
 }
} 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2013-01-01T23:21:07.700

`fixed`所有桌面浏览器都支持，除了 IE6 和更早版本。

大多数移动浏览器都支持它，但由于视口处理，您可能会看到一些差异。

[资源](http://www.quirksmode.org/css/backgroundattachment.html)

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2013-01-01T23:14:47.940

[http://www.w3schools.com/cssref/pr_background-attachment.asp](http://www.w3schools.com/cssref/pr_background-attachment.asp)

页面下方有一些主要浏览器图标的图片。任何图标的图像都不会变灰。它说它在所有浏览器中都受支持

# backbone.js - 在主干中保存集合的最佳方法是什么？

> ID：14115086
> 
> 赞同：0
> 
> 时间：2013-01-01T23:07:27.807
> 
> 标签：backbone.js, backbone.js-collections

我一次保存一个模型没有问题，我在对象数组上编写了一个递归保存。在每次成功保存时，我移出一个对象，如果数组长度不是 0 -> 重复...一旦数组长度达到零，那么我知道所有保存都成功并执行适当的操作。

大声想知道是否有更好的方法？与上述方法相比，其余服务 api 不采用集合，但如果我有保存集合的示例，我会要求修改服务。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T02:42:51.030

尽管集合中没有`save`内置方法，但这当然是个好主意。您的情况听起来会从中受益，因为循环遍历每个模型并单独保存它们是完成此任务的一种非常非常非常昂贵的网络流量方式。

Backbone 的核心是使用 jQuery 的 AJAX 发布到服务器……那么为什么不在您的收藏中利用它呢？

```
 $.ajax({
  type: "POST",
  url: "/my/api",
  dataType: "JSON",
  data: myCollection.toJSON()
}); 
```

这会将一组对象作为 JSON 发送回`/my/api`端点的服务器。您可以轻松地将其包装到您的集合或另一个对象中的方法中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T07:55:25.187

我直接在集合中使用保存功能来做到这一点：

```
Backbone.sync('update', this, {
    success: function() {
        alert('saved');
    }
}); 
```

希望能帮助到你。

# ruby-on-rails - 用于搜索的 Bing API - Rails

> ID：14115087
> 
> 赞同：2
> 
> 时间：2013-01-01T23:07:34.037
> 
> 标签：ruby-on-rails, ruby-on-rails-3, bing, bing-api

有人知道新 Bing API 的宝石吗？由于新的 Azure 市场版本，似乎 rbing 和 binger 都不再起作用了。

微软的例子是 PHP。

# printing - 在 Julia 中为新类型定义类似 print() 的函数

> ID：14115088
> 
> 赞同：8
> 
> 时间：2013-01-01T23:07:45.080
> 
> 标签：printing, julia

为了在 Julia 中使一种新类型可打印，应该定义哪些方法？我相信一个人应该只定义`show`，这将引发其他函数的行为，例如：

*   打印
*   细绳
*   repl_show
*   展示紧凑型
*   显示所有

哪些方法需要为新类型定义？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T21:01:24.060

如果 Base 来源是任何可靠的参考，`base/version.jl`则只有`print()`并`show`定义（并且`show`取决于`print`）

```
function print(io::IO, v::VersionNumber)
    print(io, v.major)
    print(io, '.')
    print(io, v.minor)
    print(io, '.')
    print(io, v.patch)
    if !isempty(v.prerelease)
        print(io, '-')
        print_joined(io, v.prerelease,'.')
    end
    if !isempty(v.build)
       print(io, '+')
       print_joined(io, v.build,'.')
    end
end
show(io, v::VersionNumber) = print(io, "v\"", v, "\"") 
```

在这一点上，如果您想依赖一个常用功能，这似乎取决于您。您只需以这种方式实现所有此类功能。例子：

```
type Foo
end
import Base.string
function string(x::Foo)
    return "a Foo()"
end
import Base.print
print(io::IO, x::Foo) = print(io, string(x))
import Base.show
show(io::IO, x::Foo) = print(io, "This is ", x) 
```

-

```
julia> f = Foo()
This is a Foo() 
```

# jquery - 检查网格/子网格是否存在

> ID：14115089
> 
> 赞同：0
> 
> 时间：2013-01-01T23:07:54.607
> 
> 标签：jquery, jqgrid

我想检查我的子网格是否存在（已扩展）。

我想这样做是因为我想用一个按钮将所有更改的数据保存在我的网格和所有子网格中。但是并不总是扩展每个子网格（我将在两次迭代中执行此操作） - 所以我必须检查子网格是否存在以保存它。

我试过

```
if(jQuery("#example").grid) { ... } 
```

和

```
if(jQuery("#example")) { ... } 
```

但是这些语句的输出始终是“未定义的”。网格名称绝对是正确的 - 我只是在这里写了#example ;-)

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:55:39.737

当你想查找一个元素是否存在 jQuery 对象的测试长度

```
if(jQuery("#example").length) {
   /* element with ID=example exists*/
} 
```

您提到`expanded`但没有说明 html 示例或解释如何`expanded`工作。

另请注意，ID 不能在页面中重复。如果您有重复的 ID，肯定需要查看 html 以便为遍历创建更好的解决方案。我提到这一点是因为引用了多个子网格和一个 ID 选择器被用作示例代码

# jquery - 如何处理 jQuery 下拉菜单

> ID：14115091
> 
> 赞同：2
> 
> 时间：2013-01-01T23:08:08.683
> 
> 标签：jquery

html

```
 <select id="combo1" class="combo" data-index="1">
        <option></option>
        <option val="Opt1">Opt1</option>
        <option val="Opt2">Opt2</option>
        <option val="Opt3">Opt3</option>
    </select> 
```

jQuery

```
$('body').on('change', '.combo', function() {
    var selectedValue = $(this).val();

if ($(this).find('option').size() > 2) {
    var newComboBox = $(this).clone();
    var thisComboBoxIndex = parseInt($(this).attr('data-index'), 10);
    var newComboBoxIndex = thisComboBoxIndex + 1;

    $('.parentCombo' + thisComboBoxIndex).remove();

    if (selectedValue !== '') {
        newComboBox.attr('data-index', newComboBoxIndex);
        newComboBox.attr('id', 'combo' + newComboBoxIndex);
        newComboBox.addClass('parentCombo' + thisComboBoxIndex);
        newComboBox.find('option[val="' + selectedValue + '"]').remove();
        $('body').append(newComboBox);
    }
}
}); 
```

[小提琴](http://jsfiddle.net/JaVVe/6/)

此代码正在运行，并且每次填充之前的组合框时都会创建一个新的组合框。

我怎样才能每两个下拉菜单换行？像这样：

![在此处输入图像描述](../Images/8da3e05cebdb354c047e916bb8f42a6d.png)

以及如何强制它始终填充偶数个组合框。例如。如果仅填充了 3 个组合框，则必须警告错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:16:45.147

这假设您将选择框放在仅包含选择框和 br 的容器中。（通过验证更新）

```
$('body').on('change', '.combo', function() {
    var selectedValue = $(this).val();

    if ($(this).find('option').size() > 2) {
        var newComboBox = $(this).clone();
        var thisComboBoxIndex = parseInt($(this).attr('data-index'), 10);
        var newComboBoxIndex = thisComboBoxIndex + 1;

        $('.parentCombo' + thisComboBoxIndex).remove();

        if (selectedValue !== '') {
            newComboBox.attr('data-index', newComboBoxIndex);
            newComboBox.attr('id', 'combo' + newComboBoxIndex);
            newComboBox.addClass('parentCombo' + thisComboBoxIndex);
            newComboBox.find('option[val="' + selectedValue + '"]').remove();
            $('body').append(newComboBox);
        }
        $('body br').remove();
        $('body select:odd').after($('<br />'));
    } 

    validate();
});

function validate() {
    var count = $('body select[value!=""]').length;
    if (count > 0 && count % 2 == 0) 
        $('#ok').text('OK!');
    else
        $('#ok').text('Not an even number selected');
} 
```

​</p>

[http://jsfiddle.net/P5nV8/4/](http://jsfiddle.net/P5nV8/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T23:29:16.857

看这个演示：http: [//jsfiddle.net/JaVVe/15/](http://jsfiddle.net/JaVVe/15/)

```
i = 2;
$('body').on('change', '.combo', function() {

    var selectedValue = $(this).val();

    if ($(this).find('option').size() > 2) {
        var newComboBox = $(this).clone();
        var thisComboBoxIndex = parseInt($(this).attr('data-index'), 10);
        var newComboBoxIndex = thisComboBoxIndex + 1;

        $('.parentCombo' + thisComboBoxIndex).remove();

        if (selectedValue !== '') {
            newComboBox.attr('data-index', newComboBoxIndex);
            newComboBox.attr('id', 'combo' + newComboBoxIndex);
            newComboBox.addClass('parentCombo' + thisComboBoxIndex);
            newComboBox.find('option[val="' + selectedValue + '"]').remove();
            $('body').append(newComboBox);
            i++
            if (Math.floor(i/2) < +i/2){
            $('body').append('<hr />');
            }
        }
    } 
});​ 
```

# amazon-web-services - AWS 云形成 cfn-init 错误

> ID：14115093
> 
> 赞同：0
> 
> 时间：2013-01-01T23:08:26.057
> 
> 标签：amazon-web-services, amazon-cloudformation

我正在尝试使用 Cloud Formation 脚本创建集群结构。我正在使用 Bitnami drupal AMI。Bu脚本产生以下错误：

```
WaitCondition received failed message: 'Failed to run cfn-init' for uniqueId: i-4d121a16 
```

然后我连接到实例并检查 cfn-init.log：

```
bitnami@ip-10-58-51-235:/var/log$ cat cfn-init.log                              
2013-01-01 19:18:23,128 [INFO] Starting new HTTP connection (1): 169.254.169.254
2013-01-01 22:52:17,607 [INFO] Starting new HTTP connection (1): 169.254.169.254
2013-01-01 22:52:17,621 [INFO] Starting new HTTPS connection (1): cloudformation-waitcondition-    eu-west-1.s3.amazonaws.com 
```

我的 AWS 控制台事件如下：

逻辑 ID PhysicalID 状态 原因

mycluster arn:aws:cloudformation:eu-west-1:318730... CREATE_FAILED 未能创建以下资源：[WaitCondition]

WaitCondition vgdrobe-WaitCondition-UWEKNUJ8TMT6 CREATE_FAILED WaitCondition 收到失败消息：'无法运行 cfn-init' for uniqueId：i-59272f1c

WaitCondition vgdrb-WaitCondition-MML6Y6E47WTB CREATE_IN_PROGRESS

WebServerGroup vgdrb-WebServerGroup-1OBJYOSQX8093 CREATE_COMPLETE

我找不到问题。请问你能帮帮我吗？

亲切的问候...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T14:11:13.800

cfn-init 脚本是否可能不是图像的一部分？

根据[文档](http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-helper-scripts-reference.html)，它们作为 Amazon Linux 映像的一部分安装，但默认情况下可能不包含在其他映像中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-04T21:02:00.743

扩展 Chris 的建议，我必须添加以下内容才能让 cfn-init 处理我的 CloudFormation 脚本：

```
"apt-get -y install python-setuptools\n", 
"easy_install https://s3.amazonaws.com/cloudformation-examples/aws-cfn-bootstrap-1.0.tar.gz\n", 
```

我在这里找到了一些非常有用的信息：http: [//smart421.wordpress.com/2012/12/14/aws-cloudformation-and-chef-on-centos/](http://smart421.wordpress.com/2012/12/14/aws-cloudformation-and-chef-on-centos/)

我还发现我的 UserData 中的错误导致 cfn-init 失败。我通过在上传之前使用 VS2012 验证脚本来解决这个问题（如此处建议：[如何快速有效地调试 CloudFormation 模板？](https://stackoverflow.com/questions/11854772/how-can-i-quickly-and-effectively-debug-cloudformation-templates)）。

希望有帮助。

# jquery - IE 不为 MVC 呈现隐藏的输入字段

> ID：14115100
> 
> 赞同：0
> 
> 时间：2013-01-01T23:09:40.013
> 
> 标签：jquery, asp.net-mvc-3

我有一个隐藏的输入字段

```
<input id="mine" name="mine" type="hidden" value="1" /> 
```

出于某种原因，这永远不会在 IE（查看源代码）中呈现，但我可以在 FIrefox 和 Chrome 中看到它。我正在使用 Jquery 来序列化表单，并且隐藏的输入并没有仅在 IE 中传递。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:21:27.907

发现发生了什么，出于某种原因，IE 只是保留了该站点的缓存。我删除了所有内容，现在它可以工作了。

# ruby-on-rails - Rails Nil 不理解错误

> ID：14115103
> 
> 赞同：0
> 
> 时间：2013-01-01T23:09:51.257
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有以下错误

```
undefined method `[]' for nil:NilClass
app/controllers/events_controller.rb:60:in `create' 
```

在这种情况下，我不确定他们所说的 nil 是什么意思。这里我的控制器和第 60 行是箭头所在的位置

```
def create
    @event = current_customer.events.build(params[:event])
    @location = @event.locations.build(params[:location])
    --->@location.longitude = params[:location][:longitude]
    @location.latitude = params[:location][:latitude]
    respond_to do |format|
    if @location.save
        if @event.save
            format.html { redirect_to @event, notice: 'Event was successfully created.' }
            format.json { render json: @event, status: :created, location: @event }
          else
            format.html { render action: "new" }
            format.json { render json: @event.errors, status: :unprocessable_entity }
        end
      end
    end
  end 
```

我有两个模型一个事件和一个位置，我同时创建两个事件并且事件有很多位置。经度是 attr_accesor 经度和纬度。隐藏字段类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:16:11.537

要么`params`是零，要么更可能`params[:location]`是零。

想象：

```
a = [[1,2], [3,4], [5,6], nil, [7,8]]
a[0][0]
=> 1
a[3][0]
undefined method `[]' for nil:NilClass 
```

因为第四个元素是 nil，所以我们不能使用`[]`它上面的方法..

结论是`params[:location]`nil，因此当您尝试访问您认为是数组的元素时，您会收到方法错误，因为`NilClass`没有`[]`方法（而[Array 有](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-5B-5D)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T23:54:52.797

`params[:location]`很有可能`nil`。此外，您应该考虑使用嵌套模型表单来获得更简洁的代码。请参阅嵌套模型表单上的[RailsCast](http://railscasts.com/episodes/196-nested-model-form-part-1)和[.`fields_for`](http://apidock.com/rails/ActionView/Helpers/FormHelper/fields_for)

从理论上讲，您的模型类应该如下所示：

```
class Customer < ActiveRecord::Base
    ...
    has_many :events
    accepts_nested_attributes_for :events
    ...
end

class Event < ActiveRecord::Base
    ...
    has_one :location
    accepts_nested_attributes_for :location
    ...
end

class Location < ActiveRecord::Base
    ...
    belongs_to :event
    ...
end 
```

你的控制器是这样的：

```
class EventsController < ApplicationController
    def new
        current_customer.events.build({}, {}) # instantiate 2 empty events            
    end

    def create
        current_customer.events.build(params[:event])
        if current_customer.save # should save all events and their associated location
            ...
        end
    end
end 
```

你的观点是这样的：

```
<%= form_for @customer do |f| %>
    ...
    <%= f.fields_for :events do |e| %>
        ...
        <%= e.fields_for :location, (e.build_location || e.location) do |l| %>
            <%= l.hidden_field :longitude %>
            <%= l.hidden_field :latitude %>
        <% end %>
        ...
    <% end %>
    ...
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T23:16:58.727

写入您的控制台：

```
logger.debug params[:location].class
logger.debug params[:location].inspect 
```

我怀疑即将到来的数据不是您所期望的（即 [:longitude] 不是散列参数 [:location] 的一部分）。

# c++ - 我想在 Mac 和 Linux 这两个平台上使用 GitHub 和 (a) IDE 编写 C++ 程序

> ID：14115108
> 
> 赞同：0
> 
> 时间：2013-01-01T23:10:39.120
> 
> 标签：c++, github, ide, repository, cross-platform

基本上我想使用 GitHub 作为我的存储库并在 Mac 和 Linux 操作系统上进行开发。这甚至可能吗？例如，我可以在我的 Mac 上使用 Xcode，在我的 Linux 操作系统上使用 Code::Blocks 吗？或者它必须是同一个IDE，如果有的话有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:18:42.230

我建议在每台机器上使用相同的标准 IDE，以防止版本冲突和编译器变异问题。

完全可以使用两个不同的 IDE，但使用一个会更简单，因为您不必担心一个 ide 中的项目特定设置，而不会被另一个 ide 读取。

如果您为每台机器使用“例如”Code::Blocks，您可以将整个项目放到存储库中，然后在另一台机器上 git，然后直接进入并开始使用它。“提供 ide 版本相同”。

为简单起见，我会使用一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T23:19:25.697

是的，这是可能的。注意确保：

*   为一个平台签入的跨平台代码与另一个平台兼容

*   特定于平台的代码不会影响其他平台

*   Xcode 和 Code::Blocks 配置不会不同步

`master`它对在一个分支上工作有极大的帮助，并且只有在你在你希望支持的所有平台上进行了测试后才合并。您可以使用 GitHub 的拉取请求功能来跟踪功能分支。

Xcode 附带的编译器是 Clang；Code::Blocks 默认使用 GCC。一方面，这很好，因为您不断地保持与多个编译器的兼容性。另一方面，它可能会产生意想不到的麻烦，因为它是另一个需要管理的平台差异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T23:29:09.413

作为这些答案的替代方案，您还可以设置和使用诸如[Cmake 之](http://www.cmake.org)类的东西来拥有一个构建系统，然后可以在您支持的每台机器或平台上将其编译为不同的 IDE 项目文件。这样，只有 cmake 文件（不是 Xcode 或 Code::Blocks 项目）存储在存储库中，设置它只需要下载存储库并运行 Cmake 以从中构建 Xcode 或 Code::Blocks 项目。

假设您的代码足够跨平台，这也将使移植到另一个 IDE 或操作系统没有太大困难。

我已经将它用于多个项目，虽然我承认设置东西需要更多时间，但一旦它运行，当指定新文件、程序集和设置时，只需要更新一组文件。

# javascript - 什么时候使用var？

> ID：14115110
> 
> 赞同：2
> 
> 时间：2013-01-01T23:10:40.807
> 
> 标签：javascript, variables, tags, var

> **可能重复：**
> [Javascript：是否使用“var”来声明变量是可选的？](https://stackoverflow.com/questions/2485423/javascript-is-using-var-to-declare-variables-optional)

当我将 var 放在它不起作用的变量之前，如何在下面的代码示例中出现，但是如果我删除 var 它会起作用？我认为在创建新变量时必须使用 var 。

```
function myfunction () {
    if (document.getElementById('ramyes').checked) {
      var itischecked = "yes"
    } else if (document.getElementById('ramno').checked) {
      var itischecked = "no"
    }
}   

function display () {
  myfunction()

  if (itischecked == "yes") {
    alert ("it sure is");
  } else if (itischecked == "no") {
    alert ("it is not");
  }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-01T23:12:25.693

如果使用`var`，则该变量仅在当前函数内可见（它是一个*局部变量*）。`var`如果您在第一次设置变量时不使用，它会创建一个*全局变量*，该变量对所有函数都是可见的。

通过仅设置全局变量来定义全局变量通常不受欢迎，因为大多数时候您需要局部变量（在您的情况下，您应该从函数返回“itischecked”值，而不是将其存储在全局变量中），并设置变量没有`var`看起来像一个错误。这也是严格模式下的错误（每个人都应该始终使用它）。要在（浏览器）JS 中显式定义全局变量，请使用`window.variableName`或`var`在全局范围内（在任何函数之外）。

但在你这样做之前，请仔细考虑这是否是一个好主意。您拥有的全局变量越多，当多个脚本使用相同的变量名称时，发生名称冲突的可能性就越大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T23:25:07.637

您应该`var`在创建变量时使用，但如果您想在两个函数中使用相同的变量，则必须在两个函数之外的范围内创建该变量：

```
var itischecked;

function myfunction () {
  if(document.getElementById('ramyes').checked) {
    itischecked = "yes"
  } else if(document.getElementById('ramno').checked) {
    itischecked = "no"
  }
}   

function display () {
  myfunction();
  if (itischecked == "yes") {
    alert ("it sure is");
  } else if (itischecked == "no") {
    alert ("it is not");
  }
} 
```

如果您在函数内创建变量，则该变量将成为局部变量。它仅在该函数内部可见，并在您从该函数返回时消失。

* * *

在您的情况下，您应该使用函数的返回值而不是将值放入变量中。这样就更容易跟踪数据在程序中的流动方式，并且您不需要创建全局变量：

```
function myfunction () {
  if(document.getElementById('ramyes').checked) {
    return "yes"
  } else if(document.getElementById('ramno').checked) {
    return "no"
  }
}   

function display () {
  var itischecked = myfunction();
  if (itischecked == "yes") {
    alert ("it sure is");
  } else if (itischecked == "no") {
    alert ("it is not");
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T23:23:23.103

只是添加到建议您不应该创建全局变量的先前答案：为避免这样做，您需要以某种方式创建更大的范围，以便可以在两个函数之间共享变量。这就是`var`来的地方。例如：

```
function myProgramme() {
    var itischecked;

    function myfunction() {
        if (document.getElementById('ramyes').checked) {
            itischecked = "yes"
        }
        else if (document.getElementById('ramno').checked) {
            itischecked = "no"
        }
    }

    function display() {
        myfunction()
        if (itischecked == "yes") {
            alert("it sure is");
        }
        else if (itischecked == "no") {
            alert("it is not");
        }
    }
}​ 
```

（尽管在您的具体示例中，您可以更简单地`myfunction`将`itischecked`to`display`作为返回值。）

# git - 从存储库中删除 git 损坏的 blob

> ID：14115116
> 
> 赞同：7
> 
> 时间：2013-01-01T23:11:11.650
> 
> 标签：git, corrupt

我遇到了存储库中对象损坏的情况。

```
$ git push
...
fatal: loose object 95b6a826cadae849f4932a71d6735ab6ceb47cab (stored in .git/objects/95/b6a826cadae849f4932a71d6735ab6ceb47cab) is corrupt
... 
```

而且我知道这个对象是一个由旧提交链接到的 blob：

```
$ git fsck --full
Checking object directories: 100% (256/256), done.
broken link from  tree 27e8e7d5b94c1dad5410a8204089828a167a0eaf
            to    blob 95b6a826cadae849f4932a71d6735ab6ceb47cab 
```

我已经完成了[从常见问题解答中恢复 blob 的经典步骤，](https://git.wiki.kernel.org/index.php/GitFaq#fix-broken-repo)但似乎在任何地方都找不到它的其他副本（我一个人工作，有一段时间没有推送到遥控器，所以它不存在）所以我无法恢复它。

这个 blob 实际上是一个文件的第一个版本，从那时起已经修改了很多。我很好地丢失了有关该文件版本的信息。所以我只想从指向它的提交中删除它。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T04:27:25.843

好的，我最终自己弄清楚了。

简短版本：我修改了指向损坏 blob 的提交以将其从历史记录中删除。

长版：我想既然我知道文件是什么，只是想让它从提交中消失，那么我可以修改旧的提交。我真的没想到它会起作用，但最终它确实起作用了。

我必须指出，我在尝试以前的事情时删除了 .git/objects 中的 blob，这对于它为什么起作用可能很重要。

首先，我必须知道它是什么提交。为此，我使用了命令

```
git log --raw --all --full-history -- subdir/my-file 
```

我发现提交被命名为 966a46....

然后我做了修改它的步骤。由于这是一个旧的提交，我使用

```
git rebase -- interactive 966a46^ 
```

我的编辑器为每个提交输入一行，我在我想要修改的提交前将“pick”更改为“edit”。

该命令`git status`显示我要擦除的文件已被修改：

```
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   subdir/my-file 
```

我想从提交中删除它，所以我做了`rm subdir/my-file`. `git status`然后给我看：

```
#       deleted:    subdir/my-file 
```

这看起来很有希望。所以我只是提交了修改后的提交并继续变基：

```
git commit --all --amend
git rebase --continue 
```

但是在重新提交了一些提交后，它失败了，出现了这个错误：

```
error: could not apply 45c2315... did some fancy things
fatal: unable to read 95b6a826cadae849f4932a71d6735ab6ceb47cab 
```

45c2315 是我的文件在创建后被修改的第一次提交。由于它没有找到该文件的先前版本，因此它失败了。

`git status`除其他外，向我展示了：

```
# Unmerged paths:
#   (use "git reset HEAD <file>..." to unstage)
#   (use "git add/rm <file>..." as appropriate to mark resolution)
#
#       deleted by us:      subdir/my-file 
```

我实际上不确定这意味着什么，但这个提交应该是在修复之后文件将出现的第一个。所以我不希望它被删除，而是相反，添加到提交中！所以我做了

```
git add subdir/my-file 
```

并且肯定`git status`将其显示为“新文件”。

然后我做了`git rebase --continue`，一切都很顺利，rebase 成功了。

`git push`然后顺利进行，而不是因为破碎的斑点而失败。

但是仍然有一个问题，因为`git fsck`仍然失败：

```
$ git fsck --full
Checking object directories: 100% (256/256), done.
broken link from    tree 27e8e7d5b94c1dad5410a8204089828a167a0eaf
              to    blob 95b6a826cadae849f4932a71d6735ab6ceb47cab 
```

`git gc`当我让他修剪所有东西时，也失败了。所以我发现最好的做法是，因为我之前已经成功推送，所以将所有内容克隆回一个新的存储库并从那里开始工作。

# vim - Vim：我的插件和配色方案不起作用？

> ID：14115117
> 
> 赞同：0
> 
> 时间：2013-01-01T23:11:15.673
> 
> 标签：vim, plugins

我试图玩弄我的 vimrc 文件并发现了插件（特别是一个应该允许我滚动浏览配色方案的插件），但是插件似乎不起作用。我的意思是，'ScrollColors.vim' 文件应该创建一个 :SCROLL 命令来滚动浏览颜色方案，但是当我在 vim 中尝试时，它会显示“E492：不是编辑器命令：SCROLL”。另外，我尝试在我的vimrc文件中添加一行“：Colorscheme Mustang”（mustang是colors目录中的一个colorscheme文件）但是当我启动vim时它说“E185：找不到配色方案Mustang”

任何帮助，将不胜感激！

另外，如果这有帮助，这是我的 vim 目录：

```
SDs-macbook:MacVim-ppc-i386-10_5-7_3-53 Simona$ ls
MacVim.app      README.txt      colors  mvim    plugin 
```

还有我的插件目录：

```
SDs-macbook:plugin Simona$ ls
ScrollColors.vim    color_sample_pack.vim   mimicpak.vim 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:30:33.000

Vim 中的命令区分大小写；内置命令如`:colorscheme`小写，插件定义的自定义命令必须以大写字母开头，但很少全大写，因为这很难输入。该命令可能是`:Scroll`相反的。

您可以使用`Tab`来完成命令（例如`:S<Tab>`），并使用`:command`来列出所有已定义的命令。（但阅读插件的帮助通常更容易。）

# objective-c - UILongPressGestureRecognizer 检测手指是否移动了一定的半径

> ID：14115118
> 
> 赞同：0
> 
> 时间：2013-01-01T23:11:23.637
> 
> 标签：objective-c, ios, uigesturerecognizer

我有一个这样的 UILongPressGestureRecognizer 设置：

```
UILongPressGestureRecognizer *longPress = [[UILongPressGestureRecognizer alloc]
                                          初始化目标：自我
                                          动作：@selector(handleLongPress:)];
longPress.numberOfTouchesRequired = 3;
longPress.allowableMovement = 30;
```

在我的 handleLongPress 选择器中，我正在检查 3 个状态，即 UIGestureRecognizerStateBegan、UIGestureRecognizerStateChanged 和 UIGestureRecognizerStateEnded。UIGestureRecognizerStateChanged 是否以任何方式与 allowableMovement 属性相关？我只想在手指移动超过 30 像素时触发该状态，但就像现在一样，它会通过最轻微的移动触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:21:15.267

allowableMovement 是最大移动量，而不是最小移动量。 [苹果文档](http://developer.apple.com/library/ios/documentation/uikit/reference/UILongPressGestureRecognizer_Class/Reference/Reference.html#//apple_ref/occ/instp/UILongPressGestureRecognizer/allowableMovement)

您最好的选择是在检测到任何移动时调用的方法中进行检查，在此检查中，您可以在移动小于一定距离时丢弃任何调用。

UILongPressGestureRecognizer 扩展了 UIGestureRecognizer ，它可以在每次调用处理程序方法时返回触摸的位置，查看[UIGestureRecognizer 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIGestureRecognizer_Class/Reference/Reference.html#//apple_ref/occ/cl/UIGestureRecognizer)

# php - 执行外部文件后如何获取外部变量？

> ID：14115119
> 
> 赞同：1
> 
> 时间：2013-01-01T23:11:23.583
> 
> 标签：php, variables

我正在尝试从外部文件中获取变量，但我需要先执行该文件。我怎样才能做到这一点？

我需要获取变量：`$title`, `$description`, `$link`, `$date`, 和`$author`.

rss.php：

```
$rss2_file = 'http://www.rune-pk.org/forums/external.php?forumids=2&type=rss2';

$is_item = false;
$tag = '';
$title = '';
$description = '';
$link = '';
$date = '';
$author = '';

function character_data($parser, $data) {
    global $is_item, $tag, $title, $description, $link, $date, $author;
    if ($is_item) {
        switch ($tag) {
            case "TITLE":
                $title .= $data;
                break;

            case "DESCRIPTION":
                $description .= $data;
                break;

            case "LINK":
                $link .= $data;
                break;

            case "PUBDATE":
                $date .= $data;
                break;

            case "AUTHOR":
                $author .= $data;
                break;
        }
    }
}

function begin_element($parser, $name) {
    global $is_item, $tag;
    if ($is_item) {
        $tag = $name;
    } else if ($name == "ITEM") {
        $is_item = true;
    }
}

function end_element($parser, $name) {
    global $is_item, $title, $description, $link, $date, $author, $rss2_output;
    if ($name == "ITEM") {
        $rss2_output .= "<dt><strong><a href='" . trim($link) . "'>" . htmlspecialchars(trim($title)) . "</a></strong> - " . htmlspecialchars(trim($date)) . " by <em>" . htmlspecialchars(trim($author)) . "</em></dt><dd>" . htmlspecialchars(trim($description)) . "</dd>";
        $title = "";
        $description = "";
        $link = "";
        $date = "";
        $author = "";
        $is_item = false;
    }
}

$parser = xml_parser_create();

xml_set_element_handler($parser, "begin_element", "end_element");
xml_set_character_data_handler($parser, "character_data");
$fp = fopen($rss2_file, "r");

while ($data = fread($fp, 4096)) {
    xml_parse($parser, $data, feof($fp));
}

fclose($fp);

xml_parser_free($parser);

echo "Latest Announcements:";
echo $rss2_output;
?> 
```

索引.php：

```
include 'rss.php';

echo $rss->title;

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T23:14:46.253

您尝试的是用于访问存储在类中的变量。但这不是这里的情况，所以这样做：

```
<?php
    include 'rss.php';
    echo $title;
?> 
```

# c++ - Cython 扩展类：__dealloc__ 方法之后的“释放对象的校验和不正确”

> ID：14115121
> 
> 赞同：1
> 
> 时间：2013-01-01T23:11:39.213
> 
> 标签：c++, python, cython

好的，我认为[手册建议](http://docs.cython.org/src/userguide/special_methods.html#finalization-method-dealloc)使用 Cython 的 C++ 支持后出现一个奇怪的错误（用于`__cinit__`分配堆 RAM 并`__dealloc__`再次释放它。

我有一个 C++ 类，`calloc`它`malloc`的构造函数中有一些 RAM，`free`而析构函数中有一些 RAM。如有必要，我会发布这个，但错误不是来自 C++ 领域，`new`and`delete`调用工作正常，所以我现在只给你 cython：

```
cdef extern from "../clibs/adjacency.hpp":

  cdef cppclass Adjacency:
    int* _bv
    void** _meta
    unsigned int length
    Adjacency(int graph_order, int meta_on)
    int get(int i, int j)
    void set(int i, int j, int on, void* meta)
    void reset_to_zero()
    void edges_iter(void* global_meta, void (*callback)(void*, int, int, void*))

cdef class Graph:
  cdef Adjacency* adj

  def __init__(self, graph_order):
    print "__init__"

  def __cinit__(self, graph_order, *args, **kwargs):
    print "__cinit__"
    print "allocating, no meta."
    self.adj = new Adjacency(<int>graph_order, 0)

  def __dealloc__(self):
    print "__dealloc__"
    del self.adj 
```

当我对此进行测试时，我得到以下信息：

```
In [1]: import graph

In [2]: g = graph.Graph(302)
__cinit__
allocating, no meta.
__init__

In [3]: ^D
Do you really want to exit ([y]/n)? 
__dealloc__
Python(7389,0x7fff70f9acc0) malloc: *** error for object 0x100defa08: incorrect
checksum for freed object - object was probably modified after being freed.
*** set a breakpoint in malloc_error_break to debug
Abort trap 
```

我有时也会得到段错误而不是不正确的校验和。

我破解了 cython 生成的 C++ 文件，并在`delete`调用周围添加了以下内容：

```
/* "graph.pyx":75
 *   def __dealloc__(self):
 *     print "__dealloc__"
 *     del self.adj             # <<<<<<<<<<<<<<
 * 
 *   def __init__(self, graph_order):
 */
printf("about to delete adj:\n");
delete __pyx_v_self->adj;
printf("just deleted adj!\n"); 
```

我们可以清楚地看到我拨打的电话`delete`运行良好：

```
In [1]: import graph

In [2]: g = graph.Graph(302)
__cinit__
allocating, no meta.
__init__

In [3]: ^D
Do you really want to exit ([y]/n)? 
__dealloc__
about to delete adj:
just deleted adj!
Python(7389,0x7fff70f9acc0) malloc: *** error for object 0x100defa08: incorrect
checksum for freed object - object was probably modified after being freed.
*** set a breakpoint in malloc_error_break to debug
Abort trap 
```

在我按照 Cython 手册中的指示完成整理*后*，Python 会发脾气。

我也只是尝试设置`self.adj = NULL`in `__dealloc__`，以防 Python 试图查看我的对象内部，但这没有帮助。

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T11:36:14.050

我在我的 C++ 代码中犯了一个错误（我没有显示）。

我有一堆这样的功能：

```
if (_meta != NULL) {
  // do stuff with _meta, like loop over the void*s
} 
```

但是在构造函数中，我在设置之前调用了其中一个`_meta = NULL;`......

# facebook - Facebook喜欢生成的按钮说分享而不是

> ID：14115123
> 
> 赞同：0
> 
> 时间：2013-01-01T23:12:09.547
> 
> 标签：facebook, facebook-like

我正在开发一个应用程序，我注意到在 Chrome 上，他们喜欢的按钮代码会生成一个显示共享的按钮。如果我选择其他选项（推荐），它确实会说推荐。奇怪的是，在 Firefox 上它仍然说喜欢和推荐。就个人而言，我希望它说这就是我发帖的原因。是否可能有一个未记录的更改/方法让它像现在这样说。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:22:22.973

你是想让它说“喜欢”而不是“分享”吗？如果是这样，您只需要找到单词“share”并将其替换为“like”即可。

# sql - 如何使用内部连接查询获得不同的最新记录

> ID：14115125
> 
> 赞同：2
> 
> 时间：2013-01-01T23:12:11.630
> 
> 标签：sql, ms-access, inner-join

我有两个表名为：**customers**和**bill**。客户和账单有一对多的关系。Customer 表包含客户 mobileNo、bikeNo 等的记录 Bill 表包含带有 bikeNo（外键）、billdate 等的客户账单记录。我对此进行了查询：

```
SELECT        customer.mobileNo, bill.iDate AS Expr1
FROM            (customer INNER JOIN
                     bill ON customer.bikeNo = bill.bikeNo)
ORDER BY bill.iDate; 
```

现在，我如何通过此查询获得不同且最新的账单日期记录和 mobileNo？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:16:27.857

使用 GROUP BY 和 MAX()：

```
SELECT customer.mobileNo, MAX(bill.iDate) AS iDate
FROM (customer INNER JOIN
                 bill ON customer.bikeNo = bill.bikeNo)
GROUP BY customer.mobileNo
ORDER BY iDate 
```

# php - 在zend项目中用JS改变语言

> ID：14115130
> 
> 赞同：0
> 
> 时间：2013-01-01T23:12:55.323
> 
> 标签：php, javascript, zend-framework, zend-translate

我必须为现有的 Zend 1.12 项目添加语言支持。是否可以使用 html 选择框来更改语言？我知道的唯一方法是使用选择框的“onChange”属性插入可以分析所选选项的特定js函数。

是否可以在 javascript 中启动 zend_translate 语言切换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:23:48.763

您需要在选择更改时重新加载网站，或者进行将加载新 html 的 ajax 调用。

像这样的东西应该适合你（我假设你的路由中有语言代码）：

HTML 代码：

```
<select id="languageSwitch">
    <option value="en">English</option>
    <option value="de">Deutsch</option>
</select> 
```

JS（使用 jQuery）：

```
$('#languageSwitch').change(function() {
    window.location = '/' + $(this).val() + '/';
}); 
```

这将使用附加到域名的 /en/ 或 /de/（基于选择）重新加载您的页面，例如。

[http://www.yourwebsite.com/en/](http://www.yourwebsite.com/en/)

[http://www.yourwebsite.com/de/](http://www.yourwebsite.com/de/)

如果您在设置路由时需要帮助，[此视频](http://www.zendcasts.com/introducing-zend_translate/2009/11/)应该对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T23:33:00.177

这听起来像是您需要在应用程序中使用区域设置切换功能，也许可以查看 Zend 区域设置的手动定义，并将活动区域设置存储在用户会话中：http: [//framework.zend.com/manual/1.12/en/zend。 locale.functions.html](http://framework.zend.com/manual/1.12/en/zend.locale.functions.html)

然后，我将构建一个“Pre-Dispatch 插件”来识别和修改活动会话区域设置，以反映在下拉菜单选择中定义的 GET 参数。有多种方法可以传递语言环境修改参数，您是否使用上述答案中的“路由”方法、带有链接的简单 GET 参数，或者如果您设置为下拉语言环境方法 - 您可以尝试 JQuery，一个例如：http: [//jetlogs.org/2007/09/03/jquery-select-boxes-and-change-events/](http://jetlogs.org/2007/09/03/jquery-select-boxes-and-change-events/)

正如您所说，最简单的是一个 on-change 片段 - 但从标准的角度来看，这很丑陋，因为浏览器期望识别 onchange 属性。

崔是你的。

# jquery - textarea 未填充表格单元格

> ID：14115131
> 
> 赞同：0
> 
> 时间：2013-01-01T23:13:07.780
> 
> 标签：jquery, html, css

我的控件出现问题，导致表格单元格不断增加。

我在这里有一个应用程序：http: [//jsfiddle.net/XM8hG/8/embedded/result/](http://jsfiddle.net/XM8hG/8/embedded/result/)

要查看代码，请访问此链接：http: [//jsfiddle.net/XM8hG/8/](http://jsfiddle.net/XM8hG/8/)

请打开应用程序并按照以下基本步骤操作：

1.  当您打开应用程序时，单击“添加问题”按钮以附加表格行。

2.  在您附加的行中单击“打开网格”并选择按钮“3”，您将看到文本区域上方和下方有一个小间隙，再次打开网格并选择按钮“26”，您将看到上方和下方产生更大的间隙在文本区域下方。

我不希望 textarea 上方或下方有任何间隙，我希望 textarea 填充表格单元格。但是我怎么能这样做，因为我已经将高度设置为 100%。

下面是textarea的css：

```
.textAreaQuestion{
    width:auto;
    resize:none;
    height:100%;
    font-size:100%;
    display: block; 
    overflow:auto;

} 
```

下面是一个 jquery 代码，我试图在其中填充表格单元格，目前它是在单击“添加问题”按钮时完成的。

```
function setWidth() {
    var questionCellWidth = $("#qandatbl_onthefly tbody .question").width();
    var questionCellHeight = $("#qandatbl_onthefly tbody .question").height();
    $(".textAreaQuestion").css({
        "width": (questionCellWidth - 6) + "px",
        "height": (questionCellHeight) + "px"
    });
} 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:23:20.137

我设置了一个[新示例](http://jsfiddle.net/P32hg/7/)，展示了如何设置`textarea`内部几个`div`元素的样式。此示例包含 CSS，它会自动缩放 的宽度/高度`textarea`以匹配右侧的内容。我试图遵循您原始帖子的逻辑和结构，但从头开始使用`div`元素。希望这段代码有用。它旨在允许单独的问题和答案输入，并可以添加新的问题/答案集。

# python - 如何在python中制作翻译动画？

> ID：14115132
> 
> 赞同：0
> 
> 时间：2013-01-01T23:13:30.550
> 
> 标签：python, animation, python-3.x, trigonometry

我正在尝试为屏幕上两点之间的平滑运动设置动画。目前，我正在使用以下 python 生成器函数来确定绘制图像的点：

```
#indexes (just for readability)
X=0
Y=1

def followLine(pointA, pointB, speed):
    x1, y1 = pointA
    x2, y2 = pointB
    movement=[0, 0]
    pos=list(pointA)
    diffY=y2-y1
    diffX=x2-x1
    if abs(diffY) > abs(diffX):
        #Y distance is greater than x distace
        movement[Y]=speed
        numFrames=abs(diffY)//speed
        if numFrames==0:
            movement[X]=0
        else:
            movement[X]=abs(diffX)//numFrames
    elif abs(diffY) < abs(diffX):
        #Y distance is less than x distace
        movement[X]=speed
        numFrames=abs(diffX)//speed
        if numFrames==0:
            movement[Y]=0
        else:
            movement[Y]=abs(diffY)//numFrames
    else: #Equal
        movement=[speed]*2

    if diffY < 0:
        #is negative
        movement[Y] *= -1
    if diffX < 0:
        movement[X] *= -1

    yield pointA
    while (abs(pos[X]-x2) > speed)or(abs(pos[Y]-y2) > speed):
        pos[X] += movement[X]
        pos[Y] += movement[Y]
        yield pos
    yield pointB 
```

但是，这有两个问题：

*   首先，我主要担心的是，如果`pointA`和`pointB`相距很远，或者速度太低，动画会直接通过`pointB`，并且会继续无限远；

*   另一个问题是，在动画结束时，当图像卡入到位时会有一种震动。这种颠簸通常是难以察觉的，但我想尝试使动画更流畅。

我怎样才能做到这一点？我一直在研究三角函数的使用，这似乎很有希望，但我不是一个数学家，所以我很难理解如何使用三角函数来实现它。

此外，我正在使用 Python 3.2 值得。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T23:19:51.607

我认为缺少信息。似乎您需要将`numFrames`arg 替换为`speed`，或者`time`在`speed`. 假设是前者，这个怎么样。请注意，这会生成 numFrames+1 个点，因此 pointA 和 pointB 始终分别是第一个点和最后一个点，但是如果这不是您想要的行为，那么更改是微不足道的：

```
def followLine(pointA, pointB, numFrames):
    x1, y1 = pointA
    x2, y2 = pointB
    diffY = float(y2 - y1) /    numFrames
    diffX = float(x2 - x1) /    numFrames

    yield(pointA)
    for f in range(1,numFrames):
    point = (x1 + f * diffX, y1 + f * diffY)
        yield(point)
    yield(pointB)

points = followLine((0,0), (1,1), 10)

# then iterate over the points and do whatever                                                                                                
for p in points:
    print str(p) 
```

# objective-c - 设置初始文本 Social Frameworks iOS 6

> ID：14115134
> 
> 赞同：0
> 
> 时间：2013-01-01T23:13:49.173
> 
> 标签：objective-c, ios, cocoa-touch, ios6

`setInitialText`除了我的 tweet/fb 作曲家表的字符串之外，我如何添加 UILabel 值。

我尝试`myUILabel.text`以各种方式添加，最终导致崩溃或数据参数到目前为止未使用

```
 mySLComposerSheet = [[SLComposeViewController alloc] init];
   mySLComposerSheet = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook]; ///
   [mySLComposerSheet setInitialText:@"My message"]; ///can I add UI label value here?
   [self presentViewController:mySLComposerSheet animated:YES completion:nil]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:17:57.007

啊，经过多年的修复，需要占位符

```
[mySLComposerSheet setInitialText:[NSString stringWithFormat:@"My message %@",_myUILable.text]]; 
```

# wpf - 将 ListBox 绑定到 ViewModel 的 ObservableCollection

> ID：14115142
> 
> 赞同：1
> 
> 时间：2013-01-01T23:15:54.500
> 
> 标签：wpf, xaml, mvvm, listbox

使用 MVVM 将 ListBox 的项目绑定到 ViewModel 时是否有约定？

在下面的 XAML 中，我正在创建一个按钮列表框。ListBox 绑定到我的 ViewModel 中的一个可观察集合。然后我想将按钮的 Command 属性绑定到 ICommand。问题是当我添加该绑定时，我绑定的是数据对象，而不是 ViewModel。

我只是将 MyListOfDataObjects 属性更改为 ViewModel 列表吗？如果是这样，我在哪里实例化这些新对象？我更喜欢使用依赖注入，因为它们将有几个依赖项。我是否更改 GetData lambda？

一般来说：这里有什么好的做法？我找不到这种情况的任何例子，尽管我认为它很常见。

我正在使用 MVVMLight 框架，但我愿意查看任何其他框架。

```
<Window x:Class="KeyMaster.MainWindow"
        DataContext="{Binding Main, Source={StaticResource Locator}}">

    <Window.Resources>
        <ResourceDictionary>
            <DataTemplate x:Key="MyDataTemplate">
                <Button Command="{Binding ButtonPressedCommand}"
                        CommandParameter="{Binding .}"
                        Content="{Binding Name}" />
            </DataTemplate>
        </ResourceDictionary>
    </Window.Resources>

    <Grid x:Name="LayoutRoot">
        <ListBox ItemsSource="{Binding MyListOfDataObjects}"
                 ItemTemplate="{StaticResource MyDataTemplate}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal"
                                IsItemsHost="True" />
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
        </ListBox>
    </Grid>
</Window> 
```

我正在使用标准的 MVVMLight ViewModel：

```
using GalaSoft.MvvmLight;
using KeyMaster.Model;
using System.Collections.ObjectModel;

namespace KeyMaster.ViewModel
{
    public class MainViewModel : ViewModelBase
    {
        private readonly IDataService _dataService;
        private ObservableCollection<MyData> _myListOfDataObjects;

        public MainViewModel(IDataService dataService)
        {
            _dataService = dataService;
            _dataService.GetData(
                (item, error) =>
                {
                    if (error != null)
                    {
                        return;
                    }

                    MyListOfDataObjects = new ObservableCollection<MyData>(item);
                });
        }

        public ObservableCollection<MyData> MyListOfDataObjects
        {
            get { return _myListOfDataObjects; }
            set
            {
                if (_myListOfDataObjects == value) return;

                _myListOfDataObjects = value;
                RaisePropertyChanged(() => MyListOfDataObjects);
            }
        }
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T00:13:12.913

我会说这取决于您想要按键功能的位置。如果它总是与 MyData 对象相关，那么（如果可能的话）将 Command 放在 MyData 对象中是否不合适？（ps。我不会仅仅因为您向它们添加命令属性而调用您的 MyData 对象 ViewModels，因为它们与视图无关）

或者，如果您想要 VM 中的命令，那么您可以尝试使用窗口的数据上下文绑定命令。即类似的东西；

```
<Button Command="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}, Path=DataContext.ButtonPressedCommand}"
                    CommandParameter="{Binding .}"
                    Content="{Binding Name}" /> 
```

尽管我过去曾遇到过麻烦，但我将命令添加到单个对象中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T08:46:29.550

在 MVVM 中，原始数据（也称为 Model）和 ViewModel 之间有明显的分离。ViewModel 负责解析数据，甚至在将数据传递给 View 之前将其修改为所需的任何形式。

一个简单的例子是将模型作为 XML 并让 ViewModel 解析它，只从每个元素中获取特定属性（例如“ `Name`”）并将它们添加到列表中。只有这个列表会显示在视图中。

也就是说，我想你可以看到我要去哪里 - 命令应该在 ViewModel中***而不是***在 Model 中。正如您自己所说，您应该将尽可能多的 UI 逻辑排除在 VM 和模型之外。

如果您有一个特定命令对某种类型的数据执行特定操作，您可以希望它在更“通用”类型的 ViewModel 中，您可以使用`CanExectue`仅在特定情况下允许此命令。但是，该命令仍应位于 ViewModel 中。

在您的特定情况下，我认为 ViewModel 中的命令没有问题，并且当它被提出时，它将对您的数据执行任何您需要的操作。您不需要 ViewModel 列表，您只需要一个。

# symfony - Symfony2s 学说：生成：实体不生成 repo 类

> ID：14115143
> 
> 赞同：18
> 
> 时间：2013-01-01T23:16:07.433
> 
> 标签：symfony, doctrine

我选择[Symfony2 docs](http://symfony.com/doc/2.0/book/doctrine.html)。据说加

```
/**
 * @ORM\Entity(repositoryClass="Acme\StoreBundle\Entity\ProductRepository")
 */ 
```

在我的实体文件中运行`php app/console doctrine:generate:entities Acme`应该创建`ProductRepository`文件。它没有。我不能再澄清了，它只是不创建该文件，只是重新创建以前存在的那些实体文件。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-21T17:59:58.347

I am having the same issue

But I've found the answer here: [http://brentertainment.com/other/docs/book/doctrine/orm.html](http://brentertainment.com/other/docs/book/doctrine/orm.html)

> If you have already generated your entity class before adding the repositoryClass mapping, you have to create the class on your own. Fortunately, it’s pretty easy. Simply create the class in the Repository directory of your bundle and be sure it extends Doctrine\ORM\EntityRepository. Once you’ve created the class, you can add any method to query your entities.

Simple, we have to do it by hand because we have already run this once

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-12T07:14:12.317

您可以尝试指定特定的捆绑包：

`php app/console doctrine:generate:entities AcmeStoreBundle`

请注意，我有完整的捆绑包名称。

即使您`doctrine:generate:entities`之前跑步，这也会有所帮助。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-02-02T03:28:49.207

如果您使用 orm.yml 文件生成实体，则可以定义 repositoryClass，然后再次生成实体：

```
Acme\StoreBundle\Entity\Product:
type: entity
table: product
...
repositoryClass: Acme\StoreBundle\Entity\ProductRepository
... 
```

然后运行：

```
php app/console doctrine:generate:entities AcmeStoreBundle 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-24T15:39:20.387

超级简单的解决方案：

如果您还没有生成实体：

```
php app/console doctrine:generate:entity --entity="AppBundle:EntityName" --fields="id:string(255) content:text(100)" 
```

现在将这些注释行修改为您之前生成的实体：

```
* @ORM\Table(name="TABLENAME")
* @ORM\Entity(repositoryClass="AppBundle\Entity\EntityNameRepository") 
```

现在，只需运行：

```
php app/console doctrine:generate:entities AppBundle:EntityNameRepository 
```

现在您有了一个实体和存储库。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-09T00:33:14.610

要摆脱这个问题并生成 repo 类，您可以**临时修改以下文件的末尾**： *symfony\vendor\doctrine\doctrine-bundle\Doctrine\Bundle\DoctrineBundle\Command\generateEntitiesDoctrineCommand.php*

```
if ($m->customRepositoryClassName 
   && false !== strpos($m->customRepositoryClassName, $metadata->getNamespace())) {
     $repoGenerator->writeEntityRepositoryClass(
        $m->customRepositoryClassName, $metadata->getPath());
} 
```

使用以下代码：

```
if (true) { 
   $output->writeln(
     sprintf('  > AND Repository <comment>%s</comment>', $m->name . "Repository")
   );           
   $repoGenerator->writeEntityRepositoryClass(
     $m->name . "Repository", $metadata->getPath());
} 
```

一些解释：在这段代码中，

*   **if 条件用 'if (true)' 简化**（如果*你*愿意，最后可以完全抑制）
*   *$m->customRepositoryClassName* **被替换为** *$m->name."Repository"*
*   当生成 repo 文件时，我添加了一些输出以便（在终端窗口中）得到很好的通知。

如果您不使用 ' *if(true)* ' 条件，并且想自己检查一下，您还可以添加一个带有输出的兼性 else 案例，以便在将来更好地了解情况：

```
 else {
       $output->writeln(sprintf('  > NO repository generated for this class'));
    } 
```

修改后，您可以像往常一样重新运行命令：

```
php app/console doctrine:generate:entities AcmeStoreBundle 
```

这是一个临时代码，因为到目前为止问题对我来说还不是很清楚，我唯一看到的是**它似乎来自 $m->customRepositoryClassName**，它返回一个空字符串。因此，要找到另一个明确的解决方案，一种方法可能是检查元数据对象的方法 customRepositoryClassName ...

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2015-01-12T16:49:10.400

基于 Astucieux 的回答：

```
if (true) { 
    $fullRepositoryClassName = $name . "\\Repository\\" . $basename . "Repository";
    $output->writeln(
        sprintf('  > AND Repository <comment>%s</comment>', $fullRepositoryClassName)
    );           
    $repoGenerator->writeEntityRepositoryClass(
        $fullRepositoryClassName, $metadata->getPath());
} 
```

# asp.net - 更新时数组不保存值

> ID：14115156
> 
> 赞同：0
> 
> 时间：2013-01-01T23:17:10.190
> 
> 标签：asp.net, arrays, vb.net, visual-studio-2010

我可以向 中添加一个值`array(0)`，但是当我向其中添加一个值时，`array(1)`它会清除`array(0)`. 我已经尝试了所有我能想到的方法来声明和创建数组。我的代码如下所示：

```
Dim aryEstimateInfo() As String = New String(7) {}

Private Sub wzrdEstimateWizard_NextButtonClick(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.WizardNavigationEventArgs) Handles wzrdEstimateWizard.NextButtonClick

    Select Case wzrdEstimateWizard.ActiveStepIndex
        Case 0 'first estimate wizard step
            aryEstimateInfo(0) = rad_lstVehicleType.SelectedItem.ToString

        Case 1 'second estimate wizard step
            Dim DamageZoneSelected As Boolean = False
            For Each cntrl As Control In pnlDamageZone.Controls
                If TypeOf cntrl Is RadioButton Then
                    Dim RadButton As RadioButton = cntrl
                    If RadButton.Checked Then
                        DamageZoneSelected = True
                        DamageZone = RadButton.Text.ToString
                        Exit For
                    Else
                        DamageZoneSelected = False
                    End If
                End If
            Next
            If DamageZoneSelected = True Then
                lblDamageZoneError.Visible = False
                aryEstimateInfo(1) = DamageZone
            Else
                'if no damage zone is selected a message is displayed
                wzrdEstimateWizard.ActiveStepIndex = 2
                wzrdEstimateWizard.ActiveStepIndex = 1
                lblDamageZoneError.Visible = True
            End If

        Case 2 'third estimate wizard step
            'assigns the number of dents to the estimate array
            aryEstimateInfo(2) = ddlNumberOfDents.SelectedValue.ToString
            'sets the average dent size  in the estimate arrau
            aryEstimateInfo(3) = ddlDentSize.SelectedValue.ToString
            'sets the add-on code and number of oversized dents
            If ddlOverSized.Enabled = True Then
                'aryEstimateInfo.SetValue("3", 4)
                aryEstimateInfo(4) = "3"
                aryEstimateInfo(7) = ddlOverSized.SelectedValue.ToString
            Else
            End If
        Case 3 'fourth estimate wizard step
        Case Else
    End Select

End Sub 
```

我在 ASP.Net 向导控件和基本的 Visual Studio 2010 中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:42:01.763

当您在代码中的某处声明新数组时，您无法在回发后再次使用它。

我建议在完成向导事件上构建阵列，您可以在任何时候介入的整个步骤中使用控件

我想会好的

否则你需要在会​​话或视图状态的每次更新后存储数组，但我不喜欢两者

抱歉，我无法查看示例，因为我使用的是手机

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:20:13.803

问题是每次单击按钮都会回发页面，这会导致您的 aryEstimateInfo 在每次回发时重新创建。

为了优雅地处理这种情况，改进页面的维护，让以后更容易调试这种情况，我建议进行以下更改：

1）将数组更改为具有属性的类：

```
Public Class EstimateInfo
  Public VehicleType As String = ""
  Public DamageZone As String = ""
  Public NumberOfDents As String = ""
  Public DentSize As String = ""
  Public AddOnCode As String = ""
  Public Oversized As String = ""
End Class 
```

请注意，所有属性都声明为字符串，但可能应该更改数据类型以更准确地反映基础内容。

这种方法将有助于调试，因为您可以将自动实现的属性更改为 getter/setter，以便您可以放置​​断点以查看值被清除的位置：

```
Private m_sVehicleType As String = ""
Public Property VehicleType As String
   Get
       Return m_sVehicleType
   End Get
   Set (Value As String
        ' You could set a breakpoint here to discover where the value is getting cleared.
       m_sVehicleType = Value
   End Set
End Property 
```

例如，如果您需要将字符串数组中的值导出到不同的应用程序或数据库，您可以向类添加一个方法来生成适当的字符串数组。

2) 向页面添加一个属性以将当前答案类存储在页面的 ViewState 中，这样您就不必不断地重新填充数组。例如：

```
Private Property EstimateInfo As EstimateInfo
    Get
       ' Add a new record to the viewstate if it doesn't already exist
       If ViewState("EstimateInfo") Is Nothing Then
          Me.EstimateInfo = New EstimateInfo
       End If
       Return ViewState("EstimateInfo")
    End Get
    Set (value As EstimateInfo)
        ViewState("EstimateInfo") = value
    End Set
End Property 
```

完成此操作后，您的向导代码将变得更易于理解和维护：

```
Select Case wzrdEstimateWizard.ActiveStepIndex
    Case 0 'first estimate wizard step
        Me.EstimateInfo.VehicleType = rad_lstVehicleType.SelectedItem.ToString 
```

# c++ - What's the proper the structure for storing a big array which will be frequently updated

> ID：14115157
> 
> 赞同：1
> 
> 时间：2013-01-01T23:17:19.737
> 
> 标签：c++, objective-c, data-structures

I'm seeking for a proper structure for a big array which will be frequently updated. Thanks for your help! Here's the background: I want to draw a continuous curve to represent a sound wave in a certain time period. For the accuracy, the array length will be nearly 44100(the CD format)．And I just want to represent the last second wave, so the array will be updated very frequently - for every 1/44100 sec, the first element will be eliminated and a new last element will be inserted to the array.

For avoiding the frequent "malloc/realloc/new", what my current solution is using an Circular Queue which has a fixed size as 44100, but somehow I don't feel this is most proper solution, if I want to dynamically resize the queue, it will be a heavy cost. This kind of situation should be quite often, I think there maybe some good patent for this issue. Thanks guys!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:39:46.513

I assume you're always having a fixed number of items in the array. As such I'd just use a ring buffer in any case (not sure whether that's what you refer to as a "Circular Queue", but I assume you'd use a dynamic length? If so, why? Is there no specific absolute (and practical) maximum?), i.e. a static array with a variable entry point as its start:

```
const unsigned int buffer_length = 500000;
float *buffer = new float[buffer_length];

unsigned int buffer_write = 0;

// append a value...
buffer[buffer_write] = my_value;
// ...and move the write/end position:
buffer_write = (buffer_write + 1) % buffer_length; 
```

To output/use the values, you can use the following formula for index of the first entry to read:

```
unsigned int start_position = (buffer_length + buffer_write - length_to_read) % buffer_length; 
```

To iterate, you just add position after position, again using modulo to jump back to the beginning of the array.

# php - 为了在 wordpress 页面/帖子上有允许将其添加到一个用户配置文件的按钮，您将如何做

> ID：14115159
> 
> 赞同：-4
> 
> 时间：2013-01-01T23:17:25.647
> 
> 标签：php, wordpress

我正在为一个项目建立一个网站，我想实现一个功能，但我似乎找不到办法。原则是在每个页面上都有一个按钮，当一个特定的用户单击它时，它会将其添加到他的个人资料页面（我将建立）中，并带有该页面的标题和指向它的超链接。这里的目标是进行某种活动，用户单击他想做的活动，然后在其个人资料页面上显示“待办事项”列表。如果您有任何线索，通过插件或编码从哪里开始，我将非常感激。

度过一个美好的夜晚，并提前感谢您的帮助

编辑：大家好，我真的很感谢您的回答，我只想添加一些细节，因为我的描述中确实没有那么明确（英语不是我的语言这一事实​​也起到了作用，对此感到抱歉）我已经在互联网上查找了几个小时，没有找到任何东西。就像弗格斯说的那样，我对 wordpress 开发并不熟悉。我基本上知道如何添加插件，编辑一些简单的 php 以使它们在需要时与我的网站一起使用。我更注重业务，但我在 php、jquery/js 和 ajax 中都有开发基础。我在这里的目标更多是构建一个最小可行产品，以便制作一个“示例”，以便在未来寻找技术联合资助者，所以我真的不介意这不是很干净的代码。我开始阅读 wordpress 文档，关于循环、钩子、php 文件，模板等...所以这是我的技术水平；）我非常感谢您的回答，并将尝试使用您所写的弗格斯。这是一个好的开始，我实际上有一个地方可以开始学习知道。多谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:09:46.427

*全面披露：我一般不会回答这类问题，因为它非常广泛，而且信息似乎很少；需要更多才能真正回答它。然而，它让我思考了一些我一直想知道的事情，无论如何我已经回答了。*

***将来尝试在您的问题中添加更多信息，告诉我们您研究了什么以及您尝试了什么等等。没有人愿意花时间为甚至不会自己快速进行谷歌搜索的人写答案！***

## 打破它

你需要提供一些明确的要求——如果你有的话。如果你没有，那么你需要考虑一些。例如，从分解您的帖子来看，明显的要求是：

1.  *您需要...*在每个页面上显示一个按钮
2.  *您需要...*存储有关用户所选页面的数据
3.  *您需要...*检索与特定用户关联的页面
4.  *您需要...*在用户个人资料中显示这些页面

### 显示一个按钮

在模板中有一个按钮；有一个关联的 jQuery 事件处理程序吗？这不是一个优雅的解决方案，因为它将逻辑与视图混合在一起 - 使未来的可维护性和设计更改成为一种痛苦。

在这种情况下，我将开始研究**Wordpress 插件开发**——插件的第一个要求是简单地显示一个按钮——以及输出所需的 jQuery 事件处理程序。

*为了实现这一点，您可以查看现有插件；源代码查看器等简单的东西会向您展示如何将脚本和标记注入页面。地狱，任何插件都应该能够向您展示如何做到这一点！*

### 存储用户数据

这必须在 wordpress 数据库中完成。因此，您可以再次查看其他执行数据库操作的插件并从那里构建解决方案；或者您可以查看[wordpress 插件“功能参考”](http://codex.wordpress.org/Function_Reference)并着手“一起破解某些东西”；不过，最好先看看其他人是如何实现的。

这部分插件实际上只需要获取页面和用户，这就是真正需要做的一切。

### 检索与用户关联的页面

同上。您需要能够获取用户名或用户 ID 并返回该用户单击的特定页面。这几乎可以反过来描述为上面的内容。同样 - 在实施时请记住这一点！

### 向用户显示数据

回想第一个要求：*显示一个按钮*。您需要能够将特定数据输出到屏幕。从这里学到的教训将再次非常有用。

## 所以...考虑到这一点

您现在必须考虑您正在使用哪些工具以及您的真正自信程度。我的印象是你以前没有在*这个*级别上使用过 Wordpress——但是你使用过 PHP 吗？jQuery/Javascript？您了解 MySQL 以及 Wordpress 在数据库中存储数据的方式吗？

然后浓缩我上面所说的并找出：

1.  插件如何在 Wordpress 页面中显示数据。
2.  插件如何与数据库交互。

在插件 API 中，您可能需要检查[操作](http://codex.wordpress.org/Plugin_API#Actions)，因为它们似乎为您的插件的核心功能提供了一个包装器。同样，检查可用的[Hooks](http://adambrown.info/p/wp_hooks)并确定何时需要运行插件的哪个部分。

至于数据库交互？[Wordpress 文档](http://codex.wordpress.org/Creating_Tables_with_Plugins)也有关于这方面的大量信息。

网上有很多关于插件开发的文档；[这一篇](http://pippinsplugins.com/using-filters-to-alter-html-output/)详细介绍了如何使用过滤器修改 HTML 输出。一个快速的谷歌可能会为您提供您需要知道的 95% 的内容，另外 5% 可能通过钢笔和铅笔以及 10 分钟的头脑风暴获得。

综上所述; 将您的要求分解成更容易的部分，并进行一些研究以了解如何实现这些位。然后计划如何将它们作为一个包集成在一起。这个问题太大了，无法提供完整的答案。

我承认自己从未开发过插件，但我会将您链接到[看似出色的文档](http://codex.wordpress.org/Writing_a_Plugin)。同样，如果您以前没有使用过 jQuery - 这里是[$.ajax() 方法文档](http://api.jquery.com/jQuery.ajax/)。

# javascript - JQuery .show() 不适用于已引用的 div 中的 div

> ID：14115162
> 
> 赞同：0
> 
> 时间：2013-01-01T23:18:28.380
> 
> 标签：javascript, jquery

显示（）不起作用

[http://jsfiddle.net/Pppy6/5/](http://jsfiddle.net/Pppy6/5/)

```
<div class="hello" id="hello">2<div class="ola" id="ola">showMe!</div></div>

.ola {
    display:none
}​

$('#hello').text(parseInt($('#hello').text()) + 1);
$('#ola').show(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-01T23:20:13.160

当您调用`.text()`设置内容时，您会删除其他元素。换句话说，调用`.show()`不起作用，因为元素消失了。

您可以将文本放在`<span>`元素或其他内容中，然后替换其文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T23:27:23.017

那这个呢 ？

```
<div class="hello" id="hello"><span>2</span><div class="ola" id="ola">showMe!</div></div>

.ola {
    display:none
}​

$('#hello').children('span').text(parseInt($('#hello').children('span').text()) + 1);
$('#ola').show(); 
```

如果你想`sum 1 to 2`在你的`hello div`

# sql - UTF-8 CSV 文件的 SQL Server 批量插入无法正常工作

> ID：14115165
> 
> 赞同：2
> 
> 时间：2013-01-01T23:18:50.850
> 
> 标签：sql, csv, utf-8, bulkinsert, google-drive-api

我正在尝试批量插入我从 Google Drive 下载为该类型的 UTF-8 CSV 文件，因为 Excel 没有正确保存我的 CSV。

我在 notepad++ 中打开了 Google Drive 生成​​的 CSV 文件，`View > Show Symbol > Show All Characters`然后我可以看到它包含`LF`行终止符的换行符（如果我在这里错了，请纠正我）

所以我尝试了以下方法，但在临时表中没有任何记录。当我使用默认行终止符时，这适用于其他不是 UTF-8 的 CSV 文件（即，当您未指定行终止符时为 '\r\n'）。

我还尝试了 '\t', '\r\n', '\r' & '\0' 作为行终止符以及有和没有数据文件类型.. 似乎没有任何工作？这与我在临时表中的字段类型有关吗？或者是其他东西？

```
CREATE TABLE #TEMPResourceContents (
    [ResourceName] [nvarchar](250) NOT NULL,
    [Language] [nvarchar](250) NOT NULL,
    [Content] [nvarchar](max) NOT NULL
)
GO

BULK INSERT #TEMPResourceContents 
FROM 'C:\import-resources.csv'
WITH
(FIRSTROW = 2, DATAFILETYPE = 'widechar', FIELDTERMINATOR = ',', ROWTERMINATOR = '\n')
GO

SELECT * FROM #TEMPResourceContents 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:47:32.600

顺便说一句，BULK INSERT 不支持 UTF-8。

[请参阅参考链接 MSDN](http://msdn.microsoft.com/en-us/library/ms188365.aspx)

[请参阅参考链接](https://stackoverflow.com/questions/5498033/how-to-write-utf-8-characters-using-bulk-insert-in-sql-server)

# jsf - 如何在切换选项卡时显示“正在加载..”

> ID：14115169
> 
> 赞同：0
> 
> 时间：2013-01-01T23:19:49.930
> 
> 标签：jsf, jsf-2, primefaces

我很感兴趣是否可以使用此[示例](http://www.primefaces.org/showcase-labs/ui/tabviewDynamic.jsf)创建带有 Primefaces 的选项卡？这个想法是创建动态加载的选项卡，当我在页面之间切换以在页面的右上角显示“正在加载”。这种情况的通常方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:31:53.323

您在问题中引用的示例包含问题的答案。通常，您有两种选择

1.  Primefaces[`ajaxStatus`](http://www.primefaces.org/showcase-labs/ui/ajaxStatus.jsf)组件专为您的用例而设计，并且与您链接的动态选项卡示例中使用的组件相同（尽管 PF 团队忽略了在该示例的示例标记中引用/声明它）。它与您在该示例中看到的用于生成“加载”风车的组件相同

2.  一个更强大/更奇特的选项是[`blockUi`](http://www.primefaces.org/showcase-labs/ui/blockUI.jsf)可以达到相同效果的组件，尽管在选项和视觉效果方面要多一些。

# javascript - 如何在 html5 画布上绘制带有渐变的曲线路径？

> ID：14115170
> 
> 赞同：0
> 
> 时间：2013-01-01T23:19:50.330
> 
> 标签：javascript, canvas, gradient

使用 javascript，我在 canvas 元素上绘制了一条“弯曲”路径，该路径由许多小的直线段组成：[Harmonograph](http://www.ashware.nl/harmonograph)。

现在我希望每个部分都有不同的颜色，沿着路径应用彩虹色。所以路径从红色开始，然后逐渐变为黄色，然后变为绿色，等等。

我想使用`beginPath()`and `closePath()`only 一次来加快速度。这是否可以使用类似功能`createLinearGradient();`或任何其他标准功能，只要它很快，因为整个路径需要每秒重绘多次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T02:07:26.027

除了分隔路径之外，没有其他方法可以做到这一点。这是我为您的 lissajous 人物实现的彩虹渐变。[你可以在这里](http://jsfiddle.net/GRMGy/show/)看到一个演示：

```
drawLissajous: function(points) {
    if (points.length > 2) {
        var x, y, x = points[1][0] + this.centerX;
        y = points[1][1] + this.centerY;
        ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.moveTo(x, y);
        for (var count = 2; count < points.length; count++) {
            ctx.beginPath();
            ctx.moveTo(x, y);
            var newX = points[count][0] + this.centerX,
                newY = points[count][1] + this.centerY,
                f = 0.005,
                blue = Math.sin(f * count + 0) * 127 + 128,
                red = Math.sin(f * count + 2) * 127 + 128,
                green = Math.sin(f * count + 4) * 127 + 128;
            ctx.strokeStyle = 'rgb(' + Math.round(red) + ', ' + Math.round(green) + ', ' + Math.round(blue) + ')';
            x = newX;
            y = newY;
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.closePath();
        }
        ctx.stroke();
        ctx.closePath();
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-11-16T14:24:03.320

我有同样的问题，我做了一个简单的测试，它只是使用正常的渐变，希望它有用

```
 var canvas = document.getElementById('myCanvas');
    var context = canvas.getContext('2d');

    context.beginPath();
    context.moveTo(100, 20);

    // line 1
    context.lineTo(200, 160);

    // quadratic curve
    context.quadraticCurveTo(230, 200, 250, 120);

    // bezier curve
    context.bezierCurveTo(290, -40, 300, 200, 400, 150);

    // line 2
    context.lineTo(500, 90);

    // create radial gradient
    var grd = context.createRadialGradient(238, 50, 10, 238, 50, 300);
    // light blue
    grd.addColorStop(0, '#8ED6FF');
    // dark blue
    grd.addColorStop(1, '#004CB3');

    context.lineWidth = 5;
    context.strokeStyle = grd;
    context.stroke(); 
```

[这里测试](http://jsfiddle.net/pnsadeghy/LH9Zc/)

# python - TIDESDK Python 模块导入

> ID：14115173
> 
> 赞同：0
> 
> 时间：2013-01-01T23:20:32.723
> 
> 标签：python, tidesdk

伙计们... TideSDK 的新手。想用该工具开发跨平台的科学应用。我需要导入外部模块并将它们打包到应用程序中。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T04:26:37.163

是的，我已经多次这样做了。对我有用的是将带有模块的文件夹放入 TideSDK 项目的“资源”目录中，并使用通常的“导入”来加载模块。

# asp.net-mvc-3 - Griffin.MvcContrib 本地化与 FluentValidation

> ID：14115177
> 
> 赞同：0
> 
> 时间：2013-01-01T23:21:15.573
> 
> 标签：asp.net-mvc-3, fluentvalidation, griffin.mvccontrib

我一直在从事我的第一个 mvc 本地化项目，并且一直在使用出色的 Griffin.MvcContrib 来帮助我开始。

我使用 Griffin 来处理语言更改和页面视图，并使用自定义提供程序设置来处理模型和通过数据库资源进行验证。

验证通过 FluentValidation 完成，如下所示：

```
RuleFor(x => x.Bin)
    .Length(0, 50)
    .WithMessage(localizationService.GetResource("Inspection.Bin.Length")); 
```

一切似乎都很好，直到我意识到服务器端错误没有被翻译，只有客户端错误。经过长时间的调查，在我看来，问题是在服务器端验证完成后正在设置线程文化 - 我相信在另一篇文章中发生的事情是一样的：

[未为 ModelState.Value.Culture 设置 MVC3 全球化](https://stackoverflow.com/questions/6629406/mvc3-globalization-not-set-for-modelstate-value-culture)

到目前为止，我所做的只是将以下内容放在 Global.asax 文件中。

```
protected void Application_BeginRequest(object sender, EventArgs e)
        {
            string CookieName = "GriffinLanguageSwitcher";

            HttpContextBase currentContext = new HttpContextWrapper(HttpContext.Current);

            if (currentContext.Request.Cookies[CookieName] != null)
            {
                Thread.CurrentThread.CurrentCulture =
                    Thread.CurrentThread.CurrentUICulture =
                        new CultureInfo(currentContext.Request.Cookies[CookieName].Value);
            }
        } 
```

它似乎工作。当用户切换他们的语言时，我不担心验证，现在它似乎拾取当前语言并翻译服务器端错误。

但这是解决此问题的可接受方式，还是我应该做其他事情。谢谢。

# c# - DataGridView 单元格滚动出视图时的事件

> ID：14115181
> 
> 赞同：0
> 
> 时间：2013-01-01T23:21:55.453
> 
> 标签：c#, winforms, datagridview

我有一个 DataGridViewCell 和 Column 的子类`DataGridViewLabelCell`，`DataGridViewLabelColumn`它允许我添加要在单元格中显示的标签。这个想法是我可以将标签堆叠在一起，使用不同的颜色，还可以处理单个标签上的点击事件。具有以下`DataGridViewLabelCell`代码来添加标签：

```
public void AddLabel(string LabelText, Color BackColor, int Opacity, float ScalePosition, object Tag)
{
    Label label = new Label();
    label.Visible = false;
    label.Text = LabelText;
    label.AutoSize = true;
    label.BorderStyle = BorderStyle.Fixed3D;
    label.BackColor = Color.FromArgb(Opacity, BackColor);
    this.DataGridView.Controls.Add(label);

    LabelScalePostion labelScale = new LabelScalePostion();
    labelScale.Label = label;
    labelScale.ScalePosition = ScalePosition;

    label.DoubleClick += new EventHandler(DataGridViewCellLabel_DoubleClick);

    _labels.Add(labelScale);            
}

private void DataGridViewCellLabel_DoubleClick(object sender, EventArgs e)
{
    Label label = (Label)sender;

    MessageBox.Show("ID = " + label.Tag.ToString());
} 
```

而且我还覆盖了`DataGridViewLabelCell`'`Paint`事件来定位标签：

```
protected override void Paint(Graphics graphics, Rectangle clipBounds, Rectangle cellBounds, int rowIndex, DataGridViewElementStates cellState, object value, object formattedValue, string errorText, DataGridViewCellStyle cellStyle, DataGridViewAdvancedBorderStyle advancedBorderStyle, DataGridViewPaintParts paintParts)
{
    // Call the base class method to paint the default cell appearance.
    base.Paint(graphics, clipBounds, cellBounds, rowIndex, cellState,
        value, formattedValue, errorText, cellStyle,
        advancedBorderStyle, paintParts);

    foreach (LabelScalePostion labelScale in _labels)
    {
        Label label = labelScale.Label;
        label.Visible = true;
        Point location = cellBounds.Location;
        location.Offset(40, (int)(cellBounds.Height * labelScale.ScalePosition));
        label.Location = location;
    }
} 
```

这在某种意义上是有效的，直到包含它的单元格滚动到视图中，标签才会显示，但是当它滚动回视图之外时，标签会停留在 DGV 的顶部。因此，当单元格停止显示时，我需要某种方式来触发事件，但是我找不到任何此类事件。

我目前正在使用拥有 DataGridView 的`Scroll`事件处理此问题，如下所示：

```
private void dgvItemView_Scroll(object sender, ScrollEventArgs e)
{
    switch (_formType)
    {
        case FormType.DayView:
            foreach (DataGridViewRow row in this.dgvItemView.Rows)
            {
                DataGridViewLabelCell cell = (DataGridViewLabelCell)row.Cells[0];

                foreach (DataGridViewLabelCell.LabelScalePostion labelScale in cell.Labels)
                    labelScale.Label.Visible = false;
            }
            break;
    }
} 
```

但是，这感觉不对，并且为了证明这一点，当我滚动时会出现难看的闪烁。其他一切都很好（外观，事件等），我可以忍受闪烁，但是我确信必须有更好的方法来实现这一点。

# opengl - 访问和移动模型视图 OpenGL 3.2

> ID：14115184
> 
> 赞同：0
> 
> 时间：2013-01-01T23:22:54.430
> 
> 标签：opengl

我正在尝试创建一个蛇游戏。我设法用正方形创建了我的领域，并用这个把我的红蛇画成了一个正方形：

```
void drawSnake()
{
    mat4 modelView;

    modelView = Translate(0,0,0);
    glUniformMatrix4fv(modelViewUniform, 1, GL_TRUE, modelView);
    glDrawArrays(GL_TRIANGLES, 0, 6);
} 
```

现在我画蛇的时候不会把它放在任何地方。我在想也许我可以将模型视图存储为一个对象，然后平移该对象，这将是一条四处移动的蛇。但也许这是一种愚蠢的方法，所以我想我会要求一些更好的方法。

```
Vertex rectangleData1[rectangleSize] = {
        { vec2( -1.0, -1.0 ), color1 },
        { vec2( 1.0, -1.0 ), color1 },
        { vec2( 1.0,  1.0 ), color1 },
        { vec2( -1.0, -1.0 ), color1 },
        { vec2( 1.0,  1.0 ), color1 },
        { vec2(-1.0, 1.0 ), color1 }
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:06:25.583

您认为使用和修改每个游戏对象的矩阵是转换所述游戏对象的正确技术是正确的。在图形中，这些矩阵通常被称为“模型”或“世界”矩阵。在将 OpenGL 用于 3D 应用程序时，您可以另外为着色器程序提供视图和投影矩阵（每次渲染仅使用一个），以实现真实、可修改的世界空间呈现。世界空间的这种类似相机的呈现方式称为视锥体。

# html - 有没有办法设置 Netbeans HTML5 和 Web 应用程序项目？

> ID：14115185
> 
> 赞同：4
> 
> 时间：2013-01-01T23:22:56.247
> 
> 标签：html, web-applications, netbeans, ide

新的 Netbeans 7.3 Beta 2 添加了一个非常好的功能来创建 HTML5 应用程序。它还提供了一种创建基于 Java 服务器的 Web 应用程序的好方法。但是在 Netbeans IDE 中似乎没有任何方法可以在一个项目中利用这两种技术。

有没有办法将这两种类型的项目结合起来，所以只有一个包含 HMTL5、js 和 Web 服务文件的 Web 目录结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T10:44:12.353

这肯定是为下一个版本计划的，但在 NetBeans 7.3 中尚不可能。您可以按照此增强请求查看该领域的进展： http://netbeans.org/bugzilla/show_bug.cgi?id= [222236](http://netbeans.org/bugzilla/show_bug.cgi?id=222236)。如果您想对此进行试验，可以使用附加到该问题的补丁来构建 NetBeans。

# sql - 带 SQL Server 的 Amazon RDS 不允许从 CSV 源批量插入

> ID：14115188
> 
> 赞同：5
> 
> 时间：2013-01-01T23:23:21.683
> 
> 标签：sql, sql-server, csv, import, rds

我已经尝试了两种方法，但都失败了......

```
BULK INSERT TEMPUSERIMPORT1357081926 
FROM 'C:\uploads\19E0E1.csv' 
WITH (FIELDTERMINATOR = ',',ROWTERMINATOR = '\n') 
```

> 您没有使用批量加载语句的权限。

但您无法使用 Amazon RDS 启用该 SQL 角色？

所以我尝试...使用 openrowset 但它需要启用 AdHoc 查询，我无权这样做！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2020-05-05T02:05:15.557

我知道这个问题真的很老，但这是我搜索批量插入到 aws sql server rds 实例时出现的第一个问题。事情发生了变化，您现在可以在将 RDS 实例与 S3 集成后执行此操作。我在这个问题上更详细地回答[了这个问题](https://stackoverflow.com/questions/28591160/csv-file-in-amazon-s3-to-amazon-sql-server-rds/59341064#59341064)。但总体要点是您使用适当的角色设置实例，将文件放在 S3 上，然后您可以使用以下命令将文件复制到 RDS：

```
exec msdb.dbo.rds_download_from_s3
        @s3_arn_of_file='arn:aws:s3:::bucket_name/bulk_data.csv',
        @rds_file_path='D:\S3\seed_data\data.csv',
        @overwrite_file=1; 
```

然后`BULK INSERT`将工作：

```
FROM 'D:\S3\seed_data\data.csv'
WITH
(
    FIRSTROW = 2,
    FIELDTERMINATOR = ',',
    ROWTERMINATOR = '\n'
) 
```

[AWS 文档](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/User.SQLServer.Options.S3-integration.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-03T09:18:59.333

您可以通过前往您的 Amazon 管理控制台、导航到您的 RDS 菜单，然后创建一个数据库参数组并将临时分布式查询设置为 1，然后将此参数组附加到您的数据库实例来启用临时分布式查询。

进行这些更改后，不要忘记重新启动数据库。

以下是我的信息来源：

[http://blogs.lessthandot.com/index.php/datamgmt/dbadmin/turning-on-optimize-for-ad/](http://blogs.lessthandot.com/index.php/datamgmt/dbadmin/turning-on-optimize-for-ad/)

希望这对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-19T20:50:13.910

## 2022

我正在为像我这样想要从 C# 快速将数据插入 RDS 的人添加

虽然 RDS 允许[直接从 S3 实例批量上传 csv](https://www.mssqltips.com/sqlservertip/6619/rds-sql-server-data-import-from-amazon-s3/)，但有时您只想直接从程序上传数据。

我编写了一个 C# 实用程序方法，它使用 StringBuilder 进行插入以连接语句以每次调用执行 2000 次插入，这比像 dapper 这样的 ORM 更快，每次调用执行一次插入。

这个方法应该处理 date、int、double 和 varchar 字段，但我不必将它用于字符转义或类似的事情。

```
//call as
FastInsert.Insert(MyDbConnection, new object[]{{someField = "someValue"}}, "my_table");

class FastInsert
{
    static int rowSize = 2000;
    internal static void Insert(IDbConnection connection, object[] data, string targetTable)
    {
        var props = data[0].GetType().GetProperties();

        var names = props.Select(x => x.Name).ToList();

        foreach(var batch in data.Batch(rowSize))
        {
            var sb = new StringBuilder($"insert into {targetTable} ({string.Join(",", names)})");
            string lastLine = "";

            foreach(var row in batch)
            {
                sb.Append(lastLine);
                var values = props.Select(prop => CreateSQLString(row, prop));
                lastLine = $"select '{string.Join("','", values)}' union all ";
            }

            lastLine = lastLine.Substring(0, lastLine.Length - " union all".Length) + " from dual";
            sb.Append(lastLine);
            var fullQuery = sb.ToString();
            connection.Execute(fullQuery);
        }
    }

    private static string CreateSQLString(object row, PropertyInfo prop)
    {
        var value = prop.GetValue(row);
        if (value == null) return "null";

        if (prop.PropertyType == typeof(DateTime))
        {
            return $"'{((DateTime)value).ToString("yyyy-MM-dd HH:mm:ss")}'";
        }

        //if (prop.PropertyType == typeof(string))
        //{
            return $"'{value.ToString().Replace("'", "''")}'";
        //}
    }
}

static class Extensions
{
    public static IEnumerable<T[]> Batch<T>(this IEnumerable<T> source, int size) //split an IEnumerable into batches
    {
        T[] bucket = null;
        var count = 0;

        foreach (var item in source)
        {
            if (bucket == null)
                bucket = new T[size];

            bucket[count++] = item;

            if (count != size)
                continue;

            yield return bucket;

            bucket = null;
            count = 0;
        }

        // Return the last bucket with all remaining elements
        if (bucket != null && count > 0)
        {
            Array.Resize(ref bucket, count);
            yield return bucket;
        }
    }
} 
```

# haskell - 省略显式 forall 会产生模棱两可的类型错误

> ID：14115191
> 
> 赞同：4
> 
> 时间：2013-01-01T23:23:38.563
> 
> 标签：haskell, types, ghc

我遇到了一个函数无法进行类型检查的情况，除非我在其类型签名的开头显式添加一个 forall。

有问题的功能是：

```
test :: (Typeable a) => a -> a
test x 
    | typeOf (undefined :: a) == typeOf (undefined :: a) = x
    | otherwise = x 
```

GHC 对上述问题提出以下警告：

```
 Ambiguous type variable `a0' in the constraint:
  (Typeable a0) arising from a use of `typeOf'
Probable fix: add a type signature that fixes these type variable(s)
In the first argument of `(==)', namely `typeOf (undefined :: a)'
In the expression:
  typeOf (undefined :: a) == typeOf (undefined :: a)
In a stmt of a pattern guard for
               an equation for `test':
  typeOf (undefined :: a) == typeOf (undefined :: a)

Ambiguous type variable `a1' in the constraint:
  (Typeable a1) arising from a use of `typeOf'
Probable fix: add a type signature that fixes these type variable(s)
In the second argument of `(==)', namely `typeOf (undefined :: a)'
In the expression:
  typeOf (undefined :: a) == typeOf (undefined :: a)
In a stmt of a pattern guard for
               an equation for `test':
  typeOf (undefined :: a) == typeOf (undefined :: a) 
```

所以它没有统一这两种类型的未定义值。但是，如果我在前面添加一个 forall a ：

```
test :: forall a. (Typeable a) => a -> a
test x 
    | typeOf (undefined :: a) == typeOf (undefined :: a) = x
    | otherwise = x 
```

它编译得很好。这是在 GHC 7.4.2 中使用

```
{-# LANGUAGE GADTs, StandaloneDeriving, DeriveDataTypeable,
ScopedTypeVariables, FlexibleInstances, UndecidableInstances,
Rank2Types #-} 
```

我的印象是，在类型签名中省略“forall”相当于在所有相关类型变量的开头隐式附加 foralls（如 GHC 文档中所建议：[http ://www.haskell.org/ghc/docs/ 7.4.2/html/users_guide/other-type-extensions.html](http://www.haskell.org/ghc/docs/7.4.2/html/users_guide/other-type-extensions.html)）。为什么第一个代码片段不进行类型检查，而第二个代码片段呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T23:26:30.803

该`ScopedTypeVariables`扩展将语义值添加到顶级`forall`量词。它为绑定主体上的类型变量提供范围。

没有它`forall`，第`a`3 行的类型变量与第 1 行的类型变量是不同的类型变量`a`。错误消息通过标记它们`a0`和来表明这一点`a1`。如果没有相同的类型，第 3 行的类型是模棱两可的，因为它完全不受约束。

# html - 如何在提交按钮上显示图像？

> ID：14115192
> 
> 赞同：3
> 
> 时间：2013-01-01T23:23:46.103
> 
> 标签：html, css, button, submit, background-image

我有一个提交按钮，我想在该按钮上显示一个图像（a.jpg），并且不会显示提交按钮的值。是否有可能在“提交”类型的按钮的情况下？（不是“类型='图像'”）

```
<input type="submit" value="submit" /> 
```

-谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T23:30:53.543

您可以使用 CSS 适当地设置按钮的样式

```
​&lt;input id="it" type="submit" value="Submit">​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

```
​#it{
    background-image:url(http://placehold.it/50x50);
    font-size:0;
    width:50px;
    height:50px;
}​ 
```

[**演示**](http://jsfiddle.net/z9XuW/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T23:29:48.783

```
<button type="submit" name="foo" value="bar">
    <img src="image.png" alt="submit">
</button> 
```

# d3.js - iPython中的d3插件安装问题

> ID：14115194
> 
> 赞同：1
> 
> 时间：2013-01-01T23:23:53.307
> 
> 标签：d3.js, ipython, ipython-notebook

我发现了这个问题： http: [//grokbase.com/t/scipy.org/ipython-dev/12bygp3793/try-jsplugins-d3graph](http://grokbase.com/t/scipy.org/ipython-dev/12bygp3793/try-jsplugins-d3graph)。在解决方案中建议从以下位置编译 ipython： [https ://github.com/ellisonbg/ipython/tree/jsonhandlers](https://github.com/ellisonbg/ipython/tree/jsonhandlers)

我这样做了，并按照这里的指示： [https ://github.com/ipython/jsplugins](https://github.com/ipython/jsplugins)

总结一下：我按照 jsplugins > d3graph > README.md 的说明进行操作

d3graph.py ：复制到 .ipython\extensions

d3graph.js 和 d3graph.css ：复制到 .ipython\profile_default\static\jsplugins\d3graph

（注意：我在 ubuntu/linux 12.10 ipython-0.14.dev.egg-info 上）

运行 ipython notebook --pylab inline

打开 Visualizing Graphs with d3.ipynb

每个单元格都已执行，但图表未显示。

但我可以用以下方式绘制图表：

```
pos=nx.spring_layout(G,iterations=100)
plt.subplot(221)
nx.draw(G,pos,font_size=8) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T03:55:53.257

很奇怪，因为我也不能使用插件。

你能探测到 .config/.ipython/profile_default 文件夹中的说明吗？因为那是真正的会话路径

# c - 将字符串文字传递给 C 中的函数

> ID：14115195
> 
> 赞同：0
> 
> 时间：2013-01-01T23:24:04.317
> 
> 标签：c, arrays, pointers

当您将字符串文字（例如“ABC”）分配给 char a[] ex。

```
char a[] = "ABC"; 
```

它有做的效果

```
char a[4] = {'A','B','C','0'}; 
```

当你将它传递给函数参数时，同样的事情是否适用

前任。

```
int f(char a[]); 
```

对比

```
int f(char *a); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T23:27:21.003

> 当你将它传递给函数参数时，同样的事情是否适用

不; 一般来说，在 C 中你不能直接按值传递数组；函数的每个数组参数实际上都被编译器解释为指针参数，即当您编写

```
int f(char a[]); 
```

编译器看到

```
int f(char *a); 
```

（即使您指定了数组的维度，这同样适用）

* * *

顺便一提，

> 它有做的效果
> 
> ```
> char a[3] = {'A','B','C"}; 
> ```

实际上，它的效果是：

```
char a[4] = {'A','B','C', 0}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T23:25:36.363

不，因为这两个函数声明是相同的。两者都声明了一个带有指向 的指针的函数`char`，并且在这两种情况下，参数都被初始化为指向字符串文字的第一个元素的指针。

# android - android中的动画，android的新手

> ID：14115196
> 
> 赞同：0
> 
> 时间：2013-01-01T23:24:21.270
> 
> 标签：android, alpha

我有这两张照片： ![在此处输入图像描述](../Images/b84e77fe0307bb7d5e52ad7feabde8c9.png)

![在此处输入图像描述](../Images/03c2c19ad1655c344f531c836023b62b.png)

我正在尝试为它们制作动画。我想展示第一张照片（没有轮子的），然后是带轮子的。它应该看起来像车轮已经出现，因为位置不会改变，汽车也不会消失。所以我尝试使用淡入效果，因为如果我只是“重新加载”我的 xml 布局，它看起来不太好。

我找到了很多教程，但没有一个能解决我的问题。我的问题是：有人知道，该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T09:37:05.550

使用 FrameLayout 堆叠两个 ImageView 始终显示您的第一张图片没有 Weels 并使用任何动作侦听器使用 AlphaAnimation 触发第二个 ImageView 上的动画。

```
 Animation animation = new  AlphaAnimation(0.0f, 1.0f);
 animation.setDuration(1000); // anim duration in milli second
 animation.setRepeatCount(0); // 0 no repeat
 animation.setFillAfter(true); 
 iv.startAnimation(animation); // iv is your imageview 
```

# javascript - Javascript中数组中匹配属性的总和值

> ID：14115198
> 
> 赞同：0
> 
> 时间：2013-01-01T23:24:29.750
> 
> 标签：javascript

在 C# 中，我们有一个`.Sum(Predicate)`方法可以让您使用 lambda 表达式对对象集合进行求和。例如，如果我有以下一组对象（为简单起见使用 JSON）

```
[
  {
    "Id": 1,
    "Sub": {
      "Size": 1
    }
  },
  {
    "Id": 2,
    "Sub": {
      "Size": 3
    }
  }
] 
```

我想得到尺寸的总和，我可以做到`Sum(n => n.Sub.Size)`

有没有办法在javascript中做这样的事情？我对这门语言真的很陌生（而且很弱），并且在执行类似的功能时遇到了麻烦。我正在使用 jQuery，所以我也愿意打开任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:28:23.970

```
var result = arr.reduce(function(a, b) {
    return a + b.Sub.Size;
}, 0); 
```

演示：http: [//jsfiddle.net/sUCTK/](http://jsfiddle.net/sUCTK/)

文档：[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/Reduce)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T23:27:33.837

在 JavaScript 中，您需要手动单步执行数组并将值相加：

```
var sum = 0;
for (var i in a) {
  sum += a[i].Sub.Size
}
// sum now contains the total 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T23:29:09.240

为了跨浏览器的兼容性，您可以这样做：

```
var sum = function(arr, callback, initial_value) {
    if (arguments.length < 3) {
        initial_value = 0;
    }
    var ret = initial_value;

    for (var i = 0; i < arr.length; i++) {
        ret += callback(arr[i]);
    }        

    return ret;    
};

console.log(sum(arr, function(element) {
    return element.Sub.Size;
}); 
```

这也可以让您通过传递适当的类型来对其他可求和对象（如字符串）求和`initial_value`。

@zerkms 展示了如何使用新的 ECMAScript 标准来更好地总结事物。

# uiscrollview - 使用 UIScrollView 在 UIPageControl 中进行惯性滚动

> ID：14115199
> 
> 赞同：2
> 
> 时间：2013-01-01T23:24:32.487
> 
> 标签：uiscrollview, uipagecontrol, inertial-navigation

我有一个`UIScrollView`启用分页，并且一个对应`UIPageControl`的表示当前页面。这很好用，但我想引入惯性滚动以通过一次滑动来导航多个页面。

我见过的一个例子是 iOS 的 StickTennis 应用程序。我该怎么做类似的事情？

![看图片](../Images/e75ccd07c65313388fe45f5f91d226f5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:34:05.933

您将`pagingEnabled`滚动视图的属性设置为`NO`，然后使用数值推导计算用户手指离开屏幕时的滚动速度。从现在开始，您可以使用`s = v0 * t + a / 2 * t ^ 2`公式来计算滚动视图的新位置（when`a`是一个恒定的减速率，`v0`是您刚刚计算的速度），然后您将`scrollRectToVisible:animated:`使用适当更新的`rect`参数重复调用。

# windows - Gl3w 编译错误：从 'PROC ... 到 void*' 的无效转换

> ID：14115205
> 
> 赞同：1
> 
> 时间：2013-01-01T23:25:00.290
> 
> 标签：windows, opengl

在我的计算机中设置 gl3w：抛出 2 个我不知道如何解决的错误：

由 Gl3w 脚本构建的函数存在错误：

```
static void *get_proc(const char *proc)               - line 19
{
void *res;

res = wglGetProcAddress(proc);                    - line 23, first error
if (!res)
    res = GetProcAddress(libgl, proc);        - line 25, second error
return res;
} 
```

构建错误：

```
||=== LearnOPG, Debug ===|
C:\CodeBlocks\LearnOPG\gl3w.c||In function 'void* get_proc(const char*)':|

C:\CodeBlocks\LearnOPG\gl3w.c|23|error: invalid conversion from 'PROC {aka int (__attribute__((__stdcall__)) *)()}' to 'void*' [-fpermissive]|

C:\CodeBlocks\LearnOPG\gl3w.c|25|error: invalid conversion from 'FARPROC {aka int (__attribute__((__stdcall__)) *)()}' to 'void*' [-fpermissive]|

||=== Build finished: 2 errors, 0 warnings (0 minutes, 0 seconds) ===| 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:05:03.993

一些编译器/平台不如其他编译器/平台那么挑剔。`void*`C 或 C++ 不能保证函数指针之间隐式转换。但是 GL3W 的代码希望它能够工作；显然，它没有使用更严格的编译器/平台进行测试。

您可能应该[向 GL3W 人员](https://github.com/shakesoda/gl3w)提交一份错误报告。诚然，它似乎并没有被积极处理，但他们可能会修复它。

# actionscript-3 - 'Runner' 游戏，循环滑动背景，在外面时移除孩子

> ID：14115206
> 
> 赞同：0
> 
> 时间：2013-01-01T23:25:04.200
> 
> 标签：actionscript-3, actionscript

我刚开始使用 actionscript 3，目前正在尝试在 Flash CS5 中制作滚动跑步游戏，类似于 Tremor 游戏中的 Flood Runner 游戏。然而，不同之处在于，我的游戏*不是无休止的*跑步游戏，角色有一个目的地，她必须在时间用完之前到达。我读过的很多关于这个主题的教程都使用玩家角色的 x 和 y 位置来滚动，但在我的游戏中，背景滚动独立于角色。我读过的教程并没有专门解决我的问题。

TL;DR：我不想循环我的背景，但有一系列多个背景图像。

我试图找出无缝拼接多个背景图像的最佳方法。目前，我有一个最大像素宽度的背景影片剪辑对象。背景对象向左滚动，与只能跳跃的玩家角色的位置无关。

我正在考虑做的是这样的：

每当一个背景图像的最右边缘的一个点到达最右侧的舞台边界时，我都会让我的动作脚本为下一个背景对象调用 addChild 命令并在最右侧的舞台边界处实例化它。它将以与前面的背景对象相同的速度滚动。

我还需要弄清楚如何在背景对象出于内存目的完全退出舞台后删除它们。

那么，解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:00:53.117

您的基本概念将起作用，并且要删除您只需要评估背景图像何时离开屏幕：

```
if (backgroundImage.x < -backgroundImage.width)
{
    // image is no longer on the screen.
    removeChild(backgroundImage);
} 
```

# android - setAdapter() 上的空指针异常

> ID：14115208
> 
> 赞同：3
> 
> 时间：2013-01-01T23:25:14.360
> 
> 标签：android, listview, android-listview

我正在尝试创建一个自定义 ListView 适配器（大致基于[本教程](http://publicstaticdroidmain.com/2011/12/building-a-custom-multi-line-listview-in-android/)，但示例很简单，我怀疑您是否需要查看它）。

**NewsEntriesAdapter.java**

```
public class NewsEntriesAdapter extends BaseAdapter {
    private static ArrayList<NewsEntries> newsEntriesArrayList;

    private final LayoutInflater mInflater;

    public NewsEntriesAdapter(Context context, ArrayList<NewsEntries> entries) {
        newsEntriesArrayList = entries;
        mInflater = LayoutInflater.from(context);
    }

    @Override
    public int getCount() {
        return newsEntriesArrayList.size();
    }

    @Override
    public Object getItem(int position) {
        return newsEntriesArrayList.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;

        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.assignment_list_row_view,
                    null);
            holder = new ViewHolder();
            holder.txtName = (TextView) convertView.findViewById(R.id.name);
            holder.txtCityState = (TextView) convertView
                    .findViewById(R.id.cityState);
            holder.txtPhone = (TextView) convertView.findViewById(R.id.phone);

            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        holder.txtName.setText(newsEntriesArrayList.get(position).getName());
        holder.txtCityState.setText(newsEntriesArrayList.get(position)
                .getCityState());
        holder.txtPhone.setText(newsEntriesArrayList.get(position).getPhone());

        return convertView;
    }

    static class ViewHolder {
        TextView txtName;
        TextView txtCityState;
        TextView txtPhone;
    }

} 
```

**MainActivity.java（onCreate 方法）**

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ArrayList<NewsEntries> results = new ArrayList<NewsEntries>();

    // I left the NewsEntries class out of this question; it's just a POJO with some get and set methods for Name, CityState, and Phone
    NewsEntries sr = new NewsEntries();
    sr.setName("Justin Schultz");
    sr.setCityState("San Francisco, CA");
    sr.setPhone("415-555-1234");
    results.add(sr);

    final ListView lv = (ListView) findViewById(R.id.list);

    System.out.println(results.get(0).getName());

    lv.setAdapter(new NewsEntriesAdapter(this, results));
} 
```

但是，`lv.setAdapter`正上方的行会使应用程序崩溃，并出现空指针异常。

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-01T23:27:37.260

您没有在`Activity`. 您`setContentView`的. _`addContentView``onCreate`

因此，`findViewById`将无法找到视图，因为根本**没有**视图，并将返回`null`。

# objective-c - NSTask 不适用于旧版本的 Mac OSX

> ID：14115216
> 
> 赞同：2
> 
> 时间：2013-01-01T23:26:37.357
> 
> 标签：objective-c, cocoa, nstask

我对包含 NSTask 的方法有一个非常奇怪的问题。在 10.7+ 中，该功能运行良好并成功执行，返回结果并将文件复制到所需目录。

在 10.6.8 中尝试我的应用程序时，NSTask 似乎什么也没做，实际上没有错误，或者任何提示我为什么它不工作的东西。我已经尝试了所有可能的角度来确定问题出在哪里，并且我已经排除了可能性。：-/

```
NSTask *task = [[NSTask alloc] init];
[task setLaunchPath: @"/bin/sh"];

NSArray *arguments = [NSArray arrayWithObjects: @"-c",
                     @"find /Data/*.jug/files/ -name thefile | head -n 1 | awk -v dir=\"$HOME/path/to/copy/to\" '{printf \"cp \\\"%s\\\" \\\"%s\\\"\\n\", $1, dir }' | sh", nil];

[task setArguments: arguments];

NSPipe *thePipe = [NSPipe pipe];
[task setStandardInput:[NSPipe pipe]];
[task setStandardOutput:thePipe];

[task launch];
[task waitUntilExit];
[task release]; 
```

如果在 10.6.8 中通过终端尝试该命令，我会得到我希望在我的应用程序中得到的结果。我在这里完全不知所措，真的希望有人能对这个问题以及如何解决它有所了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T14:07:39.920

The `/Data/*.jug: Not a directory` error message typically occurs when there are no files to be matched by the shell's glob expansion and the literal `/Data/*.jug` is passed to a command that requires an existing file or directory as an argument.

Using the `Bash` shell you can avoid this kind of error by using `shopt -s nullglob`.

In addition, you should make sure that glob expansion is enabled (`set +f` in `Bash`).

Therefore explicitly use the `Bash` shell with `[task setLaunchPath: @"/bin/bash"];` and start testing your shell code with:

`@"set +f; shopt -s nullglob; ls -ld /; find /Data/*.jug/files/ -name thefile"`

Then add & test each further command of your given shell code step by step.

You may also use complete executable paths to be absolutely sure, e. g. `/usr/bin/find`.

In your `awk` command replace `$1` with `$0` in case there is a file name containing a space.

A possible source of confusion for the compiler may be the C-style comment start `/*` in `/Data/*.jug/files/`.

To get more output information use shell commands in verbose mode if possible, e. g. `cp -v` and `bash -xv -c`.

Your code worked for me on my machine with Mac OS X 10.6.8 using `asynctask.m` from [NSPipe - CocoaDev](http://cocoadev.com/wiki/NSPipe) and `/usr/bin/gcc-4.2` as compiler.

```
NSTask *task = [[NSTask alloc] init];
[task setLaunchPath: @"/bin/bash"];

NSArray *arguments = [NSArray arrayWithObjects: 
   @"-xv",
   @"-c",
   @"set +f; shopt -s nullglob; ls -ld /noSuchFile; find /Data/*.jug/files/ -name thefile | head -n 1 | awk -v dir=\"$HOME/path/to/copy/to\" '{printf \"cp -v \\\"%s\\\" \\\"%s\\\"\\n\", $1, dir }' | bash -xv", nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T03:52:29.950

尝试使用以下引号：

```
'/Data/*.jug/files/' 
```

或者

```
 \"/Data/*.jug/files/\" 
```

# .net - GAC 是否在文件系统之前检查非“强命名”程序集引用？

> ID：14115218
> 
> 赞同：0
> 
> 时间：2013-01-01T23:26:54.983
> 
> 标签：.net, assemblies, gac, strongname

给定

*   我们有一个非强命名程序集的引用
*   应用程序的 bin 目录中存在的非强命名版本。
*   在 GAC 中安装的具有相同版本号的该程序集的强命名版本

加载该程序集时，我们是从文件系统还是从 GAC 获得？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:32:44.623

假设程序集探测路径在配置中没有改变，位于应用程序目录中的程序集将被加载。

# c - 如何从 ctypes 传递预处理器指令？

> ID：14115221
> 
> 赞同：0
> 
> 时间：2013-01-01T23:27:03.487
> 
> 标签：c, preprocessor-directive

我有一些包含在预处理器指令中的 C 代码：

```
#if defined(TEST)
// do stuff
#endif 
```

我需要`do stuff`通过 ctypes 从 Python 执行 - 有什么方法可以定义`TEST`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:29:01.193

`ctypes`这与python完全无关。ctypes 仅处理已编译的库并允许您调用其中的函数。如果你想执行一个只有条件定义的函数，你必须使用正确的指令集编译库。

在 gcc 中，这将类似于`gcc -D TEST <rest as usual>`

# java - 对字符串的 ArrayList 进行排序时遇到问题

> ID：14115222
> 
> 赞同：0
> 
> 时间：2013-01-01T23:27:16.803
> 
> 标签：java

> **可能重复：**
> [按日期对特殊字符串的数组列表进行排序](https://stackoverflow.com/questions/6059509/sort-array-list-of-special-strings-by-date)

我有一个从文件中读取的字符串数组列表，每个字符串的第一部分是一个日期，例如：12/01/2012。当我使用 Collections.sort(); 它在一年内从最旧到最新对其进行排序，但是当它到达 2013 年 1 月 1 日时，它会将其放在最旧的列表顶部。我怎样才能让它使用年份作为排序的一部分？我尝试使用日期，但它也是如此。每个字符串都有很多我想保留的信息，只需从头开始排序。我认为没有必要发布代码，因为它正在工作，而我遇到的所有问题只是排序。我在这里搜索了一段时间并尝试了一些不同的排序选项无济于事。所以我一定很困惑或忘记了什么。如果有人对如何在开头对带有日期的字符串进行排序有任何想法，请提供帮助！谢谢！

示例字符串：“2012 年 12 月 1 日 34023843 项目编号”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:36:55.607

如果字符串总是相同的格式，你可以实现一个自定义[比较器](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)并使用 Collections.sort(list,comparator) 这个比较器将首先检查年，然后是月，然后是日。

或者，（最好的解决方案 ahma），您可以重新设计具有多个字段（和日期）的对象列表，并使用日期实现比较器。直接使用字符串永远不会保存（例如，此处使用字符串比较器，您将无法使用其他日期格式）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T23:37:46.537

您当前正在使用字符串排序进行排序。这意味着“01/01/2013”​​排在“12/31/2012”之前，因为“0”小于“1”。

您可以使用[自定义比较器](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)来使用不同的逻辑。在您的比较器中，您将：

1.  拆分字符串以获取日期
2.  使用 SimpleDateFormat 将字段 0 转换为日期
3.  然后在你的两个日期打电话比较

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T23:41:45.633

您需要一个自定义比较器。以自然顺序比较字符串（即使用`String`implements的事实`Comparable<String>`）将给出您看到的结果，因为`0`低于`1`，所以这是预期的。

这是一个示例类，它可以做你想做的事，但请注意，它假定所有日期的格式都正确（如果日期不正确，该`parse()`方法会`DateFormat`抛出未选中`IllegalArgumentException`的内容）：

```
public final class MyComparator
    implements Comparator<String>
{
    // Date parsing
    // Note: SimpleDateFormat is not thread-safe, if possible use Joda Time instead
    private static final DateFormat fmt = new SimpleDateFormat("dd/MM/YYYY");

    private static final Comparator<String> INSTANCE = new MyComparator();

    private MyComparator()
    {
    }

    public static Comparator<String> getInstance()
    {
        return INSTANCE;
    }

    @Override
    public int compare(String o1, String o2)
    {
        // Grab dates
        String s1 = o1.subString(0, 10);
        Date d1 = fmt.parse(s1);
        String s2 = o2.subString(0, 10);
        Date d2 = fmt.parse(s2);

        // Date implements Comparable<Date>, so we can use that...
        int ret = d1.compareTo(d2);

        // If dates are equal, compare the rest of the strings instead.
        return ret != 0 ? ret : o1.subString(10).compareTo(o2.subString(10));
    }
} 
```

然后你可以使用`Collections.sort(theArray, MyComparator.getInstance());`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T00:06:06.687

@fge 的答案有效，但比较器必须多次拆分和转换字符串。事实上，对于典型的排序算法，这需要执行`O(NlogN)`多次，其中`N`是列表的长度。对于大型列表，该`logN`术语将很重要。

我的建议是创建一个自定义`Line`类来表示文件中的行。让构造函数将表示行的字符串解析为组件，解析日期组件并将所有相关组件保存在私有字段中。让自定义类实现`Comparable<Line>`，并实现`compareTo(Line)`按日期比较行的方法。

然后将文件内容表示为`ArrayList<Line>`而不是`ArrayList<String>`.

（有可能你无论如何都需要解析这些行......在它们被排序之后。所以这种方法只是在排序之前进行解析，并且只做一次。FWIW，“重复”问题的答案涵盖这也是：[按日期对特殊字符串的数组列表进行排序](https://stackoverflow.com/questions/6059509/sort-array-list-of-special-strings-by-date)）

# jquery - 识别子元素的类并删除所有匹配类的属性

> ID：14115226
> 
> 赞同：3
> 
> 时间：2013-01-01T23:27:22.223
> 
> 标签：jquery

我正在尝试删除与单击的元素的子元素的类匹配的所有元素的属性。

例如

```
<span class="parent">
    <span class="child1">
        <a href="mylink">text</a>
    </span>
</span>

<span class="child1">
    <a href="mylink">text</a>
</span> 
```

`href`我有从单击的元素中删除属性的代码。但是，我希望能够删除任何具有相同链接的元素。

我当然可以指定特定的类，但我希望代码找到被点击的父类的子类，然后找到任何匹配的类并删除 href。

在这种情况下，该人将单击`.parent`元素，代码将搜索子元素的类`.child1`，删除`href`并删除`href`也具有匹配子元素类的任何元素的类，`.child1`。

因此，代码将对以下情况执行相同的操作

```
<span class="parent">
    <span class="child2">
        <a href="mylink">text</a>
    </span>
</span>

<span class="child2">
    <a href="mylink">text</a>
</span> 
```

删除`href`所有`.child2`类。

这样做的原因是因为我需要多次使用此功能，并且我不想每次指定要删除的类时都编写不同的代码`href`。

我认为该构造将类似于以下内容，尽管我不确定要使用哪些 jQuery 组合来实现它。

```
$("parant").click(function () {
    $.find(this.childrenClass, function () {
        $.removeAtt("href");   
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:43:31.753

代码应该是不言自明的：

```
$('.parent').click(function() {
    // Get all classes from child elements.
    var classes = $(this).children().map(function() {
        return this.className.split(/\s+/);
    }).get();

    // Find any element having one of those classes, find all `a` children
    // and remove the href attribute.
    $('.' + classes.join(',.')).children('a').removeAttr('href');
}); 
```

在这里，我只是在寻找与任何孩子有共同类的任何元素。如果您愿意，您将不得不调整代码以将其限制为某些元素。

代码也可以简化，这取决于您的实际标记（即，如果每个父母只有一个孩子，或者每个孩子只有一个班级）。

[**演示**](http://jsfiddle.net/pgQLd/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T23:47:05.607

```
$(".parent").click(function () {
    var $this = $(this),
        klass = $this.children("span").attr("class");
    $("." + klass).find("a").removeAttr("href");
});​ 
```

[http://jsfiddle.net/366cc/](http://jsfiddle.net/366cc/)

# javascript - 有条件地将行复制到另一个工作表并在行更新后将其删除

> ID：14115229
> 
> 赞同：0
> 
> 时间：2013-01-01T23:27:52.067
> 
> 标签：javascript, google-apps-script, google-sheets

我有一个电子表格，其中包含要在活动前 60、30 和 1 天填写的清单。这些工作表被称为“60 天”、“30 天”和“启动”。我正在尝试将未选中的行自动添加到下一张表中（因此“60 天”上的任何未选中行都将附加到“30 天”，并从“30 天”附加到“kickoff”——另外，“checked off”是指在一个单元格中输入了一个“x”）。我在代码上有一个很好的开始，但我一定是做错了什么——因为它似乎没有做任何事情（请原谅我对 javascript 的无知，我上周开始使用 codecademy 和大量浏览进行编码在这些论坛上）。我觉得我有一些非常基本的东西 我可能失踪了，我会欢迎我能得到的任何帮助。这就是我所拥有的...

```
function onEdit() {

var ss = SpreadsheetApp.getActiveSpreadsheet();
var r = ss.getActiveCell();
var i = 4;//have this number be your first row of data

  if(r.getColumn()===5){ // this indicates the column that, if left blank, will mean the row should be copied to the next sheet

    if (ss.getActiveSheet().getName()=="60-Day"){

      var source_sheet = ss.getSheetByName("60-Day");
      var target_sheet = ss.getSheetByName("30-Day");
      var last_row = target_sheet.getLastRow();

      while(i<=last_row){

        if(source_sheet.getValue("E"+i)!="x"){

          var source_range = source_sheet.getRange(i,2,1,6); // indicate the columns you'd like to copy
          var target_range = target_sheet.getRange(last_row + 1,2,1,6); // indicate the columns where you'd like to paste
          source_range.copyTo(target_range);
          i++;
          SpreadsheetApp.flush();
        }else{
        i++;
        }
      }
};
    else if (ss.getActiveSheet().getName()=="30-Day"){
      var source_sheet = ss.getSheetByName("30-Day");
      var target_sheet = ss.getSheetByName("Kickoff");
      var last_row = target_sheet.getLastRow();

      while(i<=last_row){

        if(ss.getValue("E"+i)!="x"){

           var source_range = source_sheet.getRange(i,2,1,6);//indicate the columns you'd like to copy
          var target_range = target_sheet.getRange(last_row + 1,2,1,6);//indicate the columns where you'd like to paste
          source_range.copyTo(target_range);
          i++;
          SpreadsheetApp.flush();
        }else{
        i++;
        }
      };
    }
}
} 
```

就是这样——不过，这就是我遇到更多麻烦的地方。如果一行已被推送到目标工作表并在目标工作表上被选中，我希望它从目标工作表中消失，并且我希望源工作表中的原始行现在显示它已经勾选。此外，如果在源工作表上选中了以前的空白行，我希望已推送到目标工作表的副本消失。这是我开始迷路的地方。我将如何实施呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T05:37:48.093

认为你会想要这个变化......

```
function onEdit() {

  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var r = ss.getActiveCell();
  var i = 4;//have this number be your first row of data

  if(r.getColumn()===5){ // this indicates the column that, if left blank, will mean the row should be copied to the next sheet

    if (ss.getActiveSheet().getName()=="60-Day"){

      var source_sheet = ss.getSheetByName("60-Day");
      var target_sheet = ss.getSheetByName("30-Day");
      var source_last_row = source_sheet.getLastRow();
      var target_last_row = target_sheet.getLastRow() + 1;  

      while(i<=source_last_row){

        if(source_sheet.getRange("E"+i).getValue() !="x"){

          var source_range = source_sheet.getRange(i,2,1,6); // indicate the columns you'd like to copy
          var target_range = target_sheet.getRange(target_last_row,2,1,6); // indicate the columns where you'd like to paste
          source_range.copyTo(target_range);
          //var new_last_row = target_last_row - 1;
          source_sheet.deleteRow(i);  // delete source row after copy
          i++;
          SpreadsheetApp.flush();
          target_sheet.getRange('E'+target_last_row).setValue('x');  // insert 'x' back into target
        }else{
          i++;
        }
      }
    }
    else if (ss.getActiveSheet().getName()=="30-Day"){
      var source_sheet = ss.getSheetByName("30-Day");
      var target_sheet = ss.getSheetByName("Kickoff");
      var source_last_row = source_sheet.getLastRow();
      var target_last_row = target_sheet.getLastRow() + 1;  

      while(i<=source_last_row){

        if(source_sheet.getRange("E"+i).getValue() !="x"){

          var source_range = source_sheet.getRange(i,2,1,6);//indicate the columns you'd like to copy
          var target_range = target_sheet.getRange(target_last_row,2,1,6);//indicate the columns where you'd like to paste
          source_range.copyTo(target_range);
          //var new_last_row = target_last_row - 1;

          source_sheet.deleteRow(i);  // delete source row after copy
          i++;
          SpreadsheetApp.flush();
          target_sheet.getRange('E'+target_last_row).setValue('x');  // insert 'x' back into target
        }else{
          i++;
        }
      }
    }
  }
} 
```

# java - Java：在泛型类中使用类型变量

> ID：14115233
> 
> 赞同：4
> 
> 时间：2013-01-01T23:28:25.383
> 
> 标签：java, generics, compilation

有人可以向我解释为什么这段代码无法编译吗？

即使它使用泛型类而不提供特定类型 T，它也应该能够在编译时识别 ArrayList 包含字符串。

```
public class Test {
    public static void main(String[] args){
        Container container = new Container();
        container.strings.add("test");
        String s1 = container.strings.get(0); // does not compile
        ArrayList<String> local = container.strings;
        String s2 = local.get(0); // does compile
    }

    static class Container <T>{
        ArrayList<String> strings = new ArrayList<String>();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T23:34:04.360

当您将泛型类用作原始类型（未指定类型的类型）时，**所有泛型信息都会从类中剥离**（无论是否使用省略的类型）。

因此，当您编写代码`Container container`（而不是`Container<SomeClass> container`）`ArrayList<String> strings`时`ArrayList strings`，它的使用方式就像`ArrayList<Object>`.

要“修复”，请指定类型`Container`（即使您不使用该类型）：

```
Container<Object> container = new Container<Object>(); 
```

其余的现在将编译。

* * *

这样做的原因是为了向后兼容 Java 的早期预通用版本（1.4 和更早版本）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T10:44:55.907

正如 Bohemian 所说，原始类型中的每个类型参数都被丢弃。一开始我认为这是一个错误，但[错误数据库中甚至有一个条目（#6244346）](http://bugs.sun.com/bugdatabase/view_bug.do;jsessionid=d98d58bc0945e8e8433f9f2e179?bug_id=6244346)明确引用了相关的[JLS §4.8](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.8)

> 未从其超类或超接口继承的原始类型 C 的构造函数（第 8.8 节）、实例方法（第 8.4 节、第 9.4 节）或非静态字段（第 8.3 节）的类型是对应的原始类型在对应于 C 的泛型声明中擦除其类型。
> 
> 原始类型 C 的静态方法或静态字段的类型与其在对应于 C 的泛型声明中的类型相同。
> 
> 将类型参数传递给未从其超类或超接口继承的原始类型的非静态类型成员是编译时错误。
> 
> 尝试将参数化类型的类型成员用作原始类型是编译时错误。

您无法`String`从 raw获取 a `List`，但可以将 a 分配给`List`a`List<String>`的原因是因为在后者中编译器会发出警告（*未经检查的转换*）但您没有报告它（您是否阅读警告，不要你呢？：P）。我使用 javac 和 Eclipse 编译器测试了您的代码，并且都遵守规范。

引入原始类型是为了与遗留代码的互操作性，但在这种情况下，我无法弄清楚如何为非静态成员保留类型信息会破坏事情。使用参数化类型而不是原始类型将意味着*代码部分移植*，因此在这种情况下，目的可能不仅仅是向后兼容，而是确保代码库的一致性，或者代码是完整的 1.4，或者它完全是 Java 5+。另一种选择是，使用这样的原始类型可能会减慢在类似上下文中采用无界通配符的速度。

顺便说一句（但我认为你自己想通了）如果你不使用类型参数，你可以简单地使用无界通配符，即`Container<?>`

# iphone - ios 6上的导航栏与其他视图重叠

> ID：14115240
> 
> 赞同：1
> 
> 时间：2013-01-01T23:29:14.997
> 
> 标签：iphone, ios, overlap, navigationbar, z-order

对于具有“独特”设计的 iphone 项目（我对此一点都不满意），我需要绘制一个自定义视图，该视图与 UINavigationController 中控制器的导航栏部分重叠。目标是具有固定设备方向（纵向）的 iphone/ios 6。

我目前的解决方案是通过我的控制器以编程方式禁用导航栏`self.navigationController.navigationBar.hidden = YES;`，`viewDidLoad`并绘制一个“假”导航栏并在其上绘制。这导致状态栏颜色保持黑色的问题（因为没有可见的真正导航栏）。这里讨论[iOS 6 状态栏颜色：iOS 6 中的状态栏颜色？](https://stackoverflow.com/questions/12931749/status-bar-color-in-ios-6)

我已经尝试使用`[self.view insertSubview:OVERLAPVIEW aboveSubView:self.navigationController.navigationBar]`但它不起作用，并且在导航栏下方绘制了 OVERLAPVIEW。

是否有另一种方法可以将导航栏与另一个视图（z 方向）重叠？或者有没有办法在没有显示导航栏时更改状态栏颜色（不幸的是，除此之外，重叠的视图是应用程序的主视图和用户可见的第一个屏幕）

全面披露：我是一个 ios 菜鸟和堆栈溢出潜伏者 - 这是我关于堆栈溢出的第一个问题，请帮助我澄清我的问题并在必要时提高我的堆栈溢出技能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T04:14:34.857

采用

```
[self.navigationController.view addSubview:OVERLAPVIEW]; 
```

代替

```
[self.view insertSubview:OVERLAPVIEW aboveSubView:self.navigationController.navigationBar]; 
```

您可以根据使导航栏部分可见来调整视图的框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T16:00:38.163

我通过隐藏导航栏解​​决了这个问题

```
self.navigationController.navigationBar.hidden = YES; 
```

并通过在我的视图中添加导航栏。在这个新导航栏之后添加的所有内容都将与其重叠（您也可以使用 index [parentView.subviews objectAtIndex:0]; ）。状态栏的颜色会根据需要更改。

在启动画面的情况下，我完全一样，并将导航栏与全屏启动图像重叠。

```
-(void)viewDidLoad{
    [super viewDidLoad];
    UINavigationBar * navigationBar = [[UINavigationBar alloc] initWithFrame:CGRectMake(0, 0, 320, 49)];
    UINavigationItem *item = [[UINavigationItem alloc] initWithTitle:@"SPLASH"];
    [navigationBar pushNavigationItem:item animated:NO];
    [self.view addSubview:navigationBar];

    CGRect frame = [[UIScreen mainScreen] bounds];
    frame.origin.y -= 20;
    UIImageView *splashImage = [[UIImageView alloc] initWithFrame:frame];
    splashImage.image = [UIImage imageNamed:@"splash"];
   [self.view addSubview:splashImage];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T09:57:47.020

似乎这个答案解决了我的问题 [在所有其他视图之上添加 UIView，包括状态栏](https://stackoverflow.com/questions/2666792/add-uiview-above-all-other-views-including-statusbar)

注意：目前我不会走这条路，一旦我尝试过我会接受这个答案（我暂时推迟解决这个问题，可能需要一段时间）

# android - 在 Android 4.2 中绘制小 于 1 像素粗的线需要抗锯齿

> ID：14115244
> 
> 赞同：3
> 
> 时间：2013-01-01T23:29:44.643
> 
> 标签：android, canvas, paint, antialiasing, stroke

我试图在android中画一条非常细的线（小于一个像素厚）。我在用着

```
Paint blackThin = new Paint();
blackThin.setStrokeWidth(0.1f);
blackThin.setColor(Color.BLACK); 
```

初始化绘画对象。

这在 Android 2.2 中运行良好，但是当我在 4.2 中尝试时（我认为也是 4.1，我简单地测试了一个 - 我没有测试除 2.2、4.1.2 和 4.2 之外的任何其他版本）行不会当我画它们时出现。为了让它们出现在 4.2 中，似乎我必须将抗锯齿标志设置为 true。（我试过了，线条出现了。）但我真的不想要那样，因为这会模糊线条等。

这是Android中的错误吗？除了打开抗锯齿之外，我还能做些什么来让它工作吗？

编辑：我还用 0.9 的像素大小对此进行了测试，问题是一样的。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T08:31:38.810

`width`在没有抗锯齿的情况下，您无法绘制小于一个像素的线条。

抗锯齿的重点是计算一个像素的颜色，如果一个元素没有完全填满像素（就像一条只有十分之一像素宽度的线）。

你可以通过画一条更轻的线来模拟它，但这仍然不会接近真正的抗锯齿线。

看一下这张图片，例如：

![在此处输入图像描述](../Images/943fa931c0a241a345111ebeb76319c4.png)

真的不可能通过改变线条的颜色来复制抗锯齿的结果。

我意识到示例中的线条宽度 > 1 像素，但同样的原理也适用。像素的“暗度”是根据有多少像素被线条填充来计算的。因此，灰色实线将不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T23:41:28.813

如果您想要一条非常细的线，请使用`setStrokeWidth(0)`，如[文档](http://developer.android.com/reference/android/graphics/Paint.html#setStrokeWidth%28float%29)所述`Pass 0 to stroke in hairline mode.`

子像素绘图显然需要消除锯齿或其他变通方法。很有可能，例如使用软件渲染，低于一个像素的线条总是被绘制为细线，但是使用硬件渲染（在 Android 4.2 中可能会自动使用，但在 2.2 中不会），行为会发生变化，并且许多方便的功能会消失。（这通常是造成差异和奇怪故障的原因，顺便说一句。）

# python - scikit 中大型数据集的 ICA 在线学习

> ID：14115246
> 
> 赞同：4
> 
> 时间：2013-01-01T23:29:56.290
> 
> 标签：python, numpy, machine-learning, computer-vision, scikit-learn

我有一个大型数据集，正在尝试从图像中获取 gabor 过滤器。当数据集变得太大时，就会出现内存错误。到目前为止，我有这个代码：

```
import numpy
from sklearn.feature_extraction.image import extract_patches_2d
from sklearn.decomposition import MiniBatchDictionaryLearning
from sklearn.decomposition import FastICA

def extract_dictionary(image, patches_size=(16,16), projection_dimensios=25, previous_dictionary=None):
    """
    Gets a higher dimension ica projection image.

    """
    patches = extract_patches_2d(image, patches_size)
    patches = numpy.reshape(patches, (patches.shape[0],-1))[:LIMIT]
    patches -= patches.mean(axis=0)
    patches /= numpy.std(patches, axis=0)
    #dico = MiniBatchDictionaryLearning(n_atoms=projection_dimensios, alpha=1, n_iter=500)
    #fit = dico.fit(patches)
    ica = FastICA(n_components=projection_dimensios)
    ica.fit(patches)

    return ica 
```

当 LIMIT 很大时，会出现内存错误。在 scikit 或其他 python 包中是否有一些在线（增量）替代 ICA？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:01:59.580

不，没有。你真的需要 ICA 过滤器吗？试过了`MiniBatchDictionaryLearning`，`MiniBatchKMeans`那是在线的吗？

此外，如果要提取的组件数量很少，虽然不是严格来说在线`RandomizedPCA`能够处理中型到大型数据。

# php - 包含文件时 POST 数组为空

> ID：14115247
> 
> 赞同：2
> 
> 时间：2013-01-01T23:30:37.897
> 
> 标签：php, forms, post, file-upload

我有一个包含文件输入的简单 HTML 表单。当没有文件提交表单时，打印`$_POST`数组会显示所有提交的数据。但是，提交文件时，`$_POST`不会打印出任何提交的数据。

有人可以告诉我为什么吗？这是我的代码：

```
<?php
    print_r($_POST);
?>
<form action="test.php" method="post" enctype="multipart/form-data">
    <label for="myfile">Video File:</label>
    <input type="file" name="myfile" />
    <br /><br />
    <label for="mytitle">Title:</label><br />
    <input type="text" name="mytitle" size="55" maxlength="60" />
    <br /><br />
    <input type="submit" name="mysubmit" value="Submit Video for Approval" />
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:34:17.173

你的脚本看起来不错。请检查您的服务器配置。也许你超过了 POST 限制（用 php.ini 中的 post_max_size 设置）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T23:32:43.840

您必须使用[$_FILES](http://php.net/manual/en/reserved.variables.files.php)来访问上传的文件。

```
var_dump($_FILES); // Your uploaded files
var_dump($_POST);  // Your entered data 
```

# jsf-2 - Primefaces 和 Spring webflow ajax 动作调用

> ID：14115250
> 
> 赞同：1
> 
> 时间：2013-01-01T23:31:18.783
> 
> 标签：jsf-2, primefaces, spring-webflow

有什么方法可以在 p:selectOneMenu 的 primefaces 上调用 spring webflow 操作？

有两个依赖组合框，例如 primefaces 示例。（[链接](http://www.primefaces.org/showcase/ui/pprSelect.jsf)）但我想调用在 webflow 转换中定义的操作，因此我不能将 p:ajax 与 actionlistener 一起使用。

搜索后，我尝试使用 p:remoteCommand 调用动作。它在父组合更改时执行动作，但它也会给出验证码验证错误（验证码在同一表单），因此我将 process="@this" 设置为 p:remoteCommand，当我设置我无法执行操作时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T17:22:08.903

您应该使用 remoteCommand 来调用 SWF 操作。如果您只想提交某些组件的值，您可以使用 process="componentIds" 仅发送指定组件的值。您可能还希望 remoteCommand 上的 'immediate=true' 跳过 JSF 验证 - 这应该会阻止来自验证码验证的错误消息。

但是，根据我的经验，将 SWF 操作用于刷新相关组合框等任务并不是一个好主意。Primefaces 的部分渲染更适合这种情况，并且不需要像 SWF 标签这样的噱头。

如果 immediate=true 不起作用，请发布您的 XML。

# jquery - 根据单选按钮选择显示不同的表单字段

> ID：14115251
> 
> 赞同：0
> 
> 时间：2013-01-01T23:31:34.360
> 
> 标签：jquery, spring, jsp, spring-mvc

我正在尝试完成以下操作：我有一个用户将填写的表格，在表格之外（例如学生和老师）。

根据选择的单选框，我希望表单包含不同的字段。

For example, when Student is selected, the user would have to fill out the fields first name, last name and course name. 选择教师时，用户必须填写名字，姓氏和经验年份。

如您所见，有些字段是相同的。

我计划使用同一个 bean 来管理 2 种“类型”的用户（学生和教师）。我只会在我的数据库中有一个“类型”列来产生影响。

我不知道的是，我的控制器是否与此有关，或者我应该使用 JQuery 处理我的 JSP 中的所有内容？我不知道如何执行该操作以及最佳实践是什么。

此外，根据选择了组合框的哪个值，我需要在数据库中插入一个不同的“类型”值，正如我之前所说的，但是如何将组合框值从 JSP 获取到控制器？

这是我现在的 AddUserFormController：

```
@Controller
@RequestMapping("/register.htm")
public class AddUserFormController {

    @Autowired
    private UserDetailsService userDetailsService;

    @Autowired
    private UserEntityService userEntityService;

    public void setUserDetailsService(UserDetailsService userDetailsService) {
        this.userDetailsService = userDetailsService;
    }

    @RequestMapping(method = RequestMethod.POST)
    public String onSubmit(@ModelAttribute("userEntity") UserEntity user, BindingResult result)
            throws ServletException {
            ((UserEntityService) userEntityService).addUser(user);
            return "/home";
    }

    @RequestMapping(method = RequestMethod.GET)
    public String showAddForm(ModelMap model) {
        UserEntity user = new UserEntity();
        model.addAttribute(user);
        return "/register";
    }

    protected Object formBackingObject(HttpServletRequest request) throws ServletException {
        AddUser addUser = new AddUser();
        return addUser;
    }

    public UserDetailsServiceImpl getUserDetailsService() {
        return (UserDetailsServiceImpl) userDetailsService;
    }
} 
```

这是我的 JSP（我对其进行了简化，这里没有用户名和密码字段，以便在帖子中使用它）。现在有 3 个字段，名字、姓氏和课程名称（如果选择的组合框是“学生”，我想显示的字段）。我不知道在这里添加什么以及如何处理它，因此根据选择的组合框显示不同的字段：

```
<!DOCTYPE HTML>
<%@ include file="/WEB-INF/pages/include.jsp"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>

<html>
<head>
<title>Test</title>
</head>

<head>
<title>Register</title>

</head>
<body>
    <%@ include file="/WEB-INF/pages/menu.jsp"%>
    <div class="container">
        <form:form method="post" modelAttribute="userEntity">

            <label class="radio"> <input type="radio"
                name="optionsRadios" id="optionsRadios1" value="option1" checked>
                I am a Teacher
            </label>

            <label class="radio"> <input type="radio"
                name="optionsRadios" id="optionsRadios2" value="option2"> I
                am a Student
            </label>

            <table width="95%" bgcolor="f8f8ff" border="0" cellspacing="0"
                cellpadding="5">
                <tr>
                    <td align="right" width="20%">First Name</td>
                    <td width="20%"><form:input path="firstName" /></td>
                    <td width="60%"><form:errors path="firstName" cssClass="error" /></td>
                </tr>
                <tr>
                    <td align="right" width="20%">Last Name</td>
                    <td width="20%"><form:input path="lastName" /></td>
                    <td width="60%"><form:errors path="lastName" cssClass="error" /></td>
                </tr>
                <tr>
                    <td align="right" width="20%">Course Name</td>
                    <td width="20%"><form:input path="courseName" /></td>
                    <td width="60%"><form:errors path="courseName"
                            cssClass="error" /></td>
                </tr>
                <button type="submit" class="btn btn-success">Register</button>
        </form:form>
    </div>
</body>
</html> 
```

这是我的 Bean 也是简化的（我没有把用户名和密码属性放在这里以简化帖子）：

```
@Entity
@Table(name = "user", catalog = "test", schema = "")
public class UserEntity implements Serializable {

    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Basic(optional = false)
    @Column(name = "id")
    private Integer id;

    @Column(name = "first_name")
    private String firstName;

    @Column(name = "family_name")
    private String familyName;

    @Column(name = "course_name")
    private String course_name;

    @Column(name = "experience")
    private String experience;

    public UserEntity() {

    }

    public UserEntity(Integer id) {
        this.id = id;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getCourseName() {
        return course_name;
    }

    public void setCourseName(String course_name) {
        this.course_name = course_name;
    }

    public String getExperience() {
        return experience;
    }

    public void setExperience(String experience) {
        this.experience = experience;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T19:09:54.833

这里的解决方案是使用 Jquery 根据选中的单选按钮显示或隐藏必填字段。

这是一个显示此实现的[JSFIDDLE 。](http://jsfiddle.net/x7z7J/2/)处理这个问题的 Jquery 函数是

```
function showSpecificFields(obj){
   if($(obj).is(":checked")){
     var radioVal = $(obj).val();
     $(".fieldsSpecific").each(function(){
        if($(this).attr('id') == radioVal){
           $(this).show();
        } else{
           $(this).hide();                 
        }
     });   
   }
} 
```

它基本上使用包含要显示的字段`id`的标签检查所选单选按钮的值。`html`

我已经使用简单的 html 展示了这一点，但是使用表格来对齐表单元素并不是最好的主意。但是即使对于不同的 html 标签，Jquery 逻辑也很方便。

# python - Python：用于 Connect 4 的 Alpha Beta Minimax

> ID：14115253
> 
> 赞同：0
> 
> 时间：2013-01-01T23:31:47.713
> 
> 标签：python, alpha-beta-pruning

我正在尝试在 Python 中使用 minimax for Connect 4 作为个人项目来实现 AI。目前我有这个。

```
def alphaBeta(myBoard, column, depth, alpha, beta, player):
    parent = board()
    for r in range(ROWS):
        for c in range(COLUMNS):
            parent.board[r][c] = myBoard.board[r][c]
    parent.move(column, player)
    if parent.isFull() or parent.isWon()[0] or depth <= 0:
        if parent.isFull(): return 0
        if parent.isWon()[1] == player: return float('inf')
        elif parent.isWon()[0]: return -1*float('inf')
        else: return statScore(parent, player)
    if player == "O":
        for child in range(COLUMNS):
            alpha = max(alpha, alphaBeta(parent, child, depth-1, alpha, beta, "X"))
            if beta <= alpha:
                break
        return alpha
    else:
        for child in range(COLUMNS):
            beta = min(beta, alphaBeta(parent, child, depth-1, alpha, beta, "O"))
            if beta <= alpha:
                break
        return beta

def ai(myBoard, depth):
    output = []
    bestScore = float('inf')
    for column in range(COLUMNS):
        if myBoard.isValid(column):
            score = alphaBeta(myBoard, column, depth, -1*float('inf'), float('inf'), "O")
            if score < bestScore:
                output = [column]
                bestScore = score
            elif score == bestScore:
                output.append(column)
    move = random.choice(output)
    return move 
```

但是，由于某种原因，计算机不会做出获胜的举动。例如，给定这个棋盘，计算机应该在第 4 列进行游戏，从而获胜。但是，它实际上在第 3 列中播放。

```
 0 1 2 3 4 5 6
| | | | | | | |
| | | | | | | |
| | | | | | | |
| | | | |O| | |
| | |X|O|O| | |
|X|X|O|X|O|X|X|
---------------
 0 1 2 3 4 5 6 
```

# python - 创建带有时间戳的文件夹

> ID：14115254
> 
> 赞同：12
> 
> 时间：2013-01-01T23:32:23.683
> 
> 标签：python

目前正在使用以下代码创建文件，我想根据 cwd 中的时间戳创建一个目录，将目录位置保存到一个变量中，然后在新创建的目录中创建文件，有没有人知道如何可以这样做吗？

```
def filecreation(list, filename):
    #print "list"
    with open(filename, 'w') as d:
        d.writelines(list)

def main():
    list=['1','2']
    filecreation(list,"list.txt")

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-01T23:37:56.517

你的意思是，像这样的东西？

```
import os, datetime
mydir = os.path.join(os.getcwd(), datetime.datetime.now().strftime('%Y-%m-%d_%H-%M-%S'))
os.makedirs(mydir)
with open(os.path.join(mydir, 'filename.txt'), 'w') as d:
    pass # ... etc ... 
```

## 功能齐全

```
import errno
import os
from datetime import datetime

def filecreation(list, filename):
    mydir = os.path.join(
        os.getcwd(), 
        datetime.now().strftime('%Y-%m-%d_%H-%M-%S'))
    try:
        os.makedirs(mydir)
    except OSError as e:
        if e.errno != errno.EEXIST:
            raise  # This was not a "directory exist" error..
    with open(os.path.join(mydir, filename), 'w') as d:
        d.writelines(list) 
```

**更新：**检查`errno.EEXIST`常量而不是硬编码错误号

# treeview - 来自外部数据的 Dynatree 初始化不起作用

> ID：14115257
> 
> 赞同：1
> 
> 时间：2013-01-01T23:32:56.067
> 
> 标签：treeview, web2py, dynatree

第一次在堆栈溢出:-)。我一直在使用[Leo Outliner](http://webpages.charter.net/edreamleo/front.html)主要用于组织我的任务和写作，并且工作得很好，可以让我在复杂的主题上澄清我的想法，但我不能轻易地与其他人分享我的清晰，因为他们不使用 Leo。我已经制作了一个从 Leo 到 Dynatree 的小型导出脚本作为测试，它运行良好，所以我认为是时候使用 web2py + dynatree 创建一个 Web 大纲了。问题是 dynatree 仅适用于脚本内的静态数据，但尝试使用如下代码：

```
<script type="text/javascript">
$(function(){
    $("#tree").dynatree({
         // In real life we would call a URL on the server like this:
             //          initAjax: {
             //              url: "/getTopLevelNodesAsJson",
             //              data: { mode: "funnyMode" }
             //              },
        // .. but here we use a local file instead:
        initAjax: {
            url: "sample-data1.json"
            data: { mode: "all" }
            },
        onActivate: function(node) {
            $("#echoActive").text(node.data.title);
        },
        onDeactivate: function(node) {
            $("#echoActive").text("-");
        }
    });
}); 
```

加载 sample-data1.json 的部分不起作用，无论该文件是否存在并且具有适当的权限。我在这里搜索过：

[如何使用 MVC 通过 Ajax 加载 Dynatree](https://stackoverflow.com/questions/8609605/how-to-load-dynatree-via-ajax-using-mvc) [https://groups.google.com/forum/?fromgroups=#!msg/dynatree/kZqIO1zCTSU/HYTFe9O2docJ](https://groups.google.com/forum/?fromgroups=#!msg/dynatree/kZqIO1zCTSU/HYTFe9O2docJ)

和网络上的其他地方，但我找不到如何从外部数据启用此加载。我什至考虑过为 YUI 或 ExtJS 更改我的库。我现在使用[jstree](http://dev.s-cubism.com/plugin_jstree)在 web2py 上支持树，但是，与 dynatree、YUI 或 ExtJS 相比，JsTree 文档对新手不太友好。

任何指向解决方案的指针都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:30:12.483

文件在哪里？

最好将文件放在静态文件夹下

`web2py/applications/yourapp/static/sample-data1.json`

所以你需要告诉你的 Javascript 从静态文件夹中加载它。

```
initAjax: {
    url: "yourapp/static/sample-data1.json",
    data: { mode: "all" }} 
```

或者您可以动态创建网址

```
<script>

var url_to_sample_data = "{{=URL('static', 'sample-data1.json')}}";

.....

initAjax: {
            url: url_to_sample_data,
            data: { mode: "all" }
            }

.....

</script> 
```

# f# - F# 元组的扩展方法

> ID：14115260
> 
> 赞同：4
> 
> 时间：2013-01-01T23:33:35.113
> 
> 标签：f#

是否可以为 F# 元组编写扩展方法？例如，添加实例方法 .Item1 和 .Item2（如 System.Tuple）相当于为 2 元组调用 fst 和 snd？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T00:04:06.047

在 F# 中内部表示（2 元素）元组的`System.Tuple<'T1, 'T2>`类型实际上已经具有属性`Item1`和`Item2`，但是这些被 F# 编译器隐藏了。一种将扩展成员添加到元组的明显方法并不能解决问题，所以我不希望这会起作用（但可能有一些我不知道的解决方法）。

一般来说，我认为模式匹配比`Item1`,`Item2`等成员更可取（并且 C# 3.0 程序员在使用元组时经常要求模式匹配支持:-)）。

原因是模式匹配迫使你命名事物。比较这两个代码片段：

```
let (width, height) = tuple
width * height 
```

和使用属性的版本：

```
tuple.Item1 * tuple.Item2 
```

第二个有点短，但绝对不那么可读。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-15T02:18:18.843

不完美，但我正在使用它。[（我从http://www.fssnip.net/6V](http://www.fssnip.net/6V)借用了原始代码并添加了一些小修改。）

```
[<AutoOpen>]
module TupleExtensions =
  type System.Tuple with
    static member Item1(t) = let (x,_) = t in x
    static member Item1(t) = let (x,_,_) = t in x
    static member Item1(t) = let (x,_,_,_) = t in x
    static member Item1(t) = let (x,_,_,_,_) = t in x
    static member Item1(t) = let (x,_,_,_,_,_) = t in x
    static member Item1(t) = let (x,_,_,_,_,_,_) = t in x

    static member Item2(t) = let (_,x) = t in x
    static member Item2(t) = let (_,x,_) = t in x
    static member Item2(t) = let (_,x,_,_) = t in x
    static member Item2(t) = let (_,x,_,_,_) = t in x
    static member Item2(t) = let (_,x,_,_,_,_) = t in x
    static member Item2(t) = let (_,x,_,_,_,_,_) = t in x

    static member Item3(t) = let (_,_,x) = t in x
    static member Item3(t) = let (_,_,x,_) = t in x
    static member Item3(t) = let (_,_,x,_,_) = t in x
    static member Item3(t) = let (_,_,x,_,_,_) = t in x
    static member Item3(t) = let (_,_,x,_,_,_,_) = t in x

    static member Item4(t) = let (_,_,_,x) = t in x
    static member Item4(t) = let (_,_,_,x,_) = t in x
    static member Item4(t) = let (_,_,_,x,_,_) = t in x
    static member Item4(t) = let (_,_,_,x,_,_,_) = t in x

    static member Item5(t) = let (_,_,_,_,x) = t in x
    static member Item5(t) = let (_,_,_,_,x,_) = t in x
    static member Item5(t) = let (_,_,_,_,x,_,_) = t in x

    static member Item6(t) = let (_,_,_,_,_,x) = t in x
    static member Item6(t) = let (_,_,_,_,_,x,_) = t in x

    static member Item7(t) = let (_,_,_,_,_,_,x) = t in x 
```

如何使用它：

```
let t = (1, 2, 3)
let item1 = Tuple.Item1(t) 
```

这里定义的 Tuple.Item1 比 fst 有优势：它是多态的项目数。一旦我们使用这些扩展方法编写了使用 n 元组的函数，我们就可以将它扩展为 n+1 元组，而无需修改函数体。相反，我们必须修改参数类型声明。它更加轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:14:01.403

我认为，您要问的不是很实用的方式。您可以使用实例方法创建自己的类型，但同时您会丢失函数式编程的许多方面，例如模式匹配。

除此之外，DU似乎是要走的路：

```
type MyTuple<'T, 'U> =
    | MyTuple of 'T * 'U
    with
    member this.MyItem1 = match this with | MyTuple(x,y) -> x
    member this.MyItem2 = match this with | MyTuple(x,y) -> y

let x = MyTuple(42, "foo")
let y1 = x.MyItem1    // 42
let y2 = x.MyItem2    // "foo" 
```

正如@Tomas Petricek 指出的那样，您无法命名属性`Item1`，`Item2`因为它们已经存在于`System.Tuple<'T1, 'T2>`. 尝试这样做会导致错误：

> 错误 FS2014：写入二进制 [文件名] 时出现问题：类型 [...] 的 pass2 出错，错误：MyTuple`2 类型的 pass2 出错，错误：属性表中的重复条目 'Item1'

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T09:10:27.853

您还可以使用`fst`and`snd`函数来获取您想要的值（如果您真的想的话，显然可以为第三、第四等编写您自己的值）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-10T08:25:18.400

解决方法是使用 C# 样式扩展定义。

这将工作得很好：

```
open System.Runtime.CompilerServices

[<Extension>]
type TupleExtensions () = 
    [<Extension>] static member First((a,b)) = a
    [<Extension>] static member First((a,b,c)) = a

let x = (1,2).First()
let y = (1,2,3).First() 
```

但我同意通过方法访问元组的元素不是一个好主意，模式匹配是最好的方法。

# java - Java Swing 文本编辑器

> ID：14115263
> 
> 赞同：10
> 
> 时间：2013-01-01T23:33:52.800
> 
> 标签：java, swing, awt, text-editor, styledtext

> **可能重复：**
> [我应该使用哪些组件来构建 Java WYSIWYG HTML 编辑器](https://stackoverflow.com/questions/3156809/what-components-should-i-use-for-building-a-java-wysiwyg-html-editor)

我是Java编程的新手。我必须在 Swing/AWT 中做文本编辑器，对此我有一个问题。如何编辑一个选定的单词，例如更改其颜色？我应该使用哪个组件和哪些功能？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-02T06:28:43.717

对于 Java Swing 的初学者，请尽量让这个项目保持简单。要在同一个文档中显示多种颜色和多种尺寸，需要大量复杂的编码和渲染 html。

尽量只提供基本的复制、剪切、粘贴功能，因为它们更容易实现。

要提供这些功能，一个 JTextArea 就足够了。

尝试这个。这是一个非常简单的文本编辑器

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Document extends JFrame implements ActionListener
{
private JTextArea ta;
private int count;
private JMenuBar menuBar;
private JMenu fileM,editM,viewM;
private JScrollPane scpane;
private JMenuItem exitI,cutI,copyI,pasteI,selectI,saveI,loadI,statusI;
private String pad;
private JToolBar toolBar;
public Document()
{
    super("Document");
    setSize(600, 600);
    setLocationRelativeTo(null);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    Container pane = getContentPane();
    pane.setLayout(new BorderLayout());

    count = 0;
    pad = " ";
    ta = new JTextArea(); //textarea
    menuBar = new JMenuBar(); //menubar
    fileM = new JMenu("File"); //file menu
    editM = new JMenu("Edit"); //edit menu
    viewM = new JMenu("View"); //edit menu
    scpane = new JScrollPane(ta); //scrollpane  and add textarea to scrollpane
    exitI = new JMenuItem("Exit");
    cutI = new JMenuItem("Cut");
    copyI = new JMenuItem("Copy");
    pasteI = new JMenuItem("Paste");
    selectI = new JMenuItem("Select All"); //menuitems
    saveI = new JMenuItem("Save"); //menuitems
    loadI = new JMenuItem("Load"); //menuitems
    statusI = new JMenuItem("Status"); //menuitems
    toolBar = new JToolBar();

    ta.setLineWrap(true);
    ta.setWrapStyleWord(true);

    setJMenuBar(menuBar);
    menuBar.add(fileM);
    menuBar.add(editM);
    menuBar.add(viewM);

    fileM.add(saveI);
    fileM.add(loadI);
    fileM.add(exitI);

    editM.add(cutI);
    editM.add(copyI);
    editM.add(pasteI);        
    editM.add(selectI);

    viewM.add(statusI);

    saveI.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_S, ActionEvent.CTRL_MASK));
    loadI.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_L, ActionEvent.CTRL_MASK));
    cutI.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_X, ActionEvent.CTRL_MASK));
    copyI.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_C, ActionEvent.CTRL_MASK));
    pasteI.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_V, ActionEvent.CTRL_MASK));
    selectI.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_A, ActionEvent.CTRL_MASK));

    pane.add(scpane,BorderLayout.CENTER);
    pane.add(toolBar,BorderLayout.SOUTH);

    saveI.addActionListener(this);
    loadI.addActionListener(this);
    exitI.addActionListener(this);
    cutI.addActionListener(this);
    copyI.addActionListener(this);
    pasteI.addActionListener(this);
    selectI.addActionListener(this);
    statusI.addActionListener(this);

    setVisible(true);
}
public void actionPerformed(ActionEvent e) 
{
    JMenuItem choice = (JMenuItem) e.getSource();
    if (choice == saveI)
    {
        //not yet implmented
    }
    else if (choice == exitI)
        System.exit(0);
    else if (choice == cutI)
    {
        pad = ta.getSelectedText();
        ta.replaceRange("", ta.getSelectionStart(), ta.getSelectionEnd());
    }
    else if (choice == copyI)
        pad = ta.getSelectedText();
    else if (choice == pasteI)
        ta.insert(pad, ta.getCaretPosition());
    else if (choice == selectI)
        ta.selectAll();
    else if (e.getSource() == statusI)
    {
        //not yet implmented
    }
}
public static void main(String[] args) 
{
    new Document();
} 
```

# android - Horizo ntalScrollView 是否有 onScrollStop() 事件？

> ID：14115264
> 
> 赞同：1
> 
> 时间：2013-01-01T23:33:53.300
> 
> 标签：android

我有以下问题。我在 Horizo​​ntalScrollView 中放置了 30 多个图像。我通过在 Horizo​​ntalScrollView 中覆盖此方法来正确检测 onScroll()。问题是我只需要加载用户附近的那些图像，否则将会有太多的下载/内存等。因此，如果用户现在快速滚动，它将开始下载从滚动开始到滚动结束的所有内容。这可能是一百张图片，但在滚动结束时，它们只有 4 或 5 张图片。如何检测滚动停止？并用它来开始下载？

编辑：对于慢速滚动它很完美，但快速滚动是问题所在。如果滚动很慢，那么行为是完美的。

编辑：我正在做的是更新 onScroll 附近的任何图像，但 onScroll 似乎被多次调用，并且很难确定图像是否应该从 onScroll 内部更新。例如 x=50, xPrev=49, xPrev=50, x=51 等等，实际上每个像素变化都会调用 onScroll。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T08:27:48.627

您的图像在水平方向移动，您需要做的是找到移动图像的速度，并根据它加载图像或跳过它们，在 onScrollChanged 方法中获取当前时间，将其保存到变量中，并找到与旧时间的差异，如果距离即水平 x1 和 x2 的差异大于某个水平，例如屏幕宽度（用它进行实验），然后如果速度低于某个水平，则计算速度加载图像或以其他方式忽略，总是在空闲时加载图像，即当速度为零时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:48:52.747

无论如何都没有找到检测滚动结束但使用 CountDownTimer 似乎有效：

我还需要重写Horizo​​ntalScrollView 来添加一个回调IHorizo​​ntalScrollListener，它在Horizo​​ntalScrollView 的onScrollView 内部调用。viewGroupContainer 是 ImageViews 的容器 LinearLayout。滚动视图只能直接包含一个 ViewGroup，因此我将所有图像添加到视图组中。CountDownTimer 是在活动中维护的参考。

```
 hzScrollView.setScrollListener(new IHorizontalScrollListener(){

                @Override
                public void onScrollChanged(int l, int t, int oldl, int oldt) {
                    Log.i(TAG, "onScrollChanged to x="+l+" y="+t);
                    Log.i(TAG, "onScrollChanged from x="+oldl+ " y="+oldt);
                    if (scrollUpdateTimer == null)
                    {
                        scrollUpdateTimer = new CountDownTimer(30000, 1000){

                            @Override
                            public void onFinish() {

                                scrollUpdateTimerRunning = false;
                            }

                            @Override
                            public void onTick(long interval) {
                                Log.d(TAG, "onTick updateImageViews");
                                updateImageViews(hZScrollView, viewGroupContainer);
                            }};

                    }

                    if (scrollUpdateTimerRunning == false)
                    {
                        scrollUpdateTimerRunning = true;
                        scrollUpdateTimer.start();

                    }   

                }});
} 
```

# groovy - 从放置在战争中的 groovy jar 运行 Groovy CLI

> ID：14115265
> 
> 赞同：3
> 
> 时间：2013-01-01T23:33:56.293
> 
> 标签：groovy, jar, clojure, command-line-interface

我知道 Groovysh，但我需要知道是否可以直接从放置在部署的 war servlet 中的 groovy.jar 运行 groovy CLI（使用一个命令）。我可以简化问题。是否有可能像在 Clojure 中一样运行 Groovy CLI？

```
java -cp clojure-1.4.0.jar clojure.main 
```

CLI 出现在终端中。这就是clojure中的样子。我正在寻找将在终端中运行 groovy CLI 的一行命令（仅使用 groovy 库来运行它）。我在 javadoc 中寻找帮助，找到了应该有帮助的类，但不知道如何运行它。：F

[http://groovy.codehaus.org/api/groovy/lang/GroovyShell.html](http://groovy.codehaus.org/api/groovy/lang/GroovyShell.html)

（如果有人知道不符合所有标准的解决方案，也请回答。）

//编辑

看来需要groovy.jar、commons-cli.jar、antlr.jar、asm-util.jar和jline.jar。所以我在 WEB-INF/lib 目录下的 war 文件中添加了这些文件。也许制作我自己的 jar 是一个很好的解决方案，这个角色将是从其他 jar 调用 Groovy CLI，但现在的问题是，如何通过命令行运行放置在部署的 war 应用程序内的 WEB-INF/lib 目录中的 jar？

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:13:33.430

似乎 groovysh 依赖的库比可嵌入版本包含的更多。我设法通过使用以下命令做你想做的事：

```
$ java -classpath '*' org.codehaus.groovy.tools.shell.Main 
```

但是当前目录必须是所有 groovy 库所在的目录；即`$GROOVY_HOME/lib`：

```
$ cd $GROOVY_HOME/lib
$ java -classpath '*' org.codehaus.groovy.tools.shell.Main
Groovy Shell (2.0.6, JVM: 1.6.0_24)
Type 'help' or '\h' for help.
------------------------------------------------------------------------------
groovy:000> 
```

# c# - 使用 SelectedIndices 计算平均值

> ID：14115275
> 
> 赞同：1
> 
> 时间：2013-01-01T23:35:16.920
> 
> 标签：c#, sum, average, multi-select, selectedindexchanged

我的程序将坐标(double x,douule y) 读取到 ListBox 中，并且需要在使用 SelectedIndices 和 MultiExtended 选择它们后计算它们的平均值。问题是如何用每个多选刷新我的代码。如您所见，我将 SelectedIndices[0] 默认设置为 0。目前，我的程序只是将第一个坐标除以 selectedIndices 的数量进行平均。

如果您考虑任何改进我的代码的方法，我也想知道。

谢谢！

```
 private void button3_Click(object sender, EventArgs e)//Average
    {
        int[] selected = new int[] {points_List.SelectedIndices[0] };
        double sumX = 0, sumY = 0; ;
        foreach (int iIndex in selected)
        {
            sumX += points[iIndex].X;
            sumY += points[iIndex].Y;
        }
        averageX = (sumX) / (points_List.SelectedIndices.Count);
        averageY = (sumY) / (points_List.SelectedIndices.Count);
        label1.Text = "Average is: ";
        label1.Text += averageX.ToString();
        label1.Text += "   ";
        label1.Text += averageY.ToString();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:46:30.800

正确的代码将需要`SelectedIndices`通过`OfType<T>`或`Cast<T>`。此外，调用`ToArray`具体化结果以避免必须计算两次也很方便。

```
var selectedPoints = points_List.SelectedIndices.
    OfType<int>().
    Select(i => points[i]).
    ToArray();
var averageX = selectedPoints.Average(p => p.X);
var averageY = selectedPoints.Average(p => p.Y); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T21:22:08.097

最终解决方案，谢谢大家。

```
 {
        double averageX = 0, averageY = 0;
        var selectedPoints = from int i in pointsList.SelectedIndices select points[i];
        if (pointsList.SelectedIndices.Count == 0)
        {
            label1.Text = "Average is 0.000 0.000 ";//default text
            return;
        }
        averageX = selectedPoints.Average(p => p.X);
        averageY = selectedPoints.Average(p => p.Y);
        label1.Text = "Average X: ";
        label1.Text += averageX.ToString();
        label1.Text += "   Y:";
        label1.Text += averageY.ToString();
    } 
```

# javascript - 如果用户成功登录，弹出窗口关闭，然后“妈妈”网站转到链接

> ID：14115276
> 
> 赞同：0
> 
> 时间：2013-01-01T23:35:26.747
> 
> 标签：javascript, html, login, popup

我使用bravenet密码保护来保护我的页面，并且我希望，如果用户成功登录，弹出关闭并且弹出的页面来自于，例如google.com ...

所以我给你里脊形式的 html 代码，我能做的唯一的事情是帮助你：

```
<!DOCTYPE html>
<html>
<head>
</head>
<body>
<div style="text-align: left;padding-left:5px;"class="login">
<form action="http://pub49.bravenet.com/passwd/show.php" method="post">
<input type="hidden" name="usernum" value="4136972029" />
<div style="padding:3px; font: bold 24px arial;color:#00cccc;">Login</div>
<input style="color:#000000;" type="text" required title="Username required" placeholder="Username" data-icon="U"type="text" name="uname" size="15" maxlength="30" style="width: 100px">
<input style="color:#000000;" type="password" required title="Password required" placeholder="Password" data-icon="x"type="password" name="passwd" size="15" maxlength="30" style="text-aign:center;">
<div> <input type="submit" name="submit" value="Login" style="width: 235px;"> </div>
</form>
</div>
</body>
</html> 
```

[例子](http://aunabzzzolutionl.weebly.com/)

页面在弹出窗口中加载，这很糟糕：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T20:48:51.347

伙计们，我找到了解决方案，正如 JMax 所说[，](https://stackoverflow.com/questions/7552726/how-to-close-popup-and-redirect-a-page/7552782#7552782)我只是将代码放在提交按钮中，它完全有效：D 检查自己：[http ://aunabzzzolution.weebly.com/](http://aunabzzzolution.weebly.com/)

# typescript - 如何使用 Typescript 在函数中包含输出参数？

> ID：14115278
> 
> 赞同：40
> 
> 时间：2013-01-01T23:36:23.177
> 
> 标签：typescript

是否可以在使用 TypeScript 的函数中包含输出参数？类似于`Func1(string val1, int out k1, int out k2)`C# 中的东西。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-02T09:53:12.483

不是现在。

您可以返回一个可以包含多个属性的对象。

```
return { k1: 5, k2: 99 }; 
```

您可以将其与解构结合起来，使中间对象变得不可见......

```
function myFunction() {
    return { k1: 5, k2: 99 };
}

const { k1, k2 } = myFunction();

console.log(k1);
console.log(k2); 
```

您也可以使用元组实现相同的目的，但这非常易读。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T15:52:51.083

通常，您只返回一个具有多个属性的对象，其中一个包含您的函数。像这样的东西：

```
var foo = function (val1 : string){
    // do something

    return {
        k1: 22,
        k2: 33
    };
} 
```

你也可以让它实现一个接口，这样你就知道返回的对象是什么。

```
interface IFoo {
    (val1: string): INumbers;
}
interface INumbers {
    k1 : number;
    k2 : number;
}

var foo : IFoo = (val1 : string){
    // do something

    return {
        k1: 22,
        k2: 33
    };
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T12:34:31.337

打字稿通过“按值调用”传递所有参数。但是，如果参数是引用，则大多数情况下它的行为类似于“按引用调用”。您可以为原始类型编写包装类。这是一些代码：

```
var func=function(param:Str){
    param.str="modified";
}
class Str{
    str:string="unmodified";
}
var test:Str=new Str();
alert(test.str); //alerts "unmodified"
func(test);
alert(test.str); //alerts "modified" 
```

但是，您需要小心：

```
var func=function(param:Str){
    param=new Str("modified");
}
class Str{
    str:string;
    constructor(param:string){
        this.str=param;
    }
}

var test:Str=new Str("unmodified");
alert(test.str); //alerts "unmodified"
func(test);
alert(test.str); //alerts "unmodified" 
```

函数参数是“按值调用”传递的。因此，在函数体内，您正在使用引用的副本。此引用指向与您作为参数传递的引用相同的对象，因此您可以访问其成员并修改它们。但是，如果您将一个新对象分配给该引用，则所有进一步的更改都将应用于这个新对象。因此，上面的代码会打印两次未经修改。我认为 C# 也是这样工作的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-09T16:41:22.910

如果您真的非常想要一个输出参数，即使您可以返回一个对象或数组（作为临时元组对象），请查看 foo 和 foo 的调用站点...

```
function p(s) {
  document.body.appendChild(document.createTextNode(s));
  document.body.appendChild(document.createElement('BR'));
}
function foo(output: any): void {
  output.uno = 1;
  output.dos = 2;
}
var o: any = {};
function foo(o);
p(o.uno + " " + o.dos); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-01T07:33:09.963

有时参数未定义，您需要在方法中实例化它。在这种情况下，您可以使用“lambda 函数”或“箭头函数”并使用以下命令模拟输出参数：

例子：

```
class classA
{
   propertyA : number;
   constructor(value: number){
        propertyA = number;
   }
}

class classB {

    // ...

    exampleMethod(){
       let classAInstance: classA;
       this.sumValueMethod((p) => classAInstance = p, 10);

       if(classAInstance != undefined)
           alert("Yeah"); 
    }

    sumValueMethod(paramA:(p: classA) => any, paramB: number){

       let variableA: classA = new classA(0);
       variableA.propertyA += paramB;

       paramA(variableA);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-25T14:58:47.220

这是另一种方式。定义一个回调函数，其中将包含您的输出参数：

```
function Func1(val1: string, out: (k1: number, k2: number) => void): void {
    out(1, 2);
} 
```

如何使用它的示例：

```
function anotherFunction(): void {

    let k1: number;
    let k2: number;

    Func1("something", (v1, v2) => {
        k1 = v1;
        k2 = v2;
    });

    console.log(k1); // output: 1
    console.log(k2); // output: 2
} 
```

我发现它对这样的东西最有用：

```
const keys: string[] = [];
const values: number[] = [];

function tryGet(key: string, out: (value: number) => void): void {
    const index = keys.indexOf(key);
    if (index >= 0) {
        out(values[index]);
    }
}

function test(): void {

    const key = "myValue";

    tryGet(key, (value) => {
        console.log(`Key '${key}' exist with value ${value}`);
    });
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-01T05:32:34.157

如果你想保持类似 C# 的语法，你可以使用：

```
function func(val1, k1, k2)
{
    k1.v = 7;
    k2.v = 9;
    return "";
} 
```

并称之为

```
func("", {}, {}); 
```

# command-line - 从命令行将文件存储到filepicker.io？

> ID：14115280
> 
> 赞同：1
> 
> 时间：2013-01-01T23:36:33.317
> 
> 标签：command-line, automation, filepicker.io

我有一堆文件，我想将它们全部推送到文件选择器并使用各种转换选项来操作它们。

我如何自动化这个过程？有没有办法在javascript之外使用我可以从命令行运行的传统脚本语言来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T22:56:37.063

执行此操作的方法是将文件内容作为 POST 到 /api/store/S3。例如

```
curl -F fileUpload=@test.html 'https://www.filepicker.io/api/store/S3?key={{apikey}}&filename=myCoolFile.html' 
```

还有其他执行类似操作的工具，例如[https://github.com/uams/geturl](https://github.com/uams/geturl)，但它们使用的机制（发布到 /api/path/storage）已经过时。

总的来说，您可以使用此功能，但网址可能会更改。我们对 /api/store/[provider] 语法相当满意，但可能会在发布前更改

# ios - CGRectIntersectsRect 函数的框架

> ID：14115281
> 
> 赞同：0
> 
> 时间：2013-01-01T23:36:34.567
> 
> 标签：ios, cocoa-touch, cocos2d-iphone

嗨，我正在用 cocos2d 编写游戏并使用 ipad 5.0 模拟器。在编译时，我收到了这个链接错误，它说没有找到架构 i386 的 CGRectIntersectsRect 符号。我想我错过了摆脱这个错误的正确框架。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:38:20.233

> 我想我缺少正确的框架

对，您要链接的框架是 CoreGraphics。

请注意，您还必须正确

```
#import <CoreGraphics/CoreGraphics.h> 
```

为了内联函数工作/正确编译。

# java - Java 冲突不适用于 2D 游戏

> ID：14115284
> 
> 赞同：3
> 
> 时间：2013-01-01T23:37:33.383
> 
> 标签：java, collision

**介绍**

我过去曾就这个问题发表过一个帖子，在这个论坛上其他用户的帮助下花了很长时间修改我的代码后，我仍然在我开始的地方，所以我采取了不同的方法。

**我想做的事**

我不会要求你为我制作我的游戏，所以我没有为我的游戏发布所有代码，而是制作了一个非常相似且非常简单的游戏版本，它只有两个类，即 main 类和游戏类。我提供的简单代码是什么：有两个矩形和一个带有键盘输入的移动，就是这样，没有背景，没有图像，没有动画和很少的代码。

**我的问题/我的问题**

我在游戏中遇到的问题是碰撞，在这个例子中是两个矩形，我需要在我的游戏中添加一些代码来阻止一个矩形与另一个矩形相交，我看过很多教程，很多关于这个问题的指南但没有取得任何进展，我希望这个论坛的用户能帮助我解决这个问题。

**编码**

正如我上面提到的，这个游戏的代码很少，只有 2 个类，不需要其他任何东西，所以如果你需要，你可以简单地创建 2 个类（游戏和游戏）并在你的计算机上运行这个游戏。请注意，在使用此代码之前，您需要使用编译器设置 slick。

主类（游戏）

```
package javagame;

import org.newdawn.slick.*;
import org.newdawn.slick.state.*;

public class Game extends StateBasedGame{

    public static final String gamename = "Ham Blaster! 2.0";

    public static final int play = 1;

    public Game(String gamename){//create window on statup
        super(gamename);//adds title to screen
        this.addState(new Play(play));
    }

    public void initStatesList(GameContainer gc) throws SlickException{

        this.getState(play).init(gc, this);
        }

    public static void main(String[] args) {
        AppGameContainer appgc;//the window for your game
        try{
            appgc = new AppGameContainer(new Game(gamename));
            appgc.setDisplayMode(640, 360,false);
            appgc.start();
        }catch(SlickException e){
        e.printStackTrace();}
    }} 
```

游戏课

```
 package javagame;

import java.awt.Rectangle;

import org.newdawn.slick.Animation;
import org.newdawn.slick.GameContainer;
import org.newdawn.slick.Graphics;
import org.newdawn.slick.Image;
import org.newdawn.slick.Input;
import org.newdawn.slick.SlickException;
import org.newdawn.slick.state.BasicGameState;
import org.newdawn.slick.state.StateBasedGame;

public class Play extends BasicGameState{

    Animation bucky, movingUp, movingDown, movingLeft, movingRight;
    Image worldMap;
    boolean quit = false;//gives user to quit the game
    int[] duration = {200, 200};//how long frame stays up for
    int buckyPositionX = 0;
    int buckyPositionY = 0;
    int shiftX = buckyPositionX + 320;//keeps user in the middle of the screem
    int shiftY = buckyPositionY + 160;//the numbers are half of the screen size

    Rectangle rectOne = new Rectangle(shiftX, shiftY,90,90);
    Rectangle rectTwo = new Rectangle(500 + buckyPositionX, 330 + buckyPositionY, 210, 150);

    public Play(int state){
    }   
    public void init(GameContainer gc, StateBasedGame sbg) throws SlickException{
    }

    public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException{

    g.fillRect(shiftX, shiftY,90,90);
    g.fillRect(500 + buckyPositionX, 330 + buckyPositionY, 210, 150);
    }

    public void update(GameContainer gc, StateBasedGame sbg, int delta)throws SlickException{
    Input input = gc.getInput();

    //up
    if(input.isKeyDown(Input.KEY_UP)){buckyPositionY += 2;}

    //down
    if(input.isKeyDown(Input.KEY_DOWN)){buckyPositionY -= 2;}
    //left
    if(input.isKeyDown(Input.KEY_LEFT)){buckyPositionX += 2;}
    //right
    if(input.isKeyDown(Input.KEY_RIGHT)){buckyPositionX -= 2;}
}   

    public int getID(){
        return 1;
    }
} 
```

如果您需要任何其他信息，请告诉我，我会尽快回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T00:26:26.273

我对框架不是很熟悉，但我知道原始类型提供了一个 intersects() 方法来确定两个对象是否相互碰撞。您需要手动调用它或找到一些可以注册对象的组件，以便它为您完成。

# java - java中的事件处理，对于vb.net专家

> ID：14115289
> 
> 赞同：4
> 
> 时间：2013-01-01T23:38:38.927
> 
> 标签：java, events, event-handling

我发现了大量关于处理现有 java 类的事件的帖子，但没有关于从头开始创建带有事件的类。
这个 vb.net 片段的 java 翻译是什么？

```
Public Class TestClass
    Event TestEvent()
    Sub TestFunction()
        RaiseEvent TestEvent()
    End Sub
End Class
Public Class Form1
    Dim WithEvents TC As New TestClass
    Sub OnTestEvent() Handles TC.TestEvent
    End Sub
End Class 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:44:39.530

这是关于 Java 事件模型背后的“理论”的一个很好的链接：

*   [http://docs.oracle.com/javase/1.4.2/docs/guide/awt/1.3/designspec/events.html](http://docs.oracle.com/javase/1.4.2/docs/guide/awt/1.3/designspec/events.html)

这是一个链接，说明了如何创建自己的自定义事件：

*   [http://castever.wordpress.com/2008/07/31/how-to-create-your-own-events-in-java/](http://castever.wordpress.com/2008/07/31/how-to-create-your-own-events-in-java/)

这是来自[SO](https://stackoverflow.com/questions/6270132/create-a-custom-event-in-java)的一个非常好的例子：

```
// REFERENCE: https://stackoverflow.com/questions/6270132/create-a-custom-event-in-java
import java.util.*;

interface HelloListener {
    public void someoneSaidHello();
}

class Initiater {
    List<HelloListener> listeners = new ArrayList<HelloListener>();

    public void addListener(HelloListener toAdd) {
        listeners.add(toAdd);
    }

    public void sayHello() {
        System.out.println("Hello!!");

        // Notify everybody that may be interested.
        for (HelloListener hl : listeners)
            hl.someoneSaidHello();
    }
}

class Responder implements HelloListener {
    @Override
    public void someoneSaidHello() {
        System.out.println("Hello there...");
    }
}

class Test {
    public static void main(String[] args) {
        Initiater initiater = new Initiater();
        Responder responder = new Responder();

        initiater.addListener(responder);

        initiater.sayHello();
    }
} 
```

关键是：

1）创建一个定义你的“事件”的“接口”（比如AWT事件模型中的事件）

2）创建一个“实现”此事件的类（类似于 C 等语言中的“回调” - 并且有效地使用“事件”类型自动为您做 VB）。

'希望这会有所帮助......至少有一点点！

# iphone - XCode 4.5.2 开始在设备上运行应用程序需要很长时间

> ID：14115291
> 
> 赞同：0
> 
> 时间：2013-01-01T23:38:57.183
> 
> 标签：iphone, xcode, ipad

我开始注意到从 Xcode 在我的 iPhone 4S 上构建和运行应用程序需要几分钟（5-10 分钟）。我在我的 4S 上运行 XCode 4.5.2 和 iOS6.0 并决定找出问题所在。这里发布了另一个类似的问题，但没有明确的答案就关闭了。（这是一种耻辱，因为这对人们来说是一个有效的担忧。）我重新发布这个问题来解释我观察到的内容。希望它会帮助某人。

首先，在几次不耐烦地尝试安装一个相对较小的应用程序似乎挂起之后，我重新启动了我的 Mac。我尝试从我的 Mac 和 iPhone 中删除所有旧的配置文件，以为我遇到了过期证书/配置文件的问题。我又试了几次，决定让它挂起来看看会发生什么。大约 5-10 分钟后，它最终在我的设备上启动了该应用程序。我用谷歌搜索了一下，发现了一些提示，也许我应该尝试重新启动我的 iPhone 并与 iTunes 重新同步。（我已经进行了一次不成功的同步尝试，这似乎也需要很长时间。）在我下一次尝试同步时，我决定删除一些较大的应用程序（700+MB）以清理空间，因为我已经降到了我的最后一个 GB。

事情仍然很慢，所以我决定重新启动我的 iPhone，然后重新同步它。我重新启动手机并再次在 iTunes 中同步，这次同步很快。我已经清理了额外的 3+GB，留下了大约 4+GB 的可用空间。我重新启动了 XCode，我的应用程序现在正在快速安装。

我的结论是，我相信随着时间的推移，设备上可能会运行额外的守护进程，而重启我的手机最终有助于恢复安装时间。另外，我不确定清理空间是否有帮助。我想知道根本原因/解决方案是什么，但这取决于其他有类似经历和回应的人。

# ios - performSegueWithIdentifier 替换 detailViewController 有效，但没有调用 prepareForSegue

> ID：14115294
> 
> 赞同：1
> 
> 时间：2013-01-01T23:39:20.367
> 
> 标签：ios, uisplitviewcontroller, uistoryboardsegue

我有一个从 Xcode 4.5 的样板 Master-Detail 应用程序创建的应用程序，它打开了 CoreData、StoryBoards 和 ARC，它没有调用 prepareForSegue。CoreData 目前没有被使用，但它将用于缓存 XML 响应。performSegueWithIdentifier 有效，但 prepareForSegue 无效，我在将数据从 MasterViewController 传递/访问到 performSegueWithIdentifier 创建的 detailViewController 时遇到了麻烦。

我的基本设置类似于线程中讨论的内容：[Storyboards 和 UISplitViewControllers](http://www.raywenderlich.com/forums/viewtopic.php?f=2&t=1546 "故事板和 UISplitViewControllers")。第三页上有一个故事板的图像，与我的设置非常相似（我没有足够的代表来发布图像）。

简而言之：

1.  我创建了一个标准的 splitView 排列
2.  MasterViewController 构建主表
3.  每个单元格对应一个返回 XML 数据的 URL，该数据确定 detailView 中的内容
4.  使用 NSXMLParser 操作/类解析获取的 XML
5.  获取的 XML 确定需要哪个详细视图，并且 MasterViewController 调用适当的“替换”segue（通过 performSegueWithIdentifier）来启动相应的 detailViewController 以显示获取的 XML

我遇到的问题是没有调用 prepareForSegue，因此我无法将获取的 XML 传递给 detailViewController。

我需要的是以下之一：

*   prepareForSegue 被执行
*   一种在 handleLoadedResponse:notif 中了解 segue.destinationViewController 的方法
*   一种从 detailViewControllers 的 viewDidLoad 方法内部访问 MasterViewController 中的“currentResponse”变量的方法
*   一种通过 StoryBoardID 查找 MasterViewController 的方法

我试过的：

*   将 NSLog() 语句放在每个 viewController 的 prepareForSegue 中——没有一个被调用
*   挖掘 detailViewController 中的 self.parentViewController 链，找到调用 performSegueWithIdentifier 的 MasterViewController——我找不到我要查找的类变量
*   阅读我能找到的几乎所有“prepareForSegue not called”帖子——它们似乎都是由于我在代码/故事板中没有看到的一些编码/故事板错误

问题可能是我在打电话：

```
[self.navigationController performSegueWithIdentifier:@"theDesiredSegue" sender:self]; 
```

从 handleLoadedResponse:notif 回调内部，应用程序试图在我的解析对象中调用 prepareForSegue？

TIA

射线

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T11:24:34.827

好吧，这归结为盯着代码太久和/或新手。

在对我认为很明显的所有内容进行了三次检查之后，我认为唯一剩下的就是 segue 代码在 NSXMLParser 回调中的行为不正确，所以我切换了 handleLoadedResponse:notif 例程来存储解析的数据并发送-出通知。

在调试这些更改时，我意识到我的 segue 附加到了错误的对象上。它们实际上是附加到 navigationController 而不是我的 viewController。从视觉上看，事情看起来像 RWForums 第三页上的故事板[：Storyboards 和 UISplitViewControllers](http://www.raywenderlich.com/forums/viewtopic.php?f=2&t=1546)，但实际上并非如此。最终结果是，即使我的代码似乎在调用 performSegueWithIdentifier 并且应该调用它的 prepareForSegue 方法，但它实际上是在调用 navigationController 的 segue，因此正在调用 navigationController 继承的 prepareForSegue。

建议：确保在打开文档大纲的情况下重新检查 StoryBoard Editor 中的所有连接。

射线

# c++ - 根据 std::sort() 实现 qsort()

> ID：14115299
> 
> 赞同：0
> 
> 时间：2013-01-01T23:39:55.917
> 
> 标签：c++, algorithm, std, objective-c++, block

出于愚蠢的原因，我想编写一个具有以下签名的函数（其中`(^)`代表 Apple 对 C++ 的[“块”](http://en.wikipedia.org/wiki/Blocks_%28C_language_extension%29)扩展）：

```
extern "C" my_qsort_b(void *arr, size_t nelem, size_t eltsize, int (^)(const void *, const void *)); 
```

其中函数是根据 来实现的`std::sort`。（请注意，我不能使用`qsort`，因为它需要一个函数指针，而不是块指针；我不能使用`qsort_b`，因为我可能没有 Apple 的标准库。我不会接受涉及的答案`qsort_b`。）

是否可以使用 C++ 实现此功能`std::sort`？还是我必须从头开始编写自己的快速排序实现？

请提供工作代码。魔鬼在细节中；我不是在问“我该如何使用`std::sort`？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:27:17.050

要使用`std::sort`，您必须编写一个迭代器类和一个将块包装在仿函数对象中的类。自己实现快速排序似乎是一种更短的选择。

顺便说一句：该块应该返回 bool，而不是 void，对吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:11:33.987

从这个开始：

```
struct memblockref {
  void* location;
  size_t size;
  memblockref( void* loc, size_t s ):location(loc), size(s) {}
  memblockref& operator=( memblockref const& right ) {
    Assert( size == right.size );
    memcpy( location, right.location, std::min( size, right.size ));
    return *this;
  }
private:
  memblockref( memblockref const& ) = delete; // or leave unimplemented in C++03
  memblockref() = delete; // or leave unimplemented in C++03
}; 
```

然后使用[http://www.boost.org/doc/libs/1_52_0/libs/iterator/doc/iterator_facade.html](http://www.boost.org/doc/libs/1_52_0/libs/iterator/doc/iterator_facade.html)为您的内存缓冲区创建 memblockref 的迭代器。

然后将块转换为函数指针，或将其包装在 lambda 或仿函数中，然后调用`std::sort`，在此处调用基于块的比较`location`left 和 right 的字段`memblockref`。

您可能必须专攻`swap`或也必须专攻`iter_swap`，但也许不必。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-19T20:40:31.273

做到这一点比看起来应该的要难——尽管`std::sort`显然比 更强大`qsort`，但两者之间的阻抗不匹配足以使后者在前者方面的实施成为一项艰巨的任务。

尽管如此，还是可以做到的。这是用作主力的`my_qsort_b`（此处称为`block_qsort`）的工作实现。`std::sort`该代码改编自作为练习完成的实现`qsort`，`std::sort`并通过调用块进行了简单修改以进行比较。该代码经过测试可在 x86_64 Linux 上编译和使用 clang++ 3.3。

```
#include <algorithm>
#include <cstring>

struct Elem {
  char* location;
  size_t size;
  bool needs_deleting;
  Elem(char* location_, size_t size_):
    location(location_), size(size_), needs_deleting(false) {}
  Elem(const Elem& rhs): size(rhs.size) {
    location = new char[size];
    *this = rhs;
    needs_deleting = true;
  }
  Elem& operator=(const Elem& rhs) {
    memcpy(location, rhs.location, size);
    return *this;
  }
  ~Elem() {
    if (needs_deleting)
      delete[] location;
  }
};

struct Iter: public std::iterator<std::random_access_iterator_tag, Elem> {
  Elem elem;

  Iter(char* location, size_t size): elem(location, size) {}
  // Must define custom copy/assignment to avoid copying of iterators
  // making copies of elem.
  Iter(const Iter& rhs): elem(rhs.elem.location, rhs.elem.size) {}
  Iter& operator=(const Iter& rhs) {elem.location = rhs.elem.location; return *this;}

  char* adjust(ptrdiff_t offset) const {
    return elem.location + ptrdiff_t(elem.size) * offset;
  }

  // Operations required for random iterator.
  Iter operator+(ptrdiff_t diff) const {return Iter(adjust(diff), elem.size);}
  Iter operator-(ptrdiff_t diff) const {return Iter(adjust(-diff), elem.size);}
  ptrdiff_t operator-(const Iter& rhs) const {
    return (elem.location - rhs.elem.location) / ptrdiff_t(elem.size);
  }
  Iter& operator++() {elem.location=adjust(1); return *this;}
  Iter& operator--() {elem.location=adjust(-1); return *this;}
  Iter operator++(int) {Iter old = *this; ++*this; return old;}
  Iter operator--(int) {Iter old = *this; --*this; return old;}
  bool operator!=(const Iter& rhs) const {return elem.location != rhs.elem.location;}
  bool operator==(const Iter& rhs) const {return elem.location == rhs.elem.location;}
  bool operator<(const Iter& rhs) const {return elem.location < rhs.elem.location;}

  Elem& operator*() {return elem;}
};

struct Cmp_adaptor {
  typedef int (^Qsort_comparator)(const void*, const void*);
  Qsort_comparator cmp;
  Cmp_adaptor(Qsort_comparator cmp_) : cmp(cmp_) {}
  bool operator()(const Elem& a, const Elem& b) {
    return cmp(a.location, b.location) < 0;
  }
};

void block_qsort(void* base, size_t nmemb, size_t size,
                 int (^compar)(const void *, const void *))
{
  Iter begin = Iter(static_cast<char*>(base), size);
  std::sort(begin, begin + nmemb, Cmp_adaptor(compar));
} 
```

如果`block_qsort`需要从 C 调用，您可以声明它`extern "C"`，因为它在其接口中不使用 C++ 功能。要测试该功能，请编译并运行以下附加代码：

```
// test block_qsort

#include <iostream>
#include <cstring>

int main(int argc, char** argv)
{
  // sort argv[1..argc].
  block_qsort(argv + 1, argc - 1, sizeof (char*),
              ^int (const void* a, const void* b) {
                return strcmp(*(char**) a, *(char**) b);
              });
  for (++argv; *argv; argv++)
    std::cout << *argv << std::endl;
  return 0;
} 
```

# delphi - 组件编写 - 如何正确处理错误输入的对象检查器值？

> ID：14115301
> 
> 赞同：6
> 
> 时间：2013-01-01T23:40:35.633
> 
> 标签：delphi

快速的问题我找不到任何信息。

在我正在创建的一个组件上，我有一个整数类型的值。

我只需要允许在 Object Inspector 中输入的值介于 0-10 之间，超出此范围的任何内容都应显示一条消息，说明输入的值不合适，然后将焦点返回给 Delphi Object Inspector .

例子：

```
TMyComponent = class(TComponent)
private
  FRangeVal: Integer;
  procedure SetRangeVal(const Value: Integer);
public
  constructor Create(AOwner: TComponent); override;
  destructor Destroy; override;
published
  property RangeVal: Integer read FRangeVal write SetRangeVal default 0;
end;

...

procedure SetRangeVal(const Value: Integer);
var
  OldValue: Integer;
begin
  OldValue := Value;
  if (Value < 0) or (Value > 10) then
  begin
    MessageDlg('Please enter a value between 0-10', mtError, [mbOK], 0);
    // FRangeVal := OldValue; ?? revert to the last value that worked
    // return focus back to property in Inspector ??
  end 
  else
  begin
    if Value <> FRangeVal then
    begin
      FRangeVal := Value;
    end;
  end;
end; 
```

我是否需要提出某种我可能不知道的特殊内置异常？以上适用于我的消息框弹出，但对对象检查器中的罪魁祸首属性的关注丢失了，我必须重新单击它以再次更改值。如果输入的值不正确，我只想显示消息并返回焦点，以便快速输入新值。

PS，上面的代码是在网络浏览器中编写的，因此最初的问题显示我没有使用属性 RangeVal 的 setter SetRangeVal - 这只是一个打字错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-01T23:56:50.407

首先，如果您的属性只能包含 和 之间的值`0`，`10`请不要将其定义为模糊的整数属性；将其定义为具有已定义值范围的子类型：

```
type
  TMyComponentRangeValue = 0..10;

TMyComponent = class(TComponent)
private
  FRangeVal: TMyComponentRangeValue;
  procedure SetRangeVal(const Value: TMyComponentRangeValue);
public
  constructor Create(AOwner: TComponent); override;
  destructor Destroy; override;
published
  property RangeVal: TMyComponentRangeValue read FRangeVal 
    write SetRangeVal default 0;
end; 
```

现在，您可以让编译器和 IDE 处理允许值的检查，而无需自己做任何事情。（如果输入了无效值，IDE 将处理异常并恢复到先前的值。）

```
procedure TMyComponent.SetRangeValue(const Value: TMyComponentRangeValue);
begin
  if Value <> FRangeValue then
    FRangeValue := Value;
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T00:13:25.673

@KenWhite 回答了这个问题。
在无法处理定义自己的类型的情况下，您可以只引发错误而不是显示消息框。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T09:03:57.227

这是您更正的代码（使用 Setter 方法）和`Integer`类型。

您可以在静默或异常 Setter 之间进行选择：

```
{$DEFINE SILENT_SETTER}

TMyComponent = class(TComponent)
private
  FRangeVal: Integer;
  procedure SetRangeVal(const Value: Integer);
public
  constructor Create(AOwner: TComponent); override;
  destructor Destroy; override;
published
  property RangeVal: Integer read FRangeVal write SetRangeVal default 0;
end;

...

procedure SetRangeVal(const Value: Integer);
begin
  // Range Checking
  if (Value < 0) or (Value > 10) then
{$IFDEF SILENT_SETTER}
    Exit;
{$ELSEIF}
    raise Exception.Create('Value out of Range');
{$ENDIF}

  // Store if needed
  if Value <> FRangeVal then
    FRangeVal := Value;
end; 
```

# d - 比较包含 D 中的结构的关联数组时出现 object.Error

> ID：14115303
> 
> 赞同：1
> 
> 时间：2013-01-01T23:40:56.567
> 
> 标签：d

我正在尝试比较两个关联数组，每个数组都包含一些结构，以查看它们是否彼此相等，但出现错误，我不知道为什么。如果结构具有`opEquals`功能，就会发生这种情况。将传统（非关联）数组与相同类型的结构进行比较可以正常工作。这是一个说明问题的简单程序：

```
#! /usr/bin/rdmd
import std.stdio;

void main() {
    // outputs "true"
    writeln([Thing()] == [Thing()]);

    // throws an error
    writeln(["foo": Thing()] == ["foo": Thing()]);
}

struct Thing {
    /* This function needs to be defined to trigger the error but it doesn't
       seem to matter what I put in it. */
    bool opEquals(ref Thing other) {
        return true;
    }
} 
```

这是错误消息：

```
object.Error: TypeInfo.equals is not implemented
----------------
5   structAaTest                        0x0000000100003b20 const(pure nothrow @trusted bool function(const(void*), const(void*))) object.TypeInfo_Struct.equals + 64
6   structAaTest                        0x0000000100013a70 extern (C) int rt.aaA._aaEqual(TypeInfo, rt.aaA.AA, rt.aaA.AA).int _aaKeys_x(rt.aaA.aaA*) + 152
7   structAaTest                        0x00000001000139ad _aaEqual + 261
8   structAaTest                        0x0000000100000fbb _Dmain + 319
9   structAaTest                        0x00000001000151de extern (C) int rt.dmain2.main(int, char**).void runMain() + 34
10  structAaTest                        0x0000000100014b95 extern (C) int rt.dmain2.main(int, char**).void tryExec(scope void delegate()) + 45
11  structAaTest                        0x0000000100015228 extern (C) int rt.dmain2.main(int, char**).void runAll() + 56
12  structAaTest                        0x0000000100014b95 extern (C) int rt.dmain2.main(int, char**).void tryExec(scope void delegate()) + 45
13  structAaTest                        0x0000000100014b1f main + 235
14  structAaTest                        0x0000000100000e74 start + 52
15  ???                                 0x0000000000000001 0x0 + 1
---------------- 
```

我正在使用 DMD v2.060 和 OS X 10.6.8。

有谁知道为什么会发生这种情况，无论是预期的行为还是错误，以及如何处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:44:36.467

尝试将您的 opEquals 更改为 const 和 non-ref。

```
bool opEquals(Thing other) const {
     return true;
} 
```

我认为 dmd 最近对 opEquals 签名变得更加严格。

# asp.net-web-api - ReadAsMultipartAsync 不会接受 Type 参数

> ID：14115307
> 
> 赞同：1
> 
> 时间：2013-01-01T23:41:35.477
> 
> 标签：asp.net-web-api, azure-blob-storage

我在这里下载了一个通过 Web Api 服务将图像保存到 Azure Blob 存储的示例项目：http: [//blogs.msdn.com/b/yaohuang1/archive/2012/07/02/asp-net-web-api-and -azure-blob-storage.aspx](http://blogs.msdn.com/b/yaohuang1/archive/2012/07/02/asp-net-web-api-and-azure-blob-storage.aspx)。

但是，我无法让控制器中的这一行工作：

```
Request.Content.ReadAsMultipartAsync<AzureBlobStorageMultipartProvider>(multipartStreamProvider) 
```

错误是

> 非泛型方法 'System.Net.Http.HttpContentMultipartExtensions.ReadAsMultipartAsync(System.Net.Http.HttpContent, System.Net.Http.IMultipartStreamProvider, int)' 不能与类型参数一起使用

我试图将我的项目与示例项目进行比较，但无济于事 - 引用是相同的，AzureBlobStorageMultipartProvider 类在我的项目中没有改变......我不知道有什么区别。ReadAsMultiPartAsync 是一种扩展方法，但我显然在范围内有这些扩展（它们在错误消息中被引用）。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T20:15:09.687

好吧，即使两个项目中引用的 System.Net.Http.Formatting.dll 是 4.0.0.0 版，当我浏览到项目中 ReadAsMultiPartAsync 方法的定义时，元数据中也没有显示正确的方法。所以我在我的项目中删除了对 dll 的引用，然后从示例项目的 bin 中添加了 dll，这样就解决了问题。看起来真的很愚蠢，我担心它会再次损坏，但这是我拥有的最佳解决方案。

# c# - 如何将texture2D作为jpeg保存到文件中

> ID：14115309
> 
> 赞同：-1
> 
> 时间：2013-01-01T23:41:50.660
> 
> 标签：c#, xna

我正在尝试在一个纹理上绘制许多纹理来为 RTS 游戏创建地图，虽然我可以在屏幕上绘制单个纹理，但将它们全部绘制到渲染目标似乎没有效果（调试时窗口仍然是 AliceBlue ) . 我试图确定是否有任何东西被绘制到渲染目标，所以我试图将它作为 Jpeg 保存到文件中，然后从我的桌面查看该 Jpeg。如何从 MemoryStream 访问该 Jpeg？

受保护的覆盖 void LoadContent() {

```
 spriteBatch = new SpriteBatch(GraphicsDevice);
         gridImage = new RenderTarget2D(GraphicsDevice, 1000, 1000);
         GraphicsDevice.SetRenderTarget(gridImage);
         GraphicsDevice.Clear(Color.AliceBlue);
         spriteBatch.Begin();

         foreach (tile t in grid.tiles)
         {
             Texture2D dirt = Content.Load<Texture2D>(t.texture);
             spriteBatch.Draw(dirt, t.getVector2(), Color.White);
         }
         test = Content.Load<Texture2D>("dirt");

             GraphicsDevice.SetRenderTarget(null);
             MemoryStream memoryStream = new MemoryStream();

            gridImage.SaveAsJpeg(memoryStream, gridImage.Width, gridImage.Height); //Or SaveAsPng( memoryStream, texture.Width, texture.Height )

         //    rt.Dispose();
             spriteBatch.End();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:43:56.890

我做了一个简单的截图方法，

```
 void Screenie()
            {
                int width = GraphicsDevice.PresentationParameters.BackBufferWidth;
                int height = GraphicsDevice.PresentationParameters.BackBufferHeight;

                //Force a frame to be drawn (otherwise back buffer is empty) 
                Draw(new GameTime());

                //Pull the picture from the buffer 
                int[] backBuffer = new int[width * height];
                GraphicsDevice.GetBackBufferData(backBuffer);

                //Copy to texture
                Texture2D texture = new Texture2D(GraphicsDevice, width, height, false, GraphicsDevice.PresentationParameters.BackBufferFormat);
                texture.SetData(backBuffer);
                //Get a date for file name
                DateTime date = DateTime.Now; //Get the date for the file name
                Stream stream = File.Create(SCREENSHOT FOLDER + date.ToString("MM-dd-yy H;mm;ss") + ".png"); 

                //Save as PNG
                texture.SaveAsPng(stream, width, height);
                stream.Dispose();
                texture.Dispose();
            } 
```

另外，您是否正在加载 `Texture2D dirt = Content.Load<Texture2D>(t.texture);`每一帧？它看起来像......不要那样做！这将导致加载数百个图块的巨大延迟，每秒数百次！而是制作一个全局纹理`Texture2D DirtDexture`并在您的`LoadContent()`方法中执行`DirtTexture = Content.Load<Texture2D>(t.texture);` 现在绘制时您可以执行`spriteBatch.Draw(DirtTexture,...`

`spriteBatch = new SpriteBatch(GraphicsDevice);`和 _ `gridImage = new RenderTarget2D(GraphicsDevice, 1000, 1000);`

您不需要每帧都创建新的 RenderTarget 和 Spritebatch！只需在`Initialize()`方法中执行！

另请参阅[RenderTarget2D](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.rendertarget2d.aspx)和[XNA RenderTarget 示例](http://geekswithblogs.net/mikebmcl/archive/2011/02/18/xna-rendertarget2d-sample.aspx)有关使用渲染目标的更多信息

编辑：我意识到这一切都在 LoadContent 中，我没有看到因为格式被搞砸了，记得在你的 Draw Method 中添加你的 Foreach（Tile 等）

# php - 动态面包屑没有看到嵌套文件夹

> ID：14115311
> 
> 赞同：1
> 
> 时间：2013-01-01T23:42:18.150
> 
> 标签：php, dynamic, breadcrumbs

[*我将此处*](https://stackoverflow.com/a/2594624/1941676)找到的代码用于我的网站的动态 php 面包屑。效果很好！但是，如果我将文件夹嵌套超过 1 层，则会导致错误。

这是我目前用于面包屑的代码。

```
 <?php
    function breadcrumbs($separator = ' &raquo; ', $home = 'Home') {
        $path = array_filter(explode('/', parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH)));
        $base = ($_SERVER['HTTPS'] ? 'https' : 'http') . '://' . $_SERVER['HTTP_HOST'] . '/';
        $breadcrumbs = Array("<a href=\"$base\">$home</a>");
        $last = end(array_keys($path));
        foreach ($path AS $x => $crumb) {
            $title = ucwords(str_replace(Array('.php', '_'), Array('', ' '), $crumb));
            if ($x != $last)
                $breadcrumbs[] = "<a href=\"$base$crumb\">$title</a>";
            else
                $breadcrumbs[] = $title;
        }
        return implode($separator, $breadcrumbs);
     }
    ?>
    You are here: <?= breadcrumbs(' ♥ ') ?> 
```

最容易看到现场示例的地方是[*这里*](http://jmariemayer.zzl.org/pixel_art/contests/my_awards.php)。如果单击面包屑上的第三个链接，它将忽略第二个嵌套文件夹。我不知道足够多的 PHP 来解决问题以及如何解决它。我认为理想情况下它会监视 url 中的嵌套文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:50:10.583

您需要添加以前的碎屑以使其正常工作。这是一个修复：

```
<?php
function breadcrumbs($separator = ' &raquo; ', $home = 'Home') {
    $path = array_filter(explode('/', parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH)));
    $base = ($_SERVER['HTTPS'] ? 'https' : 'http') . '://' . $_SERVER['HTTP_HOST'] . '/';
    $breadcrumbs = Array("<a href=\"$base\">$home</a>");
    $last = end(array_keys($path));
    foreach ($path AS $x => $crumb) {
        $title = ucwords(str_replace(Array('.php', '_'), Array('', ' '), $crumb));
        if ($x != $last)
            $breadcrumbs[] = "<a href=\"$base$crumb\">$title</a>";
        else
            $breadcrumbs[] = $title;
        $base .= $crumb . '/';
    }
    return implode($separator, $breadcrumbs);
 }
?>
You are here: <?= breadcrumbs(' ♥ ') ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T23:51:08.703

那是因为您只是链接到当前的“面包屑”`$base$crumb`

因为您需要在构建链接时跟踪路径

```
foreach ($path AS $x => $crumb) {
            $base .= $crumb.'/';   // <- keep adding crumbs to current path
            $title = ucwords(str_replace(Array('.php', '_'), Array('', ' '), $crumb));
            if ($x != $last)
                $breadcrumbs[] = "<a href=\"$base\">$title</a>";  //<- link to current path
            else
                $breadcrumbs[] = $title;
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T23:54:05.210

假设你的脚本运行良好，我看到你有`open_basedir restriction in effect`，所以如果你在 apache 上，你必须把它添加到你的 httpd.conf

```
<Directory /var/www/vhosts/domain.tld/httpdocs>
 php_admin_value open_basedir none
 </Directory> 
```

如果脚本导致问题，请尝试已经给出的答案之一

# c++ - 如何在 OSX lion 上使用 clang 3.2 编译 C++11？

> ID：14115314
> 
> 赞同：24
> 
> 时间：2013-01-01T23:42:37.800
> 
> 标签：c++, macos, c++11, clang

我正在尝试编译以下依赖于 C++11`<thread>`标头的 C++ 程序。我正在尝试在 OSX Lion 上执行此操作。

```
#include <iostream>
#include <thread>
#include <vector>

void hello()
{
    std::cout << "Hello from thread " << std::this_thread::get_id() << std::endl;
}

int main()
{
    std::vector<std::thread> threads;

    for(int i = 0; i < 5; i++)
    {
        threads.push_back(std::thread(hello));
    }

    for(auto& thread: threads)
    {
        thread.join();
    }

    return 0;
} 
```

上面的程序用我使用自制包管理器安装的 g++ 4.7 编译得很好。但是，当尝试使用 clang 3.2（也使用自制软件包管理器安装）编译上述程序时，我收到以下错误消息：

```
Zameers-MacBook-Air:tmp zmanji$ clang++ -v -std=c++11 test.cpp 
clang version 3.2 (tags/RELEASE_32/final)
Target: x86_64-apple-darwin11.3.0
Thread model: posix
 "/usr/local/Cellar/llvm/3.2/bin/clang" -cc1 -triple x86_64-apple-macosx10.7.0 -emit-obj -mrelax-all -disable-free -main-file-name test.cpp -mrelocation-model pic -pic-level 2 -mdisable-fp-elim -masm-verbose -munwind-tables -target-cpu core2 -target-linker-version 128.2 -v -resource-dir /usr/local/Cellar/llvm/3.2/bin/../lib/clang/3.2 -fmodule-cache-path /var/folders/qf/j_7_sw0n093gn1y0mtsyztxh0000gn/T/clang-module-cache -std=c++11 -fdeprecated-macro -fdebug-compilation-dir /Users/zmanji/tmp -ferror-limit 19 -fmessage-length 101 -stack-protector 1 -mstackrealign -fblocks -fobjc-runtime=macosx-10.7.0 -fobjc-dispatch-method=mixed -fobjc-default-synthesize-properties -fencode-extended-block-signature -fcxx-exceptions -fexceptions -fdiagnostics-show-option -fcolor-diagnostics -o /var/folders/qf/j_7_sw0n093gn1y0mtsyztxh0000gn/T/test-Zkjucl.o -x c++ test.cpp
clang -cc1 version 3.2 based upon LLVM 3.2svn default target x86_64-apple-darwin11.3.0
ignoring nonexistent directory "/usr/include/c++/4.2.1/i686-apple-darwin10/x86_64"
ignoring nonexistent directory "/usr/include/c++/4.0.0"
ignoring nonexistent directory "/usr/include/c++/4.0.0/i686-apple-darwin8/"
ignoring nonexistent directory "/usr/include/c++/4.0.0/backward"
#include "..." search starts here:
#include <...> search starts here:
 /usr/include/c++/4.2.1
 /usr/include/c++/4.2.1/backward
 /usr/local/include
 /usr/local/Cellar/llvm/3.2/bin/../lib/clang/3.2/include
 /usr/include
 /System/Library/Frameworks (framework directory)
 /Library/Frameworks (framework directory)
End of search list.
test.cpp:2:10: fatal error: 'thread' file not found
#include <thread>
         ^
1 error generated. 
```

似乎clang找不到`<thread>`标题，但我不知道为什么。

**编辑：** 我在下面尝试了 sharth 的答案，现在我收到`<iostream>`标题不存在的错误。

```
Zameers-MacBook-Air:tmp zmanji$ clang++ -v -std=c++11 -stdlib=libc++ test.cpp 
clang version 3.2 (tags/RELEASE_32/final)
Target: x86_64-apple-darwin11.3.0
Thread model: posix
 "/usr/local/Cellar/llvm/3.2/bin/clang" -cc1 -triple x86_64-apple-macosx10.7.0 -emit-obj -mrelax-all -disable-free -main-file-name test.cpp -mrelocation-model pic -pic-level 2 -mdisable-fp-elim -masm-verbose -munwind-tables -target-cpu core2 -target-linker-version 128.2 -v -resource-dir /usr/local/Cellar/llvm/3.2/bin/../lib/clang/3.2 -fmodule-cache-path /var/folders/qf/j_7_sw0n093gn1y0mtsyztxh0000gn/T/clang-module-cache -stdlib=libc++ -std=c++11 -fdeprecated-macro -fdebug-compilation-dir /Users/zmanji/tmp -ferror-limit 19 -fmessage-length 203 -stack-protector 1 -mstackrealign -fblocks -fobjc-runtime=macosx-10.7.0 -fobjc-dispatch-method=mixed -fobjc-default-synthesize-properties -fencode-extended-block-signature -fcxx-exceptions -fexceptions -fdiagnostics-show-option -fcolor-diagnostics -o /var/folders/qf/j_7_sw0n093gn1y0mtsyztxh0000gn/T/test-k2Alf4.o -x c++ test.cpp
clang -cc1 version 3.2 based upon LLVM 3.2svn default target x86_64-apple-darwin11.3.0
ignoring nonexistent directory "/usr/local/Cellar/llvm/3.2/bin/../lib/c++/v1"
ignoring nonexistent directory "/usr/include/c++/v1"
#include "..." search starts here:
#include <...> search starts here:
 /usr/local/include
 /usr/local/Cellar/llvm/3.2/bin/../lib/clang/3.2/include
 /usr/include
 /System/Library/Frameworks (framework directory)
 /Library/Frameworks (framework directory)
End of search list.
test.cpp:1:10: fatal error: 'iostream' file not found
#include <iostream>
         ^
1 error generated. 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-01-01T23:49:42.020

您需要使用[libc++](http://libcxx.llvm.org/)而不是[libstdc++](http://gcc.gnu.org/libstdc++/)。

```
clang++ -std=c++11 -stdlib=libc++ foo.cc 
```

# c - C 编程文件大小

> ID：14115316
> 
> 赞同：0
> 
> 时间：2013-01-01T23:42:54.807
> 
> 标签：c, file, filesize

我试图在创建文件并向其写入数据后获取文件的大小。我得到的值似乎与实际文件大小不符。这是我的程序。请告诉我如何以位、字节、千字节和兆字节显示文件大小。根据我的说法，文件大小应该是 288 位、36 字节、0.03515626 千字节和 0.000034332 兆字节。

```
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <unistd.h>
#include <sys/stat.h> 
#include <sys/types.h> 
#define PERMS 0777

int main(int argc, char *argv[])
{
    int createDescriptor;
    int openDescriptor;

    char fileName[15]="Filename1.txt";
    umask(0000);

    if ((openDescriptor = creat(fileName, PERMS )) == -1)
    {
        printf("Error creating %s", fileName);
        exit(EXIT_FAILURE);
    }

    if(write(openDescriptor,"This will be output to testfile.txt\n",36 ) != 36)
    {
        write(2,"There was an error writing to testfile.txt\n",43);
        return 1;
    }

    if((close(openDescriptor))==-1)
    {
        write(2, "Error closing file.\n", 19);
    }
    struct stat buf;
    fstat(openDescriptor, &buf);
    int size=buf.st_size;
    printf("%d\n",size);
    printf("%u\n",size);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T23:52:33.400

该`fstat()`函数有一个返回码，**检查它。**

```
int r = fstat(openDescriptor, &buf);
if (r) {
    fprintf(stderr, "error: fstat: %s\n", strerror(errno));
    exit(1);
} 
```

这将打印：

```
错误：fstat：错误的文件描述符

```

是的...您关闭了文件描述符，它不再是文件描述符。你必须`fstat()`在调用之前`close()`。

## 代码让我担心。

这是非常脆弱的，在任何情况下都不推荐：

```
if (write(openDescriptor,"This will be output to testfile.txt\n",36 ) != 36) 
```

你可以这样做：

```
const char *str = "This will be output to testfile.txt\n";
if (write(fd, str, strlen(str)) != strlen(str)) 
```

它将编译为相同的机器代码，并且显然是正确的（与原始代码相反，您必须计算字符串中的字符数才能确定它是否正确）。

更好的是，当您使用 时`stderr`，只需使用标准`<stdio.h>`函数：

```
fprintf(stderr, "There was an error writing to %s: %s\n",
        fileName, strerror(errno)); 
```

定义时出现相同的错误`fileName`...

```
// You should never have to know how to count higher than 4 to figure
// out if code is correct...
char fileName[15]="Filename1.txt";

// Do this instead...
static const char fileName[] = "Filename1.txt"; 
```

这次你实际上算错了，`[15]`应该是`[14]`，但最好把它留给编译器。使编译器的工作更容易没有任何好处，因为编译器可能没有更好的事情要做。

## 关于机器码：

```
$ 猫 teststr.c
#include <unistd.h>
无效函数（int openDescriptor）{
    write(openDescriptor,"这将输出到 testfile.txt\n",36 );
}
$ 猫 teststr2.c
#include <string.h>
#include <unistd.h>
无效函数（int openDescriptor）{
    const char *str = "这将被输出到 testfile.txt\n";
    写（openDescriptor，str，strlen（str））；
}
$ cc -S -O2 teststr.c
$ cc -S -O2 teststr2.c
$ diff teststr.s teststr2.s
1c1
< .file "teststr.c"
---
> .file "teststr2.c"

```

是的。如图所示，调用`strlen()`实际上并不会产生不同的机器代码。

# python - 创建 Django 模型或更新（如果存在）

> ID：14115318
> 
> 赞同：152
> 
> 时间：2013-01-01T23:43:22.620
> 
> 标签：python, django, django-models

我想创建一个模型对象，比如 Person，如果人的 id 不存在，或者我会得到那个人对象。

创建新人的代码如下：

```
class Person(models.Model):
    identifier = models.CharField(max_length = 10)
    name = models.CharField(max_length = 20)
    objects = PersonManager()

class PersonManager(models.Manager):
    def create_person(self, identifier):
        person = self.create(identifier = identifier)
        return person 
```

但我不知道在哪里检查和获取现有的 person 对象。

* * *

## 回答 #1

> 赞同：247
> 
> 时间：2014-10-09T19:52:49.040

目前尚不清楚您的问题是要求[get_or_create](https://docs.djangoproject.com/en/stable/ref/models/querysets/#get-or-create)方法（至少可从 Django 1.3 获得）还是[update_or_create](https://docs.djangoproject.com/en/stable/ref/models/querysets/#update-or-create)方法（Django 1.7 中的新方法）。这取决于您要如何更新用户对象。

样品使用如下：

```
# In both cases, the call will get a person object with matching
# identifier or create one if none exists; if a person is created,
# it will be created with name equal to the value in `name`.

# In this case, if the Person already exists, its existing name is preserved
person, created = Person.objects.get_or_create(
        identifier=identifier, defaults={"name": name}
)

# In this case, if the Person already exists, its name is updated
person, created = Person.objects.update_or_create(
        identifier=identifier, defaults={"name": name}
) 
```

* * *

## 回答 #2

> 赞同：196
> 
> 时间：2013-01-01T23:46:07.120

如果您正在寻找“如果存在则更新”用例，请参阅[@Zags 出色的答案](https://stackoverflow.com/a/26286864/2800876)

* * *

Django 已经有一个`get_or_create`，[https://docs.djangoproject.com/en/dev/ref/models/querysets/#get-or-create](https://docs.djangoproject.com/en/dev/ref/models/querysets/#get-or-create)

对你来说可能是：

```
id = 'some identifier'
person, created = Person.objects.get_or_create(identifier=id)

if created:
   # means you have created a new person
else:
   # person just refers to the existing one 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-01T23:48:01.757

Django 对此有支持，请检查[get_or_create](https://docs.djangoproject.com/en/dev/ref/models/querysets/#get-or-create)

```
person, created = Person.objects.get_or_create(name='abc')
if created:
    # A new person object created
else:
    # person object already exists 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-11-15T13:25:28.160

**update_or_create**仅适用于少量对象，但如果您正在处理大型集合，则它不会很好地扩展。**update_or_create**总是先运行 SELECT，然后运行 ​​UPDATE。

```
for the_bar in bars:
    updated_rows = SomeModel.objects.filter(bar=the_bar).update(foo=100)
        if not updated_rows:
            # if not exists, create new
            SomeModel.objects.create(bar=the_bar, foo=100) 
```

这充其量只会运行第一个更新查询，并且只有当它匹配零行时才会运行另一个 INSERT 查询。如果您希望大多数行实际存在，这将大大提高您的性能。

不过，这一切都取决于您的用例。如果您期望主要是插入，那么也许[bulk_create()](https://docs.djangoproject.com/en/2.1/ref/models/querysets/#bulk-create)命令可能是一个选项。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-06-24T08:57:49.147

我想我会添加一个答案，因为您的问题标题看起来像是在询问如何创建或更新，而不是按照问题正文中的描述获取或创建。

如果您确实想要创建或更新对象，则 .save() 方法默认情况下已经具有此行为，来自[文档](https://docs.djangoproject.com/en/dev/ref/models/instances/#how-django-knows-to-update-vs-insert)：

> Django 抽象了使用 INSERT 或 UPDATE SQL 语句的需要。具体来说，当你调用 save() 时，Django 遵循这个算法：
> 
> 如果对象的主键属性设置为计算结果为 True 的值（即，非 None 或空字符串的值），Django 执行 UPDATE。如果对象的主键属性没有设置或者 UPDATE 没有更新任何东西，Django 执行一个 INSERT。

值得注意的是，当他们说“如果 UPDATE 没有更新任何内容”时，他们实质上是指您提供给对象的 id 不存在于数据库中的情况。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-12-17T23:49:34.020

您也可以像 get_or_create 一样使用 update_or_create ，这是我为 update_or_create 遵循的模式，假设模型 Person 具有 id（键）、name、age、is_manager 作为属性 -

```
update_values = {"is_manager": False}
new_values = {"name": "Bob", "age": 25, "is_manager":True}

obj, created = Person.objects.update_or_create(identifier='id',
                                               defaults=update_values)
if created:
    obj.update(**new_values) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-03T11:01:04.353

如果您创建时的输入之一是主键，这就足够了：

```
Person.objects.get_or_create(id=1) 
```

如果存在，它将自动更新，因为不允许具有相同主键的两个数据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-03T00:22:00.030

这应该是您正在寻找的答案

```
EmployeeInfo.objects.update_or_create(
    #id or any primary key:value to search for
    identifier=your_id, 
    #if found update with the following or save/create if not found
    defaults={'name':'your_name'}
) 
```

# javascript - 如何将用户创建的 HTML 发送到 W3C 验证器进行自动检查——没有跨域错误？

> ID：14115320
> 
> 赞同：1
> 
> 时间：2013-01-01T23:43:32.860
> 
> 标签：javascript, jquery, html, cross-domain, w3c-validation

我正在为用户编写一个应用程序，他们在其中将有效的 HTML 输入到文本字段中。

我在 jQuery 中有一个按钮，它尝试将文本字段区域加载到 W3C 验证器中：

```
$('#inspecthtml').on('click', function() {
             var storyhtml = $('#story').text();
             validatorurl= "http://validator.w3.org/#validate_by_input";
             var newWin = open(validatorurl,'Validator','height=600,width=600');
             newWin.onload = function() {
                 newWin.document.getElementById("fragment").value=storyhtml;
             }           
    }); 
```

我在控制台中收到一条错误消息（使用 Chrome）：

> 不安全的 JavaScript 尝试使用 URL [http://api.flattr.com/button/view/?url=http%3A%2F%2Fvalidator.w3.org%2F&title=View%20W3C-Validator%20on%20flattr.com&](http://api.flattr.com/button/view/?url=http%3A%2F%2Fvalidator.w3.org%2F&title=View%20W3C-Validator%20on%20flattr.com&)访问框架 来自带有 URL [http://validator.w3.org/#validate_by_input](http://validator.w3.org/#validate_by_input)的框架。被访问的框架将“document.domain”设置为“flattr.com”，但请求访问的框架没有。两者都必须将“document.domain”设置为相同的值才能允许访问。

我将此归因于跨域安全性（请参阅[Unsafe JavaScript attempt to access frame with URL](https://stackoverflow.com/questions/4324108/unsafe-javascript-attempt-to-access-frame-with-url)）

我的问题：有没有办法将数据发送到验证器，以便我的用户可以检查他们自己的标记？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-13T09:12:44.990

我认为下面的代码片段会让您获得与您所追求的相同的效果和用户体验。

它是使用 jQuery 编写的`$.ajax(…)`，`DOMParser`并`document.write(…)`以您想要的方式将 W3C HTML Checker 的样式化结果和 UI 放入新窗口中。

```
var validator_baseurl= "https://validator.w3.org/nu/";
var validator_requesturl = validator_baseurl
    + "?showsource=yes&showoutline=yes";
$.ajax({
    url: validator_requesturl,
    type: "POST",
    crossDomain: true,
    data: storyhtml,
    contentType: "text/html;charset=utf-8",
    dataType: "html",
    success: function (response) {
        var results = (new DOMParser()).parseFromString(response, "text/html");
        results.querySelector("link[rel=stylesheet]").href
            = validator_baseurl + "style.css";
        results.querySelector("script").src
            = validator_baseurl + "script.js";
        results.querySelector("form").action
            = validator_requesturl;
        var newWin = window.open("about:blank",
            "Checker results", "height=825,width=700");
        newWin.document.open();
        newWin.document.write(results.documentElement.outerHTML);
        newWin.document.close();
        newWin.location.hash = "#textarea";
        setTimeout(function() {
            newWin.document.querySelector("textarea").rows = "5";
        }, 1000)
    }
}); 
```

* * *

### 解释

*   导致将 POST 请求发送到[W3C HTML 检查器](https://validator.w3.org/nu/)
*   使`storyhtml`文本成为 POST 正文
*   使`text/html;charset=utf-8`POST 主体的媒体类型（检查器所期望的）
*   使检查器实际`storyhtml`自动检查内容
*   在第一次打开时在一个新窗口中显示检查器结果，一步（因此您的用户无需执行第二步手动提交它以进行检查）
*   用绝对 URL 替换检查器前端 CSS+JS 的相对 URL（否则在这个“独立窗口”上下文中，CSS 不会被应用，脚本也不会运行）
*   `newWin.location.hash = "#textarea"`需要使检查器显示文本区域

* * *

### 笔记

*   有意使用当前的[W3C HTML 检查器](https://validator.w3.org/nu/)（而不是旧的 W3C 标记验证器）

*   故意将要检查的内容作为 POST 正文发送，而不是`multipart/form-data`)；检查器支持`multipart/form-data`但使其成为 POST 主体更容易更好

*   该`setTimeout` `textarea`位不是必需的；我只是把它放在不滚动的情况下使结果可见（文本区域下方新窗口的底部）；如果你愿意，你当然可以删除它

*   将新窗口的高度和宽度设置为比问题原始代码中的 600x600 大一点；再一次，我这样做只是为了让事情更容易看到；随心所欲地改变它们

*   使用可能有更好的 jQuery 方法/习惯用法的标准 DOM 操作（我通常不使用 jQuery，所以我可以想象有一些方法可以进一步简化 JQuery 中的代码）

*   当然也可以完全不使用 jQuery 来完成——使用标准的[Fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch)或 XHR（如果需要，我很乐意在此处添加使用 Fetch 和 XHR 的示例）

*   tested & works as expected in Edge, Firefox, Chrome & Safari; but as with any code that uses `document.open`, Safari users need to unset *Preferences > Security > Block pop-up windows*

# sql - 续集——我可以在连接中给子查询起别名吗？

> ID：14115325
> 
> 赞同：8
> 
> 时间：2013-01-01T23:44:17.970
> 
> 标签：sql, ruby, join, subquery, sequel

使用[Sequel](http://sequel.rubyforge.org/)我想将两个共享一些列名的子查询连接在一起，然后在选择中对这些列进行表限定。

如果两个数据集只是表，我了解如何执行此操作。例如，如果我有一个`users`表和一个`items`表，其中包含属于用户的项目，并且我想列出项目的名称及其所有者的名称：

```
@db[:items].join(:users, :id => :user_id).
  select{[items__name, users__name.as(user_name)]} 
```

生产

```
SELECT "items"."name", "users"."name" AS "user_name" 
  FROM "items" 
INNER JOIN "users" ON ("users"."id" = "items"."user_id") 
```

如预期的。

但是，如果我要加入两个表示子查询的任意数据集（调用它们`my_items`和`my_users`） ，我不确定如何执行此操作

语法可能采用以下形式

```
my_items.join(my_users, :id => :user_id).
  select{[ ... , ... ]} 
```

我将提供合格的列名来访问`my_users.name`和`my_items.name`. 执行此操作的适当语法是什么？

部分解决方案是`t1__name`用于第一个参数，因为提供给连接的数据集似乎使用 , 等别名`t1`。`t2`但这并不能帮助我限定项目名称，我需要提供给第二个参数。

我认为最理想的解决方案将使我能够为连接中的数据集提供别名，例如如下所示（当然，由于多种原因这不起作用）

```
my_items.as(alias1).join(my_users.as(alias2), :id => :user_id).
  select{[alias1__name, alias2__name ]} 
```

有没有办法做到这一点？

谢谢！

**更新**

我认为`from_self`让我在那里的一部分，例如

```
my_items.from_self(:alias => :alias1).join(my_users, :id => :user_id).
  select{[alias1__name, t1__name]} 
```

似乎做正确的事。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-12T10:06:39.987

好的，多亏了 Ronald Holshausen 的提示，明白了。关键是`.from_self`在第一个数据集上使用，并`:table_alias`在连接中提供选项：

```
my_items.from_self(:alias => :alias1).
  join(my_users, {:id => :user_id}, :table_alias => :alias2).
  select(:alias1__name, :alias2__name) 
```

产生 SQL

```
 SELECT "alias1"."name", "alias2"."name" 
        FROM ( <my_items dataset> ) AS "alias1" 
  INNER JOIN ( <my_users dataset> ) AS "alias2"
          ON ("alias2"."id" = "alias1"."user_id") 
```

请注意，连接散列（ 的第二个参数`join`）需要显式大括号以将其与包含 的选项散列区分开来`:table_alias`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T04:20:07.607

我发现的唯一方法是使用`from`DB 上的方法和方法`:table_alias`上的`join`方法，但这些方法不适用于模型，所以我不得不使用`table_name`模型类中的方法。IE，

```
1.9.3p125 :018 > @db.from(Dw::Models::Contract.table_name => 'C1')
 => #<Sequel::SQLite::Dataset: "SELECT * FROM `vDimContract` AS 'C1'">
1.9.3p125 :019 > @db.from(Dw::Models::Contract.table_name => 'C1').join(Dw::Models::Contract.table_name, {:c1__id => :c2__id}, :table_alias => 'C2')
 => #<Sequel::SQLite::Dataset: "SELECT * FROM `vDimContract` AS 'C1' INNER JOIN `vDimContract` AS 'C2' ON (`C1`.`Id` = `C2`.`Id`)">  
1.9.3p125 :020 > @db.from(Dw::Models::Contract.table_name => 'C1').join(Dw::Models::Product.table_name, {:product_id => :c1__product_id}, :table_alias => 'P1')
 => #<Sequel::SQLite::Dataset: "SELECT * FROM `vDimContract` AS 'C1' INNER JOIN `vDimProduct` AS 'P1' ON (`P1`.`ProductId` = `C1`.`ProductId`)"> 
```

我唯一不喜欢的`from_self`是它使用子查询：

```
1.9.3p125 :021 > Dw::Models::Contract.from_self(:alias => 'C1')
 => #<Sequel::SQLite::Dataset: "SELECT * FROM (SELECT * FROM `vDimContract`) AS 'C1'"> 
```

# ios - 什么类最适合用作 iPhone 中的弹出窗口？

> ID：14115330
> 
> 赞同：0
> 
> 时间：2013-01-01T23:45:01.583
> 
> 标签：ios, user-interface, uiactionsheet

我听说 UIActionSheet 最好用作 iPhone 的弹出窗口，但我不知道苹果是否会喜欢该类的以下用法：

我不希望向用户提供选择，而是在应用程序失去连接时通知他们。我很想使用原生苹果类......有什么比 UIActionSheet 更好的吗？

我可以以这种方式使用 UIActionSheet 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:48:42.453

我相信您正在寻找的是 UIAlertView。它通常用于向用户提供信息更新，或者在您的情况下，连接更新，如果需要，提供选项

[UIAlertView 教程](http://mobile.tutsplus.com/tutorials/iphone/uialertview/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T23:46:36.203

这应该没问题（其他应用程序在连接丢失时会发出通知），但请注意，您不要因为手机上的网络连接抖动而惩罚用户，该手机每隔几分钟就会出去和回来。

# actionscript-3 - 在 as3 运行时更改公共变量？(flixel)

> ID：14115331
> 
> 赞同：0
> 
> 时间：2013-01-01T23:45:21.677
> 
> 标签：actionscript-3, flash, variables, flixel

我正在尝试创建一个猜谜游戏，让用户单击不同颜色的框以查看哪个是正确的。我有一个公共变量，它规定要使用哪种颜色（稍后的图像）。我的更新中的代码是这样的：

```
 if (FlxG.mouse.justPressed())
    {

        block2.distributionp = Math.random() * 2;
        block2.colorArray = block2.distributionp;
        block2.colorUnit = block2.colorArray;

    } 
```

（colorUnit和colorArray均等分布p，在class文件中为2的随机数）

当我运行此代码时，确实发生了更改，但似乎只切换了一次。其他时候它被忽略了。我怎样才能让它不断地切换出一个我以后可以使用的随机数？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T00:32:45.893

`Math.random() * 2`返回一个范围从 0.000000000000 到 2.00000000 的数字，这包括像 0.123456789 和 1.99999999 这样的数字（不确定它到底是什么小数位，只是说它不仅返回整数 0、1 和 2）。我不确定，但我认为您的问题在于范围，因此如果您想要更好的范围，请使用此代码。

`MIN_VALUE * Math.random() + (MAX_VALUE - MIN_VALUE);`

如果您只想获得整数，您可以使用`Math.ceil()`或者`Math.floor()`像这样：
`Math.ceil(MIN_VALUE * Math.random() + (MAX_VALUE - MIN_VALUE));`

如果这对您没有帮助，我很抱歉，但如果没有帮助，请告诉我，我将继续尝试并提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T02:04:27.827

我得到的值是 0 到 2 之间的整数。我想要做的是每次单击时更改值。我不确定会发生什么。也许我现在不应该问。当我有更多信息时，我会问。对不起。

# c++ - ld：使用 GNU Make 和 clang 未找到架构 x86_64 的符号

> ID：14115337
> 
> 赞同：4
> 
> 时间：2013-01-01T23:47:24.403
> 
> 标签：c++, compiler-construction, linker, 64-bit, clang

我收到一个`ld: symbol(s) not found for architecture x86_64`错误。我确实通过以前的线程进行了彻底的搜索，但没有找到解决方案。

作为测试，我正在编译一个程序 test.cpp：

```
#include <iostream>

using namespace std;

int main(){
 return 0;
} 
```

使用 Makefile：

```
CXX=g++
CXXFLAGS=-g -Wall -W -Wconversion -Wshadow -Wcast-qual -Wwrite-strings $(shell root-config --cflags --glibs)
CPPFLAGS+=-MMD -MP
LDFLAGS=-g $(shell root-config --ldflags)
LDLIBS=$(shell root-config --libs)

test.o: test.cpp

test: test.o
-include test.d 
```

在我的 linux 计算机上运行`make test`会产生以下正确输出：

```
CAM ~/Wenu $ make test
g++ -g -Wall -W -Wconversion -Wshadow -Wcast-qual -Wwrite-strings -pthread -m64 -I/cvmfs/lhcb.cern.ch/lib/RootConfig/pro/x86_64-slc5-gcc46-opt/root/include -L/cvmfs/lhcb.cern.ch/lib/RootConfig/pro/x86_64-slc5-gcc46-opt/root/lib -lGui -lCore -lCint -lRIO -lNet -lHist -lGraf -lGraf3d -lGpad -lTree -lRint -lPostscript -lMatrix -lPhysics -lMathCore -lThread -pthread -lm -ldl -rdynamic -MMD -MP  -c -o test.o test.cpp
cc -g -m64  test.o  -L/cvmfs/lhcb.cern.ch/lib/RootConfig/pro/x86_64-slc5-gcc46-opt/root/lib -lCore -lCint -lRIO -lNet -lHist -lGraf -lGraf3d -lGpad -lTree -lRint -lPostscript -lMatrix -lPhysics -lMathCore -lThread -pthread -lm -ldl -rdynamic -o test
CAM ~/Wenu $ 
```

在我的 Mac 上编译它在链接阶段失败并出现`ld: symbol(s) not found for architecture x86_64`错误：

```
MAC ~/Transmit/Wenu $ make test
g++ -g -Wall -W -Wconversion -Wshadow -Wcast-qual -Wwrite-strings -pthread -m64 -I/opt/local/root-v5-34-00/include -L/opt/local/root-v5-34-00/lib -lGui -lCore -lCint -lRIO -lNet -lHist -lGraf -lGraf3d -lGpad -lTree -lRint -lPostscript -lMatrix -lPhysics -lMathCore -lThread -lpthread -Wl,-rpath,/opt/local/root-v5-34-00/lib -lm -ldl -MMD -MP  -c -o test.o test.cpp
i686-apple-darwin11-llvm-g++-4.2: -lGui: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lCore: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lCint: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lRIO: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lNet: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lHist: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lGraf: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lGraf3d: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lGpad: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lTree: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lRint: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lPostscript: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lMatrix: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lPhysics: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lMathCore: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lThread: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lpthread: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -rpath: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: /opt/local/root-v5-34-00/lib: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -lm: linker input file unused because linking not done
i686-apple-darwin11-llvm-g++-4.2: -ldl: linker input file unused because linking not done
cc -g -m64  test.o  -L/opt/local/root-v5-34-00/lib -lCore -lCint -lRIO -lNet -lHist -lGraf -lGraf3d -lGpad -lTree -lRint -lPostscript -lMatrix -lPhysics -lMathCore -lThread -lpthread -Wl,-rpath,/opt/local/root-v5-34-00/lib -lm -ldl -o test
Undefined symbols for architecture x86_64:
  "std::ios_base::Init::Init()", referenced from:
      __static_initialization_and_destruction_0(int, int) in test.o
  "std::ios_base::Init::~Init()", referenced from:
      ___tcf_0 in test.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make: *** [test] Error 1 
```

任何帮助将不胜感激。

万一这其中任何一个是相关的，我有一个带有 OS X 10.7.5 的 64 位 Mac，我有一个带有 XCode 命令行工具的编译器：

```
MAC ~/Transmit/Wenu $ clang --version
Apple clang version 4.1 (tags/Apple/clang-421.11.66) (based on LLVM 3.1svn)
Target: x86_64-apple-darwin11.4.2
Thread model: posix 
```

ROOT 是我在程序中使用的 C++ 库的集合。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:11:55.813

> 在我的 linux 计算机上运行 make test 会产生以下正确的输出

这只是偶然的：您正在将`C++`程序与`cc`. 如果您使用更多的，它将停止在 Linux 上工作`C++`，例如尝试放入`cout << "Hello" << endl;`您的`main`.

> 我的文件也有一个 cpp 扩展名，所以我不明白为什么要使用 cc。

因为默认的 make 规则生成`test`from`test.o`使用`$CC`，而不是`$CXX`.

您可以通过以下几种方式之一解决此问题：

*   强制`$CC`也存在`g++`，或
*   更改`Makefile`时使用非默认规则`test`from `test.o`，或
*   使`test`依赖`test.cpp`（`make`如果你这样做，将使用正确的默认规则）。

# excel - Excel根据其他单元格创建排序列表

> ID：14115342
> 
> 赞同：2
> 
> 时间：2013-01-01T23:48:03.093
> 
> 标签：excel, vba

我想做的是拿出我的预算表并按特定顺序对其进行排序。这正是我所拥有的：

A 列 = 预算项目名称（账单和支付）

B 列 = 该项目到期的月份中的哪一天。

C 列 = 该项目的金额。

我想创建一些`VBA`代码，当按下按钮时，它将从这些列中获取该信息，并在 B 列中按天排序，如下所示：

```
1 - PayDay - 1000
4 - Cell Phone - 75
5 - Mortgage - 1350 
```

编辑：

我一直在研究这个 VBA。只需要弄清楚如何放入排序函数，以便按天列对我的结果进行排序。

```
Sub CreateList()

' Clear the current records
currentRow = 2
While currentRow < 200

    If IsEmpty(Worksheets("Jan").Cells(currentRow, 9)) Then
    GoTo Generate
    End If

    Worksheets("Jan").Cells(currentRow, 9).Value = ""
    Worksheets("Jan").Cells(currentRow, 10).Value = ""
    Worksheets("Jan").Cells(currentRow, 11).Value = ""
    Worksheets("Jan").Cells(currentRow, 12).Value = ""

    currentRow = currentRow + 1
Wend

Generate:

' Generate new list

titleCol = 1
dayCol = 2
amountCol = 3

currentListRow = 2

currentSheet = 1
While currentSheet < 2

    currentRow = 7
    cellVal = ""

    While currentRow < 800

    cellVal = Worksheets("Jan").Cells(currentRow, dayCol).Text

        If Not IsEmpty(cellVal) Then
            If Not cellVal = "0" Then
                If Not cellVal = "" Then
                If Not cellVal = "Due Date" Then

                    ' Set vals in list cells
                    Worksheets("Jan").Cells(currentListRow, 10).Value = Worksheets("Jan").Cells(currentRow, dayCol).Text
                    Worksheets("Jan").Cells(currentListRow, 9).Value = Worksheets("Jan").Cells(currentRow, titleCol).Text
                    Worksheets("Jan").Cells(currentListRow, 11).Value = Worksheets("Jan").Cells(currentRow, amountCol).Text

                    currentListRow = currentListRow + 1

        End If
        End If
        End If
        End If

        currentRow = currentRow + 1
    Wend

    currentSheet = currentSheet + 1
Wend

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T15:25:39.960

在Whytheq 的帮助下，我想出了这个解决方案。第一个 Sub 将字段复制到新区域。第二个子按天列对新创建的列表进行排序。第三个子项更改了任何新创建的未标记为我或我妻子姓名的列表项，并使它们成为负数。我这样做是为了在新列表的右侧添加一个字段，该字段执行与每个列表项相关的数学运算，以调整在支付每笔账单或添加每笔付款后我们剩下的金额。

```
Option Explicit
Sub CreateList()

' Clear the current records
Dim currentRow  As Integer '<<always declare variables
currentRow = 2
While currentRow < 200 And Not IsEmpty(Worksheets("Jan").Cells(currentRow, 9)) '<<best to not use goto unless no other way of coding it

Worksheets("Jan").Cells(currentRow, 9).Value = ""
Worksheets("Jan").Cells(currentRow, 10).Value = ""
Worksheets("Jan").Cells(currentRow, 11).Value = ""

currentRow = currentRow + 1
Wend

' Generate new list
Dim titleCol As Integer, dayCol As Integer, amountCol As Integer, cellVal As String

Dim currentListRow As Integer, currentSheet As Integer

titleCol = 1
dayCol = 2
amountCol = 3

currentListRow = 3

currentSheet = 1
While currentSheet < 2

    currentRow = 7

    While currentRow < 800

    cellVal = Worksheets("Jan").Cells(currentRow, dayCol).Text

        If Not IsEmpty(cellVal) And Not cellVal = "0" And Not cellVal = "" And Not cellVal = "Due Date" Then

                    ' Set vals in list cells
                    Worksheets("Jan").Cells(currentListRow, 10).Value = Worksheets("Jan").Cells(currentRow, dayCol).Text
                     Worksheets("Jan").Cells(currentListRow, 9).Value = Worksheets("Jan").Cells(currentRow, titleCol).Text
                       Worksheets("Jan").Cells(currentListRow, 11).Value = Worksheets("Jan").Cells(currentRow, amountCol).Text
                       currentListRow = currentListRow + 1

        End If

        currentRow = currentRow + 1
    Wend

    currentSheet = currentSheet + 1
Wend
Call Sort
End Sub
Public Sub Sort()

Dim oneRange As Range
 Dim aCell As Range

Set oneRange = Range("I3:K40")
 Set aCell = Range("J3")

oneRange.Sort Key1:=aCell, Order1:=xlAscending, Header:=xlGuess

Call Negative
End Sub
Public Sub Negative()
Dim titlesCol As Integer, daysCol As Integer, amountsCol As Integer, cellVal As String
Dim currentListRow As Integer, currentSheet As Integer, currentRow  As Integer

 titlesCol = 9
 amountsCol = 11
 currentListRow = 3

currentSheet = 1
While currentSheet < 2

    currentRow = 3
    cellVal = ""

    While currentRow < 41

    cellVal = Worksheets("Jan").Cells(currentRow, titlesCol).Text

             If Not cellVal = "Alisa" Then
                If Not cellVal = "Jordan" Then

                    ' Multiply by Negative 1
                    Worksheets("Jan").Cells(currentRow, 11).Value = Worksheets("Jan").Cells(currentRow, 11).Value * -1

                    currentListRow = currentListRow + 1

        End If
        End If

        currentRow = currentRow + 1
    Wend

    currentSheet = currentSheet + 1
Wend
 End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:18:46.850

这是一个解决方案，只需将此宏附加到您放在工作表上的按钮即可。我只是录制了一个宏，然后将其修改为不太特定于上下文......

此解决方案假定数据或标题从活动工作表的单元格 A1 开始，并且没有空行或空列穿插。

如果要更改排序列，只需更改对“B”的引用。

如果添加列，则将对“C”的引用更改为排序区域中的最后一列，或者更好地更新代码以检测所选范围内的最后一列，类似于我确定最后一行的方式......

祝你好运！

```
Public Sub SortByDescription()
Dim Rng As Range, Ws As Excel.Worksheet, LastRow As Long
    Set Ws = ThisWorkbook.ActiveSheet
    Set Rng = Ws.Range("A1")
    Ws.Range(Rng, Rng.End(xlToRight)).Select
    Set Rng = Ws.Range(Selection, Selection.End(xlDown))
    LastRow = Rng.End(xlDown).Row
    Ws.Sort.SortFields.Clear
    Ws.Sort.SortFields.Add Key:=Range("B1:B" & LastRow), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With Ws.Sort
        .SetRange Range("A1:C" & LastRow)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Ws.Range("A1").Select
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T12:59:11.090

没有回答您的问题，但只是快速浏览了您的代码，并且有一些明显的改进：

```
Option Explicit   '<<best to use this in all modules; 

Sub CreateList()

' Clear the current records
Dim currentRow  As Integer '<<always declare variables
currentRow = 2
While currentRow < 200 And Not IsEmpty(Worksheets("Jan").Cells(currentRow, 9)) '<<best to not use goto unless no other way of coding it

    Worksheets("Jan").Cells(currentRow, 9).Value = ""
    Worksheets("Jan").Cells(currentRow, 10).Value = ""
    Worksheets("Jan").Cells(currentRow, 11).Value = ""
    Worksheets("Jan").Cells(currentRow, 12).Value = ""

    currentRow = currentRow + 1
Wend

' Generate new list
Dim titleCol As Integer, dayCol As Integer, amountCol As Integer
Dim currentListRow As Integer, currentSheet As Integer

titleCol = 1
dayCol = 2
amountCol = 3

currentListRow = 2

currentSheet = 1
While currentSheet < 2

    currentRow = 7
    cellVal = ""

    While currentRow < 800

        cellVal = Worksheets("Jan").Cells(currentRow, dayCol).Text

        If Not IsEmpty(cellVal) And Not cellVal = "0" And Not cellVal = "" And Not cellVal = "Due Date" Then  '<<all conditions seem to be able to go in one IF

            ' Set vals in list cells
            Worksheets("Jan").Cells(currentListRow, 10).Value = Worksheets("Jan").Cells(currentRow, dayCol).Text
            Worksheets("Jan").Cells(currentListRow, 9).Value = Worksheets("Jan").Cells(currentRow, titleCol).Text
            Worksheets("Jan").Cells(currentListRow, 11).Value = Worksheets("Jan").Cells(currentRow, amountCol).Text
            currentListRow = currentListRow + 1

        End If

    currentRow = currentRow + 1
    Wend

currentSheet = currentSheet + 1
Wend

Call SortByDescription

End Sub

Public Sub SortByDescription()
Dim Rng As Range, Ws As Excel.Worksheet, LastRow As Long
    Set Ws = ThisWorkbook.ActiveSheet
    Set Rng = Ws.Range("A1")
    Ws.Range(Rng, Rng.End(xlToRight)).Select
    Set Rng = Ws.Range(Selection, Selection.End(xlDown))
    LastRow = Rng.End(xlDown).Row
    Ws.Sort.SortFields.Clear
    Ws.Sort.SortFields.Add Key:=Range("B1:B" & LastRow), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With Ws.Sort
        .SetRange Range("A1:C" & LastRow)
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Ws.Range("A1").Select
End Sub 
```

该`Option Explicit`行非常重要，您可以将编辑器设置为始终自动在所有模块中包含该行。当您在`IDE`s`Tool`菜单中选择`Options`并选择选中“需要变量声明”

我已将@Tahbaza 例程添加到您的代码底部 - 在您底部的代码中，我已添加`Call SortByDescription`以调用排序例程。

![在此处输入图像描述](../Images/df71a403a12f3262c1842c2f0ab3439f.png)

# java - 两个线程在循环中丢失值

> ID：14115343
> 
> 赞同：-1
> 
> 时间：2013-01-01T23:48:03.350
> 
> 标签：java, multithreading, class, static

我有这样的代码：

```
public class Count extends Thread {
    static IntCell n = new IntCell();

    public void run() {
        int temp;
        for (int i = 0; i < 200000; i++) {
            temp = n.getN();
            n.setN(temp + 1);
        }
    }

    public static void main(String[] args) {
        Count p = new Count();
        p.setName("Watek1");
        Count q = new Count();

        p.start();
        q.start();

        try {
            p.join();
            q.join();  
        }
        catch (InterruptedException e) {
            System.out.println(e);
        }

        System.out.println("The value of n is " + n.getN());
    }
}

class IntCell {
    private int n = 0;
    public int getN() {
        return n;
    }
    public void setN(int n) {
        this.n = n;
    }
} 
```

有两个线程，它们将 n 的值加 1（在静态类中）。当我运行此代码时，n 值的值永远不会等于 400000，而是与此有关。为什么会发生这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:52:51.267

这是多线程的基本问题之一。获取一个值、增加它并将其存储回来并不是所谓的“原子”——也就是说，需要多个操作才能做到这一点。这里发生的情况是：一个线程在值 X 处获得 N，另一个线程也这样做。两个线程都递增，并将 X+1 存储为新的 N - 尽管两者都将其本地计数递增 1，但 N 也仅递增 1。

无论这种情况是否发生以及 N 会偏离预期值多少，出于争论的原因，都是随机的。

查看 AtomicInteger 之类的类并阅读称为互斥体的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T00:00:01.170

出现竞态条件。请参阅同步语句（如下）...

```
public void run() {
    int temp;
    for (int i = 0; i < 200000; i++) {
        synchronized(n) {
          temp = n.getN();
          n.setN(temp + 1);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:28:52.840

对您的问题的简单回答是因为两个线程执行的**n.getN()**和**n.setN(temp + 1)**的调用相互交错，例如：

```
Thread 1: n.getN() // returns 100
Thread 2: n.getN() // also returns 100
Thread 1: n.setN(temp + 1) // sets 101
Thread 2: n.setN(temp + 1) // also sets 101 
```

您需要实现线程同步或其他方法来达到预期的结果。

我建议您花一些时间阅读 Java SE 教程的并发章节：http: [//docs.oracle.com/javase/tutorial/essential/concurrency/index.html](http://docs.oracle.com/javase/tutorial/essential/concurrency/index.html)

# c - 函数没有被调用

> ID：14115344
> 
> 赞同：0
> 
> 时间：2013-01-01T23:48:34.487
> 
> 标签：c, variadic-functions, gcc4.7

我正在用 C 实现一个 http 服务器。我有一个自定义函数来编写标题。当我调用它时，它什么也没做。我在函数中放置了一个任意的 printf，以确保它被调用，并且它也不会产生输出。除此问题外，程序编译成功，并按预期正常工作。我可以连接到服务器，由于这个问题导致空响应。我可以轻松使用`fprintf`，但我想了解问题所在。函数声明如下：

```
void write_response_ln(FILE *fp, char *format, ...)
{
    va_list args;
    printf("dsgsfdg");
    strcat(format, "\r\n");
    va_start(args, format);
    vfprintf(fp, format, args);
    va_end(args);
} 
```

它位于它自己的文件中，与调用者所在的文件不同。即使调用了 4 次，客户端进程也会报告空响应。为什么会这样？顺便说一句，我在 linux 上使用 gcc 4.7 来编译它。

* * *

这是调用者函数：

```
static pid_t handle_connection(size_t bfrsz, int fd_connect, pid_t kid_pid)
{
    int     c;
    char    *headers    = malloc(bfrsz);
    FILE    *res        = fdopen(fd_connect, "a+");

    kid_pid = getpid();

    bzero(headers, bfrsz);

    fgets(headers, bfrsz, res);

    fprintf(stdout, "REQ: %s\n", headers);
    write_response_ln(res, "HTTP 200 OK");
    write_response_ln(res, "Content-Type:text/html");
    write_response_ln(res, "");
    write_response_ln(res, "I don't have a parser yet.");

    fclose(res);
    // Commit suicide.
    printf("Transaction: Complete: Kill: [%d]\n", kid_pid);
    sleep(1);
    kill(kid_pid, SIGINT);
    free(headers);
    return kid_pid;
} 
```

与 gdb 的合作给了我这个：

```
(gdb) break write_response_ln
Breakpoint 1 at 0x400f80: file headers.c, line 8.
(gdb) run
Starting program: /home/goktug/code/server/src/server 

Program received signal SIGSEGV, Segmentation fault.
0x0000003491239f24 in ____strtoll_l_internal () from /lib64/libc.so.6
Missing separate debuginfos, use: debuginfo-install glibc-2.15-58.fc17.x86_64 
```

作为一个小提示，我还没有完成 getopt 部分，所以程序在不带参数的情况下调用时会出现段错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:13:47.437

您正在使用字符串文字，它们是常量：

```
write_response_ln(res, "HTTP 200 OK"); 
```

并且您正在尝试修改它们：

```
strcat(format, "\r\n"); 
```

相反，请使用临时非常量缓冲区并首先复制格式。

# mysql - 是否可以有条件地在 MySQL 更新语句中只设置一些值？

> ID：14115351
> 
> 赞同：1
> 
> 时间：2013-01-01T23:50:06.673
> 
> 标签：mysql

我有一种情况，用户可能会或可能不会提供需要进入包含该用户信息的行的各种数据位。问题是随着时间的推移，他们需要在行中输入多个条目，并且我不想取消任何预先存在的值，如果这些值是在过去设置的。

我的愿望是做一些看起来像这样的事情（在伪代码中）：

var a,b,c;// 这些是用户提供的值，任何时候都可能为空

```
update user if a != null set name = a,  if b != null set phone = b, if c != null set email c 
```

我一直在尝试使 IF 以这种方式工作，但我尝试过的各种方式都出现语法错误。希望有人可以阐明执行此操作的正确方法（如果可能的话）。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:54:34.367

[一种方法是使用COALESCE()](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_coalesce)将每列“默认”为其原始值。

```
UPDATE user
SET name = COALESCE(a, name),
    phone = COALESCE(b, phone),
    email = COALESCE(c, email)
WHERE ... 
```

COALESCE() 返回它的第一个非空参数，所以如果`a`为空，它只会返回 的原始值`name`，所以不会有净变化。

MySQL 还支持 ISNULL() 函数，其工作方式类似于 COALESCE()，但 COALESCE() 是标准 SQL。此外， COALESCE() 支持两个以上的参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T23:55:14.287

你可以`COALESCE`像这样使用：

```
UPDATE user SET name = coalesce(a, name), ... 
```

可能更好的方法是动态创建您的 UPDATE 语句并仅包含需要更新的字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T23:54:18.880

以下是纯粹在 SQL 中执行此操作的方法：

```
UPDATE user
SET name = IF(a IS NULL, name, a),
    phone = IF(b IS NULL, phone, b),
    email = IF(c IS NULL, email, c) 
```

# windows-phone-7 - Sql Compact 小数精度错误

> ID：14115354
> 
> 赞同：1
> 
> 时间：2013-01-01T23:50:38.500
> 
> 标签：windows-phone-7, sql-server-ce

我有一个使用带有 Sql Compact 的 Linq to Sql 的 Windows Phone 应用程序。My Item 表具有多种字段类型，包括一些十进制和可为空的十进制值。

在模拟器中进行测试时，在启动时并在后台线程中读取 Item 表以填充到主页上的 ListBox 中，我将得到一个未处理的 ArgumentException：

> 精度值“29”小于 0 或大于允许的最大精度 38。

这是间歇性的，也许每 15 到 20 次我调试项目一次，但它*总是*“29”。我还没有在物理设备上遇到这个错误，但我还没有在那里做太多的测试。

为什么会这样？我试过在网上搜索，但是我看到这个错误的每个实例，精度值确实大于 38。我想我可以将它包装在一个 try-catch 块中，但这并不能真正解决问题，无论如何这是。虽然当数据库有数据时会发生这种情况，但新的空数据库也会发生这种情况。数据存在时的实际十进制值非常低（有些是货币，有些是重量和尺寸）。

如果我从错误中继续，调试通常可以正常工作。

堆栈跟踪：

```
at System.Data.SqlServerCe.SqlMetaData.Construct(String name, SqlDbType dbType, Byte precision, Byte scale)
at System.Data.SqlServerCe.SqlMetaData..ctor(String name, SqlDbType dbType, Int64 maxLength, Byte precision, Byte scale, Int64 localeId, SqlCompareOptions compareOptions, Type userDefinedType)
at System.Data.SqlServerCe.MetaData..ctor(String name, SqlCeType typeMap, Byte precision, Byte scale, Int64 maxLength, String databaseName, String schemaName)
at System.Data.SqlServerCe.SqlCeDataReader.PopulateMetaData(Int32 columnCount, IntPtr prgColumnInfo)
at System.Data.SqlServerCe.SqlCeDataReader.FillMetaData(IntPtr pIUnknown)
at System.Data.SqlServerCe.SqlCeDataReader.FillMetaData(SqlCeCommand command)
at System.Data.SqlServerCe.SqlCeCommand.InitializeDataReader(SqlCeDataReader reader, Int32 resultType)
at System.Data.SqlServerCe.SqlCeCommand.ExecuteCommand(CommandBehavior behavior, String method, ResultSetOptions options)
at System.Data.SqlServerCe.SqlCeCommand.ExecuteReader(CommandBehavior behavior)
at System.Data.SqlServerCe.SqlCeCommand.ExecuteDbDataReader(CommandBehavior behavior)
at Microsoft.Phone.Data.Common.DbCommand.ExecuteReader()
at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult, Boolean isCompiledQuery)
at System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries, Boolean isCompiledQuery)
at System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query)
at System.Data.Linq.DataQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator()
at System.Linq.Enumerable.<TakeIterator>d__40`1.MoveNext()
at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
at Data.Item.List()
at Pages.Main.Thread_DoWork(Object sender, DoWorkEventArgs e)
at System.ComponentModel.BackgroundWorker.OnDoWork(DoWorkEventArgs e)
at System.ComponentModel.BackgroundWorker.OnRun(Object argument)
at System.Threading.ThreadPool.WorkItem.WaitCallback_Context(Object state)
at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
at System.Threading.ThreadPool.WorkItem.doWork(Object o)
at System.Threading.Timer.ring() 
```

# c# - 打印 PDF 和自定义标签尺寸

> ID：14115355
> 
> 赞同：0
> 
> 时间：2013-01-01T23:50:41.253
> 
> 标签：c#, vb.net, winforms, printing

我正在使用 iTextSharp (winforms) 生成 PDF 文档，现在我需要使用标签打印机打印这个生成的 PDF 文档。

我的机器上安装了多台打印机，因此使用 VB.net 我需要选择某台热敏打印机。

选择打印机后，我需要指定运输标签尺寸（宽度和高度）。

因此，一旦**选择了标签打印机**并指定了**自定义标签尺寸**，我希望在没有任何用户操作的情况下打印标签（例如跳过 Confitm 框进行打印）。

我不需要完整的代码，我只需要有人把我带入正确的方向。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T05:01:46.733

您可以使用 PrintDocument 对象。使用 Print 方法，并在 PrintPage 处理程序中进行实际打印。为此，您可以输出到 PrintPage 处理程序中参数 PrintPageEventArgs 的图形对象。

# spring - 为什么我的二级缓存没有命中？

> ID：14115356
> 
> 赞同：1
> 
> 时间：2013-01-01T23:50:42.453
> 
> 标签：spring, hibernate, junit, statistics, second-level-cache

我正在使用 Spring 3.1.1.RELEASE、Hibernate 4.1.5.Final 和 JUnit 4.8.1。我想测试我的二级缓存是否被正确使用，但不确定我是否做得对。以下 JUnit 代码在最后一个断言上失败……</p>

```
private Statistics m_stats;

@Before
public void setup()
{
    m_stats = ((org.hibernate.internal.SessionImpl) m_entityManager.getDelegate()).getSessionFactory().getStatistics();
}   // setup

@Test
public void testGenerateStats()
{
    final String countryId = m_testProps.getProperty("test.country.id");
    final Country country = m_countryDao.findById(countryId);
    Assert.assertNotNull(country);

    final Country country2 = m_countryDao.findById(countryId);
    m_countryDao.findById(countryId);
    Assert.assertTrue(m_stats.getSecondLevelCacheHitCount() > 0);
} 
```

以下是我配置域对象的方式……</p>

```
@Entity
@Table(name = "cb_country")
@Cache(usage = CacheConcurrencyStrategy.READ_ONLY)
public class Country implements Serializable
{
    …
} 
```

这是我的 DAO……</p>

```
@Override
public Country findById(String id)
{
    Country ret = null;
    if (id != null)
    {
        ret = entityManager.find(Country.class, id);
    }   // if
    return ret;
} 
```

以下是我配置 Hibernate 二级缓存的方式……</p>

```
 <!--  Caching -->
    <property name="hibernate.cache.use_second_level_cache">true</property>
    <property name="hibernate.cache.region.factory_class">org.hibernate.cache.ehcache.EhCacheRegionFactory</property>
    <property name="hibernate.cache.provider_class">org.hibernate.cache.EhCacheProvider</property> 
    <!--  Collect stats, this is for testing if the cache is working -->
    <property name="hibernate.generate_statistics">true</property> 
```

任何想法为什么我的二级缓存没有指示任何命中？谢谢 - 戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-20T14:18:32.277

`SecondLevelCacheHitCount`等于零，因为在会话期间（如在您的代码中）休眠使用第一级缓存并从中加载实体。没有使用二级缓存，所以 secondLevelCacheHitCount 没有改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-04T01:28:47.020

现在有点老了，但是如果您将日志记录设置为像[Marcel Stör](https://stackoverflow.com/users/131929/marcel-stor)所说的那样显示休眠统计信息 - 例如

`log4j.logger.org.hibernate.stat=TRACE`

注意这样的事情

> 调试 2013-10-04 11:09:20,456 [main] org.hibernate.stat.internal.StatisticsInitiator：统计信息已初始化 [enabled=false]

我看你有`hibernate.generate_statistics=true`

但是，为了在我的测试中启用统计信息，我使用了：

`m_stats.setStatisticsEnabled(true);`

我有一个测试，我认为这表明它在 4.1.7 版本中默认启用，但在那之后的某个时候被更改（我升级到 4.1.12，我的缓存测试失败），所以我不知道为什么它不是t 在版本 4.1.5 中为您启用，但要确保统计记录正常工作。

# r - 使用重塑创建纵向数据集

> ID：14115357
> 
> 赞同：2
> 
> 时间：2013-01-01T23:50:54.757
> 
> 标签：r, reshape, data-manipulation

我有数据集：

```
top100_repository_name  month   monthly_increase    monthly_begin_at    monthly_end_with
Bukkit                  2012-03 9                   431                 440
Bukkit                  2012-04 19                  438                 457
Bukkit                  2012-05 19                  455                 474
CodeIgniter             2012-03 15                  492                 507
CodeIgniter             2012-04 50                  506                 556
CodeIgniter             2012-05 19                  555                 574 
```

我使用以下 R 代码：

```
library(reshape)
latent.growth.data <- read.csv(file = "LGC_data.csv", header = TRUE)
melt(latent.growth.data, id = c("top100_repository_name", "month"), measured = c("monthly_end_with"))
cast(latent.growth.data, top100_repository_name + month ~ monthly_end_with) 
```

我想用它来创建具有以下结构的数据集：

```
top100_repository_name    2012-03    2012-04    2012-05
Bukkit                    440        457        474
CodeIgniter               507        556        574 
```

但是，当我运行我的代码时，我得到以下输出：

```
Using monthly_end_with as value column.  Use the value argument to cast to override this choice
Error in `[.data.frame`(data, , variables, drop = FALSE) : 
  undefined columns selected 
```

如何修改我的代码以生成所需的输出？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T00:18:45.243

我敢肯定，很快就会有人提出`plyr`解决方案，但这是使用该`reshape`功能的基本解决方案。

```
test <- read.table(textConnection("top100_repository_name  month   monthly_increase    monthly_begin_at    monthly_end_with
Bukkit                  2012-03 9                   431                 440
Bukkit                  2012-04 19                  438                 457
Bukkit                  2012-05 19                  455                 474
CodeIgniter             2012-03 15                  492                 507
CodeIgniter             2012-04 50                  506                 556
CodeIgniter             2012-05 19                  555                 574"),header=TRUE) 
```

重塑这里的数据：

```
test2 <- reshape(
    test[c("top100_repository_name","month","monthly_end_with")],
    idvar="top100_repository_name",
    timevar="month",
    direction="wide"
) 
```

修正名称

```
names(test2) <- gsub("monthly_end_with.","",names(test2)) 
```

看起来像：

```
> test2
  top100_repository_name 2012-03 2012-04 2012-05
1                 Bukkit     440     457     474
4            CodeIgniter     507     556     574 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-02T03:01:01.863

这是 base R 中另一种非常直接的方法。使用`xtabs()`：

```
xtabs(monthly_end_with ~ top100_repository_name + month, test)
#                       month
# top100_repository_name 2012-03 2012-04 2012-05
#            Bukkit          440     457     474
#            CodeIgniter     507     556     574

as.data.frame.matrix(
  xtabs(monthly_end_with ~ top100_repository_name + month, test))
#             2012-03 2012-04 2012-05
# Bukkit          440     457     474
# CodeIgniter     507     556     574 
```

或者，如@thelatemail 所示，`dcast`“reshape2”包中的内容可以按如下方式使用：

```
dcast(test, top100_repository_name ~ month, value.var="monthly_end_with")
#   top100_repository_name 2012-03 2012-04 2012-05
# 1                 Bukkit     440     457     474
# 2            CodeIgniter     507     556     574 
```

# ios - AFNetworking 使用整数上传表单数据

> ID：14115361
> 
> 赞同：0
> 
> 时间：2013-01-01T23:51:50.487
> 
> 标签：ios, django, afnetworking

我正在尝试上传包含各种数据的文件，包括整数。我正在按照以下方式进行操作：

```
NSMutableURLRequest *request = [httpClient multipartFormRequestWithMethod:@"POST" path:@"send_image" parameters:nil constructingBodyWithBlock: ^(id <AFMultipartFormData>formData)
{        
    NSUInteger user_id_int = [tempUserID integerValue];
    NSData *user_id = [NSData dataWithBytes:&user_id_int length:sizeof(user_id_int)];
    NSData *data1 = UIImagePNGRepresentation(imageSaved);

    [formData appendPartWithFileData:data1 name:@"file" fileName:@"name.png" mimeType:@"image/png"];
    [formData appendPartWithFormData:user_id name:@"ID" ];

}]; 
```

当我发送上述请求时，后端（我在 Django 中编写）给出了一个错误，用于清除表示`Enter a whole number`ID 的表单。如何通过此表单请求发送整数？表单的所有其他部分都在工作.. 我尝试创建一个 NSString，但是，当我将整数转换为字符串并通过表单请求发送它时，它似乎不喜欢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T00:01:23.337

这是您从整数获取序列化数据的方式：

```
NSData *data = [[NSString stringWithFormat:@"%d", theInteger] dataUsingEncoding:NSUTF8StringEncoding]; 
```

# php - jQuery在更改事件后没有拾取更改事件

> ID：14115362
> 
> 赞同：0
> 
> 时间：2013-01-01T23:52:03.430
> 
> 标签：php, jquery, ajax

希望你能帮忙......这让我很生气！

我有 2 个选择框，其中 jquery 从框中获取值以更新我主页上的各种表。

第一个（货币）工作得很好。第二个第一次工作，但是对站点的任何后续更改和 onchange 都不会被拾取！！！

任何帮助将非常感激。

网站链接：http: [//bit.ly/10ChZys](http://bit.ly/10ChZys)

```
jQuery("#changeCoinCountrySelect").change(function(){
    var country = jQuery('#changeCoinCountrySelect option:selected').val();
    jQuery("#coinTable").load("http://.../.../.../.../tables.php?country="+country);
}); 
```

正常工作`id=changeCurrencySelect`的选择与仅适用于最多 1 次更新的选择一起使用`id=changeCoinCountrySelect`

应该发生的是，当国家改变时，表格会用正确的国家硬币刷新。这种情况发生一次。然后，当我尝试选择另一个国家/地区时，它停止工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:56:42.237

由于您要替换父元素 ( `#coinTable`) 的 HTML，因此您的 change 事件在每次 AJAX 调用时与旧 HTML 一起被删除。

```
jQuery("#coinTable").on("change", "#changeCoinCountrySelect", function(){
    var country = jQuery(this).val();
    jQuery("#coinTable").load("http://goldealers.co.uk/wp-content/plugins/gd/tables.php?country="+country);
}); 
```

更多信息：[http ://api.jquery.com/on/#direct-and-delegated-events](http://api.jquery.com/on/#direct-and-delegated-events)

# javascript - element.innerHTML 分配是否有回调？

> ID：14115366
> 
> 赞同：3
> 
> 时间：2013-01-01T23:53:02.650
> 
> 标签：javascript

使用[Head.js](http://headjs.com)并设置脚本元素的 .src 属性时，会在脚本准备好时调用回调方法。

但是，我想通过将文本分配给 .innerHTML 来加载脚本。执行此操作时，当我更新/编辑代码以使用此属性时，没有触发相同的回调。

```
/*addScriptText1
** modified from head.js
**
**
*/
function addScriptText1(file_name, callback, key) {
    var element = document.createElement('script');
    element.async = true;
    element.innerHTML = localStorage[file_name];
    element.onreadystatechange = element.onload = function () {
        $A.log('callback for element called');
        if ((!element.readyState || /loaded|complete/.test(element.readyState))) {
            localStorage[key + '_loaded'] = true;
            callback();
        }
    };
    document.head.appendChild(element);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:54:18.523

跨浏览器（包括 Firefox iirc）不支持在脚本元素上使用 innerHTML。我不会推荐这种方法。我会建议*eval*或*new Function*代替。

[可以用 innerHTML 插入脚本吗？](https://stackoverflow.com/questions/1197575/can-scripts-be-inserted-with-innerhtml/1199866#1199866)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T00:29:36.000

当内联脚本插入 DOM 时，脚本会立即执行。这一切都是同步发生的，所以你不需要回调。

`async`在这里没有效果，因为您没有进行网络请求。同样，readyState 也没有用，因为您是以编程方式创建它，因此脚本将立即加载。

# javascript - JavaScript 的 document.querySelector() 和 jQuery $() 方法一样吗？

> ID：14115375
> 
> 赞同：32
> 
> 时间：2013-01-01T23:54:26.823
> 
> 标签：javascript, jquery, dom, model, document

我一直想知道为什么`$(".myClass")`当 JavaScript 有一个通用的`document.querySelector()`. 我在这里缺少什么吗？为什么不直接使用`document`对象？

我对 JavaScript 完全陌生，所以有`document.querySelector()`什么我不知道的骗局吗？

我真的很想知道，因为我之前遇到过这样的事情，我想知道它是否有助于我所处的情况：

```
var retrieve = function( s ) {
    return document.querySelector( s );
};

retrieve(".myClass").style.display = "block"; 
```

* * *

### 笔记

我完全不反对 jQuery。事实上，我喜欢它。但是，当我刚刚尝试学习 JavaScript 时，我宁愿不要使用简单的预制现成工具来欺骗自己。

任何帮助将非常感激！:-)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-02T01:30:11.423

跨浏览器和旧版支持。

如果您不想使用 Jquery，也可以使用 getElementsByClassName()。有一个用户[对 devshed 上的帖子的回复](http://forums.devshed.com/javascript-development-115/javascript-get-all-elements-of-class-abc-24349.html)：您可能感兴趣的 KorRedDevil。

我从您的帖子中获取了您的函数并使其返回一个数组。在您拥有该元素数组之后，您所要做的就是遍历它们。[你可以在这里](http://jsfiddle.net/tEB6G/)试试。

*Javascript*：

```
var retrieve = function(className) {
    return document.getElementsByClassName(className);
};

var elements = retrieve('foo');
for (var i = 0; i < elements.length; i++)
    elements[i].style.background = '#dfd'; 
```

*标记*：

```
<p class="foo">foo</p>
<p class="bar">bar</p>
<p class="foo">foo</p>
<p class="foo">foo</p>
<p class="bar">bar</p>
<p class="bar">bar</p> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-03-29T20:48:06.733

大约十年前，顶级浏览器是 IE6、Netscape 8 和 Firefox 1.5。在那个时候，除了[**`Document.getElementById()`**](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById).

所以，当 jQuery[**在 2006 年发布**](http://ejohn.org/blog/barcampnyc-wrap-up/)时，它是相当具有革命性的。那时，jQuery 为如何轻松选择/更改 HTML 元素和触发事件设定了标准，因为它的灵活性和对浏览器的支持是前所未有的。

现在，十多年后，许多让 jQuery 如此流行的特性已经包含在 JavaScript 标准中。代替 jQuery 的[**`$selection.on()`**](http://api.jquery.com/on/)，你现在可以使用[**`EventTarget.addEventListener()`**](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener). [**`$()`**](http://api.jquery.com/jquery/#jQuery1)现在，您可以使用...代替 jQuery ，而使用[**`Document.querySelectorAll()`**](https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll)... etc... 这引出了我们为什么应该使用 jQuery 的问题。事实上，人们越来越[**想知道我们是否应该使用 jQuery**](http://www.sitepoint.com/do-you-really-need-jquery/)。所以，如果你认为你对 JavaScript 的理解足够好，可以不用 jQuery，请这样做！不要因为很多其他人都在使用 jQuery 而感到被迫使用 jQuery！

无论如何，要了解为什么 jQuery 如此受欢迎，重要的是要了解我们的出发点！

# jquery - 如何在 jquery.form ajaxSubmit 中包含提交值？

> ID：14115376
> 
> 赞同：0
> 
> 时间：2013-01-01T23:54:28.740
> 
> 标签：jquery, forms, backbone.js, jquery-forms-plugin

我有一个主干视图

`"submit": 'handleForms'`

在其事件中哈希。

handleForms 定义如下：

```
handleForms: function(e){
    $(e.target).ajaxSubmit({
        beforeSubmit: function(arr, $form, options){
            console.log('hello');
        }
    });
    return false;
}, 
```

我的一个表单有多个提交按钮：

```
<button type="submit" class="zone Empty" name="zone" value="14"> [14]: Empty </button> 
```

“区域”未显示在提交给服务器的参数中。根据“成功控制”文档的第二个项目符号（http://www.w3.org/TR/html401/interact/forms.html#h-17.13.2），我希望 zone=14 被发送。

我已经看到人们以编程方式提交表单的其他 SO 问题，因此缺少提交值，但这是用户通过单击按钮启动的。

jquery.form 不应该在序列化中包含这个值吗？有没有办法做到这一点，还是我必须手动浏览表单元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T00:16:01.730

问题与文档中声明的 jQuery`serialize()`方法有关：

> 注意：只有“成功的控件”被序列化为字符串。由于未使用按钮提交表单，因此没有序列化提交按钮值。

我相信他们真正的意思是说不通过浏览器默认方法提交

[http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

您可以通过将隐藏字段附加到每次提交的表单来创建解决方法。

```
beforeSubmit: function(arr, $form, options) {
    $form.find(':submit').each(function() {
        /* check if hasn't been added already on prior submit attempt*/
        if(!$form.find('input[type="hidden"][name = "' + this.name + '"]').length) {
                /* add hidden field*/
            $form.prepend('<input type = "hidden" name = "' + this.name + '" value = "' + this.value + '" / > ');
        }
    })

} 
```

**编辑**到仅发送被点击的按钮：

```
$('#formID :submit').click(function(){
     $('#formID :submit').removeClass('activeButton');
    $(this).addClass('activeButton');
})

beforeSubmit: function(arr, $form, options) {
        $form.find(':submit.activeButton').each(function() {
            /* check if hasn't been added already on prior submit attempt*/
            if(!$form.find('input[type="hidden"][name = "' + this.name + '"]').length) {
                    /* add hidden field*/
                $form.prepend('<input type = "hidden" name = "' + this.name + '" value = "' + this.value + '" / > ');
            }
        })

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T04:08:21.153

这个怎么样（不涉及`beforeSubmit`）：

首先，在表单中硬编码一个隐藏字段：

```
<input type="hidden" name="submitType" id="submitType"> 
```

然后，在 js 中：

```
$form.on('click', "button[type='submit']", function() {
    $("#submitType").val(this.value);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T12:27:02.767

对于这个问题，我有一个稍微改进的代码片段，`input:hidden`如果它还不存在，它会即时注入相应的标签，然后从单击的`button`或复制值`input:submit`。

该方法在执行时间上应该是安全的，因为`Submit`在`Click`冒泡到`document`.

```
(function($) {
    var btn_selector = "form button, form input:submit";

    function _btn_handler() {
        var jo = $(this),
            jo_form = (jo && jo.closest('form')),
            jo_proxy = (jo_form.length && jo_form.find('input:hidden[name=' + jo.prop('name') + ']'));

        if (typeof jo_proxy == 'object') {
            if (!jo_proxy.length) {
                jo_proxy = $('<input type="hidden" name="'+ jo.prop('name') +'">');
                jo_form.append(jo_proxy);
            }

            jo_proxy.val(jo.prop('value'));
        }
    }
    $(document).off('click', btn_selector, _btn_handler).on('click', btn_selector, _btn_handler);
})(jQuery); 
```

# c++ - 正则表达式库在 C++ 中无法正常工作

> ID：14115379
> 
> 赞同：0
> 
> 时间：2013-01-01T23:54:51.733
> 
> 标签：c++, regex, ubuntu

我一直在寻找在 c++ 中使用正则表达式的地方，因为我想在 c++ 中学习正则表达式（如果你们有的话，也请给我一个分步链接）。我正在使用 g++ 编译我的程序并在 Ubuntu 中工作。早些时候我的程序没有编译，但后来我读了这篇文章，上面说通过“g++ -std=c++0x sample.cpp”编译程序以使用正则表达式头。我的第一个程序运行正常，我尝试实现 regex_match

```
#include<stdio.h>
#include<iostream>
#include<regex>
using namespace std;

int main()
{
string str = "Hello world";
regex rx ("ello");

if(regex_match(str.begin(), str.end(), rx))
{ 
cout<<"True"<<endl;
}
else
cout<<"False"<<endl;
return(0);
} 
```

我的程序返回了 false ...（因为表达式不完全匹配）我还通过使其匹配来重新检查它......它可以工作。现在我正在编写另一个程序来实现 regex_replace 和 regex_search 。两者都不起作用（对于 regex_search，只需将上述程序中的 regex_match 替换为 regex_search。请帮助。我不知道我哪里出错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:57:27.727

`<regex>`GCC 不完全支持标头。

[您可以在此处](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/libstdc++/manual/manual/status.html#status.iso.2011)查看 GCC 支持。

# mongodb - 查询 mongodb 还是字段？

> ID：14115382
> 
> 赞同：0
> 
> 时间：2013-01-01T23:54:56.493
> 
> 标签：mongodb

如何使用或在两个不同的字段上查询 mongodb。

例如我想要`{ fieldA : true }`，或`{fieldB : true}`。其中任何一个都行得通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:57:42.517

使用[`$or`](http://docs.mongodb.org/manual/reference/operators/#_S_or)运算符：

```
db.test.find({ $or: [{fieldA : true}, {fieldB : true}]}) 
```

# bash - 动态识别 Jenkins 构建

> ID：14115385
> 
> 赞同：0
> 
> 时间：2013-01-01T23:55:10.343
> 
> 标签：bash, build, jenkins, continuous-integration

目前，我正在通过从 shell 脚本向 Jenkins 发布一些参数来启动构建。我需要检查构建是成功还是失败，并且我想避免使用构建后的 Jenkins 脚本调用（我不希望 Jenkins 在我的服务器上启动任何脚本的运行），所以我的想法是发布到 Jenkins每 10 秒左右（在构建时！= false）以获取具有各种构建参数的 JSON 对象。虽然如果我知道要检查的构建号，这可以正常工作，但我似乎看不到动态跟踪当前构建号并确保我的脚本正在检查构建的好方法刚刚启动，而不是当前正在运行的其他构建。

潜在地，可能会在短时间内启动多个构建，因此`jenkins/job/my_build_job/lastBuild/api/json`在开始构建后发布并检查数字似乎不适合考虑到比赛情况的问题。

如何从服务器上的脚本动态跟踪特定构建，以检查从调用的帖子发起的构建的构建成功或失败`cron`？是否有办法命名构建，以便我可以启动它`BUILD_NAME`然后发布到`jenkins/job/my_build_job/BUILD_NAME/api/json`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T07:47:09.527

Jenkins 中已经存在一个问题，以在 Jenkins 远程 API 调用中返回内部版本号：[https](https://issues.jenkins-ci.org/browse/JENKINS-12827) ://issues.jenkins-ci.org/browse/JENKINS-12827 。请在此处添加评论，以便尽快处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:05:42.503

您可以进行几种不同的 API 调用：

```
jenkins/job/my_build_job/api/json?tree=lastBuild[number] 
```

将为您提供最后完成的构建或正在进行的当前构建

```
jenkins/job/my_build_job/api/json?tree=nextBuildNumber 
```

将为您提供下一个构建号 - 这包括排队等待资源的构建。

# ios - 包含包含字典的数组的文件

> ID：14115387
> 
> 赞同：1
> 
> 时间：2013-01-01T23:55:37.847
> 
> 标签：ios, xml, nsmutablearray, nsdictionary, nsmutabledictionary

我有一个包含字典数组的文件。如何将其读回以将其用作在我的代码中包含这些字典的常规数组？

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
    <dict>
        <key>elem1</key>
        <string>Hello world</string>
        <key>elem2</key>
        <string>This is some string</string>
    </dict>
</array>
</plist> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:28:55.037

这实际上是相当简单的。感谢[H2CO3](https://stackoverflow.com/users/529758/h2co3)指向它。只需使用 [NSArray arrayWithContentsOfFile:] 方法。所以这就是我所拥有的：

```
// Path to my file
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString  *filePath = [[paths objectAtIndex:0] stringByAppendingPathComponent:@"my_file.out"];

// Get the array contained in the file
NSMutableArray *myArray = [NSMutableArray arrayWithContentsOfFile:filePath];

// Read the array's content
int numOfelems = [myArray count];
for (int i = 0; i < numOfelems; i++) {
    NSLog(@"Object at index %i: %@", i, [myArray objectAtIndex:i]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T00:31:49.087

这很简单：可以在一行中解析属性列表...

```
NSArray *array = [NSArray arrayWithContentsOfFile:pathToPLIST]; 
```

# objective-c - Objective-C 无法在 Game Center 中调用函数

> ID：14115392
> 
> 赞同：0
> 
> 时间：2013-01-01T23:56:06.960
> 
> 标签：objective-c, ios, call, game-center

我正在做一场噩梦，试图通过 Game Center 实现让两个玩家在我的 iPhone 应用程序上互相对战的能力。

我只是想从我拥有的不同 .m 文件中访问 GameCenterManager.m 中的函数。在我的 racetohundredViewController.h 文件中，我有：

```
#import <UIKit/UIKit.h>
#import "startPage.h"
#import "GameCenterManager.h"
#import <GameKit/GameKit.h>

@interface racetohundredViewController : UIViewController <UIActionSheetDelegate,     GKLeaderboardViewControllerDelegate, GameCenterManagerDelegate>

{
    GameCenterManager *gcManager;
    BOOL gameIsMultiplayer;
    double randomHostNumber;
}
@property (retain, nonatomic) GameCenterManager *gcManager; 
```

在我相应的 .m 文件中，我有：

```
@interface racetohundredViewController ()
@end

@implementation racetohundredViewController
@synthesize gcManager;

- (void)generateAndSendHostNumber;
{
    NSLog(@"Generate and send host number");
    randomHostNumber = arc4random();
    NSString *randomNumberString = [NSString stringWithFormat: @"$Host:%f", randomHostNumber];
    NSLog(@"the random number string is: %@", randomNumberString);
    [self.gcManager testString];
    [self.gcManager sendStringToAllPeers:randomNumberString reliable: YES];
}

- (void)viewDidLoad
{
[self generateAndSendHostNumber];
} 
```

这是 [self.gcManager testString]; 和 [self.gcManager sendStringToAllPeers:randomNumberString 可靠：YES]；没有被调用。他们以前，我显然以某种方式搞砸了。我可以看到随机数字符串的 NSLog。

在我的 GameCenterManager.h 文件中（包括一些与此问题无关的位）：

```
#import <Foundation/Foundation.h>
#import <GameKit/GameKit.h>

@class GKLeaderboard, GKAchievement, GKPlayer;
@protocol GameCenterManagerDelegate <NSObject>
@optional
- (void) processGameCenterAuthentication: (NSError*) error;
- (void) scoreReported: (NSError*) error;
- (void) reloadScoresComplete: (GKLeaderboard*) leaderBoard error: (NSError*) error;
- (void) achievementSubmitted: (GKAchievement*) ach error:(NSError*) error;
- (void) achievementResetResult: (NSError*) error;
- (void) mappedPlayerIDToPlayer: (GKPlayer*) player error: (NSError*) error;
- (void) receivedData:(NSDictionary *)dataDictionary;
@end

@interface GameCenterManager : NSObject <GameCenterManagerDelegate>
{
    id <GameCenterManagerDelegate, NSObject> delegate;
    NSMutableDictionary* earnedAchievementCache;
    id matchOrSession;
}

//This property must be atomic to ensure that the cache is always in a viable state...
@property (retain) NSMutableDictionary* earnedAchievementCache;
@property (nonatomic, strong) id <GameCenterManagerDelegate, NSObject> delegate;
@property(nonatomic, strong) id matchOrSession;

+ (BOOL) isGameCenterAvailable;
- (void) authenticateLocalUser;
- (void)sendStringToAllPeers:(NSString *)dataString reliable:(BOOL)reliable;
- (void)sendString:(NSString *)dataString toPeers:(id)peers reliable: (BOOL)reliable;
-(void)testString; 
```

最后是 GameCenterManager 的 .m 文件的精简版：

```
#import "GameCenterManager.h"
#import <GameKit/GameKit.h>
@implementation GameCenterManager
@synthesize earnedAchievementCache;
@synthesize delegate;
@synthesize matchOrSession;

-(void)testString
{
    NSLog(@"THIS IS A TEST");
} 
```

我也可以发布有关 sendString 的代码，但原则是即使使用基本的 testString 函数，它也不会调用它。

我在这里遗漏了一些非常明显的东西吗？似乎当我单步执行代码时，它会突出显示 GameCenterManager 的 .h 文件中的函数，但它不会按照我的要求显示 NSLog。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T00:34:11.040

我最好的猜测`self.gcManager`是`nil`。你在哪里实例化你的`GameCenterManager`？

# ios - 如何防止用户将 UITableViewCell 移动到特定位置？

> ID：14115393
> 
> 赞同：0
> 
> 时间：2013-01-01T23:56:22.257
> 
> 标签：ios, uitableview

在我的 TableView 中，底部单元格有一个“添加单元格”按钮，用于......好吧，添加单元格。但是，如果用户通过将正常的信息单元格移动到最后一个位置来重新排序 tableivew，则应用程序会崩溃，从而使“添加单元格”：单元格位于最后一个位置。

我能够使用 tableView:canEditRowAtIndexPath: 阻止移动“添加单元格”单元格。我需要类似 tableView:canMoveRowAtIndexPath 的东西，但我只想在他们尝试将其移动到最后一个位置时停止移动。理想情况下，我需要一个假设的消息，例如 tableView:canMoveRowAtIndexPath:toIndexPath。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:58:54.383

我认为您可以通过[`tableView:targetIndexPathForMoveFromRowAtIndexPath:toProposedIndexPath:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40006942-CH3-SW9)在表视图的委托中实现来做到这一点。使该方法返回一个索引路径，该路径的行号低于“添加单元格”行。

# ruby-on-rails - 被重定向到 users/sign_in

> ID：14115395
> 
> 赞同：0
> 
> 时间：2013-01-01T23:56:32.820
> 
> 标签：ruby-on-rails, redirect

我有一个工人控制器。

如果我注销，我将被重定向到：`localhost:3000`. 我想被重定向到我设计的登录。

这是我的`rake routes`：

```
users_sign_out           GET    /users/sign_out(.:format)       devise/sessions#destroy
new_user_session         GET    /users/sign_in(.:format)        devise/sessions#new
user_session             POST   /users/sign_in(.:format)        devise/sessions#create
destroy_user_session     DELETE /users/sign_out(.:format)       devise/sessions#destroy
user_password            POST   /users/password(.:format)       devise/passwords#create
new_user_password        GET    /users/password/new(.:format)   devise/passwords#new
edit_user_password       GET    /users/password/edit(.:format)  devise/passwords#edit
                         PUT    /users/password(.:format)       devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)         devise/registrations#cancel
user_registration        POST   /users(.:format)                devise/registrations#create
new_user_registration    GET    /users/sign_up(.:format)        devise/registrations#new
edit_user_registration   GET    /users/edit(.:format)           devise/registrations#edit
                         PUT    /users(.:format)                devise/registrations#update
                         DELETE /users(.:format)                devise/registrations#destroy 
```

这是我的`routes.rb`：

```
devise_for :users do get '/users/sign_out' => 'devise/sessions#destroy' end
resources :tasksadmins
resources :workers
root to: "devise/registrations#create" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:11:50.350

它在设计 wiki 中指定。

[https://github.com/plataformatec/devise/wiki/How-To:-Change-the-redirect-path-after-destroying-a-session-ie-signing-out](https://github.com/plataformatec/devise/wiki/How-To:-Change-the-redirect-path-after-destroying-a-session-i.e.-signing-out)

```
class ApplicationController < ActionController::Base
  private

  # Overwriting the sign_out redirect path method
  def after_sign_out_path_for(resource_or_scope)
    new_user_session_path
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T00:12:56.033

您可以在应用程序控制器中覆盖[after_sign_out_path_for助手。](http://rubydoc.info/github/plataformatec/devise/master/Devise/Controllers/Helpers#after_sign_out_path_for-instance_method)

```
def after_sign_out_path_for(resource_or_scope)
  # logic here
end 
```

# javascript - 可以引用画布 2d 上下文吗？

> ID：14115396
> 
> 赞同：2
> 
> 时间：2013-01-01T23:56:36.050
> 
> 标签：javascript, canvas, html5-canvas

可以对画布上下文（通过 获得）进行长期引用`getContext('2d')`吗？特别是，如果调整画布元素的大小，是否会出现问题？如果有问题，使用从单独的画布节点（如[本线程](https://stackoverflow.com/questions/3892010/create-2d-context-without-canvas)中所述）获得的上下文而不是从 DOM 派生的上下文是否会改善问题？

问题的原因是，我需要在幕后进行大量文本度量计算，并且我认为保持对上下文的引用将是做到这一点的好方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T12:37:32.953

在存储对上下文的引用时，我从来没有遇到过任何问题。调整画布大小不会影响它。

Spec 似乎没有在[调整部分](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#concept-canvas-set-bitmap-dimensions)中提到任何关于新上下文的内容。

但是，以防万一，我会仔细查看[setContext section 。](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-canvas-setcontext)

# rest - CouchDB 中的并行/冗余复制

> ID：14115398
> 
> 赞同：7
> 
> 时间：2013-01-01T23:56:47.257
> 
> 标签：rest, synchronization, couchdb, replication, database-replication

我有多个 CouchDB 服务器，我希望彼此保持同步，并且我使用这些服务器来共享大文件（例如 >100 MB）。为了使它们保持同步，我让每个 CouchDB 实例从彼此的实例中连续提取复制。

这是一个示例：我有三个 CouchDB 服务器 A、B 和 C，它们都具有彼此之间的持续拉取复制，如下所示：

```
------- <------------- -------
|  A  | -------------> |  B  |
-------                -------
  ^ |                   | ^
  | |                   | |
  | V                   | |
------- <---------------- |
|  C  | -------------------
------- 
```

有人将带有 500MB 附件的文档上传到服务器 A。B 和 C 都开始从 A 复制文档，并且 B 在 C 之前完成复制：

```
-------    doc         -------
|  A  |--------------->|  B  |
-------                -------
   |
   | doc
   V
-------
|  C  |
------- 
```

我的问题是，**C 是否会开始从 B 复制相同的文档**（因为 C 也从 B 连续提取复制），**而它仍在从 A 传输文档？**

```
-------                -------
|  A  |                |  B  |
-------                -------
   |          doc         |
doc|    |------------------
   |    |
   V    V
  -------
  |  C  |
  ------- 
```

我猜这会发生，因为 AFAIK，CouchDB 复制实际上并没有将复制的文档存储到目标（使用 _bulk_docs API），直到文档（包括附件）已从源 [1] 完全获取。我担心这种情况会发生，因为这将是多余的并且会浪费大量带宽。

[1] [https://github.com/couchbaselabs/TouchDB-iOS/wiki/Replication-Algorithm](https://github.com/couchbaselabs/TouchDB-iOS/wiki/Replication-Algorithm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-23T15:34:53.773

根据[最近关于 CouchDB users@ 列表](http://markmail.org/search/list%3aorg.apache.couchdb.user+What%27s+Better+1+Doc+With+Many+Attachments+or+Many+Docs+With+1+Attachment)的讨论和[描述复制算法](https://github.com/benoitc/couchdb_internals/blob/master/couchdb_replication.md#algorithm)的文档，复制知道目标上已经存在哪个附件。但是，如果附件非常大，并且两端在其中任何一个完成之前开始复制，则附件将被传输多次。

# java - 在 java 中对 call ambiguous 的引用

> ID：14115408
> 
> 赞同：1
> 
> 时间：2013-01-01T19:23:32.823
> 
> 标签：java

```
class A {

    public void printFirst(int... va) throws IOException{
        System.out.print("A");
    }

    public static void main(String args[]) {
        try {
            new B().printFirst(2);
        } catch (Exception ex) {
        }
    }
}

class B extends A {

    //@Override
    public void printFirst(float... va) throws IOException{
        System.out.print("B");

    }
} 
```

为什么，它显示**了对 call ambiguous 的引用**？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T20:10:04.867

如果您删除可变参数符号，它实际上会编译。文字`2`应该被认为是`int`a ，而不是 a `float`，所以我希望编译器会选择 A 中的 printFirst 。

看起来这与编译器如何进行方法调用转换有关。[这个 SO question](https://stackoverflow.com/questions/12879910/varargs-in-method-overloading-in-java)说它在规范中，但是与这个问题相关的已接受答案的部分似乎是矛盾的（它说你不能将扩大转换（int to float）与可变参数结合起来，但后来它说这是好的）。[在这个问题](https://stackoverflow.com/questions/2521293/bug-with-varargs-and-overloading)中讨论了一个类似的问题，并且接受的答案得出结论认为这种情况实际上是未指定的（不幸的是，讨论的链接现在已断开）。更糟糕的是，语言指南只是建议[避免这种类型的重载](http://docs.oracle.com/javase/6/docs/technotes/guides/language/varargs.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:39:16.963

这似乎是您的编译器中的一个错误；我可以在一个编译器（Eclipse）中重现您的编译错误，但不能在另一个（`javac`）中重现，我相信后者是正确的。

根据[§15.12.2.5 "Choosing the Most Specific Method" of *The Java Language Specification* , Java SE 7 Edition](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12.2.5)，您看到的编译错误应该只发生在“没有最具体的方法，因为有两个或更多最具体的方法”（加上各种其他限制）。但这里的情况并非如此：在你的情况下，*不是*`B.printFirst(float...)`最具体的，因为一个方法是*最具体*的“如果它是可访问和适用的，并且没有其他适用和可访问的方法更具体”，并且在你的case,严格来说更具体，因为它是 的子类型，而不是 的子类型。**`A.printFirst(int...)``int``float``float``int`**

 **顺便说一句，您`class B`很可能是红鲱鱼；至少在 Eclipse 中，您可以通过简单地编写来触发相同的编译错误：

```
class A
{
    public static void printFirst(float... va)
        { System.out.print("float..."); }
    public static void printFirst(int... va)
        { System.out.print("int..."); }
    public static void main(String args[])
       { printFirst(2); }
} 
```**

# powershell - 从 PowerShell 调用 Windows 运行时类

> ID：14115415
> 
> 赞同：6
> 
> 时间：2013-01-01T23:59:14.747
> 
> 标签：powershell, windows-runtime

有没有办法从 PowerShell 脚本调用 Windows 运行时 (WinRT) 类（或对象）？我知道你可以调用 COM 对象，WinRT 类应该被“公开”为......但到目前为止我的尝试都失败了......

这是我正在尝试的代码：

```
$lockscreen = New-Object -comObject Windows.System.UserProfile.LockScreen 
```

这给了我以下错误：

```
New-Object : Retrieving the COM class factory for component with CLSID {00000000-0000-0000-0000-000000000000} failed
due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)). 
```

有谁知道我应该用于 WinRT 类的正确“COM 类”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T07:21:24.640

这是一些似乎有效的hacky：

```
PS> new-object "Windows.System.UserProfile.LockScreen,Windows.System.UserProfile,ContentType=WindowsRuntime"
new-object : Constructor not found. Cannot find an appropriate constructor for type
Windows.System.UserProfile.LockScreen,Windows.System.UserProfile,ContentType=WindowsRuntime.
At line:1 char:1
+ new-object "Windows.System.UserProfile.LockScreen,Windows.System.UserProfile,Con ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (:) [New-Object], PSArgumentException
    + FullyQualifiedErrorId : CannotFindAppropriateCtor,Microsoft.PowerShell.Commands.NewObjectCommand

PS> [Windows.System.UserProfile.LockScreen]::OriginalImageFile

AbsolutePath   : C:/Windows/Web/Screen/img100.png
AbsoluteUri    : file:///C:/Windows/Web/Screen/img100.png
LocalPath      : C:\Windows\Web\Screen\img100.png
Authority      :
HostNameType   : Basic
IsDefaultPort  : True
IsFile         : True
IsLoopback     : True
PathAndQuery   : C:/Windows/Web/Screen/img100.png
... 
```

请注意，第一次调用失败是因为 LockScreen 没有构造函数，但该调用会拉入 WinRT 投影/元数据，因此您现在可以调用 LockScreen 类上的静态方法/属性。

**免责声明：**我找不到任何有关此 New-Object 语法的文档，因此考虑到它本质上是一个“隐藏”且可能未完全开发的功能，微软完全有可能对其进行更改。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-06T20:24:07.723

只需引用类型，即可“加载”程序集...

```
[Windows.System.UserProfile.LockScreen,Windows.System.UserProfile,ContentType=WindowsRuntime]
[Windows.System.UserProfile.LockScreen]::OriginalImageFile 
```

如果您不希望在 powershell 结果中返回类型，那么

```
$null = [Windows.System.UserProfile.LockScreen,Windows.System.UserProfile,ContentType=WindowsRuntime] 
```

# android - 触摸事件的 webkitForce 属性：手指压力反馈。寻找文档

> ID：14115416
> 
> 赞同：4
> 
> 时间：2013-01-01T23:59:15.927
> 
> 标签：android, html, google-chrome, webkit, touch

我正在对我的 Nexus 7 平板电脑的“Chrome”浏览器进行一些测试，并`webkitForce`在触摸事件提供的触摸对象中发现了奇怪的属性。

果然，它似乎是一个通常设置在大约 0.05 和大约 1.2 之间的标量，它似乎与电容式触摸屏上的*手指压力成比例。*它适用于多个同时触摸；我有一个测试页面，它画出了缩放到这个值的圆圈，它与手指压力/位置的相关性很好，为每次触摸提供了一个 3 维量。

当改变一根手指上的压力影响为在任一轴上靠近它的另一根手指提供的读数时，可能会出现一些轻微的不一致。这似乎是实际电容式触摸硬件或处理其输出的软件的限制的结果。

我用谷歌搜索了这个，几乎一无所获。谷歌没有任何类型的网站（我可以通过搜索引擎找到）记录这一点，这真的很奇怪。

所以我的问题是我在哪里可以找到关于这个简洁的小功能的更多信息？为什么 iOS 设备（可以说是响应速度更快、功能更强大的触摸屏）没有提供这种功能？哪些 Android 设备和操作系统/浏览器组合提供此功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T03:51:40.647

`.force`是触摸事件 v2 规范的一部分：http: [//dvcs.w3.org/hg/webevents/raw-file/default/touchevents.html#widl-Touch-force](http://dvcs.w3.org/hg/webevents/raw-file/default/touchevents.html#widl-Touch-force)

> 施加的压力的相对值，范围为0到1，其中0为无压力，1为触摸设备能够感应的最高压力水平；如果没有已知值，则为 0。在力已知的环境中，由力属性表示的绝对压力和压力水平的灵敏度可能会有所不同。

# c# - 在 WPF 中设置和删除工具提示

> ID：14115424
> 
> 赞同：2
> 
> 时间：2013-01-02T00:01:00.877
> 
> 标签：c#, .net, wpf

我有一个我无法弄清楚的问题。

我有一个 WPF 窗口，它表示 POS 应用程序中使用的物理键盘。每个物理按钮都由一个 WPF 按钮表示。用户将单击一个按钮，该按钮将打开另一个带有控件的窗口，以更改分配给它的功能。当用户将鼠标悬停在按钮上时，会显示一个工具提示，显示当前分配的功能。

设置好新设置后，我需要刷新工具提示。新工具提示正确显示，但旧工具提示不会删除。如果我使用`Button.ToolTip = null`，所有工具提示都会消失。如果我使用`Button.ToolTip = String.Empty`，我会得到一个空白的提示。如果没有为按钮分配功能，我不希望显示任何工具提示。

当没有可显示的内容时，如何简单地删除/停用工具提示？

loadToolTips() 在父窗口中的 Window_Activated 事件期间触发。

代码：

```
private void loadToolTips()
        {
            JPOSDB db = new JPOSDB();
            SqlDataReader dr = default(SqlDataReader);
            StringBuilder tt = new StringBuilder();

            dr = db.getDR("SELECT KeyName, FunctionName, Parameter1, Parameter2 FROM KeyboardSettings JOIN KeyboardFunctions ON KeySetting = FunctionID WHERE KeyboardID = " + runTime.keyboardID);

            while (dr.Read())
            {
                foreach (Control ctrl in grdButtons.Children)
                {
                    if (ctrl.GetType() == typeof(Button))
                    {
                        Button button = new Button();
                        button = (Button)ctrl;
                        button.ToolTip = null;   <--- Causes all tool tips to disappear

                        if (button.Name.ToString() == dr[0].ToString())
                        {
                            tt.Clear();
                            tt.Append("Function: " + dr[1].ToString());

                            if (dr[2].ToString().Length > 0)
                            {
                                tt.Append(Environment.NewLine);
                                tt.Append("Value: " + dr[2].ToString());
                            }

                            if (dr[3].ToString().Length > 0)
                            {
                                tt.Append(Environment.NewLine);
                                tt.Append("Name: " + dr[3].ToString());
                            }

                            button.ToolTip = tt.ToString();                    
                        }
                    }
                }
            }

            dr.Close();
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:59:54.633

您可以使用[`ClearValue`](http://msdn.microsoft.com/en-us/library/ms597464%28v=vs.110%29.aspx)清除依赖工具提示属性。看看这是否有帮助。

```
 Button button = (Button)ctrl;
 button.ClearValue(Button.ToolTipProperty); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:23:30.230

我不确定我是否理解这个问题，但你可以使用这一行：

```
var s = tt.ToString();
button.ToolTip = string.IsNullOrEmpty(s) ? null : s; 
```

如果这不能回答您的问题，请发表评论，我会删除它。

# php - 计算一个变量

> ID：14115425
> 
> 赞同：-5
> 
> 时间：2013-01-02T00:01:01.010
> 
> 标签：php, string, csv, count

> **可能重复：**
> [为什么 PHP 不替换字符串中的变量？](https://stackoverflow.com/questions/11317743/why-is-php-not-replacing-the-variable-in-string)

我似乎无法做到这一点，我想对 CSV 中的行进行行数，并且 CSV 取自页面的 URL，即它是一个查询字符串。

```
$file= $_GET['file'];
$linecount = count(file(' $file ')) -1; 
```

基本上第一个函数是从 URL 中的查询字符串中获取文件的 URL，然后第二个函数是计算 CSV 中的行数。请帮助，将不胜感激。

另请注意，-1 是跳过 CSV 的第一行，因为那是所有标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:24:38.473

单引号中的变量不会扩展，因此您的代码实际上是在寻找一个名为`' $file '`. 只要去做`var_dump(' $file ');`，你就会明白我的意思。然后用双引号尝试相同的操作。但我认为你根本不需要引号——`count(file($file)) -1`

您需要做的是`$_GET`在加载之前验证该参数。你所拥有的只是对我尖叫“本地文件包含”。

[http://hakipedia.com/index.php/Local_File_Inclusion](http://hakipedia.com/index.php/Local_File_Inclusion)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:07:49.353

```
$file = $_GET['file'];
$linecount = count(file($file)) - 1; 
```

# android - Android 小部件与服务的交互

> ID：14115427
> 
> 赞同：1
> 
> 时间：2013-01-02T00:01:23.950
> 
> 标签：android, service, widget, onclick, interaction

2013 年大家好！

我有以下安卓挑战：

假设我有一个由活动和小部件组成的应用程序。这两个都提供尽可能实际的相同信息 - 因此，如果可能，我有一个服务挖掘请求的数据并将消息对象发送到活动或小部件的处理程序。我可以接受它会导致大量电池消耗等等，这不是问题。

小部件有三种可能的布局。当前布局是动态确定的（取决于来自服务的数据）并通过远程视图设置。

现在我的问题：我希望能够通过点击小部件来打开/关闭服务。我已经将 PendingIntent 实现为 onClickPendingIntent （可能名称不同，没关系）和 onReceive 方法来处理这个。它工作得很好，但只有一段时间。创建小部件后，我可以通过点击小部件来触发意图。但是几分钟后（不确定）它什么也没做，并且意图不再被 onReceive 捕获。我在日志中发现，在它停止响应我的事件之前，小部件中收到了一个意图 ACTION_READY 意图。有什么方法可以设置小部件随时听我的触摸吗？

我对小部件僵尸有另一个问题。我试图用谷歌搜索一些关于小部件的文档，但没有找到任何合适的文档。如果系统决定终止我的进程，屏幕上仍然会挂着死掉的小部件 UI。它没有响应任何手势，我猜它也没有处理任何消息。是否有机会以编程方式唤醒此小部件（例如从服务中）？

如果有人帮助我，我将在两周内过第二个圣诞节。非常感谢！

# codeigniter - 如何使用层次结构构建 CodeIgniter URL？

> ID：14115429
> 
> 赞同：3
> 
> 时间：2013-01-02T00:01:34.030
> 
> 标签：codeigniter, hierarchy, codeigniter-url

我知道这与 www.example.com/class/function/ID/ 的形式不完全匹配，但我想向用户显示的内容会更有意义。

这就是我想做的：

`www.example.com/project/id/item/item_id/`

所以，一个例子是：

`www.example.com/project/5/item/198237/`

这将是行为：

*   www.example.com/project/ --> 这将显示项目列表（当前实现）
*   www.example.com/project/5/ --> 这将显示项目 5 的项目列表（当前实施）
*   www.example.com/project/5/item/ --> 这与上面的行并没有什么不同。（那不好吗？）
*   www.example.com/project/5/item/198237/ --> 这将显示项目 198237 的详细信息。

因此，每个项目都直接与一个且只有一个项目相关联。

我能想到的唯一方法是膨胀“项目”控制器并解析各种参数并控制来自该“项目”控制器的所有视图。我不想这样做，因为“项目”的模型和视图与“项目”的模型和视图真正分开。

唯一的其他解决方案（我目前正在实施但不喜欢）是具有以下内容：

www.example.com/project/5/ www.example.com/item/198237/

有没有什么方法可以构建一个分层 URL，就像我在开始时展示的那样，而不会使“项目”控制器膨胀？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T08:27:28.780

有 3 个选项，按实用程度排序：

*   使用 URI 路由。定义一个正则表达式，它将为每个 URL 使用特定的控制器/方法组合。

类似的东西可以帮助你，在`routes.php`：

```
$route['project/'] = 'project/viewall';
$route['project/(.+)'] = 'project/view/$1';
$route['project/(.+)/item/'] = 'project/view/$1';
$route['project/(.+)/item/(.+)'] = 'item/view/$2'; 
```

也就是说，考虑到您的控制器分别是项目和项目。另请注意，`$n`该值对应于第 n 个括号中匹配的部分。

*   使用带（或不带）重定向的相同控制器。我想你已经考虑过了。
*   在较低级别使用重定向，例如`ModRewrite`在 Apache 服务器上。你可以想出一个类似的规则`routes.php`。如果您已经在使用这种方法，那么使用它并不是一个坏主意，但前提是您已经在使用这种方法，并且最好在 Apache 的情况下，在服务器配置中而不是在`.htaccess`文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T07:31:43.060

[您可以使用routes.php](http://ellislab.com/codeigniter/user-guide/general/routing.html)（位于 config 文件夹中）控制所有这些选项。您也可以使用 URI 类捕获任何 URI 段，如`$this->uri->segment(2)`. 也就是说，如果您加载了 URL 帮助程序。您可以默认加载到 autoload.php 文件中（也在 config 文件夹中）。

# android - Android：注册另一个活动的 onstop

> ID：14115431
> 
> 赞同：0
> 
> 时间：2013-01-02T00:01:52.810
> 
> 标签：android, events, broadcastreceiver, android-activity

任何人都知道我是否可以在另一个类/对象中接收我的主要活动的 onStop、onPause 和 onResume 回调？

我有一个广播接收器，它位于另一个类（WebView）中。我使用接收器来检测网络何时出现故障并切换到包含一些有用内容的页面的本地副本。我需要在调用 onStop/onPause 时取消注册广播接收器，并在 onResume 期间重新注册它。

我可以手动完成（我在扩展 WebView 的类中添加了几个公共方法来做到这一点），但最好让 Android 为我调用它。

编辑：当然，这是课程，我希望它能够在调用我的主要活动的 onStop 时接收来自 Android 的回调，而无需调用 startInternetMonitoring() / stopInternetMonitoring()：

```
 package com.glimmersoft.spent;

    import android.content.BroadcastReceiver;
    import android.content.Context;
    import android.content.Intent;
    import android.content.IntentFilter;
    import android.content.res.Resources;
    import android.net.ConnectivityManager;
    import android.util.AttributeSet;
    import android.util.Log;
    import android.webkit.WebSettings;
    import android.webkit.WebView;

    /**
     * @author Jer
     *
     */
    public class OfflineWebView extends WebView {

        private BroadcastReceiver receiver;
        private IntentFilter filter;
        private Context myContext;

        public OfflineWebView(Context context,AttributeSet attrs) {
            super(context, attrs);
            WebSettings webSettings = this.getSettings();
            webSettings.setJavaScriptEnabled(true);
            myContext = context;

        }//END CLASS CONSTRUCTTOR

        /**
         * @param internetOn        The URL to display in this OfflineWebView when there is an active Internet connection.
         * @param internetOff       The URL to display in this OfflineWebView if there is no active Internet connection.
         */
        public void setPages(final String internetOn, final String internetOff){

            final OfflineWebView finalThisRef = this;

            filter = new IntentFilter();
            filter.addAction(SpendConstants.ANDROID_CONNECTIVITY_CHANGED);

            receiver = new BroadcastReceiver() {
                @Override
                public void onReceive(Context context, Intent intent) {
                   ConnectivityManager cm=(ConnectivityManager)  context.getSystemService(Context.CONNECTIVITY_SERVICE);

                   if(cm.getActiveNetworkInfo()!=null&&cm.getActiveNetworkInfo().isConnected()){// TODO: THIS FAILES IF 

                            finalThisRef.loadUrl(internetOn);

                       }else{                      
                            finalThisRef.loadUrl(internetOff);
                       }
                   }//END IF/ELSE

              };

              myContext.registerReceiver(receiver, filter);

        }//END FUNCTION SETPAGES

        public void startInternetMonitoring(){      
            myContext.registerReceiver(receiver, filter);       
        }//END METHOD STARTINTERNETMONITORING

        public void stopInternetMonitoring(){
            myContext.unregisterReceiver(receiver);
        }//END METHOD STOPINTERNETMONITORING

    }//END CLASS OfflineWebView 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T02:38:24.810

与其将您的 BroadcastReceiver 放在您的 OfflineWebView 中，不如让它成为您可能在基本 Activity 中注册的静态类，并让它持有对您的 OfflineWebView 的引用。当 onReceive 被调用时，您可以参考您的 OfflineWebView 来加载您的在线/离线内容。

文件：MyBaseActivity.java

```
import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.net.ConnectivityManager;
import android.webkit.WebView;

public class MyBaseActivity extends Activity {

    private static final String ANDROID_CONNECTIVITY_CHANGED = "android.net.conn.CONNECTIVITY_CHANGE";
    protected static final ConnectivityBroadcastReceiver sReceiver = new ConnectivityBroadcastReceiver();
    private static final IntentFilter sFilter = new IntentFilter(ANDROID_CONNECTIVITY_CHANGED);

    static class ConnectivityBroadcastReceiver extends BroadcastReceiver {

        private String internetOnUrl = "your online url";
        private String internetOffUrl = "your offline url";
        WebView offlineWebView;

        @Override
        public void onReceive(Context context, Intent intent) {
            ConnectivityManager cm = (ConnectivityManager) context
                    .getSystemService(Context.CONNECTIVITY_SERVICE);

            // only do your online/offline loading if we have a webview set
            if (offlineWebView != null) {

                if (cm.getActiveNetworkInfo() != null
                        && cm.getActiveNetworkInfo().isConnected()) {
                    offlineWebView.loadUrl(internetOnUrl);
                } else {
                    offlineWebView.loadUrl(internetOffUrl);
                }
            }
        }
    }

    @Override
    public void onStart() {
        super.onStart();
        // register receiver
        registerReceiver(sReceiver, sFilter);
    }

    @Override
    public void onStop() {
        super.onStop();
        // unregister receiver
        unregisterReceiver(sReceiver);
    }
} 
```

文件：MyActivity.java

```
import android.R;
import android.os.Bundle;
import android.webkit.WebView;

public class MyActivity extends MyBaseActivity {

    private WebView mWebView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // load your content root
        setContentView(R.layout.main_layout);

        // find your webview
        mWebView = (WebView)findViewById(R.id.webView);
    }

    @Override
    public void onStart() {
        super.onStart();
        // set your webview in the OfflineBroadcastReceiver
        sReceiver.offlineWebView = mWebView;
    }

    @Override
    public void onStop() {
        super.onStop();
        // clear your webview from the OfflineBroadcastReceiver
        sReceiver.offlineWebView = null;
    }
} 
```

# windows-8 - CurrentAppSimulator.LicenseInformation 在 Windows 商店应用程序中获取异常“超出配额”

> ID：14115434
> 
> 赞同：2
> 
> 时间：2013-01-02T00:02:29.210
> 
> 标签：windows-8, licensing, windows-store-apps

在我的 Windows Store App 中，当我尝试访问时引发以下异常 `CurrentAppSimulator.LicenseInformation`

*“超出配额。（HRESULT 异常：0x803D0008）”*

我已经尝试创建一个新的解决方案并将所有代码文件复制到它，但仍然得到相同的错误，我在 MSDN 或谷歌搜索上没有找到任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T15:16:17.603

从这里的答案[和](http://social.msdn.microsoft.com/Forums/en/wwsapi/thread/800c61f6-0e14-4a1c-bb8d-0e14761ddcdb)[这里](http://social.msdn.microsoft.com/Forums/en-US/wwsapi/thread/765a4e93-e2c0-4a24-82c1-f86384493c14)的另一个答案来看，我会说你在某处超出了内存限制。链接的问题/答案表明“超出了配额”表示您用完了整个堆或您的消息缓冲区不够大。

此外，一些用户表示，当他们的开发人员许可证过期时，他们会收到该错误，并且必须重新安装 Windows 8 才能解决该问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T23:21:02.830

在谷歌搜索的帮助下，我发现从 Windows 开始屏幕卸载应用程序似乎有帮助。

当您调试您的应用程序似乎已安装并出现在开始屏幕上时，过去我只是忽略了这个事实。在卸载应用程序并再次调试后，我能够克服该错误并能够看到正在发生的真正的潜在错误。我不确定这些潜在错误与我们在这里讨论的错误之间的关系，我怀疑它们没有直接关系。

# php - 使用 $_SERVER HTTP REFER 链接回上一页？

> ID：14115435
> 
> 赞同：-2
> 
> 时间：2013-01-02T00:02:35.783
> 
> 标签：php, hyperlink

> **可能重复：**
> [如何在 PHP 页面上创建“返回”链接？](https://stackoverflow.com/questions/4851714/how-can-i-do-a-back-link-on-php-pages)

有人可以告诉我哪里出错了。我有一个可以从各个页面访问到另一个页面的链接，一旦用户在该页面上完成，他们可以单击一个链接“返回”，这应该将他们带到他们所在的上一个页面。

我正在尝试使用以下代码，但它不会响应，不会链接到任何地方，只会停留在当前页面上。

如果有人可以提供一种方法来做我正在努力实现的目标，那就太感谢了。

```
<a href="<?php $_SERVER['HTTP_REFERER'] ?>"><< Back</a> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T00:05:11.190

你需要`echo`结果。

```
<a href="<?php echo $_SERVER['HTTP_REFERER']; ?>"><< Back</a> 
```

否则，PHP 将不会打印任何内容。

# java - 如何将变量用于 junit @Test 的“预期”属性？

> ID：14115439
> 
> 赞同：1
> 
> 时间：2013-01-02T00:03:14.683
> 
> 标签：java, generics, junit

我正在尝试编写一个通用测试类，但我找不到指定注释`expected`属性的通用方法。`@Test`这是我的代码的精简版：

```
public class MyTest<T extends Throwable> {
    Class<T> clazz; // set in constructor

    @Test(expected=clazz)
    public void test() { 
    }
} 
```

我使用的编译器错误`clazz`是：

> 注释属性 Test.expected 的值必须是类文字

有没有解决的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:08:36.353

这不是junit问题。您只是不能在 java 注释中使用变量。我不知道您到底想达到什么目标，但也可以使用 junit 规则设置预期的异常。他们可以被继承

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T13:36:30.690

您可以使用 JUnit 的[ExpectedException。](http://kentbeck.github.com/junit/javadoc/4.10/org/junit/rules/ExpectedException.html)

```
public class MyTest<T extends Throwable> {

    @Rule
    public ExpectedException thrown = ExpectedException.none();

    Class<T> clazz; // set in constructor

    @Test
    public void test() {
        thrown.expect(clazz); 
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T06:07:21.297

从测试的角度来看，这是一个有趣的问题。你已经编写了一个预期会失败的单元测试，但是在测试运行之前你不知道它会如何失败。我认为您需要创建更好的单元测试。如果测试将失败，您绝对应该知道您期望它如何失败。事实上，您应该确保它总是以完全相同的方式失败。

# python - Python 3.3 的 Pygame 安装

> ID：14115440
> 
> 赞同：22
> 
> 时间：2013-01-02T00:03:18.443
> 
> 标签：python, pygame

我正在尝试导入[Pygame](https://en.wikipedia.org/wiki/Pygame)以用于我的[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)版本3.3。Pygame 网站上的下载只有 Python 3.1 和 3.2。尽管我认为我已将 Pygame 安装在正确的路径中，但我似乎无法导入它。我已经尝试了 3.1 和 3.2 Pygame 下载。

Pygame 是没有安装在正确的文件路径中，还是 Pygame 与我的 Python (3.3) 版本不兼容？

我正在运行 Windows 7，这是错误：

```
Traceback (most recent call last):
File "<pyshell#3>", line 1, in <module>
import pygame
File ".\pygame\__init__.py", line 95, in <module>
from pygame.base import *
ImportError: DLL load failed: The specified module could not be found. 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-07T13:32:08.267

Pygame 的主页面似乎很少更新。您可以直接从[Bitbucket](http://en.wikipedia.org/wiki/Bitbucket)下载 Pygame 版本，网址为[https://bitbucket.org/pygame/pygame/downloads](https://bitbucket.org/pygame/pygame/downloads)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T15:02:06.180

如果 Paul Vincent Craven 的回答中的解决方案为您提供“需要 Python 版本 3.3，在注册表中找不到。”，您必须从[官方下载站点](http://www.python.org/getit/)下载并安装此版本：

```
Python 3.3.0 Windows X86-64 MSI Installer 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-23T20:33:27.463

如果您使用的是 Windows 并使用 Python 3.3，请打开[bitbucket 上的下载页面](https://bitbucket.org/pygame/pygame/downloads)。下载：pygame-1.9.2a0.win32-py3.3.msi

然后你可以通过导入来测试你是否有 Pygame `pygame`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-27T00:27:38.780

每次我更新我的 python 版本（目前我正在使用 python 3.3）时，我都会从[这个地址](http://www.lfd.uci.edu/~gohlke/pythonlibs/#pygame)下载一个特殊的 pygame 构建。它有许多其他包的构建，所以我认为值得一试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-03T04:23:20.433

我也遇到过这个问题。Pygame 必须与 Python 的版本和您拥有的计算机类型兼容。例如，如果您的 Python 版本为 3.3.2，但下载的 Pygame 版本为 2.7.1，则“import pygame”功能将无法使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-18T16:39:25.063

[您需要从Bitbucket](http://en.wikipedia.org/wiki/Bitbucket)下载相当于 Python 3.3 的 Pygame 版本，并且 Pygame 仅提供 32 位，因此您需要确保 Python 是 3.3 32 位。下载地址：[https ://bitbucket.org/pygame/pygame/downloads](https://bitbucket.org/pygame/pygame/downloads)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-01T10:19:10.330

`sudo apt-get install python-pygame`
为某些软件包引发一些错误，例如 404，因此
[https://community.webfaction.com/questions/315/how-do-i-install-pygame](https://community.webfaction.com/questions/315/how-do-i-install-pygame)
这个链接对我很有帮助

# android - 在android中制作警报框的最简单方法是什么？

> ID：14115442
> 
> 赞同：-5
> 
> 时间：2013-01-02T00:04:03.983
> 
> 标签：android, alert

如果我在 javascript 中，我可以打开一个警报对话框`alert("Hello world")`

在Android中制作警报框的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:06:20.433

```
new AlertDialog.Builder(this).setMessage(R.string.whatever).setPositiveButton(android.R.string.ok, null).show(); 
```

在哪里

*   `this`是 Context 的一个实例（也许你在一个 中`Activity`）
*   `R.string.whatever`在`strings.xml`文件中定义，我想你会像绝地武士一样掌握，直到你问（或者可能遵循本地化教程）。可以用普通的旧引号字符串替换
*   `setPositiveButton`告诉对话框将有一个按钮，该按钮将简单地关闭对话框（通知`null`）并标记为“确定”

# ember.js - 如何在 Ember v2 路由器 API 中打开控制台日志记录？

> ID：14115444
> 
> 赞同：4
> 
> 时间：2013-01-02T00:04:21.227
> 
> 标签：ember.js, router

在路由器 API 的 v1 中，您可以设置此标志：

```
App.Router = Ember.Router.extend({
  enableLogging: true
}); 
```

并且路由器会将状态更改记录到console.log，这有助于调试。这似乎不再起作用了——有谁知道是否有一个新的等价于这个标志？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-08T16:16:37.363

自[1bf0df4](https://github.com/emberjs/ember.js/commit/1bf0df4c95512dd42687a9b2b5ca3936a11aa09a)提交以来：

```
App = Ember.Application.create({
  LOG_TRANSITIONS: true
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T02:06:48.630

据我所知，我认为这还没有在 master 分支中解决：但是我在源代码中找到了相关的注释：

```
/* For me this comment starts on line 23202 on build v1.0.0-pre.2-233-g2db13c3

In addition to creating your application's router, `Ember.Application` is
also responsible for telling the router when to start routing.

By default, the router will begin trying to translate the current URL into
application state once the browser emits the `DOMContentReady` event. If you
need to defer routing, you can call the application's `deferReadiness()`
method. Once routing can begin, call the `advanceReadiness()` method.

If there is any setup required before routing begins, you can implement a
`ready()` method on your app that will be invoked immediately before routing
begins:

window.App = Ember.Application.create({
  ready: function() {
    this.set('router.enableLogging', true);
  }
});

*/ 
```

请注意，此注释实际上是在 master 分支的源代码中，该分支已合并到新的路由更改中。我不得不得出结论，这是一个错误，并且可能会在不久的将来解决（希望如此）。

# android - 如何在 Android 上使用 Ribbonmenu 从 menuItem 添加新活动？

> ID：14115448
> 
> 赞同：1
> 
> 时间：2013-01-02T00:05:11.803
> 
> 标签：android, android-intent, android-activity, android-manifest, menuitem

所以我正在使用来自 Android 的 RibbonMenu 库。我想在选择 menuItem 后开始一个新的活动。这是我的 menu/main.xml 文件

`

```
<item android:id="@+id/tactics" android:title="Tactics" android:icon="@drawable/ic_launcher"></item>
<item android:id="@+id/item2" android:title="Players" android:icon="@drawable/ic_launcher"></item>
<item android:id="@+id/item3" android:title="Teams" android:icon="@drawable/ic_launcher"></item>
<item android:id="@+id/item4" android:title="In-Game" android:icon="@drawable/ic_launcher"></item> 
```

`

这就是我尝试从主要活动开始活动的方式。

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    int id = item.getItemId();

    if (id == android.R.id.home){
        rbmView.toggleMenu();
    }

    if (id == R.id.tactics){

     // I added a Toast here to print something random. But looks like this is never even getting recognized.
        Intent i = new Intent(this, TouchlineInstructionActivity.class);
        this.startActivity(i);
    }

    return true; 

} 
```

这是我的新活动。

`public class TouchlineInstructionActivity 扩展 Activity 实现 iRibbonMenuCallback{

```
private RibbonMenuView rbmView;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_touchline_instruction);

    rbmView = (RibbonMenuView) findViewById(R.id.ribbonMenuView1);
    rbmView.setMenuClickCallback(this);
    rbmView.setMenuItems(R.menu.activity_main);

    getActionBar().setDisplayHomeAsUpEnabled(true);}` 
```

我将活动添加到我的 androidmanifest 文件中，如下所示

`

```
 <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name=".TouchlineInstructionActivity" >
    </activity>
</application>` 
```

没有错误或任何东西。该应用程序启动并运行良好。但是在单击按钮时，新活动并没有开始。关于我在这里做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T00:00:52.547

所以我终于弄清楚我做错了什么。老实说，这是一个非常愚蠢的错误。所以这里，这段代码就在这里

```
 if (id == R.id.tactics){

 // I added a Toast here to print something random. But looks like this is never even getting recognized.
    Intent i = new Intent(this, TouchlineInstructionActivity.class);
    this.startActivity(i);
} 
```

必须进入**public void RibbonMenuItemClick(int itemId)**方法而不是**onOptionsItemSelected(Item item)**方法。这对我来说是一个非常愚蠢的错误。我什至不知道我以前是如何认为我的代码有意义的。

# css - 视口单位，保持纵横比？

> ID：14115449
> 
> 赞同：6
> 
> 时间：2013-01-02T00:05:14.763
> 
> 标签：css, viewport, viewport-units

所以我刚刚发现了视口单位，我真的很想使用它们。

第一个挑战：我的元素的“基本尺寸”为 760x670 像素。我想使用视口单位将其放大，以便高度为`100vh`或宽度为`100vw`，以较小者为准。

不幸的是，虽然我可以使用`100vmin`两者中较小的一个，但我只能将其应用于宽度或高度，而不是两者。

目前我正在使用：

```
#root {
    width: 760px;
    height: 670px;
    width: 100vw;
    height: calc(670vw/760);
} 
```

这会缩放宽度以适应屏幕，从而实现垂直滚动。这还不错，但如果我真的可以让它适合视口，我会更喜欢它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-19T22:42:48.727

我已经让它在 IE10 中工作：

```
#elem {
    width: 100vw;
    height: calc((9/16)*100vw);
}

@media (min-aspect-ratio:16/9) {
    #elem {
        height: 100vh;
        width: calc((16/9)*100vh);
    }
} 
```

**现场演示： http:** [//jsfiddle.net/C2ZGR/show/](http://jsfiddle.net/C2ZGR/show/)（在IE10中打开（Win​​dows 7有预览版）；然后重新调整窗口大小，使宽度或高度都非常小）

我使用了纵横比为 16:9 的元素，但代码可以适用于任何纵横比 - 只需替换`16/9`, 并`9/16`使用您想要的纵横比。

顺便说一句，IE10 是唯一可以运行此演示的浏览器。Firefox/Opera 还没有实现视口单元，WebKit 浏览器目前有一个错误，即视口单元不能在`calc()`.

# hibernate - 使用休眠填充 2 个下拉列表 - 一个为空

> ID：14115452
> 
> 赞同：1
> 
> 时间：2013-01-02T00:06:02.487
> 
> 标签：hibernate

我有 2 个下拉列表，每个下拉列表都填充来自不同表的数据。我创建了 2 个不同的 DAO 类和列表方法，但第二个列表为空。

公共类 GenderDAO {

```
private ArrayList<Gender> genders;
static final Logger logger = Logger.getLogger(GenderDAO.class);

@SuppressWarnings("unchecked")
public ArrayList<Gender> listGenders() {
    Session session = HibernateUtil.getSessionFactory().openSession();
    Transaction transaction = null;
    try {
        transaction = session.beginTransaction();
        genders = (ArrayList<Gender>) session.createQuery("from Gender").list();
        transaction.commit();
    } catch (HibernateException e) {
        logger.debug("In the GenderDAO HibernateException");
        transaction.rollback();
    } finally {
        logger.debug("In the GenderDAO finally block");
        session.close();
    }
    return genders;
} 
```

公共类 StateDAO {

```
private ArrayList<State> states;
static final Logger logger = Logger.getLogger(StateDAO.class);

@SuppressWarnings ("unchecked")
public ArrayList<State> listStates() {
    Session session = HibernateUtil.getSessionFactory().openSession();
    Transaction transaction = null;
    try {
        transaction = session.beginTransaction();
        states = (ArrayList<State>) session.createQuery("from State").list();
        transaction.commit();
    } catch (HibernateException e) {
        logger.debug("In the StateDAO HibernateException");
        transaction.rollback();
    } finally {
        logger.debug("In the StateDAO finally block");
        session.close();
    }
    return states;
} 
```

}

我收到以下错误。

标记“选择”、字段“列表”、名称“状态”：请求的列表键“状态”无法解析为集合/数组/映射/枚举/迭代器类型。示例：人或人。{name}

如果我在 StateDAO 中执行查询之前添加以下内容，则错误消失但列表为空。

状态 = 新的 ArrayList();

调用DAO方法的代码如下：

```
 GenderDAO genderDAO = new GenderDAO();
    genders = genderDAO.listGenders();

    StateDAO stateDAO = new StateDAO();
    states = stateDAO.listStates(); 
```

有人可以建议缺少什么吗？

# android - 是否可以在 Android 中嵌入 TTS？

> ID：14115458
> 
> 赞同：0
> 
> 时间：2013-01-02T00:06:34.217
> 
> 标签：android, text-to-speech

不幸的是，我的语言不支持库存 Android 中的 TTS。因此，我的用户必须下载第三方 TTS 语音引擎。这很烦人，因为它需要额外的步骤才能让我的软件正常工作。

**有没有办法在 Android 应用程序中嵌入任何第三方 TTS 引擎（及其相应的语言包）？**

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T05:05:12.247

**不**，这是不可能的。

您必须从 android 市场**下载第三方 TTS然后安装它或者您可以****将第三方 TTS .apk 保存**到资产中然后安装它。

之后，您需要从大小从 32Mb 到 160MB 的服务器**下载相应的语音数据。**

然后，您需要将此 tts 设置为android **Voice input and output中****的默认 tts 引擎**。设置（外部）。

 ****如果用户选择了始终**在 android 设置中 使用我的设置，那么您需要设置您的语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-28T17:33:27.990

我不确定您是否可以在 android 中嵌入第三方 TTS。但我已经使用java完成了它。有一个作为 freetts.jar 可用的开源库。只需浏览此视频教程，您将获得该过程。您可以尝试在 android 中实现相同的功能。

[https://www.youtube.com/watch?v=gKAXzpnWXNU](https://www.youtube.com/watch?v=gKAXzpnWXNU)

希望它可以帮助你。**

# objective-c - 以 Retina 质量遮盖 2 个 UIImages

> ID：14115459
> 
> 赞同：5
> 
> 时间：2013-01-02T00:06:39.030
> 
> 标签：objective-c, ios, uiimage, retina-display, mask

尝试[此处](https://stackoverflow.com/questions/2776747/masking-a-uiimage)发布的答案后，返回的图像在视网膜显示器上的质量非常差。我的蒙版图像具有白色背景和黑色内容。

输出：[https ://dzwonsemrish7.cloudfront.net/items/22373o2Z260d3S051a05/Screenshot%202013.01.02%2000.04.57.png?v=34c4ab14](https://dzwonsemrish7.cloudfront.net/items/22373o2Z260d3S051a05/Screenshot%202013.01.02%2000.04.57.png?v=34c4ab14)

代码：

```
CGRect rect = CGRectMake(0.0f, 0.0f, 61.0f, 53.0f);
UIGraphicsBeginImageContextWithOptions(rect.size, NO, 2);
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextSetFillColorWithColor(context, [UIColor blueColor].CGColor);
CGContextFillRect(context, rect);

UIImage *imageGradient = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

UIImage *toggleImage = [UIImage imageNamed:@"RotationToggle.png"];
UIImage *inputImage = imageGradient;
CGImageRef maskRef = toggleImage.CGImage;

CGImageRef mask = CGImageMaskCreate(CGImageGetWidth(maskRef),
                                    CGImageGetHeight(maskRef),
                                    CGImageGetBitsPerComponent(maskRef),
                                    CGImageGetBitsPerPixel(maskRef),
                                    CGImageGetBytesPerRow(maskRef),
                                    CGImageGetDataProvider(maskRef), NULL, false);

CGImageRef masked = CGImageCreateWithMask(imageGradient.CGImage, mask);
CGImageRelease(mask);

UIImage *maskedImage = [UIImage imageWithCGImage:masked scale:inputImage.scale orientation:0];
CGImageRelease(masked); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-22T15:04:55.097

我不完全确定，但尝试改变这一行：

```
UIImage *toggleImage = [UIImage imageNamed:@"RotationToggle.png"]; 
```

对此：

```
UIImage *toggleImage = [UIImage imageNamed:@"RotationToggle"]; 
```

或天真：

```
UIImage *toggleImage = [UIImage imageNamed:@"RotationToggle@2x.png"]; 
```

问题是：我认为你通过这种方式分配它来强制它使用低质量的图像。跳过扩展时，Xcode 会自动查找 Retina 图像并在存在时分配它。

不过我可能错了，如果是的话，对不起。

# c# - Window 8 应用程序：嵌套异步调用

> ID：14115461
> 
> 赞同：2
> 
> 时间：2013-01-02T00:06:54.677
> 
> 标签：c#, windows-8, repository, mvvm-light, async-await

我正在构建一个 Windows 8 应用程序，但我遇到了异步调用问题。我将尝试提供尽可能多的细节，因为我认为我有两个结果：

*   当涉及到异步调用时，我做错了
*   或者我做错了，但也可能是错误的架构让我遇到了这个问题，而这个问题本来就不应该存在。

我是 Windows Azure 和 MVVM 的新手，但情况就是这样……</p>

该应用程序现在是为 Windows 8 构建的，但我也希望能够使用其他平台，所以我首先要做的是创建一个发布到 Windows Azure 网站的 WebAPI 项目。这样，我可以使用 JSON 传输数据，并且 WebAPI 控制器连接到一个存储库，该存储库正在处理与 Window Azure 表存储之间的数据请求。第二部分是一个 MVVM Light Windows 8 应用程序，它从 Azure 网站请求数据。

因此，让我们更详细地看一下 WebAPI 项目。在这里，我有一个类别模型开始。

```
public class Category : TableServiceEntity
{
    [Required]
    public string Name { get; set; }

    public string Description { get; set; }

    public string Parent { get; set; }
} 
```

类别模型只包含一个名称和描述（id 是 TableServiceEntity 的 RowKey）。如果类别是嵌套的，还会将字符串引用添加到父类别。出现第一个问题：Parent 是否应该是 Category 类型而不是 string，后端的 Category 模型是否应该有一组子类别？

然后我有我的 IRepository 接口来定义存储库。（正在进行中；-)）它还使用规范模式来传递查询范围。这一切正常，您可以使用浏览器进行测试并浏览到：[http ://homebudgettracker.azurewebsites.net/api/categories](http://homebudgettracker.azurewebsites.net/api/categories)

```
public interface IRepository<T> where T : TableServiceEntity
{
    void Add(T item);
    void Delete(T item);
    void Update(T item);
    IEnumerable<T> Find(params Specification<T>[] specifications);
    IEnumerable<T> RetrieveAll();
    void SaveChanges();
} 
```

现在存储库已经清楚了，让我们看一下控制器。我有一个 CategoriesController，它只是一个包含 IRepository 存储库的 ApiController。（用 Ninject 注入，但在这里无关）

```
public class CategoriesController : ApiController
{
    static IRepository<Category> _repository;

    public CategoriesController(IRepository<Category> repository)
    {
        if (repository == null)
        {
            throw new ArgumentNullException("repository");
        }

        _repository = repository;    
        } 
```

控制器包含一些方法，例如：

```
public Category GetCategoryById(string id)
{    
    IEnumerable<Category> categoryResults =_repository.Find(new ByRowKeySpecification(id));

    if(categoryResults == null)
    {
        throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
    }

    if (categoryResults.First<Category>() == null)
    {
        throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
    }

    return categoryResults.First<Category>();
} 
```

到目前为止，我们已经看到了后端，让我们继续讨论这里的实际问题：MvvmLight 客户端和对 WebAPI 控制器的异步 http 请求。

在客户端项目中，我也有一个类别模型。

```
public class Category
{
    [JsonProperty("PartitionKey")]
    public string PartitionKey { get; set; }

    [JsonProperty("RowKey")]
    public string RowKey { get; set; }

    [JsonProperty("Name")]
    public string Name { get; set; }

    [JsonProperty("Description")]
    public string Description { get; set; }

    [JsonProperty("Timestamp")]
    public string Timestamp { get; set; }

    [JsonProperty("Parent")]
    public string ParentRowKey { get; set; }

    public ObservableCollection<Category> Children { get; set; }
} 
```

不要介意 PartitionKey 和 RowKey 属性，分区键应该被忽略，因为它不关心应用程序存在什么 Azure 表服务实体属性。RowKey 实际上可以重命名为 Id。但实际上并不相关。

主视图的 ViewModel 如下所示：

```
public class MainViewModel : CategoryBasedViewModel
{
    /// <summary>
    /// Initializes a new instance of the MainViewModel class.
    /// </summary>
    public MainViewModel(IBudgetTrackerDataService budgetTrackerDataService)
: base(budgetTrackerDataService)
    {
        PageTitle = "Home budget tracker";
    }
} 
```

它从我创建的 ViewModel 扩展而来，用于共享包含 Category Observable 集合的页面的逻辑。此 ViewModel 中的重要内容：

*   一个 IbudgetTrackerDataService 注入到 ViewModel 中，这是一个高级数据服务
*   一个 ObservableCollection 包含 category-ViewModel-wrapped 类别的集合
*   一些用于绑定的属性（fe: IsLoadingCategories 来处理视图上的 ProgressRing）
*   异步调用完成后IBudgetTrackerDataService调用的getCategoriesCompleted回调方法

所以代码如下：

```
public abstract class CategoryBasedViewModel : TitledPageViewModel
{
    private IBudgetTrackerDataService _dataService;

    private ObservableCollection<CategoryViewModel> _categoryCollection;

    private Boolean isLoadingCategories;

    public const string CategoryCollectionPropertyName = "CategoryCollection";

    public const string IsLoadingCategoriesPropertyName = "IsLoadingCategories";

    public Boolean IsLoadingCategories
    {
        get
        {
            return isLoadingCategories;
        }
        set
        {
            if (isLoadingCategories != value)
            {
                isLoadingCategories = value;
                RaisePropertyChanged(IsLoadingCategoriesPropertyName);
            }
        }
    }

    public ObservableCollection<CategoryViewModel> CategoryCollection
    {
        get
        {
            return _categoryCollection;
        }
        set
        {
            _categoryCollection = value;
            RaisePropertyChanged(CategoryCollectionPropertyName);
        }
    }

    public CategoryBasedViewModel(IBudgetTrackerDataService budgetTrackerDataService)
    {
        wireDataService(budgetTrackerDataService);
    }

    public CategoryBasedViewModel(IBudgetTrackerDataService budgetTrackerDataService, string pageTitle)
    {
        PageTitle = pageTitle;
        wireDataService(budgetTrackerDataService); 
    }

    private void wireDataService(IBudgetTrackerDataService budgetTrackerDataService)
    {
        _dataService = budgetTrackerDataService;
        CategoryCollection = new ObservableCollection<CategoryViewModel>();
        IsLoadingCategories = true;
        _dataService.GetCategoriesAsync(GetCategoriesCompleted);
    }

    private void GetCategoriesCompleted(IList<Category> result, Exception error)
    {
        if (error != null)
        {
            throw new Exception(error.Message, error);
        }

        if (result == null)
        {
            throw new Exception("No categories found");
        }

        IsLoadingCategories = false;

        CategoryCollection.Clear();

        foreach (Category category in result)
        {
            CategoryCollection.Add(new CategoryViewModel(category, _dataService));
            // Added the dataService as a parameter because the CategoryViewModel will handle the search for Parent Category and Children catagories
        }
    }
} 
```

这一切都有效，但现在我希望父/子关系在类别上工作。为此，我在 CategoryViewModel 中添加了逻辑，以便它在构造时获取子类别……</p>

```
public CategoryViewModel(Category categoryModel, IBudgetTrackerDataService
budgetTrackerDataService)
{
    _category = categoryModel;
    _dataService = budgetTrackerDataService;

    // Retrieve all the child categories for this category
    _dataService.GetCategoriesByParentAsync(_category.RowKey,
GetCategoriesByParentCompleted);
} 
```

因此 CategoryBasedViewModel 的构造是获取类别并调用回调方法 GetCategoriesCompleted：

```
_dataService.GetCategoriesAsync(GetCategoriesCompleted); 
```

该回调方法也在调用 CategoryViewModel 的构造函数。在那里，另一个异步方法用于获取类别的子项。

```
public CategoryViewModel(Category categoryModel, IBudgetTrackerDataService
budgetTrackerDataService)
{
    _category = categoryModel;
    _dataService = budgetTrackerDataService;

    // Retrieve all the child categories for this category
    _dataService.GetCategoriesByParentAsync(_category.RowKey,
GetCategoriesByParentCompleted);
} 
```

还有我的问题！GetCategoriesByParentAsync 是在另一个异步调用内部发生的异步调用，代码只是中断了调用并且什么都不做。

数据服务实现接口：

```
public interface IBudgetTrackerDataService
{
    void GetCategoriesAsync(Action<IList<Category>, Exception> callback);

    void GetCategoriesByParentAsync(string parent, Action<IList<Category>,
Exception> callback);
} 
```

异步方法包含以下代码：

```
public async void GetCategoriesAsync(Action<IList<Category>, Exception> callback)
{
    // Let the HTTP client request the data
    IEnumerable<Category> categoryEnumerable = await _client.GetAllCategories();

    // Invoke the callback function passed to this operation
    callback(categoryEnumerable.ToList<Category>(), null);
}

public async void GetCategoriesByParentAsync(string parent, Action<IList<Category>,
Exception> callback)
{
    // Let the HTTP client request the data
    IEnumerable<Category> categoryEnumerable = await
_client.GetCategoriesWithParent(parent);

    // Invoke the callback function passed to this operation
    callback(categoryEnumerable.ToList<Category>(), null);
} 
```

长话短说：

*   为什么嵌套调用时这些调用会失败？
*   其次，我是不是很愚蠢，我应该以不同的方式处理笼子的父/子关系吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T03:49:17.547

我现在要回避父/子关系问题，只解决这些`async`问题。

`async`首先，我在[`async`/ `await`intro 博客文章](http://nitoprograms.blogspot.com/2012/02/async-and-await.html)中详细解释了一些关于代码的一般准则：

*   避免`async void`（返回`Task`或`Task<T>`代替）。
*   适用时使用`ConfigureAwait(false)`。

我见过`callback`其他人采取的代表方法，但我不确定它来自哪里。它不能很好地工作`async`，只会使代码复杂化，IMO。该`Task<T>`类型旨在表示与 an 耦合的结果值，`Exception`并且可以与`await`.

首先，您的数据服务：

```
public interface IBudgetTrackerDataService
{
  Task<IList<Category>> GetCategoriesAsync();
  Task<IList<Category>> GetCategoriesByParentAsync(string parent);
}

public async Task<IList<Category>> GetCategoriesAsync()
{
  // Let the HTTP client request the data
  IEnumerable<Category> categoryEnumerable = await _client.GetAllCategories().ConfigureAwait(false);
  return categoryEnumerable.ToList();
}

public async Task<IList<Category>> GetCategoriesByParentAsync(string parent)
{
  // Let the HTTP client request the data
  IEnumerable<Category> categoryEnumerable = await _client.GetCategoriesWithParent(parent).ConfigureAwait(false);
  return categoryEnumerable.ToList();
} 
```

或者更好的是，如果您实际上不需要`IList<T>`：

```
public interface IBudgetTrackerDataService
{
  Task<IEnumerable<Category>> GetCategoriesAsync();
  Task<IEnumerable<Category>> GetCategoriesByParentAsync(string parent);
}

public Task<IEnumerable<Category>> GetCategoriesAsync()
{
  // Let the HTTP client request the data
  return _client.GetAllCategories();
}

public Task<IEnumerable<Category>> GetCategoriesByParentAsync(string parent)
{
  // Let the HTTP client request the data
  return _client.GetCategoriesWithParent(parent);
} 
```

（此时，您可能会质疑您的数据服务的目的是什么）。

* * *

继续讨论 MVVM`async`问题：`async`在构造函数中表现不佳。几周后我会发表一篇博文，将详细讨论这个问题，但要点如下：

我个人的偏好是使用异步工厂方法（例如，`public static async Task<MyType> CreateAsync()`），但这并不总是可行的，尤其是当您为 VM 使用 DI/IoC 时。

在这种情况下，我喜欢在需要异步初始化的类型上公开一个属性（实际上，我使用了一个`IAsyncInitialization`接口，但是对于您的代码，约定也可以正常工作）`public Task Initialized { get; }`：

此属性在构造函数中只设置一次，如下所示：

```
public CategoryViewModel(Category categoryModel, IBudgetTrackerDataService budgetTrackerDataService)
{
  _category = categoryModel;
  _dataService = budgetTrackerDataService;

  // Retrieve all the child categories for this category
  Initialized = InitializeAsync();
}

private async Task InitializeAsync()
{
  var categories = await _dataService.GetCategoriesByParentAsync(_category.RowKey);
  ...
} 
```

然后，您可以选择让您的“父”虚拟机等待其“子”虚拟机初始化。目前尚不清楚这是否是您想要的，但我假设您希望`IsLoadingCategories`在`true`所有子虚拟机都加载之前成为：

```
public CategoryBasedViewModel(IBudgetTrackerDataService budgetTrackerDataService)
{
  _dataService = budgetTrackerDataService;
  CategoryCollection = new ObservableCollection<CategoryViewModel>();
  IsLoadingCategories = true;
  Initialized = InitializeAsync();
  NotifyOnInitializationErrorAsync();
}

private async Task InitializeAsync()
{
  var categories = await _dataService.GetCategoriesAsync();
  CategoryCollection.Clear();
  foreach (var category in categories)
  {
    CategoryCollection.Add(new CategoryViewModel(category, _dataService));
  }

  // Wait until all CategoryViewModels have completed initializing.
  await Task.WhenAll(CategoryCollection.Select(category => category.Initialized));

  IsLoadingCategories = false;
}

private async Task NotifyOnInitializationErrorAsync()
{
  try
  {
    await Initialized;
  }
  catch
  {
    NotifyPropertyChanged("InitializationError");
    throw;
  }
}

public string InitializationError { get { return Initialized.Exception.InnerException.Message; } } 
```

我添加了`InitializationError`and`NotifyOnInitializationErrorAsync`来演示一种方法来显示初始化期间可能发生的任何错误。由于`Task`未实现`INotifyPropertyChanged`，因此如果/当初始化失败时没有自动通知，因此您必须明确显示它。

# android - 如何清除活动下方的活动堆栈

> ID：14115462
> 
> 赞同：6
> 
> 时间：2013-01-02T00:07:08.933
> 
> 标签：android, android-activity

在我的应用程序中，当我启动特定活动时，我希望从下面的堆栈中清除同一包中的所有活动。有人可以帮助我如何做到这一点吗？此外，我不想`android:noHistory="true"`在清单中使用，因为我只希望在启动此特定活动时清除堆栈历史记录。

编辑：

为了更清楚地说明我的观点，假设我有活动 a。从 a 我开始活动 b。从 b 我开始 c。但是当我开始c时，我想清除b和a。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T08:24:22.317

哦，伙计们，我发现您只需将以下代码与启动堆栈清除活动的 Intent 放在一起：

```
Intent i = new Intent(this,MyActivity.class);
i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK);
i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(i); 
```

不过感谢您的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:34:48.607

试试这个，

添加`android:launchMode="singleTop"`到您想要清除所有堆叠活动的特定活动。

然后在开始您的特定活动时使用`intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP)`和。`intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)`

来源：[Android：清除后台堆栈](https://stackoverflow.com/questions/5794506/android-clear-the-back-stack)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T02:12:19.977

```
Intent intent = new Intent(getApplicationContext(), YOUR_CLASS.class);
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
startActivity(intent); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-02T06:11:00.340

在活动开始之前设置标志......在开始活动后设置标志的意义是什么......代码应该看起来像这样，

```
Intent intent = new Intent(getContext(), ClassName.class);
intent.setFlags( Intent.FLAG_ACTIVITY_CLEAR_TOP );
  v.getRootView().getContext().startActivity(intent);

  removeSessionFiles(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-12T13:26:56.240

我知道这是一个旧线程，但我想与任何想知道的人分享 kotlin 中的语法。

```
 val i = Intent(this@PresentActivity,NextActivity::class.java)
     i.flags = Intent.FLAG_ACTIVITY_CLEAR_TASK and Intent.FLAG_ACTIVITY_NEW_TASK
     startActivity(i) 
```

# c++ - 将 Int 转换为 char * 并在屏幕上显示

> ID：14115463
> 
> 赞同：1
> 
> 时间：2013-01-02T00:07:33.307
> 
> 标签：c++, sdl, sdl-ttf

当我在屏幕上绘图时，我想显示游戏得分的动态文本区域。唯一的问题是，当我重绘屏幕时，它没有用新的分值更新，并且零后出现乱码。我要做的是存储一个 int 来保持玩家得分并增加该 int 并在屏幕上重新绘制新值。

```
void drawText(SDL_Surface* screen,
char* string,
int posX, int posY)
{
TTF_Font* font = TTF_OpenFont("ARIAL.TTF", 40);

SDL_Color foregroundColor = { 255, 255, 255 };
SDL_Color backgroundColor = { 0, 0, 0 };

SDL_Surface* textSurface = TTF_RenderText_Shaded(font, string,
    foregroundColor, backgroundColor);

SDL_Rect textLocation = { posX, posY, 0, 0 };

SDL_BlitSurface(textSurface, NULL, screen, &textLocation);

SDL_FreeSurface(textSurface);

TTF_CloseFont(font);
}

char convertInt(int number)
{
stringstream ss;//create a stringstream
ss << number;//add number to the stream
std::string result =  ss.str();//return a string with the contents of the stream

const char * c = result.c_str();
return *c;
}

score = score + 1;
char scoreString = convertInt(score);
drawText(screen, &scoreString, 580, 15); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:11:22.270

关于乱码输出，这是因为您`convertInt`通过使用地址运算符 ( `&`) 将接收到的单个字符用作字符串。该单个字符之后的内存中的数据可能包含任何内容，而且很可能*不是*特殊的字符串终止符。

为什么要从字符串中返回单个字符？使用 eg[`std::to_string`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)并返回整个`std::string`，或继续使用 the`std::stringstream`并从中返回正确的字符串。

至于未更新的号码，可能是您有一个多位数的号码，但您只返回第一个数字。按照我上面的建议，返回字符串，并`std::string`在对 的调用中继续使用`drawText`，它可能会更好地工作。

* * *

看来您不允许更改`drawText`功能，请使用以下内容：

```
score++;
// Cast to `long long` because VC++ doesn't have all overloads yet
std::string scoreString = std::to_string(static_cast<long long>(score));
drawText(screen, scoreString.c_str(), 580, 15); 
```

# php - 通过 Google Drive API 从本地 CSV 文件创建 Google Drive 电子表格

> ID：14115468
> 
> 赞同：4
> 
> 时间：2013-01-02T00:08:27.220
> 
> 标签：php, google-drive-api, google-sheets

我正在尝试将本地 CSV 文件上传到 Google Drive 并在那里像 Google 电子表格一样显示它。但是，当我转到我的 Google Drive 并单击指向我的文件的链接时，我只能下载它，而不能以电子表格的形式查看它。我试过使用，`?convert=true`但文件没有被转换。我也尝试过`application/vnd.google-apps.spreadsheet`用作 mime 类型，但注意到更改或我得到`400 Bad request`响应。

当我右键单击该文件时，我可以选择使用 Google 电子表格打开，然后正确显示该文件。我在 Google 的当前文档中找不到任何关于此的内容，并且在 google 上的搜索并没有太大帮助。

到目前为止，我所做的是创建一个新的、*空*的Google 电子表格并尝试用我的 CSV 文件填充它，但这给了我一个`500 Internal Error`.

```
 $file = new Google_DriveFile();
        $file->setTitle('Exported data from ' . $this->event->title);
        $file->setDescription('Exported data from ' . $this->event->title);
        $file->setMimeType( 'text/csv' );

        try {
            $createdFile = $this->drive->files->insert($file, array(
              'data' => $data,
              'mimeType' => 'application/vnd.google-apps.spreadsheet'
            ), array('convert'=>true));

            // Uncomment the following line to print the File ID
            // print 'File ID: %s' % $createdFile->getId();

         $additionalParams = array(
    'newRevision' => false,
    'data' => $data,
    'convert'=>true //no change if this is true or false
);
            $newFile = $this->drive->files->get( $createdFile->getId() );
            $newFile->setMimeType('text/csv');
            $updated = $this->drive->files->update($createdFile->getId(), $newFile, $additionalParams);

            preint_r($updated);
        } catch (Exception $e) {
            print "An error occurred: " . $e->getMessage();
        } 
```

我查看了 Google Drive 的 API，但没有发现任何有用的东西。我想知道我是否应该使用 Google 电子表格 API 或者 Google Drive API 是单独使用的？

非常感谢，Waldemar

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T01:03:05.230

试试下面的。它来自 Google 文档中的 File:insert 参考，但我添加了 convert 参数：

```
/**
 * Insert new file.
 *
 * @param Google_DriveService $service Drive API service instance.
 * @param string $title Title of the file to insert, including the extension.
 * @param string $description Description of the file to insert.
 * @param string $parentId Parent folder's ID.
 * @param string $mimeType MIME type of the file to insert.
 * @param string $filename Filename of the file to insert.
 * @return Google_DriveFile The file that was inserted. NULL is returned if an API error         occurred.
 */
function insertFile($service, $title, $description, $parentId, $mimeType, $filename) {
  $file = new Google_DriveFile();
  $file->setTitle($title);
  $file->setDescription($description);
  $file->setMimeType($mimeType);

  // Set the parent folder.
  if ($parentId != null) {
    $parent = new ParentReference();
    $parent->setId($parentId);
    $file->setParents(array($parent));
  }

  try {
    $data = file_get_contents($filename);

    $createdFile = $service->files->insert($file, array(
      'data' => $data,
      'mimeType' => $mimeType,
      'convert' => true,
    ));

    // Uncomment the following line to print the File ID
    // print 'File ID: %s' % $createdFile->getId();

    return $createdFile;
  } catch (Exception $e) {
    print "An error occurred: " . $e->getMessage();
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-11T18:54:44.543

我正在尝试上面的代码它对我不起作用它只会在登录后停止

只需使用 $file->setMimeType('application/vnd.google-apps.spreadsheet);

```
$createdFile = $service->files->insert($file, array(
  'data' => $data,
  'mimeType' => 'text/csv',
  'convert' => true,
)); 
```

它对我有用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-18T10:47:54.460

我必须添加另一个参数才能使其工作。'uploadType' => '多部分'

```
$createdFile = $service->files->insert($file,array(
'data' => $data,
'mimeType' => 'text/csv',
'convert' => true,
'uploadType' => 'multipart',
)); 
```

现在它正在工作。

# sketchup - 如何创建可 3D 打印的 stl 文件？

> ID：14115469
> 
> 赞同：1
> 
> 时间：2013-01-01T16:55:28.587
> 
> 标签：sketchup

好的，我终于有了一个我想要 3D 打印的茶杯的好草图。下一步是将草图导出为可 3D 打印的 stl 文件。我曾尝试使用 CADspan Pro（当我在重铺步骤中单击“进程”时崩溃）和一个`skp_to_dxf.rb`插件（它确实导出了一个无扩展名的文件（我假设是一个 stl），一个在我上传时无法验证的文件到 Shapeways 或 Ponoko）但没有运气。

**所以我的问题是，如何从现有的 skp 文件创建高分辨率 3D 可打印 stl 文件？** [这是我的 skp 文件](https://sketchup-a-googleproductforums-com.googlegroups.com/attach/d85f90ccd069563e/teacup.skp?gda=T18nQUcAAAAz-vHkIy_YLYKJOITrH9JnXVGFar2Q_kFh8_kXhGYdAtHPxQ3x-303qy9pcE8dq4gbQwFxJw55cVwemAxM-EWmeV4duv6pDMGhhhZdjQlNAw&pli=1&view=1&part=4)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T08:49:12.443

SketchUp 有一个开源项目，具有 STL 的导入和导出功能：[https ://github.com/SketchUp/sketchup-stl/](https://github.com/SketchUp/sketchup-stl/)

（请注意，自述文件声称的“最新和最好的可用”不是 - 源有许多更改和修复。）

# three.js - PointerLock API 和 Three.js

> ID：14115471
> 
> 赞同：0
> 
> 时间：2013-01-02T00:08:58.407
> 
> 标签：three.js

您好，我正在使用 Three.js PointerLock API 示例。

[http://mrdoob.github.com/three.js/examples/misc_controls_pointerlock.html](http://mrdoob.github.com/three.js/examples/misc_controls_pointerlock.html)

在示例中，它使用俯仰和偏航动力学，但只有 X 被平移。换句话说，相机站在地上，不让我飞。

我尝试旋转 pitchObject Y 并使用 LookAt() 但在这两种情况下它们的行为都很奇怪。也许我应该尝试其他技术，然后使用髓和偏航进行飞行控制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T11:35:13.097

应进一步研究俯仰和偏航技术飞行动力学。 [http://en.wikipedia.org/wiki/Flight_dynamics](http://en.wikipedia.org/wiki/Flight_dynamics)

只是在控件中添加了另一个变量**Y**，而不是尝试添加音高。我刚刚用**X让 Yaw 翻译**

# java - Android：当应用离开前台时执行小动作

> ID：14115472
> 
> 赞同：0
> 
> 时间：2013-01-02T00:08:59.260
> 
> 标签：java, android

我正在构建一个计时器应用程序，并且希望在用户从前台删除应用程序时暂停它（例如通过后退或主页按钮）。最简单的方法是什么？我在想 onStop() 会是，但我以前从未这样做过，所以我不完全确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T00:18:19.143

您可以通过覆盖来做到这一点[`onPause()`](http://developer.android.com/reference/android/app/Activity.html#onPause%28%29)（或者[`onUserLeaveHint()`](http://developer.android.com/reference/android/app/Activity.html#onUserLeaveHint%28%29)如果您只想要用户操作。）

# html - 使用宽度百分比的流畅设计，1px 边框搞砸了

> ID：14115474
> 
> 赞同：1
> 
> 时间：2013-01-02T00:09:12.853
> 
> 标签：html, css, percentage

希望我提供足够的信息来对抗错误的标题。

我正在设计一个有两个主要部分的网站，一个侧边栏和一个内容部分。侧边栏在左侧，内容在右侧。到目前为止，我有这个标记和 CSS：

```
<section id="sidebar">
    sidebar
</section>
<section id="content">
    content
</section>

#sidebar {
    width: 29%;
    background: #f7f3ed;
    float: left;
    padding-right: 1%;
    text-align: right;
}

#content {
    width: 69%;
    padding-left: 1%;
    float: left;
} 
```

希望你能看到我在这里尝试做的事情。我希望侧边栏和内容区域由百分比定​​义，以便在调整浏览器窗口大小时它们保持形状。

但是，我希望侧边栏在右侧有一个 1 像素的边框，将其与内容区域分开。当我添加它时，内容区域被推到侧边栏下方，因为整体宽度比 100% 多 1 个像素。

这是一个 jsfiddle 示例：http: [//jsfiddle.net/juffd/](http://jsfiddle.net/juffd/)

如何在没有内容区域环绕在侧边栏下方并且没有具体指定每个元素的宽度（以像素为单位）的情况下应用边框？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:18:27.790

使用`box-sizing: border-box;`. 这使得元素的宽度包括其填充以及任何边框。

# elasticsearch - 使弹性搜索服务器只读的简单方法

> ID：14115475
> 
> 赞同：20
> 
> 时间：2013-01-02T00:09:12.597
> 
> 标签：elasticsearch

只需将一堆 json 数据上传到 elasticsearch 服务器即可拥有一个基本的查询 api，并且有很多选项，这真的很容易

我只是想知道是否有简单的方法来发布它，以防止人们修改它

在默认设置中，服务器处于打开状态，不会收到会修改数据的 DELETE 或 PUT http 消息。

是否有某种设置将其配置为只读？或者我应该配置某种http代理来实现它？

（我是弹性搜索新手）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-02T10:23:37.987

如果你想把 Elasticsearch API 暴露为只读，我认为最好的办法是把 Nginx 放在它前面，拒绝除 GET 之外的所有请求。示例配置如下所示：

```
# Run me with:
#
#     $ nginx -c path/to/this/file
#
# All requests except GET are denied.

worker_processes  1;
pid               nginx.pid;

events {
    worker_connections  1024;
}

http {

  server {

    listen       8080;
    server_name  search.example.com;

    error_log   elasticsearch-errors.log;
    access_log  elasticsearch.log;

    location / {
      if ($request_method !~ "GET") {
        return 403;
        break;
      }

      proxy_pass http://localhost:9200;
      proxy_redirect off;

      proxy_set_header  X-Real-IP  $remote_addr;
      proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header  Host $http_host;
    }

  }

} 
```

然后：

```
curl -i -X GET http://localhost:8080/_search -d '{"query":{"match_all":{}}}'
HTTP/1.1 200 OK

curl -i -X POST http://localhost:8080/test/test/1 -d '{"foo":"bar"}'
HTTP/1.1 403 Forbidden

curl -i -X DELETE http://localhost:8080/test/
HTTP/1.1 403 Forbidden 
```

请注意，恶意用户仍然可能会弄乱您的服务器，例如发送不正确的脚本有效负载，这会使 Elasticsearch 卡住，但对于大多数用途来说，这种方法会很好。

如果您需要对代理进行更多控制，您可以使用更复杂的 Nginx 配置，或者编写专用代理，例如。在 Ruby 或 Node.js 中。

有关更复杂的基于 Ruby 的代理，请参阅此[示例。](https://gist.github.com/3369662#file-proxy-rb)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-09-12T15:05:24.813

您可以在索引上设置只读标志，但这确实会限制某些操作，因此您需要查看这是否可以接受。

```
curl -XPUT http://<ip-address>:9200/<index name>/_settings -d'
{
    "index":{
        "blocks":{
            "read_only":true
        }
    }
}' 
```

正如其他答案之一所述，您实际上应该让 ES 在受信任的环境中运行，您可以在其中控制对它的访问。

此处有关索引设置的更多信息：[http ://www.elasticsearch.org/guide/reference/api/admin-indices-update-settings/](http://www.elasticsearch.org/guide/reference/api/admin-indices-update-settings/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-22T19:12:03.143

我知道这是一个老话题。我遇到了同样的问题，将 ES 放在 Nginx 后面以使其只读但允许 kibana 访问它。

在我的情况下，Kibana 需要的唯一来自 ES 的请求是“url_public/_all/_search”。

所以我允许它进入我的 Nginx conf。

这是我的conf文件：

```
server {

    listen port_es;
    server_name ip_es;

    rewrite ^/(.*) /$1 break;
    proxy_ignore_client_abort on;
    proxy_redirect url_es url_public;
    proxy_set_header  X-Real-IP  $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  Host $http_host;

    location ~ ^/(_all/_search) {
        limit_except GET POST OPTIONS {
                deny  all;
        }
        proxy_pass url_es;
    }

    location / {

        limit_except GET {
                deny  all;
        }
        proxy_pass url_es;
    }
} 
```

所以只允许 GET 请求，除非请求是 _all/_search。如果需要，添加其他请求很简单。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-03-05T12:41:36.323

我使用这个弹性搜索插件：

[https://github.com/sscarduzio/elasticsearch-readonlyrest-plugin](https://github.com/sscarduzio/elasticsearch-readonlyrest-plugin)

它非常简单，易于安装和配置。GitHub 项目页面有一个配置示例，显示了如何将请求限制为仅 HTTP GET 方法；这不会改变弹性搜索中的任何数据。如果您只需要列入白名单的 IP#（或没有）来使用可以更改数据的其他方法（PUT/DELETE/etc），那么它也可以满足您的需求。

类似这样的内容会进入您的 elasticsearch 配置文件（/etc/elasticsearch/elasticsearch.yml 或等效文件），改编自 GitHub 页面：

```
readonlyrest:
    enable: true
    response_if_req_forbidden: Sorry, your request is forbidden
    # Default policy is to forbid everything, let's define a whitelist
    access_control_rules:

    # from these IP addresses, accept any method, any URI, any HTTP body
    #- name: full access to internal servers
    #  type: allow
    #  hosts: [127.0.0.1, 10.0.0.10]

    # From external hosts, accept only GET and OPTION methods only if the HTTP request body is empty
    - name: restricted access to all other hosts
      type: allow
      methods: [OPTIONS,GET]
      maxBodyLength: 0 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-01-02T00:15:10.013

Elasticsearch 旨在用于受信任的环境中，它本身没有任何访问控制机制。因此，部署 elasticsearch 的最佳方式是在其前面使用一个 Web 服务器，该服务器将负责控制可以到达 elasticsearch 的查询的访问和类型。[也就是说，可以通过使用elasticsearch-jetty](https://github.com/sonian/elasticsearch-jetty)插件来限制对 elasticsearch 的访问。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-01-02T00:12:55.787

无论是 Elastic 还是 Solr，依靠搜索引擎来确保您的安全都不是一个好主意。你应该在你的容器中使用安全性，或者甚至将容器放在像 Apache HTTPD 这样*真正*防弹的东西后面，然后设置安全性来禁止你想要禁止的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-20T21:58:36.173

如果您在 nginx 后面有一个面向公众的 ES 实例，该实例在内部更新，这些块应该使其仅准备就绪并且只允许 _search 端点

```
 limit_except GET POST OPTIONS {
        allow 127.0.0.1;
        deny  all;
    }
    if ($request_uri !~ .*search.*) {
        set $sc fail;
    }
    if ($remote_addr = 127.0.0.1) {
        set $sc pass;
    }
    if ($sc = fail) {
        return 404;
    } 
```

# ruby - 机械化发送 POST 以在页面上填充数据

> ID：14115477
> 
> 赞同：0
> 
> 时间：2013-01-02T00:09:49.953
> 
> 标签：ruby, post, mechanize

我有一个发送 POST 以在页面上填充一些数据的站点。我通常在 Charles Proxy 中查看 POST 并像这样传递参数：

```
bot.post('https://www.google.com?', {
        "parameter" => "value",
        "SESSION_parameter_ID" => "value2}) 
```

但是，当我查看 Charles 中的请求时，它只是发送如下文本：

```
callCount=1
page=/eplus/mao.portal?_nfpb=true&_pageLabel=pBillPayHistory&_nfls=false
httpSessionId=2GQQQj3McPh2vQzvxnFb5KM9qgfn80Sqv2L8sC16p66nvxc5yJv5!1006025334
scriptSessionId=22A83635CAD97A33C8255AC8D559FD27672
c0-scriptName=BillingService 
```

如何将 POST 发送到 URL 并将请求参数作为文本发送？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T23:52:41.783

该 Content-Type 标头应为： application/x-www-form-urlencoded

所以试试：

```
bot.post url, vars, ({'Content-Type' => 'application/x-www-form-urlencoded'}) 
```

# java - 暂停 WatchService WatchKey Java

> ID：14115479
> 
> 赞同：2
> 
> 时间：2013-01-02T00:09:53.487
> 
> 标签：java, file, watchservice

我有 2 个文件夹，我为每个文件夹注册了一个具有相同 WatchService 的 WatchKey...当我在一个文件夹中更改某些内容时，显然会有一个 WatchEvent。但是当我有一个事件时，我想更改另一个文件夹中的某些内容，而不需要为另一个文件夹获取另一个事件。因为那会导致无限循环:(

我这样的代码不能正常工作：

```
while (true) {
        try {
            key = watcher.take();
            keypath = (Path) key.watchable();
            list = key.pollEvents();
            for (WatchEvent<?> e : list) {
                if (e.kind() == OVERFLOW) {
                    System.err.println("OVERFLOW!");
                    break;
                } else {
                    file = new File(keypath.toString() + "\\" + e.context().toString());
                    System.out.println("FileChange detected: \"" + file + "\" [" + e.kind() + "]");
                    WatchKey other = getKey(getOtherFile(file));
                    other.cancel();
                    new Thread(new WatcherSync(this, file, sync)).start();
                    registerWatchKey((Path)other.watchable());
                }
            }
            if (!key.reset()) {
                System.err.println("Reset failed for WatchKey: " + keypath);
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    } 
```

# android - Android文本对齐多方向

> ID：14115480
> 
> 赞同：0
> 
> 时间：2013-01-02T00:09:55.280
> 
> 标签：android, button

我正在创建一个项目列表，可能以按钮的形式。问题是我基本上想要按钮上的三个文本字段，一个左对齐，一个稍微靠左对齐，然后一个右对齐。我怎么能做那样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:01:20.843

您应该将三个 TextView 放在一个 LinearLayout 中（以对齐它们）并在 LinearLayout 上放置一个 onClick 回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:22:27.860

这是一个使用包含 3 个文本视图的系统按钮样式的布局。您可以使用 onClick 属性定义单击自定义按钮时要调用的方法。

文件：/res/layout/custom_button.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    style="?android:attr/buttonStyle"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:onClick="onCustomButtonClick" >

    <TextView
        android:id="@+id/text_1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:text="text 1" />

    <TextView
        android:id="@+id/text_2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="5dp"
        android:layout_toRightOf="@id/text_1"
        android:text="text 2" />

    <TextView
        android:id="@+id/text_2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:text="text 3" />

</RelativeLayout> 
```

# c# - 如何从 lambda 表达式返回模型属性（如 MVC 的“Html.TextBoxFor(xxx)”）？

> ID：14115481
> 
> 赞同：1
> 
> 时间：2013-01-02T00:09:55.283
> 
> 标签：c#, linq, properties, lambda

在 MVC 中你可以说：

```
Html.TextBoxFor(m => m.FirstName) 
```

这意味着您将模型属性作为参数（而不是值）传递，因此 MVC 可以获取元数据等。

我正在尝试在 C# WinForms 项目中做类似的事情，但不知道如何做。基本上我在用户控件中有一组布尔属性，我想在字典中枚举它们以便于访问：

```
public bool ShowView { get; set; }
public bool ShowEdit { get; set; }
public bool ShowAdd { get; set; }
public bool ShowDelete { get; set; }
public bool ShowCancel { get; set; }
public bool ShowArchive { get; set; }
public bool ShowPrint { get; set; } 
```

不知何故，我想定义一个 Dictionary 对象，其中 Enum Actions 作为键，属性作为值：

```
public Dictionary<Actions, ***Lambda magic***> ShowActionProperties = new Dictionary<Actions,***Lambda magic***> () {
    { Actions.View, () => this.ShowView }
    { Actions.Edit, () => this.ShowEdit }
    { Actions.Add, () => this.ShowAdd}
    { Actions.Delete, () => this.ShowDelete }
    { Actions.Archive, () => this.ShowArchive }
    { Actions.Cancel, () => this.ShowCancel }
    { Actions.Print, () => this.ShowPrint }
} 
```

我需要将属性而不是属性值传递到字典中，因为它们可能会在运行时发生变化。

想法？

-布伦丹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:17:58.380

您所有的示例都没有输入参数并返回一个布尔值，因此您可以使用：

```
Dictionary<Actions, Func<bool>> 
```

然后，您可以评估 lambda 以获取属性的运行时值：

```
Func<bool> fn = ShowActionProperties[ Actions.View ];
bool show = fn(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T00:19:05.230

听说过表达式树吗？ [Charlie Calvert 关于表达式树的介绍](http://blogs.msdn.com/b/charlie/archive/2008/01/31/expression-tree-basics.aspx?Redirected=true)

假设您要定义一个引用字符串属性的方法；你可以做到这一点的一种方法是有一个方法：

```
public string TakeAProperty(Expression<Func<string>> stringReturningExpression)
{
    Func<string> func = stringReturningExpression.Compile();
    return func();
} 
```

然后您可以通过以下方式调用：

```
void Main()
{
    var foo = new Foo() { StringProperty = "Hello!" };
    Console.WriteLine(TakeAProperty(() => foo.StringProperty));
}

public class Foo
{
    public string StringProperty {get; set;}
} 
```

然而，表达式树让你做的远不止这些；我衷心建议在那里做一些研究。:)

编辑：另一个例子

```
public Func<Foo,string> FetchAProperty(Expression<Func<Foo,string>> expression)
{
    // of course, this is the simplest use case possible
    return expression.Compile();
}

void Main()
{
    var foo = new Foo() { StringProperty = "Hello!" };
    Func<Foo,string> fetcher = FetchAProperty(f => f.StringProperty);
    Console.WriteLine(fetcher(foo));
} 
```

更多参考链接：

[表达式树和 lambda 分解](http://www.abhisheksur.com/2010/09/use-of-expression-trees-in-lamda-c.html)

[关于表达式树的 CodeProject 教程](http://www.codeproject.com/Articles/17575/Lambda-Expressions-and-Expression-Trees-An-Introdu)

[在 API 中使用表达式树](http://visualstudiomagazine.com/articles/2011/04/01/pccsp_expression-trees.aspx)

[表达树上令人惊叹的 Bart de Smet](http://bartdesmet.net/blogs/bart/archive/2009/08/11/14642.aspx)

# ios - 由于间隙，AVPlayer 流在后台停止

> ID：14115482
> 
> 赞同：4
> 
> 时间：2013-01-02T00:09:58.857
> 
> 标签：ios, audio-streaming, avplayer

`AVPlayer`当应用程序处于后台模式时，由于 iOS 空闲我正在尝试实现无缝播放。

在回答之前，是的，我已经修改了 plist，正确设置了音频会话，一切都很好而且花花公子，但是我相信我的问题本质上是不同的。

所以，起初我在我的班级中有一个方法可以在每次跟踪 URL 更改时初始化一个新的 AVPlayer，它工作得很好，但在后台不是那么多，我虽然每次创建一个全新的`AVPlayer`实例都行不通，所以我切换到很少有其他范例，例如`replaceCurrentItemWithPlayerItem`保持 AVPlayer 实例处于活动状态，甚至`AVQueuePlayer`.

我面临的问题是，在 iOS 6 上，音频停止的那一刻，因为一首曲目已完成而另一首曲目仍需加载，iPhone 将我的应用程序冻结在后台。如果我再次将我的应用程序置于前台，播放将正常恢复。

由于我没有连续流，而是要点击单独的 URL 以开始流式传输，因此我考虑使用`AVPlayerQueue`和`insertItem:next`/`advanceToNextItem`策略，试图不让任何最小的音频中断将应用程序冻结在后台。

然而问题仍然存在，因为我必须按需在队列中添加新曲目，并且当它缓冲时，iOS 已经认为我的应用程序值得停止。所以我需要在应用程序的生命周期中适当的时间来`insertItem`.

然后我试图收听这个 KVO 通知：

`[self.player.currentItem addObserver:self forKeyPath:@"playbackBufferFull" options:0 context:MyPlayerItemContext];`

但它永远不会被调用。这个想法是跟踪 currentItem 上的缓冲区已满，并将下一个附加到播放列表中，以便 AVQueuePlayer*可能会*尝试对其进行预缓冲。

由于`playbackBufferFull`永远不会被调用，另一个想法是尝试并获取当前时间/持续时间，计算 90% 的播放可能在哪里，并在适当的时间触发一个事件以开始缓冲下一首曲目。

考虑到对象的持续时间属性会并且可能会根据渐进式传入数据而改变，这听起来很糟糕吗？

我还可以采取哪些其他策略？

谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-02T07:38:01.607

我通过使用 AVQueuePlayer 和`AVPlayerActionAtItemEndAdvance`.

这很棘手，但它有效。

# php - 如何使用正则表达式提取文本？

> ID：14115483
> 
> 赞同：-3
> 
> 时间：2013-01-02T00:10:09.950
> 
> 标签：php, regex, arrays, preg-match-all

如何使用正则表达式从一组问题中提取问题和选择以及答案

例子 ：

```
1\. An FMS system, besides controlling navigation, thrust and auto-nav,
also provides:
a) take-off and landing warnings
* b) dedicated status and warnings
c) GPWS warnings

2\. EADI sky and ground display is provided by:
a) synthetic TV signals
* b) raster scan
c) stroke pulse 
```

我需要这样的输出：

```
$question[0] = "An FMS system, besides controlling navigation, thrust and auto-nav,also provides:";
$choice1[0] = "take-off and landing warnings";
$choice2[0] = "dedicated status and warnings";
$choice3[0] = "GPWS warnings";

$question[1] = "EADI sky and ground display is provided by:";
$choice1[1] = "synthetic TV signals";
$choice2[1] = "raster scan";
$choice3[1] = "stroke pulse"; 
```

标志的`*`意思是回答我应该写什么模式非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:40:24.540

```
$string = '1\. An FMS system, besides controlling navigation, thrust and auto-nav,
also provides:
a) take-off and landing warnings
* b) dedicated status and warnings
c) GPWS warnings

2\. EADI sky and ground display is provided by:
a) synthetic TV signals
* b) raster scan
c) stroke pulse';

$qa = array();
$string = explode("\n\n", $string);
foreach ($string as $set)
{
    $set = preg_split('/(\:?\s(\* )?[abc]\) )/', $set);
    $qa[] = array('question' => ltrim(strstr($set[0], ' ')), 
        'choice1' => $set[1],  'choice2' => $set[2],  'choice3' => $set[3]);
}

print_r($qa); 
```

输出：

```
Array
(
    [0] => Array
        (
            [question] => An FMS system, besides controlling navigation, thrust and auto-nav,
also provides
            [choice1] => take-off and landing warnings
            [choice2] => dedicated status and warnings
            [choice3] => GPWS warnings
        )

    [1] => Array
        (
            [question] => EADI sky and ground display is provided by
            [choice1] => synthetic TV signals
            [choice2] => raster scan
            [choice3] => stroke pulse
        )

) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:23:35.230

1.  在空行上展开以获得每个问题 + 答案。
2.  每一个都在`:`和*换行符*上展开，最多两部分，分成问题和答案。
3.  在换行符处展开答案以获得答案。

完毕。PHP function used: [`explode`](http://php.net/explode)，该手册提供了更多示例，我无法在此答案中提供更好的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:32:46.143

您可以像这样在数组中获得答案：

```
 $text='1\. An FMS system, besides controlling navigation, thrust and auto-nav,
      also provides:
      a) take-off and landing warnings
      * b) dedicated status and warnings
      c) GPWS warnings

      2\. EADI sky and ground display is provided by:
      a) synthetic TV signals
      * b) raster scan
      c) stroke pulse';

        $arr=explode("\n",$text);
        $correctanswer=array();
        $replacements=array('*','a)','b)','c)');
        $questions=array();
        $answers=array();
        $x=0;
        foreach($arr as $ar){
       if(preg_match('#[0-9]#',$ar)){
       $questions[$x][]=preg_replace('#[0-9]\\.#','',$ar);
       $x++;
         }

       if(preg_match('#[*]#',$ar)){
        $correctanswer[$x-1][]=str_replace($replacements,'',$ar);
         }
        $answers[$x-1][]=str_replace($replacements,'',$ar);
          }
      print_r($questions);
       echo '<br/>';
      print_r($correctanswer); 
```

印刷：

```
 Array
       (
       [0] => Array
           (
             [0] =>  An FMS system, besides controlling navigation, thrust and auto-     nav,
             )

      [1] => Array
            (
                [0] =>  EADI sky and ground display is provided by:
              )

            )
        Array
           (
            [0] => Array
                  (
                       [0] =>   dedicated status and warnings
                  )

            [1] => Array
                  (
                   [0] =>   raster scan
                   )

            ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T00:38:09.607

```
// Set up some variables
$question = $choice1 = $choice2 = $choice3 = $correct = array();

$string = '1\. An FMS system, besides controlling navigation, thrust and auto-nav,
also provides:
a) take-off and landing warnings
* b) dedicated status and warnings
c) GPWS warnings

2\. EADI sky and ground display is provided by:
a) synthetic TV signals
* b) raster scan
c) stroke pulse';

// Break question string into an array of questions with answers
$data = explode("\r\n\r\n", $string);

// Iterate through each question with answers
foreach ($data AS $i => $tmp)
{
    // Extract question and answers
    preg_match('/\d+\. (.*):\r\n(\*?)\ ?[abc]\) (.*)\r\n(\*?)\ ?[abc]\)\ (.*)\r\n(\*?)\ ?[abc]\)\ (.*)/s', $tmp, $matches);

    // Assign matches to variables
    $question[$i] = $matches[1];
    $choice1[$i] = $matches[3];
    $choice2[$i] = $matches[5];
    $choice3[$i] = $matches[7];

    // Figure out which answer is correct
    if ($matches[2] == '*')
    {
        $correct[$i] = 1;
    }
    else if ($matches[4] == '*')
    {
        $correct[$i] = 2;
    }
    else if ($matches[6] == '*')
    {
        $correct[$i] = 3;
    }
}

var_dump($question, $choice1, $choice2, $choice3, $correct); 
```

输出：

```
// $question
array(2) {
  [0]=>
  string(82) "An FMS system, besides controlling navigation, thrust and auto-nav,
also provides"
  [1]=>
  string(42) "EADI sky and ground display is provided by"
}
// $choice1
array(2) {
  [0]=>
  string(29) "take-off and landing warnings"
  [1]=>
  string(20) "synthetic TV signals"
}
// $choice2
array(2) {
  [0]=>
  string(29) "dedicated status and warnings"
  [1]=>
  string(11) "raster scan"
}
// $choice3
array(2) {
  [0]=>
  string(13) "GPWS warnings"
  [1]=>
  string(12) "stroke pulse"
}
// $correct
array(2) {
  [0]=>
  int(2)
  [1]=>
  int(2)
} 
```

# javascript - 禁用动画序列的点击功能

> ID：14115484
> 
> 赞同：1
> 
> 时间：2013-01-02T00:10:27.150
> 
> 标签：javascript, jquery, jquery-animate

我有一系列图像来创建动画。这可以通过使用下面的编码来工作，但是我遇到了一个常见的问题，即多次点击会在动画开始一个新动画时弄乱动画。

我需要能够在动画运行时禁用点击，或者类似的效果。它可以禁用单击直到动画完成，或者重置动画以重新开始并清除当前正在运行的序列。

我目前有以下代码：

```
$(".startbutton").click( function() {
$(this).clearQueue( function() {

$(this).find("ul li:nth-child(1)").delay(124).animate({opacity: 0.0}, 0).delay(1860).animate({opacity: 1.0}, 0);
$(this).find("ul li:nth-child(2)").delay(124).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(3)").delay(248).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(4)").delay(372).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(5)").delay(496).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(6)").delay(620).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(7)").delay(744).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(8)").delay(868).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(9)").delay(992).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(10)").delay(1116).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(11)").delay(1240).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(12)").delay(1364).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(13)").delay(1488).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(14)").delay(1612).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(15)").delay(1736).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(16)").delay(1860).animate({opacity: 1.0}, 0).delay(125).animate({opacity: 0.0}, 0);
$(this).find("ul li:nth-child(17)").animate({opacity: 0.0}, 0).delay(1984).animate({opacity: 1.0}, 0);

 });
}); 
```

我插入的`.clearQueue`作品是动画不能再被多次点击并搞砸了。然而，一旦动画序列完成，动画就不能再被点击并且不会再次运行。

我猜我需要“清除”“clearQueue”或类似的东西。

如果有人有任何建议，将不胜感激。我曾尝试使用人们在其他类似帖子中建议的 ':animated' 解决方案，这似乎是一个明智的解决方案，但到目前为止还没有解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:29:05.463

好的，由于 OP 提供了示例代码，我将相应地修改这个答案。

这是工作版本：

[http://jsfiddle.net/qZGMW/](http://jsfiddle.net/qZGMW/)

首先，按照我原来的建议使用标志：

```
var started = false;
$(selector).click(function() {
    if (started) { return; }
    started = true;
    $(this).stop(); // Do not use clearQueue
    // Do animation normally
    $(lastOne).animate(param, param, function() { started = false; });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:04:30.660

一般代码建议：相同形式的重复动作有一个[`for`循环](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)。正如您在下面看到的，它使代码更短、更清晰。关于您的主题，[`.clearQueue`](http://api.jquery.com/clearQueue)不将回调函数作为参数。只需在开始制作动画之前调用它。[`.stop`](http://api.jquery.com/stop)也可能有用，你可以试验一下效果，看看你喜欢什么。

```
$(".startbutton").click( function() {
    // $(this).clearQueue();  <- Correct usage, but unnecessary with .stop()
    $(this).stop(true, true);

    var $lis = $(this).find("ul li");
    $lis.stop(true, true);

    $lis.filter(":nth-child(1)")//.delay(124) <- Unnecessary delay here?
        .animate({opacity: 0.0}, 0).delay(1860).animate({opacity: 1.0}, 0);

    for ( var i=1; i< 16; i++ ) {
        $lis.filter(":nth-child(" + i+1 + ")")
            .delay( i * 124)
            .animate( {opacity: 1.0}, 0 )
            .delay( 125 )
            .animate({opacity: 0.0}, 0);
    }

    $lis.filter(":nth-child(17)")
        .animate({opacity: 0.0}, 0).delay(1984).animate({opacity: 1.0}, 0);
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:34:18.800

查看[此查询 API](http://api.jquery.com/event.preventDefault/)以防止发生默认操作。

只需尝试下面的代码片段..

```
$(".startbutton").click( function(e) {
   e.preventDefault();
   $(this).clearQueue( function() {
   your code continues... 
```

# mysql - 在 MySql 中摆脱空格的麻烦

> ID：14115485
> 
> 赞同：1
> 
> 时间：2013-01-02T00:10:45.157
> 
> 标签：mysql, string, ascii, space, spaces

我在 MySql 中有一个包含产品描述的列。有时描述包含更多单词之间的一个空格，我想把它变成一个空格，所以我用这个查询找到了它：

```
 SELECT * FROM `database`.`PRODUCTS` 
 WHERE `PRODUCTS`.`description` LIKE '%  %' 
```

然后通过以下方式修复它：

```
 UPDATE `database`.`PRODUCTS` 
 SET `PRODUCTS`.`description` = REPLACE(`PRODUCTS`.`description`,'  ',' ') 
```

但它并没有删除所有的双空格！有一些带有（我怀疑）不同ascii代码的“特殊”空间 -`0xA0,0xC2`

我怎样才能`SELECT`删除它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T00:20:23.683

这些不是“特殊”空间——它们不是 ascii 代码——如果它们在您的数据库中，那么您的代码中就有错误将它们放在那里。

为什么不直接替换它们？

```
....
SET PRODUCTS.description = REPLACE(
    REPLACE(
       REPLACE(PRODUCTS.description
             ,CHAR(160),' ')
           , CHAR(194), ' ')
       , '  ', ' '); 
```

# windows-services - 使 Windows 服务要求用户输入的最佳方法是什么？

> ID：14115487
> 
> 赞同：1
> 
> 时间：2013-01-02T00:11:02.160
> 
> 标签：windows-services, user-input, createprocess

我正在尝试编写一个程序来要求我定期输入一些信息，所以我用 C 语言编写了一个在后台运行的服务，我可以通过刷新它的日志文件来观察它报告它的情况。现在我被困在如何让它打开 cmd 并询问信息。

我想将此信息保存到日志文件中。（我打算监控我的睡眠习惯）

我尝试使用`system("getinput.exe")`，但似乎无济于事，我知道使用`system()`不好，但这是第一步。

`CreateProcess()`我根本无法开始工作，MSDN [http://msdn.microsoft.com/en-us/library/ms682512.aspx](http://msdn.microsoft.com/en-us/library/ms682512.aspx)`CreateProcess failed (2)`上的示例对我不起作用，例如，只要我尝试，我就会得到`createprocess.exe dir`。

一定有办法吗？

编辑：感谢您的回复，我将尝试采用不同的方法。我从哪里开始编写一个偶尔会在 C 中要求用户输入的后台应用程序？

# html - 为什么这条 CSS 行注释掉 eclipse 中的所有其他代码？

> ID：14115496
> 
> 赞同：1
> 
> 时间：2013-01-02T00:11:59.447
> 
> 标签：html, eclipse

所以我正在运行最新最好的 Eclipse，这行代码似乎总是注释掉它下面的所有内容。我不认为这段代码是错误的？此行包含在基础 css 框架下载中，这是我通常使用的吗？

```
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]--> 
```

提前非常感谢！

编辑**我很确定它应该是这个，这是正确的吗？

```
<!--[if gt IE 8]> <html class="no-js" lang="en"> <![endif]--> 
```

![在此处输入图像描述](../Images/18ac1fa0495788c0730982764aa690d2.png)

# c# - WebActivator.PreApplicationStartMethod 不起作用

> ID：14115497
> 
> 赞同：13
> 
> 时间：2013-01-02T00:12:40.883
> 
> 标签：c#, asp.net-mvc-4, structuremap

```
[assembly:  WebActivator.PreApplicationStartMethod(typeof(MyApp.App_Start.StructureMapMvc), "Start")]

namespace MyApp.App_Start
{
    public static class StructureMapMvc
    {
        public static void Start()
        {
            var container = IoC.Initialize();
            DependencyResolver.SetResolver(new SmDependencyResolver(container));
        }
    }
} 
```

这是我应该在 global.asax 中的 Application_start 之前运行的代码。我正在将我的 web 项目从 mvc 3 升级到 mvc 4。所以，在这个过程中，我在命名空间中犯了一个错误。在我更正我的命名空间之前，这是有效的。现在它不再起作用了。我重置了 iis/flushed dns/重建解决方案/删除了 C:\Windows\Microsoft.NET\Framework64\versionxxxxxx...\Temporary ASP.NET Files\root 中的临时 .net 文件。没有任何效果。我在这里错过了什么吗？Initialize() 方法有我所有的结构映射东西依赖解析的东西。所以，如果不弄清楚这一点，我就无法前进。试图诊断问题这么多小时，我需要帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-13T15:33:06.217

如果您的代码在**网站项目**中（即，在 App_Code 文件夹下），您不能使用*PreApplicationStartupMethod*！您可以改用*PostApplicationStartupMethod*。“Pre”方法在 global.asax *Application_Start* 运行之前执行，而“Post”在之后执行。

在我弄清楚这一点之前，我浪费了一个或两个小时，所以希望这能帮助其他人避免这种情况！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-19T09:45:11.243

My experience is that `WebActivator` will not work if your project settings (in `.csproj.user` or `.vbproj.user`) have the setting `<StartAction>NoStartPage</StartAction>` the fix is to set it to `<StartAction>CurrentPage</StartAction>` and it should then work next time you debug.

Also since it's in a `.user` file (which are typically not included in svn) it is difficult to determine why it works on some dev environments but not others.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-12T12:37:52.943

对我来说，我遇到的问题是使用 NuGet.Server 下载创建私有 NuGet 存储库时（它使用 WebActivatorEx PreApplicationStartMethod 属性）。

我所做的是创建一个空网站项目。这是不正确的：它必须是一个空 Web*应用程序*项目。一旦我创建了空 Web 应用程序并重新安装了 NuGet.Server，一切正常。

所以：如果您使用了 Empty Web Site 项目，这可能就是您遇到问题的原因。请改用空 Web 应用程序项目。

我认为 Empty Web Site 项目缺少一些 ASP.NET “胶水”，它使 System.Web.PreApplicationStartMethod（由 WebActivatorEx 使用）能够工作。也许知道更多细节的人可以解释为什么会这样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T06:01:17.247

在`WebActivator`1.5.3 版本中， `MyClass.cs.pp`文件不能只存在于`App_Start`文件夹中，**而是必须存在于`content\App_Start`文件夹**中，以便在目标项目`nuget install`中创建转换后的文件。`App_Start`

据我所知，这是无证的。

注意：只要原始文件`.nupkg`是`nuget pack`使用传统文件系统方法构建的，此解决方案似乎就可以工作，但**在**使用`nuget pack`以特定`.csproj`文件为目标时则不行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-05T02:16:02.123

我的问题是双重的。

1) 没有声明类型的完整路径

2）将属性放在命名空间内，而不是之前

一旦我解决了这两个问题，它就起作用了。

```
[assembly: WebActivatorEx.PreApplicationStartMethod(typeof(MyApp.Api.Controllers.MyController), "AutoMapperStart")]

namespace MyApp.Api.Controllers
{

    public class MyController : ApiController
    {
        public static void AutoMapperStart()
        {
            MyMapperConfig.DefineMappings();
        }
    }
} 
```

# amazon-web-services - Elastic beanstalk Auto Scaling - 多长时间启动一个新实例

> ID：14115502
> 
> 赞同：3
> 
> 时间：2013-01-02T00:13:20.090
> 
> 标签：amazon-web-services, amazon-elastic-beanstalk, autoscaling

我正在尝试决定使用什么指标作为 eb 自动缩放触发新实例的触发器，而我倾向于 atm 是响应时间 - 所以如果用户在 4 秒内没有得到响应另一个 ec2 实例被启动。

但是，我正在努力寻找的是 eb 平均需要多长时间才能使另一个实例联机。我只是担心，如果它达到现有实例无法应对负载的地步，人们是否会被拒绝连接和/或在几分钟内体验到极慢的网站，直到自动缩放检测到问题并使另一个实例上线？

如果有人在电子商务解决方案方面有这方面的经验，我很想听听您发现什么自动缩放配置可以确保无缝的用户体验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T16:36:52.950

这实际上取决于您的应用程序。不过，通常情况下，您预计新实例需要 5-10 分钟才能上线、向 ELB 注册并开始提供流量。

自动缩放并非真正用于突发，当您拥有可预测的流量模式时，它会更好地工作。但是使用自定义 Cloudwatch 指标，您可以做一些非常酷的预测性事情，这些事情会根据外部因素自动扩展，例如：Twitter 提及量、谷歌分析数据、活跃用户会话数等。

# c# - 测量包含宽字符的字符串的长度

> ID：14115503
> 
> 赞同：7
> 
> 时间：2013-01-02T00:13:21.813
> 
> 标签：c#, silverlight, unicode, split

我有以下字符串：

```
友又 
```

相应的 UTF-16 表示（小端）是

```
CB 53 40 D8 87 DC C8 53
\___/ \_________/ \___/
  友              又 
```

`"友又".Length`返回 4，因为 CLR 将字符串存储为 4 个 2 字节字符。

如何测量我的字符串的长度？我如何将其拆分为`{ "友", "", "又" }`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-02T00:18:11.437

据[记载](http://msdn.microsoft.com/en-us/library/system.string.length.aspx)：

> 该`Length`属性返回`Char`此实例中的对象数，而不是 Unicode 字符数。原因是一个 Unicode 字符可能由多个`Char`. 使用[`System.Globalization.StringInfo`](http://msdn.microsoft.com/en-us/library/system.globalization.stringinfo.aspx)该类来处理每个 Unicode 字符而不是每个 Char。

* * *

获取长度：

```
new System.Globalization.StringInfo("友又").LengthInTextElements 
```

* * *

[此处记录了](http://msdn.microsoft.com/en-us/library/x2f3k4f6.aspx)获取每个 Unicode 字符，但制作扩展方法要方便得多：

```
public static IEnumerable<string> TextElements(this string s) {
    var en = System.Globalization.StringInfo.GetTextElementEnumerator(s);

    while (en.MoveNext())
    {
        yield return en.GetTextElement();
    }
} 
```

`foreach`并在 LINQ 语句中使用它：

```
foreach (string segment in "友又".TextElements())
{
    Console.WriteLine(segment);
} 
```

这也可以用于长度：

```
Console.WriteLine("友又".TextElements().Count()); 
```

# php - 此脚本是否存在 SQL 注入风险？

> ID：14115509
> 
> 赞同：0
> 
> 时间：2013-01-02T00:14:00.843
> 
> 标签：php, mysql, code-injection

只是问你们是否可以注意到此代码中的任何 SQL 注入可能性，如果发现请回复。此代码用于从 MySQL 数据库加载简单的“笑话”。谢谢 ：）

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title></title>
    </head>
    <body>
        <?php

        try
        {
            $pdo = new PDO('mysql:host=localhost;dbname=website', 'root', '');
            $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
            $pdo->exec('SET NAMES "utf8"');
        }
        catch (PDOException $e)
        {
            $error = '<font color="red"><strong><p align="center">Unable to connect to the database server. Please visit again later!</p></strong></font>';
            include 'error.html.php';
            exit();
        }

        try
        {
            $sql = 'SELECT joketext FROM joke';
            $result = $pdo->query($sql);
        }
        catch (PDOException $e)
        {
            $error = '<font color="red"><strong><p align=center>Error Fetching Jokes</p></strong></font>';
            include 'error.html.php';
            exit();
        }

        while ($row = $result->fetch())
        {
            $jokes[] = $row['joketext'];
        }

        include 'jokes.html.php'; // Array listing parse
        ?>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:16:27.377

您不接受任何用户输入，因此不可能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T00:18:54.060

当您不清理用户输入时，就会发生 SQL 注入。

例子：

```
"SELECT joketext FROM joke WHERE joker = " . $_GET['joker'] 
```

这很糟糕，因为我可以在变量 ( ) 中放入任何我想要的东西`http://yoursite.com/joke.php?joker=whatever`，它会被执行！

你不接受用户输入，所以我没有任何机会做这样的事情。您执行的查询每次都是相同的，并且在您的 php 文件中进行了硬编码。

[在Wiki](http://en.wikipedia.org/wiki/SQL_injection)上阅读有关 SQL 注入的更多信息。

# internet-explorer-7 - ie7 z-index 奇怪的行为

> ID：14115511
> 
> 赞同：0
> 
> 时间：2013-01-02T00:14:12.420
> 
> 标签：internet-explorer-7, z-index

我对 ie7 **z-index**行为有疑问。

用ie7打开[这个页面](http://www.aralimentare.com/)，下拉菜单（有些部分有，有些没有）落在滑块后面。

我尝试使用父元素的 z-index 和位置来解决，但无法解决问题。

您知道如何使下拉菜单保持在滑块的前面吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:07:54.037

尝试用一个额外的容器包装导航菜单，然后给包装 div 一个比导航菜单中使用的 z-index 更大的 z-index。

这是2006 年在[此处](http://www.quirksmode.org/bugreports/archives/2006/01/Explorer_z_index_bug.html)报告的 IE7 的已知问题。

有一篇文章显示了可用于解决问题的解决方法。看看[这里](http://brenelz.com/blog/squish-the-internet-explorer-z-index-bug/)。

例如，假设您的导航菜单有一个`div`with `id="menu"`，您应该执行以下操作：

```
<div id="wrapper" style="position:relative; z-index: 1000;">
    <div id="menu" style="position:absolute; z-index: 999;"></div>
</div> 
```

我认为您可以轻松地将其适应您的网站。现在我没有 IE7 的副本，我无法重现该问题，但您可以尝试，这应该可以解决您的问题。如果没有，我会尽力为您提供进一步的帮助。

# android - 为什么我会在 ActionBar 中获得相同选项菜单项的副本？

> ID：14115514
> 
> 赞同：0
> 
> 时间：2013-01-02T00:14:23.293
> 
> 标签：android, android-fragments, actionbarsherlock

我将 ActionbarSherlock 与 Fragments 一起使用。在其中一个片段中，我在操作栏中添加了一个选项菜单项。它显示出来，当我单击它时，我会收到一个回调，在该回调中我移动到另一个 Activity。当我返回此活动时，我会在操作栏中获得相同选项菜单项的另一个副本。我知道有两个选项可以按。两者都有效。如何摆脱额外的菜单项？

菜单如下所示：

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
    <item
    android:id="@+id/menu_scan_book"
    android:orderInCategory="100"
    android:showAsAction="ifRoom"
    android:title="@string/menu_scan_book"/>
</menu> 
```

在我的 SherlockFragment 我有这个代码

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setHasOptionsMenu(true);
}

@Override
public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
    super.onCreateOptionsMenu(menu, inflater);
    inflater.inflate(R.menu.scan_book_action_menu, menu);
} 
```

在拥有我试图调用的 Fragment 的 SherlockFragmentActivity 中

> 支持无效选项菜单（）

当我从我移到上面的活动中返回时。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T16:20:50.577

你试过打电话`menu.clear()`吗`public void onCreateOptionsMenu(Menu menu, MenuInflater inflater)`？这只是一种解决方法，但它对我有用。

转到此处了解更多信息：[具有相同菜单的片段，在相同布局上导致重复的 menuitem](https://stackoverflow.com/questions/8472776/fragments-with-the-same-menu-on-the-same-layout-cause-duplicated-menuitem/8495697#8495697)

# c++ - x op y 的确切名称查找规则是什么？

> ID：14115516
> 
> 赞同：1
> 
> 时间：2013-01-02T00:14:43.413
> 
> 标签：c++, c++11

遇到的时候

```
x op y 
```

ADL 是否找到成员 x.op(y)？或者指定的查找好像不是 x.op(y)，然后是 ADL(op, x, y)？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:23:44.157

考虑成员候选人、非成员候选人（有 ADL）和内置候选人。最佳候选人被选中。

*[over.match.oper]/3*

> 对于具有`operator @`cv 非限定版本为 的类型的操作数的一元，以及具有 cv 非限定版本为的类型的左操作数和 cv 非限定版本为的类型的右操作数`T1`的二进制，三组候选函数、指定成员候选、非成员候选和内置候选的构造如下：`operator @``T1``T2`
> 
> *   如果`T1`是一个完整的类类型，则该成员候选集是`T1::operator@`(13.3.1.1.1)的合格查找的结果；否则，候选成员集合为空。
>     
>     
> *   非成员候选集是根据非`operator@`限定函数调用 (3.4.2) 中名称查找的常用规则在表达式上下文中非限定查找的结果，除了忽略所有成员函数。但是，如果没有操作数具有类类型，则只有查找集中的那些非成员函数具有类型的第一个参数`T1`或“reference to (possibly cv-qualified) `T1`”，when`T1`是枚举类型，或者（如果有右操作数）类型的第二个参数`T2`或“对（可能是 cv 限定的）的引用`T2`”，当`T2`是枚举类型时，是候选函数。
>     
>     
> *   对于`operator ,`、一元`operator &`或`operator ->`，内置候选集为空。对于所有其他运算符，内置候选函数包括 13.6 中定义的所有候选运算符函数，与给定运算符相比，
>     
>     
>     *   具有相同的操作员名称，并且
>     *   接受相同数量的操作数，并且
>     *   接受可以根据 13.3.3.1 将给定操作数转换为的操作数类型，以及
>     *   没有与任何非模板非成员候选相同的参数类型列表。

*[over.match.oper]/6*

> 用于重载解决的候选函数集是成员候选、非成员候选和内置候选的并集。参数列表包含运算符的所有操作数。根据 13.3.2 和 13.3.3 从候选函数集中选择最佳函数。

# regex - 如何设置不匹配的正则表达式？

> ID：14115522
> 
> 赞同：9
> 
> 时间：2013-01-02T00:15:19.907
> 
> 标签：regex, regex-negation

只是为了好奇。

是否可以创建一个不匹配任何字符串（包括空字符串）的正则表达式？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-02T00:25:45.110

是的。

这里有一些例子。

```
.^
$.
(?!) 
```

自然，这样的表达方式不计其数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T00:25:34.650

这个正则表达式永远不应该匹配任何东西（前提是你不使用单行或多行修饰符）：

```
$x^ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:27:49.530

怎么样`/^$x/.` 当我用红宝石尝试它时，它似乎工作。

# javascript - 在 JS 应用程序中保护 API 密钥

> ID：14115525
> 
> 赞同：1
> 
> 时间：2013-01-02T00:15:51.720
> 
> 标签：javascript

我是 JavaScript 新手。

我想要的帮助是了解如何保护用于访问我的 Restful Web 服务的 API 密钥。

我正在使用 API 密钥访问一些 Restful Web 服务，我希望这些 API 密钥受到保护。当我将 API 密钥放在控制器中时，它们将对用户可见，因为最终用户可以看到 Javascript 代码。

无论如何，我可以将这些注册为一些变量并在查看 Javascript 代码的最终用户看不到 API 密钥的控制器中使用吗？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T00:20:16.557

如果您需要保护任何东西，请在服务器上执行。例如，您可以在服务器上代理 api 调用，但您无法使用客户端 javascript 代码保护任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-02T01:00:07.723

你完全糊涂了。

您正试图[通过默默无闻来实现安全性](http://de.wikipedia.org/wiki/Security_through_obscurity)。客户端上的所有内容都是透明可破解的。

只有在成功的身份验证和授权后，才应允许用户访问资源。时期。

因此，如果您的 API 密钥应该是秘密的（如 Facebook 提供的，...），您必须将它们存储在服务器上

（顺便说一句：删除 angularjs 标签）。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-15T11:47:13.797

我将 AngularJS 与 PlayFramework 一起使用，似乎我可以解决这个问题，因为外部 Web 服务/API 是通过 Play 控制器访问的，其中控制器方法由 AngularJS 模型访问

`jsRouter.controllers.Application.tasks().ajax`

因此，外部 API 密钥不必在 AngujarJS 模型中。

谢谢大家的帮助。

# c - 在 C 中解析 CSV 文件

> ID：14115529
> 
> 赞同：9
> 
> 时间：2013-01-02T00:16:13.403
> 
> 标签：c, parsing, csv

是否有一个库可以用来解析 C 中的 CSV 文件。我在 Linux 系统上。我知道[这一点](http://code.google.com/p/csv-parser-cplusplus/)，但它是在 C++ 中的，我需要 C 中的一些东西。不想经历调试和测试的痛苦，如果有人已经这样做了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-02T00:41:55.887

看看[libcs​​v](http://sourceforge.net/projects/libcsv/)，它是一个用 ANSI C89 编写的 CSV 库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-02T00:19:07.193

[有一个简单的 CSV 解析器库，在Kernighan 和 Pike](http://smile.amazon.com/dp/020161586X)的优秀书籍[The Practice of Programming](http://www.cs.princeton.edu/~bwk/tpop.webpage/)中进行 了描述，源代码可从链接到的站点获得。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-02T00:22:58.120

解析 CSV 并不太复杂，取决于 CSV 的结构，看看 [strtok](http://www.cplusplus.com/reference/cstring/strtok/)函数。

# java - 如果一个字符串包含某个字母的确切次数

> ID：14115533
> 
> 赞同：-2
> 
> 时间：2013-01-02T00:17:16.790
> 
> 标签：java, string

在 Java 中，有没有一种说法 .. 例如“这个词是否包含三个 Z？”

我猜可能有一些聪明的 char 值？

```
String word = "pizzaz"

// Check if word contains three z's
boolean b = word.contains("SOME CLEVER CHAR VALUE??"); 
```

如果可能，在通过“次数”时是否可以使用整数值，即

`int letterAmount = 3;`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-02T00:23:21.927

您可以使用正则表达式来做到这一点。按照你的例子：

```
word.matches(".*(z.*){3}.*") 
```

如果您的字符串有 3 个 z，则返回 true。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-02T00:23:24.313

计算单字符匹配的一种有点昂贵且迂回的方法如下：

```
String s = "pizzaz";
int numMatches = s.length() - s.replaceAll("z", "").length(); 
```

当`"z"`从原始字符串的长度中减去所有 s 的字符串长度时，您最终得到`z`原始字符串中 s 的数量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T00:20:32.827

使用[Apache Commons](http://commons.apache.org/)：

```
boolean hasThreeZs = StringUtils.countMatches("pizzaz", "z") == 3; 
```

或使用 Spring 的[StringUtils版本](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/util/StringUtils.html)

```
boolean hasThreeZs = StringUtils.countOccurrencesOf("pizzaz", "z") == 3; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T00:37:34.057

根据字符串的大小，另一种选择是遍历字符串，计算字符数：

```
public static boolean contansCharCount(String s, char targetC, int targetCount) {
  char[] sArray = s.toCharArray();

  int actualCount = 0;

  for(char c : sArray)
    actualCount = (c == targetC) ? actualCount + 1 : actualCount;

  return (actualCount == targetCount);
} 
```

这需要 O(N) 时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-02T00:41:18.290

```
String word = "pizzaz";    
System.out.println(word.replaceAll("[^z]","").equals("zzz")); 
```

# c# - Windows 应用商店应用程序中的 WrapGrid 错误

> ID：14115543
> 
> 赞同：0
> 
> 时间：2013-01-02T00:18:29.130
> 
> 标签：c#, grid, windows-store-apps

我尝试`WrapGrid`在我的应用程序中初始化并设置它，`height`然后`width`我将孩子作为控件添加到它然后我将它作为一个孩子添加到与普通 Windows 7 应用程序相同的地方，但我发现问题出在哪里！！！！ ?`itemheight``itemwidth``Border``WrapGrid``Canvas``xaml`

```
 WrapGrid new_wrap = new WrapGrid();
            new_wrap.Height = 75;
            new_wrap.Width = 75;
            new_wrap.ItemHeight = 16;
            new_wrap.ItemWidth = 16;
 Border imgborder = new Border();
                imgborder.CornerRadius = new CornerRadius(5);
                imgborder.Height = 16;
                imgborder.Width = 16;
                imgborder.BorderThickness = new Thickness(1, 1, 1, 1);
                imgborder.BorderBrush = new SolidColorBrush(Colors.Black);
                imgborder.Margin = new Thickness(10, 10, 0, 0);
                new_wrap.Children.Add(imgborder);
new_shape_g.Children.Add(new_wrap); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T02:18:07.600

我发现最好的方法是使用 `VariableSizedWrapGrid`而不是`WrapGrid`它会起作用。

# c# - AJAX Masked 文本框自定义掩码

> ID：14115547
> 
> 赞同：0
> 
> 时间：2013-01-02T00:19:03.313
> 
> 标签：c#, jquery, asp.net, web, ajaxcontroltoolkit

我的页面上有一个滑块，我想对其进行设置，以便当用户滑动时（以分钟为单位），它会显示当前选择的“漂亮”版本。因此，例如，如果滑块在“60”上，那么它将显示“1 小时”，如果在“65”上，它将显示“1 小时 5 分钟”

最好的方法是什么？如果它是 MaskedEditExtender 控件上的自定义掩码，那么我将如何实现呢？我在 c# 上编写了代码，但我不希望它在鼠标松开时改变，而是在滑块本身移动时改变。

希望我说得通！提前致谢。:)

这是当前的滑块：

```
 <div class="controlColumn">                    
            <asp:TextBox  ID="Slider1"  runat="server" Width="400px"  AutoPostBack="True"></asp:TextBox>
            <ajaxToolkit:SliderExtender runat="server" ID="sPrepTime" Minimum="0" Maximum="1440" Decimals="0" Steps="288" TargetControlID="Slider1" BoundControlID="Slider1_BoundControl" Orientation="Horizontal"></ajaxToolkit:SliderExtender>
            <asp:TextBox  ID="Slider1_BoundControl"  runat="server" Width="100px" OnTextChanged="Slider1_BoundControl_TextChanged" TextMode="Number" AutoPostBack="True"></asp:TextBox>
            <asp:Label ID="lblPrepTime" runat="server"></asp:Label>
        </div> 
```

一旦鼠标停止选择滑块，OnTextChanged 就会触发。

**更新**

我无法使用 AJAX 滑块完成我需要的工作，但使用下面提供的 javascript 移动到了 Jquery UI 滑块。我的jQuery代码是：

```
$(function() {       
    $( "#slider" ).slider({            
        value:0,            
        min: 0,            
        max: 1440,            
        step: 5,            
        slide: function( event, ui ) {                
            $("#MainContent_amount2").val(ui.value);
            $('#MainContent_lblPrepTime').text(minutesToText(ui.value));

        }        
    });        
    $("#MainContent_amount2").val($("#slider").slider("value"));
}); 
```

您可以在此处找到有关 Jquery UI 的更多信息：http: [//jqueryui.com/slider/#default](http://jqueryui.com/slider/#default)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:40:34.940

可以为您提供javascript数字到文本解析代码

```
function minutesToText(val) {
    var hours = parseInt(val / 60,10),
        minutes, hourText = '',
        minuteText = '';
    if(hours >= 1) {
        minutes = val - (hours * 60);
        hourText = hours + ' hour' + pluralize(hours)+', '

    } else {
        minutes = val;
    }
    minuteText = minutes+ ' minute' + pluralize(minutes);
    return hourText + minuteText;
}

function pluralize(num) {
    return num == 1 ? '' : 's'
} 
```

我对 ajaxToolkit 不是很熟悉，所以我不确定 asp.Net 将如何注册这个自定义方法。如果使用手动代码进行初始化会相当简单

演示：http: [//jsfiddle.net/4UBJM/2/](http://jsfiddle.net/4UBJM/2/)

# c++ - 带有 c++ 类的 OpenGL

> ID：14115550
> 
> 赞同：2
> 
> 时间：2013-01-02T00:19:25.557
> 
> 标签：c++, class, opengl, inheritance

我一直在尝试编写一些可以让我使用类轻松管理 OpenGL 的东西。

我采用了一种方法，即拥有一个 Drawable 类[形状/等将继承并覆盖绘图函数]，然后使用 Controller 类遍历 Drawable 类表并将它们全部绘制出来。我注意到的唯一问题是从 Drawable 类而不是 Rectangle 类调用 draw() 方法。??

```
 class Drawable {
        public:
            void draw();
    };
    class Rectangle : public Drawable {
        public:
            void draw();
    };
    class Controller {
        public:
            Drawable ents[200];
            int ent_count;
            void frame();
            void append(Drawable item); // this will add an object onto the list
            Controller();
    };
    void Drawable::draw() {
        // this is the default drawing function, which should be overridden
    }
    void Rectangle::draw() {
        // gl functions here
    }
    void Controller::frame() {
        for(int i=0;i<ent_count,i++) {
            ents[i].draw(); // draw all entities on the list
        }
        // here, a timer would loop back the frame() function
    }
    void Controller::append(Drawable item) {
         ents[ent_count++]=item;
    }
    int main(void) {
         Controller main_controller; // create a controller
         Rectangle rect; // create a rectangle
         main_controller.append(rect); // insert rectangle into controller list
         main_controller.frame(); // start the frame loop
    } 
```

[如果有轻微的打字错误，那是因为它是作为方法摘要写的。]我尝试使用的这种方法不是很成功，我很确定它与遗产。有任何想法吗？整个源代码：

```
#include <iostream>
#include <GL/glfw.h>
#include <GL/gl.h>
class Drawable {
      public:
             int x,y;
             void draw();
             void frame();
             void create();
             void destroy(); 
};
void Drawable::create() {

}
void Drawable::draw() {
}
class Rectangle : public Drawable {
      public:
      int w,h;
      unsigned short r,g,b;
      Rectangle(int x,int y, int w, int h, unsigned short r, unsigned short g, unsigned short b);
      void draw();
};
void Rectangle::draw() {
     glColor3ub(r,g,b);
     glBegin(GL_QUADS);
     glVertex2i(x,y);
     glVertex2i(x+w,y);
     glVertex2i(x+w,y+h);
     glVertex2i(x,y+h);
     glEnd();
}
Rectangle::Rectangle(int x,int y, int w, int h, unsigned short r, unsigned short g, unsigned short b) {
                         this->x=x;
                         this->y=y;
                         this->w=w;
                         this->r=r;
                         this->g=g;
                         this->b=b;
}
class Controller {
public:
       Controller(int w,int h,int fsaa,bool fs,bool vsync,const char* title);
       bool running;
       int frame_limit;
       Drawable entity[200];
       int entity_count;
       void fev();
       void begin();
       void bind();
       void append(Drawable item);
      };
Controller::Controller(int w,int h,int fsaa,bool fs,bool vsync,const char* title) {
                          int fullscreen= (fs ? GLFW_FULLSCREEN : GLFW_WINDOW);
                          bool window=glfwOpenWindow(w,h,0,0,0,0,10,10,fullscreen);
                          glfwSetWindowTitle(title);
                          frame_limit=120;
                          entity_count=0;
                          std::cout << (window ? "Successfully initialized a window.\n" : "Error initializing window!\n");
       }
void Controller::begin() {
     glMatrixMode(GL_PROJECTION);
     glLoadIdentity();
     glOrtho(0,640,480,0,0,5);
     glMatrixMode(GL_MODELVIEW);
     glLoadIdentity();
     glClearColor(0.4f,0.4f,0.4f,1.0f);
     running=true;
     fev();
}
void Controller::append(Drawable item) {
     entity[entity_count++]=item;
}
void Controller::fev() {
     glClear(GL_COLOR_BUFFER_BIT);
     for (int i=0;i<entity_count;++i) {
          entity[i].draw();
          }
     glfwSwapBuffers();
     if (frame_limit>0) {
        glfwSleep(1000/frame_limit*0.001);
     }
     if (running) {
        if (glfwGetKey(GLFW_KEY_ESC) || !glfwGetWindowParam(GLFW_OPENED)) {
           running=false;
        }
        fev();
     } else {
       std::cout << "terminated!";
}
}
int main(void) {
    glfwInit();
    Controller main(640,480,0,false,false,"WindTitle");
    Rectangle rect(50,50,50,50,50,50,50);
    main.append(rect);
    main.begin();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:34:55.410

> 我一直在尝试编写一些可以让我使用类轻松管理 OpenGL 的东西。

新手经常尝试这个。但是 OpenGL 确实不能很好地转化为 OOP。问题是，它是一个有限状态机，要正确映射到 OOP，您必须在不同类和实例之间进行大量状态跟踪。

我自己至少尝试了 3 次将 OpenGL 抽象为 OOP 方案。它总是以某种方式破裂。

这并不是说您不能将 OOP 与 OpenGL 一起使用。您不能只将 OpenGL 概念 1:1 映射到类中。

* * *

关于您的实际问题：使用虚拟功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-02T00:32:26.433

正如其他人所提到的，最好尝试使用一些现有的包装器。

也就是说，您需要为实体列表使用指针。[您在切片](https://stackoverflow.com/questions/274626/what-is-the-slicing-problem-in-c)时遇到问题。

正如提到的一些评论，您需要进行`Drawable::draw()`虚拟化，因此调用`draw()`将`Drawable`调用子实现。也就是说，因为您将`Drawable`s 添加到对象列表而不是指向对象的指针列表中，所以正在对对象进行切片。这意味着它们正在从子类型转换回`Drawable`对象，从而删除有关特定类型的额外信息。

所以代替这个：

```
Drawable ents[200]; 
```

你应该这样做：

```
std::vector<Drawable*> ents; 
```

或者如果你有 C++11 或 Boost：

```
std::vector<std::shared_ptr<Drawable>> ents; 
```

并且您的附加方法将作为参考。

```
void Controller::append(Drawable &item) {
     ents[ent_count++] = &item;
} 
```

或者

```
void Controller::append(Drawable &item) {
  ents.push_back(&item);
} 
```

或者

```
void Controller::append(std::shared_ptr<Drawable> item) {
  ents.push_back(item);
} 
```

你的渲染循环会是这样的：

```
for (int i = 0; i < ents.size(); ++i) {
  ents[i]->draw();
} 
```

这个循环也可以清理使用`iterator`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:54:49.427

您可能想看看[Coin3D](https://bitbucket.org/Coin3D/coin/wiki/Home)。它是围绕 OpenGL 的大量丰富的 C++ 类包装器。你可以看看他们是如何使用它的。有用于与各种窗口系统（Qt、Windows、Cocoa...）集成的库。

# r - R中c（）函数中项目数的限制

> ID：14115551
> 
> 赞同：-8
> 
> 时间：2013-01-02T00:19:36.587
> 
> 标签：r

R 中的 c() 函数中可以包含的项目数量似乎是有限的（100 项）。有什么办法可以规避这个限制吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:33:42.387

有一个限制，但它是向量长度的限制，而不是 的限制`c`：

```
length(eval(call('c', 1:(2^31-1))))
## [1] 2147483647

length(eval(call('c', 1:(2^31))))
## Error in 1:(2^31) : result would be too long a vector 
```

# windows-phone-8 - 包括 comdef.h 在内的问题

> ID：14115559
> 
> 赞同：1
> 
> 时间：2013-01-02T00:21:02.097
> 
> 标签：windows-phone-8

我正在尝试将一些现有代码移植到 WP8 并遇到了问题。我要移植的代码使用在 comdef.h 中定义的智能指针，但由于某种原因，当我尝试包含 comdef.h 时，出现以下错误。

comdef.h(25)：致命错误 C1083：无法打开包含文件：'olectl.h'

我了解错误的含义，并且在我的机器上的 WP8 SDK 包含路径中似乎没有“olectl.h”的痕迹。还有其他人有这个问题吗，我尝试“修复”我安装的“Visual Studio 2012 Express for Windows Phone”

我发现了一些似乎包含 comdef.h 的代码，并且通过根本不使用宏并明确使用宏将扩展为的代码，解决了本文末尾的链接所讨论的丢失宏问题。（这是我想做的代码：[https](https://devel.nuclex.org/framework/browser/graphics/Nuclex.Graphics.Native/trunk/Source/Rasterization/Direct3D11/Direct3D11Api.h?rev=1782) ://devel.nuclex.org/framework/browser/graphics/Nuclex.Graphics.Native/trunk/Source/Rasterization/Direct3D11/Direct3D11Api.h?rev=1782 ）

有没有其他人经历过这种情况，或者安装了 SDK 的人可以尝试在某处包含 comdef.h 以查看它是否适用于他们。

缺少的宏链接： [http ://connect.microsoft.com/VisualStudio/feedback/details/751127/com-smartptr-typedef-causes-errors-when-used-in-winrt-build](http://connect.microsoft.com/VisualStudio/feedback/details/751127/com-smartptr-typedef-causes-errors-when-used-in-winrt-build)

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T18:00:40.947

是的，我也看到了，所以看起来这是“设计使然”。

基本上，如果该 API 未[在 MSDN 上受支持的 COM/Win32 API 列表中列出](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj207198%28v=vs.105%29.aspx)，则它不是 Windows Phone 8 上受支持的 API。看起来只`combaseapi.h`支持标头。

`_com_ptr_t<T>`它的朋友不在名单上...

# php - $rows 作为纯数据模型？

> ID：14115560
> 
> 赞同：-1
> 
> 时间：2013-01-02T00:21:20.803
> 
> 标签：php, drupal, drupal-views

> **可能重复：**
> [Drupal 7 视图 - 如何在自定义模板中访问未格式化的 $row 变量？](https://stackoverflow.com/questions/5307416/drupal-7-views-how-to-access-unformatted-row-variable-in-a-custom-template)

我正在覆盖一个如下所示的新闻模板：

```
<?php if ($rows): ?>
<div class="view-content">
    <?php print $rows; ?>
</div> 
```

困扰我的是，内容`$rows`总是必须是包含标记的元素。我想要纯数据模型，没有任何标记作为数组或对象。

我怎样才能做到这一点？我也愿意使用视图以外的其他模块来实现类似 MVC 的模板样式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T13:40:37.393

而是覆盖[`views-view-fields.tpl.php`](http://api.drupal.org/api/views/theme!views-view-fields.tpl.php/7)模板。这用于每个单独的行，并为您提供`$fields`包含对象形式的每个字段的数组。

```
<div class="example-row">
    <span class="example-name"><?php echo $fields['name']->content; ?></span>
    <span class="example-address"><?php echo $fields['field_address_value']->content; ?></span>
</div> 
```

# c# - 通过 Internet 向自定义客户端公开数据库数据

> ID：14115563
> 
> 赞同：2
> 
> 时间：2013-01-02T00:21:33.780
> 
> 标签：c#, web-services, service

我正在寻找一个服务或控制台应用程序，它将等待来自客户端应用程序的通信，根据接收到的数据运行查询并将查询结果返回给客户端应用程序。

这样做的原因是为了避免将数据库访问信息（用户名、密码、数据库等）硬编码到客户端中。这也将减少客户需要完成的处理量。因此，服务或控制台需要能够同时处理多个连接并快速处理它们。

该服务接收到的数据将通过 Internet 或本地 Intranet 传输，因此它需要能够侦听所有端口或可以被告知侦听单个端口。

视觉上看起来像这样；

![控制台/服务](../Images/bab0c99ad4a6f59fd888b980870f3c86.png)

任何参考资料或代码片段将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T00:32:01.930

您可以通过多种方式公开您的数据：

*   [WCF 服务](http://msdn.microsoft.com/en-us/library/ms731082.aspx)具有用于公开不同实体/数据集的多个操作。您可以公开 HTTP/HTTPS 或 TCP/IP 端点，它们是一些最常用的端点。
*   [WCF 数据服务](http://msdn.microsoft.com/en-us/library/cc668792.aspx)（[OData 协议](http://www.odata.org/)实现）。这允许以更灵活的方式向客户端公开数据。您正在向客户端提供一系列 REST 端点（也是 HTTP(S)），但通过能够指定各种过滤器，它们在告诉您的服务器组件返回什么数据方面具有更大的灵活性。这里更好的部分是，您不必在服务器端做太多事情来满足不同类型的查询（与普通的 WCF 服务相反，通常您必须为每个查询创建一个操作）。

这些是我要研究的选项。服务器组件可以是 Windows 服务，在这种情况下，您将被限制为传统的 WCF 服务，也可以是托管在 IIS 中的 Web 服务应用程序。

您现在可以深入了解这两种技术。为此提供代码片段几乎是不可能的，因为它们不是易于阅读的片段，而是大量代码。我建议您首先熟悉这两个选项背后的想法，然后尝试查看一些代码。

# html - chrome 中的 HTML5 视频

> ID：14115567
> 
> 赞同：2
> 
> 时间：2013-01-02T00:22:22.583
> 
> 标签：html, html5-video

我正在创建一个流式传输视频的网站，我希望允许用户自己上传视频。AVI 或 MP4。我已经对此进行了一些研究。如果我想让它跨浏览器兼容，我将不得不使用所有这三种格式：

```
.mp4, .ogv, and .web 
```

幸运的是，我只需要让它在 chrome 中工作。但是，事实证明 chrome 不支持 .mp4。我想最好的选择是转换它们，但我不确定。对此有什么好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T00:31:52.740

这是我用来在我做的网站上播放视频的方法：

[跨浏览器播放器](http://www.mediaelementjs.com/)

我用 php 构建了所有的上传功能，并使用这个播放器允许用户播放视频。

# php - PHP If/Else 参数和 PDO 对象

> ID：14115570
> 
> 赞同：0
> 
> 时间：2013-01-02T00:22:59.457
> 
> 标签：php, if-statement, pdo

if/else 与以下内容如何进行论证。我想将变量 $condition 定义为表 A 和表 B 的交集，最终，在这个条件为真的地方，然后执行一些代码。

这是我拥有的 PHP（我正在尝试匹配 table1.field1 和 table2.field1 并且如果为真，那么我将在其中添加一个 CSS 类`<tr>`）

```
$result = $dbh->query("SELECT field1, field2, field3, field4 FROM table1 ORDER BY field1 DESC");
$result->setFetchMode(PDO::FETCH_ASSOC);

$match = $dbh->query("SELECT table1.field1 FROM table1 INNER JOIN table2 WHERE table2.field1 = table1.field1");

$condition = **???????** 
```

另外，有没有办法简化这段代码？我觉得它太长了。马克吐温有句名言……“对不起，这封信太长了，我没有时间把它缩短”。我希望我可以说这是相关的，但我已经有一段时间了！任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:29:25.820

怎么样的东西（在你的第一个和唯一的查询中）

```
$result = $dbh->query("
    SELECT
        t1.field1,
        t1.field2,
        t1.field3,
        t1.field4,
        IF(t2.field1 IS NULL, 0, 1) `match`
    FROM
    table1 t1
        LEFT JOIN table2 t2 ON t2.field1 = t1.field1
"); 
```

（你应该```在 周围加上反引号（）`match`，因为它是一个 MySQL 关键字）
并在你的循环中

```
<tr class="<?=$v["match"] ? "match" : ""?>"> 
```

# c - 为什么我的数组中有我没有分配的值？

> ID：14115578
> 
> 赞同：0
> 
> 时间：2013-01-02T00:24:05.423
> 
> 标签：c, arrays

```
#include <stdio.h>

int main(void)
{

    int values[10];
    int index;

    values[0] = 197;
    values[2] = -100;
    values[5] = 350;
    values[3] = values[0]+values[5];
    values[9] = 
    values[5] / 10;
    --values[2];

    for (index = 0; index < 10; index++)
        printf ("values[%i] = %i\n", index, values[index]);

    return 0;
} 
```

为什么我在 1、4 和 6-8 的未分配元素中有值？我没有分配任何值。当它为空时，如何使其自动分配 0？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T00:24:53.380

你没有分配它们，所以你只是得到那些已经在内存中的垃圾。

要进行零初始化，您可以这样做：

```
int values[10] = {0}; 
```

或者，使用[`memset`](http://en.cppreference.com/w/c/string/byte/memset).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-02T00:25:24.317

在 C 中，自动变量永远不会归零。你想要的是`memset()`你的阵列`0`来避免这种情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-02T01:36:31.987

虽然 Oli Charlesworth 的帖子展示了解决方案，但让我再多介绍一点“为什么”。对于分配在应用程序堆栈上的“自动”变量，这种未定义的值非常明显。

虽然操作系统在将程序加载到其中之前倾向于将内存归零，但 main() 并不是 C 程序实际启动的地方。实际的起始位置隐藏在一些依赖于实现的地方，使您在 main() 中的代码只是程序启动期间一系列函数调用中的最后一次调用。所有这些早期的内部调用都在堆栈中乱涂乱画，把它们的烂摊子抛在脑后。

由于每个函数调用都继承了先前调用的混乱，因此真的不知道在新调用的堆栈上会看到什么。如果堆栈增长到足够大，您最终会在未使用的内存中找到操作系统的零，这可能有助于在较大的程序中进行调试，但代码绝不能依赖这些零。

堆栈和堆（例如 malloc()）内存都受未知值的影响。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-02T00:37:00.047

从 C99 开始，您还可以只初始化您需要的子对象，其余的将被初始化为具有静态存储持续时间的数据（`0`for `int`）：

```
int values[10] =
{
    [0] = 197,
    [2] = -100,
    [5] = 350,
    [3] = values[0] + values[5],
    [9] = values[5] / 10
}; 
```

以这种方式不可能/不清楚更复杂的初始化。像：

```
--values[2]; 
```

无法在初始化中完成，因为如果同一元素有多个初始化器，则只会使用最后一个初始化器，甚至无法评估第一个初始化器，从而导致未初始化值的递减。来自 C11 标准：

> 初始化应按初始化程序列表顺序进行，为特定子对象提供的每个初始化程序都将覆盖同一子对象的任何先前列出的初始化程序； ^(151))
> 
> 151) 任何被覆盖的子对象的初始化器，因此不用于初始化该子对象可能根本不会被评估。

（我认为它应该不仅仅是一个脚注......）

但是，我认为这只是一个示例，因为这样做没有意义，您可以`350 - 1`在这种情况下将其初始化为。

# reporting-services - 如何在查询中使用 SSRS 中“参数的可用值”的标签（即使用新数据集）

> ID：14115581
> 
> 赞同：1
> 
> 时间：2013-01-02T00:24:20.010
> 
> 标签：reporting-services

如果这是一个令人困惑的问题，我深表歉意。我会附上图片来说明我的意思。我有一个名为 ResponseRange 的参数，我在其中指定该参数的可用值 - 如下所示：

![在此处输入图像描述](../Images/1175823b573eaacfbe3fc153cea231f4.png)

但是在另一个名为 ClientResponseRange 的参数中，我想引用之前选择的参数值的*标签*。我尝试了各种选项，但我最终遇到了错误......

所以我想要做的是在查询中引用标签，如下所示（抱歉代码杂乱无章）

![在此处输入图像描述](../Images/d787e1aa17f55dc7d96f8bb397579e30.png)

编辑：我想我找到了方法！我将使最后一个参数具有以下内容：

=参数！响应范围。标签

*然后*我可以在数据集查询中使用该值 - 即只需说 @ClientResponseRange 。好的保持手指X'ed

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T11:12:50.873

你是对的。

`@ClientResponseRange`将SQL 中的参数设置为`Parameters!ResponseRange.Label`使用公式是最好的方法。

# php - 在 Windows 7 中记录到 php error_log

> ID：14115591
> 
> 赞同：2
> 
> 时间：2013-01-02T00:26:05.453
> 
> 标签：php, log4php

我希望我的 log4php 记录器在 Windows 下记录到 error_log() 记录到的同一个日志文件。我已经使用下面的配置在以前（更旧）版本的 log4php 上工作。

但是，由于权限错误，现在我无法读取文件，并且 apache 挂起 Chmoding cygwin 下的文件没有帮助。

任何想法为什么会这样？

```
; Rolling file appender
log4php.appender.rollingFile=LoggerAppenderRollingFile
log4php.appender.rollingFile.File=log/php-error.log
log4php.appender.rollingFile.MaxFileSize=30000KB
log4php.appender.rollingFile.Append=true
log4php.appender.rollingFile.MaxBackupIndex=10
log4php.appender.rollingFile.layout=LoggerLayoutPattern
log4php.appender.rollingFile.layout.ConversionPattern=[%d{d-M-Y H:i:s}] [%p] %c:%L [%F:%L] %n  %m %n 
```

# objective-c - addSubview 没有出现在 NSView Objective C Cocoa 中

> ID：14115595
> 
> 赞同：4
> 
> 时间：2013-01-02T00:27:58.140
> 
> 标签：objective-c, cocoa

当我`addSubview:`什么都没有出现时。我设置了文本和颜色来查看它。此外，如果我手动将视图添加到 xcode 中 UI bulder 中的自定义视图，它的文本和颜色显示得很好。

.m 文件

```
- (void)displayString:(NSString *)title {
    NSRect frame = NSMakeRect(10, 10, 200, 17);
    NSTextfield *newfield = [[NSTextField alloc] initWithFrame:frame];
    [newfield setBezeled:NO];
    [newfield setDrawsBackground:NO];
    [newfield setEditable:NO];
    [newfield setSelectable:NO];
    [newfield setStringValue:title];
    [newfield setTextColor:[NSColor blueColor]];
    [test addSubview:newfield];

    if([test.subviews containsObject:newfield]){
        NSLog(@"view there"); // i get this message 
    }
    if([newfield isHidden]){
        NSLog(@"view hidden"); //i dont get this message
    }
    NSLog(@"view set");

} 
```

`test`是`NSView`我已正确链接的（自定义视图是 xcode 所称的）。

因此，当我创建文本字段并将其添加到`NSView`手动，然后通过添加文本和颜色运行相同的代码时，一切正常，当我尝试以编程方式设置视图时，就会出现这个问题。此外，我确保这不是我创建的视图，因为我尝试在构建器中创建视图而不是将其放入`NSView`然后尝试`addSubview:`，但这也不起作用。如果您需要更多代码，请告诉我。

开发：如果nsview（自定义视图）中已经有一个元素（手动添加并且可以是任何东西）并且我添加了它可以工作的文本字段（我在nsview中获得了两个视图）？子视图已经过测试，只是看不到它。 ![在此处输入图像描述](../Images/b0fb4a405d5e1f4af1f159311e6d0147.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:34:49.290

你必须打电话`initWithFrame:`而不是仅仅打电话`init`

```
- (void)displayString:(NSString *)title {
    NSRect frame = NSMakeRect(10, 10, 200, 200);
    NSTextField *newfield = [[NSTextField alloc] initWithFrame:frame];
    [newfield setStringValue:title];
    [newfield setTextColor:[NSColor blueColor]];
    [test addSubview:newfield];
    NSLog(@"view set");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:19:09.290

什么类型的视图是测试？你还需要做一个：

```
 newfield.frame = CGRectMake(x,y,width,height) 
```

为了指定视图的外观

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T17:47:27.160

原来我设置的视图太早了。我的印象是，在视图设置后对视图所做的任何事情都会反映在视图上，但这似乎是问题所在。在将视图更改为我想要的方式后，然后设置`NSStatuditem`. 所以我得到

```
 [newfield setStringValue:title];
  [newfield setTextColor:[NSColor blueColor]];
  [test addSubview:newfield];
  [statusItem setView:test];//this is the key, setting it after he changes. 
```

# java - 使用 Java 泛型可能会挂起编译器

> ID：14115597
> 
> 赞同：2
> 
> 时间：2013-01-02T00:28:24.150
> 
> 标签：java, generics, compilation, freeze

我有大约 55 个 Java 接口和 5 个抽象类。每个声明都使用相同的泛型参数集：它列出了大约 60 个声明，因此每个实现都知道彼此实现的特定类型，并在方法参数中替换此类型并根据需要返回。似乎这种（可能过度）使用泛型导致编译器挂起。编译器抛出 OutOfMemoryError，但似乎没有终止。

考虑到我的情况，包含这些声明中的一个的代码清单有点困难，但清单的一部分可能是可能的。接口声明通常指定大约五个方法的集合，但是在声明中使用泛型会将源模块的大小增加到大约一千行。

我的情况可能是编译器实际上进入无限循环的情况，还是应该给它更多内存？抛出 OutOfMemoryError 异常大约需要 20 分钟，所以我担心如果我只是将分配给编译器的内存增加一个因子，编译器会花费更长的时间来抛出异常。

我正在使用 NetBeans 作为我的编辑器环境，但在我启动 NetBeans 后，我一直在求助于运行 clean/build 脚本。我这样做是因为 NetBeans 在启动后开始检查我的代码语法时很快变得无响应。我正在使用 Ubuntu 10.4（我想 - 我是从 Windows 写的）。我求助于在 Ubuntu 环境中打开命令行，将 NetBeans 作为后台进程运行，检查输出并使用 gedit 更正任何源代码错误，杀死并重新启动 NetBeans。这似乎就足够了，直到我发现不再产生语法错误。我不知道如何从命令行运行 clean/build 脚本。

对不起，如果这个问题看起来含糊不清，但如果其他人可以帮助我，那么也许我可以更具体一点。

感谢您提供任何深思熟虑的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T01:01:46.450

在我看来，您对泛型的使用过于复杂，这导致 Java 编译器使用过多的内存来尝试表示泛型类型的扩展。失败之前的很长一段时间可能是由于“垃圾收集死亡螺旋”......其中GC花费越来越多的时间，每次回收的内存越来越少，直到它最终不得不放弃。

如果您无法向我们展示代码，唯一可能的建议是使用更大的堆运行编译器，看看是否能解决问题。

> 我不知道如何从命令行运行 clean/build 脚本。

嗯，我认为你需要弄清楚这一点。它可能会帮助您解决问题，无论如何了解这些事情很重要；例如，这样您就可以使用 CI 系统来构建您的代码并运行您的测试。（并且您可能需要从命令行运行脚本以使构建在单独的 JVM 中运行，该 JVM 具有您可以独立于 IDE 控制其大小的堆。）

* * *

您对泛型的复杂使用也可能包含一些 Java 编译器无法处理的病态（并且可能是荒谬的）。

> 我的泛型声明的一个可能问题来源是它们是自引用的。一个声明引用另一个引用第一个的声明。

是的......这就是我所说的那种事情。如果你不小心，你可能会得到一些无意义的东西（从 Java 的角度来看），它涉及到无限的类型扩展。

# mahout - 如何在 Mahout 中使用 startPhase

> ID：14115598
> 
> 赞同：1
> 
> 时间：2013-01-02T00:28:49.340
> 
> 标签：mahout, mahout-recommender

我正在从 Mahout 0.7 运行一些基于 RecommenderJob (org.apache.mahout.cf.taste.hadoop.item.RecommenderJob) 的作业，并注意到有诸如 startPhase 和 endPhase 之类的选项。我猜这些只是运行管道的一部分，假设您有来自先前运行的必要输入数据。但是我很难理解 RecommenderJob 中有哪些阶段。我正在阅读源代码，但看起来需要一段时间。与此同时，我想知道是否有人可以阐明如何在 RecommenderJob 类中使用这些选项（尤其是 startPhase）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T06:17:42.933

这是我发现的：

阶段 0 是关于 PreparePreferenceMatrixJob 的，它有 3 个 hadoop 作业：

```
PreparePreferenceMatrixJob-ItemIDIndexMapper-Reducer
PreparePreferenceMatrixJob-ToItemPrefsMapper-Reducer
PreparePreferenceMatrixJob-ToItemVectorsMapper-Reducer 
```

第 1 阶段是关于 RowSimilarityJob 的，它有 3 个工作：

```
RowSimilarityJob-VectorNormMapper-Reducer
RowSimilarityJob-CooccurrencesMapper-Reducer
RowSimilarityJob-UnsymmetrifyMapper-Reducer 
```

第 2 阶段是关于 RecommenderJob，它有 3 个工作：

```
RecommenderJob-SimilarityMatrixRowWrapperMapper-Reducer
RecommenderJob-UserVectorSplitterMapper-Reducer
RecommenderJob-Mapper-Reducer 
```

第三阶段是最后一个阶段，它只有一项工作：

```
RecommenderJob-PartialMultiplyMapper-Reducer 
```

RecommenderJob 类中阶段 1 的输出也与 ItemSimilarityJob 阶段 0 和 1 的输出完全相同（但临时目录名称不同）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T00:41:33.370

对，那是正确的。这是一个相当粗糙的机制。实际上，它控制运行一系列 MapReduce 作业中的哪一个。你必须阅读代码才能知道它们是什么，是的。它们因工作而异。

如果我再做一次，我会让它检测到输出的存在以知道跳过这些工作。（这就是我在我的下一代推荐项目中所做的。）

# c++ - 从 at 和 eye 向量计算右、上和视图向量？

> ID：14115603
> 
> 赞同：0
> 
> 时间：2013-01-02T00:29:20.667
> 
> 标签：c++, visual-c++, gdi, win32gui

我正在尝试制作一个 WorldToView 矩阵，为此我需要计算右（r）、上（u）和视图向量（v）。

我知道眼睛向量是`eye(0,0,0)`，向量是`at(0,0,-1)`；然后通过：

`v= normalise(at-eye);`视图向量 v 将是 (0,0,-1)

如何获得 r 和 u 向量？

我知道：

```
r=normalise(v X u);
u=normalise(r X v); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:06:05.407

你目前没有足够的信息——你不知道你的观众朝向哪个方向，它可能是任何东西。您可能希望指定一个向上向量，例如`(0,1,0)`，然后`r`使用等式进行计算。

请注意，就其价值而言`gluLookAt`，与您尝试执行的操作等效的 GLU 函数采用三个参数，而不是两个参数 - 即眼睛向量、at 向量和 up 向量。你错过了向上的向量，因此你遇到了困难。

# c# - 每个频率的响度相等

> ID：14115606
> 
> 赞同：2
> 
> 时间：2013-01-02T00:29:46.397
> 
> 标签：c#, naudio, synthesizer

所以我正在使用 NAudio 在 C# 中从头开始编写合成器。我已经让它播放不同的频率，这很酷，但我注意到较高的音高明显比较低的音高。是不是因为这个效果：

[http://en.wikipedia.org/wiki/Equal-loudness_contour](http://en.wikipedia.org/wiki/Equal-loudness_contour)

或者当我生成正弦波时我做错了什么？如果确实有必要，我将如何实现等响度等高线曲线？

谢谢

我的代码：

NAudio 需要一个填充了 -1 到 +1 范围内的浮点值的缓冲区来表示波形。

**生成正弦波：**

```
buffer[n + offset] = (float)(Amplitude * Math.Sin(angle));
angle = (angle + angleIncrement) % (2 * Math.PI); 
```

**设置频率：**

```
public double Frequency
{
    set
    {
        angleIncrement = 2 * Math.PI * value / sampleRate;
    }
    get
    {
        return angleIncrement * sampleRate / 2 / Math.PI;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T12:46:35.600

根据等响度轮廓控制来自合成器的音频幅度可能*不是*您想要的。

理论上，您需要知道扬声器产生的绝对电平 (SPL) 才能选择合适的轮廓。在实践中，更大的问题是当您扩展合成器以使用复杂波形而不是纯音时，可能由滤波器等处理。等响度轮廓基于纯音，并且当您生成复杂信号（即包含许多频率），您将需要一个响度模型来估计合成声音的响度。

# java - LibGDX 中的冲突

> ID：14115607
> 
> 赞同：1
> 
> 时间：2013-01-02T00:30:02.897
> 
> 标签：java, iterator, libgdx

我正在努力让这款游戏正常运行。它不是。

```
Iterator<Circle> iter = asteroids.iterator();
    while (iter.hasNext()) {
        Circle asteroid = iter.next();
        asteroid.y -= speed * Gdx.graphics.getDeltaTime();
        if (asteroid.y + asteroid.radius * 2 < 0)
            iter.remove();
        if (Intersector.overlapCircles(shipCir, asteroid) && alive) {
            iter.remove();
            alive = false;

        }
    }

    Iterator<Rectangle> iterB = bullets.iterator();
    while (iterB.hasNext()) {
        Rectangle bullet = iterB.next();
        bullet.y += 300 * Gdx.graphics.getDeltaTime();
        if (bullet.y > Gdx.graphics.getHeight())
            iterB.remove();

    }

    /*if (Intersector.overlapCircleRectangle(asteroid, bullet)) {
        // REMOVE OBJECT
    }                                                             
       */ 
```

不工作的部分是上面注释掉的部分。如果你能告诉我如何解决这个问题，那就太棒了。它不会让我访问小行星或子弹，除非我在 while 循环中并且我不知道为什么。

更新：这是我认为你告诉我尝试的。它仍在做同样的事情。

```
Iterator<Circle> iter = asteroids.iterator();
Iterator<Rectangle> iterB = bullets.iterator();

    while (iter.hasNext()) {
        Circle asteroid = iter.next();
        asteroid.y -= speed * Gdx.graphics.getDeltaTime();
        if (asteroid.y + asteroid.radius * 2 < 0)
            iter.remove();
        if (Intersector.overlapCircles(shipCir, asteroid) && alive) {
            iter.remove();
            alive = false;
            if (exploding) {
                exploding = false;
                explode.start();
            }
        }       
        while (iterB.hasNext()) {
            Rectangle bullet = iterB.next();
            bullet.y += 300 * Gdx.graphics.getDeltaTime();
            if (bullet.y > Gdx.graphics.getHeight())
                iterB.remove();
        }
    } 
```

更新：我偶尔会在“iterB.remove();”上遇到错误 我不知道为什么。

代码：

```
Iterator<Circle> iter = asteroids.iterator();
    while (iter.hasNext()) {
        Circle asteroid = iter.next();
        asteroid.y -= speed * Gdx.graphics.getDeltaTime();
        if (asteroid.y + asteroid.radius * 2 < 0)
            iter.remove();
        if (Intersector.overlapCircles(shipCir, asteroid) && alive) {
            iter.remove();
            alive = false;
            if (!exploding) {
                exploding = true;
                explode.start();
            }
        }
        Iterator<Rectangle> iterB = bullets.iterator();
        while (iterB.hasNext()) {
            Rectangle bullet = iterB.next();
            bullet.y += 150 * Gdx.graphics.getDeltaTime();

            if (Intersector.overlapCircleRectangle(asteroid, bullet)) {
                iterB.remove();
                iter.remove();

            }
            if (bullet.y > Gdx.graphics.getHeight())
                iterB.remove(); // ERROR HERE
        }
    } 
```

这是错误：

```
 Exception in thread "LWJGL Application" com.badlogic.gdx.utils.GdxRuntimeException: java.lang.ArrayIndexOutOfBoundsException: -1
at  com.badlogic.gdx.backends.lwjgl.LwjglApplication$1.run(LwjglApplication.java:111)
Caused by: java.lang.ArrayIndexOutOfBoundsException: -1
at com.badlogic.gdx.utils.Array.removeIndex(Array.java:216)
at com.badlogic.gdx.utils.Array$ArrayIterator.remove(Array.java:433)
at com.chanceleachman.space.Screens.GameScreen.render(GameScreen.java:140)
at com.badlogic.gdx.Game.render(Game.java:46)
at com.chanceleachman.space.Space.render(Space.java:37)
at     com.badlogic.gdx.backends.lwjgl.LwjglApplication.mainLoop(LwjglApplication.java:190)
at com.badlogic.gdx.backends.lwjgl.LwjglApplication$1.run(LwjglApplication.java:108) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T05:06:17.813

`asteroid`和变量的`bullet`范围仅限于它们各自定义的while循环，因此不能在这些范围之外使用。您应该查看 Java[变量范围](http://www.itcsolutions.eu/2011/02/10/tutorial-java-scjp-10-variable-scope/)。

您可以通过提升`bullet`和`asteroid`退出 while 循环（即，`Circle asteroid; Rectangle bullet;`）的声明来修复编译器错误，但我认为生成的代码不会按照您的意图进行（并且它会在没有子弹或没有小行星的地方崩溃） .

你需要考虑没有子弹（或没有小行星）的情况，你需要考虑有多个子弹和多个小行星的情况。您需要检查每颗子弹与每颗小行星是否相交。

# django - django-allauth 中的 User 和 user.socialaccount 之间的冲突

> ID：14115610
> 
> 赞同：1
> 
> 时间：2013-01-02T00:30:15.027
> 
> 标签：django, django-authentication

我已经按照[此处](http://techstricks.com/django-allauth-tutorial-step-by-step/)的说明完成了本教程：

[在](http://techstricks.com/django-allauth-tutorial-access-extra-data/)这里

但有些地方我无法理解。

当我使用 Facebook 帐户登录时，我也可以轻松访问我的管理页面并且我希望它发生（因为它不安全），那么有没有办法解决这个问题？

如果我想将该注册用户带到另一个模板，我只能在我的 url 调度程序中使用 direct_to_template 方法，这是一个示例： `url(r'^tags$', direct_to_template, {'template' : 'user.html' })`，

还有另一种方法吗？

最后为了更清楚，这里是我的项目的一些片段：

**网址.py**

```
urlpatterns = patterns('',
#All Auth URLS
url(r'^accounts/', include('allauth.urls')),
url(r'^accounts/profile/', direct_to_template, { 'template' : 'profile.html' }),
#nav urls
url(r'^$','fb.views.home', name="home"),
url(r'^tags$', direct_to_template, {'template' : 'tags.html' }), 
```

**视图.py**

```
def home(request):
return render_to_response("base.html", locals(), RequestContext(Context)) 
```

**base.html**

......

```
{% block body %}
{% block content %}

{% if user.is_authenticated %}
    {{ user.username }}  <p> you are logged in </p>
    <p><a href="/accounts/logout/" >Logout </a></p>
  {% else %}    
    <p> you are not authenticated :  </p>
    <a href="/accounts/facebook/login/" >Login with Facebook </a>
  {% endif %}
{% endblock content %}
{% endblock body %} 
```

...

**profile.html**

```
...
{% block content %}

{% if user %}

<h1>Welcome, {{user.first_name}}</h1>
<p>Following is the Extra information that facebook has provided to allauth:</p>
{% for account in user.socialaccount_set.all %}
    <p>First Name: {{ account.extra_data.first_name }}</p>
    <p>Last Name: {{ account.extra_data.last_name }}</p>
    <p>Profile Link: <a href="{{ account.extra_data.link }}">{{ account.extra_data.link   }}</a></p>
{% endfor %}
{% endif %}

<a href="/tags">  Go to tags</a>

{% endblock content %}
{% endblock body %} 
```

**标签.html**

```
{{user.socialaccount_set.all.0.get_avatar_url}} <br/>
{{user.socialaccount_set.all.0.uid}} <br/>
{{user.socialaccount_set.all.0.get_provider_account }} <br/> 
```

最后提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:12:15.740

秘诀是：

登录后，用户隐藏在请求对象中，所以视图应该是这样的：

```
def home(request):
    user = request.user
    return render_to_response("base.html", locals(), RequestContext(Context)) 
```

现在，问题解决了，但我想知道为什么 Context User 对象是匿名的。

我问这个问题是因为最后一个用户对象在简单的身份验证中将具有与请求用户相同的值

# c# - http帖子在wp7上不起作用，名称字段未发送过来

> ID：14115611
> 
> 赞同：0
> 
> 时间：2013-01-02T00:30:15.380
> 
> 标签：c#, php, windows-phone-7

好的，所以我到处看看这里和其他地方的大量帖子。我所拥有的是这样的 php 脚本。

```
<?php

//gets the post from the phone app
$calendar = $_POST[ 'calendar' ];

//converts the post into a string for manipulation
$xml = simplexml_load_string($calendar); 

rest of code omitted 
```

然后在 C# 中我有这个

```
string Event_xml;
Event_xml = "<?xml version='1.0' encoding='ISO-8859-1' ?><calendar><event><event_id></event_id><title>"+ local_title +"</title><venue_id>1</venue_id><contact_id>1</contact_id><description>"+ local_description +"</description><category_id>1</category_id><user_id>" + local_ID + "</user_id><group_id>1</group_id><status_id>1</status_id><date>" + local_startDate + "</date><starttime>" + local_startTime + "</starttime><endDate>" + local_endDate + "</endDate><endtime>" + local_endTime + "</endtime></event></calendar>";

WebClient wc = new WebClient();
var URI = new Uri("http://jasonsftp.no-ip.info/test/EventInput.php");
        wc.Headers["Content-Type"] = "application/x-www-form-urlencoded";
        wc.UploadStringCompleted += new UploadStringCompletedEventHandler(wc_UploadStringCompleted);

        wc.UploadStringAsync(URI, "POST", Event_xml); 
```

当我收到回复时，这是错误的

注意：未定义的索引：第 11 行 htdocs\test\testinput.php 中的日历 数组注意：尝试在第 30 行的 htdocs\test\testinput.php 中获取非对象的属性

警告：在第 30 行的 htdocs\test\testinput.php 中为 foreach() 提供的参数无效

现在，如果我使用这样的标准 html 帖子：

```
<form action="http://jasonsftp.no-ip.info/test/testinput.php?" method="post">
      <input type="text" name="calendar" value="mydata" />
      <input type="submit" />
    </form> 
```

它工作得很好。所以 name="calendar" 是 C# 中的内容，我无法使用我当前的代码进行复习。

任何帮助，将不胜感激。我希望这不是很复杂。我想我只是错过了一些东西，但是在阅读课程描述时我没有找到任何东西。

谢谢杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T11:34:00.950

所以我发现这里的工作是我在 c# 中必须做的

```
WebClient wc = new WebClient();

        string sendData = "";
        var URI = new Uri("http://jasonsftp.no-ip.info/test/testinput.php");
        wc.Headers["Content-Type"] = "application/x-www-form-urlencoded";

        sendData += "&title="+local_title;
        sendData += "&event_id=";
        sendData += "&venue_id=1";
        sendData += "&contact_id=1";
        sendData += "&description=" + local_description;
        sendData += "&category_id=1";
        sendData += "&user_id=" + local_ID;
        sendData += "&group_id=1";
        sendData += "&status_id=1";
        sendData += "&date=" + local_startDate;
        sendData += "&start_time=" + local_startTime;
        sendData += "&end_date=" + local_endDate;
        sendData += "&end_time=" + local_endTime;

        wc.Headers[HttpRequestHeader.ContentLength] = sendData.Length.ToString();
        wc.UploadStringCompleted += new UploadStringCompletedEventHandler(wc_UploadStringCompleted);

        wc.UploadStringAsync(URI, "POST", sendData); 
```

对于 php，这是我为使其工作所做的

```
<?php

$title = $_POST['title'];
$event_id = $_POST['event_id'];
$venue_id = $_POST['venue_id'];
$contact_id = $_POST['contact_id'];
$description = $_POST['description'];
$category_id = $_POST['category_id'];
$user_id = $_POST['user_id'];
$group_id = $_POST['group_id'];
$status_id = $_POST['status_id'];
$date = $_POST['date'];
$start_time = $_POST['start_time'];
$end_date = $_POST['end_date'];
$end_time = $_POST['end_time'];
$latitude = "";
$longitude = ""; 
```

这样我就可以从手机中获取值并根据需要将它们添加到数据库中。

# javascript - 倒计时脚本未开始倒计时

> ID：14115612
> 
> 赞同：2
> 
> 时间：2013-01-02T00:30:19.140
> 
> 标签：javascript, jquery-plugins, countdown

有人可以告诉我为什么倒计时功能无法正常工作（倒计时不是在 ID 为“倒计时”的 div 中开始）。可能真的很简单，但 Javascript 不是我的强项。这是我正在使用的倒计时插件：http: [//keith-wood.name/countdown.html](http://keith-wood.name/countdown.html)

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Page Title</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="./css/web-style-second.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="chrome://mozbar/skin/css/injected.css">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.countdown.js"></script>
</head>
<body>
<a name="top"></a>
<div id="container">
    <div id="content">  

<div class="center">
    <center>
        <div></div>
    </center>
</div>

<script type="text/javascript"> 
$(function() {
    $('#countdown').countdown({
        until: '14min+20sec',
        format: 'MS',
        layout: '{mnn}min  ' + '{snn}sec  ',
        onExpiry: function() {
            $(".hidden").css("display", "block");
        }
    });
});
</script>

<div class="time_box"> 
    <h3 class="italic">When The Clock Hits Zero ... </h3> 
    <h4 class="hasCountdown" id="countdown">14min  20sec  </h4>  
</div>

<form name="signupFrm" id="signupFrm" action="#" method="post" class="hidden">
    <div>
        <div class="yellow_red">
            <h1></h1>
        </div>
        <div class="center">
            <a href="https://www.testing.com" class="btn_buy_now">
            Get Started</a>
        </div>
        <input name="submit" value="submit" type="hidden">
        <p class="mb_5">&nbsp;</p>
    </div>
</form>
<div class="fnote justify">
</div>

    </div>
    <div id="footer">
    </div>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:25:46.303

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:41:01.607

倒计时插件使用该类`hasCountdown`来测试倒计时是否已经被实例化，因此您应该使用不同的类名。

来自 jquery.countdown.js：

```
/* Class name added to elements to indicate already configured with countdown.*/
markerClassName: 'hasCountdown' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:33:42.873

您应该将`$(function () ...)`脚本放入`<head>`HTML 页面的标记中。这样，一旦 DOM 完全加载，就会开始倒计时。

# mysql - 我的 MySQL 数据库搜索代码有什么问题？

> ID：14115615
> 
> 赞同：-3
> 
> 时间：2013-01-02T00:31:01.480
> 
> 标签：mysql, database, search

数据库连接都是正确的，但我收到一条错误消息

```
Warning: 
mysql_fetch_array(): supplied argument is not a valid MySQL result on line 31 
```

* * *

```
<?php 
  $hostname = "localhost";  
  $username = "user";  
  $password = "pass";   
  $usertable = "products";  
  $dbName = "test_prods";  

 $s = $_GET["s"];  
 $name = $row["product_name"];  

     MYSQL_CONNECT($hostname, $username, $password) OR DIE("Unable to connect to database");   
     @mysql_select_db( "$dbName") or die( "Unable to select database");   

 //error message (not found message)   
   $XX = "No Products Found";   

 $query = mysql_query("SELECT * FROM $usertable WHERE $s LIKE '$name'");   
  while ($row = mysql_fetch_array($query))   
    {  
      $variable1=$row["row_name1"];  
      $variable2=$row["row_name2"];  
      $variable3=$row["row_name3"];  
print ("this is for $variable1, and this print the $variable2 end so on...");  
}  

 //below this is the function for no record!!   
if (!$variable1)  
   {  
       print ("$XX");  
   }  
//end  
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T00:38:22.013

改变：

```
$s = $_GET["s"];  
$name = $row["product_name"]; 
```

至：

```
$s = mysql_real_escape_string($_GET["s"]);
$name = mysql_real_escape_string($row["product_name"]); 
```

**请注意此警告：** *此扩展自 PHP 5.5.0 起已弃用，并将在未来删除。相反，应该使用 MySQLi 或 PDO_MySQL 扩展。*

资料： http: [//php.net/manual/en/function.mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php)

* * *

并将您的查询更改为：

```
$query = mysql_query("SELECT * FROM $usertable WHERE $s LIKE '$name'") 
      or die(mysql_error()); 
```

会告诉您 SQL 中是否存在可以缩小问题范围的错误！如果你能告诉我你得到什么结果，我可以更新更适合这个问题的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T00:36:30.907

您似乎正在使用未定义的变量：

```
$name = $row["product_name"]; 
```

我猜您正在尝试从另一个查询中获取名称，然后使用它来获取您的匹配项（如果有）。

在打电话之前设置名称`mysql_query`很可能会为您完成这项工作。

另外，从外观上看，您只是从 mysql 开始，所以我建议您放弃学习使用 mysql_ 函数，并开始学习如何使用 PDO 运行查询。

我发现[本教程](http://www.phpro.org/tutorials/Introduction-to-PHP-PDO.html#5)很有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T00:37:22.073

您的 sql 语法可能有错误。

在这条线上

```
$name = $row["product_name"]; 
```

$row["product_name"] 会评估任何东西吗？

从您发布的内容来看，它没有，但也许在其他地方加载了一个值。

如果它没有评估任何东西，那么 sql 语句将有语法错误并且 $query 不能成为 mysql 资源。

# virtualbox - 如何在 VirtualBox 中访问无头 VM 的大型预览？

> ID：14115616
> 
> 赞同：19
> 
> 时间：2013-01-02T00:31:19.673
> 
> 标签：virtualbox, vagrant

我正在尝试调试 vagrant/virtualbox 情况，但这与这里无关。

在无头模式下，它似乎永远不会进入登录屏幕（但在 GUI 模式下很好）。预览图像似乎仍在显示引导日志。

我想查看详细输出的状态（也就是预览图像），而不是实际的日志。

有没有办法访问它？

VirtualBox 版本：4.2.6，Mac OSX Mountain Lion。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-01-20T17:58:52.080

就像@Benoit 提到的那样，日志是一个很好的资源。

但是，右键单击 VirtualBox 中的实例 VM 并单击“显示”应该会显示 VM 的图像，即使它在无头模式下运行也是如此。您将能够关闭窗口并让 VM 继续运行。

[![在此处输入图像描述](../Images/35d954130544ce1731dd199d769b14f3.png)](https://i.stack.imgur.com/5jV6y.png)

至于修改源代码以放大您的图像（或者可能创建一种生成您自己的图像的方法），我将首先查看[https://www.virtualbox.org/browser/vbox/trunk#src/VBox/Frontends/ VBoxFB](https://www.virtualbox.org/browser/vbox/trunk#src/VBox/Frontends/VBoxFB)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-10-23T14:24:19.313

在搜索相同的解决方案时发现了这个问题。

按照@robert 的建议，使用“显示”来查看 GUI。

[![在此处输入图像描述](../Images/99f006eaf816185f18ac6112703ceb20.png)](https://i.stack.imgur.com/945SK.png)

回答没有提供退出 GUI 的方法，所以这里是附加步骤。（使用 OSX VirtualBox 5.1.6）

要在机器运行时退出，请使用机器菜单中的“分离 GUI”。

[![在此处输入图像描述](../Images/00bfa81918c0a33dd9ffa9117a6ef403.png)](https://i.stack.imgur.com/I3uyh.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-11T10:33:12.940

我在谷歌搜索时遇到了这个问题，以便在运行无头机器时查看更大版本的小预览图片。我发现的一种解决方法是保存机器状态，然后这次以附加模式再次启动它。（即不是无头的）

`VBoxManage controlvm "..." savestate VBoxManage startvm "..."`

完成后，保存状态并以无头模式启动它。

`VBoxManage controlvm "..." savestate VBoxManage startvm "..." --type headless`

我将把它留在这里，希望对其他人有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-17T22:44:09.270

在 VirtualBox 窗口中，右键单击实例 VM，选择“在 Finder 中显示”。然后在 Finder 窗口中，双击“Logs/VBox.log”。

控制台应打开日志文件。

# jquery-select2 - select2 高度不对？

> ID：14115617
> 
> 赞同：1
> 
> 时间：2013-01-02T00:31:44.817
> 
> 标签：jquery-select2

我有一个如下所示的 select2 列表框：

![选择2](../Images/174691feb0145acb2aa2b3368681b244.png)

第一个值是空的，它工作正常，但盒子似乎不够高。

我进行以下调用来创建它：

```
$elem.select2({minimumResultsForSearch: 10, placeholder: undefined, width: 'resolve'}); 
```

这是调用 select2 之前的 HTML：

```
<select class="select required" id="user_transaction_company_user_id" name="user_transaction[company_user_id]"><option value=""></option>
<option value="17">enza rinaldi</option>
<option value="14">stijn verrept</option></select> 
```

我首先看到有一个空值，这没问题，但它应该正确显示它，而不是高度的一半。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T04:44:10.023

您应该定义一个占位符选项，它将删除空选项并在未选择任何值时显示占位符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:12:28.703

如果您不想设置默认值（默认情况下选择框的第一个选项），则需要在选项中设置一个空值。如果您在初始化 select2 时设置了占位符，则 select2 将自动将此空选项替换为占位符文本（此占位符可以为空白）。一旦用户选择了一个选项，就无法再选择空选项（除非您指定 allowClear: true）。

在代码中（假设一个空选项设置如下）：

```
<option value=""></option> 
```

选择一个选项后，用户不能再选择空选项：

```
$elem.select2({ placeholder: "" }); 
```

选择一个选项后，用户可以取消选择/选择空选项：

```
$elem.select2({ placeholder: "", allowClear: true }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-09T14:28:47.270

如果您真的想要一个可以在选择另一个选项后选择的空选项，您可以使用

使其全高。

# c - fork.c:764：在非结构或联合的情况下请求成员“列表”

> ID：14115618
> 
> 赞同：1
> 
> 时间：2013-01-02T00:31:46.950
> 
> 标签：c, data-structures, linux-kernel, kernel

嗨，我正在做一个关于编译内核的项目。但是，我面临一个错误，上面写着

```
fork.c: In function `do_fork':
fork.c:764: request for member `list' in something not a structure or union 
```

简要说明：我使用的是在内核中为每种类型的结构定义的现成链表。（所以我有自己的数据结构）此外，我为我的链表使用了预定义的函数，如添加、遍历、删除节点但由于这个错误，我没有任何进展。在这里你可以看到包含我的数据结构的头文件。

```
/* project_header.h> */
#ifndef __LINUX_PROJECT_HEADER_H

#define __LINUX_PROJECT_HEADER_H

#include <linux/linkage.h>
#include <linux/vmalloc.h>
#include <linux/list.h>

#endif

typedef struct node{

        struct list_head list; /* kernel's list structure */
        long int sample_pid;

}NODE; 
```

此头文件位于位置`include/linux`目录中。

这是我将在新内核中使用的系统调用。我`projectList`在全球范围内定义了在其他文件中使用它。

```
#include <linux/sample.h>
#include <linux/project_header.h>

NODE projectList;

asmlinkage void sys_sample(void){

        NODE* temp;

                list_for_each_entry(temp, &projectList.list, list){

                        printk(KERN_INFO "TEMP->PID = %ld\n", temp->project_pid);
                }

        return;
} 
```

我尝试`fork.c`在`kernel/`目录中使用它，在这里您可以看到我添加到的示例代码`fork.c`。另一方面，我调用`projectList`with 语句`extern projectList`来引用在`sample.c`

```
 /* do_fork.c */
      /* do_fork() function */
      #include <linux/project_header.h>
      #include <linux/sample.h>

      extern projectList; // Call variable projectList

      .
      .
      .

      do_fork(parameters..){

     struct task_struct* p;
.
.

     line 759-->NODE* newNode;

     line 760-->newNode = kmalloc(sizeof(*newNode), GFP_KERNEL);

     line 761-->newNode->sample_pid = p->pid;

     line 762-->INIT_LIST_HEAD(&newNode->list);

     /* add the new node to mylist */

     line 764--> list_add_tail(&(newNode->list), &(projectList.list));

     .
     .
     .
    } 
```

我希望我对你很清楚，如果你能帮助我，我会很高兴，无论如何谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:59:47.243

```
extern projectList; // Call variable projectList 
```

您忘记在`projectList`此处声明的类型，因此如果编译器处于 C89 模式，它会应用“隐式`int`”规则。因此，你`projectList`是一个`int`in `fork.c`，而不是一个`struct`or`union`有成员。

# asp.net - 哪些 ASP.NET 生命周期事件可以是异步的？

> ID：14115620
> 
> 赞同：28
> 
> 时间：2013-01-02T00:31:50.670
> 
> 标签：asp.net, async-await

我已经编写了一个自定义的 ASP.NET 控件，并且我刚刚将它更新为具有异步 Load 事件处理程序。现在我收到此错误：

> 此时无法启动异步操作。异步操作只能在异步处理程序或模块内或在页面生命周期中的某些事件期间启动。如果在执行页面时发生此异常，请确保将页面标记为 <%@ Page Async="true" %>。

该页面*确实*已经有`<%@ Page Async="true" %>`标签。所以我认为控件不能有异步加载事件处理程序。

我在哪里可以找到 ASP.NET 网络表单生命周期中允许异步的事件的完整列表？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-09T23:39:31.470

来自 ASP.NET 团队的 Damian Edwards 给出了这样的答案：

> 如您所见，Web 表单中的异步 void 事件处理程序仅在某些事件上受支持，但实际上仅适用于简单的任务。我们建议将 PageAsyncTask 用于任何真正复杂的异步工作。

来自 ASP.NET 团队的 Levi Broderick 给出了这样的答案：

> Web 应用程序中的异步事件本质上是奇怪的野兽。Async void 适用于“一劳永逸”的编程模型。这适用于 Windows UI 应用程序，因为应用程序会一直存在直到操作系统将其杀死，因此无论何时运行异步回调，都可以保证有一个可以与之交互的 UI 线程。在 Web 应用程序中，该模型分崩离析，因为根据定义，请求是瞬态的。如果异步回调恰好在请求完成后运行，则无法保证回调需要与之交互的数据结构仍处于良好状态。因此，为什么一劳永逸（和异步无效）在 Web 应用程序中本质上是一个坏主意。
> 
> 也就是说，我们做了一些疯狂的体操来尝试让 Page_Load 这样非常简单的事情起作用，但是支持这一点的代码非常复杂，并且没有针对基本场景之外的任何事情进行良好的测试。因此，如果您需要可靠性，我会坚持使用 RegisterAsyncTask。

所以我认为我的问题的答案是：“这是个错误的问题。”

正确的问题是“我应该如何在我的 ASP.NET Web 窗体应用程序中保持异步？” 答案是将此代码段插入到您的 aspx 代码隐藏文件中：

```
this.RegisterAsyncTask(new PageAsyncTask(async cancellationToken => {
    var result = await SomeOperationAsync(cancellationToken);
    // do something with result.
})); 
```

同样的技巧在 ASP.NET 自定义控件中也有效，只需使用它`this.Page.RegisterAsyncTask`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T04:36:47.420

本页解释了异步页面中的生命周期事件处理与 ASP.NET 2.0 中同步页面的处理方式有何不同（图 2 尤其有用）：

[邪恶的代码：ASP.NET 2.0 中的异步页面](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx)

您可能还会发现这个 SO 使用问题（它谈到了相同的错误消息）：

[async 关键字和 TaskScheduler 的选择](https://stackoverflow.com/q/13031144/2005251)

# javascript - 在页面加载时用 jQuery 替换文本字符串？

> ID：14115624
> 
> 赞同：1
> 
> 时间：2013-01-02T00:32:08.533
> 
> 标签：javascript, jquery

我的 html 中有以下代码

```
<p>6565655655|cell</p> 
```

我想删除这条垂直线并将单词“cell”包裹到圆括号中。所以我想要像下面这样的输出

```
<p>6565655655 (cell)</p> 
```

当通过ajax调用动态加载p标签的内容时，我如何使用jquery来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:36:54.367

使用管道作为分隔符拆分 p-tag 的内容，然后重新插入如此创建的数组，第二个元素带有括号。

这里有一个例子：

```
var splittedString = $("p").text().split("|");
$("p").html(splittedString[0] + " (" + splittedString[1] + ")"); 
```

jsFiddle：http: [//jsfiddle.net/r3c4J/](http://jsfiddle.net/r3c4J/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:41:43.000

几种方法可以做到：

```
var text = '6565655655|cell'; 
```

方法一：

```
var parts = text.split('|');
$('p').text(parts[0] + ' (' + parts[1] + ')'); 
```

方法二：

```
$('p').text(text.replace('|cell', ' (cell)'); 
```

方法三：

```
$('p').text(text.replace(/([0-9]+)\|(.*)/, '$1 ($2)')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:43:07.103

你可以这样做：

```
$('p').each(function () {
    var $txt = $(this).text();

    if ($txt.indexOf('|') > 0) {
        var txtArray = $txt.split('|');
        $(this).html(txtArray[0] + ' (' + txtArray[1] + ')');
    }
}); 
```

示例：http: [//jsfiddle.net/fewds/E637y/1/](http://jsfiddle.net/fewds/E637y/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T00:43:43.377

在您的 ajax 成功方法中：

```
success: function(data)
{
 $(data).find("p").each(function(index,element){
  var pipe = element.innerHTML.indexOf("|");
  if( pipe != -1 ){
   element.innerHTML.replace("|","( ");
   element.innerHTML += ")";
  }
 }
 //continue with placing data on the page.
} 
```

你也可以把它移植到一个函数中，这样你也可以在页面第一次加载时调用它

```
function replacePipe(element)
{
  $(element).find("p").each(function(index,el){
  var pipe = el.innerHTML.indexOf("|");
  if( pipe != -1 ){
   el.innerHTML.replace("|","( ");
   el.innerHTML += ")";
  }
 }
} 
```

这将使 ajax 成功看起来像这样：

```
success: function(data)
{
 replacePipe(data);
 //place data, perhaps $(tar).html(data);
} 
```

你也可以这样做

```
window.onload = function(){ 
 replacePipe(document.body);
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-02T00:54:50.667

如果您将类名添加到段落标签，那么您还可以使用以下...

html部分 -

```
<p class="item">6565655655|cell</p> 
```

jQuery部分

```
$(document).ready(function() {
var aText = ($('.item').html()).split('|');
$('.item').html(aText[0] + "&nbsp;&#40;" + aText[1] + "&#41;");
}); 
```

# apache - Apache mod_rewrite 域名

> ID：14115631
> 
> 赞同：0
> 
> 时间：2013-01-02T00:33:31.510
> 
> 标签：apache, .htaccess, mod-rewrite

我在弄清楚如何将 mod rewrite 用于域名时遇到问题。我认为这与域扩展有关，但不确定。

```
Input: domain.com/google.com
Callback: domain.com/index.php?website=google.com

RewriteRule ^(.*)/$ index.php?website=$1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T00:42:48.023

`(.*)`将匹配*任何内容*，因此您尝试匹配域名并不重要。相反，问题看起来是存在您的输入`/`中*不存在的尾部斜杠。*只需将其删除并使用`^(.*)$`. 还建议添加`[L]`标志。

```
RewriteEngine On
# Avoid rewrite loops on real files like index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?website=$1 [L] 
```

如果您需要选择性地包含尾部斜杠，请在输入字符串末尾添加一个`?`以匹配零或一。`/`

```
RewriteRule ^(.*)/?$ index.php?website=$1 [L] 
```

# extjs - 如何从服务器检索记录索引到我的 Sencha Touch 2 应用程序中，然后检索完整的模型实例

> ID：14115635
> 
> 赞同：0
> 
> 时间：2013-01-02T00:33:52.373
> 
> 标签：extjs, sencha-touch, sencha-touch-2

设置 Sencha Touch 2 存储以检索少量数据以从 jsonp 响应生成多个模型实例可能很简单。但是，我正在开发一个应用程序，该应用程序可以处理服务器上可用的相当大的数据集（法律意见），所以我必须从服务器中检索可用记录的列表——如果你愿意的话，是一个索引——然后当用户点击列表中的项目时检索单个完整记录。

我正在寻找任何推荐的方法。这是我到目前为止设置的，只是部分工作：

1.  我在服务器端定义了 :index 和 :show RESTful 操作来检索法律意见。
2.  在客户端，我有一个模型和一个用于索引条目的存储（包括我的可用数据列表），它们通过来自服务器上 :index RESTful 操作的 jsonp 响应提取数据，以创建可用数据的索引在 List 组件中。这些索引条目中的字段不包含法律意见的全文，而仅包含当事人的姓名和引文。
3.  我有一个模型并存储完整的法律意见。商店通过服务器上的 :show RESTful 操作一次从服务器提取一个法律意见。
4.  当用户点击应用程序中法律意见列表中的一项时，监听器会触发一个事件，控制器会接收该事件。控制器使用列表项对应记录的 ID 来确定服务器上 :show 操作的正确 URL，如下所示：

    ```
     # Controller:
        onDisplayAuthority: function(list, record) {
          console.log('onDisplayAuthority');        
          this.activateAuthorityView(record);

          var authorityView = this.getAuthorityView();
          authorityStore = Ext.getStore('Authority');

          var authorityId = record.getData().id;
          var url = 'http://localhost:3000/api/authorities/' + authorityId + '.json';
          var proxy = {
            type: 'jsonp',
            url: url,
            reader: {
                type: 'json',
                rootProperty: "authority"
            }
          };

          authorityStore.setProxy(proxy);
          authorityStore.load();

          authority = authorityStore.first();
          var data = authority.getData();

          authorityView.setRecord(authority);

          authorityView.getComponent("authorityViewBody").setData(data);
          authorityView.getComponent("titlebar").setTitle(data.title);

          Ext.Viewport.animateActiveItem(authorityView, this.slideLeftTransition);

      } 
    ```

此代码不起作用。出于某种原因，如果我`console.log(authorityStore)`在上面的代码中运行，我可以看到其中`authorityStore.data.all[0]`包含完整的法律意见。但是，当我运行时`console.log(authorityStore.data.all[0])`，它会返回`[]`。此外，`authorityStore.first();`返回`undefined`，虽然 Sencha Touch 2 文档显示这`#first()`是一个有效存储的方法，并且`authorityStore`是一个有效的存储。

所以，要么我错过了一些基本的东西，要么我只是在这方面人迹罕至。

有没有人 (i) 对我的问题有快速解决方案，或者 (ii) 另一种同时使用 :index: 和 :show 操作来减少无关数据传输的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:10:11.760

这有效：

```
onDisplayAuthority: function(list, record) {
    console.log('onDisplayAuthority');
    var authorityView = this.getAuthorityView();
    authorityStore = Ext.getStore('Authority');

    var authorityId = record.getData().id;
    var url = 'http://localhost:3000/api/authorities/' + authorityId + '.json';
    var proxy = {
        type: 'jsonp',
        url: url,
        reader: {
            type: 'json',
            rootProperty: "authority"
        }
    };

    authorityStore.setProxy(proxy);
    authorityStore.load({
        callback: function(records, operation, success) {
            // the operation object contains all of the details of the load operation
            var data = records[0].getData();
            authorityView.setRecord(records[0]);

            authorityView.getComponent("authorityViewBody").setData(data);
            authorityView.getComponent("titlebar").setTitle(data.title);
        },
        scope: this});      

    Ext.Viewport.animateActiveItem(authorityView, this.slideLeftTransition);
} 
```

通过将设置数据的代码行放在`authorityView`商店的#load 方法的回调中，我能够访问新记录。我不知道为什么我必须这样做，并希望得到评论。但是，这种方法*确实*有效。

# oop - 是否有更优雅的方式（或模式）来实现相关类的组

> ID：14115636
> 
> 赞同：3
> 
> 时间：2013-01-02T00:34:00.230
> 
> 标签：oop, class, design-patterns, generics

我正在尝试实现各种相关类组，有点像这样：

*   MySQL数据库
*   MySQLTable（引用一个 MySQLDatabase）
*   MySQLRecord（引用 MySQLTable）
*   PostGre 数据库
*   PostGreTable（引用 PostGreDatabase）
*   PostGreRecord（引用 PostGreTable）
*   甲骨文数据库
*   ...

由于相关类（MySQLTable、PostGreTable 等）有很多共享代码，我已经使用抽象父类和泛型实现了这一点，如下所示：

```
class Database {}

class Table<DatabaseType> where DatabaseType : Database 
{
  public DatabaseType FDatabase; //this is what I mean by "references"
}

class Record<TableType, DatabaseType> where 
  DatabaseType : Database
  TableType : Table<DatabaseType> 
{
  public TableType FTable;
}

class MySQLDatabase : Database {}

class MySQLTable : Table<MySQLDatabase> 
{
  public string FCharset;
}

MySQLRecord : Record<MySQLTable, MySQLDatabase> {}

... 
```

我需要这种架构能够：

*   防止错误的引用。

例如：MySQLTable 不能引用 PostGreDatabase 或 OracleDatabase，只能引用 MySQLDatabase。

*   使程序员无需强制转换即可访问对象的特定属性。

例子：

```
SomeMySQLRecord.FTable.FCharset = 'UTF-8'; 
```

代替

```
((MySQLTable)SomeMySQLRecord.FTable).Charset = 'UTF-8'; 
```

我正在寻找一种更优雅的方式（或模式）来做到这一点，因为真正的类组有 3 个以上的类，而泛型真的让代码变得很糟糕。例子：

```
MyType : Type1<GType1, GType2, GType3, GType4> where
  GType1 : Type2,
  GType2 : Type3<GType1>,
  GType3 : Type4<GType1, GType2>,
  GType4 : Type5<GType2, GType1, Type2, GType3> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T03:58:33.483

我会采取稍微不同的路线，尽管我不完全确定这是否适用于您的特定情况：

```
 public class Provider { }

    public class Oracle : Provider { }

    public class AbstractDatabase<T> where T : Provider
    {
        // Your base code here
    }

    public class AbstractTable<T> where T : Provider
    {
        public AbstractDatabase<T> FDatabase { get; set; }
        // Your base code here
    }

    public class AbstractRecord<T> where T : Provider
    {
        public AbstractTable<T> FTable { get; set; }
    }

    public class OracleDatabase : AbstractDatabase<Oracle> { }

    public class OracleTable : AbstractTable<Oracle>
    {
        public new OracleDatabase FDatabase { get; set; }

        // Your strongly typed code
        public OracleTable(OracleDatabase parent) { }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T07:20:41.843

泛型对我来说在这里没有意义。使用您自己的代码：

```
Table<DatabaseType : Database>
MySQLTable : Table<MySQLDatabase> 
```

有人会假设 MySQLTable 也使用泛型定义，因为您将其定义为 Table 的子项：

```
MySQLTable<Something> : Table<MySQLDatabase> 
```

你会如何在这里定义*Something*？这没有意义。

如果您使用泛型来实现这一点：

*例如：MySQLTable 不能引用 PostGreDatabase 或 OracleDatabase，只能引用 MySQLDatabase。*

我认为这不是使用泛型的充要条件。

# c - 如何在纯 C 和 CUDA C 文件中包含头文件？

> ID：14115639
> 
> 赞同：3
> 
> 时间：2013-01-02T00:34:27.923
> 
> 标签：c, cuda, header-files

我需要从**纯 C**函数（位于*main.c中）中调用***CUDA C**函数`foo()`（位于*gpu.cu*中）。我的尝试如下所示：**`main()`**

 ****   **main.c**（调用者）：

    ```
    #include "gpu.h"
    int main();
    int main() { foo(); } 
    ```

*   **gpu.h** (`foo()`声明): **<--- 这里有问题**

    ```
    extern void foo(); 
    ```

*   **gpu.cu**（`foo()`定义）：

    ```
    #include "gpu.h"
    extern "C" void foo() { ... } 
    ```

*   **我得到错误**：

    ```
    gpu.cu(2): error: linkage specification is incompatible with previous "foo"
    gpu.h(1): here 
    ```

但是，在不使用头文件的情况下，以下**操作确实**有效：

*   **main.c**（调用者）：

    ```
    void foo();
    int main();
    int main() { foo(); } 
    ```

*   **gpu.cu**（`foo()`声明和定义）：

    ```
    extern "C" void foo();
    extern "C" void foo() { ... } 
    ```

当然，我更喜欢在纯 C 和 CUDA c 代码中使用单个头文件，那么在头文件中使用的正确语法是什么（`extern "C"`即使它是 C++ 的东西，我们仍然需要）？我需要 .cuh 扩展名吗？

我**只使用 NVCC**编译和链接（即纯 C 和 CUDA-C 代码）。

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T08:05:15.040

你几乎有这个正确的 - 问题在于你如何使用`gpu.h`. 工具链报告的冲突正在发生，因为其中包含的头文件`gpu.cu`声明`foo()`将具有 C++ 链接，但随后定义具有 C 链接。

基本问题是您试图`gpu.h`同时用作 C 和 C++ 标头。这通常不是一个好主意，但它可以工作。一种方法是确定它是一个 C 头文件并修改 C++ 代码以将其视为一个，所以这样`gpu.cu`做：

```
extern "C" {
#include "gpu.h"
}

extern "C" void foo() { ... }; 
```

另一种是修改`gpu.h`，使其行为根据它是被 C 编译器还是 C++ 编译器包含而有所不同，例如：

```
#ifdef __cplusplus
extern "C" {
#endif
extern void foo();
#ifdef __cplusplus
}
#endif 
```

或者

```
#ifdef __cplusplus
extern "C" void foo();
#else
void foo();
#endif 
```

将使预处理器发出不同的代码，具体取决于代码是在 C 还是 C++ 环境中编译的。但是，如果您尝试使用 C++ 编译器编译任何名义上的 C 代码，这可能会失败。

您选择如何解决此问题可能在很大程度上取决于代码的真实结构，我猜这并不像您描述的那么简单。***

# google-app-engine - 具有线程安全的 RequestHandler 变量

> ID：14115643
> 
> 赞同：1
> 
> 时间：2013-01-02T00:35:08.627
> 
> 标签：google-app-engine

如果我有一个`RequestHandler`类，它有一个`self.var`在请求期间初始化的变量（如下）。可以在并发环境中覆盖该变量（`threadsafe=true`）吗？例如

```
class MyRequestHandler(webapp2.RequestHandler):
    var = None
    def get(self, id):
        self.var = value_from_datastore(id)
        # Do something that takes time
        # ...
        self.response.write.out(self.var)
        self.response.write.out(self.var2) 
```

可以`self.var`被第二个请求（可能来自不同的用户）覆盖，在它设置在`get`方法的顶部和在输出中使用它时？

谢谢，

贝尔德

更新：

我的（错误的）印象是，将`var = None`其声明为实例变量。感谢您纠正我的（张开的）误解；-)

如果我在 中做“声明” `__init__`，我会更好吗？我认为这归结为是否为每个线程创建了 MyRequestHandler，或者是否为所有共享线程创建了一个。是否还会有来自不同用户的不同请求的干扰？

```
class MyRequestHandler(webapp2.RequestHandler):
    def __init__(self):
        self.var = None
    def get(self, id):
        self.var = value_from_datastore(id)
        # Do something that takes time
        # ...
        self.response.write.out(self.var)
        self.response.write.out(self.var2) 
```

谢谢，

贝尔德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T02:07:41.300

类变量在 Python 中不是线程安全的。使类变量线程安全。请参阅尼克约翰逊的[这篇文章](http://blog.notdot.net/2011/10/Migrating-to-Python-2-7-part-1-Threadsafe)。

在 webapp2 中，您可以使用应用注册表：[http](http://webapp-improved.appspot.com/guide/app.html#registry) ://webapp-improved.appspot.com/guide/app.html#registry 。或者，如果您的请求需要“全局”（非共享），您可以使用请求注册表。

**更新 ：**

类变量与实例变量：

```
>>> class A(object):
...     a = 10                          # this is a class variable
...     def testa(self):
...         print A.a
...         print self.a
...     def adda(self, b):
...         self.a = self.a + b     # here we create an instance variable
...         
>>> x = A()
>>> x.testa()
10
10
>>> A.a = 50
>>> x.testa()
50
50
>>> x.adda(7)
>>> x.testa()
50
57
>>> A.a = 15
>>> x.testa()
15
57 
```

# deployment - 如何获得旧版本的 Meteor？

> ID：14115644
> 
> 赞同：1
> 
> 时间：2013-01-02T00:35:08.987
> 
> 标签：deployment, meteor, downgrade

我使用 Meteor v0.4.2 在我自己的服务器上部署了我的应用程序（我不确定这是确切的版本号，但它是最新的 pre-0.5.0）。

然后，我犯了在本地升级到 Meteor 0.5.2 的错误，现在不知道如何恢复 0.4.2 以便部署到服务器。

我尝试使用 0.5.2 版进行部署，但有一个奇怪的错误出现在服务器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:52:09.723

您可以直接从 git checkout 运行 Meteor，因此应该可以从[meteor trunk](http://github.com/meteor/meteor)克隆，然后签出[0.4.2 标签](https://github.com/meteor/meteor/tree/v0.4.2)并以这种方式运行流星。

repo 根目录的自述文件中概述了执行此操作的步骤。

# c# - 使用 C# 格式化和打印 HTML 页面

> ID：14115645
> 
> 赞同：3
> 
> 时间：2013-01-02T00:35:15.883
> 
> 标签：c#, html, printing

我正在使用 HTML 做一些工作，我想打印（在纸上）这些 HTML 文件，实际上，该文件不存在，所有内容都保存在一个字符串中，所有文本都保存在 HTML 中，但我想打印，已经格式化...

例如：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string HTML =
"<html>" +
"<head>" +
"    <style type=\"text/css\">" +
"    .title {" +
"        color: blue;" +
"        text-decoration: bold;" +
"        text-size: 1em;" +
"    }" +
"    .author {" +
"        color: gray;" +
"    }" +
"    </style>" +
"</head>" +
"<body>" +
"    <p>" +
"    <span class=\"title\">{0}</span>" +
"    <span class=\"author\">{1}</span>" +
"    </p>" +
"</body>" +
"</html>";

            // Just a sample of what I whant to do...
            // PseudoCode
            //Render the HTML code
            RenderHTML aa = new RenderHTML(string.Format(HTML, "Alexandre", "Bencz"));
            aa.PrintDocumentInPaper();
        }
    }
} 
```

我发现：http: [//msdn.microsoft.com/en-us/library/w290k23d.aspx](http://msdn.microsoft.com/en-us/library/w290k23d.aspx)

但是，我想知道是否有另一种方法可以做到这一点，更好的方法..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:18:05.357

您在 webbrowser MSDN 课程上走在了正确的轨道上，我认为您可以很容易地做到这一点。

1）您需要通过（您的文本字符串的）流而不是保存的文件来填充其文档内容。 [http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.documentstream%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.documentstream%28v=vs.100%29.aspx)

2）然后只需触发打印功能 [http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.print%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.print%28v=vs.100%29.aspx)

附上我提供的链接，我假设您使用的是 .Net 4.0。

# ios - 托管对象在获取时具有不同的 id

> ID：14115646
> 
> 赞同：2
> 
> 时间：2013-01-02T00:35:16.643
> 
> 标签：ios, core-data, nspredicate

我正在使用 coredata 并且有一个我没有得到的概念；我有 2 个托管对象 ACConversation 和 ACMessages 具有一对多关系，因此我正在保存与对话关联的消息并尝试根据以下内容取回它们：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF.conversation = %@", self.conversation]; 
```

但是与对象关联的 id 是不同的（它似乎更像是一个内存地址）并且使用上面的谓词它不会获取任何东西：

```
2013-01-01 18:32:13.727 CoreDataTest[9325:c07] The message to fetch: <NSManagedObject: 0x818f680> (entity: ACMessage; id: 0x8160630 <x-coredata:///ACMessage/t451CC5A3-5972-479C-BC7C-6B91CA4DA23C4> ; data: {
    conversation = "0x818b770 <x-coredata:///ACConversation/t451CC5A3-5972-479C-BC7C-6B91CA4DA23C2>";
    sentDate = "2013-01-01 23:32:13 +0000";
    text = "Test message to Fetch through relationship!!!";
})
2013-01-01 18:32:13.728 CoreDataTest[9325:c07] The conversation associated to the message: <NSManagedObject: 0x818b710> (entity: ACConversation; id: 0x818b770 <x-coredata:///ACConversation/t451CC5A3-5972-479C-BC7C-6B91CA4DA23C2> ; data: {
    draft = nil;
    lastMessageSentDate = "2013-01-01 23:32:13 +0000";
    lastMessageText = "Test message to Fetch through relationship!!!";
    messages =     (
        "0x8160630 <x-coredata:///ACMessage/t451CC5A3-5972-479C-BC7C-6B91CA4DA23C4>"
    );
    messagesLength = 0;
    unreadMessagesCount = 0;
    users =     (
        "0x818b610 <x-coredata:///ACUser/t451CC5A3-5972-479C-BC7C-6B91CA4DA23C3>"
    );
})

2013-01-01 18:32:13.782 CoreDataTest[9325:c07] The conversation found is: <NSManagedObject: 0x835e440> (entity: ACConversation; id: 0x8199860 <x-coredata://6E4B40F2-F7B4-4275-BF6E-349101A1254F/ACConversation/p290> ; data: <fault>)
2013-01-01 18:32:13.783 CoreDataTest[9325:c07] The conversation to find is: <NSManagedObject: 0x818b710> (entity: ACConversation; id: 0x835e2e0 <x-coredata://6E4B40F2-F7B4-4275-BF6E-349101A1254F/ACConversation/p296> ; data: {
    draft = nil;
    lastMessageSentDate = "2013-01-01 23:32:13 +0000";
    lastMessageText = "Test message to Fetch through relationship!!!";
    messages =     (
        "0x835e6d0 <x-coredata://6E4B40F2-F7B4-4275-BF6E-349101A1254F/ACMessage/p268>"
    );
    messagesLength = 0;
    unreadMessagesCount = 0;
    users =     (
        "0x835ea20 <x-coredata://6E4B40F2-F7B4-4275-BF6E-349101A1254F/ACUser/p296>"
    );
}) 
```

在代码下方：

```
- (NSFetchedResultsController *)fetchedResultsController {

    if (_fetchedResultsController) {
        NSLog(@"_fetchedResultsController found: %@", _fetchedResultsController);
        return _fetchedResultsController;
    }

    NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:@"ACMessage"];
    NSError __autoreleasing *error = nil;
    NSUInteger messagesCount = [managedObjectContext countForFetchRequest:fetchRequest error:&error];
    NSAssert(messagesCount != NSNotFound, @"-[NSManagedObjectContext countForFetchRequest:error:] error:\n\n%@", error);
    if (messagesCount > MESSAGE_COUNT_LIMIT) {
        [fetchRequest setFetchOffset:messagesCount-MESSAGE_COUNT_LIMIT];
    }
    [fetchRequest setFetchBatchSize:10];
    [fetchRequest setSortDescriptors:@[[[NSSortDescriptor alloc] initWithKey:@"sentDate" ascending:YES]]];

    /*
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF.conversation = %@", self.conversation];
    [fetchRequest setPredicate:predicate];
    //NSLog(@"Predicate: %@", predicate);
    */

    _fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:managedObjectContext sectionNameKeyPath:nil cacheName:@"ACMessage"];

    _fetchedResultsController.delegate = self;

    NSAssert([_fetchedResultsController performFetch:&error], @"-[NSFetchedResultsController performFetch:] error:\n\n%@", error);
    return _fetchedResultsController;
}

- (void) setSimpleData
{
    self.conversation = [NSEntityDescription insertNewObjectForEntityForName:@"ACConversation" inManagedObjectContext:managedObjectContext];
    self.conversation.lastMessageSentDate = [NSDate date];
    ACUser *user = [NSEntityDescription insertNewObjectForEntityForName:@"ACUser" inManagedObjectContext:managedObjectContext];
    [user setName: @"my user"];
    [user setElementId: @"kjh123k123"];

    [self.conversation addUsersObject:user];

    ACMessage *message = [NSEntityDescription insertNewObjectForEntityForName:@"ACMessage" inManagedObjectContext:managedObjectContext];
    self.conversation.lastMessageSentDate = message.sentDate = [NSDate date];
    self.conversation.lastMessageText = message.text = @"Test message to Fetch through relationship!!!";
    [self.conversation addMessagesObject:message];

    NSLog(@"The message to fetch: %@", message);
    //NSLog(@"The user associated to the conversation: %@", user);
    NSLog(@"The conversation associated to the message: %@", self.conversation);

    NSError *error;
    if (![[self managedObjectContext] save:&error]) {
        //Make sure you handle this!
        NSLog(@"ERROR: Can't save object context");
        exit(-1);
    }
}

- (void) getSimpleData
{
    NSError *error;

    if (![[self fetchedResultsController] performFetch:&error]) {
        // Update to handle the error appropriately.
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        exit(-1);  // Fail
    }

    NSInteger section = 0;
    id  sectionInfo = [[[self fetchedResultsController] sections] objectAtIndex:section];

    if ([sectionInfo numberOfObjects]>0) {

        NSIndexPath *my0 = [NSIndexPath indexPathForRow:0 inSection:0];
        ACMessage *message = [self.fetchedResultsController objectAtIndexPath:my0];

        ACConversation *conv = message.conversation;

        NSLog(@"The message fetch at index 0 is %@", message);
        NSLog(@"The conversation found is: %@", conv);
        NSLog(@"The conversation to find is: %@", self.conversation);

    } else {
        NSLog(@"No messages found!");
    }
} 
```

我是否遗漏了什么，或者我必须在 ACConversation 中设置一个 id 并在 NSPredicate 中使用它来查找与对话关联的所有消息？

谢谢！亚历克斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:58:50.263

当您第一次创建托管对象时，它有一个临时的`objectID`. `objectID`当您保存更改时，它会更改为永久。这是它唯一一次改变——从最初的临时值变为后来的永久值。您看到的差异正是发生这种变化时的预期。

你可以检查一个对象是否有这样的临时 ID：

```
BOOL hasTempID = [[myManagedObject objectID] isTemporaryID]; 
```

您还可以强制转换提前发生 - 在您保存更改之前 - 如下所示：

```
NSError *error = nil;
BOOL success = [managedObjectContext obtainPermanentIDsForObjects:@[myManagedObject] error:&error]; 
```

# jquery - 在触发控制下显示的下拉菜单

> ID：14115647
> 
> 赞同：1
> 
> 时间：2013-01-02T00:35:45.150
> 
> 标签：jquery, css, ajax, jquery-ui

我有一个下拉类型的菜单 div，其标签类似于下面。这不是只显示一次的顶级菜单。

```
<div id=”statusmenu”&gt;
<ul>
<li>menu Item#1</li>
<li>menu Item#2</li>
</ul>
</div> 
```

我的页面中有多个按钮，单击时需要在创建单击事件的按钮下显示此菜单（类似于上下文菜单）。有没有更有效的方法来做到这一点，而不是在我的每个按钮下隐藏这个 div，在点击时显示这个 div 或者做 Ajax 调用服务器（需要一些时间）每次都呈现这个内容。我在想是否有更好的解决方案可以将这个 div 隐藏在页面中的某个位置，并在触发事件时在控件下使用 jquery/JS 显示它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:06:22.117

首先，您不能创建该 div 的多个实例，因为您只能拥有唯一的 ID。因此，您可能希望它改为类名，例如`class="statusmenu"`. 此外，您如何知道将该菜单放在哪个元素下方？也许通过用`class="status"`? 如果是这种情况，那么您可以使用它来应用菜单：

```
$(document).on("click",'.status',function(){
 if($(this).find('.statusmenu').length == 0){
  var d = document.createElement("div");
  d.setAttribute("class","statusmenu");
  var ul = document.createElement("ul");
  var li1 = document.createElement("li");
  li1.innerHTML = "menu Item#1";
  var li2 = document.createElement("li");
  li2.innerHTML = "menu Item#2";
  ul.appendChild(li1);
  ul.appendChild(li2);
  d.appendChild(ul);
  $(d).hide();
  this.appendChild(d);
  $(d).slideDown();
 }else{
  $(this).find('.statusmenu').slideUp('fast',function(){ $(this).remove() });
 }
});​​​​​​​​​​​​​​ 
```

jsfiddle 演示：http: [//jsfiddle.net/jakVp/](http://jsfiddle.net/jakVp/)

# algorithm - 将任何字符串转换为介于 -1 和 1 之间的实数的算法

> ID：14115648
> 
> 赞同：1
> 
> 时间：2013-01-02T00:35:53.057
> 
> 标签：algorithm, encoding, computer-science, decoding

嗨，我正在寻找一种算法，将任何有限大的有限长字符串集转换为介于 -1 和 1 之间的特定实数，其中每个字符串都有唯一的实数表示。这个问题与编程语言无关。

每个字符串可以包含许多单词和结束行，以及数学定义的实数。我也可以使用任意精度库。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-02T00:47:13.037

假设您希望每个字符串映射到一个唯一的实数，也可以将其解码回原始字符串，我会使用[算术编码](http://en.wikipedia.org/wiki/Arithmetic_coding)。

基本上，您想要做的是将 -1 和 1 之间的实数集划分为等于字母表中字符数的多个部分，`n`. 要对单个字符串进行编码，只需选择其中一个区域的开头即可。要对字符串的第二个字符进行编码，首先找到第一个字符所在的区域，然后将该区域细分为`n`更小的区域，然后选择第二个字符所在的区域。然后，您可以递归此解决方案，以便能够将任意长度的字符串转换为唯一的实数。

例如，假设我们的字母表只有字符`a`，`b`并且我们想要对字符串进行编码`aba`。第一个`a`给了我们 region `[-1,0)`，第二个字符然后细分了这个 region 并产生了`[-0.5,0)`。对最终区域重复`a`以产生区域`[-0.5,-0.75)`。该区域中的*任何数字都**只能*解码为序列`aba`（假设我们知道原始字符串的长度，或者我们可以在解码时永远递归）。

（有关编码和解码过程的更详细说明，请参阅[维基百科](http://en.wikipedia.org/wiki/Arithmetic_coding)。请注意，您可能只对这个问题的等大小区域感兴趣。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-02T01:07:00.887

[*将我的评论变成答案。*]

你不需要做任何事情。一个字符串已经可以被认为是一个实数。每个字符都是小数点后的一个数字，以 base-256 为单位（对于 8 位字符）。

[正如所指出的](https://stackoverflow.com/questions/14115648/algorithm-to-convert-any-string-to-a-real-number-between-1-and-1/14115812#comment19535783_14115648)，这无法区分具有多个尾随`\0`字符的字符串。如果这是一个问题，那么您可以考虑这个数字 base-257，并且没有字符映射到值 0。

由于没有算法，所以没有额外的内存需求；您的输入字符串也是您的输出！任意精度库等没有问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T00:44:42.503

假设一个字符串是 20 个 ASCII 字节，或 160 位。双精度实数只有 64 位。因此，每个可能的字符串都不能有唯一的实数。

另一方面，如果不限于 64 位，只需将小数（二进制）点放在第一位后，将第一位作为符号，并将字符串的所有位作为小数。

事实上，如果您将字母表限制为数字字符 0-9，它已经以十进制算术的形式存在，COBOL 和以前的语言以及旧的 IBM 计算机都支持这种形式。只需将小数点放在前面，乘以 2，然后减去 1。

# php - Javascript 警报未在 php 联系表单中显示变音符号

> ID：14115649
> 
> 赞同：2
> 
> 时间：2013-01-02T00:36:14.230
> 
> 标签：php, javascript, alert, contact-form

在互联网上找到了这个简单的联系表格。一切正常，但警报似乎无法显示某些特定于我的语言的字符，例如 ā ē š ž ī ļ。这是联系表格的代码：

```
if ($mail_status) { ?>
<script language="javascript" type="text/javascript">
    alert('Jūsu ziņa ir saņemta!');
    window.location = '/';
</script>
<?php
} 
```

以下是警报的显示方式。

![](../Images/0cab2ffc93314d68398a1c500f4f6401.png)

我会很感激任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T00:52:00.710

在 ASCII 不会做的地方使用 Unicode 转义：

```
alert("J\u016bsu zi\u0146a ir sa\u0146emta!"); 
```

假设你有 Python 3，你自己编码更多的字符串也相当简单：

```
$ python3
>>> x = "Jūsu ziņa ir saņemta!"
>>> print(x.encode('ascii', error='backslashreplace').decode('ascii'))
J\u016bsu zi\u0146a ir sa\u0146emta! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T00:45:29.370

考虑使用特定语言的特定字符的 HTML 代码

例如`Ā`有 char html 代码`&#257;`

[关于所有其他人，您可以在此处](http://webdesign.about.com/library/bl_htmlcodes.htm)找到代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T00:45:33.790

`Jūsu ziņa ir saņemta!`in utf-8`JÅ«su ziÅ†a ir saÅ†emta!`在 iso-8559-1 中，因此浏览器将您的 utf-8 文本解释为 iso-8559-1。尝试添加`<meta http-equiv="Content-Type" content="text/html; charset=utf-8">`你的 head 标签来解决这个问题。

# php - 在php中注释局部变量

> ID：14115654
> 
> 赞同：35
> 
> 时间：2013-01-02T00:37:00.860
> 
> 标签：php, variables, local, phpdoc

我正在使用 Eclipse PDT，我想使用 Phpdoc 注释一个局部变量。

我所看到的只是我可以使用`@var`or 来注释类的变量/属性`@property`，但是对于局部变量这怎么可能呢？

我怎么能做这样的事情？

```
function foo(){
  /** @var Stock $a */
  $a->save();
} 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-01-02T00:38:38.707

Phpdoc 标准不涵盖这些注释（它仅涵盖带有`@var`标签的类属性）；但是，在 Eclipse 中是完全可能的（例如 PDT）：

```
/* @var $variable Type */
 ^         ^        `--- type
 |      variable           
 |
 `--- single star 
```

这也适用于所有其他 PHP IDE，例如 Netbeans 或 Phpstorm，如果您与他人交换代码，这将非常有用。

示例代码：

```
<?php

/* @var $doc DOMDocument */
$doc-> 
```

示例屏幕截图（Eclipse PDT (Indigo)）：

![Eclipse PDT（靛蓝）](../Images/94de78bed2cee12980b36f8d644cc88f.png)

**相关问答：**

*   [如何让我的 PHP IDE 理解依赖注入容器？](https://stackoverflow.com/a/6395761/367456)
*   [有没有办法让 PhpStorm 的自动完成“更深入”？](https://stackoverflow.com/q/7619709/367456)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-03T03:02:56.327

这是一个老问题，但仅供参考。您必须在当前文件中包含`Use`语句才能进行注释工作`Type``@var`

```
<?php
use YourVendor\YourBundle\Entity\ProductType;

...

/* @var $product_type ProductType */
$foo = $product_type->getName(); 
```

# joomla - 用奇怪的类型解密phpmyadmin中的密码

> ID：14115656
> 
> 赞同：0
> 
> 时间：2013-01-02T00:37:25.817
> 
> 标签：joomla, passwords, phpmyadmin, encryption

再会！我有一个很奇怪的问题。大约 7 个月前，我在我的一个网站上安装了 joomla，完全忘记了我的密码。很容易发现对吧？所以我登录到 php myadmin 以便使用 md5decrypter 解密它，我的密码类似于或更准确地说是这个**ffeb0b0d7b626671abc1c63a65239368:8tRMglEvI81jDHydqR5eufCRQy4TPJtS**

我`ve never encountered something like that and don`不知道它是哪种格式。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:43:18.897

最好的方法是：
1\. 创建一个新用户
2\. 为新用户设置密码
3\. 转到 phpmyadmin 并复制新用户哈希密码并粘贴到管理员
4\. 使用管理员和新用户密码登录！

如果您无法创建新用户，您可以安装新的 joomla（在 localhost 或服务器中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:13:50.420

如果您忘记了 Joomla! 以供将来参考！[管理员密码Joomla](http://extensions.joomla.org/)中有一个可用的工具！使过程变得简单的[扩展目录。](http://extensions.joomla.org/)

[重置管理员密码](http://extensions.joomla.org/extensions/tools/security-tools/13785)

# mysql - MySQL找到一个父母的许多孩子

> ID：14115664
> 
> 赞同：0
> 
> 时间：2013-01-02T00:39:00.890
> 
> 标签：mysql, one-to-many

如果我在两个表之间有这样的关系：

```
CREATE TABLE parent (id INT NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE child (id INT NOT NULL, parent_id INT,
    PRIMARY KEY (id),
    FOREIGN KEY (parent_id) REFERENCES parent(id)
); 
```

我想找到子表中引用父表中一行的所有行，是否更快：

1.  只需查询子表并返回所有匹配父行的id
2.  在父表的列中存储逗号分隔的 id 列表
3.  以上都不是

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T11:24:13.373

外键自然是索引的，所以最好的方法是执行这个查询：

```
SELECT * FROM child WHERE parent_id=X;
-- where X is the parent's ID 
```

# javascript - OnClick 的蓝色叠加层

> ID：14115665
> 
> 赞同：10
> 
> 时间：2013-01-02T00:39:18.567
> 
> 标签：javascript, android, html, webview

当我在 Android WebView 中显示一个 html 页面时，单击的元素上总是有一个蓝色覆盖层，该覆盖层带有一个 href 或一个 javascript 函数。我如何摆脱这个蓝色覆盖？

![在此处输入图像描述](../Images/22d7915f7b3666738f5830b3dad61e2b.png)

源代码

```
<html>
    <head>
    <title>Blue Overlay</title>
    <style>
    *{margin:0;padding:0;/* get rid of the default 2 pixels margin */
    } 
    body{background-color: #000000;}

    /* button-related CSS */
    a.button{
        background: url("img/icon_bt.png") no-repeat scroll center center transparent;
        display: block;
        text-decoration: none;/*remove the blue underline*/
        width: 70px;
        height: 70px;
        margin: 50px;
    }
    a.button:active{
        background-image: url("img/icon_bt_pressed.png");
    }

    </style>
</head>
<body>
    <a class="button" href="#"></a>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-02T00:59:16.693

我用不同的图像[尝试过它](http://jsfiddle.net/RM96v/3/)，它似乎有效。基本上，我只是添加了[另一个主题](https://stackoverflow.com/questions/7398763/android-browser-remove-outline-border-when-anchor-is-focused)中的建议：

```
a:button {
    ...
    -webkit-tap-highlight-color: rgba(0,0,0,0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:48:22.077

我不确定，但也许图像有蓝色叠加层（不仅是链接和 a-tag）。所以摆脱它，即`border: 0;`...

# r - 组合数据框列值（分类和数字）

> ID：14115667
> 
> 赞同：1
> 
> 时间：2013-01-02T00:39:24.380
> 
> 标签：r, dataframe

我有一个包含许多列的数据框（df），其中一些包含分类数据，而另一些包含数字数据。我想将“d”列的值定义为两列（“a”和“b”）的值的组合（一个带有分类数据，另一个带有数字数据）。

例如，“a”列第 1 行具有分类数据值“h”，“b”列第 1 行具有数字数据值“76”。我希望列 'd' 第 1 行具有值 'h76'

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:08:03.990

```
dfrm$d <- apply(dfrm, 1, paste0) 
```

如果某些数字列具有长十进制表示，这可能会产生不令人满意的结果。您真的应该发布一个可重现的示例，最好通过编辑您的问题并插入`dput(head(datfrm))`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T01:21:17.640

像这样：

```
df$d <- paste0(df$a, df$b) 
```

如果像一些你不喜欢看到太多的人一样，`df$`你也可以这样做：

```
df <- transform(df, d <- paste0(a, b)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T01:21:27.960

你可以试试这个。

```
mydatf$d <- factor(mydatf$a):factor(mydatf$b) 
```

例如

```
a <- c('h','l','l','h','h')
b <- 1:5

factor(a):factor(b)

1] h:1 l:2 l:3 h:4 h:5
Levels: h:1 h:2 h:3 h:4 h:5 l:1 l:2 l:3 l:4 l:5 
```

这与其他答案非常不同，因为它必然会产生一个与字符变量相反的因子。它也是`:`稍后在建模公式中所做的部分介绍。例如，注意变量的级别是什么。这可能是最好的答案，也可能是一个糟糕的答案，这取决于您想要这个新变量的用途。此外，如果 column`a`已经是一个因素，您可以更改`factor(mydatf$a)`为 just `datf$a`。对象中经常出现这种情况`data.frame`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-02T02:03:03.170

约翰说服我将此作为单独的答案输入，即使它与他的答案高度相关。

```
interaction(test$a, test$b, drop=TRUE, sep="", lex.order=TRUE) 
```

这将返回与以下相同的值：

```
factor(paste0(test$a, test$b)) 
```

（如果 test$a 是无序的，我认为因子水平也将是相同的顺序。）

使用因子通常优于字符（但并非总是如此）。

# objective-c - 如何检查最前面的应用程序是否全屏？

> ID：14115668
> 
> 赞同：2
> 
> 时间：2013-01-02T00:40:02.527
> 
> 标签：objective-c, xcode, macos, cocoa, fullscreen

我需要知道最前面的应用程序是否全屏。
这是我必须检查的内容（我知道`NSApplicationPresentationOptions`仅适用于`NSApplication`但我不知道如何使用`NSRunningApplication`）：

```
NSArray *activeApps = [[[NSWorkspace sharedWorkspace] runningApplications] filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"isActive==YES && bundleIdentifier!=%@", MY_BUNDLE_IDENTIFIER]];
if ([activeApps count] > 0){
    NSApplicationPresentationOptions opts = [[activeApps objectAtIndex:0] presentationOptions];
    timer = [NSTimer scheduledTimerWithTimeInterval:0.2 target:self selector:@selector(setupPlayer) userInfo:nil repeats:YES];
    if (opts & NSApplicationPresentationFullScreen) {
        //Do something
    }    
} 
```

因此，当我运行代码时，我显然会收到以下错误，因为`[activeApps objectAtIndex:0]`is a `NSRunningApplication`：

> -[NSRunningApplicationpresentationOptions]：无法识别的选择器发送到实例...

关于如何修复它并检查最前面的应用程序是否全屏的任何想法？或者还有其他替代方法可以执行此操作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T14:50:33.263

您可以使用 applescript 来检查最前面的应用程序是否是全屏的。

脚本可以像，

1）获取最前面的应用程序窗口。2) 获取该窗口的属性值“AXFullScreen”。

这会让你知道最前面的应用程序是否全屏。

希望能帮助到你 ！！！

# java - 使用 apache httpclient 如何为 http 请求设置 cookie

> ID：14115670
> 
> 赞同：7
> 
> 时间：2013-01-02T00:40:36.927
> 
> 标签：java

我试图在发送 http 请求之前设置 abc=123 cookie。

在响应中，我希望将相同的 cookie 发回。但是在响应中，我得到 abc=890 的值是由目标服务器设置的。

```
 DefaultHttpClient httpclient = new DefaultHttpClient();
    CookieStore cookieStore = httpclient.getCookieStore();
    BasicClientCookie cookie = new BasicClientCookie("abc", "123");

    // Prepare a request object
    HttpGet httpget = new HttpGet("http://abc.net/restofurl");

    cookieStore.addCookie(cookie);
    httpclient.setCookieStore(cookieStore);

    // Execute the request
    HttpResponse response = httpclient.execute(httpget);

    // Examine the response status
    log.info("Http request response is: " + response.getStatusLine());

    List<Cookie> cookies = cookieStore.getCookies();

    for (int i=0; i<cookies.size();i++) {

        if (cookies.get(i).getName().toString().equals("abc")) {
            log.info("cookie is: " + cookies.get(0).getValue().toString());
            }
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-02T15:07:27.497

添加后它工作

```
cookie.setDomain(".xyz.net");
cookie.setPath("/"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:24:39.357

问题是否通过更改解决

```
log.info("cookie is: " + cookies.get(0).getValue().toString()); 
```

进入

```
log.info("cookie is: " + cookies.get(i).getValue().toString()); 
```

?

# flash - RTMPGW 流式传输到嵌入式 Flash 播放器

> ID：14115677
> 
> 赞同：1
> 
> 时间：2013-01-02T00:42:08.680
> 
> 标签：flash, streaming

我一直在玩 rtmpgw，它通过 http 从我的笔记本电脑流式传输，没有任何问题，并且流通过 vlc 使用地址 http://myipaddress: 8902 毫无问题地播放。

但是，我怎样才能让 JWplayer 通过浏览器播放这个流？当 VLC 通过 http 流式传输时，它包含一个文件名（例如 http://myipaddress:8902/myfile.flv）。但是，rtmpgw 似乎没有给出文件名，所以我无法通过 JWplayer 设置脚本连接到它。终端中的 Wget 可以正常下载流并识别它是一个 flv，所以我想知道 JWplayer 是如何做到这一点的？

有任何想法吗？

谢谢

担

# php - XSLT 或 PHP 超链接删除元素

> ID：14115679
> 
> 赞同：1
> 
> 时间：2013-01-02T00:42:16.090
> 
> 标签：php, xml, xslt

我的 XML 文件的片段：

```
<list>
  <info>
    <title>My Title</title>
    <blah>My Blah</blah>
    <derp>My Derp</derp>
  </info>
  <info>
    <title>Second Title</title>
    <blah>My Blah2</blah>
    <derp>My 2nd Derp</derp>
  </info>
  <info>
    <title>123</title>
    <blah>444</blah>
    <derp>zzz</derp>
  </info>
</list> 
```

我的 XSLT 文件的片段：

```
<xsl:for-each select="info">
<tr>
    <td><xsl:value-of select="title" /></td>
    <td><xsl:value-of select="blah" /></td>
    <td><xsl:value-of select="derp" /></td>
</tr>
</xsl:for-each> 
```

`XSLTProcessor`当我在 PHP 中使用时，这基本上会在一个整洁的表格中显示我自己的行中的 info 元素的标题、blah 和 derp 。

但无论如何，我想要做的是在我的表格中的每一行元素中都有一个**X按钮。**并且当单击此**X**按钮时，整个相应`<info>`元素将从 XML 文件中删除。问题是我不知道从哪里开始这样做。我不知道是否可以使用 XSL 在 XML 文件中重写，或者我是否必须在 PHP 中进行。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T13:20:29.890

> 如何按位置删除 XML 文档中的元素。

如所写，您可以使用 Xpath 表达式来查询要删除的元素，然后删除它们。

以下是一个快速的 PHP 示例，它有点扩展，因为它还删除了元素之后的文本（在您的文档中的空白）作为奖励。这再次显示了如何使用位置谓词：

```
$doc = new DOMDocument();
$doc->loadXML($xml);
$xp = new DOMXPath($doc);

$expression = '

    /list/info[2]   |  /list/info[2]/following-sibling::text()[1]
                                                                    ';
//   the element,          the whitespace after the element,
//   numbered              again numbered. just to clean up a bit
//                         and to give another example

$delete = $xp->query($expression);
foreach($delete as $element) {
    $element->parentNode->removeChild($element);
}

echo $doc->saveXML(); 
```

结果看起来像（[在线演示](http://eval.in/5835)）：

```
<?xml version="1.0"?>
<list>
  <info>
    <title>My Title</title>
    <blah>My Blah</blah>
    <derp>My Derp</derp>
  </info>
  <info>
    <title>123</title>
    <blah>444</blah>
    <derp>zzz</derp>
  </info>
</list> 
```

我希望这是有帮助的。

我最近也在写关于编号谓词的[答案，以*仅选择一个节点并继续 php*](https://stackoverflow.com/a/14110664/367456)。也许它会散发出更多的光芒。

# ios - 带有 NSDate 的 dataWithJSONObject

> ID：14115683
> 
> 赞同：1
> 
> 时间：2013-01-02T00:42:49.267
> 
> 标签：ios, json

有谁知道我如何使用 dataWithJSONObject 来序列化包含 NADate 对象的字典或数组？SBJSON 有一个用户可定义的方法，可以为此提供。NSJSONSerialization 有类似的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-13T06:23:43.070

dataWithJSONObject 将 NSDate 序列化为 String 但不会将其反序列化。所以解决方案可以在 NSDictionary 值中使用 String 或 NSDate.timeIntervalSince1970 ，然后使用 NSDate(timeIntervalSince1970)

# windows - 如何在 Windows 上设置 gl3w？

> ID：14115684
> 
> 赞同：3
> 
> 时间：2013-01-02T00:43:00.270
> 
> 标签：windows, opengl, sdl, loader

我一直在寻找设置 Gl3w 的详细指南，因为我找不到任何地方！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-02T00:43:00.270

首先，在[https://github.com/skaslev/gl3w下载 gl3w](https://github.com/skaslev/gl3w)

然后，下载 Python 3.x：

[https://www.python.org/downloads/](https://www.python.org/downloads/)

接下来，运行脚本。它将在源文件夹中生成 gl3w.c，在 include/GL/ 文件夹中生成 gl3w.h 和 glcorearb.h。

取其中三个，或者直接将它们添加到您的项目中，或者（更容易包含），将它们移动到项目的源文件文件夹中，然后将 3 添加到项目中。

在您的主要来源和“gl3w.c”来源中，您想要将包含更改为#include“gl3w.h”因此，您必须将gl3w.h的包含更改为#include“glcorearb.h”

这是因为您更改了他们的文件夹设置，否则编译器将抛出“找不到 xxx”。

并且不要忘记链接到“opengl32”，只需添加库即可。在 Code::Blocks 中，选择根项目，进入“构建选项”，再次选择根项目（在调试和发布上方），进入链接器设置，添加，然后键入不带引号的“opengl2”。

就这样！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-29T13:54:11.410

你需要 python 3。我现在有 python 3.8。在 Windows 10 上。它应该在路径中。它还带有名为 IDLE 的工具。它基本上是集成的python编辑器。您可以在开始菜单中找到它。 [![在此处输入图像描述](../Images/2f06adf5f69c0bf1ac89d339f1fbe594.png)](https://i.stack.imgur.com/XEOQg.png) 你会需要这个。我不知道为什么它不能从命令行工作，但是......它不能工作。但它在空闲时工作。所以运行它，然后从菜单 File - gl3w_gen.py 打开 [![gl3w_get.py 文件](../Images/8db56f7e9211169440062d81410895ba.png)](https://i.stack.imgur.com/tPprC.png)

[![如何打开](../Images/c3813e3561ba2893b9c3dd2448a869b1.png)](https://i.stack.imgur.com/7oRl2.png)

然后在这里转到运行并运行模块：

[![运行模块](../Images/a229f66593b1255c5bd20b6852afa855.png)](https://i.stack.imgur.com/DhD0z.png)

你会得到这样的东西：

[![运行结果](../Images/75410beabb37b787765403de02e7dede.png)](https://i.stack.imgur.com/Cl0fu.png)

它会为您下载所有文件。这适用于我的情况。

# php - 为什么我无法加载默认站点操作？

> ID：14115686
> 
> 赞同：0
> 
> 时间：2013-01-02T00:43:03.187
> 
> 标签：php, apache, .htaccess, zend-framework

我将 Zend FW 应用程序从我的 Ubuntu PC（旧域）移到了 Ubuntu 笔记本电脑上。后来我将一个版本复制回我的 Ubuntu PC 并将其设置在另一个虚拟主机（新域）下。现在，当我转到新虚拟主机的根目录时，我看到了默认的 apache 主机页面（即“It Works！”），而不是我网站的默认页面。为什么会这样？

更多信息：

*   当我导航到 newdomain/index.php 时，会显示正确的页面
*   olddomain 和 newdomain 的 .htaccess 文件相同
*   新旧域的 index.php 文件相同
*   我看不到任何权限差异
*   两个域的 /etc/hosts 记录相同
*   我启用了站点 ( `a2ensite`)，并重新启动了 apache

我错过了什么？

谢谢！

编辑：这是新域“front15”的虚拟主机配置：

```
<VirtualHost *:80>
    ServerName front15
    DocumentRoot /media/mainhdd/development/www/front/v15/public

    SetEnv APPLICATION_ENV "development"

    <Directory /media/mainhdd/development/www/front/v15/public>
        DirectoryIndex index.php
        AllowOverride All
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:35:37.513

在我的 /etc/hosts 文件中，我在一行上有多个虚拟主机，都指向同一个 IP (127.0.0.1)。我将它们分开，每行一个，现在它工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:56:28.350

我认为有两种可能性会导致您出现此问题。其中之一（最不可能的可能性）是您的 .htaccess 或 apache.conf 文件中有一个 mod_rewrite 规则，该规则特定于此设置中不存在的 IP 或域。

更有可能的可能性是您的[mod_dir](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryindex)`DirectoryIndex`的 httpd指令在*index.php***之前**首先列出了*index.html*。您必须记住 mod_dir按顺序使用参数，第一个参数优先于第二个参数，依此类推。因此，如果您有并且在您的根 Web 目录中有一个*index.html*文件和一个*index.php文件，那么 httpd 将使用**index.html*而不是*index.php*，因为这是它首先找到的那个。顺便说一下，这是默认设置。 ****`DirectoryIndex``DirectoryIndex index.html index.php`****

 *****因此，要么从该目录中删除 index.html，要么将`DirectoryIndex`httpd.conf 或 vhost 文件中的指令更改为在 index.html 之前使用*index.php*，这样*index.php*文件总是优先。*****

# ruby-on-rails - 有没有办法修复 Kaminari 分页生成的 url？

> ID：14115690
> 
> 赞同：5
> 
> 时间：2013-01-02T00:43:34.033
> 
> 标签：ruby-on-rails, ruby-on-rails-3, kaminari

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-02T02:19:14.553

这是 Kaminari 的一个已知问题。请参阅：[问题 #132](https://github.com/amatsuda/kaminari/issues/132)，[问题 #182](https://github.com/amatsuda/kaminari/issues/182)。

当前已知的解决方法是在分页助手上手动设置参数，例如：

```
paginate @comments, :params => { :controller => 'comments', :action => 'index', _: nil, _method: nil, authenticity_token: nil, utf8: nil} 
```

您必须调整该代码以适应您的情况，并确保在手动设置所有参数时测试所有其他功能是否按预期工作。

由于您特别遇到了 URL 上的时间戳问题，因此您应该对问题 132 发表评论并在此处发布您的体验详细信息。您参与 github 问题的次数越多，您、项目用户和维护者就越有可能找到更好的解决方案。

# mysql - MySQL 错误 1005：无法创建表。关于使用外键作为多列主键

> ID：14115694
> 
> 赞同：2
> 
> 时间：2013-01-02T00:43:59.370
> 
> 标签：mysql

我有一个由两列组成的多对多表`user_processes`：`user`和`process`. `user`是引用用户表主键的外键。该`process`列是引用进程主键的外键。但是，我不需要单独的主键列，因为 , 上的`user_processes`多列主键应该足够了（对吗？我没有看到需要单独的列）。一个用户可以有多个进程，但同一用户不应有多个行具有相同的进程。`user``process``id`

以下代码在 phpmyadmin 中给了我错误“#1005 - Can't create table 'test.user_processes' (errno: 150) (Details...)”。

这是由mysql工作台生成的代码：

```
-- -----------------------------------------------------
-- Table `test`.`user_processes`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `test`.`user_processes` (
  `user` INT UNSIGNED NOT NULL ,
  `process` INT UNSIGNED NOT NULL ,
  PRIMARY KEY (`user`, `process`) ,
  INDEX `fk_user_processes_users1_idx` (`user` ASC) ,
  INDEX `fk_user_processes_processes1_idx` (`process` ASC) ,
  CONSTRAINT `fk_user_processes_users1`
    FOREIGN KEY (`user` )
    REFERENCES `test`.`users` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_user_processes_processes1`
    FOREIGN KEY (`process` )
    REFERENCES `test`.`processes` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB; 
```

知道为什么它不让我这样做，以及正确的解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T00:54:41.830

该表`users`和/或`processes`可能不存在。确保在调用它之前执行引用表的创建表语句。

或引用字段的类型`users.id`和/或与字段/`processes.id`的类型不匹配。在这种情况下，这些字段也应该是.`user_processes.user``user_processes.process``INT UNSIGNED`

# php - mysql中的多个搜索查询？

> ID：14115697
> 
> 赞同：0
> 
> 时间：2013-01-02T00:44:21.417
> 
> 标签：php, mysql, search

我有一个简单的搜索查询脚本，当用户输入关键字时，会在数据库中显示与这些查询匹配的任何用户。

目前，用户一次只能搜索一个查询，但我想知道如何修改此脚本，以便用户可以搜索多个查询，因此如果他们输入白人英国男性，他们会将所有用户列为白人，英国和男性。或者，如果他们搜索威尔士 40 岁以上的女性，他们会得到所有威尔士 40 岁以上女性的用户。

```
$query_for_result=mysql_query("SELECT *
                            FROM ptb_stats
                            WHERE display_name like '%".$query."%' OR and location LIKE '%".$query."%' OR age LIKE '%".$query."%' OR nationality LIKE '%".$query."%' OR hobbies LIKE '%".$query."%' OR ethnicity LIKE '%".$query."%' OR local_station LIKE '%".$query."%' LIMIT 5");
    echo "<div class=\"search-results\">";
    while($data_fetch=mysql_fetch_array($query_for_result))

    { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T00:54:32.190

`and`除了你的 SQL 看起来不错之外，你还有一个额外的东西。虽然我确实希望你在消毒`$query`。

您可能需要考虑是否要使用`OR`或`AND`取决于您尝试对搜索进行的具体操作。您几乎肯定还希望构建您的 SQL 字符串以仅包含您要搜索的列。前任：

```
if( isset($query_age) ) {
    $sql_string .= " OR age LIKE '%".$query_age."%'";
}
etc... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:56:35.417

您可以实现对 PHP 页面的客户端 Ajax 调用，然后将进行数据库查询并将 XML 或 JSON 答案返回给客户端。然后在本地更新客户端。

# ios - Airplay 镜像（iPhone 到 Mac），如反射或 AirServer

> ID：14115700
> 
> 赞同：4
> 
> 时间：2013-01-02T00:44:46.493
> 
> 标签：ios, xcode, osx-mountain-lion, mirroring, airplay

有没有办法做到这一点。我在苹果文档中找不到太多内容。对不起，如果我完全错过了这个。我知道我的代码方式。我今年 16 岁，对其中的一些内容还很陌生。我在应用商店有一些应用，所以我知道我在做什么，但对所有这些还是有点新鲜。谢谢。我知道有这个[AirPlay Mirroring iPhone to Mac OS / using UIWebView + AirPlay](https://stackoverflow.com/questions/7799119/airplay-mirroring-iphone-to-mac-os-using-uiwebview-airplay)而且购买它可能更容易，但有办法做到这一点。我有一个 4s，所以我知道它可以处理镜像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T02:28:01.717

[解码 AirPlay 镜像协议](https://stackoverflow.com/questions/10017122/decoding-airplay-mirroring-protocol?rq=1)的可能副本。

正如[这里](http://www.aorensoftware.com/blog/2011/08/20/exploring-airplay-mirroring-internals/)所解释的，基本上流是使用 FairPlay™ 加密的，该技术与加密通过 iTunes 购买的应用程序和电影相同。

为了做你想做的事，你需要对 FairPlay 进行逆向工程。这是我能想到的唯一方法，您提到的现有应用程序正在这样做，但我不确定......如果有人可以进一步详细说明，那将会很有趣。不管重点是什么，这都不是微不足道的。

这是协议： http: [//nto.github.com/AirPlay.html](http://nto.github.com/AirPlay.html)

# angularjs - AngularJS - 创建一个使用 ng-model 的指令

> ID：14115701
> 
> 赞同：297
> 
> 时间：2013-01-02T00:44:51.767
> 
> 标签：angularjs, directive

我正在尝试创建一个指令，该指令将创建一个与创建指令的元素具有相同 ng-model 的输入字段。

到目前为止，这是我想出的：

**HTML**

```
<!doctype html>
<html ng-app="plunker" >
<head>
  <meta charset="utf-8">
  <title>AngularJS Plunker</title>
  <link rel="stylesheet" href="style.css">
  <script>document.write("<base href=\"" + document.location + "\" />");</script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js"></script>
  <script src="app.js"></script>
</head>
<body ng-controller="MainCtrl">
  This scope value <input ng-model="name">
  <my-directive ng-model="name"></my-directive>
</body>
</html> 
```

**JavaScript**

```
var app = angular.module('plunker', []);

app.controller('MainCtrl', function($scope) {
  $scope.name = "Felipe";
});

app.directive('myDirective', function($compile) {
  return {
    restrict: 'E',
    scope: {
      ngModel: '='
    },
    template: '<div class="some"><label for="{{id}}">{{label}}</label>' +
      '<input id="{{id}}" ng-model="value"></div>',
    replace: true,
    require: 'ngModel',
    link: function($scope, elem, attr, ctrl) {
      $scope.label = attr.ngModel;
      $scope.id = attr.ngModel;
      console.debug(attr.ngModel);
      console.debug($scope.$parent.$eval(attr.ngModel));
      var textField = $('input', elem).
        attr('ng-model', attr.ngModel).
        val($scope.$parent.$eval(attr.ngModel));

      $compile(textField)($scope.$parent);
    }
  };
}); 
```

但是，我不确定这是处理这种情况的正确方法，并且存在一个错误，即我的控件没有使用 ng-model 目标字段的值进行初始化。

这是上面代码的 Plunker：http: [//plnkr.co/edit/IvrDbJ](http://plnkr.co/edit/IvrDbJ)

处理这个的正确方法是什么？

**编辑**：`ng-model="value"`从模板中删除后，这似乎工作正常。但是，我会保持这个问题的开放性，因为我想仔细检查这是这样做的正确方法。

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2013-01-02T03:18:15.023

**编辑**：这个答案很旧，可能已经过时了。只是一个提醒，所以它不会让人们误入歧途。我不再使用 Angular，所以我无法进行改进。

* * *

这实际上是一个很好的逻辑，但你可以稍微简化一下。

### 指示

```
var app = angular.module('plunker', []);

app.controller('MainCtrl', function($scope) {
  $scope.model = { name: 'World' };
  $scope.name = "Felipe";
});

app.directive('myDirective', function($compile) {
  return {
    restrict: 'AE', //attribute or element
    scope: {
      myDirectiveVar: '=',
     //bindAttr: '='
    },
    template: '<div class="some">' +
      '<input ng-model="myDirectiveVar"></div>',
    replace: true,
    //require: 'ngModel',
    link: function($scope, elem, attr, ctrl) {
      console.debug($scope);
      //var textField = $('input', elem).attr('ng-model', 'myDirectiveVar');
      // $compile(textField)($scope.$parent);
    }
  };
}); 
```

### 带有指令的 HTML

```
<body ng-controller="MainCtrl">
  This scope value <input ng-model="name">
  <my-directive my-directive-var="name"></my-directive>
</body> 
```

### CSS

```
.some {
  border: 1px solid #cacaca;
  padding: 10px;
} 
```

[你可以通过这个Plunker](http://plnkr.co/edit/A29hl6)看到它的实际效果。

这是我看到的：

*   我理解您为什么要使用“ng-model”，但在您的情况下没有必要。ng-model 是将*现有的*html 元素与范围内的值链接。由于您自己创建了一个指令，因此您正在创建一个“新”html 元素，因此您不需要 ng-model。

**编辑**正如马克在他的评论中提到的，没有理由*不能*使用 ng-model，只是为了遵守约定。

*   通过在指令中显式创建范围（“隔离”范围），指令的范围无法访问父范围上的“名称”变量（我认为这就是您想要使用 ng-model 的原因）。
*   我从您的指令中删除了 ngModel 并将其替换为您可以更改为任何名称的自定义名称。
*   使这一切仍然有效的是范围内的“=”符号。查看“范围”标题下的文档 [文档。](http://docs.angularjs.org/guide/directive)

通常，如果您希望指令中的值始终映射到父范围中的值，则您的指令应使用隔离范围（您正确地做到了）并使用 '=' 类型范围。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2013-06-03T15:00:38.980

我综合了所有答案，现在有两种使用 ng-model 属性的方法：

*   使用复制 ngModel 的新范围
*   具有在链接上进行编译的相同范围

```
var app = angular.module('model', []);

app.controller('MainCtrl', function($scope) {
  $scope.name = "Felipe";
  $scope.label = "The Label";
});

app.directive('myDirectiveWithScope', function() {
  return {
    restrict: 'E',
    scope: {
      ngModel: '=',
    },
    // Notice how label isn't copied
    template: '<div class="some"><label>{{label}}: <input ng-model="ngModel"></label></div>',
    replace: true
  };
});
app.directive('myDirectiveWithChildScope', function($compile) {
  return {
    restrict: 'E',
    scope: true,
    // Notice how label is visible in the scope
    template: '<div class="some"><label>{{label}}: <input></label></div>',
    replace: true,
    link: function ($scope, element) {
      // element will be the div which gets the ng-model on the original directive
      var model = element.attr('ng-model');
      $('input',element).attr('ng-model', model);
      return $compile(element)($scope);
    }
  };
});
app.directive('myDirectiveWithoutScope', function($compile) {
  return {
    restrict: 'E',
    template: '<div class="some"><label>{{$parent.label}}: <input></label></div>',
    replace: true,
    link: function ($scope, element) {
      // element will be the div which gets the ng-model on the original directive
      var model = element.attr('ng-model');
      return $compile($('input',element).attr('ng-model', model))($scope);
    }
  };
});
app.directive('myReplacedDirectiveIsolate', function($compile) {
  return {
    restrict: 'E',
    scope: {},
    template: '<input class="some">',
    replace: true
  };
});
app.directive('myReplacedDirectiveChild', function($compile) {
  return {
    restrict: 'E',
    scope: true,
    template: '<input class="some">',
    replace: true
  };
});
app.directive('myReplacedDirective', function($compile) {
  return {
    restrict: 'E',
    template: '<input class="some">',
    replace: true
  };
});
```

```
.some {
  border: 1px solid #cacaca;
  padding: 10px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"></script>
<div ng-app="model" ng-controller="MainCtrl">
  This scope value <input ng-model="name">, label: "{{label}}"
  <ul>
    <li>With new isolate scope (label from parent):
      <my-directive-with-scope ng-model="name"></my-directive-with-scope>
    </li>
    <li>With new child scope:
      <my-directive-with-child-scope ng-model="name"></my-directive-with-child-scope>
    </li>
    <li>Same scope:
      <my-directive-without-scope ng-model="name"></my-directive-without-scope>
    </li>
    <li>Replaced element, isolate scope:
      <my-replaced-directive-isolate ng-model="name"></my-replaced-directive-isolate>
    </li>
    <li>Replaced element, child scope:
      <my-replaced-directive-child ng-model="name"></my-replaced-directive-child>
    </li>
    <li>Replaced element, same scope:
      <my-replaced-directive ng-model="name"></my-replaced-directive>
    </li>
  </ul>
  <p>Try typing in the child scope ones, they copy the value into the child scope which breaks the link with the parent scope.
  <p>Also notice how removing jQuery makes it so only the new-isolate-scope version works.
  <p>Finally, note that the replace+isolate scope only works in AngularJS >=1.2.0
</div>
```

我不确定我是否喜欢链接时的编译。但是，如果您只是用另一个元素替换元素，则不需要这样做。

总而言之，我更喜欢第一个。只需将范围设置为`{ngModel:"="}`并在模板中设置`ng-model="ngModel"`您想要的位置。

**更新**：我内联了代码片段并为 Angular v1.2 更新了它。事实证明，隔离范围仍然是最好的，尤其是在不使用 jQuery 时。所以归结为：

*   您是否要替换单个元素：只需替换它，不要理会范围，但请注意，对于 v2.0，不推荐使用替换：

    ```
    app.directive('myReplacedDirective', function($compile) {
      return {
        restrict: 'E',
        template: '<input class="some">',
        replace: true
      };
    }); 
    ```

*   否则使用这个：

    ```
    app.directive('myDirectiveWithScope', function() {
      return {
        restrict: 'E',
        scope: {
          ngModel: '=',
        },
        template: '<div class="some"><input ng-model="ngModel"></div>'
      };
    }); 
    ```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2014-03-25T05:40:41.253

没那么复杂：在你的指令中，使用别名：`scope:{alias:'=ngModel'}`

```
.directive('dateselect', function () {
return {
    restrict: 'E',
    transclude: true,
    scope:{
        bindModel:'=ngModel'
    },
    template:'<input ng-model="bindModel"/>'
} 
```

在您的 html 中，正常使用

```
<dateselect ng-model="birthday"></dateselect> 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-01-02T06:41:56.193

只有在需要访问模型的 $viewValue 或 $modelValue 时才需要 ng-model。请参阅[NgModelController](http://docs.angularjs.org/api/ng.directive:ngModel.NgModelController)。在这种情况下，您将使用`require: '^ngModel'`.

其余的，请参阅[Roys 的回答](https://stackoverflow.com/a/14116498/1916258)。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2015-07-28T15:40:08.670

这是一个有点晚的答案，但我发现了这篇关于的很棒[的帖子](https://web.archive.org/web/20150218002317/http://www.chroder.com/2014/02/01/using-ngmodelcontroller-with-custom-directives/)`NgModelController`，我认为这正是你想要的。

**TL;DR** - 您可以使用`require: 'ngModel'`然后添加`NgModelController`到您的链接功能：

```
link: function(scope, iElement, iAttrs, ngModelCtrl) {
  //TODO
} 
```

这样，不需要任何技巧——你使用的是 Angular 的内置`ng-model`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-02T03:10:46.897

我不会通过属性设置 ngmodel，您可以在模板中直接指定它：

```
template: '<div class="some"><label>{{label}}</label><input data-ng-model="ngModel"></div>', 
```

**plunker**：[http ://plnkr.co/edit/9vtmnw?p=preview](http://plnkr.co/edit/9vtmnw?p=preview)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-16T10:07:20.670

从 Angular 1.5 开始，可以使用组件。组件很容易解决这个问题。

```
<myComponent data-ng-model="$ctrl.result"></myComponent>

app.component("myComponent", {
    templateUrl: "yourTemplate.html",
    controller: YourController,
    bindings: {
        ngModel: "="
    }
}); 
```

在 YourController 中，您需要做的就是：

```
this.ngModel = "x"; //$scope.$apply("$ctrl.ngModel"); if needed 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-18T01:00:06.977

创建隔离范围是不可取的。我会避免使用范围属性并做这样的事情。scope:true 为您提供了一个新的子范围，但不隔离。然后使用 parse 将本地范围变量指向用户提供给 ngModel 属性的同一对象。

```
app.directive('myDir', ['$parse', function ($parse) {
    return {
        restrict: 'EA',
        scope: true,
        link: function (scope, elem, attrs) {
            if(!attrs.ngModel) {return;}
            var model = $parse(attrs.ngModel);
            scope.model = model(scope);
        }
    };
}]); 
```

# c# - 在 C# 中声明和使用匿名对象数组

> ID：14115703
> 
> 赞同：9
> 
> 时间：2013-01-02T00:45:15.587
> 
> 标签：c#, .net, anonymous-types

我们有多少次声明一个简单的类或结构来保存一些属性，但在方法返回时只使用一次。我想太多次了，谢天谢地，我们总是有可以在运行时声明的匿名对象。

考虑到这一点，我想知道如何声明一组这样的匿名对象。

例子：

```
var Employee = new { ID = 5, Name= "Prashant" }; 
```

这创建了一个具有两个属性的匿名对象，一个是整数，另一个是字符串。

一切都很好，但是我应该如何声明这种对象的数组，以及如何建议使用 a`for`和`foreach`循环遍历它。

`foreach`循环确实是我认为的问题，因为 foreach 循环需要一个声明的类型。仍然可能有一个离开，如果有我当然也会知道。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-02T01:01:09.183

> 我们有多少次声明一个简单的类或结构来保存一些属性，但在方法返回时只使用一次。我想太多次了，谢天谢地，我们总是有可以在运行时声明的匿名对象。

你的第一句话和第二句话表明你有相互矛盾的目的。匿名类型以及匿名类型数组不能轻易地从方法中返回，因为无法声明返回类型。尝试只对临时局部变量使用匿名类型。

> 考虑到这一点，我想知道如何声明一组这样的匿名对象。

像这样：

```
var array = new[] 
  { 
    new { X = 123, Y = 456 }, 
    new { X = 345, Y = 567 } 
  }; 
```

> 您如何建议使用 for 和 foreach 循环来迭代它。

```
foreach(var item in array) 
... 
```

或者

```
for (int i = 0; i < array.Length; i += 1)
{
    var item = array[i];
    ...
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-02T01:01:01.810

[编辑 - 更新以显示人口、基本枚举等]

正如@Eve 所说，LINQ 是你的朋友；作为一般的经验法则，不要尝试传递匿名类型 -*如果你很聪明，你可以*- 但在声明它们的上下文/范围之外处理它们是一个巨大的痛苦。

顺便说一句，我决定看看以什么方式可以“声明一个匿名类型的数组”作为一个有趣的思想实验，并想出了这些：

（注意：“转储”是由于这是用 LINQPad 编写的）

```
// Our anonymous type sequence
var anonymousEnumerable = Enumerable
        .Range(0, 10)
        .Select(i => new { ID = i, Text = i.ToString() });
var enumerableCount = anonymousEnumerable.Count();
var anonymousType = anonymousEnumerable.First().GetType();

// Option #1 - declare it as dynamic, i.e., anything goes
dynamic[] asDynamicArray = new dynamic[enumerableCount];
foreach(var tuple in anonymousEnumerable.Select((item, i) => Tuple.Create(i, item)))
{
    asDynamicArray[tuple.Item1] = tuple.Item2;
}

// Let's go the IEnumerable route
foreach (var asDynamic in asDynamicArray)
{
    Console.WriteLine("ID:{0} Text:{1}", asDynamic.ID, asDynamic.Text);
}

// Lowest common denominator: *everything* is an object
object[] asObjectArray = new object[enumerableCount];
foreach(var tuple in anonymousEnumerable.Select((item, i) => Tuple.Create(i, item)))
{
    asObjectArray[tuple.Item1] = tuple.Item2;
}

// Let's iterate with a for loop - BUT, it's now "untyped", so things get nasty
var idGetterMethod = anonymousType.GetMethod("get_ID");
var textGetterMethod = anonymousType.GetMethod("get_Text");
for(int i=0;i < asObjectArray.Length; i++)
{
    var asObject = asObjectArray[i];
    var id = (int)idGetterMethod.Invoke(asObject, null);
    var text = (string)textGetterMethod.Invoke(asObject, null);
    Console.WriteLine("ID:{0} Text:{1}", id, text);
}

// This is cheating :)
var letTheCompilerDecide = anonymousEnumerable.ToArray();
foreach (var item in letTheCompilerDecide)
{
    Console.WriteLine("ID:{0} Text:{1}", item.ID, item.Text);
}

// Use reflection to "make" an array of the anonymous type
var anonymousArrayType = anonymousType.MakeArrayType();
var reflectIt = Activator.CreateInstance(
          anonymousArrayType, 
          enumerableCount) as Array;    
Array.Copy(anonymousEnumerable.ToArray(), reflectIt, enumerableCount);  

// We're kind of in the same boat as the object array here, since we
// don't really know what the underlying item type is
for(int i=0;i < reflectIt.Length; i++)
{
    var asObject = reflectIt.GetValue(i);
    var id = (int)idGetterMethod.Invoke(asObject, null);
    var text = (string)textGetterMethod.Invoke(asObject, null);
    Console.WriteLine("ID:{0} Text:{1}", id, text);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:49:04.227

您可以使用 LINQ 来实现您所需要的。这是一个例子。

```
int[] ids = {10, 15, 99};
string[] names = {"John", "Phil", "Jack"};
var array = ids.Zip(names, (id, name) => new {ID = id, Name = name}).
                ToArray(); 
```

或者，如果您只需要数组但没有数据，则可以使用此解决方法。但是，结果将是`Array`，没有关于元素类型的信息。

```
var sample = new {ID = default(int), Name = default(string)};
var arrayLength = 10;
var array = Array.CreateInstance(sample.GetType(), arrayLength); 
```

关于迭代，可以`var`在你的`for`/`foreach`循环中使用，避免声明类型的问题。

```
foreach (var item in array)
{
    //Do something
}

for (var i = 0; i < array.Length; i++)
{
    var item = array[i];
    //Do something
} 
```

编辑：基于样本创建具有任意数量元素的空数组的另一种解决方法。

```
public static T[] GetArray<T>(T sample, int amount)
{
    return new T[amount];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T00:59:21.363

您可以`var`在`foreach`：

```
var Employee1 = new { ID = 5, Name = "Prashant" };
var Employee2 = new { ID = 1, Name = "Tim" };
var employees = new[] { Employee1, Employee2 };

foreach (var employee in employees)
{
    Console.WriteLine("ID:{0}, Name:{1}", employee.ID, employee.Name);
}

for (int i = 0; i < employees.Length; i++)
{
    Console.WriteLine("ID:{0}, Name:{1}", employees[i].ID, employees[i].Name);
} 
```

[**演示**](http://ideone.com/rKRIzK)

# cocoa - 如何从可可自动布局中删除调整大小

> ID：14115707
> 
> 赞同：0
> 
> 时间：2013-01-02T00:45:48.390
> 
> 标签：cocoa, autolayout

我试图让 NSBox 保持它的宽度和高度，并保持在它的拆分视图部分的中心。如何使用 InterfaceBuilder 将框设置为不调整大小并仍然使用自动布局？或者，我是否必须以编程方式更新约束？

[示例文件](http://www.filedropper.com/accountsview "示例文件")

如果该框不在拆分视图中，则 jrturton 建议的“图钉”似乎有效。您可以在 Xcode 中打开 xib 并单击 Editor->Simulate Document 以查看 2 个示例。

[示例文件 - 修订版 1](http://www.filedropper.com/accountsview_1 "示例文件 - 修订版 1")

[解决方案](http://www.filedropper.com/accountsview_2 "解决方案")：我必须在包含 NSBox 的拆分视图中添加一个额外的 NSView

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T07:19:25.833

选择您的框，然后使用 Pin... 菜单：

![固定菜单](../Images/bba7140a65888f61ce366edd08276474.png)

宽度和高度选项允许您为恒定大小添加约束。您还可以在此处添加居中约束。一旦你添加了这些，你可以删除 IB 已经添加的任何其他约束，如果它没有自动为你这样做的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:43:37.887

在 IB 中，单击文件检查器（第一个图标），然后确保未选中自动布局。

[![](../Images/6ea2b71e66d654c42424e7e8d9e55831.png)](https://i.stack.imgur.com/wIcor.png)
[（来源：[fredandrandall.com](http://fredandrandall.com/blog/wp-content/uploads/2011/08/saveasautolayout.png)）]

然后转到尺寸检查器（第 5 个图标）并确保自动调整大小设置为如下。

[![](../Images/59ac38b0bcf5b4d01b31a50ab1c41d7e.png)](https://i.stack.imgur.com/oJd4l.png)
[（来源：[smallsharptools.com](http://www.smallsharptools.com/downloads/Stackoverflow/autosizing-off.png)）]

# python - Python2.7 中是否有 range(..) 函数返回生成器而不是列表？

> ID：14115708
> 
> 赞同：1
> 
> 时间：2013-01-02T00:45:49.190
> 
> 标签：python, python-3.x, python-2.7, generator

我打算编写这个函数来产生两个数字之间的所有整数，就像 python3`range`类一样。

我已经这样写了这个函数：

```
def gen_numbers(start,end):
    counter = start
    while counter <= end:
        yield counter
        counter += 1 
```

但如果任何内置函数已经存在，请告诉我使用它！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-02T00:47:18.463

是的，[xrange](http://docs.python.org/2/library/functions.html#xrange)返回一个[xrange 对象](http://docs.python.org/2/library/stdtypes.html#typesseq-xrange)。它必须是专门的发电机吗？

# ruby-on-rails - 没有路线匹配 {:action=>“show”, :controller=>“”}

> ID：14115709
> 
> 赞同：0
> 
> 时间：2013-01-02T00:46:00.280
> 
> 标签：ruby-on-rails, routes, action, runtime-error, show

我收到一个`No route matches {:action=>“show”, :controller=>“predictions”}`错误，但不明白为什么。我猜这可能与我的模型关系有关，我可能需要添加一条路线。

预测模型

```
class Prediction < ActiveRecord::Base
  attr_accessible :fixture_id, :predicted_result
  has_one :fixtures, :class_name => 'Fixture', :foreign_key => :fixture_id
  belongs_to :fixture
  belongs_to :user
end 
```

预测控制器

```
class PredictionsController < ApplicationController
  # GET /predictions
  # GET /predictions.json
  def index
    @predictions = Prediction.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @predictions }
    end
  end

  # GET /predictions/1
  # GET /predictions/1.json
  def show
    @prediction = Prediction.find(params[:id])
    @fixture = Fixture.find(params[:id])
    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @prediction }
    end
  end

  # GET /predictions/new
  # GET /predictions/new.json
  def new
    @prediction = Prediction.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @prediction }
    end
  end

  # GET /predictions/1/edit
  def edit
    @prediction = Prediction.find(params[:id])
  end

  # POST /predictions
  # POST /predictions.json
  def create
    @prediction = Prediction.new(params[:prediction])

    respond_to do |format|
      if @prediction.save
        format.html { redirect_to @prediction, notice: 'Prediction was successfully     created.' }
        format.json { render json: @prediction, status: :created, location: @prediction }
      else
        format.html { render action: "new" }
        format.json { render json: @prediction.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /predictions/1
  # PUT /predictions/1.json
  def update
    @prediction = Prediction.find(params[:id])

    respond_to do |format|
      if @prediction.update_attributes(params[:prediction])
        format.html { redirect_to @prediction, notice: 'Prediction was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @prediction.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /predictions/1
  # DELETE /predictions/1.json
  def destroy
    @prediction = Prediction.find(params[:id])
    @prediction.destroy

    respond_to do |format|
      format.html { redirect_to predictions_url }
      format.json { head :no_content }
    end
  end
end 
```

显示视图

```
<p id="notice"><%= notice %></p>

<p>
  <b>Fixture:</b>
  <%= @prediction.fixture_id %>
</p>

<p>
  <b>Predicted result:</b>
  <%= @prediction.predicted_result %>
</p>

<%= link_to 'Edit', edit_prediction_path(@prediction) %> |
<%= link_to 'Back', predictions_path %>

>rake routes
      users_new GET    /users/new(.:format)            users#new
    predictions GET    /predictions(.:format)          predictions#index
                POST   /predictions(.:format)          predictions#create
 new_prediction GET    /predictions/new(.:format)      predictions#new
edit_prediction GET    /predictions/:id/edit(.:format) predictions#edit
     prediction GET    /predictions/:id(.:format)      predictions#show
                PUT    /predictions/:id(.:format)      predictions#update
                DELETE /predictions/:id(.:format)      predictions#destroy
       fixtures GET    /fixtures(.:format)             fixtures#index
                POST   /fixtures(.:format)             fixtures#create
    new_fixture GET    /fixtures/new(.:format)         fixtures#new
   edit_fixture GET    /fixtures/:id/edit(.:format)    fixtures#edit
        fixture GET    /fixtures/:id(.:format)         fixtures#show
                PUT    /fixtures/:id(.:format)         fixtures#update
                DELETE /fixtures/:id(.:format)         fixtures#destroy
          teams GET    /teams(.:format)                teams#index
                POST   /teams(.:format)                teams#create
       new_team GET    /teams/new(.:format)            teams#new
      edit_team GET    /teams/:id/edit(.:format)       teams#edit
           team GET    /teams/:id(.:format)            teams#show
                PUT    /teams/:id(.:format)            teams#update
                DELETE /teams/:id(.:format)            teams#destroy
          users GET    /users(.:format)                users#index
                POST   /users(.:format)                users#create
       new_user GET    /users/new(.:format)            users#new
      edit_user GET    /users/:id/edit(.:format)       users#edit
           user GET    /users/:id(.:format)            users#show
                PUT    /users/:id(.:format)            users#update
                DELETE /users/:id(.:format)            users#destroy
           root        /                               fixtures#index 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T00:54:51.133

路线 ( `config/routes.rb`) 可能应包括：

```
resources :users
resources :predictions
resources :fixtures 
```

在命令行（从应用程序的根目录）键入`rake routes`以查看您拥有的路由。

最初，更改：

```
def show
    @prediction = Prediction.find(params[:id])
    @fixture = Fixture.find(params[:id])  
    # Note: for fixture, the id would be different, prob fixture_id 
```

至

```
def show
    @prediction = Prediction.find(params[:id]) 
```

即移除夹具。您始终可以使用关系在视图中显示它，即`@prediction.fixture_id`或`@prediction.fixture.name`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T02:01:32.783

不确定这是否会导致错误，但在您的模型文件中

```
has_one :fixtures, :class_name => 'Fixture', :foreign_key => :fixture_id 
```

应该只是：

```
has_one :fixture 
```

总是一个很好的提示：has_one = 单数，has_many = 复数

# prolog - 递归谓词中的回溯

> ID：14115722
> 
> 赞同：9
> 
> 时间：2013-01-02T00:48:22.730
> 
> 标签：prolog, failure-slice

假设我们有以下谓词（这是[Prolog](http://www.springer.com/computer/swe/book/978-3-540-00678-7)中的一个示例）：

```
[F0] isInteger(0).
[F1] isInteger(X):- isInteger(Y), X is Y+1. 
```

1.  查询的第一个结果是Integer(R)，标记放在F0，会返回R=0

2.  如果用户按下；，标记放置在F1，我们移动到子目标（isInteger（Y），满足F0）和R = 1。

我明白以上。现在这是我的问题：

1.  如果用户按下；再次，标记在哪里？搜索如何继续返回 R=2？我试图理解这本书第 78-79 页中的图像，但我不清楚。我发现的在线教程在递归的情况下不处理回溯。

我正在寻找任何解释存在递归的回溯的教程，希望有帮助我理解的堆栈内容图像。

提前谢谢苏珊娜

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-02T01:45:28.403

通过使用图像来理解回溯和递归适用于非常小的示例，但它不适用于更大的程序。此外，通过单步执行程序，您很容易错过最有趣的属性。幸运的是，还有比这更好的概念。让我们以你的例子为例`isInteger/1`。

## 一套解决方案/答案

你的主要兴趣是确保你描述的是正确的事情。在这里，第二条规则是最有趣的。按箭头方向阅读`:-`。即从右到左：提供`Y`的是整数，`X is Y+1`然后也是`X`整数。

然后，您可以估计在这种情况下无限的解决方案集。

## 终端属性

下一个问题涉及谓词的终止属性。请注意，如果它必须产生无限多的答案，它就不能——事实上**绝不能——终止。**另一方面，像地面查询这样`isInteger(1)`的问题要么有一个解决方案，要么没有解决方案。因此，对于这种情况，谓词终止是可取的。但是，您的定义不会在这里终止！

## 失败切片

为了更好地理解这一点，我将使用[failure-slice](https://stackoverflow.com/questions/tagged/failure-slice)。也就是说，我会将目标插入**`false`**到您的程序中。如果生成的程序片段没有终止，那么原始程序片段不会。

```
?- isInteger(1), false

isInteger(0) :-**假**。
是整数（X）： -
   isInteger(Y), false ,
    X 是 Y+1。

```

只有极少部分负责不终止！剩下的部分根本不看值`X`。*因此，您的程序永远不会*终止。不管你怎么称呼它。

有关更多示例，请参见[故障切片](/questions/tagged/failure-slice "显示标记为“故障切片”的问题")。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-01T00:23:32.980

在[swish](http://swish.swi-prolog.org/)控制台中跟踪它：

```
% Handover to indenting predicate

isInteger(X) :- isInteger(X,0).

% As isInteger(), with printouts

isInteger(0,I) :- ws(I), format('0 reached\n').
isInteger(X,I) :- wrout('>', X,Y,I), ID is I+1, isInteger(Y,ID), wrout('<', X,Y,I), X is Y+1, wsucc(I).

% Writing out

wrout(C,X,Y,I) :-ws(I),format('~a X=',C),write(X),format(',Y='),write(Y),format('\n').

% Writing "success"

wsucc(I) :- ws(I),format('success\n').

% Indenting by 2*N underscores

ws(0).
ws(N) :- N>0, format('__'), ND is N-1, ws(ND). 
```

通过检查 2 是否为整数`? - isInteger(2).`（但不要为此调用 Next，否则将发生永无止境的搜索！）

```
> X=2,Y=_G5707
__0 reached
< X=2,Y=0
__> X=_G5707,Y=_G6473
____0 reached
__< X=_G5707,Y=0
__success
< X=2,Y=1
success
true 
```

使用枚举整数`?- isInteger(I)`

```
0 reached
I = 0 
```

“下一个”

```
> X=_G5328,Y=_G5926
__0 reached
< X=_G5328,Y=0
success
I = 1 
```

“下一步”（注意我们在缩进 '__' 处重新开始）

```
__> X=_G5926,Y=_G391
____0 reached
__< X=_G289,Y=0
__success
< X=_G257,Y=1
success
I = 2 
```

“下一步”（注意我们在缩进 '____' 处重新开始）

```
____> X=_G391,Y=_G3260
______0 reached
____< X=_G391,Y=0
____success
__< X=_G289,Y=1
__success
< X=_G257,Y=2
success
I = 3 
```

非常好。

我将向当地团队解释这一点。这是一个带有一些“原始符号”的整数枚举过程的说明。希望不言自明。

![整数枚举回溯图](../Images/9ed187d00e070d6dfcd16c8e1ad7e7ce.png)

# php - PHP 显示营业时间

> ID：14115724
> 
> 赞同：4
> 
> 时间：2013-01-02T00:48:36.443
> 
> 标签：php

我试图在基于 Wordpress 的网站上打开业务并从数据库中提取信息时显示通知。数据被简单地存储为每天的开/关时间，作为单独的数据库条目。当时间在一天之内时，这是相当直截了当的。但是对于酒吧/餐厅，它变得复杂，因为从技术上讲，关闭时间是在第二天。我将以星期二为例。

```
$tuesdayopen = strtotime("10:00");
$tuesdayclose = strtotime("23:00");
$now = strtotime("now");

if ($now >= $tuesdayopen && $now <= $tuesdayclose) {
    echo "We are open!";
} else {
    echo "We are closed!";
} 
```

所以这可以正常工作。如果关门时间到第二天，我也有一个不雅的解决方案。

```
$tuesdayopen = strtotime("10:00");
$tuesdayclose = strtotime("02:00");
$now = strtotime("now");

if ($tuesdayclose >= strtotime("00:00") && $tuesdayclose <= strtotime("04:00")):
    $tuesdayclose = strtotime("+1 day", $tuesdayclose);
endif;

if ($now >= $tuesdayopen && $now <= $tuesdayclose) {
    echo "We are open!";
} else {
    echo "We are closed!";
} 
```

那么我的问题在哪里？问题是当 $now 在午夜之后结束时。因此，如果有人在周二晚上午夜之后访问该页面，从技术上讲，它是周三早上。这意味着我的完整剧本将移至周三。我需要它来识别它是在午夜和凌晨 4 点之间，因此，使用前几天的开放/关闭时间来确定它是否开放（但前提是关闭时间是在午夜之后，否则转到星期三是正确的去做）。希望我解释得很好。我试过自己写一些东西，但代码是一团糟，最终不起作用。所以我不会费心把它包括在这里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T01:41:41.043

我会创建一个数组，其中包含该位置打开的时间并循环遍历该数组。另一个优点是，例如，如果某个地方在午餐期间关闭，则很容易添加。

请注意，我将时间标准化为从星期一 00:00 开始计算秒数，无论时间是未来还是过去。

```
<?php

// Normalize time to count from 0
function timeOfWeek($time) {
  if (!is_int($time)) $time = strtotime($time) ;
  $secondsInWeek = (7 * 24 * 3600);
  return (($time - strtotime('monday 00:00')) % $secondsInWeek + $secondsInWeek) % $secondsInWeek;
}

function isOpen($opened, $time) {
  $time = timeOfWeek($time);

  foreach ($opened as $openday) {
    list($open, $close) = $openday;

    if ($open < $close) { 
      if ($time > $open && $time < $close) return true;
    } else {
      if ($time > $open || $time < $close) return true; // Special case sunday -> monday
    }
  }

  return false;
}

$opened = array();
$opened[] = array(timeOfWeek('monday 10:00'), timeOfWeek('monday 23:00'));
$opened[] = array(timeOfWeek('tuesday 10:00'), timeOfWeek('tuesday 23:00'));
$opened[] = array(timeOfWeek('wednesday 10:00'), timeOfWeek('wednesday 23:00'));
$opened[] = array(timeOfWeek('thursday 10:00'), timeOfWeek('thursday 23:00'));
$opened[] = array(timeOfWeek('friday 10:00'), timeOfWeek('saturday 01:00'));
$opened[] = array(timeOfWeek('saturday 10:00'), timeOfWeek('sunday 01:00'));
$opened[] = array(timeOfWeek('sunday 10:00'), timeOfWeek('monday 01:00'));

$open = isOpen($opened, time());
var_dump($open); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-02T01:14:05.287

只需将时区转换为 yourTimeZone-4h！

# excel - excel公式：结束日期减去今天的日期加上延期天数

> ID：14115728
> 
> 赞同：-1
> 
> 时间：2013-01-02T00:48:59.033
> 
> 标签：excel, excel-formula

我需要一个 excel 公式来计算单元格剩余的总天数：结束日期减去今天的日期加上扩展天数（单元格中可能有 30-90 的数量）我已经尝试过 =days360（今天的日期，结束日期 + 扩展天数）在不同的单元格中，但它没有给我正确的总数

它给了我错误的天数。我也有一个计算我的结束日期的公式，这是否会导致问题（=SUM（开始日期+90+#of exyension days））

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T00:51:55.323

它比这更容易：

```
=end date - todays date + number of extension days 
```

Excel 中的日期只是数字（其中整数是天，小数部分是时间），因此您可以使用它们进行简单的数学运算。

如果您想摆脱时间，请使用：

```
= ROUNDDOWN(end date, 0) - ROUNDDOWN(TODAY(), 0) + number of extension days 
```

# javascript - 如何使用three.js 执行拾取和隐藏对象？

> ID：14115733
> 
> 赞同：3
> 
> 时间：2013-01-02T00:50:47.280
> 
> 标签：javascript, three.js

**显示隐藏：**

我一直在使用 Three.js Release 50 并且能够在以下帮助下显示/隐藏对象（在我的应用程序中，它是一个网格子对象）：

```
THREE.SceneUtils.traverseHierarchy(mesh,function(child){
    var z = document.getElementById("cameras").selectedIndex*5 -10;
    if (z === -10){
        child.visible = true;
    } else if (child.position.z !== z){
        child.visible = false;
    } else {

        child.visible = true;
    };
}); 
```

但是在使用release 54时，据说要使用，object.traverse却发现很难一样。如何使用版本 54 替换上述代码？我在使用 54 版时遇到的错误是：

![在此处输入图像描述](../Images/93254103b6aac51dbab25902dd3e98a4.png)

**采摘：**

我找到了一个非常著名且复杂的示例，用于在 Three.js 中进行 Picking，它基于“Ray Picking”及其链接：[Three.js Picking Example](http://mrdoob.github.com/three.js/examples/webgl_interactive_cubes.html)。基于这个例子，我一直在尝试在我的应用程序中实现拾取。但不知何故，这条线出现了错误。

```
var raycaster = new THREE.Raycaster( camera.position, vector.subSelf( camera.position                   
).normalize() ); 
```

**我在自定义javascript 对象**[数据结构] 中管理了锥体 [我的几何体] 的父子关系，使得（Layer1 {用于对象内每个层的数组} 有 100 个锥体，并且都是父级，第 2 层有 100 个锥体，它们是 layer1 [multiplicity 1:1]] 上的锥体，第 3 层有锥体，它们是 layer 2 上的锥体的孩子，它们的关系也是 1:1，因此它们也是 layer1 锥体的孙子）。

我使用网格从第一层添加祖锥，并通过该父级访问 layer2 中的子级，并将其添加到相同的网格和通过子级访问的孙子级，并添加到相同的网格中。最后，我将整个 Mesh 添加到场景中。由于“z-depth”变化[对于第一层，z-坐标：5，对于 layer2：0 和 layer 3：-5]，layer1 和 layer2 和 layer3 字面上形成三层，如下图所示。

![在此处输入图像描述](../Images/8d0cee1b56f429bbda3716a05b2f3332.png)

但是在使用下面的代码时，我看不到我的锥体上有任何采摘。

```
var vector = new THREE.Vector3( mouse.x, mouse.y, 1 );
            projector.unprojectVector( vector, camera );

            var raycaster = new THREE.Raycaster( camera.position, vector.subSelf( camera.position ).normalize() );

            var intersects = raycaster.intersectObjects( scene.children ); // tried with mesh.children as well, but no change :(

            if ( intersects.length > 0 ) {

                if ( INTERSECTED != intersects[ 0 ].object ) {

                    if ( INTERSECTED ) INTERSECTED.material.emissive.setHex( INTERSECTED.currentHex );

                    INTERSECTED = intersects[ 0 ].object;
                    INTERSECTED.currentHex = INTERSECTED.material.emissive.getHex();
                    INTERSECTED.material.emissive.setHex( 0xff0000 );

                }

            } else {

                if ( INTERSECTED ) INTERSECTED.material.emissive.setHex( INTERSECTED.currentHex );

                INTERSECTED = null;

            } 
```

我希望我的特定锥体在光线相交时被拾取，同时基于特定锥体是否是祖父母/父母/孩子的特定家族的剩余锥体也被拾取。我为我的自定义数据结构提供了帮助函数，它通过输入祖父母（祖父母 <- 父母）返回父母，并通过输入父母来返回孩子，您可以利用它来帮助我挑选。

我有一个 JSfiddle 链接，它使用 Three.js release 54 和 CombinedCamera.js 作为附加资源，请有人帮我解决这个问题。我非常需要帮助。

这是我的 Jsfiddle 链接：http: [//jsfiddle.net/sagh0900/SQyLL/](http://jsfiddle.net/sagh0900/SQyLL/)

在实施 Picking 和使用 Three.js 版本 54 之前，我以前的**工作**Jsfiddle 版本。在这个版本中，我使用了 three.js 的第 50 版，我能够成功地显示/隐藏对象：[http://jsfiddle。净/sagh0900/PrVbg/3/](http://jsfiddle.net/sagh0900/PrVbg/3/)

提前感谢您的帮助和支持:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T00:46:23.657

正如 WestLangley 所提到的，每个帖子一个明确的问题将有助于我们更好地回答您。

对于使用 Raycaster 在 Three.js 中挑选的一个不太复杂的示例，我在以下位置发布了一个示例：

[http://stemkoski.github.com/Three.js/Mouse-Tooltip.html](http://stemkoski.github.com/Three.js/Mouse-Tooltip.html)

它根据从鼠标位置发出的光线改变场景中对象的属性（颜色）。也许这段代码可以适应你的部分困难。

# c# - 方法“选择”没有重载需要 1 个参数

> ID：14115741
> 
> 赞同：-1
> 
> 时间：2013-01-02T00:52:35.970
> 
> 标签：c#, .net, overloading

我对 C# 非常陌生，我正在尝试编译一个应用程序，但我收到了以下错误消息：

> 方法 'Select' 没有重载需要 1 个参数。

这是我面临的一段代码：

```
 #region Tree events
    private void treeDims_KeyDown(object sender, System.Windows.Forms.KeyEventArgs e)
    {
        if ((System.Windows.Forms.Control.ModifierKeys & Keys.Control) == Keys.Control)
        {// handle CTRL + A
            if (e.KeyValue == (int)System.Windows.Forms.Keys.A)
            {
                e.Handled = true;
                foreach (CDNM.Controls.Node n in this.treeDims.Nodes)
                {
                    n.Select(false);
                }
            }
        }
    }

    private void treeCubes_KeyDown(object sender, System.Windows.Forms.KeyEventArgs e)
    {
        if ((System.Windows.Forms.Control.ModifierKeys & Keys.Control) == Keys.Control)
        {// handle CTRL + A
            if (e.KeyValue == (int)System.Windows.Forms.Keys.A)
            {
                e.Handled = true;
                foreach (CDNM.Controls.Node n in this.treeCubes.Nodes)
                {
                    n.Select(false);
                }
            }
        }
    } 
```

VS2010 突出显示`n.Select(false)`.

我知道这应该是基本的，但由于我是新手，我不知道如何解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:25:26.737

我假设您正在使用的控件上的 select 方法不接受布尔参数，而是一种命令式方法，它只会导致选择相关节点。您要做的是将状态从“选定”更改为“未选定”。

我没有使用您正在使用的控件库，但我敢打赌有一个类似于`System.Web.UI.WebControls.Treenode`控件的布尔属性设置，它有一个`TreeNode.Select()`没有参数的方法和一个布尔属性 getter/setter `TreeNode.Select`。

试试这个：

```
foreach (CDNM.Controls.Node n in this.treeDims.Nodes)
{
    n.Selected = false;
} 
```

当然，我可能是错的。. .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:58:27.660

我不认识您正在使用的控件，但有三种基本方法可以解决此类问题：

1.  双击代码中的 Select 并按 F1。如果控制供应商正确地完成了他们的工作，您将被带到该方法的帮助信息。

2.  右键单击选择并从弹出菜单中选择转到定义。这应该带您进入可用重载列表。如果没有，则右键单击节点并执行相同操作。这将显示可用于 Node.js 的属性和方法的列表。

3.  浏览供应商的文档。如果此控制是在内部进行的，并且没有帮助文档，请咨询负责控制的团队。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T00:59:44.267

这意味着您在代码中的某处有一个方法调用或构造函数，该方法调用或构造函数有一个不应有的参数，或者缺少它需要的参数。

注意：对于“C# 新手”来说，该代码块似乎有点复杂。

# c++ - decltype（（c））中括号的意义？

> ID：14115744
> 
> 赞同：42
> 
> 时间：2013-01-02T00:54:25.747
> 
> 标签：c++, c++11, decltype

我正在阅读[Wikipedia 上关于`C++11` *Type Inference* feature](http://en.wikipedia.org/wiki/C++11#Type_inference)的这篇文章。

有一个例子，我引用：

```
#include <vector>
int main() {  
    const std::vector<int> v(1);  
    auto a = v[0];        // a has type int  
    decltype(v[1]) b = 1; // b has type const int&, the return type of  
                          //   std::vector<int>::operator[](size_type) const  
    auto c = 0;           // c has type int  
    auto d = c;           // d has type int  
    decltype(c) e;        // e has type int, the type of the entity named by c  
    decltype((c)) f = c;  // f has type int&, because (c) is an lvalue  
    decltype(0) g;        // g has type int, because 0 is an rvalue  
} 
```

在以下几行中：

```
 decltype(c) e;        // e has type int, the type of the entity named by c  
    decltype((c)) f = c;  // f has type int&, because (c) is an lvalue 
```

`c`和有什么区别`(c)`？为什么`(c)`表示*左值*？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-02T00:57:16.253

*   `c`是变量的名称；

*   `(c)`是一个表达式，在这种情况下是一个*左值*表达式，其值与变量的值相同`c`。

并且两者区别对待`decltype`。例如，考虑 ，`decltype(1+2)`这也是采用*表达式*的示例。碰巧您的示例是一个*简单*版本的表达式：它仅命名一个变量并且没有任何令人兴奋的内容。

如果您对语言规范的细微部分进行合理化，那么您通常只会真正关心这些差异之一。但是，正如您所指出的，它在这种情况下具有相当重要的实际效果。

请注意，这里没有使用*运算符*。这一切都只是对语法布局的推论。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-02T23:06:26.247

[我在这里](http://en.wikipedia.org/wiki/Decltype#Semantics)找到了一个很好的描述。它描述了以下之间的区别：

```
struct A { double x; };
const A* a = new A();
...
decltype(a->x) x4; // type is double
decltype((a->x)) x5; // type is const double& 
```

我引用：

> 后两种 decltype 调用之间存在差异的原因是括号中的表达式`(a->x)`既不是 id 表达式也不是成员访问表达式，因此不表示命名对象。[ [13](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2938.html) ]
> 
> 因为表达式是一个左值，所以它的推导类型是“对表达式类型的引用”，或者`const double&`。[ [10](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2343.pdf) ]

# tinymce - TinyMCE 增加字体系列下拉字体大小

> ID：14115747
> 
> 赞同：3
> 
> 时间：2013-01-02T00:54:42.453
> 
> 标签：tinymce

有谁知道如何增加 TinyMCE 中“字体系列下拉”列表项的字体大小？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T11:31:47.123

您将需要创建一个自己的 css 文件并使用 tinymce 配置参数

```
content_css : your_css_file.css, 
```

您的 css 文件必须包含以下内容。您可以在此处调整字体大小

```
.mceMenu span.mceText,.mceMenu .mcePreview {
    font-size: 11px;
} 
```

# php - 从开始到字节数的 readfile 或 fpassthru

> ID：14115752
> 
> 赞同：0
> 
> 时间：2013-01-02T00:55:35.587
> 
> 标签：php, readfile

因此`readfile`/`fpassthru`非常适合有效地发送完整文件 ( `readfile`) 或从特定搜索位置到 FEOF ( `fpassthru`) 的文件。

`fread`如果我想流式传输任意位置或从文件的开头到任意位置，除了可以使用的任何其他效率方法吗？（即。`fpassthru($fp, begin, end)`）

# javascript - 如何使用 Web 输入表单将文本插入文件？

> ID：14115757
> 
> 赞同：0
> 
> 时间：2013-01-02T00:56:52.197
> 
> 标签：javascript

我有一个需要定期更新的简单文本文件。我想要一个网络输入表单，而不是剪切和粘贴新数据，我可以在其中输入新信息，它会更新文本文件。例如，我可能会输入一个新的“标题”或“URL”，并且我希望将该字符串插入到文件中的正确位置。

对我来说最简单的方法是什么？该文件不必保存，我可以在生成新文本后复制并粘贴文本文件。

## 例如，我想要更新的文本如下所示：

[标题]

## 上面这句话是标题，这是 [URL]

将有 2 个网络输入表单。1 表示标题，1 表示 URL。当我在输入中输入文本时，javascript 会将其插入到 textarea 中的正确位置。然后我可以将该文本复制并粘贴到我需要的任何内容中。这是一个非常简单的脚本，我只是不知道如何构建它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:09:28.500

Web 浏览器脚本无法访问文件系统。

# java - 第 n 个元素数组的控制台输出

> ID：14115758
> 
> 赞同：0
> 
> 时间：2013-01-02T00:56:54.277
> 
> 标签：java, arrays

我有一个包含 n 个元素的数组，我正在尝试将值设置为我的数组，以便每个元素的值都为 Positon。

即位置 0 的第一个元素为 0，第二个元素位于位置 1 到 1，依此类推，直到位置 n-1 处的第 n 个元素，其值为 n-1。

最后我将在控制台上给出我的数组的内容。

好吧，我认为我已经设置了正确的值，但是我无法在控制台上显示。例如，我如何显示位置“n-1”的值为“n-1”？

这是我到目前为止所做的：

```
 public void exercise1(Integer n){

   int[] arrayA = new int[n];

   int counter;

    for(counter=0; counter<arrayA.length; counter++){

              arrayA[counter]=counter;
                         }
    } 
```

提前致谢：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:03:44.390

使用 System.out.println 和这段代码：

```
System.out.println(Arrays.    toString(your_array_name_here)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T15:24:15.913

```
 public class apples{

public static void main(String[] args) {

    exercise(4);

}

   public void exercise(Integer n){

    int[] arrayA = new int[n];

    int counter;

    for(counter=0; counter<arrayA.length; counter++){

        arrayA[counter]=counter;
    }

    System.out.print("[");

    for(counter=0; counter<arrayA.length; counter++){

        if(counter == n-1){

         System.out.print(arrayA[counter]);   

        }else{

          System.out.print(arrayA[counter] + ", ");

       }
    } 
    System.out.println("]");

} 
```

}

好吧，伙计们，在您的建议之后，我做了类似的事情并且有效。非常感谢：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T06:15:42.850

我认为 Hélio Santos 说的是真的，而且对我有用：

`public class koponk {`

 ````
public static void main(String[] args) {
    exercise1(10);
}

public static void exercise1(Integer n) {
    int[] arrayA = new int[n];
    int counter;
    for (counter = 0; counter < arrayA.length; counter++) {
        arrayA[counter] = counter;
        System.out.print(arrayA[counter] + " ");
    }
} 
```` 

`}`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T01:04:06.610

将此添加到您的循环中

```
System.out.println(arrayA[counter]); 
```

# java - 警报对话框中的图标应该是什么大小？

> ID：14115759
> 
> 赞同：11
> 
> 时间：2013-01-02T00:57:06.163
> 
> 标签：java, android, icons, android-alertdialog

我正在尝试将图标分配给警报对话框，但不断出现内存错误（似乎来自图标的大小）。

警报对话框的图标应该是什么大小？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-02T01:09:59.980

32x32 在 mdpi。见[这里](http://developer.android.com/guide/practices/ui_guidelines/icon_design_dialog.html)。很容易谷歌。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-28T16:37:54.373

大多数 Internet 结果会告诉您 HDPI 是您需要的最大图标。这是错误的。

刚刚作为当前项目的一部分进行了测试，这就是为您带来最佳结果的原因：

LDPI 24px
MDPI
32px HDPI 48px
XHDPI 64px
XXHDPI 96px
XXXHDPI 128px

# php - 如何将字符串转换为查询的特定排序规则

> ID：14115760
> 
> 赞同：0
> 
> 时间：2013-01-02T00:57:08.050
> 
> 标签：php, mysqli, collation

我正在使用 php 和 mysqli 创建一个简单的 Web 项目。
我也在使用准备好的语句。
在要绑定的变量处，输入是希腊语。

因此，当通过我的 php 应用程序运行查询时，我得到了这个：

> 您的输入是“greek_characters_here”
> 查询错误：排序规则（greek_general_ci，IMPLICIT）和（latin1_swedish_ci，COERCIBLE）的非法混合操作'='

我能做些什么来绕过这个问题？

**注意：**我无法更改数据库排序，因为我没有权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:07:01.167

如果您无法更改表并设置排序规则，您可以尝试使用 BINARY 运算符，它只是 COLLATE 的简写版本，您的语句如下所示：

```
SELECT * FROM table WHERE BINARY a = BINARY b; 
```

# c# - 检查线程中的计时器是否已过

> ID：14115761
> 
> 赞同：0
> 
> 时间：2013-01-02T00:57:12.500
> 
> 标签：c#, .net, events, timer

我的 .NET 后台工作程序中运行了一个 while 循环。我想在 Timers.Timer 达到 0 时结束循环。

问题是，由于我在另一个线程（后台工作人员）中工作，我的计时器必须在同一个线程中实例化。所以我不能设置任何私有布尔timer_Elapsed。我也不知道如何提供布尔 thro 事件的参考。

**代码示例：**

```
private bool timer_Elapsed = false;

    private void backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
    {
        System.Timers.Timer timer = new System.Timers.Timer();
        Set_Timer(timer);

        timer.Start();

        while(timer_Elapsed) //Has to be a boolean that indicates if timer elapsed
        {
            this.Do_Proces();
        }
    }

    private void Set_Timer(System.Timers.Timer timer)
    {
        timer.Interval = 200;
        timer.Elapsed += new ElapsedEventHandler(timer_ElapsedEvent);
    }

    private void timer_ElapsedEvent(object source, ElapsedEventArgs e)
    {
        timer_Elapsed = true; //I can't set my private boolean since it got instantiated in another thread
    } 
```

代码中的特殊问题。我是这种东西的新手。有什么建议么？提前致谢

**编辑：**澄清一下，我希望 Do_Proces() 运行 200 毫秒，当那个时间过去时，我希望它停止。当它在 200 毫秒后停止时，我想用 backgroundWorker 中生成的数据更新 GUI。然后检查用户是否希望进程停止，如果不是，我希望它再次运行。我使用计时器，因为线程必须重新启动很多，这也会影响主线程，影响用户体验不好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T01:02:28.573

除了此处列出的以外，计时器是否还有其他用途？如果没有，您可能只想在 BackgroundWorker 方法的开头记录当前时间，并更改 while 循环上的条件以检查所需的时间是否已过。

```
private void backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
{
    TimeSpan timeout = TimeSpan.FromMinutes(5);
    DateTime start_time = DateTime.Now;

    while(DateTime.Now - start_time < timeout)
    {
        this.Do_Proces();
    }
} 
```

# markdown - markdown/octopress 中的 {{ 和 }} 出现问题

> ID：14115764
> 
> 赞同：0
> 
> 时间：2013-01-02T00:57:27.970
> 
> 标签：markdown, octopress

我在使用降价`{{`时遇到了麻烦。`}}`我试图进入我的 Octopress 博客的代码如下所示：

```
<ul id="books">
  <template iterate="book in books">
    <x-book-item book="{{ book }}"></x-book-item>
  </template>
</ul> 
```

除非，当它被渲染时，带有 的行`{{ }}`变为：

```
<x-book-item book=""></x-book-item> 
```

如果我将代码更改为此：

```
<x-book-item book="\{\{ book \}\}"></x-book-item> 
```

它呈现为

```
<x-book-item book="\{\{ book \}\}"></x-book-item> 
```

即，它包括`\`and `{`。

有什么想法我应该做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T18:15:32.753

终于想通了。我需要在`raw`这里使用标签，这可以很好地处理事情。

```
{% raw %}<x-book-item book="{{ book }}"></x-book-item>{% endraw %} 
```

在网页上产生这个：

```
<x-book-item book="{{ book }}"></x-book-item> 
```

# python - “或”条件导致“如果”出现问题

> ID：14115765
> 
> 赞同：3
> 
> 时间：2013-01-02T00:57:49.967
> 
> 标签：python, if-statement

我`or`在函数中遇到问题。无论值是什么，该`if`语句都会持续评估。当我删除 时，工作正常。`True``choice``or``if`

```
def chooseDim ():
    **choice = input ('Do you need to find radius or area? ')
    if choice == 'A' or 'a':**
        area = 0
        area = int(area)
        areaSol ()

    elif choice == 'R' or 'r':

        radSol ()

    else:
        print ('Please enter either A/a or R/r.')
        chooseDim () 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T01:00:51.903

'a' 的计算结果为 True，因此您需要正确构建 if 语句。

```
def chooseDim ( ):
**choice = input ('Do you need to find radius or area? ')
if choice == 'A' or choice == 'a':**
    area = 0
    area = int(area)
    areaSol ( )

elif choice == 'R' or choice == 'r':

    radSol ( )

else:
    print ('Please enter either A/a or R/r.')
    chooseDim ( ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-02T01:07:29.280

关于它自己的答案`or`是正确的。您实际上是在问是否`"a"`为真，它总是如此。但是还有另一种方法：

```
if choice in 'Aa': 
```

再说一次，没有错：

```
if choice.lower() == 'a': 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T01:06:53.410

`in`在这种情况下使用运算符会更容易：

```
if choice in ['A', 'a']: ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T00:59:44.773

```
if choice == 'A' or choice =='a': 
```

# php - 为什么 cURL 请求会返回国际页面（例如 Google 搜索）？

> ID：14115767
> 
> 赞同：1
> 
> 时间：2013-01-02T00:58:30.497
> 
> 标签：php, curl

我正在尝试执行一个 cURL 请求（直接来自 shell 或通过 PHP），它将返回与通过浏览器发出的请求基本相同的 URL 内容（减去任何 cookie/登录等）。

*对www.google.com*的基本 cURL 请求将返回似乎是带有一些字符编码问题的日文版 Google 搜索。

使用包括设置标准用户代理和关注位置在内的选项进行测试仍然不会导致我认为对我的浏览器非常相似的请求。我应该使用一组标志来密切模仿浏览器请求吗？

下面的代码目前用于测试，但即使存储了 cookie，Google 仍假定位置是日本 (google.co.jp)。

```
$header = array(
        "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
        "Accept-Language: en-us,en;q=0.5",
        "Connection: keep-alive",
        "Cache-Control: no-cache",
        "Content-Type: application/x-www-form-urlencoded; charset=UTF-8",
        "Pragma: no-cache",
    );
$useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)';

$ch = curl_init();
curl_setopt($ch, CURLOPT_VERBOSE, 0);
curl_setopt($ch, CURLOPT_URL, $request);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_COOKIEJAR, "my_cookies.txt");
curl_setopt($ch, CURLOPT_COOKIEFILE, "my_cookies.txt");
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_AUTOREFERER, true);
curl_setopt($ch, CURLOPT_TIMEOUT, 10);
$data = curl_exec($ch);
curl_close($ch); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:23:08.937

```
$header = array(
        "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
        "Accept-Language: en-us,en;q=0.5",
        "Connection: keep-alive",
        "Cache-Control: no-cache",
        "Content-Type: application/x-www-form-urlencoded; charset=UTF-8",
        "Pragma: no-cache",
    );
$useragent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)';

$ch = curl_init();
curl_setopt($ch, CURLOPT_VERBOSE, 0);
curl_setopt($ch, CURLOPT_URL, $request);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_COOKIEJAR, "my_cookies.txt");
curl_setopt($ch, CURLOPT_COOKIEFILE, "my_cookies.txt");
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_AUTOREFERER, true);
curl_setopt($ch, CURLOPT_TIMEOUT, 10);
curl_setopt($ch, CURLOPT_PROXY, 'PROXY_IP_HERE:PROXY_PORT'); // Use a proxy located in USA
$data = curl_exec($ch);
curl_close($ch); 
```

# c# - 从另一个正在运行的应用程序读取输出

> ID：14115768
> 
> 赞同：7
> 
> 时间：2013-01-02T00:58:38.767
> 
> 标签：c#, winforms, command, output

我正在使用 C# 编写用于脚本语言的自定义 IDE，但我遇到了问题。

我正在尝试启动编译器进程（pawncc.exe）并将参数传递给它。我已经这样做了，现在我遇到了问题。当我想显示编译器应用程序的输出时，它只显示其中的一部分。它应该输出这个（**从命令提示符得到这个**）：

```
Pawn compiler 3.2.3664                  Copyright (c) 1997-2006, ITB CompuPhase

newGM.pwn(0) : fatal error 100: cannot read from file: "includes/main_include.inc"

Compilation aborted.
1 Error. 
```

但事实并非如此。它输出这个（**在应用程序中，使用相同的命令/参数**）：

```
Pawn compiler 3.2.3664          Copyright (c) 1997-2006, ITB CompuPhase

1 Error. 
```

我就是不明白！这真是一件很奇怪的事情。这可能很简单，但我一直在研究它，并且研究了几个小时！这是我的代码：

```
 public Form3(string path)
        {
            InitializeComponent();

            this._path = path;

            Process myProcess = new Process();
            ProcessStartInfo startInfo = new ProcessStartInfo("pawncc.exe");
            startInfo.CreateNoWindow = true;
            startInfo.UseShellExecute = false;
            startInfo.RedirectStandardOutput = true;
            startInfo.Arguments = path + " -r -d2";
            myProcess.StartInfo = startInfo;
            myProcess.Start();

            while (true)
            {
                string myString;
                byte[] buffer = new byte[512];
                var ar = myProcess.StandardOutput.BaseStream.BeginRead(buffer, 0, 512, null, null);
                ar.AsyncWaitHandle.WaitOne();
                var bytesRead = myProcess.StandardOutput.BaseStream.EndRead(ar);
                if (bytesRead > 0)
                {
                    myString = Encoding.ASCII.GetString(buffer, 0, bytesRead);
                }
                else
                {
                    myProcess.WaitForExit();
                    break;
                }
                richTextBox1.Text = myString;

            }

        } 
```

**！！编辑：**

它对这段代码做同样的事情：

```
 public Form3(string path)
        {
            InitializeComponent();

            this._path = path;

            Process myProcess = new Process();
            ProcessStartInfo startInfo = new ProcessStartInfo("pawncc.exe");
            startInfo.CreateNoWindow = true;
            startInfo.UseShellExecute = false;
            startInfo.RedirectStandardOutput = true;
            startInfo.RedirectStandardError = true;
            startInfo.Arguments = path + " -r -d2";
            myProcess.StartInfo = startInfo;
            myProcess.Start();

            using (StreamReader reader = myProcess.StandardOutput)
            {
                string result = reader.ReadToEnd();
                richTextBox1.Text = result;
            }
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T01:01:38.987

您还需要重定向标准错误流：

```
startInfo.RedirectStandardError = true; 
```

编辑：我刚刚查看了代码，发现您只是只读的 StandardOutput 流。

我通常使用流程上的 DataReceived 事件监控标准和错误输出流的流程，并将结果添加到 stringbuilder 中，然后将 StringBuilder 内容存储在 UI 元素中：

```
 private static System.Text.StringBuilder m_sbText;

    public Form3(string path)
    {
        InitializeComponent();

        this._path = path;

        Process myProcess = new Process();
        ProcessStartInfo startInfo = new ProcessStartInfo("pawncc.exe");
        startInfo.CreateNoWindow = true;
        startInfo.UseShellExecute = false;
        startInfo.RedirectStandardOutput = true;
        startInfo.RedirectStandardError = true;
        startInfo.Arguments = path + " -r -d2";
        myProcess.StartInfo = startInfo;

        m_sbText = new System.Text.StringBuilder(1000);

        myProcess.OutputDataReceived += ProcessDataHandler;
        myProcess.ErrorDataReceived += ProcessDataHandler;

        myProcess.Start();

        myProcess.BeginOutputReadLine();
        myProcess.BeginErrorReadLine();

        while (!myProcess.HasExited)
        {
            System.Threading.Thread.Sleep(500);
            System.Windows.Forms.Application.DoEvents();
        }
        RichTextBox1.Text = m_sbText.ToString();
    }

    private static void ProcessDataHandler(object sendingProcess, DataReceivedEventArgs outLine)
    {
        // Collect the net view command output. 
        if (!String.IsNullOrEmpty(outLine.Data))
        {
            // Add the text to the collected output.
            m_sbText.AppendLine(outLine.Data);
        }
    } 
```

这显然有一些变化，但这应该让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:19:52.163

在过去处理衍生进程的原始输出/错误流时，我注意到了一些零星的问题，因此我通常通过事件处理捕获的输出：

```
Process myProcess = new Process();
ProcessStartInfo startInfo = new ProcessStartInfo("pawncc.exe");
startInfo.CreateNoWindow = true;
startInfo.UseShellExecute = false;
startInfo.RedirectStandardOutput = true;
startInfo.RedirectStandardError = true;
startInfo.Arguments = path + " -r -d2";
myProcess.EnableRaisingEvents = true;
myProcess.OutputDataReceived += OnOutputDataReceived;
myProcess.ErrorDataReceived += OnErrorDataReceived;
myProcess.StartInfo = startInfo;
myProcess.Start();
myProcess.BeginOutputReadLine();
myProcess.BeginErrorReadLine(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T01:22:10.497

我没有 pawnCC 应用程序，所以我无法尝试，但似乎它们将调试信息的详细程度限制为外部应用程序 - 除了命令提示符。

您可以尝试通过 cmd 生成 pawncc.exe：

```
"cmd.exe \c CommandParameterToLaunchPawnCCwithArguments" 
```

# java - Java Util List 的元素更新

> ID：14115770
> 
> 赞同：-2
> 
> 时间：2013-01-02T00:58:59.330
> 
> 标签：java, arraylist

我在小型医院系统中有一个用于患者的 ArrayList，需要编写一个方法来更新患者信息。此方法应采用一个名为“id”的整数，将此 id 与 Patient ArrayList 中的所有 id 匹配，并更改该对象中的一些信息。我怎样才能迭代这个列表？谢谢。

这是我的病人班

```
import java.util.ArrayList;
import java.util.List;

public class Patient {
    String strName,strSurname,strAddress,strDepartment,strGender;
    int iId,iClass,iDob;
    List<Entry> entries = new ArrayList<Entry>();
    long longTel;
    boolean boolAllergy,boolChronicDisease,boolRegularMedicine;

    public boolean isBoolAllergy() {
        return boolAllergy;
    }
    public void setBoolAllergy(boolean boolAllergy) {
        this.boolAllergy = boolAllergy;
    }
    public boolean isBoolChronicDisease() {
        return boolChronicDisease;
    }
    public void setBoolChronicDisease(boolean boolChronicDisease) {
        this.boolChronicDisease = boolChronicDisease;
    }
    public boolean isBoolRegularMedicine() {
        return boolRegularMedicine;
    }
    public void setBoolRegularMedicine(boolean boolRegularMedicine) {
        this.boolRegularMedicine = boolRegularMedicine;
    }
    public String getStrName() {
        return strName;
    }
    public void setStrName(String strName) {
        this.strName = strName;
    }
    public String getStrSurname() {
        return strSurname;
    }
    public void setStrSurname(String strSurname) {
        this.strSurname = strSurname;
    }
    public String getStrAddress() {
        return strAddress;
    }
    public void setStrAddress(String strAddress) {
        this.strAddress = strAddress;
    }
    public String getStrDepartment() {
        return strDepartment;
    }
    public void setStrDepartment(String strDepartment) {
        this.strDepartment = strDepartment;
    }
    public int getiId() {
        return iId;
    }
    public void setiId(int iId) {
        this.iId = iId;
    }
    public long getlongTel() {
        return longTel;
    }
    public void setiTel(long iTel) {
        this.longTel = iTel;
    }
    public int getiClass() {
        return iClass;
    }
    public void setiClass(int iClass) {
        this.iClass = iClass;
    }
    public int getiDob() {
        return iDob;
    }
    public void setiDob(int iDob) {
        this.iDob = iDob;
    }
    public String getStrGender() {
        return strGender;
    }
    public void setStrGender(String strGender) {
        this.strGender = strGender;
    }
    public void Details() {
        System.out.println("*********************************");
        System.out.println("Patient Id: " + getiId());
        System.out.println("Name: " + getStrName() + " Surname: " + getStrSurname());
        System.out.println("Address: " + getStrAddress() + " Department: " + getStrDepartment() + " Gender: " + getStrGender());
        System.out.println("Class: " + getiClass() + " Date of birth: " + getiDob() + " Tel: " + getlongTel());
        System.out.println("Chronical Disease? " + isBoolChronicDisease());
        System.out.println("Any Allergy? " + isBoolAllergy());
        System.out.println("Using regular drugs?" + isBoolRegularMedicine());
        System.out.println("*********************************");
    }
} 
```

这是使用 Patient 类的主要类

```
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.Scanner;

public class Main {

    static List<Doctor> listDoctors = new ArrayList<Doctor>();
    static List<Nurse> listNurses = new ArrayList<Nurse>();
    static List<Patient> listPatients = new ArrayList<Patient>();
    static String strUserName = "admin";
    static String strPass = "password";

    public static void main(String[] args) {
        @SuppressWarnings("unused")
        int iChoice;
        boolean exit = false;
        boolean boolAccess = Login();
        if (boolAccess) {
         while(!exit) {
            iChoice = Menu();
            switch(iChoice) {
                case 1:
                    AddDoctor();
                    break;
                case 2:
                    AddNurse();
                    break;
                case 3:
                    AddPatient();
                    break;
                case 4:
                    ListDoctors();
                    break;
                case 5:
                    ListNurses();
                    break;
                case 6:
                    ListPatients();
                    break;
                case 8:
                    ChangeUserName();
                    break;
                case 9:
                    ChangePass();
                    break;
                    //Hastalığa göre hastalar listelenecek
                    //Kronik hastlalıkları olan hastalar listelenecek
                    //Sigortasını yatırmayan hastalar listelenecek
                    //delete ve update olayları
                    //Hastaneye sevkedilen hastalar listelenecek
                    //Yatılı kalan hastalar listelensin
                    //Raporlu olan entryler listelenecek
                    //Kayıt girilirken eğer hasta ismi ilk defa giriliyorsa önce hasta kaydı yapın diye uyarı cıkacak
                case 15:
                    exit = true;
                    break;
            }
          }
       }
    }

    private static void ChangeUserName() {
        Scanner scan = new Scanner(System.in);
        if(Login()) {
            System.out.println("Enter new User Name:");
            strUserName = scan.next();
            System.out.println("Saved..");
        }
    }

    private static void ChangePass() {
        Scanner scan = new Scanner(System.in);
        if(Login()) {
            System.out.println("Enter new Password:");
            strPass = scan.next();
            System.out.println("Saved..");
        }
    }

    private static void ListNurses() {
        Iterator<Nurse> it = listNurses.iterator();
        while(it.hasNext()) {
            Nurse nur = (Nurse) it.next();
            nur.Details();
        }
    }

    private static void ListPatients() {
        Iterator<Patient> it = listPatients.iterator();
        while(it.hasNext()) {
            Patient patient = (Patient) it.next();
            patient.Details();
        }
    }

    public static boolean Login() {
        Scanner scan = new Scanner(System.in);
        System.out.println("Enter Username: ");
        if(strUserName.contentEquals(scan.next())) {
            System.out.println("Enter Password:");
            if(strPass.contentEquals(scan.next())) {
                return true;
            }
            else
                System.out.println("Wrong password");   
                return Login();
            }
        System.out.println("Wrong user name");
        return Login();
    }

    public static int Menu() {
        Scanner scan = new Scanner(System.in);

        System.out.println("Choose one of the following order:");
        System.out.println("1.Enter new Doctor");
        System.out.println("2.Enter new Nurse");
        System.out.println("3.Enter new Patient");
        System.out.println("4.List all doctors");
        System.out.println("5.List all nurses");
        System.out.println("6.List all patients");
        System.out.println("8.Change user name");
        System.out.println("9.Change password");
        System.out.println("15.Exit");

        return scan.nextInt();
    }

    private static void ListDoctors() {
        Iterator<Doctor> it = listDoctors.iterator();
        while(it.hasNext()) {
            Doctor doc = (Doctor) it.next();
            doc.Details();
        }
    }

    private static void AddDoctor() {
        Doctor doctor;
        String strName,strSurname,strSpeciality;
        int iSSN;
        Scanner scan = new Scanner(System.in);
        System.out.println("Enter name:");
        strName=scan.next();
        System.out.println("Enter surname:");
        strSurname = scan.next();
        System.out.println("Enter speciality");
        strSpeciality = scan.next();
        System.out.println("Enter SSN");
        iSSN = scan.nextInt();

        doctor = new Doctor(strName,strSurname,strSpeciality,iSSN);
        listDoctors.add(doctor);

        System.out.println("Saved..");
    }

    private static void AddNurse() {
        Nurse nurse;
        String strName,strSurname;
        int iSSN;
        Scanner scan = new Scanner(System.in);
        System.out.println("Enter name:");
        strName=scan.next();
        System.out.println("Enter surname:");
        strSurname = scan.next();
        System.out.println("Enter SSN");
        iSSN = scan.nextInt();

        nurse = new Nurse(strName,strSurname,iSSN);
        listNurses.add(nurse);

        System.out.println("Saved..");
    }

    private static void AddPatient() {

        Patient patient = new Patient();
        Scanner scan = new Scanner(System.in);
        System.out.println("Enter name:");
        patient.setStrName(scan.next());
        System.out.println("Enter surname:");
        patient.setStrSurname(scan.next());
        System.out.println("Enter date of birth(DDMMYYYY)");
        patient.setiDob(scan.nextInt());
        System.out.println("Enter address:");
        patient.setStrAddress(scan.next());
        System.out.println("Enter department:");
        patient.setStrDepartment(scan.next());
        System.out.println("Enter gender:");
        patient.setStrGender(scan.next());
        System.out.println("Enter Telephone number:");
        patient.setiTel(scan.nextLong());
        System.out.println("Enter id:");
        patient.setiId(scan.nextInt());
        System.out.println("Enter class:");
        patient.setiClass(scan.nextInt());
        System.out.println("Does patient have any chronical disease? (Y/N)");
        if(scan.next().contentEquals("Y"))
            patient.setBoolChronicDisease(true);
        else
            patient.setBoolChronicDisease(false);
        System.out.println("Does patient use any regular drugs? (Y/N)");
        if(scan.next().contentEquals("Y"))
            patient.setBoolRegularMedicine(true);
        else
            patient.setBoolRegularMedicine(false);
        System.out.println("Does patient have any allergies?");
        if(scan.next().contentEquals("Y"))
            patient.setBoolAllergy(true);
        else
            patient.setBoolAllergy(false);

        listPatients.add(patient);
    }

    private static void SearchPatientById(int id) {
        Iterator<Patient> it = listPatients.iterator();
        while(it.hasNext()) {
            Patient patient = (Patient) it.next();
            if(it.next().getiId() == id)
                patient.Details();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:15:15.943

稍作修改，您的 searchPatientById 就可以返回找到的患者对象：

```
private static Patient searchPatientById(int id) {
    Iterator<Patient> it = listPatients.iterator();
    while(it.hasNext()) {
        Patient patient = (Patient) it.next();
        if(patient.getiId() == id)
            return patient;
    }
    // if not found return null
    return null;
} 
```

请注意，我删除了您对`next()` 这样的双重调用，您可以执行类似的操作

```
Patient foundPatient = searchPatientById(idToFind);
if (foundPatient != null) {
    foundPatient.setBoolAllergy(patientsAllergyState);
} else {
    // whatever you need to do if the patient cannot be found
} 
```

另请注意，在 Java 中，将变量类型编码为变量名称并不常见，但有一个普遍遵循的[命名约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-135099.html#367)

# objective-c - Why does Xcode automatically create variables with underscores?

> ID：14115774
> 
> 赞同：4
> 
> 时间：2013-01-02T00:59:24.760
> 
> 标签：objective-c, xcode, declared-property

Why in the newest version of Xcode (dp-4) are variables declared with `retain,nonatomic` made to use the underscore before the variable name? Does this create some sort of type safety?

For example, I create a property:

```
@property (retain, nonatomic) IBOutlet UILabel *name; 
```

Unless I change the variable inside the `dealloc` to not have the _, I have to do:

```
@synthesize name = _name; 
```

Why is this?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-02T01:16:33.450

Mark Dalrymple, who's way smarter than I am, wrote [a blog post at Big Nerd Ranch](http://blog.bignerdranch.com/463-a-motivation-for-ivar-decorations/) about this very subject. Bottom line: the underscore is a good idea. I will summarize his post here just in case the link stops working in the future, but if possible you should read his post instead of my summary.

He wrote this post back when explicitly calling `@synthesize` was mandatory. He advocated code such as:

```
// soapbubble.m
@synthesize viscosity = _viscosity;
@synthesize detergentBrand = _detergentBrand; 
```

These days Xcode automatically and implicitly includes `@synthesize`. And it does so using the prepended underscore so apparently Apple's engineers agree with Mark.

His first reason is stylistic. It allows you to easily see which variables are local and which are arguments in a setter:

```
- (void) setPonyName: (NSString *) ponyName {
    [_ponyName autorelease];
    _ponyName = [ponyName copy];
} 
```

(This is a pre-ARC setter, so now this method would be completely unnecessary, but if the setter did anything more involved than simply releasing and assigning a value it would still apply.)

His second reason (and the one I think is more important) is that eliminates a certain class of bug that can be very difficult to track down.

This code:

```
self.ponyName = @"Mikey"; 
```

is identical to:

```
[self setPonyName: @"Mikey"]; 
```

Without the prepended underscore, this code is also valid:

```
ponyName = @"Mikey"; 
```

but it doesn't call the setter so any side effects in the setter don't occur. Again, in a situation where the setter does extra work besides changing the local variable's value this can cause big headaches. With the prepended underscore, that line would cause a compile error. You would have to be very explicit about wanting to set a local variable:

```
_ponyName = @"Mikey"; 
```

and, being the conscientious programmer you are, you would include a comment explaining exactly why you are performing this irregular maneuver.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T05:25:53.620

"_name" in your @synthesize name = _name, is just a variable name created automatically by your Xcode. This is done because @synthesize just creates setters and getters and if you don't use _name, it'll take your property name, i.e. name (in this case) and finally leads to bugs in your app. _name is just a naming convention. You can use any variable name in place of _name. So that @synthesize will use that variable name in its implementation.

# php - wp_query 中的分页

> ID：14115778
> 
> 赞同：3
> 
> 时间：2013-01-02T01:00:03.870
> 
> 标签：php, wordpress

这可能很容易，但我无法弄清楚。我已经搜索了几个小时，但我的情况没有运气。我需要使用 my_query 进行分页

```
 <?php   
    $count = 0;
    $id_suffix = 1;
    $items_per_row = 4;
    $quality = 90;      
    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;             
    $wp_query = new WP_Query( array( 'posts_per_page' => '4', 'post_type' => 'portfolio') );
    $grid_class = 'grid_3';
    $desired_width = 220;
    $desired_height = 190;
    $terms = get_terms( 'portfolio_categories' ); 
    $count_terms = count( $terms ); 
?>

//some php code 

<?php while ( $wp_query -> have_posts()) : $wp_query -> the_post(); //query the "portfolio" custom post type for portfolio items ?>

//some more php code 

<?php endwhile;?>
<div class="nav-previous"><?php next_posts_link(__('<span class="meta-nav">&laquo;</span> Older posts', 'thematic')) ?></div>
<div class="nav-next"><?php previous_posts_link(__('Newer posts <span class="meta-nav">&raquo;</span>', 'thematic')) ?></div>
</ul> 
```

我要显示分页，但是当单击另一个页面时，它会显示相同的投资组合项目。任何帮助，将不胜感激。

我得到了使用 wp-pagenavi 显示的分页，但同样的问题是不更改项目。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T01:05:22.920

您正在构造`$paged`变量但没有使用它。

```
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;             
$wp_query = new WP_Query( 
  array( 
  'posts_per_page' => '4', 
  'post_type' => 'portfolio',
  'paged' => $paged // this is the missing part
) ); 
```

WordPress 使用`$wp_query`变量名。您可能应该使用不同的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-02T02:31:36.230

感谢@maiorano84 和@s_ha_dum 为我指明了正确的方向。我想为遇到问题的任何人更新这篇文章。我遇到的问题是在静态首页上进行分页。在阅读了法典之后，我发现了我的问题。

而不是`$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;`
我不得不使用
`$paged = (get_query_var('page')) ? get_query_var('page') : 1;`

这个小错误是让分页继续工作的原因。所以最终的代码看起来像这样。

```
<?php   
    $count = 0;
    $id_suffix = 1;
    $items_per_row = 4;
    $quality = 90;
    $paged = (get_query_var('page')) ? get_query_var('page') : 1;
    $my_query = new WP_Query( array( 
    'posts_per_page' => 8, 
    'post_type' => 'portfolio',
    'paged' => $paged
    ) );
    $grid_class = 'grid_3';
    $desired_width = 220;
    $desired_height = 190;
    $terms = get_terms( 'portfolio_categories' ); 
    $count_terms = count( $terms ); 
?> 
```

//一些php代码

```
<?php while ( $my_query -> have_posts()) : $my_query -> the_post(); //query the "portfolio" custom post type for portfolio items ?>

  (Some more php code)

<?php endwhile;
wp_pagenavi(array( 'query' => $my_query ) );    ?>
</ul><!-- END .portfolio-gallery --> 
```

?>

# mootools - 完成后的 Fx.Reveal 事件（完成）

> ID：14115781
> 
> 赞同：0
> 
> 时间：2013-01-02T01:00:53.550
> 
> 标签：mootools

嗨，对不起，对于使用 jquery 的 mootools 来说是全新的，有一个容器（保存到变量 itemContent），它显示，

在此之后调用一个函数galleryScroll，它将元素滚动到保存到var itemScroll的容器中，

想确保在调用滚动功能之前显示 itemContent 最好的方法是什么？

谢谢

```
itemContent.reveal({
                'height' : '100%',
                duration: 1600, 
            }).addClass('open-content');

            // should this fire this in  a callback function so it fires once the container is revealed

            galleryScroll.toElement(itemScroll); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T20:46:00.903

You can enable chaining with the `link` option.

```
itemContent.reveal({
    'height': '100%',
    duration: 1600,
    link: 'chain'
}).addClass('open-content'); 
```

This example will hide, reveal and then alert. Please note that I need to get the `reveal` instance as the standard Element in mootools does not implement the Chain class.

```
document.id('first').set('reveal', {
    duration: 'long',
    transition: 'bounce:out',
    link: 'chain'
}).dissolve().reveal().get('reveal').chain(function(){alert('message');}); 
```

To see it in action: [http://jsfiddle.net/LKSN8/1/](http://jsfiddle.net/LKSN8/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T02:09:21.113

Fx.Reveal 扩展了 Fx，因此继承了它的所有事件。

通过元素设置器尝试：

```
itemCount.set('reveal', {
    onComplete: function(){
        galleryScroll.toElement(this.element);
    }
}.reveal({... }); 
```

您还可以获得揭示实例：

```
var fxReveal = itemCount.get('reveal'); 
```

这将返回实例，您可以像往常一样设置您喜欢的任何内容。

# jquery - jQuery选择给定元素的伪元素

> ID：14115785
> 
> 赞同：2
> 
> 时间：2013-01-02T01:01:20.530
> 
> 标签：jquery, jquery-selectors, element, pseudo-element

> **可能的重复：**
> [使用 jQuery 操作 CSS :before 和 :after 伪元素](https://stackoverflow.com/questions/5041494/manipulating-css-before-and-after-pseudo-elements-using-jquery)

如果我有一个`element`，如何使用*jQuery*处理其对应的伪元素？

我的观点是，例如，如果我在 DOM 中有一个元素，我如何使用*jQuery*`:before`访问它的元素或`:after`伪元素？

 **PS 我只有一个指向该元素的 jQuery 指针。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:29:53.793

也许您希望创建一个根本不存在的元素。使用 jQuery[**`.after()`**](http://api.jquery.com/after/)创建它。（*同样，你也可以使用 jQuery [**`.before()`**](http://api.jquery.com/before/)！*）

```
<div id="element">123</div> 
```

```
#element {
 float: left;
 color: white;
}

.selected {
  background-image:url("http://www.gravatar.com/avatar/bb7148ce65e69d732186e93116462cb2?s=100&d=identicon&r=PG");
  width: 100px;
  height: 100px;
} 
```

```
$('#element').after('<div class="selected"></div>'); 
```

[**jsFiddle 演示**](http://jsfiddle.net/5p3kn/)

[**带删除的 jsFiddle 演示**](http://jsfiddle.net/5p3kn/1/)*

# php - 除非在用户登录后刷新页面，否则会话 ID 不会注册为已设置

> ID：14115805
> 
> 赞同：0
> 
> 时间：2013-01-02T01:05:48.787
> 
> 标签：php, sessionid, isset

我有许多前端功能，这些功能是根据用户是否登录（即显示的菜单项）触发的，但是当用户登录时我无法触发它们，除非它们被重定向或页面被刷新。

`$logged_in`用户登录后如何更改要设置的值？这些功能都可以正常工作，包括`$_SESSION['SESS_USER_ID'] = $member['user_id'];`登录后的设置。

**Index.php** *（大部分代码也在整个站点中使用）*

*在文件的开头：*

```
<?php    
require_once('auth.php'); // This file starts session, and checks if(!isset($_SESSION['SESS_USER_ID']) || (trim($_SESSION['SESS_USER_ID']) == ''))  
require_once('config.php'); // Connects to database connection   
$user_id = $_SESSION['SESS_USER_ID'];       
$logged_in = (isset($_SESSION['SESS_USER_ID']));
?> 
```

然后由 $logged_in 触发相关函数，并遵循以下基本格式：

```
<?php if ($logged_in) : ?>
// Some HTML or Script
<?php else : ?>
// Some HTML or Script
<?php endif; ?> 
```

*登录形式和功能*

*如果某些 AJAX 无关紧要，我深表歉意 - 我真的不了解 AJAX 并重新利用现有代码。*

```
<form id="loginForm" name="loginForm" action="login-exec_pdo.php"  method="post">  
<label for="user_name">Username </label><input type="text" name="user_name" required />
<label for="password">Password </label><input type="text" name="password" required />
<div id="return_result"></div><div id="messageBox5">Please complete the highlighted    fields</div>                  
<input type="submit" id="login" value="Sign in" />
</form>

<script type="text/javascript">
$(function () { $('#loginForm').validate({          
rules: {user_name: {required: true, minlength: 2,}, password: {required: true, minlength: 6,},}, messages: {user_name: "", password: "",},      
errorLabelContainer: "#messageBox5", 
submitHandler: function (form){
  $.ajax({
    type: 'POST',
    url: 'login-exec_pdo.php',
    data: $("#loginForm").serialize(),
    success: function(data) {   
      if(data == "true") {
        $("#loginForm").fadeOut("fast");
      }
      else {
        writeToTarget('return_result', 'Incorrect Username or Password');
}  }  });  }   });  });  
</script> 
```

**login-exec.php 文件**

```
<?php
session_start();
require_once('config/config_pdo.php'); // Includes db connection, salt, & PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION
$password = $_POST['password'];  
$hashedPassword = sha1($salt . $password); 

try {  
   $stmt_user = $conn->prepare("SELECT * FROM customer_info WHERE user_name = :user_name and password = :hashedPassword");  
   $stmt_user->bindValue(':user_name', $_POST['user_name'], PDO::PARAM_STR); 
   $stmt_user->bindValue(':hashedPassword', $hashedPassword);     
   $stmt_user->execute();                 
   session_regenerate_id();                  
   $member = $stmt_user->fetch();                 
   if($member) {                  
      $_SESSION['SESS_USER_ID'] = $member['user_id'];  
      $_SESSION['SESS_USER_NAME'] = $member['user_name'];             
      session_write_close(); 
      echo "true";                 
      exit();
   }else {
      echo "false";
      exit();
   }                    
}catch(PDOException $e) {
  echo $e->getMessage();
}                 
?> 
```

我还尝试使用 javascript 和 php 在登录功能（如上所示）中的成功功能中设置它，但它要么没有设置它和/或阻止登录功能正确完成。我尝试过的一些事情是： `if ($logged_in) :` `$logged_in = (isset($_SESSION['SESS_USER_ID']));` `$logged_in = "true";` 和 `$logged_in = 1;`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T03:27:30.107

如果您通过 AJAX 提交登录请求，则主页的 PHP 不会受到影响，因为它是服务器端的并且已经编写好了。如果您无法通过 AJAX 拨打电话，您可以：

1) 使用 success() 函数刷新对话框/框架/使用 $logged_in 变量的页面

2) 使用 success() 函数进行另一个 AJAX 调用以检索页面

3）加载所有内容（取决于它的敏感程度），但将“登录”材料设置为`display:none;`，并使用 success() 执行类似的操作`$('.logged-in-user-stuff').show();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T18:35:20.093

**介绍**

有点伤脑筋，所以让我先展示你明显的错误

**错误 #1**
您不能直接使用 JavaScript 设置 PHP 变量。这只能通过与 JSON/XML 交换来完成

```
submitHandler: function (form){

    $.ajax({type: 'POST', url: 'login-exec_pdo.php', data: $("#loginForm").serialize() ...

    success: function(data) {

        if (data == "true") { 

            $("#loginForm").fadeOut("fast");

            // THIS IS WHERE I'VE TRIED TO SET $logged_in

            // 1\. You can't set $logged_in to true right from this point
            // You should send JSON or XML back to PHP invoking a new nested ajax call
            // and then parse that stuff in PHP and then send the parsed stuff back to JavaScript.
            // However, this is some kind of bad approach, because A) you invoke a nested ajax call
            // B) you make it even worse to debug and maintain C) 

            // 2\. You serialized the form but never used it

        .... 
```

**错误 #2**

混合职责和代码重复。究竟是什么：将数据库处理程序（包括数据库配置）与用户责任混合（参见下面的描述）

```
$stmt_user = $conn->prepare("SELECT * FROM customer_info WHERE user_name = :user_name and password = :hashedPassword");  <-- LIMIT 1 keyword should be appended
$stmt_user->bindValue(':user_name', $_POST['user_name'], PDO::PARAM_STR); 
$stmt_user->bindValue(':hashedPassword', $hashedPassword); //<-- btw, you've missed PDO::PARAM_STR here
$stmt_user->execute();
...                
session_regenerate_id();  //<-- This should be done after successful authorization, not before                  
$member = $stmt_user->fetch();                 
if($member) {    //if you have error_reporting(E_ALL) you'll see a E_NOTICE 
   $_SESSION['SESS_USER_ID'] = $member['user_id'];
   session_write_close(); 
   echo "true"; //<-- Single quotes should be used instead of double ones.
   exit();
}else {
   echo "false";
   exit();
} 
```

那么好吧。假设这是一个登录页面。但是在真实的场景中，用户的个人资料页面也将使用数据库。根据您的代码，您将不得不实现相同的数据库处理程序两次甚至更多......（见下面的评论）

**错误 #3**
根本没有错误跟踪 & 依赖于客户端验证。

基本上，您永远不应该相信客户端验证，因为任何人都可以简单地在浏览器中禁用 JavaScript。然后他可以轻松地将“无效”数据发送到 PHP 脚本。始终进行服务器端验证！但这并不意味着您根本不应该使用客户端验证。
相反，当它们来自未启用/支持 JS 的浏览器时，您应该处理这种情况。您可以自己尝试，只需在浏览器中禁用 JavaScript，然后进入您的网站...

**错误 #4**
更不用说代码重复了，代码本身的结构并不好。这是不应该的。在这里，我说的是 JavaScript 和 PHP 代码......

**现在，你应该如何解决这个问题**

我不确定您是否会遵循上述建议（以防您没有时间或意愿），所以让我先回答您的原始问题。

> `$logged_in`用户登录后如何更改要设置的值？

简而言之：这是一个 PHP 变量！因此应该在 PHP 中设置它对我来说很像，即使你`$logged_in`在用户登录后设置为 TRUE，你也错过了某个地方`session_start()`。但是，根本不要使用这个变量！而是定义一个函数，例如，`is_user_logged()`因为如果出现问题，它更可靠且“可捕获”。好的，接下来，

为了让生活更轻松，只需定义这些函数：

```
/**
 * Checks whether user logged in
 * 
 * @return boolean TRUE if user is logged in
 *                 FALSE if not
 */
function is_user_logged(){
   //if session isn't started yet
   if ( session_id() == ''){
      // do start it now
      session_start();
   }

   if ( isset($_SESSION['SESS_USER_ID']) ){
      return true; 
   }

   return false;
}

/**
 * Retrieves an ID of the logged user if he's really logged
 * NULL otherwise
 * 
 * @return string|null
 */
function get_logged_user_id(){

   if ( is_user_logged() === TRUE ){
      return $_SESSION['SESS_USER_ID'];
   }

   return null;
}

/**
 * "Marks" given user id as a logged one
 * 
 * @return void
 */
function register_user_id_as_logged($id){

   //will start session also if not started yet
   if ( is_user_logged() !== TRUE ){
      $_SESSION['SESS_USER_ID'] = $id;
   }
} 
```

将这些函数放在文档的顶部。

现在改变：

**在 HTML 模板中排名第一** 

```
<?php if ( TRUE === is_user_logged() ) : ?>

// Some HTML or Script if logged

<?php else : ?>

// Some HTML or Script if not logged

<?php endif; ?> 
```

**#2**

```
...
$member = $stmt_user->fetch();                 
if($member) {                  
   $_SESSION['SESS_USER_ID'] = $member['user_id'];                 
   session_write_close(); 
   echo "true";
   exit; 
```

到：

```
$member = $stmt_user->fetch();                 
if ($member) {  //<-- Somehow my heart tells me it should be - if ( isset($member[0]) )

   register_user_id_as_logged($member['user_id']); //<-- and this should be $member[0]['member_id']
   session_regenerate_id();
   exit('true');

if (data == "true") { 

$("#loginForm").fadeOut("fast"); // <-- not required if you're going to do redirect

// THIS IS WHERE I'VE TRIED TO SET $logged_in  <-- if you already in this "block", a "session id" is already set and it "works"
// all you need to do is just to redirect,like:

window.location = 'some_profile_page.php'; 
```

**现在我自己的建议**

**提示 #1**

确保 JavaScript 未被禁用。你可以简单地这样做，比如，

```
<!DOCTYPE html>
<html>
<head>

...

<!--So, when JS is disabled, it would redirect to /error.php page automatically -->
<noscript>

    <meta http-equiv="REFRESH" content="0; url=/error.php" />

</noscript> 

 ...
</head>

...
</html> 
```

在所有 HTML 文档中使用这个技巧。

**提示 #2**

您应该将所有与配置文件相关的逻辑封装到一个类中。它应该类似于这个：

```
class Profile {

    private $db;

    public function __construct(PDOAdapter $db)
    {
        $this->db = $db;
    }

    public function login($username, $password)
    {
        //do query here and return boolean
    }

    public function logout()
    {
        //destroy session here
    }

    public function isLogged()
    {
        // check if session key exists and its a valid one here
    }

    private function registerAsLogged()
    {
        //....
    }
} 
```

# c++ - 使用 C++ 删除旧文件

> ID：14115815
> 
> 赞同：3
> 
> 时间：2013-01-02T01:07:20.620
> 
> 标签：c++, file-io, dirent.h

我必须使用 c++ 删除给定目录中所有超过 n 天的文件。

仅供参考，我对某些文件操作使用“dirent”，例如列出给定目录中的所有文件，但不确定如何检查日期属性并应用数学来删除超过 n 天的文件。

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:57:54.277

难的。该语言本身不支持文件系统，即使在新的 C++11 标准中也是如此。（这是下一份技术报告“C++ TR2”的提案。）

Boost 没有对 Android 和 iOS 的官方支持。Qt 4.x 也没有。

但是，Qt 5 将支持 Android 和 iOS。它似乎刚刚发布，所以也许你可以尝试一下。文件系统支持是其 QtCore 模块的一部分（例如，`QFile`和`QDir`）。

# objective-c - UIWebView 不会加载内容

> ID：14115818
> 
> 赞同：0
> 
> 时间：2013-01-02T01:07:36.350
> 
> 标签：objective-c, cocoa-touch, uiwebview

我正在制作一个类，它将作为脚本加载的一个门面。此类将与加载了磁盘上的 HTML 和 JS 文件的无头 UIWebView 进行交互。

我目前正在单元测试环境中执行所有操作，看起来 UIWebView 拒绝加载任何内容。这是我的代码的样子：

**WebView 初始化**

```
self.webView = [[UIWebView alloc] initWithFrame:CGRectMake(0,0,0,0)];
self.webView.delegate = self;
[self loadScriptingCore]; 
```

**脚本加载器：**

```
- (void)loadScriptingCore
{
    NSURLRequest *loadRequest = [NSURLRequest requestWithURL:[self scriptingCoreIndex]];
    [self.webView loadRequest:loadRequest];
    NSLog([self inspectDom]);
}

- (NSURL *) scriptingCoreIndex  
{
    NSString *indexPath = [[NSBundle mainBundle] pathForResource:@"scripting-core" ofType:@"html" inDirectory:@"www"];
    NSLog([NSString stringWithFormat:@"Scripting Core Index: %@", indexPath]);
    return [NSURL fileURLWithPath:indexPath];
}

- (NSString *)inspectDom
{
    return [self.webView stringByEvaluatingJavaScriptFromString:@"document.documentElement.outerHTML;"];
} 
```

**HTML**

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Scripting Core</title>
</head>
<body>
   <div id="element">
       Hello
    </div>
</body>
</html> 
```

inspectDom 方法只返回

```
<html><head></head><body></body></html> 
```

Thich 向我表明，webView 没有发生任何事情。此外，委托方法似乎不会触发 webViewDidStartLoad、webViewDidFinishLoad 和 webViewDidFailLoad。

任何建议，将不胜感激

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T05:59:55.683

测试问题的要点是 UIWebView 加载是异步的。我在发出请求后尝试了 [NSThread sleepForTimeInterval]，但这还不够。显然，主线程需要处于活动状态才能使 UIWebView 异步加载。

通过使用这种异步测试机制，我能够让我的单元测试通过：

[https://github.com/akisute/SenAsyncTestCase](https://github.com/akisute/SenAsyncTestCase)

这段代码使用 NSRunLoop 来旋转运行循环，同时保持主线程处于活动状态——有点像伪睡眠。在请求脚本加载后，在我的测试中添加 1/10 秒的等待会导致 DOM 被正确加载并触发委托事件。

```
[self waitForTimeout: 0.1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T02:19:28.900

确保在您的 @ 实现中将类设置为委托

```
@implementation myclass:parent <UIWebViewDelegate> 
```

的输出是`NSLog([NSString stringWithFormat:@"Scripting Core Index: %@", indexPath]);`什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-27T14:17:32.403

在 Swift 中，如果你还在使用 UIWebView，并且你想在调用 load(data: ...) 之后测试它的内容，你可以尝试以下方法：

```
class TestCase: XCTestCase {
  var testDelegate: TestDelegate()
  lazy var loadExpectation: XCTestExpectation = { return self.expectation(description: "waiting") }()

  func testSomething() {
    testDelegate.expectation = loadExpectation

    webViewUnderTest.delegate = testDelegate
    webViewUnderTest.load(data: ...)

    waitForExpectations(timeout: 5) { (error) in
      dump(error)
    }

    assert(...)
  }
}

class TestDelegate: NSObject, UIWebViewDelegate {
  var expectation: XCTestExpectation?

  func webView(_ webView: UIWebView, shouldStartLoadWith request: URLRequest, navigationType: UIWebViewNavigationType) -> Bool {
      return true
  }

  func webViewDidFinishLoad(_ webView: UIWebView) {
      expectation?.fulfill()
  }
} 
```

# node.js - 在 Express 3.x 中加载样式表时出错

> ID：14115819
> 
> 赞同：2
> 
> 时间：2013-01-02T01:07:37.953
> 
> 标签：node.js, express, pug

所以我在我的 express 项目中加载样式表时遇到问题。当我使用 express 2.5.8 时，我的样式被正确加载，但是当我更新到 3.x 时，样式开始无法加载。视图被渲染但没有任何样式。

我正在使用 node、express 3.x、jade 和 bootstrap。我的风格在`public/stylesheets/*`.

更新：似乎由于某种原因`layout.jade`没有被渲染。

这是我的`server.js`

```
require('coffee-script');
/**
 * Module dependencies.
 */

var express = require('express'),
            flash = require('connect-flash');

var app = module.exports = express.createServer();

// Configuration

app.configure(function(){
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.set('port', 3000);
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(flash());
  app.use(require('connect-assets')());
  app.use(app.router);
  app.use(express.static(__dirname + '/public'));
});

app.configure('development', function(){
  app.use(express.errorHandler({ 
    dumpExceptions: true, 
    showStack: true 
  }));
});

app.configure('test', function () {
  app.set('port', 3001);
});

app.configure('production', function(){
  app.use(express.errorHandler());
});

// Routes

require('./apps/landing-page/routes')(app);
require('./apps/authentication/routes')(app);
require('./apps/home/routes')(app);
require('./apps/register/routes')(app);

app.listen(3000);
console.log("Express server listening on port %d in %s mode", app.settings.port, app.settings.env); 
```

这是我的主要`layout.jade`观点：

```
!!!
html
  head
    title= title
    script(src='http://code.jquery.com/jquery-latest.js')
    link(rel='stylesheet', href='/stylesheets/bootstrap.css')
    link(rel='stylesheet', media='screen', href='/stylesheets/bootstrap-responsive.css')
    link(rel='stylesheet', href='/stylesheets/app.css')

    script(src='javascripts/bootstrap.js')

    |   <!--[if lt IE 9]>
    |   <link rel="stylesheet" href="stylesheets/ie.css">
    |   <![endif]-->

    |   <!-- IE Fix for HTML5 Tags -->
    |   <!--[if lt IE 9]>
    |     <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    |   <![endif]-->

  body 
    !=body

script(src='javascripts/app.js') 
```

这是我的一条路线：

```
routes = (app) ->
    app.get '/home', (req, res) ->
        res.render "#{__dirname}/views/home",
        title: 'Home | SiteName'
        stylesheet: 'home'

module.exports = routes 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T01:17:30.513

我相信布局渲染`false`在 Express 3 中已设置为默认设置，因此请尝试将以下内容添加到您的配置中：

```
app.set('view options', { layout: true }); 
```

**更新：** [迁移指南](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)声明布局和部分的概念已被完全删除。相反，使用[Jade 的模板继承](https://github.com/visionmedia/jade#template-inheritance)。

**/视图/布局**

```
!!! 5
head
    // all your header elements
body
    block content 
```

**/视图/主页**

在顶部添加以下内容：

```
extends layout

block content
    // the stuff you want to have in your content block 
```

有关更多信息，请查看[本指南](http://www.devthought.com/code/use-jade-blocks-not-layouts/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T01:15:41.560

```
app.use(express.static(__dirname + '/public')); 
```

必须在之前

```
app.use(app.router); 
```

# linux - vim/vi/sed：作用于文件末尾的一定数量的行

> ID：14115820
> 
> 赞同：11
> 
> 时间：2013-01-02T01:07:48.917
> 
> 标签：linux, bash, vim, sed, awk

就像我们可以在 vim 中删除（或替换，或 yank 等）文件开头的第 4 到第 6 行一样：

```
:4,6d 
```

我想从文件*末尾*删除（或替换，或猛拉等）第 4 行到第 6 行。这意味着，如果文件有 15 行，我会这样做：

```
:10,12d 
```

但是当他们不知道文件中有多少行时，就无法做到这一点——我将在一批许多文件上使用它。我如何在 vim 和 sed 中执行此操作？

我确实看过[这篇文章](https://stackoverflow.com/questions/14046878/using-sed-to-match-a-pattern-and-deleting-from-the-line-to-the-end-of-the-file)，但没有发现它有用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-02T01:20:41.890

好吧，使用`vim`您可以尝试以下操作 - 无论如何，这非常直观：

```
:$-4,$-5d 
```

现在，使用`sed`我找不到确切的方法来做到这一点，但如果你可以使用 以外的东西`sed`，这里有一个解决方案`head`和`tail`：

```
head -n -4 file.txt && tail -2 file.txt 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-02T01:23:05.143

在 Vim 中，您可以从`$`代表最后一行的 中减去行号，例如，这将适用于最后 3 行：

```
:$-2,$substitute/... 
```

* * *

在 sed 中，这并不容易，因为它适用于字符*流*，不能简单地返回。您必须在*保持空间*中存储一些最后看到的行，并在流的末尾处理保持空间。以下是[sed1line.txt](http://sed.sourceforge.net/sed1line.txt)中的一些食谱：

```
# print the last 10 lines of a file (emulates "tail")
sed -e :a -e '$q;N;11,$D;ba'

# print the last 2 lines of a file (emulates "tail -2")
sed '$!N;$!D'

# delete the last 2 lines of a file
sed 'N;$!P;$!D;$d'

# delete the last 10 lines of a file
sed -e :a -e '$d;N;2,10ba' -e 'P;D'   # method 1
sed -n -e :a -e '1,10!{P;N;D;};N;ba'  # method 2 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-02T02:43:57.290

从文件末尾倒数第 4 行到第 6 行：用于[`tac`](http://man.cx/tac)反转文件

```
tac filename | sed 4,6d | tac 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-02T21:10:39.080

您可以在 awk 中使用 2 次通过，第一次通过计算行数，第二次通过打印或删除您喜欢的任何行，例如

```
awk 'NR==FNR{numLines++;next} {fromEnd = numLines - FNR} fromEnd > 6 || fromEnd < 4' file file

awk 'NR==FNR{numLines++;next} {fromEnd = numLines - FNR} fromEnd < 6 && fromEnd > 4' file file 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-02T13:20:15.467

这可能对您有用（GNU sed）：

```
sed -r ':a;${s/([^\n]*\n){3}//;q};N;7,$!ba;P;D' file 
```

这是通过在模式空间 (PS) 中创建一个 6 行的移动窗口，然后在遇到最后一行时删除其中的前三行来实现的。

*   `:a`是一个循环标签
*   `${s/([^\n]*\n){3}//;q}`删除文件末尾 PS 的前三行并退出。
*   `N`添加一个换行符，然后将下一行添加到 PS。
*   `7,$!ba`' 如果*不是*`7`到`$`（文件结尾）的行，即行到`1`，则`6`循环回到开头，即标签`:a`
*   `P;D``7`对于要（文件结尾）的行范围，`$`打印到 PS 中的第一个换行符，然后删除直到并包括第一个换行符并开始一个新的循环。

倒数第二个子句默认创建窗口，因为`1`要`6`附加到 PS 中的行。从行`7`到末尾，在末尾添加一行，打印第一行然后删除。

或者：

```
sed -e ':a' -e '$s/\([^\n]*\n\)\{3\}//' -e '$q' -e 'N' -e '7,$!ba' -e 'P' -e 'D' file 
```

# c - 如何 fork() n 个子进程执行不同的功能？

> ID：14115826
> 
> 赞同：3
> 
> 时间：2013-01-02T01:09:30.667
> 
> 标签：c, multiprocessing, fork

这是我的代码：

```
for (c = 0; c < PROCESSES; c++) {
    pid[c] = fork();
    switch (pid[c]) {
        case -1:
            perror("Faild fork!\n");
            break;
        case 0:
            printf("C = %d\n", c);
            if (c == 0) {
                printf("MY ID0 %d\n", getpid());
                customers();
                break;
            }
            if (c == 1) {
                printf("MY ID1 %d\n", getpid());
                cashier();
                break;
            }
            if (c == 2) {
                printf("MY ID2 %d\n", getpid());
                sales();
                break;
            }
            if (c == 3) {
                printf("MY ID3 %d\n", getpid());
                warehouse();
                break;
            }
            break;

        default:
            if (c == (PROCESSES - 1)) {

                for (j = 0; j < PROCESSES; j++) {
                    w = wait(&state);
                    if (w == -1) {
                        perror("Erro na espera!\n");
                    }
                    printf("Terminar processo %d\n", w);
                }
                sleep(2);
                printf("Fim da simulação.\n\n");
                free_shm_sem();
            }

    }
} 
```

我期望发生的事情：

```
C = 0
MY ID0 3904
C = 1
MY ID1 3905
C = 2
MY ID2 3906
C = 3
MY ID3 3907 
```

发生了什么：

```
C = 0
MY ID0 3904
C = 1
MY ID1 3905
C = 2
MY ID2 3906
C = 3
MY ID3 3907
C = 3
MY ID3 3911 
```

如果我改为：

```
 if (c == 0) {
                printf("MY ID0 %d\n", getpid());
                customers();
                break;
            }
            if (c == 1) {
                printf("MY ID1 %d\n", getpid());
                sales();
                break;
            }
            if (c == 2) {
                printf("MY ID2 %d\n", getpid());
                cashier();
                break;
            }
            if (c == 3) {
                printf("MY ID3 %d\n", getpid());
                warehouse();
                break;
            } 
```

输出变为：

```
C = 0
C = 2
C = 1
MY ID0 3960
MY ID2 3962
C = 3
MY ID1 3961
MY ID3 3963
C = 2
MY ID2 3967
C = 3
MY ID3 3968 
```

为什么 c 改变它的值并且有时会通过同一个地方两次？

这不是 fork() n childs 执行不同进程的正确方法吗？

PS对不起，我的英语不好。我希望你能明白我说的话。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T01:13:35.723

您是否正在考虑这样一个事实，即您的所有分叉进程都会继续迭代 for 循环并分叉更多进程？

考虑第一次迭代：

```
for (c = 0; c < PROCESSES; c++) { // c is 0 
```

我们做一个分叉：

```
 pid[c] = fork(); 
```

现在，在子进程中，`pid[0]`为 0。所以，

```
switch (pid[c]) { 
```

进入：

```
case 0:
       if (c == 0) {
            printf("MY ID0 %d\n", getpid());
            customers();
            break;
        } 
```

并进行一些打印。然后它退出开关。并且`c`是 0。所以它递增`c`到 1，并且：

```
 pid[c] = fork(); 
```

叉个孙子。

为了防止这种情况，您可以`exit`代替`break`：

```
 if (c == 0) {
            printf("MY ID0 %d\n", getpid());
            customers();
            exit(0);
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:13:18.267

首先，`fork`启动并行进程，不保证会顺序运行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T01:14:29.407

对于应该进行特殊处理的进程（即前四个）`fork`，在父进程中为它们中的每一个执行单独的步骤。然后循环创建您可能需要的所有通用流程。

# workflow - Opentext case360 Process Instance WFState -200 是什么意思

> ID：14115831
> 
> 赞同：0
> 
> 时间：2013-01-02T01:10:54.880
> 
> 标签：workflow, opentext

我正在使用 opentext case360 产品

我查看了一个进程表，注意到许多进程实例具有我在帮助文档中查看的 WFState -200 并且 -200 不存在。

有谁知道

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:11:05.523

如果您查看帮助，您将看到 WFState 值的表格。-200 可能是退出活动错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-31T22:08:11.313

WFState 200 表示等待客户端/用户处理实例并将其路由。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-18T05:52:47.603

WFStat -200 表示在项目等待用户处理时存在一些问题。这意味着“客户端访问错误”。您可以将其更新为 200 并尝试锁定该项目。通常这可以工作，但如果它再次变为 -200，您需要检查工具箱中的日志。

注意：所有低于 0 的 WFstates 都是错误状态，它们与相同但为正的状态相关：-200 error > 200 , -100 error > 100

# c++ - 从管道读取时的随机字符

> ID：14115834
> 
> 赞同：6
> 
> 时间：2013-01-02T01:11:16.717
> 
> 标签：c++, operating-system, fork, ipc, pipe

在以下代码中：

```
 ...
    char *message = "This is the message!";
    ...

    printf("Writing to file descriptor FD[%i] \n", fd[1]);
    write( fd[1], message, strlen(message));
    printf("Reading from file descriptor FD[%i] \n", fd[0]);
    read( fd[0], buffer, strlen(message));
    printf("Message from FD[%i] : \"%s\" .\n", fd[0], buffer); 
```

我得到以下输出：

```
 "This is the message!���" . 
```

但是如果我删除“！” 从我的消息中，输出没有随机字符...知道为什么我会出现这 3 个随机字符吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-02T01:15:39.300

当您编写长度消息时`strlen(whatever)`，*不*包括终止 NUL 字符。因此，在另一端出现的*不是*C 字符串，而只是字符的集合。

内存中字符集合之后的*内容*完全取决于您从管道中读取它们之前的内容。由于它不是 C 字符串（如果后面的内存位置恰好*已经*包含 NUL，则可能发生意外除外），因此您不应`printf`使用无界`%s`格式说明符将其传递给。

这里有两种可能性。第一种是将 NUL 字符与数据一起发送，例如：

```
write (fd[1], message, strlen(message) + 1); 
```

或者（可能更好）使用返回值`read`告诉您读取了多少字节，例如：

```
int sz = read (fd[0], buffer, sizeof(buffer));
// should probably check sz here as well.
printf ("Message from FD[%i] : \"%*s\" .\n", fd[0], sz, buffer); 
```

# ajax - ajax nonce wordpress 安全性。我可以用它来保护我的 json 数据不被抓取吗？

> ID：14115837
> 
> 赞同：0
> 
> 时间：2013-01-02T01:13:13.927
> 
> 标签：ajax, wordpress, security, nonce

我正在使用 ajax 构建一个 wordpress 插件，并希望保护 json 数据免受窥探和数据抓取。

我的想法...服务器端，我在表单提交中的隐藏 html 字段中发送随机数到 jquery 脚本。

该脚本通过 GET 来自 php 文件的一些 json 数据请求。

在 php 文件响应 GET 请求之前，它首先检查 nonce 是否有效，如果有效，则返回 json 数据。如果不是，则不返回任何内容/死掉/做一些很酷的事情来锁定该 IP 地址一段时间。

如果爬虫通过 get 请求直接访问数据文件，但 nonce 不正确，则不会返回任何数据。如果一个人偷看数据文件，但他们没有随机数，那么他们什么也看不到……这是正确的吗？我知道 nonce 只使用一次，所以即使他们有一个旧的 nonce，他们仍然无法查看数据，除非 wordpress 生成一个新的 nonce？

这是可能的还是我完全错过了nonce的重点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T02:02:05.827

在我看来，您似乎对 Wordpress nonce 的工作原理有了大致的了解，但无论如何这里有一些阅读：

[Mark Jaquith - WordPress](http://markjaquith.wordpress.com/2006/06/02/wordpress-203-nonces/)
[随机数 Vladimir Prelovac - 在 WordPress 插件中使用随机数](http://www.prelovac.com/vladimir/improving-security-in-wordpress-plugins-using-nonces)

我认为您需要记住以下几点：

1.  如果所有这些功能主要在 Wordpress 的管理员端使用，那么您还必须了解，为了让爬虫被视为威胁，它需要与普通用户相同的凭据。刮刀如何在没有用户名和密码的情况下刮取您的管理面板？它不能。如果您对 Wordpress 自己使用的核心安全性感到满意，那么您的附加 Nonce 功能就是很多闪光和闪光，以消除不存在的威胁。
2.  如果您的敏感数据要与管理面板分开，那么 Nonce 可能是保护它的一种方式，我想，但这真的不是 Nonce 的目的。有许多更简洁的方法可以保护您的信息，而不是依赖于 Wordpress 的 Nonce 功能，因此请考虑寻找更相关的替代方法。
3.  IP Banning 很简洁，但您也必须了解这不是万无一失的方法，因为 IP 地址很容易被伪造，并且可能会产生一些意想不到的后果。您可能能够成功禁止试图访问私人信息的人的 IP 地址，但如果该人试图通过网络进行此操作怎么办？您有效地禁止了整个网络访问您的网站，而不仅仅是一个人。

总而言之，您应该确保为任何特定工作使用正确的工具。我认为将 Nonce 用于此目的当然是可能的，但它远非理想。

# php - PHP检查返回的所有行中是否存在变量

> ID：14115841
> 
> 赞同：1
> 
> 时间：2013-01-02T01:13:46.927
> 
> 标签：php

我想检查我搜索的所有表行中是否存在用户 ID。

*编辑*对不起，我认为我误导了。我想检查用户是否阅读了某个类别中的所有文章，我有一个论坛前端显示类别，类别内是文章。

在类别屏幕上，我想显示一个图像 ALL ARTICLES READ 或 NOT ALL ARTICLES READ，所以我需要循环遍历每个类别的所有文章，这就是下面的示例查询正在做的事情，并检查用户 ID 是否存在于 ALL如果是返回行，那么所有文章都已被阅读 如果有一些行缺少用户 ID，那么一些文章还没有被阅读

这是我的 sql 查询

```
$colname_readposts = "-1";
if (isset($_GET['Thread_Category_Article_id'])) {
$colname_readposts = $_GET['Thread_Category_Article_id'];
}
mysql_select_db($database_test, $test);
$query_readposts = sprintf("SELECT Thread_Article_User_Read FROM Thread_Articles WHERE             Thread_Category_Article_id = %s", GetSQLValueString($colname_readposts, "int"));
$readposts = mysql_query($query_readposts, $cutthroats) or die(mysql_error());
$row_readposts = mysql_fetch_assoc($readposts);
$totalRows_readposts = mysql_num_rows($readposts); 
```

如何检查返回的所有行是否包含用户 ID？这个想法是检查用户是否已阅读所有文章，如果是，则显示 READ，如果没有，则显示 UNREAD。

每行的结果是这样的 0,15,20,37 这些是用户查看帖子时输入的 id。我已经成功地检查了一篇文章，以显示用户是否阅读了一篇特定的文章，但不确定我将如何检查多篇文章：

这是我的单篇文章检查：

```
<?php
$userid = $_SESSION['loggedin_id'];
$userreadlist = $row_readposts['Thread_Article_User_Read'];
$myarray = (explode(',',$userreadlist));
if (in_array($userid,$myarray )){ 
?>
html image READ
<?php } else { ?>
html image UNREAD
<?php } ?> 
```

任何帮助，将不胜感激。卡尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:29:06.807

首先，忘记`mysql_*`功能；*ext/mysql*是 PHP 5.5 的弃用 API - 所以使用 mysqli 或 PDO 是一个非常好的主意。

根据我的收集，您实际上是在尝试查看这些结果是否包含**特定用户的**ID？如果是这样，请在 SQL 查询中执行此操作：

```
SELECT Thread_Article_User_Read FROM Thread_Articles WHERE 
    Thread_Category_Article_id = %s AND UserID = %s 
```

并将此用户 ID 作为第二个参数提供。（语法可能不是 100% 正确，但它应该证明一点）

如果您的意思是要检查是否有**任何用户 ID** - 然后再一次；在 SQL 中执行此操作：

```
SELECT Thread_Article_User_Read FROM Thread_Articles WHERE 
    Thread_Category_Article_id = %s AND UserID IS NOT NULL 
```

这将确保“UserID”的值有效。

*如果您的解决方案基于这些示例之一，自然会用您的列名替换“用户 ID”。*

但是，如果您要从表中导出所有结果 - 并且您需要查看您的用户 ID 是否存在于某个列中（**就像您一样！**）；那么您实际上可以调整您在单个文章页面上使用的逻辑。哪个应该给你这样的东西......

```
$userid = $_SESSION['loggedin_id'];
$colname_readposts = "-1";
if (isset($_GET['Thread_Category_Article_id'])) {
    $colname_readposts = $_GET['Thread_Category_Article_id'];
}

/* connect to db and run query; CHANGE ME TO SOMETHING NOT DEPRECATED */
mysql_select_db($database_test, $test);
$query_readposts =
  sprintf("SELECT Thread_Article_User_Read FROM Thread_Articles WHERE
    Thread_Category_Article_id = %s", GetSQLValueString($colname_readposts, "int"));
$readposts = mysql_query($query_readposts, $cutthroats) or die(mysql_error());

/* loop through all returned items */
while($row = mysql_fetch_assoc($readposts)) {
    /* repeat the check you used on an individual
       row on the single article page. i.e: */

    $userreadlist = $row['Thread_Article_User_Read'];
    $myarray = (explode(',',$userreadlist));

    if (in_array($userid,$myarray )){
        /* user has read */
    } else {
        /* user hasn't read */
    }
} 
```

如果您为单个页面工作的代码那么它应该在上面工作；至于循环的每次迭代，您都在单行上工作 - 就像您在单页上一样。如果数据来自同一个表，那么列名等匹配并且它将起作用。

或者，如果您只是想知道是否有任何未读帖子，请将循环替换为这个...

```
/* loop through all returned items */
$read = true;
while($row = mysql_fetch_assoc($readposts)) {
    /* repeat the check you used on an individual
       row on the single article page. i.e: */

    $userreadlist = $row['Thread_Article_User_Read'];
    $myarray = (explode(',',$userreadlist));

    if (! in_array($userid,$myarray )){
        $read = false;
        break;
    } 
}

if( $read ){
   /* all pages are read */
} else {
   /* there are unread pages */
} 
```

# jquery - 是否可以让 .animate 使用 .each 处理每个元素？

> ID：14115844
> 
> 赞同：2
> 
> 时间：2013-01-02T01:14:12.940
> 
> 标签：jquery, each

作为我网站升级的一部分，我正在为页面底部创建自己的图像滚动条。用户单击向左箭头以滚动图像，使它们全部向左移动，向右移动。我了解如何使用 .each 来影响项目列表，但我无法让它与 .animate jquery 一起使用。任何人都可以对此有所了解吗？我目前的javascript：

```
$('#rightButton').click(function()
{
    $('.galleryItem').each( function( index ) 
    {
            $(this).animate({left:"+=100px"},500);
    }); 
}); 
```

这是它的 jsFiddle：http: [//jsfiddle.net/vLSD3/](http://jsfiddle.net/vLSD3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:16:58.113

您需要使用每个内部的元素进行动画处理。`this`是错误的上下文。

```
$('#rightButton').click(function()
{
 $('.galleryItem').each( function( index, element ) 
 {
    if ($(element).offset().left < 0) 
    {
        $(element).animate({left:"+=100px"},500);
    }
 }); 
}); 
```

这是 jsfiddle 中的一个非常简单的演示：http: [//jsfiddle.net/2Ruuj/](http://jsfiddle.net/2Ruuj/)

# php - 分页语法错误

> ID：14115847
> 
> 赞同：0
> 
> 时间：2013-01-02T01:14:45.707
> 
> 标签：php, mysql, pagination

这应该是一个相当直截了当的问题。我收到一个`Warning: mysql_num_rows() expects parameter 1 to be resource, boolean`错误，我无法找出正确的语法。使用 mysqlerror 我得到`You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '-5, 5'`.

任何帮助都会很棒。该代码是我添加的分页的一部分。

**受影响的代码片段**

```
<?php
//Number of items to display per page  
$perpage = 5;

if(isset($_GET["page"]))
{
    $page = intval($_GET["page"]);
}
else
{
    $page = 1;
}

$calc = $perpage * $page;
$start = $calc - $perpage;
$result = mysql_query("select * from products Limit $start, $perpage");
$rows = mysql_num_rows($result);
echo mysql_error();

if($rows)
{
    $i = 0;
    while($post = mysql_fetch_array($result))
{
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:16:28.100

$start 不能为负数（确实如此）。您应该确保 $page 不小于 1。这应该可以解决您的问题：

```
<?php
 //Number of items to display per page  
 $perpage = 5;
 $page = isset($_GET['page']) ? intval($_GET['page']) : 1;
 if ($page < 1)
 {
   $page = 1;
 }
 $calc = $perpage * $page;
 $start = $calc - $perpage;
 $result = mysql_query("select * from products Limit $start, $perpage");
 $rows = mysql_num_rows($result);
 echo mysql_error();
 if($rows)
 {
  $i = 0;
  while($post = mysql_fetch_array($result))
  {
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T01:16:50.130

当你使用`LIMIT`起点的值应该大于或等于零。

*   [限制](http://php.about.com/od/mysqlcommands/g/Limit_sql.htm)

# jquery - 在同一页面上选择多个表

> ID：14115861
> 
> 赞同：1
> 
> 时间：2013-01-02T01:17:03.247
> 
> 标签：jquery, html, html-table, this

我在同一页面上有几个表。我正在尝试编写 jQuery 代码，该代码将单独计算页面上每个表的行数，并根据行数是偶数还是奇数，对每个单独的表应用不同的 CSS。

使用 jQuery 的 .each 函数，我可以选择每个表。但是我需要一种方法来使用“this”关键字来计算单个表中的行数。如果只有一张桌子我可以使用

```
var amountOfRows = $(".data  tbody  tr").length; 
```

但是由于有多个表，我需要一些包含“this”关键字的代码来单独获取每个行的长度。

所以我真的只是想知道如何使用“this”关键字来读取我页面上每个表格的行数。

这是一个基本的 jsfiddle：http: [//jsfiddle.net/49jNn/1/](http://jsfiddle.net/49jNn/1/)

这是我的 HTML 代码的简化版本，我有 2-4 个页面。

```
<table class="data">
    <thead>
        //head row
    </thead>
    <tfoot>
        //footer row
    </tfoot>

    //I want the number of these rows
    <tr>
        //multiple <td>
    </tr>
    <tr>
        //multiple <td>
    </tr>
    <tr>
        //multiple <td>
    </tr>
</table> 
```

到目前为止，我的 jQuery 代码能够遍历页面上的表数。

```
$('table').each(function() {
    alert("table");
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T01:20:36.217

您可以使用`$(selector, context)`;

```
$('tbody tr', this).length; 
```

或`find`方法：

```
$(this).find('tbody tr').length; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:41:04.260

在您的每个选择器中，您可能想尝试这样的事情，

```
$('table').each(function(e, table) {
    console.log(['Table length', $(table).find('tbody tr').length]);
});​ 
```

其中 e 将是索引，而 table 是每个语句中的当前表。

$(table) 将获取 javascript 对象并将其作为 jQuery 对象引用，这将允许您使用 .find('tbody tr') 获取该表中的行。

# c++ - 如何使用 boost::shared_ptr 构造二叉树

> ID：14115862
> 
> 赞同：1
> 
> 时间：2013-01-02T01:17:04.760
> 
> 标签：c++, boost, binary-tree, shared-ptr

我正在尝试使用 boost 共享指针来构造二叉树并将节点存储在 STL 映射中。我采用了一个常见的二叉树示例，并尝试将指针转换为 shared_ptr，如下所示。我可能让它比需要的更复杂，因为我认为使用模板是个好主意。

```
#include <iostream>
#include <string>
#include <map>
using namespace std;

#include "boost/smart_ptr.hpp"

//typedef boost::shared_ptr<node<int> >  nodePtr;

template <typename T>
class node
{
public:

    T nodeData;
    boost::shared_ptr<node<T> > *left, *right;

    // default constructor. data not initialized
    node() {}

     // initialize the data members
    node (const T& item, 
          boost::shared_ptr<node<T> > lptr = NULL, 
          boost::shared_ptr<node<T> > rptr = NULL) :
          nodeValue(item), left(lptr), right(rptr) {}
};

template <typename T>
void inorderOutput(boost::shared_ptr<node<T> > t)
{
   // the traversal terminates on a empty subtree
   if (t != NULL)
   {
      inorderOutput(t->left);       // descend left
      cout << t->nodeData << ", ";  // output the node
      inorderOutput(t->right);      // descend right
   }
}

int main()
{
    // a few nodes to assemble into a tree
    boost::shared_ptr<node<char> > d( new node<char>('D') );
    boost::shared_ptr<node<char> > e( new node<char>('E') );
    boost::shared_ptr<node<char> > f( new node<char>('F') );
    boost::shared_ptr<node<char> > g( new node<char>('G') );

    boost::shared_ptr<node<char> > b( new node<char>('B',d, e) );
    boost::shared_ptr<node<char> > c( new node<char>('C',f, g) );
    boost::shared_ptr<node<char> > a( new node<char>('A',b, c) );

    // now store the node pointers for later reference
    map<string, boost::shared_ptr<node<char> > > nodeMap;
    nodeMap["D"] = d;
    nodeMap["A"] = a;
    // etc.

    // inorder traversal of nodes  
    cout << "Inorder:      " ;
    inorderOutput(a);
    cout << endl;

    // Test to see if a node has children
    if (( nodeMap["A"]->left != NULL ) || (nodeMap["A"]->right != NULL ) ) 
    {
        cout << "Node A has children!" << endl;
    }

    return 0;
} 
```

我在 Visual Studio Express 2010 中构建并收到以下错误：

```
1>  SharedPtr.vcxproj -> c:\users\john\documents\visual studio 2010\Projects\SharedPtr\Debug\SharedPtr1.exe
2>c:\users\john\documents\visual studio 2010\projects\sharedptr\sharedptr2\sharedptr2.cpp(27): error C2440: 'default argument' : cannot convert from 'int' to 'boost::shared_ptr<T>'
2>          with
2>          [
2>              T=node<char>
2>          ]
2>          No constructor could take the source type, or constructor overload resolution was ambiguous
2>c:\users\john\documents\visual studio 2010\projects\sharedptr\sharedptr2\sharedptr2.cpp(49): fatal error C1903: unable to recover from previous error(s); stopping compilation 
```

显然节点构造函数没有正确定义。我一直在旋转我的轮子一段时间，试图找出我做错了什么（可能是几件事！）。另外，假设我可以编译它，节点子节点的测试是否可以工作？以前的实验让我有理由相信这并不容易。最后，我注释掉了列表顶部的 typdef，因为我也没有正确使用它。任何人都可以建议一种清理此代码的方法吗？

约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T01:21:12.697

改变

```
 node (const T& item, 
      boost::shared_ptr<node<T> > lptr = NULL, 
      boost::shared_ptr<node<T> > rptr = NULL) :
      nodeValue(item), left(lptr), right(rptr) {}
 }; 
```

至

```
 node (const T& item, 
      const boost::shared_ptr<node<T> >& lptr = boost::shared_ptr<node<T> >(), 
      const boost::shared_ptr<node<T> >& rptr = boost::shared_ptr<node<T> >()) :
      nodeValue(item), left(lptr), right(rptr) {}
 }; 
```

正如所指出的，使“左”和“右”成为非指针 boost_shared_ptr。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T01:18:54.973

`NULL`在大多数实现中我会`#define`d 到 0，而且看起来猜测`boost::shared_ptr`不知道如何处理它。

改变

```
boost::shared_ptr<node<T> > *left, *right; 
```

至

```
boost::shared_ptr<node<T> > left, right; 
```

和

```
node (const T& item, 
      boost::shared_ptr<node<T> > lptr = NULL, 
      boost::shared_ptr<node<T> > rptr = NULL) : 
```

至

```
node (const T& item, 
      boost::shared_ptr<node<T> > lptr = boost::shared_ptr<node<T> >(), 
      boost::shared_ptr<node<T> > rptr = boost::shared_ptr<node<T> >()) : 
```

# java - 如何尽可能长时间地保留一些数据，但允许 VM 在需要时释放并重新加载它们？

> ID：14115864
> 
> 赞同：2
> 
> 时间：2013-01-02T01:17:40.607
> 
> 标签：java, android

在我的应用程序中，我想在第一次需要时将一些数据加载到内存中，并将其保留在那里以防应用程序的另一部分想要使用它。可以从几个不同`Activity`的 es 访问相同的数据，但到目前为止，并非所有用户都可以与之交互。因此，当不使用我的应用程序的相关部分时，我希望 Android 可以随意丢弃数据，并在需要时重新加载它们。请注意，我无法预测用户会做什么，所以我希望 Android 仅在一段时间未使用时才释放数据。这样做的好方法是什么？

我想创建一个`class`仅静态使用的，将数据加载到其静态初始化块中。但是，我不确定 Dalvik 是否会丢弃以这种方式存储的任何静态数据。我已经阅读了一些关于类加载器的内容，但我*不知道*在加载我的类时使用了什么加载器以及它如何可能被丢弃。也许有人...？

我想出的另一种方法是使用弱引用来保留数据保存类的实例（显然是非静态的）但在这里我担心 GC 可能会在 no`Activity`当前正在积极操作它时决定它是无用的，即使当内存在那一刻没有关系。（在这种情况下，我想保持加载数据。）

我的数据加载成本很高。如果可能，我希望*仅*在系统内存不足或应用程序退出时销毁它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T01:24:56.827

您可以使用软引用。看一眼：

[http://docs.oracle.com/javase/6/docs/api/java/lang/ref/SoftReference.html](http://docs.oracle.com/javase/6/docs/api/java/lang/ref/SoftReference.html)

使用 SoftReferences，您可以实现您所需要的：“如果可能，我希望仅在系统内存不足或应用程序退出时销毁它。”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-02T01:30:35.103

听起来[SoftReferences](http://docs.oracle.com/javase/7/docs/api/java/lang/ref/SoftReference.html)是您所需要的。当垃圾收集器检测到内存不足时，它们会自行清除。

如果您阅读类 javadoc，它会提供一些关于如何防止最近使用的缓存条目被回收的提示。

* * *

作为记录，类加载器不会帮助您管理类的实例。但是，`static`如果缓存类被卸载，则将缓存设置为 a 应该允许丢弃缓存的对象。

* * *

**跟进**

> 我的数据是一个实体块，将由单个对象表示。

这反而改变了事情。如果你有一个对象要缓存，那么 LRU 就没有意义了。基本上听起来你想尽可能长时间地挂在对象上......而不会因为挂在对象上太久而触发 OOME。这有点难。确实，做一个完美的工作需要*正确地预测用户将要做什么*……这显然是不可能的。

可能最好的策略是利用引用入队机制，并实现队列处理器以在让对象死亡或重新创建软链接之间做出“智能”选择。“智能”可能需要查看有多少可用内存，和/或自上次使用对象以来的时间。但**要小心！！**如果你弄错了，你可能会导致 OOME 或导致平台花费大量时间来破坏垃圾收集器。

> 如果我将缓存设置为保存 1 个对象，这将等同于硬引用，不是吗？

没有。如果您使用`SoftReference`GC 将在内存不足时破坏引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T01:37:49.997

看看 [SoftReference 太早收集垃圾](https://stackoverflow.com/questions/5757969/softreference-gets-garbage-collected-too-early)

如果您希望在应用程序的内存中缓存一些数据，您也可以查看 LruCache。 [http://developer.android.com/reference/android/support/v4/util/LruCache.html](http://developer.android.com/reference/android/support/v4/util/LruCache.html)

对于更长寿命的基于磁盘的缓存，请查看[Android Objects Cache](https://stackoverflow.com/questions/10841470/android-objects-cache/11565802#11565802)

您可以在[https://github.com/JakeWharton/DiskLruCache/找到](https://github.com/JakeWharton/DiskLruCache/)[DiskLruCache](https://github.com/JakeWharton/DiskLruCache/)源

# mysql - 在 mysql 中使用 SUM 和多个连接

> ID：14115867
> 
> 赞同：9
> 
> 时间：2013-01-02T01:18:44.713
> 
> 标签：mysql, database, join, sum, relational-database

我一直在寻找解决方案，有很多类似的问题，但没有任何正确的答案可以帮助我解决问题。

首先，我的问题/问题：

1.  我想对多连接查询中的某些列进行求和和计数
2.  多个连接不可能吗？我必须嵌套`SELECT`查询吗？

这是我的数据库的 SQL 转储示例数据： http: [//pastie.org/private/vq7qkfer5mwyraudb5dh0a](http://pastie.org/private/vq7qkfer5mwyraudb5dh0a)

这是我认为可以解决问题的查询：

```
SELECT firstname, lastname, sum(goal.goal), sum(assist.assist), sum(gw.gw), sum(win.win), count(played.idplayer) FROM player
LEFT JOIN goal USING (idplayer)
LEFT JOIN assist USING (idplayer)
LEFT JOIN gw USING (idplayer)
LEFT JOIN win USING (idplayer)
LEFT JOIN played USING (idplayer)
GROUP BY idplayer 
```

我想要生成的是一个表格，其中目标、助攻、gw、win 和 play 的列是该列中每一行的总和/计数，如下所示：（使用提供的示例数据）

```
+-----------+----------+------+--------+----+-----+--------+
| firstname | lastname | goal | assist | gw | win | played |
+-----------+----------+------+--------+----+-----+--------+
| Gandalf   | The White|   10 |      6 |  1 |   1 |      2 |
| Frodo     | Baggins  |   16 |      2 |  1 |   2 |      2 |
| Bilbo     | Baggins  |    7 |      3 |  0 |   0 |      2 |
+-----------+----------+------+--------+----+-----+--------+ 
```

那么，再次重复上述问题，是否可以通过一个查询和多个连接来实现？

如果您提供解决方案/查询，**请解释！**我是正确的关系数据库的新手，在这个项目之前我从未使用过联接。如果您在必要时避免使用别名，我也将不胜感激。

我已经在没有求和和分组的情况下运行了上面的查询，并且我为我执行的每一列得到了一组行`SELECT`，我怀疑这些行然后被相乘或相加，但我的印象是分组和/或做`sum(TABLE.COLUMN)`会解决这个问题.

另一件事是，我认为，做一个`SELECT DISTINCT`或任何其他`DISTINCT`操作都行不通，因为这会遗漏一些（“重复”）结果。

PS。如果重要的话，我的开发机器是 WAMP，但版本将在 ubuntu/apache/mysql/php 上。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-02T01:54:10.037

要了解为什么您没有得到预期的答案，请查看以下查询：

```
SELECT * FROM player LEFT JOIN goal USING (idplayer) 
```

如您所见，左侧的行与右侧的匹配行重复。每次加入都会重复该过程。这是您查询的原始数据：

```
SELECT * FROM player
LEFT JOIN goal USING (idplayer)
LEFT JOIN assist USING (idplayer)
LEFT JOIN gw USING (idplayer)
LEFT JOIN win USING (idplayer)
LEFT JOIN played USING (idplayer) 
```

然后将这些重复值用于 SUM 计算。需要在连接行之前计算 SUM：

```
SELECT firstname, lastname, goals, assists, gws, wins, games_played
FROM player
INNER JOIN 
  (SELECT idplayer, SUM(goal) AS goals FROM goal GROUP BY idplayer) a
  USING (idplayer)
INNER JOIN
  (SELECT idplayer, SUM(assist) AS assists FROM assist GROUP BY idplayer) b
  USING (idplayer)
INNER JOIN
  (SELECT idplayer, SUM(gw) AS gws FROM gw GROUP BY idplayer) c
  USING (idplayer)
INNER JOIN
  (SELECT idplayer, SUM(win) AS wins FROM win GROUP BY idplayer) d
  USING (idplayer)
INNER JOIN
  (SELECT idplayer, COUNT(*) AS games_played FROM played GROUP BY idplayer) e
  USING (idplayer) 
```

[SQLFiddle](http://sqlfiddle.com/#!2/49864/13)

# c++ - 如何使用 MPIR 库计算 GCD

> ID：14115870
> 
> 赞同：0
> 
> 时间：2013-01-02T01:18:54.417
> 
> 标签：c++, visual-c++, gmp

我在使用算术库方面相对缺乏经验。我需要尝试编写一些代码来计算最大公分母，使用`MPIR`库中的一个函数。我找到了几种方法，我不明白他们定义变量的方式。例如：关于：

```
void mpz_gcd (mpz_t rop, mpz_t op1, mpz_t op2) 
```

我无法理解变量类型以及如何使用它们。谁能向我提供一些简单的代码来向我澄清这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:38:10.257

> 但无法理解变量类型。

如果它是您关心的变量*类型*`mpz`，那么它就是任意精度*整数*（与实数相反）。

就变量本身而言，`rop`是返回变量，将设置为`op1`和的 GCD `op2`。

例如，这里有一个完整的程序来说明该函数的使用：

```
#include <stdio.h>
#include <mpir.h>

int main (void) {
    mpz_t a, b, c;
    mpz_init (a); mpz_init (b); mpz_init (c);

    mpz_set_str (a, "1024", 10);
    mpz_set_str (b, "768", 10);
    mpz_gcd (c, a, b);

    printf ("GCD of "); mpz_out_str (stdout, 10, a);
    printf (" and ");   mpz_out_str (stdout, 10, b);
    printf (" is ");    mpz_out_str (stdout, 10, c);
    putchar ('\n');

    return 0;
} 
```

输出是：

```
GCD of 1024 and 768 is 256 
```

* * *

> 我想生成长位的随机值。

但是，如果（正如您在评论中提到的，虽然很难看出 GCD 计算的适用性）您需要一个 100 位的随机数，您可以使用类似的东西：

```
#include <stdio.h>
#include <time.h>
#include <mpir.h>

int main (void) {
    mpz_t a;
    gmp_randstate_t rstate;

    mpz_init (a);
    gmp_randinit_default (rstate);
    gmp_randseed_ui (rstate, time (0));

    mpz_urandomb (a, rstate, 100);
    printf ("100 random bits gives: "); mpz_out_str (stdout, 10, a);
    putchar ('\n');

    return 0;
} 
```

# javascript - 如何有条件地将模板和 javascript 文件发送到流星中的客户端？

> ID：14115874
> 
> 赞同：3
> 
> 时间：2013-01-02T01:19:27.670
> 
> 标签：javascript, meteor

这与我之前询问的关于在[流星中](http://meteor.com)[有条件地向客户端发送文档数据](https://stackoverflow.com/questions/14074434/how-do-you-conditionally-send-data-to-the-client-in-meteor)的问题有关。

假设我有一个[类似解析的数据编辑器/浏览器](http://blog.parse.com/2012/12/20/the-new-data-browser-2/)，可用于标记为系统管理员的用户帐户，以及一些显示有关应用程序的日志信息的页面。我正在使用[流星路由器](https://github.com/tmeasday/meteor-router)和过滤器来完成此任务。

99% 的用户不需要看到这些界面，但他们的（大量）javascript 仍然发送到客户端。管理员特定的 javascript 和模板被分离到它们自己的文件中，**我如何确保它们不会不必要地发送到客户端（当登录用户不是管理员时）？**

**将管理界面拆分为单独的应用程序并将其指向原始应用程序**的最佳选择真的是 mongo吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:37:03.573

如果您不希望 Meteor 自动加载客户端脚本，您可以将它们放在 /public 目录中，并在需要时自行加载它们。

但是，在管理环境的情况下，从软件开发的角度来看，将所有这些分离到它自己的应用程序中实际上可能会更好，指向同一个数据库，就像你说的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-22T06:20:08.363

目前（2015 年 6 月），[增量模板加载仍在 Meteor Roadmap 上](https://trello.com/c/24s6vyxo/55-incremental-loading)。

最好的解决方案实际上可能是拆分管理应用程序，也是[出于安全原因](https://security.stackexchange.com/questions/55381/is-it-reasonable-to-keep-control-panel-in-separate-subdomain-or-domain/55443#55443)。

如果您确实想将所有内容保存在一个应用程序中，则用于延迟加载的领先社区包是[numtel:lazy-bundles](https://forums.meteor.com/t/lazy-load-source-bundles-with-new-numtel-lazy-bundles-package/5098)。

# java - 如何使用新的 JUnit 4.11 功能，包括更改测试名称和设置执行顺序

> ID：14115876
> 
> 赞同：1
> 
> 时间：2013-01-02T01:19:37.997
> 
> 标签：java, unit-testing, junit, junit4

我正在尝试使用 JUnit 4.11 来设置执行顺序。

我已尝试在 Ecipse IDE 中运行此链接（[更改参数化测试的名称](https://stackoverflow.com/questions/650894/changing-names-of-parameterized-tests)）上的参数化测试示例，但我发现 Eclipse IDE 中显示的测试名称没有任何变化。我希望看到测试名称显示为 test[1: fib(1)=1] 和 test[4: fib(4)=3]，但它们显示为 test[0] 和 test[1]

```
@FixMethodOrder(MethodSorters.NAME_ASCENDING) 
```

在 Eclipse IDE 中运行的以下示例导致以下执行顺序 (b,a,d,c) 而不是预期的 (a,b,c,d)

```
package com.org;
import static org.junit.Assert.*;
import org.junit.Test;
import org.junit.FixMethodOrder;
import org.junit.Test;
import org.junit.runners.MethodSorters;

@FixMethodOrder(MethodSorters.NAME_ASCENDING)
public class ExecutionOrderTestName {

    @Test
    public void bTest() {
        System.out.println("b");
    }

    @Test
    public void aTest() {
        System.out.println("a");
    }

    @Test
    public void dTest() {
        System.out.println("d");
    }

    @Test
    public void cTest() {
        System.out.println("c");
    }
} 
```

测试的顺序没有发生，我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T09:40:43.140

这听起来像您在类路径上有另一个 JUnit。看看有没有，删掉。在 Eclipse 中，您可以查看 Project Properties-> Java Build Path，然后查看 Libraries 选项卡。

# c# - 将视频发送到 youtube Flash 播放器时写入失败

> ID：14115878
> 
> 赞同：0
> 
> 时间：2013-01-02T01:20:28.297
> 
> 标签：c#, youtube

我正在尝试制作的 youtube 缓存有问题（我的互联网连接非常慢）。它通过检测是否请求视频播放页面并将响应保存到磁盘来工作。它适用于 Lightspark 和 FireFox 上的 html5 播放器，但是当我在 Google Chrome 上尝试它时，我在 RespCacheCallback 中遇到写入失败。

我在[这里](http://pastebin.com/FTbg7j1j)有来源，因为发布问题的时间太长了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T12:53:35.477

我在搜索缓存时忘记将范围添加到程序中创建的 ID，这意味着程序会在请求一小部分时尝试发送整个视频，这会使播放器关闭连接。通过将此方法添加到 MainClass 已解决此问题

```
static bool TryGetRange (string url, out string range)
{
    int index = url.IndexOf ("&range=");
    if (index == -1) {
        range = null;
        return false;
    }
    index += 7;
    int len = url.IndexOf ('&',index) - index;
    range = url.Substring (index,len);
    return true;
} 
```

此方法检查`range`参数是否存在于 url 中，然后获取它的值。然后在之前添加此代码`if(File.Exists (requestData.Signature + "_done"))`

```
string range;
if(TryGetRange (requestString, out range))
{       
    requestData.Signature += range;
} 
```

如果检测到范围参数，这会将范围添加到签名中

# xmpp - 为什么'xml-not-formed'？

> ID：14115881
> 
> 赞同：0
> 
> 时间：2013-01-02T01:20:34.093
> 
> 标签：xmpp, sasl

在 xmpp 中使用 sasl

从服务器（sasl 协商）

```
<stream:features><mechanisms xmlns='urn:ietf:params:xml:ns:xmpp-sasl'><mechanism>PLAIN</mechanism><mechanism>DIGEST-MD5</mechanism><mechanism>SCRAM-SHA-1</mechanism></mechanisms><c xmlns='http://jabber.org/protocol/caps' hash='sha-1' node='http://www.process-one.net/en/ejabberd/' ver='TQ2JFyRoSa70h2G1bpgjzuXb2sU='/><register xmlns='http://jabber.org/features/iq-register'/></stream:features> 
```

从客户端发送

```
<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN'>AGlnZW55YXIAMTIzNDU2Nzg=</auth> 
```

其中糟糕的事情是 base64 编码的 "\0login\0password"

从服务器响应

```
<stream:error><xml-not-well-formed xmlns='urn:ietf:params:xml:ns:xmpp-streams'/></stream:error> 
```

任何原因？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:53:19.953

第一个条目在 SCRAM-SHA-1 项之后有一个额外的关闭“机制”标签。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-02T12:47:51.433

正如其他人指出的那样： XML 看起来格式正确。我想你需要重新考虑你的问题。不是“为什么 XML 格式不正确”，而是“为什么**服务器看到此节时会回复**xml-not-well-formated？”

为了回答这个问题，您（没有其他人可以为您做）应该调试服务器实现并找出导致它的原因。

# php - PHP调用未定义的函数

> ID：14115886
> 
> 赞同：35
> 
> 时间：2013-01-02T01:20:54.053
> 
> 标签：php, function

我正在尝试从另一个函数调用一个函数。我收到一个错误：

```
Fatal error: Call to undefined function getInitialInformation() 
in controller.php on line 24 
```

**控制器.php 文件：**

```
require_once("model/model.php"); 

function intake() {
    $info = getInitialInformation($id); //line 24
} 
```

**模型/模型.php**

```
function getInitialInformation($id) {
    return $GLOBALS['em']->find('InitialInformation', $id);
} 
```

已经尝试过的事情：

1.  验证 require_once 有效，并且文件存在于指定位置。
2.  验证该函数是否存在于文件中。

我无法弄清楚这一点。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2014-03-28T20:59:00.623

## 如何重现错误，以及如何修复它：

1.  将此代码放在一个名为的文件中`p.php`：

    ```
    <?php
    class yoyo{
        function salt(){
        }
        function pepper(){
            salt();
        }
    }
    $y = new yoyo();
    $y->pepper();
    ?> 
    ```

2.  像这样运行它：

    ```
    php p.php 
    ```

3.  我们得到错误：

    ```
    PHP Fatal error:  Call to undefined function salt() in 
    /home/el/foo/p.php on line 6 
    ```

4.  解决方案：使用`$this->salt();`代替`salt();`

    所以改为这样：

    ```
    <?php
    class yoyo{
        function salt(){
        }
        function pepper(){
            $this->salt();
        }
    }
    $y = new yoyo();
    $y->pepper();

    ?> 
    ```

如果有人可以发布为什么在类中的 PHP 函数之前必须使用 $this 的链接，是的，那会很棒。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-01-02T02:04:14.787

这是一个开发人员的错误 - 一个放错位置的结束大括号，这使得上述函数成为一个**嵌套函数**。

我看到很多与 SO 中的未定义函数错误相关的问题。让我记下这个作为答案，以防其他人对**function scope**有同样的问题。

我首先尝试解决的问题：

1.  搜索其中包含函数定义的 php 文件。验证文件是否存在。
2.  验证页面中存在上述文件的*require*（或*include ）语句。**此外，验证了require/include*中的绝对路径是正确的。
3.  验证文件名在 require 语句中的拼写是否正确。
4.  在包含的文件中回显一个单词，以查看它是否已正确包含。
5.  在文件末尾定义了一个单独的函数，并调用它。它也奏效了。

很难跟踪大括号，因为函数很长 - 遗留系统的问题。进一步的故障排除步骤如下：

1.  我已经在包含文件的末尾定义了一个简单的打印函数。我将它移到“未定义函数”的正上方。这也使它未定义。
2.  确定这是一些范围问题。

3.  使用 Netbeans 折叠（代码折叠）功能来检查此功能之上的功能。因此，上面的 1000 行函数与这个函数一起折叠，使其成为一个嵌套函数。

4.  确定问题后，将函数剪切粘贴到文件末尾，从而解决了问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-09-26T21:08:11.123

很多时候出现问题是因为`php`不支持`php.ini`文件中的短打开标签，即：

```
<?
   phpinfo();
?> 
```

您必须使用：

```
<?php
   phpinfo();
?> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-02T01:54:12.373

您的函数可能与您调用它的名称空间不同。

[http://php.net/manual/en/language.namespaces.basics.php](http://php.net/manual/en/language.namespaces.basics.php)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-30T09:32:13.970

当其他主机上的一切正常时，我在虚拟服务器上发生了这个问题。经过几次修改后，我意识到我`include`或`require_one`可以处理除文件之外的所有调用。这个文件的问题是代码`< ?php ? >`在文本的开头和结尾。它只是一个脚本`< ?`，并且在那个运行的 apache 版本中不起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-09T10:00:04.827

目前我正在处理定义了我的函数的 Web 服务，它抛出了一个错误未定义的函数。我只是在 codeigniter 的 autoload.php 中添加了这个

$autoload['helper'] = array('common','security','url');

common 是我的控制器的名称。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-29T03:32:22.900

请检查`<?PHP`您的代码顶部是否有。如果忘记了，就会出现这个错误。

# java - 更改时间显示的格式

> ID：14115887
> 
> 赞同：0
> 
> 时间：2013-01-02T01:21:00.403
> 
> 标签：java, android, time, format

我正在使用以下代码在我的应用程序中显示一个计时器（在名为“时间”的 editText 中）

```
final TextView time = (TextView) findViewById(R.id.txtTime);
Long spentTime = System.currentTimeMillis() - startTime;
Long minius = (spentTime/1000)/60;
Long seconds = (spentTime/1000) % 60;
time.setText(minius+":"+seconds);
handler.postDelayed(this, 1000); 
```

这很好用，但格式有点难看。因此，例如在 4 秒时，计时器显示“0:4”，这看起来并不像计时器。

如何更改 setText 的格式，使其显示更常用的计时器（例如 00:04），而不必制作一堆 if 语句（如果秒小于 10 则 0+秒等等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:29:08.867

您可以使用's`String.format`填充数字：`0`

```
String formattedTime = String.format("%02d:%02d", minius, seconds);
time.setText(formattedTime); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:33:06.217

您需要使用`String.format`命令设置前导 0。尝试：

```
time.setText(String.format("%02d",minius) + ":" + String.format("%02d",seconds)); 
```

当它只有一个时，它总是给你两个数字，以 0 开头。

# google-analytics - 两次调用 trackPageview 时的 Google Analytics（分析）行为

> ID：14115892
> 
> 赞同：2
> 
> 时间：2013-01-02T01:22:13.343
> 
> 标签：google-analytics

我有一个使用谷歌分析的网站。在一个页面上单击一个按钮会改变页面的所有内容。但是，它不会更改页面的 URL。我想在 Google Analytics 中将其作为单独的页面进行跟踪。所以我会假设我会`trackPageview("/new")` *（或真的`_gaq.push(['_trackPageview',"/new");`）*，**但是在我实现这个之前，我想确保事件等不会被计算两次。**

也就是说，如果我要加载页面`/`（并发生默认的 trackPageview 调用）然后调用`trackPageview("/new")`并最终调用事件`trackEvent("Test",…)`会`Test`反映在 上`/`，`/new`还是两者都反映？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T22:02:54.520

在您的示例中，“测试”将反映在“/”上，因为那是 window.location.pathname。

有一个名为 _set 的未记录的 GA 函数，您可以在其中覆盖变量，如下面的代码：

```
_gaq.push(['_set','page','/new']);
_gaq.push(['_trackPageview']);
$("#submit-button).click(function () {
   _gaq.push(['_trackevent']); // tracks to '/new'
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T02:29:44.460

在进行了一些测试之后，无论是否推送新的综合浏览量，它看起来似乎都会`Test`显示该事件。`/`

# javascript - 渲染原始 HTML

> ID：14115893
> 
> 赞同：26
> 
> 时间：2013-01-02T01:22:14.077
> 
> 标签：javascript, node.js, express

我想`.html`使用 Express 3 渲染原始页面，如下所示：

```
server.get('/', function(req, res) {
    res.render('login.html');
} 
```

这就是我配置服务器以呈现原始 HTML 页面的方式（灵感来自[这个过时的问题](https://stackoverflow.com/questions/4529586/render-basic-html-view-in-node-js-express)）：

```
server
    .set('view options', {layout: false})
    .set('views', './../')
    .engine('html', function(str, options) {
        return function(locals) {
             return str;
        };
    }); 
```

不幸的是，使用这种配置，页面会挂起并且永远不会正确呈现。我做错了什么？如何在没有 Jade 和 EJS 等花哨的渲染引擎的情况下使用 Express 3 渲染原始 HTLM？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-01-09T19:56:42.253

我想你想说的是：我怎样才能提供静态 html 文件，对吧？

让我们开始吧。

首先，我自己项目中的一些代码：

```
app.configure(function() {
    app.use(express.static(__dirname + '/public'));
}); 
```

这意味着我的 app 文件夹中有一个名为 public 的文件夹。我所有的静态内容，例如 css、js 甚至 html 页面都在这里。

要实际发送静态 html 页面，只需将其添加到您的应用程序文件中

```
app.get('/', function(req, res) {
  res.sendFile(__dirname + '/public/layout.html');
}); 
```

因此，如果您有一个名为 xyz.com 的域；每当有人去那里，他们将在他们的浏览器中看到 layout.html。

**编辑**

如果您使用的是 express 4，情况会有所不同。路由和中间件的执行顺序与它们的放置顺序完全相同。

一种好的技术是将静态文件服务代码放在所有标准路由之后。像这样 ：

```
// All standard routes are above here
app.post('/posts', handler.POST.getPosts);

// Serve static files
app.use(express.static('./public')); 
```

这非常重要，因为它可能会消除代码中的瓶颈。看看这个[stackoverflow 的答案](https://stackoverflow.com/questions/12695591/node-js-express-js-how-does-app-router-work)（第一个他谈到优化的地方）

express 4.0 的另一个主要变化是您不需要使用 app.configure()

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-01-02T03:27:00.760

如果您实际上不需要向模板中注入数据，express 中最简单的解决方案是使用静态文件服务器（`express.static()`）。

但是，如果您仍想手动连接到页面的路由（例如，您的示例映射 '/' 到 'login.html'），您可以尝试`res.sendFile()`发送您的 html 文档：

[http://expressjs.com/api.html#res.sendfile](http://expressjs.com/api.html#res.sendfile)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-01-02T02:39:02.757

您是否尝试过使用 fs 模块？

```
server.get('/', function(req, res) {
    fs.readFile('index.html', function(err, page) {
        res.writeHead(200, {'Content-Type': 'text/html'});
        res.write(page);
        res.end();
    });
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-01-06T10:03:06.803

正如文档所说：'Express 期望：（路径，选项，回调）' app.engin(...) 中的格式函数。

所以你可以像下面这样编写你的代码（为简单起见，但它有效）：

```
server
.set('view options', {layout: false})
.set('views', './../')
.engine('html', function(path, options, cb) {
    fs.readFile(path, 'utf-8', cb);
}); 
```

当然就像 2# & 3# 说的，你应该使用 express.static() 进行静态文件传输；上面的代码不适合生产

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-01-11T10:23:27.400

首先，您犯的错误是尝试使用 express 2.x 代码片段在 express 3.0 中呈现原始 HTML。从 express 3.0 开始，只会将文件路径而不是文件内容传递给查看引擎。

来到解决方案，

**创建一个简单的视图引擎**

```
var fs = require('fs'); 

function rawHtmlViewEngine(filename, options, callback) {
    fs.readFile(filename, 'utf8', function(err, str){
        if(err) return callback(err);

        /*
         * if required, you could write your own 
         * custom view file processing logic here
         */

        callback(null, str);
    }); 
} 
```

**像这样使用它**

```
server.engine('html', rawHtmlViewEngine)
server.set('views', './folder');
server.set('view engine', 'html'); 
```

**参考**

官方 express 2.x 到 3.x 迁移指南

请参阅此网址中的“模板引擎集成”部分 [https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-09-04T07:23:37.773

全新安装最新版 Express 后

```
express the_app_name 
```

创建一个包含**app.js**的骨架目录。

**app.js**中有一行内容如下：

```
 app.use(express.static(path.join(__dirname, 'public'))); 
```

所以一个名为**public**的文件夹是魔法发生的地方......

然后通过以这种方式建模的函数完成路由：

```
app.get('/', function(req,res) {
      res.sendfile('public/name_of_static_file.extension');
    }); 
```

****示例：* ***公用文件夹中 的**index.html在由以下行调用时提供：**

```
 app.get('/', function(req,res) {
  res.sendfile('public/index.html');
}); 
```

就资产而言：确保从相对于公用文件夹的文件夹中调用 css 和 javascript**文件**。

vanilla Express 安装将具有**样式表**、**javascripts**和用于启动文件夹的**图像。**因此，请确保脚本和 css 工作表在**index.html**中具有正确的路径：

例子：

```
<link href="stylesheets/bootstrap.css" rel="stylesheet"> 
```

或者

```
<script src="javascripts/jquery.js"></script> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-19T19:33:32.373

您可以使用以下代码快速呈现 .html 页面：-

```
var app = express();

app.engine('html', ejs.__express); 
```

在渲染时，您可以使用以下代码：-

```
response.render('templates.html',{title:"my home page"}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-21T00:17:15.900

我想这样做是因为我正在创建一个不想绑定到视图引擎的样板 NodeJS 服务器。为此，拥有一个简单地返回 (html) 文件内容的占位符渲染引擎是很有用的。

这是我想出的：

```
//htmlrenderer.js

'use strict';

var fs = require('fs'); // for reading files from the file system

exports.renderHtml = function (filePath, options, callback) { // define the template engine
    fs.readFile(filePath, function (err, content) {
        if (err) return callback(new Error(err));
        var rendered = content.toString();
        // Do any processing here...
        return callback(null, rendered);
    });
}; 
```

要使用它：

```
app.engine('html', htmlRenderer.renderHtml);
app.set('view engine', 'html'); 
```

来源：[http ://expressjs.com/en/advanced/developing-template-engines.html](http://expressjs.com/en/advanced/developing-template-engines.html)

欢迎评论和建设性反馈！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-19T10:31:52.097

多年后，这里有一个新的答案。

实际上这种方法就像`skypecakes`答案一样；

```
var fs = require('fs');

app.get('/', function(req, res, next) {
    var html = fs.readFileSync('./html/login.html', 'utf8')
    res.send(html)
}) 
```

就这样...

此外，如果将使用 EJS 或 Jade，则可以使用以下代码：

```
var fs = require('fs');

app.get('/', function(req, res, next) {
    var html = fs.readFileSync('./html/login.html', 'utf8')
    res.render('login', { html: html })
}) 
```

并且`views/login.ejs`文件仅包含以下代码：

```
<%- locals.html %> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-09-21T19:46:15.217

```
app.get('/', function(req, res) {
  returnHtml(res, 'index');
});

function returnHtml(res, name) {
  res.sendFile(__dirname + '/' + name + '.html');
} 
```

并将您的 index.html 放到您的根页面，当然您可以创建一个 /views 文件夹并扩展 returnHtml() 函数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-09-04T12:22:07.030

您可以使用 res.sendFile() 发送文件。您可以将所有 html 文件保存在 views 文件夹中，并可以在 options 变量中设置它的路径。

```
app.get('/', (req, res)=>{
    var options = {  root: __dirname + '/../views/' };
      var fileName = 'index.html';
      res.sendFile(fileName, options);
}); 
```

# python - 使用 Python 重命名文件

> ID：14115895
> 
> 赞同：0
> 
> 时间：2013-01-02T01:22:31.940
> 
> 标签：python, file, operating-system, file-rename

我正在尝试使用 python 重命名具有此命名约定的 windows 目录中的 1000 多个文件：

```
The.Woman.In.Black.2012.720p.BluRay.x264 
```

**所需的命名约定是：** `The Woman In Black {2012}`

我需要原始名称中唯一重要的东西是标题和日期....

我尝试过使用不同的字符串操作变体，但我一无所获。我需要帮助开始。

我知道我应该使用 os 模块来重命名文件，但是我应该尝试使用什么程序来完成这项任务？

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T01:52:26.397

```
filename = 'The.Woman.In.Black.2012.720p.BluRay.x264'

# using regular expressions
import re
title, year = re.match('(.*?)\.(\d{4})\.720p\.BluRay\.x264', filename).groups()

# simpler regular expression, matching any format specifiers
title, year = re.match('(.+)\.(\d{4})\.', filename).groups()

# using simple string manipulation if the suffix is always the same
title, year = filename[:-22], filename[-21:-17]

# normalize title
title = title.replace('.', ' ')

# build new filename
print('%s {%s}' % (title, year)) # The Woman In Black {2012} 
```

要重命名文件，请使用[`os.rename`](http://docs.python.org/3/library/os.html#os.rename); 遍历目录，使用[`glob.glob`](http://docs.python.org/3/library/glob.html#glob.glob)or [`os.walk`](http://docs.python.org/3/library/os.html#os.walk)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T05:20:25.600

看起来您的标题的一般格式是：

```
name.name.name.name.name.date.resolution.format.codec 
```

在这种情况下，我会这样做（未经测试）：

```
import os

TARGET_DIR = r'/path/to/movies/'

for old_title in os.listdir(TARGET_DIR + '*'):
    words = old_title.split('.')
    date = words[-4]
    name = ' '.join(words[:-4])
    new_title = '%s {%s}' % (name, date)
    old_title = os.path.join(TARGET_DIR, old_title)
    new_title = os.path.join(TARGET_DIR, new_title)
    os.rename(old_title, new_title) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T01:28:14.230

如果原始命名约定是一致的，您可以在 '.' 上[拆分](http://www.tutorialspoint.com/python/string_split.htm)原始文件名字符串。字符，然后查找有效年份，添加大括号，并将其与所有前面的标记[连接起来以形成新名称。](http://www.tutorialspoint.com/python/string_join.htm)

有关如何使用 python 重命名文件的信息，请参阅[此问题。](https://stackoverflow.com/questions/2491222/how-to-rename-a-file-using-python)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T01:43:02.370

```
def change_filename(name):
    filename = name.split('.')
    wordlist = filename[:-4]
    extension = '.' + filename[-1]
    wordlist[-1] = '{' + wordlist[-1] + '}'
    os.rename(name, ' '.join(wordlist) + extension) 
```

这个函数应该做你想要的，你只需要给它提供名字。

注意：您可能希望在文件名上添加文件扩展名，否则它可能会变得很奇怪。

如果你在同一个文件上多次运行它，你会得到一个用大括号重载的文件，你不希望这样，所以这里有一个反转函数：

```
def filename_cleanup(name):
    filename = name.replace('{', '').replace('}', '')
    wordlist = filename.split(' ')
    extension = '.' + wordlist.pop()
    wordlist[-1] = '{' + wordlist[-1] + '}'
    os.rename(name, ' '.join(wordlist) + extension) 
```

那应该再次为您提供正确的文件名。

# php - php crypt() 函数返回“奇怪的结果”

> ID：14115896
> 
> 赞同：0
> 
> 时间：2013-01-02T01:22:36.743
> 
> 标签：php, mysql, linux, crypt, ubuntu-12.10

我正在为我的一个 android 应用程序编写登录系统。我正在使用 mysql 和 php 登录系统，使用来自 android 应用程序的 post 请求进行登录。请注意，该帐户也是由设备创建的（正在注册），现在这是问题所在。

crypt 函数似乎添加了很多额外的东西，它包含正确的散列密码，但它与数据库中的不同，如果我告诉你最好：

我数据库中的密码：**$6$WX6WbSQfm5iN$vx/B9TKLkcnVDxIPvKc9TUzpWLjD77mlCk**

确保使用正确的密码并像这样使用此功能

```
crypt($userPasswordFromPost, $encryptedPasswordFromDB) 
```

返回这样的值：**$6$WX6WbSQfm5iN$vx/B9TKLkcnVDxIPvKc9TUzpWLjD77mlCk** kOj43jHRW25ecYfbhgGtm27tVG9oSGHqaKrOugYrBpjwzZ//gel0

请注意，我必须放置一个空格来加粗上面的字符串，但是没有空格是该函数返回的完整字符串，因为您可以看到正确的散列密码后面有很多废话。

```
System info
 running on: Ubuntu Linux 12.10 (64 bit)
 php version: PHP 5.4.6-1ubuntu1.1 (cli) 
```

可根据要求提供更多信息。任何帮助都会被极大地接受！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T16:03:19.907

好吧，我在这个时候觉得很愚蠢。我的 mysql 数据库密码字段仅限于 varchar(50)，所以它切断了密码，他们不可能相等。我将数据库字段增加到 200 位，但我不想再冒险了。谢谢大家的时间，感谢查尔斯发现问题

# php - 我怎样才能让函数看到它外面的变量

> ID：14115899
> 
> 赞同：1
> 
> 时间：2013-01-02T01:23:05.937
> 
> 标签：php

如何在函数运行时将变量放置在函数中以便 preg_match 正确的信息。这是我现有的代码：

```
$username = "test";
function is_txt($file) {
return preg_match('/backup-[0-9]+\.[0-9]+\.[0-9]+_[0-9]{2}-[0-9]{2}-[0-9]{2}_'.$username.'.tar.gz/', $file) > 0;
} 
```

我正在尝试做的是从函数外部提取 $username 变量并允许在其中看到它，这样我就可以在我的 while 循环中提取正确的匹配项。虽然前一个返回空白，但如果我执行以下操作，它会起作用：

```
$username = "test";
function is_txt($file) {
$username = "test";
return preg_match('/backup-[0-9]+\.[0-9]+\.[0-9]+_[0-9]{2}-[0-9]{2}-[0-9]{2}_'.$username.'.tar.gz/', $file) > 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:25:58.307

修改函数以将`$username`变量作为参数：

```
function is_txt($file, $u) {
return preg_match('/backup-[0-9]+\.[0-9]+\.[0-9]+_[0-9]{2}-[0-9]{2}-[0-9]{2}_'.$u.'.tar.gz/', $file) > 0;
} 
```

然后这样称呼它：

```
$username = "test";
is_txt($file, $username); 
```

或者，您可以使用`global`关键字使变量在函数中可见。这有时很有用，但不应该到处使用。有关更多信息，请参阅[变量范围](http://php.net/manual/en/language.variables.scope.php)手册条目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:26:08.970

您需要使用以下命令导入 var `global`：

```
function is_txt($file) {
    global $username;
    return preg_match('/backup-[0-9]+\.[0-9]+\.[0-9]+_[0-9]{2}-[0-9]{2}-[0-9]  {2}_'.$username.'.tar.gz/', $file) > 0;
} 
```

但是在大多数情况下，将值作为参数传递给 Jonah 是一个更好的解决方案。

# c++ - CUDA内核调用阻塞？

> ID：14115901
> 
> 赞同：1
> 
> 时间：2013-01-02T01:23:10.400
> 
> 标签：c++, cuda, blocking

我在 Arch Linux 上运行：

我在多个地方读到内核调用相对于 CPU 是异步的（将立即返回并允许 CPU 继续）。但是，我没有得到这种行为。

例如

```
kernel<<<blocks,threads>>>();
printf("print immediately\n"); 
check_cuda_error(); 
```

CPU 似乎被锁定并且在内核完成之前没有任何东西被打印（同样没有其他任何东西被执行）到控制台。使用各种不同执行时间（1s、2s、3s 等）的内核进行测试，并进行计算以确保它不是我的内核。

这是驱动问题吗？还是我误解了什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T03:18:52.417

我发现当我在 X 之外（在非图形环境中）运行时，我得到了预期的行为。我的假设是，当我的 GPU 在内核中努力工作时，它并没有更新屏幕图形，因此在打印到控制台之前似乎“挂起”。

从 shell 运行提供了预期的结果，所以我正在考虑回答我自己的问题。在下面发表评论，了解您可能有的更多见解

# javascript - 为什么在 JavaScript 中使用 {} != ( {} )？

> ID：14115902
> 
> 赞同：15
> 
> 时间：2013-01-02T01:23:17.330
> 
> 标签：javascript

众所周知，`{}`定义对象的更短方法`[]`是数组。

但现在我想知道为什么：

```
{} != ({}) 
```

*   `{}`评估为未定义
*   `({})`评估为“正确”对象

为什么 JavaScript 会这样？

例如`1`等于`(1)`，那为什么`{}`不等于`({})`呢？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-02T01:25:12.223

```
{} != ({}) 
```

这是一个语法错误。

> SyntaxError：意外的令牌！=

`{}`像那样模棱两可。它是一个空块，还是一个空对象字面量？它失败了，因为比较运算符不能跟随一个块。

用括号括起来使解析器将其视为表达式。表达式不能包含块，因此它知道它是一个对象。

但是，如果您将该比较包装在表达式中...

```
({} != ({})) 
```

...这仍然是正确的，因为具有分配给它们的值的对象的变量是指向它们的*指针*，因此，它们永远不会被它们的内容复制（尽管这与您的示例无关）。因此，它们的指针总是不同的，比较失败。

这也意味着比较指向同一对象的两个变量将按预期工作，因为它们的指针是相同的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-02T01:25:03.180

`{} != {}`是真的，因为两者`{}`都是完全不同的对象。但是，引用同一对象的变量保持相等：

```
​var a = {},
    b = a;

assert( a == b )​ 
```

# php - $_POST 不工作。“注意：未定义的索引：用户名...”

> ID：14115904
> 
> 赞同：4
> 
> 时间：2013-01-02T01:23:33.803
> 
> 标签：php, http-post, undefined-index

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-02T01:33:13.373

*未定义的索引*意味着在 $_POST 数组中的某处，键**username**没有索引（键） 。

您应该将发布的值设置为变量以获得更干净的解决方案，这是一个好习惯。

如果我遇到类似的错误，我会这样做：

```
$username = $_POST['username']; // you should really do some more logic to see if it's set first
echo $username; 
```

如果用户名没有出现，那意味着我在某个地方搞砸了。你也可以，

```
var_dump($_POST); 
```

查看您发布的内容。就调试而言，var_dump 非常有用。看看：[var_dump](http://php.net/var_dump)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-02T01:28:44.197

首先，

确保有帖子

```
if(isset($_POST['username'])) { 
    // check if the username has been set
} 
```

其次，也是最重要的，清理数据，这意味着

```
$query = "SELECT password FROM users WHERE username='".$_POST['username']."'"; 
```

是致命的危险，而是使用

```
$query = "SELECT password FROM users WHERE username='".mysql_real_escape_string($_POST['username'])."'"; 
```

请研究主题[sql注入](http://en.wikipedia.org/wiki/SQL_Injection)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T01:26:51.073

您应该检查是否`POST['username']`已定义。在上面使用这个：

```
$username = "";

if(isset($_POST['username'])){
    $username = $_POST['username'];
}

"SELECT password FROM users WHERE username='".$username."'" 
```

# c# - PostSharp的任何免费替代品

> ID：14115909
> 
> 赞同：15
> 
> 时间：2013-01-02T01:24:50.560
> 
> 标签：c#, asp.net-mvc, caching, azure

我们正在构建的应用程序会定期发送不同类型的电子邮件。我将电子邮件模板存储在 Azure blob 存储中，负责发送电子邮件的方法从那里提取适当的电子邮件模板。如果我想更新它，我希望模板位于托管服务之外，我可以通过将新模板上传到 blob 来做到这一点。

从性能和成本的角度来看，我遇到的问题是电子邮件模板很少在 24 小时内更改。因此，以类似于 `[OutputCache(Duration = duration, VaryByParam = "id")]`ASP.NET MVC 的方式缓存该方法将是提高辅助角色性能的理想解决方案。如何做到这一点现在是一个问题。我了解了[PostSharp](http://www.sharpcrafters.com/purchase)，但我们的预算从一开始就没有考虑 PostSharp 的许可费！

还有其他免费的替代品吗？感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T09:15:43.940

PostSharp Starter Edition 是免费的，可以满足您的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T05:04:39.233

我过去使用以下组合实现了方法级缓存：

1.  [Autofac](http://code.google.com/p/autofac/)作为 IoC 容器
2.  Autofac 的[MVC3 集成](https://nuget.org/packages/Autofac.Mvc3)包
3.  用于拦截支持的 Autofac 的 DynamicProxy2 [(castle)](http://code.google.com/p/autofac/wiki/DynamicProxy2)集成
4.  自定义属性来装饰需要缓存支持的类
5.  自定义拦截器以添加方法级缓存

自定义属性和拦截器很容易设置。我相信，方法级缓存的主要问题是如何以最佳但精确的方式确定缓存命中和未命中。

在我的情况下，它需要是通用的（支持任何类型的方法调用和参数），所以我必须创建一种灵活的方法来散列所有方法参数值，以便区分一个调用和另一个调用。但是在您的情况下，这实际上可能是一个非常具体的拦截器，它已经知道您的方法调用的结构，这将使事情变得容易得多。

现在关于实际缓存，您可以利用命名空间中提供的 .NET 缓存支持，如果适合您`System.Runtime.Caching`，它已经提供了[MemoryCache 。](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T07:23:07.707

我用过几次[SNAP 。](https://github.com/TylerBrinks/Snap/wiki)它是免费的，并且非常容易设置和使用许多 IoC 容器

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T01:44:27.640

您是否考虑过使用[本地存储资源](http://msdn.microsoft.com/en-us/library/ee758708.aspx)将模板从存储中拉出？您可以在[RoleEntryPoint的](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx)**Run**方法中配置间隔。

[更新]

上面我可能没有说清楚。模板应存储在 Blob 存储中。本地存储将用于在服务的每个实例上本地缓存模板的副本。如果您将 ETag 存储在单独的文件中，这将允许您在传输 blob 之前验证模板已更改，即：

*   欢迎.tpl
*   欢迎.tag.tpl

在 RoleEntryPoint 中，从 *.tag.tpl 文件中读取 etag。[使用条件标头](http://msdn.microsoft.com/en-us/library/dd179371.aspx)提交针对 blob 存储的请求，并通过**If-None-Match**访问条件传递**Etag 。**如果 blob 尚未更新，它将返回**HTTP 304 Not Modified**响应代码，如果已更新，则将下载 blob。

 ****[/更新]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T09:19:28.267

如果你只想要 AOP 功能，你可以使用 Ninject Interception 之类的东西。

[http://codepyre.com/2010/03/using-ninject-extensions-interception-part-1-the-basics/](http://codepyre.com/2010/03/using-ninject-extensions-interception-part-1-the-basics/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-13T12:04:10.100

您可以尝试使用 KingAOP - 轻松完成此类任务。主要区别在于：
1）在运行时生成代码而不浪费额外的编译时间。
2) 基于“动态” - 这意味着您的代码将通过官方 C# 编译器生成。

开源项目：[https ://github.com/AntyaDev/KingAOP](https://github.com/AntyaDev/KingAOP)

看看文章： http:
[//www.codeproject.com/Tips/624586/Introducing-the-KingAOP-Framework-Part-1](http://www.codeproject.com/Tips/624586/Introducing-the-KingAOP-Framework-Part-1)****

# windows - 如何绕过权限被拒绝错误？

> ID：14115917
> 
> 赞同：3
> 
> 时间：2013-01-02T01:25:40.507
> 
> 标签：windows, r, shapefile

以下示例将点 shapefile 写入光盘。但是，当脚本尝试将 shapefile 写入 C:/ 时出现错误。我可以写入外部硬盘驱动器（G：/）。以下是我在 R 中收到的错误：

> 文件中的错误（out.name，“wb”）：无法打开连接另外：警告消息：在文件中（out.name，“wb”）：无法打开文件'c：/test.shp'：权限被拒绝

**如何绕过或解决此错误？**

```
# available from: cran.r-project.org/web/packages/shapefiles/shapefiles.pdf
# Samples of using the convert.to.shapefile function to write out simple shapefiles
# from basic R data.frames

require(shapefiles)
require(maptools)

dd <- data.frame(Id=c(1,2),X=c(3,5),Y=c(9,6))
ddTable <- data.frame(Id=c(1,2),Name=c("Item1","Item2"))
ddShapefile <- convert.to.shapefile(dd, ddTable, "Id", 1)
write.shapefile(ddShapefile, "C:/test", arcgis=T)
shape <- readShapePoints("C:/test")
plot(shape) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T02:12:14.767

简单的回答，不要写入系统卷的根目录。

在 的根目录下创建文件/目录有几个很好的理由`C:`，但这不是其中之一。改为使用`C:/Temp/test`。

# python - Python正则表达式问号运算符不起作用？

> ID：14115922
> 
> 赞同：9
> 
> 时间：2013-01-02T01:26:05.700
> 
> 标签：python, regex, capture, optional

```
import re
str='abc defg'
m1 = re.match(".*(def)?",str)
m2 = re.match(".*(def)",str)
print (m1.group(1),m2.group(1)) 
```

上面的输出是：

> （无，'def'）

到底是怎么回事？即使使用非贪婪重复运算符，可选的捕获组`(def)?`也不匹配。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-02T02:16:50.800

以下是当正则表达式引擎尝试匹配时发生的`.*(def)`情况`abc defg`：

*   首先，引擎开始尝试匹配字符串开头的正则表达式。
*   贪心子模式`.*`最初尝试尽可能多地匹配，匹配整个字符串。
*   由于这会导致匹配的其余部分失败，因此正则表达式引擎会回溯，直到找到匹配 的方法，这在仅匹配`(def)`时发生。`.*``abc `

但是，如果我们将正则表达式更改为 ，则会`.*(def)?`发生以下情况：

*   首先，正则表达式引擎再次从字符串的开头开始。
*   接下来，它再次尝试`.*`尽可能多地匹配，匹配整个字符串。
*   但是此时，由于正则表达式的所有其余部分都是可选的，因此它找到了整个正则表达式的匹配项！由于`(def)?`是贪心的，如果可以的话，引擎*会*更愿意匹配它，但它不会回溯早期的子模式只是为了看看它是否可以。相反，它只是让`.*`吞噬整个字符串，没有留下任何`(def)?`.

类似的事情发生在`.*?(def)`and上`.*?(def)?`：

*   同样，引擎从字符串的开头开始。
*   不贪婪的子模式`.*?`尝试尽可能*少*地匹配，即根本不匹配。
*   那时，`(def)`不能匹配，但`(def)?`可以。因此，对于`(def)`正则表达式引擎必须返回并考虑更长的匹配，`.*?`直到它找到一个允许完整模式匹配的匹配，而对于`(def)?`它不必这样做，所以它没有。

有关更多信息，请参阅[Perl 正则表达式手册的“组合 RE 片段”部分](http://perldoc.perl.org/perlre.html#Combining-RE-Pieces)（它与 Python 的“Perl 兼容”正则表达式的行为相匹配）。

# php - 如何使用表单输入将文本插入 .txt 文件？

> ID：14115925
> 
> 赞同：0
> 
> 时间：2013-01-02T01:26:30.870
> 
> 标签：php

我想要一个页面，我可以在其中将文本输入到输入表单中，然后将该文本插入到文本文件中的适当位置。

例如，输入表单将有 2 个输入表单字段： 1\. 多少比萨饼？2\. 哪个城市？

它将更新一个文本文件，上面写着：

***(2)***中有**(1)**个 比萨饼。

 *纽约有 5 个披萨

很简单，但是我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:37:22.720

使用 JSON。它可以让您轻松地编辑数据（而且因为它很酷）。

```
if ( empty( $_POST['pizzaCount'] ) === false && empty( $_POST['city'] ) === false )
{
   $savePath = 'folder/folder2/save.txt';
   $content = array();

   //does the file already exist?
   if ( ( $fileContents = file_get_contents( $savePath ) ) !== false )
   {
      //get the old data
      $content = json_decode( $fileContents , true );
   }
   //add the new data
   $content[] = array( 'pizzaCount' => $_POST['pizzaCount'] , 'city' => $_POST['city'] );

   //decode the new data
   $content = json_encode( $content );
   file_put_contents( $savePath , $content );

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:32:23.210

PHP：

```
<?php
file_put_contents('file.txt', 'There are ' . $_POST['pizzas'] . ' pizzas in ' . $_POST['city']);
?> 
```

HTML：

```
<form action="script.php" method="POST">
  Pizzas: <input type="text" name="pizzas"><br />
  City: <input type="text" name="city"><br />
  <input type="submit" value="Save">
</form> 
```*

# android - 根据上传时间获取更改

> ID：14115926
> 
> 赞同：0
> 
> 时间：2013-01-02T01:26:49.013
> 
> 标签：android, git, gerrit

我正在使用以下 ssh 命令来获取项目“平台/供应商/公司专有/代码”和处于打开状态的分支“主”的所有更改，这会提供大量数据和一些不必要的集成更改，我正在寻求控制这一点。

1.  有没有人使用类似的命令来获取更改并按上传时间排序或
2.  根据指定的上传时间获取更改
3.  根据您的经验，您还有什么其他想法可以控制输出？

    ```
    ssh -p 29418 company.com gerrit query --commit-message --files --current-patch-set status:open project:platform/vendor/company-proprietary/code branch:master 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T05:00:03.583

结果的顺序是按上次更新时间，并且没有选项可以改变它。

您可以使用`limit:x`参数限制结果的数量，也可以限制为仅在特定时间内进行更改，例如在上周使用`age:1week`.

如果您需要按上传时间排序，我认为唯一的方法是将结果加载到脚本中并自行排序。为此，最好通过`--format json`在命令上添加选项来获取 JSON 格式的输出。

# java - 打印出字符串的所有可能组合

> ID：14115928
> 
> 赞同：0
> 
> 时间：2013-01-02T01:27:11.860
> 
> 标签：java

```
public static void combinations(String s) {
    char[] original = s.toCharArray();
    int original_size = s.length();

    String temp = new String();
    for (int i = 0; i < original_size; i++) {// add the first element
        String sb = "";
        temp = "";
        sb = "" + original[i];
        temp = sb.toString();

        System.out.println(sb);
        for (int j = i + 1; j < original_size; j++) {// add the other
                                                        // element in the
                                                        // array
            if (i == j)
                continue;
            sb = temp + "" + original[j];
            System.out.println(sb);
        }
        // sb = "";
    }
}

public static void main(String[] args) {
    combinations("abc");
} 
```

结果应该是：a,ab,ac,abc,b,b​​c,c

但我的程序是：a、ab、ac、b、bc、c。我无法打印 abc

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:47:40.437

如果您的输出应该是`a, ab, ac, abc, b, bc, c`，那么它实际上并不是所有字母的组合，因为它还必须包括`ca`等`cb`。我认为您正在尝试查找组合，但是按照字符串的给定顺序。下面的方法将能够找到你正在尝试做的事情。只要打电话`orderedCombinations("abc")`。

```
public static void orderedCombinations(String s) {
    for(int i = 0; i < s.length(); i++) {
        for(String s1 : subStrings(s.substring(i + 1))) {
            System.out.println(s.charAt(i) + s1);
        }
    }
}

public static String[] subStrings(String s) {
    ArrayList<String> strs = new ArrayList<String>();
    strs.add("");
    for(int i = 0; i < s.length(); i++) {
        for(int j = i + 1; j < s.length() + 1; j++)
            strs.add(s.substring(i, j));
    }

    return strs.toArray(new String[0]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T02:04:06.033

注意到您有两个 for 循环，但实际上只需要一个即可从 AZ 获取所有可能的组合。但是您列出的组合并不是字符串的所有可能组合。

这样的可能性是 a , ab , ac, abc , acb, b, ba, bc , bac , bca , c, ca , cb , cba, cab

由于您决定围绕 for 循环构建您的程序，答案在于您需要第三个循环来处理三个字符而不是两个字符，但是对于您的程序目标没有明确的目标，我无法重新-写一个例子。

我建议您重新开始，在使用代码来感受语法的同时，尝试在您的示例中更有效地编写代码。original_size 是一个无用的变量，例如，您可以只使用 s.length。

# blackberry - 检查 SD 卡是否可用

> ID：14115937
> 
> 赞同：2
> 
> 时间：2013-01-02T01:28:30.153
> 
> 标签：blackberry

我的应用程序需要下载一些文件进行缓存。但我想检查用户是否安装了 SD 卡，以便我可以将文件保存在那里而不是设备内存。我使用了这段代码：

```
 String SDexist = "file:///SDCard/";

  fconnSD = (FileConnection) Connector.open(SDexist,Connector.READ);

  if(!fconnSD.exists())
  { 
      FileDire = "file:///store/home/user/catch/";
  } else
  {
      FileDire = "file:///SDCard/BlackBerry/catch/";
  } 
```

但它不起作用，即使 SD 卡不可用，它也总是寻找 SD 卡并且不将文件保存在设备内存中。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T02:23:21.573

已解决，我使用`FileSystemRegistry.listRoots();` 并读取了根元素，如果存在 sdcard，则应安装 SD 卡。

# apache-flex - httpService 和 XMLListCollection

> ID：14115940
> 
> 赞同：0
> 
> 时间：2013-01-02T01:29:03.120
> 
> 标签：apache-flex, httpservice

我的项目有问题，我尝试用从 php 文件中获取的 xml 数据填充列表。我用 httpservice 调用 php 文件，这个文件返回 xml 数据。现在似乎有问题，但我没有收到任何错误。我只是在调试后才知道我的 XMLListCollection 仍然为空。

这是我的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" 
                 xmlns:components="components.*"
                 creationComplete="httpService.send()">

    <s:layout>
        <s:VerticalLayout paddingTop="20" gap="20" 
                          horizontalAlign="center" />
    </s:layout>
    <fx:Script>
        <![CDATA[
            import mx.rpc.events.ResultEvent;
            import mx.collections.ArrayCollection; 
            import mx.collections.XMLListCollection; 

            import mx.rpc.events.FaultEvent;
            import mx.controls.Alert;
            private var alert:Alert;

            private function httpService_fault(evt:FaultEvent):void {
                var title:String = evt.type + " (" + evt.fault.faultCode + ")";
                var text:String = evt.fault.faultString;
                alert = Alert.show(text, title);
                Bezoekers.removeAll();
            }

            private function httpService_result(evt:ResultEvent):void {
                var xmlList:XMLList = XML(evt.result).bezoekers.bezoeker;
                Bezoekers = new XMLListCollection(xmlList);

            }

        ]]>
    </fx:Script>
    <fx:Declarations>
        <s:HTTPService id="httpService"
                       url="http://localhost/projectnieuw/src/data/bezoekersList.php"
                       resultFormat="e4x"
                       fault="httpService_fault(event);"
                       result="httpService_result(event)" />
        <!--<fx:Model id="lijstAlleLeden" source="httpAlleLeden" />-->
        <!--<s:ArrayCollection id="acBezoekers" source="{Bezoekers}"/>-->
        <s:XMLListCollection id="Bezoekers"/>
    </fx:Declarations>

    <components:Heading/>
    <s:HGroup gap="50">

        <components:BezoekersList bezoekerList="{Bezoekers}" />
        <components:ReservationForm/>

    </s:HGroup>

</s:Application> 
```

我似乎不明白出了什么问题。

提前致谢

来自比利时的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T05:09:19.550

你的 XMLListCollection 保持为**空**意味着`Bezoekers = new XMLListCollection(xmlList);`给它空。所以首先尝试从服务器端跟踪结果不为空。要测试服务器端响应，您有一个技巧，即在 Web 浏览器中打开 HTTPService 的 URL 并在 Web 浏览器中获取 XML 数据。如果获得成功，则尝试`resultFormat="xml"`代替`resultFormat="e4x"`并阅读[HTTPService 的结果类型的文档](http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_6.html)以了解如何使用它。它还有一些针对 XML 的个案解决方案。

愿这能帮助你...

# php - AJAX：如何显示/添加/编辑/删除（CRUD）尽可能多的性能？

> ID：14115949
> 
> 赞同：1
> 
> 时间：2013-01-02T01:31:31.680
> 
> 标签：php, javascript, ajax, performance, crud

我希望在用户能够创建/读取/更新/删除（CRUD）数据的情况下为我的脚本获得更好的性能。

目前，我在每次操作后发送一个请求并刷新概览页面。例子：

```
<a href="script.php?action=save">Add</a>
<table>
    <tr>
        <td>Item 1</td>
        <td>
            <a href="script.php?action=save&id=123">Edit</a>
            <a href="script.php?action=delete&id=123">Delete</a>
        </td>
<table> 
```

-

```
<?php
// script.php -> action=delete
$error = true;
if ($this->database->query("DELETE FROM items WHERE id = :id", array("id" => $_GET["id"]))) {
    $error = false; 
}    

// forward back
header("Location: script.php?error=" . $error);
?> 
```

我不喜欢它，想改变它。

你怎么看待这件事：

*   通过 AJAX 加载项目 (JSON)

*   只修改 items 数组

*   收集更新和删除的项目

*   更新和删除 onUnload/windowClose

*   结果：更少的服务器请求

**伪代码**：

```
<script>
var items = null; // items
var items_deleted = null; // items, marked to delete
var items_updated = null; // items, marked to be updated

// builds the html table 
function build_html_table() {
    // sort the items
    items = sortTheItems(items);

    html  = "<table>";
    for (i = 0; i < items.length; i++):
        html += '<tr id="'+items[i].id+'">';
        html +=     '<td>'+items[i].name+'</td>';
        html +=     '<td>';
        html +=         '<a href="script.php?action=save&id='+items[i].id+'" class="edit">Edit</a>';
        html +=         '<a href="script.php?action=save&id='+items[i].id+'" class="delete">Delete</a>';
        html +=     '</td>';
        html += "</tr>";
    endfor;
    html += "</table>";

    $("#table").html(html);
}

// on clicking the delete-link
$(".delete").click(function() {
    // get id
    id = $(this).parent().parent().attr("id"); // id of <tr>

    // delete item (temp)
    for (i = 0; i < items.length; i++) 
        if (items[i].id == id) 
            unset(items[i]);
    endfor;

    // mark for deleting
    items_deleted.push(id);

    // re-build table
    build_html_table();
});

// on clicking the edit-link
$(".edit").click(function() {
    // get id
    id = $(this).parent().parent().attr("id");

    // get the item to edit
    item = null;
    for (i = 0; i < items.length; i++):
        if (items[i].id == id)
            item = items[i];
    endfor;

    // fill the save-form
    $("#save_dialog [name='id']").val(item.id);
    $("#save_dialog [name='name']").val(item.name);
    $("#save_dialog [name='content']").val(item.content);

    // open save-form in a dialog
    $("#save_dialog").dialog();
});

// on clicking the add link
$(".add").click(function() {
    // reset the save-form
    $("#save_dialog [name='id']").val("");
    $("#save_dialog [name='name']").val("");
    $("#save_dialog [name='content']").val("");

    // open save-form in a dialog
    $("#save_dialog").dialog();
});

// save form
$("#save_form").onSubmit(function() {
    id = $(this).find("[name='id']");
    if (!id) {
        // real add, getting the new id
        $(this).ajaxForm({
            onSuccess: function(responseText, $form) {
                item.id      = responseText; // script.php?action=save returns the last inserted/updated ID
                item.name    = $form.find("[name='name']");
                item.content = $form.find("[name='content']");

                // add the added item
                items.push(item);
        });            
    } else {
        // temp. update

        // update the old entry
        for (i = 0; i < items.length; i++):
            if (items[i].id == item.id) {
                items[i].name = $(this).find("[name='name']").val();
                items[i].content = $(this).find("[name='content']").val();

                // mark this item to update
                items_updated[items[i].id] = items[i];
            }
        endfor; 
    }

    // re-build table
    build_html_table();        
});

// doc ready
$(function() {
    // get the items data (json)
    items = getJSON("items_json.php");

    // build table
    build_html_table();
});

// on window close/unload (or after $x minutes)
$.unload(function() {
    // real delete 
    ajaxRequest("script.php?action=delete&ids=", items_deleted);

    // real update
    ajaxRequest("script.php?action=update", items_updated);
});
</script>

<a href="script.php?action=add" class="add">Add</a>
<div id="table">loading...</div>

<div id="save_dialog" class="hidden">
    <form action="script.php?action=save" method="POST" id="save_form">
        <input type="hidden" name="id"/>
        Name: <input type="text" name="name"/><br/>
        Content: <textarea name="content"></textarea><br/>
        <input type="submit"/>
    </form>
</div> 
```

你觉得我的想法怎么样？我还能做些什么更好？是否有好的 jQuery 插件可以轻松完成这项工作？

提前致谢！

注意：这只是伪代码！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T02:39:06.777

一个大帮手是使用`data-`属性来保存解析其他属性以获取诸如`ID`, 或者`action`您在 url 中硬编码的内容（如果页面中没有 JS，请保留在那里），但也有助于在处理程序中访问它。

```
 /* "data-arbitraryName" can be read using jQuery `data()` method*/
 html += '<tr id="'+items[i].id+'" data-id="'+items[i].id+'">';

/* add common class to "controls"*/
'<a href="script.php?action=save&id='+items[i].id+'" class="edit crud_btn" data-action="save">Edit</a>';

/* can now combine a lot in one click handler*/
$('#tableParent').on('click', '.crud_btn', function(e){

      var $btn=$(this), $row=$btn.closest('tr'), row_id= $row.data('id');
       /* data() method reads "data-" attributes*/
      var thisAction=$(this).data('action')
     /* create data object to send*/
     var dataToServer={/* this data always sent*/
          action: thisAction,
          id: row_id || 'add';
     }
      /* additional data as needed based on "action"*/
      if( thisAction == 'add'){
          $.extend( dataToServer, someFormData);
     }

     /* use direct file url, if GET, jQUery will append search string from dataToServer object*/
     $.getJSON('script.php', dataToServer, function(response){
          if( response.success ){  
              /* psuedo update method*/
               updatStoredData( response, action);
               /* success handling based on "action"*/
               if(thisAction=='delete'){
                   $row.remove();

               }
          }
    })
   return false;
}) 
```

# java - 调整大小后的图像质量非常低——Java

> ID：14115950
> 
> 赞同：24
> 
> 时间：2013-01-02T01:32:01.100
> 
> 标签：java, image, image-resizing

在脚本中，它从大约 300x300 标记下降到 60x60。需要提高整体图像质量，因为目前它的表现非常糟糕。

```
public static Boolean resizeImage(String sourceImg, String destImg, Integer Width, Integer Height, Integer whiteSpaceAmount) 
{
    BufferedImage origImage;

    try 
    {
        origImage = ImageIO.read(new File(sourceImg));
        int type = origImage.getType() == 0? BufferedImage.TYPE_INT_ARGB : origImage.getType();
        int fHeight = Height;
        int fWidth = Width;
        int whiteSpace = Height + whiteSpaceAmount; //Formatting all to squares so don't need two whiteSpace calcs..
        double aspectRatio;

        //Work out the resized dimensions
        if (origImage.getHeight() > origImage.getWidth()) //If the pictures height is greater than the width then scale appropriately.
        {
            fHeight = Height; //Set the height to 60 as it is the biggest side.

            aspectRatio = (double)origImage.getWidth() / (double)origImage.getHeight(); //Get the aspect ratio of the picture.
            fWidth = (int)Math.round(Width * aspectRatio); //Sets the width as created via the aspect ratio.
        }
        else if (origImage.getHeight() < origImage.getWidth()) //If the pictures width is greater than the height scale appropriately.
        {
            fWidth = Width; //Set the height to 60 as it is the biggest side.

            aspectRatio = (double)origImage.getHeight() / (double)origImage.getWidth(); //Get the aspect ratio of the picture.
            fHeight = (int)Math.round(Height * aspectRatio); //Sets the height as created via the aspect ratio.
        }

        int extraHeight = whiteSpace - fHeight;
        int extraWidth = whiteSpace - fWidth;

        BufferedImage resizedImage = new BufferedImage(whiteSpace, whiteSpace, type);
        Graphics2D g = resizedImage.createGraphics();
        g.setColor(Color.white);
        g.fillRect(0, 0, whiteSpace, whiteSpace);

        g.setComposite(AlphaComposite.Src);
        g.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
        g.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
        g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);

        g.drawImage(origImage, extraWidth/2, extraHeight/2, fWidth, fHeight, null);
        g.dispose();

        ImageIO.write(resizedImage, "jpg", new File(destImg));
    } 
    catch (IOException ex) 
    {
        return false;
    }

    return true;
} 
```

真的只需要知道它们是否是我可以插入的东西，这会提高质量，或者我是否需要完全看其他东西。

编辑：图片比较。

来源，刚刚从谷歌随机挑选了一台洗衣机。 [http://www.essexappliances.co.uk/images/categories/washing-machine.jpg](http://www.essexappliances.co.uk/images/categories/washing-machine.jpg)

![洗衣机](../Images/92a1fbde16b71ad02691009b83999e88.png)

在 Photoshop 中将同一张图片转换为我需要的图片。 [http://imgur.com/78B1p](https://imgur.com/78B1p)

![在油漆店调整大小](../Images/6681e1448e34b62a41e9117a2fae0ec2.png)

像这样被转换的样子。 [http://imgur.com/8WlXD](https://imgur.com/8WlXD)

![错误调整大小](../Images/f79007ba90672bb760e320be36b38c5b.png)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-02T04:07:00.407

在大范围内缩小图像本质上是危险的（从质量的角度来看），尤其是使用单个步骤。

推荐的方法是使用分而治之的方法。基本上，您以 50% 的步长将图像缩小，直到达到您想要的大小。

因此，我拍摄了 650x748 的原始图像并将其缩小以适合 60x60 区域（52x60）。

![在此处输入图像描述](../Images/3f418fd6895afe3073a177dd5efcb615.png)

分而治之比一步...

![在此处输入图像描述](../Images/6d87d030598075a449684522581d01ec.png)![在此处输入图像描述](../Images/639de8b63a0f4cf8f1e875faab01459b.png)

```
public class TestImageResize {

    public static void main(String[] args) {
        new TestImageResize();
    }

    public TestImageResize() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new ScalePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class ScalePane extends JPanel {

        private BufferedImage original;
        private BufferedImage scaled;

        public ScalePane() {
            try {
                original = ImageIO.read(new File("path/to/master.jpg"));
                scaled = getScaledInstanceToFit(original, new Dimension(60, 60));
                ImageIO.write(scaled, "jpg", new File("scaled.jpg"));

                BufferedImage image = new BufferedImage(52, 60, BufferedImage.TYPE_INT_RGB);
                Graphics2D g2d = image.createGraphics();
                g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
                g2d.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
                g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                g2d.drawImage(original, 0, 0, 52, 60, this);
                g2d.dispose();

                ImageIO.write(image, "jpg", new File("test.jpg"));

            } catch (IOException ex) {
                ex.printStackTrace();
            }
        }

        @Override
        public Dimension getPreferredSize() {

            Dimension size = super.getPreferredSize();
            if (original != null) {
                if (scaled != null) {
                    size.width = original.getWidth() + scaled.getWidth();
                    size.height = original.getHeight();
                } else {
                    size.width = original.getWidth();
                    size.height = original.getHeight();
                }
            }

            return size;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
            g2d.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);

            if (original != null) {
                int x = 0;
                int y = (getHeight() - original.getHeight()) / 2;;
                if (scaled != null) {
                    x = (getWidth() - (original.getWidth() + scaled.getWidth())) / 2;
                } else {
                    x = (getWidth() - original.getWidth()) / 2;
                }
                g2d.drawImage(original, x, y, this);

                if (scaled != null) {
                    x += original.getWidth();
                    y = (getHeight() - scaled.getHeight()) / 2;
                    g2d.drawImage(scaled, x, y, this);
                }
            }
            g2d.dispose();
        }

        public BufferedImage getScaledInstanceToFit(BufferedImage img, Dimension size) {
            float scaleFactor = getScaleFactorToFit(img, size);
            return getScaledInstance(img, scaleFactor);
        }

        public float getScaleFactorToFit(BufferedImage img, Dimension size) {
            float scale = 1f;
            if (img != null) {
                int imageWidth = img.getWidth();
                int imageHeight = img.getHeight();
                scale = getScaleFactorToFit(new Dimension(imageWidth, imageHeight), size);
            }
            return scale;
        }

        public float getScaleFactorToFit(Dimension original, Dimension toFit) {
            float scale = 1f;
            if (original != null && toFit != null) {
                float dScaleWidth = getScaleFactor(original.width, toFit.width);
                float dScaleHeight = getScaleFactor(original.height, toFit.height);
                scale = Math.min(dScaleHeight, dScaleWidth);
            }
            return scale;
        }

        public float getScaleFactor(int iMasterSize, int iTargetSize) {
            float scale = 1;
            if (iMasterSize > iTargetSize) {
                scale = (float) iTargetSize / (float) iMasterSize;
            } else {
                scale = (float) iTargetSize / (float) iMasterSize;
            }
            return scale;
        }

        public BufferedImage getScaledInstance(BufferedImage img, double dScaleFactor) {
            BufferedImage imgBuffer = null;
            imgBuffer = getScaledInstance(img, dScaleFactor, RenderingHints.VALUE_INTERPOLATION_BILINEAR, true);
            return imgBuffer;
        }

        protected BufferedImage getScaledInstance(BufferedImage img, double dScaleFactor, Object hint, boolean higherQuality) {

            int targetWidth = (int) Math.round(img.getWidth() * dScaleFactor);
            int targetHeight = (int) Math.round(img.getHeight() * dScaleFactor);

            int type = (img.getTransparency() == Transparency.OPAQUE)
                            ? BufferedImage.TYPE_INT_RGB : BufferedImage.TYPE_INT_ARGB;

            BufferedImage ret = (BufferedImage) img;

            if (targetHeight > 0 || targetWidth > 0) {
                int w, h;
                if (higherQuality) {
                    w = img.getWidth();
                    h = img.getHeight();
                } else {
                    w = targetWidth;
                    h = targetHeight;
                }

                do {
                    if (higherQuality && w > targetWidth) {
                        w /= 2;
                        if (w < targetWidth) {
                            w = targetWidth;
                        }
                    }

                    if (higherQuality && h > targetHeight) {
                        h /= 2;
                        if (h < targetHeight) {
                            h = targetHeight;
                        }
                    }

                    BufferedImage tmp = new BufferedImage(Math.max(w, 1), Math.max(h, 1), type);
                    Graphics2D g2 = tmp.createGraphics();
                    g2.setRenderingHint(RenderingHints.KEY_INTERPOLATION, hint);
                    g2.drawImage(ret, 0, 0, w, h, null);
                    g2.dispose();

                    ret = tmp;
                } while (w != targetWidth || h != targetHeight);
            } else {
                ret = new BufferedImage(1, 1, type);
            }
            return ret;
        }
    }
} 
```

您还可以找到感兴趣[的 Image.getScaledInstance()](https://web.archive.org/web/20150518194337/http://today.java.net/pub/a/today/2007/04/03/perils-of-image-getscaledinstance.html)的风险。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-01-02T04:40:17.950

您看到的问题实际上与用于缩减的重采样滤波器有关。显然，您的图书馆使用的那个不适合这种情况。最近邻、双线性和双三次是缩小比例时使用的典型不良示例。我不知道 Photoshop 使用的确切重采样过滤器，但我使用了 3-lobed lanczos 并得到以下结果：

![在此处输入图像描述](../Images/6e5c5d202b7b9598ecfb92912b20cc41.png)

因此，要解决您的问题，您需要使用更智能的重采样滤波器。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-01-02T15:59:29.357

荷兰人，这就是我维护[imgscalr 库](http://www.thebuzzmedia.com/software/imgscalr-java-image-scaling-library/)的原因——让这种东西变得非常容易。

在您的示例中，在您的第一个 ImageIO.read 行之后，一个方法调用就可以解决问题：

```
origImage = ImageIO.read(new File(sourceImg)); 
```

您可以执行以下操作来获得所需的内容（[此方法的 javadoc](http://www.thebuzzmedia.com/downloads/software/imgscalr/javadoc/org/imgscalr/Scalr.html#resize%28java.awt.image.BufferedImage,%20org.imgscalr.Scalr.Method,%20int,%20java.awt.image.BufferedImageOp...%29)）：

```
origImage = Scalr.resize(origImage, Method.ULTRA_QUALITY, 60); 
```

如果那看起来仍然有点锯齿状（因为您要从图像中删除太多信息，您可以将以下 OP 添加到命令中，以对图像应用光抗锯齿滤镜，使其看起来更平滑）：

```
origImage = Scalr.resize(origImage, Method.ULTRA_QUALITY, 60, Scalr.OP_ANTIALIAS); 
```

这将替换您拥有的所有其余代码逻辑。我唯一推荐的另一件事是将您非常小的样本保存为PNG，这样就不会对图像进行更多的压缩/有损转换，或者如果您真的想要JPG格式，请确保您对JPG几乎没有压缩。（这是[一篇](http://blog.carsoncheng.ca/2011/02/how-to-change-jpeg-compression-in-java.html)关于如何做到这一点的文章；它利用[ImageWriteParam](http://docs.oracle.com/javase/6/docs/api/javax/imageio/ImageWriteParam.html)类）

imgscalr 在 Apache 2 许可下获得许可，并托管在[GitHub 上](https://github.com/thebuzzmedia/imgscalr)，因此您可以使用它做您想做的事；如果您在服务器端应用程序中使用该库并排队大量扩展操作并且不想终止服务器，它还包括[异步扩展支持。](http://www.thebuzzmedia.com/downloads/software/imgscalr/javadoc/org/imgscalr/AsyncScalr.html)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-03-30T21:44:00.807

如前所述，Java 的 Graphics2D 没有提供很好的缩小算法。如果您不想自己实现复杂的算法，您可以尝试当前专门用于此的开源库：[Thumbnailator](https://i.stack.imgur.com/hH8C3.png)、[imgscalr和](https://gist.github.com/patrickfav/a147ecd26a385ce4f6d8c373356454c4)[ImageMagick](https://stackoverflow.com/a/36295066/774398)的 Java 接口。

在研究一个私人项目时，我尝试了它们（ImageMagick 除外），以下是使用 Photoshop 作为参考的视觉结果：

[![比较](../Images/7eb9c33010472c3c60bbe1b1b7bf4849.png)](https://i.stack.imgur.com/hH8C3.png)

> A.具有默认设置的**Thumbnailator** 0.4.8（没有额外的内部调整大小）
> B.具有 ULTRA_QUALTY 设置的**imgscalr** 4.2
> C. **Photoshop** CS5 双三次过滤器（保存为网络）
> D. **Graphics2d**具有所有 HQ 渲染提示

[*这是使用的代码*](https://gist.github.com/patrickfav/a147ecd26a385ce4f6d8c373356454c4)

Thumbnailator 和 PS 创建类似的结果，而 imgscalr 似乎更柔和。哪个库产生更好的结果是主观的。另一点要考虑的是性能。[虽然 Thumbnailator 和 Graphics2d 具有相似的运行时间，但 imgscalr在我的基准测试中](https://stackoverflow.com/a/36295066/774398)要慢得多（使用 ULTRA_QUALITY）。

[有关更多信息，请阅读这篇文章，提供有关此问题的更多详细信息](https://stackoverflow.com/a/36295066/774398)。

# php - SimpleXML，尝试遍历元素并用值创建关联数组

> ID：14115951
> 
> 赞同：2
> 
> 时间：2013-01-02T01:32:10.600
> 
> 标签：php, simplexml

我也无法让 SimpleXML 正常工作。我想用元素创建一个关联数组。这是xml的样子

```
<?xml version="1.0"?>
<RateV4Response>
<Package ID="1">
<ZipOrigination>11901</ZipOrigination>
<ZipDestination>91730</ZipDestination>
<Pounds>0</Pounds>
<Ounces>3.5</Ounces>
<Size>REGULAR</Size>
<Machinable>TRUE</Machinable>
<Zone>8</Zone>

<Postage CLASSID="3">
    <MailService>Express Mail</MailService>
    <Rate>28.00</Rate>
</Postage>
<Postage CLASSID="2">
    <MailService>Express Mail Hold For Pickup</MailService>
    <Rate>28.00</Rate>
</Postage> 
```

MailService 和 Rate 应该是一个数组。这是我的 php：

```
$usps_response = new SimpleXMLElement($result);
foreach($usps_response->Package->Postage as $service)
    $data[] = array($service->MailService => $service->Rate); 
```

我在这里没有看到错误，但 $data 是 28 个空元素。我也试过这个：

```
$data[] = array($service['MailService'] => $service['Rate']); 
```

但这没有帮助

如果我只将 $service 分配给 $data[]，那么我会看到 28 个元素，每个元素有 3 个子元素（属性、MailService 和 Rate）。

我究竟做错了什么？

这是帮助查看数据的图片 ![在此处输入图像描述](../Images/7e51eb5775c3d8df6abcf3cfba633ef6.png)

![在此处输入图像描述](../Images/5a10e534426182082a6da5f105423b47.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:42:50.853

此处发布的 XML 不是有效的 XML，因此我不得不假设它不完整，或者邮政服务产生了一些不是很有用的东西。通过一些更改，我能够使其工作。请参阅 [http://www.laprbass.com/RAY_temp_user193.php](http://www.laprbass.com/RAY_temp_user193.php)

```
<?php // RAY_temp_user193.php
error_reporting(E_ALL);
echo '<pre>';

// TEST DATA
$xml = <<<ENDXML
<?xml version="1.0"?>
<RateV4Response>
<Package ID="1">
<ZipOrigination>11901</ZipOrigination>
<ZipDestination>91730</ZipDestination>
<Pounds>0</Pounds>
<Ounces>3.5</Ounces>
<Size>REGULAR</Size>
<Machinable>TRUE</Machinable>
<Zone>8</Zone>

<Postage CLASSID="3">
    <MailService>Express Mail</MailService>
    <Rate>28.00</Rate>
</Postage>
<Postage CLASSID="2">
    <MailService>Express Mail Hold For Pickup</MailService>
    <Rate>28.00</Rate>
</Postage>
</Package>
</RateV4Response>
ENDXML;

// MAKE AN OBJECT
$obj = SimpleXML_Load_String($xml);
var_dump($obj); 
```

现在你想用这个对象做什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T02:55:02.343

看起来很奇怪，你想要一个像`Express Mail Hold For Pickup`你的数组一样的键，但我们开始吧：

```
foreach($usps_response->Package->Postage as $service)
    $data[] = array((string)$service->MailService => (string)$service->Rate); 
```

# html - 两个提交按钮

> ID：14115953
> 
> 赞同：0
> 
> 时间：2013-01-02T01:32:56.387
> 
> 标签：html

我在同一页面上有两个表单，并且有两个提交按钮...那么如何在单击第二个表单上的提交按钮之前检查用户是否填写了第一个表单？第一个表单将数据发布到 php 页面，该页面与 html 显示在同一页面上，第二个表单将数据发送到另一个 PHP 页面并带有感谢信息....我的意思是如何强制用户在之前完成第一个表单单击第二个表单上的提交按钮？如果用户点击第二个表单上的提交按钮，表单会直接指向感谢页面，而不检查用户是否完成了第一个表单。我该如何停止呢？

```
<html>
<body>

<form action="" method="post" enctype="multipart/form-data">
<input type="hidden" name="submited" value="true" />
<label for="file">Choose Photo:</label>
<input type="file" name="file" onchange="file_selected = true;" required>
<input type="submit" value="Submit" name="submit">
</form>

<form action="Send.php" method="post">
First Name:<input type="text" name="fname" required><br>
Last Name:<input type="text" name="lname" required><br>
Choose Username:<input type="text" name="username" required><br>
Age:<input type="text" name="age" required><br>
<input type="submit" value="Submit" name="submit">

</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T01:37:26.543

您可以更改名称字段，然后访问服务器端的值。例如：

`<input type="submit" value="Submit" name="submitOne" />`

如果您使用的是 php，则可以使用以下内容：

```
if(isset($_POST['submitOne'])){ /* first one pressed */ } 
```

还有一些其他选项，例如首先使用 jQuery 或 javascript 进行验证。

试试：[http ://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

# javascript - 试图将 javascript 注入我的页面

> ID：14115958
> 
> 赞同：5
> 
> 时间：2013-01-02T01:34:21.097
> 
> 标签：javascript, internet-explorer

由于现在无法进入的原因太复杂，我有一个 ajax 调用，它返回一些我想注入到我的页面中的动态创建的 Javascript。以下代码适用于 Chrome，但不适用于 IE：

```
 var node = document.getElementsByTagName("head")[0] || document.body;
  if (node)
  {
    var script = document.createElement("script");
    script.type = "text/javascript";
    //script.innerHTML = json.javascript;
    var textnode = document.createTextNode(json.javascript);
    script.appendChild(textnode);
    node.appendChild(script);
  } 
```

在 IE 中，我收到“SCRIPT65535：意外调用方法或属性访问”。从注释掉的代码中可以看出，在我尝试 textnode 之前，我尝试使用 script.innerHTML 插入它。这也适用于 Chrome，但在 IE 中我得到“SCRIPT600:Unknown runtime error”。

有没有办法将一些 javascript 粘贴到 IE 中的 DOM 中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T01:39:00.007

当然，一旦我发布这个，我发现[http://www.phpied.com/dynamic-script-and-style-elements-in-ie/](http://www.phpied.com/dynamic-script-and-style-elements-in-ie/)

```
 var node = document.getElementsByTagName("head")[0] || document.body;
  if (node)
  {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.text = json.javascript;
    node.appendChild(script);
  } 
```

# http - Restlet 服务器没有返回正确的响应

> ID：14115960
> 
> 赞同：0
> 
> 时间：2013-01-02T01:34:36.797
> 
> 标签：http, restlet, restlet-2.0

我有一个在组件中运行的 ServerResource 对象。它的目的是在许多方面像一个基本的 HTTP 服务器一样工作。它使用 Representation 获取文件并将文件的内容返回给浏览器。

下面提供了此应用程序的活动功能：

```
 public Representation showPage()
   {
     Representation rep = null;

     if(fileName != null)
     {         
        File path = new File("pages/" + fileName);       
        rep = new FileRepresentation(path,MediaType.ALL);
     }

     return(rep);
   } 
```

请注意，“fileName”是以前作为属性传入的 HTML 文件（或 index.html）的名称。该应用程序提供的文件都位于名为“pages”的子目录中，如代码所示。这个想法是浏览器发送一个对 HTML 文件的 HTTP 请求，服务器以与 Apache 相同的方式返回该文件的内容。

另请注意，restlet 应用程序被部署为 JSE 应用程序。我正在使用 Restlet 2.1。

访问应用程序时会出现一个有趣的问题。有时，当请求来自 Firefox 浏览器时，服务器根本不发送响应。日志输出显示请求进入，但服务器不响应，即使是 404 也不响应。浏览器等待响应一段时间，然后超时。

在使用 Internet Explorer 时，有时浏览器会因为没有收到服务器的响应而超时，但有时服务器也会返回 304 响应。我对这个响应的研究表明它根本不应该被返回——特别是如果 HTML 文件没有包含缓存标签。

代码中是否存在导致这些无响应的内容？？？是否缺少某些东西导致 ServerResource 对象如此不可靠地处理响应？还是我在 Restlet 的响应机制中发现了一个错误？

有人请指教...

# php - 如何显示表格中的某些列？

> ID：14115961
> 
> 赞同：0
> 
> 时间：2013-01-02T01:34:39.513
> 
> 标签：php, mysql

我有一个存储消息的表。我想显示表格中的列。所以我需要一段时间来完成它。但我有一个错误，如：注意：未定义索引：主题在..我希望有人能帮助我，非常感谢

```
 <?php 
        //Proceso de conexión con la base de datos
        $conex = mysql_connect("localhost", "root", "root")
                or die("No se pudo realizar la conexion");
            mysql_select_db("carpe",$conex)
                or die("ERROR con la base de datos");

        //Iniciar Sesión
        session_start();

        //Validar si se está ingresando con sesión correctamente
        if (!$_SESSION){
        echo '<script language = javascript>
        alert("usuario no autenticado")
        self.location = "login.php"
        </script>';
        }

        $id_from = $_SESSION['id'];
        echo $id_from;
        $consulta=mysql_query("select * from messages where id_from='".$id_from."'");
        if($consulta === FALSE) {
            die(mysql_error()); // TODO: better error handling
        }

        while($filas=mysql_fetch_array($consulta)){
            echo $filas['id'];  
            $id_to=$filas['id_to'];
            $status=$filas['status'];
            $subject=$filas['subject'];
            $text=$filas['text'];
            $time=$filas['time'];
            $deleted=$filas['deleted'];

        ?>
        <label>
        <?php echo $id,$id_to,$subject,$text;?></label><br>
        <?php }?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:36:57.153

`Undefined index: subject in`

您是否 100% 确定表`messages`具有字段名称`subject`？？？我相信区分大小写在这里很重要。

因为这就是导致错误的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T01:36:59.617

您可以通过执行此查询来获取表结构：

```
DESCRIBE messages; 
```

或者，您可以使用[mysql_list_fields](http://php.net/manual/en/function.mysql-list-fields.php)获取有关表列的信息。

# jquery - 目的 ＃ 没有方法'css'

> ID：14115966
> 
> 赞同：1
> 
> 时间：2013-01-02T01:35:49.710
> 
> 标签：jquery, html, css

```
$('#someDiv').hover 
  (function(){
    (this).css({'background-color': 'black'});
  }, 
  function(){
     (this).css({'background-color': 'red'});
  }
); 
```

每次我将鼠标悬停（或移出）时`div`，Chrome 控制台都会返回标题中的错误。我认为`div`对象有一个`css()`方法，我发现这种情况真的很混乱。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-02T01:39:19.840

代替`(this).css({...});`

您需要`$(this).css({...});`使用 jQuery。

如果 jQuery 被重新映射到 以外的东西`$`，请使用 `jQuery(this).css({...});`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:39:03.937

添加`$`到`(this)`，即`$(this)`。

在您的事件处理程序中，`this`指的是原始 DOM 对象（`HTMLDivElement`错误状态为 ），而不是 jQuery 对象。使用 $() 包装它将使该`css()`方法可用，因为现在底层 DOM 对象包含在暴露其他功能的 jQuery 包装器中。

演示：http: [//jsfiddle.net/S7zd8/1/](http://jsfiddle.net/S7zd8/1/)

# mysql - CakePHP 模型查询 - 复杂 - 多表 - 求和 - 计数 - 分组依据

> ID：14115967
> 
> 赞同：1
> 
> 时间：2013-01-02T01:36:12.120
> 
> 标签：mysql, cakephp, database-design, model

大家好，节日快乐。

最近我的任务是将一个 beta 应用程序从纯 PHP/jQuery 转换为 CakePHP/ExtJS（我是新手）。

我的问题是填充主网格的最复杂的查询。

为简单起见，有 3 个表具有正确的烘焙关系和模型：`Projects`、、、`ToDo``ExtraToDo`

`Projects` *有很多* `ToDo`和`ExtraToDo`.

`ToDo`并`ExtraToDo`有列`Title`和`Complete`。

**我的目标是根据这三个表来获得每个项目的完成百分比。** 我解决这个问题的方法是列的SUM**除以**列`Complete`的**COUNT**`Complete`。我正在尝试使用 CakePHP 的可读性/性能/otherstuffIdontknowyet 方式。

最初，在原始 SQL 中，我是这样做的：

```
SELECT
  `idProject`,

  (SELECT
    ROUND((SUM(`Complete`) / COUNT(`Complete`)) * 100),
   FROM
    (SELECT `Complete`, `ProjectID` FROM `ToDo`
      UNION ALL
     SELECT `Complete`, `ProjectID` FROM `ExtraToDo`) orders
   WHERE
    `ProjectID` = `idProject`
  ) AS 'Completion'

FROM 
  `Projects` 
```

我也很容易让它在 Kohana PHP MVC 框架中工作，我在决定使用 CakePHP 之前尝试过。我很喜欢他们的查询是如何创建的......：

```
private function get_completion() {
  $Query = DB::select('ProjectID', array(DB::expr('ROUND((SUM(`Complete`) / COUNT(`Complete`)) * 100)'), 'Completion'))
    ->from(array('ToDo', 'ExtraToDo'))
    ->group_by('ProjectID');

  return $Query;
}

public function get_all() {
  $Query = DB::select()
    ->from('Projects')
    ->join(array(self::get_completion(), 'Completion'))
    ->on('projects.id', '=', 'Completion.ProjectID')
    ->execute()
    ->as_array();

  return $Query;      
} 
```

不幸的是，在使用 CakePHP 的方式时，我一直在努力让它在 CakePHP 中工作。

我*很*确定 virtualFields 是我回答的关键，但在阅读了文档并尝试了 x、y 和 z 之后。我一直无法理解它们以及它们之间的关系。

提前谢谢你-T6

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T12:58:36.940

这是很多嵌套选择。IMO 你最好建立一个更好的查询。

这应该让你继续前进。

```
class Project extends AppModel {
    public $findMethods = array(
        'completion' => true
    );

    // other code

    protected function _findCompletion($state, $query, $results = array()) {
        if ($state == 'before') {
            $this->virtualFields['total'] = 'ROUND((SUM(Todo.Complete + TodoExtra.Complete) / (COUNT(Todo.Complete) + COUNT(TodoExtra.Complete))) * 100)';

            $query['fields'] = array(
                $this->alias . '.' . $this->primaryKey,
                'total'
            );

            $query['joins'] = array(
                array(  
                    'table' => 'todos', 
                    'alias' => 'Todo', 
                    'type' => 'left', 
                    'foreignKey' => false, 
                    'conditions'=> array('Todo.project_id = ' , $this->alias . '.' . $this->primaryKey) 
                ),
                array(  
                    'table' => 'todo_extras', 
                    'alias' => 'TodoExtra', 
                    'type' => 'left', 
                    'foreignKey' => false, 
                    'conditions'=> array('TodoExtra.project_id = ' . $this->alias . '.' . $this->primaryKey) 
                ),
            );

            $query['group'] = array(
                $this->alias . '.' . $this->primaryKey
            );
            return $query;
        }

        return $results;
    }

    // other code
} 
```

现在你有了一个自定义的 find 方法，可以像`find('first')`或一样使用`find('all')`。

从控制器：

```
$this->Project->find('completion'); 
```

或者在项目模型中

```
$this->find('completion'); 
```

它应该返回如下内容：

```
$results = array(
    0 => array(
        'Project' => array(
            'id' => 1,
            'total' => 50
        )
    ),
    1 => array(
        'Project' => array(
            'id' => 2,
            'total' => 75
        )
    )
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T03:06:54.900

我建议为 Project 模型类创建一个 afterFind() 函数，或者只是添加一个在需要执行此计算时调用的函数。

执行计算的函数如下所示：

```
getPercentageComplete($project){
{
$total_todos = count($project['ToDo']);
$completed_todos = 0;
foreach($project['ToDo'] as $todo){
   if($todo['Complete']) //assuming this is a boolean field
        $completed_todos++;
}
return $completed_todos / $total_todos;
} 
```

然后，您的 afterFind 将如下所示：

```
function afterFind(&$results)
{
  foreach ($results as &$project)
  {
   $project['Project']['percentageComplete'] = $this->Project->getPercentageComplete($project);
   }
return $results;
} 
```

[您可以在CakePHP Bakery -> 回调方法](http://book.cakephp.org/2.0/en/models/callback-methods.html)中看到有关 afterFind() 的更多信息

# php - jQuery.post() - 无法发送帖子数据

> ID：14115968
> 
> 赞同：5
> 
> 时间：2013-01-02T01:36:20.947
> 
> 标签：php, jquery

我有一个带有以下 javascript 代码的 html 文件来调用 jquery.post 函数并将一些数据发布到 test.php

```
<script type="text/javascript">
      $.post("test.php", { name: "John", time: "2pm" }, function(data) {
         alert("Data Loaded: " + data);
       });
</script> 
```

test.php如下

```
<?php
   echo "Name: ".$POST['name'];
?> 
```

不幸的是，我的警报只显示“名称：”而没有发回帖子数据。

然而，使用萤火虫，我可以看到帖子数据实际上正在发送。所以我很困惑为什么 $POST 在我的 php 文件中不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T01:47:37.060

javascript函数很好。问题出在服务器端。你应该写`$_POST`，不是`$POST`。

```
echo "Name: ".$POST['name']; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T01:43:17.950

您的数据被存储在一个类似结构的数组中......

因此，您应该按如下方式提醒数据：

```
alert("Data Loaded: Name=" + data('name') + " Time="+ data('time')); 
```

另外，您的php中有错字

```
echo "Name: ".$_POST['name']; 
```

你需要_。例如，不是 $POST，而是 $_POST

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T01:49:38.287

它`$_POST['variable']`不`$POST`检查你的 php 语法[http://php.net/manual/en/reserved.variables.post.php](http://php.net/manual/en/reserved.variables.post.php)

# php - 如何使用 php 将数组拆分/划分为 2？

> ID：14115976
> 
> 赞同：39
> 
> 时间：2013-01-02T01:37:27.603
> 
> 标签：php

帮助我将数组拆分或划分为 2 个不同的数组。这是我的单个数组

```
$array = array("1","2","3","4","5","6"); 
```

我希望将上面的数组分成两个数组，如下所示

```
$array1 = array("1","2","3");

$array2 = array("4","5","6"); 
```

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2013-01-02T01:40:34.013

使用[`array_chunk`](http://php.net/manual/en/function.array-chunk.php)：

```
$pieces = array_chunk($array, ceil(count($array) / 2)); 
```

* * *

如果您希望它们在单独的变量中（而不是多维数组），请使用[`list`](http://php.net/manual/en/function.list.php)：

```
list($array1, $array2) = array_chunk($array, ceil(count($array) / 2)); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-01-02T01:41:34.337

[`array_slice`](http://php.net/manual/en/function.array-slice.php)只要您知道每个数组中需要多少个元素，就可以很好地工作：

```
$array1 = array_slice($array, 0, 3);
$array2 = array_slice($array, 3, 3); 
```

# java - Clojure 在简单循环与 Java 上的性能真的很差

> ID：14115980
> 
> 赞同：31
> 
> 时间：2013-01-02T01:37:53.593
> 
> 标签：java, performance, math, clojure

剧透警告，这是 Project Euler 的问题 5。

我正在尝试学习 Clojure 并解决了问题 5，但它慢了几个数量级（Java 中的 1515 毫秒与 Clojure 中的 169932 毫秒）。我什至尝试过使用类型提示、未经检查的数学运算和内联函数，但都是徒劳的。

为什么我的 Clojure 代码这么慢？

Clojure 代码：

```
(set! *unchecked-math* true)
(defn divides? [^long number ^long divisor] (zero? (mod number divisor)))

(defn has-all-divisors [divisors ^long num]
  (if (every? (fn [i] (divides? num i)) divisors) num false))

(time (prn (some (fn [^long i] (has-all-divisors (range 2 20) i)) (iterate inc 1)))) 
```

Java代码：

```
public class Problem5 {
  public static void main(String[] args) {
    long start = System.currentTimeMillis();
    int i = 1;
    while(!hasAllDivisors(i, 2, 20)) {
      i++;
    }
    long end = System.currentTimeMillis();
    System.out.println(i);
    System.out.println("Elapsed time " + (end - start));
  }

  public static boolean hasAllDivisors(int num, int startDivisor, int stopDivisor) {
    for(int divisor=startDivisor; divisor<=stopDivisor; divisor++) {
      if(!divides(num, divisor)) return false;
    }
    return true;
  }

  public static boolean divides(int num, int divisor) {
    return num % divisor == 0;
  }
} 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-01-02T02:23:51.580

一些性能问题：

*   该`(range 2 20)`调用正在为 的每个增量创建一个新的惰性数字列表`i`。这很昂贵，并且会导致大量不必要的 GC。
*   您通过函数调用进行了大量的装箱操作。甚至`(iterate inc 1)`在每次增量时都在进行装箱/拆箱。
*   您正在遍历一系列除数。这比直接迭代循环慢
*   `mod`实际上目前在 Clojure 中并不是一个优化非常好的函数。你最好使用`rem`

您可以通过使用`let`语句定义范围一次来解决第一个问题：

```
(time (let [rng (range 2 20)]
  (prn (some (fn [^long i] (has-all-divisors rng i)) (iterate inc 1)))))
=> "Elapsed time: 48863.801522 msecs" 
```

您可以使用循环/递归解决第二个问题：

```
(time (let [rng (range 2 20)
           f (fn [^long i] (has-all-divisors rng i))]
       (prn (loop [i 1] 
              (if (f i)
                i
                (recur (inc i)))))))
=> "Elapsed time: 32757.594957 msecs" 
```

您可以通过对可能的除数使用迭代循环来解决第三个问题：

```
(defn has-all-divisors [^long num]
  (loop [d (long 2)]
    (if (zero? (mod num d))
      (if (>= d 20) true (recur (inc d)))
      false)))

 (time (prn (loop [i (long 1)] (if (has-all-divisors i) i (recur (inc i))))))
 => "Elapsed time: 13369.525651 msecs" 
```

您可以使用解决最终问题`rem`

```
(defn has-all-divisors [^long num]
  (loop [d (long 2)]
    (if (== 0 (rem num d))
      (if (>= d 20) true (recur (inc d)))
      false)))

 (time (prn (loop [i (long 1)] (if (has-all-divisors i) i (recur (inc i))))))
=> "Elapsed time: 2423.195407 msecs" 
```

如您所见，它现在可以与 Java 版本竞争。

一般来说，您通常可以通过一些努力使 Clojure 几乎与 Java 一样快。主要技巧通常是：

*   避免惰性功能特性。它们很好，但会增加一些开销，这在低级计算密集型代码中可能会出现问题。
*   使用原始/未经检查的数学
*   使用循环/递归而不是序列
*   确保您没有对 Java 对象进行任何反射（即`(set! *warn-on-reflection* true)`并消除您发现的所有警告）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:36:29.713

我无法重现 1500 毫秒的性能。Clojure 代码在编译为 uberjar 后实际上似乎是 Java 版本的两倍。

```
Now timing Java version
    232792560
"Elapsed time: 4385.205 msecs"

Now timing Clojure version
    232792560
"Elapsed time: 2511.916 msecs" 
```

我把java类放在resources/HasAllDivisors.java

```
public class HasAllDivisors {

    public static long findMinimumWithAllDivisors() {
        long i = 1;
        while(!hasAllDivisors(i,2,20)) i++;
        return i;
    }

    public static boolean hasAllDivisors(long num, int startDivisor, int stopDivisor) {
        for(int divisor = startDivisor; divisor <= stopDivisor; divisor++) {
            if(num % divisor > 0) return false;
        }
        return true;
    }

    public static void main(String[] args){
        long start = System.currentTimeMillis();
        long i = findMinimumWithAllDivisors();
        long end = System.currentTimeMillis();
        System.out.println(i);
        System.out.println("Elapsed time " + (end - start));
    }

} 
```

在 Clojure 中

```
(time (prn (HasAllDivisors/findMinimumWithAllDivisors)))

(println "Now timing Clojure version")
(time
    (prn
        (loop [i (long 1)]
            (if (has-all-divisors i)
                i
                (recur (inc i)))))) 
```

即使在命令行上，java 类也不能快速复制。

```
$ time java HasAllDivisors
  232792560
Elapsed time 4398

real   0m4.563s
user   0m4.597s
sys    0m0.029s 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-05T01:25:22.420

我知道这是一个老问题，但我一直在遇到类似的事情。看起来，来自 OP 的声明是，Clojure 在简单循环上比 Java 差得多，这是真的。我在这个线程中完成了这个过程，从 OP 的代码开始，然后添加了性能改进。最后，Java 代码运行时间约为 300 毫秒，优化的 Clojure 代码运行时间为 3000 毫秒。使用 lein 创建一个 uberjar 可以将 Clojure 代码缩短到 2500 毫秒。

由于我们知道给定代码给出的答案，我用它来让 Clojure 代码仅循环次数而不进行 mod/rem 计算。它只是通过循环。

```
(def target 232792560)

(defn has-all-divisors [divisors ^long num]
    (loop [d (long 2)]
        (if (< d 20) (recur (inc d)))))

(time (let [rng (range 2 20)
            f (fn [^long i] (has-all-divisors (range 2 20) i)) ]
    (prn (loop [i 1] 
            (if (< i target)
                (do (f i) (recur (inc i)))))))) 
```

结果时间与进行计算的时间大致相同，即 3000 毫秒。因此，仅仅通过这么多循环就需要 Clojure 这么长时间。

# phalcon - Find() 不返回带有缓存的结果

> ID：14115986
> 
> 赞同：0
> 
> 时间：2013-01-02T01:39:17.873
> 
> 标签：phalcon

我正在尝试在我的应用程序中实现 memcache，但遇到了一些奇怪的问题。如果我在没有缓存的情况下运行 find()，那么我找不到任何结果。但是，如果我运行相同的查询（刷新页面），那么我会得到我期望的结果。

这是我的代码：

```
<?php
    //Set the models cache service
    $di->set('modelsCache', function(){
        // Cache data for one day by default
        $frontCache = new \Phalcon\Cache\Frontend\Data(array(
            "lifetime" => 86400
        ));

        // Memcached connection settings
        $cache = new \Phalcon\Cache\Backend\Memcache($frontCache, array(
            "host" => "localhost",
            "port" => "11211"
        ));

        return $cache;
    });

<?php
class VideosController extends IndexController {
    public function viewAction() {
        /**
         * This will always return an array;
         * param 0 will always be the int
         */
        $params = $this->dispatcher->getParams();

        $id = $params[0];

        $cacheName = 'videoForView_'.$id;

        try {
            $video = Videos::findFirst(array(
                'id='.$id,
                'cache' => array(
                    'key' => $this->router->getControllerName().'_'.$this->router->getActionName().'_'.$id
                )
            ));

            $this->view->setVar('video', $video);
        } catch(Exception $e) {
            echo '<pre>';
            var_dump($e);
            exit;
        }
    }
} 
```

我假设如果内存缓存服务器没有命中，Phalcon 模型类会返回一个数据库查询。似乎 find() 确实找到了一些东西并缓存了它，但它没有返回任何东西。我不了解缓存在 Phalcon 中的工作原理吗？还是我只是做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T22:55:36.903

问题已解决。我与 Andres（Phalcon 的开发人员之一）一起工作，帮助他解决了我遇到的问题。事实证明，它的代码比我预期的要深。

好消息是它已经解决，并被推送到[phalcon 的 github](https://github.com/phalcon/cphalcon/tree/0.8.0)上的 0.8.0 分支！不要忘记重新编译！

# javascript - JQuery：将var的html内容转换为字符串

> ID：14115995
> 
> 赞同：2
> 
> 时间：2013-01-02T01:40:51.560
> 
> 标签：javascript, jquery, string, variables

我有一个获取 div 的 HTML 的 var。我想在隐藏的表单字段中使用该 var，以便可以将 HTML 保存到数据库中。

我只是难以将 HTML 或 var 转换为字符串。目前，将 var 按原样添加到我的输入中会破坏代码。

我尝试过`.wrap('<pre />');`以几种不同的方式使用，但它没有帮助，我认为它不正确。

谁能指出我正确的方向？谢谢！

```
var code = $('#container').html();

code = code.wrap('<pre />')

document.write('<input type="hidden" name="html" value="' + code + '">'); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T01:45:27.997

您最好使用辅助方法而不是直接`document.write`as（因为它是 HTML），您需要对其进行转义（确保代码中没有引号）。长话短说，也许使用类似的东西：

```
$('<input>',{
  'type':'hidden',
  'name':'html'
}) // create element
  .val(code) // use helper to insert HTML (auto-excapes)
  .appendTo('body'); // insert it where ever you need it 
```

* * *

进一步解释：比如说，`code`有以下内容：

```
<div class="foo">bar</div> 
```

通过使用文档写入（而不是转义它），您正在编写：

```
<input type="hidden" name="html" value="<div class="foo">bar</div>"> 
```

（`class="foo"`及其引号）会干扰原始隐藏元素的`value=""`属性。using`.val()`避免了这种情况，因为它确保将值安全地插入到元素中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T02:30:48.620

**使用 jQuery，这可能是最好的方法......**

```
jQuery(document).ready(
    function (){ 
        var code = jQuery.trim(jQuery('#container').html());
        jQuery("form").append('<input type="hidden" name="html" value="' + code + '">');
}); 
```