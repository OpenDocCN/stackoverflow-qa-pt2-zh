# StackOverflow 问答 13070000-13070999

# templates - CSV 导入的 Libreoffice Calc 模板

> ID：13070000
> 
> 赞同：2
> 
> 时间：2012-10-25T13:44:17.443
> 
> 标签：templates, csv, spreadsheet, libreoffice

我在 Scilab 中创建了一个函数，将数据保存在 *.csv 文件中，并使用 Libreoffice-calc 打开它。

我还在 Calc 中制作了一个模板，用于设置文本大小和交替行颜色。

是否有命令行参数来选择将 csv 文件导入到的模板？

//约翰

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T00:19:07.320

也许您可以使用[csv2odf](http://csv2odf.sourceforge.net)，它可以将 csv 数据插入 LibreOffice 电子表格模板。

# php - 为什么客户不能在 Magento 中编辑地址？

> ID：13070002
> 
> 赞同：0
> 
> 时间：2012-10-25T13:44:34.967
> 
> 标签：php, magento

我认为这张照片描述了我的问题 ![在此处输入图像描述](../Images/c91fc0af06d01218333132dcd234c9bd.png)

这发生在客户登录并单击其仪表板中的编辑地址后。我查看了布局文件和模板文件，但找不到任何东西。我收到此错误消息：

> 可恢复的错误：类 Mage_Customer_Block_Widget_Name 的对象无法转换为 customer/form/edit.phtml 中的字符串

对此有什么想法吗？

谢谢！

**编辑edit.phtml的源代码**

```
<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.

org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2010 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<div class="page-title">
    <h1><?php echo $this->__('Edit Account Information') ?></h1>
</div>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
<form action="<?php echo $this->getUrl('customer/account/editPost') ?>" method="post" id="form-validate">
    <div class="fieldset">
        <?php echo $this->getBlockHtml('formkey')?>
        <h2 class="legend"><?php echo $this->__('Account Information') ?></h2>
        <ul class="form-list">
            <li class="fields">
                <?php echo $this->getLayout()->createBlock('customer/widget_name')->setObject($this->getCustomer())->toHtml() ?>
            </li>
            <li>
                <label for="email" class="required"><em>*</em><?php echo $this->__('Email Address') ?></label>
                <div class="input-box">
                    <input type="text" name="email" id="email" value="<?php echo $this->htmlEscape($this->getCustomer()->getEmail()) ?>" title="<?php echo $this->__('Email Address') ?>" class="input-text required-entry validate-email" />
                </div>
            </li>
        <?php $_dob = $this->getLayout()->createBlock('customer/widget_dob') ?>
        <?php if ($_dob->isEnabled()): ?>
            <li><?php echo $_dob->setDate($this->getCustomer()->getDob())->toHtml() ?></li>
        <?php endif ?>
        <?php $_taxvat = $this->getLayout()->createBlock('customer/widget_taxvat') ?>
        <?php if ($_taxvat->isEnabled()): ?>
            <li><?php echo $_taxvat->setTaxvat($this->getCustomer()->getTaxvat())->toHtml() ?></li>
        <?php endif ?>
        <?php $_gender = $this->getLayout()->createBlock('customer/widget_gender') ?>
        <?php if ($_gender->isEnabled()): ?>
            <li><?php echo $_gender->setGender($this->getCustomer()->getGender())->toHtml() ?></li>
        <?php endif ?>
            <li class="control">
                <input type="checkbox" name="change_password" id="change_password" value="1" onclick="setPasswordForm(this.checked)" title="<?php echo $this->__('Change Password') ?>"<?php if($this->getCustomer()->getChangePassword()==1): ?> checked="checked"<?php endif; ?> class="checkbox" /><label for="change_password"><?php echo $this->__('Change Password') ?></label>
            </li>
        </ul>
    </div>
    <div class="fieldset" style="display:none;">
        <h2 class="legend"><?php echo $this->__('Change Password') ?></h2>
        <ul class="form-list">
            <li>
                <label for="current_password" class="required"><em>*</em><?php echo $this->__('Current Password') ?></label>
                <div class="input-box">
                    <input type="password" title="<?php echo $this->__('Current Password') ?>" class="input-text" name="current_password" id="current_password" />
                </div>
            </li>
            <li class="fields">
                <div class="field">
                    <label for="password" class="required"><em>*</em><?php echo $this->__('New Password') ?></label>
                    <div class="input-box">
                        <input type="password" title="<?php echo $this->__('New Password') ?>" class="input-text validate-password" name="password" id="password" />
                    </div>
                </div>
                <div class="field">
                    <label for="confirmation" class="required"><em>*</em><?php echo $this->__('Confirm New Password') ?></label>
                    <div class="input-box">
                        <input type="password" title="<?php echo $this->__('Confirm New Password') ?>" class="input-text validate-cpassword" name="confirmation" id="confirmation" />
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <div class="buttons-set">
        <p class="required"><?php echo $this->__('* Required Fields') ?></p>
        <p class="back-link"><a href="<?php echo $this->escapeUrl($this->getBackUrl()) ?>"><small>&laquo; </small><?php echo $this->__('Back') ?></a></p>
        <button type="submit" title="<?php echo $this->__('Save') ?>" class="button"><span><span><?php echo $this->__('Save') ?></span></span></button>
    </div>
</form>
<script type="text/javascript">
//<![CDATA[
    var dataForm = new VarienForm('form-validate', true);
    function setPasswordForm(arg){
        if(arg){
            $('current_password').up(3).show();
            $('current_password').addClassName('required-entry');
            $('password').addClassName('required-entry');
            $('confirmation').addClassName('required-entry');

        }else{
            $('current_password').up(3).hide();
            $('current_password').removeClassName('required-entry');
            $('password').removeClassName('required-entry');
            $('confirmation').removeClassName('required-entry');
        }
    }
    <?php if($this->getCustomer()->getChangePassword()): ?>
        setPasswordForm(true);
    <?php endif; ?>
//]]>
</script> 
```

# jquery - 推荐 jQuery 插件的设计模式 - 传递选项或方法？

> ID：13070006
> 
> 赞同：1
> 
> 时间：2012-10-25T13:45:03.073
> 
> 标签：jquery

jQuery 文档建议为插件设置默认值，并允许用户发送任何自定义值。为此，用户使用 将自定义值作为对象传递`$.fn.tooltip = function( options ) {}`。我感觉合理。

然后在同一篇文章的后面，他们建议将插件的所有方法收集在一个称为方法的对象文字中，并通过传递方法的字符串名称来调用给定的方法，例如`$.fn.tooltip = function( method ) {}`.

那么，我要发送选项或方法`$.fn.tooltip = function( ? ) {}`吗？

另外，为什么方法对象是在插件之外声明的？

来源：[http ://docs.jquery.com/Plugins/Authoring#Defaults_and_Options](http://docs.jquery.com/Plugins/Authoring#Defaults_and_Options)

```
(function( $ ){

  $.fn.tooltip = function( options ) {  

    // Create some defaults, extending them with any options that were provided
    var settings = $.extend( {
      'location'         : 'top',
      'background-color' : 'blue'
    }, options);

    return this.each(function() {        

      // Tooltip plugin code here

    });

  };
})( jQuery ); 
```

来源：[http ://docs.jquery.com/Plugins/Authoring#Plugin_Methods](http://docs.jquery.com/Plugins/Authoring#Plugin_Methods)

```
(function( $ ){

  var methods = {
    init : function( options ) { 
      // THIS 
    },
    show : function( ) {
      // IS
    },
    hide : function( ) { 
      // GOOD
    },
    update : function( content ) { 
      // !!! 
    }
  };

  $.fn.tooltip = function( method ) {

    // Method calling logic
    if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
      return methods.init.apply( this, arguments );
    } else {
      $.error( 'Method ' +  method + ' does not exist on jQuery.tooltip' );
    }    

  };

})( jQuery );

// calls the init method
$('div').tooltip(); 

// calls the init method
$('div').tooltip({
  foo : 'bar'
}); 
```

# javascript - iframe 的 javascript - 加载消息以及如果没有连接该怎么办

> ID：13070007
> 
> 赞同：1
> 
> 时间：2012-10-25T13:45:04.423
> 
> 标签：javascript, iframe

[如何在页面加载之前将加载消息放入 iframe](https://stackoverflow.com/questions/7434967/how-to-put-loading-message-in-iframe-before-page-was-loaded)

我已经使用上面链接上的建议来帮助解决我的问题，但它并不是很干净。

我的问题：我管理一个大型 CMS，我们想要一些内容不仅需要登录，还需要员工在本地 Intranet 上。所以 CMS 是互联网，我有另一个本地 Intranet 服务器来提供内容。

员工转到该页面，我有一个干净的 Intranet 网站 iframe。唯一的问题是，如果他们没有连接，我不希望他们看到浏览器错误消息。我希望他们看到我的错误消息，因为如果他们看不到我的错误消息，我们的技术服务台就会接到大量电话。我现在正在使用上面的代码，我可以在上面设置很长时间，但最终人们会看到“无法连接”的消息......我有什么选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:50:49.750

我有一个建议，但我不能保证它是否会起作用，因为我没有尝试过，但这对我来说很有意义。

如果你愿意牺牲一个 HEAD 请求，那么你可以使用 jQuery 做这样的事情：

```
$.ajax({
    type: "HEAD",
    async: true,
    url: "http://someurl.local",
    success: function(message,text,response){
        // Success, connectivity assured, load iframe
        $("#myiframe").prop("src","someurl.local");
    },
    error: function(response){
        // Show your error
        alert("Sorry, no connectivity, dont contact support please. :)");
    }
}); 
```

# c++ - 使用 Magick++ 解码 PNG 图像

> ID：13070008
> 
> 赞同：1
> 
> 时间：2012-10-25T13:45:05.947
> 
> 标签：c++, image, image-processing, imagemagick, opencl

我需要将解码的 RGBA 数据（来自 32 位 PNG）放入 cl::Image2D 中，然后（经过一些处理）使用 enqueueReadImage() 将其写回 Magick++ 图像。

但是，目前我看不到任何直接在 Magick++ 图像对象中访问 RGBA 数据的方法。这可能吗？如果没有，从 Magick++ 对象获取 RGBA 格式数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:34:13.740

您可以使用 Magick::Image::write 函数

```
Magick::Image im;
// read image ....

// only for RGBA !!!
size_t im_size = im.columns() * im.rows() * 4;
uint8_t * pixels = new uint8_t[im_size];
im.write(0, 0, im.columns(), im.rows(), "RGBA", ::Magick::CharPixel, pixels); 
```

# objective-c - 在实现 NSCoding 协议方法时释放时崩溃

> ID：13070011
> 
> 赞同：1
> 
> 时间：2012-10-25T13:45:12.543
> 
> 标签：objective-c, nscoding

以下是我用于取消归档数据的代码：

```
- (id)initWithCoder:(NSCoder *)decoder
{
    if((self = [super init]))
    {
        NSString *resoureItemClassName = NSStringFromClass([ResourceItem class]);
        self.selectedItemClassName=[decoder decodeObjectForKey:@"selectedItemClassName"];
        Class class = NSClassFromString(selectedItemClassName);
        id temp = nil;

        if(class)
        {      
            temp = [[class alloc] init];
        }

        if(temp)
        {
            if([temp isKindOfClass:[NSString class]])
            {
                self.selectedString = [decoder decodeObjectForKey:@"selectedString"];;
                self.ID = selectedString;
            }
            else if([selectedItemClassName isEqualToString:resoureItemClassName])
            {  
                DLog(@"Resource item")
            }

            [temp release];                         
        }
        else
        {    
            self.ID = nil;
        }
    }

    return self;
} 
```

当我释放 tempObject 时，应用程序崩溃。如果我不这样做，那就是泄漏。我尝试使用自动释放方法。然后还是崩溃了？解决办法是什么？

**更新：**

selectedItemClassName 中的编码数据是 __NSCFConstantString 或 __NSCFString。崩溃仅发生在 __NSCFString 而不是 __NSCFConstantString 作为类名时，

可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T00:59:32.377

怎么样：

```
- (id)initWithCoder:(NSCoder *)decoder
{
    if((self = [super init]))
    {
        NSString *resourceItemClassName = NSStringFromClass([ResourceItem class]);
        self.selectedItemClassName=[decoder decodeObjectForKey:@"selectedItemClassName"];
        Class class = NSClassFromString(selectedItemClassName);

        if(class)
        {      
            NSString *stringClassName = NSStringFromClass([NSString class]);
            if([stringClassName isEqualToString:self.selectedItemClassName])
            {
                self.selectedString = [decoder decodeObjectForKey:@"selectedString"];;
                self.ID = selectedString;
            }
            else if([self.selectedItemClassName isEqualToString:resourceItemClassName])
            {  
                DLog(@"Resource item")
            }
        }
        else
        {    
            self.ID = nil;
        }
    }

    return self;
} 
```

# php - 在处理上传的文件之前将一个php文件写入mysql

> ID：13070017
> 
> 赞同：-1
> 
> 时间：2012-10-25T13:45:33.397
> 
> 标签：php, javascript, mysql, file, upload

到目前为止，我有第一个插入表格的代码，然后

```
 if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'][$key], $tp)) {   } 
```

我正在尝试在实际文件上传处理程序之外读取插入的记录，因为上传正在使用 javascript 进行。似乎只有在文件上传后才插入记录。

如何通过允许写入 mysql 然后启动上传进度来防止这种情况。

对于上传大文件很有用，我试图让人们在文件上传时设置上传文件的信息，使用upload_progress_key等用php 5.4开发了一个漂亮的进度条，但问题是我无法了解如果文件信息在数据库中以允许编辑用户设置的自定义参数。

感谢您在这里的第一次投反对票，谢谢。

这就是我所做的：

```
mysql_query("INSERT INTO TABLE VALUES VALUES"); 
```

到目前为止很棒，

现在

```
move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $dest); 
```

问题是在尝试读取 700mb 文件时正在上传 file_upload.php

read.php 内容：

```
mysql_query("SELECT * FROM table WHERE values="values"); 
```

返回 0

直到上传完全完成，现在它返回 1。

那么它与 move_uploaded_file() 有什么关系

和 mysql_query("INSERT INTO");

虽然在语法上是先写的 mysql_query("INSERT INTO");

在文件完全上传到服务器之前，这似乎不会发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:56:58.263

PHP 中的文件上传工作如下：

*   用户在浏览器中选择要上传的文件，提交表单
*   浏览器将表单（包括文件）上传到*Web 服务器*
*   Web 服务器将接收到的文件写入临时位置
*   整个上传完成后，Web 服务器启动 PHP 脚本

换句话说，当 PHP 脚本运行时，上传已经完成了很长时间。`move_uploaded_file`只是移动服务器硬盘上的文件，它不会启动实际的上传，正如您所假设的那样。

如果您想在文件上传之前做任何事情，您必须向另一个 PHP 脚本发出 AJAX 请求，或者在文件上传的请求周期之外进行通信。

# ruby-on-rails-3 - 管理复杂的 JSON

> ID：13070025
> 
> 赞同：1
> 
> 时间：2012-10-25T13:46:02.193
> 
> 标签：ruby-on-rails-3, json

我有一个复杂的输入 JSON，如下所示：

```
@json = {"project":"bla",
    "analysis": {"id":"123","title":"Test"}, 
    "data":{"axis": {"name":"column", "label":"demo","values": ["one", "two"]},
           "series": [{"label":"text", "values":["1", "2", "3"]}, 
                    {"label":"text2", "values":["4", "5", "6"]}
]}} 
```

（比这个例子更复杂和长度）

两个问题：

1.  它存在一个可以在 json 中动态删除某些东西的 RoR 方法吗？类似的东西 `@json.destroy['analysis']`只消除“分析”键值对吗？

2.  我如何导航（例如）系列的值？如果 json 很简单，我可以做到`do each`，但我必须在这里做一个 concecation`do each`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:16:06.607

您可以将 JSON 转换为哈希，删除密钥，然后再转换回 JSON：

```
require "json"
hash = JSON.parse(@json)
hash.delete("analysis")
@json = hash.to_json 
```

# php - 结束在我的网站上显示的 PHP 标记

> ID：13070030
> 
> 赞同：2
> 
> 时间：2012-10-25T13:46:20.360
> 
> 标签：php, html, css, google-chrome

好吧，如果有帮助，我正在使用谷歌浏览器，但这是我的代码。

```
Name:<input style='margin-left:14%;' type='text' readonly='readonly' name='name' value="<?php echo $_SESSION['username']; ?>" /> 
```

这是我正在为评论部分处理的表单，并且有一个名称值设置为只读，它显示他们在那里登录的用户名。但是结束 PHP 标记 (?>) 显示在表单的底部，我不知道为什么。有什么好主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:49:58.920

代码提供了它的罚款

在您的表格中，您可能没有开始`<?php`或您已经关闭只有 ?> 不被视为`<?php`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:59:12.010

如果您的表单周围有 php 标签，它将在到达最后一个标签之前关闭，并在页面上显示最后一个标签。这个

```
<?php <?php ?> ?> 
```

上面的代码将显示为

?>

# libav - LibAV Mpeg_TS 流似乎不包含 I 帧

> ID：13070032
> 
> 赞同：0
> 
> 时间：2012-10-25T13:46:28.567
> 
> 标签：libav, mpeg2-ts

我正在尝试获取 YUV 420 流，将其转换为 MPEG2 并通过 UDP 作为传输流发送。

转换似乎工作正常，通过保存输出我可以创建一个可播放的 MPEG。在wireshark 中查看传输的数据包时，我可以看到程序关联和程序映射表（它们看起来是正确的）以及b 帧和p 帧。我看不到任何 I 帧，但可以看到 MPEG 序列标头数据包。

使用 VLC 我无法查看流（UDP://239.192.1.114:6677）

下面是一段代码，展示了视频包的转换和传输。

任何关于为什么我看不到 I 帧的想法将不胜感激。

```
bool MPEGTransmitter::InitMPEG(int width, int height)
{

    /* find the mpeg2 video encoder */
    codec = avcodec_find_encoder(CODEC_ID_MPEG2VIDEO);
    if (!codec) 
    {
        //debugCb("Codec Not Found"); //fprintf(stderr, "codec not found\n");
        return false;
    }

    codecCtxt = avcodec_alloc_context3(codec);
    picture= avcodec_alloc_frame();

    /* put sample parameters */
    codecCtxt->bit_rate = 0;
    /* resolution */
    codecCtxt->width = width;
    codecCtxt->height = height;
    /* frames per second */
    AVRational avr;
    avr.den = 25;
    avr.num = 1;
    codecCtxt->time_base= avr;
    codecCtxt->gop_size = 5; /* emit one intra frame every 5 frames */
    codecCtxt->max_b_frames=2;
    codecCtxt->pix_fmt = PIX_FMT_YUV420P;   // 4:2:0 used for MPEG

    /* open it */
    if (avcodec_open2(codecCtxt, codec,NULL) < 0) 
    {
        //debugCb("Could not open video codec"); //fprintf(stderr, "could not open codec\n");
        return false;
    }

    /* alloc image and output buffer */
    outbuf_size = 100000;
    outbuf = (uint8_t*)malloc(outbuf_size);
    size = codecCtxt->width * codecCtxt->height;
    picture_buf = (uint8_t*)malloc((size * 3)/2); /* size for YUV 420 */

    picture->data[0] = picture_buf;
    picture->data[1] = picture->data[0] + size;
    picture->data[2] = picture->data[1] + size/4;
    picture->linesize[0] = codecCtxt->width;
    picture->linesize[1] = codecCtxt->width /2 ;
    picture->linesize[2] = codecCtxt->width /2;

    SaveToFile(outfileName);
    //MpegInitialised = true;

    std::stringstream ssLog;
    ssLog << "MPEG initialised with Height "<< height << " Width " << width << endl;
    WriteLogMsg(ssLog.str());

    return true;
}

void MPEGTransmitter::WriteFrame(unsigned char* Yarray, unsigned char* cbArray, unsigned char* crArray)
{
    /* prepare the image */
    /* Y */
    int idx=0;
    for(int y=0;y<codecCtxt->height;y++) 
    {
        for(int x=0;x<codecCtxt->width;x++) 
        {
            picture->data[0][y * picture->linesize[0] + x] = Yarray[idx++];
        }
    }

    /* Cb and Cr */
    for(int y=0;y < codecCtxt->height/2 ;y++) 
    {
        for(int x=0;x< codecCtxt->width/2 ;x++) 
        {
            picture->data[1][y * codecCtxt->width/2 + x] = (cbArray[(y*codecCtxt->width)+x] + cbArray[(y*codecCtxt->width)+ x+1])/2; 
            picture->data[2][y * codecCtxt->width/2 + x] = (crArray[(y*codecCtxt->width)+x] + crArray[(y*codecCtxt->width)+ x+1])/2;
        }
    }

    /* encode the image */
    out_size = avcodec_encode_video(codecCtxt, outbuf, outbuf_size, picture);

    /* send the image */
    WriteMpegTS(outbuf, out_size,0x1F);

    /* save the image */
    if( fVideoOut )
    {
        fwrite(outbuf, 1, out_size, fVideoOut);
    }
 }

void MPEGTransmitter::WriteMpegTS(uint8_t* pPayloadPkt, int iPktSize, unsigned int iPidLower)
{
    int dataCounter = 0;
    bool firstPacket=true;

    while(dataCounter < iPktSize)
    {   
        // TS Packets are 188 bytes long, 4 byte header followed by payload
        char* pTSPkt = new char[188];
        pTSPkt[0] = 0x47; // Sync byte

        if(firstPacket) 
        {
            pTSPkt[1] = 0x40; // start of payload flag set + high bytes of payload id
            firstPacket=false;
        }
        else
        {
            pTSPkt[1] = 0; // start of payload flag not set + high bytes of payload id
        }

        pTSPkt[2] = iPidLower; // low bytes of payload id

        pTSPkt[3] = 0x10 | getContinuityCounter(iPidLower); //returns the cont. counter for the specified pkt type

        // Fill the rest of the packet with data, or padding if no more data to add
        for(int i= 4; i< 188; i++)
        {
            if(dataCounter <iPktSize)
            {
                pTSPkt[i] = pPayloadPkt[dataCounter++];
            }
            else
            {
                pTSPkt[i] = 0xFF;
            }
        }

        // Send the packet over multicast/rtp
        unsigned int pktSize = 188;
        sktMpeg->SendMsg(pTSPkt, pktSize); // calls the sendMsg function of the socket class
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T11:45:42.983

我一直认为 LIBav 编码调用会返回一个打包的基本流数据包，结果它是一个标准的 ES 数据包。通过将其包装在 PES 标头中，然后将其放入传输流数据包中（每个 UDP 7 个），我可以流式传输看似正确的 mpeg TS。尽管我认为这是特定于实现的，但让 VLC 显示框架仍然存在一些问题。

# python - 使用 Python 通过邮件发送的附件图像

> ID：13070038
> 
> 赞同：19
> 
> 时间：2012-10-25T13:46:36.893
> 
> 标签：python, smtp

> **可能重复：**
> [如何使用 python 发送电子邮件附件](https://stackoverflow.com/questions/3362600/how-to-send-email-attachments-with-python)

我已经使用 Python 在 sendEmail 上做了一些工作我得到了这个代码

```
import smtplib
def SendAnEmail( usr, psw, fromaddr, toaddr):
    # SMTP server
    server=smtplib.SMTP('smtp.gmail.com:587')
    server.starttls()
    server.login(usr,psw)
    # Send 
    msg="text message ....... "

    server.sendmail(fromaddr, toaddr, msg)
    server.quit()
if __name__ == '__main__':
    # Fill info...
    usr='example@sender.ex'
    psw='password'
    fromaddr= usr
    toaddr='example@recevier.ex'
    SendAnEmail( usr, psw, fromaddr, toaddr) 
```

如果我需要添加图像（附加图像）怎么办？有人知道吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-25T15:15:42.083

```
import os
import smtplib
from email.mime.text import MIMEText
from email.mime.image import MIMEImage
from email.mime.multipart import MIMEMultipart

def SendMail(ImgFileName):
    with open(ImgFileName, 'rb') as f:
        img_data = f.read()

    msg = MIMEMultipart()
    msg['Subject'] = 'subject'
    msg['From'] = 'e@mail.cc'
    msg['To'] = 'e@mail.cc'

    text = MIMEText("test")
    msg.attach(text)
    image = MIMEImage(img_data, name=os.path.basename(ImgFileName))
    msg.attach(image)

    s = smtplib.SMTP(Server, Port)
    s.ehlo()
    s.starttls()
    s.ehlo()
    s.login(UserName, UserPassword)
    s.sendmail(From, To, msg.as_string())
    s.quit() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:58:08.940

阅读文档。smtpblib 文档的最后几行内容如下：

> 注意 通常，您会希望使用电子邮件包的功能来构造电子邮件，然后您可以将其转换为字符串并通过 sendmail() 发送；请参阅电子邮件：示例。

并指向：[https ://docs.python.org/3/library/email.examples.html](https://docs.python.org/3/library/email.examples.html)

这有一个确切的例子。

# jquery - prettyPhoto 附加关闭按钮

> ID：13070039
> 
> 赞同：1
> 
> 时间：2012-10-25T13:46:40.297
> 
> 标签：jquery, window, modal-dialog, prettyphoto

我创建了一些使用 jQuery prettPhoto 插件启动的内联内容。我想在我的内容区域中添加一个额外的关闭按钮，但不知道需要做什么才能使我的按钮关闭模式。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T12:11:29.337

在关闭按钮的单击事件处理程序中尝试此代码
`window.parent.$.prettyPhoto.close();`

# cordova - Security_ERR：DOM 异常 18 openDatabase() 使用 Phonegap

> ID：13070042
> 
> 赞同：5
> 
> 时间：2012-10-25T13:46:51.063
> 
> 标签：cordova

我已经使用 phonegap 模板创建了 HTML5/JQuery 项目。我正在尝试将信息存储在本地数据库中。目前，我正在使用模拟器 ElectricMobileStudio2012 进行测试。我在这行代码中收到错误“ **Security_ERR: DOM Exception 18 ”：**

```
var db = window.openDatabase("MobileInspection", "1.0", "Mobile Inspection Database", 200000); 
```

这是我的代码。我已经坚持了好几天了，我什至尝试使用这些代码行来解决这个错误：

```
navigator.openDatabase = window.openDatabase = DroidDB_openDatabase;

window.droiddb = new DroidDB(); 
```

* * *

这是我的代码：

```
function SaveUserInfoLocally(data) {
    try {
        var rememberMe = $('#chkRememberMe').is(':checked')
        if (rememberMe) {
            // TODO: Save user details in local db.
            //navigator.openDatabase = window.openDatabase = DroidDB_openDatabase;
            //window.droiddb = new DroidDB();
            var db = window.openDatabase("MobileInspection", "1.0", "Mobile Inspection Database", 200000);
            db.transaction(populateUsersTable, errorCB, successCB);
            db.transaction(queryDB, errorCB);
        }
    }
    catch (error) {
        alert(error);
    }
}

function populateUsersTable(tx) {
    try {
        var userName = window.localStorage.getItem("UserName");
        var firstName = window.localStorage.getItem("FirstName");
        var lastName = window.localStorage.getItem("LastName");
        //alert(userName + " " + firstName + " " + lastName);
        tx.executeSql("DROP TABLE IF EXISTS UserDetails");
        tx.executeSql("CREATE TABLE IF NOT EXISTS UserDetails (UserName, FirstName, LastName)");
        tx.executeSql("INSERT INTO UserDetails (UserName, FirstName, LastName) VALUES ('" + userName + "', '" + firstName + "', '" + lastName + "')");
        alert("populate");
    }
    catch (exception) {
        alert(exception);
    }
}

function errorCB(err) {
    alert("Error processing: " + err);
}

function successCB() {
    alert("success!"); 
}

function queryDB(tx) {
    try {
        tx.executeSql('SELECT * FROM UserDetails', [], querySuccess, errorCB);
    }
    catch (exception) {
        alert(exception);
    }
}

// Testing
function querySuccess(tx, results) {
    try {
        if (results) {
            alert("records");
        }
        else {
            alert(results);
        }
    }
    catch (exception) {
        alert(exception);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T21:16:48.330

我有一个类似的问题 - 因此我偶然发现了这个问题。

确保所有本地存储调用在 deviceready 块内执行：

```
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {
    //do ALL your localstorage stuff here
} 
```

# regex - Linux：从行中提取和转换属性

> ID：13070043
> 
> 赞同：1
> 
> 时间：2012-10-25T13:46:54.323
> 
> 标签：regex, linux, shell, awk, nawk

如果有一个文件，其行格式如下：

`SOME_ATTRIBUTE_1 XYZ; IMPORTANT_ATTRIBUTE_1 1234; SOME_ATTRIBUTE_2 XYZ; IMPORTANT_ATTRIBUTE_2 AB;`

现在我想把它转换成下面的形式，两个重要的属性值产生一个新的属性：

`JOIN_IMPORTANT_ATTRIBUTE AB1234; SOME_ATTRIBUTE_1 XYZ; IMPORTANT_ATTRIBUTE_1 1234; SOME_ATTRIBUTE_2 XYZ; IMPORTANT_ATTRIBUTE_2 AB;`

这可以用 awk 或类似的单线来完成吗？我不知道如何解决这个问题，而不是抓住Java技巧箱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:04:40.107

使用 awk 您可以将输入拆分为分号 + 任意数量的空格，并进一步拆分重要字段，如下所示：

```
awk -F'; *' '{ split($2, a1, / +/); split($4, a2, / +/); print "JOIN_IMPORTANT_ATTRIBUTE", a2[2] a1[2] ";", $0 }' infile 
```

输出：

```
JOIN_IMPORTANT_ATTRIBUTE AB1234; SOME_ATTRIBUTE_1 XYZ; IMPORTANT_ATTRIBUTE_1 1234; SOME_ATTRIBUTE_2 XYZ; IMPORTANT_ATTRIBUTE_2 AB; 
```

这假设您知道重要属性在哪些列中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:52:19.103

Perl 解决方案：

```
perl -lane 'print join " ", "JOIN_IMPORTANT_ATTRIBUTE", substr($F[7], 0, -1) . $F[3], @F' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T16:50:43.857

```
awk -F'[; ]+' '{print "JOIN_IMPORTANT_ATTRIBUTE", $8 $4 "; " $0}' file 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T19:04:43.510

这是我的 bash+awk 替代方案。

```
cat attrs.awk
# Awk script to get joined attributes for one line of attributes

BEGIN {
RS=";";     
PROCINFO["sorted_in"]="@ind_num_asc"; #gawk only: sort attributes on their attr id (so that IMPORTANT_ATTRIBUTE_n comes before IMPORTANT_ATTRIBUTE_n+1
}

$1 ~ /^IMPORTANT_ATTRIBUTE_/ {
            attrId=substr($1, 1 + length("IMPORTANT_ATTRIBUTE_"));
    if ($2 ~ /^[0-9]/) 
            impAttrsNum[attrId]=$2;
    else
            impAttrsAlpha[attrId]=$2;
}

END {
    #alpha attribs come before num attribs
    for(i in impAttrsAlpha)
            alphaVals = alphaVals impAttrsAlpha[i];
    for(i in impAttrsNum)
            numVals = numVals impAttrsNum[i];

    printf("JOIN_IMPORTANT_ATTRIBUTE %s%s%s", alphaVals, numVals, RS);
}

cat joinattrs
#!/bin/bash
#
# Applies joined attributes for each input line

while read l
do
    if [[ -n "$l" ]]
    then   
            joinAttrs=$(echo "$l" | awk -f attrs.awk)
            echo "$joinAttrs $l"
    fi
done 
```

使用方法：./joinattrs < 数据文件

不是单行的:)

# android - 带有 @String 引用的 Android 清单 - 特别是 android:authorities

> ID：13070046
> 
> 赞同：2
> 
> 时间：2012-10-25T13:47:14.900
> 
> 标签：android, string, resources, manifest

我的清单有这个问题。

看起来这可能是一个骗局： [Using @string for android:authorities in a ContentProvider](https://stackoverflow.com/questions/6461776/using-string-for-androidauthorities-in-a-contentprovider)

我有一个为不同版本的应用程序提供单独权限的提供程序（以便可以将不同的变体存储在不同目标 res 文件夹的字符串文件夹中。

我的清单如下所示：

```
 <provider android:authorities="@string/app_provider_auth" android:name="com.mecompany.myapp.provider.CachedFileProvider"/> 
```

`Bad Manifest`现在，这工作正常，但是当它安装在 2.1 OS 设备上时我看到了一个问题。这是问题，因为当我将其更改为文本字符串时，它在 2.1 上运行良好。

我认为在 2.1 (7) 或更早版本中，清单不允许您从资源文件中引用字符串。那么，我可以为版本 7 创建一个单独的清单吗？我可以在清单中添加一个 if 语句吗？还是我必须提高 minSDK（最后的手段）？

## 更新：

确定进一步搜索似乎我可以使用我的 Maven 构建设置/切换提供者身份验证字符串。我已经有许多配置文件并且正在覆盖资源文件夹。所以我对这个想法很满意，但它是我无法理解的。就像是

```
<replaceAuthority>${customerauthority}<replaceAuthority> 
```

但是我不知道我应该使用什么标签，或者我上面假设的方式是否是我需要走的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T06:15:56.857

要从 maven 更改提供者，您可以使用`<providerAuthorities>`如下标签：

```
 <plugin>
        <groupId>com.jayway.maven.plugins.android.generation2</groupId>
        <artifactId>android-maven-plugin</artifactId>
        <version>3.5.0</version>
        <extensions>true</extensions>
        <configuration>

            <!-- Установка версии в манифест -->
            <manifest>
                <versionName>${project.version.name}</versionName>
                <versionCode>${project.version.code}</versionCode>

                <!-- провайдер -->
                <providerAuthorities>
                    <property>
                        <name>.database.DatabaseProvider</name>
                        <value>${project.package}.database.DatabaseProvider</value>
                    </property>                        
                </providerAuthorities>

            </manifest>
        </configuration>
    </plugin> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T14:56:07.857

从这里获得更多帮助[android-maven-plugin 和资源过滤](https://stackoverflow.com/questions/10900017/android-maven-plugin-and-resource-filtering)

这里[https://github.com/jayway/maven-android-plugin/pull/115](https://github.com/jayway/maven-android-plugin/pull/115)

和@Konstantin Pridluda 我得出了一个可以接受的结论。

我所做的是在父项目文件夹中创建一个名为 manifests 的新文件夹。然后创建了两个子文件夹 customer1Manifest 和 customer2Manifest

在每个文件夹中，我创建了清单文件的副本，然后将 @string 引用替换为适当的硬字符串权限。（正常的清单文件是调试授权）

然后在 POM 中，我将清单切换为像这样的适当清单。

```
<profiles>
    <profile>
     <id>Customer1</id>
     <activation>
         <activeByDefault>true</activeByDefault>
     </activation>
     <properties>
  <customerManifest>../manifests/customer1Manifest/AndroidManifest.xml</customerManifest>
      </properties>
    </profile>
    <profile>
     <id>Customer2</id>
     <properties>
        <customerManifest>../manifests/customer2Manifest/AndroidManifest.xml</customerManifest>
      </properties>
      </profile>
</profiles> 
```

然后后来在 android-maven-plugin 阶段这样做了

```
 <plugin>
        <groupId>com.jayway.maven.plugins.android.generation2</groupId>
        <artifactId>android-maven-plugin</artifactId>
        <extensions>true</extensions>

        <inherited>true</inherited>
        <configuration>
         <androidManifestFile>${customerManifest}</androidManifestFile>
            .........
.......
        </configuration>
</plugin> 
```

# javascript - JavaScript 闭包的使用

> ID：13070050
> 
> 赞同：2
> 
> 时间：2012-10-25T13:47:30.687
> 
> 标签：javascript, closures

在阅读了 JavaScript 中的闭包之后，我仍然无法理解它们在哪里使用？如果没有闭包，那么这些事情将如何交替进行（如果可能的话）以及闭包的使用会简化什么。如果有人可以用 JavaScript 中的一些代码示例来解释这一点，那将会很有帮助。也欢迎任何指向解释这一点的文章的链接。我已经阅读了[类似问题](https://stackoverflow.com/questions/9578441/javascript-closures)中提到的[这篇](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures)文章。它用这样的代码解释

```
 function makeSizer(size) {
      return function() {
        document.body.style.fontSize = size + 'px';
      };
    }

    var size12 = makeSizer(12);
    var size14 = makeSizer(14);
    var size16 = makeSizer(16);

document.getElementById('size-12').onclick = size12;
document.getElementById('size-14').onclick = size14;
document.getElementById('size-16').onclick = size16; 
```

但是，当我可以轻松创建这样的函数时，为什么我会这样做

```
function sizer(size) {
            document.body.style.fontSize = size + 'px';
          };

    document.getElementById('size-12').onclick = function(){sizer(12)};
    document.getElementById('size-14').onclick = function(){sizer(14)};
    document.getElementById('size-16').onclick = function(){sizer(16)}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:56:09.393

在您的示例中，将`makeSizer()`return 设为函数将意味着更少的代码。

```
function makeSizer(size) {
    return function() {
        document.body.style.fontSize = size + 'px';
    };
}

document.getElementById('size-12').onclick = makeSizer(12);
document.getElementById('size-14').onclick = makeSizer(14);
document.getElementById('size-16').onclick = makeSizer(16); 
```

对比

```
function sizer(size) {
    document.body.style.fontSize = size + 'px';
};

document.getElementById('size-12').onclick = function(){sizer(12)};
document.getElementById('size-14').onclick = function(){sizer(14)};
document.getElementById('size-16').onclick = function(){sizer(16)}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:57:50.943

你可以用闭包做很多事情。关于您的问题：闭包用于设置部分功能。当柯里化出现时，这种技术用于函数式编程。柯里化意味着在每个参数传递并返回它的结果之后调用一个函数。主要是一个部分函数，​​但是当所有参数都被传递时，它将返回最终值。您只是通过显式返回一个新函数来假装做的那种技术。

为什么有用？好吧，它是一种函数式编程技术，您可以将其与面向对象编程中的部分类进行比较。

在某些情况下，这个概念很有用。阅读我在[software-innovators.nl](http://www.software-innovators.nl/2009/08/07/the-ultimate-power-of-currying-with-closures/)上的博客，了解深入的示例。

请记住，这是需要闭包的更多示例之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T20:26:05.167

我认为这个[SO](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work)答案非常详细地解释了这个概念。阅读本文后，我的理解是闭包可以将函数作为一流的对象。作为第一类对象的函数非常有用，因为它们可以像参数一样传递，并使某些事情变得非常容易。

使用闭包的另一个好处可能是它们可用于在 JavaScript 中使成员私有，如本文所述[。](http://www.crockford.com/javascript/private.html)

# android - 创建多个位图并将它们绑定到纹理

> ID：13070053
> 
> 赞同：2
> 
> 时间：2012-10-25T13:47:41.160
> 
> 标签：android, opengl-es, bitmap, textures

我需要创建一个位图并将其作为纹理加载（在程序中创建一个位图，制作一些图纸，然后将其绑定到纹理）

从文件系统加载位图是这样的

```
 private int images[] = {
            R.drawable.one,
            R.drawable.two,
            R.drawable.six,
            R.drawable.five,
            R.drawable.three,
            R.drawable.four,
}; 
```

我的 loadTexture 函数看起来像这样

```
public void loadGLTexture(GL10 gl, Context context) {
        // Generate texture pointer
        gl.glGenTextures(images.length, textures, 0);
        for (int image = 0; image < images.length; image++) {
            // bind texture pointer 
            gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[image]);
            // create nearest filtered texture
            gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER, GL10.GL_LINEAR);
            gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER, GL10.GL_LINEAR);
            // different possible texture parameters, e.g. GL10.GL_CLAMP_TO_EDGE
            gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_S, GL10.GL_REPEAT);
            gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_T, GL10.GL_REPEAT);
            // get the texture from the Android resource directory
            {
                InputStream is = context.getResources().openRawResource(images[image]);
                Bitmap bitmap = null;
                try {
                    // BitmapFactory is an Android graphics utility for images
                    bitmap = BitmapFactory.decodeStream(is);
                } finally {
                    try {
                        // Always clear and close
                        is.close();
                        is = null;
                    } catch (IOException e) {
                    }
                }
                // use Android GLUtils to specify a 2D texture image from our bitmap
                GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, bitmap, 0);
                // cleanup
                bitmap.recycle();
            }
        } 
```

最后我有一个绘制画布并将其保存在位图中的函数。（现在只有一个）我想知道如何将创建的位图应用于图像数组。

```
public Bitmap onDraw( Canvas canvas) {
    Paint paint = new Paint();
    canvas.drawColor(Color.BLUE);

   Bitmap one = Bitmap.createBitmap(256, 256, Bitmap.Config.RGB_565);
   Canvas c = new Canvas(one);
   canvas.drawRect(0, 0, 256, 256, paint);

   paint.setTextSize(40);
   paint.setTextScaleX(1.f);
   paint.setAntiAlias(true);
   canvas.drawText("Your text", 30, 40, paint);
   paint.setColor(Color.RED);
return one;

} 
```

如何将位图加载到 int[] 数组？

谢谢

# javascript - 在Javascript中将rgb字符串转换为十六进制

> ID：13070054
> 
> 赞同：26
> 
> 时间：2012-10-25T13:47:45.280
> 
> 标签：javascript, hex, rgb

我正在使用带有 ColorPropsPlugin 的 TweenMax JS 库，它将补间以多种格式指定的颜色值，我遇到的问题是结果始终采用字符串的形式：

```
"rgb(255,255,255)" 
```

如何将其转换为十六进制数字，例如：

```
0xffffff 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-25T13:55:35.250

我首先会删除 CSS 部分：

```
var a = "rgb(255,255,255)".split("(")[1].split(")")[0]; 
```

然后将其拆分为单独的数字：

```
a = a.split(","); 
```

将单个数字转换为十六进制

```
var b = a.map(function(x){             //For each array element
    x = parseInt(x).toString(16);      //Convert to a base16 string
    return (x.length==1) ? "0"+x : x;  //Add zero if we get only one character
}) 
```

并将其粘在一起：

```
b = "0x"+b.join(""); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-25T14:13:38.283

以下内容改编`Colour`自我编写和使用的一个类，但由于它处理百分比和负数，因此可能无法满足您的需求。

演示：http: [//jsfiddle.net/5ryxx/1/](http://jsfiddle.net/5ryxx/1/)

代码：

```
function componentFromStr(numStr, percent) {
    var num = Math.max(0, parseInt(numStr, 10));
    return percent ?
        Math.floor(255 * Math.min(100, num) / 100) : Math.min(255, num);
}

function rgbToHex(rgb) {
    var rgbRegex = /^rgb\(\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*\)$/;
    var result, r, g, b, hex = "";
    if ( (result = rgbRegex.exec(rgb)) ) {
        r = componentFromStr(result[1], result[2]);
        g = componentFromStr(result[3], result[4]);
        b = componentFromStr(result[5], result[6]);

        hex = "0x" + (0x1000000 + (r << 16) + (g << 8) + b).toString(16).slice(1);
    }
    return hex;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-22T20:13:39.700

这就是我所做的。

```
String.prototype.toRGB = function() {

  var rgb = this.split( ',' ) ;
  this.r=parseInt( rgb[0].substring(4) ) ; // skip rgb(
  this.g=parseInt( rgb[1] ) ; // this is just g
  this.b=parseInt( rgb[2] ) ; // parseInt scraps trailing )

} 
```

运行后`'rgb(125,181,215)'.toRGB()`，您将获得`.r`,`.g`和`.b`在返回的同一字符串对象中定义的属性（使用正确的整数值）。

要获取十六进制值，只需使用[`yourNumber.toString(16);`](https://stackoverflow.com/questions/57803/how-to-convert-decimal-to-hex-in-javascript)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-09-16T20:26:34.200

```
rgb2Hex = s => s.match(/[0-9]+/g).reduce((a, b) => a+(b|256).toString(16).slice(1), '0x')

console.log(rgb2Hex('rgb(10, 11, 12)'), rgb2Hex('rgb(255, 256, 257)'))
```

* * *

不推荐用于不可靠的用户输入，但字符串也可以作为函数进行评估：

```
rgb = (r, g, b) => '0x' + (1<<24|r<<16|g<<8|b).toString(16).slice(1)

console.log(eval('rgb(10, 11, 12)'), eval('rgb(255)'))
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-01-08T18:39:40.093

```
function parseColor(color) {
    var arr=[]; color.replace(/[\d+\.]+/g, function(v) { arr.push(parseFloat(v)); });
    return {
        hex: "#" + arr.slice(0, 3).map(toHex).join(""),
        opacity: arr.length == 4 ? arr[3] : 1
    };
}
function toHex(int) {
    var hex = int.toString(16);
    return hex.length == 1 ? "0" + hex : hex;
} 
```

* * *

```
parseColor("rgb(210, 10, 10)");  // {"hex":"#d20a0a","opacity":1}
parseColor("rgba(210, 10, 10, 0.5)"); // {"hex":"#d20a0a","opacity":"0.5"}
parseColor("rgb(210)");  // {"hex":"#d2","opacity":1} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-02-01T19:48:05.783

```
RGBToHex = function(r,g,b){
    var bin = r << 16 | g << 8 | b;
    return (function(h){
        return new Array(7-h.length).join("0")+h
    })(bin.toString(16).toUpperCase())
} 
```

[https://gist.github.com/lrvick/2080648](https://gist.github.com/lrvick/2080648)

编辑：

```
cnvrtRGBClrToHex('255,145,20')

function cnvrtRGBClrToHex(rgbClr){
    var rgbClr = rgbClr.split(',');
    var r = rgbClr[0];
    var g = rgbClr[1];
    var b = rgbClr[2];
    return (r << 16 | g << 8 | b).toString(16).toUpperCase()
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-03-30T15:22:17.017

一种代码高尔夫方法：

```
var h = x => '#' + x.match(/\d+/g).map(y = z => ((+z < 16)?'0':'') + (+z).toString(16)).join(''); 
```

现在， running`h("rgb(255, 60, 60)")`将返回`#ff3c3c`。

您可以替换`'#'`为`'0x'`以`0xff3c3c`.

*额外：它是如何工作的。*

`h`，声明为箭头函数（ES6 中的新功能）采用 RGB 值（字符串）并将其存储在`x`. 然后，`x`通过正则表达式方程 找到所有数字实例`/\d+/g`，并进一步用作数组（由 返回，由`match`使用`map`）。

`map`循环通过一个函数处理返回数组的所有元素`y`。该函数将一个值（作为字符串存储在数组中）转换`z`为数字`+z`（`((+z < 16)?'0':'')`将 a 添加`'0'`到元素的开头。

然后，它将其转换为以 16 为底的字符串（十六进制，按`.toString(16)`），并将其返回为`map`. 所以本质上，数组中的所有十进制字符串现在都更改为十六进制字符串。

最后，将数组的元素连接在一起 ( `join('')`)，没有分隔符，并`'#'`添加到字符串的开头。

**注意：如果提供的代码值大于 255，则输出将超过 6 个十六进制数字。就像，输出`rgb(256, 0, 0)`将是`#1000000`.**

要将值限制为 255，代码如下：

```
var h = x => '#' + x.match(/\d+/g).map(y = z => ((+z < 16)?'0':'') + ((+z > 255)?255:+z).toString(16)).join(''); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-08-14T11:15:55.497

用于 rgb 字符串到十六进制字符串的可读 oneliner：

```
rgb = "rgb(0,128,255)"
hex = '#' + rgb.slice(4,-1).split(',').map(x => (+x).toString(16).padStart(2,0)).join('') 
```

返回这里`"#0080ff"`。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-28T11:55:25.113

在 JavaScript 中将 RGB 颜色转换为 HEX 的另一种方法

```
 color = "rgb(51,51,51);";
    color = '#'+color.match(/\d+/g).map(function(x){
        x = parseInt(x).toString(16);
        return (x.length==1) ? "0"+x : x;
    }).join(""); 
```

# php - wordpress 发布图像放大鼠标悬停

> ID：13070058
> 
> 赞同：0
> 
> 时间：2012-10-25T13:47:54.473
> 
> 标签：php, wordpress, zooming

请建议一种免费的方法来在我的 wordpress 帖子图像上添加缩放效果，我整天都在尝试魔术缩放，但它不起作用，插件安装激活但它没有像它声称的那样显示我的帖子图像，标题中没有出现 scipt 文件，以及如何更改图像类，帖子图像的默认类是“alignnone”。请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:12:36.613

看看这个免费插件：[http ://www.dynamicwp.net/plugins/image-zoomer-plugin/](http://www.dynamicwp.net/plugins/image-zoomer-plugin/)

# c# - 有没有更好的方法来检查表单是否已加载？

> ID：13070059
> 
> 赞同：0
> 
> 时间：2012-10-25T13:48:00.993
> 
> 标签：c#, winforms

我的应用程序中有 2 个表单，`Form1`并且`Form2`. 我想知道是否有更好的方法来检查表单是否已经加载。如果表单已加载到内存中并且可见，我希望按钮什么也不做，如果`User` 已关闭表单，它应该重新实例化它。

有关更多信息，请查看我的代码或评论.. :)

```
public partial class Form1: Form
{
    private Form2 form2;

    public Form1() {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e) {

        if (form2== null) {
            form2= new Form2();
        } else {
            if (form2.has_exited()) { // this is a private property
                                      // that I set when Form2.Closing executes
                form2.Dispose();
                form2= new Form2();
            }
        }
        form2.Show();
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T13:53:44.597

您不需要`Form2`处理关闭事件，您可以直接从`Form1`：

```
private Form2 form2;

private void button1_Click(object sender, EventArgs e)
{
    if (form2 == null)
    {
        form2 = new Form2();
        form2.FormClosed += (_, arg) =>
        {
            form2 = null;
        };
        form2.Show();
    }
    else
    {
        //the other form has been opened and not closed; not sure what you want to do
    }
} 
```

另请注意，如果通过`Show`您显示表单，则无需处理它。如果您显示它，`ShowDialog`那么您会这样做，但是当您使用非模态对话框时，系统会自动将事件处理程序附加到调用 dispose 的关闭事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T13:54:30.773

我会用

```
if (form2 == null)
{
    form2 = new Form2();
    form2.FormClosed += (s, e) => { this.form2 = null; };
    form2.Show();
}
form2.BringToFront() 
```

所以每次`form2`关闭时，参考设置为`null`. 下次可以重新实例化。

只要它还在那里，就把它带到前面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:51:13.277

您可以将 Form1 传递给 Form2，并且在 .Loaded 之类的事件中或在 Form2 中处理/退出时，您可以使用 Form1 对象让它知道这些事件已经发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T13:51:55.017

如果您正在显示表单，该表单将引发一个名为 Form.Shown 的事件

[http://msdn.microsoft.com/en-us/library/system.windows.forms.form.shown.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.shown.aspx)

您可以在那里放置某种处理代码（即使它只是设置一个标志）。同样，如果用户关闭它，则会有一个表单关闭/关闭事件。

我认为也有一个表单加载事件，但我不记得了。

# asp.net - RequestReduce - 如何使用它？

> ID：13070062
> 
> 赞同：0
> 
> 时间：2012-10-25T13:48:04.463
> 
> 标签：asp.net, requestreduce

我似乎无法理解 RequestReduce 是如何工作的。我已经通过 NuGet 安装了所有组件，除了我不需要的 SQL 功能。现在我还应该做什么，我通过 IIS Express 运行我的网站，它不会生成任何 js 和 css 文件，也不会产生任何错误。我究竟应该如何使用它？

我正在用 ASP.NET 4.5 和 Visual Studio 2012 开发我的网站。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:38:18.210

我也无法让 RequestReduce 在 IIS Express 上工作。完全相同的配置/站点在 IIS 7.5 中按预期工作。

# python - 使用 Python GUI 创建按钮

> ID：13070065
> 
> 赞同：0
> 
> 时间：2012-10-25T13:48:12.730
> 
> 标签：python, class, user-interface, button, tkinter

我正在尝试使用类在 Python 中创建按钮，但是在运行它时按钮不会出现。以下是我的代码

```
#Button_2
#Using Classes

from Tkinter import * 

class Application(Frame):
    """A GUI application with three button"""

    def _init_(self, master):
        """ Initialise the Frame. """
        Frame._init_(self, master)
        self.grid()
        self.create_widgets()

    def create_widgets(self):
        #"""Create three buttons"""
        #Create first buttom
        self.btn1 = Button(self, text = "I do nothing")
        self.btn1.grid()

        #Create second button
        self.btn2 = Button(self)
        self.btn2.grid()
        self.btn2.configure(text = "T do nothing as well")

        #Create third button
        self.btn3 = Button(self)
        self.btn3.grid()    
        self.btn3.configure(text = "I do nothing as well as well")

    root = Tk()
    root.title("Lazy Button 2")
    root.geometry("500x500")
    app = Application(root)

    root.mainloop() 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T13:49:21.227

您需要命名您的“构造函数”方法`__init__`，而不是`_init_`. 正如它所写的，你的`grid`和`create_widgets`方法永远不会被调用，因为`_init_`永远不会被调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:55:55.173

好的，第一个问题是您已经声明了以下代码：

```
root = Tk()
root.title("Lazy Button 2")
root.geometry("500x500")
app = Application(root)

root.mainloop()code here 
```

在类本身内部。它应该在外面，所以这是一个缩进问题（可能是缩进的stackoverflow问题？）。

其次，我简化了代码以使其运行

```
from Tkinter import * 

class Application(Frame):
      """A GUI application with three button"""

     #create a class variable from the root (master):called by the constructor
     def _init_(self, master):
          self.master = master

     #simple button construction
     # create a button with chosen arguments
     # pack it after the creation not in the middle or before

     def create_widgets(self):
          #"""Create three buttons"""
          #Create first button
          btn1 = Button(self.master, text = "I do nothing")
          btn1.pack()

          #Create second button
          btn2 = Button(self.master, text = "T do nothing as well")
          btn2.pack()

         #Create third button
         btn3=Button(self.master, text = "I do nothing as well as well")
         btn3.pack()

  #must be outside class definition but probably due to stackoverlow
  root = Tk()
  root.title("Lazy Button 2")
  root.geometry("500x500")
  app = Application(root)
  #call the method
  app.create_widgets()
  root.mainloop() 
```

这是一个起点，绝对可以按以下证明工作：

![在此处输入图像描述](../Images/b935378d85e54b95f1847d4f89f6a081.png)

您可能会使用 grid() 而不是 pack 并从 def **init**构造函数中调用该方法。希望能帮助到你。

此调用方法也有效：

```
root = Tk()
root.title("Lazy Button 2")
root.geometry("500x500")
app = Application(root).create_widgets()  #creates and invokes
root.mainloop() 
```

我最后的尝试也有效：

```
def __init__(self,master):
    self.master = master
    self.create_widgets() 
```

其次是：

```
root = Tk()
root.title("Lazy Button 2")
root.geometry("500x500")
app = Application(root)
root.mainloop() 
```

![在此处输入图像描述](../Images/d6b81a001ea461b637e21668ac6a5f09.png)

最终代码：

```
from Tkinter import * 

class Application(Frame):
"""A GUI application with three button"""

def __init__(self,master):
    self.master = master
    self.create_widgets()

def create_widgets(self):
    #"""Create three buttons"""
    #Create first buttom
    btn1 = Button(self.master, text = "I do nothing")
    btn1.pack()

    #Create second button
    btn2 = Button(self.master, text = "T do nothing as well")
    btn2.pack()

    #Create third button
    btn3=Button(self.master, text = "I do nothing as well as well")
    btn3.pack()

root = Tk()
root.title("Lazy Button 2")
root.geometry("500x500")
app = Application(root)
root.mainloop() 
```

![在此处输入图像描述](../Images/0ceaa150a9eb120152ed787186244cc2.png)

# sql-server - 如何使用 ado .net 远程连接到 Sybase ASA 服务器

> ID：13070066
> 
> 赞同：1
> 
> 时间：2012-10-25T13:48:16.757
> 
> 标签：sql-server, ado.net, sqlanywhere, sybase-asa

我有一个使用 Sybase ASA 6.0 数据库的应用程序。

1.  如何从 Visual Studio 2010 直接连接到 Sybase 以收集我的数据？如何获取数据提供者？

2.  如何将数据库移动到 MS-SQL 服务器？我可以将数据库从 ASA 直接导入 SQL Server 吗？

我已经下载了 SQL Anywhere Developer Edition v12，以备不时之需。

# mongodb - MongoDB - 这个简单的 MySQL 数据如何适合 Doc 对象？

> ID：13070067
> 
> 赞同：0
> 
> 时间：2012-10-25T13:48:22.300
> 
> 标签：mongodb, structure, database

这里的原则点我在 Mongo 上苦苦挣扎。

我轻轻地手动将测试数据从我的 MySQL DB 放入 Mongo DB。所以我在 MySQL 中有这些数据：-

```
id\no\start\ratio\gol\fable\dble
488442\1\0000\6200\0\0\15
488444\2\6200\640\0\15\15 
```

对不起，奇怪的分隔符 - 但你明白了。

如果我然后将它放入 Mongo - 我会这样做吗

```
"doc" : { "id" : [ 488442, 488444 ], "no" : [ 1,2 ], "start" : [0000,6200] } 
```

等等。我意识到 NoSQL 有很多“随心所欲”，但是对于这个简单的问题是否有正确的答案可以更普遍地提供帮助（请不要关闭线程）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:53:21.440

基本上，对此没有正确和错误的答案。但是，我强烈建议您在此处阅读此文档/教程：[Mongo Schema Design](http://www.mongodb.org/display/DOCS/Schema+Design) and this [SQL to Mongo mapping chart](http://www.mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart)，这将帮助您了解模拟概念之间的差异和相似之处。

在 mongo 中，您应该设计您的模式，使其适合您最常见的用例。

从您的示例中，您似乎正在尝试将 Mongo 文档映射到 SQL 中的表。如果没有特殊原因，为什么要这样做，我会坚持更常见的：SQL 表的每一行都是 Mongo 集合中的单个文档。最简单的方法是每行创建一个文档并添加如下内容：

```
{"id": 488442, "no": 1, "start": 0000, "ratio": 6200, "gol": 0, "fable": 0, "dble": 15}
{"id": 488444, "no": 2, "start": 6200, "ratio": 640, "gol": 0, "fable": 15, "dble": 15} 
```

在名称为 MySQL 表的集合中。当然，如果你坐下来分析一下，你的关系模型是否有更合适的表示，现在你不必遵守它会更好。

# opencv - 如何准确检测圆圈

> ID：13070075
> 
> 赞同：2
> 
> 时间：2012-10-25T13:48:59.370
> 
> 标签：opencv, image-processing, geometry, hough-transform

有什么方法可以准确检测opencv中的圆圈吗？我正在使用霍夫变换，这给了我很好的结果，但大多数时候，物体和周围的阴影，光线等会产生不好的结果，所以我正在寻找除了霍夫圆以外的选项，准确的检测对我的项目非常重要。

到目前为止，我的基本方法是在实时拍摄的图像中找到一些球体。我正在使用 houghcircle 来查找球体，并根据我从中得到的半径进行以后的计算。

如果背景是平原并且球体没有检测到没有问题，但是如果我在我的房间里拍摄该图像，而背景将有其他物体，通常很难检测到。所以我正在寻找其他方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T13:44:20.110

我也有类似的需要准确地找到圆圈，但在准确检测方面只做很少的工作。尝试使用。

1.  轮廓检测，一旦你的轮廓绘制轮廓。
2.  使用 minEnclosureCircle 在检测到的轮廓上画一个圆。
3.  从轮廓你可以得到半径和 x,y 点

编辑：也可以使用 ContourArea() 过滤周围的对象和较小的对象。检查较小的轮廓并消除

这应该比霍夫圆检测更好。祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T10:58:34.133

正如 Junxx 提到的照明不变性将解决我遇到的大多数问题。像阴影、光线等。这可能对寻找这个答案的人有用。

# iphone - 无法对数组进行排序

> ID：13070080
> 
> 赞同：1
> 
> 时间：2012-10-25T13:49:16.800
> 
> 标签：iphone, objective-c, xcode, nsarray

我在排序数组时遇到问题。我有两个问题。1.使用以下代码对rightArray进行排序不起作用。2.我还有一个leftArray，当对右数组进行排序时，它的索引应该与右数组相比发生变化。这可能吗？

```
NSArray *rightArray = [[NSArray alloc] initWithObjects:[mutArray objectsAtIndexes:[NSIndexSet indexSetWithIndexesInRange:NSMakeRange(0, 11)]], nil];
NSArray *sortedArray = [rightArray sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)];
NSLog(@"%@",sortedArray); 
```

输出：在我使用上面的代码排序之后

```
2012-10-25 19:11:44.571 Converter[3511:207] (
    (
    USD,
    EUR,
    GBP,
    JPY,
    CAD,
    AUD,
    INR,
    CHF,
    CNY,
    KWD,
    SGD
)
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:09:26.160

```
NSArray *rightArray = [[NSArray alloc] initWithObjects:[mutArray objectsAtIndexes:[NSIndexSet indexSetWithIndexesInRange:NSMakeRange(0, 11)]], nil];
NSArray *sortedArray = [[rightArray lastObject] sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)];
NSLog(@"%@",sortedArray); 
```

Your strings are in an array in your array. Get the only object in `rightArray` and sort it.

edit

For the second question you can use an intermediate data structure

```
NSMutableDictionary *temp = [[NSMutableDictionary alloc] init];
NSArray *keys = [rightArray lastObject]; 
NSArray *objs = [leftArray lastObject]; // presuming they're also an array in an array

for (int i = 0; i < [keys count]; i++) {
    // we'll use the dictionary to set an one-to-one relationship
    [temp setObject:[objs objectAtIndex:i] forKey:[keys objectAtIndex:i]];
}

NSArray *sortedKeys = [keys sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)];
NSArray *sortedObjs = [temp objectsForKeys:sortedKeys notFoundMarker:[NSNull null]];
[temp release]; // if not using ARC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:17:55.270

```
NSArray *array =  @[@"USD",@"EUR",@"GBP",@"JPY",@"CAD",@"AUD",@"INR",@"CHF",@"CNY",@"KWD",@"SGD"];
NSArray *sortedArray = [array sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)];
NSLog(@"SortedArray:%@",sortedArray); 
```

它将输出：

```
SortedArray:(
    AUD,
    CAD,
    CHF,
    CNY,
    EUR,
    GBP,
    INR,
    JPY,
    KWD,
    SGD,
    USD
) 
```

正如亚历山大回答的那样，您没有传递字符串数组。

# c# - 在 Metro 风格应用程序中使用 MD5 算法进行散列

> ID：13070081
> 
> 赞同：0
> 
> 时间：2012-10-25T13:49:18.893
> 
> 标签：c#, windows-8, microsoft-metro

> **可能重复：**
> [如何使用 C# 为我的 WinRT 应用程序生成 MD5 哈希码？](https://stackoverflow.com/questions/8299142/how-to-generate-md5-hash-code-for-my-winrt-app-using-c)

我正在使用 c# 和 xaml 开发 Metro 风格的应用程序。在我的应用程序中，我想通过使用 MD5 算法对 API 密钥和秘密密钥进行哈希处理来创建签名。如何使用 MD5 算法对 API 密钥和秘密密钥进行哈希处理。请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:38:20.810

Consider this code snipped, you can go for something like this, assuming *yourString* is your API Key + Secret Key concatained.

```
public string Foo(string yourString)
{
    using(var md5HashProvider = new MD5CryptoServiceProvider())
    {
        byte[] hash = md5HashProvider.ComputeHash(utf8.GetBytes(yourString));
        return Convert.ToBase64String(hash);
    }
} 
```

# spring-mvc - 如何阻止我的 Spring WebFlow Dojo (Dijit) Dropdown (Select) 变大。我需要滚动条

> ID：13070083
> 
> 赞同：0
> 
> 时间：2012-10-25T13:49:21.093
> 
> 标签：spring-mvc, dojo, spring-webflow, dijit.form

我正在开发一个 Spring Web Flow 项目，我正在为 UI 使用 Dojo (Dijit)，我有一个下拉（选择）我的屏幕之一，我想看看我是否可以设置它的大小..它太长了！就像我希望它有一个 scollbar 并且一次显示 4 个

```
<td><form:select path="number" id="number" name="number">
                            <form:option value="1" label="1" />
                            <form:option value="2" label="2" />
                            <form:option value="3" label="3" />
                            <form:option value="4" label='4" />
                            <form:option value="5" label="5" />
                            <form:option value="6" label="6" />
                            <form:option value="7" label="7" />
                            <form:option value="8" label="8" />
                            <form:option value="9" label="9" />
                            <form:option value="10" label="10" />
                            <form:option value="11" label="11" />

                        </form:select > 
                        <script type="text/javascript">
                        Spring.addDecoration(new Spring.ElementDecoration({
                            elementId : "number",
                            widgetType : "dijit.form.Select",
                            widgetAttrs : {
                            promptMessage : "Pick Number",
                            required : true, 
                            onChange : function() {
                                Spring.remoting.submitForm(
                                    'submit', 
                                    'customer', 
                                    {_eventId: 'numberchange', fragments:'contents'}
                                 ); 
                                 return false;
                            } }}));

                    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:38:48.523

如果您设置 maxHeight 属性，dijit.form.Select 将是可滚动的

# jquery - jquery slice 的对面/选择 slice 外的项目

> ID：13070087
> 
> 赞同：3
> 
> 时间：2012-10-25T13:49:26.937
> 
> 标签：jquery, slice

我有一个 javascript (jQuery) 分页系统，它通过在页面上隐藏项目并使用复选框应用过滤器来工作。它工作正常，但我现在正在尝试对这个动态结果集进行分页，所以我想隐藏特定范围之外的所有项目。

jQuery slice 函数看起来有点适合这个，只是它选择了范围内的所有项目。我想做的恰恰相反。我想选择范围之外的所有项目。

```
HTML: 
<ul>
    <li>Item 1</li>
    <li>Item 2</li>
    <li>Item 3</li>
    <li>Item 4</li>
    <li>Item 5</li>
    <li>Item 6</li>
    <li>Item 7</li>
    <li>Item 8</li>
    <li>Item 9</li>
    <li>Item 10</li>
</ul>​

jQuery:
$(function(){
    $('li').slice(3,6).css('background','#f00'); 
});​ 
```

我整理了一个小提琴： http: [//jsfiddle.net/SLuXz/1/](http://jsfiddle.net/SLuXz/1/) - 我想做的是让项目 1、2、3、7、8、9 和 10 显示为红色。我知道我可以用两个切片（0-3 和 7-10）来做到这一点，但想知道是否有一种更简洁的方法来使用类似“not”或其他核心功能的方法。

感谢大家的指点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T13:51:07.950

您可以像这样使用 .not()

```
$(function(){
    $('li').not($('li').slice(3,6)).css('background','#f00'); 
});​ 
```

[小提琴](http://jsfiddle.net/wirey00/CYVPh/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:10:36.903

你也可以用`.filter`这个：

```
$(function(){
    $("li").filter(function(i) { 
        return i < 3 || i > 5;
    }).css(...);
}); 
```

或者

```
$(function(){
    $("li").filter(":lt(3),:gt(5)").css(...);
}); 
```

或（可能效率较低）

```
$(function(){
    $("li:lt(3),li:gt(5)").css(...);
}); 
```

[http://jsfiddle.net/CYVPh/1/](http://jsfiddle.net/CYVPh/1/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-26T15:53:35.430

由于性能对每个人都应该很重要，因此 Dan 的答案绝对不应该被接受，因为它的速度大约是使用 Kevin B 的答案的三倍。

如果我们运行这段代码

```
var Start =  new Date().getTime();
for(i = 0; i<10000; i++){
    //How Dan's answer suggests to do this
    var e = $('.elem').not($('.elem').slice(0,99));
}
var Finish = new Date().getTime();
console.log('Using selector filter',Finish-Start);

var Start =  new Date().getTime();
for(i = 0; i<10000; i++){
    //A better way to do Dan's answer, but still twice as slow 
    var o = $('.elem');
    var e = o.not(o.slice(0,99));
}
var Finish = new Date().getTime();
console.log('Using selector filter',Finish-Start);

Start =  new Date().getTime();
for(i = 0; i<10000; i++){
    //The fastest method
    var e = $('.elem').filter(function(i) { 
        return i < 0 || i > 99;
    });
}
Finish = new Date().getTime();
console.log('Using object filter',Finish-Start); 
```

观察控制台，我们得到以下输出：

> 使用选择器过滤器 989
> 
> 使用选择器过滤器 683
> 
> 使用对象过滤器 349

现在，在数据使用量非常低的情况下，这可能不是太大的问题，但在我检查可能相当多的表行的情况下，这将非常重要。

# javascript - 这个网站如何在主页上创建按钮？

> ID：13070088
> 
> 赞同：-4
> 
> 时间：2012-10-25T13:49:27.727
> 
> 标签：javascript, html, css

[http://wufoo.com/](http://wufoo.com/)

网站如何在主页上创建酷按钮？使用 CSS、JavaScript？悬停效果是我见过的最好的。

我正在使用的按钮是“自定义品牌”等！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:53:32.553

该效果是使用 CSS3 过渡和悬停效果创建的。

当链接悬停时，背景位置会发生变化，并且过渡会使其平滑地动画化。

此外，每个链接的右上角都包含一个图标。然后将图标转换为旋转和缩放，再次使用使它们平滑动画的过渡。

# regex - 正则表达式匹配一系列数字

> ID：13070090
> 
> 赞同：0
> 
> 时间：2012-10-25T13:49:35.237
> 
> 标签：regex

我正在使用以下正则表达式来匹配 1 到 9999.9 之间的范围，并且效果很好！

```
"^([1-9]|[1-9]\\d|[1-9]\\d\\d|[1-9]\\d\\d\\d)(\\.\\d)?$" 
```

但是，我希望范围从 0.5 到 9999.9！

我怎样才能做到这一点！任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:53:27.323

很简单，您还可以简化已有的正则表达式：

```
"^(?:0\\.[5-9]|[1-9]\\d{0,3}(?:\\.\\d)?)$" 
```

# html - IE中旋转图像的宽度问题

> ID：13070094
> 
> 赞同：1
> 
> 时间：2012-10-25T13:49:53.673
> 
> 标签：html, css, internet-explorer, rotation, zooming

我写了下面的代码。需要在 IE 版本上运行，所以使用过滤器进行旋转。点击按钮几次，这将更新图像的宽度，将重新定位图像。

任何帮助将不胜感激。

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Zoom Issue</title>

<style>
.ImgClass{
filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
height : auto;
width : 100%;

}
.divClass{
width : 800px;
height : 750px;
}

</style>
</head>

<SCRIPT type="text/javascript">
function zoomImage(){
    document.getElementById('myImage').style.width = document.getElementById('myImage').offsetWidth  * 1.5;
}
</SCRIPT>

<body>
<input type="button" id='btnClick' value='Click' onClick="zoomImage();"/>
<DIV class='divClass'>
<IMG class='ImgClass' id='myImage' src='Image.jpg' />
</DIV>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:05:47.320

在我看来，好像您正在更改错误的维度。如果您将其侧向旋转，则宽度变为高度，高度变为宽度（除非您将头放在侧面）：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Zoom Issue</title>
    <style>
    .ImgClass{
        filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
        height : 100%;
        width : auto;
    }
    .divClass{
        width : 800px;
        height : 750px;
    }
</style>
</head>

<SCRIPT type="text/javascript">
    function zoomImage(){   
        var img = document.getElementById('myImage');   
        img.style.height = e1.offsetHeight * 1.5 + "px";
    }
</SCRIPT>

<body>
    <input type="button" id='btnClick' value='Click' onClick="zoomImage();"/>
    <DIV class='divClass'>
        <img class='ImgClass' id='myImage' src="Images/IMG_6686.JPG">
    </DIV>
</body>
</html> 
```

这在 IE8 中对我来说似乎很好用。

# javascript - 在 Javascript 中提取 HTML 标题

> ID：13070096
> 
> 赞同：3
> 
> 时间：2012-10-25T13:49:57.920
> 
> 标签：javascript, jquery, html, url

假设我有一个类似 的 URL `www.google.com`，并且我希望我的页面上的 Javascript/JQuery 可以查看`<title>`该 URL 的内容中的内容，并将其放入我的变量中。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T13:54:46.733

鉴于 url 的来源相同：

```
$.get('page.html', function(text) {
    var pagetitle = $(text).title;
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T13:50:57.910

您可以尝试以下方法：

```
var title = document.title; 
```

看到您编辑的问题后，我猜您想要什么，因为其他人的评论是：

```
jQuery.get('<url of the page you want>', function(data) {
    var title =  jQuery(data).title;
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T13:56:31.313

```
$.get(url, function(html) {
   var title =  $(html).title
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-25T13:54:40.493

尝试

```
var titles    = document.getElementsByTagName('title') 
```

尝试从 url 中获取标题

```
$.get(document.URL, function(demo) { //or window.location.href to get the url of currec\nt page 
    var title = $(demo).title;
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T14:19:48.150

这也对你有用。我不确定 a 在`match`性能方面如何与此处的其他选项进行比较：

```
var html_title = html.match("<title>(.*?)</title>")[1]; 
```

# iphone - 从相机的 OverlayView 转到另一个视图控制器

> ID：13070099
> 
> 赞同：0
> 
> 时间：2012-10-25T13:50:06.140
> 
> 标签：iphone, cocoa-touch

我正在构建一个 Iphone 应用程序，在其中我在相机视图顶部放置了一个带有几个按钮的覆盖视图，单击该按钮应该转到一个具有 MapView 的视图控制器。我在两件事上面临问题

1）如何从相机叠加视图点击按钮时转到 MapView ViewController？2）有没有办法我可以将相同的覆盖视图放在地图视图的顶部。

任何帮助将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:50:41.123

为此**1) 如何从相机覆盖视图单击按钮时转到 MapView ViewController？**您需要关闭相机视图并将 MAP 视图显示为 modal 。

# c++ - linux终端中的进度条

> ID：13070105
> 
> 赞同：2
> 
> 时间：2012-10-25T13:50:15.033
> 
> 标签：c++, shell, pipe

我最近用 C++ 实现了一个进度条类。我写了类似的东西

```
cout << "\r" << percentage_done << "%" << flush; 
```

现在我正在运行一些程序，将输出输出到更少。问题是 less 向我展示了很多类型的行

^M1%^M2%...

所以“\r”没有被正确解释。是否可以通过这样一种方式进行管道传输，即 less 只会显示最后的 100% 行，或者我是否必须在我的程序中添加一个开关以完全禁用进度条？

当我将输出直接通过管道传输到文件时，我遇到了同样的问题，因此输出文件不必要地占用了大量磁盘空间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:28:14.880

[这种方法](http://ideone.com/b6bVOJ)可以在没有额外选项的情况下使用更少的管道运行。它通常适用于任何类型的输出重定向。

而且您不必按照其他方法的建议检查 is_terminal ：

```
#include <boost/progress.hpp>
#include <boost/timer.hpp>
#include <vector>

int main(int argc,char *argv[])
{
    const unsigned long expected_count=20;
    boost::progress_display show_progress( expected_count );
    for(int i=0;i!=expected_count;++i)
    {
        volatile std::vector<int> v(1024*1024*128);
        ++show_progress;
    }
    return 0;
} 
```

输出是：

```
0%   10   20   30   40   50   60   70   80   90   100%
|----|----|----|----|----|----|----|----|----|----|
*************************************************** 
```

在 progress_display 构造函数期间打印标尺。

然后在 ++show_progress 上，进度条逐渐被***填满；**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:08:26.470

使用`-r`选项`less`让它解释控制序列。比较：

```
echo -e '1\r2\r3\r4\r100' | less
echo -e '1\r2\r3\r4\r100' | less -r 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T18:38:23.900

嗯，我认为 Jan Hudec 说的非常正确。我给自己写了一个小函数

```
#include <unistd.h>

bool stdout_has_terminal()
{
  return NULL != ttyname(STDOUT_FILENO);
} 
```

根据返回值，我要么打印进度条，要么不打印。现在一切都很好:)

# mysql - 使用 cron 从一个 mysql 数据库定期转储到另一个数据库

> ID：13070111
> 
> 赞同：0
> 
> 时间：2012-10-25T13:50:38.827
> 
> 标签：mysql, mysqldump

我已经在 /etc/crontab 文件中写入了这一行，以便每天晚上 3 点将每日转储从一个数据库转移到另一个数据库，但它并没有给出任何错误消息。

```
0 3 * * * mysqldump -uroot -ppassword --opt activeDB | mysql -uroot -ppassword -h test.example.com passiveDB 
```

知道这里有什么问题吗？我是否需要为服务器定义例如 ssh 连接？如果这是问题所在，我想它应该给出一些消息，比如不允许连接到给定的服务器，不是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:55:34.683

1.  将您的命令写入 shell 脚本，然后从 crontab 调用该脚本。某些版本的 cron 不能很好地读取多部分命令。

2.  您应该先调试您的命令，然后再将其设置为 cron。

您需要确保它`mysqld`正在监听公共接口`test.example.com`（默认情况下不是）。您需要确保您`GRANT`在远程数据库上设置了正确的权限，您需要授予 'user'@'%' （坏主意）或 'user'@'your-active-server-ip' 权限（更好主意）。

# java - 关于flowlayout工作的困惑

> ID：13070113
> 
> 赞同：1
> 
> 时间：2012-10-25T13:50:43.207
> 
> 标签：java, swing, user-interface, layout-manager, graphics2d

我开发了一个小型摆动应用程序，其中上半部分有一个正方形旋转，下半部分有一个按钮可以停止/运行正方形旋转。我用`GridLayout`来放置旋转方块和按钮。（另一种选择是使用 2 `JPanel`s，一个是旋转正方形，第二个包含按钮。使用此按钮会显示适当的大小。）

这是代码：-

```
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.Timer;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class Rotation {
JButton jbtn=new JButton("Stop");
component jpn2=new component();    //created a JPanel named jpn2 and got a reference to its timer object.
Timer timer=jpn2.timer;
Rotation()
{

    JFrame jfrm=new JFrame("Rotating a square about a center");
    jfrm.setSize(400,400);
    jfrm.setLayout(new GridLayout(2,1));
    jfrm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    //JPanel jpnl=new JPanel();

    //jpnl.add(jbtn);

    jbtn.addActionListener(new ActionListener(){public void actionPerformed(ActionEvent e){
        if(e.getActionCommand().equals("Stop"))
        {
            timer.stop();
            jbtn.setText("Spin");
        }
        if(e.getActionCommand().equals("Spin"))
        {
            timer.start();
            jbtn.setText("Stop");
        }

    }});

    jfrm.add(jpn2);
    jfrm.add(jbtn);

    //jfrm.add(new JButton("Click"));
    jfrm.setVisible(true);
    //jfrm.setOpacity(0.8f);
}
public static void main(String args[]) throws ClassNotFoundException, InstantiationException, IllegalAccessException, UnsupportedLookAndFeelException
{
    //JFrame.setDefaultLookAndFeelDecorated(true);
    UIManager.setLookAndFeel("com.sun.java.swing.plaf.nimbus.NimbusLookAndFeel");
    SwingUtilities.invokeLater(new Runnable(){public void run(){new Rotation();}});
}

}

class component extends JPanel implements ActionListener
{
Timer timer;
int theta=0;
component()
{
    timer=new Timer(10,this);
    timer.start();
}
public void paintComponent(Graphics g)
{
    super.paintComponent(g);
    Graphics2D g2=(Graphics2D)g;
    g2.rotate(theta,100,100);
    g2.fillRect(50, 50, 100,100);
}
public void actionPerformed(ActionEvent e)
{
    //Changing a global variable and then drawing the rectangle again and hence indirectly the square rotates.
    theta=theta+10;
    if(theta==360)
        theta=0;
    repaint();
}
} 
```

这是输出： -

![输出](../Images/0e37f6d61654aba81159cfa48f76298c.png)

但我的困惑是当我决定使用`FlowLayout`而不是`GridLayout`我只得到按钮而不是旋转方块时。据我所知，`FlowLayout`将组件放在一行中，如果空间小于它使用多行。谁能解决我目前无法解决的这个愚蠢的小问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T13:54:29.773

您的问题是您使用`setSize(...)`这些布局将完全按照您的要求进行 - 将 GUI 的大小设置为该大小，无论是否所有内容都没有显示。一般来说，您希望避免调用`setSize(...)`，而是`getPreferredSize()`在必要时覆盖组件并在显示它之前打包您的 GUI，让组件自行调整大小。请注意，FlowLayout 有其用途，但与其他布局相比，它不是一堆中“最聪明”的布局（在我看来）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T14:00:32.620

`FlowLayout`只接受`PreferredSize`来自它`JComponents`的孩子，不能随着它的父母不断调整大小

`GridLayout`（您的问题）`PreferredSize`从更大更宽的容器中获取并为容器中的其余部分`JComponents`设置相同的大小，并与它的父级连续`Dimmension``JComponents``JComponents`

必须使用 pre_implemented `LayoutManager`for `JFrame`, use `Borderlayout`,`JComponents`可调整大小并与其父级连续（仅限 CENTER 区域，仅与坐标之一休息）

消除

```
jfrm.setLayout(new GridLayout(2,1)); 
```

并改变

```
jfrm.add(jpn2); 
jfrm.add(jbtn, BorderLayout.SOUTH); 
```

通知`JFrame`

```
frm.add(jpn2); equals frm.add(jpn2, BorderLayout.CENTER); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:18:33.037

正如其他人所说（mKorbel 和 HFOE +1）

*   问题是您在设置为可见之前使用`setSize(..)`宁可调用。`pack()``JFrame`

*   您还必须`getPrefferedSize(..)`在`JPanel`类中覆盖，这将返回您的正方形大小乘以 2（否则当它旋转时它不适合）。

*   顺便说一句，不要把任何`main(..)`事情都抛在脑后。

请参阅下面的代码（使用`FlowLayout`但也适用于`GridLayout`）：

使用`new FlowLayout()`：

![在此处输入图像描述](../Images/4a438dd8cae7033f451a977beb1d3bf2.png)

使用`new GridLayout(2,1)`：

![在此处输入图像描述](../Images/5bfcd298dbf4814ddc6e05c0a281f2b0.png)

```
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.Timer;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class Rotation {

    JButton jbtn = new JButton("Stop");
    component jpn2 = new component();    //created a JPanel named jpn2 and got a reference to its timer object.
    Timer timer = jpn2.timer;

    Rotation() {

        JFrame jfrm = new JFrame("Rotating a square about a center");

        // jfrm.setLayout(new FlowLayout());
        jfrm.setLayout(new GridLayout(2, 1));

        jfrm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        jbtn.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                if (e.getActionCommand().equals("Stop")) {
                    timer.stop();
                    jbtn.setText("Spin");
                }
                if (e.getActionCommand().equals("Spin")) {
                    timer.start();
                    jbtn.setText("Stop");
                }

            }
        });

        jfrm.add(jpn2);
        jfrm.add(jbtn);

        jfrm.pack();
        jfrm.setVisible(true);
    }

    public static void main(String args[]) {
        try {
            UIManager.setLookAndFeel("com.sun.java.swing.plaf.nimbus.NimbusLookAndFeel");
        } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {

            ex.printStackTrace();
        }

        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Rotation();
            }
        });
    }
}

class component extends JPanel implements ActionListener {

    Timer timer;
    int theta = 0;
    int width = 100, height = 100;

    component() {
        timer = new Timer(10, this);
        timer.start();
    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D) g;
        g2.rotate(theta, 100, 100);
        g2.fillRect(50, 50, width, height);
    }

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(width * 2, height * 2);//multiply by 2 to fit while rotating
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        //Changing a global variable and then drawing the rectangle again and hence indirectly the square rotates.
        theta = theta + 10;
        if (theta == 360) {
            theta = 0;
        }
        repaint();
    }
} 
```

# iphone - 用于 iPad/iPhone 的 Safari 上的 text-decoration CSS 被覆盖

> ID：13070116
> 
> 赞同：0
> 
> 时间：2012-10-25T13:50:56.117
> 
> 标签：iphone, css, ipad, debugging, safari

烦人的小错误...发现尽管`{text-decoration:none;}`在我的样式表中指定了链接，但 iPhone 和 iPad 上的 Safari 忽略了这一点，并在链接下划线。

在网络 Safari/Ffox/Chrome 等上完全没问题……只是 iPad/iPhone。

有小费吗？提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:54:01.173

尝试将 !Important 添加到您的 CSS 中。这将覆盖任何其他样式并强制它使用您指定的样式。

```
{text-decoration:none !Important;} 
```

# ios - 在不支持旋转的 iOS 应用中旋转 UIImageView

> ID：13070121
> 
> 赞同：0
> 
> 时间：2012-10-25T13:51:09.993
> 
> 标签：ios, uiscrollview, uiimageview, uiinterfaceorientation, uiimageorientation

我有一个硬编码的应用程序仅支持 1 个方向，纵向。肖像是通过项目设置设置的。

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{   
      return (interfaceOrientation == UIInterfaceOrientationPortrait);
} 
```

在这个视图控制器中有几个视图、按钮、标签和其他标准的 iOS 控件。对于此视图控制器中的所有控件，期望的行为是当用户旋转 iOS 设备时，应用程序中的任何内容都不会旋转。

**然而**，在所有上述视图之下，作为“背景”的是嵌入在 UIScrollView 中的 UIImageView。这是最底部的视图。在任何时候，用户都可以通过启动照片选择器的按钮来更改此背景。UIImageView 嵌入在 UIScrollView 中，因为所需的行为是允许捏缩放背景图像。

虽然应用程序不支持旋转，但我希望 ImageView 的内容在加载时始终正确定向。

**例如**- 请记住，唯一支持的方向是 UIInterfaceOrientationPortrait，用户启动应用程序，将 iOS 设备旋转到 LandScape 位置。在纵向用户选择新的背景图像时。预期的行为将是根据当前方向选择要定向和纵横比正确的图像。

本质上，我正在寻找该背景图像在被选中时始终对地球具有“重力”。如果用户选择新图像后旋转 iOS 设备，则背景图像不会旋转。只有在最初选择图像时，它才会正确定位。

我可以使用 CGAffineTransformMakeRotation 旋转图像，但是通过捏合放大会表现出不良行为，因为图像本身的像素并没有真正改变方向。

我想我可能需要在用户选择图像时实际创建一个新图像，类似于...

```
UIImage * RightLandscapeImage = [[UIImage alloc] initWithCGImage: userSelectedImage.CGImage
                                                         scale: 1.0
                                                   orientation: UIImageOrientationRight]; 
```

对于这个问题，我没有看到任何简单的解决方案。可能我忽略了一些简单的事情？

**跟进**这是似乎需要的代码。考虑到当前方向，以及启动方向。

```
UIImage * newImage;
if( startUpOrientation == UIInterfaceOrientationLandscapeRight )
{
    switch (currentOrientation) {
        case UIInterfaceOrientationLandscapeLeft:
          newImage = [[UIImage alloc] initWithCGImage: bgImage.CGImage
                                                                 scale: 1.0
                                                           orientation: UIImageOrientationDownMirrored];

             [self.backgroundImageView setImage:newImage];
            break;
        case UIInterfaceOrientationLandscapeRight:
             [self.backgroundImageView setImage:bgImage];
            break;
        case UIInterfaceOrientationPortraitUpsideDown:
            newImage = [[UIImage alloc] initWithCGImage: bgImage.CGImage
                                                  scale: 1.0
                                            orientation: UIImageOrientationRight];

            [self.backgroundImageView setImage:newImage];

            break;
        default:
            newImage = [[UIImage alloc] initWithCGImage: bgImage.CGImage
                                                  scale: 1.0
                                            orientation: UIImageOrientationLeft];
            [self.backgroundImageView setImage:newImage];
            break;
    }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:56:38.407

您可以在 willRotateToInterfaceOrientation 中将变换应用于要旋转的任何视图

你可以试试这段代码：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
    {
        switch (toInterfaceOrientation) {
            case UIInterfaceOrientationLandscapeLeft:
                yourview.transform = CGAffineTransformMakeRotation(M_PI_2); // 90 degress
                break;
            case UIInterfaceOrientationLandscapeRight:
                yourview.transform = CGAffineTransformMakeRotation(M_PI + M_PI_2); // 270 degrees
                break;
            case UIInterfaceOrientationPortraitUpsideDown:
                yourview.transform = CGAffineTransformMakeRotation(M_PI); // 180 degrees
                break;
            default:
                yourview.transform = CGAffineTransformMakeRotation(0.0);
                break;
        }
    } 
```

# asp.net - 如何将 Telerik 网格宽度设置为适合其标题文本？

> ID：13070125
> 
> 赞同：0
> 
> 时间：2012-10-25T13:51:22.170
> 
> 标签：asp.net, telerik, telerik-grid

我正在使用 Telerik 网格。列标题文本将从存储过程中检索，我在后面的代码中处理了这一切。我想在单行中显示列标题，当没有可用的标题文本时，它将显示为“-1”，“-2”。

我正在尝试自动调整列中的标题文本，问题是使用“ HeaderStyle-Width="119px" ”固定列宽时，它对于日期时间值很好，但对于 -1 和 -2 它占用空间。

建议我根据 headertext 自动设置列宽。

![在此处输入图像描述](../Images/a69c9030a1cffca7aaf8a37c4bd93399.png) 我在下面放置了网格定义..

```
enter code here<cc1:logicaGrid 
    AutoSetColumnWidth="false" 
    AutoGenerateColumns="true"
    AllowPostBackOnRowClick="false" 
    AllowFilteringByColumn="false"
    BorderWidth="1"
    PageSize="100"
    Width="99%" 
    ID="grdProfiles" 
    AlwaysShowPager="true"      
    AllowPaging="true"
    runat="server" HeaderStyle-Width="119px">
    <MasterTableView Width = "100%"></MasterTableView>
    <ClientSettings 
        Scrolling-ScrollHeight="450px" 
        Scrolling-AllowScroll ="true" >
        <Resizing AllowColumnResize="true"/>
    </ClientSettings>
</cc1:logicaGrid> 
```

![在此处输入图像描述](../Images/e383cdd32d77c2fbee7958a3d9c57337.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-21T14:39:14.700

你可以试试这个：原因是如果你有 radGrid 100% 将不会显示更多的列

```
HeaderStyle-Width="100px" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:15:32.437

你试过设置`HeaderStyle-Width="100%"`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-15T21:37:22.870

对于每一列，您需要设置 HeaderStyle。

```
<telerik:RadGrid ID="ViewLogsGrid" 
 AutoGenerateColumns="false" ... ... >

   <MasterTableView TableLayout="Fixed">
      <Columns>
        <telerik:GridBoundColumn DataField="Comments" HeaderText="Comments" SortExpression="Comments"    UniqueName="Comments">

           <HeaderStyle Width="150px" />

        </telerik:GridBoundColumn>
      </Columns>
   </MasterTableView>

</telerik:RadGrid> 
```

# javascript - HighCharts 导出文件名

> ID：13070126
> 
> 赞同：2
> 
> 时间：2012-10-25T13:51:28.383
> 
> 标签：javascript, highcharts, export

我正在使用 highcharts 导出模块将图表导出为 pdf。在我的代码中，我创建了一个片段`chart`对象，该对象在使用的不同 gui 控件上进行操作。它看起来像这样：

```
options = {
   ...
   ...
   exporting:{
      type: "application/pdf",
      filename: "default",

      buttons:{
        exportButton:{
            menuItems: null,
            onclick:function(){
                var fileName = "AAAA";//it's dynamic in reality.
                alert(options.exporting.filename);//alerts "default"
                options.exporting.filename = fileName;
                alert(options.exporting.filename);//alerts "AAAA"
                this.exportChart();
             }
         },
         printButton: {
             enabled: false
         }
      }
   }
} 
```

现在，只要单击导出按钮，下载的文件就会被命名为，`default.pdf`而警报显示属性已更改。

此外，由于第一个警报将结果显示为`default`（实际上不是默认值`chart`），很明显我引用了正确的属性，因此不会因为在错误的属性中设置文件名而发生错误。

任何人都可以解释情况或建议更改以使我下载具有动态名称的文件。？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T14:23:40.910

您可以更改文件的文件名。这是一个关于如何实现的[**示例。**](http://jsfiddle.net/PMyHQ/392/)相关代码：

```
exportButton: {
    menuItems: null,
    onclick: function() {
        chart.exportChart({filename: 'my-png'}, null);
    }
}, 
```

这是另一个[**示例**](http://jsfiddle.net/348sh/3/)，更多地显示了在导出和打印期间可以控制的内容。相关代码：

```
$('#buttonExport').click(function() {
    var e = document.getElementById("ExportOption");
    var ExportAs = e.options[e.selectedIndex].value;   

    if(ExportAs == 'PNG')
    {
        chart.exportChart({type: 'image/png', filename: 'my-png'}, {subtitle: {text:''}});
    }
    if(ExportAs == 'JPEG')
    {
        chart.exportChart({type: 'image/jpeg', filename: 'my-jpg'}, {subtitle: {text:''}});
    }
    if(ExportAs == 'PDF')
    {
        chart.exportChart({type: 'application/pdf', filename: 'my-pdf'}, {subtitle: {text:''}});
    }
    if(ExportAs == 'SVG')
    {
        chart.exportChart({type: 'image/svg+xml', filename: 'my-svg'}, {subtitle: {text:''}});
    }
}); 

$('#buttonPrint').click(function() {
    chart.setTitle(null, { text: ' ' });
    chart.print();
    chart.setTitle(null, { text: 'Click and drag in the plot area to zoom in' });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:21:21.830

你可以试试这个吗

```
exportButton:{
            menuItems: null,
            onclick:function(){
                var fileName = "AAAA";//it's dynamic in reality.                                    
                this.exportChart({filename : fileName});
             }
         } 
```

exportChart 方法也采用 options 参数..

# r - 在 R 中使用带有多个参数的匿名函数

> ID：13070128
> 
> 赞同：6
> 
> 时间：2012-10-25T13:51:37.593
> 
> 标签：r, loops, dataframe, anonymous-function

我试图在数据框中生成以数据框中两个（或更多）其他变量为条件的新变量。我相信 R 中的循环函数（即 lapply、sapply 等）对于此目的是有用且高效的。但是，我的方法有些不对劲，我不知道是什么。

```
M <- data.frame(x=c("A", "A", "B", "B"), y=c(1,2,1,2)) 
```

使用这个数据框，我想生成一个新列 z，其中包含 TRUE 且当且仅当且 且 的`x == "A"`逻辑`y == 1`。以下代码是我能想到的最好的，但似乎只评估我的第一个条件。

```
M$z <- sapply(M$x, function(x,y) if((x == "A") && (y == 1)) T else F, M$y) 
```

*   可以出于我的目的修复此代码吗？
*   在 R 中是否有更好的方法，也许使用其他循环函数？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T13:56:58.007

这是`transform`功能的任务

```
transform(M, z=ifelse((x == "A") & (y == 1), T, F))
  x y     z
1 A 1  TRUE
2 A 2 FALSE
3 B 1 FALSE
4 B 2 FALSE 
```

我认为更简单的方法是

```
M$z <- with(M, (x == "A") & (y == 1))
M
  x y     z
1 A 1  TRUE
2 A 2 FALSE
3 B 1 FALSE
4 B 2 FALSE 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-25T13:55:04.763

看看mapply：

```
> M$z <- mapply(M$x,M$y, FUN=function(x,y) if((x == "A") && (y == 1)) T else F)
> M
  x y     z
1 A 1  TRUE
2 A 2 FALSE
3 B 1 FALSE
4 B 2 FALSE 
```

恰当地说，这与匿名函数无关，与应用多个参数有关。如果您命名该函数，它仍然无法在任何单参数应用变体中工作。

另一种方法是`ddply`按行，或将您的 data.frame 拆分为一个列表，每行是一个单独的条目。

# facebook - iframe（自定义选项卡）在业务页面上未显示给某些用户，对其他人工作正常

> ID：13070131
> 
> 赞同：1
> 
> 时间：2012-10-25T13:51:42.087
> 
> 标签：facebook, iframe

那里——出于某种原因，我的几个同事和一些客户在查看自定义标签时遇到了问题，但不是所有人。它们对我和我办公室的其他人都很好。

我已经尝试了很多东西。我试过让他们自己和企业都使用企业页面；他们可以毫无问题地查看原始 iframe 本身（页面标签 URL）；我让他们尝试了不同的操作系统和浏览器。

这些只是直接的 HTML/CSS/PHP 自定义选项卡，没有什么特别喜欢的按钮，等等。这是他们看到的屏幕截图：

[http://cl.jasonandreoni.com/image/3t3P3O3l2141](http://cl.jasonandreoni.com/image/3t3P3O3l2141)

还有一些我的代码：

```
<div id="fb-root"></div> 
    <script type="text/javascript"> 
  window.fbAsyncInit = function() {
    FB.init({appId: 'XXXXXXXXXXXX', status: true, cookie: true, xfbml: true});
  window.setTimeout(function() {
    FB.Canvas.setAutoGrow();
  }, 250);
  };
  (function() {
    var e = document.createElement('script'); e.async = true;
    e.src = document.location.protocol +
      '//connect.facebook.net/en_US/all.js';
    document.getElementById('fb-root').appendChild(e);
  }());
</script> 
```

有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:59:45.920

建议 - facebook 中有一个用户设置始终使用 https。因此，如果您的服务器没有正确的 SSL 证书/或者您在应用程序设置中提供了错误的安全 URL，则无法在 https 中加载该选项卡，并且只有启用该设置的用户可能会遇到问题。

# c# - 如何发布照片和标记朋友 - 使用 facebook sdk

> ID：13070132
> 
> 赞同：1
> 
> 时间：2012-10-25T13:51:43.487
> 
> 标签：c#, facebook, post, sdk, photo

我正在使用[Facebook C# SDK](http://csharpsdk.org/)。

问题：

'是张贴照片，但不是“标签”

```
public JsonResult PostFacebookTagPhoto()
{
    var path = Request["url"];
    var tag = Request["tags"];

    var facebookClient = new FacebookClient(Session["facebook.accessToken"].ToString());
    var file = new FileInfo(path);

    var data = System.IO.File.ReadAllBytes(file.FullName);

    var stream = System.IO.File.OpenRead(path);

    try
    {
        var itens = JsonHelper.JsonDeserialize<List<TagFacebook>>(tag);
        dynamic me = Session["facebook.me"];
        var tags = new[] 
        { 
            new { itens[1].tag_uid, x = 30, y = 40},
            new { itens[2].tag_uid, x = 40, y = 50},
            new { itens[3].tag_uid, x = 30, y = 40},
            new { itens[4].tag_uid, x = 40, y = 50},
            new { tag_uid = (string)me.id, x = 50, y = 40}
        };

        dynamic parameters = new ExpandoObject();
        parameters.message = GetFacebookMessage();
        parameters.tags = tags;
        parameters.file = new FacebookMediaObject
        {
              ContentType = MimeTypes.GetMimeType(file.Extension.ToLowerInvariant()),
              FileName = file.Name.ToLowerInvariant()
        }.SetValue(data);
        try
        {
            facebookClient.Post("/me/photos", parameters); //LINE 133
        }
        catch (FacebookApiException ex)
        {
            return new JsonResult { Data = new { status = "error", message = ex.Message, source = ex.Source, stacktrace = ex.StackTrace }, JsonRequestBehavior = JsonRequestBehavior.AllowGet };
        }

        //SalvaDados(me, itens);

        return new JsonResult { Data = new { status = "ok" }, JsonRequestBehavior = JsonRequestBehavior.AllowGet };
    }
    catch (FacebookOAuthException ex)
    {
        return new JsonResult { Data = new { status = "error", message = ex.Message }, JsonRequestBehavior = JsonRequestBehavior.AllowGet };
    }
} 
```

错误消息：

> （异常 - #1399017）抱歉，发生错误。请再试一次。

堆栈跟踪：

> 在 Facebook.FacebookClient.ProcessResponse(HttpHelper httpHelper, String responseString, Type resultType, Boolean containsEtag, IList`1 batchEtags)
> 在 Facebook.FacebookClient.Api(HttpMethod httpMethod, String path, Object parameters, Type resultType)
> 在 Facebook.FacebookClient.Post(字符串路径，对象参数）
> 在 (...)\Controllers\SiteController.cs:line 133

# facebook - 返回 url facebook 登录失败

> ID：13070137
> 
> 赞同：2
> 
> 时间：2012-10-25T13:51:58.847
> 
> 标签：facebook, connect

我开发了一个 Facebook 登录应用程序，它一直工作到昨天。今天，在使用 facebook 登录后，同一个应用程序不会重定向回我的 url。

网址是 [http://www.targamy.it/2.0/fbc.php](http://www.targamy.it/2.0/fbc.php)

并且回调在此网址的白页上停止： [https://www.facebook.com/login.php?login_attempt=1&fbconnect=1&display=page&next=http%3A%2F%2Fwww.targamy.it%2F2.0% 2Ffbc.php&req_perms=user_photos%2Cuser_videos%2Cemail%2Cuser_birthday%2Coffline_access%2Cpublish_stream%2Cstatus_update&legacy_return=1](https://www.facebook.com/login.php?login_attempt=1&fbconnect=1&display=page&next=http%3A%2F%2Fwww.targamy.it%2F2.0%2Ffbc.php&req_perms=user_photos%2Cuser_videos%2Cemail%2Cuser_birthday%2Coffline_access%2Cpublish_stream%2Cstatus_update&legacy_return=1)

我没有更改任何内容，提交仍然有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T19:23:32.310

遗留身份验证流程的使用已被弃用很长时间，并于昨天被删除。有关过去一年默认流程的文档，请参阅[https://developers.facebook.com/docs/concepts/login/ 。](https://developers.facebook.com/docs/concepts/login/)

# html - html5视频码率切换

> ID：13070139
> 
> 赞同：3
> 
> 时间：2012-10-25T13:52:09.787
> 
> 标签：html, html5-video

我们希望在我们的网站中实现视频，但我们希望根据观众互联网连接的质量来切换视频比特率。

*   适合服务器»客户端连接的带宽。
*   适合播放器显示屏的宽度（或者，准确地说，不超过 20%）。
*   在任何时候都不会导致超过 25% 的帧丢失。

有没有办法使用 HTML5 视频来做到这一点？

亲切的问候，大安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-05T22:14:50.417

我真的不这么认为，我也在寻找解决方案。据我所知，html5 视频仅支持渐进式视频下载或无法进行多比特率流式传输的 HLS。

然而，使用 flash 代替 html5 视频可以支持多比特率流。缺点是您的用户需要在他们的系统上安装 Flash。

如果用户没有 Flash 回退到 html5 上的 HLS，它在所有浏览器和设备上都受支持。（我所知道的）。

这就是我计划建立我的网站的方式，但我仍然感到困惑。

# java - Liferay openAM 配置错误

> ID：13070140
> 
> 赞同：1
> 
> 时间：2012-10-25T13:52:10.523
> 
> 标签：java, liferay, single-sign-on, openam, opensso

我正在使用 openAM 在 Liferay 上配置 openSSO，在我更改 Liferay 后端和 portal-ext.properties 中的所有内容后，我在控制台中收到此错误

```
Exception in thread "liferay/scheduler_dispatch-215" java.lang.NoClassDefFoundError: Could not initialize class com.liferay.portal.kernel.util.InetAddressUtil$LocalHostNameHolder
at com.liferay.portal.kernel.util.InetAddressUtil.getLocalHostName(InetAddressUtil.java:32)
at com.liferay.portal.kernel.scheduler.SchedulerEngineUtil._auditSchedulerJobs(SchedulerEngineUtil.java:455)
at com.liferay.portal.kernel.scheduler.SchedulerEngineUtil.auditSchedulerJobs(SchedulerEngineUtil.java:92)
at com.liferay.portal.kernel.scheduler.messaging.SchedulerEventMessageListenerWrapper.receive(SchedulerEventMessageListenerWrapper.java:103)
at com.liferay.portal.kernel.messaging.InvokerMessageListener.receive(InvokerMessageListener.java:63)
at com.liferay.portal.kernel.messaging.ParallelDestination$1.run(ParallelDestination.java:114)
at com.liferay.portal.kernel.concurrent.ThreadPoolExecutor$WorkerTask._runTask(ThreadPoolExecutor.java:671)
at com.liferay.portal.kernel.concurrent.ThreadPoolExecutor$WorkerTask.run(ThreadPoolExecutor.java:582)
at java.lang.Thread.run(Thread.java:680) 
```

谁能告诉我这是什么问题或问题？

我正在使用 openAM 10 和 Liferay 6.1.20ee

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T07:57:38.153

只是为了让您不要看错方向……这个问题与 OpenAM 集成无关。

# android - 来自Android中的客户经理或谷歌帐户的离线access_token

> ID：13070142
> 
> 赞同：3
> 
> 时间：2012-10-25T13:52:14.503
> 
> 标签：android, oauth-2.0, accountmanager, google-account

是否可以从android中的客户经理获取离线类型access_token（oauth2.0）？我会解释为什么我需要这个，

我将从客户经理那里检索身份验证令牌并在服务器端使用它以备将来使用。因此，我希望令牌的刷新发生在服务器端本身，而无需再次从客户经理那里获得。为此，我需要一个刷新令牌。我读到只有“离线”类型才能获得刷新令牌。请参阅[http://googlecode.blogspot.in/2011/10/upcoming-changes-to-oauth-20-endpoint.html](http://googlecode.blogspot.in/2011/10/upcoming-changes-to-oauth-20-endpoint.html)。但是客户经理只返回“在线”令牌，没有刷新令牌。也看看

> 当您的应用程序请求离线访问时，向用户显示的同意页面将反映您的应用程序请求离线访问并且您的应用程序将收到访问和刷新令牌。一旦你的应用程序有了一个刷新令牌，它就可以随时获取一个新的访问令牌。
> 
> 当您的应用程序请求在线访问时，您的应用程序只会收到一个访问令牌。不会返回刷新令牌。这意味着用户必须在场，您的应用程序才能获得新的访问令牌。

在上面的链接中。每当我在令牌过期后向客户经理请求新令牌时，我都没有得到任何用户同意屏幕。所以我认为客户经理实际上请求离线令牌并将刷新令牌保留给自己使用它来给我们新令牌。

我的问题是如何从客户经理那里获得离线类型 access_token。请帮我。

# java - 从java中的xml中提取文本

> ID：13070153
> 
> 赞同：3
> 
> 时间：2012-10-25T13:52:50.467
> 
> 标签：java, android, xml, parsing, sax

我正在尝试为 android 创建一个 rss 阅读器。所以我连接到一个 rss ulr 并获取一些 XML 信息。这是链接 - [http://www.bulgarianhistory.org/feed/](http://www.bulgarianhistory.org/feed/) 如果您打开它查看源代码，您会注意到有一个标签**content:encoded**。如何获取此标签中的信息？我的代码只是跳过它！我正在使用 SAX。这是我的 Parser 类：

```
public class RSSParser extends DefaultHandler {
    private final static String TAG_ITEM = "item";
    private final static String[] xmltags = { "title", "link", "pubDate", "description", "content" };

    private RSSItem currentitem = null;
    private ArrayList<RSSItem> itemarray = null;
    private int currentindex = -1;
    private boolean isParsing = false;
    private StringBuilder builder = new StringBuilder();

    public RSSParser(ArrayList<RSSItem> itemarray) {
        super();

        this.itemarray = itemarray;
    }

    @Override
        public void characters(char[] ch, int start, int length) throws SAXException {
            super.characters(ch, start, length);

            if(isParsing && -1 != currentindex && null != builder)
            {
                builder.append(ch,start,length);
            }
        }

    @Override
        public void startElement(String uri, String localName, String qName,Attributes attributes) throws SAXException {
            super.startElement(uri, localName, qName, attributes);

            if(localName.equalsIgnoreCase(TAG_ITEM))
            {
                currentitem = new RSSItem();
                currentindex = -1;
                isParsing = true;

                itemarray.add(currentitem);
            }
            else
            {
                currentindex = itemIndexFromString(localName);

                builder = null;

                if(-1 != currentindex)
                    builder = new StringBuilder();
            }
        }

    @Override
        public void endElement(String uri, String localName, String qName) throws SAXException {
            super.endElement(uri, localName, qName);

            if(localName.equalsIgnoreCase(TAG_ITEM))
            {
                isParsing = false;
            }
            else if(currentindex != -1)
            {
                if(isParsing)
                {
                    switch(currentindex)
                    {
                        case 0: currentitem.title = builder.toString();                 break;
                        case 1: currentitem.link = builder.toString();                  break;
                        case 2: currentitem.date = builder.toString();                  break;
                        case 3: currentitem.description= builder.toString();            break;
                        case 4: currentitem.content = builder.toString();               break;
                    }
                }
            }
        }

    private int itemIndexFromString(String tagname){
        int itemindex = -1;

        for(int index= 0; index<xmltags.length; ++index)
        {
            if(tagname.equalsIgnoreCase(xmltags[index]))
            {
                itemindex = index;

                break;
            }
        }

        return itemindex;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:34:38.430

看起来带有命名空间的标签被您的`if`. 试试在这里打印标签名称

```
 private int itemIndexFromString(String tagname){
        int itemindex = -1;

        for(int index= 0; index<xmltags.length; ++index)
        {
            **PRINT (tagname)**
            if(tagname.equalsIgnoreCase(xmltags[index]))
            { 
```

如果它打印为`content:encoded`，则需要修改`xmltags []`为 inlcude`content:encoded`而不是`content`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:22:53.683

我真的建议不要`Sax`在 Android 上使用，因为据我记得它在 Android 上的性能真的很慢。您应该使用[`XmlPullParser`](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html)附带的`Android`，因此无需添加任何外部`jars`，并且您将获得显着的性能改进。我刚刚测试过并将标签`XmlPullParser`解析`<content:encoded>`为任何其他标签，所以它会起作用。

# java - JPA中使用多线程的事务

> ID：13070157
> 
> 赞同：4
> 
> 时间：2012-10-25T13:53:02.140
> 
> 标签：java, spring, jakarta-ee, jpa

我的目标是使用单元测试在我的应用程序中引发乐观锁定异常。我已经在理论上了解了如何做到这一点。但我在实践中的问题是如何维护两个线程之间的事务？

所以，这就是我到目前为止所做的：

我正在使用 JUnit 测试：

```
@RunWith(SpringJUnit4ClassRunner.class) 
```

使用 EntityManager *org.springframework.orm.jpa.JpaTransactionManager*

每个方法都被定义的地方`@Transactional(propagation = Propagation.REQUIRED, rollbackFor = Exception.class)`

并开始交易`entityManager.getTransaction().begin();`并结束于`entityManager.getTransaction().rollback());`

这在单线程测试中效果很好，可以保存、更新等。

要创建多个线程，我使用 Springs TaskExecutor（类似于这里描述的： [Any good Spring threading with a TaskExecutor examples?](https://stackoverflow.com/questions/852743/any-good-spring-threading-with-a-taskexecutor-examples)）

但是我必须做些什么来维护两个线程之间的事务呢？我尝试过使用@Transactional 注释run() 方法之类的东西，但这不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T14:17:59.433

想到的几个问题——

**全局事务**
你的所有线程都应该是同一个事务的一部分吗？其含义是，如果一个线程抛出异常，您是否要回滚其他线程中的更改？

**本地事务** 每个线程是否应该有自己的事务边界而不影响其他线程？在这种情况下，一个线程中的异常和回滚不会影响其他线程。

要实现全局事务，您很可能必须使用具有适当资源驱动程序的 JTA 事务管理器。Spring 没有对全局事务的默认支持。如果您的应用程序在 Java EE 应用程序服务器（Jboss、Weblogic）中运行，则默认情况下您会获得 JTA 支持，并且您可以配置 spring 以使用应用程序服务器的事务管理功能。如果您在 tomcat 中运行，您可以插入一个开源 JTA 实现，例如 -

[阿托米科斯](http://www.atomikos.com/)

[Jboss 交易](http://www.jboss.org/jbosstm)

为了实现本地事务（即，每个线程都有自己的事务边界），我认为除了使用 spring 事务注释之外你不需要做任何事情。在下面的示例中，只需确保 'service' 是一个 spring bean 并且 doSomething() 被适当地注释。

```
taskExecutor.execute( new Runnable() {
           public void run() {
                service.doSomething( );
           }
      }); 
```

# php - magento 将表格 1.4.0.1 升级到 1.7.0.2 我缺少订单和发票记录

> ID：13070158
> 
> 赞同：0
> 
> 时间：2012-10-25T13:53:11.070
> 
> 标签：php, mysql, magento-1.4, magento-1.7, duplicates

参考这个问题[magento upgrade from 1.4.0.1 to 1.4.2.0](https://stackoverflow.com/questions/13069119/magento-upgrad-from-1-4-0-1-to-1-4-2-0#comment17752166_13069119)

现在我从订单和发票中丢失了许多记录。如何解决它并获取我的所有订单和发票。

更多我也升级到 1.7.0.2，它也有同样的问题。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-31T17:19:19.640

我找到了与销售和订单相关的表格，还找到了插入订单。正如我在上一个问题中提到的，升级运行时会出现错误。错误是在销售 sql 文件中发现的重复条目。因此，我运行以下查询，现在正在从销售表进行升级。

```
TRUNCATE `sales_flat_quote_address`; 
ALTER TABLE `sales_flat_quote_address` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_quote_address_item`; 
ALTER TABLE `sales_flat_quote_address_item` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_quote_item`; 
ALTER TABLE `sales_flat_quote_item` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_quote_item_option`; 
ALTER TABLE `sales_flat_quote_item_option` AUTO_INCREMENT=1;
TRUNCATE `sales_flat_quote_payment`; 
ALTER TABLE `sales_flat_quote_shipping_rate` AUTO_INCREMENT=1;
TRUNCATE `sales_flat_invoice`; 
ALTER TABLE `sales_flat_invoice` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_invoice_comment`; 
ALTER TABLE `sales_flat_invoice_comment` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_invoice_grid`; 
ALTER TABLE `sales_flat_invoice_grid` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_invoice_item`; 
ALTER TABLE `sales_flat_invoice_item` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_creditmemo`; 
ALTER TABLE `sales_flat_creditmemo` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_creditmemo_comment`; 
ALTER TABLE `sales_flat_creditmemo_comment` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_creditmemo_grid`; 
ALTER TABLE `sales_flat_creditmemo_grid` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_creditmemo_item`; 
ALTER TABLE `sales_flat_creditmemo_item` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_shipment`; 
ALTER TABLE `sales_flat_shipment` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_shipment_grid`; 
ALTER TABLE `sales_flat_shipment_grid` AUTO_INCREMENT=1; 
TRUNCATE `sales_flat_shipment_item`; 
ALTER TABLE `sales_flat_shipment_item` AUTO_INCREMENT=1; 
SET FOREIGN_KEY_CHECKS = 1; 
```

# c# - 列表 > 在 C# 中，其中 T 和 U 是接口

> ID：13070160
> 
> 赞同：3
> 
> 时间：2012-10-25T13:53:17.977
> 
> 标签：c#, .net, generics, .net-3.5

好的。所以我目前正在尝试在 C# 中创建一个以接口为参数的接口列表。为了更清楚地说明这一点，让我举个例子：

```
public interface IPlate<T> where T : IWaffle {}
public interface IWaffles {}

public class BelgiumWaffle : IWaffle {}
public class FalafelWaffle : IWaffle {}
public class HugePlate : IPlate<BelgiumWaffle> {}
public class SmallPlate : IPlate<FalafelWaffle> {}

// Now, I want to do the following:
var plates = new List<IPlate<IWaffle>>();
plates.add(new HugePlate());
plates.add(new SmallPlate()); 
```

目标是能够将 IPlate 对象列表序列化为 XML。我希望使用泛型来做到这一点，但我不断收到错误消息，告诉我在尝试添加时存在一些参数错误（又名 - 类型不匹配）。只是不确定我在这里做错了什么。这对我来说似乎是正确的，但我必须遗漏一些东西（显然）。

**更新**：我应该提到这是.NET v3.5

**更新**：对不起！写关于板类定义的问题时出现一些拼写错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T13:56:46.630

我认为你应该使用协方差（.NET 4.0）

```
public interface IPlate<out T> where T : IWaffle {} 
```

并替换`IPancake`为`IWaffle`

```
var plates = new List<IPlate<IPancake>>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:58:43.700

既不`HugePlate`也不`SmallPlate`实现列表`IPlate<IPancake>`所需的接口`plates`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T14:11:52.647

除了协方差（正如@JakubKonecki 已经指出的那样），您对 HugePlate 和 SmallPlate 的定义看起来不正确，因为它们需要实现`IPlate`.

试试这个：

```
public interface IPlate<out T> where T : IWaffle {}
public interface IWaffle {}

public class BelgiumWaffle : IWaffle {}
public class FalafelWaffle : IWaffle {}
public class HugePlate<T> : IPlate<T> where T : IWaffle {}
public class SmallPlate<T> : IPlate<T> where T : IWaffle {} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T16:23:21.077

在 .NET Framework 3.5 中，您没有像在 .NET Framework 4.0 中那样在**`out`**泛型**协方差上使用的参数。**

您可以尝试使用您的非通用版本`IPlate`（在这种情况下我命名它`IPlateNG`）来解决它。

**考虑.NET Framework 4.0**中的以下示例（我必须扩展它以表明我的观点）：

```
using System;
using System.Collections.Generic;

public interface IWaffle { string Eat(); }
// on C# 4.0 you just put the "out" to mark the covariance (and that is it)
public interface IPlate<out T> where T : IWaffle { T GetMyWaffle(); }

public class BelgiumWaffle : IWaffle {
    public string Eat() { return "Eating a Belgium Waffle"; }
    public string Breakfast() { return "Breakfasting a Belgium Waffle"; }
}
public class FalafelWaffle : IWaffle {
    public string Eat() { return "Eating a Falafel Waffle"; }
    public string Dinner() { return "Having dinner with a Falafel Waffle"; }
}
public class HugePlate : IPlate<BelgiumWaffle> {
    public BelgiumWaffle GetMyWaffle() { return new BelgiumWaffle(); }
}
public class SmallPlate : IPlate<FalafelWaffle> {
    public FalafelWaffle GetMyWaffle() { return new FalafelWaffle(); }
}

class Program
{
    static void Main(string[] args)
    {
        var plates = new List<IPlate<IWaffle>>();
        plates.Add(new HugePlate());
        plates.Add(new SmallPlate());

        IPlate<IWaffle> aPlate = plates[0];
        // Anyway, when you get a member of the collection you'll get the interface, not a concrete class (obviously).
        IWaffle aWaffle = aPlate.GetMyWaffle();
        // So you cannot invoke any specifics (like Breakfast or Dinner)
        Console.WriteLine(aWaffle.Eat());

        // But if you cast the member of the collection to the specific class (or interface)
        IPlate<FalafelWaffle> aSmallPlate = (SmallPlate)plates[1];
        // Then you'll get the concrete class without casting again
        FalafelWaffle aFalafel = aSmallPlate.GetMyWaffle();
        Console.WriteLine(aFalafel.Dinner());
    }
} 
```

现在这对于**.NET Framework 3.5**也是一样的：

```
using System;
using System.Collections.Generic;

public interface IWaffle { string Eat(); }
// In this case I define this extra inteface which is non-generic
// And inside it, we need a new method equivalent to the one on the generic one
public interface IPlateNG { IWaffle GetWaffle(); }
// And make the generic one implement the non-generic one
public interface IPlate<T> : IPlateNG where T : IWaffle { T GetMyWaffle(); }

public class BelgiumWaffle : IWaffle {
    public string Eat() { return "Eating a Belgium Waffle"; }
    public string Breakfast() { return "Breakfasting a Belgium Waffle"; }
}
public class FalafelWaffle : IWaffle {
    public string Eat() { return "Eating a Falafel Waffle"; }
    public string Dinner() { return "Having dinner with a Falafel Waffle"; }
}
public class HugePlate : IPlate<BelgiumWaffle> {
    // This extra method is needed due the lack of the 'out' on the definition
    public IWaffle GetWaffle() { return GetMyWaffle(); }
    public BelgiumWaffle GetMyWaffle() { return new BelgiumWaffle(); }
}
public class SmallPlate : IPlate<FalafelWaffle> {
    // This extra method is needed due the lack of the 'out' on the definition
    public IWaffle GetWaffle() { return GetMyWaffle(); }
    public FalafelWaffle GetMyWaffle() { return new FalafelWaffle(); }
}

class Program
{
    static void Main(string[] args)
    {
        // The list cannot work with the IPlate<IWaffle> anymore. So here comes IPlateNG to the rescue
        var plates = new List<IPlateNG>();
        plates.Add(new HugePlate());
        plates.Add(new SmallPlate());

        IPlateNG aPlate = plates[0];
        // And instead of calling to the GetMyWaffle method we can call to the GetWaffle in this case
        IWaffle aWaffle = aPlate.GetWaffle();
        Console.WriteLine(aWaffle.Eat());

        IPlate<FalafelWaffle> aSmallPlate = (SmallPlate)plates[1];
        FalafelWaffle aFalafel = aSmallPlate.GetMyWaffle();
        Console.WriteLine(aFalafel.Dinner());
    }
} 
```

请注意，我必须在两个具体类上制作`GetMyWaffle`(named )的额外非泛型版本，以解决缺少“ **out** ”关键字的问题。但其余部分非常相似。`GetWaffle``IPlate`

 *** * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T14:12:39.670

在 3.5 中工作，感谢@JakubKonecki 指出协方差

```
 public interface IWaffle { }
    public interface IPlate<out T> where T : IWaffle { }
    public interface IPancake : IWaffle { }

    public class BelgiumWaffle : IWaffle {}
    public class FalafelWaffle : IWaffle {}
    public class HugePlate : IPlate<BelgiumWaffle> {}
    public class SmallPlate : IPlate<FalafelWaffle> { }

    var plates = new List<IPlate<IWaffle>>();
    plates.Add(new HugePlate());
    plates.Add(new SmallPlate()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-25T15:17:48.810

你可以使用抽象类而不是 T 的接口吗？

```
public abstract class Waffle { }
public interface IPlate<T> where T : Waffle
{
    T Food
    {
        get;
        set;
    }
}

public class BelgiumWaffle : Waffle { }
public class FalafelWaffle : Waffle { }
public class HugePlate<T> : IPlate<T> where T : Waffle
{
    public HugePlate(T food)
    {
        this.Food = food;
    }

    public T Food
    {
        get;
        set;
    }
}

public class SmallPlate<T> : IPlate<T> where T : Waffle
{
    public SmallPlate(T food)
    {
        this.Food = food;
    }

    public T Food
    {
        get;
        set;
    }
}

public class Test
{
    Test()
    {
        var platesOfWaffle = new List<IPlate<Waffle>>();
        platesOfWaffle.Add(new HugePlate<Waffle>(new BelgiumWaffle()));
        platesOfWaffle.Add(new SmallPlate<Waffle>(new FalafelWaffle()));
    }
} 
```**

# ruby-on-rails - 优化活动记录查询以显示活动的参与者

> ID：13070164
> 
> 赞同：0
> 
> 时间：2012-10-25T13:53:29.443
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我目前在一个活动网站上进行黑客攻击，过去从未遇到过优化查询/扩展我的数据库的问题，因为从来没有那么多数据，但现在数据库中有近一百万行，它需要大约 15,000 m/s呈现事件的提要，特别是非常慢的部分（在每个 _event.html.erb 内）是显示您当前关注的所有正在参加该事件的用户的位置。我已经寻找了很多提高性能的可能性，包括预加载、索引、内存缓存等……但是想知道如何重写它以更快地执行？谢谢！

_attending.html.erb

```
<% if user_signed_in? %>
        <% @rsvp = Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going') %>
        <% if @rsvp.count == 0 %>
            <%= eventcount(event) %> going.
        <% elsif @rsvp.count == 1 %>
            <% if eventcount(event) - 1 == 0 %>
                <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[0..0].each do |f| %>
                    <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> is going.
                <% end %>
            <% else %>
              <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[0..0].each do |f| %>
                  <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> and <%= eventcount(event) - 1 %> going.
              <% end %>
            <% end %>
        <% elsif @rsvp.count == 2 %>
            <% if eventcount(event) - 2 == 0 %>
                <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[0..0].each do |f| %>
                    <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> and
                <% end %>
                <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[1..1].each do |f| %>
                    <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> are going.
                <% end %>
            <% else %>
              <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[0..0].each do |f| %>
                  <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>,
              <% end %>
              <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[1..1].each do |f| %>
                  <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> and <%= eventcount(event) - 2 %> going.
              <% end %>
                <% end %>
        <% elsif @rsvp.count == 3 %>
            <% if eventcount(event) - 3 == 0 %>
                <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[0..0].each do |f| %>
                    <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>,
                <% end %>
                <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[1..1].each do |f| %>
                    <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>, and
                <% end %>
                <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[2..2].each do |f| %>
                    <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> are going.
                <% end %>
            <% else %>
              <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[0..0].each do |f| %>
                  <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>,
              <% end %>
              <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[1..1].each do |f| %>
                  <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>,
              <% end %>
              <% Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')[2..2].each do |f| %>
                  <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> and <%= eventcount(event) - 3 %> are going.
              <% end %>
            <% end %>
            <% end %>
    <% else %>
        <%= eventcount(event) %> going.
    <% end %> 
```

RSVP 的架构

```
create_table "rsvps", :force => true do |t|
  t.string    "status"
  t.integer   "event_id"
  t.integer   "voter_id"
  t.string    "voter_name"
  t.string    "voter_type"
  t.timestamp "created_at", :null => false
  t.timestamp "updated_at", :null => false
end

add_index "rsvps", ["voter_id", "voter_type", "event_id"], :name => "fk_one_rsvp_per_user_per_entity", :unique => true
add_index "rsvps", ["voter_id", "voter_type"], :name => "index_rsvps_on_voter_id_and_voter_type" 
```

关系模式

```
create_table "relationships", :force => true do |t|
  t.integer   "follower_id"
  t.integer   "followed_id"
  t.timestamp "created_at",  :null => false
  t.timestamp "updated_at",  :null => false
end

add_index "relationships", ["followed_id"], :name => "index_relationships_on_followed_id"
add_index "relationships", ["follower_id"], :name => "index_relationships_on_follower_id" 
```

用户模型的相关部分

```
has_many :relationships, :foreign_key => "follower_id",
:dependent => :destroy

has_many :following, :through => :relationships, :source => :followed

has_many :reverse_relationships, :foreign_key => "followed_id",
       :class_name => "Relationship",
       :dependent => :destroy
has_many :followers, :through => :reverse_relationships, :source => :follower 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:01:47.667

如果大数据库是 RSVP：

您在部分中对 db 进行了非常大的调用，尝试`Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')`仅减少一次 n 调用，然后在不同情况下对其进行处理。这对性能有一点帮助（如果您有一个大数据库，那么每次在大数据库中调用 .where 都是一个复杂的过程）。重新使用变量@rsvp。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:21:57.587

只需快速清理并遵循@damoiser 所说的，您应该将您的视图重构为这样的东西。

**_attending.html.erb**

```
<% if user_signed_in? %>
  <% @rsvp = get_rsvps %>
  <% if @rsvp.count == 0 %>
    <%= eventcount(event) %> going.
  <% elsif @rsvp.count == 1 %>
    <% if eventcount(event) - 1 == 0 %>
      <% @rsvp[0..0].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> is going.
      <% end %>
    <% else %>
      <% @rsvp[0..0].each do |f| %>
          <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> and <%= eventcount(event) - 1 %> going.
      <% end %>
    <% end %>
  <% elsif @rsvp.count == 2 %>
    <% if eventcount(event) - 2 == 0 %>
      <% @rsvp[0..0].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> and
      <% end %>
      <% @rsvp[1..1].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> are going.
      <% end %>
    <% else %>
      <% @rsvp[0..0].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>,
      <% end %>
      <% @rsvp[1..1].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> and <%= eventcount(event) - 2 %> going.
      <% end %>
    <% end %>
  <% elsif @rsvp.count == 3 %>
    <% if eventcount(event) - 3 == 0 %>
      <% @rsvp[0..0].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>,
      <% end %>
      <% @rsvp[1..1].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>, and
      <% end %>
      <% @rsvp[2..2].each do |f| %>
          <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> are going.
      <% end %>
    <% else %>
      <% @rsvp[0..0].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>,
      <% end %>
      <% @rsvp[1..1].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %>,
      <% end %>
      <% @rsvp[2..2].each do |f| %>
        <%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %> and <%= eventcount(event) - 3 %> are going.
      <% end %>
    <% end %>
  <% end %>
<% else %>
  <%= eventcount(event) %> going.
<% end %> 
```

您还应该有一些这样的助手：

**some_helper.rb**

```
module SomeHelper
  def get_rsvps
    Rsvp.where(:voter_id => current_user.following, :event_id => event.id, :status => 'going')
  end
end 
```

**巨大的注意**：这个代码仍然没有任何好处。我仍然认为有很多重构要做。就像 [0..0].each 和 [1..1].each 以及 link_to 助手上的大量代码重复。但这应该会给您带来一些性能，因为您只是在调用 rsvps 并重用您存储在 @rsvp 中的内容。

# c++ - 从内存创建着色器时出错

> ID：13070167
> 
> 赞同：2
> 
> 时间：2012-10-25T13:53:39.850
> 
> 标签：c++, directx, shader, hlsl

由于`d3dcompiler*.dll`变得不受欢迎，我试图从我的应用程序中排除对它的依赖。我的新编译着色器对象 (.cso) 文件加载代码有问题。

```
ifstream fstream;  
fstream.open (vsfile);
if(fstream.fail())
    return false;

fstream.seekg( 0, ios::end );  
size_t size = size_t(fstream.tellg());  
char* data = new char[size];

fstream.seekg(0, ios::beg);  
fstream.read( data, size);  
fstream.close();  

XTRACE2(pDevice->CreateVertexShader(&data, size, 0, &m_pVertexShader)) 
```

问题：`CreateVertexShader()`返回`E_INVALIDARG`错误。

旧代码`D3DReadFileToBlob()`工作正常。Blob 返回与我的`char*`或`std::vector<char>`等于`.cso`文件大小的相同大小的缓冲区。我知道，MSDN 上有新的 Windows 8 示例，但它们使用了一些新的 Metro 东西。我想用普通的 C++ 来做。

`XTRACE2`只是 DirectX 错误检查宏。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:20:05.773

错误是由在文本模式下读取二进制文件引起的。如果将二进制标志添加到读取功能，则按预期工作。像这样的东西：

```
 std::ifstream fstream;  
            fstream.open (filename,  std::ifstream::in | std::ifstream::binary);
            if(fstream.fail())
                return false;

            fstream.seekg( 0, std::ios::end );  
            size_t size = size_t(fstream.tellg());  
            data.resize(size);  
            fstream.seekg(0, std::ios::beg);  
            fstream.read( &data[0], size);  
            fstream.close(); 
```

羡慕我=\

# c# - 自动调整单元格大小以填充屏幕而不删除单元格

> ID：13070168
> 
> 赞同：1
> 
> 时间：2012-10-25T13:53:41.420
> 
> 标签：c#, .net, wpf

假设我有 1 行和 2 列。两者都有一个视频流，它会自动调整大小以填充它可以填充的内容，因此它们都占据了一半的屏幕。

我希望能够删除一个流并让第二个流填满整个屏幕。所以基本上，让第二个单元格推动以填满整个屏幕，因为没有任何东西占据第一个单元格以“推回”它。

我知道我可以通过删除单元格来做到这一点，但如果有一些设置来完成我所描述的内容，它会更清洁、更简单和更容易。

编辑：

```
 <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions> 
```

我只从其中一个开始，然后通过以下方式动态扩展：

```
 if (grd.ColumnDefinitions.Count == grd.RowDefinitions.Count)
                {
                    System.Windows.Controls.ColumnDefinition newColumn;
                    newColumn = new System.Windows.Controls.ColumnDefinition();
                    grd.ColumnDefinitions.Add(newColumn);
                    Column = grd.ColumnDefinitions.Count - 1;
                    Row = 0;
                }
                else
                {
                    System.Windows.Controls.RowDefinition newRow;
                    newRow = new System.Windows.Controls.RowDefinition();
                    grd.RowDefinitions.Add(newRow);
                    Row = grd.RowDefinitions.Count - 1;
                    Column = 0;
                } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:09:09.003

尝试将容器控件（视图流控件本身或其容器）`Width`的`GridViewColumn`to`0`和 the设置为.`Visibility``Collapsed`

**编辑**
虽然 a[`UniformGrid`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.uniformgrid.aspx)可能更容易使用。然后您只需将控件的可见性设置为折叠（这将从宽度计算中删除该控件）。

我建议将 UniformGrid 的`Rows`属性设置`1`为将所有内容都放在一行上（否则它将开始交替添加行和列的过程）。

```
<UniformGrid Rows="1">
    <Grid Visibility="{Binding IsVideo1Visible, Converter={BooleanToVisibilityConverter}}">
        <abc:VideoStream>
    </Grid>
    <abc:VideoStream Visibility="{Binding IsVideo2Visible, Converter={BooleanToVisibilityConverter}}">
</UniformGrid> 
```

*使用上面的代码获得灵感。第一个视频流控件包含在一个 Grid 中，只是为了演示如果您使用的控件不公开，您可以如何“添加”可见性属性。它是完全可选的。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:23:28.400

另一种解决方案是将两个视频流包装到网格中的单个 StackPanel 中。然后，将视频控件的 Visibility 设置为 Collapsed 将提供您正在寻找的功能。

然而，StackPanels 确实消除了 WPF 的“自动调整大小”魔法的很大一部分，因为它们具有无限的宽度和高度，但在某些情况下它是一个简单的解决方案。

# django - 在 Django 中刷新模型的非托管相关模型

> ID：13070173
> 
> 赞同：0
> 
> 时间：2012-10-25T13:53:56.127
> 
> 标签：django, orm

我有一个模型（我们称之为实体），它有一个随时间变化的属性（属性），但我想保留该属性在数据库中如何变化的历史记录。我需要能够通过其管理器中 Attribute 的当前值过滤我的实体。但是因为 Django（据我所知）不会让我在一个查询中本地执行此操作，所以我创建了一个数据库视图，它为每个实体生成最新的 Attribute 值。所以我的模型结构看起来像这样：

```
class Entity(models.Model):
    def set_attribute(self, value):
        self.attribute_history.create(value=value)

    def is_attribute_positive(self, value):
        return self.attribute.value > 0

class AttributeEntry(models.Model):
    entity = models.ForeignKey(Entity, related_name='attribute_history')
    value = models.IntegerField()
    time = models.DateTimeField(auto_now_add=True)

class AttributeView(models.Model)
    id = models.IntegerField(primary_key=True, db_column='id', 
        on_delete=models.DO_NOTHING)
    entity = models.OneToOneField(Entity, related_name='attribute')
    value = models.IntegerField()
    time = models.DateTimeField()

    class Meta:
        managed = False 
```

我的数据库具有生成当前属性的视图，使用 SQL 创建，如下所示：

```
CREATE VIEW myapp_attributeview AS
SELECT h1.*
FROM myapp_attributehistory h1
LEFT OUTER JOIN myapp_attributehistory h2
    ON h1.entity_id = h2.entity_id
        AND (h1.time < h2.time
        OR h1.time = h2.time
        AND h1.id < h2.id)
WHERE h2.id IS NULL; 
```

我的问题是，如果我使用`set_attribute()`检查它在模型对象上设置属性`is_attribute_positive()`并不总是有效，因为 Django 可能正在缓存相关的 AttributeView 对象。我怎样才能让 Django 更新它的模型，至少通过重新查询视图？我可以`attribute`以某种方式将该属性标记为脏吗？

PS：我这样做的全部原因是我可以做类似的事情`Entity.objects.filter(attribute__value__exact=...).filter(...)`，所以如果有人知道更简单的方法来获得该功能，那么这样的答案也将被接受！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T18:42:54.867

我知道属性值是由访问同一数据库的另一个进程（甚至可能不是 Django）修改的。如果不是这种情况，您应该查看[django-reversion](https://github.com/etianen/django-reversion)。

另一方面，如果是这种情况，您应该看一下[this](https://stackoverflow.com/questions/1886909/how-to-disable-django-query-cache)的第二个答案。它说提交事务使查询缓存无效并提供此代码段。

```
>>> from django.db import transaction
>>> transaction.enter_transaction_management()
>>> transaction.commit() # Whenever you want to see new data 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T14:54:09.410

我从来没有直接解决过这个问题，但我可以通过更改`is_attribute_positiive()`为直接查询数据库表而不是视图来回避它。

```
def is_attribute_positive(self, value):
    return self.attribute_history.latest().value > 0 
```

因此，虽然视图使我能够灵活地过滤实体上的查询，但一旦收到对象，最好的办法似乎是直接在表支持的模型上进行操作。

# ios - iOS 故事板布局

> ID：13070177
> 
> 赞同：0
> 
> 时间：2012-10-25T13:54:05.160
> 
> 标签：ios, layout, storyboard

我正在开发一个应用程序，并且在设计我的应用程序时遇到了一些图形问题。

首先，我的应用程序仅受 iPhone 支持。我当前的情节提要使用 iPhone 5 作为屏幕尺寸，所以当我尝试在 iPhone 4 和 4S 上运行时，一切都搞砸了。有没有办法为每个不同的屏幕尺寸制作多个故事板？还是你们都有其他解决方案？

谢谢！- 布拉德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T17:00:42.427

有一种方法可以为不同的屏幕尺寸制作不同的故事板，但另一种方法是这样的：

每当您将对象添加到视图中时，请确保将它们与某些东西对齐（使用约束）。如果所有项目都相对于其他项目，那么布局很可能在所有设备上都很好。此外，如果您发现您的控件开始重叠，那么您可能已经用完了空间。在这种情况下，只需将滚动视图添加到您的布局中，然后将控件放在它上面。然后，它不会在较大的屏幕上滚动，因为所有控件都会显示，但在较小的设备上，它将允许您向下滚动以查看其余对象。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:33:35.373

右下角有一个小按钮，可让您在 3.5" 和 4" 屏幕尺寸之间切换，以便查看它在不同设备上的外观。通过使用 iOS 6 中引入的自动布局，您可以确保设置约束，以便您的 UI 在旧款和新款 iPhone 上看起来都不错。

# fluentvalidation - 使用 FluentValidation 为多个属性创建验证规则

> ID：13070178
> 
> 赞同：1
> 
> 时间：2012-10-25T13:54:07.413
> 
> 标签：fluentvalidation

我正在尝试在 FluentValidation 中实现一个复杂的验证场景。

假设我有一个汽车课。它有四个属性：颜色、品牌、型号、年份。

我想构建一个涉及其中三个属性的验证规则。为了对话，假设我想要一个如下的验证规则：

```
if car.make = nissan and car.year = 2010 then
    if car.color <> green then
       throw a validation error since the system does not support 2010 nissans that are not green.
    end     
end 
```

我知道这是一个愚蠢的例子。但是，我的应用程序中的验证规则涉及对象的多个方面。这是我的问题的核心。

我已尝试遵循[http://fluentvalidation.codeplex.com/wikipage?title=Custom](http://fluentvalidation.codeplex.com/wikipage?title=Custom)关于使用 "Using AbstractValidator.Custom" 的指导。

有没有人有 AbstractValidator.Custom 工作的其他工作示例？

在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T09:21:04.937

下面是一种实现涉及多个属性的验证的简单方法

```
public class CarValidator : AbstractValidator<Car>
{
    public CarValidator()
    {
        RuleFor(c => c.Color).NotEqual("Green").When(MakeIsNisssanAndYearIs2000))
    }

    private bool MakeIsNisssanAndYearIs2000(Car arg)
    {
        return arg.Make == "Nissan" && arg.Year == 2000;
    }
}

public class Car
{
    public string Color { get; set; }

    public string Make { get; set; }

    public int Year { get; set; }
} 
```

您可以参数化`MakeIsNissanAndYearIs2000`方法，以便将品牌和型号作为参数传递给方法。但这应该让您了解如何实现涉及多个属性的验证

# java - 退出应用程序时 Java 崩溃：Java 运行时环境检测到致命错误：

> ID：13070186
> 
> 赞同：3
> 
> 时间：2012-10-25T13:55:02.157
> 
> 标签：java, crash, exit, native-code

我有一个驱动电机的 Java 应用程序。电机的驱动程序是用 Microsoft Visual Studio 用 C++ 编写的。我导入（本机代码）这个 dll。Java 应用程序运行没有问题。我可以启动和停止电机。但是当我关闭这个应用程序时，它会在本机代码（电机驱动程序）中崩溃。

我问了这台电机的供应商。他们告诉我，在 Microsoft 环境 (Visual Studio) 中，电机驱动器运行没有问题。他们说，没有错误。但他们从未使用 Java 应用程序测试过驱动程序。

我尝试使用 Exception 和 Error 类来抑制错误。但它没有用。

问题：是否可以抑制此错误消息？

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  EXCEPTION_UNCAUGHT_CXX_EXCEPTION (0xe06d7363) at pc=0x7c812afb, pid=2180, tid=660
#
# JRE version: 6.0_37-b06
# Java VM: Java HotSpot(TM) Client VM (20.12-b01 mixed mode, sharing windows-x86 )
# Problematic frame:
# C  [kernel32.dll+0x12afb]
#
# If you would like to submit a bug report, please visit:
#   http://java.sun.com/webapps/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#

---------------  T H R E A D  ---------------

Current thread (0x02ec8800):  JavaThread "AWT-EventQueue-0" [_thread_in_native, id=660, stack(0x03280000,0x032d0000)]

siginfo: ExceptionCode=0xe06d7363, ExceptionInformation=0x19930520 0x032cee88 0x0425be4c 

Registers:
EAX=0x032cedf0, EBX=0x00000000, ECX=0x00000000, EDX=0x0427eb1c
ESP=0x032cedec, EBP=0x032cee40, ESI=0x032cee78, EDI=0x00000000
EIP=0x7c812afb, EFLAGS=0x00000206

Top of Stack: (sp=0x032cedec)
0x032cedec:   0464dab8 e06d7363 00000001 00000000
0x032cedfc:   7c812afb 00000003 19930520 032cee88
0x032cee0c:   0425be4c 00000008 032cee2c 040d9e0a
0x032cee1c:   0427eb1c 00000000 0010f29c 00000000
0x032cee2c:   032cee58 040da3f8 040da418 5f210f53
0x032cee3c:   00000000 032cee78 041b873d e06d7363
0x032cee4c:   00000001 00000003 032cee6c e06d7363
0x032cee5c:   00000001 00000000 00000000 00000003 

Instructions: (pc=0x7c812afb)
0x7c812adb:   f9 0f 0f 87 6d 1e 03 00 85 c9 89 4d c0 74 07 57
0x7c812aeb:   8d 7d c4 f3 a5 5f 8d 45 b0 50 ff 15 10 15 80 7c
0x7c812afb:   5e c9 c2 10 00 85 ff 0f 8e 36 93 ff ff 8b 55 fc
0x7c812b0b:   89 55 0c 0f b7 16 8b 7d f8 8a 14 3a 88 11 8b 78 

Register to memory mapping:

EAX=0x032cedf0 is pointing into the stack for thread: 0x02ec8800
EBX=0x00000000 is an unknown value
ECX=0x00000000 is an unknown value
EDX=0x0427eb1c is an unknown value
ESP=0x032cedec is pointing into the stack for thread: 0x02ec8800
EBP=0x032cee40 is pointing into the stack for thread: 0x02ec8800
ESI=0x032cee78 is pointing into the stack for thread: 0x02ec8800
EDI=0x00000000 is an unknown value

Stack: [0x03280000,0x032d0000],  sp=0x032cedec,  free space=315k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
C  [kernel32.dll+0x12afb]  RaiseException+0x52
C  [EposCmd.dll+0x26873d]
C  [EposCmd.dll+0x1705da]
C  [EposCmd.dll+0x17ec0d]
C  [EposCmd.dll+0x1564f1]
C  [EposCmd.dll+0x146bca]
C  [EposCmd.dll+0x137714]
C  [EposCmd.dll+0x12d5e8]
C  [EposCmd.dll+0x12fbb2]
C  [EposCmd.dll+0x106e38]
C  [EposCmd.dll+0x107b8b]
C  [EposCmd.dll+0xcfbb8]
C  [EposCmd.dll+0xd2e7b]
C  [EposCmd.dll+0x106e38]
C  [EposCmd.dll+0x43268]
C  [EposCmd.dll+0x39afb]
C  [EposCmd.dll+0x106e38]
C  [EposCmd.dll+0x102b3]
C  [EposCmd.dll+0x4f5b]
C  [EposCmd.dll+0x5125]
C  [MaxonMotor.dll+0x15fb]
j  finaltest.MaxonMotor.close()Z+8
j  finaltest.FrameGWF$1.windowClosing(Ljava/awt/event/WindowEvent;)V+87
j  java.awt.AWTEventMulticaster.windowClosing(Ljava/awt/event/WindowEvent;)V+8
j  java.awt.Window.processWindowEvent(Ljava/awt/event/WindowEvent;)V+68
j  javax.swing.JFrame.processWindowEvent(Ljava/awt/event/WindowEvent;)V+2
j  java.awt.Window.processEvent(Ljava/awt/AWTEvent;)V+69
j  java.awt.Component.dispatchEventImpl(Ljava/awt/AWTEvent;)V+573
j  java.awt.Container.dispatchEventImpl(Ljava/awt/AWTEvent;)V+42
j  java.awt.Window.dispatchEventImpl(Ljava/awt/AWTEvent;)V+65
j  java.awt.Component.dispatchEvent(Ljava/awt/AWTEvent;)V+2
j  java.awt.EventQueue.dispatchEventImpl(Ljava/awt/AWTEvent;Ljava/lang/Object;)V+41
j  java.awt.EventQueue.access$400(Ljava/awt/EventQueue;Ljava/awt/AWTEvent;Ljava/lang/Object;)V+3
j  java.awt.EventQueue$2.run()Ljava/lang/Void;+12
j  java.awt.EventQueue$2.run()Ljava/lang/Object;+1
v  ~StubRoutines::call_stub
V  [jvm.dll+0xfb7cb]
V  [jvm.dll+0x18d3d1]
V  [jvm.dll+0xfb84d]
V  [jvm.dll+0xbbf84]
C  [java.dll+0x102f]  Java_java_security_AccessController_doPrivileged__Ljava_security_PrivilegedAction_2Ljava_security_AccessControlContext_2+0x17
J  java.security.AccessControlContext$1.doIntersectionPrivilege(Ljava/security/PrivilegedAction;Ljava/security/AccessControlContext;Ljava/security/AccessControlContext;)Ljava/lang/Object;
j  java.awt.EventQueue$3.run()Ljava/lang/Void;+11
j  java.awt.EventQueue$3.run()Ljava/lang/Object;+1
v  ~StubRoutines::call_stub
V  [jvm.dll+0xfb7cb]
V  [jvm.dll+0x18d3d1]
V  [jvm.dll+0xfb84d]
V  [jvm.dll+0xbbf84]
C  [java.dll+0x102f]  Java_java_security_AccessController_doPrivileged__Ljava_security_PrivilegedAction_2Ljava_security_AccessControlContext_2+0x17
J  java.security.AccessControlContext$1.doIntersectionPrivilege(Ljava/security/PrivilegedAction;Ljava/security/AccessControlContext;Ljava/security/AccessControlContext;)Ljava/lang/Object;
J  java.awt.EventDispatchThread.pumpOneEventForFilters(I)Z
j  java.awt.EventDispatchThread.pumpEventsForHierarchy(ILjava/awt/Conditional;Ljava/awt/Component;)V+11
j  java.awt.EventDispatchThread.pumpEvents(ILjava/awt/Conditional;)V+4
j  java.awt.EventDispatchThread.pumpEvents(Ljava/awt/Conditional;)V+3
j  java.awt.EventDispatchThread.run()V+9
v  ~StubRoutines::call_stub
V  [jvm.dll+0xfb7cb]
V  [jvm.dll+0x18d3d1]
V  [jvm.dll+0xfb971]
V  [jvm.dll+0xfb9cb]
V  [jvm.dll+0xb5e99]
V  [jvm.dll+0x119ab4]
V  [jvm.dll+0x14209c]
C  [msvcr71.dll+0x9565]  endthreadex+0xa0
C  [kernel32.dll+0xb729]  GetModuleFileNameA+0x1ba

Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)
j  finaltest.MaxonMotorCmd.closeAllDevices()Z+0
j  finaltest.MaxonMotor.close()Z+8
j  finaltest.FrameGWF$1.windowClosing(Ljava/awt/event/WindowEvent;)V+87
j  java.awt.AWTEventMulticaster.windowClosing(Ljava/awt/event/WindowEvent;)V+8
j  java.awt.Window.processWindowEvent(Ljava/awt/event/WindowEvent;)V+68
j  javax.swing.JFrame.processWindowEvent(Ljava/awt/event/WindowEvent;)V+2
j  java.awt.Window.processEvent(Ljava/awt/AWTEvent;)V+69
j  java.awt.Component.dispatchEventImpl(Ljava/awt/AWTEvent;)V+573
j  java.awt.Container.dispatchEventImpl(Ljava/awt/AWTEvent;)V+42
j  java.awt.Window.dispatchEventImpl(Ljava/awt/AWTEvent;)V+65
j  java.awt.Component.dispatchEvent(Ljava/awt/AWTEvent;)V+2
j  java.awt.EventQueue.dispatchEventImpl(Ljava/awt/AWTEvent;Ljava/lang/Object;)V+41
j  java.awt.EventQueue.access$400(Ljava/awt/EventQueue;Ljava/awt/AWTEvent;Ljava/lang/Object;)V+3
j  java.awt.EventQueue$2.run()Ljava/lang/Void;+12
j  java.awt.EventQueue$2.run()Ljava/lang/Object;+1
v  ~StubRoutines::call_stub
J  java.security.AccessController.doPrivileged(Ljava/security/PrivilegedAction;Ljava/security/AccessControlContext;)Ljava/lang/Object;
J  java.security.AccessControlContext$1.doIntersectionPrivilege(Ljava/security/PrivilegedAction;Ljava/security/AccessControlContext;Ljava/security/AccessControlContext;)Ljava/lang/Object;
j  java.security.AccessControlContext$1.doIntersectionPrivilege(Ljava/security/PrivilegedAction;Ljava/security/AccessControlContext;)Ljava/lang/Object;+6
j  java.awt.EventQueue$3.run()Ljava/lang/Void;+11
j  java.awt.EventQueue$3.run()Ljava/lang/Object;+1
v  ~StubRoutines::call_stub
J  java.security.AccessController.doPrivileged(Ljava/security/PrivilegedAction;Ljava/security/AccessControlContext;)Ljava/lang/Object;
J  java.security.AccessControlContext$1.doIntersectionPrivilege(Ljava/security/PrivilegedAction;Ljava/security/AccessControlContext;Ljava/security/AccessControlContext;)Ljava/lang/Object;
j  java.awt.EventQueue.dispatchEvent(Ljava/awt/AWTEvent;)V+73
J  java.awt.EventDispatchThread.pumpOneEventForFilters(I)Z
j  java.awt.EventDispatchThread.pumpEventsForFilter(ILjava/awt/Conditional;Ljava/awt/EventFilter;)V+30
j  java.awt.EventDispatchThread.pumpEventsForHierarchy(ILjava/awt/Conditional;Ljava/awt/Component;)V+11
j  java.awt.EventDispatchThread.pumpEvents(ILjava/awt/Conditional;)V+4
j  java.awt.EventDispatchThread.pumpEvents(Ljava/awt/Conditional;)V+3
j  java.awt.EventDispatchThread.run()V+9
v  ~StubRoutines::call_stub

---------------  P R O C E S S  ---------------

Java Threads: ( => current thread )
  0x003b6c00 JavaThread "DestroyJavaVM" [_thread_blocked, id=2816, stack(0x008c0000,0x00910000)]
  0x02faf000 JavaThread "Thread-6" [_thread_blocked, id=1792, stack(0x04980000,0x049d0000)]
  0x02fd8400 JavaThread "Image Fetcher 0" daemon [_thread_blocked, id=1676, stack(0x03ef0000,0x03f40000)]
  0x02f75800 JavaThread "Thread-4" [_thread_blocked, id=3844, stack(0x03ea0000,0x03ef0000)]
  0x02eb7400 JavaThread "Thread-3" [_thread_blocked, id=1400, stack(0x03a60000,0x03ab0000)]
  0x02f3e400 JavaThread "TimerQueue" daemon [_thread_blocked, id=2528, stack(0x037c0000,0x03810000)]
=>0x02ec8800 JavaThread "AWT-EventQueue-0" [_thread_in_native, id=660, stack(0x03280000,0x032d0000)]
  0x02b7bc00 JavaThread "AWT-Windows" daemon [_thread_in_native, id=2824, stack(0x031a0000,0x031f0000)]
  0x02b7a800 JavaThread "AWT-Shutdown" [_thread_blocked, id=1516, stack(0x03150000,0x031a0000)]
  0x02b79800 JavaThread "Java2D Disposer" daemon [_thread_blocked, id=296, stack(0x03100000,0x03150000)]
  0x02b61c00 JavaThread "Low Memory Detector" daemon [_thread_blocked, id=3988, stack(0x02dd0000,0x02e20000)]
  0x02b53000 JavaThread "C1 CompilerThread0" daemon [_thread_blocked, id=1960, stack(0x02d80000,0x02dd0000)]
  0x02b51800 JavaThread "Attach Listener" daemon [_thread_blocked, id=2148, stack(0x02d30000,0x02d80000)]
  0x02b50400 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=3644, stack(0x02ce0000,0x02d30000)]
  0x02b4b800 JavaThread "Finalizer" daemon [_thread_blocked, id=1120, stack(0x02c90000,0x02ce0000)]
  0x02b46c00 JavaThread "Reference Handler" daemon [_thread_blocked, id=2820, stack(0x02c40000,0x02c90000)]

Other Threads:
  0x02b0a800 VMThread [stack: 0x02bf0000,0x02c40000] [id=2400]
  0x02b63c00 WatcherThread [stack: 0x02e20000,0x02e70000] [id=1396]

VM state:not at safepoint (normal execution)

VM Mutex/Monitor currently owned by a thread: None

Heap
 def new generation   total 5888K, used 69K [0x22990000, 0x22ff0000, 0x27ee0000)
  eden space 5248K,   1% used [0x22990000, 0x229a16e0, 0x22eb0000)
  from space 640K,   0% used [0x22eb0000, 0x22eb0000, 0x22f50000)
  to   space 640K,   0% used [0x22f50000, 0x22f50000, 0x22ff0000)
 tenured generation   total 12992K, used 7794K [0x27ee0000, 0x28b90000, 0x32990000)
   the space 12992K,  59% used [0x27ee0000, 0x2867cad8, 0x2867cc00, 0x28b90000)
 compacting perm gen  total 12288K, used 2179K [0x32990000, 0x33590000, 0x36990000)
   the space 12288K,  17% used [0x32990000, 0x32bb0ee0, 0x32bb1000, 0x33590000)
    ro space 10240K,  51% used [0x36990000, 0x36ec0500, 0x36ec0600, 0x37390000)
    rw space 12288K,  55% used [0x37390000, 0x37a2bd40, 0x37a2be00, 0x37f90000)

Code Cache  [0x00910000, 0x00a20000, 0x02910000)
 total_blobs=649 nmethods=432 adapters=153 free_code_cache=32450688 largest_free_block=320

Dynamic libraries:
0x00400000 - 0x00425000     C:\Programme\Java\jre6\bin\javaw.exe
0x7c910000 - 0x7c9c9000     C:\WINDOWS\system32\ntdll.dll
0x7c800000 - 0x7c908000     C:\WINDOWS\system32\kernel32.dll
0x77da0000 - 0x77e4a000     C:\WINDOWS\system32\ADVAPI32.dll
0x77e50000 - 0x77ee3000     C:\WINDOWS\system32\RPCRT4.dll
0x77fc0000 - 0x77fd1000     C:\WINDOWS\system32\Secur32.dll
0x7e360000 - 0x7e3f1000     C:\WINDOWS\system32\USER32.dll
0x77ef0000 - 0x77f39000     C:\WINDOWS\system32\GDI32.dll
0x76330000 - 0x7634d000     C:\WINDOWS\system32\IMM32.DLL
0x62e10000 - 0x62e19000     C:\WINDOWS\system32\LPK.DLL
0x75790000 - 0x757fb000     C:\WINDOWS\system32\USP10.dll
0x7c340000 - 0x7c396000     C:\Programme\Java\jre6\bin\msvcr71.dll
0x6d7f0000 - 0x6daa0000     C:\Programme\Java\jre6\bin\client\jvm.dll
0x76af0000 - 0x76b1e000     C:\WINDOWS\system32\WINMM.dll
0x6d7a0000 - 0x6d7ac000     C:\Programme\Java\jre6\bin\verify.dll
0x6d320000 - 0x6d33f000     C:\Programme\Java\jre6\bin\java.dll
0x6d7e0000 - 0x6d7ef000     C:\Programme\Java\jre6\bin\zip.dll
0x6d000000 - 0x6d14c000     C:\Programme\Java\jre6\bin\awt.dll
0x72f70000 - 0x72f96000     C:\WINDOWS\system32\WINSPOOL.DRV
0x77be0000 - 0x77c38000     C:\WINDOWS\system32\msvcrt.dll
0x774b0000 - 0x775ee000     C:\WINDOWS\system32\ole32.dll
0x773a0000 - 0x774a3000     C:\WINDOWS\WinSxS\x86_Microsoft.Windows.Common-Controls_6595b64144ccf1df_6.0.2600.6028_x-ww_61e65202\COMCTL32.dll
0x77f40000 - 0x77fb6000     C:\WINDOWS\system32\SHLWAPI.dll
0x5b0f0000 - 0x5b128000     C:\WINDOWS\system32\uxtheme.dll
0x746a0000 - 0x746ec000     C:\WINDOWS\system32\MSCTF.dll
0x75250000 - 0x7527e000     C:\WINDOWS\system32\msctfime.ime
0x7e670000 - 0x7ee91000     C:\WINDOWS\system32\shell32.dll
0x6d230000 - 0x6d27f000     C:\Programme\Java\jre6\bin\fontmanager.dll
0x10000000 - 0x10013000     C:\WINDOWS\system32\btmmhook.dll
0x6d600000 - 0x6d613000     C:\Programme\Java\jre6\bin\net.dll
0x71a10000 - 0x71a27000     C:\WINDOWS\system32\WS2_32.dll
0x71a00000 - 0x71a08000     C:\WINDOWS\system32\WS2HELP.dll
0x6d620000 - 0x6d629000     C:\Programme\Java\jre6\bin\nio.dll
0x03520000 - 0x0352f000     C:\Programme\Java\jre6\bin\ownWinSys.dll
0x035b0000 - 0x035bc000     C:\Programme\WIDCOMM\Bluetooth Software\btkeyind.dll
0x03230000 - 0x03246000     C:\Programme\Java\jre6\bin\javaxcomm.dll
0x03f40000 - 0x03f4e000     C:\Code\Java\Programme\FinalTest\MaxonMotor.dll
0x03f50000 - 0x042db000     C:\Code\Java\Programme\FinalTest\EposCmd.dll
0x76320000 - 0x76325000     C:\WINDOWS\system32\MSIMG32.dll
0x76350000 - 0x7639a000     C:\WINDOWS\system32\COMDLG32.dll
0x770f0000 - 0x7717b000     C:\WINDOWS\system32\OLEAUT32.dll
0x61880000 - 0x618ba000     C:\WINDOWS\system32\OLEACC.dll
0x4eba0000 - 0x4ed4b000     C:\WINDOWS\WinSxS\x86_Microsoft.Windows.GdiPlus_6595b64144ccf1df_1.0.6002.22791_x-ww_c8dff154\gdiplus.dll
0x77bd0000 - 0x77bd8000     C:\WINDOWS\system32\VERSION.dll
0x6d440000 - 0x6d465000     C:\Programme\Java\jre6\bin\jpeg.dll
0x04730000 - 0x04762000     C:\WINDOWS\system32\ftd2xx.dll
0x778f0000 - 0x779e4000     C:\WINDOWS\system32\SETUPAPI.dll
0x76bf0000 - 0x76c1e000     C:\WINDOWS\system32\WINTRUST.dll
0x77a50000 - 0x77ae6000     C:\WINDOWS\system32\CRYPT32.dll
0x77af0000 - 0x77b02000     C:\WINDOWS\system32\MSASN1.dll
0x76c50000 - 0x76c78000     C:\WINDOWS\system32\IMAGEHLP.dll
0x6d1a0000 - 0x6d1c3000     C:\Programme\Java\jre6\bin\dcpr.dll
0x76bb0000 - 0x76bbb000     C:\WINDOWS\system32\PSAPI.DLL

VM Arguments:
jvm_args: -Djava.library.path=C:\Code\Java\Programme\FinalTest;C:\Code\Java\Programme\FinalTest -Dfile.encoding=Cp1252 
java_command: finaltest.FrameGWF
Launcher Type: SUN_STANDARD

Environment Variables:
PATH=C:/Programme/Java/jre6/bin/client;C:/Programme/Java/jre6/bin;C:/Programme/Java/jre6/lib/i386;C:\jet7.6-pro\bin;C:\Programme\ExcelsiorJET\bin;C:\Programme\WinAVR-20080610\bin;C:\Programme\WinAVR-20080610\utils\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\Programme\Intel\DMIX;C:\Programme\Gemeinsame Dateien\Roxio Shared\DLLShared;c:\Programme\Microsoft SQL Server\100\Tools\Binn\;c:\Programme\Microsoft SQL Server\100\DTS\Binn\;
USERNAME=Peloso
OS=Windows_NT
PROCESSOR_IDENTIFIER=x86 Family 6 Model 15 Stepping 2, GenuineIntel

---------------  S Y S T E M  ---------------

OS: Windows XP Build 2600 Service Pack 3

CPU:total 2 (2 cores per cpu, 1 threads per core) family 6 model 15 stepping 2, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3

Memory: 4k page, physical 2079984k(1194376k free), swap 4022172k(3230168k free)

vm_info: Java HotSpot(TM) Client VM (20.12-b01) for windows-x86 JRE (1.6.0_37-b06), built on Sep 24 2012 12:44:35 by "java_re" with MS VC++ 7.1 (VS2003)

time: Thu Oct 25 14:59:01 2012
elapsed time: 14 seconds 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:23:25.803

这是不可能压制的，不。真的没有一个很好的方法来干净地处理它，因为它发生在你的代码之外。它可能是各种各样的事情，例如过时的驱动程序文件、硬件不兼容等。

不过，堆栈跟踪中有一些见解。堆栈的顶部说

```
Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)
j  finaltest.MaxonMotorCmd.closeAllDevices()Z+0
j  finaltest.MaxonMotor.close()Z+8 
```

所以看起来该`closeAllDevices`方法正在导致这种情况发生。您应该通过该方法并确保正确停止设备并正常关闭它。

请注意，这也发生在事件分派线程上（如线程列表中的 => 所示 `=>0x02ec8800 JavaThread "AWT-EventQueue-0" [_thread_in_native, id=660, stack(0x03280000,0x032d0000)]`）。通常，您不想从 EDT 进行任何繁重的工作（例如关闭电机）。

# javascript - 无法将值传递给函数

> ID：13070188
> 
> 赞同：0
> 
> 时间：2012-10-25T13:55:03.930
> 
> 标签：javascript

我有一个函数 draw_integer(n,s,x,y,plotx) ，它在坐标 (x,y) 中大小为 s 的 HTML5 画布上绘制一个整数 ,n，我在另一个函数 draw_num() 中调用这个函数接下来，
（plot0、number 和 size 是画布的相应 id、number 和 size 输入字段，函数 drawum() 由 onclick 事件触发。）

```
function drawnum() {
    var n = document.getElementById('number').value;
    var s = document.getElementById('size').value;
    console.debug(n,s);
    draw_integer(n,s,100,100,plot0);   // this  doesn't get executed
    }   

function draw_integer(n,s,x,y,plotx){ //lots of code } 
```

在drawum下调用的draw_integer函数没有被执行，我无法识别的问题是什么。

使用 console.debug() 返回用户输入的适当的数字和大小值，如果我使用 draw_integer(3,100,100,100,plot0) （大小为 100 的绘图号 3）而不是 draw_integer(n,s,100,100,plot0) 它作品。

这意味着在将变量 n 和 s 从 drawum() 传递到 draw_integer() 时发生了一些错误。

认为这可能是由于变量的本地范围，我尝试了这个。

```
var n = document.getElementById('number').value;
var s = document.getElementById('size').value;

function drawnum() {
console.debug(n,s);
draw_integer(n,s,100,100,plot0);   // this  doesn't get executed
}   

function draw_integer(n,s,x,y,plotx){ //lots of code } 
```

但这也没有用。

你能帮我或建议一个更好的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:00:01.123

```
var n = document.getElementById('number').value;
var s = document.getElementById('size').value; 
```

变量`n`及`s`以上是字符串而不是数字。您需要使用 parseFloat 或 parseInt 来转换它。

```
var n = parseInt(document.getElementById('number').value, 10);
var s = parseInt(document.getElementById('size').value, 10); 
```

# html - 通过“查看源代码”显示的 HTML 是否与 (Firebug) 开发人员工具中显示的 HTML 不同？

> ID：13070190
> 
> 赞同：26
> 
> 时间：2012-10-25T13:55:12.240
> 
> 标签：html, browser, rendering, firebug

我正在使用 Firefox 和 Firebug 开发工具。

查看源代码 ( `Ctrl + U`) 中显示的 HTML 是否与我在使用 Firebug 检查元素时看到的 HTML 不同？

两者有什么区别？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-25T13:59:10.763

是的，它们是不同的。

查看源代码向您显示页面的原始 HTML 源代码。

检查器向您显示浏览器解释的 DOM。例如，这包括在 HTML 源代码中看不到的 javascript 所做的更改。

哦，这也适用于允许您在其他浏览器中查看 DOM 的开发人员工具，例如 Chrome Web Inspector 和 Internet Explorer 开发人员工具栏。HTML 源代码在所有浏览器中总是相同的，生成的 DOM 可能会有所不同，因为它是一种解释，并且渲染引擎并不完全相同（不幸的是）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T14:03:07.487

还应该注意的是，除了可能通过 javascript 等进行的动态 DOM 操作之外，Firefox 还将解析和“清理”格式错误的 (X)HTML，因此这些更改也会影响您在检查元素时看到的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T13:58:47.717

不同之处在于（但不限于）在 firebug 控制台中您可以看到动态变化，这些变化发生在网页中。例如，DOM 元素修改（来自`AJAX`或常规`JavaScript`）、`CSS`就地修改等......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-29T19:37:22.250

在 Firefox 中，查看源代码可能会重新加载页面，从而更改页面上的内容。如果它困扰您，请查看此错误并为它投票：

[https://bugzilla.mozilla.org/show_bug.cgi?id=307089](https://bugzilla.mozilla.org/show_bug.cgi?id=307089)

# javascript - 在 html 页面的头部而不是单独的文件中包含 css 的开销

> ID：13070191
> 
> 赞同：0
> 
> 时间：2012-10-25T13:55:17.543
> 
> 标签：javascript, html, css

更新：最后这已成为一个非问题。我们创建了代理，通过与 js 文件相同的域从 blob 提供主题 css 文件。

我正在开发一个主题切换器模块，它使用 document.stylesheets 对象来获取有关某些样式表中的 css 规则的信息。

该站点托管在 azure 上，css 文件存储在 blob 上。

由于缺乏对 blob 中跨域资源共享的支持，因此无法访问样式表。

一种解决方法是将整个 css 文件注入到 html 页面的 head 部分。

这会通过膨胀页面显着影响性能吗？

编辑：

正如他在下面的评论中提到的，当然有两个因素：第一个是外部 css 文件的缓存，这会导致更快的重新加载时间。第二个是http请求的数量-如果css在页面中，它会变少：尽管如果文件已经被缓存-无论如何都不会在重新加载时对它们发出请求。

我试图了解除了这些因素之外，是否通过在页眉部分添加大约 3-5 个样式标签，每个样式标签具有 100-300 个 css 规则，是否会导致页面上的脚本运行速度变慢，因为html字符串本身要长得多？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:00:15.140

如果它在页面中，则加载时间会**更长**，因为第二次加载时 css*尚未*在浏览器的缓存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:05:08.510

这取决于不同的因素。例如 - 你的 CSS 有多大，你的用户从哪里访问你的网站。如果您的目标受众是 - 移动用户，那么每增加一个 kb 数据都可能会显着影响性能并给您带来负面的用户体验。另一方面，每个外部样式表都是一个 http 请求，可能会更加影响性能。所以这取决于你的具体情况

# node.js - 使用 node.js 和 node-csv-parser（节点模块）提示 csv 文件下载为弹出窗口

> ID：13070194
> 
> 赞同：13
> 
> 时间：2012-10-25T13:55:24.967
> 
> 标签：node.js, csv, export, export-to-csv

最近我开始使用 node.js。在我的一个项目中完成要求时，我遇到了一个问题，我应该能够动态地将一些数据写入 csv 文件，并让它作为弹出窗口提示用户下载（带有保存和取消选项 - 就像我们通常一样看）。谷歌搜索了一段时间后，我决定使用 csv npm 模块[https://github.com/wdavidw/node-csv-parser](https://github.com/wdavidw/node-csv-parser)。我能够将数据写入文件并使用此模块保存。我想提示一个弹出窗口来保存这个文件，有/没有保存文件。

我的代码看起来像这样：

```
 // Sample Data 
    var data = [["id", "subject1", "subject2", "subject3"], ["jack", 85, 90, 68], ["sam", 77, 89, 69]]

    // Server Side Code    
    var csv = require('../../node_modules/csv');            
    var fs = require('fs');

    createCSV = function(data, callback) {
        csv().from(data).to(fs.createWriteStream('D:/test.csv')) // writing to a file           
    }

    // Client side call sample
    $("#exportToCSV").click(function() {
        callToServer.createCSV(data);
       return false;
    }); 
```

就编写 csv 文件而言，这很好用。

*   我想立即提示该文件为用户下载。
*   如果可以在不保存文件的情况下完成此操作，那就太好了。
*   如何像在 PHP 中那样设置内容类型和内容处置

任何帮助是极大的赞赏。-谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2015-11-06T19:29:40.037

Manish Kumar 的回答很到位 - 只是想包含一个**Express 4**语法变体来实现这一点：

```
function(req, res) {
  var csv = GET_CSV_DATA // Not including for example.

  res.setHeader('Content-disposition', 'attachment; filename=testing.csv');
  res.set('Content-Type', 'text/csv');
  res.status(200).send(csv);

} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-08T07:44:51.387

我做了这样的事情：

```
http.createServer(function(request, response) {
    response.setHeader('Content-disposition', 'attachment; filename=testing.csv');
    response.writeHead(200, {
        'Content-Type': 'text/csv'
    });

    csv().from(data).to(response)

})
.listen(3000); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-06-16T11:38:55.977

**以下解决方案适用于 Express**

express是进化的，不用设置附件和内容类型header，直接使用附件api [http://expressjs.com/4x/api.html#res.attachment](http://expressjs.com/4x/api.html#res.attachment)

注意：附件（）不传输文件，它只是在标题中设置文件名。

```
response.attachment('testing.csv');
csv().from(data).to(response); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-02-09T01:05:48.073

Express-csv 是一个很棒的模块，用于将 csv 内容写入来自 node.js 服务器的流，它将作为响应发送给客户端（并作为文件下载）。非常容易使用。

```
app.get('/', function(req, res) {
  res.csv([
    ["a", "b", "c"]
  , ["d", "e", "f"]
  ]);
}); 
```

文档：[https ://www.npmjs.com/package/express-csv](https://www.npmjs.com/package/express-csv)

当您传递一个对象时，您需要明确地预先添加标题（如果您想要它们）。这是我使用[npm mysql的示例](https://www.npmjs.com/package/mysql)

```
router.route('/api/report')
    .get(function(req, res) {
            query = connection.query('select * from table where table_id=1;', function(err, rows, fields) {
                if (err) {
                    res.send(err);
                }
                var headers = {};
                for (key in rows[0]) {
                    headers[key] = key;
                }
                rows.unshift(headers);
                res.csv(rows);
            });
    }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T18:29:43.897

查看这个答案：[Nodejs 发送文件作为响应](https://stackoverflow.com/questions/10046039/nodejs-send-file-in-response)

基本上，您不必将文件保存到硬盘驱动器。相反，请尝试将其直接发送到`response`. 如果你使用 Express 之类的东西，它看起来像这样：

```
var csv = require('csv');
req.get('/getCsv', function (req, res) {
    csv().from(req.body).to(res);
}); 
```

# sql - 选择每年利润最高的 SQL

> ID：13070201
> 
> 赞同：-1
> 
> 时间：2012-10-25T13:55:37.893
> 
> 标签：sql, select, sqlplus

如何获得表中每年的最高值。所以假设我们有一张桌子`movies`，我想找到每年利润最高的电影。

这是我迄今为止的尝试：

```
SELECT year, MAX(income - cost) AS profit, title
FROM Movies m, Movies m2
GROUP BY year 
```

我很确定它需要一些子选择，但我无法想象我需要做什么。`distinct`我也在考虑可能排除重复年份的某种选择。

```
Title  Year   Income  Cost  Length
A      2000   10      2     2
B      2000   9       7     2 
```

因此，由此预期的结果将是

```
Title  Year   Profit
A      2000   8 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:08:27.807

我稍微猜测您想要什么，但由于您没有指定任何 RDBMS，通用解决方案将是：

```
SELECT  m.Year, (m.Income - m.Cost) AS Profit, m.Title
FROM    Movies m
        INNER JOIN
        (   SELECT  m.Year, MAX(m.Income - m.Cost) AS Profit
            FROM    Movies
            GROUP BY m.Year
        ) MaxProfit
            ON MaxProfit.Year = m.Year
            AND MaxProfit.Profit = (m.Income - m.Cost)
ORDER BY m.Year 
```

如果您的 DBMS 允许，您也可以使用分析函数来执行此操作。例如 SQL 服务器

```
WITH MovieCTE AS
(   SELECT  m.Year,
            Profit = (m.Income - m.Cost), 
            m.Title,
            RowNumber = ROW_NUMBER() OVER(PARTITION BY m.Year ORDER BY (m.Income - m.Cost) DESC)
    FROM    Movies
)
SELECT  year, Profit, Title
FROM    MovieCTE
WHERE   RowNumber = 1 
```

我可能误解了您的确切标准，但我确信可以应用相同的原则，您只需要更改第一个示例或`partition by`第二个示例中的分组和连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:08:56.190

```
select m1year,m1profit,title 
from 
(
  (select year as m1year, max(income- cost) as m1profit from movies group by year) m1
   join
  (select m2year, (income-cost) as m2profit ,title as profit from movies) m2
   on 
   m1profit = m2profit
) m 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:09:25.557

这将给出每年利润最高的电影，并在出现平局时选择第一个标题：

```
 select a.year, a.profit,
    (select min(title) from Movies where year = a.year and income - cost = a.profit) as title
 from ( 
     select year, max(income - cost) as profit
     from Movies -- title, year, cost, income, number
     group by year
) as a
order by year desc 
```

# sql-server - MS-Access 链接表的并发错误

> ID：13070202
> 
> 赞同：2
> 
> 时间：2012-10-25T13:55:38.180
> 
> 标签：sql-server, ms-access, sql-server-2008-r2, linked-tables

我通过 MS Access Linked Tables 将表链接到 SQL 2008R2 DB。

当我想更改底层 SQL 表中包含多个位字段的 Access 链接表中的数据时，我收到此警告：

> 自您开始编辑该记录以来，该记录已被其他用户更改。如果您保存记录，您将覆盖其他用户所做的更改

当表中只有一个位字段时，我没有任何问题。恕我直言，这真是一个奇怪的错误。有没有其他人遇到过这种情况并偶然找到了解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:23:40.310

在使用 SQL 处理链接表时，我已经看到了这种问题。我不确定为什么您会特别看到位字段的问题。尝试将数据类型为时间戳 (rowversion) 的“ts”列添加到表中，然后在 Access 中重新链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-18T18:34:16.397

我知道这是一个老问题，但也许我的回答会让其他人受益，因为我在同样和其他类似的问题上苦苦挣扎。

我有类似的错误，并且大部分都能够解决它。可能有帮助的一件事是在数据库上使用 SQL Profiler，并在您尝试添加新行时观察 Access 发出的 SQL 命令。

几件事要检查.. 1) 验证您在表中设置了一个 ID 列作为主键和自动编号 2) 如果这涉及另一个表之间的主/子关系，在 Access 数据库工具“关系”中，指定这些类型之间的关系和连接类型。3）如果表之间存在连接，则在查询中公开主列和外部列。

使用 SQL Profiler，我会看到它会在哪里尝试根据除主键之外的其他列来查找要更新的行。例如

更新表集 ... 其中 id = 5 和 data1 = somevalue 和 data2 == othervalue

这样做时，我有时会遇到同样的错误，因为我可能在新行中编辑了其他值，因此复杂的 where 子句会失败。您想要的是让更新完全依赖于主键。

# c++ - 动态绑定几个

> ID：13070204
> 
> 赞同：0
> 
> 时间：2012-10-25T13:55:44.117
> 
> 标签：c++, dynamic-binding

嗨专家我可以像这样进行动态绑定吗？objshapes 是名为 Shape 的父类，而 Rectangle 是子类。我有几个子类，所以根据用户选择的形状，我需要将正确的形状绑定到 objShapes。所以我想我可以像这样绑定。但我得到一个错误。

```
 Shape *objShapes[3];    
 objshapes[size]= &new Rectangle(3,lvaule,5)  

 //error: lvalue required as unary ‘&amp;’ operand 
```

希望有人可以提供帮助。谢谢

这个对吗

```
 objshapes[size]= new Rectangle(3,lvaule,5) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:02:10.047

您需要指向基类的指针数组或容器，或者最好是[智能指针。](http://en.wikipedia.org/wiki/Smart_pointer)例如：

```
std::vector<Shape*> objshapes;
objshapes.push_back(new Rectangle(3,lvaule,5));
objshapes.push_back(new Circle( args)); 
```

如果您使用原始指针而不是智能指针，则必须确保通过调用`delete`所有指针来取消分配形状使用的内存。

*编辑*，因为您不愿意使用标准库容器，并且您已经澄清您有一个 数组`Shape*`，而不是一个 数组`Shape`，那么您可以这样填充数组：

```
objshapes[idx]= new Rectangle(3,lvaule,5); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:54:16.123

> > ```
> > Shape *objShapes[3]; 
> > ```

这将 objshapes 声明为 3 个指向形状的指针的数组。

> > ```
> > objshapes[size]= &new Rectangle(3,lvaule,5) 
> > ```

这是没有意义的。

> > 这个对吗
> > 
> > ```
> > objshapes[size]= new Rectangle(3,lvaule,5) 
> > ```

是的¹，这是正确的。`new`返回一个指向矩形的指针，它可以存储在指针形状类型的变量中。由于`objshapes`是一个指向形状的指针数组。`objshapes[size]`是指向形状的指针——它可以接受指向矩形的指针。

^(1\. 假设`size`可转换为整数类型，且值为`0`、`1`或`2`。)

# android - Android Phonegap 和 Fragments

> ID：13070205
> 
> 赞同：4
> 
> 时间：2012-10-25T13:55:44.213
> 
> 标签：android, android-layout, cordova, android-fragments

我试图在我的片段中实现一个 Phonegap CordovaWebView，但它不起作用。

我的布局如下所示（cordovawebview.xml）：

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
         android:layout_width="fill_parent"
         android:layout_height="fill_parent">

<org.apache.cordova.CordovaWebView
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id = "@+id/mainView"/>

</FrameLayout> 
```

在我的片段中`onCreateView()`，我尝试扩大布局：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {

    View v = inflater.inflate(R.layout.cordovawebview, container); // <--- the error occurs here!
    // CordovaWebView webView = (CordovaWebView)v.findViewById(R.id.mainView);

    return v;
} 
```

也许有人有一些提示如何解决它。我总是得到那个错误：

```
10-25 15:52:02.839: ERROR/AndroidRuntime(2878): FATAL EXCEPTION: main
    android.view.InflateException: Binary XML file line #21: Error inflating class org.apache.cordova.CordovaWebView
    at android.view.LayoutInflater.createView(LayoutInflater.java:613)
    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:687)
    at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
    at com.advantageframework.tabs.fragments.SampleFragmentA.onCreateView(SampleFragmentA.java:81)
    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:871)
    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1083)
    at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:635)
    at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1431)
    at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:420)
    at android.os.Handler.handleCallback(Handler.java:615)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4745)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
    at dalvik.system.NativeStart.main(Native Method)
    Caused by: java.lang.reflect.InvocationTargetException
    at java.lang.reflect.Constructor.constructNative(Native Method)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
    at android.view.LayoutInflater.createView(LayoutInflater.java:587)
    ... 19 more
    Caused by: java.lang.NullPointerException
    at org.apache.cordova.CordovaWebView.loadConfiguration(CordovaWebView.java:643)
    at org.apache.cordova.CordovaWebView.<init>(CordovaWebView.java:131)
    ... 22 more 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-02T00:03:28.260

我找到了答案。如果您查看您看到的 logcat，它会尝试将 Context 转换为 CordovaInterface。上下文是活动。那里失败了。您可能将 Fragment 设置为 CordovaInterface。这就是我所做的。您必须使 Activity 成为 CordovaInterface 并从 Activity 将事件（onMessage，...）转发到 Fragment。

这是我的活动（删除了一些内容以使其更简单）。我有一些非常接近这个的东西，效果很好。之后您仍然会遇到一些较小的问题，但这些问题很容易解决。

```
public class MyCordovaActivity extends SherlockFragmentActivity implements
        CordovaInterface {
    private final ExecutorService mThreadPool = Executors.newCachedThreadPool();
    private CordovaPlugin mActivityResultCallback;

    private CordovaFragment mFragment;

    @Override
    protected void onCreate(final Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.nbu_web_activity);
        mFragment = new CordovaFragment();
        getSupportFragmentManager().beginTransaction()
                .add(R.id.fragment, mFragment)
                .commit();

        // TODO this value you could pass to the activity with a intent extra
        // or allow to do this through a seperate function, ...
        String url = "http://....";
        mFragment.loadUrl(url);
    }

    @Override
    protected void onNewIntent(final Intent intent) {
        super.onNewIntent(intent);
        NBUGapFragment fragment = getCordovaFragment();
        if (fragment != null && fragment.appView != null) {
            fragment.appView.onNewIntent(intent);
        }
    }

    @Override
    public void onBackPressed() {
        NBUGapFragment fragment = getCordovaFragment();
        if (fragment == null || !fragment.onBackPressed()) {
            super.onBackPressed();
        }
    }

    @Override
    public void cancelLoadUrl() {
        getCordovaFragment().cancelLoadUrl();
    }

    @Override
    public Activity getActivity() {
        return this;
    }

    @Override
    public Context getContext() {
        return this;
    }

    @Override
    public ExecutorService getThreadPool() {
        return mThreadPool;
    }

    @Override
    public Object onMessage(final String id, final Object data) {
        return getCordovaFragment().onMessage(id, data);
    }

    @Override
    public void setActivityResultCallback(final CordovaPlugin plugin) {
        mActivityResultCallback = plugin;
    }

    @Override
    public void startActivityForResult(final CordovaPlugin plugin, final Intent intent,
            final int requestCode) {
        mActivityResultCallback = plugin;
        startActivityForResult(intent, requestCode);
    }

    @Override
    protected void onActivityResult(final int requestCode, final int resultCode, final Intent intent) {
        if (mActivityResultCallback != null) {
            mActivityResultCallback.onActivityResult(requestCode, resultCode, intent);
        } else {
            super.onActivityResult(requestCode, resultCode, intent);
        }
    }

    private CordovaFragment getCordovaFragment() {
        // the CordovaFragment is the one implementing CordovaInterface
        return mFragment;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-10T10:10:41.150

CordovaWebView 假定 Inflater 的上下文（在本例中为主 Activity）实现了 CordovaInterface。没有接口通过inflater传递单独的对象（上下文和CordovaInterface对象），您应该创建代理上下文，其中包含两个对象和对每个对象的委托方法调用；

```
private class CordovaContext extends ContextWrapper implements CordovaInterface
{
    CordovaInterface ci;

    // Hold two objects. Method call to Context will be proxied by ContextWrapper, so only delegate CordovaInterface.
    // You should add/modify when method in CordovaInterface changed
    public CordovaContext(Context base, CordovaInterface ci) {
        super(base);
        this.ci = ci;
    }
    public void startActivityForResult(CordovaPlugin command,
            Intent intent, int requestCode) {
        ci.startActivityForResult(command, intent, requestCode);
    }
    public void setActivityResultCallback(CordovaPlugin plugin) {
        ci.setActivityResultCallback(plugin);
    }
    public Activity getActivity() {
        return ci.getActivity();
    }
    public Object onMessage(String id, Object data) {
        return ci.onMessage(id, data);
    }
    public ExecutorService getThreadPool() {
        return ci.getThreadPool();
    }

} 
```

在 Fragment 中，创建使用此 Context 对象的充气机；

```
LayoutInflater localInflater = inflater.cloneInContext(new CordovaContext(getActivity(), this));
View v = localInflater.inflate(R.layout.cordovawebview, container, false); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T15:15:55.843

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {

    View v = inflater.inflate(R.layout.cordovawebview, container, false); // <--- add false parameter
    CordovaWebView webView = (CordovaWebView)v.findViewById(R.id.mainView);

    return v;
} 
```

# c# - 在文本树中表示一个自引用表

> ID：13070206
> 
> 赞同：3
> 
> 时间：2012-10-25T13:55:51.523
> 
> 标签：c#, algorithm, tree, self-referencing-table

我想在文本树中表示一个自引用表（如 TreeView，但在文本中）。我一直在努力，到目前为止我做得很好。问题是当我在树中深入几层时。到目前为止结果是这样的：

```
┌──Main Group 1
│  ├──SubGroup 1.1
│  │  ├──SubGroup 1.1.1
│  │  ├──SubGroup 1.1.2
│  │  ├──SubGroup 1.1.3
│  │  └──SubGroup 1.1.4
│  │     ├──SubGroup 1.1.4.1
│  │     └──SubGroup 1.1.4.2
│  │  │     ├──Problem group 1
│  │  │     ├──Problem group 2
│  │  │     └──Problem group 3
│  │  │  │     └──Problem group 3.1
│  ├──SubGroup 1.2
│  └──SubGroup 1.3
│     ├──SubGroup 1.3.1
│     └──SubGroup 1.3.2
└──Main Group 2
   ├──SubGroup 2.1
   └──SubGroup 2.2 
```

正如您在`Problem Groups`上面看到的，格式开始中断并显示额外的行。

我写的代码是：

```
public class Group
    {
        public int ID { get; set; }
        public int? ParentID { get; set; }
        public string Name { get; set; }
    }

    static void Main(string[] args)
    {
        List<Group> groups = new List<Group>();
        groups.Add(new Group { ID = 1, ParentID = null, Name = "Main Group 1" });
        groups.Add(new Group { ID = 2, ParentID = 1, Name = "SubGroup 1.1" });
        groups.Add(new Group { ID = 3, ParentID = 1, Name = "SubGroup 1.2" });
        groups.Add(new Group { ID = 4, ParentID = 1, Name = "SubGroup 1.3" });
        groups.Add(new Group { ID = 5, ParentID = null, Name = "Main Group 2" });
        groups.Add(new Group { ID = 6, ParentID = 5, Name = "SubGroup 2.1" });
        groups.Add(new Group { ID = 7, ParentID = 5, Name = "SubGroup 2.2" });
        groups.Add(new Group { ID = 8, ParentID = 2, Name = "SubGroup 1.1.1" });
        groups.Add(new Group { ID = 9, ParentID = 2, Name = "SubGroup 1.1.2" });
        groups.Add(new Group { ID = 10, ParentID = 2, Name = "SubGroup 1.1.3" });
        groups.Add(new Group { ID = 11, ParentID = 2, Name = "SubGroup 1.1.4" });
        groups.Add(new Group { ID = 12, ParentID = 11, Name = "SubGroup 1.1.4.1" });
        groups.Add(new Group { ID = 13, ParentID = 11, Name = "SubGroup 1.1.4.2" });
        groups.Add(new Group { ID = 14, ParentID = 13, Name = "Problem group 1" });
        groups.Add(new Group { ID = 15, ParentID = 13, Name = "Problem group 2" });
        groups.Add(new Group { ID = 16, ParentID = 13, Name = "Problem group 3" });
        groups.Add(new Group { ID = 17, ParentID = 16, Name = "Problem group 3.1" });
        groups.Add(new Group { ID = 18, ParentID = 4, Name = "SubGroup 1.3.1" });
        groups.Add(new Group { ID = 19, ParentID = 4, Name = "SubGroup 1.3.2" });

        PrintGroupsTree(groups);
        Console.Read();
    }

    static void PrintGroupsTree(List<Group> groups)
    {
        if (groups == null)
            return;

        var rootGroups = groups.Where(grp => grp.ParentID == null);

        foreach (var g in rootGroups)
            PrintRow(0, g, groups);
    }

    private static void PrintRow(int p, Group grp, List<Group> groups)
    {
        string leader = string.Empty;
        string leaderEnd = string.Empty;

        // get the root items
        var rootItems = groups.Where(g => g.ParentID == null);

        // find the leading character
        if (grp == rootItems.First())
        {
            if (rootItems.Count() == 1)
                leader = "─";
            else
                leader = "┌";
        }
        else if (grp == rootItems.Last())
        {
            leader = "└";
        }
        else
        {
            if (p == 0)
                leader = "├";
            else
                if (rootItems.Count() == 1)
                    leader += " ";
                else
                    leader = "│";
        }

        if (grp.ParentID == rootItems.Last().ID)
            leader = " ";

        // if this is a child node
        if (!rootItems.Contains(grp))
        {
            // get the siblings of the current node (same parentID)
            var itemSiblings = groups.Where(g => g.ParentID == grp.ParentID);
            if (grp == itemSiblings.Last())
                leaderEnd = " └";
            else
                leaderEnd = " ├";
        }

        // get the siblings of the parent item (same as parentItem.ParentID)
        var parentItem = groups.Where(g => g.ID == grp.ParentID).SingleOrDefault();
        var parentItemSiblings = groups.Where(g => g.ParentID == parentItem.ParentID);
        if (p > 0)
        {
            leader += " ";
            for (int i = 1; i <= p - 1; i++)
            {
                if (!rootItems.Contains(grp)
                    && parentItem == parentItemSiblings.Last()
                    && i == p - 1)
                    leader += "   ";

                else
                    leader += " │ ";
            }
        }

        // write the group
        string row = leader + leaderEnd + "──" + grp.Name;
        Console.WriteLine(row);

        // recursive calling to the childs of this item
        var childGroups = groups.Where(g => g.ParentID == grp.ID);
        foreach (var g in childGroups)
        {
            PrintRow(p + 1, g, groups);
        }
    } 
```

有没有办法使用更好看的代码正确地表示这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:54:07.253

这是一个需要递归的问题，您没有充分利用它。

```
 static void Main(string[] args)
    {     
        List<Group> groups = new List<Group>();               
        ...
        PrintTree(groups, "", null);
    }

    static void PrintTree(List<Group> allGroups, string lead, int? id)
    {
        var children = allGroups.Where(g => g.ParentID == id).ToList();

        if (children.Count > 0)
        {
            int n = children.Count-1;

            for (int i = 0; i < n; i++)
            {
                Console.WriteLine(lead + "├──" + children[i].Name);
                PrintTree(allGroups, lead + "│  ", children[i].ID);                    
            }

            Console.WriteLine(lead + "└──" + children[n].Name);
            PrintTree(allGroups, lead + "   ", children[n].ID);                    
        }
    } 
```

我将修复第一个元素作为练习。

# java - Spring MVC 2.5 servlet/portlet 兼容 URL

> ID：13070208
> 
> 赞同：0
> 
> 时间：2012-10-25T13:55:53.817
> 
> 标签：java, spring-mvc, portlet, jsr168

我正在使用 Spring MVC 编写一个应用程序，它必须作为*servlet*和*portlet*运行。这在 Spring 3 (JSR-286) 中很容易做到，但我必须使用 portlet 1.0 规范 (JSR-168)。为了与之兼容，我将 Spring MVC 降级为 2.5（[更多信息在这里](https://stackoverflow.com/questions/2063989/spring-3-0-and-jsri68-support)）。

一切正常，但我无法生成与 servlet/portlet 兼容的 URL！

使用 Spring 3，我会写：

```
<spring:url value="/foo">
  <spring:param name="action" value="foo"/>
</spring> 
```

在 Spring 2.5 中没有`spring:url`标签。我尝试过，`c:url`但它只生成与 servlet 兼容的 URL（不是 portlet）。

如何实现 servlet/portlet 兼容的 URL 生成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T12:23:46.377

我不确定下面的解决方案，但也许它会有所帮助。

您可以将 portlet 标记用于与 portlet 兼容的 url：

```
<%@ taglib uri=”http://java.sun.com/portlet” prefix=”portlet” %>
...
<portlet:actionURL ... >
    <portlet:param name="action" value="foo">
</portlet:actionURL> 
```

（我建议您查看[Java Portlet 1.0 规范 (JSR-168)](http://jcp.org/aboutJava/communityprocess/final/jsr168/index.html) “Portlet Tag Library” 章节以了解有关此标记的详细信息）

然后，要生成 portlet 或 servlet url，您可以使用一个条件来检测您当前是否正在使用 Portlet 或 Servlet（我不知道是否可能）：

```
<c:choose>
    <c:when test="usingPortlet">
        <portlet:actionURL ... > ... </portlet:actionURL>
    </c:when>
    <c:otherwise>
        <c:url ... > ... </c:url>
    </c:otherwise> 
<c:choose> 
```

# powershell - 获取未在特定日期范围内写入的文件/文件夹

> ID：13070214
> 
> 赞同：1
> 
> 时间：2012-10-25T13:56:23.957
> 
> 标签：powershell, powershell-2.0

什么是 powershell 命令，用于在文件夹中查找不`Get-Childitem`符合`LastWriteTime`.

`LastWriteTime`因此，请检查目录中是否包含不包含2012 年 1 月 10 日（10 月 1 日）至 2012 年 10 月 25 日（10 月 25 日）之间的任何文件的文件。

我想显示没有该范围内的任何文件的文件夹......这样我就知道它们是旧的并且可以删除整个目录。

这方面的例子是：

Folder1 - 10 月内编写的一些文件 - 忽略整个文件夹并且不在结果中显示这些文件

Folder2 - `LastWriteTime`10 月份没有写入文件，因此应显示此文件夹和文件。

我知道这可以做到，`Get-ChildItem`我被困在下面的位子上。

```
Get-ChildItem E:\LogArchive -Recurse | Where-Object{$_.LastWriteTime.......? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:03:06.147

简单的解决方案是这样的：

```
Where-Object{ $_.LastWriteTime -lt $startDate -or $_.LastWriteTime -gt $endDate } 
```

在哪里和`$startDate`是。`01/10/2012 (1st Oct)``$endDate``25/10/2012 (25th Oct)`

这种方法的问题是它没有考虑`[datetime]`. 因此，在您的示例中，如果您有`25-Oct-2012`上限，它将返回`25-Oct-2012 9:00`您可能不想要的在 处创建的文件。

下面的代码根据`[datetime]`输入计算截断时间部分的 's `[datetime]`，并构建 的月至今日期范围`($dayStart, $dayEnd)`：

```
$entry_date = "20-Oct-2012 9:00" #to feed current date, use this: Get-Date
$dayEnd = Get-Date $entry_date -Minute 0 -Hour 0 -Second -0;
$dayStart = Get-Date $endDate -Day 1;
$dayStart, $dayEnd 
```

对于此示例代码，以下是输出：

```
Monday, October 01, 2012 12:00:00 AM 
Saturday, October 20, 2012 12:00:00 AM 
```

请注意，这种方法很灵活，因为您可以设置`$entry_date`为`Date`or `String`，并且它可能有也可能没有时间部分 - 它适用于所有这些情况。然后，您可以在以下代码中使用此代码`Where-Object`：

```
Where-Object{ $_.LastWriteTime -lt $dayStart -or $_.LastWriteTime -ge $dayEnd.AddDays(1) } 
```

请注意`-ge $dayEnd.AddDays(1)`与.`25-Oct-2012``25-Oct-2012 9:00`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:15:45.770

试试这个：

```
[datetime]$startDate = "10/01/2012" # or $startDate = get-date -Date  1/10/2012
[datetime]$endDate = "10/25/2012"   # or $endDate   = get-date -Date 25/10/2012

 ? { $_.LastWriteTime -lt $startDate -or $_.LastWriteTime -gt $endDate } 
```

# c++ - 如何从一个元组到一个元组引用元组中元素的元组？

> ID：13070218
> 
> 赞同：2
> 
> 时间：2012-10-25T13:56:31.647
> 
> 标签：c++, c++11, tuples

我有一个 C++11 元组，我想将`std::reference_wrapper`s 的元组获取到元组的相同元素。有没有简单的方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:39:12.993

[给定一组索引](https://stackoverflow.com/questions/7858817/unpacking-a-tuple-to-call-a-matching-function-pointer)，映射元组很容易，例如：

```
#include <tuple>
#include <functional>
#include <iostream>

template <int...>
struct Seq {};

template <int n, int... s>
struct Gens : Gens<n-1, n-1, s...> {};

template <int... s>
struct Gens<0, s...> {
  typedef Seq<s...> Type;
};

// The above are taken from https://stackoverflow.com/q/7858817 
```

使用索引，我们可以使用以下方法应用于`std::ref`元组的每个元素`std::get`：

```
template <int... s, typename Tuple>
auto ref_tuple_impl(Seq<s...> seq, Tuple& tup)
-> std::tuple<
    std::reference_wrapper<
        typename std::tuple_element<s, Tuple>::type
    >...
>
{
    return std::make_tuple(std::ref(std::get<s>(tup))...);
}

template <typename Tuple>
auto ref_tuple(Tuple& tup)
    -> decltype( ref_tuple_impl(typename Gens<std::tuple_size<Tuple>::value>::Type>(), tup) )
{
    return ref_tuple_impl(typename Gens<std::tuple_size<tuple>::value>::Type(), tup);
} 
```

使用演示：

```
int main() {
    auto t = std::make_tuple(1, 4.5, "66");
    auto rt = ref_tuple(t);

    std::get<0>(rt).get() = 123;
    std::get<1>(rt).get() = 5.67;
    std::get<2>(rt).get() = "34";

    std::cout << std::get<0>(t) << std::endl;
    std::cout << std::get<1>(t) << std::endl;
    std::cout << std::get<2>(t) << std::endl;
} 
```

# java - 我们怎么不能用'<'比较两个枚举值？

> ID：13070222
> 
> 赞同：28
> 
> 时间：2012-10-25T13:56:53.357
> 
> 标签：java, enums, scjp, ocpjp

如果枚举实现了 Comparable 那么为什么不能与 < 或 > 进行比较？

```
public class Dream    
{
    public static void main(String... args)
    {
        System.out.println(PinSize.BIG == PinSize.BIGGER); //false
        System.out.println(PinSize.BIG == PinSize.BIG); //true
        System.out.println(PinSize.BIG.equals(PinSize.BIGGER));//false
        System.out.println(PinSize.BIG > PinSize.BIGGERER);// compilation error
        //can't be compared
        System.out.println(PinSize.BIG.toString().equals(PinSize.BIGGER));// #4
        PinSize b = PinSize.BIG ;
        System.out.println( b instanceof Comparable);// true
    }  
}
enum PinSize { BIG, BIGGER, BIGGERER }; 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-25T13:59:43.520

你可以这样做：

```
PinSize.BIGGEST.ordinal() > PinSize.BIG.ordinal()  // evaluates to `true` 
```

当然，假设是在枚举*之后*`BIGGEST` 声明的。枚举中的序数值隐式地与声明顺序相关联，默认情况下，第一个值被分配 value ，第二个值等等。 *`BIG``0``1`*

 *所以如果你像这样声明枚举，事情会起作用：

```
public enum PinSize {
    SMALLEST,  // ordinal value: 0
    SMALL,     // ordinal value: 1
    NORMAL,    // ordinal value: 2
    BIG,       // ordinal value: 3
    BIGGER,    // ordinal value: 4
    BIGGEST;   // ordinal value: 5
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-10-25T13:58:32.077

实现*并不*意味着你可以使用or 。您*只能*使用带有数值的那些。[`Comparable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html) *`<``>`*

 **实施[`Comparable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)意味着有一种[`compareTo()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html#compareTo%28T%29)方法。尝试这个：

```
System.out.println(PinSize.BIG.compareTo(PinSize.BIGGER)); 
```

该[`compareTo()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html#compareTo%28T%29)方法将返回`int`小于、等于或大于 0 的值，具体取决于哪个值“更大”。在`enum`值的情况下，“大小”取决于枚举值定义的顺序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T14:29:59.663

提供的答案很好地解释了问题，但我想补充一下我的见解，因为我觉得他们没有回答“为什么不能与 < 或 > 比较”的问题？问题归结为比较参考文献。PinSize.BIGGEST 和 PinSize.BIGGERER 是参考变量。与以下相同：

```
String s;
int[] array;
MyObject myObject; 
```

它们代表内存中的地址。更重要的是，枚举是单例的，所以总是有一个指定类型的对象。因此，允许以下行并返回 true。

```
System.out.println(PinSize.BIG == PinSize.BIG); //true 
```

试图检查内存中的一个地址是大于还是小于内存中的另一个地址是不可能的。实现 Comparable 接口和 compareTo() 方法可以提供您自己的自定义方法来比较对象而不是内存中的地址。

```
System.out.println(PinSize.BIG > PinSize.BIGGERER); // not possible 
```***

# javascript - 应用程序页面上的 Sharepoint 2010 XsltListViewWebPart

> ID：13070228
> 
> 赞同：1
> 
> 时间：2012-10-25T13:56:58.323
> 
> 标签：javascript, ajax, sharepoint-2010

我正在尝试将 XsltListViewWebPart 控件动态添加到共享点应用程序。当我在 Page_Load 上运行 ShowDocumentList(pnlAdminCurrentDocuments) 时，一切正常。

但是，如果我在 ajax 请求上调用相同的函数，控件会加载，但不会触发任何事件（即排序、扩展树视图等）

```
XsltListViewWebPart wp;

    private void ShowDocumentList(Panel panel)
    {
        try
        {
            ShowMessage("<p>No documents to show</p>");

            string meetingURL = "http://rl01/sites/nmc/FullMonty";
            string meetingId = "6d39de81-a7f7-4cff-9c94-5d2893526dc5";

            if (!string.IsNullOrEmpty(meetingURL) && !string.IsNullOrEmpty(meetingId))
            {
                using (SPSite site = new SPSite(meetingURL))
                {
                    using (SPWeb web = site.OpenWeb())
                    {
                        SPList list = web.Lists.TryGetList("Meeting Documents");

                        if (list == null)
                            return;

                        SPView view = null;

                        try
                        {
                            view = list.Views["Submitted"];
                            //view = list.Views[0];
                        }
                        catch { }

                        if (view == null)
                        {
                            //todo - replace with toolbx message
                            ShowMessage("Cannot view documents");
                        }
                        else
                        {

                            wp = new XsltListViewWebPart();
                            wp.ChromeType = PartChromeType.None;
                            wp.ListId = list.ID;
                            wp.ViewGuid = view.ID.ToString();
                            wp.WebId = web.ID;

                            wp.XmlDefinition = view.GetViewXml();
                            wp.XmlDefinition = wp.XmlDefinition.Replace("MEETING_ID", meetingId);

                            //SetToolbarContext(web);

                            panel.Controls.Clear();
                            panel.Controls.Add(wp);
                        }
                    }
                }
            }
        }
        catch (Exception ex)
        {
            ShowMessage("");
        }
    } 
```

该函数实际上获取数据并执行所有操作，但列表视图上的所有客户端功能都不起作用。即使我将鼠标悬停在列名上也会引发 javascript 错误。如果我在不使用 ajax 的情况下添加带有完整回发的控件，那么一切都会按预期工作。

```
protected void radAjaxMgr_AjaxRequest(object sender, Telerik.Web.UI.AjaxRequestEventArgs e)
    {
        ShowDocumentList(pnlAdminCurrentDocuments);
    } 
```

HTML标记如下

```
<telerik:RadAjaxManager ID="radAjaxMgr" runat="server" OnAjaxRequest="radAjaxMgr_AjaxRequest">
</telerik:RadAjaxManager>
<asp:UpdatePanel runat="server" ID="pnl1">
                                    <ContentTemplate>
                                        <asp:Panel ID="pnlAdminCurrentDocuments" runat="server" CssClass="i3q_DocumentListHldr submittedDocsPanel">
                                        </asp:Panel>
                                    </ContentTemplate>
                                </asp:UpdatePanel> 
```

引发ajax调用的Javascript函数

```
function test()
    {
        var ajaxMgr = $find("<%= RadAjaxManager.GetCurrent(this).ClientID %>");

        if (ajaxMgr)
        {
            ajaxMgr.ajaxRequest("Name1;Value1");
        }
    } 
```

提前致谢 ：-）

# xml - 使用 sed 提取匹配的数字

> ID：13070231
> 
> 赞同：0
> 
> 时间：2012-10-25T13:57:02.153
> 
> 标签：xml, sed, match

我有一个带有 1 行长字符串的 xml 文件我想提取 "" 之后的数字，如下例所示，我想得到 131

```
.....<yt:duration seconds='131'/>.... 
```

这里的“....”是指“”之前和之后的子字符串，它们很长，带有不同的字符、数字和标记。

如何使用 sed 提取匹配号码？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T01:55:19.287

一个 sed 解决方案（`@`用作分隔符）：

```
sed -r "s@.*<yt:duration seconds='([0-9]+)'/>.*@\1@" file.txt 
```

对于 OSX，替换`-r`为`-E`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:15:04.163

使用`grep`，而不是`sed`：

```
grep -o "<yt:duration seconds='[0-9]\+'/>" file.txt | cut -f2 -d"'" 
```

# node.js - 使用 express 处理 node.js 中的资产

> ID：13070233
> 
> 赞同：0
> 
> 时间：2012-10-25T13:57:23.543
> 
> 标签：node.js, templates, express, assets

好的，所以我要做的是在使用 express 时手动处理我的资产。我的意思是我不必在每个页面上都拥有每个样式表/javascript 文件。所以我希望能够在每条路由中指定是否要使用另一个 javascript 文件。前任：

```
app.get('/testing',function(req,res,next){
      assets.addJS('my-javascript-file');
      res.render('testing');
}); 
```

因此，现在当模板开始渲染时，我想要所有已添加到局部变量中的 javascript 文件。我不想在每次调用 render 时都传递它们，因为我想在其他地方添加 javascript，并且可能不一定需要向模板发送任何内容，这会导致我不会意外传递它。我想要实现的另一件事是缓存。我知道默认情况下，一旦拥有资产，它就会发回未修改的 304，但我什至不希望它发出该请求，所以我希望在文件输出时对文件执行查询字符串，可能是最后一次修改和这样，如果我更改它们，它会自动告诉用户浏览器获取最新文件，但除此之外，它会缓存它们，节省我的带宽/请求（亚马逊 s3 对这些文件收费）。如果有人能指出我正确的方向，或者如果已经有一个插件，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:15:18.707

您可以围绕此构建资产管理器：

```
app.get(function(req, res) {
  res.locals.files = [ 'somefile.js', 'somefile2.js' ];
  res.render('someview');
}); 
```

该视图只会创建多个脚本文件。

```
head
  each file in files
    script(src=base_url + '/' + file) 
```

如果您想将文件合并到一个请求中，您可能需要进一步扩展它。您可以创建一个可以获取文件数组并在每个请求上合并它们的路由。您可以使用 res.sendFile 提供文件。如果我没记错的话，这将处理所有的标题和缓存。

# c# - 打开实例委托给值类型

> ID：13070236
> 
> 赞同：5
> 
> 时间：2012-10-25T13:57:44.567
> 
> 标签：c#, delegates, clr

当我尝试为实现接口的值类型方法创建开放实例委托时，Delegate.CreateDelegate 失败。因为实例方法是值类型，所以第一个参数必须是 ref，所以让我们为此定义一个通用委托类型：

```
delegate T2 VF<T0, T1, T2>(ref T0 arg0, T1 arg1); 
```

现在这是一个程序，它成功地为 int.ToString(string) 创建了一个开放实例委托，但未能为 int.Equals(int) 创建一个开放实例委托：

```
class Program
{
    static void Main(string[] args)
    {
        var tos = typeof(int).GetMethod("ToString", new[] { typeof(string) });
        var tosopen = Delegate.CreateDelegate(
                          typeof(VF<int, string, string>), null, tos);
        // success!

        var eq = typeof(int).GetMethod("Equals", new[] { typeof(int) });
        var eqopen = Delegate.CreateDelegate(
                         typeof(VF<int, int, bool>), null, eq);
        // previous line fails with "Error binding to target method"
    }
} 
```

这似乎是由于 int.Equals(int) 实现的事实`IEquatable<int>`。请注意，以下*操作确实*有效：

```
var x = typeof(IEquatable<int>).GetMethod("Equals", new Type[] { typeof(int) });
var xopen = Delegate.CreateDelegate(
                typeof(Func<IEquatable<int>, int, bool>), null, x);
xopen(1,1); // returns true 
```

但这并不是我想要的，因为这似乎将作为第一个参数传递的任何整数装箱。我也不想比较任何`IEquatable<int>`，我想专门调用方法来比较两个整数。

对这里有什么问题有任何想法吗？

[这里提到了](https://stackoverflow.com/a/4326917/144873)一个似乎直接相关的 Microsoft Connect 错误，但该链接不再适用于我，而且我无法通过搜索找到该错误。

编辑：请注意，在尝试为覆盖方法创建开放实例委托时会出现同样的问题，因此它不仅仅是接口方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-03T03:11:56.817

这是作为时间测试的一部分运行的，希望对您有所帮助。

```
 public delegate Boolean RefFunc<T>(ref T arg1, Object arg2);
    static void Main(string[] args)
    {
        double loops = 1e6;
        Random random = new Random();
        System.Reflection.MethodInfo m;
        Stopwatch stopwatch = new Stopwatch();
        Type type = typeof(double);

        double tmp;
        stopwatch.Reset();
        stopwatch.Start();
        var deligates = new Dictionary<Type, RefFunc<double>>();
        RefFunc<double> d;
        for (int ii = 0; ii < loops; ii++)
        {
            if (!deligates.TryGetValue(type, out d))
            {
                m = type.GetMethod("Equals", BindingFlags.Public | BindingFlags.Instance, null, new Type[] { typeof(Object) }, null);
                d = (RefFunc<double>)Delegate.CreateDelegate(typeof(RefFunc<double>), null, m);
                deligates[typeof(double)] = d;
            }
            tmp = Convert.ToDouble(random.Next(0, 100));
            d(ref tmp, Convert.ToDouble(random.Next(0, 100)));
        }
        stopwatch.Stop();
        Console.WriteLine("Delegate " + stopwatch.Elapsed.ToString());
        Console.WriteLine("Delegate " + (stopwatch.Elapsed.Ticks / loops).ToString());

        Console.WriteLine("");
    } 
```

编辑：刚刚注意到原始帖子的日期，但它仍然可以为其他人节省很多时间。

# mysql - Sql 注入 group_concat

> ID：13070239
> 
> 赞同：0
> 
> 时间：2012-10-25T13:57:51.310
> 
> 标签：mysql, sql-injection

我正在研究一些用于个人教育的 SQLi，但我一直遇到同样的问题。

当我使用以下注入时

```
bla' union all select '1', group_concat(column_name),'3','4' FROM information_schema.columns WHERE table_name= CHAR(117, 115, 101,114) # 
```

我得到了一个名为 user -> 的表的所有列名

```
Host,User,Password,Select_priv,Insert_priv,Update_priv,Delete_priv,Create_priv,Drop_priv,Reload_priv,Shutdown_priv,Process_priv,File_priv,Grant_priv,References_priv,Index_priv,Alter_priv,Show_db_priv,Super_priv,Create_tmp_table_priv,Lock_tables_priv,Execute_priv,Repl_slave_priv,Repl_client_priv,Create_view_priv,Show_view_priv,Create_routin 
```

因为这是我自己的受控环境，所以我知道该表包含一个名为 UserName 的列。为什么它没有与列结果一起列出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:07:51.323

That should work. You might check that the account which is executing the query has access to the column UserName. [http://dev.mysql.com/doc/refman/5.0/en/information-schema.html](http://dev.mysql.com/doc/refman/5.0/en/information-schema.html) Suggests that you will only see columns which you have access to.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:25:11.043

回答：有不止一个表叫做 user，我没有指定在什么 table_scheme 中搜索

# objective-c - 不同的c数组声明

> ID：13070242
> 
> 赞同：-1
> 
> 时间：2012-10-25T13:58:01.183
> 
> 标签：objective-c, c, arrays

> **可能重复：**
> [sizeof 数组说明](https://stackoverflow.com/questions/5933255/sizeof-array-clarification)

我声明了 2 个数组

`GLfloat gCubeVertexData[216] = { list of numbers};`

和一个声明的数组：

```
GLfloat *resultArray = malloc(sizeof(GLfloat) * [arrayOfVerticies count]);

    for(int i = 0; i < [arrayOfVerticies count]; i++)
    {
        resultArray[i] = [[arrayOfVerticies objectAtIndex:i] floatValue];

    } 
```

为什么当我这样做时`sizeof(gCubeVertexData)`我得到 864（一个 GLflot 是 4 位，所以除以 4 你得到 216）

当`sizeof(resultArray)`我得到4？事件虽然如果我要打印出 resultArray[100] 我得到了正确的数字，并且存储的数字多于 4 个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:00:00.610

因为`sizeof(resultArray)`您正在获取指向第一个元素的指针的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:00:10.727

因为`gCubeVertexData`是一个数组，并且`resultArray`是一个指针。在数组的情况下，编译器知道需要为数组分配多少字节，因此它明确知道大小（在 C99 中的可变长度数组的情况下，它也可以在运行时轻松计算，也许通过弄乱堆栈指针）。

但是，在 的情况下`malloc()`，编译器不知道指针指向的内存大小（无论如何，该大小只能以非标准和平台相关的方式获得......），所以它只返回**变量**本身的大小，在这种情况下是一个指针，所以你最终会回来`sizeof(GLfloat *)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:02:28.860

看gCubeVertexData和resultArray的声明。第一个是一个有 216 个元素的数组，后者只是一个指针。C（以及因此 C++ 和 Objective-C）允许使用指针来访问数组，但这并不意味着它们具有相同的类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:01:24.643

的类型`resultArray`很简单`GLfloat *`，即“指向 的指针`GLfloat`，您的机器使用 4 个字符来存储一个指针。与指针关联的大小信息对`sizeof`操作员是不可见的。

因此，`sizeof resultArray == sizeof (GLfloat *)`，这就是您所看到的。

# sql-server - 获取数字序列中的缺失值

> ID：13070244
> 
> 赞同：4
> 
> 时间：2012-10-25T13:58:01.423
> 
> 标签：sql-server, ms-access, ms-access-2010

我对 SQL Server 后端进行了以下查询

```
SELECT TOP(1) (v.rownum + 99)
FROM
    (
        SELECT incrementNo-99 as id, ROW_NUMBER() OVER (ORDER BY incrementNo) as rownum
        FROM proposals
        WHERE [year] = '12'
    )  as v
WHERE v.rownum <> v.id
ORDER BY v.rownum 
```

找到第一个未使用的提案编号。（这不是关于lastrecord +1）

但我意识到`ROW_NUMBER`不支持访问。我看了看，我找不到类似的东西。

有谁知道如何获得与`ROW_NUMBER`访问相同的结果？

也许有更好的方法来做到这一点。

实际上人们在没有约束的情况下插入他们的提案 No (incrementID)。这个数字看起来像这样 13-152。xx- 代表当年，-xxx 是提案编号。最后 3 位数字应该是递增的，但在某些情况下，一年可能有 10 次，他们必须跳过一些数字。这就是为什么我不能拥有自动增量。

所以我做了这个查询，所以当他们打开表单时，默认数字**是第一个未使用的**。

这个怎么运作：

因为数字从 100 开始，所以我输入 -99，所以它从 1 开始。

然后我将行号与 id 进行比较，所以它看起来像这样

```
ROW NUMBER      |       ID
1                        1                 (100)
2                        2                 (101)
3                        3                 (102)
4                        5                 (104)<--------- WRONG  
5                        6                 (105) 
```

所以现在我知道我们跳过了 4。所以我返回 (4 - 99) = 103

如果有更好的方法，我不介意改变，但我真的很喜欢这个查询。

如果真的没有其他方法并且我无法在访问中模拟行号，我将使用直通查询。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:58:18.247

从您的问题看来，您正在寻找一系列数字中的空白，因此：

```
SELECT b.akey, (
    SELECT Top 1 akey 
    FROM table1 a 
    WHERE a.akey > b.akey) AS [next] 
FROM table1 AS b 
WHERE (
    SELECT Top 1 akey 
    FROM table1 a 
    WHERE a.akey > b.akey) <> [b].[akey]+1
ORDER BY b.akey 
```

其中 table1 是表，akey 是序号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-26T05:20:17.067

```
SELECT T.Value, T.next -1 FROM (
  SELECT b.Value , (
    SELECT Top 1 Value 
    FROM tblSequence a 
    WHERE a.Value > b.Value) AS [next] 
  FROM tblSequence  b  
) T WHERE T.next <> T.Value +1 
```

# java - 读取数组列表以查找特定字符串和值的方法

> ID：13070245
> 
> 赞同：2
> 
> 时间：2012-10-25T13:58:02.670
> 
> 标签：java, arrays, arraylist

```
public class array {
    public static void main(String[] args) throws IOException {

         BufferedReader reader = new BufferedReader(new FileReader("fruit.txt"));

          System.out.println("enter the fruit you want to search");     
          Scanner input =  new Scanner(System.in);
          String fruit = input.nextLine();
          String line;

          List<String> list = new ArrayList<String>();
          while((line=reader.readLine()) !=null)
          {
              list.add(line);
          }

          reader.close();

          for (String s : list) {    
              System.out.println(s); 
          }
    }
} 
```

我有水果.txt

```
apple 20 good
orange 30 good
banana 40 needmore 
```

如何从数组列表中检索我有多少橙子。我希望程序在这种情况下读取用户输入“橙色”并显示 30 并且状态不好。

理想的输出是

```
You have orange 30 of them and status is good 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:02:19.843

您需要拆分您`Strings`的`List`，然后打印在您指定的字符串格式中获得的数组的每个元素：-

```
for (String s : list) { 

    String[] tokens = s.split(" ");
    if (tokens[0].equals(fruit)) {
          System.out.println("You have " + tokens[0] + " " + tokens[1] +  
                             " of them and status is " + tokens[2]);
          break;
    }
} 
```

或者，您可以使用： -

```
System.out.format("You have %s %s of them and status is %s", 
                   tokens[0], tokens[1], tokens[2]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:05:33.773

尝试以下更新的课程。

```
public class array
{

   public static void main(String[] args) throws IOException
   {

      BufferedReader reader = new BufferedReader(new FileReader("fruit.txt"));

      System.out.println("enter the fruit you want to search");
      Scanner input = new Scanner(System.in);
      String fruit = input.nextLine();

      String line;

      boolean found = false;
      int count = 0;

      List<String> list = new ArrayList<String>();
      while ((line = reader.readLine()) != null)
      {
         String[] items = line.split(" ");

         if (fruit.equals(items[0]))
         {
            found = true;
            count = Integer.parseInt(items[1]);
            break;
         }

         list.add(line);
      }

      reader.close();

      if (found)
      {
         System.out.println("You have " + fruit + " " + count + " of them and status is good");
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:02:38.173

您需要使用 StringTokenizer 将行拆分为三个字段。然后我会创建一个新类来保存这些信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:05:25.860

当您读取一行时，将值拆分为字符串数组，如下所示：

```
while((line=reader.readLine()) !=null)
            {
                String [] values = line.split(" ");

                list.add("You have "+values[0] + " " + values[1] " of them and status is "+values[2]  );
            } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T14:06:39.790

未经测试但应该可以工作，请尝试：

```
public class array {

    public static class Fruit {
        private String name;
        private String count;
        private String status;

        public Fruit(String name, String count, String status) {
            this.name = name;
            this.count = count;
            this.status = status;
        }

        public String getName() {
            return name;
        }

        public String getCount() {
            return count;
        }

        public String getStatus() {
            return status;
        }
    }

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new FileReader("fruit.txt"));
        System.out.println("enter the fruit you want to search");
        Scanner input = new Scanner(System.in);
        String fruit = input.nextLine();
        String line= "";
        HashMap<String, Fruit> map = new HashMap<String, Fruit>();
        while ((line = reader.readLine()) != null) {
            String[] strings = line.split(" ");
            map.put(strings[0], new Fruit(strings[0], strings[1], strings[2]));
        }
        reader.close();
        System.out.print("You have " + fruit + " " + map.get(fruit).getCount() + " of them and status is: " + map.get(fruit).getStatus());
    }

} 
```

# xaml - 双向绑定到静态类中的静态属性

> ID：13070252
> 
> 赞同：2
> 
> 时间：2012-10-25T13:58:21.663
> 
> 标签：xaml, binding, static, static-class, two-way

这真的不可能吗？我有解决方案将单向绑定到静态类中的属性，当然我有解决方案将双向绑定到非静态类中的静态属性......但是......

我的意思是，解决方法很简单，我可以将我的静态类变成带有静态实例 getter 的单例（见[这里](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/257a41be-8168-401c-a915-cdc44e195a3f/)），但是没有合适的方法吗？

我的课看起来像这样：

```
public static class TestClass
{
  public static string TestProp {get; set;}
} 
```

现在请假设我在设置器中以“正常”方式正确实现 INotifyPropertyChanged（为简单起见，省略）。

XAML 应该如何以双向方式绑定到此属性？谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-25T15:50:16.863

这个答案可能会有所帮助： [wpf static binding question](https://stackoverflow.com/questions/2371281/wpf-static-binding-question) 或这个： [Binding to static class property](https://stackoverflow.com/questions/3862455/binding-wpf-textblock-to-static-class-property)

简而言之，您的情况如下所示：

```
{Binding Source={x:Static whatever:TestClass.TestProperty}, Path=.} 
```

# php - PJAX + jQuery 模态

> ID：13070253
> 
> 赞同：1
> 
> 时间：2012-10-25T13:58:22.553
> 
> 标签：php, javascript, jquery, ajax, pjax

我正在构建这个网页，我希望新闻出现在 jquery.modal 中，但具有共享功能，这意味着使用 URL。我为解决方案找到了 PJAX，然后我想将链接放在 URL 中并在模式窗口中显示内容。经过几天的谷歌搜索，我偶然发现了这一点，如果您单击该页面，它会以模式打开，但会显示 URL，但我找不到它是如何工作的。这是链接：[http ://rigaspots.blogspot.com/](http://rigaspots.blogspot.com/)

这是我的代码。

```
<link rel="stylesheet" href="../jquery.modal.css">
<script src="js/jquery-1.7.1.min.js"></script>
<script src="js/jquery.cookie.js"></script>
<script src="js/jquery.pjax.js"></script>
<script src="../js/jquery.modal.js"></script>
<script type="text/javascript">

var direction = "right";
$(document).ready(function(){
$('a').pjax({
container: '.modal'
});

$('.modal').on('pjax:start', function() {
  $(this).addClass('loading')
})

$('.modal').on('pjax:end', function() {
  $(this).removeClass('loading')
})

});

</script>

<style> 

#main {
  font-family:Helvetica,Arial,sans-serif;   
  width:30%;  
  opacity: 1;
  transition: opacity 0.20s linear;
}

#main.loading {
   opacity: 0.5;
}   
h2 {margin-left:200px;}
   ul{padding-left:15px; list-style:none;}
</style> 

</head>
<body>
<p ><strong style='color:green'> 2012-10-25 16:52:13</strong> (Time should only change on     refresh!)</p><div id="main">
<h1>PJAX using PHP</h1>

<ul class='header'>
  <li><a href='trex.php' data-pjax='modal' rel="modal:open">Tyrannosaurus</a></li>
  <li><a href='kong.php' data-pjax='modal' rel="modal:open" >King Kong</a></li>
</ul>
</div> 
```

你可以在这里看到它：http: [//supervalters.mplab.lv/source/](http://supervalters.mplab.lv/source/)

任何帮助，将不胜感激。谢谢。

# spring - 从另一个 jar 中的类中读取属性文件

> ID：13070254
> 
> 赞同：0
> 
> 时间：2012-10-25T13:58:28.200
> 
> 标签：spring, maven, junit

我有一个包含多个 Maven 子项目的项目。使用 Spring、JPA、JUnit。

```
+common
   + WebserviceBindingProvider.java  
+views
   +......
   +src/main/test/TestClass.java
   +src/main/test/resources/mocking.properties

The "common" project has a class that reads the properties file "mocking.properties" that is in the "views" project test folders - src/main/test/resources/
The common.jar is added as dependency to the views project.

The code is something like below.

Resource resource = new ClassPathResource("/mock_endpoints.properties"); 
props = PropertiesLoaderUtils.loadProperties(resource); 
```

当我运行测试用例时，我将“道具”设为空。

谁能让我知道我错过了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:03:33.177

你`TestClass.java`应该在`src/test/java/`，你`mocking.properties`应该在`src/test/resources/`。

# java - 组合多个@SuppressWarnings 注释 - Eclipse Indigo

> ID：13070260
> 
> 赞同：160
> 
> 时间：2012-10-25T13:58:43.323
> 
> 标签：java, eclipse, annotations, eclipse-indigo, suppress-warnings

所以问题是能够结合多重警告抑制，这样每个项目就不需要它自己的`@SuppressWarnings`注释。

例如：

```
public class Example
    public Example() {
        GO go = new GO();  // unused
        ....
        List<String> list = ( List<String> ) go.getList(); // unchecked
    }
    ...
    // getters/setters/other methods
} 
```

现在我不想有两个，`@SuppressWarnings`我想在班级级别有一个来处理这两个警告，就像这样：

```
@SuppressWarnings( "unused", "unchecked" )
public class Example
    public Example() {
        GO go = new GO();  // unused - suppressed
        ....
        List<String> list = ( List<String> ) go.getList(); // unchecked - suppressed
    }
    ...
    // getters/setters/other methods
} 
```

但这不是一个有效的语法，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：326
> 
> 时间：2012-10-25T14:02:03.477

使用以下内容： `@SuppressWarnings({"unused", "unchecked"})`

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-07-07T10:22:29.957

如果您查看注释内部，您将看到：

```
public @interface SuppressWarnings {
    String[] value();
} 
```

如您所见，**value**参数是一个字符串数组...所以注解中的参数可以是： **value1、value2 或 value3** 其中

```
final String[] value1 = { "a1" };
final String[] value2 = { "a1", "a2" };
final String[] value3 = { "a1", "a2", "a3" }; 
```

IE：

```
@SuppressWarnings({"unused"})
@SuppressWarnings({"unused", "javadoc"}) 
```

你经常看不到类似的东西

```
@SuppressWarnings("unused") 
```

这是一种特殊情况，允许一个元素没有“ **{}** ”

# c# - 创建带有异常信息的 Windows 窗体？

> ID：13070264
> 
> 赞同：2
> 
> 时间：2012-10-25T13:58:55.057
> 
> 标签：c#, winforms, exception-handling, try-catch

我正在尝试找到一种方法来创建一个漂亮的 Windows 窗体，当我遇到未处理的异常时会弹出该窗体。我目前有：

```
// Add the event handler for handling UI thread exceptions
Application.ThreadException += new ThreadExceptionEventHandler(Application_ThreadException );

// Add the event handler for handling non-UI thread exceptions
AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler( CurrentDomain_UnhandledException );

static void CurrentDomain_UnhandledException( object sender, UnhandledExceptionEventArgs e )
{
    MessageBox.Show( e.ToString( ), "Unhandled Non-UI Thread Exception" );
}

static void Application_ThreadException( object sender, ThreadExceptionEventArgs e )
{
    MessageBox.Show( e.ToString( ), "Unhandled UI Thread Exception" );
} 
```

但我正在寻找的是，在线程异常方法中，弹出一个包含错误信息的窗口窗体，以及继续/退出/重新启动任何内容。这听起来与通过谷歌搜索看起来像是在某些情况下内置的东西非常相似，但是是否有可能创建某种我可以调用的可修改/自定义的东西？

抱歉，我无意中粘贴了错误的代码部分。我目前正在使用一个消息框，但想要一个带有一些功能按钮的更强大的消息框。

谢谢一堆。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:00:59.813

弹出一个 MessageBox 怎么样？看看这里[http://www.dotnetperls.com/messagebox-show](http://www.dotnetperls.com/messagebox-show)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T14:05:00.350

您的所有事件都应包含在如下代码中：

```
DialogResult result = DialogResult.Retry;
while (result == DialogResult.Retry) {
    try {
        DoProcess();
        break;
    }
    catch (Exception ex) {
        result = MessageBox.Show(ex.ToString(), 
                    "Error Information", 
                    MessageBoxButtons.AbortRetryIgnore,
                    MessageBoxIcon.Exclamation);
        if (result == DialogResult.Abort) throw;
    }
} 
```

`DoProcess()`有风险的代码在哪里。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T14:02:51.787

当然，只需创建任何旧表单，并`ShowDialog`在那时使用它来显示它。你可以在上面放任何你想要的东西。然后，您可以在其上放置各种按钮，用于“继续”、“重新启动”、“退出”等。然后，您可以在`ShowDialog`返回后检查表单的属性，以根据单击的按钮确定要做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:13:07.903

创建一个自定义窗口，当您遇到错误时会弹出该窗口。然后您可以决定是否关闭应用程序，继续或退出某个进程。

我能想到的最好方法是创建一个自定义异常，当您的应用程序中出现特定问题时您会抛出该异常。然后，您应该允许此异常冒泡并通过以下方式之一进行处理。

Application.ThreadException AppDomain.CurrentDomain.UnhandledException

检查此链接以获取更多信息。

msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T14:14:41.520

创建自定义消息框。这应该继承自 From

```
class MyDialog : Form
    {
        //your properties like buttons and all goes here
    private Button okButton;
    private Button cancelButton;

        okButton = new Button();
        okButton.DialogResult = DialogResult.OK;
        okButton.Location = new Point(20, 260);
        okButton.Size = new Size(80, 25);
        okButton.Text = "OK";
        okButton.Click += new EventHandler(okButton_ClickCompany);
        Controls.Add(okButton);

        //same implementation for all other controls you define
    } 
```

你的实现就像

```
 MyDialog myDialog = new MyDialog(); // you can constructor for using it everywhere
        if (myDialog.ShowDialog() == DialogResult.OK)
        {
             //you code goes here
        } 
```

这是非常好的方法。您可以根据需要对其进行扩展，并通过定义多个构造函数以多种方式使用它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-25T14:14:53.133

MSDN 中有一个很好的示例 [http://msdn.microsoft.com/en-us/library/system.threading.threadexceptioneventargs.aspx](http://msdn.microsoft.com/en-us/library/system.threading.threadexceptioneventargs.aspx)

# python - 使用 Django 会话表的请求

> ID：13070267
> 
> 赞同：0
> 
> 时间：2012-10-25T13:59:00.873
> 
> 标签：python, django, python-requests

我有一个使用[请求](http://docs.python-requests.org/en/latest/)库来调用 Web 服务的应用程序。在 django 上，我使用一个表来使用标准 django_session 库来保持会话。

我注意到，每次请求库触发调用时，我都会在数据库中创建一条新记录。我觉得这很奇怪，因为我没有（明确地）使用请求会话，而且我的大多数调用都是单个 GET 调用，不需要任何持久性。

其他人有这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:35:08.017

[`django.contrib.sessions.middleware.SessionMiddleware`](https://docs.djangoproject.com/en/dev/ref/middleware/#module-django.contrib.sessions.middleware)将为每个请求创建一个新会话。

如果您想禁用此行为，请考虑替换`django.contrib.sessions.middleware.SessionMiddleware`为自定义中间件，该中间件可扩展`django.contrib.sessions.middleware.SessionMiddleware`但可防止在您不想要会话的情况下创建会话。

[这个答案](https://stackoverflow.com/a/4054339)提供了一个如何做到这一点的例子。它解析`request.path_info`以确定是否应该创建会话，但您可以使用许多不同的技术，例如向您的请求添加自定义标头，包括 post 变量等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-07T07:02:46.213

原来我打开了这个设置

```
SESSION_SAVE_EVERY_REQUEST=True 
```

当我开始进行会话时，我想确保安全，以确保没有任何东西掉入裂缝。原来这是将空会话信息写入数据库。

# javascript - 为什么这个 localScroll-navigation 在 Chrome 上不起作用？

> ID：13070268
> 
> 赞同：0
> 
> 时间：2012-10-25T13:59:04.023
> 
> 标签：javascript, jquery, navigation, scroll

我将 joao.pt 设计[为](http://joao.pt)使用[localScroll](http://flesler.blogspot.pt/2007/10/jquerylocalscroll-10.html)在同一页面内进行垂直定位导航（点击页面左上角的*Journal*、*Recent*或*Contact按钮进行尝试）。*虽然它适用于几乎所有的浏览器和设备，但它不适用于 Chrome——不仅在点击我上面提到的锚链接时它不起作用，它也不能在页面加载时加载正确的部分。这是我正在使用的代码（来自预先缩小的[scripts.js](http://joao.pt/wp-content/themes/joaoramos/js/scripts.js)）：

```
$.localScroll.hash({ // scroll to section on page load
    hash: true
});

$.localScroll({ // scroll when hitting anchor links
    hash: true
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T16:20:33.273

我只是通过逐字更新 localScroll 和 scrollTo 库来随机解决这个问题。这并不是真正的更新，因为距离上次更新已经 3 年了，但是……它已经修复了。

# javascript - 简化 Facebook API 脚本中的 IF/ELSE

> ID：13070272
> 
> 赞同：0
> 
> 时间：2012-10-25T13:59:12.787
> 
> 标签：javascript, facebook, if-statement, facebook-opengraph

我担心这个问题可能有一个简单的答案，但是我徒劳地寻找它！任何帮助，将不胜感激。我们的 Facebook 应用程序已经全部设置好，并且我们的动作和对象与一个小的 Java 脚本一起工作得很好。但是...我想通过摆脱 Javascript 中触发操作的警报对话来简化我们网站的整个流程。

这就是我们现在所拥有的（有效）：

```
<script type="text/javascript">
function postResonate_with_cambodia()
{
    FB.api('/me/onemandala:resonate_with' +
            '?intention=http://1mandala.org/1action-002','post ',
            function(response) {
            if (!response || response.error) {
            if (confirm('You are not yet signed up for 1Mandala. 1Mandala uses Facebook Connect to     showcase the amazing 1Actions folks are taking on our platform. We will redirect you now to the signup page...')) { window.location.href='http://www.1mandala.org/app-signup ' } else { void('') };;
            } else {
            if (confirm('You are resonating with the intention for 1SewingKit Cambodian Orphanage Empowerment. We will take you now to the project page to take action...')) {  window.location.href='http://1mandala.org/1action-002 ' } else { void('') };;
            }
            });
}
</script> 
```

对话应该清楚地说明它应该如何工作。但是......如果不是这些对话，脚本将访问者直接发送到 Facebook 注册对话或登录页面，这不是更好吗？这是我的尝试，但不起作用。：-（ 任何建议将不胜感激。

```
<script type="text/javascript">
function postResonate_with_cambodia()
{
FB.api('/me/onemandala:resonate_with' +
'?intention=http://1mandala.org/1action-002','post',
function(response) {
if (!response || response.error)
{window.location.href='http://www.sign-up-page.com' } ;
} else {
{ window.location.href='http://1mandala.org/app-1action-002' } ;
}
});
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T14:49:05.790

这很简单，你有一个语法错误。这就是 的原因`ReferenceError: postResonate_with_cambodia is not defined`，但也应该报告语法问题。

您的右大括号太多（或左大括号太少）；你也不需要将你的 else-body 包裹在两个块中。一个就足够了，对于一个单线，你甚至不需要它。更正：

```
function postResonate_with_cambodia() {
    var url = '/me/onemandala:resonate_with?intention=http://1mandala.org/1action-002';
    FB.api(url, 'post', function(response) {
        if (!response || response.error) {
            window.location.href='http://www.sign-up-page.com';
        } else {
            window.location.href='http://1mandala.org/app-1action-002';
        }
    });
} 
```

始终正确缩进您的代码。并且在单个语句之后使用分号，而不是在块之后。

# logback - 如何将 logback 配置指定为类路径资源而不是文件

> ID：13070273
> 
> 赞同：12
> 
> 时间：2012-10-25T13:59:13.447
> 
> 标签：logback

我有以下情况。我需要能够运行由不同批处理文件启动的两个程序，其中每个批处理文件都使用同一个 jar 中的 main() 调用一个 java 类。我希望每个程序都有自己的日志。但是，第二个程序是第一个程序的安装程序，因此，我不想/不能轻易指定 -Dlogback.configurationFile=/path/to/config 文件，因为该位置可能尚不存在。

[Logback 文档似乎提供了一个解决方案](http://logback.qos.ch/manual/configuration.html#configFileProperty)，但我需要一个如何使其工作的示例：

> 将默认配置文件的位置指定为系统属性
> 
> 如果您愿意，可以使用名为 logback.configurationFile 的系统属性指定默认配置文件的位置。此属性的值可以是 URL、类路径上的资源或应用程序外部文件的路径。
> 
> java -Dlogback.configurationFile=/path/to/config.xml chapters.configuration.MyApp1

谁能指出一个示例，其中 logback.configurationFile 被定义为类路径上的资源而不是文件系统？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-25T14:21:58.023

您可以简单地将 a`my-logback.xml`放在您的一个类路径条目的根目录中并指定`-Dlogback.configurationFile=my-logback.xml`. 在内部，它可能会用于`ClassLoader#getResource(String name)`获取文件 - 检查此方法的 JavaDoc 以获取更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-02-08T12:03:52.663

这个问题的答案在提供的链接中： [https](https://logback.qos.ch/manual/configuration.html#configFileProperty) ://logback.qos.ch/manual/configuration.html#configFileProperty ，示例如下：

要包含的内容可以作为文件、资源或 URL 引用。

```
As a file:
To include a file use the file attribute. You can use relative paths but note that the current directory is defined by the application and is not necessarily related to the path of the configuration file.

As a resource:
To include a resource, i.e a file found on the class path, use the resource attribute.

<include resource="includedConfig.xml"/>

As a URL:
To include the contents of a URL use the url attribute.

<include url="http://some.host.com/includedConfig.xml"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-18T18:05:10.780

好的，我继续尝试了。

如果 logback 配置文件是 jar 的本地文件（在您正在运行的同一个 jar 中），则此方法有效：

```
System.setProperty("logback.configurationFile", "org/package/path/your.logback.xml"); 
```

作品。如果它在“任何地方”的类路径中。这真的很奇怪，因为通常调用`getResource`您必须使用前面的斜杠指定它，例如：

`YourClass.class.getResource("/org/package/path/your.logback.xml")`所以不知道为什么。

其他更奇特的资源路径（例如指定确切的 jar）似乎也不起作用。诡异的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-13T15:25:53.857

我有一个与提供命令行参数*略有*不同的解决方案。

我的项目是这样设置的：

```
| foo
  - src
    - conf
      - logback.xml
    - main
    - test 
```

我想要`logback.xml`罐子的外面，因为我有`scanPeriod`现场重新加载的装置。我想既然它应该在类路径中被拾取，我会将路径添加到`manifest.mf`它，它会自动被拾取。

* * *

`foo`的相关部分`pom.xml`如下所示：

```
<plugins>
  . . . Some plugins before
  <plugin>
    <artifactId>maven-resources-plugin</artifactId>
    <version>3.0.2</version>
    <executions>
      <execution>
        <id>copy-resources</id>
        <phase>validate</phase>
        <goals>
          <goal>copy-resources</goal>
        </goals>
        <configuration>
          <outputDirectory>${basedir}/target/conf</outputDirectory>
          <resources>
            <resource>
              <directory>src/conf</directory>
            </resource>
          </resources>
        </configuration>
      </execution>
    </executions>
  </plugin>

  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <version>3.0.2</version>
    <configuration>
      <archive>
        <manifest>
          <addClasspath>true</addClasspath>
          <classpathPrefix>lib/</classpathPrefix>
          <mainClass>com.company.foo.main.Main</mainClass>
        </manifest>
        <manifestEntries>
          <version>${project.version}</version>
          <Class-Path>.</Class-Path>
          <Class-Path>conf/</Class-Path>
        </manifestEntries>
      </archive>
    </configuration>
  </plugin>
  . . . Some plugins after
</plugins> 
```

### 需要注意的重要事项：

*   Maven 资源插件
    *   将所有文件复制`src/conf`到标准编译文件夹`target/conf`中。
*   Maven Jar 插件
    *   将`conf`文件夹添加到`MANIFEST.MF`的类路径中，这样您就无需在命令行上指定位置。
    *   **文件夹中的**所有文件**`conf`都将添加到类路径中，而不仅仅是`logback.xml`**

 *** * *

为了让 jar 在这种情况下运行，该`conf`文件夹**必须**放在 jar 旁边。它看起来像这样：

```
path/to/jar
  | foo.jar
  | lib/
  | conf/
    | logback.xml 
```

* * *

`MANIFEST.MF`看起来像这样：

```
Manifest-Version: 1.0
Built-By: $user
Class-Path: lib/x.jar lib/y.jar lib/z.jar conf/
version: 0.0.1-SNAPSHOT
Created-By: Apache Maven 3.5.2
Build-Jdk: 1.8.0_161
Main-Class: com.company.foo.main.Main 
```**

# ajax - 即使在设备准备好之后，Phonegap + Zepto 上的第一个 ajax 调用也会返回 undefined

> ID：13070274
> 
> 赞同：1
> 
> 时间：2012-10-25T13:59:15.983
> 
> 标签：ajax, cordova, jsonp, zepto

我在启动时在我的移动应用程序中进行 jsonp 调用以连接到我的服务器。我正在使用 Phonegap 2.1 和 Zepto 1.0-rc1。在我的 html 页面的底部，我准备好 DOM 上的初始化内容。

```
<script type="text/javascript">
if (!$) {$ = Zepto};
$(init);
document.addEventListener('deviceready', Perksea.deviceReady);
</script> 
```

...

```
function init() {
    var router = new Backbone.Router();
    ...
}
function deviceReady() {
    isConnected();
    isConnected();
}
function isConnected() {
    $.ajaxJSONP({
        url: 'http://localhost/isconnected',
        success: function(response) {
            console.log('response is ' + response);
        }
    });
} 
```

第一个 JSONP 调用将打印“响应未定义”，但第二个 JSONP 调用有效。我什至尝试将 JSONP 调用放入 setTimeout(isConnected, 5000) 中，结果相同。已经检查过网址是否正确等。

有没有人见过这样的东西？

谢谢史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T02:55:32.317

由于您在第一次调用时进入“成功”回调函数（未定义响应），您确定您的服务器正确响应第一次调用吗？听起来它正在返回 200 响应，但没有第一次调用的数据。

您可以尝试添加一个“错误”回调，看看它是否也提供了任何有用的东西

```
$.ajaxJSONP({
    url: 'http://localhost/isconnected',
    success: function(response) {
        console.log('response is ' + response);
    }
    error: function(response) {
        console.log('error is ' + response);
    }
}); 
```

*最后，因为 AJAX 是异步的，所以您对isConnected()*的 2 次调用将一个接一个地触发，而不是等待第一个响应。我很好奇它在服务器端的样子（见上文）。

# android-layout - 创建时具有动态内容的 Android ViewPager

> ID：13070275
> 
> 赞同：2
> 
> 时间：2012-10-25T13:59:20.960
> 
> 标签：android-layout

我有一个活动，它列出了数据库中存储在 TableView 中呈现的数据对象中的多个记录。当用户点击一行时，该对象被传递给另一个活动，该活动将显示所有详细信息。该活动使用 ViewPager 在我的自定义 PagerAdapter 类的 instantiateItem 方法中使用布局 XML 文件显示 5 个页面上的信息。ViewPager 工作正常，但我需要能够立即使用来自传递对象的数据“刷新”页面，但页面上的视图在活动的 onCreate 方法中尚不可用。有什么方法可以做到这一点。

# java - 正确解析字符串且不丢失分隔符

> ID：13070277
> 
> 赞同：4
> 
> 时间：2012-10-25T13:59:30.377
> 
> 标签：java, parsing

我有一段代码基本上可以将英语翻译成文字。

目前我正在使用该`String.split()`方法并`\\\W`用作分隔符，删除所有非单词字符。

就目前而言，这就是我得到的：

```
input:I hate text speak!:)
output:I h8 txt spk 
```

反正我不会丢失分隔符吗？

编辑：这是进行解析的方法。就目前而言，它将分隔符替换为空格，因此至少它仍然可读...

```
public static String engToText(String text){
                    text=text.toLowerCase();
                    String translated=" ";

                    //breaks string into tokens
                    String[] tokens = text.split("\\W");

                    for(int x=0;x<tokens.length;x++){
                        if(wordMapEng.containsKey(tokens[x])){
                            translated+=" "+wordMapEng.get(tokens[x]);
                        }else{
                            translated+=" " + tokens[x];
                        }
                    }

                    return translated.trim();
                } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:02:47.403

您可以使用`StringTokenizer`具有

```
StringTokenizer(String str, String delim, boolean returnDelims) 
```

迭代令牌时的构造函数也会给你返回分隔符。

# iphone - 核心数据保存成功，但数据库中没有数据

> ID：13070278
> 
> 赞同：0
> 
> 时间：2012-10-25T13:59:36.553
> 
> 标签：iphone, objective-c, ios, core-data

我一直在努力将 Core Data 添加到我的 iPhone 应用程序中，并且遇到了一些非常令人沮丧的问题。当我在我的上下文中调用 save 时，保存成功返回，但是没有数据被添加到我的数据库中（我在模拟器上运行它并查看 SQLITE 文件进行检查）。

我正在使用[这篇文章](http://adevelopingstory.com/blog/2012/03/core-data-with-a-single-shared-uimanageddocument.html)`MYDocumentHandler`中的类来跨多个类使用一个。我在我的代码中运行如下：`UIManagedDocument``AppDelegate`

```
if (!self.document) {
    [[MYDocumentHandler sharedDocumentHandler] performWithDocument:^(UIManagedDocument *document) {
        self.document = document;
        self.context = document.managedObjectContext;
        [self loadView];
    }];
} 
```

该`loadView`方法在文档返回后设置我的视图控制器。在我使用核心数据的视图控制器中，我再次使用这样的东西：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    if(!self.document){
        [[MYDocumentHandler sharedDocumentHandler] performWithDocument:^(UIManagedDocument *document) {
            self.document = document;
            self.context = document.managedObjectContext;
            [self loadAll];
        }];
    }

} 
```

该`loadAll`方法为视图设置所有内容的位置。当我尝试保存数据时，我使用以下内容：

```
for (int i = 0; i < [jsonArray count]; i++) {
                    NSDictionary *dictionary = [jsonArray objectAtIndex:i];
                    ProjectObject *tempProject = [[ProjectObject alloc] initWithDict:dictionary andETag:etag];
                    [tempAllProjects addObject:[Projects newProject:tempProject withContext:self.context]];
                    [tempProject release];
                }

                [self saveWithContext:self.context]; 
```

我的`saveWithContext`方法如下所示：

```
- (BOOL) saveWithContext:(NSManagedObjectContext *)context{
    NSError *error = nil;

    if (context != nil) {
        if ([context hasChanges] && ![context save:&error]) {
            DLog(@"Unresolved error %@, %@", error, [error userInfo]);
        } else{
            DLog(@"save was successful");
            return YES;
        }
    }else{
        DLog(@"context is nil");
        return NO;
    }
} 
```

我总是收到`save was successful`消息，并且从 MYDocumentHandler 文件中得到正确的消息。不幸的是，数据根本没有进入数据库。数据肯定存储在上下文中，但不会进入数据库。有任何想法吗？

**编辑：** 这是我创建实体的代码：

```
+ (Projects *) newProject:(ProjectObject *)project withContext:(NSManagedObjectContext *)context
{
    Projects *newProject = nil;
    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Projects"];
    request.predicate = [NSPredicate predicateWithFormat:@"project_id = %@", project.project_id];
    NSArray *results = [context executeFetchRequest:request error:nil];

    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    if([results count] > 0){
        newProject = [results objectAtIndex:0];
        newProject.account_id = [NSString stringWithFormat:@"%@", [defaults objectForKey:@"account_id"]];

    } else {
        newProject = [NSEntityDescription insertNewObjectForEntityForName:@"Projects" inManagedObjectContext:context];
    }

    newProject.account_id = [NSString stringWithFormat:@"%@", [defaults objectForKey:@"account_id"]];
    newProject.project_id = project.project_id;
    newProject.name = project.name;
    newProject.project_description = project.description;
    newProject.updated_at = project.updated_at;
    newProject.starred = project.starred;
    newProject.etag = project.etag;

    newProject.synced = [self hasConnection] ? [NSNumber numberWithInt:1] : [NSNumber numberWithInt:0];
    return newProject;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:39:50.230

我在[这篇](https://stackoverflow.com/questions/9609225/saved-core-data-does-not-persist-after-app-closes-80-of-the-time)文章中找到了解决方案。不确定这是否是处理它的最佳方法。如果有更好的选择，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:27:26.417

更改后没有保存管理对象上下文。我已将这些行添加到您的代码中。请检查它现在是否有效。

# java - 使用 Java 的 OpenId 提供者/服务器

> ID：13070282
> 
> 赞同：6
> 
> 时间：2012-10-25T13:59:49.953
> 
> 标签：java, web-applications, openid, provider

我正在尝试使用 OpenId 服务增强现有的 Java Web 应用程序，以便登录用户可以使用我的 Web 应用程序作为 OpenId 提供程序登录到另一个启用 OpenId 的应用程序。

我的第一次尝试是使用[JOS](http://code.google.com/p/openid-server/)作为 OpenId 提供者，它应该反过来使用我的应用程序的数据库来获取现有的用户名和密码。然而，当我尝试自定义 JOS 以使其适合我现有的应用程序时，我找不到任何 JOS 文档（~~它甚至没有编译~~更新：它只能使用 Java 6 编译）。

目前我正在寻找其他可能的解决方案，但 OpenId 提供程序框架似乎很少。

你会推荐什么？使用像 JOS 这样的成品服务器，还是我应该考虑通过使用像 openid4java 这样的库编写自己的 OpenId 服务器来增强我的应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T10:26:09.000

我自己没有尝试过，但是我的团队在研究了这几个例子后开始着手开发 JSF+OpenId 集成应用程序：

*   客户：[IBM 示例：非常有帮助](http://www.ibm.com/developerworks/java/library/j-openid/index.html)
*   服务器：[IBM 示例：非常有帮助](http://www.ibm.com/developerworks/java/library/j-openid2/)
*   另外：[什么是 OpenId 以及它是如何工作的](http://www.theserverside.com/news/1364125/Using-OpenID)
*   另外：[用于 Java 的 openId API](http://code.google.com/p/jopenid/)

这就是我所知道的一切，希望对您有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T11:29:31.310

在[OpenID 网站](http://openid.net/)中，您可以找到[大量的选项](http://openid.net/developers/libraries/#plugins)。

[几年前，我使用OpenID4Java](http://code.google.com/p/openid4java/)实现了这种项目。
（请注意，在您的后端，您必须连接到一些保存所有用户/密码的存储库 - 我已经为此使用了[OpenLDAP](http://www.openldap.org/)）

HTH。

# python - 在 Cygwin shell 中从 Maven 调用 Python

> ID：13070289
> 
> 赞同：1
> 
> 时间：2012-10-25T14:00:09.140
> 
> 标签：python, maven, cygwin

从 Cygwin shell 使用 Maven 构建时（在 Windows 上通过 Cygwin 进行 bash），/usr/bin 的路径无法正确解析。

让我解释。Cygwin 附带 Python，可作为 /usr/bin 的符号链接访问。Maven 应该可以访问这个符号链接，因为它的位置在 PATH 环境变量中。Cygwin 将 /usr/bin 添加到 PATH 环境变量中。但是，Maven 无法找到 Python。例如

```
[ERROR] Failed to execute goal org.codehaus.mojo:exec-maven-plugin:1.2.1:exec (default) on project cloud-devcloud: Command execution failed. Cannot run program "python" (in directory "C:\cygwin\home\myuser\incubator-cloudstack\tools\devcloud"): CreateProcess error=2, The system cannot find the file specified -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException 
```

但是 Python 在那里：

```
$ which python
/usr/bin/python 
```

尽管作为符号链接。

```
$ ls -al /usr/bin/python
lrwxrwxrwx 1 donall Domain Users 13 Sep 19 11:38 /usr/bin/python -> python2.6.exe 
```

Python是符号链接的问题吗？或者 Maven 无法访问 /usr/bin 中的文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:09:46.877

It seems like maven is running as a regular Windows-native application, not a "cygwin-aware application" (if such thing exists :-) )

This is indicated by the path used internally, which is printed in the log: C:\cygwin\home\myuser\incubator-cloudstack\tools\devcloud

For this reason the call from Maven will not recognize the cygwin path when locating the python executable. One possible solution is to add the directory containing python.exe to the system PATH (which means, the Windows PATH variable)

# hibernate - AspectJ 和 Wicket 为 Injector 抛出空指针

> ID：13070295
> 
> 赞同：1
> 
> 时间：2012-10-25T14:00:19.960
> 
> 标签：hibernate, wicket, aspectj

我有使用休眠注释类并使用 DAO 服务层的 wicket aspectj 应用程序。

我开发了一个不在应用程序上下文中运行的更新任务。因此，我创建了一个 main 方法并将上下文加载为全局变量。

```
public static void main(String[] args) throws Exception
{
    context = new ClassPathXmlApplicationContext(LOCATIONS);
    XS2RAWebApp webApp = new XS2RAWebApp() {
        @Override
        public void init() {
            getComponentInstantiationListeners().add(new SpringComponentInjector(this, context,true));
        }
    };
    ThreadContext.setApplication(webApp);
    ResponseUpdateTask updatetask = new ResponseUpdateTask();

    updatetask.run();
} 
```

如您所见，SpringComponentInjector 提供了一个 springcomponent 注入器。

在这个更新任务中，我想用休眠保存一些数据。

我有 Hibernate 实体，在这个实体中我有对我的服务 DAO 的引用。

```
@MappedSuperclass()
public abstract class Entiteit {
    private static final Logger log = LoggerFactory.getLogger(Entiteit.class);

    @SpringBean()
    @Transient
    private transient DataAccessHelper daoHelper;
    ...
    public DataAccessHelper getDaoHelper() {
    if (daoHelper== null) {
        Injector.get().inject(daoHelper);
    }
    return daoHelper;
  }
} 
```

我尝试过的事情

1.  只需使用 Mockapplication 并添加新的新 SpringComponentInjector(this, context,true)，这会导致异常告诉我对应用程序进行初始化 (Allication.init())
    1.  试错解决方案

我知道我尝试过的似乎并不多，但我现在真的没有选择：S

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T15:48:13.480

您需要注册一个应用程序，该应用程序具有指向 ServetContext 和 WicketFilter 的链接。这可以通过编程方式完成：

```
public static void main(String[] args) throws Exception
{
    context = new ClassPathXmlApplicationContext(LOCATIONS);
    XS2RAWebApp webApp = new XS2RAWebApp() {
        @Override
        public void init() {
            getComponentInstantiationListeners().add(new SpringComponentInjector(this, context,true));
        }
    };
    ThreadContext.setApplication(webApp);
    webApp.setServletContext(new MockServletContext());
webApp.setWicketFilter(new WicketFilter(webApp));
webApp.initApplication();

    ResponseUpdateTask updatetask = new ResponseUpdateTask();
    updatetask.run();
} 
```

# asp.net-mvc - 域的 AntiForgery 令牌

> ID：13070301
> 
> 赞同：1
> 
> 时间：2012-10-25T14:00:33.337
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

我在 IIS 上有两个应用程序 - A 和 B。我想从应用程序 A 向 B 提交表单。不幸的是，由于防伪密钥和 cookie 名称中包含 apppath，我无法在两个应用程序之间共享 cookie 和输入。有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T21:01:54.923

*在application.config*文件中设置相关键。

查看相关答案：[https ://stackoverflow.com/a/1577227/290343](https://stackoverflow.com/a/1577227/290343)

# php - PHP数组文件插入MySQL

> ID：13070302
> 
> 赞同：1
> 
> 时间：2012-10-25T14:00:34.150
> 
> 标签：php, mysql, arrays, insert

如何将其插入数据库？

我有这个文件：

```
[player_id] => 70658
[mobile_number] => 09********
[name] => gorbani
[password] => ******
[verification_code] => KUTY6U
[subscription] => 0
[gold] => 147350
[date_joined] => 2011-04-26 20:02:40
[free_spin] => 0
[player_status] => 1
[scriptedSpin] => PLG
[message_flag] => N
[gold_award] => 0 
```

这只是一个文本文件中 300,000 个或更多条目中的 1 个条目。我需要自动插入ff。进入一个mysql db，其中只有

```
mobile_number
name
password
gold 
```

将被取出并插入。

谢谢你。

问候， Mehihi

这就是文件的格式：

```
[player_id] => 70658
[mobile_number] => 09********
[name] => gorbani
[password] => ******
[verification_code] => KUTY6U
[subscription] => 0
[gold] => 147350
[date_joined] => 2011-04-26 20:02:40
[free_spin] => 0
[player_status] => 1
[scriptedSpin] => PLG
[message_flag] => N
[gold_award] => 0

[player_id] => 70659
[mobile_number] => 09********
[name] => gorbani2
[password] => ******
[verification_code] => 22222
[subscription] => 0
[gold] => 147350
[date_joined] => 2011-04-26 20:02:40
[free_spin] => 0
[player_status] => 1
[scriptedSpin] => PLG
[message_flag] => N
[gold_award] => 0 
```

等等..

我试过这个但没有用：

```
$sql = array(); 
foreach( $myarray as $row ) {
$sql[] = '('.$row['ID'].', "'.mysql_real_escape_string($row['NAME']).'","'.$row['PRICE'].'")';}
mysql_real_query('INSERT INTO table (ID, NAME,PRICE) VALUES '.implode(',', $sql)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:07:17.747

当您将拥有关联数组时，请执行以下操作：

首先准备一个 SQL 查询。

```
$sql = "INSERT INTO ".$table." ("; 
for ($i=0; $i<count($arr); $i++)
{ 
  $sql .= key($arr); 
  if ($i < (count($arr)-1))
  { 
    $sql .= ", "; 
  } else $sql .= ") "; 
  next($arr); 
} 
reset($arr); 
$sql .= "VALUES ("; 
for ($j=0; $j<count($arr); $j++)
{ 
  $sql .= "'".current($arr)."'"; 
  if ($j < (count($arr)-1))
  { 
    $sql .= ", "; 
  } else $sql .= ") "; 
  next($arr); 
} 
```

现在，由于您将 SQL 查询存储在 $sql 中，您只需在首选方法中执行查询。

注意： mysql_query 已被弃用，您应该使用 PDO 或其他东西。

# android - android：如何显示存储在媒体服务器上的媒体文件的 URL 与 cling upnp 堆栈

> ID：13070304
> 
> 赞同：0
> 
> 时间：2012-10-25T14:00:41.793
> 
> 标签：android, url, upnp

我正在使用 Cling upnp stack java，并使用我的 android 控制点检测所有 upnp 设备，然后浏览媒体服务器并列出媒体文件（视频、音频 ..）。此代码显示我单击它的文件的名称（videoname.mp4），我想显示所有 URL，如（192.168.1.2:9000/video/videoname.mp4）

我怎样才能做到这一点 ？

```
public void onServiceConnected(ComponentName className, IBinder service) {
        upnpService = (AndroidUpnpService) service;
        getListView().setOnItemClickListener(new AdapterView.OnItemClickListener()
            {
                @Override
                public void onItemClick(AdapterView<?> parent, View view, int position,
                        long id) {
                    // TODO Auto-generated method stub
                    ServerContent item = listAdapter.getItem(position);
                    Log.e("onitemclick","listadapter");
                    item.select();
                    Log.d(item.toString(),"test 1");
                    Log.e(item.getClass().getSimpleName(),"test 2");
                }
            });
            browseServer("0");

        } 
```

# javascript - 如何使用 JavaScript 在 iframe 中引用框架集？

> ID：13070305
> 
> 赞同：0
> 
> 时间：2012-10-25T14:00:45.723
> 
> 标签：javascript, html, iframe, frames

无法弄清楚我做错了什么（除了使用:-P的框架）。

```
<script type="text/javascript">
    var cols = the_set.cols; //works within frameset.html
    var cols = frames['set_iframe'].the_set.cols; // doesn't work within parent
    var cols = document.getElementById('set_iframe').the_set.cols; // doesn't
    var cols = document.getElementById('set_iframe').getElementById('the_set').cols; // doesn't
</script>

<!--parent.html-->
<iframe id="set_iframe" name="set_iframe" src="frameset.html">

<!--farmeset.html-->
<frameset name="the_set" id="the_set" cols="180,*">
    <frame id="left" name="left">
    <frame id="right" name="left">
</frameset> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:04:25.000

尝试：

```
 var cols = frames['set_iframe'].contentWindow.document.the_set.cols; 
```

# javascript - 多个 ajax 调用延迟 jquery - 如果一个调用失败，有没有办法不拒绝

> ID：13070306
> 
> 赞同：0
> 
> 时间：2012-10-25T14:00:46.767
> 
> 标签：javascript, jquery, ajax, deferred

嗨，我正在执行多个 ajax 调用，并想结合使用以下代码的结果：

```
 var args = [
$.ajax({
    url:"http://localhost:8080/200/2",
    type:"get",
    dataType:"jsonp"
}),
$.ajax({
    url:"http://localhost:8080/200/1",
    type:"get",
    dataType:"jsonp"
})
    ];

    jQuery.when.apply(this, args)
    .done(function(){
        for (var i = 0; i < arguments.length; i++) {
                var singleResult = arguments[i]; 
                console.log("always");
                console.log(singleResult);
                                    //here code to combine results
        }
    })
    .fail(function(){
        for (var i = 0; i < arguments.length; i++) {
                var singleResult = arguments[i]; 
                console.log("fail");
                console.log(singleResult);
        }
    }); 
```

当两个调用都返回 200 状态代码时，它工作得非常好，但在当前系统中，有时一个调用可能会返回 500 或 404 当这种情况发生时，整个承诺被拒绝并完成更新称为我知道这是默认行为 - 当一个打电话失败，整个事情都失败了

问题：有没有一种简单的方法让它以这种方式工作，单个失败不会导致整个事情失败换句话说，假设我触发了 10 个调用，7 个成功 3 个失败我希望使用这 7 个结果调用 done ，并以 3 个结果失败

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:56:52.113

好的，我已经通过采用“何时”实现并创建自己的版本来解决它

```
 $.extend({
when2: function( subordinate /* , ..., subordinateN */ ) {
    var i = 0,
        resolveValues = Array.prototype.slice.call( arguments ),
        length = resolveValues.length,

        // the count of uncompleted subordinates
        remaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,

        // the master Deferred. If resolveValues consist of only a single Deferred, just use that.
        deferred = remaining === 1 ? subordinate : jQuery.Deferred(),

        // Update function for both resolve and progress values
        updateFunc = function( i, contexts, values ) {
            return function( value ) {
                contexts[ i ] = this;
                values[ i ] = arguments.length > 1 ? Array.prototype.slice.call( arguments ) : value;
                if( values === progressValues ) {
                    deferred.notifyWith( contexts, values );
                } else if ( !( --remaining ) ) {
                    deferred.resolveWith( contexts, values );
                }
            };
        },

        progressValues, progressContexts, resolveContexts;

    // add listeners to Deferred subordinates; treat others as resolved
    if ( length > 1 ) {
        progressValues = new Array( length );
        progressContexts = new Array( length );
        resolveContexts = new Array( length );
        for ( ; i < length; i++ ) {
            if ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {
                resolveValues[ i ].promise()
                    .done( updateFunc( i, resolveContexts, resolveValues ) )
                    //.fail( deferred.reject )
                    // here is the modified line
                    .fail( updateFunc( i, resolveContexts, resolveValues ) )
                    .progress( updateFunc( i, progressContexts, progressValues ) );
            } else {
                --remaining;
            }
        }
    }

    // if we're not waiting on anything, resolve the master
    if ( !remaining ) {
        deferred.resolveWith( resolveContexts, resolveValues );
    }

    return deferred.promise();
}
    });

    jQuery.when2.apply(this, args)
         .then(function(){
            var combinedResults = {};
            for (var i = 0; i < arguments.length; i++) {
                var singleResult = arguments[i]; 
                console.log(singleResult);
                if(singleResult[1]==="success"){
                    for(var serviceName in singleResult[0]){
                        combinedResults[serviceName] = singleResult[0][serviceName];
                    }
                }
            }
            console.log(combinedResults);
        }); 
```

});

以这种方式，何时将始终完成所有结果传递给 then 的参数是数组，每个数组都包含树值，其中第二个是您可以确定调用成功或失败的状态

我已经将我的测试代码放在了 github 上，它有一个小的 nodejs 服务器，它返回不同的 http 状态代码用于测试目的。

[https://github.com/szydan/test-jquery-defered](https://github.com/szydan/test-jquery-deffered)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-24T20:52:11.207

您可能希望手动处理您的承诺以始终解决，只是有时带有错误对象或消息。就像是

```
var deferreds = [];
for(i = 0; i < 10; i++) {
  var defer = $.Deferred();
  deferreds.push(defer)
  $.ajax(/* options */)
  .then(function(res) {
    defer.resolve(res);
  }, function(err) {
    defer.resolve(err);
  })
}

$.when(deferreds)
.then(function() {
  var results = Array.prototype.slice.call(arguments);
  // do something with results
}); 
```

# mysql - 索引两列表的所有字段

> ID：13070307
> 
> 赞同：0
> 
> 时间：2012-10-25T14:00:47.453
> 
> 标签：mysql, mongodb, indexing, database-design, database

我有一个表/模式，其中有两列名为**day**的*DateTime*和**user_id**的*Integer*。知道我把两列都编入索引了。

考虑到索引使用的额外空间的很大一部分并且只有两列，从索引中获得的性能改进是否值得？你如何为他们辩护？

如果我使用 MongoDB 或 MySQL，这有什么不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T18:02:31.353

如果行数很少，您可能看不到索引有很大的改进。如果有很多行，您可能会看到很大的改进。

好处是您不必猜测，也不必为*少数*和*多数*在实践中的含义而苦恼。每个现代 SQL dbms 都包含一些测量 SELECT 语句性能的方法。这包括 MySQL。

*   [MySQL 解释](http://dev.mysql.com/doc/refman/5.6/en/explain.html)
*   [如何使用它](http://dev.mysql.com/doc/refman/5.6/en/using-explain.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T13:41:45.580

> 从索引中获得的性能改进是否值得

取决于您打算运行的查询。

*   如果你有类似: 的东西`WHERE day = ...`，那么你需要一个索引，其**前沿**包含`day`. 如果使用得当，索引可以将查询速度提高许多数量级，尤其是在大型数据集上。
*   OTOH，每个额外的索引都会消耗空间/缓存和 INSERT/UPDATE/DELETE 性能。

归根结底，我建议您根据实际数据量进行**衡量**并得出自己的结论。

*顺便说一句，如果您使用 InnoDB，那么您的表是[聚集](http://use-the-index-luke.com/sql/clustering/index-organized-clustered-index)的（另请参阅：[了解 InnoDB 聚集索引](http://www.ovaistariq.net/521/understanding-innodb-clustered-indexes/)）并且整个表有效地存储在主索引中。聚集表中的二级索引包含 PK 字段的副本，（我假设）`user_id`在这种情况下。由于我们在表中只有两个字段，因此 { `day`} 上的二级索引也将覆盖它们`user_id`，从而避免在聚集表中可能发生的双重查找。实际上，无论您访问其中哪一个（这很好），您最终都会得到两个独立（但同步）的 B 树和一个[仅索引扫描。](http://use-the-index-luke.com/sql/clustering/index-only-scan-covering-index)当然，您可以在 { `day`, `user_id`} 上显式创建复合索引，而不仅仅是 {`day`}，以获得非常相似的效果。*

# html - 让孩子处于父母的 100% 高度且溢出：自动

> ID：13070308
> 
> 赞同：2
> 
> 时间：2012-10-25T14:00:47.893
> 
> 标签：html, css, scroll, height

我正在尝试在包含在固定宽度和高度父级中的元素列表上制作一个蒙版。父级设置为溢出：自动。当我们向列表中添加元素时，父级滚动，但掩码保持其原始高度，我希望它一直填充父级直到滚动的底部。

这是我的代码的简化版本：

[http://jsfiddle.net/Z7sRh/](http://jsfiddle.net/Z7sRh/)

html:

```
<div id="test">
<div id="mask">&nbsp;</div>
<ul>
    <li>Element</li>
    <li class="over">Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
    <li>Element</li>
</ul>
</div> 
```

CSS：

```
#test{
width:150px;
height:200px;
background-color:#eee;
overflow:auto;
position:relative;
}
#mask{
background-color:rgba(0,0,0,.3);
min-height:100%;
width:100%;
position:absolute;
top:0;
left:0;
bottom:0;
z-index:1;
}
li{
background-color:white;
}

.over{
position:relative;
z-index:2;
} 
```

有些元素需要覆盖掩码，并且可以接受 javascript 解决方案，尽管 html/css 更好。

我在网上搜索了一个答案，找不到答案，希望你们能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:12:07.217

[http://jsfiddle.net/Z7sRh/3/](http://jsfiddle.net/Z7sRh/3/)

```
$('#mask').css('height', $('ul').css('height') );​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:06:49.717

查询：

```
$('#mask').height($('#test')[0].scrollHeight); 
```

JavaScript（直接）

```
document.getElementById('mask').style.height = document.getElementById('test').scrollHeight + 'px'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:07:03.493

你不是把这件事复杂化了吗？将 overs 背景颜色设置为白色，将 li 设置为灰色。结果相同，无论有多少元素。是否有某些原因需要额外的 div 和代码？ [http://jsfiddle.net/calder12/Z7sRh/2/](http://jsfiddle.net/calder12/Z7sRh/2/)

```
li{
 background-color:rgba(0,0,0,.3);
}

.over{
background-color:white;
} 
```

# ios5 - NSURLConnection 在 iOS 6 上正常工作，但在早期版本上不能正常工作

> ID：13070309
> 
> 赞同：1
> 
> 时间：2012-10-25T14:00:54.820
> 
> 标签：ios5, xcode4.2, ios6, nsurlconnection, nsurlrequest

我最初使用 XCode 4.5 创建了一个项目，但后来我将相同的代码移至 XCode 4.2。

我的代码在所有模拟器上运行良好，包括最新的 iOS6，但在设备上它只适用于 iOS6 而不是早期版本。

当我使用一些参数向服务器发送请求时，它返回一个错误“缺少参数”。（我认为在 iOS 5 和 6 上创建的请求方式不同，但不确定）

这是代码：

```
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
    NSURL *requestURL = [NSURL URLWithString:[urlString stringByAddingPercentEscapesUsingEncoding: NSUTF8StringEncoding]];

    [request setURL:requestURL];
    [request setHTTPMethod:@"post"];

    NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

    NSMutableData *body = [NSMutableData data];

    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"type_id\"\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"%@",type_poboq] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];

    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"signin_data\"\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"%@",jsonVal] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];

    [request setHTTPBody:body];

    [NSURLConnection sendAsynchronousRequest:request 
                                       queue:[NSOperationQueue mainQueue]
                           completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
                               if(error.localizedDescription == NULL)
                               {
                                   NSString *returnString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];

                                   [delegate ConnectionDidFinishLoading:returnString];
                               }
                               else
                               {
                                   NSString *returnString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];

                                   [delegate ConnectiondidFailWithError:returnString];
                               }

                           }]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T09:49:21.787

显然边界存在一些问题，我改用以下行并且它起作用了。

```
NSString *boundary = @"---------------------------14737809831466499882746641449"; 
```

# c - 输入超出范围的 char 数字时程序立即退出

> ID：13070318
> 
> 赞同：1
> 
> 时间：2012-10-25T14:01:24.020
> 
> 标签：c, integer, char, exit

我有一个用 C 编写的程序。以下是该程序的一个片段：

```
signed char answer;

printf("----Technology Quiz----\n\n");
printf("The IPad came out in which year?\n");
printf("Year: ");
scanf("%c", &answer);
printf("\n\n");
printf("The answer you provided was: %c\n\n", answer); 
```

这不是整个程序。在这段代码之后，有一个检查来验证用户是否猜到了年份。

如您所见，用户永远猜不到答案，因为有符号字符只接受从 -128 到 127 的输入。这是故意的。

这个程序的问题在于，如果用户输入了超出字符范围的数字，程序就会立即退出。程序的行为就像最后没有 getchar() 一样，即使有。请问我该如何解决这个问题？

**编辑**

如果输入超出范围，则程序的行为类似于用户忘记在末尾包含 getchar() 的应用程序。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T14:04:18.080

```
scanf("%c", &answer); 
```

只从输入流中获取一个字符，因此如果用户输入年份，例如 1952，则在将“1”分配给`answer`（952 和“\n”）之后，输入流中还有 4 个字符。

所以除非你`getchar()`最后有足够的 s ，否则有足够的剩余输入来立即满足它们。

如果要将 123 形式的输入转换为 a `signed char`，则应使用`%hhd`格式，

```
scanf("%hhd", &answer); 
```

但`scanf`不检查溢出，因此输入超出范围的值会导致未定义的行为（有符号整数溢出）。要获得溢出控制，您应该将一行（或其中的一部分）读入缓冲区，

```
char buf[30];
fgets(buf, sizeof buf, stdin); 
```

并手动解析输入。不幸的是， 没有标准转换`strtoxy`，`signed char`因此您应该使用`strtol`将输入转换为 a `long`，然后检查超出范围的值。

# cocoa - 获取核心数据对象，其中一对多关系包含集合中的所有对象

> ID：13070319
> 
> 赞同：0
> 
> 时间：2012-10-25T14:01:29.010
> 
> 标签：cocoa, core-data, nspredicate, nsfetchrequest

我正在寻找的是一种简洁的方法来获取由其关系唯一标识的核心数据对象。例如，给定数据模型：

![在此处输入图像描述](../Images/1cd121fa1587bb579d7603c44092de7b.png)

...并给定一组`NSManagedObject`节点，我想获取一个三角形，或者至少知道一个 TriangleEntity 是否存在，如下所示：

```
NSSet *nodeSet = // a set of 3 NSManagedObject*s
NSFetchRequest *request = [[NSFetchRequest alloc] initWithEntityName:@"TriangleEntity"];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"corners CONTAINS ALL %@", nodeSet]; 
```

我认为这`CONTAINS ALL`不是正确的语法——而且我知道我可以解压 NSSet 并获取

```
@"corners CONTAINS %@ AND corners CONTAINS %@ AND corners CONTAINS %@", setObj1, setObj2, setObj3 
```

......但这似乎很愚蠢。有没有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:31:23.323

以下谓词查找所有角都在给定集合中的三角形：

```
[NSPredicate predicateWithFormat:@"ALL corners IN %@", nodeSet] 
```

`nodeSet`可以是一个`NSSet`或一个`NSArray`。

# php - Chrome不会显示当前图像/真的很奇怪

> ID：13070320
> 
> 赞同：0
> 
> 时间：2012-10-25T14:01:32.697
> 
> 标签：php

就在 30 分钟前，我遇到了一个非常出乎意料的问题（事实上，这是我一生中第一次发生在我身上，也是在 10 年的网站编码中）。

在我的管理模块的特定页面上，很少有图像恢复到原来的状态，就像几天前一样。这意味着我昨天改变了它们，现在它们看起来都像以前一样。

它变得更加奇怪。我使用 Filezilla 登录，并删除了图像。在我更改它们之前，它们仍然以 3 天前的样子出现。

如果我转到图像的 URL，它仍会显示旧图像。如果我在本地的 Windows 文件夹中查看它们是新版本，请再次上传它们，但浏览器仍然显示旧版本。

我删除了 Chrome 中的缓存，甚至重新启动了计算机，认为这与 Chrome 或其他东西有关，我真的没有选择。Firefox 显示相同的旧图像（即使我上传了新版本的图像）。

我尝试使用 CPanel FTP 管理器，然后......惊喜......如果我看一张图片，它是图片的好版本（新的！）。但是所有浏览器都看不到图像。同样作为一个关键点，如果我用 ftp 擦除图像，浏览器仍然可以看到它（SHIFT + f5，它仍然可以看到它，所以它不是来自缓存）。？！？！

任何指出问题的人都非常感谢。干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:08:24.877

Sounds like your hosting provider has a reverse proxy that caches requests for images. One way to overcome the problem is to add something to the URL, perhaps a request parameter, that makes the proxy think that the request is not for the same image.

For example, [http://www.example.com/yourimage.png?date=2012-10-25](http://www.example.com/yourimage.png?date=2012-10-25)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:18:08.540

听起来托管服务提供商把你搞砸了，所以我想说第一步是将它们转储并转移到其他地方......

但是如果 Joni 的建议不起作用，您可以在服务器上动态构建图像，例如：

```
<img src="imageHandler.php?image=myimage.png" /> 
```

您的 imageHandler.php 代码需要读取图像的字节，并手动构建 HTTP 响应并将图像字节传回。不确定在 PHP 中会是什么样子，但它不应该超过几行代码。

这是一个糟糕的解决方案，因为它需要大量的处理和磁盘访问来完成像拉图像这样的琐碎任务，但我希望它至少可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T06:54:39.897

这是我第一次回答我自己的问题，因为它与外部因素有关。

是的，问题已解决，实际上是技术人员。部门 在 ISP 我托管了文件，我的域 xxx.net 的虚拟主机配置文件是 ..misconfigured。

大家加油，问题解决了

# .net - 反转窗体上所有控件的 Z 顺序

> ID：13070325
> 
> 赞同：2
> 
> 时间：2012-10-25T14:01:39.033
> 
> 标签：.net, winforms, z-order

我正在尝试对应用程序中打开的某些表单进行屏幕截图。这些表格可能被其他开放表格覆盖/遮盖。使用 CopyFromScreen 是不切实际的。在表单级别使用*DrawToBitmap*让我非常接近我想要的位置。

*将DrawToBitmap*与控件一起使用的一个[问题](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.drawtobitmap.aspx)是：

 *> 容器内的控件以相反的顺序呈现。

**症状：** 表格 A 上有控件 B 和控件 C。*如果在 Form A 上调用DrawToBitmap*时 Control B 在 Control C 前面，它会先绘制 Control B 然后再绘制 Control C。由于 Control C 是在 Control B 之上绘制的，因此生成的位图看起来像 Control C 在前面控制 B。

我目前的计划是：

1.  调用*SuspendLayout*
2.  递归反转窗体上所有控件的 Z-Order
3.  调用*ResumeLayout*
4.  调用*DrawToBitmap*，它将创建一个显示正确顺序的图像
5.  再次执行步骤 1、2 和 3，将所有内容恢复到原来的状态。

那个听起来是对的吗？

我很确定我可以使用*ctrl.Parent.Controls.GetChildIndex(ctrl)*来获取当前的 Z-Order 索引，然后使用*SetChildIndex*进行类似的调用以将其设置为新值。

现在我正在寻找可以帮助我以尽可能高效的方式完成重新排序部分的代码示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:39:15.607

试试这个：

```
For Each ctl As Control In Me.Controls.OfType(Of Control).OrderBy(Function(c) Me.Controls.GetChildIndex(c))
  ctl.BringToFront()
Next 
```

然后再次运行同样的事情，将其恢复：

如果您的表单上有嵌套控件，您可能希望[将此树线性化为一个数组](http://www.neolisk.com/techblog/vbnet-get-all-controls-of-specified-type-from-controlcollection-tree)，以便于处理（即不需要递归）。*

# c# - 如何在 NHibernate 会话中保存两个相等的对象？

> ID：13070327
> 
> 赞同：3
> 
> 时间：2012-10-25T14:01:38.750
> 
> 标签：c#, nhibernate, fluent-nhibernate, cascade

我有以下对象结构（简化）：

```
MainObject
  Person PersonA
  Person PersonB
Person
  string Name
  Status Status 
```

基本上，我`MainObject`可以容纳两个`Person`物体。对象将`Person`（对于此业务案例）始终是不同的对象，但`Status`每个对象上的对象`Person`可能引用相同的对象`Status`（例如，它们可能都处于 DocumentsUploaded 状态）。

由于我使用的是 Fluent NHibernate，当我尝试保存 a`MainObject`当两个`Person`s 具有相同时，我得到以下异常`Status`： **具有相同标识符值的不同对象已与会话相关联**。这是有道理的，因为两个`Status`对象是相同的。

当我用谷歌搜索该错误时，我大多发现有人在他们的会话中错误地获得了相同的标识符（我想*故意*这样做）。

我还考虑将`Status`字段更改`Person`为整数，但感觉不对（如果你愿意的话，不是面向对象的）。

**问题：**有什么方法可以解决这个问题，有什么方法可以告诉 NHibernate，是的，我知道它们具有相同的标识符，但我还是想保存它？如果不是，这是不可能的原因是什么？您的建议是什么？

以防万一；

这是我的存储库中的代码：

```
public void Save<T>(T entity) where T : DomainEntity
{
    using (var session = _sessionSource.CreateSession())
    {
        using (var transaction = session.BeginTransaction())
        {
            session.SaveOrUpdate(entity);
            transaction.Commit();
        }
    }
} 
```

( `MainObject`,`Person`并且`Status`所有继承`DomainEntity`和一切工作正常，除了上面描述的场景)

**编辑：加载代码**

`Status`这是在 s 上的每个`Person`s 上加载 s 的简化代码`MainObject`：

```
_mainObject.PersonA.Status = _repository.GetStatus(StatusCode.NotSet);
_mainObject.PersonB.Statys = _repository.GetStatus(StatusCode.NotSet); 
```

这是存储库中 GetStatus 的简化代码：

```
public Status GetStatus(StatusCode statusCode)
{
    return Repository.Query<Status>(x => x.StatusCode == statusCode).FirstOrDefault();
} 
```

这是查询的代码：

```
public List<T> Query<T>(Expression<Func<T, bool>> expression) where T : DomainEntity
{
    using (var session = _sessionSource.CreateSession())
    {
        using (var transaction = session.BeginTransaction())
        {
            var result = session.Query<T>().Where(expression);
            transaction.Commit();
            return result.ToList();
        }
    }
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T11:33:32.737

我认为问题在于会话的微观管理。如果您有一个涵盖所有数据库事务的会话，我相信您不会遇到问题。

如果项目是 Web 服务，我建议您将会话创建/处置与 http 请求联系起来。

# c++ - 有没有一种简单的方法可以将 C++ 对象添加到现有的 Objective-C Cocoa 应用程序中

> ID：13070328
> 
> 赞同：0
> 
> 时间：2012-10-25T14:01:41.070
> 
> 标签：c++, objective-c, xcode, cocoa

我正在努力弄清楚如何将 C++ 类添加到我正在编写的 Cocoa 应用程序中。

我了解默认情况下 Cocoa 应用程序被编译为 Objective-C，并且 Objective-C 是 C 而不是 C++ 的超集。

我尝试将我的 Objective-C 类上的文件类型设置为`Objective-C++ Source`并将它们重命名为`.mm`文件，但我的 C++ 类声明仍然出现错误。

是否有一种简单/直接的方法可以在可可项目中包含现有的 c++ 源代码？还是我应该只用objective-c重写我的C++对象？

**更新**：

好吧，事实证明我错了。当我尝试使用 Objective-C 编译项目时，我得到了错误：

> 未知类型名称 class 你的意思是 Class

然后，当我将 Cocoa 源更改为 Objective-C 时，我得到了一个完全不同的错误。所以这个问题就解决了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:13:42.647

> 是否有一种简单/直接的方法可以在可可项目中包含现有的 c++ 源代码？还是我应该只用objective-c重写我的C++对象？

这正是 Objective-C++ 让你做的——你可以一起使用 C++ 对象和 Objective-C 对象。请记住，您仍然需要使用 Obj-C 语法向 Obj-C 对象发送消息，并使用 C++ 语法来调用 C++ 对象的方法。但是如果你这样做了，你的 C++ 和 Objective-C 对象应该可以很好地协同工作。如果您仍然遇到问题，我们可能会帮助您解决一些具体问题；编辑您的问题以包含特定错误和导致它们的代码。

# ios - mapview-ios 滚动的边界

> ID：13070331
> 
> 赞同：0
> 
> 时间：2012-10-25T14:01:50.290
> 
> 标签：ios, cocoa-touch, mkmapview, region

> **可能重复：**
> [MKMapView - 将地图滚动限制为方形覆盖](https://stackoverflow.com/questions/11152244/mkmapview-limit-map-scroll-to-a-square-overlay)

有没有办法限制地图的滚动只在特定国家（地区）的边界内滚动？先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:07:44.273

该`MKMapViewDelegate`协议有一个`-mapView:regionWillChangeAnimated:`可以在地图委托中实现的方法。不幸的是，它不是`...ShouldChangeAnimated:`，因此您无法返回`NO`以阻止更改，但是您*可以*做的是在用户滚动超出您要显示的区域时自己设置地图区域。

# php - mySql 检索方括号之间的数据

> ID：13070332
> 
> 赞同：0
> 
> 时间：2012-10-25T14:01:54.960
> 
> 标签：php, mysql, regex

我在名为 的字段中有数据字符串`content`，一条记录可能类似于：

```
loads of text ... [attr1] some text [attr2] more text [attr3] more text etc... 
```

我要做的是获取方括号内的所有文本；这样我就可以将其放入 PHP 数组中。这甚至可以用 mySql 实现吗？

我看过以下帖子：[希望通过 MYSQL 在字符串中的括号之间提取数据](https://stackoverflow.com/questions/8072402/looking-to-extract-data-between-parentheses-in-a-string-via-mysql)，但他们只想从括号之间提取一个值，我的数量未知。读完那篇文章后，我想做类似以下的事情；

```
SELECT substr(content,instr(content,"["), instr(content,"]")) as attrList from myTable 
```

这会抓住我以下几点：

```
[attr1] some text [attr2] some more text [attr3] 
```

我可以使用 PHP 去除其余的文本，然后将字符串分解成一个数组，但是有没有更好的方法来做到这一点，只使用 mySql 我可以检索如下内容：

```
[attr1][attr2][attr3] 
```

我在想也许是正则表达式，但我看到它只返回一个 false 的 true，这对我没有多大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:33:25.883

经过更多研究，我不确定在 mySql 中是否可行，并且我可能需要字符串或数组形式的结果，具体取决于我在应用程序中使用它们的位置。

所以我创建了一个新方法来在从数据库中获取数据后返回列表（在这篇文章的帮助下：[PHP：在方括号之间捕获文本](https://stackoverflow.com/questions/10104473/php-capturing-text-between-square-brackets#10104517)）：

```
public function attrList($array=false)
{
    preg_match_all("/\[.*?\]/",$this->content,$matches);

    $params = str_replace(array('[',']'),'',$matches[0]);

    return ($array===false) ? implode(', ',$params) : $params;
} 
```

# objective-c - 仅在参数更改时才在实例方法中处理代码

> ID：13070334
> 
> 赞同：0
> 
> 时间：2012-10-25T14:01:58.640
> 
> 标签：objective-c, ios, oop, class, design-patterns

我有一些方法需要一些时间来处理获取数据、执行计算然后返回结果，例如这个实例方法返回一个基于三个参数的数组：

```
-(NSArray*)periodsForCompanies:(NSArray*)companies figureType:(NSString*)figureType
actualValuesOnly:(BOOL)actualValuesOnly
    {.. }; 
```

由于此方法可以使用同一类的相同参数多次调用并且需要一些时间才能完成，因此我想优化我的代码以避免每次都完全执行此方法的代码。

我如何将先前的参数（和/或结果）存储在方法中，以便能够将当前参数与先前的参数进行比较并决定是否需要再次执行代码？在这种情况下，什么是“最佳实践”？

我的理解是，当调用该方法时，通常他方法中的所有变量都会重置为零和零。

# 编辑

根据要求，我添加了一个代码示例：

```
- (NSArray*)periodsForCompanies:(NSArray*)companies figureType:(NSString*)figureType actualValuesOnly:(BOOL)actualValuesOnly
{
    // fetch all periods

    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"IBEstPeriod"];
    NSPredicate *predicate = [[NSPredicate alloc]init];

    if (actualValuesOnly == YES)
        predicate = [NSPredicate predicateWithFormat:@"(company IN %@) AND (ANY estType.actValue != nil) AND (ANY estType.type == %@)", self.companies, figureType];
    else
        predicate = [NSPredicate predicateWithFormat:@"(company IN %@) AND (ANY estType.type == %@)", self.companies, figureType];

    request.predicate = predicate;
    request.resultType = NSDictionaryResultType;
    request.returnsDistinctResults = YES;
    request.propertiesToFetch = @[@"endCalYear",@"endMonth",@"periodLength"];
    request.sortDescriptors =
        @[[NSSortDescriptor sortDescriptorWithKey:@"endCalYear"     ascending:NO],
        [NSSortDescriptor   sortDescriptorWithKey:@"endMonth"       ascending:NO],
        [NSSortDescriptor   sortDescriptorWithKey:@"periodLength"   ascending:NO]];

    NSError *fetchError = nil;
    NSArray *results = [self.managedObjectContext executeFetchRequest:request error:&fetchError];

    NSMutableArray *distinctPeriods = results.mutableCopy;

    if (fetchError) {
        NSLog(@"Error during fetch request:%@", [fetchError localizedDescription]);
    } else {
        // NSLog(@"results: %@",results);
    }
    // remove periods for which not all companies have data for estimate type specified

    NSString const *endCalYearKey = @"endCalYear";
    NSString const *endMonthKey = @"endMonth";
    NSString const *periodLengthKey = @"periodLength";

    const NSIndexPath *yoyGrowthIndexPath =     [NSIndexPath indexPathForRow:0 inSection:0];
    const NSIndexPath *seqGrowthIndexPath =     [NSIndexPath indexPathForRow:1 inSection:0];
    const NSIndexPath *customGrowthIndexPath =  [NSIndexPath indexPathForRow:2 inSection:0];

    NSMutableIndexSet *indexesForPeriodsToRemove = [NSMutableIndexSet indexSet];

    [distinctPeriods enumerateObjectsUsingBlock:^(NSDictionary *estPeriodDict, NSUInteger idx, BOOL *stop) {

        NSNumber *endCalYear = estPeriodDict[endCalYearKey];
        NSNumber *endMonth = estPeriodDict[endMonthKey];
        NSNumber *periodLength = estPeriodDict[periodLengthKey];

        NSPredicate *predicate = [[NSPredicate alloc]init];
        UITableView *tableView = [self tableView];

        if ( [[tableView indexPathForSelectedRow] isEqual:customGrowthIndexPath] ) {

            // company predicate:

            predicate = [NSPredicate predicateWithFormat: @"ANY estimateType.type == %@ "
                         "AND SUBQUERY(estimatePeriod, $x, $x.endCalYear == %@ AND $x.endMonth == %@ AND $x.periodLength == %@ AND ANY $x.estType.type == %@).@count > 0",
                         figureType,
                         endCalYear, endMonth, periodLength, figureType];

        } else if ( [[tableView indexPathForSelectedRow] isEqual:yoyGrowthIndexPath] ) {

            predicate = [NSPredicate predicateWithFormat: @"ANY estimateType.type == %@ "
                         "AND SUBQUERY(estimatePeriod, $x, $x.endCalYear == %@ AND $x.endMonth == %@ AND $x.periodLength == %@ AND ANY $x.estType.type == %@).@count > 0"
                         "AND SUBQUERY(estimatePeriod, $x, $x.endCalYear == %i AND $x.endMonth == %@ AND $x.periodLength == %@ AND ANY $x.estType.type == %@).@count > 0",
                         figureType,
                         endCalYear, endMonth, periodLength, figureType,
                         endCalYear.integerValue - 1, endMonth, periodLength, figureType];

        } else if  ( [[tableView indexPathForSelectedRow] isEqual:seqGrowthIndexPath] ) {

            // TODO: rewrite
            predicate = [NSPredicate predicateWithFormat: @"ANY estimateType.type == %@ "
                         "AND SUBQUERY(estimatePeriod, $x, $x.endCalYear == %@ AND $x.endMonth == %@ AND $x.periodLength == %@ AND ANY $x.estType.type == %@).@count > 0",
                         figureType,
                         endCalYear, endMonth, periodLength, figureType];
        } else {
            [NSException raise:NSInternalInconsistencyException format:@"TableView: Invalid selection state in section 0 (NSIndexPath: %@)",super.tableView.indexPathForSelectedRow];
        }

        NSArray *companiesWithDataForPeriod = [self.companies filteredArrayUsingPredicate:predicate];
        NSLog(@"type: %@, period: %@/%@(%@), companies: %@", figureType, endCalYear, endMonth, periodLength,[companiesWithDataForPeriod valueForKey:@"contrSymbol"]);

        // mark periods which are not defined for all companies for removal (from display):
        if ( companiesWithDataForPeriod.count < self.companies.count ) [indexesForPeriodsToRemove addIndex:idx];

    }]; // end block

    [distinctPeriods removeObjectsAtIndexes:indexesForPeriodsToRemove];
    return distinctPeriods;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:31:45.207

您需要进行某种缓存，实际上您的参数可能会有很大差异，因为您有公司数组作为参数。如果您使用大量组合调用此方法，这可能会导致使用大量内存。

我会将其更改为仅通过单个公司，因此缓存会更小，而不是在最坏的情况下保留所有公司组合。

要将数据保存在缓存中，您可以创建一些`NSMutableDictionary`属性或静态值（记得在某处释放/清空它），然后作为键，您可以将这些参数组合在某个对象中或作为一个简单的字符串。

因此，您的方法的内部实现如下所示：

```
simpleString = .. combined arguments ...
NSArray *result = [dictionary objectForKey:simpleString]
if (result == nil)
{
    .. do fetch and put result in result
    [dictionary setObject:result forKey:simpleString];
}
return result; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:33:51.327

您想缓存获取的结果。

假设您只想在运行时缓存结果，并在重新启动应用程序时重新获取它们。在这种情况下，请使用内部类和`NSMutableDictionary`. 添加属性

```
@property (nonatomic, strong, readwrite) NSMutableDictionary *periodsForParameters; 
```

将以下类添加到您的源 ( `.m`) 文件中：

```
@interface PeriodRequestParameters : NSObject <NSCopying>
+ (PeriodRequestParameters *)parametersWithCompanies:(NSArray *)companies figureType:(NSString *)figureType actualValuesOnly:(BOOL)actualValuesOnly;
@property (nonatomic, strong, readwrite) NSArray *companies;
@property (nonatomic, strong, readwrite) NSString *figureType;
@property (nonatomic, assign, readwrite) BOOL actualValuesOnly;
- (BOOL)isEqualToPeriodRequestParameters:(PeriodRequestParameters *)comparand;
@end

@implementation PeriodRequestParameters

@synthesize companies, figureType, actualValuesOnly;

+ (PeriodRequestParameters *)parametersWithCompanies:(NSArray *)companies figureType:(NSString *)figureType actualValuesOnly:(BOOL)actualValuesOnly
{
    PeriodRequestParameters *res = [[PeriodRequestParameters alloc] init];
    res.companies = companies;
    res.figureType = figureType;
    res.actualValuesOnly = actualValuesOnly;
    return res;
}

- (BOOL)isEqualToPeriodRequestParameters:(PeriodRequestParameters *)comparand
{
    return ([self.companies isEqual:comparand.companies] &&
            [self.figureType isEqual:comparand.figureType] &&
            self.actualValuesOnly == comparand.actualValuesOnly);
}

// These methods are used by NSDictionary, so they must be overridden.
- (BOOL)isEqual:(id)object
{
    BOOL res = NO;
    if ([object isMemberOfClass:[PeriodRequestParameters class]]) {
        res = [self isEqualToPeriodRequestParameters:object];
    }
    return res;
}

- (NSUInteger)hash
{
    //This method can be made better, but this will work.
    return self.companies.hash;
}

//NSCopying

- (id)copyWithZone:(NSZone *)zone
{
    PeriodRequestParameters *res = [[PeriodRequestParameters allocWithZone:zone] init];
    res.companies = self.companies.copy;
    res.figureType = self.figureType.copy;
    res.actualValuesOnly = self.actualValuesOnly;
    return res;
}

@end 
```

此类为您提供了一种将传入的参数用作字典`periodsForCompanies:figureType:actualValuesOnly:`中的键的方法。`periodsForParameters`现在，在您获取结果后，您可以将获取的数组添加为键的对象，`[PeriodRequestParameters parametersWithCompanies:companies figureType:figureType actualValuesOnly:actualValuesOnly]`其中`companies`,`figureType`和`actualValuesOnly`是传递给 的参数`periodForCompanies:figureType:actualValuesOnly:`。

然后，每次调用时，首先检查缓存`periodForCompanies:figureType:actualValuesOnly:`中是否已经存在条目。`periodsForParameters`

您可以使用 an`NSDictionary`作为`periodsForParameters`字典中的键，但在我看来，使用自定义类的代码看起来更简洁：您不必处理多个字符串作为键或在检查是否有时手动构建字典缓存结果或将新获取的结果添加到缓存中时。

# android - 如何在 android 中为特定日期和时间设置 TimeZone？

> ID：13070335
> 
> 赞同：5
> 
> 时间：2012-10-25T14:02:02.117
> 
> 标签：android, datetime, calendar, timezone

我开发了一个应用程序，因为我需要保存事件的日期和时间。默认情况下，时间和日期采用“美国/芝加哥”时区格式。现在，我需要将它们转换为用户设备的时区格式。但我得到了错误的格式。

我做了以下。

```
SimpleDateFormat curFormater1=new SimpleDateFormat("MM-dd-yyyy-hh:mm a");//10-23-2012-08:30 am

curFormater1.setTimeZone(TimeZone.getTimeZone("America/Chicago")); 

curFormater1.setTimeZone(TimeZone.getDefault()); 
```

**当前输出：** TimeZone.getTimeZone("America/Chicago") 是 10-22-2012-10:00 PM TimeZone.getDefault() 是 10-23-2012-08:30 AM

**所需的输出** TimeZone.getTimeZone("America/Chicago") 是 10-23-2012-08:30 AM TimeZone.getDefault() 是 10-23-2012-07:00 PM

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T12:32:37.493

一些例子

[在时区之间转换时间](http://www.java2s.com/Code/Java/Development-Class/Converttimebetweentimezone.htm)

[在时区之间转换时间](http://www.exampledepot.com/egs/java.util/GetTimeOtherZone2.html)

```
 import java.util.Calendar;
       import java.util.GregorianCalendar;
       import java.util.TimeZone;

  public class TimeZoneExample {
      public static void main(String[] args) {

    // Create a calendar object and set it time based on the local
    // time zone

    Calendar localTime = Calendar.getInstance();
    localTime.set(Calendar.HOUR, 17);
    localTime.set(Calendar.MINUTE, 15);
    localTime.set(Calendar.SECOND, 20);

    int hour = localTime.get(Calendar.HOUR);
    int minute = localTime.get(Calendar.MINUTE);
    int second = localTime.get(Calendar.SECOND);

    // Print the local time

    System.out.printf("Local time  : %02d:%02d:%02d\n", hour, minute, second);

    // Create a calendar object for representing a Germany time zone. Then we
    // wet the time of the calendar with the value of the local time

    Calendar germanyTime = new GregorianCalendar(TimeZone.getTimeZone("Germany"));
    germanyTime.setTimeInMillis(localTime.getTimeInMillis());
    hour = germanyTime.get(Calendar.HOUR);
    minute = germanyTime.get(Calendar.MINUTE);
    second = germanyTime.get(Calendar.SECOND);

    // Print the local time in Germany time zone

    System.out.printf("Germany time: %02d:%02d:%02d\n", hour, minute, second);
}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-26T10:27:00.550

有同样的麻烦，但找到了出路。

TimeZone 默认设置为设备的时区。要更改此设置并将其设置为特定时区，请使用 getRawOffset() 属性。
此方法从当前时间计算毫秒数。因此，您可以添加指定时区的毫秒数并减去默认时区的毫秒数。

当我尝试将其更改为 timeZone 'GMT_ID'

```
values.put(CalendarContract.Events.DTSTART, startDate.getTime()  +TimeZone.getTimeZone(GMT_ID).getRawOffset() -TimeZone.getDefault().getRawOffset()); 
```

希望这可以帮助。

# actionscript-3 - 如何在 flex 中设置缓冲区设置？

> ID：13070337
> 
> 赞同：0
> 
> 时间：2012-10-25T14:02:06.860
> 
> 标签：actionscript-3, apache-flex, buffer

我应该如何在 flex swf 中引入缓冲区设置？我如何在 flex 中实现缓冲区设置。例如：

我使用下面的代码通过 netstream 设置缓冲时间

```
ns.bufferTime=0; 
```

但是播放延迟会在一段时间后发生变化。我只想在整个播放过程中保持恒定的延迟。

因为我想在actionscript中设置buffertime和我自己的所有buffersetting并测试它以找到播放视频的延迟。我想使用buffertime设置播放视频的延迟时间。

请帮帮我......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:43:56.970

您应该考虑连接时间。您的应用程序连接到服务器。而且您无法通过 ActionScript 尤其是`bufferTime`. 您应该调整服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T00:49:14.907

您正在删除缓冲时间——最好将缓冲时间设置为 3 秒左右。这将有助于解决“打嗝”。

```
ns.bufferTime = 3.0; 
```

标准大约是 3+ 秒。实际上，对于较大的电影，我更喜欢更长的缓冲时间。

# c# - Parallel.For 与常规线程

> ID：13070339
> 
> 赞同：9
> 
> 时间：2012-10-25T14:02:11.327
> 
> 标签：c#, multithreading, performance

我试图理解为什么 Parallel.For 在以下情况下能够胜过许多线程：考虑一批可以并行处理的作业。在处理这些工作时，可能会添加新工作，然后也需要处理这些工作。`Parallel.For`解决方案如下所示：

```
var jobs = new List<Job> { firstJob };
int startIdx = 0, endIdx = jobs.Count;
while (startIdx < endIdx) {
  Parallel.For(startIdx, endIdx, i => WorkJob(jobs[i]));
  startIdx = endIdx; endIdx = jobs.Count;
} 
```

这意味着 Parallel.For 需要多次同步。考虑一个面包优先的图算法算法；同步的数量会很大。浪费时间，不是吗？

在老式线程方法中尝试相同的方法：

```
var queue = new ConcurrentQueue<Job> { firstJob };
var threads = new List<Thread>();
var waitHandle = new AutoResetEvent(false);
int numBusy = 0;
for (int i = 0; i < maxThreads; i++) 
  threads.Add(new Thread(new ThreadStart(delegate {
    while (!queue.IsEmpty || numBusy > 0) {
      if (queue.IsEmpty)
        // numbusy > 0 implies more data may arrive
        waitHandle.WaitOne();

      Job job;
      if (queue.TryDequeue(out job)) {
        Interlocked.Increment(ref numBusy);
        WorkJob(job); // WorkJob does a waitHandle.Set() when more work was found
        Interlocked.Decrement(ref numBusy);
      }
    }
    // others are possibly waiting for us to enable more work which won't happen
    waitHandle.Set(); 
})));
threads.ForEach(t => t.Start());
threads.ForEach(t => t.Join()); 
```

`Parallel.For`代码当然要干净得多，但我无法理解的是，它也更快！任务调度器就这么好吗？同步被消除了，没有忙碌的等待，但线程方法始终较慢（对我而言）。这是怎么回事？线程方法可以更快吗？

编辑：感谢所有答案，我希望我可以选择多个。我选择了一个也显示出实际可能改进的那个。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-25T14:06:30.200

这两个代码示例并不完全相同。

将`Parallel.ForEach()`使用有限数量的线程并重新使用它们。第二个示例已经开始落后，因为必须创建多个线程。这需要时间。

的价值是`maxThreads`多少？非常关键，`Parallel.ForEach()`因为它是动态的。

> 任务调度器就这么好吗？

这是相当不错的。TPL 使用工作窃取和其他自适应技术。你将很难做得更好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T14:12:48.727

Parallel.For 实际上并没有将项目分解为单个工作单元。它根据计划使用的线程数和要执行的迭代次数分解所有工作（早期）。然后让每个线程同步处理该批次（可能使用工作窃取或保存一些额外的项目以在接近尾声时进行负载平衡）。通过使用这种方法，工作线程实际上永远不会互相等待，而由于您在每次迭代之前/之后使用的大量同步，您的线程会不断地互相等待。

最重要的是，由于它使用线程池线程，它需要的许多线程可能已经创建，这是它的另一个优势。

至于同步，Parallel.For 的全部意义在于所有迭代都可以并行完成，因此几乎不需要进行同步（至少在他们的代码中）。

然后当然还有线程数的问题。*线程池有很多非常好的算法和启发式方法，可以帮助它根据当前硬件、其他应用程序的负载等确定在那一刻*需要多少线程。你可能使用了太多，或没有足够的线程。

此外，由于在开始之前不知道您拥有的项目数量，我建议使用`Parallel.ForEach`而不是几个`Parallel.For`循环。它只是为您所处的情况而设计的，因此它的启发式方法会更好地应用。（它也使得代码更简洁。）

```
BlockingCollection<Job> queue = new BlockingCollection<Job>();

//add jobs to queue, possibly in another thread
//call queue.CompleteAdding() when there are no more jobs to run

Parallel.ForEach(queue.GetConsumingEnumerable(),
    job => job.DoWork()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T14:11:02.917

您创建了一堆新线程，而 Parallel.For 正在使用线程池。如果您使用 C# 线程池，您会看到更好的性能，但这样做确实没有意义。

我会回避推出您自己的解决方案；如果有需要自定义的特殊情况，请使用 TPL 并自定义..

# javascript - 从 JSON 中检索税率后计算总计

> ID：13070344
> 
> 赞同：-1
> 
> 时间：2012-10-25T14:02:24.117
> 
> 标签：javascript, jquery

我在一个表单中有 1 个选择、2 个文本输入和一些 JSON 数据：

*   **选择输入**：供应商列表
*   **文本输入 1**：净额
*   **文本输入 2**：总金额
*   **JSON数据**：包含各种供应商的费率，`JSON`如`supplier_tax_rates`

我正在计算类似这样的总金额（伪代码）：

```
grossAmount = NetAmount + ((currently_selected_supplier.tax_percentage_charged / 100) * netAmount) 
```

这是完整的代码： [从 JSON 中检索税率后计算总计](http://jsfiddle.net/A9vmg/17/)

现在，这应该有效，但它没有。我得到 NaN（不是数字），表示有问题。但我很难找到在哪里。

*   [**JSfiddle**](http://jsfiddle.net/A9vmg/17/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:07:37.517

您的代码中有多个问题。这是正确的版本：

```
var taxRates = $.parseJSON(supplier_tax_rates);

var getTaxRate = function(id) {
    for (var i in taxRates) {            // correct loop definition
        if (taxRates[i].id == id) {      // check you get id correctly
            return taxRates[i].tax_percentage_charged;   // instead of 'rate'
        }
    }
};

$('#PurchaseNetAmount').on('change', function(event) {
    var taxRatesId = $('#PurchaseSupplierId').val();
    var netAmount = parseFloat(this.value);
    var grossAmount = netAmount + ((getTaxRate(taxRatesId) / 100) * netAmount);
    $('#PurchaseGrossAmount').val(grossAmount);
}); 
```

**演示：http:** [//jsfiddle.net/A9vmg/18/](http://jsfiddle.net/A9vmg/18/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:07:03.557

您的问题出在查找功能中。

```
 for(TaxRate in supplier_tax_rates ){ 
```

`supplier_tax_rates`是一个字符串，而不是 JSON 对象

比你修复后你会有另一个错误

```
 return rate; 
```

什么是利率？

学习使用 console.log() 或断点，这样你就可以单步调试你的代码。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-25T14:07:49.973

getTaxRate(taxRatesId) 返回未定义

# java - 从哪里获得最新的 Android 支持包

> ID：13070347
> 
> 赞同：0
> 
> 时间：2012-10-25T14:02:32.497
> 
> 标签：java, android, android-support-library

**我的问题：**我在哪里可以得到`android-support-v4.jar`？

**我尝试过什么：**我去了[Android.com 的](http://developer.android.com/tools/extras/support-library.html)关于获取包的文档，它指出：

支持包作为可从 Android SDK 管理器下载的包提供。安装：

```
Launch the Android SDK Manager.
From Eclipse, you can select Window > Android SDK Manager. Or, launch SDK Manager.exe from the <sdk>/ directory (on Windows only) or android from the <sdk>/tools/ directory.
Expand the Android Repository, check Android Support package and click Install selected.
Proceed to install the package.
When done, all files (including source code, samples, and the .jar files) are saved into the <sdk>/extras/android/support/ directory. This directory contains each of the different support libraries, such as the library for API level 4 and up and the library for API level 13 and up, each named with the respective version (such as v4/). 
```

但是，我没有在我的列表中看到 Android 支持包。我该如何解决这个问题，或者他们的文档有误？

![我所看到的](../Images/0fe2a6d83ebe3722cd0842c5e8be34b4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:08:08.480

它可以在**存储库**排序中的**Google Inc.**存储库中找到。**按API 级别**排序时，您可以在**Extras**文件夹中找到它。

 ******在这两种情况下，您要查找的包都名为**Android Support Library**。******

# php - 当键是数字时，如何从多维数组中回显单个值？

> ID：13070349
> 
> 赞同：5
> 
> 时间：2012-10-25T14:02:32.457
> 
> 标签：php, multidimensional-array

以这个数组为例

```
Array
(
[events] => Array
    (
        [0] => Array
            (
                [event] => Array
                    (
                        [category] => seminars,sales
                        [status] => Live 
```

如何检索类别的值？我尝试过各种组合，例如；

```
echo $array->events->events[0]->event->category; 
```

如此简单，但我就是想不通。

对不起这个蹩脚的问题。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-25T14:04:27.623

它应该是

`echo $array['events'][0]['event']['category'];`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-25T14:04:19.603

您正在使用对象属性选择器。

尝试这个：

```
echo $array['events'][0]['event']['category'] ; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T14:03:47.393

尝试`echo $array['events'][0]['event']['category'];`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T14:04:02.730

像这样：

```
echo $arr['events'][0]['event']['category']; 
```

# mysql - 更新语句后跟选择 MySQL

> ID：13070359
> 
> 赞同：0
> 
> 时间：2012-10-25T14:02:54.710
> 
> 标签：mysql

如果应用程序版本匹配，我将从缓存服务器存储缓存信息，否则我需要将缓存详细信息设置为 NULL。

目前我正在这样做

```
UPDATE 
  cache_table 
SET
  _data = NULL 
WHERE _id = id AND _app_version != "current_version" 
```

其次是选择查询

```
SELECT 
      _data 
    FROM
      cache_table 
    WHERE _id = id AND _app_version == "current_version" 
```

有没有一种方法可以在一个查询中进行所需的更新和选择而不触发两个查询？

注意：我不想使用 MySQL 程序。没有具体原因，但不想将应用程序逻辑存储在数据库中，因此我可以轻松更改数据库应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:19:11.990

通常`UPDATE`和`SELECT`是两个不同的操作。组合它们的唯一方法是使用您确定的存储过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:08:59.057

我不相信 MySQL 有内置的方法可以做到这一点。但是，仅供参考，这可以在 SQL Server 中使用 OUTPUT 子句完成：

[http://msdn.microsoft.com/en-us/library/ms177564.aspx](http://msdn.microsoft.com/en-us/library/ms177564.aspx)

# android - 单行到 fill_parent ListView 高度

> ID：13070361
> 
> 赞同：4
> 
> 时间：2012-10-25T14:03:01.897
> 
> 标签：android, android-listview

listView 中有一行我希望与 listView 具有相同的高度（假设是全屏）。

行布局看起来像

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:src="@drawable/error" />

    <TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/imageView"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="14dp"
        android:minHeight="30dip"
        android:textAppearance="?android:attr/textAppearanceMedium"/>
</RelativeLayout> 
```

而适配器的 getView 是

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
   View row = inflater.inflate(R.layout.myrow, parent, false);
   return row;
} 
```

Bu 该行的显示方式与`android:layout_height="wrap_content"`.

布局预览显示填充它的父行和我正在使用的行`inflate(R.layout.myrow, parent, false);`，listView 肯定会全屏显示，并且行仅与图像 + textView 一样高。

我错过了什么重要的东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T07:23:15.523

我有类似的问题，我想我已经解决了，所以在这里报告。

我的 ListView 中有更多行，但我希望行高与 listview 相同，这反过来又会占用布局的所有剩余空间。我的行仅由一个 ImageView 组成。我遇到了以下问题：

- 我希望较小的图像扩展以占据所有空间 - 较大的图像不应超过行高

如果我犯了任何错误，请在此处留言。

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="0.9"
    android:gravity="center"
    android:orientation="vertical">
    <ListView 
        android:id="@id/lay_main_firma_objekti"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:gravity="center">
    </ListView>      
</LinearLayout> 
```

行布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
       android:layout_width="match_parent"
       android:layout_height="match_parent"
       android:gravity="center">       
  <TextView
      android:id="@+id/xx"
      android:layout_width="match_parent"
      android:layout_height="match_parent"/>  
    <ImageView              
        android:id="@id/imageView_obj"
        android:contentDescription="@string/objektDesc"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_alignLeft="@id/xx"
        android:layout_alignTop="@id/xx"
        android:layout_alignRight="@id/xx"
        android:layout_alignBottom="@id/xx"
        android:scaleType="fitXY"
        android:src="@drawable/custom_prazno" />                    
</RelativeLayout> 
```

然后在 Adapter getView 中重要的是

```
convertView.setMinimumHeight(parent.getMeasuredHeight());
ImageView slika=(ImageView)v.findViewById(R.id.imageView_obj);    
slika.setMinimumHeight(parent.getMeasuredHeight());
TextView xx=(TextView)v.findViewById(R.id.xx);
xx.setHeight(parent.getMeasuredHeight()); 
```

我认为是的。hth

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T14:10:53.033

只是想知道是否有特定原因为什么要让 ListView 只包含一行？而不是直接使用RelativeLayout而不是ListView？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:12:24.197

我最终对行高进行了硬编码。将其设置为 minimumHeight 后，相对布局存在问题，因此我也将其替换为具有中心重心的 LinearLayout。

请让我知道是否有更好的解决方案让 Android 完成它的工作并最小化硬代码。

# sql - 调用 .Remove() 正在执行 UPDATE 语句而不是 DELETE 并导致错误：“无法将值 NULL 插入列”

> ID：13070365
> 
> 赞同：0
> 
> 时间：2012-10-25T14:03:05.547
> 
> 标签：sql, entity-framework

这是我删除对象的代码片段：

```
var foo = this.repository.GetFoo();

foreach (var item in foo.RelatedItems.ToList()) {
    if (x == y) {
        //Update happens here; this isn't executing however.
    } else {
        //This code block is executed; this is where I am telling the context to mark this object for deletion.
        foo.RelatedItems.Remove(item);
    }
}

this.repository.Save(); 
```

调用时`.Save()`，出现错误：“无法将值 NULL 插入列”。我使用分析器查看实际执行的 SQL 是：

```
update dbo.RelatedItems
set foreignKey = null
where id = X 
```

我希望在这里执行删除语句，但是，由于某种原因，它试图通过将外键设置为 null 来更新记录。

**编辑**

我将以下代码添加到我的存储库类中以解决该问题：

```
public void DeleteItem(Item item) {
    context.Entry(item).State = System.Data.EntityState.Deleted;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:21:56.287

请参阅此相关问题：[EF 4：从集合中删除子对象不会删除它 - 为什么？](https://stackoverflow.com/questions/2554696/ef-4-removing-child-object-from-collection-does-not-delete-it-why)

`Remove`显然，在和`Delete`where之间存在语义差异，`Remove`将通过删除外键来孤立该行，并且`Delete`实际上会将记录从表中取出。

其他问题的用户`vittore`建议

```
dbcontext.DeleteObject(item); 
```

循环内。

# php - 创建预览框

> ID：13070368
> 
> 赞同：1
> 
> 时间：2012-10-25T14:03:09.680
> 
> 标签：php, javascript, css, phpmyadmin

我做了一个小 div 框，只够包含 2 行半的句子。但实际上我想要做的是，我只是显示预览（几行句子）。我想在句子的末尾添加“阅读更多...”，当用户点击它时，会导致另一个页面显示整篇文章。

我正在从数据库中提取这些文章。我的问题是，如何从数据库中提取几行并在小 div 框中预览...？

最好的方法是什么？我应该如何控制文本的数量作为要在 div 框中显示的预览。

可以用 Javascript、PhpMysql 提取代码、CSS 控制吗？什么是最好的方法 ？

注意：（我正在从数据库中提取文章。作为测试平台，我使用 wamp 服务器及其 mysql 数据库）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:08:40.643

What you can do is extract the whole text from the database, and run the following javascript on your text nodes:

[Cutter.js](http://tcorral.github.com/Cutter.js/)

From their documentation:

```
Cutter.run( oApplyTo, oTarget, nWords, oTexts, oClasses ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:35:11.253

不是答案，而是一些提示：

您可以尝试使用 ajax 来获取整篇文章并使用 js 对其进行剪辑。
或者，提供服务器端支持以提供剪辑文章并使用 ajax 获取。

获得文章的剪辑部分后，使用 innerHTML 将其显示在 div 中应该相当容易。

要固定 div 框的位置，可以使用 js 或 css。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:11:37.957

您可以在数据库中执行类似摘录列的操作，并将其显示在您的 div 框中，当用户单击“阅读更多”时，您可以从数据库加载全文。或者您可以编写简单的 js 脚本，该脚本将删除您不需要的所有内容。或者您可以通过 css 为您的 div 框设置大小并将溢出属性设置为隐藏：

```
.excerpt {
   width: xx px;
   height: xx px;
   overflow: hidden;
} 
```

# ios - Xcode 4.5 背景图片 iPhone 4、4s、5

> ID：13070369
> 
> 赞同：6
> 
> 时间：2012-10-25T14:03:14.540
> 
> 标签：ios, iphone, ios6, screen, iphone-5

我在 viewController.m 中编写了后台代码：

```
self.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"image.png"]]; 
```

我有不同图片的正确名称：

```
image.png for non-retina display (320x480)

image@2x.png for retina display (640x960)

image-568h@2x.png for iPhone 5 (640x1136) 
```

但是当我在模拟器中运行它时，它不会使用 iPhone 5 屏幕的 image-568h@2x.png 它只需要 4s 屏幕的 image@2x 并缩放它以适应屏幕......我不知道是否有iPhone 5 屏幕上使用 image-568h@2x 的任何编码？

我使用 Xcode 4.5

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-25T14:21:12.080

iPhone 5 是视网膜，就像 iPhone 4 和 4S 一样，@2x-image 将自动用于所有这些设备。它只是 iPhone 5 的名为“-568h@2x”的启动图像。您需要编写一些代码来使用不同的图像，这样可以工作：

```
NSString *filename = @"image.png";
CGRect screenRect = [[UIScreen mainScreen] bounds];
if (screenRect.size.height == 568.0f)
    filename = [filename stringByReplacingOccurrencesOfString:@".png" withString:@"-568h.png"];

imageView.image = [UIImage imageNamed:filename];
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T14:13:01.600

如果您尝试使用`[UIImage imageNamed:@"image.png"]`并希望`image-568h@2x.png`从 iPhone 5 的捆绑包中自动挑选，它将无法正常工作。自动拣货仅适用于 iPhone 4 和 4S。

`Default-568h@2x.png`在 iPhone 5 中，只会自动选取名为 as 的默认图像。

对于普通图像，如果您有 iPhone 5 的单独图像，请尝试使用此代码

```
CGRect screenBounds = [[UIScreen mainScreen] bounds];
if (screenBounds.size.height == 568) {
    // code for 4-inch screen
} else {
    // code for 3.5-inch screen
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T14:12:01.060

我认为假设您可以将`-568h@2x`技巧应用于*所有*图像文件是不正确的。我认为*它只*适用于`Default-568h@2x.png`. 这是 iOS 在 4" 显示设备上启动应用程序时查找的文件，以及用于在 SDK 中启用 4" 显示支持的“标志”。例如，一旦您包含此特定文件，您的表格视图将填满屏幕。

我没有读到任何建议您可以简单地提供带有`-568h@2x`文件名组件的任何图像并自动使用它。您必须根据屏幕尺寸自己执行此操作，例如`[UIScreen mainScreen].bounds.size.height`.

# python - TypeError：不支持的操作数类型/：'float'和'datetime.timedelta'

> ID：13070370
> 
> 赞同：2
> 
> 时间：2012-10-25T14:03:19.093
> 
> 标签：python, python-2.7

我有一个浮点值，我需要将其除以计算如下的天数：

```
import timedelta
import datetime
days_cur_cycle=abs(start_date.date()-today_date.date())
//start_date and today_date are datetime objects
x=3.09
y=x/days_cur_cycle` 
```

在这里，我收到以下错误

```
**TypeError: unsupported operand type(s) for /: 'float' and 'datetime.timedelta'** 
```

有人请帮我计算一下

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:07:57.720

我相信您将需要类似： days_cur_cycle=abs( (start_date.date()-today_date.date()) **.days** )

# jquery - 首页幻灯片（Joomla）问题

> ID：13070378
> 
> 赞同：0
> 
> 时间：2012-10-25T14:04:03.867
> 
> 标签：jquery, joomla, slideshow, frontpage

我在我的 joomla 网站上安装了首页幻灯片。我做了一个类别，包含 2 张幻灯片。

但是页面加载幻灯片而不是幻灯片效果。

网址：[http ://sea-and-wetest.netserver11.net/](http://sea-and-wetest.netserver11.net/)

有人知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:05:53.430

那是因为您的站点上运行了 2 个版本的 jQuery，因此它们是冲突的。两者都是从 googleapis 外部包含的。

对于您的滑块，找出包含 jquery 嵌入代码的文件并替换为以下内容：

```
// load jQuery, if not loaded before
if(!JFactory::getApplication()->get('jquery')){
    JFactory::getApplication()->set('jquery',true);
    $document =& JFactory::getDocument();
    $document->addScript(JURI::root() . "path/to/jquery/jquery-1.8.2.js");
} 
```

这将确保只包含 1 个 jquery 副本。确保更改路径。

# java - 如何在 Excel 中抑制扩展警告

> ID：13070379
> 
> 赞同：3
> 
> 时间：2012-10-25T14:04:09.873
> 
> 标签：java, swing, excel, jtable

我从我的 JTable 创建了一个 Excel 文件。创建它的同一个按钮也会打开它。但它给出了一个提示：

> 您尝试打开的文件与文件扩展名指定的格式不同。在打开文件之前，请确认文件没有损坏并且来自受信任的用户。您要打开文件吗？

当我单击确定时，文件打开。我正在使用 Office 2007 并将文件另存为`.xls`. 有没有办法从代码级别停止提示？这是创建和打开文件的代码：

```
if (obj == btnExport) {
  File f = new File("Student Results");
  f.mkdir();
  try {
    TableModel model = DataBaseTable.getModel();
    FileWriter excel = new FileWriter("Student Results/" + exam  + "_"+ level + "_" + year + ".xls");
    for(int i = 0; i < model.getColumnCount(); i++){
      excel.write(model.getColumnName(i) + "\t");
    }

    excel.write("\n");

    for(int i=0; i< model.getRowCount(); i++) {
      for(int j=0; j < model.getColumnCount(); j++) {
        excel.write(model.getValueAt(i,j).toString()+"\t");
      }
      excel.write("\n");
    }

    excel.close();
    JOptionPane.showMessageDialog(this, "File Exported to " + f.getAbsolutePath(),
    "Success", JOptionPane.INFORMATION_MESSAGE);
    File opn = new File("Student Results/" + exam  + "_"+ level + "_" + year + ".xls");
    Desktop.getDesktop().open(opn);

  } catch (Exception se) {
    JOptionPane.showMessageDialog(this, se,
    "Error", JOptionPane.ERROR_MESSAGE);
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:22:10.337

[这个 MSDN](http://support.microsoft.com/kb/948615)提供了几种方法（组策略或注册表操作）来说明如何抑制警告，但我认为这两种方法都不是特别实用。

我建议改为制作 CSV，因为您只是在编写文件。这些也由 Excel 打开。我相信你所要做的就是`\t`在你的代码中用逗号代替你的两个 s 。

# jenkins - 将 Gallio 与 OpenCover 覆盖报告文件包含结果但 Sonar 报告为 0%

> ID：13070380
> 
> 赞同：1
> 
> 时间：2012-10-25T14:04:14.190
> 
> 标签：jenkins, sonarqube, opencover

我的问题是，由于某种原因，Sonar 中没有显示代码覆盖率。单元测试的结果已正确执行并显示，但不是代码覆盖的结果。该项目由 Jenkins 构建。我已经按照某些线程中的建议注册了 opencover.profiler.dll 文件，但我仍然没有得到任何结果。执行构建时，我在 Jenkins 中都没有收到任何错误消息。

我将不胜感激有关该做什么的任何提示。

最好的问候丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T18:38:53.233

我认为发生这种情况是因为您的 Jenkins 服务作为“本地系统帐户”运行，但 Sonar 运行 OpenCover 时使用了 -register:user 开关。您应该能够通过将 Jenkins 服务作为普通用户帐户运行来绕过此问题，或者修补 Sonar-runner 以省略 -register:user 开关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T15:49:57.913

然而，事实证明是 PDB 文件导致了这些问题。它们包含在存储库中，并且由于某种原因没有被 Jenkins 中的构建重新创建。因此，PDB 文件包含实际代码文件的错误路径。

谢谢您的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T23:09:30.257

检查 OpenCover 和 Gallio 插件之间的版本冲突。

我发现 OPenCover 的更高版本（从版本 4.0.1229 开始）在 coverage-report.xml 文件中插入了一个新标签 - Gallio 插件无法理解。当我回滚到旧版本的 OpenCover (4.0.804) 时，覆盖范围再次起作用。[您可以在http://sonar.15.n6.nabble.com/coverage-report-xml-is-generated-but-sonar-says-coverage-is-0-td5008850.html](http://sonar.15.n6.nabble.com/coverage-report-xml-is-generated-but-sonar-says-coverage-is-0-td5008850.html)上找到更多详细信息

看起来Gallio插件已经更新了，但我还没有追求过（想先确认这是问题的原因）。

# vba - VBA IE自动化，当点击网页中的链接时，在excel中执行显示消息等事件

> ID：13070382
> 
> 赞同：1
> 
> 时间：2012-10-25T14:04:15.273
> 
> 标签：vba, excel, webautomation

我的要求是我需要在 excel 中有一个 VBA 代码，当单击网页中的链接时，它会运行以在 excel 中执行一些操作。例如，当我单击网页中的“登录”链接时，我的 VBA 代码应该按下键盘上的 printscreen 按钮（就像我们使用 sendkeys 一样）。两周以来我一直在谷歌上寻找这个解决方案，但没有得到一个。这是紧急项目要求，请节省我的时间，非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:12:36.160

您无法在 Internet Explorer 中执行任何本地操作来启用此功能。

您需要编写一个 ActiveX 控件（使用 C#、C++、VB6 等）来执行 Excel 自动化。

一些有用的链接：

*   [如何从 VB6 自动化 Excel](http://support.microsoft.com/kb/219151)
*   [如何在 VB6 中编写可更新的 ActiveX 控件](http://www.codeproject.com/Articles/8249/How-to-write-an-updatable-ActiveX-control-for-web)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:09:18.627

这是我对类似问题给出的答案的编辑版本（http://stackoverflow.com/questions/12877872/possible-to-intercept-onchange-event/12927960#12927960）。

为“Microsoft HTML 对象库”和“Microsoft Internet 控件”设置的项目引用

在类模块“clsEvents”中：

```
Option Explicit

Public WithEvents href As MSHTML.HTMLAnchorElement

'Note that having defined "href" as "WithEvents", if you choose "href"
'  from the left-hand dropdown at the top of the class code module
'  then the right-hand dropdown will populate with events you can select
'  from to create an event-handling procedure in the class

Private Function href_onclick() As Boolean
    Debug.Print "link clicked"
    href_onclick = False 'cancels the navigation
End Function 
```

在常规模块中：

```
Option Explicit

Dim evt As clsEvents

Sub Setup()

    Dim IE As New InternetExplorer
    Dim el2 As Object

    Set evt = New clsEvents

    IE.Visible = True
    IE.navigate "http://www.csee.wvu.edu/~riggs/html/select_example.html"

    Do While IE.Busy
    Loop

    Set el2 = IE.document.getElementsByTagName("a")(1)

    If Not el2 Is Nothing Then
        Debug.Print "setting event capture on link:" & el2.innerText
        Set evt.href = el2
    End If

End Sub 
```

如果您运行`Setup`子程序，然后在 IE 中单击页面上的“Javascript”链接，您应该会在 VB 编辑器的立即窗口中看到输出。

希望这有助于您入门。

# api - 使 SugarCRM 中的会话无效

> ID：13070386
> 
> 赞同：0
> 
> 时间：2012-10-25T14:04:19.527
> 
> 标签：api, rest, sugarcrm

我的应用程序与 SugarCRM 对话。我需要测试我的应用程序在会话过期时尝试调用 REST 方法时的行为。如何在不等待超时的情况下这样做？

提示：不提供会话或提供错误的会话号会导致错误 10：无效登录。我正在寻找错误 11：会话已过期。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:47:19.607

如果您只是使用 PHP 会话，则可以删除服务器上的会话文件，然后将其清除。

# python - 如何将多个 EPS 文件放在 PDF 的单个页面上？

> ID：13070388
> 
> 赞同：1
> 
> 时间：2012-10-25T14:04:21.273
> 
> 标签：python, pdf-generation, eps

我想创建一个 PDF，其中一个*页面*包含多个 EPS(AI) 文件。有没有图书馆可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:23:26.730

生成一个[包含数字](http://amath.colorado.edu/documentation/LaTeX/reference/figures.html)的 .tex 文件，然后使用带有[子进程模块](http://docs.python.org/library/subprocess.html)的乳胶、dvipdf 编译它就足够了吗？

好消息是您可以使用强大的 tex 格式将其放置在页面上任何您想要的位置等。

乳胶文件不需要非常复杂：

```
\documentclass[12pt,notitlepage]{report}
\pagestyle{plain}

\usepackage[top=30mm, bottom=30mm, paperwidth=170mm, paperheight=220mm]{geometry}
\usepackage[dvips]{graphicx}

\begin{document}

\centering
\includegraphics[height=60mm]{myfig.eps}

\vspace{10mm}

\includegraphics[height=60mm]{myfig.eps}

\end{document} 
```

# asp.net - CSS Prinitng - Page-break-before 导致表头不重复（Internet Explorer 8）

> ID：13070390
> 
> 赞同：1
> 
> 时间：2012-10-25T14:04:23.177
> 
> 标签：asp.net, html, css

我在创建的报告中遇到了上述问题，需要从 ASP.NET 应用程序中打印。

我创建了一个简化版本，因此我可以尝试找出问题所在。

请看一下。在浏览器打印预览中预览页面，你会看到我用粗体突出显示的代码导致表头不重复。删除 page-break-before 并且标题应该重新出现。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
    <title></title>

        <style type="text/css">

        @media print
        {

        thead { display: table-header-group; }
        tfoot { display: table-footer-group; }
        tbody {display: table-row-group; }

        }

    </style>

</head>

<body>

<div style='margin-left: auto; margin-right: auto; width: 602px; border: 0px solid #000000; padding: 0px 5px 5px 5px; font-size: 10pt; font-family: Tahoma'>

<table style="font-size: 12pt; font-family: verdana">
<thead>
<tr><th align="center">HEADER</th></tr>
</thead>
<tbody>
<tr><td>

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin in tellus ante, eu pharetra neque. Pellentesque a blandit odio. Donec porta sodales arcu vitae commodo. Praesent eu dolor justo. Cras facilisis, tellus sit amet laoreet blandit, libero nibh pharetra lacus, nec sagittis odio tortor quis leo. Quisque rhoncus nisi at urna tempor feugiat. Sed fermentum augue ultricies nunc facilisis vel dignissim ante dapibus. Mauris auctor, lorem sit amet vestibulum ultrices, erat neque fringilla lacus, at laoreet sem risus pulvinar enim. Proin laoreet pellentesque neque, et elementum magna volutpat vitae. Curabitur et nulla velit, ut tincidunt ante. Proin ac nulla sit amet odio rutrum viverra a in nibh. In hac habitasse platea dictumst.
<br /><br />
Pellentesque eu lacus non nisi ornare viverra. Quisque arcu nunc, pretium in feugiat et, tristique venenatis odio. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nunc arcu velit, suscipit sit amet porta vel, volutpat id ante. Mauris et nulla dui. Cras elementum posuere euismod. Donec ante dui, molestie non tempus quis, fermentum quis tellus. Proin viverra tellus quis lectus pharetra ut iaculis neque pharetra.
<br /><br />
Sed sed gravida tellus. Etiam pulvinar nibh quis est tempus dapibus eu quis eros. Etiam vel urna nunc. Suspendisse potenti. Aliquam sit amet libero nec neque adipiscing feugiat quis non odio. Fusce malesuada magna et orci egestas eget lacinia erat adipiscing. Proin vitae euismod elit. Cras ut sem nisl. Ut ornare dolor at erat dignissim eu cursus tortor ullamcorper.
<br /><br />
Suspendisse vel odio a elit sagittis porta et vitae justo. Nam quis sodales neque. Donec magna sem, faucibus et semper sit amet, adipiscing sit amet mi. Vestibulum non neque ligula, vitae luctus nulla. Mauris quis libero pulvinar justo iaculis lacinia. Donec gravida eleifend tortor. Maecenas tristique iaculis nunc, eu sagittis dolor interdum et. In hac habitasse platea dictumst.
<br /><br />
Duis orci leo, dapibus vestibulum luctus nec, accumsan tempor dolor. Donec blandit venenatis erat, et volutpat quam hendrerit eu. Suspendisse potenti. Quisque risus nulla, malesuada sed semper ac, molestie nec est. In nec dignissim sem. Nulla enim nunc, eleifend eu fringilla sagittis, pellentesque non urna. Sed mi diam, ullamcorper et accumsan quis, placerat ut nisi. Nunc purus neque, semper non posuere ut, vestibulum vel odio.
<br /><br />
Maecenas aliquam sodales eros, sed faucibus mauris mattis eget. Nulla erat lectus, luctus id fermentum eu, posuere ac tellus. Praesent nisl erat, cursus eu tincidunt congue, viverra rhoncus enim. Pellentesque orci nisi, sagittis vel pretium posuere, pellentesque at eros. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus felis odio, tincidunt in molestie id, aliquet id magna. Vestibulum sit amet orci eget felis tempus cursus. Nullam aliquet, lacus eget pharetra rhoncus, nisi orci pellentesque felis, id vestibulum mauris turpis aliquet risus. Sed rutrum est non est adipiscing ut dictum odio feugiat. Integer arcu nunc, porta pharetra facilisis ut, congue congue dolor. Quisque metus leo, cursus eget viverra iaculis, sodales eu leo. Vivamus ipsum lorem, fringilla sed sagittis vel, commodo quis lectus. Nunc ornare accumsan diam, ut aliquet purus laoreet sit amet. Pellentesque lacinia ligula quis ipsum dictum quis malesuada turpis semper.
<br /><br />
Duis laoreet auctor nibh a fermentum. Phasellus sapien risus, sodales et mollis in, dictum at nisi. Vestibulum eu nibh nec nulla pretium ornare. Aenean at ipsum orci, a laoreet nisl. In fermentum feugiat eros, sed gravida ipsum porta nec. Suspendisse luctus porta erat sit amet gravida. Nunc in lacus in odio accumsan euismod et a elit. Curabitur bibendum mauris bibendum dolor gravida dapibus. Quisque urna dolor, pulvinar tincidunt posuere dignissim, fringilla vel tortor. Morbi pellentesque sollicitudin eros ac tempus. Aliquam erat volutpat.
<br /><br />
Aliquam erat volutpat. Etiam congue, mi aliquet eleifend consequat, metus eros posuere augue, sed accumsan nunc justo sit amet est. Duis sed felis vel elit scelerisque tristique sit amet quis diam. Fusce ut ultricies odio. Mauris scelerisque placerat tempor. Sed vestibulum mollis velit nec imperdiet. Sed elementum sodales metus, et fermentum leo aliquet auctor. Ut at nisl vitae purus rhoncus aliquam. Sed aliquet libero ac est egestas quis condimentum nisi rutrum. Donec condimentum vehicula odio, eu dignissim neque pulvinar a. Integer lobortis tempus blandit. Nullam faucibus lorem sed mauris consectetur id viverra turpis suscipit.
<br /><br />
Sed id diam neque. Donec elementum, enim sit amet ultrices semper, quam justo fringilla dolor, quis condimentum velit orci vel felis. Duis a elit vel nibh convallis dictum. Nam vel arcu nibh, id pretium orci. Maecenas vel dui nisi, id consequat nibh. Nulla blandit eleifend nunc varius semper. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus ut condimentum nibh. Pellentesque sit amet faucibus justo. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse potenti. Sed eget leo mauris. Vivamus luctus, felis at aliquet imperdiet, nibh erat auctor lacus, ac dignissim orci neque faucibus sapien. Suspendisse tempus venenatis purus ac facilisis. Aenean ac ultrices arcu.
<br /><br />
Suspendisse posuere, orci eget luctus tristique, odio lectus varius orci, eu mattis erat ante ac risus. Donec dictum pretium leo, eu porta enim dapibus eget. Donec in libero tortor, id tempus libero. Nunc magna tellus, placerat ut adipiscing vitae, volutpat ac arcu. Quisque sit amet leo massa. Nunc cursus, odio nec molestie sollicitudin, leo tellus dictum magna, eu sollicitudin libero ligula ac urna. Morbi ac sapien libero, ut eleifend massa. Etiam a risus vitae ipsum tempus pharetra sit amet vitae erat. Morbi sit amet lorem vulputate magna ultrices tincidunt sed vel urna. Aenean pulvinar, risus quis pharetra tincidunt, purus est accumsan odio, et accumsan turpis massa vitae leo. Vivamus at eros dolor. Donec ornare, nulla ut venenatis adipiscing, purus urna vestibulum nisi, placerat tincidunt nibh tortor vitae arcu. Vestibulum id turpis erat, ut adipiscing lorem. Duis venenatis, magna id lobortis accumsan, velit nisl convallis augue, sit amet interdum urna lorem sit amet sapien. Curabitur facilisis convallis lorem sit amet mollis. In hac habitasse platea dictumst.
<br /><br />
Quisque eget nunc leo. Vivamus rhoncus ultrices dolor in porta. Phasellus condimentum tempor justo nec facilisis. Sed consequat dictum dui, eget lacinia arcu rhoncus eget. Curabitur vehicula laoreet nunc quis tincidunt. Maecenas eget massa sed ligula interdum euismod quis vitae urna. Praesent luctus, dolor a faucibus tristique, purus lorem aliquam lectus, sed hendrerit ante nisl vel ligula.
<br /><br />

**<div style="page-break-before: always">**
Curabitur pulvinar sollicitudin est id elementum. Vestibulum quis lacus nisl. In pretium quam vel diam iaculis sit amet tristique justo viverra. Vestibulum ut magna nibh, quis pulvinar enim. Nulla facilisi. Sed posuere pulvinar urna, a porta odio congue in. Curabitur faucibus turpis quis nibh semper tincidunt. Ut egestas, justo ut vehicula elementum, magna eros sagittis nulla, placerat euismod nibh quam eget quam. Nullam placerat turpis vel lorem pharetra pharetra. Nunc eros nisl, aliquet rutrum sollicitudin et, ultrices volutpat augue. Maecenas dapibus adipiscing mattis. Nulla vitae velit tortor. Proin suscipit, augue in egestas aliquam, massa nisl pharetra mauris, sed vulputate lacus mi sit amet nibh. Donec ut justo tortor, non semper ligula. Nunc facilisis blandit lorem at pulvinar.
</div>
<br /><br />
Integer imperdiet faucibus mattis. Integer condimentum scelerisque erat, sed adipiscing dui condimentum vel. Etiam aliquet tempus neque, in fermentum massa tristique eu. Sed tempus neque vel eros tincidunt eget lobortis massa accumsan. Ut enim elit, rutrum vel adipiscing egestas, gravida nec urna. Proin fringilla aliquet hendrerit. Aenean a porttitor nunc. Ut vestibulum malesuada massa sit amet dictum. Duis ut sem ac augue fermentum tincidunt. Aliquam convallis pellentesque elementum. Suspendisse accumsan, lectus vitae tempus elementum, risus urna lacinia nunc, non dapibus sem nunc sit amet neque. Integer eu metus erat. Donec at ante neque. Nullam convallis odio sit amet enim sollicitudin vel vestibulum turpis aliquam.
<br /><br />
Aenean mattis velit vel ipsum eleifend sit amet auctor metus fringilla. Quisque a lacus orci. Ut luctus vulputate imperdiet. Mauris luctus massa at erat posuere sit amet convallis magna malesuada. Mauris tempus auctor suscipit. Phasellus eu est vel metus pharetra commodo ac posuere orci. Duis massa purus, lobortis et fringilla et, venenatis eget odio. Fusce vel sapien nisl. Suspendisse nisi nisi, tempor ut volutpat vitae, pharetra id ligula. Donec ipsum enim, dignissim et pharetra nec, vehicula et mauris. Ut sit amet nisl odio. Sed eleifend auctor metus, vel laoreet diam varius vel. Vestibulum sit amet augue nec massa faucibus rhoncus. Nulla sodales justo nec nisl commodo facilisis. Aenean euismod tortor eget lorem ultricies tincidunt.
<br /><br />
Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Pellentesque mi dolor, hendrerit a laoreet vehicula, elementum ut elit. Nullam sodales justo sed turpis volutpat blandit. Mauris augue est, tincidunt at vestibulum vitae, vestibulum non velit. Ut ac bibendum orci. Vestibulum lacus velit, rhoncus sed pellentesque ac, aliquam vitae sem. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nullam condimentum nulla lacinia purus luctus et molestie eros cursus. Ut quis erat at magna aliquet laoreet. Suspendisse iaculis hendrerit vulputate.
<br /><br />
Etiam lobortis tortor lectus. Curabitur a ligula lorem. Donec vel odio a urna fermentum tincidunt in in libero. In hac habitasse platea dictumst. Morbi vel dui vitae ligula interdum ultricies in nec nisi. Sed sit amet odio in massa sodales mattis. Nunc non dolor ac turpis laoreet ultrices quis pellentesque felis. In egestas justo sed libero molestie in posuere odio condimentum. Morbi ultrices nibh vitae nisi posuere molestie. Fusce tempor porttitor leo, quis congue turpis congue non. Aliquam lorem libero, lacinia eget egestas nec, consectetur vitae eros. Cras interdum elementum odio, a venenatis odio gravida in. In vestibulum volutpat libero id vehicula. Nulla et vehicula eros. Mauris lacinia leo vitae lectus accumsan dignissim. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
<br /><br />
Vestibulum sollicitudin sollicitudin consectetur. Vivamus fringilla gravida tempus. Phasellus vel fermentum erat. Maecenas auctor euismod lectus et vestibulum. Vivamus fringilla urna et justo rutrum imperdiet. Nunc a diam interdum nulla porta tempor. Nulla tellus risus, dignissim fringilla laoreet ac, lacinia et risus. Aliquam ut est orci, non molestie turpis. Etiam fringilla leo eget felis luctus et blandit nulla porta. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;
<br /><br />
In sapien neque, varius at elementum vel, rutrum ut mauris. Phasellus pellentesque facilisis lacinia. Vivamus interdum nibh quis elit vehicula eget faucibus mauris commodo. Donec odio leo, faucibus in pellentesque a, pulvinar vel velit. Phasellus et sagittis felis. Phasellus ultrices elit sed mi tincidunt vel viverra nisl vestibulum. In eu augue nec odio ultrices tempor. Aliquam erat volutpat. Mauris ut urna ligula. Pellentesque tempus, tellus blandit placerat faucibus, nulla lorem dignissim neque, ut iaculis tortor orci nec ligula. Nunc sodales convallis mattis. Etiam ac neque ac nisi volutpat imperdiet. Sed semper eleifend tellus, eget porta eros molestie ut. Quisque at ante sem. Donec non dolor tincidunt ipsum convallis suscipit. Aliquam ipsum nibh, dapibus at imperdiet tempus, fermentum ut velit.
<br /><br />
Vestibulum nibh orci, tincidunt nec sodales sit amet, lacinia vel nisi. Praesent tempor porttitor commodo. In hac habitasse platea dictumst. Donec suscipit, nunc in condimentum semper, tellus orci egestas nisl, pellentesque malesuada lacus lacus ac turpis. Donec at sapien ante. Praesent cursus dapibus turpis et porta. Etiam imperdiet aliquam augue, in varius sem tempor vitae. Phasellus at nunc id nisl vulputate porta vitae vitae quam.
<br /><br />
Morbi sodales nibh non lectus tincidunt elementum. Donec feugiat, nisi sit amet accumsan molestie, tellus lectus condimentum est, ut vulputate tellus ipsum in nisi. Duis mattis lorem et est vestibulum eu sollicitudin erat sodales. Integer porta varius imperdiet. Ut suscipit, lacus vel gravida iaculis, ipsum erat ultricies turpis, et egestas lacus sem id libero. Proin at mauris vel mi lobortis convallis vitae et tortor. In elementum mi vel ipsum tempus bibendum. Nam adipiscing, sem non semper rutrum, felis est lacinia felis, faucibus mollis diam ante et nisl. Nam erat eros, faucibus non porta vitae, rhoncus sit amet velit. Vestibulum sed elementum mauris. Praesent neque dolor, bibendum vel luctus lacinia, viverra nec odio. Morbi pharetra luctus ante non rutrum. Pellentesque rutrum, orci eu fringilla condimentum, felis massa tempor purus, quis rhoncus massa libero ac tortor. Phasellus a sapien est. Integer vulputate mauris eu erat pellentesque dictum. Phasellus eu lorem sed eros commodo convallis a at odio. </td></tr>
</tbody>
</table>
</div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:19:21.363

请改用它来解决您的问题，但是，强烈建议不要将分页属性和表格一起使用[w3schools](http://www.w3schools.com/cssref/pr_print_pagebb.asp)

代码在这里[jsfiddle](http://jsfiddle.net/Rjs47/2/)

```
 <table style="font-size: 12pt; font-family: verdana; page-break-before: always">
 <thead>
 <tr><th align="center">HEADER</th></tr>
 </thead>
 <tbody>
<tr><td> 
```

基本上，我创建了第二个表，您想要的分页符应该出现在该表中。并将 page-break-before: 的样式放在桌面上。

# java - 在服务器上运行带有 cron 的 JAR 文件？

> ID：13070399
> 
> 赞同：0
> 
> 时间：2012-10-25T14:04:53.830
> 
> 标签：java, cron, hosting

我编写了一个 java 程序，它进行一些计算然后发送电子邮件。我已经把它打包成一个罐子了。我需要每周四的午夜运行这个程序。我的电脑很可能不会一直打开，所以我需要它从某个主机上运行。我的问题是 - 是否有支持 cron 和 java 的免费托管场所？

嗯，我查看了应用程序引擎，但在尝试为 Eclipse 安装 Google 插件时遇到了问题。点击安装后出现错误。。

```
Cannot complete the install because one or more required items could not be found.
Software being installed: Google Web Toolkit SDK 2.4.0 2.4.0.v201208080120-rel-r37 (com.google.gwt.eclipse.sdkbundle.e37.feature.feature.group 2.4.0.v201208080120-rel-r37)
Missing requirement: Google App Engine Plugin 3.1.0.v201208080120-rel-r37 (com.google.appengine.eclipse.core 3.1.0.v201208080120-rel-r37) requires 'bundle org.eclipse.wst.sse.core 0.0.0' but it could not be found
Cannot satisfy dependency:
From: Google Plugin for Eclipse 3.7 3.1.0.v201208080120-rel-r37 (com.google.gdt.eclipse.suite.e37.feature.feature.group 3.1.0.v201208080120-rel-r37)
To: com.google.appengine.eclipse.core [3.1.0.v201208080120-rel-r37]
Cannot satisfy dependency:
From: Google Web Toolkit SDK 2.4.0 2.4.0.v201208080120-rel-r37 (com.google.gwt.eclipse.sdkbundle.e37.feature.feature.group 2.4.0.v201208080120-rel-r37)
To: com.google.gdt.eclipse.suite.e37.feature.feature.group 3.1.0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:10:50.307

启动 Amazon 微型实例服务器。它们是免费的，让您可以完全控制机器，包括设置 cron 作业。

[AWS](http://aws.amazon.com/ec2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:07:42.907

查看 Google App Engine： [https ://developers.google.com/appengine/](https://developers.google.com/appengine/)

它支持Java，并且在一定配额内是免费的。

请注意，它不支持运行桌面应用程序，但由于您使用 Java 编写代码，因此它很可能是可移植的，您还可以利用 App Engine 平台服务，例如发送电子邮件。它还有一个 cron 服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:23:18.943

查看 OpenShift ( [https://openshift.redhat.com/app/](https://openshift.redhat.com/app/) )。

它提供了一系列满足小需求的免费工具，以及从那里扩大规模的能力。

# java - 轻量级 RESTful Java 框架

> ID：13070400
> 
> 赞同：8
> 
> 时间：2012-10-25T14:04:58.423
> 
> 标签：java, rest

我一直在研究 Java 中的 RESTful Web 服务，我发现的大多数方法看起来都相当臃肿。其中包括来自 NetBeans、Spring 3 和 EJB 的使用 Singleton 的方法。

我可能是错的，所以请随时纠正我，但这些都“感觉”像是一个相对简单问题的非常复杂的解决方案。

任何人都可以建议一种非常简单且轻量级的方法来在 Java 中执行 RESTful Web 服务吗？

我不相信 MVC 对这些后端是必要的，相反我正在考虑做干净的垂直切片。

我不需要持久性，除非它可以连接到 mongoDB - 所以我不需要任何 ORM 映射。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-19T19:12:26.077

只是为了将另一个选项加入其中，请查看[Spark](http://www.sparkjava.com/)：

> 受 Sinatra 启发的微型 Web 框架

对于 Java。

没有亲自使用它，但它看起来很有希望，我肯定会去看看。

而且，不，我与 Spark 没有任何关系。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-25T14:23:32.337

看看[Dropwizard](http://dropwizard.codahale.com/)，网站上的摘要说明了必须说的内容。

> 由 Yammer 开发以支持其基于 JVM 的后端服务，Dropwizard 将来自 Java 生态系统的**稳定**、**成熟的库整合到一个****简单**、**轻量级的**包中，让您专注于完成工作。
> 
> **Dropwizard 对复杂的配置、应用程序指标、日志记录、操作工具**等提供开箱即用的支持，使您和您的团队能够在尽可能短的时间内交付生产质量的 HTTP+JSON Web 服务。

我最近将它用于一个简单的应用程序，事实证明它非常快速且容易上手并使用它直到应用程序完成。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-25T14:30:05.120

我使用 CXF 和 Jersey for JAX-RS 来创建 RESTful Web 服务。使用它们中的任何一个来创建/部署 RESTful 服务都非常容易。我发现文档足以启动。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-25T14:10:05.190

您可以查看[http://www.restlet.org/](http://www.restlet.org/)。另一种选择是编写一个简单的 servlet 来处理请求，特别是如果这是一个小项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T14:18:23.127

我建议使用[Apache Httpcomponents](http://hc.apache.org/)包。有了它，你可以很容易地拥有一个 Restful Web 服务。

有一个[非阻塞、异步](http://hc.apache.org/httpcomponents-core-ga/httpcore-nio/examples/org/apache/http/examples/nio/NHttpServer.java)HTTP 服务器或[旧式](http://hc.apache.org/httpcomponents-core-ga/httpcore/examples/org/apache/http/examples/ElementalHttpServer.java)阻塞的示例。

另一个优点是这不需要任何应用程序服务器，因此您只需启动您的应用程序，就可以了。如果您不需要 Servlet 容器或 Java EE 的强大功能，这似乎不是一个好方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-25T15:04:41.077

对于“基于数据的”RESTful 服务，您对 MVC 的假设可能是正确的……您希望从 URL 中返回一些 JSON。

对于带有自定义媒体类型格式的真正 RESTful 服务（基于超媒体）..MVC 非常好，因为视图成为您的媒体格式模板。如果您使用 HTML/XML 作为基本媒体格式，则尤其如此。

# java - Dalvik中的“短”字段需要内存吗？

> ID：13070401
> 
> 赞同：8
> 
> 时间：2012-10-25T14:04:59.823
> 
> 标签：java, android, dalvik

Java 虚拟机也可以`int`对字段使用 -sized 宽度`short`（这取决于它们的内部实现）。只有数组 ( `short[]`) 是例外，始终保证它们占用的空间`int[]`也比内部少）。*达尔维克*呢？

例如，我有一个包含 50 个类型字段的类`short`。有时在我的应用程序中，存在 10000 个此类。这意味着`short`字段应该使用 1MB 的内存，但是*如果*Dalvik 在`short`内部使用 4 个字节的值，那么这将是 2MB 的内存使用。

我应该期望 Dalvik 使用多少内存？（这是指它的内部内存使用，我知道它可能不会反映在系统内存使用中，例如因为 Dalvik 已经从系统中保留了更多的内存。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T04:02:25.947

在 dalvik 中，double 和 long 字段是 8 个字节，其他所有内容（包括 short）都是 4 个字节。

另一方面，短数组每个元素占用 2 个字节（除了数组+对象簿记的前期空间）。

**数组**

[`new-array`](https://android.googlesource.com/platform/dalvik/+/e206e7c9f1c58c77ca51f6e80483c94f6c779e4e/vm/mterp/c/OP_NEW_ARRAY.cpp)操作码调用（第[`dvmAllocArrayByClass`](https://android.googlesource.com/platform/dalvik/+/e206e7c9f1c58c77ca51f6e80483c94f6c779e4e/vm/oo/Array.cpp)71 行）分配空间。然后调用`dvmAllocPrimitiveArray`（第 113 行）。在 switch in 中`dvmAllocPrimitiveArray`，“S”大小写用于短数组。你可以看到它调用`allocArray`（第 38 行）width=2。

在 内`allocArray`，它执行以下计算来计算数组的大小：

```
size_t elementShift = sizeof(size_t) * CHAR_BIT - 1 - CLZ(elemWidth);
size_t elementSize = length << elementShift;
size_t headerSize = OFFSETOF_MEMBER(ArrayObject, contents);
size_t totalSize = elementSize + headerSize; 
```

简而言之，在 32 位系统上，此计算为：

```
size_t elementShift = (4 * 8) - 1 - 30; //== 1;
size_t elementSize = length << 1; //i.e. length * 2
size_t headerSize = <some constant value>;
size_t totalSize = length*2 + <some constant value>; 
```

短数组每个元素占用 2 个字节。

**字段**

[`new-instance`](https://android.googlesource.com/platform/dalvik/+/e206e7c9f1c58c77ca51f6e80483c94f6c779e4e/vm/mterp/c/OP_NEW_INSTANCE.cpp)操作码调用（第[`dvmAllocObject`](https://android.googlesource.com/platform/dalvik/+/e206e7c9f1c58c77ca51f6e80483c94f6c779e4e/vm/alloc/Alloc.cpp)181 行）为新对象分配空间。分配的大小基于 的`objectSize`字段`ClassObject`。`objectSize`设置在[`computeFieldOffsets`](https://android.googlesource.com/platform/dalvik/+/e206e7c9f1c58c77ca51f6e80483c94f6c779e4e/vm/oo/Class.cpp)（第 3543 行）。如果您在此函数中找到 fieldOffset 递增的每个实例，您会注意到它始终以 4 个字节的步长递增。

短字段占用 4 个字节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T19:38:19.463

（将是一个评论，但它太长了。）

将 4 字节字段用于“短”本地变量是相当常规的，因为 JVM 在概念上是一台具有 4 字节寄存器的机器，并且所有其他垃圾都在堆栈帧中并没有太大区别。

例如字段，它可能取决于节省存储与必须花费周期进行加宽和对齐的权衡——加宽通常会花费一个小周期，即使在所谓的边界对齐“不可知”的架构上，通常也会有惩罚对于越界访问，因此“打包”字段而不首先重新排列它们以保持字/双字边界可能会降低性能。

因此，如果 JVM 选择“打包”字段，则通常需要重新排列。幼稚的 JVM 将避免重新排列，因为这使得 JVM 的几个方面更简单，但是（作为一个示例）在 AS/400 上，我们发现积极地重新排序和打包实例字段对于需要存储的应用程序的性能提高了 30%。

我从来没有看过达尔维克的内脏。标准 Sun 派生的 JVM 在历史上（没有查看最近的任何内容）依赖于 .class 文件中事物的布局/顺序，因此“自然”不适合重新排序。但是 Dalvik 重新构成了 .class 文件，因此可以更好地进行实例字段重新排序。

请注意，要测试 Dalvik 打包字段的假设，`short`您必须创建一个具有几个背靠背实例字段的类，然后确定生成的对象大小。另外（假设在第一种情况下看到打包），创建一个带有`short`和`int`（或可能`long`）字段交错的类，以查看 Dalvik 是否对它们重新排序以实现打包。

# xpath - XPath 和 nokogiri；教程/示例？

> ID：13070404
> 
> 赞同：5
> 
> 时间：2012-10-25T14:05:12.317
> 
> 标签：xpath, nokogiri, scraper

我是 XPath 的新手，对我来说似乎有点棘手；有时我发现它并没有按照我认为它应该工作的方式工作。

当我使用 XPath 和 Nokogiri 从网站上抓取数据时，如果网站结构复杂，我会觉得很困难。我使用 FirePath 来获取元素的 XPath，但有时它似乎不起作用。我必须删除浏览器添加的额外标签，例如`tbody`.

我真的很想知道是否有一些很好的 XPath 和 Nokogiri 教程和示例。谷歌搜索后我找不到太多。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-26T02:03:33.430

使用 Nokogiri 或任何 XML/HTML 解析器查找一个元素或一组元素的最大技巧是从一个简短的访问器开始，以进入您要查找的内容的大致区域，然后迭代地添加它，很好- 随心所欲地调整，直到你拥有你想要的。

第二个技巧是记住使用`//`XPath 启动，而不是`/`，除非您绝对确定要从文档的根目录启动。`//`就像`'**/*'`Linux 命令行中的通配符。它到处搜索。

此外，不要相信浏览器提供的 XPath 或 CSS 访问器。他们对 HTML 源代码进行了各种修复，包括`tbody`，就像您看到的那样。取而代之的是，使用 Ruby 的 OpenURI or `curl`or来检索原始源代码，并使用类似or`wget`的编辑器查看它，或者使用or将其显示在屏幕上。以这种方式不可能对文件进行任何更改。`vi``vim``less``cat`

最后，使用 XPath 将搜索分解成块，然后让 Ruby 遍历事物通常比尝试提出更难维护或更脆弱的复杂 XPath 更容易/更快。

Nokogiri 本身很容易。您要做的大部分事情都是两种不同方法的简单组合：`search`和`at`. 两者都采用 CSS 或 XPath 选择器。`search`，以及它的兄弟方法`xpath`和`css`，返回 a `NodeSet`，它基本上是一个可以迭代的节点数组。`at`，`css_at`并`xpath_at`返回与 CSS 或 XPath 访问器匹配的第一个节点。在所有这些方法中，`...xpath`变体接受 XPath，而变体接受`...css`CSS 访问器。

一旦你有了一个节点，通常你会想要对它做两件事之一，要么提取一个参数，要么获取它的文本/内容。您可以使用 轻松获取属性`[attribute_to_get]`和使用文本`text`。

使用这些方法，我们可以搜索页面中的所有链接并返回它们的文本和相关的href，使用如下：

```
require 'awesome_print'
require 'nokogiri'
require 'open-uri'
doc = Nokogiri::HTML(open('http://www.example.com'))
ap doc.search('a').map{ |a| [a['href'], a.text] }[0, 5] 
```

哪个输出：

```
[
    [0] [
        [0] "/",
        [1] ""
    ],
    [1] [
        [0] "/domains/",
        [1] "Domains"
    ],
    [2] [
        [0] "/numbers/",
        [1] "Numbers"
    ],
    [3] [
        [0] "/protocols/",
        [1] "Protocols"
    ],
    [4] [
        [0] "/about/",
        [1] "About IANA"
    ]
] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-25T14:29:52.780

我还发现一开始使用 Nokogiri 和 XPath 的学习曲线非常陡峭，但是经过大量的试验和错误后，我现在已经掌握了两者的窍门，所以坚持下去！Nokogiri 真的很强大，值得学习。

关于教程/示例，我假设您已经看过 Nokogiri[教程页面](http://nokogiri.org/tutorials)。我可以想象，如果你不习惯 XPath、XML 解析等，这些教程的水平可能会有点高。

其他一些可能的资源：

*   [Nokogiri 入门](https://www.engineyard.com/blog/getting-started-with-nokogiri)
*   [Ruby 中 Nokogiri 和 XML 入门](http://www.58bits.com/blog/2012/06/13/getting-started-nokogiri-xml-ruby/)
*   [如何在 Nokogiri 中使用 XPath？](https://stackoverflow.com/questions/2080799/how-to-use-xpath-nokogiri)

在 XPath 上，我建议[分五段阅读此摘要](http://www.rpbourret.com/xml/XPathIn5.htm)。XPath 的核心是相当简单，只是非常不直观！我发现 CSS 更容易记住，而且我不认为我是唯一一个。

但最后，虽然教程会有所帮助，但你能做的最好的事情就是打开一个控制台，`require 'nokogiri'`然后开始插电。一段时间后，它就会开始变得有意义。

# javascript - 在我的views.py中使用ajax请求的结果，Django

> ID：13070406
> 
> 赞同：0
> 
> 时间：2012-10-25T14:05:16.200
> 
> 标签：javascript, jquery, ajax, django

多亏了一个 javascript 函数和一个 ajax 请求，我有一个计数来指示用户在使用我的应用程序时所获得的点数。他可以在他“播放”的页面上看到该计数。

现在，我想做的是将此数字传递给我的views.py，以便它修改我的用户的对象“分数”。

我解释。多亏了这个功能，我得到了计数：

```
 var count = parseInt(0);

 setInterval(function() {
   $.ajax({
       type: "GET",
       url: "http://myxml",
       success: Escore
   });
  }, 60000);

function Escore(xml){
   $(xml).find("user").each(function() {

           if($(this).attr("id") === id ) {
               count += parseInt($(this).attr("count"));
               $(".PlayerScore").html(count)
           }
       });
 } 
```

显示在我的 html 中：

```
 <div class="PlayerScore"> </div> 
```

现在，我想修改我的用户的对象“分数”。每分钟，我都会收到一个请求，告诉我玩家在我的 div 中获得的点数。我如何计算这个数以在我的views.py中修改我的“request.user.userprofile.score”？

我希望我的问题不会太混乱。任何帮助都会非常受欢迎。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:27:11.743

嗯，如果我理解了这个问题，您需要执行以下操作：

1.  创建您的视图函数，并在附加到此视图函数的 URL.conf 中创建一个 URL 模式。像/points/save/这样的东西

2.  此功能可能需要用户和用户 ID 的积分（因此您可以更改数据库中的特定用户）

3.  您需要发出 ajax 请求，将点数据和用户 ID 发送到指向您的视图函数的 URL。通过 GET/POST 发送

4.  您的视图函数将从 jquery ajax 调用发送的用户 ID 中查找用户，然后使用从 ajax 调用发送的点编辑用户点

这里有一些帮助指南

[Ajax 与 Jquery 和 Django](http://webcloud.se/log/AJAX-in-Django-with-jQuery/)

[Django 和 Jquery](http://lethain.com/two-faced-django-part-5-jquery-ajax/)

# javascript - dojo.cookie(id) 无法通过 id 间歇性地查找 cookie

> ID：13070407
> 
> 赞同：1
> 
> 时间：2012-10-25T14:05:16.920
> 
> 标签：javascript, dojo

```
_setPrintExportCookieInterval: function(/**String*/requestId, /**function*/closePopup) {
    //have the interval autoexpire after some amount of seconds
    var count = 0;
    var intervalMs = 2000;

    var intervalId = self.setInterval(function() {
        var reportCookie = dojo.cookie(requestId);
        console.debug('requestId ' + requestId);
        if(reportCookie || count > 300000) { //5 mins
            //if there's a status failure, don't close the window
            console.debug('reportCookie ' + reportCookie);
            if(reportCookie == undefined){
                console.debug("print/export request returned with undefined status ");
            } else if(reportCookie == "success") {
                closePopup();
            }  else{
                console.debug("print/export request returned with nonstandard status " + reportCookie);
            }
            window.clearInterval(intervalId);
            //delete the cookie
            dojo.cookie(requestId, null, {path: "/", expires: -1});
            //destroy the iframe
            //dojo.destroy(dojo.byId(requestId));
        };
        count+=intervalMs;
    }, intervalMs);

    return intervalId;
}, 
```

我在使用上述 javascript 函数时遇到问题。问题通常是有时：

```
var reportCookie = dojo.cookie(requestId); 
```

返回`null`，但是当我查看浏览器的调试工具时，我可以看到 cookie 存在的值为`success`. 此函数每调用 10 次就会发生一次。有什么想法为什么`dojo.cookie()`只能在某些时候通过 ID 查找 cookie？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:13:45.443

确保在检索 cookie 时指定路径，否则默认为当前位置。这将允许您从域中的任何路径获取 Cookie。

`dojo.cookie(requestId, null, {path: "/" });`

# winapi - 为什么 DefDlgProc 不自动处理 WM_CLOSE？

> ID：13070408
> 
> 赞同：3
> 
> 时间：2012-10-25T14:05:17.953
> 
> 标签：winapi, modal-dialog, dialog

当我使用创建对话框时[`DialogBox`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645452%28v=vs.85%29.aspx)，除非我在自己的`DLGPROC`函数中处理 WM_CLOSE 并调用`EndDialog`.

我知道这是设计使然，但我很感兴趣，为什么选择 WM_CLOSE 不由 DefDlgProc 自动处理？有什么好的理由吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:40:22.033

问问自己这个：

WM_CLOSE 的默认处理是什么？打电话`EndDialog`？我认为 EndDialog 只能在非常罕见的情况下工作。

其他建议：

*   验证对话框中的用户输入，如果输入超出范围或无效，则显示错误，**不结束对话框**
*   关闭子窗口，释放对话框的子窗口正在使用的资源/内存，释放 COM 对象，基本上：先清理然后结束对话框。

# magento - 在 Magento 中更改 CMS 页面内容（订单和返回页脚链接）

> ID：13070409
> 
> 赞同：0
> 
> 时间：2012-10-25T14:05:23.207
> 
> 标签：magento, magento-1.7

我一直在寻找解决这个问题的几个小时。我想将页脚链接订单和退货的内容更改为刚刚阅读“请联系我们获取您的退货授权号和我们的电话号码。我似乎无法找到此信息所在的位置。

**编辑：**我想更改单击页脚中的“订单和退货”链接时出现的表单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:11:43.890

您是否尝试更改从您的网站页脚链接的页面内容？

如果这是您要执行的操作，请转到该页面并查看浏览器中的标题，然后转到 admin -> CMS -> Pages 并查找该标题

# ruby-on-rails - AppFog - 错误（JSON 503）： 我正在尝试使用以下命令在 AppFog 上部署 Rails 应用程序（2.3.8）： af login af update app_name 我正在使用更新，因为 AppFog 上已经存在该应用程序。但是，我不断收到此错误： Error (JSO 问问题 问问题 2012-10-25T14:05:22.953 2712 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在尝试使用以下命令在 AppFog 上部署 Rails 应用程序（2.3.8）： af login af update app_name 我正在使用更新，因为 AppFog 上已经存在该应用程序。但是，我不断收到此错误： Error (JSON 503):

> ID：13070410
> 
> 赞同：2
> 
> 时间：
> 
> 标签：ruby-on-rails, deployment, appfog

我正在尝试使用以下命令在 AppFog 上部署 Rails 应用程序（2.3.8）：

```
af login
af update app_name 
```

我正在使用更新，因为 AppFog 上已经存在该应用程序。但是，我不断收到此错误：

```
Error (JSON 503): <?xml version="1.0" encoding="u... 
```

它发生在上传文件后。跑步`af update`通常会给我这个错误。事实上，我在大约一百次中只成功运行过一次该命令。我试过全天候在不同的时间部署，但没有成功。我也尝试过使用不同的 AppFog 服务器（美国、欧盟、新加坡），但也没有运气。

还有其他人有同样的问题吗？有谁知道这个的解决方法？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:42:59.120

我也有同样的错误，似乎这与应用程序的大小有关。这是我发布的谷歌组中的帖子和我得到的回复。

[https://groups.google.com/forum/?fromgroups=#!topic/appfog-users/kIMXXYQTl2A](https://groups.google.com/forum/?fromgroups=#!topic/appfog-users/kIMXXYQTl2A)

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T03:09:04.973

我遇到了和你一样的错误，这里是这个错误的解决方案 [一个链接](http://ruby-china.org/wiki/appfog-deploy) 你需要这样做：

> > af push --runtime ruby​​193

或这样做：

> > af update yourappname --runtime ruby​​193

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-20T08:57:42.097

我有同样的问题，但我只需要重试上传代码。发生这种情况是因为 appfog 服务器有一些问题导致您的服务不可用。请登录控制台并检查您的服务，然后`af update`再次运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T20:18:44.413

尝试这些步骤，每次出现错误消息时：

```
$ rvm use 1.9.3
$ gem install af 
$ af login 
```

您的用户名和密码

然后`af update your_application`

有用

# joomla - 最好的 Joomla 表单模块

> ID：13070412
> 
> 赞同：0
> 
> 时间：2012-10-25T14:05:27.573
> 
> 标签：joomla, joomla2.5, joomla-component

我只是在寻找对我们 efor Joomla 更可取的模块的一些意见。它必须：

*   允许 CMS 用户编辑字段等。
*   将数据存储在数据库中
*   没有过多的标记
*   具有易于编辑的主题。

我使用了微风形式和其他一些形式，但它们看起来都有些笨拙，而且对于所需的东西来说太过分了。

我想要一个相当轻量级的表单模块，从开发人员的角度可以轻松定制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:07:41.833

表格！Pro 是最好的表单模块。 [http://www.rsjoomla.com/](http://www.rsjoomla.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T20:50:59.410

**RSForms Pro**是 Joomla 中表单的一个非常好的组件。但它并不是真正的轻量级，它相当广泛。但仍然很容易使用。;)

我会推荐RSForms！

*   维护良好
*   易于使用且功能强大
*   主题引擎
*   价格足够低，可以避免所有麻烦的“免费”组件可以提供

看看他们的网站：[http ://www.rsjoomla.com/joomla-extensions/joomla-form.html](http://www.rsjoomla.com/joomla-extensions/joomla-form.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:23:10.903

您可以使用**Fabrik**扩展。你可以通过这个[链接得到它](http://extensions.joomla.org/extensions/contacts-and-feedback/forms/1659)

它是免费且易于使用的。Fabrik 使您能够创建在 Joomla 中运行的表单和表格，而无需了解 MySQL 和 PHP。然后将您的数据输入谷歌地图、图表或基于 AJAX 的日历等。这是我个人的意见，我使用过它并发现它很有趣。

以及其他扩展，如**RSform**、**Breeze forms**、**Red form**等，但这些都是商业扩展。

# c++ - 头文件中声明的变量未在类范围内声明

> ID：13070414
> 
> 赞同：-6
> 
> 时间：2012-10-25T14:05:33.883
> 
> 标签：c++, oop, class, scope

这个头文件似乎声明了变量 user_matrix 但是当我在默认构造函数中使用它时，它似乎没有被声明。

这是头文件：

```
#include<iostream>
#include<cmath>

class matrix{
 public:

  float** user_matrix;
  int n;

  matrix(int n1,int initiate);

}; 
```

这是我尝试使用的代码。

```
#include"matrix.h"

using namespace std;

matrix::matrix(int n1,int initiate){
  n=n1;
  user_matrix=NULL;
}

int main(){
  return 0;} 
```

你能建议我哪里出错或指出我正确的方向吗？非常感谢您提供的任何帮助。

edit2：原来是目录中的这个文件导致了问题matrix.h.gch。

编辑：根据要求，这是所有代码。

```
#include<iostream>
#include<cmath>

//using namespace std;

class matrix{

  //float** random_mat(int size);

 public:

  float** user_matrix;
  int n;

  matrix(int n1,int initiate);
  /*~matrix(){int i;if(user_matix!=NULL){for(i=0;i<n;i++){delete[] user_matrix[i];};delete[] user_matrix;};}

  matrix multiply(matrix matrix1,matix matrix2);
  matrix add(matrix matrix1,matrix matrix2);
  matrix inverse();

  float** sub_matrix(float** matrix1,int i,int j,int n);
  float det();

  void display();
  void display(matrix matrix1);*/

    }; 
```

* * *

```
#include"matrix.h"

using namespace std;
matrix::matrix(int n1,int initiate){
  n=n1;
  user_matrix=NULL;

  /*switch(initiate){

  case 1 :
    int i;
    user_matrix=new float* [n1];
    for(i=0;i<n1;i++){
      user_matrix[i] =new float [n1];}

    break;
  case 2 :
    user_matrix=random_mat(n);
    break;
  case 3 :
    user_matrix=NULL;

    }*/
}

int main(){

  //matrix m1(1,1);
  return 0;} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:09:00.807

You appear to have two data members with the same name:

```
float** user_matrix;
int n;
float user_matrix; 
```

This cannot work.

Besides that, you are missing a semi-colon after the class declaration:

```
class matrix{
....
}; 
```

// ^ here!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:18:55.653

`user_matrix`被声明两次。一次`float**`和一次`float`。`float**`可以设置为null，但a`float`不能。编译器不接受您将 设置`float user_matris`为 null ，因为它是 a `float`，因此不可为空。重命名其中之一`user_matrix`，您应该会看到您的问题消失了。

# sql - 在 DELETE 中使用 CTE 未执行

> ID：13070418
> 
> 赞同：2
> 
> 时间：2012-10-25T14:05:42.847
> 
> 标签：sql, sql-server, sql-server-2008-r2, common-table-expression

这是运行和运行的原始查询：

```
;WITH includedCs_cte
    AS
    (
    SELECT 
            x.PKey, 
            x.OKey,
            y.CKey 
    FROM  
            #Permissions x
            JOIN WHDATA.dbo.tb_DimC y
                    ON 
                    x.PKey = y.PKey AND
                    x.OKey = y.OKey
        )
, b_cte
    AS
    (
    SELECT
            i.OKey,
            i.PKey
    FROM 
                WHData.dbo.vw_FactCX b
                INNER JOIN includedCs_cte i
                        ON 
                        b.PKey = i.PKey AND
                        b.PlayCKey = i.CKey
    WHERE b.DateKey >= @myLAST28DAYS
    GROUP BY
            i.OKey,
            i.PKey
    )
, POK_cte
    AS
    (
    SELECT
            i.OKey,
            i.PKey
    FROM 
                WHData.dbo.vw_FactCY b
                INNER JOIN includedCs_cte i
                        ON 
                        b.PKey = i.PKey AND
                        b.PlayCKey = i.CKey
    WHERE b.DateKey >= @myLAST28DAYS
    GROUP BY
            i.OKey,
            i.PKey
    )
, includedOKeys
    AS
    (
    SELECT *
    FROM b_cte
    UNION
    SELECT * FROM POK_cte
    )
DELETE FROM #Permissions
FROM #Permissions p
WHERE NOT EXISTS
                    (
                    SELECT 1
                    FROM includedOKeys x
                    WHERE 
                            p.PKey = x.PKey AND
                            p.OKey = x.OKey     
                    ) 
```

如果我将上面的内容更改为下面的内容，那么它会在不到 10 秒的时间内运行。为什么这些执行方式如此不同？

```
;WITH includedCs_cte
    AS
    (
    SELECT 
            x.PKey, 
            x.OKey,
            y.CKey 
    FROM  
            #Permissions x
            JOIN WHDATA.dbo.tb_DimC y
                    ON 
                    x.PKey = y.PKey AND
                    x.OKey = y.OKey
        )
, b_cte
    AS
    (
    SELECT
            i.OKey,
            i.PKey
    FROM 
                WHData.dbo.vw_FactCX b
                INNER JOIN includedCs_cte i
                        ON 
                        b.PKey = i.PKey AND
                        b.PlayCKey = i.CKey
    WHERE b.DateKey >= @myLAST28DAYS
    GROUP BY
            i.OKey,
            i.PKey
    )
, POK_cte
    AS
    (
    SELECT
            i.OKey,
            i.PKey
    FROM 
                WHData.dbo.vw_FactCY b
                INNER JOIN includedCs_cte i
                        ON 
                        b.PKey = i.PKey AND
                        b.PlayCKey = i.CKey
    WHERE b.DateKey >= @myLAST28DAYS
    GROUP BY
            i.OKey,
            i.PKey
    )
, includedOKeys
    AS
    (
    SELECT *
    FROM b_cte
    UNION
    SELECT * FROM POK_cte
    )
SELECT *
INTO #includedOKeys
FROM includedOKeys
CREATE CLUSTERED INDEX ix_inclProdOper ON #includedOKeys(OKey, PKey)

DELETE FROM #Permissions
FROM #Permissions p
WHERE NOT EXISTS
        (
        SELECT 1
        FROM #includedOKeys x
        WHERE 
            p.PKey = x.PKey AND
            p.OKey = x.OKey     
        ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:29:16.217

CTE 在使用时已解决。这意味着如果您在查询中使用它两次，它可能会被解析两次。CTE**并不总是**得到一次解决并缓存在内存中。SQL Server 可以自由地执行它认为合适的查询。

在您的情况下，它可能比这更糟 - 因为您已将它用作 EXISTS 子句中的相关子查询，这是一个逐行操作。这可能意味着该计划导致 #permissions 表的每一行的 CTE 被***解析***！那很可能是所有时间都会去的地方。在 SSMS 中显示执行计划 (Ctrl-L) 是您的朋友。

检查这个[SQLFiddle](http://sqlfiddle.com/#!3/d41d8/5575/0)，它显示没有一个 GUID 是相同的，即使 CTE 只创建 3 行。事实上，我们得到了 18 个不同的 GUID。

```
with cte(guid,other) as (
  select newid(),1 union all
  select newid(),2 union all
  select newid(),3)
select a.guid, a.other, b.guid guidb, b.other otherb
from cte a
cross join cte b
order by a.other, b.other; 
```

# python - django-mutant 在 django-admin 中创建模型

> ID：13070424
> 
> 赞同：15
> 
> 时间：2012-10-25T14:05:55.537
> 
> 标签：python, django, dynamic, django-models, models

我开始尝试`django-mutant 0.0.2`(on `django 1.4.2`)，但由于缺乏文档，我几乎一无所获。我通过项目描述理解的方式可以使用它来动态创建我的模型，所以我认为我可以将它与`django-admin`接口连接起来，这样我就可以创建模型并在那里定义它的所有字段。我看到了一些其他的替代品，比如`django-eav`, `dynamo`, Will Hardy's`dynamic-models`等，但听起来这是迄今为止最好的实现，所以我认为我应该使用它。

我把这个放在`settings.py`：

```
INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django.contrib.admin',
    'south',
    'polymodels',
    'mutant',
    'mutant.contrib.boolean',
    'mutant.contrib.temporal',
    'mutant.contrib.file',
    'mutant.contrib.numeric',
    'mutant.contrib.text',
    'mutant.contrib.web',
    'mutant.contrib.related',
    'dynamodels'   # this is the name of my testapp
) 
```

我打开了源代码`django-mutant`来弄清楚我应该做什么，我认为将`mutant.models.ModelDefinition`and`mutant.models.FieldDefinition`导入我的`admin.py`并注册它们就足够了，所以我尝试了这个：

```
from django.contrib import admin

from mutant import models

class ModelDefinitionAdmin(admin.ModelAdmin):
    pass

admin.site.register(models.ModelDefinition, ModelDefinitionAdmin)

class FieldDefinitionAdmin(admin.ModelAdmin):
    pass

admin.site.register(models.FieldDefinition, FieldDefinitionAdmin) 
```

在同步数据库之后，我让它运行起来，我的管理界面中有一个“突变”部分，里面有一个“模型定义”和“字段”。我成功添加了一个模型，尽管我无法指定`INSTALLED_APPS`. 添加字段失败严重，因为它的`Model def`参数我确实选择了我之前创建的模型（它是列表中唯一的模型），并且我确实为`Content type`. 点击保存按钮给了我这个：

```
NotImplementedError at /admin/mutant/fielddefinition/add/

No exception supplied
...
...
/home/user/dev/virenvs/dynamicmodels/lib/python2.6/site-packages/django_mutant-0.0.2-py2.6.egg/mutant/models/field/__init__.py in save
        return super(FieldDefinition, self).save(*args, **kwargs) ...

/home/user/dev/virenvs/dynamicmodels/lib/python2.6/site-packages/django_polymodels-1.0.1-py2.6.egg/polymodels/models.py in save
        return super(BasePolymorphicModel, self).save(*args, **kwargs) ...

/home/user/dev/virenvs/dynamicmodels/lib/python2.6/site-packages/django_mutant-0.0.2-py2.6.egg/mutant/models/model/__init__.py in save
        self.model_def.model_class(force_create=True) ...

/home/user/dev/virenvs/dynamicmodels/lib/python2.6/site-packages/django_mutant-0.0.2-py2.6.egg/mutant/models/model/__init__.py in model_class
            model_class = self._create_model_class(existing_model_class) ...

/home/user/dev/virenvs/dynamicmodels/lib/python2.6/site-packages/django_mutant-0.0.2-py2.6.egg/mutant/models/model/__init__.py in _create_model_class
        attrs = self.get_model_attrs(existing_model_class) ...

/home/user/dev/virenvs/dynamicmodels/lib/python2.6/site-packages/django_mutant-0.0.2-py2.6.egg/mutant/models/model/__init__.py in get_model_attrs
                            for f in self.fielddefinitions.select_subclasses())) ...

/home/user/dev/virenvs/dynamicmodels/lib/python2.6/site-packages/django_mutant-0.0.2-py2.6.egg/mutant/models/model/__init__.py in <genexpr>
                            for f in self.fielddefinitions.select_subclasses())) ...

/home/user/dev/virenvs/dynamicmodels/lib/python2.6/site-packages/django_mutant-0.0.2-py2.6.egg/mutant/models/field/__init__.py in field_instance
        cls = self.get_field_class() ...

/home/user/dev/virenvs/dynamicmodels/lib/python2.6/site-packages/django_mutant-0.0.2-py2.6.egg/mutant/models/field/__init__.py in get_field_class
            raise NotImplementedError 
```

所以这可能不是我应该定义我的字段（甚至模型？）的方式。在项目页面上有一个片段子`FieldDefinition`类，创建一个 DateFieldDefinition，如果我将该片段放入我的`models.py`并将该类注册到我的管理员，我可以成功添加任何类型的字段。这是否意味着我必须对我想要使用的所有字段类型进行子类化才能在管理员中创建它们？当我以这种方式创建它们时，它们实际上是否绑定到我的模型？是否有一个工作示例可以至少显示基础知识？抱歉，这是我能想到的最短版本，任何建议都将不胜感激。

**更新：** 我在指定我尝试的版本时犯了一个错误，我得到了最新开发版本的 NotImplementedError （顺便说一下也是 0.0.2），但是当我尝试从 PyPi 得到的真正的 0.0.2 时以同样的方式作为开发人员，我收到了一个没有错误消息的表单错误，但是在验证时肯定会失败。所以通常我并不接近解决方案。

**UPDATE2：** 我在管理员中动态注册了突变体的基本字段类型，现在我可以使用此管理片段添加/更改/删除模型和字段：

```
from django.contrib import admin

from mutant import models

for field_type in models.FieldDefinitionBase._field_definitions.values():
    attrs = {'model': field_type}
    FieldDefAdmin = type('{0}Admin'.format(field_type.__name__),
                         (admin.ModelAdmin,),
                         attrs)
    admin.site.register(field_type, FieldDefAdmin)

class ModelDefinitionAdmin(admin.ModelAdmin):
    model = models.ModelDefinition

admin.site.register(models.ModelDefinition, ModelDefinitionAdmin) 
```

但是，例如，当我从 mysql 控制台检查数据库中的实际数据时，我的表不存在于数据库中。有mutants的表，它们包含关于我的模型和字段的条目，但我认为一旦构建了动态模型类，它也会按原样写入数据库。

**UPDATE3：** 实际上我错了，该表是在我的数据库中找到的，它只是以“mutant_”为前缀，所以我不知道它在那里。看起来这将是使用它的有效方法，尽管要制作一个体面的用户友好界面来使用它需要更多的工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-22T17:57:53.440

好的，我很抱歉，但我太忙了（而且可能更懒惰），无法像我说的那样完成一个像样的应用程序。但至少为了提供一点帮助，我创建了一篇关于该主题的肮脏博客文章，并添加了一个用于突变体的示例 CRUD 应用程序，但请注意，它真的很基础，只是为了演示启动和运行的前几个步骤。

[http://integricho.github.io/2013/07/22/mutant-introduction/](http://integricho.github.io/2013/07/22/mutant-introduction/)

[https://github.com/integricho/mutant-sample-app](https://github.com/integricho/mutant-sample-app)

# java - Java Active Remote Compiler (JARC) - 未绑定异常

> ID：13070428
> 
> 赞同：5
> 
> 时间：2012-10-25T14:06:16.583
> 
> 标签：java, rmi

最近，我需要在 java 上进行远程编译，所以，我找到了`JARC`：

[http://pointdefence.net/jarc/index.html](http://pointdefence.net/jarc/index.html)

因此，我执行了运行`RMI`服务器的 shell 脚本，但是当我运行 shell 脚本来编译 java 客户端时，它会抛出如下异常：

```
 java.rmi.NotBoundException: jarc.server.JavaCompilerActive1.0 
```

所以，我想在远程服务器上编译一个简单的“hello world”程序，有人知道实现这个的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T09:02:57.617

> java.rmi.NotBoundException: jarc.server.JavaCompilerActive1.0

指定的名称未绑定在您查找的注册表中。任何一个：

1.  您的客户查找了错误的注册表。

2.  您的服务器绑定到错误的注册表。

3.  您的服务器以不同的名称绑定到正确的注册表。

# jquery - 在 AJAX 调用 Rails 应用程序后使用 js.erb 呈现页面后，HTML 类没有响应 jQuery 操作

> ID：13070429
> 
> 赞同：2
> 
> 时间：2012-10-25T14:06:19.480
> 
> 标签：jquery, html, ruby-on-rails, ajax, erb

我正在编写一个具有以下功能的应用程序，这是通过对控制器的 AJAX 调用来完成的。在那次调用之后，我渲染了使用 js.erb 单击的按钮的相反按钮，该按钮渲染了我想要显示的按钮。但是，我的按钮上有悬停功能，单击此按钮后，悬停不再起作用。它是正确的按钮类，但我用来更改按钮状态的 jQuery 不起作用。

这是一些代码，我的 jQuery：

```
unfollow_button = $(".unfollow-button");
unfollow_button.hover(
    function(){
        $(this).addClass("btn-danger");
        $(this).text("Unfollow");
    }, 
    function () {
        $(this).removeClass("btn-danger");
        $(this).text("Following");
    }
); 
```

这是我的看法：

```
<% if current_user.following?(f) %>
<%= link_to "Following", user_unfollow_teacher_path(f), :class => "btn unfollow-button", :remote => true %>
<% else %>
<%= link_to "Follow", user_follow_teacher_path(f), :class => "btn btn-primary purple-button", :remote => true %>
<% end %> 
```

这是我使用的 js.erb 文件：

```
$("#follow_form").html("<%= escape_javascript(render('users/follow')) %>") 
```

而这个被渲染的部分是：

```
<%= link_to "Following", user_unfollow_teacher_path(@user), :class => "unfollow-button btn", :remote => true %> 
```

当我单击取消关注时，jQuery 工作正常，然后在我再次关注并将按钮设置为取消关注按钮后，悬停动作停止工作。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T17:05:02.767

您将不得不在文件中再次调用该 jquery 代码`js.erb`：

```
$("#follow_form").html("<%= escape_javascript(render('users/follow')) %>")
$(".unfollow-button").hover(
    function(){
        $(this).addClass("btn-danger");
        $(this).text("Unfollow");
    }, 
    function () {
        $(this).removeClass("btn-danger");
        $(this).text("Following");
    }
); 
```

最好不要将代码放在多个位置，因此我通常会设置一个初始化程序，这样我就可以在 .erb 文件中调用相同的代码（下面的代码在 coffeescript 中，但您可以[在此处将其转换为 js](http://js2coffee.org/)

init.js.coffee

```
(myApp, $, undefined_) ->
  myApp.init = myApp.init or {}

  myApp.init.followHover = ->
    $(".unfollow-button").hover(#code here)

) window.myApp = window.myApp or {}, jQuery

$ ->
  myApp.init.followHover() 
```

然后，当您在 js.erb 中再次需要它时，只需调用它！

```
$("#follow_form").html("<%= escape_javascript(render('users/follow')) %>")
myApp.init.followHover() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-11T13:24:58.157

像这样委托你的javascript事件。现在 JQUERY 在 AJAX 调用后不会中断，并且在打开 turbolinks 的情况下可以很好地工作。

```
 $(function() {

      $("#follow_form").parent().delegate(".unfollow-button", "mouseover",
        function(){
          $(this).val("Unfollow");
          $(this).addClass("btn-danger");
        }
      );

      $("#follow_form").parent().delegate(".unfollow-button", "mouseout",
        function(){
          $(this).val("Following");
          $(this).removeClass("btn-danger");
        }
      );

    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:49:42.487

我认为问题在于 jQuery 事件侦听器不知道新插入的 DOM 元素。尝试使用`unfollow_button.on('hover', function()...`

更多信息：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

# asp.net - 如何在 ASP.NET Web 窗体中实现非平凡编辑

> ID：13070430
> 
> 赞同：0
> 
> 时间：2012-10-25T14:06:24.053
> 
> 标签：asp.net, mvp

假设我们有这些类：

```
class Teacher {
    public int Id { get; set; }
    public string FullName { get; set; }
    public List<Course> Courses { get; set; }
}

class Course {
    public int Id { get; set; }
    public string CourseName { get; set; }
} 
```

现在假设我从教师列表中选择了一个教师实例，并且我已被重定向到一个页面，我可以在其中编辑该教师可以教授的课程。所以有一个她可以在moemt教授的所有课程的列表（从数据库中获取），带有一个“删除”选项和一个用户可以选择的所有可用课程的下拉列表；当用户从下拉列表中选择一门课程时，它会被添加到“她可以教”列表中。最后是一个“保存”按钮。

但是，当用户从列表中删除课程或添加课程时，我不想将其保存到数据库中，直到按下“保存”按钮。我的问题是：**在编辑和保存到数据库之前，在哪里保存 Teacher 对象及其子 Course 对象？**

到目前为止，我一直在使用 Session 来保存已编辑的对象；添加一个新课程只是将一个子对象添加到它的集合中，删除一个课程会从 Session 中删除一个子对象。这是最好的方法还是有更好的方法（或者至少更干净）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:11:22.400

会话应该没问题，只要您可以将所有这些都保存在内存中，并且如果会话过早丢失，则可能会丢失它。

但是，如果您正在寻找持久性，我可能会建议一个“待处理”数据库表，您可以在其中保留待处理的事务（添加和删除），直到它们准备好被保存。当您在此屏幕上时，将真实数据与待处理数据结合起来，当您保存时，将待处理更改应用于真实数据并终止待处理更改。

如果他们取消，您所要做的就是删除待处理的记录。

# entity-framework - 使用 Code First 迁移的实体框架的唯一约束

> ID：13070431
> 
> 赞同：20
> 
> 时间：2012-10-25T14:06:25.810
> 
> 标签：entity-framework, ef-code-first, asp.net-mvc-4, code-first

我正在 MVC 4 应用程序上进行实体框架 (v 5) 代码优先迁移。我想在数据库级别添加一个唯一约束。

我知道这可以在创建表时完成，但我已经有一个表。 [http://msdn.microsoft.com/en-US/data/jj591621](http://msdn.microsoft.com/en-US/data/jj591621)

我尝试了以下，标记为答案：[EFCodeFirst 和 SqlCe4 的唯一约束](https://stackoverflow.com/questions/6727738/unique-constraint-with-efcodefirst-and-sqlce4)

我的数据库上下文略有不同，我提供的连接名称如下

```
public AppDatabaseContext() : base("MyConnectionDBContext") 
```

当我使用包管理控制台更新数据库时，不会调用覆盖的种子方法：

```
protected override void Seed(AppDatabaseContext context) 
```

我还尝试了以下方法：[http ://romiller.com/2010/07/31/ef-ctp4-tips-tricks-running-additional-ddl/](http://romiller.com/2010/07/31/ef-ctp4-tips-tricks-running-additional-ddl/)

我没有使用嵌套类，这是因为我似乎必须通过 app.config 注册初始化程序。在代码中初始化它时，我无法让它工作。InitializeDatabase 被调用，但以下条件永远不会成立：

```
(!context.Database.Exists() || !context.Database.ModelMatchesDatabase()) 
```

这是因为这发生在迁移运行之后......

我也在一个阶段尝试过这个：[Entity Framework Code First 中的唯一约束](https://stackoverflow.com/questions/4413084/unique-constraint-in-entity-framework-code-first)，它和以前一样的问题，这个条件永远不会返回 true。

理想情况下，我想在我的迁移文件中包含一些标准 SQL。有没有办法做到这一点？如果没有，我在哪里可以看到如何使用代码优先迁移来实现这一点？

谢谢！

更新：

有什么原因我不能使用 SQL 函数吗？

```
 public override void Up()
 {
        AddColumn("Posts", "Abstract", c => c.String());

        Sql("UPDATE Posts SET Abstract = LEFT(Content, 100) WHERE Abstract IS NULL");
 } 
```

显然使用正确的SQL ...

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-26T19:03:20.543

通过代码优先迁移，我刚刚在`Up()`方法中使用了它来在单个列上添加唯一索引：

```
CreateIndex(table: "Organisations", 
            column: "Name", 
            unique: true, // unique index
            name: "MyIndex"); 
```

...然后在`Down()`方法中：

```
DropIndex(table: "Organisations", 
          name: "MyIndex"); 
```

这就是你所追求的吗？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-03-27T03:45:14.427

从 EF 6.1 开始，您现在可以在模型中使用

一个属性

```
 [Index("IX_UniqueName", IsUnique = true)]
 public string Name {get;set;} 
```

或流利

```
Property(s => s.Name).HasColumnAnnotation(IndexAnnotation.AnnotationName,
    new IndexAnnotation(
        new IndexAttribute("IX_UniqueName") { IsUnique = true })); 
```

流利的方法并不像它疯狂的冗长 IMO 那样完美，但至少现在是可能的。

更多关于 Arthur Vickers 博客[http://blog.oneunicorn.com/2014/02/15/ef-6-1-creating-indexes-with-indexattribute/](http://blog.oneunicorn.com/2014/02/15/ef-6-1-creating-indexes-with-indexattribute/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-16T21:39:12.950

您可以使用`Add-Migration`包管理器控制台中的命令构建新的迁移。创建空迁移后，在`Up`方法中，您可以使用类的`CreateIndex`方法`DbMigration`来创建新索引。它看起来像这样：

```
CreateIndex("dbo.Accounts", "AccessKey", unique: true);
```

# mysql - Mysql 更新：ERROR 1292 (22007)：截断不正确的 DOUBLE 值

> ID：13070433
> 
> 赞同：1
> 
> 时间：2012-10-25T14:06:31.603
> 
> 标签：mysql

我的问题如下：我有一个表`foo_table`，其中 id`ID`列为`bigint (primary key)`，名称`NAME`列为`varchar(80)`，代码 COLUMN 代码为`varchar(20)`。我对 CODE 列有唯一的约束。

如果我在代码列中只用“数字”字符串填充此表，然后有一天决定在该代码列中添加一行，令人惊讶的是，“字符串”字符串，比如输入“我的代码”，它工作正常！当我尝试更新我以前的一条记录时出现错误，该记录的 CODE 值为数字；在这种情况下，我得到一个著名的错误：

> 错误 1292 (22007)：截断不正确的 DOUBLE 值：“我的代码”。

我什至没有碰那个记录！我认为 MySQL 正在尝试检查唯一约束并尝试将 CODE 列中的每个值都转换为 double，但这很疯狂，而且非常不专业。

有人有解决方案吗？就像在 MySQL 中关闭字符串<->数字转换一样？

提前致谢。

编辑：好的，我有示例代码，但是在创建它时，我看到了如何解决问题，就我而言，这在 MySQL 中仍然是一个问题：

```
CREATE TABLE foo_table (
ID bigint(20) NOT NULL DEFAULT '0', 
NAME varchar(80) DEFAULT NULL,
CODE varchar(20) NOT NULL DEFAULT '', 
UNIQUE KEY foo_table_uk (CODE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC;

insert into foo_table (id, name, code) values (1, 'one', '1');
insert into foo_table (id, name, code) values (2, 'two', '2');
insert into foo_table (id, name, code) values (3, 'three', 'three');

update foo_table set name='a-one', code='1' where code=1; <-- This update throws the error

update foo_table set name='a-one', code='1' where code='1'; <-- this update works fine 
```

# twitter-bootstrap - Twitter Bootstrap typeahead 和 jQuery Validate

> ID：13070435
> 
> 赞同：6
> 
> 时间：2012-10-25T14:06:45.017
> 
> 标签：twitter-bootstrap, jquery-validate, typeahead

我想使用 Twitter Bootstrap typeahead 对文本输入字段进行验证。所以我尝试如下实现它。名称字段的验证工作正常。如果您开始输入并再次清除该字段，则会启动验证。但是，在位置字段`data-provide="typeahead"`上，它不会发生这种情况。但是，当您单击提交按钮时，验证确实会启动。

我尝试调试它，但据我所知，Bootstrap 和 jQuery Validate 都正确注册了它们的事件处理程序。更奇怪的是，预输入是在验证之前安装的。因此，人们会期望 typeahead 会被破坏。但它不是...

索引.html：

```
<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.0/css/bootstrap-combined.min.css" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.10.0/jquery.validate.js"></script>
<script type="text/javascript" src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.0/js/bootstrap.js"></script>
<script type="text/javascript">
$(function() {
    $('[data-provide="typeahead"]').each(function() {
        var url = $(this).attr('data-url');
        $(this).typeahead({
            source : function(query, process) {
                return $.get(url, {
                    name : query
                }, function(data) {
                    var json = JSON.parse(data);
                    return process(json.locations);
                });
            },
            items : 5
        });
    });
    $('#settings-form').validate({
        rules: {
            name: {
                required: true
            },
            location: {
                required: true
            }
        },
        highlight: function(label) {
            var controlGroup = $(label).closest('.control-group');
            controlGroup.addClass('error');
            var buttons = controlGroup.find('button');
            buttons.addClass('btn-danger');
            buttons.attr('disabled', 'disabled');
        },
        success: function(label) {
            var controlGroup = $(label).closest('.control-group');
            controlGroup.removeClass('error');
            var buttons = controlGroup.find('button');
            buttons.removeClass('btn-danger');
            buttons.removeAttr('disabled');
        },
        errorPlacement: function(error, element) {
            error.appendTo(element.closest('.control-group'));
        }
    });
});
</script>
<style type="text/css">
body {
    margin: 20px;
}
label.error {
    margin-left: 160px;
    margin-bottom: 0;
}
</style>
</head>
<body>
    <form id="settings-form" class="form-horizontal" action="#" method="GET">
        <fieldset>
            <div class="control-group">
                <label class="control-label" for="name">Name</label>
                <div class="controls">
                    <input type="text" id="name" name="name" autocomplete="off" />
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="location">Location</label>
                <div class="controls">
                    <input type="text" id="location" name="location" autocomplete="off" data-provide="typeahead" data-url="locations.json" />
                </div>
            </div>
        </fieldset>
        <div class="control-group">
            <div class="controls">
                <button class="btn" data-dismiss="modal">Cancel</button>
                <button class="btn btn-primary" type="submit">Save changes</button>
            </div>
        </div>
    </form>
</body>
</html> 
```

位置.json：

```
{
    "locations": [
        "Berlin",
        "London",
        "Madrid",
        "New York",
        "Paris"
    ]
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T14:34:47.520

`e.stopPropagation()`是的 - 这是因为 Twitter Bootstrap Typeahead 通过in 函数隐藏了验证器的事件`Typeahead.prototype.keyup()`

添加一个 keyup-handler 以`#location`“手动”调用验证，使其工作：

```
<input type="text" id="location" name="location" autocomplete="off" 
 data-provide="typeahead" onkeyup="$(this).validate();" data-url="locations.json" /> 
```

它不会改变行为/验证设置，只是确保完全调用验证..

# magento - 用户尝试创建新帐户时出现“服务器错误” - Magento 1.7

> ID：13070441
> 
> 赞同：0
> 
> 时间：2012-10-25T14:07:11.573
> 
> 标签：magento, magento-1.7, internal-server-error

我正在建立我们的 Magento 1.7 商店，希望能尽快推出。我注意到一个问题：

当用户尝试创建一个新帐户时，他们在 /customer/account/create 页面上填写他们的信息就好了，然后当他们点击提交时，他们得到这个 500 错误：

> [该网站在检索http://example.com/customer/account/createpost/](http://example.com/customer/account/createpost/)时遇到错误 。

但是，该帐户实际上是创建的。

用户在忘记密码页面上提交电子邮件时的类似处理，他们按下提交并得到这个：

> [该网站在检索http://example.com/customer/account/forgotpasswordpost/](http://example.com/customer/account/forgotpasswordpost/)时遇到错误 。

不发送电子邮件。

如果您看到这一点并且知道如何帮助解决这个问题，那么您的建议将不胜感激，真的。

如果有帮助，我们使用的是主题，而不是默认主题。

* * *

**编辑**- （我被问到是否检查过服务器错误）对于上述情况，我的服务器错误显示如下：

忘记密码提交显示此错误：

> 致命错误：在第 438 行的 D:\Magento\app\code\core\Mage\Core\Model\Email\Template.php 中调用未定义的方法 Mandrill_API::addTo()

和

创建帐户提交显示此错误：

> 致命错误：在第 438 行的 D:\Magento\app\code\core\Mage\Core\Model\Email\Template.php 中调用未定义的方法 Mandrill_API::addTo()

也是。

这是该 Template.php 文件的 6 行（437-442）：

```
foreach ($emails as $key => $email) {
            $mail->addTo($email, '=?utf-8?B?' . base64_encode($names[$key]) . '?=');
        }

        $this->setUseAbsoluteLinks(true);
        $text = $this->getProcessedTemplate($variables, true); 
```

* * *

**[更新]**

我了解到，当我为忘记密码输入一个随机的假电子邮件，然后按提交时，会出现一个确认信息，上面写着“如果这封电子邮件存在，那么一封新电子邮件已发送到该电子邮件！”，但是当我提交时一封真实现有客户的电子邮件，然后它给了我我提到的 500 错误。

仍然一无所获 - 如果有人看到这一点，并且您可能有一点时间来帮助解决这个问题，希望 Talos 保佑您！

* * *

**[已解决]** 我发现这是交易电子邮件的问题。由扩展程序 Mandrill 引起，当我安装 MailChimp 扩展程序时添加到 magento，称为“MageMonkey - ebizmarts 的 MailChimp 集成”

一旦我启用 Mandrill，在配置中，高级，所有交易和交易电子邮件都可以正常工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:38:54.643

可能是 .htaccess 或服务器配置问题。它在哪里托管？您在安装的根目录中有一个 .htaccess 文件吗？

# javascript - 未捕获的 ReferenceError：$ 未定义

> ID：13070444
> 
> 赞同：0
> 
> 时间：2012-10-25T14:07:29.727
> 
> 标签：javascript, jquery, less, head.js

我正在使用 LESS.js、Jquery、Respond.js 和 Freetile.js。

我使用 Head.JS 加载它们（对我来说是第一次）。

有人可以检查我为什么会收到此错误吗？我查看了 Chrome 开发人员工具，所有脚本似乎都加载得很好（我知道这通常是 Jquery 未加载或使用后加载 Jquery 的错误）。

我真的把我的头撞在墙上，所以非常感谢帮助。

您可以在这里找到我正在开发的演示站点：----

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:12:06.673

`$`jQuery加载后访问：

```
head.js(
     "http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js",
     "assets/js/less.js",
     "assets/js/respond.min.js",
     "assets/js/jquery.freetile.min.js", function() {
    $('#container').freetile();
}); 
```

实际上[head.js 文档](http://headjs.com/)推荐这个：

```
// use jQuery on the body of the page even though it is not included yet
head.ready(function() {
   $('#container').freetile();
});

// load jQuery whenever you wish bottom of the page
head.js("http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js",
     "assets/js/less.js",
     "assets/js/respond.min.js",
     "assets/js/jquery.freetile.min.js"); 
```

# java - 使用 json-lib-2.4-jdk15.jar 从 JSON 中获取数据

> ID：13070446
> 
> 赞同：1
> 
> 时间：2012-10-25T14:07:32.470
> 
> 标签：java, json, getjson

我正在尝试使用 json-lib jar 解析一个简单的 json 数据。JSON数据具有以下格式：

```
{"plantDetails":
    [{
        "common":"New Plant 1",
            "botanical":"",
            "light":"Mostly Shady",
            "price":0,
            "availDate":"10/25/2012",
            "indoor":false,
            "id":null
    },{
        "common":"New Plant 1",
            "botanical":"",
            "light":"Mostly Shady",
            "price":0,
            "availDate":"10/25/2012",
            "indoor":false,
            "id":null
    },{
        "common":"New Plant 1",
            "botanical":"",
            "light":"Mostly Shady",
            "price":0,
            "availDate":"10/25/2012",
            "indoor":false,
            "id":null
    }]
} 
```

为此，我使用以下代码：

```
try {
    net.sf.json.JSONObject jsonObject = net.sf.json.JSONObject.fromObject(jb.toString());               
    JSONArray arr = jsonObject.getJSONArray("plantDetails");
    //net.sf.json.JSONObject jsonObject1 = jsonObject.getJSONObject("plantDetails");
    Iterator iter = arr.iterator();
    while (iter.hasNext()) {
        JSONObject object = (JSONObject) iter.next();
        System.out.println(object.getString("common"));
        System.out.println(object.getString("botanical"));
    }
} catch (Exception e) {
    // crash and burn
    System.out.println(e.getMessage());
}
} catch (Exception e) {
    e.printStackTrace();
} 
```

当有多个 JSONObject（在我的情况下为 3 个）时，此代码可以正常工作。但不幸的是，当 JSON Object 的数量只有 1 时它不起作用。它抛出异常：`net.sf.json.JSONException: JSONObject["plantDetails"] is not a JSONArray.`

如何检查是否存在多个 JSONObject？

解决此问题的一种方法是在仅一个 JSONObject 的 try/catch 块中引发上述异常后使用这段代码，然后获取相应的值：

```
net.sf.json.JSONObject jsonObject1 = jsonObject.getJSONObject("plantDetails"); 
```

但我不想这样：

1）可能有一些更好的方法来实现相同的目标，而不是捕获异常并处理它以获取 Object 值

2）需要知道实现相同目标的最佳方法

请让我知道这件事。

问候，

# css - min-height: auto not working in Opera

> ID：13070456
> 
> 赞同：8
> 
> 时间：2012-10-25T14:07:58.333
> 
> 标签：css, opera

I have noticed that `min-height` is not working in Opera. I am trying something like this:

```
<div class="content"><div>
<div class="content newstyle"><div> 
```

And my CSS code is:

```
.content {
    min-height: 600px;
}
.newstyle {
    min-height: auto;
} 
```

And Opera just acts like `min-height` didn't exist.
If I apply any other style in `.newstyle`, like background or whatever, then it works well. But `min-height: auto` seems not to work...

Any idea?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-25T14:17:20.710

[`min-height`CSS2.1 定义了to be的初始值`0`，not `auto`。](http://www.w3.org/TR/CSS2/visudet.html#min-max-heights)该值`auto`在 CSS2.1 中从未存在，因此在 CSS2.1 中无效。只需使用`min-height: 0`：

```
.content {
    min-height: 600px;
}
.newstyle {
    min-height: 0;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-25T14:09:43.413

`auto;` is not a valid `value` for `min-height` property and hence Opera ignores...

You can specify `min-height` using `px`, `cm` etc, or `%` or `inherit`

[Sitepoint Reference](http://reference.sitepoint.com/css/min-height)

# php - Form not picking up first name

> ID：13070459
> 
> 赞同：2
> 
> 时间：2012-10-25T14:08:10.480
> 
> 标签：php, html, post, forms

I am having trouble figuring our exactly why my php code won't pick up the first name from my form, I hope you guys can help.

Everything else is emailed through fine, just the first name field which is element_1_1.

Here is the PHP:

```
$<?php
$errors = ''; 
$myemail = 'example@example.co.uk';
if( empty($_POST['element_1_1'])  ||
empty($_POST['element_1_2'])  ||
empty($_POST['element_3']) ||
empty($_POST['element_2'])  ||
empty($_POST['element_5'])  ||
empty($_POST['element_4']))

$name = $_POST['element_1_1'];
$lastname = $_POST['element_1_2'];
$email_address = $_POST['element_3']; 
$number = $_POST['element_2'];
$area = $_POST['element_5'];
$discount = $_POST['element_4'];

if (!preg_match(
"/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/i", 
$email_address))
{
    $errors .= "\n Error: Invalid email address \n";
}

if( empty($errors))
{
$to = $myemail; 
$email_subject = "";
$email_body = "".

"\n First Name:   $name \n  \n Second Name:   $lastname \n  \n Email:   $email_address \n  \n Phone Number:   $number \n \n Area(s):   $area \n \n Discount:   $discount \n".

$headers = "From: example@example.co.uk\n"; 
$headers .= "Reply-To: $email_address";

mail($to,$email_subject,$email_body,$headers);
//redirect to the 'thank you' page
header('Location: http://www.example.co.uk');
} 
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
<html>
<head>
<title>Contact form handler</title>
</head>

<body>
<!-- This page is displayed only if there is some error -->
<?php
echo nl2br($errors);
echo "";
echo " \n <a href='http://www.example.com'>Go     Back</a> \n";
?>

</body>
</html> 
```

And here is the form:

```
<div id="bmvform-form_container">
    <form id="form_507993" class="appnitro"  method="post" action="formsend.php">
                <div class="form_description">
        <h2>Want To Receive Our Properties?</h2>
        <p><em>At Pure Acquisitions, we respect your privacy. Any details provided will NOT be sent to any third party without your consent.</em></p>
    </div>                      
        <ul >

    <li id="li_1" >
    <label class="description" for="element_1">Name </label>
    <span>
        <input id="element_1_1" name="element_1_1" class="element text" maxlength="255" size="14" value=""/>
        <label>First</label>
    </span>
    <span>
        <input id="element_1_2" name="element_1_2" class="element text" maxlength="255" size="14" value=""/>
        <label>Last</label>
    </span><p class="guidelines" id="guide_1"><small>We don't want to be rude!</small></p> 
    </li>       <li id="li_3" >
    <label class="description" for="element_3">Email Address </label>
    <div>
        <input id="element_3" name="element_3" class="element text medium" type="text" maxlength="255" value=""/> 
    </div><p class="guidelines" id="guide_3"><small>To send you important stuff!</small></p> 
    </li>       <li id="li_2" >
    <label class="description" for="element_2">Phone Number </label>
    <div>
        <input id="element_2" name="element_2" class="element text medium" type="text" maxlength="255" value=""/> 
    </div><p class="guidelines" id="guide_2"><small>We need to let you know about our properties!</small></p> 
    </li>       <li id="li_5" >
    <label class="description" for="element_5">Locations You Are Interested In </label>
    <span>
        <input id="element_5_1" name="element_5" class="element radio" type="radio" value="All" />
        <label class="choice" for="element_5_1">All</label>
        <input id="element_5_2" name="element_5" class="element radio" type="radio" value="London" />
        <label class="choice" for="element_5_2">London</label>
        <input id="element_5_3" name="element_5" class="element radio" type="radio" value="South of England" />
        <label class="choice" for="element_5_3">South of England</label>
        <input id="element_5_4" name="element_5" class="element radio" type="radio" value="West Midlands" />
        <label class="choice" for="element_5_4">West Midlands</label>
        <input id="element_5_5" name="element_5" class="element radio" type="radio" value="East Midlands" />
        <label class="choice" for="element_5_5">East Midlands</label>
        <input id="element_5_6" name="element_5" class="element radio" type="radio" value="North West" />
        <label class="choice" for="element_5_6">North West</label>
        <input id="element_5_7" name="element_5" class="element radio" type="radio" value="North East" />
        <label class="choice" for="element_5_7">North East</label>
        <input id="element_5_8" name="element_5" class="element radio" type="radio" value="Yorkshire & Humber" />
        <label class="choice" for="element_5_8">Yorkshire & Humber</label>
        <input id="element_5_9" name="element_5" class="element radio" type="radio" value="Wales" />
        <label class="choice" for="element_5_9">Wales</label>
        <input id="element_5_10" name="element_5" class="element radio" type="radio" value="Scotland" />
        <label class="choice" for="element_5_10">Scotland</label>

    </span><p class="guidelines" id="guide_5"><small>Let us know where in the country you are looking for property.</small></p> 
    </li>       <li id="li_4" >
    <label class="description" for="element_4">Ideal Discount From Market Value </label>
    <div>
        <input id="element_4" name="element_4" class="element text medium" type="text" maxlength="255" value=""/> 
    </div><p class="guidelines" id="guide_4"><small>How much discount (in percent) are you looking for?</small></p> 
    </li>

                <li class="buttons">
            <input type="hidden" name="form_id" value="507993" />

            <input id="saveForm" class="button_text" type="submit" name="submit" value="Submit" />
    </li>
        </ul>
    </form> 
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:11:09.843

```
if( empty($_POST['element_1_1'])  ||
empty($_POST['element_1_2'])  ||
empty($_POST['element_3']) ||
empty($_POST['element_2'])  ||
empty($_POST['element_5'])  ||
empty($_POST['element_4']))

$name = $_POST['element_1_1'];
$lastname = $_POST['element_1_2'];
$email_address = $_POST['element_3']; 
$number = $_POST['element_2'];
$area = $_POST['element_5'];
$discount = $_POST['element_4']; 
```

您在这里缺少大括号吗？我会假设这个或与花括号类似的东西，这取决于你想做什么。

```
if( empty($_POST['element_1_1'])  ||
empty($_POST['element_1_2'])  ||
empty($_POST['element_3']) ||
empty($_POST['element_2'])  ||
empty($_POST['element_5'])  ||
empty($_POST['element_4']))
{
$name = $_POST['element_1_1'];
$lastname = $_POST['element_1_2'];
$email_address = $_POST['element_3']; 
$number = $_POST['element_2'];
$area = $_POST['element_5'];
$discount = $_POST['element_4'];
} 
```

无论如何，你想用 if 语句做什么？您正在检查其中一个是否为空，然后全部设置？或者您应该检查其中一个是否为空，然后向用户发送一条需要填写其中一个字段的消息？然后你应该把它改成这样：

```
if( empty($_POST['element_1_1'])  ||
    empty($_POST['element_1_2'])  ||
    empty($_POST['element_3']) ||
    empty($_POST['element_2'])  ||
    empty($_POST['element_5'])  ||
    empty($_POST['element_4']))
    {
    do something;    }
else {
$name = $_POST['element_1_1'];
    $lastname = $_POST['element_1_2'];
    $email_address = $_POST['element_3']; 
    $number = $_POST['element_2'];
    $area = $_POST['element_5'];
    $discount = $_POST['element_4'];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:11:12.510

你的 if 语句在做什么？

```
if( empty($_POST['element_1_1'])  ||
empty($_POST['element_1_2'])  ||
empty($_POST['element_3']) ||
empty($_POST['element_2'])  ||
empty($_POST['element_5'])  ||
empty($_POST['element_4'])) 
```

这似乎与任何东西无关，但如果它们都不为空，则 $name 没有设置（它是 if 语句之后的第一行，只有在 if 语句为 true 时才会调用）

我假设您打算执行所有行，这需要在它们周围加上花括号。

# python - 获取列表前 N 个值的索引

> ID：13070461
> 
> 赞同：71
> 
> 时间：2012-10-25T14:08:25.223
> 
> 标签：python, list

我有一个清单说`a = [5,3,1,4,10]`。我需要获取列表前两个值的索引，即 for`5`并且`10`我会得到`[0, 4]`. Python 是否为这种情况提供了单行代码？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-10-25T14:10:51.860

```
sorted(range(len(a)), key=lambda i: a[i])[-2:] 
```

或者

```
sorted(range(len(a)), key=lambda i: a[i], reverse=True)[:2] 
```

或者

```
import operator

zip(*sorted(enumerate(a), key=operator.itemgetter(1)))[0][-2:] 
```

或（对于长列表），考虑使用[`heapq.nlargest`](https://docs.python.org/library/heapq.html#heapq.nlargest)

```
zip(*heapq.nlargest(2, enumerate(a), key=operator.itemgetter(1)))[0] 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2016-08-08T18:12:08.830

只是一个 NumPy 替代方案：

```
import numpy as np

top_2_idx = np.argsort(a)[-2:]
top_2_values = [a[i] for i in top_2_idx] 
```

# javascript - Adding .class to elements according to their width, but their width also changes after adding .class

> ID：13070464
> 
> 赞同：3
> 
> 时间：2012-10-25T14:08:27.193
> 
> 标签：javascript, jquery, css

**You can see the problem on [http://jsfiddle.net/6gnAF/1/](http://jsfiddle.net/6gnAF/1/)**

I've little problem with my list elements.

I'm using very simple unordered list like;

```
<div>
  <ul>
    <li class='button'>Element 1</li>
    ...
    <li class='button'>Element N</li>
  </ul>
</div> 
```

(Number of list elements, N, varies on every page.)

The `div` which contains the `ul` is `696 px` width. List elements, `li`, are horizontally aligned, and when they reach end of div's width, they contiues on new line.

What I wanted to adding class `.left` the first `li` of every line, and class `.right` to the last one.

```
 $('li').each(function() {
        var liWidthOut = $(this).width();
        totalWidth += liWidthOut;
        if (totalWidth >= divWidth) {
            $(this).addClass("left");
            $(this).prev().removeClass("middle").addClass("right");
            totalWidth = liWidthOut;
        }
        else {
            $(this).addClass("middle");
        }
     }); 
```

I managed that with Jquery, but I've a little problem.

**You can see the problem on [http://jsfiddle.net/6gnAF/1/](http://jsfiddle.net/6gnAF/1/)**

**The problem is**, `.left` and `.right` classes change the width of `li` elements which are added to, so some times they create new lines, and last li elements become first one which have `.right` class, instead of `.left`.

How can I fix this?

*(Sorry for the grammatically errors)*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:31:36.820

我更改了跟踪`top`位置而不是计算宽度的方法，似乎工作正常。使用`width()`填充和边框以及诸如此类的东西不太可靠。

```
$('li')
    // Add classes first, so we calculate on the right styles
    .addClass("middle")
    .addClass("button")
    .each(function() {
        // Compare with last position
        if (lastPos != $(this).position().top) {
            $(this).removeClass("middle").addClass("left")
                .prev().removeClass("middle").addClass("right");
        }
        // Store last position
        lastPos = $(this).position().top;
    }); 
```

[http://jsfiddle.net/2qydM/6/](http://jsfiddle.net/2qydM/6/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T15:07:30.977

您的代码大部分是正确的，只有两个使其出错的挑剔：

1.  使用`var liWidthOut = this.offsetWidth;`而不是`var liWidthOut = $(this).width();`后者为您提供内部文本的宽度，而不是像添加填充一样`offsetWidth`。

2.  `.button`在开始循环和计算宽度之前应用类，因为`.button`样式会影响元素的宽度，你必须首先应用它，这样你的计算就不会在以后失败。

请参阅纠正了这两件事的代码的[**工作演示**](http://jsfiddle.net/gnel/6gnAF/16/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:38:22.897

Would it be possible to separate these lists into seperate lists?

If so you could use [:nth-child](http://www.w3schools.com/cssref/sel_nth-child.asp) or [:last-child](http://www.w3schools.com/cssref/sel_last-child.asp)

# apache-flex - Flexicious Highlighted Cell

> ID：13070465
> 
> 赞同：1
> 
> 时间：2012-10-25T14:08:30.430
> 
> 标签：apache-flex, datagrid, highlight, flexicious

I'm wondering about highlighted cells in Flexicious Ultimate DataGrid. Not highlighted rows, but highlighted cells. I think maybe they are called active cells?

But my question is how can I remove all highligting of cells from the Grid? I don't want this functionality to occur. I can't find a way to do it.

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:16:38.403

```
enableActiveCellHighlight=false 
```

# google-maps - How can I get more than 60 results from the Google Places API?

> ID：13070477
> 
> 赞同：7
> 
> 时间：2012-10-25T14:08:55.370
> 
> 标签：google-maps, google-maps-api-3, google-places-api

I was able to obtain the post office result by the Google Places API call below.

[https://maps.googleapis.com/maps/api/place/search/xml?location=35.610418,139.182358&radius=1000000&types=post_office&language=ja&sensor=false&key=](https://maps.googleapis.com/maps/api/place/search/xml?location=35.610418,139.182358&radius=1000000&types=post_office&language=ja&sensor=false&key=)"MyKey"

But, The third page does not have "next_page_token" tags, you can not retrieve the results following.

How can I get the more than 60 results after the fourth pages?.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:02:44.643

[**联系 Google 销售**](http://www.google.com/enterprise/earthmaps/contact.html)人员以获取具有[**更高使用限制**](http://www.google.com/enterprise/earthmaps/maps-compare.html)的营业执照....或者您是否试图抓取结果？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-27T15:09:52.900

老问题，但我想我会指出[雷达搜索最多 200 个地方](https://developers.google.com/maps/documentation/javascript/examples/place-radar-search</s)。响应只返回地点 ID，然后您可以使用它来获取详细信息。

自 2017 年 6 月 30 日起，雷达搜索已弃用。自 2018 年 6 月 30 日起，此功能已被拒绝。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-27T06:56:52.067

@user1774357 我知道这很旧，但我可以帮助别人。

我用 ruby​​ 编写了这个解决方案。

图片说明[https://i.imgur.com/hM9dtQ4.jpg](https://i.imgur.com/hM9dtQ4.jpg)

1.  获取西南和东北坐标。

2.  然后您必须为网格创建坐标。对于红宝石，我使用了`GeoPoint`宝石。对于一个点，我可以说给我这个点以西 1 公里的坐标`GeoPoint.new(point_1.destination_point(0, 1.0).to_dms)`

3.  获得坐标列表（来自网格）后，将它们一一发送到 Google Places 以生成列表。图中有 20 个点，所以我必须发送 20 个请求，这大约需要 1 分钟。

4.  合并列表并确保它们是唯一的。

# google-analytics - google analytics incoherent visits in custom report

> ID：13070480
> 
> 赞同：1
> 
> 时间：2012-10-25T14:09:02.333
> 
> 标签：google-analytics, statistics

in GA if I create a custom report filtered by a specific page or source/medium I see an incoherent number of visits, in particular unique visitors are higher than visits. If I remove the filter visits become coherent with visitors and page views!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:37:48.650

> 我在下面的链接中找到了我认为的答案。
> 
> [http://www.michaelwhitaker.com/blog/2010/04/23/unique-visitors-0-visits-and-pages-in-web-analytics/](http://www.michaelwhitaker.com/blog/2010/04/23/unique-visitors-0-visits-and-pages-in-web-analytics/)
> 
> 详细的答案很长，但总而言之 - 出于归因的目的，谷歌将页面级别的访问归功于一次访问中访问的第一页。但是，它会将查看的每个页面归功于唯一的访问者。
> 
> 所以基本上访问指标在您显示的报告中代表的是有多少访问开始访问该页面。要找出访问特定页面的实际访问量，请使用独特的综合浏览量，因为每次访问只计算一次综合浏览量。
> 
> 令人困惑……是的。然而，这似乎是原因。

来源：[https ://webmasters.stackexchange.com/a/27276](https://webmasters.stackexchange.com/a/27276)

# php - 如何从公共访问中隐藏 ajax 页面 [codeigniter]

> ID：13070481
> 
> 赞同：3
> 
> 时间：2012-10-25T14:09:01.100
> 
> 标签：php, ajax, codeigniter

我有一个用于 ajax 调用的控制器，所以在 jQuery 中我有类似的东西：

```
$.ajax({ 
  type: 'POST',
  url: '<?php echo base_url().'ajax/post_message'; ?>',
  data: { message: msg }
}).done(function(data) { 
    // handling callback here               
}); 
```

这里 ajax/post_message 工作正常，但也可以直接从 URL 访问。

我该如何防止这种情况，应该将ajax文件放在其他地方？如果是这样，我可以使用哪个网址来访问它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:11:58.700

如果您想将它用于 Ajax，那么浏览器必须能够访问它。

如果浏览器必须能够访问它，那么 URI 就不能是秘密。

如果你想限制它的使用，那么你只能使用认证+授权（所以只有登录的用户才能访问它）。

（您还可以查看基于 IP 地址的速率限制，以使第三方站点更难直接使用 API）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:12:17.940

不，因为从技术上讲，Ajax 查询只是简单的 HTTP get/post 请求

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T14:34:38.830

您可以像 WordPress 那样实现一个使用一次（随机数）系统的数字。几乎服务器为客户端分配了一个数字。当客户端将请求发送回服务器时，它也会发送随机数。服务器将收到的随机数与之前分配的随机数进行对比。如果 nonce 有效，则服务器会处理请求并丢弃 nonce（因为它已经使用过一次并且不再有效）。如果发送到服务器的 nonce 无效或未发送，则服务器不处理请求。

您可以根据自己的喜好扩展此随机数过程，也许随机数仅在一定时间内有效……谁知道呢。

**一些解释它如何在 WordPress 中使用的资源：http:** [//markjaquith.wordpress.com/2006/06/02/wordpress-203-nonces/](http://markjaquith.wordpress.com/2006/06/02/wordpress-203-nonces/)

[http://www.prelovac.com/vladimir/improving-security-in-wordpress-plugins-using-nonces](http://www.prelovac.com/vladimir/improving-security-in-wordpress-plugins-using-nonces)

[http://www.techytalk.info/securing-your-wordpress-plugin-ajax-calls-using-nonces/](http://www.techytalk.info/securing-your-wordpress-plugin-ajax-calls-using-nonces/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:16:26.047

尝试使用会话来控制谁可以访问 ajax url，因为在 ajax 中隐藏 url 是不可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T15:28:04.843

您可以使用 is_ajax_request() 它将返回 true/false

[http://codeigniter.com/user_guide/libraries/input.html](http://codeigniter.com/user_guide/libraries/input.html)

# html - HTML 和图像检索

> ID：13070483
> 
> 赞同：0
> 
> 时间：2012-10-25T14:09:04.057
> 
> 标签：html, image

我正在使用 HTML 并试图找到最有效的方法来提取将用于横幅、背景等的图像。

***选项***

**1）存储在服务器上并通过服务器路径访问它们。
2）存储在第三方网站，如imageshack或photobucket，并通过URL访问
3）存储在MYSQL数据库中，通过路径访问。**（不打算拥有大量图像，而只是将其扔在那里。）

我希望能够有效地检索将在该页面上显示的所有图像，但也希望限制我的服务器将负责的资源量。在这 3 个选项之间，是否有一个非常明显而我只是没有看到的选择？

**像下面这样的答案将是完美的。**（我正在考虑这样的选项。）
**存储在服务器上**- 严重依赖个人服务器，下载等会影响我的服务器，高负载/高责任
**存储在第三方站点上**- 图像脱离服务器，节省空间和一些负载（但值得麻烦吗？）
**DB Link** - 最快，最适合大量图像，严重依赖个人服务器

如果这个问题是基于意见的，那么我将假设所有 3 种方法都同样有效，并将结束这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:13:58.170

将图像存储在 CDN 上，并将图像的 URL 存储在数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:15:52.410

1.  其他选项中不存在的主要优点是缓存。如果您使用数据库，则需要对其进行查询，并且服务器脚本（我经常使用的 .net 框架为 .ashx）需要返回此资源。使用 imageshack 等。我不确定，但我认为检索到的图像没有被缓存。
2.  这里的优点是您不会丢失带宽和存储空间。
3.  除了您需要对图像进行版本控制或其他内容外，我没有想到其他任何优势。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T14:18:58.807

如果您**仅**在 HTML 中工作，则无法在服务器上存储，因为您需要服务器端语言来连接数据库和页面。如果您有一些 PHP、ASP、Ruby 等知识，那么您可以存储在服务器上。

我认为答案取决于站点/应用程序是什么。

如果（如您所说）您将图像用于横幅、背景等。然后也许最简单的方法是将它们存储在您的服务器上并在页面上链接到它们`<img src="/Source" alt="Image"/>`（或在 CSS 中做背景）

确保您正在缓存图像，以便用户在第一次查看后更快地加载它们。

大多数服务器都非常快，所以我不会太担心速度......除非你使用的图像很大（任何人都会告诉你不推荐用于网站）

# php - Check if SQL field contains data, if so echo data, else return text field

> ID：13070484
> 
> 赞同：1
> 
> 时间：2012-10-25T14:09:04.243
> 
> 标签：php, html, mysql

I have a form that is filled out once a year per customer, but some fields stay constant (birthday for example). So my goal is when a new customer fills out the form for the first time the birthday field is a text box, but after they fill out the form the first time and come back next year it just displays their birthday but does not allow them to edit it (echo's the birthday, not simply shows it in the text box).

What I have now is below, the goal of this statement is to check if there is a value in the SQL field, if so echo that value, else echo a text box. I keep getting an error when I try and load the form and I think its just a syntax error somewhere.

```
<?php
if($bday!="") //if bday field is not empty
{
echo $bday; //display bday field value
}
else
{           
echo '<input type=text name=bday size=12 maxlength=12 value='<?php echo htmlentities ($bday, ENT_QUOTES) ?>'>'; //else echo the text box
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:12:48.450

您已经在编写 PHP，因此您不必在 echo 语句中再次使用开始和结束标记。改为使用字符串连接（使用点）。尝试这个：

```
echo '<input type=text name=bday size=12 maxlength=12 value="'.htmlentities($bday, ENT_QUOTES).'">'; 
```

但是，如果 $bday==""，为什么要用它作为文本框的值呢？

# f# - F# Use generic type as pattern discriminator

> ID：13070487
> 
> 赞同：7
> 
> 时间：2012-10-25T14:09:14.167
> 
> 标签：f#, pattern-matching, discriminated-union

If there's another way to achieve what I'm trying to do below, please let me know. Suppose I have the following sample code

```
type FooBar = 
  | Foo
  | Bar

let foobars = [Bar;Foo;Bar]

let isFoo item  = 
  match item with
  | Foo _ -> true
  | _ -> false

foobars |> Seq.filter isFoo 
```

I want to write a generic/higher-order version of isFoo that allows me to filter my list based on all other types of the discriminated union (Bar in this case).

Something like the following, where 'a can be either Foo or Bar

```
let is<'a> item  = 
  match item with
  | a _ -> true
  | _ -> false 
```

However, this attempt yields the following error:

> error FS0039: The pattern discriminator 'a' is not defined

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:15:01.900

如果您只想过滤一个列表，那么最简单的选择是使用`function`编写标准模式匹配：

```
[ Foo; Bar; Foo ]
|> List.filter (function Foo -> true | _ -> false) 
```

如果您想编写一些更复杂的通用函数来检查一个案例然后执行其他操作，那么最简单的选择（通常可以使用）是采用返回`true`or的谓词`false`：

```
let is cond item  = 
  if cond item then
    true
  else
    false

// You can create a predicate using `function` syntax
is (function Foo -> true | _ -> false) <argument> 
```

在您的具体示例中，您有一个有区别的联合，其中所有案例都没有任何参数。这可能是一个不切实际的简化，但如果您只关心没有参数的可区分联合，那么您可以将这些案例用作值并进行比较：

```
let is case item = 
  if case = item then
    true
  else
    false

// You can just pass it 'Foo' as the first parameter to 
// `is` and use partial function application
[ Foo; Bar; Foo ]
|> List.filter (is Foo)

// In fact, you can use the built-in equality test operator
[ Foo; Bar; Foo ] |> List.filter ((=) Foo) 
```

如果您有更复杂的可区分联合，其中某些情况具有参数，则最后一种方法将不起作用，因此它可能不是很有用。例如，如果您有一个选项值列表：

```
let opts = [ Some(42); None; Some(32) ]
opts |> List.filter (is Some) // ERROR - because here you give 'is' a constructor 
                              // 'Some' instead of a value that can be compared. 
```

`function`您可以使用 Reflection 执行各种技巧（检查具有指定名称的案例），还可以使用 F# 引号来获得更好更安全的语法，但我认为这不值得，因为使用模式匹配清晰的代码。

**编辑 -**只是出于好奇，一个使用反射的解决方案（而且很慢，不是类型安全的，除非你*真的*知道你在做什么，否则没有人应该在实践中实际使用它）可能看起来像这样：

```
open Microsoft.FSharp.Reflection
open Microsoft.FSharp.Quotations

let is (q:Expr) value = 
  match q with
  | Patterns.Lambda(_, Patterns.NewUnionCase(case, _)) 
  | Patterns.NewUnionCase(case, _) ->
      let actualCase, _ = FSharpValue.GetUnionFields(value, value.GetType())
      actualCase = case
  | _ -> failwith "Wrong argument" 
```

它使用引号来识别联合情况，因此您可以编写如下内容：

```
type Case = Foo of int | Bar of string | Zoo

[ Foo 42; Zoo; Bar "hi"; Foo 32; Zoo ]
|> List.filter (is <@ Foo @>) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T14:18:42.737

只要联合案例接受相同的参数集，您就可以将构造函数作为参数传递并重构 DU 以进行比较。

`Foo`当并且`Bar`有参数时，它看起来更有吸引力：

```
type FooBar = Foo of int | Bar of int

let is constr item = 
    match item with
    | Foo x when item = constr x -> true
    | Bar x when item = constr x -> true
    | _ -> false 
```

在您的示例中，构造函数没有参数。所以你可以用`is`更简单的方式写：

```
type FooBar = Foo | Bar

let is constr item = item = constr

[Bar; Foo; Bar] |> Seq.filter (is Foo) 
```

# java - Design pattern for converting one model to another model

> ID：13070488
> 
> 赞同：13
> 
> 时间：2012-10-25T14:09:18.807
> 
> 标签：java, design-patterns

Basically, I have a number of objects in my application and I have to convert them to another third party objects before sending the request. On receiving the response I have to convert these objects back to objects supported by my application.

What pattern can I use for converting one model object to another in Java?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T14:21:05.733

我认为这没有特定的模式，但您只需要一个“转换器”或“翻译器”类，它接收一个对象并返回另一个对象：

```
MyObject convert(ThirdPartyObject obj);
ThirdPartyObject convert(MyObject obj); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T14:21:28.633

适配器或外观模式应该可以解决您的问题：

适配器： [http ://www.youtube.com/watch?v=TriX8OiEhOU](http://www.youtube.com/watch?v=TriX8OiEhOU)

门面： [http ://www.youtube.com/watch?v=WLjvNpP6yeQ](http://www.youtube.com/watch?v=WLjvNpP6yeQ)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-03-20T02:14:35.257

**Adapter**和**Facade**是结构模式。您没有任何模式来迎合*对象转换*。

在创建模式方面，[Builder](https://en.wikipedia.org/wiki/Builder_pattern)是您可以想到的一种模式。

通常， **Builder**模式用于构建具有强制和可选参数的对象。但是您可以通过构建必要的对象来微调它。

您也可以在没有模式的情况下解决问题。您可以使用**对象组合**或*编写自己的方法来转换对象*。

使用代码示例查看相关的 SE 问题：

[如何在 Java 中修剪其某些字段的对象？](https://stackoverflow.com/questions/34280716/how-to-prune-an-object-of-some-of-its-fields-in-java)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T14:12:03.453

您可能正在寻找适配器模式：[http ://en.wikipedia.org/wiki/Adapter_pattern](http://en.wikipedia.org/wiki/Adapter_pattern)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T14:23:26.043

确定对象的上下文有点困难，但是看看汇编器模式，虽然从技术上讲不是设计模式。Assembler 类用于从一个对象映射到另一个对象，特别是当一个对象是 DTO（有点像您的响应对象）到 Domain 对象时。Dozer 框架可以帮助您完成其中一些繁琐的转换。

# javascript - 如何在剃须刀模型中访问列表中的特定项目

> ID：13070491
> 
> 赞同：5
> 
> 时间：2012-10-25T14:09:30.263
> 
> 标签：javascript, jquery, razor, slider

在 Razor 的视图中，我传递了一个模型，其中包含具有 Name 和 UseDescription 属性的对象列表（'usageList'）。

在 JQuery 中，我制作了一个滑块，我希望在更改滑块值时出现特定的 UseDescription。

问题是在模型内的列表中获取特定对象。我有这个代码（JQuery）：

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#slider").slider({
            min:1,
            max:3,
            value:1,
            range:"min",
            change: function(event,ui){
                var number = ui.value;
                alert("@Model.UsageList[ui.value].UseDescription");

            }
        });
    });
</script> 
```

无法在此行中获取 ui.value：

```
alert("@Model.UsageList[ui.value].UseDescription"); 
```

如果我传入一个数字（例如 1）而不是 ui.value，则一切正常。但我需要获取特定的列表对象。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:17:39.883

您需要使用 javascript 将列表下载到客户端。然后，您可以按索引获取项目。像这样的东西：

```
<script type="text/javascript">
        $(document).ready(function() {
            var usageList = []
            @foreach (var item in Model.UsageList)
            {
                <text>usageList.push('@item.UseDescription');</text>
            }

            }
            $("#slider").slider({
                min:1,
                max:3,
                value:1,
                range:"min",
                change: function(event,ui){
                    var number = ui.value;
                    alert(usageList[ui.value - 1]);

                }
            });
        });
    </script> 
```

# android - Android: How to make a Slider like this in android?

> ID：13070500
> 
> 赞同：3
> 
> 时间：2012-10-25T14:10:24.943
> 
> 标签：android, slider

Is there any defined View to have a slider like this??

![enter image description here](../Images/6d35dd2a437296262cec7a5a004a0668.png)

Can i keep 2 fingers one each on the bubbles and pinch in/out to decrease/increase the blue line??

or atleast slide 1 bubble at a time??

Thank You

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:15:25.890

[http://code.google.com/p/range-seek-bar/](http://code.google.com/p/range-seek-bar/) is what you want!

Intro:

The Android widget class library contains only one "slider" like widget: the SeekBar. SeekBar only supports one thumb control and thus handles only one selectable value. If you need a widget allowing to handle two values (like a minimum and maximum value or a range), this RangeSeekBar widget might suit your needs. It supports controlling minimum and maximum values on a numerical range of the following types: Long, Double, Integer, Float, Short, Byte and BigDecimal.

# tags - 删除印象笔记中的标签

> ID：13070501
> 
> 赞同：0
> 
> 时间：2012-10-25T14:10:32.190
> 
> 标签：tags, evernote

我想知道是否有办法从与 Evernote 集成的 Web 应用程序中**删除标签**。我知道 noteStore.expunge_tag 会引发 PERMISSION_DENIED 异常，并且 Evernote 不会授予永久删除某些内容的权限，但我希望有另一种删除标签的方法（例如将便笺移动到垃圾文件夹的 delete_note）。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T00:41:56.250

似乎在 Evernote 开发者论坛上提出了类似的问题。而其中一名员工给出的[答案是……](http://discussion.evernote.com/topic/30678-deleting-tags/#entry165466)

> 不幸的是，没有办法不永久删除标签，我们没有将标签放入垃圾箱的功能（就像我们的笔记一样）。

对不起。

# ruby - 冒号的意义：在Ruby中

> ID：13070503
> 
> 赞同：3
> 
> 时间：2012-10-25T14:10:49.840
> 
> 标签：ruby

> **可能的重复：**
> [理解 Ruby 中的符号 Ruby](https://stackoverflow.com/questions/2341837/understanding-symbols-in-ruby)
> [中的冒号运算符是什么？](https://stackoverflow.com/questions/6337897/what-is-the-colon-operator-in-ruby)

我真的很天真地问这个问题，但我要继续问：

`:`红宝石的重要性是什么？

我已经看到它在很多地方都使用过，`params[:id]`例如`x < :length`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:12:44.187

冒号表示“符号”。一个符号就像一个字符串，但它是不可变的（你不能改变它的内容）。在幕后，它也占用更少的内存，因为一个符号只需要在内存中存在一次（即，两个名为“length”的字符串将在内存中存在两次，但两个名为 :length 的符号将指向同一个对象）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:20:52.570

`:length`表示它是一个符号

符号是字符串，只是有一个重要区别，符号是不可变的。

[RubyDoc：](http://www.ruby-doc.org/core-1.9.3/Symbol.html)符号对象表示 Ruby 解释器中的名称和一些字符串。它们是使用 :name 和 :"string" 文字语法以及各种 to_sym 方法生成的。

这里有一些了解符号的好地方

*   [Ruby_Newbie 符号指南](http://www.troubleshooters.com/codecorn/ruby/symbols.htm)
*   [理解 Ruby 符号](http://glu.ttono.us/articles/2005/08/19/understanding-ruby-symbols)
*   [Ruby 符号和字符串的区别](http://www.robertsosinski.com/2009/01/11/the-difference-between-ruby-symbols-and-strings/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T14:21:49.470

它是解释器类型的语法指示。

```
0-9   numeric*
:     symbol
""    string
[]    array
{}    hash 
```

*   现实中的模式更复杂。

# tomcat - Tomcat PermGen 内存

> ID：13070507
> 
> 赞同：1
> 
> 时间：2012-10-25T14:10:59.467
> 
> 标签：tomcat, permgen

嘿，我在 Windows 上，我正在尝试部署 Tomcat，但我不断收到 permgen 内存异常。我读到你可以`catalina.bat`通过添加来修改`JAVA_OPTS="-server -Xms128M -Xmx256M -XX:MaxPermSize=256M"`，但是那会去哪里呢？我用上面的文本替换了所有对`JAVA_OPTS`（似乎使用变量`%JAVA_OPTS%`）的引用，当我尝试部署它时，tomcat 甚至没有打开那个小控制台窗口。是什么赋予了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:28:20.380

您可能留下了一个语法错误，并且 Tomcat 提前退出了。如果您想查看该错误，请输入`catalina run`命令行，您将看到输出。

在任何情况下，进行这些更改的正确/官方方法是将它们放入`setenv.bat`（如果不存在则创建）将由`catalina.bat`/拾取`startup.bat`。

# jquery - 按月进行日验证的正则表达式

> ID：13070513
> 
> 赞同：1
> 
> 时间：2012-10-25T14:11:16.110
> 
> 标签：jquery, regex

我目前正在验证表单。当谈到日期时，我遇到了障碍。也许你们中的一些疯狂的 RegEx 家伙可以对这个主题有所了解。我用谷歌搜索，直到我得了关节炎。

目前，我正在使用以下正则表达式：

```
var dateReg = /^(0[1-9]|1[012])[- //.](0[1-9]|[12][0-9]|3[01])[- //.](19|20)\d\d$/; 
```

这以 mm/dd/yyyy 格式验证，但仅验证 31 天以下的任何内容。是否可以按月进行日验证？是否建议使用此方法另辟蹊径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:33:56.560

正如@Wooble 解释的那样，正则表达式将无法满足您的需求。那这个呢：

```
if(typeof String.prototype.isValidDate === "undefined") {
    String.prototype.isValidDate = function() {
        var data = this.split(/[ -./]/);
        var day = parseInt(data[1]);
        var month = parseInt(data[0]) - 1;
        var year = parseInt(data[2]);
        var date = new Date(year, month, day);
        return date.getDate() === day
            && date.getMonth() === month
            && date.getFullYear() === year;
    }
}

document.write("11 02 2011".isValidDate());​
document.write("<br />");
document.write("11 32 2011".isValidDate()); 
```

印刷：

```
true
false 
```

[此处](http://jsfiddle.net/j4WZ5/3/)提供演示。

# php - TCPDF - 图像未显示

> ID：13070516
> 
> 赞同：3
> 
> 时间：2012-10-25T14:11:20.600
> 
> 标签：php, pdf, pdf-generation, tcpdf

我正在尝试使用数据库中的一些数据和一些图像保存一个 pdf。我可以正常保存，但图像不显示。$ft1、$ft2 和 $ft3 是带有图像名称的数据库变量。

这是我的测试代码：

```
 require_once('../tcpdf/config/lang/bra.php');
    require_once('../tcpdf/tcpdf.php'); 

    // create new PDF document
    $pdf = new TCPDF(PDF_PAGE_ORIENTATION, PDF_UNIT, PDF_PAGE_FORMAT, true, 'UTF-8', false);

    // set document information
    $pdf->SetCreator(PDF_CREATOR);
    $pdf->SetAuthor('Nicola Asuni');
    $pdf->SetTitle('TCPDF Example 006');
    $pdf->SetSubject('TCPDF Tutorial');
    $pdf->SetKeywords('TCPDF, PDF, example, test, guide');

    $pdf->setPrintHeader(false);
    $pdf->setPrintFooter(false);

    // set default monospaced font
    $pdf->SetDefaultMonospacedFont(PDF_FONT_MONOSPACED);

    //set margins
    $pdf->SetMargins(PDF_MARGIN_LEFT, PDF_MARGIN_TOP, PDF_MARGIN_RIGHT);
    $pdf->SetHeaderMargin(PDF_MARGIN_HEADER);
    $pdf->SetFooterMargin(PDF_MARGIN_FOOTER);

    //set auto page breaks
    $pdf->SetAutoPageBreak(TRUE, PDF_MARGIN_BOTTOM);

    //set image scale factor
    $pdf->setImageScale(PDF_IMAGE_SCALE_RATIO);

    //set some language-dependent strings
    $pdf->setLanguageArray($l);

    // ---------------------------------------------------------

    // set font
    $pdf->SetFont('helvetica', '', 10);

    // add a page
    $pdf->AddPage();

    $html.= "<div><img src='../uploads/".$ft1."' width='200' height='400' /><br><br><img src='../uploads/".$ft2."' /><br><br><img src='../../uploads/".$ft3."' /></div>";

    $pdf->writeHTML($html, true, false, true, false, '');

    $pdf->lastPage();

    ob_clean();

    $pdf->Output('../uploads/'.$norepeat.'_relatorio_'.$idcontrato.'_'.formatDataJustNumbers($_POST['datarelatorio']).'.pdf', 'F'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-03-21T12:31:35.977

旧帖子，但我来这里寻求帮助：

官方文档声明所有 HTML 属性必须用双引号括起来。

```
width='200' height='400' 
```

需要是：

```
width="200" height="400" 
```

为了显示图像。那为我修好了。

参考： [https ://tcpdf.org/docs/srcdoc/TCPPDF/class-TCPD/#_writeHTML](https://tcpdf.org/docs/srcdoc/TCPDF/class-TCPDF/#_writeHTML)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-08T20:15:32.727

有2个问题；

1.  你需要使用绝对路径，
2.  请更改此行；

    $html.= "

    ";

对此；

```
$html.= "<div><img src='../uploads/$ft1' width='200' height='400' /><br><br><img src='../uploads/$ft2' /><br><br><img src='../../uploads/$ft3' /></div>"; 
```

# sql-server - 我应该避免使用 sp_getAppLock 吗？

> ID：13070519
> 
> 赞同：26
> 
> 时间：2012-10-25T14:11:22.130
> 
> 标签：sql-server, sql-server-2008, tsql

我有一个存储过程，我想确保它不能同时执行。

我的（多线程）应用程序通过这个存储过程在基础表上完成所有必要的工作。

IMO，锁定表本身是一个不必要的激烈行动，所以当我发现`sp_GetAppLock`，它基本上强制执行关键部分时，这听起来很理想。

我的计划是将存储过程封装在事务中并设置`spGetAppLock`事务范围。该代码已成功编写和测试。

代码现在已经提交审查，我被告知我不应该调用这个函数。然而，当问一个明显的问题“为什么不？”时，我得到的唯一原因是高度主观的，与任何形式的锁定都复杂有关。

我不一定会买这个，但我想知道是否有人有任何*客观*原因为什么我应该避免这种结构。就像我说的那样，考虑到我的情况，关键部分对我来说是一种理想的方法。

**更多信息：**应用程序位于此之上，有 2 个线程 T1 和 T2。每个线程都在等待不同的消息 M1 和 M2。所涉及的业务逻辑表明，只有在 M1 和 M2 都到达时才能进行处理。存储过程记录 Mx 已到达（插入），然后检查 My 是否存在（选择）。内置锁定可以确保插入连续发生。但是选择也需要连续发生，我认为我需要在此处的内置功能之外做一些事情。

为清楚起见，我希望“处理”只发生一次。所以我不能让存储过程返回误报或漏报。我担心如果存储的过程很快连续运行两次，那么两个“选择”都可能返回表明它适合执行处理的数据。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T14:20:35.683

哪些程序不能依赖 SQL Server 内置的并发控制机制？通常可以重写查询以实现真正的并发性。

但是，如果这个过程确实必须“单独”执行，那么在第一次访问时锁定表本身很可能比使用对`sp_GetAppLock`. 听起来这个过程会经常被调用。如果是这种情况，您应该寻找一种以最小影响实现目标的方法。

* * *

如果表不包含除 M1 和 M2 之外的其他行，则表锁仍然是您最好的选择。

如果您有多个线程发送多条消息，则可以通过使用“可序列化”作为事务级别来获得更细粒度，并在执行插入之前但在同一事务中检查其他消息是否存在。为了防止在这种情况下发生死锁，请确保检查这两条消息，例如：

```
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;  
BEGIN TRAN;
 SELECT 
 @hasM1 = MAX(CASE WHEN msg_type='M1' THEN 1 ELSE 0 END), 
 @hasM2 = MAX(CASE WHEN msg_type='M2' THEN 1 ELSE 0 END)
 FROM messages WITH(UPDLOCK)
 WHERE msg_type IN ('M1','M2')

 INSERT ...

 IF(??) EXEC do_other_stuff_and_delete_messages;
COMMIT 
```

在 COMMIT 之前（！）的 IF 语句中，您可以使用插入之前收集的信息以及您插入的信息来决定是否需要进行额外处理。

在该处理步骤中，请确保将这些消息标记为已处理或将它们全部删除仍在同一事务中。这将确保您不会两次处理这些消息。

SERIALIZABLE 是唯一允许锁定尚不存在的行的事务隔离级别，因此第一个带有 的 select 语句`WITH(UPDLOCK)`有效地防止在第一次执行仍在运行时插入另一行。

最后，有很多事情需要注意，可能会出错。您可能想看看服务代理。你可以使用三个队列。一个用于 M1 型，一个用于 M2 型。每次消息到达这些队列时，都会自动调用一个过程来将令牌插入到第三个队列中。然后第三个队列可以激活一个进程来检查这两个消息是否存在并且是否有效。这将使整个过程异步，但因此很容易将队列 3 响应限制为始终一次只进行一项检查。

[msdn](https://msdn.microsoft.com/en-us/library/bb522893.aspx)上的服务代理，还可以查看自动消息处理的“激活”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-06-02T15:54:38.293

sp_GetAppLock 与许多其他工具一样，因此可能会被误用、过度使用或正确使用。它与原始海报描述的问题类型完全匹配。这是一篇关于使用的很好的 MSSQL Tips 帖子 防止多个用户同时运行同一个 SQL Server 存储过程 [http://www.mssqltips.com/sqlservertip/3202/prevent-multiple-users-from-running-the -same-sql-server-stored-procedure-at-the-same-time/](http://www.mssqltips.com/sqlservertip/3202/prevent-multiple-users-from-running-the-same-sql-server-stored-procedure-at-the-same-time/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-06-08T10:18:48.323

我们`sp_getapplock`一直在使用，因为我们支持一些经过重新设计以使用 SQL 后端的遗留应用程序，并且 SQL Server 锁定模型与我们的应用程序逻辑并不完全匹配。

我们倾向于采用“悲观”锁定模型，在允许用户编辑实体之前锁定实体，并`(NOLOCK)`在读取数据时广泛使用提示来绕过实际表上的本机锁定的任何阻塞。`sp_getapplock`是一个很好的匹配。我们还使用它来强制大型多用户系统中的关键路径。您必须系统地了解您所放置的锁。

我们没有发现通过这条路线有大量用户/锁的性能问题，所以我看不出它为什么不适合你。请注意，如果您有放置相同命名锁的进程，但不一定以相同的顺序放置，您可能会遇到阻塞和死锁。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:58:10.380

您可以为每组消息创建一个带有标志的表，因此如果其中一个线程首先开始处理，它将将该标志标记为正在处理。

为了确保记录在其中一个线程到达时正确阻塞，请使用：

```
 SELECT ... FROM WITH(XLOCK,ROWLOCK,READCOMMITTED) ... WHERE ... 
```

这种代码和平将在记录上设置排他锁，这意味着首先到达它的人拥有该行。然后你做你的更改和更新标志，其他线程将获得更新的值，因为它将被排他锁阻塞，直到第一个线程提交或回滚事务。

为此，您始终需要使用 XLOCK 从表中选择记录，这样它将按预期工作。

希望这可以帮助。

排他锁证明：

```
 USE master
    GO

    IF OBJECT_ID('dbo.tblTest') IS NOT NULL
        DROP TABLE dbo.tblTest

    CREATE TABLE tblTest ( id int PRIMARY KEY )

    ;WITH cteNumbers AS (
        SELECT 1 N
        UNION ALL
        SELECT N + 1 FROM cteNumbers WHERE N<1000
    )
    INSERT INTO
        tblTest
    SELECT
        N 
    FROM
        cteNumbers
    OPTION (MAXRECURSION 0)

    BEGIN TRANSACTION

    SELECT * FROM dbo.tblTest WITH(XLOCK,ROWLOCK,READCOMMITTED) WHERE id = 1

    SELECT * FROM sys.dm_tran_locks WHERE resource_database_id = DB_ID('master')

    ROLLBACK TRANSACTION 
```

# ios - 设置了正确的内容类型，但 .ipa 文件被视为 .zip 文件

> ID：13070520
> 
> 赞同：5
> 
> 时间：2012-10-25T14:11:22.567
> 
> 标签：ios, ruby-on-rails, download, mime-types, ipa

我编写了一个小型 Rails 应用程序，我可以在其中上传三个文件，我需要这些文件以无线方式分发临时构建。这包括一个*.ipa*文件、一个*.mobileprovisioning*文件和一个*.plist*文件。

现在的问题是，当我单击*.ipa*文件的链接时，文件被视为正常下载，我的 iDevices 询问我将文件存储在哪里。

```
curl -I example.com/path/to/App.ipa 
```

生成此输出

```
HTTP/1.1 200 OK
Date: Thu, 25 Oct 2012 13:55:08 GMT
Cache-Control: public, max-age=0
Last-Modified: Thu, 25 Oct 2012 10:23:07 GMT
ETag: "742-1351160587000"
Content-Type: application/octet-stream
Accept-Ranges: bytes
Content-Length: 742
Connection: keep-alive 
```

我认为**application/octet-stream**是正确的内容类型。我究竟做错了什么？

预先感谢您的回答

问候， 布克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T14:16:36.543

.ipa 文件只是一个（不是很好伪装的）zip 文件（它只是重命名为`.ipa`）。也许当您设置通用`application/octet-stream`MIME 类型时，iOS 上的 Safari 浏览器会查看文件的实际内容，发现它实际上是一个 ZIP 存档并继续。顺便说一句，在我看来，您希望对 iOS 应用程序进行一些内部或临时分发。在这种情况下，您应该真正将用户引导至 manifest.plist 文件（以 开头的 URL `itms-services://`），以便 iOS 知道它需要查找应用程序包，然后下载并安装它。

[文档在这里。](http://www.informit.com/articles/article.aspx?p=1829415&seqNum=16)

# c# - 即时插入/编辑

> ID：13070526
> 
> 赞同：1
> 
> 时间：2012-10-25T14:11:49.663
> 
> 标签：c#, javascript, asp.net, html, sql

我在网络上看到了多个允许您操作数据的网站。（即插入记录、删除记录、编辑记录）。
我注意到的一件很酷的事情是，当您单击删除按钮时，该项目会立即从网格中删除。然后它异步进入数据库并从那里删除记录而不打扰用户。
例如，在常规的 asp.net 应用程序中，如果您使用的是 gridview，则需要等到数据库操作完成，因为 gridview 是一个数据绑定控件。如果您使用更新面板，您仍然会在网格中看到项目，直到 DataBind 事件再次触发。

问题：是否有任何 js/.net 库可以让我开箱即用地将这样的功能添加到项目中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:16:40.757

也许您想`WebMethod`在服务器端使用 +`Ajax`在客户端调用（`jQuery`例如使用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-17T13:01:08.917

是的，你可以这样做。你有从数据库等源读取数据的网络方法。您可以使用 Ajax 调用此方法，您可以将 ajax 响应绑定到 gridview 这是示例[链接](http://www.codeproject.com/Tips/775585/Bind-Gridview-using-AJAX)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:22:33.143

您可以像 JQGrid 一样使用客户端网格。[http://www.trirand.com/blog/jqgrid/jqgrid.html](http://www.trirand.com/blog/jqgrid/jqgrid.html)。对于加载和编辑数据，您可以使用 Web 方法或 Web 服务。您还可以使用 ASP.net MVC。

# java - Android：菜单项总是纵向溢出

> ID：13070534
> 
> 赞同：2
> 
> 时间：2012-10-25T14:12:03.910
> 
> 标签：java, android, actionbarsherlock

我正在开发一个使用[SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)和 [ActionBarSherlock](http://www.actionbarsherlock.com/)的 Android 应用程序。

我想在特定的 SherlockListFragment 中包含一个 MenuItem，onClick 将刷新内容。我遇到的问题是即使有足够的空间，该项目也总是溢出。当设备转为横向时，项目会自动移动到 ActionBar。

任何人都可以帮助解决这个问题吗？我已将 showAsAction 设置为“始终”，但问题仍未解决。

这是菜单的 XML 文件

```
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@+id/menu_refresh"
    android:title="S"
    android:showAsAction="always"
    />
</menu> 
```

这是 SherlockListFragment 中的代码

```
@Override
public void onCreateOptionsMenu(Menu menu,
        com.actionbarsherlock.view.MenuInflater inflater) {
   inflater = getSherlockActivity().getSupportMenuInflater();
   inflater.inflate(R.menu.fragment_news,menu);
   super.onCreateOptionsMenu(menu, inflater);
} 
```

这是应用程序当前的样子：

![在此处输入图像描述](../Images/a4596318d5456ebbaaedeed1a58aae57.png)

我需要 ActionBar 中的按钮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:40:03.020

尝试设置图标

```
android:icon="@drawable/ic_menu_done_holo_light" 
```

或使用带有文本的标志

```
android:showAsAction="withText|always" 
```

# jsf - h:button 和 h:commandButton 之间的区别

> ID：13070537
> 
> 赞同：74
> 
> 时间：2012-10-25T14:12:09.063
> 
> 标签：jsf, button, jsf-2

`h:button`在 JSF 2 中，和有什么区别`h:commandButton`？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-10-25T15:29:17.150

# `<h:button>`

[`<h:button>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/h/button.html)生成一个`<input type="button">`HTML 。`outcome`生成的元素使用 JavaScript使用 HTTP GET 请求导航到属性给定的页面。

例如

```
<h:button value="GET button" outcome="otherpage" /> 
```

会产生

```
<input type="button" onclick="window.location.href='/contextpath/otherpage.xhtml'; return false;" value="GET button" /> 
```

即使这最终导致浏览器地址栏中的（可添加书签的）URL 更改，但这对 SEO 不友好。搜索机器人不会跟随`onclick`. `<h:outputLink>`如果`<h:link>`SEO 在给定的 URL 上很重要，您最好使用。如有必要，您可以在生成的 HTML`<a>`元素上添加一些 CSS，使其看起来像一个按钮。

请注意，虽然您可以在`outcome`属性中放置一个引用方法的 EL 表达式，如下所示，

```
<h:button value="GET button" outcome="#{bean.getOutcome()}" /> 
```

**单击按钮时不会**调用它。相反，当呈现包含按钮的页面时，它已经被调用，其唯一目的是获取要嵌入到生成的`onclick`代码中的导航结果。如果您曾经尝试使用 中的操作方法语法`outcome="#{bean.action}"`，那么您已经通过面对[javax.el.E​​LException: Could not find property actionMethod in class com.example.Bean](https://stackoverflow.com/questions/7950628/javax-el-elexception-could-not-find-property-actionmethod-in-class-com-example)被这个错误/误解所暗示。

如果您打算作为 POST 请求的结果调用方法`<h:commandButton>`，请改用，见下文。或者，如果您打算作为 GET 请求的结果调用方法，请前往[Invoke JSF managed bean action on page load](https://stackoverflow.com/questions/2451154/invoke-jsf-managed-bean-action-on-page-load)或者如果您还具有 GET 请求参数`<f:param>`，[如何在页面加载时处理支持 bean 中的 GET 查询字符串 URL 参数?](https://stackoverflow.com/questions/10724428/how-do-i-process-get-query-string-url-parameters-in-backing-bean-on-page-load/)

* * *

# `<h:commandButton>`

[`<h:commandButton>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/h/commandButton.html)生成一个 HTML按钮，`<input type="submit">`默认情况下使用 HTTP POST 方法提交父级，`<h:form>`并调用附加到和/或的操作（如果有）。是必需的。`action``actionListener``<f:ajax listener>``<h:form>`

例如

```
<h:form id="form">
    <h:commandButton id="button" value="POST button" action="otherpage" />
</h:form> 
```

会产生

```
<form id="form" name="form" method="post" action="/contextpath/currentpage.xhtml" enctype="application/x-www-form-urlencoded">
    <input type="hidden" name="form" value="form" />
    <input type="submit" name="form:button" value="POST button" />
    <input type="hidden" name="javax.faces.ViewState" id="javax.faces.ViewState" value="...." autocomplete="off" />
</form> 
```

请注意，它因此提交到当前页面（表单操作 URL 将显示在浏览器地址栏中）。之后它将*转发*到目标页面，而浏览器地址栏中的 URL 没有任何变化。您可以将`?faces-redirect=true`参数添加到结果值以在 POST 之后触发重定向（根据[Post-Redirect-Get 模式](http://en.wikipedia.org/wiki/Post/Redirect/Get)），以便目标 URL 变为可收藏。

`<h:commandButton>`通常专门用于提交 POST 表单，而不是执行页面到页面导航。通常，`action`指向一些业务操作，例如将表单数据保存在 DB 中，这会返回一个`String`结果。

```
<h:commandButton ... action="#{bean.save}" /> 
```

和

```
public String save() {
    // ...
    return "otherpage";
} 
```

返回`null`或`void`将带您回到相同的视图。也返回一个空字符串，但它会重新创建任何视图范围的 bean。如今，使用现代 JSF2 和`<f:ajax>`，操作往往只是返回到相同的视图（因此，`null`或`void`），其中结果由 ajax 有条件地呈现。

```
public void save() {
    // ...
} 
```

* * *

### 也可以看看：

*   [如何在 JSF 中导航？如何使 URL 反映当前页面（而不是上一个页面）](https://stackoverflow.com/questions/15521451/how-to-navigate-in-jsf-how-to-make-url-reflect-current-page-and-not-previous-o)
*   [什么时候应该使用 h:outputLink 而不是 h:commandLink？](https://stackoverflow.com/questions/4317684/when-should-i-use-houtputlink-instead-of-hcommandlink)
*   [action 和 actionListener 的区别](https://stackoverflow.com/questions/3909267/differences-between-action-and-actionlistener)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-25T14:16:26.567

`h:button`- 点击一个`h:button`发出书签的`GET`请求。

`h:commandbutton`- 代替 get 请求，`h:commandbutton`发出 POST 请求，将表单数据发送回服务器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-25T16:11:13.430

h:commandButton 必须包含在 ah:form 中，并且有两种导航方式，即通过设置 action 属性的静态和通过设置 actionListener 属性的动态，因此它更高级如下：

```
<h:form>
    <h:commandButton action="page.xhtml" value="cmdButton"/>
</h:form> 
```

此代码生成以下 html：

```
<form id="j_idt7" name="j_idt7" method="post" action="/jsf/faces/index.xhtml" enctype="application/x-www-form-urlencoded"> 
```

而 h:button 更简单，仅用于静态或基于规则的导航，如下所示

```
<h:button outcome="page.xhtml" value="button"/> 
```

生成的html是

```
 <title>Facelet Title</title></head><body><input type="button" onclick="window.location.href='/jsf/faces/page.xhtml'; return false;" value="button" /> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-12-18T17:05:28.063

这摘自本书 - **Ed Burns 和 Chris Schalk 的完整参考书**

**h:commandButton vs h:button**

> **h:commandButton|h:commandLink**和 **h:button|h:link**有什么区别？

后两个组件被引入`2.0`以启用可添加书签的 JSF 页面，当与 View Parameters 功能一起使用时。

**h:button|h:link**和 **h:commandButton|h:commandLink**之间有 3 个主要区别。

> 首先，`h:button|h:link`使浏览器发出一个 HTTP GET 请求，同时`h:commandButton|h:commandLink`执行一个表单 POST。这意味着页面中任何具有用户输入值的组件，例如文本字段、复选框等，在使用时都不会自动提交给服务器`h:button|h:link`。要使用 提交值，`h:button|h:link`必须采取额外的措施，使用“查看参数”功能。
> 
> 两种组件之间的第二个主要区别是， `h:button|h:link`有一个结果属性来描述下一步要去哪里，而`h:commandButton|h:commandLink`为此目的使用一个动作属性。这是因为前者不会在事件系统中产生 ActionEvent，而后者会。
> 
> 最后，对于完全理解这个特性最重要的是，`h:button|h:link`组件会导致导航系统在页面呈现期间被要求导出结果，并且这个问题的答案被编码在页面的标记中。相反，这些`h:commandButton|h:commandLink`组件导致导航系统被要求从页面中获取 POSTBACK 的结果。这是时间上的差异。渲染总是发生在 POSTBACK 之前。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-27T18:17:10.000

以下是[JSF javadocs](https://javaserverfaces.java.net/docs/2.1/vdldocs/facelets/h/commandButton.html)关于该`commandButton` `action`属性的内容：

> MethodExpression 表示用户激活此组件时要调用的应用程序操作。该表达式必须计算为不带参数的公共方法，并返回一个对象（调用其 toString() 以得出逻辑结果），该对象被传递给此应用程序的 NavigationHandler。

如果有人能解释这与本页上的任何答案有什么关系，那将对我很有启发。似乎很清楚`action`指的是某个页面的文件名而不是方法。

# .htaccess - 最后带有符号“％”的URL会产生http错误，如何用htaccess防止它？

> ID：13070544
> 
> 赞同：2
> 
> 时间：2012-10-25T14:12:26.513
> 
> 标签：.htaccess

我对我的 acces_log 中的一些 URL 有疑问。有一些来自外部站点的 URL 链接我，例如[http://domain.com/url_name.htm%](http://domain.com/url_name.htm%)（是的，带有 %）。

然后......我的服务器返回http错误，我需要将这个假URL重定向到正确的方式，我在htaccess中思考。

我只需要检测 URL 最后一个字符中的 % 符号，并在没有它的情况下重定向。 [http://domain.com/url_name.htm%](http://domain.com/url_name.htm%) --> [http://domain.com/url_name.htm](http://domain.com/url_name.htm)

我怎样才能做到这一点？我正在尝试一些样品？符号，但我没有幸运。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:53:19.660

我已经发现错误了...

似乎某些格式错误的 URL 不会传递给 vhost，然后这些请愿书不会读取 .htaccess。

解决这个问题的唯一方法是在 httpd.conf 中添加 ErrorDocument 400 指令......对于具有不同虚拟主机的服务器来说，这不是最佳选择......因为所有这些都将具有相同的行为......但我认为这是这种情况的唯一方法。

[来自Apache 文档](http://httpd.apache.org/docs/2.0/mod/core.html#errordocument)的引用：

> 尽管可以覆盖大多数错误消息，但在某些情况下，无论 ErrorDocument 的设置如何，都会使用 >internal 消息。特别是，如果检测到格式错误的请求，将立即停止正常的请求处理并返回 >internal 错误消息。这是防止由错误请求引起的安全问题所必需的。

不管怎么说，还是要谢谢你！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:25:50.070

此页面对 .htaccess 规则非常有帮助。 [http://www.helicontech.com/isapi_rewrite/doc/RewriteRule.htm](http://www.helicontech.com/isapi_rewrite/doc/RewriteRule.htm)

我也看到了一些使用小型 php 脚本的解决方案。IE 这个替换 #

```
.htaccess
RewriteRule old.php redirect.php?          url=http://example.com/new.php|hash      [R=301,QSA,L]

redirect.php
<?php
$new_url = str_replace("|", "#", $_GET['url']);
header("Location: ".$new_url, 301);
die;
?> 
```

# javascript - css 为 null 或不是对象

> ID：13070550
> 
> 赞同：2
> 
> 时间：2012-10-25T14:12:42.443
> 
> 标签：javascript, jquery, asp.net, css, web

故障线路在这里：

```
var f = parseInt($("#" + a + "kinetic")
    .css("height")
    .replace("px", "")); 
```

使用 IE8，奇怪的是运行网站 localhost 时不会弹出错误，但是当我们发布它并在已发布的服务器上访问它时它会弹出。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:15:51.600

不应该是这样吗？

```
var f = parseInt($("#" + a + "kinetic")
    .css("height")); 
```

或者

```
var f = parseInt($("#" + a + "kinetic").height()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:25:15.097

这应该足够了：

```
var f = jQuery("#" + a + "kinetic").height(); 
```

`height()`如果要获取元素的实际高度，则返回一个 int 。

请注意，如果您的元素之前没有设置 height css 属性，即使它有高度，`jQuery(".element").css("height")`也会返回 null。

在那里你可以了解更多关于`.height()` [http://api.jquery.com/height/](http://api.jquery.com/height/)

# java - 在 Java 中解析 PDF 文件的字体大小

> ID：13070551
> 
> 赞同：3
> 
> 时间：2012-10-25T14:12:42.660
> 
> 标签：java, parsing, pdf, font-size

我需要编写一个可以在 PDF 文档中找到最大文本的程序（这可能是标题！），我尝试使用[Tika](http://tika.apache.org/)作为解析器，但找不到获取字体大小的方法。Tika 库对于我的使用来说似乎过于强大和复杂。我可以使用更简单的方法/库吗？不使用库并自己解析 PDF 是否更容易或更好（我对这种方法有点兴趣）？如果是这样，我应该从哪里开始？

非常感谢任何信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:02:53.080

我在 SO 上找到[了这个](https://stackoverflow.com/a/6444178/242036)方法，它覆盖了PDFBox 库中的`processTextPosition`from`PDFTextStripper`并提取了字体大小。我以前没有看到它，因为帖子的问题有点不同。

# ipad - iOS：从 XIB 添加导航栏

> ID：13070563
> 
> 赞同：1
> 
> 时间：2012-10-25T14:13:11.340
> 
> 标签：ipad, ios5, uinavigationbar, xib

我一直看到这个问题并通过在代码中手动创建 UINavigationController 来解决它。有人可以告诉我，当我从 XIB 的属性检查器添加导航栏 - > 将顶部栏设置为黑色导航栏时，它会显示在 XIB 中，但是当我运行程序时，它不会出现！我注意到 self.NavigationController 即将为零，所以我在我的 XIB 中添加了 UINavigationController 并分配了 NIB，但它仍然为零！这有什么问题？我需要任何其他设置吗？

[编辑1]

我尝试像下面那样添加它并且它可以工作，但我希望父类自动将旋转和外观事件转发给子控制器。如果我关注它，它不会发送它们，因为我将 nvc 添加为子元素而不是市场列表视图控制器。所以我想我必须继承 UINavigationController。见 EDIT2。

```
self.marketsListViewController = [[MarketsListViewController alloc] initWithNibName:@"MarketsListViewController" bundle:nil];
UINavigationController *nvc = [[UINavigationController alloc] initWithRootViewController:self.marketsListViewController];
nvc.navigationBar.barStyle = UIBarStyleBlack;
[self.marketsListView addSubview:nvc.view];

[self addChildViewController:nvc];
[nvc didMoveToParentViewController:self]; 
```

[编辑2]

我已将marketsListViewController 子类化为UINavigationController，并认为以下将起作用，但事实并非如此。它只显示导航栏，UITableView 不显示！

```
self.marketsListViewController = [[MarketsListViewController alloc] initWithNibName:@"MarketsListViewController" bundle:nil];
self.marketsListViewController.navigationBar.barStyle = UIBarStyleBlack;
[self.marketsListView addSubview:self.marketsListViewController.view];

[self addChildViewController:self.marketsListViewController];
[self.marketsListViewController didMoveToParentViewController:self]; 
```

[编辑3]

我在 Edit1 中错了，当我将子控制器添加为导航控制器的根控制器时，子控制器不会获得旋转事件。父母仍然自动发送所有事件，这就是我想要的！:)

![添加了来自 XIB 的导航栏](../Images/1fbd4fb4d5fd1c01c60a476c50fd8826.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:19:54.437

> 有人可以告诉我，当我从 XIB 的属性检查器添加导航栏 - > 将顶部栏设置为黑色导航栏时，它会显示在 XIB 中，但是当我运行程序时，它不会出现！

您在 .xib 文件中看到的内容只是为了帮助您正确布局并很好地了解它的外观。当您的应用程序使用导航栏时，导航栏几乎总是由导航视图控制器 ( `UINavigationController`) 管理。导航控制器托管的视图控制器不担心导航栏——它们的视图层次结构位于导航栏下方的空间中。

因此，在您的应用程序中获取导航栏的*正确*方法几乎可以肯定是使用导航控制器。如果您只有一个视图控制器，则将其设为导航控制器的根视图控制器（注意：*窗口*的根视图控制器将是导航视图控制器）。您可以通过设置导航栏的样式从视图控制器更改栏的外观：

```
self.navigationController.navigationBar.barStyle = UIBarStyleBlack; 
```

**更新：**在您发布的代码中，您只是创建了一个新的导航控制器，但没有对它做任何事情。我在上面提到了一个事实，即（在大多数情况下）导航控制器应该是窗口的根视图控制器。在代码中创建导航控制器很好，但您通常会在应用程序委托中进行，一旦创建它，​​您会将其设置为窗口的根视图控制器。这是一个从 Xcode 的主/详细模板（无情节提要）新建的项目中借用的示例：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.

    MasterViewController *masterViewController = [[MasterViewController alloc] initWithNibName:@"MMMasterViewController" bundle:nil];
    self.navigationController = [[UINavigationController alloc] initWithRootViewController:masterViewController];
    self.window.rootViewController = self.navigationController;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

请注意，在创建窗口和导航控制器之后，代码将导航控制器设置为窗口的根视图控制器。

# python - Python：找到完全匹配

> ID：13070566
> 
> 赞同：2
> 
> 时间：2012-10-25T14:13:32.007
> 
> 标签：python, regex

我想使用 find() 找到完全匹配的单词。但它接缝 find() 也返回具有部分匹配的字符串。

参考 stackoverflow[字符串完全匹配中](https://stackoverflow.com/questions/4173787/string-exact-match)的先前帖子，使用了以下正则表达式：

```
 import re

   print(re.findall('\\blocal\\b', "Hello, locally local test local."))
   // ['local', 'local'] 
```

问题是在我的情况下是“本地的”。不同于“本地”

我怎样才能做到这一点？

更新：

我需要做的是替换包含本地工作的元素。

```
 print("Hello, locally local test local#".replace('local','we'))
  // should result in 

  Hello, locally we test local# 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:19:58.850

如果您返回的只是您要查找的内容的列表，那么这没有任何意义`findall`......对于这个用例，我不会打扰 re，只需使用：

```
'Hello, locally local test local.'.split().count('local') 
```

* * *

好的，与以下内容相关的更新：

> 我需要做的是替换包含本地工作的元素。

我会选择类似的东西：

```
re.sub(r'\blocal([\b\s])', r'we\1', s) 
```

# ruby - 使用 Ruby 进行 Ebay 身份验证

> ID：13070568
> 
> 赞同：2
> 
> 时间：2012-10-25T14:13:34.320
> 
> 标签：ruby, authentication, sinatra, omniauth

我正在开发 eBay Sinatra 应用程序，需要通过用户的登录名和密码对用户进行身份验证，以使他们能够自行从 eBay 请求信息。通过身份验证，我的意思是通过重定向（或类似的方式）到 eBay 并输入他们的登录名和密码来进行身份验证。它类似于 Facebook 身份验证。

我做了一项研究，但发现几乎为零。你的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T19:16:14.147

[Omniauth](http://www.omniauth.org/)有一个[ebay 身份验证策略](https://github.com/TheGiftsProject/omniauth-ebay)。我没有使用过它，但omniauth 是一个能胜任的宝石，可以为各种网站处理不同的登录策略。最近我使用了带有rails的omniauth，但是几个月前我也使用了padrino，所以我认为它应该也适用于纯sinatra。

# php - 使用 php 从 mysql 查询中排序数据时遇到困难

> ID：13070574
> 
> 赞同：1
> 
> 时间：2012-10-25T14:13:51.680
> 
> 标签：php, mysql, sorting

此代码用于从一个表中获取特定的 ID 列表，然后使用这些 ID 从另一个表中获取信息。从第二个表中获取所有信息后，我将尝试根据第二个表中的字段按字母顺序对数据进行排序。

例如，我根据相关 ID 获取名称，然后希望按名称 (artist_name) 的字母顺序显示整个结果。

这是我的代码。当我在没有 的情况下执行此操作时`sort()`，它可以正常工作，但不是按字母顺序排列的。当我`sort()`在第二个 while 语句中添加时，页面看起来相同，但名称和其他数据不显示。浏览器中的源代码显示正在考虑结果，但由于某种原因，排序必须阻止变量或信息显示。

我以前没有使用过排序功能，我尝试查看一些示例，但无法真正找到针对我的情况的特定内容。任何和所有的帮助将不胜感激。我已经查看了*PHP 手册*以进行排序，因此无需向我发送链接；-)

```
<?php $counter = 0;
    $artistInfo = mysql_query("SELECT DISTINCT event_url_tbl.artist_id FROM event_url_tbl WHERE (SELECT cat_id FROM artist_tbl WHERE artist_tbl.artist_id = event_url_tbl.artist_id) = 1");
    while ($aID = mysql_fetch_array($artistInfo))
        {
            $getArtistInfo = mysql_query("SELECT * FROM artist_tbl WHERE artist_id = '" . $aID['artist_id'] . "'");
            while($artist = mysql_fetch_array($getArtistInfo))
                { 
                    sort($artist);?>
                    <a class="navlink" href="<?=HOST?><?=$artist['page_slug']?>/index.html">
                        <?=$artist['artist_name']?>
                    </a><br />
                <?php }
        }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:25:36.673

正如评论者所提到的，您最好的选择是`ORDER BY`在 SQL 中使用子句。

```
SELECT * 
FROM artist_tbl 
WHERE artist_id = XXX 
ORDER BY artist_name ASC 
```

建议使用[PDO](http://us2.php.net/manual/en/book.pdo.php)或[mysqli](http://us2.php.net/manual/en/book.mysqli.php)的其他评论者也是正确的，但这是一个不同的问题。

根据手册回答您关于排序的具体问题，

> Blockquote 注意：此函数将新键分配给数组中的元素。它将删除可能已分配的任何现有密钥，而不仅仅是重新排序密钥。

这意味着您的所有数组键（“page_slug”、“artist_name”等）都被清除了。因此，当您稍后尝试引用它们时，那​​里没有数据。

如果您使用此方法，您将希望使用[asort](http://us2.php.net/manual/en/function.asort.php)对关联数组进行排序。

但是，您不想在`sort`这里使用。您要排序的是一行数据（一位艺术家）的变量，而不是所有艺术家。因此，如果您将每个艺术家行视为一张充满数据（姓名、id#、页面 slug 等）的索引卡，那么您所做的就是在卡上移动这些项目。你没有重新组织你的卡片目录。

在 SQL 语句中使用`order by`子句（并在 PDO 中重写）是最好的选择。

这是我将如何重写它。我必须对 SQL 进行一些猜测，因为我不能 100% 确定您的数据库结构以及您具体要完成的工作，但我认为这会奏效。

```
$query_str = "
    SELECT 
        artist.name,
        artist.page_slug
    FROM 
        artist_tbl AS artist
        INNER JOIN event_tbl AS event
            ON event.artist_id = artist.artist_id
    WHERE
        artist.cat_id = 1
    ORDER BY
        artist.name ASC";
$db_obj = new PDO (/*Connection stuff*/);
$artists_sql = $db_obj->prepare ($query_str);
$artists_sql->execute ();
while ($artist = $artists_sql->fetch (PDO::FETCH_ASSOC)) {
    $return_str .= "<a class='navlink' href='{HOST}
                {$artist['page_slug']}/index.html'>
                {$artist['artist_name']}</a><br/>";
    }
echo $return_str; 
```

老实说，我可能会创建一个带有`display_link`方法的艺术家类，并使用 PDO 的`fetchObject`方法来实例化艺术家，但这在这里超越了我们自己。

现在我坚持使用程序代码。我通常不喜欢混合使用 HTML 和 PHP，所以我将所有内容分配给返回字符串并在最后回显。但这与您所拥有的很接近，使用一个 SQL 查询（在 PDO 中 - 如果您正在创建新代码，则非常值得开始使用），它应该为您提供按名称排序的艺术家列表及其相关的 page_slugs。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:32:33.407

您可以在一个查询中完成所有这些操作：

```
SELECT * FROM event_url_tbl AS event
INNER JOIN artist_tbl AS artist ON event.artist_id = artist.id
ORDER BY artist.name DESC; 
```

这减少了脚本中的许多复杂性/前瞻。你最终会得到

```
Label1 (Label 1 details..) Artist1 (Artist1 details..)
Label1 (Label 1 details..) Artist2 (Artist1 details..)
Label2 (Label 2 details..) Artist3 (Artist1 details..) 
```

始终牢记“一个查询胜于多个查询”。不是一个具体的规则，只要有可能，就尝试去做。每个查询都有开销，循环中的查询是一个警告信号。

希望这会有所帮助

# javascript - Javascript 存储定位器，未捕获的 ReferenceError: ... 未定义

> ID：13070578
> 
> 赞同：3
> 
> 时间：2012-10-25T14:14:01.697
> 
> 标签：javascript, google-maps, google-maps-api-3, undefined

我在调用 Google 地图的 calcRoute 函数的链接上设置了一个带有变量的 onclick，每次单击该链接时，它都会显示以下***Uncaught ReferenceError: NE461UL is not defined 顺便***说一下，该参数是一个邮政编码。

我已经尝试了一段时间，但我无法弄清楚为什么它会显示错误。

我有一个带有以下行的 jquery 文件

```
var distLink = "<a onclick=\"calcRoute(" + postcode +  "); return false;\" datalat=" + lat + " datalng=" + lng + " id=\"get-directions\" class=\"directions" + letter +"\">Directions<\/a>"; 
```

calcRoute 在我的标题中

```
function calcRoute(postcode) {
  console.log(marker);
  var start = document.getElementById("address").value;
  var end = document.getElementById("get-directions").name;
 $('get-directions').click(function(){
    console.log('click!');

});
  var request = {
    origin:start,
    destination:end,
    travelMode: google.maps.TravelMode.DRIVING
  };
  console.log(JSON.stringify(request)); 
   directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      directionsDisplay.setDirections(response);
    }
  });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:18:02.230

邮政编码必须作为字符串传递（它周围有一对额外的引号）：

```
distLink = "<a onclick=\"calcRoute('" + postcode +  "'); return false;\" datalat=" + lat + " datalng=" + lng + " id=\"get-directions\" class=\"directions" + letter +"\">Directions<\/a>"; 
```

# jquery - 是否可以找到 SVGTSpanElement 的父级或下一个/上一个兄弟级

> ID：13070579
> 
> 赞同：3
> 
> 时间：2012-10-25T14:14:02.393
> 
> 标签：jquery, jquery-svg

我通常可以使用类似的东西找到事件目标的父级或适当的兄弟级

```
$(".occupancy").bind("click", function(event){
    day = $(event.target).parent().attr("class");
    // more stuff
}); 
```

但是，如果事件是在 svg 对象上触发的，例如

```
$(".booked").on("click", function(event) {
    day = $(event.target).parent().attr("class");
    $("#cancellation_Form_Wrapper").css("visibility","visible");
    $("#cancellation_Form_Wrapper").change();
}).svg({loadURL: '../_public/_icons/booked.svg'}); 
```

父级未定义。

我很欣赏 svgdom 与普通 DOM 不同，并实现了 jquery.svgdom.min.js。但我对 SVG 的内部 DOM 不感兴趣，我对 SVG 在 DOM 中的位置感兴趣。

我试图向 svgdom 添加一个包装器，然后寻找包装器的父级。但这也没有用。关于如何实现这一点的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:47:59.420

OK 最后我想我得到了一个合理的答案。这可能不会用技术语言表达，但希望你能理解。

这不是一个完美的答案，因为您必须了解或对 dom 做出假设。但它确实对我有用，因为我的 dom 结构在这种情况下是固定的。

我不是在寻找标签名称，而是在寻找父母和兄弟姐妹的班级。因此，如果需要更通用的东西，您将不得不进一步完善它。

使用 parentsUntil($(".wrapper").parent() 找到你正在寻找的元素，你需要这种格式，因为 parentsUnitl() 找不到自己。映射它以创建一个字符串，然后使用 split 转换字符串到一个数组找到数组中的最后一个元素，你就有了父元素。

```
 $('.svgload').on('click', function(event) {
         alert('clicked svg new');
         var parentElements = $(event.target).parentsUntil($(".wrapper").parent())
             .map(function () { 
                 return this.className; 
             })
             .get().join(", ");
         alert(parentElements);
         parentsArray = parentElements.split(",");
         alert(parentsArray.pop());
 }).svg({loadURL: '../_public/_icons/booked.svg'}); 
```

我想不出如何找到兄弟姐妹，但我可能会从找到的父母开始工作。

如果我找到办法做到这一点，我会报告。

# php - 在 magento 产品页面上更新主要产品 url

> ID：13070581
> 
> 赞同：4
> 
> 时间：2012-10-25T14:14:09.307
> 
> 标签：php, javascript, magento, magento-1.7

我有一个关于我目前正在构建的 magento 项目的问题。我的产品页面有一个主图像（可配置产品）和下面的缩略图。我的代码已经到了单击缩略图将图像附加到主图像区域的阶段，但是我需要它包含的链接的 href 也附加到该 imgs url。希望这是有道理的，欢迎任何帮助。

```
<?php
    $_product = $this->getProduct();
    $_helper = $this->helper('catalog/output');
?>

<div class="grid_12 grid_spacer_bottom">
<?php
    $_img = '<img id="image" class="img-left img-inlineblock responsive-img" src="'.$this->helper('catalog/image')->init($_product, 'image').'" alt="'.$this->htmlEscape($this->getImageLabel()).'" />';
    //echo $_helper->productAttribute($_product, $_img, 'image');
?>

<a href=""><?php echo $_helper->productAttribute($_product, $_img, 'image'); ?></a>

</div>

<div class="clear"></div>

<?php if (count($this->getGalleryImages()) > 0): ?>
<div class="more-views">
    <?php foreach ($this->getGalleryImages() as $_image): ?>
        <div class="grid_4 grid_spacer_bottom">
            <a href="<?php echo $this->helper('catalog/image')->init($this->getProduct(), 'image', $_image->getFile()); ?>" title="<?php echo $_product->getName();?>" onclick="$('image').src = this.href; return false;">
                <img class="img-left img-inlineblock responsive-img" src="<?php echo $this->helper('catalog/image')->init($this->getProduct(), 'thumbnail', $_image->getFile()); ?>" alt="<?php echo $this->htmlEscape($_image->getLabel()) ?>" />
            </a>
        </div>
    <?php endforeach; ?>
</div>
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:06:50.917

我假设您在单击大图像时尝试制作它将具有缩略图的 url

给这个 href 一个 ID

```
 <a href="" id="img_href"><?php echo $_helper->productAttribute($_product, $_img, 'image'); ?></a> 
```

你使用的是 jquery 还是原型（如果是默认的 magento 那么这个）

原型

```
$('img_href').setAttribute('href', this.href);
//$('img_href').href = this.href; // or 
```

jQuery

```
$("#img_href").attr("href", this.href); 
```

纯Javascript

document.getElementById('img_href').href = this.href;

更新缩略图 onclick

```
onclick="$('image').src = this.href;  $('img_href').setAttribute('href', this.href); return false;" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:03:38.567

*$('image').parentNode.href='你的网址';* ?

# facebook - Facebook 清除缓存和 cookie 后访问令牌无效

> ID：13070583
> 
> 赞同：1
> 
> 时间：2012-10-25T14:14:12.160
> 
> 标签：facebook, facebook-graph-api, browser, access-token, facebook-access-token

我的应用程序未加载，在这两种情况下出现以下错误：

a) 在清除缓存和 cookie 后，或从我以前未使用过的 PC 使用任何浏览器第一次访问我的应用程序时。

b) 当用户 A 尝试在用户 B 从应用程序（和 Facebook）注销后直接从同一 PC 和浏览器访问应用程序时，未清除缓存或 cookie。

但是，当我按 F5 更新网页时，它工作正常。

这是我在日志文件中得到的错误：

```
{"readyState":4,"responseText":"Invalid access token","status":200,"statusText":"OK"} 
```

**用户验证码：**

```
require_once(dirname(__DIR__).'/lib/common/AppInfo.php');
require_once(dirname(__DIR__).'/sdk/src/facebook.php');
require_once(dirname(__DIR__).'/lib/logic/UsersLogic.php');
require_once(dirname(__DIR__).'/lib/common/Log.php');

if (substr(AppInfo::getUrl(), 0, 8) != 'https://' && $_SERVER['REMOTE_ADDR'] != '127.0.0.1') {
    header('Location: https://'. $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']);
    exit();
}

try {
    $facebook = new Facebook(array(
            'appId'  => AppInfo::appID(),
            'secret' => AppInfo::appSecret(),
    ));
    $user_id = $facebook->getUser();
} catch (Exception $e) {
    exit("Error getting facebook data");
}

if ($user_id) {
    try {
        $basic = $facebook->api('/me');
    } catch (FacebookApiException $e) {
        if (!$facebook->getUser()) {
            exit("Invalid access token");
        }
    }
    if($basic==null){
        exit("Application not installed");
    }
    $user=UsersLogic::getUser($user_id);
    if($user==null){
        exit("User not registered in database");
    }

}
else{
    exit("No user logged");
} 
```

任何想法为什么会发生？也许我应该强制请求一个新的用户访问令牌？（如何）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T19:17:45.183

这是完全可以预料的——在第一种情况下，没有 cookie，不知道用户是谁，因此无法获取有效的访问令牌，在第二种情况下，从 Facebook 注销（或取消授权您的应用程序）将导致您必须无效的任何访问令牌。

但是那个错误，是来自客户端代码吗？在这种情况下，您需要包装您正在使用的代码`FB.getLoginStatus`或类似代码，这样您就不会运行它，除非您确实拥有所需的访问令牌。

# java - 我的 JSP 中未正确显示元音变字符

> ID：13070584
> 
> 赞同：2
> 
> 时间：2012-10-25T14:14:15.717
> 
> 标签：java, html, jsp, character-encoding

我有一个jsp，它可以选择上传文件。在我的情况下，我上传了一个文件，该文件的名称由英文和元音变音字符组合而成 - 将在下一个 jsp 中正确显示，例如*`üß_file.xls`*，当与更高环境中相同的代码显示时，*`?_file.xls`*即测试环境我有尝试了三个选项：

1.  在编码`UTF-8`选项中编码为我的jsp中的第一行。

2.  我已将`html:form`属性（接受字符集）更改为`UTF-8`.

3.  我只包含了 SetCharacter Encoded Sevlet 过滤器，它将响应内容类型设置为`UTF-8`并将 .set 字符编码请求为`UTF-8`. 它包括更改 *`web.xml`*参数以强制 jsp 模式为`UTF-8`编码类型。

请建议我一些解决方案来解决测试环境中的这个问题（它在 DEV 和本地环境中运行良好）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T22:22:04.223

你检查过 servlet-container 的编码吗？例如，Tomcat 可能使用可能不是 UTF-8 的平台 (OS) 编码。

# c# - 在 Wow6432Node 和普通配置单元中创建注册表

> ID：13070586
> 
> 赞同：3
> 
> 时间：2012-10-25T14:14:20.587
> 
> 标签：c#, visual-studio-2010, outlook, add-in

因此，我使用 Visual Sudio 2010 为 Outlook Addin 创建了一个 MSI，并将注册表项添加为：

![注册蜂巢](../Images/e05b06c2c5bfcfa92d7206ba3fa75a8b.png)

并运行它并将注册表项放入`Wow6432Node`虽然 Office 和 Windows 都是 x64。

我运行 Windows 7 和 Office 2010 x64。

然后我导出了 myAddin 注册表配置单元并对其进行了编辑，使其指向`HKEY_LOCAL_MACHINE\Software\Microsoft\Office\Outlook\Addins`. 打开 Outlook 并猜猜是什么......插件出现了。

下一个问题，如何`Wow6432Node`在 Visual Studio 中将注册表项添加到普通和配置单元？

这是这个问题的后续形式：[Outlook COM addin installed but not loading in Outlook](https://stackoverflow.com/questions/13049588/outlook-com-addin-installed-but-not-loading-in-outlook)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:23:15.370

对于 x64 Office，[请确保分配正确的**TargetPlatform**](http://msdn.microsoft.com/en-us/library/cd7a85k9%28v=vs.100%29.aspx)（*在 VS Setup Project Properties 下*），以便安装程序知道要分配的注册表位置。默认`TargetPlatform`值为 x86，它将您的注册表配置单元放置`Wow6432Node`在 x64 操作系统主机上。

### VS 安装项目 (x64 Office)

> 目标平台 = x64

### VS 安装项目 (x86 Office)

> 目标平台 = x86

# java - 通过本机 Java API 验证 Windows 用户凭据

> ID：13070587
> 
> 赞同：9
> 
> 时间：2012-10-25T14:14:30.353
> 
> 标签：java, windows, validation, credentials

我需要存储 Windows 用户名和凭据，以便稍后运行一些需要这些凭据的进程。

当我从用户那里收集这些作为输入时，我想验证凭据是否正确。Java中是否有可以帮助我验证Windows系统凭据的本机api？

我正在`LoginContext`上课，但看起来它只能用于 SSO 目的。我收到的另一个建议是尝试启动一个需要这些凭据的进程，看看它是否有效。但这看起来不是正确的方法。

请让我知道是否有人以前这样做过或知道如何完成它。

谢谢，皮尤什

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T14:55:24.987

通过凭据，您的意思是用户的实际密码？然后，您可以使用 LDAP 尝试连接到 Windows Active Directory。请参阅相关问题：[Windows 密码身份验证与 LDAP](https://stackoverflow.com/questions/3147403/windows-password-authentication-with-ldap)

更精细的方法是使用本机 Windows 调用，可能通过 JNA 平台：http: [//jna.java.net/javadoc/platform/com/sun/jna/platform/win32/package-summary.html](http://jna.java.net/javadoc/platform/com/sun/jna/platform/win32/package-summary.html)

[有一个名为“waffle”的项目将其包装在一个更有用的库中，例如参见https://github.com/dblock/waffle/blob/master/Source/JNA/waffle-jna/src/waffle/](https://github.com/dblock/waffle/blob/master/Source/JNA/waffle-jna/src/waffle/windows/auth/impl/WindowsAuthProviderImpl.java)中的 logonUser 函数[windows/auth/impl/WindowsAuthProviderImpl.java](https://github.com/dblock/waffle/blob/master/Source/JNA/waffle-jna/src/waffle/windows/auth/impl/WindowsAuthProviderImpl.java)。这直接与 win32 advapi32.dll 对话。

这也将允许您在没有域的情况下为本地用户进行 Windows 身份验证。

**编辑**：来自 OP 的完整工作代码

```
import com.sun.jna.platform.win32.Advapi32; 
import com.sun.jna.platform.win32.Kernel32; 
import com.sun.jna.platform.win32.WinBase; 
import com.sun.jna.platform.win32.WinNT.HANDLEByReference; 

HANDLEByReference phUser = new HANDLEByReference() 
if(! Advapi32.INSTANCE.LogonUser("administrator", InetAddress.getLocalHost().getHostName(),
    "password", WinBase.LOGON32_LOGON_NETWORK, WinBase.LOGON32_PROVIDER_DEFAULT, phUser)) 
{
  throw new LastErrorException(Kernel32.INSTANCE.GetLastError()); 
} 
```

# c++ - 使用 Qt 跨 HTTP 的协议缓冲区序列化中的空白

> ID：13070592
> 
> 赞同：1
> 
> 时间：2012-10-25T14:14:45.920
> 
> 标签：c++, qt, http, serialization, protocol-buffers

我正在尝试通过 HTTP 连接发送一个 Google Protocol Buffer 序列化字符串并将其接收回来（未修改），我将在其中反序列化它。我的问题似乎与 'serializeToString' 方法有关，该方法采用我的字符串并似乎将换行符（可能还有其他空格）添加到序列化字符串中。在下面的示例中，我使用字符串“camera_stuff”，在对其进行序列化后，我得到一个 QString，前面有换行符。我尝试了其他具有相同结果的字符串，只是添加了不同的空格和换行符。这会导致我的反序列化操作出现问题，因为 HTTP 请求中未捕获空格，因此无法成功解码来自服务器的包含序列化字符串的响应。如果我猜到序列化字符串中的空格，我可以部分解码它。我该如何解决这个问题？请参阅以下代码 - 谢谢。

我有一个协议缓冲区 .proto 文件，如下所示：

```
message myInfo {
  required string data = 1;
  required int32 number = 2;
} 
```

运行 protoc 编译器后，我在其中构造 Qt，如下所示：

```
// Now Construct our Protocol Buffer Data to Send
myInfo testData;
testData.set_data("camera_stuff");
testData.set_number(123456789); 
```

我将我的数据序列化为这样的字符串：

```
// Serialize the protocol buffer to a string
std::string serializedProtocolData; // Create a standard string to serialize the protocol buffer contents to
myInfo.SerializeToString(&serializedProtocolData); // Serialize the contents to the string
QString serializedProtocolDataAsQString = QString::fromStdString(serializedProtocolData); 
```

然后我像这样打印出来：

```
// Print what we are sending
qDebug() << "Sending Serialized String: " << serializedProtocolDataAsQString;
qDebug() << "Sending Serialized String (ASCII): " << serializedProtocolDataAsQString.toAscii();
qDebug() << "Sending Serialized String (UTF8): " << serializedProtocolDataAsQString.toUtf8();
qDebug() << "Sending Serialized Protocol Buffer";
qDebug() << "Data Number: " << QString::fromStdString(myInfo.data());
qDebug() << "Number: " << (int)myInfo.number(); 
```

当我将数据作为 HTTP 多部分消息的一部分发送时，我会看到这样的打印语句（注意打印输出中的换行符！）：

```
Composing multipart message...
Sending Serialized String:  "

camera_stuffï:" 
Sending Serialized String (ASCII):  "

camera_stuffï:" 
Sending Serialized String (UTF8):  "

camera_stuffÂÂÃ¯:" 
Sending Serialized Protocol Buffer 
Data:  "camera_stuff" 
Number:  123456789 
Length of Protocol Buffer serialized message:  22 
Loading complete... 
```

客户端反序列化消息如下：

```
// Now deserialize the protocol buffer
string = "\n\n" + string; // Notice that if I don't add the newlines I get nothing!
myInfo protocolBuffer;
protocolBuffer.ParseFromString(string.toStdString().c_str());
std::cout << "DATA: " << protocolBuffer.model() << std::endl;
std::cout << "NUMBER: " << protocolBuffer.serial() << std::endl;
qDebug() << "Received Serialized String: " << string;
qDebug() << "Received Deserialized Protocol Buffer";
qDebug() << "Data: " << QString::fromStdString(protocolBuffer.data());
qDebug() << "Number: " << (int)protocolBuffer.number(); 
```

服务器返回它而不对序列化的字符串做任何事情，客户端打印以下内容：

```
RESPONSE:  "camera_stuffï:"  
DATA: camera_stu
NUMBER: 0
Received Serialized String:  "

camera_stuffï:" 
Received Deserialized Protocol Buffer 
Number:  "camera_stu"

Number:  0 
```

所以你看到的问题是我无法猜测空格，所以我似乎无法可靠地反序列化我的字符串。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:21:33.810

序列化的 protobuf 不能被视为`C`字符串，因为它可能在其中嵌入了 NUL。这是一个二进制协议，它使用所有可能的八位字节值，并且只能通过 8 位干净连接发送。它也不是有效的 UTF-8 序列，不能作为 Unicode 序列化和反序列化。因此`QString`也不是存储序列化 protobuf 的有效方法，我怀疑这也可能会导致您出现问题。

您可以使用`std::string`和`QByteArray`。我强烈建议你避免其他任何事情。特别是，这是错误的：

```
protocolBuffer.ParseFromString(string.toStdString().c_str()); 
```

因为它会在第一个截断 protobuf `NUL`。（您的测试消息没有任何内容，但这迟早会咬到您。）

至于通过 HTTP 发送消息，您需要能够确保消息中的所有字节都按原样发送，这也意味着您需要显式发送长度。您没有包含实际发送和接收消息的代码，所以我无法评论它（而且我无论如何都不太了解 Qt HTTP 库），但事实上`0x0A`正在从消息的前面表明您缺少某些东西。确保正确设置消息部分中的内容类型（例如，不是文本）。

# android - 在 ViewFlipper 上滑动

> ID：13070594
> 
> 赞同：3
> 
> 时间：2012-10-25T14:14:56.953
> 
> 标签：android, listeners

我有一个 ViewFlipper，其中有四个带有布局的滚动视图。

我使用以下代码（对于每个滚动视图）进行滑动：

```
ScrollView View1 = (ScrollView) findViewById(R.id.View1);
    View1.setOnTouchListener(new OnTouchListener() {

        public boolean onTouch(View v, MotionEvent event) {
            // TODO Auto-generated method stub

            if (event.getAction() == MotionEvent.ACTION_DOWN) {
                FirstX = (int) event.getX();
            }

            if (event.getAction() == MotionEvent.ACTION_MOVE) {
                int LastX = (int) event.getX();

                if (FirstX - LastX > SWIPE_MIN_DISTANCE) {
                    viewFlipper.setInAnimation(slideLeftIn);
                    viewFlipper.setOutAnimation(slideLeftOut);
                    viewFlipper.showNext();
                } else if (LastX - FirstX > SWIPE_MIN_DISTANCE) {
                    viewFlipper.setInAnimation(slideRightIn);
                    viewFlipper.setOutAnimation(slideRightOut);
                    viewFlipper.showPrevious();
                }
            }

            return true;
        }
    }); 
```

它有效，但看起来如果我从视图 1 滑动到视图 2，我会看到视图 2 和 3 混合在一起，最终显示视图 4。

因此，似乎每个视图的 OnTouchListeners 都是在彼此之后调用的。我怎样才能防止这种情况发生？

短而快速的滑动完成了它应该做的事情。

rg，埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:43:23.047

您应该移动您拥有的代码`MotionEvent.ACTION_MOVE`以`MotionEvent.ACTION_UP`进行滑动。现在，如果你不想滑动，并且想随着手指移动屏幕，你应该`ViewPager`像刚才提到的 JafarKhQ 那样实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:19:19.117

setOnTouchListener 将调用多次时间（当你滑动手指时），所以

```
viewFlipper.setInAnimation(slideLeftIn);
viewFlipper.setOutAnimation(slideLeftOut);
viewFlipper.showNext(); 
```

将多次调用

我建议您使用[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)而不是 ViewFlipper。

# php - Symfony 2 创建具有 2 个属性的实体表单字段

> ID：13070595
> 
> 赞同：17
> 
> 时间：2012-10-25T14:14:59.370
> 
> 标签：php, symfony, symfony-forms

我正在使用*symfony2*并有一个表单来保存一个用户与某些规则的关系。这些规则由公司的管理员用户设置。在这个表单中，当我选择了一个用户进行更新后，我必须选择这个用户拥有哪个规则的权限。

问题是我可能有不止一个具有相同名称的规则（它是另一个实体），但值不同。因此，当我构建选择框时，我必须显示名称和值，例如：

1.  物品数量 - 10
2.  物品数量 - 20
3.  物品价值 - 200
4.  物品价值 - 500

但现在我可以使用下面的代码显示没有“- $value”：

```
$form = $this->createFormBuilder()->add('myinput', 'entity', array(
                    'class' => 'myBundle:Rule',
                    'property' => 'childEntity.name',
                    'label' => 'Filas Permitidas',
                    'expanded' => false,
                    'multiple' => true,
                    'choices' => $this->getDoctrine()
                            ->getRepository('MyBundle:Rule')
                            ->findAll(),
                    'required' => true,
                ))->getForm(); 
```

因此，作为我想要获得`$myEntity->getChildEntity()->getName()`的财产和`$myEntity->getValue()`.

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-25T14:28:34.410

`getUniqueName()`是的，在实体类中定义一个方法，例如：

```
public function getUniqueName()
{
    return sprintf('%s - %s', $this->name, $this->value);
} 
```

并编辑`property`表单选项：

```
'property' => 'childEntity.uniqueName', 
```

您也可以省略`property`选项并以`__toString()`相同的方式定义方法，以免`property`在每个表单中重复选项的设置。

# macos - 如何等待 Mac OS X 应用程序完全激活

> ID：13070605
> 
> 赞同：2
> 
> 时间：2012-10-25T14:15:31.333
> 
> 标签：macos, cocoa, macos-carbon

我的应用程序是一个调试器，当用户在他们的代码中从一行到另一行时，我需要经常在目标应用程序和我的调试器应用程序之间切换活动进程。我目前正在使用`SetFrontProcessWithOptions(…, kSetFrontProcessFrontWindowOnly)`调用来完成此操作。

我遇到的问题是`SetFrontProcessWithOptions()`调用在应用程序完全激活之前返回。 `SetFrontProcessWithOptions()`当进程成为活动进程时返回，但在其主窗口前移并激活之前。如果我再次调用 SetFrontProcess 太快而无法重新激活我的调试器应用程序，Mac OS X 会变得混乱，并且窗口的分层会变得混乱。从视觉上看，错误的窗口似乎处于活动状态，并且键盘和菜单焦点指向了看似非活动的窗口。

我`GetFrontProcess()`在调用`SetFrontProcessWithOptions()`轮询后尝试使用，但即使该进程的窗口尚未完全激活，也会`GetFrontProcess()`立即返回我的代码已激活的 PSN 。`SetFrontProcessWithOptions()`

有谁知道一种方法来确定应用程序何时完全激活，其主窗口准备好接收键盘输入？

# linux - 将USB连接到linux emb设备时如何打开localhost

> ID：13070608
> 
> 赞同：3
> 
> 时间：2012-10-25T14:15:38.417
> 
> 标签：linux, web, embedded, usb, arm

我目前正在编写一个arm嵌入式设备。目前我已经安装了 thttpd，并且我在设备上运行了一个 Web 服务器。我们使用以太网连接进行了检查，一切正常。该网页控制运行一些 sh ​​脚本的系统，该脚本执行通过 pmpp 与最终系统通信的 c++ 程序。

该设备有一个usb端口，我们计划用它来连接android/ios/bb设备（手机或平板电脑）并打开相同的网页，例如通过192.168.0.222。

假设我是一名工人，我有我的公司智能手机，我想修改产品的一些值，所以我只需插入 USB，我使用 safari/chrome 或我决定使用的任何导航器访问，更改值并回家下午剩下的时间和我的家人一起度过。

我们不想做的是开发一个应用程序来从设备检索网页以绘制它们，如果我们之前创建了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:44:44.233

如果您我正确理解了这个问题，那么您有几个基本的架构问题需要解决——也就是说，您希望通过与移动设备的直接 USB 连接建立以太网连接，以便移动设备可以在您的嵌入式系统上使用 Web 服务.

1) *USB 角色*：其中一台设备需要有一个 USB 主机控制器，并充当主机。碰巧的是，手机在其 USB 端口上支持 USB-OTG - 您会希望让它们进入主机模式（适用于带有微型 USB 连接器的手机的电缆， 适用于 iOS 设备的[USB 相机连接套件）。](http://store.apple.com/uk/product/MC531ZM/A/apple-ipad-camera-connection-kit)

2) *USB 设备角色*：您的嵌入式设备需要为主机实现适当的端点进行通信。[一种选择是来自Linux Gadget Framework](http://www.linux-usb.org/gadget/)的 CDC 以太网。如果您的设备具有功能性 USB 设备堆栈并支持小工具框架，那么这应该是更改内核配置和重新编译的情况。或者，您编写一个驱动程序来欺骗现有的 USB 以太网加密狗的 API。

3) *USB 主机驱动程序*：您需要在主机上安装相应的 USB 驱动程序。这就是一切开始崩溃的地方。这些手机都不可能附带这些。在 Android 上，您理论上可以根手机，然后侧载额外的驱动程序。在 iOS 上，您需要加入[Made For iPnone](https://developer.apple.com/programs/mfi/)计划才能开始考虑这一点。甚至加入该计划的成本也包含在 NDA 中，并且仅适用于批量 OEM。我想黑莓也被很好地锁定了。

或者，一种更有可能奏效的方法是将 USB 以太网（成本：约 15 美元）或 Wifi 加密狗（以太网要容易得多）连接到嵌入式设备的 USB 主机端口，然后将该接口连接到您的办公网络。

在实现这一点的嵌入式方面，任何能够 CGI 的网络服务器都是一种快速而肮脏的方式来完成这项工作。

# ios - 自定义MKAnnotationView，如何在阴影触摸时防止选择

> ID：13070609
> 
> 赞同：2
> 
> 时间：2012-10-25T14:15:38.370
> 
> 标签：ios, mkmapview, mkannotation, mkannotationview

我有一个带有一些自定义 MKAnnotation、MKAnnotationView 的 MapView，我用它来创建漂亮的自定义标注。无论如何，对于我的主要注释图钉，我使用了一些漂亮的图钉图像，它们的左侧有一个预渲染的阴影。

但是，我希望当用户触摸它的阴影时不要选择注释。因为当他们很多时，一个人的影子可能会与另一个人重叠，而错误的人会因为影子被触摸而被选中。

我试图为阴影使用单独的图像并将其放在 MKAnnotationView 内的 UIImageView 中，但它不会改变任何东西，即使我设置 enableUserInteraction = NO。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:56:30.453

使您的 MKAnnotationView 成为不包括阴影的图像大小。更改它的框架，使其包含您希望它接收触摸的部分。阴影应该超过这个框架，但不应该被切断。

# c3p0 - 为什么 c3p0 中的 numUnclosedOrphanedConnections 会增加？

> ID：13070616
> 
> 赞同：3
> 
> 时间：2012-10-25T14:16:01.113
> 
> 标签：c3p0

我正在使用 c3p0 (0.9.1.2) 版本，大约一个小时后，我看到每小时`numUnclosedOrphanedConnections`增加 1 个。c3p0 文档说

> numUnclosedOrphanedConnections 仅在调用 softReset() 后才会为非零值。它表示发生软重置时签出的连接数，因此从池中静默排除，并且客户端应用程序保持未关闭的连接数。

为什么 c3p0 做软复位？我的 c3p0 设置就像

```
initialPoolSize=1
minPoolSize=1
maxPoolSize=100
maxIdleTime=60
checkoutTimeout=5000
testConnectionOnCheckin=true 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T14:54:24.720

感谢史蒂夫帮助我修复它。我就是这样做的。

为 c3po 启用调试级别日志记录：

```
<logger name="com.mchange" additivity="false">
<level value="DEBUG" />
    <appender-ref ref="C3p0Appender" />          
</logger> 
```

c3p0 设置：

```
debugUnreturnedConnectionStackTraces=true
# 30 sec is enough for me but you should change it for your case
unreturnedConnectionTimeout=30 
```

在c3p0日志文件中搜索的关键字是：“过期资源签出”

此日志记录仅在 c3p0 的中继版本中启用。它应该在 pre6 版本中。

# android - Android 存储最近 10 个搜索值

> ID：13070617
> 
> 赞同：1
> 
> 时间：2012-10-25T14:16:02.583
> 
> 标签：android, sharedpreferences

我有一个在数据库中搜索的应用程序。我想存储最后 10 个搜索值（即使用户关闭应用程序，我希望它们保留）以将它们用作 AutoCompleteTextView 中的适配器。

SharedPreferences 似乎不支持数组或数组列表。这里最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:32:39.647

您可以使用 a 中的表`SQLiteDatabase`来存储搜索历史记录，并使用标准 SQL API 来访问它。

或者，您可以使用XML、JSON、YAML、CSV、纯文本或任何您喜欢的[文件来保存历史记录。](http://developer.android.com/reference/android/content/Context.html#openFileOutput%28java.lang.String,%20int%29)优点是简单和（也许）性能。缺点是您必须自己序列化和反序列化（一种可能的变体是直接序列化 Java 对象）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:30:10.760

SharedPreferences 支持 boolean int、float、long 和 String。

但是 ArrayList 是可序列化的，因此如果您还声明对象可序列化，则可以使用 ObjectOutputStream 将它们编码为 ByteBuffer，然后将此 byteBuffer 转换为字符串，最后将其存储到 SharedPreferences 中，或者更好地存储到二进制文件（作为 bytebuffer ）。

在你的情况下，你只需要保存字符串，它更容易遍历数组的每个元素并将它们保存为“arrayName”+index，最后保存数组的大小。

# javascript - 在 .NET 中解码 http 链接

> ID：13070623
> 
> 赞同：0
> 
> 时间：2012-10-25T14:16:27.220
> 
> 标签：javascript, .net, html, decoding

我正在从我的 javascript 打开一个页面并将变量传递给它，如下所示

```
 <script type="text/javascript">
        function myFunction(what) {
            var valu = what.value;
            var w = window.open("playaudio.aspx?" + what.value);

            return false;
        } 
```

现在在我的 playaudio.aspx 上，我这样做是为了将 %2f 和 %3f 等解码回 / 和 ?

```
string FilePath = HttpUtility.HtmlDecode(Request.QueryString.ToString()); 
```

但问题是字符串 FilePath 保持不变。关于如何将 %2f 更改为 / 的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:17:37.527

这是因为 URL 不是 HTML 编码的。

你需要`UrlDecode`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:19:13.160

请参阅[HttpUtility.UrlDecode](http://msdn.microsoft.com/en-us/library/system.web.httputility.urldecode.aspx) - 我相信这就是您所追求的。

# visual-c++ - 保留任务栏图标，替换 MFC 对话框

> ID：13070626
> 
> 赞同：1
> 
> 时间：2012-10-25T14:16:36.637
> 
> 标签：visual-c++, mfc, taskbar

我有一个基于 MFC 对话框的应用程序。用户可以更改对话框的语言，我通过关闭现有对话框并打开另一个更改了语言的对话框来做到这一点。问题是任务栏中的效果是删除了一个图标，并在其位置创建了另一个相同的图标。如果我的应用程序的图标不是任务栏中的最后一个图标，它将被视为移动到任务栏图标集的末尾。

我想保留图标在任务栏中的位置，而不是完全防止图标闪烁。我怎么做？

该应用程序必须支持从 Windows XP 到 Windows 7 的操作系统。

编辑：我会接受答案的替代问题是如何创建一个仍然显示在任务栏中的不可见窗口，以及如何将相关窗口消息从该窗口转发到我的主窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T18:48:54.307

使对话框成为另一个外部父窗口的子窗口。父级可以是对话框或任何其他类型的窗口；它将提供的只是标题栏。如果用户试图调整它的大小，它必须将调整大小的命令转发给对话框，否则你不需要在父窗口中做太多事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T05:01:27.627

为什么不用 CFormView 替换对话框呢？这样就有一个围绕对话框（嵌入在表单视图中）的框架窗口，并且它是拥有任务栏图标的框架窗口。

创建一个显示 CFormView 的 SDI 应用程序。在初始化时以默认语言（或用户之前选择的任何语言）显示对话框。当用户选择“更改语言”选项时，只需将正在显示的表单视图更改为新的。

额外功能：通过这种设计，框架将为您处理诸如特定语言的加速器和菜单之类的事情，而您无需付出任何努力。

有关如何执行此操作的更多信息，请查看[http://www.codeguru.com/cpp/wd/doc_view/viewmanagement/article.php/c3341/Multiple-Views-Using-SDI.htm](http://www.codeguru.com/cpp/w-d/doc_view/viewmanagement/article.php/c3341/Multiple-Views-Using-SDI.htm)

# html - Firefox 正文页边距错误？

> ID：13070630
> 
> 赞同：5
> 
> 时间：2012-10-25T14:17:08.837
> 
> 标签：html, css, firefox, margin

我有这个简单的例子：

```
<header>
    <ul>
        <li>Item</li>
        <li>Item</li>
        <li>Item</li>
        <li>Item</li>
        <li class="clear"></li>
    </ul>
</header>
<section>section</section> 
```

而这段CSS：

```
BODY, HTML{
    margin: 0;
}
header{
    margin-bottom: 100px; /* section goes down */
}
UL{
    list-style-type: none;
}
UL LI{
    float: left;
    background: green;
}
.clear{
    clear: both;
    float: none;
}
section{
    background: red;
} 
```

所以我希望“标题”直接到左上角，然后是 100px 边距，然后是“部分”。在所有按预期工作的主要浏览器中，但在 Firefox（版本 16）中，“标题”由于某种原因获得了额外的 margin-top。

这是一个错误吗？

这是一个 jsfiddle 示例：http: [//jsfiddle.net/AvZek/2/](http://jsfiddle.net/AvZek/2/)

顺便说一句，如果我使用 clearfix 而不是“clear”类，那么它工作得很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:53:09.837

毫无疑问，这是一个错误。保证金绝对不应该在那里。

*   根据 Firebug 的说法，我可以看到计算的唯一非零边距`margin-bottom: 100px`在您的`header`元素上与在您的 CSS 中相同。其他一切都是零。

*   甚至 Firebug 的 DOM 检查器也难以识别它；它从不突出显示该区域，除非您在检查`html`自身时（它作为其内容区域的一部分突出显示）。

[我发现了大量的错误报告，这些错误报告作为这个](https://bugzilla.mozilla.org/show_bug.cgi?id=451791)报告的副本关闭，还有更多的测试用例。另外，它看起来至少从 Firefox 2 开始就已经存在了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T14:25:59.220

而不是用非语义和不必要的空`<li>`-s 污染您的代码，只需添加`overflow: hidden`到您的`<ul>`

***HTML***

```
<header>
    <ul>
        <li>Item</li>
        <li>Item</li>
        <li>Item</li>
        <li>Item</li>
    </ul>
</header>
<section>section</section> 
```

***CSS***

```
ul {
    list-style-type: none;
    overflow: hidden;
} 
```

[**演示**](http://jsfiddle.net/AvZek/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:23:18.550

您可以使用`{padding-bottom:100px;}`而不是保证金来实现这一点..

# c# - 组合框数据源不创建项目

> ID：13070634
> 
> 赞同：3
> 
> 时间：2012-10-25T14:17:22.940
> 
> 标签：c#, visual-studio-2010, combobox, datasource, bindinglist

经过大量搜索，我仍然没有找到解决此问题的方法。

我在*VS 2010*中创建了一个列表并将其绑定到`ComboBox`. 该`DataSource`属性显示整个列表，但表单上的组合框为空，框的 items 属性也是如此。

```
 private List<string> classes = new List<string>();
    private BindingList<string> bindingClasses;

        classes.Add("Spinning");
        classes.Add("Step");
        classes.Add("Pilates");
        classes.Add("Kickboxing");
        classes.Add("Body Sculpting");

        bindingClasses = new BindingList<string>(classes);
        classesComboBox.DataSource = bindingClasses; 
```

我也尝试过添加

`classesComboBox.DisplayMember = "Spinning";`

并且没有之间的 bindingList 无济于事。

为什么这不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:25:03.490

丢失 BindingList，只需将 DataSource 设置为 List<String> 本身。

```
List<string> classes = new List<string>();
classes.Add("Spinning");
classes.Add("Step");
classes.Add("Pilates");
classes.Add("Kickboxing");
classes.Add("Body Sculpting");

classesComboBox.DataSource = classes;
classesComboBox.SelectedItem = "Spinning"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:20:43.547

```
classesComboBox.DataBind(); 
```

您需要指定何时应该获取数据。

# performance - 优化向量化 Matlab 函数

> ID：13070637
> 
> 赞同：2
> 
> 时间：2012-10-25T14:17:31.473
> 
> 标签：performance, matlab, optimization, vectorization, mex

当我运行分析器时，它告诉我最耗时的代码是函数`vdist`。它是一个程序，可以测量地球上两点之间的距离，将地球视为椭球体。代码看起来很标准，我不知道在哪里以及如何改进它。最初的评论说，它已经被矢量化了。是否有其他语言的对应物可以用作 MEX 文件。我想要的只是时间效率方面的改进。这是 Matlab FEX 代码的链接。

[http://www.mathworks.com/matlabcentral/fileexchange/8607-vectorized-geodetic-distance-and-azimuth-on-the-wgs84-earth-ellipsoid/content/vdist.m](http://www.mathworks.com/matlabcentral/fileexchange/8607-vectorized-geodetic-distance-and-azimuth-on-the-wgs84-earth-ellipsoid/content/vdist.m)

该函数是从循环中调用的 - （您可以在此处找到该函数作为其最耗时的行）

```
 109 for i=1:polySize 
              110    % find the two vectors needed
       11755  111    if i~=1 
0.02   11503  112        if i<polySize 
0.02   11251  113         p0=Polygon(i,:); p1=Polygon(i-1,:); p2=Polygon(i+1,:);    
         252  114        else 
         252  115         p0=Polygon(i,:); p1=Polygon(i-1,:); p2=Polygon(1,:); %special case for i=polySize 
         252  116        end 
         252  117    else 
         252  118         p0=Polygon(i,:); p1=Polygon(polySize,:); p2=Polygon(i+1,:); %special case for i=1 
         252  119    end 
 0.02  11755  120    Vector1=(p0-p1); Vector2=(p0-p2); 
 0.06  11755  121    if ~(isequal(Vector1,Vector2) || isequal(Vector1,ZeroVec) || isequal(Vector2,ZeroVec)); 
              122        %determine normals and normalise and
 0.17  11755  123        NV1=rotateVector(Vector1, pi./2); NV2=rotateVector(Vector2, -pi./2); 
 0.21  11755  124        NormV1=normaliseVector(NV1); NormV2=normaliseVector(NV2); 
              125        %determine rotation by means of the atan2 (because sign matters!)
       11755  126        totalRotation = vectorAngle(NormV2, NormV1); % Bestimme den Winkel totalRotation zwischen den normierten Vektoren 
       11755  127      if totalRotation<10 
       11755  128          totalRotation=totalRotation*50; 
       11755  129      end 
0.01   11755  130      for res=1:6 
0.07   70530  131         U_neu=p0+NV1; 
17.01  70530  132         [pos,a12] = vdist(p0(:,2),p0(:,1),U_neu(:,2),U_neu(:,1)); 
0.02   70530  133         a12=a12+1/6.*res*totalRotation; 
       70530  134         ddist=1852*safety_distance; 
4.88   70530  135         [lat2,lon2] = vreckon(p0(:,2),p0(:,1),ddist, a12); 
0.15   70530  136         extendedPoly(f,:)=[lon2,lat2];f=f+1; 
< 0.01 70530  137      end 
       11755  138    end 
       11755  139 end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T09:38:29.460

无论我多么努力地研究已发布的代码，我都看不出为什么`vdist`在循环内进行调用。

当我试图优化循环内的代码块时，我寻找的一件事是不变的语句，即在每次调用时都是相同的，因此可以从循环中取出。

看着

```
130      for res=1:6 
131         U_neu=p0+NV1; 
132         [pos,a12] = vdist(p0(:,2),p0(:,1),U_neu(:,2),U_neu(:,1)); 
133         a12=a12+1/6.*res*totalRotation; 
134         ddist=1852*safety_distance; 
135         [lat2,lon2] = vreckon(p0(:,2),p0(:,1),ddist, a12); 
136         extendedPoly(f,:)=[lon2,lat2];f=f+1; 
137      end 
```

我懂了

*   在 l131 中的 variables `p0`，`NV1`只出现在 rhs 上，而且它们只出现在循环内其他地方的 rhs 上，所以这个语句是循环不变的，可以从循环中取出；也许只节省一点时间；
*   再次在 l134 中，我看到另一个循环不变语句，可以再次将其从循环中取出，以节省一点时间；
*   但后来我开始仔细观察，我看不出为什么调用到`vdist`的 l132 也在循环内。该分配的 rhs 上的任何值都没有在循环中被修改（除了`U_neu`但我已经将它提升到循环之外）。

整理了一下剩下的东西，这就是我最终得到的：

```
U_neu=p0+NV1; 
[pos,a12] = vdist(p0(:,2),p0(:,1),U_neu(:,2),U_neu(:,1)); 
ddist=1852*safety_distance; 
for res=1:6 
   extendedPoly(f,:) = vreckon(p0(:,2),p0(:,1),ddist, a12+1/6.*res*totalRotation); 
   f=f+1; 
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:42:31.730

一个选项是以您能够在 GPU 上使用它的方式重写此 FEX 文件。例如，一个平滑的方法是一个名为[Jacket](http://www.accelereyes.com/jacket_tour?idx=2)的工具箱。

# ruby-on-rails - 无法正确检索查找值

> ID：13070638
> 
> 赞同：1
> 
> 时间：2012-10-25T14:17:31.817
> 
> 标签：ruby-on-rails, lookup, polymorphic-associations

我在我的 Rails 应用程序中构建了一个查找表。

它是一个存储下拉选择器或可能的复选框的查找文本值的表。我希望查找表具有关联的视图，以便可以轻松编辑值。将来我可能还想在单个字段的多个模型之间共享查找值。

到目前为止，我已经设法让它用于选择值，但是在显示或索引视图上再次显示文本值是有问题的。

这就是我构建查找表的方式

```
rails g scaffold Lookup field_name lookup_text table_name note 
```

在对字段进行查找的 edit.html.erb 中，我有这样的代码，它可以工作并允许我从列表中进行选择。

```
<div class="field">
    <%= f.label :status %><br />
    <%= f.collection_select :status, Lookup.find(:all,:conditions => ["table_name = 'course' and field_name = 'status'"]), :id, :lookup_text, include_blank: true,:prompt => "Status" %>
</div> 
```

这一切都很好。当我尝试将其显示回来时，我找不到正确的语法。我发现的最好的是：（在控制器中）

```
@status = Lookup.where(:id => @course.status).pluck(:lookup_text) 
```

（在视图中）

```
<p>
  <b>Status:</b>
  <%= @status %>
</p> 
```

我想我得到了整个对象。它显示如下：

**状态：[“活动”]**

我的问题是：（1）我如何只显示值？（2）这是最好的方法吗？

我已经查看了这些和其他 SO 问题，但没有一个是我真正想要的：

[带有查找表的 Rails 多态](https://stackoverflow.com/questions/4927739/rails-polymorphic-with-lookup-table)

[在 Rails 中实现查找表](https://stackoverflow.com/questions/4828568/implementing-a-lookup-table-in-rails)

***编辑*** 好的，这可行，但看起来它不是正确的解决方案。有没有人有更好的方法来做到这一点？

```
@status = Lookup.where(:id => @course.status).pluck(:lookup_text)[0] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:11:04.740

显示价值的另一种方式是`@status = Lookup.find(@course.status).lookup_text`

为什么不尝试使用类进行不同的查找：

```
class CourseStatus < ActiveRecord::Base
  set_table_name "lookups"
  default_scope where("table_name = 'course' and field_name = 'status'")
end

class Course
  belongs_to :course_status
end 
```

然后你可以使用：

```
CourseStatus.all # e.g. to fill select options
Course.first.course_status.lookup_text # => "Active" or smth else 
```

* * *

或没有课程：

```
class Lookup
  def self._by_table_and_field(table, field)
    ['table_name = ? and field_name = ?', table, field]
  end

  scope :by_table_and_field, lambda { |table, field| 
    where(Lookup._by_table_and_field(table, field))
  }
end

class Course
  belongs_to :status, class_name: 'Lookup', conditions: Lookup._by_table_and_field('course', 'status')
end

Lookup.by_table_and_field('course', 'status').all
Course.first.status.lookup_text 
```

# jquery - 如何将 caroufredsel 与 fancybox 同步

> ID：13070641
> 
> 赞同：1
> 
> 时间：2012-10-25T14:17:34.063
> 
> 标签：jquery, fancybox, caroufredsel

我想将 caroufredsel 轮播与 fancybox 链接图像之间的用户操作同步。那里有任何教程或提示吗？我找不到任何关于我应该如何做到这一点的信息。

单击打开的花式框上的下一个按钮应该会触发课程或应该更改轮播上的可见图片。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:19:08.850

我知道几个月前有人问过这个问题，但是如果您有兴趣将 Fancybox 与 CarouFredSel 一起使用，请查看以下链接：[http](http://caroufredsel.dev7studios.com/examples/carousel-lightbox-tooltip.php) ://caroufredsel.dev7studios.com/examples/carousel-lightbox-tooltip.php 。

* CarouFredSel 官方网站在此页面上有一些示例，Fancybox 就是其中之一 :-)

希望这可以帮助！

乔什

# shell - 在 Unix 中合并文本文件中的行？

> ID：13070645
> 
> 赞同：5
> 
> 时间：2012-10-25T14:17:45.967
> 
> 标签：shell, unix

我有一个文件输出以下形式的行：

```
$XYZ blah blah blah
$XYZ something
$XYZ random data 
```

“$XYZ”前缀对于每一行都是相同的，它确实以美元符号开头，而且除了一行的开头之外，它几乎不可能出现在任何地方。

我可以获取此文件的唯一方法是通过屏幕截图，这会导致行以 80 个字符换行。所以它看起来像下面这样（如果你假设 wrapping 的数字小于 80）：

```
$XYZ blah bl
ah blah
$XYZ somethi
ng
$XYZ random 
data 
```

我想从中重新创建真实的线条。我可以编写一个程序来执行此操作，但我认为可能有一些我不熟悉的 Unix 命令可能会使它变得容易。有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:25:28.127

首先，将所有行合并为一个长行，然后在您看到应该是行首的单词的任何地方添加一个换行符，如下所示：

```
tr -d '\n' < file | sed 's/XYZ/\nXYZ/g' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:23:23.403

在`perl`：

```
perl -pe 's/\n//g;s/XYZ\s+/\n$&/g' filename.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T16:43:02.747

该[`paste`](http://man.cx/paste)命令正是为了这个目的：

```
paste -d "" - - 
```

如在

```
echo '$XYZ blah bl
ah blah
$XYZ somethi
ng
$XYZ random 
data' | paste -d "" - - 
```

输出

```
$XYZ blah blah blah
$XYZ something
$XYZ random data 
```

# apache-flex - flex mobile：在 ipado 上的 textInput 组件上裁剪删除图标

> ID：13070646
> 
> 赞同：0
> 
> 时间：2012-10-25T14:17:53.393
> 
> 标签：apache-flex, flex4.5, flex-mobile

这是我用于 textInput 的 CSS

```
s|TextInput{
    skinClass: ClassReference("spark.skins.mobile.TextInputSkin");
    contentBackgroundColor:#FFFFFF;
    focusAlpha:0;
    showPromptWhenFocused:false;
} 
```

我使用简单：

```
 <s:TextInput id="id1" />
    <s:TextInput id="id1" height="40" />
    <s:TextInput id="id1" height="60 /> 
```

在 iphone/ipad 上：关闭图标出现顶部裁剪： ![在此处输入图像描述](../Images/226bbcd6eb5e476fc44218041670aa77.png)

知道如何解决吗？（甚至如何删除那个 X 图标）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:11:13.530

图标是一个设定的高度，至少在 Flex 中，不会调整它的大小。裁剪来自文本字段的高度（阅读：*不是*TextInput 组件，而是文本进入的实际字段）。因为该字段没有图标那么高，所以图标会被裁剪。

有两种解决方案：

1.  显而易见的是增加 TextInput 字段的高度，直到该图标不再被裁剪。如果需要，您可以截取屏幕截图并测量被裁剪的像素。
2.  你得到那个图标是因为 TextInput 使用 StageText。StageText 使用本机文本呈现，而不是 Flash 文本呈现。在理想情况下，StageText 是完美的。然而，情况很少是理想的。要解决这个问题，您只需将移动 TextInput 外观应用`skinClass="spark.skins.mobile.TextInputSkin"`到您的 TextInput 组件。正如[www.Flextras.com 昨天向我指出的那样](https://stackoverflow.com/questions/13048099/flex-mobile-textinput-does-not-clear-prompt-on-focus/13053170#13053170)，这会将 TextInput 恢复为 Flex 4.6 之前的行为，后者引入了 StageText。

这些解决方案中的任何一个都应该适合您。你只需要选择最好的。我更喜欢选项 #2，因为正如我所提到的，StageText 还存在其他问题（例如让 displayAsPassword 正常工作）切换到该皮肤修复

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T08:01:12.253

我会尝试编辑皮肤，因为那是图标裁剪发生的地方

# cxf - 骆驼路线，如何使用端点作为触发器，返回立即响应但继续该过程？

> ID：13070650
> 
> 赞同：2
> 
> 时间：2012-10-25T14:18:02.150
> 
> 标签：cxf, apache-camel, routes, multicast, endpoint

我想用 Camel 来实现一种触发 EIP。

我想要的是：我有一个 Web 服务，它将充当骆驼路线端点。此服务接收请求，如果请求格式正确，它必须并行执行两件事：使用简单消息“OK”或“ACK”向原始发送者返回响应，或者在请求格式不正确的情况下响应将是“NOK”或“RPT”（要求重复该消息）。然后同时，如果消息格式正确，则必须将其发送到另一个 Web 服务，该服务将用一些信息丰富原始消息并发送结果消息（或 Exchange，我不确定这里的正确术语) 到 JMS 实现。

我的端点充当流程的触发器，但必须立即向调用者返回响应。

所以我的问题是，我可以使用什么组件来做到这一点？我正在使用 Spring DSL 实现路由。我开始使用：

```
<route>
  <from uri="cxf:bean:clientEventEip?dataFormat=MESSAGE"/>
  <multicast>
    <to uri="bean:messageResponse"/><!-- checks the message and returns 'OK' -->
    <to uri="bean:messageEnricher"/><!-- Enriches and sends msg to another WS -->
  </multicast>
</route> 
```

但我在客户端收到错误响应：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <soap:Fault>
         <faultcode>soap:Server</faultcode>
         <faultstring>Exception occurred during execution on the exchange: Exchange[Message: [Body is instance of java.io.InputStream]]</faultstring>
      </soap:Fault>
   </soap:Body>
</soap:Envelope> 
```

并且在 IDE 中有很多异常，例如：

```
org.apache.camel.CamelExecutionException 
```

和

```
 org.apache.camel.InvalidPayloadException: No body available of type: org.w3c.dom.Document but has value: org.apache.cxf.transport.http.AbstractHTTPDestination$1@b8c6fb of type: null on: Message: [Body is instance of java.io.InputStream]. Caused by: Error during type conversion from type: null to the required type: org.w3c.dom.Document with value org.apache.cxf.transport.http.AbstractHTTPDestination$1@b8c6fb due org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.. Exchange[Message: [Body is instance of java.io.InputStream]]. Caused by: [org.apache.camel.TypeConversionException - Error during type conversion from type: null to the required type: org.w3c.dom.Document with value org.apache.cxf.transport.http.AbstractHTTPDestination$1@b8c6fb due org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.] 
```

如果我只是在我的骆驼路线中使用一种豆子一切顺利，那么响应就是我所期望的。

我确定这是我的错误，我一定是使用了错误的组件，但我仍然没有弄清楚如何解决这个问题，我感谢任何人能给我的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T04:23:27.560

您是否查看过 Camel 提供的 Wiretap 模式：

[http://camel.apache.org/wire-tap.html](http://camel.apache.org/wire-tap.html)

窃听本质上是获取您的交换副本并异步路由到不同的端点。上面的链接有更多详细信息。

您可以检查您的消息，如果没问题，您可以同时调用窃听端点和响应端点。像这样的东西：

```
<route>
  <from uri="cxf:bean:clientEventEip?dataFormat=MESSAGE"/>

    <wireTap uri="direct:tap"/>      

    <to uri="bean:messageResponse"/><!-- checks the message and returns 'OK' or 'NOK'-->

</route>

<route>
   <from uri="direct:enrichingRoute"/>
   <to uri="bean:messageEnricher"/><!-- Enriches and sends msg to another WS -->
</route> 
```

在调用窃听之前，您可能需要添加一个过滤器来检查错误，但我认为窃听 EIP 应该为您指明正确的方向。

干杯，约格什

# php - Magento - 致命错误：在第 816 行的 app/code/core/Mage/Eav/Model/Entity/Abstract.php 中的非对象上调用成员函数 getBackend()

> ID：13070652
> 
> 赞同：8
> 
> 时间：2012-10-25T14:18:11.463
> 
> 标签：php, magento, magento-1.7

尝试在自定义主题中使用自定义过滤器时出现此错误。

我已经在属性集中设置了新属性“is_featured”及其。我制作了一个将其指定为特色的产品（是/否选择）

我的主页（在 CMS 部分）包括以下“面板”

```
<block type="catalog/product" name="catalog.product_featured_list" template="catalog/product/featured_list.phtml" after="-"/> 
```

features_list.phtml 看起来像这样：

```
<?php
$storeId = Mage::app()->getStore()->getId();
$_productCollection=Mage::getResourceModel('reports/product_collection')
        ->addAttributeToSelect(array('name', 'url', 'small_image', 'price', 'short_description'))
        ->addAttributeToFilter('is_featured', 1)
        ->addAttributeToFilter('status', 1)
        ->setPageSize(3)
        ->setStoreId($storeId)
        ->addStoreFilter($storeId);
$_helper = $this->helper('catalog/output');
?>
<?php if($_productCollection->count()): ?>

<section class="content-box clearfix">
    <header>
        <h2>Featured products</h2>
    </header>
    <ul class="featured-products">
            <?php foreach ($_productCollection as $_product): ?>
            <?php $_productNameStripped = $this->stripTags($_product->getName(), null, true); ?>
            <li>
                <h3>
                    <a href="<?php echo $_product->getProductUrl(); ?>" title="<?php echo $_productNameStripped; ?>">
                        <?php echo $_helper->productAttribute($_product, $_product->getName() , 'name'); ?>
                    </a>
                </h3>
                <a href="<?php echo $_product->getProductUrl(); ?>" title="<?php echo $_productNameStripped; ?>">
                    <img src="<?php echo $this->helper('catalog/image')->init($_product, 'small_image')->resize(212); ?>" width="200" height="200" alt="<?php echo $this->stripTags($this->getImageLabel($_product, 'small_image'), null, true) ?>" />
                </a>
                    <div>
                        <ul class="clearfix">
                            <li>From &pound;<?php echo number_format($_product->price, 2) ?></li>
                            <li>
                                <?php
                                $desct = nl2br($this->htmlEscape($_product->getShortDescription()));
                                $desct = strip_tags($_product->getShortDescription());
                                ?>
                                <p>
                                    <?
                                    echo Mage::helper('core/string')->truncate($desct, '100');
                                    ?>
                                    <a href="<?php echo $_product->getProductUrl(); ?>" title="<?php echo $_productNameStripped; ?>">
                                        <?php echo $this->__('more details'); ?>
                                    </a>
                                </p>
                            </li>
                            <li>
                                <form action="<?php echo $this->helper('checkout/cart')->getAddUrl($_product); //echo $this->getAddToCartUrl($_product); ?>" class="product-list-add-to-cart" method="get" id="product_addtocart_form_<?php echo $_product->getId()?>"<?php if($_product->getOptions()): ?> enctype="multipart/form-data"<?php endif; ?>>
                                    <?php if(!$_product->isGrouped()): ?>
                                    <label for="qty"><?php echo $this->__('Qty') ?>:</label>
                                    <input type="text" class="input-text qty" name="qty" id="qty" maxlength="12" value="<?php echo ($this->getMinimalQty($_product)?$this->getMinimalQty($_product):1) ?>" />
                                    <input type="hidden" name="product" value="<?php echo $_product->getId()?>" />
                                    <?php endif; ?>
                                    <button type="button" class="button" onclick="this.form.submit()"><span><span><?php echo $this->__('Add to Cart') ?></span></span></button>
                                </form>
                            </li>
                        </ul>
                    </div>
            </li>
        <?php endforeach; ?>
    </ul>
</section>
<?php endif; ?> 
```

似乎问题出在块开头的集合上。（我可以从主页中删除此面板，并且网站加载正常）

我很确定我有所有提到的属性（is_featured 看起来是唯一的自定义属性）

（这个主题是继承的，所以我不是 100% 精通它是如何工作的！我只是在复制它）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-24T00:02:17.750

我目前使用的是 1.7，每当我收到“在非对象上调用成员函数 getBackend()...”错误时，通常是由于调用了错误的模型，或者将过滤器应用于某个属性该集合中不存在。

在测试您的代码后，如果我注释掉这一行，它就可以正常工作（主要是......）：

```
->addAttributeToFilter('is_featured', 1) 
```

我的建议是仔细检查产品属性 id 是否存在于您当前的安装中，并将其设置为正确的范围（全局/正确存储？）。

如果它确实存在，另一种解决方案是手动选择特色产品，您可能想尝试使用：

```
Mage::getModel('catalog/product')->getCollection()
    ->addAttributeToSelect(array('name', 'url', 'small_image', 'price', 'short_description'))
    ->addFieldToFilter('is_featured', 1)
    ->addFieldToFilter('status', 1)
    ->addStoreFilter($storeId)
    ->clear()->setPageSize(3)->load(); //setPageSize = How Many Products To Show 
```

看看能不能解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-12T12:17:19.957

就我而言，它有助于注释掉这一行（第 765 行）

```
$customer->changeResetPasswordLinkCustomerId($newResetPasswordLinkCustomerId); 
```

在

*/app/code/core/Mage/Customer/controllers/AccountController.php*

我认为检查天气更新脚本是否正确更新了您的数据库也很重要。fe *upgrade-1.6.2.0.6-1.6.2.0.7.php* 创建一个表叫`rp_customer_id`

# safari - 内联 SVG 渐变在 Opera 中变为黑色

> ID：13070657
> 
> 赞同：3
> 
> 时间：2012-10-25T14:18:31.970
> 
> 标签：safari, svg, extjs4, opera, gradient

我有一个类似的问题，并根据该问题准备了一个示例[：](https://stackoverflow.com/questions/11303740/svg-linear-gradient-doesnt-work-in-safari/11310511#11310511)

[http://jsfiddle.net/kxhyv/](http://jsfiddle.net/kxhyv/)

除 Safari 和 Opera 外，每个浏览器都能很好地处理这个问题。在 Opera 中，如果您首先单击“运行”，则 SVG 将呈现为黑盒。单击“更新”后，SVG 将正确呈现。在我们的应用程序中，我们在 ExtJS 4.1.1 中使用它直接设置面板的 html 代码

```
html = '<svg id="foo" > .... </svg>';
this.update(html); 
```

其中 html 只是包含 svg 的字符串。

它工作正常，除了两个浏览器中的渐变给我一个黑色的形状。由于各种原因（事件处理、ID 操作等），它必须是内联 SVG 才能让事件侦听器运行：

```
listeners : {

    click : {
        element : 'el',
        fn : function(a, b, c, d) {
            var svgElement = b;
[...] 
```

我现在完全没有想法，非常感谢所有建议。

# ruby-on-rails - Rails 范围内的第一个或限制

> ID：13070658
> 
> 赞同：7
> 
> 时间：2012-10-25T14:18:37.190
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有以下范围：

```
scope :user_reviews, lambda { |user| where(:user_id => user) } 
```

我在控制器中应用它：

```
def show
  @review = @reviewable.reviews.user_reviews(current_user).first || Review.new
end 
```

这`first`是为了限制搜索当前用户的唯一评论。现在我尝试编写一个新的范围`user_review`，我尝试了很多方法来链接`user_reviews`范围`first`，但就是无法得到它。像这样的东西：

```
scope :user_reviews, lambda { |user| where(:user_id => user) }
scope :user_review, lambda { |user| user_reviews(user).first } 
```

我知道以上`user_review`是错误的，但只是想向你们展示我正在尝试做的事情。

我应该如何正确地写这个？

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-29T20:04:59.227

@Victor，坚持你原来的想法。使用`scope :user_reviews, lambda { |user| where(:user_id => user) }`和调用`user_reviews.first`。没有错。

绝对不要定义返回单个对象的范围。范围应该是可链接的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T16:01:48.440

我也用过这个：

```
 def self.user_review(user)
    self.user_reviews(user).first
  end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-16T07:10:01.330

```
 scope :user_reviews, ->(user) { where(user_id: :user) } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-06T17:19:28.997

我觉得这个用例很常见。

我们可以通过以下方式解决这个问题：

```
scope :user_reviews, lambda { | user_id | where(:user_id => user_id) } 
```

然后在模型中有`user_review`作为类方法

```
def self.user_review(user_id)
    user_reviews(user_id).first
end 
```

现在你可以打电话`user_review`了，它会返回一条记录。

# windows - Gitignore 无法正常工作

> ID：13070673
> 
> 赞同：0
> 
> 时间：2012-10-25T14:19:42.577
> 
> 标签：windows, git, ignore

我有以下目录结构

![在此处输入图像描述](../Images/71ae8ff4ad9fac4aafedf54640a64aa5.png)

这是 .gitignore 的内容

`conf.php`

问题是，当我更改内容 conf.php 并尝试提交某些内容时，GIT`conf.php`再次检测为更改的文件。事实上，它必须被忽略。
我犯过一次。我想从现在开始忽略它。我错过了什么？

# 更新

我试过以下：

1.  将 conf.php 添加到 gitignore

2.  从缓存中删除它`git rm --cached conf.php.`

    但是现在，当我重新扫描项目时，它想暂存`conf.php`为已删除。

![在此处输入图像描述](../Images/7d0f4030e75fc4e31b777bdc366fe83d.png)

它不是我想要的。

我想将其保留在远程仓库中并忽略本地仓库中未来（从现在开始）的更改。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:21:57.410

## Git 不会忽略跟踪的文件

Git 不会忽略对已提交文件的更改。

## Git忽略的目的是什么

Git 忽略，忽略存储库中的噪音，例如：

```
$ git init
$ mkdir tmp
$ touch tmp/file1
$ touch tmp/file2
$ git status
# On branch master
#   
# Initial commit
#   
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#   
#   tmp/
nothing added to commit but untracked files present (use "git add" to track) 
```

如果 .gitignore 文件被修改为忽略 tmp 目录：

```
$ echo "tmp" > .gitignore
$ git status
# On branch master
#   
# Initial commit
#   
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#   
#   .gitignore
nothing added to commit but untracked files present (use "git add" to track) 
```

tmp 目录内容不再列出 - 但 .gitignore 文件已列出（因为我刚刚创建了它并且文件本身没有被忽略）。

承诺，没有列出任何更改：

```
$ git add .gitignore
$ git commit -v -m "addding git ignore file"
[master (root-commit) d7af571] addding git ignore file
1 file changed, 1 insertion(+)
    create mode 100644 .gitignore
$ git status
# On branch master
    nothing to commit (working directory clean) 
```

现在对 .gitignore 文件的任何更改都将显示为挂起的更改，tmp 目录之外的任何新文件都将显示为未跟踪的文件，并且 tmp 目录内的任何更改都将被忽略。

## 不要提交您不想跟踪的文件

如果您已经将 conf.php 添加到您的 git 存储库，则 git 正在跟踪该文件。当它更改时，git**会**说它有待处理的更改。

解决此类问题的方法是不要提交您不想跟踪的文件。相反，您可以做的是提交默认文件，例如：

```
$ mv conf.php conf.php.default
$ # Edit conf.php.default to be in an appropriate state if necessary
$ git commit -v -m "moving conf.php file"
$ cp conf.php.default conf.php 
```

现在，您对 conf.php 所做的任何更改都不会显示为未分级更改。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-31T01:55:41.570

如果您想向项目添加一个空配置文件，然后不跟踪任何附加更改，那么您可以这样做：

1.  编辑 conf.php 使其处于您希望它保持的状态
2.  添加并提交 config.php

运行以下 git 命令：

```
git update-index --assume-unchanged conf.php 
```

**您将不再看到 conf.php 有待处理的更改**

要再次开始跟踪更改，请运行以下命令：

```
git update-index --no-assume-unchanged conf.php 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T14:21:59.567

赶紧跑`git rm --cached conf.php`

如果您有更多提交的文件要忽略：

`git rm -r --cached .`

`git add .`

* * *

然后提交并推送您的更改。

# java - 从 UUID 版本 1 获取 UNIX 时间戳

> ID：13070674
> 
> 赞同：8
> 
> 时间：2012-10-25T14:19:43.360
> 
> 标签：java, uuid, unix-timestamp

在我们的 Java 应用程序中，我们试图从 UUID[版本 1](https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_1_(date-time_and_MAC_address))中获取 UNIX 时间。但它没有给出正确的日期时间值。

```
long time = uuid.timestamp();
time = time / 10000L;   // Dividing by 10^4 as it's in 100 nanoseconds precision 
Calendar c = Calendar.getInstance();
c.setTimeInMillis(time);
c.getTime(); 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-25T14:27:02.830

从文档中`timestamp()`：

> 生成的时间戳从 UTC 1582 年 10 月 15 日午夜开始以 100 纳秒为单位进行测量。

所以你需要抵消它。例如：

```
Calendar uuidEpoch = Calendar.getInstance(TimeZone.getTimeZone("UTC"));
uuidEpoch.clear();
uuidEpoch.set(1582, 9, 15, 0, 0, 0); // 9 = October
long epochMillis = uuidEpoch.getTime().getTime();

long time = (uuid.timestamp() / 10000L) + epochMillis;
// Rest of code as before 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-27T18:56:07.993

如果您使用 datastax 驱动程序，它是：

UUIDs.unixTimestamp(uuid)

[http://www.datastax.com/drivers/java/2.0/com/datastax/driver/core/utils/UUIDs.html#unixTimestamp(java.util.UUID)](http://www.datastax.com/drivers/java/2.0/com/datastax/driver/core/utils/UUIDs.html#unixTimestamp%28java.util.UUID%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-17T11:36:05.493

就我而言，以下代码有效。

```
 final long NUM_100NS_INTERVALS_SINCE_UUID_EPOCH = 0x01b21dd213814000L;
    UUID uuid = UUID.fromString("6470d760-d93d-11e9-8b32-858313a776ba");
    long  time = (uuid.timestamp() - NUM_100NS_INTERVALS_SINCE_UUID_EPOCH) / 10000;
    // Rest of code as before 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-23T05:30:52.000

如何使用[uuid-creator](https://github.com/f4b6a3/uuid-creator)`UuidUtil`从UUID 中提取时间：

```
Instant instant = UuidUtil.getInstant(uuid);

long secs = instant.getEpochSecond(); // seconds since 1970-01-01
long msecs = instant.toEpochMilli(); // millis since 1970-01-01 
```

# arrays - 在 Perl 中将数组元素放入哈希数组中

> ID：13070681
> 
> 赞同：2
> 
> 时间：2012-10-25T14:20:05.343
> 
> 标签：arrays, perl, hash

只是为了我自己的教育，有什么巧妙的方法可以转换一些数组，以便每个数组都与哈希的键相关联，并且所有这些哈希最终都在一个数组中？

为了让事情更清楚一点，假设我有一些像这样的数组：

```
my @n = ( 1,    2,    3 );
my @f = ( 3.14, 1.21, 0.75 );
my @s = ( 'a',  'b',  'c' ); 
```

我想要一个看起来像这样的哈希数组：

```
my %h = ( number => 1, float => 3.14, string => 'a' ); 
```

简单的 C 风格迭代是一个明显的解决方案：

```
for ( my $i = 0; $i < @n; $i++ ) {
    my %h = ();
    $h{number} = $n[$i];
    $h{float}  = $f[$i];
    $h{string} = $s[$i];
    push @a, \%h;
} 
```

稍微多一点Perlish：

```
for (0..$#n) {
    push @c, { number => $n[$_], float => $f[$_], string => $s[$_] };
} 
```

或者，如果我想简洁而不关心破坏数组：

```
for (0..$#n) {
    push @a, { number => shift @n, float => shift @f, string => shift @s };
} 
```

并与`List::MoreUtils`：

```
use List::MoreUtils qw (each_array);
my $it = each_array @n, @f, @s;
while ( my ($n, $f, $s) = $it->() ) {
    push @a, { number => $n, float => $f, string => $s };
} 
```

因此，本着 TMTOWTDI 的精神，我还缺少哪些其他解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:37:33.523

`my @array = map { number => $n[$_], float => $f[$_], string => $s[$_] }, 0 .. $#n;`

我不是 Perl 人，只是一个建议:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:32:11.240

不是真的可读，使用切片：

```
@{ $d[$_] }{qw/number float string/} = ($n[$_], $f[$_], $s[$_]) for 0 .. $#n; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T17:31:51.160

这使用了一些实用程序[**`List::MoreUtils`**](http://search.cpan.org/perldoc?List%3a%3aMoreUtils)

*   [**`mesh`**](http://search.cpan.org/perldoc?List%3a%3aMoreUtils#mesh)整合数组列表
*   [**`part`**](http://search.cpan.org/perldoc?List%3a%3aMoreUtils#part)对数组进行分区

也[**`_POSINT`**](http://search.cpan.org/perldoc?Params%3a%3aUtil#_POSINT)从[**`Params::Util`**](http://search.cpan.org/perldoc?Params%3a%3aUtil)判断下一个参数是否为正整数。

```
use List::MoreUtils qw<mesh part>; # integrate and partition arrays
use Params::Util    qw<_POSINT>;   # test number positive

# accept size number if positive int, otherwise we will be returning pairs. 
sub by (@) { 
   my $num = &_POSINT ? shift : 2;
   my $i   = -1;
   return part { int( ++$i / $num ) } @_;
}

my @n      = qw< 1    2    3 >;
my @f      = qw< 3.14 1.21 0.75 >;
my @s      = qw< a    b    c >;
my @fields = qw<number float string>;

my @results = map { +{ mesh @fields, @$_ } } by 3 => mesh @n, @f, @s; 
```

当然，使用它，您可以像这样列出数据：

```
my @results 
    = map { +{ mesh @fields, @$_ } } 
      by 3 => qw< 1 3.14 a
                  2 1.21 b
                  3 0.75 c
                >
    ; 
```

并跳过第一个`mesh`。布局指示数据的结构（就像代码一样。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T16:59:08.403

该程序可以满足您的要求

```
use strict;
use warnings;

my @n = ( 1,    2,    3 );
my @f = ( 3.14, 1.21, 0.75 );
my @s = ( 'a',  'b',  'c' );

my @data;
for my $i (0 .. $#n) {
  @{$data[$i]}{ qw/ number float string / } = map $_->[$i], \(@n, @f, @s);
}

use Data::Dump;
dd \@data; 
```

**输出**

```
[
  { float => 3.14, number => 1, string => "a" },
  { float => 1.21, number => 2, string => "b" },
  { float => 0.75, number => 3, string => "c" },
] 
```

或者您可能更喜欢使用[`List::MoreUtils`](https://metacpan.org/module/List%3a%3aMoreUtils)库`each_array`函数的解决方案。该程序的输出与我上面之前的解决方案的输出相同。

```
use strict;
use warnings;

use List::MoreUtils 'each_array';

my @n = ( 1,    2,    3 );
my @f = ( 3.14, 1.21, 0.75 );
my @s = ( 'a',  'b',  'c' );

my $iter = each_array(@n, @f, @s);
my @data;
while ( my @values = $iter->() ) {
  my $i = $iter->('index');
  @{ $data[$i] }{ qw/ number float string / } = @values;
}

use Data::Dump;
dd \@data; 
```

# java - 在MYSQL中使用hibernate注解设置默认值

> ID：13070682
> 
> 赞同：3
> 
> 时间：2012-10-25T14:20:24.990
> 
> 标签：java, hibernate

我在互联网上搜索并看到了关于在 mysql 中使用休眠注释在实体类中设置默认值的想法，并且我已经将默认值设置为仅具有数据类型整数的列，如下所示。

```
@Column(name = "COLUMN_NAME", insertable=false, updatable = false, nullable = false, columnDefinition = "int default 1")
protected Integer test_id; 
```

并且工作正常。

但是我还没有看到任何 varchar/string 数据类型的示例，我尝试在 columnDefinition 中使用不同的类型，例如，

```
columnDefinition = "TEXT default `TEST`"  
columnDefinition = "TEXT default TEST"  
columnDefinition = "varchar(255) default `15-JUL-1980`")  
columnDefinition = "varchar(255) default 15-JUL-1980")  
columnDefinition = "varchar default 15-JUL-1980")  
columnDefinition = "varchar default `15-JUL-1980`")  
columnDefinition = "CHAR(100) default `15JUL1980`")  
columnDefinition = "CHAR default `15JUL1980`") 
```

具有长度属性：-

```
`length=100, columnDefinition = "CHAR default `15JUL1980`")` 
```

等等

但在这种情况下，表不是由休眠创建的，这可能是由于语法错误。但是，如果我创建只有整数值的表，则创建上表。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-03T09:38:29.907

下面的代码行工作正常

```
@Column(name = "cname", insertable=false, updatable = false, nullable = false, columnDefinition = "varchar(255) default '15-JUL-1980'") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-07T12:49:33.583

columnDefinition 是有效的，但它依赖于数据库。
还有很多其他解决方案（使用@PrePersist 注释，修改'getters'），但我建议你在DBMS 中设置默认值，然后在模型类中使用@DynamicInsert/@DynamicUpdate 注释。

请参见下面的示例（Spring 数据 JPA + Hibernate）。

```
// Model class
@Entity
public class Person {
    private Integer age;
    private String name;
    private String phone;
    private String address;

    // setters and getters
}

// Insert method in service class
@Override
@Transactional
public Person create() {
    Person createdPerson = new Person();

    createdPerson.setAge(20);
    createdPerson.setName("Foo");
    //createdPerson.setPhone("Unknown");
    //createdPerson.setAddress("Somewhere");

    return personRepository.save(createdPerson);
} 
```

Hibernate 将生成以下插入 SQL 语句。

```
INSERT INTO person (age, name, phone, address)
VALUES (?, ?, ?, ?) 
```

您也可以看到 Hibernate 插入了不必要的列（电话、地址）。

但是，在将 @DynamicInsert 注释添加到 Model 类之后，如下所示，

```
@Entity
@DynamicInsert
public class Person {
    ...
} 
```

你可以看到 Hibernate 只插入必要的列。

```
INSERT INTO person (age, name)
VALUES (?, ?) 
```

和未初始化的列（电话、地址）通过 DBMS 默认值设置它们的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-03T06:34:06.057

只需在您的 Java 代码中设置默认值，只需像这样初始化您的变量 -`private int myColumn = 100;`并将 String 设置为

```
@Column(name="order_status" , length=10 )
private String orderStatus = "Pending"; 
```

这对我有用！我知道为时已晚，但我希望这会对某人有所帮助！

# c# - 实体框架：将 nullable 设置为 false，但类型仍然可以为 null

> ID：13070683
> 
> 赞同：2
> 
> 时间：2012-10-25T14:20:33.563
> 
> 标签：c#, entity-framework-4, visual-studio-2012

此问题与在 Visual Studio 2012 中创建的新类库项目有关。

我已将 SQL Server 视图添加到我的实体框架模型中。

在`PromisedDate`列的属性中，我已将 Nullable 从更改为`(None)`，`False`因为此列中永远不会返回空值。我已经仔细检查了 select 语句中没有空值。

![显示可空设置为 false 的 edmx 屏幕截图](../Images/5b793c47c20fd679c22f3df01ee55034.png)

但是，即使在保存之后，关闭 Visual Studio 中所有打开的选项卡并完全清理和重建解决方案，`PromisedDate`仍然是一个问题`DateTime?`，我必须继续`.Value`在代码中使用才能获得它的价值。

郁闷，我到底做错了什么？！

这是生成的 .CS 文件的屏幕截图：

![生成的类的屏幕截图显示仍然可以为空](../Images/b22399c3f58733fb7386e61b461c1d54.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T14:38:27.443

您应该执行以下步骤。

1) 保存设计器文件并从设计器生成数据库
2) 单击上下文文件和代码生成文件(T4)，然后单击运行自定义工具。
3) 确保再次保存文件，生成数据库后会出现*。

# javascript - dijit.Dialog 和远程内容的问题

> ID：13070685
> 
> 赞同：1
> 
> 时间：2012-10-25T14:20:42.550
> 
> 标签：javascript, dojo

我试图`dijit.Dialog`在用户单击链接时打开一个。

此外，我希望此对话框在对话框打开时而不是在包含对话框的页面加载时**获取 iframe 的远程内容（例如谷歌主页） 。**

这是JS：

```
dojo.require("dijit.Dialog");
dojo.require("dijit.form.Button");

function showDialog() {
    console.log('showDialog');
    dojo.byId('ifr').src = 'http://www.google.fr';
    dijit.byId('dialogOne').show();
}
var link = dojo.byId('link');
dojo.connect(link, 'onclick', showDialog);​ 
```

这是HTML：

```
<a href="#" id="link">open link</a>

<div id="dialogOne" data-dojo-type="dijit.Dialog" title="My external dialog">
<iframe id='ifr' width='300px' height='450px'>         </iframe>
</div>​ 
```

这是jsfiddle：http: [//jsfiddle.net/8eenG/6/](http://jsfiddle.net/8eenG/6/)

但是，这似乎不起作用...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:11:53.727

我完全误读了您的问题，然后继续前进并开始破解。

这不会加载远程内容，但可以解决您的所有其他问题。

在此处查看演示：http: [//jsfiddle.net/5uuCX/](http://jsfiddle.net/5uuCX/)

**Javascript**

```
require(["dojo/parser", "dojo/on", "dojo/dom", "dijit/registry"], 
function(parser, on, dom, registry) {
    parser.parse();
    on(dom.byId("link"), "click", function(e) {
        registry.byId('dialogOne').show();
    });
});​ 
```

**HTML**

```
<a href="#" id="link">Click to Open Dialog</a>    
<div id="dialogOne" data-dojo-type="dijit/Dialog" title="My external dialog">
    <div id="foo" data-dojo-type="dojox/layout/ContentPane" href="http://fiddle.jshell.net/259fD/show/">    
    </div>
</div>​ 
```

# kinect - 使用 Kinect、OpenNI、NITE 进行手势识别的指南

> ID：13070697
> 
> 赞同：3
> 
> 时间：2012-10-25T14:21:10.693
> 
> 标签：kinect, gesture

我知道这已经传遍了整个网络。我浏览了很多，发现了很多关于手势识别的信息。但是在阅读了大部分似乎都在 Kinect 官方 SDK、微软的 SDK 上工作之后我变得更加困惑，我不想使用它们。

我需要为 Linux 开发它，并且想知道 OpenNI，NITE 是否让我能够灵活地识别手势。

我正在尝试开发一个手语程序，它可以识别手势并在屏幕上绘制东西（球体、立方体等），

谁能给我一个明确的指导来开始这个项目。我不知道从哪里开始。

欢迎任何帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T13:14:27.860

为了开始理解手势，我建议查看我不久前发表的一篇博客文章： [http ://www.exceptontuesdays.com/gestures-with-microsoft-kinect-for-windows-sdk-v1-5/](http://www.exceptontuesdays.com/gestures-with-microsoft-kinect-for-windows-sdk-v1-5/)

这个，加上它链接到的帖子，进入了“手势”的组成部分以及如何使用 Kinect for Windows SDK 来实现它们。

你也可以查看你的 Kinect Toolbox，它也为官方 Kinect SDK 做手势：http: [//kinecttoolbox.codeplex.com](http://kinecttoolbox.codeplex.com)

这些将使您对如何处理手势有一个很好的理解。然后，您可以将这些概念和想法转移到 OpenNI 环境中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-05T11:41:41.710

如果在您的手语系统中您想使用手势，您可以查看[Kinect 3D handtracking](http://cvrlcode.ics.forth.gr/handtracking/)。如果它包括全身运动，那么看看[KineticSpace](https://code.google.com/p/kineticspace/)。这两个工具都适用于 linux，但第一个工具也需要启用 CUDA 的 GPU。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T02:18:56.350

*   我认为手势识别不取决于你使用的是 Kinect 官方 SDK 还是 OpenNI，如果你能从 Kinect 中获取骨骼数据或深度图像，那么你就可以从骨骼与时间的关系中提取手势或姿势。据我所知，这些 SDK 都提供了这些信息。

*   我在windows上开发了kinect，但原理是一样的，还是建议先了解一下手势识别的原理，然后再找其他SDK做识别的方法。

# uml - 在逻辑数据模型中映射 UI 元素

> ID：13070699
> 
> 赞同：1
> 
> 时间：2012-10-25T14:21:20.713
> 
> 标签：uml, enterprise-architect

我目前在一个项目中，我被要求在 UML 中创建一个逻辑数据模型。现在我已经定义了我所有的逻辑数据实体并且知道我的所有属性我只是有点迷失了如何将这些属性映射到 UI。

练习的重点是证明需求中的所有属性在我们选择部署的系统中都得到了满足。很高兴提供更多信息。

我正在使用的应用程序是 Enterprise Architect。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T05:42:04.107

这个问题已在 Enterprise Architect 支持论坛中得到解决。

```
Connect both classes with an association
Right click the assoc. near the class with attributes
Context menu/Link to Element Feature
Attributes
-> select the one and the assoc. is attached to it 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:04:48.853

有一种优雅的方法是在属性的类图中使用数据库构造型，然后将其映射到代码中的 java ORM 注释。我不认为 EA 可以做这个 ORM 映射，但其他工具可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T16:10:02.897

您的 UI 模型中是否也有工件？也就是说，作为屏幕模型还是作为底层 UI 类的类模型？如果是，那么您可能会发现使用实现或依赖关系为您的工件建立可追溯性非常有帮助。

您可以通过创建需求实体（在 SysML 需求图中）并将相应的需求拖放到为其提供解决方案的实体上来进一步支持这一点。以下 EA 白皮书的第 31 页对此进行了描述：http: [//community.sparxsystems.com/whitepapers/Requirements%20Management%20with%20Enterprise%20Architect/Requirements_Management_in_Enterprise_Architect.pdf](http://community.sparxsystems.com/whitepapers/Requirements%20Management%20with%20Enterprise%20Architect/Requirements_Management_in_Enterprise_Architect.pdf)

我为您截取了它的外观，但不幸的是，由于我是新成员，因此我还不能在此处发布。也许你可以从我在网上找到的这个截图中得到一个粗略的想法：[http ://www.sparxsystems.com.au/enterprise-architect/images/traceability_lg.png](http://www.sparxsystems.com.au/enterprise-architect/images/traceability_lg.png)

该机制在类级别上起作用。在属性级别，如果需要，您可能希望在注释字段中添加指向特定相关（要求）元素的链接。

# jquery - 动态添加的li元素的点击事件？

> ID：13070701
> 
> 赞同：-2
> 
> 时间：2012-10-25T14:21:20.847
> 
> 标签：jquery

我总共有 20 个链接。前 10 个链接直接对用户可见，其余 10 个链接在用户悬停向下箭头图像（用于悬停）时显示。当用户点击任意一个悬停链接时，直到当前点击的链接被移动到左侧（另一个向下箭头用于通过创建 li 将右侧链接动态添加到左侧）。这个工作正常。但反之亦然。（即）当我单击左侧链接时，它应该导航到右侧。单击事件不适用于我动态创建的 li 元素。请问谁能帮帮我？？？？？？

我的示例代码：

```
//To append the line from right hover to looplink div
$('#loop_link').append('<li id="pagelinkli_'+val3+'">'+$('#pagelinkli_'+val3).html()+'</li>');

//To hide the link in right hover div once it selected and appended in loop link div
$('#pagelink_a  #pagelinkli_'+val3).css('display','none');

//This line to move the link from loop link to left hover div
$('#pagelink_a_left ul').prepend(('<li id="pagelinkli_'+val6+'">'+$('#pagelinkli_'+val6).html()+'</li>'));

//This line to hide the link in looplink div              
$('#loop_link #pagelinkli_'+val6).css('display','none'); 
```

**这段代码就像导航链接从右悬停到选项卡和从选项卡到左悬停，反之亦然.....**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:24:31.517

[http://api.jquery.com/on/](http://api.jquery.com/on/)

```
$("#pagelink_a_left").on("click", "li", function() {
    alert($(this).html());
}); 
```

[http://jsfiddle.net/yakbQ/](http://jsfiddle.net/yakbQ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:26:38.903

问题是新链接是动态添加的，并且在页面加载时不是 DOM 的一部分。

所以你可以使用`live`jquery函数（不推荐使用LIVE，所以我不会建议）或者你可以使用这样的东西

```
$("body").on("click", "link div", function() {
    $('#loop_link').append('<li id="pagelinkli_'+val3+'">'+$('#pagelinkli_'+val3).html()+'</li>')
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-25T14:26:10.263

尝试使用 on 而不是 bind 或直接使用 click 功能。

尝试使用以下脚本。

```
$(".listContainer").on("click","li",function() {

}); 
```

on 方法将允许您为动态生成的元素（+ 已经存在的元素）绑定 click 事件。

根据许多 ppls 的建议，将实时方法更改为 on

# java - 使用 exif 和/或损坏的元数据加载 jpeg 图像

> ID：13070702
> 
> 赞同：1
> 
> 时间：2012-10-25T14:21:22.737
> 
> 标签：java, image, metadata

java中有没有办法用exif元数据加载jpeg图像？

我不需要 exif 数据（或任何其他元数据），但问题是 JavaIO.read 给了我：

```
javax.imageio.IIOException: Unsupported Image Type
        at com.sun.imageio.plugins.jpeg.JPEGImageReader.readInternal(JPEGImageReader.java:995) ~[na:1.7.0_09]
        at com.sun.imageio.plugins.jpeg.JPEGImageReader.read(JPEGImageReader.java:966) ~[na:1.7.0_09]
        at javax.imageio.ImageReader.read(ImageReader.java:940) ~[na:1.7.0_09] 
```

如果我尝试阅读图像。

在相关说明中：我们有时还会获得带有 ImageIO.read 也无法处理的其他元数据的 jpg 图像，所以我真的想要一个不尝试读取/处理/理解任何元数据的 jpeg 阅读器。但我一直找不到。

图像数据本身较新损坏，所有其他软件（Gimp、Firefox 等）都可以正确读取和显示图像。

我什至尝试了以下方法，但它仍然无法读取图像。

```
 Iterator readers = ImageIO.getImageReadersByFormatName("jpg");
            ImageReader reader = (ImageReader)readers.next();
            ImageInputStream iis = ImageIO.createImageInputStream(sourceFile);
            reader.setInput(iis,true,true);

            BufferedImage image = reader.read(0); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:18:27.623

这里没有太多可用的选项。如果一个人想解决一个特定的问题，毫无疑问可以在 Java 中完成。然而，如果你只是在你的项目中寻找一个库来做一些图像处理，而不需要成为一名图形专家程序员，那么开源 Java 库还不能与商业库或非 Java 库相提并论。对 SO 的简单搜索将显示状态。因此，如果您需要在生产环境中获得**可靠且意外最少**的东西，您很可能（在我看来）最终会得到以下之一（截至本文发布之日的状态）：

1- 商业产品，例如[Snowbound RasterMaster](http://www.snowbound.com/products/viewing-conversion-sdk/java)

2-使用 ImageMagick（或 GraphicsMagick）之类的工具，并可以选择为它们使用 java 接口，例如[im4java](http://im4java.sourceforge.net/)或[JMagick](http://www.jmagick.org/)。

至于你的问题，你提到使用 mogrify。您也可以为输出图像设置色彩空间，它可能会解决您的问题：[ImageMagick Colorspace](http://www.imagemagick.org/www/command-line-options.html#colorspace)

所以也许你可以在你的 jpg 文件上尝试：“/usr/bin/mogrify -strip -colorspace sRGB”。

# r - 如何在 64 位窗口中将 R 与 Access 数据库连接？

> ID：13070706
> 
> 赞同：53
> 
> 时间：2012-10-25T14:21:35.113
> 
> 标签：r, ms-access, rodbc

当我尝试将 R 与 Access 数据库连接时，出现错误

```
odbcConnectAccess is only usable with 32-bit Windows 
```

有谁知道如何解决这个问题？

```
library(RODBC) 
mdbConnect<-odbcConnectAccess("D:/SampleDB1/sampleDB1.mdb") 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-25T14:26:46.313

改为使用`odbcDriverConnect`。如果您安装了 64 位 R，则可能必须使用 32 位 R 版本。

```
odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=D:/SampleDB1/sampleDB1.mdb") 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-10-10T15:53:47.300

这是一个函数，它将数据从 32 位访问传输到 64 位 R，而无需保存任何文件。该函数构建一个表达式字符串，该字符串传递给第二个 32 位会话；然后使用套接字服务器包（svSocket）将数据返回到原始会话。需要注意的一点是，socket 服务器将访问数据保存在全局环境中，所以第二个参数用于定义输出，而不是使用“<-”来保存输出。

```
access_query_32 <- function(db_table = "qryData_RM", table_out = "data_access") {
  library(svSocket)

  # variables to make values uniform
  sock_port <- 8642L
  sock_con <- "sv_con"
  ODBC_con <- "a32_con"
  db_path <- "~/path/to/access.accdb"

  if (file.exists(db_path)) {

    # build ODBC string
    ODBC_str <- local({
      s <- list()
      s$path <- paste0("DBQ=", gsub("(/|\\\\)+", "/", path.expand(db_path)))
      s$driver <- "Driver={Microsoft Access Driver (*.mdb, *.accdb)}"
      s$threads <- "Threads=4"
      s$buffer <- "MaxBufferSize=4096"
      s$timeout <- "PageTimeout=5"
      paste(s, collapse=";")
    })

    # start socket server to transfer data to 32 bit session
    startSocketServer(port=sock_port, server.name="access_query_32", local=TRUE)

    # build expression to pass to 32 bit R session
    expr <- "library(svSocket)"
    expr <- c(expr, "library(RODBC)")
    expr <- c(expr, sprintf("%s <- odbcDriverConnect('%s')", ODBC_con, ODBC_str))
    expr <- c(expr, sprintf("if('%1$s' %%in%% sqlTables(%2$s)$TABLE_NAME) {%1$s <- sqlFetch(%2$s, '%1$s')} else {%1$s <- 'table %1$s not found'}", db_table, ODBC_con))
    expr <- c(expr, sprintf("%s <- socketConnection(port=%i)", sock_con, sock_port))
    expr <- c(expr, sprintf("evalServer(%s, %s, %s)", sock_con, table_out, db_table))
    expr <- c(expr, "odbcCloseAll()")
    expr <- c(expr, sprintf("close(%s)", sock_con))
    expr <- paste(expr, collapse=";")

    # launch 32 bit R session and run expressions
    prog <- file.path(R.home(), "bin", "i386", "Rscript.exe")
    system2(prog, args=c("-e", shQuote(expr)), stdout=NULL, wait=TRUE, invisible=TRUE)

    # stop socket server
    stopSocketServer(port=sock_port)

    # display table fields
    message("retrieved: ", table_out, " - ", paste(colnames(get(table_out)), collapse=", "))
  } else {
    warning("database not found: ", db_path)
  }
} 
```

有时，此函数会返回错误，但它不会影响数据检索，并且似乎是关闭套接字服务器连接的结果。

可能还有改进的余地，但这提供了一种简单快捷的方法，可以将数据从 32 位访问中提取到 R 中。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-10-21T11:47:49.827

给出的答案没有成功，但这是最终为我成功的一步一步的方法。在 64 位上安装 Windows 8。安装了 64 位和 32 位 R。我的访问是 32 位的。

# 使用步骤，假设 Windows 8 上的 32 位 Access

1.  选择 32 位 R（只是 R studio 中的一个设置）
2.  在 Windows 上搜索设置 ODBC 数据源（32 位）
3.  转到系统 DSN>添加
4.  选择 Driver do Microsoft Access (*.mdb) > Finish
5.  数据源名称：ProjecnameAcc
6.  描述：项目名称Acc
7.  确保实际选择数据库> OK

现在我可以运行我喜欢的代码了

```
channel <- odbcConnect("ProjectnameAcc")
Table1Dat <- sqlFetch(channel, "Table1") 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-08-30T11:55:28.170

我在遇到类似问题时遇到了这个 SO，此时我们至少还有一个使用极其灵活的 odbc 库的选项。

不过这里有一个重要说明：MS Access ODBC 驱动程序不是默认 MS Office 安装的一部分，因此您必须从 Microsoft 下载适当的驱动程序（在我的情况下为 Microsoft Access Database Engine 2016 Redistributable）并确保下载适当的位数（例如 AccessDatabaseEngine_X64.exe）。下载后，它应该会自动显示在您的 Windows ODBC 数据源（64 位）实用程序中，或者您可以在 R 会话中使用 odbcListDrivers 函数进行确认。

```
library(odbc)

# run if you want to see what drivers odbc has available
# odbcListDrivers()

# full file path to Access DB
file_path <- "~/some_access_file.accdb"

# pass MS Access file path to connection string
accdb_con <- dbConnect(drv = odbc(), .connection_string = paste0("Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=",file_path,";")) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-11T15:04:34.017

使用其他人的建议，这是一个将 32 位 Access 数据转换为 64 位 R 的显式示例，您可以将其写入脚本，这样您就不需要手动执行这些步骤。您确实需要在您的机器上安装 32 位 R 才能运行此脚本，并且此脚本假定 32 位 R 的默认位置，因此请根据需要进行调整。

第一个代码部分进入您的主脚本，第二个代码部分是您创建并从主脚本调用的一个小 R 脚本文件的全部内容，这种组合提取并保存然后从 access 数据库加载数据，而无需不得不停下来。

这是我的主脚本中的部分，这是从 64 位 R 中运行的

```
##  Lots of script above here
## set the 32-bit script location
pathIn32BitRScript <- "C:/R_Code/GetAccessDbTables.R"
## run the 32 bit script
system(paste0(Sys.getenv("R_HOME"), "/bin/i386/Rscript.exe ",pathIn32BitRScript))
## Set the path for loading the rda files created from the little script 
pathOutUpAccdb <- "C/R_Work/"
## load the tables just created from that script
load(paste0(pathOutUpAccdb,"pots.rda"))
load(paste0(pathOutUpAccdb,"pans.rda"))
## Lots of script below here 
```

这是名为 GetAccessTables.R 的单独脚本

```
library(RODBC).    
## set the database path
inCopyDbPath <- "C:/Projects/MyDatabase.accdb"
## connect to the database
conAccdb <- odbcConnectAccess2007(inCopyDbPath) 

## Fetch the tables from the database. Modify the as-is and string settings as desired
pots <- sqlFetch (conAccdb,"tbl_Pots",as.is=FALSE, stringsAsFactors = FALSE)
pans <- sqlFetch(conAccdb,"tbl_Pans",as.is=FALSE, stringsAsFactors = FALSE)
## Save the tables
save(pots, file = "C/R_Work/pots.rda")
save(pans, file = "C:/R_Work/pans.rda")
close(conAccdb) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-10-25T11:49:05.027

上面 manotheshark 的函数非常有用，但我想使用 SQL 查询而不是表名来访问数据库，并将数据库名称作为参数传递，因为我通常使用多个 Access 数据库。这是修改后的版本：

```
access_sql_32 <- function(db_sql = NULL, table_out = NULL, db_path = NULL) {
  library(svSocket)

  # variables to make values uniform
  sock_port <- 8642L
  sock_con <- "sv_con"
  ODBC_con <- "a32_con"

  if (file.exists(db_path)) {

    # build ODBC string
    ODBC_str <- local({
      s <- list()
      s$path    <- paste0("DBQ=", gsub("(/|\\\\)+", "/", path.expand(db_path)))
      s$driver  <- "Driver={Microsoft Access Driver (*.mdb, *.accdb)}"
      s$threads <- "Threads=4"
      s$buffer  <- "MaxBufferSize=4096"
      s$timeout <- "PageTimeout=5"
      paste(s, collapse=";")
    })

    # start socket server to transfer data to 32 bit session
    startSocketServer(port=sock_port, server.name="access_query_32", local=TRUE)

    # build expression to pass to 32 bit R session
    expr <- "library(svSocket)"
    expr <- c(expr, "library(RODBC)")
    expr <- c(expr, sprintf("%s <- odbcDriverConnect('%s')", ODBC_con, ODBC_str))
    expr <- c(expr, sprintf("%1$s <- sqlQuery(%3$s, \"%2$s\")", table_out, db_sql, ODBC_con))
    expr <- c(expr, sprintf("%s <- socketConnection(port=%i)", sock_con, sock_port))
    expr <- c(expr, sprintf("evalServer(%s, %s, %s)", sock_con, table_out, table_out))
    expr <- c(expr, "odbcCloseAll()")
    expr <- c(expr, sprintf("close(%s)", sock_con))
    expr <- paste(expr, collapse=";")

    # launch 32 bit R session and run the expression we built
    prog <- file.path(R.home(), "bin", "i386", "Rscript.exe")
    system2(prog, args=c("-e", shQuote(expr)), stdout=NULL, wait=TRUE, invisible=TRUE)

    # stop socket server
    stopSocketServer(port=sock_port)

    # display table fields
    message("Retrieved: ", table_out, " - ", paste(colnames(get(table_out)), collapse=", "))
  } else {
    warning("database not found: ", db_path)
  }
} 
```

我在弄清楚如何调用 manotheshark 的函数时也遇到了一些困难，并且需要深入研究 svSocket 包文档才能意识到调用脚本需要实例化将返回数据的对象，然后传递其名称（而不是对象本身）在 table_out 参数中。这是一个调用我修改后的版本的 R 脚本示例：

```
source("scripts/access_sql_32.R")
spnames <- data.frame()
# NB. use single quotes for any embedded strings in the SQL
sql <- "SELECT name as species FROM checklist 
        WHERE rank = 'species' ORDER BY name"
access_sql_32(sql, "spnames", "X:/path/path/mydata.accdb") 
```

这可行，但有局限性。

首先，避免任何 Microsoft Access SQL 扩展。例如，如果您使用 Access Query 构建器，它通常会插入字段名称，例如`[TABLE_NAME]![FIELD_NAME]`. 这些都行不通。Access 还允许以“10kmSq”等数字开头的非标准字段名称，并允许您在 SQL 中使用它们，例如`SELECT [10kmSq] FROM ...`. 这也行不通。如果 SQL 语法有错误，返回变量将包含错误消息。

其次，您可以返回的数据量似乎仅限于 64Kb。如果您尝试运行返回过多的 SQL，则 32 位会话不会终止并且脚本会挂起。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-11-17T13:40:50.097

以下解决方案对我有用：在[read-data-from-32-bit-access-db-using-64-bit-R](https://stackoverflow.com/questions/45064057/reading-data-from-32-bit-access-db-using-64-bit-r)上找到它说 要从以下位置安装 64 位数据库引擎：[microsoft`](https://www.microsoft.com/en-US/download/details.aspx?id=13255)

然后：找到并运行“ODBC-datasources (64-bits)”。

1.  在“用户-DSN”选项卡中单击“添加”
2.  选择：“Microsoft Access Driver”并保存
3.  为您的新数据源命名（稍后连接数据库时将使用此名称）
4.  单击“选择”：选择您的访问数据库所在的目录并保存

然后在R中：

```
library(RODBC)
dcon <- dbConnect(odbc::odbc(), "name-you-gave-to-your-datasource-in-3") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-26T16:30:24.883

我正在运行 Windows 10 x64、Office 365 x64（不确定是否相关）和 R 64 位。我不需要切换到 32 位 R。

就我而言，我通过安装 64 位版本的[Microsoft Access Database Engine 2016 Redistributable](https://www.microsoft.com/en-us/download/details.aspx?id=54920)然后提供我自己的帐户（rsession.exe 运行为）对注册表项具有**完全控制权限来使其工作。**`HKEY_LOCAL_MACHINE\SOFTWARE\ODBC`

注册表项的权限没有意义。我的帐户已经是此 PC**管理员**组的成员，并且该组已经对该密钥具有**完全控制权限。**

我使用的命令：

```
library("odbc")

accdb_con <- dbConnect(drv = odbc(), .connection_string = paste0("Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=C:/full_path_to_file/buildings.mdb;")) 
```

# cuda - cuda 纹理声明编译时错误

> ID：13070712
> 
> 赞同：2
> 
> 时间：2012-10-25T14:21:55.933
> 
> 标签：cuda, textures

我正在尝试编译以下代码：

```
#include <stdio.h>
#include <time.h>
#include <cuda.h>
#include <cuda_runtime_api.h>

texture<float, 2, cudaReadModeElementType> tex;

int main () { ... } 
```

然而，nvcc 给了我以下错误：

```
main.c:6:8: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘&lt;’ token 
```

我对 CUDA 很陌生，所以我想我在这里遗漏了一些东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:28:25.017

您只能在 .cu 文件中使用 CUDA 语法。

# c# - 如何将 System.Threading.Timer 与 asp.net Web 服务一起使用

> ID：13070719
> 
> 赞同：5
> 
> 时间：2012-10-25T14:22:18.517
> 
> 标签：c#, asp.net, service, web, timer

**背景：** 我有一个在 Windows Server 2008 上运行的 .NET 4.0 Web 服务，用 C# 编写。我想在每天运行一次代码的 asp.net Web 服务中运行一个计时器。我听说过一些限制（见下文），但我想知道我的计划是否可行，以便绕过一些限制并将代码保留在 Web 服务中，因为它不是关键任务代码。然而，崩溃是不可接受的。注意：我不是也不能使用 WCF。

**计划：**

*   在我的 Web 服务的构造函数中声明并实例化`System.Threading.Timer`（就在注释掉的行旁边：） `//InitializeComponent();`。
*   每 30 分钟触发一次计时器。
*   注意：因为我正在使用`System.Threading.Timer`我不应该根据下面的 msdn Tip #6 运行保持活动代码。
*   如果当前时间在我的数据库值（运行代码所需的时间）的 30 分钟内，则运行代码。

**问题：**

*   我想知道`System.Threading.Timer`使用上面的计划在 asp.net c# 代码中使用它有多可靠，如果它可以正确运行，让我们说超过 97% 的时间？
*   当应用程序池被回收和 IIS 服务器重新启动时，此计划是否有效？

在 Web 服务中使用计时器似乎存在以下问题：

*   应用程序池回收
*   线程死亡
*   长时间没有人上网
*   时间记忆问题（最好使用 Windows 服务）

**参考：**

[ASP.NET 站点 - 在特定时间触发一些代码](https://stackoverflow.com/questions/8584909/asp-net-site-firing-some-code-at-a-specific-time)

[网站上的计时器以每小时激活一次 Web 服务调用](https://stackoverflow.com/questions/6008475/timer-on-website-to-activate-web-service-calls-every-hour)

[http://forums.asp.net/t/1079158.aspx/1](http://forums.asp.net/t/1079158.aspx/1)

[http://msdn.microsoft.com/en-us/magazine/cc163854.aspx](http://msdn.microsoft.com/en-us/magazine/cc163854.aspx) （参见提示 #6）

**来自技巧 #6** “在 System.Threading 命名空间中的 Timer 类是一个非常有用的类，但在 .NET Framework 中鲜为人知，至少对于 Web 开发人员而言。创建后，Timer 将以可配置的时间间隔从 ThreadPool 调用线程上的指定回调。这意味着您可以设置代码以在没有对 ASP.NET 应用程序的传入请求的情况下执行，这是后台处理的理想情况。您也可以在此后台进程中进行索引或发送电子邮件等工作。”</p>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:25:19.243

您为这项工作使用了错误的工具。Web 服务用于按需使用，而服务和计划任务应用于定期活动。`Timer`将相关代码从 Web 服务移出到共享库中，然后使用可通过计划任务安排的控制台应用程序或控制台应用程序创建 Windows 服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-20T06:50:26.980

如果由于某种原因，您必须这样做。请务必阅读[IRegisteredObject](http://msdn.microsoft.com/en-us/library/system.web.hosting.iregisteredobject(v=vs.110).aspx) 以及 Haacked 关于此[主题的帖子](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:49:38.153

`Global.asax.cs`您可以在事件中的文件中`Application_Start`而不是在 Web 服务中设置计时器对象。

# html - 创建超链接以调用 Torrent 客户端软件

> ID：13070722
> 
> 赞同：0
> 
> 时间：2012-10-25T14:22:34.203
> 
> 标签：html, hyperlink, bittorrent

我知道使用代码`<a href="mailto:john.smith@gmail.com">John Smith</a>`我可以调用电子邮件客户端将电子邮件发送给我想要的人。

现在，如何调用 torrent 客户端软件下载 torrent？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:30:49.560

从技术上讲，当用户单击此类链接时，您不会*调用电子邮件客户端。*相反，客户端会启动为处理该类型的 URI 而注册的应用程序。`mailto`URI 部分的技术名称是[scheme](http://en.wikipedia.org/wiki/URI_scheme)。

您真正想要的是[Magnet URI Scheme](http://en.wikipedia.org/wiki/Magnet_URI_scheme)。

要生成 BitTorrent 磁力 URI，您需要提取经过`info`编码的 .torrent 文件内容的部分，如[BitTorrent 协议规范中所述](http://www.bittorrent.org/beps/bep_0003.html)。生成数据的 SHA-1 哈希（这称为“infohash”），然后对该哈希进行十六进制编码。您还可以包含一个`tr`参数来声明跟踪器的位置。例如

```
magnet:?xt=urn:btih:<your_hex_encoded_sha1_hash>&tr=http://urlto/announce 
```

为了进一步阅读，我建议[BitTorrent 磁力链接如何工作？](https://stackoverflow.com/questions/3844502/how-does-bt-magnet-links-work).

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T14:29:36.183

你可以使用磁力链接

（这是一个 0bytes 文件的示例）

```
 magnet:?xt=urn:ed2k:31D6CFE0D16AE931B73C59D7E0C089C0
&xl=0&dn=zero_len.fil
&xt=urn:bitprint:3I42H3S6NNFQ2MSVX7XZKYAYSCX5QBYJ
.LWPNACQDBZRYXW3VHJVCJ64QBZNGHOHHHZWCLNQ
&xt=urn:md5:D41D8CD98F00B204E9800998ECF8427E 
```

然后您可以个性化您的磁性链接以管理您要下载的文件的下载。

来源[http://en.wikipedia.org/wiki/Magnet_URI_scheme#Technical_description](http://en.wikipedia.org/wiki/Magnet_URI_scheme#Technical_description)

# sql - 如何从 SELECT AS 在 Oracle 11g R2 中创建表并按范围列表对表进行分区？

> ID：13070723
> 
> 赞同：4
> 
> 时间：2012-10-25T14:22:35.590
> 
> 标签：sql, oracle, oracle11gr2

我正在尝试从名为 Titles 的现有表中创建一个名为 Titles2 的新表。我必须使用 SELECT AS 语句从 Titles 中创建 Titles2 中的列。我还必须按 RANGE 和 LIST 对 Titles2 进行分区。

用于创建标题的代码：

```
SQL> CREATE TABLE Titles
  2    (
  3    Title_id         char(3)     ,
  4    Title            varchar2(40),
  5    Genre            varchar2(10),
  6    Pages            number      ,
  7    Price            number(5,2) ,
  8    Sales            number      ,
  9    Pub_id           char(3)     ,
 10    Pubdate          date        ,
 11    Advance          number(9,2) ,
 12    Royalty_rate     number(5,2) ,
 13    CONSTRAINT Titles_pk PRIMARY KEY (title_id),
 14    CONSTRAINT Titles_Publishers_fk FOREIGN KEY (Pub_id)
 15                             REFERENCES Publishers (pub_id)
 16    )
 17    PARTITION BY RANGE (Pubdate) (
 18    PARTITION P1 VALUES LESS THAN (TO_DATE('01-JAN-1995', 'DD-MON-YYYY')) TABLESPACE TSLab8ben1,
 19    PARTITION P2 VALUES LESS THAN (TO_DATE('01-JAN-2000', 'DD-MON-YYYY')) TABLESPACE TSLab8ben2,
 20    PARTITION P3 VALUES LESS THAN (MAXVALUE) TABLESPACE TSLab8ben3
 21    );

Table created. 
```

以下代码是我迄今为止从 Titles 创建 Titles2 表的代码：

```
CREATE TABLE Titles2 AS
SELECT Title_id AS TID, Title, Genre, Sales, (Sales * Price) AS Revenue, Pub_id AS P#
FROM Titles
PARTITION BY RANGE (Revenue)
SUBPARTITION BY LIST (Genre)
SUBPARTITION TEMPLATE (
SUBPARTITION G1 VALUES ('history', 'biography'),
SUBPARTITION G2 VALUES ('computer','children'),
SUBPARTITION G3 VALUES (DEFAULT)) (
PARTITION P1 VALUES LESS THAN (100000),
PARTITION P2 VALUES LESS THAN (500000),
PARTITION P3 VALUES LESS THAN (1000000),
PARTITION P4 VALUES LESS THAN (MAXVALUE)); 
```

但是，用于创建 Titles2 的代码不会执行。任何人都可以帮助我执行 Titles2 代码吗？谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-25T14:30:04.297

就像您`Titles2`对. 然后使用语句填充来自的数据`create table``Titles``insert``Titles2``Titles`

```
insert into Titles2 
  select <<columns>>
    from Titles 
```

或者你可以重写你的最后一条`create table`语句，如下所示：

```
CREATE TABLE Titles2
  PARTITION BY RANGE (Revenue)(
    SUBPARTITION BY LIST (Genre)
    SUBPARTITION TEMPLATE (
    SUBPARTITION G1 VALUES ('history', 'biography'),
    SUBPARTITION G2 VALUES ('computer','children'),
    SUBPARTITION G3 VALUES (DEFAULT)) (
    PARTITION P1 VALUES LESS THAN (100000),
    PARTITION P2 VALUES LESS THAN (500000),
    PARTITION P3 VALUES LESS THAN (1000000),
    PARTITION P4 VALUES LESS THAN (MAXVALUE))
   ) AS
SELECT Title_id AS TID
     , Title
     , Genre
     , Sales
     , (Sales * Price) AS Revenue
     , Pub_id AS P#
FROM Titles 
```

# java - java 1.7 中的 Swingworker 问题

> ID：13070724
> 
> 赞同：0
> 
> 时间：2012-10-25T14:22:37.460
> 
> 标签：java, multithreading, swing

我有两个 Java 程序（客户端和服务器），在我升级到 Java 1.7 之前，它们多年来一直运行良好。

现在我对 SwingWorker 有以下致命问题：`done()`从`doInBackground()`. 我在 return from 之前放了一个 println `doInBackground()`，它一直显示。开头的 println`done()`调用很晚。

如果我从 Netbeans IDE 运行程序，则永远不会发生这种情况，只有当我从命令行运行它们或单击 .jar 文件时（我在 Windows XP 中 - 但也发生在其他操作系统上）。此外，Java 1.6 或更早版本永远不会发生这种情况。

我正在使用 SwingWorker.jar 1.2 版。

# mouse - KineticJS - 释放外部事件

> ID：13070725
> 
> 赞同：1
> 
> 时间：2012-10-25T14:22:38.597
> 
> 标签：mouse, kineticjs

有没有办法检测鼠标的释放是否在对象本身上？类似于 Flash 中的 onReleaseOutside 事件？

# jquery - 骨干模态对话框中的自动完成溢出隐藏不起作用？

> ID：13070732
> 
> 赞同：0
> 
> 时间：2012-10-25T14:23:01.840
> 
> 标签：jquery, css, backbone.js

我正在使用主干模式 dilaog，并在其中使用 jquery.backbone.widgets.js 使用自动完成功能。自动完成列表应该覆盖在模式对话框的顶部，并且它必须溢出而不可滚动。但它使模态对话框滚动。您能否建议可以使功能符合我需要的 css 更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:21:00.180

.modal { 溢出：可见；} .modal-body { 溢出-y：可见；}

这解决了我的问题。

# c# - 在一台计算机上启动一个小型服务器应用程序，并将另一个客户端连接到它

> ID：13070743
> 
> 赞同：2
> 
> 时间：2012-10-25T14:23:27.700
> 
> 标签：c#

抱歉，这个问题非常广泛，但我很想得到答案。

对于一个想法，我希望一台计算机在本地网络上启动服务器，并让另一台计算机连接到该服务器以交换数据。

我的问题是如何做到这一点？

作为一个附加问题，有人有关于 System.net 类参考的好教程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:42:59.040

一种解决方案是使用套接字。对于服务器套接字，您创建一个套接字，然后调用 bind、listen 和 accept。这可以异步完成，也可以通过阻塞线程来完成。

```
Socket server = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
server.Bind(new IPEndPoint(IPAddress.Any, port));
server.Listen(3);
Socket client = server.Accept(); 
```

现在，`client`是连接到已连接计算机的连接。现在您可以使用 Send 方法在两者之间实际发送数据。

```
string message = "hello there";
byte[] bytes = Encoding.UTF8.GetBytes(message);
byte[] lengthBytes = BitConverter.GetBytes(bytes.Length);
client.Send(lengthBytes);
client.Send(bytes); 
```

使用 lengthbytes 是因为其他客户端可能不知道我们为“完整消息”传输了多少字节，所以我们简单地告诉它。

另一方面，客户端使用 Connect 方法连接到正在运行的服务器，并使用 Recive 获取从服务器发送的字节。

```
Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
socket.Connect(new IPEndPoint(IPAddress.Parse("127.0.0.1"), port));
byte[] lengthBytes = new byte[4];
socket.Receive(lengthBytes);
int length = BitConverter.GetInt32(lengthBytes);
byte[] messageBytes = new byte[length];
socket.Receive(messageBytes);
string message = Encoding.UTF8.GetString(messageBytes);
Console.WriteLine(message); 
```

顺便说一句，发送和接收双向工作。

不过，这只是表面现象。野外有很多资源可以解决这个问题，但也许这可以成为你的垫脚石。例如，您可以查看`SocketAsyncEventArgs`用于异步通信的类，而不是在调用 Receive 时阻塞线程。

您还应该研究用户提供的数据的卫生情况。请记住，“长度”是用户提供的，因为它在我们刚刚定义的协议中。我们不能告诉服务器总是发送正确的数据，它还不如发送 -1 当我们尝试分配时这将是不好的`new byte[length]`。数据的清理或验证是必要的，这样客户端就不会在我们自己的计算机上崩溃或做坏事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:44:27.150

我认为这个[链接](http://www.switchonthecode.com/tutorials/csharp-tutorial-simple-threaded-tcp-server)是你应该开始的。这篇文章非常基础，但当有人不知道从哪里开始时，我经常推荐它。当然，您将不得不处理一些问题，例如停止服务器等，但它会为您指明进一步搜索的方向。

# c - c - 我的 push 函数总是将最新的元素推送到堆栈的每个值上

> ID：13070747
> 
> 赞同：0
> 
> 时间：2012-10-25T14:23:43.313
> 
> 标签：c, push, printf

所以由于某种原因，这个函数似乎将所有相同的值推入堆栈（或者只是打印相同的值；我想它实际上可能与我也包含的 printAll 函数有关。）？问题是，对于元素数组（它是一个整数数组）， printAll 适当地循环遍历这些值。但是关于 charElement 数组的任何事情，printAll 函数只打印 charElements 函数中每个值的最新值。知道为什么会这样吗？

```
void pushString(Stack *S, char element[])
{        
    /* If the stack is full, we cannot push an element into it as there is no space for it.*/        
    if(S->size == S->capacity)        
    {                
        printf("Stack is Full\n");        
    }        
    else        
    {                
        /* Push an element on the top of it and increase its size by one*/ 
        S->charElements[S->size++] = element;
        S->elements[S->size-1] = '\n'; 
    }        
    return;
}

void printAll(Stack *S)
// NOTE:  Called w/ user input 'f'
// PRE:   Stack S is initialized
// POST:  Print all values from the stack
//    Do NOT alter anything
{

    int i; 
    for(i = 0; i < S->size; i++)
    {
        printf("%d \n", i);
        if(S->charElements[i] == "\n")
        {
            printf("%.2f \n", (float)S->elements[i]);   
        }
        else if(S->elements[i] == '\n')
        { 
            printf("%s \n", S->charElements[i]); 
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:27:06.790

```
S->charElements[S->size++] = element; 
```

仅将指针复制到传入的`char*` `element`.

如果您使用同一个缓冲区读取输入，然后将其`pushString`重复传递给函数，则所有堆栈元素最终都指向同一个缓冲区，其内容是最后输入的值。

您需要使用`strdup`or`malloc`和复制内容`strcpy`。

```
S->charElements[S->size++] = strdup(element); 
```

分别

```
S->charElements[S->size] = malloc(strlen(element) + 1);
// check for NULL
strcpy(S->charElements[S->size++], element); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:28:31.303

代码很奇怪。元素`char []`在 push 函数中由 表示，但使用`%f`in打印`printAll()`。这对我来说没有多大意义。

如果没有`Stack`结构的声明，就很难遵循代码的意图。

# objective-c - 从模态视图传递数据

> ID：13070748
> 
> 赞同：1
> 
> 时间：2012-10-25T14:23:49.440
> 
> 标签：objective-c

故事板 ViewController SecondViewController

在使用小数点在 TextFieldNumber 中输入数字后，我想从模态 SecondViewController 中的 LabelNumber（在 ViewController 中）中传递数据（aNumber，一个变量 NSString）。我在 SecondViewController 中添加了一个关闭按钮（栏按钮项）并连接到 Segue（mySegue）。在 ViewController 中有一个链接到 SecondViewController 的圆形矩形按钮 这是 ViewController.m 中的代码

```
#import "ViewController.h"
#import "SecondViewController.h"
@interface ViewController ()
@property (weak, nonatomic) IBOutlet UILabel *LabelNumber;
@property (weak, nonatomic) SecondViewController * SecondScreen;

 - (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{    
if ([segue.identifier isEqualToString: @"mySegue"]){
    self.SecondScreen  = segue.destinationViewController;
      self.SecondScreen.aNumber = self.LabelNumber.text
}

- (IBAction)close:(UIStoryboardSegue*)sender {
  if([sender.identifier isEqualToString:@"mySegue"] ){
    self.LabelNumber.text = self.SecondViewController.aNumber;
} 
```

在 SecondViewController.h 我有这个代码：

```
 #import <UIKit/UIKit.h>
 @interface SecondViewController : UIViewController
 @property (strong, nonatomic) NSString* aNumber;
 @end 
```

在 SecondViewController.m 我有这个代码：

> ```
>  #import "ViewController.h"
> #import "SecondViewController.h"
>  @interface SecondViewController () <UITextFieldDelegate> 
> ```
> 
> @property（强，非原子）IBOutlet UITextField *TextFieldNumber; @结尾

```
 - (void)viewDidLoad
 {
[super viewDidLoad];
[self.TextFieldNumber becomeFirstResponder];
self.TextFieldNumber.delegate = self;
self.TextFieldNumber.text = self.aNumber;
 }

 - (IBAction)getValue:(UITextField *)sender {
self.aNumber = self.TextFieldNumber.text ;
[self.TextFieldNumber resignFirstResponder];
 } 
```

最后，我总是在 SecondViewController.m 中添加了这一点，即使我不想关闭键盘但我希望它始终保持打开状态并希望在关闭按钮中捕获 TextNumber 值（aNumber）（模态展开）。

> -(BOOL) textFieldShouldReturn:(UITextField *)textField{ if (textField == self.TextFieldNumber) [self.TextFieldNumber resignFirstResponder]; 返回是；}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:11:21.703

如果我正确理解了这个问题，您有两个选择：

1.  将 FirstViewController 分配为 SecondViewController 的委托，这样当您关闭 modal 时，您也可以调用*`[self.delegate secondViewControllerWillDismiss:value]`*
2.  让 FirstViewController 监听自定义通知，比如“SecondViewControllerDismissNotification”，并让 SecondViewController`NSNotification`在关闭时发送此通知。在这种情况下，您必须将参数写入 a`NSDictionary`以与通知本身一起传递。

如果不清楚，我可以写一个小例子。

# php - Symfony2 DataTransformers - 你如何在没有 ID 或唯一值的情况下转换回来？

> ID：13070749
> 
> 赞同：0
> 
> 时间：2012-10-25T14:23:53.097
> 
> 标签：php, forms, symfony, symfony-2.1

我为每个联系人（姓名、电子邮件）实体收集了电话号码实体。PhoneNumber 分为区号、交换机、后缀、分机，然后是类型选择器（工作、家庭、移动）。我想使用 DataTransformer 以便数字可以显示在单个表单字段中，而不是 4 个不同的文本框中。电话号码在数据库中不是唯一的。

**更新：**从字符串版本转换回实体时，如何访问完整实体？我之前遇到过这个问题，最终将实体的 ID 放在文本字段中的括号内，然后在转换中将它们正则表达式，以便我可以进行查询以获取实体。

phonenumber_combined 是一个自定义表单类型服务，它引用了我的 PhoneNumberCombinedType 类。

**我在联系人中收集电话的添加方法：**

```
->add('phones', 'collection', array(
            'label'     => 'Phones',
            'type'      => new PhoneNumberType(),
            'allow_add' => true,
            'allow_delete' => true
            ))
        ; 
```

**PhoneNumberType buildForm 函数：**

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder
        ->add('phone', 'phonenumber_combined')
        ->add('type', 'entity',
            array('class'   => 'Test\Bundle\SystemBundle\Entity\Type',
            'property'      => 'name',
            'query_builder' => function(EntityRepository $er){
                return $er->createQueryBuilder('type')
                ->where('type.type = :t')
                ->orderBy('type.name', 'ASC')
                ->setParameter('t', 'PhoneNumber');
            }))
        ;           
} 
```

**PhoneNumberCombinedType 服务：**

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $transformer = new PhoneNumberToStringTransformer($this->om);

    $builder->addViewTransformer($transformer);
} 
```

**电话号码转字符串转换器：**

```
public function transform($phonenumber)
{
    if (null === $phonenumber) {
        return null;
    }

    return $phonenumber->__toString();       
}

public function reverseTransform($phonenumber)
{
    if (!$phonenumber) {
        return null;
    } 

    // PHONE NUMBER IS JUST A STRING AT THIS POINT, HOW DO I GET THE ENTITY?
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T23:06:38.330

您必须通过构造函数注入传递对象管理器，然后像往常一样对其进行操作。

```
class PhoneNumberTransformer implements DataTransformerInterface
{
    /**
     * @var ObjectManager
     */
    private $om;

    /**
     * @param ObjectManager $om
     */
    public function __construct(ObjectManager $om)
    {
        $this->om = $om;
    }

    public function transform($phonenumber)
    {
        if ($phonenumber === null) {
            return null;
        }

        return $phonenumber->__toString();
    }

    public function reverseTransform($phonenumber)
    {
        if (!$this->phonenumber) {
            return null;
        }

        $phoneEntity = $this->om
            ->getRepository('{REFERENCE_TO_THE_ENTITY}')
            ->findOneBy(array('phonenumber' => $phonenumber));

        if ($phoneEntity === null) {
            throw new TransformationFailedException();
        }

        return $phoneEntity;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T15:00:05.917

抱歉没有更新，但我找到了解决这个问题的好方法。我向**似乎在反向转换后自动调用的 PhoneNumber 实体添加了一个 setPhone 方法**。在我的转换器中，我添加了一个正则表达式来将我的电话号码分成各自的部分，然后将每个部分添加到一个数组中。这个数组由转换器返回，然后 setPhone 使用它来更新 PhoneNumber 对象。

**我在 PhoneNumber 实体中的 setPhone 方法：**

```
/**
 * Used by PhoneNumberToStringTransformer to set Entity data
 * @param array $phone_data
 */
public function setPhone($phone_data)
{
    if($phone_data == null) {
        $this->setAreaCode(null);
        $this->setExchange(null);
        $this->setSuffix(null);
        $this->setExtension(null);
        return $this;
    }

    $this->setAreaCode($phone_data['AreaCode']);
    $this->setExchange($phone_data['Exchange']);
    $this->setSuffix($phone_data['Suffix']);
    $this->setExtension($phone_data['Extension']);

    return $this;
} 
```

**我的 PhoneNumberToStringTransformer 中的 reverseTransform：**

```
/**
 * Transforms a phonenumber string to an array that will be passed to setPhone
 * which will handle setting each entity field.
 *
 * @param  string $string Phone number string
 * @return (array) areaCode, exchange, suffix and extension
 */
public function reverseTransform($string)
{
    if (!$string || strlen($string) == 0) {
        return null;
    }

    // Split phone number into array for areaCode, exchange, suffix, and extension
    $pattern = '/(\d{3})?-?(\d{3})?-?(\d{4})?( x(\d+))?/';
    preg_match_all($pattern, $string, $matches, PREG_PATTERN_ORDER);

    $phone_data = array('AreaCode'=>null, 'Exchange'=>null, 'Suffix'=>null, 'Extension'=>null);

    $counter = 1;
    foreach($phone_data as $key => $value) {
        if($counter == 4)
            $counter = 5;

        if(isset($matches[$counter][0]) && $matches[$counter][0] !== '') {
            $phone_data[$key] = $matches[$counter][0];
        } else {
            $phone_data[$key] = null;
        }
        $counter++;
    }

    return $phone_data;
} 
```

# php - PHP, Postgres 帮助使用 RETURNING

> ID：13070752
> 
> 赞同：11
> 
> 时间：2012-10-25T14:24:00.220
> 
> 标签：php, postgresql, sql-returning

我想我了解 PostgreSQL 和 RETURNING 的工作原理——我找到了很多很多资源。如果我赶上，它看起来像

```
"INSERT INTO table (column2, column3) VALUES ('value1', 'value2') RETURNING id;" 
```

但是，我找不到任何可以帮助我通过 PHP 访问它的东西。当我认为我想通了，我尝试了

```
$new_id = pg_query($dbc, "INSERT INTO table (column2, column3) ".
"VALUES ('value1', 'value2') RETURNING id;");
return $new_id; 
```

但它返回 NULL。我还尝试使用一个查询分别执行和声明变量。在寻找解决方案数小时后，我选择了 max(id) SELECT 语句/函数，但它仍然困扰着我。任何帮助是极大的赞赏。

我正在使用 Postgres 8.4 和 PHP 5.3。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-25T14:34:13.357

`$new_id`不包含 id 但它是一个资源描述符。您需要从中获取数据，因为查询将是一个 SELECT，`pg_fetch_array($new_id)`例如。

PostgreSQL的`RETURNING`子句投影插入或修改行的任何字段，即`INSERT|UPDATE … RETURNING id, field1, field2`.

# c++ - 如何防止期限计时器调用已删除类中的函数？

> ID：13070754
> 
> 赞同：7
> 
> 时间：2012-10-25T14:24:07.680
> 
> 标签：c++, boost-asio

我在一段实际代码中遇到问题，其中属于已删除类的函数由 a 调用`boost::asio::deadline_timer`，偶尔会导致分段错误。

我遇到的问题是，deadline_timer 的删除是从同一个 io_service 上的另一个计时器运行的。删除第一个`deadline_timer`将触发对要运行的函数的最终调用，但会出现`boost::asio::error::operation_aborted`错误。但是，这只能`io_service`在删除完成后（相同）安排，但到那时对象已经被删除，因此不再有效。

所以我的问题是：我怎样才能防止这种情况发生？

以下是具有相同故障的简化示例：

```
//============================================================================
// Name        : aTimeToKill.cpp
// Author      : Pelle
// Description : Delete an object using a timer, from a timer
//============================================================================

#include <iostream>
#include <boost/function.hpp>
#include <boost/bind.hpp>
#include <boost/asio.hpp>
#include <boost/thread.hpp>

using namespace std;
using namespace boost;

struct TimeBomb
{
    bool m_active;
    asio::deadline_timer m_runTimer;

    TimeBomb(boost::asio::io_service& ioService)
    : m_active(true)
    , m_runTimer(ioService)
    {
        cout << "Bomb placed @"<< hex << (int)this << endl;
        m_runTimer.expires_from_now(boost::posix_time::millisec(1000));
        m_runTimer.async_wait(boost::bind(&TimeBomb::executeStepFunction, this, _1));
    }

    ~TimeBomb()
    {
        m_active = false;
        m_runTimer.cancel();
        cout << "Bomb defused @"<< hex << (int)this << endl;
    }

    void executeStepFunction(const boost::system::error_code& error)
    {
        // Canceled timer
        if (error ==  boost::asio::error::operation_aborted)
        {
            std::cout << "Timer aborted: " << error.message() << " @" << std::hex << (int)this << std::endl;
            return;
        }
        if (m_active)
        {
            // Schedule next step
            cout << "tick .." <<endl;
            m_runTimer.expires_from_now(
                    boost::posix_time::millisec(1000));
            m_runTimer.async_wait(boost::bind(&TimeBomb::executeStepFunction, this, _1));
        }
    }
};

struct BomberMan
{
    asio::deadline_timer m_selfDestructTimer;
    TimeBomb* myBomb;

    BomberMan(boost::asio::io_service& ioService)
    : m_selfDestructTimer(ioService)
    {
        cout << "BomberMan ready " << endl;
        myBomb = new TimeBomb(ioService);
        m_selfDestructTimer.expires_from_now(boost::posix_time::millisec(10500));
        m_selfDestructTimer.async_wait(boost::bind(&BomberMan::defuseBomb, this, _1));
    }

    void defuseBomb(const boost::system::error_code& error)
    {
        cout << "Defusing TimeBomb" << endl;
        delete myBomb;
    }
};

int main()
{
    boost::asio::io_service m_ioService;
    BomberMan* b = new BomberMan(m_ioService);
    m_ioService.run();
    return 0;
}

./aTimeToKill
BomberMan ready 
Bomb placed @9c27198
tick ..
tick ..
tick ..
tick ..
tick ..
tick ..
tick ..
tick ..
tick ..
tick ..
Defusing TimeBomb
Bomb defused @9c27198
Timer aborted: Operation canceled @9c27198 
```

删除后打印最后一行，说明我的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:44:18.920

解决这个问题的典型方法是使用`shared_ptr`

```
#include <boost/asio.hpp>
#include <boost/bind.hpp>
#include <boost/enable_shared_from_this.hpp>
#include <boost/shared_ptr.hpp>

#include <iostream>

using namespace std;

struct TimeBomb : public boost::enable_shared_from_this<TimeBomb>
{
    bool m_active;
    boost::asio::deadline_timer m_runTimer;

    TimeBomb(boost::asio::io_service& ioService)
    : m_active(true)
    , m_runTimer(ioService)
    {
        cout << "Bomb placed @"<< hex << this << endl;
        m_runTimer.expires_from_now(boost::posix_time::millisec(1000));
    }

    void start()
    {
        m_runTimer.async_wait(boost::bind(&TimeBomb::executeStepFunction, shared_from_this(), _1));
    }

    void stop()
    {
        m_runTimer.cancel();
    }

    ~TimeBomb()
    {
        m_active = false;
        m_runTimer.cancel();
        cout << "Bomb defused @"<< hex << this << endl;
    }

    void executeStepFunction(const boost::system::error_code& error)
    {
        // Canceled timer
        if (error ==  boost::asio::error::operation_aborted)
        {
            std::cout << "Timer aborted: " << error.message() << " @" << std::hex << this << std::endl;
            return;
        }
        if (m_active)
        {
            // Schedule next step
            cout << "tick .." <<endl;
            m_runTimer.expires_from_now(
                    boost::posix_time::millisec(1000));
            m_runTimer.async_wait(boost::bind(&TimeBomb::executeStepFunction, shared_from_this(), _1));
        }
    }
};

struct BomberMan
{
    boost::asio::deadline_timer m_selfDestructTimer;
    boost::shared_ptr<TimeBomb> myBomb;

    BomberMan(boost::asio::io_service& ioService)
    : m_selfDestructTimer(ioService)
    {
        cout << "BomberMan ready " << endl;
        myBomb.reset( new TimeBomb(ioService) );
        myBomb->start();
        m_selfDestructTimer.expires_from_now(boost::posix_time::millisec(10500));
        m_selfDestructTimer.async_wait(boost::bind(&BomberMan::defuseBomb, this, _1));
    }

    void defuseBomb(const boost::system::error_code& error)
    {
        cout << "Defusing TimeBomb" << endl;
        myBomb->stop();
    }
};

int main()
{
    boost::asio::io_service m_ioService;
    BomberMan* b = new BomberMan(m_ioService);
    m_ioService.run();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:38:55.333

这就是为什么你有`boost::shared_ptr`和`boost::enable_shared_from_this`。像这样继承`TimeBomb`类`boost::enable_shared_from_this`：

```
struct TimeBomb : public boost::enable_shared_from_this< TimeBomb >
{
...
} 
```

实例化一个共享 ptr 而不是裸 ptr：

```
boost::shared_ptr< TimeBomb > myBomb;
...
myBomb.reset( new TimeBomb(ioService) ); 
```

最后在`TimeBomb`使用`shared_from_this()`而不是`this`构造处理程序。

```
m_runTimer.async_wait( boost::bind( &TimeBomb::executeStepFunction, shared_from_this(), _1)); 
```

当然，`TimeBomb`类应该公开一个`cancel`方法，通过它您可以取消异步操作，而不是通过删除，或者在这种情况下，重置 shared_ptr。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:18:09.823

来自 Sam Miller 的 shared_ptr 答案有效，因为 shared_ptr 的使用使 TimeBomb 在 BomberMan 的整个生命周期中一直存在。这对你来说可能没问题，也可能不是。

一个更完整的解决方案的建议是从工厂获取 TimeBomb 实例，然后在完成后将它们释放回，而不是显式地更新和删除它们（将它们作为标准指针，而不是 shared_ptrs 因为你不拥有它们即使您正在控制生命周期）。工厂可以保留它们，直到它们被取消，然后为您删除它们。保持 Sam Miller 的 stop() 函数不变。

为了实现这一点，从接口派生工厂

```
class ITimeBombObserver 
{
public:
    virtual void AllOperationsComplete(TimeBomb& TmBmb)=0;
}; 
```

将您的工厂作为 ITimeBombObserver 传递给每个 TimeBomb 构造，并取消 TimeBomb 调用此函数。工厂可以在每次创建或释放 TimeBomb 时清理“使用过的”TimeBomb，或者使用计划清理或其他方法，无论哪种方法最适合您的应用程序。

使用此方法，您的 BomberMan 甚至不需要在 defuseBomb() 中显式释放 TimeBomb，如果不需要，对 stop() 的调用可以自动释放（尽管在这种情况下，您仍然应该将指针设为空，因为它变得有效此时无法使用）。这是否是一个好主意取决于您的实际问题，因此我将由您决定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T11:43:55.750

对于一个非常简单的修复，这个怎么样？（我只包含了您需要更改的部分）

它之所以有效，是因为您只能在计时器取消时访问堆栈变量。当然，您根本不需要在析构函数中回调处理程序，但我假设您的真实代码出于任何原因都需要这样做。

```
~TimeBomb()
{
    m_active = false;
    executeStepFunction(boost::asio::error::interrupted);
    m_runTimer.cancel();
    cout << "Bomb defused @"<< hex << (int)this << endl;
}

void executeStepFunction(const boost::system::error_code& error)
{
    // Canceled timer
    if (error ==  boost::asio::error::operation_aborted)
    {
        return;
    }
    if (error ==  boost::asio::error::interrupted)
    {
        std::cout << "Timer aborted: " << error.message() << " @" << std::hex << (int)this << std::endl;
        return;
    }
... 
```

# ios - 使ios在进入后台之前等待工作完成

> ID：13070755
> 
> 赞同：0
> 
> 时间：2012-10-25T14:24:09.980
> 
> 标签：ios, cocoa-touch, background

如何告诉 ios 在进入后台模式之前等待一些工作完成？我在 Appdelegate 上尝试了 ApplicationWillResignActive 方法，并在那里放置了一些正在打印虚拟数据的循环，但什么也没发生，数据正在后台模式下打印。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:27:15.737

简单的答案是——你不能。您不能阻止进入后台。您能做的最好的事情就是在特定的有限时间内开始一项工作，但它是在后台完成的。无法阻止应用程序退出活动。

# java - 在 OSGi 中跟踪特定的 Bundle

> ID：13070757
> 
> 赞同：-1
> 
> 时间：2012-10-25T14:24:18.250
> 
> 标签：java, osgi

我是使用 OSGi 的新手，我对跟踪 Bundles 有疑问。我使用 BundleTracker 是因为我想要特定的捆绑包，并且我想通过他们的 ID 知道我正在使用哪个捆绑包。一些 Bundles (3) 实现了相同的接口。我只想跟踪那些实现该接口的包。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T20:19:47.027

如果要选择特定服务，可以使用服务属性。这与捆绑包完全无关。这意味着您使用特定属性注册您的服务实现（这就是`Dictionary`-argument 的[`BundleContext.registerService`](http://www.osgi.org/javadoc/r4v43/core/org/osgi/framework/BundleContext.html#registerService%28java.lang.Class,%20S,%20java.util.Dictionary%29)用途）。

然后，您可以使用[`BundleContext.getServiceReferences`](http://www.osgi.org/javadoc/r4v43/core/org/osgi/framework/BundleContext.html#getServiceReferences%28java.lang.Class,%20java.lang.String%29)并指定仅选择具有正确属性的服务的过滤器表达式（语法[在此处描述）。](http://www.osgi.org/javadoc/r4v43/core/org/osgi/framework/Filter.html)您可以进行设置，以便始终获得最多包含一个元素的数组或集合。

[如果您使用声明式服务](http://wiki.osgi.org/wiki/Declarative_Services)，这一切都会变得容易得多，因为您可以分别在提供和消费组件的服务描述符中指定属性和过滤器。[您还可以通过配置管理员](http://www.osgi.org/javadoc/r4v42/org/osgi/service/cm/ConfigurationAdmin.html)使其一端或两端可配置（服务组件配置中的属性作为公开服务或消费引用的属性传播）。我真的建议您在开始任何严肃的 OSGi 工作之前检查声明式服务。

请注意，您应该小心不要以这种方式实现硬编码接线，因为这会破坏模块化。

# php - Python/PHP - 下载和安装 AWS API

> ID：13070759
> 
> 赞同：0
> 
> 时间：2012-10-25T14:24:22.353
> 
> 标签：php, python

有没有办法在运行时从 PHP 或 Python 脚本动态下载和安装像 AWS API 这样的包？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:26:48.743

不是在运行时 - 由于涉及的开销和下载失败的风险，这没有任何意义。

# visual-studio - 强制在 Visual Studio 2012 中重建项目依赖关系

> ID：13070760
> 
> 赞同：7
> 
> 时间：2012-10-25T14:24:29.063
> 
> 标签：visual-studio, msbuild, visual-studio-2012

我最近升级到 VS.NET 2012 并且在调试时开始遇到一个非常令人沮丧的问题。

项目 A 有对项目 B 的项目引用。当我编辑项目 B 时，我希望构建/调试项目 A 的操作能够检测项目 B 中的更改并在项目 A 的构建过程中自动包含它。（这有点意思项目依赖关系。）这正是 VS 2010 中过去发生的事情。

但这在 2012 年不会发生。事实上，即使我明确地构建项目 B，项目 A 也不会接受这种变化，除非我*重建*项目 A。

所以现在我不得不显式地构建项目 B，然后返回到项目 A 并显式地重建它，以便将项目 B 中的修改包括在内。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T11:33:30.230

您是否在解决方案中设置了依赖项项目？

我们可以从以下位置设置它们：

右键解决方案->属性->项目依赖

顺便问一下，您是在 Visual Studio IDE 中还是通过 msbuild 命令构建了您的解决方案？

如果您使用 msbuild 构建项目，则应在项目文件中添加 DependsOnTargets 属性。

更多信息您可以参考：

[http://msdn.microsoft.com/en-us/library/ms366724.aspx](http://msdn.microsoft.com/en-us/library/ms366724.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T17:18:22.073

您的第 3 段似乎表明对依赖项的工作方式存在误解。如果我弄错了，请原谅我。

如果项目 A 依赖于项目 B，则构建项目 B 不会强制重新构建项目 A。但是，构建项目 A 应检查项目 B 中的更改并在需要时自动重新构建 B。

在这种情况下，项目 A 是父项目或根项目。构建父级将检查它所依赖的所有项目，如果它们已过时，则重新构建它们。始终构建父项目将首先自动构建过时的依赖项，然后构建父项目以获取依赖项中的任何新更改。

```
A
 \
  B
  |\
  C D 
```

在这个例子中，如果 B 有依赖关系，它们也会被构建。如果你显式地构建了 B，它的依赖项 C 和 D 将被检查并重建，而不是 A。

如果您显式构建 A，则首先检查并重建 C 和 D（如有必要），然后是 B，最后是 A。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-23T16:47:15.267

我之前也遇到过类似的问题，原因是 A 对 B 的引用是常规引用（对 DLL 文件），而不是“项目引用”。这种情况肯定会解释你看到的行为。

要检查，请在`ProjectA.csproj`文本编辑器中查看，并检查所有`<Reference>`和`<ProjectReference>`元素以确保它们是您认为应该的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T19:35:49.950

我认为您正在寻找持续集成 (CI) 服务器。可以将 CI 配置为监视源存储库并在向代码库提交新更改时触发以构建目标程序集。

否则，正如其他人所提到的，项目依赖项可用于重建引用的程序集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-26T18:53:19.080

造成这种情况的一个潜在原因是 .suo 文件被锁定。请参阅我对这个问题的回答：

[Visual Studio 2012 不构建依赖项目](https://stackoverflow.com/questions/11064345/visual-studio-2012-not-building-dependent-projects/13571220#13571220)

# c# - 识别 CheckedListBox 项目已被选中

> ID：13070762
> 
> 赞同：5
> 
> 时间：2012-10-25T14:24:33.057
> 
> 标签：c#, winforms, checkedlistbox, selectedindexchanged

直到现在我才处理过checkedListBox1。我想制作的程序将受益于使用它，而不是必须使用大量的复选框。

我有代码：

```
private void checkedListBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    int selected = checkedListBox1.SelectedIndex;
    this.Text = checkedListBox1.Items[selected].ToString();
} 
```

这样做的问题是，每次我单击该框并突出显示时，它都会选择突出显示的对象。我正在寻找的是识别所选内容的变化，而不是突出显示。

我还想知道的是，如果 CheckListBox 中的第一个索引项以及第三个被选中，我将如何检查它是否正确？

我敢肯定我最终会弄明白的，但是看到代码会有很大帮助。

假设我有 3 个盒子： Box A = messageBox.Show("a"); 框 B = messageBox.Show("b"); 框 C = messageBox.Show("c");

如果选中该框，它将仅显示 mbox。我想知道的是如何让它检查例如是否检查了 A 和 C，以便如果我按下按钮，两个消息框将显示“a”然后显示“c”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T14:54:11.727

```
 private void checkedListBox1_ItemCheck(object sender, ItemCheckEventArgs e)
    {
        // a checkbox is changing
        // but value is not updated yet

    }

    private void checkedListBox1_MouseUp(object sender, MouseEventArgs e)
    {
        Debug.WriteLine(checkedListBox1.CheckedItems.Count);
        Debug.WriteLine(checkedListBox1.CheckedItems.Contains(checkedListBox1.Items[0]));
    } 
```

我认为您应该在 MouseUp 中检查是否检查了第一个。_ItemCheck 用于复选框正在更改但值尚未更新时。

请参阅参考：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.checkedlistbox.items.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkedlistbox.items.aspx)

```
 // First show the index and check state of all selected items. 
foreach(int indexChecked in checkedListBox1.CheckedIndices) {
    // The indexChecked variable contains the index of the item.
    MessageBox.Show("Index#: " + indexChecked.ToString() + ", is checked. Checked state is:" +
                    checkedListBox1.GetItemCheckState(indexChecked).ToString() + ".");
}

// Next show the object title and check state for each item selected. 
foreach(object itemChecked in checkedListBox1.CheckedItems) {

    // Use the IndexOf method to get the index of an item.
    MessageBox.Show("Item with title: \"" + itemChecked.ToString() + 
                    "\", is checked. Checked state is: " + 
                    checkedListBox1.GetItemCheckState(checkedListBox1.Items.IndexOf(itemChecked)).ToString() + ".");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-25T02:01:52.947

如果要获取所有选中项的集合，请使用 checkedListBox1.CheckedItems。要在单击按钮时显示所有选中的项目，请使用以下命令：

```
private void button1_Click(object sender, EventArgs e)
{
    for (int i = 0; i < checkedListBox1.CheckedItems.Count; i++)
        MessageBox.Show(checkedListBox1.CheckedItems[i].ToString());
} 
```

如果您只需要它们的索引，请改用checkedListBox1.CheckedIndices。

# vba - excel根据当前日期自动填充日期

> ID：13070763
> 
> 赞同：3
> 
> 时间：2012-10-25T14:24:33.227
> 
> 标签：vba, excel

我需要用日期自动填充特定列。如果日期发生在星期六到星期二之间，我需要用上一个星期五自动填充日期列。如果日期发生在周三和周五之间，我需要输入即将到来的周五日期以进行自动填充。

例如：如果我在 10 月 23 日星期二运行电子表格，我需要将自动填充日期设置为 10 月 19 日星期五。如果我在 10 月 24 日星期三运行电子表格，我需要自动填充日期为 10 月 26 日星期五。

这是我到目前为止的公式，所以我需要在保存电子表格或单击自定义按钮时通过宏调用此公式。任何帮助将不胜感激。

```
=IF(ISBLANK($A2),"",IF(WEEKDAY(TODAY())<4,(TODAY()+(-1-WEEKDAY(TODAY()))),(TODAY()+(6-WEEKDAY(TODAY()))))) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:35:17.603

我建议您使用 VBA 来满足您的需求，类似这样的东西将进入 ThisWorkbook 模块并在工作簿保存之前运行：

```
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    'Check if A2 is blank
    If Cells(2, 1) = "" Then Exit Sub
    'Find the date and use it
    Dim x As Long
    Dim dateToUse As Date
    x = Weekday(Date, vbSaturday)
    If x <= 4 Then
        dateToUse = Date - x
    Else
        dateToUse = Date + (7 - x)
    End If
    'Change Cells(1, 1) to the actual target you want to have the date, 
    'which could be determined based upon the contents of your workbook/sheet.
    Cells(1, 1) = dateToUse
End Sub 
```

# google-apps-script - 如何强制可安装的时间驱动触发器仅在打开文档时运行

> ID：13070765
> 
> 赞同：1
> 
> 时间：2012-10-25T14:24:33.680
> 
> 标签：google-apps-script

我最近创建了一个与电子表格关联的脚本。它是一个木材供应链模拟游戏得分查看器。基本上，它获取（使用 Urlfetch）游戏数据库，以跟踪每个团队在表格和图表中的得分。然后将电子表格共享给每个团队成员，他们可以看到游戏的进展情况。

因此，我使用了一个可安装的 onMinute 时间触发器来使用来自数据库的更新分数来刷新电子表格。一切都在工作，但最近，我开始收到 app-script-notifications of failure with error ：

> 一天服务调用次数过多：urlfetch。

然后我意识到，可安装的触发器是在文档未打开时执行的，这完全是逻辑。此外，由于开发模式，我有相当多的电子表格副本（je comprend pas sa），这解释了我的配额范围。尽管如此，我只需要在文档打开时刷新我的应用程序的分数。

这是我的问题：

1.  可安装的 onMinute 时间触发器是正确的方法吗？
2.  有没有办法让触发器仅在文档打开时运行？

这是我在这里的第一个问题，所以请随时发表有用的评论，让我改进。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T19:33:28.250

这是我想的一段代码，它可能会做你想做的事，或者至少可以接近......

我[在测试表上](https://docs.google.com/spreadsheet/ccc?key=0AnqSFd3iikE3dG90MzRwX0FQUnoxTWZjcmtLSlVuT3c#gid=1)尝试了它（与请求授权共享），它按预期工作，即定时器触发函数仅在有人正在编辑电子表格时执行，否则它会返回。假设这是一个提案，你会告诉我它是否符合你的要求;-)

```
function onTimer() { // this function has a timer trigger set to 1 minute
  var ss = SpreadsheetApp.openById('0AnqSFd3iikE3dG90MzRwX0FQUnoxTWZjcmtLSlVuT3c')
  var sh = ss.getSheets()[0]
  var logsheet = ss.getSheets()[1]
  var formerUser = ScriptProperties.getProperty('lastUser')
   if(formerUser=='nobody'){return}
     ss.toast('The sheet is being edited by '+Session.getActiveUser());
     ScriptProperties.setProperties({'lastUser': 'nobody'}, true); 
     logsheet.getRange(logsheet.getLastRow()+1, 1).setValue('onTimer function was running on '+
     Utilities.formatDate(new Date(),'GMT+2','HH:mm'))
}

function onUserPresent(){ // this one has an onEdit installable trigger
 ScriptProperties.setProperties({'lastUser': 'someone'}, true);   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T18:58:23.677

除非您可以在游戏端编写代码以将更改推送到电子表格，这将在双方使用更少的资源，否则时间驱动的触发器似乎是唯一的“自动”方式。

我说自动，因为您可以将其更改为“按需”。我的意思是，您可以在电子表格或图像中添加一个菜单（您可以在其中分配以在单击时运行脚本），这将更新分数。

这也可以是半动态的，例如，当用户单击按钮时，您开始在接下来的 30 分钟左右自动更新分数（以编程方式设置时间驱动的触发器）。

问你的问题 n.2：不，这是不可能的。嗯，只是中途。因为您可以检测电子表格何时打开（通过设置打开触发器），但您无法知道它何时关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T08:01:12.180

如何使用 onOpen 事件以编程方式创建以下内容：

*   每分钟更新电子表格的新触发器
*   一个新的每小时触发器，用于检查

    ```
    if {a user property is set} 
    then deletes all the triggers 
    else set the user property 
    ```

*   取消设置前面提到的用户属性的 onEdit 触发器

因此，如果用户一个小时没有编辑电子表格，所有触发器都会停止
。这有点令人费解，但没有 onClose 事件，令人费解的是您所希望的最好的。

# android - android 上 setBackgroundDrawable 的解决方法？

> ID：13070766
> 
> 赞同：5
> 
> 时间：2012-10-25T14:24:53.733
> 
> 标签：android

类的`setBackgroundDrawable()`方法`View`现在在 android SDK API 级别 16 中已弃用。

新方法`setBackground()`当然只在 API 16 中可用。

如果我希望我的应用程序与以前的 API 级别兼容，我该如何解决它？（至少 API 14）

目标是消除任何警告，@SupressWarnings 对我来说不是解决方案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-25T14:27:17.807

通常的方法是这样的：

```
if (android.os.Build.VERSION.SDK_INT >= 16)
  setBackground(...);
else
  setBackgroundDrawable(...); 
```

另一方面，您可以使用反射：

```
try {
  Method setBackground = View.class.getMethod("setBackground", Drawable.class);
  setBackground.invoke(myView, myDrawable);
} catch (NoSuchMethodException e) {
  setBackgroundDrawable(myDrawable);
} 
```

IMO 发出警告比必须捕获异常和不必要的反思要好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-20T16:12:13.630

您可以使用

```
viewobj.setBackgroundResource(drawble_object); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-30T15:39:01.643

将位图设置为 ImageView。

ImageView imageView = (ImageView) findViewById(R.id.imageSlice4); imageSlice4.setBackground(new BitmapDrawable(getResources(), slicedImagesArrayList.get(3)));

# web-applications - Firefox Web 应用程序：控制加载屏幕的持续时间

> ID：13070767
> 
> 赞同：1
> 
> 时间：2012-10-25T14:24:53.563
> 
> 标签：web-applications, usability, gecko, firefox-os

我使用 Firefox Aurora 在 Android 设备上测试安装了一个 Web 应用程序。用户在启动过程中看到的内容：

1.  加载屏幕1：应用程序的图标加上加载器动画（绿色圆圈）。

2.  加载画面2：App自己的加载画面（黑色背景上的微调器），表示初始化。

3.  该应用程序，准备使用。

是否可以摆脱第二个加载屏幕？

换句话说：我能以某种方式控制第一个加载屏幕出现多长时间吗？

*注意*：当然，我不想完全摆脱应用程序自己的加载屏幕。在普通浏览器上是必需的，否则用户可能会看到应用程序处于未初始化状态。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T17:31:07.950

目前无法控制第一个加载屏幕的持续时间或内容。[但是，已经提交了](https://bugzilla.mozilla.org/show_bug.cgi?id=805845)一个错误，您可以在那里跟踪任何进一步的进展。

您必须在短期内解决这个问题，已经提出的两个解决方案是：

*   使您的第二个加载屏幕看起来像您的应用程序本身，即使它不会响应（例如：您的应用程序最后状态的屏幕截图）。这个技巧在移动应用程序中被广泛使用。

*   使您的第二个加载屏幕看起来像第一个加载屏幕。背景颜色应该始终是可预测的，如果不是，请提交错误！

# android - Android Wi-Fi Direct：onPeersAvailable

> ID：13070768
> 
> 赞同：7
> 
> 时间：2012-10-25T14:24:59.173
> 
> 标签：android, wifi-direct

我正在开发一个基于 WiFi Direct for Android 的简单应用程序，它必须连接两个设备。为此，我需要调用函数 onPeersAvailable(myPeerListListener)，但我不知道怎么做。

我的应用程序有这两个元素：

1-主要活动：

```
package android.nacho.WifiDirect;

import android.net.wifi.p2p.WifiP2pManager.Channel;

import android.net.wifi.p2p.WifiP2pManager;
import android.os.Bundle;
import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class WifiDirect extends Activity {

    WifiP2pManager mManager;
    Channel mChannel;
    BroadcastReceiver mReceiver;

    IntentFilter mIntentFilter;

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_wifi_direct);

        //To register the BroadastReceiver
        mManager = (WifiP2pManager) getSystemService(Context.WIFI_P2P_SERVICE);
        mChannel =   mManager.initialize(this, getMainLooper(), null); //It was necessary to make a cast (Channel)
        mReceiver = new WiFiBroadcastReceiver(mManager, mChannel, this); //, this);

        //Layout
        final Button btnScan = (Button)findViewById(R.id.btnScan); 
        final TextView TextDebug=(TextView)findViewById(R.id.TextDebug);

        //To define the filter in the BroadcastReceiver
        mIntentFilter = new IntentFilter();
        mIntentFilter.addAction(WifiP2pManager.WIFI_P2P_STATE_CHANGED_ACTION);
        mIntentFilter.addAction(WifiP2pManager.WIFI_P2P_PEERS_CHANGED_ACTION);
        mIntentFilter.addAction(WifiP2pManager.WIFI_P2P_CONNECTION_CHANGED_ACTION);
        mIntentFilter.addAction(WifiP2pManager.WIFI_P2P_THIS_DEVICE_CHANGED_ACTION);

        final OnClickListener ScanListener=new OnClickListener() //Sacado de TEstPsycologico
        {
            public void onClick(View v){

                TextDebug.setText("Se intentan buscar Peers");

                mManager.discoverPeers(mChannel, new WifiP2pManager.ActionListener() {

                    public void onSuccess() {

                        TextDebug.setText("Ha habido éxito buscando Peers");//DEBUG: Para ver si es posible encontrar Peers

                    }

                    public void onFailure(int reasonCode) {

                        TextDebug.setText("Algo ha salido mal buscando Peers"); //DEBUG: Para ver si pasó algo raro busando Peers
                    }
                });

                onPeersAvailable(myPeerListListener);

            }

        };

        btnScan.setOnClickListener(ScanListener);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_wifi_direct, menu);
        return true;
    }

    //

    @Override
    protected void onResume() {
        super.onResume();
        registerReceiver(mReceiver, mIntentFilter);
    }

   // unregister the broadcast receiver
    @Override
    protected void onPause() {
        super.onPause();
        unregisterReceiver(mReceiver);
    }

} 
```

2类广播接收器：

```
package android.nacho.WifiDirect;

import android.net.wifi.p2p.WifiP2pManager.Channel;
import android.net.wifi.p2p.WifiP2pManager.PeerListListener;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.net.wifi.p2p.WifiP2pManager;
import android.widget.Toast;

/**
 * A BroadcastReceiver that notifies of important Wi-Fi p2p events.
 */

public class WiFiBroadcastReceiver extends BroadcastReceiver {

    private WifiP2pManager manager;
    private Channel channel;
    private WifiDirect activity;
    private PeerListListener myPeerListListener;

    //For toast, add also context
    //private Context context;

    public WiFiBroadcastReceiver(WifiP2pManager manager, Channel channel, WifiDirect activity){//, Context context) {

        super();
        this.manager = manager;
        this.channel = channel;
        this.activity = activity;
       // this.context= context;
    }

    @Override
    public void onReceive(Context context, Intent intent) {

        String action = intent.getAction();     

        if (WifiP2pManager.WIFI_P2P_STATE_CHANGED_ACTION.equals(action)) {

            // Check to see if Wi-Fi is enabled and notify appropriate activity
             int state = intent.getIntExtra(WifiP2pManager.EXTRA_WIFI_STATE, -1);
             if (state == WifiP2pManager.WIFI_P2P_STATE_ENABLED) {

                //Toast.makeText(context, "Wi-Fi Direct is enable", Toast.LENGTH_LONG).show();

             } else {

                //Toast.makeText(context, "Wi-Fi Direct is not enable", Toast.LENGTH_LONG).show();
             }      

        } else if (WifiP2pManager.WIFI_P2P_PEERS_CHANGED_ACTION.equals(action)) {
            // Call WifiP2pManager.requestPeers() to get a list of current peers

             // request available peers from the wifi p2p manager. This is an
            // asynchronous call and the calling activity is notified with a
            // callback on PeerListListener.onPeersAvailable()
            if (manager != null) {
                 manager.requestPeers(channel, myPeerListListener);
                 manager.onPeersAvailable(myPeerListListener);

            }

        } else if (WifiP2pManager.WIFI_P2P_CONNECTION_CHANGED_ACTION.equals(action)) {
            // Respond to new connection or disconnections
        } else if (WifiP2pManager.WIFI_P2P_THIS_DEVICE_CHANGED_ACTION.equals(action)) {
            // Respond to this device's wifi state changing
        }
    }
} 
```

到目前为止，我的代码应该能够检测到运行应用程序的设备周围的对等点，该 ID 应该存储在变量**myPeerListListener**中。所有这些都发生在称为 OnReceiv() 的 BroadcastReceiver 方法的第二个意图中，方法是调用：

```
 manager.requestPeers(channel, myPeerListListener); 
```

现在我想操作那个列表。因此，按照它应该调用 requestPeers 的 API 信息，您可以在此处查看 API：

[http://developer.android.com/guide/topics/connectivity/wifip2p.html](http://developer.android.com/guide/topics/connectivity/wifip2p.html)

*部分**发现同行**

所以我尝试在下面写一个调用：

```
manager.onPeersAvailable(myPeerListListener); 
```

但我收到此错误：

**WifiP2pManager 类型的 onPeersAvailable(WifiP2pManager.PeerListListener) 方法未定义**

谁能告诉我如何正确地将 PeerListListener 发送到主要活动？

非常感谢您的宝贵时间

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-03-22T10:34:03.360

[dtheo](https://stackoverflow.com/users/1805018/dtheo)已回答并指向关于此主题的不错的 Android 教程。我将仅对 OP 的代码进行更改，以展示如何实现所请求的功能。

根据[这里](http://developer.android.com/training/connect-devices-wirelessly/wifi-direct.html#fetch)的官方Android指南，wifip2p发现api应该这样使用：

在您的 MainActivity 类中：

```
mManager.discoverPeers(mChannel, new WifiP2pManager.ActionListener() {
    public void onSuccess() {
        TextDebug.setText("Ha habido éxito buscando Peers");
    }

    public void onFailure(int reasonCode) {
        TextDebug.setText("Algo ha salido mal buscando Peers");
    }
});

// ############# DELETE THE FOLLOWING LINE #############
onPeersAvailable(myPeerListListener); // <<<<<<< DELETE THIS LINE 
```

在您的 BroadcastReceiver 类中，改为执行以下操作：

```
@Override
public void onReceive(Context context, Intent intent) {
    ...    
    if (WifiP2pManager.WIFI_P2P_STATE_CHANGED_ACTION.equals(action)) {
        ...
    } else if (WifiP2pManager.WIFI_P2P_PEERS_CHANGED_ACTION.equals(action)) {
        if (manager != null) {
            manager.requestPeers(channel, new WifiP2pManager.PeerListListener() {
            @Override
            public void onPeersAvailable(WifiP2pDeviceList peers) {
                Log.d(TAG,String.format("PeerListListener: %d peers available, updating device list", peers.getDeviceList().size()));

                // DO WHATEVER YOU WANT HERE
                // YOU CAN GET ACCESS TO ALL THE DEVICES YOU FOUND FROM peers OBJECT

            }
        });
        }
    } else if (WifiP2pManager.WIFI_P2P_CONNECTION_CHANGED_ACTION.equals(action)) {
        // Respond to new connection or disconnections
    } else if (WifiP2pManager.WIFI_P2P_THIS_DEVICE_CHANGED_ACTION.equals(action)) {
        // Respond to this device's wifi state changing
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-11-04T09:12:55.347

dtheo 已经回答了这个问题。

我想补充一点：对于 Wi-Fi Direct，两个设备需要同时扫描才能发现对方。还有一个扫描超时，这意味着一段时间后可能会丢失可发现性。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-07T04:16:39.113

您应该在 PeerListListener 中实现 onPeersAvailable 方法。

请参阅[http://developer.android.com/training/connect-devices-wireless/wifi-direct.html](http://developer.android.com/training/connect-devices-wirelessly/wifi-direct.html)了解更多信息。

# vbscript - VBscript 无法运行 Shell 命令

> ID：13070779
> 
> 赞同：0
> 
> 时间：2012-10-25T14:25:24.170
> 
> 标签：vbscript, wsh

我已经设置了以下 Sub 来快速轻松地运行 shell 命令。该脚本适用于我公司的登录脚本，不会失败。我目前正在开发一个脚本来将大量用户添加到我们的域中。当我在我的新脚本中使用这个 Sub 时，我收到一条错误消息，指出找不到该文件。我曾尝试使用此 stackoverflow 帖子中的修复程序，但即使使用此代码，我也会收到相同的错误。 [VBScript WScript.Shell Run() - 系统找不到指定的文件](https://stackoverflow.com/questions/9432901/vbscript-wscript-shell-run-the-system-cannot-find-the-file-specified)

我觉得令人费解的是，当从我们的域控制器的 netlogon 文件夹运行时，这个 sub 工作得很好。我究竟做错了什么？

谢谢，

```
Sub runcommand(strCommand)
Dim objWshShell, intRC
set objWshShell = WScript.CreateObject("WScript.Shell")
intRC = objWshShell.Run(strCommand, 0, TRUE)
call reportError(intRC,strCommand)
set objWshShell = nothing 
end Sub

function reportError(intRC, command)
if intRC <> 0 then 
 WScript.Echo "Error Code: " & intRC 
 WScript.Echo "Command: " & command 
end if
end function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T07:18:10.420

strCommand 的先前值没有空格并且非常简单。您的新脚本将更复杂的变量传递给您的 Sub，因此您需要额外的条件处理，正如 Alex K. 在上面的共谋（即“评论/解决方案”）中指出的那样。上面 Alex K. 的示例非常完美，因此，今晚作为点皮条客，将其作为解决方案发布：

```
objWshShell.Run("cmd /k echo Hello World", 1, TRUE) 
```

# php - mysql_real_escape_string() 的问题

> ID：13070781
> 
> 赞同：1
> 
> 时间：2012-10-25T14:25:32.890
> 
> 标签：php, mysql, string, escaping

几天前我开始学习编码，我遇到了 mysql_real_escape_string 的一些问题，特别是 login.php。

错误消息：

```
Warning: mysql_real_escape_string() [function.mysql-real-escape-string]: Access denied for user 'elegant'@'localhost' (using password: NO) in /home/elegant/public_html/php/login.php on line 3

Warning: mysql_real_escape_string() [function.mysql-real-escape-string]: A link to the     server could not be established in /home/elegant/public_html/php/login.php on line 3

Warning: mysql_real_escape_string() [function.mysql-real-escape-string]: Access denied for user 'elegant'@'localhost' (using password: NO) in /home/elegant/public_html/php/login.php on line 4

Warning: mysql_real_escape_string() [function.mysql-real-escape-string]: A link to the server could not be established in /home/elegant/public_html/php/login.php on line 4
Please enter a username and a password 
```

这是我到目前为止的代码——这段代码在 localhost 中工作，但是一旦我把它放到网上并导入数据库表，它给了我一些问题：

```
<?php

$username = mysql_real_escape_string($_POST['username']);
$password = mysql_real_escape_string($_POST['password']);

if ($username&&$password)

{

$connect = mysql_connect("localhost","elegant_root","password;1") or die("Couldn't             connect!");
mysql_select_db("elegant_ezworkstation") or die("Couldn't find database");

$query = mysql_query("SELECT * FROM users WHERE username=$username");

$numrows = mysql_numrows($query);

if ($numrows!=0)
{

while ($row = mysql_fetch_assoc($query))
{

    $dbusername = $row['username'];
    $dbpassword = $row['password'];

}

if ($username==$dbusername&&$password==$dbpassword)
{

    echo "You're in";

}
else
    echo "Incorrect password!";

}
else
die("That user doesn't exist");

}

else
die("Please enter a username and a password");

?> 
```

编辑：我更改为 mysqli，但出现以下错误：

```
Warning: mysqli_real_escape_string() expects exactly 2 parameters, 1 given in /home/elegant/public_html/php/login.php on line 3

Warning: mysqli_real_escape_string() expects exactly 2 parameters, 1 given in /home/elegant/public_html/php/login.php on line 4 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:30:33.110

`mysql_real_escape_string()`连接到数据库后放置将正常工作。

但是，您应该转向 mysqli 或 PDO。MySQL 现在已弃用。几个链接可以帮助你

1.  [从 mysql 迁移到 mysqli 或 pdo？](https://stackoverflow.com/questions/770782/moving-from-mysql-to-mysqli-or-pdo)
2.  [mysqli 或 PDO - 有什么优点和缺点？](https://stackoverflow.com/questions/13569/mysqli-or-pdo-what-are-the-pros-and-cons)

mysqli 和 PDO 中用于转义的等效命令分别是`mysqli_real_escape_string()`和`PDO::quote()`。

正如人们所指出的，PDO 绝对是更好的选择。这是我之前写的将 PDO 与其他人进行比较的答案。

[PDO - 真实的事实和最佳实践？](https://stackoverflow.com/questions/11277675/pdo-real-facts-and-best-practice/11277786#11277786)

这样做的另一个好处是，如果您使用带有命名参数的准备好的语句，则不需要使用转义函数。

# php - jaxl 返回到调用它的函数

> ID：13070783
> 
> 赞同：4
> 
> 时间：2012-10-25T14:25:36.667
> 
> 标签：php, xmpp, xmpphp

我有使用 jaxl 库的 xmpp 事务库：

```
 class xmpp{

        public function register_user($username, $password){
            require_once 'JAXL/jaxl.php';

            $this->client = new JAXL(array(
                'jid' => 'localhost',
                'log_level' => JAXL_ERROR
            ));         
            $this->username = $username;
            $this->password = $password;

            $this->client->require_xep(array(
                '0077'  // InBand Registration  
            ));     
            $thisClassObject =& $this;

            $this->client->add_cb('on_stream_features', function($stanza) use(&$thisClassObject) {
                $thisClassObject->client->xeps['0077']->get_form('localhost');
                return array($thisClassObject, 'wait_for_register_form');
            });

            $this->client->start();     

            return;
        }

        public function wait_for_register_response($event, $args) {

           if($event == 'end_stream') {
                return;
            }
            else if($event == 'stanza_cb') {
                $stanza = $args[0];
               if($stanza->name == 'iq') {
                if($stanza->attrs['type'] == 'result') {
                    echo "registration successful".PHP_EOL."shutting down...".PHP_EOL;
                    $this->client->end_stream();
                    return 'logged_out';
                }
                else if($stanza->attrs['type'] == 'error') {
                    $error = $stanza->exists('error');
                    echo "registration failed with error code: ".$error->attrs['code']." and type: ".$error->attrs['type'].PHP_EOL;
                    echo "error text: ".$error->exists('text')->text.PHP_EOL;
                    echo "shutting down...".PHP_EOL;
                    $this->client->end_stream();
                    return "logged_out";
                }
            }
        }
    }

         public function wait_for_register_form($event, $args) {

            $stanza = $args[0];
            $query = $stanza->exists('query', NS_INBAND_REGISTER);
            if($query) {
                $form = array();
                $instructions = $query->exists('instructions');
                if($instructions) {
                echo $instructions->text.PHP_EOL;
            }

            $this->client->xeps['0077']->set_form($stanza->attrs['from'], array('username' => $this->username, 'password' => $this->password));
            return array($this, "wait_for_register_response");
        }
        else {
            $this->client->end_stream();
            return "logged_out";
        }
       }    
   } 
```

这些代码与 register_user.php 相同，但在一个类中实现；

我以这种方式在我的代码中使用这个类：

```
$xmppObj = new xmpp();
$xmppObj('user','password');
/*
 some more code after this
/* 
```

当它执行时，成功创建用户，但它会打印一条消息（'注册成功......'）并且应用程序退出并且它不会在类函数之后执行“在此之后的一些代码”，换句话说它不遵循编码...

我能做些什么来解决这个问题，一个熟悉 JAXL 库的人可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T01:19:15.387

看起来您使用的代码几乎与[examples/register_user.php](https://github.com/abhinavsingh/JAXL/blob/v3.x/examples/register_user.php)中的代码相同。用户注册成功后，脚本将关闭[XMPPStream](https://github.com/abhinavsingh/JAXL/blob/v3.x/xmpp/xmpp_stream.php)，这从这部分代码中可以看出：

```
if($stanza->attrs['type'] == 'result') {
    echo "registration successful".PHP_EOL."shutting down...".PHP_EOL;
    $this->client->end_stream();
    return 'logged_out';
} 
```

你必须改为打电话`$client->send_end_stream();`而不是`$client->end_stream();`。这将确保底层 XMPPStream 进行正确的[FSM 状态转换](https://github.com/abhinavsingh/JAXL/blob/v3.x/core/jaxl_fsm.php)。还为事件添加一个回调`on_disconnect`，在这个回调中，您可以再次尝试连接新注册的 XMPP 帐户，它应该可以正常工作。

**注意**：请从存储库中签出最新代码。我做了一些更新，允许重新初始化核心 JAXLLoop。如果你对细节感兴趣，这里是[提交日志](https://github.com/abhinavsingh/JAXL/compare/2518a44b9dfe...cdc3f1711bcf)。

# ruby-on-rails - 无法在 rails_admin gem 中集成 CKeditor（使用 gem rich）

> ID：13070784
> 
> 赞同：3
> 
> 时间：2012-10-25T14:25:43.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-admin

我按照链接[GitHub gem rich](https://github.com/bastiaanterhorst/rich#readme)将 CKeditor 安装到 rails_admin 但出现错误：`Unsupported field datatype: rich_editor`

我的模型

```
edit do
        field :title
        field :description, :rich_editor do
          config({
            :insert_many => true
          })
        end
        field :autho
        field :book_type
      end 
```

我该如何解决这个错误？或者这是一个问题？

* * *

**编辑**：我试过了，它奏效了

```
field :content, :text do
      ckeditor do true end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-27T22:02:44.427

我无法使用 Rails 管理员让 Rich gem 与 Rails 4 项目一起工作，因此我决定使用标准的 CK Editor Gem，这是作者推荐的操作过程。在此之后，它花了 5 分钟才开始工作：

[https://github.com/sferik/rails_admin/wiki/CKEditor](https://github.com/sferik/rails_admin/wiki/CKEditor)

然后我将我的 CK_Editor 配置为使用可用功能的一小部分。

添加 CK_Editor gem 并配置我的 rails 管理员初始化程序后，我在我的项目中创建了一个新的 javascript 文件：

/app/assets/javascripts/ckeditor/config.js

内容如下：

```
CKEDITOR.config.toolbar = [
{ name: 'basicstyles', groups: [ 'basicstyles', 'cleanup' ],
    items: [ 'Bold', 'Italic', 'Underline', 'Strike', '-', 'RemoveFormat' ] },
{ name: 'paragraph', groups: [ 'list', 'indent', 'blocks', 'align', 'bidi' ],
    items: [ 'NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'Blockquote',
         'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock' ] },
{ name: 'links', items: [ 'Link', 'Unlink' ] }, 
```

];

记得重启你的 Rails 服务器！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T15:36:44.430

我有同样的问题。我认为这是 rails_admin 或丰富的问题​​。我过去已经成功地将这两者集成在一起（但两者都有旧版本）。

我在丰富的（[https://github.com/bastiaanterhorst/rich/issues/80](https://github.com/bastiaanterhorst/rich/issues/80)）和rails_admin（[https://github.com/sferik/rails_admin/issues/1585](https://github.com/sferik/rails_admin/issues/1585)）repos中为此创建了github问题。

# apache - mod重写规则不起作用

> ID：13070786
> 
> 赞同：0
> 
> 时间：2012-10-25T14:25:49.383
> 
> 标签：apache, mod-rewrite

我有这个代码：

```
RewriteEngine on

RewriteRule (.*)\.php review.php?site=$1 [L] 
```

我想从中得到：

```
http://m.example.com/sandbox/mates.php 
```

对此：

```
http://m.example.com/sandbox/review.php?site=mates 
```

但它不起作用..请注意，我的 htaccess 根文件在目录中，而不是在根目录中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:38:02.897

如果您有根 .htaccess，可能会给您带来冲突的问题。

此外，您可能希望将规则更改为

`RewriteRule ^(.*)\.php$ review\.php?site=$1 [L]`

您还可以更明确：

`RewriteRule ^(.*)\.php$ /sandbox/review\.php?site=$1 [L]`

# android - android 光标到 JSONArray

> ID：13070791
> 
> 赞同：9
> 
> 时间：2012-10-25T14:25:55.373
> 
> 标签：android, json, android-cursor

如何将光标“转换”为 JSONArray？

我的光标为 3 列（_id、姓名、出生）

我已经搜索过，但找不到任何示例

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-09-28T11:42:52.420

光标到 JSONArray

```
public JSONArray cur2Json(Cursor cursor) {

    JSONArray resultSet = new JSONArray();
    cursor.moveToFirst();
    while (cursor.isAfterLast() == false) {
        int totalColumn = cursor.getColumnCount();
        JSONObject rowObject = new JSONObject();   
        for (int i = 0; i < totalColumn; i++) {
            if (cursor.getColumnName(i) != null) {
                try {
                    rowObject.put(cursor.getColumnName(i),
                            cursor.getString(i));
                } catch (Exception e) {
                    Log.d(TAG, e.getMessage());
                }
            }
        }
        resultSet.put(rowObject);
        cursor.moveToNext();
    }

    cursor.close();
    return resultSet;

} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-01-30T10:55:14.467

```
private String cursorToString(Cursor crs) {
    JSONArray arr = new JSONArray();
    crs.moveToFirst();
    while (!crs.isAfterLast()) {
        int nColumns = crs.getColumnCount();
        JSONObject row = new JSONObject();
        for (int i = 0 ; i < nColumns ; i++) {
            String colName = crs.getColumnName(i);
            if (colName != null) {
                String val = "";
                try {
                    switch (crs.getType(i)) {
                    case Cursor.FIELD_TYPE_BLOB   : row.put(colName, crs.getBlob(i).toString()); break;
                    case Cursor.FIELD_TYPE_FLOAT  : row.put(colName, crs.getDouble(i))         ; break;
                    case Cursor.FIELD_TYPE_INTEGER: row.put(colName, crs.getLong(i))           ; break;
                    case Cursor.FIELD_TYPE_NULL   : row.put(colName, null)                     ; break;
                    case Cursor.FIELD_TYPE_STRING : row.put(colName, crs.getString(i))         ; break;
                    }
                } catch (JSONException e) {
                }
            }
        }
        arr.put(row);
        if (!crs.moveToNext())
            break;
    }
    crs.close(); // close the cursor
    return arr.toString();
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-25T14:32:08.820

您不能将游标的内容直接转换为 JSONObject，但您可以通过一些逻辑来做到这一点。

例如：从光标中检索字符串，形成一个遵循 JSON 格式的字符串，并使用它来创建一个 json 对象：

```
JSONObject jFromCursor=new JSONObject(string_in_JSON_format); 
```

# php - 在标头函数中使用 PHP 变量

> ID：13070794
> 
> 赞同：0
> 
> 时间：2012-10-25T14:26:05.487
> 
> 标签：php

我试图在 PHP 标头函数中合并一个变量，但它似乎不起作用，它在地址栏中显示实际变量或只是加载一个空白屏幕。感谢您对此的帮助。

代码如下

```
header('Location: http://'.$soft_url/main'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:28:03.023

该代码格式错误。

```
header('Location: http://'.$soft_url.'/main'); 
```

可能会解决您的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:27:45.700

试试这个：

```
header('Location: http://' . $soft_url . '/main'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T14:30:31.147

试试这个：

```
header("Location: http://$soft_url/main"); 
```

# c++ - C++：如何仅在父窗口上使用 SetLayeredWindowAttributes()？

> ID：13070800
> 
> 赞同：0
> 
> 时间：2012-10-25T14:26:38.277
> 
> 标签：c++, windows, winapi

> **可能重复：**
> [包含不透明文本和按钮的透明窗口](https://stackoverflow.com/questions/1294805/transparent-window-containing-opaque-text-and-buttons)

**我正在尝试使用C++**操作现有窗口。

基本上，我要做的是通过首先将其窗口样式设置为`WS_EX_LAYERED`然后使用`SetLayeredWindowAttributes()`正确的值来设置父窗口透明。

问题是这会将子窗口也设置为透明，这将使整个程序透明（显然是一个问题）。

有任何想法吗？

**编辑**显示问题的图像：![在此处输入图像描述](../Images/b01ad7a55acc37eb7cc7009a06f79bf4.png)

如您所见，我将任务栏窗口样式设置为`WS_EX_LAYERED`，但例如窗口`MSTaskSwWClass`（具有正在运行的应用程序图标的窗口）也会受到影响。

**EDIT2**尝试`UpdateLayeredWindow()`了完全相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:39:12.400

截至[http://msdn.microsoft.com/en-us/library/windows/desktop/ms633540%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633540%28v=vs.85%29.aspx)

**Windows 8：** 顶级窗口和子窗口支持 WS_EX_LAYERED 样式。**以前的 Windows 版本仅支持顶级**窗口的WS_EX_LAYERED 。

所以它不会将分层属性设置为“子”窗口。

向我们展示屏幕截图和/或代码。

# tiles - 使用 OGNL 表达式访问 Tiles 2 中的请求标头

> ID：13070801
> 
> 赞同：1
> 
> 时间：2012-10-25T14:26:39.117
> 
> 标签：tiles, ognl

我在我的应用程序（Struts 2.2.3）中使用 Tiles 2.2.2。我想使用表达式来根据请求中的某些属性修改我的屏幕组成。基本上，我想根据请求中是否有名为“x-requested-with”的标头并且值为“XMLHttpRequest”来更改屏幕的扩展。有可能这样做吗？我试图用一个属性做一个简单的例子：

```
<put-attribute name="test"   expression="OGNL:requestScope"  cascade="true"/> 
```

我尝试过不同的表达式，例如 OGNL:%{#request.headers.referer}、OGNL:#request.headers.referer、OGNL:requestScope.headers.referer 等。但它总是返回 null。我还没有找到任何关于 OGNL 表达式如何在 Tiles 上工作的文档，所以我正在根据我将如何使用 Struts 进行工作。但这似乎不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T13:16:21.207

你是如何初始化瓷砖的？如果您使用的是 StrutsTilesListener，则不会评估 tiles.xml 中的 OGNL 表达式。

在我的 Struts2 应用程序中，我在 web.xml 中使用 org.apache.tiles.extras.complete.CompleteAutoloadTilesListener 并且 OGNL 评估正在工作：

```
<listener>
      <listener-class>org.apache.tiles.extras.complete.CompleteAutoloadTilesListener</listener-class>
</listener> 
```

就我而言，我有一个自定义 TilesResult，其属性名为“内容”：

```
<put-attribute name="content" expression="OGNL:content" /> 
```

# php - 在 Kohana 中加入 OR

> ID：13070802
> 
> 赞同：2
> 
> 时间：2012-10-25T14:26:40.693
> 
> 标签：php, mysql, sql, kohana

我正在尝试根据它们是否匹配多对多关系中的给定对来组合两个表。我已经知道我正在尝试生成的 SQL 语句，它在功能上等同于以下内容：

```
SELECT columnA, columnB, ...
...
JOIN matching_table
    ON ( (matching_table.id1 = table_a.id AND matching_table.id2 = table_b.id) OR
         (matching_table.id1 = table_b.id AND matching_table.id2 = table_a.id) )
... 
```

但我想使用 Kohana 的查询生成器来生成它以保持一致性。问题是我似乎找不到创建复杂`ON`查询的方法。到目前为止我所拥有的是

```
DB::select('columnA', 'columnB', ...)
...
    ->join('matching_table')
        ->on('matching_table.id1', '=', 'table_a.id')
        ->on('matching_table.id2', '=', 'table_b.id')
... 
```

这会生成第一个`AND`序列，但我似乎无法将它与`OR`.

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T08:53:45.123

您应该能够使用 where 而不是 on （虽然未经测试）：

```
->join('matching_table')
->where_open()
->where('matching_table.id1', '=', 'table_a.id')
->and_where('matching_table.id2', '=', 'table_b.id')
->where_close()
->or_where_open()
->where('matching_table.id1', '=', 'table_b.id')
->and_where('matching_table.id2', '=', 'table_a.id')
->or_where_close() 
```

# sql-server - 多行 TSQL 大规模连接

> ID：13070809
> 
> 赞同：0
> 
> 时间：2012-10-25T14:26:52.417
> 
> 标签：sql-server, tsql, join

有没有这样简单的加入方式？表 A 和 B 有大量的行。

表 A

```
Column 1    Column 2    
1           AA  
2           BB  
3           CC 
```

表 B

```
Column 3        
XXX     
YYY     
ZZZ 
```

结果

```
Column 1    Column 2    Column 3
1           AA          XXX
1           AA          YYY
1           AA          ZZZ
2           BB          XXX
2           BB          YYY
2           BB          ZZZ
3           CC          XXX
3           CC          YYY
3           CC          ZZZ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:30:39.350

```
SELECT Column1, Column2, Column3
FROM TableA
CROSS JOIN TableB 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:34:52.957

您可以使用`OUTER APPLY`：

```
select column1, column2, column3
from tablea
outer apply tableb 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/74dd5/5)

# c - 从遗留 C 代码生成状态图

> ID：13070810
> 
> 赞同：2
> 
> 时间：2012-10-25T14:26:58.183
> 
> 标签：c, uml, state, graphviz, dot

我正在研究可视化大量的 C 代码，最好是对其状态机进行逆向工程并以图表的方式为我绘制出来。

我研究了 Graphviz 和 Dot，看来我可以从 API 中拼接一些东西来完成这项工作。但老实说，我有点期待这将是一项足够普遍的任务，以至于有人可能已经想出了一个工具来完成这项任务。

有人对此有经验吗？您可以推荐的任何解决方案或我忽略的现有工具？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:03:34.527

您可以尝试 Enterprise Architect，但这确实不是一个好主意，而且无论如何您都需要对结果进行大量手动更改。这或多或少就像依靠自动翻译器以您不知道的语言为您说话。这对于过程类型的代码尤其成问题，就像你在 C 中可能遇到的那样。

# c# - log4net 无法登录

> ID：13070812
> 
> 赞同：4
> 
> 时间：2012-10-25T14:27:05.653
> 
> 标签：c#, asp.net, log4net

所以由于某种原因，我们的记录器已经停止记录，我完全不知道为什么。我在我的项目中使用的是以下内容：

log4net 配置：

```
<?xml version="1.0" encoding="utf-8"?>
<log4net>
  <root>
    <level value="DEBUG" />
    <appender-ref ref="UdpAppender" />
    <appender-ref ref="RollingFile" />
  </root>

  <appender name="UdpAppender" type="log4net.Appender.UdpAppender">
    <remoteAddress value="127.0.0.1" />
    <remotePort value="8180" />
    <layout type="log4net.Layout.XmlLayoutSchemaLog4j">
      <locationInfo value="true" />
    </layout>
  </appender>

  <appender name="RollingFile" type="log4net.Appender.RollingFileAppender">
    <file value="Logs/DA.RA.log"/>
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock"/>
    <appendToFile value="true"/>
    <maxSizeRollBackups value="10"/>
    <maximumFileSize value="10MB"/>
    <rollingStyle value="Size"/>
    <staticLogFileName value="true"/>
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%-5level %date %logger - %message%newline"/>
    </layout>
  </appender>
</log4net> 
```

在我的 web.config 我有以下行：

```
<section name="log4net" 
         type="log4net.Config.Log4NetConfigurationSectionHandler,log4net, Version=1.2.11.0, Culture=neutral, PublicKeyToken=a3d255455d3dcb36" 
         requirePermission="false"/> 
```

在我的 global.asax 中，application_start 方法中有以下行：

```
string filename = Server.MapPath( @"~\XML\log4net.xml" );
log4net.Config.XmlConfigurator.ConfigureAndWatch( new System.IO.FileInfo( filename ) ); 
```

当我在我使用的任何页面中调用记录器时：

```
private static readonly ILog logger = LogManager.GetLogger(typeof(ReportParameters)); 
```

我尝试了很多我在网上找到的不同的东西。这些包括：

将以下行添加到我的项目中的程序集中

```
[assembly: log4net.Config.XmlConfigurator(Watch=true)] 
```

我试过：

```
[assembly: log4net.Config.XmlConfigurator()] 
```

我已将 log4net.dll 的版本从 1.2.10.0 升级到 1.2.11.0。

我尝试将 log4net 附加程序添加到 web.config 文件而不是它自己的文件中，但我仍然没有从日志记录中得到任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:58:11.627

尝试打开log4net的内部调试并检查或分享结果：

注意：我制作了一个示例应用程序并使用了您相同的 log4net.xml 文件和 ConfigureAndWatch 语句，它可以正常工作。我认为您遇到了文件名路径解析问题或写入权限问题。创建日志文件夹如果你没有。

您需要添加到 web.config

```
<appSettings>
  <add key="log4net.Internal.Debug" value="true" />
 </appSettings>

 <system.diagnostics>
  <trace autoflush="true">
   <listeners>
    <add
     name="textWriterTraceListener"
     type="System.Diagnostics.TextWriterTraceListener"
     initializeData="c:\\inetpub\\wwwroot\\log4net.txt" />
   </listeners>
  </trace>
 </system.diagnostics> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:40:11.947

除了可能的文件权限问题外，我发现使用时

```
[assembly: log4net.Config.XmlConfigurator()] 
```

在 ASP.NET 项目中，它实际上永远不会做任何事情（我使用的是调试字符串附加程序）。

`Application_Start`我的解决方案是在 global.asax中启动 log4net 。

```
protected void Application_Start()
{
    log4net.Config.XmlConfigurator.Configure();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:49:07.173

替换这个：

```
<section name="log4net" 
         type="log4net.Config.Log4NetConfigurationSectionHandler,log4net, Version=1.2.11.0, Culture=neutral, PublicKeyToken=a3d255455d3dcb36" 
         requirePermission="false"/> 
```

为了这：

```
<section name="log4net" 
         type="log4net.Config.Log4NetConfigurationSectionHandler,log4net" 
         requirePermission="false"/> 
```

而不是

```
log4net.Config.XmlConfigurator.ConfigureAndWatch() 
```

称呼

```
log4net.Config.XmlConfigurator.Configure(); 
```

让我知道它是否可以这样工作

# c# - 如何从数据库自定义授权

> ID：13070814
> 
> 赞同：1
> 
> 时间：2012-10-25T14:27:04.913
> 
> 标签：c#, asp.net, webforms, asp.net-membership, roleprovider

通常使用授权设置与角色进行交互。

```
<location path="Register.aspx">
  <system.web>
    <authorization>
      <allow roles="Administrator"/>
      <deny users="?"/>
    </authorization>
  </system.web>
</location> 
```

但我想在表中的数据库中进行此设置

```
tblAuthorization
-IdAuthorization (Identy(1,1))
-IdCompany=5
-IdRol=5 (Administrator”)
-Path=”Register.aspx” 
```

是否有一个班级可以做到这一点？有类似 Profile, RoleProvider ..

```
<roleManager enabled="true"  defaultProvider="MyAccessRolProvider">
   <providers>
      <clear />
      <add name="MyAccessRolProvider" type="MyAccessRolProvider" connectionStringName="MyConnectionString" applicationName="/" />
      <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
   </providers>
</roleManager> 
```

现在我认为唯一可以在 Page_Load 事件中实现验证 如果它是无效的重定向但我会做更多的“专业”

```
protected void Page_Load(object sender, EventArgs e)
{
   if (!IsPostBack)
   {
      if(!ValidateAuthorization())
      {
          Response.Redirect("Login.aspx");
      }
   }
} 
```

可以帮我举个例子吗？

非常感谢您提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:44:16.333

您最好的选择是实现自定义 RoleProvider - 您似乎正朝着这个方向前进，因为您的问题包括带有自定义 RoleProvider (MyAccessRolProvider) 的配置部分。

您需要指定 RoleProvider 的完全限定名称，例如`MyNamespace.MyAccessRoleProvider, MyAssembly`.

[MSDN 描述了如何做到这一点，包括一个示例实现](http://msdn.microsoft.com/en-us/library/8fw7xh74(v=vs.100).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:56:12.247

据我所知，没有开箱即用的支持，但是我建议您实现以下内容：

创建一个派生自 AuthorizeAttribute 的新类，添加一个 ID 属性并覆盖“AuthorizeCore”方法。

```
 public class CustomAutorizeAttribute : AuthorizeAttribute
        {
            public Guid ActionId { get; set; }

            protected override bool AuthorizeCore(HttpContextBase httpContext)
            {
                //Check user has access to action with ID = ActionId
                //implementation omitted
            }
        } 
```

您可以添加一个新的数据库表来保存操作及其关联的 ID 值。您可以手动将记录添加到表中，也可以使用反射编写一些代码来执行此操作（如果您有很多操作并且将来可能会添加更多操作，我会建议您这样做）。

完成此操作后，您可以为用户或应用程序角色分配对这些操作的访问权限。

在您的自定义 Authorize 属性中，您必须检查用户是否有权访问从 AuthorizeCore 方法相应地返回 true 或 false 的给定操作。

我建议在用户登录时获取用户可以访问的所有操作的集合，并将它们存储在服务器缓存或某种分布式缓存中，这样您就不会在每次请求时都访问数据库。

更新 - 抱歉刚刚意识到您使用的是 ASP.NET 表单而不是 MVC。我的方法是针对 MVC 应用程序，因此它可能不相关，尽管我将把它留在这里以防任何 MVC 开发人员碰巧遇到您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:13:34.753

了解您在页面级别进行授权后，您可以添加一个 HTTP 模块 ( [IHttpModule](http://msdn.microsoft.com/en-us/library/ms227673.aspx) ) 并使用您的模块进行授权检查。如果授权失败，那么您可以酌情重定向。

像这样的东西可能会起作用：

```
public class MyAuthorizationModule : IHttpModule
{

    public void Init(HttpApplication application)
    {
        application.AuthorizeRequest += (new EventHandler(AuthorizeRequest));
    }

    private void AuthorizeRequest(Object source, EventArgs e)
    {
        bool isAuthorized = //your code here to check page authorization

        if (!isAuthorized) 
        {  
            var response = //will need to get current response
            response.Redirect("Login.aspx", true);
        }
    }
} 
```

注意：不要忘记您需要将该模块添加到您的 Web 应用程序中。

# python - NetworkX 写入文件

> ID：13070816
> 
> 赞同：0
> 
> 时间：2012-10-25T14:27:12.203
> 
> 标签：python, networkx

我浏览了手册，但无法完全弄清楚。

我有一个 3 列的大文件，节点 1 以一定的强度命中节点 2。NetworkX 从中生成了许多集群，并且效果很好。但是，我无法将这些文件加载​​到例如 cytoscape 中，因此我需要将每个集群写入一个单独的文件。

我试过了：

```
for n in G: nx.write_weighted_edgelist(G[n], 'test'+str(count)) 
```

或者查看 G.number_of_nodes / edges, G.graph.keys(), dir(G) 但这并没有得到我想要的结果。

有没有办法将每个集群与强度分开存储？

使用 Clusters = nx.connected_components(G) 我可以获得集群，但我会丢失所有连接信息。

```
 for n,nbrs in G.adjacency_iter():
            for nbr,eattr in nbrs.items():
                    data=eattr['weight']
                    if data < 2:  
                            print('(%s, %s, %s)' % (n,nbr,data)) 
```

在空行上使用它时，我认为这些是单独的集群。

＃＃＃＃＃＃＃＃＃＃解决方案

```
 Clusters = nx.connected_components(G)
    for Cluster in Clusters:
            count = count + 1
            cfile = open("tmp/Cluster_"+str(count)+".clus","w")
            for C in Cluster:
                    hit = G[C]
                    for h in hit:
                            cfile.write('\t'.join([str(C),str(h),str(hit[h].values()[0]),"\n"])) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:39:06.720

尝试使用 graphs = nx.connected_component_subgraphs()。这将返回一个图表列表，您可以以任何适用于 cytoscape 的格式单独编写这些图表。

# php - 抢先验证还是异常处理？

> ID：13070817
> 
> 赞同：8
> 
> 时间：2012-10-25T14:27:12.990
> 
> 标签：php, validation, exception, architecture, exception-handling

我试图在关于数据验证的两种模式之间做出决定：

1.  我**尝试遵循名义上的工作流程并捕获**我的模型和服务引发的异常：违反唯一/外部约束、空字段、无效参数等...（！！我只捕获我知道我应该捕获的异常）

    *   优点：在我的控制器和服务**中编写的代码很少**：我只需要处理异常并将它们转录为用户可以理解的消息。**代码非常简单易读**。

    *   缺点：我需要**编写特定的异常**，有时可能是很多不同的异常。我还需要捕获和解析数据库异常（违反约束等）的通用 PDO/Doctrine 异常，以将它们转换为有意义的异常（例如：）`DuplicateEntryException`。我也**无法绕过一些验证**：假设我的模型的一个对象被标记为锁定：尝试删除它会引发异常。但是我可能想强制删除它（例如，使用确认弹出窗口）。我将无法绕过这里的异常。

2.  我使用代码和数据库查询**明确地测试和预验证所有内容。**例如，在将某些内容设置为我的模型中的属性之前，我将测试某些内容不是 null 并且是一个整数。或者我将进行数据库查询以检查我不会创建重复条目。

    *   优点：**不需要编写特定的异常**，因为我预先验证了所有内容，所以无论如何我不应该做很多尝试/捕捉。如果我愿意，我也**可以绕过一些验证。**

    *   缺点：需要在控制器、服务和模型**中编写大量测试和验证。**我将执行**更多查询**（验证部分）。**数据库已经对外键、唯一约束、非空列进行了验证**......我不应该忽略它并自己重新编码。这也会导致**非常无聊的代码**！

我宁愿使用一种或另一种模式，而不是混合使用，以使事情尽可能简单。

第一个解决方案在我看来是最好的，但恐怕它可能是某种*反模式*？或者也许在其理论上的简单性背后隐藏着难以处理的情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T18:53:14.920

我建议数据验证应该发生在应用程序的外围。也就是说，应检查任何传入的数据以确保其符合您的期望。一旦允许进入应用程序，它就不再被验证，但它总是根据上下文（数据库、电子邮件等）进行转义。这使您可以将所有验证放在一起并避免验证工作的潜在重复（很容易实现）举个例子，数据可以被两个都使用它的模型验证两次。）Joe Armstrong 在他关于 Erlang 的书中推广了这种方法，他为电信站编写的软件可以运行多年而无需重新启动，所以它似乎运行良好： )

此外，模型预期并不总是与特定界面建立的预期完全一致（可能表单仅显示潜在选项的子集，或者界面可能有美国州的下拉列表，而模型存储了许多州的州）不同国家等）有时复杂的界面可以以增强用户体验的方式集成几个不同的模型对象。虽然对用户来说很好，但使用异常方法的这些模型的交互可能非常难以处理，因为某些输入可能是混合输入，这两个模型都无法单独验证。您始终希望首先确保验证符合 UI 的期望，而第二种方法允许您在最复杂的界面中执行此操作。

此外，异常处理在周期方面相对昂贵。验证问题可能非常频繁，我会尽量避免处理问题的昂贵操作，而不是可能非常频繁。

最后，一些验证对于模型来说并不是真正必要的，但它可以防止攻击。虽然您可以将其添加到模型中，但添加的功能会很快混淆模型代码。

因此，在这两种方法中，我建议使用第二种方法，因为：

1.  你可以为你的应用设计一个清晰的边界。
2.  所有的验证都在一个地方，并且可以共享。
3.  如果两个或多个模型使用相同的输入，则不会重复验证。
4.  这些模型可以专注于它们擅长的领域：将抽象实体的知识映射到应用程序状态。
5.  即使是最复杂的 UI 也可以得到适当的验证。
6.  抢占可能会更有效。
7.  不属于任何模型的以安全为中心的验证任务可以干净地添加到应用程序中。

# javascript - 在一行中使用 jQuery 重置多个（但不是全部）表单字段的值

> ID：13070819
> 
> 赞同：5
> 
> 时间：2012-10-25T14:27:15.530
> 
> 标签：javascript, jquery, html, forms, jquery-1.7

是否可以使用 jQuery 在一行或一击中重置多个表单字段。注意：我不想重置*所有*表单字段，只重置指定的白名单（如下所示）：

```
// reset some form fields                       
$('#address11').val('');
$('#address21').val('');
$('#town1').val('');
$('#county1').val('');
$('#postcode1').val(''); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-25T14:29:03.787

最好使用一个类，这样您就不必维护一长串 id。

**HTML**

```
<input type="text" class="resetThis" id="address11" />
<input type="text" class="resetThis" id="address21" /> 
```

**JavaScript**

```
$(".resetThis").val(""); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-25T14:28:02.037

jQuery（和 CSS）选择器字符串可以包含多个选择器，使用逗号作为子选择器的分隔符：

```
$('#address11, #address21, #town1, #county1, #postcode1').val(''); 
```

我认为这比使用类*更快*（ID 查找应该在基本恒定的时间内执行，而类查找必须访问每个 DOM 节点），但如果你想要的话，可能不太容易维护更改哪些元素被重置。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-25T14:33:01.157

如果您有很多字段，我会用一个类标记您想要忽略的字段以最小化代码：

```
$('#myForm input:not(.ignore)').val(''); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-02T07:23:08.747

您可以使用`$('#Form_name select:not(.fixed)').val('');`

# objective-c - TDD 在期限紧迫的 2-3 个月大小的 iOS/Android 移动应用程序项目中表现如何？

> ID：13070820
> 
> 赞同：2
> 
> 时间：2012-10-25T14:27:15.177
> 
> 标签：objective-c, ios, tdd

作为软件开发人员，我是初学者。我看到很多技术博客都在讨论测试驱动开发方法。对于小型项目，还有一个关于 TDD 的 SO Post。

但我想知道，人们如何在 iOS 项目中为他们的代码编写测试类？尤其是那些截止日期很短的，你必须每周提供一个带有新功能的构建。

并且有些场景 UI 和需求会不断变化。那么我们是否只为模型中的每个功能编写测试类？

或者我们还测试我们用来为我们创建的控件编写自定义代码的逻辑，或者也用于测试视图控制器中的代码？

我想编写测试类，但我害怕在现场项目中尝试它，认为这会花费我很多时间。那么是我们测试所有功能还是测试选定的重要功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:37:56.643

For an experienced TDD'er it will be the fastest to write tests for everything. For someone just starting to learn TDD, using TDD might be something like 50% slower* and they might not yet know how to write tests for some hard parts (such as the UI). An advantage of using TDD in a project with tight schedules is that you can release the project whenever you wish, even after every commit, because the program should be working at all times.

* Though in my case the speed of development in my first TDD project, which took about a month, was the same as before using TDD (when measured in lines of code per hour - which isn't a good [measure of productivity](http://martinfowler.com/bliki/CannotMeasureProductivity.html)).

# php - Zend Framework 2 路由子域到模块

> ID：13070824
> 
> 赞同：8
> 
> 时间：2012-10-25T14:27:34.127
> 
> 标签：php, zend-framework2

找了很久没有成功。在我放弃之前，我想问一下：

有没有办法将子域路由到**Zend Framework 2**中的模块？喜欢：

**子域**=>**模块**
api.site.com => api
dev.site.com => dev
admin.site.com => admin
site.com => public
...

我尝试这样做，但我无法访问除默认（索引）以外的控制器。

```
'router' => array(
    'routes' => array(
        'home' => array(
            'type' => 'Hostname',
            'options' => array(
                'route' => 'site.com',
                'defaults' => array(
                    '__NAMESPACE__' => 'Application\Controller',
                    'controller'    => 'Index',
                    'action'        => 'index',
                ),
            )
        )
    ),
), 
```

感谢您花时间帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:14:11.657

Zend Framework 2 没有路由到模块的概念。所有路由映射都在 URI 模式（用于 HTTP 路由）和特定控制器类之间。也就是说，`Zend\Mvc`提供了一个事件监听器 ( [`Zend\Mvc\ModuleRouteListener`](https://github.com/zendframework/zf2/blob/master/library/Zend/Mvc/ModuleRouteListener.php))，它允许您定义一个 URI 模式，该模式基于给定模式映射到多个控制器，从而模拟“模块路由”。要定义这样的路由，您可以将其作为路由配置：

```
'router' => array(
    'routes' => array(
         // This defines the hostname route which forms the base
         // of each "child" route
        'home' => array(
            'type' => 'Hostname',
            'options' => array(
                'route' => 'site.com',
                'defaults' => array(
                    '__NAMESPACE__' => 'Application\Controller',
                    'controller'    => 'Index',
                    'action'        => 'index',
                ),
            ),
            'may_terminate' => true,
            'child_routes' => array(
                // This Segment route captures the requested controller
                // and action from the URI and, through ModuleRouteListener,
                // selects the correct controller class to use
                'default' => array(
                    'type'    => 'Segment',
                    'options' => array(
                        'route'    => '/[:controller[/:action]]',
                        'constraints' => array(
                            'controller' => '[a-zA-Z][a-zA-Z0-9_-]*',
                            'action'     => '[a-zA-Z][a-zA-Z0-9_-]*',
                        ),
                        'defaults' => array(
                            'controller' => 'Index',
                            'action'     => 'index',
                        ),
                    ),
                ),
            ),
        ),
    ),
), 
```

（[单击此处查看此@ZendSkeletonApplication 的示例](https://github.com/zendframework/ZendSkeletonApplication/blob/master/module/Application/config/module.config.php#L23)）

不过，这只是等式的一半。您还必须使用特定的命名格式在模块中注册每个控制器类。这也是通过相同的配置文件完成的：

```
'controllers' => array(
    'invokables' => array(
        'Application\Controller\Index' => 'Application\Controller\IndexController'
    ),
), 
```

数组键是 ModuleRouteListener 用于查找正确控制器的别名，它必须采用以下格式：

```
<Namespace>\<Controller>\<Action> 
```

分配给此数组键的值是控制器类的完全限定名称。

（[单击此处查看此@ZendSkeletonApplication 的示例](https://github.com/zendframework/ZendSkeletonApplication/blob/master/module/Application/config/module.config.php#L70)）

注意：如果您没有使用 ZendSkeletonApplication，或者已经删除了它的默认应用程序模块，您将需要在您自己的模块之一中注册 ModuleRouteListener。 [单击此处查看 ZendSkeletonApplication 如何注册此侦听器的示例](https://github.com/zendframework/ZendSkeletonApplication/blob/master/module/Application/Module.php#L21)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T14:51:06.167

[如果我正确理解了DASPRIDS Rounter 演示文稿](http://stuff.dasprids.de/slides/zendcon2012/introducing-the-new-zend-framework-2-router/presentation.html#1)的幻灯片 #39 ，那么它就像 - 在每个模块的基础上 - 定义您的子域主机一样简单，即：

```
'router' => array(
    'routes' => array(
        'home' => array(
            'type' => 'Hostname',
            'options' => array(
                'route' => 'api.site.com',
                'defaults' => array(
                    '__NAMESPACE__' => 'Api\Controller',
                    'controller'    => 'Index',
                    'action'        => 'index',
                ),
            )
        )
    ),
), 
```

等等，您可以为每个模块单独执行此操作。

# jsf-2 - 在 JSF2.0 中 f:setPropetyActionListener 可以传递布尔值吗？

> ID：13070827
> 
> 赞同：1
> 
> 时间：2012-10-25T14:27:48.933
> 
> 标签：jsf-2

这是我的支持 bean 的一部分：

```
public class MyBean {
    private boolean mobile = false;

    public boolean isMobile() {
        return mobile;
    }

    public void setMobile(boolean mobile) {
        this.mobile = mobile;
    } 
```

这是 JSF 代码（在 .xhtml 中）：

```
<h:commandButton id="submit" value="Test" action="#{myBean.testing}">
    <f:setPropertyActionListener 
            target="#{myBean.mobile}" value="true" />
</h:commandButton> 
```

因此，在测试时，它似乎没有调用 setMobile 方法。它也不会出错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:43:47.727

尝试`value="#{'true'}"`代替`value="true"`

# c# - 在列表项之间添加空格，或使项目更易于在 ASP.NET 下拉列表中的触摸屏上选择

> ID：13070828
> 
> 赞同：3
> 
> 时间：2012-10-25T14:27:48.973
> 
> 标签：c#, asp.net, mobile, user-interface

在开发针对移动设备（主要是平板电脑）的 ASP.NET Web 应用程序时，我注意到如果用户的手指很粗，下拉列表有时很难选择正确的项目，或者只是不太好带触摸屏。

我知道我不是唯一一个注意到这一点的人，因为 IOS 应用程序出于这个原因专门不再使用下拉菜单，而是通常使用看起来像一卷卫生纸的 UIPickerView 控件，但让人们更容易选择滚动列表中的项目。

因此，我正在 ASP.NET 中寻找一种无需滚动我自己的自定义控件的好方法，以使下拉列表更易于在移动设备上使用，或者正在寻找一些可以用来代替下拉列表的免费控件.

首先想到的是；我可以以某种方式将列表项隔得更远，以便人们可以更轻松地选择他们想要的项目吗？我已经尝试将字体更改为更大，但这并没有真正帮助；特别是因为控制必须更宽，而问题实际上是项目之间有多少垂直空间。

如果没有，是否有人对他们如何解决这个问题有任何建议或现实生活中的例子？

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:45:52.107

您始终可以使用 CSS。如果您想对 JS 感兴趣，您甚至可以根据浏览器的用户代理（桌面与移动）提供不同的样式表。

```
/* Drop down control itself */
select.ddlList {
    padding: 5px; /* padding between the border of the drop down and the items */
}
/* Drop down list items */
select.ddlList > option {
    padding: 15px 5px; /* 15px = top/bottom padding, 5px = left/right padding */
} 
```

使用 ASP.NET 控件...

```
<asp:DropDownList ID="ddl" CssClass="ddlList" runat="server">
    <asp:ListItem ... />
    <asp:ListItem ... />
</asp:DropDownList> 
```

* * *

编辑：嗯，Xander 是对的——你不能通过 CSS 设置选项的样式，但我的 DropDownList 样式示例仍然有效。这将使您的 DropDownList 对触摸客户端更加可见。[http://jsfiddle.net/DwY87/6/](http://jsfiddle.net/DwY87/6/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:37:09.863

我在通过的项目中成功使用[了 DropKick.js 。](http://jamielottering.github.com/DropKick/)它克服了样式选择选项的不足，并通过 CSS 提供了对样式的更多控制。

**更新** *（评论后）*：

DropKick.js[逐步增强](http://www.alistapart.com/articles/understandingprogressiveenhancement/)页面上呈现的 HTML（选择字段）。您需要做的就是提供适当的钩子，dropkick 需要将渲染的选择字段转换为其实现。

*从 dropkicks 的主页：*

> 如何使用
> 
> DropKick 的工作原理是将您现有的、无聊的变成漂亮的、可定制的 HTML 下拉菜单。name 属性是唯一需要的属性。您还应该设置 tabindex 属性以启用通过选项卡导航。
> 
> ```
> <select name="pretty" tabindex="1" class="pretty dk">
>   <option value="">Choose a reaction</option>
>   <option value="amazed">Amazed</option>
>   <option value="bored">Bored</option>
>   <option value="surprised">Surprised</option>
> </select> 
> ```

## 如何在 asp.net 中使用它

非常简单，您可以下载 js 文件并将其包含在您的站点中：

`<script type="text/javascript" src="js/dropkick.js"></script>`

并包含样式的 css 文件：

`<link rel="stylesheet" type="text/css" href="default.css">`

你快到了......现在你需要使用 jquery 将它添加到页面的下拉列表中，效果如下：

`$('#myDropDown').dropkick();`

或者

`$('.myDropDown').dropkick();`

# iphone - 将 iphone mic 中的音频编码为 gsm

> ID：13070833
> 
> 赞同：1
> 
> 时间：2012-10-25T14:28:03.367
> 
> 标签：iphone, xamarin.ios, monodevelop, wav, gsm

我正在使用 monotouch 创建 iphone 应用程序，我需要将从麦克风接收到的音频编码为 gsm 文件。

我已经将音频编码为 wav，但现在，为了更具体的需要，我需要将其录制到 GSM 中。如果有人能告诉我或给我看一些文档，解释如何从 mic 编码到 gsm 或如何将 wav 转换为 gsm，那就太棒了。

泰，阿克塞尔

**- - 更新 - -**

中有一个 MicrosoftGSM 条目`MonoTouch.AudioToolbox.AudioFormatType`，但我收到 1718449215 OSStatus 错误。我想原因是我的其他论点不正确。艰难我不知道保存为 GSM 的规范。这是我不工作的代码：

```
//set up the NSObject Array of values that will be combined with the keys to make the NSDictionary
        NSObject[] values = new NSObject[]
        {    
            NSNumber.FromFloat (44100.0f), //Sample Rate
            NSNumber.FromInt32 ((int)MonoTouch.AudioToolbox.AudioFormatType.MicrosoftGSM),
            NSNumber.FromInt32(2),
            NSNumber.FromInt32((int)AVAudioQuality.High),
        };
        //Set up the NSObject Array of keys that will be combined with the values to make the NSDictionary
        NSObject[] keys = new NSObject[]
        {
            AVAudioSettings.AVSampleRateKey,
            AVAudioSettings.AVFormatIDKey,
            AVAudioSettings.AVNumberOfChannelsKey,
            AVAudioSettings.AVEncoderAudioQualityKey,
        };          
        //Set Settings with the Values and Keys to create the NSDictionary
        settings = NSDictionary.FromObjectsAndKeys (values, keys); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:10:45.690

坏消息，没有内置的方法来使用 AVAudioRecorder 来录制`GSM`音频文件

唯一支持的录音格式是

*   MPEG4AAC
*   苹果无损
*   苹果IMA4
*   iLBC
*   法律
*   线性PCM

无论如何，您可以设置网络服务并使用可以为您转换音频的第三方转换器（如[SoX ）。](http://sox.sourceforge.net)

顺便说一句，如果您尝试使用 MicrosoftGSM 格式的记录器，您可能会收到 OSStatus 错误 1718449215，这是`kAudioFormatUnsupportedDataFormatError`错误的表示

亚历克斯

# c# - 如何根据鼠标位置从文本框中获取特定的文本值

> ID：13070841
> 
> 赞同：11
> 
> 时间：2012-10-25T14:28:29.277
> 
> 标签：c#, .net, winforms, textbox, mouse-position

我有一个多行文本框，它根据给定的数据显示一些值（通常每行一个值）。

（为了让工具提示弹出一些“替代”数据）我想得到鼠标悬停在上面的单词（或至少是行），这样我就可以找到要显示的替代方法。

我对如何根据文本框和字体大小进行计算有一些想法，但我不知道该怎么做，因为大小和字体可能会经常变化。

那么...有没有办法使用鼠标位置来获取特定的文本框文本？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T16:00:45.443

这是一个替代解决方案。将此 MouseMove 事件添加到您的文本框：

```
private void txtHoverWord_MouseMove(object sender, MouseEventArgs e)
{
    if (!(sender is TextBox)) return;
    var targetTextBox = sender as TextBox;
    if(targetTextBox.TextLength < 1) return;

    var currentTextIndex = targetTextBox.GetCharIndexFromPosition(e.Location);

    var wordRegex = new Regex(@"(\w+)");
    var words = wordRegex.Matches(targetTextBox.Text);
    if(words.Count < 1) return;

    var currentWord = string.Empty;
    for (var i = words.Count - 1; i >= 0; i--)
    {
        if (words[i].Index <= currentTextIndex)
        {
            currentWord = words[i].Value;
            break;
        }
    }
    if(currentWord == string.Empty) return;
    toolTip.SetToolTip(targetTextBox, currentWord);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T15:14:46.897

使用[GetCharIndexFromPosition](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.getcharindexfromposition.aspx)方法将鼠标的位置映射到整个 Text 中的索引。从那个位置开始，左右前进，直到你掌握了整个单词。

要获取鼠标位置，请使用[MouseHover](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mousehover.aspx)事件，这样您就可以在它静止时而不是每次都得到它（这会使事情变慢）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:20:38.463

我的解决方案使用一个技巧来实现你想要的。

当您在文本区域内双击时，它会选择基础单词。

因此，在您的表单上使用`RichTextBox`（`TextBox`在鼠标事件上闪烁），您可以在单击鼠标中键时模拟双击（类似于巴比伦字典）。如果你愿意，你也可以使用`MouseHover`代替`MouseDown`。有用。

```
public partial class Form3 : Form
    {
        System.Windows.Forms.Timer timer = new System.Windows.Forms.Timer();

        public Form3()
        {
            InitializeComponent();
            timer.Interval = 50;
            timer.Tick += timer_Tick;
        }

        void timer_Tick(object sender, EventArgs e)
        {
            timer.Stop();
            MessageBox.Show(richTextBox1.SelectedText);

            // do more stuff here, e.g display your tooltip for the selected word or anything else 

            richTextBox1.SelectionLength = 0; // remove the highlighted color of selection
        }

        [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern void mouse_event(uint dwFlags, uint dx, uint dy, uint cButtons, uint dwExtraInfo);

        private const uint MOUSEEVENTF_LEFTDOWN = 0x02;
        private const uint MOUSEEVENTF_LEFTUP = 0x04;
        private const uint MOUSEEVENTF_RIGHTDOWN = 0x08;
        private const uint MOUSEEVENTF_RIGHTUP = 0x10;

        public void DoMouseDoubleClick()
        {
            //Call the imported function with the cursor's current position
            uint X = (uint)Cursor.Position.X;
            uint Y = (uint)Cursor.Position.Y;

            mouse_event(MOUSEEVENTF_LEFTDOWN, X, Y, 0, 0);
            mouse_event(MOUSEEVENTF_LEFTUP, X, Y, 0, 0);
            mouse_event(MOUSEEVENTF_LEFTDOWN, X, Y, 0, 0);
            mouse_event(MOUSEEVENTF_LEFTUP, X, Y, 0, 0);

            timer.Start(); // some delay is required so that mouse event reach to RichTextBox and the word get selected
        }

        private void richTextBox1_MouseDown(object sender, MouseEventArgs e)
        {
            if (e.Button == MouseButtons.Middle)
            {
                DoMouseDoubleClick();
            }
        }
    } 
```

# web-services - SharePoint 服务 WSDL 规范

> ID：13070843
> 
> 赞同：3
> 
> 时间：2012-10-25T14:28:33.187
> 
> 标签：web-services, sharepoint, wsdl

例如，点击 http:///_vti_bin/UserGroup.asmx?wsdl 给我一个不完整的 wsdl 规范的原因是什么（如果与[http://msdn.microsoft.com/en-us/library/dd965659相比%28v=office.12%29.aspx](http://msdn.microsoft.com/en-us/library/dd965659%28v=office.12%29.aspx)）？

我的意思是不完整：它不包含一些复杂的类型定义，例如用户（与完整的不同），所以这些类型不是由 wsdl.exe 生成的。

我对此有一个问题：根据 MSDN 的规范生成 c# Web 服务存根是否安全，或者由于合同可能发生变化，这种方法很危险？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-23T20:39:58.193

对于您关于 WSDL 不同的第一个问题：它确实应该是等效的并且包含所有类型！每当您将 /_vti_bin/UserGroup.asmx?wsdl 附加到您网站的 URL 时，SharePoint 肯定会显示完整的 WSDL，包括复杂的类型定义等。我现在刚刚针对我自己的 SharePoint 实例进行了尝试，并且从 http:/ 返回的 WSDL /mysite.com/ ...snip... /pierre/_vti_bin/UserGroup.asmx?wsdl 的大小与[http://msdn.microsoft.com/en-us/library/dd965659%](http://msdn.microsoft.com/en-us/library/dd965659%28v=office.12%29.aspx)中的几乎相同[28v=office.12%29.aspx](http://msdn.microsoft.com/en-us/library/dd965659%28v=office.12%29.aspx)并快速检查以确保两个地方都存在复杂类型，这证实了这一点。

回答您的第二个问题：我认为您不应该根据文档中的 WSDL 创建您的 Web 服务存根和框架。而是使用从您的站点返回的 WSDL。如果您没有获得从 SharePoint 返回的 WSDL 中的所有复杂类型，则应首先解决该问题。

我会尝试的第一件事：下载 SOAPui（免费）并简单地插入以 ?wsdl 结尾的 URL 并创建示例请求。也许您会遇到访问问题（UAG 或其他），但至少您会知道 WSDL 格式正确。如果 SOAPui 可以基于 WSDL 生成客户端代码，那么您也可以（使用 wsdl2java 或 wsdl2dotnet 等价物；我不记得 .net 版本的名称）。

是的，从文档中复制 WSDL 很危险，但我更担心某些内容会被缩写或文档过时等。

至于合同变更，我从 2009 年开始使用 UserGroup.asmx?wsdl 端点，它仍然适用于较新版本的 SharePoint（即使在升级到 SP2010 之后）。我使用 java 作为客户端代码。Microsoft 确实在 SharePoint 中确定了 Web 服务，集成我们的 Java 堆栈并调用/从 SharePoint Web 服务调用非常容易。它还可以与我们用来测试 Web 服务的其他工具（如 SOAPui 等）进行很好的互操作。

# wordpress - Google 结果有正确的网站链接，但标题是香烟广告。代码未更改

> ID：13070845
> 
> 赞同：1
> 
> 时间：2012-10-25T14:28:37.383
> 
> 标签：wordpress, spoof

我帮助维护一个教堂的网站，我们刚刚注意到我们的谷歌搜索结果以某种方式被欺骗了。结果和链接指向教堂的网站，但文字描述都是错误的。我检查了网站的实际代码（头部复制在下面），没有任何问题。我们的服务器上没有奇怪的文件，网站本身也没有任何问题。

我的问题是这怎么可能，有什么办法可以纠正吗？

![Google 结果屏幕截图](../Images/5a2e69b1f8f80c0937b1be7c4f339b63.png)

```
<?php
/**
 * The Header for our theme.
 *
 * Displays all of the <head> section and everything up till <div id="main">
 *
 * @package WordPress
 * @subpackage Twenty_Ten
 * @since Twenty Ten 1.0
 */

global $fumco;
?><!DOCTYPE html>
<html <?php language_attributes(); ?>>
<head>
<meta charset="<?php bloginfo( 'charset' ); ?>" />
<title><?php
    /*
     * Print the <title> tag based on what is being viewed.
     */
    global $page, $paged;

    wp_title( '|', true, 'right' );

    // Add the blog name.
    bloginfo( 'name' );

    // Add the blog description for the home/front page.
    $site_description = get_bloginfo( 'description', 'display' );
    if ( $site_description && ( is_home() || is_front_page() ) )
        echo " | $site_description";

    // Add a page number if necessary:
    if ( $paged >= 2 || $page >= 2 )
        echo ' | ' . sprintf( __( 'Page %s', 'twentyten' ), max( $paged, $page ) );

    ?></title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="<?php bloginfo( 'stylesheet_url' ); ?>" />
<link rel="pingback" href="<?php bloginfo( 'pingback_url' ); ?>" />
<?php
    /* We add some JavaScript to pages with the comment form
     * to support sites with threaded comments (when in use).
     */
    if ( is_singular() && get_option( 'thread_comments' ) )
        wp_enqueue_script( 'comment-reply' );

    /* Always have wp_head() just before the closing </head>
     * tag of your theme, or you will break many plugins, which
     * generally use this hook to add elements to <head> such
     * as styles, scripts, and meta tags.
     */
    wp_head();
?>

<script src="<?php bloginfo('template_directory');?>/js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>

  <!-- Slider script -->
  <script src="<?php bloginfo('template_directory');?>/js/scripts.js" type="text/javascript" charset="utf-8"></script>

  <!-- Home page tabs -->
  <script type="text/javascript" charset="utf-8">
    $(function () {
      var tabContainers = $('div.tabs > div');
      tabContainers.hide().filter(':first').show();

      $('div.tabs ul.tabNavigation a').click(function () {
        tabContainers.hide();
        tabContainers.filter(this.hash).show();
        $('div.tabs ul.tabNavigation a').removeClass('selected');
        $(this).addClass('selected');
        return false;
      }).filter(':first').click();
    });
  </script>

  <!-- Script for TypeKit font implementation -->
  <script type="text/javascript" src="http://use.typekit.com/kgp1dfc.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

  <!-- Facebook Wall Feeds -->
  <script type="text/javascript" src="<?php bloginfo('template_directory');?>/js/jquery.neosmart.fb.wall.js"></script>
  <link rel="stylesheet" type="text/css" href="<?php bloginfo('template_directory');?>/js/jquery.neosmart.fb.wall.css" media="screen">

  <!-- Scripts for implementing drop down menus -->
  <link rel="stylesheet" type="text/css" href="<?php bloginfo('template_directory');?>/css/superfish.css" media="screen">
  <link rel="stylesheet" type="text/css" href="<?php bloginfo('template_directory');?>/css/superfish-navbar.css" media="screen">
  <script type="text/javascript" src="<?php bloginfo('template_directory');?>/js/hoverIntent.js"></script>
  <script type="text/javascript" src="<?php bloginfo('template_directory');?>/js/superfish.js"></script>

  <script type="text/javascript">
    $.fn.setAllToMaxHeight = function(){
      return this.height( Math.max.apply(this, $.map( this , function(e){
        return $(e).height()
      }) ));
    }

  // initialise plugins
  jQuery(function(){
    jQuery('ul.sf-menu').superfish();

    adjustNavigation();

    $('.menu-col').setAllToMaxHeight();

    if ($('.accordion').length > 0) {
      $('.accordion .ac-header').click(function() {
        panel = $(this).parents('.ac-panel');
        $('.ac-content', panel).slideToggle();
      })
    }

    jQuery('.twitter-feeds a').attr('target', '_blank');

        $("#frmsga").submit(function() {
            var emailfilter=/^\w+[\+\.\w-]*@([\w-]+\.)*\w+[\w-]*\.([a-z]{2,4}|\d+)$/i;
            $("#txtname, #txtemail").removeClass('error-input');
            var is_valid = true;
            if ($("#txtname").val()==""){
                $("#txtname").addClass('error-input').focus();
                return false;
            }

            if (emailfilter.test($("#txtemail").val())==false) {
                $("#txtemail").addClass('error-input').focus();
                return false;
            }
            return true;
        });
  });

  $(window).resize(function() {
    adjustNavigation();
  });

  function adjustNavigation() {
    var padLeft = jQuery('#site-title').offset().left;
    jQuery('ul.sf-menu li:eq(0)').css('margin-left',padLeft+'px');

    jQuery('ul.sf-menu > li').each(function(index, value) {
      jQuery('li:eq(0)', this).css({
        'margin-left':padLeft+'px'
      });

      jQuery('li:eq(0) a', this).addClass('mnu-first');
    });
  }

  function sga_submit() {
    var emailfilter=/^\w+[\+\.\w-]*@([\w-]+\.)*\w+[\w-]*\.([a-z]{2,4}|\d+)$/i;
    $("#txtname, #txtemail").removeClass('error-input');
    var is_valid = true;
    if ($("#txtname").val()==""){
      $("#txtname").addClass('error-input').focus();
      is_valid = false;
    }

    if (emailfilter.test($("#txtemail").val())==false) {
      $("#txtemail").addClass('error-input').focus();
      is_valid = false
    }

    return is_valid;
  }
  </script>

  <style type="text/css">
    .single .<?php echo $fumco->news_page_id;?> {background-position: 0 -30px;}
    .single .<?php echo $fumco->news_page_id;?> a {color: #b27262;}
  </style>

</head> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:57:19.053

您的网站可能以某种方式被黑客入侵。查看 Google 拥有的缓存副本：[http ://webcache.googleusercontent.com/search?q=cache:S79-C5g4-2gJ:firstchurchorlando.org/+&cd=1&hl=en&ct=clnk&gl=us](http://webcache.googleusercontent.com/search?q=cache:S79-C5g4-2gJ:firstchurchorlando.org/+&cd=1&hl=en&ct=clnk&gl=us)

您不仅会看到大量关键字并且您的标题标签已更改，而且这里有一些有趣的地方，并且可能是问题的根源：

```
<!-- All in One SEO Pack 1.6.15.2 by Michael Torbert of Semper Fi Web Design[82,129] -->
<meta name="description" content="Duty Free Philippines Sale Items, Lucky Strike In Az @ Genuine Duty Free Cigarettes Online" />
<meta name="keywords" content="Duty, Free, Philippines, Sale, Items, Lucky, Strike, In, Az, " /> 
```

调查所有在一个 SEO 包插件中，更改所有网站密码......这应该可以解决您的问题

# extjs - ExtJS 数据变化事件

> ID：13070847
> 
> 赞同：2
> 
> 时间：2012-10-25T14:28:42.803
> 
> 标签：extjs, grid, panel, store

当 DataGrid 中的数据重新充电或呈现时会触发什么事件？

例如，显示过滤搜索结果的 DataGrid。每次使用不同的过滤器单击“搜索”按钮时，DataGrid 的结果（行数）都不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:51:37.787

你想做什么？您可以像这样在每个列上添加渲染器：

```
 {
            text: 'ChangedCaption',
            dataIndex: 'myBoolean',
            renderer: function (value, metaData, record, rowIndex, colIndex, store) {
                if (value == true) {
                    return 'Y'
                } else {
                    return 'N'
                }
            }
        }, 
```

# javascript - Javascript 不起作用：Firefox 中的编码错误

> ID：13070850
> 
> 赞同：1
> 
> 时间：2012-10-25T14:29:01.893
> 
> 标签：javascript, html, encoding

每当我尝试这样做时，我都会在 Firefox 控制台中收到以下错误：

[09:20:30.028] 未声明 HTML 文档的字符编码。如果文档包含 US-ASCII 范围之外的字符，则文档将在某些浏览器配置中呈现乱码。页面的字符编码必须在文档或传输协议中声明。

```
<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<title>this is a title</title>
<link rel="stylesheet" type="text/css" href="style.css" />
<script>
function showAnswer(){
    document.getElementById("ans").innerHTML="This is the answer";
}
</script>
</head>
<body>
<div id="q">
This is a question?
<button action="showAnswer()">Show Answer</button>
</div>
<div id="ans">
</div>
</body>
</html> 
```

抱歉，如果这是一个愚蠢的问题，我对此有点陌生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:32:11.950

你只需要；

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
```

应该解决你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:32:30.953

摆脱

```
<meta content="utf-8" http-equiv="encoding"> 
```

你只想...

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

这也是错误的……

```
<button action="showAnswer()">Show Answer</button> 
```

大概想要...

```
<button type="button" onclick="showAnswer()">Show Answer</button> 
```

> **见[http://jsfiddle.net/5Qtq2/](http://jsfiddle.net/5Qtq2/)**

# node.js - 如何使带有房间的 node.js 服务器可扩展

> ID：13070853
> 
> 赞同：2
> 
> 时间：2012-10-25T14:29:06.200
> 
> 标签：node.js, scalability, load-balancing

我设计了一个 Node.JS 服务器，它允许用户使用 websockets 登录、加入房间并与该房间中的其他用户交换数据。但是我现在正在寻找一种方法来使这个设置可扩展。

我花了整个下午研究各种负载均衡器，例如 nginx 和 haproxy，但我仍然不知道如何组织我的设置。

最初用户可以登录并查看活动房间。让这部分可扩展没什么大不了的。然而，他们可以加入一个特定的房间，此时他们需要与房间中的其他人连接到同一个 node.js 实例。这是我很难弄清楚的部分。

目前我的解决方案是创建两种不同类型的 node.js 实例。一种处理登录和房间概览请求方法的通用类型和一种处理多个房间的房间类型。然后，通用类型跟踪哪个特定实例负责哪个房间，并可以将正确的地址传递给用户的应用程序。

但是我对这个解决方案不满意，所以我愿意接受建议。我知道这是一个相当模糊的问题，但我不是在寻找一个确切的解决方案，而是关于如何组织一切的提示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:17:17.810

udidu 提到了一个可能的解决方案，但要扩展，您应该查看一个可扩展的 pub/sub 解决方案；[Redis](http://redis.io/)是一种流行的数据存储，[内置了 pub/sub](http://redis.io/topics/pubsub)，我经常使用它来取得很好的效果。

使用 Redis（或其他系统）帮助确保 Node.js 应用程序的每个实例都接收到有关谁在哪个房间聊天的信息，从而消除了房间中的所有用户都连接到同一个 Node.js 实例的依赖关系。

![带 PubSub 的 Redis 聊天](../Images/235647f2f967e2e47641c3502d7b4047.png)

# asp.net - DirectoryServicesCOMException 80072020 来自在 ApplicationPoolIdentity 下运行的 IIS 7.5 站点

> ID：13070856
> 
> 赞同：6
> 
> 时间：2012-10-25T14:29:20.883
> 
> 标签：asp.net, iis-7.5, directoryservices, applicationpoolidentity

我在寻找不时尝试获取给定用户的用户组时出现 ASP.NET 4 应用程序失败的问题时遇到了麻烦。与此应用程序关联的应用程序池设置为在 ApplicationPoolIdentity 下运行。

异常信息

```
System.DirectoryServices.DirectoryServicesCOMException
HRESULT: 80072020
Message: An operations error occurred.
Extended Message: 000004DC: LdapErr: DSID-0C0906E8, comment: In order to perform this operation a successful bind must be completed on the connection., data 0, v1db1 
```

堆栈跟踪

```
 System.DirectoryServices.DirectoryEntry.Bind(Boolean) 
    System.DirectoryServices.DirectoryEntry.Bind() 
    System.DirectoryServices.DirectoryEntry.get_AdsObject() 
    System.DirectoryServices.DirectorySearcher.FindAll(Boolean) 
    System.DirectoryServices.DirectorySearcher.FindOne() 
```

在 95%-99% 的情况下，此功能可以正常工作，但有时会开始失败。当我将应用程序池更改为使用 LocalSystem 或 NetworkService 时，它​​开始工作。当我改回 ApplicationPoolIdentity 时，它再次开始失败。使站点再次使用 ApplicationPoolIdentity 的唯一方法是重新启动服务器。

我能够在[这里](https://stackoverflow.com/questions/6867368/applicationpoolidentity-cannot-access-network-resources/6887333)找到类似的问题，但解决方案也是重新启动。我想找到一个更持久的解决方案，而不是更改应用程序池的身份。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-17T14:16:56.503

虽然重新启动将暂时解决问题，但有一个[Microsoft 修补程序 KB2545850](http://support.microsoft.com/kb/2545850)可以永久修复该问题。

# c++ - 创建注册表项 - 拒绝访问

> ID：13070858
> 
> 赞同：1
> 
> 时间：2012-10-25T14:29:29.923
> 
> 标签：c++, winapi

嗨，我正在尝试在 C++ 中创建一个注册表项，但我不断收到错误 5，谷歌搜索告诉我访问被拒绝，但我不知道要获得正确的权限。我正在使用 Windows 7，这是我的代码。谢谢

```
HRESULT hr = S_OK;
UINT er = ERROR_SUCCESS;
LPWSTR szValueBuf = NULL;
char szProductName[MAX_PATH];
LPSECURITY_ATTRIBUTES lpsa;
HKEY hOrchKey;
DWORD dwOpenStatus,
      dwType;
char szProuductKey[MAX_PATH];

hr = WcaInitialize(hInstall, "CreateProductKey");
ExitOnFailure(hr, "Failed to initialize");

WcaLog(LOGMSG_STANDARD, "Initialized.");

if (!(lpsa = default_sa()))
    return FALSE;

hr = WcaGetProperty(L"PRODUCTNAME",&szValueBuf);
ExitOnFailure(hr, "failed to get Product Name");

wcstombs(szProductName, szValueBuf, 260);

sprintf(szProuductKey,"SOFTWARE\\Company\\%s",szProductName);

// Open the registery Orchestrator key
if (RegCreateKeyEx(HKEY_LOCAL_MACHINE,
                szProuductKey,
                0,
                "",
                REG_OPTION_NON_VOLATILE,
                KEY_QUERY_VALUE,
                lpsa,
                &hOrchKey,
                &dwOpenStatus) != ERROR_SUCCESS )
    return FALSE;   

OS_RegCloseKey(hOrchKey);
return TRUE; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:07:12.937

以管理员身份运行以提升访问权限运行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:23:29.940

您必须以管理员身份访问注册表项 HKEY_LOCAL_MACHINE 才能编辑值。（例如，如果您想通过注册表编辑器应用程序编辑密钥，则必须右键单击并选择“以管理员身份运行”）由于您想在代码中编写值，因此您需要将编译器设置为具有管理员权限运行时的权利。在 Visual Studio 2008 中，这可以在解决方案的属性页中完成，您将其设置为以管理员身份运行。

这是怎么做的；在解决方案资源管理器中右键单击您的解决方案，然后选择属性；转到配置属性->链接器->清单文件；将 UAC 执行级别设置为“requireAdministrator”。

下次你点击运行时，它应该会提示你以管理员身份打开它，然后它会允许你更改密钥。我不确定如何使用其他编译器执行此操作，但它应该是相对相同的。但是，即使在发行版中，它也会始终要求您提供管理员权限，这对于大多数程序来说并不理想。如果这是一个安装程序或其他东西，那么我会说这很好，但如果这是一个会经常运行的应用程序，我建议使用 HKEY_LOCAL_USER，它不需要管理员权限。我最近经历了所有这些问题，而注册表是一个正确的婊子，所以我建议尽可能避免它！

希望有帮助！

# css - 修复了头部和菜单问题

> ID：13070859
> 
> 赞同：0
> 
> 时间：2012-10-25T14:29:33.943
> 
> 标签：css, menu, position, fixed, head

我们在我们的网站上做了一个固定的头部和菜单。但是菜单有一点透明度，所以基本上内容会通过我们的菜单。

有没有办法切断它。所以基本上内容只是停在菜单上。当您滚动时，您有一个固定的头部，但内容不会看穿或（在侧面）。

谢谢！网址：[http ://sea-and-wetest.netserver11.net/](http://sea-and-wetest.netserver11.net/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:50:30.670

我看到背景图像来自实际标签。

所以，你可以做的是再次添加相同的图像，除了它的高度之外，它具有相同的 css 样式，它应该等于标题和菜单栏组合的高度，并且它应该从堆叠上下文的角度来看，低于标题和菜单栏，但在内容主体之上。

这是一个玩弄 html 上元素的顺序并选择正确的 z-index 的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-07T10:31:18.463

```
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>head fixed</title>

<style>

#dvHead {position:fixed;left:19px;top:12px;height:24px;background-color:#d8d7c0;color:#888888;border:1px solid #c4bc8b;}
#dvBody {position:fixed;left:20px;top:38px;height:100px;background-color:#dddddd;overflow:auto;}
td {border:1px solid #c4bc8b;}

</style>

<script>

function initpage() {
resize_thead();
}

function resize_thead() {for(var i=0;i<3;i++){document.getElementsByTagName("table")[0].firstElementChild.rows[0].childNodes[i].width=document.getElementsByTagName("table")[1].firstElementChild.rows[0].childNodes[i].clientWidth;}}

</script>

</head>

<body onload="initpage()">

<div id="dvHead">
<table>
<tr><th>TH 1</th><th>TH 2</th><th>TH 3</th></tr>
</table>
</div>

<div id="dvBody">
<table>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
<tr><td>TD 1</td><td>TD 2</td><td>TD 3</td></tr>
</table>
</div>
</body>
</html> 
```

# view - DB2：查询所需的优化

> ID：13070864
> 
> 赞同：0
> 
> 时间：2012-10-25T14:30:02.393
> 
> 标签：view, db2

我必须通过以下方式从 .NET 从 DB2 数据库中获取数据：

1.  连接 5 个表 2 内连接 3 左外连接
2.  数据必须写入文本文件。因此必须使用诸如 LPAD/RPAD、substr 等格式化函数。
3.  检索到的数据约为 100000 行

我打算创建一个视图，以便应用程序摆脱连接，并且我只在视图中获得所需的列。我想知道如果数据的格式也应该移到视图的定义中？所以在应用程序中我只会执行

> 从视图中选择 *

请指教

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:21:19.753

从数据库引擎的角度来看，无论是应用程序提交带有连接、文本函数等的查询，还是所有这些都包含在一个视图中并且应用程序执行一个简单的`select * from view`. DB2 以完全相同的方式编译查询。

使用视图的唯一“优势”是为应用程序开发人员提供便利。当然，将 SQL 语句放入视图的缺点是，如果需求发生变化，您将不得不修改视图。

至于在视图中包含文本格式：如果此视图仅存在以支持这个单一应用程序（并且您只是为了方便而使用它），那么在视图定义中包含格式可能是有意义的。但是，如果其他应用程序可能需要视图（但不是文本格式），那么在查询中保留视图中的格式是更好的选择。

作为 DBA，我建议文本格式化的*最佳*位置是在您的应用程序代码中。使用（或等效）编写格式化字符串`printf()`是应用程序通常非常擅长的事情。

# asp.net - 拦截文件服务器上文件的http请求

> ID：13070867
> 
> 赞同：0
> 
> 时间：2012-10-25T14:30:06.403
> 
> 标签：asp.net, wcf, httphandler, httpmodule

> http://myfileserver/images/car/chevrolet.gif

我有这个文件服务器保存图像、文档文件等文件。现在我想拦截 http 请求并根据文件扩展名执行一些操作，例如重定向到其他网页。

完成这件事的最好和更简单的方法是什么？我正在为我的应用程序使用 asp.net 框架。

请建议该方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:38:52.070

If you are looking to intercept the request for specific file types, then go with an Http Handler. Here is the MSDN link explaining their usage - [Http Handlers](http://msdn.microsoft.com/en-us/library/5c67a8bd%28v=vs.71%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:45:55.153

在 WCF 世界中，如果您希望根据请求的文件类型使用不同的选项处理 HTTP 请求，您可能需要考虑添加一个`IDispatchOperationSelector`，它允许服务通过不同的操作路由代码。默认的 HTTP 实现是，[这里](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.webhttpdispatchoperationselector.aspx)和[这里](http://blogs.msdn.com/b/carlosfigueira/archive/2011/05/10/wcf-extensibility-operation-selectors.aspx)`WebHTTPDispatchOperationSelector`都有很好的解释。

如果您想留在 Asp.Net 世界中，我建议您使用自定义消息处理程序。这是Mike Wasson 的[一篇文章](http://www.asp.net/web-api/overview/working-with-http/http-message-handlers)，解释了这些是如何工作的以及它们在 Asp 堆栈中的位置。

# css - 左定位引导弹出框

> ID：13070870
> 
> 赞同：8
> 
> 时间：2012-10-25T14:30:19.553
> 
> 标签：css, twitter-bootstrap, popover

我有一个出现在标签左侧的弹出框：

```
 $('label').hover(function () {
                $(this).popover({
                    offset: 10,
                    placement: 'left'
                }).popover('show'); 
```

弹出框当前正在阻止一个单选按钮，我想将其向左移动，例如 10 像素。我似乎无法弄清楚如何做到这一点。offset 似乎什么都不做（如果我添加 10 或 10000 并没有什么不同）。以下是此类标签的 HTML：

```
 <label for="MainContent_Wizard1_rbLeader" id="MainContent_Wizard1_lblLeader" class="radio" data-original-title="Visionary Giving Level" data-content="Diamond (full-page ad) + 2 dinner tickets">Visionary ($250,000)<span class="radio" name="rbLeader"><input id="MainContent_Wizard1_rbLeader" type="radio" name="ctl00$MainContent$Wizard1$GivingLevel" value="rbLeader" onclick="WizardStep1_Click();" /></span></label> 
```

我可以尝试通过覆盖 CSS 中的类来设置弹出位置，例如：

```
.popover {
    left: 380px !important;
} 
```

但这远非理想，因为它使用不同的浏览器出现在不同的地方。

**必须**有一种方法可以添加一个小的右边距，是吗？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-26T00:45:15.987

为单个弹出框设置样式似乎是不可能的，而且 - 正如 Sara 所提到的 - 没有这样的选项`offset`（您可能会想到 qtip？）。但是，您可以使用未记录的选项`template`，从选项“派生” `tooltip`（实际上，popover 只引入`content`）。

通过修改`template`，您可以单独设置每个弹出框的样式！在我看来，您的问题`arrow`不仅仅是弹出框本身，因此您可以尝试从中间向上或向下移动箭头，只需向模板添加箭头样式，就像这样

```
$('label').hover(function() {
    $(this).popover({
        placement: 'left',
        template: '<div class="popover"><div class="arrow" style="top:65px;"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'
    }).popover('show');
}); 
```

当然，这里为所有标签设置的所有弹出框的箭头将`$('label').hover`因

更新 - 将整个弹出框样式设置为左侧 +10px

```
...
 template: '<div class="popover" style="margin-left:-10px;"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-05T11:29:15.630

试试这个来添加右边距：

```
.popover.left{
  left: calc(100% - 10px) !important;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-15T15:41:13.900

您可以将 data-placement='left' 添加到元素。

# python - OSX 上的 Python，有关站点包文件夹的错误

> ID：13070872
> 
> 赞同：0
> 
> 时间：2012-10-25T14:30:21.553
> 
> 标签：python, three.js, osx-mountain-lion, maya

我正在尝试运行 python 脚本将 FBX 模型从 Maya 转换为 ThreeJS JSON 可加载模块。我正在运行 OSX Mountain Lion。每当我尝试运行脚本时，都会收到以下错误：

```
You need to copy the content in compatible subfolder under /lib/python<version> into your
python install folder such as "/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages" folder. 
```

有人遇到过这个问题和/或知道如何解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T19:35:11.143

我想到了。显然，该`site-packages`目录位于`/Library/Python/2.6`

# box-api - box-api 下载文件：如何使用正确的编码将原始文本响应保存到文件中

> ID：13070873
> 
> 赞同：0
> 
> 时间：2012-10-25T14:30:24.373
> 
> 标签：box-api

我实现了下载文件。我收到了原始字符串数据。我将此数据保存到文件中，但无法打开它，因为文件无效。

我试图下载jpg图像。我认为这是将此数据错误地转换为字节的结果。

我需要使用什么编码？

# c# - Console.Writeline 适用于 x86 但不适用于 x64

> ID：13070874
> 
> 赞同：7
> 
> 时间：2012-10-25T14:30:30.590
> 
> 标签：c#, visual-studio, visual-studio-debugging, console.writeline

我正在 Visual Studio 2012 中测试一个项目。

当我在 x86 中运行我的代码时，会`Console.Writeline`显示在输出窗口中。但是，当我在 x64 中运行它时，它不会。

我知道我可以`System.Diagnostics.Debug`改用，但我真的很想了解为什么`Console.Writeline`不起作用，或者某处是否有设置。

谢谢。

**编辑：**观察：两个版本都禁用了 Visual Studio 托管过程。当我启用它时，所有`Console.Writeline`消息都显示为 x64 和 x86。当我再次禁用它时，只有 x86 显示`Console.Writeline`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:32:42.103

两者应该没有区别。很可能您的 x86 和 x64 编译配置文件之间存在配置差异。检查以确保在这两种情况下都在构建控制台应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-05T06:51:56.163

确保在创建 x64 时从 AnyCpu 复制设置。我遇到了类似的问题，但是一旦我复制了它，它就可以正常工作。

# delphi - 在 Delphi XE2 TActionMainMenubar 中显示提示

> ID：13070876
> 
> 赞同：3
> 
> 时间：2012-10-25T14:30:31.957
> 
> 标签：delphi, menu, action, delphi-xe2

我正在努力尝试在 TAc​​tionMainMenuBar 中显示提示。德尔福 XE2。

我在运行时创建菜单。我添加类别、子项、清除菜单，一切都很好。单击菜单项可以正常工作（现在它只是执行带有操作项标记的 ShowMessage ，但这很好）。

这是添加新菜单项的代码：

```
function TActionF.NewAction(AParent: TActionClientItem; Caption: String; aTag : integer; ExecuteAction: TNotifyEvent):TActionClientItem;
var
  newActionClient : TActionClientItem;
  AnewAction : TAction;
begin
  newActionClient := TActionClientItem(AParent.Items.insert(AParent.Items.Count));
  newActionClient.Caption := Caption; //??
  newActionClient.UsageCount := -1; // turn of menu priority stuff for now
  AnewAction := TAction.Create(Self);
  AnewAction.Tag := aTag;
  AnewAction.ImageIndex := -1;
  AnewAction.Caption := Caption;
  AnewAction.Hint := Caption + 'Action Tag = ' + IntToStr(aTag);
  AnewAction.OnHint := acnDoHint;  // fixed, could be parameter, but onHint is never called    !!??
  AnewAction.OnExecute := ExecuteAction; // passed as parameter
  newActionClient.Action := AnewAction;
  Result := newActionClient;
end; 
```

我正在设置动作的“提示”。我也尝试过分配 OnHint，但从未调用过 OnHint。浏览菜单时我根本无法获得该提示。

我在所有可以看到的地方都将 ShowHint 设置为 True。

问题是无论我尝试什么都无法显示任何菜单提示。如果我能得到它，我可以自己展示它（如果程序不会）。OnHint 永远不会被调用。

我已经在我的公共 DropBox 中发布了我的菜单程序 (Delphi XE2) 的完整源代码，如果有人想查看该程序，我会尽可能缩小范围。

[https://dl.dropbox.com/u/58421925/Actions.zip](https://dl.dropbox.com/u/58421925/Actions.zip)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-29T06:25:21.023

这正是您想要的：www.delphi.about.com/od/vclusing/a/menuitemhints.htm

它处理 WM_MENUSELECT 消息并在自己的窗口中显示提示（ TMenuItemHint = class(THintWindow) ）。

# javascript - 在javascript中使用逗号格式化字符串

> ID：13070884
> 
> 赞同：1
> 
> 时间：2012-10-25T14:30:53.047
> 
> 标签：javascript, string, formatting

让我有部分用户地址应该格式化为单个字符串。
地址组件是

```
Street  
City  
Phone  
State  
Zip 
```

并且应该格式化为 string `street city, phone, state zip`。（2 个逗号）。
问题是每个领域都可以`null`。所以如果`street == null`和`city == null`，那么我应该有字符串`phone, state zip`（1个逗号）。问题在于控制空格数和逗号数
**如何避免和最小化空检查的数量？**
我目前的代码是

```
 var formatAddress = function(address) {
     var retVal = ""

     if (address.street || address.city)
     {
        retVal += address.street ? address.street + " " : "" 
        retVal += address.city ? address.city : "" 
        retVal += ", ";
     }
     retVal += address.phone ? address.phone + ", " : ""

     retVal += address.state ? address.state : ""
     retVal += address.zip ? " " + address.zip : ""  

     return retVal
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:43:13.037

```
var fields = [[address.street, address.city], [address.phone], [address.state, address.zip]];
return fields.map(function(part) {
    return part.filter(Boolean).join(" ");
}).filter(function(str) { return str.length; }).join(", "); 
```

或者，在没有`filter`and的循环中`map`，但是将属性名称映射到它们的值：

```
var fields = [["street", "city"], ["phone"], ["state", "zip"]];
for (var strs=[], i=0; i<fields.length; i++) {
    for (var parts=[], j=0; j<fields[i].length; j++)
        if (address[fields[i][j]])
            parts.push(address[fields[i][j]]);
    if (parts.length)
        strs.push(parts.join(" "));
}
return strs.join(", "); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:38:46.130

将其添加到数组并删除一些相邻的逗号和空格。

```
var street = "street";
var city = "city";
var phone = "phone";
var state = "state";
var zip = "zip";
[
    street,
    city, ",",
    phone, ",",
    state,
    zip
].join(" ") //add all items with spaces in between
.replace(/(\s*,\s*)+/g, ", ") //remove multiple spaces before or after commas
.replace(/\s+/g, " "); //remove any other double spaces 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:37:15.323

可以通过以下功能更清洁：

```
function formatAddressPart(part,concatString){
     return part ? part+concatString : "";
}

var formatAddress = function(address) {
     var retVal = ""

     if (address.street || address.city)
     {
        retVal += formatAddressPart(address.street, " ");
        retVal += formatAddressPart(address.city,""); 
        retVal += ", ";
     }
     retVal += formatAddressPart(address.phone,", ");

     retVal += formatAddressPart(address.state," ");
     retVal += formatAddressPart(address.zip,"");  

     return retVal
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:09:35.107

将您的字符串放入一个数组中，然后使用 join 方法并使用单个逗号删除多个连续逗号

```
a = [address.Street, 
     address.City, 
     address.Phone, 
     address.State, 
     address.Zip].join (', ').replace (/(, ){2,}/g, ', '); 
```

# authentication - 通过 web.xml 中的安全约束进行身份验证，localhost 除外

> ID：13070885
> 
> 赞同：0
> 
> 时间：2012-10-25T14:30:54.397
> 
> 标签：authentication, glassfish, localhost, web.xml, security-constraint

在 Java EE Servlet 容器（Tomcat、Glassfish 等）的 web.xml 中，我可以设置一个安全约束来限制对某个资源的访问。

是否可以区分来自 localhost 的访问和所有其他访问？我想在 glassfish 服务器中为对 webapp 的所有外部调用启用身份验证，但不是从 localhost。那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T16:11:24.040

把它放在你的`/META-INF/context.xml`：

```
<Context>
    <Valve className="org.apache.catalina.valves.RemoteAddrValve" deny="127\.0\.0\.1"/>
</Context> 
```

# silverlight - InvalidOperationException 在设备中抛出但不是模拟器

> ID：13070887
> 
> 赞同：0
> 
> 时间：2012-10-25T14:31:07.450
> 
> 标签：silverlight, windows-phone-7, invalidoperationexception

在我的`WP7`应用程序中，`InvalidOperationException`被扔进了设备中（虽然它在模拟器中运行良好）。从提供的堆栈`Microsoft`跟踪来看，似乎源代码可能是以下代码。

```
Image start_rec = (Image)FindName(start_name);
// Return the general transform for the specified visual object.
GeneralTransform generalTransform1 = canvas1.TransformToVisual(start_rec);
pt = generalTransform1.Transform(new Point(0, 0));
double start_y = pt.Y * (-1);
double start_x = pt.X * (-1);
Image destination_rec = (Image)FindName("dot" + destination_name);
// Return the general transform for the specified visual object.
generalTransform1 = canvas1.TransformToVisual(destination_rec);

// Retrieve the point value relative to the child.
pt = generalTransform1.Transform(new Point(0, 0));
double destination_y = pt.Y * (-1);
double destination_x = pt.X * (-1); 
```

**我在上面的代码中尝试做的事情**：`canvas1`. 我正在尝试在画布上获取图像的位置。

我的问题是为什么我得到`Exception`?

**编辑：**堆栈跟踪是

```
Frame    Image             Function                                            Offset    
0        coredll.dll       xxx_RaiseException                                  19        
1        mscoree3_7.dll                                                        436172    
2        mscoree3_7.dll                                                        383681    
3        mscoree3_7.dll                                                        540620    
4                          TransitionStub                                      0         
5                          Microsoft.Xna.Framework.Audio.SoundEffect.Play      200       
6                          Microsoft.Xna.Framework.Audio.SoundEffect.Play      68        
7                          BoxIt.MainPage.correct_line                         1780      
8                          BoxIt.MainPage.evaluate                             360       
9                          BoxIt.MainPage.canvas1_ManipulationCompleted        196       
10                         MS.Internal.CoreInvokeHandler.InvokeEventHandler    2752      
11                         MS.Internal.JoltHelper.FireEvent                    1324      
12       mscoree3_7.dll                                                        428848    
13       mscoree3_7.dll                                                        430212    
14       mscoree3_7.dll                                                        610999    
15       mscoree3_7.dll                                                        374145    
16                                                                             0         
17       agcore.dll        CCoreServices::CLR_FireEvent                        385       
18       npctrl.dll        CControlBase::ScriptCallback                        435       
19       npctrl.dll        CXcpDispatcher::OnScriptCallback                    547" 
```

**编辑 2：**函数内的代码`correct_line()`

```
void correct_line(int a_h, int a_v)
    {
        Point pt;
        int destination_num;
        string destination_name;

        string[] words = start_name.Split('t');
        //textBox1.Text = words[1];

        int.TryParse(words[1], out destination_num);
        int start_num = destination_num;
        destination_num = destination_num + a_h + a_v * 4;
       // textBox1.Text = start_num + "  " + destination_num;
        Boolean u = true;
        if (list.Count > 0)
        {
            u=!(list.Contains(start_num + destination_num));
        }
        if (u)
        {
            if (start_num > 0 & destination_num > 0)
            {
                int po = Math.Abs(start_num-destination_num);
                if(po==1 | po==4)
                {
                destination_name = (destination_num).ToString();
                Image start_rec = (Image)FindName(start_name);
                // Return the general transform for the specified visual object.
                GeneralTransform generalTransform1 = canvas1.TransformToVisual(start_rec);
                pt = generalTransform1.Transform(new Point(0, 0));
                double start_y = pt.Y * (-1);
                double start_x = pt.X * (-1);
                Image destination_rec = (Image)FindName("dot" + destination_name);
                // Return the general transform for the specified visual object.
                generalTransform1 = canvas1.TransformToVisual(destination_rec);

                // Retrieve the point value relative to the child.
                pt = generalTransform1.Transform(new Point(0, 0));
                double destination_y = pt.Y * (-1);
                double destination_x = pt.X * (-1);

                //textBox1.Text = " " + start_num + " " + a_h + " " + destination_num + " " + a_v ;
                Line line = new Line() { X1 = start_x + dotwidth / 2, Y1 = start_y + dotwidth / 2, X2 = destination_x + dotwidth / 2, Y2 = destination_y + dotwidth / 2 };
                if (msg == "2" & move == 2)
                {
                    line.Stroke = new SolidColorBrush(Colors.Black);
                }
                else
                {
                    line.Stroke = new SolidColorBrush(Colors.White);
                }
                line.StrokeThickness = 15;
                line.SetValue(Canvas.ZIndexProperty, 25);
                line.Tag = "correct_line";
                this.canvas1.Children.Add(line);
                if (gsplay == 1)
                {
                    //stroke.Play();
                    strokemusic.Play();
                }
                //
                update_matrix(start_num, destination_num);
                list.Add(start_num + destination_num);

                //
                h = 0;
                v = 0;
                //move = checkfor_box(start_num, destination_num, a_h, a_v);
                move = checkfor_box3();
                find_move();

            }
            }
        }
    } 
```

`Soundeffect`在`OnNavigatedTo`函数中启动

```
 protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
    {
        base.OnNavigatedTo(e);

        if (settings.Contains("gs"))
        {
            string hx = (string)settings["gs"];

            if (hx == "1")
            {
                gsplay = 1;
                var laserStream1 =  Application.GetResourceStream(new Uri("boxdone.wav", UriKind.Relative));

                boxdonemusic = SoundEffect.FromStream(laserStream1.Stream);

                var laserStream2 =  Application.GetResourceStream(new Uri("stroke.wav", UriKind.Relative));

                strokemusic = SoundEffect.FromStream(laserStream2.Stream);

            }
            else
            {
                gsplay = 0;
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T19:21:42.663

异常会在`strokemusic.Play();`您的`correct_line`方法行抛出，这是肯定的。现在的问题是知道为什么。

经过一番挖掘，似乎`InvalidOperationException`播放声音时出现的两个主要原因是：

*   声音未以支持的格式存储。这不太可能，因为它也可能会在模拟器中崩溃
*   手机连接到 Zune，在这种情况下不允许应用程序播放声音。它还可以解释为什么错误只发生在真实设备上（模拟器没有连接到 Zune）。

如何解决问题？Simpy 用 try/catch 子句包围你的行：

```
try
{
    strokemusic.Play();
}
catch (Exception) { } 
```

# asp.net - 进入reference.cs文件

> ID：13070888
> 
> 赞同：2
> 
> 时间：2012-10-25T14:31:11.010
> 
> 标签：asp.net

我有一个基于 SOAP 的 Web 服务，带有关联的 reference.cs 文件（不是 WCF）。服务返回无效响应。reference.cs 文件有一个我想进入的 testRequest 方法。我对服务的控制有限，所以我想用我自己的测试响应覆盖 results[0] 行，以尝试确定响应无效的确切原因。但是，我不能进入 testRequest。为什么不？结果[0]到底是什么？我尝试使用字符串中的 Soap XML 自己进行转换，但我收到一条消息说我无法从字符串转换到该对象。如果它不是字符串，那么此时的结果 [0] 是什么？

```
 [System.Web.Services.Protocols.SoapHeaderAttribute("SecurityValue")]
    [System.Web.Services.Protocols.SoapHeaderAttribute("MessageHeaderValue")]
    [System.Web.Services.Protocols.SoapDocumentMethodAttribute("", Use=System.Web.Services.Description.SoapBindingUse.Literal, ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Bare)]
    [return: System.Xml.Serialization.XmlElementAttribute("TestResponse", Namespace="http:/test/Services")]
    public TestResponse testRequest([System.Xml.Serialization.XmlElementAttribute("TestRequest", Namespace="http://Test.com/TestServices")] TestRequestTestRequest1) {
        object[] results = this.Invoke("TestRequest", new object[] {
                    TestRequest1});
        return ((TestResponse)(results[0]));
    } 
```

更新 #1 您可以通过转到工具 => 选项 => 调试 => 常规并取消选中“仅启用我的代码”来进入 response.cs。问题是请求到达了我的电脑，但在 this.Invoke 被调用之后“结果”变量为空。我现在的问题是如何拦截 this.Invoke 正在进行的调用并插入我自己的响应。我没有开发人员访问实际服务的权限。也许我需要编写一个测试服务......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T12:00:04.483

我创建了一个测试服务，它只返回一个硬编码的 SOAP 响应。这有助于我诊断响应问题。问题最终是缺少命名空间

# ios - MKAnnotationView 中的条纹

> ID：13070891
> 
> 赞同：1
> 
> 时间：2012-10-25T14:31:28.713
> 
> 标签：ios, mkmapview, subclass, mkannotationview, mapkit

在我们制作的应用程序中，我们使用了子类 MKAnnotationView。我们增加

```
PLCalloutButton* rightButton = [PLCalloutButton buttonWithType:UIButtonTypeCustom];
rightButton.tag = PLTagDetailPin;
self.rightCalloutAccessoryView = rightButton; 
```

和

```
PLFavoriteButton* favoriteButton = [PLFavoriteButton buttonWithType:UIButtonTypeCustom];
favoriteButton.zoneInfo = zoneInfo;
self.leftCalloutAccessoryView = favoriteButton; 
```

这就是这个子类中发生的所有事情。

点击注释时，视图按预期呈现，但有时会出现奇怪的条纹，好像拉伸没有正确完成。如下图所示，部分背景丢失了，有时这个背景条纹在注释视图中的其他位置（所以我们也有一个深色条纹）。

我该如何解决这个问题？

![MKAnnotationView 中的条纹](../Images/672949f74ef30e2318418719d896e636.png)

# mysql - SELECT 语句 WHERE BETWEEN 计算字段 - 空结果

> ID：13070903
> 
> 赞同：2
> 
> 时间：2012-10-25T14:32:08.523
> 
> 标签：mysql

我在 MySQL 中的 select 语句有问题。

我有两个陈述只是略有不同，第一个似乎有效，但第二个无效。第二条语句返回 0 个结果。我错过了什么/做错了什么？

## 设置变量

```
SET @maxOK = 1.2;
SET @minOK = .8; 
```

# 1# 之间没有

```
SELECT *, fee - (receipts * -1) AS difference
FROM div.Data1
WHERE (receipts * -1) NOT BETWEEN (fee * @minOK) AND (fee * @maxOkay); 
```

# 2#之间

```
SELECT *, fee - (receipts * -1) AS difference,
          receipts * -1 as rec,
          fee * @minOk as min, fee * @maxOk as max
FROM div.Data1
WHERE (receipts * -1) BETWEEN (fee * @minOK) AND (fee * @maxOkay); 
```

# 一些应该显示为两个但没有显示的数据

```
SELECT *, fee - (receipts * -1) AS difference,
          receipts * -1 as rec,
          fee * @minOk as min, fee * @maxOk as max
FROM div.Data1 
```

![在此处输入图像描述](../Images/546bc6881468bd6f8852bda498fa9f81.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:37:56.980

尝试在您的 SELECT 中包含 where 子句组件。IE：

```
SELECT (fee * @minOK) as wheremin, (fee * @maxOkay) as wheremax, *, fee - (receipts * -1) AS difference, receipts * -1 as rec, fee * @minOk as min, fee * @maxOk as max FROM div.Data1 WHERE (receipts * -1) BETWEEN (fee * @minOK) AND (fee * @maxOkay); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:49:23.250

你的陈述有误。您已声明`@maxOk`但正在`@maxOkay`您的`BETWEEN`条款中使用。

由于`@maxOkay`未在任何地方声明，因此它已初始化为，`NULL`因此**您的语句基本上归结为**

```
SET @maxOK = 1.2;
SET @minOK = .8;

SELECT *
       , fee - (receipts * -1) AS difference
       , receipts * -1 as rec
       , fee * @minOk as min
       , fee * @maxOk as max
FROM Data1
WHERE (receipts * -1) BETWEEN (fee * @minOK) AND NULL 
```

**声明*应该*是**

```
SET @maxOK = 1.2;
SET @minOK = .8;

SELECT *
       , fee - (receipts * -1) AS difference
       , receipts * -1 as rec
       , fee * @minOk as min
       , fee * @maxOk as max
FROM Data1
WHERE (receipts * -1) BETWEEN (fee * @minOK) AND (fee * @maxOK); 
```

# android - 让设备充当打印机

> ID：13070906
> 
> 赞同：0
> 
> 时间：2012-10-25T14:32:13.440
> 
> 标签：android, printing

我正在尝试将我的 Android 平板电脑连接到医院机器。这台机器可以打印到多台打印机，如“Canon IP2600”。但是当我将平板电脑连接到机器并尝试从机器打印到平板电脑时，机器说：找不到 USB 打印机。（当然）。

现在我的问题是，我怎样才能让机器认为连接了打印机而不是安卓平板电脑？

我的理论是：将平板电脑连接到机器时，平板电脑 USB 设备描述符被发送到机器，并且该设备描述符不像“佳能 IP2600”之一。

我在思考正确的方向吗？欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:21:35.023

AFAIK 平板电脑并非旨在“打印”到。

我不是说你想做的事情是不可能的，但我不确定它是否现实。您将考虑构建大量定制软件。为了“打印”到 USB 设备，您需要为您的操作系统（我假设是 Windows）编写驱动程序，以使计算机能够将该电缆连接视为打印机。即使你已经这样做了，你还需要编写更多的驱动程序和软件，让平板电脑了解它何时连接到计算机并接受传入的打印件。

我不确定您的要求有多灵活，但更现实的选择可能是使用 Google Drive（以前称为 Google Docs）。您可以在计算机上打印为 PDF 文件（使用 PrimoPDF 之类的文件）并将其直接保存在 Google Drive 文件夹中。通过同步设置，该文件将在几秒钟内使用 Google Drive 应用程序在您的平板电脑上可用。

# objective-c - Objective-C 函数 vm_deallocate 的 Objective-C++ 等效项

> ID：13070907
> 
> 赞同：0
> 
> 时间：2012-10-25T14:32:15.047
> 
> 标签：objective-c, objective-c++

我有一些我想转换为 Objective-C++ 的 Objective-C 代码。要将源文件的扩展名从 更改`.m`为`.mm`，我将文件类型设置为`Objective-C++ Source`. 但是，现在我的项目无法构建。它在我调用的行上给出错误`vm_deallocate`。

这是行：

```
vm_deallocate(mach_task_self(), (vm_address_t)prevInfo, prevInfo); 
```

确切的错误是：

> 使用未声明的标识符 vm_deallocate

`vm_deallocate`仅限于Objective-C ？是否有等效的 Objective-C++ 函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:42:33.223

不，因为它是c。这更像是一个标题问题。

确保您已包含在正确的文件中

```
#include <mach/mach_init.h>
#include <mach/vm_map.h> 
```

它应该毫无怨言地编译。

# sorting - Solr TrieFloat 和 SortableFloatField，最适合浮点数排序

> ID：13070910
> 
> 赞同：1
> 
> 时间：2012-10-25T14:32:34.747
> 
> 标签：sorting, solr, floating-point

我有一个 Solr 模式，其中一个字段被声明为 TrieFloatField：

```
 <fieldType name="tfloat" class="solr.TrieFloatField" precisionStep="8" omitNorms="true" positionIncrementGap="0"/>

(...)

    <field
                name="someField"
                type="tfloat"
                indexed="true"
                stored="false"
                multiValued="false" /> 
```

如果我使用它对结果进行排序，如下所示：

```
solrQuery.addSortField("someField", ORDER.asc);
solrQuery.addSortField("score", ORDER.desc); 
```

浮点数未按正确的数字顺序返回，即：我会得到如下结果：

0.31 0.67 0.80 15.13 0.09 15.13 0.04

更奇怪的是，当我使用此字段对结果进行排序时，确实会发生一些排序（它们的顺序不同，假设我根本不使用任何排序字段）。此外，即使我将排序顺序从 asc 更改为 desc，结果也是相同的顺序。

我认为 TrieFloat 类型可以很好地解决这个问题。但是我现在在文档中看到他们只提到它是“浮点字段可访问的 Lucene TrieRange 处理”：

[http://lucene.apache.org/solr/api-4_0_0-ALPHA/org/apache/solr/schema/TrieFloatField.html](http://lucene.apache.org/solr/api-4_0_0-ALPHA/org/apache/solr/schema/TrieFloatField.html)

老实说，我真的不知道那是什么意思。我还看到有一个 SortableFloatField：

[http://www.jarvana.com/jarvana/view/org/apache/solr/solr-core/3.5.0/solr-core-3.5.0-javadoc.jar!/org/apache/solr/schema/SortableFloatField .html](http://www.jarvana.com/jarvana/view/org/apache/solr/solr-core/3.5.0/solr-core-3.5.0-javadoc.jar!/org/apache/solr/schema/SortableFloatField.html)

但是文档并没有真正说明它在用作排序标准时的行为方式。

我的问题很简单：这两种类型中的哪一种（或其他类型）适合存储浮点数，以便它们可以用于 Solr 查询中的正确（自然）升序和降序排序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T16:42:06.633

这两个类都应该可以工作，但`TrieFloatField`需要的内存要少得多`SortableDoubleField`（假设前者使用浮点字段缓存，而后者使用字符串字段缓存）。请注意，如果您不需要执行范围查询，则应设置`precisionStep=0`.

但是，您遇到的错误很奇怪...

# c# - 是否有在中等信任下工作的免费 C# PDF 生成器？

> ID：13070912
> 
> 赞同：3
> 
> 时间：2012-10-25T14:32:39.477
> 
> 标签：c#, asp.net-mvc, pdf, pdf-generation

我一直在寻找 C#（iTextSharp 和 PDFSharp 等）的 PDF 生成器的常见嫌疑人。

问题是它们都不能在中等信任环境中工作。有谁知道一个 100% 在中等信任下工作的库？最好是免费的，但最多 100 美元或 200 美元？

**更新：**

在有人评论之前，如果您将 iTextSharp 更改`assembly.cs`为允许部分受信任的呼叫者，则 iTextSharp 以中等信任工作，但事实并非如此。我已经尝试了所有的“黑客”，但它根本无法在中等信任环境中工作 - 即使添加了部分信任的调用者行，您也会收到以下错误。

```
Request for the permission of type 'System.Security.Permissions.
SecurityPermission, mscorlib, Version=4.0.0.0, Culture=neutral, 
PublicKeyToken=b77a5c561934e089' failed. 
```

# c# - FileSystemWatcher 跳过 Created-events

> ID：13070916
> 
> 赞同：0
> 
> 时间：2012-10-25T14:33:05.403
> 
> 标签：c#, file-monitoring

如果创建了任何文件，我有一个`FileSystemWatcher`检查多个目录。

```
 ((System.ComponentModel.ISupportInitialize)(FileMonitor)).BeginInit();
            FileMonitor.EnableRaisingEvents = true;
            FileMonitor.Created += new FileSystemEventHandler(FileMonitor_Created);
            FileMonitor.Path = Path.ToString();
            FileMonitor.IncludeSubdirectories = true;
            FileMonitor.NotifyFilter = NotifyFilters.LastAccess | NotifyFilters.LastWrite | NotifyFilters.FileName | NotifyFilters.DirectoryName | NotifyFilters.Attributes;
            ((System.ComponentModel.ISupportInitialize)(FileMonitor)).EndInit(); 
```

由于某种原因，FileMonitor_Created 事件在运行应用程序时并不总是被触发，即使它应该触发。感觉很随意...

但是，如果我在 FileMonitor_Created 方法处设置断点，它会完美运行：如果设置了断点，则该事件每次应该触发。

我尝试为 FileMonitor 设置一个 InterBufferSize，但这没有效果。

**更新**

我将`Changed`事件添加到 Filemonitor 并为其提供与`Created`事件相同的处理程序。它现在以某种方式工作，尽管该文件实际上是创建的，而不是更改的。

我仍然很好奇为什么在设置断点时它总是以“旧方式”工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:42:08.137

你做了多少改变？

> Windows 操作系统会通知您的组件有关 FileSystemWatcher 创建的缓冲区中的文件更改。如果短时间内有很多变化，缓冲区可能会溢出。这会导致组件丢失对目录更改的跟踪，并且它只会提供一揽子通知。使用 InternalBufferSize 属性增加缓冲区的大小是昂贵的，因为它来自无法换出到磁盘的非分页内存，因此请保持缓冲区小而大，以免错过任何文件更改事件。要避免缓冲区溢出，请使用 NotifyFilter 和 IncludeSubdirectories 属性，以便您可以过滤掉不需要的更改通知。

取自[MSDN](http://msdn.microsoft.com/en-us/library/x7t1d0ky.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:40:47.687

如果你有一个断点，它的工作，但如果你没有，它不是？

您确定您的事件处理程序中没有任何内容吗？就像发生了一个异常，使程序“感觉”它什么也没做？您可以在处理程序中发布代码吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:56:50.163

将您的业务逻辑与 FileMonitor_Created 事件分开。在这种情况下，您应该存储事件参数并**返回**。例如，将事件参数存储在队列中，然后异步处理这些事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T07:31:17.350

FileMonitor.Created 当文件被创建并且未被替换为具有相同创建日期时间的前一个文件时触发。

场景 1) 在输入文件夹中复制并粘贴相同的 abc.txt 文件，而不更改文件创建日期或文件内容 - 文件观察程序无法识别该文件。

场景 2) 复制粘贴并在输入文件夹中使用新创建的日期复制相同的文件 文件观察器识别该文件

所以创建的事件适用于第二种情况，它可能不是你的情况，但在我的第一个视图中看起来是隐藏的行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-09T23:58:19.160

引发事件时，文件处理可能需要一些时间。在此期间，可能会创建另一个文件，并且事件处理程序不会处理第二个文件，因为它仍在处理第一个文件。因此，第二个文件被`FileSystemWatcher`.

解决方案是将文件检测和文件处理分成两个线程，然后通过队列连接。它是生产者-消费者队列。

文件检测应该尽可能短。它应该只检测一个文件，将其文件名排入队列，文件处理线程可以处理并关闭，以便可以检测到另一个文件。文件处理线程可以使文件名出列并花费尽可能多的时间来处理它。

我用本文中的代码详细解释了这一点：[FileSystemWatcher skips some events](https://stackoverflow.com/questions/33048619/filesystemwatcher-skips-some-events/33048620#33048620)

# xilinx - LOC 约束值

> ID：13070917
> 
> 赞同：1
> 
> 时间：2012-10-25T14:33:09.050
> 
> 标签：xilinx

我正在尝试为 XC2C256-7VQ100 编写一个约束文件，因此我使用了如下一行：

```
NET "led_1" LOC=7; 
```

但是，由于上述情况，我在翻译过程中遇到错误：

```
Error: Constraint 'LOC' has a value '7' which is invalid. Use the following:
Text that matches the regular expression: *i!:^(soft)|(hard)|(level)$ 
```

但是，我找不到任何关于软/硬/电平含义和/或为什么我不能只使用 XC2C256 数据表中指定的引脚号的信息。有人可以为我解释一下吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T20:09:38.487

LOC 的正确语法是：

**NET“LED_1”LOC =“7”；**

试试这个，我相信你的问题会得到解决。

# php - 如何发布具有超长编码的数据以测试漏洞？

> ID：13070919
> 
> 赞同：2
> 
> 时间：2012-10-25T14:33:18.113
> 
> 标签：php, encoding

我最近了解到，如果没有正确验证，[过长的编码会导致安全风险。](https://stackoverflow.com/questions/13022369/php-security-how-can-encoding-be-misused)从前面提到的帖子中的答案：

> 例如，字符 < 通常​​表示为字节 0x3C，但也可以使用超长的 UTF-8 序列 0xC0 0xBC（或者甚至更多冗余的 3 或 4 字节序列）来表示。

和：

> 如果您采用此输入并在基于 Unicode 的基于字节的工具中处理它，则可能会避开该工具中使用的任何字符处理步骤。

这意味着如果我`htmlspecialchars`在使用超长编码的字符串上使用，那么输出仍然可能包含标签。我还假设您可以发布也可用于 SQL 注入的类似字符（如`"`或）。`;`

也许是我，但我相信这是一个相对较少人考虑甚至知道的安全风险。我已经编码多年，现在才发现这一点。

无论如何，我的问题是：**我可以使用哪些工具来发送编码过长的数据？**熟悉此风险的人：您如何在网站上进行测试？我想在我的网站上发布一堆过长的字符，但我不知道该怎么做。

在我的情况下，我主要使用 PHP 和 MySQL，但我真正想知道的是测试工具，所以我想后端情况并不重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T10:30:20.060

> 我想在我的网站上发布一堆过长的字符，但我不知道该怎么做。

除了使用 curl 等手动请求工具对其进行测试之外，浏览器内测试的一个简单解决方法是覆盖表单提交的编码。使用例如 Firebug/Chrome 调试器，更改您正在测试的表单以添加属性：

```
accept-charset="iso-8859-1" 
```

您现在可以键入在编码为 Windows 代码页 1252(*) 时成为所需的 UTF-8 超长字节序列的字符。

例如，输入`cafÃ©`表单，您将获得字节序列`c a f 0xC3 0xA9`，因此应用程序会认为您输入了`café`. 回车`À¼foo`，将提交序列`0xC0 0xBC f o o`，可以解释为`<foo`. 请注意，您不会`<foo`在任何输出页面源代码中看到，因为现代浏览器不会解析网页中过长的 UTF-8 序列，但您可能会得到一个`�foo`或其他指示有问题。

要更深入地访问网络应用程序的输入和检查输出，请参阅 Burp 等专用 sec 工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:36:31.613

要测试您的网站是否易受攻击，请使用 curl 使用 post 和编码为 utf8 long 并发布 utf8 long 编码信息来获取您的页面（您可以通过将文本编辑器编码设置为 utf8 long 来使用您的文本编辑器，这样您的文本使用 curl 发布并且 php 文件很长）

[http://php.net/manual/en/function.curl-setopt.php](http://php.net/manual/en/function.curl-setopt.php)

# shell - shell 环境中的快速文本编辑器

> ID：13070924
> 
> 赞同：2
> 
> 时间：2012-10-25T14:33:34.387
> 
> 标签：shell, command-line, editor

我有时想在我正在使用的 shell 中对小文件进行小编辑，同时查看我的命令历史记录。

举个例子，如果我想在命令行上试验后写一个简短的 shell 脚本，我可以这样做：

```
cat > example.sh 
```

并根据我所看到的进行工作。

但是 cat 不是最好的编辑器。如果我使用 vi 或 emacs（据我所知），整个环境都会发生变化，我只能看到我一直在做的事情是从编辑器内部运行 shell history 命令，这并不是真正的我也想要。

我意识到这真的很挑剔，但是有人对我可以从命令行快速调用并且不会产生自己的环境的合理编辑器（或使用合理编辑器的方式）有任何建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:44:34.033

尝试像[`tmux`](http://tmux.sourceforge.net/)（或[`screen`](http://www.gnu.org/software/screen/)）这样的终端多路复用器。它将允许您快速将终端（水平或垂直）拆分为另一个“窗格”，然后您可以`vi`在新窗格中开始。您仍然可以在另一个窗格中看到 shell 的其余部分。我一直这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:45:03.013

如果您需要编辑命令行，请查看（内置）`fc`编辑器（Bourne Shells）。

但是，如果您需要编辑文件，没有什么比真正的编辑器更好的了。您可以使用[标准](http://www.gnu.org/fun/jokes/ed-msg.html)（`ed`，伙计！）或其他人*应该*使用的，`vi`:-)

与 不同`vi`，`ed`不清除屏幕；事实上，它是一个面向行的编辑器。请注意，`vi`某些终端中的某些版本（`vim`in an `xterm`）可以配置为保存屏幕并在退出时将其恢复为编辑前的状态。

# sql - 如何提取消除极端的常见行为？

> ID：13070927
> 
> 赞同：1
> 
> 时间：2012-10-25T14:33:39.883
> 
> 标签：sql, postgresql

对于某些报告，我需要使用类似这样的方法从考虑中删除极低和极高的值

```
SELECT ...
FROM
(
  SELECT val, ntile(10) OVER(ORDER BY val) AS tile FROM table
) AS tiled_table
WHERE tile > 1 AND tile < 10 
```

它可以被提取到存储过程中，该过程将采用表名和列名，连接字符串并执行查询，但有时我需要在另一个查询的结果上使用此过程。有没有办法在 PostgreSQL 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:56:50.517

要解决此问题，您将需要动态 SQL。通常，查询中不能有动态表名。有关动态 SQL 的信息，请参阅[http://www.postgresql.org/docs/9.2/static/ecpg-dynamic.html 。](http://www.postgresql.org/docs/9.2/static/ecpg-dynamic.html)

如果将查询构造为：

```
FROM
(
  SELECT val, ntile(10) OVER(ORDER BY val) AS tile FROM <subquery> t
) AS tiled_table 
```

然后，当子查询用括号括起来时，这将起作用。如果它们不在原始查询中，您可以添加括号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:04:29.833

如果您总是返回同一组列，则可以创建一个传递表和列名的集合返回函数。可以像表格一样使用：

```
create or replace function get_values(tablename text, columnname text)
  returns table (id integer, foobar text)
as
$$
BEGIN
  RETURN QUERY EXECUTE 'select id, '||columname||' as foobar from '||tablename;
END;
$$
language plpgsql; 
```

然后，每当您需要这些值时，您可以使用：

```
select v.*,
       t.foobar
from get_values('table_1', 'some_column') v
  join table_2 t on ... 
```

如果您的查询每次需要时返回不同数量的列，这将不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T00:10:11.360

如果要使用函数来处理查询的结果集，最好的选择是`SELECT ... INTO TEMPORARY TABLE`使用临时表名调用该函数。

考虑到生成的行集是多么微不足道，在 PostgreSQL 函数中使用行集非常困难。我知道的唯一方法是使用 refcursor、处理临时表或实现聚合或窗口函数。后两个选项不允许您控制返回的行数，因此它们不适合您的目的。

函数不能引用调用函数的 CTE 中的公用表表达式别名，因此不能使用 CTE 创建虚拟表并将表名传递给函数。显示它不起作用的示例：

```
CREATE OR REPLACE FUNCTION dynsql(tname text, colname text) RETURNS SETOF RECORD AS 
$$
BEGIN
  RETURN QUERY EXECUTE format('SELECT %I FROM %I', colname, tname);
END;
$$ LANGUAGE plpgsql;

WITH dummy(col) AS (VALUES (1),(2),(3))
SELECT * FROM dynsql('dummy','col') t(id integer); 
```

结果：

```
ERROR:  relation "dummy" does not exist 
```

...因为表达式中的别名是`WITH`表达式的局部`WITH`变量。（能够从函数中引用它会很好，但这也会产生各种令人兴奋的名称冲突问题和`SECURITY DEFINER`函数安全问题。）

虽然您可以编写一个使用 refcursor 的 PL/PgSQL 函数，但这需要您`DECLARE`使用带有查询的游标并将其传递给函数。您不能只使用普通的函数调用语法。它也非常低效，并且需要`LOOP`在函数中使用。我认为这不会有太大帮助。

在实现该功能时，使用`EXECUTE format(...) USING ...`以保持动态 SQL 不会太可怕。请参阅[这个较早的答案](https://stackoverflow.com/a/12995424/398670)。

# clojure - 如何在 korma 中选择默认字段？

> ID：13070932
> 
> 赞同：4
> 
> 时间：2012-10-25T14:33:58.803
> 
> 标签：clojure, korma

假设你已经做了一个 defdb。我有一个表“items”，它有两个字段，“id”（PK）和“item”。我想设置一个实体，以便每当我选择它时，我只能获得“项目”中的条目。从我认为是这样做的方法的[文档来看。](http://sqlkorma.com/docs)`korma/entity-fields`

```
(require '[korma.core :as korma])

(korma/defentity items
  (korma/entity-fields :item))

(korma/select items)
;; Wanted: [{:item "foo"}]
;; Received: [{:id 1, :item "foo"}] 
```

我正在使用 korma 0.3.0-beta7。我怎样才能`korma/select`做我想做的事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:57:52.263

我不认为你可以通过`defentity`-- 不显式传递字段列表的方式来做到这一点`select *`。

基于 korma/select 的辅助宏怎么样：

```
(defmacro select-without-id
  [ent & body]
  `(let [query# (-> (korma/select* ~ent)
                (korma/fields (vec (:fields ~ent)))
                 ~@body)]
     (korma/exec query#))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T17:22:50.307

`id`是 Korma 中的默认 PK 列名称。这就是您在结果列表中看到它的原因。您可以使用`transform`定义将其删除：

```
(korma/defentity items
  (korma/entity-fields :item)
  (korma/transform #(dissoc % :id))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T05:30:11.630

尝试使用以下依赖项创建一个新的命名空间：

```
(ns yourproject.path.kormastuff
    (:use [korma.core]
          [korma.db])) 
```

然后像这样创建您的实体：

```
(defentity items
  (entity-fields :item)) 
```

我认为您可能会碰壁，因为您正在尝试为核心命名而您缺少数据库。最好将这些东西推送到它自己的文件中并调用你想要的查询，如果你选择的话，可以使用别名，从其他命名空间，即：

```
(ns project.core
    (:use [project.path.kormastuff :as kormadb])) 
```

然后：

```
(select kormadb/items) 
```

得到你的结果。那应该行得通。

在 REPL 中，只需输入

```
items 
```

进入命令提示符查看 Korma 将为您提供的输出。应该没有其他字段出现。如果您在 REPL 中运行（选择项目），无论您是否希望发生这种情况，它都会显示所有内容。要获得真正的输出，您可能必须在浏览器窗口或其他东西中执行（格式“%s”项）。

如果所有这些都不起作用，那么使用普通的 (select db (fields [:item])) 子句就没有什么可耻的了。你会发现无论如何你都将被迫解构以使用这些信息。

编辑：：：：：：：

对不起，我没有解释清楚。

你不应该这样做

```
(select kormadb/items) 
```

得到你想要的。你只需要调用实体本身，所以你只需要调用REPL中的项目，而不是REPL中的（选择项目）。

你会想做类似的事情

```
(def myQuery kormadb/items)

$ myQuery 
```

您会看到默认情况下没有选择其他字段。

你也可以做

```
(let [myQuery kormadb/items] 
    (format "%s" myQuery)) 
```

我在这里修改，但我得到的是类似于这个：

```
{:table "items", :name "items", :pk :id, :db nil, :transforms (), :prepare
s (), :fields ("\"items\".\"item\""), :rel {}} 
```

为了使用 myQuery，您需要解构上面的 hash-map。我将把它作为练习留给你学习，因为解构很重要而且很难学习，除非你自己动手，但我会给你一个开始的小地方，它不会给你答案，但不会也不抛出错误：

```
(let [{myAlias :fields} myQuery]
    (format "%s" myAlias)) 
```

# javascript - 为什么没有定义 $.connection 对象？

> ID：13070935
> 
> 赞同：0
> 
> 时间：2012-10-25T14:34:06.730
> 
> 标签：javascript, jquery, signalr

这是我的 HTML 开头：

```
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="/Scripts/jquery-1.8.2.min.js"></script>
    <script src="/Scripts/jquery.signalR-0.5.3.js" type="text/javascript"></script>
    <script src="/Scripts/MyScript.js" type="text/javascript"></script>

    <title>Some title</title>
</head> 
```

我之前尝试添加`</head>`：

```
<script type="text/javascript" src="/signalr/hubs"></script> 
```

但这无济于事。

我还尝试删除除脚本之外`jQuery`的所有内容。`signalR`

### 请注意：所有脚本，包括`jquery.signalR-0.5.3.js`（以及`hubs`，如果我添加它）都已成功加载（我可以使用 Chrome“开发者工具”单步执行）。

那么为什么我没有`$.connection`定义对象呢？

## 编辑：

我清理了所有不必要的代码，同时发现：

1.  `$.connection`我在时确实存在`MyScript.js`，但我尝试先使用 chrome 控制台对其进行测试。在控制台中它不存在......我不明白为什么。
2.  `$.connection`为了测试它，我暂时保存在`someGlobalObj`：

    ```
    someGlobalObj = $.connection; 
    ```

    那行得通……

所以我更新的问题是：如何`$.connection`在我的脚本中可见，但在 chrome 控制台中不可见（`$`或者`jQuery`是全局变量）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:29:18.243

> 为什么 $.connection 在我的脚本中可见，但在 chrome 控制台中不可见（$ 或 jQuery 是全局变量）？

只有两种解释：在你的脚本之后执行的东西（超时，其他一些脚本）......</p>

*   …删除`connection`jQuery 对象的属性
*   …用不具有该属性的类似对象覆盖全局`$`（甚至？）变量。`jQuery``connection`

如果您还使用其他库（如 Prototype），则可能是第二种情况。

# ios - iOS弹出横幅动画不起作用

> ID：13070938
> 
> 赞同：0
> 
> 时间：2012-10-25T14:34:25.527
> 
> 标签：ios, animation, uiview, popup, translation

我正在尝试使用翻译动画创建一个弹出横幅（基本上是一个广泛的自定义视图弹出和隐藏在屏幕上）。这是我到目前为止的代码：

```
- (void)popAddProductBanner {
    [self.view bringSubviewToFront:[self.view.subviews objectAtIndex:3]];
    [_addProductBanner setHidden:YES];
    UIView *bannerView = [[[NSBundle mainBundle] loadNibNamed:@"HouraAddProductBannerView" owner:self options:nil] objectAtIndex:0];
    [_addProductBanner addSubview:bannerView];
    [UIView transitionWithView:_addProductBanner duration:0.5 options:UIViewAnimationOptionCurveEaseIn animations: ^{
        [_addProductBanner setHidden:NO];
        [_addProductBanner setTransform:CGAffineTransformMakeTranslation(0.0, -44.0)];
    } completion:^(BOOL finished) {
        [NSTimer scheduledTimerWithTimeInterval:3.0
                                         target:self
                                       selector:@selector(dismissAddProductBanner)
                                       userInfo:nil
                                        repeats:NO];
    }];
}

-(void)dismissAddProductBanner {
    [UIView transitionWithView:_addProductBanner duration:0.5 options:UIViewAnimationOptionCurveEaseIn animations: ^{
        [_addProductBanner setTransform:CGAffineTransformMakeTranslation(0.0, 44.0)];
        [_addProductBanner setHidden:YES];
    } completion:nil];
} 
```

可以通过不同的按钮在整个应用程序中触发此弹出窗口。我的问题是弹出动画效果很好，但隐藏动画（相同但以另一种方式）不起作用。横幅只是消失，没有任何动画。

有人知道这里发生了什么吗？这对我真的很有帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:43:42.313

不要为隐藏的属性设置动画。而是为 alpha 属性设置动画，如果要在完成中设置隐藏。它目前适用于第一个动画，因为 hidden 部分绑定到 alpha。

# php - 如何过滤来自复杂 SQL 查询的结果？

> ID：13070940
> 
> 赞同：2
> 
> 时间：2012-10-25T14:34:25.440
> 
> 标签：php, sql, subquery, filtering

我有一个这样的sql查询：

```
SELECT  `categories`.`partnumbersafe`, `filters`.`filtername`,  `filters`.`filtervalue` 
FROM  `products_categories` AS  `categories` 
LEFT OUTER JOIN  `products` AS  `product` ON  `categories`.`partnumbersafe` =  `product`.`partnumbersafe` 
LEFT OUTER JOIN  `products_filters` AS  `filters` ON  `categories`.`partnumbersafe` =  `filters`.`partnumbersafe` 
WHERE  `categories`.`categoryid` =4
AND (`product`.`visibility` =1 OR  `product`.`visibility` =2)
AND  `product`.`status` =1 
```

这给了我一个结果，其中有多个具有不同过滤器名称和过滤器值的 partnumbersafe 条目（相同的值）。例如：

```
partnumbersafe   filtername   filtervalue

123                brand        toyota
123                model        F5
123                type         business
678                brand        toyota
678                model        F6 
```

查询由 PHP 生成。我的 PHP 脚本中也有包含过滤数据的 POST 值（例如，品牌是丰田，型号是 F6）。

如何为过滤器名称/值对过滤这些结果？我更喜欢 sql 查询解决方案而不是 php 解决方案，在那里我可以查询 partnumbersafe，其中品牌是丰田，型号是 F6。这样它只会检索上表中的 partnumbersafe 123。

表格 products_filters 包含上面表格大纲表示的所有数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:41:07.670

你需要在这里有多个条件。每个记录的数量`partnumbersafe`等于您提供的条件数量。

```
SELECT partnumbersafe
FROM...
WHERE (filterName = 'Brand' AND filtervalue = 'toyota')
        OR
      (filterName = 'Model' AND filtervalue = 'F6')
GROUP BY partnumbersafe
HAVING COUNT(*) = 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:41:40.117

```
SELECT
  `categories`.`partnumbersafe`
FROM
  `products_categories` AS  `categories` 
LEFT OUTER JOIN
  `products`            AS  `product`
    ON  `categories`.`partnumbersafe` = `product`.`partnumbersafe` 
LEFT OUTER JOIN
  `products_filters`    AS  `filters`
    ON  `categories`.`partnumbersafe` = `filters`.`partnumbersafe` 
WHERE
     `categories`.`categoryid` = 4
AND (`product`.`visibility` =1 OR  `product`.`visibility` =2)
AND  `product`.`status` =1
AND
(
  (`filters`.`filtername` = 'Brand' AND `filters`.`filtervalue` = 'Toyota')
  OR
  (`filters`.`filtername` = 'Model' AND `filters`.`filtervalue` = 'F6')
)
GROUP BY
  `categories`.`partnumbersafe`
HAVING
  COUNT(*) = 2 
```

这假设您只需要 the`partnumbersafe` ***并且***no `filtername`/ pair 将多次`filtervalue`应用于同一个。`partnumbersafe`

# ember.js - 如何获取当前路由器的上下文

> ID：13070941
> 
> 赞同：0
> 
> 时间：2012-10-25T14:34:26.603
> 
> 标签：ember.js

有时我需要重新渲染所有视图和调用`App.router.connectOutlet`，但我没有上下文可以传递给这个方法。

第一个参数 router 我设置为`App.router`，但是第二个有问题。

有没有办法得到它？

**编辑**：

```
Ember.Route.extend( {
  home : Ember.Route.extend( {
    route : '/:cat_id',
    connectOutlets : function(router, context) {
      // ...
    },
    doFooterService : function( router, event ) {
      App.router.transitionTo( 'home', {
        cat_id : event.view.content.id
      });
    },
  },
  // ...
} 
```

有时我必须手动调用 connectOutlets 函数来重新渲染页面。我不想去其他地方，而只是用其他参数重新渲染这个视图。但我不知道应该作为上下文参数传递什么。

# java - 如何删除外键关系中的所有子项

> ID：13070942
> 
> 赞同：0
> 
> 时间：2012-10-25T14:34:32.453
> 
> 标签：java, hibernate

我的数据库 USERS 和 USER_SESSIONS 中有两个表。USER_SESSIONS 在用户 ID 上有一个外键，它映射到 USERS 表的用户 ID，我在 hibernate 中定义了多对一关系：

```
<many-to-one name="user" column="USERID" class="com.Users" /> 
```

当仅给定用户名时，如何编写一个休眠方法来删除给定用户的 USER_SESSIONS 数据库中的所有行。

我的第一次尝试是为给定的用户名加载用户对象，然后执行 HSQL 以删除该用户用户 ID 的所有会话。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:46:28.433

我认为另一种方式可能是：

1.  将级联定义为`delete`关系
2.  加载用户实体
3.  从用户中删除所有用户会话对象
4.  保存用户实体。

# settings - Settings Charm 中的链接顺序

> ID：13070944
> 
> 赞同：0
> 
> 时间：2012-10-25T14:34:38.547
> 
> 标签：settings, winjs

有谁知道我如何在设置魅力中放置一个链接以始终出现在底部？

我们的 UI 团队希望“退出”链接始终位于最后，不幸的是，自动添加的“权限”链接显示在其下方，即使我在 applicationCommands 对象上使用了追加调用。

```
var signOutCommand = new Windows.UI.ApplicationSettings.SettingsCommand(
    "sign-out",
    "Sign out",
    signOutHandler,
);
e.detail.e.request.applicationCommands.append(signOutCommand); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T15:27:12.833

我没有找到任何明确说明的内容，但我认为不可能进入“权限”链接下方。

# python - 类内更新的列表

> ID：13070948
> 
> 赞同：0
> 
> 时间：2012-10-25T14:35:07.833
> 
> 标签：python, list, class

```
class A(object):
    aalist = []
    ai = 0
    def __init__(self):
    self.ablist = list()
    def add(self):
        self.aalist.append(["a","a"])
        self.ablist.append(["b","b"])
        self.ai = self.ai + 1
class B(A):
    def __init__(self):
        A.__init__(self)
        self.bblist = list()
    def badd(self):
        self.bblist.append(['c','c'])
for i in range(1,4):
    c = B()
    c.add()
    c.badd()
    print c.aalist,c.ablist,c.bblist,c.ai 
```

运行这些代码，结果提示：

```
[['a', 'a']] [['b', 'b']] [['c', 'c']] 1
[['a', 'a'], ['a', 'a']] [['b', 'b']] [['c', 'c']] 1
[['a', 'a'], ['a', 'a'], ['a', 'a']] [['b', 'b']] [['c', 'c']] 1 
```

我不知道为什么 list 在循环中更新，而 int 似乎保持静态

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:37:37.120

You're doing completely different operations with them. Note that you *assign* a **new** integer to `self.ai` when you do `self.ai = self.ai + 1`. When you work with the list, you work on it in place using `append`. Also note that since you're working with an `int` (which is immutable), you *can't* change it's value in place.

There's also evidence that you're exploring class variables vs. instance variables here. Note that in your example, `ablist` and `bblist` are instance variable whereas `aalist` is a class variable. You can access them all the same way within a method (`self.XXlist`), but when you mutate `self.aalist`, you'll mutate the version *on the class*. In other words, `self.aalist is A.aalist` will return `True`. This allows all instances of your class to share the same list. When one updates the list, all the other instances will know immediately (unless they bind an instance level attribute with the same name -- That variable will then take precedence in the attribute lookup).

# c - 如何将小部件放入网格内的任何列中？

> ID：13070950
> 
> 赞同：0
> 
> 时间：2012-10-25T14:35:08.240
> 
> 标签：c, grid, gtk, position, gtk3

我正在手写一个使用`Gtk+`. 正如函数的第二个参数所说，我正在使用 a`GtkGrid`来保存我`GtkWidget`的 s，但我不能将 a`GtkWidget`放入特定的列中`gtk_grid_attach()`。例如，最后一个元素被放入 4 列，如果我尝试放入 6 列它不起作用；由`GtkWidget`gtk 自动放置到 5 列中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T21:38:17.137

您不能只是“跳过”一列，这没有任何意义。一个空列只有 0 像素宽。如果您希望它的宽度 > 0，您需要在同一行或另一行中放一些东西。如果您愿意，您可以在那里放一个 GtkFixed 小部件，但如果这只是为了分隔 2 个小部件，您可能想改用行间距和/或列间距属性。GTK 官方文档提供了一些关于[GtkGrid 如何工作](http://developer.gnome.org/gtk3/3.3/ch29s02.html)的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:47:47.727

如果您只想在小部件之间留一些空白空间，那么您应该可以通过一些更简单的方法来实现这一点。就像一个普通的`[GtkBox](http://developer.gnome.org/gtk/2.24/GtkBox.html)`，并在添加小部件时使用填充支持。

# mysql - MySQL 行号混淆

> ID：13070952
> 
> 赞同：0
> 
> 时间：2012-10-25T14:35:13.810
> 
> 标签：mysql, sql, group-by

所以我在mysql中查找了如何从oracle模拟row_number函数并遇到了这个：[http ://www.xaprb.com/blog/2005/09/27/simulating-the-sql-row_number-function/](http://www.xaprb.com/blog/2005/09/27/simulating-the-sql-row_number-function/)

我的问题是每个类型组的 COUNT(*) 是如何继续上升的。`variety`由于这是 group by 的第二部分，它不会为每个不同的 s 重置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:46:06.480

group by 不会重置，因为分组是使用两列完成的。基本上连接后形成的表有很多条目，所以计数上升。

查询中的以下条件“and l.variety >= r.variety”限制行数，“fuji”排在第一位，“limbertwig”排在最后，按字母顺序决定计数

因此，在没有上述条件的情况下，count(*) 将等于 = 3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:53:26.797

关键是加入条件`l.variety >= r.variety`。这会将行从`l`集合中的第一个上的所有品种添加到结果集中`r`，然后少一个，然后少一个，等等。在没有的情况下运行查询`GROUP BY`，你会看到。

# android - 当从数据库游标填满微调器时，获取选中的项目

> ID：13070956
> 
> 赞同：1
> 
> 时间：2012-10-25T14:35:25.257
> 
> 标签：android, spinner, android-spinner

在我的 Android 应用程序中，我有一个 Spinners 的布局。我想要做的是从第一个微调器中选择一个项目，填充第二个。

第一个微调器由游标（数据库查询的结果）填充，如下所示：

```
Spinner combo1 = (Spinner) findViewById(R.id.combo1);
mDbH.open();
Cursor c1 = null;
c1 = mDbH.consulta4();
startManagingCursor(c1);
SimpleCursorAdapter adapter = new SimpleCursorAdapter(this,android.R.layout.simple_spinner_item,c1,new String[] {"nombre"},new int[] {android.R.id.text1});
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
combo1.setAdapter(adapter); 
```

这很好用！问题出现在我的事件侦听器中：

```
combo1.setOnItemSelectedListener(new OnItemSelectedListener(){
    public void onItemSelected(AdapterView<?> parentView, View selectedItemView, int position, long id) {
        String est = String.valueOf(combo1.getSelectedItem());
        int idEst = (int) id;
        Log.e("est",est);
        Log.e("idEst",""+idEst);
        mDbH.open();
        Cursor c = null;
        c = mDbH.consulta5(idEst,est);
        SimpleCursorAdapter adapter2 = new SimpleCursorAdapter(getApplicationContext(),android.R.layout.simple_spinner_item,c,new String[] {"nombre"},new int[] {android.R.id.text1});
        adapter2.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        combo1.setAdapter(adapter2);
    }

    public void onNothingSelected(AdapterView<?> arg0) {}

}); 
```

因为，在 LogCat 行 Log.e("est",est); 显示了这一点：

```
10-25 09:48:50.390: E/est(3462): android.database.sqlite.SQLiteCursor@40625638 
```

当然，那个值不在我的数据库中，第二个游标是空的，微调器没有填满任何东西！！所以，这是我的问题，当从数据库中填满时，如何获得微调器的选定项目？我也试过：

```
String est = combo1.getSelectedItem().toString(); 
```

和

```
String est = parentView.getItemAtPosition(position).toString(); 
```

但结果是一样的！！难道我做错了什么？请帮忙！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:42:40.133

Since your `Spinner` was filled out using a `SimpleCursorAdapter`, `getItemAtPosition` & `getSelectedItem` will return a `Cursor` reference. Use:

```
Cursor c=(Cursor) combo1.getSelectedItem();
String est=c.getString(c.getColumnIndex("nombre"); 
```

Same works for `getItemAtPosition(position)`

# php - 使用 PHP 解析键值跨度对

> ID：13070958
> 
> 赞同：-1
> 
> 时间：2012-10-25T14:35:29.923
> 
> 标签：php, regex, parsing, html-parsing

> **可能重复：**
> [如何使用 PHP 解析和处理 HTML？](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-with-php)

我有一堆代码需要搜索并获取此类数据

```
<span class="parameter-name-value">
    <span class="parameter-name">....</span> 
    <span class="parameter-value">....</span>
</span> 
```

格式为 PHP 数组

```
$array = array(
    array("parameter-name", "parameter-value"),
    array("parameter-name", "parameter-value"),
    array("parameter-name", "parameter-value")
) 
```

我需要什么样的正则表达式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:50:39.947

这将是您的设置：

```
function get_tags($string, $start, $end)
{
    $start = str_replace("\\", "\\\\", $start);
    $start = str_replace("/", "\/", $start);
    $end   = str_replace("\\", "\\\\", $end);
    $end   = str_replace("/", "\/", $end);
    preg_match_all("/{$start}(.*?){$end}/si", $string, $matching_data);
    return $matching_data[0];
}

function return_between($string, $start, $stop, $type)
{
    $temp = split_string($string, $start, false, $type);
    return split_string($temp, $stop, true, $type);
}

function get_attribute($tag, $attribute)
{   
    // Remove all line feeds from the string
    $cleaned_html = str_replace("\r", "", $tag);   
    $cleaned_html = str_replace("\n", "", $cleaned_html);

    // Use return_between() to find the properly quoted value for the attribute
    return return_between($cleaned_html, $attribute."=\"", "\"", true);
} 
```

要使用它，像这样：

```
$open_tag = '<span';
$close_tag = '>';

$span_tags = get_tags($html_string, $open_tag, $close_tag);
$span_tag_class_names = array();

foreach ($span_tags as $key => $tag) {
    $class_name = get_attribute($tag, $attribute = "class");
    if (!empty($class_name)) {
        $span_tag_class_names[] = $class_name;
    }
}

print_r($span_tag_class_names); 
```

与所有正则表达式一样，您的里程可能会有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:04:19.177

如果您知道您的数据将与您呈现的完全一样，并且永远不会改变，那么使用正则表达式比加载 XML 库更快更容易。但请记住，无需进行太多更改即可使其失败。XML 解析器解决方案更加健壮。

```
$data = '<span class="parameter-name-value">
    <span class="parameter-name">A</span>
    <span class="parameter-value">x</span>
</span>
<span class="parameter-name-value">
    <span class="parameter-name">B</span>
    <span class="parameter-value">y</span>
</span>
<span class="parameter-name-value">
    <span class="parameter-name">C</span>
    <span class="parameter-value">z</span>
</span>
';

$pattern = '@<span class=\"parameter-name-value\">
    <span class=\"parameter-name\">(.*)</span>
    <span class=\"parameter-value\">(.*)</span>
</span>@';

preg_match_all($pattern, $data, $matches);
list($_, $keys, $values) = $matches;
$result = array_combine($keys, $values);
print_r($result); 
```

**输出**

```
Array
(
    [A] => x
    [B] => y
    [C] => z
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:54:40.697

你`HTML`的不清楚，但`DOMDocument`无论格式如何都可以使用

```
$html = '<span class="parameter-name-value">
    <span class="parameter-name">A</span> 
    <span class="parameter-value">1</span>
</span>
<span class="parameter-name-value">
    <span class="parameter-name">B</span> 
    <span class="parameter-value">2</span>
</span>';

$dom = new DOMDocument();
$dom->loadHTML($html);

$xpath = new DOMXPath($dom);
$span = $xpath->query("//span/span");

    $dom = new DOMDocument();
$dom->loadHTML($html);

$xpath = new DOMXPath($dom);
$span = $xpath->query("//span/span");

$list = array();
$list2 = array();

for($i = 0; $i < $span->length; $i += 2) {
    $name = $span->item($i);
    $value = $span->item($i + 1);
    $list[] = array($name->getAttribute('class') => $name->nodeValue,$value->getAttribute('class') => $value->nodeValue);
    $list2[] = array($name->getAttribute('class'),$value->getAttribute('class'));
}

var_dump($list);
var_dump($list2); 
```

输出`$list`

```
array
  0 => 
    array
      'parameter-name' => string 'A' (length=1)
      'parameter-value' => string '1' (length=1)
  1 => 
    array
      'parameter-name' => string 'B' (length=1)
      'parameter-value' => string '2' (length=1) 
```

输出`$list2`

```
array
  0 => 
    array
      0 => string 'parameter-name' (length=14)
      1 => string 'parameter-value' (length=15)
  1 => 
    array
      0 => string 'parameter-name' (length=14)
      1 => string 'parameter-value' (length=15) 
```

# javascript - 如何为使用 Raphael JS 绘制的矢量路径设置动画？

> ID：13070959
> 
> 赞同：6
> 
> 时间：2012-10-25T14:35:33.290
> 
> 标签：javascript, svg, raphael

如何为使用 Raphael JS 绘制的矢量路径设置动画？

我有一组坐标，我想使用 Raphael JS 进行连接。

在网格上，坐标是 (x,y 集)。我想从一端开始，在用户观看时“连接点”。最终产品看起来像这样：

[图片 9.png http://img213.imageshack.us/img213/8013/picture9my.png](http://img213.imageshack.us/img213/8013/picture9my.png)

理想情况下，我希望能够使路径弯曲，使它们看起来更像这样（添加坐标以供参考）：

[图片 10.png http://img534.imageshack.us/img534/1789/picture10fc.png](http://img534.imageshack.us/img534/1789/picture10fc.png)

坐标是：

```
26,-6
14,-12
5,-20
11,-28
14,-37
5,-40 
```

我一直在搜索谷歌，我已经阅读了这个问题[如何逐步绘制矢量路径？（Raphael.js）](https://stackoverflow.com/questions/4631019/how-to-draw-a-vector-path-progressively-raphael-js/5073832#5073832)但我正在尝试专门使用 Raphael.js，并且该页面上 Raphael.js 的示例似乎不起作用，也没有谈论使用多个坐标点进行输入。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-25T18:24:14.663

**渐进路径**

逐步绘制路径很容易做到。[我不喜欢这个问题](https://stackoverflow.com/questions/4631019/how-to-draw-a-vector-path-progressively-raphael-js/5073832#5073832)上第二受欢迎的答案，因为它在每一步都重新创建了一条路径，清除了中间的纸张。这是我一次又一次使用的实用功能：

```
function drawpath( canvas, pathstr, duration, attr, callback )
{
    var guide_path = canvas.path( pathstr ).attr( { stroke: "none", fill: "none" } );
    var path = canvas.path( guide_path.getSubpath( 0, 1 ) ).attr( attr );
    var total_length = guide_path.getTotalLength( guide_path );
    var last_point = guide_path.getPointAtLength( 0 );
    var start_time = new Date().getTime();
    var interval_length = 50;
    var result = path;        

    var interval_id = setInterval( function()
    {
        var elapsed_time = new Date().getTime() - start_time;
        var this_length = elapsed_time / duration * total_length;
        var subpathstr = guide_path.getSubpath( 0, this_length );            
        attr.path = subpathstr;

        path.animate( attr, interval_length );
        if ( elapsed_time >= duration )
        {
            clearInterval( interval_id );
            if ( callback != undefined ) callback();
                guide_path.remove();
        }                                       
    }, interval_length );  
    return result;
} 
```

[您可以在我的网站上](http://voidblossom.com/tests/pathTransform.php)看到它的实际效果。

仅此一项就可以使以线性方式对点的渐进路径构造进行动画处理非常简单。你只需编译你的路径......

```
var sequence_path = ["M26,-6", "L14,-12", "L5,-20", "L11,-28", "L14,-37", "L5,-40"]; 
```

然后将其传递给您设置的任何路径动画功能。就我而言，

```
drawpath( paper, 
          sequence_path, 
          3500, 
          { stroke: 'black', 'stroke-width': 2, 'stroke-opacity': 1, fill: 'none', 'fill-opacity': 0 }, 
          function()
          {
              alert("All done");    // trigger whatever you want here
          } ); 
```

**曲线插值**

Raphael 2.0 的 Catmull Rom 功能使得在您的点之间优雅地弯曲非常简单（感谢 Erik Dahlström 指出这一点）。您需要做的就是使用“R”命令构建一条路径以在点之间移动，其余的由 Raphael 完成。

```
function generateInterpolatedPath( points )
{
    var path_sequence = [];
    path_sequence.push( "M", points[0].x, points[0].y );
    path_sequence.push( "R" );
    for ( var i = 1; i < points.length; i++ )
    {
        path_sequence.push( points[i].x, points[i].y );
    }
    return path_sequence;
} 
```

[你可以在这里](http://voidblossom.com/tests/interpolation.php)看到所有的部分一起工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T12:30:55.387

您还可以使用 Catmull Rom（请参阅[http://raphaeljs.com/reference.html#Paper.path](http://raphaeljs.com/reference.html#Paper.path)）通过给定点获得平滑曲线。

[在此处](http://raphaeljs.com/jsconfeu/#27)进行现场演示（单击以分配点，然后按住 shift 单击以过渡到 Catmull Rom 曲线）。

# vb.net - 从文件夹加载图像文件

> ID：13070960
> 
> 赞同：3
> 
> 时间：2012-10-25T14:35:43.150
> 
> 标签：vb.net, winforms, image, load

我有 a`checked list box`和 a`thumbnail area`来显示它们，我试图仅从特定文件夹加载图像并需要在缩略图区域中显示，但问题是有一个`thumbs.db`文件也被添加到我没有的选中列表框中需要它。

那么我如何实际只加载没有 thumbs.db 文件的图像文件。

这是我的代码：

```
Private Sub LoadProjectToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles LoadProjectToolStripMenuItem.Click
    Using ofdlg As New Windows.Forms.OpenFileDialog

        ofdlg.DefaultExt = "trk"
        ofdlg.Filter = "Project|*.trk"
        ofdlg.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments)
        If ofdlg.ShowDialog = Windows.Forms.DialogResult.OK Then

            Dim SaveData As New gCanvasData
            Using objStreamReader As New StreamReader(ofdlg.FileName)
                Dim x As New XmlSerializer(GetType(gCanvasData))
                SaveData = CType(x.Deserialize(objStreamReader), gCanvasData)
                objStreamReader.Close()
            End Using

            With SaveData
                'gTSSizer_gAZoom.Value = 100
                GCanvas1.ImageXYReset()
                GCanvas1.Image = .Image
                GCanvas1.gAnnotates = .gAnnotates
                GCanvas1.RebuildAll()
                GCanvas1.AssembleBitmap()
            End With

            Dim fullpath As String
            fullpath = Application.StartupPath + "\" & System.IO.Path.GetFileNameWithoutExtension(ofdlg.FileName) + "\"

            For Each fi As FileInfo In New DirectoryInfo(fullpath).GetFiles
                CheckedListBox1.Items.Add(Application.StartupPath + "\" & System.IO.Path.GetFullPath(ofdlg.FileName))
                For i As Integer = 0 To CheckedListBox1.Items.Count - 1
                    CheckedListBox1.SetItemChecked(i, True)
                    ThumbControl1.AddFolder(fullpath, True)
                Next i
            Next
        End If
    End Using
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:32:56.323

终于找到了解决办法：

```
Dim fullpath As String
fullpath = Application.StartupPath & "\" & System.IO.Path.GetFileNameWithoutExtension(ofdlg.FileName) + "\"

Dim FileDirectory As New IO.DirectoryInfo(fullpath)
Dim FileJpg As IO.FileInfo() = FileDirectory.GetFiles("*.jpg")
Dim FileGif As IO.FileInfo() = FileDirectory.GetFiles("*.gif")
Dim FileBmp As IO.FileInfo() = FileDirectory.GetFiles("*.bmp")

For Each File As IO.FileInfo In FileJpg
CheckedListBox1.Items.Add(File.FullName)
Dim str As String
str = Directory.GetCurrentDirectory() & "\" & "Backup\"
       Next
         For Each File As IO.FileInfo In FileGif
                CheckedListBox1.Items.Add(File.FullName)
                Dim str As String
                str = Directory.GetCurrentDirectory() & "\" & "Backup\"
            Next
            For Each File As IO.FileInfo In FileBmp
                CheckedListBox1.Items.Add(File.FullName)
                Dim str As String
                str = Directory.GetCurrentDirectory() & "\" & "Backup\"
            Next
            For i As Integer = 0 To CheckedListBox1.Items.Count - 1
                CheckedListBox1.SetItemChecked(i, True)
            Next i 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:59:46.977

在 For Each 循环中对其进行过滤：

```
For Each fi As FileInfo In New DirectoryInfo(fullpath).GetFiles
    If Not {".jpg", ".png", ".bmp"}.Contains(fi.Extension) Then Continue For
    ' ...
Next 
```

或在 GetFiles 中执行：

```
DirectoryInfo(fullpath).GetFiles(".jpg") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:40:45.440

将 DirectoryInfo(fullpath).GetFiles 更改为 DirectoryInfo(fullpath).EnumerateFiles() 并为您想要的图像文件扩展名添加搜索模式。
[http://msdn.microsoft.com/en-us/library/dd383574.aspx](http://msdn.microsoft.com/en-us/library/dd383574.aspx)

# python - python matplotlib：从字符串索引数组绘制 3d 表面

> ID：13070961
> 
> 赞同：1
> 
> 时间：2012-10-25T14:35:43.977
> 
> 标签：python, matplotlib

这是我的问题：我有一个子文件夹的层次结构，每个子文件夹都包含一个具有值的文件。例如 ：

*   文件夹1/
    *   文件夹A/result.xml
    *   文件夹B/result.xml
    *   文件夹C/result.xml
*   文件夹2/
    *   文件夹A/result.xml
    *   文件夹B/result.xml
    *   文件夹C/result.xml
*   文件夹3/
    *   文件夹A/result.xml
    *   文件夹B/result.xml
    *   文件夹C/result.xml

我想用 matplotlib 绘制一个曲面，其中 folder1 到 folder3 作为 X 值，folderA 到 folderC 作为 Y 值，相应的结果（来自每个 result.xml 文件）作为 Z 值。但我不知道如何生成 Z 数组，以便 matplotlib 可以正确绘制曲面。

为了清楚起见，假设我有两个数组：

```
x = ["folder1", "folder2", "folder3"]
y = ["folderA", "folderB", "folderC"]
X,Y = numpy.meshgrid (x,y) 
```

如何生成 Z 数组，以便可以按如下方式使用它：

```
fig = plt.figure()
ax = fig.gca(projection='3d')
surf = ax.plot_surface(X,Y,Z) 
```

我的问题只涉及数组的实际创建（尺寸和填充），而不是访问 XML 文件或遍历子文件夹。

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:00:30.483

您可以先将 x、y 坐标转换为整数：

```
import numpy as np
xi = np.arange(len(x))
yi = np.arange(len(y))
Xi, Yi = np.meshgrid(xi, yi) 
```

对于 Z 数组，您将需要*每*对 x 和 y 的值（即`('folder1', 'folderA'), ('folder1', 'folderB')...`）。您可以在 for 循环中执行此操作：

```
Z = np.zeros(Xi.shape)
for i in xi:
    for j in xj:
        xy_pair = (xi[i], yi[j])
        Z[j,i] = calcZ(xy_pair) 
```

我猜该`calcZ`函数背后的逻辑取决于您如何解析 XML 文件中的数据。

为清楚起见，您可以在图中更改刻度标签以表示您访问的文件夹/文件。

```
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

fig = plt.figure()
ax = fig.add_subplot(1, 1, 1, projection='3d')

# ... plot some stuff ...

ax.set_xticks(xi)
ax.set_yticks(yi)
ax.set_xticklabels(x)
ax.set_yticklabels(y)

plt.show() 
```

# c# - 我的 WebMatrix 站点的跨度元素未隐藏在 Internet Explorer 中

> ID：13070964
> 
> 赞同：0
> 
> 时间：2012-10-25T14:36:00.110
> 
> 标签：c#, jquery, html, hidden, webmatrix

我的页面中有以下 html 块（带剃刀）：

```
<td class="upperTable">
                            <div id="picLeftButton" class="pictureButton" unselectable="on" style="margin-right: 5px;">&lArr;</div><div id="picRightButton" unselectable="on" class="pictureButton" style="margin-left: 5px;">&rArr;</div>
                            <span id="picm" class="mugshot"><span class="fileNameDisplay"><span style="color: #808080; font-size: 1.1em;">Pic Currently Stored:&nbsp;&nbsp;</span>@if((string)Session["gMugshotFileName"]==null || (string)Session["gMugshotFileName"]==""){<span class="noFile">[NONE]</span>}else{@Session["gMugshotFileName"]}</span>Mugshot:
                                <input id="mugUp" name="mugUp" type="file" maxlength="50" /><button onclick="mugshotClearPicVE()" id="MugshotClearPic" type="button">Clear Pic</button><input id="mugIsPicClear" name="mugIsPicClear" type="hidden" value="" />
                                @if(Session["gMugshot"]!=null)
                                {
                                    <img id="Mugshot" class="picDisplay" style="width: 400px; height: 350px;" alt="Mugshot" src="/ShowImage.cshtml?Id=@Session["gEntryID"]" />
                                }
                                else
                                {
                                    <img id="MugshotNoPic" class="picDisplay" style="width: 400px; height: 350px;" alt="No Picture Loaded" src="/Images/noPicture.png" />
                                }
                                </span>
                            <span id="pic1" class="mugshot" hidden="hidden"><span class="fileNameDisplay"><span style="color: #808080; font-size: 1.1em;">Pic Currently Stored:&nbsp;&nbsp;</span>@if((string)Session["gPOIPic1FileName"]==null || (string)Session["gPOIPic1FileName"]==""){<span class="noFile">[NONE]</span>}else{@Session["gPOIPic1FileName"]}</span>Picture 1:
                                <input id="picUp1" name="picUp1" type="file" maxlength="50" accept="image/*" /><button onclick="POIPic1ClearPicVE()" id="POIPic1ClearPic" type="button">Clear Pic</button><input id="POIPic1IsPicClear" name="POIPic1IsPicClear" type="hidden" value="" />
                                @if(Session["gPOIPic1"]!=null)
                                {
                                    <img id="POIPic1" class="picDisplay" style="width: 400px; height: 350px;" alt="POIPic1" src="/ShowImage2.cshtml?Id=@Session["gEntryID"]" />
                                }
                                else
                                {
                                    <img id="POIPic1NoPic" class="picDisplay" style="width: 400px; height: 350px;" alt="No Picture Loaded" src="/Images/noPicture.png" />
                                }
                                </span>
                            <span id="pic2" class="mugshot" hidden="hidden"><span class="fileNameDisplay"><span style="color: #808080; font-size: 1.1em;">Pic Currently Stored:&nbsp;&nbsp;</span>@if((string)Session["gPOIPic2FileName"]==null || (string)Session["gPOIPic2FileName"]==""){<span class="noFile">[NONE]</span>}else{@Session["gPOIPic2FileName"]}</span>Picture 2:
                                <input id="picUp2" name="picUp2" type="file" maxlength="50" accept="image/*" /><button onclick="POIPic2ClearPicVE()" id="POIPic2ClearPic" type="button">Clear Pic</button><input id="POIPic2IsPicClear" name="POIPic2IsPicClear" type="hidden" value="" />
                                @if(Session["gPOIPic2"]!=null)
                                {
                                    <img id="POIPic2" class="picDisplay" style="width: 400px; height: 350px;" alt="POIPic2" src="/ShowImage3.cshtml?Id=@Session["gEntryID"]" />
                                }
                                else
                                {
                                    <img id="POIPic2NoPic" class="picDisplay" style="width: 400px; height: 350px;" alt="No Picture Loaded" src="/Images/noPicture.png" />
                                }
                                </span>
                            <span id="pic3" class="mugshot" hidden="hidden"><span class="fileNameDisplay"><span style="color: #808080; font-size: 1.1em;">Pic Currently Stored:&nbsp;&nbsp;</span>@if((string)Session["gPOIPic3FileName"]==null || (string)Session["gPOIPic3FileName"]==""){<span class="noFile">[NONE]</span>}else{@Session["gPOIPic3FileName"]}</span>Picture 3:
                                <input id="picUp3" name="picUp3" type="file" maxlength="50" accept="image/*" /><button onclick="POIPic3ClearPicVE()" id="POIPic3ClearPic" type="button">Clear Pic</button><input id="POIPic3IsPicClear" name="POIPic3IsPicClear" type="hidden" value="" />
                                @if(Session["gPOIPic3"]!=null)
                                {
                                    <img id="POIPic3" class="picDisplay" style="width: 400px; height: 350px;" alt="POIPic3" src="/ShowImage4.cshtml?Id=@Session["gEntryID"]" />
                                }
                                else
                                {
                                    <img id="POIPic3NoPic" class="picDisplay" style="width: 400px; height: 350px;" alt="No Picture Loaded" src="/Images/noPicture.png" />
                                }
                            </span></br> 
```

你会注意到有四个跨度，这里的想法是使用手动（来自 div）创建的按钮来“翻页”它们，实际上使用 jQuery 隐藏/取消隐藏它们（不要问我为什么不只是使用“按钮”元素，但这无关紧要）。我在这里遇到的问题是世界上最糟糕的浏览器（总是一致的IE）不会隐藏最后三个跨度，事实上，它甚至不会开始隐藏，也就是说，所有四个“页面”都是随意显示的在页面上，我一次只为一个分配空间。（想法是有四个“页面”，第一个不开始隐藏，其他三个开始隐藏）。无论如何，无论我使用 hidden="hidden"，尝试将 span 属性呈现为隐藏 ($(".mugshot").attr('hidden'

这是因为它在桌子上吗？如果是这样，我可以通过什么其他方式选择这些元素以用于所有浏览器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:10:04.810

好的，为了解决这个问题，我不得不添加一些东西。首先，我必须将 style="display: none" 添加到我想要开始隐藏页面的三个元素中，在 html 级别。然后我不得不在 jQuery 中添加一些行。

修改前：

```
 $("#picm").prop("hidden", true);
                $("#pic1").prop("hidden", false);
                $("#pic2").prop("hidden", true);
                $("#pic3").prop("hidden", true); 
```

修改后：

```
 $("#picm").prop("hidden", true);
                $("#pic1").prop("hidden", false);
                $("#pic2").prop("hidden", true);
                $("#pic3").prop("hidden", true);
                $("#picm").css("display", "none");
                $("#pic1").css("display", "inline");
                $("#pic1").css("display", "normal");
                $("#pic2").css("display", "none");
                $("#pic3").css("display", "none"); 
```

请注意，我不仅必须重复三行以使用 css 显示隐藏在 IE 中，而且还必须为 IE 添加第四行 (.css('display', 'inline')) 和第五行 (.css( 'display', 'normal')) 用于 FireFox。

如果只有所有浏览器都可以像 Chrome 一样聪明......但我会接受没有浏览器像 IE 一样愚蠢，虽然......

# jquery - 几次后，Jquery Mobile 点击事件停止工作/触发

> ID：13070967
> 
> 赞同：3
> 
> 时间：2012-10-25T14:36:02.503
> 
> 标签：jquery, events, mobile

我有一个带有两个 Jquery Mobile 页面的 HTML 文件

```
<!-- Home Page -->
    <div data-role="page" id="home">
    <div data-theme="a" data-role="header">
        <h1>FortiSizer</h1>
    </div>

    <div data-role="content">
            <div id="myForm"></div>
            <a id="sizeit" data-role="button" data-theme="a" data-inline="false">Size It</a>
        <script type="text/javascript">
                jQuery("#home").on('pageinit', function(event, data) {
                 jQuery("#sizeit").on("click",function(e){
                    sizeItClick();
                    return false;
                });
            });
        </script>
    </div>
</div>

    <!-- Product Page -->
<div data-role="page" id="productInfo">
    <div data-theme="a" data-role="header">
        <a id="back" data-role="button" data-inline="true" data-direction="reverse" data-rel="back" data-transition="slide" data-icon="arrow-l" data-iconpos="left" class="ui-btn-left">Back</a>
        <h1 id="productName"></h1>
    </div>

        <div data-role="content">
                 <div id="detail"></div>
            </div>
    </div> 
```

在头部我有以下代码

```
<script type="text/javascript">
        jQuery(document).on('pagecreate', function(event, data) {
            generatePageForm();
        });
</script> 
```

这会在主页中生成一个表单。主要思想是在用户从选择元素中选择模型后显示产品详细信息（产品页面）。一切正常，两次！

生成表单，单击“sizeIt”按钮，加载产品详细信息页面，单击该页面上的返回按钮，然后返回主页。但是当我第三次这样做时，sizeit 按钮停止工作，并且产品页面没有出现。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-07T19:51:14.320

可能是使用后退按钮后没有触发 pageinit 事件，请尝试使用 pageshow 代替：（[jQuery mobile 的 pageinit 导致导航返回时出现问题](https://stackoverflow.com/questions/15041748/jquery-mobiles-pageinit-causing-problems-on-navigating-back)）

```
jQuery("#home").on('pageshow', function(event, data) {
             jQuery("#sizeit").on("click",function(e){
                sizeItClick();
                return false;
            });
        }); 
```

# html - 我如何调整CSS位置

> ID：13070968
> 
> 赞同：0
> 
> 时间：2012-10-25T14:36:05.590
> 
> 标签：html, css

我有以下 div 看起来像

```
 @namehere   texthereee         today       10 retweet
                                replay       
                                favorite 
```

我正在尝试编辑 css 以使最终形状看起来像

```
@namehere   texthereee  testetest              10 retweet
            today   replay   favorite 
```

我现在的 CSS 看起来像

```
 .top-tweet, .top-tweet a
 {
font-size: 13px;
text-align: center;
 }
  .col_3 a
 {
font-size: 12px;
 }
 .top-tweet .col_1
 {
width: 60px;
  }
  .top-tweet .col_2
  {
width: 375px;
text-align: left;
  }
  .top-tweet .col_3
  {
width: 100px;
   }
   .top-tweet .col_4
   {
width: 60px;
   } 
```

这里包含我要调整的 div 的 html ，

```
 echo "<div class='divrow top-tweet'>";

    echo "<li class='col_1' ><a href='http://www.twitter.com/#!/" . $tweeted_by . "'> <img src='" . $avatar . "' />" . $orig_tweeted_by . " </a></li>";

    echo "<li class='col_2'> <div><a class='text_bigger' href='http://www.twitter.com/#!/" . $tweeted_by . "' style='font-size:13px'>@".$tweeted_by."</a></div>      " . $tweet . "</li>";

    echo "<li class='col_3'> <a href='http://www.twitter.com/#!/" . $tweeted_by . "/status/" . $id . "'>"  . $since . " </a> ";

    echo "<li class='col_3'> <a href='https://twitter.com/intent/tweet?in_reply_to="  . $id . "'> Reply  </a>  ";
    echo "<li class='col_3'> <a href='https://twitter.com/intent/favorite?tweet_id="  . $id . "'> Favorite  </a>  ";

    echo "<li class='col_4'>".$retweet_count."<br>retweet</li>";    
    echo "</div>"; 
}
echo "</div>"; 
```

.col_1..3 是今天重播的最爱

有小费吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:40:00.070

在所有 div 中尝试一个类，然后将它们全部浮动并设置您想要的宽度

[jsfiddle](http://jsfiddle.net/nv3An/)

你也可以给不同的宽度

```
<div class="one">skfhsfs</div> 
<div class="one">skfhsfs</div>
<div class="one">skfhsfs</div>
<div class="one">skfhsfs</div> 
```

css

```
.one{
    width:100px;
    border:1px solid red;
    float:left;
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:46:49.323

如果您发布您尝试使用的 html，它会有所帮助。

无论如何，试试这个。

```
​&lt;div class="main">
    <div class="col_1">@namehere</div>
    <div class="col_2">
        <div>text here.. text here..</div>
        <div>
            <div class="action">today</div>
            <div class="action">replay</div>
            <div class="action">favorite</div>
        </div>
    </div>
    <div class="col_3">10 retweet</div>
</div>

.main {width: 500px}
.col_1, .col_3, .action {width: 100px; float: left}
.col_2 {width: 300px; float: left} 
```

# c - 堆 vs 栈 vs bss 部分

> ID：13070974
> 
> 赞同：4
> 
> 时间：2012-10-25T06:53:01.313
> 
> 标签：c, memory

存储具有恒定预定义大小（如缓冲区）的运行时数据的更好位置是：堆（malloc）、堆栈（例如`char buf[BUFSIZE]`在函数内部）或 bss 部分（`char buf[BUFSIZE]`在全局区域中）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T11:49:12.703

这取决于你想用缓冲区做什么。

通常应该避免使用全局变量，您必须非常小心，以免遇到它们带来的问题。

如果只有一个函数需要缓冲区并且 BUFSIZE 不是太大（最大几 KB），则可以将其设为本地。但是，请注意总堆栈使用情况，因为嵌套调用加起来。仅当您想在调用之间保留值时才需要静态本地，从而有效地使其成为具有本地范围的全局。但是当您使用多线程或想要使用递归时，它会让您头疼。

如果缓冲区用于函数调用或 BUFSIZE 非常大，则使用 malloc()/free()。如果函数经常被调用，最好在函数外部分配一次，执行所有函数调用，然后释放它，而不是为每个函数调用分配和释放另一个缓冲区。但这几乎是过早的优化，因为它不必要地将函数的内部结构与外部调用者耦合。

从更大的角度来看，当您的程序增长时，您希望赋予它更多结构并明确定义职责，尤其是。用于内存处理，否则您最终会迷失方向。该缓冲区是具有特定任务的特定模块的工作细节。一种典型的方法是使用结构以 OOP 方式组织数据，并使用创建和销毁函数来分配和释放这样的对象。然后缓冲区可以成为该结构的一部分。

```
struct s_foo
{
    char buf[BUFSIZE];
    ...
};

struct s_foo *foo_create (...);
void foo_destroy (struct s_foo *foo);
void foo_action (struct s_foo *foo); 
```

这允许您并行拥有任意数量的 foo，每个都有自己的缓冲区，彼此独立。此外，缓冲区内容在调用之间保留，没有静态变量的麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T07:52:35.007

在这种情况下，如果缓冲区不在函数之间共享，IMO 最好的选择是局部静态变量：

```
void func(...) {
    static char buf[BUFSIZE];
} 
```

这避免了重复分配/解除分配和命名空间混乱。

**编辑**

这个解决方案不是线程安全的，但全局变量也不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T06:59:47.110

您需要一个在加载时分配并在程序生命周期内保持不变的静态变量。所以选项三，所谓的“bss”部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T11:12:13.617

显然，堆是因为大小是有限的。我也不会选择静态，因为它们不是可重入的，并且会给递归带来严重破坏。所以，把它放在堆栈帧中。

```
void f(...) {
    char buf[BUFSIZE];
} 
```

顺便说一句，除非绝对必要，否则避免静态或全局变量是一种很好的做法。

# jquery - 悬停时出现自定义切换

> ID：13070979
> 
> 赞同：2
> 
> 时间：2012-10-25T14:36:57.133
> 
> 标签：jquery, css

我创建了一个切换，我想通过以下方式工作：

![在此处输入图像描述](../Images/b8203084e5ac6cd1ac956f971dfe2df8.png)

基本上，用户将鼠标悬停在“所有运行”上，切换将出现在“全部”一词的位置。然后用户可以将其切换到“Last N”，输入一个值，然后关闭鼠标并查看他们的调整。

我已经构建了切换开关，它在悬停时显示，但我有两个问题：

*   它正在显示内联，但仍显示“全部”一词……我不确定如何使它不显示。

*   我无法使用切换，因为当我尝试单击它时它会消失，因为有间隙。

**[解决方案小提琴。](http://jsfiddle.net/MeVX8/17/)**

**解决方案：**

根据下面的评论，我必须添加一个包装 div 来捕获鼠标悬停。

```
<div class='wrapper'>
    <div class='runType'>All </div>
    <div class='toggle'>
        <div class='all active'>All</div>
        <div class='last'>Last <input class='in' type='text' size='1' placeholder='N' /></div>   
    </div>
    <div class='runs'>runs</div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:44:03.063

您需要将整个东西包装在一个 div 中，然后将鼠标悬停在包装器上，还需要添加隐藏命令来隐藏“全部”字样：

```
<div id='wrapper'>
<div class='allText'>All </div>
<div class='toggle'>
    <div class='all active'>All</div>
    <div class='last'>Last <input class='in' type='text' size='1' placeholder='N' />       </div>   
</div>
<div class='runs'>runs</div>
</div> 
```

JS：

```
$('#wrapper').mouseover(function() {
$('.toggle').css('display','inline');
$('.allText').hide();
}).mouseleave(function() {
   $('.toggle').hide();
   $('.allText').show()
}); 
```

这是小提琴：

[http://jsfiddle.net/MeVX8/10/](http://jsfiddle.net/MeVX8/10/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:49:05.873

```
$('.allText').mouseover(function() {
$('.toggle').css('display','inline');
});
$('.toggle').mouseleave(function() {
$('.toggle').hide();
});

.toggle:{display:none;}
.toggle:hover {display:inline;} 
```

我认为这行不通？[http://jsfiddle.net/calder12/MeVX8/8/](http://jsfiddle.net/calder12/MeVX8/8/)

# mysql - GROUP BY 逗号分隔列表的成员

> ID：13070981
> 
> 赞同：0
> 
> 时间：2012-10-25T14:36:57.973
> 
> 标签：mysql, sql, tsql

我有一个数据表如下：

```
t1
____________________________________________________
resources          | companyName | Response | Score 
David, Matt        |  companyA   |  YES     |   5
Matt               |  compqanyB  |  NO      |   8
Kyle, Kyle, David  |  companyC   |  YES     |   2 
```

如您所见，`resources`是一个逗号分隔的字符串。此外，并非所有成员`resources`都必须是唯一的（参见第 3 行）。

我希望任何列表中的`GROUP BY`每个`DISTINCT`成员都可用。所有其他列将被聚合。

预期结果：

```
query
______________________________________________________________________________
resources     |  companyName        |    Response         | Score
David         | *agregated result*  | *agregated result*  | *agregated result*  
Matt          | *agregated result*  | *agregated result*  | *agregated result*  
Kyle          | *agregated result*  | *agregated result*  | *agregated result* 
```

**编辑：**

另一种可能：

```
query
____________________________________________________
resources          | companyName | Response | Score 
David              |  companyA   |  YES     |   5
Matt               |  companyA   |  YES     |   5
Matt               |  compqanyB  |  NO      |   8
Kyle               |  companyC   |  YES     |   2
David              |  companyC   |  YES     |   2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:52:20.330

让我假设您有一个包含各个名称的资源表。在这种情况下，您可以使用以下查询执行您想要的操作：

```
select r.name, <other aggregated results>
from t1 join
     Resources r
     on concat(', ', t1.resources, ', ') like concat(', %', r.name, ', %')
group by r.name 
```

如果您没有资源表，则可能应该。将这些东西存储在逗号分隔的列表中通常是一个坏主意。如果数据没有被规范化并且出现拼写错误，这是一个特别糟糕的主意。

# excel - 数组公式和 PasteSpecial:=Formats

> ID：13070982
> 
> 赞同：1
> 
> 时间：2012-10-25T14:37:03.333
> 
> 标签：excel, excel-2007, array-formulas, vba

我在工作簿中有这个小问题。我想通过使用数组公式来简单地编写一个很长的函数。该公式运行良好并产生了预期的结果。但是，在我的 VBA 宏中，我复制，然后进行公式粘贴，然后进行格式粘贴。格式粘贴崩溃：“无法粘贴，因为复制和粘贴区域的大小不同”（或类似）。如果我使用任何其他不是数组公式的公式，这个问题就解决了。

有没有人遇到过这种情况并找到合适的解决方案？我似乎无法在 Google 上找到帮助答案。如果需要，我会发布代码，但它相当简单 ( `Row.Copy ... Rows(something, something).PasteSpecial...`) 并且无论如何都可以使用非数组公式。

编辑：代码：

```
 sRapDetail = "rap - détails"

    Sheets(sRapDetail).Select
    iStart = 17
    iFormuleExceptionRNIAC = 13
    iFormule1 = 14
    iFormule2 = 15
    iFormuleExceptionAR = 16
    range(Rows(iStart - 1), Rows(1000)).Hidden = False

    iLastRow = Cells(65535, "B").End(xlUp).Row
    range("A" & iStart & ":AL" & iLastRow).Select
'    selection.Borders(xlInsideVertical).LineStyle = xlNone
'    selection.Borders(xlEdgeBottom).LineStyle = xlNone
    selection.Delete Shift:=xlUp

    'RNIAC
    Sheets("Zoom0").Select

    If Cells(21, "B").Value = "" Or Cells(22, "B").Value = "" Then
        iLastRow = 21
    Else
        iLastRow = Cells(21, "B").End(xlDown).Row
    End If
     iNbRow = iLastRow - 20

    Sheets(sRapDetail).Select
    Rows(iFormuleExceptionRNIAC).Select
    selection.Copy
    range(Rows(iStart), Rows(iStart - 1 + iNbRow)).Select
    selection.PasteSpecial xlPasteFormulas
    selection.PasteSpecial xlPasteFormats 
```

（是的，我知道使用`selection`是丑陋的（或至少在这种情况下），但这是由一位同事写的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:05:19.380

出现问题是因为您无法在其自身之上复制数组公式。

例如，如果您在单元格 A1 中有一个数组公式，并且想要将其复制到单元格 A10，则不能复制 A1 并突出显示 A1:A10 并粘贴。它行不通。您必须复制 A1，然后突出显示 A2:A10。

也就是说，问题很可能存在于来自的行`Rows(iFormuleExceptionRNIAC)`可能与此相交的事实`range(Rows(iStart), Rows(iStart - 1 + iNbRow))`

如果您可以确保它们不相交，则复制数组公式将起作用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2022-03-03T09:17:33.447

粘贴格式，然后粘贴公式。

# python - Pythonic 方法来转换具有多种类型的列表（包括列表！）

> ID：13070984
> 
> 赞同：1
> 
> 时间：2012-10-25T14:37:05.873
> 
> 标签：python, casting, type-conversion

给定一个标记列表和这些标记的适当的已知类型表示，我如何将类型映射到列表上？如果类型是`int`'s 或者`floats`我可以调用`int(x)`一个字符串来将值转换为一个 int，但是如果我的类型是 a `list`（或者说 a `numpy.array`），这将失败。进行转换的最pythonic方式是什么？`eval`这里不是一个选项，因为数据基本上没有经过消毒。一个例子：

```
line     = "0 0 62.9695 [16.859,-17.1135,46.6351] [7.1759,29.3009,83.1399]"
tokens   = line.split()
type_key = [int,int,float,list,list] # Lists do not convert properly here

print [T(x) for T,x in zip(type_key,tokens)] 
```

相关：[如何在 Python 中将具有多种类型的列表转换为二进制？](https://stackoverflow.com/questions/11979931/how-to-convert-a-list-with-multiple-types-to-binary-in-python)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T14:39:45.363

你想要的是[`ast.literal_eval()`](http://docs.python.org/library/ast.html#ast.literal_eval)，它是为此目的而设计的。

```
>>> ast.literal_eval("[16.859,-17.1135,46.6351]")
[16.859, -17.1135, 46.6351] 
```

编辑：根据您评论中的问题：

```
def literal_eval_to_array(literal):
    return np.array(ast.literal_eval(literal)) 
```

然后你可以简单地`literal_eval_to_array()`在你的`type_key`- 记住函数调用和实例化与 Python 相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:00:04.713

我认为对你来说最好的方法是创建一个类型到转换器函数的映射，然后你可以拥有你想要的尽可能复杂的转换器，例如

```
import ast
def convert_list(str_val):
    return ast.literal_eval(str_val)

def convert_array(str_val):
    # do something here
    return []

converter_map = {
    list: convert_list,
    'np.array': convert_array
}

def convert(str_val, _type):
    converter = _type
    if _type in converter_map:
        converter = converter_map[_type]
    return converter(str_val)

line     = "0 0 62.9695 [16.859,-17.1135,46.6351] [7.1759,29.3009,83.1399]"
type_key = [int,int,float,list,list] 

print [convert(v, t) for v, t in zip(line.split(), type_key)] 
```

输出：

```
[0, 0, 62.969499999999996, [16.859000000000002, -17.113499999999998, 46.635100000000001], [7.1759000000000004, 29.300899999999999, 83.139899999999997]] 
```

这使它成为一个非常灵活的方案，您可以以非常灵活的方式清理和处理您的输入

# windows - nginx Windows：设置站点可用配置

> ID：13070986
> 
> 赞同：26
> 
> 时间：2012-10-25T14:37:13.547
> 
> 标签：windows, nginx

我正在尝试在我的 Windows 开发环境中设置 Nginx。我找不到如何`"sites-enabled"`在 Linux 上创建类似于 Nginx 会查找（链接到）活动虚拟主机配置的东西。

有没有办法对具有实际配置文件的快捷方式的目录和 Nginx 扫描该目录的目录执行类似的操作？或者除了将主机配置复制到之外，还有其他方法可以连接虚拟主机配置`nginx.conf`吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2015-04-05T14:07:17.897

在 Windows 中，您必须提供配置文件所在目录的完整路径。有两个文件需要更新：nginx.conf，它告诉 nginx 在哪里可以找到网站，以及 localhost.conf，它是网站的配置。

假设 nginx 安装在`C:\nginx`. 如果安装目录位于另一个路径，则必须相应地更新该路径，无论它出现在以下两个配置文件中的任何位置。

# nginx.conf

地点：`C:\nginx\conf`

```
worker_processes  1;
events {
    worker_connections  1024;
}
http {
    include       mime.types;
    default_type  application/octet-stream;
    #to read external configuration.
    include "C:/nginx/conf/sites-enabled/*.conf";
} 
```

# 本地主机.conf

地点：`C:\nginx\conf\sites-enabled`

```
server {
        listen       80;
        server_name  localhost;
        location / {
            root   html;
            index  index.html index.htm;
        }
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-10-25T17:31:59.463

一些 Linux 包使用的 nginx 使用`include`指令的“启用站点”方法，它理解 shell 通配符，请参阅[http://nginx.org/r/include](http://nginx.org/r/include)。您也可以在自己的配置中使用它，例如

```
http {
    ...
    include /path/to/sites/*.conf;
} 
```

`default_server`请注意，尽管这种方法可能非常令人困惑（特别是，除非您明确使用，否则很难分辨哪个服务器{} 是默认服务器）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-01T17:48:25.453

以下内容对我有用，但仅在我将主 nginx exe 文件夹从移动`c:/Program Files (x86)/nginx-1.7.0`到之后`c:/nginx-1.7.0`（因为我认为它不能很好地处理文件路径中的空格）：

```
http {
    ...
    include "f:/code/mysite/dev-ops/nginx/dev/mysite.conf";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-01-07T13:57:19.990

*在撰写此答案（**2022 年 1 月 7 日**）之前，没有其他答案完全回答了这个问题。*
通配符 ( `include a/*.b`) 仅包含无法禁用/启用的虚拟主机列表。**sites-enabled**和**sites-available**是关于能够在不删除相应配置文件的情况下禁用虚拟主机。
Nginx 只有一个配置文件（nginx.conf），其中又包含其他文件。包含文件的能力是导致**启用/可用**设计的原因。所以目录结构如下：

```
conf // or whatever
  nginx.conf
  sites-enabled
    default // symlink to sites-available/default.conf
  sites-available
    default.conf // You can omit the extension but I just like it
    whatever.conf
    some vhost.conf
    another vhost.conf
    disabled vhost.conf
    other config files ... 
```

```
# nginx.conf
http {
  # ...
  include path/to/sites-enabled/* # include the enabled ones
} 
```

在 Windows (cmd) 中，您执行以下操作：

```
mklink Link Target
# for example
mklink default X:/path/to/nginx/conf/sites-available/default.conf 
```

*许多人认为windows没有符号链接，它有:-)*

我使用稍微复杂的配置目录结构进行开发：

```
conf/
  nginx.conf
  sites-enabled/
    some-site // sites-available/some-site/{env} where {env} is either dev or prod
  sites-available/
    some-site/
      prod.conf
      dev.conf
      dev/
        www.conf // vhost (server {}) for the www subdomain (e.g. www.example.com), has 2 server directives, one for http and the other for https, respectively including `snippets/http.conf` and `snippets/https.conf`. You only need to set `server_name` and include http.conf in order to make http redirect to https properly. You may do `proxy_pass` in https but not in http.
        api.conf // same as above but for the api subdomain
        root.conf // vhost for the root domain with (e.g example.com without any subdomain prefix)
      prod/
        www.conf // Same as dev/ but mostly without `proxy_pass` since you're mostly delivering static files
        api.conf
        root.conf
      snippets/
        http.conf  // listen on ipv4 80/ipv6 80 and redirect http to https
        https.conf // listen on ipv4 443 ssl/ipv6 443 ssl and `include`s ssl.conf
        ssl.conf  // ssl config, pay attention to permission 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-05T09:36:47.920

您可以在 nginx.config 中包含带有相对路径的配置（相对路径只是配置文件本身的路径，与日志路径相反）：

```
http {
  include       mime.types;
  default_type  application/octet-stream;
  include       ../sites-enabled/*.conf;
  ...
} 
```

# testing - 在多个域上进行 Selenium 测试

> ID：13070990
> 
> 赞同：1
> 
> 时间：2012-10-25T14:37:27.203
> 
> 标签：testing, selenium, same-origin-policy

我是 Selenium 的新手，最近我用 Selenium-IDE 创建了一堆测试，我想通过 .bat 脚本对 selenium 独立服务器运行它们，这样我就可以在 IE、Firefox 等中进行测试。

在 Firefox 中运行测试时，一切顺利并且通过了……现在 Internet Explorer (8) 是另一回事，测试套件使用*`localhost`*as 域进行测试。

但这是棘手的部分 - 我有一个静态内容提供程序，它在托管我的图像、css 和 javascript 的 localhost 之外的另一个域上运行。**我如何告诉 Selenium Server 可以使用多个域？**

我知道它是由于同源策略而被禁用的，但是 firefox 可以毫无问题地运行它，并显示正确的 css 规则和图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:06:57.960

好吧，您需要 Selenium Webdriver（或 Selenium RC（旧版本））来完成您刚刚列出的所有操作。

这是帮助您入门的[页面。](http://seleniumhq.org/docs/03_webdriver.html#introducing-webdriver)

# sql - 由于外键约束问题而插入 A 错误

> ID：13070992
> 
> 赞同：3
> 
> 时间：2012-10-25T14:37:31.077
> 
> 标签：sql, sql-server, database, sql-server-2008

有人可以帮我解释一下并解决吗？

[http://sqlfiddle.com/#!6/2adc7/9](http://sqlfiddle.com/#!6/2adc7/9)

**INSERT 语句与 FOREIGN KEY 约束“FK_tblMobileForms_tblForms”冲突。数据库“db_6_2adc7”、表“dbo.tblForms”、“fm_id”列中发生冲突：插入 tblMobileForms(fm_name) 值 (“lol”)**

我的架构具有来自 tblMobileForms 的 ID 是 tblForms.fm_id 的外键

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:47:38.960

要执行您尝试执行的操作，您不能将 tblMobileForms 上的 FK 设置为身份。请参阅下面的小提琴以获取更多信息。

[http://sqlfiddle.com/#!6/be6f7/2](http://sqlfiddle.com/#!6/be6f7/2)

或者，您可以做的是让 tblMobileForms 有它自己的单独代理键，并有一个与 tblForms 表不同的 FK 列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:45:49.107

桌子上的PK与`tblMobileForms`同一张桌子上的FK同名。看到 PK 是一`IDENTITY`列，您最终可能会得到不匹配的值。

在我的小提琴中，该`tblForms`表包含上 60 年代的 ID。在子表中运行`INSERT`id 会添加一条 id 为 1 的记录，该记录在父表中不存在。

我会在`tblMobileForms`表中创建一个新行，并将其引用到父表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T15:12:37.770

您可以使用`INSTEAD OF`触发器在插入每个移动表单时为其应用随机 ID：

```
CREATE TRIGGER dbo.tblMobileForms_Insert
    ON dbo.tblMobileForms
    INSTEAD OF INSERT

AS
BEGIN
    DECLARE @Inserted TABLE (fm_ID INT, fm_html_file VARBINARY(MAX), fm_name NVARCHAR(50));
    INSERT @Inserted (fm_ID, fm_html_File, fm_Name)
    SELECT  fm_ID, fm_html_File, fm_Name
    FROM    inserted;

    IF EXISTS (SELECT 1 FROM @Inserted WHERE fm_ID IS NULL)
        BEGIN
            WITH NewRows AS
            (   SELECT  fm_ID, fm_html_File, fm_Name, RowNumber = ROW_NUMBER() OVER (ORDER BY fm_name)
                FROM    @Inserted
                WHERE   fm_ID IS NULL
            ), AvailableIDs AS
            (   SELECT  fm_ID, RowNumber = ROW_NUMBER() OVER (ORDER BY fm_ID)
                FROM    tblForms f
                WHERE   NOT EXISTS
                        (   SELECT  1
                            FROM    tblMobileForms m
                            WHERE   f.Fm_ID = m.fm_ID
                        ) 
                AND     NOT EXISTS
                        (   SELECT  1
                            FROM    inserted i
                            WHERE   f.fm_ID = i.fm_ID
                        ) 
            )
            UPDATE  NewRows
            SET     fm_ID = a.fm_ID
            FROM    NewRows n
                    INNER JOIN AvailableIDs a
                        ON a.RowNumber = n.RowNumber

            IF EXISTS (SELECT 1 FROM @Inserted WHERE fm_ID IS NULL)
                BEGIN 
                    RAISERROR ('Not enough free Form IDs to allocate an ID to the inserted rows', 16, 1);
                    RETURN;
                END
        END

        INSERT dbo.tblMobileForms (fm_ID, fm_html_File, fm_Name)
        SELECT  fm_ID, fm_html_file, fm_name
        FROM    @Inserted

END 
```

插入每一行时，触发器将检查 tblForms 中的下一个可用 ID，并将其依次应用于`fm_id`未指定的插入行。如果其中没有空闲 ID，`tblForms`则触发器将引发错误，因此保持 1 对 1 的关系（由于 tblMobileForms.fm_id 也是 PK，因此无论如何都会引发错误）。

注意，这要求 tblForms.fm_ID 只是一个 int 列，而不是标识。

# ios - 在 Xcode 中确定 iDevice 当前日期 - NSDate

> ID：13070997
> 
> 赞同：0
> 
> 时间：2012-10-25T14:37:41.173
> 
> 标签：ios, xcode, nsdate, nscalendar, nsdatecomponents

我想创建一个简单的 if 函数，它根据当前的 iDevice 年份是否为 2012 年执行一些代码。为此我尝试在 Xcode 中使用 NSCalendar 和 NSDateComponents 但失败了...... :(

任何人都知道有关于此类任务的教程/建议的任何好的资源或博客吗？

谢谢，

担

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:46:50.007

```
NSDate *date = [NSDate date];
NSCalendar *gregorian = [[[NSCalendar alloc]
                         initWithCalendarIdentifier:NSGregorianCalendar] autorelease];

NSDateComponents *components = [gregorian components:NSYearCalendarUnit fromDate:date];
int year = components.year; 
```

# linux - Better way of parsing the input

> ID：13070998
> 
> 赞同：0
> 
> 时间：2012-10-25T14:37:43.053
> 
> 标签：linux, bash, shell

My shell script takes in a set of input variables some are optional. The input should follow the following signature.

myscript.sh var1 var2 [-x var3] [-y var4]`.

The -x and -y are **optional** inputs and these options can occur at any location (between var1 & var 2 or at the start) but var3 will always preceed var4\. Also var1 will preceed var 2.

The script I have does a lot of if else checks to cover all the probabilities. Something like this

```
if [ $1 == "-x" ]; then
## Then check if $3 == "-y" 
## Assign values to VAR1 , VAR2, VAR3, VAR4 
## else check for other possibilities
fi 
```

I was wondering if there was a better way of doing this and assigning the values to variables?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:39:01.887

看看`getopts`

```
man getopts 
```

如果您想要较长的 GNU 样式开关，请参阅

[getopts_long_example](http://www.sputnick-area.net/scripts/getopts_long_example.sh)

和

[getopts_long](http://www.sputnick-area.net/scripts/getopts_long.sh)

以及推荐的文档：http: [//mywiki.wooledge.org/BashFAQ/035](http://mywiki.wooledge.org/BashFAQ/035)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:55:38.603

很简单，甚至不需要 getopt。请注意，以下使用 bash-only 语法，因此您应该以 开始脚本`#!/bin/bash`，而不是`#!/bin/sh`.

```
args=()
while (( $# )); do
  if [[ $1 = -x ]] ; then
    x_val=$2
    shift; shift
  elif [[ $1 = -y ]] ; then
    y_val=$2
    shift; shift
  elif (( ${#args[@]} < 2 )); then
    args+=( "$1" )
    shift
  else
    printf 'Unhandled argument: %q\n' "$1" >&2
    exit 1
  fi
done
if (( ${#args[@]} < 2 )) ; then
  echo "Needed at least 2 positional arguments; got only ${#args[@]}." >&2
  exit 1
fi 
```

另请参阅[相关的 BashFAQ 条目](http://mywiki.wooledge.org/BashFAQ/035)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T18:36:38.687

通过测试确保可选参数（如果提供）仅提供一次。

```
#!/bin/bash

die() {
    echo >&2 $@
    exit 1
}

declare -a vars_1_2
var1='' var2='' var3='' var4=''
while [ "$1" ];do
    case $1 in
        -x ) [ "$var3" ] && die "Argument '-x' provided twice!"
             shift
             var3=$1
             shift
             ;;
        -y ) [ "$var4" ] && die "Argument '-y' provided twice!" 
             shift
             var4=$1
             shift
             ;;
        * ) vars_1_2+=($1) ; shift ;;
    esac
done
[ ${#vars_1_2[@]} -ne 2 ] && \
    die "Needed exactly 2 positional arguments. Got ${#vars_1_2[@]}."
var1=${vars_1_2[0]}
var2=${vars_1_2[1]}
set | grep ^var 
```

制作：

```
$ ./parsargs.sh 12 33 -x 45 -y 67 -x 2
Argument '-x' provided twice!

$ ./parsargs.sh 12 -x 45 -y 67 
Needed exactly 2 positional arguments. Got 1.

$ ./parsargs.sh 12 34 -x 45 -y 67 
var1=12
var2=34
var3=45
var4=67
vars_1_2=([0]="12" [1]="34") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T17:10:29.227

正如查尔斯所说：这项工作仅在 bash (>2 ;) 中起作用，这另一个目的似乎更紧凑：

```
#!/bin/bash

declare -a vars_1_2
var1='' var2='' var3='' var4=''
while [ "$1" ];do
    case $1 in
        -x ) shift ; var3=$1 ; shift ;;
        -y ) shift ; var4=$1 ; shift ;;
        * ) vars_1_2+=($1) ; shift ;;
    esac
done
if [ ${#vars_1_2[@]} -ne 2 ] ;then
    echo "Needed exactly 2 positional arguments. Got ${#vars_1_2[@]}." >&2
    exit 1
    fi
var1=${vars_1_2[0]}
var2=${vars_1_2[1]}
set | grep ^var 
```

让我们探测一下这段代码：

```
$ ./parsargs.sh
Needed at least 2 positional arguments. Got 0.

$ ./parsargs.sh 12
Needed at least 2 positional arguments. Got 1.

$ ./parsargs.sh 12 34
var1=12
var2=34
var3=
var4=
vars_1_2=([0]="12" [1]="34")

$ ./parsargs.sh 12 34 56
Needed at least 2 positional arguments. Got 3.

$ ./parsargs.sh 12 34 -x 56
var1=12
var2=34
var3=56
var4=
vars_1_2=([0]="12" [1]="34")

$ ./parsargs.sh 12 34 -x 56 -y 78
var1=12
var2=34
var3=56
var4=78
vars_1_2=([0]="12" [1]="34")

$ ./parsargs.sh 12 34 -x 56 -y 78 -z 9
Needed at least 2 positional arguments. Got 4.

$ ./parsargs.sh -x 56 12 -y 78 34
var1=12
var2=34
var3=56
var4=78
vars_1_2=([0]="12" [1]="34") 
```