# StackOverflow 问答 13502000-13502999

# ruby - 寻找拆分 Fixnum 的最小值/最大值？（红宝石）

> ID：13502001
> 
> 赞同：0
> 
> 时间：2012-11-21T20:59:46.513
> 
> 标签：ruby

初学者问题：

我有这样的代码：

```
p true_columns
=> [["1", "88", "59"], ["2", "79", "63"], ["3", "77", "55"], ["4", "77", "59"], ["5", "90", "66"], ["6", "81", "61"], ["7", "73", "57"], ["8", "75", "54"], ["9", "86", "32*"], ["10", "84", "64"], ["11", "91", "59"], ["12", "88", "73"], ["13", "70", "59"], ["14", "61", "59"], ["15", "64", "55"], ["16", "79", "59"], ["17", "81", "57"], ["18", "82", "52"], ["19", "81", "61"], ["20", "84", "57"], ["21", "86", "59"], ["22", "90", "64"], ["23", "90", "68"], ["24", "90", "77"], ["25", "90", "72"], ["26", "97*", "64"], ["27", "91", "72"], ["28", "84", "68"], ["29", "88", "66"], ["30", "90", "45"]] 
```

我的问题是能够将这些数据拆分成一个列表，并能够找到大集合中每个数组的第二个和第三个值之间差异的最小值/最大值。不是最干净的代码，但请耐心等待：

```
true_columns.each do |data|
  difference = data[1].to_i - data[2].to_i
  difference_string = difference.to_s.split(" ")
  print difference_string
end
=> ["29"]["16"]["22"]["18"]["24"]["20"]["16"]["21"]["54"]["20"]["32"]["15"]["11"]["2"]["9"]["20"]["24"]["30"]["20"]["27"]["27"]["26"]["22"]["13"]["18"]["33"]["19"]["16"]["22"]["45"] 
```

任何类型的 min/max/[x] 命令都将返回一些将“difference_string”减少为更基本的东西，连接原始的 difference_string。例子：

```
print difference_string.min  
=> 2916221824201621542032151129202430202727262213183319162245 
```

我相信这与作为 Fixnum 形式的原始变量有关，我不确定如何将其转换为一个列表，我可以用它来提取差异字符串.min 之类的东西。另外，如果有人能给我解释为什么 min/max 命令将数据简化为上述形式，那就太好了。

编辑：

作为参考，我在顶部的代码是：

```
file = File.open("file.dat")
columns = []
file.each_line do |line|
  p line 
  columns << line.split(" ")[0 , 3]
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:05:00.887

该问题与`Fixnum`. 这是因为您没有将结果移动到可以处理所有结果的数组中 - 而是一次处理一个结果。这应该适合你：

```
true_columns.map{|data| data[1].to_i - data[2].to_i}.min 
```

这样做是通过将每个数据行的差异“映射”为新数组中的一个元素来构建一个新数组。然后调用`.min`新数组来查找最小元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:45:51.013

```
difference_string = difference.to_s.split(" ") 
```

此时，`difference`是一个整数 (20)。它被转换为一个字符串（“20”），在一个空格上分割。由于字符串中没有空格，因此结果将类似于 ["20"]，它是一个包含一个元素的数组。调用 '.min' 将导致`"20"`. 打印，嗯，打印它，没有行尾。

有一种方法`min_max_by`可用于所有可枚举（如数组）：

```
min_col, max_col = true_cols.minmax_by{|data| data[1].to_i - data[2].to_i} #["14", "61", "59"] and ["9", "86", "32*"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:17:17.713

查看 Ruby[`Enumerable#map`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-map)和[`Enumerable#reduce`方法](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-reduce)（它们都可用于数组），它们将帮助您将数组转换为您需要的东西。

例如，以下是如何使用“reduce”一次性找到最小值和最大值的方法：

```
min_max = true_columns.reduce({}) do |acc, data|
  diff = data[1].to_i - data[2].to_i
  acc[:min] = diff if (!acc[:min] || (diff < acc[:min]))
  acc[:max] = diff if (!acc[:max] || (diff > acc[:max]))
  acc
end
min_max # => {:min=>2, :max=>54} 
```

# mysql - 如何从列中获取平均值

> ID：13502003
> 
> 赞同：1
> 
> 时间：2012-11-21T20:59:55.800
> 
> 标签：mysql, database

我是数据库新手，在学校教授给我们做作业。

我有以下表格：

**游戏**

```
id | game_id | game_name 
```

**类别**

```
id | cat_name 
```

**帮手**

```
id | game_id | cat_id 
```

**价格**

```
id | game_id | price | developer 
```

我需要为 id 为 2 的类别选择平均价格并显示结果如下：

```
cat_name | avg_price 
```

所以这是我的逻辑：

1.  首先我需要找到哪些游戏被分配到 id=2 的类别
2.  然后我只需要从表价格中选择与第 1 步结果相同的游戏
3.  然后我需要以某种方式按要求写结果

到目前为止，这是我的代码：

```
select prices.price
from (select helper.game_id
from helper
where helper.cat_id="2")
where prices.game_id = helper.game_id 
```

当我运行它时，在 phpMyAdmin 中我收到错误：每个派生表必须有自己的别名。

那么如何分配别名（我已经尝试查看互联网，但我不确定我是否理解它们）？

如果有人给我准备好的代码，我可以从中学习一些东西，那就更好了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:09:03.110

您得到的错误是因为当您像您一样进行子选择时，您需要为子选择产生的“派生”表提供如下别名：

```
select prices.price
from (select helper.game_id
from helper
where helper.cat_id="2") as helper_sub
where prices.game_id = helper_sub.game_id 
```

请注意在 WHERE 子句中使用别名，因为您将其用作条件。

现在我已经回答了最初的问题，让我向您展示一个更好的方法来做到这一点。您应该在这里使用 JOIN，因为子选择通常不是非常理想的。

```
SELECT c.cat_name AS cat_name, AVG(p.price) as avg_price
FROM
categories AS c
INNER JOIN helper AS h ON c.id = h.cat_id
INNER JOIN prices AS p ON h.game_id = p.game_id
WHERE c.id = 2
GROUP BY c.id 
```

当然，我在这里的假设是所有“id”字段都有索引，它们都是主键和外键（如在帮助器和价格表中）。这也是为什么 c.id 用于分组而不是 c.cat_name 的原因，因为在典型的关系数据库中，您可能没有针对`cat_name`未用于连接、执行 WHERE 过滤或排序的字段的索引目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:04:33.557

```
select prices.price
from (select helper.game_id
    from helper
    where helper.cat_id="2") AS subtable
                            ^^^^^^^^^^^^---alias for derived table
where prices.game_id = subtable.game_id
                       ^^^^^^^^---using the alias 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:28:37.580

询问：

**[SQLFIDDLE示例](http://sqlfiddle.com/#!2/87f52/2)**

```
SELECT
c.cat_name,
AVG(price ) AS avg_price
FROM categories c
  LEFT JOIN helper h
    ON c.id = h.cat_id
  LEFT JOIN games g
    ON g.id = h.game_id
  LEFT JOIN prices p 
    ON p.game_id = g.id
WHERE c.id= 2
GROUP BY c.cat_name 
```

数据：

```
INSERT INTO helper
    (`id`, `game_id`, `cat_id`)
VALUES
    (1, 1, 2),
    (3, 3, 1),  
    (2, 2, 2)
    INSERT INTO prices
        (`id`, `game_id`, `price`, `developer`)
    VALUES
        (1, 1, '12.5', 'EA'),
        (2, 2, '15.6', 'Woozie'),
        (3, 3, '25.6', 'Woozie') 
```

结果：

```
| CAT_NAME | AVG_PRICE |
------------------------
|     good |     14.05 | 
```

# c# - 在一个类中声明并在派生部分类中实现的抽象方法

> ID：13502004
> 
> 赞同：0
> 
> 时间：2012-11-21T20:59:59.513
> 
> 标签：c#

我正在更改`myFunc()`在父类中声明和调用的代码，其中它被声明为抽象。它实际上是在派生类中实现的吗？我知道部分类具有此属性，其中定义可以拆分为多个文件 - 但类 A 和 B 位于不同的命名空间中，并且都不使用关键字“ `partial`”。

这段代码是否正确实现？还是违反了 C# 语言规则？

文件1.cs

```
namespace PQR
{
    public abstract class A : UserControl
    {
       protected abstract void myFunc(); //no definition because it is declared abstract
    }

    protected void use_myFunc(int i)
    {
        //call myFunc(). called in a parent class, 
        //where it is declared abstract. And  
        //it is actually implemented in the derived class???
        myfunc();
    }
} 
```

文件2.cs

```
namespace ABC
{
    public partial class B : PQR.A
    {
       protected override void myFunc() 
       {
          //do something.
       }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:29:00.967

继承和抽象类的概念与部分类完全分开。

当一个类被标记为`partial`这意味着它会在尝试编译该类时查看所有代码文件以查找项目中具有相同命名空间、相同类名并且也标记为`partial`. 然后它将这些定义中的代码组合成一个单一的类定义。最终结果几乎与您将每个部分类中的文本复制/粘贴到一个类中一样。

您实际上并不需要部分类的多个实例。如果你标记一个类 a`partial`并且不提供额外的部分实现，那**很好**。这不会是编译器错误。它只会将该类编译为该类的整个定义，就像`partial`不存在时一样。

继承与该概念完全分开。当一个类被标记为`abstract`它将被编译成它自己的类型时，该类型的定义将存在于编译的程序集中（与它的所有实现分开）。

当您从一个类（无论它是否是抽象的）继承时，它不会在编译时“组合”这些类。它们仍然是存在于已编译代码中的单独类型。对于每种类型，它都有自己的表，其中列出了该类型的所有方法以及它的定义在哪里。对于每个派生类型的新方法，它将指向新类型中的定义。对于从基类继承且未被覆盖的方法，它将引用基类。对于在基类中定义但在派生类中被覆盖的虚方法，它将指向派生类。使用它，它总能找到每个方法的实际实现。当它尝试调用该方法时，它会在运行时执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:05:03.847

这就是所谓的继承和多态。

当您知道必须做某事时使用此选项，但该“某事”的实现取决于正在执行的实例的类型。

它没有违反任何规则。事实上，这种模式甚至还有一个名字：[模板方法](http://en.wikipedia.org/wiki/Template_method_pattern)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:05:40.590

在“protected abstract void myFunc();”之后有一个额外的 '}'，但除此之外它看起来还不错。“部分”不会有伤害，但也不会发挥作用；它使您能够将同一类型的声明拆分到不同的文件中，但它不会影响如何处理继承。

# ruby-on-rails - Rails：如何在导航中向高压页面添加活动类

> ID：13502005
> 
> 赞同：0
> 
> 时间：2012-11-21T21:00:12.037
> 
> 标签：ruby-on-rails

在我的非高压页面上，如果用户在页面上，我将使用以下代码向导航元素添加“活动”类：`<li class="<%= 'active' if params[:controller] == 'home' %>"><a href="/">Home</a></li>`

对我的 high_voltage 页面执行此操作的等效方法是什么（我想要 li 上的活动类）？

```
<li class="nav-item"><%= link_to 'Plans', page_path("plans") %></li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T01:10:08.393

我最终得到了这个：

```
<li class="nav-item <%= 'active' if page_path == '/about' %>">
  <%= link_to "About", page_path("about") %>
</li> 
```

高压提供了`page_path`链接到页面的方法。我可以使用它来确定我是否在该页面上，就像我对控制器所做的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-18T20:08:34.037

您可以使用 high_voltage 的`page_path`功能`current_page?`

```
<li class='<%="active" if current_page?page_path('about') %>'>About</li>
<li class='<%="active" if current_page?page_path('contact') %>'>Contact</li> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T03:32:40.353

还有另一种解决方案可以将条件逻辑排除在您的视图之外，并使用纯 CSS 来标记您的活动导航项。它可以与您的所有视图一起使用，包括 high_voltage 页面。

```
module ApplicationHelper
  def body_class
    "#{controller_name} #{controller_name}-#{controller.action_name} #{params['id']}"
  end

  def controller_name
    controller.controller_path.gsub('/','-')
  end
end 
```

从布局中调用辅助方法

```
<body class="<%= body_class %>"> 
```

这会给你一个像这样的身体`PagesController#show`课程`id=plans`

```
<body class="pages pages-show plans"> 
```

导航的 html 看起来像这样

```
<ul class="nav-items">
  <li class="home">Home</li>
  <li class="plans">Plans</li>
  <li class="contact">Contact</li>
</ul> 
```

然后你可以使用 CSS 来定位你想要激活的导航项

```
body.home li.home,
body.plans li.plans,
body.contact li.contact {
  // styles for active item
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T21:23:50.833

由于它是静态页面，您可以直接用 HTML 代码编写它：

```
<li class="active nav-item"><%= link_to 'Plans', page_path("plans") %></li> 
```

# javascript - 从外部 URL 获取类中的 HTML

> ID：13502008
> 
> 赞同：-1
> 
> 时间：2012-11-21T21:00:29.940
> 
> 标签：javascript, jquery, html, dom, web-scraping

我正在编写一个程序，它打印出来自 Flipkart.com 的书籍价格 我现在遇到的障碍是我无法访问搜索页面的 DOM。搜索页面的示例在这里 [http://m.flipkart.com/m/search-books?query=Predictably+irrational](http://m.flipkart.com/m/search-books?query=Predictably+irrational)

价格跨度与`class = "sp"`

请帮助我使用 Javascript/jQuery 访问这些类（如 Rs.197）中的字符串。

我也阅读了很多关于同源政策的内容。如果您能详细解释一项工作，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T01:28:10.963

使用 javascript 向您管理的执行抓取的 API 发送 ajax 请求。如果您了解 Python，最快的方法可能是使用 Flask/BeautifulSoup，但如果您更喜欢使用 javascript，您可以使用 Node.js。

我不相信您可以在不使用 iframe 的情况下以 Javascript 加载外国网站，而您无法使用 javascript 访问它。（这是不正确的：见编辑）

如评论中所述，请确保网站所有者可以接受您正在做的事情（问他们不会有什么坏处）。

编辑：

我站得更正了。[您可以使用http://corsproxy.com](http://corsproxy.com)从（仅限无身份验证）网站访问数据。示例： http: [//pastebin.com/5gfmtcPs](http://pastebin.com/5gfmtcPs)

# css - 在 IE 和 Firefox 中放大时 div 重叠，Chrome 没问题

> ID：13502017
> 
> 赞同：0
> 
> 时间：2012-11-21T21:01:14.350
> 
> 标签：css, html

我正在尝试准备 div，以便我可以插入内容并设置它们的样式，但是当在 Firefox 和 IR 中缩放时，DIVS 会相互重叠并重叠。您能解释一下需要做什么，因为有许多不同但令人困惑的解决方案在我的情况下不起作用。

谢谢

HTML

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- TemplateBeginEditable name="doctitle" -->
<title>My Website</title>
<!-- TemplateEndEditable -->
<link href="../css/stylesheet.css" rel="stylesheet" type="text/css" />
<!-- TemplateBeginEditable name="head" -->
<!-- TemplateEndEditable -->
</head>

<body>
<div id = "container">
  <ul id="nav">
    <li><a href="../about.php">About</a></li>
    <li><a href="../hobbies.php">Hobbies</a></li>
    <li><a href="../contact.php">Contact</a></li>
  </ul>

  <div id = "container1">

  container1
  </div>

  <div id = "container2">
  container 2

  </div>
    <div id = "container3">
  container 3

 </div>
   </div>

</body>
</html> 
```

CSS

```
 /* CSS Document */

body {

    margin: 0px;

}

#container {

position:relative;
min-height: 800px;
margin:5%;  
background-color:#FFC;
height: 100%;
width: 90%;
overflow: hidden;

}

#container1 {

position:absolute;
margin-left: 10%;   
margin-right: 10%;
margin-top: 10%;
overflow: hidden;
background-color:#6FA;
height: 30%;
width: 80%;

}

#container2 {

position:absolute;
margin-left: 10%;
margin-top: 45%;
background-color:#09C;
overflow: hidden;
height: 30%;
width: 37%;
float:left;

}

#container3 {

position:absolute;
margin-left: 53%;
margin-top: 45%;
margin-right: 10%;
background-color:#6FE;
overflow: hidden;
height: 30%;
width: 37%;
float:right;

}

#nav  {

width: 750px;
margin-left: 10%;   
padding: 0%;
list-style:none;

}

#nav li {

    float:left;

}

#nav a {

    display:block;
    font-weight:bold;
    text-align:center;
    width:150px;
    text-decoration:none;
    background-color:#DBDBDB;
    color:#03F;
    border-left: 1px solid #fff;
    border-right: 1px solid #fff;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:49:20.203

当您使用与`%`s 一起使用的边距设置的绝对定位时，您几乎不可避免地会遇到一些重叠或布局问题，这取决于用户的屏幕尺寸以及他们在您的格式下的缩放级别可以是截然不同。`%`一种更常用的方法是使用边距（如果有的话）以一定的尺寸设计您的页面。在构建时或构建之后，您可以放大和缩小并确保格式保持您想要的格式。

话虽如此，我确实浏览了您的 HTML 和 CSS，并为您的标题和内容部分添加了包装器，然后使容器相对定位。我保留了所有的 margin `%`s，就像你拥有的那样，它更加稳定并且也可以在 Firefox 上运行（除非你缩小得太多以至于任何东西都无法辨认）。

这是[小提琴](http://jsfiddle.net/xCTcW/4/)

# jquery - asp .net mvc3 +使用$ .ajax post时检查用户是否已登录

> ID：13502019
> 
> 赞同：6
> 
> 时间：2012-11-21T21:01:15.053
> 
> 标签：jquery, ajax, asp.net-mvc-3, post

我正在用 asp .net mvc 3 建立一个网站。

我正在尝试创建一个简单的切换按钮，可用于“添加到收藏夹”和“从收藏夹中删除”。但是，如果用户已登录，我只需要此功能，否则我想将他引导到“登录”页面。

切换按钮效果很好，但它不检查用户是否登录。如果用户未登录，则单击该按钮会切换但不会更新数据库。我希望它指向登录页面。

我的代码如下：

看法：

```
<div class="save-unsave-link">
    @if(Model.IsPropertySaved) {
        @Html.ActionLink("Remove Property", "RemoveSavedProperty", "Property", new { id = Model.Property.PropertyId }, new { @class="unsave-property", onclick = "saveProperty();" })      
    } else {
        @Html.ActionLink("Save Property", "AddSavedProperty", "Property", new { id = Model.Property.PropertyId }, new { @class="save-property", onclick = "saveProperty();" })
    }
</div> 
```

jQuery：

```
function saveProperty() {
    $('.save-unsave-link').delegate("a", "click", function (e) {
        var id = $(this).attr('href').match(/\d+/);
        if ($(this).hasClass('unsave-property')) {
            $.ajax({
                url: this.href,
                dataType: "text json",
                type: "POST",
                data: {},
                success: function (data, textStatus) { }
            });
            $(this).removeClass().addClass("save-property")
                .attr('href', '/Property/RemoveSavedProperty/' + id)
                .text('Remove Property');
            e.preventDefault();
        } else {
            var id = $(this).attr('href').match(/\d+/);
            $.ajax({
                url: this.href,
                dataType: "text json",
                type: "POST",
                data: {},
                success: function (data, textStatus) { }
            });
            $(this).removeClass().addClass("unsave-property")
                .attr('href', '/Property/AddSavedProperty/' + id)
                .text('Save Property');
            e.preventDefault();
        }
    });
} 
```

控制器：

```
//
// POST: /Property/AddSavedProperty
[HttpPost]
[Authorize]
public void AddSavedProperty(int id)
{
    websiteRepository.AddSavedProperty(id);
}

//
// POST: /Property/RemoveSavedProperty
[HttpPost]
[Authorize]
public void RemoveSavedProperty(int id)
{
    websiteRepository.RemoveSavedProperty(id);
} 
```

如何检查用户是否在 ajax 发布之前登录？如果他没有登录，那么我如何将他引导到登录页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:48:56.407

如果用户没有登录，为什么不直接渲染一个指向你的登录操作的链接呢？您根本不需要 jQuery——当您在第一次呈现页面时已经可以确定用户是否登录时，Ajax 调用完全是多余的。

```
@if (User.Identity.IsAuthenticated)
{
    @Html.ActionLink("Save Property", "AddSavedProperty", "Property", new { id = Model.Property.PropertyId },
        new { @class="save-property", onclick = "saveProperty();" })
}
else
{
    @Html.ActionLink("Save Property", "Login", "Login",
        new { returnUrl = ViewContext.HttpContext.Request.Url.PathAndQuery }, null)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:14:40.023

您可以在所有 ajax 调用后运行一个函数并验证页面是否被重定向，例如，如果您的登录页面具有如下的 h2 标题：

```
<h2>Log On</h2> 
```

您可以检测到它并重定向自己：

```
$(document).ajaxComplete(function (e, xhr) {
    if(xhr.responseText.indexOf("<h2>Log On</h2>") != -1) {
       // redirect code here
    }
}); 
```

# git - 当我从远程存储库中提取时，为什么 Git 会返回这些字符？

> ID：13502023
> 
> 赞同：2
> 
> 时间：2012-11-21T21:01:29.383
> 
> 标签：git, git-pull, head, merge-conflict-resolution

```
<<<<<<< HEAD
    </div>
    <?php if( is_front_page() ){ ?>
        <div class="slogan-container">
            <div class="slogan-img"></div>
        </div>
    <?php }?>
=======
    </div>
>>>>>>> 026a843d 
```

所以我的问题是，为什么当我从远程仓库中提取数据时会出现这个文本？我是Git的新手，希望有人可以帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T03:15:49.933

### 合并冲突。

*您的本地版本和服务器上的版本在同一行*代码中的文件存在差异，通常表明两个人在同一行上编辑了同一个文件（ s)，或者一个人从不同的位置推送了更改，然后在其他地方进行了本地更改，并尝试从远程拉取其他更改。

很可能你已经做到了`git pull`这一点。要么是`git fetch`第一个（这会更安全）然后是一个`git merge`（这也会导致这种冲突）的更安全的路线。

当在不同区域对同一文件进行更改时，git 实际上在将更改合并在一起方面做得非常出色。但是，当更改在同一行或同一块上时，您将面临合并冲突和两组代码。由你决定你想要的行，删除其他行，删除`>>>>>>`和`=======`符号`<<<<<<`，然后删除`git merge --continue`。

符号的意义在于和之间的代码`<<<<<<<<<`是`========`您的开发副本中的代码，而在`========`和 之间的`>>>>>>>>>>>`代码是来自远程的代码。

我已经在[https://stackoverflow.com/a/9204499/631619上回答了有关一般 git 进程的更多信息，这些信息可能会有所帮助](https://stackoverflow.com/a/9204499/631619)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T21:04:09.117

你有冲突。不同的更改已应用于您`HEAD`和远程分支。您应该根据自己的喜好编辑内容并提交。

# android - 地图应用程序的活动与片段

> ID：13502031
> 
> 赞同：0
> 
> 时间：2012-11-21T21:02:51.433
> 
> 标签：android, android-fragments, actionbarsherlock

我有一个应用程序，它在其主要活动中显示一个地图，它是 SherlockFragmentActivity 的子类，因为我正在使用 ActionBarSherlock。

操作栏有一个下拉列表，用户可以选择查看模式或编辑模式。查看模式是显示地图的主要活动，编辑模式看起来相同（就像显示地图一样），但它允许用户编辑地图，并且操作栏上有一些不同的按钮。

我不确定执行此操作的最佳方法。这两种模式是否应该处于完全独立的活动中，所以当用户按下编辑模式时，编辑地图活动将通过意图加载？这似乎可以工作，但是它必须再次初始化操作栏以及地图，这似乎是在浪费代码和时间。

有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:10:16.173

这在很大程度上取决于这些州之间的差异。

如果编辑模式只添加额外的输入法（例如额外的按钮），我会使用相同的活动（甚至相同的片段），并且只设置一个变量来保存当前模式。

只有两种模式根本不同（不同的渲染，完全不同的布局）我会做一个额外的活动/片段（并尝试在父类中放置尽可能多的通用代码。

# wpf - 使用触摸屏的 DevExpress wpf 网格滚动

> ID：13502035
> 
> 赞同：0
> 
> 时间：2012-11-21T21:03:17.160
> 
> 标签：wpf, devexpress, wpfdatagrid, dxperience

我需要一个用于 wpf 的网格控件，并且非常重要的功能是使用手指滚动网格内容（不使用滚动条，我想像在 iPhone 上滚动内容一样滚动）。

我下载了 DXperience 试用版，并运行了一个演示中心来测试 DXGrid。但是，我找不到任何可以在不触摸滚动条的情况下使用触摸屏滚动网格内容的示例。

那么，是否有可能，是否有任何解决方法或您有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T05:15:44.673

据我所知，DXGrid 自[v2011 vol 2](http://www.devexpress.com/Support/Center/Issues/ViewIssue.aspx?issueid=S36352)起支持 WPF 和 Silverlight 的触摸滚动。不需要 WPF 的特殊选项 - 它开箱即用（对于 Silverlight，将 AllowTouchScroll 属性设置为 True 以启用触摸滚动）。

# apache - 如何使用 Phusion Passenger 部署小型 Rails 应用程序

> ID：13502036
> 
> 赞同：0
> 
> 时间：2012-11-21T21:03:19.827
> 
> 标签：apache, deployment, ruby-on-rails-3.2, passenger

尽管那里有大量关于部署的信息，但我现在很困惑。但也许你可以帮助我！

我有一个想要部署的现有 Rails 应用程序。

我的（服务器）设置：

*   导轨 3.2
*   VPS (Linode)
*   Ubuntu 12.04
*   阿帕奇
*   Phusion乘客

现在一切都已正确安装和配置，但是如何将现有应用程序获取到服务器。FTP，Github？Capistrano 对我来说似乎更难。

这只是一个小应用程序，最简单的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:24:33.300

如果 GitHub 是一个开源应用程序，或者如果您有 GitHub 帐户和可用的私有存储库，那么 GitHub 会很棒。Capistrano 可能是矫枉过正。

如果您的源代码在 linux 或 OSX 笔记本电脑上，您可以使用 scp (http://linux.die.net/man/1/scp)。FTP也可以工作......真的取决于你的需要。

在我所有的项目中，我的所有代码都经过某种源代码控制，即 SVN 或 Git，因此我始终确定我的最新更改在存储库中。然后，如果我必须对部署框进行快速调整，我可以将这些更改检查回源代码系统，然后将它们拉到我的本地系统上。如果使用 scp 或 ftp 推送代码，服务器上的任何更改都需要复制*回来*，这很容易出错。

# ruby-on-rails - 在 Rails 中使用 Devise 存储用户访问次数

> ID：13502038
> 
> 赞同：1
> 
> 时间：2012-11-21T21:03:32.320
> 
> 标签：ruby-on-rails, devise

我想跟踪用户访问网站的次数。如果先前的访问时间超过 30 分钟，则访问计数器（用户模型的一部分）会增加。我正在使用 Rails 和设计：

```
class ApplicationController < ActionController::Base
  before_filter :authenticate_user!
  before_filter :update_visits

  def update_visits
    current_user.increment!(:visits) if !current_user.nil? && current_user.updated_at < 30.minutes.ago
  end
end 
```

这会很好用，除非我设计了 :rememberable 已打开。所以来自 :authenticate_user 的 SQL 调用序列！这是：

> SELECT "users".* FROM "users" WHERE "users"."email" = 'person_1@example.com' LIMIT 1
> 
> 更新“用户”设置“remember_created_at”='2012-11-21 20:13:53.011322'，“updated_at”='2012-11-21 20:13:53.012791'其中“用户”。“id”= 1

因此，visits 变量永远不会增加，因为 updated_at 在可记忆调用中设置为当前时间。如何在身份验证之后但在可记住之前进行 update_visits 调用？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:45:51.760

我想你的任务不是那么简单。如果您有记忆，您应该跟踪用户的活动，而不是通过登录。应该有一个标准设置你所谓的“活动”：它只是返回到应用程序的页面还是点击链接或按钮。在[Railscast](http://railscasts.com/episodes/250-authentication-from-scratch?view=asciicast)关于从头开始的身份验证中，身份验证背后有一个逻辑。大概会有解决办法吧？就像在为 current_user 检查会话时设置回调一样。

编辑：看看[这个讨论](https://stackoverflow.com/questions/8837784/how-can-i-tell-whether-a-given-devise-user-is-signed-in-right-now)。有多种方法可以通过[Warden::Manager](https://github.com/hassox/warden/wiki/Callbacks)跟踪当前用户的身份验证请求时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T23:41:01.757

我用 Warden 来解决这个问题。

初始化程序/设计.rb：

```
Warden::Manager.after_set_user do |user,auth,opts|
  user.increment(:visits).save! if user.updated_at < 30.minutes.ago
end 
```

# facebook - 粉丝专页的 Facebook 回调“喜欢状态”

> ID：13502039
> 
> 赞同：-3
> 
> 时间：2012-11-21T21:03:38.343
> 
> 标签：facebook, callback, facebook-page

我如何获得有关“如果我喜欢 Facebook 粉丝专页”的信息？对我来说最好的将是带有回调的 ajax 请求，但我还没有在任何地方找到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:09:48.357

如果您正在制作页面选项卡应用程序，FB 已经从签名请求中自动告诉您用户是否是该页面的粉丝。我认为它被称为“is_fan”。这样做的好处是它甚至不需要用户事先安装您的标签。

如果您正在制作画布或独立应用程序，那么您需要

*   要求用户以“user_likes”权限安装您的应用，因为您需要检查他们的喜好
*   然后对 /me/likes/{page_id} 进行 Graph API 调用 - [http://developers.facebook.com/docs/reference/api/user/#likes](http://developers.facebook.com/docs/reference/api/user/#likes)

这种方法有点冗长，您通常会遇到用户的流失率下降，因为您要求的是扩展权限（user_likes），但如果您有正确的用户流程，它可能会奏效。

# svn - svnadmin 没有创建正确的存储库版本

> ID：13502045
> 
> 赞同：1
> 
> 时间：2012-11-21T21:04:20.600
> 
> 标签：svn, repository, version, svnadmin, fsfs

我用 svnadmin 1.7.7 创建了一个 SVN 存储库，但是存储库格式错误。我最终得到

```
svnadmin: E165005: Expected repository format '3' or '5'; found format '12' 
```

当我尝试加载存储库时。

```
$ /svr/svn/repositories> ls -l SvnCreateTest
SvnCreateTest: No such file or directory
$ /svr/svn/repositories> mkdir SvnCreateTest
$ /svr/svn/repositories> ../csvn/bin/svnadmin create SvnCreateTest
$ /svr/svn/repositories> cat SvnCreateTest/format
5
$ /svr/svn/repositories> cat SvnCreateTest/db/format
4
layout sharded 1000
$ /svr/svn/repositories> ../csvn/bin/svnadmin --version
svnadmin, version 1.7.7 (r1393599)
   compiled Oct 16 2012, 19:23:32

Copyright (C) 2012 The Apache Software Foundation.
This software consists of contributions made by many people; see the NOTICE
file for more information.
Subversion is open source software, see http://subversion.apache.org/

The following repository back-end (FS) modules are available:

* fs_fs : Module for working with a plain file (FSFS) repository.

$ /svr/svn/repositories> 
```

根据我的阅读，版本 1.7.7 应该创建一个 12 格式的存储库。我错过了什么？

# codeigniter-2 - 如何在 PyroCMS 中自定义博客页面？

> ID：13502064
> 
> 赞同：0
> 
> 时间：2012-11-21T21:05:32.647
> 
> 标签：codeigniter-2, pyrocms

具体来说，我希望能够修改单个博客页面以及一般博客页面的布局。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T09:17:43.323

Shamoon，你的 PyroCMS 有一个主题。如您所知，每个模块都有自己的视图。另一方面，布局是您在浏览器中看到的布局。您的答案很简单，对于博客模块，您可以构建自己的布局和视图。在您的主题文件夹中执行此操作。例如，这是您（活动）主题文件夹中的文件结构。

插件/shared_addons/themes/shamoon_theme

```
css
img
views
  +layouts
     default.html
     blog.html
  +modules
     +blog
        view.html
        posts.html
        archive.html
  +partials
theme.php
screenshopt.png 
```

然后您只需将 blog.html 编辑为您的博客布局，并为您查看 view、posts 和 archive.html。

事实上，在你的 PyroCMS 中有一个名为“base”的主题，看看那个主题，看看我说的是什么。

希望有帮助。

# javascript - 根据 URL 中的变量/键显示不同的图像

> ID：13502067
> 
> 赞同：1
> 
> 时间：2012-11-21T21:05:41.583
> 
> 标签：javascript, html

我目前在我的 URL 中使用查询字符串来指示产品选择。我使用此功能使产品选择出现在将提交到我们网站的隐藏文本框中：

```
function getQueryVariable(key) {
    var query = window.location.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split("=");
        if (decodeURIComponent(pair[0])== key) {
            return decodeURIComponent(pair[1]);
        }
    }
}

var product = getQueryVariable('product');
document.getElementById("00NK0000000Yqv2").value = product; 
```

我还需要根据 URL 查询字符串中指示的产品显示标题图像。我有四种产品（制造、建筑、专业和通用）。

我怎样才能做到这一点，如果 url 类似于：[www.foo.com?product=Construction](http://www.foo.com?product=Construction)它显示构造标题，或者如果它是[www.foo.com?product=Manufacturing](http://www.foo.com?product=Manufacturing)，则显示制造。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:10:51.447

您可以像这样更改图像的来源：

```
document.getElementById("headerImg").src = 'header' + product + '.jpg'; 
```

图像将具有相同 ID 的位置，如下所示：

```
<img id="headerImg" src="images/headerImg.jpg"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:11:22.213

您可以将元素的 css 类更改为您的产品名称，并替换 CSS 中的背景图像。例如，如果您的标头元素有一个 id = 标头，那么使用 jquery 时它看起来像这样。

$('#header').addClass(product); //product是你的变量

然后在你的 CSS 中，你可以这样设置它的样式：

#header {背景图像：url（pathToDefaultImage）}

#header.Manufacturing {背景图像：url（pathToManufacturingImage）}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:12:39.460

是的，您可以按照与设置相同的方式来执行此操作`value`-`src`根据您的查询变量设置图像的属性。

就像是：

```
var image;
if (product === 'Construction') image = 'your_construction_image.png';
// more cases

document.getElementById('yourimageID').src = image; 
```

然而，更好的方法是使用您的服务器端语言来呈现您想要的 HTML，而不是在之后使用 JavaScript 进行设置。

# mysql - 从 SELECT 查询中得到相反的结果

> ID：13502068
> 
> 赞同：2
> 
> 时间：2012-11-21T21:05:47.053
> 
> 标签：mysql, select, join, left-join

这些是我的桌子：

```
`room`(roomID,roomNum)  
`customer`(customerID,Surname,etc)  
`contract`(contractID,roomID,weekNum)  
`paymen`t(paymentID,customerID,contractID,YearKoino) 
```

当我使用以下查询时：

```
`select` room.roomnum  
`from` payment,contract,room,customer  
`where` payment.contractID = contract.contractID  
`and` contract.roomID=room.roomID  
`and` customer.customerID=payment.customerID  
`and` contract.weeknum='40'  
`and` payment.YearKoino='2007' ; 
```

我得到的结果是：

```
+---------+  
| roomnum |  
+---------+  
| Δ-12    |  
| Γ-22    |  
| Α-32    |  
| Γ-21    |  
| Δ-11    |  
| Ε-12    |  
| Γ-31    |  
| Ε-22    |  
| Α-22    |  
| Δ-12    |  
| Γ-12    |  
+---------+  
11 rows in set 
```

我想要做的是运行一个查询，它给我完全相反的结果（桌子房间里的房间号码不在桌子付款中）。这可以通过将上述查询的房间结果与房间中的房间号码列进行比较来完成表。到目前为止我的一些努力：

```
`Select` room.roomnum  
`from` room  
`where` NOT EXISTS  
(`select` room.roomnum  
`from` payment,contract,room,customer  
`where` payment.contractID = contract.contractID  
`and` contract.roomID=room.roomID  
`and` customer.customerID=payment.customerID  
`and` contract.weeknum='40'  
`AND` payment.YearKoino='2007');  
Empty set 
```

和

```
`SELECT` *
`FROM` customer a
`LEFT OUTER JOIN` payment b
`on` a.customerID=b.customerID
`where` a.customer is null; 
```

我也尝试用“不存在”替换“不存在”，但徒劳无功。我已经读过最好的方法是使用“左连接”。当我必须比较时我可以做到简单的表。但在我的示例中，我必须将列与表连接中的列进行比较...

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:10:08.840

我不知道为什么你`not in`没有工作。

这应该有效（不使用表名别名）：

```
 Select r1.roomnum 
   from room AS r1
   where r1.roomnum NOT IN 
       (select r2.roomnum 
        from payment,contract,room as r2,customer 
        where payment.contractID = contract.contractID
        and contract.roomID=r2.roomID 
        and customer.customerID=payment.customerID 
        and contract.weeknum='40' 
        AND payment.YearKoino='2007'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:11:47.233

当然，您必须*将*您的 NOT EXISTS 查询与您的主查询相关联

```
Select 
  roomnum 
from 
  room main
where 
  NOT EXISTS (
   select 1 
   from   payment
          inner join contract on payment.contractID = contract.contractID
          inner join room     on contract.roomID = room.roomID 
          inner join customer on customer.customerID = payment.customerID 
   where  contract.weeknum='40' 
          and payment.YearKoino='2007'
          and room.roomnum = main.roomnum  -- < correlation to main query
); 
```

另外，学习 SQL-92 风格的连接。没有人再做旧式加入了。

# c# - 使用自定义对象的动态列表，并且不能动态更改 dataGrid 的单元格属性

> ID：13502071
> 
> 赞同：4
> 
> 时间：2012-11-21T21:06:00.593
> 
> 标签：c#, winforms, datagridview, datagridviewrow

我是在 Stack 上发帖的新手。我已经搜索了很长一段时间来解决与我类似的问题。我正在尝试根据对象的布尔值动态地将 WinForms DataGridView 中的复选框从非只读更改为只读。

它在调试模式下显示更改已经发生，但是一旦完全运行，应该只读的复选框单元格仍然允许检查和取消选中功能。我已将注释掉的部分留在其中，以表明我已尝试这样做。

```
m_SingletonForm.dataGridView1.DataSource = list;
m_SingletonForm.dataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.DisplayedCells;
m_SingletonForm.dataGridView1.Columns["StoreGroup"].ReadOnly = true;
m_SingletonForm.dataGridView1.Columns["Message"].AutoSizeMode = DataGridViewAutoSizeColumnMode.Fill;
m_SingletonForm.dataGridView1[0, 0].ReadOnly = true;

foreach (DataGridViewRow row in m_SingletonForm.dataGridView1.Rows)
{
    //var isChecked = Convert.ToBoolean(row.Cells["SendFile"].Value);

    //if (!isChecked)
    //{
        //m_SingletonForm.dataGridView1.Rows[0].Cells["SendFile"].Style.BackColor = Color.Red;
        //m_SingletonForm.dataGridView1.Rows[0].Cells["SendFile"].ReadOnly = true;

        //m_SingletonForm.dataGridView1.Rows[row.Index].Cells["SendFile"].Style.BackColor = Color.Red;
        //m_SingletonForm.dataGridView1.Rows[row.Index].Cells["SendFile"].ReadOnly = true;
        //m_SingletonForm.dataGridView1["SendFile", row.Index].ReadOnly = true;
        //m_SingletonForm.dataGridView1["SendFile", row.Index].Style.BackColor = Color.Red;          
    // }
}

m_SingletonForm.label1.Text = message;
m_SingletonForm.Text = title;
MessageBox.Show(m_SingletonForm.dataGridView1[0, 0].ReadOnly.ToString());
m_SingletonForm.ShowDialog(); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T13:33:48.013

从该行`m_SingletonForm.ShowDialog();`看来，您在`DataGridView`显示^*之前就拥有此代码。对于要应用网格项目的此类更改来说，这还为时过早。如果您的代码位于表单的构造函数中，您也会看到同样的问题。

解决该问题的最简单方法是在`DataBindingComplete`事件处理程序中放置用于将单元格设置为只读的代码。像这样的东西：

```
// Attach the event
m_SingletonForm.dataGridView1.DataBindingComplete += new
    DataGridViewBindingCompleteEventHandler(dataGridView1_DataBindingComplete);

// And the code for the handler
void dataGridView1_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
{
    foreach (DataGridViewRow row in m_SingletonForm.dataGridView1.Rows)
    {
        var isChecked = Convert.ToBoolean(row.Cells["SendFile"].Value);

        if (!isChecked)
        {
            m_SingletonForm.dataGridView1.Rows[0].Cells["SendFile"].Style.BackColor = Color.Red;
            m_SingletonForm.dataGridView1.Rows[0].Cells["SendFile"].ReadOnly = true;

            m_SingletonForm.dataGridView1.Rows[row.Index].Cells["SendFile"].Style.BackColor = Color.Red;
            m_SingletonForm.dataGridView1.Rows[row.Index].Cells["SendFile"].ReadOnly = true;
            m_SingletonForm.dataGridView1["SendFile", row.Index].ReadOnly = true;
            m_SingletonForm.dataGridView1["SendFile", row.Index].Style.BackColor = Color.Red;
        }
    }            
} 
```

* * *

^*我从来没有 100% 弄清楚为什么会这样——我相信这与其中有两组单元格的事实有关`DataGridView`——编辑/ui 单元格和它们所在的数据。

# java - 使用少于字符串内容的字符在 Java 中打印字符串

> ID：13502074
> 
> 赞同：3
> 
> 时间：2012-11-21T21:06:06.920
> 
> 标签：java, string, minify

这是为了下学期即将到来的学校额外学分分配。我必须在屏幕上打印一个段落，但字符数是代码必须小于段落中的字符数。该段如下：

> “我保证，每一个带有我名字的程序都应该由我（以及我的合著者，如果有的话）编写，并且我完全理解这个程序。我提交的每个程序都应该完全是我自己的作品，除非另有说明。我明白学术不诚实不仅包括抄袭他人的作品，还包括教唆或协助抄袭。与过去或现在提交的任何其他提交的代码相似，无论解释如何，都不会获得任何荣誉。我理解学术不诚实的后果是 ' F' for the class。我承诺通过编写自己的程序来学习Java。我将努力关注细节并编写我自己和其他程序员都可以理解的程序。
> 
> 程序中的字符总数应少于承诺中的字符总数（可打印 655 个，总共 793 个）。

该程序可以不接受任何输入......没有文件，下载等。

我最初的想法是，既然没有人能够做到，那肯定超出了我们目前在课堂上所学的范围。由于它必须更少，因此您显然不能只逐行打印段落，这是每个人在作业的第一部分（常规学分）中所做的。

我已经使用 java.util.zip 研究了字符串压缩，但我一直遇到不允许输入的问题。我现在搁置的一个想法是：有没有办法以压缩形式对字符串进行编码，使代码比段落的未压缩版本更少字符，并且在我将字符串打印到控制台时简单地解压缩字符串？

我也涉足 ASCII 值，但是，ASCII 值仅代表字符，并且所有 ASCII 值的字符长度都比它们用来表示的字符长，所以我没有看到它的用途。

我现在确定的想法是获取最长的重复单词并为它们分配一个字符串变量名称。然后，只需用可变连接样式替换段落中的单词。到目前为止，这是我的代码：

```
import static java.lang.System.out;

public class Pledge {
  public static void main(String[] args){
    String s=" understand ",p=" program",z=" academic dishonesty ",c=" copying",i="I pledge ";
    out.println(i+"that every"+p+" with my name on it shall be written by me (and my co-authors, if any) and that i fully"+s+"the"+p+". Every"+p+" I submit shall be entirely my own work unless otherwise attributed. I"+s+"that"+z+"not only includes"+c+" other people's work, but also abetting or facilitating"+c+". Code that is similar to any other submission past");
    out.println("or present will get no credit whatever the explanation. I"+s+"that the consequence of"+z+"is a grade of 'F' for the class."+i+"to devote my efforts to learning Java by writing my own"+p+"s. I shall strive to be attentive to detail and write"+p+"s "+s+"able by myself and other"+p+"mers.");
  }
} 
```

随附的代码是 762 个可打印字符。因为我少了 112 个字符，而且代码已经看起来很糟糕，有两个巨大的 println 语句，我有点觉得我没有走在正确的轨道上。我不希望为我编写任何代码（我讨厌那样），但非常感谢一些提示或技巧将我推向正确的方向。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:13:32.023

您可能想要研究的一件事是[Huffman encoding](http://en.wikipedia.org/wiki/Huffman_coding)。该方法*类似于*您发布的程序中的方法，但在压缩段落方面更加彻底。因此，您可以（预先）压缩文本，将压缩版本放在源文件中，解压缩并打印。

还有一些小技巧也可以刮掉一些字符；例如，

*   `main(String[] args)`可以`main(String[]v)`（保存 4 个字符）
*   您可以使用比 更短的名称`Pledge`，可能是单字符名称（保存 5 个字符）
*   您可以将所有内容放在一行上（保存了许多字符）

它们是小东西，但它们会加起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:45:50.940

一个创造性的解决方案可能是用 Unicode 编写程序并使用 UTF-16 对字符串进行编码。这允许您使用一半的“可打印字符”来存储字符串。例如：

```
public static void main(String[] args) throws Exception {
    String s = "䤠灬敤来⁴桡琠敶敲礠灲潧牡洠";
    System.out.println(new String(s.getBytes("UTF-16BE"),"UTF-8"));
} 
```

打印`I pledge that every program`。输出为 28 个字符，但用于存储字符串的“可打印字符”数仅为 14。要编码 793 个可打印字符，字符串需要 397 个字符，而实际代码则需要 258 个字符.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T02:19:14.330

您当前方法的改进是使用[`printf()`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html#printf%28java.lang.String,%20java.lang.Object...%29)及其[显式参数索引](http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#dpos)功能。这将为原始字符串中的每次出现节省 1 个字符（从而让您“压缩”较短的子字符串。它还摆脱了字符串变量声明，即每个子字符串少三个字符和一点。

剧透的 ideone 版本在这里：http://ideone.com/lnrTrG [-](http://ideone.com/lnrTrG)我设法把它减少到 784 个字符，而无需使用任何非常聪明的东西。我对提取的子字符串的选择也可能不是最优的。

我尝试使用 实现相同的功能[`MessageFormat.format()`](http://docs.oracle.com/javase/7/docs/api/java/text/MessageFormat.html#format%28java.lang.String,%20java.lang.Object...%29)，但它不会替换所有占位符。考虑到版本有多接近限制`printf()`，压缩较短子字符串的能力（因为`MessageFormat`'s 的显式索引占位符比`printf()`'s 短一个字符）甚至不会抵消额外的 32 个字符的开销`java.text.MessageFormat.format()`。（也就是说，这可能值得一试。您仅在占位符上保存了 29 个字符，所以它很接近。）

* * *

您的问题中的另一点也有直接答案：

> 有没有办法以压缩形式对字符串进行编码，使代码比段落的未压缩版本更少字符，并且在我将字符串打印到控制台时简单地解压缩字符串？

您已经发现`java.util.zip`，缺失的部分是[*base-64 编码*](http://en.wikipedia.org/wiki/Base64)。这将允许您将压缩字节存储在由可打印字符组成的字符串中。它将占用比编码数组的长度更多的字符，但（幸运的是）远少于原始字符串。（它也应该比直接写出字节数组值更短。）您可以使用实用程序方法[`DatatypeConverter`](http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/DatatypeConverter.html)来处理这种编码。（感谢@owlstead 的提示。）

我的同事提出的一种比 base-64 更好的更好方法是简单地使用像 Latin-1 这样的传统字符集对压缩数据进行编码。由于大多数 Latin-1 字符都是可打印的，因此可以使用一个字符将它们写入 Java 字符串文字。需要转义的少数仍然会比 base-64 少。如果您的源文件也可以用 Latin-1 编码，这也将避免争论字符和字节之间的区别。

# jquery - jQuery：使用数组中的信息克隆 HTML

> ID：13502076
> 
> 赞同：1
> 
> 时间：2012-11-21T21:06:22.737
> 
> 标签：jquery

我有以下 HTML，我想在 div 容器 (.container) 中重复 5 次。

```
<div class="block">
   <div class="name">Name</div>
   <div class="content>Content</div>
</div> 
```

使用 jQuery/JS，我想创建一个数组（或某种其他类型的组织结构），当通过 for 循环运行时可以更改每个块的“名称”和“内容”。

例如，我有两个数组：

```
var names = ["Joe","Jane","Bill","Nicole","Dennis"];
var content = ["First content","Second content","Third content","Fourth content","Fifth content"] 
```

我想克隆顶部的 HTML，并为每个块，将名称和内容更改为其各自的数组项。我怎样才能做到这一点？

现在，我有重复 HTML 的代码。

```
var row = $('.block');

for(var i = 0; i < 5; i++ )
  $('.container').append(row.clone())
} 
```

编辑：有没有更好的方法可以在不创建多个数组的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:09:13.143

我想这是你的答案：

```
var row = $('.block');

for(var i = 0; i < 5; i++ ){
  var cp = row.clone();
  cp.find('.name').text(names[i]);
  cp.find('.content').text(content[i]);
  $('.container').append(cp);
} 
```

在这里工作演示：http: [//jsfiddle.net/pulkitm/NV2e2/](http://jsfiddle.net/pulkitm/NV2e2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:10:56.800

您可以在添加元素之前使用`find`和`text`方法并更改元素的内容，请注意您缺少块的开头`{`。`for`

```
for (var i = 0; i < 5; i++) {
   row.clone()
      .find('.name').text(names[i]).end()
      .find('.content').text(content[i]).end()
      .appendTo('.container')
} 
```

[http://jsfiddle.net/SU3vF/](http://jsfiddle.net/SU3vF/)

# java - 在二叉树中搜索字符串

> ID：13502078
> 
> 赞同：0
> 
> 时间：2012-11-21T21:06:36.433
> 
> 标签：java

我正在寻找搜索二叉树以查找存储在节点中的字符串。

```
public void traverse (BinaryTreeNode root){ 
    if (root.leftchild != null){
        traverse (root.leftchild);
    }
        System.out.println(root.character);
    if (root.rightchild != null){
        traverse (root.rightchild);
    }
} 
```

这工作得很好，并显示了树中的所有节点。（该代码是从另一个旧的 stackoverflow 问题的代码中工作的！我的问题是如何将 root.character 与输入的字符串进行比较，以及它是否匹配中断递归。如果有人可以给出一些提示，我将不胜感激。

```
 public BinaryTreeNode traverse (BinaryTreeNode root, String inString){ // Each child of a tree is a root of its subtree.
    if (root.character != null) {
        if (root.character.equalsIgnoreCase(inString)) {
            System.out.println("root.charcter: " + root.character + " char " + inString);
            return root;
        }
    }
    if (root.leftchild != null){
        traverse (root.leftchild, inString);
    }

    if (root.rightchild != null){
        traverse (root.rightchild, inString);
    }

    return null;
} 
```

上面的代码似乎有效，它返回正确的 BinaryTreeNode 但是，我还没有弄清楚如何在找到节点后停止递归，因此它最后也返回 null 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:10:19.930

您在没有将字符串传递给搜索的情况下调用 traverse 函数......在很多情况下，您也缺少返回值。

您需要更多地考虑您的函数何时应该终止递归（在这种情况下，返回节点）以及函数在不终止但探索树的其余部分时应该做什么。

例如在伪代码中（您进行编程）：

```
findNode(root, query) {
  // nothing to search, not found
  if root==null return null  

  // Found it!
  if root.name==query return root

  // This is when we recurse left, stop if we found a result
  leftResult = findNode(root.left, query)
  if leftResult!=null return leftResult

  // else try to the right, stop if we found a result
  rightResult = findNode(root.right, query)
  if rightResult!=null return rightResult

  // Nothing else to try, not found
  return null
} 
```

# cron - 奇怪的 CRON 行为

> ID：13502079
> 
> 赞同：0
> 
> 时间：2012-11-21T21:06:41.187
> 
> 标签：cron, gmail, sync, google-contacts-api, cron-task

我知道这可能非常模糊，但不确定为什么会这样，希望有人能够为我阐明这一点。

我有一个访问 Gmail 联系人（已授权）的自定义脚本，它将联系人与 Gmail 和我的自定义 CRM 同步。

当我在浏览器中运行脚本时，一切正常，没有问题。当我在“脚本”上运行我的 CRON 作业时，脚本无法登录帐户并使同步正常运行。

你知道为什么这在 CRON 和我的浏览器访问之间可能如此不同吗？

# java - 在另一个线程运行时执行任务

> ID：13502080
> 
> 赞同：2
> 
> 时间：2012-11-21T21:06:50.207
> 
> 标签：java, multithreading, swing

我目前正在学习 Java 中的多线程，遇到了一个有趣的问题。我有一个读取一些 CSV 文件的“加载器”类。

```
public class LoaderThread implements Runnable{

@Override
public void run(){
//do some fancy stuff
}
} 
```

此外，我有一个 SplashScreen，我想在加载数据时显示它。

```
import javax.swing.JLabel;
import javax.swing.JWindow;
import javax.swing.SwingConstants;

public class SplashScreen extends JWindow{

JWindow jwin = new JWindow();

public SplashScreen(){

jwin.getContentPane().add(new JLabel("Loading...please wait!",SwingConstants.CENTER));
jwin.setBounds(200, 200, 200, 100);

jwin.setLocationRelativeTo(null);

jwin.setVisible(true);

try {
  Thread.sleep(3000);
} catch (InterruptedException e) {
  Thread.currentThread().interrupt(); 
 }

jwin.setVisible(false);
jwin.dispose();

}
} 
```

当用户单击按钮时，代码从我的主类运行：

```
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt)   {                                         

    final Thread t = new Thread() {

           @Override
           public void run() {  

              LoaderThread myRunnable = new LoaderThread();
              Thread myThread = new Thread(myRunnable);
              myThread.setDaemon(true); 
              myThread.start();
              while(myThread.isAlive()==true)
              {
                  SplashScreen ss = new SplashScreen();
              }

           }
        };
        t.start();  // call back run()
        Thread.currentThread().interrupt();         

} 
```

此设置有效，但当加载时间超过 3 秒并显示至少 3 秒时，消息“闪烁”，即使加载过程可能更短。

我现在想知道只要加载线程正在运行，是否可以显示消息。不长也不短。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T21:15:30.470

您正在循环中创建新实例，这就是它闪烁的原因。你宁愿创建一个实例，让它可见，当另一个线程完成执行时，释放它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T21:24:18.720

这是观察者模式可以很好地工作的完美示例。在 Swing 中轻松做到这一点的一种方法是使用 SwingWorker 作为后台线程。执行 SwingWorker 时显示启动屏幕。在执行 SwingWorker 之前，给它添加一个 PropertyChangeListener，当它返回 SwingWorker.StateValue.DONE 时，摆脱闪屏。

另外，不要`Thread.sleep(...)`像你正在做的那样调用 Swing 事件线程，因为这是灾难的保证。

**编辑1**
关于您的评论-

> “也不要在 Swing 事件线程上调用 Thread.sleep ......”是什么意思？“也不要在 Swing 事件线程上调用 Thread.sleep ......”是什么意思？

这是在 Swing 事件线程上调用的，也称为 EDT 或Event **D** **ispatch** **T**线程：

 ****```
try {
  Thread.sleep(3000);
} catch (InterruptedException e) {
  Thread.currentThread().interrupt(); 
} 
```

这将使您的整个应用程序进入睡眠状态，使其完全无响应，因此建议您永远不要调用`Thread.sleep(...)`EDT。

**编辑 2**
示例代码：

```
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;

import javax.swing.*;

public class SwingWorkerEg extends JPanel {
   private static final int PREF_W = 300;
   private static final int PREF_H = 200;

   public SwingWorkerEg() {
      add(new JButton(new ButtonAction("Press Me")));
   }

   @Override
   public Dimension getPreferredSize() {
      return new Dimension(PREF_W, PREF_H);
   }

   private static void createAndShowGui() {
      JFrame frame = new JFrame("SwingWorkerEg");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(new SwingWorkerEg());
      frame.pack();
      frame.setLocationRelativeTo(null);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
}

class ButtonAction extends AbstractAction {
   public ButtonAction(String title) {
      super(title);
   }

   @Override
   public void actionPerformed(ActionEvent actEvt) {
      final JButton source = (JButton)actEvt.getSource();
      source.setEnabled(false);
      MySwingWorker mySw = new MySwingWorker();
      final MySplashScreen mySplash = new MySplashScreen();
      mySplash.setVisible(true);

      mySw.addPropertyChangeListener(new PropertyChangeListener() {

         @Override
         public void propertyChange(PropertyChangeEvent pcEvt) {
            if (SwingWorker.StateValue.DONE == pcEvt.getNewValue()) {
               mySplash.setVisible(false);
               mySplash.dispose();
               source.setEnabled(true);
            }
         }
      });
      mySw.execute();
   }
}

class MySwingWorker extends SwingWorker<Void, Void> {
   private static final long SLEEP_TIME = 5 * 1000;

   @Override
   protected Void doInBackground() throws Exception {
      Thread.sleep(SLEEP_TIME); // emulate long-running task
      return null;
   }
}

class MySplashScreen extends JWindow {
   private static final String LABEL_TEXT = "Loading, ... please wait...";
   private static final int PREF_W = 500;
   private static final int PREF_H = 300;

   public MySplashScreen() {
      add(new JLabel(LABEL_TEXT, SwingConstants.CENTER));
      pack();
      setLocationRelativeTo(null);
   }

   @Override
   public Dimension getPreferredSize() {
      return new Dimension(PREF_W, PREF_H);
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T21:27:01.237

您可以使用监视器[http://en.wikipedia.org/wiki/Monitor_(synchronization](http://en.wikipedia.org/wiki/Monitor_(synchronization) )

这样，您可以确保您的线程在任务完成时结束，而不是等待任意睡眠。

基本上你想这样做（需要扩展）：

```
public class Monitor {
  private boolean task = false;

  public void synchronized waitForTask(){
     while(!task){
        wait();
     }
  }

  public void synchronized taskIsDone(){
     task = true;
     notifyAll();
  } 
} 
```

两个对象都需要对此 Monitor 的引用。您的视图必须调用 waitForTask，而您的任务将调用 taskIsDone。****

# jquery - 如何将变量传递给单击事件处理程序？

> ID：13502082
> 
> 赞同：2
> 
> 时间：2012-11-21T21:06:57.767
> 
> 标签：jquery

我有以下功能来删除一行。我想通过传入`#search_result`.

```
function row_delete_ajax(event) {
    event.preventDefault();
    if (confirm(gettext('Are you sure you want to delete this row?'))) {
    var url = $(this).attr("href") + "/";

        $.post(url, function(result){
            $('#search_result').empty();
            $('#search_result').append(result);
        });                
    }       
}; 
```

这就是我最初绑定函数的方式，但是有点卡住了如何传递`#search_result`给`row_delete_ajax`

```
$(document).ready(function (){  
    $('#search_result').find(".row_delete_ajax").click(row_delete_ajax);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:23:21.920

另一种方法是使用[[eventData]](http://api.jquery.com/click/)参数：

> eventData：将传递给事件处理程序的数据映射。

```
$(document).ready(function (){  
    // Create an object with all the properties you want.
    var data = { id: '#search_result' }; 

    // Pass the data object as the first parameter in the click-event.
    $('#search_result').find(".row_delete_ajax").click(data, row_delete_ajax);
}); 
```

然后像这样使用它：

```
function row_delete_ajax(event) {
    event.preventDefault();
    if (confirm(gettext('Are you sure you want to delete this row?'))) {
    var url = $(this).attr("href") + "/";

        $.post(url, function(result){
            $(event.data.id).empty();
            $(event.data.id).append(result);
        });                
    }       
}; 
```

还要检查[event.data](http://api.jquery.com/event.data/)例如。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:12:37.687

您是否考虑过使用 data() [http://api.jquery.com/jQuery.data/](http://api.jquery.com/jQuery.data/)存储元信息？

```
$(document).ready(function (){  
    $('#search_result').find(".row_delete_ajax")
        .data('target', 'search_result')
        .click(row_delete_ajax);
} 
```

然后您的 row_delete_ajax 将如下所示：

```
function row_delete_ajax(event) {
    event.preventDefault();
    if (confirm(gettext('Are you sure you want to delete this row?'))) {
        var url = $(this).attr("href") + "/";

        var target = $(this).data('target');
        $('#' + target).load(url);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T21:13:33.743

你必须稍微重写你的点击，变成这样：

```
$(document).ready(function (){  
    $('#search_result').find(".row_delete_ajax").click(function (event) {
        row_delete_ajax(event, $("#search_result"));
    });
} 
```

然后更改您的函数以获取两个参数：

```
function row_delete_ajax(event, searchResult) {
    event.preventDefault();
    if (confirm(gettext('Are you sure you want to delete this row?'))) {
        var url = $(this).attr("href") + "/";

        $.post(url, function(result){
            searchResult.empty();
            searchResult.append(result);
        });                
    }       
}; 
```

# c# - 在 ControlTemplate.Resources 中绑定到 TemplatedParent

> ID：13502084
> 
> 赞同：2
> 
> 时间：2012-11-21T21:07:04.313
> 
> 标签：c#, wpf, xaml

我有一个`ControlTemplate`我想在其中接收两个集合并将它们组合成一个集合，然后将其绑定到一个`ItemsControl`。计算由对象完成，我在模板中`Calculator`创建一个实例。`ResourceDictionary`

```
<Setter Property="Template">
  <Setter.Value>
    <ControlTemplate TargetType="{x:Type local:IndicatorBar}">
       <ControlTemplate.Resources>
          <local:Calculator 
            x:Key="_calculator"
            Ranges="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Ranges}" 
            DataSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataSource}" />
        </ControlTemplate.Resources>

        <ItemsControl ItemsSource="{Binding Ratios, Source={StaticResource _calculator}}">
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <Border Background="{Binding Range}">
                <TextBlock Text="{Binding Ratio}" Foreground="White" />
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </ControlTemplate>
    </Setter.Value>
</Setter> 
```

但是，这似乎不起作用并导致绑定错误：

> *System.Windows.Data 错误：2：找不到目标元素的管理 FrameworkElement 或 FrameworkContentElement。
> 绑定表达式：路径=范围；数据项=空；目标元素是“计算器”（HashCode=33746798）；目标属性是“范围”（类型“范围”）
> System.Windows.Data 错误：2：找不到目标元素的管理 FrameworkElement 或 FrameworkContentElement。
> 绑定表达式：路径=数据源；数据项=空；目标元素是“计算器”（HashCode=33746798）；目标属性是“数据源”（类型“IEnumerable”）*

我不确定如何解决这个问题，所以任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-19T06:32:54.923

首先，您的绑定使用的是**RelativeSource.TemplatedParent**模式，因此绑定的来源是您应用此模板的控件。我认为**TemplatedParent**不适合您的情况。请参阅此[链接](http://msdn.microsoft.com/en-us/library/system.windows.data.relativesource.templatedparent%28v=vs.110%29.aspx)以了解**TemplatedParent**的使用。您能否添加包含您的数据以绑定到计算器控件的模型？

# qr-code - DTSTART 与今天相关的事件的 QR 码

> ID：13502086
> 
> 赞同：2
> 
> 时间：2012-11-21T21:07:27.877
> 
> 标签：qr-code, icalendar, rfc2445

是否可以创建一个二维码，在日历中设置一个事件，其日期与扫描代码的日期相关？

示例：扫码，从今天起 2 个月后，我的手机显示事件或为我提供提醒提醒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T13:00:39.987

日历规范 (RFC5545) 不允许 DTSTART 是相对的：

```
3.8.2.4\.  Date-Time Start [...] The time value MUST be one of the forms defined for the DATE-TIME value type. The value type can be set to a DATE value type.

3.3.4\.  Date [...] The textual format specifies a four-digit year, two-digit month, and two-digit day of the month.

3.3.5\.  Date-Time [...] The "DATE-TIME" value type is used to identify values that contain
  a precise calendar date and time of day. 
```

但是，QRCODE 可以是指向 url 的链接，然后将动态生成带有 DTSART 的 ical 文件，该文件将设置为未来 2 个月的日期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:18:11.247

您可以创建一个指向 .ics 文件所在的 url 的 QR 码。一次下载文件时，设备上会出现一个弹出窗口，用于设置事件。

您可以创建自定义 .ics 文件，例如，此处： http: [//www.pratie.com/lab/icalendar/](http://www.pratie.com/lab/icalendar/)

编辑：您可以在代码编程中动态编译 DSTART 变量：

```
BEGIN:VCALENDAR
VERSION:1.0
BEGIN:VEVENT
DTSTART:20121121T090000
DTEND:20121121T100000
SUMMARY:fdsf
LOCATION:
DESCRIPTION:
PRIORITY:3
END:VEVENT
END:VCALENDAR 
```

变量 DSTART 的格式如下：

开始：`<year><month><day>T<hour><minutes><seconds>`

要使用相对的“现在”时间，您可以使用编程提供的多个选项。( `Time.now`, 时间戳)，然后将其转换为正确的 .ics 输出。

# delphi - IdUDPClient ，如何向服务器发送数据包？

> ID：13502087
> 
> 赞同：1
> 
> 时间：2012-11-21T21:07:30.643
> 
> 标签：delphi, indy10, delphi-xe3

如何正确地将数据包发送到 UDP 服务器？我正在尝试，但它不起作用，因为我没有从服务器收到任何东西。

我需要的是发送一个数据包：`int64|int|int`

并从服务器接收一个数据包：`int|int|int64`

如何正确执行？谢谢。

```
type
  Tconnecting = record
    a: int64;
    b: integer;
    c: integer;
  end;
  Treply_connect = record
    a: integer;
    b: integer;
    c: int64;
  end;

var 
  udp: TIdUDPClient;
  send_data: TIdBytes;
  received_data: TIdBytes;
  i: integer;
  packet: Tconnecting;
  reply_packet: Treply_connect;

begin
  packet.a := 41727101980;
  packet.b := 0;
  packet.c := RandomRange(1, 9999999);
  SetLength(send_data, sizeof(packet));
  Move(packet, send_data[0], sizeof(packet));
  udp := TIdUDPClient.Create(nil);
  try
    udp.Host := 'server.com';
    udp.Port := 1234;
    udp.SendBuffer(send_data);
    SetLength(received_data, 0);
    i := udp.ReceiveBuffer(received_data, 5000);
    Memo1.Lines.Add('Data reiceived! Len:'+IntToStr(Length(received_data))+',data:|'+BytesToString(received_data, 0)+'|');
  finally
    FreeAndNil(udp);
  end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T00:29:18.653

你没有`ReceiveBuffer()`正确使用。您将输出缓冲区的大小设置为 0 字节，因此`ReceiveBuffer()`将没有任何内存来读取接收到的数据。您需要将输出缓冲区预分配到您期望的最大大小。的返回值`ReceiveBuffer()`将告诉您实际读入缓冲区的字节数。

换句话说，改变这个：

```
SetLength(received_data, 0); 
```

对此：

```
SetLength(received_data, SizeOf(Treply_connect)); 
```

并改变这个：

```
Memo1.Lines.Add('Data reiceived! Len:'+IntToStr(Length(received_data))+', data:|'+BytesToString(received_data, 0)+'|'); 
```

对此：

```
Memo1.Lines.Add('Data received! Len:'+IntToStr(i)+', data:|'+BytesToString(received_data, 0, i)+'|'); 
```

另外，Indy 有一个`RawToBytes()`函数可以用来将数据包复制到`TIdBytes`：

```
send_data := RawToBytes(packet, SizeOf(packet)); 
```

`BytesToRaw()`当您想要提取接收到的数据包时的功能：

```
BytesToRaw(received_data, reply_packet, SizeOf(reply_packet)); 
```

# c# - 两个图片框在每个按钮单击时循环显示图像

> ID：13502088
> 
> 赞同：1
> 
> 时间：2012-11-21T21:07:32.760
> 
> 标签：c#, .net, picturebox

当我说我是初学者时，我真的很新鲜，你可以提前道歉！

我想做的是在一个表单中有两个图片框和一个按钮。当我单击按钮时，它会从我的图像文件夹中选择 2 张新图像，总共会执行 5 次

我如何解决这个问题的任何想法 - 这是我到目前为止点击按钮的内容

```
 private void button1_Click(object sender, EventArgs e)
    {
      pictureBox1.Load(@"C:\Resources\PICT01.JPG");
      pictureBox2.Load(@"C:\Resources\PICT02.JPG");
} 
```

任何答案都必须是基本的，因为我只是在学习！提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:36:30.477

您需要创建一个全局 int 来跟踪您切换图片的频率，并在您的 button1_click 中处理该数字。

我自己不是专家，但我会这样做。开关在这里是理想的，因为您需要检查 5 种不同的可能性。

```
//global int
int count = 0;

private void button1_Click(object sender, EventArgs e)
{
  count++;
  switch(count)
  {
     case 1:
       //load image 1 and 2
       break;
     case 2:
       //load image 3 and 4
       break;
     case 3:
       //load image 5 and 6
       break;
     case 4:
       //load image 7 and 8
       break;
     case 5:
       //load image 9 and 10
       break;
     default: 
       break;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:57:03.363

这个示例程序将在 MyPictures 文件夹中创建一个所有 jpg 文件的列表，并从列表中随机选择图片，当列表为空时会引发异常。

```
public Form1()
{
    // Reading pictures from My Pictures:
    string path = Environment.GetFolderPath(Environment.SpecialFolders.MyPictures);
    DictionaryInfo myPictures = new DictionaryInfo(path);
    FPictureFiles = myPictures.GetFiles("*.jpg", SearchOption.AllDirectories).ToList();
}
private List<FileInfo> FPictureFiles;
private Random FRandom = new Random();

private void button1_Click(object sender)
{
    pictureBox1.Load(PickFile());
    pictureBox2.Load(PickFile());
}

private string PickFile()
{
    if (FPictureFiles.Count == 0) throw new Exception("No more picture files");

    int index = FRandom.Next(FPictureFiles.Count);
    string filename = FPictureFiles[index].FullName;
    FPictureFiles.RemoveAt(index);
    return filename;
} 
```

我希望这对你的追求有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:58:02.447

您可以尝试创建一个新`List<string>`文件，其中列出了所有具有您选择的特定扩展名的文件。`Random`然后，考虑到范围不会超过我们的值，初始化一个新类，该类在特定范围内获取随机数`List<string>.Count`。

**例子**

假设`CurrentClicks`标识一个新整数并且`MaximumClicks`是我们的最大值

```
public Form1()
{
    InitializeComponent();
    button1.Click += new EventHandler(button1_Click); //Link the Click event of button1 to button1_Click
}

const int MaximumClicks = 5; //Initialize a new constant int of value 5 named MaximumClicks
int CurrentClicks = 0; //Initialize a new variable of name CurrentClicks as an int of value 0 
```

以下可能适用

```
private void button1_Click(object sender, EventArgs e)
{
    if (CurrentClicks < MaximumClicks) //Continue if CurrentClicks is less than 5
    {
        string FilesPath = @"D:\Resources\International"; //Replace this with the targeted folder
        string FileExtensions = "*.png"; //Applies only to .png file extensions. Replace this with your desired file extension (jpg/bmp/gif/etc)
        List<string> ItemsInFolder = new List<string>(); //Initialize a new Generic Collection of name ItemsInFolder as a new List<string>
        foreach (string ImageLocation in Directory.GetFiles(FilesPath, FileExtensions)) //Get all files in FilesPath creating a new string of name ImageLocation considering that FilesPath returns a directory matching FileExtensions considering that FileExtensions returns a valid file extension within the targeted folder
        {
            ItemsInFolder.Add(ImageLocation); //Add ImageLocation to ItemsInFolder
        }
        Random Rnd = new Random(); //Initialize a new Random class of name Rnd
        int ImageIndex = Rnd.Next(0, ItemsInFolder.Count); //Initialize a new variable of name ImageIndex as a random number from 0 to the items retrieved count
        pictureBox1.Load(ItemsInFolder[ImageIndex]); //Load the random image based on ImageIndex as ImageIndex belongs to a random index in ItemsInFolder
        CurrentClicks++; //Increment CurrentClicks by 1
    }
    else
    {
        //Do Something (MaximumClicks reached)
    }
} 
```

这将在提供的文件夹中获取与指定扩展名匹配的文件位置。`PictureBox`然后，从收集到name的文件位置加载一个随机文件`pictureBox1`。

但是，这不会避免之前添加到`PictureBox`. 如果您想避免重复，您可以创建一个新`int`数组或`List<int>`添加所有`ImageIndex`应用到的数组，`PictureBox`但建议使用它，`List<int>`因为它似乎更易于管理

**例子**

```
List<int> AlreadyAdded = new List<int>();
redo:
    Random Rnd = new Random();
    int ImageIndex = Rnd.Next(0, ItemsInFolder.Count);
    if (AlreadyAdded.Contains(ImageIndex)) //Continue within this block if the item already exists in AlreadyAdded
    {
        goto redo;
    }                
    AlreadyAdded.Add(ImageIndex); //Add ImageIndex to AlreadyAdded 
```

谢谢，
我希望你觉得这有帮助:)

# javascript - JQuery setTimeout - 任何更有效的方法来做到这一点？

> ID：13502091
> 
> 赞同：2
> 
> 时间：2012-11-21T21:07:54.983
> 
> 标签：javascript, jquery, settimeout

所以我只是每隔一小段时间切换和删除一些类 - 我对 JS 和 JQuery 很陌生，但我已经这样做了，它有效：

```
function priceTable() {
    setTimeout(function(){$("#price-table-1").toggleClass("price-table-highlight");  },1000);
    setTimeout(function(){$("#price-table-1").removeClass("price-table-highlight");  },2000);
    setTimeout(function(){$("#price-table-2").toggleClass("price-table-highlight");  },2000);
    setTimeout(function(){$("#price-table-2").removeClass("price-table-highlight");  },3000);
    setTimeout(function(){$("#price-table-3").toggleClass("price-table-highlight");  },3000);
    setTimeout(function(){$("#price-table-3").removeClass("price-table-highlight");  },4000); 
} 
```

然而，似乎有很多重复——有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:13:10.527

您可以使用简单的迭代来干燥您的 id 标识符。

```
timer = 1000;
for( pricetableindex = 1; pricetableindex <=3; pricetableindex++ ){
    .....unction(){$("#price-table-"+pricetableindex).toggle...  ), timer);
    .....unction(){$("#price-table-"+pricetableindex).remove...  ), timer+=1000); 
```

这是使用重复语法来访问对象成员、点语法以及数组表示法的主要卖点。

```
obj.member1 syntax does not allow this kind of manipulation, while 
obj["member1"] does. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T05:09:19.860

对于 jQuery 动画方法，使用该`delay`方法可以正常工作。对于其他 jQuery 方法，我可能会推荐[jquery.wait](https://github.com/madbook/jquery.wait)，它的工作原理与所有 jQuery 方法类似，`delay`但适用于所有 jQuery 方法。你的代码然后变成

```
function priceTable() {
  $('#price-table-1').wait(1000).toggleClass('price-table-highlight').wait(1000).removeClass('price-table-highlight');
  $('#price-table-2').wait(2000).toggleClass('price-table-highlight').wait(1000).removeClass('price-table-highlight');
  $('#price-table-2').wait(3000).toggleClass('price-table-highlight').wait(1000).removeClass('price-table-highlight');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:13:47.903

```
function priceTable() {
    var table_count = 3;

    for(var i = 0; i < table_count; i++) {
        // jQuery
        $('#price-table-' + i).delay(1000)
                              .animate({ "background-color": "blue" })
                              .delay(1000)
                              .animate({ "background-color": "black" });

        // jQuery UI (http://api.jqueryui.com/addClass/)
        $('#price-table-' + i).delay(1000)
                              .addClass("price-table-highlight", 0) // 0 is important
                              .delay(1000)
                              .removeClass("price-table-highlight");

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T21:26:47.290

如果您对蓝/黑颜色交换没有限制，我会使用 jQuerys `pulsate`（可以在[此处](http://docs.jquery.com/UI/Effects/Pulsate)找到文档）效果：

```
function priceTable() {
  $("#price-table-1").effect("pulsate", { times:3 }, 2000);
  $("#price-table-2").effect("pulsate", { times:3 }, 2000);
  $("#price-table-3").effect("pulsate", { times:3 }, 2000);
} 
```

唯一的缺点：它使整个元素脉动。所以我建议不要完全像上面那样使用上面的内容（因为#price-tables 中的所有文本也会淡入和淡出）。
脉动所做的是，它会脉动它所应用的元素的不透明度。因此，例如，您可以使用空 div 和适当的背景颜色为您的价格表添加底色。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T21:33:01.800

您可以查看 jQuery 的[动画](http://api.jquery.com/animate/)和[延迟](http://api.jquery.com/delay/)功能的组合来实现您的结果。

[jQuery UI 插件](http://jqueryui.com/addClass/)（您可能已经在使用？toggleClass 是他们的方法之一，但我认为它存在于 jQuery 核心中并在 jQuery-UI 中扩展）也可以为整个类设置动画。它会是这样的：

```
function priceTable() {
    $("#price-table-1").toggleClass("price-table-highlight",1).delay(1000).toggleClass("price-table-highlight", 1);
} 
```

严格来说不是“更高效”，因为它需要一个完整的附加库，但肯定需要更少的代码。我不知道您是否能够通过`.delay`调用启动动画队列，或者您是否必须设置超时函数才能开始在`price-table-2`和`3`id 元素上播放动画。

# powershell - Get-WmiObject：仅选择本地（到当前会话）对象？

> ID：13502093
> 
> 赞同：0
> 
> 时间：2012-11-21T21:07:57.543
> 
> 标签：powershell, windows-xp

我有这样的 Powershell 代码：

```
$disks = Get-WmiObject -Class Win32_MappedLogicalDisk -Filter "DeviceID='Z:'"
foreach($disk in $disks)
{
      [Console]::WriteLine("Object: " + $disk.Name + " is " + $disk.ProviderName );
} 
```

但它会选择当前会话之外的对象，就像终端会话中的其他用户一样。如何将其限制为仅在当前会话下的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:21:04.503

你可以使用这个：

```
gwmi Win32_LogicalDisk -Filter  "DeviceID='Z:' " | ? { $_.drivetype -eq 4 } 
```

where 条件只能确定是网络驱动器而不是其他类型的单元。

您可以[在此处](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394173%28v=vs.85%29.aspx)阅读其他驱动类型代码

# ember.js - Ember - ConnectOutlet - 视图何时从 preRender 更改为 inDom

> ID：13502106
> 
> 赞同：1
> 
> 时间：2012-11-21T21:08:37.230
> 
> 标签：ember.js

我试图了解 connectOutlet 方法，并且当从 connectOutet 返回的视图实际插入 DOM 时。

在 connectOutlet 中创建的视图使 connectOutlet 处于 preRender 状态。

```
connectOutlet: function(name, context) {
  // method body
    view = this.createOutletView(outletName, viewClass);

    if (controller) { set(view, 'controller', controller); }
    set(this, outletName, view);

    return view;
} 
```

我还没有追踪到视图插入到 Dom 的位置或时间以及视图转换到 inDom 状态的时间。

我怀疑运行循环正在发挥作用，并且在当前运行循环完成后它会转换。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T04:58:45.023

运行循环确实在这里发挥作用。运行循环通过排空有序的队列集合来处理事件。按顺序，它们是：`sync`, `actions`, `render`, `afterRender`, `destroy`, 和`timers`。视图渲染是视图实际插入到 DOM 中的位置，它总是被安排在`render`队列中。

如果您对此有其他问题，请发表评论，我很乐意扩展此答案以涵盖它们。

# meteor - Meteor - 选择被点击元素的父 ID

> ID：13502108
> 
> 赞同：1
> 
> 时间：2012-11-21T21:09:01.543
> 
> 标签：meteor, handlebars.js

使用 Meteor，我试图循环并显示数据库中的笔记列表，并带有删除每个笔记的选项。

这是 HTML（使用 Handlebars.js）

```
<template name="Notes">
    {{#each NoteArr}}
        <div class="Note">
            <h2>{{Title}}</h2>
            <p>{{Body}}</p>
            <span class="deleteNote">Delete</span>
        </div>
    {{/each}}
</template> 
```

这是客户端Javascript

```
Template.Notes.events = {
    "click .deleteNote" : function(){
        noteID = $('.deleteNote').parent().attr("id");
        Notes.remove({ID:noteID});
    }
}; 
```

这会抓取 .deleteNote 的第一个实例，因此除非我尝试删除第一个实例，否则这无济于事。如何获取单击的 .deleteNote 特定实例的父级，而不仅仅是找到的第一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T05:36:41.987

删除第一个元素的原因是.. 在您的`.click`事件中，您直接访问 div ，因为`$('.deleteNote').parent()`它获取了 html 中具有 class 的第一个节点`.deleteNode`。

**`notes`现在从集合中删除特定**的 , ：集合 中的每个文档都有一个`_id`自动生成的唯一属性。将文档的唯一`_id`性分配给 span 元素作为`<span id= "{{_id}}" class="deleteNote">Delete</span>`.

因此 cilck 事件将如下所示：

```
 Template.Notes.events = {
    "click .deleteNote" : function(e){
        var noteID = e.currentTarget.id;
        Notes.remove({_id:noteID});
        }
   }; 
```

模板将如下所示：

```
<template name="Notes">
    {{#each NoteArr}}
        <div class="Note">
            <h2>{{Title}}</h2>
            <p>{{Body}}</p>
            <span id= "{{_id}}" class="deleteNote">Delete</span>
        </div>
    {{/each}}
</template> 
```

未经测试的代码，但希望这将有助于解决您的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-26T17:58:07.217

笔记的 _id 也存储在“this”中。此外，remove 函数接受 '_id' 作为字符串。所以这也应该有效：

```
Template.Notes.events = {
  'click .deleteNote': function(){ return Notes.remove(this._id)}
} 
```

这里有一些好处。更少查询 DOM 以获取信息。少 jQuery。需要考虑的代码行数更少。更清洁的模板。

# objective-c - 如何在当前光标位置将文本插入 UITextField？

> ID：13502111
> 
> 赞同：2
> 
> 时间：2012-11-21T21:09:02.660
> 
> 标签：objective-c, ios, cocoa-touch

我正在尝试使用 UITextField 的“返回”键来插入自定义字符。这是我的 UITextFieldDelegate 方法的样子：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    [textField insertText:@"¶"];
    return NO;
} 
```

不幸的是，这只在某些时候有效：

*   “一二|” -->*移动光标*--> "one| two" --> *return* --> "one¶| two" ( **OK** )
*   “一个人|” -->*返回*--> "onetwo¶|" （**好的**）
*   “一个人|” -->*移动光标*--> "one|two" -->*返回*--> "onetwo¶|" （**失败**）

在最后一种情况下，我会期望“一个¶|两个”。

如何确保插入的文本始终插入光标位置？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:29:18.110

问题是当您点击键盘上的回车键时，文本字段会在向您发送消息**之前**将选定范围（光标位置）设置为其文本的末尾`textFieldShouldReturn:`。

您需要跟踪光标位置，以便将其恢复到之前的位置。假设您引用了属性中的文本字段：

```
@interface ViewController () <UITextFieldDelegate>

@property (strong, nonatomic) IBOutlet UITextField *textField;

@end 
```

您需要一个实例变量来保存先前选择的文本范围（从点击返回键之前）：

```
@implementation ViewController {
    UITextRange *priorSelectedTextRange_;
} 
```

然后您可以编写一个方法，将选定的文本范围保存到实例变量中：

```
- (void)saveTextFieldSelectedTextRange {
    priorSelectedTextRange_ = self.textField.selectedTextRange;
} 
```

在 中`textFieldShouldReturn:`，在插入 pilcrow 之前，您可以将选定的文本范围更改回其先前值：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    textField.selectedTextRange = priorSelectedTextRange_;
    [textField insertText:@"¶"];
    return NO;
} 
```

但是我们怎样才能让系统`saveTextFieldSelectedTextRange`在我们需要的时候发送消息呢？

*   该`UITextFieldDelegate`协议没有有关更改所选范围的消息。

*   `UITextField`不会发布任何有关所选范围更改的通知。

*   该`UITextInputDelegate`协议确实有`selectionWillChange:`和`selectionDidChange:`消息，但是当文本字段开始编辑时，系统会将文本字段设置`inputDelegate`为自己的`UIKeyboardImpl`对象，因此我们不能使用`inputDelegate`.

*   对文本字段属性的键值观察`selectedTextRange`是不可靠的。在我对 iOS 6.0 模拟器的测试中，当我通过点击文本字段将光标从文本的中间移动到末尾时，我没有收到 KVO 消息。

我能想到的*可靠*跟踪对文本字段选定范围的更改的唯一方法是在运行循环中添加一个观察者。每次通过事件循环时，观察者都会在事件处理之前运行，因此它可以在当前选定的范围发生变化之前获取它。

所以我们实际上需要另一个实例变量来保存对我们的运行循环观察者的引用：

```
@implementation ViewController {
    UITextRange *priorSelectedTextRange_;
    CFRunLoopObserverRef runLoopObserver_;
} 
```

我们在以下位置创建观察者`viewDidLoad`：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    [self createRunLoopObserver];
} 
```

`viewDidUnload`我们在和 中销毁它`dealloc`：

```
- (void)viewDidUnload {
    [super viewDidUnload];
    [self destroyRunLoopObserver];
}

- (void)dealloc {
    [self destroyRunLoopObserver];
} 
```

要创建观察者，我们需要一个普通的旧 C 函数来调用它。这是那个功能：

```
static void runLoopObserverCallback(CFRunLoopObserverRef observer, CFRunLoopActivity activity, void *info) {
    __unsafe_unretained ViewController *self = (__bridge ViewController *)info;
    [self saveTextFieldSelectedTextRange];
} 
```

现在我们可以实际创建观察者并将其注册到主运行循环中：

```
- (void)createRunLoopObserver {
    runLoopObserver_ = CFRunLoopObserverCreate(NULL, kCFRunLoopAfterWaiting, YES, 0, &runLoopObserverCallback, &(CFRunLoopObserverContext){
        .version = 0,
        .info = (__bridge void *)self,
        .retain = CFRetain,
        .release = CFRelease,
        .copyDescription = CFCopyDescription
    });
    CFRunLoopAddObserver(CFRunLoopGetMain(), runLoopObserver_, kCFRunLoopCommonModes);
} 
```

下面是我们实际注销观察者并销毁它的方式：

```
- (void)destroyRunLoopObserver {
    if (runLoopObserver_) {
        CFRunLoopRemoveObserver(CFRunLoopGetMain(), runLoopObserver_, kCFRunLoopCommonModes);
        CFRelease(runLoopObserver_);
        runLoopObserver_ = NULL;
    }
} 
```

这种方法适用于我在 iOS 6.0 模拟器上的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:22:57.917

这里发生的是您没有跟踪插入点，也称为选择范围。

为此，您需要更深入地了解 UITextField 可以做什么。

[使用 UITextInput（可作为 UITextField 使用的协议访问）](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITextInput_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITextInput)，您可以获取[" `selectedTextRange`" 属性](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITextInput_Protocol/Reference/Reference.html#//apple_ref/occ/intfp/UITextInput/selectedTextRange)，该属性告诉您插入符号（光标、插入点）在哪里以及您应该插入特殊字符的位置。如果您将对象设置为符合“ ”协议的委托，这*应该可以工作。*`UITextInput`

# c++ - 使用 Makefile 构建时，索引和语法高亮在 Xcode 中不起作用

> ID：13502115
> 
> 赞同：4
> 
> 时间：2012-11-21T21:09:19.000
> 
> 标签：c++, xcode, makefile, clang, lldb

我将 Xcode 用于使用 Makefile 构建的 C++ 项目。问题是，Xcode 似乎没有即时（或根本）索引源。我没有语法突出显示，没有实时编译错误警告，也无法“跳转到定义”，因为我收到“未找到符号”错误。

使用 Makefile 时是否可以让 Xcode 完成所有这些事情，或者我是否必须添加一个额外的 C++ 目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-10T19:33:57.377

要让 Xcode 索引您的项目，您必须添加另一个目标，为目标类型选择“命令行工具”。然后在构建阶段将所有`.c`和`.cpp`（以及您想要索引的任何其他源文件）添加到编译资源。片刻之后，您应该会获得语法高亮显示（可能需要更长时间，具体取决于项目的大小。

[![在此处输入图像描述](../Images/03dc7984e733a9db744263d2ac9451c8.png)](https://i.stack.imgur.com/11pTv.png)

根据您的项目设置，应该会出现编译器警告/错误。如果不是，您必须重新访问您的架构和目标设置。我很快就会在我的 github 上发布 ac 项目，它会完成所有这些工作。

**更新 1**

Xcode 中的示例 C 项目[https://github.com/CaziSoft/BLE-Keyboard](https://github.com/CaziSoft/BLE-Keyboard)

**更新 2** 据我了解，您无法调试任何 C/C++ 应用程序，除非您可以使用`LLDB`. `GDB`不再支持。

# javascript - Javascript转义字符ahref html

> ID：13502121
> 
> 赞同：0
> 
> 时间：2012-11-21T21:09:51.493
> 
> 标签：javascript, html

在href，img属性等中包含变量时如何转义字符。这似乎不起作用：

```
var myData = JSON.parse(jsonString2);
var $grouplist = $('#groups');
$.each(myData, function() {
 $('<li><a href="'+ this.url + '"/><img src="'+ this.src + '" class="image0"/></a></li>').appendTo($grouplist);
 });
} 
```

上面的整个函数。

```
$('<li><a href=\"' + this.url + '\"</a></li>').appendTo($grouplist); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:12:52.750

你不需要。创建元素并设置属性，那么您不必担心转义任何内容，引号和属性值都不会：

```
$('<li>').append($('<a>', { href: this.url })).appendTo($grouplist); 
```

### 编辑：

带有图像元素的代码也：

```
$('<li>').append(
  $('<a>', { href: this.url }).append(
    $('<img>', { src: this.src, 'class': 'image0' })
  )
).appendTo($grouplist); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:12:25.267

只有当你有相同的引号时，你才需要转义。在您的情况下，这将起作用：

```
$('<li><a href="' + this.url + '"</a></li>').appendTo($grouplist); 
```

因为双引号不会干扰单引号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:16:30.533

您不需要转义双引号，因为它们在单引号内。此外，您还没有完成打开标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T21:16:35.167

查看[window.escape](https://developer.mozilla.org/en-US/docs/DOM/window.escape)。还有encodeURIComponent，如果是用户输入，一般首选。

正如其他人指出的那样，您不需要在那里转义双引号。所以试试这个：

```
$('<li><a href="' + encodeURIComponent(this.url) + '"></a></li>').appendTo($grouplist); 
```

或者 Guffa 的方法：

```
$('<li>').append($('<a>', { href: encodeURIComponent(this.url) })).appendTo($grouplist); 
```

# php - Joomla mysql tables.php 语法

> ID：13502126
> 
> 赞同：0
> 
> 时间：2012-11-21T21:10:03.597
> 
> 标签：php, mysql, joomla

构建一个组件，1.5 版（我知道很快就会被删除，但这是我需要使用的。）

/admin/tables/mycom.php 文件有问题。（其中 mycom 是任何组件名称）

我没有关注这个文件的使用。通过阅读演练，它正在创建一个扩展 JTables 的表类。

现在，我正在使用的一些数据库列名称中包含“空格”字符。即，“field 1”而不是“field1”（不要问我，这不是我的数据。）

识别这些字段的语法是：

```
 $myfield = null 
```

它说这些引用了您在 mySQL 表中的字段，但我的字段名称包含无法使用此语法的空格。

任何帮助理解这个类，它是 php 文件，它的用途将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:00:08.837

通过为您的表格创建一个 JTable 类，用于编辑表格的大部分代码都已为您完成。我建议您熟悉 Joomla 库中的 JTable，以便了解为您预先编写的可以使用和覆盖的函数。

至于你的数据库列名有空格的问题......老实说，这只是一个坏主意。这里有一些 MySQL 命名约定的最佳实践给你....

*   始终使用带下划线的小写字母而不是 CamelCase。适用于表名和列名。（first_name 代替 FirstName，address_1 代替 Address1
*   每个表都应该有一个“id”列作为主键，不要称它为 UserID 或其他任何东西
*   表名应该是复数（profiles、supports等）
*   外键应具有相关表的单数名称，后跟下划线 id。例如：“profile_id”或“support_id”。

如果可以，我建议您对 MySQL 进行一些 ALTER TABLE 更新，例如

```
ALTER TABLE `#__example` CHANGE `Field 1` `field_1` VARCHAR(50) NOT NULL DEFAULT 'empty'; 
```

# c++ - 为什么 std::binary_search 的参数是前向迭代器？

> ID：13502128
> 
> 赞同：21
> 
> 时间：2012-11-21T21:10:15.547
> 
> 标签：c++

在阅读[http://en.cppreference.com/w/cpp/algorithm/binary_search](http://en.cppreference.com/w/cpp/algorithm/binary_search)时，我注意到它将转发迭代器作为参数。现在我很困惑，因为我认为它宁愿是一个随机访问迭代器，所以二进制搜索实际上是二进制的。

为了满足我的好奇心，我写了一个小程序：

```
#include <iostream>
#include <vector>
#include <forward_list>
#include <list>
#include <deque>
#include <algorithm>
#include <chrono>
#include <random>

int main()
{
    std::uniform_int_distribution<int> uintdistr(-4000000, 4000000);
    std::mt19937 twister(std::chrono::high_resolution_clock::to_time_t(std::chrono::high_resolution_clock::now()));
    size_t arr[] = { 200000, 400000, 800000, 1600000, 3200000, 6400000, 12800000 };
    for(auto size : arr)
    {
        std::list<int> my_list;
        for(size_t i = 0; i < size; i++)
            my_list.push_front(uintdistr(twister));
        std::chrono::time_point<std::chrono::high_resolution_clock> start, end;
        my_list.sort(); //fixed
        start = std::chrono::high_resolution_clock::now();

        std::binary_search(my_list.begin(), my_list.end(), 1252525);

        end = std::chrono::high_resolution_clock::now();
        long long unsigned elapsed_time = std::chrono::duration_cast<std::chrono::microseconds>(end-start).count();
        std::cout << "Test finished in " << elapsed_time << "\n";
    }
} 
```

使用 gcc 4.7.0 编译并运行

```
g++ -std=c++11 test.cpp 
```

在我的机器上提供以下结果：

```
Test finished in 0
Test finished in 15625
Test finished in 15625
Test finished in 46875
Test finished in 93750
Test finished in 171875
Test finished in 312500 
```

所以看起来它实际上并没有在前向列表上进行二进制搜索。现在我的问题是：

为什么会有这样一个令人困惑的名字？

为什么允许这样的代码？

为什么参考文献说它是“第一个和最后一个之间距离的对数”？

标准对此有何规定？

编辑：现在代码在搜索之前对列表进行排序 - 愚蠢的错误，现在结果是：

```
Test finished in 46875
Test finished in 109375
Test finished in 265625
Test finished in 546875
Test finished in 1156250
Test finished in 2625000
Test finished in 6375000 
```

当然仍然不是对数的；）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-21T21:14:34.203

源自该标准的原始 SGI STL 实现的文档[指出](http://www.sgi.com/tech/stl/binary_search.html)

> 比较次数是对数的：最多 log(last - first) + 2。如果`ForwardIterator`是随机访问迭代器，则通过范围的步数也是对数；否则，步数与 last - first 成正比。

也就是说，*比较*的次数总是对数的，而由于缺乏随机可访问性而影响的进步次数可以是线性的。在实践中，[`stl::advance`](http://en.cppreference.com/w/cpp/iterator/advance)可能使用 ，如果迭代器是随机访问，则复杂度是恒定的，否则是线性的。

如果比较非常昂贵，则具有线性数量的迭代器改进但具有对数比较数的二进制搜索是有意义的。例如，如果您有一个复杂对象的排序链表，需要磁盘或网络访问才能进行比较，那么使用二分搜索可能比使用线性搜索要好得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-21T21:18:37.100

与[网站可能说](http://en.cppreference.com/w/cpp/algorithm/lower_bound)的相反（例如“对数`distance(first, last)`”），该标准实际上只谈到了*比较*（例如 25.4.3.1, `lower_bound`）：

> 复杂性：最多`log2(last − first) + O(1)`比较

迭代器的递增*不*包括在复杂度中！请注意，尽管标准库要求所有迭代器增量都具有摊销常数复杂性，因此增加迭代器会产生 O(N) 的订单成本（但大概这有一个非常小的主要因素）。特别是（25.4.3）：

> 对于非随机访问迭代器 [算法] 执行线性数量的步骤。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T21:18:08.173

该标准指定排序搜索算法（`std::lower_bound()`、`std::upper_bound()`和`std::binary_search()`）以线性时间为正向和二进制迭代器工作。对于随机访问，时间是对数的。

但是请注意，数量`comparisons`限制为对数。

# batch-file - DOS-在xcopy期间保留部分目录结构？

> ID：13502133
> 
> 赞同：2
> 
> 时间：2012-11-21T21:10:46.720
> 
> 标签：batch-file, structure, dos, xcopy

我对 DOS 批处理文件有点陌生，我很难思考解决问题的方法。

我需要做的：我有一个大型的嵌套源文件夹结构，假设它位于此处：

```
C:\dir1\dir2\dir3\file.txt 
```

而且我有一个镜像的目标结构，尽管根的一部分不同：

```
x:\dirA\dirB\dir1\dir2\dir3\file.txt 
```

我当前的批处理将源结构中的所有文件复制到目标文件夹，保持文件夹结构，这是我想要的。

问题：
我的脚本的目的是将一个文件夹从上面的源结构拖到 bat 文件上，并让它将文件复制到目标。我想要做的是允许用户从源目录中拖动一个文件夹，假设`/dir2`它的所有子文件夹/文件到批处理文件中，并将内容复制到目标结构中的相同位置.. .

所以在这个例子中，批处理文件应该复制下面的所有内容：

```
C:\dir1\dir2\ 
```

进入

```
x:\dirA\dirB\dir1\dir2\. 
```

幸运的是（我认为）我的目标文件夹结构不会改变，尽管源可能位于每台机器上的不同位置。所以，如果有一个聪明的方法来检测我在源树中的位置，然后替换目标路径的一部分...... ???

到目前为止，这是我的简单脚本：

```
 @echo off
    set /p FILETYPE="What file type do you want to copy? (For example use txt, max, f3d, or * to copy all files.)"

    xcopy %1\*.%FILETYPE% c:\output /s 
    pause 
```

非常感谢你们可以提供的任何帮助！:) 肯

**更新：**在这里添加更新的代码示例，因为我无法让我的评论格式化或允许我足够的字符。下面的东西可能并不完全正确，我只是尽力说清楚。自从我发布这篇文章以来，我已经想出了更多，基本上我需要弄清楚如何（或者如果可能的话）在 delims 之后使用字符串，它似乎只检查每个字符......

```
 @echo off
    rem user drag folder onto .bat (left click, move folder using mouse onto .bat icon)
    rem %1 in ex is C:\random_folder\another_folder\proj1\area1\scene23
    set destRoot=X:\companyname\allprojects\proj1
    set rootDir=proj1
    rem assume %1 is folder dragged onto .bat file 
    for /f "tokens=2* delims=<foldername???>" %%a in ("%1") do (
        set part1=%%a
        set chunk=%%b
    ) 
    set finalDest=destRoot+chunk
    xcopy %1\* %finalDest% /E /EXCLUDE:exclusions.txt
    pause 
```

我希望创建这个：“X:\companyname\allprojects\proj1\area1\scene23”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:38:26.143

目标文件夹的`x:\dirA\dirB\`部分是否已知？如果是这样，解决方案很简单：

```
@echo off
rem Get current directory, ie: "C:\dir1\dir2"
set curDir=%cd%
rem Eliminate the disk drive, ie: "\dir1\dir2"
set curDir=%curDir:~2%
rem Copy to right destination, ie: "x:\dirA\dirB\dir1\dir2"
xcopy *.%FILETYPE% "x:\dirA\dirB%curDir%" 
```

我希望它有帮助...

**编辑：** *澄清要求的新评论*

行。有一个*源文件夹*和一个*目标文件夹*。上面的程序假定程序的当前文件夹是源文件夹，但如果需要，这可以作为参数提供。该程序实现以下复制过程：

```
From source folder          -> To destination folder
C:\dir1\dir2                -> x:\dirA\dirB\dir1\dir2
C:\dir1\dir2\dir3           -> x:\dirA\dirB\dir1\dir2\dir3
C:\dir1\dir2\dir3\what\ever -> x:\dirA\dirB\dir1\dir2\dir3\what\ever
C:\XYZ                      -> x:\dirA\dirB\XYZ 
```

如果这不是您想要的，请尽可能简洁地解释它（使用“文件”、“文件夹”、“名称的一部分”术语，而不是“我喜欢”、“如果”等），并包括三个或四个例子。

另外，请注意，对我来说，*拖动文件夹*意味着拖放操作将源文件夹按下鼠标右键并将其留在批处理文件的图标上。如果您不是指此操作，请不要使用“拖动”一词；改用“复制”（请同时澄清这一点）。

**编辑：** *新要求的解决方案*

好的！在上一个示例之前您没有正确解释！这个问题只是匹配两个名字：名字的最后一部分必须匹配第二个名字中的*相同部分*，并将名字和第二个名字的其余部分结合起来。对？：

```
First name:       X:\companyname\allprojects\proj1
Second name: C:\random_folder\another_folder\proj1\area1\scene23
Result:           X:\companyname\allprojects\proj1\area1\scene23 
```

这是解决方案：

```
@echo off
setlocal EnableDelayedExpansion
rem user drag folder onto .bat (left click, move folder using mouse onto .bat icon)
rem %1 in ex is C:\random_folder\another_folder\proj1\area1\scene23
set sourceFolder=%~1
set destRoot=X:\companyname\allprojects\proj1
rem Get last part of First name (destRoot) ie: lastPart=proj1
for %%a in (%destRoot%) do set lastPart=%%~Na
rem Delete from beginning of second name until that part, ie: result=\area1\scene23
set result=!sourceFolder:*%lastPart%=!
rem And insert the First name before the rest
set result=%destRoot%%result% 
```

或者，将三个步骤组合在一行中：

```
@echo off
rem user drag folder onto .bat (left click, move folder using mouse onto .bat icon)
rem %1 in ex is C:\random_folder\another_folder\proj1\area1\scene23
set sourceFolder=%~1
set destRoot=X:\companyname\allprojects\proj1
for %%a in (%destRoot%) do set result=%destRoot%%sourceFolder:*%%~Na=% 
```

请注意，如果 destRoot 可能包含空格，则必须在 FOR 命令中将其括在引号中：`for %%a in ("%destRoot%") do ...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T00:28:51.047

在另一个论坛上得到这个，似乎包含我正在寻找的答案，在这里分享给其他人：

```
@echo off

REM YOU NEED THIS

setlocal enabledelayedexpansion

REM If the passed parameter string has any spaces you must quote it

REM we unquote it using ~

set PassedString=%~1

REM May as well do the same with string to split on
set DelimString=%~2

REM The delim string must appear exactly ONCE in the passed string

REM Replace the delim string with a symbol which will not be in the
REM path to be split, in this example I use @
set splitsub=@
call set tempstring=!PassedString:%DelimString%=%splitsub%!

REM Use FOR to split the modified string
for /f "tokens=1* delims=%splitsub%" %%A in ("%tempstring%") do set part1=%%A & set part2=%%B

REM Show that the 2 variables contain the desired substrings
echo Passed = %PassedString%
echo Part1  = %part1%
echo Part2  = %part2% 
```

示例输出：

```
C:\>splitstring.bat "D:\Backup\mystuff\programming\Visual Basic\project\ABCDE\DEF" "project"
Passed = D:\Backup\mystuff\programming\Visual Basic\project\ABCDE\DEF
Part1  = D:\Backup\mystuff\programming\Visual Basic\
Part2  = \ABCDE\DEF

C:\>splitstring.bat "D:\Backup\mystuff\programming\Visual Basic\project\ABCDE\DEF" "mystuff"
Passed = D:\Backup\mystuff\programming\Visual Basic\project\ABCDE\DEF
Part1  = D:\Backup\
Part2  = \programming\Visual Basic\project\ABCDE\DEF 
```

# sql - 在 SELECT 上应用按位与逻辑的最佳实践

> ID：13502137
> 
> 赞同：0
> 
> 时间：2012-11-21T21:11:09.450
> 
> 标签：sql, sql-server-2008

我正在尝试找到应用以下逻辑的最佳方法。我们的业务逻辑要求我将一堆行插入到 var 表中，然后选择所有不同的记录，但只有当它匹配具有相同 id 的所有记录时才将条件设置为肯定 [所以基本上按位与]

希望我的例子能更好地解释这一点。

```
DECLARE @sometable TABLE (
record_id INT NOT NULL,
some_condition BIT NOT NULL) 
```

该表中的记录将匹配

```
record_id some_condition
1         1
1         0
2         0
3         0 
```

在上述情况下，所需的输出应该是

```
record_id some_condition
1         0
2         0
3         0 
```

直到现在我一直这样做是这样的

```
SELECT DISTINCT record_id  CAST(MIN(CAST(some_condition INT)) AS some_condition
FROM @sometable
GROUP BY record_id 
```

有一个更好的方法吗？我不得不 CAST var 因为 MIN 只接受数字类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:19:41.650

使用case语句怎么样？

```
select record_id,
min(case when some_condition=0 then 0 else 1 end) as minCond
from sometable
group by 
record_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:20:27.397

首先，您可以省略`DISTINCT`，因为`GROUP BY`已经使它们与众不同。`CAST`此外，如果只添加 0 ，则可以避免最内层：

```
SELECT record_id,  CAST(MIN(some_condition+0) as BIT) AS some_condition
FROM @sometable
GROUP BY record_id 
```

最后，你真的需要在完成后重新转换为 BIT 吗？根据查询结果的使用方式，可能不需要。

# javascript - 如何使用 js/jQuery 操作 CSS3 3D 变换？

> ID：13502142
> 
> 赞同：0
> 
> 时间：2012-11-21T21:12:17.933
> 
> 标签：javascript, jquery, css, css-transforms

我想创建一个在 3D 透视图中旋转 DIV 的简单脚本，所以我想逐渐操纵 div 的*变换*属性。它最初设置为`perspective(500px) rotateY(44deg)`，但是当我尝试使用 jQuery 的 .css() 获取属性值时，它只返回`matrix3d`属性，让我无法直接访问*rotateY()*。如何使用 js/jQuery轻松访问和调整 transform 的属性，例如*rotateY() ？*

# javascript - Web Audio API 卷积函数支持哪些文件格式？

> ID：13502143
> 
> 赞同：4
> 
> 时间：2012-11-21T21:12:19.433
> 
> 标签：javascript, html, audio, web-audio-api

我已经使用 Web Audio API (javascript) 在我的站点中构建了简单的卷积功能，当源文件和脉冲响应都是 .wav 文件时，它可以工作，但是当我使用其他格式时音频无法输出并且不返回错误.

我查看了 Web Audio API Spec，但看不到文件格式细节的提及。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-09T18:50:58.910

创建缓冲区文件可以是音频元素支持的任何格式：mp3、wav、ogg。

我使用 wav 文件格式来制作卷积效果。卷积效应很小，所以这在 wav 中对我有用。

我的大部分曲目都是mp3。注意采样率。:-)

# jquery - 使用 Picasa API

> ID：13502148
> 
> 赞同：0
> 
> 时间：2012-11-21T21:12:40.010
> 
> 标签：jquery, api, picasa

我在使用来自 Google Picasa 服务的 API 时遇到了困难。

假设我不想通过 jquery 显示这些值：

```
<entry>
<id>
    https://picasaweb.google.com/data/entry/api/user/userID/albumid/albumID/photoid/5813338978197482482
</id>
<exif:tags>
    <exif:time>1203311251000</exif:time>
    <exif:imageUniqueID>uniqueID</exif:imageUniqueID>
</exif:tags>
<media:group>
    <media:content url="https://lh6.googleusercontent.com/Penguins.jpg" height="384" width="512" type="image/jpeg" medium="image"/>
    <media:credit>user</media:credit>
    <media:description type="plain"/>
    <media:keywords/>
    <media:thumbnail url="https://lh6.googleusercontent.com/s72/Penguins.jpg" height="54" width="72"/>
    <media:thumbnail url="https://lh6.googleusercontent.com/s144/Penguins.jpg" height="108" width="144"/>
    <media:thumbnail url="https://lh6.googleusercontent.com/s288/Penguins.jpg" height="216" width="288"/>
    <media:title type="plain">Penguins.jpg</media:title>
</media:group>
</entry> 
```

从条目树中读取值时没有问题，但麻烦从 exif:tags 或 media:group 开始。这是读取xml的函数

```
$(xml).find('entry').each(function()
    {
        var item = ""
        item += "<li style='float:left;'>";
        item += $(this).find('title').text()    
        item += "</li>";
        $(".albums").append(item);
    }); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:16:39.380

水晶球时间！我*猜*你正在尝试做这样的事情：

```
var $xml = $(/* get xml string from somewhere */);
var $entryId = $xml.find('entry > id'); // works
var $entryExifTags = $xml.find('entry > exif:tags'); // doesn't work 
```

这是因为[某些字符，包括`:`，在 jQuery 选择器中具有特殊含义。因此，您需要逃避它们](http://docs.jquery.com/Frequently_Asked_Questions#How_do_I_select_an_element_by_an_ID_that_has_characters_used_in_CSS_notation.3F)：

```
var $entryExifTags = $xml.find('entry > exif\\:tags'); 
```

# statsd - StatsD 如何存储其数据？

> ID：13502149
> 
> 赞同：10
> 
> 时间：2012-11-21T21:12:43.117
> 
> 标签：statsd

我一直在阅读[https://github.com/etsy/statsd](https://github.com/etsy/statsd)上的自述文件，但我不知道 StatsD 如何存储它获取的数据？

它是否进行任何永久存储，或者它是一回事？我试图弄清楚它使用什么数据库（如果有的话），或者它是否只是使用基于文件的存储。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-22T22:30:56.113

Etsy 的 statsD 版本本身并不存储数据，而是依靠“后端”来处理它聚合的数据（例如打印出来，将它们发送到另一个 statsD 服务器或将它们发送到石墨），如[https://github所示.com/etsy/statsd/tree/master/backends](https://github.com/etsy/statsd/tree/master/backends)。

如果您想要永久存储，则需要建立一个[石墨服务器](http://graphite.wikidot.com/)，使用[托管](http://www.hostedgraphite.com/)服务器或使用本机支持 statsD 的服务（例如[Datadog](http://www.datadoghq.com)）。

披露：我为[Datadog](http://www.datadoghq.com)工作。

# c++ - 渲染网格时 C++ 中的内存泄漏

> ID：13502153
> 
> 赞同：0
> 
> 时间：2012-11-21T21:12:48.713
> 
> 标签：c++, memory-leaks, directx-9

我正计划在 C++ 和 DirectX 9 中制作游戏引擎。所以我只是在 Direct3D 中测试功能。我的问题是，当我使用 Direct3DX 函数（文本、纹理、网格）渲染对象时，应用程序的内存使用量不断上升，而我的 PC 性能下降。当我只有一个没有任何渲染的清除场景时，内存使用量保持在 4mb 左右，但是当我添加文本或网格时（即使使用预定义的网格绘制函数，即 D3DXCreateBox、D3DXCreateTeapot），就会出现上述问题。任何人都可以帮我解决它吗？注意：当我不在循环中渲染时，内存使用量保持在 9mb，但当然，一切都保持静态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:20:32.880

使用完 D3D 接口指针后，您是否在调用 IUnknown::Release？使用诸如 ATL 的[CComPtr](http://msdn.microsoft.com/en-us/library/ezzw7k98%28v=vs.80%29.aspx)之类的智能指针类有助于避免这些问题。

# .net - 将客户端证书分配给用户

> ID：13502155
> 
> 赞同：2
> 
> 时间：2012-11-21T21:12:56.560
> 
> 标签：.net, ssl, client, certificate

除了用户凭据之外，我们正在尝试使用安装在其计算机上的客户端证书对来自特定组的用户进行身份验证。我按照本文中的步骤进行操作 - [http://ondrej.wordpress.com/2010/01/24/iis-7-and-client-certificates/](http://ondrej.wordpress.com/2010/01/24/iis-7-and-client-certificates/)。

即使用于生成客户端证书的 CA 位于客户端和服务器上的受信任根证书存储中，我仍然看不到服务器请求的客户端证书或传递给服务器的客户端证书。服务器上的 IIS 配置为接受客户端证书，因为并非所有用户都安装了证书。

我是否需要在服务器端的 .NET 代码中执行任何特定操作才能显式请求客户端证书？

# android - “无法从共享对象映射段：不允许操作”的可能原因是什么，以及如何调试？

> ID：13502156
> 
> 赞同：23
> 
> 时间：2012-11-21T21:12:58.790
> 
> 标签：android, linker, executable, linker-errors, dynamic-linking

我有两个可执行文件，都交叉编译以在 Android 中运行。我已将两者放在同一目录中的设备上。我把它们所依赖的所有共享库都放在了同一个目录下，包括ld-linux.so.3。我使用以下命令运行可执行文件：

ld-linux.so.3 --library-path /path/to/libraries executable_name

以任何用户身份运行时，两者都适用于旧版本的 Android。如果以 root 身份运行，两者都可以在最新版本的 Android 上运行。以任何用户身份运行时，只有一个适用于最新版本的 android。相反，它给出：

无法从共享对象映射段：不允许执行可执行名称操作

如何找出无法运行的可执行文件有什么不同？

我在网上阅读了很多，大多数人都收到了这个错误，要么：

A) 对它们所依赖的库之一或可执行文件本身没有执行权限。

或者

B) 正在尝试从挂载为 NOEXEC 的目录运行。

这两种情况似乎都不是。它可以找到所有库，我可以自己加载任何库，并查看它依赖于解决的其他内容。此外，我可以从感兴趣的目录运行基本脚本。

较新的 Android 版本 Jelly Bean 是一个不同的 linux 内核版本，我想知道这是否相关。

送什么？我该如何调试？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2019-04-15T16:23:47.687

权限问题。需要重新挂载/tmp。以下命令适用于我（Centos 7）：

> sudo mount /tmp -o remount,exec

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2017-06-04T07:53:56.973

我在不同的上下文中遇到了这个错误。由于某种原因，它在尝试使用*/tmp*文件夹时会导致错误。

为了解决这个问题，我简单地：

```
mkdir tmp
export TMPDIR=`pwd`/tmp 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-21T18:44:46.947

问题在于如何编译可执行文件。它们需要使用正确支持较新的 arm 设备的交叉编译器进行编译。我使用的编译器生成的可执行文件只能在 arm 设备的子集上运行。问题不在于不同版本的android。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-20T07:43:39.263

SELinux 在 Android 4.3 上默认启用，但它应该是“允许的”[0]。也许您的电话供应商添加了更多限制性规则。

[0] [https://source.android.com/devices/tech/security/se-linux.html](https://source.android.com/devices/tech/security/se-linux.html)

# c# - Azure SDK for TableStorage with .NET 4.5

> ID：13502157
> 
> 赞同：0
> 
> 时间：2012-11-21T21:13:02.273
> 
> 标签：c#, azure, azure-storage, azure-table-storage

我正在寻找一些关于如何使用 Azure SDK 在 Azure 表存储中存储和检索数据的示例或文档。

我将 C# 与 .NET 4.5 框架一起使用。

我在这里找到了[https://www.windowsazure.com/en-us/develop/net/how-to-guides/table-services/](https://www.windowsazure.com/en-us/develop/net/how-to-guides/table-services/)文档。

那个部分：

```
// Create the CloudTable object that represents the "people" table.
CloudTable table = tableClient.GetTableReference("people");

// Create a new customer entity.
CustomerEntity customer1 = new CustomerEntity("Harp", "Walter");
customer1.Email = "Walter@contoso.com";
customer1.PhoneNumber = "425-555-0101";

// Create the TableOperation that inserts the customer entity.
TableOperation insertOperation = TableOperation.Insert(customer1);

// Execute the insert operation.
table.Execute(insertOperation); 
```

不再可用。

有人知道如何使用 .NET 4.5 做到这一点吗？

最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:38:07.650

这段代码工作正常。虽然文档提到了 2.0 版，但这指向的是存储 SDK 的版本，而不是 .NET 的版本。

**编辑：**

为了获得 GetTableReference 方法，您需要执行以下操作：

*   参考 Microsoft.WindowsAzure.Storage.dll 版本 2.0.0.0 或更高版本（通过 NuGet `Install-Package WindowsAzure.Storage`：）
*   添加以下命名空间：

* * *

```
using Microsoft.WindowsAzure.Storage;
using Microsoft.WindowsAzure.Storage.Auth;
using Microsoft.WindowsAzure.Storage.Table; 
```

*   初始化存储帐户和表客户端。

* * *

```
var account = new CloudStorageAccount(...);
var tableClient = account.CreateCloudTableClient(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-03T06:26:05.620

这是我的表存储管理器类，我使用的是 .NET 4.5

```
public class TableStorageManager
{
    private CloudTableClient TableClient;
    private CloudTable Table;

    #region Sigleton implementation

    public TableStorageManager(string tablename)
    {
        TableClient = StorageFactory.GetCloudStorageAccount().CreateCloudTableClient();
        Table = TableClient.GetTableReference(tablename);
        //var ctx = TableClient.GetTableServiceContext();

        Table.CreateIfNotExists();
    }

    #endregion

    public void InsertAnyEntity<T>(T entity)
    {
        var translatedEntity = Helper.ConvertToDictionaryEntity<T>(entity);
        InsertEntity<DictionaryEntity>(translatedEntity);
    }
    public void InsertEntity<T>(T entity) where T : ITableEntity
    {
        Table.Execute(TableOperation.InsertOrReplace(entity));
    }

    public IEnumerable<T> ExecuteQuery<T>(TableQuery<T> query) where T : class, ITableEntity, new()
    {
        return Table.ExecuteQuery(query);
    }

    public IEnumerable<T> GetEntities<T>(String partitionKey, Int32 noOfRecords ) where T : ITableEntity, new()
    {
        var query = new TableQuery<T>().Where(TableQuery.GenerateFilterCondition("PartitionKey", QueryComparisons.Equal, partitionKey));
        var result = Table.ExecuteQuery(query).Take(noOfRecords).ToList();
        return result;
    }

    public T GetEntity<T>(String partitionKey, String rowKey) where T : class, ITableEntity, new()
    {
        var retrieveOperation = TableOperation.Retrieve<T>(partitionKey, rowKey);

        // Execute the retrieve operation.
        var retrievedResult = Table.Execute(retrieveOperation);
        return retrievedResult.Result as T;
    }

    public Boolean DeleleEntity<T>(String partitionKey, String rowKey) where T : class, ITableEntity, new()
    {
        TableOperation retrieveOperation = TableOperation.Retrieve<T>(partitionKey, rowKey);

        // Execute the operation.
        var retrievedResult = Table.Execute(retrieveOperation);

        // Assign the result to a CustomerEntity.
        var deleteEntity = (T)retrievedResult.Result;

        // Create the Delete TableOperation.
        if (deleteEntity != null)
        {
            TableOperation deleteOperation = TableOperation.Delete(deleteEntity);

            // Execute the operation.
            Table.Execute(deleteOperation);
        }

        return true;
    }

    public Boolean UpdateEntity<T>(String partitionKey, String rowKey) where T : class, ITableEntity, new()
    {
        TableOperation retrieveOperation = TableOperation.Retrieve<T>(partitionKey, rowKey);

        // Execute the operation.
        TableResult retrievedResult = Table.Execute(retrieveOperation);

        // Assign the result to a CustomerEntity object.
        var updateEntity = (T)retrievedResult.Result;

        if (updateEntity != null)
        {
            // Create the InsertOrReplace TableOperation
            TableOperation updateOperation = TableOperation.Replace(updateEntity);

            // Execute the operation.
            Table.Execute(updateOperation);
        }

        return true;
    }

    public Boolean UpdateEntity<T>(T entity) where T : class, ITableEntity, new()
    {
        Boolean isUpdate = false;
        try
        {
            // Create the InsertOrReplace TableOperation
            TableOperation updateOperation = TableOperation.Replace(entity);

            // Execute the operation.
            Table.Execute(updateOperation);
            isUpdate = true;
        }
        catch (Exception ex)
        {
            isUpdate = false;
        }

        return isUpdate;
    }
} 
```

# ruby-on-rails-3.2 - ActiveAdmin 和“未初始化的常量 InheritedResources::Base”

> ID：13502158
> 
> 赞同：4
> 
> 时间：2012-11-21T21:13:08.920
> 
> 标签：ruby-on-rails-3.2, activeadmin, inherited-resources

我只是在尝试 ActiveAdmin。我已经让仪表板和一些资源正常工作，但是现在当我运行例如 rails 生成器时，我得到了：

```
% rails generate scaffold Post name:string
.../.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/ext/module.rb:36:in `const_missing': uninitialized constant InheritedResources::Base (NameError)
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/base_controller/menu.rb:2:in `<module:ActiveAdmin>'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/base_controller/menu.rb:1:in `<top (required)>'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/base_controller.rb:2:in `<top (required)>'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/resource_controller/actions.rb:2:in `<module:ActiveAdmin>'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/resource_controller/actions.rb:1:in `<top (required)>'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/resource_controller.rb:2:in `<top (required)>'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/batch_actions.rb:7:in `block in <top (required)>'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/event.rb:25:in `call'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/event.rb:25:in `block in dispatch'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/event.rb:24:in `each'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/event.rb:24:in `dispatch'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/application.rb:179:in `load!'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin/application.rb:205:in `routes'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/activeadmin-0.5.0/lib/active_admin.rb:79:in `routes'
    from .../lap-app/config/routes/routes.rb:27:in `block in <top (required)>'
    from .../.rvm/gems/ruby-1.9.3-p194@lap/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:282:in `instance_exec'
    ... 
```

并且`routes.rb:27`是：

```
ActiveAdmin.routes(self) 
```

我没有发现任何对我有用的东西:((

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:39:14.210

尝试将 移动`ActiveAdmin.routes(self)`到顶部而不是文件的中间或末尾`routes.rb`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T22:38:59.987

您是否不小心注册了不是模型的东西（使用 rails g active_admin:resource NAME）？ActiveAdmin.routes(self) 为您的注册资源自动生成 CRUD 路由，因此这些注册资源中的一个可能实际上不是一个。

如果您想为不是模型的东西注册一个页面并且您已经注册了它，请将 .rb 中的 ActiveAdmin.register NAME 替换为 ActiveAdmin.register_page "NAME"

# asp.net-mvc - VS2010调试器在调试ASP MVC项目时不会打开浏览器

> ID：13502159
> 
> 赞同：1
> 
> 时间：2012-11-21T21:13:09.607
> 
> 标签：asp.net-mvc, visual-studio-2010, debugging

我正在尝试在 Visual Studio 2010 中调试 ASP MVC 3 项目。但是，一旦代码编译，调试器就会完全停止，永远不会启动浏览器。我可以从这台计算机上很好地运行 ASP.Net 项目，但是这个项目似乎不想工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:20:55.063

事实证明，这是没有选择启动项目的结果。只需转到解决方案 > 属性 > 然后选择一个启动项目即可解决问题。

# javascript - 使 JS 代码不可读/难以“破解”

> ID：13502166
> 
> 赞同：3
> 
> 时间：2012-11-21T21:13:34.907
> 
> 标签：javascript, obfuscation

我想写一个小游戏，用户必须在给定时间内点击出现的元素/对象。详细地，物体出现在地面上的洞中，并在 x 秒后消失。游戏玩家有 y 条生命，所有点击都会被计算在内，直到他输掉游戏。之后，他的高分被发布到数据库（通过表单发布或 AJAX）。长话短说，我怎样才能避免用户在发送前伪造他的高分？程序语言为JS。

我知道不可能隐藏所有代码并使其无法破解。但我认为，如果代码太难以至于用户必须做很多工作来了解他必须在哪里进行干预才能发送伪造的数据就足够了。

有没有人有一些想法如何使代码尽可能困难？

提前感谢您的任何想法:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:18:26.947

你永远不应该真的试图让你的源代码不可读。它会让你自己感到头疼，而不是对任何修改它的人造成任何障碍。

也就是说，您可以重构所有变量名称以完成胡言乱语并使用空格，但是任何认真尝试理解您的代码的人都可以在体面的文本编辑器中恢复它。让它变得更复杂会降低程序的效率 - 否则你可以用对不做任何事情的函数的无用调用和程序不依赖的计数器的奇怪增量来填充它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:21:53.737

有些压缩机可以完成您想要的工作！其中一些可以下载并用作离线工具，有些可以直接通过网络访问：

[http://javascriptcompressor.com](http://javascriptcompressor.com)

像 jquery 和其他人一样，您可以使用您的代码来维护脚本并提供一个更快的可加载打包版本，该版本几乎不可读

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:33:11.077

这个怎么样：

创建两个 PHP 页面，一个包含游戏界面，另一个包含游戏代码。对第一个进行编程，以便它创建一个一次性使用的字符串，当标签从第二个调用 JS 代码时，该字符串将作为参数传递。对第二个进行编程，以便检查发送的字符串的有效性。如果字符串有效，脚本应该输出 JS 代码，然后使字符串无效。

然后，当用户复制脚本的 URL，将其粘贴到浏览器中，然后点击“返回”时，他看到的只是空白页或“未授权”消息。

# magento - Magento 如何动态更改请求参数？

> ID：13502169
> 
> 赞同：1
> 
> 时间：2012-11-21T21:14:32.123
> 
> 标签：magento

我尝试为 Magento 中的默认排序编写一个像 controller_action_predispatch 这样的观察者：store.com/category.html?dir=asc&order=name

在观察者中，我试图操纵参数但没有成功。我总是为 DESC 顺序尝试示例，所以我这样做了：Mage::app()->getRequest()->setParam('dir', 'desc');

但是在渲染产品列表后它不起作用......我感觉我没有请求参数的电源，或者有没有办法在加载页面和使用 Magento 事件之前更改它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:27:46.603

如果您在产品分类中遇到问题，那么我建议您在此事件上使用观察者“catalog_block_product_list_collection”，然后您可以使用观察者类

```
 $observer->getEvent()->getCollection()->addAttributeToSort('price', 'ASC'); 
```

谢谢

# android - 简单的 MySQL 数据库问题 - 每个应用程序用户的数据库？

> ID：13502171
> 
> 赞同：1
> 
> 时间：2012-11-21T21:14:36.740
> 
> 标签：android, mysql, database, sqlite

目前我已经开发了一个 android 应用程序，每次安装都使用本地 sqlite 数据库。数据库预先填充了静态表，应用程序的全部目的是允许用户使用每个表中的预填充信息分配日期/评论。

我希望将其上线，并将数据库移动到 mysql 格式，允许通过台式机和其他移动设备进行访问。处理此问题的最佳方法是为每个新用户分配一个新数据库吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:20:37.460

您期望有多少用户？我只会使用一个带有用户表的数据库，而不是成百上千个数据库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T21:29:59.687

一张表供所有用户使用（仅包含 ID、电子邮件、密码等用户信息）。

另一个带有评论的表（带有用户 ID 和他的评论），以便您可以根据需要为每个用户添加尽可能多的评论。如果日期与评论相关，则将它们放在此表上，否则将日期放在另一个表上。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T21:34:22.043

我会强烈避免创建多个数据库，而是将关系添加到您使用 users 表所拥有的现有数据库结构中。每个用户与每个现有对象都有关联。如果您可能希望允许一位用户查看另一位用户的信息，请记住与其他用户共享。

我的建议是为应用程序提供更新，在更新后首次启动后将他们的信息推送到您的 MySQL 数据库，并通知用户他们现在可以通过其他方法访问他们的数据。

# parallel-processing - 为共享内存配置 MPI 是什么意思？

> ID：13502172
> 
> 赞同：11
> 
> 时间：2012-11-21T21:14:37.400
> 
> 标签：parallel-processing, mpi, shared-memory, openmpi, message-passing

我有一些与研究相关的问题。

目前我已经完成了基于 MPI 的结构骨架框架工作的实现（具体使用[openmpi 6.3](http://www.open-mpi.org/)）。框架应该在单机上使用。现在，我将它与其他以前的骨架实现（例如[scandium](http://skandium.niclabs.cl/)，[fast-flow](http://sourceforge.net/projects/mc-fastflow/)，..）进行比较

我注意到的一件事是我的实现的性能不如其他实现。我认为这是因为，我的实现基于 MPI（因此需要匹配发送和接收操作的双向通信），而我与之比较的其他实现基于共享内存。（......但我仍然没有很好的解释来推理，这是我问题的一部分）

这两个类别的完成时间存在很大差异。

今天我也介绍了open-mpi的共享内存配置=> [openmpi-sm](http://www.open-mpi.org/faq/?category=sm)

我的问题来了。

**第一**，为共享内存配置 MPI 意味着什么？我的意思是，当 MPI 进程存在于它们自己的虚拟内存中时；以下命令中的标志到底是什么？（我认为在 MPI 中，每次通信都是通过显式传递消息，进程之间不共享内存）。

```
 shell$ mpirun --mca btl self,sm,tcp -np 16 ./a.out 
```

**第二**为什么与为共享内存开发的其他骨架实现相比，MPI 的性能要差这么多？至少我也在一台多核机器上运行它。（我想这是因为其他实现使用了线程并行编程，但我对此没有令人信服的解释）。

非常欢迎任何建议或进一步讨论。

如果我需要进一步澄清我的问题，请告诉我。

感谢您的时间！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-21T22:24:29.510

Open MPI 是非常模块化的。它有自己的组件模型，称为模块化组件架构 (MCA)。这是`--mca`参数名称的来源 - 它用于为 MCA 参数提供运行时值，由 MCA 中的不同组件导出。

每当给定通信器中的两个进程想要相互通信时，MCA 会找到合适的组件，这些组件能够将消息从一个进程传输到另一个进程。如果两个进程都驻留在同一个节点上，Open MPI 通常会选择共享内存 BTL 组件，称为`sm`. 如果两个进程驻留在不同的节点上，Open MPI 会遍历可用的网络接口并选择可以连接到另一个节点的最快的一个。它对 InfiniBand 等快速网络设置了一些首选项（通过`openib`BTL 组件），但如果您的集群没有 InfiniBand，如果`tcp`BTL 组件在允许的 BTL 列表中，则使用 TCP/IP 作为备用。

默认情况下，您*无需*执行任何特殊操作即可启用共享内存通信。只需使用`mpiexec -np 16 ./a.out`. 您链接到的是 Open MPI FAQ 的共享内存部分，它提供了有关`sm`可以调整 BTL 的哪些参数以获得更好性能的提示。我使用 Open MPI 的经验表明，默认参数几乎是最优的并且工作得很好，即使在像多级 NUMA 系统这样的奇特硬件上也是如此。请注意，默认的共享内存通信实现会将数据复制两次——一次从发送缓冲区到共享内存，一次从共享内存到接收缓冲区。[以KNEM](http://runtime.bordeaux.inria.fr/knem/)的形式存在一个快捷方式内核设备，但您必须下载并单独编译它，因为它不是标准 Linux 内核的一部分。借助 KNEM 支持，Open MPI 能够在同一节点上的进程之间执行“零复制”传输——复制由内核设备完成，它是从第一个进程的内存直接复制到第二个进程的内存过程。这极大地改善了驻留在同一节点上的进程之间的大消息传输。

另一种选择是完全忘记 MPI 并直接使用共享内存。您可以使用 POSIX 内存管理接口（参见[此处](http://pubs.opengroup.org/onlinepubs/7908799/xsh/sysmman.h.html)）创建一个共享内存块，让所有进程直接对其进行操作。如果数据存储在共享内存中，这可能是有益的，因为不会制作副本。但要注意现代多插槽系统上的 NUMA 问题，其中每个插槽都有自己的内存控制器，并且从同一板上的远程插槽访问内存速度较慢。进程固定/绑定也很重要 - 传递`--bind-to-socket`给`mpiexec`它以将每个 MPI 进程固定到单独的 CPU 内核。

# c - 如何使用输入 .asm 程序运行 lc3 的命令行版本并使用 gdb 对其进行分析？

> ID：13502173
> 
> 赞同：0
> 
> 时间：2012-11-21T21:14:39.220
> 
> 标签：c, debugging, assembly, gdb, lc3

我是一名 CS 学生，学习如何用 C 编程。LC3 是一种用于教学目的的假汇编语言。

> 计算机名> gdb mysim -norun testfde.obj

这会产生一个问题，无法识别该命令。 `mysim`是 c 可执行文件，`testfde.obj`是 lc3 程序集可执行文件，`-norun`意味着使`mysim`执行成为命令行。

我想使用 gdb 运行`mysim -norun`和`testfde.obj`分析它，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:27:20.877

> 我想用 testfde.obj 运行 mysim -norun 并使用 gdb 分析它，我该怎么做？

```
gdb --args mysim -norun testfde.obj
(gdb) run 
```

或者：

```
gdb mysim
(gdb) run -norun testfde.obj 
```

# node.js - 脚本模板防止 Jade 插值

> ID：13502177
> 
> 赞同：5
> 
> 时间：2012-11-21T21:15:29.300
> 
> 标签：node.js, backbone.js, underscore.js, pug

我正在使用 node.js 和 express.js 来呈现一个 index.jade 页面，该页面包含几个脚本块，其中包含要通过主干和下划线使用的模板。我面临的问题是，由于模板中包含 <%= %> 样式变量，Jade 渲染失败。以下代码片段会导致语法错误：

```
script#tpl-things-list-item(type='text/template')
  td 
    a(href=<%= _id %>) link text
  td <%= name %>
  td <%= age %> 
```

请注意，只有当我在 href 值中使用变量时才会出现问题，如果我删除整个 href，这个片段就可以正常工作。有没有办法解决这个问题？我想继续使用 Jade 来定义模板，因为它非常简洁，但这是一个阻碍。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:31:22.440

知道了。

```
!!! 5
html(lang='en')
    head
        title= title
    body
        h1= "Hello World!"
        script#tpl-things-list-item(type='text/template')
            td
                a(href!="<%= _id %>") link text
            td <%= name %>
            td <%= age %> 
```

# c# - Visual Studio 2012 命令行编译器

> ID：13502180
> 
> 赞同：5
> 
> 时间：2012-11-21T21:15:33.483
> 
> 标签：c#, command-line, csc

我知道这似乎是一个重复的问题，但我已经通过所有现有的答案无济于事。

我一直在尝试让命令提示符确认 C# 的命令行编译器，因为它对于我正在使用的编译器生成器是必需的。我正在全新安装 Windows 7 SP1 64 位，Visual Studio 2012 对 Dreamspark 的赞美。

我尝试将“Microsoft.NET\Framework\v4.0.30319”和“Microsoft.NET\Framework64\v4.0.30319”添加到路径环境变量中，尝试了 vsvars 批处理文件，但仍然没有运气。命令提示符只是声明“csc 未被识别为内部或外部命令”。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T21:24:50.797

真的只有两种可能。一，你的路径不正确。尝试这个：

```
C:\Windows\Microsoft.NET>path
PATH=C:\Program Files\Common Files\Microsoft Shared\Microsoft Online Services;C:\Program Files (x86)\Common Files\Micros
oft Shared\Microsoft Online Services;c:\Program Files (x86)\AMD APP\bin\x86_64;c:\Program Files (x86)\AMD APP\bin\x86;C:
\oraclexe\app\oracle\product\11.2.0\server\bin;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System
32\WindowsPowerShell\v1.0\;C:\Program Files (x86)\QuickTime\QTSystem\;c:\Program Files (x86)\Microsoft SQL Server\100\To
ols\Binn\;c:\Program Files\Microsoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\DTS\Binn\;C:\P
rogram Files (x86)\Java\jre6\bin;C:\Program Files (x86)\Graphviz 2.28\bin;C:\Program Files (x86)\1E\SMSNomad\;C:\Program
 Files (x86)\Git\cmd;C:\Program Files (x86)\Git\bin;C:\Program Files (x86)\IronRuby 1.1\bin;C:\Program Files\Microsoft\W
eb Platform Installer\;C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Pages\v1.0\;C:\Program Files\Microsoft SQL S
erver\110\Tools\Binn\;C:\Program Files (x86)\Microsoft SDKs\TypeScript\0.8.0.0\

C:\Windows\Microsoft.NET>csc
'csc' is not recognized as an internal or external command,
operable program or batch file.

C:\Windows\Microsoft.NET>set path=%path%;C:\Windows\Microsoft.NET\Framework64\v4.0.30319

C:\Windows\Microsoft.NET>csc
Microsoft (R) Visual C# Compiler version 4.0.30319.17929
for Microsoft (R) .NET Framework 4.5
Copyright (C) Microsoft Corporation. All rights reserved.

warning CS2008: No source files specified
error CS1562: Outputs without source must have the /out option specified

C:\Windows\Microsoft.NET> 
```

如果这不起作用，则验证 csc.exe 确实位于正确的位置：

```
C:\Windows\Microsoft.NET>dir C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /b
csc.exe 
```

如果找不到，请尝试执行以下操作：

```
C:\Windows\Microsoft.NET>dir csc.exe /s /b
C:\Windows\Microsoft.NET\Framework\v1.1.4322\csc.exe
C:\Windows\Microsoft.NET\Framework\v2.0.50727\csc.exe
C:\Windows\Microsoft.NET\Framework\v3.5\csc.exe
C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe
C:\Windows\Microsoft.NET\Framework64\v2.0.50727\csc.exe
C:\Windows\Microsoft.NET\Framework64\v3.5\csc.exe
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe 
```

查看它是否在不同的目录中。也许您安装了另一个版本的框架，或者没有 64 位操作系统。

# flexslider - Flexslider，显示下一张幻灯片

> ID：13502181
> 
> 赞同：0
> 
> 时间：2012-11-21T21:15:35.803
> 
> 标签：flexslider

我正在使用[http://www.woothemes.com/flexslider/找到的一个不错的滑块](http://www.woothemes.com/flexslider/)

当您单击位于滑块下方的链接时，我想更改为第二张幻灯片，但不确定如何实现并且他们的网站上没有任何内容，有人知道我该如何实现吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T10:40:24.993

在你的 flexslider js 中，你会遇到一个动画函数。

```
 slider.flexAnimate = function(target, pause) 
```

该功能将帮助您实现您想做的事情。函数结束后，可以编写：

```
yourFuntionName = slider.flexAnimate; 
```

单击链接时调用此函数为 yourFuntionName(1);

**或者**干脆打电话

```
slider.flexAnimate(1); 
```

**或**对于 1.8 及以后的版本：

```
$('#slider').flexslider(1); 
```

*请注意，幻灯片 1 = 目标 0，幻灯片 2 = 目标 1，依此类推。希望这可以帮助 ：）

# debugging - 从转储文件中提取 unicode 文本

> ID：13502182
> 
> 赞同：4
> 
> 时间：2012-11-21T21:15:41.313
> 
> 标签：debugging, windbg

我有一个程序冻结（特别是 sql 开发人员），其中有一些未保存的文件。在终止进程之前，我使用 sysinternal 的进程资源管理器创建了一个转储文件。我真的只损失了几个小时的工作，但我认为看看我可以从转储文件中提取什么将是一次很好的学习体验。到目前为止，我已经下载并运行了 windbg，并找到了我的文本：

```
s -u 0x00000000 L?0xffffffff "text I know exists in my file" 
```

从那里我得到了相关的内存地址，并且可以查看内存窗口中的文本以及大部分文件。但是，从这里我有点卡住了。我知道我可以使用 du 命令转储文本，但我应该使用哪种策略来确定开始和结束范围。这是一个 1 Gig 转储，所以我从不将 0x00000000 转储到 0xffffffff，因为我没有大多数编辑器可以打开的文本文件。有没有办法只转储用户内存或非代码内存等？它不一定是完美的。我只是在 textpad 中打开转储文件，但没有显示 unicode 数据，只有偶尔的 ascii（可能是因为 textpad 无法检测到类型或者因为它是 64 位转储）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T14:08:11.420

您也可以尝试 sysinternals（现为 MS）中的 strings.exe 实用程序，并将所有输出（unicode 和 ascii）重定向到文本文件。然后搜索文本文件（或只是眼球）以查找您要查找的内容。

# c# - 为什么我的 WSDL 仍然显示带有 http 位置值的基本 http 绑定？

> ID：13502185
> 
> 赞同：7
> 
> 时间：2012-11-21T21:15:50.847
> 
> 标签：c#, visual-studio-2010, wcf, https

我启用了 https 绑定，但我的 WSDL 有 http 的肥皂地址。任何想法为什么？谢谢！

```
<wsdl:service name="XXXX"><wsdl:port name="BasicHttpBinding_XXXXService" binding="i0:BasicHttpBinding_XXXService">
    <soap:address location="http://dev-soa-app/XXXX/XXXX/XXXService.svc"/></wsdl:port>
</wsdl:service> 
```

这是我的 web.config 文件：

```
<?xml version="1.0"?>
<configuration>

  <system.web>
    <customErrors mode="Off"/>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <configProtectedData>
    <providers>
      <add name="ConnStrings" type="System.Configuration.RsaProtectedConfigurationProvider, System.Configuration, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" keyContainerName="ConnStrings" cspProviderName="" useMachineContainer="true" useOAEP="false"/>
    </providers>
  </configProtectedData>
  <connectionStrings configSource="ConnStrings\ConnStrings.config"/>
  <system.serviceModel>
    <services>
      <service name="XXXXService">
        <!-- Use a bindingNamespace to eliminate tempuri.org -->
        <endpoint address=""  name="XXXXService"
                  binding ="wsHttpBinding" bindingConfiguration="TransportSecurity"
                  bindingNamespace="WF.CT2.WebServices.XXXXService"
                  contract="WF.CT2.WebServices.XXXXService.SAMLService" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange"/>
      </service>
    </services>
    <bindings>
      <wsHttpBinding>
        <binding name="TransportSecurity">
          <security mode="Transport">
            <transport clientCredentialType="None"/>
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpsGetEnabled="true" httpGetEnabled ="false" />
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

</configuration> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-23T19:25:45.553

首先，您应该意识到`service`WSDL 元素中的 URL 只是一个提示。您的客户不应依赖此作为服务的正确地址。

其次，要意识到如果您的服务托管在 IIS 中，那么*IIS*会根据您在 IIS 中的绑定来确定放置在该元素中的地址。我怀疑您在托管服务的站点上同时启用了 HTTP 和 HTTPS。您通常可以通过在 IIS 管理器的 SSL 页面上设置“需要 SSL”属性来将其切换为仅 HTTPS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-26T19:31:41.170

从您的 Web.Config 中删除 httpGetEnabled ="false" 并保持 httpsGetEnabled="true" 原样（见下文）。

```
 <serviceBehaviors>
   <behavior>
     <serviceMetadata httpsGetEnabled="true" />
     <serviceDebug includeExceptionDetailInFaults="false"/>
 </behavior> 
```

# jquery - JQuery Validator 插件电话验证

> ID：13502191
> 
> 赞同：5
> 
> 时间：2012-11-21T21:16:41.730
> 
> 标签：jquery, html, forms, validation, jquery-validate

我在使用 jquery 验证器验证电话号码时遇到问题。因此，在我输入电话号码的表单中，我使用 jquery 的附加方法来验证电话。这是代码：

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>stuff/title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script>
<script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/additional-methods.min.js"></script>
</head>
<body>
<script>
$(document).ready(function(e) {
    var val = $('#everything').validate({
        onkeyup: false,
        errorClass: "req_mess",
        ignore: ":hidden",
        rules: {
            phone: {
                required: true,
                minlength: 10,
                phoneUS: true
            }
        },
        messages: {
            phone: {
                required: "Please enter your phone number",
                phoneUS: "Please enter a valid phone number: (e.g. 19999999999 or 9999999999)"
            }
        }
    });
});
</script>
<form name="everything" id="everything" action="Private/Insert.php" method="post" style="display:none;" >
    Phone Number: <input type="text" name="phone" id="phone"/>
</form>
</body>
</html> 
```

电话号码列的数据库最终看起来像这样：
![电话](../Images/02262769ce142bf46c0be68030b53c7d.png)
有时它会正确插入完整的电话号码（用红色划掉），但有时它只插入 3 位数字。我不知道为什么。这可能与 Internet Explorer 有关吗？有没有人遇到过这个问题？有谁知道为什么会这样？[如果有人需要，](http://pastie.org/5414367)这是完整的 jquery 验证代码

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-25T05:27:35.847

您正在对电话号码使用[phoneUS](http://docs.jquery.com/Plugins/Validation/CustomMethods/phoneUS)验证方法，该方法接受以下两个输入（示例）：

*   949-101-2020
*   9491012020

由于第一个示例被认为是有效的，因此您尝试将其直接存储到数据库中，并且您似乎使用的是整数或数字列。许多数据库，包括 MySQL 将尝试通过简单地删除第一个非数字字符之后的所有内容来将该值强制转换为整数。我总是建议使用一个`varchar`字段来存储电话号码，因为这些数字并没有真正的数字含义（即你永远不会加/减）。

此外，简单地依赖客户端验证也是一个坏主意。您总是希望在服务器端验证您的数据，因为欺骗客户端验证（无论是否恶意）非常简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T18:42:37.033

> 这是电话模板的自定义验证：

```
jQuery.validator.addMethod("phone", function (phone_number, element) {
        phone_number = phone_number.replace(/\s+/g, "");
        return this.optional(element) || phone_number.length > 9 &&
              phone_number.match(/^\(?[\d\s]{3}-[\d\s]{3}-[\d\s]{4}$/);
    }, "Invalid phone number"); 
```

例如：123-123-1234

这是带有国家前缀的格式：

```
 jQuery.validator.addMethod("phoneUS", function (phone_number, element) {
      phone_number = phone_number.replace(/\s+/g, "");
      return this.optional(element) || phone_number.length > 9 &&
      phone_number.match(/^\+[0-9]{11}$/);
  }, "Please specify a valid phone number"); 
```

> 只需将 phoneUS 类添加到输入前 +41748987145

此方法是 jquery 验证的扩展。通过这种方式，您可以定义自己的自定义规则。相信我，有些情况下你需要它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-25T05:15:06.323

如果数据库字段包含整数并且您要发送诸如“987-123-1223”之类的内容，则取决于您的数据库引擎，只会存储前几位。

我自己已经有这个问题了！您可以使用简单的字符串替换方法在服务器端修复它！

# arrays - PowerShell 数组取消移位

> ID：13502193
> 
> 赞同：4
> 
> 时间：2012-11-21T21:16:43.297
> 
> 标签：arrays, powershell

在阅读了 Windows PowerShell 博客上[这篇有用的文章](https://web.archive.org/web/20160103103615/http://blogs.msdn.com:80/b/powershell/archive/2007/02/06/powershell-tip-how-to-shift-arrays.aspx)后，我意识到我可以从数组的第一部分“移位”，但不知道如何在 PowerShell 中“取消移位”或将元素推送到数组的前面。

我正在创建一个哈希对象数组，最后一个读取的项目首先被推送到数组中。我想知道是否有更好的方法来实现这一点。

```
## Create a list of files for this collection, pushing item on top of all other items
if ($csvfiles[$collname]) {
    $csvfiles[$collname] = @{ repdate = $date; fileobj = $csv }, $csvfiles[$collname] | %{$_}
}
else {
    $csvfiles[$collname] = @{ repdate = $date; fileobj = $csv }
} 
```

有几点需要注意：

1.  我需要使用 foreach 循环 %{$_} 展开前一个数组元素，因为仅引用该数组会创建一个嵌套数组结构。我必须将所有元素都放在同一级别。
2.  我需要区分一个空数组和一个包含元素的数组。如果我尝试展开一个空数组，它会在数组末尾放置一个 $null 元素。

想法？

PS：空哈希元素产生 NULL 值的原因是 $null 在 PowerShell 中被视为标量。有关详细信息，请参阅[https://connect.microsoft.com/PowerShell/feedback/details/281908/foreach-should-not-execute-the-loop-body-for-a-scalar-value-of-null](https://connect.microsoft.com/PowerShell/feedback/details/281908/foreach-should-not-execute-the-loop-body-for-a-scalar-value-of-null)。

回答：

看起来最好的解决方案是在必要时预先创建空数组，而不是围绕 $null 问题编写代码。这是使用 .NET ArrayList 和本机 PoSh 数组进行的重写。

```
if (!$csvfiles.ContainsKey($collname)) {
    $csvfiles[$collname] = [System.Collections.ArrayList]@()
}
$csvfiles[$collname].insert(0, @{ repdate = $repdate; fileobj = $csv })

## NATIVE POSH SOLUTION...
if (!$csvfiles.ContainsKey($collname)) {
    $csvfiles[$collname] = @()
}
$csvfiles[$collname] = @{ repdate = $repdate; fileobj = $csv }, `
                       $csvfiles[$collname] | %{$_} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T23:46:17.577

您可能想改用[ArrayList](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.aspx)对象，因为它们支持在任意位置插入。例如：

```
# C:\> $a = [System.Collections.ArrayList]@(1,2,3,4)
# C:\> $a.insert(0,6)
# C:\> $a
6
1
2
3
4 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-02-25T08:58:30.347

您可以简单地使用加号运算符：

```
$array = @('bar', 'baz')
$array = @('foo') + $array 
```

注意：这种重新创建实际上是创建一个新数组而不是更改现有数组（但是`$head, $tail = $array`您所指的转换方式完全相同）。

# android - 不同屏幕尺寸的布局，为什么选择默认？

> ID：13502195
> 
> 赞同：2
> 
> 时间：2012-11-21T21:16:55.730
> 
> 标签：android, eclipse

我已经为小、大和超大屏幕尺寸创建了布局文件，但是当我在三星 S3 模拟器上加载我的应用程序时，分辨率为 720 x 1280，它仍然是正在使用的默认布局。

我不明白为什么 android 不使用我的特定布局文件。

我已将布局文件放置在文件夹布局下的文件夹 layout-large、layout-small、layout-xlarge 中。

希望有人能指出我做错了什么。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T23:27:36.723

您所指的屏幕尺寸存储桶自 Android 3.2（API 级别 13？）以来已弃用。如果您的目标是更高版本的 Android，那么您应该使用“最小宽度”限定符来启用更精细的粒度控制。

例如，三星 Note 将利用旧的“layout-large”存储桶，但它对迷你或普通平板电脑布局的反应不佳。这些设备通常运行 Android post 3.2（DELL *Streak*和原始*Galaxy 10.1*标签除外）。为了在这种情况下进行区分，请提供一个`layout-sw520-port`和`layout-sw520-land`资源文件夹并将布局放置在此处。可以对 Nexus7 类型设备 (sw600) 等进行进一步区分。请注意，屏幕上有保留像素（通知/操作栏等），因此物理最小宽度 DPI 并不是您的布局将响应的确切内容（尽管可以预测关闭）。

Diana Hackborn (hackbod) 写了一篇关于这个主题的[综合博客文章](http://android-developers.blogspot.se/2011/07/new-tools-for-managing-screen-sizes.html?m=1)，描述了改变背后的动机以及它解决的各种问题（参见你的问题）。谷歌还汇总了一些关于设计多种配置的建议，作为其平板电脑驱动器的一部分。如果您遇到更多问题，请查阅 Android 开发指南。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T22:06:27.053

三星 S3 属于“正常”类别。

我发现layout_weight="1" 和layout_width="0dp" 极大地帮助我获得了可以缩放到不同分辨率的布局，以防万一有人问这个问题，想知道为什么布局在某些区域没有缩放。

# php - 如何使用 PHP 从 PDF 文件中提取文本？

> ID：13502196
> 
> 赞同：1
> 
> 时间：2012-11-21T21:17:02.720
> 
> 标签：php, pdf

我知道有很多 PDF 提取方法/技术，但我正在寻找一个可靠的 PHP 中 PDF 文本提取器。我想要的只是提取单词，而不是数字和特殊字符。

任何实现这一目标的可靠技术的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:28:40.233

Zend 框架提供[Zend_Pdf](http://framework.zend.com/manual/1.12/en/zend.pdf.html)，一个将加载和解析 pdf 文档的 php 类。

[这是一个脚本](http://www.hashbangcode.com/blog/zend-lucene-and-pdf-documents-part-2-pdf-data-extraction-437.html)，展示了如何从加载的 Zend_Pdf 对象中提取文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-09T06:50:32.177

如果你使用 laravel，你可以试试我的库...

```
<?php

namespace App\Helpers;

/*
SYNTAX:
include('class.pdf2text.php');
$a = new PDF2Text();
$a->setFilename('test.pdf');
$a->decodePDF();
echo $a->output();
*/

class PDF2Text {
    // Some settings
    var $multibyte = 4; // Use setUnicode(TRUE|FALSE)
    var $convertquotes = ENT_QUOTES; // ENT_COMPAT (double-quotes), ENT_QUOTES (Both), ENT_NOQUOTES (None)
    var $showprogress = false; // TRUE if you have problems with time-out

    // Variables
    var $filename = '';
    var $decodedtext = '';

    function setFilename($filename) {
        $this->decodedtext = '';
        $this->filename = $filename;
    }

    function output($echo = false) {
        if($echo) echo $this->decodedtext;
        else return $this->decodedtext;
    }

    function setUnicode($input) {
        // 4 for unicode. But 2 should work in most cases just fine
        if($input == true) $this->multibyte = 4;
        else $this->multibyte = 2;
    }

    function decodePDF() {
        // Read the data from pdf file
        $infile = @file_get_contents($this->filename, FILE_BINARY);
        if (empty($infile))
            return "";

        // Get all text data.
        $transformations = array();
        $texts = array();

        // Get the list of all objects.
        preg_match_all("#obj[\n|\r](.*)endobj[\n|\r]#ismU", $infile . "endobj\r", $objects);
        $objects = @$objects[1];

        // Select objects with streams.
        for ($i = 0; $i < count($objects); $i++) {
            $currentObject = $objects[$i];

            // Prevent time-out
            @set_time_limit ();
            if($this->showprogress) {
                flush(); ob_flush();
            }

            // Check if an object includes data stream.
            if (preg_match("#stream[\n|\r](.*)endstream[\n|\r]#ismU", $currentObject . "endstream\r", $stream )) {
                $stream = ltrim($stream[1]);
                // Check object parameters and look for text data.
                $options = $this->getObjectOptions($currentObject);

                if (!(empty($options["Length1"]) && empty($options["Type"]) && empty($options["Subtype"])) )
                    continue;

                unset($options["Length"]);

                // So, we have text data. Decode it.
                $data = $this->getDecodedStream($stream, $options);

                if (strlen($data)) {
                    if (preg_match_all("#BT[\n|\r](.*)ET[\n|\r]#ismU", $data . "ET\r", $textContainers)) {
                        $textContainers = @$textContainers[1];
                        $this->getDirtyTexts($texts, $textContainers);
                    } else
                        $this->getCharTransformations($transformations, $data);
                }
            }
        }

        // Analyze text blocks taking into account character transformations and return results.
        $this->decodedtext = $this->getTextUsingTransformations($texts, $transformations);
    }

    function decodeAsciiHex($input) {
        $output = "";

        $isOdd = true;
        $isComment = false;

        for($i = 0, $codeHigh = -1; $i < strlen($input) && $input[$i] != '>'; $i++) {
            $c = $input[$i];

            if($isComment) {
                if ($c == '\r' || $c == '\n')
                    $isComment = false;
                continue;
            }

            switch($c) {
                case '\0': case '\t': case '\r': case '\f': case '\n': case ' ': break;
                case '%':
                    $isComment = true;
                break;

                default:
                    $code = hexdec($c);
                    if($code === 0 && $c != '0')
                        return "";

                    if($isOdd)
                        $codeHigh = $code;
                    else
                        $output .= chr($codeHigh * 16 + $code);

                    $isOdd = !$isOdd;
                break;
            }
        }

        if($input[$i] != '>')
            return "";

        if($isOdd)
            $output .= chr($codeHigh * 16);

        return $output;
    }

    function decodeAscii85($input) {
        $output = "";

        $isComment = false;
        $ords = array();

        for($i = 0, $state = 0; $i < strlen($input) && $input[$i] != '~'; $i++) {
            $c = $input[$i];

            if($isComment) {
                if ($c == '\r' || $c == '\n')
                    $isComment = false;
                continue;
            }

            if ($c == '\0' || $c == '\t' || $c == '\r' || $c == '\f' || $c == '\n' || $c == ' ')
                continue;
            if ($c == '%') {
                $isComment = true;
                continue;
            }
            if ($c == 'z' && $state === 0) {
                $output .= str_repeat(chr(0), 4);
                continue;
            }
            if ($c < '!' || $c > 'u')
                return "";

            $code = ord($input[$i]) & 0xff;
            $ords[$state++] = $code - ord('!');

            if ($state == 5) {
                $state = 0;
                for ($sum = 0, $j = 0; $j < 5; $j++)
                    $sum = $sum * 85 + $ords[$j];
                for ($j = 3; $j >= 0; $j--)
                    $output .= chr($sum >> ($j * 8));
            }
        }
        if ($state === 1)
            return "";
        elseif ($state > 1) {
            for ($i = 0, $sum = 0; $i < $state; $i++)
                $sum += ($ords[$i] + ($i == $state - 1)) * pow(85, 4 - $i);
            for ($i = 0; $i < $state - 1; $i++) {
                try {
                    if(false == ($o = chr($sum >> ((3 - $i) * 8)))) {
                        throw new Exception('Error');
                    }
                    $output .= $o;
                } catch (Exception $e) { /*Dont do anything*/ }
            }
        }

        return $output;
    }

    function decodeFlate($data) {
        return @gzuncompress($data);
    }

    function getObjectOptions($object) {
        $options = array();

        if (preg_match("#<<(.*)>>#ismU", $object, $options)) {
            $options = explode("/", $options[1]);
            @array_shift($options);

            $o = array();
            for ($j = 0; $j < @count($options); $j++) {
                $options[$j] = preg_replace("#\s+#", " ", trim($options[$j]));
                if (strpos($options[$j], " ") !== false) {
                    $parts = explode(" ", $options[$j]);
                    $o[$parts[0]] = $parts[1];
                } else
                    $o[$options[$j]] = true;
            }
            $options = $o;
            unset($o);
        }

        return $options;
    }

    function getDecodedStream($stream, $options) {
        $data = "";
        if (empty($options["Filter"]))
            $data = $stream;
        else {
            $length = !empty($options["Length"]) ? $options["Length"] : strlen($stream);
            $_stream = substr($stream, 0, $length);

            foreach ($options as $key => $value) {
                if ($key == "ASCIIHexDecode")
                    $_stream = $this->decodeAsciiHex($_stream);
                elseif ($key == "ASCII85Decode")
                    $_stream = $this->decodeAscii85($_stream);
                elseif ($key == "FlateDecode")
                    $_stream = $this->decodeFlate($_stream);
                elseif ($key == "Crypt") { // TO DO
                }
            }
            $data = $_stream;
        }
        return $data;
    }

    function getDirtyTexts(&$texts, $textContainers) {
        for ($j = 0; $j < count($textContainers); $j++) {
            if (preg_match_all("#\[(.*)\]\s*TJ[\n|\r]#ismU", $textContainers[$j], $parts))
                $texts = array_merge($texts, array(@implode('', $parts[1])));
            elseif (preg_match_all("#T[d|w|m|f]\s*(\(.*\))\s*Tj[\n|\r]#ismU", $textContainers[$j], $parts))
                $texts = array_merge($texts, array(@implode('', $parts[1])));
            elseif (preg_match_all("#T[d|w|m|f]\s*(\[.*\])\s*Tj[\n|\r]#ismU", $textContainers[$j], $parts))
                $texts = array_merge($texts, array(@implode('', $parts[1])));
        }

    }

    function getCharTransformations(&$transformations, $stream) {
        preg_match_all("#([0-9]+)\s+beginbfchar(.*)endbfchar#ismU", $stream, $chars, PREG_SET_ORDER);
        preg_match_all("#([0-9]+)\s+beginbfrange(.*)endbfrange#ismU", $stream, $ranges, PREG_SET_ORDER);

        for ($j = 0; $j < count($chars); $j++) {
            $count = $chars[$j][1];
            $current = explode("\n", trim($chars[$j][2]));
            for ($k = 0; $k < $count && $k < count($current); $k++) {
                if (preg_match("#<([0-9a-f]{2,4})>\s+<([0-9a-f]{4,512})>#is", trim($current[$k]), $map))
                    $transformations[str_pad($map[1], 4, "0")] = $map[2];
            }
        }
        for ($j = 0; $j < count($ranges); $j++) {
            $count = $ranges[$j][1];
            $current = explode("\n", trim($ranges[$j][2]));
            for ($k = 0; $k < $count && $k < count($current); $k++) {
                if (preg_match("#<([0-9a-f]{4})>\s+<([0-9a-f]{4})>\s+<([0-9a-f]{4})>#is", trim($current[$k]), $map)) {
                    $from = hexdec($map[1]);
                    $to = hexdec($map[2]);
                    $_from = hexdec($map[3]);

                    for ($m = $from, $n = 0; $m <= $to; $m++, $n++)
                        $transformations[sprintf("%04X", $m)] = sprintf("%04X", $_from + $n);
                } elseif (preg_match("#<([0-9a-f]{4})>\s+<([0-9a-f]{4})>\s+\[(.*)\]#ismU", trim($current[$k]), $map)) {
                    $from = hexdec($map[1]);
                    $to = hexdec($map[2]);
                    $parts = preg_split("#\s+#", trim($map[3]));

                    for ($m = $from, $n = 0; $m <= $to && $n < count($parts); $m++, $n++)
                        $transformations[sprintf("%04X", $m)] = sprintf("%04X", hexdec($parts[$n]));
                }
            }
        }
    }

    function getTextUsingTransformations($texts, $transformations) {
        $document = "";
        for ($i = 0; $i < count($texts); $i++) {
            $isHex = false;
            $isPlain = false;

            $hex = "";
            $plain = "";
            for ($j = 0; $j < strlen($texts[$i]); $j++) {
                $c = $texts[$i][$j];
                switch($c) {
                    case "<":
                        $hex = "";
                        $isHex = true;
                        $isPlain = false;
                    break;
                    case ">":
                        $hexs = str_split($hex, $this->multibyte); // 2 or 4 (UTF8 or ISO)
                        for ($k = 0; $k < count($hexs); $k++) {

                            $chex = str_pad($hexs[$k], 4, "0"); // Add tailing zero
                            if (isset($transformations[$chex]))
                                $chex = $transformations[$chex];
                            $document .= html_entity_decode("&#x".$chex.";");
                        }
                        $isHex = false;
                    break;
                    case "(":
                        $plain = "";
                        $isPlain = true;
                        $isHex = false;
                    break;
                    case ")":
                        $document .= $plain;
                        $isPlain = false;
                    break;
                    case "\\":
                        $c2 = $texts[$i][$j + 1];
                        if (in_array($c2, array("\\", "(", ")"))) $plain .= $c2;
                        elseif ($c2 == "n") $plain .= '\n';
                        elseif ($c2 == "r") $plain .= '\r';
                        elseif ($c2 == "t") $plain .= '\t';
                        elseif ($c2 == "b") $plain .= '\b';
                        elseif ($c2 == "f") $plain .= '\f';
                        elseif ($c2 >= '0' && $c2 <= '9') {
                            $oct = preg_replace("#[^0-9]#", "", substr($texts[$i], $j + 1, 3));
                            $j += strlen($oct) - 1;
                            $plain .= html_entity_decode("&#".octdec($oct).";", $this->convertquotes);
                        }
                        $j++;
                    break;

                    default:
                        if ($isHex)
                            $hex .= $c;
                        elseif ($isPlain)
                            $plain .= $c;
                    break;
                }
            }
            $document .= "\n";
            //$document .= "<br>";
        }

        return $document;
    }
} 
```

# java - 获取将从 HttpPost 发送的完整的原始 HTTP 请求消息

> ID：13502198
> 
> 赞同：3
> 
> 时间：2012-11-21T21:17:09.487
> 
> 标签：java, apache, http, post

我正在尝试构建一个原始的 HTTP POST 请求。但是，我不想实际连接到服务器并发送消息。

我一直在研究 Apache HTTP 库，希望我可以创建一个 HttpPost 对象，设置实体，然后获取它会创建的消息。到目前为止，我可以转储实体，但不能转储整个请求，因为它会出现在服务器端。

有任何想法吗？当然，除了重新创建轮子之外。

# 解决方案

我将 ShyJ 的响应重构为一对静态类，但原始响应运行良好。这是两个类：

```
public static final class LoopbackPostMethod extends PostMethod {
    private static final String STATUS_LINE = "HTTP/1.1 200 OK";

    @Override
    protected void readResponse(HttpState state, HttpConnection conn) throws IOException, HttpException {
        statusLine = new StatusLine (STATUS_LINE);
    }
}

public static final class LoopbackHttpConnection extends HttpConnection {
    private static final String HOST = "127.0.0.1";
    private static final int PORT = 80;

    private final OutputStream fOutputStream;

    public LoopbackHttpConnection(OutputStream outputStream) {
        super(HOST, PORT);
        fOutputStream = outputStream;
    }

    @Override
    public void flushRequestOutputStream() throws IOException { /* do nothing */ }

    @Override
    public OutputStream getRequestOutputStream() throws IOException, IllegalStateException {
        return fOutputStream;
    }

    @Override
    public void write(byte[] data) throws IOException, IllegalStateException {
        fOutputStream.write(data);
    }
} 
```

这是我用于自己实现的工厂方法，例如：

```
private ByteBuffer createHttpRequest(ByteBuffer data) throws HttpException, IOException {
    LoopbackPostMethod postMethod = new LoopbackPostMethod();
    final ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    postMethod.setRequestEntity(new ByteArrayRequestEntity(data.array()));
    postMethod.execute(new HttpState(), new LoopbackHttpConnection(outputStream));
    byte[] bytes = outputStream.toByteArray();
    ByteBuffer buffer = ByteBuffer.allocate(bytes.length);
    buffer.put(bytes);
    return buffer;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T23:26:05.000

这可以通过[http-client](http://hc.apache.org/httpclient-3.x/)和伪造一些方法来实现。我用的`3.1`版本`http-client`。

*例子*

这段代码：

```
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.OutputStream;

import org.apache.commons.httpclient.HttpConnection;
import org.apache.commons.httpclient.HttpException;
import org.apache.commons.httpclient.HttpState;
import org.apache.commons.httpclient.StatusLine;
import org.apache.commons.httpclient.methods.PostMethod;

public class Main {
    public static void main(String[] args) throws Exception {
        final ByteArrayOutputStream baos = new ByteArrayOutputStream();
        PostMethod method = new PostMethod () {
            @Override
            protected void readResponse(HttpState state, HttpConnection conn)
                    throws IOException, HttpException {
                statusLine = new StatusLine ("HTTP/1.1 200 OK");
            }
        };
        method.addParameter("aa", "b");

        method.execute(new HttpState (), new HttpConnection("http://www.google.abc/hi", 80) {

            @Override
            public void flushRequestOutputStream() throws IOException {
            }

            @Override
            public OutputStream getRequestOutputStream() throws IOException,
                    IllegalStateException {
                return baos;
            }

            @Override
            public void write(byte[] data) throws IOException,
                    IllegalStateException {
                baos.write(data);
            }

        });

        final String postBody = new String (baos.toByteArray());

        System.out.println(postBody);
    }
} 
```

将返回

```
POST / HTTP/1.1
User-Agent: Jakarta Commons-HttpClient/3.1
Host: http://www.google.abc/hi
Content-Length: 4
Content-Type: application/x-www-form-urlencoded

aa=b 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:57:56.657

我要做的是实现一个或多个 HttpClient 的接口，并使用我的无操作实现。

例如，查看`ClientConnectionManager`和`AbstractHttpClient`任何连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-26T14:49:49.233

使用 HttpClient 4.x

```
 private static String toRawHttp(HttpUriRequest request) throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        HttpTransportMetricsImpl outTransportMetrics = new HttpTransportMetricsImpl();
        SessionOutputBufferImpl buffer = new SessionOutputBufferImpl(outTransportMetrics, 1);
        HttpMessageWriter<HttpRequest> defaultHttpRequestWriter = DefaultHttpRequestWriterFactory.INSTANCE.create(buffer);
        DefaultHttpRequestWriterFactory writerFactory = new DefaultHttpRequestWriterFactory(null) {
            @Override
            public HttpMessageWriter<HttpRequest> create(SessionOutputBuffer buffer) {
                return defaultHttpRequestWriter;
            }
        };
        buffer.bind(baos);

        ConnectionConfig config = ConnectionConfig.DEFAULT;
        DefaultBHttpClientConnection connection = new DefaultBHttpClientConnection(config.getBufferSize(),
                                                                                   config.getFragmentSizeHint(),
                                                                                   ConnSupport.createDecoder(config),
                                                                                   ConnSupport.createEncoder(config),
                                                                                   config.getMessageConstraints(),
                                                                                   null,
                                                                                   null,
                                                                                   writerFactory,
                                                                                   null) {
            @Override
            protected void ensureOpen() {
                //using writerFactory buffer instead of socket
            }

            @Override
            protected OutputStream createOutputStream(long len, SessionOutputBuffer outbuffer) {
                if (len == ContentLengthStrategy.CHUNKED) {
                    return new ChunkedOutputStream(2048, buffer);
                } else if (len == ContentLengthStrategy.IDENTITY) {
                    return new IdentityOutputStream(buffer);
                } else {
                    return new ContentLengthOutputStream(buffer, len);
                }
            }
        };

        CloseableHttpClient client = HttpClients.custom()
                                                .setRequestExecutor(new HttpRequestExecutor() {

                                                    @Override
                                                    protected HttpResponse doSendRequest(HttpRequest request, HttpClientConnection conn, HttpContext context) throws IOException, HttpException {
                                                        // inject fake connection
                                                        return super.doSendRequest(request, connection, context);
                                                    }

                                                    @Override
                                                    protected HttpResponse doReceiveResponse(HttpRequest request, HttpClientConnection conn, HttpContext context) {
                                                        return new BasicHttpResponse(request.getProtocolVersion(), 200, "OK");
                                                    }
                                                })
                                                .build();
        client.execute(request);
        return new String(baos.toByteArray());
    } 
```

使用：

```
 RequestBuilder builder = RequestBuilder.post(requestModel.getUrl()).addHeader("X-Hello","Word");
 System.out.println(toRawHttp(builder.build())); 
```

将打印：

```
POST /ff HTTP/1.1
X-Hello: Word
Host: localhost:8080
Connection: Keep-Alive
User-Agent: Apache-HttpClient/4.5.8 (Java/1.8.0_161)
Accept-Encoding: gzip,deflate 
```

# c - C bsearch 导致分段错误

> ID：13502202
> 
> 赞同：0
> 
> 时间：2012-11-21T21:17:39.537
> 
> 标签：c, bsearch

我有函数调用 userInteractive(*anangramInfo)，它传入结构 anangramInfo 的指针，这个结构包含指向实际字谜的指针“anagramPointer”。所以，我从用户那里得到了标准输入。然后使用它作为 bsearch 的键来查找指针，这些字谜具有相同的 anangram.sorted。然后将指针向左移动，直到键与 anagram.sorted 不匹配，然后移回右侧 printf anagram.word，直到 anagram.sorted 不匹配。但这导致了我的分割问题

```
#include <string.h>
#include <errno.h>
#include <ctype.h>
#include "anagrams.h"
#include <unistd.h>
#include <sys/stat.h>
#include <sys/types.h>

#define SIZE 80

//struct
struct anagram {
    char word[SIZE];
    char sorted[SIZE];
};

struct anagramInfo {
    struct anagram *anagramPtr;
    int             numOfAnagrams;
};

/* qsort struct comparision function (product C-string field) */ 
int sortedMemberCompare( const void *ptr1, const void *ptr2 )
{ 
    struct anagram *ia = (struct anagram *)ptr1;
    struct anagram *ib = (struct anagram *)ptr2;

    return strcmp(ia->sorted, ib->sorted);
    /* strcmp functions works exactly as expected from
    comparison function */ 
}

void userInteractive( struct anagramInfo *anagramInfoPtr ){

    struct anagram a;
    char data[SIZE];
    char *pos;

    printf("Enter a word to search for anagrams [^D to exit]:\n");
    fgets(data, SIZE, stdin);

    //get ripe of the '\n'
    pos=strchr(data, '\n');
    *pos = '\0';

    strncpy(a.word,data,sizeof(data));

    //lowercase word
    int i;
    for(i=0;data[i] != '\0';i++)
      {
        data[i]=(char)tolower(data[i]);
      }

    /* sort array using qsort functions */ 
    qsort(data,strlen(data), 1, charCompare);

    strncpy(a.sorted,data,sizeof(data));

    //struct pointer to the elements
    struct anagram *ptr= (struct anagram *)bsearch(a.sorted,anagramInfoPtr-> anagramPtr ->sorted,anagramInfoPtr-> numOfAnagrams,sizeof(struct anagram),sortedMemberCompare);

    printf(ptr->word);

    while(strncmp(ptr ->sorted,a.sorted,sizeof(a.sorted))==0) {
        ptr--;
    }

    while(strncmp(ptr ->sorted,a.sorted,sizeof(a.sorted))==0) {
        printf(ptr ->word);
        printf(" ");
        ptr++;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:35:34.190

您的疏忽是`bsearch` *不是在连续数组上搜索*；它甚至没有在正确的位置搜索，因为您正在搜索已*排序的字符串*，但您应该搜索已*排序的 anagrams 成员*：

```
struct anagram *ptr = (struct anagram *)bsearch(&a,
            anagramInfoPtr-> anagramPtr,
            anagramInfoPtr-> numOfAnagrams,
            sizeof(struct anagram),
            sortedMemberCompare); 
```

然后，当`bsearch`失败并返回时`NULL`，您不检查它`ptr`并`NULL`使用它；因此是段错误。（您也不要`NULL`在 Ctrl-D 处检查）。

# 测试

这是一个修改后的版本——我添加了这个`charCompare`函数并`main()`用五个固定的字符串创建了一个，以使其工作，经过一段时间。

```
#include <string.h>
#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <unistd.h>
#include <sys/stat.h>
#include <sys/types.h>

#define SIZE 80

//struct
struct anagram {
    char word[SIZE];
    char sorted[SIZE];
};

struct anagramInfo {
    struct anagram *anagramPtr;
    int             numOfAnagrams;
};

/* qsort struct comparision function (product C-string field) */
int sortedMemberCompare( const void *ptr1, const void *ptr2 )
{
    struct anagram *ia = (struct anagram *)ptr1;
    struct anagram *ib = (struct anagram *)ptr2;

    return strcmp(ia->sorted, ib->sorted);
    /* strcmp functions works exactly as expected from
    comparison function */
}

int charCompare(const void *a, const void *b)
{
        const char *aa = a, *bb = b;
        if (*aa < *bb)
                return -1;
        if (*aa == *bb)
                return 0;
        return 1;
}

void userInteractive( struct anagramInfo *anagramInfoPtr ){

    struct anagram a;
    char data[SIZE];
    char *pos;

    printf("Enter a word to search for anagrams [^D to exit]:\n");
    fgets(data, SIZE, stdin);

    //get ripe of the '\n'
    pos=strchr(data, '\n'); // In Windows this might be a "\r" maybe?
    if (NULL == pos)
       exit(0);

    *pos = '\0';

    strncpy(a.word,data,sizeof(data));

    //lowercase word
    int i;
    for(i=0;data[i] != '\0';i++)
    {
        data[i]=(char)tolower(data[i]);
    }

    /* sort array using qsort functions */
    qsort(data, strlen(data), 1, charCompare);
    strncpy(a.sorted,data,sizeof(data));

    //struct pointer to the elements
    struct anagram *ptr = (struct anagram *)bsearch(&a,
                anagramInfoPtr-> anagramPtr,
                anagramInfoPtr-> numOfAnagrams,
                sizeof(struct anagram),
                sortedMemberCompare);

    // You must check that ptr is not NULL.
    if (NULL == ptr)
    {
        printf("Not found\n");
        return;
    }

    printf("Found: %s\n", ptr->word);

    /* Here there is a subtle error. If you find the FIRST item of the list,
       this code will position itself BEFORE THE BEGINNING of the list, and
       run a strncmp() against who knows what. Other segfault lurking! */

    while(ptr > anagramInfoPtr -> anagramPtr && strncmp(ptr ->sorted,a.sorted,strlen(a.sorted))==0) {
        ptr--;
    }

    // while(strncmp(ptr ->sorted,a.sorted,sizeof(a.sorted))==0) {
    //    ptr--;
    //}

    // Here too you should check you do not pass max number of anagrams,
    // if you hit the last item of the lot.
    while(strncmp(ptr ->sorted,a.sorted,sizeof(a.sorted))==0) {
        printf(ptr ->word);
        printf(" ");
        ptr++;
    }

}

int main()
{
        int i;
        struct anagramInfo *root;

        root = malloc(sizeof(struct anagramInfo));

        root->numOfAnagrams     = 5;
        root->anagramPtr        = malloc(root->numOfAnagrams * sizeof(struct anagram));

        strcpy(root->anagramPtr[0].word, "oriental");
        strcpy(root->anagramPtr[1].word, "teaching");
        strcpy(root->anagramPtr[2].word, "senator");
        strcpy(root->anagramPtr[3].word, "admirer");
        strcpy(root->anagramPtr[4].word, "rescued");

        for (i = 0; i < root->numOfAnagrams; i++)
        {
            int j;
            for (j = 0; root->anagramPtr[i].word[j]; j++)
               root->anagramPtr[i].word[j] = tolower(root->anagramPtr[i].word[j]);
            strcpy(root->anagramPtr[i].sorted, root->anagramPtr[i].word);
            qsort(root->anagramPtr[i].sorted, strlen(root->anagramPtr[i].sorted), 1, charCompare);
        }
        qsort(root-> anagramPtr, root-> numOfAnagrams, sizeof(struct anagram), sortedMemberCompare);
        for (;;)
            userInteractive(root);
    } 
```

# 跑

```
$ gcc -W -Wall -o anagram anagram.c
$ ./anagram
Enter a word to search for anagrams [^D to exit]:
treason
Found: senator

Enter a word to search for anagrams [^D to exit]:
cheating
Found: teaching

Enter a word to search for anagrams [^D to exit]:
relation
Found: oriental

Enter a word to search for anagrams [^D to exit]:

$ 
```

# php - 如果 MySQL 行包含数组中的变量，则更新它？

> ID：13502205
> 
> 赞同：0
> 
> 时间：2012-11-21T21:18:00.113
> 
> 标签：php, mysql, arrays

我有一个 PHP 脚本，它向某些设备令牌发送推送通知，并在发送后，在与该行匹配的列中设置一个变量，以便脚本在下次发送通知时跳过它。

该表如下所示：

```
Token (PRIMARY)     School        Skip
--------------------------------------
f2342f              School 2      0
434fbc              School 1      0
33332c              School 1      0 
```

`Skip`在运行代码以发送通知后，我将列变量设置为 1：

```
if (!mysql_query("UPDATE Snow SET Skip='1' WHERE Token IN('$tokens')", $con)) {
    die('Error: ' . mysql_error());
} 
```

但问题在于，如果两个令牌共享同一所学校，那么它将不会更新。当数组中有多个“令牌”时，它是否可以更新？因此，该查询不仅要更新单个标记，还要更新多个用逗号分隔的标记：

```
UPDATE Snow SET Skip='1' WHERE Token IN('f2342f') // Single tokens matching criteria
UPDATE Snow SET Skip='1' WHERE Token IN('434fbc, 33332c') // Multiple tokens 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:26:12.657

是的，您应该将所有标记括在引号中，这样您就会得到 '434fbc'、'33332c'：

```
$tokensStr = "'" . join("','", explode(",", $tokens)) . "'";
if (!mysql_query("UPDATE Snow SET Skip='1' WHERE Token IN($tokensStr)", $con)) {
    die('Error: ' . mysql_error());
} 
```

如果 $tokens 直接来自用户输入：

```
$tokenArray = explode(",", $tokens));
$tokenArray = array_map('mysql_real_escape_string', $tokenArray);
$tokensStr = "'" . join("','", $tokenArray) . "'";
if (!mysql_query("UPDATE Snow SET Skip='1' WHERE Token IN($tokensStr)", $con)) {
    die('Error: ' . mysql_error());
} 
```

这可以防止 SQL 注入：[http ://en.wikipedia.org/wiki/SQL_injection](http://en.wikipedia.org/wiki/SQL_injection)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:24:10.310

逗号分隔您在 IN 中的值。

IE

```
UPDATE Snow SET Skip='1' WHERE Token IN('434fbc', '33332c') 
```

# html - CSS Box Flex 固定高度容器，顶部可调整大小，底部可滚动

> ID：13502208
> 
> 赞同：2
> 
> 时间：2012-11-21T21:18:10.290
> 
> 标签：html, css

我正在尝试布局一个将垂直调整大小以适应内容的页眉，以及一个将垂直调整剩余大小的页脚，然后在给定固定大小的容器的情况下滚动任何溢出。使用 CSS box-flex 我有一个适用于 Chrome 但不适用于 Firefox 的示例（[http://jsfiddle.net/V4Uc2/](http://jsfiddle.net/V4Uc2/)）。我需要添加哪些 CSS 样式以确保 Firefox 不允许容器溢出并像 Chrome 一样运行？这是内联代码：

```
<style>
  .container
  {
    background: #fee;
    height: 400px;
    width: 400px;
    display: -webkit-box;
    display: -moz-box;
    display: box;
    -webkit-box-orient: vertical;
    -moz-box-orient: vertical;
    box-orient: vertical;
  }
  .header
  {
    background: #fee;
    -webkit-box-flex: 0;
    -moz-box-flex: 0;
    box-flex: 0;
  }
  .footer
  {
    background: #eef;
    overflow: auto;
    -webkit-box-flex: 1;
    -moz-box-flex: 1;
    box-flex: 1;
  }
</style>

<div class="container">
  <div class="header">...</div>
  <div class="footer">...</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T12:21:44.700

添加

```
width: 100%; 
```

在您的页脚 css 描述中。

这样可以防止水平溢出，Firefox 将 400px 保留为固定宽度。

# java - 广播接收器未收到意图

> ID：13502210
> 
> 赞同：2
> 
> 时间：2012-11-21T21:18:13.290
> 
> 标签：java, android, android-intent, broadcastreceiver, intentfilter

当用户使用标准 android 拨号器拨打电话时，我试图显示一条消息。

我的活动中有以下代码

```
 public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);         
        setTestButtonListener();
        Log.i(LOG_TAG, "Activity started...");

    }

    private void setTestButtonListener()
    {
    Button testButton = (Button)this.findViewById(R.id.testButton);
    testButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) 
        {

            Log.i(LOG_TAG, "Clicked on test...");
            Toast.makeText(getApplicationContext(), (CharSequence)"You clicked on the test button" ,Toast.LENGTH_SHORT).show();
             Intent intent = new Intent(Intent.ACTION_CALL,Uri.parse("tel:"+150));
             MainActivity.this.sendOrderedBroadcast(intent, null);
             MainActivity.this.startActivity(intent);
             Log.i(LOG_TAG, "intent broadcasted... I think... ");
        }
     });
     } 
```

然后在 BroadcastReceiver （以及派生自它的类）中：

```
public class OnMakingCallReceiver extends BroadcastReceiver
{
    private static final String LOG_TAG = OnMakingCallReceiver.class.getSimpleName() + "_LOG";

    @Override
    public void onReceive(Context context,Intent intent)
    {   
            Log.i(LOG_TAG, " got here!");       
    }
} 
```

然后在 AndroidManifest.xml

```
 <uses-permission android:name="android.permission.CALL_PHONE" />

    <receiver android:name=".OnMakingCallReceiver" android:priority="999">
        <intent-filter>
            <action android:name="android.intent.action.CALL"/>
        </intent-filter>
    </receiver> 
```

我单击测试按钮，我看到了这个输出。

点击测试...意图广播...我想...

就这样。我期待看到“到了这里！”。

任何想法为什么我不？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:13:17.560

Did you define the receiver in your AndroidManifest.xml?

Also, ACTION_CALL_BUTTON is sent when you click on something that goes directly to the dialer. Are you sure you're doing that.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T20:21:26.717

我在 AndroidManifest.xml 中使用了它，它可以工作。我认为关键是意图过滤器中的意图 NEW_OUTGOING_CALL 。

```
<receiver android:name=".OnMakingCallReceiver" android:exported="true" android:enabled="true">
        <intent-filter android:priority="999">
             <action android:name="android.intent.action.NEW_OUTGOING_CALL" />
             <action android:name="android.intent.action.ACTION_CALL" />  
        </intent-filter>
</receiver> 
```

可能 ACTION_CALL 可以被删除。这也可能需要添加到清单中：

```
<uses-permission android:name="android.permission.PROCESS_OUTGOING_CALLS" /> 
```

# c# - MySql 上的 Entity Framework 4.4.0 代码首次迁移不断将 dbo 添加到新表

> ID：13502214
> 
> 赞同：1
> 
> 时间：2012-11-21T21:18:47.583
> 
> 标签：c#, mysql, entity-framework-5, entity-framework-migrations, devart

我已经为 MySql 数据库设置了实体框架 4.4.0 (EF5) 代码首次迁移，但是当我运行 Add-Migration 命令时，我总是将 dbo 预先添加到表名中，如下所示：

```
 CreateTable(
            "dbo.Fields",
            c => new
                {
                    FieldId = c.Int(nullable: false, identity: true),
                    FieldTypeId = c.Int(nullable: false),
                    Name = c.String(nullable: false, unicode: false),
                    Description = c.String(unicode: false),
                    CodeList = c.String(unicode: false),
                    Mask = c.String(unicode: false),
                })
            .PrimaryKey(t => t.FieldId)
            .ForeignKey("dbo.FieldTypes", t => t.FieldTypeId, cascadeDelete: true)
            .Index(t => t.FieldTypeId); 
```

我正在使用 Devart 数据库提供程序，我的迁移配置类如下所示：

```
 internal sealed class Configuration : DbMigrationsConfiguration<mydbcontext>
{
    public Configuration()
    {
        // Create a custom connection to specify the database and set a SQL generator for MySql.
        var connectionInfo =
            MySqlConnectionInfo.CreateConnection("<<myconnectionstring>>");

        TargetDatabase = connectionInfo;

        SetSqlGenerator(connectionInfo.GetInvariantName(), new MySqlEntityMigrationSqlGenerator());

        var config = MySqlEntityProviderConfig.Instance;
        config.Workarounds.IgnoreSchemaName = true;

        AutomaticMigrationsEnabled = false;
    }

    protected override void Seed(CloudDataSetDbContext context)
    {

    }
} 
```

由于某种原因，未考虑 IgnoreSchemaName = true 。

我将 Devart 数据库提供程序添加到 web.config 文件中，如下所示：

```
 <system.data>
<DbProviderFactories>
  <remove invariant="Devart.Data.MySql" />
  <add name="dotConnect for MySQL" invariant="Devart.Data.MySql" description="Devart dotConnect for MySQL" type="Devart.Data.MySql.MySqlProviderFactory, Devart.Data.MySql, Version=6.80.350.0, Culture=neutral, PublicKeyToken=09af7300eec23701" />
</DbProviderFactories> 
```

我还添加了一个程序集重定向，因为 Devart 需要这样：

```
 <dependentAssembly>
    <assemblyIdentity name="EntityFramework" publicKeyToken="b77a5c561934e089" />
    <bindingRedirect oldVersion="4.3.1.0" newVersion="4.4.0.0" />
  </dependentAssembly> 
```

有人可以帮我吗？谢谢，史蒂文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T11:14:03.867

我们不影响迁移内容的代码生成（代码生成由 Microsoft 完成）。我们基于迁移代码生成 DDL。生成 DDL 时将忽略代码中指定的“dbo”模式名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T10:19:47.947

我通过将 DotConnect 升级到新的 7.2.122 版本解决了这个问题。现在 __Migrations 表在创建前没有 dbo，因此插入语句有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:15:33.657

在调用 SetSqlGenerator 之前尝试配置他们的 Singleton 配置选项。我有一个可疑的想法，他们会像设置生成器时一样使用当前设置，之后更改它们不会改变生成器的行为。

# c# - 使用转换器将整个对象绑定到文本

> ID：13502216
> 
> 赞同：1
> 
> 时间：2012-11-21T21:18:55.457
> 
> 标签：c#, binding, converter, windows-phone

我有一个 ListBox ，其中将整个绑定对象传递给转换器（需要），并且该对象似乎没有正确更新。这是相关的 XAML

```
<TextBlock
          Text="{Binding Converter={StaticResource DueConverter}}" 
          FontSize="{StaticResource PhoneFontSizeNormal}" 
          Foreground="{StaticResource PhoneDisabledBrush}" /> 
```

和转换器

```
public class DueConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if (value == null) return null;
        Task task = (Task)value;
        if (task.HasReminders)
        {
            return task.Due.Date.ToShortDateString() + " " + task.Due.ToShortTimeString();
        }
        else
        {
            return task.Due.Date.ToShortDateString();
        }
    }

    //Called with two-way data binding as value is pulled out of control and put back into the property
    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

最后是数据模型中的到期日期时间。

```
private DateTime _due;

    [Column(CanBeNull=false)]
    public DateTime Due
    {
        get { return _due; }
        set
        {
            if (_due != value)
            {
                NotifyPropertyChanging("Due");
                _due = value;
                NotifyPropertyChanged("Due");
            }
        }
    } 
```

NotifyPropertyChanging/Changed 工作，因为绑定到不同属性的其他控件正确更新。

我的目标是在更改到期时更新到期日期 TextBlock，但输出的格式取决于 Task 对象的另一个属性。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:49:53.123

TextBlock.Text 属性绑定到 Task 实例，它不关心“到期”。每当您更改“Due”的值时，您还需要引发“Task”的属性更改事件，以便该绑定自行更新。

# android - ANR only on Android 2.2 想解决

> ID：13502217
> 
> 赞同：0
> 
> 时间：2012-11-21T21:18:56.440
> 
> 标签：android, user-experience, android-2.2-froyo, android-anr-dialog

我在 Android 2.2 上收到 ANR

我在一台设备上注意到它并认为它很慢，但继续尝试优化。现在我在模拟器上尝试了它，所以我可以获得错误日志（因为 StrictPolicy 在 Android 2.2 上不可用），我确实有。但是我也将模拟器升级到了 Android 2.3，并且没有发生 ANR。

其他事实，ANR 发生在一切都完成加载之后。应用程序没有停止响应，用户输入和交互会完全正常，没有任何延迟，然后会弹出随机 ANR。如果用户点击等待，ANR 不会再次出现，正常运行的应用程序将继续正常运行。

我已经做了很多优化来解决这个问题：

*   优化 GPS 并确保它脱离 UI 线程
*   将 SharedPreferences 写入移动到异步加载器
*   将文件 I/O 移动到线程中

所以现在，它挂在哪里，UI线程中似乎没有发生任何事情，其他线程似乎已经完成

这是 traces.txt ，它并没有真正告诉我任何有用的信息，但也许你

```
DALVIK THREADS:
"main" prio=5 tid=1 TIMED_WAIT
  | group="main" sCount=1 dsCount=0 s=N obj=0x4001d8e0 self=0xccb0
  | sysTid=323 nice=0 sched=0/0 cgrp=default handle=-1345026008
  | schedstat=( 11941207221 4675177432 906 )
  at java.lang.Object.wait(Native Method)
  - waiting on <0x44f9b158> (a android.os.MessageQueue)
  at java.lang.Object.wait(Object.java:326)
  at android.os.MessageQueue.next(MessageQueue.java:142)
  at android.os.Looper.loop(Looper.java:110)
  at android.app.ActivityThread.main(ActivityThread.java:4627)
  at java.lang.reflect.Method.invokeNative(Native Method)
  at java.lang.reflect.Method.invoke(Method.java:521)
  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
  at dalvik.system.NativeStart.main(Native Method)

"AsyncTask #2" prio=5 tid=10 WAIT
  | group="main" sCount=1 dsCount=0 s=N obj=0x44fdab88 self=0x30a2b0
  | sysTid=342 nice=10 sched=0/0 cgrp=bg_non_interactive handle=982712
  | schedstat=( 275686031 948836091 47 )
  at java.lang.Object.wait(Native Method)
  - waiting on <0x44fdace0> (a java.lang.VMThread)
  at java.lang.Thread.parkFor(Thread.java:1535)
  at java.lang.LangAccessImpl.parkFor(LangAccessImpl.java:48)
  at sun.misc.Unsafe.park(Unsafe.java:317)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:131)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1996)
  at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:359)
  at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1001)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1061)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
  at java.lang.Thread.run(Thread.java:1096)

"AsyncTask #1" prio=5 tid=9 WAIT
  | group="main" sCount=1 dsCount=0 s=N obj=0x45010410 self=0x11df58
  | sysTid=337 nice=10 sched=0/0 cgrp=bg_non_interactive handle=3054552
  | schedstat=( 309934034 6402364637 55 )
  at java.lang.Object.wait(Native Method)
  - waiting on <0x45002e80> (a java.lang.VMThread)
  at java.lang.Thread.parkFor(Thread.java:1535)
  at java.lang.LangAccessImpl.parkFor(LangAccessImpl.java:48)
  at sun.misc.Unsafe.park(Unsafe.java:317)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:131)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1996)
  at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:359)
  at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1001)
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1061)
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
  at java.lang.Thread.run(Thread.java:1096)

"FlurryAgent" prio=5 tid=8 WAIT
  | group="main" sCount=1 dsCount=0 s=N obj=0x450138f8 self=0x118f70
  | sysTid=333 nice=0 sched=0/0 cgrp=default handle=1216736
  | schedstat=( 3721243399 3011581274 329 )
  at java.lang.Object.wait(Native Method)
  - waiting on <0x45013b28> (a android.os.MessageQueue)
  at java.lang.Object.wait(Object.java:288)
  at android.os.MessageQueue.next(MessageQueue.java:146)
  at android.os.Looper.loop(Looper.java:110)
  at android.os.HandlerThread.run(HandlerThread.java:60)

"FlurryAdThread" prio=5 tid=7 WAIT
  | group="main" sCount=1 dsCount=0 s=N obj=0x45012938 self=0x113e60
  | sysTid=332 nice=0 sched=0/0 cgrp=default handle=1131080
  | schedstat=( 6274000 45081005 9 )
  at java.lang.Object.wait(Native Method)
  - waiting on <0x45012b78> (a android.os.MessageQueue)
  at java.lang.Object.wait(Object.java:288)
  at android.os.MessageQueue.next(MessageQueue.java:146)
  at android.os.Looper.loop(Looper.java:110)
  at android.os.HandlerThread.run(HandlerThread.java:60)

"Binder Thread #2" prio=5 tid=6 NATIVE
  | group="main" sCount=1 dsCount=0 s=N obj=0x44f95b80 self=0x140c30
  | sysTid=330 nice=0 sched=0/0 cgrp=default handle=1311936
  | schedstat=( 81519008 45820004 33 )
  at dalvik.system.NativeStart.run(Native Method)

"Binder Thread #1" prio=5 tid=5 NATIVE
  | group="main" sCount=1 dsCount=0 s=N obj=0x44f955f8 self=0x13bd10
  | sysTid=329 nice=0 sched=0/0 cgrp=default handle=1215096
  | schedstat=( 94873013 51004004 33 )
  at dalvik.system.NativeStart.run(Native Method)

"JDWP" daemon prio=5 tid=4 VMWAIT
  | group="system" sCount=1 dsCount=0 s=N obj=0x44f942a0 self=0x1258b8
  | sysTid=328 nice=0 sched=0/0 cgrp=default handle=1157328
  | schedstat=( 57762005 114193008 290 )
  at dalvik.system.NativeStart.run(Native Method)

"Signal Catcher" daemon prio=5 tid=3 RUNNABLE
  | group="system" sCount=0 dsCount=0 s=N obj=0x44f941e8 self=0x131a68
  | sysTid=326 nice=0 sched=0/0 cgrp=default handle=1239472
  | schedstat=( 16133002 29561002 8 )
  at dalvik.system.NativeStart.run(Native Method)

"HeapWorker" daemon prio=5 tid=2 VMWAIT
  | group="system" sCount=1 dsCount=0 s=N obj=0x437a86c0 self=0x1351c8
  | sysTid=324 nice=0 sched=0/0 cgrp=default handle=1134552
  | schedstat=( 146422015 248849023 62 )
  at dalvik.system.NativeStart.run(Native Method) 
```

# iphone - 使用适用于 iPhone Beta 的 Enterprise Distribution

> ID：13502218
> 
> 赞同：1
> 
> 时间：2012-11-21T21:18:57.387
> 
> 标签：iphone, enterprise-distribution

我的公司即将推出我们的 iPhone 应用程序的第一个公开测试版。该产品将在下周准备就绪，我们有几百个测试用户排队。然而，我们在实际的分发方法上有点落后。我们最初计划使用 Enterprise Distribution 来发布产品。

我们还没有申请 DUNS 号码，所以如果我们立即申请，还需要几周时间。但抛开这个问题不谈，有没有人做过这个评论，是否真的存在苹果违反企业协议条款的强烈反对的危险？我们不卖任何东西，也不赚钱——我们只是想规避 100 台设备的限制以及在人们测试之前收集 UID 的必要性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:17:41.590

I would imagine that were Apple to find out that you were not obeying the terms of your Enterprise agreement, they could very well take whatever steps they have designated in that agreement, just because they don't put their licenses out there to be broken. I believe that includes termination of your Enterprise agreement. If they feel really incensed, they could also terminate or fail to accept any other agreements that you have with Apple, such as your ability to participate in their developer program, or post an app for sale on their store. But this is my opinion and not legal advice, for which I'd recommend a lawyer. There's also the possibility of attempting to contact Apple and negotiate new terms to the agreement. But if you're determined to violate the terms of your agreement, I don't think that an answer from the stackoverflow community would really be an adequate assessment of your risks to both your development and your ability to sell any future product through Apple's app store.

# linux - Linux文件删除错误

> ID：13502220
> 
> 赞同：0
> 
> 时间：2012-11-21T21:19:14.120
> 
> 标签：linux, shell

每次运行此代码时，我都会收到错误文件或目录不存在。为什么？

```
read -p "Enter the filename/path of the file you wish to delete : " filename
echo "Do you want to delete this file"
echo "Y/N"
read ans
case "$ans" in 
   Y) "`readlink -f $filename`" >>~/TAM/store & mv $filename ~/TAM/dustbin
        echo "File moved" ;;
   N) "File Not deleted" ;;
esac 
```

当我准确输入文件名/目录并三次检查其正确性时，我仍然收到此错误，但 readlink 部分有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:16:22.287

解释/总结/扩展[我对类似问题的回答](https://stackoverflow.com/a/13502810/507519)：

*   我怀疑你真的打算在你的脚本中使用`&`而不是。`&&`

*   `"File Not deleted"`不是*我*使用过的任何 Linux 系统上的有效命令。也许你错过了`echo`那里？

*   你必须修正你的可变报价。如果`filename`变量包含空格，则`$filename`shell 将其扩展为多个参数。您需要将其括在双引号中：

    ```
    mv "$filename" ~/TAM/dustbin 
    ```

*   我没有看到您的脚本在`~/TAM/`任何地方创建目录...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:52:18.367

你缺少一个`echo`和一个`&&`。

1.  用于`echo "`command`"`通过管道传输命令的结果字符串。或者，您可以直接使用`command`不带反引号和引号的 （不将结果存储在字符串中），在这种情况下，您不需要 an，`echo`因为该命令会将其结果通过管道传递给下一个命令。
2.  单曲`&`将在后台（异步）运行前面的命令。要检查返回值并有条件地执行，您需要`&&`和`||`.

这是一个完整的解决方案/示例（包括更多日志记录）：

```
# modified example not messing the $HOME dir.
# should be save to run in a separate dir
touch testfile                 #create file for testing
read -p "Enter the filename/path of the file you wish to delete : " filename
echo "Do you want to delete this file: $filename"
echo "Y/N"
read ans
touch movedfiles               #create a file to store the moved files
[ -d _trash ] || mkdir _trash  #create a dustbin if not already there
case "$ans" in
    Y)  readlink -f "$filename" >> movedfiles && echo "File name stored" &&
        mv "$filename" _trash && echo "File moved" ;;
    N)  echo "File Not deleted" ;;
esac
cat movedfiles                 #display all moved files 
```

# android - 在android中备份/恢复sqlite db

> ID：13502223
> 
> 赞同：21
> 
> 时间：2012-11-21T21:19:43.083
> 
> 标签：android, sqlite

> **可能重复：**
> [Android 备份/恢复：如何备份内部数据库？](https://stackoverflow.com/questions/5282936/android-backup-restore-how-to-backup-an-internal-database)

我正在开发一个包含 SQL lite db 的应用程序。我需要让用户能够备份数据库并再次恢复它。我怎样才能做到这一点？示例代码？

如果我的用户保存了数据库，然后将应用程序升级到新的数据库版本代码，恢复工作是否可行？我该怎么做？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-11-22T01:39:35.360

在“/data/data/'your.app.package'/databases/”文件夹中，您有一个 .db 文件，它是您的数据库。您可以复制该文件，保存它，然后将其放回原处。

关于如何将数据库备份到外部存储的一个示例：

```
 final String inFileName = "/data/data/<your.app.package>/databases/foo.db";
    File dbFile = new File(inFileName);
    FileInputStream fis = new FileInputStream(dbFile);

    String outFileName = Environment.getExternalStorageDirectory()+"/database_copy.db";

    // Open the empty db as the output stream
    OutputStream output = new FileOutputStream(outFileName);

    // Transfer bytes from the inputfile to the outputfile
    byte[] buffer = new byte[1024];
    int length;
    while ((length = fis.read(buffer))>0){
        output.write(buffer, 0, length);
    }

    // Close the streams
    output.flush();
    output.close();
    fis.close(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T22:06:50.940

你能澄清一下“备份”是什么意思吗？SQLite 没有特定的备份方法；您必须从数据库中读取行并以某种方式保存它们。许多开发人员使用 XML 来执行此操作。

如果用户保存了数据库，然后您转移到新的数据库版本代码，您必须决定如何进行恢复。同样，*您*必须完成读取备份并将其放回数据库的工作；SQLite 和 Android 都不会为您执行此操作。

包 android.app.backup 包含用于使用 Android 备份代理的类，但它们实现了一个通用框架。您可以为要备份的每个文件或数据库实施具体细节。

# c - C 程序验证错误和跳过用户输入

> ID：13502224
> 
> 赞同：0
> 
> 时间：2012-11-21T21:19:53.433
> 
> 标签：c, visual-studio-2010, io, validation

我一直在处理的这个 c++ 程序正在生成涉及以下内容的运行时错误：

1.generatePass 方法跳过验证过程。

2.validatePass 方法跳过用户输入，也跳过验证。

我是 C++ 的新手，是否有某种 nextLine 方法可以像在 java 中一样添加到用户输入中，以及关于为什么要跳过验证的任何想法。不同的观点会有所帮助，因为到目前为止我还没有找到任何其他东西。

谢谢，布赖恩。

```
#include <stdlib.h>
#include <stdio.h>
#include <iostream>
#include <string>
#include <windows.h>
#include <ctime>
#include <string.h>
#include <time.h>

using namespace std;
#define MAX 80

//declaring functions
int showMenu();     
void generatePass();    
void validatePass();
int countLetters(char *,int *,int *,int *,int *,int *);

int main()
{

    int iChoice;

    // have menu appear, user makes decision, do work, reshow menu
    // do this until user enters 5

    do
    {

        iChoice = showMenu();

    }while(iChoice != 3);

    printf("\n\n\n");
    system("pause");

}//end of main

//Methods placed here:

//showMenu method calls program menu,either 1.generate password,2.enter password and validate. or 3.exit(close program)
int showMenu()
{
    int iChoice;

    system("cls");
    printf("\n\n\t\tWelcome to Password Generator and Validator\n\n");
    printf("\n\t\t1\. Generate");
    printf("\n\t\t2\. Validate");
    printf("\n\t\t3\. Exit");

    printf("\n\n\t\tEnter your menu choice: ");
    fflush(stdin);
    scanf_s("%d", &iChoice);

    // user enters one of 3 values
    // generate,validate or exit program

    switch(iChoice)
    {
        case 1:     // generate
        {
            generatePass();

            break;
        }
        case 2:     // validate
        {
            validatePass();

            break;
        }
        case 3:     // exit
        {
            printf("\n\nProgram exiting!...");

            break;
        }
        default:
        {
            break;
        }
    }//end of switch

    return(iChoice);
} //end of showMenu

//method to generate a random password for user following password guidelines.  
void generatePass()

{

    int iChar,iUpper,iLower,iSymbol,iNumber,iTotal;

    printf("\n\n\t\tGenerate Password selected ");
    printf("\n\n\t\tPassword creation in progress... ");

    int i;
    char password[10 + 1];
    char strLower[59+1] = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRTUVWXYZ!£$%^&*";

    srand(time (0));

    for(i = 0; i < 10;i++)
    {
        password[i] = strLower[(rand() % 52)];

    }
    password[i] = '\0';

    iChar = countLetters(password,&iUpper,&iLower,&iSymbol,&iNumber,&iTotal);

    if(iUpper < 2)
    {
        printf("Not enough uppercase letters!!!\n");

    }
    else if(iLower < 2)
    {
        printf("Not enough lowercase letters!!!\n");

    }
    else if(iSymbol < 1)
    {
        printf("Not enough symbols!!!\n");

    }
    else if(iNumber < 2)
    {
        printf("Not enough numbers!!!\n");

    }
    else if(iTotal < 9 && iTotal > 15)
    {
        printf("Not enough characters!!!\n");

    }
    printf("\n\n\n Your new password is verified ");
    printf(password);

    printf("\n\n\n");
    system("pause");

}//end of generatePass method.

//method to validate a user generated password following password guidelines.
void validatePass()
{

    char password[MAX+1];
    int iChar,iUpper,iLower,iSymbol,iNumber,iTotal;

    //shows user password guidelines
    printf("\n\n\t\tPassword rules: ");
    printf("\n\n\t\t 1\. Passwords must be at least 9 characters long and less than 15 characters. ");
    printf("\n\n\t\t 2\. Passwords must have at least 2 numbers in them.");
    printf("\n\n\t\t 3\. Passwords must have at least 2 uppercase letters and 2 lowercase letters in them.");
    printf("\n\n\t\t 4\. Passwords must have at least 1 symbol in them (eg ?, $, £, %).");
    printf("\n\n\t\t 5\. Passwords may not have small, common words in them eg hat, pow or ate.");

    //gets user password input
    printf("\n\n\t\tEnter your password following password rules: ");
    gets_s(password);

    iChar = countLetters(password,&iUpper,&iLower,&iSymbol,&iNumber,&iTotal);

    if(iUpper < 2)
    {
        printf("Not enough uppercase letters!!!\n");

    }
    else if(iLower < 2)
    {
        printf("Not enough lowercase letters!!!\n");

    }
    else if(iSymbol < 1)
    {
        printf("Not enough symbols!!!\n");

    }
    else if(iNumber < 2)
    {
        printf("Not enough numbers!!!\n");

    }
    else if(iTotal < 9 && iTotal > 15)
    {
        printf("Not enough characters!!!\n");

    }
    printf("\n\n\n Your new password is verified ");
    printf(password);

    printf("\n\n\n");
    system("pause");

}//end validatePass method

int countLetters(char * Password,int * Upper,int * Lower,int * Symbol,int * Number,int * Total)
{
    int iTotal = 0,iC = 0,tU = 0,tL = 0,tS = 0,tN = 0;

    //strlen- function that returns length
    for (int iC = 0;iC < strlen(Password);iC++)
    {

        printf("%d",Password[iC]);
        //uppercase letters are in the range 65 - 90
        //lowercase letters are in the range 97 - 122
        //symbols are in the range 32-48
        //numbers are in the range 47 - 58

        if((Password[iC] < 64) && (Password[iC] < 91))
        {
            tU++;
            iTotal++;

        }
        else if((Password[iC] > 96) && (Password[iC] < 123))
        {
            tL++;
            iTotal++;

        }
        else if((Password[iC] > 32) && (Password[iC] < 48))
        {
            tS++;
            iTotal++;

        }
        else if((Password[iC] > 47) && (Password[iC] < 58))
        {
            tN++;
            iTotal++;

        }

        *Upper = tU;/*set value at memory address = tU,passing by reference saves memory used.*/
        *Lower = tL;
        *Symbol = tS;
        *Number = tN;

    }//end for statement

    return (iTotal);
}//end of countLetters 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:11:49.483

我认为主要的问题是，虽然你有构建块，但你没有充分跟上规划你的设计。别担心，它是可以修复的。

> 1.generatePass 方法跳过验证过程。

generatePass() 在自身内部执行验证，但您可能希望将这些行...

```
printf("\n\n\n Your new password is verified ");
printf(password); 
```

...进入一个 else 块，这样用户就不会认为密码没问题。您可能还想利用 generatePass() 中的 validatePass() 函数，因为您当前正在重复代码。

> 2.validatePass 方法跳过用户输入，也跳过验证。

也许此链接与您遇到的问题有关 gets_s(): [StackOverflow.com](https://stackoverflow.com/questions/2311842/how-do-i-get-user-input-without-using-scanf-in-a-console-app)。无论如何，您可以暂时使用 scanf ，因为它一开始会让事情变得更容易，如果需要，您可以稍后返回并使您的程序更健壮。Scanf 将修复被绕过的输入。跳过验证与#1 的模式相同，所以如果你弄清楚你想为此做什么，这里会很容易。

我不确定我是否理解 Java nextLine() 问题，但使用带有 %s 的 scanf 来读取与 Java Scanner.nextLine() 大致相似的字符串函数。

免责声明：我将您的程序作为 C 程序运行，因为将其从 C++ 转换为 C 很简单。（我想如果您打算用 C 风格的代码编写，您可能会考虑将其设为 C 程序。类似地，如果您希望程序更具可移植性，您可以选择避免仅适用于 Windows 的内容（例如，“_s”函数），但在完成之前，您可能会从这些“_s”函数中获得一些很好的实用程序，所以这只是一个想法。）

# c - 标记字符串循环内存错误

> ID：13502226
> 
> 赞同：0
> 
> 时间：2012-11-21T21:19:56.203
> 
> 标签：c, memory, token, tokenize

我正在遍历一个数组，试图获取每个令牌并插入另一个字符串数组（char**），并且我从 valgrind 得到无效写入以及使用未初始化的值。我将如何解决这个问题？

```
 char *tstring;
        int i = 0;
        char **tokens = (char **)malloc(sizeof(contents));
        tstring = strtok(contents, "\"(),-> ");
        printf("sizeof(tstring) = %ld\tsizeof(*tstring) = %ld\nsizeof(contents) = %ld\n", sizeof(tstring), sizeof(*tstring), sizeof(contents));
        tokens[i] = (char*)malloc(sizeof(tstring));
        printf("tstring address: %p\ntokens address: %p\ntokens[i] address: %p\n",tstring,tokens, tokens[i]);
        strcpy(tokens[i], tstring);
        printf("token[0]: %s\n", tokens[i]);
        while( tokens[i] != NULL ) {
                i++;
                tstring = strtok(NULL, "\"(),-> ");
                if(tstring != NULL)
                        printf("token[%d]: %s\n", i, tstring);
                tokens[i] = (char*)malloc(sizeof(tstring));
                strcpy(tokens[i], tstring);
        } 
```

这是被标记的字符串

```
"a" -> ("boo", 1), ("baa", 1)
"baa" -> ("baa", 1)
"boo" -> ("boo", 1)
"cat" -> ("baa", 1)
"dog" -> ("boo", 1)
"name" -> ("boo", 2), ("baa", 1) 
```

这是 valgrind 的输出

```
sizeof(tstring) = 8 sizeof(*tstring) = 1
sizeof(contents) = 8
tstring address: 0x51f1041
tokens address: 0x51f1490
tokens[i] address: 0x51f14e0
token[0]: a
token[1]: boo
==4101== Invalid write of size 8
==4101==    at 0x400F3B: Create_List_Container (search.c:166)
==4101==    by 0x4012D5: main (search.c:234)
==4101==  Address 0x51f1498 is 0 bytes after a block of size 8 alloc'd
==4101==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4101==    by 0x400E1A: Create_List_Container (search.c:154)
==4101==    by 0x4012D5: main (search.c:234)
==4101== 
==4101== Invalid read of size 8
==4101==    at 0x400F4F: Create_List_Container (search.c:167)
==4101==    by 0x4012D5: main (search.c:234)
==4101==  Address 0x51f1498 is 0 bytes after a block of size 8 alloc'd
==4101==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4101==    by 0x400E1A: Create_List_Container (search.c:154)
==4101==    by 0x4012D5: main (search.c:234)
==4101== 
==4101== Invalid read of size 8
==4101==    at 0x400F6A: Create_List_Container (search.c:161)
==4101==    by 0x4012D5: main (search.c:234)
==4101==  Address 0x51f1498 is 0 bytes after a block of size 8 alloc'd
==4101==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4101==    by 0x400E1A: Create_List_Container (search.c:154)
==4101==    by 0x4012D5: main (search.c:234)
==4101== 
token[2]: 1
token[3]: baa
token[4]: 1
token[5]: 

token[6]: baa
token[7]: baa
token[8]: 1
token[9]: 

token[10]: boo
token[11]: boo
token[12]: 1
token[13]: 

token[14]: cat
token[15]: baa
token[16]: 1
token[17]: 

token[18]: dog
token[19]: boo
token[20]: 1
token[21]: 

token[22]: name
token[23]: boo
token[24]: 2
token[25]: baa
token[26]: 1
==4101== Use of uninitialised value of size 8
==4101==    at 0x4EBD146: strtok (strtok.S:172)
==4101==    by 0x400EFA: Create_List_Container (search.c:163)
==4101==    by 0x4012D5: main (search.c:234)
==4101== 
==4101== Conditional jump or move depends on uninitialised value(s)
==4101==    at 0x4EBD149: strtok (strtok.S:173)
==4101==    by 0x400EFA: Create_List_Container (search.c:163)
==4101==    by 0x4012D5: main (search.c:234)
==4101== 
token[27]: 
```

**编辑：仍然出现错误**

所以我修改了 netcoder 给我的代码，但仍然在令牌 [i] 得到 malloc 的地方发生无效的写入和读取

这是代码：

```
 char **tokens = malloc(sizeof(char*)+1);
    if (tokens == NULL) {
            // handle malloc error
            printf("Unable to allocate memory. Exiting...\n");
            exit(0);
    }

    // ...
    while (1) {
            if(i == 0) tstring = strtok(contents, "\"(),-> ");
            else tstring = strtok(NULL, "\"(),-> ");

            if(tstring == NULL) break;

            printf("tstring: %s\tlen(tstring): %d\n", tstring, strlen(tstring));

            tokens[i] = malloc(strlen(tstring)+1);
            if (tokens[i] == NULL) {
                    // handle malloc error
                    printf("Unable to allocate memory. Exiting...\n");
                    exit(0);
            }
            printf("tokens address: %p\t*tokens address: %p\n", tokens, tokens[i]);

            char** tmp = realloc(tokens, (i+2)*sizeof(char*));
            if (tmp == NULL) { 
                    // handle realloc error
                    printf("Unable to reallocate memory. Exiting...\n");
                    exit(0);
            }       
            tokens = tmp;

            strcpy(tokens[i], tstring);
            printf("tokens[%d]: %s\n", i, tokens[i]);
            i++;
    } 
```

请注意，我在开始时分配了 **tokens，而不是像 netcoder 那样将其保留为 NULL，因为这也给了我一个问题。

这是valgrind：

```
tstring: a  len(tstring): 1
tokens address: 0x51f1490   *tokens address: 0x51f14e0
tokens[0]: a
tstring: boo    len(tstring): 3
==4609== Invalid write of size 8
==4609==    at 0x400F3E: Create_List_Container (search.c:185)
==4609==    by 0x401388: main (search.c:270)
==4609==  Address 0x51f1538 is 0 bytes after a block of size 8 alloc'd
==4609==    at 0x4C2B7B2: realloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4609==    by 0x400FB1: Create_List_Container (search.c:193)
==4609==    by 0x401388: main (search.c:270)
==4609== 
==4609== Invalid read of size 8
==4609==    at 0x400F4E: Create_List_Container (search.c:186)
==4609==    by 0x401388: main (search.c:270)
==4609==  Address 0x51f1538 is 0 bytes after a block of size 8 alloc'd
==4609==    at 0x4C2B7B2: realloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4609==    by 0x400FB1: Create_List_Container (search.c:193)
==4609==    by 0x401388: main (search.c:270)
==4609== 
==4609== Invalid read of size 8
==4609==    at 0x400F77: Create_List_Container (search.c:191)
==4609==    by 0x401388: main (search.c:270)
==4609==  Address 0x51f1538 is 0 bytes after a block of size 8 alloc'd
==4609==    at 0x4C2B7B2: realloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4609==    by 0x400FB1: Create_List_Container (search.c:193)
==4609==    by 0x401388: main (search.c:270)
==4609== 
tokens address: 0x51f1530   *tokens address: 0x51f1580
==4609== Use of uninitialised value of size 8
==4609==    at 0x4C2BFFC: strcpy (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4609==    by 0x400FF7: Create_List_Container (search.c:201)
==4609==    by 0x401388: main (search.c:270)
==4609== 
==4609== Invalid write of size 1
==4609==    at 0x4C2BFFC: strcpy (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4609==    by 0x400FF7: Create_List_Container (search.c:201)
==4609==    by 0x401388: main (search.c:270)
==4609==  Address 0x0 is not stack'd, malloc'd or (recently) free'd 
```

已修复，在 realloc 中应该是 (i+2)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:26:22.110

对于初学者，您可以：

```
tokens[i] = (char*)malloc(sizeof(tstring)); 
```

首先，不要强制转换的返回值`malloc`。其次，您可能正在寻找`strlen`，而不是`sizeof`：

```
tokens[i] = malloc(strlen(tstring)+1); // +1 for the null terminator 
```

......你至少犯了两次这个错误。

然后，是这样的：

```
char **tokens = (char **)malloc(sizeof(contents)); 
```

...再次，转换 , 的返回值`malloc`也是`sizeof(contents)`任意的，因为您不知道要在其中存储多少元素。这是一个很好的例子`realloc`：

```
char **tokens = NULL;
// ...
while (...) {
    // ...
    tokens[i] = malloc(strlen(tstring)+1);
    if (tokens[i] == NULL) {
        // handle malloc error
    }

    char** tmp = realloc(tokens, (i+1)*sizeof(char*));
    if (tmp == NULL) {
        // handle realloc error
    }
    tokens = tmp;

    strcpy(tokens[i], tstring);
    i++;
} 
```

还要注意我是如何`i++`在循环结束时移动的，以防止您`tokens[1]`在应该访问的时候访问`tokens[0]`.

最后，始终检查**and****的返回值。`malloc``realloc`**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:26:36.777

当您 malloc 时，您正在传递`sizeof(ptr)`，因此它为 64 位指针分配 8 个字节。您想要`malloc(strlen(ptr)+1)`并以空值终止它。

打印`sizeof(tstring)`到终端，这应该验证它。

# html - 如何使该表可滚动？

> ID：13502227
> 
> 赞同：2
> 
> 时间：2012-11-21T21:19:56.770
> 
> 标签：html, scroll, html-table, internet-explorer-8

在 IE8 中它没有滚动...如何使我的结果表可滚动？

```
<tr>
    <td><input type="radio" name="sso" value="<?php echo $exec->fields['hrOracleNumber']; ?>" onclick="selectSSO(this.value);"></td>
    <td><font color="336699" face="Helvetica" size="1px" ><?php echo $exec->fields['hrOracleNumber']; ?></font></td>
    <td><font color="336699" face="Helvetica" size="1px" ><?php echo $exec->fields['firstName']; ?></font></td>
    <td><font color="336699" face="Helvetica" size="1px" ><?php echo $exec->fields['lastName']; ?></font></td>
    <td><font color="336699" face="Helvetica" size="1px" ><?php echo $exec->fields['description']; ?></font></td>
</tr>

<?php 

    $exec->MoveNext();
} ?>
</table>
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:19:25.167

First off, you would need more rows to scroll vertically.

But to make the table scroll you would wrap it in a div tag and apply CSS styling to that div by adding a fixed height and set the overflow to auto.

The html would look like this:

```
<div class="scroll-table">
<table>
<tr>
    <td><input type="radio" name="sso" value=""></td>
    <td><font color="336699" face="Helvetica" size="1px" >Test</font></td>
    <td><font color="336699" face="Helvetica" size="1px" >Test</font></td>
    <td><font color="336699" face="Helvetica" size="1px" >Test</font></td>
    <td><font color="336699" face="Helvetica" size="1px" >Test</font></td>
</tr>
</table>
</div> 
```

The CSS style sheet would look like this:

```
 .scroll-table{
       height: 50px;
       overflow: auto;
    } 
```

IE 8 doesn't support overflow-x or overflow-y, so you might want to specify a width as well because overflow auto will allow scrolling in both directions.

# ios - iOS：如何让后台线程在主线程上重绘视图

> ID：13502242
> 
> 赞同：2
> 
> 时间：2012-11-21T21:21:06.700
> 
> 标签：ios, multithreading, setneedsdisplay

我的应用程序将查询数据库 50 次，然后通过将正确的 UIImageView 添加到另一个 UIImageView 来做出相应的反应，然后我希望应用程序在每个循环中立即显示。

唉，经过很多个晚上，我都没有让它工作。应用程序不会立即显示 UIImageView。话虽如此，当我在循环中放大或缩小时，UIImageViews 会出现！我肯定错过了什么...

到目前为止，除了最后一部分 [UIScrollView performSelector....

请帮助并提前感谢您。

```
 UIScrollView *firstView;
    UIImageView *secondView;
    UIImageView *thirdView;
    NSOperationQueue *queue;
    NSInvocationOperation *operation;

    - (void)viewDidAppear:(BOOL)animated
    {
    queue = [NSOperationQueue new];
    operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(getData) object:nil];
    [queue addOperation:operation];
    }

    - (void) getData
    {
     for (i=0 ; i < 50 ; i++)

         {

            //All the codes to facilitate XML parsing here
            [nsXMLParser setDelegate:parser];
            [BOOL success = [nsXMLParser parse];

            if (success) 
            {   

                if ([parser.currentValue isEqualToString:@"G"])

                thirdView.image = greenTick.jpg;
                [secondView addSubview:thirdView];

            } 
            else 
            {
                NSLog(@"Error parsing document!");
            }
    } 
    [thirdView performSelectorOnMainThread:@selector(setNeedsDisplay) withObject:nil waitUntilDone: YES];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T01:44:36.580

我发现了解决方案，并真正希望这对某人有所帮助...

```
 if (success) 
        {   

            if ([parser.currentValue isEqualToString:@"G"])

            // Make the changes here - start
            dispatch_queue_t main_queue = dispatch_get_main_queue();
            dispatch_async(main_queue, ^{
            thirdView.image = greenTick.jpg;
            [secondView addSubview:thirdView];
            });
            // Make the changes here - end
        } 
        else 
        {
            NSLog(@"Error parsing document!");
        }
} 
// Remove performSelectorOnMainThread 
```

# java - VPS 上托管的服务器应用程序挂起

> ID：13502244
> 
> 赞同：0
> 
> 时间：2012-11-21T21:21:09.330
> 
> 标签：java, vps

我正在开发一个简单的服务器客户端应用程序。服务器应用程序托管在 VPS 上。我有一个问题：它的行为很奇怪......当我在我的 PC 上测试它时它工作正常，但是当我在 VPS 上启动它时，它（程序）在客户端应用程序尝试连接时挂起（协议是 TCP） . 我什至不能用“killall -vs TERM java”命令杀死它，所以我需要重新启动整个 VPS 才能重新启动它。客户端和服务器应用程序都是用 Java 编写的。VPS 操作系统是 Ubuntu。任何人都可以给我一个关于这件事的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T12:24:36.140

实际上，问题出在 System.out.println("some_text") 命令中。我的服务器不想在某些地方没有这个命令工作。为什么——我还不知道。我会用这种行为进行一些研究。但无论如何，这是另一个问题的主题。

# c# - c# 中的 ref 和 out 参数之间哪个更轻

> ID：13502247
> 
> 赞同：1
> 
> 时间：2012-11-21T21:21:35.170
> 
> 标签：c#, wpf

谁能告诉我`ref`和之间哪个更轻`out`。我也知道关键字和用法`ref`之间的确切区别。`out`

就我而言，我可以同时使用`ref`and `out`，但想知道较轻的那个。

如果有人需要参考，请到[这里](https://stackoverflow.com/questions/135234/difference-between-ref-and-out-parameters-in-net)告诉我较轻的。

提前致谢..

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T21:28:46.863

唯一的区别是编译器提示。

... 出去 ...

```
public static void TestOut(out int test)
{
    test = 1;
}

.method public hidebysig static void  TestOut([out] int32& test) cil managed
{
  // Code size       4 (0x4)
  .maxstack  8
  IL_0000:  ldarg.0
  IL_0001:  ldc.i4.1
  IL_0002:  stind.i4
  IL_0003:  ret
} // end of method Program::TestOut 
```

...参考...

```
public static void TestRef(ref int test)
{
    test = 1;
}

.method public hidebysig static void  TestRef(int32& test) cil managed
{
  // Code size       4 (0x4)
  .maxstack  8
  IL_0000:  ldarg.0
  IL_0001:  ldc.i4.1
  IL_0002:  stind.i4
  IL_0003:  ret
} // end of method Program::TestRef 
```

...`out`并且`ref` 实际上是相同的。唯一真正的区别是 out 告诉编译器期望在方法返回之前设置该值。您可以将值发送给具有`out`标志的函数，但编译器再次将其视为未分配的变量。运行时并不真正关心。两者都将被创建为指向变量的指针。您最好使用描述您期望的功能的关键字。在下面的 JITer 中“可能”发生的任何优化对应用程序的影响几乎为零。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T21:24:14.117

它们很可能在低级别是相同的。如果存在性能差异，它可能可以忽略不计，并且有更好的地方可以优化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T21:27:16.667

这是一个微优化。

实际上，如果您查看为这两个选项生成的 IL 代码，您会发现没有区别。除了 Matthew Whited 指出的编译器提示：

```
.method private hidebysig static void  Out([out] valuetype [mscorlib]System.DateTime& d) cil managed

.method private hidebysig static void  Ref(valuetype [mscorlib]System.DateTime& d) cil managed 
```

我只是建议在语义上最适合当前情况的选项。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-21T21:36:04.987

请参阅[此链接](http://blogs.msdn.com/b/ericlippert/archive/2009/09/21/why-do-ref-and-out-parameters-not-allow-type-variation.aspx) 特别是“结论 4：”部分：

> “out”和“ref”实际上在幕后完全一样。CLR 只支持“ref”；“out”只是“ref”，其中编译器执行的规则略有不同，关于何时知道所讨论的变量已被明确分配。这就是为什么只在 out/ref-ness 上不同的方法重载是非法的；CLR 无法区分它们！因此，out 的类型安全规则必须与 ref 相同。

`out`是根据 实现的`ref`，唯一的区别在于编译的内容，运行时性能将*相同*。

# r - 在 R 上使用 foreach~dopar 计算矩阵

> ID：13502251
> 
> 赞同：1
> 
> 时间：2012-11-21T21:22:18.367
> 
> 标签：r, matrix, foreach

```
library(foreach)
library(doMPI)

m<-matrix(as.integer(0),5,5)

cl <- startMPIcluster(count=4)
registerDoMPI(cl)

foreach(b=1:5)%dopar%
  {
    m[b,]<-c(1:5)
  } 
```

在 R 上运行上面的代码，我得到了较低的结果。

```
> m
     [,1] [,2] [,3] [,4] [,5]
[1,]    0    0    0    0    0
[2,]    0    0    0    0    0
[3,]    0    0    0    0    0
[4,]    0    0    0    0    0
[5,]    0    0    0    0    0 
```

我怎样才能得到矩阵应用于逐行替换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:17:32.560

The purpose of `foreach` and `%dopar%` isn't to modify objects in environments of the R process that created the cluster. What those functions are primarily used for is doing some processing and returning the value of the last evaluated expression.

So instead,

```
mNew <- foreach(b=1:5, .combine = rbind) %dopar%
{
  c(1:5)
} 
```

Or if you only want to "replace" certain elements from the original matrix,

```
mNew <- foreach(b=1:5, .combine = rbind) %dopar%
{
  c(m[b, seq_len(b)], seq_len(5)[seq_len(5 - b)])
} 
```

# java - 在 Java 中合并队列

> ID：13502252
> 
> 赞同：2
> 
> 时间：2012-11-21T21:22:30.037
> 
> 标签：java, queue

我有自己的 ArrayQueue 类，它有方法等`enqueue`。我的类扩展了这个类并包含：`dequeue``peek``ArrayQmerge`

```
 public void mergeQs(ArrayQmerge q){

    } 
```

我想知道在不从传递的 q 中删除任何元素的情况下，编写将 ArrayQueue 与另一个 Queue 合并的方法的最佳方法是什么。

例如。`queue1 = [1,2,3,4,11]`和`queue2 = [5,6,7,8,9,10,12]`。当`queue1.mergeQs(queue2)`被调用时，它将创建`queue1 = [1,5,2,6,3,7,4,8,11,9,10,12]`而`queue2`将保持`[5,6,7,8,9,10,12]`

`mergeQs`如果有意义的话，我希望该方法可以将两个队列中的元素交错。我知道如何成功地将它们添加在一起或使用将两个队列作为参数传递的方法，但在这种情况下，我想使用上述方法（仅传递一个）...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:18:48.867

这是你可以做的：

```
public static void main(String[] args) {
    ArrayQmerge q1 = new ArrayQmerge();
    q1.enqueue(1);
    q1.enqueue(2);
    q1.enqueue(3);
    q1.enqueue(4);
    q1.enqueue(11);
    ArrayQmerge q2 = new ArrayQmerge();
    q2.enqueue(5);
    q2.enqueue(6);
    q2.enqueue(7);
    q2.enqueue(8);
    q2.enqueue(9);
    q2.enqueue(10);
    q2.enqueue(12);
    System.out.println(q1);
    System.out.println(q2);
    q1.mergeQs(q2);
    System.out.println(q1);
    System.out.println(q2);
}

static class ArrayQmerge{
    private List<Integer> queue = new ArrayList<Integer>();

    public void enqueue(int val){
        queue.add(val);
    }

    public String toString(){
        return queue.toString();
    }

    public void mergeQs(ArrayQmerge q){
        List<Integer> mergedQ = new ArrayList<Integer>(this.queue.size() + q.queue.size());
        for (int i = 0, j = 0; i < this.queue.size() || j < q.queue.size();){
            if (i < this.queue.size())
                mergedQ.add(this.queue.get(i++));
            if (j < q.queue.size())
                mergedQ.add(q.queue.get(j++));
        }
        this.queue = mergedQ;
   }
} 
```

这是输出：

```
[1, 2, 3, 4, 11]
[5, 6, 7, 8, 9, 10, 12]
[1, 5, 2, 6, 3, 7, 4, 8, 11, 9, 10, 12]
[5, 6, 7, 8, 9, 10, 12] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:26:53.913

这就是合并 q1 + q2 => q3 交错元素的方法：

```
 Queue<Integer> q1 = new ArrayDeque<>(Arrays.asList(1,2,3,4,11));
    Queue<Integer> q2 = new ArrayDeque<>(Arrays.asList(5,6,7,8,9,10,12));
    Queue<Integer> q3 = new ArrayDeque<>();
    Iterator<Integer> i1 = q1.iterator();
    Iterator<Integer> i2 = q2.iterator();
    for(;;) {
        if (i1.hasNext()) {
            q3.add(i1.next());
        }
        if (i2.hasNext()) {
            q3.add(i2.next());
        }
        if (!i1.hasNext() && !i2.hasNext()) {
            break;
        }
    }
    System.out.println(q3); 
```

注意：新的 ArrayDeque<> 是 Java 7 的特性

# jquery - jQuery加载后重新声明函数的必要性

> ID：13502254
> 
> 赞同：0
> 
> 时间：2012-11-21T21:22:50.097
> 
> 标签：jquery

我对 jQuery 的`load()`. 这是我的代码：

```
 $('nav#pagination ul li a').live('click', function() {

        var url = $(this).attr('href');

        $(this).parent('li').parent('ul').parent('nav').fadeOut('fast',function() {
            $(this).load(url + ' nav#pagination > *', function() {
                $(this).fadeIn();
            })
        })

        return false;
    }) 
```

HTML：

```
<div class="block" id="onShelf">
        <header class="prefix_1">
            <h2>Na półce</h2>
        </header>
        <div class="inner prefix_1 suffix_1">
            ## normal text ##
            <div class="clear"></div>
            <nav id="pagination" class="clearfix">
                <ul>
                <li><b>1</b></li>
                <li><a href="/page/8"5px;">2</a></li>
                <li><a href="/page/16"5px;">3</a></li>
                <li><a href="/page/24"5px;">4</a></li>
                <li><a href="/page/32"5px;">5</a></li>
                <li><a href="/page/40"5px;">6</a></li>
                <li><a href="/page/8"5px;">→&lt;/a></li>
                </ul>
            </nav>
        </div>
    </div> 
```

当我单击其中一个链接时，它可以工作，但只有一次。它不再起作用，并且不会在加载的内容中加载任何脚本。我必须在加载后重新声明里面的每个函数。我能做些什么来省略这个，嗯，不优雅的解决方案？

我试过了`live`，`click`和。`delegate``bind`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T07:12:44.860

尝试使用类似的东西

```
$(body).on('click', 'nav#pagination ul li a', function () {
    your code here
}); 
```

您可以使用任何不可刷新的元素代替正文

# java - JFrame 布局问题，面板应该在顶部但在中间

> ID：13502255
> 
> 赞同：1
> 
> 时间：2012-11-21T21:22:50.260
> 
> 标签：java, swing, jframe, jpanel, layout-manager

我有两个 JPanel，我应该在左上角，但由于某种原因，它们位于 y 轴的一半（但仍然在左边，所以 x 轴为 0）。无论如何，我都会在这里发布我的代码，我认为这样更容易理解我的问题。提前感谢您的帮助。

```
 JFrame scrabbleBoard = new JFrame();                              
    scrabbleBoard.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);     

    Container topPane = scrabbleBoard.getContentPane();               
    topPane.setLayout(new BoxLayout(topPane, BoxLayout.X_AXIS));   

    JButton done = new JButton ("Done");                              
    JLabel player1 = new JLabel ("Player 1");

    topPane.add(player1);        
    topPane.add(done);        

    scrabbleBoard.pack();
    scrabbleBoard.setVisible(true); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:26:37.710

采用：

```
done.setAlignmentY(Component.TOP_ALIGNMENT);
player1.setAlignmentY(Component.TOP_ALIGNMENT); 
```

请参阅：[修复对齐问题](http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html#alignment)

# c++ - 故意崩溃的代码

> ID：13502256
> 
> 赞同：6
> 
> 时间：2012-11-21T21:22:54.970
> 
> 标签：c++, coding-style, crash, assert

> **可能重复：**
> [使 C++ 程序崩溃的最简单方法是什么？](https://stackoverflow.com/questions/8481783/what-is-the-easiest-way-to-make-a-c-program-crash)

我经常在我们的代码库中看到一个结构，程序以某种方式进入无效状态，代码会故意做一些错误的事情，只是为了强制崩溃。它通常是这样的：

```
if(<something is wrong>)
{
    int *ptr = NULL;
    *ptr = 0;
} 
```

这当然会导致空引用异常并以不可恢复的方式使程序崩溃。我只是想知道这是否真的是最好的方法？首先，它读起来不好。如果没有评论，您可能不会意识到这里发生的崩溃是故意的。其次，几乎没有办法从中恢复。它不会抛出异常，因此无法由其他代码处理。它只是杀死程序而无法回溯。它也没有提供太多关于*为什么*它必须在这里崩溃的线索。它会在所有构建中崩溃，不像断言。（我们确实有一个非常强大的断言系统可用，但它并不总是在这种情况下使用。）

这是我们到处都在使用的风格，我无法试图说服任何人。我只是好奇这在行业中有多普遍。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:26:10.153

您不能以故意的方式“崩溃”程序，因为根据其定义，崩溃是程序*出错*并且无法确定性地运行时。

终止执行的标准方法是通过`std::terminate`；实现这一点的常用方法是调用`std::abort`，它会针对进程发出不可阻塞的信号（`std::terminate`自动导致），并且还会导致许多操作系统产生核心转储。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:24:02.313

您应该抛出一个异常，这基本上是故意以受控方式导致崩溃。[这是一个在这个问题](https://stackoverflow.com/questions/134569/c-exception-throwing-stdstring)的帮助下的例子。

```
throw string("something_went_wrong"); 
```

更好的是错误被捕获或修复。断言也是一个不错的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T22:15:54.157

我想这是在您不调试的情况下触发核心转储的方法。然后核心转储会为您提供足够的信息来分析问题。在“程序员错误”（或错误）的情况下，这比抛出异常要好，因为堆栈展开不允许您构建合理的核心转储。可以通过调用 std::terminate 以更优雅的方式实现类似的效果，该 std::terminate 先前已注册（使用 std::set_terminate）生成核心转储或类似内容的函数。有关更详细的说明，请参阅[本文](http://akrzemi1.wordpress.com/2011/10/05/using-stdterminate/)。

# php - 数据库表不会用 Mysqli 更新

> ID：13502258
> 
> 赞同：2
> 
> 时间：2012-11-21T21:23:17.867
> 
> 标签：php, mysql

所以我在 php 中通过 mysqli 更新 mysql 表时遇到问题。

数据库连接和类：

```
<?php
class testDB extends mysqli {
    private static $instance = null;

    private $user = "tester";
    private $pass = "tester01";
    private $dbName = "testdb";
    private $dbHost = "localhost";

 public static function getInstance() {
   if (!self::$instance instanceof self) {
     self::$instance = new self;
   }
   return self::$instance;
 }

 public function __clone() {
   trigger_error('Clone is not allowed.', E_USER_ERROR);
 }
 public function __wakeup() {
   trigger_error('Deserializing is not allowed.', E_USER_ERROR);
 }

private function __construct() {
    parent::__construct($this->dbHost, $this->user, $this->pass, $this->dbName);
    if (mysqli_connect_error()) {
        exit('Connect Error (' . mysqli_connect_errno() . ') '
                . mysqli_connect_error());
    }
    parent::set_charset('utf-8');
}

public function verify_credentials ($username, $password){
   $username = $this->real_escape_string($username);
   $password = $this->real_escape_string($password);
   $result = $this->query("SELECT 1 FROM users WHERE user_username = '" . $username . "' AND user_password = '" . $password . "'");
   return $result->data_seek(0);
}

public function get_vitae() {
    return $this->query("SELECT * FROM vitae");

public function update_vitae($text, $id) {
    $text = $this->real_escape_string($text);
    $this->query("UPDATE vitae SET vitae_text=".$text." WHERE vitae_id = ".$id);
}
}
?> 
```

这是页面代码：

在标题上方，我们通过确保会话启动来检查登录；然后导入数据库类，其余部分在将表单重新提交到同一页面时调用：

```
<?php
session_start();
if (!array_key_exists("username", $_SESSION)) {
    header('Location: index.php');
    exit;
}

require_once("includes/db.php");

$vitae_empty = false;

if ($_SERVER['REQUEST_METHOD'] == "POST") {
    if ($_POST['text'] == "") {
        $vitae_empty = true;
    } else if ($_POST["text"]!="") {
        testDB::getInstance()->update_vitae($_POST["text"], $_POST["id"]);
        header('Location: manage.php' );
        exit;
 } 
}

?> 
```

在正文中（标题和 html 的其余部分通过“require_once”导入）：

```
 <section>
        <div class="grid_3 header_line"><h2>Update for CV</h2></div>
        <div class="grid_3">
            <?php
            $result = testDB::getInstance()->get_vitae();
            $vitae = mysqli_fetch_array($result);                
            ?>

            <form name="editvitae" action="editvitae.php" method="POST">

                <textarea name="text" rows="50" cols="100"><?php echo $vitae['vitae_text'];?></textarea><br/>
                <?php if ($vitae_empty) echo "Please enter some text.<br/>";?>

                <input type="hidden" name="id" value="<?php echo $vitae["vitae_id"];?>" /> <br/>
                <input type="submit" name="savevitae" value="Save Changes"/>
            </form>
        </div>
        <div class="grid_3">
            <p><a href="manage.php">&lsaquo; back to management consol</a></p>
        </div>
    </section> 
```

在'body'标签之后：

```
<?php mysql_free_result($result);?> 
```

如您所见，这会从数据库中提取“简历”文本，然后将其循环到同一页面并进行更改以更新表格。它还检查“文本”框是否为空。

此代码适用于另一个应用程序；我不明白为什么它在这里不起作用。并且在您开始警告我有关注入和安全性之前，我已经删除了大部分内容，试图找到更新的问题。一旦我弄清楚了，它就会回来。

我试过剥离文本检查；不同的变量名；在更新数据库之前将帖子值转储到数组中；将帖子值放入静态变量中；检查我所有的拼写等...

我错过了一些东西，我觉得它会很简单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T03:35:01.900

```
$result = $this->query("SELECT 1 FROM users WHERE user_username = '" . $username . "' AND user_password = '" . $password . "'"); 
```

小心使用逻辑 AND 进行用户身份验证。在使用任何类型的密码之前先完全验证用户名可能更明智。我这样说是关于人们插入的许多例子——; WHERE 1=1 - 和*类似*的东西（但不是特别是这个声明）。当然，这可能需要两次查询，但至少您只需处理一条信息即可确定访问者是否有效。另一个优点可能是节省处理，因为您不必在应用程序或数据库中处理散列/加密用户密码（直到用户名已被验证）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:06:31.230

所以答案确实很简单。正如安德鲁西建议的那样，这是我对更新字符串的转义。这是修复它的更新：

```
public function update_vitae($text, $id) {
    $text = $this->real_escape_string($text);
    $this->query("UPDATE vitae SET vitae_text = '$text' WHERE vitae_id = ".$id);
} 
```

谢谢您的帮助！

我已经设计网站将近 10 年了，但我现在才开始使用“真正的”php 编码，而不是使用准备好的类和 Dreamweaver 的内置函数。要学习的东西很多，但在我有限的业余时间里很有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:26:33.743

任何时候`UPDATE`通过 mysqli 运行你都需要运行该`$mysqli->commit();`方法。

你的新`update_vitae`将是：

```
public function update_vitae($text, $id) {
    $text = $this->real_escape_string($text);
    $this->query("UPDATE vitae SET vitae_text=".$text." WHERE vitae_id = ".$id);
    $this->commit;
} 
```

mysqli 还有一个自动提交功能，可以打开或关闭：

```
$this->autocommit(true); //on
$this->autocommit(false); //off 
```

# java - 我的 JsonReader 类在不打印任何输出的情况下终止

> ID：13502260
> 
> 赞同：0
> 
> 时间：2012-11-21T21:23:29.003
> 
> 标签：java, android, json, bufferedreader

我正在使用以下类来读取某个 URL 上的 JSON 文件并从中创建一个 JSONObject。在屏幕上输出某些内容时，程序会终止，控制台中没有任何内容。这是代码：

```
public class JsonReader {

  private static String readAll(Reader rd) throws IOException {
    StringBuilder sb = new StringBuilder();
    int cp;
    while ((cp = rd.read()) != -1) {
      sb.append((char) cp);
    }
    return sb.toString();
  }

  public static JSONObject readJsonFromUrl(String url) throws IOException, JSONException {
    InputStream is = new URL(url).openStream();
    try {
      BufferedReader rd = new BufferedReader(new InputStreamReader(is, Charset.forName("UTF-8")));
      String jsonText = readAll(rd);
      JSONObject json = new JSONObject(jsonText);
      return json;
    } finally {
      is.close();
    }
  }

  public static void main(String[] args) throws IOException, JSONException {
      System.out.println("in main!");
    JSONObject json = readJsonFromUrl("http://somesubdomain.domain.com/blabla.json");
    //System.out.println(json.get("id"));
  }
} 
```

这真的很奇怪，因为它似乎甚至没有进入 main 方法。我刚刚验证了 JSON 文件，没有任何问题。有人知道吗？谢谢。

***编辑：我发现这在一个项目中是独立的。这只发生在 Android 项目的主包中。***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:55:19.463

这是一个安卓项目吗？安卓项目没有`public static void main(...)`。你需要把它放在一个`Activity`.

# java - 当 Iterator 不支持 remove() 时如何动态修剪 Java List？

> ID：13502262
> 
> 赞同：0
> 
> 时间：2012-11-21T21:23:32.297
> 
> 标签：java, list, iterator

我有以下代码：

```
Widget[] widgetArray = widgetService.getAllWidgets();
List<Widget> widgets = Arrays.asList(widgetArray);

// Prune out any Widgets named "Melvin".
Iterator<Widget> iter = widgets.iterator();
while(iter.hasNext()) {
    Widget w = iter.next();

    if("Melvin".equals(w.getName()))
        iter.remove();
} 
```

当我运行此代码时，我得到一个运行时`java.lang.UnsupportedOperationExceptionError`，其中包含一条模糊的异常消息，`null`该消息被抛出`iter.remove()`。好像有些Java`Iterators`不支持这个`remove`方法，会抛出这个异常。

我无法更改`widgetService.getAllWidgets()`返回 a 的方法，并且被数组返回值`List<Widget>`卡住了。`Widget[]`

所以我问：我能做些什么来循环遍历我的`widgets`数组并动态删除那些名为“ *Melvin* ”的数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:32:45.207

如果您负担得起，只需制作列表的可变副本。代替

```
List<Widget> widgets = Arrays.asList(widgetArray); 
```

和

```
List<Widget> widgets = new ArrayList<Widget>(Arrays.asList(widgetArray)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:28:00.487

只需推迟删除，直到迭代器完成：

```
Widget[] widgetArray = widgetService.getAllWidgets();
List<Widget> widgets = Arrays.asList(widgetArray);

// Prune out any Widgets named "Melvin".
List<Widget> toRemove = new ArrayList<Widget>();
Iterator<Widget> iter = widgets.iterator();
while(iter.hasNext()) {
    Widget w = iter.next();

    if("Melvin".equals(w.getName()))
        toRemove.add(w);
}
widgets.removeAll(toRemove); 
```

或者，只需使用逆逻辑从符合条件的小部件构建列表：

```
List<Widget> widgets = new ArrayList<Widget>();
// Add all Widgets not named "Melvin"
for (Widget w : widgetService.getAllWidgets()) {
    if(!"Melvin".equals(w.getName()))
        widgets.add(w);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T21:32:14.197

该`asList()`列表仍然由数组支持。

您可能希望遍历数组的每个元素并将其添加到一个全新的列表中。这需要两个循环。

或者更好的是，比较字符串值，然后添加到列表中。这样，您就有了一个循环和一个全新的列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T21:35:27.367

使用[guava](http://code.google.com/p/guava-libraries/)，您可以摆脱所有这些代码，让一个快速、经过良好测试的库为您处理它。

```
Collection<Widget> noMelvins = Collections2.filter( Arrays.asList(widgetArray), new Predicate<Widget>() {
    @Override public boolean apply( final Widget arg) {
        return !"Melvin".equals(arg.getName());
    }
}); 
```

# actionscript-3 - AS3 - 将图像缩放到全宽或全高而不切断

> ID：13502263
> 
> 赞同：1
> 
> 时间：2012-11-21T21:23:35.033
> 
> 标签：actionscript-3, scale

我需要在保持 AS3 中的纵横比的情况下缩放图像。它应该被缩放到完整的舞台大小，但不应该被切断。

怎么做？

谢谢你，乌利

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T22:47:29.597

像这样的东西应该工作：

```
// set the scale to fit the width of the image to the width of the stage     
var scale:Number =  stage.stageWidth / myImage.width;

// if the height of the image will be taller than the stage,
// set the scale to fit the height of the image to the height of the stage
if(myImage.height * scale > stage.stageHeight){
    scale = stage.stageHeight / myImage.height;
}   

// apply the scale to the image
myImage.scaleX = myImage.scaleY = scale; 
```

# django - 递归查询：将一个字段与同一类的另一个字段进行比较

> ID：13502268
> 
> 赞同：2
> 
> 时间：2012-11-21T21:23:56.357
> 
> 标签：django

我有一个类似于这个的模型：

```
class Trip(models.Model):
    departure = models.DateTimeField()
    arrival = models.DateTimeField() 
```

我想进行一个查询，返回到达时间至少比出发时间晚 2 小时的对象。

```
Trip.objects.filter(arrival__gt = "departure" + timedelta(hours=2)) 
```

这甚至可能吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:01:38.180

您正在寻找[引用模型字段的过滤器](https://docs.djangoproject.com/en/dev/topics/db/queries/#filters-can-reference-fields-on-the-model)

> 但是，如果您想将模型字段的值与同一模型上的另一个字段的值进行比较怎么办？

请参阅此示例：

```
>>> from datetime import timedelta
>>> Entry.objects.filter(mod_date__gt=F('pub_date') + timedelta(days=3)) 
```

对于您的情况：

```
from django.db.models import F
Trip.objects.filter(arrival__gt = F('departure') + timedelta(hours=2)) 
```

# java - Get the top level category of a checkin/venue

> ID：13502274
> 
> 赞同：0
> 
> 时间：2012-11-21T21:24:26.893
> 
> 标签：java, switch-statement, foursquare

Is there a way to retrieve the top level category e.g Arts & Entertainment when i get all Checkins from a user?

my only idea is to do this manually with a huge switch-case including every subcategory. somebody got a hint or a better idea to do this?

any ideas are welcome

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T22:13:57.147

Use the venues/categories endpoint to get a tree of all the categories. Then, use this to build a mapping from all categories to their corresponding top level category

# regex - Perl 正则表达式 - 为什么正则表达式 /[0-9\.]+(\,)/ 匹配逗号

> ID：13502277
> 
> 赞同：2
> 
> 时间：2012-11-21T21:24:33.130
> 
> 标签：regex, perl

以下似乎匹配`,` 有人可以解释为什么吗？

我想匹配多个以逗号结尾的数字或点。

```
 123.456.768,
 123,
 .,
 1.2, 
```

但是执行以下操作`,`也会意外打印

```
my $text = "241.000,00";
foreach my $match ($text =~ /[0-9\.]+(\,)/g){
    print "$match \n";
}
print $text; 

# prints 241.000,
#        , 
```

**更新：**
逗号匹配，因为： `In list context, //g returns a list of matched groupings, or if there are no groupings, a list of matches to the whole regex` 如此处定义[。](http://perldoc.perl.org/perlrequick.html#More-matching)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:35:16.477

您在 foreach 循环中的匹配项在列表上下文中。在列表上下文中，匹配返回其捕获的内容。Parens 表示捕获，而不是整个正则表达式。你在逗号周围有括号。你想要它反过来，把括号放在你想要的位置。

```
my $text = "241.000,00";

# my($foo) puts the right hand side in list context.
my($integer_part) = $text =~ /([0-9\.]+),/;

print "$integer_part\n";  # 241.000 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T21:36:04.963

使用[零宽度正向预测断言](http://perldoc.perl.org/perlre.html#Look-Around-Assertions)从匹配本身中排除逗号：

```
$text =~ /[0-9\.]+(?=,)/g 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T21:35:26.430

如果您不想匹配逗号，请使用前瞻断言：

```
/[0-9\.]+(?=,)/g 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-21T22:20:14.580

你抓错东西了！将括号从逗号周围移动到数字周围。

```
$text =~ /([0-9\.]+),/g 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T21:49:14.613

您可以用前瞻替换逗号，或者完全排除逗号，因为它不是您要捕获的内容的一部分，在这种情况下不会有任何区别。但是，该模式将逗号而不是数字放入捕获组 1，然后甚至不被捕获组引用，而是返回整个匹配项。

这是检索捕获组的方式：

```
$mystring = "The start text always precedes the end of the end text.";
if($mystring =~ m/start(.*)end/) {
    print $1;
} 
```

# javascript - Javascript 使用不同的变量同时运行一个函数

> ID：13502279
> 
> 赞同：1
> 
> 时间：2012-11-21T21:24:47.833
> 
> 标签：javascript, jquery, html, css, function

抱歉标题混乱，我会解释得更好。我有一个 20x20 的 div 网格，所以它有 400 个，每个都有一个 id，从 0 到 399。

每个 div 被赋予三个随机值之一 - 红色、绿色或蓝色 - 当单击 div 时，将运行一个函数来检查左侧、右侧、上方和下方的 div 是否具有相同的值，如果是相同的值将模拟一次点击，相同的功能将再次运行。

问题在于该函数设置了 vars，所以如果它发现下面的 div 具有相同的值，它将覆盖第一次单击设置的 vars，因此永远不要单击其他任何一个。

JSfiddle - [http://jsfiddle.net/5e52s/](http://jsfiddle.net/5e52s/)

这是我所拥有的：

```
<!DOCTYPE html>  
<html lang="en">  
<head>
    <meta charset="utf-8"/>
    <title>untiteled</title>
    <style>
        body {
            width: 420px;
        }
        .box {
            width: 19px;
            height: 19px;
            border: 1px solid #fafafa;
            float: left;
        }

        .box:hover {
            border: 1px solid #333;
        }

        .clicked {
            background: #bada55 !important;
        }

    </style>

    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>

        $().ready(function(){
            var colors = ['red', 'green', 'blue'];
            var i = 0;
            while(i<400){
                var color = colors[Math.floor(Math.random() * colors.length)];
                $('.test').append('<div class="box" id="'+i+'" value="'+color+'" style="background:'+color+';">'+i+'</div>');
                i++;
            }

            $('.box').click(function(){
                var t = $(this);
                t.addClass('clicked');
                id = t.attr('id');
                val = t.attr('value');

                //Set color

                up = parseInt(id) - 20;
                right = parseInt(id) + 1;
                down = parseInt(id) + 20;
                left = parseInt(id) - 1;
                clickup = false;
                clickdown = false;
                if($('#'+down).attr('value') === val){
                    clickdown = true;
                }
                if(up > -1 && ($('#'+up).attr('value') === val)){
                    clickup = true;
                }

                if(clickdown == true){
                    $('#'+down).click();
                }
                if(clickup == true){
                    $('#'+up).click();
                }

            });
        });

    </script>
</head>
<body>
    <div class="test">

    </div>      
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T19:15:23.220

我认为您的问题的最大根本原因是您没有检查它是否已经有“点击”类。这可以使无限递归。例如，如果您单击 div#2，则 div#1 会收到模拟点击，而 div#2 会收到来自 div#1 的模拟点击。

```
$('.box').click(function(){
    var t = $(this);
    if(t.hasClass('clicked')) {
        return;
    }

    t.addClass('clicked');
    var id = t.attr('id');
    var val = t.attr('value');

    //Set color

    var up = parseInt(id) - 20;
    var right = (id%20 != 19) ? ((0|id) + 1) : 'nothing' ;
    var down = parseInt(id) + 20;
    var left = (id%20 != 0) ? ((0|id) - 1) : 'nothing';

    console.log(up, right, down, left);

    if($('#'+down).attr('value') === val) {
       $('#'+down).click();                    
    }
    if($('#'+right).attr('value') === val) {
       $('#'+right).click();                    
    } 
    if($('#'+up).attr('value') === val) {
       $('#'+up).click();                    
    }
    if($('#'+left).attr('value') === val) {
       $('#'+left).click();                    
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:29:50.817

您可以将点击安排到事件循环上，而不是直接调用它们，例如：

```
 if(clickdown == true){
                setTimeout(function () {
                  $('#'+down).click();
                });
            } 
```

我不认为这是你的根本原因，它可能是全局变量和范围问题的组合。尝试重新格式化：

```
$('.box').click(function (event){
    var t = $(this), id, val, up, right, down, left, clickup, clickdown;
    //... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:09:24.300

您的变量`id`并且`val`不在`var`语句中，因此被隐式创建为`window`对象的成员，而不是局限于本地函数。将每行之前的分号更改为逗号，以便它们成为 var 语句的一部分，您的代码应该开始工作。

# javascript - 更改表格的边框而不导致表格调整大小

> ID：13502281
> 
> 赞同：3
> 
> 时间：2012-11-21T21:25:03.977
> 
> 标签：javascript, html, css, html-table, hover

我之前问过一个[问题](https://stackoverflow.com/questions/13496559/how-can-a-html-table-highlight-columns-by-changing-the-border-on-hover)，关于使用`JavaScript`和 `CSS. 我很难确保表格的边框看起来不错。

例如，在我的表格边框中，我将边距设置为`0`. 当悬停在一列上时，增加的边框大小会导致整个表格稍微“跳跃”。为了防止这种情况，我尝试调整表格单元格的大小，但这并没有什么不同。

![在此处输入图像描述](../Images/6d9098e9f2609c466e60bc8748b8e152.png) ![在此处输入图像描述](../Images/95b29fc07e718baffe9208ec74d1a9e8.png)

我在这里用 JSFiddle 说明问题：http: [//jsfiddle.net/grNr8/6/](http://jsfiddle.net/grNr8/6/)。在这些图像中很难看到，但希望小提琴能说明问题。

我`CSS`的如下：

```
table, td {
    background-color: white;   
    border: 0px solid white;
    border-collapse: collapse;   
} 
```

突出显示该列时，`2`选择像素厚度的边框。我尝试尝试使用`$('td').css({height: '29px'});`（并从 变化`26 - 29`）更改单元格大小，但它不会改变效果。`Javascript`我用来强调的主要是基于对我之前问题的回答：

```
$('td').hover(function() {
    var t = parseInt($(this).index()) + 1;
    $('td:nth-child(' + t + ')').first().addClass('highlightedTop');
    $('td:nth-child(' + t + ')').addClass('highlighted')
    $('td:nth-child(' + t + ')').last().removeClass('highlighted').addClass('x');

    $('td').css({
        height: '39px'
    });

    if (t > 1) {
        var t1 = t - 1;
        $('td:nth-child(' + t1 + ')').addClass('highlightedPrev');
        $('td:nth-child(' + t1 + ')').last().removeClass('highlightedPrev');

    }
}, function() {
    var t = parseInt($(this).index()) + 1;
    $('td:nth-child(' + t + ')').removeClass('highlighted ');
    $('td:nth-child(' + t + ')').first().removeClass('highlightedTop');
    $('td:nth-child(' + t + ')').last().removeClass('highlightedBottom');
    $('td:nth-child(' + t + ')').last().removeClass('x');
    if (t > 1) {
        var t1 = t - 1;
        $('td:nth-child(' + t1 + ')').removeClass('highlightedPrev');
    }
});​ 
```

是否可以调整单元格的大小以获得更流畅的查看，或者我应该使用不同的方法？我尝试过使用白色边框厚度，`1px`但最终在角落处出现奇怪的连接，在四肢处出现不对称边框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:47:56.703

如果轮廓不适合您，在默认状态下使用 2px 实心透明边框也可以：

```
table, td {
    background-color: white;   
    border: 2px solid transparent;
    border-collapse: collapse;   
} 
```

[http://jsfiddle.net/grNr8/7/](http://jsfiddle.net/grNr8/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:37:56.860

你能用一个看起来像边框的透明png覆盖悬停时的表格单元格吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T21:38:26.570

在 TD 中放置一个 DIV 并设置 DIV 的样式。您可以操纵 DIV 的大小以允许边框，而不能用于表格单元格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T21:58:53.880

如果你没有边框并添加边框，事情就会变得一团糟。相反，如果你*确实有*一个边框并*改变它的颜色*，结果会好得多。至少可以说，没有跳跃。如果您的 JSFiddle 示例代表了您真正想要做的事情（即纯色 td），那就是我会做的。

```
.a{background-color: red; border: 2px solid red; }
.b{background-color: green; border: 2px solid green;}
.c{background-color: orange; border: 2px solid orange;} 
```

查看完整示例：http: [//jsfiddle.net/grNr8/9/](http://jsfiddle.net/grNr8/9/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T22:00:13.080

在我看来，最简单的方法是始终使用边框并且只更改颜色。解决方案非常简单，我想我错过了问题的一些细节：

**[小提琴](http://jsfiddle.net/nakVN/1/)**

```
.a{
    background-color: red;
    border: 2px solid red;
}
.b{
    background-color: green;
    border: 2px solid green;
}
.c{
    background-color: orange;
    border: 2px solid orange;
} 
```

# asp.net - 如何指定相对于站点根目录的路径？

> ID：13502282
> 
> 赞同：5
> 
> 时间：2012-11-21T21:25:05.867
> 
> 标签：asp.net

我想指定相对于网站根目录的文件路径。例如

```
<script type="text/javascript" src="/Scripts/jquery-1.7.2.min.js"></script> 
```

在 ASP.net 中，这会导致问题，因为**站点**的*“根”*可能与**服务器**的根不同。

 ****例如，在from 路径中指定`src`结果`GET`

```
src="/Scripts/jquery-1.7.2.min.js"
http://localhost:64276/Scripts/jquery-1.7.2.min.js                           404

src="~/Scripts/jquery-1.7.2.min.js"
http://localhost:64276/WebSite/Adminstration/~/Scripts/jquery-1.7.2.min.js   404

src="~Scripts/jquery-1.7.2.min.js"
http://localhost:64276/WebSite/Adminstration/~Scripts/jquery-1.7.2.min.js    404

src="~/Scripts/jquery-1.7.2.min.js" runat="server"
500 Unexpected character '$' 
```

在 ASP.net 中使用 HTML 时如何指定**站点相对路径？**

## 也可以看看

*   [如何在我的 Web 应用程序的 IIS 上设置站点根相对路径（对于 localhost）](https://stackoverflow.com/questions/9700260/how-to-set-the-site-root-relative-path-for-localhost-on-iis-on-my-web-applicat)
*   [ASP.NET 相对路径](https://stackoverflow.com/questions/4571755/asp-net-relative-path)
*   [站点根目录的相对路径](https://stackoverflow.com/questions/7960094/relative-path-from-site-root)
*   [JQuery：Visual Studio，错误 CS1056：意外字符“$”](https://stackoverflow.com/questions/200863/jquery-visual-studio-error-cs1056-unexpected-character)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T21:30:18.777

如果您使用的是 ASP.net MVC，那么`src="~/scripts/blahblah"`应该可以正常工作。

如果你不使用 MVC，那么你需要使用类似的东西：

```
<script src='<%= this.ResolveClientUrl("~/Scripts/jquery-1.7.2.min.js") %>' type="text/javascript"></script> 
```****

# php - jQuery从表单发送消息

> ID：13502283
> 
> 赞同：0
> 
> 时间：2012-11-21T21:25:10.260
> 
> 标签：php, jquery, html

如何将一些消息发送到其他 php 文件？我应该看到“加载”或我输入的结果。我试图找到一些答案，即使这段代码来自这个地方，但仍然不起作用。我有：

```
<form>
something<input name="sthis" type="text" />
<input type="submit" value="submit" id="submit" />
</form>

<script type="text/javascript">

$(function(){
  $('submit').click(function(){
    $('#container').append('loading');
      var sthis = $('#sthis').val();
      $.ajax({
         url: 'form1.php' , 
         type: 'POST',
         data: 'sthis: ' + sthis,
         success: function(result){     
           $('#container').append('<p>' +     result + '</p>')      
         }
      });   
      return false;     
   });
});
});

</script> 
```

Form1.php

```
<?php
$str = $_POST['sthis'];
echo $str;
}

?> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:29:58.383

```
<form id="form1">
<input name="sthis" type="text" />
<input type="button" value="submit" id="submit" />
</form>

<script type="text/javascript">

  $('#submit').click(function(){
    $('#container').append('loading');
      var data = $('#form1').serialize();
      $.ajax({
         url: 'form1.php' , 
         type: 'POST',
         data: data,
         success: function(result){     
           $('#container').append('<p>' +     result + '</p>')      
         }
      });   
      return false;     
   });

</script> 
```

这会将表单中的所有数据发送到 php 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:33:14.727

试试这个，我想应该是这样的

```
 data: {"sthis": sthis}, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:46:31.667

因此，您必须在脚本中更改一些内容：

```
$(function(){
  $(':submit').click(function(event){
    event.stopPropagation();
    $('#container').append('loading');
      var sthis = $('#sthis').val();
      $.ajax({
         url: 'form1.php' , 
         type: 'POST',
        data: {'sthis': sthis},
         success: function(result){     
           $('#container').append('<p>' +     result + '</p>');      
         }
      });   
      return false;     
   });
}); 
```

首先有一个额外的 }); 最后你可以删除。

您的输入字段必须有一个名为 sthis 的 id，而不仅仅是一个名称，因此您可以使用 $("#sthis") 访问它，如下所示：

```
<input name="sthis" type="text" id="sthis" /> 
```

3rd，改变你的数据线，使它看起来像这样：

```
data: {'sthis': sthis}, 
```

此外，要捕获您必须使用 $(':submit') 的按钮事件，请注意：

# android - Android链接如何捕获@mentions #hashtags我们的URL并让他们启动另一个活动

> ID：13502286
> 
> 赞同：0
> 
> 时间：2012-11-21T21:25:16.437
> 
> 标签：android, regex, textview, intentfilter, linkify

我正在尝试制作一个自定义链接类，它将在文本字符串中捕获 twitter #hashtags @mentions 和 URL，并让它启动另一个活动到目前为止，我已经能够找到一些代码，但两个问题是它捕获 URL 和 @提到但没有#hashtags，而不是被另一个活动捕获，我设置了一个意图过滤器，它只是启动浏览器，下面我附上了我的代码，任何帮助都会有很长的路要走

这是我的主要活动

```
TextView textView =  (TextView) findViewById(R.id.tweet);
    String str = "@aman_vivek how are u  #aman_vivek <http://www.google.com> <http://www.tekritisoftware.com>";
    textView.setText(str);
    Pattern wikiWordMatcher = Pattern.compile("(@[a-zA-Z0-9_]+)");
    String wikiViewURL =    "http://www.twitter.com/";
    Linkify.addLinks(textView, wikiWordMatcher, wikiViewURL);

    Pattern wikiWordMatcher1 = Pattern.compile("\\b(https?|ftp|file)://[-a-zA-Z0-9+&@#/%?=~_|!:,.;]*[-a-zA-Z0-9+&@#/%=~_|]");
    Linkify.addLinks(textView, wikiWordMatcher1, null); 
```

这是我的班级的意图过滤器，应该捕捉到意图

```
<activity
        android:name=".DirectMessageActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <category android:name="android.intent.category.DEFAULT" />

            <action android:name="android.intent.action.VIEW" />

            <data android:scheme="http://www.twitter.com/" />
        </intent-filter>
    </activity> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T05:30:48.917

虽然为时已晚，但它可能对其他人有所帮助，[这](http://sourabhsoni.com/implementing-hashtags-in-android-application/)是一篇关于如何在 Android 应用程序中捕获主题标签然后调用另一个活动的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:03:54.807

> 它捕获 URL 和 @mentions 但不捕获 #hashtags

那是因为您没有在代码中做任何事情来捕获主题标签。

> 而不是被另一个活动捕获，我设置了一个意图过滤器，它只是启动浏览器

那是因为`http://www.twitter.com/`它不是一个方案，而您的`<data>`元素声称它是。尝试`http`用于方案和`www.twitter.com`主机。请注意，这意味着您设备上的用户访问 Twitter URL 的任何尝试都会将您的应用程序作为选项打开，这可能会导致他们用霰弹枪追随您。将它们转换为您拥有的其他域可能会更好，以限制可能的冲突。

# salesforce - 哪种访问 SFDC API 的方法可以最快地返回数据？

> ID：13502287
> 
> 赞同：0
> 
> 时间：2012-11-21T21:25:21.517
> 
> 标签：salesforce

我们正在使用 DevArt 连接器，它伪装成 SFDC 的 ADO.NET 连接器。它超级慢（某些查询需要 13 分钟）。什么方法可以最快地返回数据？

他们是否有可能是快速的 SFDC 的 OData API？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T21:43:58.863

您可以使用一些 API：

1.  SOAP API -
    CRUD 操作和查询 (SOQL) 支持。一些元数据支持。有企业和合作伙伴的变体。可以在 Visual Studio 中添加为 Web 服务引用。
2.  REST API

    > “通常，REST API 对较少数量的记录进行操作。您可以使用其 URL 获取单个记录，还可以运行查询并返回一组与该查询匹配的记录。” [Salesforce API——它们是什么以及何时使用它们](http://blogs.developerforce.com/tech-pubs/2011/10/salesforce-apis-what-they-are-when-to-use-them.html)

3.  Bulk API
    REST 启动的批处理输出 XML 或 CSV 数据）

4.  元数据 API
    可能不适用，除非您正在执行配置或部署风格的任务
5.  Apex API
    同样不适用，除非您使用 Apex 类并运行测试用例。
6.  Streaming API
    允许您注册查询并在查询结果更改时将更新推送给您。

他们都有自己的优点和缺点。[Bulk API 介绍](http://www.salesforce.com/us/developer/docs/api_asynch/Content/asynch_api_intro.htm)中有很好的总结。

我猜想 DevArt 连接器是基于 SOAP API 的。SOAP API 可以很快，但它不是带回大量记录的理想方式，因为结果是分页的，并且 SOAP 响应可能很大。其他因素也可能不必要地减慢它，例如查询从未使用过的字段。

ADO.NET 连接器必须对 SOQL 中的查询进行一些解释。翻译成 SOQL 时可能存在效率低下的连接。

我怀疑最好的解决方案将取决于您尝试查询的记录和字段以及您期望使用的结果。

# java - java 游戏 - 光滑 - 碰撞处理

> ID：13502288
> 
> 赞同：0
> 
> 时间：2012-11-21T21:25:22.620
> 
> 标签：java, collision-detection, slick2d, tiles-game

如何管理 slick 中的碰撞？

我创建了地图，每一个墙的瓷砖都有选项blocked = true;

如何实现碰撞，如果我撞到墙，我可以通过它？此外，如果我到达地图边缘，请阻止移动。

```
package javagame;

import org.newdawn.slick.Animation;
import org.newdawn.slick.GameContainer;
import org.newdawn.slick.Graphics;
import org.newdawn.slick.Image;
import org.newdawn.slick.Input;
import org.newdawn.slick.SlickException;
import org.newdawn.slick.state.BasicGameState;
import org.newdawn.slick.state.StateBasedGame;
import org.newdawn.slick.tiled.TiledMap;

public class Play extends BasicGameState {

    Animation movingUp, movingDown, movingLeft, movingRight;
    Animation player;
    int[] duration = {200, 200, 200};
    float playerX = 0;
    float playerY = 0;
    float cameraX;
    float cameraY;
    float screenWidth;
    float screenHeight;
    private TiledMap map = null;
    private static final float SPEED = 0.1f;

    private boolean[][] blocked;

    public Play(int state, int x, int y) {
        playerX = (float) x;
        playerY = (float) y;
    }

    private boolean blocked(float x, float y) {
        return blocked[(int) x][(int) y];
    }

    @Override
    public void init(GameContainer gc, StateBasedGame sbg) throws SlickException {

        map = new TiledMap("map/map.tmx");

        // build a collision map based on tile properties in the TileD map 
        blocked = new boolean[map.getWidth()][map.getHeight()];
        for (int x = 0; x < map.getWidth(); x++) {
            for (int y = 0; y < map.getHeight(); y++) {
                int tileID = map.getTileId(x, y, 0);
                String value = map.getTileProperty(tileID, "blocked", "false");
                if ("true".equals(value)) {
                    blocked[x][y] = true;
                }
            }
        }

        Image[] walkUp = {
            new Image("graphics/player/up0.png"),
            new Image("graphics/player/up1.png"),
            new Image("graphics/player/up2.png")
        };

        Image[] walkDown = {
            new Image("graphics/player/down0.png"),
            new Image("graphics/player/down1.png"),
            new Image("graphics/player/down2.png")
        };
        Image[] walkLeft = {
            new Image("graphics/player/left0.png"),
            new Image("graphics/player/left1.png"),
            new Image("graphics/player/left2.png")
        };
        Image[] walkRight = {
            new Image("graphics/player/right0.png"),
            new Image("graphics/player/right1.png"),
            new Image("graphics/player/right2.png")
        };

        movingUp = new Animation(walkUp, duration, false);
        movingDown = new Animation(walkDown, duration, false);
        movingLeft = new Animation(walkLeft, duration, false);
        movingRight = new Animation(walkRight, duration, false);

        player = movingDown;

    }

    @Override
    public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException {

        screenWidth = gc.getWidth();
        screenHeight = gc.getHeight();

        cameraX = (screenWidth / 2) - (playerX / 2);
        cameraY = (screenHeight / 2) - (playerY / 2);

        map.render((int) playerX, (int) playerY);

        player.draw(cameraX, cameraY);

        g.drawString("X: " + playerX + "\nY: " + playerY, 520, 20);
        g.resetTransform();

    }

    @Override
    public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException {
        Input input = gc.getInput();

        if (input.isKeyDown(Input.KEY_UP) || input.isKeyDown(Input.KEY_W)) {
            player = movingUp;
            playerY += delta * SPEED;
            player.update(delta);
        } else if (input.isKeyDown(Input.KEY_DOWN) || input.isKeyDown(Input.KEY_S)) {
            player = movingDown;
            playerY -= delta * SPEED;
            player.update(delta);
        } else if (input.isKeyDown(Input.KEY_LEFT) || input.isKeyDown(Input.KEY_A)) {
            player = movingLeft;
            playerX += delta * SPEED;
            player.update(delta);
        } else if (input.isKeyDown(Input.KEY_RIGHT) || input.isKeyDown(Input.KEY_D)) {
            player = movingRight;
            playerX -= delta * SPEED;
            player.update(delta);
        }

    }

} 
```

这是示例源代码（NetBeans 项目）：

[https://www.box.com/s/9nicp0n067de632kcpj3](https://www.box.com/s/9nicp0n067de632kcpj3)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:19:16.117

在更新时，您可以简单地检查阵列。如果是墙，请不要更新。如果是边界，请不要更新。

```
@Override
public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException {
    Input input = gc.getInput();
    float yChange = 0, xChange=0;
    boolean capturedInput = false;
    if (input.isKeyDown(Input.KEY_UP) || input.isKeyDown(Input.KEY_W)) {
        player = movingUp;
        yChange += delta * SPEED;
        capturedInput = true;
    } else if (input.isKeyDown(Input.KEY_DOWN) || input.isKeyDown(Input.KEY_S)) {
        player = movingDown;
        yChange -= delta * SPEED;
        capturedInput = true;
    } else if (input.isKeyDown(Input.KEY_LEFT) || input.isKeyDown(Input.KEY_A)) {
        player = movingLeft;
        xChange += delta * SPEED;
        capturedInput = true;
    } else if (input.isKeyDown(Input.KEY_RIGHT) || input.isKeyDown(Input.KEY_D)) {
        player = movingRight;
        xChange -= delta * SPEED;
        capturedInput = true;
    }
    if(capturedInput==true && !blocked(playerX+xChange,playerY+yChange)){
        playerX += xChange;
        playerY += yChange;
        player.update(delta);
    }
}

private boolean blocked(float x, float y) {
    return blocked[(int) x][(int) y];
} 
```

几乎不要更改值，直到您先检查它，然后在一切正常时更改播放器值。

编辑：我添加了一个变量 captureInput，这会让我知道我们实际上有一个 keyDown 事件。对此有两条评论。我认为这是使您的代码工作的“黑客”，而不是最漂亮的。我个人会尝试在窗口中添加一个事件侦听器以侦听按键点击，当点击按键时，我会更改位置信息，一直刷新框架并将更新，或者仅在发生更改后刷新通过调用重绘（）。

有很多教程可以听 onKeyDown。您的代码现在应该可以更好地工作，并且不需要像您所做的那样手动捕获边缘，您应该能够在布尔块数组中的边缘周围画一堵墙，如果没有，您可以继续使用您的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T06:46:09.723

尝试从`X`和`Y`位置乘以瓷砖尺寸创建块的矩形，然后使用该`intersects()`方法验证它是否与您的实体发生冲突，如[wiki Slick](http://slick.cokeandcode.com/wiki/doku.php?id=04_-_slopes_and_collisions)中所述。

我希望这对你有用。

# r - 在将多个文件读入单个数据框时，为每个文件创建自定义列

> ID：13502289
> 
> 赞同：1
> 
> 时间：2012-11-21T21:25:25.300
> 
> 标签：r, file, csv, dataframe, plyr

> **可能重复：**
> [将 CSV 导入 R 时如何生成具有 CSV 名称的列？](https://stackoverflow.com/questions/5186570/when-importing-csv-into-r-how-to-generate-column-with-name-of-the-csv)

我有一组要加载到单个数据框中的文件。我正在阅读的每个文件都具有相同的结构，但行数不同。假设这些文件中的每一个都代表一个参与者，我知道我可以使用下面的代码阅读它们：

```
files <- c("john.csv","fred.csv","nick.csv","alex.csv")
library(plyr)
dfoc <- ldply(files, read.csv, header = T) 
```

现在，我希望能够识别哪些行属于哪个参与者。在将这些文件读入大数据框之前，我想为每个文件添加一个列。我要添加的列的行数等于特定参与者的行数`nrow(john)`。我添加的列应该只包含一个标识符，例如重复文件名`nrow(x)`。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:40:28.170

这就是我要做的。（关键思想是将`id`列的值和刚刚读入的 data.frame 放在一起调用`data.frame()`.R 的回收规则将使`id`列在每种情况下都具有正确的长度。）

```
## Set up a reproducible example
a <- tempfile()
b <- tempfile()
write.csv(head(mtcars, 2), file=a)
write.csv(tail(mtcars, 3), file=b)
fnames <- c(a,b)

## Here's the code you are looking for
do.call(rbind, lapply(fnames, function(X) {
    data.frame(id = basename(X), read.csv(X))})
)
#                 id             X  mpg cyl disp  hp drat    wt  qsec vs am gear carb
# 1 file104862dd45aa     Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
# 2 file104862dd45aa Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
# 3  file1048d9e5764  Ferrari Dino 19.7   6  145 175 3.62 2.770 15.50  0  1    5    6
# 4  file1048d9e5764 Maserati Bora 15.0   8  301 335 3.54 3.570 14.60  0  1    5    8
# 5  file1048d9e5764    Volvo 142E 21.4   4  121 109 4.11 2.780 18.60  1  1    4    2 
```

# java - 弹簧配置

> ID：13502290
> 
> 赞同：3
> 
> 时间：2012-11-21T21:25:30.697
> 
> 标签：java, spring

假设我们在 spring 配置中有一个 bean 定义

```
<bean id="scanningIMAPClient" class="com.acme.email.incoming.ScanningIMAPClient" /> 
```

我真正想要的是 scanIMAPClient 类型为 com.acme.email.incoming.GenericIMAPClient 如果配置的电子邮件服务器是普通 IMAP 服务器和 com.acme.email.incoming.GmailIMAPClient 以防它是 GMAIL 服务器，（因为 gmail行为方式略有不同）GmailIMAPClient 是 GenericIMAPClient 的子类。

我怎样才能在弹簧配置中做到这一点？

有一个包含电子邮件服务器配置的属性文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:31:48.610

Java配置很简单：

```
@Value("${serverAddress}")
private String serverAddress;

@Bean
public GenericIMAPClient scanningIMAPClient() {
    if(serverAddress.equals("gmail.com"))
        return new GmailIMAPClient();
    else
        return new GenericIMAPClient();
} 
```

您可以使用 custom 模拟此行为[`FactoryBean`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/FactoryBean.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:32:00.640

您可以使用编程配置：

```
@Configuration
public class AppConfig {

    @Bean(name="scanningIMAPClient")
    public GenericIMAPClient helloWorld() {
        ...check config and return desired type
    }

} 
```

更多信息[在这里](http://www.springsource.org/javaconfig)。

# ios - 在 Apple 的 SpeakHere 示例中设置 kAudioSessionMode 会导致音量大幅下降。任何解决方法？

> ID：13502293
> 
> 赞同：4
> 
> 时间：2012-11-21T21:25:37.937
> 
> 标签：ios, avaudiosession

每当我使用 VoiceChat 模式时，我自己的应用程序中的音频都太低了，所以作为一个白痴检查，我下载了 Apple 的音频单元编程示例代码 (SpeakHere) 并将 VoiceChat 模式添加到该应用程序。事实证明，问题也在那里发生：在该模式下运行会导致所有内容都达到所需音量的 20% 左右。

在设置 PlayAndRecord 类别之后，我在 SpeakHereController.mm 的第 267 行添加了这段代码：

```
 // set mode -- this results in audio being too soft
    UInt32 mode = kAudioSessionMode_VoiceChat;

    error = AudioSessionSetProperty(kAudioSessionProperty_Mode, sizeof(mode), &mode);
    if (error) printf("couldn't set audio session mode!"); 
```

我正在使用带有 RemoteIO 的 VoiceChat 模式，以便为免提电话使用回声消除；VoiceProcessingIO 可以工作（有点），但旧 iPhone (3GS) 的性能太差了，无法使用——这就是我改用 RemoteIO 的原因。我已确认扬声器路线是正确的。我什至尝试过设置测量模式并手动增加增益——我无法检测到任何改进。

关于在使用 AudioSession 模式时防止大音量下降的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:52:50.637

事实证明，当 VoiceChat 模式设置为确定增益、回声消除等的最佳设置时，会使用 /current/ 音频路由。这意味着如果您要设置特定路由，则需要这样做在设置模式之前 - 不是之后。

按此顺序执行此操作为我解决了音量问题：

*   设置播放和记录
*   设置到扬声器的路线
*   设置模式
*   在我的音频单元中使用 VoiceProcessingIO
*   保持较低的硬件采样率 (8k) 以在 3GS 等旧设备上保持良好的性能

# actionscript-3 - 为什么 Google Chrome 中不显示 Flash as3 中动态加载的图像？

> ID：13502294
> 
> 赞同：4
> 
> 时间：2012-11-21T21:25:40.163
> 
> 标签：actionscript-3, flash, google-chrome, plugins, loader

我正在开发一个 Flash 游戏，其中一些内容可能因网页而异，具体取决于 HTML 参数。不幸的是，当我尝试在 Google Chrome 中加载图像并将位图本身发送到舞台时，什么都没有出现。我已经能够确定这是由于 Chrome 附带的 Pepper Flash 插件造成的，因为它可以与手动安装的 Flash 插件一起使用。

让用户下载他们认为已经拥有的插件只是为了使用我的游戏，这对用户来说将是一件痛苦的事。我的游戏有必要自己访问位图，因为它们会改变颜色。如何解决 Chrome 的 Pepper Flash 插件中的不良行为？

下面是我正在做的一个示例。

```
 private function init(e:Event = null):void 
    {
        removeEventListener(Event.ADDED_TO_STAGE, init);
        // entry point

        //could be any image, as long as image1.jpg is in the images directory relative to the HTML page
        //eventually will be taken from a parameter.
        var url:String = "images/image1.jpg";
        var request:URLRequest = new URLRequest(url);
        loader = new Loader();
        loader.contentLoaderInfo.addEventListener(Event.COMPLETE, loaded);
        loader.load(request);

    }

    private function loaded(e:Event):void
    {
        image = Bitmap(loader.content);
        image.bitmapData.colorTransform(new Rectangle(0, 0, image.bitmapData.width, image.bitmapData.height), new ColorTransform(2, 1, 0.5, 0.25, 10, 10, -10, -10));
        graphics.beginBitmapFill(image.bitmapData);
        graphics.drawCircle(stage.stageWidth/2, stage.stageHeight/2, (image.width + image.height) / 4);
        graphics.endFill();

    } 
```

除了这个示例之外，还会有一些转换，但除非有办法解决这个故障/不受欢迎的功能/错误，否则如果用户没有工作，游戏就无法在普通的谷歌 Chrome 浏览器上正常运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T21:12:46.883

将其推送到服务器上。当您从 localhost 运行时，chrome 具有一些额外的安全性。

# macos - MonoMac 的 System.IO.Ports.SerialPort 的 PortName 值是否正确？

> ID：13502300
> 
> 赞同：2
> 
> 时间：2012-11-21T21:26:13.547
> 
> 标签：macos, serial-port, usb, monomac

我正在尝试将与 Insteon 自动化硬件接口的跨平台应用程序放在一起。在我发现的基于 .Net 的示例中，System.IO.Ports.SerialPort 类用于从基于 RS-232 串行端口的设备和 USB 串行调制解调器读取数据。在 Windows 平台上，串行调制解调器通常被映射到一个虚拟 COM 端口，并且运行一个列表、传入新的 COM 地址并尝试找出 USB 或串行设备连接到哪一个并不难。

不幸的是，在 Mac 上，我完全不合时宜。MonoMac 允许我用更舒适的语言进行编程，但与硬件对话这样低级的东西有点超出我的能力范围。我的初始化代码如下：

```
 private void OpenSerialConnection(string comPort)
    {
        _serialPort = new System.IO.Ports.SerialPort("/dev/ttys1", 19200, System.IO.Ports.Parity.None, 8, System.IO.Ports.StopBits.One);
        _serialPort.Encoding = System.Text.Encoding.Default;
        _serialPort.WriteTimeout = 1000;
        _serialPort.DataReceived += OnDataReceived;
        _serialPort.Open();
    } 
```

代替“comPort”变量所在位置的“/dev/ttsy1”值是我发现的一些示例的一部分，这些示例表明地址可能采用/dev/ttys* 的形式。经过一番搜索，我发现一个 USB 设备可能会注册为“/dev/tty.usbserial*”，但我想知道是否有更优雅的方法来检测我可以在 Mono 中利用的这个值而不是指示用户进入终端并输入“ls /dev/tty.*”并自己输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T17:39:43.937

我对 Mac 上的 Mono 没有任何个人经验，但我认为可以在 Mono 项目中包含和使用 Objective-C 类。假设是这种情况，请查看[ORSSerialPort](http://www.github.com/armadsen/ORSSerialPort)。ORSSerialPortManager 的`-availablePorts`方法将为您提供系统上所有可用串行端口的数组。您还可以注册以在添加/删除端口时接收通知，并且该库还可以轻松打开端口、配置端口​​以及发送和接收数据。

如果没有这样的东西，您必须使用 IOKit 来发现系统上的端口，以及用于打开、配置、读取和写入串行端口的 POSIX API。IOKit 和 POSIX 串行端口 API 是低（ish）级 C API。

# ruby-on-rails - 为此关系创建迁移

> ID：13502304
> 
> 赞同：1
> 
> 时间：2012-11-21T21:26:31.907
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, migration, relationship

一夜之间，我完全忘记了如何为这种类型的关系创建迁移：

我有一个项目表和一个用户表，每个用户都有他们自己创建的项目，用户如何在创建或编辑项目时共享他们创建的项目，所以关系是：

每个项目可能有很多用户并且属于用户，而每个用户有很多项目并且属于一个项目。

问题？

我不知道如何从这个 >.> 进行迁移，因为有人告诉我我需要创建一个新表来规定这种关系。

我刚在想

```
generate migration project_user project_id :int user_id :int 
```

那是对的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:37:51.227

一共需要3个表：users、projects和project_editor_links

您的迁移：

```
create_table :users do |t|
  # user stuff
end

create_table :projects do |t|
  t.references :user
  # project stuff
end

create_table :project_editor_links |t|
  t.references :user
  t.references :project
end 
```

要从命令行生成最后一个表：

```
rails g migration project_editor_links project:references user:references 
```

您的模型应如下所示：

```
class User < ActiveRecord::Base
  has_many :projects
  has_many :project_editor_links
  has_many :edited_projects, :through => :project_editor_links
end

class Project < ActiveRecord::Base
  belongs_to :user
  has_many :project_editor_links
  has_many :editors, :through => :project_editor_links
end

class ProjectEditorLinks < ActiveRecord::Base
  belongs_to :editor, :class_name => 'User', :foreign_key => :user_id
  belongs_to :edited_project, :class_name => 'Project', :foreign_key => :project_id
end 
```

# javascript - How to create a Jquery Plugin with Plugin Methods and Maintaining Chainability?

> ID：13502316
> 
> 赞同：1
> 
> 时间：2012-11-21T21:27:29.470
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins

I am trying to create a Jquery plugin that maintains chainability and has public methods as specified in Jquery [Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring) . The complexity is that it is trying to maintain certain vars that I want the public methods to use.

This is my jsfiddle : [http://jsfiddle.net/badmash69/9cqcj/2/](http://jsfiddle.net/badmash69/9cqcj/2/)

```
javascript code :

(function($){

  var methods = {
    init : function( options ) {
      this.options = options;
    }
  , add_that: function (elem) {

      $(this).append(elem);
      return (this);
    }
  , show_parent: function(){
      // this is a simple test to see if the plugin vars are accessible
      alert("parent id=" + $(this).parentId)
    }              
  , add_this: function (elem) {
      return methods.add_that.apply(this,elem);
    }
  };

  $.fn.test = function (method) { 
        var args = method;
        var argss = Array.prototype.slice.call(args, 1);      

      return this.each(function(){

          var $this = $(this);
          if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
      return methods.init.apply( this, arguments );
    } else {
      $.error( 'Method ' + method + ' does not exist on jQuery.test' );
    }          

          var element = $(this);
          var parentId= element.parent().attr("id")

      });       

  };

})(jQuery);

$('#test').test('add_this',$('<div>Hello World d</div>'));

$('#test').test('show_parent');
​ 
```

Html Code

```
<div id="holder">
<div id="test"></div>
</div> 
```

I cant figure out what I am doping wrong here . How can I make it work ? I would deeply appreciate any help .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:12:07.403

the way that I do this is using the $.data, you can have specific object local vars, "public"/"private" methods, etc. here goes an small example in how I will do it

```
(function($){
      var myTestMethods = function() {
          // local variables
          var last_added;

          // local "private" methods 
          var init=function(options) {
              this.options = options;
              last_added = null;
              return this;
          };

          var add_that=function(elem) {
              last_added = elem;
              this.append(elem);
              return this;
          };

          var show_parent=function() {
              alert("parent id=" + this.parent().attr('id'));
          }

          return { // this are your obj "public" methods
                 // notice we are not listing add_that method, therefore this method will be a "private" method
            init : init,
            show_parent: show_parent, // you can publish a private method
            get_last_added: function(){
              return last_added; // you can access local variables
            }, 
            add_this: function (elem) {
              return add_that.apply(this, elem);  // you can also run local methods
            }
          }
      };

      $.fn.test = function (method) {
          var obj_data = this.data('myTestData');
        if (typeof(obj_data) != "undefined") {
          if ( obj_data[method] ) {
            return obj_data[method].apply( this, Array.prototype.slice.call( arguments, 1 ));
          }else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.test' );
          }
        } else {
          if (typeof(method) === 'object' || ! method) {
            obj_data = myTestMethods();
            this.data('myTestData', obj_data);
            return obj_data.init.apply(this, arguments);
          }
        }
      };

    })(jQuery);

    $('#test').test(); //init

    $('#test').test('add_this',$('<div>Hello World d</div>'));
    $('#test').test('show_parent'); 
```

this code has small tests so there may be small bugs, but this will show you the basic idea in how to do what you want.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:15:20.897

Take a look at this demo: [http://jsfiddle.net/9cqcj/11/](http://jsfiddle.net/9cqcj/11/)

As they suggest, to keep data you should better use `.data`:

```
 return this.each(function(){          
          var $this = $(this);
          $this.data("parentId",$this.parent().attr("id"));
.... 
```

(assuming that you need parentId of each element in set)

Also, you have a problem with calling your methods:

```
 return this.each(function(){

          var $this = $(this);
          if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 )); 
```

Last line, `arguments` - arguments of function passed to `.each` is used. In order to get original arguments save them into variable before calling a method:

```
$.fn.test = function (method) { 
        var args = arguments;      
      return this.each(function(){          
          var $this = $(this);
          $this.data("parentId",$this.parent().attr("id"));
          if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( args , 1 )); 
```

See arguments replaced with args in last line.

Also, when you are using `.apply`, second parameter should be an array:

```
return methods.add_that.apply(this, [elem]); 
```

In case like this:

```
return methods.add_that.apply(this, elem); 
```

You can get unexpected problems. For instance, try to replace `elem` with simple string `"test"` and see what you will get in console. Or if you will pass jQuery object, you will get DOM object in called method

# c++ - 为什么 QPainter 可能会拒绝在paintEvent 中工作？

> ID：13502317
> 
> 赞同：5
> 
> 时间：2012-11-21T21:27:31.610
> 
> 标签：c++, qt, user-interface, paintevent

我有：

```
class QTextEditEnter : public QTextEdit
{
    Q_OBJECT
public:
    QTextEditEnter( QWidget *_parent ) : QTextEdit(_parent)
    {
        this -> setFrameStyle( QFrame::Sunken ); // Sunken!
    }

protected:
    virtual void keyPressEvent(QKeyEvent * event);
    virtual void paintEvent(QPaintEvent *_event)
    {
        QTextEdit::paintEvent( _event );
        QPainter pnt(this);
        pnt.setPen( QColor( 0, 0, 0, 0xff ));
        pnt.drawRect( 0, 0, width(), height());
    }

    signals:
        void signalPressEnter();
}; 
```

这给出了：

```
QPainter::begin: Widget painting can only begin as a result of a paintEvent
QPainter::setPen: Painter not active
QPainter::drawRects: Painter not active
QPainter::begin: Widget painting can only begin as a result of a paintEvent
QPainter::setPen: Painter not active
QPainter::drawRects: Painter not active 
```

为什么会这样？

**更新**

```
// QPainter( this )
// QTextEdit::paintEvent at the begining of custom PaintEvent
// RESULT: "QPainter::begin: Widget painting can only begin as a result of a paintEvent" ...
virtual void paintEvent(QPaintEvent *_event)
{
    QTextEdit::paintEvent( _event );
    QPainter pnt( this );
    pnt.setPen( QColor( 0, 0, 0, 0xff ));
    pnt.drawRect( 0, 0, width()-1, height()-1);
}

// QPainter ( viewport() )
// QTextEdit::paintEvent at the begining of custom PaintEvent
// RESULT: works.
virtual void paintEvent(QPaintEvent *_event)
{
    QTextEdit::paintEvent( _event );
    QPainter pnt( viewport() );
    pnt.setPen( QColor( 0, 0, 0, 0xff ));
    pnt.drawRect( 0, 0, width()-1, height()-1);
}

// *** BONUS ***
// QPainter( viewport() ) or QPainter ( this )
// QTextEdit::paintEvent after QPainter() constructor.
// RESULT: Segmentation fault.
virtual void paintEvent(QPaintEvent *_event)
{
    QPainter pnt( viewport() );
    pnt.setPen( QColor( 0, 0, 0, 0xff ));
    QTextEdit::paintEvent( _event ); // WRONG PLACE!!!
    pnt.drawRect( 0, 0, width()-1, height()-1);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-23T15:13:43.693

代替

```
QPainter pnt(this); 
```

尝试

```
QPainter pnt(viewport());
pnt.setPen(QColor( 0, 0, 0, 0xff ));
pnt.drawRect(viewport()->rect()); 
```

viewport() 是可绘制区域，可能是导致问题的原因

# wcf - WCF 与 MSMQ DTC - 关闭 NHibernate 会话

> ID：13502319
> 
> 赞同：4
> 
> 时间：2012-11-21T21:27:34.917
> 
> 标签：wcf, nhibernate, msmq, netmsmqbinding

我有一个 WCF MSMQ 服务（托管在 Windows 服务中）。我的方法上有 TransactionScopeRequired 属性。

我正在使用 Nhibernate 将我的数据保存到我的数据库中。我想确保在每次通话后关闭每个 Nhibernate 会话。

我在数据访问中使用了以下方法（使用城堡设施）

```
using(var session = sessionManager.OpenSession())
using(var transaction = session.BeginTransaction())
{

 // do work
transaction.Commit()

} 
```

但是当我的主要服务方法退出时，我收到了一个错误，因为我已经处理了 Nhibernate 会话，并且我认为 DTC 需要它来完成它的提交。

我的问题是：

关闭 Nhibernate 会话的最佳方式是什么 - 在 DTC 提交之后（即在我退出我的服务方法之后？）。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T13:50:23.603

如果您将代码包装在以下内容中

```
using (TransactionScope sc = new TransactionScope(TransactionScopeOption.Suppress)) 
{ 
     // code here 
     sc.Complete(); 
} 
```

然后 NHibernate 将不会在环境事务中登记，因此 DTC 将不会依赖于数据库事务。

这是一种预感，因为您没有在问题中提供错误详细信息。

**编辑**

当然，通过遵循这个建议，您的数据库提交将不会在与出队操作相同的事务下执行，因此如果您的数据库中出现故障，这可能会或可能不会导致出队事务将正在处理的消息回滚到队列中，所以你冒着以这种方式丢弃消息的风险。您可以通过各种方式对此进行补偿，或者如果丢失消息的成本不高，您可以冒险。

# dart - 发布安装在“运行发布安装”对话框中停止

> ID：13502320
> 
> 赞同：4
> 
> 时间：2012-11-21T21:27:46.590
> 
> 标签：dart, dart-pub, dart-editor

我正在运行 pub install 所以我可以使用作为 dart sdk 一部分的 intl 包（我需要使用 DateFormat 类）。我已经在我的项目中安装了其他包，例如 XML 解析器和演示文稿（类似于 impress js）。过去，当我安装当前包含在我的项目中的软件包时，我运行 pub install 没有问题，但今天它只是位于“运行 pub install”对话框中。我从 yaml 文件中取出了 intl 包声明并尝试更新，但它仍然会挂起。我没有收到错误消息或任何指示实际正在处理安装包的请求。

所以，我在问 pub 安装功能是否存在已知问题？在此期间我能做什么？

这是我的yaml代码：

```
name:  test_client
description:  A sample application

dependencies:
xml:
 git: https://github.com/prujohn/dart-xml.git
presentation:
 git: https://github.com/CatalystItLabs/presentation.dart
intl:
 sdk: intl 
```

请注意，已安装 xml 和演示包。我通过 twitter 联系了 dartlang 社区，但还没有收到回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T02:20:24.690

尝试使用 git 只读版本

```
dependencies:
xml:
 git: git://github.com/prujohn/dart-xml.git 
```

我之前尝试过 https 不起作用，但这个工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T07:30:42.223

我已经提交了一个关于类似问题的错误[http://code.google.com/p/dart/issues/detail?id=6843 。](http://code.google.com/p/dart/issues/detail?id=6843)随时为它加注星标，以继续关注有关可能修复的新闻。

# xslt - XSLT：基于来自其他节点的值的总和进行排序

> ID：13502321
> 
> 赞同：3
> 
> 时间：2012-11-21T21:27:49.197
> 
> 标签：xslt, xpath, xslt-2.0

我对 xslt 编码相当陌生，并且在尝试执行以下操作时遇到了困难。

我有一个 xml 文件，其中包含分为两个主要部分的马的繁殖信息。1\. Horses 节点有每匹马的表现细节以及他们父亲的身份。2\. Sires 节点是Sires 的列表，还包含特定的育种统计数据。

我需要根据他们的小马驹赢得的“赌注”总和（即在马节点中）对公牛列表进行排序。

所以一个缩减的 xml 文件看起来像这样：

```
<Horses>
    <Horse>
        <ID>1</ID>
        <Name>hrsA</Name>
        <SireID>101</SireID>
        <Pace>
            <Stakes>4800</Stakes>
        </Pace>
    </Horse>
    <Horse>
        <ID>2</ID>
        <Name>hrsB</Name>
        <SireID>102</SireID>
        <Pace>
            <Stakes>3600</Stakes>
        </Pace>
    </Horse>
    <Horse>
        <ID>3</ID>
        <Name>hrsC</Name>
        <SireID>102</SireID>
        <Pace>
            <Stakes>2800</Stakes>
        </Pace>
    </Horse>
    <Horse>
        <ID>4</ID>
        <Name>hrsD</Name>
        <SireID>101</SireID>
        <Pace>
            <Stakes>56</Stakes>
        </Pace>
    </Horse>
    <Horse>
        <ID>5</ID>
        <Name>hrsE</Name>
        <SireID>100</SireID>
        <Pace>
            <Stakes>20000</Stakes>
        </Pace>
    </Horse>
    <Horse>
        <ID>6</ID>
        <Name>hrsF</Name>
        <SireID>101</SireID>
        <Trot>
            <Stakes>20000</Stakes>
        </Trot>
    </Horse>
    <Horse>
        <ID>7</ID>
        <Name>hrsG</Name>
        <SireID>101</SireID>
        <Trot>
            <Stakes>559</Stakes>
        </Trot>
    </Horse>
    <Horse>
        <ID>8</ID>
        <Name>hrsH</Name>
        <SireID>102</SireID>
        <Pace>
            <Stakes>386</Stakes>
        </Pace>
        <Trot>
            <Stakes>10000</Stakes>
        </Trot>
    </Horse>
</Horses>
<Sires>
    <Sire>
        <ID>100</ID>
        <Name>srA</Name>
        <LiveFoalsALL>117</LiveFoalsALL>
    </Sire>
    <Sire>
        <ID>101</ID>
        <Name>srB</Name>
        <LiveFoalsALL>774</LiveFoalsALL>
    </Sire>
    <Sire>
        <ID>102</ID>
        <Name>srC</Name>
        <LiveFoalsALL>43</LiveFoalsALL>
    </Sire>
</Sires> 
```

因此，将各种赌注相加，输出将具有以下顺序：

```
Sire 101 (srB) Stakes: $25415
Sire 100 (srA) Stakes: $20000
Sire 103 (srC) Stakes: $16768. 
```

当我只是对其他网页的单个马桩进行汇总和排序时，我可以使用：

```
<xsl:apply-templates select="Horse">
    <xsl:sort select="sum(descendant::Stakes)" data-type="number"
        order="descending"/>
</xsl:apply-templates> 
```

我只是不知道如何对引用马节点的公牛做同样的事情，以求和以获得正确的顺序......可能是这样的，我试图说 Sire/ID 等于 Horse/SireID：

```
<xsl:apply-templates select="Sire">
    <xsl:sort select="sum(//Horses/Horse[@SireID=ID]/descendant::Stakes)" 
        data-type="number" order="descending"/>
</xsl:apply-templates> 
```

但这不起作用，调试器在到达排序行时会直接跳出当前模板，因此我的语法一定是无效的。我一直在尝试这个主题的变化，但没有成功。

谁能告诉我如何调用我的 Sire 模板并获得正确的顺序？

谢谢，

布莱斯斯坦伯格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:06:28.290

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:key name="kOffspring" match="Horse" use="SireID"/>

 <xsl:template match="/*">
  <xsl:apply-templates select="Sires/Sire">
   <xsl:sort select="sum(key('kOffspring', ID)/*/Stakes)"
             data-type="number" order="descending"/>
  </xsl:apply-templates>
 </xsl:template>

 <xsl:template match="Sire">
     Sire <xsl:value-of select="concat(ID,' (', Name, ') Stakes: ')"/>
   <xsl:value-of select="sum(key('kOffspring', ID)/*/Stakes)"/>
 </xsl:template>
 <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<t>
    <Horses>
        <Horse>
            <ID>1</ID>
            <Name>hrsA</Name>
            <SireID>101</SireID>
            <Pace>
                <Stakes>4800</Stakes>
            </Pace>
        </Horse>
        <Horse>
            <ID>2</ID>
            <Name>hrsB</Name>
            <SireID>102</SireID>
            <Pace>
                <Stakes>3600</Stakes>
            </Pace>
        </Horse>
        <Horse>
            <ID>3</ID>
            <Name>hrsC</Name>
            <SireID>102</SireID>
            <Pace>
                <Stakes>2800</Stakes>
            </Pace>
        </Horse>
        <Horse>
            <ID>4</ID>
            <Name>hrsD</Name>
            <SireID>101</SireID>
            <Pace>
                <Stakes>56</Stakes>
            </Pace>
        </Horse>
        <Horse>
            <ID>5</ID>
            <Name>hrsE</Name>
            <SireID>100</SireID>
            <Pace>
                <Stakes>20000</Stakes>
            </Pace>
        </Horse>
        <Horse>
            <ID>6</ID>
            <Name>hrsF</Name>
            <SireID>101</SireID>
            <Trot>
                <Stakes>20000</Stakes>
            </Trot>
        </Horse>
        <Horse>
            <ID>7</ID>
            <Name>hrsG</Name>
            <SireID>101</SireID>
            <Trot>
                <Stakes>559</Stakes>
            </Trot>
        </Horse>
        <Horse>
            <ID>8</ID>
            <Name>hrsH</Name>
            <SireID>102</SireID>
            <Pace>
                <Stakes>386</Stakes>
            </Pace>
            <Trot>
                <Stakes>10000</Stakes>
            </Trot>
        </Horse>
    </Horses>
    <Sires>
        <Sire>
            <ID>100</ID>
            <Name>srA</Name>
            <LiveFoalsALL>117</LiveFoalsALL>
        </Sire>
        <Sire>
            <ID>101</ID>
            <Name>srB</Name>
            <LiveFoalsALL>774</LiveFoalsALL>
        </Sire>
        <Sire>
            <ID>102</ID>
            <Name>srC</Name>
            <LiveFoalsALL>43</LiveFoalsALL>
        </Sire>
    </Sires>
</t> 
```

**产生想要的正确结果**：

```
 Sire 101 (srB) Stakes: 25415
 Sire 100 (srA) Stakes: 20000
 Sire 102 (srC) Stakes: 16786 
```

**说明**：

1.  我们定义一个键，指定 a`Horse`作为它的函数`SireID`。这在选择给定的所有后代时很有用，只需在调用标准 XSLT函数`Sire`时提供它——就像这样： .`ID`**[`key()`](http://www.w3.org/TR/xslt#function-key)**`key('kOffspring', ID)`

2.  `Stakes`类似地，给定的所有后代的总和`Sire`是：`sum(key('kOffspring', ID)/*/Stakes)`。

3.  我们将模板应用于 XML 文档中的所有元素，并按其后代`Sire`的总和的递减值对这些元素进行排序。`Stakes`

4.  对于每个`Sire`我们输出它的`ID`，以及它的后代`Name`的总和。`Stakes`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:04:39.347

您需要使用`current()`：

```
<xsl:apply-templates select="Sire">
    <xsl:sort select="sum(//Horses/Horse[SireID = current()/ID]//Stakes)" 
        data-type="number" order="descending"/> 
```

`current()`为您提供当前 XPath 表达式*之外的上下文节点；*在这种情况下，当前`<Sire>`元素由 选择`xsl:apply-templates`。在谓词内部，上下文节点是`<Horse>`针对谓词表达式进行测试的元素。

笔记：

*   你有一个`@`你不想要的；`@ID`指的是一个 ID*属性*。
*   我替换`descendant::/`为`//`
*   正如@Dimitre 所指出的，如果您使用键而不是`//foo[barID = current()/ID]`.

# iphone - 提高 iOS 编程中位置管理器的准确性

> ID：13502325
> 
> 赞同：0
> 
> 时间：2012-11-21T21:28:01.810
> 
> 标签：iphone, ios, xcode, ipad, map

我正在制作一个跟踪用户的应用程序。我注意到应用程序何时进入后台，然后当您打开应用程序时，它会为用户显示错误的当前位置，直到大约 5 秒。是否可以解决这个问题，因为 5 秒的延迟会破坏跟踪结果（它无缘无故地增加了 3 英里）。

编辑：这个问题实际上不是一个“错误”。我必须在我的 Info.plist 中设置我想要后台处理和繁荣应用程序跟踪是超级准确的。一个小教程来做到这一点：

1.  转到 Info.plist
2.  添加一个名为“必需的背景模式”的新行
3.  然后再次添加一个名为“App registers for location updates”的新行
4.  我们完了 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T21:43:07.800

您可以做的一件事是检查您被退回的`horizontalAccuracy`财产。`CLLocation`如果这高于某个阈值，那么您可以丢弃结果并等待更准确的结果。如果它在数英里之外，那么我希望准确度数字会很大。它最有可能使用蜂窝站点而不是 GPS 来确定位置，并且误差范围会大得多。

在您`CLLocationManagerDelegate`的`locationManager:didUpdateLocations:`方法中，您可以执行以下操作：

```
- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations {
  if ([locations count] > 0) {
    CLLocation *lastUpdatedLocation = [locations lastObject];
    CLLocationAccuracy desiredAccuracy = 1000; // 1km accuracy
    if (lastUpdatedLocation.horizontalAccuracy > desiredAccuracy) {
      // This location is inaccurate. Throw it away and wait for the next call to the delegate.
      return;
    } 
    // This is where you do something with your location that's accurate enough.
  }
} 
```

# php - 检查 PHP 是否在本地服务器中运行

> ID：13502330
> 
> 赞同：4
> 
> 时间：2012-11-21T21:28:18.290
> 
> 标签：php

出色地。我在 SO 中阅读了一些主题，但没有找到非常具体的答案。

如果 PHP 代码在本地或远程主机中运行，我需要检查 PHP。目前我检查，`$_SERVER['SERVER_NAME']`但它是不一致的。在这种情况下，如果我使用列出的 IP 运行 PHP，`127.0.0.1`或者`localhost`它会考虑本地，否则远程。如果我与朋友共享我的 IP，我的代码仍然是本地的，但它认为是远程的，因为共享的 IP 未列出。

好吧，我认为检查 localhost 的 IP 不是一个好主意（除非你知道一个好的方法）。我尝试了类似的方法`gethostbyaddr()`，`gethostbyname()`但也无法正常工作。

我没有要显示的 PHP 代码，但我的代码基本上是这样的：

```
// true = localhost
return $_SERVER['SERVER_NAME'] === '127.0.0.1'; 
```

根本问题是：什么可以确定 PHP 是在本地运行的？PHP 的“本地”是什么？我认为它可以解决问题。

观察者：我无法使用 PHP 访问 CMD/Shell。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T21:36:04.323

您可以做大多数 PHP 框架所做的事情，并在应用程序的引导阶段设置一个标志，该标志定义了代码在哪个环境中运行。最简单的形式是：

```
// the setting when run on a dev machine
define('ENV', 'local'); 
```

那么这是一个简单的案例：

```
if ( ENV == 'local' )
{
    // do stuff
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T21:34:57.520

我就是这样做的，我发现这比尝试检测更可靠`127.0.0.1`：

```
if( strpos(gethostname(), '.local') !== false ) { } 
```

基本上，我的工作站上的主机名都已`.local`附加到它上面。您可以更改它以完全匹配您的工作站的主机名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T21:30:10.197

检查`$_SERVER['REMOTE_ADDR']=='127.0.0.1'`。只有在本地运行时才会如此。请注意，这也意味着服务器本地。因此，如果您在服务器上运行任何向您的 PHP 页面发出请求的脚本，它们也将满足此条件。

如果有人通过网络访问您的网站，那么无论使用代理，您看到的 IP 地址都不会是 127.0.0.1（或::1 对于 IPV6）。（当然，除非您自己在同一台服务器上运行代理；）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T21:31:44.727

据我所知，只有*您*才能知道哪些地址是本地地址。您的网络可能设置了看起来根本不是本地的 IP 地址。据我所知，PHP 无法自行确定。

# java - Java 代码不使用“javac”编译但在 Eclipse 中编译

> ID：13502331
> 
> 赞同：3
> 
> 时间：2012-11-21T21:28:19.000
> 
> 标签：java, multithreading, command-line, compiler-errors, javac

我刚刚在 Eclipse 中编写了一个 Java 多线程程序。它编译得很好，就像一个魅力。

但是，由于这是课程作业，我们需要确保它使用“javac”在命令行中编译，否则我们得分为零！

所以，有些类编译其他类不编译。我得到的错误如下（它们都是相似的，只是类名不同，这是一个例子）

```
GateRunnable.java:7: cannot find symbol
symbol  : class Station
location: class package.name.here.GateRunnable
    public GateRunnable(Station st) {
                        ^ 
```

这是javac的问题吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T19:17:09.913

To solve the problem I was having, it was simply necessary to compile all classes by using the following command:

```
javac *.java 
```

which compiles **all** java files in the directory.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:32:01.123

您的编译`-classpath`和/或`-sourcepath`不完整。编译器不知道在哪里可以找到 class `Station`。[这](https://stackoverflow.com/questions/2096283/including-jars-in-classpath-on-commandline-javac-or-apt)是一个相关的问题，描述了如何设置类路径以包含您想要的所有类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:30:28.033

您是否编译了文件夹/包中的每个 .java 文件？如果没有，那就这样做。Eclipse 通常会为您执行此操作，但在终端中，您负责编译代码的每个部分。

# python - Django：当用户提交未完成的表单时如何引发异常？

> ID：13502342
> 
> 赞同：5
> 
> 时间：2012-11-21T21:29:27.993
> 
> 标签：python, django, forms, error-handling

我有一个相对标准的RegistrationForm，如下所示：

```
class RegisterForm(forms.Form):
    username = forms.CharField(widget=forms.TextInput(attrs={'placeholder': 'username'}), initial='')
    email = forms.EmailField(widget=forms.TextInput(attrs={'placeholder': 'email'}), initial='')
    password = forms.CharField(widget=forms.PasswordInput(attrs={'placeholder': 'password'}), initial='')
    password_repeat = forms.CharField(widget=forms.PasswordInput(attrs={'placeholder': 'retype password'}), initial='') 
```

***当用户忘记填写一个或多个字段时，如何创建一个返回错误的干净方法？（即“您忘记填写电子邮件字段”）***

我在 clean() 方法中尝试了以下两个选项（我将使用 password 和 password_repeat 字段作为示例）：

```
password = self.cleaned_data['password']
password_repeat = self.cleaned_data['password_repeat']
# initial values are set to '' for all fields, see above.
if password == '':
    raise forms.ValidationError("You forgot to type in a password.")
elif password_repeat == '':
        raise forms.ValidationError("You forgot to retype your password.") 
```

**第一个选项返回：**

/homepage/ 处的 KeyError

'密码'

* * *

```
try:
    password = self.cleaned_data['password']
    password_repeat = self.cleaned_data['password_repeat']
except KeyError(password):
    raise forms.ValidationError("You forgot to fill in the password field.") 
```

**第二个选项返回：**

/homepage/ 处的 UnboundLocalError

赋值前引用的局部变量“密码”

* * *

如果您可以提供允许检查剩余字段的解决方案（以便我可以返回绑定到用户成功提交的数据的表单），则可以加分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T23:42:09.070

您可以使用[`required`](https://docs.djangoproject.com/en/dev/ref/forms/fields/#required)可用于所有字段类型的属性，它会自动执行此类验证。所以你的代码看起来像：

```
class RegisterForm(forms.Form):
    username = forms.CharField(
        widget = forms.TextInput(attrs = {'placeholder': 'username'}),
        required = True)
    email = forms.EmailField(
        widget = forms.TextInput(attrs = {'placeholder': 'email'}),
        required = True)
    password = forms.CharField(
        widget = forms.PasswordInput(attrs = {'placeholder': 'password'}),
        required = True)
    password_repeat = forms.CharField(
        widget = forms.PasswordInput(attrs = {'placeholder': 'retype password'}),
        required = True) 
```

*注意：我认为您也可以省略这些`initial = ''`参数，如上所示。*

我实际上不确定您为什么会收到您在问题中提到的错误，也许您可​​以从您的`views.py`? 这可能是因为您需要在您实现的任何方法`cleaned_data`结束时返回。`clean`

我也只想说你使用的`clean`方法不太对。如果您参考有关[表单和字段验证](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute)的文档的此页面，您会看到要验证单个字段，您使用特定的`clean_<fieldname>`方法，例如`clean_password_repeat`。当验证同时涉及多个字段时，使用该`clean`方法是合适的，您可能喜欢使用的一个示例是检查两个密码字段的输入是否匹配。

```
class RegisterForm(forms.Form):
    # field definitions (above)

    def clean(self):
        password = self.cleaned_data['password']
        password_repeat = self.cleaned_data['password_repeat']
        if password != password_repeat:
            raise forms.ValidationError(u"Passwords do not match.")
        return cleaned_data 
```

*注意：代码未经测试。*

我希望这可以帮到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:47:58.570

从 django 1.2 开始，它能够[在模型上编写验证代码](https://docs.djangoproject.com/en/1.2/ref/models/instances/#django.db.models.Model.clean)。我总是在模型端编写业务规则：

这是你的模型：

```
from django.db import models
class Issue(models.Model):
    ....

    def clean(self): 
        rules.Issue_clean(self)

#I write business rules into another file ...
def Incidencia_clean( instance ): 
    import datetime as dt

    errors = {}

    #some business rules:     
    if not instance.dia_incidencia: 
        errors.setdefault('b1',[]).append(u'Falten...ranja')

    if not  instance.franja_incidencia: 
        errors.setdefault('b2',[]).append(u'Falten..nja')

    if instance.dia_incidencia < ( dt.date.today() + 
                                   dt.timedelta( days = -7) ): 
        errors.setdefault('b3',[]).append(u'''No es ... setmana)''')

    if instance.getDate() > datetime.now(): 
        errors.setdefault('b4',[]).append(u'''Encara ...itzat.''') 

    if len( errors ) > 0: 
        raise ValidationError(errors) 
```

在模板中：

```
{% if form.non_field_errors %}
      {% for error in form.non_field_errors %}
        {{error}}
      {% endfor %}
{% endif %} 
```

我更喜欢在模型中编写一次业务规则，而不是在每个表单中重复规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:49:32.523

这是一个片段，它遍历字典中的键，如果其中任何一个映射到空字符串或任何其他类似 False 的值，则会引发异常。异常告诉您字典中的哪个键缺少条目。

```
for key in self.cleaned_data:
    if not self.cleaned_data[key]:
        raise forms.ValidationError("You didn't fill in the {} form".format(key)) 
```

如果您只想测试空字符串（而不是`False`, `0`,`[]`等），请更改`if not self.cleaned_data[key]:`为`if self.cleaned_data[key] == '':`.

# jquery - 无法在经典主题和全屏主题之间切换

> ID：13502344
> 
> 赞同：2
> 
> 时间：2012-11-21T21:29:33.603
> 
> 标签：jquery, galleria

我决定为我的投资组合网站使用 Galleria jquery 插件。我想要实现它的方式是加载经典主题。另外，我在左上角用一个按钮扩展了经典主题，当按下浏览器进入全屏模式并且 Galleria 切换到全屏主题时。在全屏主题中存在相同的按钮，但是当再次按下它时，它会从全屏模式切换回正常模式，并返回到显示我网站其余部分的经典主题。

我似乎找不到令人满意的解决方案。到目前为止，我所拥有的让我进入全屏模式并完美地更改主题，但是当我再次按下按钮时，它会返回页面并切换到具有致命错误阶段高度的经典模式。我试图将配置选项放在很多地方，但我似乎没有在 loadtheme 之后运行。

这是我到目前为止坚持的代码：

```
 var OptionsFullscreen = {
    height: 1, //0.5625 16:9, 0.74 4:3 format
    imageCrop: false,
    idleSpeed: 100,
    idleTime: 1000,
    clicknext: true,
    transition: 'fade'
    };

var OptionsNormal = {
    height: 0.5625, //0.5625 16:9, 0.74 4:3 format
    imageCrop: false,
    idleSpeed: 100,
    idleTime: 1000,
    clicknext: true,
    transition: 'fade'
    };

Galleria.loadTheme('js/themes/classic/galleria.classic.min.js');
Galleria.configure(OptionsNormal);

Galleria.run('#gallery', {
    extend: function() {

    var gallery = this;

    // Add button for toggling fullscreen theme
    this.addElement('fscr');
    this.appendChild('stage','fscr');

    var fscr = this.$('fscr')
    .text('Fullscreen')
    .click(function(e) {

    e.preventDefault;

    gallery.toggleFullscreen();

    });

    this.addIdleState(this.get('fscr'), { opacity:0 });
    }
});

Galleria.ready(function() {

this.bind('fullscreen_enter', function() {
Galleria.loadTheme('js/themes/fullscreen/galleria.fullscreen.min.js');
});

this.bind('fullscreen_exit', function() {
Galleria.loadTheme('js/themes/classic/galleria.classic.min.js');
Galleria.configure(OptionsNormal);
});

}); 
```

# inno-setup - 如何在 Inno Setup 中安装期间为可选文件添加复选框？

> ID：13502346
> 
> 赞同：13
> 
> 时间：2012-11-21T21:29:48.527
> 
> 标签：inno-setup, pascalscript

我正在尝试在我的自定义页面中制作一个自定义复选框（因为它是一个单页安装程序），只需要一个没有对话框或任何东西的复选框，我试图编译的安装程序非常线性和简单。

我想以`FILE3.EXE`这种方式绑定复选框：如果选中复选框，则将文件 ( `FILE3.EXE`) 复制到 中`DestDir`，否则如果未选中复选框，则`FILE3.EXE`在安装过程中跳过文件 ()。

这是我使用的代码，显然复选框代码丢失了，因为我无法做到这一点

```
[Files]
Source: FILE1.EXE; DestDir: {app};
Source: FILE2.EXE; DestDir: {app};
Source: FILE3.EXE; DestDir: {app}; //OPTIONAL 
```

```
[Code]
procedure ExitProcess(uExitCode: UINT);
external 'ExitProcess@kernel32.dll stdcall';

var
  MainPage : TWizardPage;
  FolderToInstall : TEdit;
  InstallLocation : String;

procedure CancelClick(Sender: TObject);
begin
  if ExitSetupMsgBox then
  begin
    ExitProcess(0);
  end;
end;

procedure BrowseClick(Sender : TObject);
var
  Dir : String;

begin
  Dir := FolderToInstall.Text;
  if BrowseForFolder('Browse',Dir,false) then
    FolderToInstall.Text := Dir;
  WizardForm.DirEdit.Text := Dir;
end;

procedure InitializeWizard();
var
  LabelFolder : TLabel;
begin
  MainPage := CreateCustomPage(wpWelcome,'','');
  LabelFolder := TLabel.Create(MainPage);
  LabelFolder.Parent := WizardForm;
  LabelFolder.Top := 164;
  LabelFolder.Left := 6;
  LabelFolder.Caption := 'Directory:'

  FolderToInstall := TEdit.Create(MainPage);
  FolderToInstall.Parent := WizardForm;
  FolderToInstall.Top := 182;
  FolderToInstall.Left := 85;
  FolderToInstall.Width := 380;
  FolderToInstall.Text :=  WizardDirValue;
  FolderToInstall.ReadOnly := True;
end; 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-21T21:41:32.847

您不必为此手动创建复选框。让用户选择安装什么的标准方法是使用脚本文件的`[Types]`和`[Components]`部分。

查看`Components.iss`位于 Inno Setup 安装文件夹\examples 中的脚本。

```
; -- Components.iss --
; Demonstrates a components-based installation.

; SEE THE DOCUMENTATION FOR DETAILS ON CREATING .ISS SCRIPT FILES!

[Setup]
AppName=My Program
AppVersion=1.5
DefaultDirName={pf}\My Program
DefaultGroupName=My Program
UninstallDisplayIcon={app}\MyProg.exe
OutputDir=userdocs:Inno Setup Examples Output

[Types]
Name: "full"; Description: "Full installation"
Name: "compact"; Description: "Compact installation"
Name: "custom"; Description: "Custom installation"; Flags: iscustom

[Components]
Name: "program"; Description: "Program Files"; Types: full compact custom; Flags: fixed
Name: "help"; Description: "Help File"; Types: full
Name: "readme"; Description: "Readme File"; Types: full
Name: "readme\en"; Description: "English"; Flags: exclusive
Name: "readme\de"; Description: "German"; Flags: exclusive

[Files]
Source: "MyProg.exe"; DestDir: "{app}"; Components: program
Source: "MyProg.chm"; DestDir: "{app}"; Components: help
Source: "Readme.txt"; DestDir: "{app}"; Components: readme\en; Flags: isreadme
Source: "Readme-German.txt"; DestName: "Liesmich.txt"; DestDir: "{app}"; Components: readme\de; Flags: isreadme

[Icons]
Name: "{group}\My Program"; Filename: "{app}\MyProg.exe" 
```

在运行时，安装程​​序会在向导中显示此对话框：

![组件对话框](../Images/2971da2cd3f23fb56908c66969e216ad.png)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-11-21T22:57:30.393

您需要创建一个函数，该函数将从脚本部分[`Check`](http://jrsoftware.org/ishelp/topic_scriptcheck.htm#Check)返回复选框的状态。[`[Code]`](http://jrsoftware.org/ishelp/topic_scriptcreating.htm)像这样的东西可能会做你想做的事，但在代码脚本之前，我会在下面纠正你：

*   使用***TNew...***您可以使用的类，因此在您的情况下使用[`TNewEdit`](http://jrsoftware.org/ishelp/topic_scriptclasses.htm#TNewEdit)而不是[`TEdit`](http://jrsoftware.org/ishelp/topic_scriptclasses.htm#TEdit)
*   [`TWizardPage.Surface`](http://jrsoftware.org/ishelp/topic_scriptclasses.htm#TWizardPage)如果您想在页面上有某个组件，请使用`Parent`（这里我不确定这是否是您的意图，只是指出这一点:-)
*   格式化你的代码，它不需要那么平坦

在下面的示例中，我使用了为某个文件的条件安装[`Check`](http://jrsoftware.org/ishelp/topic_scriptcheck.htm#Check)调用的函数，在本例中为. 该功能工作简单；当您向函数返回 True 时，文件被处理，当您返回 False 时跳过。`InstallHelpFile``MyProg.chm`[`Check`](http://jrsoftware.org/ishelp/topic_scriptcheck.htm#Check)

```
[Setup]
AppName=My Program
AppVersion=1.5
DefaultDirName={pf}\My Program
OutputDir=userdocs:Inno Setup Examples Output

[Files]
Source: "MyProg.exe"; DestDir: "{app}"
Source: "MyProg.chm"; DestDir: "{app}"; Check: InstallHelpFile; 
```

```
[Code]
var
  InstallHelpCheckBox: TNewCheckBox;  

procedure InitializeWizard;
var  
  LabelFolder: TLabel;  
  MainPage: TWizardPage;  
  FolderToInstall: TNewEdit;  
begin
  MainPage := CreateCustomPage(wpWelcome, '', '');
  LabelFolder := TLabel.Create(MainPage);
  LabelFolder.Parent := WizardForm;
  LabelFolder.Top := 164;
  LabelFolder.Left := 6;
  LabelFolder.Caption := 'Directory:'

  FolderToInstall := TNewEdit.Create(MainPage);
  FolderToInstall.Parent := MainPage.Surface;
  FolderToInstall.Top := 182;
  FolderToInstall.Left := 85;
  FolderToInstall.Width := 380;
  FolderToInstall.Text :=  WizardDirValue;
  FolderToInstall.ReadOnly := True;

  InstallHelpCheckBox := TNewCheckBox.Create(MainPage);
  InstallHelpCheckBox.Parent := MainPage.Surface;
  InstallHelpCheckBox.Top := FolderToInstall.Top + FolderToInstall.Height + 8;
  InstallHelpCheckBox.Left := FolderToInstall.Left;
  InstallHelpCheckBox.Width := FolderToInstall.Width;
  InstallHelpCheckBox.Caption := 'Install help file';
end;

function InstallHelpFile: Boolean;
begin
  { here is the Check function used above; if you return True to this }
  { function, the file will be installed, when False, the file won't }
  { be installed }
  Result := InstallHelpCheckBox.Checked;
end; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-07T08:46:46.027

使用 CreateInputOptionPage() 可以更轻松地完成它。请参阅 Inno Setup 帮助中的详细信息。[http://www.jrsoftware.org/ishelp/index.php?topic=scriptpages](http://www.jrsoftware.org/ishelp/index.php?topic=scriptpages)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-03T12:09:05.203

```
// Create:
for i := 0 to g_SetupX_Count do begin
    WizardForm.ComponentsList.AddCheckBox(g_SetupX_Name[i], '', 0, g_SetupX_Active[i], true, false, false, nil);
    g_SetupX_CompListIndex[i] := nextPosi;
    nextPosi := nextPosi + 1;
end;

// Evaluate:
for i := 0 to g_SetupX_Count do begin
    g_SetupX_Active[i] := WizardForm.ComponentsList.Checked[g_SetupX_CompListIndex[i]];
end; 
```

# php - 如何正确解析 PHP 中的整数？

> ID：13502352
> 
> 赞同：13
> 
> 时间：2012-11-21T21:30:04.127
> 
> 标签：php, casting, int

我可以使用`intval`，但根据文档：

> 字符串很可能返回 0，尽管这取决于字符串最左边的字符。整数转换的通用规则适用。

...并且要解析的值可以是`0`，也就是说我无法区分零和 a `string`。

```
$value1 = '0';
$value2 = '15';
$value3 = 'foo'; // Should throw an exeption 
```

真正的问题是：如何解析字符串并区分转换为的 a`string`和`0`零本身？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-21T21:33:30.933

在下面的代码中，如果不是实际的数字字符串（基数为 10 和正数），`$int_value`则将设置为，否则将设置为的整数值：`null``$value``$value`

```
$int_value = ctype_digit($value) ? intval($value) : null;
if ($int_value === null)
{
    // $value wasn't all numeric
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-26T17:45:50.630

我没有针对 ctype_digit() 进行基准测试，但我认为以下是一个不错的选择。当然，这取决于您期望的确切行为。

```
function parseIntOrException($val) {
  $int = (int)$val;
  if ((string)$int === (string)$val) {
    throw \Exception('Nope.');
  }
  return $int;
} 
```

[http://3v4l.org/Tf8nh](http://3v4l.org/Tf8nh)

```
1       1
'2'     2
'3.0'   false
4.0     4
5       5 
```

# php - 使用经纬度使用 MySQL 查找最近的 10 个城市？

> ID：13502360
> 
> 赞同：3
> 
> 时间：2012-11-21T21:30:36.780
> 
> 标签：php, mysql, geocoding, latitude-longitude

我在网上搜索了很多以找到解决我的问题的方法，但我仍然无法弄清楚。

我有一个非常简单的数据库，其中包含 id、城市名称、纬度、经度和 city_info。当有人进入一个城市页面时，想显示附近的 10 个城市。

如何用 MySQL 计算并用 PHP 返回？

我在这个网站上看到了很多建议，但是这些都不起作用。

我尝试过的没有成功。我没有得到任何结果。

```
<?php
$slatitude = 43.2141341;
$slongitude = 64.4368684;
$miles = 200;

//connect

$query = "SELECT *, 
( 3959 * acos( cos( radians('$slatitude') ) * 
cos( radians( latitude ) ) * 
cos( radians( longitude ) - 
radians('$slongitude') ) + 
sin( radians('$slatitude') ) * 
sin( radians( latitude ) ) ) ) 
AS distance FROM cities HAVING distance < '$miles' ORDER BY distance ASC LIMIT 0, 10";

$query = mysql_query($query);
$numrows = mysql_num_rows($query);
if ($numrows > 0){

while ($row = mysql_fetch_assoc($query)){
$id = $row['id'];
$cityname = $row['cityname'];
$latitude = $row['latitude'];
$longitude = $row['longitude'];

echo "$cityname<br />";

}}

?>` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-10T19:22:50.480

为了提高查询速度，您可以首先限制您将使用以下子选择之类的计算结果集（请注意，我还使用了不同的方法来计算距离 - 它适用于我，ymmv ）。在我的测试中，使用公差为 1 的 where 子句比不使用它的查询快 100 倍以上。

```
...
$tol = 1; // limits the search to lat/long within 1 from the given values
$query_args = array($lat,$long,$lat-$tol,$lat+$tol,$long-$tol,$long+$tol);
$query = "
  SELECT *,latitude, longitude, 
    SQRT( POW( 69.1 * ( latitude - %s) , 2 ) 
        + POW( 69.1 * ( %s - longitude ) 
          * COS( latitude / 57.3 ) , 2 ) ) 
    AS distance FROM zipcodes
      WHERE latitude > %d AND latitude < %d 
      AND longitude > %d AND longitude < %d 
  ORDER BY distance ASC limit 10
";
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:34:59.503

你不能使用有，因为你没有按任何东西分组。您需要做的是在 where 中重复您在 select 中所做的操作。

```
$query = "SELECT *, 
( 3959 * acos( cos( radians('$slatitude') ) * 
cos( radians( latitude ) ) * 
cos( radians( longitude ) - 
radians('$slongitude') ) + 
sin( radians('$slatitude') ) * 
sin( radians( latitude ) ) ) ) 
AS distance FROM cities WHERE ( 3959 * acos( cos( radians('$slatitude') ) * 
cos( radians( latitude ) ) * 
cos( radians( longitude ) - 
radians('$slongitude') ) + 
sin( radians('$slatitude') ) * 
sin( radians( latitude ) ) ) ) < '$miles' ORDER BY distance ASC LIMIT 0, 10"; 
```

或者你可以这样做：

```
$query = "
SELECT * FROM (
  select *, 
  ( 3959 * acos( cos( radians('$slatitude') ) * 
  cos( radians( latitude ) ) * 
  cos( radians( longitude ) - 
  radians('$slongitude') ) + 
  sin( radians('$slatitude') ) * 
  sin( radians( latitude ) ) )) as distance from cities
) WHERE distance < '$miles' ORDER BY distance ASC LIMIT 0, 10"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-06T21:51:21.687

这是我用来从给定的纬度/经度集中获取最近的邮政编码的查询。表很简单：

id、zip、lat、lng

此查询假设您的中心点使用“$slatitude: and :$slongitude”。这将返回距离变量“$miles”（即 3、2.4、1000）内的所有匹配项。在我的脚本中，结果被放入一个数组中，并根据最接近的 X 个结果进行分类。

```
$getzip = mysql_query("SELECT zip,((ACOS(SIN(".$slatitude." * PI() / 180) * SIN(lat * PI() / 180) + COS(".$slatitude." * PI() / 180) * COS(lat * PI() / 180) * COS((".$slongitude." - lng) * PI() / 180)) * 180 / PI()) * 60 * 1.1515) AS distance FROM zips HAVING distance<='$miles' ORDER BY 'distance' ASC", $link2) or die (mysql_error($link2)); 
```

希望能帮助到你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T22:40:42.107

我已经为此使用了 PDO，因为 mysql_ 函数已被弃用

```
<?php
 //Connect to database
$dbh = new PDO("mysql:host=$host;dbname=$database", $username, $password);//Change to suit 
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
try {
    // Prepare statement
    $stmt = $dbh->prepare("SELECT  *, ( 3959 * acos( cos( radians(?) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(?) ) + sin( radians(?) ) * sin( radians( lat ) ) ) ) AS distance FROM cities HAVING distance < ? ORDER BY distance LIMIT 0 , 10");
    // Assign parameters
    $stmt->bindParam(1,$slatitude);
    $stmt->bindParam(2,$slongitude);
    $stmt->bindParam(3,$slatitude);
    $stmt->bindParam(4,$miles);
    //Execute query
    $stmt->setFetchMode(PDO::FETCH_ASSOC);
    $stmt->execute();
    if ($stmt->rowCount()>0) { 
    // Iterate through the rows
    while($row = $stmt->fetch()) {
        $id = $row['id'];
        $cityname = $row['cityname'];
        $latitude = $row['latitude'];
        $longitude = $row['longitude'];
        echo "$cityname<br />";]);
        }
    }
   else{
        echo "No Records";
       }   
}

catch(PDOException $e) {
    echo "I'm sorry I'm afraid you can't do that.". $e->getMessage() ;// Remove or modify after testing 
    file_put_contents('PDOErrors.txt',date('[Y-m-d H:i:s]').", mapSelect.php, ". $e->getMessage()."\r\n", FILE_APPEND);  
 }
//Close the connection
$dbh = null; 
?> 
```

这个[**DEMO**](http://daviestrachan.co.uk/maps/stationmap8a.php)使用这个查询

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T21:36:27.477

最简单的解决方案是：

获取城市的坐标和

```
select ...
order by abs(`Latt`-reqLatt) * abs(`Long`-reqLong) 
```

它并不完美，但你可以从前 50 名中挑选出你想要的东西。

# visual-studio-2012 - dotnetconfig45.xsd 在哪里

> ID：13502362
> 
> 赞同：1
> 
> 时间：2012-11-21T21:30:53.273
> 
> 标签：visual-studio-2012

我需要对 .net 4.5 的智能感知架构进行一些更改，但我找不到它。

其他的都可以在

C:\Program Files (x86)\Microsoft Visual Studio 11.0\Xml\Schemas

但不是 4.5

有谁知道如何调整 4.5 架构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:24:32.537

.NET 4.5 的配置位于`C:\Program Files (x86)\Microsoft Visual Studio 11.0\Xml\Schemas\1033\DotNetConfig.xsd`.

# c# - 这是抽象类的候选人吗

> ID：13502365
> 
> 赞同：0
> 
> 时间：2012-11-21T21:31:16.350
> 
> 标签：c#

假设我想在一个地方收集所有运动的所有常见属性和行为。为此，我正在考虑使用 SportBase 作为抽象类，但我不确定。我试图了解此示例中抽象与接口使用之间的区别。

每项运动都应具有以下属性

*   日期时间开始；
*   日期时间结束；
*   字符串名称；

如果我声明这些属性（如整数），然后我决定使用 Game 对象作为独立实体（如 Game StartGame）。我不清楚使用哪种方法具有高度抽象性来减少后期修改的痛苦（这种修改可以添加新属性、新行为等）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:34:16.303

如果您只有属性和空方法，那么接口可能是您更好的选择。如果您有一些实际代码，那么抽象类是您唯一的选择。还要记住，您只能继承一个抽象类，但可以实现多个接口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:36:39.050

不，我不会那样做。你最终会创建一个抽象的[上帝类](http://en.wikipedia.org/wiki/God_object)，它有很多职责。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T21:40:52.283

您可以使用接口来提供要编码的合同。

```
public interface ISportsEvent
{
    DateTime Start { get; set; }
    DateTime End { get; set; }
    string Name { get; set; }
} 
```

but that doesn't give you a reusable implementation

As a general rule you should prefer composition over inheritance.

So its often better to do something like this

```
public interface EventDetails
{
    public DateTime Start { get; set; }
    public DateTime End { get; set; }
    public string Name { get; set; }
}

public class SportingEvent
{

    public EventDetails Details {get;set;}
} 
```

now this is a bit rough but you can see what I'm getting at.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T21:37:17.110

我个人可能会把它变成一个抽象类，因为你的运动不仅会共享一些领域，而且它们也可能会共享一些逻辑。

接口不是用于分离重复代码，而是纯粹用于多态性。

接口所做的只是保证您的类将以某种方式运行。如果您打算将逻辑放在基类中，而不是需要一个抽象类。

# python - 如何从python在命令行中运行程序

> ID：13502376
> 
> 赞同：1
> 
> 时间：2012-11-21T21:32:15.897
> 
> 标签：python

> **可能重复：**
> [如何从 python 执行程序？os.system 由于路径中的空格而失败](https://stackoverflow.com/questions/204017/how-do-i-execute-a-program-from-python-os-system-fails-due-to-spaces-in-path)

我试图从 python 的命令行中调用一个程序（MP3gain.exe）。我的问题是python在我发送到命令行的命令周围放置了一个['']，而dos似乎无法用它来解释命令。这是我的代码。

```
import os
import subprocess
import Editor

class normalize():
    def __init__(self, file):
        self.FileName = file

    def work(self):
        command = [ 'mp3gain /r /c' + self.FileName]
        subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)

if __name__ == "__main__":
    test = normalize("filename.mp3")
    test.work() 
```

如果这有帮助，如果我打印出退出代码，它是-2。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:33:59.330

`command`应该是一个字符串列表，以mp3gain为第一个，即：

```
command = ['mp3gain', '/r', '/c', self.FileName] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:43:00.577

您可以使用 调用程序`os.system`。例如，在您的程序中，您可以使用：

```
os.system("mp3gain /r /c " + self.FileName) 
```

# jquery - 如何使用文本旋转器制作 jquery 图像？

> ID：13502380
> 
> 赞同：-2
> 
> 时间：2012-11-21T21:32:45.097
> 
> 标签：jquery, css, image, wordpress, image-rotation

如何制作图像和文本旋转器，我可以在其中使用 css 修改文本字段的位置和外观以及图片的边框大小。没有什么花哨的，只是一组每隔 x 秒改变一次的图像和文本。

这是一个例子。在标题区域中，您可以看到一个红色块和右侧的图片。

![在此处输入图像描述](../Images/f4236255418069c73f46522aaf7924eb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:51:43.573

[http://tympanus.net/codrops/2012/03/15/parallax-content-slider-with-css3-and-jquery/](http://tympanus.net/codrops/2012/03/15/parallax-content-slider-with-css3-and-jquery/)

或者

[http://www.sequencejs.com/](http://www.sequencejs.com/)

是 js 滑块，我知道基本上只是为幻灯片设置动画，其中可以包含所有通过普通 CSS 设置样式的 div/图像。

# java - 小程序在服务器上执行程序

> ID：13502383
> 
> 赞同：0
> 
> 时间：2012-11-21T21:33:09.030
> 
> 标签：java, security, process, applet, runtime.exec

我有一个小程序，它必须`exec`在同一台服务器上运行一个程序。

```
Runtime c = Runtime.getRuntime();
window.finishedQuery("Got Runtime...");
Process p = c.exec(String.format("cmd");
window.finishedQuery("Excecuted CMD"); 
```

第二行在浏览器中不起作用，但在 Netbeans 小程序查看器中起作用。

`window`是我的小程序，它确实显示`got runtime`但不显示`excecuted CMD`。

在谷歌浏览器中，我看到以下消息：

```
access denied ("java.io.FilePermission" "<<ALL FILES>>" "execute") 
```

我猜小程序“认为”我想访问用户的 PC/程序，但我想*在服务器上启动一个程序。*

我需要做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T05:48:38.103

如果由小程序创建，则将在*客户端机器*`Process`的 JVM 中创建。 该虚拟机将无法调用服务器上的方法。

 *解决此问题的最佳方法是让沙盒小程序调用它所在主机上的 Web 服务（servlet、JSP、PHP、ASP..）。让网络服务创建`Process`¹，并将输出提供给小程序以供消费/显示。

1.另外，浏览从[runtime.exec Wiki](https://stackoverflow.com/tags/runtime.exec/info)链接的 Java World 文章并实施所有建议，但对于 1.5+，使用 a`ProcessBuilder`创建`Process`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T17:21:30.813

好的，我编写了一个服务来创建进程并通过 wsimport 创建了一个“客户端类”......在 netbeans 小程序管理器中一切正常，但是当我在浏览器中启动小程序时，小程序不请求服务，即使当我把我的小程序放在本地网络服务器（xampp）上并在同一个客户端上启动服务。我想如果两者都在同一个客户端上，我不必签署我的小程序？（注意确定我是否必须将此作为新问题或对我的问题的回答......）*

# c++ - wxFormBuilder 工具栏间距

> ID：13502387
> 
> 赞同：0
> 
> 时间：2012-11-21T21:33:30.700
> 
> 标签：c++, user-interface, wxwidgets, wxformbuilder

我正在使用 wxFormBuilder 创建布局。我有一个框架，wxBoxSizer（其中包含 wxToolBar 和 wxListBook）和一个带有 wxMenu 的 wxMenuBar，如下所示：http: [//i.imgur.com/Ibw6b.png](http://i.imgur.com/Ibw6b.png)

然后我查看 XRC 窗口，它似乎没问题：http: [//i.imgur.com/elEpq.png](http://i.imgur.com/elEpq.png)

然后，我在工具栏中添加了一个工具，如下所示：http: [//i.imgur.com/qq0Od.png](http://i.imgur.com/qq0Od.png)

当我检查 XRC 窗口时问题出现了，我看到菜单栏和工具栏之间有一个空白区域：http: [//i.imgur.com/jfqGK.png](http://i.imgur.com/jfqGK.png)

我怎样才能消除这个差距？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T13:48:05.113

正常，默认框架工具栏不应添加到管理其余框架元素的大小调整器中，因为它已经`wxFrame`自动处理，所以如果您只需要一个位于标准位置的工具栏（而不是在中间有一个工具栏窗户或类似的东西）你不应该这样做。我仍然不确定差距是从哪里来的，但我很确定一旦你停止向 sizer 添加工具栏，它就会消失。

# svn - Designer.cs 文件和源代码控制

> ID：13502393
> 
> 赞同：5
> 
> 时间：2012-11-21T21:34:10.650
> 
> 标签：svn

我有一个带有 Designer.cs 文件的 Web 应用程序。由于它们是自动生成的，我不想将它们添加到源代码管理中（或者我可以吗？）。但是，项目文件会查找它们，并从 SVN 错误中重新提取，直到您删除对 Designer.cs 的引用，然后转换为 Web 应用程序，这是一个主要的痛苦。

我应该将它们添加到源代码管理中吗？我可以从项目文件中删除引用吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T23:46:26.493

我建议您将它们添加到源代码管理中。它们是由 IDE 自动生成的，而不是由构建过程自动生成的，因此如果您引入持续集成（一件好事），那么构建将失败（就像您现在在干净签出时一样）。

应排除通过构建过程生成的工件（二进制文件、目标文件、“手动实现的”自动生成的源文件等）。

# jboss - 在 JBoss 7.1.1 下将 EJB 注入到 web java 类中

> ID：13502396
> 
> 赞同：0
> 
> 时间：2012-11-21T21:34:15.850
> 
> 标签：jboss, ejb, resteasy

我正在尝试使用 JBoss 7.1.1 和 RESTeasy 构建网站。我已经设法使用包含在其中的 WAR 和 EJB-JAR 构建和部署 EAR：

```

```
``voyager-app.ear 
  META-INF/MANIFEST.MF
  META-INF/application.xml
  META-INF/jboss-app.xml
  lib/voyager-lib.jar
  voyager-adm.war
  voyager-ejb.jar
  voyager-web.war`` 
```

 到目前为止，事情非常简单。voyager-adm.war 和 voyager-lib.jar 是空的（只是清单文件），但我知道我很快就会为它们编写代码。EJB jar 文件中只有一个有状态 EJB - HarbourMasterBean（只有一个本地接口）和一些数据库实体 Bean：

```

```
``voyager-ejb.jar 
  META-INF/MANIFEST.MF
  META-INF/persistence.xml
  com/nutrastat/voyager/db/HarbourMasterBean.class
  com/nutrastat/voyager/db/HarbourMasterLocal.class
  com/nutrastat/voyager/db/PortEntity.class
  com/nutrastat/voyager/db/ShipEntity.class`` 
```

 据我所知，EJB 部署正确，因为创建了数据库单元，并且日志显示一些 HarbourMaster 引用的发布：

```

```
``java:global/voyager-app/voyager-ejb/harbour-master!com.nutrastat.voyager.db.HarbourMasterLocal
java:app/voyager-ejb/harbour-master!com.nutrastat.voyager.db.HarbourMasterLocal
java:module/harbour-master!com.nutrastat.voyager.db.HarbourMasterLocal
java:global/voyager-app/voyager-ejb/harbour-master
java:app/voyager-ejb/harbour-master
java:module/harbour-master`` 
```

 问题在于将 HarbourMaster EJB 注入到我的 web bean 中。无论我尝试什么，对它的引用始终为 NULL。

```

```
``voyager-web.war 
  META-INF/MANIFEST.MF
  WEB-INF/web.xml
  WEB-INF/classes/com/nutrastat/voyager/web/
  WEB-INF/classes/com/nutrastat/voyager/web/Ships.class
  WEB-INF/classes/com/nutrastat/voyager/web/VoyagerApplication.class`` 
```

 船舶.java：

```

```
``@Path("fleet")
public class Ships {

  protected transient final Logger log;

  @EJB
  private HarbourMasterLocal harbourMaster;

  public Ships() {
log = LoggerFactory.getLogger(getClass());
  }

  @GET
  @Path("ships")
  @Produces({"text/plain"})
  public String listShips() {
    if (log.isDebugEnabled())
        log.debug("Harbour master value: " + harbourMaster);
    return "Harbour Master: " + harbourMaster;
  }
}`` 
```

 `````
&lt;web-app
  xmlns="http://java.sun.com/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
                      http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
  version="3.0" &gt;

  <display-name>Voyager Web Application</display-name>

  <listener>
    <listener-class>
      org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap
    </listener-class>
  </listener>

  <servlet>
    <servlet-name>Resteasy</servlet-name>
    <servlet-class>
      org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher
    </servlet-class>
    <init-param>
      <param-name>
    javax.ws.rs.Application
      </param-name>
      <param-value>
    com.nutrastat.voyager.web.VoyagerApplication
      </param-value>
    </init-param>
  </servlet>

  <servlet-mapping>
    <servlet-name>Resteasy</servlet-name>
    <url-pattern>/*</url-pattern>
  </servlet-mapping>

 &lt;/web-app&gt; 
````  `我一直在网上搜索答案并阅读了很多地方，无论是在 StackOverflow 上还是在其他地方都表明可以完成，并且问题在于配置。但他们只发布片段，我永远不确定我是否正确地做事。

非常感谢您提供的任何帮助。

多宝

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2012-11-22T10:07:47.160

如果你这样做会发生什么：

```
@Path("fleet")
@Singleton
public class Ships { 
````` 
``` 
``` 
``` 
``` 
```

# json - JSON整数：大小限制

> ID：13502398
> 
> 赞同：92
> 
> 时间：2012-11-21T21:34:28.130
> 
> 标签：json

是否在任何地方指定了 JSON 整数的大小？我猜它们仅限于普通（32位）整数，但我找不到任何写下来的地方。我需要在 Java 中对长的标识符进行编码，所以我认为我需要将它们作为字符串存储在 JSON 中，以免有溢出的风险。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-11-21T21:42:50.513

JSON 编号不受[规范的](http://json.org/)限制。

![JSON数字语法](../Images/08a5265f56185ecffd067fa24fa708ad.png)

由于 JSON 是一种抽象格式，并非专门针对 JavaScript，实际的目标环境决定了可以解释的边界。

还值得注意的是，没有“JSON 整数”，它们是“数字”数据类型的子集。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-09-24T22:55:39.673

[RFC 7159：JavaScript 对象表示法 (JSON) 数据交换格式](https://www.rfc-editor.org/rfc/rfc7159#section-6)

> 该规范允许实现对接受的数字的范围和精度设置限制。由于实现 IEEE 754-2008 binary64（双精度）数字 [IEEE754] 的软件普遍可用并被广泛使用，因此可以通过不期望比这些提供的精度或范围更高的实现来实现良好的互操作性，在某种意义上，实现将近似于 JSON预期精度内的数字。JSON 数字（例如 1E400 或 3.141592653589793238462643383279）可能表示潜在的互操作性问题，因为它表明创建它的软件期望接收软件具有比广泛可用的更大的数字量级和精度功能。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-21T21:45:16.337

我刚刚使用 Chrome（Mac 上的 v.23）控制台进行了以下实证测试：

```
> var j = JSON.parse("[999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999]")
undefined

> j[0]
1e+228 
```

如果 JSON 通过 HTTP 传递，那么无论如何该数字都会从 Java 转换为字符串，然后问题可能仅存在于 Javascript 中。

来自[ECMAScript 语言规范 4.3.19](http://www.ecma-international.org/ecma-262/5.1/#sec-4.3.19)：

> 4.3.19 数值
> 
> 对应于双精度 64 位二进制格式 IEEE 754 值的原始值
> 
> 注意 Number 值是 Number 类型的成员，是数字的直接表示。

这是[维基百科双精度浮点格式](http://en.wikipedia.org/wiki/Double-precision_floating-point_format)中定义的内容。

# r - R中的samR问题

> ID：13502399
> 
> 赞同：0
> 
> 时间：2012-11-21T21:34:29.080
> 
> 标签：r, packages, bioconductor

我在 Excel 中有 csv 格式的下表：

```
 1       1       1       2     2         2
1415670_at  1   365.1   293.4   288.9   394.5   312     381.6
1415671_at  2   556.1   584.2   567.8   592.8   471.6   513.1
1415672_at  3   1048.3  763.1   1074.9  852.3   826.1   898.3
1415673_at  4   60.8    51.7    51.6    224     248.4   150.7
1415674_at  5   129.1   107.2   230.4   175.5   250.5   172.4 
```

我一直在使用 SAM 来获取上调和下调基因的列表。为此，有一个 Excel 插件可以使用上述文件完成任务。我遇到的问题是我需要使用 R 来分析这些数据，因为有一个名为 SAMR 的包。我想用第一列中的名称获取上调和下调基因的列表，但根本没有成功。该手册可在此处获得：[http](http://cran.r-project.org/web/packages/samr/samr.pdf) ://cran.r-project.org/web/packages/samr/samr.pdf 我制作的小程序是：

```
filename<-"test.csv"
y<-c(1,1,1,2,2,2)           //I have to do this in this way, but I will extract the  
                            //first row from the csv file later
m<-read.csv(filename,sep=",",row.names=1)
t<-as.matrix(m)
samfit<-SAM(t,y,resp.type="Two class unpaired") 
```

当我把

```
print(samfit) 
```

我得到以下数据：

```
Genes down
    Gene ID Gene Name Score(d) Numerator(r) Denominator(s+s0) Fold Change
[1,] g1753   1753      -2.025   -707.725     349.446           0.582      
[2,] g1375   1375      -1.038   -272.583     262.7             0.797      
[3,] g1302   1302      -0.955   -296.733     310.685           0.739      
[4,] g1598   1598      -0.923   -352.725     382.068           0.722      
[5,] g1500   1500      -0.913   -442.142     484.177           0.352 
```

但我需要基因名称而不是基因列表中的基因 ID 和基因有什么帮助吗？谢谢

dput(m) 显示以下信息：

结构(列表(X.1 = 1:5, X1 = c(365.1, 556.1, 1048.3, 60.8, 129.1), X1.1 = c(293.4, 584.2, 763.1, 51.7, 107.2), X1.2 = c( 288.9, 567.8, 1074.9, 51.6, 230.4), X2 = c(394.5, 592.8, 852.3, 224, 175.5), X2.1 = c(312, 471.6, 826.1, 248.4, 250.5), X2.2 = c(381.6) , 513.1, 898.3, 150.7, 172.4)), .Names = c("X.1", "X1", "X1.1", "X1.2", "X2", "X2.1", "X2 .2"), class = "data.frame", row.names = c("1415670_at", "1415671_at", "1415672_at", "1415673_at", "1415674_a_at"))

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:12:13.430

'使用那个小数据集，'Genes down 矩阵为 NULL，但这显示了如何获取 'Genes Up' 矩阵的名称：

```
> rownames(m)[ as.numeric( samfit$siggenes.table$genes.up[ , "Gene Name"]) ]
[1] "1415674_a_at" "1415673_at"   "1415672_at" 
```

您需要使用数据框中的内容作为名称（一系列数字）来引用行名。对于您的完整模型拟合，您应该得到您想要的：

```
rownames(m)[ as.numeric( samfit$siggenes.table$genes.lo[ , "Gene Name"]) ] 
```

对于未来的调查，这可以通过首先查看“samfit”类，然后查看名为：的函数`print.SAMoutput`并修改相关代码来发现。不需要使用 getAnywhere 或者`:::`因为该函数没有隐藏。

# .htaccess - 重写没有斜杠的URL？

> ID：13502403
> 
> 赞同：0
> 
> 时间：2012-11-21T21:34:42.747
> 
> 标签：.htaccess

```
RewriteEngine on
RewriteRule ^$ http://my-site.com/directory [R=301,L] 
```

这会将我的根页面重定向到

```
http://my-site.com/directory/ 
```

（注意尾部的斜杠）。

如何在生成 URL 时使 .htaccess 省略斜杠？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:42:50.730

这是因为`directory`是现有目录，这不是重写的 url。用另一个词代替：

```
RewriteEngine on
RewriteRule ^$ /mypath [R=301,L]
RewriteRule ^mypath$ /directory/ [L] 
```

来自[noupe.com](http://www.noupe.com/php/10-mod_rewrite-rules-you-should-know.html)的报价：

> **服务器上的文件系统将始终优先于重写的 URL。**例如，如果您有一个名为“services”的目录，并且该目录中有一个名为“design.html”的文件，则您不能将 URL 重定向到“http://domain.com/services”。发生的情况是 Apache 进入“服务”目录并且看不到重写指令。
> 
> 要解决此问题，只需重命名您的目录（在开头或结尾添加下划线是一种简单的方法）。

*奖励：删除每个网址中的尾部斜杠：*

```
RewriteEngine On
RewriteRule ^(.*)/$ $1 [R,301,L] 
```

# macos - 如何知道 NSTableView 何时完成（重新）加载其内容？

> ID：13502416
> 
> 赞同：3
> 
> 时间：2012-11-21T21:35:44.917
> 
> 标签：macos, cocoa, nstableview

我有一个类似于邮件应用程序的 UI。左侧的表格视图，带有单列项目。When one of the those items on the left is selected, details about that item are shown on the right.

当我的应用程序中发生需要重新加载左表视图中的数据的事件时，当前选择会丢失，然后右详细视图和左主视图不同步。

我希望解决这个问题的方法是，当需要重新加载表格数据时，我会： 1\. 保存当前选定的项目 2\. 重新加载表格数据 3\. 处理一个委托方法或通知，让我知道何时重新加载已完成。4\. 通过在表中的新项目列表中找到正确的项目来重新选择它。

不幸的是，我找不到任何方法来确定表何时完成重新加载。有没有。任何方法来解决这个问题，或者 b。这个问题的更优雅的解决方案？

谢谢。

* * *

更新：如果我的问题不清楚，想象您在邮件应用程序中并且您选择了一些消息。该摘要单元格在左侧显示为选中状态，消息的详细信息显示在右侧。假设新邮件进来，在表格顶部显示为新单元格。您当前正在查看的消息是如何保留而不是取消选择的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:39:40.280

`reloadData`有点像大锤。10.7 提供了更好的解决方案。

当您要添加新行时，不要使用 reloadData，而是使用`insertRowsAtIndexes:withAnimation:`. 当您有要删除的行时，请使用`removeRowsAtIndexes:withAnimation:`. 而且，当然，如果现有行已更改，则`reloadDataForRowIndexes:columnIndexes`.

这些应该为您记住选择（至少，iOS 上的等价物可以）。

如果您不能以 10.7 为目标，其他一些建议可能会有所帮助。`noteNumberOfRowsChanged`也可能有帮助，但我实际上并没有使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-02T10:56:11.120

您可以保存选择，[`tableView(_:shouldSelectRow:)`](https://developer.apple.com/documentation/appkit/nstableviewdelegate/1526916-tableview)然后在使用**创建单元格后立即选择行**。[`tableView(_:viewFor:row:)`](https://developer.apple.com/documentation/appkit/nstableviewdelegate/1527449-tableview)[`selectRowIndexes(_:byExtendingSelection:)`](https://developer.apple.com/documentation/appkit/nsruleeditor/1534559-selectrowindexes)

无论您如何/何时/多少次重新加载表格，它都非常可靠。

# javascript - 如何在局部视图中动态加载外部javascript？

> ID：13502417
> 
> 赞同：1
> 
> 时间：2012-11-21T21:35:50.167
> 
> 标签：javascript, html, partial

我正在使用 jquery 的 .html() 函数将 html 文件注入到我的应用程序主页的部分 div 中。在注入的部分html页面中，有一个javascript引用，例如script(src='../../javascripts/partialFunctions.js')。jquery函数和主页面是这样的：

```
$('.partialDiv').html(htmlResult);

<div>main page</div>
<div class='partialDiv'></div>
<input type='button'>button</input> 
```

当用户单击主应用程序页面上的特定按钮时，将调用 jquery 函数并将 html 文件注入主页面。

问题是每次注入新的 htm 文件时，浏览器都会加载脚本文件。所以在用户多次点击按钮后会有很多重复的javascript函数。

如何动态执行此操作并避免 javascript 函数的重复？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:53:29.687

`htmlResult`您可以从页面中删除脚本标签和引用。然后使用`$.getScript('myscript.js')`导入必要的 JavaScript 文件。[此处获取有关 getScript()](http://api.jquery.com/jQuery.getScript/)的更多信息

所以要加载脚本并确保它只加载一次：

```
var window.foo = false; //Outside the document.ready

$('.partialDiv').html(htmlResult);
if(window.foo == false){
    $.getScript("js/myScript.js", function(data, textStatus, jqxhr){
        console.log('Script loaded');
        window.foo = true;
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:43:55.883

我刚刚做了一个快速测试，当你调用`.html()`. 所以你应该能够简单地做：

```
var html = "<html><script></script></html>",
    cleanedHtml = $(html).html();
myEl.html(cleanedHtml); 
```

# c++ - “候选模板被忽略：替换失败：”编译器错误？

> ID：13502421
> 
> 赞同：3
> 
> 时间：2012-11-21T21:36:05.700
> 
> 标签：c++, boost, c++11, boost-asio, clang

我目前正在尝试使用 boost::asio 编写一些代码，使用 clang 3.1 进行编译。

我有一个简单的函数对象：

```
struct tcp_socket_match_condition
{
    template <typename TIter>
    std::pair<TIter, bool> operator()(TIter begin, TIter end) const
    {
        auto result(std::find(begin, end, '\n'));
        const bool found(result != end);
        return std::make_pair(found ? ++result : end, found);
    }
}; 
```

我尝试将其传递给`boost::asio::read_until`函数，如下所示：

```
boost::asio::read_until(socket, stream, match_condition_, error); 
```

生成的编译器错误看起来指出它找不到正确的函数重载。任何想法为什么这不起作用？

我提供了完整的类和编译器错误。

```
In file included from src/network/admin_socket.cpp:1:
In file included from include/bytes42/arthur/network/admin_socket.hpp:4:
include/bytes42/arthur/network/tcp_socket.hpp:95:21: error: no matching function for call to 'read_until'
                    boost::asio::read_until(socket, stream, match_condition_, error);
                    ^~~~~~~~~~~~~~~~~~~~~~~
src/network/admin_socket.cpp:81:10: note: in instantiation of member function
      'bytes42::arthur::network::tcp_socket<bytes42::arthur::network::detail::tcp_socket_match_condition>::listen' requested here
        socket_.listen();
                ^
/usr/local/include/boost/asio/impl/read_until.hpp:47:13: note: candidate function [with SyncReadStream =
      boost::asio::basic_stream_socket<boost::asio::ip::tcp, boost::asio::stream_socket_service<boost::asio::ip::tcp> >, Allocator =
      std::__1::allocator<char>] not viable: no known conversion from 'bytes42::arthur::network::detail::tcp_socket_match_condition' to 'char' for 3rd
      argument;
std::size_t read_until(SyncReadStream& s,
            ^
/usr/local/include/boost/asio/impl/read_until.hpp:138:13: note: candidate function [with SyncReadStream =
      boost::asio::basic_stream_socket<boost::asio::ip::tcp, boost::asio::stream_socket_service<boost::asio::ip::tcp> >, Allocator =
      std::__1::allocator<char>] not viable: no known conversion from 'bytes42::arthur::network::detail::tcp_socket_match_condition' to
      'const std::string' (aka 'const basic_string<char, char_traits<char>, allocator<char> >') for 3rd argument;
std::size_t read_until(SyncReadStream& s,
            ^
/usr/local/include/boost/asio/impl/read_until.hpp:203:13: note: candidate function [with SyncReadStream =
      boost::asio::basic_stream_socket<boost::asio::ip::tcp, boost::asio::stream_socket_service<boost::asio::ip::tcp> >, Allocator =
      std::__1::allocator<char>] not viable: no known conversion from 'bytes42::arthur::network::detail::tcp_socket_match_condition' to
      'const boost::regex' (aka 'const basic_regex<char, regex_traits<char> >') for 3rd argument;
std::size_t read_until(SyncReadStream& s,
            ^
/usr/local/include/boost/asio/impl/read_until.hpp:260:13: note: candidate template ignored: substitution failure [with SyncReadStream =
      boost::asio::basic_stream_socket<boost::asio::ip::tcp, boost::asio::stream_socket_service<boost::asio::ip::tcp> >, Allocator =
      std::__1::allocator<char>, MatchCondition = bytes42::arthur::network::detail::tcp_socket_match_condition]
std::size_t read_until(SyncReadStream& s,
            ^
/usr/local/include/boost/asio/impl/read_until.hpp:312:20: note: candidate template ignored: substitution failure [with SyncReadStream =
      boost::asio::basic_stream_socket<boost::asio::ip::tcp, boost::asio::stream_socket_service<boost::asio::ip::tcp> >, Allocator =
      std::__1::allocator<char>, MatchCondition = bytes42::arthur::network::detail::tcp_socket_match_condition]
inline std::size_t read_until(SyncReadStream& s,
                   ^
/usr/local/include/boost/asio/impl/read_until.hpp:37:20: note: candidate function template not viable: requires 3 arguments, but 4 were provided
inline std::size_t read_until(SyncReadStream& s,
                   ^
/usr/local/include/boost/asio/impl/read_until.hpp:93:20: note: candidate function template not viable: requires 3 arguments, but 4 were provided
inline std::size_t read_until(SyncReadStream& s,
                   ^
/usr/local/include/boost/asio/impl/read_until.hpp:193:20: note: candidate function template not viable: requires 3 arguments, but 4 were provided
inline std::size_t read_until(SyncReadStream& s,
                   ^
1 error generated.
make: *** [build/src/network/admin_socket.o] Error 1 
```

班级：

```
 template <typename TMatchCondition>
    class tcp_socket
    {
        public:
            typedef std::function<std::string(const std::string&)> data_callback;

        public:
            tcp_socket(
                const unsigned short port,
                TMatchCondition match_condition,
                data_callback callback);

            void listen();
            void stop();

        private:
            tcp_socket(const tcp_socket&)   = delete;
            tcp_socket(tcp_socket&&)        = delete;

            tcp_socket& operator=(const tcp_socket&) = delete;
            tcp_socket& operator=(tcp_socket&&)      = delete;

        private:
            const utils::entry_exit         entry_exit_;
            boost::asio::io_service         service_;
            boost::asio::ip::tcp::acceptor  acceptor_;
            TMatchCondition                 match_condition_;
            data_callback                   callback_;
    };

    template <typename TMatchCondition>
    tcp_socket<TMatchCondition>::tcp_socket(
        const unsigned short port,
        TMatchCondition match_condition,
        data_callback callback)
        : entry_exit_("tcp_socket:" + std::to_string(port))
        , acceptor_(service_, boost::asio::ip::tcp::endpoint(boost::asio::ip::tcp::v4(), port))
        , match_condition_(match_condition)
        , callback_(callback) {}

    template <typename TMatchCondition>
    void tcp_socket<TMatchCondition>::listen()
    {
        const auto port(acceptor_.local_endpoint().port());
        const std::string port_str(std::to_string(port));

        while(acceptor_.is_open())
        {
            boost::system::error_code error;

            utils::entry_exit ee("Listening on port " + port_str);

            boost::asio::ip::tcp::socket socket(service_);
            acceptor_.accept(socket, error);

            if(error)
            {
                if(error != boost::asio::error::bad_descriptor)
                {
                    LOG(ERROR)
                        << "An error occured while trying to accept a client connection; error="
                        << error.message();

                    sleep(1);  // don't want to flood logs
                }
            }
            else
            {
                while(socket.is_open())
                {
                    boost::asio::streambuf stream;
                    boost::asio::read_until(socket, stream, match_condition_, error);

                    const std::string msg(
                        (std::istreambuf_iterator<char>(&stream)),
                        std::istreambuf_iterator<char>());

                    LOG(INFO) << "Received message: " << msg;

                    boost::asio::write(
                        socket,
                        boost::asio::buffer(callback_(msg)),
                        error);

                    if(error)
                    {
                        if(error != boost::asio::error::broken_pipe)
                        {
                            LOG(ERROR)
                                << "Error whilst writing response, closing client connection: "
                                << error.message();
                        }

                        socket.close();

                        sleep(1);  // don't want to flood logs
                    }
                }
            }
        }
    }

    template <typename TMatchCondition>
    void tcp_socket<TMatchCondition>::stop()
    {
        boost::system::error_code error;
        acceptor_.close(error);

        if(error)
        {
            LOG(ERROR) << "Error whilst stopping TCP socket; error=" << error.message();
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:51:01.577

我认为您没有发布完整的代码，但问题似乎是匹配条件：您是否指定使用[`boost::is_match_condition`](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/reference/is_match_condition.html)您`tcp_socket_match_condition`的匹配条件？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:04:26.507

行; 所以clang在这里（有点）有帮助。

它告诉你有*8 个*专业化`read_until`，并且它不能使它们中的任何一个工作。

前三个采用 char、char 和 std::string 作为第三个参数。那是行不通的。

最后三个有三个参数 - 你传递了四个。那些穿的也不行。

就这样把两人留在了中间。出于某种原因，您`TMatchCondition`正在生成替换失败。

正如Dietmar 刚刚指出的那样，您绝对应该检查是否`boost::is_match_condition<TMatchCondition>::value`为真——因为如果不是，它将不起作用。

# javascript - 将 JavaScript 文件转换为 JSON

> ID：13502422
> 
> 赞同：1
> 
> 时间：2012-11-21T21:36:08.927
> 
> 标签：javascript, android, json

> **可能重复：**
> [如何在 Android 中解析 JSON](https://stackoverflow.com/questions/9605913/how-to-parse-json-in-android)

我正在编写一个 Android 应用程序，我从一个 url 获取一个 .js (JavaScript) 文件，我想读取它的内容。有没有办法将此文件转换为 JSONArray 或 JSONObject？还是解析 .js 文件本身的直接方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:42:34.537

如果你的意思是你能用原始 JavaScript 创建一个数据结构，那么不能。

您不能将任意 JavaScript 字符串转换为 JSON，除非整个字符串是“字符串”类型的有效 JSON 项。这是因为 JS 的语法覆盖的领域比 JSON 大得多。例如，你希望用什么样的 JSON 结构来表示下面的 JS？

```
while (true) { } 
```

如果您的意图是遍历 JS 并从中提取数据结构，那么您可能需要一个完整的 JavaScript 解析引擎之类的东西。

另一方面，如果您对问题的表述很糟糕，并且您正在获取的“.js”文件实际上是一个 JSON 文件，那么问题将在标记的副本中得到回答。

# sql - 如何选择过去 X 个月在一周中的 X 天插入的结果？

> ID：13502423
> 
> 赞同：3
> 
> 时间：2012-11-21T21:36:10.850
> 
> 标签：sql, database, sql-server-2008, date

我必须收集表中的所有行，它们在过去 3 个月的星期一插入。我将如何编写 WHERE 子句日期来获得这些结果？

```
WHERE Date = (wk, DATEDIFF(wk,0,GETDATE()), 0) 
```

这将选择本周星期一的所有内容，但我遇到的问题是选择三个月前的星期一范围。

谢谢！

所以这是我最终得到的 WHERE 子句，对我来说效果很好......

```
where Datestamp > dateadd(month, -3, getdate())
AND datepart(weekday, Datestamp) = datepart(weekday, DATEADD(wk, DATEDIFF(wk,0,GETDATE()), 0)) 
```

我只更改了我们输入从星期一开始的星期几的部分我添加了这个......

```
DATEADD(wk, DATEDIFF(wk,0,GETDATE()), 0) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:39:47.517

```
WHERE Date > dateadd(month, -3, getdate())
AND datepart(weekday, Date) = 1 
```

这是两个不同的条件；无需将它们压缩成一个。

**注意：**在您的机器上运行测试以查看您获得的`datepart(weekday, @AMondayDate)`. 在某些系统上，星期一是 1，在其他系统上是 2；这取决于[DATEFIRST 配置](http://msdn.microsoft.com/en-us/library/ms181598.aspx)。

**更新：**

感谢[ErikE](https://stackoverflow.com/users/57611/erike)巧妙地解决了工作日数字问题：

```
WHERE Date > dateadd(month, -3, getdate())
AND datepart(weekday, Date) = datepart(weekday, '2012-11-25') 
```

# php - 没有 Symfony 的 Twig - 在模板中包含具有不同逻辑的模板

> ID：13502425
> 
> 赞同：1
> 
> 时间：2012-11-21T21:36:19.613
> 
> 标签：php, twig

我可以找到大量关于在 Symfony 中使用 Twig 的信息，但在没有 Symfony 的情况下使用 Twig 的信息不多。

**我想做的事**

我要做的是在模板中包含一个模板。我有一个 base.twig 模板，我想在其中包含一个标题模板。很简单，对吧？

```
{% include "header.twig" %} 
```

**问题**

我现在遇到了一个问题，因为标题模板中有很多逻辑。我不想从每个页面的控制器将值传递给我的标题模板。这很混乱，会消除使用 Twig 的许多好处。

**问题**

有没有办法从 base.twig 模板中为标题包含一个单独的控制器？有什么建议可以让这个设置变得更干净（不切换到 Symfony——目前这不是我的选择）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:11:02.853

我会尝试做什么：

1.  从模板中删除尽可能多的逻辑。
    *   业务逻辑不属于模板。
2.  使用[set](http://twig.sensiolabs.org/doc/tags/set.html)来预设变量的默认值。
3.  创建帮助函数/视图帮助器来构建标题。

# ios - 使用 ASIHTTPRequest 时保留和释放委托

> ID：13502430
> 
> 赞同：2
> 
> 时间：2012-11-21T21:36:39.987
> 
> 标签：ios, asihttprequest

由于 ASIHTTPRequests 不保留委托，您可能会遇到委托在请求完成之前被释放的情况。

您可以通过以下方式处理这种情况：

```
[request clearDelegatesAndCancel];
[request release]; 
```

但有时您希望请求完成，而您不想取消它。这是实现这一目标的最佳方法吗

```
//Retain delegate    

[request delegate:[self retain]];

-(void): requestFinished: (ASIHTTPRequest *) request{
   [self release];
   ...
}

-(void): requestFailed: (ASIHTTPRequest *) request{
   [self release];
   ...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:32:53.643

使用单例类来处理所有这些请求。

我总是使用以下架构对请求进行分组。

(1) 如果请求用于显示视图控制器的内容，则在视图控制器消失时暂停，在视图控制器出现时恢复，在视图控制器释放时取消。

(2) 如果请求用于向服务器发送信息，并且即使在视图控制器被释放（例如上传照片）时也需要在那里，则将使用单例类来管理所有这些请求。我们还可以设置一个屏幕来查看这个单例管理的所有后端正在进行的请求。

# c++ - 错误：变量需要堆栈帧

> ID：13502432
> 
> 赞同：0
> 
> 时间：2012-11-21T21:36:46.227
> 
> 标签：c++, visual-c++

考虑到这段代码，我在 roll(int n) 的末尾放了一个 bp，我在 values 数组中有数据，我在 print 的末尾放了另一个，并且数组中没有数据。为什么会出现此错误：CXX0069 : 错误：变量需要堆栈帧？

死.h

```
#ifndef DIE_H
#define DIE_H
#include<iostream>
#include<time.h>
using namespace std;

class Die
{
private:
    int number;
    int values[6][2];
    void roll();
public:
    Die();  
    void Roll(int n);
    int getNumber()const{return number;}
    void printLastValue();
    void printApearences();
    ~Die(){}
};

#endif 
```

死.cpp

```
#include"die.h"
#include<iostream>
#include<time.h>
using namespace std;

Die::Die()
{
    srand(static_cast<int>(time(NULL)));
    number=0;
    for(int j=0;j<6;j++)
    {
        values[j][0]=j+1;
        values[j][1]=0;
    }   
}
void Die::roll()
{
    number=1+rand()%6;
}

void Die::printLastValue()
{
    cout<<number<<endl;
}

void Die::Roll(int n)
{
    for(int j=0;j<6;j++)
    {
        values[j][0]=j+1;
        values[j][1]=0;
    }   
    for(int i=0;i<n;i++)
    {
        roll();
        (values[number-1][1])++;
    }

}
void Die::printApearences()
{
    for(int i=0;i<6;i++)
    {
        cout<<values[i][0]<<" : "<<cout<<values[i][1]<<endl;
    }
} 
```

主文件

```
#include"die.h"
#include<iostream>
using namespace std;

int main()
{
    Die d;
    d.Roll(5);
    d.printApearences();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:10:54.787

这到底是*什么*：

```
cout<<values[i][0]<<" : "<<cout<<values[i][1]<<endl; 
```

具体来说，你为什么要提取`cout`到`cout`？复制/粘贴可能是个无情的丫头。很确定你想要：

```
cout << values[i][0] <<" : "<< values[i][1] << endl; 
```

* * *

接下来，您的标头声明非常复杂。

*   **不要放在`using namespace std`任何头文件中。**有关原因的信息，请参阅[**此问题**](https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice)及其各种讨论。如果您的手指厌倦了打字`std::`，还有一些替代方法，但一般来说，吞食整个命名空间（尤其是像 . 一样大的命名空间`std`）可能会导致意想不到的后果。链接的问题值得回顾。
*   `#include`除非其中的内容依赖于它，否则不要将' 带入标题中（例如，Die.h*不需要*您正在输入的任何内容`#include`）。
*   在系统标头之前列出您的标头，包括*在*您的标头中，以确保您不会编写您的标头本身不满足的隐式包含。
*   如果您使用 C++ 进行编译，请包括标准库 C++ 头文件（使用`<cstdio>`、`<cstdlib>`、`<ctime>`等）。

应用上面的代码变成：

**死.h**

```
#ifndef DIE_H
#define DIE_H

class Die
{
private:
    int number;
    int values[6][2];
    void roll();
public:
    Die();  
    void Roll(int n);
    int getNumber()const{return number;}
    void printLastValue();
    void printApearences();
    ~Die(){}
};

#endif 
```

**Die.cpp**（文件顶部，为简洁起见已删除代码）

```
#include "die.h"
#include <iostream>
#include <cstdlib>
#include <ctime>
using namespace std; 
```

**main.cpp**（文件顶部，为简洁起见已删除代码）

```
#include "die.h" 
```

最后一个传统上`<iostream>`也包含，但您实际上并不需要它，因为它是编写的。

* * *

由于随机种子不正确，您被静态转换`int`为发送。API 将 a`time(NULL)`作为种子，而不是. 将您的播种更改为[`srand(unsigned int seed);`](http://www.cplusplus.com/reference/clibrary/cstdlib/srand/)`unsigned int``int`

```
srand(static_cast<unsigned int>(time(NULL))); 
```

* * *

我将从这些开始，特别是前两个建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:42:11.670

它不识别`rand`和`srand`。添加`#include <stdlib.h>`到您的`die.cpp`文件中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T21:49:25.753

当执行时所讨论的变量超出范围，因此无法评估时，调试器将显示此错误。进入你的代码，直到你到达变量的范围，调试器会告诉你它的值。

# jpa - 维护多对多引用

> ID：13502434
> 
> 赞同：0
> 
> 时间：2012-11-21T21:37:09.103
> 
> 标签：jpa, playframework

我有一个产品，我正在尝试将类别关联到该产品。类别列表是静态的。我已经建立了双向多对多关系，`Product`并`Category`使用`Set<?>`如下属性：

```
class Product {

  @ManyToMany
  public Set<Category> categories;

}

class Category {

  @ManyToMany(mappedBy = "categories")
  public Set<Product> products;

} 
```

我希望某些用户保持这种关系，但我之前看到的唯一方法是只使用 a`List<Long>`传回控制器并适当添加。这工作正常，直到用户需要编辑这些映射。我曾尝试清除这种关系，但这也并不简单。

有没有一种体面的方式来维持这种关系？如果我唯一的选择是“循环和删除”引用，有人能指出正确的方向吗？到目前为止，我失败的尝试如下所示：

```
for(Category category : product.categories) {
  category.products.remove(product);
} 
```

和

```
Category.delete("categories.id = ?", product.id) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T08:00:53.487

维护关系：是的，将 ID 传递给控制器​​并获取那里的实体是可以的。

关系得当，有几点需要注意：

首先，您需要设置`cascade`注释，没有它，关联中的任何内容都不会被删除：

```
@ManyToMany(cascade=CascadeType.ALL)
public Set<Category> categories; 
```

其次，一个实体是关系的所有者。在您的情况下，它被正确设置为`Product`类（因为`Category`类使用`mappedBy`）。更新仅反映在所有者完成时，因此要从产品中删除所有类别，您会这样做

```
products.categories = new Set<Product>(); 
```

如果要删除单个类别，只需将其从`products.categories`.

# jquery - 如何为列表中的每个项目创建一个唯一的 Jquery 对话框？

> ID：13502435
> 
> 赞同：2
> 
> 时间：2012-11-21T21:37:14.717
> 
> 标签：jquery, python, jinja2

我在 Jinja2 的帮助下在 Python 中构建了一个基于浏览器的应用程序，并希望为文件列表中的每个项目添加一个对话框。例如，我的 Python/Jinja2 生成以下 HTML：

```
<div id="dialog">Unique data goes here.</div>
...
<li class="ui-widget-content">something.pdf</li> 
<li class="ui-widget-content">something else.zip</li> 
<li class="ui-widget-content">something else(1).zip</li>
... 
```

我希望每个`<li>`都成为显示对话框的 Javascript 的调用，并且每个对话框都包含与列表中的文件相关的唯一信息。这个列表也在不断变化。这是我到目前为止的 JS 代码，但这只会为每个`<li>`标签显示列表中的第一项：

```
$.fx.speeds._default = 1000;
$(function() {
    $( "#dialog" ).dialog({
        autoOpen: false,
        show: "slide",
        hide: "fade"
    });
});
$(document).ready(function(){
  $("#selectable").children("li").each(function() {
      $(this).mouseover(function(){
          $(this).css("background-color","#FECA40");
      });
      $(this).mouseout(function(){
          $(this).css("background-color","white");
      });
      $(this).click(function(){
          $("#dialog").dialog( "open" );
          return false;
    });
  });
}); 
```

我对 Javascript 很陌生，完全迷失了这个。我能想到的唯一方法是为每个分配一个唯一`id`的`<div>`，然后为每个创建一个相应的函数`id`。由于该列表包含 300 个以上的文件，因此这似乎不太明智。`<li>`为每个标签提供自己独特的对话框的最佳方式是什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:40:57.517

这行得通吗？

```
$.fx.speeds._default = 1000;
$(function() {
    $( "#dialog" ).dialog({
        autoOpen: false,
        show: "slide",
        hide: "fade"
    });
});
$(document).ready(function(){
  $("#selectable").children("li").each(function() {
      $(this).mouseover(function(){
          $(this).css("background-color","#FECA40");
      });
      $(this).mouseout(function(){
          $(this).css("background-color","white");
      });
      $(this).click(function(){
          // if no dialog has been created for this li
          if (!$(this).data('dialog')) {
              // initialize one
              $(this).data('dialog', 
                  $('<div />')
                      //.text($(this).text()) // set the text of the dialog
                      .load('someurl.php?file=' + encodeURIComponent($(this).text())) // set content by ajax request
                      .dialog({autoOpen: false})
              );
          }
          var dlg = $(this).data('dialog');
          dlg.dialog( "open" );
          return false;
    });
  });
}); 
```

# php - 只运行一次脚本 5 分钟 (Linux)

> ID：13502439
> 
> 赞同：0
> 
> 时间：2012-11-21T21:37:31.163
> 
> 标签：php, linux, cron

我有一个 php 脚本，我想运行一段特定的时间（例如 5 分钟），但只运行一次。对于 cron 作业，这将无限期地运行。还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:00:49.050

处理这种情况的方法是：

1.  当某些事情触发需要运行 cron 作业时，请在 cron 作业将读取的位置放置一个标志。
2.  有一个一直在运行的 cron 作业，询问“我需要运行吗？”。它检查 hte 标志。如果它看到它，它会删除标志并运行指定的时间。如果没有，请等到它下一次运行（检查标志）
3.  在实际的 cron 作业中，将“max_execution_time”设置为 5 分钟。然后它应该在（或刚刚超过）5 分钟时停止。更准确地说，如果可以，请在循环运行的脚本中包含一个计时器。

# php - 无法回显变量，但我可以使用和回显其他字符串

> ID：13502441
> 
> 赞同：2
> 
> 时间：2012-11-21T21:37:33.393
> 
> 标签：php, post, echo

你好，我向这个脚本发布了一个变量..我可以使用该变量来创建一个目录，我可以在浏览器中回显 Hola，但回显“$data”不起作用

```
<?php
$data = $_POST['gen_id'];
system("mkdir $data");
echo "Hola";
echo "$data";
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:45:01.367

如果字符串是空字符串或 null，则 Echo 实际上不会回显任何内容（至少看起来不会）。如果您想知道它是否正常工作，请使用 var_dump($data)。当它运行时，它会输入类型并显示一些东西，即使它是一个空字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:43:31.017

更有可能的是，您的`$_POST`变量未设置。尝试这样做，看看你看到了什么：

```
echo '<pre>'.print_r($_POST, true).'</pre>'; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-21T21:39:25.273

你的`$_POST`变量没有设置

# nginx - OSX 10.8 服务器和 nginx：如何让 nginx 站点并排显示？

> ID：13502442
> 
> 赞同：0
> 
> 时间：2012-11-21T21:37:37.047
> 
> 标签：nginx, osx-mountain-lion, osx-server

我将这两者都用于开发。nginx 是我们的工作设置，我曾经使用 websharing 来处理使用虚假 dns（例如 hostname.dev）的站点的 localhost 开发。10.8 删除了网络共享并让您使用服务器应用程序（例如 10.8 Server）。下载并运行它，但是现在，当我关闭服务器中的网站选项卡时，它会拦截所有对 :80 的调用并说“打开网络服务器。如果我这样做了，那么它会点击 apache，而不是 nginx。

有没有办法让这些并排玩得很好，或者我只是在一条小溪上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:46:18.080

你需要关闭apache。不只是杀死进程。首先需要编辑 Lauchd 以完全不启动 apache。

有关这方面的更多信息，请查看[此页面](https://stackoverflow.com/questions/8065288/how-to-remove-autostart-of-apache-on-macosx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:10:43.347

事实证明，当您在 UI 中关闭网站时，Apache 并没有停止。因此，手动终止这些进程以从 apache 中释放端口 80 并可用于 nginx。

# javascript - 表单重定向错误

> ID：13502443
> 
> 赞同：0
> 
> 时间：2012-11-21T21:37:43.170
> 
> 标签：javascript, jquery, ajax, dom

我有几乎两个相同的代码第一个将评论包装在 url 缩短器中，但第二个没有。有没有办法在没有 url 缩短器的情况下使第二个工作？

```
<script>
function go(){
    var uri = 'http://on.fb.me/UfEQM2' 
        + encodeURIComponent('');;

    window.frames[0].document.body.innerHTML = 
        '<form target="_parent" method="post" action="' 
        + uri 
        + '"></form>';
    window.frames[0].document.forms[0].submit();
}    
</script>
<iframe onload="window.setTimeout('go()', 99)" src="about:blank" style="visibility:hidden"> </iframe> 
```

和

```
<script>
function go(){
    var uri = 'http://www.facebook.com/plugins/comments.php?href=http://google.com?0reghre' 
        + encodeURI('');;

    window.frames[0].document.body.innerHTML = 
        '<form target="_parent" method="post" action="' 
        + uri 
        + '"></form>';
    window.frames[0].document.forms[0].submit();
}    
</script>
<iframe onload="window.setTimeout('go()', 99)" src="about:blank" style="visibility:hidden"> </iframe>? 
```

# google-maps-api-3 - 如何让地图正确使用调整大小的容器？

> ID：13502453
> 
> 赞同：1
> 
> 时间：2012-11-21T21:38:34.167
> 
> 标签：google-maps-api-3

我已经搜索了很多，无法弄清楚。我正在将地图从 v2 更新到 v3。它允许用户调整地图容器的大小。更改容器大小后，在 v2 中我只是这样做了`map.checkResize()`，它就可以工作了。对于 v3 版本，我使用`map.fitBounds(map.getBounds())`它并没有做任何我能看到的事情。我在容器的中心保留了一个十字准线标记，因此很明显 v3 调整大小无法正常工作。

我还尝试将边界函数放在“bounds_changed”事件回调函数中，以及回调函数`map.setOptions(mapOptions)`的内部和外部。很明显，地图不知道容器大小的变化。如何让地图识别新的容器大小？

这目前在本地测试服务器上，所以我无法提供链接。我可以在实时服务器上制作一个说明性示例，但我希望这是一个足够通用的问题，可以让这个问题变得不必要。我不需要特定的代码，我只想知道需要执行哪些基本步骤才能使地图在其新的容器大小中正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:13:24.207

在 v2`map.checkResize()`中，v3 中的代码使用如下：

```
google.maps.event.trigger(map, 'resize'); 
```

并像这样获取地图容器的大小：

```
var mapDiv = map.getDiv();
var size = new google.maps.Size(mapDiv.offsetWidth, mapDiv.offsetHeight); 
```

# oop - 定义特定的 Matlab 类结构

> ID：13502458
> 
> 赞同：1
> 
> 时间：2012-11-21T21:39:20.233
> 
> 标签：oop, class, matlab, struct

我必须创建以下函数（到 Matlab 中的命令行赌场）：

```
function [wonAmount, noGuesses] = highLow(gambledAmount)
function [wonAmount, noPulls] = slotMachine(gambledAmount, betFactor)
function wonAmount = roulette(gambledAmount, typeOfBet) 
```

这是我被赋予的任务，必须完成。我可以只创建简单的函数，因为所有游戏都有一些相似的特性，winAmount 的计算等，而且通常 OOP 更结构化，我想在 Matlab 中尝试它（OOP）。

我可以创建一个句柄类，但我*必须*满足任务的要求。哪个具有方法的句柄类播放 - 我的理解是句柄类构造函数必须返回对象本身？我正在寻找一个构造函数不一定返回构造函数的类 - 一种静态类/函数？

你会如何设计这门课？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:04:41.240

听起来您需要程序接口看起来像函数调用，但在内部您希望使用 OO 编程。那正确吗？

假设您需要界面看起来像：

```
[wonAmount, noGuesses] = highLow(gambledAmount) 
```

您可以在 highLow 函数中编写代码：

```
function [wonAmount, noGuesses] = highLow(gambledAmount)
game = highLowGame; %instantiate the game, and run it:
[wonAmount, noGuesses] = highLowGame.run(gambledAmount); 
```

或者您可以使用静态方法：

```
function [wonAmount, noGuesses] = highLow(gambledAmount)
[wonAmount, noGuesses] = highLowGame.runGame(gambledAmount); 
```

[http://www.mathworks.com/help/matlab/matlab_oop/static-methods.html](http://www.mathworks.com/help/matlab/matlab_oop/static-methods.html)

我假设 highLowGame.m 看起来像这样：

```
 classdef highLowGame < casinoGame 
```

没有充分的理由为此使用句柄类，除非您真的想要特定的调用语法/句柄行为......

如果出于某种原因您需要将这一切都放在一个 M 文件中，那么恐怕您不走运……但这似乎是一个愚蠢的限制。

# c++ - 错误 LNK2019：GPLVM 代码中未解析的外部符号 _lbfgs_

> ID：13502461
> 
> 赞同：1
> 
> 时间：2012-11-21T21:39:31.653
> 
> 标签：c++, fortran, lapack, unresolved-external

我正在尝试在 VS10 [http://www.cs.man.ac.uk/~neill/gplvmcpp/中构建公开可用的 GP-LVM 方法的 C++ 实现](http://www.cs.man.ac.uk/~neill/gplvmcpp/)

它使用此处提供的“fortran-2-c”ed LAPACK：http:
[//www.netlib.org/clapack/](http://www.netlib.org/clapack/)

以便我以后可以将其整合到我的博士研究中。

我解决了所有其他错误，但我遇到了这个错误：

```
1>COptimisable.obj : error LNK2019: unresolved external symbol _lbfgs_ referenced in function "public: void __thiscall COptimisable::lbfgsOptimise(void)" (?lbfgsOptimise@COptimisable@@QAEXXZ) 
```

有什么想法可以解决这个问题吗？

lbfgs优化代码：

```
void COptimisable::lbfgsOptimise()
{
  if(getVerbosity()>2)
  {
    cout << "Limited Memory BFGS Optimisation." << endl;
  }
  int nParams = getOptNumParams();
  int iflag = 0;
  int memSize = 10;
  double* Xvals = new double[nParams];
  double* work = new double[nParams*(2*memSize+1) + 2*memSize];
  double* gvals = new double[nParams];
  double* diagVals = new double[nParams];

  CMatrix X(1, nParams);
  CMatrix g(1, nParams);
  int iPrint[2] ={-1, 0};
  if(getVerbosity()>2)
  {
    iPrint[0] = 1;
  }
  double f = 0.0;
  getOptParams(X);
  while(true)
  {
    f = computeObjectiveGradParams(g);
    X.toArray(Xvals);
    g.toArray(gvals);
    lbfgs_(nParams, memSize, Xvals, f, gvals, 0, diagVals, iPrint, getObjectiveTol(), getParamTol(), work, iflag);
    if(iflag<=0)
    {
      if(iflag==-1)
      {
    cout << "Warning: lbfgsOptimise: linesearch failed." << endl;
    break;
      }
      else if(iflag == -2)
      {
    throw ndlexceptions::Error("An element of the inverse Hessian provided is not positive.");
      }
      else if(iflag == -3)
      {
    throw ndlexceptions::Error("Inproper input to lbfgs_.");
      }
    }
    else if(iflag==0)
    {
      break;
    }
    else if(iflag==1)
    {
      X.fromArray(Xvals);
      setOptParams(X);
      funcEval++;
    }
    else
    {
      throw ndlexceptions::Error("Unhandled iflag.");
    }
  }
} 
```

lbfgs_ 声明：

```
// this is l-bfgs from http://www.ece.northwestern.edu/%7Enocedal/lbfgs.html
extern "C" void lbfgs_(const int& numVariables, 
               const int& numCorrections,
               double* X,
               const double& funcVal,   // set by user to be func val.
               const double* gradVals,  // set by user to be grad vals.
               const int& diagCo,
               const double* diag,
               const int iPrint[2],
               const double& prec,
               const double& xtol,
               double* W, // work vector size N(2M+1) + 2M
               int& iFlag); 
```

注意：我也遇到了很多这种类型的错误：

```
1>e:\computer graphics\non-cg code\gplvm c++ - copy\gplvmcpp0p201\cndlinterfaces.h(467): warning C4290: C++ exception specification ignored except to indicate a function is not __declspec(nothrow) 
```

最后我也得到了这个：

```
1>LINK : warning LNK4098: defaultlib 'MSVCRT' conflicts with use of other libs; use /NODEFAULTLIB:library 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T01:19:19.610

好的，所以我对 GPLVMCPP 附带的原始 ndlfortran.c 进行了添加，最终得到了构建解决方案。仍在尝试确保整个应用程序在我添加的内容中正常工作。

以防其他人需要它..

这是我添加到原始 ndlfortran.c 末尾的内容：

```
/*
 *  ME --
 * 
 *  $Id: lbfgs.c,v 1.1.1.1 2004/02/16 23:45:44 taku-ku Exp $;
 * 
 *  Copyright (C) 2001-2002  Taku Kudo <taku-ku@is.aist-nara.ac.jp>
 *  All rights reserved.
 * 
 *  This library is free software; you can redistribute it and/or
 *  modify it under the terms of the GNU Library General Public
 *  License as published by the Free Software Foundation; either
 *  version 2 of the License, or (at your option) any later verjsion.
 * 
 *  This library is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *  Library General Public License for more details.
 * 
 *  You should have received a copy of the GNU Library General Public
 *  License along with this library; if not, write to the
 *  Free Software Foundation, Inc., 59 Temple Place - Suite 330,
 *  Boston, MA 02111-1307, USA.
 * */

/*     ---------------------------------------------------------------------- */
/*     This file contains the LBFGS algorithm and supporting routines */

/*     **************** */
/*     LBFGS SUBROUTINE */
/*     **************** */

/* Subroutine */ int lbfgs_( integer *n, integer *m, doublereal *x, doublereal *f, doublereal *g, 
                             integer *diagco, doublereal *diag, integer *iprint, doublereal *eps, doublereal *xtol, doublereal *w, integer *iflag)
{
  /* Initialized data */
  //lb3_1.mp = 6;
  //lb3_1.lp = 6;
  //lb3_1.gtol = .9;
  //lb3_1.stpmin = 1e-20;
  //lb3_1.stpmax = 1e20;

  static doublereal one = 1.0;
  static doublereal zero = 0.0;

  /* System generated locals */
  integer i__1;
  doublereal d__1;

  /* Builtin functions */
  double sqrt();

  /* Local variables */
  static doublereal beta;
  static integer inmc;
  static integer info, iscn, nfev, iycn, iter;
  static doublereal ftol;
  static integer nfun, ispt, iypt, i__, bound;
  static doublereal gnorm;

  static integer point;
  static doublereal xnorm;
  static integer cp;
  static doublereal sq, yr, ys;
  static logical finish;
  static doublereal yy;
  static integer maxfev;

  static integer npt;
  static doublereal stp, stp1;

  /* Parameter adjustments */
  --diag;
  --g;
  --x;
  --w;
  --iprint;

  /* Function Body */

  /*     INITIALIZE */
  /*     ---------- */

  if (*iflag == 0) {
    goto L10;
  }
  switch ((int)*iflag) {
  case 1:  goto L172;
  case 2:  goto L100;
  }
 L10:
  iter = 0;
  if (*n <= 0 || *m <= 0) {
    goto L196;
  }
  if (lb3_1.gtol <= 1e-4) {
    if (lb3_1.lp > 0) {}
    lb3_1.gtol = .9;
  }
  nfun = 1;
  point = 0;
  finish = FALSE_;
  if (*diagco != 0) {
    i__1 = *n;
    for (i__ = 1; i__ <= i__1; ++i__) {
      /* L30: */
      if (diag[i__] <= zero) {
    goto L195;
      }
    }
  } else {
    i__1 = *n;
    for (i__ = 1; i__ <= i__1; ++i__) {
      /* L40: */
      diag[i__] = 1.;
    }
  }

  ispt = *n + (*m << 1);
  iypt = ispt + *n * *m;
  i__1 = *n;
  for (i__ = 1; i__ <= i__1; ++i__) {
    /* L50: */
    w[ispt + i__] = -g[i__] * diag[i__];
  }
  gnorm = sqrt(ddot_(n, &g[1], &c__1, &g[1], &c__1));
  stp1 = one / gnorm;

  /*     PARAMETERS FOR LINE SEARCH ROUTINE */

  ftol = 1e-4;
  maxfev = 20;

  /*    if (iprint[1] >= 0) {
    lb1_(&iprint[1], &iter, &nfun, &gnorm, n, m, &x[1], f, &g[1], &stp, &
    finish);
    } */

  /*    -------------------- */
  /*     MAIN ITERATION LOOP */
  /*    -------------------- */

 L80:
  ++iter;
  info = 0;
  bound = iter - 1;
  if (iter == 1) {
    goto L165;
  }
  if (iter > *m) {
    bound = *m;
  }

  ys = ddot_(n, &w[iypt + npt + 1], &c__1, &w[ispt + npt + 1], &c__1);
  if (*diagco == 0) {
    yy = ddot_(n, &w[iypt + npt + 1], &c__1, &w[iypt + npt + 1], &c__1);
    i__1 = *n;
    for (i__ = 1; i__ <= i__1; ++i__) {
      /* L90: */
      diag[i__] = ys / yy;
    }
  } else {
    *iflag = 2;
    return 0;
  }
 L100:
  if (*diagco != 0) {
    i__1 = *n;
    for (i__ = 1; i__ <= i__1; ++i__) {
      /* L110: */
      if (diag[i__] <= zero) {
    goto L195;
      }
    }
  }

  /*     COMPUTE -H*G USING THE FORMULA GIVEN IN: Nocedal, J. 1980, */
  /*     "Updating quasi-Newton matrices with limited storage", */
  /*     Mathematics of Computation, Vol.24, No.151, pp. 773-782\. */
  /*     --------------------------------------------------------- */

  cp = point;
  if (point == 0) {
    cp = *m;
  }
  w[*n + cp] = one / ys;
  i__1 = *n;
  for (i__ = 1; i__ <= i__1; ++i__) {
    /* L112: */
    w[i__] = -g[i__];
  }
  cp = point;
  i__1 = bound;
  for (i__ = 1; i__ <= i__1; ++i__) {
    --cp;
    if (cp == -1) {
      cp = *m - 1;
    }
    sq = ddot_(n, &w[ispt + cp * *n + 1], &c__1, &w[1], &c__1);
    inmc = *n + *m + cp + 1;
    iycn = iypt + cp * *n;
    w[inmc] = w[*n + cp + 1] * sq;
    d__1 = -w[inmc];
    daxpy_(n, &d__1, &w[iycn + 1], &c__1, &w[1], &c__1);
    /* L125: */
  }

  i__1 = *n;
  for (i__ = 1; i__ <= i__1; ++i__) {
    /* L130: */
    w[i__] = diag[i__] * w[i__];
  }

  i__1 = bound;
  for (i__ = 1; i__ <= i__1; ++i__) {
    yr = ddot_(n, &w[iypt + cp * *n + 1], &c__1, &w[1], &c__1);
    beta = w[*n + cp + 1] * yr;
    inmc = *n + *m + cp + 1;
    beta = w[inmc] - beta;
    iscn = ispt + cp * *n;
    daxpy_(n, &beta, &w[iscn + 1], &c__1, &w[1], &c__1);
    ++cp;
    if (cp == *m) {
      cp = 0;
    }
    /* L145: */
  }

  /*     STORE THE NEW SEARCH DIRECTION */
  /*     ------------------------------ */

  i__1 = *n;
  for (i__ = 1; i__ <= i__1; ++i__) {
    /* L160: */
    w[ispt + point * *n + i__] = w[i__];
  }

  /*     OBTAIN THE ONE-DIMENSIONAL MINIMIZER OF THE FUNCTION */
  /*     BY USING THE LINE SEARCH ROUTINE MCSRCH */
  /*     ---------------------------------------------------- */
 L165:
  nfev = 0;
  stp = one;
  if (iter == 1) {
    stp = stp1;
  }
  i__1 = *n;
  for (i__ = 1; i__ <= i__1; ++i__) {
    /* L170: */
    w[i__] = g[i__];
  }
 L172:
  mcsrch_(n, &x[1], f, &g[1], &w[ispt + point * *n + 1], &stp, &ftol, xtol, 
      &maxfev, &info, &nfev, &diag[1]);
  if (info == -1) {
    *iflag = 1;
    return 0;
  }
  if (info != 1) {
    goto L190;
  }
  nfun += nfev;

  /*     COMPUTE THE NEW STEP AND GRADIENT CHANGE */
  /*     ----------------------------------------- */

  npt = point * *n;
  i__1 = *n;
  for (i__ = 1; i__ <= i__1; ++i__) {
    w[ispt + npt + i__] = stp * w[ispt + npt + i__];
    /* L175: */
    w[iypt + npt + i__] = g[i__] - w[i__];
  }
  ++point;
  if (point == *m) {
    point = 0;
  }

  /*     TERMINATION TEST */
  /*     ---------------- */

  gnorm = sqrt(ddot_(n, &g[1], &c__1, &g[1], &c__1));
  xnorm = sqrt(ddot_(n, &x[1], &c__1, &x[1], &c__1));
  xnorm = max(1.,xnorm);
  if (gnorm / xnorm <= *eps) {
    finish = TRUE_;
  }

  /*    if (iprint[1] >= 0) {
    lb1_(&iprint[1], &iter, &nfun, &gnorm, n, m, &x[1], f, &g[1], &stp, &
    finish);
    }*/
  if (finish) {
    *iflag = 0;
    return 0;
  }
  goto L80;

  /*     ------------------------------------------------------------ */
  /*     END OF MAIN ITERATION LOOP. ERROR EXITS. */
  /*     ------------------------------------------------------------ */

 L190:
  *iflag = -1;
  return 0;
 L195:
  *iflag = -2;
  return 0;
 L196:
  *iflag = -3;

  return 0;
} /* lbfgs_ */

/*   ---------------------------------------------------------- */

/* Subroutine */ static int daxpy_(integer *n, doublereal *da, doublereal *dx, integer *incx, doublereal *dy, integer *incy)
{
  /* System generated locals */
  integer i__1;

  /* Local variables */
  static integer i__, m, ix, iy, mp1;

  /*     constant times a vector plus a vector. */
  /*     uses unrolled loops for increments equal to one. */
  /*     jack dongarra, linpack, 3/11/78\. */

  /* Parameter adjustments */
  --dy;
  --dx;

  /* Function Body */
  if (*n <= 0) {
    return 0;
  }
  if (*da == 0.) {
    return 0;
  }
  if (*incx == 1 && *incy == 1) {
    goto L20;
  }

  /*        code for unequal increments or equal increments */
  /*          not equal to 1 */

  ix = 1;
  iy = 1;
  if (*incx < 0) {
    ix = (-(*n) + 1) * *incx + 1;
  }
  if (*incy < 0) {
    iy = (-(*n) + 1) * *incy + 1;
  }
  i__1 = *n;
  for (i__ = 1; i__ <= i__1; ++i__) {
    dy[iy] += *da * dx[ix];
    ix += *incx;
    iy += *incy;
    /* L10: */
  }
  return 0;

  /*        code for both increments equal to 1 */

  /*        clean-up loop */

 L20:
  m = *n % 4;
  if (m == 0) {
    goto L40;
  }
  i__1 = m;
  for (i__ = 1; i__ <= i__1; ++i__) {
    dy[i__] += *da * dx[i__];
    /* L30: */
  }
  if (*n < 4) {
    return 0;
  }
 L40:
  mp1 = m + 1;
  i__1 = *n;
  for (i__ = mp1; i__ <= i__1; i__ += 4) {
    dy[i__] += *da * dx[i__];
    dy[i__ + 1] += *da * dx[i__ + 1];
    dy[i__ + 2] += *da * dx[i__ + 2];
    dy[i__ + 3] += *da * dx[i__ + 3];
    /* L50: */
  }
  return 0;
} /* daxpy_ */

/*   ---------------------------------------------------------- */

static doublereal ddot_(integer *n, doublereal *dx, integer *incx, doublereal *dy, integer *incy)
{
  /* System generated locals */
  integer i__1;
  doublereal ret_val;

  /* Local variables */
  static integer i__, m;
  static doublereal dtemp;
  static integer ix, iy, mp1;

  /*     forms the dot product of two vectors. */
  /*     uses unrolled loops for increments equal to one. */
  /*     jack dongarra, linpack, 3/11/78\. */

  /* Parameter adjustments */
  --dy;
  --dx;

  /* Function Body */
  ret_val = 0.;
  dtemp = 0.;
  if (*n <= 0) {
    return ret_val;
  }
  if (*incx == 1 && *incy == 1) {
    goto L20;
  }

  /*        code for unequal increments or equal increments */
  /*          not equal to 1 */

  ix = 1;
  iy = 1;
  if (*incx < 0) {
    ix = (-(*n) + 1) * *incx + 1;
  }
  if (*incy < 0) {
    iy = (-(*n) + 1) * *incy + 1;
  }
  i__1 = *n;
  for (i__ = 1; i__ <= i__1; ++i__) {
    dtemp += dx[ix] * dy[iy];
    ix += *incx;
    iy += *incy;
    /* L10: */
  }
  ret_val = dtemp;
  return ret_val;

  /*        code for both increments equal to 1 */

  /*        clean-up loop */

 L20:
  m = *n % 5;
  if (m == 0) {
    goto L40;
  }
  i__1 = m;
  for (i__ = 1; i__ <= i__1; ++i__) {
    dtemp += dx[i__] * dy[i__];
    /* L30: */
  }
  if (*n < 5) {
    goto L60;
  }
 L40:
  mp1 = m + 1;
  i__1 = *n;
  for (i__ = mp1; i__ <= i__1; i__ += 5) {
    dtemp = dtemp + dx[i__] * dy[i__] + dx[i__ + 1] * dy[i__ + 1] + dx[
                                       i__ + 2] * dy[i__ + 2] + dx[i__ + 3] * dy[i__ + 3] + dx[i__ + 
                                                                   4] * dy[i__ + 4];
    /* L50: */
  }
 L60:
  ret_val = dtemp;
  return ret_val;
} /* ddot_ */

/* Subroutine */ static int mcsrch_(integer *n, doublereal *x, doublereal *f, doublereal *g, doublereal *s, doublereal *stp, doublereal *ftol, 
                                    doublereal *xtol, integer *maxfev, integer *info, integer *nfev, doublereal *wa)
{
  /* Initialized data */

  static doublereal p5 = .5;
  static doublereal p66 = .66;
  static doublereal xtrapf = 4.;
  static doublereal zero = 0.;

  /* System generated locals */
  integer i__1;
  doublereal d__1;

  /* Local variables */
  static doublereal dgxm, dgym;
  static integer j, infoc;
  static doublereal finit, width, stmin, stmax;
  static logical stage1;
  static doublereal width1, ftest1, dg, fm, fx, fy;
  static logical brackt;
  static doublereal dginit, dgtest;
  static doublereal dgm, dgx, dgy, fxm, fym, stx, sty;

  /* Parameter adjustments */
  --wa;
  --s;
  --g;
  --x;

  /* Function Body */
  if (*info == -1) {
    goto L45;
  }
  infoc = 1;

  /*     CHECK THE INPUT PARAMETERS FOR ERRORS. */

  if (*n <= 0 || *stp <= zero || *ftol < zero || lb3_1.gtol < zero || *xtol 
      < zero || lb3_1.stpmin < zero || lb3_1.stpmax < lb3_1.stpmin || *
      maxfev <= 0) {
    return 0;
  }

  /*     COMPUTE THE INITIAL GRADIENT IN THE SEARCH DIRECTION */
  /*     AND CHECK THAT S IS A DESCENT DIRECTION. */

  dginit = zero;
  i__1 = *n;
  for (j = 1; j <= i__1; ++j) {
    dginit += g[j] * s[j];
    /* L10: */
  }
  if (dginit >= zero) {
    return 0;
  }

  /*     INITIALIZE LOCAL VARIABLES. */

  brackt = FALSE_;
  stage1 = TRUE_;
  *nfev = 0;
  finit = *f;
  dgtest = *ftol * dginit;
  width = lb3_1.stpmax - lb3_1.stpmin;
  width1 = width / p5;
  i__1 = *n;
  for (j = 1; j <= i__1; ++j) {
    wa[j] = x[j];
    /* L20: */
  }

  /*     THE VARIABLES STX, FX, DGX CONTAIN THE VALUES OF THE STEP, */
  /*     FUNCTION, AND DIRECTIONAL DERIVATIVE AT THE BEST STEP. */
  /*     THE VARIABLES STY, FY, DGY CONTAIN THE VALUE OF THE STEP, */
  /*     FUNCTION, AND DERIVATIVE AT THE OTHER ENDPOINT OF */
  /*     THE INTERVAL OF UNCERTAINTY. */
  /*     THE VARIABLES STP, F, DG CONTAIN THE VALUES OF THE STEP, */
  /*     FUNCTION, AND DERIVATIVE AT THE CURRENT STEP. */

  stx = zero;
  fx = finit;
  dgx = dginit;
  sty = zero;
  fy = finit;
  dgy = dginit;

  /*     START OF ITERATION. */

 L30:

  /*        SET THE MINIMUM AND MAXIMUM STEPS TO CORRESPOND */
  /*        TO THE PRESENT INTERVAL OF UNCERTAINTY. */

  if (brackt) {
    stmin = min(stx,sty);
    stmax = max(stx,sty);
  } else {
    stmin = stx;
    stmax = *stp + xtrapf * (*stp - stx);
  }

  /*        FORCE THE STEP TO BE WITHIN THE BOUNDS STPMAX AND STPMIN. */

  *stp = max(*stp,lb3_1.stpmin);
  *stp = min(*stp,lb3_1.stpmax);

  /*        IF AN UNUSUAL TERMINATION IS TO OCCUR THEN LET */
  /*        STP BE THE LOWEST POINT OBTAINED SO FAR. */

  if ((brackt && ((*stp <= stmin || *stp >= stmax) || *nfev >= *maxfev - 1 || 
          infoc == 0)) || (brackt && (stmax - stmin <= *xtol * stmax))) {
    *stp = stx;
  }

  /*        EVALUATE THE FUNCTION AND GRADIENT AT STP */
  /*        AND COMPUTE THE DIRECTIONAL DERIVATIVE. */
  /*        We return to main program to obtain F and G. */

  i__1 = *n;
  for (j = 1; j <= i__1; ++j) {
    x[j] = wa[j] + *stp * s[j];
    /* L40: */
  }
  *info = -1;
  return 0;

 L45:
  *info = 0;
  ++(*nfev);
  dg = zero;
  i__1 = *n;
  for (j = 1; j <= i__1; ++j) {
    dg += g[j] * s[j];
    /* L50: */
  }
  ftest1 = finit + *stp * dgtest;

  /*        TEST FOR CONVERGENCE. */

  if (brackt && ((*stp <= stmin || *stp >= stmax) || infoc == 0)) {
    *info = 6;
  }
  if (*stp == lb3_1.stpmax && *f <= ftest1 && dg <= dgtest) {
    *info = 5;
  }
  if (*stp == lb3_1.stpmin && (*f > ftest1 || dg >= dgtest)) {
    *info = 4;
  }
  if (*nfev >= *maxfev) {
    *info = 3;
  }
  if (brackt && stmax - stmin <= *xtol * stmax) {
    *info = 2;
  }
  if (*f <= ftest1 && abs(dg) <= lb3_1.gtol * (-dginit)) {
    *info = 1;
  }

  /*        CHECK FOR TERMINATION. */

  if (*info != 0) {
    return 0;
  }

  /*        IN THE FIRST STAGE WE SEEK A STEP FOR WHICH THE MODIFIED */
  /*        FUNCTION HAS A NONPOSITIVE VALUE AND NONNEGATIVE DERIVATIVE. */

  if (stage1 && *f <= ftest1 && dg >= min(*ftol,lb3_1.gtol) * dginit) {
    stage1 = FALSE_;
  }

  /*        A MODIFIED FUNCTION IS USED TO PREDICT THE STEP ONLY IF */
  /*        WE HAVE NOT OBTAINED A STEP FOR WHICH THE MODIFIED */
  /*        FUNCTION HAS A NONPOSITIVE FUNCTION VALUE AND NONNEGATIVE */
  /*        DERIVATIVE, AND IF A LOWER FUNCTION VALUE HAS BEEN */
  /*        OBTAINED BUT THE DECREASE IS NOT SUFFICIENT. */

  if (stage1 && *f <= fx && *f > ftest1) {

    /*           DEFINE THE MODIFIED FUNCTION AND DERIVATIVE VALUES. */

    fm = *f - *stp * dgtest;
    fxm = fx - stx * dgtest;
    fym = fy - sty * dgtest;
    dgm = dg - dgtest;
    dgxm = dgx - dgtest;
    dgym = dgy - dgtest;

    /*           CALL CSTEP TO UPDATE THE INTERVAL OF UNCERTAINTY */
    /*           AND TO COMPUTE THE NEW STEP. */

    mcstep_(&stx, &fxm, &dgxm, &sty, &fym, &dgym, stp, &fm, &dgm, &brackt,
        &stmin, &stmax, &infoc);

    /*           RESET THE FUNCTION AND GRADIENT VALUES FOR F. */

    fx = fxm + stx * dgtest;
    fy = fym + sty * dgtest;
    dgx = dgxm + dgtest;
    dgy = dgym + dgtest;
  } else {

    /*           CALL MCSTEP TO UPDATE THE INTERVAL OF UNCERTAINTY */
    /*           AND TO COMPUTE THE NEW STEP. */

    mcstep_(&stx, &fx, &dgx, &sty, &fy, &dgy, stp, f, &dg, &brackt, &
        stmin, &stmax, &infoc);
  }

  /*        FORCE A SUFFICIENT DECREASE IN THE SIZE OF THE */
  /*        INTERVAL OF UNCERTAINTY. */

  if (brackt) {
    if ((d__1 = sty - stx, abs(d__1)) >= p66 * width1) {
      *stp = stx + p5 * (sty - stx);
    }
    width1 = width;
    width = (d__1 = sty - stx, abs(d__1));
  }

  /*        END OF ITERATION. */

  goto L30;

  /*     LAST LINE OF SUBROUTINE MCSRCH. */

} /* mcsrch_ */

/* Subroutine */ static int mcstep_(doublereal *stx, doublereal *fx, doublereal *dx, doublereal *sty, doublereal *fy, doublereal *dy, 
                                    doublereal *stp, doublereal *fp, doublereal *dp, logical *brackt, 
                                    doublereal *stpmin, doublereal *stpmax, integer *info)
{
  /* System generated locals */
  doublereal d__1, d__2, d__3;

  /* Builtin functions */
  double sqrt();

  /* Local variables */
  static doublereal sgnd, stpc, stpf, stpq, p, q, gamma, r__, s, theta;
  static logical bound;

  *info = 0;

  /*     CHECK THE INPUT PARAMETERS FOR ERRORS. */

  if (*brackt && ((*stp <= min(*stx,*sty) || *stp >= max(*stx,*sty)) || *dx *
          (*stp - *stx) >= (float)0\. || *stpmax < *stpmin)) {
    return 0;
  }

  /*     DETERMINE IF THE DERIVATIVES HAVE OPPOSITE SIGN. */

  sgnd = *dp * (*dx / abs(*dx));

  /*     FIRST CASE. A HIGHER FUNCTION VALUE. */
  /*     THE MINIMUM IS BRACKETED. IF THE CUBIC STEP IS CLOSER */
  /*     TO STX THAN THE QUADRATIC STEP, THE CUBIC STEP IS TAKEN, */
  /*     ELSE THE AVERAGE OF THE CUBIC AND QUADRATIC STEPS IS TAKEN. */

  if (*fp > *fx) {
    *info = 1;
    bound = TRUE_;
    theta = (*fx - *fp) * 3 / (*stp - *stx) + *dx + *dp;
    /* Computing MAX */
    d__1 = abs(theta), d__2 = abs(*dx), d__1 = max(d__1,d__2), d__2 = abs(
                                      *dp);
    s = max(d__1,d__2);
    /* Computing 2nd power */
    d__1 = theta / s;
    gamma = s * sqrt(d__1 * d__1 - *dx / s * (*dp / s));
    if (*stp < *stx) {
      gamma = -gamma;
    }
    p = gamma - *dx + theta;
    q = gamma - *dx + gamma + *dp;
    r__ = p / q;
    stpc = *stx + r__ * (*stp - *stx);
    stpq = *stx + *dx / ((*fx - *fp) / (*stp - *stx) + *dx) / 2 * (*stp - 
                                   *stx);
    if ((d__1 = stpc - *stx, abs(d__1)) < (d__2 = stpq - *stx, abs(d__2)))
      {
    stpf = stpc;
      } else {
    stpf = stpc + (stpq - stpc) / 2;
      }
    *brackt = TRUE_;

    /*     SECOND CASE. A LOWER FUNCTION VALUE AND DERIVATIVES OF */
    /*     OPPOSITE SIGN. THE MINIMUM IS BRACKETED. IF THE CUBIC */
    /*     STEP IS CLOSER TO STX THAN THE QUADRATIC (SECANT) STEP, */
    /*     THE CUBIC STEP IS TAKEN, ELSE THE QUADRATIC STEP IS TAKEN. */

  } else if (sgnd < (float)0.) {
    *info = 2;
    bound = FALSE_;
    theta = (*fx - *fp) * 3 / (*stp - *stx) + *dx + *dp;
    /* Computing MAX */
    d__1 = abs(theta), d__2 = abs(*dx), d__1 = max(d__1,d__2), d__2 = abs(
                                      *dp);
    s = max(d__1,d__2);
    /* Computing 2nd power */
    d__1 = theta / s;
    gamma = s * sqrt(d__1 * d__1 - *dx / s * (*dp / s));
    if (*stp > *stx) {
      gamma = -gamma;
    }
    p = gamma - *dp + theta;
    q = gamma - *dp + gamma + *dx;
    r__ = p / q;
    stpc = *stp + r__ * (*stx - *stp);
    stpq = *stp + *dp / (*dp - *dx) * (*stx - *stp);
    if ((d__1 = stpc - *stp, abs(d__1)) > (d__2 = stpq - *stp, abs(d__2)))
      {
    stpf = stpc;
      } else {
    stpf = stpq;
      }
    *brackt = TRUE_;

    /*     THIRD CASE. A LOWER FUNCTION VALUE, DERIVATIVES OF THE */
    /*     SAME SIGN, AND THE MAGNITUDE OF THE DERIVATIVE DECREASES. */
    /*     THE CUBIC STEP IS ONLY USED IF THE CUBIC TENDS TO INFINITY */
    /*     IN THE DIRECTION OF THE STEP OR IF THE MINIMUM OF THE CUBIC */
    /*     IS BEYOND STP. OTHERWISE THE CUBIC STEP IS DEFINED TO BE */
    /*     EITHER STPMIN OR STPMAX. THE QUADRATIC (SECANT) STEP IS ALSO */
    /*     COMPUTED AND IF THE MINIMUM IS BRACKETED THEN THE THE STEP */
    /*     CLOSEST TO STX IS TAKEN, ELSE THE STEP FARTHEST AWAY IS TAKEN. */

  } else if (abs(*dp) < abs(*dx)) {
    *info = 3;
    bound = TRUE_;
    theta = (*fx - *fp) * 3 / (*stp - *stx) + *dx + *dp;
    /* Computing MAX */
    d__1 = abs(theta), d__2 = abs(*dx), d__1 = max(d__1,d__2), d__2 = abs(
                                      *dp);
    s = max(d__1,d__2);

    /*        THE CASE GAMMA = 0 ONLY ARISES IF THE CUBIC DOES NOT TEND */
    /*        TO INFINITY IN THE DIRECTION OF THE STEP. */

    /* Computing MAX */
    /* Computing 2nd power */
    d__3 = theta / s;
    d__1 = 0., d__2 = d__3 * d__3 - *dx / s * (*dp / s);
    gamma = s * sqrt((max(d__1,d__2)));
    if (*stp > *stx) {
      gamma = -gamma;
    }
    p = gamma - *dp + theta;
    q = gamma + (*dx - *dp) + gamma;
    r__ = p / q;
    if (r__ < (float)0\. && gamma != (float)0.) {
      stpc = *stp + r__ * (*stx - *stp);
    } else if (*stp > *stx) {
      stpc = *stpmax;
    } else {
      stpc = *stpmin;
    }
    stpq = *stp + *dp / (*dp - *dx) * (*stx - *stp);
    if (*brackt) {
      if ((d__1 = *stp - stpc, abs(d__1)) < (d__2 = *stp - stpq, abs(
                                     d__2))) {
    stpf = stpc;
      } else {
    stpf = stpq;
      }
    } else {
      if ((d__1 = *stp - stpc, abs(d__1)) > (d__2 = *stp - stpq, abs(
                                     d__2))) {
    stpf = stpc;
      } else {
    stpf = stpq;
      }
    }

    /*     FOURTH CASE. A LOWER FUNCTION VALUE, DERIVATIVES OF THE */
    /*     SAME SIGN, AND THE MAGNITUDE OF THE DERIVATIVE DOES */
    /*     NOT DECREASE. IF THE MINIMUM IS NOT BRACKETED, THE STEP */
    /*     IS EITHER STPMIN OR STPMAX, ELSE THE CUBIC STEP IS TAKEN. */

  } else {
    *info = 4;
    bound = FALSE_;
    if (*brackt) {
      theta = (*fp - *fy) * 3 / (*sty - *stp) + *dy + *dp;
      /* Computing MAX */
      d__1 = abs(theta), d__2 = abs(*dy), d__1 = max(d__1,d__2), d__2 = 
    abs(*dp);
      s = max(d__1,d__2);
      /* Computing 2nd power */
      d__1 = theta / s;
      gamma = s * sqrt(d__1 * d__1 - *dy / s * (*dp / s));
      if (*stp > *sty) {
    gamma = -gamma;
      }
      p = gamma - *dp + theta;
      q = gamma - *dp + gamma + *dy;
      r__ = p / q;
      stpc = *stp + r__ * (*sty - *stp);
      stpf = stpc;
    } else if (*stp > *stx) {
      stpf = *stpmax;
    } else {
      stpf = *stpmin;
    }
  }

  /*     UPDATE THE INTERVAL OF UNCERTAINTY. THIS UPDATE DOES NOT */
  /*     DEPEND ON THE NEW STEP OR THE CASE ANALYSIS ABOVE. */

  if (*fp > *fx) {
    *sty = *stp;
    *fy = *fp;
    *dy = *dp;
  } else {
    if (sgnd < (float)0.) {
      *sty = *stx;
      *fy = *fx;
      *dy = *dx;
    }
    *stx = *stp;
    *fx = *fp;
    *dx = *dp;
  }

  /*     COMPUTE THE NEW STEP AND SAFEGUARD IT. */

  stpf = min(*stpmax,stpf);
  stpf = max(*stpmin,stpf);
  *stp = stpf;
  if (*brackt && bound) {
    if (*sty > *stx) {
      /* Computing MIN */
      d__1 = *stx + (*sty - *stx) * (float).66;
      *stp = min(d__1,*stp);
    } else {
      /* Computing MAX */
      d__1 = *stx + (*sty - *stx) * (float).66;
      *stp = max(d__1,*stp);
    }
  }
  return 0;

  /*     LAST LINE OF SUBROUTINE MCSTEP. */

} /* mcstep_ */ 
```

这是我的新 ndlfortran.c 的更改开头，直到第一个子例程 psi_ ：

```
#include "f2c.h"

/* Table of constant values */

#ifdef _FORTRAN_MAIN_FIX
    int MAIN__() {return 0;};
#endif

typedef long int integer;
typedef unsigned long int uinteger;
typedef char *address;
typedef short int shortint;
typedef float real;
typedef double doublereal;
typedef long int logical;
typedef short int shortlogical;
typedef char logical1;
typedef char integer1;

#define TRUE_ (1)
#define FALSE_ (0)
#define abs(x) ((x) >= 0 ? (x) : -(x))
#define min(a,b) ((a) <= (b) ? (a) : (b))
#define max(a,b) ((a) >= (b) ? (a) : (b))

/* Common Block Declarations */
 struct lb3_1_ {
  integer mp, lp;
  doublereal gtol, stpmin, stpmax;
} ; 

/* Table of constant values */
 static struct lb3_1_ lb3_1 = {  6, 6, .9, 1e-20,1e20};
static integer c__1 = 1;

static doublereal ddot_  ();
static int daxpy_ ();
static int mcsrch_();
static int mcstep_();

static integer c__0 = 0; 
```

# wpf - 将文本框的默认值更改为新值并在重新打开后存储新值

> ID：13502463
> 
> 赞同：0
> 
> 时间：2012-11-21T21:39:38.390
> 
> 标签：wpf, vb.net

我有一个文本框（textbox1），当加载 WPF 窗口时，它使用 UserProfile 变量在 textbox1.text 中显示当前用户目录

```
 Private Sub Window_Loaded(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
    Dim defaultpath As String = Environment.CurrentDirectory
    Environment.CurrentDirectory = Environment.GetEnvironmentVariable("UserProfile")
    TextBox1.Text = defaultpath

    End Sub 
```

我还有一个按钮，单击该按钮时，使用 FolderBrowserDialog 浏览文件夹，然后在 textbox1.text 中显示新文件夹路径。

```
 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) Handles Button1.Click
    Dim fldDialog As New FolderBrowserDialog()
    fldDialog.RootFolder = Environment.SpecialFolder.Desktop
    fldDialog.ShowDialog()
    Dim filepathstore As String = fldDialog.SelectedPath

    TextBox1.Text = filepathstore
     End Sub 
```

该值现在显示使用 FolderBrowserDialog 选择的路径。

我将如何存储这个新值，当 WPF 窗口关闭/重新打开时，显示这个新值而不是默认值。（替换不删除默认值）

文件夹路径的这个新值可以根据需要多次更改。但是，当单击重置按钮时，WPF 窗口将恢复为默认值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T05:32:46.243

听起来最简单的选择是将值保存到可以随时调用的文件中。下面的代码假定您要保存的值在调用 FormClosing 事件时位于 textbox1.text 中，然后在打开表单时将其加载回 textbox1.text 中。

```
Private Sub Form1_FormClosing(ByVal sender As Object, ByVal e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
    Dim s As String
    s = TextBox1.Text
    Dim loc As String
    loc = My.Computer.FileSystem.SpecialDirectories.MyDocuments & "/testfile.txt"
    My.Computer.FileSystem.WriteAllText(loc, TextBox1.Text, False)
End Sub

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim loc As String
    loc = My.Computer.FileSystem.SpecialDirectories.MyDocuments & "/testfile.txt"
    Dim s As String
    s = My.Computer.FileSystem.ReadAllText(loc)
    TextBox1.Text = s
End Sub 
```

如果您对此有任何疑问，请告诉我:)

# autohotkey - Autohotkey 应用程序特定的热键

> ID：13502467
> 
> 赞同：7
> 
> 时间：2012-11-21T21:39:44.320
> 
> 标签：autohotkey

我是 Autohotkey 的新手，尽管阅读了本网站和官方文档，但我无法弄清楚这一点。

我只想让某些热键仅适用于某些应用程序。例如，如果我在某个游戏中按空格键，我希望它发送 `（坟墓），但如果我不在该游戏中，我希望空格键正常运行。当我不在游戏中时，我尝试的一切似乎都让空格键什么都不做。我可以尝试使用“else”语句来发送空格键，但这似乎是一个无限循环。帮助！

编辑：谢谢 NbdNnm。这正是最终为我工作的东西：

#IfWinActive 英雄联盟 (TM) 客户端
空间:: `
#IfWinActive

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-22T08:04:29.347

试试这个，确保你有最新版本的 AutoHotkey。将应用程序进程名称放入`strYourAppExeName`变量中，并将热键定义放入`#if`块中。

```
strYourAppExeName := "notepad.exe"
strYourMessage := "``(grave)"

#If WinActive("ahk_exe " strYourAppExeName)
    Space::SendInput, % strYourMessage
#if 
```

# macos - 为 Mac OS X 创建一个窗口管理器类型覆盖

> ID：13502468
> 
> 赞同：3
> 
> 时间：2012-11-21T21:39:46.490
> 
> 标签：macos, user-interface, window, window-managers

我想为 OS X 制作自己的窗口管理器，或者至少给它一个新的外观。我有一本书写了很多设计，并希望实现它们。其中包括更改甚至完全删除菜单栏，为切换应用程序创建全新的 gui 等。

我知道 OS X 没有窗口管理器，基本上 X11 窗口管理器将执行的功能是由 Carbon、Cocoa、Dock 应用程序和窗口服务器完成的。我已经读过，在硬件级别编写我自己的 api 等需要大量的逆向工程。我仍然不擅长编程，也没有那种时间。这就是为什么我在考虑在 OS X 上运行一个应用程序，该应用程序将像一个单独的窗口管理器一样运行 - 并完成普通 OS GUI/窗口管理器所做的一切。

这可能吗？例如：制作一个自定义按钮，该按钮将出现在某个组合键上，可以单击该按钮以访问文档查看器、更改时间、最小化窗口等。是否有某种方法可以访问此类基本任务/操作的功能不使用默认的 OS X 按钮控件，并使用我自己的 GUI 实现它们？我说的不仅仅是一个简单的主题更改，我想彻底改变用户体验。这意味着该应用程序将以全屏模式运行，该模式会屏蔽默认的 OS X 菜单栏。

我听说过一些关于使用图形架构插入您自己的窗口管理器的消息？这也是一种选择吗？如果是这样，我将如何去做？

# objective-c - UILocalNotification 添加和删除

> ID：13502473
> 
> 赞同：0
> 
> 时间：2012-11-21T21:40:06.287
> 
> 标签：objective-c, ios, notifications, uilocalnotification, uiapplication

在我的用户登录应用程序后，会下拉他们的会议列表并将它们添加为`UILocalNotification`.

每次用户启动应用程序并登录时，都会发生这种情况。

在反复执行此操作时，以下哪项是更好的“实践”：

1.  `scheduledLocalNotifications`当我循环浏览下载的会议检查以查看该会议是否已经存在本地通知时，请使用 then 提取所有位置通知。如果是这样，请不要添加它。

2.  用于`cancelAllLocalNotifications`清除所有本地通知并添加它们。

似乎＃1 是正确的方式，但我担心如果我与另一个会议同时开会（它发生了），它会将其视为已添加并且不会添加新的会议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:47:32.463

我个人会拉下位置并检查它们。它只是让我感觉更整洁，而不是摧毁一切并重新创造一切。再说一次，#2 可能（可以忽略不计）更快，因为您不需要循环和检查。

如果您担心 #1 不匹配两个会议具有相同的时间，您可以`UILocalNotification`通过属性将您自己的唯一标识符添加到对象`userInfo`，并查询它以查看会议是否是同一事件，而不是基于它通知的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:47:24.883

如果你有一个唯一的令牌，比如一个 UUID，对于每个会议，可以避免重复预订的情况。将此令牌放入通知的 userInfo 字典中，然后您可以准确地看到通知是针对哪个会议的。比较以确定此会议是否已经有通知排队最好通过此唯一令牌完成，确保会议时间没有改变。

# python - Python：使用文件包含的数字重命名文件夹中的所有文件

> ID：13502474
> 
> 赞同：0
> 
> 时间：2012-11-21T21:40:06.947
> 
> 标签：python

我想写一个小脚本来管理我得到的一堆文件。这些文件具有复杂且不同的名称，但它们的名称中都包含一个数字。我想取那个数字，把它放在文件名的前面，这样它们就可以在我的文件系统中按逻辑列出。

我使用 os.listdir 获得了所有这些文件的*列表*，但我正在努力寻找一种方法来定位这些文件中的数字。我检查了正则表达式，但我不确定这是否是正确的方法！

例子：

```
import os
files = os.litdir(c:\\folder)
files
['xyz3.txt' , '2xyz.txt', 'x1yz.txt']` 
```

所以基本上，我最终想要的是：

```
1xyz.txt
2xyz.txt
3xyz.txt 
```

到目前为止我被困的地方是在列表*文件中找到那些数字（1,2,3）*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:53:18.763

这个（未经测试的）片段应该显示正则表达式方法。编译模式的`search`方法用于查找数字。如果找到，则将数字移到文件名的前面。

```
import os, re

NUM_RE = re.compile(r'\d+')

for name in os.listdir('.'):
    match = NUM_RE.search(name)
    if match is None or match.start() == 0:
        continue  # no number or number already at start
    newname = match.group(0) + name[:match.start()] + name[match.end():]
    print 'renaming', name, 'to', newname
    #os.rename(name, newname) 
```

如果此代码用于生产而不是作为家庭作业，一个有用的改进是将其解析`match.group(0)`为整数并将其格式化以包含多个前导零。这种方式`foo2.txt`将成为`02foo.txt`并在之前进行排序`12bar.txt`。实现这一点留给读者作为练习。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T21:56:44.690

假设文件名中的数字是整数（未经测试的代码）：

```
def rename(dirpath, filename):
    inds = [i for i,char in filename if char in '1234567890']
    ints = filename[min(inds):max(inds)+1]
    newname = ints + filename[:min(inds)] + filename[max(inds)+1:]
    os.rename(os.path.join(dirpath, filename), os.path.join(dirpath, newname))

def renameFilesInDir(dirpath):
    """ Apply your renaming scheme to all files in the directory specified by dirpath """

    dirpath, dirnames, filenames = os.walk(dirpath):
    for filename in filenames:
        rename(dirpath, filename)
    for dirname in dirnames:
        renameFilesInDir(os.path.join(dirpath, dirname)) 
```

希望这可以帮助

# c# - 无法将类型“int”隐式转换为“short”？

> ID：13502475
> 
> 赞同：4
> 
> 时间：2012-11-21T21:40:16.567
> 
> 标签：c#, .net

我有 3 个变量都声明为“Int16”类型，但这段代码拒绝工作。

```
 private Int16 _cap;                 // Seat Capacity
    private Int16 _used;                // Seats Filled
    private Int16 _avail;               // Seats Available

    public Int16 SeatsTotal {
        get {
            return _cap;
        }
        set {
            _cap = value;
            _used = _cap - _avail;
        }
    } 
```

除了我有的部分`_used = _cap - _avail;`是抛出这个错误，错误

> 1 无法将类型“int”隐式转换为“short”。存在显式转换（您是否缺少演员表？）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T21:41:45.143

`short`是的，那是因为( )没有减法运算符`Int16`。所以当你写：

```
_cap - _avail 
```

这实际上是：

```
(int) _cap - (int) _avail 
```

……`int`结果。

当然，您可以只转换结果：

```
_used = (short) (_cap - _avail); 
```

# c# - 使用 LINQ 转换为派生类型和从派生类型转换

> ID：13502482
> 
> 赞同：0
> 
> 时间：2012-11-21T21:41:09.947
> 
> 标签：c#, .net, linq, entity-framework-4, casting

我对使用 LINQ 和实体框架有点陌生，并且在将实体框架对象类型转换为/从从该对象类型派生的类的对象中转换时遇到了障碍。

为了提供上下文，我`Survey`从我的 Entity Framework DB 中选择对象（`Surveys`表中的记录），为此我创建了一个派生类，我将在我的应用程序中使用它们之前将这些实体对象实际转换为 - 这样派生类的签名看起来像：

```
public sealed class SurveyExtended : Survey
{
    public SurveyExtended() : base()
    {
        // non-base class members initialized here
    }
} 
```

当使用 LINQ 填充这些对象的集合时，我`SurveyExtended`使用类似于以下的代码将它们转换为类型：

```
var listOfSurveyExtendedObjects = ( from record in contextFactory.SurveysDbContext.Surveys  
                                    select new SurveyExtended()
                                               {
                                                  Name = record.Name,
                                                  Data = record.Data,
                                                  Date = record.Date
                                               }
                                  ); 
```

请注意，我知道我可以使用 lambda 来做同样的事情，但我只是想说明一个概念。

一切都很好，直到我在我的应用程序中处理它之后实际尝试执行 DML`SurveysDbContext`以执行类似`UPDATE`或`DELETE`原始记录之类的操作，例如：`contextFactory.SurveysDbContext.Surveys.DeleteObject( surveyExtendedObject );`.

当然这是行不通的，因为我正在操作`SurveyExtended`对象，而不是原始`Survey`实体对象，并且`ObjectStateManager`会抛出一个，`InvalidOperationException`因为找不到对象本身。这是可以预料的。

我想我正在寻找的是针对这种情况的建议和替代方法。我应该在尝试之前尝试回退到`Survey`对象`DbContext.DeleteObject( record );`，还是完全改变我解决这个问题的方法？在类似情况下，您使用/使用了哪些方法，它们提供了哪些好处/缺点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:03:38.217

想到的选项要么在保存/与 EF 交互之前将其转换回来，要么切换到使用扩展对象封装调查的装饰器模式之类的东西。尽管第二个选项要么意味着您需要模仿封装对象公开传递访问器（代码加倍，乐趣加倍），要么将引用代码更改为 access `SurveyExtended.Survey.Property`。

# java - 在java中随机生成的数组中找到第二高的数字

> ID：13502489
> 
> 赞同：2
> 
> 时间：2012-11-21T21:41:48.607
> 
> 标签：java

嘿伙计们，我有一个作业问题，要求我找到随机生成的数组的第二大数字并返回该数字。该数组的长度必须为 6，因此从概念上讲，这就是我遇到编译器错误之前所拥有的。有人可以帮我完成吗？更新：我需要引用数组并在我试图在 system.out.println 语句中这样做的主要方法中调用它，但是我不知道如何调用正确的方法/数组。

```
import java.io.*;
import java.util.Arrays; 

public class SecondHighest{
 public static int find2ndHighest(int[] list){
//define how long the array can be
list[] = new int[6];
    //create a for loop to fill the array.
for(int i = 0; i>=list.length; i++){
  list[i] = (int)(Math.random()*10);

}
  Arrays.sort(list);    //use the built-in sorting routine
  return list[1];

}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:44:39.703

你的**循环**永远不会工作，因为`i`永远不会**大于或**等于**list.length**

改变

```
for(int i = 0; i>=list.length; i++){ 
```

至

```
for(int i = 0; i<list.length; i++){ 
```

它应该**小于，**因为**数组索引从零开始并在 Arraylength-1 结束**。

也改变

```
list[] = new int[6];// this is wrong 

 to 

list = new int[6]; // you dont need sqare brackets, you only need array reference. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:04:05.283

此外，考虑到这是一个家庭作业问题，最好不要对整个数组进行排序，因为你会得到 O(n*logn) 复杂度，但迭代值并只保留最大的两个，对于 O (n) 复杂性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:52:10.427

阅读您的编译器错误！有许多语法错误，例如在将其作为参数后调用 list -> list[]。你可以称之为列表！此外，您不必在方法中创建新列表！应该是这样的：

```
 import java.io.*;
    import java.util.Arrays; 

    public class SecondHighest{

     public static int find2ndHighest(int[] list){

        //create a for loop to fill the array.
    for(int i = 0; i<list.length; i++){
      list[i] = (int)(Math.random()*10);

    }
      Arrays.sort(list);    //use the built-in sorting routine
      return list[1];
    }

     //define how long the array can be
      int[] list = new int[6];
      int result = find2ndHighest(list);

    } 
```

我不确定数学随机函数..

# amazon-web-services - 是否可以为多个维度的指标定义 CloudWatch 警报

> ID：13502491
> 
> 赞同：4
> 
> 时间：2012-11-21T21:42:00.897
> 
> 标签：amazon-web-services, boto, amazon-cloudwatch

我将 python 和 boto 用于 cloudwatch 指标。我希望能够为 a 定义一个警报，该警报`MetricName`将对所有其他维度都有效。

例如，我在`sandbox`命名空间中有一个带有`MetricName`of`MemoryUsage`和`InstanceId`of的度量`i-xxx`。是否可以定义一个`MemoryUsage`针对*所有* `InstanceId`维度触发的警报？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T10:58:48.853

是的，您可以为任何单个指标创建警报。在这种情况下，单个指标具有代表所有实例的维度。这是您可以在boto中执行此操作的方法。

```
In [1]: import boto

In [2]: cw = boto.connect_cloudwatch()

In [3]: cw.list_metrics(metric_name='CPUUtilization')
Out[3]: 
[Metric:CPUUtilization,
 Metric:CPUUtilization,
 Metric:CPUUtilization,
 Metric:CPUUtilization]

In [4]: l = _

In [5]: for m in l:
   ...:     print m.name, m.dimensions
   ...: 
CPUUtilization {u'ImageId': [u'ami-1b814f72']}
CPUUtilization {u'InstanceId': [u'i-366c4354']}
CPUUtilization {}
CPUUtilization {u'InstanceType': [u'm1.large']} 
```

您可以在此处看到，有四个单独的指标与 metric_name CPUUtilization 相关联。第一个具有使用该特定 AMI 的所有实例的维度，第二个具有当前正在运行的特定实例的维度，第四个具有特定类型的所有实例的维度，但第三个没有指定维度。该指标代表我所有实例的 CPUUtilization。所以：

```
In [6]: m = l[2]

In [7]: m.create_alarm(name='cpu_all_instances', comparison='>', threshold=80.0, period=60, evaluation_periods=2, statistic='Average')
Out[7]: MetricAlarm:cpu_all_instances[CPUUtilization(Average) GreaterThanThreshold 80.0] 
```

如果我所有实例的平均 CPU 利用率在两个评估期超过 80%，则应该触发此警报。您还可以选择不同的统计信息，例如“最大值”，如果所有实例的 CPU 利用率最大值超过 2 个评估期超过 80%，则会触发该统计信息。

我不知道您是否专门寻找 MemoryUsage 或者这只是一个示例，但我不认为 MemoryUsage 是 CloudWatch 的可用指标之一。

# javascript - 为新的表单字段扩展 jQuery 表单验证脚本

> ID：13502492
> 
> 赞同：3
> 
> 时间：2012-11-21T21:42:04.073
> 
> 标签：javascript, jquery, html, validation

我有一个简单的 HTML 表单，它最初是一系列问题（A1 到 A5 和 B1 到 B3），带有是/否单选按钮，如下所示：

```
<tr>
      <td width="88%" valign="top" class="field_name_left">A1</td>
      <td width="12%" valign="top" class="field_data">         
                    <input type="radio" name="CriteriaA1" value="Yes">Yes<input     type="radio" name="CriteriaA1" value="No">No</td>
</tr> 
```

用户只能回答 A 系列问题或 B 系列问题，但不能同时回答两者。他们还必须完成 A 或 B 系列中的所有问题。

我现在有一系列额外的问题 - C1 到 C6 - 并且需要扩展我的验证脚本以确保用户输入 A、B 或 C 并回答每个系列中的所有问题。

我的 A 和 B 原始脚本如下所示：

```
 $(function() {

        $("#editRecord").submit(function(){

        // is anything checked?
        if(!checkEmpty()){
            $("#error").html("Please check something before submitting");
            //alert("nothing Checked");
            return false;
        }
        // Only A _OR_ B
        if(isAorB()){
            $("#error").html("Please complete A or B, not both");
            //alert("please complete A or B, not both");
            return false;
        };
        // all A's or all B's
        if(allAorBChecked()){
            $("#error").html("It appears you have not completed all questions");
            //alert("missing data");
            return false;
        };
        if(haveNo()){
            // we're going on, but sending "type = C"
        }
        //alert("all OK");
            return true;
        });
    });

function checkEmpty(){
    var OK = false;
    $(":radio").each(function(){
        if (this.checked){
            OK = true;
        }
    });
    return OK;
}
 function isAorB(){
    var OK = false;
    var Achecked = false;
    var Bchecked = false;
    $(":radio").each(function(){
        var theChar=this.name.charAt(8);
        // if we have an A checked remember it
         if(theChar == "A" && this.checked && !Achecked){
            Achecked = true;    
        }
        if(Achecked && theChar == "B" && !Bchecked){
            if(this.checked){
                Bchecked = true;
            }
        }
        if (Achecked && Bchecked){
            OK = true;
        }
    });
    return OK;
} 
function allAorBChecked(){
    var notOK = false;
    var Achecked = false;
    $(":radio").each(function(){
        // skip through to see if we're doing A's or B's
    var theChar=this.name.charAt(8);
        // check the A's
     if(theChar == "A" && this.checked && !Achecked){
            Achecked = true;    
        }

    });
    if(Achecked){
        // set the input to A
        $("#type").val("A");
        // check _all_ a's are checked
        var thisName;
        var thisChecked = false;

        $(":radio").each(function(){
            var theChar=this.name.charAt(8);
            var checked = this.checked;
            if (theChar == "A"){
            if (this.name == thisName && !thisChecked){
                // Yes wasn't checked - is No?
                if(!checked){
                    notOK = true;
                }
            }
            thisChecked = checked;
            thisName = this.name;
        }
    });
    }else{
        // set the input to B
        $("#type").val("B");            
        // check _all_ b's are checked
            var thisName;
            var thisChecked = false;
            $(":radio").each(function(){
                var theChar=this.name.charAt(8);
                var checked = this.checked;
                if (theChar == "B"){
                if (this.name == thisName && !thisChecked){
                    // A wasn't checked - is B?
                    if(!checked){
                        notOK = true;
                    }
                }
                thisChecked = checked;
                thisName = this.name;
            }
        });
    }
    return notOK;
}    
function haveNo(){
    var thisName;
    var notOK = false;
        $(":radio").each(function(){
            var checked = this.checked;
            if (this.name == thisName){
                //Is this checked 
                if(checked){
                    notOK = true;
                    $("#type").val("C");            
                }

        }
        thisName = this.name;
    });

    return notOK;
} 
```

这运作良好，但我完全坚持将其扩展为包括 C 系列。我现在必须检查用户是否没有回答任何 A 和 B、A 和 C 以及 B 和 C 问题。我尝试过的一切都无法验证。这是我现在使用新脚本的位置：

```
 $(function() {

        $("#editRecord").submit(function(){

        // is anything checked?
        if(!checkEmpty()){
            $("#error").html("Please check something before submitting");
            //alert("nothing Checked");
            return false;
        }
        // Only A or B or C
        if(isAorBorC()){
            $("#error").html("Please complete A or B or C, not both");
            //alert("please complete A or B, not both");
            return false;
        };
        // all A's or all B's or all C's
        if(allAorBorCChecked()){
            $("#error").html("It appears you have not completed all questions");
            //alert("missing data");
            return false;
        };
        if(haveNo()){
            // we're going on, but sending "type = C"
        }
        //alert("all OK");
            return true;
        });
    });

function checkEmpty(){
    var OK = false;
    $(":radio").each(function(){
        if (this.checked){
            OK = true;
        }
    });
    return OK;
}
function isAorBorC(){
    var OK = false;
    var Achecked = false;
    var Bchecked = false;
    var Cchecked = false;
    $(":radio").each(function(){
        var theChar=this.name.charAt(8);
        // if we have an A checked remember it
         if(theChar == "A" && this.checked && !Achecked){
            Achecked = true;    
        }
        if(theChar == "B" && this.checked && !Achecked){
            Bchecked = true;    
        }
        if(theChar == "C" && this.checked && !Achecked){
            Cchecked = true;    
        }
        if(Achecked && theChar == "B" && !Bchecked){
            if(this.checked){
                Bchecked = true;
            }
        }
        if(Achecked && theChar == "C" && !Cchecked){
            if(this.checked){
                Cchecked = true;
            }
        }
        if(Bchecked && theChar == "C" && !Cchecked){
            if(this.checked){
                Cchecked = true;
            }
        }
        if (Achecked && Bchecked){
            OK = true;
        }
        if (Achecked && CBchecked){
            OK = true;
        }
        if (Bchecked && Cchecked){
            OK = true;
        }
    });
    return OK;
} 
function allAorBorCChecked(){
    var notOK = false;
    var Achecked = false;
    $(":radio").each(function(){
        // skip through to see if we're doing A's or B's
    var theChar=this.name.charAt(8);
        // check the A's
     if(theChar == "A" && this.checked && !Achecked){
            Achecked = true;    
        }

    });
    if(Achecked){
        // set the input to A
        $("#type").val("A");
        // check _all_ a's are checked
        var thisName;
        var thisChecked = false;

        $(":radio").each(function(){
            var theChar=this.name.charAt(8);
            var checked = this.checked;
            if (theChar == "A"){
            if (this.name == thisName && !thisChecked){
                // Yes wasn't checked - is No?
                if(!checked){
                    notOK = true;
                }
            }
            thisChecked = checked;
            thisName = this.name;
        }
    });
    }elseif{
    // set the input to B
        $("#type").val("B");            
        // check _all_ b's are checked
            var thisName;
            var thisChecked = false;
            $(":radio").each(function(){
                var theChar=this.name.charAt(8);
                var checked = this.checked;
                if (theChar == "B"){
                if (this.name == thisName && !thisChecked){
                    // A wasn't checked - is B?
                    if(!checked){
                        notOK = true;
                    }
                }
                thisChecked = checked;
                thisName = this.name;
            }
        });
    }
    return notOK;
}   

    }else{
        // set the input to C
        $("#type").val("C");            
        // check _all_ c's are checked
            var thisName;
            var thisChecked = false;
            $(":radio").each(function(){
                var theChar=this.name.charAt(8);
                var checked = this.checked;
                if (theChar == "C"){
                if (this.name == thisName && !thisChecked){
                    // A wasn't checked - is B?
                    if(!checked){
                        notOK = true;
                    }
                }
                thisChecked = checked;
                thisName = this.name;
            }
        });
    }
    return notOK;
}   
function haveNo(){
    var thisName;
    var notOK = false;
        $(":radio").each(function(){
            var checked = this.checked;
            if (this.name == thisName){
                //Is this checked 
                if(checked){
                    notOK = true;
                    $("#type").val("C");            
                }

        }
        thisName = this.name;
    });

    return notOK;
} 
```

有人看到我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T03:49:04.523

为了大大简化您的任务，我建议**为给定的组创建****一个**可以回答的函数：a）是否检查任何内容；b) 是否检查了所有内容。就像是：

 **```
function isAnyAllChecked(group) {
    var any = false;
    var all = true;
    $(":radio").each(function(){
        var theChar=this.name.charAt(8);
        if(theChar == group && this.checked){
            any = true;
        }
        if(theChar == group && !this.checked){
            all = false;
        }
    });
    return { any:any, all:all };
} 
```

现在您的其他功能可以简单地重写为：

```
function isAorBorC() {
    return (isAnyAllChecked("A").any ? 1 : 0) +
           (isAnyAllChecked("B").any ? 1 : 0) +
           (isAnyAllChecked("C").any ? 1 : 0) !== 1;
}

function allAorBorCChecked() {
    var group = isAnyAllChecked("A").any ? "A" :
                isAnyAllChecked("B").any ? "B" :
                isAnyAllChecked("C").any ? "C" :
                undefined;
    if ( group ) {
        $("#type").val(group);
        return !isAnyAllChecked(group).all;
    }
    else
        return true;
} 
```

笔记：

1.  您可以重用 的返回值`isAnyAllChecked`以提高效率；我没有在上面的代码中这样做来保持方法接口不变。

2.  您*可以* 将您的[类型转换](http://www.java-samples.com/showtutorial.php?tutorialid=819)`boolean`为`int`（隐式或显式）而不是做`any ? 1 : 0`，但恕我直言，这种方式更清晰。

3.  您还*可以*`map`使用数组和函数（如等）将您的解决方案推广到任意数量的组，`filter`但对于您拥有的少数组，这并不是真正需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T07:56:06.887

首先，我认为最好的可用性是让表单更容易使用，更难出错。如果您使用的是 javascript 和 jQuery，您也可以进行设置，以便用户必须先选择一个部分，然后才能选择其中的任何项目。您可以轻松地支持显示所有问题的要求，但是当计算机可以很容易地阻止这种情况时，允许他们执行不必要的工作（例如错误地填写多个部分）对用户是一种伤害。

如果你想看看它可能是什么样子，请发表评论，我会为你做一些事情。

同时，根据您当前的设计，这里有[一个演示一种可能技术的小提琴](http://jsfiddle.net/93Ra9/1/)。它适用于任意数量的部分。

请查看该代码以获取完整列表，但这里是执行繁重验证的脚本。

```
function validate(ev) {
    var sectionsTouched = $('ol').has(':checked'),
       inputs = {},
       errorMessage = '';

    if (sectionsTouched.length === 0) {
        errorMessage = 'Please check something before submitting.';
    } else if (sectionsTouched.length > 1) {
        errorMessage = 'Please complete only one of sections ' + namesCommaDelimited(seriesNames(), 'or') + '.';
    } else {
        sectionsTouched.find('input').each(function(i, e) {
            var me = $(e), name = me.attr('name');
            inputs[name] = !!inputs[name] || me.is(':checked');
        });
        $.each(inputs, function(k, v) {
            if (!v) {
                errorMessage = 'Please complete all questions in your selected section.';
            }
            return v;
        });            
    }
    if (errorMessage !== '') {
        $('#error').html(errorMessage);
        ev.preventDefault();
        return false;
    }
    return true;
} 
```

基本逻辑：如果没有部分有选中项，则显示相应的消息。如果一个以上的部分有一个选中的项目，太多的部分有答案。如果恰好有一个部分有答案，则循环输入并收集那些检查了相应控件名称的列表。如果存在任何未选中的名称，则未选中某个控制组，并显示相应的消息。

我不得不采取一些自由来构建一个足够适合要求的表格，以便进行适当的演示。这是它的样子：

[![我的演示小提琴](../Images/8d0950dea53f5137609f240571df003b.png)](http://jsfiddle.net/93Ra9/1/)

我希望这有帮助！

PS为了完整起见，我想提几个风格考虑：

*   当您发现自己重复代码时，请尝试将重复抽象掉——创建一个函数，或声明一个变量。例如，不要`$('#error').html()`多次设置，而是设置一个值，然后只进行一次 html 设置。
*   尝试编写不秘密依赖文档结构的代码，例如具有特定格式的表单字段名称（在某个位置具有特定字符）。您的 javascript 在很大程度上依赖于`charAt(8)`返回“A”或“B”的函数，这使得它变得脆弱——如果其他人（甚至你未来的自己）不小心破坏了控件名称怎么办？突然，javascript 会中断，两者之间的联系并不明显。您可以对其进行编码，因此您甚至不需要知道哪个部分是哪个部分，只要您有一些可以指示每个单独部分的选择器。使用类名是可以的，因为 javascript 中的类名显然必须与 html 中的类名匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T05:41:27.193

首先，我认为最好的方法是每个部分都有一个表格，并有自己的提交。您只需验证该表单是否得到了全部答复，仅此而已，其余的都被丢弃了。

```
<form id="formA">
<input ...

<button type="submit">Submit with A Answers</button>
</form>
<form id="formB">
<input ...

<button type="submit">Submit with B Answers</button>
</form> 
```

ETC..

但是以防万一你这样做是有原因的，这里有一个关于它如何使它工作的小提琴，不管你有多少个部分，a、b、c、d、e、f 等。

> [http://jsfiddle.net/cUfY4/](http://jsfiddle.net/cUfY4/)

还有一件事：有几种方法可以解决这个问题。建议的 Javascript 是：

```
$('form').submit(function( e ){
    e.preventDefault();
    var globalAnswers = 0;
    var globalComplete = false;
    $('.section').each(function() {
        var $this = $(this), sectionHasAnswers = false, sectionComplete = true;
        $this.find('input[type="radio"]').each(function() {
            var inputName = $(this).attr('name');
            if ($('input[name="' + inputName + '"]').is(':checked')) {
                sectionHasAnswers = true;
            } else {
                sectionComplete = false;
            }
        });
        if (sectionComplete && !globalComplete) {
            globalAnswers++
            globalComplete = true;
        } else {
            if (sectionHasAnswers) {globalAnswers++};
        }
    });

        if (globalAnswers == 1 && globalComplete) {
            // EVERYTHING OK! SUBMIT FORM!
        } else {
            // ERRORS use globalAnswers and globalComplete for exact problem
        }
}); 
```**

# html - 使用 CKeditor 插入 HTML 表单不起作用

> ID：13502494
> 
> 赞同：0
> 
> 时间：2012-11-21T21:42:25.847
> 
> 标签：html, forms, paypal, ckeditor

我在使用 Ckeditor 时遇到了一个大问题。我希望我的客户可以通过个性化页面添加贝宝捐赠按钮。当我的客户想要添加自定义页面时，他们使用 ckeditor。

要添加贝宝按钮，他们只需使用源模式复制/粘贴以下代码：

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_donations">
<input type="hidden" name="business" value="try@try.com">
<input type="hidden" name="lc" value="US">
<input type="hidden" name="item_name" value="Try">
<input type="hidden" name="no_note" value="0">
<input type="hidden" name="currency_code" value="EUR">
<input type="hidden" name="bn" value="PP-DonationsBF:btn_donateCC_LG.gif:NonHostedGuest">
<input type="image" src="https://www.paypalobjects.com/fr_XC/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - la solution de paiement en ligne la plus simple et la plus sécurisée !">
<img alt="" border="0" src="https://www.paypalobjects.com/fr_XC/i/scr/pixel.gif" width="1" height="1">
</form> 
```

但是，当他们保存时，以某种方式修改了 html：

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
    &nbsp;</form> 
```

我不知道如何避免这种情况。我认为这是 CKeditor 配置中的一个选项，它正在替换一些 html 代码，但我不确定。

非常感谢您对未来的建议，

安塞尔姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:45:44.840

这里发生的事情是你`form`在编辑器中有 a `form`，在内容中有 a 。HTML 中不能有嵌套表单。您可能必须想出一些标记化的标签替换机制才能使其正常工作。

我相信 ckeditor 有一个表单插件可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T05:56:06.113

检查ckeditor下方的“文本格式”它应该是“完整的HTML”

# php - MYSQL_INSERT 不工作

> ID：13502496
> 
> 赞同：3
> 
> 时间：2012-11-21T21:42:34.650
> 
> 标签：php, mysql, sql

我曾多次尝试插入数据库。这些值包含一个单引号 - 魔术引号被关闭，addslashes() 和 mysql_real_escape_string() 都转义了字符，但脚本在没有添加到数据库的情况下死亡。我也手动逃脱了，但这也失败了。但是，即使删除撇号，脚本仍然会死掉。

错误是： 无法插入人员：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的“11，Hazel，Blonde，从未错过一天的工作，从伯克利毕业，服务”附近使用正确的语法有人看到任何问题吗？

```
<?php
include('header.php');

$amount = 1;
$staffnum = '0101';
$height = array("5'11", "5'4", "6'2","5'5", "6'4");
$eye = array("Blue","Green","Hazel","Brown");
$hair = array("Brown", "Black", "Blonde", "Red");
$about1 = "Has never missed a day of work";
$about2 = "Graduated from Berkley";
$positions =  array('Server, Bartender', 'Bartender, Host', 'Sever, Host, Bartender', 'Cocktail Server, Bartender, Server'); 
$img = "none";
// arrays
$times = 1;

while($times <= 50) {
$staffnum ++; 
$heighta = mysql_real_escape_string($height[array_rand($height)]);
$eyea =  mysql_real_escape_string($eye[array_rand($eye)]);
$haira =  mysql_real_escape_string($hair[array_rand($hair)]);
$positionsa =   mysql_real_escape_string($positions[array_rand($positions)]);
$about1 =  mysql_real_escape_string($about1);
$about2 =   mysql_real_escape_string($about2);
$img =  mysql_real_escape_string($img);
$staffnum =  mysql_real_escape_string($staffnum);

$insert_staff = "INSERT INTO staff (staffnum, img_link, height, eye, hair, abt1, abt2, titles)
VALUES ($staffnum, $img, $heighta, $eyea, $haira, $about1, $about2, $positionsa)";

$insert_query = mysql_query($insert_staff);

if($insert_query) {
    ?>

<center>
  Member # <?php echo $staffnum; ?> has been added to the database.<br />
  <?php
} else {

  die('Could not insert staff: ' . mysql_error());

}

$times ++;
}

include('footer.php');
?>
  <a href="staff_insert.php?page=1">Return To Staff Insert</a>
</center> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:44:21.577

您需要在要插入的字符串变量周围加上引号：

```
$insert_staff = "INSERT INTO staff (staffnum, img_link, height, eye, hair, abt1, abt2, titles)
VALUES ('$staffnum', '$img', '$heighta', '$eyea', '$haira', '$about1', '$about2', '$positionsa')"; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T21:47:29.923

当你想用基本的 mysql_query 发送这么多变量时，这有点复杂。你应该尝试 PDO 或 mysqli 但如果你需要使用你的代码，它应该更像

```
$insert_staff = "INSERT INTO staff (staffnum, img_link, height, eye, hair, abt1, abt2, titles)
VALUES ('".$staffnum."', '".$img."', '".$heighta."', '".$eyea."', '".$haira."', '".$about1."', '".$about2."', '".$positionsa."')"; 
```

# visual-studio-2010 - 来自 HRESULT 的异常：打开 Visual Studio 2010 设计器时出现 0x8CE00001

> ID：13502499
> 
> 赞同：5
> 
> 时间：2012-11-21T21:42:55.663
> 
> 标签：visual-studio-2010, visual-studio-designer

我正在尝试在 Windows 7 上的 Visual Studio 2010 中设置一个新的 Windows 窗体应用程序 (C++/CLI)。每次我尝试打开设计器时，都会失败并出现以下无用的错误：

```
Exception from HRESULT: 0x8CE00001

Instances of this error (1)  

1\.   Hide Call Stack 

at Microsoft.VisualStudio.Designer.Interfaces.IVSMDCodeDomProvider.get_CodeDomProvider()
at Microsoft.VisualStudio.Shell.Design.Serialization.CodeDom.CodeDomDocDataAdapter.get_Provider()
at Microsoft.VisualStudio.Shell.Design.Serialization.CodeDom.CodeDomDocDataAdapter.get_CompileUnit()
at Microsoft.VisualStudio.Design.Serialization.CodeDom.VSCodeDomDesignerLoader.PerformLoad(IDesignerSerializationManager serializationManager)
at Microsoft.VisualStudio.Design.Serialization.CodeDom.VSCodeDomDesignerLoader.DeferredLoadHandler.Microsoft.VisualStudio.TextManager.Interop.IVsTextBufferDataEvents.OnLoadCompleted(Int32 fReload) 
```

如果我调试 Visual Studio 并中断 CLR 异常，它实际上会首先抛出此异常：

> Microsoft.VisualStudio.Design.dll 中出现了“System.ArgumentException”类型的第一次机会异常
> 
> 附加信息：参数不正确。（来自 HRESULT 的异常：0x80070057 (E_INVALIDARG)）

使用此调用堆栈：

```
>   Microsoft.VisualStudio.Design.dll!Microsoft.VisualStudio.Design.Serialization.CodeDom.VSCodeDomDesignerLoader.VerifyNestedDocDataCompatible() + 0x15d bytes 
    Microsoft.VisualStudio.Design.dll!Microsoft.VisualStudio.Design.Serialization.CodeDom.VSCodeDomDesignerLoader.Microsoft.VisualStudio.Designer.Interfaces.IVSMDDesignerLoader.Initialize(object pSp, object pHier, int itemid, object punkDocData) + 0xb5 bytes  
    [Native to Managed Transition]  
    vcpkg.dll!CVCFormEditorFactory::CreateEditorInstance()  + 0x2e49f bytes 
    msenv.dll!CVsUIShellOpenDocument::OpenSpecificEditor()  + 0x784 bytes   
    VCProject.dll!CVCFileNode::OpenSpecificEditor()  + 0xc6 bytes   
    VCProject.dll!CVCFileNode::OpenSpecificEditor()  + 0x3a bytes   
    VCProject.dll!CVCFileNode::DoOpenFile()  + 0x1fe bytes  
    VCProject.dll!CVCFileNode::DoDefaultAction()  + 0x5b bytes  
    VCProject.dll!CVCArchy::ExecCommand()  + 0x8c bytes 
    msenv.dll!CVsUIHierarchyBaseWin::ExecHierParentChain()  + 0x85 bytes    
    msenv.dll!CVsUIHierarchyBaseWin::WinExecCommand()  + 0x7d bytes 
    msenv.dll!CVsUIHierarchyBaseWin::ProcessLButtonDblClkMsg()  + 0xd8 bytes    
    msenv.dll!FnwpTVFixer()  + 0x76b49 bytes    
    user32.dll!_InternalCallWinProc@20()  + 0x23 bytes  
    user32.dll!_UserCallWinProcCheckWow@32()  + 0xb7 bytes  
    user32.dll!_DispatchMessageWorker@8()  + 0xed bytes 
    user32.dll!_DispatchMessageW@4()  + 0xf bytes   
    msenv.dll!ProcessMessage()  + 0x4d bytes    
    msenv.dll!CMsoCMHandler::EnvironmentMsgLoop()  + 0x87 bytes 
    msenv.dll!CMsoCMHandler::FPushMessageLoop()  + 0x79 bytes   
    msenv.dll!SCM::FPushMessageLoop()  + 0x8c bytes 
    msenv.dll!SCM_MsoCompMgr::FPushMessageLoop()  + 0x2a bytes  
    msenv.dll!CMsoComponent::PushMsgLoop()  + 0x28 bytes    
    msenv.dll!VStudioMainLogged()  + 0x22a bytes    
    msenv.dll!_VStudioMain()  + 0x78 bytes  
    devenv.exe!util_CallVsMain()  + 0xdb bytes  
    devenv.exe!CDevEnvAppId::Run()  + 0x693 bytes   
    devenv.exe!_WinMain@16()  + 0x9c bytes  
    devenv.exe!operator new[]()  + 0xb31c bytes 
    kernel32.dll!@BaseThreadInitThunk@12()  + 0x12 bytes    
    ntdll.dll!___RtlUserThreadStart@8()  + 0x27 bytes   
    ntdll.dll!__RtlUserThreadStart@8()  + 0x1b bytes 
```

这是一个干净的新项目（**File → New → Project... → Visual C++ → CLR → Windows Forms Application**）。在我创建一个新项目后，打开自动生成的`Form1.h`结果会导致错误而不是设计器。但是，如果我创建一个 C# Windows 窗体应用程序而不是 C++/CLI，它就可以正常工作。

关于如何解决这个问题并打开设计器的任何想法？我尝试了以下所有方法均无济于事：

*   重新安装[VS 2010 SP1](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=75568aa6-8107-475d-948a-ef22627e57a5&displaylang=en)
*   运行 Windows 更新，其中安装了两个与 VS 相关的更新（“Microsoft Visual Studio 2010 Service Pack 1 更新 (KB2736182)”和“Microsoft Visual Studio 2010 Office 运行时工具更新 (KB2764593)”）
*   安装[KB2635973](http://www.microsoft.com/en-us/download/details.aspx?id=27130)，它修复了一个类似的问题
*   以上安装后重启
*   在 DirectX 控制面板中关闭所有 DirectX 调试/验证设置
*   通过“程序和功能”控制面板卸载名称中带有“Microsoft SQL Server Compact”的任何内容

我在网上找到了一些类似的线程（[一](http://connect.microsoft.com/VisualStudio/feedback/details/684190/windows-forms-designer-fails-to-load-for-c-cli-project-error-0x8ce00001)、[二](http://social.msdn.microsoft.com/Forums/en-US/vcprerelease/thread/67d65d8d-db42-430f-aeb7-40925cb0c0c8)、[三](http://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/51f26bc6-1e7d-4e34-8b0e-853b48aa1749)），但它们都没有定论或对我不起作用。我还没有尝试完全重新安装 Visual Studio，但接下来我可能不得不尝试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T15:57:37.497

我已经通过设置成功解决了这个问题：

> 工具 -> 选项 -> 文本编辑器 -> C++ -> 高级 -> “禁用数据库”

回到**false**（当`DisableDataBase == true`出现 HRESULT 错误时），而不是重新启动 VisualStudio。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:01:25.690

经过多次核对和重新安装后，我认为这是 Visual Studio 扩展的问题。

完全卸载 Visual Studio（即使使用[`VS2010_Uninstall-RTM.ENU.exe /full /netfx`](http://archive.msdn.microsoft.com/vs2010uninstall)）并重新安装它也无济于事。但是，如果我创建了一个新的 Windows 用户，它对那个用户来说工作得很好。同样，如果我核对我的注册表项`HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\10.0`和`HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\10.0_Config`注册表项（及其子项），它就可以工作。

在煞费苦心地将我的旧注册表（它给出了错误的地方）与一个新的注册表（它工作的地方）进行了比较并协调它们之后，唯一剩下的差异与特定的 VS 扩展有关。由于我不再需要该扩展，因此我不需要它的注册表项，因此没有它们，Designer 将按预期工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-06T19:47:19.203

我在 VS2013 中遇到了这个错误

为我解决的问题是

*   删除预编译的头文件
*   使用以管理员身份运行重新打开 VS
*   重建解决方案

之后我不再收到错误，希望这可以帮助某人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-06T15:59:14.213

我在 Visual Studio 2012 中解决了这个问题。我的项目位于 Dropbox 目录中，并且从 hresult 0x8ce00001 发出的异常问题一直存在，直到我将项目移动到我的桌面。我认为 Dropbox 的版本控制活动可能与该问题有关。我希望这可以帮助别人！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-21T18:12:00.117

我只安装了 SQL Server Compact 3.5 就解决了这个问题。

注意，也许您的项目需要 4.0 版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-31T22:24:01.890

构建 -> 清洁解决方案。关闭 Visual Studio 并重新打开。这解决了我的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-27T16:28:32.313

这个问题很老，但是由于我在 VS 2017 中找到的解决方案非常简单，所以我决定发布它。对我来说，当我从 Debug X86 切换到 Debug X64 再切换回 X86 时，这个问题就开始了。由于我没有意识到问题是在什么时候出现的，所以我浪费了大量时间寻找解决方案。但是当我回到 Debug X64 时，问题就消失了……

# android - 如何将 ImageView 与 ListView 结合起来

> ID：13502502
> 
> 赞同：0
> 
> 时间：2012-11-21T21:43:03.103
> 
> 标签：android

我将我的数据库连接到 ListView，如下所示：

```
public void update_list(String NN) {
       c = db.rawQuery(NN, null);
       startManagingCursor(c);
       String[] from = new String[]{"_id","Fname","Lname","Phone","Car","CarNum" };
       int[] to = new int[]{  R.id._id,R.id.Fname,R.id.Lname,R.id.Phone,R.id.Car,R.id.CarNum };
       SimpleCursorAdapter notes = new SimpleCursorAdapter (this, R.layout.my_list, c, from, to);
       setListAdapter(notes);
       setListAdapter(new SimpleCursorAdapter(this, R.layout.my_list, c, from,to) {

       @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            View row = super.getView(position, convertView, parent);
        }
    });
    } 
```

现在我需要将 ImageView 连接到图片

我有字段 PicNum 保存图片链接

我知道像这样将图片加载到 ImageView：

```
 MyPic = (ImageView) findViewById(R.id.MyPic);
        try
        {
        File imgFile = new File("/sdcard/MyPic/Unzip/" +MyParam.zPicNum+ ".jpeg");
        if(imgFile.exists()){
            Bitmap myBitmap = BitmapFactory.decodeFile(imgFile.getAbsolutePath());
             MyPic.setImageBitmap(myBitmap);
            }
        else
        {
             MyPic.setImageBitmap(null);
        }
      }
      catch (Exception e) {
           MyPic.setImageBitmap(null);
    } 
```

如何将此 ImageView 结合到我的 ListView ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:39:59.550

试试这个将图像插入列表视图：

```
MySimpleAdapter notes;

    public class MySimpleAdapter extends SimpleCursorAdapter{

            public MySimpleAdapter(Context context, int layout, Cursor c, String[] from, int[] to) {
                super(context, layout, c, from, to);
            }

            @Override
            public void setViewImage(ImageView v, String zPicNum) {
                try{
                    String pathName = Environment.getExternalStorageDirectory().getPath() + "MyPic/Unzip/" +zPicNum+ ".jpeg";
                    File path = new File(pathName);
                    if(path.exists()){
                        BitmapFactory.Options options = new BitmapFactory.Options();
                        Bitmap bm = BitmapFactory.decodeFile(pathName, options);
                        v.setImageBitmap(bm);
                    }
                    else{
                        v.setImageResource(R.drawable.defaultpic);
                    }
                }
                catch (Exception e)
                {
                   Toast.makeText(getActivity(), "error in finding images", Toast.LENGTH_LONG).show();
                }
            }
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T22:08:01.307

`SimpleCursorAdapter`被弃用是有原因的。原因是，它将冻结您的整个应用程序，直到它下载当前视口中可见的所有图像。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T21:56:45.470

在&数组中添加`PicNum`字段和`R.id.MyPic`（它应该是 的一部分`R.layout.my_list`） ：`from``to`

```
 String[] from = new String[]{"_id","Fname","Lname","Phone","Car","CarNum","PicNum" };
   int[] to = new int[]{R.id._id,R.id.Fname,R.id.Lname,R.id.Phone,R.id.Car,R.id.CarNum, R.id.MyPic}; 
```

然后在返回之前使用`getView()`方法填充图片：`R.id.MyPic`

```
@Override
 public View getView(int position, View convertView, ViewGroup parent) {
  if(convertView.getId()==R.id.MyPic){
    /*Your code to load the Picture to convertView*/
    return convertView;
    }else return super.getView(position, convertView, parent);
   }
 }); 
```

另一种选择是使用 a`ViewBinder`并检查`View`被绑定的是否为`R.id.MyPic`，然后再次将图片加载到其中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T00:26:44.617

SimpleCursor Adapter 很容易实现，这里有一个，它将帮助您学习简单的光标适配器[点击这里](http://xebee.xebia.in/2010/12/28/android-listview-with-images-cursor/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T21:57:54.940

PicNum 中有什么？如果它是图像的 URL，则必须先下载文件并对其进行解码，然后才能显示它，因此不能单独使用 SimpleCursorAdapter。如果需要，您可以继承 SimpleCursorAdapter 并使用 SimpleCursorAdapter.ViewBinder 接口对其进行扩展。这将允许您对大多数列使用默认的 bindView 行为，然后下载并解码 PicNum 的图像。

# mysql - 纬度和经度，2 个索引还是 1 个复合索引？

> ID：13502505
> 
> 赞同：1
> 
> 时间：2012-11-21T21:43:14.260
> 
> 标签：mysql, sql

我很好奇在例如基于地图的商店定位器的上下文中，最有效的索引方式是什么。

1.  用户将地图平移/缩放到他们想要查看的区域。
2.  应用程序确定视口的边界，也就是 lat/lng 的 max/min。

以基本形式发出查询：

```
SELECT *
FROM locations
WHERE lat BETWEEN $min_lat AND $max_lat
    AND lng BETWEEN $min_lng AND $max_lng 
```

最好使用单个复合`INDEX(lat, lng)`索引，还是使用两个单独的索引`INDEX(lat), INDEX(lng)`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:54:04.030

因为`lat`and`lng`彼此独立，并且您在`where` 子句中单独使用它们而不是组合使用它们，所以我会使用单独的索引。

# php - 如何使用正则表达式查找文本是否具有 IP 地址？

> ID：13502507
> 
> 赞同：1
> 
> 时间：2012-11-21T21:43:29.020
> 
> 标签：php, regex

> **可能重复：**
> [正则表达式检查 IP 是否有效](https://stackoverflow.com/questions/4011855/regexp-to-check-if-an-ip-is-valid)

我不擅长正则表达式，我搜索了这个，但我能找到的只是匹配在数字前后有空格的 IP 地址，例如它只匹配这个：

```
Text before 192.168.1.1 Text after 
```

我怎样才能让它匹配任何IP地址，我不想要IP我只想知道文本是否有IP，例如我也希望它匹配：

```
text before192.168.1.1text after 
```

我试过这些：

```
\b(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\b

^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$ 
```

并提前感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T21:48:50.327

```
if (preg_match('/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/', $string, $match)) {
    if (filter_var($match[0], FILTER_VALIDATE_IP)) {
        // we have an IP
    }
} 
```

是的，您可以构造一个直接匹配 0-255 的正则表达式以及 IP 必须遵循的所有其他规则，但这更直接。

# c# - EntityFramework5代码先行，如何配置不同列名的分表关系？

> ID：13502509
> 
> 赞同：0
> 
> 时间：2012-11-21T21:43:47.273
> 
> 标签：c#, sql, code-first, entity-framework-5

我有两个要使用 EntityFramework 查询的表，使用了一个主表，这是用于存储辅助数据的第二个表，我希望我可以进行左连接，但我做不到，这里是元素：

```
public class TableA
{
    public int Id {get; set;}
    public string Value {get;} set
}

public class OptionalDataTableB
{
    public int OptionalDataTableBId {get; set;}
    public string OtherValue {get; set;}
} 
```

这里的映射类

```
public class TableAMap: EntityTypeConfiguration<TableA>
{
    public TableAMap ()
    {
        this.HasKey (e => e.Id);
        this.Property (e => e.Id)
                  . IsRequired ()
             .HasDatabaseGeneratedOption(System.ComponentModel.DataAnnotations.Schema.DatabaseGeneratedOption.Identity);

    }
}

public class OptionalDataTableBMap: EntityTypeConfiguration<OptionalDataTableB>
{
    public OptionalDataTableB ()
    {
        this.HasKey (e => e.OptionalDataTableBId);
        this.Property (e => e.OptionalDataTableBId)
           . IsRequired ()
    }
} 
```

我想与 DbContext 建立关系

```
public class MyDbContext: DbContext
{
    protected override void OnModelCreating (DbModelBuilder ModelBuilder)
    {
        modelBuilder.Configurations.Add (new Mapping.TableAMap());
        modelBuilder.Configurations.Add (new Mapping.OptionalDataTableBMap());
    }
} 
```

如何配置映射才能产生这种请求？：

```
select * 
from TableA 
    left join OptionalDataTableB On TableA.Id = OptionalDataTableB.OptionalDataTableBId 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:53:09.487

MSDN 中的以下内容应该回答您的问题：http: [//msdn.microsoft.com/en-us/data/hh134698.aspx](http://msdn.microsoft.com/en-us/data/hh134698.aspx)

# php - PHP 连接超时

> ID：13502510
> 
> 赞同：1
> 
> 时间：2012-11-21T21:43:52.810
> 
> 标签：php, mysql, performance, curl, timeout

我正在测试一个复杂的项目，其中涉及几个通过 CURL 相互链接的 php 文件。我运行主函数 15 次。它只运行 4 次然后抱怨`Maximum execution time of 30 seconds exceeded`。当我查看数据库时，我看到每次运行它时，操作都执行**了4 次。**会是什么呢？错误出现在我正在调用其他一些 php 文件的行上`$data = curl_exec($ch);`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T14:57:49.510

在您的 php 函数的起点设置此函数执行的时间限制。设置 0 表示无限制。

```
function doWork() {
    set_time_limit(0);
    /* do your work here */
} 
```

curl中设置的时间限制：

```
curl_setopt($ch, CURLOPT_TIMEOUT, 400); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T09:47:37.343

如果您需要请求多个页面，您可以同时（并行）使用 curl_multi_*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:46:00.467

请参阅 php.ini`max_execution_time`设置和调整。`120`，`240`仍然有意义并且没问题，但不要试图将其设置`0`为禁用此限制。而是将您的脚本修复为缓存远程文件，而不是一直获取它。一般来说，我希望你的设计会被打破。通过 cURL 连接脚本表明您需要 API 或存在其他一些设计问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T21:50:27.017

其他人已经涵盖了最大执行时间，所以一般的想法：

*   确保你没有不必要的循环。如果你完成了一个循环，“打破”它。请记住，您也可以中断多次迭代。
*   我没有尝试过这个（纯粹只是想），但是在执行结束时使用 Ajax 调用来开始下一次执行呢？我敢打赌，因为您正在发出新请求，所以会重新启动执行计时器。

# ruby-on-rails - Rake：没有要加载的文件——xpath

> ID：13502511
> 
> 赞同：1
> 
> 时间：2012-11-21T21:43:53.137
> 
> 标签：ruby-on-rails, ruby, xpath, rake

如何解决以下错误？

```
bundle exec rake db:create
rake aborted!
no such file to load -- xpath
/Users/michael/Sites/appsbar/config/application.rb:13:in `<top (required)>'
/Users/michael/Sites/appsbar/Rakefile:5:in `require'
/Users/michael/Sites/appsbar/Rakefile:5:in `<top (required)>' 
```

**有痕迹**

```
bundle exec rake db:create --trace
rake aborted!
no such file to load -- xpath
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/capybara-2.0.1/lib/capybara.rb:3:in `<top (required)>'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/bundler-1.2.2/lib/bundler/runtime.rb:68:in `require'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/bundler-1.2.2/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/bundler-1.2.2/lib/bundler/runtime.rb:66:in `each'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/bundler-1.2.2/lib/bundler/runtime.rb:66:in `block in require'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/bundler-1.2.2/lib/bundler/runtime.rb:55:in `each'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/bundler-1.2.2/lib/bundler/runtime.rb:55:in `require'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/bundler-1.2.2/lib/bundler.rb:128:in `require'
/Users/michael/Sites/appsbar/config/application.rb:13:in `<top (required)>'
/Users/michael/Sites/appsbar/Rakefile:5:in `require'
/Users/michael/Sites/appsbar/Rakefile:5:in `<top (required)>'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/lib/rake/rake_module.rb:25:in `load'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/lib/rake/rake_module.rb:25:in `load_rakefile'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/lib/rake/application.rb:581:in `raw_load_rakefile'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/lib/rake/application.rb:87:in `block in load_rakefile'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/lib/rake/application.rb:158:in `standard_exception_handling'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/lib/rake/application.rb:86:in `load_rakefile'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/lib/rake/application.rb:70:in `block in run'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/lib/rake/application.rb:158:in `standard_exception_handling'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/lib/rake/application.rb:68:in `run'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/gems/rake-10.0.2/bin/rake:37:in `<top (required)>'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/bin/rake:19:in `load'
/Users/michael/.rbenv/versions/1.9.2-p290/gemsets/appsbar/bin/rake:19:in `<main>' 
```

**应用程序.rb**

```
require File.expand_path('../boot', __FILE__)

# Pick the frameworks you want:
require "active_record/railtie"
require "action_controller/railtie"
require "action_mailer/railtie"
require "active_resource/railtie"
require "sprockets/railtie"
# require "rails/test_unit/railtie"

if defined?(Bundler)
  # If you precompile assets before deploying to production, use this line
  Bundler.require(*Rails.groups(:assets => %w(development test)))
  # If you want your assets lazily compiled in production, use this line
  # Bundler.require(:default, :assets, Rails.env)
end

module Appsbar
  class Application < Rails::Application
    # Settings in config/environments/* take precedence over those specified here.
    # Application configuration should go into files in config/initializers
    # -- all .rb files in that directory are automatically loaded.

    # Custom directories with classes and modules you want to be autoloadable.
    # config.autoload_paths += %W(#{config.root}/extras)

    # Only load the plugins named here, in the order given (default is alphabetical).
    # :all can be used as a placeholder for all plugins not explicitly named.
    # config.plugins = [ :exception_notification, :ssl_requirement, :all ]

    # Activate observers that should always be running.
    # config.active_record.observers = :cacher, :garbage_collector, :forum_observer

    # Set Time.zone default to the specified zone and make Active Record auto-convert to this zone.
    # Run "rake -D time" for a list of tasks for finding time zone names. Default is UTC.
    # config.time_zone = 'Central Time (US & Canada)'

    # The default locale is :en and all translations from config/locales/*.rb,yml are auto loaded.
    # config.i18n.load_path += Dir[Rails.root.join('my', 'locales', '*.{rb,yml}').to_s]
    # config.i18n.default_locale = :de

    # Configure the default encoding used in templates for Ruby 1.9.
    config.encoding = "utf-8"

    # Configure sensitive parameters which will be filtered from the log file.
    config.filter_parameters += [:password]

    # Enable escaping HTML in JSON.
    config.active_support.escape_html_entities_in_json = true

    # Use SQL instead of Active Record's schema dumper when creating the database.
    # This is necessary if your schema can't be completely dumped by the schema dumper,
    # like if you have constraints or database-specific column types
    # config.active_record.schema_format = :sql

    # Enforce whitelist mode for mass assignment.
    # This will create an empty whitelist of attributes available for mass-assignment for all models
    # in your app. As such, your models will need to explicitly whitelist or blacklist accessible
    # parameters by using an attr_accessible or attr_protected declaration.
    config.active_record.whitelist_attributes = true

    # Enable the asset pipeline
    config.assets.enabled = true

    # Version of your assets, change this if you want to expire all your assets
    config.assets.version = '1.0'

    # Devise recommendation:
    # If you are deploying Rails 3.1 on Heroku, you may want to set:
    # config.assets.initialize_on_precompile = false
    # On config/application.rb forcing your application to not access the DB
    # or load models when precompiling your assets.
    config.assets.initialize_on_precompile = false
  end
end 
```

**耙文件**

```
#!/usr/bin/env rake
# Add your own tasks in files placed in lib/tasks ending in .rake,
# for example lib/tasks/capistrano.rake, and they will automatically be available to Rake.

require File.expand_path('../config/application', __FILE__)

Appsbar::Application.load_tasks 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T03:26:02.300

看

[https://github.com/jnicklas/capybara/issues/882](https://github.com/jnicklas/capybara/issues/882)

有些人通过重做“bundle update capybara”解决了这个问题，这似乎解决了某种捆绑器依赖的怪异问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:14:19.350

*/full/path/to/the/gem/being/used/bin/gem install 'xpath'*请确保您使用的是*正确*的gem 二进制文件，例如，我的 ruby​​ 安装在 $HOME/.rvm/bin/ruby gem 位于 $HOME/.rvm/gems/ruby-1.9.3-p327/bin 中。它也可以在 /usr/bin 中找到。我**总是**将它作为 $HOME/.rvm/gems/ruby-1.9.3-p327/bin/ruby $HOME/.rvm/gems/ruby-1.9.3-p327/bin/gem 运行，以确保不会模棱两可我选对了。

# c# - 如何为可能不存在的路径和文件创建整个目录结构？

> ID：13502513
> 
> 赞同：0
> 
> 时间：2012-11-21T21:44:04.377
> 
> 标签：c#

我正在开发 ac# 应用程序，它在 app.config 中有一个文件路径，如果它存在/不存在，我想创建或覆盖它。

例子：`<add key="file" value="c:\myapp\file.txt"/>`

我在创建目录/文件组合时遇到问题。

有人可以给我代码示例，说明如何创建包括空文本文件的整个文件夹路径

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T21:52:05.457

您可能希望创建文件夹，之后您可以使用[FileStream](http://msdn.microsoft.com/en-us/library/47ek66wy.aspx)编写文件。

我有一个方便的功能，可以在写入可能不存在的目录中的文件之前创建目录。

```
/// <summary>
/// Create the folder if not existing for a full file name
/// </summary>
/// <param name="filename">full path of the file</param>
public static void CreateFolderIfNeeded(string filename) {
  string folder = System.IO.Path.GetDirectoryName(filename);
  System.IO.Directory.CreateDirectory(folder);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:54:18.450

你的问题不是很清楚，但我假设你想做这样的事情

```
using System.IO;
...

string path = ConfigurationManager.AppSettings["FolderPath"];
string fullPath = Path.Combine(path, "filename.txt");

if(!Directory.Exists(path))
{
   Directory.CreateDirectory(path);
}

using(StreamWriter wr = new StreamWriter(fullPath, FileMode.Create))
{

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:52:16.003

**详细信息：**将目录路径和文件放在两个不同的键中以使其更容易

**应用程序配置**

```
<add key="filePath" value="c:\myapp\"/>
<add key="fileName" value="file.txt"/> 
```

**班级**

```
string path = ConfigurationManager.AppSettings["filePath"];
string fileName = ConfigurationManager.AppSettings["fileName"];
string currentPathAndFile = path + fileName;

 if (!File.Exists(currentPathAndFile)) // Does the File and Path exist
 {
    if (!Directory.Exists(path))  // Does the directory exist
      Directory.CreateDirectory(path);

     // Create a file to write to. 
     using (StreamWriter sw = File.CreateText(currentPathAndFile)) 
     {
         sw.WriteLine("Hello");
         sw.WriteLine("And");
         sw.WriteLine("Welcome");
     }  
  } 
```

# android - 我应该在我的 iOS 和 Android 应用程序中使用相同的包名称吗？

> ID：13502519
> 
> 赞同：14
> 
> 时间：2012-11-21T21:44:35.563
> 
> 标签：android, ios, app-store, google-play

我应该以相同的包名称发布我的应用程序的 Android 和 iOS 版本，还是使用不同的包名称有一些好处？

即我应该`com.mycompany.myapp`用于我的应用程序的 Android 和 iOS 版本，还是应该将它们分隔为`com.mycompany.myapp.ios`and `com.mycompany.myapp.android`？

我现在想不出任何技术上的理由来使用单独的包，但是因为这将是可怕的改变以后我很想使用不同的包。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T21:59:54.017

我同意其他答案，这完全是您自己的选择，但我也会反对其他答案并声明，就个人而言，我觉得没有必要使用特定的 ios 和 android 包/命名空间。

这两个平台都有自己的意识形态和结构，在命名类和包/命名空间时，我通常会使用它们。

举这些例子：

安卓：

*   com.company.app；
*   com.company.app.listeners；
*   com.company.app.adapters
*   com.company.app.ui；

iOS

*   com.company.app；
*   com.company.delegates；
*   com.company.ui；

它简单、整洁且易于理解。显然有交叉，总有一些混乱......但语言和 IDE 本身的不同足以让你在游戏中保持头脑清醒。

所以，如前所述；个人选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T21:46:26.760

这是任意的。但我个人会使用不同的软件包：

```
com.mycompany.android.myapp
com.mycompany.ios.myapp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:52:22.933

同意。在 Android 本身中，您应该为应用程序及其类（尽可能）使用相同的包名称，但不要在 iOS 和 Android 中使用相同的包。这不是技术限制，只是可以帮助您避免愚蠢的错误。

# c# - 将 ef.utility.cs.ttinclude 转换为类

> ID：13502532
> 
> 赞同：3
> 
> 时间：2012-11-21T21:45:50.730
> 
> 标签：c#, entity-framework-5

我已将 Visual Studio Entity Framework 5.0 包含文件 (EF.Utility.CS.ttinclude) 中的类转换为一组标准 C# 类。我为什么这样做并不重要，只要说我有充分的理由这样做就足够了，并且没有其他方法可以完成我希望完成的事情。尝试通过提供的 t4 模板（为 EF 生成标准 DbContext 的模板）测试类时，我收到以下错误：

* * *

```
Error   1   Running transformation: System.IO.FileNotFoundException: Could not load file or assembly 'EFUtilities_5_0_DeConstruct, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified.
File name: 'EFUtilities_5_0_DeConstruct, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null'
   at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean forIntrospection)
   at System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)
   at System.Reflection.Assembly.Load(String assemblyString)
   at System.UnitySerializationHolder.GetRealObject(StreamingContext context)
   at System.IServiceProvider.GetService(Type serviceType)
   at EFUtilities_5_0_DeConstruct.EntityFrameworkTemplateFileManager.Create(Object textTransformation) in c:\Users\Sam\Documents\Visual Studio 2012\Projects\EFExplorer_5\EFUtilities_5_0_DeConstruct\EntityFrameworkTemplateFileManager.cs:line 29
   at Microsoft.VisualStudio.TextTemplating6F3E7F749A9B7F1589040546E2B00865752CC91ED5490722E3718CB7A5DDD503FF97964710FBB3EBF135630FF50F8F2A8EA8FA5AA531EC2449158E3D60FD019D.GeneratedTextTransformation.TransformText() 
```

* * *

此错误发生在 Visual Studio 2012 Premium 创建项目后添加了标准实体框架数据项目并生成了从数据库构建的模型（数据库有一个没有什么特别之处的表 - 主键，几个测试列）选择 Build|Transform all T4 菜单选项（仅在选择 Model1.tt 文件并选择“Run Custom Tool”时也会发生）。Model1.tt（名称是默认分配的）文件是失败的文件，Model1.Context.tt 文件执行得很好。两个模板都已修改，因此它们包含与 EF.Utility.CS.ttinclude 文件相同的程序集和导入子句（实际上是剪切和粘贴）以及对存储结果类的 DeConstruct 程序集的附加引用。解决方案编译到“Debug”中的标准调试位置，编译到“Release”的生产目录 (C:\T4\EF_5_0\Assembiles)。我尝试将 Model1.tt 文件设置为指向这两个位置，但我得到了同样的错误。

错误所指出的违规行是： DTE dte = (DTE)hostServiceProvider.GetService(typeof(DTE));

envDTE 程序集被添加到引用和类的 using 子句中。

所有这一切的关键是，我已经使用 EF 4.3.1 EF.Utility.CS.ttinclude 文件和 Visual Studio 2010 中相应的 4.3 DbContext 生成器文件成功地完成了这项工作。工作正常，对基本类进行了扩展，等等所以...关于为什么我可能会在 VS2012 和 EF 5.0 中看到这个错误的任何线索？我没有尝试过的一件事是将 EF 5.0 带入 VS2010 环境。有点不想污染工作环境。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T07:35:02.623

找到了答案：

选择哪个版本的EnvDTE无关紧要（GAC中的版本，显示为“envdte”或VS2012本地的版本，显示为“EnvDTE”。将任一版本添加到项目中，然后，添加后，对（关闭）单击引用列表中的程序集名称（“EnvDTE”或“envdte”），选择“属性”并将属性“嵌入互操作类型”设置为 false 并重新构建。这对我有用。

# xml - Wordpress 在没有导入器的情况下将示例数据添加到默认主题

> ID：13502544
> 
> 赞同：1
> 
> 时间：2012-11-21T21:46:40.043
> 
> 标签：xml, wordpress, themes

我有一个简单的 Web 应用程序，让用户在文本框中输入目录名称，然后从一组单选按钮中选择一个主题设置为默认主题。单击提交按钮后，脚本会为 wordpress 站点创建目录。用户只需访问 url ( [http://ip_address/directory_name](http://ip_address/directory_name) ) 并完成安装（站点名称、管理员密码等）。

我想做的是默认加载特定主题的示例数据。到目前为止，我所看到的一切都在使用导入器插件，但这需要用户登录并上传示例数据 xml 文件。我希望示例数据像默认主题一样自动到位。有什么建议么？

（我将站点托管在 linux ec2 服务器上并使用 CGI、perl 和 bash 脚本）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-16T08:52:59.783

我做了一些不同的事情，但也许人们在**没有 Importer 工具的情况下搜索将数据导入 WP**可能会发现这很有用。该函数基本上解析 XML 并创建一个新帖子：[https ://stackoverflow.com/a/19931185/2066118](https://stackoverflow.com/a/19931185/2066118)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:48:52.200

我决定使用适当的示例数据对主题进行 sql 转储。然后，我可以使用这个转储文件恢复新数据库，并且瞧瞧示例数据。

# imageview - 似乎无法在 Android 中禁用抗锯齿

> ID：13502548
> 
> 赞同：1
> 
> 时间：2012-11-21T21:47:18.290
> 
> 标签：imageview, antialiasing

我是 Android 新手，我已经完成了一款以像素艺术为特色的游戏。我打算从小的像素化 png 文件中放大我的图像（绘制到画布上的图像视图和位图）。问题是，无论我尝试什么方法，我似乎都无法禁用抗锯齿。图像总是模糊不清。我所有的图像都在一个“可绘制”文件夹中。我在 xml 的 ImageView 中尝试了 android:antialias="false" 。

尝试了此处描述的方法：[http](http://www.41post.com/4241/programming/android-disabling-anti-aliasing-for-pixel-art) : //www.41post.com/4241/programming/android-disabling-anti-aliasing-for-pixel-art \尝试在绘制位图时更改油漆（paint.setAntiAlias（false））到画布上。

甚至尝试将 ImageView 链接到可使用 antialias="false" 绘制的 xml 位图

我错过了什么吗？最后，我只好解决一些图像模糊不清，将大图像作为大图像，而不是在 xml 文件中调整大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T21:06:34.327

从[硬件加速指南](http://developer.android.com/guide/topics/graphics/hardware-accel.html#unsupported)，它看起来`Paint#setFilterBitmap()`总是启用并且在启用硬件加速时无法禁用。尝试检查您的应用程序是否正在使用硬件加速。

启用“使用主机 GPU”选项时，我在模拟器中看到了类似的行为，并发现没有抗锯齿行为的设备可能会通过使用`Paint#setFilterBitmap(true)`. 尽管没有禁用主机 GPU 选项，但我无法禁用模拟器中的行为。

# c++ - C++ 指针数组 - 初始化和访问对象

> ID：13502549
> 
> 赞同：1
> 
> 时间：2012-11-21T21:47:19.137
> 
> 标签：c++, arrays, pointers

指针数组有问题。我有一个名为**C**的自定义类。C 有一个变量**double c1**。我必须使用自定义编写的排序算法按 c1 对 Cs 数组进行排序。我猜测由于我必须在数组中移动对象，因此只移动指向对象的指针会更有效，因此我必须使用的不是对象数组，而是指向对象的指针数组。

我像这样初始化数组：

```
C** someC;
someC = new C*[size];
for(int i = 0; i < size; i++) {
    // a and b are of type CPoint
    someC[i] = new C(a,b);
} 
```

我做这部分正确吗？正是对 C 对象的调用导致了问题：

```
someC[i]->a.x 
```

给我一个错误：'->a' 的左边必须指向类/结构/联合/通用类型

我是 C++ 新手，所以我可能遗漏了一些明显的东西，但我做了一些研究，没有发现任何东西。也许我不太了解指针是如何工作的......

* * *

更新

C类的头文件：

```
#pragma once

class C
{
public:
    CPoint a;
    CPoint b;
    double c1;
    C(void);
    C(CPoint,CPoint);
    ~C(void);
}; 
```

实施：

```
#include "StdAfx.h"
#include "C.h"
#include <math.h>

C::C(void)
{
}

C::C(CPoint a, CPoint b)
{
    this->a=a;
    this->b=b;

    double c1_x = a.x - b.x;
    double c1_y = a.y - b.y;
    c1= sqrt( (c1_x * c1_x) + (c1_y * c1_y));
}

C::~C(void)
{
} 
```

* * *

更新

问题出在我在评论中提供的代码中，我没有注意到我以错误的方式调用数组，如下所示：

```
pDC->MoveTo(someC[i]->a.x, someC->a.y) 
```

所以第二次调用是不正确的。感谢大家的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:11:58.627

除非你的`C`对象复制构造真的很昂贵，否则不要费心实现你的自定义排序算法，而是定义一个严格的总顺序`C`：

```
bool operator<(C const& lhs, C const& rhs) {
  return lhs.c1 < rhs.c1;
} 
```

并[`std::sort`](http://en.cppreference.com/w/cpp/algorithm/sort)在[`std::vector<C>`](http://en.cppreference.com/w/cpp/container/vector). 如果您确实担心复制构造开销，您也可以直接使用[`std::set<C>`](http://en.cppreference.com/w/cpp/container/set)自动排序的 an，**而无需**复制构造。

* * *

编辑后：您的`C`看起来相对较小且易于复制，但它是边界；您最好的选择是同时提供两种方法 (`set`和`vector`) 和基准测试哪一种更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T22:17:34.867

撇开哲学不谈，从您的评论中可以看出这一点（强调添加）：

“我实际上是在这样的 OnDraw 方法中调用 someC：**`pDC->MoveTo(someC[i]->a.x, someC->a.y);`**someC 在头文件中被定义为公共”

具体来说，这在您的参数列表中：

```
someC[i]->a.x, someC->a.y 
```

这告诉我*其中一个是错误的*。从你的错误来看，我会选择第一个。如果我们可以看到正在实现的对象的定义`OnDraw()`以及它的**确切**`someC`来源，它将巩固这一点。

*   如果在您的包含对象中`someC`是 a `C*`，则第二个参数是正确的，第一个参数是错误的。
*   如果`someC`是 C** 在您包含的对象中，则第一个参数是正确的，第二个参数是错误的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:01:54.703

如果您的类型只包含 a`double`我猜**不**使用指针会快得多！如果对象包含 a`std::string`或 a `std::vector<T>`（在一段时间内`T`），图片可能会发生变化，但与移动具有一个或两个基本对象的结构相比，访问或多或少随机分布的数据的成本相当高。当然，要确定具体情况，您需要分析这两种方法。

# java - 在 2.5GHz Intel i7 上每秒增量

> ID：13502554
> 
> 赞同：2
> 
> 时间：2012-11-21T21:47:35.760
> 
> 标签：java, cpu, benchmarking

我正在尝试通过针对一个简单的程序运行一些基准测试工具来测试它们，该程序在 1000 毫秒内尽可能多地递增一个变量。

我应该期望能够在 Mac OS X 的 JDK 上的英特尔 i7 芯片上执行多少个 64 位数字增量？

我目前的方法是：

*   启动线程 (t2)，它在无限循环 (for(;;;)) 中不断增加“i”。
*   让主线程（称为 t1）休眠 1000 毫秒。
*   有 t1 中断（或停止，因为这种不推荐使用的方法适用于 Apple 的 JDK 6） t2。

目前，我可重复地获得大约 2E8 增量（如下表所示：显示的值是在调用线程中的 1000 毫秒 sleep() 后增量线程被中断时打印的值）。

217057470

223302277

212337757

215177075

214785738

213849329

215645992

215651712

215363726

216135710

我怎么知道这个基准测试是否合理，即理论上 i7 芯片应该能够增加单个 64 位数字的最快速度是多少？此代码在 JVM 中运行，如下所示：

```
package net.rudolfcode.jvm;

/**
 * How many instructions can the JVM exeucte in a second?
 * @author jayunit100
 */
public class Example3B {
public static void main(String[] args){
    for(int i =0 ; i < 10 ; i++){
        Thread addThread = createThread();
        runForASecond(addThread,1000);
    }
}

private static Thread createThread() {
    Thread addThread = new Thread(){
        Long i =0L;
        public void run() {
            boolean t=true;
            for (;;) {
                try {
                    i++;
                } 
                catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
        @Override
        public void interrupt() {
            System.out.println(i);
            super.interrupt();
        }

    };
    return addThread;
}

private static void runForASecond(Thread addThread, int milli) {
    addThread.start();
    try{
        Thread.sleep(milli);
    }
    catch(Exception e){

    }
    addThread.interrupt();
    //stop() works on some JVMs...
    addThread.stop();
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:54:23.010

首先要注意 JVM 优化！你必须确保你准确地衡量你认为你做了什么。因为`Long i =0L;`不是`volatile`并且它实际上是无用的（没有对中间值做任何事情）JIT 可以做一些非常讨厌的事情。

至于估计，您可以想到在 X GHz 机器上不超过每秒 X*10^9 次操作。您可以安全地将这个值除以 10 可能是因为指令不是 1:1 映射的。

所以你很接近:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:54:28.960

从理论上讲，做出一些可能无效的假设：

*   假设一个数字可以在 1 条指令中递增（可能不是，因为您在 JVM 中运行而不是本机运行）
*   假设一个 2.5 GHz 处理器每秒可以执行 2,500,000,000 条指令（但实际上比这更复杂）

那么您可以说 1 秒内的 2,500,000,000 增量是基于最简单的粗略估计的“合理”上限。

这与您的测量值相差多远？

*   2,500,000,000 是`O(1,000,000,000)`
*   2E8 是`O(100,000,000)`

所以我们只差了一个数量级。鉴于这些毫无根据的假设——对我来说听起来很合理。

# c# - 如何使用 LINQ 将列表垂直拆分为 n 部分

> ID：13502556
> 
> 赞同：6
> 
> 时间：2012-11-21T21:47:44.923
> 
> 标签：c#, linq, list

我想将列表分成几部分，**但不知道该列表中有多少项目**。这个问题与那些想要将列表拆分为固定大小的块的人不同。

```
int[] a = new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9 }; 
```

我希望将值**垂直拆分**。

分为 2 ：

```
-------------------
| item 1 | item 6 |
| item 2 | item 7 |
| item 3 | item 8 |
| item 4 | item 9 |
| item 5 |        | 
```

分成3个：

```
| item 1 | item 4 | item 7 |
| item 2 | item 5 | item 8 |
| item 3 | item 6 | item 9 | 
```

分成4个：

```
| item 1 | item 4 | item 6 | item 8 |
| item 2 | item 5 | item 7 | item 9 |
| item 3 |        |        |        | 
```

我发现了一些可以做到这一点的 c# 扩展，但它并没有按照我想要的方式分配价值。这是我发现的：

```
// this technic is an horizontal distribution
public static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> list, int parts)
{
    int i = 0;
    var splits = from item in list
                    group item by i++ % parts into part
                    select part.AsEnumerable();
    return splits;
} 
```

结果是这样，但我的问题是值是**水平分布**的：

```
| item 1 | item 2 |
| item 3 | item 4 |
| item 5 | item 6 |
| item 7 | item 8 |
| item 9 |        | 
```

或者

```
| item 1 | item 2 | item 3 |
| item 4 | item 5 | item 6 |
| item 7 | item 8 | item 9 | 
```

知道如何**垂直分配我的值**并有可能选择我想要**的零件数量吗？**

## 在真实生活中

对于那些想知道我想在哪种情况下垂直拆分列表的人，这是我网站一部分的屏幕截图：

![在此处输入图像描述](../Images/7b2ea081be5e5284247f60011e27b3af.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-21T21:52:09.737

使用.Take( [)](http://code.msdn.microsoft.com/LINQ-Partitioning-Operators-c68aaccc#TakeSimple)和[.Skip()](http://code.msdn.microsoft.com/LINQ-Partitioning-Operators-c68aaccc#SkipSimple)您可以：

```
int[] a = new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9 };

int splitIndex = 4; // or (a.Length / 2) to split in the middle.

var list1 = a.Take(splitIndex).ToArray(); // Returns a specified number of contiguous elements from the start of a sequence.
var list2 = a.Skip(splitIndex).ToArray(); // Bypasses a specified number of elements in a sequence and then returns the remaining elements. 
```

如果你`.ToList()`想要`.ToArray()`一个`List<int>`.

* * *

**编辑：**

在您稍微更改（可能澄清）您的问题之后，我想这就是您需要的：

```
public static class Extensions
{
    public static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> source, int parts)
    {
        var list = new List<T>(source);
        int defaultSize = (int)((double)list.Count / (double)parts);
        int offset = list.Count % parts;
        int position = 0;

        for (int i = 0; i < parts; i++)
        {
            int size = defaultSize;
            if (i < offset)
                size++; // Just add one to the size (it's enough).

            yield return list.GetRange(position, size);

            // Set the new position after creating a part list, so that it always start with position zero on the first yield return above.
            position += size;
        }
    }
} 
```

使用它：

```
int[] a = new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9 };
var lists = a.Split(2); 
```

这将产生：

一分为二：`a.Split(2);`

```
| item 1 | item 6 |
| item 2 | item 7 |
| item 3 | item 8 |
| item 4 | item 9 |
| item 5 |        | 
```

一分为三：`a.Split(3);`

```
| item 1 | item 4 | item 7 |
| item 2 | item 5 | item 8 |
| item 3 | item 6 | item 9 | 
```

一分为四：`a.Split(4);`

```
| item 1 | item 4 | item 6 | item 8 |
| item 2 | item 5 | item 7 | item 9 |
| item 3 |        |        |        | 
```

此外，如果您有：

```
int[] b = new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 }; // 10 items 
```

并分成 4 份：`b.Split(4);`

```
| item 1 | item 4 | item 7 | item 9 |
| item 2 | item 5 | item 8 | item 10|
| item 3 | item 6 |        |        | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T23:12:50.193

这似乎很好地解决了这个问题。它可能可以做得更有效，但这已经足够令人费解了......它更容易做到：

```
1|4|7|10
2|5|8
3|6|9 
```

比：

```
1|4|7|9
2|5|8|10
3|6| 
```

我首先忽略了 LINQ 请求，因为我很难理解它。使用普通数组操作的解决方案可能会导致如下结果：

```
 public static IEnumerable<IEnumerable<TListItem>> Split<TListItem>(this IEnumerable<TListItem> items, int parts)
        where TListItem : struct
    {
        var itemsArray = items.ToArray();
        int itemCount = itemsArray.Length;
        int itemsOnlastRow = itemCount - ((itemCount / parts) * parts);
        int numberOfRows = (int)(itemCount / (decimal)parts) + 1;

        for (int row = 0; row < numberOfRows; row++)
        {
            yield return SplitToRow(itemsArray, parts, itemsOnlastRow, numberOfRows, row);
        }
    }

    private static IEnumerable<TListItem> SplitToRow<TListItem>(TListItem[] items, int itemsOnFirstRows, int itemsOnlastRow,
                                                                int numberOfRows, int row)
    {
        for (int column = 0; column < itemsOnFirstRows; column++)
        {
            // Are we on the last row?
            if (row == numberOfRows - 1)
            {
                // Are we within the number of items on that row?
                if (column < itemsOnlastRow)
                {
                    yield return items[(column + 1) * numberOfRows -1];
                }
            }
            else
            {
                int firstblock = itemsOnlastRow * numberOfRows;
                int index;

                // are we in the first block?
                if (column < itemsOnlastRow)
                {
                    index = column*numberOfRows + ((row + 1)%numberOfRows) - 1;
                }
                else
                {
                    index = firstblock + (column - itemsOnlastRow)*(numberOfRows - 1) + ((row + 1)%numberOfRows) - 1;
                }

                yield return
                    items[index];
            }
        }
    } 
```

LINQ 伪代码将是：

```
//WARNING: DOES NOT WORK
public static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> list, int parts)
{
    int itemOnIndex = 0;
    var splits = from item in list
                 group item by MethodToDefineRow(itemOnIndex++) into row
                 select row.AsEnumerable();
    return splits;
} 
```

但是在不知道物品数量的情况下，就无法计算放置它的位置。

因此，通过做一些预先计算，您可以使用 LINQ 来实现与上述相同的事情，这需要通过 IEnumerable 两次，似乎没有办法解决这个问题。诀窍是计算每个值将分配到的行。

```
 //WARNING: Iterates the IEnumerable twice
    public static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> list, int parts)
    {
        int itemOnIndex = 0;
        int itemCount = list.Count();
        int itemsOnlastRow = itemCount - ((itemCount / parts) * parts);
        int numberOfRows = (int)(itemCount / (decimal)parts) + 1;
        int firstblock = (numberOfRows*itemsOnlastRow);

        var splits = from item in list
                     group item by (itemOnIndex++ < firstblock) ? ((itemOnIndex -1) % numberOfRows) : ((itemOnIndex - 1 - firstblock) % (numberOfRows - 1)) into row
                     orderby row.Key
                     select row.AsEnumerable();
        return splits;
    } 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-21T21:57:57.663

用于`.Take(#OfElements)`指定要采用的元素数量。

您还可以使用`.First`和`.Last`

# .htaccess - .htaccess | 添加第二个虚 URL

> ID：13502557
> 
> 赞同：0
> 
> 时间：2012-11-21T21:47:48.973
> 
> 标签：.htaccess

我想获取我的 .htaccess 文件并为另一个虚 URL 添加第二条规则，因为我已经有一个声明该页面的规则。那么我将如何编写它以便我可以访问我的页面，而下一个虚荣心是个人资料的变量？

```
Ex:// mywebsite.com/page/profile 
```

这是我当前的 .htaccess 文件。

```
RewriteEngine On

RewriteBase /

RewriteRule ^([a-zA-Z0-9-]+)$ index.php?p=$1 [L]

RewriteRule ^([a-zA-Z0-9-]+)/$ index.php?p=$1 [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:54:33.097

让我们举个例子。

您当前的网址是`http://domain.com/myurl`，`http://domain.com/index.php?p=myurl` 您可以使用这种 htaccess 为该页面添加虚荣网址：

```
RewriteEngine On
RewriteBase /
RewriteRule ^myvanityurl/?$ myurl [L,R=301]
RewriteRule ^([a-zA-Z0-9-]+)/?$ index.php?p=$1 [L] 
```

然后，`http://domain.com/myvanityurl`将重定向到`http://domain.com/myurl`

如果您希望此重定向是透明的（也就是保留`myvanityurl`在 url 栏中），请`R=301`从规则中删除标记。

* * *

**编辑**

编辑后，这就是您要搜索的内容：

```
RewriteEngine On
RewriteBase /
RewriteRule ^([a-zA-Z0-9-]+)/([a-zA-Z0-9-]+)$ index.php?p=$1&profile=$2 [L]
RewriteRule ^([a-zA-Z0-9-]+)/([a-zA-Z0-9-]+)/$ index.php?p=$1&profile=$2 [L] 
```

然后，`http://domain.com/edit/756`将重定向到`http://domain.com/index.php?p=edit&profile=756`

此代码可以通过以下方式简化：

```
RewriteEngine On
RewriteBase /
RewriteRule ^([\w-]+)/([\w-]+)/?$ index.php?p=$1&profile=$2 [L] 
```

# regex - 使用正则表达式排除术语

> ID：13502559
> 
> 赞同：1
> 
> 时间：2012-11-21T21:47:54.003
> 
> 标签：regex, perl, nagios

我正在使用名为“check_logfiles”的nagios 检查来解析一堆solaris 机器上的syslog。它完全用 Perl 编写，并采用同样使用 Perl 语法的配置文件。我正在尝试使用正则表达式从检查的输出中排除以下行：

```
Nov 16 19:15:04 db07  Cluster.CCR: [ID 574345 daemon.debug] server address: 127.0.0.1 
```

这是我尝试使用的正则表达式（不成功）

```
'^.*?(Cluster.CCR).*?$' 
```

这是检查的整个配置文件，以防您可能需要一些上下文：

```
$options = 'report=long';
@searches = (
{
tag => 'syslog',
logfile => '/var/adm/messages',
rotation => 'SOLARIS',
options => 'noprotocol',
sticky  => 2400,
criticalpatterns => [
   'daemon.debug',
   'daemon.error',
   'Could not send report: Broken pipe',
   'Could not retrieve catalog from remote server: Error 400 on SERVER'
],
warningpatterns => [
    'daemon.warning',
    'daemon.info',
    'daemon.notice',
    'kern',
],
criticalexceptions => [
 'connect from nagioszone01.mydomain.com',
 'from 10.20.28.140',
 'Finished catalog run in',
 'Did not receive identification string from',
 '^.*?(Cluster.CCR).*?$'
],
 warningexceptions => [
 'connect from nagioszone01.mydomain.com',
 'from 10.20.28.140',
 'Finished catalog run in',
 'Did not receive identification string from',
 'Cluster.CCR'
],
 options => 'logfilenocry,sticky=900',
}); 
```

感谢您可能需要分享的任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T10:37:31.877

我不知道你是否解决了它，但我建议使用 WOTS 来完成这项任务。我维护并扩展了原始的 WOTS，并将其完全用于此类设置。如果您想向 nagios 发送被动警报，它是一个集成了 nsca 客户端的 perl 守护程序。包括大量的例子。对于 WOTS：[http ://www.e-dynamics.be/?section=programs](http://www.e-dynamics.be/?section=programs)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-21T22:52:01.590

正则表达式不提供任何排除“单词”的可能性 - 所以你需要使用一个workarround

想象一下，你想匹配一个 div 中的“所有东西”，但不是，如果里面有“花”这个词（你不喜欢花，所以你不想匹配那个。）

匹配 div 标签之间的所有内容：

```
/<div>([^<]+?)<\/div>/ 
```

不是杰作。

我们“不能”排除单词——但我们可以排除一个字符后跟一个短语。所以我们排除任何 char 后跟“lower”：

```
/<div>([^<](?!lower))+?)<\/div>/ 
```

这也不匹配带有其他单词（“Glower”“Alower”）的文本......

所以我们需要用另一个“lookbehind”来“修改”我们的“lookahead”：

```
/<div>((?:[^<](?!(?<=F)lower))+?)<\/div>/ 
```

在您的情况下，您可以使用`^`and`$`代替 div 标签并选择一些不应该在匹配值内的随机单词。

```
<div>((?:[^<](?!(?<=F)lower))+?)<\/div> 
```

![正则表达式可视化](../Images/b5cb7036469244cce58ce991c6c4b3e6.png)

[调试演示](https://www.debuggex.com/r/ZFaE3fQjGYmW4idr)

（但是，如果你想排除整行——为什么要使用正则表达式？）

# php - 我可以“鼓励”PHP 引擎更自由地使用 CPU 吗？

> ID：13502563
> 
> 赞同：-2
> 
> 时间：2012-11-21T21:48:01.280
> 
> 标签：php, performance, cpu

我可以“鼓励”PHP 引擎更自由地使用 CPU 吗？是的。只是。那可能吗？我的问题是，当我查看 CPU 使用率时，它几乎为 0，不受服务器的影响，即使存在像`Maximum execution time of 30 seconds exceeded`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:51:32.483

你很可能在等待*其他东西，*比如磁盘 I/O、数据库查询等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:52:29.827

任何 PHP 脚本都会尽可能多地占用 CPU 时间；大多数情况下，大多数应用程序也是如此。

如果您的 PHP 脚本运行时您的 CPU 使用率（或至少一个核心）不是 100%，则意味着有其他因素阻止它这样做。在大多数情况下，这是 IO（内存、磁盘、网络）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:52:57.267

我不认为你可以以你想要的方式影响 PHP 的 CPU 使用 - 它会尽可能多地使用操作系统允许它。在内部，您可以编辑这些 php.ini 参数以帮助管理性能：

max_execution_time = 30
max_input_time = 30
memory_limit = 40M
post_max_size = 8M
upload_max_filesize = 2M

# c - 在c中同步客户端和服务器程序之间的时钟

> ID：13502564
> 
> 赞同：0
> 
> 时间：2012-11-21T21:48:03.010
> 
> 标签：c, synchronization, client-server, ntp

我正在做一个服务器解析音频文件的项目，然后告诉客户端根据服务器的公共时钟播放某些音频部分。理论上，我们需要高水平的同步，因为客户端节点可能会在彼此旁边播放音频，除了最小的延迟之外，所有延迟都可能产生人耳可察觉的声音偏移。我一直在尝试查找如何解决此问题的 c 代码示例，但运气不佳。

我已经阅读了许多关于时钟同步的维基百科文章。

[http://en.wikipedia.org/wiki/Clock_synchronization](http://en.wikipedia.org/wiki/Clock_synchronization)

上述文章让我相信 PTP 将是我们在本地网络上实施的理想选择。但理想情况下，我们希望扩展我们的项目以允许通过互联网连接。这让我相信 NTP 会更好。我访问了 NTP.org，但发现它很难理解，而且如果我的应用程序位于未连接到 Internet 的本地网络上，我似乎根本无法使用 NTP。但后来我发现了这个帖子：

[无需 NTP 的小尺寸时钟同步](https://stackoverflow.com/questions/5642946/small-footprint-clock-synchronization-without-ntp)

赛斯·罗伯逊的回答让我相信我错了。

*您可以使用几行配置文件（每个客户端四行，服务器五行）来同步到所选系统的时钟。*

问题是，他没有展示那些代码行，也没有给我指出一个我可以查看处理这些问题的代码的地方。

我一直在查看stackoverflow，发现了许多类似的问题，但没有一个给出令人满意的答案。

所以，在一堵文字墙之后（对不起，堆栈溢出问题建议说得很具体，并解释了我在提问之前所做的研究），我想简洁地陈述我的问题，希望有人可以帮助我出去：

*在客户端/服务器软件模型中，如何在软件中保持准确的时钟同步以允许基于时间执行事件？*

目前我们小组正在使用 UDP，但如有必要，我们愿意进行更改。

谢谢你的帮助。

编辑：我知道我需要保持时钟同步，问题是，我如何在软件中做到这一点。我正在寻找示例代码或指向可以找到有关此主题的示例代码的位置的超链接。结束编辑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:52:52.943

概念很明确：在你的网络中选择一台主机作为NTP服务器，让其他主机与这台服务器同步。

如果您的需要只是局域网主机之间的同步，这应该可以。

许多系统都可以免费使用 NTP 服务器和客户端。

# regex - 如何在不分组的情况下获得列表匹配？

> ID：13502565
> 
> 赞同：-1
> 
> 时间：2012-11-21T21:48:05.017
> 
> 标签：regex, perl

在 perl 中，以下似乎返回匹配列表**和匹配分组！**

```
//g 
```

规则：

> 在列表上下文中，`//g`返回匹配分组的列表，或者如果没有分组，则返回整个正则表达式的匹配列表

如何获得没有分组的匹配列表？

**更新：**

在 perl 中，正则表达式似乎返回所有与正则表达式部分`()`匹配的内容，以及与整个术语匹配的内容。

出于分组（而不是捕获）目的，例如编写匹配“猫”或“狗”使用`(?:cat|dog)`.
使用`(cat|dog)`and not`(?:cat|dog)`会将任何出现的“cat”或“dog”添加到结果列表中。

**匹配括号： ( )**

```
"badcat and baddog" =~ /bad(cat|dog)/g 
```

结果：`(badcat baddog cat dog)`
单个`cat`并被`dog`添加到结果列表中，因为它们包含在**匹配的括号中**

**不匹配的括号： (?: )**

```
 "badcat and baddog" =~ /bad(?:cat|dog)/g 
```

结果是：`(badcat baddog)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:43:07.847

如果您有一个可能包含分组的正则表达式，但您只想匹配整个正则表达式，请执行以下操作：

```
my $regex = qr/some regex (with) (groupings)/;
my @matches;
while ($string =~ m/($regex)/g) { push(@matches, $1) } 
```

`while`循环内部`$1`保证是`$regex`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T09:23:44.707

如果您需要用于其他目的的括号，您可以使用非捕获的，`(?: ... )`

# html - 将输入字段的宽度设置为原始内容的宽度（使用 CSS）

> ID：13502569
> 
> 赞同：0
> 
> 时间：2012-11-21T21:48:49.857
> 
> 标签：html, css

我正在尝试实现以下功能：具有多行的网页，例如 `Type.classname=com.long.qualified.class.Name`，其中该行对应于 Java 属性文件中的一个条目。每个这样的行都引用一个名为 (contextRoot)/.../path/.../Name.java 的文件。

我希望能够轻松复制文件名，因此我可以（在 Eclipse 中）找到该属性引用的源文件。所以，我正在制作包名 a`<label>`和类名 an `<input>`，并将它们与 a 连接起来`for`。然后我`onfocus`在类名中添加了一个，我在其中添加了`this.select()`. 我还添加了样式以使文本字段看起来不像文本字段，即字体、边框：无、只读（不是 CSS）。

我的第一个问题是：如何将文本字段的宽度设置为其*原始*内容的全宽。其他问题有关于动态调整宽度的答案——这对我来说不是问题。可以用 CSS 完成，还是我必须使用 javascript。有超过 1000 行这样的行，我宁愿不要使用比我需要的更多的脚本。

我的第二个问题是：我是在艰难地做这些事情，还有更简单的方法来实现我的目标，还是其他人都会这样做？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:23:34.877

您可以使用 box-sizing 属性来实现您想要的。

[http://jsfiddle.net/AjtCR/](http://jsfiddle.net/AjtCR/)

以下是它兼容的浏览器：[http ://caniuse.com/#search=box-sizing](http://caniuse.com/#search=box-sizing)

```
​&lt;div>
 <input type="text" />
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​

​div {
 width:200px;
 height:200px;
 background:#999;
 padding-top:50px;
}

input {
 -webkit-box-sizing: border-box;
 -moz-box-sizing: border-box;
 box-sizing: border-box;
 width:100%;
 padding:5px;
 border:1px solid #000;
} 
```

# c# - InvalidArgument=“4”的值对“索引”无效

> ID：13502570
> 
> 赞同：0
> 
> 时间：2012-11-21T21:48:52.353
> 
> 标签：c#, listview

我正在尝试替换我的 listView 的第 5 列的文本，但每次我尝试这样做时，我都会收到此错误：`InvalidArgument=Value of '4' is not valid for 'index'.`

我正在尝试替换第 5 列下没有文本的任何项目，基本上是那些空白的项目。

这是我的代码：

```
foreach (ListViewItem i in listView1.Items)
{
    if (i.SubItems[4].Text == " ")
    {
        i.SubItems[4].Text = i.SubItems[4].Text.Replace(" ", "No");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T03:05:32.500

我相当确定子项从第二列开始，其中第一列是列表视图项的值。所以第 5 列`SubItem[3]`不是第 4 列。

# ruby - “或”运算符必须放在上一行的末尾？（意外的 TOROP）

> ID：13502578
> 
> 赞同：10
> 
> 时间：2012-11-21T21:49:41.003
> 
> 标签：ruby, syntax, syntax-error

我正在运行 Ruby 1.9。

这是一个有效的语法：

```
items = (data['DELETE'] || data['delete'] ||
         data['GET'] || data['get'] || data['POST'] || data['post']) 
```

但这给了我一个错误：

```
items = (data['DELETE'] || data['delete']
         || data['GET'] || data['get'] || data['POST'] || data['post'])

t.rb:8: syntax error, unexpected tOROP, expecting ')'
         || data['GET'] || data['get'] |...
           ^ 
```

为什么？！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T22:03:14.090

我能说的是*“这就是它的工作原理”。*

一般来说，Ruby 解析器在确定表达式何时需要在另一行继续执行方面做得非常出色。世界上几乎所有其他语言都完全解决了这个问题，并且需要一个实际字符才能继续下一行或终止语句。

如您所知，Ruby 的特别之处在于，几乎总是，它只是计算出来的。

但是，在这种情况下，存在冲突。解析器知道您的表达式尚未完成，因为它仍在寻找`)`，但它可能是一个复合表达式。

例如，您可以编写如下内容：

```
(p :a; p :b; p :c) 
```

...但是使用换行符软终止符而不是`;`... 下面的语法确实有效：

```
(p :a
 p :b
 p :c) 
```

（顺便说一句，该表达式的值是序列中最后一个表达式的值。）

如果没有更好的提示（例如显然需要另一行的二元运算符），Ruby 无法同时解析您的语句和上述语句。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T22:02:32.850

Ruby 将行尾解释为语句的结尾。运算符表示语句的继续。

您也可以使用反斜杠`\`来表示继续，因此以下内容将起作用

```
items = (data['DELETE'] || data['delete'] \
     || data['GET'] || data['get'] || data['POST'] || data['post']) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T22:03:50.330

由于 ruby​​ 是面向行的，以运算符结尾的语句被解释为不完整的。在运算符后添加反斜杠将允许正确解释多行语句。（来源： http: [//phrogz.net/ProgrammingRuby/language.html](http://phrogz.net/ProgrammingRuby/language.html)）

# mysql - 我怎样才能在 MySQL 中获得最后 10 周？

> ID：13502586
> 
> 赞同：0
> 
> 时间：2012-11-21T21:50:13.730
> 
> 标签：mysql, count

```
SELECT WEEK( `date_posted` ) AS week, COUNT( 1 ) AS aantal
FROM `news`
GROUP BY week
ORDER BY week DESC
LIMIT 0 , 10 
```

这不起作用。输出是：

```
 week  aantal
    52  41
    51  56
    50  49
    49  56
    48  62 
```

但是，我们还没有到第 52 周。怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:55:37.253

我认为您需要一个`WHERE`子句：

```
SELECT WEEK( `date_posted` ) AS week, COUNT( 1 ) AS aantal
FROM `news` 
WHERE `date_posted` >= (curdate() - interval 10 week)
GROUP BY week
ORDER BY week DESC
LIMIT 0 , 10 
```

# c# - 将页面中的 mainWindow 方法调用到框架中

> ID：13502589
> 
> 赞同：0
> 
> 时间：2012-11-21T21:50:26.723
> 
> 标签：c#, .net, wpf

我有一个带有组合框数据的主窗口。在窗口中，我有一个带有页面的框架，我需要刷新组合框中的数据（我有一个方法可以做到这一点）如何从页面调用该方法？

在我的主窗口中

```
 public  void getCustomers()
    {
        cb_Name.ItemsSource = ve.Folders;
        cb_Name.DisplayMemberPath = "Full_Name";
        cb_Name.SelectedValuePath = "Folder_Id";
        cb_Name.SelectedIndex = 0;
    } 
```

在我的页面

```
 private void btn_insert_person_Click(object sender, RoutedEventArgs e)
    {

     } 
```

也许现在更清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:02:15.337

假设您在主窗口类中有一个方法：

```
public void RefreshComboBox(); 
```

当您创建新框架时，您可以将“方法指针”传递给它。

假设您当前正在像这样初始化框架：

```
var frame = new Frame(); 
```

您可以将其构造函数更改为：

```
public Frame(Action refreshComboBox) 
```

并像这样初始化框架：

```
var frame = new Frame(RefreshComboBox); 
```

在 Frame 类中保存对“方法指针”的引用，并在需要时调用它。

有关此处操作委托的更多信息：http: [//msdn.microsoft.com/en-us/library/system.action.aspx](http://msdn.microsoft.com/en-us/library/system.action.aspx)

# django - Django处理表单的方式？

> ID：13502594
> 
> 赞同：2
> 
> 时间：2012-11-21T21:50:43.697
> 
> 标签：django, twitter-bootstrap, django-forms, django-crispy-forms

我正在将一个项目放在一起，并尝试尽可能多地利用开源库，以最大限度地减少完成工作所涉及的“打字”。我正在使用 django、crispy-forms 和引导框架。

我编写了用于处理一个实体（添加/编辑/删除）的代码，并且感觉我一定做错了什么，因为似乎涉及的代码太多 - 有 20 多个不同的项目将以几乎相同的方式进行管理所以我想在我开始完成其余代码之前，我会询问社区我可以修复的错误。

所以我有一个模型：

```
class Link(models.Model):
    name = models.CharField(max_length=255, blank=False, null=False, verbose_name=_(u'Название'))
    url = models.URLField(blank=False, null=False, verbose_name=_(u'Ссылка'))
    project = models.ForeignKey('Project')
    display_on_main_project_page = models.BooleanField(default=False, verbose_name=_(u'Показывать ссылку на главной странице проекта'))

    class Meta:
        app_label = 'core'
        verbose_name = _(u'Ссылка')
        verbose_name_plural = _(u'Ссылки')

    def __unicode__(self):
        return self.name 
```

并按照手册添加了一个带有脆片的表格：

```
class ProjectLinkForm(forms.Form):
    id = forms.IntegerField(required=False, widget=forms.HiddenInput())
    project = forms.ModelChoiceField(queryset=Project.objects.all(),required=True, widget=forms.HiddenInput())
    name = forms.CharField(required=True, label=_(u'Имя ссылки'))
    url = forms.URLField(required=True, label=_(u'URL ссылки'))
    display_on_main_project_page = forms.BooleanField(label=_(u'Показывать на главной странице проекта'), required=False)

    class Meta:
        model = Link
        fields = ('project','name','url','display_on_main_project_page')

    def __init__(self, *args, **kwargs):
        self.helper = FormHelper()
        self.helper.form_class = 'horizontal-form'
        self.helper.form_action = ''
        self.helper.form_id = 'link_form'
        self.helper.layout = Layout(
            Field('name',css_class='input-block-level'),
            Field('url', css_class='input-block-level')
        )
        super(ProjectLinkForm, self).__init__(*args, **kwargs) 
```

和配置为提供操作的 url：

```
url(r'^forms/link/add/(?P<project_id>\d+)/$','core.views.forms.link.add'),
url(r'^forms/link/edit/(?P<link_id>\d+)/$','core.views.forms.link.edit'),
url(r'^forms/link/delete/(?P<link_id>\d+)/$','core.views.forms.link.delete'), 
```

以及视图（以add为例）：

```
@login_required
def add(request, project_id):
    if request.method == 'GET':
        form = ProjectLinkForm(initial={'project':project_id})
        form.action = 'add'
        form.submit_url = request.path
        return render_to_response('core/forms/project_link.html',{'form':form,'links_form_title':_(u'Добавить ссылку')},context_instance=RequestContext(request))
    elif request.method == 'POST':
        form = ProjectLinkForm(request.POST)
        form.action = 'add'
        form.submit_url = request.path
        if form.is_valid():
            try:
                new_link = Link()
                new_link.name = form.cleaned_data['name']
                new_link.url = form.cleaned_data['url']
                new_link.project = form.cleaned_data['project']
                new_link.display_on_main_project_page = form.cleaned_data['display_on_main_project_page']
                new_link.save()
                return HttpResponse(status=http_statuses.SAVED, content="saved")
            except Exception as e:
                return HttpResponse(status=http_statuses.SERVER_ERROR, content=e.message)
        else:
            return render_to_response('core/forms/project_link.html',{'form':form,'links_form_title':_(u'Добавить ссылку')},context_instance=RequestContext(request))

    #not POST or GET
    else:
        return HttpResponse(status=http_statuses.METHOD_NOT_ALLOWED,content=_(u'Недопустимый тип запроса')) 
```

所有操作都使用一个模板：

```
{% load crispy_forms_tags %}
<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3>{{ links_form_title|default:"Ссылки на проект" }}</h3>
</div>
<div class="modal-body">
    <p>
        {% if form.action == "delete" %}
            Уверены, что хотите удалить ссылку "{{ form.name.value }}"? Одно неосторожное движенье мышкой и все - не вернешь!
            <div class="hide">
                {% crispy form %}
            </div>
        {% else %}
            {% crispy form %}
        {% endif %}
    </p>
</div>
<div class="modal-footer">
    {% if form.action == "delete" %}
        <a href="#" class="btn btn-danger" id="" onclick='SubmitModalForm($("#link_form"),"{{ form.submit_url }}")'>Удалить</a>
    {% else %}
    <a href="#" class="btn btn-primary" id="" onclick='SubmitModalForm($("#link_form"),"{{ form.submit_url }}")'>Сохранить</a>
    {% endif %}
</div> 
```

和一些 JavaScript 代码来处理所有带有表单的弹出窗口：

```
function LoadModalForm(url){
        $("#dynamic_project_forms").html("").load(url).modal();
    }

    function SubmitModalForm(the_form,submit_url){
        $.ajax({
            type:'POST',
            url:submit_url,
            data: $(the_form).serialize(),
            complete: function(e, xhr, settings){
                if(e.status == 201){//HTTP.STATUS.SAVED
                    $("#dynamic_project_forms").modal('hide');
                    $(activeTab.hash).load('/api/get_project_tab/'+activeTab.hash.replace('#','')+'/{{ project.id }}/');
                }
                else{
                    $("#dynamic_project_forms").html(e.responseText);
                    alert('loaded fucking response');
                }
            }
        });
    } 
```

它确实有效，但打字太多 - 我想我错过了一些东西或者只是没有得到正确的东西 - 请就正确的方法提出建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T23:28:11.537

您可以轻松摆脱一半的代码。

您错过了[模型表单](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/)和[通用视图](https://docs.djangoproject.com/en/dev/ref/class-based-views/generic-editing/)。

你可以有这样的网址：

```
from django.views import generic

urlpatterns = patterns('test_app.views',
    url(r'link/create/$', generic.CreateView.as_view(model=Link),
        name='link_create'),
    url(r'link/(?P<pk>\d+)/update/$', generic.UpdateView.as_view(model=Link),
        name='link_update'),
    url(r'link/(?P<pk>\d+)/delete/$', generic.DeleteView.as_view(model=Link),
        name='link_delete'),

    # bonus:
    url(r'link/$', generic.ListView.as_view(model=Link), name='link_list'),
    url(r'link/(?P<pk>\d+)/$', generic.DetailView.as_view(model=Link),
        name='link_detail'),
) 
```

但默认情况下它不像您那样支持 AJAX - 但是您可以扩展`CreateView` `UpdateView`并`DeleteView`执行支持您的 javascript 所需的小覆盖。例如，我在一个项目中有这个：

```
class AjaxDeleteView(generic.DeleteView):
    # now that I think of it, this could just be a DetailView ... oh well
    http_method_names = ['post']

    def post(self, *args, **kwargs):
        self.get_object().delete()
        return http.HttpResponse('', status=204)

class AjaxFormMixin(object):
    def form_valid(self, form):
        if form.instance.pk:
            status = 204
        else:
            status = 201

        self.object = form.save()
        return http.HttpResponse(self.object.pk, status=status) 
```

扩展 Django 通用视图的其他一些示例：

```
class PkUrlKwarg(SingleObjectMixin):
    """
    Take the pk from request.GET and sets it to kwargs, useful to avoid
    reversing urls from javascript
    """
    def get_object(self, queryset=None):
        self.kwargs[self.pk_url_kwarg] = self.request.REQUEST['pk']
        return super(PkUrlKwarg, self).get_object(queryset)

class WidgetFormMixin(object):
    def get_form(self, form_class):
        # [snip] ok there's quite a lot (11 SLOCs) going on here in my case, since Widget* views are
        # supposed to deal with any subclass of Widget
        return self.object.configuration_form_instance(self.request)

    def get_template_names(self):
        widget_name = self.object.__class__.__name__

        return [
            'form_designer/widget_forms/%s.html' % widget_name,
            'form_designer/widget_form.html',
        ]

class WidgetSecurity(object):
    """
    Return a queryset of Widget that have a tab in a form which author is
    request.user.  For security.
    """
    def get_queryset(self):
        return Widget.objects.filter(tab__form__author=self.request.user) 
```

最后，我的 CRUD 视图有很多非默认和或多或少复杂的逻辑，但仍然只有很少的代码行：

```
class WidgetCreateView(WidgetFormMixin, AjaxFormMixin, generic.CreateView):
    form_class = WidgetForm  # overridden by WidgetFormMixin.get_form, but make django happy

class WidgetUpdateView(PkUrlKwarg, WidgetSecurity, WidgetFormMixin, AjaxFormMixin, generic.UpdateView):
    form_class = WidgetForm  # overridden by WidgetFormMixin.get_form

class WidgetDeleteView(PkUrlKwarg, WidgetSecurity, AjaxDeleteView):
    pass 
```

这可能不是最好的答案，但它应该明确地让你走上正确的轨道，并激励你。

另请注意，您还应该在模型中定义[get_absolute_url()](https://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs#get-absolute-url)。

为了记录，网址：

```
url(r'widget/create/$',
    login_required(WidgetCreateView.as_view()),
    name='form_designer_widget_create'),
# the following views accept 'pk' as URL/GET argument
# this avoids reversing urls from javascript at the cost of a 4-liner mixin
url(r'widget/update/$',
    login_required(WidgetUpdateView.as_view()),
    name='form_designer_widget_update'),
url(r'widget/delete/$',
    login_required(WidgetDeleteView.as_view()),
    name='form_designer_widget_delete'), 
```

# nosql - 使用 Jetty 8 防止节点会话超时并通过 MongoDB 复制会话

> ID：13502596
> 
> 赞同：0
> 
> 时间：2012-11-21T21:50:50.657
> 
> 标签：nosql, jetty, session-timeout, session-replication

我正在使用 Jetty 8，目前有两个实例设置并在循环负载均衡器后面运行。我已将其配置为通过 MongoDB 使用会话复制。它工作得很好，有两个例外。我将在这里包括一个，另一个在另一个问题中。

1.  当另一个节点上的同一会话超时时，可以使其中一个节点上的会话保持活动状态。一旦您点击超时节点，行为就好像会话已过期，即使存在来自另一个节点上的用户的活动。

有没有人有什么建议？我即将开始深入研究 jetty-nosql 的实现，但如果有人可以为我节省一些时间，我会很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:28:29.183

事实证明，上述行为是由于 nosqlSession 管理器中的错误造成的。从数据库读取会话时，它不会更新上次访问时间。因此，如果在会话超时期限内未访问节点，则无论是否访问了任何其他节点，都会使会话无效。我已提交此错误报告： [https ://bugs.eclipse.org/bugs/show_bug.cgi?id=397193](https://bugs.eclipse.org/bugs/show_bug.cgi?id=397193)

我们通过对错误中指示的文件进行自定义修改来修复它，以便在从数据库刷新会话时使用存储在数据库中的访问时间更新会话的访问时间。

# ruby-on-rails - 非类对象（宝石）的 Rails 类方法替代方案

> ID：13502597
> 
> 赞同：0
> 
> 时间：2012-11-21T21:50:50.953
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gem

我正在使用[日历宝石](https://github.com/austinthecoder/cal)`Events`在我的一类中生成基本日历。

在我的应用程序助手中，我创建了一个助手方法来调用它：

```
def calendar
  @calendar ||= Cal::MonthlyCalendar.from_params params[:month], start_week_on: :sunday
end 
```

日历以默认方式通过天和周循环正常工作以创建月历，但我想创建一个仅显示当前周和下一周的日历。目前，我正在通过`if`视图中的一个重要声明来做到这一点：

```
...
<% calendar.weeks.each do |week| %>
  <tr>
    <% week.each do |day| %>
      <% if day.number >= Date.today.beginning_of_week(start_day = :sunday).day && day.date.month == Date.today.month %>
... 
```

如您所见，这不是很合适。有没有办法为此创建一个“类方法”或“范围”，即使它本身不是一个对象？显然，上面没有显示之前或未来的几个月，这意味着它必须更加冗长才能工作，所以我正在寻找一个更优雅的解决方案。但是，我将把方法放在哪里？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T03:14:49.650

我最终创建了自己的方法来生成比 gem 更好的日历。对于那些偶然发现这个问题并寻找答案的人，我建议将第三方 gem 放入模型类（如果可能的话），然后以这种方式定义范围。但就我的目的而言，我只需要一个非常基本的日历功能，所以我只是使用一些内置的 Rails 功能创建了一些基本上循环几天的方法。

# r - 在 data.frame 的两列之间添加（插入）一列

> ID：13502601
> 
> 赞同：110
> 
> 时间：2012-11-21T21:51:12.773
> 
> 标签：r, dataframe, insert

我有一个包含 a、b 和 c 列的数据框。我想在 b 和 c 之间添加一个新的 d 列。

我知道我可以使用*cbind*在最后添加 d但如何**将**它插入两列之间？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2016-11-24T14:46:28.750

我建议您使用包中的`add_column()`功能[`tibble`](https://cran.r-project.org/web/packages/tibble/index.html)。

```
library(tibble)
dataset <- data.frame(a = 1:5, b = 2:6, c=3:7)
add_column(dataset, d = 4:8, .after = 2) 
```

请注意，您可以使用列名而不是列索引：

```
add_column(dataset, d = 4:8, .after = "b") 
```

或者使用参数`.before`而不是`.after`如果更方便。

```
add_column(dataset, d = 4:8, .before = "c") 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-07-11T02:14:16.940

在您的新列中添加：

```
df$d <- list/data 
```

然后你可以重新排序它们。

```
df <- df[, c("a", "b", "d", "c")] 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-11-21T22:03:48.610

您可以使用 [ 重新排序列，或按您想要的顺序显示列。

```
d <- data.frame(a=1:4, b=5:8, c=9:12)
target <- which(names(d) == 'b')[1]
cbind(d[,1:target,drop=F], data.frame(d=12:15), d[,(target+1):length(d),drop=F])

  a b  d  c
1 1 5 12  9
2 2 6 13 10
3 3 7 14 11
4 4 8 15 12 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-11-21T22:08:33.787

假设`c`总是紧随其后，无论您的data.frame中的哪个位置`b`，此代码都会在之后添加一列。`b``b`

```
> test <- data.frame(a=1,b=1,c=1)
> test
  a b c
1 1 1 1

> bspot <- which(names(test)=="b")

> data.frame(test[1:bspot],d=2,test[(bspot+1):ncol(test)])
  a b d c
1 1 1 2 1 
```

或者可能更自然：

```
data.frame(append(test, list(d=2), after=match("b", names(test)))) 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-08-15T14:16:08.533

创建一个示例 data.frame 并向其中添加一列。

```
df = data.frame(a = seq(1, 3), b = seq(4,6), c = seq(7,9))
df['d'] <- seq(10,12)
df

  a b c  d
1 1 4 7 10
2 2 5 8 11
3 3 6 9 12 
```

按列索引重新排列

```
df[, colnames(df)[c(1:2,4,3)]] 
```

或按列名

```
df[, c('a', 'b', 'd', 'c')] 
```

结果是

```
 a b  d c
1 1 4 10 7
2 2 5 11 8
3 3 6 12 9 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-07-11T02:57:08.897

您想将 z 列添加到由 x 和 y 列定义的旧数据框 (old.df)。

```
z = rbinom(1000, 5, 0.25)
old.df <- data.frame(x = c(1:1000), y = rnorm(1:1000))
head(old.df) 
```

定义一个名为 new.df 的新数据框

```
new.df <- data.frame(x = old.df[,1], z, y = old.df[,2])
head(new.df) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-03-11T18:20:48.637

这是在数据框的特定位置插入列的一种快速而肮脏的方法。就我而言，我在原始数据框中有 5 列：我将在和之间`c1, c2, c3, c4, c5`插入一个新列。`c2b``c2``c3`

1）让我们首先创建测试数据框：

```
> dataset <- data.frame(c1 = 1:5, c2 = 2:6, c3=3:7, c4=4:8, c5=5:9)
> dataset
  c1 c2 c3 c4 c5
1  1  2  3  4  5
2  2  3  4  5  6
3  3  4  5  6  7
4  4  5  6  7  8
5  5  6  7  8  9 
```

`c2b`2）在我们的数据框末尾添加新列：

```
> dataset$c2b <- 10:14
> dataset
  c1 c2 c3 c4 c5 c2b
1  1  2  3  4  5  10
2  2  3  4  5  6  11
3  3  4  5  6  7  12
4  4  5  6  7  8  13
5  5  6  7  8  9  14 
```

3）根据列索引对数据框重新排序。就我而言，我想在现有的第 2 列和第 3 列之间插入新列 (6)。我通过使用`c(1:2, 6, 3:5)`相当于`c(1, 2, 6, 3, 4, 5)`.

```
> dataset <- dataset[,c(1:2, 6, 3:5)]
> dataset
  c1 c2 c2b c3 c4 c5
1  1  2  10  3  4  5
2  2  3  11  4  5  6
3  3  4  12  5  6  7
4  4  5  13  6  7  8
5  5  6  14  7  8  9 
```

那里！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-07-10T11:47:06.207

轻松解决。在具有 5 列的数据框中，如果要在 3 到 4 之间插入另一列...

```
tmp <- data[, 1:3]
tmp$example <- NA # or any value.
data <- cbind(tmp, data[, 4:5] 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-01-11T18:41:19.830

为了它的价值，我写了一个函数来做到这一点：

[已删除]

* * *

我现在已经用`before`和功能更新了这个函数`after`，默认`place`为 1。它还具有数据表兼容性：

```
#####
# FUNCTION: InsertDFCol(colName, colData, data, place = 1, before, after)
# DESCRIPTION: Takes in a data, a vector of data, a name for that vector and a place to insert this vector into
# the data frame as a new column. If you put place = 3, the new column will be in the 3rd position and push the current
# 3rd column up one (and each subsuquent column up one). All arguments must be set. Adding a before and after
# argument that will allow the user to say where to add the new column, before or after a particular column.
# Please note that if before or after is input, it WILL override the place argument if place is given as well. Also, place
# defaults to adding the new column to the front.
#####

InsertDFCol <- function(colName, colData, data, place = 1, before, after) {

  # A check on the place argument.
  if (length(names(data)) < place) stop("The place argument exceeds the number of columns in the data for the InsertDFCol function. Please check your place number")
  if (place <= 0 & (!missing(before) | !(missing(after)))) stop("You cannot put a column into the 0th or less than 0th position. Check your place argument.")
  if (place %% 1 != 0 & (!missing(before) | !(missing(after)))) stop("Your place value was not an integer.")
  if (!(missing(before)) & !missing(after)) stop("You cannot designate a before AND an after argument in the same function call. Please use only one or the other.")

  # Data Table compatability.
  dClass <- class(data)
  data <- as.data.frame(data)

  # Creating booleans to define whether before or after is given.
  useBefore <- !missing(before)
  useAfter <- !missing(after)

  # If either of these are true, then we are using the before or after argument, run the following code.
  if (useBefore | useAfter) {

    # Checking the before/after argument if given. Also adding regular expressions.
    if (useBefore) { CheckChoice(before, names(data)) ; before <- paste0("^", before, "$") }
    if (useAfter) { CheckChoice(after, names(data)) ; after <- paste0("^", after, "$") }

    # If before or after is given, replace "place" with the appropriate number.
    if (useBefore) { newPlace <- grep(before, names(data)) ; if (length(newPlace) > 1) { stop("Your before argument matched with more than one column name. Do you have duplicate column names?!") }}
    if (useAfter) { newPlace <- grep(after, names(data)) ; if (length(newPlace) > 1) { stop("Your after argument matched with more than one column name. Do you have duplicate column names?!") }}
    if (useBefore) place <- newPlace # Overriding place.
    if (useAfter) place <- newPlace + 1 # Overriding place.

  }

  # Making the new column.
  data[, colName] <- colData

  # Finding out how to reorder this.
  # The if statement handles the case where place = 1.
  currentPlace <- length(names(data)) # Getting the place of our data (which should have been just added at the end).
  if (place == 1) {

    colOrder <- c(currentPlace, 1:(currentPlace - 1))

  } else if (place == currentPlace) { # If the place to add the new data was just at the end of the data. Which is stupid...but we'll add support anyway.

    colOrder <- 1:currentPlace

  } else { # Every other case.

    firstHalf <- 1:(place - 1) # Finding the first half on columns that come before the insertion.
    secondHalf <- place:(currentPlace - 1) # Getting the second half, which comes after the insertion.
    colOrder <- c(firstHalf, currentPlace, secondHalf) # Putting that order together.

  }

  # Reordering the data.
  data <- subset(data, select = colOrder)

  # Data Table compatability.
  if (dClass[1] == "data.table") data <- as.data.table(data)

  # Returning.
  return(data)

} 
```

* * *

我意识到我也没有包括 CheckChoice：

```
#####
# FUNCTION: CheckChoice(names, dataNames, firstWord == "Oops" message = TRUE)                                                                                               
# DESCRIPTION: Takes the column names of a data frame and checks to make sure whatever "choice" you made (be it 
# your choice of dummies or your choice of chops) is actually in the data frame columns. Makes troubleshooting easier. 
# This function is also important in prechecking names to make sure the formula ends up being right. Use it after 
# adding in new data to check the "choose" options. Set firstWord to the first word you want said before an exclamation point.
# The warn argument (previously message) can be set to TRUE if you only want to 
#####

CheckChoice <- function(names, dataNames, firstWord = "Oops", warn = FALSE) {

  for (name in names) {

    if (warn == TRUE) { if(!(name %in% dataNames)) { warning(paste0(firstWord, "! The column/value/argument, ", name, ", was not valid OR not in your data! Check your input! This is a warning message of that!")) } }
    if (warn == FALSE) { if(!(name %in% dataNames)) { stop(paste0(firstWord, "! The column/value/argument, " , name, ", was not valid OR not in your data! Check your input!")) } }

  }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-09-29T05:42:15.080

我会简单地使用`cbind()`这个：

```
> df <- data.frame(a=1:5,
+                  b=10:14,
+                  c=rep(0,5),
+                  d=7:11)
> 
> z <- LETTERS[1:5]
> df <- cbind(df[,1:2], z, df[,3:4]) # Puts the z column between 2nd and 3rd column of df
> df
  a  b z c  d
1 1 10 A 0  7
2 2 11 B 0  8
3 3 12 C 0  9
4 4 13 D 0 10
5 5 14 E 0 11 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-03-30T18:14:42.483

这是一个如何将列从最后一个位置移动到第一个位置的示例。它`[`与`ncol`. 我认为在这里为忙碌的读者提供一个非常简短的答案会很有用：

```
d = mtcars
d[, c(ncol(d), 1:(ncol(d)-1))] 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-03-27T07:54:21.740

您可以使用该`append()`函数将项目插入向量或列表（数据框是列表）。简单地：

```
df <- data.frame(a=c(1,2), b=c(3,4), c=c(5,6))

df <- as.data.frame(append(df, list(d=df$b+df$c), after=2)) 
```

或者，如果您想按名称指定位置，请使用`which`：

```
df <- as.data.frame(append(df, list(d=df$b+df$c), after=which(names(df)=="b"))) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-04-24T05:02:41.960

此函数在数据框中的所有预先存在的列之间插入一个零列。

```
insertaCols<-function(dad){   
  nueva<-as.data.frame(matrix(rep(0,nrow(daf)*ncol(daf)*2 ),ncol=ncol(daf)*2))  
   for(k in 1:ncol(daf)){   
      nueva[,(k*2)-1]=daf[,k]   
      colnames(nueva)[(k*2)-1]=colnames(daf)[k]  
      }  
   return(nueva)   
  } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-05-22T08:07:56.207

`

```
data1 <- data.frame(col1=1:4, col2=5:8, col3=9:12)
row.names(data1) <- c("row1","row2","row3","row4")
data1
data2 <- data.frame(col1=21:24, col2=25:28, col3=29:32)
row.names(data2) <- c("row1","row2","row3","row4")
data2
insertPosition = 2
leftBlock <- unlist(data1[,1:(insertPosition-1)])
insertBlock <- unlist(data2[,1:length(data2[1,])])
rightBlock <- unlist(data1[,insertPosition:length(data1[1,])])
newData <- matrix(c(leftBlock, insertBlock, rightBlock), nrow=length(data1[,1]), byrow=FALSE)
newData 
```

`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-07-30T05:41:34.680

```
df <- data.frame(a=c(1,2), b=c(3,4), c=c(5,6))
df %>%
  mutate(d= a/2) %>%
  select(a, b, d, c) 
```

结果

```
 a b   d c
1 1 3 0.5 5
2 2 4 1.0 6 
```

我建议`dplyr::select`在`dplyr::mutate`. 它有许多帮助器来选择/取消选择列的子集。

在这个问题的上下文中，您选择的顺序将反映在输出 data.frame 中。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-07-15T17:14:06.063

R 没有指定添加新列的位置的功能。例如，`mtcars$mycol<-'foo'`。它总是作为最后一列添加。使用其他方式（例如`dplyr's select()`），您可以将 mycol 移动到所需位置。这并不理想，R 可能希望在未来尝试改变它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-06T07:52:32.570

当你不能假设列`b`出现之前，`c`你可以使用`match`查找两者的列号，`min`获取较低的列号并`seq_len`获取直到该列的序列。然后您可以先将此索引用作*正*子集，然后放置新列`d`，然后再次将序列用作*负*子集。

```
i <- seq_len(min(match(c("b", "c"), colnames(x))))
data.frame(x[i], d, x[-i])
#cbind(x[i], d, x[-i]) #Alternative
#  a b  d c
#1 1 4 10 7
#2 2 5 11 8
#3 3 6 12 9 
```

如果您知道该列出现在您可以将新列放在`b`之后：`c``d``b`

```
i <- seq_len(match("b", colnames(x)))
data.frame(x[i], d, x[-i])
#  a b  d c
#1 1 4 10 7
#2 2 5 11 8
#3 3 6 12 9 
```

数据：

```
x <- data.frame(a = 1:3, b = 4:6, c = 7:9)
d <- 10:12 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-04-26T16:10:32.567

你可以像下面那样做 -

```
df <- data.frame(a=1:4, b=5:8, c=9:12)
df['d'] <- seq(10,13)
df <- df[,c('a','b','d','c')] 
```

# dojo - 如何使用简单的 Dojo 1.8 构建？

> ID：13502603
> 
> 赞同：0
> 
> 时间：2012-11-21T21:51:19.540
> 
> 标签：dojo, dojo-build, dojo-1.8

我编写了一个依赖于托管在 Google CDN 上的 Dojo（1.8 版）的应用程序。代码看起来像这样并且工作正常：

```
<script src="//ajax.googleapis.com/ajax/libs/dojo/1.8/dojo/dojo.js"></script>
<script>
require(["dijit/form/TextBox", "dijit/form/Button", "dijit/form/Select", "dijit/form/ComboBox", "dojo/store/Memory", "dijit/Tooltip", "dojo/domReady!"],function(TextBox, Button, Select, ComboBox, Memory, Tooltip) {
// my code here
});
</script> 
```

现在，我正在尝试为无法访问 CDN 的用户**构建一个本地的、简单的 dojo。**我去了[build.dojotoolkit.org](http://build.dojotoolkit.org/)，选择了我的模块，并检索了一个自定义构建 dojo.js（大小约为 400 kb）。然后我将它上传到我的服务器并修改了我的代码：

```
<script src="pathtoserver/pages/dojo.js"></script>
<script>
require(["dijit/form/TextBox", "dijit/form/Button", "dijit/form/Select", "dijit/form/ComboBox", "dojo/store/Memory", "dijit/Tooltip", "dojo/domReady!"],function(TextBox, Button, Select, ComboBox, Memory, Tooltip) {
// my code here
});
</script> 
```

这是行不通的。我假设我缺少一个简单的步骤，例如需要声明一个配置，但不幸的是我找不到任何关于如何使用**简单构建**的教程或示例。

[更新]我得到的错误是 404 not found 以下文件：

*   pathtoserver/pages/resources/blank.gif
*   pathtoserver/dojox/gfx/svg.js

当然，我在这些位置没有任何东西，我只是将在线构建工具返回的 zip 文件的内容上传到服务器：dojo.js 和带有本地化文件的 nls 文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T03:03:27.450

可能需要的不仅仅是 dojo.js，例如本地化包、模板（如果没有内联）等。 build.dojotoolkit.org 应该给你一个 zip 来使用。另外，看看网络面板，它应该会告诉你缺少什么。

# c# - 不实现 System.IComparable.CompareTo(object)

> ID：13502605
> 
> 赞同：1
> 
> 时间：2012-11-21T21:51:24.297
> 
> 标签：c#, .net, compiler-errors

> 错误 1 ​​'Koordinates.Vieta' 未实现接口成员 'System.IComparable.CompareTo(object)'

编码：

```
 public class Vieta : IComparable //error is thrown here, on "Vieta"
{
    public double x, y; 
    //constructor
    public Vieta(double a, double b)
    {
        x = a; y = b;
    }
    //read only parameter
    public double ilgis
    {
        get
        {
            return Math.Sqrt(x * x + y * y);
        }
    }

    public int CompareTo(Vieta other)
    {
        if (other == null) return 1;
        return other.ilgis.CompareTo(this.ilgis);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:53:10.647

您有一个比较方法，该方法采用`Vieta`该类的实例。[`IComparable`](http://msdn.microsoft.com/en-us/library/system.icomparable.aspx?ppud=4)接口声明了一个方法（`CompareTo(object)`注意参数应该是类型`object`）。

当然最好有一个强类型的 CompareTo 方法。您也可以实现该[`IComparable<T>`](http://msdn.microsoft.com/en-us/library/4d7sx9hd.aspx)接口。

我的建议是这样做，并`IComparable`明确地实现接口。然后，你会得到这样的结果：

```
public class Vieta : IComparable, IComparable<Vieta>
{

    IComparable.CompareTo( object obj )
    {

       var other = obj as Vieta;

       if( other == null ) return false;

       return CompareTo(other);

    }

    public int CompareTo( Vieta other )
    {
         // Implement your compare logic here.
    }

} 
```

通过`IComparable`显式实现接口，该`CompareTo(object)`方法将对智能感知隐藏。实际上，只有将类转换为接口类型（或者如果该类的实例被传递给带参数的方法），您才能调用该方法`IComparable`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T21:54:23.087

将类更改为：

```
public class Vieta : IComparable<Vieta> 
```

[`IComparable`](http://msdn.microsoft.com/en-us/library/system.icomparable.aspx)定义了一个`int CompareTo(object)`while 泛型[`IComparable<T>`](http://msdn.microsoft.com/en-us/library/4d7sx9hd.aspx)定义了一个`int CompareTo(T)`.

# jquery - on('click') 不起作用？

> ID：13502607
> 
> 赞同：2
> 
> 时间：2012-11-21T21:51:36.743
> 
> 标签：jquery

我正在尝试创建一个按钮，该按钮将隐藏它包含的 div。这个 div 的内容（包括按钮）很可能会在查看页面时被破坏并重新创建几次，所以我一直建议使用“事件委托”来定位按钮，因为在按钮本身实际调用的函数在它被销毁和重新创建后会失败。

我建议使用的语法如下：

```
$('#container').on('click', '#button', function() {
  $('#div').fadeOut();
}); 
```

由于某种原因，这不起作用。我创建了[这个 jsfiddle](http://jsfiddle.net/QgGsP/)，其中它也不起作用。我究竟做错了什么？谢谢！

编辑：好的，显然我很笨，没有正确使用 jsfiddle。一旦我将它配置为使用 jQuery，它就可以正常工作，但是这种方法在我的实际代码中不起作用。

HTML：

```
<div class="cycle-slideshow" id="slideshow">
  <div class="cycle-overlay custom" id="info">
    <img src="close_pane.png" class="fadein close_pane button">
  </div>
</div> 
```

jQuery：

```
$('#slideshow').on('click', '.close_button', function() {
  $('#info').fadeOut('slow');
}); 
```

这在我看来功能相同，但不起作用。知道为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:27:57.523

看起来你的元素中没有带有类的`.close_pane`元素`HTML`

```
$('#slideshow').on('click', '.close_button', 
```

应该是

```
$('#slideshow').on('click', '.close_pane', 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T21:54:45.693

一切都很好：http: [//jsfiddle.net/pulkitm/QgGsP/4/](http://jsfiddle.net/pulkitm/QgGsP/4/)

您只是错过了在左侧面板上选择 jquery 框架！

代码工作正常：

```
$(function() {
    $('#outer').on('click', '#close', function() {
        $('#inner').fadeOut();
    });
});​ 
```

# actionscript - Flex/ActionScript 更改形状填充颜色

> ID：13502608
> 
> 赞同：2
> 
> 时间：2012-11-21T21:51:42.613
> 
> 标签：actionscript, colortransform

这是我的代码：

```
private function drawRect():Sprite{
   var rect:Sprite = new Sprite();
   rect.name = "rectName";
   rect.graphics.beginFill(0xffff00);
   rect.graphics.lineStyle(1,0x000000);
   rect.graphics.drawRect(0,0,6,6);
   rect.graphics.endFill();
   rect.addEventListener(MouseEvent.MOUSE_OVER, changeColor);
   rect.addEventListener(MouseEvent.MOUSE_OUT, changeColorBack);
   return rect;
}

private function changeColor(e:MouseEvent):void{
   var newColor:ColorTransform = new ColorTransform();
   newColor.color = 0x00ffff;
   e.target.transform.colorTransform = newColor;
}

private function changeColorBack(e:MouseEvent):void{
   var newColor:ColorTransform = new ColorTransform();
   newColor.color = 0xffff00;
   e.target.transform.colorTransform = newColor;
} 
```

changeColor 和 changeColorBack 函数有效，但不是我想要的。它们改变了我的 Sprite 的整个颜色，包括矩形周围的线条边框（笔触）。我只想更改矩形内的颜色并保持矩形的边框。我在 ColorTransform 中没有看到允许我指定 lineStyle 的属性，所以有没有不同的方法来更改我的矩形的填充颜色并保持它周围的边框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:38:15.233

`ColorTransform``MovieClip`无论在其图形属性中绘制什么，都适用于整体。您可以在每次需要时重新绘制矩形：

```
import flash.display.Sprite;

function drawRect(target:Sprite, clr:Number):void{
   target.graphics.clear();
   target.graphics.beginFill(clr);
   target.graphics.lineStyle(1,0x000000);
   target.graphics.drawRect(0,0,6,6);
   target.graphics.endFill();
}

function changeColor(e:MouseEvent):void{
   drawRect(Sprite(e.target), 0x00ffff);
}

function changeColorBack(e:MouseEvent):void{
   drawRect(Sprite(e.target), 0xffff00);
}

var rect:Sprite = new Sprite();
rect.addEventListener(MouseEvent.MOUSE_OVER, changeColor);
rect.addEventListener(MouseEvent.MOUSE_OUT, changeColorBack);
this.addChild(rect);

drawRect(rect, 0xffff00); 
```

或者，如果您`ColorTransform`出于某种原因开始使用，您可以从两个单独`Sprites`的（外部和内部）构建您的轮廓矩形，并`Sprite`仅使用内部定位`ColorTransform`：

```
import flash.display.Sprite;

function getRectangle(w:Number, h:Number, x:Number, y:Number, clr:Number):Sprite{
   var sprite:Sprite = new Sprite();
   sprite.name = "rectName";
   sprite.graphics.beginFill(clr);
   sprite.graphics.drawRect(x, y, w, h);
   sprite.graphics.endFill();

   return sprite;
}

function changeColor(e:MouseEvent):void{
   var newColor:ColorTransform = new ColorTransform();
   newColor.color = 0x00ffff;
   inner.transform.colorTransform = newColor;
}

function changeColorBack(e:MouseEvent):void{
   var newColor:ColorTransform = new ColorTransform();
   newColor.color = 0xffff00;
   inner.transform.colorTransform = newColor;
}

var rect:Sprite = new Sprite();
rect.addEventListener(MouseEvent.MOUSE_OVER, changeColor);
rect.addEventListener(MouseEvent.MOUSE_OUT, changeColorBack);
this.addChild(rect);

// Outer rectangle for the outline
var outer:Sprite = getRectangle(8, 8, 0, 0, 0x000000);
rect.addChild(outer);

// Smaller inner rectangle which can be targeted with the color transform
var inner:Sprite = getRectangle(6, 6, 1, 1, 0xffff00);
rect.addChild(inner); 
```

# php - php mvc 表单帖子在提交页面上带有警报

> ID：13502611
> 
> 赞同：0
> 
> 时间：2012-11-21T21:51:45.223
> 
> 标签：php, forms, model-view-controller, post, alert

我在自己编写的 MVC 框架中遇到了一点问题。当我将表单发布到另一个页面时，我想在那里显示警报。

例如：我在我的 mvc 框架中构建了一个博客。这里有 3 个控制器/方法：'blog/overview'、'blog/addPost'、'blog/deletePost'。当我在方法'blog/addPost'中时，它会调用一个具有如下形式的视图：

```
<form action="blog/overview/" method="post">
  <input type="text" name="title" />
  <input type="text" name="post" />
  <input type="submit" name="addPost" />
</form> 
```

如您所见，我正在发布到方法“博客/概述”。当表单发布并成功添加博客时，我希望能够显示一条警报，显示“博客文章已成功添加”。在“博客/概述”视图中。

这是否意味着如果有帖子，我必须检查方法“博客/概述”，以及它来自哪里？因为我想在删除博客文章时做同样的事情。这意味着我必须检查“博客/概述”中已经存在的两件事。在我看来，这不是正确的做法。

有人可以告诉我这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:00:55.343

我总是做的是检查哪个按钮被按下了

```
 if(isset($_POST['addPost'])){
    //do something
    header("Location: /blog/overview/");
   } 
```

这样做是如果按下了 addPost 提交按钮，它只会运行 if 语句中的代码。这样，如果表单上有两个按钮，则可以根据按下的按钮运行不同的代码。我希望这有助于/回答你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:35:34.813

任何（正确的）表单提交都遵循[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)模式，将其分为两个主要部分（阶段），必须应用于更大的 MVC 设计模式：

*   ### 第一阶段：`POST-REDIRECT`

    该表格应以`<form action="/blog/addPost" method="post">`. 这将调用`addPost()`控制器中的方法，该方法将必要的信息传递给模型层中的服务，该服务负责管理文章。

    所述服务试图将您的文章保存在您使用的任何形式的永久存储中。如果此操作失败，服务会保存错误状态（通常在会话中）。如果操作成功，服务会将“最后一次操作”存储在会话中的某个位置，以便稍后恢复。

    然后查看，发现模型层发生了新的变化，并`/blog/overview`通过生成响应重定向到，该响应仅包含 HTTP 位置标头。

*   ### 第二阶段：`GET`

    调用控制器`overview`方法，但只是出于礼貌。

    当视图接收到产生响应的命令时，它首先请求模型层（很可能是用于管理文章库的同一服务），是否存在错误状态集。

    服务尝试从会话中恢复错误状态，如果之前存储过，则返回以查看错误代码。

    View 为概览组装 HTML 响应，如果模型层返回错误代码，则用于创建所述 HTML 的模板之一包含用于显示错误消息的片段。

    如果没有错误，视图可以请求模型层进行最后一次更改或最后一次操作，在成功发布后，您也可以将其存储在会话中。**这种方式视图会知道有一些先前的操作已经完成**，并且它还必须为“成功添加/删除”消息添加模板。

这将是简化的逐步过程。您必须了解 MVC 和受 MVC 启发的模式是为在复杂的应用程序中提供结构而设计的，而您的博客可能过于简单，因此选择 MVC 设计模式可能不像您想象的那样务实。

# c# - 从自动下载的 .sql 文件中填充 SQL 数据

> ID：13502616
> 
> 赞同：0
> 
> 时间：2012-11-21T21:52:09.367
> 
> 标签：c#, sql, database, import

我有一个 C# 项目，我试图用从网上下载的文件自动填充 SQL 表。

该文件是[http://ts1.travian.com/map.sql](http://ts1.travian.com/map.sql)，您会看到它已经为 SQL 数据库操作设置了数据。

以下是它们的外观小片段：

```
INSERT INTO `x_world`
    VALUES (1517,315,399,3,181705,'New Remial',82126,'Tale',0,'',273);
INSERT INTO `x_world`
    VALUES (67792,107,316,1,175829,'3.Clay',35440,'salvaje_jabali',0,'',244);
INSERT INTO `x_world`
    VALUES (32790,349,360,1,189271,'Lumeria',9702,'Aquifel',90,'APE',20);
INSERT INTO `x_world`
    VALUES (72449,-42,310,1,194313,'New village',2634,'paloc',0,'',24);
INSERT INTO `x_world`
    VALUES (75669,-26,306,1,170802,'Yao Ming',2634,'paloc',0,'',330); 
```

为了便于阅读，我在每个 INSERT 代码之前插入了一个换行符。

我已经在我的项目中重新创建了包含所有必需列的表，但是如何让项目在单击按钮（名为 CommandButton1）时下载文件，然后将所有这些数据解析到我项目表中的所需列中（下载文件中的数据由逗号分隔，似乎一直贯穿）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:16:18.417

使用罗比回答中的代码并详细说明：

```
using System.Net;

//Download
WebClient Client = new WebClient ();
Client.DownloadFile("http://ts1.travian.com/map.sql", @"C:\folder\file.sql");

// Read into a file
var sqltext = System.IO.File.ReadAllText(@"c:\folder\file.sql");
// Split the sql statements up
var sqlStatements = sqltext.Split(';'); 

// Insert
using (SqlConnection connection = new SqlConnection(connectionParameters))
    {   
        connection.Open();
        foreach (var sqlStatement in sqlStatements)  
        {
            SqlCommand command = new SqlCommand(sqlStatement, connection);
            command.ExecuteNonQuery();
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:01:25.713

这里有一些示例代码可以帮助您开始下载文件：

[如何在 C# 中从网站下载文件](https://stackoverflow.com/questions/525364/how-to-download-a-file-from-a-website-in-c-sharp)

然后，您可以运行 SSIS/SQL Server 代理/批处理作业来执行数据加载。或者，如果您想在代码中执行此操作：

[如何使用 C# 执行 .SQL 脚本文件](https://stackoverflow.com/questions/650098/how-to-execute-an-sql-script-file-using-c-sharp)

# python - Python-Oracle 错误处理多个步骤

> ID：13502623
> 
> 赞同：0
> 
> 时间：2012-11-21T21:52:50.577
> 
> 标签：python

我的python模块中有4个函数-1,2,3,4，每个函数都执行一个插入stmt，我希望只有在前一个函数成功结束时才执行后续函数..

我该怎么做？

代码.py

```
 def main():
      func1()
      func2()
      func3()
      func4()

 def func1():
     try:
        insert into table1
     catch:
        database.error as e

 def func2():
     try:
        insert into table2
     catch:
        database.error as e 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:59:18.877

如果您希望仅在前一个函数成功结束时执行后续函数，则在一个`try .. catch`块中依次调用它们。

```
try:
  function1()
  function2()
  function3()
  function4()
except database.error as e:
  print 'Database error occured' 
```

并且不要在函数中捕获异常。

# python - python类继承：派生类的构造函数问题

> ID：13502633
> 
> 赞同：0
> 
> 时间：2012-11-21T21:53:17.350
> 
> 标签：python, class, inheritance, constructor, derived

我有两个类：基类 A 和派生类 B。在 BI 的构造函数中尝试使用 A 的构造函数来初始化实例。为什么派生类的构造函数中的赋值“self = A(x)”不起作用？

```
class A:
    def __init__(self, x=0):
        print "constructing A"
        self.x = x

    def printx(self):
        print "x =",self.x 

class B(A):
    def __init__(self,x):
        A.__init__(self)
        print "constructing B"
        self = A(x)
        self.printx()

b = B(2)
b.printx() 
```

输出：

```
constructing A
constructing B
constructing A
x = 2
x = 0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T21:59:45.033

你不想调用构造函数`B.__init__`，你应该传递`x`给`A.__init__`

```
class A:
    def __init__(self, x=0):
        print "constructing A"
        self.x = x
    def printx(self):
        print "x =",self.x 

class B(A):
    def __init__(self,x):
        A.__init__(self, x)
        print "constructing B"
        self.printx() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T21:57:07.863

在 Python 中，将变量名（如`self`）视为“指向”或“引用”值。当您创建以下实例时`B`：

```
b = B(2) 
```

使用已分配给 的早期实例的`B.__init__`变量调用该方法。现在，在这个方法中，当 Python 到达`self``B`

```
 self = A(x) 
```

变量`self`被重新分配给 的新实例`A`。的实例`B`仍然存在；`self`只是不再指向它。

请注意，这`self`是一个与 Python 中的任何其他变量一样的变量。(`self`不是关键字，它只是调用方法的第一个参数的约定`self`。)

* * *

顺便说一句，要`self`使用 的值进行初始化`x`，请使用

```
class B(A):
    def __init__(self,x):
        A.__init__(self, x)    # <-- Note the x
        print "constructing B"
        self.printx() 
```

然后

```
b = B(2)
b.printx() 
```

产量

```
constructing A
constructing B
x = 2
x = 2 
```

* * *

当一个类具有备用构造函数时，例如`getA`，Python 中的典型模式是使用类方法：

```
class A(object):
    def __init__(self, x=0):
        print "constructing A"
        self.x = x

    def printx(self):
        print "x =",self.x 

    @classmethod
    def getA(cls, x):
        print('constructing getA')
        self = cls(x)
        self.y = 1
        return self 
```

`A`现在用 classmethod创建一个实例`getA`，你会说

```
a = A.getA(x) 
```

类`A`作为第一个参数传递给类方法`getA`，并存储在变量中`cls`。

这样做的好处是（而不是使用工厂函数`getA`），如果你`A`像这样子类化：

```
class B(A):
    def __init__(self,x):
        A.__init__(self, x)
        print "constructing B"
        self.printx() 
```

`B`那么您也可以创建使用类方法的实例`getA`：

```
b = B.getA(2) 
```

产量

```
constructing getA
constructing A
constructing B
x = 2 
```

和

```
print(type(b))
print(b.y) 
```

产量

```
<class '__main__.B'>  # b is an instance of B
1   # showing the y attribute has been set. 
```

# php - 使用 ajax 提交表单并传递值

> ID：13502638
> 
> 赞同：0
> 
> 时间：2012-11-21T21:53:33.613
> 
> 标签：php, jquery, ajax, google-visualization

**索引.html**

```
function drawChart() {
                var jsonData = $.ajax({
                    url: "server.php?startdate=" + start_date + "&enddate=" + end_date + "&type=" type,
                    dataType: "json",
                    async: false
                }).responseText;

                var obj = jQuery.parseJSON(jsonData);
                var data = google.visualization.arrayToDataTable(obj);
    (...) 
```

这个 vars: **start_date, end_date 和 type**应该通过表单获得而不刷新页面，所以我可以将它发送到 server.php 并做一些事情
我怎样才能在不改变这个 jsonData 结构等的情况下做到这一点？
因为我需要它来构建图表。

再次感谢 :) ps：如果我不清楚，请注意我 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:59:19.593

假设您的表单有一个`id`并且每个表单输入都有一个`name`，您可以使用 jQuery`serialize()`函数将表单数据发送到您的 ajax 请求中的 URL。像这样的东西：

```
var jsonData = $.ajax({
                url: "server.php",
                data: $('#myForm').serialize(),
                dataType: "json",
                async: false
            }).responseText; 
```

`data`请注意在 ajax 调用中添加的选项，`#myForm`表单的 id 在哪里。

例如，如果你有

```
<input type="text" name="start_date" /> 
```

在您的表单中，ajax 请求实际上会发送到`server.php?start_date=2012-11-20`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:09:47.377

想象一下页面上有一个表单（如下面的表单），一些 jQuery 将允许您获取输入到文本字段中的值并将其存储到 javascript 变量中，然后您可以在 drawChart() 函数中使用这些变量。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function(){
        $('#never_name_a_button_submit').click(function() {
            var start_date = $('start_date').val();
            var end_date = $('end_date').val();
            var type = $('type').val();
        });
    });
function drawChart() {
            var jsonData = $.ajax({
                url: "server.php?startdate=" + start_date "&enddate=" + end_date + "&type=" type,
                dataType: "json",
                async: false
            }).responseText;

            var obj = jQuery.parseJSON(jsonData);
            var data = google.visualization.arrayToDataTable(obj);
(...)

</script>

<form id="myForm">
    <input type="text" name="start_date" id="start_date"><br />
    <input type="text" name="end_date" id="end_date"><br />
    <input type="text" name="type" id="type"><br />
    <input type="button" id="never_name_a_button_submit">
</form> 
```

# objective-c - Distribution Provisioning Profiles 是有效的，但 Development Profiles 说没有找到有效的签名实体

> ID：13502639
> 
> 赞同：0
> 
> 时间：2012-11-21T21:53:34.133
> 
> 标签：objective-c, ios, xcode, provisioning, provisioning-profile

我花了很多时间来配置配置文件，甚至设法发布了一些应用程序，所以我对这个过程很熟悉。但是，我遇到了一个问题，我不知道该怎么办。

在我的钥匙串访问中，我有大量的钥匙和证书，其中很多都是不熟悉的。也许不明智，我将它们全部删除，以便重新添加正确的。（我现在意识到这是一个坏主意）。

在开发者门户中，我意识到我的开发和分发证书即将到期，因此我撤销并重新创建了它们。（另外，我猜是个坏主意）。这样做，我显然使我的所有配置文件无效。所以，我用新证书重新创建了它们。

我现在遇到的问题是，当我将新的配置文件添加到 Xcode 时，*分发*证书（Ad Hoc 和 App Store）都显得有效。但是，我的*开发*配置文件（和 iOS 团队配置文件 *）都说“未找到有效的签名实体”。

通过删除我的本地证书、撤销在线证书、重新颁发它们并重新创建我的配置文件，我是否完全搞砸了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:40:59.617

在这里查看我的答案：

[如何更新 iPhone 开发证书？](https://stackoverflow.com/questions/2177143/how-to-renew-an-iphone-development-certificate/13426659#13426659)

基本上，你没有做错任何事——相反，这只是走得够远的问题。您想在门户网站和本地删除所有配置文件，并清除您的证书。然后创建并下载当前的开发和分发证书，以便这些证书是您钥匙串中唯一的证书。然后创建并下载任何需要的开发和分发配置文件。要重新创建您的团队资料，请通过 Xcode 将设备添加到门户网站，以便 Xcode 为您下载新的团队资料。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:30:37.787

我同意，即使在几年之后，这仍然是一个非常复杂的领域。我想，你不应该像这样把事情完全搞砸。如果您创建了新的签名请求和所有新证书，您应该没问题。但是，我记得可能会出现几个隐藏的问题。

首先是钥匙串中的重复证书。如果您的第一个证书已过期并且您使用之前使用的相同签名请求生成另一个证书，则可能会发生这种情况。在这种情况下，Xcode 可能会以某种方式选择错误的。但是，如果您将它们全部清除并使用新的签名请求生成新证书，这应该不是问题。

其次，添加新证书后需要退出并重新启动 Xcode。也许在新版本中这不再是问题，但绝对是。此外，Xcode 将 Provisioning Profiles 缓存在 Organizer 中。如果您决定清理所有东西，请不要忘记清理它们。

最后，确保目标设置中的代码签名身份确实使用新的配置文件。如果在旧的一次和新的一次中使用相同的命名，很容易混淆它们。尝试更改新 Provisioning Profiles 的名称格式，以便您可以将它们与旧版本区分开来。我希望这有帮助。

# css - 使用 CSS 更改 SVG spritesheet sprite 的颜色

> ID：13502649
> 
> 赞同：3
> 
> 时间：2012-11-21T21:54:30.783
> 
> 标签：css, colors, svg

我正在为图标使用 SVG spritesheet。我想对 :hover/:active 进行颜色更改。改变 SVG 颜色的唯一方法（我发现）是 SVG 数据是内联的。有一个很好的脚本可以将外部 .svg 转换为内联 SVG 代码：

[如何使用 CSS（jQuery SVG 图像替换）更改 SVG 图像的颜色？](https://stackoverflow.com/questions/11978995/how-to-change-color-of-svg-image-using-css-jquery-svg-image-replacement)

但我认为它不适用于 spritesheet，因为页面上的每个 sprite 都将被注入整个 spritesheet 的路径，而不仅仅是特定 sprite 需要显示的 1。

有没有一种方法可以基于类（或其他东西）提取 spritesheet xml 的特定部分（精灵）以放入 HTML 标记中？我唯一的想法是手动分解spritesheet，将每个sprite path-string放入一个数组/对象中，并使用js（可能是Raphael）编写内联标记并设置悬停颜色；但我不确定会增加什么样的开销，或者它是否是一种非常复杂的方式来做不应该做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:10:31.440

一种想法是使 spritesheet 内联，提供所有不同的 sprite ID 并使用 引用它们`<svg:use>`，如下所示：

```
<html>
  <head>
    <title></title>
    <style type="text/css">
      #firstUseOfSprite1:hover{
        color:green;
      }
      #secondUseOfSprite1:hover{
        color:blue;
      }
      #sprite1{
        fill:currentColor;
        stroke:red;
        stroke-width:5px;
      }
      #defs{
        display:none;
      }</style>
  </head>
  <body>
    <!-- This is our "spritesheet" -->
    <svg id="defs">
      <defs>
        <rect width="50" height="20" id="sprite1"/>
        <circle r="20" id="sprite2"/>
      </defs>
    </svg>
    <p>Here we use the "sprite":</p>
    <div>
      <svg width="55" height="25">
        <use xlink:href="#sprite1" id="firstUseOfSprite1" x="2.5" y="2.5"></use>
      </svg>
    </div>
    <p>And here, we use it again:</p>
    <div>
      <svg width="55" height="25">
        <use xlink:href="#sprite1" id="secondUseOfSprite1" x="2.5" y="2.5"></use>
      </svg>
    </div>
  </body>
</html> 
```

您甚至可以为同一个精灵的不同用途应用不同的悬停效果。它似乎适用于 Firefox 和 Chrome，但悬停效果不适用于我的 Opera。我没有尝试IE9。

# java - Java 线程不响应 notifyAll()

> ID：13502654
> 
> 赞同：1
> 
> 时间：2012-11-21T21:54:44.413
> 
> 标签：java, multithreading, wait

我正在开发一个演示程序，该程序显示了处理线程的不同方式的影响。我正在使用一个简单的任务，即获取一个 char 数组并构建一个名称，将每个 char 发送到一个 StringBuilder，该 StringBuilder 调用一个名为 NameBuilder 的可运行对象，后者又使用具有同步方法的 letterAdder 类和一个静态 StringBuilder 变量来保持名称原样建成。这种结构松散地基于 Bruce Eckel 在“Thinking in Java”中的 WaxoMatic 示例

这是我用于 notifyAll() 方法的代码：

```
import java.util.List;
import java.util.concurrent.*;

class LetterAdder{
    public static StringBuilder currName = new StringBuilder();
    public static boolean busyAdding = false;

    public synchronized void addLetterSynchWithNotifyAll(char letter) throws InterruptedException{
        while (busyAdding){
            System.out.println("Letter " +letter+" has to wait");
            wait();
        }
        busyAdding=true;
        System.out.println("About to add " + letter + " - ");
        currName.append(letter);
        System.out.println("name is now " + currName);
        busyAdding=false;
    }

    public synchronized void doNotifyAll(char letter) throws InterruptedException{
        System.out.print(letter + " is notifying all");
        notifyAll();
    }
}

class NameBuilder implements Runnable{
    private LetterAdder adder = new LetterAdder();
    private char nextLetter;

    public NameBuilder(char nextLetter){
        adder = new LetterAdder();
        this.nextLetter=nextLetter;
    }

    public void run(){
        try{
            adder.addLetterSynchWithNotifyAll(nextLetter);
                adder.doNotifyAll(nextLetter);
        } catch (InterruptedException e) {
            System.out.println("Letter "+nextLetter+" interrupted!");
        }

        //tie up thread for specified time to ensure other threads go to wait 
        try{
            TimeUnit.SECONDS.sleep(1);
        } catch(Exception e){}
    }
}

public class NotifyDemo {
    public static void main(String[] args) {
        char[] chars = {'M', 'a','r','t','i','n'};
        ExecutorService pool = Executors.newCachedThreadPool();

        for (int i=0; i<chars.length; i++){
            NameBuilder builder = new NameBuilder(chars[i]);
            pool.execute(builder);
        }

        System.out.println("\nWill shutdown thread pool in 20 seconds");
        try {
            TimeUnit.SECONDS.sleep(20);
        } catch (InterruptedException e) {}
        System.out.println("\nAbout to shutdown thread pool ");
        List<Runnable> tasks = pool.shutdownNow();
        if (!tasks.isEmpty()){
            for (Runnable r: tasks){
                System.out.println("Uncompleted task: "+r.toString());
            }
        }
    }
}

/** Output
About to add M - 
Letter a has to wait
name is now M
Letter r has to wait
M is notifying allLetter t has to wait
About to add i - 

Will shutdown thread pool in 20 seconds
Letter n has to wait
name is now Mi
i is notifying all
About to shutdown thread pool 
Letter a interrupted!
Letter t interrupted!
Letter n interrupted!
Letter r interrupted!
*/ 
```

从输出中的打印语句可以看出，当信件到达busyAdding 监视器并打印等待消息时，它们会被阻塞，但即使发送了notifAlly()，它们也永远不会退出等待状态。

此外，我希望被中断的线程出现在 shutdownNow() 语句返回的列表中，但列表为空。

我有一种感觉我错过了一些明显的东西，谁能发现我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:35:02.600

您在不同的加法器之间共享busyAdding，但锁定并通知每个不同的加法器。

这意味着可能会发生以下情况。假设您创建了三个加法器，“O”、“p”和“s”，第一个可能会进入*addLetterSynchWithNotifyAll*，经过警卫并将忙碌信号设置为 true。现在，接下来的两个跑步者进入，并被困在后卫身上。当第一个线程存在时，它会通知所有在第一个运行者处等待的线程（目前没有）。您想在对象之间共享信号。

您可以将*addLetterSynchWithNotifyAll 设为*静态，这意味着同步将在类级别，然后您需要将等待更改为在类上，而不是在实例上。或者您可以创建一个用于同步和等待的通用锁对象。

如果您将方法设为静态，请注意没有其他线程将进入该方法，因为它们现在在同一个对象上同步，并且您无需使用*busyAdding*进行保护。

# sql - Excel VBA 语法中的 SQL

> ID：13502659
> 
> 赞同：1
> 
> 时间：2012-11-21T21:55:07.457
> 
> 标签：sql, excel, vba, select

我正在尝试在查询另一个 excel 电子表格的 VBA ODBC 连接中编写一个 CASE WHEN THEN ELSE END 等效项。我已经尝试了一切，我只能让这个成功查询电子表格：

```
.CommandText = "SELECT Data$.CALC_POST_PERIOD='201211' FROM Data$ Data$ 
```

结果是条件为真时返回，为`-1`假时返回`0`

我该如何定制这个？

我正在尝试做这样的事情

```
SELECT CASE WHEN Data$.CALC_POST_PERIOD='201211' THEN 'CURR_MONTH' ELSE NULL END 
```

但这给了我一个错误 - 不匹配

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T00:28:48.847

运行查询后只需测试 TRUE 或 FALSE。

```
If rs.Fields(0).Value Then
    sReturn = "CURR_MONTH"
Else
    sReturn = vbNullString
End If 
```

如果它是一个函数，则将 sReturn 分配给函数名称。只要之前没有将 sReturn 设置为其他值，Else 部分就不是必需的，但为了清楚起见，我将其包含在此处。还假设您的 CommandText 用于名为“rs”的记录集变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T10:42:52.867

您可以使用 SWITCH 功能：

```
SELECT SWITCH(Data$.CALC_POST_PERIOD='201211', 'CURR_MONTH', TRUE, NULL) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:08:16.657

以下内容对您有用吗

```
"SELECT [Items], " _
"IFF([CALC_POST_PERIOD] = '201211' , 'CURR_MONTH' , '') as NewColumn 
FROM [Data$]" 
```

# c - 这个递增和递减分配试图做什么？

> ID：13502660
> 
> 赞同：2
> 
> 时间：2012-11-21T21:55:08.740
> 
> 标签：c, iar

```
*pSpiTxBuf++ = CC2520_INS_SFLUSHRX; // get rid of this packet
*pSpiTxBuf-- = CC2520_INS_SFLUSHRX; // double flush [CC2520 Bug#1] 
```

谁能向我解释以上两行试图做什么？`pSpiTxBuf`是一个`uint8_t *`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T22:02:35.213

这相当于：

```
pSpiTxBuf[0] = CC2520_INS_SFLUSHRX; // get rid of this packet
pSpiTxBuf[1] = CC2520_INS_SFLUSHRX; // double flush [CC2520 Bug#1] 
```

（这可能是首先编写代码的更清晰的方式）。

即它只是将两个相邻的寄存器值设置为 CC2520_INS_SFLUSHRX。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T22:01:13.940

递增和递减运算符在取消引用之前更改指针中的地址。因此，您在缓冲区中前进，然后更改新指向的单元格中的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T22:01:55.773

放入一些括号以使其更清晰：

```
*(pSpiTxBuf++) = CC2520_INS_SFLUSHRX; 
```

忽略`++`，它是标准的指针引用和形式的赋值`*p = q`。但是`p`恰好其中有一个后增量运算符，这意味着，照常使用该值，但是在使用它之后，将其递增。

第一个是将值分配`CC2520_INS_SFLUSHRX`给`*pSpiTxBuf`，即分配给 所*指向*的位置`pSpiTxBuf`。然后它会递增`pSpiTxBuf`，因此它现在指向下一个位置。

第二个类似，但之后指针递减，所以它现在指向前一个位置。

# vba - 哪些注册表项确定 Outlook 配置文件

> ID：13502664
> 
> 赞同：11
> 
> 时间：2012-11-21T21:55:24.737
> 
> 标签：vba, vbscript, outlook, registry

我需要编写一个 VBScript 代码来检查 Outlook 是使用 MAPI 配置文件还是 RPC over HTTP/S 配置文件。

那么任何人都可以让我知道哪个注册表项决定相同吗？

请帮忙。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-12-25T02:14:54.787

这在 Outlook 2013 中发生了变化：

*   [Outlook 2013 开发人员的新增功能 – 与以前的 Outlook 版本共存](https://msdn.microsoft.com/en-us/library/office/jj228679.aspx#ol15WhatsNew_Coexistence)

配置文件存储在键下：

```
HKEY_CURRENT_USER\Software\Microsoft\Office\<version>\Outlook\Profiles 
```

`<version>`以下内容之一在哪里：

*   办公室 97 –`7.0`
*   办公室 98 –`8.0`
*   办公室 2000 –`9.0`
*   办公室 XP –`10.0`
*   办公室 2003 –`11.0`
*   办公室 2007 –`12.0`
*   Office 2010 – `14.0`（原文如此！）
*   办公室 2013 –`15.0`
*   办公室 2016 –`16.0`

[上面的版本信息是从这个答案](https://stackoverflow.com/a/3267832/173497)复制而来的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-30T10:04:46.607

```
HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles\Outlook

HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Simple MAPI-CMC 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-09-03T15:49:56.097

首先，对于 Outlook 97-2010，配置文件存储在`HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles`.

从 Outlook 2013（支持并行安装）开始，配置文件存储在 中`HKEY_CURRENT_USER\Software\Microsoft\Office\%version%\Outlook\Profiles`，其中 %version% 对于 Outlook 2013 是 15.0，对于 Outlook 2016 是 16.0，等等。

在低（扩展 MAPI）级别，RPC-over-HTTP (ROH) 设置由 PR_PROFILE_RPC_PROXY_SERVER_FLAGS 属性 (0x66230003) 中的 ROHFLAGS_USE_ROH 位确定。该属性在全局配置文件部分以及特定的 Exchange 存储配置文件部分中设置（因为 Outlook 现在支持单个配置文件中的多个 Exchange 帐户）。

您可以在[OutlookSpy](http://www.dimastr.com/outspy)中查看数据- 单击 OutlookSpy 功能区上的 IMAPISession 按钮，单击 OpenProfileSession，`{C8B0DB13-05AA-1A10-9BB0-00AA002FC45A} pbGlobalProfileSectionGuid`从组合框中选择条目。

请注意，不能从 VB（或 .Net）使用扩展 MAPI。如果使用[Redemption](http://www.dimastr.com/redemption) / [Profman](http://www.dimastr.com/redemption/profman.htm)是一个选项，您可以使用以下脚本枚举所有配置文件并检查是否使用了 ROH：

```
 PR_PROFILE_RPC_PROXY_SERVER_FLAGS  = &H66230003
  ROHFLAGS_USE_ROH = 1

  set Profiles=CreateObject("ProfMan.Profiles")
  for i = 1 to Profiles.Count
    set Profile = Profiles.Item(i)
    set GlobalProfSect = Profile.GlobalProfSect
    Debug.Print "Profile: " & Profile.Name & " ------"
    flags = GlobalProfSect.Item(PR_PROFILE_RPC_PROXY_SERVER_FLAGS)
    If TypeName(flags) = "Long" Then
      if (flags And ROHFLAGS_USE_ROH) = ROHFLAGS_USE_ROH Then
        Debug.Print "   ROH is used"
      Else
        Debug.Print "   ROH is not used"
      End If
    Else
      Debug.Print "   No PR_PROFILE_RPC_PROXY_SERVER_FLAGS"
    End If
  next 
```

如果您已经在运行 Outlook，并且想要检查当前配置文件是否使用 ROH，则可以使用[RDOSession](http://www.dimastr.com/redemption/rdosession.htm)。`ExchangeConnectionProperties.UseROH`财产：

```
set Session = CreateObject("Redemption.RDOSession")
Session.MAPIOBJECT = Application.Session.MAPIOBJECT
MsgBox Session.ExchangeConnectionProperties.UseROH 
```

# objective-c - iPhone 套接字流和有效的 IP 地址

> ID：13502665
> 
> 赞同：0
> 
> 时间：2012-11-21T21:55:28.580
> 
> 标签：objective-c, ios, cocoa-touch, networking, tcp

我正在尝试创建一个非常基本的 TCP/IP 服务器和客户端（将是 iPhone）设置。我一直在使用 Apple 示例代码，如下所示：

[http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/Streams/Articles/NetworkStreams.html](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/Streams/Articles/NetworkStreams.html)

我的读写流运行良好。我正在使用 IP 地址通过 WiFi 连接到本地网络。

但是，我现在无法检查是否可以找到 IP 地址，并且最重要的是它是否可以连接到服务器。我查看了 Apple 提供的 Reachabilty 示例，但它仍然报告成功，即使我输入随机不存在的 IP，例如：123.456.7.8

谁能指导我应该看什么？我所做的对于我想要实现的目标是否正确？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:10:38.893

可达性框架只告诉数据包是否可以被路由，而不是它是否会去任何地方。请参阅[http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html)。

如果您想查看是否可以访问网络地址，您应该检查可达性，然后 ping 它：[iOS - Ping with timeout](https://stackoverflow.com/questions/7437643/ios-ping-with-timeout)。在我所有的 iOS 应用程序中，我都懒得检查 ping。我知道我正在使用良好的网址，并且我认为可访问性就足够了。

注意 Bene：可达性是一个熊。您必须在后台线程中启动它。不要从前台线程运行它，它可能需要很长时间才能恢复，并杀死你的应用程序。

# ruby-on-rails - 使用 Rails 进行 Mercury 邮件服务器身份验证

> ID：13502667
> 
> 赞同：0
> 
> 时间：2012-11-21T21:55:35.497
> 
> 标签：ruby-on-rails, smtp, actionmailer

我正在运行一个 Mercury SMTP 服务器（我的 XAMPP 堆栈附带），我正试图让我的 Rails 应用程序在开发模式下使用它。所以我将以下内容添加到我的 development.rb 文件中

```
ActionMailer::Base.delivery_method = :smtp
  ActionMailer::Base.perform_deliveries = true
  ActionMailer::Base.raise_delivery_errors = true
  ActionMailer::Base.smtp_settings = {
  :address              => "localhost",
  :port                 => 25,
  :domain => 'localhost',
  :user_name=>'newuser@localhost',
  :password=>'wampp',
  :authentication => :plain,
  :enable_starttls_auto => true
} 
```

当我将身份验证参数设置为普通时，我得到：

```
504 Unknown or unsupported authentication method. 
```

所以我检查了 ActionMailer API，发现还有两个选项 login 和 cram_md5。如果我使用其中任何一个，我会得到

```
501 Authentication failed - bad user or password. 
```

该用户名/密码组合是默认值，因此它绝对有效。我已经尝试使用和不使用 @localhost 的 newuser，甚至创建了一个新的 Mercury 用户帐户（我有其他理由不这样做）并尝试使用和不使用 @localhost，我总是得到 501。

如果可能的话，我想在 Rails 端进行这项工作，而不是在 Mercury 中启用普通身份验证，但我想如果有人知道如何进行这项工作，我会接受该解决方案。最坏的情况我会推荐一个不同的 SMTP 服务器用于 Rails 开发。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T16:54:50.263

将 Mercury SMTP 服务器配置为不需要身份验证。也许这是默认值？

对于 Rails smtp 设置，请使用：

```
ActionMailer::Base.smtp_settings = {
  :address              => "localhost",
  :port                 => 25
} 
```

这是我与 Apache James 服务器一起使用的配置。当不需要身份验证时，您必须省略大部分参数。

# php - php graph api 多页访问用户对象 - 画布应用

> ID：13502669
> 
> 赞同：-2
> 
> 时间：2012-11-21T21:55:40.007
> 
> 标签：php, facebook-graph-api

我有几个页面，`canvas app`从`page-a`用户登录到 oAuth，然后被定向到`page-b`具有以下代码的页面。
当我使用 javascript api 登录 oAuth 时，我可以获得对用户对象的完全访问权限。
但是当我转到另一个页面时，下面的代码会出错。回声出来了，但

没有。 看起来永远不会被调用，或者正如所指出的那样，它很有可能。返回 0`token``getUser`

`$user = $facebook->getUser();``CBroe`

有没有办法在`user object`没有 javascripts api 的情况下只进行 php 访问，以便我可以逐页遍历？

```
require_once('/facebook-php-sdk-3.1.1-25-6c82b3f/src/facebook.php');
$facebook = new Facebook(array(
    'appId'  => '<MY-APP-ID>',
    'secret' => '<MY-APP-SECRET>'
));

// Get User ID
$user = $facebook->getUser();
$token = $facebook->getAccessToken();

if ($user) {
    try {
        $facebook->setFileUploadSupport(true);

        $fbUser = $facebook->api('/me');

    } catch (FacebookApiException $e) {
        error_log($e);
        $user = null;
    }
}

/*      **          **          **
Undefined variable: fbUser 
**          **          **          */

//print_r($fbUser); 
echo $fbUser['id']; 
echo '<br/>';
echo $fbUser['name']; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:02:13.387

> 看起来像 $user = $facebook->getUser(); 永远不会被调用

什么让你有那个想法？[1]

这段代码中没有任何内容可以阻止它被执行——更有可能的是，它只是返回 0，因为它无法识别用户。这通常指向传递会话 id 的问题，通常是由浏览器拒绝第三方 cookie 引起的。

* * *

[1] 调试是通过检查代码实际执行的操作来**验证**内容，而不仅仅是以“看起来像”的方式*猜测。*

# java - Java中的SQL语法错误

> ID：13502670
> 
> 赞同：3
> 
> 时间：2012-11-21T21:55:40.757
> 
> 标签：java, sql

我在这里错过了什么愚蠢的东西吗？

```
String update = "UPDATE Patients SET fullName = '" + patient.getName() + "', 
                 houseNum = '" + patient.getHouseNum() + "', 
                 address = '" + patient.getAddress() +"', 
                 postCode = '" + patient.getPostCode() + "', 
                 condition = '" + patient.getCondition() +  "', 
                 who = '" + patient.getWho() + "', 
                 time = '" + patient.getTime() + "', 
                 location = '" + patient.getLocation() + "', 
                 actionTaken = '" + patient.getActionTaken() + "', 
                 duration = '" + patient.getDuration() + "' 
                 WHERE regNo = '" +patient.getNHSnum()+"'"; 
```

为此，我在每一行都返回以进行格式化。在我的文件中，它位于一行。所有数据库字段都是文本类型。

我得到的错误是：

```
[Microsoft][ODBC Microsoft Access Driver] Syntax error in UPDATE statement. -3503 
```

**编辑：**

有关信息，以下工作正常：

```
String update = "UPDATE Patients SET fullName = '" + patient.getName() + "', 
                houseNum = '" + patient.getHouseNum() + "', 
                address = '" + patient.getAddress() +"', 
                postCode = '" + patient.getPostCode() + "', 
                condition = '" + patient.getCondition() +  "' 
                WHERE regNo = '" +patient.getNHSnum()+"'"; 
```

**编辑2：**

这是完整的更新字符串：

```
UPDATE Patients SET fullName = 'Dave', houseNum = '5', address = 'Bla', postCode = 'PQ1 RS2', condition = 'Unknown', who = 'Test', time = 'Test1', location = 'Test2', actionTaken = 'Test3', duration = 'Test4' WHERE regNo = '1' 
```

正如我所说，在这个例子中，数据库中的每个字段都是文本类型

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T21:57:34.410

我**强烈**建议您使用[**PreparedStatements**](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)，而不是简单的 Statement （这会导致 SQl 注入）。

下面是使用 PreparedStatement执行**更新的示例。**

```
String query = "UPDATE TABLENAME SET COL1=?, COL2=? WHERE somecondistrue";
Statement st = connection.preparedStatement(query);
st.setString(1, col1value);
st.setString(2, col2Value);
st.executeUpdate(); 
```

如您所见，这是使用**JDBC**执行**SQL 查询的更****简洁的方法**。

 ***** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T22:17:23.643

`time`是 SQL 保留字。最好是重命名它，否则它通常是依赖于供应商的引用，偏离标准 SQL。

完全同意 PreparedStatement 的评论。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T21:59:23.553

您不需要数字字段中的逗号，例如 num 和 duration

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T22:03:23.760

您应该使用 PreparedStatements，因为所有字段都是字符串类型，我在这里看到的唯一问题是您传递带有字符**' 的**字符串，这会产生错误

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T22:03:44.987

正如其他人所说，您应该使用准备好的语句。事实上，考虑一下您的患者姓名中是否有撇号（如 O'Brien）。准备好的陈述将解决这个问题。

很难说没有看到最终的查询。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T22:07:47.150

问题可能是您尝试更新的某些值包含撇号`'`或其他特殊字符。您可以在执行语句之前打印`update`字符串，看看是否是这种情况。一个简单的：

```
System.out.println("update: "+update); 
```

将帮助您轻松查看是否遇到此问题。此外，就像其他人提到的那样，如果您将使用[PreparedStatement](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/PreparedStatement.html)，您将不必担心 SQL 注入问题，也不会遇到这个问题。****

# mysql - AR 获取自己的帖子和朋友的帖子

> ID：13502671
> 
> 赞同：1
> 
> 时间：2012-11-21T21:55:46.013
> 
> 标签：mysql, codeigniter, activerecord, codeigniter-2

我有这些桌子；

```
user - contains user_id | username | fullname | email etcc
user_followers - contains follow_id| user_id | follower_id | date etcc
posts - contains post_id | user_id | post | post_date 
```

我正在尝试获取用户关注的用户和用户自己的帖子的所有帖子。

我试过了

```
$this->db->select('posts.*')->from('posts')
        ->join('user_followers', 'user_followers.user_id = posts.user_id', 'INNER')
        ->where('user_followers.follower_id', $user_id)->order_by('posts.post_date','desc');
    $query = $this->db->get(); 
```

但问题是，我无法从此查询中获取用户的帖子。我已经尝试了 or_where 等其他方法，并且我能够获取用户的帖子，只是数据增加了三倍:(有人可以帮我吗？非常感谢提前。

哦，在正常的Mysql中，它的；

```
SELECT  posts.*
FROM    posts
JOIN    user_followers
ON      user_followers.user_id = posts.user_id
WHERE   user_followers.follower_id = $user_id
ORDER BY
    posts.post_date DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T11:10:42.870

->where() supports passing any string to it and it will use it in the query, provided you pass a second and third parameter of NULL and FALSE respectively. This tells CI not to escape the query. E.g.

```
$where_query = "p.user_id = $user_id OR p.user_id IN (SELECT user_id FROM user_followers WHERE follower_id = $user_id)";
->where($where_query,NULL,FALSE); 
```

Alternatively, you could check out this subquery library [https://github.com/EllisLab/CodeIgniter/wiki/Subqueries](https://github.com/EllisLab/CodeIgniter/wiki/Subqueries)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T05:53:53.850

```
SELECT  p.*
FROM    (
        SELECT  user_id
        FROM    user_followers
        WHERE   follower_id = $user_id
        UNION ALL
        SELECT  $user_id
        ) uf
JOIN    posts p
ON      p.user_id = uf.user_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:09:41.693

为什么不是子选择？

```
select * from posts 
where user_id IN (
    select user_followers.follower_id 
        from user_followers 
        where user_followers.user_id=$user_id) 
    OR posts.user_id = $user_id; 
```

# c# - 从实例变量访问类的静态方法？

> ID：13502685
> 
> 赞同：4
> 
> 时间：2012-11-21T21:56:46.923
> 
> 标签：c#, inheritance, static, xna, instance

有没有办法从实例变量访问类的静态方法/变量？我试过寻找答案，但我的搜索只找到了为什么你不能在静态方法中访问实例方法/变量。我明白为什么静态无法访问实例，但我不明白实例无法访问静态。

这是我的情况：我是一名在 XNA 中制作自上而下的射击游戏的学生，我正在尝试为每个游戏对象使用静态 Texture2D。我有一个 GameObject 类，它为所有其他类奠定了基础，另外两个主要类 GameBot 和 Projectile 分别为机器人和射弹奠定了基础。我的问题也与这种继承有关。我在 GameBot 和 Projectile 类中拥有所有碰撞代码，其他类（如 PlayerShip/EnemyShip 或 Cannonball/Missile）继承自它们。

我遇到的问题是我想从一个我不知道该类的实例变量中访问一个类方法/变量。我的意思是，我将我的方法传递给 GameBot 变量，但它可以是 PlayerShip、EnemyShip 或 GameBot 的任何其他子项，并且每个都有不同的静态纹理数据。

```
class GameBot : GameObject
{
    static protected Texture2D texture;
    static internal Color[] textureData;

    //etc...

    internal bool DidHitEnemy(GameBot enemyGameBot)
    {
        //Here, I want to access enemyGameBot.textureData
        //to do pixel-by-pixel collision
        //but A) enemyGameBot.textureData doesn't work
        //and B) enemyGameBot's class could be any child of GameBot
        //so I can't just use GameBot.textureData
    }

    static internal virtual Color[] GetTextureData()
    {
        return textureData;
        //I even thought about coding this function in each child
        //but I can't access it anyway
    }
} 
```

这个游戏是一种继承的练习。我想尝试在层次结构中较高的类中保留尽可能多的代码，并且只对每个类中的本质区别进行编码。我决定使用静态纹理的原因是我可以在每个 GameBot 中保留一个 Projectile 数组，但能够即时修改该数组中某个位置的 Projectile（Cannonball、Missile 等）。如果没有静态射弹，我每次切换射弹时都必须分配精灵。我想要一个 Projectile 数组的原因是我可以轻松添加另一个 Projectile，而无需在任何地方添加代码。

有没有办法从实例变量访问静态方法/变量？如果没有，有什么建议可以让碰撞代码尽可能通用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T22:04:01.433

从实例访问它的一种简单方法是这样的......

```
public Color[] GetTextureData()
{        
    //note that `GameBot.` isn't required but I find it helpful to locate static 
    //calls versus `this.` for instance methods
    return GameBot.GetTextureDataInternal(); 
}

static internal Color[] GetTextureDataInternal()
{
    return textureData;
} 
```

...然后您可以`.GetTextureData()`从外部变量中调用，而不必单独管理/维护静态调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:33:15.623

```
 class Gamebot : GameObject
{
    static Texture2D DefaultTexture;
    public virtual Texture2D Texture {get{return Gamebot.DefaultTexture;}}

    //etc...

    internal bool DidHitEnemy(Gamebot enemyGameBot)
    {

      //  enemyGameBot.Texture; // this will give you the texture of the enemyGameBot 
    }

}
class SmartBot : Gamebot
{
    static new Texture2D DefaultTexture;
    public override Texture2D Texture { get { return SmartBot.DefaultTexture; } }

} 
```

在 LoadContent 中，您将分配每个类的纹理

```
SmartBot.DefaultTexture = null;
GameBot.DefaultTexture =null; 
```

你可以对纹理数据做同样的事情

**编辑：**顺便说一句，如果你有你的纹理，你可以提取 Color[] TextureData 所以你需要将它保持为静态

# xhtml - HTML 属性命名空间

> ID：13502687
> 
> 赞同：3
> 
> 时间：2012-11-21T21:56:52.680
> 
> 标签：xhtml, attributes, namespaces

我有一个简单的 html 文档。

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns="http://www.w3.org/2000/xmlns
      xmlns:bar="http://www.foo.com/schemas/bar">
 <head>
 </head>
 <body>
        <img src="penguins.png" bar:xwidth="300"/>
 </body>
</html> 
```

当我在 Chrome 或 Firefox 调试器（或 Javascript）中检查属性 bar:xwidth 时，我希望发现该属性的 namespaceURI 将是“http://www.foo.com/schemas/bar”，不幸的是它是无效的。

问题似乎是元素/属性的解析与编程构造。在 Javascript 中，我可以构建我想要的东西，但是任何解析、加载上述内容或 element.innerHTML = "" 都会产生一个带有空命名空间的属性。

关于如何使属性的 namespaceURI 正确的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T01:16:56.330

任意前缀的命名空间解析是一种 XML 特性，而不是 HTML 特性。因此，如果您使用`application/xhtml+xml`mime 类型为您的页面提供服务，这将导致浏览器使用 XML 解析器，并且您的命名空间将按照您的意图进行解析。

浏览器的 HTML 解析器根本不支持前缀/命名空间解析，除非在解析嵌入的 SVG 和 MathML 时，其中非常小的属性列表被“神奇地”转换，例如`xml:lang`和`xlink:href`. 永远不支持您自己的命名空间。

`innerHTML`在 HTML 文档中的工作方式与 HTML 解析器完全相同。

（尤其要注意 IE 的 HTML 解析器，它对如何处理名称中带有冒号的元素和属性有自己的概念。不过，您仍然不会获得 namespaceURI 的值）

所以你唯一的选择是：（i）使用`application/xhtml+xml`；(ii) 使用脚本来构建您的命名空间属性；或 (iii) 不使用命名空间属性。

# mercurial - 无法从 Hudson 运行 Maven 发布作业提交对 Mercurial 的更改

> ID：13502688
> 
> 赞同：0
> 
> 时间：2012-11-21T21:56:55.390
> 
> 标签：mercurial, hudson, maven-release-plugin

我们使用 Mercurial、Maven 和 Hudson

我创建了一个测试项目以在 Hudson 中使用并设置 freestyle/Maven 3 作业，以执行“发布：准备发布：执行”目标。这运行良好。

然后，我通过复制测试项目并更新“存储库 URL”和“存储库浏览器 URL”，为“真实”项目创建了另一个发布作业。这个失败了：

```
[INFO] Checking in modified POMs...
[INFO] EXECUTING: /bin/sh -c cd /opt/home/hudson/jobs/MyProject-ManualRelease/workspace && hg branch
[INFO] EXECUTING: /bin/sh -c cd /opt/home/hudson/jobs/MyProject-ManualRelease/workspace && hg outgoing
[INFO] EXECUTING: /bin/sh -c cd /opt/home/hudson/jobs/MyProject-ManualRelease/workspace && hg commit --message '[maven-release-plugin] prepare release MyProject-1.0' /opt/home/hudson/jobs/MyProject-ManualRelease/workspace/pom.xml
[INFO] EXECUTING: /bin/sh -c cd /opt/home/hudson/jobs/MyProject-ManualRelease/workspace && hg push https://hudson:hudson@scmserver/hg/current/MyProject
[ERROR] 
EXECUTION FAILED
  Execution of cmd : push failed with exit code: 255.
  Working directory was: 
    /opt/home/hudson/jobs/MyProject-ManualRelease/workspace
  Your Hg installation seems to be valid and complete.
    Hg version: 1.3.1 (OK) 
```

为了让我们的 Maven 发布插件与我们的 Mercurial 服务器一起工作，我们必须在其上设置 https 并且需要在每个项目的 hgrc 文件中添加一些配置。两个项目存储库都设置了相同的配置。

我们以“hudson”用户的身份运行 Hudson，并在 Mercurial 服务器上为其设置了私钥/公钥，以便它可以访问 Mercurial 服务器。

我不明白为什么一个项目可以提交更改而另一个不能。如果是两个项目，我猜这是权限问题，但它只是其中之一。

我希望有人对问题所在提出建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:15:03.063

我专注于配置，问题是 hg Web 服务器无法访问项目存储库。有人在项目所在的目录上创建了一个（空）存储库，这阻止了 Hudson 通过 https 访问它。删除存储库修复的东西。

# ruby-on-rails - 为什么 send_data 结果只包含对象 ID？

> ID：13502690
> 
> 赞同：1
> 
> 时间：2012-11-21T21:57:03.013
> 
> 标签：ruby-on-rails

我正在尝试以 CSV 格式呈现由 @people 变量定义的数组。当我在控制器中使用以下代码时，它会返回一个 CSV 文件，其中填充了对象 ID 列（即 0x59ff1c0）。我究竟做错了什么？

```
def index
  @filter_criteria = lambda { |ped| (ped.id.nil? || ped.mother_id.nil?) }
  @people = BuildList.build_list.persons.find_all(&@filter_criteria)

  respond_to do |format|
    format.html
    format.csv { send_data @people.to_csv }
  end     
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-10T16:50:38.287

我有一个类似的问题，直到我把它放在我的桌子模型中，

```
 def self.to_csv(options = {})
   CSV.generate(options = {}) do |csv|
     csv << column_names
     all.each do |report|
       csv << report.attributes.values_at(*column_names)
     end
   end
 end 
```

在这里处理时，数据@report 不是数组：

```
 format.xls {send_data @report.to_csv(col_sep: "\t") } 
```

我得到了我想要的数据，但是制表符分隔符不能正常工作（还）

# iphone - 是否可以将 Localytics 与 Mono for iOS 一起使用？

> ID：13502692
> 
> 赞同：1
> 
> 时间：2012-11-21T21:57:15.367
> 
> 标签：iphone, ios, xamarin.ios, monodevelop, localytics

一般来说，我是 iPhone 开发的新手。我目前正在使用 Monotouch（MonoDevelop 作为 IDE）。是否可以将 Localytics 用于应用跟踪目的？

我看到有一个[iPhone 和 iPad 页面的 iOS 集成指南](http://www.localytics.com/docs/iphone-integration/)，但它使用 Xcode，而在 MonoDevelop 中，您仅将 Xcode 用于界面开发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:57:27.307

MonoTouch 可以通过为其创建绑定来使用任何本机库。

这是一些关于它的文档：

[MonoTouch 原生库轻松](http://blog.xamarin.com/2011/11/02/monotouch-native-libraries-made-easy/)
[绑定 Objective-C 库](http://docs.xamarin.com/ios/Guides/Advanced_Topics/Binding_Objective-C_Libraries)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:48:16.197

Kevin McMahon 有一个 GitHub 项目，它为[Localytics iOS SDK 提供 MonoTouch 绑定](https://github.com/kevinmcmahon/monotouch-localytics)。

# git - Git 问责制

> ID：13502694
> 
> 赞同：2
> 
> 时间：2012-11-21T21:57:44.183
> 
> 标签：git, cloudbees

有什么方法可以确保谁是我们 Git 存储库的实际提交者？我们在 CloudBees 中拥有每个开发人员的密钥，因此可以确保它是其中之一，但是有什么阻止一个开发人员在提交字段中输入另一个开发人员的姓名/电子邮件？如果没有办法阻止它们，是否有办法至少从 Git 日志中确定提交者的 SSH 密钥？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T22:13:57.397

不，Git 本身没有内置机制来确保提交者实际上是存储在提交对象中的那个。有这样的限制实际上有缺点。Git 是一个分布式版本控制系统，因此提交被分发到不同的地方，而不必集中在一个中心位置。即使有一个用于收集所有稳定（或其他）更改的中央存储库，通过所述存储库以外的其他方式传输更改仍然完全没问题。

例如，如果开发人员 A 和 B 都从“中央”存储库克隆，A 仍然可以处理一些事情，然后将这些更改显式发送给 B 以进行审查，而无需通过中央存储库（例如，通过推送到 B 的存储库，或 B 从 A 中提取）。想象一下，B 然后基于这些更改提交一些提交，然后想要将其发布到中央存储库，*而不是*让 A 先将他自己的更改推送到那里。如果有一些限制只允许您自己提交的更改，那么 B 将无法在这种情况下推动 A 的更改。

由于这样的工作流在真正的分布式工作流中非常常见，因此通常不会应用这样的限制。但是我仍然可以理解为什么会这样做，可能仅限于少数新开发人员或其他人。

确实有一些方法可以强制执行这种限制。请注意，Git 本身无法根据 SSH 密钥检查任何内容。Git 有一个简单的协议，所有的身份验证和授权都不是由 Git 直接处理的（Git 不支持任何一种）。例如，对存储库的 SSH 访问由操作系统的标准 SSH 访问规则处理；对于 https 访问，http 服务器处理身份验证。

Git 的一个常见访问层是[Gitolite](http://sitaramc.github.com/gitolite/)。它使用单个用户控制通过 SSH 的访问。本质上，它基于其 SSH 密钥将用户的访问权限限制为一组非常小的特定于 Git 的命令。您可以为它编写自己的插件，这将要求提交始终具有与推送用户相同的提交者；或者您可以使用它附带的电子邮件地址来使用已经实现的功能。为此，请参阅[手册](http://sitaramc.github.com/gitolite/vref.html)中的“检查作者电子邮件”部分。

顺便提一句。确保提交的提交者实际上是它所说的提交者的常用方法是签署提交。虽然它不会阻止以其他人的身份提交，但它允许您检查提交者的身份。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:11:18.087

您可以使用[Gitolite](https://github.com/sitaramc/gitolite)来控制对您的存储库的访问；Gitolite 提供了一些工具，用于添加更精细的控制，以控制谁可以访问单个存储库或分支，以及谁可以更新哪些文件。它还允许您记录哪个用户推送了哪些更改。

通过 SSH 使用常规 Git 不允许您这样做，因为它仅使用 Unix 权限来控制访问，并且不会记录谁进行了特定的推送。而且您也无法阻止人们伪造提交字段中列出的人；任何人都可以在其中放置他们想要的任何价值。

# c - 日志依赖的传递性

> ID：13502695
> 
> 赞同：0
> 
> 时间：2012-11-21T21:57:46.350
> 
> 标签：c, dependencies, shared-libraries

上下文：带有 gcc 工具链的经典 linux 系统（archlinux）

我的程序（我们称之为`P`）依赖于我的一个共享库（我们称之为“foo”或`libfoo.so`）

`libfoo.so`获得了一个公共标头`foo.h`并将`P`其包含在其中一个文件中。

`libfoo.so`取决于`pthread`几个公共函数的库（以及 中存在的其他函数`foo.h`），但 P 不使用这些函数。

问题是，当我将 P 与 libfoo.so 链接时，会请求 libpthread，但我不明白为什么以及如何解决这个问题。

# cognos - 将列表标题添加到 cognos Report Studio 列表

> ID：13502696
> 
> 赞同：1
> 
> 时间：2012-11-21T21:57:52.333
> 
> 标签：cognos

在 cognos 10 报告工作室中，我有一个列表。有没有办法添加列表标题？我可以看到如何添加列表页眉，但我正在寻找列表页眉。在我的工具箱中，我看不到“列表标题”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:10:11.207

在`View`>下`Page Structure`。选择`List`，您要添加列表标题，然后将`Column Titles Properties`其更改为>的列表。`At Start of Details``Add List Header``Structure``Header and Footers`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T16:17:56.597

制作页眉的最简单方法可能是为页面上的每个列表放入一个包含一列和两行的表格。将列表拖到最后一行，然后在顶部放置一个文本项，其中包含您希望标题显示的任何内容。此外，如果页面上有多个列表，如果您使用 Excel 进行输出，则在它们之间添加一个额外的列会使格式更整洁。

# php - 将 Volt 与 phalcon 一起使用时遇到问题

> ID：13502703
> 
> 赞同：1
> 
> 时间：2012-11-21T21:58:03.660
> 
> 标签：php, phalcon

继承在伏特模板中不起作用的接缝。

> Phalcon 版本是 0.6.1

有一个文件结构：

*   意见/
    *   指数/
        *   索引.html
    *   布局/
        *   main.html
*   索引.php

索引.php：

```
<?php
    $di = new Phalcon\DI\FactoryDefault();
    $di->set('volt', function ($view, $di){
        return new Phalcon\Mvc\View\Engine\Volt($view, $di);
    });

    $view = new \Phalcon\Mvc\View();
    $view->setViewsDir("views/");
    $view->registerEngines(array(
        ".html" => 'volt'
    ));
    $view->setDi($di);
    $view->start();
    $view->render("index", 'index');
    $view->finish();
    echo $view->getContent(); 
```

意见/索引/index.html

```
{% extends "layouts/main.html" %}
{% block content %}
    <h2>Index</h2>
{% endblock %} 
```

视图/布局/main.html

```
<h1>Main</h1>
{% block content %}
    Not index
{% endblock %} 
```

当我跑步时，`php index.php`我得到：

> 未捕获的异常 'Phalcon\Mvc\View\Exception' 带有消息'扩展'layouts/main.html'的模板视图不存在'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:52:13.460

这是因为应用程序无法`main.html`在实际路径中找到文件。如果添加完整路径，它可以工作，但是这样做很不方便。

像这样的东西会起作用

```
{% extends  "../views/layouts/main.html" %} 
```

或者如果您的应用在`app`

```
{% extends  "../app/views/layouts/main.html" %} 
```

我相信应该有一种方法可以直接从 Volt 的设置中引用根路径和/或视图路径。那很可能是NFR。

# .net - Socket SoMo 650/655 设备上的 OpenCFNet 的 LargeIntervalTimer

> ID：13502706
> 
> 赞同：4
> 
> 时间：2012-11-21T21:58:30.277
> 
> 标签：.net, sockets, windows-mobile, opennetcf

我正在开发在 .NET Compact 3.5 上运行的 Windows Mobile 6.1/6.5 应用程序。这个应用程序多年来一直在旧的 HP iPaq 210 上成功运行，但我在让它在 Socket SoMo 655 上运行时遇到了一些麻烦。

除了 OpenNETCF 库的 LargeIntervalTimer 功能外，几乎所有东西都可以正常工作。如果设备与 PC 保持连接，则计时器确实可以工作，但否则设备会进入暂停模式，该计时器无法唤醒。

现在，这就是 LargeIntervalTimer 的全部目的。它唤醒已进入挂起模式的设备，以便它可以执行某种任务。它在 iPaq 上正常工作，将它从看似任何类型的睡眠模式中唤醒。但是，在 SoMo 上，当设备放置足够长的时间以关闭时，计时器不会触发。

有没有人有任何想法？是否有另一种方法可以将设备从我可以在托管代码中使用的任何电源状态唤醒？

* * *

编辑：

感谢 Josef 的有用建议，感谢您不厌其烦地编写测试应用程序。据我所知，该事件已正确添加到数据库中。如果我运行您的应用程序并立即按开始，然后按停止，我会看到有 1 个新条目（由测试应用程序本身创建的条目）。但是，如果我在切换回并按停止之前先按开始，然后打开我自己的应用程序，我会得到 2 个新条目。这对两种设备都是如此，工作的 iPaq 和有问题的 Socket。

我认为问题一定与允许设备进入挂起模式后 Socket 的电源状态有关。当 Socket 通过 USB 连接到我的 PC 时，LargeIntervalTimer 可以正常工作，我认为这是因为设备在连接时永远不会完全进入睡眠状态。但是，如果我拔下设备并允许它进入挂起模式，则计时器根本不会激活。

无论如何，谢谢你的帮助。我仍然对想法持开放态度，但似乎没有一个我刚刚忽略的简单解决方案......

* * *

编辑2：

我注意到 Socket SoMo 655 运行的是 Windows CE，而 Socket SoMo 650（应用程序在其上运行良好）运行的是 Windows Mobile 6.5。这些干扰 OpenNETCF 库的移动操作系统之间是否存在差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T13:53:17.650

OpenNetCF LargeIntervalTimer 使用通知数据库并添加基于时间的事件。

如果此操作失败或通知引擎未触发事件（警报），LargeIntervalTimer 将失败。

我在[https://code.google.com/p/win-mobile-code/source/browse/#svn%2Ftrunk%2FOpenNetCF_LargeTimer](https://code.google.com/p/win-mobile-code/source/browse/#svn%2Ftrunk%2FOpenNetCF_LargeTimer)完成了一个测试应用程序（bin 目录中也有二进制文件）。

![在此处输入图像描述](../Images/5a458100e1f4d18756c7e7ff95fa57cd.png) ![在此处输入图像描述](../Images/37b00f686e7ab5548b92c5c4e02dba43.png)

应用程序启动后，只需单击开始，一个新的 LargeTimer 将被初始化。然后该工具获取通知事件列表并将它们转储到文本框。

当您单击（停止）时，应用程序会停止 LargeTimer 并执行另一个事件列表。然后比较列表，如果有新条目，您将获得内容。

```
 New entry: 889192489, \\.\Notifications\NamedEvents\50f2c337-5b1a-4b78-8923-53df9e009980 
```

OpeneNetCF 似乎不会删除旧条目，它总是创建新的唯一命名事件条目。

如果 LargeTimer 在您的设备上无法正常工作，可能是由于事件未在数据库中输入造成的。使用该工具，您可以验证旧条目和新条目。

~约瑟夫

# c# - SpriteBatch：“在成功调用 End 之前，无法再次调用 Begin。”

> ID：13502708
> 
> 赞同：6
> 
> 时间：2012-11-21T21:58:44.787
> 
> 标签：c#, exception, xna, spritebatch

所以我启动了我当前的项目，我做的第一件事就是运行它，它给了我上面的异常。昨晚运行良好。这是我的 Draw 事件中的所有代码。spriteBatch.Begin 不会出现在项目的其他任何地方。在此处删除 Begin 会导致 spriteBatch.Draw 引发异常，将 spriteBatch.End 放在 begin 之前也会引发异常。我不知道出了什么问题以及如何解决这个问题。

```
GraphicsDevice.Clear(Color.CornflowerBlue);

spriteBatch.Begin();
spriteBatch.Draw(background, Vector2.Zero, Color.White);

player.Draw(spriteBatch);
level1.Draw(spriteBatch);

spriteBatch.End();

base.Draw(gameTime); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T12:19:28.307

您的一个绘图调用可能会引发异常。这将使您在不调用的情况下退出该方法`spriteBatch.End()`，然后在下一次通过时，您会在`spriteBatch.Begin()`. （虽然我想知道为什么第一个异常没有结束你的程序，但第二个却结束了。）

如果这是问题所在，一种解决方案是将绘图调用包装在`try`/`finally`块中：

```
spriteBatch.Begin();
spriteBatch.Draw(background, Vector2.Zero, Color.White);

try {
   player.Draw(spriteBatch);
   level1.Draw(spriteBatch);
} finally {
   spriteBatch.End();
} 
```

另一种可能性是您实际上不小心调用`spriteBatch.Begin()`了两次。`SpriteBatch`就我个人而言，我通过将对象包装在不同的类中来避免这样做。

前任：

```
internal sealed class DrawParams
{
   private SpriteBatch mSpriteBatch;
   private bool mBegin;

   /// <summary>Calls SpriteBatch.Begin if the begin value is true. Always call this in a draw method; use the return value to determine whether you should call EndDraw.</summary>
   /// <returns>A value indicating whether or not begin was called, and thus whether or not you should call end.</returns>
   public bool BeginDraw()
   {
      bool rBegin = mBegin;

      if (mBegin)
      {
         mSpriteBatch.Begin();
         mBegin = false;
      }

      return rBegin;
   }

   /// <summary>Always calls SpriteBatch.End. Use the return value of BeginDraw to determine if you should call this method after drawing.</summary>
   public void EndDraw()
   {
      mSpriteBatch.End();
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:00:38.587

好吧，我需要查看您的 levek1.Draw 和 player.Draw 以获取我的信息，但我对此有何期待。在其中一种方法中，您正在调用`spriteBatch.Begin()`，您必须`End()`在调用它之前调用。

因此，如果您的播放器类绘制方法如下所示

```
Draw(Spritebatch spriteBatch)
{
spriteBatch.Begin();
spriteBatch.Draw(PlayerSprite,PlayerPosition, etc);
spriteBatch.End();
} 
```

您需要删除`Begin`and`End`调用，因为它们已被父方法调用。

编辑：没有读清楚，我看到你相信这不是问题，但我们需要看看其他方法来解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:05:58.377

按下`ctrl+F`并选择，在不属于它`Entire Solution`的地方查找并删除它。`spriteBatch.Begin()`我怀疑您的`player`或`level`抽奖电话中可能有额外的副本。

还要确保你为你的精灵批次使用了正确的变量，它可能被称为`SpriteBatch`，首字母大写。

无论如何，您可以尝试`//`从您的项目中删除（用 注释它们）所有 spritebatch 调用，看看它是否仍然引发异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-18T08:31:14.417

我自己有这个确切的问题，并且没有任何建议在这里起作用。最后，我意识到在我的 Begin / End 部分中，我正在`await`使用一个异步方法。

意识到这可能会在完成之前重新启动该方法，我只是添加了一个`bool isDrawing`变量并在绘制之前检查它。

高温高压

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-23T06:33:35.613

如果您在 spritebatch 忙于绘图时退出它，您将遇到同样的问题。例如，当您从另一个事件（例如计时器）离开屏幕时。

在我的例子中，我声明了一个私有变量来存储 SpriteBatch 是否被中断，

```
private bool _spriteBatchInterrupted = false; 
```

并在 SpriteBatch 不断绘制时检查它，

```
 Game.SpriteBatch.Begin();
    if (_spriteBatchInterrupted)
    {
        Game.SpriteBatch.End();
        return;
    }... 
```

然后在其他事件中设置该变量，例如，计时器已过事件

```
private void CountdownTimer_Elapsed(object sender, ElapsedEventArgs e)
{
   _spriteBatchInterrupted = true;
   NavigateTask();
} 
```

# python - PyQT4 Combobox 改变另一个组合框的列表

> ID：13502710
> 
> 赞同：1
> 
> 时间：2012-11-21T21:58:53.613
> 
> 标签：python, combobox, pyqt4, qt-designer, qcombobox

我刚开始使用 pyqt4 并坚持如何从另一个组合框更改组合框列表。是否有某种类型的示例显示如何使用此方法。

我是否使用 if, else 语句来更改 combobox_2 的选项？

前任。

Combobox_1 有一个 1,2,3 的列表。Combobox_2 具有 a,b,c 或 d,e,f 或 g,h,i 的列表。

如果在 Combobox_1 中选择 1，则 Combobox_2 将显示 a、b、c。

如果在 Combobox_1 中选择 2，Combobox_2 将显示 d,e,f。

如果在 Combobox_1 中选择 3，Combobox_2 将显示 g,h,i。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:41:51.617

你想要做的是这样的：

```
def __init__(self):
    ...
    self.items = {'1':['a','b','c'],'2':['d','e','f'],'3':['g','h','i']}
    self.Combobox_1.activated[str].connect(self.on_combo_activated)
    ...

...

def on_combo_activated(self, text):
    self.Combobox_2.clear()
    self.Combobox_2.addItems(self.items[text]) 
```

# mysql - 使用最大日期的 mySQL 更新值

> ID：13502711
> 
> 赞同：4
> 
> 时间：2012-11-21T21:58:53.707
> 
> 标签：mysql, sql, database

我有这个查询，我希望能够在我的程序完成执行请求时将 exec 值更新为**TRUE**并将其保存到我的数据库中，以便在我有多个执行时将其用作队列，但是，每当我尝试使用这个查询它给了我一个错误。

```
UPDATE motor 
SET exec=1 
where time=(SELECT max(time) 
            FROM motor 
            WHERE exec=0); 
```

错误：

> *ERROR 1093 (HY000): 您不能在 FROM 子句中指定目标表 'motor' 进行更新*

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T22:02:43.790

这是因为您的 UPDATE 可能是循环的。

使用此代码代替：

```
UPDATE motor 
SET exec = 1 
WHERE exec = 0 
ORDER BY time DESC 
LIMIT 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:02:15.950

您必须将其作为两个单独的查询来执行。另外，你为什么不让你的程序跟踪它在队列中工作的“电机”的主键并基于它进行更新？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:07:38.473

您应该将从 SELECT 语句中获得的值分配给如下变量：

```
DECLARE varTime datetime;
SELECT varTime := max(time) FROM motor WHERE exec=0;
UPDATE motor SET exec=1 where time= varTime 
```

我不太确定语法，因为我主要在 MS SQL Server 上工作，但我知道它应该是一样的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-22T07:44:13.387

您接受的答案是正确的。是否也可以通过以下方式获得相同的结果：

```
UPDATE
  motor inner join
  (SELECT max(time) as time
   FROM motor 
   WHERE exec=0) mx on motor.time = mx.time 
SET motor.exec=1; 
```

唯一的区别是，如果有多个具有相同最大值的行，`LIMIT 1`将仅更新其中一行，而这将更新所有行。

# asp.net-mvc - 如何获取带有Json的表中的dropdowlist的选定项目的值

> ID：13502712
> 
> 赞同：0
> 
> 时间：2012-11-21T21:59:04.077
> 
> 标签：asp.net-mvc, json, view, html.dropdownlistfor

我有这张桌子在我看来

```
<table class="tbl" id="tbl">
        <thead>
            <tr>
                <th>
                    Region
                </th>
                <th>
                    Owner
                </th>
            </tr>
        </thead>
        <tbody>
            @if (Model != null)
            {
                foreach (var item in Model.Regions)
                {
                <tr>
                    <td>
                        @Html.DisplayTextFor(i => item.Name)
                    </td>
                    <td>
                        @Html.DropDownListFor(i => item.Users, new SelectList(item.Users, "Id", "Name"))
                    </td>
                </tr>
            }
            }
        </tbody> 
```

我有这个 json 代码来阅读它

```
//This function is used for sending data(JSON Data) to SalesController
function TestFieldSave() {
    // Step 1: Read View Data and Create JSON Object

    var processModel = { "Name": "", "Description": "", "Code": "", "Regions": []};

    var regionModel = { "Name": "", "Users": []};

    var userModel = { "Id": "", "Name": ""};

    var oTable = $('.tbl').dataTable().fnGetData();

    for (var i = 0; i < oTable.length; i++) {

        regionModel.Name  = oTable[i][0];
        userModel.Id      = oTable[i][1];

        regionModel.Users.push(userModel);

        processModel.Regions.push(regionModel);

        userModel = { "Id": "", "Name": ""};

        regionModel = { "Name": "", "Users": []};
   }
    // Step 1: Ends Here

    // Set 2: Ajax Post
    // Here i have used ajax post for saving/updating information
    $.ajax({
        url: '/Process/Create',
        data: JSON.stringify(processModel),
        type: 'POST',
        contentType: 'application/json;',
        dataType: 'json',
        success: function (result) {

            if (result.Success == "1") {
                window.location.href = "/Process/Index";
            }
            else {
                alert(result.ex);
            }
        }
    });
} 
```

这些是我的模型

```
namespace TestingTool.ViewModels
{
    public partial class ProcessModel
    {
        public string Name { get; set; }
        public string Description { get; set; }
        public string Code { get; set; }

        public virtual ICollection<RegionModel> Regions { get; set; }
    }
}

namespace TestingTool.ViewModels
{
    public class RegionModel
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public virtual ICollection<UserModel> Users { get; set; }

    }
}

namespace TestingTool.ViewModels
{
    public class UserModel
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }
} 
```

我无法从 DropDownListFor 中读取。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:34:44.903

我使用淘汰赛 js 做了类似的事情。非常易于使用和快速学习。看看这个演示：

[http://knockoutjs.com/examples/contactsEditor.html](http://knockoutjs.com/examples/contactsEditor.html)

# php - 将 mysql 行显示为单独的 td

> ID：13502713
> 
> 赞同：-2
> 
> 时间：2012-11-21T21:59:07.980
> 
> 标签：php, mysql, sql, database

问题：假设我的 sql 单元格中有以下数据

> “第 1 行<br>第 2 行<br>第 3 行”

如何通过 php 显示它以产生以下结果：

> <td>第 1 行</td><td>第 2 行</td><td>第 3 行</td>。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:04:55.417

就那么简单

```
$string = "line 1<br>line 2<br>line 3";
$arr = explode('<br>', $string);
foreach($arr as $v)
{
    echo '<td>'.$v.'</td>';
// or you can put this to some other string $otherString .= '<td>'.$v.'</td>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:06:13.047

```
<?php
$lines = "line 1<br>line 2<br>line 3";

$arr = explode("<br>", $lines);

foreach($arr as $r)
{
   print("<td>$r</td>");
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:09:33.753

```
$html = "<td>" . implode("</td><td>", explode("<br>", $lines)) . "</td>"; 
```

不那么容易阅读，但避免了循环，这永远不会坏！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T22:09:59.097

```
$string = "line 1<br>line 2<br>line 3";
$arr = explode('<br>', $string);
$result = '<td>'.implode('</td><td>', $arr).'</td>'; 
```

# c# - Win8 IRC 应用程序问题

> ID：13502714
> 
> 赞同：1
> 
> 时间：2012-11-21T21:59:14.260
> 
> 标签：c#, windows-runtime, irc

我一直在尝试为 Windows 8 编写 IRC 客户端应用程序。我遇到了一些问题。我从 pytho 的本教程开始：http: [//oreilly.com/pub/h/1968](http://oreilly.com/pub/h/1968) 生成以下代码（对于 python 3.3）。它设法连接到服务器，被识别并登录，直到我关闭客户端。

```
server = "irc.location.net"
from socket import *

def main():
    s = socket(AF_INET, SOCK_STREAM)
    s.connect((server, 6667))
    readbuffer = ""
    s.send("NICK testIRC\r\n".encode())
    s.send("USER testIRC irc.location.net welcome :Test_IRC\r\n".encode())

    while 1:
        readbuffer = readbuffer + s.recv(1024).decode()
        temp = readbuffer.split("\n")
        readbuffer = temp.pop()

        for line in temp:
            line = line.rstrip();
            tokens = line.split(' ');

            if (tokens[0] == "PING"): 
                print("Got: %s\n" % line);
                response = "PONG %s\r\n" % tokens[1];
                s.send(response.encode())
                print("Sending: %s\n\n" % response)

if __name__ == "__main__":
    main(); 
```

然后我尝试将其移植到 C# (.NET 4.5)，结果如下所示。但是，此代码给出的结果与 Python 代码不同。我认为可能会发生以下情况，但我不确定：服务器无法识别编码（我认为这很奇怪）。为了让一切变得更加奇怪，我得到了 1 个 ping，其中包含一些看起来像键（一些十六进制值）的东西，我当然会用 pong 来响应。在第一次 ping 之后，我什么也没有收到，我也没有在用户列表中列出。但是除了编码问题之外，我想不出任何东西。你们中有人能在我的代码中发现错误吗？提前非常感谢。

```
StreamSocket ss = new StreamSocket();
await ss.ConnectAsync(new HostName(server_address), 6667.ToString());

DataWriter dw = new DataWriter(ss.OutputStream);
DataReader dr = new DataReader(ss.InputStream);
dr.InputStreamOptions = InputStreamOptions.Partial;

// Text related stuff
byte[] bytes;

// register
bytes = enc.GetBytes("NICK testIRC\r\n"); // enc is of type Encoding and is created as an UTF8Encoding.
dw.WriteBytes(bytes);
bytes = enc.GetBytes("USER testIRC irc.location.net welcome :Test_IRC\r\n");
dw.WriteBytes(bytes);
await dw.StoreAsync();
await dw.FlushAsync();

int ping_count = 0;

while (true)
{
    await dr.LoadAsync(512);
    string msg = dr.ReadString(dr.UnconsumedBufferLength);

    string[] lines = msg.Split(new string[]{"\n"}, StringSplitOptions.RemoveEmptyEntries);
    foreach(string line in lines)
    {
        string cmd = line.TrimEnd('\r');

        if (cmd.StartsWith("PING "))
        {
            ping_count++;

            string[] tokens = cmd.Split(' ');

            // Create response
            string response = "PONG " + tokens[1];
            bytes = enc.GetBytes(response);

            dw.WriteBytes(bytes);
            dw.StoreAsync();
            dw.FlushAsync();
        }
    }
} 
```

# c# - System.Web.Mvc ViewModels 的最佳实践是什么

> ID：13502717
> 
> 赞同：1
> 
> 时间：2012-11-21T21:59:20.803
> 
> 标签：c#, asp.net, asp.net-mvc-3, refactoring

我正在从事一个中型 MVC 项目。

视图模型已全部从 Web 程序集中提取到单独的库中。其中一种数据结构由列表框表示，并具有 MultiSelectList 属性。

外部 VM 项目当前没有对 System.Web.Mvc 程序集的引用。

我应该添加参考吗？

我应该重构代码以不引用 MultiSelectList 类吗？如果是这种情况，RawOptionValues 属性在哪里转换为 MultiSelectList？

```
public class SelectListPrompt{

    public IDictionary<string, string> RawOptionValues { get; set; }

    public MultiSelectList OptionValues
    {
        get
        {
            return new MultiSelectList(RawOptionValues.ToList(), "Key", "Value");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:13:54.713

我认为将您的视图模型放在单独的项目中没有任何好处。视图模型必须与您的视图紧密耦合，因此您所做的只是增加复杂性而没有明显的好处。

对于将控制器放在单独项目中的人，我也有同样的感觉。我真的没有看到好处。它没有任何结构或设计优势，只会让事情变得更复杂。

当然，可移植区域除外，但是您将所有内容都放在单独的项目中，而不仅仅是视图或控制器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T22:01:10.770

视图模型与您的视图紧密耦合。这是他们的目的。所以，是的，他们绝对应该知道`System.Web.Mvc`. 您已将它们放在一个单独的类库中 - 很好，但是虽然这可能不是必需的，但如果您决定这样做，这个库应该知道类，如`SelectListItem`, `MultiSelectList`, ... 所以继续添加参考。不要重构您的视图模型——它们应该与这些类一起使用。

您应该注意的是不要将您的域模型与 ASP.NET MVC 耦合。

# sql - 根据 SQL 中的条件对发票进行月份分组

> ID：13502719
> 
> 赞同：0
> 
> 时间：2012-11-21T21:59:27.507
> 
> 标签：sql, sql-server-2008, tsql

我有一张如下所示的发票表：

```
InvoiceDate InvoiceNumber   PaidDate    PayStatus   Amount
-----------------------------------------------------------
2012-1-23   1234            2012-02-28  Unpaid      1234
2012-2-01   2345            2012-03-12  Paid        23456 
```

我需要根据条件对这些进行分组（并取他们每月的总和）。

我想出了一个仅针对当前月份的 WHERE 条款。逻辑是这样的。

*   仅提取发票日期小于或等于上个月最后一天的发票
*   “迟到”不应超过 90 天（迟到 = diff(Period - (InvoiceDt + Terms))）
*   取 unpaid PayStatus 或者如果它被标记为已付款，ActualPaymentdt 应该大于或等于上个月的最后一天
*   如果发票日期的日期部分等于 1 并且属于帐户 4300，则排除它

这仅适用于当前月份（报告上个月的最后一天）。我不知道如何在发票表中为 ALL MONTHS 执行此操作。

```
 -- only extract invoices with invoice dates less than or equal to the last day of the previous month
AND b.InvoiceDt <= DATEADD(dd, -1, DATEADD(MONTH, DATEDIFF(MONTH, 0, GETDATE()), 0))

    -- the 'lateness' should not exceed 90 days (lateness = diff(Period - (InvoiceDt + Terms)))
AND DATEDIFF(day, DATEADD(day, ISNULL(b.Term, 0), b.InvoiceDt), DATEADD(dd, -1, DATEADD(MONTH, DATEDIFF(MONTH, 0, GETDATE()), 0))) <= 90

    -- take either unpaid PayStatus OR if it's marked as paid, ActualPaymentdt should be greater than or equal to the last day of the previous month
AND (b.PayStatus = 'Unpaid' OR b.ActualPaymentDt >= DATEADD(dd, -1, DATEADD(MONTH, DATEDIFF(MONTH, 0, GETDATE()), 0)))

    -- if the day component of invoice date equals 1 AND it belongs to acct 4300, exclude it
AND NOT (b.AccountNumber = 4300 AND DAY(b.InvoiceDt) = 1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:11:45.063

加入另一个包含表中所有月份的派生`invoices`表：

```
CROSS JOIN (SELECT DISTINCT DATEADD(MONTH, DATEDIFF(MONTH, 0, InvoiceDt), 0) as InvoiceMonth 
            FROM invoices) m 
```

然后用`GETDATE()`替换`m.InvoiceMonth`。

并且不要忘记`GROUP BY m.InvoiceMonth`。

# c# - 是否可以访问另一个进程地址空间以访问特定对象实例？

> ID：13502720
> 
> 赞同：4
> 
> 时间：2012-11-21T21:59:30.450
> 
> 标签：c#, windows, com

我不确定这个问题是否有意义，但到目前为止很难找到信息。

我的目标是将一个进程“附加”到另一个已经在运行的进程。我不想调试它们中的任何一个，我只想从最后一个访问对象/上下文。我已经阅读了有关`ICorDebug`接口的信息，并用它实现了一个示例（使用`DebugActiveProcess()`），但无法模拟我想要实现的目标。

我的目标是让一个进程在其中运行一个单例实例，并将这个实例用作第二个进程中的上下文（我有两个程序集和类型信息）。

这是我在这里的第一个问题，请善待=）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:11:49.490

不，您不能访问其他进程地址空间。那将是一个巨大的安全违规。（在旧的 Windows 和 DOS 中你可以）。

共享内存是进程间共享数据的一种方式：[如何在 .NET 中实现共享内存？](https://stackoverflow.com/questions/439787/how-to-implement-shared-memory-in-net)

# highcharts - Highcharts 仍然使用百分比进行 y 轴比较

> ID：13502721
> 
> 赞同：0
> 
> 时间：2012-11-21T21:59:41.597
> 
> 标签：highcharts

在这一点上我很无知，在我的一些图表上，我给出了这些选项：

```
var plotOptions, yAxis;

plotOptions = {
  series: {
    compare: 'value'
  }
};

yAxis = {
  labels: {
    formatter: function() {
      return this.value;
    }
  },
  plotLines: [
    {
      value: 0,
      width: 2,
      color: 'silver'
    }
  ]
}; 
```

并且图表仍然在 y 轴上显示百分比，只是没有 % 符号。我在格式化程序标签中做了一个'this'的console.log，并且value属性是正确的（即返回值而不是百分比，但它似乎没有将它应用于图表。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T22:23:15.027

实际上，我最终只是使用了样条图。基本上我想说的是，y 轴显示的值与我使用“比较：'百分比'”或“比较：'值'”的值相同，但样条图似乎将标签呈现为实际数据点（4000 而不是 25%）。

# xml - log4j2 - 限制日志文件的数量

> ID：13502722
> 
> 赞同：24
> 
> 时间：2012-11-21T21:59:44.270
> 
> 标签：xml, logging, configuration, log4j, log4j2

我有以下 log4j2.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration status="OFF">
  <appenders>
    <RollingFile name="testLog" fileName="test.log" filePattern="" append="false">
      <PatternLayout pattern="[%t] %-5level - %msg%n%n"/>
    <SizeBasedTriggeringPolicy size="5mb" />
    </RollingFile>
  </appenders>
  <loggers>
    <logger name="TestsLogger" level="trace" additivity="false">
      <appender-ref ref="testLog"/>
    </logger>
    <root level="debug">
      <appender-ref ref="testLog"/>
    </root>
  </loggers>
</configuration> 
```

我怎样才能修改这个配置，这样

1.  在达到 5mb 限制后，会创建一个新文件，而不是一遍又一遍地覆盖相同的日志文件。最好有像 test1.log、test2.log 等等。
2.  如何限制在 1\. 中创建的部分日志文件的数量？我想要实现的是如下方案：

    ```
    creating test1.log [present log files: test1.log]
    test1.log - 5mb limit reached
    creating test2.log [present log files: test1.log, test2.log]
    test2.log - 5mb limit reached
    creating test3.log [present log files: test2.log, test3.log]
    test3.log - 5mb limit reached
    creating test4.log [present log files: test3.log, test4.log]
    and so on 
    ```

有谁知道，如何实现这样的目标？当然，如果仅使用 log4j2 就可以实现类似的功能，那就太好了。但是也许有一种方法可以将 log4j2 与某种外部程序结合起来，该程序将与主 Java 应用程序一起运行并删除多余的日志文件，同时保持最后两个日志文件完好无损。因此，如果有人至少对 1\. 提出建议，那可能已经是我正在寻找的东西了。因为我也许可以为第二部分编写程序。当然，如果第二部分也可以使用 log4j2 完成，那将是非常棒的。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-12T22:02:32.700

I never used log4j2 so far but the documentation of the [RollingFileAppender](http://logging.apache.org/log4j/2.x/manual/appenders.html#RollingFileAppender) gives you a lot of configuration examples.

Interesting for you seams to be something like this (using `DefaultRolloverStrategy`):

```
<RollingFile name="RollingFile" fileName="logs/app.log"
             filePattern="logs/$${date:yyyy-MM}/app-%d{MM-dd-yyyy}-%i.log.gz">
  <PatternLayout>
    <pattern>%d %p %C{1.} [%t] %m%n</pattern>
  </PatternLayout>
  <Policies>
    <SizeBasedTriggeringPolicy size="5 MB"/>
  </Policies>
  <DefaultRolloverStrategy max="20"/>
</RollingFile> 
```

# java - 如何重置一副纸牌？

> ID：13502728
> 
> 赞同：0
> 
> 时间：2012-11-21T22:00:11.820
> 
> 标签：java

我正在尝试用一副纸牌制作游戏。目前，我只有一个类，其中包含我使用 add 方法单独添加的卡片 LinkedList。除了在某个时刻，我已经对游戏的其余部分进行了编码，我想像程序刚开始执行时一样将牌组重置为完整的牌组。我将如何以最简单的方式做到这一点？我想将它保存在 LinkedList 结构中，因为我可以使用内置的 shuffle 方法等...

```
public static void main(String[] args) {
LinkedList<String> deck = new LinkedList<String>();
deck.add("2C");
deck.add("3C");
deck.add("4C");
deck.add("5C");
    ... //etc
Collections.shuffle(deck);
System.out.println("Shuffled deck: \n" + deck); 
```

（我想在改变牌组（移除、交易等）后将“牌组”重置回初始状态

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:03:25.077

这个问题最面向对象的解决方案是创建一个`Deck`类。然后在构造函数中初始化`LinkedList`卡片。要“重置”您的牌组，您只需创建一个新`Deck`对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:03:50.863

最简单也是最便宜的方法是使用一套*新*的卡片。

生成一次排序的牌组，然后*在更改之前*制作一个“工作副本”。或者只是通过将该代码放入方法中从头开始创建一个新的`LinkedList<String> newDeck()`！

这是*非常*简单和干净的：

```
LinkedList<String> workingdeck = new LinkedList<String>(masterdeck); 
```

如果您想非常 OOP，请创建一个管理套牌的课程。仍然：要重置，您可能只想创建一个新牌组；通过复制或克隆。

# javascript - “未捕获的类型错误：未定义不是函数”- 初学者 Backbone.js 应用程序

> ID：13502733
> 
> 赞同：42
> 
> 时间：2012-11-21T22:00:37.320
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, backbone.js

我正在使用主干设置一个非常简单的应用程序，但出现错误。

```
Uncaught TypeError: undefined is not a function example_app.js:7
ExampleApp.initialize example_app.js:7
(anonymous function) 
```

这是 Chrome Inspector 中出现错误的地方（初始化文件 - example_app.js）：

```
var ExampleApp = {
  Models: {},
  Collections: {},
  Views: {},
  Routers: {},
  initialize: function() {
    var tasks = new ExampleApp.Collections.Tasks(data.tasks);
    new ExampleApp.Routers.Tasks({ tasks: tasks });
    Backbone.history.start();
  }
}; 
```

这是我的任务 index.haml 文件

```
- content_for :javascript do
  - javascript_tag do
    ExampleApp.initialize({ tasks: #{raw @tasks.to_json} });

= yield :javascript 
```

模型/task.js

```
var Task = Backbone.Model.extend({}); 
```

集合/tasks.js

```
var Tasks = Backbone.Collection.extend({
    model: Task,
    url: '/tasks'
}); 
```

路由器/tasks.js

```
ExampleApp.Routers.Tasks = Backbone.Router.extend({
    routes: {
        "": "index"
    },

    index: function() {
        alert('test');
        // var view = new ExampleApp.Views.TaskIndex({ collection: ExampleApp.tasks });
        // $('body').html(view.render().$el);
    }
}); 
```

这是我正在调用所有文件的证据（我认为）：

```
<script src="/assets/jquery.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery_ujs.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery-ui.js?body=1" type="text/javascript"></script>
<script src="/assets/underscore.js?body=1" type="text/javascript"></script>
<script src="/assets/backbone.js?body=1" type="text/javascript"></script>
<script src="/assets/backbone-support/support.js?body=1" type="text/javascript"></script>
<script src="/assets/backbone-support/composite_view.js?body=1" type="text/javascript"></script>
<script src="/assets/backbone-support/swapping_router.js?body=1" type="text/javascript"></script>
<script src="/assets/backbone-support.js?body=1" type="text/javascript"></script>
<script src="/assets/example_app.js?body=1" type="text/javascript"></script>
<script src="/assets/easing.js?body=1" type="text/javascript"></script>
<script src="/assets/modernizr.js?body=1" type="text/javascript"></script>
<script src="/assets/models/task.js?body=1" type="text/javascript"></script>
<script src="/assets/collections/tasks.js?body=1" type="text/javascript"></script>
<script src="/assets/views/task_view.js?body=1" type="text/javascript"></script>
<script src="/assets/views/tasks.js?body=1" type="text/javascript"></script>
<script src="/assets/views/tasks_index.js?body=1" type="text/javascript"></script>
<script src="/assets/routers/tasks.js?body=1" type="text/javascript"></script>
<script src="/assets/tasks/index.js?body=1" type="text/javascript"></script>
<script src="/assets/tasks/task.js?body=1" type="text/javascript"></script>
<script src="/assets/application.js?body=1" type="text/javascript"></script> 
```

任何想法都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-11-22T00:29:27.197

> Uncaught TypeError: undefined is not a function example_app.js:7

此错误消息讲述了整个故事。在这一行中，您正在尝试执行一个函数。但是，正在执行的不是函数！相反，它是`undefined`.

那么`example_app.js`第 7 行是什么？看起来像这样：

```
var tasks = new ExampleApp.Collections.Tasks(data.tasks); 
```

在那条线上只运行一个函数。我们发现了问题！`ExampleApp.Collections.Tasks`是`undefined`。

因此，让我们看看声明的位置：

```
var Tasks = Backbone.Collection.extend({
    model: Task,
    url: '/tasks'
}); 
```

如果这就是这个集合的所有代码，那么根本原因就在这里。您将构造函数分配给全局变量，称为`Tasks`. 但是您永远不会将它添加到`ExampleApp.Collections`对象中，这是您以后期望它存在的地方。

把它改成这个，我打赌你会很好。

```
ExampleApp.Collections.Tasks = Backbone.Collection.extend({
    model: Task,
    url: '/tasks'
}); 
```

看看正确的名称和行号在弄清楚这一点方面有多重要？永远不要将错误视为二进制（它有效或无效）。而是阅读错误，在大多数情况下，错误消息本身会为您提供需要追踪以找到真正问题的关键线索。

* * *

在 Javascript 中，当你执行一个函数时，它的评估如下：

```
expression.that('returns').aFunctionObject(); // js
execute -> expression.that('returns').aFunctionObject // what the JS engine does 
```

这种表达方式可能很复杂。所以当你看到`undefined is not a function`它意味着表达式没有返回一个函数对象。所以你必须弄清楚为什么你试图执行的不是一个函数。

在这种情况下，这是因为你没有把东西放在你认为你做的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-14T08:51:39.513

我在下面的例子中发生了同样的错误 -

```
async.waterfall([function(waterCB) {
    waterCB(null);
}, function(**inputArray**, waterCB) {
    waterCB(null);
}], function(waterErr, waterResult) {
    console.log('Done');
}); 
```

在上面的瀑布函数中，**我在瀑布 2nd 函数中接受 inputArray 参数。但是这个 inputArray 没有传入 waterCB 中的第一个瀑布函数。**

检查你的函数参数下面是一个正确的例子。

```
async.waterfall([function(waterCB) {
    waterCB(null, **inputArray**);
}, function(**inputArray**, waterCB) {
    waterCB(null);
}], function(waterErr, waterResult) {
    console.log('Done');
}); 
```

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-15T13:08:46.283

[笑话模式开启]

您可以通过添加以下内容来解决此问题：

[https://github.com/donavon/undefined-is-a-function](https://github.com/donavon/undefined-is-a-function)

```
import { undefined } from 'undefined-is-a-function';
// Fixed! undefined is now a function. 
```

[笑话模式关闭]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-09T15:30:31.133

如果在 MongoDB 中使用 async-await ，请在 mongo 调用之前检查是否缺少 await。

```
const [assistantError, assistant] = await assistantDb.findOneAssistant({
      _id: assistantId,
    }); 
```

这里如果缺少等待，以后使用助手时，可能会出现此问题。

# php - 在 23 时将 chrome 版本跟踪到 20

> ID：13502737
> 
> 赞同：0
> 
> 时间：2012-11-21T22:00:55.183
> 
> 标签：php, regex, browser, user-agent, user-tracking

我正在尝试为我的网站进行浏览器跟踪，到目前为止一切顺利。但是当我来到谷歌浏览器时，它只是说我在 Chrome 20.x 中。当我看时，我在 Chrome 23.x 中。

我有 IE 8，代码如下：

```
else if (ereg('MSIE ([0-9].[0-9]{1,2})', $HTTP_USER_AGENT, $log_version)) { 
$browser_version = $log_version[1]; 
$browser_name = "IE";
$browser = $browser_name ." ".$browser_version;} 
```

对于我的 Google Chrome 跟踪器：

```
else if (ereg('Chrome ([0-9].[0-9]{1,2})', $HTTP_USER_AGENT, $log_version)) { 
$browser_version = $log_version[1]; 
$browser_name = "Google Chrome";
$browser = $browser_name ." ".$browser_version;} 
```

在代码之后它会进入我的 MySQL，但如果你尝试它，你可以简单地回显代码。

如何让它跟踪正确的浏览器版本，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:08:31.247

查看我的 Chrome 用户代理，它的格式如下：`Chrome/23.0.1271.64`

因此，您必须从以下位置更改您的 Chrome 正则表达式：

`Chrome ([0-9].[0-9]{1,2})`

至

`Chrome/([0-9]{1,2}.[0-9]{1,2})`

[**例子**](http://codepad.org/FKO58bzz)

# css - 位于同一级别的悬停状态的 CSS 选择器

> ID：13502746
> 
> 赞同：1
> 
> 时间：2012-11-21T22:01:32.857
> 
> 标签：css

我想知道如何编写 CSS 选择器，以便当用户将鼠标悬停在 上时`img.screenshot`，`img.icon`将其 css 更改为`display:block;`.

```
<div class="box">
  <img class="screenshot" src="#">
  <img class="icon"       src="#">
  <p   class="desc">...</p>
</div>

img.icon { display:none; } 
```

到目前为止，我有以下声明，但不确定如何在节点处于同一级别时选择它： `div.box > img.screenshot:hover`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:02:57.210

简单的兄弟选择器：

[相邻兄弟选择器](https://developer.mozilla.org/en-US/docs/CSS/Adjacent_sibling_selectors)

```
img.screenshot:hover + img.icon { /* styles here */ } 
```

[通用兄弟选择器](https://developer.mozilla.org/en-US/docs/CSS/General_sibling_selectors)

```
img.screenshot:hover ~ img.icon { /* styles here */ } 
```

# delphi - 使用 TIDNotify 的内存泄漏，线程安全的 VCL 交互

> ID：13502748
> 
> 赞同：0
> 
> 时间：2012-11-21T22:01:51.990
> 
> 标签：delphi, memory, memory-leaks, indy

以下代码用于允许来自 INDY 10 tcpserver.onexecute() 的线程安全 VCL 交互；

```
///  a function to write information into a TBitmap 
TVclNavigationImage= procedure( ll, ur, ll_v , ur_v : TPoint ) of object;

TVCLUpdateNotify = class(TIdNotify)
 protected
 f_ll, f_ur, f_ll_v , f_ur_v  : TPoint;
 FProc: TVclNavigationImage;
 procedure DoNotify; override;
 public
 constructor Create(ll, ur, ll_v , ur_v : TPoint; aProc:TVclNavigationImage); reintroduce;
 class procedure UpdateNavigationWindow(ll, ur, ll_v , ur_v : TPoint ; aProc: TVclNavigationImage);
 end;

 class procedure TVCLUpdateNotify.UpdateNavigationWindow(ll, ur, ll_v , ur_v : TPoint ; aProc: TVclNavigationImage);
 begin
 with Create(ll, ur, ll_v , ur_v, aProc) do
     begin
     Notify;
     end;
end; 
```

在 Onexecute 函数中有

```
procedure TForm1.IdTCPServerExecute(AContext: TIdContext);
begin
    ....
    TVCLUpdateNotify.UpdateNavigationWindow(....)
    ....
 end; 
```

根据 MA​​DSHI 调试器，serveronexecute() 中的这行代码会造成内存泄漏。我的班级里没有免费的功能。如何使该代码内存泄漏免费？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T00:21:42.920

确保您使用的是最新版本的 Indy 10。在旧版本中，`TIdNotify`确实存在内存泄漏，但在 10 个月前已修复。

# haskell - 在小于 O(n) 的非常大的列表中找到元素

> ID：13502749
> 
> 赞同：-1
> 
> 时间：2012-11-21T22:01:52.060
> 
> 标签：haskell

我想在 O(1) 而不是 O(n) 中检查一个元素是否存在于列表中（一个非常大的 10,000,000 顺序）。带 O(n)的列表`elem x ys`所以我想使用另一种数据类型/构造函数，但它必须在`Prelude`（不是数组）中；有什么建议么？如果我必须构建我的数据类型，它会是什么样子？

还可以以相同的顺序（10,000,000）对大量数字进行排序，并在尽可能短的时间内索引一个元素。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T22:12:20.383

在 O(1) 时间内在数据集中搜索项目的唯一方法是，如果您已经知道它在哪里，但您不需要搜索它。对于未排序的数据，搜索是 O(n) 时间。对于排序的数据，搜索是 O(log n) 时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T22:17:30.523

You should use either [Bloom filter](http://en.wikipedia.org/wiki/Bloom_filter) or [Hashtable](http://en.wikipedia.org/wiki/Hashtable). Neither of them is in Prelude; moreover, both rely on Array to be available.

The only left option is some kind of tree; I would suggest [heap](http://en.wikipedia.org/wiki/Heap_%28data_structure%29). It’s not hard to implement and it also gives you sorting for free.

UPDATE: oops! I have forgotten that heap doesn’t provide lookup. [BST](http://en.wikipedia.org/wiki/Binary_search_tree) is your choice, then.

# android - 从 onClick 类开始活动

> ID：13502752
> 
> 赞同：0
> 
> 时间：2012-11-21T22:02:03.807
> 
> 标签：android, android-intent

我有一个要分配给的按钮`OnClickListener`。因此，我想开始一个新的意图。为此，我必须参考活动。我唯一知道如何做到这一点的是通过以下代码。这是从按钮单击开始意图的最佳方式吗？此外，这会产生什么样的记忆影响？

```
public class SomeActivity extends FragmentActivity  {

    private final FragmentActivity self=this;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);
        findViewById(R.id.startButton).setOnClickListener(new View.OnClickListener(){
            public void onClick(View v) {
                Intent intent=new Intent(self,someClass.class);
                startActivity(intent);
            }
        });

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:19:00.623

最好的方法是简单地通过`ActtivityName.this`，如下所示：

```
public class SomeActivity extends FragmentActivity  {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);
        findViewById(R.id.startButton).setOnClickListener(new View.OnClickListener(){
            public void onClick(View v) {
                Intent intent=new Intent(SomeActivity.this,someClass.class);
                startActivity(intent);
            }
        });

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:17:37.300

Another way to do this will be calling :
`findViewById(R.id.startButton).setOnClickListener(this);`
Then make your `Activity` implement `View.OnClickListener` and implement the methods `onClick(View v)` in this way :

```
public void onClick(View v) {
    switch(v.getId()) {
        case R.id.startButton:
            Intent intent=new Intent(self,someClass.class);
            startActivity(intent);
            break;

        // Handle click on other views

    }
} 
```

It prevents from instantiating a listener and should be a bit better for memory consumption.

# c# - 从树（图表）中获取有序列表的最有效方法是什么？

> ID：13502754
> 
> 赞同：-1
> 
> 时间：2012-11-21T22:02:09.027
> 
> 标签：c#, algorithm, tree, diagram

我正在使用一个图表控件，其中包含一个节点，该节点带有指向其父级和子级的链接。我想把树弄平，但要按顺序。最快、最有效的方法是什么？最好在 C# 中。

这是一个树的例子。我很难想出一个好的订单描述，所以我很抱歉。该顺序应按创建顺序列出所有节点。例如，在树吹中，有效的顺序是 (Root,A,B,C,G,D,H,E,F)。此顺序保证在其父节点之前不会将节点添加到列表中。

![演示我的问题的简单图表](../Images/743d01030e41f7598ba4a2d813a1a35a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T12:45:03.477

您的图不是树，因为一个节点可以有多个父节点。我假设你有一个有[向无环图（DAG）](http://en.wikipedia.org/wiki/Directed_acyclic_graph)。您的有序列表称为该有向图的[拓扑排序](http://en.wikipedia.org/wiki/Topological_sorting)，当且仅当该图是无环的时才存在。幸运的是，这样的排序可以通过线性运行时间产生。

您可以使用从根开始的深度优先搜索来执行此操作：

```
public static IEnumerable<Node> GetTopologicalGraphOrdering(IEnumerable<Node> roots)
{
    var list=new List<Node>();
    var visited=new HashSet<Node>();

    Action<Node> visit = null;
    visit = (n)=>
    {
       if(visited.Add(n)
       {
           foreach(Node child in n.Children)
           {
               visit(child);
           }
           list.Add(n)
       }
    }

    foreach(Node n in roots)
    {
       visit(n);
    }

    return list.Reverse();
} 
```

（未经测试的记事本代码）

请注意，这种幼稚的实现将导致深度图的堆栈溢出。如果出现问题，请切换到显式堆栈或替代算法。

阅读维基百科文章[拓扑排序](http://en.wikipedia.org/wiki/Topological_sorting)了解更多详情。

# java - 如何最好地计算对象属性的总和？

> ID：13502759
> 
> 赞同：5
> 
> 时间：2012-11-21T22:02:16.517
> 
> 标签：java

如果一个对象`car`有一个属性`fuel`，并且我有一个这些对象的列表`cars`：我怎样才能最好地计算`getCarsFuel()`列表中所有对象的这个属性的总和？

```
class CarStock {
    List<Car> cars;

    public int getCarsFuel() {
        int result = 0;     

        for (Car car : cars) {
            result += car.getFuel();
        }

        return result;
    }
}

class Car {
    int fuel;
} 
```

有没有更好的方法，或者不能少做“样板”。我可以想象像`sum(List<T> list, String property)`->之类的东西`sum(cars, "fuel")` ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T22:32:00.190

如果您可以使用[lambdaj](https://code.google.com/p/lambdaj/)，您可以编写如下内容：

```
import static ch.lambdaj.Lambda.*;

List<Car> cars = ...;
int result = sumFrom(cars).getFuel(); 
```

有关如何使用 lambdaj 的更多示例，请参阅 lambdaj wiki 上的[功能](https://code.google.com/p/lambdaj/wiki/LambdajFeatures)页面。

# apache-camel - 部署到 ServiceMix 时 errorHandler 的 NoSuchMethodError

> ID：13502760
> 
> 赞同：1
> 
> 时间：2012-11-21T22:02:24.007
> 
> 标签：apache-camel, apache-servicemix

我有一个 servicemix 模块，它基本上是一个基于骆驼的路线。

它在开发过程中以及在旧版本的 FUSE 中部署时都可以正常工作。但是，在 FUSE 的更高版本中部署时，我得到

> 引起：java.lang.NoSuchMethodError: com.company.integration.MyRouteBuilder.errorHandler(Lorg/apache/camel/builder/ErrorHandlerBuilder;)Lorg/apache/camel/builder/RouteBuilder;

我不太明白为什么:-)

老版本使用camel 2.6，新版本使用camel 2.9。据我所知，两者都有 RouteBuilder.errorHandler ..

br

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:44:52.663

我不会花太多时间尝试自己解决这个问题......我只是开始使用与我将部署它的相同版本的 Camel 开始测试......否则即使你解决了这个问题，其他人可能会弹出，等等。

如果您确实需要运行依赖于不同版本的 Camel 的多个应用程序，那么 OSGi 支持这一点，只要安装必要的骆驼包版本并正确设置您的应用程序包清单等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T18:55:11.833

重新安装（或者更确切地说，重新创建实例）有所帮助。

# ios - 如何在 Passbook 卡背面列出我的应用程序？

> ID：13502763
> 
> 赞同：3
> 
> 时间：2012-11-21T22:02:33.757
> 
> 标签：ios, passbook

新的 SPG Passbook 卡在卡的背面列出了他们的 iOS 应用程序，就像 Mobile Safari 现在可以为拥有应用程序的网站显示横幅一样。示例截图：

![在此处输入图像描述](../Images/47ad8ac6481217d7b4029e7371361402.png)

我无法在 Apple 的（稀疏）文档中找到有关如何连接它们的任何内容。奇怪的是，他们的 Passbook 卡甚至没有通过他们的应用程序安装，它只能在屏幕上显示您 SPG 卡的图像。您需要在 iOS 上访问[http://spg.com/passbook](http://spg.com/passbook)进行安装，这表明不是操作系统在确定连接。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T00:32:20.347

弄清楚了！我设法下载了 SPG .pkpass 文件并查看了 pass.json。他们使用：

“关联商店标识符”：[XXXXXXXXX]

其中 XXXXXXXXX 是您的应用的 Apple ID。试了一下，效果很好。它应该与您的 passTypeIdentifier 等一起在您的低级字典术语之外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T00:23:00.923

我认为您可以在 Apple Dev Center 中进行设置。该位置与您启用应用内购买、推送通知等的位置相同。

# ruby-on-rails - 设计如何将 current_user 传递给 confirm_instructions 邮件程序

> ID：13502767
> 
> 赞同：5
> 
> 时间：2012-11-21T22:02:45.580
> 
> 标签：ruby-on-rails, devise

我已经设计好并且工作得很好。我正在使用可确认并已根据他们的 2 步注册流程指南进行了修改：

[在确认时设置密码](https://github.com/plataformatec/devise/wiki/How-To%3a-Override-confirmations-so-users-can-pick-their-own-passwords-as-part-of-confirmation-activation)

我有最后一个要求，我遇到了麻烦。

我们有两个场景

1) 用户可以注册为新用户

2）登录用户（current_user）可以创建一个新用户。当登录用户创建新用户时，我希望能够将他们的电子邮件添加到发送给新创建用户的确认电子邮件中

在发给新注册用户的电子邮件中，如果用户是由登录的用户创建的，我需要以某种方式传入 current_user.email。然后我会做一个简单的 if 检查并在电子邮件中添加一些额外的文本。

当前的confirmation_instructions.html.erb：

```
<p>Welcome <%= @resource.email %>!</p>

<p>You can confirm your account email through the link below:</p>

<p><%= link_to 'Confirm account', confirmation_url(@resource, :confirmation_token => @resource.confirmation_token) %></p> 
```

我需要的是类似

```
<p>Welcome <%= @resource.email %>!</p>

<% if !@user.email.nil? %>
   <p> some additional welcome text here from <%= @user.email %> </p>
<% end %>

<p>You can confirm your account email through the link below:</p>

<p><%= link_to 'Confirm account', confirmation_url(@resource, :confirmation_token => @resource.confirmation_token) %></p> 
```

我一直在用自定义邮件来回走动，没有任何乐趣。有人可以帮助我吗，我相信我在这里缺少一些简单的东西。

对于信息（我知道这不是最好的方法，但我们将一个非常快速的应用程序放在一起用于演示目的）用户通过输入我的电子邮件地址来创建一个新联系人。如果用户表中不存在电子邮件地址，则会创建一个新用户，然后创建联系关系（控制器的片段）：

```
class DashboardController < ApplicationController
     before_filter :authenticate_user!

  def show
    @contacts = current_user.contacts
  end

  def createcontact
    user2 = User.find_by_email(params[:contact_email])
    if user2.nil?
            newContact = User.create(:email => params[:contact_email])
            if newContact.save
                 current_user.newUserContact(newContact)
                 redirect_to dashboard_path, :notice => "conact has been saved as well as a new contact"
            else
                redirect_to dashboard_path, :notice => "ERROR saving contact"
            end
    else
      .
      .
      .
      . 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T14:25:30.797

[按照本教程](https://github.com/plataformatec/devise/wiki/How-To%3a-Use-custom-mailer)设置自定义邮件程序。

在 config/initializers/devise.rb 中：

```
config.mailer = "UserMailer". 
```

在文件夹 app/mailers 中创建一个继承自 Devise 邮件程序的新邮件程序：

```
# user_mailer.rb
class UserMailer < Devise::Mailer

  def invite(sender, recipient)
    @sender = sender
    @recipient = recipient

    mail( :to => recipient.email,
          :subject => "Invite by #{sender.name}"
        )
  end
end 
```

现在，将您的设计邮件视图移动到文件夹 app/views/user_mailer。在那里创建一个新的电子邮件视图，您可以在其中使用变量@sender 和@recipient。

```
# invite.html.erb
<p>Welcome <%= @recipient.email %>!</p>

<% if @sender.email? %>
  <p> some additional welcome text here from <%= @sender.email %> </p>
<% end %> 
```

现在，在您的控制器中，您可以调用以下命令：

```
UserMailer.invite(current_user, newContact).deliver 
```

# python - Python，如何在多个无限循环之间进行交换？

> ID：13502771
> 
> 赞同：3
> 
> 时间：2012-11-21T22:03:02.287
> 
> 标签：python, loops, break

有人可以指出我正确的方向吗？

我正在尝试在 python 中的多个无限控制循环之间进行交换。我需要终止一个循环，然后根据来自外部源（希望是 Web 界面）的请求选择一个不同的循环，而不是基于内部条件。我知道这是一个模糊的问题，但我需要一个正确的方向来让我开始，我已经查看了异常、信号和线程，但我正在努力寻找什么是“正确”的方法来做到这一点。

请注意，我在电子行业工作而不是编程，如果这听起来很愚蠢，我很抱歉。此外，如果这完全是解决问题的错误方法，有人可以建议我正确的方法。

如果有人可以帮助我并在需要时发布代码，我可以提供更多信息/解释，但我认为由于问题的模糊性，目前这无关紧要。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:17:43.833

我猜您有两个（或更多）程序要重复运行，并允许在用户选择新条件时更改它们。我会利用 Python 将函数作为对象，所以像这样：

```
def f1():
    # do something
def f2():
    # do something else

func_to_run = {"user_input1": f1, "user_input2": f2}

while True:
    user_input = get_any_new_input()  # however you want to get your user input
    func_to_run[user_input]() 
```

编辑：正如 Keith 在评论中提到的， get_any_new_input 需要是非阻塞的。我会通过线程来做到这一点。Web 界面应位于与循环不同的线程上，但共享 Web 界面将设置的控制对象。如果您有可用的表，这可能是数据库中的表。如果您使用自己的锁，它可能看起来像这样：

```
L = threading.Lock()  # Shared by web ui
user_response = 'data set by web ui'
last_input = 'user_input1'

def get_any_new_input(L, last_input, user_response):
    if L.acquire([False]):
        last_input = user_response
    return last_input 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:06:51.713

最简单的方法可能只是读取一些控制循环的文件......

```
while True:
    #loop1
    while True:
       #do something
       with open("some.file") as f:
            if f.read() == "loop2":
                break
     #loop2
     while True:
        #do something
        with open("some.file") as f:
            if f.read() == "loop1":
                break 
```

然后只需将您想要的循环放在“some.file”中（但是您想要......网络界面等）

# powershell - 在自定义模块中使用时，Import-Pssession 不导入 cmdlet

> ID：13502776
> 
> 赞同：6
> 
> 时间：2012-11-21T22:03:31.740
> 
> 标签：powershell, powershell-3.0

我有一个 PowerShell 脚本/函数，当我在我的 PowerShell 配置文件中使用它或在 PowerShell 窗口中手动复制/粘贴该函数时效果很好。

我正在尝试使我团队的其他成员可以作为一个模块访问该功能。我希望将模块存储在一个中心位置，以便我们都可以将它添加到我们的 PSModulePath。

这是基本功能的副本：

```
Function Connect-O365{
    $o365cred = Get-Credential username@domain.onmicrosoft.com
    $session365 = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://ps.outlook.com/powershell/ -Credential $o365cred -Authentication Basic -AllowRedirection
    Import-PSSession $session365 -AllowClobber
} 
```

如果我将此函数保存在我的 PowerShell 配置文件中，它可以正常工作。我可以在其中包含此函数的 *.ps1 脚本，它也可以工作。

问题是当我将函数另存为 *.psm1 PowerShell 脚本模块时。该函数运行良好，但 Import-PSSession 中导出的命令均不可用。我认为这可能与模块范围有关。

我正在寻找有关如何解决此问题的建议。

### 编辑

当我创建以下模块并运行 Connect-O365 时，导入的 cmdlet 将不可用。

```
$scriptblock = {
    Function Connect-O365 {
        $o365cred = Get-Credential username@domain.onmicrosoft.com
        $session365 = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri "https://ps.outlook.com/powershell/" -Credential $o365cred -Authentication Basic -AllowRedirection
        Import-PSSession $session365 -AllowClobber
    }
}

New-Module -Name "Office 365" -ScriptBlock $scriptblock 
```

当我导入没有 Connect-O365 功能的下一个模块时，导入的 cmdlet 可用。

```
$scriptblock = {
    $o365cred = Get-Credential username@domain.onmicrosoft.com
    $session365 = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri "https://ps.outlook.com/powershell/" -Credential $o365cred -Authentication Basic -AllowRedirection
    Import-PSSession $session365 -AllowClobber
}

New-Module -Name "Office 365" -ScriptBlock $scriptblock 
```

这似乎是某种范围的问题，只是不知道如何解决它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-20T12:50:47.983

在 TechNet 的帮助下，我能够修改脚本模块，使其按我预期的方式工作。

```
function Connect-O365 {
    $o365cred = Get-Credential username@domain.onmicrosoft.com
    $session365 = New-PSSession `
                    -ConfigurationName Microsoft.Exchange `
                    -ConnectionUri "https://ps.outlook.com/powershell/" `
                    -Credential $o365cred `
                    -Authentication Basic `
                    -AllowRedirection 
    Import-Module (Import-PSSession $session365 -AllowClobber) -Global
} 
```

[技术网邮报](http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/529bd0ef-5e88-4808-a5ac-dc07ca8660f3/#517c8111-54c6-4f32-b9ae-bb73c9ebc138)

# php - 使用链接将控制权传递给另一个页面不会将变量发送到另一个页面

> ID：13502777
> 
> 赞同：1
> 
> 时间：2012-11-21T22:03:33.213
> 
> 标签：php, html

由于我是新手，我可能会做很多错误的步骤，并且会犯一些我无法弄清楚的错误。第一个设置uid，pwd。第二个设置 fname。下面的行是由以下代码创建的：

```
 session_start();
if (isset($_POST['fname']))
{
$uid    =   $_POST['uid'];                  #   $uid contains "myname"
$pwd    =   $_POST['pwd'];                  #   $pwd contains "myapss"
$fname  =   $_POST['fname'];            #   $fname contains "john doe"    as expected...
echo $uid.$pwd.$fname;              #   This echo confirms that the variavbles were received (debugging only)
$_SESSION   = $uid;             #------------------
}
else
whatever 
```

这就是我遇到麻烦的地方：我将 < href= 设置如下：（“a”已从该帖子中删除，因为它是保留字）。

```
 $hrefed     =   ('<  href="edit_user.php?');
$hrefed     .=  ("{id='$uid' ,");
$hrefed     .=  ("pwd='$pwd' ,"); 
$hrefed     .=  ("fname='$fname'}"); 
$hrefed     .=  ('">Edit Selected Info</a>'); 
```

它转化为：

```
 <  href="edit_user.php?{id='myname' ,pwd='mypass' ,fname='john doe'}">Edit Selected  Info</a> 
```

单击创建以将控制权传递给另一个程序的链接时，我收到未发布任何变量的消息。有人可以给我一些想法将调用参数设置到其他页面的正确方法是什么

谢谢你，祝你感恩节愉快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:08:25.660

尝试这个：

```
$hrefed     =   ('<a href="edit_user.php?');
$hrefed     .=  ("&id=$uid");
$hrefed     .=  ("&pwd=$pwd"); 
$hrefed     .=  ("&fname=$fname"); 
$hrefed     .=  ('">Edit Selected Info</a>'); 
```

您在此处创建的内容称为 GET 查询字符串。在这里阅读更多：[http ://en.wikipedia.org/wiki/Query_string](http://en.wikipedia.org/wiki/Query_string)

此外，在您的脚本中使用`$_GET`而不是：`$_POST`

```
if (isset($_GET['fname']))
{
$uid    =   $_GET['uid'];                  #   $uid contains "myname"
$pwd    =   $_GET['pwd'];                  #   $pwd contains "myapss"
$fname  =   $_GET['fname'];            #   $fname contains "john doe"    as expected...
echo $uid.$pwd.$fname;              #   This echo confirms that the variavbles were received (debugging only)
$_SESSION   = $uid;             #------------------
} 
```

在此处阅读有关 HTTP 请求方法的更多信息：[http ://en.wikipedia.org/wiki/GET_(HTTP)#Request_methods](http://en.wikipedia.org/wiki/GET_(HTTP)#Request_methods)

这些将解决您眼前的问题。

更严重的问题是**您不应该只在网页上打印用户密码**。你甚至不应该*存储*密码，只存储它的哈希值。如果这只是一个爱好项目，那没关系，但请记住在制作真实网站之前对基本的网络安全进行一些研究。

看：

*   [如何在 PHP 中使用 bcrypt 对密码进行哈希处理？](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)
*   [每个程序员都应该了解 Web 开发什么？](https://softwareengineering.stackexchange.com/questions/46716/what-should-every-programmer-know-about-web-development)

# android - 在模拟器上将联系人读取为电子名片

> ID：13502784
> 
> 赞同：1
> 
> 时间：2012-11-21T22:03:51.257
> 
> 标签：android

这是代码片段（我试图将其最小化，只是为了显示问题。这就是 Uri 被硬编码的原因。当用户对联系人执行“共享”时，真实代码从联系人应用程序接收 Uri）。

```
 Uri uri = Uri.parse("content://com.android.contacts/contacts/as_vcard/0r1-47532F494753492F475349532F492F53492F3D533B49393B3D47532F");
    try {

        InputStream fis = getContentResolver().openInputStream(uri);

        byte[] buffer = new byte[1024];
        fis.read(buffer);
    } catch (Exception e)
    {
        Log.d("zzz", e.getMessage());
    } 
```

此类代码仅在模拟器上的 fis.read 操作上抛出“java.io.IOException: read failed: EINVAL (Invalid argument)”（并且在真实设备上工作正常）。我在 Android 4.0.3 和 4.1.2 模拟器上试过（都失败了）

我看到了一个类似的问题（这个问题的描述）： [Android read failed exception when trying to read vCard contact data](https://stackoverflow.com/questions/12097692/android-read-failed-exception-when-trying-to-read-vcard-contact-data)

还有一个错误，可能相关（或不相关）： [http ://code.google.com/p/android/issues/detail?id=26480](http://code.google.com/p/android/issues/detail?id=26480)

我在模拟器上运行自动化测试，这个问题阻止我运行几个测试。

两个问题：

a) 你见过这种行为吗？

b）您知道此问题的任何解决方法吗？

# javascript - 在 CoffeeScript 中测试对象相等性？

> ID：13502788
> 
> 赞同：9
> 
> 时间：2012-11-21T22:04:03.897
> 
> 标签：javascript, object, comparison, coffeescript, equality

有没有一种简单的方法来测试 CoffeeScript 中对象的相等性？

或者更正确 - 测试两个对象的属性是否相同。

使用这些对象：

```
obj1 =
  name: "John Doe"
  age: "3.14"

obj2 =
  name: "John Doe"
  age: "3.14" 
```

正如预期的那样，这评估为假：

```
obj1 == obj2 
```

现在我正在使用[下划线的 isEqual](http://underscorejs.org/#isEqual)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-21T22:23:51.477

没有。CoffeeScript 没有将此作为语言功能提供，因此使用像 Underscore.js 这样的库是您的最佳选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-10T18:34:31.793

您可以使用旧的备用：

```
JSON.stringify(obj1) == JSON.stringify(obj2) 
```

这将完成这项工作 - 但对于某些工作来说可能效率太低。

您还可以将任意对象转换为一个类，并在该类上提供一个 equals 方法。

```
class Person
  constructor: (@name, @age) ->

  equals: (other) -> @name == other.name && @age == other.age 
```

# php - 使用 codeigniter 处理 Paypal 付款

> ID：13502792
> 
> 赞同：1
> 
> 时间：2012-11-21T22:04:29.627
> 
> 标签：php, codeigniter, paypal

我正在寻找可用于向 PayPal 付款的简单库或脚本。我下载了几个库，它们都非常复杂，并且有很多我不需要的功能。我只是想要一种方法来拥有一个按钮（立即付款），当他们点击它时，他们会被重定向到贝宝，付款，然后返回我的网站，这样我就可以将数据保存到数据库中。任何人都可以推荐一个好的简单库或教程吗？

新的 PayPal API 还能实现吗？换句话说，我是否需要注册一个 API 帐户才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:15:03.210

这些可能不像您正在寻找的那么简单，但它们工作得很好，在代码中都有很好的记录，并且开发人员对评论以及这里的 SO 都非常敏感。

[http://www.binpress.com/app/paypal-adaptive-payments-pro-payflow-codeigniter-library/140](http://www.binpress.com/app/paypal-adaptive-payments-pro-payflow-codeigniter-library/140) http://www.binpress.com/app/php-paypal-pro-adaptive-payflow-api -类/612

从我的工作来看，贝宝是一种痛苦，但这些库有助于减轻痛苦。

# ruby-on-rails - 如何在 rails_admin 中自定义编辑和更新操作

> ID：13502796
> 
> 赞同：10
> 
> 时间：2012-11-21T22:04:38.760
> 
> 标签：ruby-on-rails, customization, rails-admin, controller-action

我正在使用 rails_admin，我认为它很棒。不幸的是，我无法覆盖特定模型上的特定操作。我只需要覆盖一个模型上的编辑和更新行为。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-22T00:36:20.040

我不知道您过去尝试过什么，如果您发布它会很有帮助，但您不能尝试这个

```
config.model 'Model' do
  edit do
    ....
  end

  update do
    ....
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-26T11:02:05.807

好吧，考虑到你想要做什么。我相信您也可以使用 ROR 回调来实现它，这会容易得多。

所以在你的模型文件中

```
after_update :custom_action

#define custom_action in the same model
def custom_action
  #your code goes here
end 
```

您可能必须检查此操作是否由管理员执行，仅此而已。

抱歉迟到了4年。但这可能对其他人有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-03T22:06:44.840

您可以通过点击审核支持来添加其他更新行为。

就我而言，我需要记录特定模型上的某些字段何时更改，以及进行更改的用户。我通过以下方式实现了这一目标：

```
RailsAdmin.config do |config|
  config.audit_with { @auditing_adapter = MyAuditor.new(self) }
end

class MyAuditor
  def update_object(object, _abstract_model, user, changes)
    if object.is_a?(SomeModel)
      changes = changes.slice(:important_field, :other_important_field)
      if changes.present?
        # ... log change ...
      end
    end
  end

  # other auditor methods (unused)
  def initialize(_controller) end
  def create_object(_object, _abstract_model, _user) end
  def delete_object(_object, _abstract_model, _user) end
  def latest() end
  def listing_for_object(*_args) end
  def listing_for_model(*_args) end
end 
```

# android - 如何在我的自定义视图（扩展视图）上在 Android 中绘制一个透明的矩形？

> ID：13502800
> 
> 赞同：0
> 
> 时间：2012-11-21T22:04:48.650
> 
> 标签：android, pixel, transparent

如何绘制一个基本上在画布上创建一个洞的矩形？例如，假设我有一个为像素艺术设计的图像编辑应用程序。用户触摸屏幕的一个区域，并绘制一个紫色矩形。糟糕，他把矩形放错了位置。用户需要使这个紫色方块再次变为透明，以便他可以在正确的位置重新绘制它。

我该怎么做呢？我使用过 PorterDuff.Mode.Clear、myPaintColor.setColor(Color.TRANSPARENT) 等，但都给出了相同的结果。一个丑陋的黑色方块，它应该是透明的。我的画布一开始是透明的，可以通过 getDrawingCache 保存为透明的 .PNG，所以我知道画布一开始是透明的。但是我如何帮助绘制紫色方块的用户使他的画布再次透明？谢谢。我整天都在试图弄清楚这一点，阅读了所有关于此的文档，但我无法弄清楚。

这是我所拥有的：

```
 Rect square = new Rect();
            Paint drawColor = new Paint();
            //drawColor.setColor(UserColor.get(i));
            drawColor.setXfermode(new PorterDuffXfermode(Mode.CLEAR));
            square.set(CanvasFractionWidth * UserX.get(i), CanvasFractionHeight * UserY.get(i), (CanvasFractionWidth * UserX.get(i)) + (CanvasFractionWidth), (CanvasFractionHeight * UserY.get(i)) + CanvasFractionHeight);
            canvas.drawRect(square, drawColor); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:28:57.540

在[RoboDemo](https://github.com/stephanenicolas/RoboDemo)中，我使用这个：

```
 Paint p = new Paint();
        p.setXfermode( new PorterDuffXfermode( Mode.CLEAR ) ); 
```

# iphone - ios - 我可以使用来自另一个 ViewController 的 IBAction 吗？

> ID：13502801
> 
> 赞同：1
> 
> 时间：2012-11-21T22:04:50.340
> 
> 标签：iphone, ios, uiviewcontroller, custom-controls

我正在使用情节提要，其中有 2 个自定义视图。

现在，如果我在主视图上有一个按钮，那么我可以移动嵌入的视图，但如果按钮在自定义视图上，我将无法获得相同的效果。是的，我可以移动我所在的视图控制器的视图，但我无法控制父控制器的操作。

这是不可能的，还是我看错了？

请观察图像，我将解释我想要实现的目标：

![我的故事板](../Images/a80b111509a92247d2dd89e2e1f2c274.png)

请注意我见过这个问题：[Passing an IBAction to another ViewController](https://stackoverflow.com/questions/12763470/passing-an-ibaction-to-another-viewcontroller) 这在我的设置中似乎不起作用。

好的，所以 Main Right 和 Main Left 可以按预期工作 - 它们将 Right SideVC 向右移动并显示左右。

现在我希望这些行为发生在右侧 VC 和左侧 VC 上，因为我想删除 Main Right 和 Main Left 按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:21:08.437

IBAction 只是 void 类型的方法，它不返回任何内容。放置名称 IBAction 只是为了简化接口的连接。因此，它类似于其他方法。只要对象在附近（在这种情况下为视图控制器），您就可以调用它响应的任何方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-22T08:30:48.210

所以我能够通过使用 AppDelegate 解决我的问题。我在几篇文章中读过它并不总是放置东西的最佳位置，但对此我认为还可以:-)

```
-(IBAction)move03
 {
    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    MainViewController* viewController = appDelegate.viewController;
    [_move01Button addTarget:viewController action:@selector(move01Action) forControlEvents:UIControlEventTouchUpInside];
 } 
```

# ruby-on-rails - 标准化文件名的字符串，删除重音符号和特殊字符

> ID：13502803
> 
> 赞同：6
> 
> 时间：2012-11-21T22:05:02.940
> 
> 标签：ruby-on-rails, ruby, regex, string, ruby-on-rails-3

我正在尝试找到一种方法来规范化字符串以将其作为文件名传递。

到目前为止我有这个：

```
my_string.mb_chars.normalize(:kd).gsub(/[^\x00-\x7F]/n, '').downcase.gsub(/[^a-z]/, '_') 
```

但第一个问题： - 字符。我想这种方法存在更多问题。

我不控制名称，**名称字符串可以有重音、空格和特殊字符**。我想删除所有这些，用相应的字母（'é' => 'e'）替换重音，然后用'_'字符替换其余部分。

名字是这样的：

*   “Prélèvements - 常规”
*   《健康证》
*   ...

我希望它们**像一个**没有空格/特殊字符的文件名：

*   “prelevements_routine”
*   “carnet_de_sante”
*   ...

谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-21T23:47:39.243

看一下`ActiveSupport::Inflector.transliterate`，处理这种字符问题非常有用。在那里阅读：[`ActiveSupport::Inflector`](http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-transliterate)

然后，您可以执行以下操作：

```
ActiveSupport::Inflector.transliterate my_string.downcase.gsub(/\s/,"_") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2022-01-10T20:04:12.573

### 使用`ActiveStorage::Filename#sanitized`，如果空格没问题。

如果空格没问题，我建议保留，如果这是用户提供和/或用户可下载的文件，那么您可以使用`ActiveStorage::Filename#sanitized`适合这种情况的方法。

它删除了文件名中不允许使用的特殊字符，同时保留了用户通常用来很好地组织和描述其文件的所有好字符，例如空格和 & 符号 (&)。

```
ActiveStorage::Filename.new( "Prélèvements - Routine" ).sanitized 
#=> "Prélèvements - Routine"

ActiveStorage::Filename.new( "Carnet de santé" ).sanitized 
#=> "Carnet de santé"

ActiveStorage::Filename.new( "Foo:Bar / Baz.jpg" ).sanitized 
#=> "Foo-Bar - Baz.jpg" 
```

### `String#parameterize`如果您想删除几乎所有内容，请使用。

如果您真的想删除所有内容，请尝试`String#parameterize`：

```
"Prélèvements - Routine".parameterize
#=> "prelevements-routine"

"Carnet de santé".parameterize
#=> "carnet-de-sante"

"Foo:Bar / Baz.jpg".parameterize
#=> "foo-bar-baz-jpg" 
```

# c - 一个结构存储在另一个结构中

> ID：13502805
> 
> 赞同：-1
> 
> 时间：2012-11-21T22:05:17.197
> 
> 标签：c, graph, nodes, structure

我试图理解为什么这项任务`g.node = n1;`是不可能的。

谁能解释一下？这个想法是使用结构创建一个带有节点的图。我认为这种方法会起作用，但我得到`error: incompatible types in assignment`了`g.node = n1;`

```
#include <stdio.h>

typedef struct
{
    int value;
    int *edges;
    int *adj;
}  Node;

typedef struct
{
    Node *node;

} Graph;

void resize_array(char *, int);
void copy_array  (char *, char *);
int main()
{
    Graph g;
    Node n1, n2;
    int edgesS[1] = {9};
    int adjS[1] = {5};
    n1.edges = edgesS;
    n1.adj = adjS;
    n1.value = 1;
    g.node = n1;
    return 0;
}

void resize_array(char * array, int size){array[size] = '\0';} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:07:41.087

`g.node`是 type`Node*`但是`n1`是 type `Node`。分配将是可能的

```
g.node = &n1; 
```

反而。请注意，`g.node`仅指向`Node`; 它不包含一个人的记忆。通过上面的简单赋值，当`n1`超出范围时，内存`g.node`指向变得无效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T22:07:52.023

您正在尝试为指针赋值。尝试取*n1*的地址，但在“让它工作”之前先想想这意味着什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T22:08:30.667

`Graph`包含**指向**节点的指针。为了完成你想要的，你需要分配新节点的地址。

```
g.node = &n1; 
```

# jquery - 如何从插件外部运行插件内部的 jquery 函数？

> ID：13502806
> 
> 赞同：0
> 
> 时间：2012-11-21T22:05:24.143
> 
> 标签：jquery, jquery-plugins

例如，如何在以下色板函数中运行“._openclose()”？

[http://tympanus.net/Tutorials/SwatchBook/index3.html](http://tympanus.net/Tutorials/SwatchBook/index3.html)

我尝试过类似的东西：

```
$( '#sb-container' ).swatchbook = function () {
    this._openclose()
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:46:18.053

您可以根据行指定的项目触发事件`closeIdx : 11`。

```
$(function() {
    $( '#sb-container' ).swatchbook( {
        // number of degrees that is between each item
        angleInc    : 15,
        neighbor    : 15,
        // if it should be closed by default
        initclosed  : true,
        // index of the element that when clicked, triggers the open/close function
        // by default there is no such element
        closeIdx    : 11
    } ); 

});

function test(){
    $('.sb-toggle').trigger('click');
} 
```

HTML：

```
<div id="test" onclick="test();">Test</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:17:41.963

There's lots of useful information in the documentation for this plugin on [this page](http://tympanus.net/codrops/2012/07/02/swatch-book-with-css3-and-jquery/). The jQuery stuff is towards the bottom.

Without having used the plugin, I'm not sure how it works exactly but I can see right off that your 'this' is not a jQuery object. Try:

```
$( '#sb-container' ).swatchbook = function () {
    $(this)._openclose()
}); 
```

OR

```
$( '#sb-container' ).swatchbook = function () {
    _self._openclose()
}); 
```

_self is declared as the variable 'this' in the plugin:

```
var _self = this; 
```

# sql - 有没有比 UNION ALL 更简单的方法？

> ID：13502813
> 
> 赞同：0
> 
> 时间：2012-11-21T22:06:18.430
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个相当大的查询，它从某个日期范围中选择数据。

我想根据年份对数据进行分组。

现在我有：

```
;with mappingTable as
(
select b.CLIENT_ID,f.patient_id,f.received_date,f.SPECIMEN_ID
from F_ACCESSION_DAILY f
join
(
select f.client_id,a.patient_id
from
(
SELECT
       max(received_date) AS received_date
     , patient_id         AS Patient_ID
FROM F_ACCESSION_DAILY
group by PATIENT_ID
) a
join F_ACCESSION_DAILY f
on f.PATIENT_ID=a.Patient_ID
and f.RECEIVED_DATE=a.received_date
) b
on b.Patient_ID=f.PATIENT_ID
where f.RECEIVED_DATE between '20100101' and '20110101' - as you can see this data is only for 2010
) ---there's much more to this query 
```

如您所见，此数据仅适用于 2010 年

但我想做`union all`所有年份：2008、2009、2010、2011、2012 ......

**我如何在不重写查询 5 次并`union all` 在所有查询之间执行此操作的情况下做到这一点？**

这是整个怪物查询：

```
;with mappingTable as
(
select b.CLIENT_ID,f.patient_id,f.received_date,f.SPECIMEN_ID
from F_ACCESSION_DAILY f
join
(
select f.client_id,a.patient_id
from
(
SELECT
       max(received_date) AS received_date
     , patient_id         AS Patient_ID
FROM F_ACCESSION_DAILY
group by PATIENT_ID
) a
join F_ACCESSION_DAILY f
on f.PATIENT_ID=a.Patient_ID
and f.RECEIVED_DATE=a.received_date
) b
on b.Patient_ID=f.PATIENT_ID
where f.RECEIVED_DATE between '20100101' and '20110101'
)
,
  counted as(
SELECT
PATIENT_ID,
    client_id,
    --case when COUNT(*)>=12 then 12 else COUNT(*) end  TimesTested, 
    COUNT(*) as timestested,
    case when count(*)>1 then
    (datediff(day,MIN(received_date),max(received_date)))
  /(COUNT(*)-1) 
 else
0
end as testfreq
  FROM mappingTable
  GROUP BY
    client_id,
    patient_id    

),counted2 as (
  SELECT
    client_id,
   TimesTested,
    CAST(COUNT(*) AS varchar(30)) AS count,
    CAST(AVG(testfreq) as varchar(30)) as TestFreq,
    CAST(STDEV(TestFreq) as varchar(30)) Stdv
  FROM counted
  GROUP BY
    client_id,
    TimesTested
    ),

    counted3 as 
     (
  SELECT
  patient_id,
    client_id,
   TimesTested,
    CAST(COUNT(*) AS varchar(30)) AS count,
    AVG(testfreq) as TestFreq
  FROM counted
  GROUP BY
    client_id,
    TimesTested,
    PATIENT_ID
    )
    ,
    CountOver12 as
    (    select client_id,count(*) count
    from counted
    where timestested>12
    group by CLIENT_ID)
    ,
    TotalAvgTestFreq as (

    select client_id, SUM(testfreq) / count(testfreq) TotalAvgTestFreq
    from counted3
    group by client_id
    )

    ,
unpivoted AS (
  SELECT
    client_id,
    ColumnName + CAST(TimesTested AS varchar(10)) AS ColumnName,
    ColumnValue
  FROM counted2
  UNPIVOT (
    ColumnValue FOR ColumnName IN (count, TestFreq,stdv)
  ) u
),
pivoted AS (
  SELECT
    client_id clientid,
    count1, TestFreq1,stdv1,
    count2, TestFreq2,stdv2,
    count3, TestFreq3,stdv3,
    count4, TestFreq4,stdv4,
    count5, TestFreq5,stdv5,
    count6, TestFreq6,stdv6,
    count7, TestFreq7,stdv7,
    count8, TestFreq8,stdv8,
    count9, TestFreq9,stdv9,
    count10, TestFreq10,stdv10,
    count11, TestFreq11,stdv11,
    count12, TestFreq12,stdv12
  FROM unpivoted
  PIVOT (
    MAX(ColumnValue) FOR ColumnName IN (
      count1,TestFreq1,stdv1,
      count2,TestFreq2,stdv2,
      count3,TestFreq3,stdv3,
      count4,TestFreq4,stdv4,
      count5,TestFreq5,stdv5,
      count6,TestFreq6,stdv6,
      count7,TestFreq7,stdv7,
    count8, TestFreq8,   stdv8,
    count9, TestFreq9,   stdv9,
    count10, TestFreq10,stdv10,
    count11, TestFreq11,stdv11,
    count12, TestFreq12,stdv12
    )
  ) p
)
,
PatientStats as
(
select 
 distinct
f.client_id
,datediff(MM,c.mlis_date_established,GETDATE()) MonthsCustomer
,count(distinct patient_id) TotalPatients
,count(distinct specimen_id) TotalSpecimens
from mappingTable f
left join D_CLIENT c
on f.CLIENT_ID=c.CLIENT_ID
group by f.client_id,c.mlis_date_established
)
,
Over12
as
(
select client_id,SUM(c) sumcount from
(
select CLIENT_ID,COUNT(*) c
from mappingTable
group by CLIENT_ID,PATIENT_ID
having count(*)>12
) a
group by client_id
),
GetMedian as(

    select client_id, avg(timestested) median_testfreq
from
(
    select client_id,
           timestested,
           rn=row_number() over (partition by CLIENT_ID
                                 order by timestested),
           c=count(timestested) over (partition by CLIENT_ID)
    from counted3
    where timestested>1
) g
where rn in (round(c/2,0),c/2+1)
group by client_id
   )
, final as (
SELECT p.*,pivoted.*,c12.count [Count13+],Over12.sumcount SumofGreaterThan12,t.TotalAvgTestFreq,median.median_testfreq
FROM pivoted
left join PatientStats p
on p.CLIENT_ID=pivoted.CLIENTID
left join Over12
on over12.CLIENT_ID=p.CLIENT_ID
left join TotalAvgTestFreq t
on t.CLIENT_ID=p.CLIENT_ID
left join CountOver12 C12
on c12.CLIENT_ID=p.CLIENT_ID
left join GetMedian median
on median.CLIENT_ID=p.CLIENT_ID
where p.CLIENT_ID not in (select CLIENTid from SalesDWH..TestPractices)
)
/* Get the data into a temp table */
SELECT * INTO #TempTable
FROM final
/* Drop the cloumns that are not needed */
ALTER TABLE #TempTable
DROP COLUMN clientid
/* Get results and drop temp table */
SELECT * FROM #TempTable
DROP TABLE #TempTable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:15:13.627

创建表函数：

```
CREATE FUNCTION fn_get_data_by_date_range
(
   @start AS VARCHAR(8),
   @end AS VARCHAR(8)
)
RETURNS TABLE
AS 
RETURN 
(
   ...your query...
   WHERE f.RECEIVED_DATE BETWEEN @start AND @end
) 
```

那么您可以 UNION 对该函数的不同调用：

```
SELECT * FROM fn_get_data_by_date_range('20100101','20110101')
UNION ALL
SELECT * FROM fn_get_data_by_date_range('20090101','20100101')
UNION ALL
....
UNION ALL
SELECT * FROM fn_get_data_by_date_range('20070101','20080101') 
```

# delphi - IndyTCP delphi 对象交换数组

> ID：13502814
> 
> 赞同：0
> 
> 时间：2012-11-21T22:06:19.420
> 
> 标签：delphi, serialization, tcp, memorystream

对不起，我知道我问了太多问题，但是明天（实际上是今天，因为在我的国家，现在是凌晨 2:00）我需要向我的老师展示我开始制作的东西等等所以正如我在之前的问题中所问的我需要从服务器向客户端发送一些数据。但是在那之后服务器的备忘录字段中什么也没有出现`memo1.Lines.Add(IntToStr(arrOf[1]));`

我试图在客户端发送它

```
procedure TForm1.btnTestClick(Sender: TObject);
var
  msRecInfo: TMemoryStream;
  arrOf: array of integer; i:integer;
begin
  setLength(arrOf, 11);
  for i := 0 to 10 do
    arrOf[i]:=random(100);

  msRecInfo:= TMemoryStream.Create;

  try
    msRecInfo.Write(arrOf, SizeOf(arrOf));
    idTCPClient1.IOHandler.Write(msRecInfo);
  finally
     msRecInfo.Free;
  end;

end; 
```

在服务器上

```
procedure TForm1.IdTCPServer1Execute(AContext: TIdContext);
var
   msRecInfo: TMemoryStream;
  arrOf: array of Integer; i:integer;
begin
  msRecInfo:= TMemoryStream.Create;
  try
    AContext.Connection.IOHandler.ReadStream(msRecInfo, -1, False);
    SetLength(arrOf,11);
    msRecInfo.Position := 0;
    msRecInfo.Read(arrOf, SizeOf(arrof));
  finally
    memo1.Lines.Add(IntToStr(arrOf[1]));
    msRecInfo.Free;
  end;    
end; 
```

请你能帮我解决这个问题并找到一些如何发送不同类型/类的数组的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T23:20:47.167

这是您的主要问题

```
msRecInfo.Write( arrOf, SizeOf( arrOf ) ); 
```

您将数组的指针地址写入流中……我不认为那是您的目标。

如果要将数组的内容放入流中，则应使用

```
msRecInfo.Write( arrOf[ Low( arrOf ) ], SizeOf( Integer ) * Length( arrOf ) ); 
```

为什么？您必须指向数据的第一个位置（数组的第一个元素），并且您必须计算数据的长度。

在接收部分它是一样的

```
msRecInfo.Read( arrOf[ Low( arrOf ) ], SizeOf( Integer ) * Length( arrOf ) ); 
```

PS：这在这种特殊情况下可能工作得很好，但为了安全起见，您应该首先发送所有数据的长度，以便接收者知道，当消息完成时

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T00:15:32.080

正如 Rufo 已经解释的那样，您没有正确地将数组写入和读取数组`TMemoryStream`。

更糟糕的是，您也没有`TMemoryStream`正确地通过套接字发送。和的默认参数`TIdIOHandler.Write(TStream)`互`TIdIOHandler.ReadStream()`不兼容。默认情况下，`Write(TStream)` **不**发送`TStream.Size`值。但是， 的默认参数`ReadStream()`（与您显式传入的值相同）告诉它读取前几个字节并将它们解释为`Size`，这在本示例中是非常错误的。

试试这个：

```
procedure TForm1.btnTestClick(Sender: TObject);
var
  msRecInfo: TMemoryStream;
  arrOf: Array of Integer;
  i: Integer;
begin
  SetLength(arrOf, 11);
  for i := Low(arrOf) to High(arrOf) do
    arrOf[i] := random(100);

  msRecInfo := TMemoryStream.Create;
  try
    msRecInfo.WriteBuffer(arrOf[0], Length(arrOf) * SizeOf(Integer));
    IdTCPClient1.IOHandler.Write(msRecInfo, 0, True);
  finally
     msRecInfo.Free;
  end;
end;

procedure TForm1.IdTCPServer1Execute(AContext: TIdContext);
var
  msRecInfo: TMemoryStream;
  arrOf: Array of Integer;
  i: Integer;
begin
  msRecInfo := TMemoryStream.Create;
  try
    AContext.Connection.IOHandler.ReadStream(msRecInfo, -1, False);
    SetLength(arrOf, msRecInfo.Size div SizeOf(Integer));
    if Lenth(arrOf) > 0 then
    begin
      msRecInfo.Position := 0;
      msRecInfo.ReadBuffer(arrOf[0], Length(arrOf) * SizeOf(Integer));
    end;
  finally
    msRecInfo.Free;
  end;    
  ...
end; 
```

或者，摆脱`TMemoryStream`并自己发送单个`Integer`值：

```
procedure TForm1.btnTestClick(Sender: TObject);
var
  arrOf: Array of Integer;
  i: Integer;
begin
  SetLength(arrOf, 11);
  for i := Low(arrOf) to High(arrOf) do
    arrOf[i] := random(100);

  IdTCPClient1.IOHandler.Write(Length(arrOf));
  for I := Low(arrOf) to High(arrOf) do
    IdTCPClient1.IOHandler.Write(arrOf[i]);
end;

procedure TForm1.IdTCPServer1Execute(AContext: TIdContext);
var
  arrOf: Array of Integer;
  i: Integer;
begin
  i := AContext.Connection.IOHandler.ReadLongInt;
  SetLength(arrOf, i);
  for i := Low(arrOf) to High(arrOf) do
    arrOf[i] := AContext.Connection.IOHandler.ReadLongInt;
  ...
end; 
```

现在，话虽如此，`TMemo`直接在`OnExecute`事件处理程序中访问不是线程安全的。 `TIdTCPServer`是一个多线程组件。该`OnExecute`事件在工作线程的上下文中触发，而不是在主线程中触发。UI 组件，如`TMemo`，不能从主线程外部安全地访问。您可以使用 Indy 的`TIdNotify`或`TIdSync`类与主线程同步，例如：

```
type
  TMemoSync = class(TIdSync)
  protected
    FLine: String;
    procedure DoSynchronize; override;
  end;

procedure TMemoSync.DoSynchronize;
begin
  Form1.Memo1.Lines.Add(FLine);
end;

procedure TForm1.IdTCPServer1Execute(AContext: TIdContext);
var
  ...
begin
  ...
  with TMemoSync.Create do try
    FLine := IntToStr(arrOf[1]);
    Synchronize;
  finally
    Free;
  end;
  ...
end; 
```

如果不与主线程同步，可能会发生不好的事情。

# r - 在 lme4 中排除一个因素水平的交互作用计算

> ID：13502815
> 
> 赞同：1
> 
> 时间：2012-11-21T22:06:24.397
> 
> 标签：r, model, interaction, r-factor, mixed

我正在使用 制作混合模型，`lme4`其中包括 2,3 和 4 个级别的三个因子（S、M、R）。但是我缺少对 S3:M2:R1 的观察，所以我无法检查三向交互。

有没有办法告诉`lme4`忽略估计这个级别的参数？

而不是它给我的信息：`Error in mer_finalize(ans) : Downdated X'X is not positive definite, 21.`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:32:59.117

手动构建交互变量，并删除级别。如果您给出一个可重现的示例，那就太好了，但是：

```
mydata <- transform(mydata,SMRint=interaction(S,M,R,drop=TRUE))
lmer(response~SMRint+(1|grpvar),data=mydata) 
```

# php - 在 WordPress 中保存多个键/值对

> ID：13502820
> 
> 赞同：2
> 
> 时间：2012-11-21T22:06:32.427
> 
> 标签：php, wordpress, settings

在开发用于获取一定数量的 RSS 提要的 WordPress 插件时，我遇到了一些设计问题。

供稿的 URL 应该能够由用户配置，这对于固定数量的供稿非常有效。用户可以在适当的设置页面上输入这些提要的 URL，这显然使用了 WordPress 的设置 API。

然而，我的目标是让用户能够输入未知数量的提要，以及用于显示和识别它们的标签和 ID。问题在于表示这些数据的方式。我想要的结果是有一个返回（类似）这样的函数：

```
$feed_categories = array(
    array(
        'id' => 'tools',
        'label' => 'Tools',
    'url' 'example.org/toolsfeed/feed.xml',
),
array(
    'id' => 'questions',
        'label' => 'Questions',
        'url' => 'www.example.com/feeds/questions.xml',
),
    // Etc
); 
```

现在，我知道我可以使用我当前使用的 WordPress 设置 API 存储这种数组，但我不确定......

1.  如果这不是设置 API 的用途，并且
2.  我将如何制作一个允许“无限”添加三个键值对部分的选项页面，以及如何解析它

**编辑**：我开始质疑我目前的方法的主要原因是，设置（或选项）API 有一种简单的方法来为固定数量的项目生成表单，但不是更多。其次，更重要的是，我还没有找到创建自定义`options.php`页面的方法，这是访问传入的 POST 请求所必需的，之后我需要继续验证、格式化和保存发送的配置数据。所以基本上，当我使用设置 API 时，创建表单和处理输入的实际方面对我来说似乎非常有限。扩展`options.php`'s 功能的能力会很棒。（也许我忽略了一个可以做我想要的钩子？）

我已经查看了设置的验证回调，但这将涉及注册一个您不想保存的设置，只是为了访问相应的`$_POST`键。

另一种选择是这种情况只是制作一个表来存储这些信息。但是，由于这可能是大多数用户会设置并忘记很长时间的东西，我担心它可能会矫枉过正。

你们中是否有人知道在设置 API 中实现此功能而无需太多黑客攻击的好方法，或者这真的只需要自定义表格吗？

我很想听听您对此有何看法，以及您为什么这么认为。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:49:10.520

最简单的方法就像您说的那样，只需将其存储在数据库中即可。这使事情变得简单而美好。这不是很多数据，但它不一定是“矫枉过正”，你只是在使用你可用的东西。

如果您真的不想使用数据库，您可以做的一个小“hack”是使用选项 API 存储信息。通常你会像这样存储一个键值：

```
update_option('some_option','XYZ'); 
```

但是，如果需要，您可以将整个数组存储为一个值。使用您的示例：

```
update_option('feed_categories',$feed_categories); 
```

这样做的唯一缺点是，因为您要存储整个数组，所以当您更新 feed_categories 时，您需要

1.  读取整个数组
2.  更改您想要更改的数组中的任何设置
3.  再次保存整个数组。

所以你不能做一些事情，比如只获取数组的第一部分等。你必须每次都使用整个数组。

# content-management-system - 在 Orchard 中看不到内容类型

> ID：13502821
> 
> 赞同：1
> 
> 时间：2012-11-21T22:06:37.423
> 
> 标签：content-management-system, orchardcms, webmatrix, webmatrix-2

我正在运行 Orchard 1.6 并在设置模板博客或核心站点时遇到以下问题。

我转到仪表板并转到左侧的内容菜单项。没有内容类型菜单项只有内容。

所有的培训视频似乎都能立即得到这个，我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:45:46.950

转到模块（左侧菜单中有一个链接）并启用`ContentTypes`功能。

# javascript - 使用 api 嵌入旧推文

> ID：13502826
> 
> 赞同：0
> 
> 时间：2012-11-21T22:06:56.677
> 
> 标签：javascript, jquery, api, twitter

我正在尝试从用户的公共流中嵌入最新的推文。我做了这个

```
$.getJSON('http://twitter.com/statuses/user_timeline/'+user+'.json?callback=?', function(data) {
    console.log(data)
    ...
} 
```

这不再起作用了。我认为这是由于推文都过时了，但是在将名称换成活动帐户后，它也不起作用。

我不想手动嵌入推文。我最好不想使用 twitter 小部件。

我试过[tweet.seaofclouds.com](http://tweet.seaofclouds.com)的 twitter 插件，但它也找不到旧的推文（[演示](http://jsfiddle.net/WwfEr/4/)）

所以我需要的是一种显示最新推文的方法，无论该用户的年龄如何：[@nietopmeisjes](https://twitter.com/nietopmeisjes)

不重复： [如何使用 twitter api 发布推文？](https://stackoverflow.com/questions/9329046/how-to-tweet-using-twitter-api)（这是针对 android 应用程序） [如何使用 Twitter api 发推文](https://stackoverflow.com/questions/12404826/how-to-tweet-using-twitter-api)（这是关于 iOS 应用程序）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T02:50:43.520

Twitter[发布](https://dev.twitter.com/blog/changes-coming-to-twitter-api)了新版本的 api，1.1。现在每个 API 端点都需要通过 OAuth 进行身份验证。

您仍然可以通过将 url 更改为来使用版本 1，`http://api.twitter.com/1/statuses/user_timeline`但这将在 2013 年 3 月停止工作，如链接中所述。

对于 1.1，您必须使用服务器端应用程序来获取 OAuth 令牌并检索您的推文。确保遵循[显示要求](https://dev.twitter.com/terms/display-requirements)并注意新的 api 限制。~~或者只是从您的应用程序中删除 twitter 小部件。~~

# java - File.getAbsolutePath 在 Ubuntu 上不正确

> ID：13502828
> 
> 赞同：1
> 
> 时间：2012-11-21T22:07:13.993
> 
> 标签：java, file, ubuntu, netbeans, path

[这是这个](https://stackoverflow.com/q/13449594/475845)问题的后续问题（只是作为一个简短的描述：我已经能够通过双击`.jar`OS X 和 Windows 上的文件来运行 Java 程序，但不能在 Linux 上运行，因为我得到了后者文件路径问题）。

通过在 Ubuntu (12.04) 下使用 NetBeans 尝试一些事情，我发现问题似乎出在程序认为是它的工作目录的地方（我从 的输出中得出结论`File.getAbsolutePath()`）。如果我在 NetBeans 中启动我的应用程序，一切正常（即使在 Ubuntu 下），并且

```
System.out.println(new File(".").getAbsolutePath()); 
```

给我`/home/my_home/projects/VocabTrainer/.`，这是我的项目文件夹，因此是正确的。但是，如果我双击`.jar`位于 中的文件，`/home/my_home/projects/VocabTrainer/dist`我突然在 Ubuntu 下得到的输出仅仅是`/home/my_home/.`这有问题，因为我想访问位于我的`dist`dir 的子目录中的数据文件。

有谁知道这种行为的原因，以及我该如何解决这个问题？

PS：我不知道这是否需要，但这是输出`java -version`

```
java version "1.6.0_24"
OpenJDK Runtime Environment (IcedTea6 1.11.5) (6b24-1.11.5-0ubuntu1~12.04.1)
OpenJDK Server VM (build 20.0-b12, mixed mode) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:11:39.070

我认为您将 JAR 的位置与[当前工作目录](http://en.wikipedia.org/wiki/Working_directory)混淆了。

要确定前者，请参阅[如何获取正在运行的 JAR 文件的路径？](https://stackoverflow.com/questions/320542/how-to-get-the-path-of-a-running-jar-file)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:29:54.273

原因，不是真的，目前。但是由于明显的不可预测性，您可能不想那样处理它。`getResource`假设您在下面的调用中使用 jar 中某些东西的限定类名，这样的东西应该会获取文件：

```
URL url = this.getClass().getClassLoader().getResource("thepackage/ofyourclass/JunkTest.class");  //get url of class file.  expected: ("jar:file:/somepath/dist/yourjar.jar!qualified/class/name.class")
File distDir = null;
if(url.getProtocol() == "jar") {
    String classPath = null;
    String jarPath = url.getPath();
    if(jarPath.matches(".*:.*")) jarPath = new URL(jarPath).getPath();
    classPath = jarPath.split("!")[0];
    distDir = new File(classPath).getParentFile(); //may need to replace / with \ on windows?
} else { //"file" or none
    distDir = new File(url.toURI()).getParentFile();
}    
//... do what you need to do with distDir to tack on your subdirectory and file name 
```

编辑：我应该指出这显然是 hacky。您可以在启动时直接将文件的位置添加到类路径（或在 jar 中包含您要查找的文件）。从这里你可以`this.getClass().getClassLoader().getResource()`直接使用你正在寻找的文件名，这会让你得到类似的东西：

```
URL url = this.getClass().getResource("yourfile");
File file = new File(url.toURI());
//... use file directly from here 
```

进一步编辑：好的，适应您缺少的协议，并将其展开，因此错误消息对您来说更具可读性。

# ruby-on-rails-3 - 在远程实例上运行 rspec 测试（通过警卫）

> ID：13502829
> 
> 赞同：1
> 
> 时间：2012-11-21T22:07:16.107
> 
> 标签：ruby-on-rails-3, testing, rspec, cucumber, guard

可能我的用例是特定的，但我确定我不是唯一的。

我有相当大的 Rails 应用程序，充满了 Rspec/Cucumber 测试。通常在 Intel i5 上从头开始运行所有内容需要 30-40 分钟。是的，我们正在使用警卫，所以从一开始就不是每次都这样。但无论如何这很烦人，我想以某种方式分配负载。

我也有另一个带有 i7 的开发工作站，我的想法是在它上面运行保护循环。这样，我需要一些东西来自动化通过远程机器上的守卫运行的 Rspec/Cucumber 测试，但一般行为应该是相同的：我正在改变一些东西，守卫在远程工作站上对更改的部分运行测试，而我这边没有任何额外的动作。我不想在开发过程中推送 repo，当然我们使用的是 CI，本地 CI 不会很合理。当然，我们使用的是 parallel_tests，所以我的问题不是关于在 CPU 内核之间共享负载。

非常欢迎提出想法和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:34:16.780

您可以与快速计算机共享文件（通过 smb fe）并在远程计算机上运行测试并通过 ssh 检查它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T09:53:53.083

你可以在远程机器上挂载你的项目工作目录并在那里启动 Guard，最好是通过 SSH，这样你就可以看到控制台输出。此外，您可以使用 GNTP 通知器并将通知从远程机器发送到您的开发机器：

`Ruby notification :gntp, :host => 'development.local', :password => 'secret'`

# ruby - 如何找到具有预定义名称之一的哈希键？

> ID：13502830
> 
> 赞同：0
> 
> 时间：2012-11-21T22:07:26.213
> 
> 标签：ruby

我有一个带有任意键的哈希：

```
{'GET': [1,2,3]} 
```

或者

```
{'POST': ['my data 0', 'my data 1']} 
```

哈希是从请求正文中发送的 JSON 生成的。只有一个键，或者更确切地说，我忽略了除一个键之外的任何键。

我想找到它是哪个键，这是我写的代码：

```
items = data['GET'] || data['get'] || data['POST'] || data['post'] 
```

这看起来不整洁。如果我要处理的键数增加，则表达式会很长。我希望它简短。我是 Ruby 新手，有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:40:08.300

您可以使用 Hash#values_at 方法。

[http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-values_at](http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-values_at)

```
data.values_at('GET','get', 'POST','post').first 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:11:40.293

你可以像这样得到第一个值（假设只有一个）：

```
item = data.values.first 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T22:47:59.890

如果您认为它可能会增长，您可能希望将 HTTP 方法与在数据中找到该方法的结果分开：

```
methods = [:get, :post]

def find_method(data)
  keys = methods.map{|m| [m.to_s.upcase, m.to_s]}.flatten
  data.values_at(keys).first
end 
```

# jquery - 使用 $.GET 后如何检查加载的图像？

> ID：13502832
> 
> 赞同：0
> 
> 时间：2012-11-21T22:07:28.793
> 
> 标签：jquery, ajax, loaded

好的，我有一些代码

```
$.get('results1.html', function(data) {
    $('#search-results').html(data);        
}).complete(function() {
    BlockStuffNow();    
}); 
```

BlockStuffNow(); 是一个对已加载到#search-results 中的图像进行操作的函数，但它只能在它们全部加载后才能对它们进行操作，我如何检查它们是否已加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:14:24.967

您可以使用简单的加载，然后运行回调函数...

```
$("#search-results").load("results1.html",function(){
        $('img').load(function(){
                BlockStuffNow();
        })
});​​​​​​ 
```

# c# - 从 HashSet 中获取值 使用反射

> ID：13502833
> 
> 赞同：0
> 
> 时间：2012-11-21T22:07:29.393
> 
> 标签：c#, reflection, hashset

我需要一种使用**反射**从通用 HashSet 获取值的方法。这是我尝试过的（您可以在控制台应用程序上复制/粘贴它）：

```
 class Program
    {
        public class Order
        {
            public int Id { get; set; }
        }

        public class Person
        {
            public string Name { get; set; }

            public ICollection<Order> Orders { get; set; }

        }

        static void Main(string[] args)
        {
            var person = new Person();
            person.Name = "Test Person";

            person.Orders = new HashSet<Order>();

            person.Orders.Add(new Order() { Id = 1 });
            person.Orders.Add(new Order() { Id = 2 });

            var reflectedOrders = person.GetType().GetProperty("Orders").GetValue(person, null);

            Console.WriteLine("How do I iterate the reflected orders?");

            Console.ReadLine();
        }
    } 
```

* * *

## 编辑

这是一个例子，在实际应用中我不知道要转换哪种类型的反射订单。我只知道该属性是一个`ICollection<T>`（由 EF 转为 HashShet）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:09:59.960

你试过铸造`reflectedOrders`吗`IEnumerable`？

```
IEnumerable reflectedOrders = (IEnumerable)person.GetType().GetProperty("Orders").GetValue(person, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:10:36.833

它应该像铸造一样简单：

```
var reflectedOrders = (HashSet<Order>) person.GetType().GetProperty("Orders").GetValue(person, null);

foreach (var order in reflectedOrders)
    ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:21:11.073

关于什么

```
var orders = persons.OfType<Person>().SelectMany(p => p.Orders); 
```

# sql - RDBMS 缓存与磁盘 I/O —— 供应商之间的比较

> ID：13502834
> 
> 赞同：1
> 
> 时间：2012-11-21T22:07:31.240
> 
> 标签：sql, database, relational-database, rdbms

我对领先的 RDBMS 如何检索数据知之甚少。所以这些问题可能看起来有点初级：

1.  常用 RDBMS（如 Oracle、SQL Server、MySQL、PostgeSQL 等）中的每个 SELECT 是否总是意味着从磁盘读取数据的行程，或者它们是否在硬件允许的范围内缓存常用请求的数据以避免昂贵的输入输出操作？

2.  他们如何确定要缓存哪些数据段？

3.  一旦某些缓存数据的更新由不同的进程发生，他们如何同步缓存？

4.  是否有关于不同 RDBMS 如何缓存频繁请求的数据的比较矩阵？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:16:49.633

I'll answer for SQL Server:

1.  Reads are served from cache if possible. Else, an IO occurs.
2.  From what has been written and from what I observe, it is an LRU algorithm. I don't think this is documented anywhere. The LRU items are database pages of 8KB.
3.  SQL Server is the only process which has access to the database files. So no other process can cause modifications. Regarding concurrent transactions: Multiple transactions can modify the same page. Locking (mostly at row-level, sometimes page or table level) ensures that the transactions do not disturb each other.
4.  I don't know.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T00:11:10.860

Informix 的答案与 SQL Server 的答案非常相似：

1.  如果可能，读取和写入都使用缓存。如果需要的页面尚未在缓存中，则会发生适当的 I/O 操作集合（通常，从缓存中逐出某些页面，可能是在读入新页面之前必须写入的脏页面，然后读取新页面）旧页面所在的页面）。
2.  有各种算法，但页面大小和使用是关键部分。每个页面大小都有 LRU 队列。
3.  整个 DBMS 是使用共享内存中的缓冲池的进程的集合（并且在可能的情况下，直接磁盘 I/O 而不是通过内核缓存），并使用各种形式的锁定（信号量、自旋锁、互斥锁等）来处理并发和同步。（在 Windows 上，Informix 使用具有多个线程的单个进程；在 Unix 上，它使用多个进程。）
4.  可能不是。

# python - 在 python 脚本和 applescript 之间传递和接收值

> ID：13502836
> 
> 赞同：1
> 
> 时间：2012-11-21T22:07:38.353
> 
> 标签：python, applescript

我对python和applescript很陌生。我有一个调用 2 个 applescripts 的 python 脚本。我想在 python 中定义几个全局变量并传递给 applescript 1 ，这些值将由 applescripts 1 中的不同函数修改，然后传回 python 脚本，然后将这些值传递给 applescript 2 使用。

我用谷歌搜索了一下，我尝试了以下方法：

在苹果脚本中，

```
on run argv 
    if (item 1 of argv is start with "x") then 
      function1(item1 of argv)
    else 
      function2 (item 1 of argv)
      function3 (item 2 of argv)
 end run

 on function1 (var)
  set var to (something code to get value from interaction with user)
 return var 
 end function1 
```

在 python 脚本中导入 os 导入 sys

```
os.system ('osascript Setup.scpt')
variable1 = sys.argv[1]
variable2 = sys.argv[2] 
```

在applescript2中，我做了与applescirpt1类似的事情。

然而，这并没有奏效。我试图打印出两个脚本中的所有 argv，看起来值没有正确传递。谁能给我更多的指导？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:04:41.323

您必须从 applescript 中的“on run”处理程序返回一些东西，否则返回的结果只是最后一行代码的结果。所以你会想做这样的事情......

```
on run argv
    set returnList to {}

    if (item 1 of argv starts with "x") then
        set end of returnList to function1(item1 of argv)
    else
        set end of returnList to function2(item 1 of argv)
        set end of returnList to function3(item 2 of argv)
    end if

    return returnList
end run 
```

如果您希望用户提供一些东西，您的功能也需要看起来像这样。请注意，我告诉 Finder 显示对话框。那是因为您是从 python 运行它，如果某些应用程序不处理用户交互，它将出错。

```
on function1(var)
    tell application "Finder"
        activate
        set var to text returned of (display dialog "Enter a value" default answer "")
    end tell
    return var
end function1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T08:39:57.537

`os.system()`：在子shell中执行命令（字符串）。这是通过调用标准 C 函数 system() 来实现的，并且具有相同的限制。

更改`sys.stdin, sys.stout`不会反映在执行命令的环境中。返回值是退出状态，而不是 osascript 输出。

使用**subprocess.Popen**：

```
import os, sys, commands
from subprocess import Popen, PIPE

var1 = sys.argv[1] 
var2 = sys.argv[2] 
(var3, tError) = Popen(['osascript', '/Setup.scpt', var1, var2], stdout=PIPE).communicate()
print var1
print var2
print var3 
```

该`osascript`命令总是返回一个`string`. 如果 AppleScript 返回 a `list`，则 python 中的字符串将用逗号和空格分隔。

# regex - 匹配字符串末尾的某些数字

> ID：13502845
> 
> 赞同：4
> 
> 时间：2012-11-21T22:08:09.417
> 
> 标签：regex, r

我有一个字符串向量：

```
s <- c('abc1',   'abc2',   'abc3',   'abc11',   'abc12', 
       'abcde1', 'abcde2', 'abcde3', 'abcde11', 'abcde12', 
       'nonsense') 
```

我想要一个正则表达式只匹配以、或开头`abc`和结尾的字符串。换句话说，正则表达式必须排除但不是，但不是，等等。`3``11``12``abc1``abc11``abc2``abc12`

我认为使用前瞻断言很容易做到这一点，但我还没有找到方法。有吗？

* * *

**编辑：**感谢下面的海报指出原始帖子中的严重歧义。

实际上，我有很多字符串。它们都以数字结尾：一些在 0 中，一些在 9 中，一些在中间的数字中。我正在寻找一个匹配所有字符串的正则表达式，*除了*那些以字母后跟 1 或 2 结尾的字符串。（正则表达式也应该只匹配那些以 开头的字符串`abc`，但这是一个简单的问题。）

我尝试使用否定的前瞻性断言来创建这样的正则表达式。但我没有任何成功。

* * *

感谢所有回复和评论的人。受到你们几个人的启发，我最终使用了这个组合：`grepl('^abc', s) & !grepl('[[:lower:]][12]$', s)`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:34:13.050

而不是一个复杂的正则表达式，在这种情况下，我认为使用两个简单的正则表达式更容易：

```
s <- c('abc1',   'abc2',   'abc3',   'abc11',   'abc12', 
       'abcde1', 'abcde2', 'abcde3', 'abcde11', 'abcde12', 
       'nonsense')

s[grepl("^abc", s) & grepl("(3|11|12)$", s)] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T22:14:00.523

这是你想要的吗？

```
s[grepl("abc.*(3|11|12)", s)]
[1] "abc3"    "abc11"   "abc12"   "abcde3"  "abcde11" "abcde12" 
```

排除的字符串是：

```
s[!grepl("abc.*(3|11|12)", s)]
[1] "abc1"     "abc2"     "abcde1"   "abcde2"   "nonsense" 
```

* * *

**编辑：**正如评论所示，您的要求有些含糊不清。更全面的正则表达式将测试字符串开头`^`和字符串结尾，并且可能只允许在最终数字之前`$`使用字母字符：`[[:alpha:]]`

```
s[grepl("^abc[[:alpha:]]*.*(3|11|12)$", s)]
[1] "abc3"    "abc11"   "abc12"   "abcde3"  "abcde11" "abcde12" 
```

* * *

您还可以`grep`通过传递参数直接返回值`value=TRUE`，从而在代码中节省一些重复：

```
grep("^abc[[:alpha:]]*.*(3|11|12)$", s, value=TRUE)
[1] "abc3"    "abc11"   "abc12"   "abcde3"  "abcde11" "abcde12" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T22:18:38.293

您也可以`substring`在这种情况下使用：

```
z <- nchar(s)
s[substring(s, 1, 3) == "abc" & substring(s, z) == "3" | 
    substring(s, z-1) %in%  c("12", "11")] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T22:39:15.740

专门寻找请求的数字给出了这个：

```
n <-  c(3,11,12)

s[sub('abc[^[:digit:]]*([[:digit:]]+)$',s, replacement='\\1') %in% n]
 [1] "abc3"    "abc11"   "abc12"   "abcde3"  "abcde11" "abcde12" 
```

这不会将 11 与 1 混淆：

```
 n <-  c(3,1,12)

s[sub('abc[^[:digit:]]*([[:digit:]]+)$',s, replacement='\\1') %in% n]
 [1] "abc1"    "abc3"    "abc12"   "abcde1"  "abcde3"  "abcde12" 
```

对于您的编辑，不以 1 或 2 结尾（并使用两个正则表达式）

```
s[grepl('^abc',s) & !(sub('.*[^[:digit:]]([[:digit:]]+)$',s, replacement='\\1') %in% c(1,2))]
[1] "abc3"    "abc11"   "abc12"   "abcde3"  "abcde11" "abcde12" 
```

# c# - C# 子类拒绝打球 - 请多态帮助 :-)

> ID：13502846
> 
> 赞同：0
> 
> 时间：2012-11-21T22:08:13.023
> 
> 标签：c#, interface, polymorphism, abstract-class

好的.. C# 不是我的强项，我已经有一段时间没有开始研究这种事情了，我忘记了一些事情：我正在努力让这个也服从我:-) 我很确定我想要什么在 C# 中做是可能的，我很确定我的抽象和我的接口都是地狱（我什至不知道如何放入接口，但我知道我需要一个）

好的，这是场景

```
//abstract parent class
abstract class ActionType
{
    /***
     * this is a parent class not meant to ever be instaciated
     */
    public abstract void action();      
}

class ActionTypeSync : ActionType
{
    public override void action()
    {
        Debug.WriteLine("doing sync");
    }
}

class ActionTypeRead : ActionType
{
    public override void action()
    {
         Debug.WriteLine("doing read");
    }
} 
```

以下不起作用

```
ActionType action = getActionType(1);
ActionType secondaction = getActionType(2); 
```

**[ 编辑 ]**

实际上我说得太简短了，这一点没有出错

错误参数 1：无法从“ActionType”转换为“ActionTypeSync”

```
processThings(action);
//debug out put "doing sync"    
processThings(secondaction);
//debug out put "doing sync"   

public ActionType getActionType(int i)
{
     if (i==1) return new ActionTypeSync();
     if (i==2) return new ActionTypeRead();
}

public void processThings(ActionTypeSync action)
{
     action.action();
}

public void processThings(ActionTypeRead action)
{
     action.action();  
} 
```

**[/ 编辑 ]**

我需要如何最好地重组这个..请理解这是一个简洁的例子（尽我所能）我在这里总结 - 所以有些原则比一些“为什么等等讲座”更好:-)谢谢你:-)我不反对为了适应多态原则而进行重组，但我需要这个基本的多态接口/类结构

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:13:36.827

~~Overlooking your syntactical errors, this is doing exactly what you told it to do.~~

~~It is calling the local `action()` on the specific type you instantiated, it doesn't do anything else because you haven't told it to (i.e. at no stage are you calling `base.action()`).~~

## Edit:

Based on your edit.... `ActionTypeSync` and `ActionTypeRead` can both be cast down to `ActionType`, but `ActionType` cannot be cast back up to either of those derived types. You can pass one of the derived objects around as an `ActionType` and the overridden `action()` method will be called, but you can't cast it implicitly or explicitly to the derived type. To fix this just change your method signatures:

```
public void processThings(ActionType action)
{
     action.action();
} 
```

Because of this change you will now only need one method that will deal with both derived types because you have cast it down to its base type - IOW you can get rid of the `processThings(ActionTypeRead action)` method.

# java - 如何在Java中将两个文件夹文件合并为一个

> ID：13502849
> 
> 赞同：2
> 
> 时间：2012-11-21T22:08:23.213
> 
> 标签：java, file, file-io

我正在尝试创建一个简单的函数，它将两个或多个文件夹文件复制或合并到一个文件夹中。

我从下面开始。我想在这里发布以获得更好质量的代码。

```
public  void copyDifferentFolderFilesIntoOne(String mergedFolderStr,String ... foldersStr)
{
  File mergedFolder= new File(mergedFolderStr);
  for(String folder: foldersStr)
  {
    //copy folder's files into mergedFolder
  }
} 
```

当文件复制发生冲突时（即两个或多个文件夹上存在同名文件），我希望将具有最新时间戳的文件复制到mergedFolder中。

您知道将两个或多个文件夹文件合并为一个的最佳方法吗？

如果问题不清楚，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:27:24.570

您可以通过遍历合并的目录并保留最新文件来创建`Map<String, File>`要复制的文件。然后，您可以复制地图中的文件。

示例代码（尚未尝试过）可能如下所示：

```
public void copyDifferentFolderFilesIntoOne(String mergedFolderStr,
        String... foldersStr) {
    final File mergedFolder = new File(mergedFolderStr);
    final Map<String, File> filesMap = new HashMap<String, File> ();
    for (String folder : foldersStr) {
        updateFilesMap(new File (folder), filesMap, null);
    }

    for (final Map.Entry<String, File> fileEntry : filesMap.entrySet()) {
        final String relativeName = fileEntry.getKey();
        final File srcFile = fileEntry.getValue();
        FileUtils.copyFile (srcFile, new File (mergedFolder, relativeName));
    }
}

private void updateFilesMap(final File baseFolder, final Map<String, File> filesMap,
        final String relativeName) {
    for (final File file : baseFolder.listFiles()) {
        final String fileRelativeName = getFileRelativeName (relativeName, file.getName());

        if (file.isDirectory()) {           
            updateFilesMap(file, filesMap, fileRelativeName);
        }
        else {
            final File existingFile = filesMap.get (fileRelativeName);
            if (existingFile == null || file.lastModified() > existingFile.lastModified() ) {
                filesMap.put (fileRelativeName, file);
            }
        }
    }
}

private String getFileRelativeName(final String baseName, final String fileName) {
    return baseName == null ? fileName : baseName + "/" + fileName;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:17:01.380

To copy file, look at [Standard concise way to copy a file in Java?](https://stackoverflow.com/questions/106770/standard-concise-way-to-copy-a-file-in-java)

To get timestamp, see [File.lastModified()](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#lastModified%28%29)

# java - 如何传递给方法 TreeSet 或 HashMap 并显示它？

> ID：13502855
> 
> 赞同：3
> 
> 时间：2012-11-21T22:08:35.827
> 
> 标签：java, collections, hashmap, treeset

我有这样的方法：

```
public void show(Object o)
{
   //show content of object
} 
```

我想将 TreeSet 或 HashMap 传递给它。但它是一个不同的迭代，我的意思是，当我想显示 TreeSet 的内容时，我使用该代码：

```
 while ( iter.hasNext() )
    {
      System.out.println( iter.next());
    } 
```

但是当我有一个 HasMap 时，我会这样打印它：

```
Iterator iterator = map.keySet().iterator();  

while (iterator.hasNext()) {  
   String key = iterator.next().toString();  
   String value = map.get(key).toString();  

   System.out.println(key + " " + value);  
} 
```

当我不知道用户是否传递 TreeSet 或 HashMap 时，有没有办法显示集合的内容？我无法在 show 方法中进行任何转换（这不是重点）。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:12:46.283

不是直接的，但是如果你的方法被声明为：

```
public <T> void show(Iterable<T> iterable) {
  for(T t: iterable) {
    System.out.println(t);
  }
} 
```

那么你可以像这样使用它：

```
show(set);
show(map.entrySet()); 
```

不完全是您想要的，但本质`Map`上`Set`是不同的，您不能真正以相同的方式对待它们（多态）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:13:36.063

```
if (o instanceof Map) {
            HashMap map = (HashMap) o;
            Iterator iterator = map.keySet().iterator();

            while (iterator.hasNext()) {
                String key = iterator.next().toString();
                String value = map.get(key).toString();

                System.out.println(key + " " + value);
            }
        } else if (o instanceof Set) {
            TreeSet tree = (TreeSet) o;
            Iterator iter = tree.iterator();
            while (iter.hasNext()) {
                System.out.println(iter.next());
            }
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T22:17:02.473

The answer is yes, but it's a little ugly:

```
public static void display(Object o) {
    if (o instanceof Iterable) { // includes Sets, Lists etc
        for (Object element : (Iterable<?>) o) {
            System.out.println(element);
        }
    } else if (o instanceof Map) {
        for (Map.Entry<Object, Object> entry : ((Map<Object,Object>) o).entrySet()) {
            System.out.println(entry.getKey() + " " + entry.getValue());
        }
    } else if (o != null && o.getClass().isArray()){
        // How to detect and handle arrays
        for (Object element : (Object[])o) {
            System.out.println(o);
        }
    } else {
        // default case
        System.out.println(o);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T23:00:56.447

遵循更紧密的面向对象方法，您可以为 TreeSet 和 HashMap 类创建装饰器。然后，不是调用 show(object)，而是调用 object.show()，恕我直言，它更干净，并且遵循 OOP 原则，例如封装和抽象：

```
public interface Showable {
    void show();
}

public class ShowableTreeSet<E> extends TreeSet<E> implements Showable
{
    private TreeSet<E> delegate;

    public ShowableTreeSet(TreeSet<E> delegate) {
        this.delegate = delegate;
    }

    public void show() {
        for (E e : delegate) {
            System.out.println(e);
        }
    }

    public boolean add(E e) {
        return delegate.add(e);
    }

//all other delegate methods
}

public class ShowableHashMap<K, V> extends HashMap<K, V> implements Showable 
{
    private HashMap<K, V> delegate;

    public ShowableHashMap(HashMap<K, V> delegate) {
        this.delegate = delegate;
    }

    public void show(){
        Iterator<K> iterator = delegate.keySet().iterator();  

        while (iterator.hasNext()) {  
           String key = iterator.next().toString();  
           String value = delegate.get(key).toString();  

           System.out.println(key + " " + value);  
        } 
    }

    public int size() {
        return delegate.size();
    }

//all other delegate methods
} 
```

因此，您只需将可展示的内容包裹在您将使用的任何实际对象周围：

```
ShowableTreeSet<String> sts = new ShowableTreeSet<String>(new TreeSet<String>());
sts.show(); 
```

或者，如果您只想要任何 Showable 用于打印输出，您可以：

```
Showable showable = new ShowableTreeSet<String>(new TreeSet<String>());
showable.show(); 
```

您可以为几乎任何东西创建这些装饰器 - Iterable、List、Collection 等......然后使用依赖注入来使用您碰巧使用的任何 Collection（Iterable、List...）实现。

# mysql - 选择 myiasm 和 innodb 的场景

> ID：13502856
> 
> 赞同：-1
> 
> 时间：2012-11-21T22:08:42.637
> 
> 标签：mysql

我知道 myiasm 不支持像 innodb 这样的事务。

有人可以给我一个例子，说明选择正确的数据库引擎如何影响事情的运作方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:12:41.577

MyISAM 使用表级锁定。InnoDB 是行级的。

[http://dev.mysql.com/doc/refman/5.0/en/internal-locking.html](http://dev.mysql.com/doc/refman/5.0/en/internal-locking.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:14:29.747

在许多情况下，MyISAM 对许多操作的速度会快两倍或更多，但如果您没有做好准备，您为这种速度付出的代价可能是相当可观的。MySQL 服务器进程的硬崩溃可能是由多种因素引起的，包括简单的断电情况，可能会损坏 MyISAM 表而无法恢复。InnoDB 表的抵抗力更强，通常可以在典型的最坏情况下以只读模式恢复，如果不为您自动修复和恢复。

MyISAM 更快的简单原因是它不保留日志并且不需要处理[MVCC](http://en.wikipedia.org/wiki/Multiversion_concurrency_control)。不过，这些东西对于大多数应用程序都很重要。

与往常一样，您应该及时备份所有数据。

我建议仅将 MyISAM 用于具有极端性能问题的衍生数据。为此，您可以按需从源 InnoDB 表复制到 MyISAM，作为​​物化视图，或使用触发器来保持同步。这对于使 MyISAM 充当 InnoDB 数据的高速缓存很有用。

我不提倡将表随机切换到 MyISAM 以获得更好的性能。

# c# - 查询字符串数据类型不匹配

> ID：13502857
> 
> 赞同：0
> 
> 时间：2012-11-21T22:09:05.727
> 
> 标签：c#, sql, visual-studio, excel, oledb

我正在使用 OLEDB 使用日期时间选择器查询 excel 文件，但我不断收到 cireria 表达式错误中的数据类型不匹配错误。

excel中日期的格式是“6/08/2012 10:00”

```
 DateTime time = dateTimePicker1.Value;            

        MyCommand = new OleDbDataAdapter("select * from [CR$] where ([Req Start Date] >='" + time + "')", MyConnection);

        DtSet = new System.Data.DataSet();
        MyCommand.Fill(DtSet);

        bindingSource1 = new BindingSource();
        bindingSource1.DataSource = DtSet;
        bindingSource1.DataMember = DtSet.Tables[0].TableName;
        dataGridView1.DataSource = bindingSource1;

        MyConnection.Close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:12:56.440

您将时间作为字符串传递给查询，因此您*可以*ToString() 使其工作：

```
MyCommand = new OleDbDataAdapter("select * from [CR$] where ([Req Start Date] >='" + time.ToString("%M/dd/yyyy HH:mm") + "')", MyConnection); 
```

但是你真的应该把它作为一个参数。另外，这样更安全。

```
 using (OleDbConnection connection = new OleDbConnection(yourConnectionString))
    {
        OleDbDataAdapter adapter = new OleDbDataAdapter("select * from [CR$] where [Req Start Date] >= ?", connection);
        adapter.SelectCommand.Parameters.Add("@p1", OleDbType.Date);
        adapter.SelectCommand.Parameters["@p1"].Value = time;

        try
        {
            connection.Open();
            adapter.Fill(DtSet);
        }
        catch (Exception ex)
        {
            //handle error
        }
    } 
```

了解更多：[OleDbParameter 类](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbparameter.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:14:06.920

创建一个 OleDbCommand 并将值作为参数传入。然后使用 Command 作为 OleDbAdapter 构造函数的参数...

```
string queryString = "select * from [CR$] where ([Req Start Date] >= ?)";
OleDbCommand command = new OleDbCommand(queryString, connection);
command.Parameters.Add("@p1", OleDbType.DateTime).Value = time;
MyCommand = new OleDbDataAdapter(queryString, MyConnection); 
```

# javascript - javascript postMessage - 测试消息的接收

> ID：13502858
> 
> 赞同：1
> 
> 时间：2012-11-21T22:09:08.570
> 
> 标签：javascript, iframe, cross-domain, postmessage

我使用 postMessage 在主机和我的域的 iframe 之间进行通信。

这是 hostdomain.org 上的代码：

```
function rec_tyd(json_var)
{
  //if i decode and alert json_var there i get the content.
  var win = document.getElementById("tyd_frame").contentWindow;
  win.postMessage(json_var, "http://multipress.fr/tyd//module/pro_mod.php");
}

<iframe src="http://example.org/myiframe.php" width="500" height="200" 
name="tyd_frame" id="tyd_frame" style="border:1px solid black;"</iframe> 
```

json_var 是一个 JSON 对象。

我的域 example.org/myiframe.php 上的代码是：

```
if (!window.addEventListener)   // IE
  {window.addEventListener = function (type, listener, capt) {
  attachEvent("on"+type, function(){listener(event)});}
}

addEventListener("message", function(e) {       
  var final = JSON.parse(e.data);
  alert(final.id_product);
  alert(final.id_company);
}, false); 
```

基本上，一切正常，除了：

*   在第一次加载时，我在 iframe 中没有得到任何东西
*   当我重新加载一次时，我得到了价值
*   如果我刷新主机页面，我将一无所获。

Chrome 和 FireFox 中的相同：刷新不起作用，但如果进入地址栏并按 Enter 键，它会起作用。除了第一次。

我检查了我的 JSON 对象，并在 postmessage 之前得到它。它真的在 iframe 中，我什么也得不到。

所以我的问题是：我怎样才能测试我得到了什么？我在代码中犯了错误吗？

目前我实际上在同一个域上工作，但它将在不同的域上进行生产。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-24T07:13:46.427

在评论中解决:)

==> 当文档准备好时停止启动我的 postMessage，但将其置于 iframe 的 onload 状态，似乎问题已解决！谢谢

# extjs - Ext.js Combox keydown 触发没有选择的选择事件

> ID：13502859
> 
> 赞同：2
> 
> 时间：2012-11-21T22:09:17.000
> 
> 标签：extjs, combobox

我正在尝试制作一个实时搜索组合框，除了一个小细节外，一切都很好。当用户通过组合框按下向下键和向上键时，我想调用搜索方法。这确实触发了一个选择事件，但派克没有选择。当我用鼠标或按回车选择组合框项目时，选择事件确实得到了选择。我想在导航框时使用通过向下键和向上键选择的值启动查询。

组合码

```
searchField = new Ext.form.ComboBox({
    id:'searchField',
    store: queryCacheStore,
    pageSize:0,
    width: 780,
    triggerAction:'all',
    typeAhead:false,
    mode:'remote',
    minChars:2,
    forceSelection:false,
    hideTrigger:true,
    enableKeyEvents:true,
    queryDelay:200,
    queryMode:'remote',
    queryParam:'query',
    queryCaching:false,
    displayField:'query',
    autoSelect:false,
    listConfig:{
        loadingText: 'Searching...',

          // Custom rendering template for each item
          getInnerTpl: function() {
              return '<div class="search-item">' +
                  '{query}' +
                  '</div>';
          }
      },
    listeners: {
        specialkey:function (field, e) {
            if (e.getKey() == e.UP || e.getKey() == e.DOWN) {

            }
        },
        select:function (combo, selection) {
            var post = selection[0];
            searchField.setValue(post.get('query'));
            requestAccessList.runSearch();
        },
        focus:function (combo, event, opts) {
            combo.store.proxy.extraParams = {
                'lcm':true,
                'type':RequestAccess.OBJECT_TYPE
            }
        }
    }

}); 
```

所以当

```
select:function (combo, selection) { 
```

使用向下箭头键或向上箭头键调用，然后选择为空。当使用回车键或鼠标单击调用它时，它具有突出显示的组合框选择。所以问题是如何从箭头键事件中获取组合框的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T07:30:49.390

好的，我自己想通了。您必须覆盖 BoundListKeyNav 的高亮事件

```
Ext.view.BoundListKeyNav.override({
      highlightAt:function (index) {
//            this.callOverridden(index);      For some reason this does not work
        var boundList = this.boundList,
        item = boundList.all.item(index);
        if (item) {
            item = item.dom;
            boundList.highlightItem(item);
            boundList.getTargetEl().scrollChildIntoView(item, true);
            searchField.setValue(boundList.getNode(index).textContent);
            searchService.runSearch();
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-08T01:46:39.980

我将以下 listConfig 添加到组合框以完成类似的操作：

```
listConfig: {
    listeners: {                    
         highlightitem: function(view, node, eOpts) {
             combo.setValue(node.innerText);
          }
     }
 } 
```

它会在鼠标悬停和向上/向下键时更新组合框文本字段的值。

# linq - 使用 Linq 中的连接从字典表中选择字段

> ID：13502871
> 
> 赞同：0
> 
> 时间：2012-11-21T22:09:44.050
> 
> 标签：linq, entity-framework-4

我有 2 个数据库表。一种是主记录，另一种是使用字典结构的详细记录。

我想从详细信息表中查询一些字段，这些字段返回具有所有相同标题 ID 的多行。

有没有办法使用 linq 连接两个表来创建自定义记录

例子

主表：ID MasterName Date ...

明细表 ID MasterID 键值

伪代码：从 master in context.mastertable 加入细节在 context.detailstable on master.ID == detail.masterID SELECT new CustomClass{ ID = master.ID, Name = master.MasterName Customfield = (detailsvalue.where key == "customfield ") + (detailvalue.where key == "customfield2") };

希望可以有人帮帮我。

格茨·卢克·克里宁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:41:24.790

您可以使用在 Join() 方法中创建的匿名类型。

```
 List<Master> list1 = new List<Master>(){
    new Master(){ Id=1, Name="Name1"},
    new Master(){ Id=2, Name="Name2"}};

  List<Detail> list2 = new List<Detail>(){
    new Detail(){ Id=1, MasterId=1, Description="Description1"},
    new Detail(){ Id=2, MasterId=1, Description="Description2"},
    new Detail(){ Id=3, MasterId=1, Description="Description3"},
    new Detail(){ Id=4, MasterId=2, Description="Description4"},
    new Detail(){ Id=5, MasterId=2, Description="Description5"}};

  // IEnumerable of anonymous types
  var result = list1.Join(list2, m => m.Id, d => d.MasterId, (m, d) => new { Id = m.Id, Name = m.Name, Description = d.Description });

  foreach (var item in result)
    Console.WriteLine(item.Id + " " + item.Name + " " + item.Description + Environment.NewLine);

  // Returns
  // 1 Name1 Description1
  // 1 Name1 Description2
  // 1 Name1 Description3
  // 2 Name2 Description4
  // 2 Name2 Description5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:29:28.173

像这样的东西不会起作用吗？：

```
var query = from master in context.masterTable
            join detail in context.detailTable
            on master.Id == detail.masterId
            where detail.Key == "customField" || detail.Key == "customField2"
            select new
            {
                id = master.Id,
                name = master.Name,
                customField = detail.Key
            }; 
```

如果没有，请详细说明您正在寻找什么。IE 描述你的数据是如何存储的，以及你希望从这个查询中得到的最终结果。

# sql-server - 将 INNER JOINS 中的几个 ON 子句放在一起是什么意思

> ID：13502873
> 
> 赞同：5
> 
> 时间：2012-11-21T22:09:53.607
> 
> 标签：sql-server, tsql, sql-server-2005

我偶然发现了在 SQL Server 2005 数据库上创建的 T-SQL 查询：

```
Select s_bs.ScheduleHeaderId, 
       s_bs.ScheduleBatchScheduleId, 
       FlowRateOperational.FlowRate, 
       BatchScheduleFlowRateOperational.EffectiveStartTime, 
       BatchScheduleFlowRateOperational.EffectiveEndTime
From BatchSchedule as bs 
Inner Join ConnectionPoint as cp on bs.ConnectionPointId = cp.ConnectionPointId 
Inner Join ScheduleBatch as s_b 
Inner Join ScheduleConnectionPoint as s_cp 
Inner Join ScheduleBatchSchedule as s_bs 
            on s_cp.ScheduleConnectionPointId = s_bs.ScheduleConnectionPointId 
            on s_b.ScheduleBatchId = s_bs.ScheduleBatchId 
            on cp.ConnectionPointName = s_cp.ConnectionPointName and bs.BatchID = s_b.BatchID 
Inner Join BatchScheduleFlowRateOperational on bs.BatchScheduleId = BatchScheduleFlowRateOperational.BatchScheduleId 
Inner Join FlowRateOperational on BatchScheduleFlowRateOperational.FlowRateOperationalId = FlowRateOperational.FlowRateOperationalId 
```

到目前为止，我还不是 SQL 专家，但至少我认为我知道如何连接表，而且我以前从未见过这种连接表的方式。

在 JOINS 之后将多个 ON 子句放在一起会产生不同的结果或提高性能吗？

为什么这个人不能只是移动连接并将 ON 子句保留在相应的 JOIN 旁边？

感谢您对这个“谜团”的任何启发:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:42:53.353

当您只有内部连接时，连接顺序无关紧要。结果集是相同的。以下两个版本是等效的。

常见的加盟方式：

```
FROM 
    tableA AS a
  JOIN
    tableB AS b
      ON b.aid = a.aid
  JOIN
    tableC AS c
      ON c.bid = b.bid 
```

并且不那么常见（请注意括号只是为了清楚优先级，它们可以安全地删除，如您的查询中一样）：

```
FROM 
    tableA AS a
  JOIN
      (   tableB AS b
        JOIN
          tableC AS c
            ON c.bid = b.bid
      )
    ON b.aid = a.aid 
```

* * *

当你有外部连接时（`LEFT`、`RIGHT`或`FULL`），情况就不同了。如果您将上述查询中的 替换为`JOIN`，`LEFT JOIN`则它们**不等效**，可能会产生不同的结果集。

即使是（许多）加入中的一个也很重要。以下两个不等价：

```
FROM 
    tableA AS a
  LEFT JOIN
    tableB AS b
      ON b.aid = a.aid
  JOIN
    tableC AS c
      ON c.bid = b.bid

FROM 
    tableA AS a
  LEFT JOIN
          tableB AS b
        JOIN
          tableC AS c
            ON c.bid = b.bid

    ON b.aid = a.aid 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:30:02.963

这不是答案，只是改变了条件的位置（我认为）

```
Select s_bs.ScheduleHeaderId, 
       s_bs.ScheduleBatchScheduleId, 
       f.FlowRate, 
       b.EffectiveStartTime, 
       b.EffectiveEndTime
From 

BatchSchedule as bs Inner Join 

ConnectionPoint as cp on 
   cp.ConnectionPointId=bs.ConnectionPointId  Inner Join 

ScheduleBatch as s_b on
s_b.BatchID=bs.BatchID Inner Join 

ScheduleConnectionPoint as s_cp  on 
   s_cp.ConnectionPointName=cp.ConnectionPointName  Inner Join

ScheduleBatchSchedule as s_bs on 
   s_bs.ScheduleConnectionPointId = s_cp.ScheduleConnectionPointId Inner Join 

BatchScheduleFlowRateOperational b on 
b.BatchScheduleId = bs.BatchScheduleId  Inner Join 

FlowRateOperational f on 
f.FlowRateOperationalId=b.FlowRateOperationalId

where
s_bs.ScheduleBatchId = s_b.ScheduleBatchId 
```

或者您可以将`where`条件放在s_bs`and`之后的语句`inner joining`中，但我认为如果它在链外，它会更加突出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T22:37:03.077

它对内部连接没有影响，但它当然会为其他类型的连接产生完全不同的结果。

作为一个人为的示例，`a LEFT JOIN (b CROSS JOIN c) ON b.a = a.a AND c.a = a.a`将只同时为表 b 和 c 返回非空行，但`a LEFT JOIN b ON b.a = a.a LEFT JOIN c ON c.a = a.a`将独立评估子句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T02:34:51.297

该`ON`子句可以放在每个之后`INNER JOIN`（这对我来说看起来更好）。但有时不可避免地将`ON`前几个连接的子句放在后面的连接之后。例如，提供连接条件的表在链中尚不可用`JOIN`，例如：

```
SELECT * FROM 
A INNER JOIN 
B INNER JOIN 
C 
   ON B.Col1 = C.Col1 
   ON A.Col2 = C.Col2 
```

看看这两个`ON`子句都在引用，`C`所以相关的`ON`子句不能更早出现。可以通过将其`C`放在首位来防止它，但根据使用情况，人们可能会发现它的可读性较差。

以上只是从语法的角度来看。还应该有一些性能考虑，我不知道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T22:24:11.400

它只是写得很丑，我很确定它与以下内容相同：

```
 Select s_bs.ScheduleHeaderId, 
       s_bs.ScheduleBatchScheduleId, 
       FlowRateOperational.FlowRate, 
       BatchScheduleFlowRateOperational.EffectiveStartTime, 
       BatchScheduleFlowRateOperational.EffectiveEndTime
From BatchSchedule as bs 
Inner Join ConnectionPoint as cp on bs.ConnectionPointId = cp.ConnectionPointId 
Inner Join ScheduleBatch as s_b on s_b.BatchID = bs.BatchID
Inner Join ScheduleBatchSchedule as s_bs on s_b.ScheduleBatchId = s_bs.ScheduleBatchId 
Inner Join ScheduleConnectionPoint as s_cp on s_cp.ScheduleConnectionPointId = s_bs.ScheduleConnectionPointId and s_cp.ConnectionPointName = cp.ConnectionPointName
Inner Join BatchScheduleFlowRateOperational on bs.BatchScheduleId = BatchScheduleFlowRateOperational.BatchScheduleId 
Inner Join FlowRateOperational on BatchScheduleFlowRateOperational.FlowRateOperationalId = FlowRateOperational.FlowRateOperationalId 
```

# ios - iOS NewsStand 现有网络订阅者

> ID：13502874
> 
> 赞同：3
> 
> 时间：2012-11-21T22:09:56.710
> 
> 标签：ios, in-app-purchase, newsstand-kit

我们公司有一个现有的会员模式，我们将其用于我们的网站。会员可以在网上查看双月刊。我们正在考虑将其转换为 iOS 报亭应用程序。我们如何创建一个报亭应用程序，将我们的内容免费提供给我们的会员，但不允许其他用户获取这些内容？

我觉得报亭应用程序与普通应用程序具有几乎相同的功能。所以我想我们可以显示用户名/密码警报视图并强制用户使用网络服务登录。但是，Apple 会拒绝这样做的新闻站应用程序吗？

任何关于如何仅通过报摊向现有网络成员提供内容的想法/建议将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T23:46:07.280

以防有人偶然发现这个问题。看起来你可以在报亭应用程序中做任何你想做的事情。我在商店里看到过一些可以让您使用 Web 凭据登录来解锁内容的方法。

所以简短的回答：

只需为网络客户添加一个按钮。使用 Web 服务调用对用户进行身份验证。添加应用端逻辑以确定客户也可以访问哪些问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T13:40:57.523

您回答了您的问题，但我只想与您分享我的经验。你是对的，你可以这样做，但如果你没有至少一个免费的自动续订订阅，Apple 将拒绝你的应用程序。

他们将让您在杂志内进行自己的订阅，就像那些在所有设备上拥有无数订阅类型的大公司一样，但他们不会让您只使用报亭套件来做到这一点。

您应该至少为您的用户提供一个免费订阅按钮，如果它不是免费的，您应该执行另一个您为其设置价格和时间的按钮。

因为您的内容要么是免费的，所以没有必要使用第三方解决方案进行订阅，只需将免费按钮放在那里，或者不是。因此，Apple 认为其 30% 的收入来自您的销售，如果您在外面销售并利用报摊，Apple 不会让您这样做。

看看这个链接，绝对是这两个视频。它解释了其中的所有内容：

[https://developer.apple.com/devcenter/ios/newsstand/](https://developer.apple.com/devcenter/ios/newsstand/)

# c# - 使用 DataSet 表创建 xml

> ID：13502878
> 
> 赞同：4
> 
> 时间：2012-11-21T22:10:10.003
> 
> 标签：c#, xml, datatable, xsd, dataset

我创建了 xsd：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema targetNamespace="test" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Extension">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="parent">
          <xs:annotation>
            <xs:documentation></xs:documentation>
          </xs:annotation>
          <xs:complexType>
            <xs:sequence>
              <xs:element minOccurs="1" maxOccurs="unbounded" name="parentItem">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="child">
                      <xs:annotation>
                        <xs:documentation></xs:documentation>
                      </xs:annotation>
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element minOccurs="1" maxOccurs="unbounded" default="10" name="childItem" type="xs:integer" />
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

我想将此模式加载到 DataSet 中，然后编辑和创建 xml

所以我尝试用值 100 填充 childItem 元素：

```
 DataSet a = new DataSet();
  a.ReadXmlSchema(mySchema);
  a.Tables[3].Rows.Add(100); 
```

然后我执行：

`a.getXml()`- 结果：

```
<Extension xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="test">
  <childItem xmlns="">100</childItem>
</Extension> 
```

如您所见，它完全忽略了架构关系-在架构中，您可以看到 childItem 上方的每个父元素都是必需的，因此如果我将值添加到最深的子项中，我希望 xml 像：

```
<Extension>
   <Parent>
      <ParentItem>
        <Child>
          <ChildItem>100<ChildItem/>
        <Child/>
      <ParentItem/>
   <Parent/>
<Extension/> 
```

我是否遗漏了什么，或者这是 DataSet 的标准行为？非常感谢我正在使用 c# 和 net4.0，winforms

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T00:19:24.277

这是 DataSet 结构；除非您遵循层次结构并适当地提供 ID，否则您将无法获得所需的输出。如果您考虑过，您看不到**扩展实体**[也是有原因](http://paschidev.com/Whitepapers/Deriving_DataSet_from_XML_Schema.html)的。

 **![在此处输入图像描述](../Images/138c42507253b8e4dd1adde1c851aa42.png)

由于您只插入**100**，其中表的结构是两列，因此您会为 *child_Id*获得一个 NULL 值。该列允许空值，因此插入通过，因为空值满足外键约束。

要检查，如果你这样做：

```
 a.Tables[3].Columns[1].AllowDBNull = false; 
```

在添加之前，您会看到此错误：

```
Error line 11:      a.Tables[3].Rows.Add(100);
Column 'child_Id' does not allow nulls. 
```

如果你这样做：

```
a.Tables[3].Rows.Add(100, 0); 
```

你得到：

```
Error line 11:      a.Tables[3].Rows.Add(100, 0);
ForeignKeyConstraint child_childItem requires the child key values (0) to exist in the parent table. 
```

那么问题似乎是该工具添加的参照完整性列允许为空 - 没有选项可以克服这种行为。**

# linux - 子域上的 403 禁止错误 (CentOS 5.8)

> ID：13502880
> 
> 赞同：0
> 
> 时间：2012-11-21T22:10:16.343
> 
> 标签：linux, apache, .htaccess, centos, http-status-code-403

好吧，我在 cpanel 中创建了一个子域 test.xyz.com，将其指向 /test 文件夹，然后在其中插入了一个 index.php 文件，仅此而已。

当我试图访问它时，我得到一个`500 Internal Server Error`Apache 说：

```
*Wed Nov 21 14:20:59 2012] [error] [client xx.xxx.xxx.xx] SoftException in Application.cpp:256: File "/home/username/public_html/test/index.php" is writeable by group"* 
```

所以我将权限更改为 750 ( `chmod -R 750 /home/username/public_html/test`)

然后刷新后我收到了一个`403 Forbidden error`，Apache 报告了一个：

```
*[Wed Nov 21 13:59:12 2012] [crit] [client xx.xxx.xxx.xx] (13)Permission denied: /home/username/public_html/test/.htaccess pcfg_openfile: unable to check htaccess file, ensure it is readable* 
```

我的目录中没有 .htaccess 文件，因此我尝试在其中放置一个文件，但这并没有以任何方式更改错误消息。我进行了广泛的搜索，但我看到的唯一解决方案是调整到各种权限级别，我尝试过各种组合。

# ios - 在 iOS 应用上显示 Facebook 相册照片

> ID：13502881
> 
> 赞同：1
> 
> 时间：2012-11-21T22:10:17.083
> 
> 标签：ios, view, image

我想在我的 ios 应用程序中显示一个 facebook 相册。我得到了相册和照片图形对象，我知道我可以获取 FBProfile 图片视图并设置照片 ID，它将为我完成所有显示。但我不知道如何实现我的观点。

它必须动态设置，因为在我从 facebook 获取相册之前，我不知道需要显示多少张图片。另外，如果有很多图片，我需要滚动选项。知道怎么做吗？也许示例代码？我相信很多人都实现了在应用程序中显示未知数量的图片。它应该看起来类似于 iphone 的主屏幕，您在其中拥有所有应用程序图标 4x5

编辑：还忘了提到它必须是“可点击的”，因为在他们点击图片后，我想将他们发送到另一个显示图片全尺寸的视图

# finch - 如何停止所有在 finch 中播放的文件？

> ID：13502886
> 
> 赞同：1
> 
> 时间：2012-11-21T22:10:29.750
> 
> 标签：finch

我的问题是，有没有办法可以用一个语句阻止所有声音同时播放？例如，如果有 20 种声音在播放，我如何在不写 20 条语句的情况下阻止它们？

# php - PHP 将数组返回到 JavaScript Ajax 调用

> ID：13502887
> 
> 赞同：0
> 
> 时间：2012-11-21T22:10:34.113
> 
> 标签：php, javascript, ajax, arrays

我在一个返回数学问题的类中有 PHP 函数：

```
public function level1() {

    //level 1 and 2
    //single digit addition and subtraction
    //randomly choose addition or subtraction
    //1 = addtion, 2 - subtraction
    $opperand = rand( 1, 2 );

    //if the problem is a subtraction, the program will keep generating problems if a negative problem is generated
    //if opperand is a subtraction, do generate both numbers while the answer is negative

    if ( $opperand == 2 )
        {
        do {

            //randomly generate first number
            $number1 = rand( 1, 9 );

            //randomly generate second number
            $number2 = rand( 1, 9 );

            //compute the answer
            $answer = $number1 - $number2;

            //change variable to actual opperand
            $opperand = "-";
        } while ( $answer < 0 );
        }
    else
        {//addition problem
        //randomly generate first number
        $number1 = rand( 1, 9 );

        //randomly generate second number
        $number2 = rand( 1, 9 );

        //compute the answer

        $answer = $number1 + $number2;

        //change variable to actual opperand
        $opperand = "+";
        }//end if/else

    return array( $number1 . " " . $opperand . " " . $number2 . " ", $answer ); 
```

我从 ajaxHandler.php 调用这个函数（我从 ajax 调用）

```
 $problemData = $MathEngine->level1();
    return $problemData; 
```

php 将始终返回一个数组，但我无法弄清楚如何在 javascript 中将结果作为数组进行操作甚至查看。有没有办法做到这一点？我以前使用过标准的 Get ajax 调用，所以这并不新鲜。当我尝试将 ajax 响应文本作为数组引用时，我要么一无所获（当我单击按钮时）要么“未定义”

```
 var problemData = ajaxRequest.responseText;

           alert( problemData[0] ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:21:58.720

```
// php - this will produce a json string
echo json_encode(array( $number1 . " " . $opperand . " " . $number2 . " ", $answer ));

// and in javascript - parse json string to javascript object
var problemData = JSON.parse(ajaxRequest.responseText); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:14:28.087

尝试`echo $problemData;`而不是返回它。你打电话的时候有什么错误`alert( problemData[0] )`？ajax 只捕获字符串或 json 对象，因此唯一的方法是将此数组作为字符串返回并将其拆分为 js 或在 php 端的该数组上使用 json_encode

```
var data = problemData.split(' ');
alert(data[0]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T22:31:36.727

我会使用 JSON。如果您以前从未听说过 JSON，它只是一种在语言/平台之间来回发送内容的简单方法。

在您的 PHP 脚本中，添加此代码段以将您的数组作为 JSON 编码文本回显。对您的 AJAX 请求的响应将是您回显的任何内容。

```
// End of PHP script
$problemData = $MathEngine->level1();
$tmpOut = '{"bind":'. json_encode(array("problemData" => $problemData)) .'}';
echo $tmpOut;
exit; 
```

现在在您的 Javascipt 中，解码您的 JSON 字符串。

```
// Javascript
var jsonObj=eval("("+ajaxRequest.responseText+")");
var problemData = jsonObj.bind.problemData; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T09:56:04.147

您可以使用 json 对象从 javascript(AJAX) 向 php 发送和接收数据。使用 json_encode() 对 php 中的数据进行编码，然后以 html 或 text 的形式将其传递给 javascript。javascript 然后调用 json_decode 来检索数据并显示。

# c# - 数据表数据检查难题

> ID：13502896
> 
> 赞同：1
> 
> 时间：2012-11-21T22:11:31.083
> 
> 标签：c#, datatable

我正在寻求一些 Visual Studio C# 代码的帮助。

我有一个包含一些行和数据的数据表，如下所示：

```
Id      CodeNum     LineNum
1023503     4001        1
1023504     4001        1
1023505     4001        1
1023506     4002        1
1023507     4002        1
1023508     4002        1
1023509     4002        1
1023510     4003        2
1023511     4003        2
1023512     4003        2
1023513     4003        2
1023514     4004        2
1023515     4004        2
1023516     4005        3
1023517     4005        3
1023518     4006        3
1023519     4006        3
1023520     4006        3
1023521     4007        4
1023522     4007        4
1023523     4008        4
1023524     4009        5
1023525     4009        5
1023526     4009        6   x
1023527     4010        6
1023528     4011        6 
```

我需要编写一种方法来对所有表行进行错误检查，并确保任何 CodeNum 只分配一个 LineNum。例如，CodeNum 4002 的行仅分配了 LineNum 1，并且说 CodeNum 4005 的行仅分配了 LineNum 3。

LineNum 可以与多个 CodeNum 相关联，但 CodeNum 不能与多个 LineNum 值相关联。

上面的示例中有一个错误，其中 CodeNum 4009 的第 3 行的 LineNum 为 6 而不是 5，这里我希望弹出一条错误消息，说明类似于 Error row id 1023526。

真实表/数据包含许多行，并且 CodeNum 值和 LineNum 值没有模式（所有值都是整数）。

我希望这是有道理的。我正在努力想一个快速简洁的方法来编码这个错误检查方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:17:28.503

您可以转换为查找，然后搜索计数 > 1 的分组：

```
using System.Linq;

var badRecords = collection.ToLookup(x => x.CodeNum).Where(y => y.Count() > 1); 
```

# browser-automation - 你如何制作一个自动浏览网页但不在浏览器中的程序？

> ID：13502897
> 
> 赞同：0
> 
> 时间：2012-11-21T22:11:35.313
> 
> 标签：browser-automation

我用 python 编写了一个程序，该程序使用 selenium 来自动化 Web 浏览器（firefox）。它运行良好，但我见过自动浏览网页的程序，但它似乎在某种窗口或框架（iframe？）中，而不是在浏览器中。你怎么做到这一点？是不是因为窗口只关注一个特定的网站而更快？

谢谢。

编辑：

我不知道...我下载了一个程序并运行它，它为我打开了一个窗口并在一个特定的网站上自动浏览互联网。

这里是下载： [http](http://bankhead11.webs.com/downloads.htm) ://bankhead11.webs.com/downloads.htm 是第一个。（它是一个旧程序。人们报告说它在几年前就停止工作了，因为这个人停止更新它。但是很多人用它在网站上“自动出价”以赚钱。我不想解释.. .但目前我想做两个程序。一个会自动为我实时出价，另一个将使用google api并将数据提交到网站）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T12:25:34.840

Performing automation in browser is the best way to test the application, instead of some app testing on some different window/Frame. You can test the functionality but that testing will be incomplete until you test on Actual browser.

If you are looking for fastest way of browser automation, selenium do provide you with an Option of "HTMLUNIT" driver (No GUI), it's much more faster than any browser automation.

check the following link for more details

[http://seleniumhq.org/docs/03_webdriver.html#selenium-webdriver-s-drivers](http://seleniumhq.org/docs/03_webdriver.html#selenium-webdriver-s-drivers)

Hope this helps you ..All the best:)

# apache - 我需要一个 .htaccess 规则来将 url 从 example.com/xyz 重写为 xyz.example.com

> ID：13502899
> 
> 赞同：2
> 
> 时间：2012-11-21T22:11:38.733
> 
> 标签：apache, .htaccess, mod-rewrite

我目前有一个在子文件夹中运行的多个应用程序，我想移动到子域并用新网站替换当前站点，但仍然允许在以前的 url 中找到旧应用程序

当前：mysite.com/application/page1.aspx

我想要做的是将此应用程序移动到 application.mysite.com/page1.aspx

我需要一个 .htaccess 重写规则来做两件事

1.  仍将允许某人转到 mysite.com/application/page1.aspx 并访问应用程序
2.  保持页面上显示的 URL 为 mysite.com/application/page1.aspx，隐藏它是子域的事实。

隐藏子域并不重要，因为它可以让 Google 高兴地在那些页面上找到它一直存在的内容。

注意：这个新的主站点是一个 wordpress 站点。

这是我现在在 htaccess 中的内容

* * *

```
<IfModule mod_rewrite.c>

RewriteEngine On
RewriteBase /foldername/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{HTTP_HOST} mysite.com/foldername$ [NC]
RewriteRule ^adminpgm/(.*)$ http://SUBDOMAIN.mysite.com/adminpgm/$1 [R=301,L]

RewriteRule . /foldername/index.php [L]

</IfModule> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:16:25.997

因为 Wordpress 还使用带有子文件夹的 url，这将很难自动化（如果你使用漂亮的 url，每个帖子、页面、类别等都可以显示为子文件夹）。

如果您确切知道要移动哪些应用程序，则可以这样做：

```
RewriteCond %{REQUEST_URI} ^/(application1|application2|another-one|application4)
RewriteRule ^([^/]*)/(.*)$ http://$1.domain.com/$2 [R=301,L] 
```

只需将所有应用程序文件夹名称放在第一条规则中，用竖线 ( `|`)分隔

关于 SEO：“隐藏子域并不重要，因为它可以让 Google 高兴地在那些页面上找到它一直存在的内容。”

只要您使用 [R=301] 标志进行重定向，Google 就会知道内容已移动并且完全没有问题。随着时间的推移，Google 将开始在搜索结果中显示子域，而不是旧 URL，我认为这比必须永远支持旧 URL 更可取。

# iphone - 如何存储对对象和块的引用

> ID：13502905
> 
> 赞同：0
> 
> 时间：2012-11-21T22:12:02.120
> 
> 标签：iphone, objective-c, memory-management, objective-c-blocks

我想实现类似于`NSNotificationCenter`'s 的行为`-addObserverForName:object:queue:usingBlock:`。使用称为类似的方法

```
- (void)addRefetchObserver:(id)observer
                   handler:(FJRefetchHandler)handler; 
```

应该存储一个块以供以后调用（`FJRefetchHandler`定义如下：`typedef void(^FJRefetchHandler)(void)`.

因为以后要删除块，所以我也存储`observer`，并声明如下方法：

```
- (void)removeRefetchObserver:(id)observer; 
```

用法如下所示：

```
// some place in code
[controller addRefetchObserver:self handler:^{
    // refetch some stuff, i.e.
    self.data = [self updateData];
}];    
// some other place in code:
[controller removeRefetchObserver:self]; 
```

我的问题是：我应该如何实施`-addRefetchObserver:handler:`才能不创建任何保留周期？我应该如何存储观察者和处理者？

显然，`NSNotificationCenter`以某种方式存储观察者而不保留它 - 否则我将无法调用`[center removeObserver:self]`，`-dealloc`因为`-dealloc`永远不会被调用。

`__unsafe_unretained`另外，在块中引用时有没有办法绕过使用`self`？即像这样：

```
__unsafe_unretained MyObject *blockSelf = self;
[controller addRefetchObserver:self handler:^{
    blockSelf.data = [blockSelf updateData];
}]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:18:30.753

在块内调用 self 的更好方法是将 self 的引用复制到相同的弱变量中并在块内使用它作为；

```
MyController __weak *__weakController = controller;
[__weakController addRefetchObserver:self handler:^{
    // refetch some stuff, i.e.
    __weakController.data = [__weakController updateData];
}];    
// some other place in code:
[controller removeRefetchObserver:self]; 
```

但是，有时您可能正在处理长时间的持续操作，同时控制器可能会在块仍在进行中时被释放。由于块被放置在堆栈上并继续执行，更好的想法是在调用控制器之前检查控制器是否仍然存在，例如；

```
 MyController __weak *__weakController = controller;
    [__weakController addRefetchObserver:self handler:^{
         // some long on going tasks ...
        MyController __strong *strongController = __weakController;
        if(strongController)
          strongController.data = [strongController updateData];
    }];    
    // some other place in code:
    [controller removeRefetchObserver:self]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T23:27:00.840

> 显然， NSNotificationCenter 以某种方式存储观察者而不保留它 - 否则我将无法在 -dealloc 中调用 [center removeObserver:self] 因为 -dealloc 永远不会被调用。

是的，他们对它的引用很弱。你也可以很容易地在你的类中保留对观察者的弱引用：如果你需要一个弱引用的集合，你可以制作一个非保留版本的 NSArray 或 NSSet 或 NSDictionary，使用 Core Foundation 函数来创建 CFArray / CFSet / CFDictionary（它们与 NS 等效项是免费桥接的，即与 NS 等效项相同），允许您明确指定保留/释放行为；所以没有强参考，你只是让它在保留和释放上什么都不做。

你存储观察者有点奇怪。使用 NSNotificationCenter，它们存储观察者，因为它们需要观察者和选择器来进行调用。有了你的，block已经足够调用了，block封装了所有使用observer的逻辑，所以单独存储一个“observer”似乎很奇怪。似乎您拥有它的唯一原因是有办法将其删除。就此而言，它可以是任何对象，只要您传递相同的对象以添加和删除即可。

虽然 NSNotificationCenter 只有一个对“观察者”的引用，但您的系统有两个引用——一个作为传入的“观察者”，但您也有一个对块的引用，它很可能引用了“观察者”还。如果你想让它和 NSNotificationCenter 一样工作，你需要确保它们都是弱引用。我想你已经弄清楚了——使用我在第一段中描述的内容，你保持弱的直接“观察者”引用；该块对“观察者”的引用也必须是弱的。

> 另外，在块中引用 self 时，有没有办法绕过使用 __unsafe_unretained ？即像这样：

您所拥有的是从块中弱引用某些内容的正确方法。更具体地说，`__weak`如果您使用 ARC 并且仅针对 iOS 5+，则应该使用。如果您正在使用 ARC，则应该使用`__unsafe_unretained`（就像您拥有的那样）。`__block`如果您不使用 ARC，则应该使用。

# facebook - 用户墙贴未显示在页面上

> ID：13502906
> 
> 赞同：2
> 
> 时间：2012-11-21T22:12:03.623
> 
> 标签：facebook, api, facebook-graph-api, facebook-page

我一直在寻找这个问题的答案，但一直无法弄清楚。基本上，如果我使用“页面 B”上的简单 FB 应用程序作为“用户 A”发布，则该用户（通过应用程序）发布的帖子仅显示给用户。如果我登录该页面，或以访客或其他用户身份访问该页面，则看不到该帖子。

示例： [http ://screencast.com/t/gl1Ko0f35](http://screencast.com/t/gl1Ko0f35)

我正在使用的代码：

post = FbGraph::Page.new(PAGE_ID, ACCESS_TOKEN) post.feed!(:message => "这是我的消息")

这以前一直有效，但现在这些帖子只能由“用户 A”查看。为了确保不是代码本身，我使用 Facebook 作为“用户 A”留下了墙贴。该帖子仍然只能由用户查看。作为页面，设置允许任何人在那面墙上发帖。似乎在使用 API 发送消息后，Facebook 认为用户是垃圾邮件......但是，作为页面我什至没有看到通知。就好像这个帖子从来没有存在过一样。

有没有其他人遇到过这个？任何帮助都会很棒。

干杯!

# python - 为什么这个函数不抓取我的 csv 文件中的数据？

> ID：13502909
> 
> 赞同：1
> 
> 时间：2012-11-21T22:12:15.750
> 
> 标签：python, function, csv

我试图简单地打开一个 csv 文件，并打印出该文件中的行。当我将文件作为字符串传递给此函数时，输出是字符串的内容，而不是文件的行。

```
def _print_rows(filename):
    with open(filename, 'rt') as opened_file:
        read_file = csv.reader(opened_file):
            for row in read_file:
                print row
                raw_input()
        opened_file.close()

>>> module_name._print_rows('first_class_profile.csv')  
['f']

['i']

['r']

['s']

['t']

['_'] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:19:10.590

考虑到您发布的代码有错误，我认为您没有发布实际代码。

您的`_print_rows`函数实际上是打印文件名中的字符，而不是文件的内容。如果您将 csv 文件的文件名传递给`csv.reader`而不是打开的文件，则会发生这种情况：

```
>>> import csv
>>> filename = 'first_class_profile.csv'
>>> reader = csv.reader(filename) # whoops! should have passed opened_file
>>> for row in reader:
...     print row
...
['f']
['i']
['r']
['s']
['t']
['_']
['c']
['l']
['a']
['s']
['s']
['_']
['p']
['r']
['o']
['f']
['i']
['l']
['e']
['.']
['c']
['s']
['v'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:31:36.743

正如其他人指出的那样，由于语法错误，我发现您的代码甚至没有运行。此外，您不需要关闭文件：with 语句会处理此问题。在我修改了您的代码后，它似乎可以工作：

```
import csv
def _print_rows(filename):
    with open(filename, 'rt') as opened_file:
        read_file = csv.reader(opened_file)
        for row in read_file:
            print row
            raw_input()

_print_rows('first_class_profile.csv') 
```

# jquery - 横向显示更多内容？

> ID：13502911
> 
> 赞同：0
> 
> 时间：2012-11-21T22:12:20.090
> 
> 标签：jquery, html, transition, horizontal-scrolling

我正在构建一个单页网站，对于投资组合部分，我将拥有一些项目内容（例如 4 个缩略图），每个项目都将使用 fancybox 显示 html 内容。

所以我想要两个箭头，在每一侧来回显示更多的投资组合内容，但我不确定我应该如何构建它？这是投资组合网站上非常常见的效果，并且在内容发生变化时会发生过渡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:16:49.273

将所有显示元素放在一个中`div`，然后将其`div`放在另一个`div`中。外部`div`应按您想要的方式调整大小，并具有`overflow: hidden`风格。穿上`position: relative`内部`div`并将其向左或向右移动（动画）外部的宽度`div`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:17:46.100

你可以使用像延迟加载这样的插件吗？

[延迟加载 Jquery](http://www.appelsiini.net/projects/lazyload/enabled_wide.html)

它会水平淡入淡出加载内容:)

或者如果您正在寻找类似旋转木马的东西，请查看[这些示例](http://www.pixelzdesign.com/blog_view.php?id=55)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T22:38:40.247

只是一个快速的免责声明......但这肯定不是最无缝的解决方案。这只是我从头开始针对与您类似的问题提出的快速解决方案。只是众多方法中的一种。

这也是基于这里的功能，但已经被削减了很多：
[https ://www.facebook.com/Bio35/app_201742856511228](https://www.facebook.com/Bio35/app_201742856511228)

**Javascript**（在此之前的标题中需要 jQuery）

```
$(document).ready(function() {
$.ajaxSetup ({
    cache: false
});

var loadUrl = "scripts/item-loader.php";

page = 1;
total_pages = /* total number of pages, calculated dynamically or otherwise */;
prev_arow = "#left_arrow";
next_arow = "#right_arrow";

$(prev_arow).hide();
$(".hide").hide();

    $(prev_arow).click(function() {
        prev_page = page - 1;
        $("#wrapper"+page).fadeOut("normal", function() {
            $("#wrapper"+prev_page).fadeIn("slow");
        });
        if(prev_page == 1) { $(this).hide(); }
        if(page == total_pages) { $(next_arow).show(); }
        page--;
    });
    $(next_arow).click(function() {
        next_page = page + 1;
        $("#wrapper"+page).fadeOut("normal", function() {
            $("#wrapper"+next_page).fadeIn("slow");
        });
        if(page == 1) { $(prev_arow).show(); }
        if(next_page == total_pages) { $(next_arow).hide(); }
        page++;
    });

    $("#thumbs div div").click(function() {
        var my_id = $(this).attr('id');
        $("#product_wrapper").load(loadUrl, {product: my_id}, function() {});
    });
}); 
```

**HTML**

```
<div id="product_wrapper">
<!-- display format goes here -->
</div>

<div id="bottom_wrapper">
    <div id="left_arrow">
    </div>
    <div id="thumbs">
        <div id="wrapper1">
            <div id="p1"><!-- thumbnail --></div>
            <div id="p2"><!-- thumbnail --></div>
            <div id="p3"><!-- thumbnail --></div>
        </div>
        <div id="wrapper2" class="hide">
            <div id="p4"><!-- thumbnail --></div>
            <div id="p5"><!-- thumbnail --></div>
            <div id="p6"><!-- thumbnail --></div>
        </div>
        <div id="wrapper3" class="hide">
            <div id="p7"><!-- thumbnail --></div>
            <div id="p8"><!-- thumbnail --></div>
            <div id="p9"><!-- thumbnail --></div>
        </div>
    </div>
    <div id="right_arrow">
    </div>
</div> 
```

在 jQuery 中，`"scripts/item-loader.php"`基本上是反映与`<!-- display format goes here -->`HTML 相同格式的 AJAX 文件。它只是检索 的 POST 值`product`，在 Javascript 结束时的 AJAX 调用中使用，并吐出所选项目的信息。

希望代码足以说明一切。如果您需要澄清，请告诉我。

# objective-c - 什么时候清除过期的 UILocalNotifications？

> ID：13502924
> 
> 赞同：1
> 
> 时间：2012-11-21T22:13:19.480
> 
> 标签：objective-c, ios, uilocalnotification

好的，现在我知道 UILocalNotifications 会被系统清除，如果 firedate 已经过去，即它们已经过期，但它们什么时候被清除？仅当您的应用程序未运行时才会发生这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:53:49.220

我不确定在这种情况下您所说的“已清除”是什么意思，但根据[文档](http://developer.apple.com/library/ios/#documentation/iphone/Reference/UILocalNotification_Class/Reference/Reference.html)，应用程序只会保留“最快触发的 64 条通知”。达到 64 岁后，系统将丢弃最旧的通知。除此之外，我知道通知消失的唯一方法是用户从通知中心手动清除它们。

如果您谈论的是*取消*通知，那么您可能会查看 UIApplication 方法[`-cancelLocalNotification:`](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/UIApplication/cancelLocalNotification%3a)，该方法会取消计划的通知并在它可见时将其关闭。如果您希望强制清除通知，则此方法可能适合您。

# mysql - 通过多个标签进行 SQL 过滤

> ID：13502932
> 
> 赞同：1
> 
> 时间：2012-11-21T22:13:37.357
> 
> 标签：mysql, sql

我有三个表格，图像，标签和链接（下表）

```
 ImageNO | TagNO
     1     | Sport
     2     | Cars
     3     | Sport
     4     | Sport
     3     | Cars
     1     | Music
     2     | Sport 
```

（显然 TagNO 将是实际表中的数字）

我想要做的是允许过滤，以便用户可以选择任意数量的标签，并且图像将被过滤为仅选择所有标签的图像。例如，如果用户选择“运动”，则将显示“imageNO” 1、3、4 和 2。如果用户还选择了“汽车”，则查询会被细化，并且只会显示“imageNO”3 和 2。

到目前为止，我已经从网络上的示例中尝试了很多东西，这是我最接近的...

```
SELECT *
 FROM  images 
  LEFT JOIN links 
   ON INO = links.INO
  LEFT JOIN tags 
   ON tags.TagNO = links. TagNO
  WHERE links. TagNO
  IN ($tags)
  GROUP BY INO
  HAVING COUNT( INO ) >1 
```

($tags) 是一个标签号数组。

问题是只有一个标签的图像永远不会显示，因为计数是 = 1 而不是 > 1。任何帮助将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T17:31:50.177

我认为[这个问题](https://stackoverflow.com/questions/3267609/mysql-join-query-for-multiple-tags-many-to-many-relationship-that-matches-al)解决了同样的问题，并且[接受的答案](https://stackoverflow.com/a/3267635/180500)的方法也可能对你有用。类似于以下内容：

```
SELECT * 
FROM images i
JOIN links l ON l.INO = i.INO
JOIN tags t ON t.TagNO = l.TagNO
WHERE l.TagNO IN ('sports','cars')
GROUP BY i.INO
HAVING COUNT(DISTINCT t.TagNO) = 2 
```

...重要的是`COUNT(DISTINCT t.TagNO) = [number of tags]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:29:31.837

您必须在同一张桌子上多次加入。为此使用别名：

```
SELECT * FROM images
  LEFT JOIN links AS l1 ON l1.INO = images.INO
  LEFT JOIN tags AS t1 ON t1.TagNO = l1.TagNO
  LEFT JOIN links AS l2 ON l2.INO = images.INO
  LEFT JOIN tags AS t2 ON t2.TagNO = l2.TagNO
  [...]
  WHERE t1.tagNO = $tag1
    AND t2.tagNO = $tag2
  [...] 
```

# .htaccess - Htaccess 将大写转换为小写并将 html 重定向到 PHP 页面

> ID：13502933
> 
> 赞同：0
> 
> 时间：2012-11-21T22:13:46.063
> 
> 标签：.htaccess

我具有将 HTML 页面定向到那些匹配的 PHP 页面名称的功能

```
RewriteRule ^(.*).html $1.php [L,NC] 
```

如果我输入诸如 www.example.com/privacy.html 之类的 url（privacy.php 是正在呈现的页面），这会很好用

第二个要求是将大写转换为小写 url 所以我在我的 http.conf 中添加了这段代码

```
RewriteEngine On 
RewriteMap lc int:tolower 
RewriteCond %{REQUEST_URI} [A-Z] 
RewriteRule (.*) ${lc:$1} [R=301,L] 
```

和 htaccess CheckSpelling 中的这段代码

从大写到小写的转换有效，但现在

```
www.example.com/PRIVACY.html 
```

变成

```
www.example.com/privacy.php 
```

如果我输入`www.example.com/privacy.html`仍然有效。网址不变

我想保留以 .html 结尾的 url 有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-24T00:59:35.857

如果你可以访问 httpd.conf，试试这个

```
RewriteEngine on
RewriteBase /
RewriteMap lowercase int:tolower
RewriteCond $1 [A-Z]
RewriteRule ^/?(.*)$ /${lowercase:$1} [R=301,L] 
```

如果您只能访问 .htaccess 那么这将起作用 - 重新定向需要更长的时间然后 httpd.conf 但可以解决问题。

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

# If there are caps, set HASCAPS to true and skip next rule
RewriteRule [A-Z] - [E=HASCAPS:TRUE,S=1]

# Skip this entire section if no uppercase letters in requested URL
RewriteRule ![A-Z] - [S=28]

# Replace single occurance of CAP with cap, then process next Rule.
RewriteRule ^([^A]*)A(.*)$ $1a$2
RewriteRule ^([^B]*)B(.*)$ $1b$2
RewriteRule ^([^C]*)C(.*)$ $1c$2
RewriteRule ^([^D]*)D(.*)$ $1d$2
RewriteRule ^([^E]*)E(.*)$ $1e$2
RewriteRule ^([^F]*)F(.*)$ $1f$2
RewriteRule ^([^G]*)G(.*)$ $1g$2
RewriteRule ^([^H]*)H(.*)$ $1h$2
RewriteRule ^([^I]*)I(.*)$ $1i$2
RewriteRule ^([^J]*)J(.*)$ $1j$2
RewriteRule ^([^K]*)K(.*)$ $1k$2
RewriteRule ^([^L]*)L(.*)$ $1l$2
RewriteRule ^([^M]*)M(.*)$ $1m$2
RewriteRule ^([^N]*)N(.*)$ $1n$2
RewriteRule ^([^O]*)O(.*)$ $1o$2
RewriteRule ^([^P]*)P(.*)$ $1p$2
RewriteRule ^([^Q]*)Q(.*)$ $1q$2
RewriteRule ^([^R]*)R(.*)$ $1r$2
RewriteRule ^([^S]*)S(.*)$ $1s$2
RewriteRule ^([^T]*)T(.*)$ $1t$2
RewriteRule ^([^U]*)U(.*)$ $1u$2
RewriteRule ^([^V]*)V(.*)$ $1v$2
RewriteRule ^([^W]*)W(.*)$ $1w$2
RewriteRule ^([^X]*)X(.*)$ $1x$2
RewriteRule ^([^Y]*)Y(.*)$ $1y$2
RewriteRule ^([^Z]*)Z(.*)$ $1z$2

# If there are any uppercase letters, restart at very first RewriteRule in file.
RewriteRule [A-Z] - [N]

RewriteCond %{ENV:HASCAPS} TRUE
RewriteRule ^/?(.*) /$1 [R=301,L]
</IfModule> 
```

您可以从[askapache.com了解更多信息](http://www.askapache.com/htaccess/rewrite-uppercase-lowercase.html)

# c# - 如何从使用它的视图更改布局的 html

> ID：13502937
> 
> 赞同：2
> 
> 时间：2012-11-21T22:14:00.977
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3

可以说我`_Layout.cshtml`有这个：

```
 @if (ViewBag.SignUpURL == null)
        {   
            <a href="@Url.Content("~/Home/Join")" ><span>
                <strong>JOIN NOW!</strong></span></a>
        }
        else
        {         
            <a href="@ViewBag.SignUpURL" ><span>
                <strong>JOIN NOW!</strong></span></a>
        } 
```

当我尝试`ViewBag.SignUpURL`填充

```
 public ActionResult Index()
        {
            ViewBag.SignUpURL = HttpContext.Request.Url.AbsoluteUri.Replace("Index", "SignUp");

            return View();
        } 
```

`Index`查看使用`_Layout.cshtml`.

而且什么也没有发生...

一般来说，我需要以某种方式**将**数据`Layout`从使用它的页面传递到页面。

有可能吗？

谢谢你！！！

**更新：**

![在此处输入图像描述](../Images/e6a5c05a79f8646a63295df9b481af10.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:29:06.480

您应该考虑使用 Html.RenderAction() 它将返回到您指定的控制器操作，并且您将能够返回带有模型的局部视图：

看法：

```
@Html.RenderAction("GetSignUp") 
```

控制器动作

```
public ActionResult GetSignUp()
{
//do your logic here

    return PartialView("_SignUp");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T22:29:37.203

一切都很好。您可以使用 ViewBag 将一些数据传递给 Layout。但我认为这`HttpContext.Request.Url.AbsolutePath`不包含`Index`因为路由规则。

# powershell - $_ 和 [parameter(ValueFromPipeline=$true)] 之间的奇怪区别

> ID：13502949
> 
> 赞同：3
> 
> 时间：2012-11-21T22:14:52.890
> 
> 标签：powershell

我已经到了我的 PoweShell-fu 的边缘。有人可以向我解释为什么这两个函数在管道数组时表现不同吗？不同之处在于我是使用`$_`还是`[parameter(ValueFromPipeline=$true)] $input`获取管道输入。我希望那些在这种情况下会采取同样的行动。

```
$pairs = ('a', 'b'), ('c', 'd')

function dollarUnderscoreFunction
{
    Process
    {
        Write-Host "`$_[0] = $($_[0])"
        Write-Host "`$_[1] = $($_[1])"
    }
}

function pipedParameterFunction([parameter(ValueFromPipeline=$true)] $input)
{
    Process
    {
        Write-Host "`$input[0] = $($input[0])"
        Write-Host "`$input[1] = $($input[1])"
    }
}

Write-Host "`$pairs:"
$pairs | foreach { Write-Host $_ }

Write-Host "`nRunning dollarUnderscoreFunction`n"
$pairs | dollarUnderscoreFunction

Write-Host "`nRunning pipedParameterFunction`n"
$pairs | pipedParameterFunction 
```

**PowerShell v3 中的输出：**

```
$pairs:
a b
c d

Running dollarUnderscoreFunction

$_[0] = a
$_[1] = b
$_[0] = c
$_[1] = d

Running pipedParameterFunction

$input[0] = a b
$input[1] =
$input[0] = c d
$input[1] = 
```

**PowerShell v2 中的输出：**

```
$pairs:
a b
c d

Running dollarUnderscoreFunction

$_[0] = a
$_[1] = b
$_[0] = c
$_[1] = d

Running pipedParameterFunction

[ : Unable to index into an object of type System.Collections.ArrayList+ArrayListEnumeratorSimple.
At C:\Untitled1.ps1:16 char:8
+ $input[ <<<< 0]
    + CategoryInfo          : InvalidOperation: (0:Int32) [], RuntimeException
    + FullyQualifiedErrorId : CannotIndex

$input[0] =
[ : Unable to index into an object of type System.Collections.ArrayList+ArrayListEnumeratorSimple.
At C:\Untitled1.ps1:17 char:8
+ $input[ <<<< 1]
    + CategoryInfo          : InvalidOperation: (1:Int32) [], RuntimeException
    + FullyQualifiedErrorId : CannotIndex

$input[1] =
[ : Unable to index into an object of type System.Collections.ArrayList+ArrayListEnumeratorSimple.
At C:\Untitled1.ps1:16 char:8
+ $input[ <<<< 0]
    + CategoryInfo          : InvalidOperation: (0:Int32) [], RuntimeException
    + FullyQualifiedErrorId : CannotIndex

$input[0] =
[ : Unable to index into an object of type System.Collections.ArrayList+ArrayListEnumeratorSimple.
At C:\Untitled1.ps1:17 char:8
+ $input[ <<<< 1]
    + CategoryInfo          : InvalidOperation: (1:Int32) [], RuntimeException
    + FullyQualifiedErrorId : CannotIndex

$input[1] = 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T22:35:03.273

根据我的评论`$input`是保留的[自动变量](https://msdn.microsoft.com/en-us/powershell/reference/3.0/microsoft.powershell.core/about/about_automatic_variables)。如果您`pipedparameterfunction`使用另一个命名变量更改它，您将获得预期的行为。

# android - 用于消息传递的 Android UI 元素，例如 Google Talk

> ID：13502950
> 
> 赞同：-4
> 
> 时间：2012-11-21T22:14:54.767
> 
> 标签：android

android 应用程序中是否有用于消息传递的特定 UI 元素？例如 Google Talk 应用中使用的元素。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:14:34.443

我没有遇到任何用于聊天应用程序的特定 UI 小部件，唯一不寻常的是 Chat-ListView，它可以是修改后的 ListView 或自定义视图。对我来说，它看起来像是一个自定义视图。其他 UI 元素只是：ActionBar、ViewPager 和底部的 EditText。

# go - 如何从用“go”编写的控制台应用程序转移到另一个控制台应用程序？

> ID：13502957
> 
> 赞同：0
> 
> 时间：2012-11-21T22:15:28.443
> 
> 标签：go, console-application

我想使用“go”编写一个控制台应用程序，它将控制权转移到另一个控制台应用程序。

以下是步骤：

1.  运行二进制应用程序，它会在必要时验证并安装一些东西
2.  二进制应用程序构造带有选项的命令字符串
3.  二进制应用程序启动进程 B 并退出（在我的例子中是 node.js 应用程序）
4.  进程 B 运行完成并将输出发送到同一控制台。

**我需要的唯一步骤是能够启动新进程并退出，这就是这里的问题。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T02:41:42.647

[os 包](http://golang.org/pkg/os/) 看起来具有您可能需要的功能。用于启动进程的函数 StartProcess 和用于退出进程的函数 (*Process) Kill。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T03:23:39.680

[`os/exec`](http://golang.org/pkg/os/exec/)可能会有所帮助：

> 包 exec 运行外部命令。它包装了 os.StartProcess 以便更轻松地重新映射标准输入和标准输出、将 I/O 与管道连接以及进行其他调整。

查看[`Cmd.Start`示例](http://golang.org/pkg/os/exec/#example_Cmd_Start)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T13:58:39.983

请参阅[Golang 分叉过程](https://stackoverflow.com/questions/10027477/golang-fork-process)。简而言之，直接执行此操作存在问题。您应该改为使用非 Go 程序来启动您的 node.js 应用程序。

# wcf - 从 SOAP 服务接收图像会导致 ProtocolException

> ID：13502959
> 
> 赞同：0
> 
> 时间：2012-11-21T22:15:34.250
> 
> 标签：wcf, soap, protocolexception

我正在尝试访问返回请求图像的 SOAP 服务。内容类型为 image/png。现在我在调用该方法时得到以下 ProtocolException：

> 响应消息的内容类型 image/png 与绑定的内容类型 (text/xml; charset=utf-8) 不匹配。如果使用自定义编码器，请确保正确实现 IsContentTypeSupported 方法。响应的前 1024 个字节是：

之后几个字节可能属于图像。

我使用 VS 2012 的“添加服务引用”对话框生成了服务引用。我发现了几个类似的问题，但是这些问题似乎都不是针对实际从服务中获取图像的。

如何更改绑定的内容类型？

编辑：在此处添加了 WSDL：http: [//pastebin.com/NRvJfstU](http://pastebin.com/NRvJfstU)，我正在尝试调用操作“GetChannelIcon”

*   /Guide/xsd?type=程序： http: [//pastebin.com/mF8N35Hm](http://pastebin.com/mF8N35Hm)
*   /Guide/xsd?type=ProgramGuide：http://pastebin.com/rxscA3uT [_](http://pastebin.com/rxscA3uT)
*   /Guide/xsd?type=ArrayOfChannelInfo&name=ChannelInfo：http://pastebin.com/sRJmQp3R [_](http://pastebin.com/sRJmQp3R)
*   /Guide/xsd?type=ChannelInfo：http://pastebin.com/3Y3StCEW [_](http://pastebin.com/3Y3StCEW)
*   /Guide/xsd?type=ArrayOfProgram&name=程序：[http ://pastebin.com/sPaywD2J](http://pastebin.com/sPaywD2J)
*   /Guide/xsd?type=ArtworkInfoList：http://pastebin.com/24bLSiKg [_](http://pastebin.com/24bLSiKg)
*   /Guide/xsd?type=ArrayOfArtworkInfo&name=ArtworkInfo: [http://pastebin.com/HDjFvNFR](http://pastebin.com/HDjFvNFR)
*   /Guide/xsd?type=ArtworkInfo: [http://pastebin.com/0YMWMWig](http://pastebin.com/0YMWMWig)

我*想*这些都是

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T21:32:55.733

我最终使用普通的 WebRequest 来检索图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:17:24.207

Requests and responses to a SOAP service must be in SOAP. That is to say, it must be XML.

You may encode your image in the returned XML as base64.

# html - 子元素与父元素的宽度不同

> ID：13502960
> 
> 赞同：1
> 
> 时间：2012-11-21T22:15:40.877
> 
> 标签：html, css

这似乎是一个简单的问题 - 我有以下 html

```
 <div class="question" id="someQuestionId">
    <input type="text" disabled="disabled" class="creation"/>
</div> 
```

和以下CSS-

```
.creation{
    height:75%;
}
.creation,textarea{
    background-color:#F2FBEF;
}
.question{
    width:150px;
    height:100px;
    background-color:#0B3B24;

} 
```

但是，输入框的宽度小于包含它的 div 的宽度 - 为什么会发生这种情况？我认为宽度应该是继承的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:16:59.173

`input` is an inline element (inline-block actually). It doesn't inherit its width from its parent, but has a browser-specific default width instead.

Change the CSS:

```
.creation{
    height:75%;
    /* Either: */
    width: 100%;
    /* or */
    display: block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T23:08:30.870

输入或任何表单元素不会继承其父元素的宽度。

要使其与父对象的宽度相同，您只需指定它的宽度、填充和边框以匹配其父对象。

[http://jsfiddle.net/24xd8/](http://jsfiddle.net/24xd8/)

```
<div>
 <input type="text" />
</div>​

div {
 width:150px;
 height:130px;
 padding-top:20px;
 background:#999;
}
input {
 width:138px;
 border:1px solid #000;
 padding:5px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:18:41.780

这可能是因为浏览器通常有自己的默认样式（宽度、填充、边距等），它们赋予某些 DOM 元素。如果要删除所有这些默认浏览器样式，则应该使用 CSS 重置。您还可以专门为输入元素指定所需的 CSS。

# data-structures - 这种数据结构的正确名称是什么？

> ID：13502961
> 
> 赞同：1
> 
> 时间：2012-11-21T22:15:44.750
> 
> 标签：data-structures, trie

我有可以有子组的组。子组可以有自己的子组，依此类推。这种树状结构的深度没有限制。

我一直在阅读有关 Tries 的信息，[http](http://en.wikipedia.org/wiki/Trie) ://en.wikipedia.org/wiki/Trie 。在我看来，我设想的数据结构类似于 Trie，但有一些不同之处。

首先，在我的例子中，值与每个节点相关联。（例如，该值可能是组名称和组描述）。尽管 Trie 结构允许这样做，但我想知道是否有更具体的名称来表示具有与每个节点关联的值的变体？

其次，我有多个根源。另一种看待这一点的方式是，我收集了相关的 Tries。作为 Tries 集合的数据结构是否有名称？

我正在尝试在 PHP 中实现它。如果您有任何令人印象深刻的提示。

编辑：我希望能够“添加”、“编辑”、“删除”和“检索”节点。（不需要'移动'。）检索会非常频繁地发生，但不会发生其他动作。我不太担心性能，因为这不是整个应用程序中最常用的部分。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T03:38:24.157

你所描述的并不是真正的尝试。trie 更像是一个状态机，它将键与值相关联，同时将键的部分作为节点进行导航。

您描述了一个通用的有根树。一个简单的 trie 也是一棵树。有[不是树的类似特里树的结构](http://en.wikipedia.org/wiki/Directed_acyclic_word_graph)。大多数看起来像树的东西都是树。

树木的集体被称为[森林](http://en.wikipedia.org/wiki/Forest_%28graph_theory%29#forest)。

# javascript - 如何从Javascript中的自定义对象继承所有事件处理程序

> ID：13502967
> 
> 赞同：1
> 
> 时间：2012-11-21T22:16:21.047
> 
> 标签：javascript, events, inheritance, event-handling, prototype

我的 JavaScript 应用程序基于原型继承。考虑一个构造函数链，而较高成员的新实例用作较低成员的原型。这样，属性就可以在整个链中继承。

现在，我想通过一个类似的事件处理系统来扩展它。事件处理程序应该从上到下继承。

```
function Parent() {};
Parent.prototype = new function() {
    this.foo = "bar";
}

function Child() {};
Child.prototype = new Parent();
with(Child.prototype) {
    qax = "foobar";
} 
```

通过 Child() 的实例触发事件还应该从 Parent() 调用（继承）事件处理程序。然而，Parent() 应该只调用它自己的事件处理程序，因为没有更高的对象。

如果有人知道如何做到这一点（最好使用 jQuery），我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T01:37:33.423

jQuery 与 JS 继承无关，尽管您可以使用一些[`Callbacks`](http://api.jquery.com/jQuery.Callbacks/)对象来组织回调。

你可以做类似的事情

```
Parent.prototype.fire = function(args) {
    if (this.hasOwnProperty("callbacks")) {
         for (var i=0; i<this.callbacks.length; i++)
             this.callbacks[i].call(null, args);
    }
    var proto = Object.getPrototypeOf(this);
    if (proto && "fire" in proto)
        proto.fire(args);
}; 
```

现在，继承自的所有东西都`Parent.prototype`可以使用这个方法来检查当前实例上的“回调”数组，执行它们，然后递归地沿着原型链走，直到没有`fire`方法。

```
function Child() {
    this.callbacks = [console.log.bind(console, "Child level:")];
}
Child.prototype = new Parent;

function GrandChild() {
    this.callbacks = [console.log.bind(console, "GrandChild level:")];
}
GrandChild.prototype = new Child;

var gc = new GrandChild;
gc.fire("something"); 
```

但是，我通常建议不要`new`用于创建继承链。根据您的应用程序结构，它可能会起作用，但要知道您在做什么。您很容易迷失在嵌套对象的继承中，而且您可能需要避免在构造函数中创建局部变量。

# c# - 如何优化 linq 中将 ~4000 行转换为对象的“全选”语句？

> ID：13502968
> 
> 赞同：3
> 
> 时间：2012-11-21T22:16:45.607
> 
> 标签：c#, sql, linq

我有一种方法执行一些 linq 操作，该方法需要一分钟多的时间从 SQL 中获取 4,000 行并将它们放入对象列表中。我想要做的可以归结为：

1.  从表中获取所有行
2.  根据行字段将每一行转换为相应的对象
3.  返回该对象的列表

换句话说，我有一个对象对应于我的数据库中的一行，我希望 linq 返回这些行所在的表中所有对象的列表。

我正在做的是这样的：

```
public List<Article> GetAllArticlesFromDB()
    {
        using (DBEntities le = new DBEntities(this._efConnectionString))
        {
            IQueryable<ARTICLE> x = from row in le.ARTICLE select row;

            List<Article> llr = x.Select(r => new Article
            {
                 ArticleNumber = r.ARTICLE_NUMBER,
                 ArticleTitle = r.TITLE,
            }).ToList();

            return llr;
        }
    } 
```

麻烦的是，这个查询需要一分钟。只有两个字段，一个是 int，另一个是最大长度为 255 的字符串。一个简单的 SQL 查询可以在不到一秒的时间内完成。但是这个 linq 查询需要一分钟。我可以以某种方式优化它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:47:31.007

您为您的实体使用哪种实体框架上下文方法？“旧”实体框架方法生成的上下文对象都是`EntityObject`派生对象并引入了很多开销，并且构建其中的 4000 个可能需要很长时间。更好的方法是使用 POCO 对象，它们非常小而且速度很快，但如果您使用 Visual Studio 2010 和/或 EF 4，则可能需要使用[不同的生成器](http://visualstudiogallery.msdn.microsoft.com/23df0450-5677-4926-96cc-173d02752313)（与允许生成 POCO 的 VS 2012 和 EF5 相比）开箱即用的实体）。

您使用的是哪个 EF 版本和哪种方法？

[这是一个很好的教程](http://msdn.microsoft.com/en-US/data/jj206878)，展示了如何使新`DbContext`方法（用于数据库优先场景）工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:31:56.023

让您的数据库为您工作，而不是让应用程序做所有事情。使用分页或类似方法来提取较少数量的记录，因为实际上没有人会一次查看 4000 条记录。如果您需要过滤，请再次让数据库执行此操作。

`Article`有构造函数吗？如果可以的话，您绝对应该使用默认构造函数，因为您直接分配属性。

另外，您是否尝试过在一个语句而不是两个语句中运行它？不确定这是否会有更好的性能，但这是一个想法。

IE

```
List<Article> llr = (from row in le.ARTICLE
                     select new Article
                     {
                         ArticleNumber = row.ARTICLE_NUMBER,
                         ArticleTitle = row.TITLE
                     }).ToList(); 
```

# php - 在php中使用init（与zend无关）

> ID：13502969
> 
> 赞同：0
> 
> 时间：2012-11-21T22:16:47.380
> 
> 标签：php, init

我对使用 init 的做法有疑问。如果我有一个包含多个子类的父类，并且它们的 init 函数中都有相同的内容，那么最好将该内容放在父 init 类中，然后简单地执行以下操作：

```
public function init(){
    parent::init();
} 
```

这似乎是合乎逻辑的，但我读到的每一个地方，不幸的是 zend 特定的，他们说将父类中的 init 方法留空以避免复杂性。

有人可以澄清一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:25:18.607

我认为您将看到的只是编码实践的差异。

如果所有子类都具有相同的确切`init()`方法，则甚至没有理由在子类中声明该方法。

但是，在某些情况下，我看到开发人员完全按照您的说明进行操作。在很多情况下，这可能是因为最终的意图可能是以某种特定于类的方式增强父方法的行为。在其他情况下，我看到一些子类的集合覆盖了功能，因此开发人员在所有子类中放置了这样的方法，以便其他开发人员清楚其意图（执行该子类的父方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T22:29:23.197

`init()`许多 Zend 类都有构造函数，它们在构造函数的末尾调用这些函数。这个想法（我假设）是从它们继承的类可以避免调用

```
public function __construct(){
    parent::__construct();

    //child class logic
} 
```

IMO 这是一种不必要的便利。

无论如何，您想要调用`parent::init()`子类的唯一原因是它真的是 Zend 孙子类，并且它的父类在它的`init()`. 在这些情况下，一个空函数应该调用它的父函数，或者被完全删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:19:08.897

等等，什么？如果父类需要一个`init`方法，而子类需要完全相同的方法……只需将其添加到父类，对子类不做任何事情，因为它们会自动继承它。

这个：

```
public function init(){
    parent::init();
} 
```

写成这样更好：

（是的，这*没什么*。如果该方法所做的只是调用父方法，则将其省略。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T22:20:53.773

如果您的子类扩展了父类并且不覆盖父类的方法，则子类只是继承父类方法。Zend 与此无关。

例子

```
class A {
   function foo() {
     echo "foo";
   }
}

class B extends A {}

$b = new B();

$b->foo(); 
```

输出是

```
foo 
```

况且`init`也不是[什么法宝](http://www.php.net/manual/en/language.oop5.magic.php)。它与原来的方法相同`foo`。Zend 中使用它的事实来自于它的设计。它可以被命名为`initialize`or `foo`（当然，在 ZF 中，它是比此方法`init`更好的选择）。`foo`

# knockout.js - Knockout JS. Computed totals from dynamic number of inputs

> ID：13502972
> 
> 赞同：0
> 
> 时间：2012-11-21T22:16:51.007
> 
> 标签：knockout.js

I have a JSON data from an api that looks like this:

```
 var self = this;
    var init = {
    "topLevel": {
        "secondLevel": [
            {
                "Cost": 1,
                "AllocatePct": .9,
                "thirdLevel: [ {Cost:1,Name:"A1"},{Cost:2,Name:"A2"},{Cost:9,Name:"A3"} ]
            },
            {
                "Cost": 2,
                "AllocatePct": .1,"thirdLevel: [ {Cost:11,Name:"B1"},{Cost:4,Name:"B2"},{Cost:9,Name:"B3"} ]
            }
        ],
        "total": 3
       }
    };
    ko.mapping.fromJS(init,{},self); 
```

My HTML looks like :

```
<div data-bind="foreach:topLevel.secondLevel">
    <div data-bind="foreach:thirdLevel">
        <input type="text" data-bind="value: Cost">
    </div>
</div>
<div data-bind="??????">
     <!--have the correct number of textboxes and store the totals-->
</div> 
```

SecondLevel and thirdLevel have dynamic number of data. I want to compute the totals. For example: total for A1+B1\. Another textbox for total for A2+A2. Also have buttons that will dynamically delete a row (ie. A1 and B2) and also add new rows on the fly. Hope this makes sense. Thank you! Happy Thanksgiving!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T04:23:06.750

计算出的 observable 是您需要的：

[http://knockoutjs.com/documentation/computedObservables.html](http://knockoutjs.com/documentation/computedObservables.html)

# jquery - jQuery get all checked variables from checkboxes

> ID：13502976
> 
> 赞同：1
> 
> 时间：2012-11-21T22:17:00.663
> 
> 标签：jquery

> **Possible Duplicate:**
> [Get a list of all checked values](https://stackoverflow.com/questions/8384291/get-a-list-of-all-checked-values)

I have a form with a series of checkboxes all, none or various of which can be checked.

```
 <p><label for="available_lengths">Rail Length:</label></p>
 <p>
  <ul>    
   <li><label for="id_available_lengths_0"><input name="available_lengths" value="132" id="id_available_lengths_0" type="checkbox" class="can_update_lengths" /> 132</label></li>
   <li><label for="id_available_lengths_1"><input name="available_lengths" value="168" id="id_available_lengths_1" type="checkbox" class="can_update_lengths" /> 168</label></li>
   <li><label for="id_available_lengths_2"><input name="available_lengths" value="208" id="id_available_lengths_2" type="checkbox" class="can_update_lengths" /> 208</label></li>
   <li><label for="id_available_lengths_3"><input name="available_lengths" value="240" id="id_available_lengths_3" type="checkbox" class="can_update_lengths" /> 240</label></li>
  </ul>
 </p> 
```

How do I loop through these and assign a variable the `.val()` of each?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:33:36.530

用于`$.each`迭代 Checkbox 元素

```
var checkboxValues = [];

$('ul input[type="checkbox"]').each(function() {
     checkboxValues.push(this.value);
});

console.log(checkboxValues ); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/kVw6S/)**

# c# - c#将字节转换为字符串并写入txt文件

> ID：13502978
> 
> 赞同：5
> 
> 时间：2012-11-21T22:17:22.113
> 
> 标签：c#, string, byte

例如，我如何转换为`byte[] b = new byte[1]; b[1]=255`字符串？我需要一个值为“255”的字符串变量，`string text= "255";`然后将其存储在文本文件中？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-21T22:20:36.937

从字节开始：

```
 byte[] b = new byte[255];
        string s = Encoding.UTF8.GetString(b);
        File.WriteAllText("myFile.txt", s); 
```

如果你从字符串开始：

```
 string x = "255";
        byte[] y = Encoding.UTF8.GetBytes(x);
        File.WriteAllBytes("myFile2.txt", y); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T22:22:47.127

无需转换为字符串。你可以只使用[File.WriteAllBytes](http://msdn.microsoft.com/en-us/library/system.io.file.writeallbytes.aspx)

```
File.WriteAllBytes(@"c:\folder\file.txt", byteArray); 
```

# cmd - How to use for /f instead of if

> ID：13502986
> 
> 赞同：1
> 
> 时间：2012-11-21T22:17:36.083
> 
> 标签：cmd, dos

I dont know how right my for /f is. Please somebody help. I need to use the for /f instead of all the IF.

`for /f "eol=; tokens=1,2,3* delims," %%i in (January,February,March,April,May,June,July,August,September,October,November,December) do if day7=%%i && set month12=%%j &&`

```
set day365=%%k
set day7=%DATE:~0,3%
set month12=%DATE:~4,2% 
set day365=%DATE:~7,2%
set year1=%DATE:~10,4%

if /i %day7%==Sun set day7=Sunday
if /i %day7%==Mon set day7=Monday
if /i %day7%==Tue set day7=Tuesday
if /i %day7%==Wed set day7=Wednesday
if /i %day7%==Thu set day7=Thursday
if /i %day7%==Fri set day7=Friday
if /i %day7%==Sat set day7=Saturday

if /i %month12%==1 set month12=January
if /i %month12%==2 set month12=February
if /i %month12%==3 set month12=March
if /i %month12%==4 set month12=April
if /i %month12%==5 set month12=May
if /i %month12%==6 set month12=June
if /i %month12%==7 set month12=July
if /i %month12%==8 set month12=August
if /i %month12%==9 set month12=September
if /i %month12%==10 set month12=October
if /i %month12%==11 set month12=November
if /i %month12%==12 set month12=December 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T04:09:28.150

因此，为了将来帮助其他人，这就是它的目的。

```
set day7=%DATE:~0,3%
set month12=%DATE:~4,2% 
set day365=%DATE:~7,2%
set year1=%DATE:~10,4%

if %day7%==Sun set day7=Sunday
if %day7%==Mon set day7=Monday
if %day7%==Tue set day7=Tuesday
if %day7%==Wed set day7=Wednesday
if %day7%==Thu set day7=Thursday
if %day7%==Fri set day7=Friday
if %day7%==Sat set day7=Saturday

for /f "eol=; tokens=%month12% delims=," %%i in ("January,February,March,April,May,June,July,August,September,October,November,December") do set month12=%%i 

echo Today is %day7% %month12% %day365% %year1% 
```

# jquery - 带有位置的 jQuery 平滑页面锚点转换：固定菜单

> ID：13502993
> 
> 赞同：1
> 
> 时间：2012-11-21T22:17:49.580
> 
> 标签：jquery, scroll, anchor

[我在http://communitychessclub.com/index.php](http://communitychessclub.com/index.php)使用 position:fixed 菜单来保持菜单在屏幕上，即使用户滚动：

CSS：

```
#sticky {margin:0 auto; display:table}
#sticky.stick {position: fixed;  top: 0; margin-left:48px; z-index: 10000; } 
```

JS：

```
<script>
function sticky_relocate() {
    var window_top = $(window).scrollTop();
    var div_top = $('#sticky-anchor').offset().top;
    if (window_top > div_top)
        $('#sticky').addClass('stick')
    else
        $('#sticky').removeClass('stick');
}

$(function() {
    $(window).scroll(sticky_relocate);
    sticky_relocate();
});

$(window).scroll((function() {
    var a='',  // a buffer to the hash
    w = $(window);
    return function() {
        var h = location.hash;
        // if hash is different from the previous one, which indicates
        // the hash changed by user, then scroll the window down
        // update the buffer
        if (h != a) {            
            a = h;           
            w.scrollTop(w.scrollTop()-150)
        }
    };
})());
</script> 
```

但是人们抱怨链接到同一页面上的 ID 会导致屏幕突然滚动。[所以我在http://www.spydertrap.com/blog/2012/08/user-experience-jquery-smooth-page-anchor-transitions/](http://www.spydertrap.com/blog/2012/08/user-experience-jquery-smooth-page-anchor-transitions/)找到了“使用 jQuery Smooth Page Anchor Transitions 改善用户体验”，并且喜欢这个演示。非常喜欢它，以至于我想将下面的 jquery 代码与上面的 jquery 代码混合在一起，以实现平滑的 jquery 滚动。

他们使用这个（但这里存在其他版本......问题是如何加入两者）

jQuery代码：

```
function goToByScroll(id){
    $('html,body').animate({scrollTop: $(id).offset().top},'slow');
} 
```

HTML：

```
<ul class="nav">
    <li><a href="#chapter1">Chapter 1</a></li>
    <li><a href="#chapter2">Chapter 2</a></li>
    <li><a href="#chapter3">Chapter 3</a></li>
</ul> 
```

JS 启动器：

```
$(document).ready(function(){
    $('.nav a').click(function(){
        goToByScroll($(this).attr('href'));
        return false;
    });
}); 
```

**这可以与上面的 jquery 代码结合吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:06:16.390

我只是通过 chrome 浏览器的 JS 控制台入侵您的页面来尝试此操作。我逐字添加了函数`goToByScroll`，然后执行了这个：

```
$('#sticky a').click(function(){
    goToByScroll($(this).attr('href'));
    return false;
}); 
```

果然，它在锚 ID 之间滚动。当您单击导航栏中不是实际锚链接的链接（例如，“主页”指向主页，“国际象棋训练营”打开一个弹出窗口）时，会引发一个小问题。因此，您可以向要滚动的锚链接添加一个类，然后将该类添加到选择器中。

例如，将粘性菜单栏的标记修改为如下所示：

```
<li><a href="http://www.chessset.com/">Chess Center</a>
    <div><ul>

        <li><a class="anchor" href="#cc_events">about the RCC</a></li>

        <li><a href="#" onclick="TINY.box.show({url:'RCC_chess_lessons.php',boxid:'RCC_chess_camp', width:950, height:650}); return false;">chess camp</a></li>

        <li><a href="#" onclick="TINY.box.show({url:'RCC_Marchand_Open.php',boxid:'RCC_marchand', width:1000,height:600}); return false;">Marchand Open</a></li>

        <li><a href="#" onclick="TINY.box.show({url:'RCC_weekly_schedule.php', boxid:'RCC_schedule', width:775, height:600}); return false;">weekly schedule</a></li>

        <li><a class="anchor" href="#picnic">annual picnic</a></li>

        <li><a href="http://www.chessset.com/">Chess gear sale</a></li>

    </ul></div>
</li> 
```

（添加`class="anchor"`到指向同一页面上哈希的所有链接。）

并将其添加到您的 javascript 中：

```
// sticky_relocate function here

// Add this function exactly from your example
function goToByScroll(id){
    $('html,body').animate({scrollTop: $(id).offset().top},'slow');
}

// modify your onReady jQuery handler to this:
$(function() {
    $(window).scroll(sticky_relocate);
    sticky_relocate();

    // Added the .anchor to the selector
    $('#sticky a.anchor').click(function(){
        goToByScroll($(this).attr('href'));
        return false;
    });
});

// your $(window).scroll goes here 
```

这应该对您有用而不会引发任何错误。

# javascript - 函数中的 jQuery preventDefault

> ID：13502996
> 
> 赞同：5
> 
> 时间：2012-11-21T22:18:05.490
> 
> 标签：javascript, jquery

我`preventDefault`在这样的元素事件中使用过：

```
$('#element').click(function (e) {
    do stuff...
}); 
```

现在，我有一个函数，该函数已经接受了我想使用的参数，`preventDefault`但我不确定如何：

```
<a href="#services" id="services_link" class="services" onclick="sectionScroll('services')">Services</a>

function sectionScroll(id) {
    history.pushState(null, null, '#' + id);
    $('html, body').animate({
        scrollTop: $("#" + id).offset().top
    }, 1000);
} 
```

我尝试使用 return false 代替，但这会在单击链接时导致一些闪烁。

如何添加`preventDefault`到上述功能？

**编辑**

我最初的问题是在具有其他参数的函数中使用 preventDefault 。最后我不需要使用内联javascript（看起来没有办法避免它），所以这就是我使用的。我认为它很整洁：

```
<a href="#services" class="menu-link">Services</a>

   $('.menu-link').click(function (e) {
        e.preventDefault();
        var location = $(this).attr('href');
        history.pushState(null, null, location)
        $('html, body').animate({
            scrollTop: $(location).offset().top
        }, 1000);
    }); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-21T22:34:28.807

好吧，如果你真的想使用内联事件处理程序（虽然不推荐），试试这个：

```
<a href="#services" id="services_link" class="services"
   onclick="sectionScroll('services', event)">Services</a>

<script type="text/javascript">
function sectionScroll(id, e) {
    e.preventDefault();
    history.pushState(null, null, '#' + id);
    $('html, body').animate({
        scrollTop: $("#" + id).offset().top
    }, 1000);
}
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T22:22:21.727

您可以使用 jQuery，就像您在其他示例中一样，来处理单击事件：

```
<a href="#services" id="services_link" class="services">Services</a>

$('#services_link').click(function (e) {
    var id = "services";

    history.pushState(null, null, '#' + id);
    $('html, body').animate({
        scrollTop: $("#" + id).offset().top
    }, 1000);

    e.preventDefault();
} 
```

然后，这将允许您调用`preventDefault`该事件。

这也更好，因为您将不再使用内联 Javascript，并且您的事件逻辑都可以使用一种方法（即 jQuery）来处理，而不是其中一些在 jQuery 和一些内联中。

我建议阅读“[我为什么要避免内联脚本？](https://softwareengineering.stackexchange.com/questions/86589/why-should-i-avoid-inline-scripting) ”以了解为什么应该尽量避免内联脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T22:20:56.533

您可以从事件处理程序返回 false：

```
<a href="#services" id="services_link" class="services" onclick="return sectionScroll('services')">Services</a>

function sectionScroll(id) {
    history.pushState(null, null, '#' + id);
    $('html, body').animate({
        scrollTop: $("#" + id).offset().top
    }, 1000);
    return false; // note the addition of return keyword in onclick attribute above
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T22:24:06.240

**您可以在js**本身而不是**HTML**中分配事件处理程序

 **```
<a href="#services" id="services_link" class="services"
                                       data-id="services">Services</a> 
```

/

```
 $('#services_link').on('click', function(e){
        e.preventDefault();
        // data-id is a HTML5 data attribute

        var id = $(this).data('id');
        history.pushState(null, null, '#' + id);
        $('html, body').animate({
            scrollTop: $("#" + id).offset().top
        }, 1000);
    }); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-04-02T10:00:45.277

如果 .on("click") 将 "overflow:hidden" 添加到正文或 html，页面将滚动到顶部，即使您在回调中使用 e.preventDefalt() 也是如此。**

# java - MINA access message queue

> ID：13502997
> 
> 赞同：3
> 
> 时间：2012-11-21T22:18:06.260
> 
> 标签：java, mina

I have an issue where some or all of my NioProcessor threads in MINA are becoming overloaded. This is because I actually am performance-tuning my application; I do want it taking on as much work as possible and am figuring out how to monitor it so it can reduce workload when it is full. I was looking through MINA's source code looking for some sort of structure such as a task queue that worker threads poll from because ideally I can monitor that pool and take some action to reduce work when it becomes full. Does anyone have sufficiently knowledge of MINA's implementation to know if such a structure exists or how to access it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T09:20:40.987

看看 mina-integration-jmx，它是一个附加组件。有了它，您可以公开 mina 的内部以进行监控，例如过滤器、会话、...

[请参阅此处](http://mina.apache.org/mina-project/userguide/ch16-jmx-support/ch16-jmx-support.html)的用户指南。

# iphone - NSTimer 是否受到处理器速度、不同代 iPhone 等的影响

> ID：13502998
> 
> 赞同：2
> 
> 时间：2012-11-21T22:18:07.533
> 
> 标签：iphone, objective-c, ipad, nstimer

我正在我的游戏中实现倒计时方法，它将使用 15 秒倒计时。我一直在寻找不同的方法来实现这一点，并相信 NSTimer 是要走的路。

但是，有人告诉我它可能会受到处理器速度等的影响，我的问题是这是否属实，如果是这样，我该如何应对？

我已经看到了这个：[NSTimer](https://stackoverflow.com/questions/13446766/nstimer-count-wrong)但不完全理解它的影响。

有没有其他方法可以保证 15 秒的停机时间和所有设备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T23:10:23.880

没看懂你最后一句话

然而，我相信你的朋友是对的，它与实际的倒计时相比略有偏差，但我向你保证，差异是如此之小以至于它并不明显，尤其是对于游戏而言。

差异的原因是因为您将 NSTimer 设置为在一秒钟内执行，当它执行时它会更新屏幕上的倒计时然后重复。我的猜测是 NSTimer 直到完成执行您的方法后才会开始重复，因此每个 NSTimer 秒都比实际秒长几分之一秒。

Apple 可能比我领先一步，并在执行之前调用重复，但是，我不确定。

无论哪种方式，就像我说的那样，除非您正在做一些重要的事情而不是每秒更新屏幕，否则您的用户根本不应该注意到差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T03:36:15.773

NSTimer 对于大多数用途应该没问题。这不会是准确的——这个时间段会比你设置的稍长，但在良好的条件下只有很小的时间——想想毫秒。然而，NSTimer 通过一个 runloop 触发，所以它的准确性取决于那个 runloop 不忙。您可以通过在其自己的线程上使用专用的运行循环来最小化问题，但如果系统繁忙，您仍然会看到计时器的周期略有延长。

因此，虽然 CPU 速度与其他此类因素之间没有先天关系，但更快的硬件将能够由于不经常忙碌而更好地跟上。

Note also that a repeating NSTimer will not phase shift - it'll be as accurate set to an interval of 1s as at 15s. The only caveat is that if your handler is still running when the next fire should occur, that fire won't happen at all. e.g. if you take 1.1 seconds, the gap between firings will jump up to 2s.

An alternative to runloops & NSTimers is dispatch_after. It's not likely to be any more accurate though, and its skid is still contingent on the target queue (likely one of the default concurrent queues) not being busy when it fires.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T03:57:04.570

Theory: The `NSTimer` is not directly affected by the processor speed. A timer running for 1 minute on a Gen 2 device should also represent 1 minute on a much newer device.

Now that was the theory :), but in actuality, the processor speed not only affects your timers, but the general overall speed of your app (e.g., how fast your views change, how soon your music starts after you have pressed a button, etc). The only (or best test) is to repeatedly test your app on the types of devices that you are going to target. Test early, test often :)

You can not (based on my experiences) guarantee exactly time `T` on any device. You can however get times that are close on average to your expected time `T`.