# StackOverflow 问答 15960000-15960999

# jsf - jsf inputtext不显示来自bean的值

> ID：15960013
> 
> 赞同：-1
> 
> 时间：2013-04-11T22:31:20.520
> 
> 标签：jsf, primefaces

我有以下情况：

我有一个 bean 发送以形成一些数据，但仅在 outputlabel 中显示来自 bean 的数据。我尝试使用 primefaces，但同样的问题仍然存在。我的代码：

```
<h:outputLabel value="#{Bean.name}" id="name2" />
<h:inputText value="#{Bean.name}" id="name" />
<p:inputText value="#{Bean.name}" id="name3" /> 
```

知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T04:23:56.037

您还应该给出 bean 的代码，以帮助我们更好地分析问题。

通常，您应该检查以下内容：

1.  检查您是否指定了正确的 bean 名称。通常 bean 的名称与 class 的名称相同，只是第一个字母应该是小写的。在您的情况下，它应该是`#{bean.name}`，否则，使用 . 指定您的自定义名称`@Named("Bean")`。

2.  检查是否正确提供了 getName() 等 getter 和 setter。您可能已经在 get 方法本身中**重置**了 bean 中的 name 属性。因为它第一次正确显示你`outputLabel`，然后在下一次调用 getName 时它可能会给你 null 或空字符串。要检查这一点，请先尝试放置您的`inputText`标签，然后检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T19:24:58.977

我解决了我的问题。

当我尝试显示这些值时，我试图通过传递 ajax 操作从数据库中恢复数据。所以，当我点击按钮来检索数据时，我的一些 inputText 被设置为必需的。因为这个数据只是显示在标签中，而不是在需要的输入文本中。但是因为ajax，请求没有被正确调用。

当我从 inputtext 中删除所需的内容时，它工作正常。

# c++ - C++ printing boolean, what is displayed?

> ID：15960015
> 
> 赞同：74
> 
> 时间：2013-04-11T22:31:26.567
> 
> 标签：c++, boolean, cout

I print a `bool` to an output stream like this:

```
#include <iostream>

int main()
{
    std::cout << false << std::endl;
} 
```

Does the standard require a specific result on the stream (e.g. `0` for `false`)?

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2013-04-11T22:34:20.950

The standard streams have a `boolalpha` flag that determines what gets displayed -- when it's false, they'll display as `0` and `1`. When it's true, they'll display as `false` and `true`.

There's also an `std::boolalpha` manipulator to set the flag, so this:

```
#include <iostream>
#include <iomanip>

int main() {
    std::cout<<false<<"\n";
    std::cout << std::boolalpha;   
    std::cout<<false<<"\n";
    return 0;
} 
```

...produces output like:

```
0
false 
```

For what it's worth, the actual word produced when `boolalpha` is set to true is localized--that is, `<locale>` has a `num_put` category that handles numeric conversions, so if you imbue a stream with the right locale, it can/will print out `true` and `false` as they're represented in that locale. For example,

```
#include <iostream>
#include <iomanip>
#include <locale>

int main() {
    std::cout.imbue(std::locale("fr"));

    std::cout << false << "\n";
    std::cout << std::boolalpha;
    std::cout << false << "\n";
    return 0;
} 
```

...and at least in theory (assuming your compiler/standard library accept "fr" as an identifier for "French") it might print out `faux` instead of `false`. I should add, however, that real support for this is uneven at best--even the Dinkumware/Microsoft library (usually quite good in this respect) prints `false` for every language I've checked.

The names that get used are defined in a `numpunct` facet though, so if you really want them to print out correctly for particular language, you can create a `numpunct` facet to do that. For example, one that (I believe) is at least reasonably accurate for French would look like this:

```
#include <array>
#include <string>
#include <locale>
#include <ios>
#include <iostream>

class my_fr : public std::numpunct< char > {
protected:
    char do_decimal_point() const { return ','; }
    char do_thousands_sep() const { return '.'; }
    std::string do_grouping() const { return "\3"; }
    std::string do_truename() const { return "vrai";  }
    std::string do_falsename() const { return "faux"; }
};

int main() {
    std::cout.imbue(std::locale(std::locale(), new my_fr));

    std::cout << false << "\n";
    std::cout << std::boolalpha;
    std::cout << false << "\n";
    return 0;
} 
```

And the result is (as you'd probably expect):

```
0
faux 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-04-11T22:35:01.843

0 will get printed.

As in C++ **true** refers to **1** and **false** refers to **0**.

In case, you want to print **false** instead of **0**,then you have to sets the boolalpha format flag for the str stream.

When the boolalpha format flag is set, bool values are inserted/extracted by their textual representation: either true or false, instead of integral values.

```
#include <iostream>
int main()
{
  std::cout << std::boolalpha << false << std::endl;
} 
```

**output**:

```
false 
```

**[IDEONE](http://ideone.com/CDLWSS)**

# c# - FileHelpers：从 SQL 导入并导出到 CSV 方法

> ID：15960016
> 
> 赞同：1
> 
> 时间：2013-04-11T22:31:27.077
> 
> 标签：c#, import, export-to-csv, filehelpers

目前我正在开发应用程序读取发票数据`SQL Server`，我需要将该数据导出到`CSV`（具有某些逻辑，某些字段是恒定的）。

示例逻辑：`CalculateTax`，检查是否`PaymentMethod`以“现金”、“信用卡”开头，然后将字节标志设置为`PaymentMethod`字段`CSV class`等。

在这种情况下，我应该只创建一个`FileHelpers class`- 用于读取数据吗？然后将读取字段映射到更有用的类，应用逻辑并以正常方式导出（如此处所述[）](https://stackoverflow.com/questions/12854253/parse-several-field-using-file-helper)？但这不会利用`FileHelpers`写入文件的能力。`FileHelpers class`写作会不会有歧义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T16:28:51.663

从 SQL Server 读取数据的方法有很多种，具体取决于记录的数量以及架构是否可能发生变化，FileHelpers 不一定是最佳解决方案。

但是，如果您想为此使用 FileHelpers，那么请务必查看[Ayende 的博客文章，了解如何将其与 RhinoETL 集成](http://ayende.com/blog/2694/rhino-etl-filehelpers-integration)。

但基本上，是的，我会使用定义一个 FileHelpers 类（只有公共字段）来读取 SQL Server。然后创建另一个 FileHelpers 类来描述所需的 CSV 输出（同样只有公共字段）。然后创建一个映射器类，该类将负责将值从 SQL 提取映射到 CSV 输出（以及任何必要的逻辑）。

# google-app-engine - Google App Engine“没有名为请求的模块”PyDev

> ID：15960017
> 
> 赞同：4
> 
> 时间：2013-04-11T22:31:27.300
> 
> 标签：google-app-engine, pydev

我下载并安装了 Python 2.7 的[请求](http://docs.python-requests.org/en/latest/)库。使用外壳，我可以发出“导入请求”并实际使用它而不会出现问题。

问题是运行Google App Engine时找不到它并提示错误：

ImportError：没有名为请求的模块

我正在使用 PyDev-Eclipse 作为我的项目的 IDE，并尝试在两者中添加路径（/usr/local/lib/python2.7/dist-packages/requests）

项目 > 属性 > PyDev - PYTHONPATH > 外部库

并且在

窗口 > 首选项 > Pydev -解释器 > 库

没有工作！尝试运行我的 GAE 应用程序时仍然遇到同样的问题

任何人都可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T23:46:34.270

您使用的任何 3rd 方库都必须物理包含在您的项目中并部署到 appengine。这意味着仅使用 easy_install 或 pip 安装是不够的

请参阅文档 [https://developers.google.com/appengine/docs/python/runtime#Pure_Python](https://developers.google.com/appengine/docs/python/runtime#Pure_Python)

# php - Javascript未使用HTML表单将变量传递给PHP

> ID：15960020
> 
> 赞同：0
> 
> 时间：2013-04-11T22:31:47.267
> 
> 标签：php, javascript, html, forms, variables

我有使用 Javascript 和 PHP 的联系表。

我的问题是 javascript 没有将其变量传递给 PHP 脚本。我发现了以下内容：

变量确实在 javascript 中设置，因为它通过 javascript 内部的变量检查并使用显示变量的警报。

当它到达 PHP 脚本时，变量不再存在。我试图注释掉 PHP 脚本中的检查，然后它成功发送了一封邮件，但是除了 PHP 脚本中的静态内容之外，邮件是空的。

我尝试了各种不同的方法，包括直接从 http.send() 函数传递变量。

以下是相关代码（这些都是 Web 服务器上的 3 个不同文件）：

HTML：

```
div class="contact_form">
            <h4>Get in touch</h4>
            <form method="post">
                <input type="text" name="Name" id="name" value="Name" onfocus="this.value = this.value=='Name'?'':this.value;" onblur="this.value = this.value==''?'Name':this.value;" />
                <input type="text" name="Email" id="email" value="Email" onfocus="this.value = this.value=='Email'?'':this.value;" onblur="this.value = this.value==''?'Email':this.value;" />
                <input type="text" value="Subject (Hosting, Requests, Appeal, Report, etc.)" id="subject" onfocus="this.value = this.value=='Subject (Hosting, Requests, Appeal, Report, etc.)'?'':this.value;" onblur="this.value = this.value==''?'Subject (Hosting, Requests, Appeal, Report, etc.)':this.value;" />
                <textarea name="Message" id="body" onfocus="this.value = this.value=='Message'?'':this.value;" onblur="this.value = this.value==''?'Message':this.value;">Message</textarea>
                <input type="submit" name="submit" id="submit" value="send" class="submit-button" onClick="return check_values();" />
            </form>
            <div id="confirmation" style="display:none; position: relative; z-index: 600; font-family: 'Open Sans', sans-serif; font-weight: 300; font-size: 16px; color: #4e4e4e;"></div>
        </div> <!-- end .contact_form --> 
```

Javascript：

```
var http = createRequestObject();
var areal = Math.random() + "";
var real = areal.substring(2,6);

function createRequestObject() {
    var xmlhttp;
    try { xmlhttp=new ActiveXObject("Msxml2.XMLHTTP"); }
  catch(e) {
    try { xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}
    catch(f) { xmlhttp=null; }
  }
  if(!xmlhttp&&typeof XMLHttpRequest!="undefined") {
    xmlhttp=new XMLHttpRequest();
  }
    return  xmlhttp;
}

function sendRequest() {
    var rnd = Math.random();
    var name = escape(document.getElementById("name").value);
    var email = escape(document.getElementById("email").value);
    var subject = escape(document.getElementById("subject").value);
    var body = escape(document.getElementById("body").value);

    try{
        http.open('POST','pform.php');
        http.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        http.send('name='+name+'&email='+email+'&subject='+subject+'&body='+body+'&rnd='+rnd);
        http.onreadystatechange = handleResponse;
    }
    catch(e){}
    finally{}
}

function check_values() {
    var valid = '';

    var name = document.getElementById("name").value;
    var email = document.getElementById("email").value;
    var subject = document.getElementById("subject").value;
    var body = document.getElementById("body").value;
    if(trim(name) == "" ||
        trim(email) == "" ||
        trim(subject) == "" ||
        trim(body) == "") {
            alert("Please complete all fields");
    } else {
        if(isEmail(email)) {
            document.getElementById("submit").disabled=true;
            document.getElementById("submit").value='Please Wait..';
            sendRequest();
        } else {
            alert("Email appears to be invalid\nPlease check and try again");
            document.getElementById("email").focus();
            document.getElementById("email").select();
        }
    }
}

function handleResponse() {
    try{
    if((http.readyState == 4)&&(http.status == 200)){
        var response = http.responseText;
      document.getElementById("confirmation").innerHTML = response;
      document.getElementById("confirmation").style.display ="";
        }
  }
    catch(e){}
    finally{}
}

function isUndefined(a) {
   return typeof a == 'undefined';
}

function trim(a) {
    return a.replace(/^s*(S*(s+S+)*)s*$/, "$1");
}

function isEmail(a) {
   return (a.indexOf(".") > 0) && (a.indexOf("@") > 0);
} 
```

PHP：

```
<?php
error_reporting(0);

$page_title = "Contact Us Form";
$email_it_to = "email@example.com";
$error_message = "Please complete the form first";
$confirmation = "Thank you, your message has been successfully sent.";

if(!isset($rnd) || !isset($name) || !isset($email) || !isset($subject) || !isset($body)) {
    echo $error_message;
    die();
}

    $email_from = $email;
    $email_subject = "Contact Form: ".stripslashes($subject);
    $email_message = "Please find below a message submitted by '".stripslashes($name);
    $email_message .="' on ".date("d/m/Y")." at ".date("H:i")."\n\n";
    $email_message .= stripslashes($body);

    $headers = 'From: '.$email_from."\r\n" .
   'Reply-To: '.$email_from."\r\n" .
   'X-Mailer: PHP/' . phpversion();

    mail($email_it_to, $email_subject, $email_message, $headers);

    echo "<b>$confirmation</b>";
    die();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:37:42.313

您没有使用该`$_POST`变量来获取任何东西 - 您正在使用未设置的变量。

将所有调用更改为使用`$_POST`：

```
if(!isset($rnd) || !isset($name) || !isset($email) || !isset($subject) || !isset($body)) 
```

改成：

```
if(!isset($_POST['rnd']) || !isset($_POST['name']) || !isset($_POST['email']) || !isset($_POST['subject']) || !isset($_POST['body'])) 
```

而且您需要在使用未定义变量的其他任何地方更改它。

或者，您可以这样做：

```
$rnd = mysql_real_escape_string($_POST['rnd']);
$name = mysql_real_escape_string($_POST['name']);
... and so on 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T22:36:58.943

尝试这个：

```
try{
    http.open('POST','pform.php?name='+name+'&email='+email+'&subject='+subject+'&body='+body+'&rnd='+rnd);
    http.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    http.onreadystatechange = handleResponse;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T22:45:12.983

使用 $_POST 访问 POST 变量：

```
if (!isset($_POST["my_post_variable"]) {
 die('No post arguments passed.');
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T22:47:50.843

这是因为 Javascript 是客户端脚本语言，而 PHP 是服务器端。所以不能通过PHP直接访问javascript的变量。

您可以访问 HTML 表单发布的值

```
<?php
$var_name = $_POST['name_of_the_variable_to_access'];
//then access these variables in your code.
?> 
```

您也可以在 php 脚本的开头尝试这一行代码，但您需要确保不会在您的 php 代码中重新分配变量值。

```
<?
extract($_POST);
//your code here.
?> 
```

使用上面的代码，您将获得变量中的 HTML 页面值 - $Name、$Email、$Message。

是的，您需要为消息字段命名。最好只用小写写名字

# android - Android，如何为 TextView 小部件设置主题字体颜色？

> ID：15960029
> 
> 赞同：3
> 
> 时间：2013-04-11T22:32:25.370
> 
> 标签：android, android-theme

我刚刚在我的主题中应用了黑色背景图像

```
<style name="AppBaseTheme" parent="Theme.Sherlock.Light">
</style>

<!-- Application theme. -->
<style name="AppTheme" parent="AppBaseTheme">
    <item name="android:windowBackground">@drawable/background</item>
</style> 
```

现在我希望将我的文本视图的颜色更改为白色，以便它们在深色背景下可见

我认为为 TextView 设置 android:textColor 会像这样

```
<!-- Application theme. -->
<style name="AppTheme" parent="AppBaseTheme">
    <item name="android:windowBackground">@drawable/background</item>
    <item name="android:textViewStyle">@style/Ff1TextViewStyle</item>
</style>

<style name="Ff1SpinnerViewStyle" parent="android:Widget.TextView">
    <item name="android:textColor">@color/sysWhite</item>
    <item name="android:textStyle">bold</item>
</style> 
```

但令我沮丧的是，这完全塞满了各种各样的东西，比如微调器文本和微调器下拉文本、ActionBar 下拉菜单，通过将文本更改为白色背景上的白色，所有这些我都非常满意，而且我确信其他控件我尚未使用或尚未发现的内容很可能以白色文本结尾。

我发现很难相信 android 主题如此混乱，以至于我无法自信地设置 TextView 小部件的文本颜色而不影响小部件，我只能假设这些小部件是 TextView 小部件的子级，所以我认为它必须只是我缺乏知识是罪魁祸首，我希望并寻求对必须是共同要求的启迪。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T14:27:05.787

我不确定您是否可以仅为`TextView`, 因为`Actionbar`,`Spinner`和其他`Views`包含`TextView`作为它们的子元素设置样式，所以当您发现时它也会影响它们。在我看来，您应该创建一种样式并将其设置为您的样式`TextView`。与此类似的东西：

```
 <style name="MyTextView" parent="@android:style/TextAppearance.Small">
    <item name="android:layout_width">wrap_content</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:textColor">@android:color/white</item>
    <item name="android:textSize">12sp</item>
</style> 
```

并在您`TextView`的 xml 声明中使用它：

```
<TextView
   style="@style/MyTextView" /> 
```

或者您可以做的第二件事是创建您的自定义`TextView`

```
public class MyTextView extends TextView {

     public MyTextView(Context context){
         super(context);
         this.setTextColor(android.R.color.white);
     }
} 
```

并在您的 xml 文件中使用 MyTextView ：

```
<com.my.package.name.MyTextView
   android:id="@+id/my_textview" /> 
```

**编辑：**

设置`android:textViewStyle`影响所有其他视图的原因只是因为如果您仔细查看 android 源代码，您会发现其他视图中使用的每个 textview 样式都是`android.Widget.TextView`. 因此，在我看来，在这种情况下您可以做的最好的事情是创建一个单一的样式并将其设置为您`TextView`在 xml 中的样式。

希望这些信息会有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T14:22:03.970

您可以创建样式并将其仅应用于`TextView`s 中的特定元素，例如在布局 xml 文件中：

```
<TextView
    style="@style/Ff1SpinnerViewStyle"
    android:id="@+id/myView" /> 
```

您将标准主题应用于您的活动，只有您在布局文件中覆盖样式的元素才会更改其外观。

您无需`AppBaseTheme`使用任何`TextView`特定属性进行覆盖。

# mysql - MySQL：多个where +多个按索引分组

> ID：15960033
> 
> 赞同：1
> 
> 时间：2013-04-11T22:32:40.963
> 
> 标签：mysql, optimization, indexing

我有`temp`任何数据和 5 列的简单表：

![在此处输入图像描述](https://i.stack.imgur.com/vlPq2.jpg)

我需要运行这样的查询：

`select c,d from temp where (a='633' and b='581' and e='1') group by c,d`

我试图添加不同的索引来防止`Using temporary/filesort`：

index(a,b,e,c,d) - where 子句索引但使用临时表和文件排序
index(c,d,a,b,e) - 按索引分组但 where 子句未索引

是否存在这样的索引？在这种情况下如何优化查询？

# ios - 不能在函数中使用 for-in 循环

> ID：15960035
> 
> 赞同：0
> 
> 时间：2013-04-11T22:32:49.837
> 
> 标签：ios, objective-c

我不确定为什么这个 for-in 循环不起作用。我正在使用一个`valueChanged:`在移动时调用的滑块。为了简化代码，我清理了所有东西，但我只想知道为什么这不起作用：

```
- (void)valueChanged:(CCControlSlider *)sender{
        for(CCControlSlider *slider in self.arrayOfSliders){
            NSLog(@"do something");
        }
} 
```

它与 EXC_BAD_ACCESS 一起崩溃。我在这里做违法的事吗？谢谢

** 编辑：问题：self.arrayOfSliders 设置为（非原子，分配），所以它没有被保留。

我已经将我的项目设置为 ARC（我更习惯了！），问题应该得到解决。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T22:40:01.303

你做了什么调试？self.arrayOfSliders 是尚未释放的有效对象吗？

检查指针是否返回是不够的。尝试打开[NSZombie](https://stackoverflow.com/questions/5386160/how-to-enable-nszombie-in-xcode)以查看对象是否已被释放。

# c - C中链表的插入排序？

> ID：15960040
> 
> 赞同：5
> 
> 时间：2013-04-11T22:33:17.253
> 
> 标签：c, linked-list, singly-linked-list, insertion-sort

我已经尝试搜索与我的类似的问题，但没有找到太多帮助。

我有一个这种类型的结构的链接列表：

```
struct PCB {
    struct PCB *next;
    int reg1, reg2;
}; 
```

我首先创建了 10 个以这种方式链接在一起的 PCB 结构：

```
for(i=20;i<=30;i++) {
        curr = (struct PCB *)malloc(sizeof(struct PCB));
        curr->reg1 = i;
        curr->next  = head;
        head = curr;
    } 
```

然后我需要再创建 20 个 PCB 结构，但它们的`reg1`值需要使用`rand()`. 我目前正在这样做：

```
for (j = 0;j<20;j++) {
        curr = (struct PCB *)malloc(sizeof(struct PCB));
        curr->reg1 = rand()%100;
        curr->next  = head;
        head = curr;
    } 
```

但是，当将这些 PCB 结构插入到带有随机值的链表中时`reg1`，我需要将它们按顺序插入到链表中（插入排序）。仅在单链接链表中解决此问题的最佳方法是什么？谢谢

编辑：我现在正在跟踪第一个创建的结构，以便能够从一开始就遍历链表：

```
// create root struct to keep track of beginning of linked list
root = (struct PCB *)malloc(sizeof(struct PCB));
root->next = 0;  
root->reg1 = 20;

head = NULL;

// create first 10 structs with reg1 ranging from 20 to 30
for(i=21;i<=30;i++) {
    curr = (struct PCB *)malloc(sizeof(struct PCB));
    // link root to current struct if not yet linked
    if(root->next == 0){
        root->next = curr;
    }
    curr->reg1 = i;
    curr->next  = head;
    head = curr;
} 
```

然后，当我创建另外 10 个需要插入排序的 PCB 结构时：

```
// create 20 more structs with random number as reg1 value
    for (j = 0;j<20;j++) {
        curr = (struct PCB *)malloc(sizeof(struct PCB));
        curr->reg1 = rand()%100;
        // get root for looping through whole linked list
        curr_two = root;
        while(curr_two) {
            original_next = curr_two->next;
            // check values against curr->reg1 to know where to insert
            if(curr_two->next->reg1 >= curr->reg1) {
                // make curr's 'next' value curr_two's original 'next' value
                curr->next = curr_two->next;
                // change current item's 'next' value to curr
                curr_two->next = curr;
            }
            else if(!curr_two->next) {
                curr->next = NULL;
                curr_two->next = curr;
            }
            // move to next struct in linked list
            curr_two = original_next;
        }
        head = curr;
    } 
```

但这立即使我的程序崩溃了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T22:36:15.740

“最好”的方法可能是为插入实现一个新功能。此函数将遍历列表，直到找到一个节点`next`值小于或等于您要插入的节点的节点，然后将新节点放在该节点之前`next`。

* * *

这个功能怎么样：

```
void insert(struct PCB **head, const int reg1, const int reg2)
{
    struct PCB *node = malloc(sizeof(struct PCB));
    node->reg1 = reg1;
    node->reg2 = reg2;
    node->next = NULL;

    if (*head == NULL)
    {
        /* Special case, list is empty */
        *head = node;
    }
    else if (reg1 < (*head)->reg1)
    {
        /* Special case, new node is less than the current head */
        node->next = *head;
        *head = node;
    }
    else
    {
        struct PCB *current = *head;

        /* Find the insertion point */
        while (current->next != NULL && reg1 < current->next->reg1)
            current = current->next;

        /* Insert after `current` */
        node->next = current->next;
        current->next = node;
    }
} 
```

你可以这样称呼它：

```
insert(&root, rand() % 100, 0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T23:44:16.147

这是@Joachim 的简化版本：

```
void insert(struct PCB **head, const int reg1, const int reg2)
{
    struct PCB *new ;
        /* Find the insertion point */
    for (       ;*head; head = & (*head)->next)
    {
        if ((*head)->reg1 > reg1) break;
    }

    new = malloc(sizeof *new );
    new->reg1 = reg1;
    new->reg2 = reg2;
    new->next = *head;
   *head = new;
} 
```

这个想法很简单：**不需要任何特殊情况**，在任何情况下：需要更改指针，这可能是根指针，尾指针，或 LL 中间的某个指针。在任何/每种情况下：

*   新节点实际上*窃取*了这个指针：
*   它使它指向*自己*
*   它*采用*前一个值作为后继值（将其分配给它的`->next`指针。

# jquery - 字符串到对象未按预期工作

> ID：15960042
> 
> 赞同：1
> 
> 时间：2013-04-11T22:33:26.790
> 
> 标签：jquery

在 JQuery 中将字符串转换为 html 对象时，我没有得到整个段，我想知道我是否正确使用它。

**这是填充“数据”后的代码：**

```
 console.log(data);
    console.log("---");
    console.log($(data).html()); 
```

**结果如下：**

```
<div style='width:260px; height:128px; text-align:left' id='productTn'><img src='images/rProduct02.jpg' id='productTnImg' class='productTnImg' alt='Selected Product' style='border-style:none' height=128 width=128 /></div><div id='productLI' style='width:281px; min-height:185px'><b>Audi</b></div>
--- 
<img src="images/rProduct02.jpg" id="productTnImg" class="productTnImg" alt="Selected Product" style="border-style:none" height="128" width="128"> 
```

如您所见，在将 HTML 转换为对象，然后再将其转换回字符串之后，只有 IMG 部分存在，其余部分都消失了。我在这里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:36:54.930

`$(data).html();`参考`innerHtml`of `data`，这将返回`img`您的情况。

有了这个`$(data).html();` ，你没有将你的数据转换成`html`，你只是要求 jquery 返回`html`你的内部`div`

你问 -*字符串到对象没有按预期工作*

您的`data`变量已经是一个对象

阅读更多关于[**.html()**](http://api.jquery.com/html/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T22:37:02.587

一个打印`data`整个字符串的变量的实际内容，同时`.html()`检索`div`.

```
console.log(data); // prints the actual content of data
console.log($(data).html()); // prints the inner HTML of data 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T22:39:24.893

jQuery`.html()`方法将引用`innerHTML`匹配元素的 。如果你想要`outerHTML`你可以尝试这样的事情：`console.log($(data).wrap("<div/>").parent().html());`虽然取决于你到底需要什么，也许你最好只引用`data`自己？包装`data`节点只是为了能够选择它可能会引入其他问题（例如 CSS 选择器）。

# python - Python：使用 UnicodeWriter 将 Unicode 写入 CSV

> ID：15960044
> 
> 赞同：3
> 
> 时间：2013-04-11T22:33:32.867
> 
> 标签：python, csv, unicode, utf-8

Python 文档有以下关于将 unicode 写入 csv 文件的代码示例。我认为它已经提到这是因为 csv 模块无法处理 unicode 字符串的方式。

```
class UnicodeWriter:
    """
    A CSV writer which will write rows to CSV file "f",
    which is encoded in the given encoding.
    """

    def __init__(self, f, dialect=csv.excel, encoding="utf-8", **kwds):
        # Redirect output to a queue
        self.queue = cStringIO.StringIO()
        self.writer = csv.writer(self.queue, dialect=dialect, **kwds)
        self.stream = f
        self.encoder = codecs.getincrementalencoder(encoding)()

    def writerow(self, row):
        self.writer.writerow([s.encode("utf-8") for s in row])
        # Fetch UTF-8 output from the queue ...
        data = self.queue.getvalue()
        data = data.decode("utf-8")
        # ... and reencode it into the target encoding
        data = self.encoder.encode(data)
        # write to the target stream
        self.stream.write(data)
        # empty queue
        self.queue.truncate(0)

    def writerows(self, rows):
        for row in rows:
            self.writerow(row) 
```

我正在编写多个文件，为了简单起见，我只放了我的代码部分来演示我如何在我的代码中使用上面的类：

```
def write(self):
    """
    Outputs the dataset to a csv.
    """
    f = codecs.open(self.filename, 'a')
    writer = UnicodeWriter(f)
    #with open(self.filename, 'a', encoding='utf-8') as f:
    if self.headers and not self.written:
        writer.writerow(self.headers)
        self.written = True
    for record in self.records[self.last_written:]:
        print record
        writer.writerow(record)
    self.last_written = len(self.records)
    f.close() 
```

这是类 coll 数据集内的一种方法，它在写入 csv 之前准备数据集，以前我使用过，`writer = csv.writer(f)`但由于编解码器错误，我将代码更改为使用 `UnicodeWriter 类。

但我的问题是，当我打开 csv 文件时，我得到以下信息：

```
some_header
B,r,ë,k,ò,w,n,i,k,_,b,s
B,r,ë,k,ò,w,n,i,k,_,c,s
B,r,ë,k,ò,w,n,i,k,_,c,s,b
B,r,ë,k,ò,w,n,i,k,_,d,e
B,r,ë,k,ò,w,n,i,k,_,d,e,-,1
B,r,ë,k,ò,w,n,i,k,_,d,e,-,2
B,r,ë,k,ò,w,n,i,k,_,d,e,-,3
B,r,ë,k,ò,w,n,i,k,_,d,e,-,4
B,r,ë,k,ò,w,n,i,k,_,d,e,-,5
B,r,ë,k,ò,w,n,i,k,_,d,e,-,M
B,r,ë,k,ò,w,n,i,k,_,e,n
B,r,ë,k,ò,w,n,i,k,_,e,n,-,1
B,r,ë,k,ò,w,n,i,k,_,e,n,-,2 
```

这些行实际上应该是`Brëkòwnik_de-1`我不是真的发生了什么。

为了大致了解数据是如何生成的，我将添加以下行： `title = unicode(row_page_title['page_title'], 'utf-8')`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T22:55:06.900

此症状指向类似于将字符串输入到期望列表或元组的函数/方法之类的事情。

该`writerows`方法需要一个列表列表，并且`writerow`需要一个包含字段值的列表（或元组）。因为你给它一个字符串，并且当你迭代它时，一个字符串可以模仿一个字符列表，你会得到一个每列有一个字符的 CSV。

如果您的 CSV 只有一列，则应使用`writer.writerow([data])`而不是`writer.writerow(data)`. 如果您只有一列，有些人可能会质疑您是否真的需要 csv 模块，但 csv 模块将处理诸如包含有趣内容（CR/LF 和其他）的记录之类的事情，所以是的，这是一个好主意。

# php - 使用 PHP (iOS) 向多个令牌发送推送通知

> ID：15960051
> 
> 赞同：2
> 
> 时间：2013-04-11T22:34:02.670
> 
> 标签：php, ios, apple-push-notifications

我有一个包含所有设备令牌的数据库。我继续从数据库中获取令牌，但我的脚本不再起作用（推送不发送）。

这是我的脚本：

```
<?PHP

$db_user = "xxx"; // Gebruiker voor MySQL
$db_pass = "xxx"; // Wachtwoord voor MySQL
$db_host = "localhost"; // Host voor MySQL; standaard localhost
$db_db = "xxx"; // Database

// Als je al ergens anders een database connectie hebt gemaakt,
// maak dan van de volgende twee regels commentaar (# of // ervoor zetten)
mysql_connect($db_host,$db_user,$db_pass);
mysql_select_db($db_db);

$query = mysql_query("SELECT * FROM iospush");

                                while ($row = mysql_fetch_array($query)) {
                                    $deviceToken = $row["devicetoken"];
                                    }

if($_POST['message']){

//  $deviceToken = 'xxx';

    $message = stripslashes($_POST['message']);

    $payload = '{
                    "aps" : 

                        { "alert" : "'.$message.'",
"badge" : 1
                        } 
                }';

    $ssl='xx.pem';

    $ctx = stream_context_create();
    stream_context_set_option($ctx, 'ssl', 'local_cert', $ssl);
    stream_context_set_option($ctx, 'ssl', 'passphrase', 'xxx');
    $fp = stream_socket_client('ssl://gateway.sandbox.push.apple.com:2195', $err, $errstr, 60, STREAM_CLIENT_CONNECT, $ctx);
    if(!$fp){
        print "Failed to connect $err $errstrn";
        return;
    } else {
        print "Notifications sent!";
    }

    $devArray = array();
    $devArray[] = $deviceToken;

    foreach($devArray as $deviceToken){
        $msg = chr(0) . pack("n",32) . pack('H*', str_replace(' ', '', $deviceToken)) . pack        ("n",strlen($payload)) . $payload;
        print "sending message :" . $payload . "n";

        fwrite($fp, $msg);
    }
    fclose($fp);
}

?>
<form action="pushios.php" method="post">
    <input type="text" name="message" maxlength="100">
    <input type="submit" value="Send Notification">
</form> 
```

请帮助我完成这项工作！

在此表示感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-11T22:46:24.017

```
$deviceToken = ARRAY();
while ($row = mysql_fetch_array($query)) {
  $deviceToken[] = $row["devicetoken"];
} 
```

...

```
// or use ($devArray = $deviceToken;)

foreach($deviceToken as $token){
    $msg = chr(0) . pack("n",32) . pack('H*', str_replace(' ', '', $token)) . pack        ("n",strlen($payload)) . $payload; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-19T10:54:12.793

```
function addStoryData() {

    header("Content-Type:application/json");

    $notification = $this->input->post('message');

    $device_id = $this->db->select('device_id')
                               ->from('tbl_device')
                               ->where('device_type','iPhone')
                               ->get()
                               ->result_array();

    //$this->sendApplePushNotification($device_id,$notification,1);

    foreach ($device_id as $d_id) {                           

        $device_id  = $d_id['device_id'];
        $this->sendApplePushNotification($device_id,$notification,1);
    }

}

function sendApplePushNotification($tToken,$tAlert,$notification)
{

     /*
        print_r($tToken);
        echo '----------------------------';
        print_r($tAlert);
        echo '----------------------------';
        print_r($detail);
        echo '----------------------------';
        print_r($notification);
        echo '----------------------------';
        print_r($tToken);
        die;
    */    
        $tPayload="test";
        //$tHost = 'gateway.sandbox.push.apple.com';
        $tHost = 'gateway.push.apple.com';

        $tPort = 2195;

        // Provide the Certificate and Key Data.
        // home/ibliocrq/public_html/shopostreet.com/shopostreet/application/ckShopostreet_development.pem
         //echo $this->config->item('pushcertDevelopment.pem');die;

        //echo base_url('RestAPI/pushcertDevelopment.pem');
        //die;
        $tCert =  '/home/chatstor/public_html/readify/pushcertDistribution.pem';
         //$tCert =  '/home/chatstor/public_html/readify/pushcertDevelopment.pem';

        //$tCert = 'ckUnionMallProdution.pem';

        // Provide the Private Key Passphrase (alternatively you can keep this secrete

        // and enter the key manually on the terminal -> remove relevant line from code).

        // Replace XXXXX with your Passphrase

        $tPassphrase = 'ibl@2017';

        // Provide the Device Identifier (Ensure that the Identifier does not have spaces in it).

        // Replace this token with the token of the iOS device that is to receive the notification.

        //====================
        // $tToken = 'da38439e7b2bf83bfae2011eb680debdfeeded66602f685033fd4b25101d31a2';

        //====================

        // The message that is to appear on the dialog.

        //====================
        // $tAlert = 'Test Heartfelt Push Notification';
        //====================

        // The Badge Number for the Application Icon (integer >=0).

       // $tBadge = 1;
        $tBadge = intval($notification);

        // Audible Notification Option.

        $tSound = 'default';

        // The content that is returned by the LiveCode "pushNotificationReceived" message.

        //====================
       // $tPayload = 'You get a New Bubble';
        //====================

        // Create the message content that is to be sent to the device.

        $tBody['aps'] = array (
        'alert' => $tAlert,
        'badge' => $tBadge,
        'sound' => $tSound,

        //'detail' => $detail, 
        ); 

        //print_r($tBody);

        $tBody ['payload'] = $tPayload;
        //$tBody ['bubble_id'] = "101";

        // Encode the body to JSON.

        $tBody = json_encode ($tBody);

        // Create the Socket Stream.

        $tContext = stream_context_create ();

        stream_context_set_option ($tContext, 'ssl', 'local_cert', $tCert);

        // Remove this line if you would like to enter the Private Key Passphrase manually.

        stream_context_set_option ($tContext, 'ssl', 'passphrase', $tPassphrase);

        // Open the Connection to the APNS Server.

        $tSocket = stream_socket_client ('ssl://'.$tHost.':'.$tPort, $error, $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $tContext);

        // Check if we were able to open a socket.

        if (!$tSocket)
        {
                echo json_encode(array("ResponseCode"=>"2","Result"=>"false","ResponseMsg"=> "APNS Connection Failed."));
                exit ("APNS Connection Failed: $error $errstr" . PHP_EOL);
        }

        // Build the Binary Notification.

        /*foreach($tToken as $deviceToken){

            echo $tToken['device_id'];

            $tMsg = chr (0) . chr (0) . chr (32) . pack ('H*', $tToken['device_id']) . pack ('n', strlen ($tBody)) . $tBody;

            // Send the Notification to the Server.

            $tResult = fwrite ($tSocket, $tMsg, strlen ($tMsg));

            if ($tResult){
                    echo json_encode(array("ResponseCode"=>"1","Result"=>"true","ResponseMsg"=> "Notification has been sent."));
            }else{
                    echo json_encode(array("ResponseCode"=>"2","Result"=>"false","ResponseMsg"=> "Notification could not sent."));
            }
        }
        fclose ($tSocket);*/
        //fclose($fp);

        $tMsg = chr (0) . chr (0) . chr (32) . pack ('H*', $tToken) . pack ('n', strlen ($tBody)) . $tBody;

        // Send the Notification to the Server.

        $tResult = fwrite ($tSocket, $tMsg, strlen ($tMsg));

        if ($tResult){
                echo json_encode(array("ResponseCode"=>"1","Result"=>"true","ResponseMsg"=> "Notification has been sent."));
        }else{
                echo json_encode(array("ResponseCode"=>"2","Result"=>"false","ResponseMsg"=> "Notification could not sent."));
        }

        // Close the Connection to the Server.

        fclose ($tSocket); 
}
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-09-03T13:51:10.767

@djot 感谢您的回答，但您错过了在 = 之前添加点

```
$deviceToken = ARRAY();

$deviceToken = explode( ',' , @$_POST['devicesToken'] ); 
```

...........

```
foreach($deviceToken as $token){
$msg.= chr(0) . pack("n",32) . pack('H*', str_replace(' ', '', $token)) . pack        ("n",strlen($payload)) . $payload; 
```

# highcharts - Highcharts 图例标题边框不是全宽

> ID：15960052
> 
> 赞同：3
> 
> 时间：2013-04-11T22:34:06.167
> 
> 标签：highcharts

我需要使用 Highcharts (v3.0.1) 的图例标题，但边框不会呈现到标题的长度。它是一个错误吗？我无法使用`width`，因为我正在使用`layout: horizontal`.

添加超过 1 个系列时没有问题，但如果您只有 1 个，则图例布局中会出现错误（视觉上）。

示例：http: [//jsfiddle.net/3cSVr/1/](http://jsfiddle.net/3cSVr/1/)

```
 $(function () {
    var chart;

     $(document).ready(function() {

         chart = new Highcharts.Chart({

             chart: {
                 renderTo: 'container',
                 type: 'line',
             },
             plotOptions: {},                
             title: {
                 text: 'Monthly Average Temperature',
                 x: -20 //center
             },
             subtitle: {
                 text: 'Source: WorldClimate.com',
                 x: -20
             },
             xAxis: {
                 categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                     'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
             },
             yAxis: {
                 title: {
                     text: 'Temperature (°C)'
                 },
              plotLines: [{
                  value: 0,
                   width: 1,
                   color: '#808080'
               }]
             },   
             tooltip: {
                 formatter: function() {
                         return '<b>'+ this.series.name +'</b><br/>'+
                         this.x +': '+ this.y +'°C';
                 }
             },    
             legend: {
                 title: {
                     text: 'WorldClimate.com',
                     style: {
                         fontWeight: 'bold'
                     }
                 },
                 borderWidth: 2
             },               
             series: [{
                 name: 'Tokyo',
                 data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]                
             }
                     //Add more series;
             ]
         });
     });     
}); 
```

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T10:16:06.307

它看起来像一个错误，所以我在这里向我们的开发人员报告了它：[https ://github.com/highslide-software/highcharts.com/issues/1717](https://github.com/highslide-software/highcharts.com/issues/1717)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:28:44.727

我最近遇到了同样的问题，我是这样解决的：

```
function updateLegendBox(chart){
   //number of series
    if(chart.series.length == 1){
        var title =  $("g.highcharts-legend-title tspan")[0];
        var len = title.textContent.length * 8;
        var box = $("g.highcharts-legend rect")[0];
        box.setAttribute('width', len)
    }
} 
```

例子

```
var chart = new Highcharts.Chart({...});
updateLegendBox(chart); 
```

我希望它会有所帮助

# java - 关于带有接口的@Override 的有趣问题

> ID：15960055
> 
> 赞同：1
> 
> 时间：2013-04-11T22:34:32.003
> 
> 标签：java, maven, javac, java-6, java-5

`@Override`刚刚在实现接口方法的方法上编译带有注释的类文件时遇到了有趣的问题。

我试图在 Eclipse 中设置[moquette 项目](http://code.google.com/p/moquette-mqtt/source/checkout)并得到编译错误

```
Description Resource    Path    Location    Type
The method decodable(IoSession, IoBuffer) of type PubAckDecoder must override a superclass method   PubAckDecoder.java  /moquette-parser/src/main/java/org/dna/mqtt/moquette/proto  line 22 Java Problem 
```

这似乎是正确的，因为使用了 java 1.5 合规级别。然而这个项目是用 maven 成功构建的！这对我来说很奇怪。

有以下用于 javac 编译器的参数文件：

```
"-d"
"E:/workspaces/mqtt/moquette-mqtt/parser/target/classes"
"-classpath"
"E:/workspaces/mqtt/moquette-mqtt/parser/target/classes;e:/_mavenRepository/org/apache/mina/mina-core/2.0.4/mina-core-2.0.4.jar;e:/_mavenRepository/org/slf4j/slf4j-api/1.6.1/slf4j-api-1.6.1.jar;e:/_mavenRepository/org/slf4j/slf4j-log4j12/1.6.4/slf4j-log4j12-1.6.4.jar;e:/_mavenRepository/log4j/log4j/1.2.16/log4j-1.2.16.jar;"
"E:/workspaces/mqtt/moquette-mqtt/parser/src/main/java/org/dna/mqtt/moquette/proto/PubAckDecoder.java"
"-g"
"-nowarn"
"-target"
"1.5"
"-source"
"1.5"
"-encoding"
"UTF-8" 
```

我删除了所有其他源文件，只留下了`PubAckDecoder`包含错误的文件。

我错过了什么？为什么它不应该用maven构建？

**UPD**

编译器插件的 Maven 配置：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <configuration>
        <fork>true</fork>
            <source>1.5</source>
            <target>1.5</target>
     </configuration>
</plugin> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T22:40:39.770

您能否进一步描述“用于 javac 编译器的参数文件”的含义？

你在 pom.xml 上配置过这样的 maven-compiler-plugin 吗？

```
<plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <source>1.5</source>
                <target>1.5</target>
            </configuration>
        </plugin> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:22:08.130

找到这篇文章： http: [//kohsuke.org/2012/01/27/override-and-interface/](http://kohsuke.org/2012/01/27/override-and-interface/)。它解释了为什么 eclipse 有错误并且 maven 成功构建它。

# php - sql SELECT * FROM 语法错误

> ID：15960075
> 
> 赞同：-3
> 
> 时间：2013-04-11T22:36:53.443
> 
> 标签：php, mysql

我试图从我的 php 和 mysql 表中获取信息，但问题是该表全是数字。如果我做

```
mysql_query("SELECT * FROM Hello") 
```

它工作正常，

如果我做

```
mysql_query("SELECT * FROM 123") 
```

它说我的语法不正确。有人可以向我解释如何使用数字作为表名吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T22:38:05.277

尝试这个：

```
SELECT * FROM `123` 
```

您需要在前后使用`字符

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T22:38:31.157

尝试在您的表名周围添加`

```
mysql_query("SELECT * FROM `123`") 
```

以下是 mysql 中命名对象的规则 - 包括表：[http ://dev.mysql.com/doc/refman/5.1/en/identifiers.html](http://dev.mysql.com/doc/refman/5.1/en/identifiers.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T22:38:43.267

要将保留字、数字、带空格和标点符号的名称等用作列名或表名，请用反引号括起来：

```
SELECT * FROM `123` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T22:49:14.490

正如其他人所提到的，您可以将表名包含在反引号中以提供：

```
SELECT * FROM `123` 
```

但是，使用数字作为表名将是您必须非常仔细考虑的事情。原因是它可能会在以后导致混乱。您必须记住，对于此特定表的每个查询，您都必须将其包装在反引号中。

在不知道为什么您对以纯数字命名表格感兴趣的情况下，很难给出更好的建议。但请仔细考虑为什么要使用数字作为 SQL 表名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-11T22:40:11.653

你需要引用像'123'这样的数字

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-11T22:40:41.370

命名对象的规则，包括MySql中的表：

[http://dev.mysql.com/doc/refman/5.1/en/identifiers.html](http://dev.mysql.com/doc/refman/5.1/en/identifiers.html)

```
Identifiers may begin with a digit but unless quoted may not consist solely of digits. 
```

因此，使用您的语法，您可以执行以下操作：

```
SELECT * FROM `123` 
```

# cocoa - NSTask 标准输出消耗大量内存

> ID：15960082
> 
> 赞同：0
> 
> 时间：2013-04-11T22:37:16.307
> 
> 标签：cocoa, nstask

我正在通过 NSTask 运行一个生成大量输出的命令。我创建了一个连接到标准输出的管道，并且正在使用 waitForDataInBackgroundAndNotify 并使用 availableData 使用数据。但是，随着应用程序分配的内存不断增长，所有输出似乎都被缓冲了。如何清除/使用发送到标准输出的数据？这是我正在使用的代码：

```
- (void)runCommand:(NSString *)commandToRun
{
    self.task = [[NSTask alloc] init];
    [self.task setLaunchPath: @"/bin/sh"];
    NSArray *arguments = [NSArray arrayWithObjects:
                          @"-c" ,
                          [NSString stringWithFormat:@"%@", commandToRun],
                          nil];
    [self.task setArguments: arguments];
    NSPipe *pipe = [NSPipe pipe];
    [self.task setStandardOutput:pipe];
    NSFileHandle *fh = [pipe fileHandleForReading];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receivedData:) name:NSFileHandleDataAvailableNotification object:fh];
    [fh waitForDataInBackgroundAndNotify];
    [self.task launch];
}

- (void)receivedData:(NSNotification *)notification
{
    NSFileHandle *fh = [notification object];
    NSData *data = [fh availableData];
    // do stuff...
    [fh waitForDataInBackgroundAndNotify];
} 
```

# json - 远程验证，值未到达验证控制器

> ID：15960083
> 
> 赞同：0
> 
> 时间：2013-04-11T22:37:23.403
> 
> 标签：json, asp.net-mvc-3, jquery

我第一次尝试 MVC3 远程验证。我将它用于经典的“用户名是否被占用”场景，但我失败了。我已经检查了 chrome 开发人员中的 ajax 信息，它看起来像是在发送值，但是在我的验证控制器中，字符串为空。

从 ajax 标头（在 google 开发人员中）：

```
UserData.login:jon 
```

验证控制器：

```
public class ValidationController : Controller
{
    //
    // GET: /Validation/

    public JsonResult IsUsernameAvailable(string login)
    {
        var repo = new Repository();

        bool IsNameInUse = repo.CheckUserName(login);

        if (IsNameInUse == true)
        {
            return Json("The Username has been taken, please try another", JsonRequestBehavior.AllowGet);
        }

        return Json(true, JsonRequestBehavior.AllowGet);
    }

} 
```

“检查用户名”方法：

```
 public bool CheckUserName(string Username)
    {
        var existingUser = (from u in db.useraccount
                           where u.login.Equals(Username)
                           select u).SingleOrDefault();

        if (existingUser == null)
        {
            return false;
        }
        else
        {
            return true;
        }
    } 
```

并且用户模型上有 Remote 属性：

```
 [Remote("IsUserNameAvailable", "Validation")]
    [Display(Name = "Choose a Login Name")]
    [StringLength(40)]
    [Required]
    public string login { get; set; } 
```

我已经阅读了一些关于在验证控制器中手动绑定的内容，但是我用来构建它的示例并没有提到任何相关内容，所以我假设手动绑定只是对我做错的事情的一个补丁。如果您需要任何其他数据，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:14:48.643

好的，我发现了问题。从发送的 ajax 中可以看出，该字段正在发送 UserData.login，但验证控制器的参数只是登录。他们需要匹配，这样就解决了。

我想现在我需要稍微改变一下我的视图模型。

# java - Wicket onchange 事件返回旧值

> ID：15960086
> 
> 赞同：1
> 
> 时间：2013-04-11T22:37:33.290
> 
> 标签：java, ajax, wicket, wicket-1.6

我正在使用 Wicket 框架附加一个***onchange事件。***问题是当事件被触发时旧值不断被返回（这是有道理的）。*请参阅下面的代码*。

我想要做的是在更改后获取选择/保管箱的“***新***”值。

**我怎样才能做到这一点？**

```
 dropdown.add(new AjaxEventBehavior("onchange") {

        /**
         *
         * @param target
         */
        @Override
        protected void onEvent(AjaxRequestTarget target) {
            Component component = getComponent();
            DropDownChoice dropdown = (DropDownChoice) component;

            String value = dropdown.getValue();//This brings back the old value…
        }
    }) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T09:59:18.730

您必须使用 AjaxFormComponentUpdatingBehavior，否则将不会提交新值，然后调用 getModelObject() 来获取新选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T11:43:43.280

看看这个检票口的例子

[下拉ajax示例](https://cwiki.apache.org/WICKET/dropdownchoice-examples.html)

[带有代码的下拉 ajax 示例演示](http://www.wicket-library.com/wicket-examples/ajax/choice)

注意方法：wantOnSelectionChangedNotifications

> 如果选择更改，是否应使用 javascript window.location 调用此组件的 onSelectionChanged 事件处理程序。如果为 true，则每次选择更改都会生成往返，从而导致模型被更新（仅此组件）并调用 onSelectionChanged。此方法默认返回 false。如果您希望改用 Ajax，让 wantOnSelectionChangedNotifications() 返回 false 并使用 onchange 事件向组件添加 AjaxFormComponentUpdatingBehavior。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:01:14.243

从底层模型中获取价值可能会更好。当您可以访问变量“下拉菜单”时，也无需使用 getComponent。

```
dropdown.add(new AjaxEventBehavior("onchange") {

    /**
     *
     * @param target
     */
    @Override
    protected void onEvent(AjaxRequestTarget target) {

        String value = dropdown.getModelObject();
    }
}) 
```

# opengl - 我最多可以制作多少个统一缓冲区对象？

> ID：15960093
> 
> 赞同：1
> 
> 时间：2013-04-11T22:38:00.000
> 
> 标签：opengl, opengl-3

我可以在 OpenGL 3.2+ 中创建的最大统一缓冲区对象数量是多少？

我正在使用类似于以下的代码来生成 UBO（并假设`size`其中`data_pointer`包含有效数据）

```
GLuint uboIndex = 0;
glGenBuffers(1, &uboIndex);
glBindBuffer(GL_UNIFORM_BUFFER, uboIndex);

glBufferData(GL_UNIFORM_BUFFER, size, data_pointer, GL_DYNAMIC_DRAW);
glBindBuffer(GL_UNIFORM_BUFFER, 0); 
```

我可能会运行此代码多少次？它仅受显卡上可用内存的限制吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T02:21:31.003

没有“统一缓冲区对象”之类的东西；只有*[缓冲区对象](http://www.opengl.org/wiki/Buffer_Object)*。缓冲区对象的用途之一是作为统一数据的存储。

OpenGL 对可以创建的缓冲区对象的数量没有明确的限制。您可以创建多少主要取决于 OpenGL 实现可以分配多少内存。

# sql - 收到错误“函数中包含的选择语句无法将数据返回给客户端”

> ID：15960094
> 
> 赞同：18
> 
> 时间：2013-04-11T22:38:00.187
> 
> 标签：sql, sql-server, function, select

尝试在函数中使用 Select 语句时收到错误。错误指出：

> 消息 444，级别 16，状态 2，过程 JDE_GetWhereClause_test，第 26 行
> 函数中包含的选择语句无法将数据返回到客户端。

有任何想法吗？

```
CREATE FUNCTION [dbo].[JDE_GetWhereClause_test]
(
@tablename as varchar
)
RETURNS varchar(max)
AS
BEGIN
-- Declare the return variable here
Declare @ResultVar as varchar(max)

-- Add the T-SQL statements to compute the return value here

set @tablename = 'F0101'
Declare @Sql nvarchar(max)
Declare my_cur cursor for
    SELECT fsuser FROM dbo.JDE_ExRowSecurity where fsuser = fsuser;

Declare @fsuser as nchar(15)
open my_cur;
fetch next from my_cur;
while @@fetch_status = 0
   begin
      fetch next from my_cur into @fsuser;    
      set @ResultVar += ',' + @fsuser;
   end;
close my_cur;
deallocate my_cur;

-- Return the result of the function
RETURN @ResultVar
END 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-12T11:02:03.510

尝试玩类似...

```
CREATE FUNCTION [dbo].[JDE_GetWhereClause_test]
(
@tablename as varchar
)
RETURNS varchar(max)
AS
BEGIN
  -- Declare the return variable here
  Declare @ResultVar as varchar(max)

  -- Add the T-SQL statements to compute the return value here

  set @ResultVar = (select STUFF((SELECT ',', fsuser as [text()]
                    FROM dbo.JDE_ExRowSecurity 
                    FOR XML PATH ('')), 1, 1, '') as blah)

  -- Return the result of the function
  RETURN @ResultVar
END 
```

`select 'Answer is: '+[dbo].[JDE_GetWhereClause_test]('whatever')`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-31T00:11:37.123

发现这篇[MSDN 文章](https://social.msdn.microsoft.com/Forums/sqlserver/en-US/479cb04a-efdc-47bd-b0b9-9d20274477fa/error-select-statements-included-within-a-function-cannot-return-data-to-a-client?forum=sqlgetstarted)很有帮助，它解决了我的问题：

```
RETURN (SELECT GETDATE()); 
```

直接从 select 语句返回值，避免变量。

# java - setReadOnly() 与 canWrite()

> ID：15960098
> 
> 赞同：0
> 
> 时间：2013-04-11T22:38:24.597
> 
> 标签：java, file, delete-file

我正在尝试删除文件，但无论我尝试什么，它似乎都不起作用。我将文件设置为只读使用`setReadOnly()`，然后立即检查我是否可以写入它并且我可以。我正在使用 Windows，我发现这些方法可能存在错误。有什么方法可以完全关闭文件并切断所有访问权限以确保我可以删除它？

# ios - iOS：在哪里处理显示帐户选择模式？

> ID：15960107
> 
> 赞同：0
> 
> 时间：2013-04-11T22:38:53.393
> 
> 标签：ios, objective-c, organization, social-framework

我正在编写一个基本的 Twitter 应用程序（用于自学 iOS/Objective-C），但我遇到了一个小小的障碍。我之前问了一个与它相关的问题，但没有得到答案，在解决了这个问题（有点）之后，我陷入了一个没有得到回应的次要问题，所以我将它分解成它自己的问题并将其从其他。（[其他问题](https://stackoverflow.com/questions/15914977/issues-with-acaccountstore-requestaccesstoaccountswithtype-not-calling-completio)）

回到问题所在。我正在使用 iOS 6 的社交框架，用户可以在系统中注册一个或多个 Twitter 帐户。鉴于这一事实，我想提示拥有多个帐户的用户选择一个可以从中加载时间线的帐户，依此类推。如果只有一个，那么我显然只会使用它，所以我什至不需要那里的模态。

问题是在哪里做这个最好的地方？现在我已经有了`ACAccountStore`in`initWithNibName:bundle:`函数，它正在测试/加载模式，当它应该（只是慢慢地）。所以我已经完成了所有工作，我只是好奇在应用程序生命周期中的哪个位置是执行此操作的最佳位置 - 也许是`application:didFinishLaunchingWithOptions:`或其他地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T21:17:55.987

我展示了 UIAlertView 或 UIActionSheet 而不是 VC。它更适用于单例，并且更像 iOS。只需为每个帐户创建一个按钮并设置代码来选择该帐户。

# javascript - 将画布 dataurl 保存到用户的文件系统

> ID：15960108
> 
> 赞同：0
> 
> 时间：2013-04-11T22:38:57.380
> 
> 标签：javascript, asp.net-mvc, html5-canvas

好的，所以，我有一个 MVC 应用程序，我在其中创建画布图像，并通过执行 canvas.toDataURL("image/png") 获取数据 url。我想做的是将其保存到用户的文件系统中。

我试着用javascript做它：

```
var saveUrl = canvas.toDataURL("image/png");
saveUrl = saveUrl.replace("image/png", "application/octet");
window.open(saveUrl); 
```

但这只是给了我一个`download`没有任何扩展名或任何东西的文件。我想获得保存对话框并为文件指定类型和名称，然后将其保存到用户的光盘中。

所以我想我可以将数据发布到服务器，然后用响应头做一些事情来告诉浏览器我正在尝试为它保存图像，但我找不到一个好的方法来做到这一点。我正在使用 ASP.NET MVC。有没有人有一个简单的好方法让我做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T17:01:16.403

这就是我最终得到的结果：

帖子图片：

```
[HttpPost]
public void PostImageForPrinting(string dataUrl)
{
    SomePersistentObject.CurrentDataURL = dataUrl;
} 
```

服务图像：

```
public ActionResult PrintMission()
{
    var url =
            SomePersistentObject.CurrentDataURL.Substring(SomePersistentObject.CurrentDataURL.IndexOf(",") + 1);
    var image = Convert.FromBase64String(url);
    return base.File(image, "image/png", "mission.png");
} 
```

客户端：

```
var saveUrl = canvas.toDataURL("image/png");
var jsonString = JSON.stringify({ dataUrl: saveUrl });
$.ajax({
    url: "/Home/PostImageForPrinting",
    contentType: "application/json",
    type: "POST",
    data: jsonString,
    success: function (result) {
        window.location.href = "/Home/PrintMission";
    }
}); 
```

# qt - Qt 应用程序：VERIFIER STOP 00000013：当前堆栈跟踪的第一次机会访问冲突

> ID：15960109
> 
> 赞同：0
> 
> 时间：2013-04-11T22:39:02.133
> 
> 标签：qt, access-violation, qt-designer, application-verifier

自一周以来，我的 Qt 应用程序无法正常工作。我不熟悉这种堆损坏、访问冲突等东西。现在我知道它“很痛”，-)

同时我安装了应用程序验证器。我正在使用 VS2010、Qt 4.8.4、qwt 6.0.0。现在我将 GUI 类减少到最低限度，但仍然通过应用程序验证程序获得访问冲突。这是图形用户界面代码：

```
#include "mygui.h"
#include <QtGui/QApplication>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    MYGUI w;
    w.show();
    return a.exec();
} 
```

mygui.h：

```
#ifndef PFEGUI_H
#define PFEGUI_H

#include <QtGui/QMainWindow>
#include "ui_mygui.h"

#include <myengine.hpp>

class MYGUI : public QMainWindow
{
    Q_OBJECT

public:
    MYGUI(QWidget *parent = 0, Qt::WFlags flags = 0);
    ~MYGUI();

    Ui::MYGUIClass ui;

private:
    boost::shared_ptr<MYengine> myEngine_; 
    boost::shared_ptr<QMenu> treeWidgetMenu_;
    boost::shared_ptr<QAction> treeWidgetMenuDeleteAction_;

}; 
```

mygui.cpp:

```
#include "mygui.h"

MYGUI::MYGUI(QWidget *parent, Qt::WFlags flags)
    : QMainWindow(parent, flags)
{
    ui.setupUi(this);
    myEngine_ = boost::shared_ptr<MYengine>(new MYengine());
}

MYGUI::~MYGUI() {} 
```

和大型自动生成的 ui_mygui.h （由于字符限制，我在中间跳过了一些部分）：

```
/********************************************************************************
** Form generated from reading UI file 'mygui.ui'
**
** Created: Thu 11\. Apr 22:55:21 2013
**      by: Qt User Interface Compiler version 4.8.4
**
** WARNING! All changes made in this file will be lost when recompiling UI file!
********************************************************************************/

#ifndef UI_MYGUI_H
#define UI_MYGUI_H

#include <QtCore/QVariant>
#include <QtGui/QAction>
#include <QtGui/QApplication>
#include <QtGui/QButtonGroup>
#include <QtGui/QCheckBox>
#include <QtGui/QComboBox>
#include <QtGui/QDateEdit>
#include <QtGui/QDoubleSpinBox>
#include <QtGui/QFormLayout>
#include <QtGui/QFrame>
#include <QtGui/QGridLayout>
#include <QtGui/QGroupBox>
#include <QtGui/QHBoxLayout>
#include <QtGui/QHeaderView>
#include <QtGui/QLCDNumber>
#include <QtGui/QLabel>
#include <QtGui/QLineEdit>
#include <QtGui/QMainWindow>
#include <QtGui/QMenu>
#include <QtGui/QMenuBar>
#include <QtGui/QProgressBar>
#include <QtGui/QPushButton>
#include <QtGui/QRadioButton>
#include <QtGui/QScrollArea>
#include <QtGui/QSlider>
#include <QtGui/QSpacerItem>
#include <QtGui/QSpinBox>
#include <QtGui/QStackedWidget>
#include <QtGui/QStatusBar>
#include <QtGui/QTabWidget>
#include <QtGui/QTextBrowser>
#include <QtGui/QToolBar>
#include <QtGui/QTreeWidget>
#include <QtGui/QVBoxLayout>
#include <QtGui/QWidget>
#include "qwt_plot.h"

QT_BEGIN_NAMESPACE

class Ui_MYGUIClass
{
public:
    QWidget *centralWidget;
    QTabWidget *tabWidgetMYGUI;
    QWidget *tab;
    QWidget *layoutWidget;
    QVBoxLayout *verticalLayout;
    QPushButton *pushButtonSzenarienBerechnen;
    QPushButton *pushButtonMYBerechnen;
    QWidget *layoutWidget1;
    QVBoxLayout *verticalLayout_2;
    QHBoxLayout *horizontalLayout_4;
    QProgressBar *progressBarMY;
    QLCDNumber *lcdNumberWatch;
    QScrollArea *scrollAreaOutput;
    QWidget *scrollAreaWidgetContents;
    QGridLayout *gridLayout_6;
    QTextBrowser *textBrowserOutput;
    QWidget *tab_2;
    QGroupBox *groupBox_2;
    QGridLayout *gridLayout_5;
    QGridLayout *gridLayout_4;
    QPushButton *pushButtonPortfolioPfeBerechnen;
    QTreeWidget *treeWidgetPortfolioSimPort;
    QGroupBox *groupBox_3;
    QGridLayout *gridLayout_2;
    QHBoxLayout *horizontalLayout_10;
    QLabel *label_4;
    QComboBox *comboBoxPortfolioCtpNumbers;
    QHBoxLayout *horizontalLayout_11;
    QPushButton *pushButtonPortfolioShowCtp;
    QPushButton *pushButtonPortfolioAddCtp;
    QPushButton *pushButtonPortfolioAddAll;
    QGroupBox *groupBox_5;
    QGridLayout *gridLayout_10;
    QStackedWidget *stackedWidgetPortfolioAddDeal;
    QWidget *pageVanillaSwap;
    QGridLayout *gridLayout_11;
    QHBoxLayout *horizontalLayout_5;
    QRadioButton *radioButtonPortfolioPayer;
    QRadioButton *radioButtonPortfolioReceiver;
    QHBoxLayout *horizontalLayout_9;
    QLabel *label_19;
    QSpacerItem *horizontalSpacer_2;
    QDoubleSpinBox *doubleSpinBoxPortfolioFixRate;
    QHBoxLayout *horizontalLayout_6;
    QLabel *label_8;
    QSpacerItem *horizontalSpacer;
    QComboBox *comboBoxPortfolioIndices;
    QFormLayout *formLayout;
    QLabel *label_15;
    QComboBox *comboBoxPortfolioFixFreq;
    QLabel *label_16;
    QComboBox *comboBoxPortfolioFloatFreq;
    QFormLayout *formLayout_2;
    QLabel *label_18;
    QComboBox *comboBoxPortfolioFixDC;
    QLabel *label_20;
    QComboBox *comboBoxPortfolioFloatDC;
    QSpacerItem *verticalSpacer;
    QWidget *pagefxproducts;
    QGridLayout *gridLayout_12;
    QSpacerItem *verticalSpacer_2;
    QHBoxLayout *horizontalLayout_16;
    QLabel *label_21;
    QDoubleSpinBox *doubleSpinBoxPortfolioFxSpot;
    QHBoxLayout *horizontalLayout_14;
    QLabel *label_13;
    QDoubleSpinBox *doubleSpinBoxPortfolioForwardRate;
    QHBoxLayout *horizontalLayout_13;
    QLabel *label_12;
    QComboBox *comboBoxPortfolioCurrencyPairs;
    QHBoxLayout *horizontalLayout_8;
    QLabel *label_11;
    QSpinBox *spinBoxPortfolioNominal2;
    QLabel *labelPortfolioCurrency2;
    QComboBox *comboBoxPortfolioBuySell;
    QHBoxLayout *horizontalLayout_7;
    QLabel *label_10;
    QSpacerItem *horizontalSpacer_3;
    QLineEdit *lineEditPortfolioDealMaturity;
    QSpacerItem *horizontalSpacer_6;
    QDateEdit *dateEditPortfolioEndDate;
    QHBoxLayout *horizontalLayout_12;
    QLabel *label_9;
    QSpacerItem *horizontalSpacer_5;
    QDateEdit *dateEditPortfolioStartDate;
    QHBoxLayout *horizontalLayout_2;
    QLabel *label_6;
    QComboBox *comboBoxPortfolioInstrumentNames;
    QHBoxLayout *horizontalLayout_3;
    QLabel *label_7;
    QSpinBox *spinBoxPortfolioNominal;
    QComboBox *comboBoxPortfolioCurrencies;
    QPushButton *pushButtonPortfolioAddDeal;
    QHBoxLayout *horizontalLayout;
    QLabel *label_14;
    QSpacerItem *horizontalSpacer_4;
    QComboBox *comboBoxPortfolioAddDealCtpNumbers;
    QFrame *line;
    QHBoxLayout *horizontalLayout_15;
    QLabel *label_17;
    QLineEdit *lineEditPortfolioNPV;
    QPushButton *pushButtonPortfolioCalculateNPV;
    QComboBox *comboBoxPortfolioCtpNumbers_2;
    QWidget *tab_3;
    QwtPlot *qwtPlot;
    QWidget *layoutWidget_2;
    QHBoxLayout *horizontalLayout_18;
    QLabel *label_23;
    QComboBox *comboBoxAnalysisContractNumbers;
    QWidget *layoutWidget_3;
    QHBoxLayout *horizontalLayout_19;
    QLabel *label_24;
    QComboBox *comboBoxAnalysisCompNumbers;
    QPushButton *pushButtonAnalysisPlotCtp;
    QPushButton *pushButtonAnalysisPlotContract;
    QPushButton *pushButtonAnalysisPlotComp;
    QWidget *layoutWidget2;
    QHBoxLayout *horizontalLayout_17;
    QLabel *label_22;
    QComboBox *comboBoxAnalysisCtpNumbers;
    QCheckBox *checkBoxAnalysisSimulationPaths;
    QCheckBox *checkBoxAnalysisStatisticCurves;
    QGroupBox *groupBox_11;
    QWidget *layoutWidget3;
    QHBoxLayout *horizontalLayout_39;
    QRadioButton *radioButtonAnalysisBarStyle;
    QRadioButton *radioButtonAnalysisTubeStyle;
    QGroupBox *groupBox_12;
    QWidget *layoutWidget4;
    QHBoxLayout *horizontalLayout_20;
    QLabel *label_25;
    QSpinBox *spinBoxAnalysisSimStep;
    QLabel *label_26;
    QDateEdit *dateEditAnalysisChoosenDate;
    QPushButton *pushButtonAnalysisShowMarketData;
    QWidget *tab_7;
    QwtPlot *qwtPlot_2;
    QGroupBox *groupBox_6;
    QSpinBox *spinBoxAnalysisSimStep_2;
    QPushButton *pushButton;
    QPushButton *pushButton_2;
    QPushButton *pushButton_3;
    QPushButton *pushButton_4;
    QWidget *OptionsTab;
    QGroupBox *groupBox;
    QWidget *layoutWidget5;
    QGridLayout *gridLayout;
    QLabel *label;
    QSpinBox *spinBoxSimSteps;
    QSlider *horizontalSliderSimSteps;
    QLabel *label_2;
    QSpinBox *spinBoxForwardSteps;
    QSlider *horizontalSliderSimSteps_2;
    QLabel *label_3;
    QDoubleSpinBox *spinBoxJumpProb;
    QGroupBox *groupBox_4;
    QLabel *label_5;
    QLineEdit *lineEditSettingsInstrumentFile;
    QPushButton *pushButtonSettingsInstFileBrowse;
    QTextBrowser *textBrowserPortfolioCtpTrades;
    QStackedWidget *stackedWidget_2;
    QWidget *page_3;
    QWidget *page_4;
    QMenuBar *menuBar;
    QMenu *menuOptions;
    QToolBar *mainToolBar;
    QStatusBar *statusBar;
    QButtonGroup *buttonGroup_2;

    void setupUi(QMainWindow *MYGUIClass)
    {
        if (MYGUIClass->objectName().isEmpty())
            MYGUIClass->setObjectName(QString::fromUtf8("MYGUIClass"));
        MYGUIClass->resize(1538, 777);
        centralWidget = new QWidget(MYGUIClass);
        centralWidget->setObjectName(QString::fromUtf8("centralWidget"));
        tabWidgetMYGUI = new QTabWidget(centralWidget);
        tabWidgetMYGUI->setObjectName(QString::fromUtf8("tabWidgetMYGUI"));
        tabWidgetMYGUI->setGeometry(QRect(11, 0, 1521, 751));
        tabWidgetMYGUI->setIconSize(QSize(16, 16));
        tab = new QWidget();
        tab->setObjectName(QString::fromUtf8("tab"));
        layoutWidget = new QWidget(tab);
        layoutWidget->setObjectName(QString::fromUtf8("layoutWidget"));
        layoutWidget->setGeometry(QRect(10, 50, 401, 62));
        verticalLayout = new QVBoxLayout(layoutWidget);
        verticalLayout->setSpacing(6);
        verticalLayout->setContentsMargins(11, 11, 11, 11);
        verticalLayout->setObjectName(QString::fromUtf8("verticalLayout"));
        verticalLayout->setContentsMargins(0, 0, 0, 0);
        pushButtonSzenarienBerechnen = new QPushButton(layoutWidget);
        pushButtonSzenarienBerechnen->setObjectName(QString::fromUtf8("pushButtonSzenarienBerechnen"));
        pushButtonSzenarienBerechnen->setEnabled(true);
        QFont font;
        font.setPointSize(12);
        font.setBold(true);
        font.setWeight(75);
        pushButtonSzenarienBerechnen->setFont(font);
        pushButtonSzenarienBerechnen->setCheckable(false);

        verticalLayout->addWidget(pushButtonSzenarienBerechnen);

        pushButtonMYBerechnen = new QPushButton(layoutWidget);
        pushButtonMYBerechnen->setObjectName(QString::fromUtf8("pushButtonMYBerechnen"));
        pushButtonMYBerechnen->setEnabled(true);
        pushButtonMYBerechnen->setFont(font);
        pushButtonMYBerechnen->setCheckable(false);

        verticalLayout->addWidget(pushButtonMYBerechnen);

        verticalSpacer = new QSpacerItem(20, 40, QSizePolicy::Minimum, QSizePolicy::Expanding);

        gridLayout_11->addItem(verticalSpacer, 4, 0, 1, 1);

        stackedWidgetPortfolioAddDeal->addWidget(pageVanillaSwap);
        pagefxproducts = new QWidget();
        pagefxproducts->setObjectName(QString::fromUtf8("pagefxproducts"));
        gridLayout_12 = new QGridLayout(pagefxproducts);
        gridLayout_12->setSpacing(6);
        gridLayout_12->setContentsMargins(11, 11, 11, 11);
        gridLayout_12->setObjectName(QString::fromUtf8("gridLayout_12"));
        verticalSpacer_2 = new QSpacerItem(20, 80, QSizePolicy::Minimum, QSizePolicy::Expanding);

// Tons of other autogenerated stuff are deleted here

        QTreeWidgetItem *___qtreewidgetitem = treeWidgetPortfolioSimPort->headerItem();
        ___qtreewidgetitem->setText(9, QApplication::translate("MYGUIClass", "MY Exposure", 0, QApplication::UnicodeUTF8));
        ___qtreewidgetitem->setText(8, QApplication::translate("MYGUIClass", "MY Date", 0, QApplication::UnicodeUTF8));
        ___qtreewidgetitem->setText(7, QApplication::translate("MYGUIClass", "MY", 0, QApplication::UnicodeUTF8));
        ___qtreewidgetitem->setText(6, QApplication::translate("MYGUIClass", "Maturity", 0, QApplication::UnicodeUTF8));
        ___qtreewidgetitem->setText(5, QApplication::translate("MYGUIClass", "int. NPV", 0, QApplication::UnicodeUTF8));
        ___qtreewidgetitem->setText(4, QApplication::translate("MYGUIClass", "ext. NPV", 0, QApplication::UnicodeUTF8));
        ___qtreewidgetitem->setText(3, QApplication::translate("MYGUIClass", "Comp Id", 0, QApplication::UnicodeUTF8));
        ___qtreewidgetitem->setText(2, QApplication::translate("MYGUIClass", "Contract Id", 0, QApplication::UnicodeUTF8));
        ___qtreewidgetitem->setText(1, QApplication::translate("MYGUIClass", "Ctp Id", 0, QApplication::UnicodeUTF8));
        ___qtreewidgetitem->setText(0, QApplication::translate("MYGUIClass", "Kategorie", 0, QApplication::UnicodeUTF8));
        groupBox_3->setTitle(QApplication::translate("MYGUIClass", "Add Counterparty", 0, QApplication::UnicodeUTF8));
        label_4->setText(QApplication::translate("MYGUIClass", "Counterparty number", 0, QApplication::UnicodeUTF8));
#ifndef QT_NO_TOOLTIP
        pushButtonPortfolioShowCtp->setToolTip(QApplication::translate("MYGUIClass", "<html><head/><body><p>Kundenportfolio anzeigen...</p></body></html>", 0, QApplication::UnicodeUTF8));
#endif // QT_NO_TOOLTIP
        pushButtonPortfolioShowCtp->setText(QApplication::translate("MYGUIClass", "Show", 0, QApplication::UnicodeUTF8));
        pushButtonPortfolioAddCtp->setText(QApplication::translate("MYGUIClass", "Add", 0, QApplication::UnicodeUTF8));
        pushButtonPortfolioAddAll->setText(QApplication::translate("MYGUIClass", "Add all", 0, QApplication::UnicodeUTF8));
        groupBox_5->setTitle(QApplication::translate("MYGUIClass", "Add Deal", 0, QApplication::UnicodeUTF8));
        radioButtonPortfolioPayer->setText(QApplication::translate("MYGUIClass", "Payer", 0, QApplication::UnicodeUTF8));
        radioButtonPortfolioReceiver->setText(QApplication::translate("MYGUIClass", "Receiver", 0, QApplication::UnicodeUTF8));
        label_19->setText(QApplication::translate("MYGUIClass", "Fix Rate (in %)", 0, QApplication::UnicodeUTF8));
        label_8->setText(QApplication::translate("MYGUIClass", "Index", 0, QApplication::UnicodeUTF8));
        label_15->setText(QApplication::translate("MYGUIClass", "Fix Freq", 0, QApplication::UnicodeUTF8));
        label_16->setText(QApplication::translate("MYGUIClass", "Float Freq", 0, QApplication::UnicodeUTF8));
        label_18->setText(QApplication::translate("MYGUIClass", "Fix DC", 0, QApplication::UnicodeUTF8));
        label_20->setText(QApplication::translate("MYGUIClass", "Float DC", 0, QApplication::UnicodeUTF8));
        label_21->setText(QApplication::translate("MYGUIClass", "Spot", 0, QApplication::UnicodeUTF8));
        label_13->setText(QApplication::translate("MYGUIClass", "Forward rate", 0, QApplication::UnicodeUTF8));
        label_12->setText(QApplication::translate("MYGUIClass", "Currency pair", 0, QApplication::UnicodeUTF8));
        label_11->setText(QApplication::translate("MYGUIClass", "Notional 2", 0, QApplication::UnicodeUTF8));
        spinBoxPortfolioNominal2->setSuffix(QString());
        labelPortfolioCurrency2->setText(QApplication::translate("MYGUIClass", "USD", 0, QApplication::UnicodeUTF8));
        label_10->setText(QApplication::translate("MYGUIClass", "Maturity", 0, QApplication::UnicodeUTF8));
        lineEditPortfolioDealMaturity->setInputMask(QApplication::translate("MYGUIClass", "00y + 00m;_", 0, QApplication::UnicodeUTF8));
        lineEditPortfolioDealMaturity->setText(QApplication::translate("MYGUIClass", "05y + 00m", 0, QApplication::UnicodeUTF8));
        label_9->setText(QApplication::translate("MYGUIClass", "Start date", 0, QApplication::UnicodeUTF8));
        label_6->setText(QApplication::translate("MYGUIClass", "Inst-Type", 0, QApplication::UnicodeUTF8));
        label_7->setText(QApplication::translate("MYGUIClass", "Notional", 0, QApplication::UnicodeUTF8));
        spinBoxPortfolioNominal->setSuffix(QString());
        pushButtonPortfolioAddDeal->setText(QApplication::translate("MYGUIClass", "Add", 0, QApplication::UnicodeUTF8));
        label_14->setText(QApplication::translate("MYGUIClass", "Kunde", 0, QApplication::UnicodeUTF8));
        label_17->setText(QApplication::translate("MYGUIClass", "NPV", 0, QApplication::UnicodeUTF8));
        lineEditPortfolioNPV->setText(QApplication::translate("MYGUIClass", "not calculated", 0, QApplication::UnicodeUTF8));
        pushButtonPortfolioCalculateNPV->setText(QApplication::translate("MYGUIClass", "Calculate", 0, QApplication::UnicodeUTF8));
        tabWidgetMYGUI->setTabText(tabWidgetMYGUI->indexOf(tab_2), QApplication::translate("MYGUIClass", "Portfolio", 0, QApplication::UnicodeUTF8));
        label_23->setText(QApplication::translate("MYGUIClass", "Contract number", 0, QApplication::UnicodeUTF8));
        label_24->setText(QApplication::translate("MYGUIClass", "Component number", 0, QApplication::UnicodeUTF8));
        pushButtonAnalysisPlotCtp->setText(QApplication::translate("MYGUIClass", "Plot", 0, QApplication::UnicodeUTF8));
        pushButtonAnalysisPlotContract->setText(QApplication::translate("MYGUIClass", "Plot", 0, QApplication::UnicodeUTF8));
        pushButtonAnalysisPlotComp->setText(QApplication::translate("MYGUIClass", "Plot", 0, QApplication::UnicodeUTF8));
        label_22->setText(QApplication::translate("MYGUIClass", "Counterparty number", 0, QApplication::UnicodeUTF8));
        checkBoxAnalysisSimulationPaths->setText(QApplication::translate("MYGUIClass", "Show simulated NPV Paths", 0, QApplication::UnicodeUTF8));
        checkBoxAnalysisStatisticCurves->setText(QApplication::translate("MYGUIClass", "Show statistics", 0, QApplication::UnicodeUTF8));
        groupBox_11->setTitle(QApplication::translate("MYGUIClass", "Style Statistics", 0, QApplication::UnicodeUTF8));
        radioButtonAnalysisBarStyle->setText(QApplication::translate("MYGUIClass", "Bars", 0, QApplication::UnicodeUTF8));
        radioButtonAnalysisTubeStyle->setText(QApplication::translate("MYGUIClass", "Tube", 0, QApplication::UnicodeUTF8));
        groupBox_12->setTitle(QApplication::translate("MYGUIClass", "Simulation Parameters", 0, QApplication::UnicodeUTF8));
        label_25->setText(QApplication::translate("MYGUIClass", "Sim Step", 0, QApplication::UnicodeUTF8));
        label_26->setText(QApplication::translate("MYGUIClass", "Date", 0, QApplication::UnicodeUTF8));
        pushButtonAnalysisShowMarketData->setText(QApplication::translate("MYGUIClass", "Show Market Data", 0, QApplication::UnicodeUTF8));
        tabWidgetMYGUI->setTabText(tabWidgetMYGUI->indexOf(tab_3), QApplication::translate("MYGUIClass", "Analysis MY", 0, QApplication::UnicodeUTF8));
        groupBox_6->setTitle(QApplication::translate("MYGUIClass", "GroupBox", 0, QApplication::UnicodeUTF8));
        pushButton->setText(QApplication::translate("MYGUIClass", "PushButton", 0, QApplication::UnicodeUTF8));
        pushButton_2->setText(QApplication::translate("MYGUIClass", "PushButton", 0, QApplication::UnicodeUTF8));
        pushButton_3->setText(QApplication::translate("MYGUIClass", "PushButton", 0, QApplication::UnicodeUTF8));
        pushButton_4->setText(QApplication::translate("MYGUIClass", "PushButton", 0, QApplication::UnicodeUTF8));
        tabWidgetMYGUI->setTabText(tabWidgetMYGUI->indexOf(tab_7), QApplication::translate("MYGUIClass", "Analysis MD", 0, QApplication::UnicodeUTF8));
        groupBox->setTitle(QApplication::translate("MYGUIClass", "Simulation parameters", 0, QApplication::UnicodeUTF8));
        label->setText(QApplication::translate("MYGUIClass", "Number of Simulation Steps", 0, QApplication::UnicodeUTF8));
        label_2->setText(QApplication::translate("MYGUIClass", "Number of Forward Steps", 0, QApplication::UnicodeUTF8));
        label_3->setText(QApplication::translate("MYGUIClass", "Jump Probability", 0, QApplication::UnicodeUTF8));
        groupBox_4->setTitle(QApplication::translate("MYGUIClass", "Input Files", 0, QApplication::UnicodeUTF8));
        label_5->setText(QApplication::translate("MYGUIClass", "Instrument File:", 0, QApplication::UnicodeUTF8));
        pushButtonSettingsInstFileBrowse->setText(QApplication::translate("MYGUIClass", "...", 0, QApplication::UnicodeUTF8));
        tabWidgetMYGUI->setTabText(tabWidgetMYGUI->indexOf(OptionsTab), QApplication::translate("MYGUIClass", "Settings", 0, QApplication::UnicodeUTF8));
        menuOptions->setTitle(QApplication::translate("MYGUIClass", "Options", 0, QApplication::UnicodeUTF8));
    } // retranslateUi

};

namespace Ui {
    class MYGUIClass: public Ui_MYGUIClass {};
} // namespace Ui

QT_END_NAMESPACE

#endif // UI_MYGUI_H 
```

这编译没有任何问题。但是当我启动应用程序（使用应用程序验证程序）时，我在方法之后得到一个触发断点

```
void setupUi(QMainWindow *MYGUIClass) 
```

在ui_mygui.h中完成，进入MYengine的构造函数。没有执行构造函数的任何行，它只是触发一个断点。这是验证者报告：

======================================== VERIFIER STOP 00000013：pid 0x1CDC：第一次机会访问违规对于当前堆栈跟踪。

```
0AF79000 : Invalid address causing the exception.
00E15057 : Code address executing the invalid access.
0032F134 : Exception record.
0032F184 : Context record. 
```

======================================== 这个验证器停止是可继续的。调试后使用“go”继续。

========================================

如果我只是删除单行

```
myEngine_ = boost::shared_ptr<MYengine>(new MYengine()); 
```

在 mygui.cpp 中，Gui 打开，没有应用程序验证程序断点，一切似乎都运行良好。

我完全迷路了。class MYengine 是一个嵌入在静态库中的大型类，还有数百个附加类。错误发生在 Myengine 的构造函数的第一行执行之前。那么为什么有或没有上述行的行为如此不同？任何想法将不胜感激。这段代码开始让我成功，-(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T13:10:28.850

在不知道其余代码的情况下，我很确定您不应该将 Qt 指针放入 boost 共享指针中 - Qt 有自己的对象生命周期管理，并且会在不询问共享指针的情况下删除内存，因此您最终可能会得到 boost - 指向已释放内存的指针。但这仅适用于

```
boost::shared_ptr<QMenu> treeWidgetMenu_;
boost::shared_ptr<QAction> treeWidgetMenuDeleteAction_; 
```

应该分别是 QMenu* 和 QAction*。

我假设 MYengine 不是 Qt 类。或许，您应该向我们展示 MyEngine 的接口，以便我们了解，为什么指向 MyEngine 的共享指针会造成麻烦。

# php - 如何通过 PHP 从 MySQL 获取用户级别

> ID：15960113
> 
> 赞同：-2
> 
> 时间：2013-04-11T22:39:12.860
> 
> 标签：php, mysql

我想我在这里搞砸了很多。如果对你们中的一些人来说这似乎很容易，我很抱歉。但是我真的不明白如果用户是管理员或只是用户，我应该如何获取参数。

我的参数是： 如果 typ 是 1 = 用户有管理员权限 如果 typ 是 9 = 用户只有普通权限

从这个特权我很乐意打印一些链接......如果你知道我的意思吗？

```
include ('./conf/connect.php');
        $typ = mysql_query("SELECT * FROM 'tz_members' WHERE 'typ'=($_GET'$typ')"); 
        if($typ == 1){
            print "POWER, ste prijavljen kot admin.";
            print etc...
            }
        if($typ == 9){
            print "Ste navaden uporabnik";
            print etc...

        } 
```

希望你们中的某个人会如此友善地指导我朝着正确的方向前进。干杯，大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:48:59.753

这是对您的代码的更正，希望可以正常工作：

```
<?php
include ('./conf/connect.php');

$var = mysql_real_escape_string($_GET['typ']);

$query = mysql_query("SELECT * FROM `tz_members` WHERE `typ`='$var'") or die(mysql_error());
$data = mysql_fetch_array($query);
if($data['typ'] == 1){
     print "POWER, ste prijavljen kot admin.";
} elseif($data['typ'] == 9){
     print "Ste navaden uporabnik";
}
?> 
```

以您的方式进行操作的问题在于：

1.  你没有 mysql 注入预防 mysql_real_escape_string() 对此有帮助，但你应该使用 PDO。
2.  获取变量是通过 $_GET['variable_name']
3.  使用 mysql_query 时，您必须获取数组或执行 while 循环以获取多个结果。
4.  您可能应该阅读 PHP 数组，这样您就可以理解为什么上面使用了 $query['typ']（如果您还没有的话）。

查看：[http](http://www.tizag.com/mysqlTutorial/mysqlquery.php) ://www.tizag.com/mysqlTutorial/mysqlquery.php 另外：[http ://www.tizag.com/mysqlTutorial/mysqlselect.php](http://www.tizag.com/mysqlTutorial/mysqlselect.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T22:43:28.193

有几个问题。

首先，它应该`$_GET['typ']`代替`$_GET'$typ'`.

其次，您需要在使用查询值之前从查询中获取结果。

第三，考虑使用 PDO，因为`mysql_.*`语句已被贬低，并且您的方法容易受到 SQL 注入的影响。

编辑（来自zerkms）：第四，在字段名称周围使用“`”刻度并在值周围使用单引号。

# php - 运行此页面时出现 Wordpress 404 错误

> ID：15960114
> 
> 赞同：1
> 
> 时间：2013-04-11T22:39:24.530
> 
> 标签：php, wordpress, wordpress-theming

我正在尝试从 Wordpress 的前端发帖。我在一个名为的页面中有以下代码，`page-submit.php`虽然它有效，但在提交页面时出现 404 错误，但我不知道为什么或如何跟踪问题。

此页面`page_submit.php`显示良好，位于我的主题文件夹中。

有什么建议么？

```
<?php get_header(); ?>

<?php

// Check if the form was submitted
if( 'POST' == $_SERVER['REQUEST_METHOD'] && !empty( $_POST['action'] )) {

// Do some minor form validation to make sure there is content
if (isset ($_POST['title'])) { 
    $title =  $_POST['title']; 
} else { 
    echo 'Please enter a title';
}
if (isset ($_POST['description'])) { 
    $description = $_POST['description']; 
} else { 
    echo 'Please enter the content'; 
}
$tags = $_POST['post_tags'];

// Add the content of the form to $post as an array
$post = array(
    'post_title'    => $title,
    'post_content'  => $description,
    'post_category' => $_POST['cat'],  // Usable for custom taxonomies too
    'tags_input'    => $tags, 
    'post_status'   => 'publish',           // Choose: publish, preview, future, etc.
    'post_type'     => $_POST['post_type']  // Use a custom post type     if you want to
);
wp_insert_post($post);  // Pass  the value of $post to WordPress the insert function
                        // http://codex.wordpress.org/Function_Reference/wp_insert_post

wp_redirect( home_url() ); // redirect to home page after submit

} // end IF
// Do the wp_insert_post action to insert it
do_action('wp_insert_post', 'wp_insert_post'); 
?>

<!-- New Post Form -->
<div id="postbox">
<form id="new_post" name="new_post" method="post" action="">

    <p><label for="title">Title</label><br />
    <input type="text" id="title" value="" tabindex="1" size="20" name="title"     />
    </p>
    <p><label for="description">Description</label><br />
    <textarea id="description" tabindex="3" name="description" cols="50" rows="6"></textarea>
    </p>
    <p><?php wp_dropdown_categories( 'show_option_none=Category&tab_index=4&taxonomy=category' ); ?></p>
    <p><label for="post_tags">Tags</label>
        <input type="text" value="" tabindex="5" size="16" name="post_tags" id="post_tags" /></p>
    <p align="right"><input type="submit" value="Publish" tabindex="6" id="submit" name="submit" /></p>

    <input type="hidden" name="post_type" id="post_type" value="post" />
    <input type="hidden" name="action" value="post" />
    <?php wp_nonce_field( 'new-post' ); ?>
</form>
</div>
<!--// New Post Form -->

<?php get_sidebar(); ?>

<?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:07:03.447

看起来您的 POST 变量是由 Wordpress 保留的。尝试使用“title_x”、“description_x”和“post_tags_x”，而不是“title”、“description”和“post_tags”。

# ruby-on-rails - 在 Rails 控制台中创建实例时，Rails 4 强参数失败

> ID：15960121
> 
> 赞同：15
> 
> 时间：2013-04-11T22:39:54.583
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-4, strong-parameters

可能在这里做一些愚蠢的事情，但这是我的基本千篇一律的类：

```
class League < ActiveRecord::Base

    private
      def league_params
        params.require(:full_name).permit!
      end

end 
```

在创建 League 的新实例时：

```
2.0.0-p0 :001 > l = League.new(full_name: 'foo', short_name: 'bar')
WARNING: Can't mass-assign protected attributes for League: full_name, short_name 
```

我在这里到底做错了什么？这是 Rails 4.0.0.beta1 构建 + Ruby 2.0

** 更新 **

我现在意识到强参数现在在控制器中而不是在模型中强制执行。原来的问题仍然存在。如果在控制器级别允许它们，如果我在 Rails 控制台中创建实例，如何正确地将属性列入白名单？我不需要`attr_accessible`在这种情况下也使用，从而完全复制试图“修复”的强参数吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-11T23:45:50.083

两件事情。`league_params`定义在控制器中，而不是模型中。并且`params.require()`应该包含需要出现在参数中的模型的名称，而不是属性。属性存在检查仍应在模型验证中。并且在使用`permit!`. 所以，它应该是这样的：

```
class LeaguesController < ApplicationController

  private
    def league_params
      params.require(:league).permit!
    end

end 
```

更新：

是的，如果您希望在直接访问模型时限制属性，则需要切换回`attr_accessible`在模型中使用。该功能已移至此 gem：[https](https://github.com/rails/protected_attributes) ://github.com/rails/protected_attributes 。

我认为假设如果您直接在控制台中使用模型，则不需要保护属性，因为您确切知道输入的内容。由于控制台可以完全访问您的应用程序，因此管理整个数据库就像恶意分配属性一样容易。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-14T00:05:55.433

**强参数**和**attr_accessible**都存在的基本安全原因是模型中的某些属性不应被允许更改，除非它是您的代码的明确意图。

他们之间的细微差别是他们工作的透视形式。

**StrongParameters**专注于用例：考虑到任何条件，每个控制器的操作都可以微调以允许或禁止某些参数。完全的灵活性。

**attr_accessible**采取不同的观点。它不是专注于用例，而是专注于角色。例如，根据用户的角色，某些属性可以更改或不更改。

* * *

使用**StrongParameters**的方法是在参数哈希上应用`require`and`permit`关键字。

`require`声明一个键必须存在于 params 散列中。`require`如果没有这样的密钥，将引发异常。

`permit`声明一个字段是允许的。任何不允许的键都将从散列中删除，因此不会通过批量分配的方式传递给模型。

模型

```
class League
   attr_protected :final_price  # Nobody can mass-assign the final price
   attr_accessible :winner_name, :as => :jury
end 
```

和控制器

```
class LeaguesController < ApplicationController 
```

这两个动作使用**StrongParameters**

```
 # A common user can create a league
  def create
    league = League.new(league_params)
    league.final_price = 1000
    league.save
    redirect_to(league)
  end

  # But only the admin can publish a league
  def publish_league
     league = League.find(params[:id]
     league.update_attributes(league_params_as_admin)
  end 
```

这个使用**attr_accessible**

```
 def publish_the_winner
    league = League.find(params[:id]
    # We would expect the current_user.role to return :jury.
    league.assign_attributes(params[:league], :as => current_user.role)
  end

  private
    def league_params
      params.require(:league).permit(:name)
    end

    def league_params_as_admin
      params.require(:league).permit(:name, :status)
    end 

end 
```

在我的经验中：

使用强参数的灵活性来微调可以在每个控制器中批量分配的属性。

使用 attr_accesible 的无所不在确保某些属性无论如何都不能被大量分配。例如，在 Resque 任务中，您可以将用户输入作为参数传递。您将使用 attr_accesible 检查某些属性是否未批量分配。

更多信息：

[http://api.rubyonrails.org/classes/ActiveModel/MassAssignmentSecurity/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveModel/MassAssignmentSecurity/ClassMethods.html)

[https://github.com/rails/strong_parameters](https://github.com/rails/strong_parameters)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T05:43:50.150

即使您正在运行 Rails 4，白名单似乎也处于活动状态。您是否从 Rails 3 应用程序升级到 Rails 4？你有这个`config/application.rb`吗？

```
config.active_record.whitelist_attributes = true 
```

仔细检查所有模型上的强参数是否有效。如果是，您可以将此设置更改为`false`。

另外，请仔细检查您的模型中是否没有`attr_accessible`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T23:10:44.910

如果您直接调用模型，那么是的，它将回避您在控制器中实现的任何逻辑。

但是，您可以从控制台调用您的控制器，然后在那里实现的 StrongParameters 将生效。

请参阅[如何从 Rails 的控制台调用控制器/视图方法？](https://stackoverflow.com/questions/151030/how-do-i-call-controller-view-methods-from-the-console-in-rails)

# ruby-on-rails - Rails 关联和范围

> ID：15960122
> 
> 赞同：0
> 
> 时间：2013-04-11T22:39:54.677
> 
> 标签：ruby-on-rails

我正在学习 Rails 中的范围，并且在进行一些范围定义时遇到了一些麻烦。说我有以下型号..

```
class Category < ActiveRecord::Base
  has_many :posts
  has_many :comments, :through => :post
end

class Post < ActiveRecord::Base
  belongs_to :category
  has_many :comments
end

class Comment < ActiveRecord::Base
  belongs_to :post
  has_many :categories, :through => :post
  # attribute: owner
end 
```

注意 Comment 的属性所有者。我正在尝试编写一个范围，它将返回只有我通过的所有者发表的评论的类别。因此，如果一个类别有评论并且这些评论是由其他几个所有者发表的，则不应包含这些评论。我有这个工作。我得到的类别与我通过的所有者有评论..但我也得到其他所有者也有评论的类别。

在我的类别模型中，我有这个..

```
scope :comments_by_owner, lambda { |name| joins(:comments).where("comments.owner = ?", name) } 
```

我打电话使用

```
Category.comments_by_owner("tom") 
```

我试着玩 joins 和 uniq 但没有运气..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:44:35.767

尝试这个：

```
scope :comments_by_owner, lambda { |name| joins(:posts => :comments).where(:comments => {:owner => name}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:44:42.947

看来，`select`用一个块使用`Array#select`. 尝试遍历所有类别，选择不包含其他名称注释的类别。

```
def find_single_name_categories(name)
  Category.scoped.select do |category|
    category.comments.scoped.select { |comment| comment.name != name }.empty?
  end
end 
```

# sql-server - 如何创建自定义的钻取报告

> ID：15960127
> 
> 赞同：0
> 
> 时间：2013-04-11T22:40:09.073
> 
> 标签：sql-server, reporting-services, ssrs-2008, reporting

我目前有这个很棒的钻取::

![在此处输入图像描述](https://i.stack.imgur.com/6SotP.png)

我想做的是这个:::

![在此处输入图像描述](https://i.stack.imgur.com/ytMu6.png)

换句话说，我不想拥有一个单独的字段（本身），而是希望将右侧的文本部分与左侧的内容一起嵌入。

我希望它也可以扩展。

这可能吗？

**如果没有，什么是锻炼，或者至少是类似的解决方案？**

在设计模式下向您展示报告可能会有所帮助：

![在此处输入图像描述](https://i.stack.imgur.com/LQICe.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T04:24:11.720

我不相信合并会在细节上对您有用，但这将是理想的。但是，作为一种解决方法，请原谅我，因为我没有报告生成器，但如果您按照以下步骤操作：

1.  为了清楚起见，展开该行并将 tablix 放入其中。

2.  请务必在子 tablix 中设置正确的过滤器。

3.  添加一个组，名称为主要，注释为详细。

4.  将名称作为详细信息的切换。

5.  对于视觉效果，请务必删除所有边框并创建相同颜色的背景。

抱歉，如果细节有点偏离，我无法对此进行测试，但我希望我能帮助你。

# r - R: plm -- 年固定效应 -- 年和季度数据

> ID：15960129
> 
> 赞同：8
> 
> 时间：2013-04-11T22:40:18.413
> 
> 标签：r, regression, linear-regression, plm

我在设置面板数据模型时遇到问题。

以下是一些示例数据：

```
library(plm)

id <- c(1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2)
year <- c(1999,1999,1999,1999,2000,2000,2000,2000,1999,1999,1999,1999,2000,2000,2000,2000)
qtr <- c(1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4)
y <- rnorm(16, mean=0, sd=1)
x <- rnorm(16, mean=0, sd=1)

data <- data.frame(id=id,year=year,qtr=qtr,y_q=paste(year,qtr,sep="_"),y=y,x=x) 
```

我使用“id”作为单个索引和“年份”作为时间索引运行以下回归：

```
reg1 <- plm(y ~ x, data=data,index=c("id", "year"), model="within",effect="time") 
```

不幸的是，我收到以下错误：

> pdim.default(index[[1]], index[[2]]) 中的重复对 (time-id) 错误：

所以为了解决这个问题，我使用组合变量“y_q”：

```
reg1 <- plm(y ~ x, data=data,index=c("id", "y_q"), model="within",effect="time") 
```

但这是我的问题——我只想有年度固定效应而不是年度季度。

是否有另一种方法可以解决较早的问题，而不是使 tiem 索引为“y_q”？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T12:45:47.640

在面板设置中，您通常不会为每对 id-year 设置一些重复值。

在您的季度数据中，如果不聚合您的数据以使其成为年度数据，将很难计算一年的固定效应模型。

[查看此处](http://en.wikipedia.org/wiki/Panel_data)的示例，了解您的数据应如何格式化以进行面板数据建模。

这是一种方法：

```
require(plyr)
yeardata  <- ddply(data, .(year, id), summarize, y = mean(y),
                                                 x = mean(x))

require(plm)
reg1 <- plm(y ~ x, data = yeardata, index = c("id", "year"), model = "within", effect = "time")
fixef(reg1)

##      1999      2000 
## 0.2641997 0.0041193 
```

# jboss5.x - JBoss 5.1 GA：部署错误 [IllegalArgumentException]

> ID：15960130
> 
> 赞同：13
> 
> 时间：2013-04-11T22:40:24.023
> 
> 标签：jboss5.x, ear

我部署了一个 .ear 文件并收到此错误。我是 JBoss 的新手，我不知道如何解决它。

```
18:36:15,903 INFO  [ServerImpl] Starting JBoss (Microcontainer)...
18:36:15,904 INFO  [ServerImpl] Release ID: JBoss [The Oracle] 5.1.0.GA (build: SVNTag=JBoss_5_1_0_GA date=200905221053)
18:36:15,904 INFO  [ServerImpl] Bootstrap URL: null
18:36:15,904 INFO  [ServerImpl] Home Dir: /Users/ronyjohn007/JBOSS/jboss-5.1.0.GA
18:36:15,904 INFO  [ServerImpl] Home URL: file:/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/
18:36:15,904 INFO  [ServerImpl] Library URL: file:/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/lib/
18:36:15,905 INFO  [ServerImpl] Patch URL: null
18:36:15,905 INFO  [ServerImpl] Common Base URL: file:/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/common/
18:36:15,905 INFO  [ServerImpl] Common Library URL: file:/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/common/lib/
18:36:15,905 INFO  [ServerImpl] Server Name: default
18:36:15,906 INFO  [ServerImpl] Server Base Dir: /Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server
18:36:15,906 INFO  [ServerImpl] Server Base URL: file:/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/
18:36:15,906 INFO  [ServerImpl] Server Config URL: file:/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/conf/
18:36:15,906 INFO  [ServerImpl] Server Home Dir: /Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default
18:36:15,906 INFO  [ServerImpl] Server Home URL: file:/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/
18:36:15,906 INFO  [ServerImpl] Server Data Dir: /Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/data
18:36:15,906 INFO  [ServerImpl] Server Library URL: file:/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/lib/
18:36:15,906 INFO  [ServerImpl] Server Log Dir: /Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/log
18:36:15,907 INFO  [ServerImpl] Server Native Dir: /Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/tmp/native
18:36:15,907 INFO  [ServerImpl] Server Temp Dir: /Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/tmp
18:36:15,907 INFO  [ServerImpl] Server Temp Deploy Dir: /Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/tmp/deploy
18:36:16,416 INFO  [ServerImpl] Starting Microcontainer, bootstrapURL=file:/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/conf/bootstrap.xml
18:36:16,851 INFO  [VFSCacheFactory] Initializing VFSCache [org.jboss.virtual.plugins.cache.CombinedVFSCache]
18:36:16,854 INFO  [VFSCacheFactory] Using VFSCache [CombinedVFSCache[real-cache: null]]
18:36:17,055 INFO  [CopyMechanism] VFS temp dir: /Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/server/default/tmp
18:36:17,056 INFO  [ZipEntryContext] VFS force nested jars copy-mode is enabled.
18:36:17,905 INFO  [ServerInfo] Java version: 1.7.0_09,Oracle Corporation
18:36:17,905 INFO  [ServerInfo] Java Runtime: Java(TM) SE Runtime Environment (build 1.7.0_09-b05)
18:36:17,905 INFO  [ServerInfo] Java VM: Java HotSpot(TM) 64-Bit Server VM 23.5-b02,Oracle Corporation
18:36:17,906 INFO  [ServerInfo] OS-System: Mac OS X 10.7.5,x86_64
18:36:17,907 INFO  [ServerInfo] VM arguments: -Dprogram.name=run.sh -Xms128m -Xmx512m -XX:MaxPermSize=256m -Dorg.jboss.resolver.warning=true -Dsun.rmi.dgc.client.gcInterval=3600000 -Dsun.rmi.dgc.server.gcInterval=3600000 -Djava.endorsed.dirs=/Users/ronyjohn007/JBOSS/jboss-5.1.0.GA/lib/endorsed 
18:36:17,934 INFO  [JMXKernel] Legacy JMX core initialized
18:36:19,183 ERROR [AbstractKernelController] Error installing to Instantiated: name=AttachmentStore state=Described
java.lang.IllegalArgumentException: Wrong arguments. new for target java.lang.reflect.Constructor expected=[java.net.URI] actual=[java.io.File]
    at org.jboss.reflect.plugins.introspection.ReflectionUtils.handleErrors(ReflectionUtils.java:395)
    at org.jboss.reflect.plugins.introspection.ReflectionUtils.newInstance(ReflectionUtils.java:153)
    at org.jboss.reflect.plugins.introspection.ReflectConstructorInfoImpl.newInstance(ReflectConstructorInfoImpl.java:106)
    at org.jboss.joinpoint.plugins.BasicConstructorJoinPoint.dispatch(BasicConstructorJoinPoint.java:80)
    at org.jboss.aop.microcontainer.integration.AOPConstructorJoinpoint.createTarget(AOPConstructorJoinpoint.java:282)
    at org.jboss.aop.microcontainer.integration.AOPConstructorJoinpoint.dispatch(AOPConstructorJoinpoint.java:103)
    at org.jboss.kernel.plugins.dependency.KernelControllerContextAction$JoinpointDispatchWrapper.execute(KernelControllerContextAction.java:241)
    at org.jboss.kernel.plugins.dependency.ExecutionWrapper.execute(ExecutionWrapper.java:47)
    at org.jboss.kernel.plugins.dependency.KernelControllerContextAction.dispatchExecutionWrapper(KernelControllerContextAction.java:109)
    at org.jboss.kernel.plugins.dependency.KernelControllerContextAction.dispatchJoinPoint(KernelControllerContextAction.java:70)
    at org.jboss.kernel.plugins.dependency.InstantiateAction.installActionInternal(InstantiateAction.java:66)
    at org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:54)
    at org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:42)
    at org.jboss.dependency.plugins.action.SimpleControllerContextAction.simpleInstallAction(SimpleControllerContextAction.java:62)
    at org.jboss.dependency.plugins.action.AccessControllerContextAction.install(AccessControllerContextAction.java:71)
    at org.jboss.dependency.plugins.AbstractControllerContextActions.install(AbstractControllerContextActions.java:51)
    at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
    at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
    at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:774)
    at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:540)
    at org.jboss.kernel.plugins.deployment.AbstractKernelDeployer.deployBean(AbstractKernelDeployer.java:319)
    at org.jboss.kernel.plugins.deployment.AbstractKernelDeployer.deployBeans(AbstractKernelDeployer.java:297)
    at org.jboss.kernel.plugins.deployment.AbstractKernelDeployer.deploy(AbstractKernelDeployer.java:130)
    at org.jboss.kernel.plugins.deployment.BasicKernelDeployer.deploy(BasicKernelDeployer.java:76)
    at org.jboss.bootstrap.microcontainer.TempBasicXMLDeployer.deploy(TempBasicXMLDeployer.java:91)
    at org.jboss.bootstrap.microcontainer.TempBasicXMLDeployer.deploy(TempBasicXMLDeployer.java:161)
    at org.jboss.bootstrap.microcontainer.ServerImpl.doStart(ServerImpl.java:138)
    at org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:450)
    at org.jboss.Main.boot(Main.java:221)
    at org.jboss.Main$1.run(Main.java:556)
    at java.lang.Thread.run(Thread.java:722)
Failed to boot JBoss:
java.lang.IllegalStateException: Incompletely deployed:

DEPLOYMENTS IN ERROR:
  Deployment "AttachmentStore" is in error due to: java.lang.IllegalArgumentException: Wrong arguments. new for target java.lang.reflect.Constructor expected=[java.net.URI] actual=[java.io.File]

DEPLOYMENTS MISSING DEPENDENCIES:
  Deployment "ProfileService" is missing the following dependencies:
    Dependency "ProfileServiceDeployer" (should be in state "Installed", but is actually in state "Instantiated")
    Dependency "jboss.kernel:service=KernelController" (should be in state "Installed", but is actually in state "**ERROR**")
  Deployment "ProfileServiceDeployer" is missing the following dependencies:
    Dependency "AttachmentStore" (should be in state "Installed", but is actually in state "**ERROR**")
  Deployment "ProfileServiceBootstrap" is missing the following dependencies:
    Dependency "ProfileService" (should be in state "Installed", but is actually in state "Instantiated")
    Dependency "jboss.kernel:service=Kernel" (should be in state "Installed", but is actually in state "**ERROR**")
  Deployment "ProfileServicePersistenceDeployer" is missing the following dependencies:
    Dependency "AttachmentStore" (should be in state "Installed", but is actually in state "**ERROR**")

    at org.jboss.kernel.plugins.deployment.AbstractKernelDeployer.internalValidate(AbstractKernelDeployer.java:278)
    at org.jboss.kernel.plugins.deployment.AbstractKernelDeployer.validate(AbstractKernelDeployer.java:174)
    at org.jboss.bootstrap.microcontainer.ServerImpl.doStart(ServerImpl.java:142)
    at org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:450)
    at org.jboss.Main.boot(Main.java:221)
    at org.jboss.Main$1.run(Main.java:556)
    at java.lang.Thread.run(Thread.java:722)
18:36:19,633 INFO  [ServerImpl] Runtime shutdown hook called, forceHalt: true
18:36:19,638 INFO  [ServerImpl] Shutdown complete
Shutdown complete
Halting VM 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-06-04T02:17:52.540

你可以试试这个。

在 jboss-5.1.0.GA\server\default\conf\bootstrap 中打开文件 profile.xml

找到“附件商店”块：

在《参数》中添加“class="java.io.File"。

或者你可以试试这个链接： [Error when started JBoss 5.1.0.GA / AttachmentStore](https://stackoverflow.com/questions/8316857/error-when-starting-jboss-5-1-0-ga-attachmentstore?lq=1)

直接解决方案的路径：[启动 jboss 服务器时出错](https://stackoverflow.com/questions/2489106/error-starting-jboss-server)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-07-01T09:13:55.843

打开文件 profile.xml

jboss-5.1.0.GA\server\default\conf\bootstrap\profile.xml 然后

> 替换-->

```
<bean name="AttachmentStore" class="org.jboss.system.server.profileservice.repository.AbstractAttachmentStore">  
     <constructor><parameter><inject bean="BootstrapProfileFactory" property="attachmentStoreRoot" /></parameter></constructor> 
```

> 与 -->

```
<bean name="AttachmentStore" class="org.jboss.system.server.profileservice.repository.AbstractAttachmentStore">  
 <constructor>><parameter class="java.io.File"><inject bean="BootstrapProfileFactory" property="attachmentStoreRoot" /></parameter></constructor> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-10T21:02:29.243

我将 java_home 从 1.7 更改为 1.6，并且在不更改 conf/bootstrap/profile.xml 的情况下为我解决了这个问题（在 bin\run.conf 或 bin\run.conf.bat 中）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-27T18:45:24.510

我的问题与 gribo 类似地解决了。我的路径变量正确指向 JDK6（我正在使用 JDK6 运行 JBoss5.1）。但在 Eclipse 中，我的 JBoss 运行时 JRE 指向 JRE8。一旦我将它指向 JRE6，问题就消失了。

我也不必更改 conf/bootstrap/profile.xml。我首先尝试了它，但它并没有解决我的问题。

# jquery - AngularJS + jQuery - 无法隐藏/显示指令内的元素

> ID：15960131
> 
> 赞同：1
> 
> 时间：2013-04-11T22:40:25.487
> 
> 标签：jquery, angularjs

我有一个在网页上显示的元素 - 这个元素是一个 twitter 引导图标 -
`<i class="icon-trash"></i>`。

当页面加载时，通过使用隐藏类对其应用样式来隐藏图标：

```
.hidden {
    display: none;
} 
```

现在，我创建了一个指令，其最简单的形式如下所示：

```
var app = angular.module('testApp', []);

app.directive('testDir', function() {
    return function(scope, iElement, iAttrs) {
        iElement.customMethod({
            source: function() {
                //Some other statements
                jQuery(".icon-trash").removeClass('hidden');
            }
        });
    };
}); 
```

该指令作为属性放置在输入框上。当用户输入输入文本时，指令函数确实被调用。但是，该图标永远不会再次显示，即即使调用了该函数（使用检查），jQuery 代码似乎也没有删除隐藏的类`console.log()`。知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:19:32.807

> **解决方案 1：** jQuery - .show() 和 .hide()。

隐藏它`pageshow`

```
$('.icon-trash').hide() 
```

随时显示。

```
$('.icon-trash').show() 
```

* * *

> **解决方案 2：**创建两个类，添加/删除它们。

```
.hide-me { display: none !important;}

.show-me { display: inline-block !important; }

$('.icon-trash').removeClass('hide-me').addClass('show-me'); 
```

* * *

> **解决方案 3：**肮脏的直截了当的方式

```
$('.icon-trash').attr('style', 'display: inline-block !important;') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:08:40.973

**此代码使用ng-show**指令显示一个带有垃圾桶图标的按钮。每当字段**搜索**设置为某物时，即：用户在输入文本中输入了某物。否则，如果文本被删除，按钮将再次隐藏。

```
<input type="text" ng-model="search" />
<button class="btn" ng-show="search" ng-click="trash()">
    <i class="icon-trash"></i> button
</button> 
```

单击按钮时，将调用垃圾箱功能。

```
app.controller('HomeController', ['$scope', function($scope) {
    $scope.search = undefined;

    $scope.trash = function() {
        console.log('clicked: trash button');
    };
}]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-20T09:10:03.700

也许在角度指令中隐藏/显示会有所帮助。Jquery 必须在 html 中的 angular 之前包含，并且游览将按预期工作。

# c# - 为什么 setFieldProperty 返回 false？

> ID：15960132
> 
> 赞同：3
> 
> 时间：2013-04-11T22:40:28.947
> 
> 标签：c#, fonts, itextsharp

我的代码将文本设置到字段中没有问题，但是当我尝试更改字体时它返回 false。我尝试了其他一些字段属性，例如具有相同结果的文本大小。我究竟做错了什么？

```
public string Build()
    {
        Font font = FontFactory.GetFont(FontFactory.COURIER, 8f, Font.BOLD);
        foreach (var i in this.pdfFields)
        {
            bool worked = this.acroFields.SetFieldProperty(i.Name, "textfont", font.BaseFont, null);
            worked = this.acroFields.SetField(i.Name, i.Value);
        }//foreach

        this.pdfStamper.FormFlattening = false;
        this.pdfStamper.Close();

        return this.newFile;
    }//Build 
```

**附录**

```
 private string templateFile;
    private string newFile;

    private PdfReader pdfReader;
    private PdfStamper pdfStamper;
    private AcroFields acroFields;
    private List<PDFField> pdfFields;

    public PDFer(string templateFile, string newFile)
    {
        this.templateFile = templateFile;
        this.newFile = newFile;

        this.pdfReader = new PdfReader(this.templateFile);
        this.pdfStamper = new PdfStamper(pdfReader, new FileStream(this.newFile, FileMode.Create));
        this.acroFields = pdfStamper.AcroFields;

        this.pdfFields = new List<PDFField>();
    }//PDFer

    public void AddTextField(string name, string value)
    {
        this.pdfFields.Add(new PDFTextField(name, value));
    }//AddTextField

    public void AddCheckBox(string name, bool isChecked)
    {
        this.pdfFields.Add(new PDFCheckBox(name, isChecked));
    }//AddCheckBox

    public float getWidth(string s)
    {
        Chunk c = new Chunk(s);
        return c.GetWidthPoint();
    }//getWidth 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T10:48:44.377

设置文本大小时，该值需要是一个`Float`值。如果是`int`，则说明您使用了错误的方法。当你设置字体时，你需要一个真实的`BaseFont`对象。我认为你`font.BaseFont`是`null`。我会像这样创建 BaseFont：

```
BaseFont.CreateFont(BaseFont.COURIER, BaseFont.WINANSI, BaseFont.EMBEDDED); 
```

请注意，EMBEDDED 将被忽略，因为 COURIER 是标准 Type 1 字体之一。

# c# - 在 IIS 网络服务器上的所有工作进程中刷新 HttpRuntime.Cache 对象

> ID：15960133
> 
> 赞同：3
> 
> 时间：2013-04-11T22:40:29.837
> 
> 标签：c#, asp.net, iis-7

我有一个在 IIS 7 上以 web-garden 模式运行的 asp.net web 应用程序。我想使用单步清除所有工作进程中的运行时缓存项。我可以设置一个数据库键值，但这意味着在每个工作进程上执行的线程，在我的每个负载平衡场景 Web 服务器上将轮询该键值的更改并刷新缓存。这将是一个非常糟糕的机制，因为我每天最多刷新一次缓存项目。此外，由于我有一个 MySql 数据库，因此我无法使用带有 Service Broker 通知的 SqlCacheDependency 来实现推送通知。有什么想法吗？有什么肮脏的解决方法吗？一种可能的解决方法是公开一个 aspx 页面，然后使用托管站点的 ip 和端口而不是域名多次访问该页面 - 例如：[http://ip.ip.ip.ip:82/CacheClear。 aspx](http://ip.ip.ip.ip:82/CacheClear.aspx)，以便可以将对该页面的请求发送到该网络服务器中的所有工作进程，并在 Page_Load 上清除缓存项。但这是一个非常肮脏的 hack，并且在所有请求都发送到同一个工作进程的情况下可能不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T23:02:35.063

您需要设置进程间通信。对于缓存，有两种常用的方法：

*   设置共享缓存（memcached 等）。
*   设置一个消息队列（例如 ms-mqueue 或 rabbitMq）并使用它将状态传播到本地缓存。

共享缓存是最终的解决方案，因为它意味着整个缓存是分布式的，但它也是最复杂的：需要设置它，以便缓存负载在节点之间正确分布，并确保它不会成为瓶颈。

第二个选项需要您编写更多代码，但如果您不想共享缓存内容（如您的情况），则更容易。最简单的是设置侦听器线程或任务来处理缓存清除或单个条目失效消息。如果没有消息，该线程将处于休眠状态，因此对性能的影响很小。您还可以通过将消息作为通常的 iis 请求管道的一部分来处理来放弃侦听器线程。即设置一个过滤器/模块来检查队列中的消息并在处理请求之前对其进行处理；但在性能方面，第一个选择（稍微）更好。

# php - 找到匹配项时，我的循环使结果加倍

> ID：15960137
> 
> 赞同：0
> 
> 时间：2013-04-11T22:41:06.493
> 
> 标签：php, loops

我有几个月的数据库。我正在使用以下内容对类似月份进行分组：

```
$Mydates = array();
while(........)
{
    $date = $row['date'];
    $Mydates[$date] = (isset($Mydates[$date])) ? $Mydates[$date] + 1: 1;
} 
```

我的表包含 4 个数据，分别是 1 月 3 日和 2 月 1 日。现在，这些信息正在通过一个包含一年中月份的数组来运行。这是我到目前为止所拥有的：

```
 $months = array("Jan","Feb","Mar",etc........);
    foreach($months as $month)
    {
      foreach($Mydates as $Mydate => $Number)
      {
      if($month == $Mydate)
         {
         echo $month." (".$Number.")<br />";
         }else{
         echo $month."<br />";
         }
      }
    } 
```

现在，当只有 Jan 时，这可以正常工作。现在我又增加了一个月，我的结果显示如下：

一月(3) 一月(3) 二月(1) 二月(1) 三月 三月 等等.....等等......

我怎样才能让它像这样只显示一次：

一月（3）二月（1）三月等......

现在我注意到，添加的月份越多，重复的次数就越多。有人可以看看这个并告诉我我哪里出错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T22:50:05.683

看来，`$Mydates`已经按月汇总和访问。删除内部循环并查看是否有相应的月份`$Mydates`

```
foreach($months as $month) {
    if(isset($Mydates[$month])) {
        echo $month." (".$Mydates[$month].")<br />";
    } else {
        echo $month."<br />";
    }
} 
```

# ruby - 即时交换 rails3 布局

> ID：15960142
> 
> 赞同：2
> 
> 时间：2013-04-11T22:41:28.310
> 
> 标签：ruby, ruby-on-rails-3

我试图深入研究实际上看起来和功能都很好的 twitter bootstrap 和 rails3 网站（对这一切都是新的）。我有我想要的这个功能，我有一个 twitter 引导导航（在我猜是默认应用程序布局中指定）调用 _navigation.erb.html 等。这很好用，但在那个导航上我想要一个“Se Habla Espanol "或者什么不是，当用户点击那里时，导航文本全部变为西班牙语。我认为最简单的方法是使用另一个 _navigationespanol.erb.html 或改变周围导航词的东西，并且当点击（切换到西班牙语模式）时，它会将页面中的所有文本设置为西班牙语，只要有文本渲染或其他设置了一个变量标志，并在页面索引渲染显示或你有什么上被询问，它呈现西班牙语或英语单词......

所以理想情况下，点击查看全部西班牙语，它会加载一个新布局（我的主要问题），其中包含西班牙语导航和消息以及其他 twitter 引导程序内容，它还设置了一个全局变量，我可以在其他渲染中查看我是否翻译英语或西班牙语。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T22:48:01.530

除了交换布局之外，您似乎还需要实现`Internationalization (I18n)`. 在这种情况下，您必须创建一个目录`config/locales`，其中包含您尝试翻译的每种语言的 .yaml 文件，例如：

```
# on a file called en.yml
en:
  hello: "Hello world" 
```

有关如何去做的完整指南：[Rails Internationalization (I18n) API](http://guides.rubyonrails.org/i18n.html)

# c++ - 有没有办法将 child* 返回到 base* 并评估哪个 child* 已返回？

> ID：15960145
> 
> 赞同：1
> 
> 时间：2013-04-11T22:41:51.540
> 
> 标签：c++, oop, class, pointers, inheritance

我试过这个没有用：

```
void Map::OnLMClick(short xPos, short yPos)
{
    SObject* pSObject = pEditWindow->GetSelectedItem();

    if (pSObject==SOTile)
    {
       /* Do */ 
```

我试过这个作为测试：

```
SObject* EditorWindow::GetSelectedItem()
{
    return pSOTile[1]; //pSOTile[1] is a valid pointer, member of EditorWindow
} 
```

SOtile 类是基类 SObject 的子类。那么，是否有可能创建一个 Base* 以返回其子 * 之一，然后让程序根据返回的子元素做出不同的反应？如果是这种情况，那么我如何才能访问不是 base 成员的子成员？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T22:44:47.110

如果你的类型是多态的（即如果它们至少有一个虚函数），你可以使用`dynamic_cast`：

```
Base* pObject = get_object(); // May return a pointer to Derived
Derived* pDerived = dynamic_cast<Derived*>(pObject); 
```

请注意，动态向下转换有时是糟糕设计的标志。尝试考虑在您的层次结构中更好地安排虚拟功能是否会有所帮助。

在不了解具体应用领域的情况下，我无法给出更具体的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T22:48:37.533

[dynamic_cast 运算符](http://en.cppreference.com/w/cpp/language/dynamic_cast)在类是多态时执行特殊检查。

```
 SOTile* pSOTile = dynamic_cast<SOTile*>(pSObject);
   if (pSOTile)
   {
      /* Do */
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T23:25:58.087

由于`SOTile`是指向派生自 的类型的指针`SObject`，因此您根本不需要强制转换，因为编译器应该能够`SObject`从派生指针自动解析指针，然后将两个`SObject`指针一起比较（与您可以分配的相同方式指向基指针的派生指针，没有类型转换）。一些编译器，比如 Borland 的，支持就好了，例如：

```
class Base
{
};

class Derived : public Base
{
};

Derived *d = ...;
Base *b = ...;

if (b == d) // <-- compiles fine 
```

但是，如果出于某种原因您的编译器不允许这样做，您可以使用`static_cast`（不要用于`dynamic_cast`转换基指针）手动转换派生指针：

```
if (pSObject == static_cast<SObject*>(SOTile)) 
```

If`SOTile`不是指向派生自 的类型的指针`SObject`，`static_cast`将在编译时失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T22:57:23.793

我不建议使用 dynamic_cast。相反，您可以在不同的子类中实现不同的行为。有时称为“[模板方法](http://en.wikipedia.org/wiki/Template_method_pattern)”模式

# mysql - mysql查询耗时过长

> ID：15960149
> 
> 赞同：5
> 
> 时间：2013-04-11T22:42:38.077
> 
> 标签：mysql

我是高级查询的新手，所以我可能在概念上有些错误，因为当数据库有超过 100 万条记录时，我会从我的查询中得到这个响应......

`ERROR 2013: Lost connection to MySQL server during query`

是的！它实际上需要很长时间才能完成之前呕吐。

我的查询是这个...

```
SELECT users.username,
    table_1.field_abc, table_1.field_def,
    table_2.field_ghi, table_2.field_jkl
FROM users
LEFT JOIN table_1 ON table_1.username = users.username
LEFT JOIN table_2 ON table_2.username = users.username
WHERE
    table_1.field_abc REGEXP "(spork|yellow)" OR
    table_1.field_def REGEXP "(spork|yellow)" OR
    table_2.field_ghi REGEXP "(spork|yellow)" OR
    table_2.field_jkl REGEXP "(spork|yellow)"
GROUP BY users.username
ORDER BY
(
    ( CASE WHEN table_1.field_abc LIKE "%spork%" THEN 1 ELSE 0 END ) +
    ( CASE WHEN table_1.field_abc LIKE "%yellow%" THEN 1 ELSE 0 END ) +
    ( CASE WHEN table_1.field_def LIKE "%spork%" THEN 1 ELSE 0 END ) +
    ( CASE WHEN table_1.field_def LIKE "%yellow%" THEN 1 ELSE 0 END ) +
    ( CASE WHEN table_2.field_ghi LIKE "%spork%" THEN 1 ELSE 0 END ) +
    ( CASE WHEN table_2.field_ghi LIKE "%yellow%" THEN 1 ELSE 0 END ) +
    ( CASE WHEN table_2.field_jkl LIKE "%spork%" THEN 1 ELSE 0 END ) +
    ( CASE WHEN table_2.field_jkl LIKE "%yellow%" THEN 1 ELSE 0 END )
)DESC; 
```

[我在http://sqlfiddle.com/#!2/cbbda/28](http://sqlfiddle.com/#!2/cbbda/28)发布了一个示例数据集（只有几条记录）

sqlfiddle 的示例运行速度很快，因为只有几条记录，但我尝试在我自己的服务器上复制记录，查询运行速度很快，只有几条记录，在添加一百万条记录后速度非常慢。

有什么方法可以快速得到我的结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:14:01.427

伙计们...在您的帮助下，我们有一个解决方案...请参阅... [http://sqlfiddle.com/#!2/fcfbd/5](http://sqlfiddle.com/#!2/fcfbd/5) 但我仍然有一个问题...

我更改了表格以添加索引...

```
ALTER TABLE  `users` ADD FULLTEXT ( `username` );
ALTER TABLE  `table_1` ADD FULLTEXT ( `field_abc`,`field_def` );
ALTER TABLE  `table_2` ADD FULLTEXT ( `field_ghi`,`field_jkl` ); 
```

然后我接受了@Barmar 的建议并将代码更改为...

```
SELECT users.username,
    table_1.field_abc, table_1.field_def,
    table_2.field_ghi, table_2.field_jkl
FROM users
LEFT JOIN table_1 ON table_1.username = users.username
LEFT JOIN table_2 ON table_2.username = users.username
WHERE
    MATCH(table_1.field_abc,table_1.field_def,table_2.field_ghi,table_2.field_jkl)
    AGAINST ("spork yellow" IN BOOLEAN MODE)
GROUP BY users.username
ORDER BY
(
    ( CASE WHEN MATCH(table_1.field_abc) AGAINST ("spork" IN BOOLEAN MODE) THEN 1 ELSE 0 END ) +
    ( CASE WHEN MATCH(table_1.field_abc) AGAINST ("yellow" IN BOOLEAN MODE) THEN 1 ELSE 0 END ) +

    ( CASE WHEN MATCH(table_1.field_def) AGAINST ("spork" IN BOOLEAN MODE) THEN 1 ELSE 0 END ) +
    ( CASE WHEN MATCH(table_1.field_def) AGAINST ("yellow" IN BOOLEAN MODE) THEN 1 ELSE 0 END ) +

    ( CASE WHEN MATCH(table_2.field_ghi) AGAINST ("spork" IN BOOLEAN MODE) THEN 1 ELSE 0 END ) +
    ( CASE WHEN MATCH(table_2.field_ghi) AGAINST ("yellow" IN BOOLEAN MODE) THEN 1 ELSE 0 END ) +

    ( CASE WHEN MATCH(table_2.field_ghi) AGAINST ("spork" IN BOOLEAN MODE) THEN 1 ELSE 0 END ) +
    ( CASE WHEN MATCH(table_2.field_ghi) AGAINST ("yellow" IN BOOLEAN MODE) THEN 1 ELSE 0 END )
)DESC; 
```

在我的真实数据库中有超过 1,000,000 条记录，我在 6.5027 秒内得到了结果。这比……好很多，花了很长时间才吐出来！

我现在唯一的问题是......为什么它只适用于 IN BOOLEAN MODE 而不是[http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html#function_match](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html#function_match)中提到的其他 2 个选项或[http://dev.mysql.com/doc/refman/5.5/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.5/en/fulltext-search.html)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T22:52:03.237

由于我们正在加入，`username`因此该列上的索引可能会加快速度。

另外，你能使用内连接而不是左连接吗？这也可以在很大程度上加快查询速度。

最后，如果需要，可以在内存中进行排序，而不是要求数据库进行排序（即在返回结果集后对结果集进行排序）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T18:31:53.047

我正在使用我的第一个解决方案，但发现它给出了一些我无法弄清楚的误报，所以我想出了这个......

```
(SELECT username, MATCH(field_abc,field_def) AGAINST ("spork yellow" IN BOOLEAN MODE) AS score FROM table_1 HAVING score>0)
UNION ALL
(SELECT username, MATCH(field_ghi,field_jkl) AGAINST ("spork yellow" IN BOOLEAN MODE) AS score FROM table_2 HAVING score >0) 
```

由于每条记录都是单独返回的，我不能使用`GROUP BY`我在查询完成后添加了这个 PHP 代码：

```
while($row = mysql_fetch_array($result) )
{
    if( in_array($row['username'],$usernames) )
    {
        $usernames_count[$row['username']] += $row['score'];
    }
    else
    {
        array_push($usernames,$row['username']);
        $usernames_count[$row['username']]=$row['score'];
    }
}
arsort($usernames_count); // Sort the results high->low

foreach($usernames_count as $key=>$value)
{
    echo "Username: ".$key." had a score of ".$value." in the search results<br/>";
} 
```

与我所做的其他尝试相比，它现在看起来如此简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T22:47:59.117

我不这么认为——用这张桌子原样，我怀疑你会把所有这些都`LIKE`放在上面。那些必须运行荒谬的次数。

如果这些值是固定的，那么您可以将新列添加到名为`abc_like_yellow`and`abc_like_spork`等的表中，并填充这些值一次，然后您可以轻松地查询该列。

但是，如果您尝试动态执行此操作，则可能会不走运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-02T05:54:55.857

当您的服务器必须扫描数百万个条目时，它的功能可能不足以快速处理查询。

一般来说，为了提高您网站的速度，您可以尝试[CloudFlare](http://cloudflare.com)

如果您特别想加快 SQL 速度，[Google Cloud SQL](https://developers.google.com/cloud-sql/)可能会有所帮助。Google 强大的服务器旨在扫描数十亿条 SQL 条目，例如在执行 Google 搜索时。

只要没有返回错误，上述两项服务将有助于大大加快您的查询时间。

我希望我能帮上忙！

```
VCNinc 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-10T11:43:11.677

如果您有权访问 SQL Server，请在 SQL Server 中突出显示您的完整查询，然后单击 + L

这将显示查询执行计划。根据这些结果优化查询；

例如，如果您看到表扫描，那么索引可能会有所帮助。编写不使用术语 distinct 的查询。如果顺序不重要，请不要对结果进行排序。

在您的示例中，最后一组复杂的订购方式非常昂贵。

而是遵循以下步骤： 将核心信息拉入一个临时表，在填充核心数据后有 9 个额外的列（类型 int，初始设置为 0），根据 0 或 1 标准更新 8 列中的每一列 更新最后一列作为其他 8 列的总和，从 table 中检索信息，只有一个基于第 9 列的“order-by”。

根据我的经验，与内部订购相比，这种方法只需要 20% 的时间。

# css - 如何在中间浮动图像？

> ID：15960150
> 
> 赞同：1
> 
> 时间：2013-04-11T22:42:39.073
> 
> 标签：css

我正在建立一个新的商业博客，但在将主徽标置于标题中间时遇到了麻烦。

我知道你可以使用：

```
#logo { float: left; }
#logo { float: right; } 
```

但据我所见，漂浮在中间并不是一个可用的选项。

有什么建议么？

我遇到问题的网站：http: [//bit.ly/Yrcm5z](http://bit.ly/Yrcm5z)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:44:14.990

在你的上使用以下 CSS`#logo img`

```
#logo img {
    margin: 0 auto;
} 
```

你`img`被显示为一个`block`元素，因此，给出一个边距值`auto`告诉浏览器计算父元素内的可用边距，并在块的两侧平等地共享它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T22:44:46.610

利用

```
<div>
    <a id="logo"></a>
</div> 
```

和 CSS

```
#logo {display: inline-block; }

div {text-align: center; } 
```

抱歉，为了记录，此方法有效，因为`display: inline-block;`元素表现为文本，因此您可以将其对齐在容器内。

来自阿根廷的问候！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T22:48:52.560

**在新的段落**或**div**中使用 text-align 。

```
<p><img src="http://legendarymarketer.com/wp-content/themes/wp-theme-simplog/assets/img/logo.png" height="30" width="235" alt="" style="
    text-align: center;
"></p> 
```

更改 CSS：[ **style.css**文件的**第 104 行**]

 **```
#logo img {
display: inline;
} 
```**

# javascript - 如何使用 Yelp API v2 查找您所在位置附近的地点

> ID：15960153
> 
> 赞同：0
> 
> 时间：2013-04-11T22:43:01.603
> 
> 标签：javascript, html, api, yelp

我知道如何在 Yelp API v2 上使用大多数实用程序，但我似乎不知道如何找到我附近的商店。有一段代码显示：

var 条款 = '超市'; var near = '圣诞老人+克拉拉';

这有助于我找到库比蒂诺附近的超市。但是我应该在“附近”找到我附近的超市（无论我在哪里）？我试过“当前+位置”，但这不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:50:46.693

您必须先编写一个脚本（或找到一个）来确定您（或用户）的位置，然后再使用它来提供“近”呼叫。
顺便说一句，我认为没有“接近”的电话。我认为电话是“位置”

# php - 使用特定条件验证 MYSQL 行（在多个实例上）

> ID：15960157
> 
> 赞同：0
> 
> 时间：2013-04-11T22:43:28.463
> 
> 标签：php, mysql, sql

在我的整个服务器中，我有几个查询调用`leads`使用某些条件来验证它们的表。

```
SELECT * FROM leads WHERE user_id=3 //This line changes depending on the data needed
AND reversed!=1 AND amount>0 AND ip IS NOT NULL //These 'validation' statements are always there.

SELECT * FROM leads WHERE user_id=10 AND special_case=1
AND reversed!=1 AND amount>0 AND ip IS NOT NULL

SELECT * FROM leads WHERE user_id=15  AND special_case2=1 
AND reversed!=1 AND amount>0 AND ip IS NOT NULL 
```

这些查询的第二行表示几乎每个查询中都存在的验证子句。问题是，当我需要添加另一个验证语句（如`AND another_column=1`）时，我必须在我的代码中单独编辑每个查询。这需要一段时间，并不理想！

制作可应用于所有查询的验证功能的最佳方法是什么？我在想我可以做一个`$_GLOBAL`like `$validation_sql='AND reversed!=1 AND amount>0 AND ip IS NOT NULL'`，但我也认为，也许创建一个自定义 MYSQL 函数会更好（如果这甚至可以做到的话）。

你们有什么感想？最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T22:46:43.057

做一个视图，`valid_leads`：

```
CREATE VIEW valid_leads AS
SELECT *
FROM leads
WHERE reversed!=1 AND amount>0 AND ip IS NOT NULL 
```

然后你可以这样做：

```
SELECT *
FROM valid_leads
WHERE user_id = 15 AND special_case2 = 1 
```

# ruby-on-rails - 块中出现意外的语法错误

> ID：15960158
> 
> 赞同：0
> 
> 时间：2013-04-11T22:43:34.573
> 
> 标签：ruby-on-rails, ruby-on-rails-3, syntax-error, block, send

我基本上是将一个对象信息复制到另一个对象。一般来说，代码或方法可能不是经过深思熟虑的，但这不是我现在的问题。

这是错误：

```
syntax error, unexpected '=', expecting keyword_end
    original.send("#{attribute}") = edited.send("#{attribute}")
                                   ^ 
```

我正在做的是遍历 object2 的所有属性，然后将每个属性“复制”到对象 1。我可以为每个模型指定这个，但我想要一个单独的 implement_changes 方法，它基本上适用于每个类. 复制模型 belongs_to :edited 和 :original 通过多态关联。

```
class Copy < ActiveRecord::Base
    def implement_changes
      original = self.original_type.constantize.find(original_id)
      edited = self.edited_type.constantize.find(edited_id)
      accessible_attributes = original_type.constantize.accessible_attributes.to_a.select{|a| a != "slug"}
      accessible_attributes.shift
      accessible_attributes.each do |attribute|
          original.send("#{attribute}") = edited.send("#{attribute}")
      end
      original.save!
    end 
```

为什么那个块不起作用？我不明白。这里发送的用法正确吗？它不会让我做 original.attribute。

任何帮助表示赞赏！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T22:47:41.477

setter 的方法名称包括等号，并将新值作为参数。你可以试试：

`original.send("#{attribute}=", edited.send(attribute))`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T02:38:09.513

您是否有理由不使用[ActiveResource::Base#dup](http://api.rubyonrails.org/classes/ActiveResource/Base.html#method-i-dup "ActiveResource::Base#dup")？

# sql - 根据列值的变化增加 Row_Number

> ID：15960164
> 
> 赞同：0
> 
> 时间：2013-04-11T22:44:06.540
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个 sql 视图，其中包含来自 3 个链接实体（标题 > 版本 > SKU）的数据。此视图中的数据用于搜索 3 个实体中的任何字段。例如，如果您指定条件 title.regionid = '14'，则视图返回 4,000 个唯一行（每个 SKU 1 个），它们属于 765 个唯一版本，这些版本属于 456 个唯一标题。

我需要的是使用 Row_Number() 启用基于标题的分页。所以

```
SELECT * FROM myview WHERE title.regionid = '14' AND Row BETWEEN 0 AND 35 
```

问题是我的 Row 列需要按 Title 计算行数，而不是按 SKU，所以从 4000 行的结果集中，如果第一个标题包含 12 个版本和 65 个 SKU，则所有 65 行的行号应该是 1，因为它们属于同一个标题。

我不能使用 GroupBy，因为我的视图包含 40 多个列，所有这些列都可以通过 WHERE 子句进行搜索。

这是查询：

```
SELECT *
FROM (
SELECT row_number() OVER (ORDER BY a.TitleSort ASC) AS Row, a.* 
FROM (SELECT * FROM v_AdvancedSearch 
WHERE 
    istitledeleted = 0
    --AND ISBN = '1-4157-5842-5'
    --AND etc
    ) AS a
) d
WHERE 
Row BETWEEN 0 AND 35 
```

在第一页有 35 行只属于 4 个标题，但是 Row 列按行计数，所以它停在那里，而如果它按标题计数，我会得到第 1 页的 387 行......我怎样才能完成分页这个情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:41:35.457

```
WITH Titles AS
(
SELECT *
FROM (
SELECT row_number() OVER (ORDER BY a.TitleSort ASC) AS Row, a.* 
    FROM (SELECT DISTINCT TitleSORT, TitleId FROM v_AdvancedSearch 
    WHERE 
        istitledeleted = 0 
        --AND ISBN = '1-4157-5842-5'
        --AND PictureFormat = 'Widescreen'
        --AND UPC = '0-9736-14381-6-0'
        --AND Edition = 'Standard'
        ) AS a
) d
WHERE 
Row BETWEEN 0 AND 35
)
SELECT * FROM v_AdvancedSearch V
INNER JOIN Titles ON Titles.TitleId = V.TitleId 
WHERE istitledeleted = 0 
--CONDITIONS NEED TO BE REPEATED HERE
--AND ISBN = '1-4157-5842-5'
ORDER BY V.TitleSort ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-01T18:10:30.180

这种形式最适合我

```
WITH 
[cte] AS ( 
    SELECT 
        DENSE_RANK ( ) OVER ( ORDER BY [v].[TitleSort], [v].[TitleId] ) AS [ordinal], 
        [v].[TitleSort], 
        [v].[TitleId] 
        --, 
        --field list, 
        --etc 
    FROM [v_AdvancedSearch] AS [v] 
    WHERE 
        [v].[istitledeleted] = 0 
        --AND 
        --additional conditions AND 
        --etc 
) 
SELECT 
    [v].[ordinal], 
    [v].[TitleSort], 
    [v].[TitleId] 
    --, 
    --field list, 
    --etc 
FROM [cte] AS [v] 
WHERE 
    [v].[ordinal] >= 0 AND 
    [v].[ordinal] <= 35 
ORDER BY [v].[ordinal]; 
```

*   不需要 DISTINCT 或 GROUP BY
*   无需重复标准条件
*   只需要有那个明确的字段列表

[https://docs.microsoft.com/en-us/sql/t-sql/functions/dense-rank-transact-sql](https://docs.microsoft.com/en-us/sql/t-sql/functions/dense-rank-transact-sql)

[https://www.google.com/search?q=%22sql+server%22+%22select+star%22](https://www.google.com/search?q=%22sql+server%22+%22select+star%22)

# php - 如何在使用 xmlhttp/ajax 删除后刷新文件/图片库而不重新加载整个页面？

> ID：15960166
> 
> 赞同：0
> 
> 时间：2013-04-11T22:44:13.683
> 
> 标签：php, ajax, image, gallery, xmlhttprequest

很抱歉这个冗长的问题。我会尽力解释。

我创建了一个图像列表，当您将鼠标悬停在一个元素上（使用 css）时可见，每个图像也是一个单选按钮，可以选择并用作表单的一部分。所有图像基本上都是某个目录中的所有图像，您也可以上传到。

我设法在每个图像旁边添加了一个“删除”按钮，这将触发一个调用 php 脚本的函数来删除该特定图像而无需重新加载页面。使用 xmlhttp.which 工作正常。

但是图像列表不会自行刷新。如图所示，当我将鼠标悬停在元素上时，我刚刚删除的图像仍然可见，直到我刷新页面然后它刷新列表。

显然我不想刷新页面，这就是使用 ajax 的全部意义所在。所以有什么想法我能做什么？代码如下：

```
<script>
function deleteImage(){
 var answer =  confirm('Are you SURE you wish to delete this?')
 if (answer) {
   var image = document.getElementById('filepath').value;
   var xmlhttp;
     if (window.XMLHttpRequest)
     {
     xmlhttp=new XMLHttpRequest();
     }
     else
     {
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
     }
     xmlhttp.onreadystatechange=function()
    {
    if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
     document.getElementById("uploadmsg").innerHTML=xmlhttp.responseText;
     }
    }
  xmlhttp.open("POST","delete.php",true);
  xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
  xmlhttp.send("image="+image);
}
} 
```

然后是 php/html 来调用它。

```
<?php
  $dir = "../images/";      
  $dh = opendir( $dir );
  while( $filename = readdir( $dh ) ) {
       $filepath = $dir.$filename;
       $gallery[] = $filepath;
       $list[] = $filename;           
  }
  sort( $gallery );
    sort( $list);
  $num_pics = count($gallery);
?>

<div id='chooseimg'  ><input type="text" value="Choose Image"><span><ul>        
<?php

$a = 2;
while($num_pics > $a)
{
    ?> 
    <li>
<input type='radio' name='image' value='<?php echo $list[$a]; ?>'>
<?php echo $list[$a]; ?> 
<div id='imglist'><img src='<?php echo$gallery[$a]; ?>' /></div>
<button type='button' onclick="deleteImage()">Delete</button> 
<input type="hidden" id="filepath" value="<?php print $gallery[$a]; ?>"/> </li>
    <?php
    $a ++;  }   
        ?>
</ul></span></div>
<div id="uploadmsg"> </div> 
```

该文件`delete.php`包含：

```
<?php 
$image = $_POST['image'];
if (!empty($image)){
unlink($image);
echo "<b>Image deleted<b>";
}
?> 
```

并且使悬停在事物上的css基本上是一个设置为`span`的div内部，但是当它移动到时， 我认为没有人需要更多信息，但如果你需要，请告诉我。`#chooseimage``left:99999px;``hover``chooseimg``left:0px;`

作为旁注，我不确定这是否是实际的 ajax？也许有人可以为我澄清。

如果您能提供帮助，我将不胜感激。我已经用谷歌搜索了几个小时，但找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T09:43:49.943

ok so for anyone who has the same problem i figured it out.

the code to display all the images along with their radio and delete buttons are stored in a separate `php` file:

```
<?php
  $dir = "../images/";      
  $dh = opendir( $dir );
  while( $filename = readdir( $dh ) ) {

       $filepath = $dir.$filename;
       $gallery[] = $filepath;
       $list[] = $filename;           
  }
  sort( $gallery );
  sort( $list);
  $num_pics = count($gallery);
?>

<div id="choose"><div id="echo">
<div style="background-color: #F04D8E; color: #ffffff;">Choose Image</div></div> 
<span><ul>  

<?php
$a = 3;
while($num_pics > $a)
{
$image = $gallery[$a];
    ?> 

    <li>

//the radio button triggers an event which then showsthe image selected

<input id="radio" type='radio' name='image' onchange="thumb('<?php echo $image; ?>')" 
value='<?php echo $list[$a]; ?>'><?php echo $list[$a]; ?> 
<div id='gallery'>

// the delete button sends the images 'id' in its parameter
<button style="float:right;" type='button' 
onclick="deleteImage('<?php echo $image; ?>', '<?php echo $list[$a]; ?>'    )">    
Delete</button>
    <img src='<?php echo $image; ?>' /></div>
      </li>
    <?php

    $a ++;
 }                      
?>
</ul></span></div><br> 
```

in the main page i call this script into a `div` straight away and also refresh it after the `deleteImage` function has been requested:

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>

window.onload = function(){
$('#result').load('show.php');
}

function deleteImage(id, name){
var answer =  confirm('Are you SURE you wish to delete ' + name + ' ?') 
if (answer) {
$.post("delete.php", { image: id })
.done(function(){
$('#uploadmsg').html("<b>" + name + " deleted </b>");
$('#result').ready(function(){
$('#result').load('show.php');

});
});
}}

function thumb(image){

$('#echo').html("<img src='"+image+"'>");

} 
```

then all i need in the page is a `div` with `id` as `result`

oh and the `delete.php` page is still:

```
<?php 
$image = $_POST['image'];
if (!empty($image)){
unlink($image);
}
?> 
```

someone said this is dangerous? but i can't see why.

and questions feel free to ask

thanx

# java - Java 保存配置文件，多操作系统

> ID：15960168
> 
> 赞同：0
> 
> 时间：2013-04-11T22:44:41.423
> 
> 标签：java, io

所以我的程序将需要创建一个包含登录信息的文件。之后，每次程序都会正常运行，除非登录文件被某些方式删除。我想知道一种可以以多操作系统方式执行此操作的快速方法。我不想将文件保存到磁盘上的特定部分，因为我必须为每个操作系统都这样做。我还可以做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:47:29.717

您可以使用`System.getProperty("home.dir")`非特定于操作系统的方式找出用户的主目录

[在http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html](http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)上阅读更多相关信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T22:48:28.097

根据您要存储的内容，您可能根本不需要文件。看

[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/prefs/Preferences.html#userRoot%28%29](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/prefs/Preferences.html#userRoot%28%29)

或者

[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/prefs/Preferences.html#systemRoot%28%29](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/prefs/Preferences.html#systemRoot%28%29)

# c++ - OpenGL旋转问题

> ID：15960172
> 
> 赞同：1
> 
> 时间：2013-04-11T22:44:56.930
> 
> 标签：c++, opengl, camera

在我的 OpenGL 应用程序中，我有一个使用键盘（移动）和鼠标（环顾四周）控制的相机。

到目前为止，一切都运行良好，我注意到如果我将相机在 Y 轴上移动到 300 以上，则在移动鼠标时它会开始混乱。例如，如果我转到 Y = 310，然后向上移动鼠标，当它开始向上看时，它也开始向左转动。

我不确定这是什么原因。任何人都可以帮忙吗？

这是为 gluLookAt() 计算向前和向上位置的代码

双cosR、cosP、cosY；//双重sinR，sinP，sinY的sin / cos的温度值；//输入的roll/pitch/yaw

```
if(Yaw > 359) Yaw = 0;
if(Pitch > 359) Pitch = 0;
if(Yaw < 0) Yaw = 359;
if(Pitch < 0) Pitch = 359;

cosY = cosf(Yaw*3.1415/180);
cosP = cosf(Pitch*3.1415/180);
cosR = cosf(Roll*3.1415/180);
sinY = sinf(Yaw*3.1415/180);
sinP = sinf(Pitch*3.1415/180);
sinR = sinf(Roll*3.1415/180);

//forward position
forwardPos.x = sinY * cosP*360;
forwardPos.y = sinP * 360;
forwardPos.z = cosP * -cosY*360;

//up position
upPos.x = -cosY * sinR - sinY * sinP * cosR;
upPos.y = cosP * cosR;
upPos.z = -sinY * sinR - sinP * cosR * -cosY; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-11T22:47:32.840

万向锁。 [这里解释一下。](http://en.wikipedia.org/wiki/Gimbal_lock)

四元数是这个问题的标准解决方案。

简而言之，当您在上述计算中两个轴角相互接近时，会导致可用运动的损失。你需要第四个自由度来防止这种情况——这就是四元数数学所允许的。

# android - 将位图写入外部存储（sdcard）

> ID：15960173
> 
> 赞同：4
> 
> 时间：2013-04-11T22:44:59.463
> 
> 标签：android, bitmap, android-sdcard

我正在尝试将我在某些活动中拥有的位图保存到为此目的创建的目录中的外部存储。将图像保存到 sdcard（外部存储器，而不是外部 sd）的方法在不同的类（和不同的包）中，所以我认为我需要上下文，但我找不到任何地方提供上下文（试过`openFileOutput`但它`String fileName`不能包含路径分隔符）。当我运行我的代码时，我在 log cat 中收到此错误：

```
04-11 22:13:14.899: E/error(13833): /mnt/sdcard/myTomatoes/covers/378194.PNG: open                  failed: ENOENT (No such file or directory)
04-11 22:13:14.899: W/System.err(13833): java.io.FileNotFoundException: /mnt/sdcard/myTomatoes/covers/378194.PNG: open failed: ENOENT (No such file or directory)
04-11 22:13:14.899: W/System.err(13833):    at libcore.io.IoBridge.open(IoBridge.java:416)
04-11 22:13:14.899: W/System.err(13833):    at java.io.FileOutputStream.<init>(FileOutputStream.java:88)
04-11 22:13:14.899: W/System.err(13833):    at java.io.FileOutputStream.<init>(FileOutputStream.java:73)
04-11 22:13:14.899: W/System.err(13833):    at     BL.ImageMethods.SaveImageToMemory(ImageMethods.java:60)
04-11 22:13:14.899: W/System.err(13833):    at com.example.mytomatoes.MovieDetailsActivity$4.onClick(MovieDetailsActivity.java:337)
04-11 22:13:14.899: W/System.err(13833):    at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:166)
04-11 22:13:14.899: W/System.err(13833):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-11 22:13:14.899: W/System.err(13833):    at android.os.Looper.loop(Looper.java:137)
04-11 22:13:14.899: W/System.err(13833):    at android.app.ActivityThread.main(ActivityThread.java:5039)
04-11 22:13:14.899: W/System.err(13833):    at java.lang.reflect.Method.invokeNative(Native Method)
04-11 22:13:14.899: W/System.err(13833):    at java.lang.reflect.Method.invoke(Method.java:511)
04-11 22:13:14.899: W/System.err(13833):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-11 22:13:14.899: W/System.err(13833):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-11 22:13:14.899: W/System.err(13833):    at dalvik.system.NativeStart.main(Native Method)
04-11 22:13:14.899: W/System.err(13833): Caused by: libcore.io.ErrnoException: open failed: ENOENT (No such file or directory)
04-11 22:13:14.899: W/System.err(13833):    at libcore.io.Posix.open(Native Method)
04-11 22:13:14.899: W/System.err(13833):    at libcore.io.BlockGuardOs.open(BlockGuardOs.java:110)
04-11 22:13:14.899: W/System.err(13833):    at libcore.io.IoBridge.open(IoBridge.java:400) 
```

这些是我的权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" /> 
```

这是我保存文件的方法：

```
public static void SaveImageToMemory(Context context, Bitmap img, int rottenId) {
        Log.i("SAVE IMAGE", "start save");
        File sd = Environment.getExternalStorageDirectory();
        File location = new File(sd.getAbsolutePath()+ "/myTomatoes/covers");
        location.mkdir();
        File dest = new File(location, rottenId + ".PNG");

        try {
            Log.i("SAVE IMAGE", "trying to save: " + dest.getPath());
            FileOutputStream fos = new FileOutputStream(dest);

            img.compress(Bitmap.CompressFormat.PNG, 100, fos);
            fos.flush();
            fos.close();
        } catch (IOException e) {
            Log.e("error", e.getMessage());
            e.printStackTrace();
        }
    } 
```

创建`File`对象的所有混乱行都是我尝试的结果......原始代码是：

```
 File location = new File(Environment.getExternalStorageDirectory() + "/myTomatoes/covers");
    File dest = new File(location, rottenId + ".PNG"); 
```

我还尝试先创建`ByteArrayOutputStream`位图并将其压缩到它，然后再做`fos.write(mByteArrayOpStream.toByteArray())`，但它没有用。

顺便说一句，我正在使用模拟器，但我也在几个“Galaxy S”上检查了这个，并且发生了同样的错误......（当我尝试在手机或 DDMS 中浏览文件时，我可以看到它没有甚至创建文件夹...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:29:15.693

从您的问题描述看来，您甚至无法创建该文件夹。所以请确保以下几点

*   SD 卡状态（已安装且可写）有利于创建文件夹。使用这个[链接](http://developer.android.com/guide/topics/data/data-storage.html#filesExternal)
*   目录已创建

    if (!file.isExist()) boolean created=file.mkdir();

稍后您可以通过测试布尔值来检查您的文件夹是否已创建。如果未创建您的文件夹，则没有理由进一步使用您的代码。

*   父文件夹存在。

或者，您可以使用`mkdirs()`它将创建所有必要的父目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T04:52:53.673

试试这个代码：

```
File newD = new File(Environment.getExternalStorageDirectory()
                            + File.separator +"myTomatoes"+ File.separator + "covers");
   if(!newD.exists()){
        newD.mkdirs();
    }

ByteArrayOutputStream bytes = new ByteArrayOutputStream();
    _bitmapScaled.compress(Bitmap.CompressFormat.JPEG, 40, bytes);

    //you can create a new file name "test.jpg" in sdcard folder.
    File f = new File( newD + File.separator + "test.jpg")
    f.createNewFile();
    //write the bytes in file
    FileOutputStream fo = new FileOutputStream(f);
    fo.write(bytes.toByteArray());

    // remember close de FileOutput
    fo.close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T09:10:46.997

看看这个：

```
if (android.os.Environment.getExternalStorageState().equals(
        android.os.Environment.MEDIA_MOUNTED))
{
    File sdCard = Environment.getExternalStorageDirectory();
    File dir = new File(sdCard.getAbsolutePath() + "/Pictures");
    dir.mkdirs();
    File file = new File(dir, filename);
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    bitmap.compress(Bitmap.CompressFormat.PNG, 100, baos);
    FileOutputStream f = null;
    f = new FileOutputStream(file);

    if (f != null) {
        f.write(baos.toByteArray());
        f.flush();
        f.close();
    }
}

} 
```

或点击此链接：[http ://android-er.blogspot.in/2010/07/save-file-to-sd-card.html](http://android-er.blogspot.in/2010/07/save-file-to-sd-card.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-22T11:34:34.867

希望这有助于将图像从 android 应用程序存储在缓存目录中，并在另一个活动中显示该图像。

**Oneactivity.java**

**将图像存储在缓存目录中**

```
 File file = new File(getCacheDir(), "thursday.png");
                        try {
                            OutputStream output;
                            output = new FileOutputStream(file);
                            bm.compress(Bitmap.CompressFormat.PNG, 100, output);
                            output.flush();
                            output.close();
                        }
                        catch (Exception e) {
                            e.printStackTrace();
                        } 
```

**从缓存目录中获取图像。**

```
BitMap bmp5;

     try {

                            File myFile = new File(getCacheDir()+"/thursday.png");
                            bmp5 = BitmapFactory.decodeFile(myFile.toString());
                            System.out.println("am setting wallpaper");
                            myWallpaperManager.setBitmap(bmp5);

                        } catch (IOException e) {

                            e.printStackTrace();
                        } 
```

# haskell - 在 Aeson 中解码的“无”结果

> ID：15960176
> 
> 赞同：2
> 
> 时间：2013-04-11T22:45:24.753
> 
> 标签：haskell, aeson

我正在使用这段代码：

```
{-# LANGUAGE OverloadedStrings #-}

import Data.Aeson
import Data.Maybe
import Data.ByteString.Lazy
import Control.Applicative
import Debug.Trace
import Control.Monad
import qualified Data.Aeson.Types as T

main = do
  res <- liftA show (liftA decodeOriginal (Data.ByteString.Lazy.readFile "./a.json"))
  Prelude.putStrLn res

interpretResult :: Maybe String -> String
interpretResult Nothing = "Error."
interpretResult x = fromJust x

data TotalLine1 = TotalLine1 {
  timestamp :: Integer,
  value :: Integer
} deriving (Eq, Show)

data Original = Original {
  totals :: [TotalLine1]
} deriving (Eq, Show)

instance FromJSON Original where
  parseJSON (Object v) = traceStack "Original" (Original <$> (parseJSON =<< (v .: "visitors.total")))
  parseJSON _ = mzero

instance FromJSON TotalLine1 where
  parseJSON (Object v) = TotalLine1 <$>
                         v .: "timestamp" <*>
                         v .: "value"
decodeOriginal :: ByteString -> Maybe Original
decodeOriginal b = traceStack "decoding" (do
  a <- decode b :: Maybe Original
  return a) 
```

尝试像这样解析 JSON：

```
{
visitors.total: [
{
timestamp: 1365548400,
value: 1
},
{
timestamp: 1365548700,
value: 2
},
{
timestamp: 1365549000,
value: 5
},
]
} 
```

但是 main 每次都返回 Nothing 。我做错了什么？似乎连 parseJSON 都没有被称为 Original。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T23:09:15.633

您的 JSON 文件无效。

一方面，必须引用字段的名称，

```
"timestamp" 
```

等等，另一方面，`TotalLine1`s 列表中有一个尾随逗号，这会导致对`ByteString`a的解码`Value`失败。引用字段名称并删除结尾的逗号，它可以工作。

# debugging - 如何在 gdb 打印上 grep

> ID：15960180
> 
> 赞同：13
> 
> 时间：2013-04-11T22:45:50.007
> 
> 标签：debugging, unix, gdb

有没有办法在 gdb 中对 print 命令的输出进行 grep？就我而言，我正在使用 gdb 调试核心转储，而我正在调试的对象包含大量元素。我发现很难寻找匹配的属性，即：

```
(gdb) print *this | grep <attribute> 
```

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-12T05:43:46.163

> (gdb) 打印 *this | grep

实现这一点的“标准”方法是使用`Meta-X gdb`in `emacs`。

替代：

```
(gdb) set logging on
(gdb) print *this
(gdb) set logging off
(gdb) shell grep attribute gdb.txt 
```

cnicutar 提到的补丁确实看起来很有吸引力。我猜它（或它的等价物）从未提交的原因是大多数 GDB 维护者使用`emacs`，所以一开始就没有这个问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2020-11-27T18:04:02.733

你可以使用`pipe`命令

```
>>> pipe maintenance info sections | grep .text
 [15]     0x5555555551c0->0x5555555554d5 at 0x000011c0: .text ...

>>> pipe maintenance info sections | grep .text | wc 
      1      10     100 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-12-11T20:49:49.443

最简单的方法是利用 gdb python。单线：

```
**gdb λ** py ["attribute" in line and print(line) for line in gdb.execute("p *this", to_string=True).splitlines()]
```

假设您已启用命令历史记录，您可以只键入一次，然后按`Ctrl`+`R` `b.exec`将其从历史记录中拉出。接下来只需根据您`attribute`的`*this`要求进行更改。

* * *

你也可以像这样简单：

```
**gdb λ** grep_cmd "p *this" attribute
```

为此，只需将以下内容添加到您的`.gdbinit`文件中：

```
py
class GrepCmd (gdb.Command):
    """Execute command, but only show lines matching the pattern
    Usage: grep_cmd <cmd> <pattern> """

    def __init__ (_):
        super ().__init__ ("grep_cmd", gdb.COMMAND_STATUS)

    def invoke (_, args_raw, __):
        args = gdb.string_to_argv(args_raw)
        if len(args) != 2:
            print("Wrong parameters number. Usage: grep_cmd <cmd> <pattern>")
        else:
            for line in gdb.execute(args[0], to_string=True).splitlines():
                if args[1] in line:
                    print(line)

GrepCmd() # required to get it registered
end 
```

# java - 在 Java 中用文本填充树

> ID：15960183
> 
> 赞同：0
> 
> 时间：2013-04-11T22:46:00.323
> 
> 标签：java, recursion, tree, binary-search-tree

我需要在一个名为 Dictionary 的类中创建一个方法，该方法在 java 中递归地逐行读取 txt 文件的内容，然后将每一行作为节点添加到树中。这是文件内容的示例：

```
ourselves
out
over
own
same
shan't
she 
all
am
a
about
above
after
again
against
aren't 
should
shouldn't
so
some
such
than
that
that's
the
their 
```

它持续了四倍多的长度。我已经设置了二叉树，它包括以下方法：

```
getKey() //returns the value of the current node
setKey() //sets the value of the current node
getLeftChild() //gets the value of the left child of the node inside the parentheses 
getRightChild() //does the same as the above, but with the right child
setLeftChild(BinaryTreeNode node) //sets the left child
setRightChild(BinaryTreeNode node) //sets the right child 
```

最后，树应该将 txt 文件中的单独文本行作为树中的单独节点。我在递归方面遇到了很多麻烦，我不确定如何让程序正确读取文件的内容。我真的很感激任何建议或帮助。

如果它有帮助，这是我迄今为止完成的已完成 1/4 的方法：

```
public Dictionary(String filePath) throws IOException{ // the file path in my system for
        //dictionary.txt
        //I read from this file and build my tree. 
        BufferedReader br = new 
                BufferedReader(new FileReader("Dictionary.txt"));

        String word; 

        if ((word = br.readLine()) == null)
            System.out.println("Your tree is empty.");
        while ((word = br.readLine()) != null) {
            //now I need to tell it to add word as a node. 

        }
        br.close();

    } 
```

- -编辑 - -

对于如何设置树没有其他要求。Dictionary.txt 文件中的每一行文本都必须是一个单独的节点。也就是说，“我们自己”和“外面”需要是单独的节点，等等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:15:59.973

假设你有一个`Node`可以像这样构造的（你现在不需要 getter 和 setter）：

```
 // the standard constructor to assign dummy values
 public Node(){
     this.key="";
     this.leftNode=null;
     this.rightNode=null;
 }

 // the constructor with parameters for both children
 public Node(String key, Node left, Node right){ 
      ...  // assign the paramteres
 } 
```

首先，我将设置一个实际*递归*读取文件的方法：

```
 public Node readFile(BufferedReader reader){
     String word = reader.readLine();         
     if(word!=null){
         return new Node(word, readFile(reader), readFile(reader));            
     }else{
         return new Node() ;  // empty node or null?
     }      
 } 
```

**编辑**

然后你可以像这样初始化你的字典：

```
 private Node dictionaryTree;   // this is the tree within your dictionary class

   public Dictionary(String filePath) throws IOException{
         BufferedReader br = new BufferedReader(new FileReader("Dictionary.txt"));
         this.dictionaryTree = readFile(br);
         br.close();
   } 
```

我不能 100% 确定这是否会按照您的意愿工作，但它遵循递归原则。之后，`root`你就完成了树，你可以通过`getLeftChild()`和`getRightChild()`方法来遍历树。

# php - 不使用正则表达式的英国 (GB) 邮政编码验证

> ID：15960184
> 
> 赞同：13
> 
> 时间：2013-04-11T22:46:04.983
> 
> 标签：php, postal-code

我已经尝试了几个正则表达式，但仍然有一些有效的邮政编码有时会被拒绝。

搜索互联网、维基百科和 SO，我只能找到正则表达式验证解决方案。

**是否有不使用正则表达式的验证方法？**在任何语言中，我想它都会很容易移植。

我想最简单的方法是与邮政编码数据库进行比较，但这需要从可靠的来源定期维护和更新。

编辑：为了帮助未来的访问者并防止您发布更多正则表达式，这是我测试过的正则表达式（截至 2013 年 4 月 24 日），适用于 Code Point 中的所有邮政编码（[请参阅@Mikkel Løkke 的回答](https://stackoverflow.com/a/16145771/584490)）：

```
//PHP PCRE (it was on Wikipedia, it isn't there anymore; I might have modified it, don't remember).
$strPostalCode=preg_replace("/[\s]/", "", $strPostalCode);
$bValid=preg_match("/^(GIR 0AA)|(((A[BL]|B[ABDHLNRSTX]?|C[ABFHMORTVW]|D[ADEGHLNTY]|E[HNX]?|F[KY]|G[LUY]?|H[ADGPRSUX]|I[GMPV]|JE|K[ATWY]|L[ADELNSU]?|M[EKL]?|N[EGNPRW]?|O[LX]|P[AEHLOR]|R[GHM]|S[AEGKLMNOPRSTY]?|T[ADFNQRSW]|UB|W[ADFNRSV]|YO|ZE)[1-9]?[0-9]|((E|N|NW|SE|SW|W)1|EC[1-4]|WC[12])[A-HJKMNPR-Y]|(SW|W)([2-9]|[1-9][0-9])|EC[1-9][0-9])[0-9][ABD-HJLNP-UW-Z]{2})$/i", $strPostalCode); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-30T15:42:21.973

我正在根据[wiki page](http://en.wikipedia.org/wiki/Postcodes_in_the_United_Kingdom)写这个答案。

检查[验证部分](http://en.wikipedia.org/wiki/Postcodes_in_the_United_Kingdom#Validation)时，似乎有 6 种格式（A = 字母和 9 = 数字）：

```
AA9A 9AA                       AA9A9AA                   AA9A9AA
A9A 9AA     Removing space     A9A9AA       order it     AA999AA
A9 9AA    ------------------>  A99AA     ------------->  AA99AA
A99 9AA                        A999AA                    A9A9AA
AA9 9AA                        AA99AA                    A999AA
AA99 9AA                       AA999AA                   A99AA 
```

正如我们所看到的，长度可能从 5 到 7 不等，如果我们愿意，我们必须考虑一些[特殊情况。](http://en.wikipedia.org/wiki/Postcodes_in_the_United_Kingdom#Special_cases)

所以我们正在编写的函数必须执行以下操作：

1.  删除空格并转换为大写（或小写）。
2.  检查输入是否为异常，如果是则应返回*有效*
3.  检查输入的长度是否为 4 **<** length **<** 8。
4.  检查它是否是有效的邮政编码。

最后一部分很棘手，但我们将按长度将其分成 3 个部分以进行概述：

1.  长度 = 7：*AA9A9AA*和*AA999AA*
2.  长度 = 6：*AA99AA*、*A9A9AA*和*A999AA*
3.  长度 = 5：*A99AA*

为此，我们将使用`switch()`. 从现在开始，只需逐个字符地检查它是否是正确位置的字母或数字。

那么让我们来看看我们的PHP实现：

```
function check_uk_postcode($string){
    // Start config
    $valid_return_value = 'valid';
    $invalid_return_value = 'invalid';
    $exceptions = array('BS981TL', 'BX11LT', 'BX21LB', 'BX32BB', 'BX55AT', 'CF101BH', 'CF991NA', 'DE993GG', 'DH981BT', 'DH991NS', 'E161XL', 'E202AQ', 'E202BB', 'E202ST', 'E203BS', 'E203EL', 'E203ET', 'E203HB', 'E203HY', 'E981SN', 'E981ST', 'E981TT', 'EC2N2DB', 'EC4Y0HQ', 'EH991SP', 'G581SB', 'GIR0AA', 'IV212LR', 'L304GB', 'LS981FD', 'N19GU', 'N811ER', 'NG801EH', 'NG801LH', 'NG801RH', 'NG801TH', 'SE18UJ', 'SN381NW', 'SW1A0AA', 'SW1A0PW', 'SW1A1AA', 'SW1A2AA', 'SW1P3EU', 'SW1W0DT', 'TW89GS', 'W1A1AA', 'W1D4FA', 'W1N4DJ');
    // Add Overseas territories ?
    array_push($exceptions, 'AI-2640', 'ASCN1ZZ', 'STHL1ZZ', 'TDCU1ZZ', 'BBND1ZZ', 'BIQQ1ZZ', 'FIQQ1ZZ', 'GX111AA', 'PCRN1ZZ', 'SIQQ1ZZ', 'TKCA1ZZ');
    // End config

    $string = strtoupper(preg_replace('/\s/', '', $string)); // Remove the spaces and convert to uppercase.
    $exceptions = array_flip($exceptions);
    if(isset($exceptions[$string])){return $valid_return_value;} // Check for valid exception
    $length = strlen($string);
    if($length < 5 || $length > 7){return $invalid_return_value;} // Check for invalid length
    $letters = array_flip(range('A', 'Z')); // An array of letters as keys
    $numbers = array_flip(range(0, 9)); // An array of numbers as keys

    switch($length){
        case 7:
            if(!isset($letters[$string[0]], $letters[$string[1]], $numbers[$string[2]], $numbers[$string[4]], $letters[$string[5]], $letters[$string[6]])){break;}
            if(isset($letters[$string[3]]) || isset($numbers[$string[3]])){
                return $valid_return_value;
            }
        break;
        case 6:
            if(!isset($letters[$string[0]], $numbers[$string[3]], $letters[$string[4]], $letters[$string[5]])){break;}
            if(isset($letters[$string[1]], $numbers[$string[2]]) || isset($numbers[$string[1]], $letters[$string[2]]) || isset($numbers[$string[1]], $numbers[$string[2]])){
                return $valid_return_value;
            }
        break;
        case 5:
            if(isset($letters[$string[0]], $numbers[$string[1]], $numbers[$string[2]], $letters[$string[3]], $letters[$string[4]])){
                return $valid_return_value;
            }
        break;
    }

    return $invalid_return_value;
} 
```

**请注意**，我没有添加[British Forces Post Office](http://en.wikipedia.org/wiki/Postcodes_in_the_United_Kingdom#British_Forces_Post_Office_.28BFPO.29)和[非地理代码](http://en.wikipedia.org/wiki/Postcodes_in_the_United_Kingdom#Non-geographic_codes)。

用法：

```
echo check_uk_postcode('AE3A 6AR').'<br>'; // valid
echo check_uk_postcode('Z9 9BA').'<br>'; // valid
echo check_uk_postcode('AE3A6AR').'<br>'; // valid
echo check_uk_postcode('EE34      6FR').'<br>'; // valid
echo check_uk_postcode('A23A 7AR').'<br>'; // invalid
echo check_uk_postcode('A23A   7AR').'<br>'; // invalid
echo check_uk_postcode('WA3334E').'<br>'; // invalid
echo check_uk_postcode('A2 AAR').'<br>'; // invalid 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-22T15:17:35.943

由英国政府提供。

```
 (GIR 0AA)|((([A-Z-[QVX]][0-9][0-9]?)|(([A-Z-[QVX]][A-Z-[IJZ]][0-9][0-9]?)|(([A-Z-[QVX]][0-9][A-HJKSTUW])|([A-Z-[QVX]][A-Z-[IJZ]][0-9][ABEHMNPRVWXY])))) [0-9][A-Z-[CIKMOV]]{2}) 
```

我使用从[HERE](http://www.doogal.co.uk/london_postcodes.php#)获得的邮政编码构建了仅基于伦敦邮政编码的应用程序。但老实说，即使只有伦敦邮政编码，您也需要比必要更多的存储空间。当然，这个想法是微不足道的。

存储邮政编码，获取用户输入或其他内容，然后查看是否匹配。但是您使解决方案复杂化的程度远远超出您的想象。我必须使用实际的邮政编码来实现我想要的，但为了简单的验证目的，就像“维护”一个正则表达式一样难，存储数万或数十万（如果不是更多）并实时或多或少地验证是一项艰巨得多的任务。

如果迷你分布式服务听起来比正则表达式更有效，那就去吧，但我敢肯定它不是。除非您需要针对英国邮政编码或类似的东西对您自己的数据进行地理空间查询，否则我怀疑数据库存储是一个可行的解决方案。只是我的2美分。

**更新**

根据[该](http://www.doogal.co.uk/UKPostcodes.php)指数，英国有 1,758,417 个邮政编码。我可以告诉你，我正在使用一些 Mongo 集群（Amazon EC2 高内存实例）来提供可靠的仅限伦敦的服务（仅索引伦敦邮政编码），这是一件相当昂贵的事情，即使使用基本存储也是如此。

诚然，该应用程序正在执行中等复杂度的地理空间查询，但仅存储需求就非常昂贵且要求很高。

**最重要的是，只需坚持正则表达式并在两分钟内完成。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T23:21:13.387

我现在正在查看维基百科中的英国邮政编码链接。

[http://en.wikipedia.org/wiki/Postcodes_in_the_United_Kingdom](http://en.wikipedia.org/wiki/Postcodes_in_the_United_Kingdom)

验证部分列出了六种由字母和数字组合而成的格式。然后在下面的注释中有更多信息。我会尝试的第一件事是使用 GoldParserBuilder 之类的工具的 BNF 类型语法。您可以以更易读的格式描述基本格式，并自动生成高效的解析器和词法分析器。过去，我已经成功地使用这些工具来避免编写庞大、丑陋的正则表达式。

从那时起，该程序就有了一个格式正确的已知类型的邮政编码。此时，特定的数字或字母可能会违反某些内容。每种类型的邮政编码都可以有一个编程功能来查找该特定类型的违规行为。最终产品将包含一个自动生成的解析器，该解析器将未经验证但结构化/已识别的邮政编码传递给专用的验证功能。然后，您可以从那里重构或优化。

（您也可以使用语法本身来强制或禁止某些文字和组合。任何对您来说更具可读性或可理解性的东西。不同的人倾向于这些事物的不同目的。）

这是一个突出 GOLD Parsing System 优点的页面。您可以使用任何您喜欢的：我只是推广这个 b/c，它的工作很好，并且多年来一直在稳步改进。 [http://www.goldparser.org/about/why-use-gold.htm](http://www.goldparser.org/about/why-use-gold.htm)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-22T11:13:22.017

我认为 RegEX，虽然冗长可能是最好的解决方案，如果你想做的只是验证某些东西是否可以是有效的英国邮政编码。

如果您需要绝对数据，请考虑使用 Ordnance Survey OpenData 倡议“ [Code-Point® Open”](https://www.ordnancesurvey.co.uk/opendatadownload/products.html)数据集，它是英国（所以我猜不是北爱尔兰）大量数据点的 CSV，其中一个是邮政编码。请注意，该文件为 20MB，因此您可能需要将其转换为更易于管理的格式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-22T15:39:36.067

> 正则表达式难以调试，难以从一种正则表达式风格移植到另一种风格（无声的“错误”），并且难以更新。

大多数正则表达式都是如此，但你为什么不把它分成多个部分呢？对于六种不同的一般规则，您可以轻松地将其分成六个部分，如果考虑到所有特殊情况，甚至可能更多。

使用简单的正则表达式创建一个注释良好的 20 行方法很容易调试（每行一个简单的正则表达式）并且也易于更新。移植问题是相同的，但另一方面，您不需要使用一些花哨的语法库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-22T16:02:28.590

第三方服务是一种选择吗？

[http://www.postcodeanywhere.co.uk/address-validation/](http://www.postcodeanywhere.co.uk/address-validation/)

地名数据库：

[http://www.geonames.org/postal-codes/](http://www.geonames.org/postal-codes/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-29T11:50:46.553

为“为什么关心”评论+1。我不得不在各种项目中使用“官方”正则表达式，虽然我从未尝试过将其分解，但它可以工作并且可以完成工作。我已经将它与 Java 和 PHP 代码一起使用，而无需在正则表达式格式之间进行转换。

您是否有理由必须对其进行调试或分解？

顺便说一句，以前在维基百科上可以找到正则表达式规则，但它似乎已经消失了。

编辑：至于空格/无空格的辩论，无论有没有空格，邮政编码都应该是有效的。由于邮政编码的最后一部分（空格之后）总是三位数，因此可以手动插入空格，然后您可以通过正则表达式规则运行它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-22T15:29:13.817

获取有效邮政编码列表并检查输入的邮政编码是否在其中。

# javascript - 如何检测 SVG 区域任意位置的颜色

> ID：15960186
> 
> 赞同：2
> 
> 时间：2013-04-11T22:46:29.040
> 
> 标签：javascript, svg

在 SVG 区域（不是画布）内，我需要使用 javascript 确定特定坐标（x，y）位置的颜色。总的来说是这样的：

```
getColor (mySvgArea, x, y); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T07:47:48.120

通常在 html 中，如果链接被访问过，它们会以不同的颜色绘制。这样的事情当然在 SVG 中也是可能的，而且很久以前就意识到，如果你能弄清楚颜色是什么，那就是隐私泄露，并且付出了很多努力来[修复它](https://blog.mozilla.org/security/2010/03/31/plugging-the-css-history-leak/)。

如果您被允许以一般坐标读取颜色，它将重新打开隐私泄漏，因此您将永远无法在图像之外执行此操作。

图像方式是将您的 SVG 放入`<image>`标签中，然后将其加载到画布中。浏览器可以通过以下两种方式防止隐私泄露像链接着色（Firefox）

已经有一个 stackoverflow 的答案，其中[显示了将 SVG 复制到 canvas](https://stackoverflow.com/questions/5495952/draw-svg-on-html5-canvas-with-support-for-font-element)的示例。如果您使用 Firefox，则可以读取颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-13T12:53:30.143

我知道这是老话题，但根据您的情况还有另一种方法。使用 SVG，您可以获取一个元素`Document.elementFromPoint`，也可以通过隐藏顶部元素并`elementFromPoint`再次调用来获取所有底层元素。可以从那里获得颜色以及其他属性。它本身并没有真正为您提供颜色，但它比画布更快，并且在选定的情况下工作得很好。

# iphone - 在 UITextView 上使用 NSLayoutConstraint 会将 contentSize 重置为 {0,0}

> ID：15960197
> 
> 赞同：0
> 
> 时间：2013-04-11T22:47:33.977
> 
> 标签：iphone, ios, cocoa-touch, autolayout

我有一个`UITextView`我正在使用它`NSLayoutConstraint`来躲避键盘。这是约束：

```
self.textViewBottomConstraint = [NSLayoutConstraint constraintWithItem:textView
                                                    attribute:NSLayoutAttributeBottom
                                                    relatedBy:NSLayoutRelationEqual
                                                       toItem:self.view
                                                    attribute:NSLayoutAttributeBottom
                                                   multiplier:1.0
                                                     constant:0.0];
[self.view addConstraint:self.textViewBottomConstraint]; 
```

当键盘显示/隐藏时，我通过将约束常量设置为键盘高度来为约束设置动画。但是，出于某种原因，这样做会将 contentSize 重置为 {0,0}，从而中断滚动。我添加了一个技巧来`handleKeyboardDidHide:`将 contentSize 重置为重置之前的值，但这有一些丑陋的副作用，例如滚动位置被重置，并且视图在开始输入之前不会滚动到光标位置。

```
- (void) handleKeyboardDidShow:(NSNotification *)notification
{
     CGFloat height = [KeyboardObserver sharedInstance].keyboardFrame.size.height;
     self.textView.constant = -height;
     [self.view layoutIfNeeded];
}

- (void) handleKeyboardDidHide:(NSNotification *)notification
{
   // for some reason, setting the bottom constraint resets the contentSize to {0,0}...
   // so let's save it before and reset it after.
   // HACK
   CGSize size = self.textView.contentSize;
   self.textView.constant = 0.0;
   [self.view layoutIfNeeded];
   self.textView.contentSize = size;
} 
```

有谁知道如何完全避免这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:51:43.767

我不知道您的代码有什么问题，如果您愿意，我们可以详细处理。但作为初步建议，如果可能的话，不要调整 UITextView 的大小：只需更改其内容并滚动插图，如下所示：

```
- (void) keyboardShow: (NSNotification*) n {
    NSDictionary* d = [n userInfo];
    CGRect r = [d[UIKeyboardFrameEndUserInfoKey] CGRectValue];
    self.tv.contentInset = UIEdgeInsetsMake(0,0,r.size.height,0);
    self.tv.scrollIndicatorInsets = UIEdgeInsetsMake(0,0,r.size.height,0);
} 
```

即便如此，我发现您必须等到键盘隐藏动画完成才能重置这些值：

```
- (void) keyboardHide: (NSNotification*) n {
    NSDictionary* d = [n userInfo];
    NSNumber* curve = d[UIKeyboardAnimationCurveUserInfoKey];
    NSNumber* duration = d[UIKeyboardAnimationDurationUserInfoKey];
    [UIView animateWithDuration:duration.floatValue delay:0
                        options:curve.integerValue << 16
                     animations:
     ^{
         [self.tv setContentOffset:CGPointZero];
     } completion:^(BOOL finished) {
         self.tv.contentInset = UIEdgeInsetsZero;
         self.tv.scrollIndicatorInsets = UIEdgeInsetsZero;
     }];
} 
```

（可能这个技巧也会以某种方式帮助您的代码。）

# asp.net-mvc-3 - 如何在 EDIT GET 到 EDIT POST 期间从视图中保存数据？

> ID：15960206
> 
> 赞同：0
> 
> 时间：2013-04-11T22:48:15.890
> 
> 标签：asp.net-mvc-3, razor

我有一个困境，我希望有人能帮助我。在加载和更新页面之前的 Edit Get 阶段，我存储检查的复选框，如下所示：

```
foreach (var course in courses.Select((x, i) => new { Data = x, Index = i }))
{
    @:  <td>
        <br /><br /><br />
        <input type="checkbox" id="checkbox" name="selectedCourses" value="@course.Data.CourseID"
            @(Html.Raw(course.Data.Assigned ? "checked=\"checked\"" : "")) />
        </td>
    bool theNewString = course.Data.Assigned;
    String a = theNewString.ToString();
    assignedCourses.Add(a);
} 
```

在视图的顶部，我定义了列表来存储这样的数据，以便可以在 BeginForm 中发送：

```
@{ List<String> assignedCourses = new List<String>(); } 
```

然后我尝试将列表发送到 Edit POST，如下所示：

```
@using (Html.BeginForm(new { assigned = assignedCourses })) 
```

在我的控制器签名中看起来像这样：

```
[HttpPost]
public ActionResult Edit(int id, List<String> assigned) 
```

该列表在 get 阶段结束时加载，但列表中的数据不会通过 Edit POST。我的问题是如何让我在编辑获取阶段结束时创建的列表保持不变，以便我可以在我的帖子中使用它？

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:21:53.070

我会尽量让这件事变得简单。所以你的`Course`模型是这样的......

```
public class Course
{
    public int Id { get; set; }
    public string Name { get; set; }
    public bool Assigned { get; set; }
} 
```

...并且您想在屏幕上显示一些保存的值以进行编辑。因此，从控制器开始，我已经对一些数据进行了虚拟化并将其中一个`Assigned`布尔值设置为，`true`以便在页面加载时对其进行检查。

```
public Controller Courses
{
    public ActionResult Edit(int id)
    {
        var courses = new Course[] {
            new Course() { Id = 1, Name = "maths", Assigned = true },
            new Course() { Id = 2, Name = "english", Assigned = false },
            new Course() { Id = 3, Name = "science", Assigned = false }
        };

        return View(courses);
    } 
```

现在，您的页面应该期望这些课程的集合，因此在页面顶部定义`View`期望的类型...

**cshtml**

```
@model IEnumerable<ExampleProject.Domain.Course> 
```

...然后您可以在您的复选框中枚举`View`并创建您的复选框。

```
@using (Html.BeginForm("Edit", "Courses", FormMethod.Post))
{
    @foreach(var item in Model)
    {
        <label for="@item.Id">@item.Name</label>
        <input type="checkbox" name="courses" id="@item.Id" value="@item.Id" checked="@item.Assigned" />
    }

    <button type="submit">Save changes</button>
} 
```

这将呈现以下 html：

```
<label for="1">maths</label>
<input type="checkbox" name="courses" id="1" value="1" checked="checked">

<label for="2">english</label>
<input type="checkbox" name="courses" id="2" value="2">

<label for="3">science</label>
<input type="checkbox" name="courses" id="3" value="3"> 
```

现在您可以检查您喜欢的内容并提交您的表格。以真正的 http 方式，您的控制器操作将接收在以下位置检查的值`View`：

```
[HttpPost]
public ActionResult Courses(int id, int[] courses)
{
    // courses will contain the values of the checkboxes that were checked
    return RedirectToAction("Index"); // etc
} 
```

希望这会有所帮助。您可以更聪明一点，并使用 Html 帮助程序进行一些更复杂的绑定（例如`Html.CheckBox`, `Html.CheckBoxFor`），但这应该能让您继续前进，并且清楚地看到发生了什么。

# javascript - Javascript脚本停止工作，我不知道为什么？

> ID：15960217
> 
> 赞同：-8
> 
> 时间：2013-04-11T22:48:57.420
> 
> 标签：javascript, html, css, fade, jsfiddle

谁能告诉我为什么这可能不起作用？oO 就在几分钟前，我不知道我做了什么可能会破坏它。基本上，当我点击其中一个菜单项时，它会淡入该菜单指定的文本。我把它放在一个 jfiddle 中，所以你们可以帮助我，在此先感谢。

jsfiddle.net/qA8Ur/ 我无法添加 jfiddle 链接对不起各位

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:55:12.887

只是为了帮助您... 将 jQuery 添加到左侧已使用的 Frameworks & Extensions 中，并修复多个语法错误。我强烈建议您使用正确的代码格式化和调试工具（例如 Chrome 开发工具或 Firebug）。

**演示：** jsfiddle.net/qA8Ur/1/

# c - Ruby C 扩展 rb_str_new2 似乎返回 false

> ID：15960220
> 
> 赞同：3
> 
> 时间：2013-04-11T22:49:06.427
> 
> 标签：c, ruby, ruby-c-extension

由于作品版权，我无法发布我的实际代码，所以我将尝试用简单的示例代码来展示我的问题。

我有一个 C 扩展，其简化版本如下所示：

```
#include <ruby.h>
#include <termios.h>
#include <stdio.h>
#include <fcntl.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>

VALUE test(VALUE self, VALUE string);
void Init_module_name() {
     module_name = rb_define_module("Modulename");
     c_modulename = rb_define_class_under(modulename, "Class", rb_cObject);
     rb_define_method(c_modulename, "test", test, 1);

     e_ModuleNameError = rb_define_class_under(modulename, "Error", rb_eStandardError);
}

VALUE test(VALUE self, VALUE string) {
    char *c_string = StringValueCStr(string);
    int fd = open(c_string, O_RDWR | O_NOCTTY | O_NONBLOCK);

    if (fd == -1) {
       rb_raise(e_ModuleNameError, "Failed to open file");
    }
    if (!isatty(fd)) {
       rb_raise(e_ModuleNameError, "File is not a tty");
    }

    struct termios config;
    int termios_ret = init_termios(config, fd)
    if (termios_ret != OK) { // OK defined by enum in modulename's header
        close(fd);
        rb_raise(e_ModuleNameError, "Termios init failed.");
    }

    int success = write(fd, "I'm a string", str_length);
    if (success < str_length) {
        close(fd);
        rb_raise(e_ModuleNameError, "Failed to write to file.");
    }

    close(fd);
    return rb_str_new2("Success");
} 
```

然后，需要这个的 ruby​​ 代码如下所示：

```
require 'modulename'

class ModuleName
  attr_acessor :file

  def initialize(file)
    @file = file
    @object = Modulename::Class.new
  end

  def test
    @object.test @file
  end
end 
```

然后在我的生产项目中调用它，例如：

```
require "modulename_ruby_file"

x = ModuleName "/dev/pts/1"
x.test 
```

这是有趣的事情。当我在生产环境中运行此代码时，上面 x.test 的返回值为 false（字面意义上的值为 false，而不是字符串）。此外，对文件的写入永远不会发生。但是，如果我在一些简化的测试代码中执行此操作，它会像预期的那样返回字符串“Success”，并且确实完成了写入。

有谁知道会导致此函数不执行写入并返回 false 的任何情况？我已经尝试在它周围进行救援，以防它抛出一个 rb_raises，但它似乎没有。

我和我团队的其他 3 名成员整个下午都在看这个问题，但没有找到答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T15:46:58.410

终于弄清楚了，这与@NeilSlater 在问题评论中所说的非常相似。

我们向 C 代码添加了大量调试，并将其写入日志文件，并发现 C 函数（在我的示例中为测试）实际上从未被调用过。因此，我们查看了 .so 的符号表和 gcc 正在生成的汇编代码，两者看起来都很好。最后我们只是说，“让我们更改函数的名称，看看是否有帮助”并且......它起作用了。实际函数名为 logout，将其更改为 project_name_logout 有效，因此显然存在某种命名空间冲突。所以，就像@NeilSlater 所说的那样，它与环境有关！

因此，对于在 google 上找到此内容的任何其他人：通过在所有函数前面加上您的项目名称，将“命名空间”添加到您的 C 代码中，您应该能够避免这个问题。[其中一位成员后来提到，无论如何，这在 C 语言中是一个很好的做法。]

注意：我们没有花时间追踪与注销发生冲突的原因。

# php - PHP 邮件（）错误 553

> ID：15960225
> 
> 赞同：1
> 
> 时间：2013-04-11T22:49:15.550
> 
> 标签：php, email, smtp

我正在使用邮件（）；函数并且它正在工作，但有时它会返回错误 553。我听说这可能是因为：

1.  您正在尝试向此服务器无法识别的域发送电子邮件
2.  您正在尝试通过此服务器中继电子邮件，但尚未通过身份验证

（来源：[http](http://www.error-553.net/) ://www.error-553.net/ ）

由于它有时可以工作，我猜该域无法识别，但我该如何克服这个错误？

编辑：我认为问题不来自任何这个来源，首先正如我所说的，它有时可以工作，有时也可以与我试图发送电子邮件的域一起工作。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:55:00.783

在发送邮件之前，请检查域：

1.  存在
2.  具有有效的 MX 记录
3.  未列入黑名单

此外，您的本地邮件服务器允许您将电子邮件中继到外部。

第 1 点和第 2 点以简单的方式解决：`getmxrr("domain.name.com",$arrayOfHosts)`如果找到 MX 记录，将返回 true。

第 3 点取决于您要使用哪个黑名单。我个人喜欢 SBL，它只需要反向 DNS 查找。

# html - 这可能与 HTML 吗？

> ID：15960226
> 
> 赞同：1
> 
> 时间：2013-04-11T22:49:49.420
> 
> 标签：html, css

我需要在网站中实现菜单卡。我的客户希望它看起来与餐厅卡上的一模一样。

是否可以使用 HTML 将边框线直接放在文本下方，如下图（“Hauptgerichte”）？如果是，我怎么能意识到这一点？

![在此处输入图像描述](https://i.stack.imgur.com/z11Gh.png)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T22:55:40.597

如果您希望边框接触文本，您可以将 调整`line-height`为较小的值：

```
p
{
    border-bottom: 1px solid black;
    line-height: 10px;
} 
```

[http://jsfiddle.net/kz43g/](http://jsfiddle.net/kz43g/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T22:53:15.057

这是 1 个变体 - 这是一个[小提琴](http://jsfiddle.net/trajce/8ejMr/)。
html:

```
 <div>
        <p> some text </p>
    </div> 
```

CSS：

```
*{
padding:0;
    margin:0;
}
div{
    border-bottom:1px solid #000;
}
p{
    margin-bottom:-5px;
} 
```

我只是将负底部边距放入文本容器（在本例中为 p 标签）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T22:58:31.193

纯 CSS 解决方案可以使用伪元素`after`，请参阅[小提琴](http://jsfiddle.net/e2w9g/2/)。与文本的距离由`bottom:3px`：

```
.underline {
    position:relative;
}
.underline::after {
    content: '';
    width: 100%;
    position:absolute;
    bottom: 3px;
    left:0;
    border-bottom: 1px solid black;    
} 
```

编辑：行高解决方案看起来更好:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-11T22:59:56.363

这在 HTML / CSS 中是可能的：[示例](http://jsfiddle.net/8VuPA/)

HTML：

```
<h3 class="yourClass">Text place</h3> 
```

CSS：

```
.yourClass{
   width:300px;
   border-bottom: 1px solid #000;
   text-indent:50px;
   line-height:80%;
} 
```

在此示例中，我正在更改行高以将文本移动到行下，然后使用 text-indent 将其移动到正确的位置。它应该会给你想要的结果。有几种方法可以做到这一点，但这需要更少的 HTML。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-11T23:05:09.737

这是一个展示如何做到这一点的[JS Bin 。](http://jsbin.com/orequt/5/)我在段落底部添加了一个边框，并在左侧添加了一点填充。然后我更改了段落的行高，使其正好位于边框上。

您可以尝试使用：

```
text-decoration: underline; 
```

我选择使用边框属性来轻松定制。

来自 JS Bin 的 CSS：

```
p {
  border-bottom:1px solid #333;
  line-height: 50%;
  padding: 0 0 0 40px;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-11T22:54:39.607

将标题放在 H 标签中，然后使用 CSS 定位 H 标签并应用边框底部。

HTML

```
<div id="content">
<h1>title</h1>
</div> 
```

CSS

```
#content h1{
Border-bottom:1px solid #999;
Width: 150px;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-11T22:54:59.297

将文本放在 div 中。然后，使 div 设置宽度。然后，为 div 添加边框。

```
<div id="title">
 <h2> Hauptgerichte </h2>
</div>

/*CSS*/
#title{
  width: 50px;
  border-bottom: 2px solid #000000;
} 
```

# c++ - 如何解决 C++ 中的命名空间冲突？

> ID：15960227
> 
> 赞同：3
> 
> 时间：2013-04-11T22:49:51.733
> 
> 标签：c++, namespaces

我使用带有 Visual Studio 2010 的 Win7 系统。我使用的是 OpenCV，并且有一个嵌入式 flann 命名空间。

但我也使用了一个原始的 FLANN 包[http://people.cs.ubc.ca/~mariusm/index.php/FLANN/FLANN](http://people.cs.ubc.ca/~mariusm/index.php/FLANN/FLANN)。

我按照用户手册使用

```
> "C:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
> cd flann-x.y.z-src
> mkdir build
> cd build
> cmake -G "NMake Makefiles" .. 
```

我在我的 VS2010 项目中添加了 FLANN 文件夹：c++ 文件夹->包含目录

因此，当我编写 C++ 代码并想使用“flann”命名空间时，会出现命名空间冲突错误。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:04:18.077

可能最可靠的解决方案是重命名命名空间之一。你说你已经编译了`flann`——在这种情况下，你可以重命名它的命名空间，然后重新编译。

也许您可以通过少量修改重用[Boost.BCP 工具](http://www.boost.org/doc/libs/1_53_0/tools/bcp/doc/html/index.html#bcp.syntax)- 它具有命名空间重命名功能。

或者，如果您在`flann`- 中看到一些常见模式，那么您可以尝试通过简单的全局搜索和替换来重命名它。重命名后，请`diff`确保只重命名需要的部分，并`grep`确保重命名所有需要的位置。

* * *

另一种选择是在编译期间定义预处理器宏，`flann`它会重命名命名空间，例如：

```
#define flann flann_vanilla 
```

并将其添加到编译器选项中，例如：

```
-Dflann=flann_vanilla 
```

在这种情况下，您应该将每个`flann`标头包含在：

```
#define flann flann_vanilla
#include "flann.hpp"
#undef flann 
```

* * *

此外，如果那些重复的命名空间来自同一个库（可能是不同的版本） - 请注意可能的预处理器宏冲突，尤其是包含保护的冲突。包含守卫冲突的最简单解决方案是使用特定于实现的`#pragma once`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:08:17.033

将现有的 'flann' 命名空间包装在一个新的命名空间中，然后使用完全限定的语法来引用它。

# ruby-on-rails - 基础导航栏阻止表单字段

> ID：15960231
> 
> 赞同：0
> 
> 时间：2013-04-11T22:50:21.147
> 
> 标签：ruby-on-rails, html, css, zurb-foundation

所以这似乎是一个愚蠢的问题。我可能做错了，所以如果有人可以提出另一种方法，我很乐意尝试一下。

我有一个用 Zurb Foundation 4 构建的固定导航栏

```
<div class="fixed">
<nav class= "top-bar">
<ul class="title-area">
  <li>
    <h2><%= link_to image_tag("officialLogo-100x197.png", :size => "100x197", :class =>  "logo" ) + "AppDomum",  root_path, :class => "textlogo" %></h2>
  </li>

  <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
</ul>

<section class="top-bar-section">

<ul class="right">

  #links ..... 

</ul> 
```

为标题显示的图像大于导航栏。我实际上喜欢它挂在导航栏上，并且我有一个媒体查询设置以在较小的屏幕上将其删除，因此它不会挂在内容上。

问题：`<div class= "fixed">`将导航栏和图像一直包裹在整个页面中。因为图像挂在导航栏下方，所以它后面的任何内容都不可点击。页面的整个顶部是不可点击的。对于表单，我无法选择要编辑的文本框。因为导航栏是固定的，所以它会根据您滚动的距离影响整个页面。有没有办法让它们固定但没有固定标签占据所有空白空间？还有另一种方法可以做到这一点吗？

![我搞砸了固定的 div](https://i.stack.imgur.com/FleBs.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T22:54:14.133

尝试添加`position: relative;`到您的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T06:42:06.837

经过大量研究，我确实解决了这个问题。这是解决问题的代码，或者至少是我为了得到我想要的东西而拼凑起来的代码。这是导航栏。

```
<div class="fixed">
<nav class= "top-bar">
<ul class="title-area">
  <li>
    <h2><%= link_to "AppDomum",  root_path, :class => "textlogo" %></h2>
  </li>

  <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
</ul>

<section class="top-bar-section">

<ul class="right">

  #links ..... 

</ul>
</section
</nav>
</div>
<div class= "fixed-icon">
<%=link_to image_tag("officialLogo-100x197.png", :size => "100x197", :class => "logo" ), root_path %>
</div> 
```

我将图标和文本分开，但将它们都保留为主页的链接。给人一种错觉，即它们都是标题的一部分。有一个媒体查询可以隐藏图像并删除标题上的边距。这是CSS。我基本上搜索了该站点的 html 和 css 文件，直到找到“固定”类并偷走了 css 修改，然后将宽度更改为很小，这样它就不会掩盖其他所有内容。

```
@media only screen and (min-width: 768px) {

.title-area {
  margin-left: 6em;
}

}

.fixed-icon {
@extend .hide-for-small;
    width: 10%;
  left: 0;
  position: fixed;
  top: 0;
  z-index: 99;
}

.title-area {
  padding: 5px 5px;
  font-weight: bold;
  letter-spacing: -1px;

} 
```

# sockets - TCP/UDP 解复用的工作原理是什么？

> ID：15960238
> 
> 赞同：3
> 
> 时间：2013-04-11T22:51:31.137
> 
> 标签：sockets, networking, tcp, network-programming, udp

我有以下声明。

“在 TCP 中，接收方主机使用所有源 IP、源端口、目标 IP 和目标端口将数据报引导到适当的套接字。而在 UDP 中，接收方仅检查目标端口号来引导数据报。”

上述说法是否属实？

如果是，是否意味着在 TCP 中，一个进程中的多个套接字可以使用同一端口，而在 UDP 中，一个进程中的一个端口只能使用一个套接字？不同进程中的套接字呢？多个进程可以在 TCP/UDP 中使用同一个端口吗？（编程语言：C/C++/Java）

如果不是，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T22:57:44.697

> “在 TCP 中，接收方主机使用所有源 IP、源端口、目标 IP 和目标端口将数据报引导到适当的套接字。而在 UDP 中，接收方仅检查目标端口号来引导数据报。”
> 
> 上述说法是否属实？

是的。

> 如果是，是否意味着在 TCP 中同一个端口可以在一个进程中用于多个套接字，

是的，在某些情况下。

> 而在UDP中，一个进程中的一个端口只能使用一个套接字？

不，见下文。

> 不同进程中的套接字呢？多个进程可以在 TCP/UDP 中使用同一个端口吗？（编程语言：C/C++/Java）

在某些情况下，是的。UDP 端口必须被所有想要共享它的进程指定为可重用。TCP 端口只能被绑定到不同接口的套接字重用：没有共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:02:53.793

这意味着，在 TCP 中，一个唯一的通信“通道”可以描述为四元组：`(src-ip, src-port, dst-ip, dst-port)`.

在 UDP 中，所有发往某个端口的数据包都被传递到侦听该端口的唯一 UDP 套接字，而不管该数据包的源地址和端口。我喜欢把它想象成一个漏斗。

# jquery - jQuery 显示/隐藏渲染重复内容

> ID：15960240
> 
> 赞同：0
> 
> 时间：2013-04-11T22:51:35.660
> 
> 标签：jquery, performance

我对 jquery 很陌生，所以请耐心等待。我正在对多个 div 进行简单的显示/隐藏。基本上，您将鼠标悬停在具有类的图像上，并显示来自具有相应类的 div 的内容。我遇到的事情是，如果您将鼠标悬停在一个图像上，然后将鼠标悬停在另一个图像上，那么在某些情况下，我会看到上一个悬停的内容，而当前悬停的内容基本上是重复的内容。这实际上只有当您快速悬停在图像上但仍然很烦人时。任何想法为什么会发生这种情况？

```
jQuery('document').ready(function(){

  jQuery('.company').not(':first').hide();

  jQuery('#company_container img').on('hover', function(){

var contenttoShow = jQuery(this).attr('data-title');

    contenttoShow2 = jQuery(contenttoShow);
    jQuery('.company').hide();
    contenttoShow2.fadeIn(500);
  });

});

<div class="company" id="company_1">
<p>some content goes here</p>
</div>

<div class="company" id="company_2">
<p>some content goes here</p>
</div>

<div class="company" id="company_3">
<p>some content goes here</p>
</div>

<div id="company_container">
 <a title="" href="#"><img data-title="#company_1" src="test.jpg" /></a>
 <a title="" href="#"><img data-title="#company_2" src="test2.jpg" /></a>
 <a title="" href="#"><img data-title="#company_3" src="test3.jpg" /></a>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:03:39.020

`.hover()`改为使用

```
jQuery('#company_container img').hover(function () { 
```

[**演示**](http://jsfiddle.net/mohammadAdil/VereA/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:04:06.897

让我知道这是否适合您...

```
jQuery('.company').not(':first').hide();

jQuery('#company_container img').mouseover(function() {
   jQuery('.company').hide();
   var contenttoShow = jQuery(this).attr('data-title');
   jQuery(contenttoShow).fadeIn(500);      

}); 
```

[http://jsfiddle.net/ba6SZ/](http://jsfiddle.net/ba6SZ/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T09:10:12.410

jQuery .on() 是`Attach an event handler function for one or more events to the selected elements.`

[http://api.jquery.com/on/](http://api.jquery.com/on/)

通常用于将事件附加到动态创建的元素。

注意多事件绑定。在这个小演示中，每次单击该框时，都会以 2^x 的次数增加它。（x 是点击次数）。这让我前一阵子挠了挠头。

[http://jsfiddle.net/chrisloughnane/acNwn/](http://jsfiddle.net/chrisloughnane/acNwn/)

# sql - 能否根据 SQL Server 许可查询最大数据库大小？

> ID：15960241
> 
> 赞同：3
> 
> 时间：2013-04-11T22:51:38.987
> 
> 标签：sql, sql-server

根据您的 SQL Server 数据库的许可和配置，您可能有非常不同的大小限制。例如：

*   SQL Server 2012 Express 有 10GB 的限制
*   SQL Server 2008 R2 Express 有 10GB 的限制
*   SQL Server 2008 Express 的限制为 4GB

是否可以**查询数据库服务器以找出最大大小是**多少？

我可以查询以找出当前的大小：

```
name      DataFileSizeMB LogFileSizeMB  
--------- -------------- -------------  
master          4.875000      1.750000  
tempdb          8.000000      0.500000  
model           4.062500      1.000000  
msdb           16.687500      4.562500  
Harrison       21.937500     18.187500  
Lennon        122.750000    425.625000  
McCartney      19.937500     49.687500  
Starr          19.937500     18.187500 
```

**我现在所追求的是一种基于许可**而不是可用硬盘空间来找出最大值的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-26T11:37:34.300

我链接了 Devart 的 ansatz，但是更紧凑的东西怎么样：

```
SELECT max_db_size_in_gb = 
    CASE WHEN serverproperty('EngineEdition') = 4 THEN
        CASE WHEN SERVERPROPERTY('productversion') between '10.50' and '5' THEN 10 ELSE 4 END
    ELSE -1 
    END 
```

（而不是解析 @@VERSION 的输出，检查 SERVERPROPERTY('productversion') 肯定更容易？而且，当 SQL Server 2014 等新版本发布时，这更安全。）

（编辑：旧版本只是检查“<'10.50'”，这当然是错误的，因为例如'9.00'（SQL Server 2005）在字典上更大！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T06:19:10.153

试试这个——

```
SELECT 
      d.server_name
    , d.sversion_name
    , d.edition
    , max_db_size_in_gb = 
        CASE WHEN engine_edition = 4 
            THEN 
                CASE 
                    WHEN d.sversion_name LIKE '%2012%' THEN 10
                    WHEN d.sversion_name LIKE '%2008 R2%' THEN 10
                    WHEN d.sversion_name LIKE '%2008%' THEN 4 
                    WHEN d.sversion_name LIKE '%2005%' THEN 4
                END
            ELSE -1 
        END
FROM (
    SELECT 
          sversion_name = SUBSTRING(v.ver, 0, CHARINDEX('-', v.ver) - 1)
        , engine_edition = SERVERPROPERTY('EngineEdition')
        , edition = SERVERPROPERTY('Edition')
        , server_name = SERVERPROPERTY('ServerName')
    FROM (SELECT ver = @@VERSION) v
) d 
```

另外，请尝试此查询以获取有关 DB 的扩展信息 -

```
IF EXISTS(
    SELECT 1 
    FROM tempdb.dbo.sysobjects 
    WHERE id = OBJECT_ID('tempdb.dbo.#DBObj')
) DROP TABLE #DBObj

CREATE TABLE #DBObj
(
      [DB] SYSNAME
    , reservedpages INT
    , usedpages INT
    , pages INT
)

EXEC sys.sp_MSforeachdb '
    USE [?]

    INSERT INTO #DBObj
    (
          [DB]
        , reservedpages
        , usedpages
        , pages
    )
    SELECT 
          DB_NAME()
        , pg.reservedpages
        , pg.usedpages
        , pg.pages   
    FROM (
        SELECT
              reservedpages = SUM(a.total_pages)
            , usedpages = SUM(a.used_pages)
            , pages = SUM(
                CASE
                    WHEN it.internal_type IN (202, 204, 207, 211, 212, 213, 214, 215, 216, 221, 222) THEN 0
                    WHEN a.[type] != 1 AND p.index_id < 2 THEN a.used_pages
                    WHEN p.index_id < 2 THEN a.data_pages ELSE 0
                END
              )
        FROM sys.partitions p
        JOIN sys.allocation_units a ON p.[partition_id] = a.container_id
        LEFT JOIN sys.internal_tables it ON p.[object_id] = it.[object_id]
    ) pg'

SELECT 
      d.name
    , total_size_mb = data.row_size_mb + data.log_size_mb
    , data.log_size_mb
    , data.row_size_mb
    , reserved_space_mb = CAST(do.reservedpages * 8\. / 1024 AS DECIMAL(10,2))
    , data_size_mb = CAST(do.pages * 8\. / 1024 AS DECIMAL(10,2))
    , index_size_mb = CAST((do.usedpages - do.pages) * 8\. / 1024 AS DECIMAL(10,2))
    , unused_size_mb = CAST((do.reservedpages - do.usedpages) * 8\. / 1024 AS DECIMAL(10,2))
    , unallocated_space_mb = 
        CAST(CASE WHEN data.row_size >= do.reservedpages 
            THEN (data.row_size - do.reservedpages) * 8\. / 1024 
            ELSE 0
        END AS DECIMAL(10,2))
FROM (
    SELECT
          df2.database_id
        , log_size_mb = CAST(df2.log_size * 8\. / 1024 AS DECIMAL(10,2))
        , row_size_mb = CAST(df2.row_size * 8\. / 1024 AS DECIMAL(10,2)) 
        , df2.log_size
        , df2.row_size
    FROM (
        SELECT 
              df.database_id
            , log_size = SUM(CASE WHEN df.type_desc = 'LOG' THEN df.size END)
            , row_size = SUM(CASE WHEN df.type_desc = 'ROWS' THEN df.size END)
        FROM sys.master_files df
        GROUP BY df.database_id 
    ) df2
) data
JOIN sys.databases d ON data.database_id = d.database_id
JOIN #DBObj do ON do.DB = d.name
ORDER BY data.row_size_mb + data.log_size_mb DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:01:54.403

我不确定如何在“给我数据库的最大大小”级别执行此操作，但是您可以[`sys.database_files`](http://msdn.microsoft.com/en-us/library/ms174397.aspx)从构成数据库的文件中查询并将其拼凑在一起。

我认为相关列将是`max_size`，即 8KB 页面中的最大文件大小。

**PS。** `sys.database_files`是每个数据库的视图，如果您想在整个 SQL Server 实例中查看它，那么[`sys.master_files`](http://msdn.microsoft.com/en-us/library/ms186782.aspx)可能会更好......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-11T23:47:47.040

报告的所有大小均以**MB为单位**

注意 - 有更好的方法来检查文件是日志文件还是数据文件；在此处检查“.ldf”后缀适用于 99% 的安装。

```
if object_id('tempdb..#sizes') is not null
drop table #sizes;
GO
create table #sizes (dbname sysname, cursize int, maxsize int, isunlimited int, curlogsize int, maxlogsize int, islogunlimited int);

exec sp_msforeachdb '
insert #sizes
select ''?'',
    sum(case when filename like ''%.ldf'' then 0 else size end),
    sum(case when filename like ''%.ldf'' then 0 else maxsize end),
    min(case when filename like ''%.ldf'' then 0 else maxsize end),
    sum(case when filename like ''%.ldf'' then size else 0 end),
    sum(case when filename like ''%.ldf'' then maxsize else 0 end),
    min(case when filename like ''%.ldf'' then maxsize else 0 end)
from [?].sys.sysfiles';

select dbname, cursize / 128.0,
    case when isunlimited = -1 then 'unlimited' else str(maxsize/128.0) end, curlogsize/128.0,
    case when islogunlimited = -1 then 'unlimited' else str(maxlogsize/128.0) end
from #sizes
order by dbname; 
```

# javascript - kineticjs - 使用 iOS 和 android 的两次触摸进行拖动

> ID：15960242
> 
> 赞同：0
> 
> 时间：2013-04-11T22:51:43.020
> 
> 标签：javascript, kineticjs

使用 KineticJS - 有没有办法在 iOS 或 Android 操作系统上使用两次触摸来实现图像拖动功能。当对象可拖动时，默认为一键拖动。如何将其更改为两次触摸拖动。

我正在尝试实现两次触摸来拖动图像并使用一次触摸进行自由绘制，例如画布笔绘图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-13T03:30:20.947

目前 (v5.1.0) KineticJS 不支持同时拖动多个对象。

但是你可以使用这个插件：[https ://github.com/atomictag/Kinetic.MultiTouch](https://github.com/atomictag/Kinetic.MultiTouch)

# vb.net - 如何在 VB 2012 中将变量声明为货币

> ID：15960244
> 
> 赞同：0
> 
> 时间：2013-04-11T22:51:44.270
> 
> 标签：vb.net, visual-studio-2012

我不太了解最新的 VB 软件，但是当我尝试将全局和本地变量声明为货币时，它无法识别它。任何信息都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:48:28.153

.NET 中的课程非常便宜。如果它对您的应用程序有价值，您可以编写自己的自定义货币类，使用小数类型来存储值。您可以创建一个抽象货币类，然后创建其他继承它并具有特定实现或属性的类，或者在它们自己和其他已知货币单位（可能作为某种枚举）之间指定某种转换方法。

```
Public MustInherit Class Currency
    Public Value As Decimal
    Public Unit As String
End Class

Public Class Dollars : Inherits Currency

End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:01:42.120

Currency 不再可用，已被[Decimal](http://msdn.microsoft.com/en-us/library/xtba3z33%28v=vs.110%29.aspx)取代。

# java - 在 android 中创建 JSONObjects

> ID：15960245
> 
> 赞同：0
> 
> 时间：2013-04-11T22:51:51.770
> 
> 标签：java, android

我需要像这样形成一个 JSON 对象。

```
{
    "GroupID": 24536,
    "Section": [1,2,3,4,5]
} 
```

这是我尝试过的，但是当我查看我的对象结构时，节数组没有正确形成。

```
JSONObject Object = new JSONObject();
Object.put("Group", GroupID);
int[] section = {1,2,3,4,5};
Object.put("Section", section); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:54:18.993

您需要使用`JSONArray`插入代表数组的一组值，在本例中为**int**数组。

* * *

```
String strJson = null;
try{
    int[] section = {1,2,3,4,5};

    JSONObject jo = new JSONObject();
    jo.put("GroupId", 24536);
    JSONArray ja = new JSONArray();
    for(int i : section)
        ja.put(i);
    jo.put("Section", ja);

    strJson = jo.toString();
}
catch (Exception e) {
    e.printStackTrace();
} 
```

现在你在里面有了 json 字符串`strJson`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T22:56:55.817

尝试：

```
JSONObject Object = new JSONObject();
Object.put("Group", GroupID);
int[] section = {1,2,3,4,5};
JSONArray arr = new JSONArray();
arr.put(section);
Object.put("Section", arr); 
```

或者创建一个 Collection 并将其设置为值：

```
Collection c = Arrays.asList(section);
Object.put("Section", c); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T00:53:17.520

尝试：

```
 JSONObject Object = new JSONObject();
    Object.put("Group", GroupID);
    Integer[] section = {1,2,3,4,5};
    Object.put("Section", new JSONArray(Arrays.asList(section))); 
```

# r - 将多个 csv 读取到一个数据帧的更快方法？

> ID：15960246
> 
> 赞同：11
> 
> 时间：2013-04-11T22:51:53.323
> 
> 标签：r

反正有没有加快R中的以下过程？

```
theFiles <- list.files(path="./lca_rs75_summary_logs", full.names=TRUE, pattern="*.summarylog")

listOfDataFrames <- NULL
masterDataFrame <- NULL

for (i in 1:length(theFiles)) {
    tempDataFrame <- read.csv(theFiles[i], sep="\t", header=TRUE)
    #Dropping some unnecessary row
    toBeRemoved <- which(tempDataFrame$Name == "")
    tempDataFrame <- tempDataFrame[-toBeRemoved,]
    #Now stack the data frame on the master data frame
    masterDataFrame <- rbind(masterDataFrame, tempDataFrame)
} 
```

基本上，我正在读取一个目录中的多个 csv 文件。我想通过堆叠行将所有 csv 文件组合成一个巨大的数据框。随着 masterDataFrame 的大小不断增长，循环似乎运行的时间更长。我在 linux 集群上执行此操作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-11T22:55:28.747

用 更新了答案`data.table::fread`。

```
require(data.table)
out = rbindlist(lapply(theFiles, function(file) {
         dt = fread(file)
         # further processing/filtering
      })) 
```

`fread()`自动检测标题、文件分隔符、列类，默认情况下不将字符串转换为因子。处理嵌入的引号，非常快等。查看`?fread`更多。

* * *

请参阅历史以获取旧答案。

# python - 将 CMD 模块与 PYQT 集成

> ID：15960249
> 
> 赞同：0
> 
> 时间：2013-04-11T22:52:28.790
> 
> 标签：python, multithreading, qt, cmd, pyqt4

我正在使用 PYQT 开发一个文本编辑器，该文本编辑器用于处理我正在编写的 DSL。现在我真的很想能够点击一个图标，比如说我的 gui 工具栏中的一个控制台图标，它将启动一个控制台，从控制台我可以运行我的自定义命令，让我可以做一些事情，比如操作我的 SQLITE 数据库直接地。我对 CMD 模块有点熟悉，它允许我创建简单的命令来做我想做的事情，但是如何集成我的 gui 文本编辑器和 CMD 模块控制台？

[在将 Python 控制台集成到 GUI C++ 应用程序](https://stackoverflow.com/questions/2038247/integration-of-python-console-into-a-gui-c-application)中可以找到类似的想法， 唯一的区别是我不想要完整的 Python 解释器，而且我没有使用 C++

有什么建议么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-01T02:34:23.153

经过大量搜索，我发现 [http://obswww.unige.ch/~revaz/git/old.glups-4.0/glups/pycutext.py](http://obswww.unige.ch/~revaz/git/old.glups-4.0/glups/pycutext.py)

该模块实现了一个 QT4 python 解释器小部件。它的灵感来自 PyCute：[http ://gerard.vermeulen.free.fr](http://gerard.vermeulen.free.fr)

我不能把这个解决方案归功于它，但它有效地将所有 python stdin、stdout 甚至 stderr 重定向到 pyQt Widget。它正是我想要的。

# php - 用户到与该链接关联的另一个页面的 PHP 代码

> ID：15960252
> 
> 赞同：0
> 
> 时间：2013-04-11T22:52:53.523
> 
> 标签：php

我正在关注本[教程](https://stackoverflow.com/questions/14704556/how-do-i-create-a-link-that-sends-the-user-to-another-page-which-is-then-diverte)- 它是根据上一页中的链接将用户重定向到一个 URL。

我正在尝试这个解决方案：

HTML

```
<a href="inter.php?target=1">Some page</a>
<a href="inter.php?target=2">Some page</a>
<a href="inter.php?target=something_else">Some page</a> 
```

中间件

```
<?php
session_start();

$link='#';
switch($_GET['target']) {
  case 1:
    $link = "http://nexttarget.com";
    break;

  case 2:
    $link = "http://nexttarget2.com";
    break;

  case "something_else":
    $link = "http://nexttarget3.com";
    break;
}
$_SESSION['prev_link'] = "http://source_url";
?>

<form action="<?php echo $link; ?>" method="post" id="tc_form" >
  <p>Your T&amp;C here</p>
  <input type="checkbox" name="agree" value="agreed" onclick="javascript: this.parentNode.submit();" id="check" />
  <label for="check">I agree to the T&amp;C.</label>
</form> 
```

上面的代码工作得很好。虽然我不希望我的用户同意条款和条件。我只是想让他们点击链接并被转移。当我删除 HTML 代码时没有条款和条件。这是行不通的。我究竟做错了什么？

我知道我可以有一个直接指向该页面的 URL，但我希望它通过 inter.php 完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:55:01.683

`click`您的表单是通过您的复选框元素上的 Javascript 提交的。通过删除它，您没有其他方法可以提交表单。只需添加这个

```
<input type="submit" value="Submit!" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T22:54:46.957

您可以发送 Location HTTP 标头以从 PHP 进行重定向：

```
<?php

$link='#';
switch($_GET['target']) {
  case 1:
    $link = "http://nexttarget.com";
    break;

  case 2:
    $link = "http://nexttarget2.com";
    break;

  case "something_else":
    $link = "http://nexttarget3.com";
    break;
}

header('Location: ' . $link); 
```

# ios - 有没有办法判断 nsmanagedobject 是否在上下文中但不是任何或特定关系的一部分？

> ID：15960258
> 
> 赞同：2
> 
> 时间：2013-04-11T22:54:01.727
> 
> 标签：ios, core-data, nsmanagedobject

例如，假设我有以下实体：

*   **人**
*   **房子**
*   **车**

一个人可以有很多房子和汽车，而汽车和房子只能有一个所有者。

现在考虑以下场景：

1.  我在上下文中插入了一个人，以及 3 座房屋和 3 辆汽车。在这些房屋和汽车中，一所房屋和一辆车已经有了所有者。
2.  然后，在剩下的 2 栋房屋和 2 辆汽车中，我将每个添加到唯一插入的人中。
3.  此时，如果我保存上下文，它将在 context.insertedObjects 中反映 3 座房屋和 3 辆汽车。但我只想保存通过我有句柄的人可以到达的对象（这个想法是，对于以前所有者的房子和汽车，那个所有者可能是一个错误，我从来没有拿过它。）

当然，我可以在保存之前手动删除这些对象，但我想知道是否可以提出一个通用的解决方案，考虑到特定对象的对象可达性。

基本上类似于（伪代码）：

```
for (NSManagedObject *obj in context.registeredObjects) {
    if (Person does not reach obj in any relationship ) {
        [context deleteObject:obj];
    }
} 
```

通过通用解决方案，我的意思是不需要了解关系和特定实体的东西（以免迭代每个房屋和汽车的人的房屋和汽车关系）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T22:48:51.887

您可以将`house`&`car`关系设为`person`非可选，这样对于没有所有者的对象，保存将失败。

`NSManagedObject`您可以通过子类化和覆盖`-(BOOL)validateForInsert:(NSError**)error`方法直接在级别上处理验证问题。

检查该方法中的关系，如果它返回 nil，您就知道可以删除该对象。

这是给你的更多阅读[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdValidation.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdValidation.html)

# jquery - jquery临时更改div高度/直到用户点击其他任何地方

> ID：15960261
> 
> 赞同：0
> 
> 时间：2013-04-11T22:54:08.917
> 
> 标签：jquery, css, temporary

我有一个默认css高度的#content div：auto。单击按钮并提交表单后，我将 content-div 的高度更改为 300：

```
if(msg == 'OK')
{
    result = '<div class="notification_ok">Thank you.</div>';    
    $("#content").height(300);
} 
```

但是当用户在该特定页面上时，它应该只有那个高度，当他点击任何其他链接时，高度应该再次设置为“自动”。我想过添加css类

```
.heightAuto { height: auto; }
.height300 { height: 300; } 
```

然后说

```
$("#content").toggleClass(heightAuto height300); 
```

但后来我想我必须为每个链接添加一个 class="heightAuto" 因为我将链接动态加载到我的 content-div 中，以便不必每次都重新加载页面。jquery 或临时设置 css 样式没有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:15:48.253

你这个项目的目标受众是什么？如果是所有现代浏览器（IE9+），你总是可以使用 CSS 伪选择器`:not()`：

[http://www.w3schools.com/cssref/sel_not.asp](http://www.w3schools.com/cssref/sel_not.asp)

```
:not(.height300){
    height:auto;
} 
```

这样您就不必`.heightAuto`在服务器脚本中显式设置类。

# javascript - 固定定位元素消失

> ID：15960270
> 
> 赞同：1
> 
> 时间：2013-04-11T22:54:50.773
> 
> 标签：javascript, android, css, mobile, android-4.0-ice-cream-sandwich

我刚刚遇到了一个元素（标题）的问题，它固定在页面顶部，消失了。这是在我正在创建的移动网站中找到的。

造成这种情况的原因是单击菜单按钮，该按钮将打开侧边栏导航。当我单击此按钮时，侧边栏会按预期打开，但随后标题会消失。剩下的是我使用[Phark 方法](http://www.mezzoblue.com/tests/revised-image-replacement/#phark)的图像替换技术的残余；文本“菜单”被留下。（我很确定这对手头的问题并不重要，但我可能是错的。）

该`header`元素的样式如下：

```
header{
    position: fixed;
    top: 0;
    z-index: 10000;
    width: 100%;
    background: url('../images/header-bg.png') #111 repeat-x top left;
    border-bottom: 1px solid #090909;
    text-align: center;
} 
```

这只会发生在 Android 4.0 普通浏览器中（我测试过 Galaxy Tabs/Galaxy Nexus）。

什么会导致这种情况仅在 Android 4.0 浏览器中发生？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-11T22:54:50.773

问题似乎是`header`元素没有`left`属性值这一事实。为了解决这个问题，我只是为元素添加了一个`left:0;`属性`header`，给了我以下 CSS：

```
header{
    position: fixed;
    top: 0;
    left: 0;
    z-index: 10000;
    width: 100%;
    background: url('../images/header-bg.png') #111 repeat-x top left;
    border-bottom: 1px solid #090909;
    text-align: center;
} 
```

在弄清楚这一点后，我记得在使用固定定位的桌面网站上遇到过类似的问题。我没有`left`设置属性的事实导致页面加载时固定元素甚至不出现。

希望这可以修复/激发将来为用户修复的想法！我知道从现在开始我将为所有固定元素设置 ax 和 y 轴位置属性；）

# android - 在 Google Play 的 Android 应用的新功能部分下添加内容

> ID：15960277
> 
> 赞同：1
> 
> 时间：2013-04-11T22:55:15.263
> 
> 标签：android, google-play, apk

我在 Google Play 上发布了我的第一个 Android 应用程序，并提交了一个更新的新 APK，最近修复了一些错误和新功能。在 Google play 列表中，它显示该应用程序已于 2013 年 4 月 11 日更新。我想在“新功能”选项卡下添加一些文本，以便我的用户知道更新版本中的新功能。我只是找不到合适的地方放置文本。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:12:49.240

（这假设您使用的是新的控制台，因为旧的控制台将于 4 月 15 日退役）

现在在左侧的商品详情下方称为“最近的更改”。向下滚动一点，你会看到它。

# c#-4.0 - Backgroundworker Completed 方法中的按钮背景颜色不会改变

> ID：15960278
> 
> 赞同：0
> 
> 时间：2013-04-11T22:55:16.353
> 
> 标签：c#-4.0, backgroundworker, backcolor

1）我单击客户端程序中的开始连接按钮。我成功地将开始按钮背景色设置为红色。

2) TCP 连接完成后，发送注册消息，成功将按钮背景色变为黄色。

3) 服务器将注册 ACK 发送回客户端，并在后台工作程序 (BGW) 中进行处理。BGW 设置一个布尔变量 SetConnectButton 以便知道注册成功，然后完成。

4) RunWorkerCompleted 函数运行。调试窗口应显示“Lime”，但按钮颜色不会改变。这是 RunWorkerCompleted 代码。

```
static private void backgroundWorker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
        if (SetConnectButton)
            {
            Debug.WriteLine("Lime");
            SetConnectButton = false;
            UIMain.btnServerConnect.BackColor = System.Drawing.Color.Lime;
            }
        }//close WorkerCompleted 
```

据我了解， RunWorkerCompleted 在 UI 线程中运行，因此它应该按原样工作。使用 Invoke 没有任何区别，尽管我可能做得不对。

有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:20:46.647

在调用编写 UI 的函数时使用 Context.Post 方法解决了问题。

# azure - Azure - 检查是否将新 blob 上传到容器

> ID：15960279
> 
> 赞同：1
> 
> 时间：2013-04-11T22:55:25.143
> 
> 标签：azure, containers

有没有办法检查 Azure 中的容器是否有新的 blob（不管是哪个 blob）？如果将 blob 放入容器中，LastModifiedUtc 似乎不会改变

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-13T14:52:48.533

您应该在应用服务资源中使用 BlobTrigger 函数。

[文档](https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-storage-blob)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T04:14:21.423

Windows Azure Blob 存储不提供开箱即用的此功能。你需要自己处理这个问题。我想到了几件事（只是大声思考）：

*   如果使用您的应用程序（而不是通过 3rd 方工具）上传 blob，则在上传 blob 后，您可以只更新容器属性（可能是添加/更新元数据条目，其中包含有关最后上传的 blob 的信息）。您还可以进入 Azure 表存储，并使用有关上次上传的 blob 的信息继续更新它。正如我上面所说，这种方法只有在所有 blob 都通过您的应用程序上传时才有效。
*   您可以定期手动迭代 blob 容器中的 blob，然后按上次修改日期对它们进行排序。此方法适用于具有较少 blob 数量的 blob 容器。如果 blob 的数量更多（比如数万个），那么您最终会获取一个长列表，因为 blob 存储仅按 blob 名称对 blob 进行排序。

# asp.net-mvc - 简单 MVC 3 无提交按钮

> ID：15960281
> 
> 赞同：0
> 
> 时间：2013-04-11T22:55:26.017
> 
> 标签：asp.net-mvc, form-submit

我正在通过 Steven Sanderson 的 Pro ASP.NET MVC 3 工作（是的，我知道它已经过时了）。第一个示例 PartyInvites 是一个简单的 MVC 应用程序，它会询问姓名、电子邮件并会参加。我在 VS 2010 中输入了代码，据我所知，一切都是正确的。不过，我没有提交按钮。我已经尝试过 Firefox 和 Explorer。

我知道这不是很多信息，但是有什么可以直接告诉那些知道的吗？

谢谢！

**编辑**

我的视图标记

```
<body>
 @using (Html.BeginForm()) { 
<p>Your name: @Html.TextBoxFor(x => x.Name)</p>
<p>Your email: @Html.TextBoxFor(x => x.Email)</p> 
<p>Your phone: @Html.TextBoxFor(x => x.Phone)</p> 
<p>Will you attend? @Html.DropDownListFor(x => x.WillAttend, new[]{ new SelectListItem() {Text = "Yes, I'll be there", Value = bool.TrueString}, new SelectListItem() {Text = "No, I can't come", Value = bool.FalseString} },"Coose an option" ) </p>
 } 
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:05:46.277

您必须向表单添加提交输入以呈现提交按钮。我没有读过有问题的书，但他可能不小心跳过了那本书。确保`<input type="submit"../>`位于`{}`_`@Using(Html.BeginForm()`

```
<body>
 @using (Html.BeginForm()) { 
<p>Your name: @Html.TextBoxFor(x => x.Name)</p>
<p>Your email: @Html.TextBoxFor(x => x.Email)</p> 
<p>Your phone: @Html.TextBoxFor(x => x.Phone)</p> 
<p>Will you attend? @Html.DropDownListFor(x => x.WillAttend, new[]{ new SelectListItem() {Text = "Yes, I'll be there", Value = bool.TrueString}, new SelectListItem() {Text = "No, I can't come", Value = bool.FalseString} },"Coose an option" ) </p>
<p><input type="submit" value="Save"/></p>
 } 
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:06:27.993

你是对的..你没有提交按钮。

我在某处有这本书..我现在找不到它。我不会想到有这样一个如此令人眼花缭乱的明显错误。

无论如何，在右花括号之前弹出这个：

```
<input type="submit" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:07:09.160

这本书的样本似乎有一些你没有的动作链接，如

```
@Html.ActionLink("RSVP Now", "RsvpForm") 
```

# java - Netty：如何减少来自服务器的连续消息之间的延迟？

> ID：15960283
> 
> 赞同：3
> 
> 时间：2013-04-11T22:55:36.077
> 
> 标签：java, sockets, delay, netty

我在使用 Netty 的套接字服务器的开发团队中。当客户端发送请求，服务器发送单个响应时，往返时间非常快。(GOOD) 我们最近注意到，如果来自客户端的请求触发了来自服务器的两条消息，即使服务器几乎同时将两条消息写入客户端，第一条消息和第二条消息之间也存在超过 200 毫秒的延迟到达远程客户端。使用本地客户端时，两条消息同时到达。如果远程客户端在来自服务器的第二条消息到达之前发送另一个请求，则立即发送第二条消息，但是来自新请求的两条消息都以超过 200 毫秒的延迟发送。

由于在使用 Netty 3.3.1 时注意到它，我尝试升级到 Netty 3.6.5，但我仍然看到相同的行为。我们使用的是 NIO，而不是 OIO，因为我们需要能够支持大量并发客户端。

是否有我们需要配置的设置来减少 200 多毫秒的延迟？

编辑以添加代码片段。我希望这些是最相关的部分。

```
@Override
public boolean openListener(final Protocol protocol,
        InetSocketAddress inetSocketAddress) throws Exception {
    ChannelFactory factory = new NioServerSocketChannelFactory(
            Executors.newCachedThreadPool(),
            Executors.newCachedThreadPool(),
            threadingConfiguration.getProcessorThreadCount());

    ServerBootstrap bootstrap = new ServerBootstrap(factory);

    final ChannelGroup channelGroup = new DefaultChannelGroup();
    bootstrap.setPipelineFactory(new ChannelPipelineFactory() {
               .... lots of pipeline setup snipped ......
    });

    Channel channel = bootstrap.bind(inetSocketAddress);

    channelGroup.add(channel);

    channelGroups.add(channelGroup);

    bootstraps.add(bootstrap);

    return true;
} 
```

写入器工厂使用 ChannelBuffers.dynamicBuffer(defaultMessageSize) 作为缓冲区，当我们写入消息时，它是 Channels.write(channel, msg)。

还有什么用处？将代码迁移到Netty的开发者目前不可用，我正在尝试填写。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-12T02:03:48.360

200ms 让我觉得 Nagle 算法的神奇数字。尝试在两侧将 TcpNoDelay 设置为 true。

这是您为服务器端设置选项的方式。

```
 serverBootstrap.setOption("child.tcpNoDelay", true); 
```

这是针对客户端的。

```
 clientBootStrap.setOption("tcpNoDelay", true); 
```

进一步阅读： http: [//www.stuartcheshire.org/papers/NagleDelayedAck/](http://www.stuartcheshire.org/papers/NagleDelayedAck/)

# java - “fill_parent”和“wrap_content”之间的区别

> ID：15960286
> 
> 赞同：3
> 
> 时间：2013-04-11T22:55:41.683
> 
> 标签：java, android, eclipse

`width = "fill_parent"`我是新手，我会说和有什么区别`width = "wrap_content"`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:58:55.607

`fill_parent`将使元素的宽度或高度与父元素（即容器）一样大。

`wrap_content`将使宽度或高度与包含其中的元素一样大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T22:59:50.930

来自android docs.-

> **FILL_PARENT**（在 API 级别 8 及更高版本中重命名为 MATCH_PARENT），这
> 意味着视图希望与其父级一样大（减去填充）
> 
> **WRAP_CONTENT**，这意味着视图希望足够大以包含其内容>（加上填充）

# ios - 有没有办法为 UIScrollView 中的不同图层设置不同的帧大小？

> ID：15960287
> 
> 赞同：1
> 
> 时间：2013-04-11T22:55:42.747
> 
> 标签：ios, objective-c, uiscrollview, transparency, calayer

现在我有一个 UIScrollView 和一个半透明的顶部和底部栏。UIScrollView 包含一个可平移和缩放的大型 UIImageView。

我希望能够切换图像并使图像特定部分周围的所有内容变暗，但透明度与半透明的顶部/底部条完美结合。由于内容是可滚动/可缩放的，因此如果我将图像本身变暗，那么只要该部分位于顶部/底部栏下方，它就会加倍变暗。

我试图通过创建一个嵌套在顶部和底部栏之间的较小的 UIScrollView 来解决这个难题，并向它发送缩放/平移命令以尝试镜像它下面的 UIScrollView，但这并没有很好地工作。尝试同步动画是一场噩梦（我尝试在 zoomDidScroll 中复制 zoomScale/contentOffset，使用 KVO 等将缩放/平移动画单独发送到每个 UIScrollView）。

有什么方法可以为每个单独的图层设置不同的帧大小/截止点？或者也许每个 UIImageView 子视图？我也对任何其他提议的解决方案持开放态度，这确实让我陷入困境。我很感激帮助。

切换之前的样子： ![](https://i.imgur.com/KLkFPfr.png)

切换后我想要什么： ![](https://i.imgur.com/Ec4MxWg.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:03:32.250

为什么不用另一个半透明视图覆盖“中心”部分以匹配工具栏，然后在图层上使用蒙版使您希望的部分完全透明？

# html - css页脚不显示在页面底部

> ID：15960290
> 
> 赞同：19
> 
> 时间：2013-04-11T22:55:55.423
> 
> 标签：html, css

这是我的页脚代码，我怎样才能让它显示在页面底部而不是在它上面的内容下方？

```
/*footer */
#footer .column {
    float: left;
    width: 25%;
}

#footer .column div {
    margin: 5px;
    height: 200px;
    background: #eeeeee;
}

<div id="footer">
    <div class="column"><div></div></div>
    <div class="column"><div></div></div>
    <div class="column"><div></div></div>
    <div class="column"><div></div></div>
</div> 
```

注意：这不需要是固定页脚

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-04-11T22:58:40.217

实际上有两个主要选择：

1.  **固定页脚**- 页脚*始终*在页面底部可见
2.  **Pushed Footer** -即使内容没有填满窗口，页脚也会*被推到页面底部*

两者中较容易的是固定页脚。

## 固定页脚

为了使页脚固定，在 CSS 中将页脚的位置设置为固定，并将页脚定位到`position:fixed`页面底部`bottom:0px`。[这是来自CSS-Tricks](http://css-tricks.com/snippets/css/fixed-footer/)的代码片段。

```
#footer {
   position:fixed;
   left:0px;
   bottom:0px;
   height:30px;
   width:100%;
   background:#999;
}

/* IE 6 */
* html #footer {
   position:absolute;
   top:expression((0-(footer.offsetHeight)+(document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body.clientHeight)+(ignoreMe = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop))+'px');
} 
```

## 压入页脚

推送的页脚有点棘手。这是[一个很棒的图形](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)，显示了当没有足够的内容时为什么页脚不会留在页面底部：

![推送的页脚问题视觉](https://i.stack.imgur.com/z62WV.gif)

基本上，问题正在发生，因为页脚元素被“推”在它上方的元素下方，并且该元素的高度没有页面的高度那么长。为了解决这个问题，您需要确保页脚被“推”到页面的整个高度（减去页脚的高度）。

这是如何做到的：

**HTML**

```
<div id="container">
   <div id="header"></div>
   <div id="body"></div>
   <div id="footer"></div>
</div> 
```

**CSS**

```
html, body {
   margin:0;
   padding:0;
   height:100%;
}
#container {
   min-height:100%;
   position:relative;
}
#header {
   background:#ff0;
   padding:10px;
}
#body {
   padding:10px;
   padding-bottom:60px;   /* Height of the footer */
}
#footer {
   position:absolute;
   bottom:0;
   width:100%;
   height:60px;   /* Height of the footer */
   background:#6cf;
} 
```

[这是有关如何执行](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)此操作的更详细的教程以及上述代码的来源。

这是来自同一来源[的代码的工作演示。](http://matthewjamestaylor.com/blog/bottom-footer-demo.htm)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-08-15T09:33:16.683

Bootstrap 有一个页脚的示例，它贴在页面底部： [https ://getbootstrap.com/examples/sticky-footer/](https://getbootstrap.com/examples/sticky-footer/)

这是CSS：

```
html {
  position: relative;
  min-height: 100%;
}
body {
  /* Margin bottom by footer height */
  margin-bottom: 60px;
}
.footer {
  position: absolute;
  bottom: 0;
  width: 100%;
  /* Set the fixed height of the footer here */
  height: 60px;
  background-color: #f5f5f5;
} 
```

然后在 HTML 中：

```
<footer class="footer">

</footer> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-17T07:46:57.480

**用很酷的效果修复了底部的页脚检查 jsfiddle** [Jsfiddle](https://jsfiddle.net/kulbhushancharaya/roweeLLe/7/)
中的整页设计

```
<body>
<header>
<ul>
<li><a href="#">Home</a></li>
<li><a href="#">link1</a></li>
<li><a href="#">link2</a></li>
<li><a href="#">link3</a></li>
<li><a href="#">link4</a></li>
</ul>
</header>
<div class="wrapper">
<div class="demo">
<h1> H1</h1>
<h2> h2</h2>
<h3> h3</h3>
<h4> h4</h4>
<h5> h5</h5>
<h6> h6</h6>
<hr>
<h1> H1</h1>
<h2> h2</h2>
<h3> h3</h3>
<h4> h4</h4>
<h5> h5</h5>
<h6> h6</h6>
<hr>
<h1> H1</h1>
<h2> h2</h2>
<h3> h3</h3>
<h4> h4</h4>
<h5> h5</h5>
<h6> h6</h6>
</div>
</div>
<footer>
    <h1>kulbhushan charaya</h1>
</footer>
</body> 
```

而CSS是

```
body {
    background: #ffffff none repeat scroll 0 0;
    padding:40px 0;
}
header{
  position:fixed;
  top:0;
  z-index:999;
  left:0;
  width:100%;
  background:#fff;
  border-bottom:1px solid #ccc;
}
header ul li {
  display: inline-block;
  list-style: outside none none;
  padding: 5px;
}
header ul li a {
    color: #000000;
    text-decoration: none;
}
footer {
  bottom: 0;
  left: 0;
  position: fixed;
  text-align: center;
  width: 100%;
  z-index: -1;
}
footer h1 {
  margin: 0;
}
.wrapper {
  background: #ffffff;
  padding: 0 15px;
  z-index: 1;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-03-08T13:37:56.130

如果有人再次陷入困境，[这是一个没有黑客的现代解决方案](https://codepen.io/cbracco/pen/zekgx)

HTML：

```
<div class="demo">
  <h1>CSS “Always on the bottom” Footer</h1>

  <p>I often find myself designing a website where the footer must rest at the bottom of the page, even if the content above it is too short to push it to the bottom of the viewport naturally.</p>

  <p>However, if the content is taller than the user’s viewport, then the footer should disappear from view as it would normally, resting at the bottom of the page (not fixed to the viewport).</p>

  <p>If you know the height of the footer, then you should set it explicitly, and set the bottom padding of the footer’s parent element to be the same value (or larger if you want some spacing).</p>

  <p>This is to prevent the footer from overlapping the content above it, since it is being removed from the document flow with <code>position: absolute;</code>.</p>
</div>

<div class="footer">This footer will always be positioned at the bottom of the page, but <strong>not fixed</strong>.</div> 
```

CSS：

```
/**
 * Demo Styles
 */

html {
  height: 100%;
  box-sizing: border-box;
}

*,
*:before,
*:after {
  box-sizing: inherit;
}

body {
  position: relative;
  margin: 0;
  padding-bottom: 6rem;
  min-height: 100%;
  font-family: "Helvetica Neue", Arial, sans-serif;
}

.demo {
  margin: 0 auto;
  padding-top: 64px;
  max-width: 640px;
  width: 94%;
}

.demo h1 {
  margin-top: 0;
}

/**
 * Footer Styles
 */

.footer {
  position: absolute;
  right: 0;
  bottom: 0;
  left: 0;
  padding: 1rem;
  background-color: #efefef;
  text-align: center;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-16T16:51:44.130

我通过简单地在我的 HTML`min-height`的主体上使用解决了这个问题。`container`

所以HTML：

```
<body>
    <div class="top-nav">My Nav Bar</div>
    <div class="main-container">
        All my content
    </div>
    <div class="footer">
        My footer
    </div>
</body> 
```

然后是 CSS

```
.top-nav {
    height: 4rem;
}
.main-container {
    min-height: calc(100vh - 4rem - 4rem);
}
.footer {
    height: 4rem;
} 
```

使用 SCSS，您可以使用变量来跟踪顶部导航和页脚高度，然后执行类似的操作

```
.main-container {
  min-height: calc(100vh - #{$top-nav-height} - #{$footer-height});
} 
```

这不是一个*完美*的解决方案，因为它不会将您的页脚*完全*放在视口的底部，但是当内容太短时它会将其推到底部并防止页脚在屏幕中间向上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-11T22:57:39.400

我猜你的意思是你希望页脚保持在页面底部，即使页面上没有足够的内容来填充视口的高度？

如果是这种情况，您可以使用这个技巧：CSS 粘页脚 - [http://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)、[http://www.cssstickyfooter.com/](http://www.cssstickyfooter.com/)或[http://css-tricks.com/片段/css/sticky-footer/](http://css-tricks.com/snippets/css/sticky-footer/)

粘性页脚技巧通常依赖于在包装 div 上声明最小高度。这意味着您必须重新格式化您的 HTML 代码，如下所示：

```
<div id="wrap">
    <div id="content">
        /* Main body content */
    </div>
</div>

<div id="footer">
    /* Footer content here */
</div> 
```

对于 CSS：

```
html, body, #wrap {
    height: 100%;
}
#wrap {
    height: auto;
    min-height: 100%;
}
#content {
    overflow: hidden;
    padding-bottom: (footer height);
}
#footer { 
    position: relative;
    margin-top: -(footer height); /* Note the negative value */
    height: (footer height);
    clear:both;
} 
```

如果您的页脚可能具有可变高度，则必须使用 JavaScript设置底部填充`#content`和顶部边距。`#footer`该值取决于`#footer`元素本身的计算高度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-11T22:59:02.383

您可能需要将 html 元素高度设置为 100%，否则您的页面本身将只是您内容的必要高度。我自己遇到了这个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-11T23:00:28.293

```
#main {padding-bottom: 150px;} /* Should have the same value of footer's height */ 
#footer {position: relative; 
margin-top: -150px; /* footer's height */ 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-31T19:41:26.133

只需使用 flex-box：将 body 显示设置为 flex，然后将页脚与 flex 端对齐。这样，页脚将始终是最后的最后一个组件。

```
body {
   display: flex;
   flex-direction: column;
}

footer {
  align-self: flex-end;
}
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-24T20:20:19.883

Material Design Bootstrap 有一个很棒的类：[`fixed-bottom`](https://mdbootstrap.com/docs/angular/utilities/position/). 这是我使用的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-04T09:42:09.393

在页脚自动将其位置设置在底部后，您需要设置父级的高度。

如果出现此问题后无法在父 div 或页脚部分添加内容或高度。

# python - 我可以从 South 生成适用于不同数据库 [sqlite 和 postgresql] 的模式迁移吗？

> ID：15960292
> 
> 赞同：2
> 
> 时间：2013-04-11T22:56:18.633
> 
> 标签：python, django, postgresql, sqlite, django-south

我在我的开发服务器上使用 sqlite3，当我更改架构时，我希望能够在开发中生成迁移，我可以在使用 postgresql 的生产中使用。一种选择是直接在生产环境中生成迁移，然后应用它们——理想情况下，我希望在开发环境中生成迁移，然后将文件上传到生产环境并运行模式迁移。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T22:58:35.413

数据库独立性是[South 的关键特性之一](http://south.readthedocs.org/en/latest/about.html#key-features)——因此您可以在任何您喜欢的地方生成迁移，并确信您可以在任何需要的地方很好地运行它们（即使您使用的数据库与您使用的数据库不同）用于生成迁移）。

# sharepoint - 是否可以不使用 Designer 将 visio sharepoint 工作流模板直接导入 Visual Studio？

> ID：15960294
> 
> 赞同：2
> 
> 时间：2013-04-11T22:56:34.790
> 
> 标签：sharepoint, sharepoint-2010, visio, sharepoint-workflow

我们正在尝试确定是否可以在不使用 SharePoint Designer 的情况下将工作流直接从 Visio 导入 Visual Studio。此处的评论：http: [//social.msdn.microsoft.com/Forums/en-US/vsarch/thread/92095335-3ac5-4568-b87d-bc17d147cb11](http://social.msdn.microsoft.com/Forums/en-US/vsarch/thread/92095335-3ac5-4568-b87d-bc17d147cb11)表示 Visio 和 Visual Studio 的 UML 版本不匹配。现在还是这样吗？

我们能否使用 Visio 2013 直接从 Visio 转到 Visual Studio？如果可以做到这一点，有没有人有这样做的步骤？

先感谢您。

# audio - 从 VB6 播放 Windows 系统声音

> ID：15960295
> 
> 赞同：1
> 
> 时间：2013-04-11T22:56:40.833
> 
> 标签：audio, vb6

我想播放类似于*错误*和*信息*对话框的 Windows 系统声音。

我试过[Beep](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679277%28v=vs.85%29.aspx) API：

```
Public Declare Function Beep Lib "kernel32" _
    (ByVal dwFreq As Long, ByVal dwDuration As Long) As Long
Beep 200, 2000 
```

问题是它只适用于 XP/2000，但不适用于 Win 7。我还希望能够播放*不同的*声音。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T22:10:27.003

[`MessageBeep`您可以通过调用该函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680356.aspx)来播放标准的 Windows 警报声音。要从 VB 6 调用它，您需要编写如下声明：

```
Public Declare Function MessageBeep Lib "user32" (ByVal wType As Long) As Long 
```

然后您需要指定要播放的哔声类型的常量：

```
Public Const MB_DEFAULTBEEP As Long = -1   ' the default beep sound  
Public Const MB_ERROR As Long       = 16  ' for critical errors/problems
Public Const MB_WARNING As Long     = 48  ' for conditions that might cause problems in the future
Public Const MB_INFORMATION As Long = 64  ' for informative messages only
Public Const MB_QUESTION As Long    = 32  ' (no longer recommended to be used) 
```

请注意，它们与消息框 (MsgBox) 显示的图标完美匹配。每个可用图标都有与之关联的不同默认警报声音。适用于在消息框中正确使用这些图标的相同[指导](http://msdn.microsoft.com/en-us/library/aa511277.aspx)也适用于将它们用作孤立的、独立的警报声音。

当然，因为这些是标准系统声音，所以不能保证它们总是播放相同的声音。使用的确切声音可由用户配置。但这可能就是你想要的。

* * *

至于为什么`Beep`不起作用，这是一个相当悲伤和复杂的故事。[函数文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679277.aspx)包含大部分细节：

> 很久以前，所有 PC 计算机共享一个通用的 8254 可编程间隔定时器芯片，用于生成原始声音。Beep 函数是专门为在该硬件上发出哔声而编写的。
> [...]
> 从那时起，声卡已成为几乎所有 PC 计算机的标准设备。随着声卡变得越来越普遍，制造商开始从计算机中移除旧的计时器芯片。这些芯片也被排除在服务器计算机的设计之外。结果是 Beep 不能在所有没有芯片的计算机上工作。这没关系，因为大多数开发人员已经开始调用 MessageBeep 函数，该函数使用默认声音设备而不是 8254 芯片。
> 
> 最终，由于缺少可与之通信的硬件，Windows Vista 和 Windows XP 64 位版中放弃了对 Beep 的支持。
> 
> 在 Windows 7 中，Beep 被重写以将哔声传递给会话的默认声音设备。这通常是声卡，除非在终端服务下运行，在这种情况下会在客户端上呈现哔声。

您可以在 Larry Osterman 的博客上找到更多信息：[Windows 7 中的 Beep 驱动程序是怎么回事？](http://blogs.msdn.com/b/larryosterman/archive/2010/01/04/what-s-up-with-the-beep-driver-in-windows-7.aspx)

所以它*应该*可以在 Windows 7 上运行，但它要求您的计算机安装了声音发生器硬件，连接了扬声器，并且它们已打开。当然，`MessageBeep`功能也是如此。

# php - AJAX 与 php 的基本用法，用于数据库更新和检索

> ID：15960299
> 
> 赞同：0
> 
> 时间：2013-04-11T22:57:02.787
> 
> 标签：php, mysql, ajax, jquery

（只是提醒一下，这是一个冗长的问题，但我确定它对于 ajax-php 编码器来说是非常基本的问题）我试图“在一个页面上的某些拖放事件上更新 db”并“在不重新加载的情况下反映其他页面中的更改'。我已经写了几乎所有的代码，需要你的帮助来找出问题所在。这是我写的Html，

First_html_file:

```
<head>
    <title>Coconuts into Gunnybags</title>
    <link rel="stylesheet" href="style.css" type="text/css" media="screen" />
    <script type="text/javascript" src="script.js"></script>
</head>

<body>
    <div id="coconuts" style="float:left">
        <div class="coconut1" ondragover="allowDrop(event)" ondrop="drop(event)">
            <img id="drag1" ondragstart="drag(event)" draggable="true" src="coconut.png">
        </div>
        <div class="coconut2" ondragover="allowDrop(event)" ondrop="drop(event)">
            <img id="drag2" ondragstart="drag(event)" draggable="true" src="coconut.png">
        </div>

    </div>

    <div class="gunnybag" style="float:right">
        <div id="place1" ondragover="allowDrop(event)" ondrop="drop(event)"></div>
        <div id="place2" ondragover="allowDrop(event)" ondrop="drop(event)"></div>

    </div>
</body> 
```

所以有 2 个可拖动的椰子和 2 个占位符（place1 和 place2）。我想要做的是当椰子被拖动并放置在占位符之一上时，应该更新数据库的值。（比如说当椰子放在第一个占位符中时，place_id 1 - true，place_id 2 - false）

为此，我正在像这样从 JS 的 drop 函数对 php 文件进行 ajax 调用。

JS_文件：

```
function drop(ev)
{
ev.preventDefault();
var data=ev.dataTransfer.getData("coconut");
ev.target.appendChild(document.getElementById(data));
    var state = true;           
    var id = ev.target.id;
$.ajax({
     url: "db_update.php",        //calling db update file.
     type: "POST",
     data: { id: id, state: state },       //2 variables place_id and its     state(True/False)
     cache: false,
     success: function (response) {    //I dont know what to do on success. Can this be left blank like, success:         ?
         $('#text').html(response);
     }
 });
} 
```

这是我的 db_update，db_update：

```
 <?php

    $state = $_POST['state'];       //getting my variables state 'n ID
    $id = $_POST['id'];

    function begin()
    {
    mysql_query("BEGIN");
    }

    function commit()
    {
    mysql_query("COMMIT");
    }

    $con=mysql_connect("sqlservername","myuname", "mypass") or die(mysql_error());

    mysql_select_db("my_db", $con) or die(mysql_error());

    $query = "UPDATE gunnybag SET state = '{$state}' where id='{$id}'";  //will this work? or am I doing something wrong here??

    begin();

    $result = mysql_query($query);

    if($result)
    {
    commit(); 
    echo "successful";
    }

    ?> 
```

在接收端，我想在不重新加载页面的情况下更新麻袋中的椰子，所以我编写了这个使用 db_fetch.php 的 ajax

ajx.js 文件：

```
window.onLoad = doAjax;

function doAjax(){
$.ajax({
url: "db_fetch.php",
dataType: "json",
success: function(json){
    var dataArray = JSON.decode(json);
    dataArray.each(function(entry){
        var i=1;
        if(entry.valueName==true){
            $q('place'+i).css( "display","block" );
        }
        else{
            $q('place'+i).css( "display","none" );
        }
        i=i++;
    })
}

}).complete(function(){
      setTimeout(function(){doAjax();}, 10000);
    });
} 
```

这是 db_fetch.php：

```
<?php
try{
  $con=mysql_connect("sqlservername","myuname", "mypass") or die(mysql_error());
}
catch(Exception $e){
    echo $e;
}
mysql_select_db("my_db", $con) or die(mysql_error());

$q = mysql_query("SELECT 'state' FROM 'gunnybag' ");  //fetching all STATE from db
$query = mysql_query($q, $con);
$results = mysql_fetch_assoc($query);
echo json_encode($results);              //making it JSON obj

?> 
```

最后是我调用这个ajax的另一个页面。second_html_file:

```
 <head>
    <title>Coconuts into Gunnybags</title>
    <link rel="stylesheet" href="style.css" type="text/css" media="screen" />
    <script type="text/javascript" src="ajx.js"></script>  
               //if i simply include the ajax script here will it be called 
             //automatically? i want this script to keep up with the changes in db.
</head>

<body>
    <div class="gunnybag" style="float:right">
        <div id="place1" style="display: ;"><img id="drag1"  draggable="true" src="coconut.png"></div>
        <div id="place2" style="display: ;"><img id="drag2"  draggable="true" src="coconut.png"></div>

    </div>
</body> 
```

MAP：First_html_file->JS_file->db_update :: Second_html_file->ajx.js->db_fetch。

请指出这段代码有什么问题，同时回复代码中的//注释。非常感谢您的回复。谢谢！#help me get this right# For ref 我在这里托管了文件， http: [//www.nagendra.0fees.net/admin.html](http://www.nagendra.0fees.net/admin.html) & [http://www.nagendra.0fees.net/cng.html](http://www.nagendra.0fees.net/cng.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:32:17.750

我看到的第一件事是：

你说：

```
var id = event.target.id; 
```

但是你在 drop(ev) 中 decalare ev

所以改变：

```
var id = event.target.id; 
```

至：

```
var id = ev.target.id; 
```

对于初学者。

然后你应该使用[mysqli](http://php.net/manual/en/book.mysqli.php)因为 mysql 已被弃用：

您的代码也对 SQL 注入开放，因此请更改：

```
$state = $_POST['state'];       //getting my variables state 'n ID
$id = $_POST['id']; 
```

至：

```
$state = ($_POST['state']) ? true : false;       
$id = intval($_POST['id']); //make sure an integer 
```

# php - 一键上传（ocupload）jquery插件和cakephp 2

> ID：15960300
> 
> 赞同：0
> 
> 时间：2013-04-11T22:57:21.870
> 
> 标签：php, javascript, jquery, ajax, cakephp

我正在尝试为 jquery [http://code.google.com/p/ocupload/wiki/Documentation使用“一键上传”插件](http://code.google.com/p/ocupload/wiki/Documentation)

它是一个插件，可以将普通输入 type="file" 更改为您想要的任何元素，例如 div，因此当您单击此 div 时，将打开一个文件浏览器，允许您选择要上传的文件。然后它会提交一个涉及 iframe 的隐藏表单，我相信这个概念是众所周知的，但对我来说不是。

无论如何，到目前为止一切顺利......我有我的 div 可以打开一个文件浏览器。

The problem is that when a file is selected the plugin is supposed to auto-submit the form to an action which you define. 这似乎没有正确发生，我认为这可能与我的表单动作的目标有关。

因此，在我看来，要添加一个新的“瓷砖”，我有：

```
<div id="TileImageUpload">Upload an image</div> 
```

然后将javascript附加到div：

```
$(document).ready(function(){
    //one click image upload
    var myUpload = $('#TileImageUpload').upload({
            name: 'file',
            action: '../tiles/uploadImage',
            enctype: 'multipart/form-data',
            params: {upload:'Upload'},
            autoSubmit: true,
            onSubmit: function() {
                alert('submitted');
                $('#upload_status').html('').hide();
                loadingmessage('Please wait, uploading file...', 'show');
            },
            onComplete: function(response) {
                alert(response);
            },
            onSelect: function() {}
    });

}); 
```

在上面的 action 参数是指向我的 TilesController action=>uploadImage。看起来像：

```
function uploadImage() {
    if ($_POST["upload"]=="Upload") { 
        return 'wooHoo';
    } else {
        return 'BooHoo';
    }
} 
```

**请注意**，我也尝试回显“WoHoo”等，但没有任何区别。

所以基本上，如果有一个成功的表单发布，那么它应该将 WooHoo 返回到 javascript，然后应该提醒它。

这不会发生。有谁知道为什么。就像我说的，我认为可能与表单动作有关，但我已经尝试了所有我能想到的方法。

该插件的实际 JS 并不大，可能会在此处发布所有内容。如果有善良的灵魂怜悯并想帮助我，它可以在我上面发布的链接上找到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:24:56.993

你不应该使用'return'，而应该尝试'echo'。

但是，由于在这种情况下您没有为您的操作使用视图文件，您还应该禁用“自动渲染”；

```
$this->autoRender = false; 
```

否则，CakePHP 将抛出“未找到视图”异常。

此外，要获取在 CakePHP 中发布的数据，请使用[Request](http://book.cakephp.org/2.0/en/controllers/request-response.html#cakerequest)对象；

例如：

```
$this->autoRender = false;

if($this->request->is('post')) {
    echo 'data is posted. This is the content of the request:';
    debug($this->request->data);
} else {
    echo 'no form is posted';
} 
```

最后，如果要返回 JSON 数据，请参阅手册的这些部分

[http://book.cakephp.org/2.0/en/controllers/request-response.html#cakeresponse](http://book.cakephp.org/2.0/en/controllers/request-response.html#cakeresponse)

[http://book.cakephp.org/2.0/en/views/json-and-xml-views.html](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html)

# asp.net - 如何将图像添加到 PDF 文档？

> ID：15960310
> 
> 赞同：2
> 
> 时间：2013-04-11T22:58:41.647
> 
> 标签：asp.net, pdf, itextsharp, reportviewer

我正在使用 iTextSharp 将来自微软报告查看器的多个 pdf 连接在一起。下面代码中的 page.AddImage(image__1) 抛出错误 Object reference not set to an object of an instance。我没有看到什么设置为空。有没有其他方法可以让我从报表查看器加入报表并添加水印图像？

```
 mybytes = MSRptViewer1.LocalReport.Render("PDF", Nothing, Nothing, Nothing, Nothing, Nothing, Nothing)
    reader = New iTextSharp.text.pdf.PdfReader(mybytes)
    numberOfPages = reader.NumberOfPages
    currentPageNumber = 0

    Dim imageFile As String = Server.MapPath("WaterMark.png")
    Dim buffer As Byte() = IO.File.ReadAllBytes(imageFile)
    Dim image__1 As iTextSharp.text.Image = iTextSharp.text.Image.GetInstance(buffer)
    image__1.SetAbsolutePosition(100, 100)

    Do While (currentPageNumber < numberOfPages)
        currentPageNumber += 1
        doc.SetPageSize(PageSize.LETTER)
        doc.NewPage()

        page = writer.GetImportedPage(reader, currentPageNumber)
        page.AddImage(image__1)

        rotation = reader.GetPageRotation(currentPageNumber)
        If (rotation = 90) Or (rotation = 270) Then
            cb.AddTemplate(page, 0, -1.0F, 1.0F, 0, 0, reader.GetPageSizeWithRotation(currentPageNumber).Height)
        Else
            cb.AddTemplate(page, 1.0F, 0, 0, 1.0F, 0, 0)
        End If
    Loop 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-06T07:49:26.813

```
<?php $data = file_get_contents('https://static1.squarespace.com/static/56c775ad27d4bd3fdb24775d/t/5a8b201324a694d7071662ee/1519067160925/dummy+logo.jpg');
$base64 = 'data:image/' . $type . ';base64,' . base64_encode($data);
?> 
```

这种图像转换为base64格式的方法

```
<?php echo '<div class="company-logo"><img src="'.$base64.'"  alt="base" /></div>'; ?> 
```

或者

```
<img src="<?php echo $base64; ?>"  alt="base" /> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-12T11:22:14.017

我已要求我的出版商 Manning Publications 免费提供[我的书](http://www.manning.com/lowagie2/samplechapter6.pdf)的第 6 章。我知道本章只向您展示 Java 中的示例，但为了您的方便，所有示例都[移植到了 C#中。](http://tinyurl.com/iiacsCH06)

如果你阅读本章，你会发现你犯了以下错误：

1.  您正在使用`PdfReader`/而不是/`PdfWriter`向现有文档添加内容。如果您想要一个漂亮的水印示例，请查看[StampStationery.cs](http://sourceforge.net/p/itextsharp/code/HEAD/tree/trunk/book/iTextExamplesWeb/iTextExamplesWeb/iTextInAction2Ed/Chapter06/StampStationery.cs)示例中的 ManipulatePdf 方法。替换为添加图像而不是从另一个 PDF 获取的背景页面。您还将在此处了解有关使用图像作为水印的更多信息：[如何将水印添加到 PDF 文件？](https://stackoverflow.com/questions/17522965/how-to-add-a-watermark-to-a-pdf-file)`PdfReader``PdfStamper``background.addTemplate()``background.addImage()`
2.  您正在使用`PdfReader`/`PdfWriter`来连接现有文档，而不是`PdfCopy`. 这样做，您可能会遇到各种问题：例如，部分页面被截断、链接被删除、注释丢失……请阅读我对这个问题的回答：[如何正确合并文档？](https://stackoverflow.com/questions/21731439/how-to-merge-documents-correctly)
3.  `PdfImportedPage`您忽略了只读的事实。您只能`PdfCopy`在创建`PageStamp`对象后的上下文中添加内容。请查看[ConcatenateStamp.cs](http://sourceforge.net/p/itextsharp/code/HEAD/tree/trunk/book/iTextExamplesWeb/iTextExamplesWeb/iTextInAction2Ed/Chapter06/ConcatenateStamp.cs)示例。

总结：您的问题或多或少是之前在 StackOverflow 上回答的其他问题（组合）的重复。您似乎从不是官方文档来源之一的来源复制/粘贴了一些代码。

# java - 如何清除按钮的颜色？

> ID：15960315
> 
> 赞同：0
> 
> 时间：2013-04-11T22:59:13.363
> 
> 标签：java, android

不仅如何将颜色清除为按钮的默认颜色，而且在我的代码中什么时候执行？我已经尝试了一切，但没有运气。当我单击一个按钮时，我设置了一些不透明度的绿色。现在，当我单击下一个按钮时，会发生同样的情况，但第一个按钮仍设置为绿色。我需要它恢复到原来的颜色。我试过：

```
button.getBackground().setColorFilter(null); 
```

这是我的代码：

```
final OnClickListener clickListener = new OnClickListener() {

           private Button buttonClicked;

           public void onClick(View v) {
               Button button = (Button) v;
               button.getBackground().setColorFilter(new LightingColorFilter(0xFFFFFFFF, 0x003333));

               if (buttonClicked == null) {
                   // first button is clicked
                   buttonClicked = button;
                   // only do stuff if buttons are in different layouts
               } else{
           if (!button.getParent ().equals(buttonClicked.getParent())) {
                // second button is clicked

            if(buttonClicked.getTag().equals(button.getTag()) ){

               // second button is clicked and same tag but different button

               Toast.makeText(Spojnice.this, "Correct", Toast.LENGTH_SHORT).show();
               button.getBackground().setColorFilter(new LightingColorFilter(0xFFFFFFFF, 0x66FF33));
               buttonClicked.getBackground().setColorFilter(new LightingColorFilter(0xFFFFFFFF, 0x66FF33));
               buttonClicked.setEnabled(false);
               button.setEnabled(false);
               buttonClicked = null;
               } else {
               //reset LightingColorFilter first
               Toast.makeText(Spojnice.this, "Wrong", Toast.LENGTH_SHORT).show();
               buttonClicked = null;

               }
              }else{

                  buttonClicked = button;
              }
           }
               }       
           }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:29:36.197

我刚刚做了一个简单的程序，可以打开和关闭滤光片。

这是活动：

```
 Button buttonClicked = null;
     @Override
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.main);
     }

     public void clickedButton(View v) {
         Button button = (Button)v;
         button.getBackground().setColorFilter(new LightingColorFilter(0xFFFFFFFF,
                                                                       0x66FF33));

         if (buttonClicked != null) {
             buttonClicked.getBackground().setColorFilter(null);
         }
         buttonClicked = button;

     } 
```

这是XML

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
        >
    <TextView
            android:id="@+id/boss"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Hello World, MyActivity"
            />
    <Button
            android:id="@+id/buttsky"
            android:layout_below="@id/boss"
            android:onClick="clickedButton"
            android:layout_width="200dp"
            android:layout_height="100dp"
            android:text="pushMe"
            />
    <Button
            android:id="@+id/buttground"
            android:layout_below="@id/buttsky"
            android:onClick="clickedButton"
            android:layout_width="200dp"
            android:layout_height="100dp"
            android:text="no, pushMe"
            />
</RelativeLayout> 
```

# hadoop - 成功的 Hadoop 作业但有错误

> ID：15960317
> 
> 赞同：2
> 
> 时间：2013-04-11T22:59:22.303
> 
> 标签：hadoop

我已经建立了我的第一个简单的 Hadoop 多节点集群（我是新手），由两个节点组成，一个主节点（也充当从节点）和一个专用的从节点。我正在运行 Hadoop“字数统计”示例作业，该作业成功完成。虽然当我查看日志时可以看到一个错误，但这是来自从节点上的 TaskTracker 日志：

```
 2013-04-12 00:30:16,436 WARN org.apache.hadoop.mapred.TaskTracker: Failed validating JVM  
    java.io.IOException: JvmValidate Failed. Ignoring request from task:
    attempt_201304112309_0006_m_000003_0, with JvmId: jvm_201304112309_0006_m_1485441759
    at org.apache.hadoop.mapred.TaskTracker.validateJVM(TaskTracker.java:3434)
at org.apache.hadoop.mapred.TaskTracker.statusUpdate(TaskTracker.java:3504)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:578)
at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1393)
at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1389)
at java.security.AccessController.doPrivileged(Native Method)
at javax.security.auth.Subject.doAs(Subject.java:415)
at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1149)
at org.apache.hadoop.ipc.Server$Handler.run(Server.java:1387)

    2013-04-12 00:30:16,515 WARN org.apache.hadoop.mapred.DefaultTaskController: Exit code from task is : 143
    2013-04-12 00:30:16,515 INFO org.apache.hadoop.mapred.DefaultTaskController: Output from DefaultTaskController's launchTask follows:
    2013-04-12 00:30:16,515 INFO org.apache.hadoop.mapred.TaskController: 
    2013-04-12 00:30:16,516 INFO org.apache.hadoop.mapred.JvmManager: JVM : jvm_201304112309_0006_m_1485441759 exited with exit code 143\. Number of tasks it ran: 1 
```

有谁知道这里发生了什么？对不起，丑陋的代码缩进，我无法弄清楚如何正确地做到这一点，这是我的第一篇文章。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T15:24:37.410

看起来有什么东西杀死了你的进程，但你提到它完成了，所以 Hadoop 的弹性特性开始发挥作用，要么在另一个节点上运行它，要么在同一个节点上重试它，让你的字数统计完成。查看[JVM 错误代码 143的答案](https://stackoverflow.com/questions/6963811/jvm-returns-error-143)

# c# - 查找附近城市的 API

> ID：15960319
> 
> 赞同：1
> 
> 时间：2013-04-11T22:59:31.587
> 
> 标签：c#, asp.net, api, rest, geolocation

我正在寻找一个 api，可用于根据坐标或名称和国家/地区查找附近的城市（可能具有按距离过滤的功能，因为附近可以由解释决定）。

我希望它是安静的，或者有一个可以在我的 .net 应用程序中使用的库（包装器）。

我正在寻找一个免费的 api（每天有大量的免费请求）。

我的第一个想法是谷歌，我找到了“谷歌地理编码 API”，但我不打算把它放在地图上，所以根据限制我不能使用它。

还有其他人知道我可以使用的其他任何东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:20:45.143

尝试查看[GeoNames](http://www.geonames.org/)。他们有一个[RESTful API](http://www.geonames.org/export/web-services.html)，您可以使用它来进行反向地理编码。向下滚动到“查找附近的邮政编码/反向地理编码”部分以查看现场演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:45:40.230

您可以尝试使用 Overpass API，它使用 Open Street Map 数据。我不确定它是否会完全符合您的要求，但这可能是一个开始。

下面的调用搜索城市。bbox 创建一个要在其中搜索的区域。我在下面创建的示例使用英国朴茨茅斯周围的坐标。

```
http://overpass.osm.rambler.ru/cgi/xapi?node[place=city][bbox=-1.150818,50.761653,-0.987396,50.851908] 
```

从这里返回的结果提供了一些有用的数据

```
<?xml version="1.0" encoding="UTF-8"?>
<osm version="0.6" generator="Overpass API">
    <note>The data included in this document is from www.openstreetmap.org. The data is made available under ODbL.</note>
    <meta osm_base="2013-04-11T23:39:03Z"/>
    <node id="17721995" lat="50.8065249" lon="-1.0744016">
        <tag k="is_in" v="EnglaHampshire, England, UK"/>
        <tag k="is_in:continent" v="Europe"/>
        <tag k="is_in:country" v="United Kingdom"/>
        <tag k="is_in:country_code" v="GB"/>
        <tag k="is_in:county" v="Hampshire"/>
        <tag k="name" v="Portsmouth"/>
        <tag k="name:ru" v="Портсмут"/>
        <tag k="name:sr" v="Портсмут"/>
        <tag k="place" v="city"/>
        <tag k="population" v="197700"/>
        <tag k="url" v="http://www.visitportsmouth.co.uk"/>
    </node>
</osm> 
```

我确实相信可以用其他搜索功能（例如国名）替换坐标。

编辑：

[http://overpass-api.de/](http://overpass-api.de/)带有查询基地址[http://overpass-api.de/api/（4](http://overpass-api.de/api/)核，64 GB RAM）。 [http://overpass.osm.rambler.ru/](http://overpass.osm.rambler.ru/)带有查询基地址[http://overpass.osm.rambler.ru/cgi/（8](http://overpass.osm.rambler.ru/cgi/)核，64 GB RAM）。

两台服务器每天的总容量约为 1.000.000 个请求。当您每天执行的查询少于 10.000 次或每天下载少于 5 GB 的数据时，您可以放心地假设您不会打扰其他用户。

# css - 根据值更改 css 类

> ID：15960322
> 
> 赞同：0
> 
> 时间：2013-04-11T22:59:49.260
> 
> 标签：css, razor

我花了一段时间才决定发布这个问题，因为我不想与愚蠢的问题纠缠。但在我的网页浏览中无法真正看到答案。

在 Razor 视图中。我有一个要显示的字符串列表（它们是已知的，但很多），我想把它们放在不同的颜色中。为了避免重复我想使用这个

```
@foreach (var planGroup in Model.Plans)
{
  <h2 class= "@planGroup.Key" >@planGroup.Key</h2>
  @* .... *@
} 
```

它有效，但有更清洁的方法吗？我在考虑数据注释和 Jquery，但据我所知，它甚至更脏，不是吗？除此之外还有很多事情要做。

谢谢

# jquery - JQuery 数据表搜索问题

> ID：15960326
> 
> 赞同：2
> 
> 时间：2013-04-11T23:00:07.870
> 
> 标签：jquery, search, datatables

我是stackoverflow的新手。

我正在使用 jquery 数据表。我在使用它的搜索功能时遇到了问题。我为每一行添加了一个编辑按钮，并使用 javascript 触发了该事件。在我使用搜索框查找特定项目之前，我的编辑按钮脚本工作正常。结果生成后，编辑按钮不再起作用。

可能有人尝试或经历过这个。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T07:26:18.927

您应该使用数据表函数[fnDrawCallback](http://datatables.net/usage/callbacks)：

```
"fnDrawCallback": function( oSettings ) {
    //put some code here for add buttons
} 
```

每次绘制数据表内容后都会触发此函数 - 初始化时，排序/过滤后

# python - ZeroMQ -> Excel RTD 服务器.. 有那么难吗？

> ID：15960327
> 
> 赞同：2
> 
> 时间：2013-04-11T23:00:14.960
> 
> 标签：python, excel, zeromq, rtd

我只是从 zeromq 开始。我现在有各种平台/语言可以很好地相互交谈，我必须承认 - 它做得非常好。

我想做的最后一块拼图是（作为标题）。很简单，在excel中创建一个单元格

`=RTD(RealTimeServerProgID,ServerName,Topic1,[Topic2], ...)`

这只是与服务器名称（即主机/端口）对话并根据请求订阅主题的更新。

现在……我没那么骄傲。如果有 excel rtd ->（另一个协议）-> zeromq，我不介意拼凑一些东西。真的，我没有。但是我的 c# 和 ms C++ 不是那么敏锐，所以这就是为什么我要向以前做过的人寻求帮助。我找到了各种示例，但没有一个可以集成来自 zeromq 之类的拉力。我什至考虑过将 zeromq 的 python 绑定与 pyxll 之类的东西结合使用。但我很想从以前做过的人那里找出哪种方式效果最好。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-17T14:27:08.727

对 RTD 和 zmq 都有一些经验。我假设您已经看过 RTD 教程并且知道如何通知客户端等。如果没有，这很简单。

如果我正在设计这个，我将为每个订阅（每个主题 id）设置我的 zmq 队列套接字，以便它们在接收就绪时进行轮询（请参阅[本教程中的轮询部分）。](http://www.codeproject.com/Articles/514959/ZeroMQ-via-Csharp-Multi-part-messages-JSON-and-Syn)您可以设置一个事件处理程序，然后检索数据，更新刷新期间 excel 读取的缓存，然后在您的 excel 回调上调用 notify。

# r - 替换列表中的数组元素 (R)

> ID：15960328
> 
> 赞同：3
> 
> 时间：2013-04-11T23:00:16.133
> 
> 标签：r

好的，情况如下：我有以下数组列表：

```
N <- c('A', 'B', 'C')
ll <- sapply(N, function(x) NULL)
ll <- lapply(ll, function(x) assign("x", array(0, dim = c(2,2)))) . 
```

现在我想用给定的数量替换这些数组中位置 [1,1] 的元素，比如 10。我在做什么，按照这个问题[在这里](https://stackoverflow.com/questions/8751954/apply-function-for-list-of-arrays)。也就是说，我正在执行以下操作：

```
x <- lapply(ll, function(x) {x[1,1] <- 10}), 
```

这应该使 xa 列表包含三个 2x2 数组，其中 [1,1] 元素等于 10，所有其他元素等于 0。而不是那样，我看到的是：

```
> x <- lapply(ll, function(x) {x[2,1] <- 10})
> x
$A
[1] 10

$B
[1] 10

$C
[1] 10 
```

对这里发生的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T23:03:19.580

你没有返回整个向量。因此，返回最后一个参数。也就是说，当你这样做时，

```
x <- lapply(ll, function(x) {x[2,1] <- 10}) 
```

你打算说：

```
x <- lapply(ll, function(x) {x[2,1] <- 10; return(x)}) 
```

如果您不指定返回值，则默认返回最后一个分配的值，即 10。相反，您应该使用`return(x)`或等效`x`地如下所示：

```
x <- lapply(ll, function(x) {x[2,1] <- 10; x})
# $A
#      [,1] [,2]
# [1,]    0    0
# [2,]   10    0
# 
# $B
#      [,1] [,2]
# [1,]    0    0
# [2,]   10    0
# 
# $C
#      [,1] [,2]
# [1,]    0    0
# [2,]   10    0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T15:05:17.033

虽然`apply`通常是首选，但这里有一个替代方案，只是为了拥有一个：

```
for (i in 1:3) ll[[i]][2,1] <- 10 
```

# vba - VBA PowerPoint：使用文本获取所有形状

> ID：15960333
> 
> 赞同：2
> 
> 时间：2013-04-11T23:00:49.030
> 
> 标签：vba, powerpoint

无法完全弄清楚这里出了什么问题。我得到一个未为最后一个 debug.print 行设置的对象变量。注意 - 循环中的 debug.print 行打印良好，并且数组中应该有三个形状（并且 i 在循环结束时位于 3 处）。我想我可能只是不明白数组/变量设置是如何工作的，我是 VBA 的新手（虽然我确实有编程经验）。

```
Dim allShapes As Shapes
Set allShapes = ActivePresentation.Slides(11).Shapes
Dim textShapes() As Shape
ReDim textShapes(0 To 2)
i = 0

For Each thisShape In allShapes
    If thisShape.HasTextFrame Then
        If thisShape.TextFrame.HasText Then
           Debug.Print thisShape.TextFrame.TextRange.Text
           Set textShapes(i) = thisShape
           i = i + 1

           ReDim textShapes(0 To i) As Shape
        End If

     End If
Next thisShape
ReDim textShapes(0 To i - 1)

Debug.Print textShapes(1).TextFrame.TextRange.Text 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T23:06:27.283

`For Each thisShape In allShapes`

是什么`allShapes`？它是在某处声明的吗？

还要保留数组中的形状，您必须使用`Redim Preserve`

这是你正在尝试的吗？这将遍历幻灯片 1 中的所有形状。

```
Sub Sample()
    Dim textShapes() As Shape, i as Long

    ReDim textShapes(0 To 2)

    i = 0

    For Each thisShape In ActivePresentation.Slides(1).Shapes
        If thisShape.HasTextFrame Then
            If thisShape.TextFrame.HasText Then
               Set textShapes(i) = thisShape
               i = i + 1
               ReDim Preserve textShapes(0 To i) As Shape
            End If
         End If
    Next thisShape

    Debug.Print textShapes(1).TextFrame.TextRange.Text
End Sub 
```

也如问题的标题所说`Get all shapes with text`；在这种情况下，您将不得不遍历数组。获取所有带有文本的形状。

# html - 为什么我的 HTML 没有与我的 CSS 链接？

> ID：15960335
> 
> 赞同：1
> 
> 时间：2013-04-11T23:01:10.077
> 
> 标签：html, css, hyperlink

我在我的网站上工作，我的 HTML 没有链接到我的 CSS。有人可以解释一下这个问题吗？

这是我的代码片段。

`<link href="css/style2.css" rel="stylesheet" type="text/css">`

我的文件目录是这样的。

*   /根
    *   /css
        *   样式.css
        *   样式2.css
    *   /html
        *   索引.html
        *   webconfig.html
    *   /图片

这个对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T23:03:54.833

您的当前`href`是一个相对路径，根植于 HTML 文件所在的位置。

您可以使用正确的相对路径...

```
<link href="../css/style2.css" rel="stylesheet" type="text/css"> 
```

或者您可以使用绝对（域根）路径...

```
<link href="/css/style2.css" rel="stylesheet" type="text/css"> 
```

...假设您的网站部署在您的域的根目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:03:18.643

您拥有的链接是相对的，因此它开始在与您的 html 相同的文件夹中查找。您可以使用`/css/style2.css`或使用相对路径来创建 css 的绝对路径`../css/style2.css`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:03:25.643

使用**相对 URL** `<link href="../css/style2.css" rel="stylesheet" type="text/css">`

url **css/style2.css**应该相对于 HTML 文件（包含代码的文件 `<link href="css/style2.css" rel="stylesheet" type="text/css">`）。

`..` 在上面的相对 URL 中表示返回一个文件夹，然后到 css 文件夹 - 在该 css 文件夹中使用 style2.css 文件。

同样`../../`，意味着返回两个文件夹，依此类推。

# java - 在 ANTLR4 中遍历解析树时处理错误的惯用方式是什么？

> ID：15960336
> 
> 赞同：1
> 
> 时间：2013-04-11T23:01:15.583
> 
> 标签：java, error-handling, antlr4

我刚刚开始使用 ANTLR4，并且正在创建一个遍历解析树的侦听器。我还有一个自定义错误侦听器添加了`Parser`实例；在此基础上，我希望在调用期间报告的任何错误`ParseTreeWalker.walk()`也转到解析器的错误侦听器。我突然想到我可以调用`Parser.getErrorListeners()`并将它注入到我的侦听器类中，但我希望有一些更成熟的东西。

当我这样做时，我需要一种在报告错误时确定给定节点的行号和列号的方法。在报告听众或访问者发现的错误时，每个人都会自己动手吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T14:18:50.787

你可以打电话[`Parser.notifyErrorListeners`](http://www.antlr.org/api/Java/org/antlr/v4/runtime/Parser.html#notifyErrorListeners%28java.lang.String%29)。

行号和列号可通过调用`Token.getLine()`和获得`Token.getCharPositionInLine()`。您可以通过调用来检索与解析树中的`Token`任何关联的实例。`TerminalNode``TerminalNode.getSymbol()`

# smalltalk - 一旦 renderContenOn: 在 smalltalk 中更新页面的内容

> ID：15960337
> 
> 赞同：3
> 
> 时间：2013-04-11T23:01:25.490
> 
> 标签：smalltalk, seaside

调用后如何更新页面的内容`renderContenOn:`？由于页面已呈现，但是当用户单击提交按钮时，我有一个回调，我需要更新同一页面。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T17:44:24.740

实际上，除非您特别想就地更新，否则您无需执行任何操作。Seaside 在执行操作回调后会自动重新呈现页面。看看[在线海边书籍的](http://book.seaside.st/)**基础**章节。它很好地解释了 Seaside 渲染的工作原理以及处理操作回调后会发生什么。

如果您需要更复杂的更新行为（例如使用 ajax），您可以使用包含的 jQuery-Ajax 绑定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T05:56:27.203

如果保持在同一页面上至关重要，您可能希望使用其中一个 JavaScript 库，例如 jQuery 绑定。

**使用 AJAX**

如果您为 Pharo 或 Squeak 下载或安装了 Seaside，您可以在您的图像中找到 jQuery 示例。使用标准端口时，在`http://localhost:8080/javascript/jquery`或处浏览它们。`http://localhost:8080/javascript/jquery-ui`

其中一个示例是一个简单的 AJAX 组件，它替换或更改当前页面上的内容：

```
JQAjaxFunctionalTest>> renderContentOn: html
    html code id: #logger; with: DateAndTime now.
    html paragraph: [
        html submitButton
            onClick: (html jQuery ajax
                script: [ :s | s << (s jQuery: #logger) html: DateAndTime now ]);
            with: 'Replace'.
        html submitButton
            onClick: (html jQuery ajax
                script: [ :s | s << (s jQuery: #logger) prepend: DateAndTime now ]);
            with: 'Prepend'.
        html submitButton
            onClick: (html jQuery ajax
                script: [ :s | s << (s jQuery: #logger) append: DateAndTime now ]);
            with: 'Append' ] 
```

请注意，您需要为您的应用程序配置一个 jQuery 库，例如使用以下命令：

```
| application |
"your application, eg, when you register it:
application := WAAdmin register: MyRootComponent asApplicationAt: 'myApp'.
"
application preferenceAt: #scriptGeneratorClass put: JQScriptGenerator.
application addLibrary: JQDeploymentLibrary. 
```

这应该足以动态更改当前呈现页面上的内容。

**让 Ajaxifier 为您使用 AJAX**

Seaside 的 jQuery 绑定带有一个*ajaxifier*，它将为您将正常调用转换为 ajax 请求，这样您就不需要自己使用 jQuery。

只需将您的应用程序配置为：

```
| application |
"your application, eg, when you register it:
application := WAAdmin register: MyRootComponent asApplicationAt: 'myApp'.
"
application preferenceAt: #scriptGeneratorClass put: JQScriptGenerator.
application
    preferenceAt: #sessionClass put: WAExpirySession;
    addLibrary: JQDeploymentLibrary;
    addLibrary: JQAjaxifierLibrary/. 
```

并`#call:`照常使用。

# spring - 在测试应用程序和嵌入式tomcat之间共享spring容器

> ID：15960343
> 
> 赞同：0
> 
> 时间：2013-04-11T23:01:44.403
> 
> 标签：spring, spring-test, cucumber-jvm, embedded-tomcat-7

我们正在使用 cucumber-jvm 在我们的应用程序中编写集成测试层。我们发现的挑战之一是管理测试和 Web 应用程序之间的数据库。

一个典型的场景是，我们希望在场景的给定步骤中持久化一些实体，然后在用户界面上执行一些操作，这些操作反过来可能会持久化更多实体。最后，我们要清理数据库。因为 cucumber-jvm 测试在一个 jvm 中，而 Web 应用程序在另一个 jvm 中运行，所以我们不能共享事务（至少以我知道的方式），所以必须手动清理数据库。

我最初的想法是在与 cucumber-jvm 测试相同的 JVM 中使用嵌入式内存数据库 (HSQLDB) 运行的嵌入式 Tomcat 服务器。通过这种方式，我们可以共享一个 spring 容器，并且通过扩展一个事务，可以从中检索所有对象。

在我的初始测试中，Spring 似乎被加载和配置了两次：一次是在测试开始并读取 cucumber.xml 时，第二次是在嵌入式 tomcat 启动并且 Web 应用程序读取其 applicationContext.xml 时。这些似乎在两个完全独立的容器中，因为如果我尝试在一个容器中解析另一个容器中指定的对象，那么它不会解析。如果我复制我的配置，那么我会收到有关具有相同 ID 的重复 bean 的错误。

有没有一种方法可以告诉 Spring 为我的测试应用程序和嵌入式 tomcat 使用相同的容器？

我正在使用 Spring 3.2.2.GA 和 Embedded Tomcat 7.0.39（两个库的最新版本）。

我疯了吗？我需要提供更多技术细节吗？抱歉，如果我使用了一些不正确的术语。

谢谢

ps 如果您对我的问题很熟悉，并且您可以建议我正在尝试的解决方案的替代解决方案，请告诉我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T06:45:31.933

杰夫，

弹簧加载两次是正常的。有两个地方创建了两个 spring 上下文：

1.  在 web.xml 中配置的 servlet 容器监听器 org.springframework.web.context.ContextLoaderListener 中。这个从上下文参数 contextConfigLocation 设置的文件中读取其配置。
2.  在 cucumber-spring 插件 cucumber.runtime.java.spring.SpringFactory 提供的 ObjectFactory 的实现中。这个从 cucumber.xml 读取它的配置。

这两个 spring 上下文完全不同，它们的实例保存在两个不同的地方。作为前者的 servlet 上下文属性，后者由 JavaBackend 保存。

启动嵌入式 tomcat 时，可以访问 servlet 上下文，从而设置我们自己使用 bt tomcat 的 spring 上下文和来自 cucumber 的上下文。但是，spring 有一个名为 WebApplicationContext 的特殊类，用于 servlet 容器中使用的上下文。另一方面，黄瓜 SpringFactory 通过 ClassPathXmlApplicationContext 创建其上下文。因此，除非有一种方法可以从 xml 配置中指定应用程序上下文的类型，否则我们将不得不提供一个用于拍摄 WebApplicationContext 的 ObjectFactory。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T01:56:14.323

我们可以做的是有两个web.xml。一种用于正常，一种用于测试。对于测试，我们使用我们的 ContexLoader 监听器版本。

# android - Google maps api v2 Android 未在 locationListener 上更新

> ID：15960346
> 
> 赞同：1
> 
> 时间：2013-04-11T23:02:03.973
> 
> 标签：android, google-maps

我现在正在寻找为什么我的 Google Map v2 没有收到任何更新。

我一直在阅读/寻找几种解决方案，但无法找到解决方案。因此，我不认为这个话题是重复的。因为我还没有找到解决方案。

我现在使用的代码来自以下主题：[https ://stackoverflow.com/a/14305851/1364241](https://stackoverflow.com/a/14305851/1364241)

```
public class RouteGroupMapActivity extends SherlockFragmentActivity {

private ActionBar actionbar;
private GoogleMap mMap;
private FollowMeLocationSource followMeLocationSource;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_route_group_map);
    //Activate ActionBar Sherlock
    actionbar = getSupportActionBar();
    actionbar.setHomeButtonEnabled(true);
    actionbar.setDisplayOptions(ActionBar.DISPLAY_HOME_AS_UP|ActionBar.DISPLAY_SHOW_HOME|ActionBar.DISPLAY_SHOW_TITLE);

    // creates our custom LocationSource and initializes some of its members
    followMeLocationSource = new FollowMeLocationSource();

    //setUpMapIfNeeded();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.activity_home, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case android.R.id.home:
        NavUtils.navigateUpFromSameTask(this); //Back button
        return true;
    }
    return super.onOptionsItemSelected(item);
}

@Override
public void onPause() {
    /* Disable the my-location layer (this causes our LocationSource to be automatically deactivated.) */
    mMap.setMyLocationEnabled(false);

    super.onPause();
}

@Override
protected void onResume() {
    super.onResume();
    /* We query for the best Location Provider everytime this fragment is displayed
     * just in case a better provider might have become available since we last displayed it */
    followMeLocationSource.getBestAvailableProvider();

    setUpMapIfNeeded();

    /* Enable the my-location layer (this causes our LocationSource to be automatically activated.)
     * While enabled, the my-location layer continuously draws an indication of a user's
     * current location and bearing, and displays UI controls that allow a user to interact
     * with their location (for example, to enable or disable camera tracking of their location and bearing).*/
    mMap.setMyLocationEnabled(true);
}

/**
 * Sets up the map if it is possible to do so (i.e., the Google Play services APK is correctly
 * installed) and the map has not already been instantiated.. This will ensure that we only ever
 * call {@link #setUpMap()} once when {@link #mMap} is not null.
 * <p>
 * If it isn't installed {@link SupportMapFragment} (and
 * {@link com.google.android.gms.maps.MapView MapView}) will show a prompt for the user to
 * install/update the Google Play services APK on their device.
 * <p>
 * A user can return to this FragmentActivity after following the prompt and correctly
 * installing/updating/enabling the Google Play services. Since the FragmentActivity may not have been
 * completely destroyed during this process (it is likely that it would only be stopped or
 * paused), {@link #onCreate(Bundle)} may not be called again so we should call this method in
 * {@link #onResume()} to guarantee that it will be called.
 */
private void setUpMapIfNeeded() {
    // Do a null check to confirm that we have not already instantiated the map.
    if (mMap == null) {
        // Try to obtain the map from the SupportMapFragment.
        mMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map))
                .getMap();
        // Check if we were successful in obtaining the map.
        if (mMap != null) {

            // Replace the (default) location source of the my-location layer with our custom LocationSource
            mMap.setLocationSource(followMeLocationSource);

            // Set default zoom
            mMap.moveCamera(CameraUpdateFactory.zoomTo(15f));
        }
    }
}

private class FollowMeLocationSource implements LocationSource, LocationListener {

    private OnLocationChangedListener mListener;
    private LocationManager locationManager;
    private final Criteria criteria = new Criteria();
    private String bestAvailableProvider;
    /* Updates are restricted to one every 10 seconds, and only when
     * movement of more than 10 meters has been detected.*/
    private final int minTime = 10000;     // minimum time interval between location updates, in milliseconds
    private final int minDistance = 10;    // minimum distance between location updates, in meters

    private FollowMeLocationSource() {
        // Get reference to Location Manager
        locationManager = (LocationManager) getBaseContext().getSystemService(Context.LOCATION_SERVICE);

        // Specify Location Provider criteria
        criteria.setAccuracy(Criteria.ACCURACY_FINE);
        criteria.setPowerRequirement(Criteria.POWER_LOW);
        criteria.setAltitudeRequired(true);
        criteria.setBearingRequired(true);
        criteria.setSpeedRequired(true);
        criteria.setCostAllowed(true);
    }

    private void getBestAvailableProvider() {
        /* The preffered way of specifying the location provider (e.g. GPS, NETWORK) to use 
         * is to ask the Location Manager for the one that best satisfies our criteria.
         * By passing the 'true' boolean we ask for the best available (enabled) provider. */
        bestAvailableProvider = locationManager.getBestProvider(criteria, true);
    }

    /* Activates this provider. This provider will notify the supplied listener
     * periodically, until you call deactivate().
     * This method is automatically invoked by enabling my-location layer. */
    @Override
    public void activate(OnLocationChangedListener listener) {
        // We need to keep a reference to my-location layer's listener so we can push forward
        // location updates to it when we receive them from Location Manager.
        mListener = listener;

        // Request location updates from Location Manager
        if (bestAvailableProvider != null) {
            locationManager.requestLocationUpdates(bestAvailableProvider, minTime, minDistance, this);
        } else {
            // (Display a message/dialog) No Location Providers currently available.
        }
    }

    /* Deactivates this provider.
     * This method is automatically invoked by disabling my-location layer. */
    @Override
    public void deactivate() {
        // Remove location updates from Location Manager
        locationManager.removeUpdates(this);

        mListener = null;
    }

    @Override
    public void onLocationChanged(Location location) {
        /* Push location updates to the registered listener..
         * (this ensures that my-location layer will set the blue dot at the new/received location) */
        if (mListener != null) {
            mListener.onLocationChanged(location);
        }

        /* ..and Animate camera to center on that location !
         * (the reason for we created this custom Location Source !) */
        mMap.animateCamera(CameraUpdateFactory.newLatLng(new LatLng(location.getLatitude(), location.getLongitude())));
    }

    @Override
    public void onStatusChanged(String s, int i, Bundle bundle) {

    }

    @Override
    public void onProviderEnabled(String s) {

    }

    @Override
    public void onProviderDisabled(String s) {

    }
   }

} 
```

我的权限：

```
<uses-permission android:name="com.wandelen.permission.MAPS_RECEIVE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
<!--
     The following two permissions are not required to use
     Google Maps Android API v2, but are recommended.
-->
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /> 
```

除此之外，我还检查了 android Google Maps 应用程序，它可以毫无问题地接收我的位置。

我也确实在我的 FollowMeLocationSource 的所有函数中设置了断点，但它不会在所有函数中都中断..

我错过了什么？或者我可以尝试什么来接收我当前的加载位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T01:53:42.047

如果您只需要一个一次性位置，我会使用[getLastKnowLocation](http://developer.android.com/reference/android/location/LocationManager.html#getLastKnownLocation%28java.lang.String%29)，`LocationManager`这样您就不会总是无缘无故地运行 GPS。

编辑：

好吧，首先我不明白为什么你需要整个大班才能获得位置。地图本身确实有一个位置监听器

```
GoogleMap map = getMap();
map.setOnMyLocationChangeListener(this); 
```

然后在您的地图片段实现中`OnMyLocationChangeListener`，当您的位置更改以及您想要的首次运行时的初始位置时，您将获得回调。

因此，除非您需要位置管理器的特殊功能，否则该位置类基本上是矫枉过正且无用的。

其次，当您创建`FollowMeLocationSource`课程时，我看不到您请求位置更新的任何地方，这就是它没有被解雇的原因

# javascript - wcf 服务无法从 ie 中运行的 javascript 解析日期时间

> ID：15960348
> 
> 赞同：1
> 
> 时间：2013-04-11T23:02:24.793
> 
> 标签：javascript, .net, vb.net, wcf, internet-explorer

我有一个 WCF 服务，其方法定义如下：

```
<WebGet(), OperationContract()>
    Public Function GetScene(cameraId As Integer, time As Date, bufferSize As Integer) As Scene 
```

和看起来像这样的javascript：

```
time = new Date("04/09/2013 23:59")
$.getJSON('../Services/CameraViewerService.svc/GetPreviousScene', 'cameraId=' + _cameraId + '&time=' + time.toUTCString() + '&bufferSize=20', function () {...}); 
```

在 chrome 和 firefox 中，查询字符串中的日期最终看起来像这样：

`Tue, 09 Apr 2013 23:59:00 GMT`

并且 WCF 服务可以很好地使用它，但是当我使用 Internet Explorer 9 时，查询字符串中的日期如下所示：

`Tue, 9 Apr 2013 23:59:00 UTC`

并且 WCF 服务抛出异常：

`The string was not recognized as a valid DateTime. There is an unknown word starting at index 26.`

让它适用于所有浏览器的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:38:22.650

你可以使用[`toISOString()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/toISOString).

这应该有望解析 OK，因为它是公认的标准日期和时间[格式](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)之一。

在 IE8 和[更早版本](http://www.w3schools.com/jsref/jsref_toisostring.asp) `toISOString()`中不受支持，但我的第一个链接中的 Mozilla 文档有一个示例 shim，如果不支持该功能，您可以使用它。

# c++ - C ++，处理后读取和写入同一文件

> ID：15960349
> 
> 赞同：2
> 
> 时间：2013-04-11T23:02:27.103
> 
> 标签：c++, file, fstream

在处理从 ifstream 读取的字符串后，我正在寻找一个干净的 C++ 解决方案来读取和写入同一个文件。例如，这就是我的想法

```
std::ofstream ofs("test.txt", std::ios_base::app);
std::ifstream ifs("test.txt");
std::string inputLine;
bool skipLine = false;

if (ofs)
{
    while (getline(ifs, inputLine))
    {
        skipLine = processLine(inputLine);

        if (!skipLine)
            ofs << inputLine << std::endl;
    }
} 
```

不幸的是，这不起作用。我打算读取行并在“processLine()”函数中决定我想写回或跳过它。生成的输出内容几乎是输入行的内容减去我要清除的某些行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:57:53.680

我认为你最好的选择是简单地创建一个临时文件，它应该是你的输出文件。要解释您为什么应该这样做，请阅读您的问题下方的评论。

这是一个很好的干净的例子，效果很好：

```
#include <string>
#include <iostream>
#include <fstream>
#include <sys/stat.h>

/*
 * @ FUNCTION: GenerateStr
 * @ PARAMETER(s):
 *      [1st - in] const size_t in_Length = This parameter
 *      take in a size_t, which should be the length of the
 *      generated std::string.
 * @ RETURN VALUE(s):
 *      This function should return the generated
 *      std::string, which was randomized during
 *      the generating process within this function.
 */
std::string GenerateStr( const size_t in_Length ) {
    const std::string Elements =
        "AaBcCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz1234567890$-_";
    std::string FileName = "";

    for( size_t Index = 0; Index != in_Length; ++ Index ) {
        //# Add random characters from Elements.
        FileName += Elements[ rand() % Elements.size() ];
    }

    return FileName;
};

/*
 * @ FUNCTION: FileExists
 * @ PARAMETER(s):
 *      [1st - in] const std::string &in_File = This parameter
 *      takes in a std::string, which should be the
 *      name of the file that will be searched for.
 * @ RETURN VALUE(s):
 *       false = The file does not exists.
 *       true = The file does exists.
 */
bool FileExists( const std::string &in_FileName ) {
    struct stat Buffer;
    return ( stat( in_FileName.c_str(), &Buffer ) != -1 );
};

/*
 * @ FUNCTION: GenerateTempFileName
 * @ PARAMETER(s):
 *      [1st - in] const size_t in_Length = This parameter
 *      takes in a constant size_t value, which should be
 *      length of temporary file name (a.k.a the returned
 *      value).
 * @ RETURN VALUE(s):
 *      This function will return a std::string, which
 *      should be a unique name for the temporary file.
 */
std::string GenerateTempFileName( const size_t in_Length ) {
    std::string TempFileName = "";
    while( FileExists( TempFileName = GenerateStr( in_Length ) + ".tmp" ) );
    return TempFileName;
};

/*
 * @ FUNCTION: OldFileToTempFile
 * @ PARAMETER(s):
 *      [1st - in] const std::string &in_OldFileName = The
 *      name of the old file.
 *      [2nd - in] const std::string &in_TempFileName = The
 *      name of the temporary file.
 * @ RETURN VALUE(s):
 *      1 = An error has occured when attempting to rename the
 *      the old file to a temporary name.
 *      -1 = An error has occured when attempting to rename the
 *      temporary file to the original name of the old file,
 *      which is in_OldFileName.
 *      -2 = This is only a warning, although this function
 *      successfully renamed the temporary file to the original
 *      name of the old file, it failed to delete the old file.
 *      0 = Successfully renamed the temporary file to
 *      in_OldFileName and deleted the old file.
 */
short OldFileToTempFile( const std::string &in_OldFileName,
                         const std::string &in_TempFileName )
{
    //# Generate a temporary name for the old file.
    const std::string OldFileTmpName = GenerateTempFileName( 15 );

    //# Rename the old file to a temporary name. Why? So we can rename
    // it back to its original name incase it failed to rename the
    // temporary file.
    if( std::rename( in_OldFileName.c_str(), OldFileTmpName.c_str() ) != 0 ) { 
        return 1;
    }

    //# If we successfully renamed the old file to a temporary name,
    //  we shall then attempt to rename the temporary file to the original
    //  name of the old file.

    //# Attempt to rename the temporary file. If we fail, we shall rename
    //  the old file back to its original name.
    if( std::rename( in_TempFileName.c_str(), in_OldFileName.c_str() ) != 0 ) {
        std::rename( OldFileTmpName.c_str(), in_OldFileName.c_str() );
        return -1;
    }

    //# Now if we successfully renamed the temporary file,
    //  we can go ahead and delete the old file. If failed,
    //  we shall return -2, which should only be a warning
    //  that we failed to delete the old file.
    if( std::remove( OldFileTmpName.c_str() ) != 0 ) {
        return -2;
    }

    return 0;
};

//# I wrote this function so it can instruct function ProcessFile to either skip
//  the current line (in_Line) or to output the line to the temporary file. But
//  mainly because, I did not know what your function processLine was actually
//  doing.
bool ProcessLine( std::string &in_Line ) {
    //# If in_Line is equal to "SkipThisLine", we shall return true,
    //  which means to skip the line. Else, it will return false,
    //  which simply means to no skip the line.
    return ( in_Line == "SkipThisLine" );
};

/*
 * @ FUNCTION: Example
 * @ DESCRIPTION:
 *   This function is an example of how to read and write a file and also
 *   to answer the question above.
 */
bool Example() {
    //# Attempt to open InFile (Test.txt).
    std::ifstream InFile( "Test.txt" );

    //# Return false if we are unable to open InFile.
    if( ! InFile.is_open() ) {
        std::cerr << "\nUnable to open file: Test.txt\n";
        return false;
    }

    //# Generate a unqiue name for the temporary file.
    const std::string TempFileName = GenerateTempFileName( 15 );

    //# Create temporary file.
    std::ofstream TempFile( TempFileName );

    std::string InLine = "";

    //# Begin processing each lines within InFile.
    while( std::getline( InFile, InLine ) ) {
        //# Process the line and check if we are suppose to skip it or not.
        if( ! ProcessLine( InLine ) ) {
            //# If we do not skip the line, we shall then write it to the
            //  temporary file (TempFile).
            TempFile << InLine << std::endl;
        }
    }

    //# Now that we are done with InFile, we can
    //  close both InFile and TempFile and continue
    //  to the next set of steps.
    InFile.close();
    TempFile.close();

    //# Attempt to rename the temporary file to Test.txt.
    short Error = OldFileToTempFile( "Test.txt", TempFileName );

    //# Check if there are no error or if the error is -2\. 
    //  The -2 means that we successfully renamed the temporary
    //  file but we were unable to delete the old file.
    if( Error == 0 || Error == -2 ) {
        return true;
    }

    //# Failed to rename temporary file.
    return false;
};

int main() {

    if( Example() ) {
        std::cout << "Success!" << std::endl;
    } else { std::cout << "Failed!" << std::endl; }

    ::getchar();
    return 0;
}; 
```

请务必阅读评论，它们真的很有帮助！:)

由于@Michael Anderson 在下面的评论，我做了一些重要的改变，我们可以感谢他。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T01:15:37.223

这是一个使用您可以使用的随机访问方法的想法。它会在最后留下尾随的旧数据，根据您的应用程序，您可以忽略或删除这些数据。是否正确取决于线条是否全部相同。但是，这应该删除您要跳过的行。

```
char buffer[10];
fstream fs("test.txt");
std::string inputLine;
bool skipLine = false;
long nextRead, nextWrite;
int skippedLines = 0;

if (fs)
{
    while (!fs.eof())
    {

        if (!skipLine && skippedLines == 0)
            nextWrite = fs.tellg();
        getline(fs, inputLine);

        nextRead = fs.tellg();
        if (fs.eof()) break;

        cout << inputLine << endl;
        skipLine = processLine(inputLine);

        if (!skipLine) {
            fs.seekp(nextWrite);
            fs << inputLine << std::endl;

            if (skippedLines > 0) {
                nextWrite = fs.tellp();
            }

            fs.seekg(nextRead);
            if (fs.eof()) break;
        } else {
            fs.seekg(nextRead);
            skippedLines++;
        }
    }
} 
```

# r - 具有基于时间的窗口的不规则时间序列上的优化滚动函数

> ID：15960352
> 
> 赞同：26
> 
> 时间：2013-04-11T23:02:45.467
> 
> 标签：r, time-series, zoo

是否有某种方法可以使用 rollapply（来自`zoo`包或类似的东西）优化函数（`rollmean`等`rollmedian`）来计算具有基于时间的窗口的滚动函数，而不是基于多个观察值的滚动函数？我想要的很简单：对于不规则时间序列中的每个元素，我想计算一个具有 N 天窗口的滚动函数。也就是说，该窗口应包括当前观察前 N 天的所有观察。时间序列也可能包含重复项。

下面是一个例子。给定以下时间序列：

```
 date  value
 1/11/2011      5
 1/11/2011      4
 1/11/2011      2
 8/11/2011      1
13/11/2011      0
14/11/2011      0
15/11/2011      0
18/11/2011      1
21/11/2011      4
 5/12/2011      3 
```

具有 5 天窗口的滚动中位数，向右对齐，应导致以下计算：

```
> c(
    median(c(5)),
    median(c(5,4)),
    median(c(5,4,2)),
    median(c(1)),
    median(c(1,0)), 
    median(c(0,0)),
    median(c(0,0,0)),
    median(c(0,0,0,1)),
    median(c(1,4)),
    median(c(3))
   )

 [1] 5.0 4.5 4.0 1.0 0.5 0.0 0.0 0.0 2.5 3.0 
```

我已经找到了一些解决方案，但它们通常很棘手，这通常意味着缓慢。我设法实现了自己的滚动函数计算。问题在于，对于很长的时间序列，中位数（rollmedian）的优化版本可能会产生巨大的时间差异，因为它考虑了窗口之间的重叠。我想避免重新实现它。我怀疑rollapply参数有一些技巧可以使它起作用，但我无法弄清楚。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-12-26T13:54:43.637

从 v1.9.8 版本开始（CRAN 2016 年 11 月 25 日），[data.table](/questions/tagged/data.table "显示标记为“data.table”的问题")已获得执行可在此处使用*的非 equi 连接的能力。*

OP已要求

> 对于不规则时间序列中的每个元素，我想计算一个具有 N 天窗口的滚动函数。也就是说，该窗口应包括当前观察前 N 天的所有观察。时间序列也可能包含重复项。

请注意，OP 已要求在当前*观察*前 N 天包括所有观察结果。*这与请求当天*前 N 天的所有观察结果不同。

对于后者，我希望*有一个*值`1/11/2011`，即`median(c(5, 4, 2))`= 4。

显然，OP 期望基于*观察*的滚动窗口限制为 N 天。因此，非等连接的连接条件也必须考虑行号。

```
library(data.table)
n_days <- 5L
setDT(DT)[, rn := .I][
  .(ur = rn, ud = date, ld = date - n_days), 
  on = .(rn <= ur, date <= ud, date >= ld),
  median(as.double(value)), by = .EACHI]$V1 
```

> ```
> [1] 5.0 4.5 4.0 1.0 0.5 0.0 0.0 0.0 2.5 3.0 
> ```

* * *

为了完整起见，基于*天*的滚动窗口的可能解决方案可能是：

```
setDT(DT)[.(ud = unique(date), ld = unique(date) - n_days), on = .(date <= ud, date >= ld), 
   median(as.double(value)), by = .EACHI] 
```

> ```
>  date       date  V1
> 1: 2011-11-01 2011-10-27 4.0
> 2: 2011-11-08 2011-11-03 1.0
> 3: 2011-11-13 2011-11-08 0.5
> 4: 2011-11-14 2011-11-09 0.0
> 5: 2011-11-15 2011-11-10 0.0
> 6: 2011-11-18 2011-11-13 0.0
> 7: 2011-11-21 2011-11-16 2.5
> 8: 2011-12-05 2011-11-30 3.0 
> ```

### 数据

```
library(data.table)
DT <- fread("      date  value
 1/11/2011      5
 1/11/2011      4
 1/11/2011      2
 8/11/2011      1
13/11/2011      0
14/11/2011      0
15/11/2011      0
18/11/2011      1
21/11/2011      4
 5/12/2011      3")[
   # coerce date from character string to integer date class
   , date := as.IDate(date, "%d/%m/%Y")] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-24T13:10:36.667

**1）rollapply**没有检查速度，但如果没有日期超过出现次数，那么它必须是最后 5 * max.dup 条目包含最后 5 天，因此传递给下面显示`max.dup`的单行函数将执行此操作：`fn``rollapplyr`

```
k <- 5

dates <- as.numeric(DF$date)
values <- DF$value

max.dup <- max(table(dates))

fn <- function(ix, d = dates[ix], v = values[ix], n = length(ix)) median(v[d >= d[n]-k])

rollapplyr(1:nrow(DF), max.dup * k, fn, partial = TRUE)
## [1] 5.0 4.5 4.0 1.0 0.5 0.0 0.0 0.0 2.5 3.0 
```

**2) sqldf**我们可以使用 SQL 自连接来做到这一点。我们在不超过 5 天前将`a`这些行加入到每一行，然后按行分组，取加入行的中位数。`b``a``b`

```
library(sqldf)

k <- 5
res <- fn$sqldf("select a.date, a.value, median(b.value) median
       from DF a
       left join DF b on b.date between a.date - $k and a.date and b.rowid <= a.rowid
       group by a.rowid") 
```

给予：

```
res$median
## [1] 5.0 4.5 4.0 1.0 0.5 0.0 0.0 0.0 2.5 3.0 
```

**注意：**我们将其用于`DF`：

```
 Lines <- "
      date  value
 1/11/2011      5
 1/11/2011      4
 1/11/2011      2
 8/11/2011      1
13/11/2011      0
14/11/2011      0
15/11/2011      0
18/11/2011      1
21/11/2011      4
 5/12/2011      3
"
DF <- read.table(text = Lines, header = TRUE)
DF$date <- as.Date(DF$date, format = "%d/%m/%Y") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-10-27T11:34:22.307

我建议使用经过优化的[runner](https://cran.r-project.org/web/packages/runner/index.html)包来执行本主题中要求的操作。**根据**[文档](https://gogonzo.github.io/runner/)中的日期转到 Windows 部分，以获取进一步说明。

为了解决您的任务，可以使用`runner`可以在正在运行的窗口中执行任何 R 函数的函数。此处单线：

```
df <- read.table(
  text = "date  value
   2011-11-01      5
   2011-11-01      4
   2011-11-01      2
   2011-11-08      1
   2011-11-13      0
   2011-11-14      0
   2011-11-15      0
   2011-11-18      1
   2011-11-21      4
   2011-12-05      3", header = TRUE, colClasses = c("Date", "integer"))

library(runner)
runner(df$value, k = 5, idx = df$date, f = median)
[1] 5.0 4.5 4.0 1.0 0.0 0.0 0.0 0.0 2.5 3.0 
```

* * *

PS 一应该知道，5 天窗口`[i-4, i-3, i-2, i-1, i]`而不是`(i-5):i`（6 天窗口）。下面的插图可以更好地解释这个概念。
我在 5 天窗口上做了示例，但如果想按照 OP 的要求重现结果，可以指定 6 天窗口：

[![运行日期窗口](https://i.stack.imgur.com/2nDAm.png)](https://i.stack.imgur.com/2nDAm.png)

```
identical(
  runner(df$value, k = 6, idx = df$date, f = median),
  c(5.0, 4.5, 4.0, 1.0, 0.5, 0.0, 0.0, 0.0, 2.5, 3.0)
)
# [1] TRUE 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-07T08:23:07.607

大多数答案都建议插入 NA 以使时间序列有规律。但是，在长时间序列的情况下，这可能会很慢。此外，它不适用于不能与 NA 一起使用的功能。

rollapply (zoo package) 的 width 参数可以是一个列表（详见 rollapply 的帮助）。基于此，我编写了一个函数，该函数创建一个列表，用于 rollapply 作为宽度参数。如果移动窗口是时间而不是基于索引的，则该函数提取不规则动物园对象的索引。因此动物园对象的索引应该是实际时间。

```
# Create a zoo object where index represents time (e.g. in seconds) 

d <- zoo(c(1,1,1,1,1,2,2,2,2,2,16,25,27,27,27,27,27,31),     
         c(1:5,11:15,16,25:30,31))

# Create function 

createRollapplyWidth = function(zoodata, steps, window ){   

  mintime =  min(time(zoodata))     

  maxtime =  max(time(zoodata)) 

  spotstime = seq(from = mintime , to = maxtime, by = steps)

  spotsindex = list() 

    for (i in 1:length(spotstime)){
    spotsindex[[i]] =  as.numeric(which(spotstime[i]  <=  time(zoodata) & time(zoodata) < spotstime[i] + window))}

  rollapplywidth = list()
    for (i in 1:length(spotsindex)){
    if (!is.na(median(spotsindex[[i]])) ){ 
      rollapplywidth[[round(median(spotsindex[[i]]))]] = spotsindex[[i]] - round(median(spotsindex[[i]]))}
  }
  return(rollapplywidth)
  }

# Create width parameter for rollapply using function

rollwidth =  createRollapplyWidth(zoodata = d, steps = 5, window = 5) 

# Use parameter in rollapply 

result = rollapply(d, width = rollwidth , FUN =  sum, na.rm = T) 
result 
```

限制：不是基于日期，而是以秒为单位的时间。rollapply 的参数“部分”不起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-24T11:08:10.953

这是我对这个问题的修补。如果那种得到你想要的（我不知道它在速度方面是否令人满意），我可以把它写成更详细的答案（即使它基于@rbatt的想法）。

```
library(zoo)
library(dplyr)

# create a long time series
start <- as.Date("1800-01-01")
end <- as.Date(Sys.Date())

df <- data.frame(V1 = seq.Date(start, end, by = "day"))
df$V2 <- sample(1:10, nrow(df), replace = T)

# make it an irregular time series by sampling 10000 rows
# including allowing for duplicates (replace = T)
df2 <- df %>% 
  sample_n(10000, replace = T)

# create 'complete' time series & join the data & compute the rolling median
df_rollmed <- data.frame(V1 = seq.Date(min(df$V1), max(df$V1), by = "day")) %>% 
  left_join(., df2) %>% 
  mutate(rollmed = rollapply(V2, 5, median, na.rm = T, align = "right", partial = T)) %>% 
  filter(!is.na(V2)) # throw out the NAs from the complete dataset 
```

# php - 列出类别和子类别的逻辑 PHP

> ID：15960362
> 
> 赞同：0
> 
> 时间：2013-04-11T23:03:37.033
> 
> 标签：php, mysql, pdo, iteration

我有一张桌子，里面有或多或少的博客文章。结构如下：

1.  id INT 主键 AUTO_INCREMENT
2.  用户 VARCHAR
3.  标题 VARCHAR
4.  类别 VARCHAR
5.  部分 VARCHAR
6.  post_body 文本
7.  post_date DATETIME

部分字段基本上是一个子类别。我有第二个表的部分：

1.  id INT 主键 AUTO_INCREMENT
2.  section_name VARCHAR
3.  类别 VARCHAR

我一直在尝试做的是在页面上创建一个列表，其结构如下：

**科学**（这是类别）

**地质学**（本第一节）

标题1

标题2

标题3

ETC

**生物学**（第二部分）

标题1

标题2

标题3

ETC

等等，适用于所有科学类别的部分

当用户单击以查看**科学**类别中的文章时，他们会进入此页面。

我已经尝试了很多事情来实现这一点，但都没有成功。获取要显示的部分名称很容易，但是根据从第一个查询中检索到的部分对所有文章标题进行查询是我卡住的地方，所以这是我的代码：

```
if(isset($_GET['cat'])){
    $cat = preg_replace('#[^a-z0-9_]#i','',$_GET['cat']);
    $cat = str_replace('_',' ',$_GET['cat']);
    $stmt = $db->prepare("SELECT section_name FROM sections WHERE category=:cat GROUP BY section_name");
    $stmt->bindValue(':cat',$cat,PDO::PARAM_STR);
    try{
        $stmt->execute();
    }
    catch(PDOException $e){
        echo $e->getMessage();
        $db = null;
        exit();
    }
    while($row = $stmt->fetch(PDO::FETCH_ASSOC)){
        $sectionName = $row[section_name];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:50:39.573

我建议您扩大查询范围，用其部分标记每个标题，然后仅循环遍历标题（表明您何时更改部分）。

```
$stmt = $db->prepare("SELECT section_name FROM sections t1, title FROM posts t2  WHERE t1.category=:cat AND t1.section_name = t2.section GROUP BY section_name"); 
```

现在您已经有了要显示的标题列表，请遍历它们：

```
$currentSection = null;
while($row = $stmt->fetch(PDO::FETCH_ASSOC)){
  $sectionName = $row[section_name];
  if ($sectionName != $currentSection) {
    echo "<h2>".$sectionName."</h2>";
    $currentSection = $sectionName;
  }
  echo "<p>".$row['title']."</p>";
} 
```

您还可以创建一个数组，其中节名称作为键，标题作为嵌套数组的成员。当然，它可能会变得更加复杂，但我希望这能让您很好地了解从哪里开始。

# android - 安卓数据库；解决最后几个错误

> ID：15960369
> 
> 赞同：0
> 
> 时间：2013-04-11T23:04:07.713
> 
> 标签：android, database, syntax-error

我在下面的代码中学习了两个类并将它们合并为一个类。我接近成功，但仍然存在一些错误。我的编程环境告诉我有以下错误：

第 51 行 - 未定义 SQLiteDatabase 类型的方法 open()

第 56 行 - 类型 SQLiteDatabase 的方法 open() 未定义

第 57 行 - SQLiteDatabase 类型的方法 getAllEntries() 未定义

第 98 行 - 无法从 SQLiteOpenHelper 类型对非静态方法 getWritableDatabase() 进行静态引用

第 99 行 - Void 方法不能返回值（我需要在这里返回任何东西吗？）

第 102 行 - 无法从 SQLiteOpenHelper 类型对非静态方法 close() 进行静态引用

我已经尝试重新排列代码以防万一。我不确定当它说“该方法未定义类型 [type]”时是什么意思。使用 Google，我无法确定这些错误消息的含义。

任何帮助将不胜感激。

```
package com.example.databaseProject;

import android.os.Bundle;
import android.app.Activity;
import android.content.*;
import android.content.DialogInterface.*;
import android.database.*;
import android.database.sqlite.*;
import android.util.*;
import android.view.*;
import android.view.View.*;
import android.widget.*;
import android.content.Context;
import android.view.View.onclickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class MainActivity extends Activity {
    private SQLiteDatabase db;
    private DBHelper dbHelper;
    private EditText Quote;
    int id=0;
    public static final String KEY_ROWID="_id";
    public static final String KEY_QUOTE="Quote";
    private static final String TAG="DBAdapter";
    private static final String DATABASE_NAME="Random";
    private static final String DATABASE_TABLE="tblRandomQuotes";
    private static final int DATABASE_VERSION=1;
    private static final String DATABASE_CREATE="create table tblRandomQuotes (_id integer primary key autoincrement, "+"Quote text not null );";
    private Context context;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        //linkingButton
        Button saveButton=(Button)findViewById(R.id.button1);
        //add onclick listener to saveButton
        saveButton.setonclickListener(mAddListener);
        dbHelper=new DBHelper(this);

    }
    //Create an anonymous implementation of onclickListener
    private onclickListener mAddListener = new onclickListener(){
        public void onclick(View v){
            switch(v.getId()){
                case R.id.button1:
                    db.open();  //line 51
                    long id=0;
                    //do something when the button is clicked
                    try{
                        Quote=(EditText)findViewById(R.id.lastName1);
                        db.insertQuote(Quote.getText().toString());  //line 56
                        id=db.getAllEntries();  //line 57
                        Context context=getApplicationContext();
                        CharSequence text="The quote '"+Quote.getText()+"' was added successfully!\nQuotes Total = "+id;
                        int duration=Toast.LENGTH_LONG;
                        Toast toast=Toast.makeText(context, text, duration);
                        toast.show();
                        Quote.setText("");
                    }
                    catch(Exception ex){
                        Context context=getApplicationContext();
                        CharSequence text=ex.toString()+"ID = "+id;
                        int duration=Toast.LENGTH_LONG;
                        Toast toast=Toast.makeText(context, text, duration);
                        toast.show();
                    }
                    db.close();
                    //break;
               }
           }
    };

    public void DBAdapter(Context ctx){//I think this might go up in the constructor
        this.context=ctx;
        dbHelper=new DBHelper(context);
    }
    private class DBHelper extends SQLiteOpenHelper{
        public DBHelper(Context c){
            super(c,DATABASE_NAME,null,DATABASE_VERSION);
        }
        @Override
        public void onCreate(SQLiteDatabase db){
            db.execSQL(DATABASE_CREATE);
        }
        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion){
            Log.w(TAG,"Upgrading database from version "+oldVersion+" to "+newVersion+", which will destroy all old data");
            db.execSQL("DROP TABLE IF EXISTS tblRandomQuotes");
            onCreate(db);
        }
    }
    public void open(){
        db=DBHelper.getWritableDatabase();  //line 98
        return this;  //line 99
    }
    public void close(){
        DBHelper.close();  //line 102
    }
    public long insertQuote(String Quote){
        ContentValues initialValues=new ContentValues();
        initialValues.put(KEY_QUOTE,Quote);
        return db.insert(DATABASE_TABLE,null,initialValues);
    }
    public int getAllEntries(){
        Cursor cursor=db.rawQuery("SELECT COUNT(Quote) FROM tblRandomQuotes", null);
        if(cursor.moveToFirst()){
            return cursor.getInt(0);
        }
        return cursor.getInt(0);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:09:56.367

在 onCreate 中删除`dbHelper=new DBHelper(this);`并添加以下行

```
DBAdapter(this);

open(); 
```

和

```
public void open(){
    db=dbHelper.getWritableDatabase();  //line 98
}

public void close(){
    dbHelper.close();  //line 102
} 
```

你应该把你的数据库代码变成一个类。

# android - 谷歌地图 v2 片段空指针

> ID：15960375
> 
> 赞同：-1
> 
> 时间：2013-04-11T23:05:01.557
> 
> 标签：android, nullpointerexception, fragment, google-maps-api-2, mapfragment

我正在尝试在我的 android 项目中使用 google maps API V2，问题是当我使用从布局中获得的地图时，我得到 NullPointerException。我花了几个小时在互联网上寻找，但我找不到任何东西。我很抱歉，如果它已经被问过。

这是包含片段的布局：

```
<?xml version="1.0" encoding="utf-8"?>

<fragment xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    class="com.google.android.gms.maps.MapFragment" /> 
```

这是我的主要活动：

```
public class MainActivity extends Activity {

private GoogleMap map;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    map = ((MapFragment) getFragmentManager().findFragmentById(R.id.map))
            .getMap();

    Log.d("MAP",map.toString());} 
```

“toString”是为了减少问题。我知道没有任何意义，但它应该工作。这是清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.testgooglemapsv2"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="11"
    android:targetSdkVersion="17" />

<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true" />
<uses-feature android:name="android.hardware.camera" />
<uses-feature android:name="android.hardware.camera.autofocus" />

<uses-permission android:name="android.permission.CAMERA" />

<permission
    android:name="com.example.testgooglemapsv2.permission.MAPS_RECEIVE"
    android:protectionLevel="signature" />

<uses-permission android:name="com.example.testgooglemapsv2.permission.MAPS_RECEIVE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.DISABLE_KEYGUARD" />

<application
    android:allowBackup="true"
    android:configChanges="orientation|keyboardHidden"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <uses-library android:name="com.google.android.maps" />

    <activity
        android:name="com.example.testgooglemapsv2.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="AIzaSyB5tu4v6-jG1eiCKoSxEm_GfSZzAZt73k8" />

    <activity
        android:name="com.example.testgooglemapsv2.CameraActivity"
        android:label="@string/title_activity_camera" >
    </activity>
</application>

</manifest> 
```

这是日志文件：

```
> 04-11 23:31:03.715: E/AndroidRuntime(4209): FATAL EXCEPTION: main
> 04-11 23:31:03.715: E/AndroidRuntime(4209):
> java.lang.RuntimeException: Unable to start activity
> ComponentInfo{com.example.testgooglemapsv2/com.example.testgooglemapsv2.MainActivity}:
> java.lang.NullPointerException 04-11 23:31:03.715:
> E/AndroidRuntime(4209):   at
> android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
> 04-11 23:31:03.715: E/AndroidRuntime(4209):   at
> android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
> 04-11 23:31:03.715: E/AndroidRuntime(4209):   at
> android.app.ActivityThread.access$600(ActivityThread.java:141) 04-11
> 23:31:03.715: E/AndroidRuntime(4209):     at
> android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
> 04-11 23:31:03.715: E/AndroidRuntime(4209):   at
> android.os.Handler.dispatchMessage(Handler.java:99) 04-11
> 23:31:03.715: E/AndroidRuntime(4209):     at
> android.os.Looper.loop(Looper.java:137) 04-11 23:31:03.715:
> E/AndroidRuntime(4209):   at
> android.app.ActivityThread.main(ActivityThread.java:5041) 04-11
> 23:31:03.715: E/AndroidRuntime(4209):     at
> java.lang.reflect.Method.invokeNative(Native Method) 04-11
> 23:31:03.715: E/AndroidRuntime(4209):     at
> java.lang.reflect.Method.invoke(Method.java:511) 04-11 23:31:03.715:
> E/AndroidRuntime(4209):   at
> com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
> 04-11 23:31:03.715: E/AndroidRuntime(4209):   at
> com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560) 04-11
> 23:31:03.715: E/AndroidRuntime(4209):     at
> dalvik.system.NativeStart.main(Native Method) 04-11 23:31:03.715:
> E/AndroidRuntime(4209): Caused by: java.lang.NullPointerException
> 04-11 23:31:03.715: E/AndroidRuntime(4209):   at
> com.example.testgooglemapsv2.MainActivity.onCreate(MainActivity.java:99)
> 04-11 23:31:03.715: E/AndroidRuntime(4209):   at
> android.app.Activity.performCreate(Activity.java:5104) 04-11
> 23:31:03.715: E/AndroidRuntime(4209):     at
> android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
> 04-11 23:31:03.715: E/AndroidRuntime(4209):   at
> android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
> 04-11 23:31:03.715: E/AndroidRuntime(4209):   ... 11 more 04-11
> 23:31:03.724: D/dalvikvm(4209): GC_CONCURRENT freed 206K, 12% free
> 2625K/2956K, paused 70ms+76ms, total 190ms 04-11 23:36:03.855:
> I/Process(4209): Sending signal. PID: 4209 SIG: 9 
```

再次抱歉，如果这似乎是一个轻松的问题，但相信我，我已经尝试过了。谢谢你。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-04-12T21:07:56.337

我找到了解决我的问题的方法。这是因为我想在地图准备好之前拿到地图。所以我像这样修改了我的代码：

```
 @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    F = (MapFragment) getFragmentManager().findFragmentById(R.id.map);
    map = F.getMap();
    while(map==null){

    }
    if(map!=null)   
        Log.d("MAP",map.toString());
      } 
```

它工作得很好:)

# c - 在 C 中解析单词；翻译程序

> ID：15960376
> 
> 赞同：0
> 
> 时间：2013-04-11T23:05:05.197
> 
> 标签：c, parsing, localization

我正在开发一个程序，它将用户（英语）的字符串翻译成西班牙语。对于作业，我得到了一个文件，其中包含 100 个单词的列表及其对应的西班牙语。我已经成功打开了该文件，并将其提供给带有二维数组的字符串。

我遇到的困难是解析单词，这样我就可以找到给定单词的等效版本；任何未给出的单词都应该用星号 (*) 替换。关于如何从用户输入的字符串中解析单词的任何想法？下面是源代码的片段，以节省一些时间。

- 谢谢

```
char readFile[100][25];

fp = fopen("words.dat", "r");

if (fp == NULL){
   printf ("File failed to load\n");
}

//This is how I stored the file into the two dimensional string.
while (fgets(readFile, 100, fp)){
   x++;
}

printf ("User please input string\n");
gets (input); 
```

这就是我所得到的。我注释掉了输出单词的 for 循环，这样我就可以看到单词（出于好奇），它是成功的。文件字符串的格式为（英文单词），（西班牙文单词）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:11:36.937

首先，您声明的数组是 100 个 25 个字符的数组。如果我们谈论“行”，则意味着您有 100 行，其中每行可以是 24 个字符（请记住，我们需要一个额外的终止`'\0'`字符）。如果您想要 25 行，每行 99 个字符，请切换大小的位置。

其次，您一遍又一遍地覆盖数组的相同字节。由于每个子数组实际上只有 25 个字符，因此您最多可以使用该`fgets`调用覆盖其中四个数组。

我建议这样的事情：

```
size_t count = 0;
for (int i = 0; i < sizeof(readFile) / sizeof(readFile[0]) &&
                fgets(readFile[i], sizeof(readFile[i]), fp); i++, count++)
{
} 
```

这将确保您阅读的内容不会超过您可以存储的内容，并自动读入数组中正确的“行”。循环`count`后将包含您阅读的行数。

# java - 如何在 Play 2.1 中正确编写数据库集成测试？

> ID：15960377
> 
> 赞同：1
> 
> 时间：2013-04-11T23:05:06.837
> 
> 标签：java, playframework-2.0, integration-testing

我是 Play 新手！2.1。我正在尝试对我的数据库集成测试进行 TDD。阅读网站上的示例后。我这样写了我的测试。

```
 @Test
    public void shouldGetDealName() {
        running(fakeApplication(), new Runnable() {
            public void run() {
                List books = Book.find.all();
                Assert.assertEquals(books.size(), 1);
            }
        });
    } 

```

我的问题是，我是否需要一直包装代码`running(fakeAppliation()...`？因为如果我在没有 fakeApplication 的情况下运行此代码。它似乎不起作用。如果必须这样，那么在 Java 中是否有更好的方法来做到这一点？每次将代码包装在该块中以进行集成或功能测试对我来说似乎是错误的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T01:35:41.197

您可以这样做，假设您想使用内存数据库并且您希望为每个测试重新创建它：

```
public class ApplicationTest extends WithApplication {
    @Before
    public void setup() {
        start(fakeApplication(inMemoryDatabase(), fakeGlobal()));
    }

    @Test
    public void shouldGetDealName() {
        List books = Book.find.all();
        Assert.assertEquals(books.size(), 1);
    }
} 
```

# ruby-on-rails - 访问 REST 响应数据

> ID：15960379
> 
> 赞同：0
> 
> 时间：2013-04-11T23:05:09.777
> 
> 标签：ruby-on-rails, rest

我正在使用 rest-client gem 和 semrush api 接收字符串响应。如何从字符串访问特定数据？

回复：

```
keyword;Position;Previous Position;Search Volume;CPC;Url;Traffic (%);Traffic Cost (%);Competition;Number of Results;Trends
seo;11;0;90500;10.88;http://www.seobook.com/;6.55;11.32;0.91;839000000;0.00,0.00,0.82,0.82,0.82,0.99,0.99,0.99,0.99,0.99,0.99,0.99
seo tools;1;1;8100;8.89;http://tools.seobook.com/;5.86;8.28;0.94;71100000;0.00,0.00,0.24,0.24,0.30,0.45,0.45,0.36,0.36,0.55,0.99,0.36
seo;12;8;90500;10.88;http://tools.seobook.com/;1.81;3.13;0.91;839000000;0.00,0.00,0.82,0.82,0.82,0.99,0.99,0.99,0.99,0.99,0.99,0.99
seo training;1;1;2400;12.83;http://training.seobook.com/;1.73;3.54;0.93;27100000;0.00,0.00,0.66,0.45,0.55,0.99,0.83,0.83,0.66,0.83,0.83,0.83
seo link building;1;1;2400;12.71;http://www.seobook.com/archives/001792.shtml;1.73;3.50;0.85;30500000;0.00,0.00,0.30,0.11,0.13,0.99,0.43,0.55,0.36,0.55,0.55,0.55
seo tool;1;1;1600;7.96;http://tools.seobook.com/;1.15;1.46;0.82;28000000;0.00,0.00,0.34,0.20,0.30,0.83,0.55,0.55,0.45,0.83,0.83,0.99
seo book;1;1;1600;9.61;http://www.seobook.com/;1.15;1.76;0.30;38300000;0.00,0.00,0.30,0.25,0.34,0.55,0.66,0.83,0.55,0.66,0.99,0.55
free seo tools;1;1;1600;4.59;http://tools.seobook.com/;1.15;0.84;0.90;31500000;0.00,0.00,0.68,0.53,0.53,0.84,0.84,0.99,0.84,0.84,0.84,0.84
seobook;1;1;1000;10.36;http://www.seobook.com/;0.72;1.19;0.02;985000;0.00,0.00,0.55,0.68,0.68,0.68,0.77,0.77,0.77,0.99,0.99,0.99
seo rank checker;1;1;880;4.96;http://tools.seobook.com/firefox/rank-checker/;0.63;0.50;0.73;5470000;0.00,0.00,0.46,0.25,0.31,0.46,0.46,0.99,0.31,0.38,0.31,0.38 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:58:44.710

您可以将响应存储在字符串中（我将简单地调用它`response`），然后逐行拆分字符串。

现在，您可以用分号分隔每一行并将这些值存储在一个数组中。

所以假设我想要这条线的`880`价值`seo rank checker`。

```
line = response.each_line.to_a.last
array = line.split(";")
value = array[3] 
```

# c - 仅在 pthread 中初始化时发生 Segfault

> ID：15960380
> 
> 赞同：-2
> 
> 时间：2013-04-11T23:05:14.397
> 
> 标签：c, multithreading, segmentation-fault, pthreads, stack

我不明白为什么以下伪代码会导致段错误。

使用 pthreads 运行函数我遇到了 SEGFAULT，将整数初始化为零。

当`my_threaded_function`不在线程上下文中或者如果我从主线程调用函数时没有问题。

`rc=0;`SEGFAULT仅在函数内部初始化 bu时不会发生`maze_init`。

我已确认我的堆栈空间不足。但我想不出是什么导致函数在 pthread 内部表现不同（不涉及共享内存），`&aa`无法根据 gdb 访问该地址。

为什么堆栈变量的地址不在堆栈上？

```
int maze_init(Maze*m, char* filename)
{
   FILE *fp;
   int aa, bb, rc; 
   aa = 0;              /// SEGFAULT HERE
   ...
   return 1; 
}

void* my_threaded_function(void* arg)
{ 
   Maze maze;
   int rc;
   rc = 0;

   rc = maze_init(&maze,"test.txt");
   return rc;
   pthread_exit((void*)1);
}

int main(int argc,char** argv){
   pthread_t t;
   pthread_create(&t, NULL, my_threaded_function,(void*)0);
   sleep(10);
} 
```

*   编辑（固定代码错字`return rc`）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T23:07:21.770

> 我已确认我的堆栈空间不足。但我想不出是什么导致函数在 pthread 内部表现不同

好吧，默认情况下，辅助线程的堆栈比“主”线程小。您可以使用 设置大小[`pthread_attr_setstacksize`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_attr_setstacksize.html)。

[TLPI](http://man7.org/tlpi/)说：

> 每个线程都有自己的堆栈，其大小在创建线程时是固定的。在 Linux/x86-32 上，对于除主线程之外的所有线程，每个线程堆栈的默认大小为 2 MB。**主线程有更大的堆栈增长空间**

这就是为什么它在正常调用时会工作而在从辅助线程调用时会失败的原因之一。

# html - IE7一个标签浮动左边的bug

> ID：15960383
> 
> 赞同：0
> 
> 时间：2013-04-11T23:05:33.853
> 
> 标签：html, css, internet-explorer-7

HTML

```
 <a href="#">M1</a>
 <a href="#">M2</a>
 <a href="#">M3</a>
 <a href="#" class="front">FirstONE</a> 
```

CSS

```
a.front{float:left;} 
```

在线示例：http: [//jsbin.com/anirot/2](http://jsbin.com/anirot/2)

其他浏览器都很好，只有**IE7**，外观`front`类不能显示在前面。有什么技巧可以解决吗？我试过显示内联或块，根本没有帮助。甚至`*display:inline, zoom:1`

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:27:31.247

将`front`HTML 中的链接放在其他三个链接之前。如果您需要精确的 HTML 结构，请仅通过 JavaScript 将元素移动到 HTML 中的相应位置（仅适用于 IE7）。

# sql - Magento 模块 SQL/设置资源文件

> ID：15960384
> 
> 赞同：0
> 
> 时间：2013-04-11T23:05:38.513
> 
> 标签：sql, magento, module

我更新了我的模块的 SQL 文件 - 我如何让它自动再次运行而不创建它的新版本？

我正在开发我的第一个模块，只需要调整这个模块，以便它可以为其他人进行新安装。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:13:08.587

当 Magento 自动为设置资源运行 SQL 文件时，它会在`core_resource`表中创建一个条目。

```
mysql> SELECT code,version,data_version FROM core_resource;

adminnotification_setup     1.0.0   1.0.0
admin_setup                 0.7.2   0.7.2
amazonpayments_setup        0.1.2   0.1.2
api_setup                   0.8.1   0.8.1
backup_setup                0.7.0   0.7.0
bundle_setup                0.1.11  0.1.11
... 
```

您需要删除此表中与您的模块相对应的**单行**，然后清除您的 Magento 缓存。这将让您重新运行设置资源 SQL 文件。

**只**删除那一行——如果你删除核心模块的行，将会有很多破碎和哭泣。

# ruby-on-rails - Ruby 只用另一个字符串替换完全匹配的字符串

> ID：15960385
> 
> 赞同：1
> 
> 时间：2013-04-11T23:05:38.993
> 
> 标签：ruby-on-rails, ruby

我该如何解决以下问题？

我有一个像下面这样的 html 字符串：

```
<p>aaa, b aa aaaaa?<br/>Next possible text b bb aa b.</p> 
```

现在我只想替换例如

```
"aaa" 
```

和

```
"<div class='special'>aaa</div>" 
```

替换后的新字符串：

```
<p><div class='special'>aaa</div>, b aa aaaaa?<br/>Next possible text b bb aa b.</p> 
```

所以我想要一个通用替换器，它只替换一个完全匹配的字符串。“aaa”只是一个例子。它也可以是“bb”或“两个词”（=> 两个词，所以我认为 text.split 不起作用）。

有人对这种动态查找、匹配和替换器有想法吗？

我已经尝试过，如下所示：

```
items = ["aaa", "a", "aa", "aa b", "c"]
text = "<p>aaa, b aa aaaaa?<br/>Next possible text b bb aa b.</p>"
words = text.split => ["<p>aaa,", "b", "aa", "aaaaa?<br/>Next", "possible", "text", "b", "bb", "aa", "b.</p>"]
new_words = []

words.each do |w|
   items.each do |item|
     if w == item
       w = '<div class="special">#{item}</div>'
     end
   end
  new_words << w
end
text = new_words.join(" ") 
```

结果：

```
"<p>aaa, b <div class='special'>aa</div> aaaaa?<br/>Next possible text b bb <div class='special'>aa</div> b.</p>" 
```

但它应该是：

```
"<p><div class='special'>aaa</div>, b <div class='special'>aa</div> aaaaa?<br/>Next possible text b bb <div class='special'>aa b</div>.</p>" 
```

我最大的问题是：

*   示例中的特殊字符，例如“,.?()%€” - 字符串末尾的字符 => “aaa”
*   具有相同部分的子字符串 => 像“aaa”和“aa”
*   两个词作为一个项目=>例如示例中的“aa b”

有人有解决我问题的想法吗？

编辑：某些东西只是我的替代品的占位符..我真正的替代品也可能是：

```
%Q( <dfn title="#{strip_tags item.text}">#{item.name}</dfn> ) 
```

item.text 可以是所有内容 => 也可以包含“aaa” item.name 例如“aaa”

所以多个 gsub 也会替换已经替换的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T02:00:27.100

目前尚不清楚是否存在单个实例`aaa`或多个实例，以及您是否希望将它们全部替换，或者只是第一个。

这将只替换第一个：

```
text = "<p>aaa, b aa aaaaa?<br/>Next possible text b bb aa b.</p>"
text.sub(/\b(aaa)\b/, %q"<div class='special'>\1</div>")
=> "<p><div class='special'>aaa</div>, b aa aaaaa?<br/>Next possible text b bb aa b.</p>" 
```

这将替换所有出现：

```
text = "<p>aaa, b aa aaaaa?<br/>Next possible text b bb aa b.</p>" * 2
=> "<p>aaa, b aa aaaaa?<br/>Next possible text b bb aa b.</p><p>aaa, b aa aaaaa?<br/>Next possible text b bb aa b.</p>"

text.gsub(/\b(aaa)\b/, %q"<div class='special'>\1</div>")
=> "<p><div class='special'>aaa</div>, b aa aaaaa?<br/>Next possible text b bb aa b.</p><p><div class='special'>aaa</div>, b aa aaaaa?<br/>Next possible text b bb aa b.</p>" 
```

您可以放入`"aaa"`一个变量并通过将该目标插入到模式中来找到它：

```
target = 'aaa'
text.gsub(/\b(#{ target })\b/, %q"<div class='special'>\1</div>")
=> "<p><div class='special'>aaa</div>, b aa aaaaa?<br/>Next possible text b bb aa b.</p><p><div class='special'>aaa</div>, b aa aaaaa?<br/>Next possible text b bb aa b.</p>" 
```

正则表达式具有`\b`(word-break) 标记，这使得定义单词或子字符串匹配变得容易。您也可以`"aaa"`用多个单词替换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T23:48:18.160

您正在寻找[String#sub](http://ruby-doc.org/core-2.0/String.html#method-i-sub)（不是`gsub`）

```
s = "<p>aaa, b aa aaaaa?<br/>Next possible text b bb aa b.</p>"
# => "<p>aaa, b aa aaaaa?<br/>Next possible text b bb aa b.</p>"
match = "aaa"
# => "aaa"
replacement = "<div class='special'>aaa</div>"
# => "<div class='special'>aaa</div>"
s.sub match, replacement
# => "<p><div class='special'>aaa</div>, b aa aaaaa?<br/>Next possible text b bb aa b.</p>"
"<p><div class='special'>aaa</div>, b aa aaaaa?<br/>Next possible text b bb aa b.</p>" == _
# => true 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T23:36:10.413

我会使用正则表达式，[Rubular](http://rubular.com/)是学习和测试表达式的好地方。有关如何使用 gsub 的更多信息，请查看[Jayfields 博客文章](http://blog.jayfields.com/2006/10/ruby-regular-expression-replace.html)。这可能不适合此问题的所有用例，因此您可能需要对其进行修改。

```
 str.gsub /^<p>a{3}/, "<div class='special'>aaa</div>"

   What this says is starting at the beginning of the string (^) 
   find <p> and 3 assurances of the letter a. 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-11T23:57:09.060

这是您想要的替换方法（当然使用 gsub）：

```
def replacer(orig,pattern,replace)
  orig.gsub(/#{pattern}(\s|\.|,)/,replace+'\1').to_s
end

2.0.0dev :001 > def replacer(orig,pattern,replace)
2.0.0dev :002?>     orig.gsub(/#{pattern}(\s|\.|,)/,replace+'\1').to_s
2.0.0dev :003?>   end
 => nil 
2.0.0dev :004 >  replacer("<p>aaa, b aa aaaaa?<br/>Next possible text b bb aa b.</p>", "aaa", "<div class='special'>aaa</div>")
 => "<p><div class='special'>aaa</div>, b aa aaaaa?<br/>Next possible text b bb aa b.</p>" 
```

# grails - GORM：拥有许多相同的域类

> ID：15960387
> 
> 赞同：2
> 
> 时间：2013-04-11T23:05:45.950
> 
> 标签：grails, grails-orm

只是想知道是否有人可以建议域类模式应该如何。我有一个名为 Category 的域类，但可以有具有相同域（Category）的子类别。例如，电器烤面包机可以在厨房类别下，小电器子类别下。

```
class Category {
   static hasMany = [appliances: Appliance, categories: Category] 
   String name
}

class Appliance {
   static belongsTo = Category
   static hasMany = [categories: Category]
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T02:18:16.983

需要对 Appliance 域类进行小调整。猜一下！！:)

我们不需要`Appliance`for中的 hasMany 关系`categories`。关系是这样的：

```
Category --> SubCategory (type of Category) --> Appliance 
```

一个设备`belongsTo`是父类以及`subCategory`它`Category`本身。因此，belongsTo 关系在设备中就足够了。

改为使用：

```
class Appliance {
   static belongsTo = Category
   String name
}

class Category {
    String name
    static hasMany = [appliances: Appliance, subCategories: Category]
} 
```

这是一个可以更好地理解事物的测试用例：

```
//Category
def kitchen = new Category(name: "Kitchen")
kitchen.save()

//Appliance
def toaster = new Appliance(name: "Toaster")
kitchen.addToAppliances(toaster)
kitchen.save()

//Sub Categories
def electrical = new Category(name:  "Electrical")
//Electrical category is a sub category of Kitchen
kitchen.addToSubCategories(electrical)

//Toaster is an appliance of Category Kitchen and Sub Category Electrical
electrical.addToAppliances(toaster)
kitchen.save()

assert kitchen
assert toaster
assert electrical

assert kitchen.appliances.size() == 1
kitchen.appliances.each{assert it.name == 'Toaster'}

assert kitchen.subCategories.size() == 1
kitchen.subCategories.each {assert it.name == 'Electrical'}

assert electrical.appliances.size() == 1
electrical.appliances.each {assert it.name == 'Toaster'} 
```

如果还不清楚，请告知。

# php - 如何使用 WHERE IN 在 mySQL 查询中返回完全匹配

> ID：15960401
> 
> 赞同：2
> 
> 时间：2013-04-11T23:07:19.470
> 
> 标签：php, mysql

我有一张桌子，我们称之为“桌子”。

它有 2 个字段。我们称它们为“field_1”和“field_2”。

我的桌子看起来像这样：

```
=========================
| field_1   | field_2   |
=========================
| 6         | 2         |
| 6         | 3         |
| 6         | 6         |
| 6         | 7         |
| 20        | 3         |
| 20        | 6         |
| 20        | 7         |
| 6         | 9         |
========================= 
```

我正在尝试做的是使用以下方法获得仅“6”的结果：

```
SELECT DISTINCT field_1 
FROM table 
WHERE field_2 IN (6, 7, 9) 
```

这将返回“6”和“20”。

显然，WHERE IN 没有做我想做的事……我还有什么其他选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:09:19.150

您可以使用以下方法获得结果：

```
select field_1
from yt
where field_2 in (6, 7, 9)
group by field_1
having count(distinct field_2) = 3 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!2/66a3b/1)。`field_2`返回值在`6`、`7`和中的所有行`9`。该`HAVING`子句用于确保您只返回具有全部 3 个`field_2`值的那些。这个问题被称为[关系划分](https://www.simple-talk.com/sql/t-sql-programming/divided-we-stand-the-sql-of-relational-division/)。

# powershell - Powershell 表单 - 更改可见性

> ID：15960403
> 
> 赞同：0
> 
> 时间：2013-04-11T23:07:25.630
> 
> 标签：powershell, user-interface, progress-bar

我有一个简单形式的 powershell 脚本，它正在工作。它运行一个外部应用程序（USMT scanstate / loadstate）并且功能都很好。

然而，当它运行时，用户没有反馈它正在运行，所以最初的用户认为出了点问题。

我在表单底部添加了一个选取进度条以指示它正在运行。

我可以使用：

```
$progressbar1.visible = $False 
```

属性来显示它是否可见，但我不知道如何使这个动态。如果我设置为**false然后使用****.ShowDialog()**调用表单然后尝试稍后将其更改为**True**表单中实际上没有任何变化。

我错过了什么吗？有没有办法动态改变表单对象的可见性？

编辑 :: 将**.Visible**属性更改添加到按钮的**.add_click**中。

```
$buttonYes.add_click({$progressbar1.visible = $True;Action $type;$confirm.Close()}) 
```

这确实会出现进度条，但是 Marquee 没有运行，这很奇怪，所以它只显示一个空白框......

EDIT 2 :: OK 所以看起来它确实有效，但仅在从 ISE 运行时。我已经在另一个系统上尝试过，从命令行或快捷方式运行不起作用。我试过设置**STA**但还是不行，进度条显示，但现在是 Marquee 效果。

# html - 放大html5视频的视频控件

> ID：15960404
> 
> 赞同：2
> 
> 时间：2013-04-11T23:07:33.910
> 
> 标签：html, video

我正在寻找是否有办法放大 html5 视频播放器的视频控件。

现在你在想他为什么要放大这些控件，这很容易我需要移动支持所以我喜欢一些更大的控件

我尝试像这样使用css：

```
video controls{
height: 50px;
} 
```

这不起作用，因为它不是元素

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:12:48.393

在大多数设备上，互联网浏览器应该制作一个适当大小的带有控件的视频框。但是，可以自定义控件。这篇文章很好地解释了如何： http: [//www.inwebson.com/html5/custom-html5-video-controls-with-jquery/](http://www.inwebson.com/html5/custom-html5-video-controls-with-jquery/)

你可以只用 CSS 做一些事情，但对于最重要的改变，你也需要使用 JavaScript。

# javascript - 在 Angular 和 IE8 中使用 $http 请求拒绝访问

> ID：15960407
> 
> 赞同：8
> 
> 时间：2013-04-11T23:08:15.960
> 
> 标签：javascript, node.js, internet-explorer-8, angularjs

我正在尝试让我的 Angular 应用程序执行 $http.get 请求。适用于除 IE8 之外的任何地方。我正在使用最新的 Angular（我认为是 1.0.6）。IE 给出的唯一消息是：TypeError：

访问被拒绝。未定义（在以前的角度是）

我的主机（nodejs）设置为发送 cors 标头：

```
res.header('Access-Control-Allow-Origin', '*'); //config.allowedDomains
res.header('Access-Control-Allow-Credentials', true);
res.header('Access-Control-Allow-Headers', 'X-Requested-With, Content-Type, X-Requested-By');
res.header('Access-Control-Allow-Methods', 'PUT, GET, POST, DELETE, OPTIONS'); 
```

我尝试使用调试工具获取有关错误的更多信息，但是：

Fiddler：不显示 xmlhttprequests - 似乎你可以破解你的 NET 应用程序来解决这个问题，但不确定如何处理我的网页。DebugBar：也不显示这些请求 FirebugLite：我尝试的 2 版本已损坏 - 只是随机错误并且不加载

将主机更改为相同的来源可以解决问题，所以我认为它正在尝试一些东西，但是很难调试。

关于这个的 Angular 帖子似乎已经过时了，我不知道从这里做什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T00:08:40.230

这与 $http 无关。$http 允许您发出 XHR(XDR) 或 JSONP 请求。它没有提供规避浏览器同源策略的机制。

> 将主机更改为相同的来源可以解决问题，所以我认为它正在尝试一些东西，但是很难调试。

这就是你问题的关键。IE8 不能很好地支持跨域资源共享 (CORS)。为了使用 IE8 进行跨域调用，您最好：

1.  使用您的 nodejs 应用程序为您代理请求，让您使用相同的域。
2.  在 $http.get() 请求中使用 JSONP

有许多与 CORS 和 IE8 相关的陷阱，[在此处进行了概述](http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-02T13:30:32.917

我遇到了同样的问题，虽然它可能并不理想，但一种解决方案是将 IE 的“跨域访问数据源”安全设置更改为*Enable*或*Prompt*：

[http://technet.microsoft.com/en-us/library/dd346862.aspx](http://technet.microsoft.com/en-us/library/dd346862.aspx)

就我而言，当我尝试从托管在另一个域上的自己的 API 中获取数据（通过 angular 的 $resource）时，我遇到了同样的事情。在 IE8 和 IE9 中，这些请求将失败，并出现上述错误。更改 IE 中的安全设置以允许跨域数据请求解决了该问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-02T09:24:43.583

AngularJS 不支持 IE<=9 CORS。

根据需要，有一个 github 官方 AngualrJS 网站的链接：

[AngularJS Github 官方讨论](https://github.com/angular/angular.js/pull/11355)

# c# - 蒙面文本框钱

> ID：15960410
> 
> 赞同：2
> 
> 时间：2013-04-11T23:08:25.597
> 
> 标签：c#, c#-4.0, maskedtextbox, money-format, krypton-toolkit

在 C# 中，我使用这个`mask`：

```
$999,999.00 
```

但我需要将数字显示为 $123,123,12。

如果我想输入 99.00，我需要做 000099.00 我不想这样做。

如果我使用这个：

```
$99.00 
```

我不能将数字设为 100.00 美元。如何使用`mask`for 数字，例如：

```
$123,412,341,234.00 
and $99.00
and $9.00

maskedtextbox1.Mask="$999,999.00" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:23:32.597

就我而言，没有办法屏蔽不同长度的条目。看来您需要手动过滤它。

# javascript - 如何在页面刷新时使div的背景颜色随机变化

> ID：15960415
> 
> 赞同：3
> 
> 时间：2013-04-11T23:08:51.880
> 
> 标签：javascript, html, css, header, background-color

这是我在这里的第一个问题，如果我做错了什么，请原谅。我正在做一个网站的布局，我希望标题在用户刷新页面时随机改变颜色。我已经做了一些研究并得到了这些 javascript 代码：

```
<script type="text/javascript">     
        var randnum = Math.random();
        var inum = 2;
        var rand1 = Math.round(randnum * (inum-1)) + 1;
        var colors = new Array;
        colors[1] = "#385c78";
        colors[2] ="#9d302f";
        var color = colors[rand1]
        document.getElementById('navbar').style.backgroundColor = image;    
    </script> 
```

这个在 head 标签里面。它在我想要的两个代码之间选择一个随机的十六进制代码并将其存储在 var 颜色上。

我正在使用的第二个在身体上。

```
<script type="text/javascript">
        //writes "<div id="header" style="background-color:#something">"
        document.write('<div id="header" style="background-color:' + color + '">')
    </script>
        <!-- continuation of div id="navbar" -->
                    *Header code here*
    </div> 
```

问题是这种做法给我带来了一些麻烦，因为 div id="header" 是在 javascript 中编写的。我无法正确包装其他 div，谷歌浏览器的检查元素告诉我正文大小为 1333px x 80px（可以在此处看到[http://puu.sh/2yjKi](http://puu.sh/2yjKi)），准确且只有标题大小，它不包装网站内容的其余部分。所以我的问题是：有没有办法改进该代码？通过 javascript 或类似的方法更改该 div 的背景颜色？

我提前感谢大家阅读并感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-10-07T18:58:42.000

虽然帖子有点旧，但我的回答可能会帮助像我一样登陆这里的其他人！ [演示](http://codepen.io/tusharshukla/pen/BoRMba) HTML：

```
<div style="height:150px">
  <div>
    <h1><center>That's how i change color!!</center></h1>
  </div>
  <br><br>
  <div  class="bordered" id="fancy">
    <center>I behave like a chameleon!!</center>
  </div>
</div> 
```

JS：

```
setInterval(function () { 
  document.getElementById("fancy").style.background= '#'+Math.floor(Math.random()*16777215).toString(16);
  document.body.style.background= '#'+Math.floor(Math.random()*16777215).toString(16);  
}, 1000); 
```

希望这会对某人有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:19:30.533

将您的标头作为普通 HTML 输出，然后使用 JavaScript 更新 onDomReady 的颜色。像这样的东西：

```
$(document).ready(function() {
    var colors = ["#385c78", "#9d302f"],
    selectedColor = colors[Math.floor(Math.random()*colors.length)]
    header = $("div#header");

    header.css("background-color", selectedColor);
}); 
```

[http://jsfiddle.net/ryanbrill/GD3qB/](http://jsfiddle.net/ryanbrill/GD3qB/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-25T10:46:30.430

```
function changecolor() {
    var colors = ["#B40404", "#0000FF", "#FE2E9A", "#FF0080", "#2EFE2E", ];
    var rand = Math.floor(Math.random() * colors.length);
    $('#controls-wrapper').css("background-color", colors[rand]);
    setTimeout('changecolor()', 1000);
} 
```

# c# - 即使重命名队列，如何在 Windows 上唯一标识打印队列？

> ID：15960424
> 
> 赞同：3
> 
> 时间：2013-04-11T23:09:46.187
> 
> 标签：c#, windows, printing

如何唯一且可靠地识别给定服务器上的 Windows 打印队列，包括跨打印队列重命名？

我想处理以下情况：

1.  Jdoe 创建打印机 A
2.  我的程序有时会收集有关打印机 A 的信息
3.  Jdoe 将打印机 A 重命名为打印机 AA
4.  我的程序在某个时候再次收集有关打印机 AA 的信息

如何判断打印机 A 和打印机 AA 是同一台打印机（名称已更改）？

我想在支持 Windows XP/2003 及更高版本的 C# 中执行此操作。

我尝试过的事情：

在 Windows 8/Server 2012 上，我似乎可以通过 WMI 查看 CIM_LogicalDevice->DeviceID 来执行此操作，这似乎在重命名时保持一致，但在早期版本的操作系统中，此属性仅包含队列名称并在队列为重命名。

我还查看了 Win32_PnPEntity 类（不包含 Windows 8 之前的打印机）和 Win32_Printer 类（除了名称之外不包含任何类型的 ID）。

在注册表中 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Print\Printers[打印机名称] 有一个包含 GUID 的 QueueInstanceId 字段，但仅在 Windows 8/Server 2012 中。它不存在于早期的操作系统中。

打印后台处理程序 API 和 GDI 打印 API 似乎都按名称识别队列，所以我在那里没有发现任何有用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:35:22.800

这是我在旧项目中使用的一些代码，用于确定打印机名称和驱动程序名称（以及打印机的其他一些细节）。我不确定匹配驱动程序名称是否足以满足您的需求。我知道我已经在 Win7 上对其进行了测试，并且我大约 80% 确定我在 XP 上对其进行了测试（这是不久前）：

**在系统上返回打印机名称/驱动程序名称的辅助方法：**

```
public static List<PrinterDriverItem> GetCardPrinterList()
{
    List<PrinterDriverItem> returnValue = new List<PrinterDriverItem>();

    uint cbNeeded = 0;
    uint cReturned = 0;
    bool ret = Win32PrintApi.EnumPrinters(Win32PrintApi.PRINTER_ENUM_LOCAL, null, 2, IntPtr.Zero, 0, ref cbNeeded, ref cReturned);

    IntPtr addr = Marshal.AllocHGlobal((int)cbNeeded);
    ret = Win32PrintApi.EnumPrinters(Win32PrintApi.PRINTER_ENUM_LOCAL, null, 2, addr, cbNeeded, ref cbNeeded, ref cReturned);

    if (ret)
    {
        Win32PrintApi.PRINTER_INFO_2[] printerInfo = new Win32PrintApi.PRINTER_INFO_2[cReturned];
        int offset = addr.ToInt32();

        for (int i = 0; i < cReturned; i++)
        {
            printerInfo[i].pServerName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pPrinterName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pShareName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pPortName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pDriverName = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pComment = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pLocation = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pDevMode = Marshal.ReadIntPtr(new IntPtr(offset));
            offset += 4;
            printerInfo[i].pSepFile = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pPrintProcessor = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pDatatype = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pParameters = Marshal.PtrToStringAuto(Marshal.ReadIntPtr(new IntPtr(offset)));
            offset += 4;
            printerInfo[i].pSecurityDescriptor = Marshal.ReadIntPtr(new IntPtr(offset));
            offset += 4;
            printerInfo[i].Attributes = (uint)Marshal.ReadInt32(new IntPtr(offset));
            offset += 4;
            printerInfo[i].Priority = (uint)Marshal.ReadInt32(new IntPtr(offset));
            offset += 4;
            printerInfo[i].DefaultPriority = (uint)Marshal.ReadInt32(new IntPtr(offset));
            offset += 4;
            printerInfo[i].StartTime = (uint)Marshal.ReadInt32(new IntPtr(offset));
            offset += 4;
            printerInfo[i].UntilTime = (uint)Marshal.ReadInt32(new IntPtr(offset));
            offset += 4;
            printerInfo[i].Status = (uint)Marshal.ReadInt32(new IntPtr(offset));
            offset += 4;
            printerInfo[i].cJobs = (uint)Marshal.ReadInt32(new IntPtr(offset));
            offset += 4;
            printerInfo[i].AveragePPM = (uint)Marshal.ReadInt32(new IntPtr(offset));
            offset += 4;

            returnValue.Add(new PrinterDriverItem() { PrinterName = printerInfo[i].pPrinterName, DriverName = printerInfo[i].pDriverName });
        }

    }

    Marshal.FreeHGlobal(addr);

    return returnValue;
} 
```

**Win32PrintApi 类：**

```
public class Win32PrintApi
{
    public const int PRINTER_ENUM_LOCAL = 0x00000002;

    [DllImport("winspool.drv", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern bool EnumPrinters(int Flags, string Name, uint Level, IntPtr pPrinterEnum, uint cbBuf, ref uint pcbNeeded, ref uint pcReturned);

    [StructLayout(LayoutKind.Sequential)]
    public struct PRINTER_INFO_2
    {
        public string pServerName;
        public string pPrinterName;
        public string pShareName;
        public string pPortName;
        public string pDriverName;
        public string pComment;
        public string pLocation;
        public IntPtr pDevMode;
        public string pSepFile;
        public string pPrintProcessor;
        public string pDatatype;
        public string pParameters;
        public IntPtr pSecurityDescriptor;
        public uint Attributes;
        public uint Priority;
        public uint DefaultPriority;
        public uint StartTime;
        public uint UntilTime;
        public uint Status;
        public uint cJobs;
        public uint AveragePPM;
    }
} 
```

编辑：对于它的价值，我只是逐步浏览了这段代码，看看我是否能找到任何独特的东西......这些值中的大多数对我来说都是空的或空白的，但这里有一些东西：

```
Printer Name: XPS Card Printer - NEW 
Driver Name: XPS Card Printer
Port Name: USB DXP01 Port
Attributes: 2624
DevMode: 3562584 
```

不确定这是否会有所帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-11T03:17:54.723

您需要使用的是安装类中的以下功能。

*   [SetupDiGetClassDevs](https://docs.microsoft.com/en-us/windows/desktop/api/setupapi/nf-setupapi-setupdigetclassdevsw)
*   [SetupDiEnumDeviceInfo](https://docs.microsoft.com/en-us/windows/desktop/api/setupapi/nf-setupapi-setupdienumdeviceinfo)
*   [SetupDiGetDeviceRegistryProperty](https://docs.microsoft.com/en-us/windows/desktop/api/setupapi/nf-setupapi-setupdigetdeviceregistrypropertya)
*   [硬件类 ID](https://docs.microsoft.com/en-us/windows-hardware/drivers/install/system-defined-device-setup-classes-available-to-vendors)

这是我编写的粗略示例 Cpp 代码。无论打印机是本地/网络/重定向的 rdp 打印机，即使名称不同，硬件 ID 也将始终相同。

```
#include <Windows.h>
#include <stdio.h>
#include <SetupAPI.h>
#pragma comment(lib, "setupapi.lib")

void PrintPrinterIds(REFGUID ClassGuid)
{
    HDEVINFO hDevInfo = SetupDiGetClassDevs(&ClassGuid, NULL, NULL, DIGCF_PRESENT);
    if (hDevInfo == INVALID_HANDLE_VALUE)
    {
        wprintf(L"Cannot get devices : %d\n", GetLastError());
        return;
    }

    int idx = 0;
    DWORD errorVal = ERROR_SUCCESS;
    while (true)
    {
        SP_DEVINFO_DATA devInfoData = {};
        WCHAR regProp[512];
        devInfoData.cbSize = sizeof(devInfoData);

        if (!SetupDiEnumDeviceInfo(hDevInfo, idx, &devInfoData))
        {
            errorVal = GetLastError();
            break;
        }

        if (!SetupDiGetDeviceRegistryProperty(
            hDevInfo,
            &devInfoData,
            SPDRP_FRIENDLYNAME,
            NULL,
            (PBYTE)regProp,
            sizeof(regProp),
            NULL))
        {
            errorVal = GetLastError();
            break;
        }

        wprintf(L"Friendly name = %s\n", regProp);

        if (!SetupDiGetDeviceRegistryProperty(
            hDevInfo,
            &devInfoData,
            SPDRP_HARDWAREID,
            NULL,
            (PBYTE)regProp,
            sizeof(regProp),
            NULL))
        {
            errorVal = GetLastError();
            break;
        }

        // hardwareId is reg_multi_sz
        // Print all of the hardware ids for this device
        PWCHAR pId = regProp;
        do
        {
            wprintf(L"HardwareId = %s\n", pId);
            pId += wcslen(pId) + 1;
        } while (pId[0] != 0);

        // Point to next device
        idx++;
    }

    if (errorVal != ERROR_NO_MORE_ITEMS)
    {
        printf("Error : %d\n", errorVal);
    }

    SetupDiDestroyDeviceInfoList(hDevInfo);
}

int main()
{
    // {4d36e979-e325-11ce-bfc1-08002be10318}
    static const GUID PrinterClass =
    { 0x4d36e979, 0xe325, 0x11ce, { 0xbf, 0xc1, 0x08, 0x00, 0x2b, 0xe1, 0x03, 0x18 } };
    PrintPrinterIds(PrinterClass);

    // L"{1ed2bbf9-11f0-4084-b21f-ad83a8e6dcdc}"
    static const GUID PrinterQueue =
    { 0x1ed2bbf9, 0x11f0, 0x4084, { 0xb2, 0x1f, 0xad, 0x83, 0xa8, 0xe6, 0xdc, 0xdc } };
    PrintPrinterIds(PrinterQueue);
} 
```

# java - 解析日期为指定的日期提供不同格式的日期。（爪哇）

> ID：15960429
> 
> 赞同：0
> 
> 时间：2013-04-11T23:10:44.433
> 
> 标签：java, date, simpledateformat, date-formatting

我将日期作为字符串（即：2013-04-07 17:20:16.0），我需要创建 Date 对象来表示这些，以便我可以在 JSpinners 中设置日期。

我正在使用它来格式化我得到的日期字符串：

`DateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS");`

我这样使用它：

`df.setLenient(false);`

`Date tempDateOld = new Date();`

`tempDateOld = df.parse("2013-04-07 17:20:16.0");`

然而这：

`System.out.println(tempDateOld.toString());`

给出了这个：

`Sun Apr 07 17:20:16 CAT 2013`

为什么它不只是给我一个日期格式相同的日期？如何获取给定格式的日期并创建具有相同格式日期的 Date 对象。

任何帮助都会挽救我的理智，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:20:34.657

尝试

```
System.out.println(df.format(tempDateOld)); 
```

日期本身不保持格式。

# java - 计算对象执行的功能数量

> ID：15960430
> 
> 赞同：0
> 
> 时间：2013-04-11T23:10:49.300
> 
> 标签：java

我已经创建了这个程序/场景。

创建多个机器人，然后从已创建的房间“逃跑”。我还创建了一个计数器来计算机器人的动作，然后形成一个平均值。

我已经创建了这一切，它只是出于某种原因只想返回 0。它没有抛出任何错误或类似的东西，所以我觉得我错过了一些明显的东西。

以下是代码的两个部分：

```
public static double countingMoves;

.
.
.

public void move() {
super.move();
countingMoves++;
}

public int getRobotMoves() {
return countingMoves;
}

int Counter = EscapeBot.countingMoves/10; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T23:16:13.540

```
int Counter = EscapeBot.countingMoves/10; 
```

**第一点**

您将两个整数相除，如评论中所述，如果结果 < 0，则结​​果为 0。将其中一种类型转换为双精度数。此过程称为[算术提升](http://www.cafeaulait.org/course/week2/21.html)，其中表达式中的每个元素都将其精度增加到具有最高精度的元素。例如：

```
int / int = int
double / double = double
int / double = double
int + String = String 
```

对于您的代码：

```
double Counter = EscapeBox.countingMoves/10.0; 
```

**第二点**

Java 命名约定规定，不是常量的变量或方法的第一个单词必须以小写字母开头。

```
Counter -> counter 
```

**第三点，希望是最后一点**

如果您查看计算平均值的位置，`0.0`实际上是正确的。您在开始时计算平均值，然后再进行任何移动。

```
double Counter = EscapeBot.countingMoves/10.0;
// When computed at the start, this equals:
// double Counter = EscapeBot.countingMoves(0)/10.0 = 0/10.0 = 0.0 
```

出现在任何动作之前。通过将其放在代码的末尾，您应该获得更准确的读数。

# java - 检查用户输入是否只是Java中的整数

> ID：15960434
> 
> 赞同：1
> 
> 时间：2013-04-11T23:11:21.457
> 
> 标签：java, try-catch, user-input

我正在为我的作业做彩票游戏（用户输入 6 个号码，我将生成 8 个唯一的中奖号码，最后 2 个号码是补充的）。我需要帮助检查输入数字是否从 1 到 45 并且输入必须是 int，当输入不是整数时，它会引发错误。

这种编程方式是过程方式，我怎样才能把它变成面向对象的方式？我知道我必须在另一个 java 文件中创建方法，然后将它链接回这个 main。你能建议我怎么做吗？

我尝试过尝试捕获，如果和其他（用于输入检查），但我不知道如何在用户输入在数组中时检查它。谢谢你的帮助。

这是我的代码：

```
class Lottery {

public static void main ( String[] args ) {

    System.out.println("\nWelcome to the Lottery game.");
    System.out.println("You can enter numbers from 1 to 45.");

    // User input into an array
    int[] input = new int[6];

    Scanner scanner = new Scanner(System.in);

    System.out.println("\nPlease enter your 6 lucky numbers: ");
    for(int j = 0; j < 6; j++) {

        input[j]=scanner.nextInt();
    }

    int check = scanner.nextInt();
    if(check < 0 && check > 45) {
        System.out.println("\nERROR: Please enter only numbers from 1 to 45!");
    }

    // Printing out unique winning numbers from random generator
    System.out.println("\nWinning numbers: ");
    MultiRandomGenerator mrg = new MultiRandomGenerator();
    int[] set;

    set = mrg.getSet();
    for (int i = 0; i < set.length; i++) {

        System.out.print(set[i] + " ");
    }

    // Loops for counting how many numbers user has guessed right
    int count = 0; // for 6 numbers
    int scount = 0; // for 2 last supplementary numbers

    for(int i = 0; i < input.length; i++) {

        for(int k = 0; k < set.length; k++) {

            if (k < 6) {

                if (set[k] == input[i]) {

                    count++;
                } else {
                    if (set[k] == input[i]) {

                    scount++;
                    }

                }

            }

        }
    }
    System.out.print("\n\nYou guessed right " + count + " winning numbers.");
    System.out.print("\nYou guessed right " + scount + " suplementary numbers.");

    // If statments for printing out winning prizes
    if (count == 6) {

        System.out.println("\nYou have won 1st price!");
    } if (count == 5 && scount == 1) {

        System.out.println("\nYou have won 2st price!");
    } if (count == 5) {

        System.out.println("\nYou have won 3st price!");
    } if (count == 4) {

        System.out.println("\nYou have won 4st price!");
    } if (count == 3 && scount == 1) {

        System.out.println("\nYou have won 5st price!");
    } if (count == 1 && scount == 2) {

        System.out.println("\nYou have won 6st price!");
    } else {

        System.out.println("\nSorry, you didn't won anything.");
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:35:41.787

通过数组查找无效用户输入的示例代码。

```
set = mrg.getSet();
String[] userDataStatus = new String[45];
for (int i = 0; i < set.length; i++) 
{
    try
    {
        String inputdata = set.get(i);
        if(inputdata != null && inputdata.trim().length() > 0)
        {
            int currentNumber = Integer.parseInt(userdata);
            userDataStatus[i] = "Y";//Y represent valid number
        }
    }
    catch (NumberFormatException ex )
    {
        userDataStatus[i] = "N";//If it throws exception then save as 'N'       
    }
} 
```

使用上面的 String 数组并向用户显示错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:21:38.527

你可以检查你的循环，比如

```
int val;
try
{
   input[j] = Integer.parseInt( scanner.nextString() );
}
catch (NumberFormatException ex )
{

} 
```

# ipython - 如何像在 Mathcad 中一样自动执行 ipython 笔记本单元

> ID：15960436
> 
> 赞同：0
> 
> 时间：2013-04-11T23:11:24.503
> 
> 标签：ipython, ipython-notebook

在 Mathcad Prime 2 中，您具有此功能，如果您更改工作表顶部的任何内容，它会*自动*重新计算受更正影响的所有后续公式。它会计算出哪些公式现在受到此更改的影响，并*仅*重新计算那些公式，而其他所有内容都保持不变。

有没有办法在 ipython 中做同样的事情。如果我更改了一个单元格，ipython 应该首先找出哪些其他单元格现在包含错误的结果并且必须重新计算。然后它应该只自动重新计算那些单元格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T10:57:02.857

Cells/Notebooks 不知道依赖关系，但是你可以使用内核重启，cell run-all 或者 run all-below 来刷新所有的 notebook。

# c++ - 如何在 C 中读取导入目录表

> ID：15960437
> 
> 赞同：7
> 
> 时间：2013-04-11T23:11:29.107
> 
> 标签：c++, import, directory, portable-executable

我正在尝试用 C++ 构建一个 PE 查看器，如果我尝试在导入目录表中输出库的名称，它似乎会崩溃。似乎我没有得到程序使用的 DLL 的正确指针。

```
HANDLE handle = CreateFile("messagebox.exe",GENERIC_READ,0,0,OPEN_EXISTING,
                              FILE_ATTRIBUTE_NORMAL,0);
DWORD size = GetFileSize(handle,NULL);
PVOID virtualpointer = VirtualAlloc(NULL,size,MEM_COMMIT,PAGE_READWRITE);
state = ReadFile(handle,virtualpointer,size,&byteread,NULL);
CloseHandle(handle);
PIMAGE_NT_HEADERS ntheaders = PIMAGE_NT_HEADERS(PCHAR(vpointer) + 
                                     PIMAGE_DOS_HEADER(vpointer)->e_lfanew);
handle = GetCurrentProcess();
DWORD EntryAddr = ntheaders->OptionalHeader.ImageBase + 
                       ntheaders->OptionalHeader.AddressOfEntryPoint;

DWORD importdir = 
       (DWORD) &(ntheaders->OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT]);

DWORD va = (DWORD)(ntheaders->OptionalHeader.ImageBase) + 
                     ((PIMAGE_DATA_DIRECTORY)dwValueB)->VirtualAddress;
LPSTR libname[128];
int i =0;
while(((PIMAGE_IMPORT_DESCRIPTOR)dwValueC)->Name)
{
       // get DLL name
       libname[i] = (LPSTR)(nt->OptionalHeader.ImageBase + 
                         ((PIMAGE_IMPORT_DESCRIPTOR)dwValueC)->Name);
       i++;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-07-03T20:00:56.213

要读取导入目录表中的库名称，您可以执行以下操作：

1.  获取文件的内存映射基地址。
2.  获取指向[IMAGE_NT_HEADERS](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680336%28v=vs.85%29.aspx)结构的指针。
3.  获取指向[IMAGE_SECTION_HEADER](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680341%28v=vs.85%29.aspx)结构的指针。

4.  `DataDirectory`是 OptionalHeader 的最后 128 字节，它又是 PE 头[IMAGE_NT_HEADERS](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680336%28v=vs.85%29.aspx)的最后一个成员。该结构有 2 个成员，其中包含数据结构的位置和大小。如果要查找
    有关 dll 名称的信息，首先`Import Directory`要从. 通过检查 Name 字段指向的字符串，获取与映射图像相关的数组成员。`Data Directory``IMAGE_IMPORT_DESCRIPTOR`

我不会描述可移植可执行文件格式的结构，但您可以查看以下链接：
[Peering Inside the PE](https://msdn.microsoft.com/en-us/library/ms809762.aspx "Win32 可移植可执行文件格式之旅")
[Microsoft Systems Journal](https://www.microsoft.com/msj/backissues86.aspx "1994 年 3 月 — 第 9 卷第 3 期")

您的代码中的某些变量未声明，这很令人困惑，但坚持您的骨架代码，我编写了它以便它满足您的问题。

```
DWORD Rva2Offset(DWORD rva,PIMAGE_SECTION_HEADER psh,PIMAGE_NT_HEADERS pnt);
int _tmain(int argc, _TCHAR* argv[])
{
LPCWSTR fNmae=L"C:\\Windows\\system32\\notepad.exe";
HANDLE handle=CreateFile(fNmae/*"messagebox.exe"*/, GENERIC_READ, 0, 0, OPEN_EXISTING,  FILE_ATTRIBUTE_NORMAL, 0);
DWORD byteread,size=GetFileSize(handle, NULL);
PVOID virtualpointer=VirtualAlloc(NULL, size, MEM_COMMIT, PAGE_READWRITE);
ReadFile(handle, virtualpointer, size, &byteread, NULL);
CloseHandle(handle);
// Get pointer to NT header
PIMAGE_NT_HEADERS           ntheaders=(PIMAGE_NT_HEADERS)(PCHAR(virtualpointer) + PIMAGE_DOS_HEADER(virtualpointer)-> e_lfanew);   
PIMAGE_SECTION_HEADER       pSech=IMAGE_FIRST_SECTION(ntheaders);//Pointer to first section header
PIMAGE_IMPORT_DESCRIPTOR    pImportDescriptor; //Pointer to import descriptor 
__try
{
    if(ntheaders->OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].Size != 0)/*if size of the table is 0 - Import Table does not exist */
    {
        pImportDescriptor = (PIMAGE_IMPORT_DESCRIPTOR)((DWORD_PTR)virtualpointer +\
                            Rva2Offset(ntheaders->OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress,pSech,ntheaders));
        LPSTR libname[256];
        size_t i=0;
        // Walk until you reached an empty IMAGE_IMPORT_DESCRIPTOR
        while(pImportDescriptor->Name != NULL)
        {
            printf("Library Name   :");
            //Get the name of each DLL
            libname[i]=(PCHAR)((DWORD_PTR)virtualpointer + Rva2Offset(pImportDescriptor->Name,pSech,ntheaders));
            printf("%s\n", libname[i]);
            pImportDescriptor++; //advance to next IMAGE_IMPORT_DESCRIPTOR
            i++;

        }

    }
    else
    {
        printf("No Import Table!\n");
        return 1;
    }
}
__except(EXCEPTION_EXECUTE_HANDLER)
{
    if(EXCEPTION_ACCESS_VIOLATION == GetExceptionCode())
    {
        printf("Exception: EXCEPTION_ACCESS_VIOLATION\n");
        return 1;
    }

}
if(virtualpointer)
    VirtualFree(virtualpointer, size, MEM_DECOMMIT);

return 0;
}
 /*Convert Virtual Address to File Offset */
DWORD Rva2Offset(DWORD rva,PIMAGE_SECTION_HEADER psh,PIMAGE_NT_HEADERS pnt)
{
    size_t i = 0;
    PIMAGE_SECTION_HEADER pSeh;
    if(rva == 0)
    {
            return (rva);
    }
    pSeh = psh;
    for(i = 0; i < pnt->FileHeader.NumberOfSections; i++)
    {
            if(rva >= pSeh->VirtualAddress && rva < pSeh->VirtualAddress +
               pSeh->Misc.VirtualSize)
            {
                    break;
            }
            pSeh++;
    }
    return (rva - pSeh->VirtualAddress + pSeh->PointerToRawData);
} 
```

# matlab - MATLAB中的广义逐元素数组复制（每个元素按可变大小复制）

> ID：15960440
> 
> 赞同：2
> 
> 时间：2013-04-11T23:11:53.940
> 
> 标签：matlab, indexing, reshape

这里有一个类似的问题，[Element-wise array replication in Matlab](https://stackoverflow.com/questions/1947889/element-wise-array-replication-in-matlab)，但我想稍微概括一下。简单的情况需要一个函数“replicate”，它需要一个向量 a，然后将每个元素复制一个数字 NEg

```
>> a = [1, 2, 3];
>> replicate(a, 3);
ans = 
  [1, 1, 1, 2, 2, 2, 3, 3, 3]
>> 
```

上面的链接中有许多有用的解决方案。但是，N 是每个元素的多重性向量会发生什么？例如，我想要类似的东西：

```
>> a = [1, 2, 3];
>> N = [3, 1, 5];
>> replicate(a,N)
ans = 
  [1, 1, 1, 2, 3, 3, 3, 3, 3]
>> 
```

不幸的是，我的 MATLAB-index-fu 还没有达到这个水平，如果不循环，比如 N，我无法弄清楚如何做到这一点，然后使用 repmat 将 a 的每个元素平铺成大小 [N (i),1] 向量。例如，我循环遍历数组数据，然后使用 multcol 位置的多重性值对其进行重新格式化。数据是 MCMC 中的步骤，每个步骤的多重性在最后一列。

```
data=[-3.997 4.402 0.000 703.050 -219.900 289.600 2.000 5.700 -49.100 11.100 3;...
-2.476 2.685 0.000 667.800 -220.210 290.000 1.955 5.710 -48.828 11.116 3; ...
-4.658 0.286 0.000 626.370 -220.420 290.380 2.019 5.991 -49.015 11.1210 2];

multcol = 11;

%unwrap the data
in=1;
for i=1:size(data,1)
  data_uw(in:in+data(i,multcol)-1,:) = ...
    repmat(data(i,1:multcol-1),[data(i,multcol) 1]);
  in=in+data(i,multcol);
end 
```

这有效，但相对较慢。最终结果 data_uw 是输入矩阵的每一行数据，在多重性列中被复制的次数。

```
>> data_uw

data_uw =

Columns 1 through 7

-3.9970    4.4020         0  703.0500 -219.9000  289.6000    2.0000
-3.9970    4.4020         0  703.0500 -219.9000  289.6000    2.0000
-3.9970    4.4020         0  703.0500 -219.9000  289.6000    2.0000
-2.4760    2.6850         0  667.8000 -220.2100  290.0000    1.9550
-2.4760    2.6850         0  667.8000 -220.2100  290.0000    1.9550
-2.4760    2.6850         0  667.8000 -220.2100  290.0000    1.9550
-4.6580    0.2860         0  626.3700 -220.4200  290.3800    2.0190
-4.6580    0.2860         0  626.3700 -220.4200  290.3800    2.0190

Columns 8 through 10

  5.7000  -49.1000   11.1000
  5.7000  -49.1000   11.1000
  5.7000  -49.1000   11.1000
  5.7100  -48.8280   11.1160
  5.7100  -48.8280   11.1160
  5.7100  -48.8280   11.1160
  5.9910  -49.0150   11.1210
  5.9910  -49.0150   11.1210 
```

有一个更好的方法吗？也许有一种方法可以调整上面链接中的答案，但我不明白。

**更新答案**

我使用了[http://www.mathworks.co.uk/matlabcentral/fileexchange/6436-rude-a-pedestrian-run-length-decoder-encoder](http://www.mathworks.co.uk/matlabcentral/fileexchange/6436-rude-a-pedestrian-run-length-decoder-encoder)上提供的实用程序粗鲁。

```
mult = data(:,multcol);
data = data(:,1:multcol-1);
iterations = sum(mult);

%preallocate the unwrapped data vector for speed
data_uw = zeros(iterations,multcol-1);
nstep = size(data,1);
ind = 1:nstep;
ind_uw = zeros(iterations,1);
ind_uw = rude(mult,ind);
data_uw = data(ind_uw,:); 
```

这似乎要快得多。粗鲁利用了另一个答案中提到的 cumsum 技术，因此这也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:28:54.790

该算法是运行长度解码，我建议使用[rude()](http://www.mathworks.co.uk/matlabcentral/fileexchange/6436-rude-a-pedestrian-run-length-decoder-encoder "无礼（）")。这是一个里程碑并且写得非常好 MATLAB 代码。

```
>> rude(N,a)
ans =
     1     1     1     2     3     3     3     3     3 
```

但是，在您的情况下，问题应该是预分配（缺少）。预分配和重构代码：

```
% Pre-allocate
out = zeros(sum(data(:,end)),multcol-1);

for i = 1:size(data,1)
    n = data(i,multcol);
    out(in : in+n-1,:) = repmat(data(i,1:end-1),n,1);
    in = in+n;
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:54:01.540

You can use cumsum-based indexing for this kind of thing:

```
A = [4 5 6];
N = [3 1 5];

cs=cumsum(N);
idx = zeros(1,cs(end));
idx(1+[0 cs(1:end-1)]) = 1; #%[1 0 0 1 1 0 0 0 0]
idx = cumsum(idx); #%[1 1 1 2 3 3 3 3 3]

B = A(idx); #%[4 4 4 5 6 6 6 6 6] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:40:13.553

一些简单的事情：

```
a = [1, 2, 3];
N = [3, 1, 5];

result = zeros(1,sum(N)); % mem alloc
k = 1;
for n = 1:numel(N)
        p = k+N(n)-1;
        result(1,k:p) = a(n);
        k = p+1;
end;

disp(result); 
```

# io - 有人可以用大鸟的术语告诉我什么是时钟中断吗？

> ID：15960441
> 
> 赞同：0
> 
> 时间：2013-04-11T23:11:57.287
> 
> 标签：io, interrupt, clock

我也很难理解 I/O 中断是如何工作的，但我对它们的处理比对时钟中断的处理要好。谢谢我的书呆子！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:15:50.803

```
ELMO: la la la laaa, la la laaaa, Elmos....
COUNT: 1 O'clock MUHAHAHA
ELMO: ...song la la la...
COUNT: 2 O'Clock MUHAHAHA
ELMO: ...la la Elmos song 
```

基本上，它是一个由时钟触发的中断，因此您可以根据时钟执行某些操作（例如多任务处理）。

# javascript - 打开/关闭对话框

> ID：15960442
> 
> 赞同：2
> 
> 时间：2013-04-11T23:12:06.320
> 
> 标签：javascript, jquery, jquery-ui

我开始建立点击方式，这样就会有一个盒子。它根本无法工作！当您创建一个帐户并单击“opret_ok”然后单击关闭框/对话框时也是如此。

```
<a href="#" id="contactUs">Oppen</a>                   
    <div id="dialog" style="display:none;">
       <form action="#" method="post" name="opret_nyheder">
            <table>
                <tr>
                    <td>Navn</td>
                    <td><input type="text" name="navn" class="new"></td>
                </tr>
                <tr>
                    <td>Email - Brugernavn</td>
                    <td><input type="email" name="email_indhold" class="new"></td>
                </tr>
                <tr>
                    <td><input type="submit" name="opret_ok" value="Opret Bruger" class="new"></td>
                    <td></td>
                </tr>
            </table>
            <?php
            if(isset($_POST["opret_ok"]))
            {
                $opret_bruger = $mebe->opret_bruger();
            }
            ?>
        </form>
    </div>
    <script>
    $(document).ready(function() {
        $("#contactUs").click(function() {
            $("#dialog").dialog();
            return false;
        });
    });
    </script> 
```

我不会从 jquery 页面中得到任何关于框或样式的信息。我在这里所拥有的只是我在身体外部展示的东西，等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:17:21.213

```
$(document).on('click','input[name="opret_ok"]',function(){
   jQuery('#dialog').dialog('close');
}); 
```

# javascript - If 和 Else 语句错误

> ID：15960443
> 
> 赞同：5
> 
> 时间：2013-04-11T23:12:07.680
> 
> 标签：javascript, html

我最近一直在学习一些基本的 JavaScript，但遇到了一个问题。我的代码如下所示：

```
<html>
     <body>
          <script type="text/javascript">
                 var name= window.prompt("Type Your Name.")
                 if ( (name=='Ethan') )
                    document.write("You LOVE BACON!!!")
                 else
                     document.write("You Have not entered your name in yet.")
          </script>
     </body>
</html> 
```

我的问题是，当我运行代码并输入我的名字时，页面会这样说：

> 你喜欢培根！！！你还没有输入你的名字。

我的 else 语句也与我的 if 语句一起出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T07:15:58.693

```
<html>
     <body>
          <script type="text/javascript">
                 var name = window.prompt("Type Your Name."); // Assignment!
                 if ( name=='Ethan' )
                    document.write("You LOVE BACON!!!");      // Function Call!
                 else
                     document.write("You Have not entered your name in yet."); // Function Call!
          </script>
     </body>
</html> 
```

在这种情况下，在每个函数调用或赋值之后，分号位于每个语句的末尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T07:16:33.367

尝试这个

```
if ( name=='Ethan' ) //see here
                    document.write("You LOVE BACON!!!");      // Function Call!
                 else
                     document.write("You Have not entered your name in yet."); // 
```

# php - 如何连接和存储 MYSQL 列值？

> ID：15960444
> 
> 赞同：1
> 
> 时间：2013-04-11T23:12:21.893
> 
> 标签：php, mysql, concatenation

如何连接多个 SQL 列并将结果存储在结果列中？我目前正在使用以下代码对其进行测试：

```
***TEST.PHP***
<?php
include 'core/init.php';

$result = mysql_query('SELECT concat(q1, q2) as result FROM assessment WHERE assessmentid = 32');
while ($row = mysql_fetch_assoc($result)){
 echo $row['result'];
  }

?> 
```

在我的评估表中，我有以下列：
`assessmentid | q1 | q2 | result`

在 q1 中，q1 中的值为 3，q2 中的值为 5，因此正在回显 35。我不确定如何将此结果添加到我的数据库表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:25:00.063

```
assessmentid | q1 | q2 | result

UPDATE assessment set `result` = CONCAT(`q1`, `q2`) where condition 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:28:17.000

我不认为我完全理解你的问题....如果我不明白也许你可以更好地解释你想要什么？

```
$result = mysql_query('SELECT concat(q1, q2) as result FROM 
assessment WHERE assessmentid = 32');

$q1=mysql_result($result,0,"q1");
$q2=mysql_result($result,0,"q2");

$concat = $q1 . $q2 ;
$query = "INSERT INTO assessment (result) VALUES
('$concat')";
$result = mysql_query($query) or die ("error"); 
```

# html - 在每个页面重新加载/刷新时生成具有特定内容的随机图像

> ID：15960449
> 
> 赞同：0
> 
> 时间：2013-04-11T23:13:01.170
> 
> 标签：html, random

所以我在网站上有一个横幅，但我想让它每次加载页面时都会出现不同的图像。更准确地说，我想要（比如 50）个随机大小（比如从 5 像素到 20 像素大小）的正方形（比如 50 个），位于 750x63 像素帧的随机位置，背景为白色。

最好的方法是什么？我知道一点 JavaScript 和 HTML（并且非常愿意学习更多），但我真的不知道从哪里开始。这是我的个人网页，我希望对其进行一些修饰。现在我拥有的最漂亮的代码是一些用于简单 Lightbox 界面的 JavaScript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T00:14:19.517

哇，这比我预期的要容易和有趣。这是`<body>`我的 HTML 代码部分中的代码，针对 750x80px 框架进行了优化。我从[另一个问题](https://stackoverflow.com/questions/1527803/generating-random-numbers-in-javascript-in-a-specific-range/1527820#1527820)中得到的随机整数生成器。

```
<canvas id="canvas" width="750" height="80"></canvas>
<script type="text/javascript">
  //Random integer generator
  function getRandomInt (min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function draw() {
    var ctx = document.getElementById('canvas').getContext('2d');
    //Loop to make 80 squares
    for (var i=0;i<80;i++) {
      //The x-position of the square, with 5px padding in frame
      var sx = getRandomInt(5,705);
      //The y-position of the square, with 5px padding in frame
      var sy = getRandomInt(5,35);
      //The height of the square, smallest 8x8px, largest 40x40px
      var sh = getRandomInt(8,40);
      //First, create a black square
      ctx.fillStyle = "rgb(0,0,0)";
      ctx.fillRect (sx, sy, sh, sh);
      //Second, create a white square that's 4px shorter and thinner,
      //leaving a boundary of 2px
      ctx.fillStyle = "rgb(255,255,255)";
      ctx.fillRect (sx+2, sy+2, sh-4, sh-4);
    }
  } 

  draw();
</script> 
```

我使用的方法来自[Mozilla 开发者页面](https://developer.mozilla.org/en-US/docs/HTML/Canvas/Drawing_Graphics_with_Canvas?redirectlocale=en-US&redirectslug=Drawing_Graphics_with_Canvas)。结果是这样的：

![结果](https://i.stack.imgur.com/9IXk2.jpg)

万岁！

# c# - HttpClient 和代理与 Windows 8 应用商店应用程序

> ID：15960454
> 
> 赞同：1
> 
> 时间：2013-04-11T23:13:25.587
> 
> 标签：c#, windows-runtime, windows-store-apps, dotnet-httpclient

我们正在创建一个 Windows 应用商店应用程序 (WinRT) 业务线应用程序，该应用程序将安装在需要使用代理连接到 Internet 的网络中的计算机上。我的假设是 HttpClient 使用 IE 中设置的代理信息。这是一个真实的说法吗？

谢谢，斯科特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:28:54.290

根据 MSDN 文档[HttpClientHandler.Proxy](http://msdn.microsoft.com/en-us/library/system.net.http.httpclienthandler.proxy.aspx)：

> 如果在配置文件中未指定代理并且未指定 Proxy 属性，则处理程序使用从本地计算机上的 Internet Explorer 继承的代理设置。

# java - 扫描仪 NextLong() -java 中的输入不匹配错误

> ID：15960457
> 
> 赞同：1
> 
> 时间：2013-04-11T23:13:40.283
> 
> 标签：java

*编辑* 正如标题所述，我无法从任何人那里得到任何意见。它应该回显 InputTypeMismatch 的错误，或者如果你做数字，那么它会说 nullreference 错误。我正在寻找要输入的单词 - 字符串。

有人可以纠正这个吗？这让我发疯。我不知道在哪里检查。

谢谢是提前:)

```
 Exception in thread "main" java.util.InputMismatchException
            at java.util.Scanner.throwFor(Unknown Source)
            at java.util.Scanner.next(Unknown Source)
            at java.util.Scanner.nextFloat(Unknown Source)
            at TestFile.promptsentence(TestFile.java:54)
            at TestFile.main(TestFile.java:43) 
```

这是一个例子：

```
import java.util.*;

public class TestFile{

        public static Scanner inp = new Scanner(System.in);

        public static void main(String[] args){
                long inpu = inp.NextLong();
                // prompts after changing data-type
                String input = Long.valueOf(inp);

                System.out.println(input);

        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:22:02.237

导致的问题`InputMismatchException`是以下行

```
 long inpu = inp.NextLong(); // Not compilable code line 
```

利用

```
 Long inpu = inp.nextLong(); // nextLong() and Long 
```

这是完整的工作代码

```
import java.util.Scanner;

public class TestFile{
    static Scanner inp = new Scanner(System.in);
    public static void main(String[] args){

            //  long inpu = inp.NextLong();
            Long inpu = inp.nextLong();

            //  String input = Long.valueOf(inp);
            String input = String.valueOf(inpu);

            System.out.println(input);
    }
} 
```

**编辑**

> 你能说明如何让我输入 nextString() 而不是 nextLong() 吗？

为此，在 main 方法中使用以下内容来获取字符串作为输入。

```
 String xx = inp.nextLine();
   System.out.println(xx); 
```

您绝对应该查看有关 Scanner 类及其相关方法的以下链接。

[1.类扫描器API](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:17:44.317

您正在尝试从object获取`Long`价值。改为使用。`Scanner``Long.valueOf(inp)``Long.valueOf(inpu)`

无论如何，我建议使用普通的变量名。喜欢`scanner`对象`Scanner`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:19:03.800

这里有几件事是错误的。**编辑**——看起来你的编辑修复了前两个。

```
public class TestFile(){ <--- 
```

应该

```
public class TestFile { 
```

第二，

```
public static main( <-- 
```

应该

```
public static void main 
```

第三

```
Long.valueOf(inp) <--- 
```

应该

```
String.valueOf(inpu); 
```

`Long.valueOf()`-- 这个方法产生一个 Long 对象。如果你想要一个 String 对象，你应该使用`String.valueOf(long);`

# opengl - 以编程方式确定硬件是否支持 OpenGL 功能

> ID：15960463
> 
> 赞同：2
> 
> 时间：2013-04-11T23:13:59.427
> 
> 标签：opengl, graphics, hardware, hardware-acceleration

我对 OpenGL 很陌生，所以这可能很明显，但是是否可以确定给定视频卡是否支持特定功能？这是因为我使用一台带有 ATI Radeon 9550 显卡的旧电脑，运行 Lubuntu 12.10，发现它不支持使用 dFdx 和 dFfy。我能够解决这个问题，但现在我很好奇是否可以找出是否由于此类问题而发生故障，并基于此采取行动，可能使用替代方法等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T01:39:00.367

一般来说，你不能。不是因为你说的那种东西。

`dFdx`并且`dFdy`自 1.10 版（核心 OpenGL 2.0 中的第一个版本）以来一直是 GLSL 的一部分。对它们的支持*不是可选*的。

您的问题是 ATI/AMD 想要声称他们的旧卡支持 2.x，但他们的硬件实际上不能完成 2.x 所需的所有事情。所以他们对此*撒谎*，声称支持，同时默默地进行这些空操作。

OpenGL 没有办法检测背信弃义。您唯一能做的就是保留一张卡片列表并使用`GL_VENDOR`和`GL_RENDERER`字符串进行测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T01:32:34.177

`glGetString(GL_VERSION)`您可以使用或检查支持的 OpenGL 版本`glGetInteverv(GL_MAJOR_VERSION, …); glGetInteverv(GL_MINOR_VERSION, …);`。对于 OpenGL-3 及更高版本，OpenGL 主要版本直接对应于硬件功能。

对于旧版本，事情没有那么严格，并且由于 OpenGL 的抽象设备模型，您无法真正“查询”硬件功能。您可以检查支持哪些扩展，这是支持功能的良好指标，因为许多 ARB 扩展已将其纳入核心功能。如果当前 OpenGL 版本的某个特性所基于的扩展不受支持，那么可能会模拟核心特性。

我知道这是非常模糊和不稳定的，但事实就是如此。唯一的其他选择是保留 GL_RENDERER 字符串的数据库并与之匹配。

# jquery - JSON不会解析

> ID：15960465
> 
> 赞同：0
> 
> 时间：2013-04-11T23:14:04.423
> 
> 标签：jquery, ajax, json

我以前收集过 JSON 响应，但无论我使用什么策略，我都无法从中获取对象！

我的 JSON：

> {节点：[{title：“test”}，{title：“test2”}，{
> 
> 标题：“test3”}，{
> 
> 标题：“test4”}]};

我的JS：

```
 $.post('http://mysite.com/some.php', data,  function (data) {

  for (var i=0, len=data.length; i < len; i++) {

      console.log(data.nodes[i].title);

}; 
```

});

我将整个数据作为 JSON 获取，并且工作正常，但我无法解析其中的对象，我应该如何制定它？我也尝试过使用“FOR”而不是“EACH”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:21:18.613

这些编号的键表明节点容器应该是一个数组，而不是一个对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:29:48.630

我同意@KaeVerens，这是（或曾经是）结构不良的 JSON。除了不是数组的数组之外，还有一个您似乎不需要的额外级别的对象。如果您正在生成 JSON，那么如果改为这样会更有意义：

```
{
    "nodes": [
        { "title": "test", "field2": "test2" },
        { "title": "test3", "field2": "test4" }
    ]
} 
```

好的，现在更新您的 JSON 数据看起来更像这样。但是现在您发布的内容根本不是有效的 JSON！它是一个可以在控制台或测试代码中工作的 JavaScript 对象，但它不会通过[JSON 验证器](http://jsonlint.com/)。属性名称未按应有的方式引用，并且`;`末尾有 a。它应该看起来像：

```
{
    "nodes": [
        { "title": "test" },
        { "title": "test2" },
        { "title": "test3" },
        { "title": "test4" }
    ]
} 
```

（间距和缩进无关紧要；为了清楚起见，我只是以这种方式格式化它。）

无论如何，修复后，此代码可以在您当前的数据上正常工作：

```
$.each( data.nodes, function( index, node ) {    
    console.log( node.title );
}); 
```

如果您检查实际数组`for`的长度而不是检查哪个不存在，您的循环将正常工作：`nodes``data.length`

```
var nodes = data.nodes;
for( var i = 0, len = nodes.length;  i < len;  i++ ) {
    var node = nodes[i];
    console.log( node.title );
} 
```

我建议像这段代码一样引用嵌套对象（`nodes`和`node`变量），而不是像`data.nodes[i]`. 跟踪起来要容易得多，而且效率也更高（尽管在这种简单的情况下并没有什么不同）。

# java - 静电不好吗？如何删除静态变量？

> ID：15960469
> 
> 赞同：1
> 
> 时间：2013-04-11T23:14:37.863
> 
> 标签：java, variables, static, global-variables

我有一些我正在处理的代码。它基本上接受用户输入并创建有向图。一个人可以走一条路，另一个人则相反。输出是他们可以访问的重叠部分。

我几乎所有东西都按照我想要的方式工作，但我担心我所拥有的静态的使用。我似乎没有完全理解它，无论我在哪里看，我都无法找到它的确切用途或如何摆脱它。

有人可以帮我理解什么是静态以及为什么它会有所帮助吗？

另外，将大部分代码从 MAIN 移动到辅助方法会更好吗？如果我这样做，我必须将所有变量从 main 移动到类的顶部，然后它们都必须声明为 static？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T23:21:55.973

一切都必须是静态的原因是因为您没有创建任何对象。如果要通过在 main 方法中调用 new 来创建对象，则可以在该对象上使用非静态变量。这不是一个向您介绍为什么要使用面向对象设计的教程的好地方。您可以在网上找到其中一个来阅读（上面的评论者提供了可能的参考）。但是一切都必须是静态的原因是因为它只是从 main 方法运行，而在 java 中它始终是静态的。如果您要在某处调用 new，则可以使用非静态变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:30:07.507

看起来您的许多静态方法（findNodeInList 等）都将 ArrayList（表示地图）作为它们的第一个参数。因此，您可以拥有一个 Map 类，而不是静态的，它存储节点列表并在它们上有方法。然后 main 方法将读取输入，但不必直接管理任何节点。例如：

```
class Map {
  ArrayList<Node> nodes;
  public void addNode(Node n) { nodes.add(n); }
  public int findNodeInList(String s) { ... }
  ...
  public static void main(String[] args) {
    Map peggyMap = new Map();
    Map samMap = new Map();
    // Read the data
    samMap.add(new Node(...));
  }
} 
```

这可以很好地封装与节点/映射有关的所有内容，而不是与与读取数据有关的内容混在一起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T23:24:56.913

静态使类的所有实例都可以访问方法或变量。这就像一个常数，但对于类。为了更容易理解一些代码将完成工作：

```
public class Example {
  public static int numero;
}

public class Implementation {

  public static void main (String args[]) {
    Example ex1 = new Example();
    Example ex2 = new Example();
    Example.numero=10;
    System.out.println("Value for instance 1 is: " + ex1.numero);
    System.out.println("Value for instance 2 is: " + ex2.numero);
  }
} 
```

运行以下代码将输出：

实例 1 的值为：10 实例 2 的值为：10

因为您将静态变量 numero（意大利语中的数字）设置为 10。

知道了？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T23:21:47.753

如果您要在整个程序中使用类/方法并且您不需要在每次需要使用该方法时创建一个实例，则静态很有用。

例如

```
public class StaticExample {

  public static void reusable() {
  //code here
  }
} 
```

这意味着你可以像这样使用它

```
StaticExample.reusable(); 
```

而且您不必创建这样的实例

```
StaticExample staticExample = new StaticExample();

staticExample.reuseable(); 
```

我希望这可以帮助您决定是否使用静态。

# yii - Yii Crud 未完成

> ID：15960474
> 
> 赞同：0
> 
> 时间：2013-04-11T23:14:52.203
> 
> 标签：yii, crud

对于表用户，我写过

yiic shell 模型用户（它有效） crud 用户

最后一行没有完成

```
>> crud users
  unchanged UseersController.php
  unchanged UsersTest.php
  unchanged create.php
  unchanged update.php
  unchanged index.php
  unchanged view.php 
```

...然后挂起

所以当我去 qdr/index.php?r=words/create

它显示了一些错误，例如

WordsController 找不到请求的视图“_form”。

C:\xampp\htdocs\qdr\framework\web\CController.php(878)

结果应该是这样的——

```
>> crud User
   generate UserController.php
   generate UserTest.php
   mkdir D:/testdrive/protected/views/user
   generate create.php
   generate update.php
   generate index.php
   generate view.php
   generate admin.php
   generate _form.php
   generate _view.php 
```

所以不会创建 _form.php、_view.php 等。

为什么是这样？请给我一个解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:17:39.193

它已弃用，而是使用 gii。向您推荐视频：[http ://www.youtube.com/watch?v=9lyg9qIH7oQ](http://www.youtube.com/watch?v=9lyg9qIH7oQ)

请观看和使用。

谢谢

# c++ - 使用 Visual C++ 从命令行编译

> ID：15960478
> 
> 赞同：0
> 
> 时间：2013-04-11T23:15:09.940
> 
> 标签：c++, visual-studio-2010, makefile

我想避免在 Visual Studio 中创建和构建项目来编译我的程序的麻烦。我只想要一个 Makefile，就像你对 gcc 所做的那样，这样我就可以从命令行编译我的程序。如何才能做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:24:29.220

启动 VS2010 的开发人员命令提示符（我有 VS2012，所以可能名称对您来说略有不同。我的位于“Microsoft Visual Studio 2012->Visual Studio 工具”下的程序菜单上。）这将为您和通常比在标准 cmd.exe 提示符下工作更容易。

写你的makefile。C++ 编译器的名称是 cl。使用 nmake 处理您的 makefile。

如果您需要有关如何创建 makefile 的帮助，请具体询问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:30:50.797

只需编写一个 MAKEFILE，使用它进入目录并输入 cmd.exe 或 IDE 命令提示符：

```
>nmake 
```

（[更多在这里](http://www.wireshark.org/docs/wsdg_html_chunked/ChToolsMSChain.html)）。您也可以仅使用编译器而不使用 makefile 来构建程序：

```
>cl /EHsc simple.cpp 
```

（使用 /EHsc 允许 C++ 异常处理）这将产生可执行文件`simple.exe`（[更多在这里](http://msdn.microsoft.com/en-us/library/ms235639%28v=vs.80%29.aspx)）

# jquery - 如何缩短我的 jQuery 代码段？

> ID：15960479
> 
> 赞同：1
> 
> 时间：2013-04-11T23:15:24.677
> 
> 标签：jquery

我已经尝试了很多来缩短我的片段，但没有什么对我有用。

这里是：

```
var logoTitle = $(".logoTitle");

logoTitle.children(".char3, .char4").delay(300).each(function() {
    $(this).animate({
        'margin-top':'0', 
        'opacity':'1'
    }, 330, "easeOutQuart");
});

logoTitle.children(".char2, .char5").delay(600).each(function() {
    $(this).animate({
        'margin-top':'0', 
        'opacity':'1'
    }, 330, "easeOutQuart");
});

logoTitle.children(".char1, .char6").delay(900).each(function() {
    $(this).animate({
        'margin-top':'0', 
        'opacity':'1'
    }, 330, "easeOutQuart");
}); 
```

我怎样才能缩短这个时间并提高效率？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:22:10.040

如果您希望它立即运行，就像您的原始脚本一样：

```
(function animateLogoChildren(theChildren, theDelay){
    var logoTitle = $(".logoTitle");

    logoTitle.children(theChildren).delay(theDelay).each(function() {
        $(this).animate({
            'margin-top':'0', 
            'opacity':'1'
        }, 330, "easeOutQuart");
    });
})(".char3, .char4", 300); 
```

如果您希望它在通话中运行：

```
function animateLogoChildren(theChildren, theDelay){
    var logoTitle = $(".logoTitle");

    logoTitle.children(theChildren).delay(theDelay).each(function() {
        $(this).animate({
            'margin-top':'0', 
            'opacity':'1'
        }, 330, "easeOutQuart");
    });
}

animateLogoChildren(".char3, .char4", 300);
animateLogoChildren(".char2, .char5", 600);
animateLogoChildren(".char1, .char6", 900); 
```

鉴于我如何清理代码，第二个很可能是您要查找的内容。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:24:09.690

您不需要每个功能。如果您对高效的定义是下载，这将使其更加“高效”。但是在速度方面，您无能为力。

```
var logoTitle = $(".logoTitle");

logoTitle.children(".char3, .char4").delay(300).animate({
        'margin-top':'0', 
        'opacity':'1'
    }, 330, "easeOutQuart");
logoTitle.children(".char2, .char5").delay(600).animate({
        'margin-top':'0', 
        'opacity':'1'
    }, 330, "easeOutQuart");
logoTitle.children(".char1, .char6").delay(900).animate({
        'margin-top':'0', 
        'opacity':'1'
    }, 330, "easeOutQuart"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:24:33.043

我希望制作一个自定义动画功能以允许重用代码，例如：

```
var logoTitle = $(".logoTitle");

$.fn.myAnimate = function(delayTime) { 
    return $(this).delay(delayTime).each(function(){
        $(this).animate({
            'margin-top':'0', 
            'opacity':'1'
        }, 330, "easeOutQuart");
    })
}

logoTitle.children(".char3, .char4").myAnimate(300);
logoTitle.children(".char2, .char5").myAnimate(600);
logoTitle.children(".char1, .char6").myAnimate(900); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T23:25:01.383

试试这个：

```
var logoTitle = $(".logoTitle");

function animate_kids(kids, delay) {
    kids.delay(delay).animate({
            'margin-top': 0,
            'opacity': 1
        }, 330, "easeOutQuart"); 
    });
};

animate_kids(logoTitle.children(".char3, .char4"), 300);
animate_kids(logoTitle.children(".char2, .char5"), 600);
animate_kids(logoTitle.children(".char1, .char6"), 900); 
```

如果您有任何问题，请告诉我。祝你好运！:)

# perl - 如何使用 Test::Unit::Lite 框架运行单个测试？

> ID：15960481
> 
> 赞同：0
> 
> 时间：2013-04-11T23:15:32.177
> 
> 标签：perl, testing

我正在使用 CPAN 中的 Test::Unit::Lite 模块来运行设置如下的测试：

```
t/FooTest.pm
t/BarTest.pm 
```

我一直在使用 Test::Unit::Lite 手册页中的 test.pl 脚本运行所有测试，但是当我迭代测试的功能时，我无法弄清楚如何仅从一个文件运行测试。

[从另一个答案来看](https://stackoverflow.com/questions/1713580/how-can-i-separate-different-sorts-of-perl-tests-so-i-dont-have-to-run-them-all)，似乎只能通过将我的测试移动到子目录或以其他方式修改它们来做到这一点，但如果没有更简单的方法，我会感到惊讶。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T19:49:38.627

想出了如何做到这一点。

在 test.pl 结束时，我换掉了

```
all_tests 
```

并将其替换为

```
if (@ARGV) {
  for my $t (@ARGV) {
    Test::Unit::TestRunner->new->start($t);
  }
} else {
  all_tests;
} 
```

我还必须添加

```
 unshift @INC, File::Spec->catdir($cwd, 't/tlib'); 
```

行后

```
 unshift @INC, File::Spec->catdir($cwd, 'lib'); 
```

现在我可以执行“test.pl FooTest”或“test.pl BarTest”或“test.pl”来运行所有测试。

# drupal - Drupal 7 OpenLayers 映射关系

> ID：15960491
> 
> 赞同：1
> 
> 时间：2013-04-11T23:16:29.167
> 
> 标签：drupal, views, openlayers

我有一个 OpenLayers 地图，它为我提供了一个基于大圆的位置的表格和地图显示。我有一个从 Locations 到我的 Products 内容类型的实体引用。我想展示在我附近的位置可用的产品。

我的问题是：我想显示两种类型的联系人 - 产品和位置。我想在表格中显示产品，在地图中显示位置。如何设置表格以提取产品的上下文参数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T01:16:17.287

我发现我不需要分离数据......只需按它分组并隐藏我不想要的所有内容。我在视图中创建了关系，然后添加了字段，然后隐藏了所有我不想看到的位置数据。

# javascript - 将图像粘贴到网页

> ID：15960492
> 
> 赞同：7
> 
> 时间：2013-04-11T23:16:30.143
> 
> 标签：javascript, html, image, copy-paste

我为所见即所得的编辑器做了一些研究，发现 ckeditor 看起来不错，但是我需要能够将图像复制/粘贴到编辑器。

我发现这个网站正是我需要的[http://pasteboard.co/](http://pasteboard.co/)所以它可能但是我找不到它是如何完成的。

你有什么想法或解决方案吗？

我更喜欢纯 html5/javascript 的解决方案，并避免使用任何插件，但也可以使用 silverlight 或 flash。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-12T02:20:22.947

有两种方法可以解决这个问题，简单的方法和困难的方法。

**简单的方法：** 利用[剪贴板 API](http://dev.w3.org/2006/webapi/clipops/)。这是一个“HTML5”API，但它只在 Chrome 中得到适当支持。这将允许您从剪贴板以`Blob`. `Blob`然后，您可以通过 XHR2 请求 将其发送到您的服务器。

**艰难的道路：** 不幸的是，这是你必须为除 Chrome 以外的所有浏览器做的事情，而且它并不漂亮。它涉及您在“粘贴目标元素”内创建隐藏的内容可编辑 DIV。这将收到粘贴的图像。然后，您需要将图像绘制到 a`<canvas>`上，然后需要将其转换为`Blob`. 但是等等，它会变得更好。在某些情况下（可能很多情况），您可能还需要代理跨域图像（服务器端）。如果托管映像的服务器不允许对它们托管的映像进行 CORS 请求，则可能需要这样做。[您可以在这篇 MDN 文章](https://developer.mozilla.org/en-US/docs/HTML/CORS_Enabled_Image)中了解有关这种情况的更多信息。

我维护的基于 javascript 的上传[器 Fine Uploader](http://fineuploader.com)已经支持通过粘贴上传图像，但目前仅在 Chrome 中。我想如果我收到足够多的请求，我会经历在非剪贴板 API 浏览器中实现这一点的麻烦。不过，坦率地说，由于在未实现剪贴板 API 的浏览器中处理未启用 CORS 的图像需要代理图像服务器端，所以这似乎不值得付出努力（当然，除非我的用户群告诉我他们想要它）。

希望这可以帮助。

# javascript - 从 Backbone.js 中的非 JSON 服务器响应创建模型实例

> ID：15960498
> 
> 赞同：1
> 
> 时间：2013-04-11T23:16:53.353
> 
> 标签：javascript, ajax, django, backbone.js

我有一个带有关联视图的规范模型：

```
var Item = Backbone.Model.extend({
  url: function() {
    return "/item/123"
  }
});
var ItemView = Backbone.View.extend({}); 
```

但是，在服务器端，在 url "/item/123" 处，我的 Django 应用程序不呈现 JSON 格式的内容，而是设计为直接插入到主页中的 HTML 模板。如何在不大幅改变服务器提供动态内容的方式的情况下渲染模型？甚至有可能还是我误解了 Backbone.js 背后的整个哲学？

只是给你一点背景：我正在通过集成 Backbone.js 重构 Django Web 应用程序的 JS 代码。该应用程序本身并不是很大，但它大量使用了 Ajax 调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:27:39.793

我认为您不应该在`model`. 模板的加载和渲染通常是`view`. `render`尝试在您的方法中使用 AJAX 直接加载 HTML `view`：

```
 var ItemView = Backbone.View.extend({
  render: function(){
    var that = this;
    $.get('/item/123', function(html){
      that.$el.html(html);
    });
    return this;
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:27:30.213

如果您还没有，请查看 django-app Tastypie，它是后端到主干和类似应用程序的首选解决方案。

如果不看代码，很难知道将其全部转移到 Tastypie 中与基于每个案例滚动您自己的解决方案需要做多少工作，请查看文档。

# ruby-on-rails - 通过另一个关联过滤has_many关联结果？

> ID：15960500
> 
> 赞同：0
> 
> 时间：2013-04-11T23:16:57.953
> 
> 标签：ruby-on-rails, activerecord

```
class User < ActiveRecord::Base
  has_many :vehicles
end

class Vehicle < ActiveRecord::Base
  belongs_to :user
  belongs_to :make
end

class Make < ActiveRecord::Base
  has_many :vehicles
end 
```

所以在 中`MakesController#show`，我想只显示`current_user`该特定品牌的所有车辆。有没有办法像这样在协会上做到这一点：

```
current_user.vehicles.find_by_make(@make) 
```

还是我被迫做类似的事情：

```
Vehicle.find_by_user_and_make(current_user, @make) 
```

? 我知道第一种方法行不通，但是第二种方法感觉有点脏。

编辑：抱歉，我意识到我过度简化了这个问题。我真的很想将 Make 上定义的类方法/范围应用于关联。调用`ActiveRecord::Relation`方法，如`where`，非常简单。即时启动了这个例子，但除了`where`我想做的一个简单的电话之外，还有很多事情要做，再次道歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-04T15:08:28.670

You can also do

```
current_user.vehicles.find_all_by_make(@make) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:31:06.290

你要

```
current_user.vehicles.where(make_id: @make) 
```

正如@Zippie 所说

# php - 使用_POST在php中检索嵌套数组

> ID：15960501
> 
> 赞同：0
> 
> 时间：2013-04-11T23:17:16.050
> 
> 标签：php, arrays

我在我的 HTML 表单中设置了以下内容。如何在我的 PHP 页面中检索它（ON Submit）？

```
foreach ($rows as $i => $value) {
    echo "<br/>What do you think about : ";
    echo "<li>$value<br/>";
    echo "1<input type='radio' value='1' name='answer-$i' />&nbsp;";
    echo "2<input type='radio' value='2' name='answer-$i' />&nbsp;";
    echo "3<input type='radio' value='3' name='answer-$i' />&nbsp;";
    echo "4<input type='radio' value='4' name='answer-$i' />&nbsp;";
    echo "5<input type='radio' value='5' name='answer-$i' />&nbsp;";    
    }
?> 
```

如何找回我的答案？

我对我的表单使用 POST 方法。帮我！！

添加详细信息。

```
<?php
echo "hello";
$answer = _POST("answer");
echo $answer-0;
echo $answer[0];
foreach ($answer as $i => $value) {

    echo $value;
    echo $i;
}

?> 
```

答案-0=3&answer-1=1

以上值表明参数已设置（获取方法）。但在 POST 方法中，我无法访问它们。

有人能帮我吗？我还没有解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:26:27.287

所以你需要使用`$_POST`带方括号的数组（它是一个数组）。`$answers`假设您仍然`$rows`可用，此代码将为您构建一个数组。

```
$answers = array();
foreach ($rows as $i => $value) {
    $answers[$i] = $_POST["answer-$i"];
}
print_r($answers); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T04:15:36.737

```
<form method="post">
<?php

foreach ($_POST as $i => $value) {
    echo "$i&nbsp;$value<br/>";
}

echo $_POST['answer-1'];
echo "<br>";
echo $_POST['answer-2'];

$rows = array(
    "1" => "bar",
    "2" => "foo",
);

foreach ($rows as $i => $value) {
    echo "<br/>What do you think about : ";
    echo "<li>$value<br/>";
    echo "1<input type='radio' value='1' name='answer-$i' />&nbsp;";
    echo "2<input type='radio' value='2' name='answer-$i' />&nbsp;";
    echo "3<input type='radio' value='3' name='answer-$i' />&nbsp;";
    echo "4<input type='radio' value='4' name='answer-$i' />&nbsp;";
    echo "5<input type='radio' value='5' name='answer-$i' />&nbsp;";    
    }
?>
<input type="submit"/>
</form> 
```

看起来更像，你需要什么。

# jquery - Bootstrap 超大 JQuery 错误移动设备布局

> ID：15960505
> 
> 赞同：0
> 
> 时间：2013-04-11T23:17:25.850
> 
> 标签：jquery, html, css, twitter-bootstrap, supersized

我有一个可能非常简单的问题。我正在使用 Twitter Boostrap 作为框架来开发一些登录页面以及我网站标题中的超大 Jquery Slider。在移动设备上查看网站或缩小浏览器窗口时会出现此问题。

Supersized 似乎接管了网站的内容背景并全屏运行，内容显示在其顶部。理想情况下，我希望超大滑块保持在标题内，而不是在移动设备查看时向下扩展内容的两侧。

这可能很简单，但我将不胜感激任何帮助！:)

网址：[http ://www.landing.xeonweb.com.au/index2.html](http://www.landing.xeonweb.com.au/index2.html)

标题 CSS：

```
.header{
width:100%;
height:700px;
clear:both;
overflow:hidden;
} 
```

超大 CSS：

```
 * { margin:0; padding:0; }
body { background:#111; height:100%; }
    img { border:none; }

    #supersized-loader { position:absolute; top:50%; left:50%; z-index:0; width:60px; height:60px; margin:-30px 0 0 -30px; text-indent:-999em; background:url(../img/progress.gif) no-repeat center center;}

    #supersized {  display:block; position:fixed; left:0; top:0; overflow:hidden; z-index:-999; height:100%; width:100%; }
        #supersized img { width:auto; height:auto; position:relative; display:none; outline:none; border:none; }
            #supersized.speed img { -ms-interpolation-mode:nearest-neighbor; image-rendering: -moz-crisp-edges; }   /*Speed*/
            #supersized.quality img { -ms-interpolation-mode:bicubic; image-rendering: optimizeQuality; }           /*Quality*/

        #supersized li { display:block; list-style:none; z-index:-30; position:fixed; overflow:hidden; top:0; left:0; width:100%; height:100%; background:#111; }
        #supersized a { width:100%; height:100%; display:block; }
            #supersized li.prevslide { z-index:-20; }
            #supersized li.activeslide { z-index:-10; }
            #supersized li.image-loading { background:#111 url(../img/progress.gif) no-repeat center center; width:100%; height:100%; }
                #supersized li.image-loading img{ visibility:hidden; }
            #supersized li.prevslide img, #supersized li.activeslide img{ display:inline; } 
```

HTML 设置：

```
<div class="row">   
    <div id="top-message">
        <p>Contact Us Today for our Monthly Special</p> 
    </div>  
 </div>  

 <div class="row">   
    <div class="header">
        <!--Arrow Navigation-->
            <a id="prevslide" class="load-item"></a>
            <a id="nextslide" class="load-item"></a>
        <!--Slide captions displayed here-->
            <div id="slidecaption"></div>
    </div><!--End Header-->
 </div><!--End Row--> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:28:05.780

```
@media (max-width: 480px) {
 #supersized img {
 height: auto!important;
 }
} 
```

# javascript - JavaScript Async readAsDataURL 多个文件

> ID：15960508
> 
> 赞同：4
> 
> 时间：2013-04-11T23:17:43.067
> 
> 标签：javascript, html, file

我有一个需要保存的文件列表，除了名称之外，我还需要将 readAsDataURL 发送到服务器。

问题是我不确定如何使用 readAsDataURL 的异步特性来做到这一点。因为要将 DATAURL 保存到数组中，我需要查找文件列表中的文件名。而且我无法将文件传递给 readAsDataURL 的异步方法。你如何正确地写这个来工作？最终结果是我想要在一个 JSZip 文件中发送到服务器的文件列表。

```
function saveFileList(files)
{
    for (var i = 0, file; file = files[i]; i++) {

        var fr = new FileReader();
        fr.onload = function(e){
        if (e.target.readyState == FileReader.DONE) {
            var tt = e.target.result.split(",")[1];
                             //update the record in the list with the result
            }
         };

        var pp = fr.readAsDataURL(file);
  } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2019-02-06T17:38:13.303

如果您有 FileList 并且需要获取 base64 字符串数组，则需要执行此操作

```
export async function fileListToBase64(fileList) {
  // create function which return resolved promise
  // with data:base64 string
  function getBase64(file) {
    const reader = new FileReader()
    return new Promise(resolve => {
      reader.onload = ev => {
        resolve(ev.target.result)
      }
      reader.readAsDataURL(file)
    })
  }
  // here will be array of promisified functions
  const promises = []

  // loop through fileList with for loop
  for (let i = 0; i < fileList.length; i++) {
    promises.push(getBase64(fileList[i]))
  }

  // array with base64 strings
  return await Promise.all(promises)
} 
```

像这样使用它

```
const arrayOfBase64 = await fileListToBase64(yourFileList) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-16T04:01:03.870

罗素 G 答案的替代方案：

```
var reader = new FileReader();
reader.onload = function(event){
   payload = event.target.result;
   var filename = file.name, filetype = file.type;//etc
   //trigger a custom event or execute a callback here to send your data to server.
};
reader.onerror = function(event){
   //handle any error in here.
};
reader.readAsDataURL(file); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-28T17:53:50.323

你需要另一个函数，所以你可以传入文件。试试这个：

```
var reader = new FileReader();

reader.onload = (function(theFile) {
   return function(e) {
      if(reader.readyState == FileReader.DONE)
         alert(theFile.name);   // The file that was passed in.
      }
   };
})(file);

reader.readAsDataURL(file); 
```

# f# - F# 的迭代工具

> ID：15960511
> 
> 赞同：5
> 
> 时间：2013-04-11T23:17:58.070
> 
> 标签：f#, itertools

我习惯了[Python 的 itertools](http://docs.python.org/2/library/itertools.html)用迭代器（F#: 序列）来做功能性的事情，并且想知道 F# 或常用库中是否有等价物，因为它们非常方便。

对我来说最重要的工具是：

*   product ：笛卡尔积，相当于嵌套的for循环
*   组合
*   排列
*   暂时
*   丢弃时
*   chain ：将多个迭代器链接在一起形成一个新的更长的迭代器
*   重复* : 重复 (5) -> 5, 5, 5...
*   计数*：计数（10）-> 10、11、12...
*   循环*：循环（[1,2,3]）-> 1,2,3,1,2...

* 我想这 3 个会在 F# 中产生单子？你如何让它们无限？

系统提示我提问，因为我[在 F# 中看到了这个关于排列的问题，](https://stackoverflow.com/q/286427/36537)并且很惊讶它不是库的一部分或内置于语言中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T00:27:39.313

不知道有没有一个常用的库，里面包含积、组合、排列等函数，但是你提到的其他的已经在`Seq`and`List`模块中或者可以轻松实现，而且.中也有有用的方法`System.Linq.Enumerable`。

*   `takewhile`->`Seq.takeWhile`
*   `dropwhile`->`Seq.skipWhile`
*   `chain`->`Seq.concat`
*   `repeat`->`Seq.initInfinite`
*   `count(10)`->`Seq.initInfinite ((+) 10)`
*   `cycle([1, 2, 3])`->`Seq.concat <| Seq.initInfinite (fun _ -> [1; 2; 3])`

您可能还想查看优秀的 FSharpx 库——它包含许多有用的函数来处理集合和诸如此类的东西。

# enthought - 以非管理员身份使用 easy_install 将外部包安装到 Canopy Python

> ID：15960519
> 
> 赞同：2
> 
> 时间：2013-04-11T23:18:39.587
> 
> 标签：enthought

我是没有管理员权限的 Windows 计算机的用户，并且刚刚从 Enthought 安装了 Canopy Python（我真的很兴奋我能够在没有管理员权限的情况下做到这一点）。我现在想安装一个外部包（在 Canopy Python 中作为学术用户不可用）。[Enthought 支持页面](https://support.enthought.com/entries/23389761-Installing-external-packages-into-Canopy-Python)上的说明建议安装外部包，我们可以打开一个命令窗口，确保 Canopy Python 在 SHELL 路径上，然后“从命令行遵循标准 Python 安装程序”，建议的方法是使用 easy_install。但是，作为非管理员，在尝试使用 easy_install 时，会弹出一个对话框，要求输入管理员用户名/密码（我作为普通用户没有）。有谁知道是否可以以非管理员身份使用 easy_install，或者是否有替代解决方案可以为 Canopy Python 的非管理员用户安装外部软件包？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T08:33:53.650

您是否有可能`easy_install`在您的机器上使用另一个 Python 发行版？

`easy_install`在 Canopy 中的默认位置是

`C:\Users\YourName\AppData\Local\Enthought\Canopy\User\Scripts\easy_install`

请尝试明确使用完整地址，看看是否可行，理论上您不需要管理员权限。

**更新：**问题是由于 Windows UAC 用于确定应用程序是否需要提权的启发式方法之一：如果名称中有“设置”或“安装”字样，它将提示提升。（请参阅 Mona 下面关于要重命名哪些文件的答案。）重命名 easy_install 并使用它来安装`pip`（`easy install pip`）可能更容易，然后使用它来代替。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T19:25:42.233

作为更新，在 Windows 上的用户访问控制 (UAC) 上搜索了更多内容后（并且遇到一些提到在程序名称中安装“安装”可能会导致问题的内容，但我不确定这是否是在我的情况下出现问题的原因），我刚刚尝试了以下对我有用的“hack”（但也许其他人可以提出更优雅的解决方案，或者可以提供更多关于为什么这样做的反馈）：

1.  转到 C:\Users\YourName\AppData\Local\Enthought\Canopy\User\Scripts\
2.  将 easy_install.exe 重命名为 easy.exe
3.  将 easy_install-script.py 重命名为 easy-script.py
4.  从命令行运行“C:\Users\YourName\AppData\Local\Enthought\Canopy\User\Scripts\easy.exe PackageName”。
5.  （等待安装包并通过打开 Canopy Python 并尝试导入包来检查是否成功。）

一些额外的评论：如果我没有执行上面的第 3 步（也重命名 .py 文件），我会收到一个错误。此外，在这种情况下，我需要从命令行键入 easy.exe 的完整路径。

这对我有用（我可以使用外部包），但我的猜测是应该有一个更“官方”的解决方案，不需要重命名easy_install。

# spring - 重用spring bean - 名称冲突

> ID：15960520
> 
> 赞同：0
> 
> 时间：2013-04-11T23:18:49.230
> 
> 标签：spring, javabeans, collision, uniqueidentifier

在 spring (3.2) 中重用其他包含 spring-annotated 类的 jar 的首选方法是什么？

问题示例：我有一个具有@Autowired SessionFactory 的 jar，但它需要与应用程序的其余部分不同的会话工厂（它与不同的数据库通信）

所以，如果我只是把那个 jar 放在我的类路径中，应用程序将不会启动，因为有 2 个具有相同类型/名称的 bean。我需要将该 jar 与应用程序的其余部分隔离。如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T02:33:49.113

当存在多个候选者时选择特定 bean 由 解决`@Qualifier`。只需在应用程序上下文中声明相同的 bean 并为它们分配不同的 id 或限定符名称。让我们看一下这个类：

```
public class Foo{

     @Autowired
     private SessionFactory sessionFactory;
} 
```

假设两者`SessionFactoryImpl1`和`SessionFactoryImpl2`都是 bean 连接的候选对象，并且您希望将 sessionFactory 指向`SessionFactoryImpl1`实例，那么您需要添加`@Qualifier`注释，如下例所示：

```
public class Foo{

     @Autowired
     @Qualifier("sessionFactory1")
     private SessionFactory sessionFactory;
} 
```

在您的应用程序上下文中

```
<bean class="example.SessionFactoryImpl1">
    <qualifier value="sessionFactory1"/>
    <!-- inject any dependencies required by this bean -->
</bean>

<bean class="example.SessionFactoryImpl2">
    <qualifier value="sessionFactory2"/>
    <!-- inject any dependencies required by this bean -->
</bean> 
```

# javascript - Javascript：用主干构建图片库

> ID：15960521
> 
> 赞同：0
> 
> 时间：2013-04-11T23:18:52.737
> 
> 标签：javascript, backbone.js, gallery, image-gallery

我正在使用主干构建一个图片库。用户一次只能查看一个图像，当他使用箭头键导航下一个/上一个时，他将看到集合中的下一个图像。

我有一个称为画廊视图的顶级主干视图。

```
GalleryView = Backbone.View.extend({
    initialize: function(options) {
        this.collection = PhotosCollection();
    }
}); 
```

然后为每个图像创建一个视图

```
PhotoView = Backbone.View.extend 
```

我将跟踪视图中集合中的当前模型，并为该模型创建 photoView。

我的问题是关于分页或预取不在视图中的图像。我不确定galleryView 如何保存多个PhotoView，然后显示焦点所在的那个。我正在考虑为整个集合构建一个长 div，然后将每张照片的 div 添加到索引位置。从该 div 添加删除新图像的策略是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:43:49.597

**更新**

我修改了我的原始代码。虽然这显然未经测试，但它应该给你一个合理的开始。一旦`img`创建了元素并`src`设置了属性（[如here所述](https://stackoverflow.com/questions/11763304/prevent-browser-from-loading-image-before-attaching-element-to-dom#11763417)），图像就会开始预加载。它们不必附加到 DOM。我在下面包含的这个改进版本将根据`paginationPadding`变量在当前图像之前和之后预加载图像。

**结束更新**

在 Backbone 中处理事物时，它有助于将所有与状态相关的信息保留在模型中，然后让 UI 响应它。在这种情况下，您可以简单地跟踪要在模型中显示的图像，然后响应模型中的更改跟踪您要查看的照片，您可以简单地重新渲染照片库以显示所需的图片。它是反应性的。

这是一个粗略的实现，但希望能让您了解如何实现一个图库，您可以在其中单击像这样的照片。当然，你仍然有一堆 CSS 之类的事情要做。它不完整。如果您有任何问题，请告诉我。

```
var StateModel = Backbone.Model.extend({
  defaults: {
    visibleImage: 0
  },

  initialize: function(attributes, options) {
    this.photoCollection = options.photoCollection;
  },

  setIndex: function(photoIndex) {
    if(!this.photoCollection.length) return;

    if(photoIndex < 0) {
      photoIndex = this.photoCollection.length - 1;
    } else if(photoIndex >= this.photoCollection.length) {
      photoIndex = 0;
    }

    this.set('visibleImage', photoIndex);
  },

  setPrev: function() {
    this.setIndex(this.get('visibleImage') - 1);
  },

  setNext: function() {
    this.setIndex(this.get('visibleImage') + 1);
  }
});

var PhotoControls = Backbone.View.extend({
  tagName: 'div',

  initialize: function(options) {
    this.stateModel = options.stateModel;
    this.paginationPadding = options.paginationPadding;
  },

  render: function() {
    var that = this;
    this.$el.empty();

    var ctrlStyle = {cursor: 'pointer', display: 'inline-block', padding: '5px 10px', margin: '0px 5px', border: '1px solid #000'};

    this.$el.append($('<div><< Previous</div>')
      .css(ctrlStyle))
      .click(function() {
        that.stateModel.setNext();
      });

    // Display numbers
    var visibleImage = this.stateModel.get('visibleImage');
    var pgStart = Math.max(visibleImage - this.paginationPadding, 0);
    var pgEnd = Math.min(visibleImage + this.paginationPadding, this.stateModel.photoCollection.length - 1);
    for(var i = pgStart; i <= pgEnd; i++) {
      var $numEl = that.$el.append(
        $('<div>' + (i + 1) + '</div>')
          .css(ctrlStyle)
          .click(function() {
            that.stateModel.setIndex(i);
          });

        if(i == visibleImage) {
          $numEl.css({fontWeight: 'bold', textDecoration: 'underline'});
        }
      );
    }

    this.$el.$('<div>Next >></div>')
      .css(ctrlStyle))
      .click(function() {
        that.stateModel.setPrev();
      });

    return this;
  }
});

var PhotoView = Backbone.View.extend({
  render: function() {
    this.$el.html('<img src="' + this.model.get('url') + '" />');

    return this;
  }
});

var GalleryView = Backbone.View.extend({
  tagName: 'div',

  initialize: function(options) {
    this.paginationPadding = 2;

    this.collection = PhotosCollection();
    this.renderedViews = {};
    this.state = new StateModel(null, {photoCollection: this.collection});
    this.photoControls = new PhotoControls({
      stateModel: this.state,
      paginationPadding: this.paginationPadding
    }).render();
  },

  render: function() {
    if(this.photoView) {
      this.photoView.remove();
    }

    // Pre-fetch images before and after current one based on pagination padding
    var visibleImage = this.stateModel.get('visibleImage');
    var pgStart = Math.max(visibleImage - this.paginationPadding, 0);
    var pgEnd = Math.min(visibleImage + this.paginationPadding, this.stateModel.photoCollection.length - 1);

    for(var i = pgStart; i <= pgEnd; i++) {
      if(!this.renderedViews[fetchModel.cid]) {
        // Images will begin fetching as soon as the 'src' attribute is set on the 'img' element rendered by the view
        this.renderedViews[model.cid] = new PhotoView(this.collection.at(i));
        this.renderedViews[model.cid].render();
      }
      this.$el.html(this.photoView.render().el);
    }

    // Attach the view for the current image
    var renderModel = this.collection.at(this.state.get('visibleImage'));
    if(renderModel && this.renderedViews[renderModel.cid]) {
      this.photoView = this.renderedViews[renderModel.cid];
      this.$el.html(this.photoView.el);
    }

    this.$el.append(this.photoControls.el);

    return this;
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:24:01.587

> 我不确定galleryView 如何保存多个PhotoView，然后显示焦点所在的那个。

这是简单的部分。只要视图没有附加到 DOM，它就保持不可见，您可以实例化任意数量的视图，并且在任何时候只附加其中一个。

> 我正在考虑为整个集合构建一个长 div，然后将每张照片的 div 添加到索引位置。从该 div 添加删除新图像的策略是什么。

为每张图片制作一个带有 LI 的 UL，无论如何，如果你想预加载图像，我想下一个就足够了，你不需要删除 PhotoViews，只要它们不是荒谬的照片数量，只是如果您希望实际删除视图，请调用 remove() 将它们滚动到视图之外或隐藏它们。

# audio - 在 fortran 90/95 中生成声音/哔声

> ID：15960522
> 
> 赞同：3
> 
> 时间：2013-04-11T23:18:59.473
> 
> 标签：audio, fortran, fortran90, fortran95

当我的运行结束时，我需要在 fortran 中生成声音。我需要类似于c++ 中使用的"\a" 或 Beep( ***, ) 的东西。***

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T15:45:43.037

Try adding the following at the end of your program

```
print *, char(7) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-06-12T23:01:49.227

如果你想有点创意，你可以用一个音乐文件结束你的程序。在大多数 c:/windows/media 文件夹中，您可以找到许多 .wav 文件。在这种情况下，我将 tada.wav 文件复制到我的可执行文件的位置，以便它可以`tada.wav`在程序结束时在命令提示符下播放该文件。

如果您使用 Intel Fortran，那么这个实现应该可以工作：

```
 program zsound
  use ifport
  implicit none
  integer i
  character(100) :: musicfile

  musicfile = "tada.wav"

  !  Your Program goes here...

  ! CALL EXECUTE_COMMAND_LINE(musicfile)
  i = system(musicfile)

  end 
```

# variables - 如何删除保存在批处理变量中的文件名的扩展名？

> ID：15960524
> 
> 赞同：0
> 
> 时间：2013-04-11T23:19:10.660
> 
> 标签：variables, for-loop, batch-file, filenames

首先我的批处理脚本片段（不工作）：

```
set _WRx32=wrar420.exe
set _WRx64=winrar-x64-420.exe
set _WRLNG=rarlng.rar

FOR %%f IN (_WRLNG, _WRx64, _WRx32) do set "%%f"="%%~nf" 
```

[对于列表中的每个变量名 (!)，从变量内容 (!) 中删除扩展名并保存回同一个变量]

问题：如何删除保存在变量 _WRLNG、_WRx64、_WRx32 中的文件名的扩展名并将此文件名（无扩展名）保存回相同的变量？

我需要类似的东西： set var=%var~n% 但这不起作用。在 FOR 循环中，我不知道如何将名称从 (...variable names ...) 列表转换为相应的变量，因此我可以应用参数扩展，如“~n”、“~nf”等。 在上面。

谁能帮我 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T01:33:14.993

```
@echo off
setlocal EnableDelayedExpansion

set _WRx32=wrar420.exe
set _WRx64=winrar-x64-420.exe
set _WRLNG=rarlng.rar

FOR %%f IN (_WRLNG, _WRx64, _WRx32) do (
   FOR %%g in (!%%f!) do set "%%f=%%~ng"
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:38:22.660

试试这个：

```
FOR /f "delims=." %%f IN ("%_WRx32%") do set "_WRx32=%%f"
FOR /f "delims=." %%f IN ("%_WRx64%") do set "_WRx64=%%f"
FOR /f "delims=." %%f IN ("%_WRLNG%") do set "_WRLNG=%%f" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:39:18.050

我在命令行上尝试了一个类似的版本，看来您不能在 for 循环中执行多个变量变量（我知道）。

所以，你有两个选择：

1.  如果您知道变量将***始终***具有 4 个字符的扩展名（包括句点），那么您可以使用类似`set _WRLNG=%_WRLNG:~0,-4%`. 这将从变量中获取最后 4 个字符。

2.  您必须为每个变量执行一个循环，并且您需要修正执行它们的方式。正确的方法是`for /f %%i in ("%_WRLNG%") do set _WRLNG=%~ni`.

或者，查看 Endoro 的答案以获得更好的`for`循环示例。

编辑：想到另一种方式：

```
@echo off
for /f "delims=. tokens=1,2" %%i in ("%var%") do set var=%%i 
```

# ios - 某些按钮未通过 hitTest

> ID：15960528
> 
> 赞同：3
> 
> 时间：2013-04-11T23:19:32.407
> 
> 标签：ios, objective-c, uigesturerecognizer, hittest

我的界面有时在其外围有按钮。没有按钮的区域接受手势。

GestureRecognizers 被添加到容器视图中，在 viewDidLoad 中。以下是 tapGR 的设置方式：

```
UITapGestureRecognizer *tapGR = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(playerReceived_Tap:)];
[tapGR setDelegate:self];
[self.view addGestureRecognizer:tapGR]; 
```

为了防止手势识别器拦截按钮点击，我实现了 shouldReceiveTouch 以仅在触摸的视图不是按钮时才返回 YES：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gr 
   shouldReceiveTouch:(UITouch *)touch {

    // Get the topmost view that contains the point where the gesture started.
    // (Buttons are topmost, so if they were touched, they will be returned as viewTouched.)
    CGPoint pointPressed = [touch locationInView:self.view];
    UIView *viewTouched = [self.view hitTest:pointPressed withEvent:nil];

    // If that topmost view is a button, the GR should not take this touch.
    if ([viewTouched isKindOfClass:[UIButton class]])
        return NO;

    return YES;

} 
```

这在大多数情况下都可以正常工作，但是有一些按钮没有响应。当这些按钮被点击时，hitTest 返回容器视图，而不是按钮，所以 shouldReceiveTouch 返回 YES 并且gestureRecognizer 控制事件。

为了调试，我运行了一些测试......

以下测试确认按钮是容器视图的子视图，它已启用，并且按钮和子视图都是 userInteractionEnabled：

```
-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gr 
   shouldReceiveTouch:(UITouch *)touch {

// Test that hierarchy is as expected: containerView > vTop_land > btnSkipFwd_land.
for (UIView *subview in self.view.subviews) {
    if ([subview isEqual:self.playComposer.vTop_land])
        printf("\nViewTopLand is a subview."); // this prints
}
for (UIView *subview in self.playComposer.vTop_land.subviews) {
    if ([subview isEqual:self.playComposer.btnSkipFwd_land])
        printf("\nBtnSkipFwd is a subview."); // this prints
}

// Test that problem button is enabled.
printf(“\nbtnSkipFwd enabled? %d", self.playComposer.btnSkipFwd_land.enabled); // prints 1

// Test that all views in hierarchy are interaction-enabled.
printf("\nvTopLand interactionenabled? %d", self.playComposer.vTop_land.userInteractionEnabled); // prints 1
printf(“\nbtnSkipFwd interactionenabled? %d", self.playComposer.btnSkipFwd_land.userInteractionEnabled); // prints 1

// etc

} 
```

以下测试确认按下的点实际上在按钮的框架内。

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gr 
   shouldReceiveTouch:(UITouch *)touch {

CGPoint pointPressed = [touch locationInView:self.view];
CGRect rectSkpFwd = self.playComposer.btnSkipFwd_land.frame;

// Get the pointPressed relative to the button's frame.
CGPoint pointRelSkpFwd = CGPointMake(pointPressed.x - rectSkpFwd.origin.x, pointPressed.y - rectSkpFwd.origin.y);
printf("\nIs relative point inside skipfwd? %d.", [self.playComposer.btnSkipFwd_land pointInside:pointRelSkpFwd withEvent:nil]); // prints 1

// etc

} 
```

那么为什么 hitTest 返回的是容器视图而不是这个按钮呢？

解决方案：我没有测试的一件事是中间视图 vTop_land 的框架正确。它看起来不错，因为它有一个横跨屏幕的图像——超过了它的框架边界（我不知道这是可能的）。框架设置为纵向宽度，而不是横向宽度，因此最右侧的按钮超出了区域。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:11:55.173

在大多数情况下，命中测试并不可靠，通常不建议将其与手势识别器一起使用。

你为什么不`setExclusiveTouch:YES`为每个按钮，这应该确保按钮总是被选中。

# llvm - 访问llvm中数组的变量元素

> ID：15960529
> 
> 赞同：0
> 
> 时间：2013-04-11T23:19:39.687
> 
> 标签：llvm, llvm-c++-api

我想在变量索引处获取数组的值。索引由程序计算，在解析时未知。所以它存储在一个 Value 中并转换为一个 Int ，如下所示：

```
Value *IndexV = Index->Codegen();
Value *IntV = Builder.CreateFPToUI( IndexV, Type::getInt32Ty( getGlobalContext() ) ); 
```

如果我知道索引，我可以使用：

```
Value *VV = Builder.CreateExtractValue( Builder.CreateLoad( V ), 0 ); 
```

这给了我数组的第一个元素。并且工作正常。但是我怎样才能`IntV`用作索引呢？`CreateExtractValue`只需要一个 ArrayRef 并且无法将 ArrayRef 转换`IntV`为 ArrayRef，还是我错了？怎么会做这样的事情？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T07:48:53.053

首先，每当需要 ArrayRef 时，您始终可以只传递一个项目，因为any和之间存在[隐式转换](http://llvm.org/docs/doxygen/html/ArrayRef_8h_source.html#l00053)。`T``ArrayRef<T>`

但是，特别在这里，[extractvalue](http://llvm.org/docs/LangRef.html#extractvalue-instruction)需要常量索引，并且不能接受一般值，这就是它想要`unsigned`值的原因。如果要访问数组中未知索引中的元素，请改用[getelementptr](http://llvm.org/docs/LangRef.html#getelementptr-instruction)指令：在索引为 0 和 的数组地址上调用它`IntV`，您应该在 location 处获得指向数组的指针`IntV`。

# python - python对浮点数、整数等的引用

> ID：15960532
> 
> 赞同：0
> 
> 时间：2013-04-11T23:19:43.817
> 
> 标签：python, reference

据我了解，python 中没有对`int`s 或`float`s 或类似数据的引用。尽管如此，我正在解决一个问题，如果我能做类似的事情对我来说会很方便

```
a=1
b=2
c=3
ref_dict={'field1':ref_to_var_a,'field2':ref_to_var_b,'field3':ref_to_var_c} 
```

进而

```
def update(field,value):
   ref_dict[field]=value 
```

所以如果用户打电话

```
update('field2',5) 
```

的值`b`将变为 5。

有什么办法可以做到这一点？谢谢。

为了回应 arbanert 的有用评论和回答，我真正想做的是 - 惊喜，惊喜 - 更复杂。我正在用 wxPython 构建一个 GUI。我有许多 TextCtrl 控件，每个控件都会设置一个变量的值。当然，我可以为每个控件编写一个方法，或者我可以编写一个方法，看起来像

```
def handleTextEvent(self,event):
    if (event.GetEventObject() == widget1):
       a=int(event.GetString)
    elif (event.GetEventObject() == widget2):
       b= .... 
```

我想你也明白我为什么不喜欢这个。如果我能做一个简短的功能就好了：

```
def handleTextEvent(self,event):
    ref_dict[event.GetEventObject()]=int(event.GetString()) 
```

而且，是的，我对 wxPython 很陌生。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:22:04.967

这*是*可能的，但这几乎总是一个坏主意。

假设`a`,`b`和`c`是全局变量：

```
ref_dict = {'field1': 'a', 'field2': 'b', 'field3': 'c'}
def update(field, value):
    globals()[ref_dict[field]] = value 
```

* * *

如果你*真的*想，你甚至可以创建“参考包装”：

```
class GlobalReference(object):
    def __init__(self, name):
        self.name = name
    def get(self):
        return globals()[self.name]
    def set(self, value):
        globals()[self.name] = value

ref_dict = {'field1': GlobalReference('a'), 'field2': GlobalReference('b')}
def update(field, value):
    ref_dict[field].set(value) 
```

如果你想包装不在的东西`globals`，比如来自另一个模块的全局变量、类属性、实例属性等？创建更多引用包装类型：

```
class NamespaceReference(object):
    def __init__(self, namespace, name):
        self.namespace, self.name = namespace, name
    def get(self):
        return getattr(self.namespace, self.name)
    def set(self, value):
        setattr(self.namespace, self.name, value)

ref_dict = {'field1': GlobalReference('a'), 'field2': NamespaceReference('myobj', 'b')} 
```

或者你可以放弃类，只存储 setter 函数……</p>

* * *

那么，如果这是一个坏主意，那么正确的答案是什么？

不知道你想做什么，很难说，但这里有一些可能性：

*   使用一个`dict`充满值的变量而不是一堆单独的变量。
*   使变量成为类的实例属性，并传递该类的实例。
*   使用可变的浮动持有者对象而不是普通的浮动实例。

* * *

对于您的具体情况，我认为您想要的是第二个。这是标准的模型-视图-控制器设计。或者，如果您不喜欢 MVC、model-template-view 或其他一些变体（您实际上并不需要控制器）。

您的模型是一堆分散的全局变量，这就是为什么很难将其连接到视图的原因。最简单的答案是将模型表示为对象。然后给视图（或其控制器）一个对该模型的引用，这很简单，你就完成了。

# mediawiki - Mediawiki API 错误：参数“prop”的值无法识别：提取

> ID：15960533
> 
> 赞同：3
> 
> 时间：2013-04-11T23:19:54.910
> 
> 标签：mediawiki, mediawiki-api

我有一个新安装的 mediawiki。我正在尝试使用 API 来简单地获取一篇文章。我正在使用的 API 网址是：

[https://example.com/mediawiki/api.php?action=query&format=json&prop=extracts&titles=Vendor_cisco](https://example.com/mediawiki/api.php?action=query&format=json&prop=extracts&titles=Vendor_cisco)

转到该 URL 后，我得到：参数“prop”的无法识别值：提取

这看起来很奇怪，因为以下所有 url 都可以正常工作并返回正确的数据：

[https://example.com/mediawiki/api.php?action=query&format=json&prop=links&titles=Vendor_cisco](https://example.com/mediawiki/api.php?action=query&format=json&prop=links&titles=Vendor_cisco) [https://example.com/mediawiki/api.php?action=query&format=json&prop=categories&titles=Vendor_cisco](https://example.com/mediawiki/api.php?action=query&format=json&prop=categories&titles=Vendor_cisco) [https:// example.com/mediawiki/api.php?action=query&format=json&prop=revisions&titles=Vendor_cisco](https://example.com/mediawiki/api.php?action=query&format=json&prop=revisions&titles=Vendor_cisco)

如何从我的文章中获取正文和文本？我的印象是 prop=extracts 是用什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T00:18:00.820

[`prop=extracts`是 TextExtracts 扩展](https://www.mediawiki.org/wiki/Extension:TextExtracts#API)（以前称为[MobileFrontend 扩展](http://www.mediawiki.org/wiki/Extension:MobileFrontend#prop.3Dextracts)）的一部分。如果您没有安装该扩展程序，您将无法使用`prop=extracts`.

# .net - 如何在解决方案中的所有项目之间共享 LocalDB 实例？

> ID：15960535
> 
> 赞同：4
> 
> 时间：2013-04-11T23:20:09.347
> 
> 标签：.net, visual-studio, localdb

我有这样的 VS 2012 解决方案设置：

*   英孚模型项目
*   EF 模型测试项目
*   ASP.NET MVC 4 应用程序
*   WCF 数据服务项目

在开发过程中，我想使用 LocalDB 作为 EF 的后备数据库。MVC 和 WCF 项目都使用 EF 模型来访问数据库中的数据。我想在所有项目（MVC、WCF 和测试）中共享同一个 LocalDB 实例，但似乎无法正确设置 web.config。

我还希望这个项目设置可以跨开发人员机器移植，IE 没有绝对路径。

测试项目在 c:\users\\.mdf 中创建并使用数据库。MVC 和 WCF 项目希望文件驻留在 AppData 文件夹中。我一直在根据需要手动复制它，但很明显，随着应用程序更改数据，它们会不同步。

关于如何配置项目以使用相对路径共享相同实例的任何建议或示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:37:29.163

将 minhcat_vo 的示例放在一起让我想出了一个解决方案。

当您没有指定与 DbContext 派生类型的名称（或您设置为注释的任何内容）匹配的显式连接字符串时，我遇到的问题发生了。项目类型之间的行为不同：

*   在测试项目中，它使用本地数据库目录和 DbContext 的 FQDN，MDF 文件位于 \\.mdf。
*   在 ASP.NET MVC 项目中，它尝试从 \app_data\.mdf 加载 mdf

在将我的 EF 项目移动到 MySQL 时，我偶然发现了该解决方案。MySQL EF 提供程序在任何情况下都不会回退到 DefaultConnection 连接字符串（我想除非您的 DbContext 明确选择它）。为了让 MySQL-EF 工作，我必须输入一个与上下文匹配的连接字符串。这让我找到了我正在寻找的答案。通过对我的所有项目使用以下连接字符串，它们都共享相同的 MDF 文件/LocalDB 实例：

```
<add name="ThingsContext" providerName="System.Data.SqlClient" connectionString="Data Source=(LocalDb)\v11.0;Initial Catalog=Things;Integrated Security=SSPI" /> 
```

ThingsContext 是我项目的 DbContext 实例。你可以看到我的示例解决方案@https [://github.com/drdamour/SharedLocalDB](https://github.com/drdamour/SharedLocalDB)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:38:14.317

> 我想在所有项目（MVC、WCF 和测试）中共享相同的 LocalDB 实例，但似乎无法正确设置 web.config

这可能是您的连接字符串问题。

> 关于如何配置项目以使用相对路径共享相同实例的任何建议或示例？

是的，您可以在每个项目的 web.config 中使用相对路径。但是，您可以使用**ConfigurationManager**来处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T23:33:34.563

我可能错了，一个 localDB 一次只能访问一个应用程序。如果您希望多个应用程序可以同时访问一个数据库，请将 LocalDB 连接到 Express Edition SQL 服务器。为每个应用程序使用表单身份验证以快速方式创建用户。将 ConnectionString 更改为使用用户名和密码表达 sql。你已准备好出发。

# phpstorm - Phpstorm 书签/断点未显示在收藏夹工具中

> ID：15960536
> 
> 赞同：0
> 
> 时间：2013-04-11T23:20:10.797
> 
> 标签：phpstorm

据此： http: [//www.jetbrains.com/phpstorm/webhelp/favorites-tool-window.html](http://www.jetbrains.com/phpstorm/webhelp/favorites-tool-window.html)

> 随着新书签或断点的添加，书签和断点列表会自动填充。

但是，当我尝试添加书签和调试断点时，它们不会被添加到收藏夹工具窗口中。

我应该怎么做才能使书签和断点列表实际上像文档声称的那样自动显示在收藏夹窗口中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:56:55.463

该功能（收藏夹、书签和断点都在单个窗口中）实际上并未在 v6.0 最终版（内部版本 127.100）中提供。但它在即将推出的**v6.0.1** (129.xxx.branch)中可用

# sqlalchemy - 使用 SQLAlchemy 在 Flask 中的多个非外键列上连接 2 个表并检索所有列

> ID：15960537
> 
> 赞同：1
> 
> 时间：2013-04-11T23:20:12.273
> 
> 标签：sqlalchemy, flask, flask-sqlalchemy

我有一些下面显示的表，我想加入不是彼此表的外键的列，然后可以访问两者的列。以下是课程：

```
class Yi(db.Model):

    year = db.Column(db.Integer(4), primary_key=True)
    industry_id = db.Column(db.String(5), primary_key=True)
    wage = db.Column(db.Float())
    complexity = db.Column(db.Float())

class Ygi(db.Model, AutoSerialize):

    year = db.Column(db.Integer(4), primary_key=True)
    geo_id = db.Column(db.String(8), primary_key=True)
    industry_id = db.Column(db.String(5), primary_key=True)
    wage = db.Column(db.Float()) 
```

所以，我想要得到的是由我指定的 ID 连接的两个表的列，在本例中是 Year 和行业 ID。这可能吗？这是我为实现这一目标而编写的 SQL...

```
SELECT 
    yi.complexity, ygi.* 
FROM
    yi, ygi 
WHERE 
    yi.year = ygi.year and 
    yi.industry_id = ygi.industry_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T11:16:12.377

一种肮脏的方式是：

```
q=session.query(Ygi,Yi.complexity).\
          filter(Yi.year==Ygi.year).\
          filter(Yi.industry_id==Ygi.industry_id) 
```

这给了你：

```
SELECT ygi.year AS ygi_year, ygi.geo_id AS ygi_geo_id, 
       ygi.industry_id AS ygi_industry_id, ygi.wage AS ygi_wage,
       yi.complexity AS yi_complexity 
FROM ygi, yi 
WHERE yi.year = ygi.year 
AND yi.industry_id = ygi.industry_id 
```

我觉得这*很脏*，因为它不使用**join() 方法**。您可以通过[SQLAlchemy 文档](http://docs.sqlalchemy.org/en/rel_0_7/orm/query.html?highlight=join#sqlalchemy.orm.query.Query.joinhttp://docs.sqlalchemy.org/en/rel_0_7/orm/query.html?highlight=join#sqlalchemy.orm.query.Query.join)了解如何使用**join()**

然后，您可以选择使用*虚拟*模型：请参阅此问题[Mapping a 'fake' object in SQLAlchemy中](https://stackoverflow.com/questions/5637451/mapping-a-fake-object-in-sqlalchemy)**TokenMacGuy**的答案。这将是一个很好的解决方案。

或者你将只有一个*YiYgi 类*，它不是 sqlalchemy.Base 派生类，而只是一个对象。它更像是一种“手工时尚”的方式。

该类将具有一个 classmethod get() 方法，该方法将：

1.  调用您之前构建的查询，
2.  使用返回的请求行调用**init**并为每行构建一个实例

这是一个例子：

```
class YiYgi(object):

    def __init__(self,year, geo_id, industry_id, wage, complexity):
        # Initialize all your fields
        self.year = year
        self.geo_id = geo_id
        self.industry_id = industry_id
        self.wage = wage + 100  # You can even make some modifications to the values     here
        self.complexity = complexity

    @classmethod
    def get_by_year_and_industry(cls, year, industry_id):
        """ Return a list of YiYgi instances, void list if nothing available """
        q = session.query(Ygi,Yi.complexity).\
                    filter(Yi.year==Ygi.year).\
                    filter(Yi.industry_id==Ygi.industry_id)

        results = q.all()

        yiygi_list = []
        for result in results:
            # result is a tuple with (YGi instance, Yi.complexity value)
            ygi_result = result[0]
            yiygi = YiYgi(ygi_result.ygi_year, 
                          ygi_result.geo_id,
                          ygi_result.industry_id,
                          ygi_result.wage,
                          result[1])

            yiygi_list.append(yiygi)

        return yiygi_list 
```

# ios - 图像未显示在 UIImageView 中

> ID：15960541
> 
> 赞同：1
> 
> 时间：2013-04-11T23:20:42.210
> 
> 标签：ios

我在视图中添加了 UIImageVIew，如果我指定要在 IB 中使用的图像，那么它会正确显示，但如果我尝试以编程方式添加图像，则它不会显示。

我清除了要从 IB 加载的图像并添加了以下代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    UIImage* image = [UIImage imageNamed:@"pic1.png"];
    UIImageView *iv = [[UIImageView alloc] initWithImage: image];
    iv.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    iv.contentMode = UIViewContentModeCenter;
    self.slideshowView = iv;
} 
```

self.slideshowView 是一个连接到图像视图的插座。

我可以确认 image 和 iv 在执行时都是非空的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:27:16.557

不要创建新的 UIImageView，而是设置 outlet 的 image 属性。这里的问题是您的新 UIImageView 在您的超级视图中没有框架，并且您将插座重新指向您创建的新图像视图。

```
self.slideshowView.image = [UIImage imageNamed:@"pic1.png"]; 
```

# javascript - 当其中一个被鼠标悬停时，突出显示具有相同类的所有元素

> ID：15960544
> 
> 赞同：2
> 
> 时间：2013-04-11T23:20:50.223
> 
> 标签：javascript, html

在 JavaScript 中，当其中一个被鼠标悬停时，是否可以突出显示具有相同类的所有项目？

例如，如果我有两个带有 class 的段落`p1`和两个带有 class 的段落`p2`，我希望`p1`在鼠标悬停时突出显示 的两个元素，并且我还希望在鼠标悬停时突出显示 p2 的两个元素。

```
<p class = "p1">This should be highlighted on mouseover</p>
<p class = "p2">This should be highlighted on mouseover</p>
<p class = "p1">This should be highlighted on mouseover</p>
<p class = "p2">This should be highlighted on mouseover</p> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:21:36.067

[这是一个工作示例](http://jsfiddle.net/aZXRM/)（需要 JQuery）。当鼠标悬停在一个成员上`p1`时，所有其他元素`p1`也将突出显示。也是如此`p2`。

JavaScript：

```
function highlightAllOnMouseover(className){
    $(className).mouseover(function() {
  $(className).css("opacity", 0.4); 
  $(className).css("opacity", 1);
}).mouseleave(function() { 
    $(className).css("opacity", 0.4);
});
}
highlightAllOnMouseover(".thing1");
highlightAllOnMouseover(".thing2"); 
```

HTML：

```
<p class = "thing1">This is thing1.</p>
<p class = "thing2">This is thing2.</p>
<p class = "thing1">This is also thing1.</p>
<p class = "thing2">This is also thing2.</p> 
```

要使具有特定类的所有元素在鼠标悬停时突出显示，您只需调用`highlightAllOnMouseover(className)`我在此处创建的函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T15:52:24.770

我不禁觉得这*应该*更简洁（使用*三个* `for (...)`循环感觉不必要地昂贵），但是一种方法：

```
Object.prototype.classHighlight = function (over, out) {
    var that = this.length ? this : [this];
    function onOver() {
        for (var i = 0, len = that.length; i < len; i++) {
            that[i].style.backgroundColor = over;
        }
    }
    function onOut() {
        for (var i = 0, len = that.length; i < len; i++) {
            that[i].style.backgroundColor = out;
        }
    }
    for (var i = 0, len = that.length; i < len; i++) {
        that[i].onmouseover = onOver;
        that[i].onmouseout = onOut;
    }
};

document.getElementsByClassName('test').classHighlight('#f90', '#fff'); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/5mmYR/)。

六年后，在链接到这个问题和答案之后，我正在编辑以更新上述方法，并添加片段和参考。

更新代码：

```
// extending the Object prototype to allow chaining of this method,
// 'over' : String, the class-name to add when the element(s) of the
// HTMLCollection/NodeList are hovered-over. We also set the default
// value of the 'over' variable in order that a class-name will always
// be present:
Object.prototype.classHighlight = function(over = 'over') {

  // taking the 'this' and using the spread operator to expand
  // the iterable collection to an Array:
  const that = [...this],

    // creating a named function to act as the event-handler for
    // 'mouseenter' and 'mouseleave':
    toggleHighlight = (event) => {
      // iterating over the array using Array.prototype.forEach():
      that.forEach(

        // we're not using 'this' in here, so using an Arrow function
        // to use the Element.classList API to toggle the supplied
        // class on each element of the collection. If the event-type
        // is exactly equal to 'mouseenter' we add the class otherwise
        // we remove the class:
        (el) => el.classList.toggle(over, event.type === 'mouseenter')
      );
    };
  // iterating over the collection, again using Array.prototype.forEach():
  that.forEach(
    // and another Arrow function:
    (element) => {

      // here we bind the toggleHighlight function - created above - as
      // the event-handler for both the 'mouseenter' and 'mouseleave'
      // events:
      element.addEventListener('mouseenter', toggleHighlight);
      element.addEventListener('mouseleave', toggleHighlight);
    });
};

// here we use document.getElementsByClassName() to retrieve an HTMLCollection
// of elements matching the supplied class-name; and then using chaining - which
// is why we extended the Object prototype - to pass that HTMLCollection to
// the classHighlight() function:
document.getElementsByClassName('test').classHighlight('whenOver');
```

```
.whenOver {
  background-color: #f90;
}
```

```
<p class="test">Testing</p>
<div>No classes here</div>
<ul>
  <li class="test">Something in a 'test' element</li>
</ul>
```

请注意，这种更新的方法，因为我们正在切换类名——而不是在元素的`style`属性中添加和清除内联样式——意味着选择器的特定性可能会干扰样式的应用，例如：

```
// extending the Object prototype to allow chaining of this method,
// 'over' : String, the class-name to add when the element(s) of the
// HTMLCollection/NodeList are hovered-over. We also set the default
// value of the 'over' variable in order that a class-name will always
// be present:
Object.prototype.classHighlight = function(over = 'over') {

  // taking the 'this' and using the spread operator to expand
  // the iterable collection to an Array:
  const that = [...this],

    // creating a named function to act as the event-handler for
    // 'mouseenter' and 'mouseleave':
    toggleHighlight = (event) => {
      // iterating over the array using Array.prototype.forEach():
      that.forEach(

        // we're not using 'this' in here, so using an Arrow function
        // to use the Element.classList API to toggle the supplied
        // class on each element of the collection. If the event-type
        // is exactly equal to 'mouseenter' we add the class otherwise
        // we remove the class:
        (el) => el.classList.toggle(over, event.type === 'mouseenter')
      );
    };
  // iterating over the collection, again using Array.prototype.forEach():
  that.forEach(
    // and another Arrow function:
    (element) => {

      // here we bind the toggleHighlight function - created above - as
      // the event-handler for both the 'mouseenter' and 'mouseleave'
      // events:
      element.addEventListener('mouseenter', toggleHighlight);
      element.addEventListener('mouseleave', toggleHighlight);
    });
};

// here we use document.getElementsByClassName() to retrieve an HTMLCollection
// of elements matching the supplied class-name; and then using chaining - which
// is why we extended the Object prototype - to pass that HTMLCollection to
// the classHighlight() function:
document.getElementsByClassName('test').classHighlight('whenOver');
```

```
li.test {
  background-color: fuchsia;
}
.whenOver {
  background-color: #f90;
}
```

```
<p class="test">Testing</p>
<div>No classes here</div>
<ul>
  <li class="test">Something in a 'test' element</li>
</ul>
```

这可以通过增加指定类名的选择器特异性来解决：

```
li.test {
  background-color: fuchsia;
}

html body .whenOver {
  background-color: #f90;
} 
```

```
Object.prototype.classHighlight = function(over = 'over') {

  const that = [...this],

    toggleHighlight = (event) => {
      that.forEach(
        (el) => el.classList.toggle(over, event.type === 'mouseenter')
      );
    };
  that.forEach(
    (element) => {
      element.addEventListener('mouseenter', toggleHighlight);
      element.addEventListener('mouseleave', toggleHighlight);
    });
};

document.getElementsByClassName('test').classHighlight('whenOver');
```

```
li.test {
  background-color: fuchsia;
}

html body .whenOver {
  background-color: #f90;
}
```

```
<p class="test">Testing</p>
<div>No classes here</div>
<ul>
  <li class="test">Something in a 'test' element</li>
</ul>
```

或者，您可以改为使用`!important`关键字来强制`!important`应用该 -ified 属性，而不管具体性如何（除非另一个规则也使用`!important`并且本身更具体），例如：

```
/* Note the ridiculous and overly-specific selector: */
html > body > ul > li.test {
  background-color: fuchsia;
}

.whenOver {
  / and here, as the demo shows, !important still
    wins: */
  background-color: #f90 !important;
} 
```

```
Object.prototype.classHighlight = function(over = 'over') {

  const that = [...this],

    toggleHighlight = (event) => {
      that.forEach(
        (el) => el.classList.toggle(over, event.type === 'mouseenter')
      );
    };
  that.forEach(
    (element) => {
      element.addEventListener('mouseenter', toggleHighlight);
      element.addEventListener('mouseleave', toggleHighlight);
    });
};

document.getElementsByClassName('test').classHighlight('whenOver');
```

```
html > body > ul > li.test {
  background-color: fuchsia;
}

.whenOver {
  background-color: #f90 !important;
}
```

```
<p class="test">Testing</p>
<div>No classes here</div>
<ul>
  <li class="test">Something in a 'test' element</li>
</ul>
```

但是，当涉及到`!important`时，请尽量避免使用它，因为正如 MDN 所指出的：

> 但是，使用`!important`是不好的做法，应该避免使用，因为它会破坏样式表中的自然 [级联]，从而使调试变得更加困难。
> 
> [“[例外”](https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity#The_!important_exception) [，`!important`](https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity#The_!important_exception) MDN]。

参考：

*   CSS：
    *   [选择器特异性](https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity#The_!important_exception)。*JavaScript：
    *   [`Array.prototype.forEach()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach).
    *   [箭头函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)。
    *   [`document.getElementsByClassName()`](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName).
    *   [`Element.classList`](https://developer.mozilla.org/en-US/docs/Web/API/Element/classList).
    *   [`EventTarget.addEventListener()`](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-08T20:07:55.020

这是一个零依赖解决方案，应该适用于非常旧的 JS 版本：

1.  添加`class = 'grp_N hovergrp'`到应在悬停时突出显示的所有元素，替换`N`为唯一描述一组元素的数字（或 id）。这些组可能不相交，每个具有`hovergrp`类的元素都应该属于一个`grp_N`类。

2.  将以下`JS`代码段附加`<script>...</script>`到您的末尾`<html>`：

```
 // collect all highlighted elements and group them by their group 
  // name for faster access;
  // Attach onmouseover and onmouseout listeners.
  var groups = {};
  var hovergrp = document.getElementsByClassName("hovergrp"); 
  for (var i = 0; i < hovergrp.length; i++) {
    var e = hovergrp.item(i);
    var eClasses = e.classList;
    for (var j = 0; j < eClasses.length; j++) {
      var c = eClasses[j];
      if (c.startsWith("grp_")) {
        if (!groups[c]) {
          groups[c] = [];
        }
        groups[c].push(e);
        e.onmouseover = (function(c_capture) {
          return function(_event) {
            highlightGroup(c_capture, "orange");
          };
        })(c);
        e.onmouseout = (function(c_capture) {
          return function(_event) {
            highlightGroup(c_capture, "transparent");
          };
        })(c);
        break;
      }
    }
  }

  function highlightGroup(groupName, color) {
    var g = groups[groupName];
    for (var i = 0; i < g.length; i++) {
      g[i].style.backgroundColor = color;
    }
  }
```

```
 <pre><code>
    // hover over variable names `<span class='grp_0 hovergrp'>x</span>` and `<span class='grp_1 hovergrp'>f</span>`
    kroneckerDelta(<span class='grp_0 hovergrp'>x</span>) {
      return function(<span class='grp_1 hovergrp'>f</span>) {
        <span class='grp_1 hovergrp'>f</span>(<span class='grp_0 hovergrp'>x</span>)
      }
    }
  </code></pre>

<p class = "grp_p1 hovergrp">This should be highlighted on mouseover</p>
<p class = "grp_p2 hovergrp">This should be highlighted on mouseover</p>
<p class = "grp_p1 hovergrp">This should be highlighted on mouseover</p>
<p class = "grp_p2 hovergrp">This should be highlighted on mouseover</p>
```

HTML 片段显示了使用示例：`<pre>`带有变量的小格式代码片段被分为两组。每当您将鼠标悬停在变量上时，该变量的所有用法以及绑定站点都会突出显示。

# reporting-services - 如何在 SSRS 中使用 datediff 求和

> ID：15960554
> 
> 赞同：0
> 
> 时间：2013-04-11T23:21:43.723
> 
> 标签：reporting-services, sum, expression, datediff

我的目标是从 Visual Studio 2008 中的 SSRS 表达式在我的 *.rdl 报告中获得以下结果。DueDate 和 InvoiceAmt 是绑定字段（fields!duedate.Value 和 fields!valuehome_1）。“NotDueYet”和“0-30 Days”是引用绑定字段的表达式的别名。

ClientInvoice>>>DueDate>>>InvoiceAmt>>>>NotDueYet>>>>0-30 天
4502767-00>>>>4/8/2013>>>>$75.89>>>>>>>>>>> >>>>>>>>>75.89 美元

4505151-00>>>>2013 年 4 月 11 日>>>137.26 美元>>>>>>>137.26 美元

**总计：****>>>>>>>>>>>>>>>>>>> $213.15** >>>>>>> $ **137.26** >>>>>> **$75.89**

问题：在别名列“NotDueYet”和“0-30 天”中，根据我下面支持总计的 iif/sum/datediff 表达式，总计应该是仅出现在这些列中的详细金额（参见上面的示例） . 明细金额基于引用 Duedate 和 InvoiceAmt 绑定字段的表达式。相反，我得到以下结果；

ClientInvoice>>>DueDate>>>InvoiceAmt>>>>NotDueYet>>>>0-30 天
4502767-00>>>>4/8/2013>>>>$75.89>>>>>>>>>>> >>>>>>>>>75.89 美元

4505151-00>>>>2013 年 4 月 11 日>>>137.26 美元>>>>>>>137.26 美元

**总计：****>>>>>>>>>>>>>>>>>>> $213.15** >>>>> ?>> **$0.00** **>>>>>>>> $** 213.15

 **这是我对每个领域的表达；

发票金额（详细信息）：

```
=(fields!valuehome_1.Value) 
```

发票金额（总计）：

```
=Sum(fields!valuehome_1.Value) 
```

NotDueYet（详细信息）：

```
= iif(datediff("d",fields!duedate.Value,now())<= 0 
and (fields!valuehome_1.value>0),fields!valuehome_1.Value,"") 
```

NotDueYet（总计）：

```
= iif(datediff("d",fields!duedate.Value,now())<= 0 
and (fields!valuehome_1.value>0),SUM(fields!valuehome_1.Value),0) 
```

0-30 天（详情）：

```
= iif(datediff("d",fields!duedate.Value,now())>0 
and (datediff("d",fields!duedate.Value,now())<31 
and (fields!valuehome_1.value>0),fields!valuehome_1.Value,"") 
```

0-30 天（总计）：

```
= iif(datediff("d",fields!duedate.Value,now())>0 
and (datediff("d",fields!duedate.Value,now())<31 
and (fields!valuehome_1.value>0),SUM(fields!valuehome_1.Value),0) 
```

我感谢任何帮助解决这个谜团。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T02:14:26.620

嵌套不太正确：试试这些表达式：

对于 NotDueYet（总计）：

```
=SUM(
    iif(datediff("d",fields!duedate.Value,now())<= 0
        and (fields!valuehome_1.value>0),
      fields!valuehome_1.Value,
      0)) 
```

0-30 天（总计）：

```
= SUM(
   iif(datediff("d",fields!duedate.Value,now())>0
       and (datediff("d",fields!duedate.Value,now())<31 
       and (fields!valuehome_1.value>0),
      fields!valuehome_1.Value,
      0)) 
```

我认为这应该得到你所追求的。**

# sql - 查找订单的平均美元金额

> ID：15960559
> 
> 赞同：1
> 
> 时间：2013-04-11T23:21:58.590
> 
> 标签：sql, sql-server-2008

我正在尝试查找订单的平均金额。我已经计算了平均订单总数，但我需要一个平均值，以考虑并非所有订单都有相应的 OrderItems 的事实。

这是一个家庭作业问题，如下所示：

> 订单的平均 $$ 价值是多少？要得到答案，您需要将所有订单值相加，然后除以订单数。这个问题有两个可能的平均值，因为并非 ORDERS 表中的所有订单号都在 ORDERITEMS 表中……您将计算并显示两个平均值。

我已经写了一个忽略没有 OrderItem 的订单，但不确定如何处理第二种情况。

```
 SELECT SUM(OrderItems.qty*INVENTORY.price)  / COUNT(*) AS dollarValue
    FROM Orders, OrderItems, Inventory
    WHERE ORDERS.orderid = OrderItems.orderid AND OrderItems.partid = Inventory.partid 
```

[链接到数据库图](http://dl.dropboxusercontent.com/u/55587776/pictures/SalesDB.jpg)![在此处输入图像描述](https://i.stack.imgur.com/tCw7F.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:09:30.470

该`Avg`函数不会`NULL`用零替换；它将被排除`NULL`在计算之外。如果您有`Order`没有的行，则`OrderItem`需要使用左连接。您可以在 SQL Server 中使用的一个技巧是像这样嵌套连接（注意括号）：

```
Select Avg(OI.Qty * I.Price)
From Orders As O
    Left Join (OrderItems As OI
        Join Inventory As I
            On I.PartId = OI.PartId)
        On OI.OrderId = O.OrderId 
```

这将在将结果连接`Inventory`到`OrderItems`表*之前*将表连接到`Orders`表。以这种方式，`OI.Qty`同时`I.Price`返回`NULL`没有 OrderItems 的订单并从计算中排除。与上述等效的方法是使用两个左连接：

```
Select Avg(OI.Qty * I.Price)
From Orders As O
    Left Join OrderItems As OI
        On OI.OrderId = O.OrderId
    Left Join Inventory As I
        On I.PartId = OI.PartId 
```

如果您想将没有 OrderItems 的订单计数为零，则需要使用以下方法将这些空值转换为零`Coalesce`：

```
Select Avg(OI.Qty * I.Price) As Avg_ExcludingNull
    , Avg( Coalesce(OI.Qty * I.Price,0) ) As Avg_NullAsZero
From Orders As O
    Left Join (OrderItems As OI
        Join Inventory As I
            On I.PartId = OI.PartId)
        On OI.OrderId = O.OrderId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:32:55.603

SQL 有一个聚合函数用于计算平均值：`AVG()`

```
SELECT AVG(OrderItems.qty*INVENTORY.price) AS dollarValue
FROM Orders, OrderItems, Inventory
WHERE ORDERS.orderid = OrderItems.orderid AND OrderItems.partid = Inventory.partid 
```

* * *

当我们在这里时，我建议您使用更现代的 JOIN 语法：

```
SELECT AVG(OrderItems.qty*INVENTORY.price) AS dollarValue
FROM Orders
JOIN OrderItems ON ORDERS.orderid = OrderItems.orderid
JOIN Inventory ON OrderItems.partid = Inventory.partid 
```

# javascript - 只是试图访问 a 元素中的值

> ID：15960560
> 
> 赞同：1
> 
> 时间：2013-04-11T23:22:00.883
> 
> 标签：javascript

我有多个`a elements`，它们是由 for 循环在页面视图上生成的，当它们被单击时，将它们发送`ajax post`到数据库，以通过其 id 标记数据库中的项目，这等于`a element`但我的值代码不起作用，有人知道为什么吗？谢谢。

```
<a href='#' value='(loaded from database)' id='markAsRead'>

var element = document.getElementById('markAsRead');

element.addEventListener('click', function() {
   alert(this.value);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:23:14.870

锚没有像输入那样的值，你应该使用数据属性

```
<a href='#' data-value='(loaded from database)' id='markAsRead'>

var element = document.getElementById('markAsRead');

element.addEventListener('click', function() {
 alert(this.getAttribute("data-value"));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:35:03.147

该`id`属性*必须*是唯一的。

如果您想拥有一组具有相同标识符的控件，您可以使用该`name`属性。

如果您查看 dom 操作的函数：

*   `document.getElementById()`- 元素（单数）
*   `document.getElementsByName()`- 元素（复数）

添加唯一（视情况而定）id 的示例

```
for (var index = 0; index < 10; index++) {
    var element = document.createElement("a");
    element.setAttribute("data-value", "your value");
    element.setAttribute("id", "markAsRead_" + index);
    element.addEventListener('click', function() {
        alert(this.getAttribute("data-value"));
    });
    document.getElementsByTagName("body")[0].appendChild(element);
} 
```

# wcf - WCF DataService 和 EntityFramework POCO 代理

> ID：15960567
> 
> 赞同：1
> 
> 时间：2013-04-11T23:22:17.170
> 
> 标签：wcf, entity-framework, serialization, wcf-data-services, wcf-ria-services

我有以下代码：

```
public class MyDataService : DataService< MyCustomContext >
{
    public static void InitializeService(DataServiceConfiguration config)
    {
        config.SetEntitySetAccessRule("*", EntitySetRights.AllRead);
        config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3;
    }
}

public class MyCustomContext
{
    public IQueryable<MyEntity> Entities
    {
        get
        {
            MyEfDbContext efDbContext = new MyEfDbContext();
            efDbContext.Configuration.LazyLoadingEnabled = true;
            efDbContext.Configuration.ProxyCreationEnabled = true;

            var entities = efDbContext.MyEntities;

            //*** lot of other codes filtering and checking the entities here

            return entities;
        }
    }
} 
```

问题是关于 EF 生成的 DynamicProxies ... WCF 无法处理发现这些代理，我想在“ *** ”中使用延迟加载。毫无疑问，请我从 dbcontext 禁用延迟加载和代理，它将被启用。

如果我使用反射提供程序（MyCustomContext）而不是EF提供程序（MyEfDbContext），我想知道是否存在另一种让DataService自己处理DynamicProxies的方法......

错误：“'System.Data.Entity.DynamicProxies.MyEntity_BB149ED9827DD6216E888718F322BA36146418D1D834B040FD3A1B630341CD90'类型不是复杂类型或实体类型。”

* * *

我已经检查了一些来源，以了解是否有解决方法，例如：

*   [http://sanderstechnology.com/2010/the-ado-net-entity-framework-poco-objects-and-you/10142/#.UWdGp5O38SI](http://sanderstechnology.com/2010/the-ado-net-entity-framework-poco-objects-and-you/10142/#.UWdGp5O38SI)

*   [http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataservices/thread/3e7e20bc-7ee2-4989-bf12-ddb228998636/](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataservices/thread/3e7e20bc-7ee2-4989-bf12-ddb228998636/)（伤心！！！）

我真的很感激任何帮助！

# c - 相邻位置之间的平均值

> ID：15960570
> 
> 赞同：0
> 
> 时间：2013-04-11T23:22:34.417
> 
> 标签：c

我有一个方阵，我需要在每个矩阵位置的邻居之间求平均值，每个矩阵位置的所有邻居都在矩阵本身内。

用一个例子来解释，如果我有一个这样的矩阵：

```
10 11  1  4
 5  1  6  9
 9  0  2  7
 7  4  9  8 
```

仅在 (2,2)、(2,3)、(3,2) 和 (3,3) 位置计算平均值。

在这些操作之后，最终的矩阵将如下所列：

```
5.00  4.56
4.78  5.11 
```

对不起，我的解释很混乱，我是 C 语言的初学者，我在做这个算法时遇到了很多困难。

我将感谢所有可以向我解释并向我展示解决方案的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:52:42.683

Since there is no code you show I guess your problem is in the creation of the algorithm itself rather than C.

I would suggest to 1\. have a function which averages numbers in a 3x3 matrix. 2\. make a loop which goes through your matrix applying this function to appropriate chunks.

Each of these steps is not hard to accomplish and I'm sure you'll find lots of code online which will help you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:53:36.027

**NOTE:** It is recommended that you show what you have tried or attempted so far. Usually, a generic open question without any prior attempt gets down-voted. Since, you are beginner and am a lover of image processing, I couldn't help writing this code and posting this solution to help you get started.

As Paulpro commented, your problem is a low-pass filter implementation. In a given data matrix, you will have to find out the points which could be averaged through a 3 x 3 window. Hence, first I will explain how to identify these points. Please find a sample code with comments below which will explain the identification of these points.

```
// Input Data
int input_array[4][4] = { {10, 11, 1, 4}, {5, 1, 6, 9}, {9, 0, 2, 7}, {7, 4, 9, 8}};

// To calculate the average 
float sum ;

// Row counter, column counter, dimension of the square matrix
int row_ctr, col_ctr, array_dimension;
int row, col;

array_dimension = 4; // Initialization

// Run the loop for the entire array    
for(row_ctr = 0; row_ctr < array_dimension; row_ctr++)
{
    // If the current row's top neighbor is outside the boundary or
    // the bottom neighbor is outside the boundary, PASS and continue with
    // next row
    if(((row_ctr - 1) < 0) || ((row_ctr + 1) >= array_dimension))
    {
        continue;
    }
    // Run the loop for array dimension
    for(col_ctr = 0; col_ctr < array_dimension; col_ctr++)
    {
         // If the current column's left neighbor is outside the boundary or
         // right neighbor is outside the boundary, PASS and continue with
         // next column
         if(((col_ctr - 1) < 0) || ((col_ctr + 1) >= array_dimension))
         {
              continue;
         }
         // Initialize sum to 0.0
         sum = 0.0;
         // Reset to Top Left corner by going (-1, -1) from current position
         row = row_ctr - 1; 
         col = col_ctr - 1;

         sum = input_array[(row+0)][col] + 
                 input_array[(row+0)][(col+1)]+ input_array[(row+0)][(col+2)];
         sum += input_array[(row+1)][col] + 
                  input_array[(row+1)][(col+1)]+ input_array[(row+1)][(col+2)];
         sum += input_array[(row+2)][col] + 
                  input_array[(row+2)][(col+1)]+ input_array[(row+2)][(col+2)];

         // Find the average    
         sum = sum / 9.0;
         printf("Average being found for (%d, %d) is %6.2f\n", row_ctr, col_ctr, sum);
     }
} 
```

When this code is executed the output would be displayed as

```
Average being found for (1, 1) is   5.00
Average being found for (1, 2) is   4.56
Average being found for (2, 1) is   4.78
Average being found for (2, 2) is   5.11 
```

# jquery - jQuery命中计数器

> ID：15960572
> 
> 赞同：1
> 
> 时间：2013-04-11T23:22:48.690
> 
> 标签：jquery, ajax, callback

我在 ip 上创建了一个独特的点击/点击计数器。

为了显示 clic 的数量，我在 body 标记上使用了 onload 函数。例如：

```
<body class="homepage" onload="affiche_compteur('compteur1'); affiche_compteur('compteur2');affiche_compteur('compteur3');affiche_compteur('compteur4');affiche_compteur('compteur5');affiche_compteur('compteur6');"> 
```

affiche_compteur（法语）= display_counter

我需要使用 onload 调用我的 html 页面中存在的每个点击计数器。（它适用于硬编码的元素，但是在我的情况下，我已经在文档上附加了我的 html 页面中不存在的元素（未硬编码））

有没有办法让点击计数器的每个 id 避免添加每个计数器 onload？

这是我的ajax脚本：

```
function getXhr(){
    var xhr = null; 
    if(window.XMLHttpRequest) {         
        xhr = new XMLHttpRequest(); 
    } else if(window.ActiveXObject) {   
        try {
            xhr = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            xhr = new ActiveXObject("Microsoft.XMLHTTP");
        }
    } else {
           alert("Votre navigateur ne supporte pas les objets XMLHTTPRequest..."); 
           xhr = false; 
    } 
    return xhr;
};
function affiche_compteur(id_clics)
{
    var xhr = getXhr();
    xhr.onreadystatechange = function()
    {
        if(xhr.readyState == 4 && xhr.status == 200){
            document.getElementById(id_clics).innerHTML = xhr.responseText;
        }
    };
    xhr.open('POST', './compteur/affiche_compteur.php', true);
    xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
    xhr.send('compteurId='+id_clics);
} 
```

这里是点击元素的 html：

```
<div class="element blog " id="_13">
<a class="link" href="/portfolio/dock.html" onclick="gestionClic('compteur13');">
</a>
</div>

<div class="element blog " id="_12">
<a class="link" href="/portfolio/dock.html" onclick="gestionClic('compteur12');">
</a>
</div>

<div class="element blog " id="_11">
<a class="link" href="/portfolio/dock.html" onclick="gestionClic('compteur11');">
</a>
</div> 
```

对不起我的英语，我是法国人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:27:46.473

```
if(xhr.readyState == 4 && xhr.status == 200){
           $(document).on('click','#'+id_clics,function(){
              gestionClic(id_clics);
           });
         document.getElementById(id_clics).innerHTML = xhr.responseText;
 } 
```

# html - Rails 如何在 HABTM 模型控制器中编写“创建”操作

> ID：15960573
> 
> 赞同：2
> 
> 时间：2013-04-11T23:22:54.477
> 
> 标签：html, database, ruby-on-rails-3

我对 Rails 比较陌生，并且在尝试使用它们之间具有 HABTM 关联的模型时遇到了巨大的困难。

这些是我的模型：

挑战.rb：

```
class Challenge < ActiveRecord::Base
    has_and_belongs_to_many :skills
    attr_accessible :description, :name, :relevant_content, :solutions, :skills
end 
```

技能.rb：

```
class Skill < ActiveRecord::Base
    has_and_belongs_to_many :challenges

    attr_accessible :name
end 
```

我还使用以下迁移创建了一个名为 challenge_skills 的连接表：

```
class CreateChallengesSkills < ActiveRecord::Migration
    def up
        create_table :challenges_skills, :id => false do |t|
        t.integer :challenge_id
        t.integer :skill_id
        end
    end

    def down
    drop_table :challenges_skills
    end
end 
```

我正在使用下面的助手来选择我的挑战所需技能：

```
<%= collection_select(:challenge, :skills, Skill.all, :id, :name, {}, {:multiple => "true"}) %> 
```

HTML：

```
<select id="challenge_skills" multiple="multiple" name="challenge[skills][]">
    <option value="2">Pesquisa</option>
    <option value="3">Senso Critico</option>
    <option value="4">Criatividade</option>
    <option value="5">Colaboracao</option>
    <option value="6">Comunicacao</option>
    <option value="7">Proatividade</option>
</select> 
```

这是我的参数哈希：

```
{"utf8"=>"✓",
 "authenticity_token"=>"n0ggK8eE7vjh+qY33lYbNLJtZW6Sz7LyM2IRVbAPwhM=",
 "challenge"=>{"description"=>"My description.",
 "skills"=>["", "3", "4"],
 "name"=>"Test Challenge",
 "relevant_content"=>"My relevant_content",
 "solutions"=>"My solutions"},
 "commit"=>"Create Challenge!"
} 
```

错误：需要技能（#70228688111620），得到字符串（#14953820）

问题是我不知道如何处理技能哈希，将其转换为我的挑战控制器创建动作中的对象数组。我知道这应该很简单，但我找不到实用的解决方案。我想知道如何编写代码以将技能集合与挑战控制器中的挑战实例相关联。

挑战控制器#create

```
def create

    @challenge = Challenge.new(params[:challenge])

    ??? 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-06-05T15:36:42.020

实际答案是在您接受的参数中添加“技能”：

```
def approved_params
  params.require(:challenge).permit(
    :name,
    :description,
    ...
    :skills => []
  )
end 
```

然后在您的创建/更新中：

```
def update
  @controller.update(approved_params)
end 
```

而已

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2013-04-11T23:26:43.100

我的建议是远离 HABTM 并切换到`has_many :through`它会更容易使用并且随着时间的推移更灵活地更改（添加属性）。

看

[http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association](http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association)

和

[https://stackoverflow.com/a/11601236/631619](https://stackoverflow.com/a/11601236/631619)

这是两者的一个很好的比较：

[http://railscasts.com/episodes/47-two-many-to-many](http://railscasts.com/episodes/47-two-many-to-many)

# php - php cli：使用 argv 和 getopt 不起作用

> ID：15960576
> 
> 赞同：0
> 
> 时间：2013-04-11T23:23:11.653
> 
> 标签：php, command-line-interface, argv, getopt

尝试使用 argv 变量和 getopt() 似乎不起作用。任何人都知道除了使用所有 - 或 - 选项之外的解决方法：

```
<?php
$arr[] = "test:";
$options = getopt(NULL, $arr);
echo $options["test"];
?> 
```

上面的简单示例，当我运行时：

```
php test.php --test="Hello World" 
```

你好世界

```
php test.php argv --test="Hello World" 
```

没有输出，因为我在它之前放置了一个没有 - 或 - 的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-13T19:19:57.923

```
function get_opt() {
    $options = array();
    foreach( $_SERVER[ "argv" ] as $key => $arg ) {
        if ( preg_match( '@\-\-(.+)=(.+)@', $arg, $matches ) ) {
            $key   = $matches[ 1 ];
            $value = $matches[ 2 ];
            $options[ $key ] = $value;
        } else if ( preg_match( "@\-(.)(.)@", $arg, $matches ) ) {
            $key   = $matches[ 1 ];
            $value = $matches[ 2 ];
            $options[ $key ] = $value;
        }
    }
    return $options;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-16T20:05:12.540

这有点蛮力，但它更好地解决了我的相关问题。根据 user3307546 的回答：

```
function get_opts() {
    $opts = array();
    foreach($_SERVER["argv"] as $k => $a){
        if(preg_match( '@\-\-(.+)=(.+)@'  , $a, $m))
            $opts[$m[1]] = $m[2];
        elseif(preg_match( '@\-\-(.+)@'   , $a, $m))
            $opts[$m[1]] = true;
        elseif(preg_match( '@\-(.+)=(.+)@', $a, $m))
            $opts[$m[1]] = $m[2];
        elseif(preg_match( '@\-(.+)@'     , $a, $m))
            $opts[$m[1]] = true;
        else
            $opts[$k] = $a;
    }
    return $opts;
} 
```

所以

```
> php cli/index.php gen/cache/reports -e --refresh-api -s="2020-04-16" -v 
```

被解析为

```
{
    0: "cli/index.php",
    1: "ttd/cache/reports",
    "e": true,
    "refresh-api": true,
    "s": "2020-04-16",
    "v": true
} 
```

所有“非选项”都以其在哈希键中的序号位置出现。

# mysql - 如何将查询分组或连接在一起以获取我需要的项目列表

> ID：15960577
> 
> 赞同：0
> 
> 时间：2013-04-11T23:23:11.923
> 
> 标签：mysql, sql

我有几张桌子：

```
Invoice
-----------------
ID        total     
1         500.00
2         100.00
3          10.00

Payment
---------------------------------------
ID    invoiceId     Amount   Method
1        1           400       CASH
2        2            60       CASH
3        2            40      CREDIT 
```

我需要一个查询来获取所有发票，其中至少一个 payment.method 是 CREDIT 并且该发票的所有付款的总和大于发票的总和。

我需要它快。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:51:11.033

Another method:

```
SELECT
  i.`id`,
  i.`total` AS `total_invoiced`,
  SUM(p.`amount`) AS `total_payments`,
  SUM(IF(p.`method`='credit', 1, 0)) AS `count_credit`
FROM `invoices` i
LEFT JOIN `payments` p ON (p.`invoice_id`=i.`id`)
WHERE 1=1
GROUP BY i.`id`
HAVING (`total_payments` > i.`total`) AND (`count_credit` > 0) 
```

I changed some table/field names. Sorry for the inconvenience.

[http://www.sqlfiddle.com/#!2/7402d/1/0](http://www.sqlfiddle.com/#!2/7402d/1/0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:39:47.600

```
SELECT  a.ID InvoiceID,
        a.Total TotalInvoice, 
        b.TotalPayment
FROM    Invoice a
        INNER JOIN
        (
            SELECT  InvoiceID, SUM(Amount) TotalPayment
            FROM    Payment
            GROUP   BY InvoiceID
            HAVING  SUM(Method = 'CREDIT') > 0
        ) b ON a.ID = b.InvoiceID AND
                a.Total < b.TotalPayment 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/cf7af/3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:39:02.660

试试这个：

```
 select iagg.ID 
      from (
                select i.ID
                     , sum (p.amount)   tl_paid
                     , min (i.total)    tl
                  from invoice  i
                  join payment  p   on  ( p.invoiceID = i.ID )
              group by i.ID
           )  iagg
     where exists (
                select 1
                  from payment p2
                 where p2.invoiceId = iagg.ID
                   and p2.method    = 'CREDIT'
           )
       and iagg.tl_paid > iagg.tl
         ; 
```

属性上的最小值运算符`total`由分组运算符规定，最小值实际上取自一组相同的值。

# php - 关于具有动态元素并需要保存在 PHP 中的表单的逻辑想法

> ID：15960586
> 
> 赞同：0
> 
> 时间：2013-04-11T23:24:09.967
> 
> 标签：php, jquery, forms

我有一个带有选择下拉字段的表单。使用 jQuery，我允许用户通过克隆功能添加更多选择下拉菜单。但是，由于这种动态上下文，我如何正确编码通过 PHP 保存表单的逻辑？

HTML

```
<form action="process.php" method="post">
     <div class="row">
          <select name="items">
               <option value="box1">Box 1</option>
               <option value="box2">Box 2</option>
          </select>
          <input type="text" name="text" value="" />
     </div>
     <input type="submit" name="submit" value="submit" />
</form>
<a href="#" class="add">ADD</a> 
```

JS

```
$( 'a.add' ).click( function() {
     var clone = $( 'form .row:first-child' ).clone( true );
     $( clone ).appendTo( 'form' );
} ); 
```

PHP

```
if ( isset( $_POST ) && $_POST['submit'] === 'submit' ) {
     $items = mysql_real_escape_string( $_POST['items'] );
     $text = mysql_real_escape_string( $_POST['text'] );

     if ( isset( $items ) )
          // do save db routine

     if ( isset( $text ) )
         // do save db routine
} 
```

因此，如果您查看上面的 PHP 代码，它适用于在添加任何动态项之前的正常形式，并且工作正常……但是如果添加了动态元素，我只是不知道如何去改变它。

请注意，每个选择和输入必须属于一起。

感谢您的关注。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T15:54:27.073

好的，我解决这个问题的方法是使用数组作为字段名称，例如从上面的代码中。

```
<form action="process.php" method="post">
     <div class="row">
          <select name="items[]">
               <option value="box1">Box 1</option>
               <option value="box2">Box 2</option>
          </select>
          <input type="text" name="text[]" value="" />
     </div>
     <input type="submit" name="submit" value="submit" />
</form>
<a href="#" class="add">ADD</a> 
```

因此，当 jQuery 克隆它时，这会解决重复的字段名称。在 PHP 中，我会计算其中一个字段提交了多少项目，并将其用作循环遍历表单项目的基础。

```
// get all data from db here
$count = count( $items );

for ( $i = 0; $i < $count; $i++ ) {
 // loop through form items here
} 
```

# c# - 在 C# 应用程序中使用第 3 方上下文菜单（用于 Windows 资源管理器）？

> ID：15960588
> 
> 赞同：8
> 
> 时间：2013-04-11T23:24:14.280
> 
> 标签：c#, c++, tortoisesvn, contextmenu, windows-shell

与希望向 Windows 资源管理器中添加项目的其他人不同，我想在我的应用程序中显示上下文菜单。现在您可能在想，您要查找的类是`ContextMenu`. 让我告诉你我有兴趣做什么。*小图请见谅。。。*

这是我目前拥有的：

![我当前的上下文菜单](https://farm9.staticflickr.com/8541/8640924264_3f5e0877f3_s.jpg)

这就是我想要的：

![我希望它看起来像什么](https://farm9.staticflickr.com/8406/8640924274_d46e210412_s.jpg)

让我们把假设排除在外。我已经检测到用户安装了 TortoiseSVN 并且他们选择的项目处于源代码控制之下。

到目前为止我的研究：

[检索上下文菜单](http://gong-shell.sourceforge.net/)- 这非常有用。这是 Windows 资源管理器的 ac# 库（可以检索特定文件夹/文件的上下文菜单）。然而，即使在测试示例时，它也不会检索 TortoiseSVN 选项。

[另一个上下文菜单检索](http://www.codeproject.com/Articles/15059/C-File-Browser)- 与上一个链接几乎相同（再次使用 C# 代码）。获取 Windows 资源管理器上下文菜单减去 TortoiseSVN 选项。

[添加上下文菜单的过程](https://stackoverflow.com/questions/451287/how-do-you-show-the-windows-explorer-context-menu-from-a-c-sharp-application)- 我刚刚开始阅读这些深入的帖子。答案可能在本文中，但我需要一些时间才能完成它。如果我对这些有任何运气，我会回复一个答案。

[用户似乎能够做到这一点](http://svn.haxx.se/tsvn/archive-2009-09/0238.shtml)- 这似乎是一个处理 SVN 开发的电子邮件组。为什么要发在这里？也许是为了证明这是可以做到的。引用：“我正在使用 TSVN shell 上下文菜单。我正在使用`IContextMenu.QueryContextMenu`（C++ 代码）方法访问 TSVN shell 上下文菜单，然后我正在浏览返回的菜单。”

总而言之，这似乎应该是一件相当直接的事情，而我只是错过了一步。欢迎任何和所有建议。谢谢！

编辑：尝试更好地利用标签和更集中的标题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-24T20:23:23.067

最终我自己重新实现了 ContextMenu，而不是试图从 Windows 资源管理器中提取。添加对[TortoiseSVN](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-automation.html)的直接调用（如前所述）。不是我想要的超级优雅的解决方案，但它当然有效！

我会注意到用户 oefe 指出主要问题可能是由于 x86 与 x64 （TortoiseSVN 在我的开发机器上安装为 x64）。如果其他用户尝试完成类似的任务，他们可能希望对此进行调查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:25:37.183

希望以下内容可以帮助您入门

*   [在 c# winforms 应用程序中显示窗口（文件/目录）上下文菜单](https://stackoverflow.com/q/2583946/1012641)

    上面的链接包含以下[答案](https://stackoverflow.com/a/7970038/1012641)，显示类似于您想要的内容

*   [如何从 C# 应用程序显示 Windows 资源管理器上下文菜单？](https://stackoverflow.com/q/451287/1012641)

# xml - 属性文件是什么样的（与 Ant 相关）？

> ID：15960589
> 
> 赞同：1
> 
> 时间：2013-04-11T23:24:22.533
> 
> 标签：xml, ant

我目前正在进行练习，我被困在任务中。在这个任务中，我必须创建一个属性文件，但我不确定属性文件是什么样的。它是 .xml 还是 .java 文件？

我得到了这个示例代码：

```
<property name="build.debug" value="on"/>
<javac srcdir="src" debug="${build.debug}"/> 
```

并执行以下命令：>ant -Dbuild.debug=off –f yourBuildFile.xml

但是，当我将这两行代码放在我的 .xml 文件中时，没有任何输出。

帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:47:17.833

您询问了*属性文件*的外观。它几乎是一堆形式的行：

```
key = value 
```

而已。这是一个例子：

```
ivy.cleancache = false
ivy.log = default
javac.lint = false
javac.deprecation = true 
```

注释行以`#`.

现在，你有什么...

您显示的两行看起来像是 Ant 文件的一部分。默认情况下，Ant 文件被调用`build.xml`并且必须包含在一个`<project>`实体中。

```
<project>
   <property name="build.debug"
        value="on"/>

   <javac srcdir="src" 
       debug="${build.debug}"/>
</property> 
```

该`<property>`行设置了一个名为`build.debug`to的属性`on`。该`<javac>`行在`*.java`directory 下的所有文件上运行 Java 编译器`src`。由于您没有指定目标目录，因此这些`*.java`文件已*就地编译。*因此，您会看到一堆`*.class`文件与您的文件混合在一起`*.java`。事件的正常过程是创建一个`*.class`文件可以存放而不会干扰源文件并且易于清理的地方：

```
<project>
   <property name="build.debug"
        value="on"/>

   <mkdir dir="target/classes"/>

   <javac srcdir="src" 
       destdir="target/classes"/>
       debug="${build.debug}"/>
</property> 
```

现在，当您运行脚本时，它会将所有`*.class`文件放在该`target/classes`目录下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:26:10.763

它是一个 java .properties 文件。看到这个：

[http://en.wikipedia.org/wiki/.properties](http://en.wikipedia.org/wiki/.properties)

**- - - - - - - 编辑 - - - - - -**

ant build.xml 应该如下所示：

```
<project name="MyProject" default="dist" basedir=".">
    <description>
        simple example build file
    </description>
  <!-- set global properties for this build -->
  <property name="src" location="src"/>
  <property name="build" location="build"/>
  <property name="dist"  location="dist"/>

  <target name="init">
    <!-- Create the time stamp -->
    <tstamp/>
    <!-- Create the build directory structure used by compile -->
    <mkdir dir="${build}"/>
  </target>

  <target name="compile" depends="init"
        description="compile the source " >
    <!-- Compile the java code from ${src} into ${build} -->
    <javac srcdir="${src}" destdir="${build}"/>
  </target>

  <target name="dist" depends="compile"
        description="generate the distribution" >
    <!-- Create the distribution directory -->
    <mkdir dir="${dist}/lib"/>

    <!-- Put everything in ${build} into the MyProject-${DSTAMP}.jar file -->
    <jar jarfile="${dist}/lib/MyProject-${DSTAMP}.jar" basedir="${build}"/>
  </target>

  <target name="clean"
        description="clean up" >
    <!-- Delete the ${build} and ${dist} directory trees -->
    <delete dir="${build}"/>
    <delete dir="${dist}"/>
  </target>
</project> 
```

然后将其保存在项目的根文件夹中`build.xml`，打开控制台并将目录更改为该项目，然后运行`ant`​​.

有关更多信息，请查看此处：[http ://ant.apache.org/manual/using.html](http://ant.apache.org/manual/using.html)

# php - PHP中的成员和函数继承

> ID：15960596
> 
> 赞同：1
> 
> 时间：2013-04-11T23:24:38.370
> 
> 标签：php, oop

我还是 PHP 新手，遇到了很多麻烦。我习惯了 C、C++ 和 Java 之类的语言，这让我有点困惑。基本上我的问题是我有以下代码：

```
class File_Reader 
{

    protected $text;

    public function Scan_File (){}

    public function Skip_Whitespace(&$current_pos)
    {
        //skip past whitespace at the start
        while (($current_pos < strlen($text) && ($text[$current_pos] == ' ')))
            $current_pos++;
    }

    public function __construct(&$file_text)
    {
        $text = $file_text;
    }
}

class Times_File_Reader extends File_Reader
 {
     Public Function Scan_File()
     {
         $errors = array();
         $times = array();
         $current_time;
         $cursor = 0;
         $line = 0;
         while ($cursor < strlen($text))
         {

             Skip_Whitespace($cursor);
             //....lots more code here...
             return $times;
         }
     }
 } 
```

但是当我尝试运行它时，它告诉我 $time 和 Skip_Whitespace 都是未定义的。我不明白，他们应该是继承的。我尝试在 File_Reader 构造函数中放置一个 echo 命令，当我创建 Times_File_Reader 时它确实进入了构造函数。

哦，为了完整起见，这里是我声明 Times_File_Reader 的地方：

```
 include 'File_Readers.php';

  $text = file_get_contents("01_CT.txt");
  $reader = new Times_File_Reader($text);
  $array = $reader->Scan_File(); 
```

我一直在寻找几个小时的答案无济于事，截止日期很快就要到了。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:32:51.607

我相信您需要注意您正在使用类函数

`$this->Skip_Whitespace($cursor);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:32:04.797

您需要将传递给构造函数的属性设置为类的属性（方法中的变量的作用域与 Java 相同）。

你可以使用 $this->property

```
// File_Reader
public function __construct(&$file_text)
{
    $this->text = $file_text;
}

// Times_File_Reader
public function Scan_File()
{
    $errors = array();
    $times = array();
    $current_time;
    $cursor = 0;
    $line = 0;
    while ($cursor < strlen($this->text))
    {
        $this->Skip_Whitespace($cursor);
        //....lots more code here...
        return $times;
    }
} 
```

编辑-顺便说一句，您似乎正在使用一些古怪的下划线/标题大小写混合。PHP 的最佳实践是对方法使用 lowerCamelCase，对类名使用 CamelCase。

```
class FileReader
class TimesFileReader
public function scanFile() 
```

另外-您通过引用（&$var）传递变量-您可能不必这样做（我能想到的唯一有效用例是在某些情况下使用闭包/匿名函数）。我承认这方面的文档不是很清楚。[http://schlueters.de/blog/archives/125-Do-not-use-PHP-references.html](http://schlueters.de/blog/archives/125-Do-not-use-PHP-references.html)

```
public function __construct($file_text)
{
    $this->text = $file_text;
} 
```

# android - SDK示例项目中有很多错误

> ID：15960599
> 
> 赞同：0
> 
> 时间：2013-04-11T23:24:56.680
> 
> 标签：android

我在导入的示例项目中遇到很多错误，我尝试清理项目并来回更改编译器级别，但它没有帮助，还尝试添加支持库。

我得到示例的方式是文件>新>其他> android项目示例

我遇到的一些错误

片段 Tabhost 无法解析为类型。

片段页面适配器无法解析为类型。

导入 android.support.v13 无法解析。

方法get count() 类型为action bar tab pager。tabadapter 必须覆盖实现超类型方法。

我还没有弄乱它打开它时出现的所有错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:31:15.043

看来您缺少支持库。为了安装它：

*   右键单击您的项目
*   选择 Android 工具 / 添加支持库...
*   按照对话步骤

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-23T14:53:40.790

正如上面的答案所述，添加缺少的库，可以在“sdk”/extras/android/support/v13/ 和“sdk”/extras/android/support/v4/ 中找到

[http://developer.android.com/tools/support-library/features.html](http://developer.android.com/tools/support-library/features.html)

我通过在我的项目中添加外部 jar 来做到这一点。

1.  右键单击项目
2.  点击**属性**
3.  选择**Java 构建路径**
4.  选择**库**选项卡
5.  单击**添加外部罐子**...按钮
6.  浏览到“sdk*”/extras/android/support/v4/
7.  选择**android-support-v4**
8.  点击打开或进入

对 v13 执行相同操作，错误就会消失。

*这是您的 sdk 所在的位置。

# java - Thread.sleep() 中的奇怪行为

> ID：15960607
> 
> 赞同：1
> 
> 时间：2013-04-11T23:25:44.273
> 
> 标签：java, sleep

我注意到一些非常奇怪的事情（最终导致我的游戏崩溃），`Thread.sleep()`我无法弄清楚问题可能是什么。我已经连续运行了两个小时以下方法，输出始终为 100+-5；

```
public void gameLoop() {
    t0 = time();
    while (GameState.getInstance().getState() == GameCondition.RUNNING) {

        engine.update();
        sfx.play();

        t1 = time();
        delta = t1 - t0;

        gfx.render((int) delta);
        t0 = time();
        System.out.println(delta);
        sleep(100);
    }
} 
```

现在，如果我运行完全相同的方法，但不是为常数 100 睡觉，而是为`delta`

```
public void gameLoop() {
    t0 = time();
    while (GameState.getInstance().getState() == GameCondition.RUNNING) {

        engine.update();
        sfx.play();

        t1 = time();
        delta = t1 - t0;

        gfx.render((int) delta);
        t0 = time();
        System.out.println(delta);
        sleep(delta);
    }
} 
```

现在输出显示：

```
0

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

2

....
 After a minute
 571 
```

我不知道是我太累了，犯了一个明显的错误还是发生了一些很奇怪的事情，这里是睡眠。

```
private void sleep(long milliSeconds) {
    System.out.println();
    try {
        Thread.sleep(milliSeconds);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
} 
```

编辑：问题？delta 正在“泄漏”，因为内部方法（在睡眠之前）几乎不使用任何时间（如`sleep(100)`测试所证明的那样），我希望 delta 非常精确，波动很小甚至没有波动，但它会不断增长。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T23:48:21.397

在您的循环中，您的增量计算包含先前睡眠的时间，然后为这个新的增量时间休眠。如果睡眠（或你的代码）很慢（比如 1ms，这可能会发生），那么你的 delta 下次会长 1ms，所以你会睡 2ms。

自从您上次睡了 2 毫秒以来，您的下一次迭代将至少为 2 毫秒。如果睡眠或您的代码再次变慢（这将发生），那么您下次将睡眠 3 毫秒，依此类推。您正在累积由于您的增量可能发生的所有缓慢，包括之前的睡眠时间和其中的任何错误。

# python - 读到一点 Python

> ID：15960608
> 
> 赞同：3
> 
> 时间：2013-04-11T23:25:45.737
> 
> 标签：python, text, python-3.3, readlines

我有一个包含以开头的数据的文本文件

```
#Name
#main 
```

然后后面跟着很多数字，然后文件以

```
#extra
!side 
```

所以这里有一个小片段

```
#Name
#main
60258960
33031674
72302403
#extra
!side 
```

我只想阅读数字。但这是关键，我希望他们每个人都是他们自己的个人字符串。

所以我知道如何在标题之后阅读

```
read=f.readlines()[3:] 
```

但我对其他一切都感到困惑。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T23:31:36.330

逐行阅读。使用#main 作为标志来开始处理。使用#extra 作为标志来停止处理。

```
start = '#main'
end = '#extra'
numbers = []
file_handler = open('read_up_to_a_point.txt')
started = False
for line in file_handler:
    if end in line:
        started = False       
    if started:
        numbers.append(line.strip())
    if start in line:
        started = True
file_handler.close()
print numbers 
```

样本输出

python read_up_to_a_point.py ['60258960'，'33031674'，'72302403']

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T23:31:43.807

你很接近，就像你一样。您只需要修改列表切片以将文件中的最后两行连同前两行一起删除。`readlines`自然会返回一个列表，其中每个项目都是文件中的一行。但是，它在每个字符串的末尾也会有“换行符”字符，因此您可能需要将其过滤掉。

```
with open("myfile.txt") as myfile:
    # Get only numbers
    read = myfile.readlines()[2:-2]

# Remove newlines
read = [number.strip() for number in read]
print read 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T23:35:30.820

我会做这样的事情：

```
nums = []
for line in f:
  stripped = line.rstrip('\n')
  if stripped.isnumeric():
    nums.append(stripped) 
```

`nums`将仅包含那些带有数字的行。如果您的数字格式正确，则表示不是负数，也不是十六进制。这将需要一个正则表达式来精确匹配。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-13T00:02:08.297

在没有参数的情况下使用它并不总是一个好主意（甚至可能是一个可行的主意），`readlines()`因为它会读取整个文件并可能会消耗大量内存 - 如果您不需要全部，则可能没有必要这样做一次，这取决于你在做什么。

所以，做你想做的事情的一种方法是使用 Python*生成器函数*从文件中提取你需要的行或值。它们很容易创建，本质上您只需使用`yield`语句来返回值而不是`return`. 从编程的角度来看，它们之间的主要区别在于，`yield`下次调用函数时将继续执行语句之后的行，而不是通常情况下的第一行。这意味着它们的内部状态会在后续调用之间自动保存，这使得在它们内部进行复杂的处理变得更容易。

这是一个相当小的示例，它使用一个来从文件中获取您想要的数据，一次一行地递增，因此它不需要足够的内存来保存整个文件：

```
def read_data(filename):
    with open(filename, 'rt') as file:
        next(file); next(file)  # ignore first two lines
        value = next(file).rstrip('\n')  # read what should be the first number
        while value != '#extra':  # not end-of-numbers marker
            yield value
            value = next(file).rstrip('\n')

for number in read_data('mydatafile'):
    # process each number string produced 
```

当然，如果您愿意，您仍然可以将它们全部收集到一个列表中，如下所示：

```
numbers = list(read_data('mydatafile')) 
```

如您所见，可以在函数中执行其他有用的操作，例如验证文件数据的格式或以其他方式对其进行预处理。在上面的示例中，我通过删除`readlines()`它返回的列表的每一行上留下的换行符来做了一些事情。`yield int(value)`通过使用而不是 just将每个字符串值转换为整数也很简单`yield value`。

希望这能让您充分了解在决定使用哪种方法来执行手头任务时可能发生的事情以及所涉及的权衡取舍。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-29T23:50:30.920

仅`.readlines()`当您知道您的输入文件可以舒适地放入内存时才应该使用；它一次读取所有行。

大多数情况下，您一次可以读取一个输入行，为此您可以迭代文件句柄对象。

当您需要特殊的、棘手的输入处理时，我建议将处理封装在生成器函数中，如下所示：

```
def do_something_with_point(point):
    print(point)

class BadInputFile(ValueError):
    pass

def read_points_data(f):
    try:
        line = next(f)
        if not line.startswith("#Name"):
            raise BadInputFile("file does not start with #Name")

        line = next(f)
        if not line.startswith("#main"):
            raise BadInputFile("second line does not start with #main")
    except StopIteration:
        raise BadInputFile("truncated input file")

    # use enumerate() to count input lines; start at line number 3
    # since we just handled two lines of header
    for line_num, line in enumerate(f, 3):
        if line.startswith("#extra"):
            break
        else:
            try:
                yield int(line)
            except ValueError:
                raise BadInputFile("illegal line %d: %s" % (line_num, line))
            # if you really do want strings: yield line
    else:
        # this code will run if we never see a "#extra" line
        # if break is executed, this doesn't run.
        raise BadInputFile("#extra not seen")

    try:
        line = next(f)
        if not line.startswith("!side"):
            raise BadInputFile("!side not seen after #extra")
    except StopIteration:
        raise BadInputFile("input file truncated after #extra")

with open("points_input_file.txt") as f:
    for point in read_points_data(f):
        do_something_with_point(point) 
```

请注意，此输入函数会彻底验证输入，当输入有任何不正确时会引发异常。但是使用输入数据的循环简单而干净；使用的代码`read_points_data()`可以整洁。

我`read_points_data()`将输入点转换为`int`值。如果你真的想要点作为字符串，你可以修改代码；我在那里留下评论以提醒您。

# android - 构建 Android 应用 PhoneGap 键盘“7”关闭应用

> ID：15960615
> 
> 赞同：0
> 
> 时间：2013-04-11T23:26:42.163
> 
> 标签：android, cordova

我正在使用 PhoneGap 构建一个应用程序，当我在文本字段中输入数字“7”时，应用程序关闭。这只发生在我的 Nexus 10 上，而不是我的 Galaxy Skyrocket。可能是什么原因？

# php - Wordpress - 插件页面上的更新通知

> ID：15960617
> 
> 赞同：1
> 
> 时间：2013-04-11T23:26:45.900
> 
> 标签：php, wordpress, plugins, updates

目前，如果您使用 Wordpress 插件目录（托管您的插件），您可以使用 SVN 管理更新和版本更改。运行该插件的任何人都会收到版本更改通知，并且可以选择自动升级它。

当有可用更新时，如何在插件页面（在仪表板中）添加自定义消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:24:42.383

我在 WordPress Answers[回答了同样的问题。](https://wordpress.stackexchange.com/a/90899/12615)

在更新通知中添加自定义消息的操作挂钩是`in_plugin_update_message-{$folder}/{$file}`，文件夹/文件来自您要定位的插件：

```
$file   = basename( __FILE__ );
$folder = basename( dirname( __FILE__ ) );
$hook = "in_plugin_update_message-{$folder}/{$file}";
add_action( $hook, 'update_message_wpse_87051', 10, 2 ); 

function update_message_wpse_87051( $plugin_data, $r )
{
    echo 'Hello World';
} 
```

而且，正如您注意到的*“任何运行该插件的人都会收到通知”*，这仅适用于活动插件。

PS：澄清一下，如果代码包含在该插件中，它仅适用于活动插件。如果我们在另一个活动插件、必须使用插件或主题中使用此代码`functions.php`，则无论目标插件是否处于活动状态，都会显示消息。

# jquery - 效率：使用 jQuery 选择不在 DOM 中的对象

> ID：15960621
> 
> 赞同：1
> 
> 时间：2013-04-11T23:27:21.120
> 
> 标签：jquery, performance, optimization

我敢肯定这是一个经常被问到的问题；我似乎无法以某种方式说出它来找到所说的答案。

通常的做法是尽量减少加载的 CSS 和 JS 文件的数量。然而，我总是假设如果我有一个 jQuery 选择器搜索但没有找到任何东西（特别是一个类选择器），那么这样做会慢得多，然后加载一个单独的页面。

例如，我在一个网站上编写了一个私人消息系统。我使用 AJAX 发送和删除消息。用于此的选择器在其他任何地方都未使用。我是不是更好：

a) 在单独的 JS 文件中具有特定于页面的脚本，加载到每个所述页面上。

b) 将代码放在一个页面中，让每个选择器按原样运行

c) 将代码放在一个页面中，但使用 if 语句来检查我们是否在特定页面上，并且只有在 if 块下的那些选择（每个页面都有一个唯一的 ID，所以我可以测试这个 ID 和做一个 if/else 链）

# python - 使用 scipy.optimize 快速找到函数等于 0 的第一个点

> ID：15960622
> 
> 赞同：6
> 
> 时间：2013-04-11T23:27:26.057
> 
> 标签：python, scipy, mathematical-optimization, minimization

基本上，给定一个针对不同参数产生类似输出的函数：

![在此处输入图像描述](https://i.stack.imgur.com/2tq8B.png)

我想快速找到函数等于 0 的第一个 x。因此，对于在 x 上产生蓝色曲线的参数，我想找到 x=134。对于绿色曲线，我想找到 x=56 等。

~~我*认为*该函数将始终单调递减，直到达到零，但我不完全确定。~~

该函数不一定是单调递减的。

我确信它只会命中 0 一次，然后保持为零*。*

目前我通过迭代 x 值直到我达到零来强制它，但我想要一些能更好地做出有根据的猜测（基于斜率？）和迭代的东西。

理想情况下，我想使用一些已经成熟的东西（[因为 90% 的程序员甚至无法正确编写二进制搜索](https://en.wikipedia.org/wiki/Binary_search_algorithm#Implementation_issues)），比如[scipy.optimize](http://docs.scipy.org/doc/scipy-dev/reference/optimize.html)中的东西，但似乎那些人都想找到一个全局最小值或零-穿越。

（这个函数有点像 Lch 颜色空间中给定色度的 RGB 立方体的 distance_to_the_wall （所以基本上是构建一个“合理地剪辑到 RGB”函数），但是由于 IRGB 和 LCh 之间的映射可能因库和参数而异发光体等。我认为最好只尝试几个值，直到找到正确的值，而不是尝试直接反向计算值？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:54:48.910

Try [bisection](https://en.wikipedia.org/wiki/Bisection_method): Check if it's 0 in the middle of your interval; if it is, continue on the left, otherwise, on the right. Do the same thing with the reduced interval recursively until you're close enough. This method is of complexity O(log n) compared to yours, which is O(n).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T00:44:45.467

这是一些充实@ExP的二分/二分搜索答案的代码：

```
def find_first_zero(func, min, max, tol=1e-3):
    min, max = float(min), float(max)
    assert (max + tol) > max
    while (max - min) > tol:
        mid = (min + max) / 2
        if func(mid) == 0:
            max = mid
        else:
            min = mid
    return max 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:50:15.717

如果不是因为曲线的右手处处处为 0，牛顿的方法（[https://en.wikipedia.org/wiki/Newton's_method](https://en.wikipedia.org/wiki/Newton%27s_method)）会很好用。但我认为一个变体仍然可以正常工作：

1）选择一个点。

2）如果我们在斜坡上，则在本地获取斜坡的梯度并从那里追踪一条线到 x 截距并将其作为您的新点（转到 1））。

3）如果我们在平坦的平原上（x = 0，导数 = 0），那么如果左边一点是斜坡（必须调整它以找出剩下多少要检查），然后进行局部搜索（可能是带公差的二分搜索）找到函数首先等于零的点。如果不是，则取该点和我们尝试过的斜坡上最后一个点之间的中间点（使用这个新点转到 1）。

要估计导数（以确定您是否在斜坡上），您可以在左侧和右侧采样一个点，距离足够远，您确信您将获得导数的平滑近似值。

# ios - iOS：UIKit - UIPopoverVIew 中的图像/按钮/页面

> ID：15960629
> 
> 赞同：1
> 
> 时间：2013-04-11T23:27:47.740
> 
> 标签：ios, uikit, popover

我有一些非常简单的问题，但很难找到答案；）

图片来自 Apple 的 Numbers 应用程序：

**图 1)**

他们如何将这 4 个拆分放在`UIPopover`原位的顶部？他们如何将 2 个拆分按钮（“2D/3D”）放在里面`UIPopover`？那里怎么可能有几 (6) 个图像作为可点击项目？

最后一个问题：如何将所有这些与表格视图混合 - “图表选项”似乎是一个表格视图单元格。

**图 2)**

很像第一个有不同的图像可供选择，但这次它有多个页面，这正是我所需要的。复制这个的提示会很棒:)

我只需要知道要查找什么 - 如何准确复制此布局。

![在此处输入图像描述](https://i.stack.imgur.com/Qf48w.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/VCD0j.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:35:36.790

在您的示例中，Apple 可能正在`UIViewController`使用`UIPopoverController`. 然后，他们可以执行您通常在 a 中执行的任何操作`UIViewController`- 例如添加`UISegmentedControl`您询问的内容。

对于您关于如何将“切换”放入弹出框顶部的问题，Apple 可能将视图控制器包含在`UINavigationController`. 然后他们`titleView`将导航栏的属性设置为`UISegmentedControl`.

图片中的图像网格可能是一`UICollectionView`对打开的`UIScrollView`。`paging`

> **免责声明：**
> 
> 我与构建 Numbers 的 Apple 团队没有任何联系，因此只有应用程序本身可以推断他们做了什么。除非*苹果公司的*人站出来告诉（他们不会），否则我们不确定他们做了什么。

# javascript - 无法在 Spotify 应用中使用“getSpotifyApi”功能

> ID：15960631
> 
> 赞同：0
> 
> 时间：2013-04-11T23:28:05.030
> 
> 标签：javascript, api, spotify

无论我们尝试什么，每次我尝试调用函数“getSpotifyApi”时，它总是返回：“ReferenceError: getSpotifyApi is not defined”

我不知道从哪里开始，因为如果它不允许我使用它的 api，我就无法对 spotify 做任何事情......

我所有的 javascript 代码都在我的应用程序的 index.html 中的标签中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T05:18:19.237

如果`getSpotifyApi`未定义，可能是因为您使用的是 1.X API，它使用不同的方法来包含框架。我建议您查看[开发人员指南](http://developer.spotify.com/technologies/apps/guidelines/developer/)，其中解释了如何入门的基础知识。

[GitHub 上](https://github.com/spotify/apps-tutorial/tree/1.0)还有一个示例应用程序，您可以使用它来查看如何使用不同的可用框架。

# sql - 你能用动态管理视图来找出一个查询在一个时间段内被调用了多少次吗

> ID：15960634
> 
> 赞同：1
> 
> 时间：2013-04-11T23:28:28.967
> 
> 标签：sql, sql-server, dynamic-management-views

我一直在学习有关 sql server 中动态管理视图的更多信息，因为我们在工作中遇到了一些性能问题。也许这是看待事物的错误方式，但可用的工具似乎......它们似乎不像我想要的那样灵活。

我希望能够找出以下我有示例的内容。

哪些查询的运行速度比正常情况慢 20% 以上？以下 ...

```
--displays regarding about procedures that are currently taking longer to execute by more than 20% over the average. 
;
with data as (
select  s.plan_handle
        , db.name
        , ObjectName = OBJECT_NAME(t.objectid, t.dbid )
        , PlanCompileDate = s.creation_time
        , PlanExecutionCount = execution_count

        , AvgElapsedSeconds = ( total_elapsed_time/ CAST( 1000000 as float(15) ) ) / CAST( s.execution_count as float(15) )
        , LastElapsedSeconds = last_elapsed_time / CAST( 1000000 as float(38) )
        , LeastElapsedSeconds = min_elapsed_time / CAST( 1000000 as float(15) )
        , MostElapsedSeconds = max_elapsed_time / CAST( 1000000 as float(15) )
        , LastExecPercentageDevTime = (( ( s.total_elapsed_time /  cast(s.execution_count as float(15) ) ) - s.last_elapsed_time ) / ( case s.last_elapsed_time when 0 then -1.00 else ( s.total_elapsed_time /  cast( s.execution_count as float(15) ) ) end ) )  * -100
                                                    -- 0.00532225 
        , AvgRowsReturned = total_rows / CAST( s.execution_count as float )
        , LastRowsReturned = last_rows
        , LeastRowsReturned = min_rows
        , MostRowsReturned = max_rows
        , LastExecPercentageDevRows =  (( ( s.total_rows /  cast(s.execution_count as float ) ) - s.last_rows) / ( case s.last_rows when 0 then -1.00 else ( s.total_rows /  cast( s.execution_count as float ) ) end ) )  * -100 

        , AvgCPUTime = s.total_worker_time / CAST( s.execution_count as float )
        , LastCPUTime = s.last_worker_time
        , LeastCPUTime = min_worker_time
        , MostCPUTime = max_worker_time
        , LastExecPercentageDevCPUTime =  (( ( s.total_worker_time /  cast(s.execution_count as float ) ) - s.last_worker_time ) / ( case s.last_worker_time when 0 then -1.00 else ( s.total_worker_time /  cast( s.execution_count as float ) ) end ) )  * -100 

        , AvgPhysicalReads = s.total_physical_reads / CAST( s.execution_count as float )
        , LastPhysicalReads = s.last_physical_reads
        , LeastPhysicalReads = s.min_physical_reads
        , MostPhysicalReads = s.max_physical_reads
        , LastExecPercentageDevPhysicalReads = (( ( s.total_physical_reads /  cast(s.execution_count as float ) ) - s.last_physical_reads ) / ( case s.last_physical_reads when 0 then -1.00 else ( s.total_physical_reads /  cast( s.execution_count as float ) ) end ) )  * -100 

        , AvgLogicalReads = s.total_logical_reads / CAST( s.execution_count as float )
        , LastLogicalReads = s.last_logical_reads
        , LeastLogicalReads = s.min_logical_reads
        , MostLogicalReads = s.max_logical_reads
        , LastExecPercentageDevLogicalReads = (( ( s.total_logical_reads /  cast(s.execution_count as float ) ) - s.last_logical_reads ) / ( case s.last_logical_reads when 0 then -1.00 else ( s.total_logical_reads /  cast( s.execution_count as float ) ) end ) )  * -100 

        , AvgLogicalWrites = s.total_logical_Writes / CAST( s.execution_count as float )
        , LastLogicalWrites = s.last_logical_Writes
        , LeastLogicalWrites = s.min_logical_Writes
        , MostLogicalWrites = s.max_logical_Writes
        , LastExecPercentageDevLogicalWrites = (( ( s.total_logical_writes /  cast(s.execution_count as float ) ) - s.last_logical_writes ) / ( case s.last_logical_writes when 0 then -1.00 else ( s.total_logical_writes /  cast( s.execution_count as float ) ) end ) )  * -100 

        , t.text
        , t.number
        , t.objectid
        , s.query_hash
        --, s.* 
FROM sys.dm_exec_query_stats AS s 
     CROSS APPLY sys.dm_exec_sql_text(s.sql_handle) AS t 
     LEFT JOIN sys.databases AS DB 
        ON t.dbid = DB.database_id
)
select  *
from    data 
where   LastExecPercentageDevTime > 20 and -- changed by at least 20%
        PlanExecutionCount > 10 and -- executed more than 10 times 
        LastElapsedSeconds != 0 -- we don't care about queries that executed quickly
order by LastExecPercentageDevTime desc 
```

当有阻塞时，我希望能够确定正在执行阻塞的查询，也许它的依赖对象是什么。

我相信以下内容可以找到执行阻塞的查询

```
-- What queries are the source of all the blocking.
with blockingSessions as(
    select session_id,blocking_session_id
    from sys.dm_exec_requests
    where blocking_session_id > 0
), causal as(
    select  blocking_session_id
    from    blockingSessions
    where   blocking_session_id not in(select session_id from blockingSessions)
)--select * from causal 
select   t.text
        ,SPID               = con.most_recent_session_id
        ,STATUS             = s.STATUS
        ,[Login]            = s.login_name
        ,Host               = s.host_name
        --,BlkBy              = r.blocking_session_id
        ,DBName             = d.name
        ,CommandType        = r.command
        ,SQLStatement       = t.text
        ,ObjectName         = OBJECT_NAME(t.objectid)
        ,ElapsedMS          = r.total_elapsed_time
        ,CPUTime            = r.cpu_time
        ,IOReads            = r.logical_reads + r.reads
        ,IOWrites           = r.writes
        ,LastWaitType       = r.last_wait_type
        ,StartTime          = r.start_time
        ,Protocol           = con.net_transport
        ,ConnectionWrites   = con.num_writes
        ,ConnectionReads    = con.num_reads
        ,ClientAddress      = con.client_net_address
        ,Authentication     = con.auth_scheme 
        --,t.*
from    causal c
        join sys.dm_exec_connections con
            on c.blocking_session_id = con.session_id
        join sys.dm_exec_sessions s
            on con.most_recent_session_id = s.session_id
        left join sys.dm_exec_requests r
            on s.session_id = r.session_id
        outer APPLY sys.dm_exec_sql_text(con.most_recent_sql_handle) AS t
        left join sys.databases d   
            on t.dbid = d.database_id 
```

但我一直无法弄清楚如何实现以下...

今天特定查询运行了多少次（不是自上次计划编译时间以来）？今天一个特定的存储过程今天运行了多少次？使用某些参数调用了多少次？

也许还有其他一些你们可以想到的有用的，也许你们可以为我上面给出的提供一些建议。我无法弄清楚的另一件事是动态管理视图中的连接、请求和会话之间的关系到底是什么？

# 编辑

我想我是专门尝试在特定时间段内使用视图，例如在 x 时间和 y 时间之间发生的情况。但它们似乎不是为此而设计的。这个对吗？是否有另一种方法可以从 sql server 按时间段获取类似信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T02:05:16.557

如果您正在考虑使用 DMV 来了解有关 SQL Server 数据库/服务器的更多信息，请前往[Glenn Berry 的 SQL Server 诊断信息查询](http://sqlserverperformance.wordpress.com/tag/dmv-queries/)

以下是他的 SQL Server 2008 R2 中的一些查询：按执行次数排列的热门查询：

```
 SELECT TOP (250) qs.execution_count, qs.total_rows, qs.last_rows, qs.min_rows, qs.max_rows, qs.last_elapsed_time, qs.min_elapsed_time, qs.max_elapsed_time,
total_worker_time, total_logical_reads, 
SUBSTRING(qt.TEXT,qs.statement_start_offset/2 +1,
(CASE WHEN qs.statement_end_offset = -1
            THEN LEN(CONVERT(NVARCHAR(MAX), qt.TEXT)) * 2
      ELSE qs.statement_end_offset END - qs.statement_start_offset)/2) AS query_text 
FROM sys.dm_exec_query_stats AS qs WITH (NOLOCK)
CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) AS qt
ORDER BY qs.execution_count DESC OPTION (RECOMPILE); 
```

按执行次数排名最高的 SP：

```
SELECT TOP(250) p.name AS [SP Name], qs.execution_count,
ISNULL(qs.execution_count/DATEDIFF(Second, qs.cached_time, GETDATE()), 0) AS [Calls/Second],
qs.total_worker_time/qs.execution_count AS [AvgWorkerTime], qs.total_worker_time AS [TotalWorkerTime],  
qs.total_elapsed_time, qs.total_elapsed_time/qs.execution_count AS [avg_elapsed_time],
qs.cached_time
FROM sys.procedures AS p WITH (NOLOCK)
INNER JOIN sys.dm_exec_procedure_stats AS qs WITH (NOLOCK)
ON p.[object_id] = qs.[object_id]
WHERE qs.database_id = DB_ID()
ORDER BY qs.execution_count DESC OPTION (RECOMPILE); 
```

您可以轻松地修改这些以获取执行查询/SP 的次数。

# ruby-on-rails-3 - rails 一个基类，两个模型和两个数据库表

> ID：15960635
> 
> 赞同：0
> 
> 时间：2013-04-11T23:28:34.017
> 
> 标签：ruby-on-rails-3, activerecord, metaprogramming

我想创建两个结构几乎相同的模型。但我想将数据集保存在两个不同的表中。这可能在活动记录中吗？

不同表的原因是因为我想要一个不返回结果的查询有意义，例如“不存在具有这些属性的活动模型......”，或“不存在具有这些属性的非活动模型......”

此外，这些类的行为几乎相同，因此抽象或基础模型对于保持干燥很重要。但我想使用明确命名的模型，以便我知道我正在使用“活动”或“非活动”数据。

我想模型类看起来像这样，但我不太确定如何让模型引用不同的表。这可能吗？

```
class BaseModel < ActiveRecord::Base
  attr_accessible :foo, :bar,

end

class ActiveModel < BaseModel
  # This class gets its data from table :active_models

end

class InactiveModel < BaseModel
  # This class gets its data from table :inactive_models

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T02:31:45.920

您可以为此使用[ActiveRecord::Base.table_name=](http://api.rubyonrails.org/classes/ActiveRecord/ModelSchema/ClassMethods.html#method-i-table_name-3D "ActiveRecord::Base.table_name=")。

或者，如果您的模型被适当命名，您可以使用`ActiveRecord::Base.table_name_prefix=`or `ActiveRecord::Base.table_name_suffix=`。

```
class BaseModel < ActiveRecord::Base
end

class ActiveModel < BaseModel
  # This class gets its data from table :active_models
  self.table_name = 'active_models'
end

class InactiveModel < BaseModel
  # This class gets its data from table :inactive_models
  self.table_name = 'inactive_models'
end 
```

# vb.net - 显示所选项目以使其出现在列表框中？(vb.net)

> ID：15960636
> 
> 赞同：-2
> 
> 时间：2013-04-11T23:28:48.363
> 
> 标签：vb.net, visual-studio

VB.net

你好，我想知道我是否可以这样做：

我有一个列表框“Listbox2”，我希望它显示在“listbox1”的第 1 行中选择的内容。我尝试了一些方法，但似乎没有奏效。有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T12:51:58.307

我认为您想要实现的是将 Listbox1 中的选定项目显示为 listbox2 中的项目。

由于您的“问题”留给我很多想象，我冒昧地提供了几个不同的片段。

# 提供所选项目的文本：

第一：当在Listbox1中选择一个项目时，在Listbox2的顶部添加一个项目。

```
 Private Sub ListBox2_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles ListBox2.SelectedIndexChanged
        ListBox2.Items.Insert(0, ListBox1.SelectedItem)
    End Sub 
```

第二种：在Listbox1中选中一个item时，在Listbox2顶部增加一个item（只会显示一个item）

```
 Private Sub ListBox2_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles ListBox2.SelectedIndexChanged
        Listbox2.Items.Clear()
        ListBox2.Items.Insert(0, ListBox1.SelectedItem)
    End Sub 
```

# 提供第一项的文本：

（不一定必须在 SelectedIndexChanged 事件上） 首先：当在 Listbox1 中选择一个项目时，顶部项目将添加到 Listbox2。

```
 Private Sub ListBox2_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles ListBox2.SelectedIndexChanged
        ListBox2.Items.Insert(0, ListBox1.Items.Item(0))
    End Sub 
```

第二种：在Listbox1中选中一个item时，在Listbox2顶部增加一个item（只会显示一个item）

```
 Private Sub ListBox2_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles ListBox2.SelectedIndexChanged
        Listbox2.Items.Clear()
        ListBox2.Items.Insert(0, ListBox1.Items.Item(0))
    End Sub 
```

# c# - 更新语句中的“字符串或二进制数据将被截断”

> ID：15960640
> 
> 赞同：1
> 
> 时间：2013-04-11T23:29:02.143
> 
> 标签：c#, asp.net, sql

我有以下代码：

```
glat += result.geometry.location.lat;
glong += result.geometry.location.lng;
gPostal += postalCode;    

sqlUpdateQuery = "update testlatlong set Lat =@lat,Long =@long where postalcode =@postal";
SqlCommand updateCommand = new SqlCommand(sqlUpdateQuery, sqlConn);
updateCommand.Parameters.Add("@lat", SqlDbType.NVarChar).Value = glat;
updateCommand.Parameters.Add("@long", SqlDbType.NVarChar).Value = glong;
updateCommand.Parameters.Add("@postal", SqlDbType.NVarChar).Value = gPostal;
updateCommand.ExecuteNonQuery(); 
```

我一直遇到这个问题：“字符串或二进制数据将被截断。语句已终止”。我的 lat 和 long 的列类型`nvarchar(max)`在我的 sql 表中。在我的情况下可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:56:43.060

它将是这些行：

```
glat += result.geometry.location.lat;
glong += result.geometry.location.lng;
gPostal += postalCode; 
```

他们只是看起来不对。您发布的所有代码看起来都在一个循环中，由于 +=，邮政编码将继续增长，最终比列的大小长。

即使 lat 和 lng 是 varchar(max)，它在做什么增量添加到列值？

# c++ - 为什么 OpenCL cl.hpp (header-only) wrapper 不违反单一定义规则？

> ID：15960641
> 
> 赞同：1
> 
> 时间：2013-04-11T23:29:08.490
> 
> 标签：c++, opencl, gpgpu

OpenCL 为 cl.h 提供了一个只有头文件的 C++ 包装器，称为 cl.hpp。它附带了一些实现，但也可以从 khronos.org 获得，因为它只使用 OpenCL 库。

它包含很多模板和内联的东西，但也有这样的东西：

```
namespace cl
{
 class Buffer : public Memory
 {
  Buffer (...stuff...)
  {
   // Constructor implementation
  }

  // ...
  // Other Constructors and such
  // ...

  Buffer& operator= (const Buffer& rhs)
  {
   // implementation
  }

  // ...

  Buffer createSubBuffer (...)
  {
   // implementation
  }
 }
} 
```

现在这是我的问题：那些在类定义中但既不是内联也不是模板化的实现不应该违反单一定义规则吗？我在这里错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T23:41:49.317

# C++ ISO

7.1.2/3：

> **在类定义中定义的函数是内联函数**。内联说明符不应出现在块作用域函数声明中。如果在友元声明中使用了 inline 说明符，则该声明应为定义，或者该函数应先前已被声明为内联。

3.2/4：

> **每个程序都应包含该程序中 odr 使用的每个非内联函数**或变量的准确定义；无需诊断。定义可以显式出现在程序中，可以在标准或用户定义库中找到，或者（在适当时）隐式定义（参见 12.1、12.4 和 12.8）。**内联函数应在使用它的每个翻译单元中定义**。

3.2/6：

> **类类型、枚举类型、**带有外部链接的内联函数 (7.1.2)**、类模板、非静态函数模板、类模板的静态数据成员、类模板的成员函数、类模板的成员函数可以有多个**定义**，如果每个定义出现在不同的翻译单元中，并且定义满足以下要求 [...]**

# jquery - 如何使用 jquery 在基于表格行中其他位置的其他字符串的单元格中选择 dom 元素？

> ID：15960644
> 
> 赞同：0
> 
> 时间：2013-04-11T23:29:37.910
> 
> 标签：jquery, select, filter, compare, cell

我有一个表格，其中包含状态、产品类型和单选选项，以查看用户是否希望选择它。如果用户为任何项目选择“否”，我将尝试禁用具有相同状态和类别的所有其他单选按钮。

挑战是我无法找到并选择符合条件的单选按钮。这是jsfiddle。 [http://jsfiddle.net/Ender/LwPCv/](http://jsfiddle.net/Ender/LwPCv/)

这显然是对我真正想做的事情的过度简化，但这涵盖了基本概念。非常感谢！哦，我也在使用jquery。

在我的 jsfiddle 中，测试将是如果用户在第 1 行选择“否”，那么最后一行单选按钮将被禁用。

```
$(".runTest").click(function () {

    $("tr").each(function () {
        var curRow = $(this);
        var curStatus = curRow.find('td:first').text();
        var curRowAccepted = curRow.find('input:radio:checked').val();
        //if the current row is not selected find any other matching rows and deselect them;
        if (!curRowAccepted) {
            //trim the string and extract just the category from a full string;
            var curRowCategory = findCategory(curRow.find('td:nth-child(2)').text());
            var charAtSplit = curRowCategory.indexOf("-");
            curRowCategory = curRowCategory.substr(0, charAtSplit);
            curRowCategory = $.trim(curRowCategory);

            //I need to disable all other radio buttons that match the Status and Category
            $('input:radio').filter($('tr:contains(curRowCategory))').filter($('tr:contains(curStatus))')).disable();
            }
        });
    }) 
```

# c++ - 读取二维数组并显示它（c++）

> ID：15960649
> 
> 赞同：0
> 
> 时间：2013-04-11T23:30:08.280
> 
> 标签：c++, arrays, file-io, for-loop, multidimensional-array

所以我的代码的前提是从 .txt 中读取二维数组。该数组是一个游戏板，但前两行决定了板的大小。在我读到它之后，我希望它找到字符“U”在哪里，然后显示数组，但只显示 U 和它周围的东西。问题是我无法让数组打印正确的大小，并且显示 U 的代码也不起作用。

```
ifstream inputFile;
int boardSizeRow;
int boardSizeCol;
inputFile.open("C:\\Users\\Michael\\Desktop\\fileboard2.txt");
inputFile >> boardSizeRow;
inputFile >> boardSizeCol;
inputFile.get();

char gameBoard[20][20];
for (int row = 0; row < boardSizeRow; row++)
{
    for (int col = 0; col < boardSizeCol; col++)
    {
        gameBoard[row][col] = inputFile.get();
    }
}

for (int row = 0; row < boardSizeRow; row++) //////////////TO TEST PRINT
{
    for (int col = 0; col < boardSizeCol; col++)
    {
        cout << gameBoard[row][col];
    }
}

cout << endl;
cout << endl;

const int ROWS = 20; 
const int COLS = 20;
bool toPrint[ROWS][COLS] = {false}; 
for (int i = 0; i < ROWS; i++ )
{
    for (int j = 0; j < COLS; j++)
    {
       if (gameBoard[i][j] == 'U')
       {
            //set parameters around:
            toPrint[i][j] = true; 
            toPrint[i][j-1] = true; //West
            toPrint[i][j+1] = true; //East
            toPrint[i-1][j] = true;  //North
            toPrint[i+1][j] = true; //South
       }
   }
}
for (int i = 0; i < ROWS; i++ )
{
    for (int j = 0; j < COLS; j++)
    {
       if (toPrint[i][j])
       {            
           cout << gameBoard[i][j] ;
       }
       else
       {
           cout <<"0";
       }
    }
    cout <<endl;
 }
cout << endl; 

return 0; 
```

. txt文件::

```
20
20
WWWWWWWWWWWWWWWWWWWW
  W GO  W          W
W WW      w    S   W
W H W   GW  w      W
WPW  WW          G W
 WK       W        W
W W W  W    w   w  W
  WK WU            W
    SW      w  w   W
           W       W
    w    W       G W
  G    W       w   W
D   wwwww          W
         K   w  D  W
w w   W w   w      W
    ww  w    WWWWWWW
  G        w       W
    ww  w S    w   W
   WWW      G      W
WWWWWWWWWWWWWWWWWWWW 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:44:59.393

您忘记阅读 txt 中的换行符。如果您查看 gameBoard 数组，您会发现第 2 行的第一项是 10' '。

修改后的代码：

```
for (int row = 0; row < boardSizeRow; row++)
{
    for (int col = 0; col < boardSizeCol; col++)
    {
        gameBoard[row][col] = inputFile.get();
    }
    inputFile.get();//read new line symbol here
}

for (int row = 0; row < boardSizeRow; row++) 
{
    for (int col = 0; col < boardSizeCol; col++)
    {
        cout << gameBoard[row][col];
    }
    cout<<endl;//output new line here
} 
```

# javascript - 获取 HTML 中段落的一行

> ID：15960653
> 
> 赞同：4
> 
> 时间：2013-04-11T23:30:46.273
> 
> 标签：javascript, html

在 JavaScript 中，是否可以从页面上显示的段落中获取特定行？

例如，这里我试图将段落的第 3 行作为字符串获取：

JavaScript：

```
//this function should return the specified line from the specified paragraph.
function getLine(paragraphId, lineNum){
    //for example, getLine("sampleParagraph", 1); should return
    // tore but year. An from mean on with when sing pain. Oh to as principles devonshire
} 
```

HTML：

```
<p id = "sampleParagraph">
Instrument cultivated alteration any favourable expression law far nor. Both new like tore but year. An from mean on with when sing pain. Oh to as principles devonshire companions unsatiable an delightful. The ourselves suffering the sincerity. Inhabit her manners adapted age certain. Debating offended at branched striking be subjects.
</p> 
```

这是在 jsfiddle 上（显示段落的显示方式）：http: [//jsfiddle.net/RrXWW/](http://jsfiddle.net/RrXWW/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T23:49:08.930

**演示 1： http:** [//jsfiddle.net/LeTW6/2/](http://jsfiddle.net/LeTW6/2/)
**演示 2：http:** [//jsfiddle.net/LeTW6/3/](http://jsfiddle.net/LeTW6/3/)

为了简单起见，我在这里使用 jQuery，但这适用于纯 JavaScript。事实上，我在某些部分使用直接 DOM 访问来提高性能。

1.  将所有单词分解为单独的元素。
2.  使用位置来计算行号。
3.  在选定的行处，开始构建所有单词元素的缓冲区。
4.  大于所选行，退出。
5.  在调整大小时，重新计算（这可能不需要，或者可以从不同的事件中调用）。

## 代码

```
(function () {

    // wrap all words
    $(".count").each(function () {
        var obj = $(this);
        var html = obj.html().replace(/(\S+\s*)/g, "<span>$1</span>");
        obj.html(html);
    });

    var offset = 0; // keeps track of distance from top
    var spans = $(".count span"); // collection of elements

    function getLine(index) {
        var top = 0,
            buffer = [];

        for (var i = 0; i < spans.length; i++) {

            if (top > index) {
                break; // quit once the line is done to improve performance
            }

            // position calculation
            var newOffset = spans[i].offsetTop;
            if (newOffset !== offset) {
                offset = newOffset;
                top++;
            }

            // store the elements in the line we want
            if (top === index) {
                buffer.push(spans[i]);
            }
        }

        // buffer now contains all spans in the X line position

        // this block is just for output purposes
        var text = "";
        for (var i = 0; i < buffer.length; i++) {
            text += buffer[i].innerHTML;
        }

        $("#output").html(text);
    }

    var line = 3; // the line to select/highlight
    getLine(line); // initial highlighting

    // other recalculation triggers can be added here, such as a button click

    // throttling to handle recalculation upon resize
    var timeout;
    function throttle() {
        window.clearTimeout(timeout);
        timeout = window.setTimeout(function () {
            getLine(line);
        }, 100);
    }

    $(window).on("resize", throttle);
})(); 
```

另请参阅[我的答案，以突出显示](https://stackoverflow.com/questions/15830449/how-to-target-alternate-odd-even-text-lines/15831491#15831491)可变宽度容器中的交替行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T01:28:29.367

如果您想使用纯 JavaScript 来提高性能并且不必包含 jQuery，则可以使用它。

**演示：http: [//jsfiddle.net/PX7cj/2/](http://jsfiddle.net/PX7cj/2/)**

```
function getLine(paragraphId, lineNum) {
    lineNum--;
    var elem = document.getElementById(paragraphId);
    var spanChildren = elem.getElementsByTagName("span");
    var paragraphText = elem.innerHTML.replace(/(\r\n|\n|\r)/gm, "");
    var newParagraphText = "";
    var words = [];
    if (spanChildren.length === 0) {
        words = paragraphText.split(" ");
        for (var i = 0; max = words.length, i < max; i++)
        newParagraphText += '<span>' + words[i] + "</span> ";
        elem.innerHTML = newParagraphText;
    }else{
        for(var i=0; max = spanChildren.length, i<max; i++){
            words[words.length] = spanChildren[i].innerHTML;
        }
    }
    var lineCounter = 0;
    var previousY = spanChildren[0].offsetTop;
    var returnText = "";
    var startReturning = false;
    for (var i = 0; max = words.length, i < max; i++) {
        if (spanChildren[i].offsetTop != previousY) lineCounter++;
        if (lineCounter === lineNum) startReturning = true;
        if (lineCounter !== lineNum && startReturning) return returnText.substring(0, returnText.length - 1);
        if (startReturning) {
            returnText += words[i] + " ";
            if (i + 1 === words.length) return returnText.substring(0, returnText.length - 1);
        }
        previousY = spanChildren[i].offsetTop;
    }
}

alert(getLine("sampleParagraph", 5));
alert(getLine("sampleParagraph", 4)); 
```

# python - Python：让这段代码更紧凑？

> ID：15960655
> 
> 赞同：3
> 
> 时间：2013-04-11T23:30:50.453
> 
> 标签：python, python-2.7, while-loop, physics, performance

我怎样才能摆脱这段代码中的过度重复？

代码： http: [//pastebin.com/13e2nWM9](http://pastebin.com/13e2nWM9)

该程序根据用户提供的数据计算运动方程（SUVAT 方程）。

我指的部分是：

```
while True:
        a = raw_input("What is the value of a? Make sure it is in standard units, however, do not include the unit.")
        try:
            float(a)
            print "a is " + str(a) + " ms^-2"
            break
        except:
            print"You must enter a number. Don't include units!" 
```

这会重复很多次，除了变量“a”和重复块时改变的单位。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T23:45:10.023

这是一种选择，将以下函数定义放在模块的顶部：

```
def get_float(name, units):
    prompt = "What is the value of {0}? Make sure it is in standard units, however, do not include the unit.".format(name)
    while True:
        val = raw_input(prompt)
        try:
            val = float(val)
            print '{0} is {1} {2}'.format(name, val, units)
            return val
        except Exception:
            print "You must enter a number. Don't include units!" 
```

这是一个如何使用它的示例，以下代码可以替换从第 72 行到第 100 行的所有内容：

```
name_units_pairs = [('v', 'ms^-1'), ('a', 'ms^-2'), ('t', 's'),]
vals = {}
for name, units in name_units_pairs:
    vals[name] = get_float(name, units)
u = vals['v'] - vals['a'] * vals['t'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:43:37.060

不要使用原始异常，并封装测试，仅此而已。所以而不是

```
while True:
        a = raw_input("What is the value of a? Make sure it is in standard units, however, do not include the unit.")
        try:
            float(a)
            print "a is " + str(a) + " ms^-2"
            break
        except:
            print"You must enter a number. Don't include units!" 
```

做

```
a = my_input(valuename='a', unit='m^-2', unitformat=float) 
```

并在 my_input 中进行测试（和提示）。

my_input 可能类似于：

```
def my_input(valuename, unit, unitformat=float):
  while True:
    val = raw_input("What is the value of %s? Make sure it is in standard units"+
                    "(%s), however, do not include the unit." % (valuename, unit))
    try:
        unitformat(val)
    except ValueError:
        print"You must enter a number. Don't include units!"
    else:
        print "%s is %s %s" % (valuename, val, unit)
        return val 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:41:54.060

我看不出这段代码有任何需要，或者事实上根本没有任何用途，以提高效率。这里的限制因素是控制台输出的速度。

但...

如果它为您节省的额外几纳秒真的非常重要，那么您可以加快速度的最大方法（我认为，尽管它实际上可能会因为解释而减慢速度）是以不同的方式单独输出打印的内容print 语句，因此它不必在内存中构造 2 个额外的字符串来表示`"a is " + str(a)`and的值`"a is " + str(a) + " ms^-2"`。为了再节省几纳秒，请用一种可以编译为机器代码的语言编写程序。

或者，如果您的意思是使用更少的代码来做同样的事情，请封装输入，就像其他人所说的那样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T01:54:14.583

您可以使用循环来自动化输入，将值存储在字典中，然后在最后进行所有数学运算。

```
import math

units = {'s': 'm', 'u': 'ms^-1', 'v': 'ms^-1', 'a': 'ms^-2', 't': 's'}
variables = ['s', 'u', 'v', 'a', 't']
suvat = dict((k, None) for k in variables)
input_variables = []

def pick_from_list(prompt, L):
    while True:
        pick = raw_input(prompt % str(L))
        if pick in L:
            print "You have chosen", pick
            return pick
        print """Sorry, I didn't understand that, try again. Make sure your spelling is
            correct (Case Sensitive), and that you did not inlcude the quotation marks."""

aim = pick_from_list("""Welcome to Mattin's SUVAT Simulator! Choose the value you are
                    trying to find. You can pick from variables %s""",
                     variables)

for order in 'first', 'second', 'third':
    prompt = 'Please choose which variable to input %s. You can pick from %%s' % order
    choices = [k for k in variables if not (k is aim or k in input_variables)]
    input_variables.append(pick_from_list(prompt, choices))

for v in input_variables:
    while True:
        raw_input("""What is the value of %s? Make sure it is in standard
units, however, do not include the unit.""" % v)
        try:
            suvat[v] = float(val)
            print "%s is %s%s" % (v, val, units[v])
            break
        except:
            print "You must enter a number. Don't include units!"

# for readability of the maths, turn dictionary into variables
s, u, v, a, t = [suvat[k] for k in variables]

# (not tested)
if s is None:
    if t is None:
        t = (v - u) / a
    if v is None:
        s = u * t + .5 * a * t * t
    elif a is None:
        s = .5 * (u + v) * t
    else:
        s = v * t - .5 * a * t * t
if v is None:
    if u is None:
        u = s / t - .5 * a * t * t
    if t is None:
        v = math.sqrt(u * u + 2 * a * s)
    else:
        v = 2 * s / t - u
if u is None:
    if a is None:
        a = 2 * v / t - s / (t * t)
    u = math.sqrt(v * v - 2 * a * s)
if a is None:
    a = (v * v - u * u) / (2 * s)
if t is None:
    t = (v - u) / a

# turn the set of variables back into a dictionary
solutions = dict(zip(variables, [s, u, v, a, t]))
print 'Solution: %s=%s%s' % (aim, solutions[aim], units[aim]) 
```

# php - jQuery, AJAX PHP 联系表格

> ID：15960659
> 
> 赞同：0
> 
> 时间：2013-04-11T23:31:04.573
> 
> 标签：php, jquery, ajax, forms

我一直在寻找一个又一个线程，希望能解决这个问题，但没有运气，基本上我有一个非常简单的联系表格，它工作正常，但是当我尝试通过 jQuery AJAX 处理它时，没有发送电子邮件但成功回调触发器。

阻止它工作的是所有代码都在同一个页面上（index.php），表单处理 PHP 没有单独的页面，所以现在所有代码都在同一个页面上我不得不添加一个 if 语句如果PHP`if (!empty($_POST['contact-submit'])) {}`是从自己的文件中调用的，我就不必这样做了。我不希望 PHP 在一个单独的文件中，所有内容都需要在一个页面上，如果有人知道如何克服这个问题，我将不胜感激，因为这让我发疯了！

HTML：

```
<form class="contact-form island" method="post" action="">
  <ul class="form-fields">
    <li>
      <label>Your Name</label>
      <input class="text-input" type="text" name="name" required value="TEST NAME">
    </li>
    <li>
      <label>Your Email</label>
      <input class="text-input" type="email" name="email" required value="email@gmail.com">
    </li>
    <li>
      <label>Subject</label>
      <input class="text-input" type="text" name="subject" required value="TEST SUBJECT">
    </li>
    <li>
      <label>Message</label>
      <textarea rows="7" name="message" required>MESSAGE</textarea>
    </li>
    <li>
      <input class="submit-input" type="submit" value="Send" name="contact-submit">
    </li>
  </ul>
</form> 
```

PHP：

```
<?php
  if (!empty($_POST['contact-submit'])) {
    $name = trim(stripslashes($_POST['name'])); 
    $email = trim(stripslashes($_POST['email'])); 
    $subject = trim(stripslashes($_POST['subject'])); 
    $message = trim(stripslashes($_POST['message'])); 

    $email_from = $email;
    $email_to = 'email@gmail.com';

    $body = 'Name: ' . $name . "\n\n" . 'Email: ' . $email . "\n\n" . 'Subject: ' . $subject . "\n\n" . 'Message: ' . $message;

    $success = mail($email_to, $subject, $body, 'From: <'.$email_from.'>');

    echo '<p>Email Sent!</p>';
  }
?> 
```

jQuery：

```
$(function() {

  var form = $('.contact-form');
  form.submit(function () {
    $.ajax({
      type: form.attr('method'),
      url: form.attr('action'),
      data: form.serialize(),
      success: function() {
        $.fancybox({'content': 'Email Sent!'});
      }
    });
    return false;
  });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T00:18:38.507

我很无聊，我根据你的一些代码和我的一些代码让你成为了一个工作的人：http: [//pastie.org/private/zsh9jqej1zkdpeouditww](http://pastie.org/private/zsh9jqej1zkdpeouditww)

几个快速说明：它确实会根据用户提交的内容向用户提供反馈，因此如果某些内容是空白的，它会将其踢回并让他们重试。我在那里放了一个“加载图像”，以防你想使用它......本质上是为了防止人们向按钮发送垃圾邮件。在我的服务器上，click => 几乎立即返回，并不意味着总是如此。

注意：使用您的 PHP 文件名编辑第 48 行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:36:59.027

在 jQuery-ajax 部分： `url: form.attr('action')`指向表单中的动作属性，但在 html 表单中为空。

```
<form class="contact-form island" method="post" action=""> 
```

# css - 设计流体截面布局？

> ID：15960663
> 
> 赞同：-3
> 
> 时间：2013-04-11T23:31:20.980
> 
> 标签：css, layout, fluid

有谁知道我应该使用什么代码/方法来实现这种布局？

1.  如何将正文布局为不同的部分
2.  如何包裹每个身体部分并使其流动

有点像身体的每个部分都是流体？这些例子甚至被认为是流体部分吗？

当我在我的 22 英寸显示器上查看时，图像和站点宽度一直延伸到我的屏幕边缘，在 ipad 和 iphone 上它也是一样的，但由于屏幕较小，边缘的空白空间较少。

例子：

[http://www.linkedinfluence.com/](http://www.linkedinfluence.com/)

[https://getmyo.com/](https://getmyo.com/)

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T15:21:18.743

Twitter Bootstrap 具有坚实的流体布局潜力，也很容易上手。它还利用媒体查询进行响应式设计。

在此处查看流体网格系统文档：http: [//twitter.github.io/bootstrap/scaffolding.html#fluidGridSystem](http://twitter.github.io/bootstrap/scaffolding.html#fluidGridSystem)

# windows - 防止 Vim 双重映射

> ID：15960678
> 
> 赞同：0
> 
> 时间：2013-04-11T23:32:36.397
> 
> 标签：windows, vim, mapping

我想`['']`在插入模式下附加到行尾，所以我有这个映射：

```
inoremap <C-[> <Esc>A['']<Esc>hi 
```

问题是 Vim 也映射`A['']<Esc>hi`到`<Esc>`插入模式。要退出插入模式，我必须按`<Ctrl-C>`。

如何停止双重映射？

我在 Windows 上使用 gVim。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T23:48:00.613

映射不像您所说的那样映射`A['']<Esc>hi`到`<esc>`。

的键码`<esc>`相同，`ctrl-[`都是 27。

您可以选择其他组合键，例如`<F2> -<F12>, or <c-l> ...`您的映射将起作用。

详细，请检查：

```
:h keycode 
```

然后`/esc`

# c - 跨编译器的循环问题

> ID：15960682
> 
> 赞同：0
> 
> 时间：2013-04-11T23:06:17.220
> 
> 标签：c, xcode

我遇到了麻烦。我的程序似乎在 DEV C++ 上运行良好，但在 Xcode 上，最后一个 For 循环不知道何时停止。有什么帮助吗？

```
#include <stdlib.h>
#include <stdio.h>           
#include <time.h>
#include <string.h>          

void strip_newline(char *str,int size)
{
    int i;
    for(i=0;i<size;++i)
    {
        if(str[i]=='\n')
        {
            str[i]='\0';
            return;
        }
    }
}

int main()    
{
    int randomnumber; 
    int max;           
    int tall;        
    char name[40][tall]; 
    char seat[40][tall]; 
    int count;           
    int currentcount;
    int flag;

    srand( time(NULL) ); 
    printf("Enter total number of students: "); 
    scanf("%d",&max); 
    getchar();        
    tall=max+1;       
    randomnumber=rand()% max +1; 
    printf("This is your random number\n %d \n",randomnumber); 
    printf("Enter your students names and press enter after each name:\n "); 

    fgets(name[0],40,stdin); 
    strip_newline(name[0],40); 

    for(count=1; count < max; count++ )
    {    
        printf("Please enter next name\n ");
        fgets(name[count],40,stdin);  
        strip_newline(name[count],40);
    }

    count=-1;

    do {
        randomnumber=rand()% max;
        flag=0;
        for(currentcount=0; currentcount<max; currentcount++)
        {
            if(strcmp(name[randomnumber],seat[currentcount])==0)
            {
               flag=1;
            }
            else
            {
            }
        }
        if(flag==0)
        {
            strcpy(seat[count],name[randomnumber]);
            count++;
        }
        else
        {
        }
    }
    while (count != max);

    for(count=0; count < max; count++)
    {
        printf("%s sits in seat %d\n",seat[count],count+1);
    }

    getchar();
    return 0; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T06:20:29.097

您的问题出在以下几行：

```
int tall;        
char name[40][tall]; 
char seat[40][tall]; 
```

由于`tall`未初始化（未给定值），因此不知道您的 40 个数组将变得多大。它可以是介于 0 和一个非常大的数字之间的任何值，或者甚至是“在你的脸上炸毁”，因为这种行为在形式上是未定义的。后面的分配`tall`不会为您神奇地调整数组的大小。

解决方案是重新排列您的代码，以便在您获得有关其大小的足够信息之前不声明数组。此外，考虑到您如何使用它们，您似乎需要`tall`40 个字符的数组，而不是 40 个字符的数组`tall`，因此您需要交换维度：

```
//...
printf("Enter total number of students: "); 
scanf("%d",&max); 
getchar();        
tall=max+1;       
char name[tall][40]; 
char seat[tall][40]; 
//... 
```

# jquery - 一个 div 上的多个动画

> ID：15960686
> 
> 赞同：0
> 
> 时间：2013-04-11T23:33:57.057
> 
> 标签：jquery, image

所以我有一个背景图像和一个蒙版图像。我有一组四个按钮，我想在单击它们时将顶部图像移动到不同的位置。我一直在测试 jquery animate 函数，但之后我无法将图像恢复到其原始状态，我知道这可能是错误的方式，但这是我迄今为止对 jquery 所做的：

```
<script>

$("#right").click(function() {
$("#content").animate(
        {"left": "+=200px"},
        "slow");
});
$("#left").click(function() {
$("#content").animate(
        {"left": "-=200px"},
        "slow");
});

$("#farRight").click(function() {
$("#content").animate(
        {"left": "+=400px"},
        "slow");
});

</script> 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:53:24.680

您需要存储原始位置，以便返回到该位置。我会使用jQuery的`data`方法来做到这一点：

```
$("#content").data("originalPosition", $("#content").position());

$("#return").click(function() {
    $("#content").animate({
        "left": $("#content").data("originalPosition").left
    }, "slow");
}); 
```

[http://jsfiddle.net/ryanbrill/KPLTy/](http://jsfiddle.net/ryanbrill/KPLTy/)

# sharepoint-2010 - SharePoint 2010 自定义用户配置文件属性 - 更新属性时出错

> ID：15960690
> 
> 赞同：1
> 
> 时间：2013-04-11T23:34:39.927
> 
> 标签：sharepoint-2010

我有一个自定义用户配置文件属性“EmployeeId”类型的整数，它映射到 AD 属性。我删除了这个并重新创建了具有相同名称和整数类型的属性，但这次我映射到了 BDC 属性。当我单击确定时，我收到错误“更新属性时发生错误”。我可以成功添加映射到 BDC 属性的新属性。

我重新启动了以下但仍然收到此错误：

用户配置文件服务用户配置文件同步服务

有什么想法可能导致这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:37:28.897

实际上自定义用户配置文件属性最初是字符串多值类型。当我删除它并重新创建时，我选择整数作为类型。由于某种原因，这引起了冲突。将类型更改回字符串多值后，问题就消失了。

# java - Selenium webdriver 可以附加到已经打开的浏览器窗口吗？

> ID：15960692
> 
> 赞同：6
> 
> 时间：2013-04-11T23:34:56.063
> 
> 标签：java, selenium, webdriver, selenium-webdriver

经过大量搜索后，我相信这个功能还没有实现——但是有人知道我可以尝试使用 selenium1/2 为 Java 实现的任何解决方法吗？如果另一个进程启动了浏览器的实例，webdriver 可以连接到那个窗口吗？任何可以尝试的解决方法。任何指针都非常感谢。

谢谢你！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T23:53:31.820

Nope, it can't be done. It's one of the [oldest feature requests](http://code.google.com/p/selenium/issues/detail?id=18) for WebDriver, and it isn't going to happen any time soon. Sorry!

# php - 为什么我不能在课堂上声明“日期”？

> ID：15960699
> 
> 赞同：1
> 
> 时间：2013-04-11T23:35:41.743
> 
> 标签：php, oop

我真的不知道要谷歌什么，因为我在不知道行话的情况下学习了 PHP 和 OOP。

为什么这在 PHP 中不起作用？

```
class Calendar{
    public $derp="lala";
    public $todaysDate=date('Y-m-d',strtotime('2013-04-11'));
} 
```

但这有吗？

```
class Calendar{
    public $derp="lala";
    public function __construct() 
    {
        $this->todaysDate=date('Y-m-d',strtotime('2013-04-11'));
    }
} 
```

您不能在课程开始时声明日期吗？为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T23:45:31.367

来自[PHP.net](http://php.net/manual/en/language.oop5.properties.php)

TL;DR 您不能用非常数值初始化属性。函数不是常数值。

> 特性
> 
> 类成员变量称为“属性”。您可能还会看到使用“属性”或“字段”等其他术语来提及它们，但出于本参考的目的，我们将使用“属性”。它们是通过使用关键字 public、protected 或 private 之一定义的，后跟一个普通的变量
> 声明。这个声明可能包括一个初始化，但是这个初始化必须是一个常量值——也就是说，它必须能够在编译时被评估，并且不能依赖于运行时信息才能被评估。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:37:41.687

`date`是一个函数。函数是从方法中调用的。再加上给你的`$todaysDate`变量一个值在构造函数中更合适。

# jsf-2 - 警告：不支持的组件系列/渲染器类型：org.omnifaces.component.script/javax.faces.Button

> ID：15960700
> 
> 赞同：2
> 
> 时间：2013-04-11T23:35:59.227
> 
> 标签：jsf-2, myfaces, renderer, omnifaces

我定义了以下表格：

```
<ui:define name="body">
    <h:form
        id="posForm"
        styleClass="well span12">
....
        <o:commandScript
            id="createTransactionCommandScript"
            rendered="#{multiTenantBean.currentAccount.stripePublishableKey != null}"
            name="createTransaction"
            actionListener="#{posMB.createTransaction}"
            execute="@form"
            render="@form" />
    </h:form>
</ui:define> 
```

当我加载我的页面时，我会反复向 Stdout 吐出这个错误：

```
Apr 11, 2013 6:31:53 PM org.apache.myfaces.renderkit.html.HtmlRenderKitImpl getRenderer
WARNING: Unsupported component-family/renderer-type: org.omnifaces.component.script/javax.faces.Button
Apr 11, 2013 6:31:53 PM javax.faces.component.UIComponentBase getRenderer
WARNING: No Renderer found for component {Component-Path : [Class: javax.faces.component.UIViewRoot,ViewId: /pos.xhtml][Class: javax.faces.component.html.HtmlBody,Id: j_id_m][Class: javax.faces.component.html.HtmlForm,Id: posForm][Class: org.omnifaces.component.script.CommandScript,Id: createTransactionCommandScript]} (component-family=org.omnifaces.component.script, renderer-type=javax.faces.Button)
Apr 11, 2013 6:31:53 PM org.apache.myfaces.renderkit.html.HtmlRenderKitImpl getRenderer
WARNING: Unsupported component-family/renderer-type: org.omnifaces.component.script/javax.faces.Button
Apr 11, 2013 6:31:53 PM javax.faces.component.UIComponentBase getRenderer
WARNING: No Renderer found for component {Component-Path : [Class: javax.faces.component.UIViewRoot,ViewId: /pos.xhtml][Class: javax.faces.component.html.HtmlBody,Id: j_id_m][Class: javax.faces.component.html.HtmlForm,Id: posForm][Class: org.omnifaces.component.script.CommandScript,Id: createTransactionCommandScript]} (component-family=org.omnifaces.component.script, renderer-type=javax.faces.Button)
Apr 11, 2013 6:31:53 PM org.apache.myfaces.renderkit.html.HtmlRenderKitImpl getRenderer
WARNING: Unsupported component-family/renderer-type: org.omnifaces.component.script/javax.faces.Button
Apr 11, 2013 6:31:53 PM javax.faces.component.UIComponentBase getRenderer
WARNING: No Renderer found for component {Component-Path : [Class: javax.faces.component.UIViewRoot,ViewId: /pos.xhtml][Class: javax.faces.component.html.HtmlBody,Id: j_id_m][Class: javax.faces.component.html.HtmlForm,Id: posForm][Class: org.omnifaces.component.script.CommandScript,Id: createTransactionCommandScript]} (component-family=org.omnifaces.component.script, renderer-type=javax.faces.Button)
Apr 11, 2013 6:31:53 PM org.apache.myfaces.renderkit.html.HtmlRenderKitImpl getRenderer
WARNING: Unsupported component-family/renderer-type: org.omnifaces.component.script/javax.faces.Button
Apr 11, 2013 6:31:53 PM javax.faces.component.UIComponentBase getRenderer
WARNING: No Renderer found for component {Component-Path : [Class: javax.faces.component.UIViewRoot,ViewId: /pos.xhtml][Class: javax.faces.component.html.HtmlBody,Id: j_id_m][Class: javax.faces.component.html.HtmlForm,Id: posForm][Class: org.omnifaces.component.script.CommandScript,Id: createTransactionCommandScript]} (component-family=org.omnifaces.component.script, renderer-type=javax.faces.Button) 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T00:01:32.230

你没有做错什么。已经从它扩展的类继承了渲染器类型，而它实际上[`CommandScript`](http://omnifaces.org/docs/javadoc/current/org/omnifaces/component/script/CommandScript.html)应该[被](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIComponentBase.html#setRendererType%28java.lang.String%29)自己设置为渲染器。MyFaces 只是警告无法解析相关的渲染器实现。这在 OmniFaces 1.5 中已修复。`javax.faces.Button`[`UICommand`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UICommand.html)`null``CommandScript`

# php - 需要组合两个仅包含整数的数组的键值

> ID：15960706
> 
> 赞同：0
> 
> 时间：2013-04-11T23:36:49.167
> 
> 标签：php

我有两个关联的数组，其中包含指向不同值的键。我想通过对它们求和来组合不同数组的键值（它们都是整数）。例如我想把这两个数组：

`array_1(100=>3, 50=>10, 60=>30) array_2(100=>10, 60=>50)`

结果如下：

`array_combined(100=>13, 50=>10, 60=>80)`

希望你们能帮助我。

# apache-pig - 如何计算猪的总和？

> ID：15960710
> 
> 赞同：3
> 
> 时间：2013-04-11T23:38:11.620
> 
> 标签：apache-pig

有没有办法用 Pig 计算总和？

例如，如果我的数据是：

```
day1, 10
day2, 20
day3, 30 
```

有没有办法生成

```
day1, 10
day2, 30
day3, 60 
```

?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-01-11T11:56:18.373

从 PIG 0.12 开始，您拥有 Over UDF

[https://pig.apache.org/docs/r0.12.0/api/org/apache/pig/piggybank/evaluation/Over.html](https://pig.apache.org/docs/r0.12.0/api/org/apache/pig/piggybank/evaluation/Over.html)

所以这

```
 A = load 'T';
 B = group A by si
 C = foreach B {
     C1 = order A by d;
     generate flatten(Stitch(C1, Over(C1.f, 'sum(float)')));
 }
 D = foreach C generate s, $9; 
```

相当于这个

```
select s, sum(f) over (partition by si order by d) from T; 
```

我相信这就是你要找的。在您的情况下，您只需要远程分组，或使用组 ALL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-19T12:46:53.637

Hive 提供了一种非常好的方法来在一行中执行此操作 -
请按照以下过程来实现您的目标输出

创建一个**SALES**配置单元表，其中可以包含您的数据集（日期和销售） -

```
day   sale
day1, 10
day2, 20
day3, 30 
```

现在只需在您的配置单元终端中运行以下命令 -

```
SELECT day, SUM(sale) OVER (ORDER BY DAY) FROM SALES; 
```

输出将像 -

```
day1, 10
day2, 30
day3, 60 
```

我希望这可以帮助您获得目标输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T20:51:47.390

我能够使用数据集和自身的叉积提出一个解决方案。

样本输入：

```
{"daynum": "1", "daycount": 5}
{"daynum": "2", "daycount": 10}
{"daynum": "3", "daycount": 7}
{"daynum": "4", "daycount": 8} 
```

猪脚本：

```
raw = LOAD 'sample.json' USING com.twitter.elephantbird.pig.load.JsonLoader('-nestedLoad') as (json:map[]);
dat = FOREACH raw GENERATE (int)json#'daynum' as daynum:int, (int)json#'daycount' as daycount:int;
dat2 = foreach dat generate daynum, daycount;
xp = cross dat, dat2;
xpf = filter xp by (dat::daynum >= dat2::daynum);
grp = group xpf by (dat::daynum);
out = foreach grp generate FLATTEN(group), SUM(xpf.dat2::daycount) as running_total_daycount;
dump out;
(1,5)
(2,15)
(3,22)
(4,30) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T06:03:25.847

有没有一种有效的方法来利用 map reduce 范式计算 pig 的运行总数？不，我不这么认为。每个条目都依赖于它之前的条目，这意味着没有并行执行此操作的好方法。

有可能用 Pig 做到这一点吗？是的，你可以做一个 group all 把所有的数据放在一个包里，然后写一个你想要的 UDF。如果不是代数的，该函数至少可以实现累加器接口。 [https://issues.apache.org/jira/browse/PIG-296](https://issues.apache.org/jira/browse/PIG-296)看起来像是一个从未实现过的旧链接，指向编写 UDF 来执行此操作的人。

# phpstorm - phpstorm 中不再出现变量突出显示

> ID：15960713
> 
> 赞同：6
> 
> 时间：2013-04-11T23:38:18.190
> 
> 标签：phpstorm

通常在 PHPStorm 中，如果我单击一个变量，该变量的其他实例将被突出显示。

但是，我以某种方式对设置进行了更改，并且由于某种原因导致这种情况不再发生。有谁知道我可以在哪里恢复它，以便变量实例再次突出显示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-03T12:22:19.373

## 确保文件分析未设置为“省电模式”。

PHPStorm 窗口的右下角有一个*不应该变灰*的小警察。

![突出显示级别图标和对话框](https://i.stack.imgur.com/fQcL2.png)

如果它显示为灰色，则您已禁用检查/突出显示。

要重新启用它，请单击图标（从图片中打开对话框）或按 Ctrl+Alt+Shift+h（在 Windows 上），这是“配置当前文件分析...”的快捷方式并打开相同的对话。

只需取消选中“省电模式”复选框即可。

* * *

注意：`Highlighting Level`标尺实际上是为每个文件独立保存的，但`Power Save Mode`复选框是全局的。虽然“省电模式”意味着它可能会偶尔检查而不是一直检查，但似乎这会完全禁用检查，因此最好标记为“全局禁用检查”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-12T11:30:33.940

设置 | 编辑 | [x] 在插入符号处突出显示标识符的用法

# c++ - C++程序在条件为假之前退出循环

> ID：15960716
> 
> 赞同：2
> 
> 时间：2013-04-11T23:38:23.707
> 
> 标签：c++, loops

此方法接受一个向量（inputVector，成员变量）并将其拆分为 char*[]。每当你遇到一个“;” 在向量中，打印出存储在 args 中的最后一组 char*s。即使向量大小为 14，循环也会在第 5 个循环中退出。

**矢量数据（换行符分隔项目）：**
/bin/echo
killroy
在
这里；
;
xyzzy
;
不存在的程序
；
/bin/真
；
/bin/假
；

```
void TrivialShell::splitArguments() {

    char* args[MAX_ARGS];

    int inputVectorIdx = 0;
    int currentArgsIdx = 0;
    int startingArgsIdx = 0;

    while (inputVectorIdx < inputVector.size()) {

        if (inputVector[inputVectorIdx] == ";") {
            for (int k = startingArgsIdx; k <= currentArgsIdx; k++) {
                cout << args[k];
            }
            startingArgsIdx = currentArgsIdx + 1;
        }

        else {
            args[currentArgsIdx] = 
                const_cast<char*>(inputVector[inputVectorIdx].c_str());
        }

        inputVectorIdx++;
        currentArgsIdx++;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:51:26.753

```
for (int k = startingArgsIdx; k < currentArgsIdx; k++) {
 //                             ^^
                cout << args[k];
} 
```

You are trying to print one too much. You haven't said it but I am sure it doesn't just skip the loop but exits the program.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T00:03:03.867

你有一个错误。当你进入你的循环

```
if (inputVector[inputVectorIdx] == ";") {
            for (int k = startingArgsIdx; k <= currentArgsIdx; k++) {
                cout << args[k];
            }
            startingArgsIdx = currentArgsIdx + 1;
        } 
```

您的索引迭代器 currentArgsIdx 大于您在 array 中的实际数据大小`args`。`cout<<args[3]`因此，当那里已经有一些垃圾时，您正在这样做。这是因为您在 while 循环结束时 ++ 您的索引：

```
inputVectorIdx++;
currentArgsIdx++; 
```

以不同的方式安排它或将条件更改为：

```
for (int k = startingArgsIdx; k < currentArgsIdx; k++) {
                               ^^^
                cout << args[k];
            } 
```

# algorithm - 添加新元素并删除最旧元素后列表中的最大元素

> ID：15960720
> 
> 赞同：4
> 
> 时间：2013-04-11T23:38:53.307
> 
> 标签：algorithm

我有一个具有最大元素的整数列表，我需要跟踪列表中的最大元素：

```
[3, 1, 2] (3 is the max) 
```

每个时间段，我都会得到一个新的随机元素，将其添加到列表的末尾，并在恒定时间内删除列表的第一个元素。所以，在当前时间段结束时，我的列表会变成这样：

```
 [3, 1, 2]      (3 is the max)
->  [3, 1, 2, -5]  (don't care about max at this moment)
->  [1, 2, -5]     (now 2 is the max) 
```

我可以保留一个优先级队列，以列表中的值为键，进行 O(log(n)) 插入和删除，但我想知道是否有更有效的（可能 [摊销] 恒定时间？）方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T12:59:05.533

有 O(1) 摊销复杂度的算法：

使用双端队列： [移动窗口的最小/最大值可以在 O(N) 中实现吗？](https://stackoverflow.com/questions/12190184/)

有两个堆栈： [实现一个队列，其中 push_rear()、pop_front() 和 get_min() 都是常数时间操作](https://stackoverflow.com/questions/4802038/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T01:26:30.280

案例：

1.  New >= CurrentMax 并且首先：CurrentMax 更新为 New；
2.  New < CurrentMax 和 First < Current Max：不变；
3.  New < CurrentMax and First >= Current Max：搜索确定新的CurrentMax；

然而：

为了使第 3 种情况高效，您需要按插入顺序维护元素的（双向链接）列表，并按大小顺序维护树。然后您只需在列表和树中执行插入/删除，并从树中读取新的当前最大值。这与您的树实现一样高效，O(N) 构建插入顺序列表，O(N log N) 构建排名树。

保存列表元素的数据结构如下所示：

```
public class Element {
  Element PrevInsertionOrder;
  Element NextInsertionOrder;
  Element RankingTreeParent;
  Element RankingTreeLeftChild;
  Element RankingTreeRightChild;
  int Data;
} 
```

更新：

通过维护具有出现计数的不同键值的第二个（双向链接）列表（而不是上面的第二个树），执行 MAX 确定的 O(1) 时间似乎是可能的。

# c# - 将行添加到 dataTable 以在需要时填充

> ID：15960725
> 
> 赞同：1
> 
> 时间：2013-04-11T23:40:09.037
> 
> 标签：c#, logic

好吧，我从数据表中获得了这些数据：

```
Recom   House   49
Recom   Street  47
Recom   Floor   29
Area    House   5
Area    Floor   1
Observ  Floor   1 
```

但我想要这样的东西：

```
Recom   House   49
Recom   Street  47
Recom   Floor   29
Area    House   5
**Area  Street  0**
Area    Floor   1
**Observ    House   0**
**Observ    Street  0**
Observ  Floor   1 
```

我不能从存储过程中做到这一点，所以我正在尝试代码隐藏，但我真的不知道，我尝试了一些东西，但它不起作用，而且不是最好的解决方案。

```
int getTotal = ((from a in dtSerieDrill.AsEnumerable() 
                                             where a.Field<int>("idTipoRevision") == Int32.Parse(dtSerie.Tables[0].Rows[i]["idTipoRevision"].ToString())
                                             select a.Field<string>("TipoRevision")).Distinct()).ToArray().Length;

                            if (getTotal == arrayCat.Length) 
                            {
                                auxData += "{";
                                auxData += "name:'" + dtSerieDrill.Rows[n]["TipoRevision"].ToString() + "',";
                                auxData += "y:" + Double.Parse(dtSerieDrill.Rows[n]["Total"].ToString()) + "";
                                auxData += "},";
                            } else {
                                for (int g = 0; g < arrayCat.Length - 1; g++) 
                                {
arrayCat //categories(house,street,floor,etc)
                                    if (!arrayCat[g].Equals(dtSerieDrill.Rows[n]["Especialidad"].ToString()) && !(totalAux == (g+1))) 
                                    {
                                        auxData += "{";
                                        auxData += "name:'" + arrayCat[g] + "',";
                                        auxData += "y:0";
                                        auxData += "},";
                                        break;
                                    } else {
                                        auxData += "{";
                                        auxData += "name:'" + dtSerieDrill.Rows[n]["TipoRevision"].ToString() + "',";
                                        auxData += "y:" + Double.Parse(dtSerieDrill.Rows[n]["Total"].ToString()) + "";
                                        auxData += "},";
                                        break;
                                    }
                                }
                            } 
```

我有那个代码，因为我会将它用于脚本。我可以添加带有空“总计”的行或创建一些

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T14:55:11.350

我认为您可以使用数组或某种集合类型更轻松地实现此目标。

例如

```
//create you context
YourContext dbContext = new YourContext();

String[] firstCategory = dbContext.Categories.Where(x => x.categoryType == "YourFirstCategoryType").ToArray();
String[] secondCategory = dbContext.Categories.Where(x => x.categoryType == "YourSecondCategoryType").ToArray();

DataTable dt = new DataTable();
dt.Columns.Add("Category1");
dt.Columns.Add("Category2");
dt.Columns.Add("Total");

foreach(var c1 in firstCategory)
   foreach(var c2 in firstCategory)
   {
      //create a new row object 
      DataRow R = dt.NewRow();

      //set value to the colums
      R[0] = c1;
      R[1] = c2;
      R[2] = GetTotal(c1,c2);//GetTotal is some function that query database and returns total when you have c1 and c2 parameter, you should check is this combination doesn't exist you returns 0
      dt.Rows.Add(R);
   } 
```

我希望它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:53:17.293

suppose you have a DataTable dt, you can add new rows by using dt.Rows.Add(parameters)

# php - 抽象类与接口

> ID：15960729
> 
> 赞同：60
> 
> 时间：2013-04-11T23:40:22.353
> 
> 标签：php, interface, abstract-class, conceptual

我已经在 SO 以及网络的其余部分搜索了一个好的答案，但我还没有找到一个我真正理解的答案。我将以不同的方式呈现这一点，希望答案也能帮助其他人。

据我了解，这两个概念具有相同的规则，只是抽象类由于方法实现能力而更加灵活。另外，我知道您可以实现多个接口并且只扩展一个类，但我确信与我提到的两个相比存在更多差异。

请查看这两个代码片段，并给我一个示例，我可以对我的每个示例做什么，这会让我想要或不想使用另一个。

# 抽象类

```
abstract class Foo {
    abstract public function getValue();
    abstract public function setValue($value); 
}

class myObj extends Foo {
    function getValue() {

    }
    function setValue($value) {

    }
} 
```

# 界面

```
interface Foo {
    public function getValue();
    public function setValue($value);
}

class myObj implements Foo {
    function getValue() {

    }
    function setValue($value) {

    }
} 
```

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2013-04-12T01:08:59.090

**抽象的**

抽象类关注一种事物的相似性。

人们被认为是类型`mammal`，因此不会被认为是类型`vehicle`。

**界面**

接口侧重于相似功能的整理。

例如：您是人类，属于`mammal`. 如果你想飞，那么你需要实现一个`flying Interface`. 如果你想在飞行中射击，那么你还需要实现`gun Interface`.

**请参阅以下示例：**

```
abstract class Mammal {
      protected $age_;
      //below are functions I think all mammals will have,including people
      abstract public function setAge($age);
      abstract public function getAge();
      abstract public function eat($food);
}
class Person extends Mammal {
      protected $job_; //Person's feature
      public function setAge($age){
        $this->age_ = $age;
      }

      public function getAge(){
        return $this->age_;
      }

      public function eat($food){
        echo 'I eat ' ,$food ,'today';
      }

      //People only attribute
      public function setJob($job){
         $this->job_ = $job;
      }
      public function getJob(){
         echo 'My job is ' , $this->job_;
      }

}

//Now a person wants to fly, but they are typically not able to do so.
//So we implement an interface
interface Plane{
  public function Fly(); 
}

//I also want shoot enemy
interface Gun{
  public function shoot();
}

class Person2 extends Mammal implements Plane,Gun{

      protected $job_;//Person feature
      public function setAge($age){
        $this->age_ = $age;
      }
      public function getAge(){
        return $this->age_;
      }
      public function eat($food){
        echo '<br/>I eat ' ,$food ,' today<br/>';
      }
      //Only a person has this feature.
      public function setJob($job){
         $this->job_ = $job;
      }
      public function getJob(){
         echo 'My job is ' , $this->job_;
      }

      //-----------------------------------------
      //below implementations from interfaces function. (features that humans do not have).
      //Person implements from other class
      public function fly(){
        echo '<br/>I use plane,so I can fly<br/>';
      }
      public function shoot(){
        echo 'I use gun,so I can shoot<br/>';
      }
}

$People = new Person();
echo '<pre>';
print_r( get_class_methods('People'));
echo '</pre>';

echo '<pre>';
print_r( get_class_methods('People2'));
echo '</pre>';

$People2 = new Person2();
$People2->setAge(24);
echo $People2->getAge();
$People2->eat('egg');
$People2->setJob('PHP devepop');
echo $People2->getJob();

$People2->fly();
$People2->shoot(); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-04-11T23:53:08.230

To resume the idea (globally, not in detail):

```
inheritance 
```

is the notion to `extend from something`, and optionally add some new feature or override some existing feature (to do differently). But using inheritance, you share a big part of code with the parent. **You are** a parent + some other things.

```
interface 
```

is representing some abilities (we says a class is *implementing* an interface to says that it has these abilities). An interface can be implemented by 2 classes which are completely different and do not share their code (except for methods they implements). When A and B are implementing interface C, A is not a B and B is not a A.

And one of the reason for `interface` is indeed to allow programmer to do the same as they could do with multi-inheritance, but without multi-inheritance problems.

This notion is used in some programming languages like JAVA, PHP...

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-04-15T05:57:52.107

简单来说，**接口**就是规范一组函数，**抽象类**就是定义一个基本的骨架，供类派生。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-11T23:55:15.327

I have thought about this before, and the best I could conclude was that *interfaces are a logically convenient abstraction of a pure abstract class* (c++).

As for why you would choose interfaces over abstract classes, I quote ([a c++ source](http://en.wikibooks.org/wiki/C%2B%2B_Programming/Classes/Abstract_Classes/Pure_Abstract_Classes) but the concepts are the same):

> Note that there is a great temptation to add concrete member functions and data to pure abstract base classes. This must be resisted, in general it is a sign that the interface is not well factored. Data and concrete member functions tend to imply a particular implementation and as such can inherit from the interface but should not be that interface. Instead if there is some commonality between concrete classes, creation of abstract class which inherits its interface from the pure abstract class and defines the common data and member functions of the concrete classes works well.

The thing is, when using interfaces, the first thing that comes to mind is *decoupling*. When using an interface, the user and the implementing-class are totally decoupled. The same applies for when you're using a *pure abstract class* which is basically an interface.

# java - 即时生成 jinternalframes

> ID：15960734
> 
> 赞同：0
> 
> 时间：2013-04-11T23:40:44.853
> 
> 标签：java, swing, jinternalframe

我正在寻找一种以编程方式在内部（文本字段）中生成包含一些对象的 jinternalframe 的方法，但仍然能够访问这些字段。

我知道我需要将 jframe 创建为一个对象，然后可能在对象内部有一个方法可以轮询父级以获取更新？

作为一个真正简单的示例，我创建了以下应用程序来展示我正在尝试做的事情。按钮 1 和 2 生成带有文本框的 jinternalframe，然后我坚持让按钮 3 和 4 将一些文本填充到文本框中。

```
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    spawnwindow("Window1");
}                                        

private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    spawnwindow("window2");
}                                        

private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    //todo put data into jTextField2 in window 1
}                                        

private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {                                         
   //todo put data into jTextField2 in window 2
}                                        

    public void spawnwindow(String windowname){

    jInternalFrame3 = new javax.swing.JInternalFrame();
    jTextField2 = new javax.swing.JTextField();

    jInternalFrame3.setName(windowname);

    jInternalFrame3.setVisible(true);

    jTextField2.setText(windowname);

    jInternalFrame3.setTitle(windowname);

    javax.swing.GroupLayout jInternalFrame3Layout = new javax.swing.GroupLayout(jInternalFrame3.getContentPane());
    jInternalFrame3.getContentPane().setLayout(jInternalFrame3Layout);
    jInternalFrame3Layout.setHorizontalGroup(
        jInternalFrame3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jInternalFrame3Layout.createSequentialGroup()
            .addContainerGap()
            .addComponent(jTextField2, javax.swing.GroupLayout.DEFAULT_SIZE, 216, Short.MAX_VALUE)
            .addContainerGap())
    );
    jInternalFrame3Layout.setVerticalGroup(
        jInternalFrame3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jInternalFrame3Layout.createSequentialGroup()
            .addContainerGap()
            .addComponent(jTextField2, javax.swing.GroupLayout.DEFAULT_SIZE, 134, Short.MAX_VALUE)
            .addContainerGap())
    );

    jInternalFrame3.setBounds(230, 220, 250, 190);
    jDesktopPane1.add(jInternalFrame3, javax.swing.JLayeredPane.DEFAULT_LAYER);        

} 
```

# javascript - 玩！2.1.1 framework javascript in template 导致编译错误

> ID：15960737
> 
> 赞同：4
> 
> 时间：2013-04-11T23:41:01.713
> 
> 标签：javascript, scala, playframework

我刚开始使用播放框架。喜欢它，除了我在视图模板上遇到问题。

每当我直接在视图模板中包含 javascript 时，都会出现编译错误。这难道不能玩吗！模板？

```
@(title: String)(content: Html)

<!DOCTYPE html>

<html>
    <head>
        <title>@title</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/main.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.at("images/favicon.png")">
        <script src="@routes.Assets.at("javascripts/jquery-1.9.0.min.js")" type="text/javascript"></script>
    </head>
    <body>
<script>

function isEmpty(obj) {
    //for(var prop in obj) {
    //if(obj.hasOwnProperty(prop))
    try{
      if(JSON.stringify(obj)=='{}'){
        return true;
      }else{
        return false;
      }
    }catch(e){
      return false;
    }
  }

</script> 
```

我收到错误“未解析？” 与函数 isEmpty(obj) {

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T10:19:23.623

即使你用`//`for 模板的解析器括号注释 JavaScript 行也是一个特殊的字符：

```
//for(var prop in obj) { 
```

一般来说，Scala 模板中的括号具有特殊的含义，因此直接在视图中构建高级 JavaScript 会导致很多问题。您仍然需要控制 JS 中新的*无害*更改是否不会破坏模板解析器，反之亦然 - 如果模板解析器不会破坏您的脚本。最简单的解决方案是将 JS 从视图中分离出来，你有两个解决方案，我认为第一个更好：

1.  将您的 JS 保存到公共`*.js`文件中并将其包含在`<script src...>`标签中。如果您需要从视图中传递一些数据，请先使用 global JS var：

    ```
    <script>var helloMessage = "Welcome on page @title";</script> 
    <script src="/path/to/your.js"></script> 
    ```

2.  在控制器中读取 JS 的内容`file`（不是 Scala 模板！）并将其作为 a 传递`String`给视图，您需要使用以下命令对其进行转义`Html()`：

    ```
    @(title: String, mySpecialJS: String)(content: Html)
    <!DOCTYPE html>
    <html>
        <head>
            <title>@title</title>
            @Html(mySpecialJS)
        </head>
    <body> 
    ```

3.  您也可以加入这两种方法，例如，如果您想根据控制器/视图元素将复杂对象传递给 JavaScript，您还可以`JSON`在控制器中构建一个对象，将其转换为`String`然后包含带有 common 标签的 JS：

    ```
    @(title: String, myJsConfig: String)(content: Html)
    <!DOCTYPE html>
    <html>
        <head>
            <title>@title</title>
            <script>var myJsConfig = @Html(myJsConfig)</script> 
            <script src="/path/to/your.js"></script>
        </head>
    <body> 
    ```

所以最后`your.js`你可以像往常一样使用它们：

```
alert(helloMessage);
console.log("Config is...");
console.log(myJsConfig); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T06:41:25.007

错误实际上不在`isEmpty()`行。

如果您查看 Play 控制台，编译器输出指向不同的位置：

```
! @6e12h60d9 - Internal server error, for (GET) [/] ->

sbt.PlayExceptions$TemplateCompilationException: Compilation error[Not parsed?]
    at sbt.PlayCommands$$anonfun$43.apply(PlayCommands.scala:433) ~[na:na]
    at sbt.PlayCommands$$anonfun$43.apply(PlayCommands.scala:409) ~[na:na]
    at sbt.Scoped$$anonfun$hf5$1.apply(Structure.scala:581) ~[na:na]
    at sbt.Scoped$$anonfun$hf5$1.apply(Structure.scala:581) ~[na:na]
    at scala.Function1$$anonfun$compose$1.apply(Function1.scala:49) ~[scala-library.jar:na]
    at sbt.Scoped$Reduced$$anonfun$combine$1$$anonfun$apply$12.apply(Structure.scala:311) ~[na:na]
[warn] play - No application found at invoker init
[error] C:\Users\maba\Development\play\layout\app\views\main.scala.html:14: Compilation error[Not parsed?]
[error]             //for(var prop in obj) {
[error]                               ^
[error] (compile:sources) @6e12hd81d: Compilation error in C:\Users\maba\Development\play\layout\app\views\main.scala.html:14
[error] application - 
```

所以解析评论似乎有错误（目前不知道为什么）。

因此，如果您希望此代码运行，只需使用 Play 注释 ( `@* some comment *@`) 即可：

```
<script>

  function isEmpty(obj) {
    @*
    for(var prop in obj) {
    if(obj.hasOwnProperty(prop))
    *@
    try{
      if(JSON.stringify(obj)=='{}'){
        return true;
      }else{
        return false;
      }
    }catch(e){
      return false;
    }
  }

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-05T10:24:20.197

```
 function isEmpty(obj) {
    try{
  if(JSON.stringify(obj)=='{}'){
    return true;
  }else{
    return false;
  }
}catch(e){
  return false;
} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-10T12:35:19.507

正如@biesior 在第二点中描述的那样，`@Html()`从控制器打印代码（html/js）。但是我们可以在不作为参数传递的情况下编译它：

```
@Html(new String(
    """
    <script>

    </script>
    """)
) 
```

# c# - 实体框架事务不回滚

> ID：15960738
> 
> 赞同：0
> 
> 时间：2013-04-11T23:41:02.387
> 
> 标签：c#, .net, database, entity-framework, transactions

下面的代码在一个循环中执行了很多次。当我执行以下代码时，它偶尔会生成一个外键异常，这很好，因为它已被处理并且我尝试对事务进行角色回复。但是，在下一次运行时，它会生成相同的异常，并且会一遍又一遍地这样做，即使数据是正确的。

我们有一个存储上下文的单例类：

```
public class MyDatabaseContext
    {
        private static MyDatabaseContext _instance;

        public static MyDatabaseContext_Instance
        {
            get
            {
                if (_instance == null)
                {
                    _instance = new MyDatabaseContext();
                }

                return _instance;
            }
        }

        public MyEntities Context;

        private MyDatabaseContext()
        {
            Context = new MyEntities();
        }
    }
} 
```

减少循环主要部分的版本：

```
MyEntities entities = MyDatabaseContext.Instance.Context;

// Begin new transaction
entities.Connection.Open();
DbTransaction transaction = entities.Connection.BeginTransaction();

try {

    // Inside the update, we modify some data and call saveChanges() on the same
    // database context, see below
    dataObject.Update()

    // do more stuff to data here

    if (dataObject.isValid())
    {
        transaction.Commit();
    }
} catch (Exception ex) {
    // Rollback transaction
    transaction.Rollback();
} fincally {
    entities.Connection.Close();
} 
```

这是 Update() 方法，它会导致异常

```
public static Update() {
    // get same database context
    MyEntities entities = MyDatabaseContext.Instance.Context;

    // Update data, wont show here, but a foreign key is set to 0 which 
    //will cause an exception

    entities.saveChanges() // Exception thrown here! 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T11:17:45.153

MS SQL 不支持嵌套事务。很可能您已经在事务中，因此 Begin / Commit / Rollback 是**逻辑**事务而不是**物理**数据库事务。

尝试使用 SQL Profiler 检查它以查看实际发生的情况。

简单（但当然不是最好的）解决方案是，任何时候`Rollback`您实际上都需要关闭连接并重新开始。

# java - 运行导出程序时出现异常，但在 Eclipse 中没有

> ID：15960747
> 
> 赞同：0
> 
> 时间：2013-04-11T23:41:56.297
> 
> 标签：java, eclipse, export

我正在编写一个程序并尝试将其导出并将其发送给某人。当我在 Eclipse 中运行该程序时，它运行良好。但是，当我将它导出为 Runnable JAR 文件并双击它时，它会退出并告诉我检查控制台。

这是堆栈跟踪：

```
javax.imageio.IIOException: Can't read input file!
    at javax.imageio.ImageIO.read(ImageIO.java:1275)
    at me.pogostick29.audiorpg.util.PrereleaseChecker.run(PrereleaseChecker.java:29)
    at me.pogostick29.audiorpg.AudioRPG.main(AudioRPG.java:30)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:58)
javax.imageio.IIOException: Can't read input file!
    at javax.imageio.ImageIO.read(ImageIO.java:1275)
    at me.pogostick29.audiorpg.window.Window.<init>(Window.java:62)
    at me.pogostick29.audiorpg.window.WindowManager.setup(WindowManager.java:16)
    at me.pogostick29.audiorpg.AudioRPG.main(AudioRPG.java:32)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:58) 
```

* * *

我认为它没有正确导出图像。这是我访问图像的方式：

```
BufferedImage myPicture = null;
try { myPicture = ImageIO.read(new File("images/audiorpglogo.png")); }
catch (Exception e) { e.printStackTrace(); }
logo = new JLabel(new ImageIcon(myPicture)); 
```

* * *

另外，当我尝试

`myPicture = ImageIO.read(Window.class.getResource("/images/audiorpglogo.png"));`

即使在 Eclipse 中运行，我也会得到堆栈跟踪：

```
java.lang.IllegalArgumentException: input == null!
    at javax.imageio.ImageIO.read(ImageIO.java:1362)
    at me.pogostick29.audiorpg.window.Window.<init>(Window.java:70)
    at me.pogostick29.audiorpg.window.WindowManager.setup(WindowManager.java:16)
    at me.pogostick29.audiorpg.AudioRPG.main(AudioRPG.java:29) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T00:19:42.280

你可以这样试试：

```
ImageIcon icon = new ImageIcon("images/myimage.jpg"); 
```

`images/myimage.jpg`如果您在使用 JAR 文件运行应用程序的同一文件夹中有目录，这将起作用。

* * *

或者，如果您想使用放置**在**JAR 文件中的图像，您可以使用

```
ImageIcon icon = new ImageIcon(getClass().getResource("images/myimage.jpg")); 
```

当它在 IDE 中不起作用时不要害怕。当您从 JAR 文件运行它时，它将起作用。

* * *

这是一些对我有用的代码示例：

```
import java.io.IOException;

import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JLabel;

public class MyFrame extends JFrame {
    private static final long serialVersionUID = 1L;

    private JLabel iconLabel;

    public MyFrame() throws IOException {

        ImageIcon icon = new ImageIcon(getClass().getResource(
                "images/myimage.jpg"));
        iconLabel = new JLabel(icon);
        getContentPane().add(iconLabel);

        setSize(icon.getIconWidth(), icon.getIconHeight());
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setVisible(true);
    }

    public static void main(String[] args) throws IOException {
        new MyFrame();
    }
} 
```

当我尝试在 Eclipse 中运行它时，我得到

```
Exception in thread "main" java.lang.NullPointerException
    at javax.swing.ImageIcon.<init>(ImageIcon.java:205)
    at MyFrame.<init>(MyFrame.java:14)
    at MyFrame.main(MyFrame.java:25) 
```

这个 Eclipse 项目看起来像

![在此处输入图像描述](https://i.stack.imgur.com/yzIQ2.png)

在我将此项目导出到带有`images`文件夹的JAR 之后

`right-click on project`-> `Export`-> `JAR file`->`next`

![在此处输入图像描述](https://i.stack.imgur.com/jdm5N.png)

`next`-> `next`->`select main class`

![在此处输入图像描述](https://i.stack.imgur.com/U0xuN.png)

我双击创建的 JAR 文件并查看带有我的图像的框架：

![在此处输入图像描述](https://i.stack.imgur.com/DLd3F.png)

# php - 初学者 XMLHttpRequest 卡在处理上

> ID：15960748
> 
> 赞同：0
> 
> 时间：2013-04-11T23:42:04.450
> 
> 标签：php, http, xmlhttprequest

我正在测试一个脚本以允许我的日历加载当前月份。但是，当我打开页面时，它只显示“处理中......”我不知道为什么

```
 <script language="JavaScript" type="text/javascript">
function initialCalendar(){
    var hr = new XMLHttpRequest();
    var url = "calendar_start.php";
    var currentTime = new Date();
    var month = currentTime.getMonth() + 1;
    var year = currentTime.getFullYear();
    showmonth = month;
    showyear = year;
    var vars = "showmonth="+showmonth+"&showyear="+showyear;
    hr.open("POST", url, true);
    hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    hr.onreadystatechange = function() {
        if(hr.readyState == 4 && hr.status == 200) {
            var return_data = hr.responseText;
            document.getElementById("showCalender").innerHTML = return_data;
        }
    }
    hr.send(vars);
    document.getElementById("showCalendar").innerHTML = "processing...";
}
</script> 
```

身体是：

```
<body onLoad="initialCalendar();">

<div id="showCalendar"></div>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:01:14.603

您在 onreadystatechange 调用中使用 e 拼写了 Calendar，除此之外它应该可以工作。

我建议将您的“处理”行移到您的 hr.send(vars) 语句上方，以避免出现竞争条件。

# python - 如何在python中使用xpath列出属性值

> ID：15960752
> 
> 赞同：0
> 
> 时间：2013-04-11T23:42:33.867
> 
> 标签：python, xpath

我正在使用以下 python 代码进行 xpath 属性查找，但出现错误：
**selector.append(ops[token[0]](next, token)) KeyError: '@'**
Just using the starndard python2.7 release没有额外的模块

xml 文件如下所示：

```
<rule-set>
<rule name="firstRule" salience="3" />
<rule name="secondRule" salience="5" />
</rule-set> 
```

我的代码如下所示：

```
import xml.etree.ElementTree as ET
fp = open("./rules.xml", "r")
elementTree = ET.parse(fp)
e = elementTree.findall('rule') #looking up element, this works
for i in e:
    print i.attrib
e = elementTree.findall('rule/@salience') #directly looking up attribute fails
for i in e:
    print i
print 'all done' 
```

我有点困惑，...我认为 xpath1.0 会支持这个 xpath 查找，或者我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T00:13:08.720

从[文档](http://docs.python.org/2/library/xml.etree.elementtree.html#xpath-support)

> 该模块为在树中定位元素的 XPath 表达式提供了有限的支持。目标是支持缩写语法的一小部分；完整的 XPath 引擎超出了模块的范围。

该`xml.etree`模块不允许直接使用它的[xpath 语法](http://docs.python.org/2/library/xml.etree.elementtree.html#supported-xpath-syntax)选择属性，只能选择具有某些属性的元素。

如果您想要更完整的 xpath 支持，您应该查看[`lxml`](http://lxml.de).[`etree`](http://lxml.de/tutorial.html)

# javascript - JavaScript 的 i18n - 最佳实践？

> ID：15960753
> 
> 赞同：3
> 
> 时间：2013-04-11T23:42:39.830
> 
> 标签：javascript, internationalization

当前在 JavaScript 中处理 i18n 的最佳实践是什么？

我听说过一些关于使用 PHP/Rails/etc 输出所有 i18n 字符串的建议。放入包含数千个变量的格式化 JavaScript 文件，但这听起来太粗糙了；此外，需要有一种方法来检测将要加载到给定页面上的 JS 文件实际上需要哪些 i18n 字符串，但我现在不知道如何实现这一点。

我听到的其他一些建议涉及在后端和前端之间设置某种 API，使用格式良好的 JSON 作为 i18n 字符串的载体，但这仍然不能解决我可能不需要的冗余字符串的问题。

目前在 JavaScript 中关于 i18n 的一些最佳实践是什么，如果可能的话，还有一个解决方案来检测和仅发送给定页面上实际需要的那些字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T23:55:12.663

The 'best practice' really depends on how you build you application. Two examples:

*   **Single page app.** Of course you'd want to just load all of the needed strings for you entire application in one go, as constantly fetching new strings would be a waste of time and resources.
*   **Page with some JS-based content.** If you keep reloading the JS, you probably want to reduce the amount of strings as much as possible, and maybe even integrate the entire i18n dict in your HTML to avoid a AJAX call.

Either way, you'll want to reduce the amount of strings sent to the client to a bare minimum. While there are a lot of approaches, my favorite is to use pre-compiled templates (I like Mustache using Twitter's Hogan.js) with i18n extensions that don't only return a function to generate the HTML, but also a list of all translatable strings.

What you definitely **don't** want to do is to build a function that checks whether you already have a translation and if you don't then ask the server. This will make everything very slow and you don't want that. Either pre-load all translations, or don't translate those parts.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T17:08:31.180

这取决于您所说的“i18n”是什么意思。从您的问题来看，您似乎只是指可翻译的字符串提取。在这种情况下，我倾向于从后端生成的单个 JS 脚本。这可能包含数组中的所有可翻译字符串和一些查找方法。我不知道您是否称其为“千变量方法”，但这就是我所倾向于的。我知道您可能不喜欢`alert(tr.getString("some.key"))`在代码中包含类似的内容，但是既然您询问了最佳实践...

我见过很多解决方案，但其中大多数只是重新发明轮子。问题是，在大多数情况下，轮子都是方形的……

话虽如此，i18n 比简单的字符串提取要广泛得多。您必须注意区域格式支持、正确的排序规则、对可本地化的支持（提取字符串只是其中的一部分）等等。我不能真正谈论“最佳实践”，因为这个问题太宽泛了。但是，我可以说的是，它确实取决于平台（即编程语言）。

# internet-explorer-9 - Javascript Object.prototype.hasOwnProperty 在使用 YUI 属性默认值时为 IE9+ 返回不正确的值

> ID：15960758
> 
> 赞同：0
> 
> 时间：2013-04-11T23:43:04.570
> 
> 标签：internet-explorer-9, yui, internet-explorer-10, hasownproperty

我相信我在 IE9+ 和/或 YUI 3 中使用 hasOwnProperty javascript 方法发现了一个错误。我想知道这里是否有人以前见过这个问题，或者你是否能够进一步隔离这个问题。我想将此问题告知相关方，但我不知道是否需要联系 IE 团队或 YUI。

**细节：**

当 IE9/IE10 为：

*   以标准模式渲染
*   涉及一个初始化的 YUI 属性（示例代码中的第 11 行）

hasOwnProperty 为包含无效 javascript 标识符的键的对象返回不正确的值（ab 中的 b 可以，a.5 中的 5 无效）。有效的标识符没有这个问题。

**示例代码：**

[http://jsfiddle.net/bobbyakadizzy/nLZJy/6/](http://jsfiddle.net/bobbyakadizzy/nLZJy/6/)（记住这个问题只出现在IE9/IE10）

```
YUI.add("ie9-hasOwnProperty-test", function (Y) {

        function IE9HasOwnPropertyTest(config) {
            IE9HasOwnPropertyTest.superclass.constructor.apply(this, arguments);
        }

        Y.mix(IE9HasOwnPropertyTest, {
            NAME : "IE9HasOwnPropertyTest",
            ATTRS : {
                attributeWithNumericProperty : {
                    value : {}
                },
                attributeWithStringProperty : {
                    value : {}
                }
            }
        });

        Y.extend(IE9HasOwnPropertyTest, Y.Base, {

            initializer: function (config) {
                // Uncomment this section below the problem will be "fixed".  The problem appears to be related to attribute initialization.
                // this.set("attributeWithNumericProperty", {}); 
                var attributeWithNumericProperty = this.get("attributeWithNumericProperty");
                attributeWithNumericProperty['1234'] = 999;
                GLOBAL_attributeWithNumericProperty = attributeWithNumericProperty;

                // If the object property is an identifier can be set after a dot (e.g. a.b) then the problem will not be hit
                var attributeWithStringProperty = this.get("attributeWithStringProperty");
                attributeWithStringProperty['a1234'] = 999;
                GLOBAL_attributeWithStringProperty = attributeWithStringProperty;
            }
        });
        Y.IE9HasOwnPropertyTest = IE9HasOwnPropertyTest;
    }, "3.0.0", { requires : ["widget"]}); 
```

当它应该返回 true 时，运行`new Y.IE9HasOwnPropertyTest(); GLOBAL_attributeWithNumericProperty.hasOwnProperty('1234');`将返回 false。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:02:03.893

这是一个非常奇怪的行为。我需要做更多的研究来找出它发生的原因，但这似乎是 YUI 在默认值是对象时处理默认值的方式的结果。YUI 尝试克隆对象以防止这种情况发生：

```
function MyClass() {
  MyClass.superclass.constructor.apply(this, arguments);
}
Y.extend(MyClass, Y.Base, null, {
  ATTRS: {
    foo: {
      value: []
    }
  }
});

var obj1 = new MyClass();
var obj2 = new MyClass();

obj1.get('foo').push('bar');
console.log(obj2.get('foo')); // ['bar'] oops! 
```

您可以通过不使用对象作为默认值而是使用返回新对象的函数来修复它。这样你总是会得到一个新的对象，YUI 不会太聪明：

```
MyClass.ATTRS = {
  foo: {
    valueFn: function () {
      return {};
    }
  }
}; 
```

# xcode - Mac OS X 中的 VTK 错误

> ID：15960763
> 
> 赞同：0
> 
> 时间：2013-04-11T23:43:34.823
> 
> 标签：xcode, macos, cocoa, vtk

我是 vtk 的新手，我正在尝试构建 VTK 5.10.1 附带的示例代码。

链接器给了我以下问题：

```
Undefined symbols for architecture x86_64:
  "_OBJC_CLASS_$_vtkCocoaGLView", referenced from:
      _OBJC_CLASS_$_BasicVTKView in BasicVTKView.o
  "_OBJC_METACLASS_$_vtkCocoaGLView", referenced from:
   _OBJC_METACLASS_$_BasicVTKView in BasicVTKView.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我不知道应该做什么。

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T11:27:48.107

您是否使用 VTK_USE_COCOA=ON 构建了 libvtkRendering？
还有一个[邮件列表](http://www.vtk.org/pipermail/vtkusers/2010-May/109245.html)，通过将 IOKit 框架添加到项目中解决了问题，但我个人认为这不是原因。不管怎样，看看邮件列表

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-12T03:39:34.930

我的安装参考 URL：[How to install VTK 6.1 for OSX 10.8 with Cocoa/XCode support？](https://stackoverflow.com/questions/17329258/how-to-install-vtk-6-1-for-osx-10-8-with-cocoa-xcode-support). 在我使用安格斯福布斯的方法后，我遇到了和你上面贴的一样的麻烦。

我的解决方案如下： [1] 在 xcode -> Project -> clean.
[2] (a) 打开终端，进入您构建 VTK 的文件夹，例如。~/VTK/VTKBuild. (b) 清洁。

就这样。但是，我不知道它为什么起作用。

# java - 使用java在图中查找集群

> ID：15960766
> 
> 赞同：1
> 
> 时间：2013-04-11T23:44:11.513
> 
> 标签：java, graph, neo4j, cluster-analysis

考虑以下陈述

有向图-1：

> a1->p1->b1
> b1->p2->c1
> b1->p3->c2
> b1->p4->c3

有向图2：

> a1->p4->c2
> a1->p1->b1
> a2->p2->b1
> b1->p3->c1
> a2->p5->b2

这里“a”、“b”和“c”是顶点，所有“p”都是边。方向是从节点 a 到节点 b/c。绘制图表时，它看起来类似于[http://www.slideshare.net/fvanvollenhoven/network-analysis-with-hadoop-and-neo4j的幻灯片 8 中的图表](http://www.slideshare.net/fvanvollenhoven/network-analysis-with-hadoop-and-neo4j)

在图 1 中，有一个从节点 b1 开始的集群，在图 2 中，有两个集群在 b1 处连接。我所说的集群是指所有连接到一个顶点的出边以及该组（出边）中涉及的顶点。有没有一种使用任何现有的基于 java 的图形 API 来查找这些集群的快速简便的方法？我还想找到连接到集群的边（如 Graph-1 中的 a1 p1 b1 和 Graph-2 中的 b1 p3 c1）。我在这里遗漏/误用了一些图形术语吗？我看了[Good Java graph algorithm library？](https://stackoverflow.com/questions/51574/good-java-graph-algorithm-library)但没有找到我正在寻找的东西。

这些图非常小，大约有 20 个顶点和 10 条边。

**注意**：添加了 Neo4j 标签，因为我觉得它是一个很好的候选者。Neo4j 的具体问题：有没有办法让计数大于 1 的边缘全部可用？（现在正在探索密码）。

提前致谢。

# perl - 如何在 perl 脚本中包含配置类型文件

> ID：15960770
> 
> 赞同：1
> 
> 时间：2013-04-11T23:44:26.560
> 
> 标签：perl, global-variables, require

好的，我放弃并寻求帮助；

我有一个脚本可以访问我的 MySQL 数据库中的信息。我希望我的凭据隐藏在一个我可以包含的文件中以确保安全。为了使它更整洁，我尝试在我的 cgi-bin 目录中创建一个子目录（包含）。

这是一个省略所有数据库内容的简单示例（因为这不是我的问题）。

### config.pl（在包含目录中）

```
#!/usr/bin/perl
use strict;
use warnings;

$data_base = 'dbi::mysql::test_db';
$db_user = 'some_user';
$db_pw = 'password'; 
```

### test_driver.pl（在 cgi-bin 目录中）

```
#!/usr/bin/perl
use strict;
use warnings;
use DBI;

require'/include/config.pl';

$param1 = $data_base;
$param2 = $db_user;
$param3 = $db_pw; 
```

我得到的第一个错误是找不到包含。我还看到很多帖子显示`our`在变量前面添加。大多数帖子也提到根本不使用`require`，但对于简单的事情我宁愿。

我最终遵循了一些关于如何制作模块的教程。我让它工作了，但对于一个简单的配置文件来说，这似乎需要付出很多努力。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T00:36:31.350

让我们回到你在做什么，虽然......

当您使用`require`时，它实际上是在执行期间读入文件。但是，作为[要求](http://perldoc.perl.org/functions/require.html)状态的 Perldoc：

> 该文件是通过 do-FILE 机制包含的，它本质上只是各种“eval”，但需要注意***的是调用脚本中的词法变量***对包含的代码是不可见的。

词法（又名*局部*变量，又名`my`变量）不起作用。您需要包（又名全局，又名`our`）变量。

这是一个简单的测试：

### 测试.pl

```
#! /usr/bin/env perl
use 5.10.0;
use warnings;

our $variable;

require 'include.pl';
say "The value of \$foo is $foo"; 
```

### 包括.pl

```
$foo = "I am foo (honest!)";

1; 
```

如果我跑步`test.pl`，我会得到：

```
The value of $foo is I am foo (honest!) 
```

我看到几个问题。首先，您强迫自己使用特定变量作为您的帐户和密码。这并不是一个很好的编程理念。它基本上是看不见的东西发生在视线之外。

与其*包含*在文件中，不如使用真正的 INI 文件。我以前使用过一个名为[Config::Ini](http://search.cpan.org/dist/Config-INI/lib/Config/INI.pm)的 Perl 模块，它相当容易使用。您创建一个类似 Windows 的 INI 文件，并从中读取您的信息。

如果您不想使用 INI 文件，请使用子例程。这样，您不必使用`our`变量，也不会被困在说您的密码必须是`$password`. 毕竟，这个配置文件很可能会被多个程序使用。这只是更好的编程：

### 测试驱动程序.pl

```
#! /usr/bin/env perl
use 5.10.1;
use warnings;

require "config.pl";

my $password = get_password();
my $account  = get_account(); 
```

### 配置文件

```
use 5.10.1;
use warnings;

sub get_password { return "swordfish" );
sub get_account { return "some_user" };
sub get_db      { return "database_name" };

1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T23:58:48.523

您在 中提供的路径`require`已关闭：您指定了绝对路径，但您将服务器的 docroot 误认为是实际的文件系统根。

`/include/config.pl`锚定在文件系统根目录，方式相同`/usr/bin/perl`。

`./include/config.pl`将是相对于当前目录（可能是`cgi-bin`文件夹）的路径，并且可能会更好。如果你知道 cgi-bin 目录的绝对路径，你可以使用绝对路径：`/var/www/whatever/structure/the/host/has/htdocs/cgi-bin/include/config.pl`

如果您使用的是 Web 框架（我希望您是）而不是普通的、过时的 CGI，那么可能已经存在一个配置文件。例如，Dancer 有一个 YAML 文件，其中包含许多可以扩展的设置。

# iis-7 - iis7 中缺少会话状态功能

> ID：15960772
> 
> 赞同：1
> 
> 时间：2013-04-11T23:44:37.127
> 
> 标签：iis-7

我正在尝试使用 IIS7 中的 IIS 管理器来处理会话状态功能，但我看不到它，也不知道如何让它出现。我在 Windows Server 2008 R2 数据中心上使用 IIS 7。有任何想法吗？

```
Windows Server Version 6.1 (Build 7601: Service Pack 1)
IIS Version 7.5.7600.16385 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T00:09:15.970

如果您安装了 ASP.Net，它应该出现在服务器节点下的 ASP.NET 下：

![会话状态图标](https://i.stack.imgur.com/PYhgH.jpg)

# java - 使用 Java VisualVM 分析 JOGL

> ID：15960786
> 
> 赞同：2
> 
> 时间：2013-04-11T23:45:41.730
> 
> 标签：java, opengl, profiling, jogl, deferred-rendering

我正在开发一个 OpenGL 3D 渲染器。我正在使用 Java 和 JOGL API。现在我正在尝试对我的延迟渲染器进行性能调整。为此，我使用 VisualVM Profiler 来查看是什么占用了我宝贵的 CPU 周期，并使用 gDEBugger 来跟踪我的 OpenGL 函数调用。现在，即使只有 20 到 30 个灯光（并且需要点亮的实际网格数量非常少），它的 FPS 也会下降到 30 帧以下。而且我什至还没有添加阴影贴图和法线贴图之类的东西。

这就是它目前的样子（41 盏灯，但只有 20 FPS）： ![延迟渲染器屏幕截图](https://i.stack.imgur.com/77k3I.jpg)

在 VisualVM 中，我注意到大部分*CPU*时间都花在了本机`jogamp.opengl.windows.wgl.WGLUtil.SwapBuffers`方法上。但是，我不确定这些信息是否与我的着色器的运行时间相关或以任何方式相关。调用的运行时间`glDrawArrays`可以忽略不计，这证实了这个方法只是向 GPU 发出调用，并且显然没有等待它们完成后再返回。为什么我的应用程序的大部分时间都花在该函数调用上？

同样比较奇怪的是：当我有 3-4 盏灯时，我以 60FPS 的速度运行。当我将该数字增加到 20 时，该数字下降到 20FPS。当我添加 1000-1100 盏灯时，我仍然可以获得大约 10 FPS。这是为什么？由于光照计算是相加的，当有 1000 个光照时，每个像素运行的片段着色器应该比有 20 个光照时多得多，这意味着渲染器理论上*应该比 20 个光照慢得多。*为什么从 3-4 盏灯跳到 20 盏灯时会出现如此巨大的性能？

* * *

现在我的问题的第二部分：就像我之前说的，我也开始使用 gDEBugger 来分析我的 OpenGL 调用，但是，遗憾的是，我似乎无法找到一种方法来准确确定执行时间最长的内容 -我只获得有关哪些函数被调用最多的信息。在尝试寻找冗余状态更改之类的事情时它会有所帮助，但对于我所处的阶段，我确信存在更大的问题会减慢我的渲染器速度。

有谁知道一种可靠的方法来跟踪我的片段着色器的执行时间，并准确查看哪些片段中哪些计算花费的时间最长？我知道 nVidia nSight 提供了一些出色的图形调试功能，但其中大部分仅适用于 DirectX 应用程序。

# ios - 代表在 AFNetworking 响应块内变为 nil？

> ID：15960787
> 
> 赞同：0
> 
> 时间：2013-04-11T23:45:42.963
> 
> 标签：ios, ios5, ios6, afnetworking

我正在使用 AFNetworking 来获取数据，并且我在 Service 类中有一个委托，它可能是 UIController。Service 类负责通过 AFNetworking 类获取数据。

```
//Class Service. 

@interface Service : NSObject {

    __weak id<ServiceDelegate>delegate;

}

- (void) doFetch:(APIInput*) input {

    NSURL *url = [NSURL URLWithString:[self getLocation:input]];
    NSLog(@"url request is: %@", url);
    NSURLRequest *request = [NSURLRequest requestWithURL:url];

    AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
        //NSLog(@"IP Address: %@", [JSON valueForKeyPath:@"origin"]);

        [self.delegate serviceDidComplete:[self allocNewData:JSON]];
    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response,
                NSError *error, id JSON){

        [self.delegate serviceFailed: error];
    }];

    [operation start];
} 
```

在 UIController viewDidLoad: 我有以下

```
self.networkService = [[Service alloc] init];
[self.networkService setDelegate:self]; 
```

运行 ios 应用程序后，self.delegate 为零。为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T04:10:38.840

这解决了它。我在设置操作之前创建了一个 __block 变量

```
__block id itsme = self.delegate;

AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
        //NSLog(@"IP Address: %@", [JSON valueForKeyPath:@"origin"]);

        [itsme serviceDidComplete:[self allocNewData:JSON]];
    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response,
                NSError *error, id JSON){

        [itsme serviceFailed: error];
    }]; 
```

# ios - 在 Core Data 中加载具有关系的托管对象时的标准行为是什么？

> ID：15960789
> 
> 赞同：0
> 
> 时间：2013-04-11T23:45:45.907
> 
> 标签：ios, core-data

在谈论 Core Data 时，我面临一个常见但简单的问题。在一个简单的 Master-Detail 示例中，一个名为“Category”的实体与名为“Products”的实体具有（对多）关系，在获取类别时在加载时会发生什么预期？

类别是否也会自动加载其相关产品？或者我们仍然必须在详细视图中获取它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T23:50:45.483

我想你想阅读 Core Data [faults](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFaultingUniquing.html)。它们为核心数据系统提供了一种方法，可以将您获取的对象（例如类别）返回给您，而无需立即加载所有相关的产品。取而代之的是，这种`products`关系将包含一个*错误*——实际上是在您需要时为您提供真实 Product 实例的承诺。

稍后，当您访问 Category 的`products`关系时，Core Data 将自动透明地加载该关系的内容，而无需您运行另一个 fetch。这称为“意识到”或“触发”故障，您不需要采取额外的行动。

# box-api - Box 是否支持授予类型“资源所有者密码凭据授予”？

> ID：15960792
> 
> 赞同：0
> 
> 时间：2013-04-11T23:45:59.980
> 
> 标签：box-api

Box 网站上有关 OAuth 2.0 的文档仅提及授权类型“授权码”。

您能否确认 Box 是否支持授予类型“资源所有者密码凭据授予”？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T17:21:33.970

我们目前不支持密码授予，将来也可能不支持。

Box 与许多 OAuth 2 提供商的不同之处在于，我们的大部分客户使用单点登录提供商（例如 Ping、Okta、OneLogin 等）登录 Box。在这些情况下，Box 没有为用户存储密码，因此无法支持他们的密码授予。

我们的 OAuth 2 Web 流程消除了直接与所有这些 SSO 提供者打交道的复杂性，因此开发人员最终很容易制作出适用于所有 Box 用户的应用程序。

# python - Python 错误 - ValueError：需要超过 1 个值才能解压

> ID：15960795
> 
> 赞同：0
> 
> 时间：2013-04-11T23:46:30.667
> 
> 标签：python, numpy, matplotlib, face-recognition, pca

我正在尝试使用python（matplotlib）通过主成分分析（PCA）进行人脸识别。我正在尝试按照此图片中的说明进行操作：

![在此处输入图像描述](https://i.stack.imgur.com/wfWLs.gif)

这是我的代码：

```
import os
from PIL import Image
import numpy as np
import glob
from matplotlib.mlab import PCA

#Step1: put database images into a 3D array
filenames = glob.glob('C:\\Users\\Karim\\Downloads\\att_faces\\New folder/*.pgm')
filenames.sort()
img = [Image.open(fn).convert('L') for fn in filenames]
images = np.dstack([np.array(im) for im in img])

# Step2: create 2D flattened version of 3D input array
d1,d2,d3 = images.shape
b = np.zeros([d1,d2*d3])
for i in range(len(images)):
  b[i] = images[i].flatten()

#Step 3: database PCA
results = PCA(b.T)
x = results.Wt

#Step 4: input image
input_image = Image.open('C:\\Users\\Karim\\Downloads\\att_faces\\1.pgm').convert('L')
input_image = np.array(input_image)
input_image = input_image.flatten()

#Step 5: input PCA
in_results = PCA(input_image.T)
y = in_results.Wt

#Step 6: get shortest distance 
```

但我说错了`in_results = PCA(input_image.T)`： `Traceback (most recent call last): File "C:\Users\Karim\Desktop\Bachelor 2\New folder\new2.py", line 29, in <module> in_results = PCA(input_image.T) File "C:\Python27\lib\site-packages\matplotlib\mlab.py", line 846, in __init__ n, m = a.shape ValueError: need more than 1 value to unpack`

有人可以帮忙吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T23:57:29.050

问题是`PCA`构造函数需要一个 2D 数组，并假设您要传递一个数组。您可以从回溯中看到：

```
in __init__ 
n, m = a.shape 
ValueError: need more than 1 value to unpack 
```

显然如果`a`是 0D 或 1D 数组，`a.shape`将不会有两个成员，因此这将失败。您可以尝试`input_image.T.shape`自己打印出来看看它是什么。

但是您的代码至少有一个问题，可能是两个。

首先，即使您在某个时候有一个 2D 数组，您也可以这样做：

```
input_image = input_image.flatten() 
```

在那之后，当然，你有一个一维数组。

其次，我认为您从未有过二维数组。这：

```
input_image = np.array(input_image) 
```

...应该根据`numpy`和`PIL`文档所说的内容创建一个带有一个对象的“标量”（0D）数组。在各种不同的设置上测试它，我有时似乎得到一个 0D 数组，其他的 2D 数组，所以也许你没有这个问题 - 但如果你没有，你可能会在你运行时立即得到它机器。

你可能想要这个：

```
input_image = np.asarray(input_image) 
```

这会给你一个二维数组，或者引发一个异常。（好吧，除非你不小心打开了一个多通道图像，在这种情况下，它当然会给你一个 3D 数组。）

# javascript - 使用 setTimeout 减慢 AJAX 功能

> ID：15960801
> 
> 赞同：0
> 
> 时间：2013-04-11T23:47:22.960
> 
> 标签：javascript, ajax

我的网站上有一个 ajax 搜索功能，效果很好！但是，我看到由于快速的打字机，它可能会导致未使用的 httpResquests。所以我想添加一个计时器来减慢搜索速度。

首先想到的是 setTimeout，但它不起作用。它似乎第一次起作用（暂停搜索），但在显示结果后，它只是有点恢复正常显示结果，第二次我的键是。因此，在我注意到无论出于何种原因它都不起作用之后，我转向 stackoverflow 并找到[了这个](https://stackoverflow.com/questions/3028704/optimized-search-using-ajax-and-keypress)和[这个](https://stackoverflow.com/questions/1171582/how-do-i-make-my-live-jquery-search-wait-a-second-before-performing-the-search)，但他们基本上完全按照我所做的那样工作。

我认为它可能与 AJAX 的异步方式有关，并且可能在时间实际结束之前在 setTimeout 中调用该方法，但这没有多大意义。所以说实话，我不知道发生了什么任何见解都会非常感激。哦，我使用我自己的 API，我相信只要看一眼方法名称，您就会知道它们的作用。

```
function validateNetworkInput()
{
    var query, timer = null;

    query = getValue("searchNetworkInput");

    if(query.length > 0)
    {
        clearTimeout(timer);
        show("searchNetworkWrapper");       
        timer = setTimeout(function(){searchNetworks(query);}, 3000);
    }
    else
    {
        clearTimeout(timer);
        hide("searchNetworkWrapper");
    }
} 
```

...

```
function searchNetworks(query)
{
    var ajaxObject, params, path;

    ajaxObject = getAjaxObject();
    params = "?q=" + query;
    path = getInternalPath() + "searchNetworks" + params;

    ajaxObject.open("GET", path, true);
    ajaxObject.send();

    ajaxObject.onreadystatechange = function()
    {
        if(ajaxObject.readyState == 4 && ajaxObject.status == 200)
        {
            setInnerHtml("searchNetworkWrapper", ajaxObject.responseText);
        }
        else if (ajaxObject.readyState == 4 && ajaxObject.status != 200)
        {
            getErrorReport("Error Searching Networks", "search our database for the network you are looking for");
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:54:27.780

你的问题是`timer`你的函数是本地的，所以下次调用它时它不会记住旧的计时器。您需要一个在函数调用之间存在的变量。像这样的东西应该工作：

```
var validateNetworkInput = (function() {
  var timer;
  return function() {
    var query = getValue("searchNetworkInput");

    clearTimeout(timer);
    if(query.length > 0) {
        show("searchNetworkWrapper");       
        timer = setTimeout(function(){searchNetworks(query);}, 3000);
    } else {
        hide("searchNetworkWrapper");
    }
})(); 
```

# testing - 如何测试加密安全的随机数生成器

> ID：15960803
> 
> 赞同：1
> 
> 时间：2013-04-11T23:47:39.920
> 
> 标签：testing, random, cryptography

或多或少出于好奇，什么将随机数生成器定义为加密安全？对非密码安全和密码安全生成器的测试会有所不同吗？

此处的相关帖子：[如何测试随机生成器](https://stackoverflow.com/questions/2130621/how-to-test-a-random-generator)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T00:10:20.787

测试通用随机数生成器的质量通常涉及运行各种统计测试，这些测试表明其结果在某些方面没有偏差。NIST 有一组用于此目的的测试，详见：[http ://csrc.nist.gov/groups/ST/toolkit/rng/index.html](http://csrc.nist.gov/groups/ST/toolkit/rng/index.html)

证明随机数生成器在密码学上是安全的，根本不是测试的问题，而是**证明**的问题。这通常归结为表明，要从 RNG 的输出样本中预测未来（或猜测过去）的输出（在某些情况下，甚至在控制部分输入时），必须击败密码散列、密码或其他通常被认为难以解决的问题。这是一个基本上由人为驱动的过程；它不能机械地执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:58:44.457

1）至于“什么构成'加密安全伪随机数生成器'（CSPRNG）？”，维基百科有一个很好的标准列表：

[http://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator](http://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator)。

2）至于“如何测试”，您可以考虑卡方：

[http://en.wikibooks.org/wiki/Algorithm_Implementation/Pseudorandom_Numbers/Chi-Square_Test](http://en.wikibooks.org/wiki/Algorithm_Implementation/Pseudorandom_Numbers/Chi-Square_Test)

# css - PHPStorm：如何设置 LESS 以使用文件观察器输出到 CSS 目录？

> ID：15960810
> 
> 赞同：22
> 
> 时间：2013-04-11T23:48:42.067
> 
> 标签：css, less, phpstorm

如何使用 PHPStorm 中的文件观察器设置 LESS 文件观察器输出路径来执行此操作：

我想：

/project/path/less/dir/file.less

输出到：

/project/path/css/dir/file.css

或者

/project/path/less/file2.less

输出到：

/project/path/css/file2.css

我没有看到使用 PHPstorm 中的输出路径宏实现这一点的明确方法。使用 FileDirRelativeToProjectRoot 宏，我可以获得当前目录的路径，但是没有明确的方法可以在路径中用 /css 替换 /less。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-04-12T07:02:22.013

请参阅[我对 JADE file watcher 的相关答案](https://stackoverflow.com/a/15505281/104891)，我相信 LESS 也是如此。

诀窍是使用`$FileDirPathFromParent(dir)$`宏：

`$ProjectFileDir$/css/$FileDirPathFromParent(less)$`将为`/project/path/css/dir/`位于`/project/path/less/dir/`目录中的文件生成。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-07-23T02:43:38.903

I want to compile one less file from

sites/all/themes/bic/res/less/style.less to sites/all/themes/bic/res/css/style.css

Here's what I did

![enter image description here](https://i.stack.imgur.com/pSObf.png)

So the Arguments I used is: --no-color $FileName$ ../css/$FileNameWithoutExtension$.css

This will produce: /usr/local/bin/lessc --no-color blogs.less ../css/blogs.css at phpstorm console, and works fine.

I might miss something. Anyway, I tried both "--no-color $FileName$ $ProjectFileDir$/sites/all/themes/bic/res/css/$FileDirPathFromParent(less)$" and "--no-color $FileName$ $ProjectFileDir$/sites/all/themes/bic/res/css/$FileDirPathFromParent(less)$$FileNameWithoutExtension$.css". Neither of them work for me. So just post my solution here, which might help some people who has the same trouble with me..

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-27T10:45:52.913

只需将**输出路径更改为刷新**即可：

`../css/$FileNameWithoutExtension$.css`

**更新：**

在新版本的 LESS 中，您应该在指定的路径中反转斜杠。所以应该是：

`..\css\$FileNameWithoutExtension$.css`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-14T09:09:22.387

为更少的编译器更改输出目录。
在 tat 中打开编辑观察器，您将看到在该输入框中刷新的输出路径更改如下`../yourfolderpath/$FileNameWithoutExtension$.css`。`.css`现在您可以看到对该路径的编译更少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-05T11:16:09.857

我在让 scss 文件观察程序输出到 css 目录时遇到了类似的问题

这就是我所做的。

1.  在争论中，`--no-cache --update $ProjectFileDir$/css/style.css`
2.  在要刷新的输出路径中，`$ProjectFileDir$/css/$FileDirPathFromParent(scss)$$FileNameWithoutExtension$.css`

您可以修改它以使用**`LESS`**

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-04-12T07:31:41.617

您可能想尝试[将 SimpLESS](http://wearekiss.com/simpless)作为观察者，以动态检查/编译 LESS 到 CSS - 在所有平台上免费使用。

# r - BatchJobs 代码未提交作业（可能）

> ID：15960812
> 
> 赞同：1
> 
> 时间：2013-04-11T23:49:01.967
> 
> 标签：r, parallel-processing, batch-processing, lsf

这是一些测试代码：

```
require(BatchJobs)

f = function(i) {Sys.sleep(60)}

reg <- makeRegistry(id="myreg")
batchMap(reg, f, 1:100)
submitJobs(reg, resources=list(memory=4*1024*1024, queue="normal_serial")) 
```

每个块似乎都需要永远，几乎就像在一台机器上完成一样......

```
submitJobs                |+                                 |   1% (01:39:00) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:20:16.640

我相信这已在邮件列表中解决。我在这里发布答案，以防其他人有这个问题：

需要加载`.BatchJobs.R`文件并拥有作业模板。我忘了从我的主目录中复制这些。这最终在本地执行。

# opengl - 如何使用着色器更改点的颜色

> ID：15960815
> 
> 赞同：1
> 
> 时间：2013-04-11T23:49:19.313
> 
> 标签：opengl, colors, shader, glut

我有一个应用程序，我在 GLUT 窗口上绘制了一堆点。我有一个顶点着色器和一个片段着色器，我给了一个颜色输入。我的顶点着色器看起来像：

```
#version 120
attribute vec2 position;

varying vec4 vColor;

void main()
{
   vColor = gl_Color;
   gl_Position = vec4( position, 0.0, 1.0 );
} 
```

我的碎片着色器看起来像：

```
#version 120

varying vec4 vColor;
void main()
{
    gl_FragColor = vColor;
} 
```

我希望用户能够根据按键更改点的颜色。所以，我有一些按键处理功能：

```
void handleKeyPress(unsigned char key, int x, int y)
{
    if (key == 'c')
       //todo: change the point colors to green
} 
```

我该如何做那个“待办事项”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T03:14:47.363

`glColor()`使用这些着色器，您可以在绘制之前发出 a ：

```
glColor3f( r, g, b );
// draw geometry 
```

`gl_Color`但是，如果您已经使用通用顶点属性作为位置，那么固定函数互操作预定义变量（在顶点着色器中）有点毫无意义。

在这种情况下，您可以[`glUniform()`](http://www.opengl.org/sdk/docs/man2/xhtml/glUniform.xml)改用：

```
#include <GL/glew.h>
#include <GL/glut.h>
#include <iostream>
#include <vector>
using namespace std;

// RAII vertex attribute wrapper
struct Attrib
{
    Attrib
        ( 
        const char* name, const GLint size, const GLsizei stride, const GLvoid* pointer, 
        const GLenum type = GL_FLOAT, const GLboolean normalized = GL_FALSE, const GLuint prog = GetProgram() 
        )
    {
        mLoc = glGetAttribLocation( prog, name );
        if( mLoc < 0 ) return;
        glVertexAttribPointer( mLoc, size, type, normalized, stride, pointer );
        glEnableVertexAttribArray( mLoc );
    }

    ~Attrib()
    {
        if( mLoc < 0 ) return;
        glDisableVertexAttribArray( mLoc );
    }

    GLint mLoc;

private:
    static GLuint GetProgram()
    {
        GLint program = 0;
        glGetIntegerv( GL_CURRENT_PROGRAM, &program );
        return program;
    }
};

// GLSL shader program loader
struct Program
{
    static GLuint Load( const char* vert, const char* geom, const char* frag )
    {
        GLuint prog = glCreateProgram();
        if( vert ) AttachShader( prog, GL_VERTEX_SHADER, vert );
        if( geom ) AttachShader( prog, GL_GEOMETRY_SHADER, geom );
        if( frag ) AttachShader( prog, GL_FRAGMENT_SHADER, frag );
        glLinkProgram( prog );
        CheckStatus( prog );
        return prog;
    }

private:
    static void CheckStatus( GLuint obj )
    {
        GLint status = GL_FALSE, len = 10;
        if( glIsShader(obj) )   glGetShaderiv( obj, GL_COMPILE_STATUS, &status );
        if( glIsProgram(obj) )  glGetProgramiv( obj, GL_LINK_STATUS, &status );
        if( status == GL_TRUE ) return;
        if( glIsShader(obj) )   glGetShaderiv( obj, GL_INFO_LOG_LENGTH, &len );
        if( glIsProgram(obj) )  glGetProgramiv( obj, GL_INFO_LOG_LENGTH, &len );
        std::vector< char > log( len, 'X' );
        if( glIsShader(obj) )   glGetShaderInfoLog( obj, len, NULL, &log[0] );
        if( glIsProgram(obj) )  glGetProgramInfoLog( obj, len, NULL, &log[0] );
        std::cerr << &log[0] << std::endl;
        exit( -1 );
    }

    static void AttachShader( GLuint program, GLenum type, const char* src )
    {
        GLuint shader = glCreateShader( type );
        glShaderSource( shader, 1, &src, NULL );
        glCompileShader( shader );
        CheckStatus( shader );
        glAttachShader( program, shader );
        glDeleteShader( shader );
    }
};

#define GLSL(version, shader) "#version " #version "\n" #shader

const char* vert = GLSL
(
    120,
    attribute vec2 position;
    void main()
    {
       gl_Position = vec4( position, 0.0, 1.0 );
    }    
);

const char* frag = GLSL
(
    120,
    uniform vec3 uColor;
    void main()
    {
        gl_FragColor = vec4( uColor, 1.0 );
    }    
);

float r = 1, g = 0, b = 0;
void keyboard( unsigned char key, int x, int y )
{
    if( key == 'c' )
    {
        r = 1 - r;
        g = 1 - g;
        b = 1 - b;
    }
}

void display()
{
    glClear(GL_COLOR_BUFFER_BIT);

    // prepare to render
    static GLuint prog = Program::Load( vert, NULL, frag );
    glUseProgram( prog );

    glUniform3f( glGetUniformLocation( prog, "uColor" ), r, g, b );

    float verts[] = {
        -1 / 2.0, -1 / 2.0,
         1 / 2.0, -1 / 2.0,
         1 / 2.0,  1 / 2.0,
        -1 / 2.0,  1 / 2.0,
    };

    {
        Attrib a1( "position", 2, 0, verts );
        glDrawArrays( GL_QUADS, 0, 4 );
    }

    glutSwapBuffers();
}

void timer( int extra )
{
    glutTimerFunc( 16, timer, 0 );
    glutPostRedisplay();
}

int main(int argc, char **argv)
{
    glutInit( &argc, argv );
    glutInitWindowSize( 600, 600 );
    glutInitDisplayMode( GLUT_RGBA | GLUT_DOUBLE );
    glutCreateWindow( "GLUT" );
    glewInit();

    glutKeyboardFunc( keyboard );
    glutDisplayFunc( display );
    glutTimerFunc( 0, timer, 0 );
    glutMainLoop();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T20:38:52.537

有一个名为[glVertexAttrib](http://www.opengl.org/sdk/docs/man/xhtml/glVertexAttrib.xml)的 OpenGL 函数，允许您将顶点属性设置为整个绘制调用的固定值，而不是从顶点缓冲区对象中获取每个顶点的值。与使用颜色指定统一变量相比，使用它的优势在于，您可以使用单独的每个顶点颜色渲染几何图形，也可以使用相同的顶点/片段着色器对渲染没有此类属性的几何图形。

# android - 简单的 Android 翻译应用程序不起作用

> ID：15960818
> 
> 赞同：0
> 
> 时间：2013-04-11T23:49:50.010
> 
> 标签：android

我为一个作业制作了一个简单的 Java CLI 程序，现在我正试图将它变成一个 Android 应用程序以获得乐趣/体验。但是，它不起作用......它是一个翻译应用程序，当我输入一个我知道在字典中的单词时，如果用户输入无效单词，它仍然会给我我输入的信息。我相信发生的事情是它没有正确读取字典文件，因为 Eclipse 的 LogCat 在运行时给我以下消息：“无法打开文件进行读取。”

```
public class MainActivity extends Activity {
TreeMap<String, String> tree = new TreeMap<String, String>();
public final static String EXTRA_MESSAGE = "";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Scanner dictinput = null;
 try{
     getAssets().open("dict.txt");
    dictinput = new Scanner(getAssets().open("dict.txt"));
 }
 catch (Exception e) {
        System.err.println("Could not open file");
        System.exit(-1);            

 }//Puts the dictionary in a stringbuffer
 StringBuffer dict = new StringBuffer();
 String[] arrtemp = new String[1600];
 while(dictinput.hasNext()) {
     dict.append(dictinput.nextLine());
     dict.append("|");

 }//Then puts it in a string so it can be split at the |'s using .split
 String strstr = dict.toString();
 arrtemp = strstr.split("\\|");

 //puts the dictionary into a treemap
 for(int i=0; i<arrtemp.length-1; i++) {
     if(i==0)
         tree.put(arrtemp[i].toLowerCase(), arrtemp[i+1]);
     else {
         i++;
         tree.put(arrtemp[i].toLowerCase(), arrtemp[i+1]);
     }

 }
}

public void sendMessage(View view) {
    Intent intent = new Intent(this, DisplayMessageActivity.class);

    EditText editText = (EditText) findViewById(R.id.editmessage);//The only way I've         found to get the text from the user.
    String temp = editText.toString();
    Scanner scan = new Scanner(temp);
    String finalmessage = null;
    while(scan.hasNext()){

     String temp1 = scan.next();
     if (tree.containsKey(temp1.toLowerCase()))
        finalmessage = temp;
     else
         finalmessage = "No match found, try another word or phrase";
 }

    intent.putExtra(EXTRA_MESSAGE, finalmessage);
    startActivity(intent);
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:54:53.113

你的文本文件在哪里？我想问题可能是它没有保存在您的项目文件夹中的 /res/raw 下，之后您可以使用如下输入流：

```
 InputStream is = this.getResources().openRawResource(
            R.raw.textfilename);
    try{
        BufferedReader reader = new BufferedReader(new InputStreamReader(is));
        while(blah){
           do stuff
        }
    }
    catch(Exception e){
        handle errors
    } 
```

# java - 尝试诊断 NullPointerException

> ID：15960820
> 
> 赞同：0
> 
> 时间：2013-04-11T23:50:03.120
> 
> 标签：java, nullpointerexception

我正在为一门课程编写代码。我们的目的是从用户指定的文件中扫描行，在每一行中搜索用户指定的一个或多个单词，并报告在整个文件中（逐行处理）这些单词出现的次数。我们分了三门课，打算写第四门课。我的代码在第 12 行抛出 NullPointerException，我不知道为什么。据我所见，我已经声明并初始化了该行中涉及的变量。我的代码是：

```
import java.io.IOException;
import java.util.*;

public class WordFreq extends Echo{
  String[] searchWordsAsStrings;
  WordCount[] searchWords;

  public WordFreq(String f, String w) throws IOException{
    super(f);
    searchWordsAsStrings = w.split(" ");
    for(int a = 0; a < searchWordsAsStrings.length; a++){
      searchWords[a] = new WordCount("");
    }
    for(int a = 0; a < searchWordsAsStrings.length; a++){
      searchWords[a].setWord(searchWordsAsStrings[a]);
    }
  }

  public void processLine(String line){
    StringTokenizer st = new StringTokenizer(line);
    while(st.hasMoreTokens()){
      for(int a = 0; a < searchWords.length; a++){
        if(searchWords[a].getWord() == st.nextToken()){
          searchWords[a].incCount();
        }
      }  
    }
  }

  public void reportFrequencies(){
    System.out.println("Word counts:");
    for(int a = 0; a < searchWords.length; a++){
      System.out.println(searchWords[a].toString());
    }
  }
} 
```

堆栈跟踪：

```
java.lang.NullPointerException
    at WordFreq.<init>(WordFreq.java:12)
    at FreqStudy.main(FreqStudy.java:20)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at edu.rice.cs.drjava.model.compiler.JavacCompiler.runCommand(JavacCompiler.java:272) 
```

该应用程序的主要类如下。为了诊断问题，我已经注释掉了给定的代码并提供了我自己的代码。

```
import java.util.*;
import java.io.*;

public class FreqStudy{
  public static void main(String[] args) throws IOException
  {
    /*
    Scanner scan = new Scanner(System.in);
    System.out.println("enter file name");
    String fileName = scan.next();
    */
    String fileName = "pg37997.txt";
    /*
    Scanner scan2 = new Scanner(System.in);
    System.out.println("enter words to search for");
    System.out.println("enter lower case, separated by spaces");
    String wordString = scan2.nextLine();
    */
    String wordString = "cow horse chicken goat pig";
    WordFreq f = new WordFreq(fileName,wordString);
    f.readLines();
    f.reportFrequencies();
  }
} 
```

此应用程序还使用 Echo 和 WordCount 类，如下所示：

```
import java.util.Scanner;
import java.io.*;

public class Echo{
  String fileName; // external file name
  Scanner scan; // Scanner object for reading from external file

  public Echo(String f) throws IOException
  {
    fileName = f;
    scan = new Scanner(new FileReader(fileName));
  }

  public void readLines(){ // reads lines, hands each to processLine
    while(scan.hasNext()){
      processLine(scan.nextLine());
    }
    scan.close();
  }

  public void processLine(String line){ // does the real processing work
    System.out.println(line);
  }
}

public class WordCount{

  private String word;
  private int count;

  public WordCount(String w){
    word = w;
    count = 0;
  }

  public String getWord(){
    return word;}

  public void setWord(String w){
    word = w;
  }

   public int getCount(){
    return count;}

  public void incCount(){count++;}

  public String toString() {
    return(word +  " --- " + count);
  }

  public boolean equals(Object other){
    WordCount i = (WordCount)other;
    return (this.word.equals(i.word));
  }
} 
```

我确实无法追踪异常的来源。我已经阅读了生成它的原因（本网站上有许多解释），但我无法诊断出我的实际代码中引发异常的原因。

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T23:54:49.423

Your issue is because of an improperly initialised array!

```
WordCount[] searchWords; 
```

But you never declare `searchWords = new WordCount[dimension];`

When you attempt to reference this array, you're trying to access something that doesn't exist. Because `WordCount[]` is an object in, and of, itself, it is throwing a `NullPointerException` because it does not yet reference a `WordCount[]` object.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T23:54:59.453

Your `WordCount[] searchWords;` array never gets initialized.

Add a `searchWords = new WorkCount[searchWorkdsAsStrings.length];` under `searchWordsAsStrings = w.split(" ");`

**EDIT**

To answer your question from comment below, the st.nextToken() advances the token and this is what is throwing your NoSuchElementException. Instead of doing that inside your for loop, read the st.nextToken() into a variable and then do your == comparison.

```
while(st.hasMoreTokens()){
        String s = st.nextToken();
      for(int a = 0; a < searchWords.length; a++){
        if(searchWords[a].getWord().equals(s)){
          searchWords[a].incCount();
        }   
      } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T23:56:25.490

看来您正试图在初始化之前将对象分配给 searchWords 数组（除非这是在超类中完成的）。确保你像初始化数组一样

```
WordCount[] wordArray = new WordCount[10]; 
```

或者

```
WordCount[] wordArray = new WordCount[]{new WordCount()}; 
```

# .net - 访问 DirectoryServices 属性时出现错误 8000500c

> ID：15960823
> 
> 赞同：1
> 
> 时间：2013-04-11T23:50:17.157
> 
> 标签：.net, properties, directoryservices

我是第一次发帖，希望有人能帮我解决这个问题。

我有一些代码对 LDAP 服务器（我相信它是 Novell eDirectory）进行身份验证，然后检索某些属性。此代码在 Windows 2003、Windows 2008 和 Windows 7 上运行良好，但是当我在 Windows 2012 服务器上运行它（访问相同的 LDAP 存储）时，它会失败并在访问属性值时抛出错误 8000500c。有趣的是，访问一些其他属性（如 cn）工作正常，只是一些属性（如 groupMembership）失败

这是一个代码示例：

```
string ldapurl = "LDAP://<server>:389/cn=<user id>,ou=<ou value 1>,ou=<ou value 2>,ou=<ou value 3>,o=users";

DirectoryEntry oDirectoryEntry = new DirectoryEntry(ldapurl);
oDirectoryEntry.Username = <user id>;
oDirectoryEntry.Password = <password>;

// I have tried a few different Authentication Types 
oDirectoryEntry.AuthenticationType = AuthenticationTypes.FastBind;

DirectorySearcher oDirectorySearcher = new DirectorySearcher(oDirectoryEntry); 
oDirectorySearcher.PropertiesToLoad.Add("groupMembership");

// This works
SearchResult oSearchResult = oDirectorySearcher.FindOne();

// This is where it throws the error
string sType = oDirectoryEntry.Properties["groupMembership"].Value.ToString(); 
```

有谁知道我在这里哪里出错了？同样，它在安装了 .Net 3.5 和 .Net 4.5 SP1 的 Windows 2003、Windows 2008 和 Windows 7 上运行良好。它似乎只是 Windows 2012 的问题。

# javascript - 如何在 Phonegap 中发布表格？

> ID：15960826
> 
> 赞同：0
> 
> 时间：2013-04-11T23:50:30.763
> 
> 标签：javascript, android, ios, cordova

我正在尝试 Phonegap 并在 html 中有一个非常简单的应用程序。

```
<!DOCTYPE html>
<html>
    <title>&nbsp;</title>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    </head>
    <body>
        <div data-role="page" id="page1">
            <div data-role="header">
                <h1>Trying out Phonegap</h1>
            </div>
            <div data-role="content">
                <h3>Sign in here</h3>
                <form>
                    Username
                    <input type='text' name='username'>
                    Password
                    <input type='text' name='password'>
                    <input type='submit' name='submit' value='Login'>
                </form>
            </div>
        </div>
    </body>
</html> 
```

但我不知道如何处理表单提交。我应该直接发布到外部 url api.myserver.com/signin 还是应该使用 JQuery 将字段发布到 API，然后根据响应更改为另一个视图？任何注释或代码片段都会非常有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:09:38.300

当提交事件触发时，您应该使用 javascript/jQuery 检索表单中输入的值，然后使用 ajax 将值发送到远程服务器并等待响应。

根据响应，您可以按照自己喜欢的方式进行；显示对话框、更改页面等。

# .htaccess - Not allowing access to error page via URL using mod_rewrite

> ID：15960834
> 
> 赞同：0
> 
> 时间：2013-04-11T23:51:19.300
> 
> 标签：.htaccess, mod-rewrite, custom-error-pages

I have my custom error page at `/errors/404.php` and I would like that to be able to be used when apache can't find a file, but I would like it not able to be used by simply requesting the URL `http://mywebsite/error/404.php`.

I currently have a rule that blocks access to all of my php files (because I use URL rewriting to make user-friendly URLs) but this seems to also be stopping apache from reading the error page due to the error page matching the rule to deny access to php files.

How would I do this properly?

The contents of `/.htaccess`:

```
RewriteEngine On
RewriteRule ^home/?$       /index.php   [NC,L]
RewriteRule ^lessons/?$    /lessons.php [NC,L]

# Don't allow access to the actual php files.
RewriteCond %{THE_REQUEST} \.php[\ /?].*HTTP/ [NC]
RewriteRule ^.*$           -                  [R=404,L]

ErrorDocument 404 /errors/404.php 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:51:10.353

你可以试试这个：

```
# Don't allow access to the actual php files.
RewriteCond %{THE_REQUEST} \.php[\ /?].*HTTP/  [NC]
RewriteCond %{REQUEST_URI}  !/errors/404\.php  [NC]
RewriteRule ^.*$  -        [R=404,L]

RewriteCond %{THE_REQUEST} \s/errors/404\.php [NC]
RewriteRule .?  -  [F]

ErrorDocument 404 /errors/404.php 
```

1.  所有对文件的请求`.php`都被重定向到`/errors/404.php`脚本。
2.  对不存在的文件或目录的所有请求都被重定向到`/errors/404.php`脚本（该`ErrorDocument 404 /errors/404.php`指令适用于这种情况）。
3.  `/errors/404.php`返回 403 Forbidden 状态代码的所有直接请求。

# iphone - 将运行时详细信息发送到 HTML 文件，以便从 iPhone 的应用内电子邮件发送

> ID：15960840
> 
> 赞同：0
> 
> 时间：2013-04-11T23:52:36.850
> 
> 标签：iphone, ios, objective-c, mfmailcomposer

我从 iPhone 应用程序中发送 HTML 格式的电子邮件。我正在阅读存储在应用程序包中的 HTML 文件。

现在，我想更改 HTML 文件中的某些文本，即姓名、电子邮件和电话会根据用户在应用程序中的某些选择而改变。

如何将这些不同的参数添加到 HTML 文件内容中？

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T01:04:25.407

这样的事情可能对你有用：

```
NSString *htmlPath = [[NSBundle mainBundle] pathForResource:@"yourHtml" ofType:@"html"];

NSError *error = nil;

NSString *inputHtml = [[NSString alloc] initWithContentsOfFile:htmlPath encoding:NSUTF8StringEncoding error:&error];

NSString *nameParsedHtml = [inputHtml stringByReplacingOccurrencesOfString:@"Name:" withString:[NSString stringWithFormat:@"Name: %@", self.nameField.text]];

NSString *emailParsedHtml = [nameParsedHtml stringByReplacingOccurrencesOfString:@"Email:" withString:[NSString stringWithFormat:@"Email: %@", self.emailField.text]];

NSString *outputHtml = [emailParsedHtml stringByReplacingOccurrencesOfString:@"Phone:" withString:[NSString stringWithFormat:@"Phone: %@", self.phoneField.text]];

NSLog(@"Output html string is: %@", outputHtml); 
```

# sharepoint - 每个问题的多个抄送地址

> ID：15960846
> 
> 赞同：0
> 
> 时间：2013-04-11T23:53:16.693
> 
> 标签：sharepoint

我习惯了 Bugzilla，您可以在其中为每个 bug 添加/删除其他人到 cc 列表，以便在修改 bug 时通知他们。

我现在必须使用 Sharepoint 的问题跟踪器，我已经可以在其中设置警报以在问题发生任何更改时获得通知，但我想知道是否有任何方法可以为**其他人**创建此类警报，尤其是为**多人**.

此[页面](http://www.naumanahmed.com/2012/01/sharepoint-issue-tracking-list-send-e.html)说明如何设置问题跟踪列表，以便在将问题分配给受让人时向受让人发送电子邮件通知，但 sharepoint 只允许一个受让人。

一种方法是让人们访问共享点并为自己创建警报，这对我来说并不实际。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T13:40:14.903

如果您是站点管理员，您可以通过转到站点设置 > 站点管理 > 用户警报来做您想做的事情。这是一篇说明如何在[MOSS](http://www.coolweblog.com/bilodeau/archives/003249.html)中执行此操作的文章，因此我相信您在 2010 年也可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T13:47:40.283

您可以创建人员选择器字段（只有一个人），然后创建一个工作流，将此字段用作抄送。之后，返回列表设置并更改人员选择器字段以接受多个人员，它应该可以工作。

# python - parent child class animals zoo

> ID：15960848
> 
> 赞同：1
> 
> 时间：2013-04-11T23:53:19.920
> 
> 标签：python, oop, class, inheritance

This is a class design question in python.

I am trying to design three classes, one for animal, one for zoo, one for chicken farm.

```
class Animal:
    pass

class Zoo:

    def __init__(self, listOfAnimals)

    .....

class chickenFarm(Zoo):
   .... 
```

Note ChickenFarm is a child of Zoo and uses many of the zoo methods. Additionally, the chicken farm has its unique methods related only to chicken.

My question is, how the zoo class (or object) mutates into a chickenFarm object once all the animals in the zoo are found to be chicken? (Obviously the zoo class has methods that can add or remove animals)

in other words:

```
z=Zoo()

z.addAnimals()

z.removeanimals()

if z.testAllCkichen(): 
```

z now mutates into a chickenFarm objects

```
z.layEggs() 
```

or maybe:

```
c=checkenFarm(z) # (when z now contains all chicken)

c.layEggs(0) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T00:03:57.803

这是您如何实现的开始，`chickenFarm.__init__`以便当它获取一个`Zoo`实例作为其第一个参数时，它将创建一个`chickenFarm`其属性从`Zoo`实例复制的：

```
class chickenFarm(Zoo):
    def __init__(self, *args, **kwargs):
        if args and isinstance(args[0], Zoo):
            zoo = args[0]
            # copy all Zoo data from zoo to self
            # for example self.animals = zoo.animals.copy()
        else:
            Zoo.__init__(self, *args, **kwargs) 
```

然后你可以像这样使用它：

```
z = Zoo()
# do some stuff
if z.testAllChicken():
    c = chickenFarm(z)
    c.layEggs() 
```

# linux - Bash for 循环不能正确理解变量？

> ID：15960852
> 
> 赞同：0
> 
> 时间：2013-04-11T23:53:34.807
> 
> 标签：linux, bash

如何增加已在 bash 中定义的变量？这就是我的意思：

```
ID1="YAY1"
ID2="YAY2"
for (( c=1; c<=3; c++ ))
  do
    if [ "$SOMEOTHERVAR" = "ID$c" ]; then BLAH; fi
  done 
```

问题是，当它增加已经定义的变量进行比较时，它认为 ID$c 等于字符串 ID1，而不是 ID1 等于 YAY1，因此 if 语句总是评估为 false。我希望这是有道理的。

谢谢您的帮助！

****** *** ******更新****** ** *** ******

 **感谢大家的帮助。最干净的解决方案是使用与切割混合的单个阵列。可能不是最干净的方式，但效果很好。下面是一个片段：

```
# CONTACTS
declare -a EMAIL
EMAIL[1]="JS:jsmith@example.com"
EMAIL[2]="JD:jdoe@example.com"
EMAIL[3]="JK:jkennedy@example.com"

# FUNCTIONS
function EMAIL {
  for i in "${!EMAIL[@]}"; do
    POINTER="`echo ${EMAIL[$i]} | cut -d":" -f1`"; ADDRESS="`echo ${EMAIL[$i]} | cut -d":" -f2`";
    if [ "$POINTER" = "$PEMAIL" ]; then TO="$ADDRESS"; fi
    if [ "$POINTER" = "$SEMAIL" ]; then CC="$ADDRESS"; fi
  done
} 
```

PEMAIL 和 SEMAIL 是在脚本的另一部分从数据库中提取的比较器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:03:50.107

创建一个构建变量名称的中间变量（我称之为 newVar）。然后取消引用。以下代码将打印“匹配索引 2”

```
ID1="YAY1"
ID2="YAY2"
for (( c=1; c<=3; c++ ))
  do
    newVar="ID${c}"
    if [ "YAY2" = "${!newVar}" ]; then echo "match for index $c"; fi
  done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T00:00:45.713

在您的示例中，使用数组才有意义，因为变量的最后一部分无论如何都是整数：

```
declare -a ids
ids[1]="YAY1"
ids[2]="YAY2"
for (( c=1; c < 3; c++ )); do
    if [ "$SOMEOTHERVAR" = "${ids[c]}" ]; then
        BLAH
    fi
done 
```

如果它不总是整数，并且您有 bash 4，则可以使用关联数组：

```
declare -A ids
ids['glow']="YAY1"
ids['stix']="YAY2"
for c in glow stix; do
    if [ "$SOMEOTHERVAR" = "${ids[c]}" ]; then
        BLAH
    fi
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T08:34:17.057

没有 C 风格循环的解决方案：

```
ID1="YAY1"
ID2="YAY2"

for name in ${!ID*}; do
  if [ "$SOMEOTHERVAR" == "${!name}" ]; then echo "match for $name"; fi
done 
```

${!ID*} 扩展为前缀为“ID”的所有变量的列表。**

# node.js - ExpressJS 上传许多文件而没有 EMFILE 错误

> ID：15960854
> 
> 赞同：0
> 
> 时间：2013-04-11T23:53:44.270
> 
> 标签：node.js, express

我需要使用 ExpressJS 处理多个文件上传，但我不知道客户端上传的文件数量。

当我尝试上传超过 244 个文件时，服务器崩溃。在上传表单和uploadHandle 操作之间的上传期间抛出错误。（文件并没有全部复制到我的 /public/upload 文件夹，只有 244 先）

增加**ulimit**限制似乎有点脏，因为即使我将其设置为 10000，如果有人尝试上传更多文件，我的服务器也会崩溃。

有没有一种干净的方法来处理它？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T02:40:10.543

一次不创建那么多文件感觉像是正确的方法。您可以通过多种方式处理此问题，例如，如果您不必支持旧版浏览器，则使用[HTML5 File Api在浏览器中对它们进行排队。](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

您还可以在接收到文件时在服务器端流式传输文件，这样您就不会创建打开的文件指针并将它们缓冲到内存中。如果您需要打开所有这些文件并以某种方式处理它们，那么按照建议，[node-graceful-fs](https://github.com/isaacs/node-graceful-fs)可以在该领域提供帮助。

# templates - RE: Inserting a variable argument into a Silverstripe template's function?

> ID：15960856
> 
> 赞同：1
> 
> 时间：2013-04-11T23:53:49.793
> 
> 标签：templates, silverstripe

[Inserting a variable argument into a Silverstripe template's function?](https://stackoverflow.com/questions/9314481/inserting-a-variable-argument-into-a-silverstripe-templates-function/9489612)

I am trying to pass a variable to a template control function. Is the above answer still current for SS3? Or is there a better way of doing it now?

Thanks, Rob

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T08:37:41.700

在 silverstripe 3 中可以将动态值传递给模板中的函数调用。尝试以下操作：

**页面类：**

```
public function testfunc($myval) {
    return 'value is '.$myval;
}

public function testval() {
    return 'foobar';
} 
```

**页面模板：**

```
$testfunc($testval) 
```

这将按预期在您的模板中输出“foobar”。

请注意，该`control`指令在 ss3 中已弃用，请使用`loop`or`with`代替（请参阅[http://doc.silverstripe.org/framework/en/reference/templates](http://doc.silverstripe.org/framework/en/reference/templates)）

# java - 在 Java 中从外部访问超类

> ID：15960863
> 
> 赞同：0
> 
> 时间：2013-04-11T23:54:36.013
> 
> 标签：java, oop

我想知道是否可以在派生类之外显式访问 Java 中的超类方法。以下 C++ 代码说明了这一点：

```
#include <iostream>
using namespace std;

class A {
  public:
    virtual void f( ) {
      cout << "A\n";
    }
};

class B : public A {
  public:
    void f( ) {
      cout << "B\n";
    }
};

int main( ) {
  B b;
  b.A::f( );
  return 0;
} 
```

此代码输出“A”，因为它显式调用了 f 的 A 版本。

我知道这是可怕的设计，并且完全破坏了封装，但这在 Java 中可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:57:44.350

不，没有办法直接做到这一点，但是，您可以在 b 中编写一个函数来调用 a 的 f()。

```
class a {
    public void f() {
        System.out.println("hi");
    }
}

class b extends a {
    public void f() {
        System.out.println("hi2");
    }

    public void f2() {
        super.f();
    }
} 
```

请注意，您不能`f()`从访问 a `b`，但是，`f2()`调用`super.f()`; 换句话说，从 b 中调用超类 a。

`super`是超类调用，虽然它不能从外部调用，但您可以将类设计为能够在内部调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:09:05.743

你不能在java中做到这一点。当您在 C++ 中执行此操作时，您知道自己在做什么，所以这不是问题。Java 实际上允许通过反射 API 访问私有方法和字段。

# c# - 如何获取目录列表，如 Windows 资源管理器

> ID：15960868
> 
> 赞同：0
> 
> 时间：2013-04-11T23:55:10.407
> 
> 标签：c#, treeview

我正在构建一个树视图控件，并希望从 Windows 资源管理器显示之类的列表开始：

我的文档 我的电脑 - （展开一级） bob(C:) recovery(D:) DVD (E:)

我的网络位置...等等，您如何从目录信息中获取此类信息？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T01:34:01.187

Explorer 显示特殊文件夹以及逻辑驱动器。

使用[Directory.GetLogicalDrives 方法获取的逻辑驱动器](http://msdn.microsoft.com/en-us/library/system.io.directory.getlogicaldrives.aspx)

可以使用[Environment.GetFolderPath 方法将 Slecial 文件夹“映射”到实际路径](http://msdn.microsoft.com/en-us/library/14tx8hby.aspx)

获得所有“根节点”的位置后，您可以使用[Directory.GetDirectories 方法](http://msdn.microsoft.com/en-us/library/c1sez4sc.aspx)或[DirectoryInfo.GetDirectories 方法枚举它们的“目录”](http://msdn.microsoft.com/en-us/library/s7xk2b58.aspx)

# c++ - 链接时奇怪的未定义引用

> ID：15960874
> 
> 赞同：5
> 
> 时间：2013-04-11T23:55:34.287
> 
> 标签：c++, inheritance, linker-errors

我在下面几行代码中重现了我在一个更大的项目中所经历的行为。为了提高可读性，我省略了`#ifndef`守卫和指令。`#include`调用时会产生链接器错误`make`。makefile 包含在问题的末尾。

C类继承自B，B继承自A。O是一个完全不同的类。

链接器抱怨：

```
g++ -o main main.cpp -L. -lABC -lO
./libO.a(O.o): In function `O::foo(A)':
O.cpp:(.text+0x1f): undefined reference to `C::C(A const&)' 
```

这是源代码。我试图让它尽可能小和可读。知道有什么问题吗？

```
/***** A.h *****/
class A
{
    public:
    A();
    A(const A& a);
};

/***** A.cpp *****/
A::A() {}
A::A(const A& a) {}

/****** BC.h *******/
class B : public A
{
    public:
    B(const A& a);
};

class C :  public B 
{
    public:
    C(const A& a);
};

/******* BC.cpp ********/
B::B(const A& a) : A(a) {}
C::C(const A& a) : B(a) {}

/***** O.h *****/
class O
{
    public:
    void foo(A a);
};

/***** O.cpp *****/
void O::foo(A a)
{
    C c(a);
} 
```

这是主要的：

```
/******* main.cpp *******/
int main()
{
    A a;
    O o;
    o.foo(a);
    return 0;
} 
```

这是生成文件：

```
%.o: %.cpp %.h
    g++ -c $<

.PHONY: all
all: mklibs main

main: main.cpp
    g++ -o $@ main.cpp -L. -lABC -lO

mklibs: libABC.a libO.a

libABC.a: A.o BC.o
    ar -r $@ $^

libO.a: O.o
    ar -r $@ $^ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T00:03:32.730

有时链接顺序可能很重要，请尝试`-lO -lABC`

# c++ - 未定义对“base_rec::showme()”的引用错误

> ID：15960875
> 
> 赞同：1
> 
> 时间：2013-04-11T23:55:42.997
> 
> 标签：c++, undefined-reference

所以我正在为班级做一个调试作业。我们不允许进行任何严重的代码更改。我的代码是：

```
#include <string>
#include <iostream>
#include <sstream>

class base_rec
{public:
  base_rec (std::string contentstr):str(contentstr){};
  void showme();
  std::string str;};

class u_rec:public base_rec
{public:
  u_rec():base_rec("undergraduate records"){};
  void showme()
  {std::cout<<"showme() function of u_rec class\t" <<str<<std::endl;};};

class g_rec:public base_rec
{public:
  g_rec():base_rec("graduate records"){};
  void showme()
  {std::cout << "showme() function of a g_rec class\t"<<str<<std::endl;};};

  int main()
  { base_rec *brp[2];
    brp[1] = new u_rec;
    brp[2] = new g_rec;

    for (int i=0;i<1;i++)
      {brp[i]->showme ();}

    return 0;
} 
```

但是，每当我尝试编译它时，都会收到错误消息：

> /tmp/ccFm7Xvz.o：在函数`main': quiz2.cpp:(.text+0x54): undefined reference to`base_rec::showme()' collect2：错误：ld 返回 1 退出状态

我不完全确定这里有什么问题。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:13:36.767

首先：

```
brp[2] = new g_rec; 
```

将超出范围，因为数组索引从`0`

其次：

`showme`is 里面没有定义`base_rec`。如果你真的想调用派生类方法，你需要将它声明为虚拟的。

第三，您的代码中有几个语法错误：

```
 u_rec():base_rec("undergraduate records"){}; //redundant ;
 void showme()
 {std::cout<<"showme() function of u_rec class\t" <<str<<std::endl;};
                                                     //redundant ; again
 //You can find several others. 
```

您可以执行以下操作：

```
#include <string>
#include <iostream>
#include <sstream>

class base_rec
{
  public:
     base_rec (std::string contentstr):str(contentstr){}
     void showme(){ std::cout << "base class showme";}
     std::string str;
};

class u_rec: public base_rec
{
public:
    u_rec():base_rec("undergraduate records"){}
    void showme()
   {
      std::cout<<"showme() function of u_rec class\t" <<str<<std::endl;
   }
};

class g_rec:public base_rec
{
  public:
   g_rec():base_rec("graduate records"){};
     void showme()
     {
        std::cout << "showme() function of a g_rec class\t"<<str<<std::endl;
     }
};

int main()
{ 
    base_rec *brp[2];
    brp[0] = new u_rec;
    brp[1] = new g_rec;  //index starting from 0

   for (int i=0;i<1;i++)
   {
      brp[i]->showme ();
   }

   return 0;
} 
```

如果你真的想看看多态是如何工作的，你需要在类中声明`showme`as 。然后当你通过基类指针调用它时，它会向你展示多态行为。例如：`virtual``base_rec`

```
 class base_rec
 {
  public:
     base_rec (std::string contentstr):str(contentstr){}
     virtual void showme(){ std::cout << "base class showme";}
     std::string str;
 }; 
```

# python - Django URL：将 OSQA URL 中的默认“/questions/”更改为其他内容

> ID：15960876
> 
> 赞同：0
> 
> 时间：2013-04-11T23:55:54.057
> 
> 标签：python, django, osqa

我正在尝试修改[OSQA](https://github.com/OSQA/osqa)使其不在URL 中的`/questions` *任何位置*使用，并将其更改为其他字符串，例如`/thisinstead`.

## 一些例子

当用户单击问题选项卡时`mydomain.com/questions/`，它应该链接到 ，而不是链接到`mydomain.com/somethingelse/`。

同样，`mydomain.com/questions/3/Q3Title/`它应该链接到，而不是`mydomain.com/somethingelse/3/Q3Title/`。

等等。

实现这一目标的最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T00:37:57.813

我快速浏览了 OSQA 源代码，所有的 url 都被翻译了。因此，您只需修改[https://github.com/OSQA/osqa/blob/master/locale/en/LC_MESSAGES/django.po](https://github.com/OSQA/osqa/blob/master/locale/en/LC_MESSAGES/django.po)第 398 行，运行`django-admin compilemessages`并完成。

有关自定义的更多信息，请查看[https://github.com/OSQA/osqa/blob/master/INSTALL中的 D 部分](https://github.com/OSQA/osqa/blob/master/INSTALL)

# api - 确定某人查看您的个人资料的确切时间/日期

> ID：15960878
> 
> 赞同：0
> 
> 时间：2013-04-11T23:56:03.340
> 
> 标签：api, rest, linkedin

是否可以确定某人查看您在 LinkedIn 上的个人资料的确切时间/日期？目前您收到一条通知说“XYZ 查看了您的个人资料”，这似乎是在过去 24 小时内，但可以准确地说出什么时候吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T16:05:01.213

我联系了 LinkedIn 支持，他们说目前不可能。

# python - 如何用互斥锁装饰 Python 对象

> ID：15960881
> 
> 赞同：6
> 
> 时间：2013-04-11T23:56:34.270
> 
> 标签：python, locking, wrapper

我是 python 新手，目前正在尝试学习线程。我厌倦了使用锁来使我的资源成为线程安全的，因为它们本身并不与资源绑定，所以每次我的代码与资源交互时，我一定会忘记获取和/或释放它们。相反，我希望能够“包装”（或装饰？）一个对象，以便它的所有方法和属性 getter/setter 都是原子的。像这样的东西：

```
state = atomicObject(dict())

# the following is atomic/thread-safe
state["some key"] = "some value" 
```

这可能吗？如果是这样，实施它的“最佳实践”方式是什么？

编辑：[如何使内置容器（集合、字典、列表）线程安全？](https://stackoverflow.com/questions/13610654/how-to-make-built-in-containers-sets-dicts-lists-thread-safe). 然而; 正如 abarnert 和 jsbueno 都证明的那样，我提出的解决方案（自动化锁）通常不是一个好主意，因为确定原子操作的适当粒度需要一些智能，并且可能很难（或不可能）正确地自动化。

问题仍然存在，锁没有以任何方式绑定到它们要保护的资源，所以我的新问题是：**将锁与对象关联的好方法是什么？**

提议的解决方案#2：我想可能有一种方法可以将锁绑定到一个对象，这样在不首先获取锁的情况下尝试访问该对象会引发错误，但我可以看到这会变得多么棘手。

编辑：以下代码与问题不太相关。我发布它是为了证明我曾尝试自己解决问题，但在发布此问题之前迷路了。

作为记录，我编写了以下代码，但它不起作用：

```
import threading    
import types
import inspect

class atomicObject(object):

    def __init__(self, obj):
        self.lock = threading.RLock()
        self.obj = obj

        # keep track of function handles for lambda functions that will be created
        self.funcs = []

        # loop through all the attributes of the passed in object
        # and create wrapped versions of each attribute
        for name in dir(self.obj):
            value = getattr(self.obj, name)
            if inspect.ismethod(value):
                # this is where things get really ugly as i try to work around the
                # limitations of lambda functions and use eval()... I'm not proud of this code
                eval("self.funcs.append(lambda self, *args, **kwargs: self.obj." + name + "(*args, **kwargs))")
                fidx = str(len(self.funcs) - 1)
                eval("self." + name + " = types.MethodType(lambda self, *args, **kwargs: self.atomize(" + fidx + ", *args, **kwargs), self)")

    def atomize(self, fidx, *args, **kwargs):
        with self.lock:
            return self.functions[fidx](*args, **kwargs) 
```

我可以创建一个 atomicObject(dict())，但是当我尝试向对象添加一个值时，我得到了错误；“atomicObject 不支持项目分配”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T00:29:36.837

从您的非运行示例和乱七八糟的代码中很难分辨`eval`，但至少有一个明显的错误。

在您的交互式解释器中试试这个：

```
>>> d = dict()
>>> inspect.ismethod(d.__setitem__) 
```

正如[文档](http://docs.python.org/2/library/inspect.html#inspect.ismethod)所说，`ismethod`：

> 如果对象是用 Python 编写的绑定方法，则返回 true。

用 C（或 .NET、Java、下一个工作区等其他 Python 实现）编写的方法包装器不是用 Python 编写的绑定方法。

你可能只是想要`callable`或`inspect.isroutine`在这里。

我不能说这是否是唯一的问题，因为如果我修复语法错误和名称错误以及这个错误，第二`eval`行会生成如下非法代码：

```
self.__cmp__ = types.MethodType(lambda self, *args, **kwargs: self.atomize(0, *args, **kwargs) self) 
```

......我不确定你想在那里做什么。

* * *

你真的不应该试图创造和`eval`任何东西。要按名称动态分配属性，请使用[`setattr`](http://docs.python.org/2/library/functions.html#setattr). 而且你不需要复杂`lambda`的 s。只需用普通定义包装函数`def`；结果是一个非常好的本地值，您可以传递它，就像 a 一样，`lambda`只是它有一个名称。

最重要的是，尝试在创建时静态包装方法很困难，并且有一些主要缺点。（例如，如果您要包装的类有任何动态生成的方法，则不会包装它们。）大多数时候，最好在调用时动态地使用[`__getattr__`](http://docs.python.org/2/reference/datamodel.html#object.__getattr__). （如果您担心每次调用它们时创建包装器函数的成本……首先，除非您真正分析并发现它是一个瓶颈，否则不要担心，因为它可能不会。但是，如果它是，您可以轻松添加生成函数的缓存。）

因此，这是我认为您正在尝试做的更简单且有效的实现：

```
class atomicObject(object):

    def __init__(self, obj):
        self.lock = threading.Lock()
        self.obj = obj

    def __getattr__(self, name):
        attr = getattr(self.obj, name)
        print(attr)
        if callable(attr):
            def atomized(*args, **kwargs):
                with self.lock:
                    attr(*args, **kwargs)
            return atomized
        return attr 
```

但是，这实际上不会做你想做的事。例如：

```
>>> d = atomicObject(dict())
>>> d.update({'a': 4}) # works
>>> d['b'] = 5
TypeError: 'atomicObject' object does not support item assignment 
```

为什么会这样？你有一个`__setitem__`，它的工作原理：

```
>>> d.__setitem__
<method-wrapper '__setitem__' of dict object at 0x100706830>
>>> d.__setitem__('b', 5) # works 
```

问题是，正如[文档所暗示的那样，](http://docs.python.org/2/reference/datamodel.html#special-method-names)*在 class 上*查找特殊方法，而不是在 object 上。而且这个`atomicObject`类没有`__setitem__`方法。

事实上，这意味着您甚至无法有效地打印出您的对象，因为您只是获得了默认值`__str__`和`__repr__`from `object`：

```
>>> d
<__main__.atomicObject object at 0x100714690>
>>> print(d)
<__main__.atomicObject object at 0x100714690>
>>> d.obj #cheating
{'a': 4, 'b': 5} 
```

* * *

因此，正确的做法是编写一个函数，为任何类定义一个包装类，然后执行以下操作：

```
>>> AtomicDict = make_atomic_wrapper(dict)
>>> d = AtomicDict() 
```

* * *

但是，即使你做了所有这些......这很少像听起来那么好。

考虑一下：

```
d = AtomicDict()
d['abc'] = 0
d['abc'] += 1 
```

最后一行不是原子的。有一个 atomic `__getitem__`，然后是一个单独的 atomic `__setitem__`。

这听起来可能没什么大不了的，但想象一下它`d`被用作计数器。你有 20 个线程都试图同时做`d['abc'] += 1`。第一个进去的`__getitem__`就会回来`0`。如果它是最后一个进入`__setitem__`，它会将其设置为`1`。

尝试运行[此示例](http://pastebin.com/MrtR6Ufh)。通过适当的锁定，它应该总是打印出 2000。但在我的笔记本电脑上，它通常接近 125。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T01:45:03.067

我已经对您的问题进行了一些思考，这将是一件棘手的事情-您不仅必须用您的 Atomic 类代理所有对象方法-这可以通过正确编写`__getattribute__`方法来完成-而且要让操作员自己工作，您还必须为代理对象提供一个类，该类提供与原始对象类相同的“魔术双下划线”方法 - 也就是说，您必须动态创建一个代理类 - 否则运算符的使用本身不会原子。

这是*可行*的- 但由于您是 Python 新手，您可以`import this`在交互式提示下执行，并且在显示的几个指南/建议中，您会看到：“”“如果实现难以解释，这是一个坏主意。 """ :-)

这让我们想到：在 Python 中使用*线程* 通常是个坏主意。除了具有大量阻塞 I/O 的准普通代码 - 你会更喜欢另一种方法 - 因为 Python 中的线程不允许普通 Python 代码使用更多 CPU 内核，例如 - 只有一个 Python 代码线程立即运行 - 搜索“Python GIL”以了解原因 - （例外，如果您的大量代码用于计算密集型本机代码，例如 Numpy 函数）。

但是您宁愿编写您的程序以使用各种可用框架之一来使用异步调用，或者为了轻松利用多个内核，使用`multiprocessing`而不是`threading`- 这基本上为每个“线程”创建一个进程 - 并且需要所有共享都明确完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-31T02:15:25.890

然后 wrapt 模块包含那里描述的 @synchronized 装饰器。

[https://pypi.python.org/pypi/wrapt](https://pypi.python.org/pypi/wrapt)

可以在以下位置找到描述装饰器及其工作原理的演讲：

*   [https://www.youtube.com/watch?v=EB6AH-85zfY](https://www.youtube.com/watch?v=EB6AH-85zfY)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T02:25:07.093

尽管我的其他答案 - 它对 Python 线程有有效的考虑，并将*现有*对象转换为“原子”锁定对象 - 如果您正在定义要以原子方式锁定的对象的类，那么整个事情就是一个*顺序*量级更简单。

可以做一个函数装饰器来使函数使用四行锁运行。这样就可以构建一个类装饰器，以原子方式锁定给定类的所有方法和属性。

下面的代码适用于 Python 2 和 3（我在函数调用中使用了 @abarnet 的示例 - 并依赖于我的“打印调试”作为类示例。）

```
import threading
from functools import wraps

#see http://stackoverflow.com/questions/15960881/how-to-decorate-a-python-object-with-a-mutex/15961762#15960881

printing = False

lock = threading.Lock()
def atomize(func):
    @wraps(func)
    def wrapper(*args, **kw):
        with lock:
            if printing:
                print ("atomic")
            return func(*args, **kw)
    return wrapper

def Atomic(cls):
    new_dict = {}
    for key, value in cls.__dict__.items():
        if hasattr(value, "__get__"):
            def get_atomic_descriptor(desc):
                class Descriptor(object):
                    @atomize
                    def __get__(self, instance, owner):
                        return desc.__get__(instance, owner)
                    if hasattr(desc, "__set__"):
                        @atomize
                        def __set__(self, instance, value):
                            return desc.__set__(instance, value)
                    if hasattr(desc, "__delete__"):
                        @atomize
                        def __delete__(self, instance):
                            return desc.__delete__(instance)
                return Descriptor()
            new_dict[key] = get_atomic_descriptor(value)
        elif callable(value):
            new_dict[key] = atomize(value)
        else:
            new_dict[key] = value
    return type.__new__(cls.__class__, cls.__name__, cls.__bases__, new_dict)

if __name__ == "__main__": # demo:
    printing = True

    @atomize
    def sum(a,b):
        return a + b

    print (sum(2,3))

    @Atomic
    class MyObject(object):
        def _get_a(self):
            return self.__a

        def _set_a(self, value):
            self.__a = value +  1

        a = property(_get_a, _set_a)

        def smurf(self, b):
            return self.a + b

    x = MyObject()
    x.a = 5
    print(x.a)
    print (x.smurf(10))

    # example of atomized function call - based on
    # @abarnet's code at http://pastebin.com/MrtR6Ufh
    import time, random
    printing = False
    x = 0

    def incr():
        global x
        for i in range(100):
            xx = x
            xx += 1
            time.sleep(random.uniform(0, 0.02))
            x = xx

    def do_it():
        threads = [threading.Thread(target=incr) for _ in range(20)]
        for t in threads:
            t.start()
        for t in threads:
            t.join()

    do_it()
    print("Unlocked Run: ", x)

    x = 0
    incr = atomize(incr)
    do_it()
    print("Locked Run: ", x) 
```

注意：虽然“eval”和“exec”在 Python 中可用，但严肃的代码很少——我的意思是*很少*——需要任何一个。即使是重新创建函数的复杂装饰器也可以通过自省来完成，而不是通过 eval 依赖字符串编译。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-03T05:37:06.670

多年后回到这一点。我认为上下文管理器是我最初问题的理想解决方案。我知道锁支持上下文管理，但您仍然面临强制执行锁和锁定资源之间关系的问题。相反，我想像下面这样的东西会很好：

```
class Locked:
    def __init__(self, obj):
        super().__init__()
        self.__obj = obj
        self.lock = threading.RLock()

    def __enter__(self):
        self.lock.acquire()
        return self.__obj

    def __exit__(self, *args, **kwargs):
        self.lock.release()

guard = Locked(dict())

with guard as resource:
    do_things_with(resource) 
```

# php - MySQL：如何获得每个成员每天发布的平均评论？

> ID：15960885
> 
> 赞同：-1
> 
> 时间：2013-04-11T23:57:04.830
> 
> 标签：php, mysql

我需要一些帮助来获取每个成员每天发布的平均评论。我想使用 mysql 查询而不是在 php 中使用多个查询和计算来获取它。

这些是表及其字段：

1.  会员
    *   数量（主要）
    *   createdDate（时间戳）
2.  帖子
    *   数量（主要）
    *   createdDate（时间戳）
    *   成员编号
3.  注释
    *   数量（主要）
    *   createdDate（时间戳）
    *   成员编号
    *   帖子数

是否可以使用单个查询或最少的查询获得这样的结果：

```
+--------------+------------------------+
|  member_num  |  avg_comments_per_day  |
+--------------+------------------------+
|  5           |  10                    |
+--------------+------------------------+
|  24          |  7                     |
+--------------+------------------------+
|  33          |  5                     |
+--------------+------------------------+
|  8           |  1                     |
+--------------+------------------------+
|  9           |  1                     |
+--------------+------------------------+ 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:04:59.310

你可以写：

```
SELECT member_num,
       COUNT(1) / COUNT(DISTINCT CAST(createdDate AS DATE)) AS avg_comments_per_day
  FROM comments
 GROUP
    BY member_num
; 
```

这将给出每个用户的评论总数除以该用户发布任何评论的总天数。（这似乎是“平均”的最简单概念。如果您想要不同的东西，请澄清。）

（免责声明：未经测试。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:11:08.603

为此，您需要有一个表格，其中包含您可以加入的所有可能日期。所以像：

```
dates table
--------------

date
2001-01-01
2001-01-02
...
2030-12-31 
```

显然，您可以根据需要调整开始日期和结束日期。你需要这个的原因是你需要有一种方法来计算用户有 0 条评论的日期，这些评论不会显示在你的评论表中。

然后，您需要将此表与您的评论表连接起来：

```
SELECT
  c.member_num AS `member`,
  d.`date` AS `date`,
  COUNT(c.num) AS `count`
FROM dates AS d
LEFT OUTER JOIN comments AS c
  ON d.`date` = DATE(c.createdDate)
WHERE d.`date` BETWEEN '????-??-??' AND '????-??-??'
GROUP BY `member`, `date` 
```

请注意，我在此处添加了日期范围，因此您可以仅计算您感兴趣的时间段内的平均值。如果不这样做，您将在日期表中获得所有日期的平均值。当然，这只会让您获得一部分。您仍然需要对这些信息进行平均，因此在最终查询中使用上述查询作为子选择：

```
SELECT
    `member`,
    AVG(`count`) AS `daily_average`
FROM
    (SELECT
      c.member_num AS `member`,
      d.`date` AS `date`,
      COUNT(c.num) AS `count`
    FROM dates AS d
    LEFT OUTER JOIN comments AS c
      ON d.`date` = DATE(c.createdDate)
    WHERE d.`date` BETWEEN '????-??-??' AND '????-??-??'
    GROUP BY `member`, `date`) AS `comment_counts`
GROUP BY `member` 
```

当然，这个查询的性能会很差，因为您不会在评论和日期之间的连接上使用索引。如果您需要定期执行此查询，我的建议是实际构建一个表，您可以在其中正确更新评论计数统计信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T00:12:43.720

ruakh 或 mike 的方法应该适用于您的情况。

但是您应该考虑将这些信息存储在单独的表格中，您可以在每条评论或每天一次（或两者）更新该表格。

假设一个用户每天写 10 条帖子，那么每年有 3650 条评论，在网站上停留 10 年（或更短时间）后，您有来自该用户的 365000 条评论。在 rune-time 上计算每天的平均评论可能会增加计算时间，特别是如果您必须每天为很多用户执行多次。

因此，每次您需要数据时，不必计算每天的平均评论数，然后只需有一个单独的表

```
userId
avgComments 
```

获取单个索引比每次需要数据时都进行计算要高效得多。

# css - 带有水平滚动条的 css

> ID：15960889
> 
> 赞同：1
> 
> 时间：2013-04-11T23:57:19.407
> 
> 标签：css

我的主样式表中有这个 CSS 是否可以从此 CSS 中删除水平滚动条：

```
html, body, #wrap {
    width:100%;
    height:100%;
    margin:0;
    padding:0;
    font-family:Calibri;
}
#wrap {
    height: auto;
    min-height: 100%;
}

/* header stuff */
#header-topbar {
    width:100%;
    height:30px;
    padding:10px 10px 10px 10px;
    background-color:#666666;
}
#header-topbar2 {
    width:100%;
    height:80px;
    padding:10px 10px 10px 10px;
    background-color:#eeeeee;
}
#phone-tel {
    position:block;
    float:right;
    margin-right:16%;
    margin-top:5px;
    font-size:20px;
}
#logo {
    position:absolute;
    float:left;
    margin-left:15%;
    margin-top:0px;
}

/* main body/content */
#body-content {
    padding-bottom:200px;
    width:70%;
    margin:120px auto 0 auto;
    padding:10px 10px 10px 10px;
    border:solid 1px #a79494;
    border-top:solid 4px #a2cd3a;
}

/*footer */
#footer .column {
    margin-top:-200px;
    clear:both;
    float: left;
    width: 25%;
}

#footer .column div {
    margin: 5px;
    height: 200px;
    background: #eeeeee;
} 
```

我尝试将宽度：100% 添加到正文、html 以及填充：0 和边距：0 但仍然无法正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:02:19.637

问题是您将元素的宽度设置为 100%，然后通过设置填充添加到该宽度。您可以为这些元素设置`box-sizing`to `border-box`，这将导致填充进入宽度内（但在 IE7 中不起作用），或者您可以在这些元素内添加一个元素，然后设置填充。

```
* {
    box-sizing: border-box;
} 
```

[http://jsfiddle.net/ryanbrill/mxk4T/](http://jsfiddle.net/ryanbrill/mxk4T/)

有关 的浏览器支持`box-sizing`，请参阅[http://caniuse.com/#search=box-sizing](http://caniuse.com/#search=box-sizing)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T00:03:19.000

剪掉大部分代码，你的问题组合是这样的：

```
#header-topbar {
    width:100%;
    padding:10px 10px 10px 10px;
} 
```

[CSS Box 模型](http://www.w3.org/TR/CSS2/box.html)将宽度定义为内容的宽度，并在内容周围添加了边距和**填充**。

这样做的结果是你的标题占用的总空间是 100% + 20px，它总是比屏幕宽。

正如下面评论中所指出的，块级项目将**自动**占据其父项的整个宽度，因此删除`width:100%;`此处并保留填充可能是一个有效的选择。

在某些情况下，您特别需要百分比宽度，特别是对于浮动（我经常使用多列布局的流体）。

当需要百分比宽度时，我对填充问题的标准解决方案看起来有点像这样：

```
width: 95%
padding-left:2.5%;
padding-right:2.5%; 
```

请注意，我们以相同的单位指定填充和宽度，总和为 100% (95 + 2.5 + 2.5 = 100)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T23:59:19.160

肮脏的修复

```
 html, body, #wrap {
    overflow-x:hidden;
    } 
```

[jsFiddle 示例](http://jsfiddle.net/Diabl0570/GtQbM/)

# javascript - Windows 8 应用程序中的 Require.js 代码组织

> ID：15960895
> 
> 赞同：1
> 
> 时间：2013-04-11T23:58:22.997
> 
> 标签：javascript, windows-runtime, microsoft-metro, requirejs, winjs

我有一个用 JS 编写的 Windows 8 应用程序，它使用了一些 WinJS 概念：

*   页面
*   命名空间

同时它使用 Backbone 模型和集合以及 jquery、underscore 和一些其他流行的库。

在“Models”WinJS 风格的命名空间（例如：）中定义的每个 Backbone 模型`WinJS.Namespace.define("Models", {mymodel: //stuff})`以及在“Collections”命名空间中的每个集合。集合和模型的实例存储在“App”命名空间中。

每个页面都是 WinJS 样式的页面（例如：）`WinJS.UI.Pages.define("/pages/somepage/somepage.html", {//stuff})`。每个页面都有自己的文件夹，其中包含 html、css 和 js 文件。

所以现在我有一堆相互依赖的 JS 文件，而我的入口点 default.html 有一大堆`<script>`以正确的加载顺序手动排序的标签，而且很难随着时间的推移而维护。

**问题：** 最近我听说了 require.js 并且看起来它解决了我的问题，它考虑到依赖关系以正确的顺序加载模块。但问题是，我不知道如何重构我的代码，看起来 WinJS.pages 和 WinJS.namespaces 不兼容 require.js 的模块化风格。这里最好的方法是什么？什么是最佳实践？

我的 default.html 头示例：

```
<head>
<meta charset="utf-8" />
<title>CollectionsWinJS</title>

<!-- Javascript libraries -->
<script src="/js/libs/jquery.js"></script>
<script src="/js/libs/underscore.js"></script>
<script src="/js/libs/backbone.js"></script>
<script src="/js/libs/js-yaml.js"></script>

<script src="/js/libs/jquery.ui.position.js"></script>
<script src="/js/libs/moment.js"></script>

<script src="/js/libs/metrobone.js"></script>

<!-- WinJS references -->
<link href="//Microsoft.WinJS.1.0/css/ui-light.css" rel="stylesheet" />
<script src="//Microsoft.WinJS.1.0/js/base.js"></script>
<script src="//Microsoft.WinJS.1.0/js/ui.js"></script>

<!-- CollectionsWinJS references -->
<link href="/css/default.css" rel="stylesheet" />
<script src="/js/conf.js"></script>
<script src="/js/default.js"></script>
<script src="/js/navigator.js"></script>

<script src="/js/data.js"></script>

<!-- Javascript namespaces -->
<script src="/js/clns.js"></script>
<script src="/js/converters.js"></script>

<!-- Sources -->
<script src="/js/Models/User.js"></script>
<script src="/js/Models/ExternalItem.js"></script>
<script src="/js/Collections/ExternalItems.js"></script>
<script src="/js/Models/Service.js"></script>
<script src="/js/Models/ServiceProvider.js"></script>
<script src="/js/Collections/Services.js"></script>
<script src="/js/Collections/ServiceProviders.js"></script>

<script src="/js/main.js"></script>
</head> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T02:54:09.450

让我们举个例子。

```
script1.js
(function()
{
    'use strict';
    var A = WinJS.Class.define( 
        function A_ctor() {}, 
        {
            property1: { .. }
            func1: ..
        });

    WinJS.Namespace.define('Models.A', { A: A });
}();
script2.js
(function()
{
    'use strict';
    var B = WinJS.Class.define( 
        function B_ctor() {}, 
        {
            property1: { .. }
            func1: function func1()
            {
                var a = new Models.A();
            }
        });

    WinJS.Namespace.define('Models.B', { B: B });
}(); 
```

`B.func1`在上述场景中，类中存在运行时依赖`A`项。但无论是在初始化流程中`script1`还是`script2`先执行都没有关系。这是因为初始化流程只会定义类，它们还没有执行。

如果您的所有脚本都正确模块化为类并通过命名空间本身发布 - 初始化代码流应该在应用程序激活流中，并且可能是 default.js 中一些全局变量的实例化，这些变量可以放在 default.html 的末尾。

# php - SQL 结果截断第一个结果

> ID：15960900
> 
> 赞同：0
> 
> 时间：2013-04-11T23:58:55.587
> 
> 标签：php, mysql, database

奇怪的系列事件。

我有一个严格用于构建数据库的网页（超级准系统）。HTML 表单操作针对同一页面 - 使用 PHP 语句`if(isset($_POST['submit']))`更改每次提交时的内容。每次用户提交时，它会回显一个`This [x] was successfully added.`，然后在页面底部继续显示一个表格。

该表显示了结果，但第一个结果被截断。

表代码：

```
$host = "x";
$dbusername = "x";
$dbpassword = "x";
$db_name = "x";

mysql_connect("$host","$dbusername","$dbpassword") or die("Cannot connect to database");
mysql_select_db("$db_name") or die("Cannot select database");

// Collect Information
$query = "SELECT * FROM database";

$data = mysql_query($query) or die(mysql_error());

$row = mysql_fetch_array($data);

print "<table border='1px' cellpadding='4px' cellspacing='0'><tr><th>ID</th><th>CELL 1</th><th>CELL 2</th><th>CELL 3</th><th>CELL 4</th><th>CELL 5</th><th>CELL 6</th><th>CELL 7</th><th>CELL 8</th><th>CELL 9</th><th>CELL 10</th><th>CELL 11</th><th>CELL 12</th><th>CELL 13</th><th>CELL 14</th></tr>";
while($row = mysql_fetch_array($data)){
    print "<tr><td>";
print $row['index'];
print "</td><td>";
print $row['CELL 1'];
print "</td><td>";
print $row['CELL 2'];
print "</td><td>";
print $row['CELL 3'];
print "</td><td>";
print $row['CELL 4'];
print "</td><td>";
print $row['CELL 5'];
print "</td><td>";
print $row['CELL 6'];
print "</td><td>";
print $row['CELL 7'];
print "</td><td>";
print $row['CELL 8'];
print "</td><td>";
print $row['CELL 9'];
print "</td><td>";
print $row['CELL 10'];
print "</td><td>";
print $row['CELL 11'];
print "</td><td>";
print $row['CELL 12'];
print "</td><td>";
print $row['CELL 13'];
print "</td><td>";
print $row['CELL 14'];
print "</td></tr>";
}

echo "</table>";

mysql_close(); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T00:01:16.890

您在`mysql_fetch_array()`进入循环之前调用
这会将结果的第一行加载到`$row`变量
中，然后在 while 循环中再次调用它您用第二个结果行覆盖第一个结果行

```
$data = mysql_query($query) or die(mysql_error());

**$row = mysql_fetch_array($data);**

print "<table border='1px' cellpadding='4px' cellspacing='0'><tr><th>ID</th><th>CELL 1</th><th>CELL 2</th><th>CELL 3</th><th>CELL 4</th><th>CELL 5</th><th>CELL 6</th><th>CELL 7</th><th>CELL 8</th><th>CELL 9</th><th>CELL 10</th><th>CELL 11</th><th>CELL 12</th><th>CELL 13</th><th>CELL 14</th></tr>";
while($row = mysql_fetch_array($data)){ 
```

删除这一行，它也会显示第一行

# angularjs - 从 ControllerA 调用一个函数到 ControllerB

> ID：15960902
> 
> 赞同：0
> 
> 时间：2013-04-11T23:59:01.713
> 
> 标签：angularjs

我刚刚开始学习 Angular.js。我正在尝试将函数从 CtrlA 调用到 CtrlB。我怎么做？

这是我到目前为止所拥有的 -

```
var app = angular.module('myApp', []);

function UserCtrl($scope) {
    $scope.users = [
        {id: 1, name: 'Mike Smith'},
        {id: 2, name: 'Jane Doe'}
    ];

    $scope.getDetails = function(userId) {
        //Call getUserById in UserDetailCtrl. How?
    };
};

function UserDetailCtrl($scope) {
    $scope.getUserById = function(userId) {
        alert('test');
    };
}; 
```

看法 -

```
<div ng-controller="UserCtrl">
    <ul>
        <li ng-repeat="user in users">
            <a ng-click="getDetails(user.id)">{{user.name}}</a>
        </li>
    </ul>
</div> 
```

[http://jsfiddle.net/zDyn2/18/](http://jsfiddle.net/zDyn2/18/)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T01:35:19.477

要在控制器和指令之间共享数据和/或方法，请使用服务并在需要时注入该服务：

```
var app = angular.module('myApp', []);

app.factory('MyDataService', function () {

    var Users = {
        activeUser: {},
        users: [{ id: 1,name: 'Mike Smith'}, 
                { id: 2,name: 'Jane Doe'}],

        setActiveUserName:function( name){
            Users.activeUser.name=name;
        }
    }

    return Users
})

function UserCtrl($scope, MyDataService) {
    $scope.users = MyDataService.users;
    $scope.setActiveUserName = function (user) {          
            MyDataService.setActiveUserName( user.name);
    }

};

function UserDetailCtrl($scope, MyDataService) {
    $scope.activeUser = MyDataService.activeUser;
}; 
```

演示：http: [//jsfiddle.net/zDyn2/20/](http://jsfiddle.net/zDyn2/20/)

# node.js - 在没有连接资产的情况下向客户提供咖啡脚本的最佳方式

> ID：15960903
> 
> 赞同：0
> 
> 时间：2013-04-11T23:59:01.713
> 
> 标签：node.js, express, coffeescript

花最后几个小时试图找出编译coffeescript并根据请求提供.js的最佳方法。我正在使用require.js，不，require 的咖啡插件不是答案，只是听起来很奇怪......而且我不想使用connect-assets，因为我正在使用require.js。所以我最终写了类似的东西：

```
app.configure 'development', ->
  app.get(/.js$/, (req, res, next) ->
    script = req.originalUrl.substring(1, req.originalUrl.length - 3)
    try
      file = "app/assets/javascripts/#{script}.coffee"
      cs = fs.readFileSync "#{__dirname}/#{file}", "ascii"
      try
        js = coffee.compile cs
        res.header 'Content-Type', 'application/x-javascript'
        res.send(js, 200)
      catch e
        res.send("Coffee compile error in #{file}\n" + e.stack, {'Content-Type': 'text/plain'}, 500)
    catch e
      next()
    )
    app.use(express.static("#{__dirname}/app/assets/javascripts")) 
```

所以我捕获所有 .js 请求，找到相应的 .coffee 文件，编译它们并将它们返回给客户端。但它的代码太多了......然后我找到了coffee-middleware npm包，我认为只使用3行咖啡来配置我的服务器以提供咖啡会更干净，但它刚刚开始将.js编译成相同的dir 作为咖啡。

请提供任何帮助。我可以在 git 上查看任何项目示例吗？非常感谢您提前！

或者我必须发布上面代码的 npm 包，我不确定这是否是最佳选择:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T17:10:31.493

编译咖啡脚本：

*   使用咖啡脚本编译器的 watch 函数。
*   创建一个 Makefile ( `make coffee`;-)
*   使用 grunt 或任何其他工具。

如果您使用 Makefile 方法，您可以创建一个用于启动服务器的目标，该目标在启动服务器之前编译咖啡脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T17:51:02.473

> 然后我找到了coffee-middleware npm 包，我认为只使用3 行coffee 来配置我的服务器以提供咖啡会更干净，但它刚刚开始将.js 编译到与coffee 相同的目录中。

[connect-coffee-script](https://github.com/wdavidw/node-connect-coffee-script)模块同时采用`src`和`dest`选项，因此您的源目录保持整洁。

实际上，我也看到了[咖啡中间件](https://github.com/uber/coffee-middleware)。它在自述文件中。

# javascript - AngularJS + Socket.io：触发模式的套接字事件——在指令或控制器中？

> ID：15960904
> 
> 赞同：2
> 
> 时间：2013-04-11T23:59:15.203
> 
> 标签：javascript, angularjs, socket.io

我正在使用 socket.io 向 Angular 控制器发送一个事件，该控制器为模态模板设置文本内容。

如果我还想在`modal()`触发该事件时调用一个方法，我应该在控制器中执行此操作，还是应该在指令中执行此操作？

如果是后者，我应该直接在指令内监听 socket.io 事件，还是应该从控制器广播一个单独的事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T01:20:16.177

我通常采用 Brian Ford[在这里](http://www.html5rocks.com/en/tutorials/frameworks/angular-websockets/)描述的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T02:12:38.017

我最终选择了后者，通过依赖注入结合使用了 socket.io（如 rgaskill 的回答中所引用，然后在指令中对套接字事件本身做出反应，如下所示：

```
angular.module('MyApp.directives', [])
  .directive('modal', function(socket) {

    return function($scope, element, attrs) {
      socket.on('showInfo', function(event, msg){
        element.modal('show');
      });

    };
  }); 
```

**编辑**

此处快速更新：出于长期组织的考虑，我最终将所有`socket`侦听器都放在了我的控制器中，而不是将它们散布在控制器和指令中。当我需要侦听指令中的事件时，我`$scope.$broadcast('eventName')`在控制器的套接字侦听器中使用 angular 将事件广播到指令，然后用`$scope.$on('eventName')`. 那里有一些冗余，但它有助于加强以前不存在的一致性水平。

如果有人对这种技术的相对有效性或无效性有意见，我很想听听！

# php - 如何设置 X-Cart 的默认付款方式

> ID：15960908
> 
> 赞同：1
> 
> 时间：2013-04-11T23:59:36.830
> 
> 标签：php, x-cart

我不知道如何设置进入结帐页面时选择的默认付款。有没有办法通过数据库、管理页面或配置文件进行设置？

如果有任何帮助，我正在使用 4.5.2 版。

我还尝试将订单号设置为 0 以查看它是否会首先设置我选择的付款类型，但这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-22T07:15:35.263

试试这个它会帮助你：

找到这个文件：include/checkout.php 在下面找到这一行：给支付 id 你想要启用什么

```
// $smarty->assign('paymentid',        $paymentid);
$paymentid=14; // default payment selection
$smarty->assign('paymentid',        $paymentid); 
```

# javascript - node.js / jquery 上的简单刮板应用程序

> ID：15960909
> 
> 赞同：0
> 
> 时间：2013-04-12T00:00:03.073
> 
> 标签：javascript, jquery, node.js

我正在尝试使用 jQuery 在 Node.js 上构建一个小型应用程序，它将请求提供的位置的内容。如果 URL 指向的资源不是 HTML，它将输出返回的内容类型。否则，它将读取 HTML 数据并输出页面标题和描述，然后是页面上可点击链接的列表。这是我的代码：

```
var request             = require('request'),    
    jsdom               = require('jsdom'),
    fs                  = require('fs'),
    colors              = require('colors'),
    argv                = require('optimist').argv;

    colors.setTheme({ c1: 'blue', c2: 'red', c3: 'inverse' });

var myFunc = function( link, cb ){

console.log( 'requesting page: '.c3 + link.c3 );

// Step 1 - request to the page
request({
        uri: link,
    }, function (err, response, body) {

        // Handle response issues
        if ( err || response.statusCode !== 200 ) {
            if ( !response ){
                console.log( 'Ooops! page doesn`t exist or wrong URL format'.c2 )
            } else {
                console.log('error: '+ response.statusCode )
            }
            cb();

        } else {

            console.log( 'response code: ' + response.statusCode )

            // Step 2 - invoking jsdom and jQuery
            jsdom.env({
                html: body,
                src: [
                    fs.readFileSync(__dirname + "/lib/jquery-1.9.1.min.js").toString()
                ],
                done: function(err, window) {

                    if(err) {
                        cb();
                    } else {

                        var $ = window.$;

                        // Step 3, final part - parse content with jQuery selectors
                        console.log( '\nThis page is:\n'.c1 + $(body)[0]._ownerDocument._contentType )
                        console.log( '\nPage title: \n'.c1 + $('title').text().trim() );
                        console.log( $('head meta[name="description"]').attr('content') !== undefined ? '\nPage description: \n'.c1 + $('head meta[name="description"]').attr('content') + '\n' : '\nPage description: \n'.c1 + 'No description on the page\n'.c2);
                        console.log( '\nClickable links on the page: \n'.c1 )

                        $('a').each(function(){
                            if ( $(this).attr('href') !== undefined ){
                                console.log( $(this).attr('href').slice(0, 4) == 'http' ? $(this).attr('href') : link + $(this).attr('href'))
                            } 
                        });

                        cb();
                    }
                } 
            })
        }
    }
); 
```

};

所以它完美地**抓取**了一个 html 页面，但我不知道如何实现这部分

> 如果 URL 指向的资源不是 HTML，它将输出返回的内容类型。

请分享一个想法如何做这部分。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T10:59:46.320

我从未使用过 JQuery，并且是 javascript 的初学者，但我会做的是获取字符串中的 url，删除所有内容，直到最后一个点（例如：“ [http://www.web.com/content.php](http://www.web.com/content.php) " => "php")，将其与 'html' 进行比较，并打印出来，因为它将是内容类型。

编辑：

```
//url is a string
function validate (url) {
    //Get whatever is after the last dot in the url
    //Compare to html
    //Return true if it is equals, or false if not
    return (url.substr(url.lastIndexOf('.')) === 'html');
} 
```

# java - NullPointerException 难度

> ID：15960910
> 
> 赞同：0
> 
> 时间：2013-04-12T00:00:10.230
> 
> 标签：java, nullpointerexception

所以我在编程任务上遇到了一些麻烦。我已经创建了所需的类，并且它已经完全编译，但是当我运行它时，我得到了 NullPointerException。

所有的异常都指向这个方法；

```
public void initializeCount(){
for(int j=0; j<t.length; j++){
 String s=t[j];
 WordCount h=new WordCount(s);
 xx[j]=h;
}
} 
```

xx[] 是一个相关对象的数组（WordCount），在类的开头定义（我不记得这叫什么了，编程还是新手）

```
public class WordFreq extends Echo{
  private String wordString;
  private String[] t;
  private WordCount[] xx;
  private int words=0;
  Scanner scan;
 } 
```

t是一个字符串对象数组，在构造函数中填充

```
public WordFreq (String x, String y) throws IOException{
super(x);
wordString=y;
t=wordString.split(" ");
scan = new Scanner(new FileReader(fileName));
} 
```

回到 initializeCount 方法，我想要它做的是把 t[] 中保存的单词，转换成 WordCount 对象，然后将这些对象放入 xx[] 中。

编辑：我很确定我在课程开始时初始化了 xx ，但我可能是错的：

```
public class WordFreq extends Echo{
private String wordString;
private String[] t;
private WordCount[] xx;
private int words=0;
Scanner scan;
} 
```

如果有人可以向我解释为什么 initializeCount 方法会导致 NullPointerException，我应该能够修复它并使程序正常工作。非常感谢任何帮助，如果需要，我可以提供更多程序代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T00:03:19.343

xx 数组是否在某处初始化？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T00:04:16.557

您没有初始化 xx 我认为您希望将 xx 初始化为 t 的大小，所以请执行以下操作

```
 xx = new WordCount[t.length]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T18:00:06.987

对象“t”是否在某处初始化

您可以如下更改您的初始化方法并检查对象 t 的打印内容吗？我怀疑对象 t 为空。我还添加了一个空检查以防止空指针异常。

```
public void initializeCount(){
System.out.println("What is the value of t --->"+t);
if(t!= null){
for(int j=0; j<t.length; j++){
 String s=t[j];
 WordCount h=new WordCount(s);
 xx[j]=h;
}
}
} 
```

# assembly - 如何使用 rop（面向返回的编程）打印寄存器值？

> ID：15960911
> 
> 赞同：1
> 
> 时间：2013-04-12T00:00:27.170
> 
> 标签：assembly, x86, buffer-overflow

我有一个任务来构建使用寄存器`printf`内的值调用的 rop 代码`edx`。

我被困住了。我知道`printf`函数的地址，并且我有一个工具可以找到小工具。

我正在尝试构建一个看起来像这样的堆栈：

> someROPCode、printf_address、ret_address、ropCodeThatWrite_EDX_Value（printf 参数）。

我试过：`someROPCode = add esp 0xc,re`t（跳过`printf`函数，这样我就可以`edx`在堆栈上写值）

```
ret_address=doesn't matter 
```

`ropCodeThatWrite_EDX_Value`=我想到了类似的东西：`push eax`，，`push edx`（`ret`我不能使用只是`push edx`因为我认为它会导致无限循环（我是新手）但现在我被卡住了（很明显这不是办法）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T01:30:20.980

ROP 用于绕过不可执行的堆栈。为了成功利用，还需要绕过其他安全措施。对于本练习，让我们严格关注 ROP，并假设您有一个没有 ASLR 等的简单设置。特别是我们假设您可以轻松访问堆栈指针和函数地址。

我们想调用`printf("%d\n", edx)`. 使用普通的 32 位 x86 cdecl 调用约定，我们需要堆栈中的这两个参数。格式化字符串很简单，但我们必须`edx`进入内存。由于我们无法编写任何代码，我们需要找到为我们执行此操作的现有指令。C 库是一个不错的选择。找出合适的代码是困难的部分。使用`objdump`我发现了以下有希望的片段：

```
 2e535:       89 54 24 04             mov    DWORD PTR [esp+0x4],edx
   2e539:       ff 55 14                call   DWORD PTR [ebp+0x14] 
```

这会将`edx`堆栈放在正确的位置并通过函数指针调用函数。一定是我的幸运日，因为所说的指针是使用寻址`ebp`的，并且很容易设置它的值，因为标准函数结尾经常这样做`pop ebp; ret`。我在附近找到了这样一对，在 offset `2e6C1`。显然`call`不会返回到我们的代码，因此它会在完成打印后做未定义的事情（它很可能会崩溃）。如果这让您感到困扰，您将不得不找到更合适的代码片段。不要忘记将 C 库的加载地址添加到您找到的偏移量中。

因此所需的堆栈布局如下所示：

*   `esp+00h`: 地址`pop ebp; ret`
*   `esp+04h`: (偏移`esp+00h`地址的地址)`printf``-0x14`
*   `esp+08h`:`edx`入栈并调用函数指针的代码地址
*   `esp+0Ch`: `esp+18h`(格式字符串的地址)
*   `esp+10h`: 占位符`edx`
*   `esp+14h`: 地址`printf`
*   `esp+18h`: 格式字符串`%d\n`

我希望这能很好地说明这个想法，以便您可以提出适合您特定设置的解决方案。

# java - CORBA IDL 哈希图

> ID：15960917
> 
> 赞同：1
> 
> 时间：2013-04-12T00:00:55.607
> 
> 标签：java, corba, idl, iiop

有没有这样一种方法可以编写 CORBA IDL 来为 Hashmap 生成存根以存储以下内容？

```
public static final Map<Date, Integer> map = new HashMap<Date, Integer>(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T03:58:36.110

如果您控制服务器，请通过 RMI/IIOP 在远程接口中定义它，通过 实现它`PortableRemoteObject`，然后使用它`rmic -idl`来生成 IDL，但请注意，客户端将需要一个支持按值对象的 ORB。如果客户端是 Java，则直接使用 RMI/IIOP 存根，完全忘记 IDL。

# scala - Scala 中的大型 CSV 读取超出了 GC 开销限制

> ID：15960924
> 
> 赞同：1
> 
> 时间：2013-04-12T00:01:33.337
> 
> 标签：scala, garbage-collection, jvm, sbt

所以。我正在使用 Scala，而且我对它比较陌生（主要是 python 人）。我正在通过 sbt 编译和运行我的代码。我在一个 Ubuntu 机器上，目前正在运行 Java 6。我有两个 CSV；我需要接受它们，处理它们，然后操纵它们。每个 CSV 约为 250mb；如果这可行，我可能会用更大的 CSV 重复这个过程。

我已经定义了一个读取 CSV 并将每一行写入我需要的数据结构的函数。我在每个 CSV 上串联调用此函数。问题是：它为第一个 CSV 完美返回（并且非常快），但第二个总是抛出`java.lang.OutOfMemoryError: GC overhead limit exceeded`错误。

我已经尝试了很多东西。我的`build.sbt`定义`javaOptions += "-Xmx20480m -XX:+HeapDumpOnOutOfMemoryError"`；我也尝试过使用`-XX:-UseGCOverheadLimit`，但这似乎没有任何帮助。根据我一直在阅读的 Java 文档，该错误表明大量系统资源正在用于垃圾收集 - 但坦率地说，我不清楚它是什么垃圾收集，或者如何减少它。我假设我的函数一定是......在某处泄漏内存，或者我一定是误用了 Scala，但我不知道怎么做。

这是我的功能：

```
def readAndProcessData(path: String) = {
    val fileLines = Source.fromFile(path).getLines.drop(1)
    val ret = mutable.Map[String, List[Tuple2[String, String]]]()

    def addRowToRet(row: String) = {
        val rowArray = row.split(",")
        if (!(ret contains rowArray(0))) {
            ret.update(rowArray(0), List[Tuple2[String, String]]())
        }
        ret(rowArray(0)) = Tuple2(rowArray(1), rowArray(2)) :: ret(rowArray(0))
    }

    for (row <- fileLines) {
        addRowToRet(row)
    }

    ret.map{tup => (tup._1 -> tup._2.sorted)}

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T14:02:15.333

首先，如果您不分叉运行，请[启用分叉](http://www.scala-sbt.org/release/docs/Detailed-Topics/Forking)或提高 sbt 的内存限制并删除 javaOptions 设置。在这里分叉可能是一个好主意，因此您不会将程序的内存使用行为与 sbt 的内存使用行为混为一谈。

您还应该关闭正在创建的 Source 对象，以确保释放其资源。

它是否在一致的地方崩溃，例如在排序时？或者崩溃是否发生在代码中相当随机的位置？

我假设您正在阅读的文件采用 ASCII 或 UTF8 等编码，其中大多数到所有字符都用 8 位表示。Java 使用每个字符 16 位，因此请记住，通过将其读入 Java 字符串，大小会增加一倍以上（“超过”是由于其他开销）。这本身不应该把你推倒，但这意味着当你加载两个 250MB 的文件时，你可能会消耗超过 1GB 的内存来存储数据。

您的密钥相对于文件中的行数如何分布？换句话说，您的地图中是否有几乎每一行、大约一半、四分之一等的条目？你可能有一个相当大的地图（就条目而言），当你对它执行“地图”操作以对值进行排序时，你最终会在内存中得到其中两个，直到函数返回并且旧的成为可收集的. 您可能还想尝试使用不可变映射或围绕 Java 可变映射的包装器。有时 Scala 的可变数据结构不如它们的不可变数据结构那么健壮。

此外，我对 scala.io.Source 从来没有好运。如果在你相当确定你实际上分配了足够的内存后它仍然失败，你可能想尝试使用 Java 的 IO 库。

最后，如果检查一些设置并稍微检查它不起作用，您应该将内存分析器连接到它，例如[VisualVM](http://visualvm.java.net/)。那是您有机会找出问题的真正所在，而不是通过修改进行猜测和检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:42:49.203

尝试返回 ret 并将其映射到包装方法中。那应该避免将所有内容都放在内存中。

# java - Java Swing：制作 JPanel 的可滚动列表

> ID：15960927
> 
> 赞同：-1
> 
> 时间：2013-04-12T00:01:50.627
> 
> 标签：java, swing, jpanel, jscrollpane

所以我正在使用 NetBeans 制作一个界面，这就是我想要做的：

我创建了一个 JPanel 类，它显示了有关对象（标签、texFields 和按钮）的一些信息。我想将几个类似上面的面板添加到同一个 JScrollPane 中（看起来像一个独立面板列表）。

我不能使用 JList，因为我不想只列出面板的“toString”，我看了一下： [http://docs.oracle.com/javase/tutorial/uiswing/components/combobox。 html#renderer](http://docs.oracle.com/javase/tutorial/uiswing/components/combobox.html#renderer) 但我认为这对我没有帮助（这解释了如何将图标放入 cellRenderer，但我想直接将 Panel 添加到其他面板的垂直列表中）...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T12:33:36.997

此[示例](https://stackoverflow.com/a/8154052/261156)允许您滚动小缩略图，但`ImagePanel`可能有组件。它`FlowLayout`用于水平布局，但`GridLayout(0, 1)`适用于垂直布局。

# php - 选择框中值的多维数组

> ID：15960928
> 
> 赞同：0
> 
> 时间：2013-04-12T00:01:52.597
> 
> 标签：php, arrays, multidimensional-array

```
public function getCategories()
{
    $categories = array( 
        array('is-yemekleri',           'İş yemeklerine uygun.'),
        array('bekarliga-veda',         'Bekarlığa veda partileri için uygun.'),
        array('dogum-gunleri',          'Doğum günleri için uygun.'),
        array('mac-yayinlari',          'Maç yayınları mevcut.'),
        array('akdeniz-yunan-mutfagi',  'Akdeniz ve Yunan mutfağı mevcut.'),
        array('turk-osmanli-mutfagi',   'Türk ve Osmanlı mutfağı mevcut.'),
        array('italyan-mutfagi',        'İtalyan mutfağı mevcut.'),
        array('fransiz-mutfagi',        'Fransız mutfağı mevcut.'),
        array('uzakdogu-mutfagi',       'Uzakdoğu mutfağı mevcut.'),
        array('bar-pub',                'Bar-pub mevcut.'),
        array('brunch-kahvalti ',       'Brunch Kahvaltı mevcut.'),
        array('partiler',               'Partiler için uygun.'),
        array('cafe',                   'Cafe mevcut.'),
        array('club',                   'Club mevcut.'),
        array('dugun-mekanlari',        'Düğünler için uygun.'),
        array('fasil-mekanlari',        'Fasıl için uygun.'),
        array('et-restoranlari',        'Et restoranı bulunuyor.'),
        array('balik-restoranlari',     'Balık restoranı bulunuyor.'),
        array('meyhaneler',             'Meyhane bulunuyor.'),
        array('kina-geceleri',          'Kına geceleri için uygun.'),
    );

   return $categories;
} 
```

我需要在我的视图文件中输出它。有一个复选框，它应该如下所示：

```
foreach($categories as $k => $v)
{
    İş yemeklerine uygun: (second value of array)
    <input type="checkbox" id="{ $k }" name="{ $k }" value="(first value of array)">
} 
```

输出应该是这样的；

```
İş yemeklerine uygun:
<input type="checkbox" id="0" name="0" value="is-yemekleri">

Bekarlığa veda partileri için uygun.
<input type="checkbox" id="1" name="1" value="bekarliga-veda">

...

Kına geceleri için uygun.
<input type="checkbox" id="18" name="18" value="kina-geceleri"> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T00:19:12.557

foreach 循环中的每个 $v 都是一个数组。

*第一个 $v：*

```
array('is-yemekleri','İş yemeklerine uygun.') //$v[0] and $v[1] 
```

*第二个$v：*

```
array('bekarliga-veda','Bekarlığa veda partileri için uygun.') //$v[0] and $v[1] 
```

*第三个$v：*

```
array('dogum-gunleri','Doğum günleri için uygun.') //$v[0] and $v[1] 
```

ETC...

我想你正在寻找这样的东西：

```
foreach($categories as $k => $v)
{
      echo $v[1]; //second value of array
      echo '<input type="checkbox" id="' . $k .'" name="'.$k.'" value="' . $v[0] . '" />';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:55:18.040

```
array_map(function($item,$key){
    echo  'İş yemeklerine uygun:'.$item[1];
    echo '<input type="checkbox" id="'.$key.'" name="'.$key.'" value="'.$item[0].'">``<br/>';
},$categories,array_keys($categories)); 
```

# django - 带有 Select Widget 的 Django ModelForm - 使用 object.uid 作为默认选项值而不是 object.id

> ID：15960930
> 
> 赞同：6
> 
> 时间：2013-04-12T00:01:56.593
> 
> 标签：django, django-forms, django-widget

我有一个从 ModelForm 继承的表单：

```
class ChildModel(ModelForm):
      class Meta:
          model = Documents
          fields = ('secretdocs')
          widgets = {
              'secretdocs': Select(attrs={'class': 'select'}),
          } 
```

模型“secretdocs”有一个 uid。但是当它打印出选择和选项时，选项值显示如下：

```
<select class="select" id="id_secretdocs" name="secretdocs">
    <option value="1">My Secret Doc</option>
</select> 
```

但我希望它具有选项的 uid：

```
<select class="select" id="id_secretdocs" name="secretdocs">
    <option value="cd2feb4a-58cc-49e7-b46e-e2702c8558fd">My Secret Doc</option>
</select> 
```

到目前为止，我已经尝试使用 BaseForm 的数据对象并覆盖 Select 的 value_from_datadict 方法，但我很确定这不是正确的方法。有谁知道我该怎么做？

提前致谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-12T01:09:45.727

你可以这样做：

```
class ChildModel(ModelForm):

  secretdocs = forms.ChoiceField(choices=[(doc.uid, doc.name) for doc in Document.objects.all()])
  class Meta:
      model = Documents
      fields = ('secretdocs', )
      widgets = {
          'secretdocs': Select(attrs={'class': 'select'}),
      } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T02:05:48.413

我认为这样做的“正确”方法的一部分是确保将 UUID 字段设置为相关模型的主键，并且没有自动编号 ID 字段。

例如：

```
class Document(models.Model):
    uuid = models.YourCustomUUIDField(primary_key=True,.....)
    other_field = models.CharField(.....)
    .... 
```

如果你这样做，我认为 Django 会选择 UUID 字段作为主键并在所有地方使用它。但是，如果您确实希望保留内置的自动递增主键字段并仅在此处使用 UUID，您可以执行类似于 karthikr 在需要 UUID 字段的表单中建议的操作。

# javascript - Javascript 随机引用 onclick

> ID：15960931
> 
> 赞同：1
> 
> 时间：2013-04-12T00:02:15.397
> 
> 标签：javascript, arrays, random

单击按钮时，我想显示数组中的随机引用。问题是我的代码在加载页面时没有显示第一个随机引用。换句话说，此代码有效，但要查看第一个报价，我必须按下按钮。加载浏览器时如何获得第一个随机报价？谢谢！

```
<script language="javascript">
function quotes(){

var aquote = new Array;
aquote[0]="\"Quote 1.\"";
aquote[1]="\"Quote 2.\"";
aquote[2]="\"Quote 3.\""

rdmQuote = Math.floor(Math.random()*aquote.length);
document.getElementById("txtbox") .value=aquote[rdmQuote];
}

</script> 
```

和 HTML

```
<textarea id="txtbox" style="width:600px;" readonly></textarea>

<button onClick="quotes()">Click Here</button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T00:06:43.533

利用

```
window.onload = quotes; 
```

在函数定义之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:13:18.893

**[jsfiddle 演示](http://jsfiddle.net/fuFaa/1/)**

您可以调用该`quotes`函数以获得第一个随机报价。但是，一旦函数可以访问 dom 元素，就应该这样做。因此，您将需要等待 dom 呈现，然后再尝试访问该元素。您可以通过将`onload`事件附加到`window`然后调用函数来做到这一点`quotes`。

```
function quotes(){

 var aquote = new Array;
 aquote[0]="\"Quote 1.\"";
 aquote[1]="\"Quote 2.\"";
 aquote[2]="\"Quote 3.\""

 rdmQuote = Math.floor(Math.random()*aquote.length);
 document.getElementById("txtbox") .value=aquote[rdmQuote];
}
window.onload=quotes; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T00:13:37.710

其他一些人建议将引号函数分配给事件处理程序，如 onload 或 onready。这并不总是有效，具体取决于哪些其他脚本也可能使用这些事件处理程序，以及它们是否优雅地重新定义事件处理程序或覆盖事件处理程序。

当我编写像你这样的代码，或者回答像你这样的问题时，我不确定它将在什么环境中运行，我使用 setTimeout 或在定义了必要的 textarea HTML 之后放置的另一个脚本。

如果您确保将整个脚本放在包含 textarea 的 HTML 之后，则可以使用 gdoron 的答案。

如果您不能使用事件处理程序，并且不能将脚本元素移动到使用它的 HTML 元素之后，那么您可以将此行添加到您的代码中。在实践中它应该一直有效，但理论上它可能会失败：

```
setTimeout(quotes, 500); 
```

在结束脚本标记之前添加该行，如果其他方法都不适合您，那么您应该很高兴。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T00:04:30.880

```
function quotes(){

    var aquote = new Array;
    aquote[0]="\"Quote 1.\"";
    aquote[1]="\"Quote 2.\"";
    aquote[2]="\"Quote 3.\""

    rdmQuote = Math.floor(Math.random()*aquote.length);
    document.getElementById("txtbox") .value=aquote[rdmQuote];
}

quotes(); // here call that function. just make sure the DOM is ready. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T00:04:47.453

在脚本标签中定义后调用函数quotes()。如果脚本标签出现在您尝试获取的 DOM 元素之后，那么您应该没问题。但是将它放在 $(document).ready() 块中会更安全。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-21T16:29:09.267

```
// Create an array and assign your quote urls

var quotation = new Array();

quotation[0] = "paster your quote url";
quotation[1] = "paster your quote url";
quotation[2] = "paster your quote url";
quotation[3] = "paster your quote url";

var random = Math.floor(Math.random()*(quotation.length));
function printquote(){
document.write(quotation[random]);
}

<button onclick="printquote">Get quote</button> 
```

# html - 将美国地图变成州链接

> ID：15960932
> 
> 赞同：3
> 
> 时间：2013-04-12T00:02:17.960
> 
> 标签：html, css

我可能做了一些愚蠢的事情——我很快向一个客户承诺，我可以将他们的美国地图图像变成单独的州链接——但现在我正在考虑它，即使我将每个州都作为图像，图像也会是方形的，这意味着每个图像的边缘都会有空白区域与其他状态重叠，从而使链接重叠。有没有更好的方法来做到这一点，或者任何方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:14:56.510

客户端图像映射中的链接不必是矩形；它们可以是任意多边形。因此，您可以使每个状态都可点击而不重叠，并尽可能接近其“真实”边界（取决于您的整体地图图像的高分辨率）。

逐个像素地定义这些多边形显然很乏味，因此大多数人使用为您构建 HTML 代码的程序。谷歌“图像地图编辑器”适用于您的操作系统（您不会说您使用的是 Mac 还是 PC）。 [这是一个](http://www.boutell.com/mapedit/)说它带有已经定义的美国地图！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:08:00.460

看看 [w3schools 的这个例子：](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml_areamap) 它使用 html 5

```
<img src="planets.gif" width="145" height="126" alt="Planets" usemap="#planetmap">
<map name="planetmap">
  <area shape="rect" coords="0,0,82,126" alt="Sun" href="sun.htm">
  <area shape="circle" coords="90,58,3" alt="Mercury" href="mercur.htm">
  <area shape="circle" coords="124,58,8" alt="Venus" href="venus.htm">
</map> 
```

你可以像这样创建多边形：

```
<area SHAPE='poly' HREF="new.html" ALT="New!" TITLE="New!"
COORDS="150,217, 190,257,  150,297,  110,257"> 
```

# java - 如何在这里应用 java ExecutorService 和 Executors 类

> ID：15960936
> 
> 赞同：0
> 
> 时间：2013-04-12T00:02:24.993
> 
> 标签：java, multithreading, threadpool

我想使用选项 2 中的线程池来替换选项 1 中的代码。我该如何实现？1
1\. 使用加入

```
Thread e1 = new Thread(new EventThread("e1"));
e1.start();
Thread e2 = new Thread(new EventThread("e2"));
e2.start();

 e1.join();
 e2.join();

 // from here 'main' thread continue 
```

2.使用线程池现在我想使用 ExecutorService 类做同样的工作

```
public class EventThread implements Runnable{
   public EventThread(String message){
   }
} 

ExecutorService executor = Executors.newFixedThreadPool(2);

Runnable worker = new EventThread("");
executor.execute(worker);

executor.shutdown();
while (!executor.isTerminated()) {

}
System.out.println("Finished all threads"); 
```

// 从这里'主'线程继续

这和第一个完全一样吗？还是我的代码正确？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:19:57.593

不。功能上的唯一区别是，在选项 2 中，您只有一个线程正在执行。您仍然必须向其中添加每个工作`Fixed size`线程，这只是可以同时运行的最大线程数（如果添加第三个线程，它将等到较早添加的线程之一完成后再运行它）。

此外，不推荐忙等待（带有条件的 while 循环`!executor.isTerminated()`）和不好的做法。相反，我建议使用[`executor.awaitTermination(long timeout, TimeUnit unit)`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html#awaitTermination%28long,%20java.util.concurrent.TimeUnit%29)或至少`Thread.sleep()`在循环中使用 a 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:33:50.110

在您的第一个示例中，您将运行 2 个线程，但在第二个示例中，即使您有一个包含 2 个线程的线程池，您也只提供了 1 个可运行的运行。所以不会使用池中的第二个线程。

您还可以在关机后使用[awaitTermination()](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html#awaitTermination%28long,%20java.util.concurrent.TimeUnit%29)而不是 while 循环：

```
ExecutorService executor = Executors.newFixedThreadPool(2);
for(i=0;i<2;i++){
  executor.execute(new EventThread("e"+i));
}
executor.shutdown();
try {
  executor.awaitTermination(Long.MAX_VALUE, TimeUnit.NANOSECONDS);
} catch (InterruptedException e) {
  ...
}
System.out.println("Finished all threads"); 
```

# objective-c - 使用来自 JSON 文件的 NSJSONSerialization 解析的 JSON 返回一个空数组

> ID：15960939
> 
> 赞同：0
> 
> 时间：2013-04-12T00:02:48.420
> 
> 标签：objective-c, nsjsonserialization

我有一个我正在尝试解析的 JSON 文件，如下所示

```
-(void)loadSuraNames
{
NSURL * url = [NSURL URLWithString:@"http://www.submission.ws/downloads/json/"];

url = [url URLByAppendingPathComponent:@"quran_main.json"];

NSURLRequest *request = [NSURLRequest requestWithURL:url];
NSData *response = [NSURLConnection sendSynchronousRequest:request returningResponse:nil    error:nil];

NSError *jsonParsingError = nil;
NSArray *array = [NSJSONSerialization JSONObjectWithData:response options:0 error:&jsonParsingError];

NSLog(@"my Json is empty :( %@", array);
} 
```

但我没有得到任何数据。任何人有任何想法是什么问题？

我收到以下错误：

错误域=NSCocoaErrorDomain 代码=3840“操作无法完成。（Cocoa 错误 3840。）”（字符 278 周围的转义序列无效。） UserInfo=0xa47ff60 {NSDebugDescription=字符 278 周围的转义序列无效。}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:35:34.730

JSON脚本添加了我手动删除的“/”字符，问题消失了:)

# java - 用监听器实现内部类的更好方法

> ID：15960950
> 
> 赞同：0
> 
> 时间：2013-04-12T00:04:08.593
> 
> 标签：java, swing, actionlistener, anonymous

我有一个带有内部类的主类。这是一个摆动/GUI 应用程序。

我有与摆动相关的内部类，例如扩展 JPanel、JDialog 等...

在内部类中，我有匿名类，例如我必须设置并从外部类获取数据的动作侦听器。

例如主类有内部类和内部类内部我有一个匿名侦听器类，例如：

```
public class Main extends JApplet {
 //etc...
  private class CTable extends JPanel {
      CDialog td;
      private JPopupMenu menu;
      public CTable(String title, AbstractTableModel tableModel) {
         //etc...
         menu = new JPopupMenu();
         JMenuItem menuItem = new JMenuItem("Test");
         menu.add(menuItem);
         //etc...
         menuItem.addActionListener(new ActionListener() {
           public void actionPerformed(ActionEvent event) {
              CTable.this.td = new CDialog("Test");
              CTable.this.td.setVisible(true);
           }
         });
     }

} 
```

我唯一的问题只与它是否像这样访问变量的好习惯有关：**CTable.this.td = new CDialog("Test"); CTable.this.td.setVisible(true);** ...来自匿名课程和关于不同实现策略/设计模式的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:08:20.047

我知道匿名内部类永远是 Swing 习惯用法，但我从来不喜欢它们。

就个人而言，我认为听众是控制器的一部分。我更喜欢 Swing 组件是纯视图，并让控制器实例化它们并为它们提供所需的侦听器，以便按照*控制器*的选择进行操作。不要让视图不得不担心它如何与控制器通信或它所在的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:08:47.363

```
CTable.this.td.setVisible(true); 
```

有一条规则叫做得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)。这表明您应该只直接访问类。通过跨多个对象来获得所需的方法，您正在创建类之间的[紧密耦合](http://en.wikipedia.org/wiki/Loose_coupling)，这使得将来更改单个类变得更加困难。

我建议的设计模式可能是`Proxy class`. 代理类充当两个类之间的缓冲区，这意味着两个类通过[代理类相互通信](http://en.wikipedia.org/wiki/Proxy_pattern)

# php - 如何防止在多次重新加载/刷新页面时超过 max_user_connections？

> ID：15960954
> 
> 赞同：0
> 
> 时间：2013-04-12T00:04:33.947
> 
> 标签：php, mysql

我正在使用名为 getfreehosting.co.uk 的免费网络托管服务。`max_user_connections`是 5。每次我的页面加载时，它所做的第一件事就是调用从`load.php`我的数据库中获取条目的 a。我的问题是，如果我重新加载或刷新页面太多次，我会收到以下错误：

> 警告：mysql_connect() [function.mysql-connect]：用户 getfh_11654008 在第 3 行的 /home/vol9/getfreehosting.co.uk/getfh_11654008/htdocs/experiment/load.php 中已经有超过 'max_user_connections' 的活动连接连接：用户 getfh_11654008 已经有超过 'max_user_connections' 的活动连接

我知道我使用的是免费的虚拟主机，所以我可能无法增加`max_user_connections`. 无论如何我都不应该这样做，因为我只需要在任何给定时间运行我的页面的一个实例，所以理论上`max_user_connections = 5`对于我的目的来说已经绰绰有余了。起初我认为问题一定是我`load.php`被调用了太多次，导致太多`sql_connections`没有关闭。但是，我`sql_close()`在适当的地方打电话，但仍然设法超过`max_user_connections`。

这是我的`load.php`：

```
<?php
    $link = mysql_connect(MYSQL_HOSTNAME, MY_USERNAME, MY_PASSWORD);
    if (!$link) {
        die('Could not connect: ' . mysql_error());
    }
    mysql_select_db(MY_DB, $link);

    $result = mysql_query(SELECT ONE ENTRY);
    if($r = mysql_fetch_assoc($result)) {
        print json_encode($r); // convert data to json and return it
        mysql_close($link);
    }
    else {
        mysql_close($link);
        die("Error: something went wrong");
    }
?> 
```

出了什么问题，我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T00:52:59.773

* * *

## 回答：

您可以研究两件事：

1.  mysql_close() - 系统可能正在等待几秒钟来关闭连接，因为你没有告诉它。（即：计算机不会立即关门，直到你告诉它或直到一切都说完之后）。

$connection = mysql_connect(); mysql_close($连接);

连接时确保使用变量...

1.  你可以试试php的mysql持久连接。本质上是一个与数据库的永久连接......这并不理想，但它也可以工作。它的语法与 mysql_connect() 几乎相同：

$connection = mysql_pconnect("localhost","mysql_user","mysql_pwd");

* * *

## 中学：

如果您有兴趣，我可以为您提供更好的 php/mysql 开发环境（免费，没有任何义务）... 100% 您的选择，只是想帮助您。

* * *

## 咆哮：

我不明白为什么这里的人们坚持告诉别人使用 PDO，但不帮助解决问题......人们将使用他们想要使用的任何东西，直到他们学会了更好的方法。击败 PDO 马不会让人们更快地采用它......

# c - long long 是 8 个字节，但我得到整数溢出？

> ID：15960955
> 
> 赞同：12
> 
> 时间：2013-04-12T00:04:42.880
> 
> 标签：c, gcc, integer, literals, integer-overflow

认为

```
 long long b = 5*1024*1024*1024; // 5 gigs, small enough for 64 bits
  printf ("%lu\n",sizeof(long long)); // prints 8 (bytes) = 64 bits 
```

但编译器抱怨：

```
 warning: integer overflow in expression [-Woverflow] 
```

为什么它会溢出，我错过了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-12T00:05:59.930

因为右边的数字是 类型`int`，不是`long long`，所以`int`在表达式中进行算术运算，导致溢出。

如果您添加`LL`到其中之一，它将促进它们全部。

# objective-c - 从 Cocos2D 调用方法

> ID：15960961
> 
> 赞同：0
> 
> 时间：2013-04-12T00:04:54.983
> 
> 标签：objective-c, cocos2d-iphone

我在 Mac 上玩 Cocos2D。

我正在使用带有 NSColorWell 按钮的 IntefaceBuilder。我的 AppDelegate 具有 IBAction 以在名为 Settings 的 Singleton 中设置背景颜色。然后我希望它调用 AnimationLayer 的方法`updateBackgroundColor`来更新它。但它失败并崩溃。

为什么我不能向 AnimationLayer 方法发送消息？

由于 AppDelegate 已经知道 AnimationLayer 这不是调用方法的正确方法吗？`[(AnimationLayer*) self methodNameHere];`

**AppDeletgate.m**

```
- (IBAction)colorwellBackground:(id)sender {
    [mySettings setBackgroundColor:[sender color]];
    [(AnimationLayer*) self updateBackgroundColor];
} 
```

**动画层.m**

```
// Import the interfaces
#import "AnimationLayer.h"

// HelloWorldLayer implementation
@implementation AnimationLayer

+(CCScene *) scene {

    CCScene *scene = [CCScene node];
    AnimationLayer *layer = [AnimationLayer node];
    [scene addChild: layer];
    return scene;
}

// on "init" you need to initialize your instance
-(id) init {

    if( (self=[super init]) ) {

        mySettings = [Settings sharedSettings]; 

        //DEFAULT BACKGROUND COLOR
        _backgroundColorLayer = [mySettings returnBackgroundColor];
        [self addChild:_backgroundColorLayer];

    }
    return self;
}
- (void) updateBackgroundColor{
    NSLog(@"UPDATE BACKGROUND COLOR %@", [mySettings returnBackgroundColor]);
    [_backgroundColorLayer setColor:[mySettings returnBackgroundColor]];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T11:40:20.437

首先，如果您的应用程序崩溃，您总是可以在控制台中看到崩溃原因。始终将此消息添加到您的“为什么会崩溃”问题中。实际上，很有可能在阅读此消息后，您将能够自己解决问题。

我假设您的崩溃消息类似于“尝试从 appdelegate 实例调用未知方法 updateBackgroundColor”。在您的 AppDelegate 类中，self 指向 AppDelegate 实例，而不是您的层。如果您想从您的应用程序委托中调用此方法（这对我来说实际上很奇怪），那么您必须以某种方式获取动画层的当前实例。

# vba - Excel VBA。如何检查是否在工作簿中的任何地方调用了子（例如什么按钮）

> ID：15960962
> 
> 赞同：1
> 
> 时间：2013-04-12T00:05:14.073
> 
> 标签：vba, excel

您如何检查从哪里调用 Excel VBA Sub？按 CTRL+F 很容易找到代码中可能调用它的位置，但假设有一个隐藏的隐藏按钮调用 Sub。你怎么知道的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:48:59.850

请安装插件**[mztools](http://www.mztools.com/v3/mztools3.aspx)**。它有一个选项**Procedure Callers**，它列出了调用该过程的所有位置。

下图显示了过程 a 的所有过程调用者。 ![在此处输入图像描述](https://i.stack.imgur.com/wBWr8.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T06:44:50.637

即使您在 IDE 中使用 CTRL+F 也不会发现标准表单按钮设置为运行该宏的情况`on action`。此外，您的工作簿中的任何形状都可以`on action`设置为您的子。然后，您需要检查每一个。但是如果你需要在编译过程中检查这种情况，你可以使用类似的东西：

```
Debug.Print Application.Caller 
```

如果您的 sub 将从标准按钮开始，那么您将获得信息`Button 1`，或者`shape name`是否从任何其他形状开始。**重要的！**如果您在从其他子调用您的子时使用该检查语法，则您将需要错误处理过程。

对于其他检查 Santosh 的想法，你的，最后你可以编写一些代码来搜索所有模块以找到你的子并列出它。

# javascript - 通过 Ajax 将 XML 文档中的 HTML 节点注入 HTML 文档

> ID：15960970
> 
> 赞同：0
> 
> 时间：2013-04-12T00:07:07.047
> 
> 标签：javascript, html, xml, ajax

在发出一个 Ajax 请求后，我收到 XML 作为响应，有一个已经像 HTML 一样预先格式化的 XML。我只想从 XML 中获取一个节点并将其注入 DOM。响应中还有其他纯 XML 节点。XML 或多或少可能看起来像。

```
 <xml>
      <div id="foo">
          <div id='foo'>...
              <img src="foo.jpg"/>
          </div>
      </div>
      <node></node>
      <node></node>
      <node></node>
      <node></node>
    </xml> 
```

因此，如果我想获取 div 节点并将其注入 DOM，我可以使用类似

```
 var e = this.responseXML.getElementById('foo');
    $('#container').html(e); 
```

问题是当 html 被注入时，图像无论如何都不会下载。如果我使用 responTEXT，图像会下载，但我会得到所有其他我不想要的 XML。

有谁知道注入时没有下载图像的主要原因？或者如何让他们这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T19:07:07.650

好的，想出了解决这个问题的最佳方法。我无法让 responseXML 以我想要的 jQuery 方式运行。我能够使用 XUIjs，但它以不同的方式处理对象，并且需要不同的选择器包装并从对象数组中提取项目。我找到的最佳解决方案是使用 responseText，它似乎被视为 HTML。

```
 var e = this.responseText;
   $('#container').html(e.find("#items")); 
```

这可以很好地加载并导致图像按预期被请求。

# javascript - JavaScript：如何在以后进行提示

> ID：15960972
> 
> 赞同：0
> 
> 时间：2013-04-12T00:07:44.930
> 
> 标签：javascript

这是一个非常基本的问题，但是如何在网页加载后稍后出现提示？我的提示代码如下所示：

```
<html>
    <body>
        <script type="text/javascript">
            window.prompt("Prompt Here!")
        </script>
    </body>
</html> 
```

我可以用什么让文件在一段时间后执行提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:08:49.550

您将使用[setTimeout()](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)。

```
setTimeout(function() {
    window.prompt("Prompt Here!");
}, 1000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:10:04.787

```
document.body.onload = function(){
    window.prompt("Prompt Here!");
}); 
```

或者：

```
<body onload="window.prompt('Prompt Here!');"> 
```

# facebook - FQL 流返回的结果少于 FQL 状态

> ID：15960976
> 
> 赞同：1
> 
> 时间：2013-04-12T00:08:26.330
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我正在使用两个查询来测试结果，这些查询试图根据消息中的文本查找我的朋友发布的内容。第一个查询：

```
select uid, status_id, message, time, source FROM status where uid in (SELECT uid2 FROM friend WHERE uid1 = me()) AND (strpos(lower(message),"father") >=0 ); 
```

返回我想要的结果，工作正常。然而，第二个查询应该更开放，因为它使用流，但什么也得不到。

```
SELECT type, created_time, post_id, comments, actor_id, target_id, message FROM stream WHERE filter_key IN (SELECT filter_key FROM stream_filter WHERE uid = me()) AND actor_id IN (SELECT uid2 FROM friend WHERE uid1 = me()) AND (strpos(lower(message),"father") >=0 ); 
```

为什么流只返回状态？我错过了什么吗？

# php - javascript 和 MySQL 表

> ID：15960978
> 
> 赞同：0
> 
> 时间：2013-04-12T00:08:44.580
> 
> 标签：php, javascript, mysql

好的..我正在为我的部门设计一个网络应用程序，讲师可以在其中输入他/她正在学习的课程的结果。我已经使用 java-script 表成功创建了接口；之后，我希望将表的内容发布到我使用 MySQL 设计的数据库中

关于如何做到这一点的任何想法！

这是javascript代码片段

```
<script type="text/JavaScript">

function addRowToTable()
{
var tbl = document.getElementById('tblResultSample');
var lastRow = tbl.rows.length;
// if there's no header row in the table, then iteration = lastRow + 1

var iteration = lastRow;
var row = tbl.insertRow(lastRow);

// left cell
var cellLeft = row.insertCell(0);
var textNode = document.createTextNode(iteration);
cellLeft.appendChild(textNode);

// right cell
var cellRight = row.insertCell(1);
var el = document.createElement('input');
el.type = 'text';
el.name = 'Student_ID' + iteration;
el.id = 'Student_ID' + iteration;

el.size = 30;

el.onkeypress= keyPressTest;
cellRight.appendChild(el);  

//CA cell
var caCell = row.insertCell(2);
var el1 = document.createElement('input');
el1.type = 'text';
el1.name = 'caScore' + iteration;
el1.id = 'caScore' + iteration;
el1.size = 5;
el1.onchange= fncSum;

el1.onkeypress= keyPressTest;
caCell.appendChild(el1);

//Exam cell
var examCell = row.insertCell(3);
var el2 = document.createElement('input');
el2.type = 'text';
el2.name = 'examScore' + iteration;
el2.id = 'examScore' + iteration;
el2.size = 7;
el2.onchange= fncSum;
el2.onkeypress= keyPressTest;
examCell.appendChild(el2);

//total cell
var totalCell = row.insertCell(4);
var el3 = document.createElement('input');
el3.type = 'text';
el3.name = 'totalScore' + iteration;
el3.id = 'totalScore' + iteration;

el3.size = 7;

el3.onkeypress= keyPressTest;
totalCell.appendChild(el3);

//grade cell
var gradeCell = row.insertCell(5);
var el5 = document.createElement('input');
el5.type = 'text';
el5.name = 'gradeScore' + iteration;
el5.id = 'gradeScore' + iteration;
//  el5.onchange=changeValue;
el5.size = 7;
el5.onkeypress= keyPressTest;
gradeCell.appendChild(el5);

//gpp cell
var gppCell = row.insertCell(6);
var el4 = document.createElement('input');
el4.type = 'text';
el4.name = 'gppScore' + iteration;
el4.id = 'gppScore' + iteration;
el4.size = 7;

el4.onkeypress= keyPressTest;
gppCell.appendChild(el4);

}

function keyPressTest(e, obj)
{
var validateChkb=document.getElementById('chkValidateOnKeyPress');
if(validateChkb.checked){
    var displayObj=document.getElementById('spanOutput');
    var key;
    if(window.event){
        key=window.event.keyCode;
    }
    else if(e.which) {
        key=e.which;
    }
    var objId;
    if(obj != null){
        objId=obj.id;
    }else{
        objId=this.id;
    }
    displayObj.innerHTML= objId+ ' : ' + String.fromCharCode(key);
}
 }

 function removeRowFromTable()
 {
 var tbl = document.getElementById('tblResultSample');
 var lastRow = tbl.rows.length;
 if (lastRow > 2) tbl.deleteRow(lastRow - 1);
}

//takes the values of C.a and Exam to calculate total score
 function fncSum()
{

 var tbl = document.getElementById('tblResultSample');
 var lastRow = tbl.rows.length;
 // if there's no header row in the table, then iteration = lastRow + 1
 var i = lastRow;

    for(i=1; i<=lastRow; i++) {
     if(isNaN(document.getElementById('caScore'+i).value))
     {
        alert('(CA Score)Please input Number only.');
        document.getElementById('caScore'+i).focus();
        return;
     }

     if(isNaN(document.getElementById('examScore'+i).value))
     {
        alert('(Exam Score required Please input Number only.');
        document.getElementById('examScore'+i).focus();
        return;
     }

   document.getElementById('totalScore'+i).value=   parseFloat(document.getElementById('caScore'+i).value) + parseFloat(document.getElementById('examScore'+i).value);

var crsUnit= parseFloat(document.getElementById('cUnit').value);

if(document.getElementById('totalScore'+i).value >=70)
{ 
document.getElementById('gradeScore'+i).value= 'A';
document.getElementById('gppScore'+i).value= 5* crsUnit;
}

if(document.getElementById('totalScore'+i).value >=65 &&   document.getElementById('totalScore'+i).value <70)
 { 
 document.getElementById('gradeScore'+i).value= 'B+';
 document.getElementById('gppScore'+i).value= 4.5* crsUnit;
 }

if(document.getElementById('totalScore'+i).value >=60 &&  document.getElementById('totalScore'+i).value <65)
 { 
 document.getElementById('gradeScore'+i).value= 'B';
 document.getElementById('gppScore'+i).value= 4* crsUnit;
}

 if(document.getElementById('totalScore'+i).value >=55 && document.getElementById('totalScore'+i).value <60)
{ 
 document.getElementById('gradeScore'+i).value= 'C+';
document.getElementById('gppScore'+i).value= 3.5* crsUnit;
}

 if(document.getElementById('totalScore'+i).value >=50 && document.getElementById('totalScore'+i).value <55)
{ 
document.getElementById('gradeScore'+i).value= 'C';
document.getElementById('gppScore'+i).value= 3* crsUnit;
}

if(document.getElementById('totalScore'+i).value >=45 &&   document.getElementById('totalScore'+i).value <50)
{ 
document.getElementById('gradeScore'+i).value= 'D';
document.getElementById('gppScore'+i).value= 2* crsUnit;
}

if(document.getElementById('totalScore'+i).value >=40 && document.getElementById('totalScore'+i).value <45)
{ 
document.getElementById('gradeScore'+i).value= 'E';
document.getElementById('gppScore'+i).value= 1* crsUnit;
}

else if(document.getElementById('totalScore'+i).value <40)
{ 
document.getElementById('gradeScore'+i).value= 'F';
document.getElementById('gppScore'+i).value= 0* crsUnit;
}   

    }
}

function validateRow()
{
var chkb=document.getElementById('chkValidate');
if (chkb.checked){
    var tbl=document.getElementById('tblResultSample');
    var lastRow=tbl.rows.length - 1; //returns the number of rows in the table
    var i;

    for(i=1; i<=lastRow; i++) {
        var aRow= document.getElementById('Student_ID'+i);

        if(aRow.value.length <= 0) {
            alert('Student ID '+i+' is empty');
            aRow.focus();
            return;
        }

        var caCell=parseInt(document.getElementById('caScore'+i).value);

            if(isNaN(caCell))
            {
                alert('CA for Student ID '+i+' is not valid');
                document.getElementById('caScore'+i).focus();
                return;
            }

                else if(caCell>30)
                {
                    alert('CA for Student ID '+i+' is above  30'); 
document.getElementById('caScore'+i).focus();
                    return;
                    }

var examCell=parseInt(document.getElementById('examScore'+i).value);
if(isNaN(examCell))
{
alert('Exam Score for Student ID '+i+' is not valid');
return;
}

else if(examCell>70)
{
alert('Exam for Student ID '+i+' is above 70'); 
return;
}

}

}       

else {
alert('Please ensure you check the validate Entry before submitting the result');
}
}

</script> 
```

为他/她的学生输入成绩后；然后将动态表的内容发布到 MySQL 表中。这是生成的表应该是这样的......

```
idNumber    Marks   Grade   Gpp     
06/05/02/001    39  F   0   
    06/05/02/001    46  D   4   
    06/05/02/001    56  C+  7   
    06/05/02/001    78  A   5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:19:40.267

“我已经使用 java-script 表成功创建了接口；” 不，您的表格是由 Javascript 生成的 HTML 表格。完全不一样。

您可以使用 AJAX 或表单发布您的数据。阅读[此](https://en.wikipedia.org/wiki/Ajax_%28programming%29)内容和[此](http://php.net/manual/en/tutorial.forms.php)内容以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:45:54.753

您需要遵循几个步骤-

*   建立表格后，在 javascript 中编写一个方法，该方法采用此表格元素并返回一个 JSON 对象，该对象将被发送回您的服务器。简单的 JS 代码将在这里展开。

*   您将收到您在 PHP 脚本中发布的数据。使用此[示例 PHP 代码进行 DB 交互](https://stackoverflow.com/questions/15912320/javascript-how-to-insert-data-into-mysql/15912725#15912725)。将您的数据存储到 mySql 表中。

# java - 使用 Popen 运行 Java 应用程序

> ID：15960983
> 
> 赞同：0
> 
> 时间：2013-04-12T00:09:07.780
> 
> 标签：java, python, linux, apache-tika

我在我的 Linux 服务器上运行 tika，我想使用 python (subprocess.Popen) 运行它

但是，我有一个非 root 访问权限，所以我只有一个本地 java 安装。每次我需要为每个会话设置 java home 和路径时：

> 导出 JAVA_HOME=/usr/java/jdk1.5.0_07/bin/java
> 
> 导出 PATH=$PATH:/usr/java/jdk1.5.0_07/bin

然后我可以从 java 目录运行 tika 并将输出保存到某个文件`out_txt.txt`

> 卷曲 www.vit.org/downloads/doc/tariff.doc | java -jar tika-app-1.3.jar --text >out_txt.txt

所以，我需要知道如何使用 Popen 来：

1.  使用 Popen 设置 java 主目录和路径
2.  将 Tika 输出写入文件`out_txt.txt`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:29:03.130

1）你可以：

*   使用`os.setenv('JAVA_HOME', '/usr/java/jdk1.5.0_07')`before `Popen`，这将为所有未来调用设置环境变量。或为`PATH`：

    ```
    os.environ['PATH'] += ":/usr/java/jdk1.5.0_07" 
    ```

*   将环境字典传递给`Popen`as [`env`](http://docs.python.org/2/library/subprocess#popen-constructor)：

    ```
    environ = os.environ.copy()
    environ['JAVA_HOME'] = '/usr/java/jdk1.5.0_07'
    environ['PATH'] += ':/usr/java/jdk1.5.0_07/bin'
    subprocess.Popen(args, env=environ) 
    ```

2)

*   打开文件进行写入并将其传递给`Popen`as `stdout`（和可选`stderr`）：

    ```
    output = open(outfile, 'wb')
    subprocess.Popen(args, stdout=output, stderr=output) 
    ```

*   `shell=True`通过传递给外壳将其留给`Popen`：

    ```
    Popen("curl www.vit.org/downloads/doc/tariff.doc | java -jar tika-app-1.3.jar --text >out_txt.txt", shell=True) 
    ```

# view - 如何从 Zend Framework 2 中的视图脚本获取当前模块/控制器/动作？

> ID：15960987
> 
> 赞同：0
> 
> 时间：2013-04-12T00:09:37.883
> 
> 标签：view, module, controller, action, zend-framework2

是否可以从视图脚本中获取当前模块/控制器/操作名称？我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T01:21:15.010

您可以使用 MvcEvent 对象在控制器中检索它，然后将其分配给 ViewModel，以便您可以在视图中检索它：

```
public function indexAction()
{
   return new ViewModel(
            array(
                'controller' => $this->getEvent()->getRouteMatch()->getParam('controller'),
                'action' => $this->getEvent()->getRouteMatch()->getParam('action')
            )
        );
} 
```

模块名称有点棘手，但您可以例如使用**NAMESPACE**获取它，或者只是从控制器名称中解析它。

如果您想在多个视图中使用它，那么创建和注册您自己的视图助手可能会更好。

# mysql - 有关按特定顺序选择 3 行的 SQL 帮助

> ID：15960993
> 
> 赞同：0
> 
> 时间：2013-04-12T00:10:12.163
> 
> 标签：mysql, sql

我正在尝试运行一个始终返回 2 或 3 行的 SQL 查询；当返回 3 时，必须像这样对它们进行排序：team1，draw，team2

所以基本上如果“draw”在列表中，那么它应该总是放在另外两行之间，不管它们是什么，假设团队的名称和draw在“title”列中

我试过订购`CASE WHEN title = 'draw' THEN 1`，也试过`FIELD()`- 不走运:(

有人可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T00:18:23.883

尝试这个：

```
ORDER BY (IF(title='team1', 1, IF(title='team2', 3, 2))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:29:54.273

团队与结果不同。我相信你不应该解决你的问题。相反，创建三个表：Teams、Results 和 ResultTypes。在 ResultTypes 中存储两个团队之间的任何可能结果。在 Teams 中，存储团队、他们的姓名和任何相关数据。最后，在结果中存储 3 个外键。其中两个应引用 Teams 表，一个应引用 ResultTypes 表。这样，您将永远不会遇到从数据库中选择数据的问题。

# php - 如果某些页面返回 404，则使用 .htaccess 限制对目录的访问

> ID：15960994
> 
> 赞同：0
> 
> 时间：2013-04-12T00:10:13.663
> 
> 标签：php, apache, .htaccess, http-headers

我试图拒绝访问整个目录，除非文件（无论它在哪里）返回 200 状态。这需要写在我的 .htaccess 文件中。我知道这不是有效的 .htaccess 语法，除了`deny from all`部分之外，我只是在展示我的概念。

```
if(external-page.php returns anything but 200 header)
{
    # deny the current directory
    deny from all
} 
```

**external-page.php**将运行一个脚本来检查用户是否具有有效的凭据。如果他们这样做，它将加载状态为 200 的页面。如果他们不是有效用户，它将返回 404 状态。

.htaccess 文件位于我要拒绝的目录中，但是，我要检查其状态的脚本不在该目录中。

提前致谢。

**更新：**因为似乎有些混乱。我在下面列出了我的目录结构：

```
DIRECTORY_A/
    DIRECTORY_B/
        .HTACESS
        FILE_1.PHP
        FILE_2.PHP
        FILE_3.PHP
    FILE_A.PHP 
```

基于这个目录结构，我想要做的是......如果`FILE_A.PHP`返回 404（或者它可以返回任何东西，只要我可以检查它）。然后我想拒绝所有访问`DIRECTORY_B`. 如果`FILE_A.PHP`返回 200（或 true，或者我可以检查的任何内容），那么我想允许访问`DIRECTORY_B`

如果使用 .htaccess 不是实现此目的的最佳方法，那么我愿意接受另一种方法。但是，我被限制将代码放入`FILE_1.PHP`and`FILE_2.PHP`和`FILE_1.PHP`... 这就是为什么我要限制对整个`DIRECTORY_B`目录的访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T00:12:55.797

你不能做这种依赖 .htaccess is not a script

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T00:28:11.860

做你想做的事情的通常方法是拥有一个包含在所有 PHP 文件中的身份验证 php 脚本并检查会话。当您在另一个中包含一个 PHP 文件时，它会被执行。

因此，FILE_A.php 将具有身份验证代码，并被 FILE_1.php、FILE-2.php、FILE_3.php 包含。

您不需要 .htaccess，因为您可以直接从 PHP 设置标题（例如禁止）。

*   例如 header('HTTP/1.1 403 Forbidden');

看：

*   [php 身份验证最佳实践...？](https://stackoverflow.com/questions/7966848/php-authentication-best-practice)
*   [http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL](http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL)
*   [http://dhost.info/forums/index.php?topic=11676.0](http://dhost.info/forums/index.php?topic=11676.0)

只是为了好玩，尽管您可以执行以下操作：

*   在 FILE_A.php 中进行身份验证并根据结果设置标头。
*   从其他 php 文件中包含 FILE_A.PHP。
*   在其他文件中使用 var_dump(http_response_code()) 来检测 FILE_A.php 设置的标头并显示不同的输出。

# objective-c - 返回块的方法

> ID：15960997
> 
> 赞同：0
> 
> 时间：2013-04-12T00:10:27.877
> 
> 标签：objective-c, xcode, macos, cocoa, objective-c-blocks

有什么方法可以让我们有一个返回 Block 的方法？我有两个活动对象，我必须向它们发送相同的完成块。在完成块中，我也使用了对 MyTester 对象的引用。我只想将块代码放在一个地方，以便如果它有任何更改，它可以在一个地方本身进行更改。

```
__block MyTester *aBlockSelf = self;
self.myActivity1.completionBlock = ^(NSDictionary *iData) {
                if (([[iData valueForKey:@"value"] length] > 0)) {
                    [aBlockSelf handleThis:iData];
                } else {
                    // Some Logic
                }

                // Some Logic
            };

self.myActivity2.completionBlock = ^(NSDictionary *iData) {
                if (([[iData valueForKey:@"value"] length] > 0)) {
                    [aBlockSelf handleThis:iData];
                } else {
                    // Some Logic
                }

                // Some Logic
            }; 
```