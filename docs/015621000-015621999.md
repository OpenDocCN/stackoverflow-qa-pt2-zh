# StackOverflow 问答 15621000-15621999

# asp.net - 如何在仍然分页的同时查看使用 OData/web api 的总匹配请求？

> ID：15621003
> 
> 赞同：1
> 
> 时间：2013-03-25T17:24:04.733
> 
> 标签：asp.net, asp.net-mvc, asp.net-web-api, odata

当利用托管在不同服务器上的 Web Api 端点时，进行分页以避免过度序列化和反序列化同时仍然能够查看在 Get 请求中找到的匹配总数的最佳方法是什么？

**网络接口：**

```
[Queryable]
public IQueryable<Customer> Get(string input) {
    return _repo.GetCustomers(input).AsQueryable();
} 
```

**控制器代码：**

```
HttpResponseMessage response = client.GetAsync("api/customer?input=test&$top=2&$skip=0").Result; // test string
if (response.IsSuccessStatusCode) {
    CustomerSearchResultViewModel resultViewModel = new CustomerSearchResultViewModel();
    resultViewModel.Customers = response.Content.ReadAsAsync<IEnumerable<Customer>>().Result.ToList();
    resultViewModel.TotalResults = resultViewModel.Customers.Count;
} 
```

在此示例中，TotalResults 的上限为 2，而不是返回分页前找到的匹配总数。

有没有办法通过利用 OData 来获得总结果？如果这不可能，我怎样才能在获得所需数量的同时最好地保留 OData 功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T16:19:52.870

您可以使用 OData [$inlinecount](http://www.odata.org/documentation/odata-v3-documentation/odata-core/#10236_The_inlinecount_System_Query_Option)选项。请求看起来像 `api/customer?input=test&$top=2&$skip=0&$inlinecount=allpages`.

现在，我们不支持使用开箱即用的默认 json 和 xml 格式化程序发送 count 的值。您的客户端代码是我们决定默认不发送它的最佳示例。原因是客户端不知道如何处理额外的计数属性。我们的 OData 格式化程序默认支持 $inlinecount 选项，因为 OData 格式对计数值适合响应的位置有明确的规则。

也就是说，您可以做一个简单的更改来支持您的回复中的计数。您的客户端代码也必须更改。有关详细信息，请参阅此[答案](https://stackoverflow.com/questions/15422831/web-api-odata-inlinecount-not-working/15422935#15422935)。

# variables - Powershell花括号和未解析的变量

> ID：15621007
> 
> 赞同：1
> 
> 时间：2013-03-25T17:24:12.887
> 
> 标签：variables, powershell, curly-braces, curly-brackets

我正在尝试使用 powershell 批量更新大量分发列表，到目前为止我已经写了这个：

```
foreach ($Item in @(Import-Csv -Path "ranks.csv")) {
$Rank = $Item.Rank
Set-DynamicDistributionGroup -Identity "$Rank" -DisplayName "$Rank (NC)" -Name "$Rank (NC)" -RecipientFilter {(RecipientType -eq "UserMailbox") -and (Title -eq "$Rank") -and (Company -eq "Company")}
} 
```

Exchange 命令是正确的，除了**(Title -eq "$Rank")**部分不解析变量并且只是像这样发送它之外，一切正常：

```
(RecipientType -eq 'UserMailbox') -and (Title -eq '$Rank') -and (Company -eq 'Company') 
```

我猜这与 RecipientFilter 的过滤器位于花括号内有关，但不知道如何阻止这种情况发生。

任何帮助将不胜感激，因为我不想手动更新数百个列表！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:39:16.233

如果您使用可扩展字符串创建过滤器脚本块，它是否有效？

```
foreach ($Item in @(Import-Csv -Path "ranks.csv")) {
$Rank = $Item.Rank
$filter = [scriptblock]::create("(RecipientType -eq 'UserMailbox') -and (Title -eq '$Rank') -and (Company -eq 'Company')")
Set-DynamicDistributionGroup -Identity "$Rank" -DisplayName "$Rank (NC)" -Name "$Rank (NC)" -RecipientFilter $filter
} 
```

# c#-4.0 - 使用 MEF，每个应用程序最多只允许 2 个实例

> ID：15621009
> 
> 赞同：1
> 
> 时间：2013-03-25T17:24:25.443
> 
> 标签：c#-4.0, inversion-of-control, mef

我在我的应用程序中使用 MEF 作为 IOC。我发现自己陷入了这样一种情况，即我的应用程序中的一个类一次只需要两个实例（跨所有线程）。我认为只需使用不同的容器名称添加两次导出属性，然后使用该容器名称创建两个实例就很容易了。

```
[Export("Condition-1",typeof(MyClass)]
[Export("Condition-2",typeof(MyClass)]
[PartCreationPolicy(System.ComponentModel.Composition.CreationPolicy.Shared)]
public class MyClass  {   } 
```

然后将它们导出为

```
Container.GetExport<MyClass>("Condition-1").Value
Container.GetExport<MyClass>("Condition-2").Value 
```

但是这个技巧没有奏效。我终于能够通过使用 CompsositionBatch 解决我的问题

```
cb.AddExportedValue<MyClass>("Condition-1",new MyClass());
cb.AddExportedValue<MyClass>("Condition-2",new MyClass()); 
```

但我的问题是，为什么我不能根据合同名称获得不同的实例。如果 CreationPolicy 是共享的，合同名称是否无关紧要？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T09:19:03.070

The problem is in the setup of `PartCreationPolicyAttribute` that decorates `MyClass`.

CreationPolicy.Shared means that a single instance will be returned for each call to `Container.GetExport`. It is like a singleton. What you need in your case is the CreationPolicy.NonShared policy which will return a different instance for each clla to `Container.GetExport`.

Here's a good article on [Part Creation Policy](http://blogs.microsoft.co.il/blogs/bnaya/archive/2010/01/09/mef-for-beginner-part-creation-policy-part-6.aspx). Also have a look at [ExportFactory in MEF 2](http://blogs.msdn.com/b/bclteam/archive/2011/11/17/exportfactory-amp-lt-t-amp-gt-in-mef-2-alok.aspx?Redirected=true) for MEF2 additions regarding the lifetime and sharing of parts

# python - 按功能字段排序 OpenERP 表

> ID：15621013
> 
> 赞同：3
> 
> 时间：2013-03-25T17:24:34.330
> 
> 标签：python, openerp

在搜索屏幕上，用户可以通过单击列标题对结果进行排序。不幸的是，这不适用于所有列。它适用于存储在表本身的名称和价格等常规字段。通过加入引用的表并使用该表的默认排序顺序，它也适用于多对一字段。

不起作用的是大多数功能领域和相关领域。（相关字段是一种功能字段。）当您单击该列时，它会忽略您。如果您更改要存储在数据库中的字段定义，那么您可以按它进行排序，但这有必要吗？有没有办法在不将其值存储在数据库中的情况下按功能字段进行排序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T17:24:34.330

显然已经对此进行了一些讨论，CampToCamp 发布了一个带有通用解决方案的[合并提案。](https://bugs.launchpad.net/openobject-server/+bug/629332)[他们的博客](http://www.camptocamp.com/actualite/sort-and-filter-options-for-function-fields-in-openerp/)中也有一些讨论。

我还没有尝试过他们的解决方案，但我确实通过覆盖该`_generate_order_by()`方法为一个字段创建了一个特定的解决方案。每当用户单击列标题时，都会`_generate_order_by()`尝试生成适当的`ORDER BY`子句。我发现您实际上可以在`ORDER BY`子句中放置一个 SQL 子查询来重现功能字段的值。

例如，我们添加了一个[功能字段](http://bazaar.launchpad.net/~zaber/openobject-addons/zaber-custom/view/109/zaber_custom/product.py#L67)来显示每个产品的第一个供应商名称。

```
def _product_supplier_name(self, cr, uid, ids, name, arg, context=None):
    res = {}
    for product in self.browse(cr, uid, ids, context):
        supplier_name = ""
        if len(product.seller_ids) > 0:
            supplier_name = product.seller_ids[0].name.name
        res[product.id] = supplier_name
    return res 
```

为了按该列排序，我们用一些非常时髦的 SQL[覆盖。`_generate_order_by()`](http://bazaar.launchpad.net/~zaber/openobject-addons/zaber-custom/view/109/zaber_custom/product.py#L205)对于任何其他列，我们委托给常规代码。

```
def _generate_order_by(self, order_spec, query):
    """ Calculate the order by clause to use in SQL based on a set of
    model fields. """
    if order_spec != 'default_partner_name':
        return super(product_product, self)._generate_order_by(order_spec,
                                                               query)
    return """
        ORDER BY
        (
        select  min(supp.name)
        from    product_supplierinfo supinf
        join    res_partner supp
        on      supinf.name = supp.id
        where   supinf.product_id = product_product.id
        ),
        product_product.default_code
        """ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T08:35:39.290

存储该字段的原因是您将排序委托给 sql，这肯定比任何其他后续排序都具有更高的性能。

# javascript - 在 html 页面之间传递 javascript 对象

> ID：15621015
> 
> 赞同：0
> 
> 时间：2013-03-25T17:24:37.147
> 
> 标签：javascript, oop, object

我在 javascript 中创建了一个类，其中包含一个包含变量和函数的对象。我在一个 .html 页面中实例化该对象，但是当我更改为另一个 .html 页面时，该对象似乎是“空的”。如何将一个页面之间的对象传递到另一个页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:33:28.660

你可以看看[Web Storage](http://www.whatwg.org/specs/web-apps/current-work/multipage/webstorage.html#webstorage)。这将不允许您存储完整的 JavaScript 对象，但是您将能够存储任意数量的字符串名称-值对。永久（在浏览器重新启动之间）或作为会话的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:36:08.040

使用 localStorage，检查这个库： [https ://github.com/marcuswestin/store.js](https://github.com/marcuswestin/store.js)

您可以执行以下操作：

```
store.set('foo', originalObject); 
```

接着...

```
var restoredObject = store.get('foo'); 
```

删除存储的对象：

```
store.remove('foo'); 
```

分叉“类 jQuery”语法： http: [//pastebin.com/x3KpKyr1](http://pastebin.com/x3KpKyr1)

# spring - 如果使用 Spring 而不使用 EJB，Glassfish 是否过大？

> ID：15621020
> 
> 赞同：1
> 
> 时间：2013-03-25T17:24:51.847
> 
> 标签：spring, tomcat, spring-mvc, glassfish, facelets

简而言之，我试图在不使用 EJB 的基于 Spring 的 Web 应用程序的场景中评估 Glassfish 是否提供了 Tomcat 没有的任何特性，这是否值得使用。换句话说，如果我使用 Spring 安全性、事务管理以及 MVC（想使用 Facelets 但又一次，Spring Web Flow 提供 Facelet 支持），而不是 Glassfish 的任何容器管理功能不能在 Tomcat 中发现，与更简单的 Tomcat 平台相比，使用 Glassfish 有什么优势，它们是什么？此外，在任何情况下，混合 Spring MVC 和 JSF 是否有意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T11:57:11.033

[这个链接](http://www.wikivs.com/wiki/GlassFish_vs_Tomcat)很老了，但可能会有所帮助。

就个人而言，我坚信不要使用具有我永远不会使用的功能的应用程序服务器，并且由于过去的 EJB 经验对我来说仍然有一种可怕的味道，我不认为自己愿意再次使用它们，所以我个人不会考虑 Glassfish，因为 Tomcat 拥有我需要的一切。如果您只需要添加管理工具，那里有很多商业级 Tomcat 产品，例如 SpringSource 的[tcServer](http://www.vmware.com/products/application-platform/vfabric-tcserver/overview.html)（我个人使用过，我非常喜欢）或 MuleSoft 的[Tcat](http://www.mulesoft.com/tomcat-admin)。ReHat 曾经也有一些企业级的 Tomcat 产品，但产品名称现在让我忘记了。

# heroku - PG::Error: 错误：Heroku 内存不足

> ID：15621023
> 
> 赞同：10
> 
> 时间：2013-03-25T17:25:02.130
> 
> 标签：heroku

我在 Heroku 上部署了一个应用程序。我正在使用免费服务。

我经常收到以下错误。

```
PG::Error: ERROR:  out of memory 
```

如果我刷新浏览器，就可以了。但随后，它又随机发生了。

为什么会这样？

谢谢。

三孔

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T19:55:48.653

如果您在运行查询时遇到这些问题，则您的查询很复杂或效率低下。免费层没有缓存，所以你已经在那里了。

如果您收到这些错误，请在[https://help.heroku.com打开支持票](https://help.heroku.com)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-14T15:52:32.263

`heroku restart`只是帮助了我

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-28T18:01:18.913

如果您不在免费层，可能是因为您使用了太多的内存连接到 PG。

考虑一个在多个测功机上运行的应用程序，具有多个进程，每个进程都有很多线程，也许您正在填满池。

此外，正如[Heroku 的帮助中心](https://devcenter.heroku.com/articles/postgres-logs-errors#out-of-memory-errors)中显示的那样，您可能缓存了太多不会使用的语句。

# silverlight - 同一控件的多个绑定

> ID：15621027
> 
> 赞同：0
> 
> 时间：2013-03-25T17:25:09.393
> 
> 标签：silverlight

我有一个`ChildWindow`有一个`Listbox`。我有一个用于检查要加载哪个表的枚举。我基本上是在重用这个子窗口，`Entity`通过`CollectionViewSource`. 由于各种表的动态字段名称，我正在使用`ItemTemplate`and 不能简单地绑定到属性。`Text`我曾经在使用一张表时只设置`DisplayMemberPath`或设置`Text`通过绑定。我如何在`Binding`内部实现这一点`ItemTemplate`？我可以在代码隐藏中创建一个属性，然后设置该属性，然后绑定到该属性。我不确定这种绑定的语法是什么，也不知道如何搜索它。谢谢...

与 2010 相比，银光 5.0

# java - Android Geocoding Lat/Long getAdminArea() 返回完整的状态名称而不是缩写

> ID：15621029
> 
> 赞同：3
> 
> 时间：2013-03-25T17:25:18.097
> 
> 标签：java, android, location, geocoding

我在纬度和经度上使用内置的 Android 地理编码器，并使用 getAdminArea() 尝试取回 2 个字符的状态缩写，但是我正在取回完整的状态名称。

```
Geocoder geocoder.getFromLocation(latitude, longitude, 1);
String state = addresses.get(0).getAdminArea();
//state = "Ontario" not "ON" 
```

链接到 Android Docs，它说我应该只取回两个字符状态缩写：http: [//developer.android.com/reference/android/location/Address.html#getAdminArea()](http://developer.android.com/reference/android/location/Address.html#getAdminArea())

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-27T15:58:45.990

您可以使用以下代码。

```
public static final Map<String, String> STATE_MAP;
static {
    STATE_MAP = new HashMap<String, String>();
    STATE_MAP.put("Alabama", "AL");
    STATE_MAP.put("Alaska", "AK");
    STATE_MAP.put("Alberta", "AB");
    STATE_MAP.put("Arizona", "AZ");
    STATE_MAP.put("Arkansas", "AR");
    STATE_MAP.put("British Columbia", "BC");
    STATE_MAP.put("California", "CA");
    STATE_MAP.put("Colorado", "CO");
    STATE_MAP.put("Connecticut", "CT");
    STATE_MAP.put("Delaware", "DE");
    STATE_MAP.put("District Of Columbia", "DC");
    STATE_MAP.put("Florida", "FL");
    STATE_MAP.put("Georgia", "GA");
    STATE_MAP.put("Guam", "GU");
    STATE_MAP.put("Hawaii", "HI");
    STATE_MAP.put("Idaho", "ID");
    STATE_MAP.put("Illinois", "IL");
    STATE_MAP.put("Indiana", "IN");
    STATE_MAP.put("Iowa", "IA");
    STATE_MAP.put("Kansas", "KS");
    STATE_MAP.put("Kentucky", "KY");
    STATE_MAP.put("Louisiana", "LA");
    STATE_MAP.put("Maine", "ME");
    STATE_MAP.put("Manitoba", "MB");
    STATE_MAP.put("Maryland", "MD");
    STATE_MAP.put("Massachusetts", "MA");
    STATE_MAP.put("Michigan", "MI");
    STATE_MAP.put("Minnesota", "MN");
    STATE_MAP.put("Mississippi", "MS");
    STATE_MAP.put("Missouri", "MO");
    STATE_MAP.put("Montana", "MT");
    STATE_MAP.put("Nebraska", "NE");
    STATE_MAP.put("Nevada", "NV");
    STATE_MAP.put("New Brunswick", "NB");
    STATE_MAP.put("New Hampshire", "NH");
    STATE_MAP.put("New Jersey", "NJ");
    STATE_MAP.put("New Mexico", "NM");
    STATE_MAP.put("New York", "NY");
    STATE_MAP.put("Newfoundland", "NF");
    STATE_MAP.put("North Carolina", "NC");
    STATE_MAP.put("North Dakota", "ND");
    STATE_MAP.put("Northwest Territories", "NT");
    STATE_MAP.put("Nova Scotia", "NS");
    STATE_MAP.put("Nunavut", "NU");
    STATE_MAP.put("Ohio", "OH");
    STATE_MAP.put("Oklahoma", "OK");
    STATE_MAP.put("Ontario", "ON");
    STATE_MAP.put("Oregon", "OR");
    STATE_MAP.put("Pennsylvania", "PA");
    STATE_MAP.put("Prince Edward Island", "PE");
    STATE_MAP.put("Puerto Rico", "PR");
    STATE_MAP.put("Quebec", "QC");
    STATE_MAP.put("Rhode Island", "RI");
    STATE_MAP.put("Saskatchewan", "SK");
    STATE_MAP.put("South Carolina", "SC");
    STATE_MAP.put("South Dakota", "SD");
    STATE_MAP.put("Tennessee", "TN");
    STATE_MAP.put("Texas", "TX");
    STATE_MAP.put("Utah", "UT");
    STATE_MAP.put("Vermont", "VT");
    STATE_MAP.put("Virgin Islands", "VI");
    STATE_MAP.put("Virginia", "VA");
    STATE_MAP.put("Washington", "WA");
    STATE_MAP.put("West Virginia", "WV");
    STATE_MAP.put("Wisconsin", "WI");
    STATE_MAP.put("Wyoming", "WY");
    STATE_MAP.put("Yukon Territory", "YT");
}

public static String getAbbreviationFromUSState(String state) {
    if (STATE_MAP.containsKey(state)) {
        return STATE_MAP.get(state);
    }else{
        return state;
    }
} 
```

# php - 如何使表单输入并排并且只有一个标签？CakePHP

> ID：15621032
> 
> 赞同：2
> 
> 时间：2013-03-25T17:25:20.257
> 
> 标签：php, cakephp

我正在使用以下代码生成表单。

```
echo $this->Form->create('External');
echo $this->Form->input('program_title', array('label' => 'Program Name'));
echo $this->Form->input('reference_code', array('label' => 'Reference No.'));
echo $this->Form->input('date_received', array('label' => 'Date Received', 'type' => 'date'));
echo $this->Form->input('date_released', array('value' => date('Y-m-d'), 'type' => 'hidden'));
echo $this->Form->input('inclusive_date_start', array('label' => 'Inclusive Date Start', 'type' => 'date'));
echo $this->Form->input('inclusive_date_end', array('label' => 'Inclusive Date End', 'type' => 'date'));
echo $this->Form->input('time_start', array('label' => 'Time Start', 'type' => 'time'));
echo $this->Form->input('time_end', array('label' => 'Time End', 'type' => 'time'));
echo $this->Form->end('Add Program'); 
```

它创建以下内容：

![原始图像](../Images/fca30689ac4ec8135c80b23834898d5d.png)

我怎样才能让它像这样显示呢？

![编辑后的图像](../Images/cf04721b3ec87f0a98d07dd4490cf9b1.png)

第二张图片刚刚经过编辑，所以我可以向您展示我想要的样子。想了解一下吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:02:16.007

在 CakePHP 中，您不必总是为表单元素包含标签，允许您进行自定义分组和位置。

这是一个快速示例，说明如何使用您的代码执行此操作。为简单起见，我将所有内容都保存在 PHP 中，但您也可以脱离 PHP 并编写实际的 HTML。请注意使用`'label' => false`

```
echo $this->Form->create('External');
echo $this->Form->input('program_title', array('label' => 'Program Name'));
echo $this->Form->input('reference_code', array('label' => 'Reference No.'));
echo $this->Form->input('date_received', array('label' => 'Date Received', 'type' => 'date'));
echo $this->Form->input('date_released', array('value' => date('Y-m-d'), 'type' => 'hidden'));
//Custom HTML code
echo '<div>Inclusive Date</div>';
echo '<div>';
echo '<div style="float: left;">
echo $this->Form->input('inclusive_date_start', array('label' => false, 'type' => 'date'));
echo '</div>';
echo '<div style="float: left;">-</div>';
echo '<div style="float: left;">';
echo $this->Form->input('inclusive_date_end', array('label' => false, 'type' => 'date'));
echo '</div>'
echo '<div style="clear: both;"></div>';
echo '</div>';
//Back to normal PHP
echo $this->Form->input('time_start', array('label' => 'Time Start', 'type' => 'time'));
echo $this->Form->input('time_end', array('label' => 'Time End', 'type' => 'time'));
echo $this->Form->end('Add Program'); 
```

# javascript - 从数组中获取硬编码的 jquery 选择器并隐藏它？

> ID：15621036
> 
> 赞同：-4
> 
> 时间：2013-03-25T17:25:36.197
> 
> 标签：javascript, jquery

如何从数组中获取每个硬编码选择器并使用 jQuery hide() 方法隐藏它？

```
function hideAllExcept(except) {
//Create an array to contain all of the sub navigation elements
var sub_navigation = new Array();
//Get each sub ul element of the main ul and push it to the previously created array
    $('#navigation_sub ul').each(function(index, element) {
        sub_navigation.push('$("#' +this.id+'")');
    });

var x  = sub_navigation.length;

for(var i = 0; i < x; i++) {
    $(sub_navigation).each(function(index, element) {
        $(sub_navigation)[0].hide();            
        alert(element);
        alert(this);  
        this.hide();
    })

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:28:04.847

您不需要保存 ID，只需缓存包含这些元素的 jQuery 对象。

```
var $subnav = $('#navigation_sub ul');

...

$subnav.hide(); 
```

我注意到你实际上并没有使用你的`except`参数。如果它是合法的选择器，你可以这样做：

```
$subnav.not(except).hide(); 
```

这可以使您的整个功能变成这样：

```
function hideAllExcept(except) {
    $subnav.not(except).hide();
    $(except).show();  // assuming that you want to make this one visible
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:31:23.057

改变这个：

```
sub_navigation.push('$("#' +this.id+'")'); 
```

对此：

```
sub_navigation.push("#" +this.id); 
```

和这个：

```
$(sub_navigation)[0].hide(); 
```

对此：

```
$(element).hide(); 
```

并删除不需要的 for 循环，因为您正在使用`.each`.

但是有更好的方法来处理这个问题。就像@Alnitak 建议的那样缓存 jQuery 对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:31:53.847

不确定您要完成什么，但这会将选择器硬编码到一个数组中，然后隐藏每个元素。

```
 // hardcode selectors
    var subnav_elements = ["ul#subnav1", "ul#subnav2", "ul#subnav3"];

    // for each subnav element, hide it!
    $(subnav_elements).each(function(){
        $(this).hide();
    }); 
```

# php - PHP/MySQL - 页面/排序加载缓慢

> ID：15621038
> 
> 赞同：2
> 
> 时间：2013-03-25T17:25:39.863
> 
> 标签：php, html, mysql

快速的问题，可能很简单，也可能不是。我不精通 PHP、HTML 或 MySQL，但我正在尝试。这是我正在使用的示例页面：http: [//www.djdarby.com/sorter.php](http://www.djdarby.com/sorter.php)。我正在显示一个 19600 的表格，其中包含两个字段，艺术家和歌曲。问题是它加载非常慢，我不知道指向哪里。也许我的查询太简单了，或者我一次加载太多。这是代码，因为 PHP 在页面源上变得不可见。有没有更快的方法来输出这些数据？

**编辑：**我忘了提到我正在使用 javascript 来制作表格，确切地说是[TinyTable](http://www.scriptiny.com/2009/03/table-sorter/)。

**编辑 NUMERO DOS：** 我制作了 sorter2.php，它似乎加载得更快，所以这是一个 javascript 问题吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<?php
        $con = mysql_connect("xx.xx.xx.xx", "xxxx", "xxx");
       // if (!$con) {
       //         die("Database connection failed: " . mysql_error());
       // } else {
       //         echo "\r\nConnected to the database.";
       // }
        $db = mysql_select_db("djdarby", $con);
       // if (!$db) {
       //         die("Database selection failed: " . mysql_error());
       // } else {
       //         echo "\r\nSelected to the database.";
       // }
?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>TinyTable</title>
<link rel="stylesheet" href="style.css" />
</head>
<body>
        <table cellpadding="0" cellspacing="0" border="0" id="table" class="sortable">
                <thead>
                        <tr>
                                <th><h3>Artist</h3></th>
                                <th><h3>Song</h3></th>
                        </tr>
                </thead>
                <tbody>
                        <?php
                          $result = mysql_query("SELECT * from SONGLIST", $con);
                          //if (!$result) {
                          //  die("Query failed: " . mysql_error());
                          //} else {
                          //  echo "\r\nSelected the table SONGLIST in database djdarby.<br /><br />";
                          //}

                          while ($row = mysql_fetch_array($result)) {
                            echo "<tr><td>" . $row['ARTIST'] . "</td>" . "<td>" . $row['SONG'] . "</td></tr>";
                          }
                        ?>
                </tbody>
  </table>
        <div id="controls">
                <div id="perpage">
                        <select onchange="sorter.size(this.value)">
                        <option value="5">5</option>
                                <option value="10" selected="selected">10</option>
                                <option value="20">20</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                                <option value="250">250</option>
                        </select>
                        <span>Entries Per Page</span>
                </div>
                <div id="navigation">
                        <img src="images/first.gif" width="16" height="16" alt="First Page" onclick="sorter.move(-1,true)" />
                        <img src="images/previous.gif" width="16" height="16" alt="First Page" onclick="sorter.move(-1)" />
                        <img src="images/next.gif" width="16" height="16" alt="First Page" onclick="sorter.move(1)" />
                        <img src="images/last.gif" width="16" height="16" alt="Last Page" onclick="sorter.move(1,true)" />
                </div>
                <div id="text">Displaying Page <span id="currentpage"></span> of <span id="pagelimit"></span></div>
        </div>
        <script type="text/javascript" src="script.js"></script>
        <script type="text/javascript">
  var sorter = new TINY.table.sorter("sorter");
        sorter.head = "head";
        sorter.asc = "asc";
        sorter.desc = "desc";
        sorter.even = "evenrow";
        sorter.odd = "oddrow";
        sorter.evensel = "evenselected";
        sorter.oddsel = "oddselected";
        sorter.paginate = true;
        sorter.currentid = "currentpage";
        sorter.limitid = "pagelimit";
        sorter.init("table",1);
  </script>
</body>
</html>
<?php
  mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T19:18:09.890

将“LIMIT $start,$stop”追加到查询字符串中，并尽量不要在一页中使用太多记录

# php - 句子比较：忽略单词

> ID：15621041
> 
> 赞同：1
> 
> 时间：2013-03-25T17:25:50.800
> 
> 标签：php, regex

我需要一些关于句子比较的帮助。

```
 $answer = "This is the (correct and) acceptable answer. Content inside the parenthesis are ignored if not present in the user's answer. If it is present, it should not count against them.";
    $response = "This is the correct and acceptable answer. Content inside the parenthesis are ignored if not present in the user's answer. If it is present, it should not count against them.";

    echo "<strong>Acceptable Answer:</strong>";
    echo "<pre style='white-space:normal;'>$answer</pre><hr/>";
    echo "<strong>User's Answer:</strong>";
    echo "<pre>".$response."</pre>";

    // strip content in brackets
    $answer = preg_replace("/\([^)]*\)|[()]/", "", $answer);

    // strip punctuation
    $answer = preg_replace("/[^a-zA-Z 0-9]+/", " ", $answer);
    $response = preg_replace("/[^a-zA-Z 0-9]+/", " ", $response);

    $common = similar_text($answer, $response, $percent);
    $orgcount = strlen($answer);
    printf("The user's response has %d/$orgcount characters in common (%.2f%%).", $common, $percent); 
```

基本上我想做的是忽略带括号的单词。例如，在 $answer 字符串中，*正确并*在括号中 - 因此，我不希望这些词再次计入用户的响应。因此，如果用户有这些词，则不计入它们。如果用户没有这些词，则不计入它们。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:07:56.570

感谢评论，我写了一个解决方案，因为这是一个“漫长”的过程，我想把它放在一个函数中。 **编辑：**调试后发现`strpos()`如果位置是会引起一些麻烦`0`，所以我添加了一条`OR`语句：

```
$answer = "(This) is the (correct and) acceptable answer. (random this will not count) Content inside the parenthesis are ignored if not present in the user's answer. If it is present, it should not count against them.";
$response = "This is the correct and acceptable answer. Content inside the parenthesis are ignored if not present in the user's answer. If it is present, it should not count against them.";

echo 'The user\'s response has '.round(compare($answer, $response),2).'% characters in common'; // The user's response has 100% characters in common

function compare($answer, $response){   
    preg_match_all('/\((?P<parenthesis>[^\)]+)\)/', $answer, $parenthesis);

    $catch = $parenthesis['parenthesis'];
    foreach($catch as $words){
        if(!strpos($response, $words) === false || strpos($response, $words) === 0){ // if it does exist then remove brackets
            $answer = str_replace('('.$words.')', $words, $answer);
        }else{ //if it does not exist remove the brackets with the words
            $answer = str_replace('('.$words.')', '', $answer);
        }
    }
    /* To sanitize */
    $answer = preg_replace(array('/[^a-zA-Z0-9]+/', '/ +/'), array(' ', ' '), $answer);
    $response = preg_replace(array('/[^a-zA-Z 0-9]+/', '/ +/'), array(' ', ' '), $response);
    $common = similar_text($answer, $response, $percent);
    return($percent);
} 
```

# c# - 遍历具有特定属性的字段

> ID：15621044
> 
> 赞同：1
> 
> 时间：2013-03-25T17:26:10.740
> 
> 标签：c#, reflection, attributes

我对 C# 中的反射很陌生。我想创建一个可以与我的字段一起使用的特定属性，这样我就可以遍历它们并检查它们是否已正确初始化，而不是每次都为每个字段编写这些检查。我认为它看起来像这样：

```
public abstract class BaseClass {

    public void Awake() {

        foreach(var s in GetAllFieldsWithAttribute("ShouldBeInitialized")) {

            if (!s) {

                Debug.LogWarning("Variable " + s.FieldName + " should be initialized!");
                enabled = false;

            }

        }

    }

}

public class ChildClass : BasicClass {

    [ShouldBeInitialized]
    public SomeClass someObject;

    [ShouldBeInitialized]
    public int? someInteger;

} 
```

（您可能会注意到我打算使用 Unity3d，但在这个问题中没有任何特定于 Unity 的内容 - 或者至少在我看来是这样）。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:38:54.753

你可以用一个简单的表达式得到这个：

```
private IEnumerable<FieldInfo> GetAllFieldsWithAttribute(Type attributeType)
{
    return this.GetType().GetFields().Where(
        f => f.GetCustomAttributes(attributeType, false).Any());
} 
```

然后将您的呼叫更改为：

```
foreach(var s in GetAllFieldsWithAttribute(typeof(ShouldBeInitializedAttribute))) 
```

您可以通过将其设置为以下扩展方法，使其在整个应用程序中更有用`Type`：

```
public static IEnumerable<FieldInfo> GetAllFieldsWithAttribute(this Type objectType, Type attributeType)
{
    return objectType.GetFields().Where(
        f => f.GetCustomAttributes(attributeType, false).Any());
} 
```

你可以称之为：

```
this.GetType().GetAllFieldsWithAttribute(typeof(ShouldBeInitializedAttribute)) 
```

**编辑**：要获取私有字段，请更改`GetFields()`为：

```
GetFields(BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic) 
```

并获取类型（在循环内）：

```
object o = s.GetValue(this); 
```

# jquery - XML 树视图：我使用 XMLTree.js 作为插件在 jQuery 的树视图中显示我的 xml，我可以编辑我的叶节点吗

> ID：15621046
> 
> 赞同：0
> 
> 时间：2013-03-25T17:26:18.413
> 
> 标签：jquery, jquery-plugins, xml-parsing

我使用 XMLTree.js 作为插件以树结构显示我的 xml。树视图我能够看到，但我想编辑我的节点值。谁能帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T14:22:37.583

您可以改用[Live XML Editor](http://www.subchild.com/liveXmlEdit/index.php#)。

# python - 如何满足 direct_to_template 的导入？

> ID：15621048
> 
> 赞同：23
> 
> 时间：2013-03-25T17:26:20.497
> 
> 标签：python, django, social-networking, pinax

我从最初的 Pinax 0.7 项目中收到错误页面：

```
ImportError at /
No module named simple
Request Method: GET
Request URL:    http://stornge.com:8000/
Django Version: 1.5
Exception Type: ImportError
Exception Value:    
No module named simple
Exception Location: /home/jonathan/clay/../clay/urls.py in <module>, line 3
Python Executable:  /home/jonathan/virtual_environment/bin/python
Python Version: 2.7.3
Python Path:    
['/home/jonathan/clay/apps',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/pinax/apps',
 '/home/jonathan/clay',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/distribute-0.6.24-py2.7.egg',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/pip-1.1-py2.7.egg',
 '/home/jonathan/virtual_environment/lib/python2.7',
 '/home/jonathan/virtual_environment/lib/python2.7/plat-linux2',
 '/home/jonathan/virtual_environment/lib/python2.7/lib-tk',
 '/home/jonathan/virtual_environment/lib/python2.7/lib-old',
 '/home/jonathan/virtual_environment/lib/python2.7/lib-dynload',
 '/usr/lib/python2.7',
 '/usr/lib/python2.7/plat-linux2',
 '/usr/lib/python2.7/lib-tk',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/PIL']
Server time:    Mon, 25 Mar 2013 13:16:33 -0400 
```

它犹豫不决的那一行 urls.py:3 是：

```
from django.views.generic.simple import direct_to_template 
```

如何更改导入或使用它的区域：

```
 urlpatterns = patterns('',
    url(r'^$', direct_to_template, {
        "template": "homepage.html",
    }, name="home"), 
```

看起来我可以创建一个在主页上执行 render_to_response() 的视图，但我想知道我应该如何解决它，如果没有人告诉我更好的方法，我可以依靠它。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-03-25T17:37:24.517

`direct_to_template`已被弃用。在 django 1.5 中尝试使用基于类的[`TemplateView`](https://docs.djangoproject.com/en/stable/ref/class-based-views/base/#templateview)视图`urls.py`

```
from django.views.generic import TemplateView

urlpatterns = patterns('',
    url(r'^$', TemplateView.as_view(template_name='homepage.html'), name="home"),
) 
```

这里有一些关于迁移到 1.4 版（不推荐使用时）的[信息](https://docs.djangoproject.com/en/1.4/topics/generic-views-migration/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-18T17:52:49.520

除了基于类的视图`TemplateView`，您还可以使用如下`render`函数：

```
from django.shortcuts import render

urlpatterns = patterns("",
    url(r'^$', lambda request: render(request, 'homepage.html'), name="home"),
) 
```

# php - PHP mysql结果问题

> ID：15621049
> 
> 赞同：1
> 
> 时间：2013-03-25T17:26:21.730
> 
> 标签：php, mysql, post

我的注册页面中有这一行。

```
if (device_id_exists($_POST['device_id']) == true) {
           $errors[] = 'Sorry the Serial Number \'' . htmlentities($_POST['device_id']) . '\' does not exist.';
    } 
```

我的功能页面中有这个。

```
function device_id_exists($device_id) {
   $device_id = sanitize($device_id);
   $query = mysql_query("SELECT COUNT(`numbers`) FROM `devicenumbers` WHERE `numbers` = '$numbers'");
   return (mysql_result($query, 0) == 0) ? true : false; 
```

如果我运行此查询`SELECT COUNT(`numbers `) FROM`devicenumbers `WHERE`numbers `= '1234567890'` （有效数字），它将返回 1 = match found 对吗？如果我输入一个虚假数字，它会返回一个“0”。发生的情况是，当有一个有效数字时，它仍然返回该数字不存在的错误。如果我将结果更改为 == 1 它会提交任何数字吗？我是 DB 的新手，感谢任何帮助。我希望我提供了足够的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:35:54.737

看起来你正在调用不正确的变量。在 device_id_exists() 函数中，您接受一个名为`$device_id`. 但是，当您执行查询时，您调用的似乎是一个未定义的变量：`$numbers`. 我怀疑`$numbers`应该重命名为`$device_id`.

我看到你`$device_id`来自一个表格帖子。我强烈建议您转义该变量，`mysql_real_escape_string()`以确保您免受 SQL 注入。请注意，`sanitize()`它不能防止 SQL 注入！

另外一点，我建议使用 utilizng`mysql_num_rows()`而不是`mysql_result()`因为`mysql_result()`实际上要求数据库服务器返回实际结果，而您真正关心的是条目是否存在，而不是实际值。

```
function device_id_exists($device_id) {
  $device_id = sanitize($device_id);
  $device_id = mysql_real_escape_string($device_id);
  $query = mysql_query("SELECT COUNT(`numbers`) FROM `devicenumbers` WHERE `numbers` = '$device_id'");
  return mysql_num_rows($query) ? True : False;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:39:33.750

我对 mysql 结果集有类似的问题，即使没有记录（在选择查询中使用 max() 时，它也会返回 nums_rows == 1 - 在您的情况下，您使用了 count()）... 而不是检查 mysqlquery 0，检查结果集是否为空（这就是我解决问题的方法）..例如。if(!empty(mysql_result($query))) ？真假;

# c# - RegistryKey 上次写入时间

> ID：15621053
> 
> 赞同：3
> 
> 时间：2013-03-25T17:26:31.133
> 
> 标签：c#, .net

使用`Microsoft.Win32.RegistryKey`（或任何相关类），如何查询注册表项的最后写入时间？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T17:28:53.053

您将需要使用 P/Invoke 来调用 Win32 API：

[MSDN：`RegQueryInfoKey`功能](http://msdn.microsoft.com/en-us/library/ms724902%28VS.85%29.aspx)

来自[pinvoke.net](http://www.pinvoke.net/default.aspx/advapi32/RegQueryInfoKey.html)的签名：

```
[DllImport("advapi32.dll", EntryPoint="RegQueryInfoKey", CallingConvention=CallingConvention.Winapi, SetLastError=true)]
extern private static int RegQueryInfoKey(
    UIntPtr hkey,
    out StringBuilder lpClass,
    ref uint lpcbClass,
    IntPtr lpReserved,
    out uint lpcSubKeys,
    out uint lpcbMaxSubKeyLen,
    out uint lpcbMaxClassLen,
    out uint lpcValues,
    out uint lpcbMaxValueNameLen,
    out uint lpcbMaxValueLen,
    out uint lpcbSecurityDescriptor,
    IntPtr lpftLastWriteTime); 
```

# python - Python3 解释器中不再有光标移动（通过键盘）

> ID：15621054
> 
> 赞同：0
> 
> 时间：2013-03-25T17:26:32.877
> 
> 标签：python, python-3.x, keyboard, cursor

我最近从源代码编译了 Python 3.3，并将其安装在我的 Linux Ubuntu 工作站上的主目录中。一切正常，直到我今天不得不重新启动计算机。

通常，我可以使用键盘上的箭头键在 Python3 解释器的命令行中导航（在 bash shell 中）——它仍然适用于这台机器上的 Python2.7 解释器。现在，当我想使用向上键访问历史记录，或者在命令行中向左或向右移动光标时，解释器无法识别这些，而是​​插入字符。例如，

```
^[[D^[[A^[[B^[[C 
```

有谁知道我该如何解决这个问题？在重新启动之前它工作正常，在那之后一定发生了一些事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-25T16:32:26.683

python 3.4 的 OS X 包安装也会出现同样的问题。安装 readline 允许以与 python 2.7 中相同的方式使用箭头键。

$pip3 安装读取线

pip 内置于 python 3.4 中。如果您的系统上有 python2，您可能需要使用“pip3”而不是“pip”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:34:17.387

我不确定是什么导致它在重新启动后停止工作。但是您可以尝试使用 pip 或 easy_install 安装 readline

# java - Java：为购物清单添加数量

> ID：15621056
> 
> 赞同：-4
> 
> 时间：2013-03-25T17:26:35.953
> 
> 标签：java, eclipse

我是学习Java的新手，并决定测试一下自己。

我给自己设定了制作某种购物篮的任务，有点像你在亚马逊上做的。

我已经完成了所有的代码，比如变量，但是我不知道如何制作它，所以用户可以选择他们想要的每个项目的数量。

**这是我的代码示例**

```
 double oranges;
   double apples;
   double grapes;
   oranges = 0.12;
   apples = 0.16;
   grapes = 0.28;

    //oranges
   System.out.print("Oranges ");
   System.out.print("£");
   System.out.print(oranges);
   System.out.println();

   ///apples
   System.out.print("Apples ");
   System.out.print("£");
   System.out.print(apples);
   System.out.println();

   //grapes
   System.out.print("Grapes ");
   System.out.print("£");
   System.out.print(grapes);
   System.out.println(); 
```

**安慰：**

```
Oranges £0.12
Apples £0.16
Grapes £0.28 
```

有没有人知道或指出我如何添加数量选项，以便用户可以选择他们想要的每个项目的数量。

我更喜欢 youtube 视频，因为它更容易理解。

谢谢你的帮助，

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:46:44.590

如上所述，查看 Scanner 类，这允许您获取用户输入并对其进行操作:)

您将创建一个 int 数量，然后询问用户他们想要某种产品的数量并将其分配给数量:)

然后是简单的乘法：D

当您有单独的打印行时，关于您的代码的另一条注释

"

```
System.out.print("Oranges ");
System.out.print("£");
System.out.print(oranges);
System.out.println();" 
```

您可以像这样在中间使用“+”将它们组合在一起

```
System.out.print("Oranges " + "£" + oranges);
System.out.println(); 
```

有一种方法可以将下一个返回空间放在您要编写的下一个句子中，该句子将跟随您拥有的控制台打印

`Oranges £0.12`

看看你能不能自己找到它：D

问候乔丹.A

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:21:38.087

尝试使用 do while 循环切换，继续要求一些水果，突破所需的输入：

```
do
{
//accept fruit item say input
switch(input)
{
case 1:
// adding stuff
// other cases
}

}
while(input!=something); 
```

# javascript - 设置多个 div 大小的随机图像

> ID：15621058
> 
> 赞同：0
> 
> 时间：2013-03-25T17:26:47.977
> 
> 标签：javascript, jquery, html, css

我有一个包含四个 div 容器的画廊网格。我想将任何图像包含在 div 中，请记住每个 div 框都有不同的高度和宽度。应该在 div 中居中，在四周留下合理的填充。请检查链接以更好地理解 [JsFiddle](http://jsfiddle.net/dajin007/s4ykz/) [http://d.alistapart.com/fluid-images/3-4.png](http://d.alistapart.com/fluid-images/3-4.png)

非常感谢任何帮助。在此处输入代码

```
 <div id="body">
  <div class="container">
<img class="magic" src="http://photos.smugmug.com/photos/i-2wtTsHn/0/M/JLF_3559-M.jpg">          
</div>
<br/>
<br/>
<br/>
<br/>
<br/>
<div class="container h2">
    <img class="magic" src="http://photos.smugmug.com/photos/i-2wtTsHn/0/M/JLF_3559-M.jpg">
</div>
<br/>
<br/>
<br/>
<br/>
<br/>
<div class="container h3">
    <img class="magic" src="http://photos.smugmug.com/photos/i-2wtTsHn/0/M/JLF_3559-M.jpg">
</div>
<br/>
<br/>
<br/>
<br/>
<br/>
<div class="container w2">
    <img class="magic" src="http://photos.smugmug.com/photos/i-2wtTsHn/0/M/JLF_3559-M.jpg">
</div> 
```

```
 .container {
  height:100px;
   width: 100px;
  overflow: hidden;
   position: relative;
  margin-bottom: 10px;
  float: left;
  background: #CCC;
   border-radius: 5px;
  cursor: pointer;
   box-shadow: 4px 0 2px -2px rgba(0, 0, 0, 0.4);
     }
  .magic {
   max-width:90%;
   height:70%;
   }
   .h2 {
  height: 210px;
   width: 220px;
    }
  #body {
    margin: 10px;
   }
 .h3 {
  width: 340px;
  height: 210px;
  } 
  .w2 {
    width: 220px;
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:41:49.713

我不确定我是否理解您的问题...如果您使用

```
.magic {
    max-width:100%;
    max-height:100%;
} 
```

有大图有什么问题？

你想让他们填满整个 div 并尊重他们的大小比例吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:08:24.093

我建议将这些图像作为背景图像属性添加到块级 div，例如：

```
<div class="container">
    <div class="magic" style="background-image: url(SOURCEHERE.JPG)"></div>
</div> 
```

使用额外的 CSS，例如：

```
.container{
    width: 100px; /* or some other width */
    height: 100px; /* or some other height */
    padding:20px; /* this will add a little margin around your image */
    box-sizing:border-box; /* padding will be calculated with the container dimensions */
}

.magic{
    width:100%;
    height:100%;
    background-size:contain;
    background-position:center center;
    background-repeat:no-repeat;
    box-sizing:border-box;
} 
```

jsfiddle：http: [//jsfiddle.net/PDL2U/](http://jsfiddle.net/PDL2U/)

# asp.net - 在非关系数据库中创建视图

> ID：15621059
> 
> 赞同：4
> 
> 时间：2013-03-25T17:26:52.467
> 
> 标签：asp.net, sql, oracle, view

我有一个问题，我希望有人可以帮助我。事实上，我在一个设计不佳的数据库上工作，我无法控制更改其中的内容。我有一个“书籍”表，每本书可以有一个或多个作者。不幸的是，数据库不是完全相关的（请不要问我为什么，因为我从一开始就问同样的问题）。在“书籍”表中，有一个名为“Author_ID”和“Author_Name”的字段，因此当一本书由 2 或 3 个作者撰写时，他们的 ID 和他们的姓名将连接在由星号分隔的同一记录中。这是一个演示：

```
ID_BOOK | ID_AUTHOR |       NAME AUTHOR       |  Adress        |  Country        |
----------------------------------------------------------------------------------
001     |01         | AuthorU                 | AdrU           | CtryU           |
----------------------------------------------------------------------------------
002     |02*03*04   | AuthorX*AuthorY*AuthorZ | AdrX*NULL*AdrZ | NULL*NULL*CtryZ |
---------------------------------------------------------------------------------- 
```

我需要针对这个表创建一个视图，它会给我这个结果：

```
ID_BOOK | ID_AUTHOR |       NAME AUTHOR       | Adress         | Country         |
----------------------------------------------------------------------------------
001     |01         | AuthorU                 | AdrU           | CtryU           |
----------------------------------------------------------------------------------
002     |02         | AuthorX                 | AdrX           | NULL            |
----------------------------------------------------------------------------------
002     |03         | AuthorY                 | NULL           | NULL            |
----------------------------------------------------------------------------------
002     |04         | AuthorZ                 | AdrZ           | CtryZ           |
---------------------------------------------------------------------------------- 
```

我将继续尝试这样做，我希望有人可以帮助我至少提供一些提示。非常感谢你们。

在我应用你们给出的解决方案后，我遇到了这个问题。我正在努力解决它，希望你能帮助我。事实上，当 sql 查询运行时，CLOB 字段在其中一些包含 NULL 值时是杂乱无章的。结果应该像上面一样，但我得到了以下结果：

```
ID_BOOK | ID_AUTHOR |       NAME AUTHOR       | Adress         | Country         |
----------------------------------------------------------------------------------
001     |01         | AuthorU                 | AdrU           | CtryU           |
----------------------------------------------------------------------------------
002     |02         | AuthorX                 | AdrX           | CtryZ           |
----------------------------------------------------------------------------------
002     |03         | AuthorY                 | AdrZ           | NULL            |
----------------------------------------------------------------------------------
002     |04         | AuthorZ                 | NULL           | NULL            |
---------------------------------------------------------------------------------- 
```

为什么将 NULL 值放在最后？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:15:16.233

在 11g 中，您可以为此使用分解递归子查询：

```
with data (id_book, id_author, name, item_author, item_name, i)
 as (select id_book, id_author, name,
            regexp_substr(id_author, '[^\*]+', 1, 1) item_author, 
            regexp_substr(name, '[^\*]+', 1, 1) item_name,
            2 i 
       from books
     union all
     select id_book, id_author, name,
            regexp_substr(id_author, '[^\*]+', 1, i) item_author, 
            regexp_substr(name, '[^\*]+', 1, i) item_name, 
            i+1
       from data
      where regexp_substr(id_author, '[^\*]+', 1, i) is not null)
select id_book, item_author, item_name
  from data; 
```

[小提琴](http://sqlfiddle.com/#!4/5fcac/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:04:58.210

几周前，我 [在这里](https://stackoverflow.com/questions/15434396/find-all-matches-in-a-varchar2/15437392#15437392)回答了一个类似的问题。该答案对一般方法有一个解释（我希望），所以我将在这里跳过解释。这个查询可以解决问题；它使用`REGEXP_REPLACE`并利用其“出现”参数来选择个人作者 ID 和姓名：

```
SELECT
 ID_Book,
 REGEXP_SUBSTR(ID_Author, '[^*]+', 1, Counter) AS AuthID,
 REGEXP_SUBSTR(Name_Author, '[^*]+', 1, Counter) AS AuthName
FROM Books
CROSS JOIN (
  SELECT LEVEL Counter
    FROM DUAL
    CONNECT BY LEVEL <= (      
      SELECT MAX(REGEXP_COUNT(ID_Author, '[^*]+'))
      FROM Books))
WHERE REGEXP_SUBSTR(Name_Author, '[^*]+', 1, Counter) IS NOT NULL
ORDER BY 1, 2 
```

有一个 Fiddle 与您的数据加上另一行[here](http://www.sqlfiddle.com/#!4/c0f19/2)。

* * *

**附录**：OP 有 Oracle 9，而不是 11，所以正则表达式不起作用。以下是在不使用正则表达式的情况下执行相同任务的说明...

如果没有`REGEXP_COUNT`，计算作者的最佳方法是计算星号并加一个。要计算星号，请取字符串的长度，然后当所有星号都被吸出时减去它的长度：`LENGTH(ID_Author) - LENGTH(REPLACE(ID_Author, '*'))`.

如果没有`REGEX_SUBSTR`，则需要使用`INSTR`查找星号的位置，然后`SUBSTR`提取作者 ID 和姓名。这有点复杂 - 请考虑您原始帖子中的这些作者专栏：

```
Author U
Author X*Author Y*Author Z 
```

*   `AuthorX`位于字符串开头和第一个星号之间。
*   `AuthorY`被星号包围
*   `AuthorZ`位于最后一个星号和字符串末尾之间。
*   `AuthorU`独自一人，没有被任何东西包围。

因此，开篇（`WITH AuthorInfo AS...`下图）在开头和结尾添加了一个星号，因此每个作者姓名（和 ID）都被星号包围。它还获取每一行的作者计数。对于您原始帖子中的示例数据，开篇将产生以下结果：

```
ID_Book  AuthCount  ID_Author   Name_Author
-------  ---------  ----------  -------------------------
001              1  *01*        *AuthorU*
002              3  *02*03*04*  *AuthorX*AuthorY*AuthorZ* 
```

然后是与“计数器”表的连接和`SUBSTR`提取个人名称和 ID 的阴谋。最终查询如下所示：

```
WITH AuthorInfo AS (
  SELECT
    ID_Book,
    LENGTH(ID_Author) -
        LENGTH(REPLACE(ID_Author, '*')) + 1 AS AuthCount,
    '*' || ID_Author || '*' AS ID_Author,
    '*' || Name_Author || '*' AS Name_Author
  FROM Books
)
SELECT
  ID_Book,
  SUBSTR(ID_Author,
    INSTR(ID_Author, '*', 1, Counter) + 1,
    INSTR(ID_Author, '*', 1, Counter+1) - INSTR(ID_Author, '*', 1, Counter) - 1) AS AuthID,
  SUBSTR(Name_Author,
    INSTR(Name_Author, '*', 1, Counter) + 1,
    INSTR(Name_Author, '*', 1, Counter+1) - INSTR(Name_Author, '*', 1, Counter) - 1) AS AuthName
FROM AuthorInfo
CROSS JOIN (
  SELECT LEVEL Counter
    FROM DUAL
    CONNECT BY LEVEL <= (SELECT MAX(AuthCount) FROM AuthorInfo))
WHERE AuthCount >= Counter
ORDER BY ID_Book, Counter 
```

小提琴在[这里](http://www.sqlfiddle.com/#!4/c0f19/14)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:24:18.697

此外：

```
SELECT distinct id_book,
     , trim(regexp_substr(id_author, '[^*]+', 1, LEVEL)) id_author
     , trim(regexp_substr(author_name, '[^*]+', 1, LEVEL)) author_name
 FROM yourtable
CONNECT BY LEVEL <= regexp_count(id_author, '[^*]+')
ORDER BY id_book, id_author
/

ID_BOOK    ID_AUTHOR    AUTHOR_NAME
------------------------------------
001        01           AuthorU
002        02           AuthorX
002        03           AuthorY
002        04           AuthorZ
003        123          Jane Austen
003        456          David Foster Wallace
003        789          Richard Wright 
```

没有正则表达式：

```
SELECT str, SUBSTR(str, substr_start_pos, substr_end_pos) final_str
  FROM
 (
  SELECT str, substr_start_pos
       , (CASE WHEN substr_end_pos <= 0 THEN (Instr(str, '*', 1)-1) 
            ELSE substr_end_pos END) substr_end_pos
    FROM
   (
   SELECT distinct '02*03*04' AS str
       , (Instr('02*03*04', '*', LEVEL)+1) substr_start_pos
       , (Instr('02*03*04', '*', LEVEL)-1) substr_end_pos           
    FROM dual
   CONNECT BY LEVEL <= length('02*03*04')
   )
  ORDER BY substr_start_pos
  )
 /

STR         FINAL_STR
---------------------
02*03*04    02
02*03*04    03
02*03*04    04 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T18:05:05.607

如果你有一张`authors`桌子，你可以这样做：

```
select b.id_book, a.id_author, a.NameAuthor
from books b left outer join
     authors a
     on '*'||NameAuthor||'*' like '%*||a.author||'*%' 
```

# oracle - 查找在我的 oracle.context 索引中编入索引的文档数？

> ID：15621063
> 
> 赞同：2
> 
> 时间：2013-03-25T17:27:06.017
> 
> 标签：oracle, oracle10g, oracle-text

我知道我可以`ctx_query.count_hits`用来计算与查询匹配的文档数，同样，我可以使用

```
count(*) where CONTAINS(...) 
```

但如果我真的有疑问，这些只是选项。如果我将空字符串作为查询传递（感谢 oracle ...），这些函数会引发异常。所以，

> 有没有办法计算我的 oracle.text 索引索引的文档总数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T18:09:09.510

首选方法是使用[CTX_REPORT 包](http://docs.oracle.com/cd/B28359_01/text.111/b28304/crptpkg.htm#i996935)，或者**describe_index**

```
set long 50000
select ctx_report.describe_index('MYINDEX') from dual; 
```

将为您提供列中索引文档的数量`docid count`：

> ```
> ===========================================================================
>                              INDEX DESCRIPTION
> ===========================================================================
> index name:                    "SCHEMA"."MYINDEX"
> index id:                      1130
> index type:                    context
> 
> status:                        INDEXED
> 
> full optimize token:
> full optimize count:
> docid count:                   6909265
> nextid:                        6909266 
> ```

或者，使用**index_stats**：

```
create table output (result CLOB);

  declare
    x clob := null;
  begin
    ctx_report.index_stats('MYINDEX',x);
    insert into output values (x);
    commit;
    dbms_lob.freetemporary(x);
  end;
  /

set long 32000
set head off
set pagesize 10000
select * from output; 
```

> ```
> ===========================================================================
>            STATISTICS FOR "SCHEMA"."MYINDEX"
> ===========================================================================
> indexed documents:                                             6,909,265 
> ```

对于获取索引的大小也很有用：

```
set long 50000
select ctx_report.index_size('MYINDEX') from dual; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T13:35:33.587

您可以使用 CTX... 视图：

```
select idx_name, idx_table_owner, idx_table, idx_docid_count 
from ctx_user_indexes 
```

# javascript - jQuery scrollTop 遇到一些问题

> ID：15621064
> 
> 赞同：0
> 
> 时间：2013-03-25T17:27:09.293
> 
> 标签：javascript, jquery, html, scrolltop

我已经对此进行了大量研究，但我不知所措。

不太确定发生了什么，但我无法让这个 .animate() 正确设置动画。

我做了一个 JS fiddle，概述了我的设置方式。基本上，它的 4 张幻灯片，每张都是 100% 的高度和 100% 的宽度，我从每张幻灯片中的每个链接动态获取幻灯片目标。

我做了一个 jsFiddle 来尝试让它正常工作：

[http://jsfiddle.net/mikelegacy/WrZev/](http://jsfiddle.net/mikelegacy/WrZev/)

这是我正在使用的 jquery，不过，您必须查看 jsFiddle 才能了解全部内容。

```
$("a.scrollButton").click(function(e) {
    var slideId = $(this).attr("href");
        $("html, body").animate({
            scrollTop: $(slideId).offset().top
        }, 2000);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:33:10.210

将 a.scrollButton 更改为 a.slideButton，就像您在 HTML 中一样。

```
$("a.slideButton").click(function(e) {
    var slideId = $(this).attr("href");
        $("html, body").animate({
            scrollTop: $(slideId).offset().top
        }, 2000); 
    return false;

}); 
```

[http://jsfiddle.net/calder12/WrZev/2/](http://jsfiddle.net/calder12/WrZev/2/)

# apache-flex - 将自定义 TextInput 设置为 Flext/Spark ComboBox

> ID：15621065
> 
> 赞同：0
> 
> 时间：2013-03-25T17:27:15.310
> 
> 标签：apache-flex, combobox, textinput, flex-spark

有没有办法将我定制的 TextInput 组件（称为 CustomTextInput）设置为 ComboBox 的 textInput 属性？

我试过这样的事情：

```
<s:ComboBox id="myCombo" dataProvider="{myDP}">
    <s:textInput>
        <components:CustomTextInput />
    </s:textInput>
</s:ComboBox> 
```

它不起作用，但它可以说明我正在尝试做的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-13T23:09:52.437

您可以通过编辑以下可用[开源](https://github.com/pdpsolutions/px/blob/master/visual/BindableComboBox.mxml)的 ActionScript、Flex、仅 spark 组合框的 MXML 文件来完成此操作（只需编辑一个 MXML 文件，因此比编辑 <s:ComboBox> 更简单）。

# r - 如何在 R 中执行 wilcox 测试？

> ID：15621069
> 
> 赞同：0
> 
> 时间：2013-03-25T17:27:27.843
> 
> 标签：r

我有这个数据框，其中包含 4 个基因和 3 个重复测量的样本。TS 是标准。

我想在样品 S1 与 TS 和 S2 与每种蛋白质的 TS 之间执行 wilcox 测试，但我遇到了 for 循环问题。

```
 MS.rawMV <- read.table("C:/Users/aaa/Desktop/genomic/MS.csv", header=T)
         S1_1     S1_2    S2_1    S2_2     TS_1     TS_2
gene 1    1         1      2        3       5         5 
gene 2    10        10     4        5       9         10   
gene 3    5         6      4        4       5         7
gene 4    9         9      8        7       6         6     

 Samples=list(
  S1=grep("S1_*", colnames(MS.rawMV), value=TRUE),
  S2=grep("S2_*", colnames(MS.rawMV), value=TRUE),
  TS=grep("TS_*", colnames(MS.rawMV), value=TRUE))

sample.names <- names(Samples)
ref.sample <- "TS_"

# Build a data.frame 
GRates <- data.frame(MS.rawMV[Reduce("c", Samples)])

## Statistics: non parametric test using TS as a standart 
for (i in names(Samples)) {
  WILCOXTEST <- wilcox.test(GRates[c(Samples[[i]])],Samples[[ref.sample]])
  pnames <- paste(i,".wilcoxtest",sep="")
  GRates[pnames] <- WILCOXTEST["p.value"]
}

Error in wilcox.test.default(GRates[Samples[[i]]], Samples[[ref.sample[i]]]) : 
  'x' must be numeric 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:43:10.240

看起来数据被视为一个因素。

最简单的解决方法是通过因子->字符->数字将它们转换回数字。

尝试这个

```
wilcox.test(
    as.numeric(as.character(GRates[c(Samples[[i]])])),
    as.numeric(as.character(Samples[[ref.sample]]))
) 
```

如果您尝试从因子直接转换为数字，您最终将得到表示因子类而不是实际值的整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:53:34.630

@DWin 的评论很好（您的数据中有额外的结构，很难纳入 Wilcoxon 测试）。但是，如果您想忽略 _1 和 _2 列之间的区别并在 S1 vs TS 和 S2 vs TS 上运行 Wilcoxon 测试，这里有一种重新排列数据并执行此操作的方法：

```
dat <- read.table(text="
gene S1_1 S1_2    S2_1    S2_2     TS_1     TS_2
1      1    1      2        3       5         5 
2     10   10      4        5       9         10   
3      5    6      4        4       5         7
4      9    9      8        7       6         6",
                  header=TRUE)

library(reshape2)
library(plyr)
m1 <- melt(dat,id.var="gene")
## break var_num into separate components
m2 <- subset(data.frame(m1,
             colsplit(m1$variable,"_",names=c("var","num"))),
             select=-variable)
## combine treatments with standards
m3 <- merge(subset(m2,var!="TS"),
      subset(m2,var=="TS"),by=c("gene","num"))
## clean up
m4 <- subset(rename(m3,c(value.x="value",var.x="var",value.y="standard")),
             select=-var.y)

## apply Wilcoxon test to each component, save the p value
ddply(m4,"var",
      function(x) with(x,wilcox.test(value,standard))$p.value) 
```

或者，如果您想分别测试每个复制（如@agstudy 的回答），请执行

```
ddply(m4,c("var","num"),
      function(x) with(x,wilcox.test(value,standard))$p.value) 
```

反而。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:04:44.290

我认为，由于 `wilcox.test`未矢量化，因此您需要 2 个循环。即使我不确定这个的统计意义，这里你可以怎么做：

```
nn <- colnames(dat)
lapply(1:2,function(x){ 
  col.L <- grep(paste0('S',x,'_*'),nn)
  col.R <- dat[,paste0('TS_',x)]
  lapply(col.L,function(y) 
      wilcox.test(dat[,y],col.R)['p.value'])
}) 
```

在这里我假设`dat`为

```
dat <- read.table(text='S1_1     S1_2    S2_1    S2_2     TS_1     TS_2
gene_1    1         1      2        3       5         5 
gene_2    10        10     4        5       9         10   
gene_3    5         6      4        4       5         7
gene_4    9         9      8        7       6         6',header=TRUE) 
```

# mysql - 如何创建多个表名结构的mysql循环并将数据复制到第二个数据库

> ID：15621075
> 
> 赞同：0
> 
> 时间：2013-03-25T17:28:20.037
> 
> 标签：mysql, database, arrays, foreach, multiple-tables

**我正在努力完成的事情。** 我的网站已经上线，我正在对其进行一些更改。当我准备好进行更改时，我基本上将删除旧数据库 (myFirstDb) 并放置新数据库 (mySecondDb)。但是 - 我想保留一些来自实时站点（myFirstDb）的表格 - 并将它们带入新数据库（mySecondDb）。我知道我可以通过 phpMyAdmin 来做到这一点——但这一次只允许复制一个表。

**我的问题：** mySQL 中的哪种 SQL 查询将允许我定义从数据库 1 移动到数据库 2 的表。（保留结构和数据等）

**这就是我到目前为止所拥有的。**

首先，是否可以在 mySql - SQL 查询中创建循环？如果是这样...

有人可以帮助我在 mySQL 中创建数组的正确语法吗？

**我将如何以有效的 sql 语法创建数组？**

> // 在此处定义表名数组。<--如何形成这个？
> 
> SET @table_name_array = ('tableFive', 'tableSeven', 'tableNine', 'tableFifteen', 'tableNineteen', 'tableNth', 'tableMaybeOneMore');

**我将如何以正确的 sql 语法遍历该数组？**

> // 通过每个表名开始循环 <-- 怎么写？

到目前为止我的代码

```
SET @database_name := 'myFirstDb';
SET @second_database_name := 'mySecondDb';

// define array of table names here. <-- how to form this?
SET @table_name_array = ('tableFive', 'tableSeven', 'tableNine', 'tableFifteen', 'tableNineteen', 'tableNth', 'tableMaybeOneMore');

// start loop thru each table name <-- how to write this?

SET @table_name := 'value';
SET @second_db_table_name := @table_name;

CREATE TABLE @second_db_table_name LIKE @table_name
ALTER TABLE @second_db_table_name DISABLE KEYS
INSERT INTO @second_db_table_name SELECT * FROM @table_name
ALTER TABLE @table_name ENABLE KEYS

//end loop here 
```

# shell - 对多个查找结果执行 grep

> ID：15621079
> 
> 赞同：0
> 
> 时间：2013-03-25T17:28:32.523
> 
> 标签：shell, grep, cygwin

[我的问题与这个](https://stackoverflow.com/questions/1133698/find-name-pattern-that-matches-multiple-patterns)问题非常相似，只是我正在`grep`对多个`find`查询执行搜索。（我必须这样做，因为我必须将我的命令提交给实时服务器，并且我想尽可能少地修补它们。）

这是我的查询：

`find /c/some/dir/ -iname "*html" -o -iname "*tpl" -exec grep -inH 'search_string' {} \;`

使用 -o 选项，grep 搜索将返回以 tpl 结尾的文件中的所有“search_string”实例。它完全忽略了我传入的 html 扩展...

有没有人遇到过这个？如何告诉 find 在 html 和 tpl 扩展上执行 grep？

（我正在运行 Cygwin，它过去曾出现过一些 Windows 翻译问题，所以这可能是罪魁祸首......）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:23:57.397

我认为您需要将这两个`-iname`子句分组，如下所示：

```
find /c/some/dir/ \( -iname "*html" -o -iname "*tpl" \) -exec grep -inH 'search_string' {} \; 
```

逻辑 or 具有较低的优先级，这意味着这些`-exec`位仅适用于您的`-iname "*tpl"`子句。

# c# - 删除 Grid 的指定子元素

> ID：15621080
> 
> 赞同：5
> 
> 时间：2013-03-25T17:28:40.280
> 
> 标签：c#, wpf, grid, children

我需要在运行时删除 Grid (grid1) 的指定元素。这是我添加元素的代码。

```
 examControls.Add(excontrol);  // add the element on the ArrayList
 excontrol.Margin = new Thickness(x, y + margin, 0, 0);
 grid1.Children.Add(excontrol); 
```

如何在运行时删除指定的“excontrol”元素（在运行时添加）？

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-25T17:35:48.830

如果您保留控件的记录，您可以简单地执行以下操作：

```
grid1.Children.Remove(excontrol); 
```

如果您没有包含要删除的控件的变量，则必须以某种方式识别它（标记、名称），然后在网格的子项中找到该控件，然后调用`Remove`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-25T17:36:02.337

```
grid1.Children.Remove(excontrol) //edited per your edit -- this is exactly what ChrisF posted though 
```

或者

```
grid1.Children.RemoveAt(index) 
```

# php - Ajax 调用不会通过 - 表单总是由 php 提交

> ID：15621081
> 
> 赞同：0
> 
> 时间：2013-03-25T17:28:41.867
> 
> 标签：php, jquery, ajax

我有一个默认情况下使用 php uri_request 提交的表单。现在我试图添加一个 ajax 调用来提交表单，但它仍然使用 php 提交提交表单的 ajax 调用是：

```
$(document).ready(function() {
    $("#contactform").submit(function(e) {
        e.preventDefault();
    });
    $.ajax({
        cache: false,
        type: 'POST',
        data: ("#contactform").serialize(),
        url: 'formfiles/submit.php',
        // for ajax the submit.php is on a             
        success: function() {
            // separate page 
            $('#contactform').fadeOut(200).submit();
            $('#success').delay(200).fadeIn(200);
        }
    });
    return false;

}); 
```

和 html 表单属性是：

```
<form action="#n" class="active" method="post" name="contactform" id="contactform"> 
```

还有

```
 e.preventDefault 
```

在 ajax 调用开始时不起作用，但没有 ajax 它可以工作（只有阻止默认！）

代码有什么问题？为什么它不起作用？

提前感谢您的帮助

**编辑** 这里是 html {在一个包含文件中（洞网站是一个 php 动态结构）}

```
<form action="#n" class="active" method="post" name="contactform" id="contactform">

<div class="column">
    <div class="obb" style="<?php echo $color[11];?>">
                    All fields are mandatory
                    </div>
      <div >
<label style="<?php echo $color[0]; ?>"> Name:</label>
    <input class="con_campo required" name="name" value="" id="name" type="text" />

        </div>
        <div >
          <label style=""><?php echo $color[8]; ?>&nbsp;</label>                                                    

  </div>
<div class="fieldcontent prod" id="pr">
                   <label style="">&nbsp;<?php echo $color[2]; ?></label>
<select name="prod" value="" id="products" class="selectx required">
  <option  value=""> -- Select -- </option>
  <option value="1"> ITA</option>
 <option value="2">DE</option>
 <option value="3"> FR</option>
 <option value="4">EN</option>

  </select>

                </div>
            <div class="fieldcontent prod" id="in">
                <label style="<?php echo $color[4]; ?>"> Address:</label>
<input name="address" value="" id="address" class="required" type="text"     />

                        </div>
                         <div class="fieldcontent prod" id="ci">
                        <label style="<?php echo $color[6]; ?>"> City:</label>
   <input name="city" value="" id="city" class="con_campo required" type="text" />

                       </div>
                        <div class="fieldcontent info help" id="me" >
                          <label style="<?php echo $color[10]; ?>">Message:</label>
<textarea id="message" name="message" value="" class="cs_comment required" ></textarea>

                        </div>
                        <div id="code" style="margin-bottom:25px;">
     <label style="<?php echo $color[11]; ?>; width:340px;"></label> 
<input type="text" name="code" class="chapta" size="10" maxlength="7" id="code"/>

                        </div>
            </div>
<div class="column" >
                 <div class="obb">&nbsp;</div>
<div class="fieldcontent prod" id="co">
    <label style="<?php echo $color[1]; ?>">Surname:</label>
<input name="surname" value="" id="surname" class=" required" type="text"/>

            </div>
            <div >
<label style="<?php echo $color[9]; ?>">Email: </label>
<input name="email" value="" id="email" class=" required email" type="text" />

</div>
 <div class="fieldcontent help prod" id="do">
<label style="<?php echo $color[3]; ?>">Domain:</label>
            <span style="font-size:20px; margin-left:30px;"> http://</span>
<input name="domain"  id="domain" class=" required" type="text" value="" />

            </div>
                        <div class="fieldcontent prod" id="re">
    <label style="<?php echo $color[5]; ?>">Region:</label>
   <input name="region" value="" id="region" class=" required" type="text" />

                        </div>
               <div class="fieldcontent prod" id="pa">
<label style="<?php echo $color[7]; ?>" >State:</label>
<input name="state" value="" id="state" class="con_campo required" type="text" />

                        </div>
                    </div>

                  <div>
        <div class="bottom">

<input type="submit" id="submitButton" name="submit" value="submit" />
                        &nbsp;<br /><br /><br />&nbsp;

        </div>
                </form>
 </div></div>

<script> 
$(document).ready(function() {
$("#contactform").submit(function(e){
    $.ajax({
        cache: false,
        type: 'POST',
        data: $("#contactform").serialize(),
        url : 'formfiles/submit.php',   // for ajax the submit.php is on a             
        success: function() {            // separate page 
            $('#contactform').fadeOut(200).submit();
            $('#success').delay(200).fadeIn(200);
        }
    }); 
  });
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:32:47.983

您在行中的 ajax 调用中有错误`data: ("#contactform").serialize()`。它应该是 `data: $("#contactform").serialize()`

尝试这个 ：

```
$(document).ready(function() {
    $("#contactform").submit(function(e){
        $.ajax({
            cache: false,
            type: 'POST',
            data: $("#contactform").serialize(),
            url : 'formfiles/submit.php',   // for ajax the submit.php is on a             
            success: function() {            // separate page 
                $('#contactform').fadeOut(200).submit();
                $('#success').delay(200).fadeIn(200);
            },
            error: function(error_response){
               console.log(error_response);
            }
        }); 
    });
}); 
```

**更新 ：**

我发现您的代码存在一些问题。

1.  是否加载了所需的 jQuery 库？我在您粘贴的 html 中没有看到。希望您已将其包含在标题中。
2.  添加一个`e.preventDefault ();`以防止表单的默认操作，因为输入类型是`submit`. 如果您不输入该表单，则默认方法将提交该表单。
3.  我没有看到`script`标签关闭。您应该关闭`script`标签，否则它将不起作用。请参阅下面的更新代码：

    ```
    <script type="text/javascript">
       $(document).ready(function() {
        $("#contactform").submit(function(e){
            e.preventDefault();
            $.ajax({
                cache: false,
                type: 'POST',
                data: $("#contactform").serialize(),
                url : 'formfiles/submit.php',   // for ajax the submit.php is on a             
                success: function() {            // separate page 
                    $('#contactform').fadeOut(200).submit();
                    $('#success').delay(200).fadeIn(200);
                }
            }); 
        });
       });
    </script> 
    ```

**新更新**

在这里，您的 ajax 调用不返回任何数据。所以服务器不会知道调用是否成功，它会一直转到成功函数。所以你必须检查响应是否成功。从 PHP 页面返回一些字符串，`success`以显示验证或表单提交及其处理是否成功，否则返回错误。同样在成功回调时，您再次提交表单，因此这将继续作为一个永无止境的循环。

请进行以下更改：

```
<script type="text/javascript">
   $(document).ready(function() {
    $("#contactform").submit(function(e){
        e.preventDefault();
        $.ajax({
            cache: false,
            type: 'POST',
            data: $("#contactform").serialize(),
            url : 'formfiles/submit.php',   // for ajax the submit.php is on a             
            success: function(response) {            // separate page 
                if (response == 'success') {
                  //write what you want to do on success
                    $('#success').delay(200).fadeIn(200);
                } else {
                  //show error
                }
            }
        }); 
    });
   });
</script> 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:31:49.063

您可以重组代码以解决问题，如下所示。你不需要`return false;`，因为`e.preventDefault();`它会照顾好它。

```
$(document).ready(function () {

    $("#contactform").submit(function (e) {

        e.preventDefault();

        $.ajax({
            cache: false,
            type: 'POST',
            data: $("#contactform").serialize(), //note that $ mark is added
            url: 'formfiles/submit.php', // for ajax the submit.php is on a             
            success: function () { // separate page 
                $('#contactform').fadeOut(200).submit();
                $('#success').delay(200).fadeIn(200);
            }
        });

    });

}); 
```

# java - 为什么 Java switch on contiguous ints 似乎在添加案例时运行得更快？

> ID：15621083
> 
> 赞同：282
> 
> 时间：2013-03-25T17:28:45.367
> 
> 标签：java, performance, assembly, compiler-construction, switch-statement

我正在处理一些需要高度优化的 Java 代码，因为它将在我的主程序逻辑中的许多点调用的热函数中运行。此代码的一部分涉及将`double`变量乘以`10`任意非负`int` `exponent`s。获得相乘值的一种快速方法（编辑：但不是最快的，请参见下面的更新 2）是`switch`在`exponent`：

```
double multiplyByPowerOfTen(final double d, final int exponent) {
   switch (exponent) {
      case 0:
         return d;
      case 1:
         return d*10;
      case 2:
         return d*100;
      // ... same pattern
      case 9:
         return d*1000000000;
      case 10:
         return d*10000000000L;
      // ... same pattern with long literals
      case 18:
         return d*1000000000000000000L;
      default:
         throw new ParseException("Unhandled power of ten " + power, 0);
   }
} 
```

上面注释的省略号表示`case` `int`常量继续递增 1，因此上面的代码片段中确实有 19 `case`s。由于我不确定在`case`语句`10`thru中是否真的需要 10 的所有幂`18`，我运行了一些微基准测试，比较了使用此`switch`语句完成 1000 万次操作的时间`switch`与仅使用`case`s `0`thru`9`的时间（`exponent`限制为 9 或更少避免打破精简`switch`）。我得到了一个相当令人惊讶的结果（至少对我来说！），越长`switch`的`case`语句实际上运行得越快。

在云雀上，我尝试添加更多`case`的 s ，它只是返回了虚拟值，并发现我可以让开关运行得更快，大约 22-27 个声明`case`的 s （即使在代码运行时这些虚拟案例实际上从未被命中） ）。（同样，通过将先前常数`case`增加 s 以连续方式添加 s 。）这些执行时间差异不是很显着：对于 和 之间的随机，虚拟填充语句在 1.49 秒内完成 1000 万次执行，而未填充语句为 1.54 秒版本，每次执行总共节省 5ns。所以，不是那种让人痴迷于填充的东西`case``1``exponent``0``10``switch``switch`从优化的角度来看，声明值得付出努力。但是我仍然觉得奇怪和违反直觉的是，当添加更多的 s 时，它的 执行`switch`速度并没有变慢（或者可能充其量保持恒定的*O(1)*时间） 。`case`

![切换基准测试结果](../Images/e218f283d5c110324fb835320fc62133.png)

这些是我通过对随机生成的`exponent`值进行各种限制而获得的结果。我没有将结果一直计算到`1`极限`exponent`，但曲线的总体形状保持不变，在 12-17 的情况下有一个山脊，在 18-28 之间有一个谷。所有测试都在 JUnitBenchmarks 中运行，使用共享容器获取随机值，以确保相同的测试输入。我还按照从最长`switch`语句到最短语句的顺序运行了测试，反之亦然，以尝试消除与排序相关的测试问题的可能性。如果有人想尝试重现这些结果，我已经将我的测试代码放在了 github repo 上。

那么，这里发生了什么？我的架构或微基准构建的一些变幻莫测？还是 Java在to范围内`switch`的执行速度真的比up to快一点？`18``28` `case``11``17`

[github 测试仓库“切换实验”](https://github.com/abissell/switch-experiment)

**更新：**我清理了基准测试库，并在 /results 中添加了一个文本文件，其中包含更广泛的可能`exponent`值的一些输出。我还在测试代码中添加了一个选项，不要抛出`Exception`from `default`，但这似乎不会影响结果。

**更新 2：**在 2009 年的 xkcd 论坛上发现了一些关于这个问题的很好的讨论：[http](http://forums.xkcd.com/viewtopic.php?f=11&t=33524) ://forums.xkcd.com/viewtopic.php?f=11&t=33524 。OP 对 using 的讨论`Array.binarySearch()`让我想到了上面求幂模式的简单的基于数组的实现。不需要二进制搜索，因为我知道其中的条目是什么`array`。它的运行速度似乎比 using 快 3 倍左右`switch`，显然是以牺牲一些提供的控制流为代价的`switch`。该代码也已添加到 github 存储库中。

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2013-03-25T17:59:57.843

As pointed out [by the other answer](https://stackoverflow.com/a/15621857/632951), because the case values are contiguous (as opposed to sparse), the generated bytecode for your various tests uses a switch table (bytecode instruction `tableswitch`).

However, once the JIT starts its job and compiles the bytecode into assembly, the `tableswitch` instruction does not always result in an array of pointers: sometimes the switch table is transformed into what looks like a `lookupswitch` (similar to an `if`/`else if` structure).

Decompiling the assembly generated by the JIT (hotspot JDK 1.7) shows that it uses a succession of if/else if when there are 17 cases or less, an array of pointers when there are more than 18 (more efficient).

The reason why this magic number of 18 is used seems to come down to the default value of the [`MinJumpTableSize`](http://hg.openjdk.java.net/jdk7/jdk7/hotspot/file/357d4e2eb4dd/src/share/vm/opto/c2_globals.hpp) JVM flag (around line 352 in the code).

I have raised the issue on the hotspot compiler list and [it seems to be a legacy of past testing](http://mail.openjdk.java.net/pipermail/hotspot-compiler-dev/2013-March/009998.html). Note that this default value [has been removed in JDK 8](http://hg.openjdk.java.net/jdk8/jdk8/hotspot/rev/34bd5e86aadb) after [more benchmarking was performed](http://mail.openjdk.java.net/pipermail/hotspot-compiler-dev/2013-May/010670.html).

Finally, when the method becomes too long (> 25 cases in my tests), it is in not inlined any longer with the default JVM settings - that is the likeliest cause for the drop in performance at that point.

* * *

With 5 cases, the decompiled code looks like this (notice the cmp/je/jg/jmp instructions, the assembly for if/goto):

```
[Verified Entry Point]
  # {method} 'multiplyByPowerOfTen' '(DI)D' in 'javaapplication4/Test1'
  # parm0:    xmm0:xmm0   = double
  # parm1:    rdx       = int
  #           [sp+0x20]  (sp of caller)
  0x00000000024f0160: mov    DWORD PTR [rsp-0x6000],eax
                                                ;   {no_reloc}
  0x00000000024f0167: push   rbp
  0x00000000024f0168: sub    rsp,0x10           ;*synchronization entry
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@-1 (line 56)
  0x00000000024f016c: cmp    edx,0x3
  0x00000000024f016f: je     0x00000000024f01c3
  0x00000000024f0171: cmp    edx,0x3
  0x00000000024f0174: jg     0x00000000024f01a5
  0x00000000024f0176: cmp    edx,0x1
  0x00000000024f0179: je     0x00000000024f019b
  0x00000000024f017b: cmp    edx,0x1
  0x00000000024f017e: jg     0x00000000024f0191
  0x00000000024f0180: test   edx,edx
  0x00000000024f0182: je     0x00000000024f01cb
  0x00000000024f0184: mov    ebp,edx
  0x00000000024f0186: mov    edx,0x17
  0x00000000024f018b: call   0x00000000024c90a0  ; OopMap{off=48}
                                                ;*new  ; - javaapplication4.Test1::multiplyByPowerOfTen@72 (line 83)
                                                ;   {runtime_call}
  0x00000000024f0190: int3                      ;*new  ; - javaapplication4.Test1::multiplyByPowerOfTen@72 (line 83)
  0x00000000024f0191: mulsd  xmm0,QWORD PTR [rip+0xffffffffffffffa7]        # 0x00000000024f0140
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@52 (line 62)
                                                ;   {section_word}
  0x00000000024f0199: jmp    0x00000000024f01cb
  0x00000000024f019b: mulsd  xmm0,QWORD PTR [rip+0xffffffffffffff8d]        # 0x00000000024f0130
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@46 (line 60)
                                                ;   {section_word}
  0x00000000024f01a3: jmp    0x00000000024f01cb
  0x00000000024f01a5: cmp    edx,0x5
  0x00000000024f01a8: je     0x00000000024f01b9
  0x00000000024f01aa: cmp    edx,0x5
  0x00000000024f01ad: jg     0x00000000024f0184  ;*tableswitch
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@1 (line 56)
  0x00000000024f01af: mulsd  xmm0,QWORD PTR [rip+0xffffffffffffff81]        # 0x00000000024f0138
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@64 (line 66)
                                                ;   {section_word}
  0x00000000024f01b7: jmp    0x00000000024f01cb
  0x00000000024f01b9: mulsd  xmm0,QWORD PTR [rip+0xffffffffffffff67]        # 0x00000000024f0128
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@70 (line 68)
                                                ;   {section_word}
  0x00000000024f01c1: jmp    0x00000000024f01cb
  0x00000000024f01c3: mulsd  xmm0,QWORD PTR [rip+0xffffffffffffff55]        # 0x00000000024f0120
                                                ;*tableswitch
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@1 (line 56)
                                                ;   {section_word}
  0x00000000024f01cb: add    rsp,0x10
  0x00000000024f01cf: pop    rbp
  0x00000000024f01d0: test   DWORD PTR [rip+0xfffffffffdf3fe2a],eax        # 0x0000000000430000
                                                ;   {poll_return}
  0x00000000024f01d6: ret 
```

With 18 cases, the assembly looks like this (notice the array of pointers which is used and suppresses the need for all the comparisons: `jmp QWORD PTR [r8+r10*1]` jumps directly to the right multiplication) - that is the likely reason for the performance improvement:

```
[Verified Entry Point]
  # {method} 'multiplyByPowerOfTen' '(DI)D' in 'javaapplication4/Test1'
  # parm0:    xmm0:xmm0   = double
  # parm1:    rdx       = int
  #           [sp+0x20]  (sp of caller)
  0x000000000287fe20: mov    DWORD PTR [rsp-0x6000],eax
                                                ;   {no_reloc}
  0x000000000287fe27: push   rbp
  0x000000000287fe28: sub    rsp,0x10           ;*synchronization entry
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@-1 (line 56)
  0x000000000287fe2c: cmp    edx,0x13
  0x000000000287fe2f: jae    0x000000000287fe46
  0x000000000287fe31: movsxd r10,edx
  0x000000000287fe34: shl    r10,0x3
  0x000000000287fe38: movabs r8,0x287fd70       ;   {section_word}
  0x000000000287fe42: jmp    QWORD PTR [r8+r10*1]  ;*tableswitch
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@1 (line 56)
  0x000000000287fe46: mov    ebp,edx
  0x000000000287fe48: mov    edx,0x31
  0x000000000287fe4d: xchg   ax,ax
  0x000000000287fe4f: call   0x00000000028590a0  ; OopMap{off=52}
                                                ;*new  ; - javaapplication4.Test1::multiplyByPowerOfTen@202 (line 96)
                                                ;   {runtime_call}
  0x000000000287fe54: int3                      ;*new  ; - javaapplication4.Test1::multiplyByPowerOfTen@202 (line 96)
  0x000000000287fe55: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe8b]        # 0x000000000287fce8
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@194 (line 92)
                                                ;   {section_word}
  0x000000000287fe5d: jmp    0x000000000287ff16
  0x000000000287fe62: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe86]        # 0x000000000287fcf0
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@188 (line 90)
                                                ;   {section_word}
  0x000000000287fe6a: jmp    0x000000000287ff16
  0x000000000287fe6f: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe81]        # 0x000000000287fcf8
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@182 (line 88)
                                                ;   {section_word}
  0x000000000287fe77: jmp    0x000000000287ff16
  0x000000000287fe7c: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe7c]        # 0x000000000287fd00
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@176 (line 86)
                                                ;   {section_word}
  0x000000000287fe84: jmp    0x000000000287ff16
  0x000000000287fe89: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe77]        # 0x000000000287fd08
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@170 (line 84)
                                                ;   {section_word}
  0x000000000287fe91: jmp    0x000000000287ff16
  0x000000000287fe96: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe72]        # 0x000000000287fd10
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@164 (line 82)
                                                ;   {section_word}
  0x000000000287fe9e: jmp    0x000000000287ff16
  0x000000000287fea0: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe70]        # 0x000000000287fd18
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@158 (line 80)
                                                ;   {section_word}
  0x000000000287fea8: jmp    0x000000000287ff16
  0x000000000287feaa: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe6e]        # 0x000000000287fd20
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@152 (line 78)
                                                ;   {section_word}
  0x000000000287feb2: jmp    0x000000000287ff16
  0x000000000287feb4: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe24]        # 0x000000000287fce0
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@146 (line 76)
                                                ;   {section_word}
  0x000000000287febc: jmp    0x000000000287ff16
  0x000000000287febe: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe6a]        # 0x000000000287fd30
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@140 (line 74)
                                                ;   {section_word}
  0x000000000287fec6: jmp    0x000000000287ff16
  0x000000000287fec8: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe68]        # 0x000000000287fd38
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@134 (line 72)
                                                ;   {section_word}
  0x000000000287fed0: jmp    0x000000000287ff16
  0x000000000287fed2: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe66]        # 0x000000000287fd40
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@128 (line 70)
                                                ;   {section_word}
  0x000000000287feda: jmp    0x000000000287ff16
  0x000000000287fedc: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe64]        # 0x000000000287fd48
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@122 (line 68)
                                                ;   {section_word}
  0x000000000287fee4: jmp    0x000000000287ff16
  0x000000000287fee6: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe62]        # 0x000000000287fd50
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@116 (line 66)
                                                ;   {section_word}
  0x000000000287feee: jmp    0x000000000287ff16
  0x000000000287fef0: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe60]        # 0x000000000287fd58
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@110 (line 64)
                                                ;   {section_word}
  0x000000000287fef8: jmp    0x000000000287ff16
  0x000000000287fefa: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe5e]        # 0x000000000287fd60
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@104 (line 62)
                                                ;   {section_word}
  0x000000000287ff02: jmp    0x000000000287ff16
  0x000000000287ff04: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe5c]        # 0x000000000287fd68
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@98 (line 60)
                                                ;   {section_word}
  0x000000000287ff0c: jmp    0x000000000287ff16
  0x000000000287ff0e: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe12]        # 0x000000000287fd28
                                                ;*tableswitch
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@1 (line 56)
                                                ;   {section_word}
  0x000000000287ff16: add    rsp,0x10
  0x000000000287ff1a: pop    rbp
  0x000000000287ff1b: test   DWORD PTR [rip+0xfffffffffd9b00df],eax        # 0x0000000000230000
                                                ;   {poll_return}
  0x000000000287ff21: ret 
```

And finally the assembly with 30 cases (below) looks similar to 18 cases, except for the additional `movapd xmm0,xmm1` that appears towards the middle of the code, [as spotted by @cHao](https://stackoverflow.com/q/15621083/632951#comment-22166408) - however the likeliest reason for the drop in performance is that the method is too long to be inlined with the default JVM settings:

```
[Verified Entry Point]
  # {method} 'multiplyByPowerOfTen' '(DI)D' in 'javaapplication4/Test1'
  # parm0:    xmm0:xmm0   = double
  # parm1:    rdx       = int
  #           [sp+0x20]  (sp of caller)
  0x0000000002524560: mov    DWORD PTR [rsp-0x6000],eax
                                                ;   {no_reloc}
  0x0000000002524567: push   rbp
  0x0000000002524568: sub    rsp,0x10           ;*synchronization entry
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@-1 (line 56)
  0x000000000252456c: movapd xmm1,xmm0
  0x0000000002524570: cmp    edx,0x1f
  0x0000000002524573: jae    0x0000000002524592  ;*tableswitch
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@1 (line 56)
  0x0000000002524575: movsxd r10,edx
  0x0000000002524578: shl    r10,0x3
  0x000000000252457c: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe3c]        # 0x00000000025243c0
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@364 (line 118)
                                                ;   {section_word}
  0x0000000002524584: movabs r8,0x2524450       ;   {section_word}
  0x000000000252458e: jmp    QWORD PTR [r8+r10*1]  ;*tableswitch
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@1 (line 56)
  0x0000000002524592: mov    ebp,edx
  0x0000000002524594: mov    edx,0x31
  0x0000000002524599: xchg   ax,ax
  0x000000000252459b: call   0x00000000024f90a0  ; OopMap{off=64}
                                                ;*new  ; - javaapplication4.Test1::multiplyByPowerOfTen@370 (line 120)
                                                ;   {runtime_call}
  0x00000000025245a0: int3                      ;*new  ; - javaapplication4.Test1::multiplyByPowerOfTen@370 (line 120)
  0x00000000025245a1: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe27]        # 0x00000000025243d0
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@358 (line 116)
                                                ;   {section_word}
  0x00000000025245a9: jmp    0x0000000002524744
  0x00000000025245ae: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe22]        # 0x00000000025243d8
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@348 (line 114)
                                                ;   {section_word}
  0x00000000025245b6: jmp    0x0000000002524744
  0x00000000025245bb: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe1d]        # 0x00000000025243e0
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@338 (line 112)
                                                ;   {section_word}
  0x00000000025245c3: jmp    0x0000000002524744
  0x00000000025245c8: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe18]        # 0x00000000025243e8
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@328 (line 110)
                                                ;   {section_word}
  0x00000000025245d0: jmp    0x0000000002524744
  0x00000000025245d5: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe13]        # 0x00000000025243f0
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@318 (line 108)
                                                ;   {section_word}
  0x00000000025245dd: jmp    0x0000000002524744
  0x00000000025245e2: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe0e]        # 0x00000000025243f8
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@308 (line 106)
                                                ;   {section_word}
  0x00000000025245ea: jmp    0x0000000002524744
  0x00000000025245ef: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe09]        # 0x0000000002524400
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@298 (line 104)
                                                ;   {section_word}
  0x00000000025245f7: jmp    0x0000000002524744
  0x00000000025245fc: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe04]        # 0x0000000002524408
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@288 (line 102)
                                                ;   {section_word}
  0x0000000002524604: jmp    0x0000000002524744
  0x0000000002524609: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffdff]        # 0x0000000002524410
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@278 (line 100)
                                                ;   {section_word}
  0x0000000002524611: jmp    0x0000000002524744
  0x0000000002524616: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffdfa]        # 0x0000000002524418
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@268 (line 98)
                                                ;   {section_word}
  0x000000000252461e: jmp    0x0000000002524744
  0x0000000002524623: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffd9d]        # 0x00000000025243c8
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@258 (line 96)
                                                ;   {section_word}
  0x000000000252462b: jmp    0x0000000002524744
  0x0000000002524630: movapd xmm0,xmm1
  0x0000000002524634: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffe0c]        # 0x0000000002524448
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@242 (line 92)
                                                ;   {section_word}
  0x000000000252463c: jmp    0x0000000002524744
  0x0000000002524641: movapd xmm0,xmm1
  0x0000000002524645: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffddb]        # 0x0000000002524428
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@236 (line 90)
                                                ;   {section_word}
  0x000000000252464d: jmp    0x0000000002524744
  0x0000000002524652: movapd xmm0,xmm1
  0x0000000002524656: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffdd2]        # 0x0000000002524430
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@230 (line 88)
                                                ;   {section_word}
  0x000000000252465e: jmp    0x0000000002524744
  0x0000000002524663: movapd xmm0,xmm1
  0x0000000002524667: mulsd  xmm0,QWORD PTR [rip+0xfffffffffffffdc9]        # 0x0000000002524438
                                                ;*dmul
                                                ; - javaapplication4.Test1::multiplyByPowerOfTen@224 (line 86)
                                                ;   {section_word}

[etc.]

  0x0000000002524744: add    rsp,0x10
  0x0000000002524748: pop    rbp
  0x0000000002524749: test   DWORD PTR [rip+0xfffffffffde1b8b1],eax        # 0x0000000000340000
                                                ;   {poll_return}
  0x000000000252474f: ret 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2013-03-25T17:34:32.183

如果将 case 值放在一个狭窄的范围内，则 Switch - case 会更快。

```
case 1:
case 2:
case 3:
..
..
case n: 
```

因为，在这种情况下，编译器可以避免对 switch 语句中的每个 case 分支执行比较。编译器制作一个跳转表，其中包含要在不同腿上采取的动作的地址。正在执行切换的值被操作以将其转换为[`jump table`](http://en.wikipedia.org/wiki/Branch_table). 在此实现中，switch 语句所用的时间远少于等效 if-else-if 语句级联所用的时间。此外，switch 语句所用的时间与 switch 语句中的 case 分支数无关。

正如维基百科中关于编译部分的[switch 语句所述。](http://en.wikipedia.org/wiki/Switch_statement)

> 如果输入值的范围可以识别为“小”并且只有几个间隙，则某些包含优化器的编译器实际上可能将 switch 语句实现为分支表或索引函数指针数组，而不是冗长的一系列条件指令。这允许 switch 语句立即确定要执行的分支，而无需通过比较列表。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-03-25T18:14:55.777

答案在于字节码：

**SwitchTest10.java**

```
public class SwitchTest10 {

    public static void main(String[] args) {
        int n = 0;

        switcher(n);
    }

    public static void switcher(int n) {
        switch(n) {
            case 0: System.out.println(0);
                    break;

            case 1: System.out.println(1);
                    break;

            case 2: System.out.println(2);
                    break;

            case 3: System.out.println(3);
                    break;

            case 4: System.out.println(4);
                    break;

            case 5: System.out.println(5);
                    break;

            case 6: System.out.println(6);
                    break;

            case 7: System.out.println(7);
                    break;

            case 8: System.out.println(8);
                    break;

            case 9: System.out.println(9);
                    break;

            case 10: System.out.println(10);
                    break;

            default: System.out.println("test");
        }
    }       
} 
```

**对应的字节码；仅显示相关部分：**

```
public static void switcher(int);
  Code:
   0:   iload_0
   1:   tableswitch{ //0 to 10
        0: 60;
        1: 70;
        2: 80;
        3: 90;
        4: 100;
        5: 110;
        6: 120;
        7: 131;
        8: 142;
        9: 153;
        10: 164;
        default: 175 } 
```

**SwitchTest22.java：**

```
public class SwitchTest22 {

    public static void main(String[] args) {
        int n = 0;

        switcher(n);
    }

    public static void switcher(int n) {
        switch(n) {
            case 0: System.out.println(0);
                    break;

            case 1: System.out.println(1);
                    break;

            case 2: System.out.println(2);
                    break;

            case 3: System.out.println(3);
                    break;

            case 4: System.out.println(4);
                    break;

            case 5: System.out.println(5);
                    break;

            case 6: System.out.println(6);
                    break;

            case 7: System.out.println(7);
                    break;

            case 8: System.out.println(8);
                    break;

            case 9: System.out.println(9);
                    break;

            case 100: System.out.println(10);
                    break;

            case 110: System.out.println(10);
                    break;
            case 120: System.out.println(10);
                    break;
            case 130: System.out.println(10);
                    break;
            case 140: System.out.println(10);
                    break;
            case 150: System.out.println(10);
                    break;
            case 160: System.out.println(10);
                    break;
            case 170: System.out.println(10);
                    break;
            case 180: System.out.println(10);
                    break;
            case 190: System.out.println(10);
                    break;
            case 200: System.out.println(10);
                    break;
            case 210: System.out.println(10);
                    break;

            case 220: System.out.println(10);
                    break;

            default: System.out.println("test");
        }
    }       
} 
```

**对应的字节码；同样，仅显示相关部分：**

```
public static void switcher(int);
  Code:
   0:   iload_0
   1:   lookupswitch{ //23
        0: 196;
        1: 206;
        2: 216;
        3: 226;
        4: 236;
        5: 246;
        6: 256;
        7: 267;
        8: 278;
        9: 289;
        100: 300;
        110: 311;
        120: 322;
        130: 333;
        140: 344;
        150: 355;
        160: 366;
        170: 377;
        180: 388;
        190: 399;
        200: 410;
        210: 421;
        220: 432;
        default: 443 } 
```

在第一种情况下，范围很窄，编译后的字节码使用`tableswitch`. 在第二种情况下，编译后的字节码使用`lookupswitch`.

在`tableswitch`中，堆栈顶部的整数值用于索引到表中，以找到分支/跳转目标。然后立即执行此跳转/分支。因此，这是一个`O(1)`操作。

A`lookupswitch`比较复杂。在这种情况下，需要将整数值与表中的所有键进行比较，直到找到正确的键。找到键后，将使用分支/跳转目标（该键映射到的）进行跳转。中使用的表`lookupswitch`已排序，并且可以使用二进制搜索算法找到正确的键。性能为二分查找`O(log n)`，整个过程也是`O(log n)`，因为跳转还在`O(1)`。所以在稀疏范围的情况下性能较低的原因是必须首先查找正确的键，因为您不能直接索引到表中。

如果存在稀疏值并且您只能`tableswitch`使用 a，则 table 基本上将包含指向该`default`选项的虚拟条目。例如，假设最后一个条目`SwitchTest10.java`是`21`而不是`10`，你会得到：

```
public static void switcher(int);
  Code:
   0:   iload_0
   1:   tableswitch{ //0 to 21
        0: 104;
        1: 114;
        2: 124;
        3: 134;
        4: 144;
        5: 154;
        6: 164;
        7: 175;
        8: 186;
        9: 197;
        10: 219;
        11: 219;
        12: 219;
        13: 219;
        14: 219;
        15: 219;
        16: 219;
        17: 219;
        18: 219;
        19: 219;
        20: 219;
        21: 208;
        default: 219 } 
```

所以编译器基本上创建了这个巨大的表，其中包含间隙之间的虚拟条目，指向`default`指令的分支目标。即使没有`default`，它也会包含指向switch 块*之后的指令的条目。*我做了一些基本的测试，发现如果最后一个索引和前一个索引（`9`）之间的差距大于`35`，它使用 a`lookupswitch`而不是 a `tableswitch`。

该`switch`语句的行为在[Java 虚拟机规范 (§3.10)](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-3.html)中定义：

> 在 switch 的情况很少的情况下，tableswitch 指令的表表示在空间方面变得低效。可以改为使用 lookupswitch 指令。lookupswitch 指令将 int 键（案例标签的值）与表中的目标偏移量配对。当执行lookupswitch 指令时，将switch 表达式的值与表中的键进行比较。如果其中一个键与表达式的值匹配，则在关联的目标偏移处继续执行。如果没有键匹配，则在默认目标处继续执行。[...]

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-03-27T21:58:52.090

由于问题已经得到解答（或多或少），这里有一些提示。利用

```
private static final double[] mul={1d, 10d...};
static double multiplyByPowerOfTen(final double d, final int exponent) {
      if (exponent<0 || exponent>=mul.length) throw new ParseException();//or just leave the IOOBE be
      return mul[exponent]*d;
} 
```

该代码使用的IC（指令缓存）要少得多，并且始终是内联的。如果代码很热，该数组将位于 L1 数据缓存中。查找表几乎总是胜利。（特别是在微基准上：D）

编辑：如果您希望该方法是热内联的，请考虑非快速路径`throw new ParseException()`尽可能短或将它们移动到单独的静态方法（因此使它们尽可能短）。这是`throw new ParseException("Unhandled power of ten " + power, 0);`一个薄弱的想法 b/c 它消耗了大量可以解释的代码的内联预算 - 字符串连接在字节码中非常冗长。更多信息和带有[ArrayList 的真实案例](http://bugs.sun.com/view_bug.do?bug_id=5103956)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-20T15:56:12.217

基于[javac 源码](http://hg.openjdk.java.net/jdk6/jdk6/langtools/file/779c45081059/src/share/classes/com/sun/tools/javac/jvm/Gen.java#l1153)，你可以用它使用的方式编写 switch `tableswitch`。

我们可以使用 javac 源中的计算来计算您的第二个示例的成本。

```
lo = 0
hi = 220
nlabels = 24

table_space_cost = 4 + hi - lo + 1
table_time_cost = 3
lookup_space_cost = 3 + 2 * nlabels
lookup_time_cost = nlabels

table_cost = table_space_cost + 3 * table_time_cost // 234
lookup_cost = lookup_space_cost + 3 * lookup_time_cos // 123 
```

这里 tableswitch 的成本 (234) 比 lookupswitch (123) 高，因此 lookupswitch 将被选为这个 switch 语句的操作码。

# zend-framework - Zend 路由器：将 url 列表组合成单个或列表

> ID：15621085
> 
> 赞同：0
> 
> 时间：2013-03-25T17:28:46.787
> 
> 标签：zend-framework, zend-router

我有几个网址：

*   /戴夫
*   /达维娜
*   /戴夫/克里斯
*   /达维娜/彼得

我的路线中有所有这些条目，例如：

```
routes.dave.route = /dave
routes.dave.defaults.module = default
routes.dave.defaults.controller = person
routes.rcp.defaults.action = index

routes.davina.route = /dave/chris
routes.davina.defaults.module = default
routes.davina.defaults.controller = person
routes.davina.defaults.action = index 
```

我认为您可以立即看到我有重复问题。有没有办法将多个网址组合成一条路线？

我玩过使用 /:person 但我也有其他内容也不会去人控制器。

```
routes.person.route = /:personname
routes.person.defaults.module = default
routes.person.defaults.controller = person
routes.person.defaults.action = index
routes.person.reqs.personname = "^[a-zA-Z0-9]+$" 
```

像 /search?person=dave 这样的 URL 会转到搜索控制器，显然被上面的表达式杀死了。

我可以将需求表述为列表吗？"dave|davina|etc" 还是有另一种神奇的 zend 方法可以做到这一点？

**更新：** 我在玩，遇到了这个部分解决方案：

```
routes.person.route = /:personname
routes.person.defaults.module = default
routes.person.defaults.controller = person
routes.person.defaults.action = index
routes.person.reqs.personname = "(dave|davina)"

routes.person.route = /:person/:personname
routes.person.defaults.module = default
routes.person.defaults.controller = person
routes.person.defaults.action = index
routes.person.reqs.personname = "(chris|peter)" 
```

我将暂时使用它来满足我的要求，但我会保持开放状态（至少一天）供任何人提供建议。主要问题是这两个列表都会增长，这最终会导致问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T01:08:03.020

我想我可能有答案。

在 ZF 中，路由以相反的顺序匹配。所以最后定义的路由是第一个匹配的。

在这种情况下，您应该定义您的`/:person/:personname`路由，然后定义其他静态路由，例如关于页面、联系页面等。

如果我正确理解 Zend，它应该可以工作。这样做很清楚：

```
url=/about
match route "/about"

url=/david/parker
match route "/:person/:personname"
not "/about" or "/contact" 
```

# xcode - 资产库崩溃应用程序，日志中没有任何消息

> ID：15621088
> 
> 赞同：1
> 
> 时间：2013-03-25T17:28:51.843
> 
> 标签：xcode, crash, enumeration, alassetslibrary, photolibrary

那是登录组织者

```
进程
     名称 rpages recent_max [原因]（状态）

      MobileMail 1557 1557 [vm]（简历）（续）
     手机 1479 1479 [vm]（简历）（续）
            tccd 318 320 [vm]（守护进程）
         Testare 2293 2293 [vm]（最前面）（简历）
            ptpd 1350 1350（守护进程）
     数据访问 1589 1589（守护进程）
      aosnotifyd 512 512（守护进程）
    mediaserverd 12077 12077（守护进程）
         assetsd 1170 1170（守护进程）
           wifid 773 773（守护进程）
   iaptransportd 266 266（守护进程）
        异形 592 592（守护进程）
       位于 1373 1373（守护进程）
         syslogd 185 185（守护进程）
     跳板 7838 7838                     
      篮板 5776 5776（守护进程）
        BTServer 498 498（守护进程）
         imagent 668 668（守护进程）
         配置 741 741（守护进程）
       锁定 353 353（守护进程）
          powerd 192 192（守护进程）
   mDNSResponder 294 294（守护进程）
   fairplayd.N42 166 166（守护进程）
  UserEventAgent 720 720（守护进程）
       安全 159 160（守护进程）
           amfid 219 219（守护进程）
     调试服务器 0 0（守护进程）
   syncdefaultsd 459 459（守护进程）
         lockbot 475 475（守护进程）
跳板服务 0 0（守护进程）
       CVMServer 89 89（守护进程）
notification_pro 161 161（守护进程）
            afcd 157 157（守护进程）
文件协调 214 214（守护进程）
       distnoted 141 141（守护进程）
            apsd 438 438（守护进程）
      聚合 109 109（守护进程）
        联网 215 215（守护进程）
       fseventsd 277 277（守护进程）
      CommCenter 1760 1760（守护进程）
         通知 226 226（守护进程）
     ReportCrash 331 333（守护进程）

**结尾**

```

没有突出显示线程。这是代码

```
   void (^assetEnumerator)(ALAsset *, NSUInteger, BOOL *) = ^(ALAsset *result, NSUInteger index, BOOL *stop) {
        如果（结果！= NULL）{
            NSLog(@"查看资产：%@", 结果);
            NSLog(@"索引: %d", index);
            ALAssetRepresentation *rep = result.defaultRepresentation;
            NSLog(@"URL: %@", rep.url);
            UIImage *image = [UIImage imageWithCGImage:rep.fullScreenImage];
            [self performSelectorInBackground:@selector(selectImage:) withObject:image];       
         }
    };

    void (^assetGroupEnumerator)(ALAssetsGroup *, BOOL *) = ^(ALAssetsGroup *group, BOOL *stop) {
        如果（组！=零）{
            NSLog(@"GRUP Desc:%@",[group valueForProperty:ALAssetsGroupPropertyType]);
            NSLog(@"GRUP Desc:%@",group.description);
            NSNumber *type = (NSNumber *)[group valueForProperty:ALAssetsGroupPropertyType];
            NSLog(@"GRUP Desc:%@",NSStringFromClass([type class]));
            int 提示 = [类型 intValue];
            [组 setAssetsFilter:[ALAssetsFilter allPhotos]];
            [组 enumerateAssetsUsingBlock:assetEnumerator];
        }
    };

    ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];
    [库枚举GroupsWithTypes：ALAssetsGroupAll
                           usingBlock:assetGroupEnumerator
                         失败块：^(NSError *error) {
                             NSLog(@"失败");
                         }];

```

好像我不使用这条线 UIImage *image = [UIImage imageWithCGImage:rep.fullScreenImage]; 之后的行正在枚举所有资产。如果我尝试获取图像或仅获取元数据，它会在某个时候崩溃。问题是它在没有 XCode 向我显示线程或原因的情况下崩溃。左侧窗格中不显示任何内容。使用分析器运行它会显示应用程序的稳定使用量为 2MB。它似乎没有内存泄漏。

我尝试了不同的方法，但仍然崩溃而没有任何错误消息。

# asp.net - ASP MVC2：如何用 div 包装模型中的每 3 个项目

> ID：15621095
> 
> 赞同：2
> 
> 时间：2013-03-25T17:29:05.217
> 
> 标签：asp.net, asp.net-mvc-2, foreach

需要连续包装模型中的每 3 个项目。

目前有：

```
<% for(var i = 0; i <= Model.Count()/3; i++ ) { %>
<div class="row row-md">
    <div class="content-normal">

        <% foreach (var challenge in Model) { %>
                <div class="grid grid-col-3up">
                    <div class="mod mod-games">
                        <div class="mod-hd">
                            <h5 class="heading heading-mod heading-mod-5up heading-muted">Week 1</h5>
                        </div>
                        <div class="mod-box-banner">
                            <div class="mod-banner-box">
                                <% if (challenge.Completed) { %>
                                    <img src="assets/images/completed-banner.png" alt="" class="mod-completed-banner"/>
                                <% } %>
                            </div>
                            <div class="mod-box mod-relative ">
                                <% if (challenge.Completed) { %> 
                                    <img src="assets/images/medal-game.png" alt="" class="mod-medal-game" />
                                    <span class="mod-game-entries"><%= challenge.Entries%> Entries Earned</span>
                                    <img src="assets/images/games-burst.png" alt="" class="mod-box-img">
                                <% } else { %>
                                    <img src="<%= challenge.Image %>" alt="" class="mod-box-img" />
                                <% } %>
                            </div>
                        </div>
                        <div class="mod-hd">
                            <h4 class="heading heading-mod heading-mod-3up heading-muted"><%= challenge.ChallengeTitle%></h4>
                        </div>
                        <div class="mod-hr">
                            <hr>
                        </div>
                        <div class="mod-bd">
                            <p><%= challenge.ShortDescription%></p>
                        </div>
                        <div class="mod-btn no-pad">
                            <a href="<%= challenge.ChallengeUrl %>"class="btn">
                            Play 
                            <% if (challenge.Completed) { %>
                                    Again
                            <% } %>
                            </a>
                        </div>
                        <div class="mod-btn">
                            <a href="#" class="btn">Share</a>
                        </div>
                    </div>
                </div>  

                <% } %>  
    </div>
</div>
<% } %> 
```

第一个 foreach 抛出一个 OverFlowException。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T04:03:00.590

```
 <% 

                int ChallengeCt = -1;
                foreach (var challenge in Model){
                    ChallengeCt++;

                    if ((ChallengeCt) % 3 == 0)
                    {

                        %>

    <div class="row row-md">
        <div class="content-normal">

                        <%
                    }

    // Content here

    <%             
        if ( ( ChallengeCt + 1) % 3 == 0)
                {

                   %>
    </div>
</div>

                   <%
                }
     %>  

                    <% } %> 
```

# android - 列表视图下方的页脚固定在屏幕底部

> ID：15621097
> 
> 赞同：4
> 
> 时间：2013-03-25T17:29:17.120
> 
> 标签：android, android-layout, listview, android-listview

我试图在我的列表视图下方添加一个页脚。

这就是我的做法。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@color/white"
android:orientation="vertical" >

<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:divider="#BE6D79"
    android:dividerHeight="3dp" />

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="30dp"
    android:background="@color/darkDetna"
    android:orientation="horizontal" >

    <Button
        android:id="@+id/contactBtn"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:layout_weight="1"
        android:background="@drawable/listselector"
        android:paddingRight="0dip"
        android:text="Contact" />

    <Button
        android:id="@+id/faq"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:layout_weight="1"
        android:background="@drawable/listselector"
        android:padding="0dip"
        android:text="Terms And Conditions" />

    <Button
        android:id="@+id/feedback"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:layout_weight="1"
        android:background="@drawable/listselector"
        android:padding="0dip"
        android:text="Feedback  " />

    <Button
        android:id="@+id/fullSIte"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:layout_weight="1"
        android:background="@drawable/listselector"
        android:padding="0dip"
        android:text="Full Site" />
</LinearLayout>
</LinearLayout> 
```

这里

但问题是列表内容很小或者只有一个列表项，页脚将位于列表视图下方。

我希望页脚固定在屏幕底部。

提前感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-25T17:34:57.030

更好的使用`RelativeLayout`

解释实现：

*   添加要在屏幕底部对齐的页脚视图`android:layout_alignParentBottom="true"`
*   然后在页脚布局上方添加列表视图`android:layout_above="@+id/LinearLayout1"`
*   让您的列表视图填满屏幕`android:layout_width="fill_parent"`并 `android:layout_height="fill_parent"`

更改您的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/RelativeLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/white"
    android:orientation="vertical" >

    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_above="@+id/LinearLayout1"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_weight="1"
        android:divider="#BE6D79"
        android:dividerHeight="3dp" />

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/LinearLayout1"
        android:layout_width="fill_parent"
        android:layout_height="30dp"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:background="@color/darkDetna"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/contactBtn"
            android:layout_width="wrap_content"
            android:layout_height="30dp"
            android:layout_weight="1"
            android:background="@drawable/listselector"
            android:paddingRight="0dip"
            android:text="Contact" />

        <Button
            android:id="@+id/faq"
            android:layout_width="wrap_content"
            android:layout_height="30dp"
            android:layout_weight="1"
            android:background="@drawable/listselector"
            android:padding="0dip"
            android:text="Terms And Conditions" />

        <Button
            android:id="@+id/feedback"
            android:layout_width="wrap_content"
            android:layout_height="30dp"
            android:layout_weight="1"
            android:background="@drawable/listselector"
            android:padding="0dip"
            android:text="Feedback  " />

        <Button
            android:id="@+id/fullSIte"
            android:layout_width="wrap_content"
            android:layout_height="30dp"
            android:layout_weight="1"
            android:background="@drawable/listselector"
            android:padding="0dip"
            android:text="Full Site" />
    </LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:37:36.047

您可以使用 RelativeLayout 而不是 LinearLayout 然后使用将视图添加到 RelativeLayout 的底部`android:layout_alignParentBottom="true"`

```
 <?xml version="1.0" encoding="utf-8"?>
    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/white"
    android:orientation="vertical" >

<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:divider="#BE6D79"
    android:dividerHeight="3dp" />

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="30dp"
    android:background="@color/darkDetna"
    android:orientation="horizontal"
    android:layout_alignParentBottom="true" >

    <Button
        android:id="@+id/contactBtn"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:layout_weight="1"
        android:background="@drawable/listselector"
        android:paddingRight="0dip"
        android:text="Contact" />

    <Button
        android:id="@+id/faq"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:layout_weight="1"
        android:background="@drawable/listselector"
        android:padding="0dip"
        android:text="Terms And Conditions" />

    <Button
        android:id="@+id/feedback"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:layout_weight="1"
        android:background="@drawable/listselector"
        android:padding="0dip"
        android:text="Feedback  " />

    <Button
        android:id="@+id/fullSIte"
        android:layout_width="wrap_content"
        android:layout_height="30dp"
        android:layout_weight="1"
        android:background="@drawable/listselector"
        android:padding="0dip"
        android:text="Full Site" />
</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T17:39:49.623

如果您不想使用RelativeLayout，您可以`android:layout_gravity="bottom"`在第二个线性布局上设置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T17:37:29.040

您可以`RelativeLayout`用作布局的根视图。

# c# - 具有要显示的动态列数的表

> ID：15621099
> 
> 赞同：0
> 
> 时间：2013-03-25T17:29:24.313
> 
> 标签：c#, repeater

我有一个数据表，其中每一行都有“保险名称、计划类型、保费……”之类的数据。

所以在我的前端，我必须显示如下：

```
Insurance Name     HealthNet       Harvard         UniCare

Plan Type            HMO            PPO              HMO  

Premium              100            150             200 
```

所以有时我可能只有两列来展示 HealthNet 和哈佛。有时超过三个。在这种情况下如何使用转发器使其根据数据表计数动态化？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:36:06.250

样本：

`aspx`标记如下所示：

```
<asp:GridView ID="gv" runat="server" AutoGenerateColumns="true">
</asp:GridView> 
```

在代码隐藏中只需执行以下操作：

```
gv.DataSource = yourDataTable;   // doesn't matter how many columns are there, it will handle it automatically
gv.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:11:58.903

这将有助于如何透视数据表：

[http://geekswithblogs.net/dotNETvinz/archive/2009/05/10/pivot-data-in-gridview---a-generic-pivot-method-with.aspx](http://geekswithblogs.net/dotNETvinz/archive/2009/05/10/pivot-data-in-gridview---a-generic-pivot-method-with.aspx)

# jekyll - 根据液体过滤器的值评估液体“if”语句

> ID：15621102
> 
> 赞同：1
> 
> 时间：2013-03-25T17:29:36.447
> 
> 标签：jekyll, liquid

我有一个在 Jekyll 站点中使用的自定义液体过滤器，

```
{{ page.url | git_modified }} 
```

它从 git 日志（[此处为插件代码](https://github.com/cboettig/labnotebook/blob/4bf8b20420da1efb1c9a94ec7bb12c7c768b68da/_plugins/jekyll-labnotebook-plugins/git_modified.rb)）生成修改日期。

通常我可能会添加额外的过滤器以将其转换为字符串或 XML 模式，具体取决于上下文，例如`{{ page.url | git_modified | date_to_string }}`. `git_modified`除非由于某种原因，我的过滤器无法为某些帖子返回时间对象，否则一切都是笨拙的。在这种情况下，我正在尝试编写一个不错的失败条件，但无法完全弄清楚这一点。

我想将我的调用包装在一个流动的`if`语句中，以检查是否首先定义了变量：

```
{% if defined?( {{ page.url | git_modified }} %} 
```

但我似乎无法`{{`在 Liquid 块选项 ( `{%`, ) 中使用 Liquid 标签 ( `%}`)。我想我可以用 Liquid 解决这个问题`capture`：

```
{% capture page_modified %}{{ page.url | git_modified }}{% endcapture %} 
{% if defined?(page_modified) %} 
{{ page.url | git_modified | date_to_string }}
{% endif %} 
```

但所述变量似乎不适用于`if`语句。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T07:08:17.383

尝试这样做：

```
{% capture page_modified %}
    {{ page.url }}
{% endcapture %}

{% if page_modified %} 
    {{ page.url }}
{% endif %} 
```

如果`page_modified`未定义，它的值`nil`无论如何都会是，所以只需`if`像在纯 Ruby 中一样使用该构造。我在这里用 jekyll 1.0.0.beta2 进行了测试——`jekyll new test`然后用上面的代码创建了一个文件——它成功了。:)

# visual-studio - 连接时从 Visual Studio 部署到 Azure 失败

> ID：15621103
> 
> 赞同：6
> 
> 时间：2013-03-25T17:29:57.517
> 
> 标签：visual-studio, azure

我一直在使用 Visual Studio 将 Web 服务部署到 Azure；下载了我的发布配置文件以启用它，它在过去几周内运行良好。

今天我尝试部署更新，现在我的所有部署都失败了，原因如下：

> 17:25:03 - 为 WindowsAzure1 准备部署 - 2013 年 3 月 25 日 17:24:53，订阅 ID 为“xxx”，使用服务管理 URL“ [https://management.core.windows.net/](https://management.core.windows.net/) ”...
> 17： 25:03 - 正在连接...
> 17:25:04 - 对象引用未设置为对象的实例。
> 17:25:04 - 部署失败并出现致命错误

我不确定这里出了什么问题。这是说它无法连接到服务管理 URL 吗？

上周我在 Azure 上安装了 SSL 证书，现在我没有看到下载我的发布设置的选项。我知道它曾经在那里，但现在不在了。拥有 SSL 是否会阻止我以某种方式连接到管理页面？

**编辑**
在离开工作之前，我删除了证书，但是当我检查`PublishProfile`它时它仍然没有显示。

PublishProfile 不适用于附加到订阅的任何其他用户 - 所以我认为它与**我的**登录无关。

**编辑 2**
更激烈一点；我现在尝试删除我的存储和服务，从头开始。我通过删除已导入 Visual Studio 的订阅创建了一个新`publishsettings`文件，然后点击“登录以下载凭据”链接。接下来我在 Azure 中创建了一个新的服务和存储并尝试发布，但是在连接时部署仍然失败

> 你调用的对象是空的

我不知道我还能尝试什么，或者可能出了什么问题，或者去哪里寻找答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-31T05:53:36.320

我今天遇到了同样的错误。为什么它不起作用是因为我在发布之前没有在管理门户中上传证书。

添加证书后，一切正常！

您可以在此处阅读更多信息：http: [//www.amido.co.uk/mark-omahoney/publishing-in-windows-azure-object-reference-not-set-to-an-instance-of-an-object/](http://www.amido.co.uk/mark-omahoney/publishing-in-windows-azure-object-reference-not-set-to-an-instance-of-an-object/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T22:11:00.593

解决上述问题的最佳方法是从 Azure 管理门户下载最新的 PublishSettings，然后将其与 Visual Studio 一起使用。这样，您从本地计算机到 Windows Azure 管理门户的连接将得到验证和验证。一旦基本连接正常工作，您就可以将应用程序发布到特定的 Windows Azure 服务。

您还可以登录您的 Azure 管理门户并删除在以前的发布设置下载尝试中添加的所有旧管理证书。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T09:57:49.910

就我而言，问题是我的解决方案 Cloud 项目具有我在其`ServiceDefinition.csdef`和`ServiceConfiguration.Cloud.cscfg`. 在我的第一次编辑中，我说我已经从 Azure 中删除了证书，但还没有从项目文件中删除它；将它们注释掉允许我再次从 Visual Studio 发布。

我不确定为什么会发生这种情况，我已将证书上传到 Azure，并且能够在 FireFox 中的 https 上连接到我的服务，因此 SSL 正在“工作”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-23T22:53:29.567

Web Deploy v3.6 BETA3 已发布，修复了此问题。要解决此错误，您可以下载 Web Deploy 测试版并修补您的 VS2013 安装。[http://azure.microsoft.com/blog/2014/08/11/web-deploy-3-6-beta-released/](http://azure.microsoft.com/blog/2014/08/11/web-deploy-3-6-beta-released/)

安装上述 Web 部署后，测试验证连接。如果它有效，那么您可以修改 msbuild.exe (msbuild.exe.config) 使用的代理设置，并检查您现在可以使用 Web Deploy 从代理后面发布。

问候， Logesh Shan

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-19T09:15:23.167

我认为证书已损坏。删除解决方案`.suo`文件和`.ccproj.user`我的 Azure 项目中的文件为我做了这件事。

# openvms - 在 OpenVMS 上从 DCL 命令行发送信号

> ID：15621104
> 
> 赞同：0
> 
> 时间：2013-03-25T17:29:59.673
> 
> 标签：openvms, dcl

我正在尝试通过 OpenVMS 服务器上的命令行发送信号。使用 Perl，我在进程之间设置了信号处理程序，并且 VMS 上的 Perl 能够发送 Posix 信号。此外，C++ 程序也能够发送和处理信号。但是，我遇到的问题是这些进程可能正在集群中的另一个节点上运行，我需要编写一个实用程序脚本来远程向它们发送信号。

我试图避免编写新脚本，而宁愿简单地远程执行命令以从命令行发送信号。我需要发送 SIGUSR1，它转换为 OpenVMS 的 C$_SIGUSR1。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-27T03:36:02.913

据我所知，没有支持的命令行界面来执行此操作。但是您可以通过调用未记录的系统服务 SYS$SIGPRC() 来完成任务。该系统服务可以将任何条件值传递给目标进程，而不仅仅是 POSIX 信号。这是以标准格式描述的接口：

```
FORMAT

     SYS$SIGPRC process-id ,[process-name] ,condition-code

RETURNS

     OpenVMS usage: cond_value
     type:          longword (unsigned)
     access:        write only
     mechanism:     by value

ARGUMENTS

     process-id

     OpenVMS usage: process_id
     type:  longword (unsigned)
     access:    modify
     mechanism:     by reference

     Process identifier of the process for which is to receive the signal. The
     process-id argument is the address of an unsigned longword containing the
     process identifier. If you do not specify process-id, process-name is
     used.

     The process-id is updated to contain the process identifier actually
     used, which may be different from what you originally requested if you
     specified process-name.

     process-name

     OpenVMS usage: process_name
     type:          character string
     access:        read only
     mechanism:     by descriptor

     A 1 to 15 character string specifying the name of the process for
     which will receive the signal. The process-name argument is the
     address of a descriptor pointing to the process name string. The name
     must correspond exactly to the name of the process that is to receive
     the signal; SYS$SIGPRC does not allow trailing blanks or abbreviations.

     If you do not specify process-name, process-id is used. If you specify
     neither process-name nor process-id, the caller's process is used.
     Also, if you do not specify process-name and you specify zero for
     process-id, the caller's process is used.

     condition-value

     OpenVMS usage: cond_value
     type:          longword (unsigned)
     access:        read only
     mechanism:     by value

     OpenVMS 32-bit condition value. The condition-value argument is
     an unsigned longword that contains the condition value delivered
     to the process as a signal.

     CONDITION VALUES RETURNED

     SS$_NORMAL    The service completed successfully
     SS$_NONEXPR   Specified process does not exist
     SS$_NOPRIV    The process does not have the privilege to signal
                   the specified process
     SS$_IVLOGNAM  The process name string has a length of 0 or has
                   more than 15 characters
     (plus I suspect there are other possible returns having to do
      with various cluster communications issues)

EXAMPLE CODE

#include <stdio.h>
#include <stdlib.h>
#include <ssdef.h>
#include <stsdef.h>
#include <descrip.h>
#include <errnodef.h>
#include <lib$routines.h>

int main (int argc, char *argv[]) {
/*
**
** To build:
**
**      $ cc sigusr1
**      $ link sigusr1
**
** Run example:
**
**      $ sigusr1 := $dev:[dir]sigusr1.exe
**      $ sigusr1 20206E53
**
*/

static unsigned int pid;
static unsigned int r0_status;
extern unsigned int sys$sigprc (unsigned int *,
                                struct dsc$descriptor_s *,
                                int);

    if (argc < 2) {
        (void)fprintf (stderr, "Usage: %s PID\n",
                       argv[0]);
        exit (EXIT_SUCCESS);
    }

    sscanf (argv[1], "%x", &pid);

    r0_status = sys$sigprc (&pid, 0, C$_SIGUSR1);
    if (!$VMS_STATUS_SUCCESS (r0_status)) {
        (void)lib$signal (r0_status);
    }
} 
```

# sql - SQL 从分隔字符串中删除字符

> ID：15621105
> 
> 赞同：0
> 
> 时间：2013-03-25T17:30:02.597
> 
> 标签：sql

我有一个以下格式的字符串。我试图在 SQL 中创建一个一次性函数来删除某些字符。

示例字符串：

```
Var s = '18160 ~ SCC-Hard Drive ~ 4 ~ d | 18170 ~ SCC-SSD ~ 4 ~ de | 18180 ~ SCC-Monitor ~ 5 ~ | 18190 ~ SCC-Keyboard ~ null ~' 
```

期望的结果：

```
s = 'SCC-Hard Drive ~ 4 ~ d | SCC-SSD ~ 4 ~ de | SCC-Monitor ~ 5 ~
   |SCC-Keyboard ~ null ~' 
```

如果您注意到上面的 ID，例如 18160、18170、18180 和 18190 已被删除。这只是一个例子。结构如下：

```
id: 18160
description : SCC-Hard Drive
Type: 4
comment: d 
```

因此，如果有多个项目，它们会使用 Pike 分隔符连接起来。所以我的要求是从上述结构中的给定字符串中删除 id。

在 Javascript 中，我知道我可以使用正则表达式并执行以下操作并且它可以工作，只需要在 SQL 08 中执行

```
s.replace(/\d{5}\s~\s/g, "") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:38:24.030

`CHARINDEX`如果我必须在 SQL 中执行此操作，我喜欢使用它。不过，如果我能提供帮助，我会尽量避免使用 SQL 进行这种字符串操作。

像这样的东西应该工作：

```
DECLARE @s VARCHAR(2500), @result VARCHAR(2500), @tilde INT, @pipe INT, @length INT, @calc INT
SELECT @s = '18160 ~ SCC-Hard Drive ~ 4 ~ d | 18170 ~ SCC-SSD ~ 4 ~ de | 18180 ~ SCC-Monitor ~ 5 ~ | 18190 ~ SCC-Keyboard ~ null ~'
SELECT @length = LEN(@s)
SELECT @tilde = PATINDEX('% ~%', @s);
SELECT @pipe =  PATINDEX('% | %', @s);

--If there's no tilde, then there's only one element
IF (@tilde = 0 OR @length = 0)
BEGIN
    SELECT @s; 
    RETURN;
END 
--If no pipe, there's only one set
ELSE IF @pipe = 0
BEGIN
    SELECT REPLACE(@s, SUBSTRING(@s, 0, @tilde +3), '')
    RETURN;
END
ELSE
BEGIN
    --clear first id
    SELECT @s = REPLACE(@s, SUBSTRING(@s, 0, @tilde +3), '')
    SELECT @pipe = CHARINDEX('|', @s)
    SELECT @tilde = CHARINDEX('~', @s, @pipe +1);
    WHILE @pipe > 0
    BEGIN
        SELECT @calc = (@tilde - @pipe)     
        SELECT @s = REPLACE(@s, SUBSTRING(@s, @pipe + 1, @calc), '')
        SELECT @pipe = CHARINDEX('|', @s, @pipe +1)
        SELECT @tilde = CHARINDEX('~', @s, @pipe +1);
    END
    SELECT @s
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:44:53.950

我不认为你可以用一个表达式来做到这一点，但创建一个循环直到记录分隔符 | 用尽的函数应该很简单。对于每场比赛，找到第一个〜。沿着循环连接部分字符串。您需要使用 DBMS 中常见的函数 locate、substring 和 concat。我不确定你的问题到底是什么，但正则表达式不是标准的，至少在 mySQL 中你不能用它们来替换。

# jquery - 无法使用 jQuery 在 Sharepoint 2010 中设置表单字段

> ID：15621106
> 
> 赞同：-1
> 
> 时间：2013-03-25T17:30:04.043
> 
> 标签：jquery, sharepoint

我正在尝试访问 Sharepoint 2010 中博客文章列表输入表单中的表单字段。我将 jquery 上传到站点的库，并且表单可以识别 jQuery。我可以打印出文本并运行我自己的简单功能（例如打印日期），但我无法访问表单元素。我有一个标题为“MyColumn”的列，我正在尝试以这种方式访问​​它：

```
$("input[title='MyColumn']").val("foobar"); 
```

这是我在许多论坛和博客网站上看到的建议。但是，它没有任何效果。的文本字段`MyColumn`保持为空。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T17:57:59.630

我发现的唯一方法是查看源代码以查看生成的字段 id 被称为什么。填充查询字符串值的示例：

var myname = $.urlParam('name'); $('#ctl00_m_g_e256ce90_75de_4635_b4ba_69f8dd0c6e1b_ff51_ctl00_ctl00_TextField').val(myname);

# jquery - jQuery Selectable 获取文本值

> ID：15621111
> 
> 赞同：0
> 
> 时间：2013-03-25T17:30:31.037
> 
> 标签：jquery, selectable

我有一个无序列表的项目——这个列表可能有数百个项目——当用户点击一个项目时，我会在选项的右侧显示他们的选择。我正在使用 jQuery selectable 和 sortable 的组合来执行此操作（尽管单击选项后我会丢失可排序），并且为用户显示的值是所选项目的索引。我想为用户显示订单项的文本值，但正如预期的那样，获取 text() 值会返回所有订单项的文本值。

如何仅获取选定的文本并为用户显示？

HTML：

```
<ul id="list">
    <li id="Test1">Item 1</li>
    <li id="Test2">Item 2</li>
    <li id="Test3">Item 3</li>
    <li id="Test4">Item 4</li>
    <li id="Test5">Item 5</li>
</ul>

<p id="feedback">
<span>You've selected items:</span>    
    <ul id="select-result">
     <span id="select-resultSpan">
        <li>No Items Selected</li>
     </span>
    </ul>    
</p> 
```

JS：

```
$(function () {
    $("#list").selectable({
        stop: function () {
            var result = $("#select-resultSpan").empty();
            $(".ui-selected", this).each(function () {
                var index = $("#list li").index(this);
                result.append("<li>" + (index + 1) + "</li>");
            });
        }
    });
}); 
```

完整示例在 JSFiddle 上：http: [//jsfiddle.net/Jk6ZH/1/](http://jsfiddle.net/Jk6ZH/1/)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:34:53.810

如果我没看错，认为这就是你所需要的：

```
$(".ui-selected", this).each(function () {

    // this works for me
    result.append("<li>" + $(this).text() + "</li>");
}); 
```

[http://jsfiddle.net/JuJDt/](http://jsfiddle.net/JuJDt/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:33:49.873

尝试这个：

```
$("#list li").on("click",function() {
  $("#select-resultSpan").append($(this).text());
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-19T17:24:09.753

> ```
> You have to find innerHTML from index value.
> you can also get other attributes with this method. 
> ```

```
$(function () {
        $("#list").selectable({
            stop: function () {
                var result = $("#select-resultSpan").empty();
                $(".ui-selected", this).each(function () {
                    var index = $("#list li").index(this);
                    var text = $("#list li").get(index).innerHTML; //  for id you can replace .innerHTML with .id 
                    result.append("<li>" + (text) + "</li>");
                });
            }
        });
    }); 
```

## [看这里](http://jsfiddle.net/Jk6ZH/42/)

# asp.net-mvc - 使用 CORS 在 WebAPI 中将 text/plain 作为复杂对象发布

> ID：15621112
> 
> 赞同：7
> 
> 时间：2013-03-25T17:30:33.983
> 
> 标签：asp.net-mvc, asp.net-web-api, cors

因此，我希望使用 CORS 从 AJAX 帖子中将复杂对象 POST（或 PUT）到服务器。不幸的是，IE8 仅支持在使用 CORS 时发送 text/plain 而不是`application/json`.

有没有办法在`WebAPI`自定义解析文本/纯文本提交中实现处理程序。

我的意思是复杂的对象

```
public void POST([FromBody] MyCustomObject myResponse)
{
   return null;
} 
```

通常我会在一些带有适当设置的标头的 JSON 中发布，但是由于 IE8 的限制，一旦你设置了标头它就会失败并拒绝访问，所以需要是文本/纯文本，所以我打算做的是发送一个 JSON 字符串但称为 text/plain （丑我知道！）但由于缺乏更好的选择......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-25T19:16:31.100

如果您的 WebApi 应用程序真的只使用 JSON，您可以使用此解决方案，它始终以 JSON 响应并忽略请求内容类型：

[如何强制 asp.net webapi 始终将 POST 数据解码为 JSON](https://stackoverflow.com/questions/12385694/how-can-i-force-asp-net-webapi-to-always-decode-post-data-as-json)

从那，我会建议这个解决方案：

此代码需要添加到 Application_Start 或 WebApiConfig.Register

```
config.Formatters.JsonFormatter.SupportedMediaTypes.Add(new MediaTypeHeaderValue("text/plain"));
config.Formatters.Remove(config.Formatters.FormUrlEncodedFormatter);
config.Formatters.Remove(config.Formatters.XmlFormatter); 
```

它告诉 json 格式化程序接受纯文本内容类型，并删除 form 和 xml 格式化程序（尽管可能不需要删除它们）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:56:20.933

丑陋，但是您可以尝试在消息处理程序中将内容类型标头从 text/plain 修改为 application/json ，以便使用 json 格式化程序正确进行参数绑定。

# sql - 优化postgresql更新

> ID：15621114
> 
> 赞同：0
> 
> 时间：2013-03-25T17:30:52.733
> 
> 标签：sql, postgresql

我在 postgresql 中有一个包含超过 10 百万行的表，我想更新一个字段：

```
update annonce set confirmed = true; 
```

但是查询需要很长时间才能执行，我该如何优化这个查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T17:41:59.997

```
update annonce set confirmed = true
where not confirmed 
```

部分索引可以帮助：

```
create index index_name on annonce (confirmed)
where not confirmed 
```

与完整索引相比，部分索引将大大减少索引大小，并使所有更新、删除和插入操作更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:42:12.920

如果你经常这样做，你想稍微修改一下，如下所示：

```
UPDATE announce
SET confirmed = TRUE
WHERE NOT confirmed 
```

此外，您应该在`(confirmed)`.

今天，您每次都在更改整个表，这会产生很多死行 - 基本上表是臃肿的。使用建议的方法，您只会为新记录创建死行，甚至会被索引 - 非常快速和高效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:46:57.690

你可以说

```
update announce set confirmed = true where confirmed = false; 
```

因为它是一个布尔值。这将为您做两件事：

1.  如果尚未确认的公告数量比 1000 万还少，可以将字段放入索引中，让 postgresql 使用该索引来更快地访问。

2.  在旧版本的 postgresql 中，可用空间图具有固定大小。如果您更新了一张大表，那么无论您配置多大的地图，您都会超出该地图。因此，您必须定期执行`VACUUM FULL`，否则数据库使用的磁盘空间将超出您的想象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T21:44:36.397

到目前为止，您已经得到了三个答案。

***他们都错了。***

他们都没有考虑`NULL`。并且`NULL`是这里*唯一*需要考虑的事情！因为，正如你在评论中透露的那样：

> “已确认”是我现在添加的表格字段

根据定义，所有行都有`confirmed IS NULL`。一个`WHERE`条款根本没有帮助，只是要花一点钱。

即使我们*不*知道您刚刚添加了该列，因为它不在您的原始问题中：由于`NULL`尚未排除，该声明必须是：

```
UPDATE announce
SET    confirmed = TRUE
WHERE  confirmed IS DISTINCT FROM TRUE 
```

但这对你没有帮助。*索引*也没有- 相反。无论如何，整个表都必须重写。没有**办法解决它**。但是，您可以做很多事情来加快速度。

这*完全取决于*您未与我们分享的有关您的餐桌的信息。

# javascript - 如何在javascript中的数学函数中取绝对值

> ID：15621116
> 
> 赞同：1
> 
> 时间：2013-03-25T17:30:54.840
> 
> 标签：javascript

我试图从“f2”中减去“f1”的值，它工作正常。但是我只想要一次，但是当我单击提交更多按钮时，它每次从 f2 中减小 f1 的值。怎么可能只做一次。当我输入值而不是从脚本调用它时，它运行良好。

```
 <form name=bills>

<p><input type="text" name="f1" size="20">
<input type="text" name="f2" size="20" value="30"></p>
    <input type="button" value="Submit" onclick="cbs(this.form)" name="B1">

    <Script>
    function cbs(form)

    {
        form.f2.value = (([document.bills.f2.value] * 1) - (document.bills.f1.value * 1))
    } 
```

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:35:47.963

JavaScript 中数学函数的绝对值是 Math.abs();

```
Math.abs(6-10) = 4; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:36:03.047

不确定您到底要做什么，但要计算绝对值 use `Math.abs()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:38:21.427

如果您希望该功能仅工作一次，则可以使用以下内容：

```
hasBeenRun = false; //have this variable outside the function

if(!hasBeenRun) {
    hasBeenRun = true;
    //Run your code
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T17:39:11.203

您的问题似乎是在问如何只从 f2 中减去 f1 一次，无论单击提交按钮多少次。一种方法是使用一个变量来跟踪函数是否已被调用，如果已调用则不进行计算。至于提到绝对值的标题，这被称为`Math.abs(value)`

```
<Script>
var alreadyDone = false;
function cbs(form)
{
    if (alreadyDone) return;
    // this one takes the absolute value of each value and subtracts them
    form.f2.value = (Math.abs(document.bills.f2.value) - Math.abs(document.bills.f1.value));

    // this one takes the absolute value of the result of subtracting the two
    form.f2.value = (Math.abs(document.bills.f2.value - document.bills.f1.value));
    alreadyDone = true;
} 
```

为了使函数在 f1 的值发生变化时能够再​​次工作，只需`alreadyDone`在 f1 变化时将变量改回 false

```
<input type="text" name="f1" onChange="alreadyDone=false;" size="20"> 
```

# python - ssh python 结构

> ID：15621118
> 
> 赞同：0
> 
> 时间：2013-03-25T17:30:55.470
> 
> 标签：python, ssh, deployment, fabric

我实际上不明白该怎么做。我可以使用 some_user 访问本地计算机，例如 192.168.1.101。从那台计算机我可以访问另一台计算机（通过 vpn）10.0.132.17，只有从这里我才能访问我需要部署我的脚本的计算机 10.0.132.15。

所以我需要：

```
$ ssh some_user@192.168.1.101 -> ssh another_user@10.0.132.17 -> ssh another_user@10.0.132.15 
```

我可以以某种方式做：`ssh some_user@192.168.1.101 -p 2222`并访问`another_user@10.0.132.15`？

或在python结构中以某种方式编写env变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T17:22:53.367

除了使用显式隧道之外，另一种选择是设置 ssh 以透明地通过您的代理转发。放入您的`~/.ssh/config`类似以下内容：

```
Host proxy_midstage
    User another_user
    HostName 10.0.132.17
    ProxyCommand ssh -q some_user@192.168.1.101 nc %h %p

Host proxy_final
    User another_user
    HostName 10.0.132.15
    ProxyCommand ssh -q proxy_midstage nc %h %p 
```

然后该命令`ssh proxy_final`将直接跳转到部署服务器。大概织物可以使用它，尽管我不肯定。

# c# - Cookie 未在 asp.net mvc 中设置

> ID：15621119
> 
> 赞同：0
> 
> 时间：2013-03-25T17:30:58.973
> 
> 标签：c#, asp.net, asp.net-mvc, cookies

```
if (HttpContext.Request.Cookies["time"]==null)
{
    HttpCookie cookie = new HttpCookie("last_visited",DateTime.Now.ToString());
    cookie.Expires = DateTime.Now.AddDays(10);
    HttpContext.Response.Cookies.Add(cookie);
}
else if(HttpContext.Request.Cookies["last_visited"]!=null)
{
    ViewBag.last_visited = HttpContext.Request.Cookies["last_visited"].Value;
} 
```

我正在尝试在 asp.net mvc 中设置一个 cookie。以上是我在控制器操作中的代码。这段代码的目的是在没有 cookie 时设置一个 cookie，如果有 cookie 集则读取一个值。

但是，在设置断点之后，我发现 else if 部分永远不会被执行，就好像根本没有设置 cookie 一样。

这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:33:59.160

是不是第一个 if 语句检查了错误的 cookie？应该`"time"`改为`"last_visited"`？

固定代码：

```
if (HttpContext.Request.Cookies["last_visited"]==null)
{
    HttpCookie cookie = new HttpCookie("last_visited",DateTime.Now.ToString());
    cookie.Expires = DateTime.Now.AddDays(10);
    HttpContext.Response.Cookies.Add(cookie);
}
else if(HttpContext.Request.Cookies["last_visited"]!=null)
{
    ViewBag.last_visited = HttpContext.Request.Cookies["last_visited"].Value;
} 
```

# java - 带有 .replaceAll 和 .split 的 Java 正则表达式

> ID：15621122
> 
> 赞同：1
> 
> 时间：2013-03-25T17:31:16.923
> 
> 标签：java, regex

我想知道我必须使用哪个正则表达式。方法内部的代码是：

```
while( (line = bReader.readLine()) != null){
    line2 = line.replaceAll("[\\)][\\|]","R");
    numbers = line2.split("[\\|]");
}
int num = numbers.length; 
```

我想要的是当`line`等于

```
(A#,A#,A#),(B#,B#,C#),(B#,B#,C#),(Bb,Bb,Cb)|(Ab,Ab,Ab),(Bb,Bb,Cb),(Bb,Bb,Cb),(Bb,Bb,Cb)| 
```

它必须返回 num =`0`因为所有实例`)|`都被替换`R`并且没有`|`剩余。我得到的是 num = `1`。

当`line`等于

```
(A#,A#,A#),(B#,B#,C#),(B#,B#,C#),(Bb,Bb,Cb)|A#,B#,C#,D#, E#,F#,G#,  |  ,A,  , ,   ,  ,  ,  ,  ,  ,  , ,   ,  ,  ,  | 
```

它必须返回 num =因为在替换by之后`2`有两个实例。我在这里得到的确实是 num = 。我希望有人能给我解决方案。`|``)|``R``2`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:47:41.957

如果您试图找出`|`String 中存在多少未预测的`)`标记，则可以删除这些标记并检查字符串长度的变化情况。要检测此类管道，您可以使用[负后视](http://www.regular-expressions.info/lookaround.html)。

```
int num = s.length() - s.replaceAll("(?<![)])[|]", "").length(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:51:44.190

如果您`String`在不存在的分隔符上拆分 a ，那么您将取回原来的`String`：

```
public static void main(String[] args) throws SQLException {
    System.out.println(Arrays.toString("My string without pipes".split("\\|")));
} 
```

输出：

```
[My string without pipes] 
```

如果您尝试拆分字符串以您结尾的字符，**则不会**`String`在以下内容中得到空`Array`：

```
public static void main(String[] args) throws SQLException {
    System.out.println(Arrays.toString("My string ending in pipe|".split("\\|")));
} 
```

输出：

```
[My string ending in pipe] 
```

所发生的只是最后的分隔符被删除。

所以你的逻辑是错误的。您在第二次检查中得到正确答案的原因不是因为检查正确，而是因为管道恰好在最后。

通常，您不会在`String`using中获得分隔符的数量，除非您以分隔符开头或结尾，否则您`spilt`将获得该数字- 在这种情况下，它将被简单地删除。`+1``String`

您需要做的是使用正则表达式搜索所有前面没有右括号的管道。您可以通过消极的后视来做到这一点：

```
public static void main(String[] args) throws SQLException {
    final String s1 = "(A#,A#,A#),(B#,B#,C#),(B#,B#,C#),(Bb,Bb,Cb)|(Ab,Ab,Ab),(Bb,Bb,Cb),(Bb,Bb,Cb),(Bb,Bb,Cb)|";
    final String s2 = "(A#,A#,A#),(B#,B#,C#),(B#,B#,C#),(Bb,Bb,Cb)|A#,B#,C#,D#, E#,F#,G#,  |  ,A,  , ,   ,  ,  ,  ,  ,  ,  , ,   ,  ,  ,  |";
    final Pattern pattern = Pattern.compile("(?<!\\))\\|");
    int count = 0;
    final Matcher matcher = pattern.matcher(s1);
    while (matcher.find()) {
        ++count;
    }
    System.out.println(count);
    count = 0;
    matcher.reset(s2);
    while (matcher.find()) {
        ++count;
    }
    System.out.println(count);
} 
```

输出：

```
0
2 
```

# ruby - 与 Ruby 中的 `Array#each` 混淆

> ID：15621124
> 
> 赞同：1
> 
> 时间：2013-03-25T17:31:23.020
> 
> 标签：ruby

混淆`Array#each`如下：

```
%w{ david black }.each {|str| str.capitalize }
#=> ["david", "black"] 
```

上面的代码很酷，但是下面的逻辑是如何工作的，无法理解。

```
%w{ david black }.each(&:capitalize)
#=> ["david", "black"] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T17:38:55.767

这是一个非常古老的技巧，叫做`Symbol#to_proc`.

您可以在此处阅读更多信息：http: [//pragdave.pragprog.com/pragdave/2005/11/symbolto_proc.html](http://pragdave.pragprog.com/pragdave/2005/11/symbolto_proc.html)

基本上，它是调用不带参数的方法的快捷方式。常用于`map`，例如。

```
%w[i can measure length of strings].map(&:length) # => [1, 3, 7, 6, 2, 7] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:38:15.380

的表示法`&:something`对数组的每个元素执行方法`something`。

这通常与 map 一起使用以更改数组的每个条目或从哈希中提取数据。

```
[{:foo => :bar, :meh => :bar2}, {:foo => :one, :meh => :two}].map(&:foo)
=> [:bar, :one] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:34:51.723

使用地图怎么样？

```
[1173]pry(main)> ["david","black"].map{|str| str.capitalize }
=> ["David","Black"]
[1173]pry(main)> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-25T17:38:02.730

我没有用 .each 来举例，也许你的意思是 .map

当您传入 &:method_name 时，它​​是在块中执行此操作的简写。因此，对于每个项目都应用此方法。

# ruby - Hartl 教程：尝试清理代码时出现 3.2 错误

> ID：15621126
> 
> 赞同：0
> 
> 时间：2013-03-25T17:31:25.563
> 
> 标签：ruby

当我运行测试时，我收到此消息（我猜它通过了），但是当我转到本地 host300 时，我在所有页面上都收到以下消息：没有路由匹配 [GET]“/about”

我已经坚持了大约 4 个小时:(

这是我收到的测试报告——

C:\Sites\rails_projects\sample_app>bundle exec rspec spec/requests/static_pages_spec.rb C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport-3.2.13/lib/ac tive_support/dependencies.rb:251:in `require': C:/Sites/rails_projects/sample_ap p/app/helpers/application_helper.rb:12: syntax error, unexpected keyword_end, ex pecting $end (SyntaxError) from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:251:in`block in require' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:236 :in `load_dependency' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:251:in`require' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:359: `require_or_load' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:313:in`independ_on' 来自 C:/RailsInstaller /Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:225:in `require_dependency' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/abstract_controller/helpers.rb:135:in`block in modules_for_helpers' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/abstract_controller/helpers.rb:131：在`map!' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/abstract_controller/helpers.rb:131:in`modules_for_helpers' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/action_controller/metal/helpers.rb:92:in `modules_for_helpers' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/abstract_controller/helpers.rb:95:in`helper' 来自 C:/RailsInstaller /Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/abstract_controller/helpers.rb:159: `default_helper_module!' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/abstract_controller/helpers.rb:22:in`in 继承自 C:/RailsInstaller/Ruby1.9.3/lib/的块ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/abstract_controller/helpers.rb:22:in`class_eval' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/abstract_controller/helpers.rb:22:in`从 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems 继承/actionpack-3.2 .13/lib/action_controller/metal/params_wrapper.rb:135:in `inherited' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2 .13/lib/abstract_controller/railties/routes_helpers.rb:7:in`block (2 levels) in with' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/ actionpack-3.2 .13/lib/action_controller/railties/paths.rb:7:in`block (2 levels) in with' from C:/Sites/rails_projects/sample_app/app/controllers/application_cont roller.rb:1:in`'来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:251:in `require' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:251:in`block in require' 来自 C:/RailsInstaller/ Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:236:in `load_dependency' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:251:in`require' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems /1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:359: `require_or_load' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:313:in`independ_on' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport- 3.2.13/lib/active_support/dependencies.rb:225:in `require_dependency' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/engine.rb:439:in`block (2 levels) in eager_load!' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/engine.rb:438:in`each' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/engine.rb:438:in`阻止 eager_load！来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/engine.rb:436:in `each' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/engine.rb:436:in`eager_load！来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/initializable.rb:30:in`instance_exec' 来自 C:/RailsInstaller/ Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/initializable.rb:30:in `run' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/initializable.rb:55:in`block in run_initializers' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/initializable.rb:54:in `each' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/initializable.rb:54:in`run_initializers' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/ gems/railties-3.2.1 3/lib/rails/application.rb:136:in `initialize!' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 3/lib/rails/railtie/configurable.rb:30:in`method_missing' 来自 C:/Sites/rails_projects/sample_app/config/environment.rb:5:in`<top (required)>' from C:/Sites/rails_projects/sample_app/spec/spec_helper.rb:3:in`需要'来自 C:/Sites/rails_projects/sample_app/spec/spec_helper.rb:3:in`<top ( required)>' from C:/Sites/rails_projects/sample_app/spec/requests/static_pages_spec. rb:1:in`需要'来自 C:/Sites/rails_projects/sample_app/spec/requests/static_pages_spec。rb:1:in `<top (required)>' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.1 1.1/lib/rspec/core/configuration.rb:780:in`load' 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.1 1.1/lib/rspec/core/configuration.rb:780:in `block in load_spec_files' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.1 1.1/lib/rspec/core/configuration.rb:780:in`map '来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.1 1.1/lib/rspec/core/configuration.rb:780:in `load_spec_files' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.1 1.1/lib/rspec/core/command_line.rb:22:in`run' 来自 C:/RailsInstaller /Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.1 1.1/lib/rspec/core/runner.rb:69:in `run' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rspec-core-2.1 1.1/lib/rspec/core/runner.rb:8:in`block in autorun'

我的编码页：

**助手\application.helper.rb**

```
 def full_title(page_title)
base_title = "Ruby on Rails Tutorials Sample App"
if page_title.empty?
    base_title
else
    "#{base_title} | #{page_title}"
end
    end
    end 
```

**static_pages_helper.rb**

```
 module StaticPagesHelper
 end 
```

**应用程序.html.erb**

```
<title><%= full_title(yield(:title)) %></title>
<%= stylesheet_link_tag    "application", media: "all" %>
<%= javascript_include_tag "application" %>
<%= csrf_meta_tags %>
<%= render 'layouts/shim' %>    
 </head>
 <body>
  <%= render 'layouts/header' %>
  <div class="container">
  <%= yield %>
  <%= render 'layouts/footer' %>
  </div>
  </body>
  </html> 
```

**规范\请求\static_pages_spec.rb**

```
 require 'spec_helper'

 describe "Static pages" do

subject { page }

 describe "Home page" do
before { visit root_path }

it { should have_selector('h1',    text: 'Sample App') }
it { should have_selector('title', text: full_title('')) }
it { should_not have_selector 'title', text: '| Home' }
 end

describe "Help page" do
before { visit Help_path }

it { should have_selector('h1',    text: 'Help') }
it { should have_selector('title', text: full_title('Help')) }
 end

describe "About page" do
before { visit About_path }

it { should have_selector('h1',    text: 'About') }
it { should have_selector('title', text: full_title('About Us')) }
 end

describe "Contact page" do
before { visit Contact_path }

it { should have_selector('h1',    text: 'Contact') }
it { should have_selector('title', text: full_title('Contact')) }
end
end 
```

**路线.rb**

```
SampleApp::Application.routes.draw do

match '/static_pages/home' => 'static_pages#home'
match '/Help',    to: 'static_pages#Help'
match '/About',   to: 'static_pages#About'
match '/Contact', to: 'static_pages#Contact'

root to: 'static_pages#home' 
```

**about.html.erb**

```
 <% provide(:title, "About Us") %>
 <h1>About Us</h1>
   <p>
The <a href="http://railstutorial.org/">Ruby on Rails Tutorial</a>
is a project to make a book and screencasts to teach web development
with <a href="http://rubyonrails.org/">Ruby on Rails</a>. This
is the sample application for the tutorial.
  </p>
  </body>
  </html> 
```

**联系人.html.erb**

```
 % provide(:title, 'Contact') %>
  <h1>Contact</h1>
  <p>
    Contact Ruby on Rails Tutorial about the sample app at the
   <a href="http://railstutorial.org/contact">contact page</a>.
  </p> 
```

**帮助.html.erb**

```
 <% provide(:title, 'Help') %>
   <!DOCTYPE html>
   <html>
<head>
    <title>Ruby on Rails Tutorial Sample App | <%= yield(:title) %></title>
</head>
<body>  
    <h1>Help</h1>
    <p>
Get help on the Ruby on Rails Tutorial at the
<a href="http://railstutorial.org/help">Rails Tutorial help page</a>
To get help on this sample app, see the
<a href="http://railstutorial.org/book">Rails Tutorial book</a>.
   </p>
   </body>
  </html> 
```

**主页.html.erb**

```
<div class="center hero-unit">
  <h1>Welcome to the Sample App</h1>

 <h2>
  This is the home page for the
  <a href="http://railstutorial.org/">Ruby on Rails Tutorial</a>
  sample application.
  </h2>

   <%= link_to "Sign up now!", '#', class: "btn btn-large btn-primary" %>
  </div>

  <%= link_to image_tag("rails.png", alt: "Rails"), 'http://rubyonrails.org/' %> 
```

**实用程序.rb**

```
def full_title(page_title)
 base_title = "Ruby on Rails Tutorial Sample App"
 if page_title.empty?
 base_title
 else
"#{base_title} | #{page_title}"
 end
 end 
```

**应用程序.rb**

```
 require File.expand_path('../boot', __FILE__)

      # Pick the frameworks you want:
     require "active_record/railtie"
     require "action_controller/railtie"
     require "action_mailer/railtie"
     require "active_resource/railtie"
   require "sprockets/railtie"
    # require "rails/test_unit/railtie"

     if defined?(Bundler)
    # If you precompile assets before deploying to production, use this line
   Bundler.require(*Rails.groups(:assets => %w(development test)))
       # If you want your assets lazily compiled in production, use this line
       # Bundler.require(:default, :assets, Rails.env)
      end

    module SampleApp
   class Application < Rails::Application
   # Settings in config/environments/* take precedence over those specified here.
    # Application configuration should go into files in config/initializers
    # -- all .rb files in that directory are automatically loaded.

    # Custom directories with classes and modules you want to be autoloadable.
    # config.autoload_paths += %W(#{config.root}/extras)

   # Only load the plugins named here, in the order given (default is alphabetical).
   # :all can be used as a placeholder for all plugins not explicitly named.
   # config.plugins = [ :exception_notification, :ssl_requirement, :all ]

   # Activate observers that should always be running.
   # config.active_record.observers = :cacher, :garbage_collector, :forum_observer

 # Set Time.zone default to the specified zone and make Active Record auto-convert to
 this zone.
  # Run "rake -D time" for a list of tasks for finding time zone names. Default is UTC.
  # config.time_zone = 'Central Time (US & Canada)'

# The default locale is :en and all translations from config/locales/*.rb,yml are auto
 loaded.
  # config.i18n.load_path += Dir[Rails.root.join('my', 'locales', '*.{rb,yml}').to_s]
  # config.i18n.default_locale = :de

 # Configure the default encoding used in templates for Ruby 1.9.
config.encoding = "utf-8"

# Configure sensitive parameters which will be filtered from the log file.
config.filter_parameters += [:password]

# Enable escaping HTML in JSON.
config.active_support.escape_html_entities_in_json = true

# Use SQL instead of Active Record's schema dumper when creating the database.
# This is necessary if your schema can't be completely dumped by the schema dumper,
# like if you have constraints or database-specific column types
# config.active_record.schema_format = :sql

# Enforce whitelist mode for mass assignment.
# This will create an empty whitelist of attributes available for mass-assignment for 
all models
# in your app. As such, your models will need to explicitly whitelist or blacklist
 accessible
# parameters by using an attr_accessible or attr_protected declaration.
config.active_record.whitelist_attributes = true

# Enable the asset pipeline
config.assets.enabled = true

# Version of your assets, change this if you want to expire all your assets
config.assets.version = '1.0'
  end
 end 
```

github地址： [https ://github.com/froeal01/sample_app](https://github.com/froeal01/sample_app)

尝试启动服务器，创建时出现此错误：

退出 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:245:in `load': C:/Sites/rails_projects /sample_app/c onfig/routes.rb:64：语法错误，意外的keyword_end，期待$end（语法错误）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:48:03.700

您的应用程序助手缺少`end`.

```
 def full_title(page_title)
   base_title = "Ruby on Rails Tutorials Sample App"
   if page_title.empty?
     base_title
   else
    "#{base_title} | #{page_title}"
   end
 end 
```

您如何定义路线存在问题。Rails 路线都是小写的。

```
SampleApp::Application.routes.draw do
  get "home",     :to => "static_pages#home"
  get "help",     :to => "static_pages#help"
  get "about",    :to => "static_pages#about"
  get "contacts", :to => "static_pages#contacts"
end 
```

因此，您的关于页面的路线应该`about_path`改为。

# sql - SQL 语句 - 如何提高索引速度

> ID：15621128
> 
> 赞同：2
> 
> 时间：2013-03-25T17:31:42.937
> 
> 标签：sql, sql-server, sql-server-2008

我有一个脚本，它必须查看超过 250 万条记录，以查找是否有未读电子邮件的成员。我想知道可以做些什么来提高它的速度。目前，运行脚本最多可能需要 8 秒：

```
SELECT TOP(1) MemberMailID
FROM MemberMail
WHERE ToReadFlag = 0
AND ToMemberID = 102
AND ToDeletedFlag = 0
AND FromDeletedFlag = 0
AND OnHold = 0
AND ToArchivedFlag = 0 
```

如何使用索引使其更快？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T17:51:14.160

该索引可能会有所帮助，但请记住，没有免费的午餐（必须维护索引，因此这会影响您的插入/更新/删除工作量）：

```
CREATE NONCLUSTERED INDEX unread_emails
  ON dbo.MemberMail(ToMemberID)
  INCLUDE (MemberMailID)
  WHERE ToReadFlag = 0
  AND ToDeletedFlag = 0
  AND FromDeletedFlag = 0
  AND OnHold = 0
  AND ToArchivedFlag = 0; 
```

现在您的查询可以说：

```
SELECT TOP (1) MemberMailID
  FROM dbo.MemberMail -- dbo prefix
    WITH (INDEX (unread_emails)) -- in case you need to force, though you should not
WHERE ToMemberID = 102
AND ToReadFlag = 0
AND ToDeletedFlag = 0
AND FromDeletedFlag = 0
AND OnHold = 0
AND ToArchivedFlag = 0
ORDER BY ToMemberID; -- ORDER BY is important! 
```

如果您根据查询更改其中一些标志的值，您可以尝试将这些列添加到索引的键而不是过滤器，例如，假设有时您检查`OnHold = 0`并且有时`OnHold = 1`：

```
CREATE NONCLUSTERED INDEX unread_emails
  ON dbo.MemberMail(ToMemberID, OnHold)
  INCLUDE (MemberMailID)
  WHERE ToReadFlag = 0
  AND ToDeletedFlag = 0
  AND FromDeletedFlag = 0
  AND ToArchivedFlag = 0; 
```

您可能还想尝试使用`MemberMailID`in 代替`INCLUDE`. 例如：

```
CREATE NONCLUSTERED INDEX unread_emails
  ON dbo.MemberMail(ToMemberID, MemberMailID)
  WHERE ToReadFlag = 0
  AND ToDeletedFlag = 0
  AND FromDeletedFlag = 0
  AND OnHold = 0
  AND ToArchivedFlag = 0; 
```

这些差异可能对您的数据和使用模式无关紧要，但您将能够比我们猜测的更容易测试差异。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T17:56:09.633

看起来很适合[过滤索引](http://msdn.microsoft.com/en-us/library/cc280372%28v=sql.100%29.aspx)。

> 过滤索引是一种优化的非聚集索引，特别适用于覆盖从明确定义的数据子集中进行选择的查询。它使用过滤谓词来索引表中的部分行。与全表索引相比，设计良好的过滤索引可以提高查询性能，降低索引维护成本，降低索引存储成本。

这些方面的东西：

```
CREATE NONCLUSTERED INDEX IX_MemberMail_ToMemberId_Unread
ON dbo.MemberMail (ToMemberId ASC)
WHERE ToReadFlag = 0
AND ToDeletedFlag = 0
AND FromDeletedFlag = 0
AND OnHold = 0
AND ToArchivedFlag = 0; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T17:36:42.653

在 SSMS 中通过 (CTRL+M)获取**实际查询计划。**或者将您的查询粘贴到 SSMS 中，右键单击它，选择**在数据库引擎优化顾问中分析查询**，您将看到需要添加的索引。基本上，您需要一个复合+包含索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T17:37:16.660

作为一个经验法则，您执行频繁过滤器（条件）的*每个*`where`字段都必须被索引。

同样，作为一个经验法则，我遵循以下标准：

1.  每个关键字段（主字段或外字段）都必须编入索引
2.  `date`我必须执行频繁查找的每个字段都必须被索引
3.  尽管我避免了它，但如果我需要对`char`或`varchar`字段执行频繁的搜索，我也会对它们进行索引

请注意，很容易陷入索引所有内容的诱惑。不要这样做。小心并以最佳的成本效益关系设计您的索引。

我是 MySQL 用户，我不知道如何在 SQL Server 中执行此操作，但必须有一种方法可以显示查询的执行计划（在 MySQL 中是`explain select...`）。尝试显示执行计划，然后在此基础上决定您需要索引哪些字段。

# maven-2 - 我失去了 hotdeploy jboss 的能力

> ID：15621134
> 
> 赞同：0
> 
> 时间：2013-03-25T17:31:59.367
> 
> 标签：maven-2, jboss7.x

客户想要更改 url 模式以访问 webproject，当我`<warname>newname</warname>`在 maven-war-plugin 中添加一个时，我的 newname.war 已生成，但我失去了 jboss hotdeploy 功能。

尽管我不太确定，但我认为 jboss 使用默认项目名称来生成战争并为 hotdeploy 爆炸它。

您能建议我将项目的 url 更改为 newname/page.xhtml 而不是 oldName/page.xhtml 的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T15:27:47.790

如果只是更改 WAR 上下文的问题，只需在 WAR /WEB-INF/ 目录中添加一个 jboss-web.xml 文件，内容如下：

```
<?xml version="1.0" encoding="UTF-8"?>          
<jboss-web>
    <context-root>newname</context-root>
</jboss-web> 
```

为其他应用服务器执行此操作当然需要使用其他文件。

# javascript - 检测 mousedown 事件持续多长时间，然后在超过一定时间时阻止 mouseup 动作

> ID：15621137
> 
> 赞同：2
> 
> 时间：2013-03-25T17:32:11.300
> 
> 标签：javascript, jquery, touch

我希望有一个更优雅的解决方案来解决这个问题。基本上，我有一个 HTML / Javascript 应用程序，它将在触摸屏信息亭上运行。如果有人通过拖动手指滚动按钮列表，我试图阻止默认点击行为。起初，当它检测到滑动事件时，我试图阻止默认。但后来我突然想到，这并不是真正的滑动事件，而是长时间的鼠标按下。所以我写了以下代码：

```
var downClick;
var startTime;

$(".TPGSW-wrapper").on('mousedown', function () {

    downClick = new Date();
    startTime = downClick.getTime();

});

$(".TPGSW-wrapper").on('mouseup', function () {

    var upClick = new Date();
    var endTime = upClick.getTime();

    if (endTime - startTime < 250) {
        return false;
    } else if (endTime - startTime >= 300) {
        // This is the action that I can't seem to get to work. 
        // I would like it to stop the click event. I also tried mouseup
        this.on('click', function () { preventDefault; });
    }              

}); 
```

这正确地测量了鼠标按下的时间，但是我似乎无法阻止点击事件的触发。有什么想法或建议吗？我正在使用 jquery，这仅用于 webkit 浏览器。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:36:01.170

好的，经过一些测试，我能够让它与以下代码一起工作：

```
var longpress = false;

$(".TPGSW-wrapper").on('click', function (e) {
    (longpress) ?  e.preventDefault() : alert("clicked");
});

var startTime, endTime;
$(".TPGSW-wrapper").on('mousedown', function () {
    startTime = new Date().getTime();
});

$(".TPGSW-wrapper").on('mouseup', function () {
    endTime = new Date().getTime();

    if (endTime - startTime < 250) {
        longpress = false;
        console.log('< 250');
    } else if (endTime - startTime >= 300) {
        longpress = true;
        console.log('>= 300');
    }

}); 
```

[演示](http://jsfiddle.net/arcm111/Makgq/)

如果鼠标按住少于 250 毫秒，点击事件将触发，如果超过 300 毫秒，它将调用`e.preventDefault`并停止点击事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:36:42.577

```
else if (endTime - startTime >= 300) {
    $(this).one('click', function (e) {
        e.preventDefault();
        e.stopImmediatePropagation();
    });
} 
```

请注意如何使用“one”而不是“on”。所以它只会触发一次，而不是每次触发。

或者根据 JCOC611 的评论，您可以删除 mouseup 事件并就地使用它：

```
$(".TPGSW-wrapper").on('click', function (e) {
    var upClick = new Date();
    var endTime = upClick.getTime();

    if (endTime - startTime >= 300) {
        e.preventDefault();
        e.stopImmediatePropagation();
    }              
}); 
```

# python - Pandas：df.set_value() 方法擦除/重置 MultiIndex 的列名

> ID：15621143
> 
> 赞同：0
> 
> 时间：2013-03-25T17:33:02.420
> 
> 标签：python, pandas

我正在编写一个应用程序，它使用 pandas（版本 0.10.1）将底层数据模型存储为（3 级）MultiIndex'ed DataFrame。模型是线谱，索引的顶层是原子跃迁。

一个简单的数据框可能如下所示：

```
 Pos     Sigma       Ampl  Line center Identifier
H-alpha-6697.6 30-30 Comp2  -3.600  0.774000  33.058000       6699.5          b
                     Comp3   3.538  2.153000  28.054000       6699.5          c
                     Contin    NaN       NaN   0.000000          NaN        NaN
                     Comp4   1.384  0.921000  37.504000       6699.5          d
                     Comp1  -2.124  1.977000  69.166000       6699.5          a
               31-31 Comp2  -3.292  0.884603  49.813423       6699.5          b
                     Comp3   3.600  2.299000  19.999000       6699.5          c
                     Contin    NaN       NaN   0.000000          NaN        NaN
                     Comp4   1.692  1.009000  22.222000       6699.5          d
                     Comp1  -1.262  2.534000  68.002000       6699.5          a 
```

在某些时候，我需要能够使用 H-alpha 作为模板创建不同的过渡，例如 H-beta。理想情况下，我会这样做`df.ix['H-beta-wavelength'] = df.ix['H-alpha-6697.6']`，但这是不可能的。因此，我尝试按照以下示例进行操作：[Prepend a level to a pandas MultiIndex](https://stackoverflow.com/questions/14744068/prepend-a-level-to-a-pandas-multiindex)

但是，上面的示例需要`.names`设置多索引级别的 ，以便对它们重新排序。并且`names`属性是在初始化数据框时设置的，但是在构建它的过程中，我非常依赖 set_values() 方法，这样做会破坏`names`属性 - 或者更确切地说将它们设置为`[None, None, None]`.

例子：

```
In [68]: df
Out[68]: 
                                  Pos  Sigma     Ampl  Line center Identifier
Transition     Rows  Component                                               
Center: 6699.5 26-26 Comp2     -3.846  0.657  15.2740       6699.5          b
                     Comp3      2.924  1.449  31.3930       6699.5          c
                     Contin       NaN    NaN   0.0000          NaN        NaN
                     Comp4      8.030  1.009   7.0831       6699.5          d
                     Comp1     -1.816  2.153  50.2750       6699.5          a

In [69]: df.set_value(('Center: 5044.3', '26-26', 'Comp1'), 'Sigma', 2.457)
Out[69]: 
                               Pos  Sigma     Ampl  Line center Identifier
Center: 6699.5 26-26 Comp2  -3.846  0.657  15.2740       6699.5          b
                     Comp3   2.924  1.449  31.3930       6699.5          c
                     Contin    NaN    NaN   0.0000          NaN        NaN
                     Comp4   8.030  1.009   7.0831       6699.5          d
                     Comp1  -1.816  2.153  50.2750       6699.5          a
Center: 5044.3 26-26 Comp1     NaN  2.457      NaN          NaN        NaN 
```

当然，这使得使用名称重新排序多索引的级别变得非常困难。有没有办法避免这种情况，每次我跑完之后都蛮力设置名称`set_values()`？

## 编辑：更简单、可重复的示例。

这是一个 iPython 会话，它`index.names`用一个更简单的示例重新创建了问题。它还表明它可能是一个超出 的错误`index.names`，因为它似乎将`index.lexsort_depth`3 更改为 0。提示中缺少的数字只是数据框的不必要视图。我相信必须像我在下面所做的那样选择已经存在的二级和/或三级索引才能复制它。

```
In [4]: idx = pd.MultiIndex.from_arrays(
            [['Hans']*4 + ['Grethe']*4, ['1', '1', '2', '2']*2, ['a', 'b']*4], 
            names=['Name', 'Number', 'Letter'])

In [5]: df = pd.DataFrame(
            random.random((8, 3)), 
            columns=['one', 'two','three'], 
            index=idx)

In [6]: df
Out[6]: 
                           one       two     three
Name   Number Letter                              
Hans   1      a       0.803566  0.434574  0.805976
              b       0.655322  0.208469  0.989559
       2      a       0.893952  0.380358  0.173764
              b       0.822446  0.673894  0.676573
Grethe 1      a       0.202641  0.387263  0.405296
              b       0.646733  0.086953  0.882114
       2      a       0.358458  0.147107  0.769586
              b       0.183782  0.477863  0.601098

# To rule out another possible source of problems:
In [9]: df.unstack().drop(('Grethe', '1')).stack()
Out[9]: 
                           one       two     three
Name   Number Letter                              
Grethe 2      a       0.358458  0.147107  0.769586
              b       0.183782  0.477863  0.601098
Hans   1      a       0.803566  0.434574  0.805976
              b       0.655322  0.208469  0.989559
       2      a       0.893952  0.380358  0.173764
              b       0.822446  0.673894  0.676573

In [10]: df.set_value(('Frans', '2', 'b'), 'one', 23.)
Out[10]: 
                  one       two     three
Hans   1 a   0.803566  0.434574  0.805976
         b   0.655322  0.208469  0.989559
       2 a   0.893952  0.380358  0.173764
         b   0.822446  0.673894  0.676573
Grethe 1 a   0.202641  0.387263  0.405296
         b   0.646733  0.086953  0.882114
       2 a   0.358458  0.147107  0.769586
         b   0.183782  0.477863  0.601098
Frans  2 b  23.000000       NaN       NaN

In [11]: df = df.sortlevel(level='Name')

In [13]: df.index.lexsort_depth
Out[13]: 3

In [14]: df.set_value(('Frans', '2', 'b'), 'one', 23.).index.lexsort_depth
Out[14]: 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T20:33:31.940

您的索引需要排序！请参阅此处的文档：http: [//pandas.pydata.org/pandas-docs/dev/indexing.html#the-need-for-sortedness](http://pandas.pydata.org/pandas-docs/dev/indexing.html#the-need-for-sortedness)这些食谱可能会有所帮助[http://pandas.pydata.org/pandas-docs/ dev/cookbook.html](http://pandas.pydata.org/pandas-docs/dev/cookbook.html) 这也是 0.10.1

这是一个排序的框架

```
In [26]: index = pd.MultiIndex.from_arrays([['a', 'a', 'b', 'b'], [1, 2, 1, 2]],
              names=['first', 'second'])

In [27]: df = pd.DataFrame(np.random.rand(len(index)), index=index,columns=['A'])

In [7]: df.index.lexsort_depth
Out[7]: 2

In [28]: df.set_value(('a',1),'A',1)
Out[28]: 
                     A
first second          
a     1       1.000000
      2       0.136456
b     1       0.712612
      2       0.818473 
```

如果我按第二级排序（所以它未排序）

```
In [29]: df2 = df.sortlevel(level='second')

# this is not sorted! (well it is, just not lexsorted)
In [10]: df2.index.lexsort_depth
Out[10]: 0

In [30]: df2.set_value(('b','1'),'A',2)
Out[30]: 
            A
a 1  1.000000
b 1  0.712612
a 2  0.136456
b 2  0.818473
  1  2.000000 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T20:45:36.597

所以根据安迪海登的说法，这是`names`熊猫的一个错误。希望很快会有修复。

在此之前，我认为最好的方法是执行以下操作：

```
tmp = df.ix['ExistingTransition'].copy()
tmp['Transition'] = 'NewTransition'
tmp = tmp.set_index('Transition', append=True)
tmp.index = tmp.index.reorder_levels([2, 0, 1])
# ...Do whatever else needs to be done to this before applying as template...
df = df.append(tmp) 
```

...那，或者确保`names`在每次运行后重新创建属性`set_values()`，然后通过问题中链接的示例进行操作。

# javascript - JavaScript 中的部分排序

> ID：15621145
> 
> 赞同：15
> 
> 时间：2013-03-25T17:33:15.583
> 
> 标签：javascript, sorting

是否有任何内置的 JavaScript 函数可以进行[部分排序](http://en.wikipedia.org/wiki/Partial_sorting)？如果没有，什么是实现它的好方法？

*给定一个未排序的N*个元素数组，我想找到相对于某个加权函数最小的*K个元素。**K*比*N*小得多，因此对整个数组进行排序并获取前*K*个元素是低效的。

即使有一些非标准的、依赖于浏览器的东西，我也会很高兴。我仍然可以回退到自定义 JavaScript 实现。

PS：这是我当前的自定义实现（不考虑加权函数，为简单起见仅对元素进行排序）：

```
function bisect(items, x, lo, hi) {
  var mid;
  if (typeof(lo) == 'undefined') lo = 0;
  if (typeof(hi) == 'undefined') hi = items.length;
  while (lo < hi) {
    mid = Math.floor((lo + hi) / 2);
    if (x < items[mid]) hi = mid;
    else lo = mid + 1;
  }
  return lo;
}

function insort(items, x) {
  items.splice(bisect(items, x), 0, x);
}

function partialSort(items, k) {
  var smallest = [];
  for (var i = 0, len = items.length; i < len; ++i) {
    var item = items[i];
    if (smallest.length < k || item < smallest[smallest.length - 1]) {
      insort(smallest, item);
      if (smallest.length > k)
        smallest.splice(k, 1);
    }
  }
  return smallest;
}

console.log(partialSort([5, 4, 3, 2, 1, 6, 7, 8, 1, 9], 3)); 
```

该算法遍历给定数组一次，跟踪到目前为止*k最小项的排序列表，使用二进制搜索插入新元素。*

如果您认为它们可能更快或更优雅，请发布替代解决方案。时间非常受欢迎。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T17:44:07.753

不，只有[完整的数组`sort`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)，因此您需要使用自己的实现。

您的代码几乎没有改进（我曾想到完全相同的算法:-)）：

```
function partialSort(items, k) {
    var smallest = items.slice(0, k).sort(),
        max = smallest[k-1];
    for (var i = k, len = items.length; i < len; ++i) {
        var item = items[i];
        if (item < max) {
            insort(smallest, item);
            smallest.length = k;
            max = smallest[k-1];
        }
    }
    return smallest;
} 
```

（甚至[似乎更快一点](http://jsperf.com/partial-sort)，我猜是由于缓存了`max`变量）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-08-05T13:39:05.110

对于相对较小的*k*，实现 Max Heap 是值得的（由于 JavaScript 中缺少原生堆）：

*   创建前*k*个值的**最大**堆

**   对于每个剩余值：

    *   如果它小于堆的根，则将根替换为该值。否则忽略该值。请注意，堆的大小永远不会改变。*   最后对堆进行排序并返回。* 

 *这实际上是对使用**Min** Heap 的另一个想法的改进，但是需要堆化*整个*数组，因此不会运行得那么快。在堆化整个数组之后，您只需从该堆中提取*k*次值，然后返回这些值。

我已将这两种解决方案添加到[Bergi 的 jsperf.com 性能测试](https://jsperf.com/partial-sort/4)（复制到[jsbench.me](https://jsbench.me/pcklz3b84w/1)）。对于该特定测试（5000 个数组值，k = 10），最大堆解决方案更快。*但是这个优势会随着k*的增加而缩小。

这是 Max Heap 解决方案的代码：

```
// A few Heap-functions that operate on an array
function maxSiftDown(arr, i=0, value=arr[i]) {
    if (i >= arr.length) return;
    while (true) {
        var j = i*2+1;
        if (j+1 < arr.length && arr[j] < arr[j+1]) j++;
        if (j >= arr.length || value >= arr[j]) break;
        arr[i] = arr[j];
        i = j;
    }
    arr[i] = value;
}

function maxHeapify(arr) {
    for (var i = arr.length>>1; i--; ) maxSiftDown(arr, i);
    return arr;
}

// The main algorithm
function partialSortWithMaxHeap(items, k) {
    var heap = maxHeapify(items.slice(0, k));
    for (var i = k, len = items.length; i < len; ++i) {
        var item = items[i];
        if (item < heap[0]) maxSiftDown(heap, 0, item);
    }
    return heap.sort((a,b) => a-b);
}

// Sample data & call
var arr = Array.from({length:5000}, () => Math.floor(Math.random() * 1e5));

console.log(partialSortWithMaxHeap(arr, 10));
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T17:50:09.887

没有原生的部分排序功能。最接近您想要的是[Array.filter](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)。

```
function isSmallEnough(element, index, array) {
  return (element <= 10);
}
var filtered = [12, 5, 8, 130, 44].filter(isSmallEnough);
// filtered is [5, 8] 
```

该示例是从上述链接中借用（并稍作修改）的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-16T09:03:21.590

我制作了一个可以处理对象的版本，比如 Array.sort(f)：

```
function partialSort(items, k,f) {
    function bisect(items, x, lo, hi) {
        var mid;
        if (typeof(lo) == 'undefined') lo = 0;
        if (typeof(hi) == 'undefined') hi = items.length;
        while (lo < hi) {
        mid = Math.floor((lo + hi) / 2);
        if (0>f(x,items[mid])) hi = mid;
        else lo = mid + 1;
        }
        return lo;
    }

    function insort(items, x) {
        items.splice(bisect(items, x), 0, x);
    }

    var smallest = items.slice(0, k).sort(f),
        max = smallest[k-1];
    for (var i = k, len = items.length; i < len; ++i) {
        var item = items[i];
        if (0>f(item,max)) {
            insort(smallest, item);
            smallest.length = k;
            max = smallest[k-1];
        }
    }
    return smallest;
}

// [ { e: 1 }, { e: 1 }, { e: 2 } ]
console.log(partialSort([{e:4},{e:6},{e:1},{e:8},{e:3},{e:1},{e:6},{e:2}],3,(a,b)=>a.e-b.e))
console.log() 
```*

# c# - 如何使用 C# 模拟 CTRL+V 击键（粘贴）

> ID：15621147
> 
> 赞同：11
> 
> 时间：2013-03-25T17:33:34.977
> 
> 标签：c#, html, winforms, paste

我们如何使用 C# 模拟`CTRL`+`V`键（粘贴）？

我有一个没有用于访问的 id 的文本框，例如`textbox1.Text = someValue`在这里不起作用。
我想通过单击来填充该文本框（从剪贴板）。由于某些原因，我们确实需要模拟`CTRL`+ `V`，这意味着我们不能使用像[inputsimulator](http://inputsimulator.codeplex.com/)这样的外部库。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-25T17:50:13.563

字符与键

`%`=> `alt`, `+`=>`shift`和`^`for 发送`ctrl`密钥

**原答案：**

下面解释了单个修饰键与另一个键的模拟 **步骤 1：**聚焦文本框，您要在其上执行两个键，然后**步骤 2：**发送键，例如 control-v 将像发送一样`"^{v}"`。这是代码

```
target_textBox.Focus();
SendKeys.Send("^{v}"); 
```

`target_textBox.Focus();`仅当发送密钥时目标文本框未聚焦时才需要

**更新：对于发送三个键**（两个修改键加上其他键）喜欢实现`ctrl shift F1`你将发送以下

`^+{F1}`

[微软文档参考](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.sendkeys.send?redirectedfrom=MSDN&view=netframework-4.8#System_Windows_Forms_SendKeys_Send_System_String_)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T17:56:59.110

为什么不覆盖 TextBox OnClick 事件，而不是在调用事件时，将 Text 属性设置为 Clipboard.GetText()

喜欢：

```
private void textBox1_Click ( object sender, EventArgs e )
{
        textBox1.Text = Clipboard.GetText ();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-14T13:13:11.603

此函数已内置：[TextBoxBase.Paste()](https://msdn.microsoft.com/de-de/library/system.windows.forms.textboxbase.paste%28v=vs.110%29.aspx)

```
textbox1.Paste(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-24T05:29:34.547

一些 JS 不允许以通常的方式改变值

```
inputList[21].SetAttribute("value", txtEMail.Text); 
```

你应该尝试这样的事情：

```
inputElement.InvokeMember("focus");
inputElement.InvokeMember("click"); //sometimes helpfull
Clipboard.SetDataObject(txtEMail.Text);
SendKeys.Send("^(v)"); 
```

//但不是“^{v}”

# javascript - 如何为 Windows 商店 javascript 应用程序实现异步 for 循环？

> ID：15621150
> 
> 赞同：0
> 
> 时间：2013-03-25T17:33:39.773
> 
> 标签：javascript, loops, windows-8, visual-studio-2012, windows-store-apps

我目前正在开发一个 Windows 商店 javascript 应用程序并坚持实现异步 for 循环。

考虑一个简单的 for 循环如下

```
for(i=0,i<4,i++)
{
//body
} 
```

可以执行与上述代码相同的过程的确切 asyncFor 循环是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:47:17.867

只有当我理解你是正确的......你可以尝试这样的事情：

```
function asyncFor(n, callback)
{
    var i=0;
    var t=setInterval(function(){
        callback();
        i++;
        if(i==n)
            clearInterval(t);
    }, 0);
}

asyncFor(4, function(){
    console.log('hello world');
});
console.log('after for'); 
```

如果不是 - 对不起，忽略我的回答

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T11:18:11.707

如果您正在遍历一个数组，这两个助手可能会派上用场（CoffeeScript 语法用于更简洁的表示法）。如果您对猴子补丁不满意，请随意将它们转换为独立函数。

```
# call function for each element in array
# returns when all promises have been completed
Array::eachAsync = (fn) ->
  promises = @map (item, index, collection) -> fn(item, index, collection)
  WinJS.Promise.join(promises)

# call function for each element in array in order
# returns when the last one has been processed
Array::sequentialEachAsync = (fn) ->
  @reduce (lastPromise, item) ->
    lastPromise.then () -> fn(item)
  , WinJS.Promise.wrap() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:35:27.590

使用回调函数。

```
someFunction = function(data, ...){
    someAsyncFn(someFunction); //use this function as the callback
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T17:56:03.800

通常，您需要对循环进行递归编码 - 从异步回调中调用下一个递归步骤：

```
function loop(i, n, body, callback) {
    if (i < n)
        body(i, function cb() {
            loop(i+1, n, body, callback);
        });
    else
        callback();
} 
```

然后像这样使用它

```
loop(0, 4, function(i, cb) {
    console.log(i);
    setTimeout(cb, 50); // or whatever async task with callback you have
}, function() {
    console.log("done everything");
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T17:56:29.857

```
You can use a recursive function callback
 function test(){
  myCall(function(){
       alert("Hello world");
    },5);
 }
function myCall(callback , count){
      if(count === 0){
           return;
      }else{
         callback();
         count--;
      }
      myCall(callback , count);
} 
```

# forms - 如何在 MS ACCESS 中记录 Mod_Date_Time

> ID：15621151
> 
> 赞同：0
> 
> 时间：2013-03-25T17:33:44.643
> 
> 标签：forms, datetime, ms-access

我的数据库中有许多表单，我已经能够为每个表中的每条记录捕获 CREATE_DATE_TIME。有没有办法同时捕获每条记录的 MOD_DATE_TIME？即最后一次捕获记录被修改的时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-11-23T18:54:49.103

`MOD_DATE_TIME`在表单的事件中设置值`BeforeUpdate`- 就像您已经`CREATE_DATE_TIME`在`BeforeInsert`事件中一样。

# forms - Symfony2 Forms - 依赖实体字段

> ID：15621155
> 
> 赞同：2
> 
> 时间：2013-03-25T17:33:50.053
> 
> 标签：forms, symfony

关于汽车应用程序，我有一个用户可以选择品牌和型号的表格；目的是模型取决于品牌。例如，当您选择“品牌 A”时，则仅显示与品牌 A 相关的模型。

现在，我已经在初始表单上被阻止（没有设置数据）；显示了一个默认品牌，我希望显示与该品牌相关的模型。

我按照一些教程添加了一个事件订阅者，但我无法让它工作；我无法将品牌的字段值输入我的订阅者...我试图获取品牌实体，但从逻辑上讲它是空的（因为尚未提交表单）。

有人有想法吗？

表单类型：

```
public function buildForm( FormBuilderInterface $builder, array $options ) {

    $builder->add( 'brand', 'entity', array(
        'class' => 'MyBundle:Brand',
        'property' => 'name',
    ));

    $builder->add( 'model', 'entity', array(
        'class' => 'MyBundle:Model',
        'property' => 'name',   
    ));

    /* Add event for the first model choices */
    $builder->addEventSubscriber( new ModelChoicesSubscriber() );
} 
```

表单订阅者：

```
class ModelChoicesSubscriber implements EventSubscriberInterface {

    public static function getSubscribedEvents() {

        return array( FormEvents::PRE_SET_DATA => 'preSetData' );
    }

    public function preSetData( FormEvent $event ) {
        $data = $event->getData();
        $form = $event->getForm();

        if( $data == null ) {
            return;
        }

        $brand = $form->get( 'brand' );
    }

} 
```

# php - 在从mysql查询返回的数组的while循环中找到最小值

> ID：15621161
> 
> 赞同：-2
> 
> 时间：2013-03-25T17:34:11.133
> 
> 标签：php, mysql, while-loop

我有一个像这样的查询：

```
 select * from posts p where p.post like '%cadillac%' ORDER BY p.upvotes DESC,
 p.unix_timestamp DESC LIMIT 20 
```

现在，在遍历数组时，我需要找到最小值`unix_timestamp`。就像是：

```
 $counter = 0;
 while($row = $result->fetch_assoc()){

 // what do i do here to find the minimum timestamp value 

 $counter = $counter + 1;
 } 
```

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:37:07.580

```
 $counter = 0;
 $min_timestamp = 0;
 while($row = $result->fetch_assoc()){

     //check if min hasn't been set OR if the current timestamp is less than the min
     if(!$min_timestamp || ($row['unix_timestamp'] < $min_timestamp)) {
         //store this timestamp as the current min
         $min_timestamp = $row['unix_timestamp'];
     } 

     //$counter = $counter + 1;
 }
 //once we reach here, min_timestamp will hold the minimum timestamp found 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:38:48.070

以下将起作用：

```
$counter = 0;
$min_value;
while($row = $result->fetch_assoc()){
  $min_value = is_null($min_value) || $min_value > $row['unix_timestamp'] ? $row['unix_timestamp'] :$min_value  ;

  $counter = $counter + 1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:36:14.207

您可以在 SQL 中执行此操作

```
select MIN(unix_timestamp) from posts p where p.post like '%cadillac%' 
```

# office365 - 在 Sharepoint 2013 Online 的应用程序目录中部署列表定义 (.stp)

> ID：15621165
> 
> 赞同：1
> 
> 时间：2013-03-25T17:34:21.897
> 
> 标签：office365, sharepoint-2013

我想知道是否有办法在 SharePoint 应用程序目录网站中添加列表定义。列表定义是从自定义列表生成的，我无法使用 Visual Studio 打包 wsp。

# sql - SQL Server 2008：如何设计具有 2 个主键和 ID 的表，其自动增量与 1 个键值相关

> ID：15621167
> 
> 赞同：0
> 
> 时间：2013-03-25T17:34:28.583
> 
> 标签：sql, sql-server, primary-key, identity, auto-increment

让我更好地解释一下：我需要设计一个需要安装在不同位置（可能相互连接或不相互连接）的数据库。

我的想法是：我为什么不使用一个列，在其中我将有关位置（站点）的信息作为键，并且我有另一个包含记录 ID 的字段？例如，我需要一个`Customers`包含一个`customer_id`和一个`site_id`列的表。

不过，我知道我不能在一个表中创建多个具有自动增量的标识列。我最终想到的是：有没有办法只有一个身份列但与另一列相关？

例如，如果我可以有一个这样的客户表，那就太好了：

```
site_id cust_id description
1        1       John Doe
1        2       Joseph White
1        3       Carlos Santana
2        1       Mike Jones
2        2       Carl Johnson 
```

`cust_id`必须有自动增量。

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:44:40.513

您可以在两列上创建 PK

```
 create table customers (CustomerRegion int not null,
                       CustomerID int identity(1000,1) not null,
                       primary key (CustomerRegion,CustomerID)
                      ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:39:23.280

我有一个更好的建议：如果您只需要每边的数字是唯一的，为什么不这样做呢？在您的设计中，您需要`1`在表中的每一行中重复该值。这对我来说似乎很浪费。相反，尝试给出身份范围：

在站点 1：

```
CREATE TABLE dbo.Customers
(
  CustomerID BIGINT IDENTITY (1000000000,1)
  , other columns... 
```

在站点 2：

```
CREATE TABLE dbo.Customers
(
  CustomerID BIGINT IDENTITY (2000000000,1)
  , other columns... 
```

现在，您不仅几乎可以保证永远不会创建重复项（除非您以惊人的惊人速度创建客户），而且您还可以立即知道客户是在哪里创建的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:41:03.400

听起来您想要一个复合主键（请参阅此处的[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms189039%28v=sql.105%29.aspx)）。

这没什么大不了的，但以后可能会成为皇家的痛苦。（加入多个主键字段很麻烦）

# c# - System.InvalidCastException：从“DateTime”到“Int32”的无效转换。休眠

> ID：15621168
> 
> 赞同：1
> 
> 时间：2013-03-25T17:34:29.293
> 
> 标签：c#, sqlite, nhibernate, datetime, .net

我有以下课程：

```
public class AccionCorrectiva : Modelo<AccionCorrectiva>
{
    ...
    public virtual DateTime FechaFin { get; set; }
    ...
}

public class Indicador : Modelo<Indicador>
{        
    private IList<AccionCorrectiva> _acciones = new List<AccionCorrectiva>();
    public virtual IList<AccionCorrectiva> Acciones
    {
        get { return _acciones; }
        set { _acciones = value; }
    }
} 
```

当我这样做时，`SomeIndicador.Acciones`我得到：

`NHibernate.Exceptions.GenericADOException: could not initialize a collection: [Dominio.Indicador.Acciones#1][SQL: SELECT acciones0_.indicador_id as indicador8_1_, acciones0_.Id as Id1_, acciones0_.FechaFin as FechaFin1_, acciones0_.Id as Id6_0_, acciones0_.Hallazgo as Hallazgo6_0_, acciones0_.Descripcion as Descripc3_6_0_, acciones0_.Objetivo as Objetivo6_0_, acciones0_.FechaFin as FechaFin6_0_, acciones0_.NumEstado as NumEstado6_0_, acciones0_.responsable_id as responsa7_6_0_, acciones0_.indicador_id as indicador8_6_0_ FROM acciones_correctivas acciones0_ WHERE acciones0_.indicador_id=?] ---> System.FormatException: Input string '01/01/2013 0:00:00' was not in the correct format. ---> System.InvalidCastException: Invalid cast from 'DateTime' to 'Int32'.`

我究竟做错了什么？

**编辑** 如果我打电话`AccionCorrectivaRepository.Instance.FindById(1)`，我会得到一个 AccionCorrectiva 并且工作正常！方言是 SQLite

表结构：

```
CREATE TABLE acciones_correctivas (Id INT not null, FechaFin DATETIME); 
```

**映射** 指示符

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                  assembly="Dominio"
                  namespace="Dominio">
  <class name="Indicador" table="indicadores">
    <id name="Id">
      <generator class="increment" />
    </id>
    <list name="Acciones" cascade="all-delete-orphan">
      <key column="indicador_id" />
      <index column="FechaFin" />
      <one-to-many class="AccionCorrectiva" />
    </list>

  </class>
</hibernate-mapping> 
```

AccionCorrectiva：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                  assembly="Dominio"
                  namespace="Dominio">
  <class name="AccionCorrectiva" table="acciones_correctivas">
    <id name="Id">
      <generator class="increment" />
    </id>
    <many-to-one name="Indicador" column="indicador_id" />

  </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T05:49:36.413

问题是`<index>`映射。请参阅文档：[6.3。值集合和多对多关联](http://nhibernate.info/doc/nh/en/index.html#collections-ofvalues)

提炼：

> 对于像地图和列表这样的索引集合，我们需要一个`<index>` 元素。对于列表，此列包含从零开始编号的连续整数。如果您必须处理遗留数据，请确保您的索引确实从零开始。对于地图，该列可以包含任何 NHibernate 类型的任何值。

换句话说，将*索引*视为 C#`IList`索引（例如支持`list[0]`访问）。因此，必须有 int 类型（或 smallint...）的列，NHibernate 将使用它来跟踪`IList`索引。

# python - Python Fabric - 未找到主机。请指定（单个）主机字符串进行连接：

> ID：15621174
> 
> 赞同：16
> 
> 时间：2013-03-25T17:34:50.763
> 
> 标签：python, fabric

如何获得未找到主机。请指定（单个）主机字符串进行连接：？

如何解决面料问题？

```
def bootstrap():
    host = 'ec2-54-xxx.xxx.xxx.compute-1.amazonaws.com'
    env.hosts = [host]
    env.user = "ubuntu"
    env.key_filename = "/home/ubuntu/omg.pem"

> command run
>> fab bootstrap
> No hosts found. Please specify (single) host string for connection: 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-06-08T15:28:06.223

您也可以使用 env.host_string 代替 env.hosts：

```
def bootstrap():
    env.host_string # 'ec2-54-xxx.xxx.xxx.compute-1.amazonaws.com'
    env.user = "ubuntu"
    env.key_filename = "/home/ubuntu/omg.pem" 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-25T18:08:25.363

不要在任务中设置主机，而是在使用装饰器调用它之前执行它：

```
from fabric.api import hosts, env

@hosts(['ec2-54-xxx.xxx.xxx.compute-1.amazonaws.com'])
def bootstrap():
    env.user = "ubuntu"
    env.key_filename = "/home/ubuntu/omg.pem" 
```

有关这方面的更多信息，请查看[定义主机列表](http://docs.fabfile.org/en/1.4.0/usage/execution.html#defining-host-lists)- 根据您的需要，有很多不同的方法可以做到这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-15T08:55:22.407

或者，您可以在函数之外设置环境设置

```
from fabric.api import env, run

host = 'ec2-54-xxx.xxx.xxx.compute-1.amazonaws.com'
env.hosts = [host]
env.user = "ubuntu"
env.key_filename = "/home/ubuntu/omg.pem"

def test():
    run('ls -la') 
```

# apache - 取出 [R:Redirect] 后 mod_rewrite 不起作用

> ID：15621176
> 
> 赞同：1
> 
> 时间：2013-03-25T17:34:53.507
> 
> 标签：apache, .htaccess, codeigniter, mod-rewrite

我使用 CodeIgniter 并试图重写 url 以实现对 SEO 友好。目的是...

```
http://localhost/FOR-SEO/item/view/id
-> to -> http://localhost/item/view/id 
```

（只是想把 FOR-SEO 排除在外）

我尝试按如下方式添加 htaccess，

```
RewriteRule ^(.*)/item/view/(.*)$ /item/view/$2 [R,L] 
```

所以变成了……

```
RewriteEngine on
RewriteCond $1 !^(index\.php|resources|robots\.txt)
RewriteRule ^(.*)/item/view/(.*)$ /item/view/$2 [R,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

它工作正常，但在我取出 [R] 后，它显示未找到 404 错误。

我试图检查重写日志，但是对于 [R] 和没有 [R]，一切都是一样的

这是带有 [R] 的日志（工作）

```
[rid#1009868a0/initial] (1) [perdir /Applications/MAMP/htdocs/himaparn/] escaping http://localhost:8888/item/view/2 for redirect
[rid#1009868a0/initial] (1) [perdir /Applications/MAMP/htdocs/himaparn/] redirect to http://localhost:8888/item/view/2 [REDIRECT/302]
[rid#10098a8a0/initial] (1) [perdir /Applications/MAMP/htdocs/himaparn/] internal redirect with /index.php/item/view/2 [INTERNAL REDIRECT]
[rid#100984da8/initial/redir#1] (1) [perdir /Applications/MAMP/htdocs/himaparn/] pass through /Applications/MAMP/htdocs/himaparn/index.php
[rid#1009978a0/subreq] (1) [perdir /Applications/MAMP/htdocs/himaparn/] internal redirect with /index.php/item/view/2 [INTERNAL REDIRECT] 
```

这是没有 [R] 的日志，（不工作）

```
[localhost/sid#100813108][rid#10098f8a0/initial] (1) [perdir /Applications/MAMP/htdocs/himaparn/] internal redirect with /item/view/2 [INTERNAL REDIRECT]
[localhost/sid#100813108][rid#100993a50/initial/redir#1] (1) [perdir /Applications/MAMP/htdocs/himaparn/] internal redirect with /index.php/item/view/2 [INTERNAL REDIRECT]
[localhost/sid#100813108][rid#100991828/initial/redir#2] (1) [perdir /Applications/MAMP/htdocs/himaparn/] pass through /Applications/MAMP/htdocs/himaparn/index.php
[localhost/sid#100813108][rid#1009978a0/subreq] (1) [perdir /Applications/MAMP/htdocs/himaparn/] internal redirect with /index.php/item/view/2 [INTERNAL REDIRECT] 
```

这有什么问题，我有更好的解决方案来完成这项工作吗？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:51:08.007

我认为这是因为`[R]` [强制进行外部重定向](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_r)，在这种情况下，基础已经设置，并且路径被附加到重定向端点的基础 url。

因此，与，对，`[R]`的请求将被附加到离开你`http://example.com/index.php/item/view/2``/index.php/item/view/2``http://example.com/``http://example.com/index.php/item/view/2`

如果没有，`[R]`您将获得内部重定向。这将附加`/index.php/item/view/2`到请求中。因此，请求`http://example.com/index.php/item/view/2`将使您获得`http://example.com/index.php/item/view/2/index.php/item/view/2`一个`404`.

您可以非常清楚地看到日志中的多个重定向：

> ...
> [rid#100993a50/initial/redir#1]...
> [rid#100991828/initial/redir#2]...
> ...

# android - 单击 ArraryList 项时出现 java.lang.IndexOutOfBoundsException 错误

> ID：15621180
> 
> 赞同：0
> 
> 时间：2013-03-25T17:35:00.100
> 
> 标签：android, listview, arraylist, simplecursoradapter, indexoutofboundsexception

单击我的列表视图项时，下一个活动将不会启动，并且我收到“java.lang.IndexOutOfBoundsException”错误。logcat 指向第 131 行（我认为），但我不确定要进行哪些更改。我的列表视图应该按字母顺序显示我的数据库中的项目，但是当将项目输入我的数据库时，我没有看到我的列表视图中显示的名称列。我认为这可能与我收到的错误有关。在我用内容提供者实现了一个游标加载器之前，这一直很好。

日志猫：

```
03-18 10:05:23.439: E/AndroidRuntime(1286): FATAL EXCEPTION: main
03-18 10:05:23.439: E/AndroidRuntime(1286): java.lang.IndexOutOfBoundsException: Invalid index 0, size is 0
03-18 10:05:23.439: E/AndroidRuntime(1286):     at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:251)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at java.util.ArrayList.get(ArrayList.java:304)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at com.loginplus.home.LoginList.onItemClick(LoginList.java:131)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.widget.AdapterView.performItemClick(AdapterView.java:292)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.widget.AbsListView.performItemClick(AbsListView.java:1058)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.widget.AbsListView$PerformClick.run(AbsListView.java:2514)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.widget.AbsListView.onTouchEvent(AbsListView.java:3180)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.View.dispatchTouchEvent(View.java:5541)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1951)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1712)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1912)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1371)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.app.Activity.dispatchTouchEvent(Activity.java:2364)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1860)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.View.dispatchPointerEvent(View.java:5721)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:2890)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2466)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewRootImpl.processInputEvents(ViewRootImpl.java:845)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:859)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.os.Looper.loop(Looper.java:137)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at android.app.ActivityThread.main(ActivityThread.java:4424)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at java.lang.reflect.Method.invokeNative(Native Method)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at java.lang.reflect.Method.invoke(Method.java:511)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
03-18 10:05:23.439: E/AndroidRuntime(1286):     at dalvik.system.NativeStart.main(Native Method) 
```

列表显示：

```
 39\. public void onCreate(Bundle savedInstanceState) {
 40\.     super.onCreate(savedInstanceState);
 41.
 42\.     setContentView(R.layout.login_listview);
 43\.     getSupportLoaderManager().initLoader(LOADER_ID, null, this);
 44.
 45\.     String[] from = { BaseColumns._ID, dataStore.COLUMN_NAME_SITE};
 46\.     int[] to = {R.id.rusName};
 47.
 48\.     adapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_1, null, from, to);
 49\.             
 50.
 51\.     loginList = (ListView)
 52\.     findViewById(R.id.loginlist);
 53\.     loginList.setOnItemClickListener(this);
 54.
 55\.     webLogin = (Button)
 56\.     findViewById(R.id.button3);
 57\.     webLogin.setOnClickListener(this);   
 58\. }
 59.
 60\. public Loader<Cursor> onCreateLoader(int id, Bundle args) {
 61.
 62\.     String[] projection = { BaseColumns._ID, dataStore.COLUMN_NAME_SITE};
 63\.     CursorLoader cursorloader = new CursorLoader(this, ListProvider.CONTENT_URI,  projection, null , null, null);
 64\.     return  cursorloader;
 65\.  }
 66.
 67\. public void onLoadFinished(Loader<Cursor> cursorLoader, Cursor cursor) {
 68\.     adapter.changeCursor(cursor);
 69\. }
 70\. public void onLoaderReset(Loader<Cursor> cursorLoader) {
 71\.     adapter.changeCursor(null);
 72\. }
 73.
 74.
 75\. @Override
 76\. public void onClick (View v) {
 77\.     Intent webLoginIntent = new Intent (this, LoginPlusActivity.class);
 78\.     startActivity(webLoginIntent);
 79\. }
 80.
 81\. public List<String> populateList (){
 82.
 83\.     List<String> webNameList = new ArrayList<String>();
 84.
 85\.     dataStore openHelperClass = new dataStore (this);
 86.
 87\.     SQLiteDatabase sqliteDatabase = openHelperClass.getReadableDatabase();
 88.
 89\.     Cursor cursor = sqliteDatabase.query(dataStore.TABLE_NAME_INFOTABLE, null, null, null, null, null, dataStore.COLUMN_NAME_SITE, null);
 90.
 91\.     while (cursor.moveToNext()){
 92\.         String sName = cursor.getString(cursor.getColumnIndex(dataStore.COLUMN_NAME_SITE));
 93\.         String wUrl = cursor.getString(cursor.getColumnIndex(dataStore.COLUMN_NAME_ADDRESS));
 94\.         String uName = cursor.getString(cursor.getColumnIndex(dataStore.COLUMN_NAME_USERNAME));
 95\.         String pWord = cursor.getString(cursor.getColumnIndex(dataStore.COLUMN_NAME_PASSWORD));
 96\.         String lNotes = cursor.getString(cursor.getColumnIndex(dataStore.COLUMN_NAME_NOTES));
 97.
 98\.          LoginDetails lpDetails = new LoginDetails();
 99\.          lpDetails.setsName(sName);
 100\.         lpDetails.setwUrl(wUrl);
 101\.         lpDetails.setuName(uName);
 102\.         lpDetails.setpWord(pWord);
 103\.         lpDetails.setlNotes(lNotes);
 104.
 105\.         loginArrayList.add(lpDetails);
 106\.         webNameList.add(sName);
 107\.     }
 108.
 109\.     cursor.close();
 110\.     return webNameList;
 111\. }
 112.
 113.
 114.
 115\. @Override
 116\. protected void onResume() {
 117\.     super.onResume();
 118.
 119.
 120\.     adapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_1, null, new String[] { dataStore.COLUMN_NAME_SITE}, new int[]{R.id.loginlist});
 121\.     loginList.setAdapter(adapter);  
 122\. }
 123.
 124\. @Override
 125\. public void onItemClick(AdapterView<?> arg0 , View arg1, int arg2, long arg3) {
 126\.     Toast.makeText(getApplicationContext(), "Selected ID :" + arg2, Toast.LENGTH_SHORT).show();
 127.
 128\.     Intent updateDeleteLoginInfo = new Intent (this, UpdateDeleteLoginList.class);
 129.
 130.
 131\.     LoginDetails clickedObject = loginArrayList.get(arg2);
 132.
 133\.     Bundle loginBundle = new Bundle();
 134\.     loginBundle.putString("clickedWebSite",clickedObject.getsName());
 135\.     loginBundle.putString("clickedWebAddress",clickedObject.getwUrl());
 136\.     loginBundle.putString("clickedUserName",clickedObject.getuName());
 137\.     loginBundle.putString("clickedPassWord",clickedObject.getpWord());
 138\.     loginBundle.putString("clickedNotes",clickedObject.getlNotes());
 139.
 140\.     updateDeleteLoginInfo.putExtras(loginBundle);
 141.
 142\.     startActivityForResult(updateDeleteLoginInfo, 0);   
 143\. } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:37:39.400

很明显：

```
LoginDetails clickedObject = loginArrayList.get(arg2); 
```

该行假设`arg2`小于`loginArrayList.size()-1`。

JVM 告诉你它不是，不管你的假设是什么。

您可以通过查看将该值传递`arg2`给您的方法的代码来轻松纠正此问题。它的逻辑很糟糕。

我还建议在`args2`从`List`. 您还需要考虑如果您获得了错误的价值，您将返回什么。null 合适吗？你应该抛出某种异常吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T20:35:40.780

您说`populateList()` **应该**在单击项目时调用，但**实际上**从未在您发布的代码中调用它。它是唯一`LoginDetails`添加any 的地方`loginArrayList`。由于从不调用该函数，loginArrayList 始终为空，因此在第 131 行调用时，**大小为 0**部分。`java.lang.IndexOutOfBoundsException: Invalid index 0, size is 0``LoginDetails clickedObject = loginArrayList.get(arg2);`

# android - 使用 GPS 定位跟踪天体

> ID：15621184
> 
> 赞同：-1
> 
> 时间：2013-03-25T17:35:29.060
> 
> 标签：android, ios, gps

我正在尝试创建一个模仿几个存在的小应用程序。我还没有下载任何 APK 来尝试反编译它们。如果这个问题没有得到任何答案，我会尝试。

所以，我想创建一个简单的应用程序来启动它只会找到太阳。应该很容易吧？我不确定是否有我可以使用的预构建 API，或者是否有我可以使用的静态计算，或者这是如何完成的。

我猜设备上的 GPS 会提供位置和时间。这应该是设备唯一需要的东西，其余的可以计算然后显示给用户。

我这样做是为了了解一些关于应用程序创建、动态位置以及一些有趣的事情。任何帮助是极大的赞赏。

谢谢各位堆垛机！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:07:33.820

想一想：如果你想*指向*太阳，位置和时间是不够的。

除了设备在给定时间的**位置**（其坐标）外，您还需要它的**方向**，可以使用[SensorEvent](http://developer.android.com/reference/android/hardware/SensorEvent.html)计算。

# r - 如何在 ggplot2 中独立控制 y 轴刻度和 x 轴刻度？

> ID：15621201
> 
> 赞同：13
> 
> 时间：2013-03-25T17:36:10.900
> 
> 标签：r, ggplot2

我想从 x 轴上删除轴刻度而不从 y 轴上删除它们。

现在，我可以使用以下方法将两者都删除：

```
axis.ticks=theme_blank() 
```

例如：

```
# Generate data
c <- ggplot(mtcars, aes(factor(cyl)))

c + geom_bar()+opts(axis.ticks=theme_blank())
#c + geom_bar(width=.5)
#c + geom_bar() + coord_flip()
#c + geom_bar(fill="white", colour="darkgreen") 
```

但我不知道如何独立控制它们。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-25T17:41:11.383

要仅删除 x 轴刻度，请使用`axis.ticks.x=`

```
 c <- ggplot(mtcars, aes(factor(cyl))) 
 c + geom_bar()+opts(axis.ticks.x=theme_blank()) 
```

对于最新的 ggplot2 版本 (0.9.3) 而不是`opts()`使用`theme()`and `element_blank()`.

```
 c <- ggplot(mtcars, aes(factor(cyl))) 
 c + geom_bar()+theme(axis.ticks.x=element_blank()) 
```

# javascript - 我可以从画布的 fillStyle 中获取 r、g 和 b 吗？

> ID：15621204
> 
> 赞同：2
> 
> 时间：2013-03-25T17:36:28.747
> 
> 标签：javascript, html

是否可以从 context.fillStyle 获取 rgb 颜色（并将“红色”、“绿色”和“蓝色”放入变量中）？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:49:10.050

当使用简单的 HTML 十六进制颜色值进行设置时，fillStyle 属性会公开以下形式的字符串：#RRGGBB。您可以像这样提取颜色：

```
var r = parseInt(context.fillStyle.substring(1,3), 16);
var g = parseInt(context.fillStyle.substring(3,5), 16);
var b = parseInt(context.fillStyle.substring(5), 16); 
```

颜色值的范围是 0 到 255。

如果您使用 alpha 设置了颜色值（例如“rgba(127, 63, 255, 0.5)”），它们将像这样返回，您将不得不做更多的工作。

# c++ - 堆问题

> ID：15621207
> 
> 赞同：1
> 
> 时间：2013-03-25T17:36:36.310
> 
> 标签：c++, vector, heap, time-complexity, stl-algorithm

最近我在这里发布了一个关于stackoverflow多图[时间复杂度问题的问题](https://stackoverflow.com/questions/15418912/time-complexity-issues-with-multimap) 我得到了一些很好的答案，这些答案让我提到了堆的使用，奇怪的是我以前根本没有使用过。我创建了一个使用 minheap 和 maxheap 重写的新程序。它工作得很好，因为它比我为这个问题实施的任何其他程序都要快得多。唯一的问题是它偶尔会抛出一些错误的答案。我回去做了很多调试。我意识到问题出在堆的组织上。它没有像我认为的那样使用 push_heap 和带有比较操作的 pop_heap 进行排序和分发。此外，当我尝试在 Visual Studio 上运行该程序时，我最终会看到很多断言错误被抛出。我尝试在 cplusplus.com 和 cppreference.com 上阅读更多关于堆及其方法的信息。

让我困惑的第一件事是push_heap。我理解它的方式是这样的：push_heap 有两个参数，**默认情况下*****它将***最小值推送到位置 last-1。只有当第一个参数小于第二个参数时它才会这样做，否则它保持不变。它基本上保持了正常堆的顺序。第三个可选参数是一个比较运算符，它可以用作greater()，然后将较大的元素推到最后一个位置。

没有意义的是，如果我在向量中动态插入或删除数字，我会在保持此顺序时遇到问题。如果我希望向量按升序排列，我将使用更大的操作来继续推动堆，以便值升序。但是当您第一次查看 push_heap 方法时会感到困惑，因为它看起来很像其他一些算法函数，它们在***一系列***数字中执行，例如：

```
 std::unique (myvector.begin(), myvector.end(), myfunction); 
```

push_heap 没有。它不会对向量*范围内的***所有**数字进行这种比较操作，这点我一开始并不理解。

 *在发现 push_heap 并没有真正保持我的向量排序后，我必须保持我的向量排序才能使用二进制搜索。我使用了 sort_heap，但这会减慢程序速度，使其速度不够快。

另外，我发现有时 push_heap 在奇怪的情况下会抛出一个无效的堆错误。

例如：

```
 push_heap(v.begin(), v.end(), greater<int>()); 
```

向量为**755, 98, 55, 22**

你会在 push_heap 之后看到：

```
 22, 98, 55, 755 
```

但是假设你有 **22, 98, 55,755**

由于比较的错误回报，通常它会继续前进而不执行任何推送。这是可以预料的。

但有时我会尝试 push_heap：

**887、52、44、22**

它会说

```
 'invalid heap' 
```

或者如果我尝试： **22, 52, 44, 887**，而不是仅仅返回 false 并继续前进，它将与

```
'invalid heap' 
```

pop_heap 有时也会发生这种情况。

为什么我得到无效堆？是因为所有堆都必须按降序排列吗？

编辑：我在 cplusplus.com 上找到了这个，我猜它回答了一个问题：

`The element with the highest value is always pointed by first. The order of the other elements depends on the particular implementation, but it is consistent throughout all heap-related functions of this header.`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T17:51:37.923

> ... push_heap 有两个参数，默认情况下它将最小值推送到位置 last-1。只有当第一个参数小于第二个参数时它才会这样做，否则它保持不变。

没有。如果您的存储是一个向量`v`，并且当前是一个堆（与创建的一样`make_heap`），您应该调用

```
v.push_back(new_item);
push_heap(v.begin(), v.end()); 
```

添加新项目。例如，请参见[此处](http://en.cppreference.com/w/cpp/algorithm/push_heap)或[此处](http://www.cplusplus.com/reference/algorithm/push_heap/)。

考虑一下，它`push_heap`确实采用了范围`[begin, end-1)`（已经满足堆不变量所必需的）和附加元素`end-1`（可能不是），并向上移动最后一个元素，直到为所有`[begin, end)`. 该算法在[这里](http://en.wikipedia.org/wiki/Binary_heap#Insert)解释。

* * *

> 在发现 push_heap 并没有真正保持我的向量排序后......

堆*未排序*。它们有一个排序约束（[堆属性](http://en.wikipedia.org/wiki/Heap_%28data_structure%29)），它比完全排序的*要弱。*

如果要执行二进制搜索，则需要一个完全排序的容器，并且`sort_heap`每次将堆转换为一个使用既慢又具有破坏性：调用此容器后，容器不再是堆，并且可以不要把它当作一个。

* * *

现在，关于您的编辑：堆*不必*按降序排列。最大堆按降序排列（最大的元素在前面），最小堆按升序排列（最小的元素在前面）。

标准库中的*默认设置*是构建一个最小堆，`operator<`用于比较。相反，要构建一个最大堆，您只需传递`std::greater<int>`（可选）最终参数或其他任何内容。*

# iphone - 解码 URL Query 时出现双反斜杠

> ID：15621211
> 
> 赞同：0
> 
> 时间：2013-03-25T17:36:46.810
> 
> 标签：iphone, ios, url-scheme

我正在尝试为我的 iphone 应用程序解码一个 url 查询。

这是我使用的代码

```
 - (NSDictionary *)parseQueryString:(NSString *)query {

    NSArray *pairs = [query componentsSeparatedByString:@"&"];
    NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithCapacity:[pairs count]];

    for (NSString *pair in pairs) {

        NSArray *elements = [pair componentsSeparatedByString:@"="];
        NSString *key = [elements objectAtIndex:0];
        NSString *val = [elements objectAtIndex:1];

        [dict setObject:val forKey:key];

    }
    return dict;
} 
```

这是我一直在输入的查询字符串。

```
station=124&serverip=demo\sqlexpress&username=test&password=noneofyourbusiness&serviceip=anumber&useimages=true&imagepath=pathforimages 
```

当我 NSLog 返回的字典时，服务器 ip 显示为

```
serverip = "demo\\sqlexpress"; 
```

突然它有两个反斜杠而不是一个。任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:41:32.057

你的弦可能没问题。记录字典打印不会按原样打印字符串。

打印字典会将其转换为旧[`NSPropertyListOpenStepFormat`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSPropertyListSerialization_Class/Reference/Reference.html#//apple_ref/doc/uid/20000942-SW1)格式。字符串使用反斜杠进行转义。

# c# - Application.Run - 更改使用按钮单击事件

> ID：15621212
> 
> 赞同：0
> 
> 时间：2013-03-25T17:36:46.810
> 
> 标签：c#, winforms, button

我有一点关于 Application.Run 方法的问题。当我单击 button1 时，可以更改 Application.Run（在默认 Program.cs 文件中）应该将 Application.Run 行更改为例如。

```
Application.Run(new Form1()); 
```

然后按钮2被点击

```
Application.Run(new Form2()); 
```

如果上述情况我们可以在程序仍在运行时进行更改吗？

感谢您的建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:38:16.883

`Application.Run()`运行你是程序的主要消息循环。
一旦启动，您将无法对其进行修改。

相反，您可以简单地`Show()`创建一个新表单实例，也可以`Hide()`是旧表单实例。

# java - 将二维数组读入arraylist

> ID：15621213
> 
> 赞同：-2
> 
> 时间：2013-03-25T17:36:49.690
> 
> 标签：java, arrays, arraylist

如何`ArrayList<Object> points`基于二维数组创建`datapoints`？

另一个问题：如果`datapoints`是二维ArrayList，如何将第一列`lat`和第二列读入`lon`？

```
public class Cluster {
    private ArrayList<VisitPoint> points;

    public Cluster(List[][] datapoints) {
        Float lat;
        Float lon;
        for (int i=0; i<datapoints.length; i++) {
            lat = datapoints[i][0];
            lon = datapoints[i][1];
            points.add(new VisitPoint(lat,lon));
        }
    }

    public ArrayList<VisitPoint> getVisitPoints() {
        return points;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:39:34.480

你可以使用`List`. `ArrayList`这是

```
List<List<VisitPoint>> list = new ArrayList<List<VisitPoint>>(); 
```

前迭代 -

```
for (List<VisitPoint> list2 : list) {
    for (VisitPoint visitPoint : list2) {
        ...
    }
} 
```

# c# - LINQ 子选择错误

> ID：15621214
> 
> 赞同：2
> 
> 时间：2013-03-25T17:37:00.860
> 
> 标签：c#, linq, select

我有这个结构的对象。

```
public class OrderItem
{
    public string idProduct { get; set; }
    public int quantity { get; set; }
    public List<WarehouseItem> WarehouseInfo = new List<WarehouseItem>();
}

public class WarehouseItem
{
    public string Name{ get; set; }
    public string LocnCode{ get; set; }
} 
```

我需要得到所有`LocnCode`并通过它们来区分，所以结果应该是`List<string>`。我正在尝试这样做

```
List<string> codes = itemList.Select(x => x.WarehouseInfo.Select(y => y.LocnCode)).Distinct(); 
```

但有这个错误：

`Cannot implicitly convert type 'System.Collections.Generic.IEnumerable<System.Collections.Generic.IEnumerable<string>>' to 'System.Collections.Generic.List<string>'.`

怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T17:41:18.157

您可以使用[`Enumerable.SelectMany`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.selectmany.aspx)扁平化层次结构：

```
List<string> distinctCodes = itemList
      .SelectMany(x => x.WarehouseInfo)
      .Select(y => y.LocnCode)
      .Distinct()
      .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:39:57.677

```
List<string> codes = itemList.SelectMany(x => x.WarehouseInfo)
                             .Select(y => y.LocnCode)
                             .Distinct()
                             .ToList(); 
```

甚至使用[`SelectMany`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.selectmany.aspx)

```
List<string> codes = itemList.SelectMany(x => x.WarehouseInfo
                                               .Select(y => y.LocnCode))
                             .Distinct()
                             .ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:45:13.987

其他版本：

```
var query = from order in items
            from warehouse in order.WarehouseInfo 
            select warehouse.LocnCode ;

List<string> codes = query.Distinct().ToList(); 
```

# c++ - 缩短大数字以提高可读性

> ID：15621215
> 
> 赞同：2
> 
> 时间：2013-03-25T17:37:05.207
> 
> 标签：c++, c++11, formatting, string-formatting

有没有通用/更好的方法来缩短更大的数字？
大于 1000 的数字应缩短至小数点后两位并附加一个“k”，例如 1543 应变为 1.54k，而 1504 应缩短为 1.5k，而 1007 应缩短为 1k。

对于大于 1000000 的数字也应该这样做，它们应该附加 M。
示例：5426849 应缩短为 5.42M（不介意 5.43M），5403258 应缩短为 5.4M，5001485 应缩短为 5M。

目前我有这个：

```
std::string letter(_sum > 1000000 ? "M" : _sum > 1000 ? "k" : "");
float displayValue(_sum > 1000000 ? _sum/1000000 : _sum > 1000 ? _sum/1000 : _sum);
printf("%.2g%s", displayValue, letter); 
```

# java - XMLWorkerHelper 性能缓慢

> ID：15621218
> 
> 赞同：2
> 
> 时间：2013-03-25T17:37:13.643
> 
> 标签：java, html, pdf, tags, itext

我在java中使用itext 5.3来生成PDF。我`HTMLWorker.parseToList(Reader, StyleSheet)`用来将部分转换为包含 HTML 标签（如粗体、斜体、href 等）的字符串到 PDF。我不想生成完整的 HTML 到 PDF，而是 PDF 中的部分文本将是 HTML。例如，像“这是测试粗体文本”这样的字符串将部分文本转换为粗体。

性能很好`HTMLWorker`。

自从它现在被弃用以来，我开始使用`XMLWorkerHelper.parseXHtml(ElementHandler, Reader)`，我发现与`HTMLWorker`.

如果有人对解决方案或任何其他解决方法有任何想法，请告诉我。

下面是示例代码，其他带有示例代码的帖子位于
[HTML to List using XMLWorker](https://stackoverflow.com/questions/15354005/html-to-list-using-xmlworker)

```
public class HTMLElementHandler implements ElementHandler {

    private Phrase phrase;
    private Font font;

    private HTMLElementHandler(Phrase phrase, Font font) {
        super();
        setPhrase(phrase);
        setFont(font);
    }

    @Override
    public void add(Writable writable) {
        if (writable instanceof WritableElement) {
            List<Element> elements = ((WritableElement) writable).elements();
            for (Element elem : elements) {
                List<Chunk> chunks = elem.getChunks();
                for (Chunk chunk : chunks) {
                    Font chunkFont = chunk.getFont();
                    //Do something with fonts here
                }
                phrase.setFont(font);
                phrase.add(elem);
            }
        }
    }

    public Phrase getPhrase() {
        return this.phrase;
    }
    public void setPhrase(Phrase phrase) {
        this.phrase = phrase;
    }   
    public Font getFont() {
        return this.font;
    }    
    public void setFont(Font font) {
        this.font = font;
    }
} 
```

另一个Javafile.java

```
Phrase ph = new Phrase();
Font font = FontFactory.getFont(FontFactory.getFont("Arial").getFamilyname(), 12, new BaseColor(0, 102, 153));
XMLWorkerHelper.getInstance().parseXHtml(new HTMLElementHandler(phrase, font), "This is test <bold> bold </bold> text"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-12-16T10:13:45.143

此问题的原因是在 (X)HTML 被有效解析之前作为操作的一部分完成的字体目录注册。这需要非常多的时间。

这可以通过提供一个不会查找任何字体的字体提供程序来回避，即不会注册任何字体目录。可以使用以下方式创建此字体提供程序：

```
new XMLWorkerFontProvider( XMLWorkerFontProvider.DONTLOOKFORFONTS ) 
```

您可以将此字体提供程序作为参数提供给`XMLWorkerHelper.getInstance( ).parseXHtml( ... )`，但是如果您将 an`ElementHandler`作为第一个参数，则不能。我不知道为什么，我只是偶尔使用 iText。

如果 (X)HTML 在字符串中，我将举一个例子：

```
File tempPdfFile = File.createTempFile( "temp_pdf_", ".pdf" );
tempPdfFile.deleteOnExit( );

try( OutputStream os = new FileOutputStream( tempPdfFile ) )
{
    Document pdfDocument = new Document( PageSize.A4 );
    PdfWriter pdfWriter = PdfWriter.getInstance( pdfDocument, os );
    pdfDocument.open( );

    String htmlText = getHtmlText( ); // your method that returns HTML as text

    XMLWorkerHelper.getInstance( ).parseXHtml ( 
        pdfWriter,
        pdfDocument,
        new ByteArrayInputStream( htmlText.getBytes( StandardCharsets.UTF_8 ) ),
        StandardCharsets.UTF_8,
        new XMLWorkerFontProvider( XMLWorkerFontProvider.DONTLOOKFORFONTS )
    );

    pdfDocument.close( );
    pdfWriter.close( );
}

Desktop.getDesktop( ).open( tempPdfFile ); 
```

# windows-phone-7 - “GART - Geo Augmented Reality Toolkit”是否适用于 windows phone 8？

> ID：15621220
> 
> 赞同：2
> 
> 时间：2013-03-25T17:37:16.970
> 
> 标签：windows-phone-7, geolocation, windows-phone-8, augmented-reality

我想使用 GART - Geo Augmented Reality Toolkit，但我不知道我是否可以在 windows phone 8 中使用它或者仅适用于 windows phone 7.5。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T19:18:46.257

将它用于 WP75/78 没有问题 - 不能直接作为 WP8 插件工作，但如前所述，WP7 应用程序在 8 下运行良好。

# c# - 从 WCF 服务查看 HTTP 标头

> ID：15621221
> 
> 赞同：2
> 
> 时间：2013-03-25T17:37:20.113
> 
> 标签：c#, xml, wcf, soap, http-headers

我第一次使用 WCF 时遵循以下示例。

[http://msdn.microsoft.com/en-us/library/bb386386.aspx](http://msdn.microsoft.com/en-us/library/bb386386.aspx)

我遵循例程，这些是我可以使用 Visual Studio 2010 附带的内置 WCF 测试客户端找到的 XML 代码。

`Request`:-

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Header>
    <Action s:mustUnderstand="1" xmlns="http://schemas.microsoft.com/ws/2005/05/addressing/none">http://tempuri.org/IService1/GetData</Action>
  </s:Header>
  <s:Body>
    <GetData xmlns="http://tempuri.org/">
      <value>re</value>
    </GetData>
  </s:Body> 
```

`Response`:-

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Header />
  <s:Body>
    <GetDataResponse xmlns="http://tempuri.org/">
      <GetDataResult>You entered: re</GetDataResult>
    </GetDataResponse>
  </s:Body>
</s:Envelope> 
```

我试图弄清楚在哪里以及如何查看 200 OK http 响应消息。它可能发生在背景的某个地方，我需要一些帮助来找出在哪里可以找到它。

我上网查了一下，google了一下，还是没找到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:50:15.263

这是类似的回答：[https ://stackoverflow.com/a/8318472/1384237](https://stackoverflow.com/a/8318472/1384237)

我更喜欢使用[SoapUI](http://www.soapui.org/)，可以快速查看请求和响应的原始内容，实现你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:58:54.210

我经常将[Fiddler](http://www.fiddler2.com/fiddler2/)与上述 WCF 测试客户端结合使用，以使用带有 WCF 的 BasicHttpBinding 检查 HTTP 流量。

# php - 将自定义参数传递给 Symfony2 中的自定义 ValidationConstraint

> ID：15621225
> 
> 赞同：22
> 
> 时间：2013-03-25T17:37:33.860
> 
> 标签：php, symfony, validation

我正在 Symfony2 中创建一个表单。该表单仅包含一个`book`字段，允许用户在`Books`实体列表之间进行选择。我需要检查所选内容是否`Book`属于`Author`我的控制器中的一个。

```
public class MyFormType extends AbstractType
{
    protected $author;

    public function __construct(Author $author) {
        $this->author = $author;
    }

    public function buildForm(FormBuilderInterface $builder, array $options) {
        $builder->add('book', 'entity', array('class' => 'AcmeDemoBundle:Book', 'field' => 'title');
    }

    // ...
} 
```

在提交表单后，我想检查所选`Book`内容是否由`$author`我的控制器中的 写入：

```
public class MyController
{
    public function doStuffAction() {
        $author = ...;
        $form = $this->createForm(new MyFormType($author));
        $form->bind($this->getRequest());

        // ...
    }
} 
```

不幸的是，我找不到任何方法来做到这一点。[我尝试按照The Cookbook](http://symfony.com/doc/master/cookbook/validation/custom_constraint.html)中的说明创建自定义验证器约束，但是虽然我可以通过`EntityManager`将验证器定义为服务来传递 as 参数，但我无法将`$author`控制器中的参数传递给验证器约束。

```
class HasValidAuthorConstraintValidator extends ConstraintValidator
{
    private $entityManager;

    public function __construct(EntityManager $entityManager) {
        $this->entityManager = $entityManager;
    }

    public function validate($value, Constraint $constraint) {
        $book = $this->entityManager->getRepository('book')->findOneById($value);
        $author = ...; // That's the data I'm missing

        if(!$book->belongsTo($author))
        {
            $this->context->addViolation(...);
        }
    }
} 
```

[该解决方案](https://stackoverflow.com/questions/10514301/custom-validator-constraint-with-arguments-parameters-in-symfony-2)可能正是我正在寻找的解决方案，但我的表单未绑定到实体，也不应该是（我从`getData()`方法中获取数据）。

我的问题有解决方案吗？这一定是一个常见的情况，但我真的不知道如何解决它。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-26T16:12:00.027

在 Cerad 的帮助下，我终于弄明白了。要注入需要从`ConstraintValidator::validate()`方法访问的自定义参数，您需要将它们作为*选项*传递给`Constraint`.

```
public class HasValidAuthorConstraint extends Constraint
{
    protected $author;

    public function __construct($options)
    {
        if($options['author'] and $options['author'] instanceof Author)
        {
            $this->author = $options['author'];
        }
        else
        {
            throw new MissingOptionException("...");
        }
    }

    public function getAuthor()
    {
        return $this->author;
    }
} 
```

并且，在 ConstraintValidator 中：

```
class HasValidAuthorConstraintValidator extends ConstraintValidator
{
    private $entityManager;

    public function __construct(EntityManager $entityManager) {
        $this->entityManager = $entityManager;
    }

    public function validate($value, Constraint $constraint) {
        $book = $this->entityManager->getRepository('book')->findOneById($value);
        $author = $this->constraint->getAuthor();

        if(!$book->isAuthor($author))
        {
            $this->context->addViolation(...);
        }
    }
} 
```

最后但同样重要的是，您必须将参数传递给验证器：

```
public function buildForm(FormBuilderInterface $builder, array $options) {
    $builder->add('book', 'entity', array(
        'class' => 'AcmeDemoBundle:Book',
        'field' => 'title',
        'constraints' => array(
            new HasValidAuthorConstraint(array(
                'author' => $this->author
            ))
        )
    ));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T14:56:13.510

首先将 setAuthor 方法添加到您的约束，然后调整 validate 方法。诀窍是确定调用它的最佳位置。

目前尚不清楚您如何将验证器绑定到您的书。您是在使用validation.yml 还是在表单内做某事？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T19:05:00.357

好吧，我对表单/验证组件不是那么熟悉，但是您可以使用带有作者姓名/ID 的[隐藏字段](http://symfony.com/doc/current/reference/forms/types/hidden.html)并检查它是否相同：

```
class MyFormType extends AbstractType
{
    protected $author;

    public function __construct(Author $author) {
        $this->author = $author;
    }

    public function buildForm(FormBuilderInterface $builder, array $options) {
        $builder
            ->add('book', 'entity', array('class' => 'AcmeDemoBundle:Book', 'field' => 'title');
            ->add('author_name', 'hidden', array(
                'data' => $this->author->getId(),
            ))
        ;
    }

    // ...
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-04-11T17:53:15.090

**接受的答案对我使用 Symfony Framework version 2.1**不起作用。这就是我解决它的方法。

```
class CustomConstraint extends Constraint
{
    public $dependency;
    public $message = 'The error message.';
}

class CustomConstraintValidator extends ConstraintValidator
{
    public function validate($value, Constraint $constraint)
    {
        if (!$constraint->dependency->allows($value)) {
            $this->context->addViolation($constraint->message);
        }
    }
}

class CustomFormType extends AbstractType
{
    private $dependency;

    public function __construct(Dependency $dependency)
    {
        $this->dependency = $dependency;
    }

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('field', 'type', array(
                'constraints' => array(
                    new CustomConstraint(array('dependency' => $this->dependency))
                )
        ));
    }
} 
```

# ruby - 打印“#{x}”并打印 x

> ID：15621227
> 
> 赞同：2
> 
> 时间：2013-03-25T17:37:38.373
> 
> 标签：ruby

在 ruby​​ 中，我习惯于以这种方式打印变量：

```
x = "anything"
print x 
```

但是我见过的许多教程都是这样做的：

```
x = "anything"
print "#{x}" 
```

那么有什么区别以及我们为什么要使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T17:43:28.223

这称为字符串插值。按照此[链接](http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Literals#Interpolation)了解更多信息。

基本上，当一起编写字符串模板和变量时，它是一种更方便的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T17:44:12.380

`#{X}`语法使用[字符串插值](http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Literals#Interpolation)，这意味着它将评估`#{}`. 如果您希望您的字符串包含变量和固定部分，这将非常有用，如下所示：

```
result = "19"
p "The result is #{result}" 
```

请注意，这只适用于双引号，而不是单引号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:01:24.210

下面的代码希望能让您快速了解`print "#{}"`.

```
print class X;def show;p "hi";end;end;X.new.show
"hi"
#=> "hi"
print "#{class X;def show;p "hi";end;end;X.new.show}"
#"hi"
#hi=> nil 
```

# c# - linq 在数组中包含 (int) 项

> ID：15621229
> 
> 赞同：2
> 
> 时间：2013-03-25T17:37:41.487
> 
> 标签：c#, linq, contains

我正在尝试编写一些 linq 来搜索存储项目中的值与列表中的任何值匹配的项目 - 如果它是字符串列表并搜索字符串，我可以轻松地做到这一点，但是当它是一个列表时枚举（整数）我无法弄清楚。

```
List<MyEnum> categories = new List<MyEnum>();

categories.Add(MyEnum.Fred);
categories.Add(MyEnum.Bill);
categories.Add(MyEnum.Jim);

// MyTable.Category is of type MyEnum
return (from o in Table<MyTable>()
        where categories.Any(val => o.Category.Contains(val))
        select o).Count(); 
```

编辑了更多信息 -

代码是：

```
public int LocalOffersCount(double distance, List<LocalCategory> categories)
{
    try
    {
        return (from o in Table<LocalOffer>() where categories.Any(val => o.Category.Contains(val)) select o).Count();
    }
    catch (Exception ex)
    {
        Log.Error("DatabaseService->LocalOffersCount: " + ex.Message);
        return 0;
    }
} 
```

MyTable 包含各种项目，“类别”项目是一个 LocalCategory 枚举，从 1 到 10。

我得到的编译错误是 -

无法从用法中推断方法“System.Linq.Enumerable.Contains(this System.Collections.Generic.IEnumerable, TSource)”的类型参数。尝试明确指定类型参数 (CS0411)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:18:48.553

我的猜测是那`LocalOffer.Category`是一个单一的`Category`（基于名称）。试试这个：

```
return 
    (from o in Table<LocalOffer>() 
     where categories.Contains(o.CategoryId) 
     select o)
    .Count(); 
```

但是，如果`LocalOffer.Category`是`IEnumerable<Category>`，这可能是您需要的：

```
return 
    (from o in Table<LocalOffer>() 
     where o.Any(c => categories.Contains(c.CategoryId))
     select o)
    .Count(); 
```

# rest - 肥皂客户端的休息网络服务，这可能吗？

> ID：15621231
> 
> 赞同：2
> 
> 时间：2013-03-25T17:37:49.847
> 
> 标签：rest

平台 - Java、Ubuntu（首选 apache）

我有一种情况，我想为soap客户端实现rest web服务。Baiscally，此服务将模拟真实服务的行为。那可能吗？

如果是，另一个问题是，Axis2 是否足以支持其余的 Web 服务，如果不是最简单的替代方案。

我的模拟器非常简单，它将根据请求的 xpath 解析以 xml 响应进行响应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T21:30:34.343

这是绝对可能的。SOAP 请求是使用 POST 方法发送的，因此您只需要构建 REST 资源并使用适当的 SOAP 响应 xml 来响应 POST 请求。我使用非常简单的 RESTeasy 构建了类似的东西。

[https://sourceforge.net/p/soaprest-mocker/](https://sourceforge.net/p/soaprest-mocker/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:53:50.290

几年前，我阅读了这篇[教程](http://wso2.org/library/3726)，并基于这种架构（Axis2+WSDL+RESTful）实现了一些服务。它工作正常。但我不会认为它是所有事物的最佳架构（“一刀切”），但它很容易部署、测试和使用。

试试看，给我们你的意见！

# javascript - 我如何在 Javascript 中操作这个数组来进行这种错误检查？

> ID：15621232
> 
> 赞同：0
> 
> 时间：2013-03-25T17:37:50.883
> 
> 标签：javascript, javascript-framework

如何让 Javascript 检查数组并确保在逗号分隔数组的每个元素之后没有发生错误。例如，用户可以形成一个数组，其中一行中有两个逗号分隔一个元素而不是一个逗号。不只是逗号，任何其他错误输入。

```
var cars=["Saab",,"Volvo","BMW"]; // Here , this array has an error , there's a double comma .
var cars=["Saab",*"Volvo","BMW"]; // this array has an error , there's an asterix.
var cars=["Saab","Volvo","BMW"];  // this array is the right one. 
```

这是错误的数组

我可以使用什么 Javascript 函数或解决方案来确保检查数组并且其中没有错误。只有元素和分隔逗号之间没有空格。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:11:15.983

鉴于您正在尝试验证用户输入的数据，我建议重新评估您的方法。

您不应要求最终用户以有效的 JavaScript 语法输入数据；这对您的用户来说很烦人。

相反，我只需要一个文本区域和说明。

![小样](../Images/06e2f046d65f9db1969bab380860287d.png)

这对人类来说更容易处理，并且解析非常简单：

```
var cars = document.getElementById('carstextarea').value.split('\n');
// => ["Saab","Volvo","BMW"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:39:12.320

使用静态代码分析器，例如[JSLint](http://www.jslint.com/)或[JSHint](http://www.jshint.com/)。

除了 Web 托管的风格之外，后者还可以[作为 JavaScript 库使用。](http://www.jshint.com/docs/#jslib)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:45:57.547

您可以使用 jslint 获取 JavaScript 源并对其进行扫描，

visual studio、netbeans 或 eclipse 都有一个插件。

祝你好运！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T17:53:05.403

您的第二个`cars`示例`*`将无法编译。

要检查双逗号，您可以遍历数组并检查未定义的值。

```
for(var i = 0; i<cars.length; i++) {
if(cars[i] === undefined) {
// do something
}
} 
```

或者，您可以在生成数组之前尝试捕获它。有没有办法检查用户输入的空行？

# python - 单例模式中参数的 dict 同义词。分配给保留的内置符号警告

> ID：15621235
> 
> 赞同：0
> 
> 时间：2013-03-25T17:38:08.660
> 
> 标签：python, design-patterns, singleton

在 Python 中，实现单例模式的一种方法是使用元类。

```
class Singleton(type):
    def __init__(cls, name, bases, dict):
        super(Singleton, cls).__init__(name, bases, dict)
        cls.INSTANCE = None

    def __call__(cls, *args, **kwargs):
        if cls.INSTANCE is None:
            cls.INSTANCE = super(Singleton, cls).__call__(*args, **kwargs)
        return cls.INSTANCE 
```

但是在带有 PyDev dict 参数的 Eclipse 中会引发警告：`Assignment to reserved built-in symbol: dict`.

PEP 8 还说：

> 如果函数参数的名称与保留关键字发生冲突，通常最好在结尾附加一个下划线，而不是使用缩写或拼写错误。因此 class_ 比 cls 好。（也许更好的是通过使用同义词来避免这种冲突。）

我在网上发现分配给参数而不是dict的不同名称，例如dictionary、classdict和attrs。

以及使用 *args 和 **kwargs 的方法：

```
class Singleton(type):
    def __init__(cls, *args, **kwargs):
        super(Singleton, cls).__init__(*args, **kwargs)
        cls.INSTANCE = None

    def __call__(cls, *args, **kwargs):
        if cls.INSTANCE is None:
            cls.INSTANCE = super(Singleton, cls).__call__(*args, **kwargs)
        return cls.INSTANCE 
```

我认为最后一个片段是最好的，因为如果类型 init 方法更改了他的签名，它是安全的。

**问题：**

1.  您为参数分配什么名称而不是 dict？

2.  您如何看待最后一个片段？

3.  你认为最好的选择是什么？更改参数名称或使用 *args 和 **kwargs？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:41:14.117

1.  `dict`是一个内置类型，你可以使用`namespace`or`attributes`或者其他什么来代替。在这里并不重要，它只是一个局部变量名。

    不需要将其命名为任何特定的名称，因为它是一个位置参数。数据[模型文档](http://docs.python.org/3/reference/datamodel.html#creating-the-class-object)使用`namespace`.

2.  在那里使用`*args`and`**kwargs`非常好。事实上，`__init__()`元类的 可以传递额外的关键字参数，因此将这些参数传递给超级`__init__`方法是一种很好的做法。

3.  当我不关心参数时，我会使用`*args`和。`**kwargs`这样，您就可以在未来证明该方法。

请注意，在 Python 3 中，您不再需要提供`super()`任何参数：

```
class Singleton(type):
    def __init__(cls, *args, **kwargs):
        super().__init__(*args, **kwargs)
        cls.INSTANCE = None

    def __call__(cls, *args, **kwargs):
        if cls.INSTANCE is None:
            cls.INSTANCE = super().__call__(*args, **kwargs)
        return cls.INSTANCE 
```

# ios - 如何使用 CBCharacteristicPropertyIndi cate 获得特征？

> ID：15621245
> 
> 赞同：3
> 
> 时间：2013-03-25T17:38:37.607
> 
> 标签：ios, objective-c, core-bluetooth, bluetooth-lowenergy

在 CoreBluetooth 应用程序中，我想从通知切换到指示，以便我可以确定在另一端接收到数据。

在 Apple 的示例代码[BTLE Central Peripheral Transfer](http://developer.apple.com/library/ios/#samplecode/BTLE_Transfer/Introduction/Intro.html)中，我尝试`CBCharacteristicPropertyNotify`用`CBCharacteristicPropertyIndicate`. 那没有用。外围设备记录：

```
2013-03-24 18:50:34.412 BTLE Transfer[15346:907] self.peripheralManager powered on.
2013-03-24 18:50:38.436 BTLE Transfer[15346:907] Central subscribed to characteristic
2013-03-24 18:50:38.440 BTLE Transfer[15346:907] Sent: Here is a bunch of s
2013-03-24 18:50:38.442 BTLE Transfer[15346:907] Sent: ample text. Hold ano
2013-03-24 18:50:38.444 BTLE Transfer[15346:907] Sent: ther device close to
2013-03-24 18:50:38.446 BTLE Transfer[15346:907] Sent:  see the transfer ha
2013-03-24 18:50:38.448 BTLE Transfer[15346:907] Sent: ppen.
2013-03-24 18:50:38.450 BTLE Transfer[15346:907] Sent: EOM 
```

中央记录：

```
2013-03-24 18:50:19.209 BTLE Transfer[7331:c07] Scanning started
2013-03-24 18:50:37.998 BTLE Transfer[7331:c07] Discovered iPhone at -34
2013-03-24 18:50:37.999 BTLE Transfer[7331:c07] Connecting to peripheral <CBConcretePeripheral: 0x7591840 UUID = <CFUUID 0x7590780> 6A73BF68-01C9-B751-31D5-916297EC1932, Name = "iPhone", IsConnected = NO>
2013-03-24 18:50:38.001 BTLE Transfer[7331:c07] Discovered iPhone at -34
2013-03-24 18:50:38.030 BTLE Transfer[7331:c07] Peripheral Connected
2013-03-24 18:50:38.032 BTLE Transfer[7331:c07] Scanning stopped
2013-03-24 18:50:39.069 BTLE Transfer[7331:c07] Notification began on <CBConcreteCharacteristic: 0x75868a0>
2013-03-24 18:50:39.071 BTLE Transfer[7331:c07] Received: Here is a bunch of s 
```

因此，中央似乎只收到了第一条消息，然后仅此而已。你们中有人知道我做错了什么，以及如何获得指示工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T15:14:53.157

嗯，也许您需要承认您已阅读它才能收到更多信息？一次只能进行 1 次传输。

# php - Arduino 客户端 + PHP cURL 服务器执行命令两次

> ID：15621246
> 
> 赞同：2
> 
> 时间：2013-03-25T17:38:37.710
> 
> 标签：php, curl, arduino, curl-multi

我有这个项目正在做的工作，我从单个 PHP 服务器命令几个 Arduino（Arduino 核心 + ENC28J60 以太网 + x4 继电器执行器）模块来激活任何 Arduino 模块上的继电器。服务器有一个所有事件的列表，并在每个事件合适的时候执行它们。问题在于，只要命令相隔超过 4 分钟（即 >=5 分钟），Arduino 就会执行两次命令。也就是说，Arduino 激活了我连续两次命令的继电器。

代码的作用是： 1\. thor.php 线性执行一次（任务由 crontab 重复） 2\. thor.php 在其数组中搜索当前时间发生的事件 3\. 对于每次出现它都会生成一个任务，该任务被传递给 curl 多处理程序 4。所有任务都并行发送到每个 arduino 模块。5\. Arduino收到请求时，检查是否来自已知IP地址和允许的端口，分析参数中的命令，并根据请求激活继电器。6\. Arduino 然后发送一个带有隐藏字段的响应页面，该隐藏字段将在未来用于控制。

理论上一切正常，但**只要命令相隔 5 分钟或更长时间，Arduino 就会执行两次命令。**

我把整个代码放在后面。这是Arduino：（请原谅西班牙语的评论）

```
 #include "etherShield.h"

    //MAC ADDRESS.
    static uint8_t mymac[6] = {
      0x54,0x55,0x58,0x10,0x00,0x24}; 
    //IP ADDRESS THOR.
    static uint8_t myip[4] = {
      172,0,0,101};
    //Unica IP de Origen aceptada.
    static uint8_t ip_origen[4] = {
      172,0,0,10};
    //TCP PORT
    static uint16_t myport = 5566;
    //Setear los pines de los relays. Solo se setea el primero. Se necesitan 4 pines consecutivos libres
    static int primerrelay = 2;

    //Variables globales usadas para el feedbak del modulo en una peticion tcp.
    int16_t comando_rel, comando_tmp;
    //Estado de los relays
    uint8_t estado;

    //Definiciones propias de Arduino. Especifica el tamaño maximo del buffer y lo inicializa.
    #define BUFFER_SIZE 500
    static uint8_t buf[BUFFER_SIZE+1];

    EtherShield es=EtherShield();

    void setup(){

      /*initialize enc28j60*/
      es.ES_enc28j60Init(mymac);
      es.ES_enc28j60clkout(2); // change clkout from 6.25MHz to 12.5MHz
      delay(10);

      /* Magjack leds configuration, see enc28j60 datasheet, page 11 */
      // LEDA=greed LEDB=yellow
      //
      // 0x880 is PHLCON LEDB=on, LEDA=on
      // enc28j60PhyWrite(PHLCON,0b0000 1000 1000 00 00);
      es.ES_enc28j60PhyWrite(PHLCON,0x880);
      delay(500);
      //
      // 0x990 is PHLCON LEDB=off, LEDA=off
      // enc28j60PhyWrite(PHLCON,0b0000 1001 1001 00 00);
      es.ES_enc28j60PhyWrite(PHLCON,0x990);
      delay(500);
      //
      // 0x880 is PHLCON LEDB=on, LEDA=on
      // enc28j60PhyWrite(PHLCON,0b0000 1000 1000 00 00);
      es.ES_enc28j60PhyWrite(PHLCON,0x880);
      delay(500);
      //
      // 0x990 is PHLCON LEDB=off, LEDA=off
      // enc28j60PhyWrite(PHLCON,0b0000 1001 1001 00 00);
      es.ES_enc28j60PhyWrite(PHLCON,0x990);
      delay(500);
      //
      // 0x476 is PHLCON LEDA=links status, LEDB=receive/transmit
      // enc28j60PhyWrite(PHLCON,0b0000 0100 0111 01 10);
      es.ES_enc28j60PhyWrite(PHLCON,0x476);
      delay(100);

      //init the ethernet/ip layer:
      es.ES_init_ip_arp_udp_tcp(mymac,myip,myport);

      //################################
      //Setup de los pines de salida
      for(int i = 0; i < 4; i++)
      {
        pinMode(i + 2, OUTPUT);
      }

      //Lamp-test
      digitalWrite(primerrelay, HIGH);
      delay(100);
      digitalWrite(primerrelay, LOW);
      comando_rel = -1;
      comando_tmp = -1;
    }

    void loop(){
      uint16_t plen, dat_p;

      plen = es.ES_enc28j60PacketReceive(BUFFER_SIZE, buf);

      /*plen will be unequal to zero if there is a valid packet (without crc error) */
      if(plen!=0){

        // arp is broadcast if unknown but a host may also verify the mac address by sending it to a unicast address.
        if(es.ES_eth_type_is_arp_and_my_ip(buf,plen)){
          es.ES_make_arp_answer_from_request(buf);//*******
          return;
        }

        // check if ip packets are for us:
        if(es.ES_eth_type_is_ip_and_my_ip(buf,plen)==0){
          return;
        }

        if(buf[IP_PROTO_P]==IP_PROTO_ICMP_V && buf[ICMP_TYPE_P]==ICMP_TYPE_ECHOREQUEST_V){
          es.ES_make_echo_reply_from_request(buf,plen);
          return;
        }

        // tcp port www start, compare only the lower byte
        // En la siguiente linea esta la clave para poder implementar puertos mayores a 254
        if (buf[IP_PROTO_P]==IP_PROTO_TCP_V&&buf[TCP_DST_PORT_H_P]==highByte(myport)&&buf[TCP_DST_PORT_L_P]==lowByte(myport)){
          if (buf[TCP_FLAGS_P] & TCP_FLAGS_SYN_V){
            es.ES_make_tcp_synack_from_syn(buf); // make_tcp_synack_from_syn does already send the syn,ack
            return;     
          }
          if (buf[TCP_FLAGS_P] & TCP_FLAGS_ACK_V){
            es.ES_init_len_info(buf); // init some data structures
            dat_p=es.ES_get_tcp_data_pointer();
            if (dat_p==0){ // we can possibly have no data, just ack:
              if (buf[TCP_FLAGS_P] & TCP_FLAGS_FIN_V){
                es.ES_make_tcp_ack_from_any(buf);
                //es.ES_make_tcp_ack_from_any(buf, plen, 1);//************
              }
              return;
            }
            //Comparacion de la ip de origen.
            uint8_t match_ip_origen = 1;

            for (int i=0; i<4; i++)
            {
              if(buf[IP_SRC_P + i] != ip_origen[i])
              {
                match_ip_origen = 0;
                break;
              }
            }/**/

            if (match_ip_origen==1)
            {
              if (strncmp("GET ",(char *)&(buf[dat_p]),4)!=0){
                // head, post and other methods for possible status codes see:
                // http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html
                plen=es.ES_fill_tcp_data_p(buf,0,PSTR("HTTP/1.0 200 OK\r\nContent-Type: text/html\r\n\r\n<h1>200 OK</h1>"));
                goto SENDTCP;
              }
              if (strncmp("/ ",(char *)&(buf[dat_p+4]),2)==0){
                plen=print_webpage(buf);
                goto SENDTCP;
              }

              //Calculo el estado de los pines
              estado = 0; //Se setea en cero antes de hacer la comprobacion
              estado += digitalRead(primerrelay) * 1 + digitalRead(primerrelay + 1) * 2 + digitalRead(primerrelay + 2) * 4 + digitalRead(primerrelay + 3) * 8;

              //#######################################################################
              //Analisis de los parametros y ejecucion de las acciones correspondientes

              if (strncmp("/?cmd=",(char *)&(buf[dat_p+4]),6)==0)
              {
                //cargar los comandos a las variables globales
                analyse_cmd((char *)&(buf[dat_p+10]));
                //Analizar el tiempo. Si es mayor que 0 y menor que 10 (1-9)
                //guardar el estado actual, ejecutar el comando solicitado, y volver al estado anterior.
                //Si el tiempo es positivo menor que 10, setear el estado temporalmente
                if(comando_tmp > 0 && comando_tmp < 10)
                {
                  //Si el valor es aceptable (0-15), se ejecuta el comando
                  if(comando_rel > -1 && comando_rel < 16)
                  {
                    //Generar un estado derivado aplicando un OR a nivel de bits con el estado actual
                    uint8_t r = comando_rel | estado;
                    //Ejecutar el nuevo estado obtenido
                    ejecutar_comando(r);
                    //Esperar el tiempo especificado
                    delay(comando_tmp * 1000);
                    //Volver al estado anterior.
                    ejecutar_comando(estado);
                  }
                }
                //Si el tiempo es igual a cero, setear el nuevo estado indefinidamente
                else if(comando_tmp == 0)
                {
                  //Si el valor es aceptable (0-15), se ejecuta el comando
                  if(comando_rel > -1 && comando_rel < 16)
                  {
                    //Ejecutar el comando y no revertirlo
                    ejecutar_comando(comando_rel);
                  }
                }
              }

              plen=print_webpage(buf);
    SENDTCP:  
              es.ES_make_tcp_ack_from_any(buf); // send ack for http get//***************
              es.ES_make_tcp_ack_with_data(buf,plen); // send data      
            }
          }
        }
      }
    }

    void ejecutar_comando(uint8_t comando)
    {
      //Realiza un and logico con el parametro a nivel de bits. 
      //Enciende o apaga el relay correspondiente.
      //Si el and logico resulta en 0, escribe LOW.
      //Si es diferente a 0, escribe HIGH.
      digitalWrite(primerrelay, (comando & 1));
      digitalWrite(primerrelay + 1, (comando & 2)); 
      digitalWrite(primerrelay + 2, (comando & 4)); 
      digitalWrite(primerrelay + 3, (comando & 8));
    }

    void analyse_cmd(char *x)
    {
      //por por default si no hubieran llegado comandos o estan mal 
      comando_rel = -1;
      comando_tmp = -1;
      //verificar que esten todos los caracteres requeridos
      uint8_t i = 0;
      while(x[i]!=' ' && x[i]!='\0' && i < 10){
        i++;
      }
      //si tiene 4 son los caracteres necesarios: 2 para los reles y 2 para el timer
      if(i==4){
        String aux = "";
        //verificar por el nro de los reles
        if(is_integer(x[0]) && is_integer(x[1])){
          aux = String(x[0]) + String(x[1]);
          comando_rel = aux.toInt();
        }
        aux = "";
        //verificar por el nro de segundos del timer
        if(is_integer(x[2]) && is_integer(x[3])){
          aux = String(x[2]) + String(x[3]);
          comando_tmp = aux.toInt();
        }          
      }
    }

    uint8_t is_integer(char c){
      uint8_t r = 0;
      if (c < 0x3a && c > 0x2f){
        r = 1;
      }  
      return r;
    }

    uint16_t print_webpage(uint8_t *buf)
    {
      uint16_t plen, dat_p;
      dat_p=es.ES_get_tcp_data_pointer();

      plen=es.ES_fill_tcp_data_p(buf,0,PSTR("HTTP/1.0 200 OK\r\nContent-Type: text/html\r\n\r\n"));

      plen=es.ES_fill_tcp_data_p(buf,plen,PSTR("<center><p><h1>Modulo Thor V1.0  </h1></p></br></hr> "));

      String x = String(buf[IP_DST_P]) + "." + String(buf[IP_DST_P+1]) + "." + String(buf[IP_DST_P+2]) + "." + String(buf[IP_DST_P+3]) + " llamado desde ";
      char *s = getCharArray(x);
      plen=es.ES_fill_tcp_data(buf,plen,s);

      x = String(buf[IP_SRC_P]) + "." + String(buf[IP_SRC_P+1]) + "." + String(buf[IP_SRC_P+2]) + "." + String(buf[IP_SRC_P+3]) + "</br></center>";
      s = getCharArray(x);
      plen=es.ES_fill_tcp_data(buf,plen,s);

      //Al haberse ejecutado un comando el estado resultante debe ser actualizado.
      //Calculo del estado de los pines
      estado = 0; //Se setea en cero antes de hacer la comprobacion
      estado += digitalRead(primerrelay) * 1 + digitalRead(primerrelay + 1) * 2 + digitalRead(primerrelay + 2) * 4 + digitalRead(primerrelay + 3) * 8;

      x = "REL: " + String(comando_rel) + "</br>TMP: " + String(comando_tmp) + "</br>STA: " + String(estado) + "</br></br>"
+ "<input type=\"hidden\" name=\"status\" value=\"" + (String)estado + "\">";
      s = getCharArray(x);
      plen=es.ES_fill_tcp_data(buf,plen,s);

      return(plen);
    }

    char* getCharArray(String s)
    {
      char charBuf[s.length() + 1];
      s.toCharArray(charBuf,s.length() + 1);
      return charBuf;
    }

    void reset()
    {
      for (int i = primerrelay; i < primerrelay + 4; i++)
      {
        digitalWrite(i, LOW);
      }
    } 
```

雷神.php：

```
 <?php
    //Requiere tener instalado php5-curl
    require 'thorconfig.php';
    require 'common.php';
    $tareas = array();
    //Recorrer las configuraciones y armar la lista de tareas
            foreach($modulos as $modulo) //Recorrer cada módulo
            {
        foreach($modulo["eventos"] as $evento) //Recorrer cada evento de un módulo
        {
            //Si el día y la hora del evento coinciden con el día y la hora actuales
            if(strcmp(date("w"), $evento["dia"]) == 0 && strcmp(date("H:i"), $evento["hora"]) == 0)
            {
                //Añadir una tarea con el formato "http://direccion_ip:puerto/?cmd=reltmp"
                $tareas[] = "http://".$modulo["ip"].":".$modulo["puerto"]."/?cmd=".$evento["rel"].$evento["tmp"];
            }
        }
    }
    $curl = array();
    //Inicializar el handler de tareas
    $curlHandle = curl_multi_init();
    //Recorrer las tareas y añadirlas al handler
    foreach($tareas as $tarea)
        $curl[] = addHandle($curlHandle, $tarea);
    //Ejecutar el handler
    ExecHandle($curlHandle);
    echo "\n";
    //Recuperar la respuesta de cada tarea ejecutada
    for($i = 0; $i < sizeof($tareas); $i++)
    {
        $respuesta = curl_multi_getcontent($curl[$i])."\n";
        if(!strpos($respuesta, "<input type=\"hidden\" name=\"status\""))
        {
            $message = "Ha ocurrido un error al intentar ejecutar el siguiente comando: ".$tareas[$i];
            sendMail($server["from"], $server["from"], $server["to"], $server["to"], "Error en Thor", $message, $server);
        }
        else
        {
            echo $respuesta;
        }
    }
    //Remover cada tarea del handler
    foreach($curl as $handle)
        curl_multi_remove_handle($curlHandle, $handle);
    //Cerrar el handler
    curl_multi_close($curlHandle);
    ?> 
```

thorconfig.php

```
 <?php
        $modulos = [
            "modulo 0" => [
                "ip" => "172.24.51.101", //Teológico
                "puerto" => 6174,
                "eventos" => [
                    ////////////////////// Lunes //////////////////////
                    "evento 0" => [
                        "dia" => 1,
                        "hora" => "07:30",
                        "rel" => "01",
                        "tmp" => "03"
                    ],
                    "evento 1" => [
                        "dia" => 1,
                        "hora" => "08:25",
                        "rel" => "01",
                        "tmp" => "03"
                    ]
    .
    .
    .

           ]
    ]

        $server = [
            "host" => "172.16.0.40",
            "puerto" => 25,
            "smtpuser" => "user",
            "smtppass" => "pass",
            "to" => "mail@uap.edu.ar",
            "from" => "mail@uap.edu.ar"
        ];
    ?> 
```

常见的.php：

```
 <?php
    //Función que ejecuta el handler
    function ExecHandle(&$curlHandle)
    {
            $flag=null;
            do {
            //fetch pages in parallel
                    curl_multi_exec($curlHandle,$flag);
            } while ($flag > 0);
    }

    //Función que añade un recurso al handler
    function addHandle(&$curlHandle,$url)
    {
            $cURL = curl_init();
            curl_setopt($cURL, CURLOPT_URL, $url);
            curl_setopt($cURL, CURLOPT_HEADER, 0);
            curl_setopt($cURL, CURLOPT_RETURNTRANSFER, 1);
            curl_multi_add_handle($curlHandle,$cURL);
            return $cURL;
    }

    function sendMail($from, $namefrom, $to, $nameto, $subject, $message, $server)
    {
            $smtpServer = $server["host"];   //ip address of the mail server.  This can also be the local domain name
            $port = $server["puerto"];                    // should be 25 by default, but needs to be whichever port the mail server will be using for smtp
            $timeout = "45";                 // typical timeout. try 45 for slow servers
            $username = $server["smtpuser"]; // the login for your smtp
            $password = $server["smtppass"];           // the password for your smtp
            $localhost = "127.0.0.1";      // Defined for the web server.  Since this is where we are gathering the details for the email
            $newLine = "\r\n";           // aka, carrage return line feed. var just for newlines in MS
            $secure = 0;                  // change to 1 if your server is running under SSL

            //connect to the host and port
            $smtpConnect = fsockopen($smtpServer, $port, $errno, $errstr, $timeout);
            $smtpResponse = fgets($smtpConnect, 4096);
            if(empty($smtpConnect)) {
                     $output = "Failed to connect: $smtpResponse";
                     echo $output;
                     return $output;
            }
            else {
                     $logArray['connection'] = "<p>Connected to: $smtpResponse";
                     echo "<p />connection accepted<br>".$smtpResponse."<p />Continuing<p />\n";
            }

            //you have to say HELO again after TLS is started
            fputs($smtpConnect, "HELO $localhost". $newLine);
            $smtpResponse = fgets($smtpConnect, 4096);
            $logArray['heloresponse2'] = "$smtpResponse";
            //request for auth login
            fputs($smtpConnect,"AUTH LOGIN" . $newLine);
            $smtpResponse = fgets($smtpConnect, 4096);
            $logArray['authrequest'] = "$smtpResponse";

            //send the username
            fputs($smtpConnect, base64_encode($username) . $newLine);
            $smtpResponse = fgets($smtpConnect, 4096);
            $logArray['authusername'] = "$smtpResponse";

            //send the password
            fputs($smtpConnect, base64_encode($password) . $newLine);
            $smtpResponse = fgets($smtpConnect, 4096);
            $logArray['authpassword'] = "$smtpResponse";

            //email from
            fputs($smtpConnect, "MAIL FROM: <$from>" . $newLine);
            $smtpResponse = fgets($smtpConnect, 4096);
            $logArray['mailfromresponse'] = "$smtpResponse";

            //email to
            fputs($smtpConnect, "RCPT TO: <$to>" . $newLine);
            $smtpResponse = fgets($smtpConnect, 4096);
            $logArray['mailtoresponse'] = "$smtpResponse";

            //the email
            fputs($smtpConnect, "DATA" . $newLine);
            $smtpResponse = fgets($smtpConnect, 4096);
            $logArray['data1response'] = "$smtpResponse";

            //construct headers
            $headers = "MIME-Version: 1.0" . $newLine;
            $headers .= "Content-type: text/html; charset=iso-8859-1" . $newLine;
            $headers .= "To: $nameto <$to>" . $newLine;
            $headers .= "From: $namefrom <$from>" . $newLine;

            //observe the . after the newline, it signals the end of message
            fputs($smtpConnect, "To: $to\r\nFrom: $from\r\nSubject: $subject\r\n$headers\r\n\r\n$message\r\n.\r\n");
            $smtpResponse = fgets($smtpConnect, 4096);
            $logArray['data2response'] = "$smtpResponse";

            // say goodbye
            fputs($smtpConnect,"QUIT" . $newLine);
            $smtpResponse = fgets($smtpConnect, 4096);
            $logArray['quitresponse'] = "$smtpResponse";
            $logArray['quitcode'] = substr($smtpResponse,0,3);
            fclose($smtpConnect);
            //a return value of 221 in $retVal["quitcode"] is a success
            return($logArray);  
    }
    ?> 
```

当我在不到 4 分钟的时间内执行命令时它应该只执行一次，否则它会执行两次，有什么想法吗？

编辑：我放弃了 PHP 代码中的问题。我在服务器中安装了一个 lynx 文本浏览器，并在 5 分钟内手动执行命令，得到了相同的结果：来自 Arduino 的重复操作。我留下 PHP 代码以防万一有人对它感兴趣并可能使用它。我将继续尝试以找到解决方案。

编辑 2：我放弃了 Arduino 硬件中的问题。我用相同的代码测试了一个开箱即用的新 Arduino Uno（相同型号），它仍然有相同的错误。

编辑3：只是一个想法。PHP服务器是否有可能期望立即响应并且由于Arduino没有立即给出它然后再次发送数据包从而从Arduino获得双重（延迟）响应？这是另一个问题：Arduino 是否有可能两次通过缓冲区而没有意识到？（对我来说，第二种选择似乎不太可能）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T14:15:12.167

我通过添加补丁“修复”了这个问题（不是永久解决方案）。我仍然需要找到问题的根源。

`#include "etherShield.h"` 在行后添加了这个

```
#include <TimedAction.h>

//Para control de ejecuciones
int16_t ultimo_comando_ejecutado[5];
int16_t ultimo_tiempo_ejecutado[5];
//Number of seconds since last command execution or execution register.
int8_t segundos;
TimedAction ta = TimedAction(1000,revisar); 
```

这在`setup()`

```
resetear_registro();
segundos = 0; 
```

这在第一行`loop()`

```
ta.check(); 
```

这个关于命令执行

```
if(ejecutado(comando_rel, comando_tmp) == 0)
{
  ejecutar_comando(r);
  registrar_ejecucion(comando_rel, comando_tmp);
  //Esperar el tiempo especificado
  delay(comando_tmp * 1000);
  //Volver al estado anterior.
  ejecutar_comando(estado);
} 
```

和这个

```
if(ejecutado(comando_rel, comando_tmp) == 0)
{
  ejecutar_comando(comando_rel);
  registrar_ejecucion(comando_rel, comando_tmp);
} 
```

最后把这些函数放在最后

```
void registrar_ejecucion(int16_t cmd, int16_t tmp)
{
  for(int i = 0; i < 4; i++)
  {
    ultimo_comando_ejecutado[i] = ultimo_comando_ejecutado[i+1];
    ultimo_tiempo_ejecutado[i] = ultimo_tiempo_ejecutado[i+1];
  }
  ultimo_comando_ejecutado[4] = cmd;
  ultimo_tiempo_ejecutado[4] = tmp;
  segundos = 0;
}

uint8_t ejecutado(int16_t cmd, int16_t tmp)
{
  uint8_t ejec = 0;
  for(int i = 0; i < 5; i++)
  {
    if(ultimo_comando_ejecutado[i] == cmd && ultimo_tiempo_ejecutado[i] == tmp)
    {
      ejec = 1;
      break;
    }
  }
  return ejec;
}

void resetear_registro()
{
  for(int a = 0; a < 5; a++)
  {
    ultimo_comando_ejecutado[a] = -1;
    ultimo_tiempo_ejecutado[a] = -1;
  }
}

void revisar()
{
  segundos++;
  if(segundos > 59)
  {
    resetear_registro();
    segundos = 0;
  }
} 
```

基本上它所做的是检查最后一分钟内执行的最后 5 个命令（继电器和时间），如果匹配，则忽略该命令。在小范围内，它解决了这个问题。但我意识到这只是一个补丁，可能会出现问题。现在我将按原样实现代码（加上补丁）。但如果有人找到更好、更持久的解决方案，我愿意接受建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T13:09:14.970

在您的服务器上使用网络嗅探器（即wireshark）来查看真正发送的内容。这样您就可以轻松地测试您的想法 3。wireshark 还可以选择重放流量，从而使测试更容易。

# wifi - Wifi Direct 组所有者地址

> ID：15621247
> 
> 赞同：1
> 
> 时间：2013-03-25T17:38:43.070
> 
> 标签：wifi, android-wifi, wifi-direct, wifimanager

这是一个简单的问题，我必须使用“Wifi direct”获取“组所有者地址”，我知道这是在 WifiP2pInfo.GroupOwnerAddress 中，但是如何初始化 WifiP2pInfo.groupOnwerAddress 以在我的应用程序中获取组所有者地址？

有人可以给我通行证吗？我是android和java的新手。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-05T22:32:30.887

```
NetworkInfo networkInfo = (NetworkInfo)intent.getParcelableExtra(extraKey);

  if (networkInfo.isConnected()) {
    wifiP2pManager.requestConnectionInfo(wifiDirectChannel, 
      new ConnectionInfoListener() {
        public void onConnectionInfoAvailable(WifiP2pInfo info) { 

            Toast toast=Toast.makeText(class.this,info.groupOwnerAddress.getHostAddress().toString, Toast.LENGHT_SHORT); 
            toast.show();    

        }
      }
  } 
```

对不起，迟到的答案。这是所有者 IP`info.groupOwnerAddress.getHostAddress().toString`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-03T05:34:18.673

wifi direct 中的群主IP 地址始终是不变的，即192.168.49.1。要检查这一点，您可以在 BroadcastReceiver 类中进行以下更改。

```
 public void onReceive(Context context, Intent intent) {
                String action = intent.getAction();

        if (WifiP2pManager.WIFI_P2P_CONNECTION_CHANGED_ACTION.equals(action)) {

                    if (mManager == null) {
                        return;
                    }
                    NetworkInfo networkInfo = (NetworkInfo) intent
                            .getParcelableExtra(WifiP2pManager.EXTRA_NETWORK_INFO);

                    if (networkInfo.isConnected()) {

                        mManager.requestConnectionInfo(mChannel, new ConnectionInfoListener() {

                            @Override
                            public void onConnectionInfoAvailable(WifiP2pInfo info) {

                                InetAddress groupOwnerAddress = info.groupOwnerAddress;

                                String s=groupOwnerAddress.getHostAddress();
                                Toast.makeText(mActivity, "Server IP Address "+s, Toast.LENGTH_SHORT).show();                

                            }
                        });
                    }
                }
} 
```

# highcharts - Highcharts 3.0，堆叠和未堆叠系列的面积图 - 如何修复？

> ID：15621253
> 
> 赞同：3
> 
> 时间：2013-03-25T17:38:56.793
> 
> 标签：highcharts, area

我有一个复杂的面积图，它使用一些堆叠和一些未堆叠的系列。

在版本 3 之前，一切正常。在版本 3 中，firefox 和 chrome 都有一些奇怪的错误行为：示例：http: [//jsfiddle.net/jlbriggs/yj3FP/](http://jsfiddle.net/jlbriggs/yj3FP/)

```
stacking:'normal', 
```

如果我禁用堆叠，一切看起来都符合预期。但我需要堆叠。因此，如果您注释掉 'stacking:normal' 行，您将看到图表应有的样子，除了堆叠部分......

在上面链接的示例中，如果您隐藏除“预测”系列之外的所有区域系列，您将看到事情看起来应该如何。请注意，与“预测”系列接壤的粗大线消失了——它本来就不应该在那里！该线是所有其他堆叠系列，它们不沿 x 轴延伸到“预测”系列的区域，包裹并覆盖“预测”系列。

现在，隐藏了那些堆叠的区域系列，再次展示它们——注意线条扭曲和曲折的非常奇怪的方式......

我意识到这是一个复杂的解释。很难解释的问题:)

所以问题是：

1）这里发生了什么？

2）如何让它停止？:)

github 上的问题被列为已解决，但我仍然遇到与此图表完全相同的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T12:51:46.357

好的，解决方案：

我一直在 plotoptions 的系列级别设置 stacking:normal ，并根据需要在系列级别上禁用它。

相反，我从绘图选项中删除了堆叠设置，而是根据需要仅将其设置为逐系列级别。

问题消失了。

# android - onSaveInstanceState 会在后栈中的 Fragment 上被调用吗？

> ID：15621256
> 
> 赞同：4
> 
> 时间：2013-03-25T17:39:05.367
> 
> 标签：android, android-fragments

当活动被销毁时，FragmentManager 后台堆栈中的每个片段是否都会调用 onSaveInstanceState，即使这些片段不可见？这种行为正常吗？

# assembly - 组装，打印ASCII码

> ID：15621258
> 
> 赞同：2
> 
> 时间：2013-03-25T17:39:11.267
> 
> 标签：assembly, x86, ascii, x86-16

我的汇编代码有问题。我想打印存储在寄存器 cx 中的数字，但是当我尝试打印它时，它打印的是 ascii 字符而不是 ascii 数字，所以我决定编写一个将 ascii char 转换为 ascii 值的过程。问题是，当我尝试调用该程序时，程序冻结，我必须重新启动 dosbox。有谁知道这段代码有什么问题？谢谢。

```
P4      PROC                
            MOV AX,CX           ;CX = VALUE THAT I WANT TO CONVERT
            MOV BX,10           
    ASC2:
            DIV BX              ;DIV AX/10
            ADD DX,48           ;ADD 48 TO REMAINDER TO GET ASCII CHARACTER OF NUMBER 
            PUSH AX             ;SAVE AX
            MOV AH,2            ;PRINT REMAINDER STORED IN DX
            INT 21H             ;INTERRUP
            POP AX              ;POP AX BACK
            CMP AX,0            
            JZ EXTT             ;IF AX=0, END OF THE PROCEDURE
            JMP ASC2            ;ELSE REPEAT
    EXTT:
            RET
    P4      ENDP 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T18:02:31.803

这样的东西对于打印十进制值会更好（新代码是小写的）：

```
 mov byte [buffer+9],'$'
        lea si,[buffer+9]

        MOV AX,CX           ;CX = VALUE THAT I WANT TO CONVERT
        MOV BX,10         
ASC2:
        mov dx,0            ; clear dx prior to dividing dx:ax by bx
        DIV BX              ;DIV AX/10
        ADD DX,48           ;ADD 48 TO REMAINDER TO GET ASCII CHARACTER OF NUMBER 
        dec si              ; store characters in reverse order
        mov [si],dl
        CMP AX,0            
        JZ EXTT             ;IF AX=0, END OF THE PROCEDURE
        JMP ASC2            ;ELSE REPEAT
EXTT:
        mov ah,9            ; print string
        mov dx,si
        int 21h
        RET

buffer: resb 10 
```

它不是直接打印每个字符，而是以相反的顺序将字符添加到缓冲区。对于值 123，它将在缓冲区 [8] 处添加“3”，在缓冲区 [7] 处添加“2”，在缓冲区 [6] 处添加“1” - 因此，如果您随后打印从缓冲区 + 6 开始的字符串，则会得到“123 ”。
我正在使用 NASM 语法，但希望它应该足够清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T18:01:17.483

正如迈克尔在他的代码中所写的那样，您需要清除 DX ，即在除法之前将其设为 0。

但是如果你问我，如果你只需要以 ASCII 形式显示一个数字（当你想显示一个数字时不要得到笑脸）。在内部将值转换为 ASCII 可能非常不方便。

为什么不直接使用在程序开始时定义的包含数字的所有 ASCII 值的数组，然后选择对应的数组。

例如。`DB arr '0123456789'` 并将每个数字与特定位置进行比较并打印出来。自从我用 8086 编码以来已经很长时间了，但我记得在一个程序中使用了这个逻辑，该程序需要我打印一个十六进制数字的 ASCII 值。所以我使用了一个数组，`0123456789ABCDEF`它工作得很好。

只是我的两分钱。因为你只想要结果。你如何计算它并不重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-06T18:21:16.220

这是用于打印数字的经过良好测试的代码

```
.186
.model SMALL
.STACK 100h
.data
    HelloMessage db 'Hello World', 13, 10, '$'
    SuperNumber dw 13565
.code

; Writes word number from AX to output
; Usage
; .186
; ....
; mov ax, 13444
; call PRINT_NUMBER

PRINT_NUMBER PROC NEAR  ; Outputs integer word number stored in AX registry. Requires CPU
    ; Save state of registers.
    PUSHA       ; Save all general purpose registers
    PUSH BP     ; We're going to change that.

    ; we need variables

    ; word number;      2 bytes
    ; byte digitsCount; 1 byte

    ; reserving space for variables on stack (3 bytes)
    mov bp, sp; ; bp := address of the top of a stack
    sub sp, 3*8 ; allocate 3 bytes on stack. Addresses of variables will be
            ; number:   WORD PTR [rbp - 2*8]
            ; digitsCount:  BYTE PTR [rbp - 3*8]

    ; Getting digits
    ; number = ax;
    ; digitsCount = 0;
    ; do
    ; {
    ;   push number%10;
    ;   digitsCount++;
    ;   number = number / 10;
    ; }
    ; while (number > 0)
    mov WORD PTR [bp - 2*8], ax ; number = ax;
    mov BYTE PTR [bp - 3*8], 0  ; digitsCount = 0;

    getDigits:          ; do
        mov ax, WORD PTR [bp - 2*8]; number/10: ax = number / 10, dx: number % 10
        ;cwd
        mov dx, 0
        mov bx, 10
        div bx

        push dx         ; push number%10
        mov WORD PTR[bp - 2*8], ax; number = number/10;
        inc byte PTR[bp - 3*8]  ; digitsCount++;

        cmp WORD PTR[bp - 2*8], 0; compare number and 0
        je getDigitsEnd     ; if number == 0 goto getDigitsEnd
        jmp getDigits       ; goto getDigits;
    getDigitsEnd:

    mov ah, 9
    mov dx, offset HelloMessage
    int 21h

    ;while (digitsCount > 0)
    ;{
    ;   pop digit into ax
    ;   print digit
    ;   digitsCount--;
    ;}
    printDigits:
        cmp BYTE PTR[bp - 3*8], 0; compare digits count and 0
        je printDigitsEnd   ; if digitsCount == 0 goto printDigitsEnd

        pop ax          ; pop digit into al
        add al, 30h     ; get character from digit into al

        mov ah, 0eh     ; wanna print digit!
        int 10h         ; BIOS, do it!

        dec BYTE PTR[bp - 3*8]  ; digitsCount--

        jmp printDigits     ; goto printDigits
    printDigitsEnd:

    ; Deallocate local variables back.
    mov sp, bp

    ; Restore state of registers in reverse order.
    POP BP
    POPA

    ; Exit from procedure.
    RET

PRINT_NUMBER ENDP

start:
    mov ax, @data
    mov ds, ax

    mov ah, 9
    mov dx, offset HelloMessage
    int 21h

    mov ax, 64454   
    call Print_Number

    mov ah, 4ch
    int 21h
end start 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-17T03:06:31.933

以为我应该对此发布更新。这篇文章确实帮助我找到了一种获取 PHP CLI 脚本的关键输入的方法。我在任何地方都找不到 Windows/DOS 解决方案，所以我选择了外部程序。

我使用的是一个非常旧版本的 a86 汇编程序，所以代码非常基本。

（以及如何关闭“运行代码片段”？）

```
;Key input for scripts that can use some "shell" function.
;Waits for a keypress then returns a string "key:scan"
;if "key" is 0 then you can check "scan" for arrow keys
;or other non-ASCII keys this way.

  mov ah,0
  int 16h

  push ax
  mov ah,0
  mov cx,ax
  call ASC

  mov dx,':'
  call COUT
  pop ax
  shr ax,8
  mov ah,0
  mov cx,ax
  call ASC
  jp EXIT

COUT:
  mov ah,2
  int 21h
  ret

STROUT:			
  mov ah,9 					
  mov dx,si
  int 21h
  ret

ASC:
  mov byte [buffer+9],'$'
  lea si,[buffer+9]
  mov ax,cx
  mov bx,10 

ASC_LOOP:
  mov dx,0
  div bx
  add dx,48
  dec si
  mov [si],dl
  cmp ax,0            
  jz STROUT
  jmp ASC_LOOP

EXIT:
  mov ah,4ch
  int 21h
  ret

buffer: db "          " ; 10 spaces.  no "resb" in my assembler.
```

一个用于测试它的示例 PHP 脚本：

```
<?php

function getKey() {
	return shell_exec("getkey.com");
}

print "Press [ESC] to exit.\n\n";

$key = "";
while (ord($key) != 27) {
	$getch = explode(":",getKey());
	$key = chr($getch[0]);
	$scan = $getch[1];
	if (ord($key) != 0) {
		print $key;
	} else {
		print "SCAN:$scan\n";
	}
}

?>
```

不可否认，毕竟说了又做了，我意识到我可以用 C++ 做同样的事情。但这次我学到了更多关于 ASM 的知识。

所以再次感谢各位！

# linux - 记录导致主要页面错误的内存访问

> ID：15621263
> 
> 赞同：6
> 
> 时间：2013-03-25T17:39:32.743
> 
> 标签：linux, memory, page-fault, perf, systemtap

有谁知道如何获取导致页面错误的内存访问（指针）？我主要对主要的页面错误感兴趣。

关于我想要实现的目标的一些背景知识。我有一个内存占用很大的应用程序（数据库），我想将分页与对大型数据结构（例如使用 mmap() 分配的表、索引）的访问相关联。进程的映射很容易从 /proc//maps 中检索。现在，如果我有导致页面错误的内存访问，我可以跟踪在访问每个数据结构时导致了多少页面错误。

我认为 perf 或 systemtap 可以完成这项工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T21:53:24.013

你的猜测是对的。您可以使用 perf 工具来跟踪您的应用程序导致的页面错误的数量。

我建议您阅读[本教程](https://perf.wiki.kernel.org/index.php/Main_Page)以学习使用该工具。

要安装只需使用：

您正在寻找事件*page-fault*。您可以通过以下方式安装（在 ubuntu 或其他 apt 发行版中）：

```
sudo apt-get install linux-tools-common linux-base 
sudo apt-get install linux-tools-YOUR-KERNEL number 
```

您可以使用以下命令获取内核编号：uname -r

例如，此命令在“ls”命令上运行 perf 工具：

```
perf record -e page-faults:u -F 250 ls 
```

然后你可以查看结果（“ls”的二进制文件没有调试信息，所以不要指望一个漂亮的输出）：

```
perf report 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-25T19:39:42.303

查看探测点可用的内容：

```
% stap -L vm.pagefault
vm.pagefault name:string write_access:long address:long $mm:struct mm_struct* \
   $vma:struct vm_area_struct* $address:long unsigned int $flags:unsigned int 
```

记录，尝试将地址映射到符号名称

```
# stap -e 'probe vm.pagefault { if (execname()=="foo") { printf("%p (%s)\n", address, usymdata(address)) } }' -d /bin/foo --ldd 
```

另见：http: [//sourceware.org/systemtap/examples/#memory/pfaults.stp](http://sourceware.org/systemtap/examples/#memory/pfaults.stp)

# android - 计算http请求所花费的时间[Android]

> ID：15621268
> 
> 赞同：0
> 
> 时间：2013-03-25T17:39:43.980
> 
> 标签：android, httpclient

使用 android `HttpGet`，`HttpClient`我正在执行以下 http 请求。

```
long startTime = System.currentTimeMillis();
HttpResponse response = httpclient.execute(httpGetReq);
HttpEntity httpEntity = response.getEntity();
long endTime = System.currentTimeMillis();
double totalTime = endTime-startTime; 
```

此 http 请求具有播放负载数据。在上面的代码中，我试图计算这个请求所用的时间，但是上面的代码只返回接收标头部分所用的时间，而不是请求的数据/有效负载部分。

我想要的是，我想计算执行此请求所花费的总时间，这意味着我们收到所有标头 + 有效负载数据的总时间。

我应该如何存档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:43:19.173

您需要从响应中获取 inputStream 并读取输入流以判断整个请求所花费的大致时间。

# c++ - 如何从qsub将值传递给代码的boost选项参数

> ID：15621271
> 
> 赞同：0
> 
> 时间：2013-03-25T17:39:52.720
> 
> 标签：c++, boost, parallel-processing, multicore, qsub

我有一个从用户那里获取一些价值的程序（参数是使用 boost 选项传递的）。./prog --my-value 32

到这里为止都很好，但是现在我正在使用 qsub 脚本在多节点和多核中运行程序（并且我只能使用 pbs 脚本）并且想要传递参数。qsub ./xyz.sh --my-value 32 [我怎么能这样做..我的意思是我能以某种方式做到这一点吗？]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T18:54:02.803

很简单，在 pbs 脚本中指定可执行文件后，
APP_PATH= /.. (what ever app) APP_OPTION = (what ever going here) pbsdsh - u -v ... --my-value 32

# android - addPrefencesFromResource 导致 FC: Error inflating class CheckboxPreference

> ID：15621272
> 
> 赞同：1
> 
> 时间：2013-03-25T17:39:57.300
> 
> 标签：android, crash, checkboxpreference

每次我切换到首选项活动时，我都会收到一个运行时错误，该错误会影响我的应用程序。我正在尝试学习 Android 编程，并且我设法解决了我遇到的问题，但是经过大量时间寻求帮助后，我无法理解我做错了什么。

这是 Settings.java 的代码：

```
package com.wisp.sudokuapp;

import android.os.Bundle;
import android.preference.PreferenceActivity;

public class Settings extends PreferenceActivity {
    @SuppressWarnings("deprecation")
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.settings);
    }

} 
```

我的设置.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen
    xmlns:android="http://schemas.android.com/apk/res/android" >

    <CheckboxPreference
       android:key="hints"
       android:title="@string/settings_hints_title"
       android:summary="@string/settings_hints_summary"
       android:defaultValue="true" />

    <CheckboxPreference
       android:key="music"
       android:title="@string/settings_music_title"
       android:summary="@string/settings_music_summary"
       android:defaultValue="true" />

</PreferenceScreen> 
```

我的清单：

```
(...)
        <activity android:name="com.wisp.sudokuapp.Settings"
            android:label="@string/settings_title">
        </activity>
(...) 
```

和 Logcat：

```
03-25 17:22:22.637: W/dalvikvm(440): threadid=1: thread exiting with uncaught exception (group=0x40015560)
03-25 17:22:22.687: E/AndroidRuntime(440): FATAL EXCEPTION: main
03-25 17:22:22.687: E/AndroidRuntime(440): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.wisp.sudokuapp/com.wisp.sudokuapp.Settings}: android.view.InflateException: Binary XML file line #5: Error inflating class CheckboxPreference
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.os.Looper.loop(Looper.java:123)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.app.ActivityThread.main(ActivityThread.java:3683)
03-25 17:22:22.687: E/AndroidRuntime(440):  at java.lang.reflect.Method.invokeNative(Native Method)
03-25 17:22:22.687: E/AndroidRuntime(440):  at java.lang.reflect.Method.invoke(Method.java:507)
03-25 17:22:22.687: E/AndroidRuntime(440):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
03-25 17:22:22.687: E/AndroidRuntime(440):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
03-25 17:22:22.687: E/AndroidRuntime(440):  at dalvik.system.NativeStart.main(Native Method)
03-25 17:22:22.687: E/AndroidRuntime(440): Caused by: android.view.InflateException: Binary XML file line #5: Error inflating class CheckboxPreference
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.preference.GenericInflater.createItemFromTag(GenericInflater.java:441)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.preference.GenericInflater.rInflate(GenericInflater.java:481)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.preference.GenericInflater.inflate(GenericInflater.java:326)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.preference.GenericInflater.inflate(GenericInflater.java:263)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.preference.PreferenceManager.inflateFromResource(PreferenceManager.java:251)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.preference.PreferenceActivity.addPreferencesFromResource(PreferenceActivity.java:262)
03-25 17:22:22.687: E/AndroidRuntime(440):  at com.wisp.sudokuapp.Settings.onCreate(Settings.java:11)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
03-25 17:22:22.687: E/AndroidRuntime(440):  ... 11 more
03-25 17:22:22.687: E/AndroidRuntime(440): Caused by: java.lang.ClassNotFoundException: android.preference.CheckboxPreference in loader dalvik.system.PathClassLoader[/data/app/com.wisp.sudokuapp-1.apk]
03-25 17:22:22.687: E/AndroidRuntime(440):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
03-25 17:22:22.687: E/AndroidRuntime(440):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
03-25 17:22:22.687: E/AndroidRuntime(440):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.preference.GenericInflater.createItem(GenericInflater.java:375)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.preference.GenericInflater.onCreateItem(GenericInflater.java:417)
03-25 17:22:22.687: E/AndroidRuntime(440):  at android.preference.GenericInflater.createItemFromTag(GenericInflater.java:428)
03-25 17:22:22.687: E/AndroidRuntime(440):  ... 19 more 
```

我知道该方法已过时，但我希望它与 2.3.x 一起使用。要学习 android 开发，我正在读一本书，在书中它似乎有效。我发现注释掉 addPreferencesFromResource 行可以防止应用程序崩溃，但显然不会加载任何 UI。

我真的很感激你的帮助。

对不起我的英语不好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T17:43:13.103

问题在于 xml 文件中的拼写错误。将 CheckboxPreference 更改为 CheckBoxPreference。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:43:31.470

你有一个拼写错误。二，事实上。尝试：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen
    xmlns:android="http://schemas.android.com/apk/res/android" >

    <CheckBoxPreference
       android:key="hints"
       android:title="@string/settings_hints_title"
       android:summary="@string/settings_hints_summary"
       android:defaultValue="true" />

    <CheckBoxPreference
       android:key="music"
       android:title="@string/settings_music_title"
       android:summary="@string/settings_music_summary"
       android:defaultValue="true" />

</PreferenceScreen> 
```

Android XML 区分大小写，因此`CheckboxPreference`与`CheckBoxPreference`.

# git - 更改现有项目版本控制系统

> ID：15621275
> 
> 赞同：3
> 
> 时间：2013-03-25T17:40:08.460
> 
> 标签：git, tfs, project

TFS2012 允许用户创建使用 Team Foundation 版本控制或 Git 作为版本控制系统的项目。

我想知道是否有任何方法可以将现有的 TFS2012 项目版本控制系统从 Team Foundation 版本控制更改为 Git。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:02:18.660

不。

根据[Brian Harry](http://blogs.msdn.com/b/bharry/archive/2013/01/30/git-init-vs.aspx#10389636)的说法，这不受支持。

> 不，您不能就地转换，但您可以使用 Git-TF 从 TFVC 中提取并推送到带有 Git 存储库的项目并保留历史记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-01T14:15:33.413

看看这个链接[http://www.codewrecks.com/blog/index.php/2013/01/31/move-a-tfservice-source-control-to-tf-service-git-based-team-project /](http://www.codewrecks.com/blog/index.php/2013/01/31/move-a-tfservice-source-control-to-tf-service-git-based-team-project/)

在这里，我们可以看到如何使用 Git-TF 来做到这一点。

# many-to-many - 在多对多关系 laravel4 的情况下更新数据透视表

> ID：15621279
> 
> 赞同：9
> 
> 时间：2013-03-25T17:40:54.587
> 
> 标签：many-to-many, laravel, pivot-table, laravel-4, eloquent

我最近开始使用 Laravel4。在多对多关系的情况下，我在更新数据透视表数据时遇到了一些问题。

情况是：我有两个表：**Product**，**ProductType**。他们之间的关系是**多对多**。我的模型是

```
class Product extends Eloquent {
    protected $table = 'products';
    protected $primaryKey = 'prd_id';

    public function tags() {
        return $this->belongsToMany('Tag', 'prd_tags', 'prta_prd_id', 'prta_tag_id');
    }
}

class Tag extends Eloquent {
    protected $table = 'tags';
    protected $primaryKey = 'tag_id';
        public function products()
    {
    return $this->belongsToMany('Product', 'prd_tags', 'prta_prd_id', 'prta_tag_id');
    }
} 
```

在将数据插入数据透视表 prd_tags 时，我做了：

```
$product->tags()->attach($tag->tagID); 
```

但是现在我想更新这个数据透视表中的数据，将数据更新到数据透视表的最佳方法是什么。假设我想删除一些标签并为特定产品添加新标签。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-02-21T18:29:02.057

老问题，但在 2013 年 11 月 13 日，updateExistingPivot 方法对多对多关系公开。这还没有在官方文档中。

```
public void updateExistingPivot(mixed $id, array $attributes, bool $touch) 
```

--更新表上现有的数据透视记录。

自 2014 年 2 月 21 日起，您必须包含所有三个参数。

在你的情况下，（如果你想更新数据透视字段'foo'）你可以这样做：

```
$product->tags()->updateExistingPivot($tag->tagID, array('foo' => 'value'), false); 
```

或者，如果您想触摸父时间戳，您可以将最后一个布尔值 false 更改为 true。

拉取请求：

[https://github.com/laravel/framework/pull/2711/files](https://github.com/laravel/framework/pull/2711/files)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-02-17T18:31:04.390

使用 laravel 5.0+ 时的另一种方法

```
$tag = $product->tags()->find($tag_id);
$tag->pivot->foo = "some value";
$tag->pivot->save(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-12T13:18:40.457

我知道这是一个老问题，但如果您仍然对解决方案感兴趣，这里是：

假设您的数据透视表具有“foo”和“bar”作为附加属性，您可以这样做将数据插入该表：

```
$product->tags()->attach($tag->tagID, array('foo' => 'some_value', 'bar'=>'some_other_value')); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-02-09T13:31:38.587

从 Laravel 6 开始，[`newPivotQuery()`](https://laravel.com/api/6.x/Illuminate/Database/Eloquent/Relations/Concerns/InteractsWithPivotTable.html#method_newPivotQuery)如果您想同时使用`update()`多个数据透视模型（数据库行）（使用`Query\Builder::update()`语句），也可以使用。

看起来像这样：

```
$someModel->someBelongsToManyRelation()
    ->wherePivotNotIn('some_column', [1, 2, 3])
    ->wherePivotNull('some_other_column')
    ->newPivotQuery()
    ->update(['some_other_column' => now()]); 
```

或者没有 wherePivot 方法：

```
$someModel->someBelongsToManyRelation()
    ->newPivotQuery()
    ->whereNotIn('some_column', [1, 2, 3])
    ->whereNull('some_other_column')
    ->update(['some_other_column' => now()]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-13T22:12:53.130

这是完整的例子：

```
 $user = $this->model->find($userId);
    $user->discounts()
        ->wherePivot('discount_id', $discountId)
        ->wherePivot('used_for_type', null)
        ->updateExistingPivot($discountId, [
            'used_for_id' => $usedForId,
            'used_for_type' => $usedForType,
            'used_date_time' => Carbon::now()->toDateString(),
        ], false); 
```

# jquery - 下拉导航的最佳方法

> ID：15621281
> 
> 赞同：-1
> 
> 时间：2013-03-25T17:40:57.870
> 
> 标签：jquery, html, css, jquery-animate, soundcloud

我目前有这个导航栏，由 CSS 和 HTML 制成，主要是 inline-block 元素：

![导航栏](../Images/b8c8976657b883912b9095d34e5be2ca.png)

我想要实现的效果与[SOUNDCLOUD上的此导航菜单相同](http://www.soundcloud.com)

一旦您单击导航中的 n 项，菜单就会下拉，显然可以为您提供更多选项并增加导航空间。这是我希望达到的状态：

![声云菜单](../Images/1801af90211c774a6de19e72a970549d.png)

由于我已经掌握了基本的 HTML 和 CSS，就功能而言，下一个最佳步骤是什么。

任何人都知道任何类似的 JQuery 可以适应这种类型的交互吗？

提前致谢。

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:50:41.087

你不应该需要任何太花哨的东西。基本的 jQuery 会做到这一点。看看这个[jsfiddle 例子](http://jsfiddle.net/eDx3W/)

这是基本的想法：一个可点击的链接，它使另一个 div 变得可见——就像在你的 HTML/CSS 布局中，div 在被点击的元素之上：

```
$(document).ready(function() {
    $('#reveal').click( function() {
        $('#hidden').slideToggle();
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:54:58.567

即使您没有提供任何 HTML，我也做了一些作为示例：

```
<div id="dropdown" style="display:none;">
<!-- slideToggle() finishes with display:none when hiding an element. specifying display:none beforehand simply makes it so that the element is hidden when the page loads. -->

    <!--Content here-->
</div>

<div class="navigationbar">
    <div class="button" id="more"></div>
<div>

<script type="text/javascript">
    $(document).ready(function(){
        $('#more').click(function(){
            $('#dropdown').slideToggle();
        });
    });
</script> 
```

希望这可以帮助！

# mysql - 按其他表中的 id 对计数进行排序查询并获取名称

> ID：15621285
> 
> 赞同：0
> 
> 时间：2013-03-25T17:41:03.430
> 
> 标签：mysql, count

我有两张桌子，一张叫水果：

```
id title

1  Banana
2  Apple
3  Orange 
```

第二个fruits_chosen：

```
 user_id  fruit_id

   1        1
   2        1
   2        3 
   3        1
   3        2
   3        3 
```

它应该返回：

```
 Banana 3 times
 Orange 2 times
 Apple  1 time 
```

现在我构建了一个查询来获取项目，按计数对它们进行排序，但我不知道如何在同一个查询中从另一个表中获取标题，有什么想法吗？

```
"SELECT COUNT(fruit_id) as count, fruit_id FROM fruits_chosen GROUP BY fruit_id ORDER BY COUNT(fruit_id) DESC LIMIT 5" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:45:38.467

您将需要`JOIN`使用`fruit_id`to`id`列的表，类似于以下内容：

```
SELECT f.title, 
    COUNT(fc.fruit_id) as count
FROM fruits_chosen fc
INNER JOIN fruits f
    on fc.fruit_id = f.id
GROUP BY f.title
ORDER BY COUNT(fc.fruit_id) DESC LIMIT 5 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/fad14/5)

这是使用`INNER JOIN`将仅返回在两个表中匹配的那些行。如果您想全部返回`fruits`，无论它是否被选中，那么您可以使用`LEFT JOIN`：

```
SELECT f.title, 
    COUNT(fc.fruit_id) as count
FROM fruits f
LEFT JOIN fruits_chosen fc
    on fc.fruit_id = f.id
GROUP BY f.title
ORDER BY COUNT(fc.fruit_id) DESC LIMIT 5 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/b3eb2/1)

如果您希望它返回`Banana 3 times`等，您可以使用`CONCAT`MySQL 中的函数：

```
SELECT 
  concat(f.title, ' ',COUNT(fc.fruit_id), ' times') Total
FROM fruits f
LEFT JOIN fruits_chosen fc
    on fc.fruit_id = f.id
GROUP BY f.title
ORDER BY COUNT(fc.fruit_id) DESC LIMIT 5 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/b3eb2/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:43:51.953

```
SELECT 
COUNT(*) as count,
f.title, 
fruit_id 
FROM fruits_chosen fc
INNER JOIN fruits f on f.id = fc.fruit_id
GROUP BY 
fc.fruit_id, f.title
ORDER BY count DESC 
LIMIT 5 
```

[SqlFiddle](http://sqlfiddle.com/#!2/fad14/3)

# java - 如何在 jboss 7.1.x 中加载部署类加载器

> ID：15621286
> 
> 赞同：0
> 
> 时间：2013-03-25T17:41:10.557
> 
> 标签：java, jboss7.x

我已经在 C:\jboss-as-7.1.1.Final\standalone\deployments\sample.war 中部署了 war 文件，在该部署的 sample.war/web-inf/empInfo.xml

我应该如何在运行时加载 empInfo.xml？

我试过了，它给出了空值

```
 InputStream settingsStream = this.getClass().getClassLoader().getResourceAsStream("empInfo.xml"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T15:39:30.477

您需要将其移动到类路径。该`WEB-INF`目录不在部署类路径上。将它移到`WEB-INF/classes`它应该可以找到。

# actionscript-3 - 未找到 ASDoc 基类

> ID：15621291
> 
> 赞同：0
> 
> 时间：2013-03-25T17:41:27.980
> 
> 标签：actionscript-3, asdoc

我一直在尝试使用 ASDocs 为一些操作脚本 3 文件生成文档，但我收到了错误：

```
Error: The difinition of base class TextInput was not found 
```

该类来自 fl.controls 库。我使用 Flash Professional CS5 编写类，并使用命令行运行 ASDoc。

我一直在寻找其他人如何处理它，他们似乎在使用 FlashDeveloper 或 Flex Builder，我没有。所以通常他们会说添加包含 Flex Builder 的 -libarary-path，但似乎已经停止使用。我也尝试使用路径：

```
/Applications/Adobe\ Flash\ Builder\ 4/sdks/4.0.0/frameworks/libs/ 
```

没有成功。

包含 fl 库的路径是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T22:06:01.720

您走在正确的轨道上，您需要将这些库添加到您的配置中。

在 Mac+FlashCS6.0 上，包含的库`TextInput`应该在这里：

`/Applications/Adobe\ Flash\ CS6/Common/Configuration/Components/User\ Interface/TextInput.swc`

# vb.net - 如何从 vb.net 应用程序运行 windows 命令“mklink”？

> ID：15621294
> 
> 赞同：3
> 
> 时间：2013-03-25T17:41:31.633
> 
> 标签：vb.net, mklink

我希望能够从我的 vb.net 项目中运行“mklink path1 path2”。我做不到。我尝试过使用 Shell() 函数和 Process。

有了这个它只打开 cmd.exe 窗口并且什么都不做：

```
 Dim process As New Process
        process.StartInfo.FileName = "cmd.exe"
        process.StartInfo.Arguments = "mklink """ + arma2oaAddons + """ """ + arma2Addons + """ /j"
        process.StartInfo.WorkingDirectory = "C:\"
        process.Start() 
```

有了这个我得到错误“找不到文件”。它找不到 mklink.:

```
 Shell("mklink """ + arma2oaAddons + """ """ + arma2Addons + """ /j") 
```

**什么是 mklink？**

[Mklink](http://technet.microsoft.com/en-us/library/cc753194%28v=ws.10%29.aspx)是一个 MS Windows 命令行实用程序，可用于在 MS Windows 中创建符号链接或符号链接和硬链接。它是 CMD shell 的一部分，例如 dir 命令。

我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T17:49:56.823

第一个例子很好，除非`cmd.exe /c`你想执行它，所以 你需要使用它

```
Dim process As New Process
process.StartInfo.FileName = "cmd.exe"
process.StartInfo.Arguments = "/c mklink """ + arma2oaAddons + """ """ + arma2Addons + """ /j"
process.StartInfo.WorkingDirectory = "C:\"
process.Start() 
```

# c# - 非平凡数据类型的预定义常量

> ID：15621305
> 
> 赞同：3
> 
> 时间：2013-03-25T17:42:41.700
> 
> 标签：c#, constants, readonly, mutable

我的目标：为同时具有 ID 和消息的预定义错误创建一个 C# 类。这是我尝试过的：

```
public class MyError
{
    public static readonly MyError OK = new MyError(0, "OK");
    public static readonly MyError Bad = new MyError(1, "Bad Stuff");

    public MyError(int id, string message)
    {
        this.Id = id;
        this.Message = message;
    }

    public readonly int Id;
    public readonly string Message;
} 
```

这编译得很好，我相信它在实践中会很好地工作。但我总是喜欢遵循代码分析指南。在上述情况下，违反了 CA2104 “不要声明只读可变引用类型”

除了上述之外，我还尝试了许多其他方法，包括尝试 const 而不是 readonly （甚至不会编译），{ get; 私人套装；} 用于成员访问、结构而不是类等。

哪个是可变类型？身份证还是短信？

我愿意接受任何可以实现我想要的建议：非平凡数据类型的预定义常量。

当然，我总是可以忽略警告，但我发现它们通常是有原因的。

*** 澄清 *** 我的问题实际上不是关于这个特定的 MyError 类，而是更多关于为基本数据类型以外的东西定义常量的更基本问题。

假设我想定义三个双精度常量。C# 让我这样做：

```
 public const double HighValue = 11.0;
   public const double LowValue = 0.1;
   public const double MidValue = 5.5; 
```

C#为我们预定义了一些有用的*双常量：* *NaN*、*MinValue*、*MaxValue*、*NegativeInfinity*、*PositiveInfinity*。

那么现在，如果*我*想为空间中的三维向量 (X,Y,Z) 预定义一些有趣的常数怎么办？我可以为双精度数、整数、字符串等定义常量，但是如何为不那么琐碎的东西定义一个常量？Origin 是一个有趣的常数，我想给它起个名字：

```
public class Vector3D
{
    /// The problem is that this does not work
    public const Vector3D Origin = { 0.0, 0.0, 0.0 };

    public double X;
    public double Y;
    public double Z;
} 
```

我不需要成千上万的常量。就像我们的朋友*double*有*NaN*等一样。这个类也不需要特别保护或密封。任何人都可以自由地创建 Vector3D 对象并以他们想要的任何方式从中派生。我只想有一个名为 Origin 的特殊常量，其值为 (0.0, 0.0, 0.0)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T17:43:35.793

您的类型不是可变的，但代码分析不知道这一点。
此警告是误报；你应该压制它。

* * *

要回答您编辑的问题：

`const`只能应用于基元。
对于自定义类型，`static readonly`是唯一的选择。

只要类型正确地不可变，它就会完美地工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T17:49:20.307

类型不可变。代码分析因拥有公共只读字段而感到困惑。

您可以通过将公共字段设为公共属性来解决代码分析问题：

```
public MyError(int id, string message)
{
    this.id = id;
    this.message = message;
}
private readonly int id;
private readonly string message;
public int Id { get { return id; } }
public string Message { get { return message; } } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T18:20:23.080

你的属性不应该是静态的，因为这个类的每个实例都有自己的 ID 和消息，你同意吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T17:53:45.023

我会创建一个类

*   被**密封**，以防止它被继承
*   有一个**私有构造函数**，以防止它从类外部实例化
*   提供带有**私有 setter**的属性，因此不能从外部设置它们。

这将为您提供以下代码：

```
public sealed class MyError
{
    public static readonly MyError OK = new MyError(0, "OK");

    public static readonly MyError Bad = new MyError(1, "Bad Stuff");

    private MyError(int id, string message)
    {
        this.ID = id;
        this.Message = message;
    }

    public int ID { get; private set; }

    public string Message { get; private set; }
} 
```

# javascript - AJAX 以错误的顺序返回

> ID：15621306
> 
> 赞同：2
> 
> 时间：2013-03-25T17:42:43.497
> 
> 标签：javascript, jquery, ajax, chat

好的，所以我正在为我正在从事的项目编写一个小聊天系统。在此过程中，我一直在尝试学习 AJAX，而且一切似乎都很顺利。我的 AJAX 运行一个打开目录的 PHP 页面，并且 AJAX 从页面接收作为数组 (DirectoryList) 的目录。然后它一遍又一遍地加载另一个 AJAX 函数，直到所有聊天日志都附加到 DIV。

我的问题是 ChatLogs 没有按正确的顺序加载。

例如，如果我有日志：

*   1.txt
*   2.txt
*   3.txt
*   4.txt

它们将被附加到 ChatContainer DIV 中：

*   2.txt
*   1.txt
*   4.txt
*   3.txt

而不是正确的顺序。

这是我的代码：

```
var ChatList = new Array();
var p;
var DirectoryList = new Array();
var ChatString = '';

function loadChat(variable) {
    var req = new XMLHttpRequest();
    req.onreadystatechange = function () {
        if (req.readyState == 4 && req.status == 200) {
            DirectoryList = JSON.parse(req.responseText);
            var p = variable;
            while (p < DirectoryList.length) {
                loadLog(p);
                p++;
            }
        }
    }

    //END REQ1

    //Post Chat to DIV

    function loadLog(p) {
        $.get('chat/log/' + DirectoryList[p], function (data2) {
            ChatList.push(data2);
            $('#ChatContainer').append(data2);
        });
    }

    //End
    req.open('GET', 'process/ReadChatLogs.php', true)
    req.send(null);
}

loadChat(0); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T17:52:30.127

Ajax 不能保证按照您请求它们的顺序完成，因为服务器返回一个请求的时间可能比返回下一个请求的时间长。要解决这个问题，请等到它们全部完成，然后循环原始集合并附加结果。下面是如何使用延迟对象做到这一点。

```
var ChatList = new Array();
var p;
var DirectoryList = new Array();
var ChatString = '';

function loadChat(variable) {
    var req = new XMLHttpRequest();
    req.onreadystatechange = function () {
        if (req.readyState == 4 && req.status == 200) {
            DirectoryList = JSON.parse(req.responseText);
            var p = variable;
            var defArr = []; // store references to deferred objects
            while (p < DirectoryList.length) {
                defArr.push(loadLog(p));
                p++;
            }
            $.when.apply($,defArr).done(function(){ // apply handler when all are done
                // handle case where only one ajax request was sent
                var args = arguments;
                if ($.type(args[0]) != "array") {
                    args = [];
                    args[0] = arguments;
                }
                // loop over and ouput results.
                var outHTML = "";
                $.each(args,function(i){
                    outHTML += args[i][0];
                    ChatList.push(args[i][0]);
                });
                $("#ChatContainer").append(outHTML);
            });
        }
    }

    //END REQ1

    //Post Chat to DIV

    function loadLog(p) {
        return $.get('chat/log/' + DirectoryList[p]);
    }

    //End
    req.open('GET', 'process/ReadChatLogs.php', true)
    req.send(null);
} 
```

编辑：修复了只发送一个 ajax 请求的情况

# php - php下载文件

> ID：15621307
> 
> 赞同：0
> 
> 时间：2013-03-25T17:42:48.610
> 
> 标签：php, download

我需要在 jquery 移动应用程序（在桌面和移动设备上运行）中显示文件列表。主要从桌面我需要从列表中下载一个文件。我有一个简单的href如下：

```
<a href="download.php?file=test.txt">test.txt<a> 
```

问题是当用户单击链接时，会显示文件的实际内容。我希望用户能够在本地保存文件。我相信我正确设置了标题。这是标头的 Firebug 转储：

```
Response Headers
Accept-Ranges   bytes
Cache-Control   public, must-revalidate, post-check=0, pre-check=0
Connection  Keep-Alive
Content-Disposition attachment; filename="test.txt"
Content-Length  95
Content-Type    application/octet-stream
Date    Mon, 25 Mar 2013 17:35:26 GMT
Expires -1
Keep-Alive  timeout=5, max=99
Pragma  public
Server  Apache/2.2.24 (Unix) mod_ssl/2.2.24 OpenSSL/1.0.0-fips
Request Headers
Accept  text/html, */*; q=0.01
Accept-Encoding gzip, deflate
Accept-Language en-US,en;q=0.5
Cookie  PHPSESSID=bbf2549f793aed8565b44d532a3088dc; path=%2F; fileDownload=true
Host    192.168.1.225
Referer http://192.168.1.225/
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0
X-Requested-With    XMLHttpRequest 
```

我正在通过 Windows 机器上的浏览器进行测试。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:15:04.637

答案比较简单。Jquery mobile 使所有链接成为 Ajax 请求（我忘记了）。解决方案是在链接中添加“rel="external”，使其成为非 ajax 链接，如下所示：

```
<a href="download.php?file=test.txt" rel="external">test.txt<a> 
```

感谢 Alvaro G. Vicario 为我指明了正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-24T21:56:14.290

你也可以在 jQuet Mobile 之前添加这个 sceipt，它对我有用。

```
<script>
 $(document).bind("mobileinit", function(){
     $.mobile.ajaxEnabled = false;
 }); 
</script> 
```

# java - 重绘而不清除

> ID：15621313
> 
> 赞同：1
> 
> 时间：2013-03-25T17:43:21.597
> 
> 标签：java, swing, paint, repaint, paintcomponent

我正在开发一个模仿 Paint 的程序。问题是当我绘制一个新形状时，以前的形状会被删除。我试图注释掉我对paintComponents 的超级调用，它有效但留下了太多的绘图。

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;

import javax.swing.JOptionPane;
import javax.swing.JPanel;

public class Canvas1 extends JPanel{

    Circle c;
    Rectangle r;
    Line l;
    String str;
    int x1,x2,y1,y2;
    Graphics g;
    int draw;
    int hollow=0;
    Color cc;

    public Canvas1(){

        LineListener listener = new LineListener();
        addMouseListener(listener);
        addMouseMotionListener(listener);

        setBackground (Color.white);
        setPreferredSize (new Dimension(400, 400));

    }

    public void paintComponent(Graphics g){
        super.paintComponent(g);
        g.setColor(cc);
        if (this.draw == 1)
        {
            c = new Circle (x1,y1,x2,y2);
            if (hollow == 0)
            {
                c.hollow = false;
            }
            if (hollow == 1)
            {
                c.hollow = true;
            }
            c.draw(g);
        }
        if (this.draw ==2)
        {
            r = new Rectangle (x1,y1,x2,y2);
            if (hollow == 0)
            {
                r.hollow = false;
            }
            if (hollow == 1)
            {
                r.hollow = true;
            }   
            r.draw(g);
        }
        if (this.draw ==0)
        {
            l = new Line(x1,y1,x2,y2);
            l.draw(g);
        }
        if (this.draw ==3)
        {
            g.drawString(str, x1, y1);
        }

    }
    public void update(Graphics g) {
        paint(g);
        }
    private class LineListener implements MouseListener, MouseMotionListener{

        public void mousePressed(MouseEvent event){
            x1 = event.getX();
            y1 = event.getY();
            if (draw ==3)
            {
                str = JOptionPane.showInputDialog("Enter String");
                repaint();
            }
        }

        public void mouseDragged(MouseEvent event){
            if (draw ==1 || draw==2)
            {
                x2 = event.getX()-x1;
                y2 = event.getY()-y1;
            }
            if (draw ==0)
            {
                x2 = event.getX();
                y2 = event.getY();
            }
            repaint();

        }

        public void mouseClicked (MouseEvent event) {

        }
        public void mouseReleased (MouseEvent event) {
            if (draw ==1 || draw==2)
            {
                x2 = event.getX()-x1;
                y2 = event.getY()-y1;
            }
            if (draw ==0)
            {
                x2 = event.getX();
                y2 = event.getY();
            }
        }
        public void mouseEntered (MouseEvent event) {}
        public void mouseExited (MouseEvent event) {}
        public void mouseMoved (MouseEvent event) {}
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:57:03.110

[自定义绘画方法](http://tips4java.wordpress.com/2009/05/08/custom-painting-approaches/)展示了解决此问题的两种常见解决方案。

一种是从列表中提取。另一种是从 BufferedImage 中绘制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T17:50:26.437

正如您所发现的，您需要调用`super.paintComponent(g)`，否则，`JPanel`背景不会被绘制，一切都是一团糟。问题是任何时候都只能绘制一个形状，因为该`draw`字段只能是一个值。一种解决方案是创建一个`ArrayList`形状并在`List`in 中绘制每个形状`paintComponent`。

*   [例子](https://stackoverflow.com/questions/5854678/animation-handling-several-cycle?answertab=oldest#tab-top)

# excel - 在 Excel VBA 中保存 PowerPoint

> ID：15621318
> 
> 赞同：1
> 
> 时间：2013-03-25T17:43:32.523
> 
> 标签：excel, powerpoint, vba

我有代码可以创建一个新的 powerpoint，其中包含来自 excel 文件的一些图像。我想使用字符串变量来保存文件以定义其名称。我已经尽职尽责地寻找解决方案，但没有成功，这让我感到惊讶，因为我正在尝试完成一项基本任务。到目前为止，我已经...

```
newPowerPoint.ActivePresentations.SaveAs filenamestring, 1
newPowerPoint.ActivePresentations.Close 
```

但我不断收到一大堆错误消息。我在另一个模块中将 newPowerPoint 定义为公共

```
Public newPowerPoint As powerpoint.Application 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:06:44.110

我认为您在没有实际创建 Powerpoint.Application 实例的情况下确定变量 oPPTApp 的尺寸。

```
Public ppApp As PowerPoint.Application

Sub PPTFile()

Dim ppPres As Presentation
Dim fileNameString As String

fileNameString = "C:\testPPT.pptx" '<change to your file path/name

'Create an instance of PPT to work with
Set ppApp = CreateObject("Powerpoint.Application")
ppApp.Visible = True

'Create a new presentation (or you can access an existing file with ppApp.Presentations.Open
Set ppPres = ppApp.Presentations.Add

'Save:
ppPres.SaveAs fileNameString, 1

'Quit the instance of PPT that you initiated above.
ppApp.Quit

End Sub 
```

**编辑**

当您使用 AddSlide 方法添加幻灯片时，您需要参考`CustomLayout`.

```
Dim sldCount As Integer

sldCount = ppPres.Slides.count
ppPres.Slides.AddSlide sldCount + 1, ppPres.Slides(sldCount).CustomLayout
'Once you've added the slide, then set using Layout:
ppPres.Slides(sldCount + 1).Layout = ppLayoutBlank 
```

或者，您可以使用接受参数的旧`.Add`方法，而不是（需要自定义布局）：`Layout``.AddSlide`

`ppPres.Slides.Add sldCount + 1, ppLayoutBlank`

# jms - JBOSS AS 7 JMS 配置

> ID：15621320
> 
> 赞同：1
> 
> 时间：2013-03-25T17:43:38.207
> 
> 标签：jms, jboss7.x, activemq

我是 JMS 的新手，我面临以下问题：

我在远程机器上有一个活动的 MQ 代理。

我在 JBOSS AS 7 服务器中有消息发送者和消费者。如何将 jboss 中的资源适配器配置为 7 以从远程活动 mq 发送和接收消息？

在 ra.xml 和 iron-jacamar.xml 中做了哪些不同的配置？以及在资源适配器子系统下要进行的配置是什么？

在哪里配置远程服务器 url 以建立连接？

我尝试了以下来源：

[http://blog.coffeebeans.at/?p=230](http://blog.coffeebeans.at/?p=230)

但我得到错误：

BAS014809: 一个节点已经注册在'(deployment => activemq-rar-5.5.1.rar)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T12:55:55.297

ra.xml 是符合规范的通用文件。ironjacamar.xml 是 IronJacamar 的描述符，它是 JBoss 的 JCA 实现。

听起来您同时部署了 .rar 文件和 .rar 文件夹。你应该只有一个。

# java - FTPSClient 返回 MalformedServerReplyException：无法解析响应代码

> ID：15621325
> 
> 赞同：5
> 
> 时间：2013-03-25T17:43:51.600
> 
> 标签：java, apache-commons, ftps

我设置了 SFTP 连接。我使用了 WinCSP 和 Filezilla，测试服务器运行没有问题。java代码来自`apache commons-net 2.0`，它给了我意想不到的错误

**代码**

```
private String ftpServer="XXX.xx.x.XX";
private int ftpPort=99;
private String ftpUserName="myUserName";
private String ftpPassword="myPassword";

FTPSClient ftp = null;
        try{
            ftp = new FTPSClient();
            ftp.connect(hostname, port)
        } catch (Exception e){
           Logger.debug(e)
        } 
```

**堆栈跟踪**

```
Server reply:SSH-2.0-WeOnlyDo-wodFTPD 2.3.6.165
org.apache.commons.net.MalformedServerReplyException: Could not parse response code.
at org.apache.commons.net.ftp.FTP.__getReply(FTP.java:315)
    at org.apache.commons.net.ftp.FTP._connectAction_(FTP.java:364)
    at org.apache.commons.net.ftp.FTPClient._connectAction_(FTPClient.java:540)
    at org.apache.commons.net.ftp.FTPSClient._connectAction_(FTPSClient.java:167)
    at org.apache.commons.net.SocketClient.connect(SocketClient.java:178)
    at myHomeFtpService.getFtpConnection(HomeFtpService.java:40) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-25T18:10:58.060

由于您使用 FTP 客户端连接到 SSH 服务器。FTPS 和 SFTP 是两种不同的协议。

WinSCP 和 Filezilla 都可以正常工作，因为它们支持 SFTP。

# iphone - 基于在 UIview 中移动的触摸对 UIImage 视图进行平移和缩放（UIImage 视图的子视图）

> ID：15621333
> 
> 赞同：-2
> 
> 时间：2013-03-25T17:44:24.230
> 
> 标签：iphone, ios, xcode

我正在开发一个白板应用程序。我有一个 UIimage 视图，这个视图包含一个 UIview 作为子视图。这个 UIview 被用于中间操作，比如（在绘制矩形期间......触摸移动期间）在触摸结束后我最终在 UIImage 视图上绘制它。现在我必须平移和缩放这个 UIimage 视图，如果在 UIview 上单击一次平移和两个手指触摸进行缩放，并且此触摸点不位于 UIImage 视图上的任何绘制组件上。请建议我怎么做...？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:31:15.037

我相信您想要做的事情可以使用`UIScrollView`. 当您`UIImageView`嵌入 a`UIScrollView`时，它可以执行您在问题中提到的平移/缩放。

请参阅`UIScrollView`文档：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html)

另外，这是我在 StackOverflow 上找到的一个线程，其中列出了一些帮助您入门的教程： [网络上有什么好的 UIScrollView 教程吗？](https://stackoverflow.com/questions/820557/are-there-any-good-uiscrollview-tutorials-on-the-net)

# ruby-on-rails - Capybara 的现有测试 + 使用 Selenium 对远程服务器运行测试

> ID：15621334
> 
> 赞同：0
> 
> 时间：2013-03-25T17:44:32.117
> 
> 标签：ruby-on-rails, testing, selenium, rspec, capybara

首先，请原谅我的英语不好，并执行我的知识湖，我对 Web 开发完全陌生。

我写了一些测试（Capybara & Rspec），我试图在远程服务器上运行它们。我知道这是可能的，因为我在 Capybara 文档中读到了这个：

*“通常 Capybara 期望测试一个进程内 Rack 应用程序，但您也可以使用它与在 Internet 上任何位置运行的 Web 服务器通信”*

从最近两天开始，我一直在尝试对远程服务器运行测试，但没有运气。我什至在stackoverflow中读到我应该使用以下内容：

```
 Capybara.default_driver = :selenium
    Capybara.app_host = 'http://www.google.com' 
```

但我真的不知道在哪个文件中！它不是我应该写的，正如我所说，我对 Web 开发真的很陌生。

我什至没有找到适合初学者的教程来教如何设置 Selenium 来负责针对远程服务器而不是本地运行测试！

任何帮助将非常感激 ！

PS：

不，我不是试图点击横幅（正如一些人在 IRC 频道上所想的那样），我试图这样做是为了获得工作机会 :) 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:23:35.533

该配置通常会进入`spec/spec_helper.rb`.

# python - Raspberry Pi：使用 IF 环路检测相机，gphoto2

> ID：15621339
> 
> 赞同：3
> 
> 时间：2013-03-25T17:44:48.180
> 
> 标签：python

我正在尝试找到一种方法来检测是否为 gphoto2 找到了相机。

我已经在 gphoto2 论坛上发帖，但我想我也会在这里尝试。可以发出命令 gphoto2 --auto-detect，它会列出检测到的相机。

我正在运行一个大型 python 脚本，该脚本曾调用 gphoto2 拍照并下载图像。我想找到一个可以放入 IF 循环的语句，如果检测到相机，则只有在进入循环后才会发出拍照和下载图像命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:08:53.327

[快速谷歌揭示了 gphoto2 http://magiclantern.wikia.com/wiki/Remote_control_with_PTP_and_Python](http://magiclantern.wikia.com/wiki/Remote_control_with_PTP_and_Python)的 python 绑定。

其他变体是调用控制台命令，即

```
from subprocess import call
call(["gphoto2", "--auto-detect"]) 
```

在您放弃之前，您将等待相机检测到多长时间，这取决于您。

如果您要使用循环，请记住放入一些 sleep 命令。

```
timeout = time.time() + 60
detected = False
while time.time() < timeout:
    if is_device_available():
        detected = True
        break
    # maybe show some feedback why he has to wait
    time.sleep(1)
if not detected:
    raise Exception('Camera device not detected') 
```

# c - 破碎选择排序 C

> ID：15621343
> 
> 赞同：1
> 
> 时间：2013-03-25T17:45:23.227
> 
> 标签：c, arrays, sorting

我正在研究选择排序。

我的问题是，如果你从“void sort”中删除我的所有代码，程序就会运行。一旦你把所有的代码放回去，“void sort”甚至不会进入“void sort”中的第一个“printf”函数。我不知道是什么把一切都挂了。

这里的第二个问题是这个函数*应该*这样做：

*使用 vars 遍历数组 []：x（起点，） temp（临时最低数字）和 k（当前数字）。它应该——对于每次迭代——从 x 开始，设置 temp = x，设置 k = ( x+1) 然后 k++ 直到它到达数组的末尾。如果 array[k] 小于 array[temp] 它应该设置 temp 等于 k。然后在最后：交换 array[x] 和 array[temp] 并从 (x+1) 重新开始*

当它之前工作时，我得到的唯一结果是 x = 7 （列表的末尾），它只会打印最后一个数字。:/ 做什么

此外，不需要但次要的问题，我到底如何从 void 函数返回排序数组？全局变量？还要别的吗？

```
#include <stdio.h>
#define SIZE 8

void sort(int array[], int size)
{
    printf("starting sort, declaring vars...");
    int temp, placeholder, x, k;
    printf("setting x...");
    x = 0;
    printf("size(%d), i(%d)", size, x);
    printf("starting sort loop...");
    while (x < (size - 1));
    {
        k = (x + 1);
        temp = x;
        while(k < size)
        {
            if(array[k] < array[temp])
                temp = k;
            k++;
        }
        printf("array[%d] is %d from array[%d]\n", x, array[temp], temp);
        placeholder = array[temp];
        array[temp]= array[x];
        array[x] = placeholder;
        printf("%d ", array[x]);
        x++;
    }
    printf("\n");
}

int main(void)
{
    int numbers[SIZE] = {4, 15, 16, 50, 8, 23, 42, 108 };
    int i;
    for (i = 0; i < SIZE; i++)
        printf("%d ", numbers[i]);
    printf("\ncounted and sorting...\n");
    sort(numbers, SIZE);
    for (int i = 0; i < SIZE; i++);
        printf("%d", numbers[i]);
    printf("\n");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:01:30.453

我不知道这是否是编写问题或代码中的错误，但是

```
while (x < (size - 1)); 
```

是不正确的。它什么也不做，所以会无限循环。取出分号以获得预期的效果。相似地，

```
for (int i = 0; i < SIZE; i++); 
```

不应该有那个分号。此外，您不能`i`在适当的 C 中声明，并且`i`已经声明，因此最好将其保留在`for (i = 0; ...`.

# carrierwave - 如何使用条件逻辑执行 Cloudinary 转换？

> ID：15621347
> 
> 赞同：1
> 
> 时间：2013-03-25T17:45:34.400
> 
> 标签：carrierwave, cloudinary

我正在将载波上传器转换为使用 Cloudinary。我有几个像这样的方法，它们以 Cloudinary 格式输出哈希，但不幸的是，在版本块内部，您无法访问外部方法。我想知道就云计算而言，最好的方法是什么，或者是否有可能。

```
def custom_crop
  if model.cropping?
    cloudinary_transformation({x: model.crop_x.to_i,
     y: model.crop_y.to_i,
     width: model.crop_w.to_i,
     height: model.crop_h.to_i,
     crop: :crop})
  end
end

def watermark
  if model.respond_to?(:watermarking?) && model.watermarking?
    cloudinary_transformation({overlay: "watermark_x8b0vp",
     gravity: :south_east,
     x: 0,
     y: 106})
  end
end 
```

我理想地想要运行的代码是这样的：

```
version :cropped_original do
  process :custom_crop
  process :watermark
  resize_to_fill(81, 50, :center)
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T15:13:38.043

您可以从流程方法返回您需要的转换。但是，在这种情况下，您可能希望将它们链接起来。你这样做如下：

```
def custom_crop_and_watermark
  transformation = []
  if model.cropping?
    transformation << {x: model.crop_x.to_i,
     y: model.crop_y.to_i,
     width: model.crop_w.to_i,
     height: model.crop_h.to_i,
     crop: :crop}
  end
  if model.respond_to?(:watermarking?) && model.watermarking?
    transformation << {overlay: "watermark_x8b0vp", gravity: :south_east, x: 0, y: 106}
  end
  {:transformation=>transformation}
end 
```

# sql - 在phonegap中插入重复键

> ID：15621351
> 
> 赞同：0
> 
> 时间：2013-03-25T17:45:40.347
> 
> 标签：sql, sqlite, cordova

是否有一些东西可以作为 MySQL 中重复键的插入插入到 SQLite 中？

在 PhoneGap 中，“ON DUPLICATE”出现 SQL 语法错误。我不想在插入之前查找每个项目。

我的代码：

```
$.each(jsondata, function(i, item) {
    tx.executeSql('INSERT INTO Pricelist2 (id, name,desc,make,price) '+
                  'VALUES ('+jsondata[i].id+', '+
                           '"'+data[i].name+'", '+
                           '"'+jsondata[i].description+'", '+
                           '"'+jsondata[i].make+'", '+
                           '"'+jsondata[i].price+'")'+
                  ' ON DUPLICATE KEY UPDATE '+
                      'desc=\''+jsondata[i].description+'\','+
                      'price=\''+jsondata[i].price+'\';');
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:26:25.560

您只能使用[SQLite 实际支持的语法](http://www.sqlite.org/lang_insert.html)。

对于这个特定问题，`INSERT OR REPLACE`可能是您想要的：

```
tx.executeSql('INSERT OR REPLACE INTO Pricelist2(id,name,desc,make,price)'+
              'VALUES (?,?,?,?,?)',
              [jsondata[i].id,
               data[i].name,
               jsondata[i].description,
               jsondata[i].make,
               jsondata[i].price]); 
```

（如果记录已经存在，`name`也`make`将被替换。）

# jquery - 如何使用 jQuery 从外部页面从特定类加载 div 元素？

> ID：15621353
> 
> 赞同：1
> 
> 时间：2013-03-25T17:45:44.383
> 
> 标签：jquery, html

我想`<h3>`从外部网站定义类的 div 加载元素。我特别想获得标题。外部网站不是我的，我可以更改其 html 中的任何内容。这个网站的部分html是这样的

```
<div id="container">

<!-- some other divs -->
<div class="content sub">

    <div class="box blog">
        <h3><a href="http://www.somelink.com/page1/" title="">Title 1</a></h3> 
        <p>Some text here... bla bla bla...</p>
        <a href="http://www.somelink.com/page1/" title=""  class="read_more">read more</a>
    </div>  

        <div class="box blog">
        <h3><a href="http://www.somelink.com/page2/" title="">Title 2</a></h3> 
        <p>Some text here... bla bla bla...</p>
        <a href="http://www.somelink.com/page2/" title=""  class="read_more">read more</a>
    </div>

        <div class="box blog">
        <h3><a href="http://www.somelink.com/page3/" title="">Title 3</a></h3> 
        <p>Some text here... bla bla bla...</p>
        <a href="http://www.somelink.com/page3/" title=""  class="read_more">read more</a>
    </div>
</div>
</div> 
```

我想在 jQuery Mobile 页面中加载标题 - 在其内容 div 中。

有没有办法做到这一点？

# javascript - 输入字段清除按钮导致模糊事件 - 如何避免

> ID：15621356
> 
> 赞同：3
> 
> 时间：2013-03-25T17:45:50.797
> 
> 标签：javascript, jquery, css

我正在构建一个带有“清除值”按钮的表单字段 - 就像在 iOS 上一样，您可以点击一个小“X”图标来清除您的搜索字符串。

我的问题是：我使用字段的模糊事件对输入格式进行错误检查，而我对“X”图标的实现总是触发模糊事件。

我很困惑：如果我将图标作为背景图像放在输入字段中，我不再有点击目标，如果我在字段顶部使用标准 div 或 img 分层，当然会触发模糊。

我正在使用 jQuery，但这可能是一个通用的 CSS/javascript 问题。

例如这里接受的解决方案：[输入文本内的清除图标](https://stackoverflow.com/questions/6258521/clear-icon-inside-input-text) ，这是原始意图的一个很好的例子，但这也会在您附加一个时触发模糊事件。

**更新：** 似乎最好的方法是使用错误检查功能 - 但我不喜欢它，所以我一直在寻找......结果我不知道`contenteditable`HTML5 中的属性。

除了不使用表单字段作为表单数据的明显可访问性问题，以及忘记不能执行 HTML5 的老式浏览器之外，还有什么理由不使用 contenteditable div 标签重新创建输入字段？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:07:20.787

与其试图避免模糊事件，为什么不从输入验证功能中排除这种情况（X 点击）？有几种方法可以做到这一点，例如，在悬停时，您可以`var doExclude`设置为 true。在你的验证函数中，当模糊事件触发时，它可以在函数的其余部分之前首先检查这个：

```
if (exclude) return; 
```

X 完成后，您可以根据需要将焦点返回到您的输入`$('input').focus();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:06:01.243

这里有很多选择

*   您可以更改触发器以验证“keyup”或检查“提交”错误
*   使用[jquery 验证插件](http://docs.jquery.com/Plugins/Validation)
*   在`$('#X-icon').click(fn)`您也可以清除/隐藏错误消息。所以用户不会看到错误信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T18:09:09.413

hacky 并且可能不是首选的东西是您`setTimeout`在 blur 事件中使用，以便您延迟代码运行 100 毫秒（或多长时间）。在 100 毫秒内，应该已经点击了“清除”按钮。如果不是，则运行正常的错误检查/格式化。如果它已被单击，请清除输入的文本并且不要执行正常`blur`事件。

这是一个示例，使用您发布的链接中的样式（[输入文本内的清除图标](https://stackoverflow.com/questions/6258521/clear-icon-inside-input-text)）：

```
$(document).ready(function() {
    var clearTextTimeout;

    $("#data_field").on("blur", function () {
        var $that = $(this);
        clearTextTimeout = setTimeout(function () {
            console.log("would be error checking and formatting text");            
        }, 100);
    });

    $("#data_field_clear").on("click", function () {
        clearTimeout(clearTextTimeout);
        console.log("clearing text");
        $("#data_field").val("");
    });
}); 
```

[http://jsfiddle.net/37Pxw/](http://jsfiddle.net/37Pxw/)

观察浏览器的控制台，您会看到错误检查/格式化仅在您不单击“清除”按钮时运行。将数字减少到`50`而不是 . 可能是安全的`100`。

这是有效的，因为“清除”按钮的`click`事件将在输入`blur`事件之后立即运行，因此可以安全地假设如果`click`事件没有在输入`blur`事件的 100 毫秒 (50) 内运行，则它没有被点击。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T19:33:37.917

我正在像这样解决我的问题（我非常不喜欢输入标签*）*：

```
<!DOCTYPE html>
<html>
<script src="http://code.jquery.com/jquery-1.9.0.js"></script>
<script>
$(function(){

$('div[contenteditable]').on('blur', function(){
alert('d');
});
$('div[contenteditable] > img').on('click', function(){
$(this).parent().text('');
});

});
</script>
<style>
div[contenteditable] { border:1px solid #009; position:relative;}
img {position:absolute; top:2px; right:2px; cursor: pointer;}
</style>
<body>

<div contenteditable="true">default value<img src="/" width="10" height="10" /></div>

</body>
</html> 
```

# ruby-on-rails-3 - flash[:notice] 不适用于 redirect_to

> ID：15621364
> 
> 赞同：4
> 
> 时间：2013-03-25T17:46:59.407
> 
> 标签：ruby-on-rails-3

我从控制器状态使用：

```
 flash[:notice] = 'message'
  redirect_to(controller: 'item', action: 'list') 
```

我不知道为什么通知没有出现。

我尝试并检查了很多东西：

1.  `flash.keep`
2.  `flash.keep[:notice] = 'message'`
3.  `flash[:notice]`工作正常`render`
4.  `redirect_to(controller: 'item', action: 'list', notice: 'message')`
5.  `flash.now[:notice] = "Hello world"`
6.  `flash.now['foo'] = "Hello world"`在`<%= flash['foo'] %>`视图中
7.  布局中有一个 <%= flash[:notice] %>

我将以下代码放入布局中。当我控制器方法有一个同名的视图时，flash[:notice] 工作正常。当我尝试访问另一个没有视图的控制器时，就会出现问题。

```
<% if !flash[:notice].blank? %>
    <div class="notice">
        <%= flash[:notice] %>
    </div>
<% end %>

<% if !flash[:alert].blank? %>
    <div class="alert">
        <%= flash[:alert] %>
    </div>
<% end %> 
```

任何人都可以帮忙吗？

信息：

*   红宝石 (2.0.0)
*   导轨 (3.2.13)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:15:19.233

Railsguide：[http ://guides.rubyonrails.org/action_controller_overview.html#the-flash](http://guides.rubyonrails.org/action_controller_overview.html#the-flash)

这应该工作得很好：

```
flash[:notice] = "My message"
redirect_to root_url 
```

或者：

```
redirect_to root_url, notice: "Hello world" 
```

但是，您也可能忘记在视图中呈现通知。因此，您看不到任何通知。

例如，您应该认为这样的事情：

```
<% if flash[:notice] %>
  <p class="notice"><%= flash[:notice] %></p>
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:59:17.873

我不知道发生了什么。

我更新到 ruby​​ 2.0.0，它又开始工作了......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:01:19.507

尝试使用

```
flash.now['foo'] = "Hello world" 
```

# sockets - 在 DataGridView 中不显示网络流的连续数据

> ID：15621366
> 
> 赞同：0
> 
> 时间：2013-03-25T17:47:03.953
> 
> 标签：sockets, c#-4.0, network-programming, ethernet

能够通过 TcpClient 类和方法从设备读取数据如下。

一旦我通过以太网连接使用 Ipaddress 和端口建立连接，就可以读取数据字节。我的读取方法读取特定字节数的网络流数据并根据需要修剪字符串并更新到数据库并尝试在datagridview中显示更新的数据。它不会在datagridview中显示任何数据。

任何人都可以建议我该怎么做？

添加代码：

```
 private void ReceiveMethod()
           {
           try
          {
               string IP1 = textIP.Text.Trim();
               string port1 = textPort.Text.Trim(); 
               int port = Convert.ToInt32(port1);
               NetworkStream ns;
               int bytesRead = 0;
               byte[] buffer = new byte[9];

            try
            {

                IPAddress ipAddress = System.Net.IPAddress.Parse(Ip1);
                client = new TcpClient();
                client.Connect(IP1, port);
                while (true)
               {
                    ns = client.GetStream();
                    ns.Read(buffer, (int)bytesRead, buffer.Length - (int)bytesRead);

                      ASCIIEncoding encoder = new ASCIIEncoding();
                     msg = encoder.GetString(buffer);
                     GetData(msg);                        

                }
                client.Close();         

            }

    GetData(string data)
    {

       I'm trimming the data value according to my need
       and the updateing one filed of db and trying to populate table data in gridview

      //if i remove the while(true) in the Receivemethod am able to view the data in
         datagridview but i want to read continuous data from network stream and want 
         to show updated data in datagrid view
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T02:25:15.277

可能是您没有将网络流数据转换为 sring 并且所有数据都转换为 DataRow 类。

1.  你用什么数据库？（SQL 服务器/甲骨文）
2.  您将网络流数据放在什么类型的数据中？
3.  显示您填写 DGV 的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T02:59:20.960

```
 foreach(NetworkStream s in ns)
   {
      GetData(string data);
   } 
```

# forms - 表单集合错误冒泡

> ID：15621368
> 
> 赞同：3
> 
> 时间：2013-03-25T17:47:11.523
> 
> 标签：forms, symfony, collections

您好，我在表单中收集文本字段时遇到问题。当其中一个字段出现错误时，这些错误会冒泡到父表单中，因此它们不会分配给字段，而是分配给父级本身。它是以下代码中的“点”集合。我试图将 error_bubbling 设置为 false，但它没有效果。

```
 <?php
    namespace JamaLvova\AdminBundle\Form\Type;

    use Symfony\Component\Form\AbstractType;
    use Symfony\Component\Form\FormBuilderInterface;
    use Symfony\Component\OptionsResolver\OptionsResolverInterface;
    use JamaLvova\AdminBundle\Form\Type\ExercisePointsFormType;

    class StartContestFormType extends AbstractType
    {
        public function buildForm(FormBuilderInterface $builder, array $options)
        {

            $builder->add('startYear', 'hidden')
                   /*
                       some other form elements
                   */
                    ->add('points', 'collection', array(
                        'type' => 'text',
                        'allow_add' => true,
                        'label' => 'Body za jednotlivé úlohy:',
                        'error_bubbling' => false,
                        'options' => array(
                            'error_bubbling' => false,
                            'attr' => array("maxlength" => "4", "size" => "4")
                        )
                        ));
        }

        public function setDefaultOptions(OptionsResolverInterface $resolver)
        {
            $resolver->setDefaults(array(
                'data_class' => 'JamaLvova\AdminBundle\Form\StartContestForm',
            ));
        }

        public function getName()
        {
            return 'startContestForm';
        }
    } 
```

在 StartContestForm 我有这样写的 $points 属性：

```
 /**
     * @Assert\Type(type="integer", message="Hodnota {{ value }} není celé číslo.")
     * @Assert\Range(
     *      min = "0",
     *      max = "",
     *      minMessage = "Body nemohou být záporné",
     *      maxMessage = "Příliš mnoho bodů"
     * )
     */
     private $points; 
```

在我遍历 form.points 的树枝模板中，没有字段有错误，但 form.points 有。有谁知道问题可能出在哪里？还是我错过了什么？非常感谢 :-) (Symfony v. 2.1.4)

**编辑：**似乎如果我使用表单集合（'type' => new PointsFormType()）而不是那个'type' =>'text'，它会按预期工作。这是否意味着我总是需要使用表单集合才能将错误分配给某些字段？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-10T22:32:14.300

您可能需要添加`cascade_validation' => true`

```
$builder->add('startYear', 'hidden')
       /*
           some other form elements
       */
        ->add('points', 'collection', array(
            'type' => 'text',
            'allow_add' => true,
            'label' => 'Body za jednotlivé úlohy:',
            'error_bubbling' => false,
            'cascade_validation' => true,
            'attr' => array("maxlength" => "4", "size" => "4")
        ));
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-02-17T16:08:29.387

请小心，因为该`cascade_validation`属性已从 Sf3 中删除：[http://symfony.com/doc/2.8/reference/forms/types/collection.html#cascade-validation](http://symfony.com/doc/2.8/reference/forms/types/collection.html#cascade-validation)

> cascade_validation 选项在 Symfony 2.8 中已被弃用，并将在 3.0 中删除。相反，请在模型中使用 Valid 约束来级联验证。请注意，validation_group 选项不会被考虑用于子表单。

# vim - vim 禁用自动解压

> ID：15621379
> 
> 赞同：3
> 
> 时间：2013-03-25T17:48:00.863
> 
> 标签：vim

我想查看压缩文件的二进制文件。也就是说，我想看看标题之类的东西。每当我这样做`vim myfile.Z`时，当然会解压缩它（这通常是我想要的）。我怎样才能禁用它（最好是某种命令行参数或其他东西，这样我就不必来回编辑我的 .vimrc 文件）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T07:33:43.223

Vim 初始化后，可以通过以下方式禁用*gzip 插件*

```
:autocmd! gzip 
```

如果您只想禁用单个文件的特殊处理，我会使用

```
:noautocmd edit myfile.Z 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:50:48.747

如果将此行添加到您的`.vimrc`

```
:let loaded_gzip = 1 
```

# php - 你能用php过滤MySQL变量吗？

> ID：15621389
> 
> 赞同：0
> 
> 时间：2013-03-25T17:48:48.707
> 
> 标签：php, mysql, sql, mysqli

我正在使用 $_GET 变量从 MySQL 数据库中提取以填充动态页面。一些变量具有必须过滤掉才能用作 url 的特殊字符。但是，当从 url 中提取变量时，由于缺少字符，新字符串将与数据库变量不匹配。有没有办法在 MySQL 查询中从数据库中过滤变量，然后再尝试将其与字符串匹配？前任：

column_name = "ProductName™"
$GETvariable = "ProductName"

```
SELECT * FROM table_name WHERE str_replace($array_of_characters, '', column_name) = '$GETvariable'; 
```

以上不起作用，但是有类似的东西吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:19:25.390

你做错了。

1.  将 URL 与数据库匹配的最佳方法是在 URL 中使用**唯一 ID**，就像 Stack Overflow 所做的那样：
    [stackoverflow.com/questions/15621389/curiosity-got-destroed-by-martians](https://stackoverflow.com/questions/15621389/curiosity-destroed-by-martians)
    尽管标题发生了变化，但它**总是**指向正确的页面
2.  如果您仍然想使用像slugified标题这样不可靠的来源来识别您的页面，**唯一**的方法是**将slugified版本存储在数据库中**

# java - 以交互方式显示几何图形中形状数量的 Java 程序

> ID：15621390
> 
> 赞同：0
> 
> 时间：2013-03-25T16:20:25.287
> 
> 标签：java

我有这个 java 程序，它应该显示三角形、梯形和六边形的几何形状的边数。我设法创建了代码，这样当我运行 java Shape 时，它​​会同时显示所有形状和侧面，但我想让它具有交互性，以便可以提示用户输入她想要的形状并返回它的边数，Java 中的哪个功能最能做到这一点？

```
public abstract class Shape {

    public abstract void numberOfSides();

    public static void main(String[] args)
    {
        System.out.println("The Geometrical characteristics of the figures are as follows");

        Trapezoid t=new Trapezoid();
        Triangle tg=new Triangle();
        Hexagon h=new Hexagon();
        t.numberOfSides();
        tg.numberOfSides();
        h.numberOfSides();
    }
}
class Trapezoid extends Shape {
    public void numberOfSides()
    {
        System.out.println("Trapezoid~It is geometrical figure with an attribute of 4 sides (Of which two are parallel and with no angles)");
    }
}
class Triangle extends Shape {
    public void numberOfSides()
    {
        System.out.println("Triangle~It is geometrical figure with an attribute of 3 sides");   
    }
}   
class Hexagon extends Shape {
    public void numberOfSides()
    {   
        System.out.println("Hexagon-It is geometrical figure with an attribute of 6 sides");
    }
} 
```

这是我在上面尝试实施后的新线，它说存在错误，过时的方法..

```
import java.io.*;
 public abstract class Shape {

    public abstract void numberOfSides();

    public static void main(String[] args) 
    {  
        System.out.println("Enter the name of the Shape");
        BufferedReader br = new BufferedReader (new InputStreamReader(System.in));
        try {
        String shapeName = br.readLine();

        if (br.equals ("Trapezoid"))
                {Trapezoid t = new Trapezoid();
                t.numberOfSides();
                }
        else if (br.equals ("Triangle"))    
                {Triangle tg = new Triangle();
                tg.numberOfSides();
                }
        else if (br.equals ("Hexagon")) 
                {Hexagon h = new Hexagon();
                h.numberOfSides();
                }
                }    
}
class Trapezoid extends Shape {
    public void numberOfSides()
{
        System.out.println("Trapezoid~It is geometrical figure with an attribute of 4 sides (Of which two are parallel and with no angles)");
}
}
class Triangle extends Shape {
    public void numberOfSides()
{
        System.out.println("Triangle~It is geometrical figure with an attribute of 3 sides");   
}
}   
class Hexagon extends Shape {
    public void numberOfSides()
{   
        System.out.println("Hexagon-It is geometrical figure with an attribute of 6 sides");
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:47:06.937

要从用户那里读取输入，您需要使用 Buffered Reader。然后，您需要根据用户输入有条件地调用您的方法。

前任。

```
System.out.println("Enter the name of the shape");
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
String shapeName = br.readLine();

if(br.equals("Trapezoid") {
   Trapezoid t = new Trapezoid();
   t.numberOfSides();
}
//... 
```

一旦您编写了该代码，您就可以实现一个菜单供用户选择他们想要的形状。代码看起来像这样。

```
System.out.println("Select one of the following shapes. \n 1) Trapezoid \n 2) Triangle \n 3) Hexagon");
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
String shapeName = br.readLine();

if(br.equals("Trapezoid" || br.equals("1") {
   Trapezoid t = new Trapezoid();
   t.numberOfSides();
}
// ... 
```

# c# - 类型“System.Data.Linq.DataContext”在未引用的程序集中定义

> ID：15621394
> 
> 赞同：12
> 
> 时间：2013-03-25T17:49:00.013
> 
> 标签：c#, linq, asp.net-mvc-4, web-config, .net-assembly

**问题**

转到特定页面时出错（在本地调试中）：CS0012：“System.Data.Linq.DataContext”类型在未引用的程序集中定义。您必须添加对程序集“System.Data.Linq，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”的引用。

以下是错误消息中引用的代码行：

第 28 行：
第 29 行：
第 30 行：公共类 _Page_Views_blah_granny_cshtml：System.Web.Mvc.WebViewPage {
第 31 行：
第 32 行：#line hidden

所有其他页面都运行良好 - 这只发生在特别是访问一个页面时。该参考适用于所有其他页面。据我所知，这不是参考的问题。

我花了很多时间研究这个问题。

我找到的所有答案都建议转到 web.config 并在 system.web > 配置 > 程序集中放置对 linq 的程序集引用。我的没有列出程序集，我怀疑这更适用于旧版本。反正我做到了。它给了我另一个错误，说它不知道如何处理程序集。

我删除了 system.data.linq 并再次添加它。

我重新启动了 VS 和我的计算机。

我的代码（由 VS 默认生成）具有 System.Linq。

**背景 - 这是如何开始的：**

该应用程序是 MVC 4，C#。

我在 DataContext 中创建了一个新类，添加了一个新控制器，并创建了一个强类型视图。

这是一些非常相似的代码（可能不需要，但以防万一）。

两个班：

```
public class granny { 
            public string data { get; set; }
            public string criteria { get; set; }
}

public List<granny> getGranny() {
    var a = from x in grannytable
            join dx in anothertable
            on x.criteria equals dx.criteria
            select new granny {
                data = x.somenewdata;
            }; 
    return a.ToList();
} 
```

这是控制器：

```
 public ActionResult granny() {
        return View(db.getGranny());
    } 
```

那里没什么好看的。

该页面是一个典型的剃须刀视图，强类型“列表”......它有一个表，它可以迭代创建，并在它运行时转储数据。

我很乐意根据需要提供任何其他代码。

我没有弄乱web.config。我没有删除或调整页面上的任何参考。所有其他观点都非常有效。

当我在本地运行它并尝试转到 /granny 时，出现上述错误。

谢谢你的帮助！

**解决方案**：我参考了 System.Linq（或者对于旧版本，我想是 System.Data.Linq）并将 CopyLocal 更改为 True。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2015-12-18T13:34:22.810

这对我有用：

*   导航到 Web 项目的 References 节点
*   找到对 System.Data.Linq 的引用
*   打开 VS 属性窗口
*   在属性窗口中，将 Copy Local: False 更改为 True

在此之前，System.Data.Linq.dll 没有被复制到 bin 目录中。（手动复制到bin目录也解决了这个错误）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-03T07:47:38.840

尝试`@using System.Data.Linq`在问题视图的顶部 添加`<add namespace="System.Data.Linq" />`到**Views**文件夹`<pages>`中的 web.config 部分。

 *** * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-04-03T19:56:37.833

MVC 无法即时编译您的视图。看起来您的视图包含对 DataContext 的引用。在 web.config 中添加引用应该告诉编译器查找文件：

```
<configuration> 
 <system.web>
  <compilation targetFramework="4.0"> 
    <assemblies> 
      <add assembly="System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/> 
   </assemblies> 
</compilation> 
```

注意：程序集应添加到编译元素下。

你能分享你的视图、控制器和数据上下文代码吗？**

# vbscript - VBscript 相对路径

> ID：15621395
> 
> 赞同：5
> 
> 时间：2013-03-25T17:49:02.710
> 
> 标签：vbscript

我正在尝试使用以下脚本（顺便说一下，它被批处理文件调用）在 Windows XP 中解压缩文件：

```
strZipFile ="C:\test.zip"                        'name of zip file
outFolder = "C:\"                                'destination folder of unzipped files

Set objShell = CreateObject( "Shell.Application" )
Set objSource = objShell.NameSpace(strZipFile).Items()
Set objTarget = objShell.NameSpace(outFolder)
intOptions = 256
objTarget.CopyHere objSource, intOptions 
```

问题是，我打算在哪里使用它，我不知道 zip 文件的完整路径，我只知道它将与 VBScript 位于同一个文件夹中，因此，考虑到这一点，我会可以用相对路径调用它吗？例子：

```
strZipFile ="test.zip" 
```

不过，这个例子不起作用（它给出了一个错误“需要对象：'objShell.NameSpace(...)'”），所以我的意思当然是那些可以工作的东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T18:00:49.580

WScript.ScriptFullName and FSO.GetParentFolder should solve your problem:

```
>> p = CreateObject("Scripting.FileSystemObject").GetParentFolderName(WScript.ScriptFullName)
>>
>> WScript.Echo p
>>
M:\bin 
```

**Update wrt Kiril's comment:**

Evidence for the answer "Yes":

```
Option Explicit

Class cX
  Private Sub Class_Initialize()
    WScript.Echo "Class_Initialize"
  End Sub
  Private Sub Class_Terminate()
    WScript.Echo "Class_Terminate"
  End Sub
  Public Function f()
    f = "qed"
  End Function
End Class

WScript.Echo 1
Dim f : f = (New cX).f()
WScript.Echo 2
WScript.Echo f 
```

output:

```
cscript 15621395.vbs
1
Class_Initialize
Class_Terminate
2
qed 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-25T18:09:33.777

这应该为您提供 zip 文件的完整路径：

```
strZipFile ="test.zip" 
dim fso, fullPathToZip
set fso = CreateObject("Scripting.FileSystemObject")
fullPathToZip = fso.GetAbsolutePathName(strZipFile) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-20T03:42:49.900

当发生“找不到文件错误”时，在您尝试通过相对路径从脚本目录（或其子文件夹）读取数据文件的情况下，通常的问题是假设当前目录是脚本目录。根据脚本的启动方式，当前目录可能是 C:\Windows\System32（WScript.exe、CScript.exe、MSHTA.exe 的位置）或调用脚本的任何目录（例如，如果从另一个脚本运行）或通过命令行）。

以下代码使用与接受的答案相同的方法将当前目录设置为脚本的目录（第 4 行）。完成后，您可以通过相对路径可靠地读取数据文件。如果数据文件位于脚本目录的子文件夹中，则需要一个点前缀（例如“.\data\myfile.txt”）。如果数据文件在脚本目录中，则根本不需要前缀，但我通常使用“.\”。

```
Const ForReading = 1
Set oWSH = CreateObject("WScript.Shell")
Set oFSO = CreateObject("Scripting.FileSystemObject")
oWSH.CurrentDirectory = oFSO.GetParentFolderName(WScript.ScriptFullName)
DataFile = ".\myfile.txt"
Set oFile = oFSO.OpenTextFile(DataFile,ForReading)
Data = oFile.ReadAll
oFile.Close
WScript.Echo Data 
```

# php - Magento - 如何从根类别之外的类别中获取产品

> ID：15621401
> 
> 赞同：1
> 
> 时间：2013-03-25T17:49:15.070
> 
> 标签：php, magento, e-commerce

我正在尝试从商店默认根类别之外的类别中获取产品。

如果我从商店根目录内的类别中推入 ID，则以下代码将起作用，但有一组类别（此处为 $_supplierData['supplier_category']）位于商店前台根类别之外。 . 如果我输入这些类别的 id...没有产品加载到 $_collection

```
$_category = Mage::getModel('catalog/category')
    ->load($_supplierData['supplier_category']);

$_collection = Mage::getModel('catalog/product')
    ->getCollection()
    ->addCategoryFilter($_category)
    ->addAttributeToSelect('*')
    ->load(); 
```

谁能告诉我我需要做什么才能将这些产品加载到集合中？我无法将类别推送到商店根目录——这是项目中另一位开发人员做出的设计决定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T03:56:30.773

```
$products = Mage::getModel('catalog/category')->load($_supplierData['supplier_category'])
    ->getProductCollection()
    ->addAttributeToSelect('*')
    ->addAttributeToFilter('status', 1)
    ->addAttributeToFilter('visibility', 4); 
```

# eclipse - FFT录音机Android

> ID：15621406
> 
> 赞同：0
> 
> 时间：2013-03-25T17:49:28.263
> 
> 标签：eclipse, api, audio, fft

请！我需要帮助！我正在尝试做一个录音机，然后用这个声音用他的图形做傅里叶快速变换。问题是我不知道如何做图形，我找到了一个 FFT 函数但它没有图形。有什么建议吗？

```
package proiektua.proiektua;

import android.media.MediaPlayer;
import android.net.Uri;
import android.os.Bundle;

import android.provider.MediaStore;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.View;

public class MainActivity extends Activity  {

        int peticion = 1;
        Uri url1;

        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            // Inflate the menu; this adds items to the action bar if it is present.
            getMenuInflater().inflate(R.menu.main, menu);
            return true;
        }

        public void grabar(View v) {
            Intent intent = new Intent(MediaStore.Audio.Media.RECORD_SOUND_ACTION);
            startActivityForResult(intent, peticion);}

        public void reproducir(View v) {
            MediaPlayer mediaPlayer = MediaPlayer.create(this, url1);
            mediaPlayer.start();
        }

        protected void onActivityResult(int requestCode, int resultCode, Intent data) {
            if (resultCode == RESULT_OK && requestCode == peticion) {
                url1 = data.getData();
            }
        }

    } 
```

这是 FFT：

```
public class FFT {

    // compute the FFT of x[], assuming its length is a power of 2
    public static Complex[] fft(Complex[] x) {
        int N = x.length;

        // base case
        if (N == 1) return new Complex[] { x[0] };

        // radix 2 Cooley-Tukey FFT
        if (N % 2 != 0) { throw new RuntimeException("N is not a power of 2"); }

        // fft of even terms
        Complex[] even = new Complex[N/2];
        for (int k = 0; k < N/2; k++) {
            even[k] = x[2*k];
        }
        Complex[] q = fft(even);

        // fft of odd terms
        Complex[] odd  = even;  // reuse the array
        for (int k = 0; k < N/2; k++) {
            odd[k] = x[2*k + 1];
        }
        Complex[] r = fft(odd);

        // combine
        Complex[] y = new Complex[N];
        for (int k = 0; k < N/2; k++) {
            double kth = -2 * k * Math.PI / N;
            Complex wk = new Complex(Math.cos(kth), Math.sin(kth));
            y[k]       = q[k].plus(wk.times(r[k]));
            y[k + N/2] = q[k].minus(wk.times(r[k]));
        }
        return y;
    } 
```

还有他的复杂类：

```
public class Complex {
    private final double re;   // the real part
    private final double im;   // the imaginary part

    // create a new object with the given real and imaginary parts
    public Complex(double real, double imag) {
        re = real;
        im = imag;
    }

    // return a string representation of the invoking Complex object
    public String toString() {
        if (im == 0) return re + "";
        if (re == 0) return im + "i";
        if (im <  0) return re + " - " + (-im) + "i";
        return re + " + " + im + "i";
    }

    // return abs/modulus/magnitude and angle/phase/argument
    public double abs()   { return Math.hypot(re, im); }  // Math.sqrt(re*re + im*im)
    public double phase() { return Math.atan2(im, re); }  // between -pi and pi

    // return a new Complex object whose value is (this + b)
    public Complex plus(Complex b) {
        Complex a = this;             // invoking object
        double real = a.re + b.re;
        double imag = a.im + b.im;
        return new Complex(real, imag);
    }

    // return a new Complex object whose value is (this - b)
    public Complex minus(Complex b) {
        Complex a = this;
        double real = a.re - b.re;
        double imag = a.im - b.im;
        return new Complex(real, imag);
    }

    // return a new Complex object whose value is (this * b)
    public Complex times(Complex b) {
        Complex a = this;
        double real = a.re * b.re - a.im * b.im;
        double imag = a.re * b.im + a.im * b.re;
        return new Complex(real, imag);
    }

    // scalar multiplication
    // return a new object whose value is (this * alpha)
    public Complex times(double alpha) {
        return new Complex(alpha * re, alpha * im);
    }

    // return a new Complex object whose value is the conjugate of this
    public Complex conjugate() {  return new Complex(re, -im); }

    // return a new Complex object whose value is the reciprocal of this
    public Complex reciprocal() {
        double scale = re*re + im*im;
        return new Complex(re / scale, -im / scale);
    }

    // return the real or imaginary part
    public double re() { return re; }
    public double im() { return im; }

    // return a / b
    public Complex divides(Complex b) {
        Complex a = this;
        return a.times(b.reciprocal());
    }

    // return a new Complex object whose value is the complex exponential of this
    public Complex exp() {
        return new Complex(Math.exp(re) * Math.cos(im), Math.exp(re) * Math.sin(im));
    }

    // return a new Complex object whose value is the complex sine of this
    public Complex sin() {
        return new Complex(Math.sin(re) * Math.cosh(im), Math.cos(re) * Math.sinh(im));
    }

    // return a new Complex object whose value is the complex cosine of this
    public Complex cos() {
        return new Complex(Math.cos(re) * Math.cosh(im), -Math.sin(re) * Math.sinh(im));
    }

    // return a new Complex object whose value is the complex tangent of this
    public Complex tan() {
        return sin().divides(cos());
    }

    // a static version of plus
    public static Complex plus(Complex a, Complex b) {
        double real = a.re + b.re;
        double imag = a.im + b.im;
        Complex sum = new Complex(real, imag);
        return sum;
    }

    // sample client for testing
    public static void main(String[] args) {
        Complex a = new Complex(5.0, 6.0);
        Complex b = new Complex(-3.0, 4.0);

        System.out.println("a            = " + a);
        System.out.println("b            = " + b);
        System.out.println("Re(a)        = " + a.re());
        System.out.println("Im(a)        = " + a.im());
        System.out.println("b + a        = " + b.plus(a));
        System.out.println("a - b        = " + a.minus(b));
        System.out.println("a * b        = " + a.times(b));
        System.out.println("b * a        = " + b.times(a));
        System.out.println("a / b        = " + a.divides(b));
        System.out.println("(a / b) * b  = " + a.divides(b).times(b));
        System.out.println("conj(a)      = " + a.conjugate());
        System.out.println("|a|          = " + a.abs());
        System.out.println("tan(a)       = " + a.tan());
    }

} 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-19T10:42:54.233

好吧，只是...做一个图形表示 - 您需要做的就是计算每个频率箱的[幅度（或欧几里得范数）](http://en.wikipedia.org/wiki/Magnitude_%28vector%29)，然后在[Canvas](http://developer.android.com/reference/android/graphics/Canvas.html)或类似的东西上绘制相应的线。

有一个名为 Audalyzer 的开源项目，可以在[Google Code](http://code.google.com/p/moonblink/)上找到完整的源代码- 你可以在那里获得一些指示，如果你从那里重用代码，请务必遵守许可证 :)

# python - Python中的“and”和“or”语句有何不同？

> ID：15621407
> 
> 赞同：-2
> 
> 时间：2013-03-25T17:49:32.983
> 
> 标签：python

如果你看这个：-

```
>>>a = "hello"
>>>b = "world"
>>>print a and b 
world
>>>print b and a
hello 
```

和这个：-

```
>>>a = "hello"
>>>b = "world"
>>>print a or b 
hello
>>>print b or a
world 
```

两者几乎相似。那么它们有什么不同呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T17:52:13.487

和运算`or`符*短路*。当结果给定时，他们会提前返回。`and`

 *因为`or`这意味着如果第一个表达式是`True`，那么查看第二个表达式是没有意义的，因为这无关紧要：

```
>>> 'a' or 'b'
'a'
>>> False or 'b'
'b' 
```

也是如此`and`，但仅当第一个值计算为`False`; 在这种情况下，表达式*总是*会计`False`算出第二个表达式的结果：

```
>>> False and 'b'
False
>>> 'a' and 'b'
'b' 
```

请参阅[布尔表达式](http://docs.python.org/3/reference/expressions.html#boolean-operations)：

> 表达式`x and y`首先计算`x`; 如果`x`为假，则返回其值；否则，`y`评估并返回结果值。
> 
> 表达式`x or y`首先计算`x`; 如果`x`为真，则返回其值；否则，`y`评估并返回结果值。*

# linux - 在日期范围内打印日期linux

> ID：15621409
> 
> 赞同：13
> 
> 时间：2013-03-25T17:49:37.697
> 
> 标签：linux, shell, unix, date

我是 linux 新手。如何在给定的日期范围内打印和存储日期。

例如我有 startdate=2013-03-01 和 enddate = 2013-03-25 ；我想打印该范围内的所有日期。

提前致谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-25T19:04:32.880

只要日期是 YYYY-MM-DD 格式，您就可以按字典顺序比较它们，并`date`在不先转换为秒的情况下进行日历算术：

```
startdate=2013-03-15
enddate=2013-04-14

curr="$startdate"
while true; do
    echo "$curr"
    [ "$curr" \< "$enddate" ] || break
    curr=$( date +%Y-%m-%d --date "$curr +1 day" )
done 
```

使用`[ ... ]`，您需要转义`<`以避免与输入重定向运算符混淆。

如果开始日期大于结束日期，这确实有打印开始日期的缺点。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-04-08T02:39:45.297

另一种选择是使用`dateseq`（`dateutils`http://www.fresse.org/dateutils/#dateseq ）[：](http://www.fresse.org/dateutils/#dateseq)

```
$ dateseq 2013-03-01 2013-03-25
2013-03-01
2013-03-02
2013-03-03
2013-03-04
2013-03-05
2013-03-06
2013-03-07
2013-03-08
2013-03-09
2013-03-10
2013-03-11
2013-03-12
2013-03-13
2013-03-14
2013-03-15
2013-03-16
2013-03-17
2013-03-18
2013-03-19
2013-03-20
2013-03-21
2013-03-22
2013-03-23
2013-03-24
2013-03-25 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-09-22T07:37:36.670

如果您想要“最近”日期，另一种选择是：

```
echo {100..1} | xargs -I{} -d ' ' date --date={}' days ago' +"%Y-%m-%d" 
```

显然不适用于任意日期范围。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-25T18:08:53.940

用于`date`将您的日期转换为秒，做一些数学运算并转换回来：

```
#/bin/bash

dstart=2013-03-01
dend=2013-03-25
# convert in seconds sinch the epoch:
start=$(date -d$dstart +%s)
end=$(date -d$dend +%s)
cur=$start

while [ $cur -le $end ]; do
    # convert seconds to date:
    date -d@$cur +%Y-%m-%d
    let cur+=24*60*60
done 
```

有关`man date`日期参数的更多信息，请参阅..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-07T06:13:53.040

一行版本：

```
seq 0 24 | xargs -I {} date  +"%Y-%m-%d" -d '20130301 {}day'

# this version is ok if the dates not cross next month
seq -f'%.f'  20130301 20130325 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-24T16:01:56.620

一个简单的演示

```
start_date="20191021"                                                                        
end_date="20191025"                                                                          
dates=()                                                                                     
while [[ "${start_date}" != "${end_date}" ]];do                                              
  formatted_date=$(date -d "${start_date}" +"%Y%m%d")                                        
  dates+=( "${formatted_date}" )                                                                                                                                
  start_date=$(date -d "$start_date +1 day" +"%Y%m%d")                                       
done 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-18T07:37:58.193

略微改进的版本

```
#!/bin/bash
startdate=2013-03-15
enddate=2013-04-14

curr="$startdate"
while true; do
    [ "$curr" \< "$enddate" ] || { echo "$curr"; break; }
    echo "$curr"
    curr=$( date +%Y-%m-%d --date "$curr +1 day" )
done 
```

# python - 从python中的excel中提取的编辑时间

> ID：15621412
> 
> 赞同：0
> 
> 时间：2013-03-25T17:49:44.183
> 
> 标签：python, excel

我无法对从 Excel 表中提取的现有日期时间进行更改（增加秒数）。

```
Code:
import xlrd
import xlwt
from datetime import datetime, timedelta
wb = xlrd.open_workbook('sample.xls')
wb2 = xlrd.open_workbook('sample2.xls')
# Load XLRD Excel Reader

sheetname = wb.sheet_names() #Read for XCL Sheet names
sh1 = wb.sheet_by_index(0) #Login
sheetname2 = wb2.sheet_names() #Read for XCL Sheet names
sh2 = wb2.sheet_by_index(0) #Login

def readRows():
    #a = datetime.time(10, 23)
    #print a
    for rownum in range(sh1.nrows):
        rows = sh1.row_values(rownum)
        for rownum2 in range(sh2.nrows):
            rows2 = sh2.row_values(rownum2)
            date = rows[0]
            date2 = rows2[0]
            print xlrd.xldate_as_tuple(date,0)
            print xlrd.xldate_as_tuple(date2,0)
            #date2 = rows2[0]
            if date == date2 :
                #print 'found'
                time = rows[2]
                time2 = rows2[2]
                if time == time2 :
                    print 'time matched'
                    #remaining code
                elif(time<time2)&&(time+datetime.timedelta(0,15)>time2)):
                    print 'less'
                    ti=xlrd.xldate_as_tuple(time,0)
                    ti2=xlrd.xldate_as_tuple(time2,0)
                    print ti,ti2 # shows (2013,11,11,10,42,36) 
                    print a.time #not working
                    ti+=datetime.timedelta(seconds=3) #not working
                    ti2+=2 #not working
                    print ti,ti2
                    print time
                    time=datetime.datetime (xlrd.xldate_as_tuple(time,0)) + datetime.timedelta(0,1) #not working
                    time2 = xlrd.xldate_as_tuple(datetime.datetime(time2),0)+ datetime.timedelta(0,1) #not working
                    print (xlrd.xldate_as_tuple(time+timedelta(seconds=3),0)),(xlrd.xldate_as_tuple(time2+timedelta(seconds=3),0)) #not working
                elif (time > time2) & (time+datetime.timedelta(0,15) > time2)) :
                    print 'more'
                    print time,time2
print readRows()
input('enter to exit:') 
```

我有两个日志文件。一个记录每 15 秒，另一个记录可变时间。因此，我需要将第二个日志的最接近值映射到第一个日志中的时间，因为我无法更改从 excel 表中提取的时间，但时间显示正确并进行了正确比较。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T23:26:50.620

您可能需要更改 xldate_as_tuple 返回的元组的顺序或将月份更改为从零开始而不是从零开始......但基本上，一旦您将日期分成其部分，只需从中创建一个日期时间对象并添加时间差...

```
>>> year,month,day,hour,second = 2002,10,15,22,23  #oct 15 2002 @ 10.23pm
>>> d1 = datetime.datetime(year,month,day,hour,second)
>>> num_seconds = 3600 #one hour
>>> time_delt = datetime.timedelta(seconds=num_seconds)
>>> print d1+time_delt
2002-10-15 23:23:00
>>> #notice it is an hour later! 
```

python 文档非常有帮助

[http://docs.python.org/2/library/datetime.html#datetime.timedelta](http://docs.python.org/2/library/datetime.html#datetime.timedelta)

[http://docs.python.org/2/library/datetime.html#module-datetime](http://docs.python.org/2/library/datetime.html#module-datetime)

# database - 实体之间的基数

> ID：15621415
> 
> 赞同：0
> 
> 时间：2013-03-25T17:49:49.853
> 
> 标签：database, foreign-keys, primary-key, entity-relationship, cardinality

我在学校学习数据库系统的测试，我在互联网上没有找到类似的例子，我不确定。跟随关系的基数是什么？

![在此处输入图像描述](../Images/4944e12230590679fa67113334834433.png)

我会说1：1。我的一些朋友说1：M。我对吗？

我一直在想：ET1 使用 atr3(FK) 与 ET2 紧密耦合，但也有自己的 atr1(PK)。所以 ET2:ET1 是 1:M。但是在 ET2 中存在 atr1(FK)，这种关系在我看来就像具有 ET1 的 ET2 只能与其 ET1 中的一个完全链接，因此结果关系应该是 1:1。

你怎么看 ？

非常感谢你们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:43:23.277

有两种关系。没有单一的基数来描述相同的两个实体之间的两个独特的关系。

我的回答：ET2:ET1 是 1..N；ET1:ET2 是 0..N

根据您的描述（主要是 ET1.atr1 是 PK），该图非常混乱。这是我对图表的看法 - ET1.atr3“在线上”，因此是与 ET1.atr1 的复合主键的一部分。由于 ET1.atr1 被 ET2 引用，所以它必须是一个候选键（即一个 ET1.atr1 值必须能够唯一标识一条记录）。一个实体必须在另一个之前插入（显然），因此两个 FK 字段之一必须可以为空。由于 ET1 对 ET2 的 FK (ET1.atr3) 是复合主键的一部分，因此它不能为空。因此，ET2.atr1 必须可以为空。该图显示了表示 ET1:ET2 关系的虚线，进一步表明这是 0..N 的关系

如果您可以进一步澄清这种情况，我将更新我的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:27:01.243

在没有进一步信息的情况下，这种关系似乎是多：多。

一个表上的外键链接到另一个表上的主键表示多对一关系。这意味着：

*   一个 ET2 记录可以有多个对应的 ET1 记录，通过 atr3。
*   一个 ET1 记录可以有多个对应的 ET2 记录，通过 atr1。

因此，它们之间存在多对多的关系。

通常，这在关系模型中通过引入链接实体来处理，复合键由两个现有实体的主键以及仅在链接级别出现的任何属性组成 - 所以在这里，链接实体 ET1_ET2 将具有由 atr1 和 atr3 组成的复合键，而外键 atr3 和 atr1 将分别从 ET1 和 ET2 中删除。

（其他关系是可以想象的，但需要进一步的信息来确认 - 例如，ET1 和 ET2 实际上可能是同一个实体，涉及物料清单类型的关系。）

# mysql - 试图在 mysql 的 sql 文件中插入

> ID：15621416
> 
> 赞同：0
> 
> 时间：2013-03-25T17:49:52.400
> 
> 标签：mysql, insert

我只是想在 sql 文件中插入一些插入以导入某个 sql 数据库，因为当寄存器存在时我得到一个错误，所以如果寄存器存在，我不想做任何事情（不要插入），因此我有试过

```
INSERT INTO menu VALUES('Arsenal FC','?team=arsenal fc')
ON DUPLICATE KEY IGNORE '*already inserted*'; 
```

或者`IF NO EXISTS INSERT INTO menu Values('Arsenal FC','?team=arsenal fc');`

我也听说过重复密钥更新，但我不想更新只是想在存在时不插入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:52:20.860

怎么样：

```
INSERT IGNORE INTO menu VALUES('Arsenal FC','?team=arsenal fc'); 
```

如此处所述：http: [//dev.mysql.com/doc/refman/5.5/en/insert.html](http://dev.mysql.com/doc/refman/5.5/en/insert.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:35:02.207

如果您想忽略所有现有数据，那么有两种最常用的方法。

1.  使用**INSERT IGNORE 之**类的

    INSERT IGNORE INTO menu VALUES('Arsenal FC','?team=arsenal fc');

2.  使用“ **ON DUPLICATE KEY UPDATE** ”之类的

    INSERT INTO menu VALUES('Arsenal FC','?team=arsenal fc') ON DUPLICATE KEY UPDATE key=key

    //注意：我假设 key 是你的唯一或主键约束。

但我建议您采用第二种方式，即**ON DUPLICATE KEY UPDATE**，因为使用**INSERT IGNORE** 会忽略所有错误（即它是一个草率的全局忽略）。如果导致重复键，则不会实际插入该行。但该语句不会产生错误。它会生成一个警告。最重要的是，如果您的表没有任何键约束，那么您需要使用唯一键或主键更改表。

# jquery - GoogleMaps Autocomplete 从列表中获取选定的值

> ID：15621417
> 
> 赞同：0
> 
> 时间：2013-03-25T17:49:56.633
> 
> 标签：jquery, google-maps, geolocation, geocoding

我正在输入地址并使用**Geocomplete**向用户显示可能的地址列表。用户输入完地址后，我想获取输入地址的经度和纬度坐标。我在从列表中获取所选地址的坐标时遇到了一些问题。

我试过 jquery `blur`，`after`但`change`它会在列表弹出时立即触发。我正在寻找一种从列表中设置选定地址的方法`loopUpAdd`，一旦选择了地址或自动完成完成，我希望能够获取该地址的经度和纬度坐标。中的警报`$('#loopUpAdd').blur(function(evt){....`显示用户迄今为止输入的值，而不是选择的值。这是我的小提琴[GeoCode](http://jsbin.com/itegul/11/edit)

**HTML**

```
<label>Address</label>
<input type="text" id="loopUpAdd" />
<label>Long</label>
<input type="text" id="long" />
<label>Lat</label>
<input type="text" id="lat" /> 
```

**jQuery**

```
function getLocation() {

    var input = document.getElementById('loopUpAdd');

    var options = {
        types: ['(cities)'],
            componentRestrictions: {country: 'tt'}
        };

        var autocomplete = new google.maps.places.Autocomplete(input, options); 
        $('#lat').val(0);
        $('#long').val(0);
    }

function codeAddress(address) {
    //var address = document.getElementById("loopUpAdd").value;
    var geocoder = new google.maps.Geocoder();

    geocoder.geocode({
        'address': address
    }, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {           
            var lng = results[0].geometry.location.lng();
            var lat = results[0].geometry.location.lat();

            $('#lat').val(lat);
            $('#long').val(lng);
            alert(lng +'-'+lat);
        } else {
            $('#lat').val(0);
            $('#long').val(0);
        }
    });
}

$(document).ready(function () {

    $('#loopUpAdd').blur(function(evt){ 
        alert($(this).val());
        codeAddress($(this).val());          
    });

    $('#loopUpAdd').mouseenter(function(evt){  
        $('#lat').val(0);
        $('#long').val(0);     
    });

    google.maps.event.addDomListener(window, 'load', getLocation);
}); 
```

# java - 如何让spring MVC完全忽略Accept Header

> ID：15621423
> 
> 赞同：0
> 
> 时间：2013-03-25T17:50:10.293
> 
> 标签：java, spring, spring-mvc, header, annotations

我有一个非常标准的 Spring MVC 配置，使用 and 。

我有一个使用以下内容连接到 login.html 的登录页面：

```
@RequestMapping(value = "/login.html", method = RequestMethod.GET)
public ModelAndView login(HttpSession session) 
```

我遇到的问题是，除非请求页面的用户代理发送“text/html”的 Accept 标头，否则他们将返回 404。我们有一些客户端的浏览器配置正在发送 */*，但他们不能访问我们的网站。

此外，HTTP 规范指出，如果没有出现 Accept 标头，则应假定用户代理接受 */*

所以我的问题是，如何让 Spring MVC 在将请求与我的处理程序匹配时根本不检查 Accept 标头？无论他们发送什么 Accept 值，即使 Accept 值被完全取消，我都希望映射能够正常工作。

# groovy - 使用 Groovy Geb 库以批处理模式抓取网页

> ID：15621427
> 
> 赞同：0
> 
> 时间：2013-03-25T17:50:21.640
> 
> 标签：groovy, geb

我想根据他们的网址抓取一些网页。据称 Geb 库能够进行屏幕抓取。

到目前为止，我得到的是使用 Browser.drive 方法并在该方法中指定一个页面 url。这样我就能够从该特定页面抓取数据。但每次我必须手动将 url 更改为另一个页面。当我再次运行脚本时，将打开一个新的浏览器，这需要相当长的时间。我不需要打开浏览器，只需要从页面中抓取数据。我相信必须有某种机制让我以批处理模式对我的所有网页进行数据抓取。我已经阅读了[The Book Of Geb](http://www.gebish.org/manual/current/)好几遍，但仍然找不到任何关于如何做到这一点的讨论。

# ipad - 最小宽度 = 481 为什么

> ID：15621428
> 
> 赞同：1
> 
> 时间：2013-03-25T17:50:21.747
> 
> 标签：ipad, css, media-queries

我看到一些带有@media 的页面，它们的最小宽度设置为 481 像素。
为什么？481有什么用？
我认为 ipad 尺寸是 768*1024 。
谢谢。

```
 @media only screen and (device-width: 768px) {
  /* For general iPad layouts */
}

@media only screen and (min-device-width: 481px) and (max-device-width: 1024px) and (orientation:portrait) {
  /* For portrait layouts only */
}

@media only screen and (min-device-width: 481px) and (max-device-width: 1024px) and (orientation:landscape) {
  /* For landscape layouts only */
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:57:44.383

这是因为人们还定义了智能手机的媒体查询。大多数时候有宽度= 480px。

```
@media only screen 
and (min-device-width : 320px) 
and (max-device-width : 480px) {}    } 
```

所以下一个更高的分辨率将是 min-device-width = 481px

希望这有助于了解更多信息，请查看[http://css-tricks.com/snippets/css/media-queries-for-standard-devices/](http://css-tricks.com/snippets/css/media-queries-for-standard-devices/)

# asp.net-mvc-4 - 为一页使用两个 Knockout 视图模型

> ID：15621431
> 
> 赞同：4
> 
> 时间：2013-03-25T17:50:32.750
> 
> 标签：asp.net-mvc-4, knockout.js, knockout-mvc

我正在淘汰赛中设置两个视图模型。

```
$.getJSON("/api/administrators", function (data) {        
    var AccessViewModel = {
        administrators: ko.observableArray(data)
    };
    ko.applyBindings(AccessViewModel);

});

$.getJSON("/api/roles", function (data) {
    var RolesViewModel = {
        definedRoles: ko.observableArray(data)
    };
    ko.applyBindings(RolesViewModel);

}); 
```

我能够从视图中的管理员那里获取信息，但无法从 definedRoles 中提取任何内容。当我在 .getJSON 函数中为角色添加警报时，它正在返回数据。创建 RolesViewModel 和我这样称呼它之间似乎有问题：

```
<ul data-bind="foreach: definedRoles">
    <li data-bind="text: name"></li>
</ul> 
```

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T18:05:56.413

`ko.applyBindings`每个部分只能调用一次。如果您不传递第二个参数，则该部分是整个页面。如果你有一个特定的部分，比如 a `DIV`，你应该把它作为第二个参数传入。

或者，您可以为页面创建一个视图模型，为两个列表设置一个属性，然后将您的页面绑定到这个单个视图模型。我推荐这种方法。该代码可能如下所示：

```
var ViewModel = function() {
    this.administrators = ko.observableArray([]);
    this.definedRoles = ko.observableArray([]);
};

var vm = new ViewModel();
ko.applyBindings(vm);

$.getJSON("/api/administrators", function (data) {
    vm.administratos(data);
});

$.getJSON("/api/roles", function (data) {
    vm.definedRoles(data);
}); 
```

请记住，由于`ko.applyBindings`只需要调用一次，因此您应该尽早调用。由于几个原因，从 ajax 方法调用它通常是一个坏主意。一、ajax方法不再可以作为更新调用重用；第二，其他页面功能必须等到 ajax 方法返回才能开始工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-25T19:00:13.160

Tyrsius 的答案是正确的，但为了将来参考，您可以将两个不同的视图模型绑定到同一页面。您将不得不绑定模型，例如

```
ko.applyBindings(wallView,$("#WallKo")[0]); 
```

并用具有所选 ID 的 div 包装 html，即

```
<div id = "WallKo">
    <div data-bind="foreach:posts">
         .....
    </div>
</div> 
```

然后，您可以为每个页面拥有任意数量的视图模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-19T17:02:36.703

感谢您提供如何将模型绑定到特定 div 的示例。非常有帮助

# java - 方法句柄性能

> ID：15621434
> 
> 赞同：23
> 
> 时间：2013-03-25T17:50:46.030
> 
> 标签：java, performance, methodhandle

我写了一个小基准来测试方法的性能`java.lang.invoke.MethodHandle`和`java.lang.reflect.Method`直接调用。

我读到的`MethodHandle.invoke()`性能几乎与直接调用相同。但是我的测试结果显示了另一个：`MethodHandle`调用比反射慢大约三倍。我的问题是什么？这可能是一些 JIT 优化的结果吗？

```
public class Main {
    public static final int COUNT = 100000000;
    static TestInstance test = new TestInstance();

    static void testInvokeDynamic() throws NoSuchMethodException, IllegalAccessException {
        int [] ar = new int[COUNT];

        MethodHandles.Lookup lookup = MethodHandles.lookup();
        MethodType mt = MethodType.methodType(int.class);

        MethodHandle handle = lookup.findStatic(TestInstance.class, "publicStaticMethod", mt) ;

        try {
            long start = System.currentTimeMillis();

            for (int i=0; i<COUNT; i++) {
                ar[i] = (int)handle.invokeExact();
            }

            long stop = System.currentTimeMillis();

            System.out.println(ar);

            System.out.println("InvokeDynamic time: " + (stop - start));
        } catch (Throwable throwable) {
            throwable.printStackTrace();
        }
    }

    static void testDirect() {
        int [] ar = new int[COUNT];

        try {
            long start = System.currentTimeMillis();

            for (int i=0; i<COUNT; i++) {
                ar[i] = TestInstance.publicStaticMethod();
            }

            long stop = System.currentTimeMillis();

            System.out.println(ar);

            System.out.println("Direct call time: " + (stop - start));
        } catch (Throwable throwable) {
            throwable.printStackTrace();
        }
    }

    static void testReflection() throws NoSuchMethodException {
        int [] ar = new int[COUNT];

        Method method = test.getClass().getMethod("publicStaticMethod");

        try {
            long start = System.currentTimeMillis();

            for (int i=0; i<COUNT; i++) {
                ar[i] = (int)method.invoke(test);
            }

            long stop = System.currentTimeMillis();

            System.out.println(ar);

            System.out.println("Reflection time: " + (stop - start));
        } catch (Throwable throwable) {
            throwable.printStackTrace();
        }
    }

    static void testReflectionAccessible() throws NoSuchMethodException {
        int [] ar = new int[COUNT];

        Method method = test.getClass().getMethod("publicStaticMethod");
        method.setAccessible(true);

        try {
            long start = System.currentTimeMillis();

            for (int i=0; i<COUNT; i++) {
                ar[i] = (int)method.invoke(test);
            }

            long stop = System.currentTimeMillis();

            System.out.println(ar);

            System.out.println("Reflection accessible time: " + (stop - start));
        } catch (Throwable throwable) {
            throwable.printStackTrace();
        }
    }

    public static void main(String ... args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException, InterruptedException {
        Thread.sleep(5000);

        Main.testDirect();
        Main.testInvokeDynamic();
        Main.testReflection();
        Main.testReflectionAccessible();

        System.out.println("\n___\n");

        System.gc();
        System.gc();

        Main.testDirect();
        Main.testInvokeDynamic();
        Main.testReflection();
        Main.testReflectionAccessible();
    }
} 
```

**环境：** Java 版本“1.7.0_11”Java(TM) SE 运行时环境（构建 1.7.0_11-b21）Java HotSpot(TM) 64 位服务器 VM（构建 23.6-b04，混合模式）操作系统 - Windows 7 64

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-26T18:31:19.513

看起来这是@AlekseyShipilev 间接回答了一个不同的查询。在以下链接 [中，如何提高 Field.set 的性能（可能使用 MethodHandles）？](https://stackoverflow.com/questions/22244402/how-can-i-improve-performance-of-field-set-perhap-using-methodhandles)

如果您通读，您将看到显示类似结果的其他基准。很可能直接调用可以简单地通过 JIT 以根据上述发现的方式进行优化，区别在于：

*   MethodHandle.invoke =~195ns
*   MethodHandle.invokeExact =~10ns
*   直接调用 = 1.266ns

所以 - 直接调用仍然会更快，但 MH 非常快。对于大多数用例来说，这应该足够了，而且肯定比旧的反射框架更快（顺便说一句 - 根据上面的发现，在 java8 vm 下反射也明显更快）

如果这种差异在您的系统中很重要，我建议找到不同的模式而不是支持直接调用的直接反射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T18:53:23.433

似乎其他人也看到了类似的结果：http: [//vanillajava.blogspot.com/2011/08/methodhandle-performance-in-java-7.html](http://vanillajava.blogspot.com/2011/08/methodhandle-performance-in-java-7.html)

这是别人的： [http ://andrewtill.blogspot.com/2011/08/using-method-handles.html](http://andrewtill.blogspot.com/2011/08/using-method-handles.html)

我跑了第二个，看到他们的速度差不多，甚至修复了那个测试以进行热身。但是，我修复了它，所以它不会每次都创建一个 args 数组。在默认计数下，它产生了相同的结果：方法句柄要快一点。但我数了 10000000（默认*10），反射速度更快。

因此，我建议使用参数进行测试。我想知道 MethodHandles 是否更有效地处理参数？此外，检查更改计数 - 多少次迭代。

@meriton 对这个问题的评论链接到他的工作，看起来非常有帮助：[Calling a getter in Java through reflection：什么是重复调用它的最快方法（性能和可扩展性方面）？](https://stackoverflow.com/questions/14146570/calling-a-getter-in-java-though-reflection-whats-the-fastest-way-to-repeatedly/14146919#14146919)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T17:13:17.107

如果这`publicStaticMethod` 是一个简单的实现，比如返回一个常量，那么直接调用很可能是由 JIT 编译器内联的。使用 methodHandles 可能无法做到这一点。

RE [http://vanillajava.blogspot.com/2011/08/methodhandle-performance-in-java-7.html](http://vanillajava.blogspot.com/2011/08/methodhandle-performance-in-java-7.html)示例，如前所述，评论它的实现并不好。如果在计算循环中将类型转换更改为 int（而不是 Integer），则结果更接近于直接方法调用。

通过复杂的实现（创建和调用返回随机整数的未来任务）给基准测试提供了更接近的数字，其中 MethodStatic 最大比直接方法慢约 10%。因此，由于 JIT 优化，您可能会看到性能降低 3 倍

# java - java中的lzw解压

> ID：15621436
> 
> 赞同：-2
> 
> 时间：2013-03-25T17:50:51.750
> 
> 标签：java, compression

我已经在 java 中为 lzw 算法编写了代码。解压时进入无限循环。255 以上的值以不同的方式读取。我用一个例子给出了 ma 代码。

```
import java.io.*;
import java.util.*;
public class test_decom {
  static  final int BUFFERSIZE  = 32;
static final int CHARSIZE     = 12;
static long buffer;        //32 bits of space, up to 16bit compression, only 24 bits used
static int bufferBits;     //How many bits are stored in the buffer
static int bits = 12;           //How many bits per code
static int lzwSize;       // have writen dis value at the end of compression file but this
                           //also not writing..... **plz help for this also**
static int getCode(InputStream fp)
{
 long temp;

while(bufferBits <=(BUFFERSIZE - CHARSIZE *2))//Never go over than size - or we loose data
{                                             //Also never use full 64 bits, to avoid issues
    //No point reading anymore, files done :p
    try
    {
            System.out.print("bufferBits : ");
    if(fp.available() <= 0)
          break;

       //test = fp.read();
       //buffer |= test << bufferBits;
       buffer |= fp.read() <<(bufferBits);
       bufferBits+= CHARSIZE; //Buffer now stores one more char.
           System.out.println(buffer);

    }

    catch(IOException e)
    {
    System.out.println("Error in getCode" + e.getMessage());
    }
}
    temp = (buffer << (64-bits)) >>> (64-bits); //We remove the excess bits
    buffer >>>= bits; //Remove the bits from buffer
    bufferBits -= bits;
        System.out.println("temp : "+temp);
    return (int)temp; //we return the correct code
}

public static void main(String arg[]) throws IOException
{
   // int prefix[] = new int[20];
    //int nextCode = 0;
   // String dict[] = new String [20];
    lzwSize =  (short)(1<<(bits)-1);
    BufferedInputStream fileIn = null;
    BufferedOutputStream fileOut = null;
try
{
    fileIn = new BufferedInputStream (new FileInputStream ("C:\\Documents and Settings\\project\\LzwTut\\test1_test.txt"));
    fileOut = new BufferedOutputStream(new FileOutputStream("C:\\Documents and Settings\\gauri\\project\\practice\\LzwTut\\test1_Test.txt"));
}
catch(IOException e)
{
    System.out.println("Unable to load file " + e.getMessage());
}
    ArrayList<Integer> input = new ArrayList<Integer>();
    Dictionary dic = new Hashtable();
    String val = null;

    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    int ab;
   while((ab=getCode(fileIn))!=lzwSize){ //i tried putting -1 but that is also not working
                                         //problem in this.... 
       //initialization
         input.add(ab);

   }
       // input.get(i) = Integer.parseInt(br.readLine());
    for(int i=0;i<input.size()-1;i++)
    //{
    try{

        if(input.get(i)<=255)
        {
            fileOut.write(input.get(i));
            //System.out.println("output : "+input.get(i));
            if(input.get(i+1)>255)
            { 
                val = (String)dic.get(input.get(i+1)-256);
                dic.put(i, input.get(i)+" "+val); 
             //   System.out.println("dic.put("+i+", "+input[i]+" "+val+")");
            }
            else
            {
                dic.put(i, input.get(i)+" "+input.get(i+1)); 
                //System.out.println("dic.put("+i+", "+input[i]+" "+input[i+1]+")");
            }

           // addDict(i,input[i],input[i+1]);//abhi tak out of bounds not solved

        }
        else
        {
           val = (String)dic.get(input.get(i)-256); 
           //System.out.print("output : ");
           for(int k=0;k<val.length();k++)
           {
           if(val.charAt(k) == ' ')
               continue;
           else
           {
               fileOut.write(val.charAt(k));
             //  System.out.print(val.charAt(k));
           }
           }
         //  System.out.println();
            if(input.get(i+1)>255)
            { 
                String val1 = (String)dic.get(input.get(i+1)-256);
                dic.put(i, val+" "+val1); 
               // System.out.println("dic.put("+i+", "+val+" "+val1+")");

            }
            else
            {
                dic.put(i, val+" "+input.get(i+1)); 
               // System.out.println("dic.put("+i+", "+val+" "+input[i+1]+")");
            }

        }

    }
catch(Exception e)
{}
    if(input.get(input.size() - 1)>255)
    {
        //System.out.print("output : ");
           for(int k=0;k<val.length();k++)
           {
               if(val.charAt(k) == ' ')
                   continue;
               else
               {
                  // System.out.print(val.charAt(k));
                   fileOut.write(val.charAt(k));
               }
           }

    }
    else{
    //System.out.println("output : "+input.get(input.size() - 1));
    fileOut.write(input.get(input.size() - 1));
    }
    try{
        fileIn.close();
        fileOut.close();
    }
    catch(Exception e)
    {

    }
      //  System.out.println("output : "+input[9]);
}
} 
```

示例：txt文件test_test.txt包含：堆栈溢出堆栈溢出............压缩后：输入：115输入：116输出：115输入：97输出：116输入：99输出：97输入：107输出：99 输入：32 输出：107 输入：111 输出：32 输入：118 输出：111 输入：101 输出：118 输入：114 输出：101 输入：102 输出：114 输入：108 输出：102 输入：111 输出： 108输入：119输出：111输入：32输出：119输入：105输出：32输入：115输出：105输入：32输出：115输入：98输出：32输入：101输出：98输入：115输出：101输入: 116 输入: 32 输出: 256 输入: 102 输出: 32 输入: 111 输出: 102 输入: 114 输出: 111 输入: 117 输出: 114 输入: 109 输出: 117 输入: 46 输出: 109 输入: 32 输出: 46输入：115 输出：32 输入：116 输入：97输出：256输入：99输入：107输出：258输入：32输入：111输出：260输入：118输入：101输出：262输入：114输入：102输出：264输入：108输入：111输出：266输入: 119 输入 : 46 输出 : 268 BUILD SUCCESSFUL (total time: 0 seconds)// 它应该写 lzwSize 但它没有写

解压后：输出：115输出：116输出：97输出：99输出：107输出：32输出：111输出：118输出：101输出：114输出：102输出：108输出：111输出：119输出：32输出： 105输出：115输出：32输出：98输出：101

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:54:04.940

```
while((ab=getCode(fileIn))!=lzwSize)// I think here is the problem 
```

应该

```
while((ab=getCode(fileIn))<=lzwSize) 
```

因为可能 getCode(fileIn) 永远不会返回 lzSize 并且它将永远循环。我不知道 lzw 解压只是通过查看您的代码来猜测。

# python - 使用元组和字典的字谜查找器

> ID：15621441
> 
> 赞同：0
> 
> 时间：2013-03-25T17:51:04.767
> 
> 标签：python, dictionary, tuples

所以我有一个程序，它接受一个字符串，并返回一个元组，其中字符串中的所有字母都按排序顺序排列。

然后程序需要创建一个字典，以元组作为键，值是所有带有键的单词的列表

到目前为止，我有：

```
_DEBUG = True
def getLetters(string):
    """Purpose, to nab letters from a string and to put them in a tuple in
    sorted order."""
    #sort the letters and put them in a tuple
    tuple_o_letters = tuple(sorted(string))
    if _DEBUG:

    print tuple_o_letters
    return tuple_o_letters
def main():
    try:# open the file
        fin = open("words2.txt")
    except:
        #if file doesn't exist
        print("no, no, file no here.")
        sys.exit(0)
    wordList = [] #create a word list
    for eachline in fin:
        #fill up the word list and get rid of new lines
        wordList.append(eachline.strip())

    word_dict = {} # create a dictionary
    for eachWord in wordList:
        tuple = getLetters(eachWord) # make a tuple out of each word
        word_dict[tuple] = wordList #store it into a dictionary

    print word_dict #print out the dictionary

if __name__ == '__main__':
    main() 
```

现在，虽然我可以将元组存储为字典键，但我无法弄清楚当且仅当单词列表具有这些键时，如何将单词列表存储为值。

例如：如果在字典中如果有键 ('d', 'o', 'g')，我会为该特定条目获得值 god 和 dog，假设这两个单词在单词列表中（即从 words2.txt 文件中获取。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:56:21.113

您正在存储*整个*单词表。您只想为每个排序的字母元组存储*匹配*的单词：

```
word_dict = {} # create a dictionary

for eachWord in wordList:
    key = getLetters(eachWord) # make a tuple out of each word
    if key in word_dict:
        word_dict[key].append(eachWord)
    else:
        word_dict[key] = [eachWord] 
```

如果键尚不存在，这将为给定键（字母元组）创建一个列表，否则只是附加单词。

您可以使用以下方法简化此操作[`collections.defaultdict`](http://docs.python.org/2/library/collections.html#collections.defaultdict)：

```
from collections import defaultdict

word_dict = defaultdict(list)

for eachWord in wordList:
    word_dict[getLetters(eachWord)].append(eachWord) 
```

因为这样您就不需要每次都显式地测试密钥。

# javascript - 构建自定义模块以将数据注入 Drupals Javascript 全局对象“设置”

> ID：15621444
> 
> 赞同：2
> 
> 时间：2013-03-25T17:51:13.697
> 
> 标签：javascript, drupal

我正在尝试构建一个执行 SQL 搜索的 D6 模块，并将数据保存在 Drupal 的全局设置对象中，以便我的首页在加载后就有这些数据。任何想法如何做到这一点？

我需要编写一个钩子或模板预处理吗？请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:06:31.533

您可以使用添加到该对象[`drupal_add_js()`](http://api.drupal.org/api/drupal/includes%21common.inc/function/drupal_add_js/6)，例如：

```
drupal_add_js(array('my_module' => array('my_setting' => 'this_value')), 'setting'); 
```

将使您可以`Drupal.settings.my_module.my_setting`在客户端访问。

你把代码放在哪里取决于你的页面的结构（这是表单提交的一部分，它是重定向到任何地方还是只是在提交后重建表单并在同一页面上显示结果等）。如果您可以使用该信息更新问题，我也会尝试解决该问题。

# html - 仅使用敲除单击按钮时使输入字段为空白

> ID：15621447
> 
> 赞同：0
> 
> 时间：2013-03-25T17:51:22.590
> 
> 标签：html, knockout.js

我只想使用敲除来实现以下内容： - 我想在单击“button1”时将输入字段设为空白，并在单击“button2”时将值显示回来。输入字段是由它们各自的可观察对象绑定的数据。所以，我不确定我应该如何使 observables 为 null，然后在单击 button2 时将它们显示回来。

代码：

```
var ViewModel = function() {
    var self = this;
    self.comment = ko.observable("hi there"); 
    self.message = ko.observable("hello"); 
}

vm = new ViewModel(); 
ko.applyBindings(vm); 
```

**我的做法：**

以下是我尝试实现但根本不起作用的两种方法：

```
myShow: function() { 
   comment = ko.observable(""); 
},

myHide: function() {
    message = ko.observable(""); 
}, 
```

我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:58:24.000

您只是想暂时保存这些值，对吗？在视图模型中使用私有变量，如下所示。

```
var ViewModel = function() {
    var self = this;
    self.comment = ko.observable("");
    self.message = ko.observable("");

    var comment, message;
    self.store = function() {
        comment = self.comment();
        message = self.message();
        self.comment("");
        self.message("");
    };
    self.show = function() {
        self.comment(comment);
        self.message(message);
    };    
}; 
```

这是[小提琴](http://jsfiddle.net/tyrsius/KGSUD/)

# memory-management - 检测对来自该库的静态链接库的内存段的写入

> ID：15621450
> 
> 赞同：2
> 
> 时间：2013-03-25T17:51:31.610
> 
> 标签：memory-management, static-libraries, memory-corruption

我在这里面临一个问题，其中使用多个静态链接库的代码似乎破坏了属于 Microsoft 库的内存。我认为 MS 库本身不太可能有这样的错误。根据我的调查，腐败也不太可能是由调用图书馆引起的。所以我目前的想法是，在主应用程序或它使用的库之一中，调用 memcpy 或类似的东西会导致属于 MS 库的数据损坏。通常我会使用数据断点来追踪这样的错误，但不幸的是在这种情况下这是不合适的。崩溃仅每 10 小时左右发生一次，但属于 MS 库的内存每 2 毫秒更改一次，甚至通过对该库的有效调用在更短的时间内更改一次。

所以我想知道是否有可能检测一个库或主可执行文件是否正在写入属于 MS 库的内存段，因为我认为这很可能是我当前问题的原因。

# android - 放大谷歌地图安卓

> ID：15621453
> 
> 赞同：0
> 
> 时间：2013-03-25T17:51:34.547
> 
> 标签：android, google-maps-android-api-2

我想用谷歌地图放大到一个点，但我想使用 android sdk 8 而不是 11

```
<fragment
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="0dip"
    android:layout_weight="90"
    class="com.google.android.gms.maps.SupportMapFragment" /> 
```

和

```
mapView = (MapView) findViewById(R.id.map);
mapView.setBuiltInZoomControls(true);
mc = mapView.getController(); 
```

但我有错误

```
java.lang.ClassCastException: android.support.v4.app.NoSaveStateFrameLayout cannot be cast to com.google.android.maps.MapView 
```

所以我想用 sdk8 放大到一个点

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:07:28.567

我认为您需要调用 getMap()，而不是 findViewById。该模式记录在 Maps API v2 for Android 指南的[Map Objects中。](https://developers.google.com/maps/documentation/android/map#verify_map_availability)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T12:51:29.873

试试这个

```
GoogleMap map = getMap(); 
```

请注意，GoogleMap 类来自“com.google.android.gms.maps.GoogleMap”包。

# c# - 禁止某些类型的通用类型约束？

> ID：15621454
> 
> 赞同：2
> 
> 时间：2013-03-25T17:51:37.000
> 
> 标签：c#, generics

我想创建一个通用方法：

```
MvcHtmlString MyMethod<T>(this HtmlHelper html, string title, IEnumerable<T> value) 
```

我的代码中有很多变量，它们是`List<T>`, `IEnumerable<T>`, `xxxCollection`, `T[]`, 等等……这个方法也有一个重载，它将采用不可枚举的值。`string`是否可以在类型参数约束中禁止特定类（如）？

我已经创建了一个这样的重载：

```
MvcHtmlString MyMethod<T>(this HtmlHelper html, string title, object value) 
```

这种重载有利于处理单个值，但处理值的集合需要稍微不同的实现。但是，`string`实现`IEnumerable`所以我的所有字符串变量都将被发送到错误的重载，除非我可以告诉编译器它们应该被排除。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T17:55:27.450

不可以。[泛型类型参数](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)约束只能强制执行*正*约束而不是*负*约束。

运行时类型检查可能是要走的路：

```
MvcHtmlString MyMethod<T>(this HtmlHelper html, string title, IEnumerable<T> value)
{
    if (typeof(T) == typeof(string))
    {
        throw new IllegalOperationException(...);
    }
} 
```

如果您想要传递给您的方法的所有类型都继承自同一个基类，或者实现相同的接口，您可以使用**jrummell**的单个约束建议来强制继承。

尽管它更不优雅，但如果您想支持异构类型，另一种方法是提供足够的重载来处理您的特定用例：

```
// supports int, float, DateTime, etc.
MvcHtmlString MyMethod(this HtmlHelper html, string title, IEnumerable<int> value)
MvcHtmlString MyMethod(this HtmlHelper html, string title, IEnumerable<float> value)
MvcHtmlString MyMethod(this HtmlHelper html, string title, IEnumerable<DateTime> value)

// supports implementations of MyInterface
MvcHtmlString MyMethod(this HtmlHelper html, string title, IEnumerable<IMyInterface> value) 
```

在上面的示例中，您将无法调用`MyMethod<string>`，因为它不满足任何提供的类型约束。请注意，您不能为此使用类型约束，因为它们不是方法签名的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T17:54:57.607

假设您只想将此扩展用于 Model 类型，您可以创建一个 Model 基类并限制`T`为实现它的类型。

```
MvcHtmlString MyMethod<T>(this HtmlHelper html, string title, IEnumerable<T> value)
    where T : ModelBase 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T18:25:13.183

考虑到您处理`string`.

鉴于您现有的接受 type 的方法， type`object`的参数`string`将导致您提出的新重载，因为`IEnumerable<char>`它比`object`. 但是，您不必放弃重载的想法，也不必求助于运行时检查。只需为`string`. 通过使编译器更容易使用场景来`object`回避整个决策。`IEnumerable<T>`

给定

```
void Foo(object argument)
{
    Console.WriteLine("object");
}

void Foo<T>(IEnumerable<T> argument)
{
    Console.WriteLine("enumerable T");
}

void Foo(string argument)
{
    Console.WriteLine("string");
} 
```

方法调用列表

```
Foo("hello");
Foo(1);
Foo(new int[] { 1 }); 
```

产生输出

```
string
object
enumerable T 
```

然后，您可以在一个地方进一步将您的字符串强制转换为您的对象重载。

```
void Foo(string argument)
{
    // Console.WriteLine("string");
    Foo((object)argument);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-25T17:56:02.097

抱歉不行。

您只能指定以下类型的约束：

```
where T : struct               // T must be a value type
where T : class                // T must be a reference type
where T : new()                // T must have a parameterless constructor
where T : <base class name>    // T must inherit from <base class>
where T : <interface name>     // T must implement <interface>
where T : U                    // T must inherit from U, where U is another
                               // generic parameter 
```

参考：[类型参数的约束](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)。

现在，您可以使用其中的一些来限制，但不能锁定类型，只能指定您允许的类型，例如接口实现约束。

您可以使用接口或基类约束来具体说“我允许的类型必须都具有以下特征”。我会说这将是你最好的选择。

你确定泛型是正确的工具吗？

# internationalization - 如何在 CQ5 字典中创建嵌套结构？

> ID：15621459
> 
> 赞同：2
> 
> 时间：2013-03-25T17:51:49.537
> 
> 标签：internationalization, aem, sling

我想知道是否有一种方法可以创建嵌套字典结构，让键以某种方式命名空间？（无需创建数百个字典）

我努力了：

```
{
    "jcr:createdBy": "admin",
    "sling:basename": "en-content",
    "jcr:mixinTypes": ["mix:language"],
    "jcr:created": "Mon Mar 25 2013 07:00:18 GMT-0400",
    "jcr:language": "en",
    "jcr:primaryType": "sling:Folder",
    "test": {
        "jcr:createdBy": "admin",
        "jcr:created": "Mon Mar 25 2013 13:26:52 GMT-0400",
        "jcr:primaryType": "nt:folder",
        "item": {
            "jcr:createdBy": "admin",
            "jcr:mixinTypes": ["sling:Message"],
            "jcr:created": "Mon Mar 25 2013 07:00:18 GMT-0400",
            "sling:message": "Value",
            "jcr:primaryType": "nt:folder"
        }
    }
} 
```

但`http://localhost:4503/libs/cq/i18n/translator.html`只显示`test`条目。

我直接从我的 JavaScript 应用程序中获取 CQ 的字典，因此嵌套的 JSON 格式对开发人员和内容创建者很有用。

根据[http://sling.apache.org/site/internationalization-support-i18n.html](http://sling.apache.org/site/internationalization-support-i18n.html)

> mix:language 节点的（直接）子节点必须包含两个命名键字符串和消息的特殊属性：

有没有其他方法可以从非直接孩子那里得到它，或者以某种方式解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T12:17:13.017

您提供的示例将起作用（尽管我更喜欢使用 nt:unstructured 作为节点类型进行测试。唯一的问题是您不能按原样使用 CQs Translator，因为它不知道名称间距。您可以扩展它寿或向 Adob​​e 提出功能请求。

HTH，（三）

# php - 将函数调用到 sprintf() 中的一些问题

> ID：15621462
> 
> 赞同：0
> 
> 时间：2013-03-25T17:51:54.567
> 
> 标签：php, wordpress-theming, printf, wordpress

我是 PHP 和 WordPress 的新手，我正在个性化现有的模板，但遇到以下问题。

在模板的**function.php**文件中，我具有以下功能：

```
function admired_posted_on() {
    printf( __( '<span class="sep">Posted on </span>
                 <a href="%1$s" title="%2$s" rel="bookmark">
                    <time class="entry-date" datetime="%3$s" pubdate>%4$s</time>
                 </a>
                 <span>%5$s</span>
                 <span class="by-author"> 
                    <span class="sep"> by bla</span> 
                    <span class="author vcard">
                        <a class="url fn n" href="%6$s" title="%7$s" rel="author">%8$s</a>
                    </span>
                 </span>
                 ', 'admired' ),

    esc_url( get_permalink() ),
    esc_attr( get_the_time() ),
    esc_attr( get_the_date( 'c' ) ),
    esc_html( get_the_date() ),
    sprintf('Views: ', get_PostViews(get_the_ID())),
    esc_url( get_author_posts_url( get_the_author_meta( 'ID' ) ) ),
    sprintf( esc_attr__( 'View all posts by %s', 'admired' ), get_the_author() ),
    esc_html( get_the_author() )
    );
} 
```

正如你所看到的，这个函数创建了一些 HTML 代码，这些代码将打印在我的模板的特定部分（在循环内）。

好的，你可以看到这一行：

```
sprintf('Views: ', get_PostViews(get_the_ID())), 
```

应该打印字符串“Views:”，后跟函数 get_the_ID() 返回的值（表示阅读帖子的人数）

正如你所看到的，这个函数是被调用函数列表中的第五个被调用函数，所以应该把这个值而不是**%5$s**占位符放在下面的 span 标签中：

```
<span>%5$s</span> 
```

问题是我在这个范围内执行我的页面时只出现值：**Views:**但没有出现 get_PostViews() 函数的输出。

如果不是原始行：

```
sprintf('Views: ', get_PostViews(get_the_ID())), 
```

我使用这条线：

```
sprintf(get_PostViews(get_the_ID())), 
```

它工作得很好，但我不能预先附加解释文本：“视图：”

为什么？我该怎么做才能打印“视图”文本，然后是 get_PostViews 函数的返回值？

肿瘤坏死因子

安德烈亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:16:25.203

```
sprintf('Views: %d', get_PostViews(get_the_ID())) 
```

第一个参数`sprintf`应该包含以下参数的占位符，“%d”格式告诉`sprintf`这应该是`integer`

[更多关于这个方法在这里](http://www.php.net/manual/en/function.sprintf.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:27:06.860

正如 hank 所提到的，您错过了文本中的占位符。

您也可以这样做，以便您可以在文本中多次使用同一个占位符。

```
sprintf('Views: %1$d', get_PostViews(get_the_ID())); 
```

# android - Android：从 XML 文件中解析图片和数据

> ID：15621463
> 
> 赞同：0
> 
> 时间：2013-03-25T17:51:56.440
> 
> 标签：android, xml, image, rss, adapter

我有一个这种格式的 xml 文件：

```
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0">
<channel>
<item>
<cache>0</cache>
<id>v_article_16276.html</id>
<article_id>16276</article_id>
<type>article</type>
<img>
http://www.mywebsite.com/image.jpg
</img>
<datePub>
<![CDATA[ 25.03.2013 | 17h37 | Par Fabrice Antonio ]]>
</datePub>
</item>
</channel>
</rss> 
```

我还想解析这些数据和图片链接，并将它们放在带有适配器的 listView 中；

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:padding="2dp" >

    <ImageView
        android:id="@+id/thumb"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:contentDescription="@string/app_name"
        android:src="@drawable/ic_launcher" />

    <RelativeLayout
        android:layout_width="wrap_content"
        android:layout_height="60dp"
        android:layout_centerVertical="true"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:layout_toLeftOf="@+id/arrow"
        android:layout_toRightOf="@+id/thumb"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/title"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:ellipsize="end"
            android:maxLines="2"
            android:text="@string/title"
            android:textSize="16sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/date"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentRight="true"
            android:layout_marginTop="5dp"
            android:padding="2dp"
            android:text="@string/date"
            android:textColor="#7F7F7F"
            android:textSize="10sp" />
    </RelativeLayout>

    <ImageView
        android:id="@+id/arrow"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:layout_marginRight="5dp"
        android:contentDescription="@string/app_name"
        android:src="@drawable/arrow_next" />

</RelativeLayout> 
```

图片必须取@+id/thumb ImageView,title取@id/title TextView,pubdate取@date TextView

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:11:35.657

> Android：从 XML 文件中解析图片和数据

因此，首先，如果您的数据源放置在 Internet 上，您需要获取它以进行下一步工作。为此，您可以使用`HttpClient`适当的`GET`请求，然后从响应中获取`XML`。

然后你需要使用一些 XML 解析器。您可以使用经典`DOM Parser`来实现您的目标。首先，您需要获取然后简单地获取下一项的元素`NodeList`。`<items>`

**伪代码：**

从互联网获取数据：

```
HttpClient client = new DefaultHttpClient();
HttpGet request = new HttpGet(<url>);
HttpResponse response = client.execute(request);
HttpEntity entity = response.getEntity();
String xml = EntityUtils.toString(entity); 
```

当您将 XML 作为 String 时，您可以从它的新创建`DOM Document`并开始解析。

```
Document doc = null;
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
DocumentBuilder builder = factory.newDocumentBuilder();
InputSource is = new InputSource(new StringReader(xml));
doc = builder.parse(is);

NodeList nodeList = doc.getElementsByTagName("item");
for (int i = 0; i < nodeList.getLength(); i++) {
    Element e = (Element) nodeList.item(i);
    String img = getElementValue(e, "img");
    String pubDate = getElementValue(e, "datePub");
    String type = getElementValue(e, "type");
} 
```

帮助方法 getElementValue()

```
public String getElementValue(Element e, String key) {
    NodeList nodes = e.getElementsByTagName(key);
    Node n = nodes.item(0);
    if (n != null) {
        return n.getFirstChild().getNodeValue();
    }
    return "";
} 
```

## 笔记：

最后，如果您正在执行网络操作，则必须将代码放入单独的/后台线程中，最好的选择是

*   [异步任务](http://developer.android.com/reference/android/os/AsyncTask.html)

# android - Ksoap2的正确使用方法

> ID：15621469
> 
> 赞同：0
> 
> 时间：2013-03-25T17:52:16.817
> 
> 标签：android, ksoap2

我正在尝试将我的 android 应用程序连接到数据库。我使用了 web 服务和 ksoap2。我用 jdbc 测试了我的数据库连接，它工作得很好，但是当我在我的应用程序中尝试它时，什么也没发生，有时它会出错。我尝试了一切，但我没有找到解决方案。这是我的代码：

```
public class LoginActivity extends Activity {
    private final String NAMESPACE = "http://ws.userlogin.com";
    private final String METHOD_NAME = "authentication";
    private final String SOAP_ACTION = "http://ws.userlogin.com/authentication";
    private final String URL = "http://192.168.1.3:8080/and-back/services/Login?wsdl";
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_login);
        Button login = (Button) findViewById(R.id.btn_login);
        login.setOnClickListener(new View.OnClickListener() {

            public void onClick(View arg0) {
                loginAction();

            }
        });
    }

    private void loginAction(){
        SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);

        EditText userName = (EditText) findViewById(R.id.tf_userName);
        String user_Name = userName.getText().toString();
        EditText userPassword = (EditText) findViewById(R.id.tf_password);
        String user_Password = userPassword.getText().toString();

      //Pass value for userName variable of the web service
        PropertyInfo unameProp =new PropertyInfo();
        unameProp.setName("userName");//Define the variable name in the web service method
        unameProp.setValue(user_Name);//set value for userName variable
        unameProp.setType(String.class);//Define the type of the variable
        request.addProperty(unameProp);//Pass properties to the variable

      //Pass value for Password variable of the web service
        PropertyInfo passwordProp =new PropertyInfo();
        passwordProp.setName("password");
        passwordProp.setValue(user_Password);
        passwordProp.setType(String.class);
        //request.addProperty(passwordProp);

        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.setOutputSoapObject(request);
        HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

        try{
            androidHttpTransport.call(SOAP_ACTION, envelope);
               SoapPrimitive response = (SoapPrimitive)envelope.getResponse();

               TextView result = (TextView) findViewById(R.id.tv_status);
               result.setText(response.toString());

        }
        catch(Exception e){
             e.printStackTrace();
        }
       }

} 
```

# facebook - 验证 Facebook 应用 ID 和应用密码

> ID：15621471
> 
> 赞同：2
> 
> 时间：2013-03-25T17:52:22.410
> 
> 标签：facebook, facebook-graph-api

我正在构建一个工具，允许我的组织在 Facebook 页面上添加预制标签，但用户必须使用它自己的 Facebook 应用程序并在配置中设置我的 URL。

我看过[这篇](https://stackoverflow.com/questions/6650107/how-to-validate-facebook-app-id)关于使用 ID 验证应用程序的帖子。但是我希望能够在将它们（加密）保存到数据库之前验证 App ID 和 App Secret 是否良好，以便用户可以添加页面选项卡并且我可以访问`signed_request`之后。

如何验证用户提供的 App ID 是否也有效？和他也提供的ID有关吗？

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:04:40.447

您可以通过向以下位置发出 GET 请求来获得所有这些信息：

```
https://graph.facebook.com/_APP_ID_?fields=roles&access_token=_APP_ID_|_APP_SECRET_ 
```

如果`_APP_ID_`和`_APP_SECRET_`提供的无效，则不会返回任何数据。如果这些都是有效的，那么`user`ID 应该在您返回的 json 对象中返回。

# android - 从菜单开始时如何恢复活动？

> ID：15621472
> 
> 赞同：1
> 
> 时间：2013-03-25T17:52:22.923
> 
> 标签：android, android-activity, resume

我正在构建一个包含许多活动的 Android GPS 应用程序。我的主屏幕是一个谷歌地图屏幕，它从远程数据库加载所有最近的位置。我还有其他可以从菜单按钮中选择的活动，例如列表模式、添加新位置、登录等。

当我按下列表模式（或任何其他活动）然后启动该活动并按下手机上的物理后退按钮时，我可以返回我的主屏幕，即我的地图活动，而无需重新启动和重新加载所有标记就像它在应用程序启动时所做的那样。但是，我的问题是，例如，当我处于列表模式，然后从菜单选项中按地图模式时，它会重新启动地图活动，以便重新检索位置。我希望能够按下这个地图模式按钮，然后像按下物理后退按钮一样恢复它。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:57:48.650

我相信您正在创建一个新的地图活动并将这个新实例放在活动堆栈的顶部。

所以你的活动堆栈看起来像这样：

*   **新**地图活动
*   列出活动
*   **旧**地图活动

如果我是对的，那么从这个“新”地图活动中按回来将带您回到列表活动。再次按下将带您进入原始地图活动（您正在寻找的活动。

因此，当您在 List Activity 中时，无需盯着一个新的 Map Activity，您只需简单地完成（）那个。

查看此文档以进一步阅读意图标志： [意图标志](http://blog.akquinet.de/2010/04/15/android-activites-and-tasks-series-intent-flags/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:03:03.600

我会看看这个：[管理活动生命周期](http://developer.android.com/training/basics/activity-lifecycle/index.html)。我有一个类似类型的应用程序，我需要“缓存”地图数据，以便我必须重新加载它。我以此为参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T23:37:53.410

在您的清单中，将 Map 活动的启动模式声明为 singleInstance。那我想你会没事的。来自[http://developer.android.com/reference/android/R.styleable.html#AndroidManifestActivity_launchMode](http://developer.android.com/reference/android/R.styleable.html#AndroidManifestActivity_launchMode)

只允许此活动的一个实例一直在运行。这个活动得到一个独特的任务，只有它自己在里面运行；如果它再次以相同的 Intent 启动，则该任务将被提前并调用其 Activity.onNewIntent() 方法。如果此活动尝试启动新活动，则该新活动将在单独的任务中启动。有关任务的更多详细信息，请参阅任务和回栈文档。

# c# - 实体框架以编程方式更新

> ID：15621475
> 
> 赞同：0
> 
> 时间：2013-03-25T17:52:31.427
> 
> 标签：c#, entity-framework, nuget-package

我有一个 ac# 项目，我在其中创建了一个实体框架上下文和所有 DBSet。
我可以通过包管理器控制台创建和迁移数据库。我想做的是做同样的事情，但在包管理器控制台中没有输入命令。如果可能的话，我想通过代码模拟这些命令；例如单击一个按钮，我可以调用`Update-Database -Force`.
有可能做这件事或类似的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:10:17.630

[您可以在此处](https://stackoverflow.com/questions/13342516/how-to-update-database-programmatically-in-entityframework-codefirst)找到问题的答案迁移库是通过一组库公开的。

# objective-c - 根据 max 属性从数组中获取对象

> ID：15621476
> 
> 赞同：0
> 
> 时间：2013-03-25T17:52:43.150
> 
> 标签：objective-c, macos, cocoa, nspredicate

我有一组具有属性的对象。我需要获取`<=`具有价值的对象。

我`[timeLog time]`是以秒为单位的，所以我需要将其转换为分钟，然后将其与`Object.conversion_factor`. 我最终想要的最大值`conversion_factor`是`<=`分钟`[timeLog time]`

这是最好的方法吗？是否有更好的方法（在一个谓词中完成所有这些操作）？

```
+ (NSNumber *)getTimeUnitForTimeLogEntry:(TimeLog *)timeLog
{
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity =
    [NSEntityDescription entityForName:@"TimeUnit"
                inManagedObjectContext:[[CoreDataHelper sharedInstance] managedObjectContext]];
    [request setEntity:entity];

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"conversion_factor <= %i", [OnTimeClasses getMinutesFromTime:[timeLog time]]];
    [request setPredicate:predicate];

    NSError *error;

    NSNumber *returnValue;
    NSArray *array = [[[CoreDataHelper sharedInstance] managedObjectContext] executeFetchRequest:request error:&error];
    NSLog(@"Array: %@", array);
    if (array != nil) {
        NSInteger unit = [[array valueForKeyPath:@"@max.conversion_factor"] integerValue];
        NSPredicate *finalPredicate = [NSPredicate predicateWithFormat:@"conversion_factor == %i", unit];
        [request setPredicate:finalPredicate];
        NSArray *array = [[[CoreDataHelper sharedInstance] managedObjectContext] executeFetchRequest:request error:&error];
        NSLog(@"New array: %@", array);
        TimeUnit *timeUnit = [array objectAtIndex:0];
        returnValue = [timeUnit id];
    }
    else {
        NSString *message = @"Unable to find a good time unit for entry.";
        NSAlert *alert = [NSAlert alertWithMessageText:@"Error" defaultButton:@"OK" alternateButton:nil otherButton:nil informativeTextWithFormat:@"%@", message];
        [alert runModal];
    }

    return returnValue;
}

+ (NSInteger)getMinutesFromTime:(NSString *)time
{
    double minutesFloat = [time doubleValue] / 60;
    NSInteger minutes = round(minutesFloat);

    return minutes;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:02:12.677

*添加一个按属性降序*排序的排序描述符，并将结果数限制为一个：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"conversion_factor <= %i", [OnTimeClasses getMinutesFromTime:[timeLog time]]];
[request setPredicate:predicate];
NSSortDescriptor *sortDesc = [NSSortDescriptor sortDescriptorWithKey:@"conversion_factor" ascending:NO];
[request setSortDescriptors:@[sortDesc]];
[request setFetchLimit:1]; 
```

然后，获取请求返回最大值`conversion_factor`小于或等于给定值的一个对象，如果没有找到匹配的对象，则返回一个空数组。

# ios - 在 iOS 应用中播放声音文件

> ID：15621479
> 
> 赞同：1
> 
> 时间：2013-03-25T17:52:56.693
> 
> 标签：ios

我正在制作一个根据视图控制器的选择播放声音文件的应用程序。我有一个将弹出的视图控制器，它显示一个带有城市名称、描述、图片和一个应该播放简单声音的按钮的视图。在下面的示例中，它将播放一个名为“slang4”的声音文件。这是实现文件中我的按钮的代码：

```
- (IBAction)soundButton:(id)sender{ 

    CFBundleRef mainBundle=CFBundleGetMainBundle();
    CFURLRef soundFileURLRef;
    soundFileURLRef=CFBundleCopyResourceURL(mainBundle, (CFStringRef)@"slang4", CFSTR("mp3"),NULL);
    UInt32 soundID;
   AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
   AudioServicesPlaySystemSound(soundID);

} 
```

问题是我希望按钮根据原始视图控制器（城市列表）的选择播放不同的声音。

例如，我的应用程序委托实现文件中的以下代码显示了每个城市如何拥有不同的声音文件：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    City *london = [[City alloc]init];
    london.cityName = @"London";
    london.cityDescription = @"The cap of UK.";
    london.cityPicture = [UIImage imageNamed:@"London.jpg"];
    london.soundFile=@"slang4.mp3";

    City *sanFranciso = [[City alloc]init];
    sanFranciso.cityName = @"San Francisco";
    sanFranciso.cityDescription=@"City by the Bay";
    sanFranciso.cityPicture = [UIImage imageNamed:@"SanFranciso.jpg"];
    sanFranciso.soundFile=@"babymama.mp3"; 
```

我的问题是我希望按钮能够知道根据城市播放哪个声音文件。我已经自学 iOS 编程大约 8 个月了，但我仍然是初学者。希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T17:37:42.233

听起来您的视图控制器`City`上已经有一个属性，因此在您的按钮操作中，您应该能够使用该`soundFile`属性中的声音文件。使用 的`componentsSeparatedByString:`方法`NSString`分为名称和扩展名。我认为您也可以只传递完整的文件名本身并`NULL`作为扩展名。此解决方案假定为 ARC。

```
NSArray *soundFileComponents = [self.city.soundFile componentsSeparatedByString:@"."];
if ([soundFileComponents count] == 2) {
    NSString *fileName = soundFileComponents[0];
    NSString *fileExtension = soundFileComponents[1];
    CFBundleRef mainBundle = CFBundleGetMainBundle();
    if (mainBundle) {
        CFURLRef soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (__bridge CFStringRef)fileName, (__bridge CFStringRef)fileExtension, NULL);
        if (soundFileURLRef) {
            UInt32 soundID;
            OSStatus resultCode = AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
            if (resultCode == kAudioServicesNoError) {
                AudioServicesPlaySystemSound(soundID);
            }
            else {
                NSLog(@"error creating system sound ID: %ld", resultCode);
            }
            CFRelease(soundFileURLRef);
        }
        else {
            NSLog(@"error loading sound file URL");
        }
    }
    else {
        NSLog(@"error loading main bundle");
    }
}
else {
    NSLog(@"error splitting filename into name and extension");
} 
```

# android - TextView 间距与换行符不一致

> ID：15621480
> 
> 赞同：0
> 
> 时间：2013-03-25T17:52:57.113
> 
> 标签：android, textview, spacing

我希望“Hello World”之间的间距等于“Stack Overflow”之间的间距，同时保持“World”和“Stack”之间的间距。"Hello World" 包含在 one`TextView`中，并带有换行符 "Hello \n World"。“堆栈溢出”分为两个`TextView`元素。我知道我可以`lineSpacingExtra`在布局中使用`myTextView`，但这也会在“世界”下方添加不需要的间距。

有没有一种优雅的方法来实现等间距？一个想法是在两个元素之间拆分“Hello World” `TextView`，并在我看到换行符时使用正则表达式进行拆分，但这有点小技巧。

布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
        >
    <TextView
            android:id="@+id/textview_wraptext"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            />
    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Stack"
            />
    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Overflow"
            />
</LinearLayout> 
```

Java 代码：

```
package com.example.TextViewSpacingExample;

import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

public class TextViewSpacing extends Activity {

    private TextView myTextView;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        myTextView = (TextView) findViewById(R.id.textview_wraptext);
        myTextView.setText("Hello \nWorld");
    }
} 
```

![截屏](../Images/768a6df24af85792a4f08bed2d471b3a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T17:58:00.510

我最终用a 重新设计了两个“Stack”和“Overflow”，`TextView`因为它是最简单的解决方案。`TextView``SpannableString`

# c# - 如何确保只有 *.exe 或 *.dll 文件进入输出文件夹，而任何其他构建文件进入中间文件夹 VS2012？

> ID：15621486
> 
> 赞同：4
> 
> 时间：2013-03-25T17:53:15.723
> 
> 标签：c#, visual-studio-2012, msbuild

我在 VS2012 上创建了一个 C# 项目，我希望输出文件夹只包含*.exe/* .dll 文件，并且在构建项目时创建的任何其他文件都将转到中间文件夹。

我有一个定义中间位置的属性表。

```
<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <BUILD_ROOT>f:\test</BUILD_ROOT>
    <BUILD_INTERMEDIATE>f:\test</BUILD_INTERMEDIATE>
  </PropertyGroup>

  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <IntermediateOutputPath>$(BUILD_INTERMEDIATE)\inter\debug\</IntermediateOutputPath>
    <BaseIntermediateOutputPath >$(IntermediateOutputPath)</BaseIntermediateOutputPath >
  </PropertyGroup>

  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <IntermediateOutputPath>$(BUILD_INTERMEDIATE)\inter\Release\</IntermediateOutputPath>
    <BaseIntermediateOutputPath >$(IntermediateOutputPath)</BaseIntermediateOutputPath >
  </PropertyGroup>

</Project> 
```

我手动将此属性表导入我的项目文件

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <Import Project="$(MSBuildProjectDirectory)\PropertySheet.props" /> 
```

当我构建项目时，它会为输出和中间创建单独的文件夹。中间文件夹包含所有中间文件以及 pdb 文件。但它也包含exe文件。

但我面临的问题是，输出文件夹也包含中间文件夹中的大部分文件。比如pdb、exe、config等。

任何人都可以通过解释我应该做什么来帮助我，以便只有 .exe 文件将位于输出文件夹中，而任何其他构建时间文件将仅保留在中间文件夹中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:01:53.237

您应该创建一个额外的“dist”文件夹（或类似文件夹）并在构建后将 exe 和 dll 文件复制到该文件夹​​。有许多 MSBuild 属性和目标可以将文件放在输出文件夹中，尝试更改此行为可能会破坏功能。

此外，如果您指定，`BaseIntermediateOutputPath`则不应指定`IntermediateOutputPath`. 在上述属性的情况下，您似乎正在尝试使用它：

```
<BaseIntermediateOutputPath>$(BUILD_INTERMEDIATE)\inter\</BaseIntermediateOutputPath> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:54:23.383

如果我这样做，我会创建一个 bat 文件以作为移动任何非 dll 和 exe 文件的构建后脚本运行。

# asp.net - 下拉列表在刷新时显示多个名称

> ID：15621487
> 
> 赞同：2
> 
> 时间：2013-03-25T17:53:17.617
> 
> 标签：asp.net

```
protected void Page_Load(object sender, EventArgs e)
{
    Response.Write(Session["email"].ToString());
    SqlConnection conn = new SqlConnection(dbConnectionString);
    conn.Open();
    string query = "select * from country";
    SqlCommand cmd = new SqlCommand(query,conn);
    SqlDataReader dr = cmd.ExecuteReader();
    drpdown_country.Items.Add(new ListItem("---select---", "0"));
    if (dr.HasRows)
    {
        while (dr.Read())
        {
            drpdown_country.Items.Add(new ListItem(dr["country"].ToString(), dr["c_id"].ToString()));
        }
    }
    conn.Close();
} 
```

每当我运行此代码并刷新页面
时，它都会再次显示所有 Countrynames

因此，当我刷新时，我获得的单个国家/地区名称的次数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:55:04.357

您的代码在回发时再次运行。

用以下方式包装您的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack){
      //code here
    }
} 
```

# sql - 具有固定表结构的四表连接

> ID：15621488
> 
> 赞同：-2
> 
> 时间：2013-03-25T17:53:21.370
> 
> 标签：sql, oracle

我正在尝试实现我认为是 Oracle 中四个表的内部联接。这是场景：

表：

```
Course
Course_ID | Title

Course_Offering
Offering_ID | Location | Course_ID

Attendance
Student_ID | Offering_ID 

Student
Student_ID | Name | Number etc. 
```

我正在尝试编写一个查询，该查询将仅显示学生参加过的课程的**student_name**和**标题**。学生可以参加存储在`Attendance`表中的课程的许多课程。我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:01:05.067

```
select s.student, c.title
from student s, attendance a, course_offering co, course c
where s.student_id  = a.student_id
and   a.offering_id = co.offering_id
and   co.course_id  = c.course_id
and   s.student_id = "insert id here"; 
```

This will give you what you are looking for as long as you know the student's ID.

# html - 让 div 留在父级之上

> ID：15621489
> 
> 赞同：3
> 
> 时间：2013-03-25T17:53:23.837
> 
> 标签：html, css, parent-child

我有一个乍一看不像的“问题”。所以，我有一个包含孩子的父 div。一个孩子将包含文本，另一个孩子将包含图片。两者都是内联块元素（它们需要彼此相邻定位），并且具有设定的宽度。现在，当图片 div 大于文本 div 时，父级继承该 div 的高度（最大的一个）。但是第二个孩子（较小）被放置在该 div 的底部。我想要的是让那个 div 总是在顶部。

我试过了

```
top: 0px; 
```

和东西，但它不起作用。它只是粘在底部。

这是我的示例（html）代码：

```
<div id="parent">
  <div id="child1"> Assassin's Creed IV: Black Flag: Gameplay Reveal Trailer - Chart your course through a treacherous and unpredictable world as the Assassin's Creed series hits the high seas in Assassin's Creed IV: Black Flag. <a href="http://bit.ly/Zny5pI">http://bit.ly/Zny5pI</a> </div>
  <div id="child2"> <img width="300px" src="http://sphotos-a.ak.fbcdn.net/hphotos-ak-ash3/536527_10151407411789285_1500143344_n.jpg" /> </div>
</div> 
```

这是CSS：

```
#parent {
  border: 2px solid green;
}

#child1 {
  border: 2px solid black;
  display: inline-block;
  width: 400px;
  margin: 2px;
  top: 0px;
}

#child2 {
  border: 2px solid red;
  display: inline-block;
  width: 300px;
} 
```

我刚刚以 GameTrailers 在 Facebook 上的帖子为例。

谁能帮助我解决这个“问题”？我不认为这很难，但是自从我使用 CSS 以来已经有一段时间了，而且它不是我最喜欢的“编码语言”：P

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-25T17:56:11.340

尝试添加 CSS 规则：

```
vertical-align:top; 
```

到您想要顶部对齐的所有内联块 div

祝你好运！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-25T17:58:20.803

而不是`display: inline`尝试`float: left`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-25T17:56:15.387

有几种不同的方法可以做到这一点，它们都应该有效。

1：

```
#parent > div{
    vertical-align: top;
} 
```

2：

```
#parent{
    position: relative;
}
#parent > div{
    position: absolute;
    top: 0px;
} 
```

3：

```
#parent > div{
    float: left;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-25T17:56:04.363

```
#parent > div {vertical-align: top} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T18:05:40.223

您总是可以使用绝对定位来做到这一点，尽管这通常会导致问题，尝试并坚持相对定位。

[http://jsfiddle.net/C6n86/](http://jsfiddle.net/C6n86/)

```
#parent {
   border: 2px solid green;
   width: 504px;
   margin: 0px;
   padding: 0px;
   position: relative;
   float: left;
}

#child1 {
  position: absolute;
  top: 0px;
  float: left;
  height: 279px;
  color: white;
}

#child2 {
  position: absolute;
  top: 0px;
  float:left;
} 
```

# php - 如何在上传器中允许其他文件类型

> ID：15621491
> 
> 赞同：-2
> 
> 时间：2013-03-25T17:53:29.880
> 
> 标签：php

这是我首先拥有的代码

```
$allowedExts = array("gif", "jpeg", "jpg", "PNG", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif") // .gif
|| ($_FILES["file"]["type"] == "image/jpeg") // .jpeg
|| ($_FILES["file"]["type"] == "image/jpg") // .jpg
|| ($_FILES["file"]["type"] == "image/jpg") // .jpg
|| ($_FILES["file"]["type"] == "image/PNG") // .PNG
|| ($_FILES["file"]["type"] == "image/png")) //.png
&& ($_FILES["file"]["size"] < 2000000)
&& in_array($extension, $allowedExts) 
```

我想要的是这样我也能够上传 .RAR/.ZIP 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:57:38.373

您只需将扩展名添加到 $allowedExts 数组，并在检查中添加文件类型的 mime 类型，如下所示：

```
$allowedExts = array("gif", "jpeg", "jpg", "PNG", "png", "zip", "rar");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif") // .gif
|| ($_FILES["file"]["type"] == "image/jpeg") // .jpeg
|| ($_FILES["file"]["type"] == "image/jpg") // .jpg
|| ($_FILES["file"]["type"] == "image/jpg") // .jpg
|| ($_FILES["file"]["type"] == "image/PNG") // .PNG
|| ($_FILES["file"]["type"] == "image/png")) //.png
|| ($_FILES["file"]["type"] == "application/x-rar-compressed")) //.rar (can also use application/octet-stream)
|| ($_FILES["file"]["type"] == "application/zip")) //.zip (can also use application/octet-stream)
&& ($_FILES["file"]["size"] < 2000000)
&& in_array($extension, $allowedExts) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:56:19.697

您并没有真正给我们太多的帮助，但是根据我们掌握的信息，您会做类似...

```
$allowedExts = array("gif", "jpeg", "jpg", "PNG", "png","rar","zip");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif") // .gif
|| ($_FILES["file"]["type"] == "image/jpeg") // .jpeg
|| ($_FILES["file"]["type"] == "image/jpg") // .jpg
|| ($_FILES["file"]["type"] == "image/jpg") // .jpg
|| ($_FILES["file"]["type"] == "image/PNG") // .PNG
|| ($_FILES["file"]["type"] == "image/png")
|| ($_FILES["file"]["type"] == "application/x-rar-compressed")
|| ($_FILES["file"]["type"] == "application/zip"))
&& ($_FILES["file"]["size"] < 2000000)
&& in_array($extension, $allowedExts) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T17:58:59.397

你不能相信正在发生的事情，`$_FILES["file"]["type"]`因为它是由浏览器发送的，很容易被欺骗。

我建议您使用[fileInfo](http://php.net/manual/en/ref.fileinfo.php)扩展名来启动，您可以在其中实际检查服务器端的 mime 类型。

然后使用 while/black list 数组来允许/拒绝用户上传的扩展类型

# jquery - jQuery 用于 GridView 列标题中的 CheckAll CheckBox

> ID：15621493
> 
> 赞同：2
> 
> 时间：2013-03-25T17:53:35.000
> 
> 标签：jquery, asp.net, gridview

我们有一个多列的 GridView。其中两列包含 CheckBox，其余列包含 TextBox 或 DropDownList。

放置 GridView 的表单嵌入在母版页中。

在标题行中使用 CheckBox，我们希望将最后一列中的所有复选框设置为标题中 CheckBox 的状态。我们不想设置第 4 列中的复选框。CheckBox 的 ID 为“chkUpdate”

我看到的示例每行只有 1 个复选框并使用 CSS 类来识别它，但是我们 GridView 行上的两个复选框都使用相同的 CSS 类，并且必须创建一个新的 CSS 类来识别不同的列似乎是错误的复选框

我知道我可以在 GridView 的行上使用 each 循环，但无法弄清楚如何识别最后一列中的复选框

```
function checkAll(objRef) {
    $("#<%=gv_Vials.ClientID %> tr").each(function() {
    //What goes here? = objRef.checked;
    };
} 
```

我希望我已经解释了我的要求，但如果有人需要进一步澄清，请随时询问

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:26:02.543

基本上，你可以使用 jQuery 的 end 和 selector - `id*="chkSelected"`。它将选择所有复选框以`chkSelected`

```
<asp:GridView runat="server" ID="gv_Vials">
    <Columns>
        <asp:TemplateField>
            <HeaderTemplate>
                <input id="btnCheckAll" type="checkbox" name="AllCheck" />
            </HeaderTemplate>
            <ItemTemplate>
                <asp:CheckBox runat="server" ID="chkSelected" Checked='<%# bool.Parse(Eval("IsActive").ToString()) %>'/>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView>
<script>
    var checkBoxSelector = '#<%=gv_Vials.ClientID%> input[id*="chkSelected"]:checkbox';

    $(document).ready(function () {
        $('#btnCheckAll').live('click', function () {
            if ($('#btnCheckAll').is(':checked')) {
                $(checkBoxSelector).attr('checked', true);
            }
            else {
                $(checkBoxSelector).attr('checked', false);
            }
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-25T01:20:07.947

我就是这样做的。

ASP.NET：

```
 <asp:GridView ID="gvStudents" runat="server" DataSourceID="SqlDataSourceStudents" AutoGenerateColumns="False" Width="100%" OnRowDataBound="gvStudents_RowDataBound">
                <HeaderStyle BackColor="#5D7B9D" ForeColor="White" />
                <AlternatingRowStyle BackColor="#EEEEEE" />
                <RowStyle BackColor="White" />
                <Columns>
**..normal column templates or boundfields go here..**
                    <asp:TemplateField>
                        <HeaderTemplate>
                            <asp:CheckBox id="CheckBoxAll" runat="server" onclick="javascript:SelectAllCheckboxesCol(this);"/>
                        </HeaderTemplate>
                        <ItemTemplate>
                            <asp:CheckBox ID="CheckBoxAdd" runat="server" onclick="javascript:HighlightRow(this);"/>
                        </ItemTemplate>
                        <ItemStyle HorizontalAlign="Center" />
                    </asp:TemplateField>
                </Columns>
            </asp:GridView> 
```

jQuery：

```
 //jQuery to select all checkboxes on the last column (4th column) of gvStudents
        function SelectAllCheckboxesCol(chk) 
        {
            $('#<%=gvStudents.ClientID %> >tbody >tr >td:nth-child(4) > input:checkbox').attr('checked', chk.checked);

            //this works but there must be a better way! jQuery is not my fortae yet :)
            cBox.attr('checked', chk.checked);  //check all the checkboxes
            cBox.click();                       //click them all to fire the Highlightrow() function. This un-ticks the checkboxes!
            cBox.attr('checked', chk.checked);  //re-check them again!
        }

        //jQuery to highlight a row selected
        function HighlightRow(chk) {
            var isChecked = chk.checked;
            var $selectedRow = $("#" + chk.id).parent("td").parent("tr");
            var selectedIndex = $selectedRow[0].rowIndex;
            var sColor = '';

            if(selectedIndex%2 == 0)
                sColor = '#EEEEEE';
            else
                sColor = 'white';

            if(isChecked)
                $selectedRow.css({
                    "background-color" : "Yellow",
                    "color" : "Black"
                });
            else
                $selectedRow.css({
                    "background-color" : sColor,
                    "color" : "Black"
                });
        }
} 
```

具有以上特点的有：

*   后面没有代码
*   同时高亮一行，并恢复原来的交替行背景
*   仅选择特定列和特定 Gridview 的复选框

缺点：

*   它要求您硬编码 Gridview 的名称并指定列号

# python - 使用 distutils 为 python 扩展构建 RPM 时的相对包含路径

> ID：15621499
> 
> 赞同：1
> 
> 时间：2013-03-25T17:54:08.643
> 
> 标签：python, rpm, distutils, python-extensions

使用 python 2.6，我正在尝试为 python C 扩展模块构建一个 RPM。

`setup.py`我正在使用的包含以下内容：

```
from distutils.core import setup, Extension

foo_ext = Extension('foo',
                    sources=['foo.c', '../src/common.c'],
                    include_dirs=['../includes'])

setup(... , ext_modules=[foo_ext]) 
```

例如，如果我运行它`python setup.py build`，它编译和构建没有任何错误，并使用正确的路径调用，即：`/devel/foo``gcc`

```
gcc ... -I/devel/includes ... 
```

当我`python setup.py bdist_rpm`改为使用时，上面使用的相对路径将转换为相对于 RPM 构建目录的绝对路径，这导致`gcc`尝试使用以下命令进行编译：

```
gcc ... -I/devel/foo/build/bdist.linux-x86_64/rpm/BUILD/includes ... 
```

然后编译失败，因为`.h`在包含路径中找不到所需的文件。

对此有任何建议或解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T10:08:18.953

通过在第一次通过脚本时设置环境变量来解决，然后在构建 RPM 时再次读取：

```
import os
from distutils.core import setup, Extension

src_path = os.path.abspath('../src/common.c')
inc_path = os.path.abspath('../includes')

if 'SRC_PATH' not in os.environ:
    os.environ['SRC_PATH'] = src_path
    os.environ['INC_PATH'] = inc_path
else:
    src_path = os.environ['SRC_PATH']
    inc_path = os.environ['INC_PATH']

foo_ext = Extension('foo',
                sources=['foo.c', src_path],
                include_dirs=[inc_path])

setup(... , ext_modules=[foo_ext]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-12T17:01:34.173

*我可以通过为distutils*提供一个适当的文件来解决类似的问题`MANIFEST.in`，该文件枚举了我想要包含的所有头文件。就我而言，它是这样的：

```
include src/_rvlm_fdtd/include/rvlm/fdtd/* –or–
recursive-include src/_rvlm_fdtd *.h 
```

但我认为这不适用于您的`../`路径。相反，我建议您将所有源代码放在包基目录中。

RPM 构建阶段无法找到您的标头的原因是因为它首先构建了一个源代码分发版（使用`setup.py sdist`）并将生成的 tarball 解压到一个临时构建目录中。因此，您的源代码分发版并未包含构建所需的所有文件。

# java - Java JNA 从 D2D1 映射 D2D1CreateFactory

> ID：15621505
> 
> 赞同：0
> 
> 时间：2013-03-25T17:54:20.220
> 
> 标签：java, c++, jna

我试图从 DLL D2D1.dll 映射函数 D2D1CreateFactory。从那里我想建立一个 Direct2D Java 映射，但那是题外话。到目前为止，我有这个：

```
public WinNT.HRESULT D2D1CreateFactory(int factoryType, REFIID riid, ID2D1Factory.ByReference ppIFactory); 
```

ID2D1Factory 如下所示：

```
public class ID2D1Factory extends IUnknown {

    public ID2D1Factory() { }

    public ID2D1Factory(Pointer pvInstance) {
        super(pvInstance);
    }

} 
```

当我尝试使用下面的代码运行我的代码时，抛出“java.lang.Error: Invalid memory access”（打开 JNA.setProtected() 时）。

要运行的代码：

```
ID2D1Factory.ByReference ref= new ID2D1Factory.ByReference();
D2D1.INSTANCE.D2D1CreateFactory(0, new REFIID(new IID("06152247-6f50-465a-9245-118bfd3b6007").toByteArray()), ref); 
```

我不知道为什么。有什么我做错了吗？

**编辑：**感谢 technomage 我能够获得正确的方法声明。该方法应该这样声明：

```
public WinNT.HRESULT D2D1CreateFactory(int factoryType, REFIID riid, D2D1_FACTORY_OPTIONS opts, PointerByReference pref); 
```

D2D1_FACTORY_OPTIONS 结构映射如下：

```
public static class D2D1_FACTORY_OPTIONS extends Structure {
    public int debugLevel;
    protected List<String> getFieldOrder() {
        return Arrays.asList(new String[] { "debugLevel" });
    }
    public D2D1_FACTORY_OPTIONS() {}
    public D2D1_FACTORY_OPTIONS(int size) {
        super(new Memory(size));
    }
    public D2D1_FACTORY_OPTIONS(Pointer memory) {
        super(memory);
        read();
    }
} 
```

最后，调用该方法的代码片段：

```
D2D1_FACTORY_OPTIONS opts = new D2D1_FACTORY_OPTIONS();
PointerByReference pp = new PointerByReference();
D2D1.INSTANCE.D2D1CreateFactory(0, new REFIID(new IID("06152247-6f50-465a-9245-118bfd3b6007").toByteArray()), opts, pp); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:20:20.413

根据[这个参考](http://msdn.microsoft.com/en-us/library/windows/desktop/dd368034%28v=vs.85%29.aspx)，`D2D1CreateFactory`需要指针类型作为第三个和第四个参数（你只声明了三个参数）。

假设您插入选项指针（一个简单的`struct *`），您的最后一个参数需要是`PointerByReference`，因为该函数将在您给它的地址中“返回”一个指针值。

然后，您可以使用`PointerByReference.getValue()`来初始化一个新`ID2D1Factory`实例（`Structure.ByReference`在这种情况下是多余的，因为默认情况下，所有作为函数参数的结构都被 JNA 视为`struct *`除非另有明确定义）。

```
public WinNT.HRESULT D2D1CreateFactory(int factoryType, REFIID riid, D2D1_FACTORY_OPTIONS options, ID2D1Factory ppIFactory);

public class D2D1_FACTORY_OPTIONS extends Structure { ... }

D2D1_FACTORY_OPTIONS options = ...;
PointerByReference pref = new PointerByReference();

D2D1.INSTANCE.D2D1CreateFactory(0, new REFIID(...), options, pref);
ID2D1Factory factory = new ID2D1Factory(pref.getValue()); 
```

别忘了打电话给`Structure.read()`你的`ID2D1Factory(Pointer)`医生。

# vb.net - 复制列表视图单元格

> ID：15621507
> 
> 赞同：0
> 
> 时间：2013-03-25T17:54:25.527
> 
> 标签：vb.net, listview, copy

是否可以复制选定的列表视图单元格？我知道可以在 datagridview 中做到这一点，但我不确定我们是否可以在 listview 中......例如：

![复制红色矩形](../Images/c7c655bc2502915b900a672c2e37cbcd.png)

```
Dim s As String = ""

For Each lsvrow As ListViewItem In lwBills.SelectedItems
    s &= lsvrow.Text & ControlChars.NewLine
Next

Clipboard.SetDataObject(s) 
```

这将复制该行的文本（本例中为**10133**）。子项包括**206-0015-04B**和**K-3390**，但我当前的示例不会复制子项。我不想复制整行，只复制我右键单击的部分（在本例中**为 206-0015-04B**）

Listview 可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:08:21.590

这可以使用`MouseClick`事件和`HitTest`方法的组合来实现`ListView`。

处理`MouseClick`事件，然后在事件处理过程中使用`HitTest`方法查看`SubItem`鼠标指针在哪个下方，如下：

```
Private Sub lwBills_Click(sender As System.Object, e As MouseEventArgs) Handles lwBills.MouseClick
    Dim Info As ListViewHitTestInfo
    Dim s As String

    Info = lwBills.HitTest(e.Location)
    s = Info.SubItem.Text
    Clipboard.SetDataObject(s)
End Sub 
```

我假设这`lwBills`是上面示例中您的 ListView 的名称。

# django - Django外键权限

> ID：15621508
> 
> 赞同：1
> 
> 时间：2013-03-25T17:54:28.707
> 
> 标签：django, django-models, django-permissions

```
class Application(models.Model):
    name = models.CharField(max_length=100)
    icon_url = models.CharField(max_length=100)
    app_url = models.CharField(max_length=200) 
```

我想添加另一个字段，`required_permission`该字段应该是权限的外键。该字段定义应该是什么样的？

这背后的原因是在模板中，我可以使用这样的东西（伪代码）

```
{% for app in application_list %}
    {% if user_has_permission(app.required_permission) %}
        Show App
    {% endif %}
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T05:29:46.090

你`required_permission`可以是一个`CharField`. 只要您可以创建与此功能一起使用的权限列表。

> **has_perms(perm_list, obj=None)**
> 如果用户具有每个指定的权限，则返回 True，其中每个 perm 的格式为`"<app label>.<permission codename>"`。如果用户处于非活动状态，此方法将始终返回 False。
> 
> 如果传入 obj ，则此方法不会检查模型的权限，而是检查特定对象的权限。

请注意，您不能在 Django 模板中调用带参数的函数，您应该编写一个模板标签。

# iis-8 - 如何查看当前在 IIS 8 上执行的 Web 请求

> ID：15621509
> 
> 赞同：53
> 
> 时间：2013-03-25T17:54:32.337
> 
> 标签：iis-8

在 IIS 7 中，我会单击“工作进程”，然后单击“查看当前请求”以查看当前正在执行的所有请求。

[http://technet.microsoft.com/en-us/library/cc732518(v=WS.10).aspx](http://technet.microsoft.com/en-us/library/cc732518(v=WS.10).aspx)

在 IIS 8 中，我看不到此选项。我需要在 IIS 8 上设置什么吗？

编辑：我也尝试以管理员身份运行 inetmgr。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-03-25T18:59:26.340

没有任何 UI 提示，但能够将其作为服务器管理器下的功能打开。

服务器管理器 -> 添加角色。

*   网络服务器 (IIS)

    *   网络服务器
        *   健康和诊断
            *   请求监视器

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2015-06-11T01:16:00.327

可以使用 PowerShell 安装所需的功能。

IIS 管理器：

```
Install-WindowsFeature Web-Mgmt-Tools 
```

请求监视器：

```
Install-WindowsFeature Web-Request-Monitor 
```

安装这些功能后，运行 IIS 管理器，浏览到下面屏幕截图中显示的工作进程部分。从工作进程列表中，双击感兴趣的进程以查看当前正在执行的请求或使用右键单击上下文菜单。

![在此处输入图像描述](../Images/853cd3955bde50b149a980afe19e4dea.png)

地址栏左侧的后退/前进箭头可用于在请求列表和工作进程之间来回导航。`alt+left arrow`/`alt+right arrow`键执行相同的操作。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-01-05T16:17:15.763

我必须从提升的命令行执行此操作

```
%windir%\system32\inetsrv\appcmd list requests 
```

如果您想查看超过 5 秒的请求

```
%windir%\system32\inetsrv\appcmd list requests /elapsed:5000 
```

在一个循环中（假设你在`%windir%\system32\inetsrv\`

```
for /l %x in (,,) do (appcmd list requests /elapsed:5000 & timeout 2) 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-01-23T22:41:45.873

这个节目是安装它的步骤。来自[https://portal.ektron.com/KB/10396/](https://portal.ektron.com/KB/10396/)：

要在安装后运行它，您需要在 IIS 管理器的服务器设置中找到“工作进程”图标。

![在此处输入图像描述](../Images/97342bf5d681beef42278db4a342a91e.png)

使用 ASP.net 的另一个不错的选择是转到任务管理器，右键单击进程并选择“创建转储文件”，然后下载并双击创建的 .dmp 文件以将其加载到 Visual Studios 调试器中。然后通过线程及其调用堆栈查看所有请求的执行位置。**此方法允许您准确查看请求在做什么（无限循环、死锁等）**

# python - 如何理解 IMAP 电子邮件文本中的等号“=”符号？

> ID：15621510
> 
> 赞同：35
> 
> 时间：2013-03-25T17:54:37.887
> 
> 标签：python, html, imap, gmail-imap, imaplib

我目前正在使用 Python imaplib 来处理电子邮件文本。

我使用 fetch 命令从 GMail 服务器获取原始数据电子邮件。然而，我发现一件事非常棘手 - 等号'='。它不是一个普通的等号，而是一个特殊的符号。

例如：

1.  '=' 有时充当文本行末尾的连字符：

    ```
    Depending upon your module selections, course lecturers may also contact yo=
    u with preparatory work over the next few weeks. It would be wise to start =
    reviewing the preparatory reading lists provided on the module syllabi now = 
    ```

2.  有时，它充当类似于 '%' 的转义标记，例如：

    `a=20b`实际上`a<SPACE>b`
    `=46rom here`是实际上是`From here`

我对这种奇怪的符号完全感到困惑。我认为必须有一个指导来处理这个问题，因为 GMail 可以在他们的应用程序中正确处理这样的事情。

我看到这与 HTML 编码有关，就像 '%' 将被编码一样。但问题是，我从 IMAP 响应中得到的只是一个包含这个“=”符号的字符串。我该如何处理？使用正则表达式？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-03-25T18:01:02.513

In a nutshell, an equal sign at the end of a line indicates a soft line break. An equal sign followed by two hexadecimal characters (0-9, A-F) encodes a single octet (byte).

This encoding scheme is called "quoted printable" and is defined in section 6.7 of [RFC 2045](http://www.faqs.org/rfcs/rfc2045.html). See items (1) and (5), in particular.

```
6.7\.  Quoted-Printable Content-Transfer-Encoding

   The Quoted-Printable encoding is intended to represent data that
   largely consists of octets that correspond to printable characters in
   the US-ASCII character set.  It encodes the data in such a way that
   the resulting octets are unlikely to be modified by mail transport.
   If the data being encoded are mostly US-ASCII text, the encoded form
   of the data remains largely recognizable by humans.  A body which is
   entirely US-ASCII may also be encoded in Quoted-Printable to ensure
   the integrity of the data should the message pass through a
   character-translating, and/or line-wrapping gateway.

   In this encoding, octets are to be represented as determined by the
   following rules:

    (1)   (General 8bit representation) Any octet, except a CR or
          LF that is part of a CRLF line break of the canonical
          (standard) form of the data being encoded, may be
          represented by an "=" followed by a two digit
          hexadecimal representation of the octet's value.  The
          digits of the hexadecimal alphabet, for this purpose,
          are "0123456789ABCDEF".  Uppercase letters must be
          used; lowercase letters are not allowed.  Thus, for
          example, the decimal value 12 (US-ASCII form feed) can
          be represented by "=0C", and the decimal value 61 (US-
          ASCII EQUAL SIGN) can be represented by "=3D".  This
          rule must be followed except when the following rules
          allow an alternative encoding.

    (2)   (Literal representation) Octets with decimal values of
          33 through 60 inclusive, and 62 through 126, inclusive,
          MAY be represented as the US-ASCII characters which
          correspond to those octets (EXCLAMATION POINT through
          LESS THAN, and GREATER THAN through TILDE,
          respectively).

    (3)   (White Space) Octets with values of 9 and 32 MAY be
          represented as US-ASCII TAB (HT) and SPACE characters,

          respectively, but MUST NOT be so represented at the end
          of an encoded line.  Any TAB (HT) or SPACE characters
          on an encoded line MUST thus be followed on that line
          by a printable character.  In particular, an "=" at the
          end of an encoded line, indicating a soft line break
          (see rule #5) may follow one or more TAB (HT) or SPACE
          characters.  It follows that an octet with decimal
          value 9 or 32 appearing at the end of an encoded line
          must be represented according to Rule #1\.  This rule is
          necessary because some MTAs (Message Transport Agents,
          programs which transport messages from one user to
          another, or perform a portion of such transfers) are
          known to pad lines of text with SPACEs, and others are
          known to remove "white space" characters from the end
          of a line.  Therefore, when decoding a Quoted-Printable
          body, any trailing white space on a line must be
          deleted, as it will necessarily have been added by
          intermediate transport agents.

    (4)   (Line Breaks) A line break in a text body, represented
          as a CRLF sequence in the text canonical form, must be
          represented by a (RFC 822) line break, which is also a
          CRLF sequence, in the Quoted-Printable encoding.  Since
          the canonical representation of media types other than
          text do not generally include the representation of
          line breaks as CRLF sequences, no hard line breaks
          (i.e. line breaks that are intended to be meaningful
          and to be displayed to the user) can occur in the
          quoted-printable encoding of such types.  Sequences
          like "=0D", "=0A", "=0A=0D" and "=0D=0A" will routinely
          appear in non-text data represented in quoted-
          printable, of course.

          Note that many implementations may elect to encode the
          local representation of various content types directly
          rather than converting to canonical form first,
          encoding, and then converting back to local
          representation.  In particular, this may apply to plain
          text material on systems that use newline conventions
          other than a CRLF terminator sequence.  Such an
          implementation optimization is permissible, but only
          when the combined canonicalization-encoding step is
          equivalent to performing the three steps separately.

    (5)   (Soft Line Breaks) The Quoted-Printable encoding
          REQUIRES that encoded lines be no more than 76
          characters long.  If longer lines are to be encoded
          with the Quoted-Printable encoding, "soft" line breaks
          must be used.  An equal sign as the last character on a
          encoded line indicates such a non-significant ("soft")
          line break in the encoded text. 
```

# javascript - jQuery插件错误

> ID：15621516
> 
> 赞同：0
> 
> 时间：2013-03-25T17:54:58.830
> 
> 标签：javascript, jquery, dom, plugins

我正在使用 jquery 1.9.1，并且正在尝试开发一个插件。问题是插件不起作用。这是代码：

```
 ;(function($) {

    $.fn.single = function() {

        return this.each(function(){

            // Get the instance
            var element = $(this);

            // Resize the "data-target" divs
            element.load(function(){
                changeCSS(element);
            });

            // Bind the method to the resize window event
            $(window).bind("resize", function(){  
                changeCSS(element);  
            });

        });

    };

    // function to resize all the "data-target" divs
    function changeCSS(element) {

        // Grab the screen resolution
        var windowWidth     = $(window).width();
        var windowHeight    = $(window).height();
        // Count how many targets the div has
        var targetsSize     = $("[data-target]").size();

        // Resize the parent div
        $(element).css({
            "width" : windowWidth,
            "height": windowHeight * targetsSize
        });

        // Resize all the targets div
        $(element + "> div[data-target]").each(function(){
            $(this).css({
                "width" : windowWidth,
                "height": windowHeight
            });
        });

    }

})(jQuery); 
```

我在文件上这样称呼它：

```
<script src="js/jquery-1.9.1.min.js"></script>
    <script src="js/single-0.1.0.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $("#single").single();
        });
    </script> 
```

控制台没有问题。我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:07:26.840

我假设这是因为您滥用了**.load**方法。如果您查看 jQuery 文档，它适用于：

> .load() ：从服务器加载数据并将返回的 HTML 放入匹配的元素中。

[http://api.jquery.com/load/](http://api.jquery.com/load/)

删除这些行`element.load(function ...`，只需调用你的 changeCSS 函数，你已经在 Document.Ready 上加载了这个扩展

```
 return this.each(function () {
        // ...

        changeCSS(element); // <-- just run the function right away

        // ... etc
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:37:13.660

通常，在声明函数之前调用它是不好的做法。为了让你的插件正确，你最好从一开始就正确地构建它。除此之外，正如@mcpDESIGNS 指出的那样，您错误地使用了**.load**方法。此外，如果您在此处解释您要与之共谋的具体内容，这将很有用。

要开始制作 jQuery 插件，请尝试查看[此处](http://docs.jquery.com/Plugins/Authoring)的 jQuery 文档，或者您可以查看[本](http://boxsheep.com/javascript-tutorials/jQuery-Plugin-tutorial_How-to-make-a-jQuery-plugin-part-1/)教程。

这是首选结构：

```
(function($) {

  // Declare your methods at the beginning of your plugin
  var yourMethods = {
    'methodOne' : function() {

    },
    'methodTwo' : function() {

    }
  };

  $.fn.pluginName = function() {

    return this.each(function() {

    });

  }
}(jQuery)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T14:13:30.893

代替：

```
element.load(function(){
    changeCSS(element);
}); 
```

我做了：

```
changeCSS(element); 
```

并且...而不是：

```
$(element + "> div[data-target]") 
```

我做了：

```
$(element).children('div[data-target]') 
```

现在插件正在执行，没有错误或错误。多谢你们！

# c++ - 避免沿并行层次结构向下转换值

> ID：15621517
> 
> 赞同：0
> 
> 时间：2013-03-25T17:55:04.387
> 
> 标签：c++, downcast

我有两个类层次结构：

```
BaseUnit <- S1Unit , BaseUnit <- S2Unit, ..S3Unit, S4Unit 
```

和

```
Base <- S1 , Base <- S2 
```

在`Base`我存储单位的价值。

```
class Base {
  protected: BaseUnit unit; // actually this is an upcast of S1Unit, S2Unit
  // of course I do several things with unit on methods of Base 
} 
```

它基于 S1Unit、S2Unit ..

```
S1::S1(S1Unit s1unit) : unit(s1unit) { .. } 
```

但是，如果我现在想退回 S1 中的专用单元，我该怎么做才最好呢？

```
S1Unit S1::getUnit() const { return this->unit; /* how to cast down? */ } 
```

我可以实现`S1Unit`一个`BaseUnit` `S1Unit::S1Unit(BaseUnit)`可以正常工作的构造函数，但是这种向下转换的复制构造函数在某种程度上不是很好。我检查过的所有答案都显示了使用指针的示例。

**什么是更好的解决方案？有什么选择吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:04:25.567

类之间不同的功能应该通过[虚函数](http://en.wikipedia.org/wiki/Virtual_function)公开。

然后，您无需将对象向下扔，您只需 return 即可`unit`。调用的成员函数将是您创建的对象的正确函数。

# html - 目标 j 在浏览器中加载缓慢

> ID：15621519
> 
> 赞同：1
> 
> 时间：2013-03-25T17:55:06.957
> 
> 标签：html, xcode, objective-j

我是 iOS 开发者。我只知道几种语言，我讨厌 html，因为那里缺乏可能性。我只是对 Objective-j 感到不满。当我尝试在网络浏览器（Safari、Google Chrome 的最新版本）中打开任何代码时，它的加载**速度非常慢。**.

1.  正常吗？
2.  如何让它快速工作？
3.  是否有任何其他类似于 c、objective-c 的语言可用于创建网站？

随之而来的另一个问题是：如何让 Xcode 与 Objective-j 一起工作？我目前使用 coda 2.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:30:21.710

确保您运行`jake deploy`以创建您正在测试的应用程序的剥离和预编译版本。大多数示例代码将在未编译的“调试”模式下运行，这在您开发时非常有用，但在实际部署中，您需要应用程序的预编译版本。

此外，Cappuccino 和 Objective-J 的当前开发版本比上一个版本 0.9.6 快得多，这要归功于一个新的、更好的编译器。请留意未来的 Cappuccino 0.9.7 版本。

我认为，如果您在 Cappuccino 中编写一个重要的应用程序，您会发现加载时间与 Gmail 等其他大型网络应用程序完全可比。

目前您只能使用[Xcode 来编辑 Cappuccino 应用程序的用户界面](http://www.cappuccino-project.org/learn/xcode-basics.html)。编辑 Cappuccino 代码本身效果不佳，因为最新版本的 Xcode 不包含必要的插件框架。[您可以在开发环境](http://www.cappuccino-project.org/learn/environment.html)教程中了解有关良好编辑器选项的更多信息。

我不熟悉类似于 Web 的 Objective-C 的其他语言，但英特尔在[这里](http://software.intel.com/en-us/articles/technical-reference-intel-html5-app-porter-tool-beta)有一个 Objective-C 到 JavaScript 的编译器。

# java - Log4j - 找不到日志文件

> ID：15621520
> 
> 赞同：10
> 
> 时间：2013-03-25T17:55:18.180
> 
> 标签：java, logging, log4j

当我将应用程序部署到运行 JRE 1.7 的其他计算机时，我遇到了崩溃的问题。当我在 PC 上的 NetBeans 内部（甚至直接从 JAR 文件）运行它时，一切都很好。但在另一台计算机上，它在执行期间在特定事件（按钮单击）时失败。

所以，我学习了使用 log4j 库进行日志记录。这给了我一些关于我的应用程序问题的信息，并且日志记录工作完美，再次在我的计算机上。但是，当我将 JAR 文件部署到仅运行 JRE（Java 7 Update 17）的其他计算机时，我找不到任何日志文件的痕迹。

这是我的 log4j.properties 文件：

```
 # Root logger option 
 log4j.rootLogger=INFO, file, stdout  

 # Direct log messages to a log file log4j.appender.file=org.apache.log4j.RollingFileAppender
 log4j.appender.file.File=C:\logging.log
 log4j.appender.file.MaxFileSize=1MB
 log4j.appender.file.MaxBackupIndex=1
 log4j.appender.file.layout=org.apache.log4j.PatternLayout
 log4j.appender.file.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss}
 %-5p %c{1}:%L - %m%n  

 # Direct log messages to stdout log4j.appender.stdout=org.apache.log4j.ConsoleAppender
 log4j.appender.stdout.Target=System.out
 log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
 log4j.appender.stdout.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss}
 %-5p %c{1}:%L - %m%n 
```

在我的计算机上，我可以在项目文件夹中看到 logging.log 文件。在这个程度上，一切都完美无缺。但是，在用户 PC 上，根本没有该文件的迹象。不在 C:\ （我认为它会在的地方），不在 C:\Program Files (x86)\ 或其他任何地方。我已经完成了对我的硬盘的完整搜索，但没有任何返回。

这个文件应该存储在哪里？我的属性设置正确吗？很困惑...

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T19:45:44.393

万一有人偶然发现这篇文章，我想记录下我是如何解决它的。

首先，正如 DwB 正确指出的那样，问题确实是用户的帐户没有足够的权限来创建 logging.log 文件。在我的代码中，我有一个正在执行的 catch 块，其中包含在发生文件写入错误时退出系统的代码。由于这正是我试图编写的日志记录详细信息，因此我无法获得任何输出来提示我将此作为我的问题的根源。

一旦我意识到这一点，我只需要更改写入日志文件的位置。我决定将其写入根目录 (C:\) 或 jar 文件所在的文件夹 (C:\在他们的 AppData 路径中创建一个文件夹。

我的程序的第一行现在是对该函数的调用（使用通用名称 MyProgram）：

```
private static void makeAppDataFolder() {
     File dir = new File(System.getenv("APPDATA") + "\\MyProgram");
     if (!dir.exists()) {dir.mkdir();}
} 
```

这会在用户帐户的 \AppData\Roaming 中创建一个名为 MyProgram 的文件夹。由于此路径是用户帐户路径的一部分，我相信用户将始终能够对其进行写入，从而解决权限问题。如果有人知道，请告诉我。

然后，在我的 log4j.properties 文件中，我更改了行

```
log4j.appender.file.File=logging.log 
```

至

```
log4j.appender.file.File=${user.home}/Application Data/MyProgram/logging.log 
```

这会将文件定向到我刚刚创建的文件夹。

一旦我这样做了，并添加了一些放置良好的日志消息，我就能找到我的其他问题，现在一切正常。

我希望这可以帮助某人。如果有人有任何建议，请发表。

# java - 试图通过java程序在文本文件中的特定行之间添加行（字符串数组）？

> ID：15621521
> 
> 赞同：1
> 
> 时间：2013-03-25T17:55:20.183
> 
> 标签：java, arrays, string, filewriter

我正在尝试通过从各种论坛看到来编写程序。程序如下，旨在在现有 txt 文件的第 3 行之后，但在第 5 行之前添加行。& 当我将看到该程序的执行完成时，我试图安全地保持先前的行，但我未能进入 3 和 5 之间的行。它添加到第 5 行以下。如果这个基本程序有效，那么我将尝试在第 3 行和第 5 行之间的文件中添加“字符串数组”，例如

```
import java.io.BufferedWriter;  
import java.io.File;  
import java.io.FileReader;  
import java.io.FileWriter;  
import java.io.IOException;  
import java.io.LineNumberReader;  

public class WriteToFileExample {  

    /** 
     * @param args 
     */  
    public static void main(String[] args) {  
        // TODO Auto-generated method stub  
String content = "This is the content to write into file by Mandar";  
File file = new File("/example/mandar.txt");  
if(!file.exists()){  
    try {  
        file.createNewFile();  
    } catch (IOException e) {  
        // TODO Auto-generated catch block  
        e.printStackTrace();  
    }  
    try {  
        FileWriter fw = new FileWriter(file.getAbsoluteFile(),true);  
        BufferedWriter bw = new BufferedWriter(fw);  
        bw.write(content);  
        bw.newLine();  
        bw.close();  
        System.out.println("Done");  
    } catch (IOException e) {  
        // TODO Auto-generated catch block  
        e.printStackTrace();  
    }  

}else{  
    try {  
        LineNumberReader lnr = new LineNumberReader(new FileReader(file));  
        FileWriter fw = new FileWriter(file.getAbsoluteFile(),true);  
        BufferedWriter bw = new BufferedWriter(fw);  
        lnr.setLineNumber(6);  
        for(int i =1; i<lnr.getLineNumber();i++){  
//          System.out.println("for = "+i);  
//          bw.newLine();  
            if(i == 3){  
                System.out.println("4");  
                bw.write(content);  
//              bw.newLine();  
            }  
        }  
        bw.close();  
        System.out.println("Done1");  
    } catch (IOException e) {  
        // TODO Auto-generated catch block  
        e.printStackTrace();  
    }  
}  
    }  

} 
```

请帮我。我没有任何线索或想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:21:22.960

您正在使用`lnr.setLineNumber(6)`将 设置`lnr`为写入第 6 行。您的`for`循环只是从 1 循环到 6 并**在第 6 行**写入内容when `i==3`。我尚未对此进行测试，但请尝试使用`lnr.setLineNumber(4)`并摆脱您的 for 循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T06:09:05.893

感谢javabreakpoint，我用你的方式尝试了我的场景，如下所示

```
import java.io.*;

public class JInsert {
 public static void main(String args[]){
 try {
   JInsert j = new JInsert();
   File file = new File("/example/mandar.txt");
   j.insertStringInFile(file, 4, "4");
  // j.insertStringInFile(file,Integer.parseInt(args[1]), args[2]);
   }
 catch (Exception e) {
   e.printStackTrace();
   }
 }

 public void insertStringInFile
     (File inFile, int lineno, String lineToBeInserted) 
   throws Exception {
 // temp file
 File outFile = new File("/example/$$$$$$$$.tmp");

 // input
 FileInputStream fis  = new FileInputStream(inFile);
 BufferedReader in = new BufferedReader
     (new InputStreamReader(fis));

 // output         
 FileOutputStream fos = new FileOutputStream(outFile);
 PrintWriter out = new PrintWriter(fos);

 String thisLine = "";
 int i =1;
 while ((thisLine = in.readLine()) != null) {
   if(i == lineno) out.println(lineToBeInserted);
   out.println(thisLine);
   i++;
   }
out.flush();
out.close();
in.close();

inFile.delete();
outFile.renameTo(inFile);
}
} 
```

但是在运行上述程序之前，我在文件 mandar.txt 中看到了 1 个新问题，预期如下。

```
1
2
3

5 
```

如果 mandar.txt 在运行上述程序之前修改如下：-

```
1

2
3
5 
```

意味着现在空行更改为 1 和 2 之间，但我们（人类）知道字符串“4”应该在 3 和 5 之间输入。但是现在程序在第 4 行添加行，但现在我们可以看到 mandar.txt 如下

```
 1

 2
 4
 3
 5 
```

**如何确保任何时间是否有 3 和 5 在任何行号然后我的字符串在它们之间输入？** 意味着我将在程序 1 中获得 2 种方式。行号 2。行内容安全地插入应该插入的位置。

# php - 电子邮件正则表达式在某些电子邮件地址上失败

> ID：15621525
> 
> 赞同：0
> 
> 时间：2013-03-25T17:55:29.403
> 
> 标签：php, regex, email

我正在使用此代码从字符串中解析出电子邮件：

```
function get_emails ($str) {
    $pattern = '/([a-z0-9])(([-a-z0-9._])*([a-z0-9]))*\@([a-z0-9])' .
    '(([a-z0-9-])*([a-z0-9]))+' . '(\.([a-z0-9])([-a-z0-9_-])?([a-z0-9])+)/i';

    preg_match ($pattern, $str, $matches);

    return $matches;
} 
```

除非地址在域中具有多个句点，否则它运行良好。所以 johndoe@yahoo.com 工作正常，但 johndoe@yahoo.co.uk 在 johndoe@yahoo.co

我可以改变什么来解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:02:48.350

您可以`+`在末尾添加 a ，即`+/i`.

# javascript - 这个 JavaScript 片段中的“&&”表达式是什么意思？

> ID：15621527
> 
> 赞同：1
> 
> 时间：2013-03-25T17:55:30.863
> 
> 标签：javascript, jquery, ampersand

[嗨，我最近从这里](http://paulirish.com/2008/sequentially-chain-your-callbacks-in-jquery-two-ways/)得到了一段 JavaScript 代码片段。

有人可以解释一下这个语句是如何工作的：`(jq=jq.slice(1)).length && hidenext(jq);`在下面的函数中？

```
(function hidenext(jq){
    jq.eq(0).fadeOut("fast", function(){
        (jq=jq.slice(1)).length && hidenext(jq);
    });
})($('div#bodyContent a')) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T17:57:45.500

在这里，由于没有使用结果，[逻辑 AND](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Logical_Operators)被用作一种 short `if`。

这是一样的

```
if ((jq=jq.slice(1)).length) hidenext(jq); 
```

它使用这样一个事实，即如果第一部分未评估为真，则不会评估第二部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T17:58:09.407

这意味着只有在(现在设置为返回值has a > 0`hidenext(jq)`时才会调用它。因为短路了，如果第一个操作数是假的，评估就会停止。`jq``jq.slice(1)``length``&&`

# ruby - 将 ruby 诅咒重定向到 /dev/null

> ID：15621529
> 
> 赞同：1
> 
> 时间：2013-03-25T17:55:45.753
> 
> 标签：ruby, rspec, curses

我正在尝试为使用 Ruby 的 Curses 库的应用程序编写规范。诅咒显然垄断了终端屏幕，所以我尝试将 rspec 的输出重定向到文件。这在大多数情况下是有效的，但是我的一些失败的规范缺少信息，我认为 RSpec 正在将它的一些输出打印到 $stdout。

我尝试将 Curses 库配置为不打印到屏幕上，但无济于事。有什么方法可以禁用 Curses 输出，以便可以正常运行测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T15:14:06.163

我有一个配置标志，指​​定是否执行 curses 输出。对于单元测试，我禁用了 curses 输出。

另外，在运行时我会测试 stdout 和 stderr 是否是 tty 的；如果没有，它们将被重定向到文件，我不想要 curses 输出。它看起来像这样：

```
 def do_curses_output?
    $stdin.isatty && $stdout.isatty && want_curses_output
  end

  def foo
    if do_curses_output?
      # ... do the curses stuff
    end
  end 
```

——基思

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:40:02.587

Try [`Curses.close_screen`](http://www.ruby-doc.org/stdlib-2.0/libdoc/curses/rdoc/Curses.html#method-c-close_screen), when you decide to resume output of Curses, call `Curses.refresh`

# ruby - 在 Nokogiri 完成抓取之前，Watir-webdriver 正在通过脚本进行

> ID：15621531
> 
> 赞同：1
> 
> 时间：2013-03-25T17:55:55.227
> 
> 标签：ruby, nokogiri, watir, watir-webdriver

页面上有三种形式。所有表单的日期范围都默认为“今天”。每个表单都使用一个范围内的日期（例如 2013 年 1 月 1 日 - 2013 年 1 月 3 日）迭代提交，然后抓取结果表。

然后脚本将日期提交到下一个表单，然后再次抓取该表。但是，抓取是在提交日期之前发生的。

我尝试`sleep 2`在刮擦之间添加无济于事。

脚本在这里：[https ://gist.github.com/hnanon/de4801e460a31d93bbdc](https://gist.github.com/hnanon/de4801e460a31d93bbdc)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:37:34.857

该脚本似乎假设 Nokogiri 和 Watir 将始终保持同步。这是不正确的。

当你这样做时：

```
page = Nokogiri::HTML.parse(browser.html) 
```

Nokogiri 在特定时间点获取浏览器 html。如果 Watir 对浏览器进行了更改（即更改了 html），Nokogiri 将不会知道这件事。

每次要使用 Nokogiri 解析 html 时，都需要使用浏览器的最新 html 创建一个新的 Nokogiri 对象。

一个例子来说明：

```
require 'watir-webdriver'
require 'nokogiri'

b = Watir::Browser.new

b.goto 'www.google.ca'
page = Nokogiri::HTML.parse(b.html)
p page
#=> This will be the Google page

b.goto 'www.yahoo.ca'
p page
#=> This will still be the Google page

page = Nokogiri::HTML.parse(b.html)
p page
#=> This will now be the Yahoo page 
```

# clojure - 从存储在 var 中的表达式定义函数

> ID：15621532
> 
> 赞同：2
> 
> 时间：2013-03-25T17:55:56.893
> 
> 标签：clojure

我昨天问了一个类似的问题，但似乎我必须改变我的方法，所以我做到了，但现在我又陷入了困境。

无论如何，我想做的是类似的事情

```
(def bar '(* 2 %))
(#(bar) 2) ;this line doesn't work.
(#(* 2 %) 2) ;this is what I want the line that doesn't work to do. 
```

问题是，我希望将表达式存储在 var 中，这样我就可以执行类似的操作

```
(def bar2 (list (first bar) 3 (nth bar 2)))
(#(bar2) 2) ;this line obviously doesn't work either. 
```

也许除了`#`匿名函数阅读器宏之外还有另一种方法。

我正在为 uni 做一个基因编程项目，所以我需要做的是有一个表达式，我可以改变它并变成一个函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T01:10:36.170

```
(def bar '(* 2 %))

((eval (read-string (str "#" bar))) 3)
=> 6 
```

如果您在表达式中使用命名参数，它看起来会更干净：

```
(def bar '(* 2 p))

(def f-expr (concat '(fn [p]) [bar]))

((eval f-expr) 3)
=> 6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:24:01.853

如果您想在*运行时*评估引用的表达式（与编译时相反，à la 宏），您可以使用[`eval`](http://clojuredocs.org/clojure_core/1.3.0/clojure.core/eval)：

```
(eval '(* 10 12))
;=> 120

(def arg 12)
(def bar '(* 10 arg))
(eval bar)
;=> 120 
```

通常一个人会避开`eval`（一方面宏会表现得更好），但它可能是你想要玩遗传算法的东西。

# eclipse-plugin - Scala：SBT Eclipse 插件无法从 scalanlp.org 构建 Breeze

> ID：15621539
> 
> 赞同：0
> 
> 时间：2013-03-25T17:56:10.617
> 
> 标签：eclipse-plugin, sbt, scala-ide, scala-breeze

我是 Breeze ( [http://www.scalanlp.org/](http://www.scalanlp.org/) ) 和 Scala 的新手。请帮助使用 sbt 为 Breeze 生成 Eclipse 项目。我安装了 sbt 的 Eclipse 插件。当我尝试`sbt eclipse`它失败并出现以下错误。怎么了？谢谢！

```
> ~/Distrib/Scala/breeze-master>sbt
[info] Loading global plugins from /home/an/.sbt/plugins
[info] Loading project definition from /home/an/Distrib/Scala/breeze-
master/project
[info] Set current project to breeze (in build file:/home/an/Distrib/
Scala/breeze-master/)
> eclipse
[info] About to create Eclipse project files for your project(s).
[error] java.util.NoSuchElementException: None.get
[error] Use 'last' for the full log.
> last
...
...
[debug] Project dependencies for configuration 'compile':
Success(List(breeze-math))
[debug] Project dependencies for configuration 'test': Success(List())
java.util.NoSuchElementException: None.get
    at scala.None$.get(Option.scala:274)
    at scala.None$.get(Option.scala:272)
    at com.typesafe.sbteclipse.core.Eclipse$.relativize(Eclipse.scala:
498)
    at com.typesafe.sbteclipse.core.Eclipse$$anonfun$srcEntry
$1.apply(Eclipse.scala:252)
    at com.typesafe.sbteclipse.core.Eclipse$$anonfun$srcEntry
$1.apply(Eclipse.scala:249)
    at scalaz.effects.IO$$anon$3$$anonfun$pure$1$$anonfun$apply
$23.apply(IO.scala:118)
    at scalaz.effects.IO$$anon$3$$anonfun$pure$1$$anonfun$apply
$23.apply(IO.scala:118)
    at scalaz.FreeFunctions$$anonfun$return_$1.apply(Free.scala:181)
    at scalaz.FreeFunctions$$anonfun$return_$1.apply(Free.scala:181)
    at scalaz.Pure$$anon$19$$anon$2.apply(Pure.scala:76)
    at scalaz.Functor$$anon$15$$anon$45.apply(Functor.scala:84)
    at scalaz.Free$class.go$1(Free.scala:73)
    at scalaz.Free$class.run(Free.scala:76)
    at scalaz.Free$Gosub.run(Free.scala:18)
    at scalaz.effects.IO$class.unsafePerformIO(IO.scala:13)
    at scalaz.effects.IO$$anon$2.unsafePerformIO(IO.scala:113)
    at com.typesafe.sbteclipse.core.Eclipse$.onSuccess(Eclipse.scala:149)
    at com.typesafe.sbteclipse.core.Eclipse$$anonfun$action
$4.apply(Eclipse.scala:105)
    at com.typesafe.sbteclipse.core.Eclipse$$anonfun$action
$4.apply(Eclipse.scala:105)
    at scalaz.Validation$class.fold(Validation.scala:7)
    at scalaz.Success.fold(Validation.scala:82)
    at com.typesafe.sbteclipse.core.Eclipse$.action(Eclipse.scala:105)
    at com.typesafe.sbteclipse.core.Eclipse$$anonfun$eclipseCommand
$2.apply(Eclipse.scala:81)
    at com.typesafe.sbteclipse.core.Eclipse$$anonfun$eclipseCommand
$2.apply(Eclipse.scala:81)
    at sbt.Command$$anonfun$applyEffect$1$$anonfun$apply
$2.apply(Command.scala:60)
    at sbt.Command$$anonfun$applyEffect$1$$anonfun$apply
$2.apply(Command.scala:60)
    at sbt.Command$$anonfun$applyEffect$2$$anonfun$apply
$3.apply(Command.scala:62)
    at sbt.Command$$anonfun$applyEffect$2$$anonfun$apply
$3.apply(Command.scala:62)
    at sbt.Command$.process(Command.scala:90)
    at sbt.MainLoop$$anonfun$next$1$$anonfun$apply$1.apply(MainLoop.scala:
71)
    at sbt.MainLoop$$anonfun$next$1$$anonfun$apply$1.apply(MainLoop.scala:
71)
    at sbt.State$$anon$2.process(State.scala:170)
    at sbt.MainLoop$$anonfun$next$1.apply(MainLoop.scala:71)
    at sbt.MainLoop$$anonfun$next$1.apply(MainLoop.scala:71)
    at sbt.ErrorHandling$.wideConvert(ErrorHandling.scala:18)
    at sbt.MainLoop$.next(MainLoop.scala:71)
    at sbt.MainLoop$.run(MainLoop.scala:64)
    at sbt.MainLoop$$anonfun$runWithNewLog$1.apply(MainLoop.scala:53)
    at sbt.MainLoop$$anonfun$runWithNewLog$1.apply(MainLoop.scala:50)
    at sbt.Using.apply(Using.scala:25)
    at sbt.MainLoop$.runWithNewLog(MainLoop.scala:50)
    at sbt.MainLoop$.runAndClearLast(MainLoop.scala:33)
    at sbt.MainLoop$.runLoggedLoop(MainLoop.scala:17)
    at sbt.MainLoop$.runLogged(MainLoop.scala:13)
    at sbt.xMain.run(Main.scala:26)
    at xsbt.boot.Launch$.run(Launch.scala:55)
    at xsbt.boot.Launch$$anonfun$explicit$1.apply(Launch.scala:45)
    at xsbt.boot.Launch$.launch(Launch.scala:69)
    at xsbt.boot.Launch$.apply(Launch.scala:16)
    at xsbt.boot.Boot$.runImpl(Boot.scala:31)
    at xsbt.boot.Boot$.main(Boot.scala:20)
    at xsbt.boot.Boot.main(Boot.scala)
[error] java.util.NoSuchElementException: None.get
[error] Use 'last' for the full log.
> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:23:13.713

这是 sbteclipse 中的一个已知错误：[https ://github.com/typesafehub/sbteclipse/issues/128](https://github.com/typesafehub/sbteclipse/issues/128)

您可以尝试在 Project.scala 定义中注释掉“doc”项目，看看是否有帮助。否则，我认为这是 sbteclipse 中的一个错误，必须首先解决。

# ruby-on-rails - 如何绕过网址中的非法八进制数字？

> ID：15621540
> 
> 赞同：4
> 
> 时间：2013-03-25T17:56:10.643
> 
> 标签：ruby-on-rails

我的 rails 应用程序中有一个方法可以保存来自 og:image 标记 url 的图像。

```
def photo_from_url(url)
  if !Nokogiri::HTML(open(url)).css("meta[property='og:image']").blank?
    photo_url = Nokogiri::HTML(open(url)).css("meta[property='og:image']").first.attributes["content"]
    self.photo = URI.parse(photo_url)
    self.save
  end
end 
```

这在大多数情况下都有效，除非图像 url 恰好包含一个以 0 开头的数字，例如`http://ad009cdnb.website.com/rest-of-url`

在这些情况下，我得到一个非法的八进制数字错误。

如何防止该方法认为任何以零开头的数字都是以 8 为底的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:31:05.117

这不是一个答案。对不起，错误地使用了系统。无法找到如何使用 HTTP 放置字符串而不将其更改为链接作为注释。

URI.parse 工作正常：

```
URI.parse("http://ad009cdnb.website.com/rest-of-url").to_s
=> "http://ad009cdnb.website.com/rest-of-url" 
```

正如大家所说，我们真的需要一个堆栈跟踪或其他东西来帮助你。您很可能希望将 URL 保存为字符串，而不是数据库中的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:01:28.250

大家好，我发布了这个问题，但我无法再重现这个问题。

由于这不再是一个问题，我认为最好的做法是结束这个问题。但是，我看到有些人的评论被投票赞成（他们提出了很好的观点，例如保存为字符串而不是对象）。如果问题被关闭，他们会名誉扫地吗？

我很感谢大家的意见，不想让任何人感到不安。对于这种情况，什么是 SO 协议？

# windows - Mail::IMAPClient->new 在 Windows 中挂起

> ID：15621547
> 
> 赞同：2
> 
> 时间：2013-03-25T17:56:31.970
> 
> 标签：windows, perl, imap

这`Mail::IMAPClient->new()`在 Windows 7 中冻结：

```
sub connectGMail
{
    my $client = Mail::IMAPClient->new
    (
        Server   => 'imap.gmail.com',
        Port     => 993,
        Ssl      =>  1,
        User     => 'whateverUser',
        Password => 'aG00dP455w0rd',
        Socket   => IO::Socket::SSL->new
        (       
            SSL_verify_mode => SSL_VERIFY_NONE
        )
    )
    or die "Cannot connect  ($@)\n";
    return $client;
} 
```

我尝试停用 Windows 防火墙，但没有任何改变。

一个非常相似的代码在 Linux 中运行良好：

```
sub connectGMail
{
    my $client = Mail::IMAPClient->new
    (
        Server   => 'imap.gmail.com',
        Port     => 993,
        Ssl      =>  1,
        User     => 'whateverUser',
        Password => 'aG00dP455w0rd'
    )
    or die "Cannot connect  ($@)\n";
    return $client;
} 
```

在这两种情况下`Mail::IMAPClient`，都可以从 CPAN 存储库正常安装，但在 Windows 中，如果我不包含*Socket*选项，它会向我显示此警告

```
*******************************************************************
 Using the default of SSL_verify_mode of SSL_VERIFY_NONE for client
 is deprecated! Please set SSL_verify_mode to SSL_VERIFY_PEER
 together with SSL_ca_file|SSL_ca_path for verification.
 If you really don't want to verify the certificate and keep the
 connection open to Man-In-The-Middle attacks please set
 SSL_verify_mode explicitly to SSL_VERIFY_NONE in your application.
******************************************************************* 
```

并且脚本的其余部分（解析电子邮件）将无法正常工作。

```
error:    unexpected end of header

error:    unexpected end of header

error:    unexpected end of header 
```

任何帮助将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T22:12:52.407

看起来`Mail::IMAPClient->new`不喜欢套接字和服务器/端口。如果我使用服务器/端口创建套接字然后传递它，它确实连接成功。

```
sub connectGMail
{
    my $socket = IO::Socket::SSL->new
    (  
       PeerAddr => 'imap.gmail.com',  
       PeerPort => 993, 
       SSL_verify_mode => SSL_VERIFY_NONE
    )  
    or die "socket(): $@";  

    my $client = Mail::IMAPClient->new
    (
        User     => 'whateverUser',
        Password => 'aG00dP455w0rd'
        Socket   => $socket
    )
    or die "Cannot connect  ($@)\n";
    return $client;
} 
```

# jpa - Critera API JPA 中的聚合 (sum,max,avg) 函数

> ID：15621554
> 
> 赞同：2
> 
> 时间：2013-03-25T17:57:06.500
> 
> 标签：jpa, jpa-2.0, criteria-api

在我的条件 API 查询中，我查询表的三列的以下查询有效。

**cq.multiselect(root.get("point").get("id"), root.get("player").get("userid"), root.get("amount"));**

但是当我想要使用以下查询的列金额的总和时，它会给出一个 sql 错误。查询是

**cq.multiselect(root.get("point").get("id"), root.get("player").get("userid"), cb.sum(root.get("amount"))) ;**

我得到的错误是。

**{"id":"6","re​​sult":null,"error":"\r\n内部异常：com.sap.dbtech.jdbc.exceptions.jdbc40.SQLSyntaxErrorException: [-8017] (at 8): Column必须是组列:ID\r\n错误代码: -8017\r\n**

请帮我解决这个问题，因为我已经坚持了几个小时了。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:41:30.453

该消息告诉您在查询中需要一个 group by 子句。select 子句中的每一列（聚合函数的结果除外）必须在 group by 子句中：

```
criteriaQuery.groupBy(root.get("point").get("id"), 
                      root.get("player").get("userid")) 
```

# ruby - 将字符串（URL）与数组组合

> ID：15621556
> 
> 赞同：-2
> 
> 时间：2013-03-25T17:57:19.297
> 
> 标签：ruby, arrays, multithreading, nokogiri, scrape

我正在尝试抓取一些数据。B 是要抓取 1000 个项目所需的页数 - 每页有 22 个。

```
usernum = 1000
b = usernum.to_i/22
Array.new(b) {|b| b+1} 
```

我有一个页数数组（1000/22 = 45 int.） - [1,2,...44,45] 我需要抓取，每个数组元素都与 Nokogiri 下载的页面有关。我不确定如何进行。

```
www.google.com&page=1
www.google.com&page=2 
```

等在这​​种情况下，它需要到达“www.google.com&page=45”

是否可以将前缀附加到数组的每个项目？如果是这样，格式化数组并按时间顺序下载每个页面，或者在外部文本文件中编译 URL 列表并将它们加载到方法中是否有意义？我将尝试添加线程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:02:57.603

你可以循环而不是创建一个数组吗？

```
(1..b).each do |page|
  url = "http://google.com?page=#{i}"
  # .. fetch the page
end 
```

# codeigniter - 初学者的 Codeigniter 更新

> ID：15621561
> 
> 赞同：-1
> 
> 时间：2013-03-25T17:57:40.413
> 
> 标签：codeigniter

谁能帮我在 Codeigniter 中更新？

这是我的模型代码：

```
function update($data,$userid)
{
    $data = array(
               'dob' => $dob,
               'sex' => $sex,              
    );

    $this->db->where('user_id', $userid);
    $this->db->update('profile', $data); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:34:56.573

假设您通过函数中的 data 变量传递 dob 和 sex ，您只是试图错误地访问它们。

```
function update($data,$userid)
{
    $data = array(
               'dob' => $data['dob'],
               'sex' => $data['sex'],              
    );

    $this->db->where('user_id', $userid);
    $this->db->update('profile', $data); 
} 
```

就此而言，如果这就是该数据变量中的全部内容，您可能会完全丢失第一部分，因为它实际上只是复制您已有的内容。

```
function update($data,$userid)
{
    $this->db->where('user_id', $userid);
    $this->db->update('profile', $data); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T17:05:34.320

```
$where = array('id'=>'10','email'=>'dude@dude.com');
$data = array('username'=>'lol');

function update($data,$where){
    foreach($where as $key=>$value){
        $this->db->where($key,$value);
    }
    $this->db->update('users',$data);
} 
```

# node.js - 快速会话管理不起作用

> ID：15621570
> 
> 赞同：0
> 
> 时间：2013-03-25T17:58:10.033
> 
> 标签：node.js, session, express, session-cookies

我对这个`node.js`世界很陌生。我正在尝试编写 REST 服务，但我被会话管理困住了。所以我创建了一个单独的应用程序只是为了看看我是否可以让会话工作，但它没有，这里是代码。`req.session.username`始终未定义：

```
var express = require('express');
var url = require('url');

var app = express()
app.use(express.cookieParser('Hiren'))
app.use(express.session({ secret: 'HirenAdesara' }))
app.use(express.bodyParser())
app.use(app.router)

//Sniff HTTP
app.all('*', function(req, res, next) {
    //Check for Authentication
            console.log(req.session)
    if ((!(/^\/auth/g.test(req.url))) && (!req.session)) {
        console.log('in app.all: Unauthorized')
        res.send(401)
    }
    else
    {
        return next()
    }
})

app.post('/auth', function(req, res) {
                var query =  req.body
                console.log('Query' + JSON.stringify(query))
                username = query.username;
                password = query.password;
                if(username == 'Hiren' && password == 'Adesara')
                {
                    req.session.username = 'Hiren';
                    console.log('New Session Created..')
                    res.send(200)
                }
                else
                {
                    console.log('New session could not be created.')
                    res.send(401)
                }
})

app.get('/projects', function(req,res) {
    console.log('inside projects' + req.session.username);
    res.send(req.session.username); })

app.listen(2048)
console.log('Listening on port 2048...') 
```

它不起作用，我不知道这里有什么问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:11:43.140

通过将 app.get('/'...) 中的 3 行移到它之外来加注星标：

```
var express = require('express');
var querystring = require('querystring');

var app = express()
app.use(express.cookieParser('Hiren'));   // This line
app.use(express.session({ secret: 'HirenAdesara' })); // This line
app.use(express.bodyParser()); // This line

app.get('/', function(req, res){
   res.send('hello from the root page');
})

// the rest of your code 
```

# ms-access - 我的未绑定（菜单）子表单出现在数据表中

> ID：15621575
> 
> 赞同：0
> 
> 时间：2013-03-25T17:58:22.147
> 
> 标签：ms-access, ms-access-2007, subform, datasheet

我使用未绑定的表单作为我的应用程序的菜单/导航。菜单表单具有标签的 VBA“点击”事件。这就对了。

当我将其作为子表单添加到绑定到其中一个表的拆分表单时，“菜单”子表单显示为子数据表。

当我转到数据表视图以删除子数据表时，“删除”按钮显示为灰色。

我检查了子数据表扩展“否”和子数据表高度“0”的主表单和菜单子表单

我知道这可能会是我似乎忽略的痛苦显而易见的事情，但我整个早上都在寻找解决方案。

谢谢，人们。

![在此处输入图像描述](../Images/3c7af910e909b126ac1b040487a8a2e9.png)

![在此处输入图像描述](../Images/5bcbbd9ca0bba032b4744d17e247b164.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T16:30:49.983

您是否使用设计视图添加了导航表单？例如，这是我添加了导航表单的拆分表单，请注意导航表单设置为显示单个表单。

![拆分表单设计视图](../Images/4e332fba7669e0b2b9e917ec883caaa3.png)

这是显示的表格：

![拆分表单普通视图](../Images/1e1af73b5320ea02f44ae560a0a99073.png)

# java - 通过对象实例中包含的变量而不是数组编号来搜索数组？

> ID：15621578
> 
> 赞同：0
> 
> 时间：2013-03-25T17:58:36.930
> 
> 标签：java

我正在为一家名为“客户”的公司创建一系列客户帐户。我有一个方法调用`getGasAccount`，它将计算数组中的帐户数。

我将程序类中的变量声明为：

```
final int MAXACCOUNTS = 10;
int intNUmber, intSelectAccount; 
```

我使用以下方法设置帐户：

```
if (GasAccount.getGasAccount() < MAXACCOUNTS) {
   intSelectAccount = GasAccount.getBankAccount()++;
   customers[intSelectAccount] = new GasAccount();
} 
```

我希望能够通过调用构造函数时手动输入的帐号来搜索客户。我不想通过`intSelectAcocunt`/array 引用进行搜索。

如果我有一个名为 的方法`displayAccountDetails`，是否有另一种查找帐户的方法，而不是使用：

```
customers[intSelectAccount].displayAccountDetails(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:12:20.970

像这样实现`equals`方法`GasAccount`

```
public boolean equals(Object objToCompare){
    if (objToCompare != null){
        return objToCompare instanceof GasAccount && ((GasAccount)objToCompare).getAccountNumber() == getAccountNumber();
    }else{
        return false;
    }
} 
```

`GasAccount`现在在数组中查找对象的位置并显示帐户详细信息：

```
java.util.List<GasAccount> gasAccountsList = (java.util.List<GasAccount>)java.util.Arrays.asList(customers);
int objectIndex = gasAccountsList.indexOf([Gas Account Object]);
if (objectIndex != -1){
    gasAccountsList.get(objectIndex).displayAccountDetails();
} 
```

**jahroy**建议的另一种按帐号搜索的简单方法是：

```
public void getAccountDetails(int accountNumber){
    java.util.List<GasAccount> gasAccountsList = (java.util.List<GasAccount>)java.util.Arrays.asList(customers);
    for(GasAccount gasAccountObj : gasAccountsList){
        if(gasAccountObj.getAccountNumber() == accountNumber){
            gasAccountObj.displayAccountDetails();
            break;
        }
    }
} 
```

或者

```
public void getAccountDetails(int accountNumber){
    for(GasAccount gasAccountObj : customers){
        if(gasAccountObj.getAccountNumber() == accountNumber){
            gasAccountObj.displayAccountDetails();
            break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:35:01.330

您想要的数据结构是[HashMap](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)。你可以做这样的事情。

```
public class AccountClass{

    //You can fill in the details. I sounds like you know about constructors
    //getters, setters, etc.

    private HashMap<String, String> accountHash = new HashMap<String, String>();

    public HashMap<String, String> getHashMap()
    {
        return this.accountHash;
    }
} 
```

当您想通过帐号查找帐户时，您可以执行以下操作。

```
AccountClass acct = new AccountClass();
acct.getHashMap().get("1234"); 
```

假设您实际上在地图中放置了一个帐号为“1234”的条目，它将返回与该键关联的值。

如果您想进行更多阅读，[这里是 Wikipedia 文章。](http://en.wikipedia.org/wiki/Associative_array)

编辑：根据一些评论，我还有一些东西要添加。

如果您像这样将 HashMap 设为静态可能会更好

```
private static HashMap<String, String> accountHash = new HashMap<String, String>(); 
```

当您声明变量静态时，这使得您不必实例化对象来访问 HashMap。你可以做这样的事情。

```
AccountClass.accountHash.get(); 
```

或 AccountClass.accountHash.put()；

如果你想在你的 HashMap 中添加东西，你需要使用 put 方法。这是一个例子。

```
accountHash.put("1234","My test account"). 
```

现在当你使用这个时，accountHash.get("1234");//你会得到我的测试账号

您将获得与“1234”键关联的值。

请记住，此示例只是为了让您了解如何使用它。您可以拥有 、 或其他任何您想要的地图。

# django - 在模板中调用 django 模型函数

> ID：15621579
> 
> 赞同：1
> 
> 时间：2013-03-25T17:58:38.933
> 
> 标签：django

我在模型中有以下功能：

```
@property
def exclusive_price(self):
    if(self.discount_price > 0):
        return self.list_price - self.discount_price
    else:
        return self.list_price 
```

我尝试在模板中调用它，但没有输出任何内容。我能做些什么？

```
{{obj.exlusive_price}} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-26T07:09:40.523

它不起作用，因为您调用的是exclusive_price 而不是exclusive_price。c 不见了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T11:31:27.113

假设这不是剪切和粘贴错误，则调用您的方法，`exclusive_price`但您调用`exlusive_price`的是 ，而没有`c`.

# c - 如何在c中将一些long double转换为long int？

> ID：15621582
> 
> 赞同：-3
> 
> 时间：2013-03-25T17:58:45.870
> 
> 标签：c, casting, int, double

我正在尝试将 double 类型变量转换为 long long int。我知道的唯一方法是铸造。虽然看起来没问题，但我没有收到我想要的号码。

我在下面发布代码：

```
double fator = 100000000;
long long int iLongitude = (long long int)(fLongitude*10000000); 
```

我期望的数字是-4396478167，我得到-439647816，没有最后一位数字。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:10:43.340

看来您只需要再添加一个零，然后还四舍五入：

```
(long long int)(fLongitude*100000000 + 0.5); 
```

由于强制转换会截断结果，`+ 0.5`如果小数部分大于 ，则 将四舍五入`0.5`。

# php - 页面刷新后 Facebook PHP-SDK 似乎丢失了用户 ID

> ID：15621586
> 
> 赞同：3
> 
> 时间：2013-03-25T17:59:06.913
> 
> 标签：php, facebook, facebook-php-sdk

我似乎可以正常登录，在那里我可以登录，接受应用程序（第一次），然后显示用户信息，如姓名/图片/等。

但是，当我刷新页面时，用户 ID 又回到 0，我必须再次登录 - 我不确定问题出在哪里，我必须在每次页面加载时重新启动它还是什么？我不知道，我会发布一些代码 - 这可能很难，因为它们是一堆单独的文件：

fb_login.php -

```
<?php
    require_once("fb_login/facebook.php");
    $facebook = new Facebook(array(
      'appId' => 'APP_ID',
      'secret'=> 'APP_SECRET',
      'cookie'=> 'true'
    ));
    $userId = $facebook->getUser();

    if ($userId) {
        $userId = $facebook->getUser();
         echo("userID is: $userId");
}
    else{
        header("Location: {$loginURL}");
         echo("userId is: $userId");
    }

?> 
```

navbar.php -

```
<?php
              if($userId){
                 try {
                  $user_profile = $facebook->api('/me','GET');
                  echo '<li><a href="#">Welcome: ' . $user_profile['name'] . '</a></li>';
                  echo '<li><img src="https://graph.facebook.com/' . $user_profile['username'] . '/picture"><li>';
                  echo '<li class="divider-vertical"></li>';
                 } catch (FacebookApiException $e) {
                    $login_url = $facebook->getLoginUrl(); 
                    echo '<li>Please <a href="' . $login_url . '">login.</a></li>';
                    error_log($e->getType());
                    error_log($e->getMessage());
                 }
              }
              else{
                  echo '<li><a href="newUser.php">Sign Up</a></li>
                      <li class="divider-vertical"></li>';
              }
            ?>
<?php
                  if ($userId) { 
                    // echo("userID is: $userId");
                    // $params = array( 'next' => 'http://localhost/bcbooks-repo/index_new.php' );

                    $logoutUrl = $facebook->getLogoutUrl(); // $params is optional. 
                    echo '<li><a href="' . $logoutUrl . '">Log Out</a></li>';
                    $facebook->destroySession();
                  }
                  else{?>
<?php
                $userId = $facebook->getUser();
                $accessToken = $facebook->getAccessToken();
                $params = array(
                    'scope' => 'read_stream, friends_likes',
                    'redirect_uri' => 'http://localhost/bcbooks-repo/index_new.php'
                );

                $loginUrl = $facebook->getLoginUrl($params);
                echo '<a href="' . $loginUrl . '" class="btn btn-primary btn-block" type="button" id="sign-in-facebook">Sign In with Facebook</a>';
                                        ?>
<?php } ?> 
```

index.php -

```
<?php
  require_once 'inc/FB_login.php';
require_once 'inc/navbar.php'; ?> 
```

登录 -![登录](../Images/22ac8ca78f1f5cd62aad128f29c070aa.png)

页面刷新后![刷新后](../Images/4aa6311cf54b1b537e4979f27a006967.png)

控制台结果![控制台结果](../Images/1e06ea37b7080596a5d20d7951b9d8f9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T20:54:52.550

在 Fabio 建议的基础上尝试使用此代码（显然将 YOUR_APP_ID 替换为您的实际应用程序 ID）

```
 <div id="fb-root"></div>
  <script>     

  window.fbAsyncInit = function() {
    FB.init({
      appId: 'YOUR_APP_ID', 
      status: true,
         cookie: true,
         xfbml: true,
       channelUrl:'/channel.html',
      frictionlessRequests: true,
      useCachedDialogs: true,
      oauth: true
    });
    FB.Event.subscribe('auth.login', function(response) {
      window.location.reload();
    });
    FB.Event.subscribe('auth.logout', function(response) {
      window.location.reload();
    });
  };
(function(d){
   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
   js = d.createElement('script'); js.id = id; js.async = true;
      js.src = "//connect.facebook.net/en_US/all.js";
    ref.parentNode.insertBefore(js, ref);
     }(document));
      </script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:21:22.650

尽管您正在使用 cookie 选项 TRUE 加载 facebook PHP SDK，但服务器端无法猜测用户是否仍在您的网站上登录，或者他是否已更改为另一个帐户等。

如果要在所有页面中保留 usar，则必须将 javascript SDK 与 PHP SDK 结合使用。为此，您只需在您拥有的每个页面中加载 javascript SDK，将其放在需要与 facebook 交互的每个页面上，紧挨`<body>`标签：

```
<body>
    <div id="fb-root"></div>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : 'YOUR_APP_ID', // App ID
              channelUrl : 'URL TO YOUR CHANNEL FILE', // Channel File Optional
              status     : true, // check login status
              cookie     : true, // enable cookies to allow the server to access the session
              xfbml      : true  // parse XFBML
            });

            // Additional initialization code here

            };

          // Load the SDK Asynchronously
          (function(d){
             var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement('script'); js.id = id; js.async = true;
             js.src = "//connect.facebook.net/en_US/all.js";
             ref.parentNode.insertBefore(js, ref);
           }(document));
    </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-28T03:37:18.200

尝试在 cookie 中声明 userID，就像这样：

```
$user = $facebook->getUser();
$expire=time()+60*60*24*30;
setcookie("user", $user, $expire); 
```

对我来说，它就像一种魅力；）

# c# - Mapping two tables with different primary keys to one entity

> ID：15621587
> 
> 赞同：0
> 
> 时间：2013-03-25T17:59:09.857
> 
> 标签：c#, entity-framework

I'm making an application using EF on a legacy database. In the database there are two tables I am concerned with. The structure (in C# form) looks like this:

```
public class Employee
{
    public int employeeID {get; set;} //primary key
    public string name {get; set;}
    ...//other attributes from this table (not relevant)
}
public class EmployeeProfile
{
    public int profileID {get; set;} //primary key
    public int employeeID {get; set;}
    public string favoritemovie {get; set;}
    ...//other attributes from this table (not relevant)
} 
```

There is a 1 - 1 relationship with `EmployeeProfile` and `Employee` in the database. In my application, I'm wanting to create a combined entity, like this:

```
public class Employee
{
    public int employeeID {get; set;}
    public string name {get; set;}              //taken from Employee Table
    public string favoritemovie { get; set; }   //taken from EmployeeProfile table
} 
```

How can I do this? I've heard of entity splitting but that requires the tables to have the same primary key.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:06:11.437

EF 已经为您创建了关系。您应该能够通过 Employee 实体访问 EmployeeFile（即 employee.EmployeeProfile[0] 获取与您检索到的员工实体相关的员工资料）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T20:57:40.353

正如 RandomAsianGuy 所说，从员工实体跳转到个人资料实体很简单。

但是，如果您坚持创建这个合并实体，那么您正在寻找的是 Entity Framework 中的 table-per-type (TPT) 映射继承，使用 Employee 作为基类并从 Employee 派生 EmployeeProfile。

这是使用 EDMX 进行 TPT 继承的 MSDN 演练：

[http://msdn.microsoft.com/en-us/data/jj618293](http://msdn.microsoft.com/en-us/data/jj618293)

# php - Incrementing with for in while loop results in 0

> ID：15621588
> 
> 赞同：0
> 
> 时间：2013-03-25T17:59:11.040
> 
> 标签：php, increment

Why won't $i count up one each time with the following code?

```
<?php if(get_field('staff_member')) { ?>
    <div class="row-fluid">
        <?php while(has_sub_field('staff_member')) 
        {
        for($i = 0; $i <= 1;  $i++)
        echo '<div class="span3 mobile_width' . $i . '"> 

    .....etc...
}
echo '</div>';
}
?> 
```

The output has 4 items and they all return with the the class mobile_width0.

And it also outputs 2 of each item.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:02:30.450

因为您每次都将其重置为 0。你不需要`for`循环，这就是为什么你有双输出。你可以这样做：

```
<?php $i = 0; 
    while(has_sub_field('staff_member')) {
        echo '<div class="span3 mobile_width' . $i . '">';
        $i++;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:02:37.627

尝试

```
for($i = 0; $i < 1; $i++) 
```

`<`代替`<=`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:02:53.107

因为您在 for 循环中将“i”重置为 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T18:08:06.720

每次您的 while cicle 迭代时，`$i`都会重置为 0，在这一行`for($i = 0; $i <= 1; $i++)`中，您是说`$i`只能取 0 和 1 值

# assembly - operend type do not match & illegal instruction

> ID：15621590
> 
> 赞同：0
> 
> 时间：2013-03-25T17:59:17.960
> 
> 标签：assembly

there is an error in line 20 that can't mov edx,dx and other error in line 30 " the function name "

can someone help me ? note :: .startup in my code mean mov ax,@data mov ds,ax

```
.model small,c
.486
.stack 200h
.data 
    num DW ?

    arr db "Plese enter a Number$"
.code
    rev proc _TT:word
    uses ebx,eax,cx
    LOCALS
    mov EBX,0
    mov cx ,0
    mov Ax,_TT
again: CWD
    div cx
    imul  EBX,10
    movs edx,dx  ; <=== error here
    push EAX
    mov ax,dx
    cwde
    add ebx,eax
    pop eax
    cmp eax,0
    JG again
    ret
    endp
    rav
.startup

    .exit
    end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T20:27:28.703

这些是与您的原始问题相关的违规行，以及它们的正确替换：

```
movs edx,dx  ; <=== error here 
```

用。。。来代替：

```
movsx edx,dx  ; Sign-extend dx into edx 
```

`endp`
`rav`

用。。。来代替：

`rev endp ; the end of "rev proc"`

# windows-phone-8-emulator - WP8 Emulator cant connect to Internet when connected with a dongle

> ID：15621596
> 
> 赞同：0
> 
> 时间：2013-03-25T17:59:39.913
> 
> 标签：windows-phone-8-emulator

I am using a plug and play dongle for internet connection. My WP8 emulator is not working ...I tried all the steps mentioned [here](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj681694%28v=vs.105%29.aspx#BKMK_beforestart) and on various other forums.. but it was of no help...I am using a 64 bit machine and Hyper-V is on.What should I do?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T06:44:03.867

这是一个即使是微软也无法回答的问题。

Windows Phone 8 Emulator 有自己的独立 IP，与主机的 IP 不同。它自己需要一个专用的互联网连接。当您连接加密狗时，您将互联网仅提供给主机系统，而不是提供给模拟器。

在模拟器上获取 Internet 的一种方法是在系统上使用 WLAN 连接。您可以创建一个 WiFi 热点，它将为模拟器提供互联网。

如果您只有加密狗作为选项，那么您必须与另一个系统进行网络共享。使用 LAN 电缆与附近的另一个系统创建对等网络，并将两个系统的所有可用虚拟交换机适配器的 IPV4 更改为动态。（无静态 IP）

然后使用加密狗为两个系统共享互联网。如果其他系统成功上网，请确保模拟器也能上网。

您可以通过 Google 搜索如何创建点对点连接。

快乐编码:)

# php - HTTP Referrer through Age Gate

> ID：15621597
> 
> 赞同：1
> 
> 时间：2013-03-25T17:59:42.123
> 
> 标签：php, http-referer

I have an age gate set up on my site, so that users under 17 can't enter the site, but I want people, who have bookmarked a specific link to be able to go to that link after passing through the age gate:

Here is my age gate code:

```
<?php
session_start();

if(isset($_SESSION['legal'])) { # Check to see if session has already been set
$url = ($_SESSION['legal'] == 'yes') ? 'index.php' : 'message.php';
header ('Location: ' .$url);
}

// If visitor hasn't gone through the age gate - Age Gate function and Set Session//
if(isset($_POST['checkage'])) {
$day = ctype_digit($_POST['day']) ? $_POST['day'] : '';
$month = ctype_digit($_POST['month']) ? $_POST['month'] : '';
$year = ctype_digit($_POST['year']) ? $_POST['year'] : '';

$birthstamp = mktime(0, 0, 0, $month, $day, $year);
$diff = time() - $birthstamp;
$age_years = floor($diff / 31556926);
if($age_years >= 18) {
$_SESSION['legal'] = 'yes'; 

$url = 'index.php';
} else {
$_SESSION['legal'] = 'no'; 

// If failed the Age Gate go to specific page
$url = 'message.php';
}
header ('Location: ' .$url);
}
?> 
```

What can I add to this code so that if I wanted to go to domain/page.php or domain/subdirectory/ -- the Age Gate will take me there after I pass it? (I know I have to use HTTP Referrer, but I can't figure out how to include it).

Edit to Add : I know that sometimes Browsers will not keep/send the HTTP Referrer, so I will need a solution for those who don't pass that value.

EDIT : AGE Calculation based on the form submission -

```
$day = ctype_digit($_POST['day']) ? $_POST['day'] : '';
$month = ctype_digit($_POST['month']) ? $_POST['month'] : '';
$year = ctype_digit($_POST['year']) ? $_POST['year'] : '';

$birthstamp = mktime(0, 0, 0, $month, $day, $year);
$diff = time() - $birthstamp;
$age_years = floor($diff / 31556926); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-05T21:53:49.160

我会反过来设置：让每个页面设置一个`$_SESSION`变量来指示去哪里：

```
if (!isset($_SESSION['legal']) || $_SESSION['legal'] == 'no') {
    $_SESSION['target'] = $_SERVER['PHP_SELF'];
    header('Location: message.php');
    return;
}
// continue script execution... 
```

在你的`message.php`：

```
$isLegal = check_age(); // your age checking logic
if ($isLegal && isset($_SESSION['target'])) {
    header('Location: ' . $_SESSION['target']);
} else if ($isLegal) {
    header('Location: index.php');
} else {
    // setup message.php with a validation failed message
} 
```

请注意，这只是可能的变化之一，但我建议不要依赖诸如引用者之类的用户数据（某些浏览器扩展甚至明确地取消设置/修改它）。

# highcharts - Highcharts 3.0 combination chart not fully rendering pie (donut) chart

> ID：15621605
> 
> 赞同：0
> 
> 时间：2013-03-25T18:00:19.480
> 
> 标签：highcharts

I have a Highcharts 3.0 chart that shows both a column chart and a pie (donut) chart. This combo chart was rendering fine with the previous version of Highcharts.

Since upgrading the donut chart only renders to the highest y axis line and does not render above that line. The pie (donut) chart used to render completely with the top half of the pie (donut) chart being to the right of the chart title.

Any ideas?

![Highcharts donut chart](../Images/43eb2f8c3a8f4106702d0c5a5eb634ad.png)

I have added a jsfiddle with a small modification to the Highcharts provided combination chart ([http://www.highcharts.com/demo/combo](http://www.highcharts.com/demo/combo)) to show the issue.

The only line I changed is where to center the pie chart.

```
center: [300, 1], 
```

[http://jsfiddle.net/Sh7wY/](http://jsfiddle.net/Sh7wY/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T16:51:13.253

highslide-software 修复了默认情况下将饼图裁剪到绘图区域的回归。他们还提供了一种可行的解决方法。

请参阅[https://github.com/highslide-software/highcharts.com/issues/1647](https://github.com/highslide-software/highcharts.com/issues/1647)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T13:18:23.757

The pie chart is cutted, because is our of plotArea, where chart can be created. So you can modify pie size [http://api.highcharts.com/highcharts#plotOptions.pie.size](http://api.highcharts.com/highcharts#plotOptions.pie.size) to make chart smaller or modify center parameter.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T13:29:28.063

您必须更改此行：

```
center: [300, 1], 
```

通过这个

```
center: [300, 100], 
```

第二个参数相当于图表的样式“顶部”

# sql - T-SQL Conditional Order By

> ID：15621609
> 
> 赞同：54
> 
> 时间：2013-03-25T18:00:42.143
> 
> 标签：sql, sql-server, tsql

I am trying to write a stored procedure that returns a list of object with the sort order and sort direction selected by the user and passed in as sql parameters.

Lets say I have a table of products with the following columns: product_id(int), name(varchar), value(int), created_date(datetime) and parameters @sortDir and @sortOrder

I want to do something like

```
select *
from Product
  if (@sortOrder = 'name' and @sortDir = 'asc') 
  then order by name asc
  if (@sortOrder = 'created_date' and @sortDir = 'asc') 
  then order by created_date asc
  if (@sortOrder = 'name' and @sortDir = 'desc') 
  then order by name desc
  if (@sortOrder = 'created_date' and @sortDir = 'desc') 
  then order by created_date desc 
```

I tried do it with case statements but was having problems since the data types were different. Anyone got any suggestions?

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2013-03-25T18:07:07.617

`CASE`是一个返回值的表达式。它不适用于流量控制，例如`IF`. 而且您不能`IF`在查询中使用。

不幸的是，表达式有一些限制`CASE`，使得做你想做的事情变得很麻烦。例如，`CASE`表达式中的所有分支都必须返回相同的类型，或者可以隐式转换为相同的类型。我不会尝试使用字符串和日期。您也不能使用`CASE`指定排序方向。

```
SELECT column_list_please
FROM dbo.Product -- dbo prefix please
ORDER BY 
  CASE WHEN @sortDir = 'asc' AND @sortOrder = 'name' THEN name END,
  CASE WHEN @sortDir = 'asc' AND @sortOrder = 'created_date' THEN created_date END,
  CASE WHEN @sortDir = 'desc' AND @sortOrder = 'name' THEN name END DESC,
  CASE WHEN @sortDir = 'desc' AND @sortOrder = 'created_date' THEN created_date END DESC; 
```

一个可以说更简单的解决方案（特别是如果这变得更复杂）是使用动态 SQL。要阻止 SQL 注入，您可以测试这些值：

```
IF @sortDir NOT IN ('asc', 'desc')
  OR @sortOrder NOT IN ('name', 'created_date')
BEGIN
  RAISERROR('Invalid params', 11, 1);
  RETURN;
END

DECLARE @sql NVARCHAR(MAX) = N'SELECT column_list_please
  FROM dbo.Product ORDER BY ' + @sortOrder + ' ' + @sortDir;

EXEC sp_executesql @sql; 
```

动态 SQL 的另一个优点，尽管它散布了所有的恐惧：你可以为每个排序变体获得最佳计划，而不是一个单一的计划，将优化你碰巧首先使用的任何排序变体。在我最近进行的一次性能比较中，它也普遍表现最好：

[http://sqlperformance.com/conditional-order-by](http://sqlperformance.com/conditional-order-by)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-03-25T18:08:13.583

你需要一个 case 语句，尽管我会使用多个 case 语句：

```
order by (case when @sortOrder = 'name' and @sortDir = 'asc' then name end)  asc,
         (case when @sortOrder = 'name' and @sortDir = 'desc' then name end) desc,
         (case when @sortOrder = 'created_date' and @sortDir = 'asc' then created_date end) asc,
         (case when @sortOrder = 'created_date' and @sortDir = 'desc' then created_date end) desc 
```

拥有四个不同的子句消除了类型之间的转换问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-25T18:10:37.850

有多种方法可以做到这一点。一种方法是：

```
SELECT *
FROM
(
  SELECT
  ROW_NUMBER() OVER ( ORDER BY
  CASE WHEN @sortOrder = 'name' and @sortDir = 'asc' then name
  END ASC,
  CASE WHEN @sortOrder = 'name' and @sortDir = 'desc' THEN name
  END DESC,
  CASE WHEN i(@sortOrder = 'created_date' and @sortDir = 'asc' THEN created_date
  END ASC,
  CASE WHEN i(@sortOrder = 'created_date' and @sortDir = 'desc' THEN created_date
  END ASC) RowNum
  *
)
order by 
RowNum 
```

您也可以使用动态 sql 来执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-25T18:08:16.570

```
declare @str varchar(max)
set @str = 'select * from Product order by ' + @sortOrder + ' ' + @sortDir
exec(@str) 
```

# ios - presentViewController shows black page

> ID：15621619
> 
> 赞同：16
> 
> 时间：2013-03-25T18:01:15.100
> 
> 标签：ios, objective-c, xcode, ios6, uikit

```
- (IBAction)submitButtonClicked:(id)sender{
    NSLog(@"here");
    SuccessOrFailViewController *sfvc = [[SuccessOrFailViewController alloc] init];
    [self presentViewController:sfvc animated:NO completion:NULL];
} 
```

I am trying to open a new page when a user clicks the submit button in the app. However, this opens completely black screen with nothing on it. How do I make it open the viewController instead ?

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-25T18:03:26.650

您没有输入用户界面的 nib 名称：

```
SuccessOrFailViewController *sfvc = [[SuccessOrFailViewController alloc] initWithNibName:@"SuccessOrFailViewController" bundle:nil];
[self presentViewController:sfvc animated:NO completion:NULL]; 
```

对于情节提要，这是要走的路：

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
SuccessOrFailViewController *sfvc = [storyboard instantiateViewControllerWithIdentifier:@"SuccessOrFailViewController"];
[sfvc setModalPresentationStyle:UIModalPresentationFullScreen];
[self presentModalViewController:sfvc animated:YES]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-05-14T22:10:08.067

**迅速**

```
var next = self.storyboard?.instantiateViewControllerWithIdentifier("DashboardController") as! DashboardController
self.presentViewController(next, animated: true, completion: nil) 
```

不要忘记`StoryBoard Id`在`StoryBoard`->中设置 ViewController`identity inspector`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-19T18:47:03.573

万一其他人发现这个，请确保您没有设置`self.view.backgroundColor = UIColor.clearColor()`要显示的视图......这为我解决了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-13T20:25:14.947

对于情节提要 iOS7

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
SuccessOrFailViewController *sfvc = [storyboard instantiateViewControllerWithIdentifier:@"SuccessOrFailViewController"];
[sfvc setModalPresentationStyle:UIModalPresentationFullScreen];
[self presentViewController:sfvc animated:YES completion:nil]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-21T06:06:56.387

在故事板中添加和删除视图控制器并忘记使用最新的故事板标识符更新视图控制器后，我已经发生了这种情况。

例如，如果您以编程方式移动到新的视图控制器，如下所示（注意代码中的标识符是“FirstUserVC”）：

```
let firstLaunch = (storyboard?.instantiateViewControllerWithIdentifier("FirstUserVC"))! as UIViewController
self.navigationController?.pushViewController(firstLaunch, animated: true) 
```

确保在 Interface Builder 中设置 Storyboard ID，如下所示，FirstUserVC 在 Storyboard ID 的标识中列出： [![在此处输入图像描述](../Images/51a42196d033823a9e2d941ef1c03929.png)](https://i.stack.imgur.com/ro6RY.png)

# bash - 如何将环境变量传递给不同机器上的 bash

> ID：15621620
> 
> 赞同：0
> 
> 时间：2013-03-25T18:01:15.393
> 
> 标签：bash

我需要在另一台机器上运行一个 shell 脚本。一般的调用方法是这样的：

```
ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null bot-bono@other-dt 'bash' < $GIT_ROOT/chip/sw/scripts/build.sh 
```

由于其他脚本被调用，`build.sh`我无法将参数传递给它。据我所知，如果 a`bash`在本地调用，它会继承环境变量。如果在远程机器上调用它就不会发生这种情况。

有人知道我可以将环境变量传递给远程机器上的 bash 吗？或者，也许有更好的方法`build.sh`在可以使用本地环境变量的远程系统上调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:28:50.223

最好的方法是使用`-o SendEnv=YOURVARIABLE`，但它仅在服务器设置为宽松允许变量时才有效。如果不是，这里有可能的解决方法：

您可以在命令本身中设置变量：

```
ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null bot-bono@other-dt \
    "export CFLAGS='$CFLAGS' LDFLAGS='$LDFLAGS'; bash" < $GIT_ROOT/chip/sw/scripts/build.sh 
```

这不需要任何特定的 SSH 权限，但如果变量可以包含单引号，它确实需要转义变量。

如果您有很多变量并且不想对它们进行排序，您可以将整个环境与您的脚本一起转储：

```
{ set; cat "$GIT_ROOT/chip/sw/scripts/build.sh" } | \
    ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null bot-bono@other-dt 'bash' 
```

这会在远程系统上设置所有本地变量和函数，但可能会导致问题，因为它不会将其限制为您想要的变量，并且会覆盖 PATH 和 DISPLAY 等变量。

# selenium-webdriver - 不同浏览器的屏幕截图分辨率不同

> ID：15621621
> 
> 赞同：1
> 
> 时间：2013-03-25T18:01:15.753
> 
> 标签：selenium-webdriver

我面临一个与我的 GUI 比较项目相关的问题......

它在不同的浏览器中获取给定 URL 的屏幕截图，但这些屏幕截图对于不同的浏览器具有不同的分辨率。

所以，我的问题是，现在该怎么做才能在不同的浏览器中获得所有屏幕截图的相同分辨率。？？？

如果有任何解决方案，请告诉我。

细节：

*   决议：

    *   火狐：- 1345*627
    *   谷歌浏览器：- 1345*659
    *   互联网浏览器：- 1345*679
*   使用的工具：

    *   Selenium 网络驱动程序。
    *   爪哇

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T15:48:16.460

Try maximising the driver window

Example with Junit & webdriver:

```
public class Untitled {
  private WebDriver driver;
  private String baseUrl;
  private boolean acceptNextAlert = true;
  private StringBuffer verificationErrors = new StringBuffer();

  @Before
  public void setUp() throws Exception {
    driver = new FirefoxDriver();
    baseUrl = "http://www.google.com";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
    driver.manage().window().maximize();
  }

  @Test
  public void testUntitled() throws Exception {
driver.get(baseUrl);

  }

  @After
  public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
      fail(verificationErrorString);
    }
  }` 
```

# ruby - 如果使用 .any，使用 .last 获取最后一条记录的 DataMapper 不会引发方法错误？在视野中

> ID：15621625
> 
> 赞同：0
> 
> 时间：2013-03-25T18:01:25.000
> 
> 标签：ruby, conditional, datamapper, instance-variables

为冗长的标题道歉，在我的应用程序中，我试图从数据库中检索与我传递给它的参数匹配的最后一条记录。

```
@goals = Weight.last(:is_goal=>true,:user_id=>@user.id) 
```

在我看来，我想运行一个条件来检查是否存在任何存在，如果存在它将显示一个 div。

```
<% if @goals.any? %>
    <% @goals.each do |goal| %>
        <p><%= goal.amount %></p>
    <% end %>
<% end %> 
```

但由于某种原因，这会引发 no method error `NoMethodError at / undefined method 'any?'`。如果我将其更改`.last`为`.all`有效

```
@goals = Weight.all(:is_goal=>true,:user_id=>@user.id) 
```

这背后有什么原因还是我发现了一个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:28:11.590

好吧，`.last`方法返回一个对象，`.all`方法返回一个对象数组。
并且`.any?`是数组方法。你不能调用`.any?`一个对象，它会告诉你没有方法，除非你创建了一个。

# c - C - 使用指针引用函数以进行多次计算

> ID：15621626
> 
> 赞同：-2
> 
> 时间：2013-03-25T18:01:28.763
> 
> 标签：c

我有以下程序：

```
#include <stdio.h>
#include <stdlib.h>   /* for malloc */
#include <ctype.h>

#define STD_WORK_WEEK 40
#define OVERTIME_RATE 1.5

struct employee
 {
 char first_name[10];
 char last_name[10];
 long id_number;
 float wage;
 float hours;
 float overtime;
 float gross;

 struct employee *next;
 };

 /************************************************************************/
 /*                      Function: Gross_pay_calc                        */
 /*                                                                      */
 /*  Purpose:    Calculates gross pay of an employee using hours and     */
 /*              wage data that is already stored                        */
 /*                                                                      */ 
 /*                                                                      */
 /*  Parameters: wage - Array of employee wages                          */
 /*              hours- Array of number of hours worked by an employee   */
 /*              grossPay- Gross Pay of an employee                      */
 /*              size-number of employees to process                     */
 /*                                                                      */
 /*  Returns:    Stores grossPay to be referenced in another function output  */
 /*                                                                       */
 /************************************************************************/

 /* Function call to calculate gross pay. */
 void Gross_pay_calc (struct employee *emp1)
 { 
  /*Local Variable Declaration */
  struct employee *tmp;   /* tmp pointer value to current node */

            if ( emp1->hours <= STD_WORK_WEEK ) /* Calculates grossPay based on <40 or  >40 for OT */

            {
            emp1->gross = emp1->wage*emp1->hours;
            }

            else

            {
            emp1->gross = (emp1->wage*STD_WORK_WEEK)+((emp1->hours-STD_WORK_WEEK)*     (emp1->wage*OVERTIME_RATE));
            } 

   }

   /*-----------------------------------------------------------------------------*/
   /*                                                                             */
   /* FUNCTION:  print_list                                                       */
   /*                                                                             */
   /* DESCRIPTION:  This function will print the contents of a linked             */
   /*               list.  It will traverse the list from beginning to the        */
   /*               end, printing the contents at each node.                      */
   /*                                                                             */
   /* PARAMETERS:   emp1 - pointer to a linked list                               */
   /*                                                                             */
   /* OUTPUTS:      None                                                          */
   /*                                                                             */
   /* CALLS:        None                                                          */
   /*                                                                             */
   /*-----------------------------------------------------------------------------*/
   void print_list(struct employee *emp1)
   {
    struct employee *tmp;   /* tmp pointer value to current node */
    int i = 0;              /* counts the nodes printed          */

        printf ("--------------------------------------------------------------\n");      /*Print Header To Screen */
        printf ("     Name \t     Clock# \t Wage \t Hours \t OT \t Gross\n");
        printf ("---------------------------------------------------------------\n");

    /* Start a beginning of list and print out each value               */
    /* loop until tmp points to null (remember null is 0 or false)      */

    for(tmp = emp1; tmp ; tmp = tmp->next)
    {
        i++;

        /* TODO - print other members as well */
        printf("\n %s %s %6d %8.2f %5.2f %7.2f\n",tmp->first_name,tmp->last_name,tmp-  >id_number,
                                                  tmp->wage,tmp->hours,tmp->gross);

    }

    printf("\n\nTotal Number of Employees = %d\n", i);

   }

   /*----------------------------------------------------------------------------*/
   /*                                                                            */
   /* FUNCTION:  main                                                            */
   /*                                                                            */
   /* DESCRIPTION:  This function will prompt the user for an employee           */
   /*               id and wage until the user indicates they are finished.      */
   /*               At that point, a list of id and wages will be                */
   /*               generated.                                                   */
   /*                                                                            */
   /* PARAMETERS:   None                                                         */
   /*                                                                            */
   /* OUTPUTS:      None                                                         */
   /*                                                                            */
   /* CALLS:        print_list                                                   */
    /*                                                                            */
   /*----------------------------------------------------------------------------*/
   int main ()
   {

     char   answer[80];       /* to see if the user wants to add more employees */
     int    more_data = 1;    /* flag to check if another employee is to be processed */
      char   value;             /* gets the first character of answer */

struct employee *current_ptr,   /* pointer to current node */
                *head_ptr;       /* always points to first node */

   /* Set up storage for first node */
head_ptr = (struct employee *) malloc (sizeof(struct employee));
current_ptr = head_ptr;

while (more_data)
{
   /* Read in Employee ID and Hourly Wage */

    printf("\nEnter employee ID: ");
    scanf("%li", & current_ptr -> id_number);

    printf("\nEnter employee weekly wage: ");
    scanf("%f", & current_ptr -> wage);

    printf("\nEnter employee weekly hours: ");
    scanf("%f", & current_ptr -> hours);

    printf("\nEnter First Name: ");
    scanf("%s", & current_ptr -> first_name);

    printf("\nEnter Last Name: ");
    scanf("%s", & current_ptr -> last_name);

    printf("Would you like to add another employee? (y/n): ");
    scanf("%s", answer);

    Gross_pay_calc(head_ptr);

    /* Ask user if they want to add another employee */
    if ((value = toupper(answer[0])) != 'Y')
       {
       current_ptr->next = (struct employee *) NULL;
       more_data = 0; 
       }
    else
       {
       /* set the next pointer of the current node to point to the new node */
       current_ptr->next = (struct employee *) malloc (sizeof(struct employee));
      /* move the current node pointer to the new node */
       current_ptr = current_ptr->next;
       }
} /* while */

/* print out listing of all employee id's and wages that were entered */

print_list(head_ptr);

  printf("\n\nEnd of program\n");

 return 0;
   } 
```

现在，当 Gross_pay_calc 执行时，它只会计算第一个员工的总工资。我将如何继续计算我决定添加到计划中的每位员工的 Gross_pay？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:12:21.940

现在你的代码只检查头部的薪水并且头部没有改变。

简单的解决方案是在当前员工上运行 Gross_pay_calc。

但是，我认为更好的方法是编写一个链表（这基本上就是您在这里所拥有的），而不是在末尾添加新节点，而是将它们添加到开头并更新头部以反映变化。

另外，养成制作更多辅助函数的习惯。它将使您的代码更易于阅读和调试。

# ruby-on-rails - 在另一个部分内部渲染一个轨道部分

> ID：15621628
> 
> 赞同：1
> 
> 时间：2013-03-25T18:01:33.910
> 
> 标签：ruby-on-rails

我有一个页面列出了许多产品，在 taxons#show。在 taxons#show 内部，我正在渲染部分 _products.html.erb 以显示产品、图像、变体等。默认情况下，当您单击 taxons#show rails 上的单个产品时，会将您重定向到 products#show 页面，其中渲染部分 _cart_form.html.erb 显示添加到购物车选项。

但是，我正在尝试将 _cart_form.html.erb 呈现在 _products.html.erb 中的灯箱内，该灯箱位于 taxons#show 内。我的问题是 _products.html.erb 正在使用

```
<% products.each do |product| %> 
```

显示每个单独的产品。_cart_form.html.erb 使用 @product 来显示其所有产品信息。如果我保持这种方式，我会收到 nilClass 的 NoMethod 错误，因为未定义 @product。

然后我尝试了：

```
<% @product = product %>
<%= render 'spree/shared/cart_form' %> 
```

但是因为这是在分类单元上输出所有产品的代码#show 上面的代码，它会将 _product.html.erb 中的每个产品更改为相同的产品，即列出的第一个产品。

如何在每个单独的产品的灯箱内呈现 _cart_form.html.erb？

这是taxons_controller.rb：

```
 def show
  @taxon = Taxon.find_by_permalink(params[:id])
  return unless @taxon

  @taxon_id = params[:id].split('/').first
  if @taxon_id 
    instance_variable_set "@enable_#{@taxon_id}", true   #big lettered taxonomy heading
  end

  @product_type = params[:id].split('/').last
  @featured = @taxon_id + '/' + @product_type            #featured image     

  @searcher = Spree::Config.searcher_class.new(params.merge(:taxon => @taxon.id))
  @searcher.current_user = try_spree_current_user
  @searcher.current_currency = current_currency
  @products = @searcher.retrieve_products

  @related_products = @taxon.products.offset(rand(Spree::Product.count - 7)).limit(7)

  respond_with(@taxon) 
```

和 products_controller.rb：

```
 def show
  return unless @product

  @variants =    @product.variants_including_master.active(current_currency).includes([:option_values, :images])
  @product_properties = @product.product_properties.includes(:property)

  referer = request.env['HTTP_REFERER']
  if referer
    begin
      referer_path = URI.parse(request.env['HTTP_REFERER']).path
      # Fix for #2249
    rescue URI::InvalidURIError
      # Do nothing
    else
      if referer_path && referer_path.match(/\/t\/(.*)/)
        @taxon = Taxon.find_by_permalink($1)
      end
    end
  end

  respond_with(@product)
end 
```

# doctrine-orm - Doctrine 2 的 getScheduledEntityUpdates() 函数返回的数组中的键代表什么？

> ID：15621629
> 
> 赞同：1
> 
> 时间：2013-03-25T18:01:41.890
> 
> 标签：doctrine-orm, unit-of-work

在 Doctrine 2 中，UnitOfWork 对象有一个 getScheduledEntityUpdates 方法，该方法返回一个包含所有计划更新的实体的数组。这个数组的键似乎是巨大的十六进制数字，例如`[000000000fa3298000000000d03645f6]`. 这些键代表什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T05:36:39.187

这些键是存储在[工作单元的身份映射中的](https://github.com/doctrine/doctrine2/blob/2.3.3/lib/Doctrine/ORM/UnitOfWork.php#L1311-L1343)对象的对象哈希。

您可以使用以下方法获取对象的对象哈希[`spl_object_hash`](http://php.net/manual/en/function.spl-object-hash.php)：

```
$object = new \stdClass();

var_dump(spl_object_hash($object)); 
```

出于性能原因，ORM 保留所有对象散列和实体标识符（散列）的列表。例如，`$em->persist($object)`多次调用不会导致任何操作，因为在身份映射`$object`中[查找](https://github.com/doctrine/doctrine2/blob/2.3.3/lib/Doctrine/ORM/UnitOfWork.php#L1358-L1362)非常快。

此外，如果您`$em->find('My\Entity', 123)`多次调用，[则标识映射用于查找已在内存中的对象](https://github.com/doctrine/doctrine2/blob/2.3.3/lib/Doctrine/ORM/UnitOfWork.php#L2765-L2784)。

# php - 如何在页面上显示 PHP 和 HTML 源代码？

> ID：15621630
> 
> 赞同：3
> 
> 时间：2013-03-25T18:01:46.707
> 
> 标签：php

如何在用户端显示 PHP 代码。有点像[w3School](http://www.w3schools.com/dtd/default.asp)吗？

让我们说一个灰色区域 div，然后在其中显示代码而不激活它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T18:08:06.253

您可以在 html 中使用 html 实体`&lt;?php`，它将呈现为 <?php

您可以使用[htmlspecialchars](http://www.php.net/manual/en/function.htmlspecialchars.php)对代码进行编码以使用 html 实体。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-25T18:09:48.847

使用`<pre>`or`<code>`标记来包装您的代码。

查看[http://php.net/manual/en/function.highlight-string.php](http://php.net/manual/en/function.highlight-string.php)以进一步了解如何使代码看起来更漂亮。

由于将一大段代码传递给 highlight_string() 可能会很混乱，因此您可能需要结合 highlight_string 来查看输出缓冲以输出彩色 php 代码。

就像是：

```
<?php
ob_start();
?>

phpinfo();
echo "this echo statement isn't executed";

<?php 
$code = ob_get_clean();
highlight_string($code);
?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-03-01T09:56:41.510

只需您可以使用以下代码在网页上显示 php 代码。

```
highlight_string("<?php print('This is php code.'); ?>"); 
```

它会给出类似的输出

```
<?php print('This is php code.'); ?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-25T18:07:22.450

第一步是不要将该代码包装在 PHP 标记中。所以代替这个：

```
<?
    var sample = "code";
?> 
```

你会有这个：

```
var sample = "code"; 
```

从 PHP 引擎触发服务器端编译的不是代码本身，而是向该引擎指示文件的哪些块是代码，哪些不是代码的标签。任何不是代码的东西本质上都被视为一个字符串并按原样输出到页面以供浏览器解释。

一旦你输出了代码，接下来就是格式化它的问题。旧标准是将其包装在`pre`标签中以摆脱 HTML-ish 格式：

```
<pre>
var sample = "code";
</pre> 
```

您还可以将 CSS 样式应用于您认为合适的`pre`标签（或您想要用于显示代码的任何其他标签，例如）。`div`

还有非常有用的代码语法高亮插件和工具可以使代码“更漂亮”。 强烈推荐[Google-code-prettify 。](http://code.google.com/p/google-code-prettify/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T18:05:47.817

通常这是通过在`<pre>`或`<code>`标签中显示代码来完成的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-21T16:23:32.080

使用 php 的 header 函数，这将

```
<?php
  header("content-type: text/plain");
?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-20T20:16:58.940

你可以使用这个模板......

```
######################################################################
echo "<h2><br>Source Code of ".basename((string)__FILE__) . "</h2><hr>";
show_source(__FILE__);
echo "<hr>";
echo "<h2>Output of ".basename((string)__FILE__) . "<hr></h2>";
####################################################################### 
```

它将显示以下源代码和输出。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-03-25T18:06:42.193

PHP 代码将只是一个字符串，您可以`echo`或`print`在页面上，与您希望 PHP 为您显示的任何其他数据没有什么不同。如果要保留格式（例如缩进），请将其放在`<pre><code>`块内。

前任：

```
$php_code = '<?php $foo = bar; ?>';

echo "<pre><code>$php_code</code></pre>"; 
```

# java - 关于 Java 的优先级队列的排序，需要澄清

> ID：15621640
> 
> 赞同：1
> 
> 时间：2013-03-25T18:02:21.450
> 
> 标签：java, priority-queue

请帮我理解一些事情

我从一个

```
private Queue<SomeEvent> future = 
         new PriorityQueue(CAPACITY, new SomeEventComparatorByTime()); 
```

然后，我将 5 个事件（来自第 1 组）添加到队列中，每个事件从 10:49:00 开始。

```
 ScheduledEvent{ userId='group_1_uid1'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid2'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid3'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid4'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid5'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE } 
```

然后我通过一些简单的逻辑将事件分解为 2，递增时间如下。此打印输出显示队列的当前内容。

```
 ScheduledEvent{ userId='group_1_uid1'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid2'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid3'} { startTime=3/31/2013 10:50:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid4'} { startTime=3/31/2013 10:50:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid5'} { startTime=3/31/2013 10:51:00, repeat=RUN_ONCE } 
```

最后，我得到了按`SomeEvent`时间排序的列表。这种精确的分配是意料之中的。

然后，我将另外 3 个事件（来自第 2 组）添加到同一个队列中。这些活动也从 10:49:00 开始

将事件添加到队列后，我得到：

```
 ScheduledEvent{ userId='group_1_uid1'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid2'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_2_uid4'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_2_uid6'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid5'} { startTime=3/31/2013 10:51:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid3'} { startTime=3/31/2013 10:50:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_2_uid5'} { startTime=3/31/2013 10:49:00, repeat=RUN_ONCE }
 ScheduledEvent{ userId='group_1_uid4'} { startTime=3/31/2013 10:50:00, repeat=RUN_ONCE } 
```

请注意，订单是......这里没有排序。为什么？我认为随着新元素添加到队列中，它的位置由比较器确定

```
 for (SomeEvent e : group.getEvents()) {
        future.offer(e);
    } 
```

请问我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:10:54.743

来自[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/PriorityQueue.html)

“方法 iterator() 中提供的迭代器*不能*保证以任何特定顺序遍历优先级队列的元素。如果需要有序遍历，请考虑使用 Arrays.sort(pq.toArray())。”

您还可以`poll`将元素一一获得正确的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:11:58.703

也许您需要检查 SomeEventComparatorByTime 中的逻辑

或者重写 SomeEvent 类中的 compareTo 方法并实现 Comparable

在这种情况下，您不需要使用比较器

只是说

私有队列未来 = new PriorityQueue();

# iphone - ios url从邮件重定向到应用程序

> ID：15621641
> 
> 赞同：8
> 
> 时间：2013-03-25T18:02:26.597
> 
> 标签：iphone, ios, objective-c

是否可以使用通过邮件发送的 URL 以某种方式启动我的应用程序？例如，我有用户个人资料，用户想邀请他们的朋友加入应用程序。他们发送一封电子邮件，其中包含一些网址，例如：

通过此链接加入我： `http://appname?sender_id=25&some_other_value=something`

从 iPhone 打开该链接会将用户带入应用程序并让我解析这些值。

那可能吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-25T18:13:25.710

是的，这是完全可能的。您需要为您的应用注册一个 URL 方案。

在 Xcode 中选择您的应用项目，然后单击目标，然后从 Info 选项卡中注册一个新的 URL 方案。

标识符是您的应用标识符，如 com.company.AppName，而 URL Scheme 是您希望使用的名称，例如 appName

现在至于理想的解决方案，因为我们现在将其添加到我们的应用程序中，理想情况下，您不应该使用您的自定义方案在电子邮件中发送链接。原因是用户可能从计算机上打开它，所以这个链接不起作用。

最好的情况如下：

1.  当您的应用程序第一次运行时，从您的应用程序中打开 Safari 浏览器并将其发送到您的网站。
2.  在网站中，为 Safari 安装一个 cookie（如 myAppIsInstalled）
3.  在同一个网站中，只需使用您的自定义 URL 方案将用户重定向到您的应用程序，即可将用户踢回您的应用程序，例如`appname://`

现在您在电子邮件中发送带有链接到您网站的正常 URL 的链接，这是第 2 部分：

1.  在您的网站中，您检查您的应用程序是否已安装（cookie 存在）
2.  如果它存在，而不是从您的网站打开链接，而是使用正确的值将用户重定向到您的应用程序，例如

    appname://mailbox?sender_is=123&user_name=Lefteris

这可确保您的电子邮件链接始终有效，并且仅当您的应用程序已安装在设备上时，您才能从 Mobile Safari 打开链接...

最后，只是一个说明，URL方案是`appname://`而不是`http://appname`

现在为了更好地解释第 1 部分，在我们的 AppDelegate 中，我们可以在`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`委托中执行此操作：

```
//if user has not set the app installed cookie, set it now.
bool hasAppInstalledCookie = [[NSUserDefaults standardUserDefaults] boolForKey:@"appInstalledCookie"];
if (!hasAppInstalledCookie) {
    //mark it was set
    [[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"appInstalledCookie"];
    [[NSUserDefaults standardUserDefaults] synchronize];
    //open the web browser
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://www.myApp.com/appInstalled"]];
} 
```

现在在我们的 appInsalled 页面（例如 index.html）中，我们只需设置一个 cookie（我们想要的任何 cookie 名称）然后我们将用户踢回我们的应用程序，如下所示：

```
<script type="text/javascript">
    window.location = 'appName://';
</script> 
```

我们使用 cookie 的原因是在用户打开电子邮件链接时使用此 cookie。我们将检查浏览器是否是移动 safari 和 cookie 是否已安装。这样，我们知道用户已经安装了我们的应用程序，并且重定向将正常工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-11-03T12:11:52.840

上面标记的答案是正确的并且工作正常。但是，在 iOS 9 中，Apple 引入了[Universal Links](https://developer.apple.com/library/prerelease/ios/documentation/General/Conceptual/AppSearch/UniversalLinks.html)，它允许您将特定的 Web 域或 Web 链接（路径）关联到您的应用程序。如果应用程序已安装，则可以更轻松地重定向到您的应用程序，或者如果应用程序未安装，则可以更轻松地重定向到您的网页。

请注意，对于仍在运行旧版本 iOS（iOS 9 之前）的设备，您可能仍需要支持 Scheme URI（如果未像[此处那样安装应用程序，可能会回退到 url 链接）。](https://stackoverflow.com/questions/4671634/create-a-link-that-either-launches-ios-app-or-redirects-to-app-store)

如果有人感兴趣，我[在这里](http://www.hasaltaiar.com.au/setting-up-universal-links-on-xamarin-ios-mobile-apps/)记录了我使用 Universal Links 的经验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-15T15:12:51.700

像[http://applinks.org/](http://applinks.org/)这样的东西将更具可扩展性，并且不需要设置 cookie 或默认值来处理。

# python - matplotlib 的上限/下限

> ID：15621643
> 
> 赞同：10
> 
> 时间：2013-03-25T18:02:31.120
> 
> 标签：python, matplotlib

我想用误差线绘制一些数据点。其中一些数据点只有上限或下限，而不是误差线。

所以我试图使用索引来区分带有误差线的点和带有上限/下限的点。但是，当我尝试这样的事情时：

```
errorbar(x[i], y[i], yerr = (ymin[i], ymax[i])) 
```

我收到错误：

```
ValueError: In safezip, len(args[0])=1 but len(args[1])=2 
```

这与[此处](https://stackoverflow.com/questions/13030488/using-pandas-to-plot-barplots-with-error-bars)的讨论类似，但我不使用 pandas，但是，阅读其他几句话对我来说真的很有用。

无论如何，我尝试通过以下方式“扭转”错误：

```
errorbar(x[i], y[i], yerr = [[ymin[i], ymax[i]]], uplims = True) 
```

但是结果图并不清楚：似乎上限和误差线被绘制在一起，或者上限被绘制了两次......

目标是在上下误差条不对称时绘制上下限，因此我可以选择箭头之前的条形长度作为上限/下限。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-25T19:32:26.720

这实际上是让我对 errorbar 感到恼火的事情之一：它对输入的形状和维度非常挑剔。

我假设您想要“误差线”，但希望它们的位置由绝对上限和下限设置，而不是由对称的“误差”值设置。

errorbar 的作用是将您的 y 数组和 yerr[0] 压缩在一起（使用 safezip）作为下限（`yerr[1]`对于上限）。所以你的`y`and `yerr[0]`(and `[1]`) 应该是具有相同大小、形状和维数的数组。yerr 本身根本不需要是一个数组。

如果 x、y、ymin 和 ymax 都是一维数组，那么您拥有的第一个代码*将起作用，这就是它们应该的样子。*听起来你的 y 不是。

但是，重要的是要注意，由于 errorbar yerr 是误差量，而不是绝对限制，因此您需要在实际下限和上限中加上和减去 y。

例如：

```
import numpy as np
import matplotlib.pyplot as plt

x = np.array([1,2,3,4])
y = np.array([1,2,3,4])  
ymin = np.array([0,1,2,3])
ymax = np.array([3,4,5,6])
ytop = ymax-y
ybot = y-ymin

# This works
plt.errorbar(x, y, yerr=(ybot, ytop) ) 
```

[![在此处输入图像描述](../Images/076a4a8397764da6b7c01ec5d0ad6928.png)](https://i.stack.imgur.com/Sbk5T.png)

让我知道我是否误解了任何内容。如果您可以以您正在使用的形式发布一些示例数据，那就太好了。

# ruby-on-rails - Rails：创建一个具有递增属性的数组？

> ID：15621645
> 
> 赞同：0
> 
> 时间：2013-03-25T18:02:32.083
> 
> 标签：ruby-on-rails, arrays

这是我在 Stackoverflow 上的第一个问题，所以不要把我拆散！如果我的问题太长或太基本，我深表歉意，但我认为如果我输入清楚、清晰和丰富，所有相关人员都更容易理解我的问题。如果我的问题格式可以改进，请让我知道以后的问题。

为了把事情放在上下文中，我正在创建一个 Ruby on Rails 应用程序，该应用程序涉及在 Googlegraphs上显示一组记录（ **Times ）。****这些Times**记录有两个重要的属性；他们**的“日期”**属性和**“小时工作时间”**属性。简而言之，我需要在图表上显示特定日期的所有**“hours_worked” 。**因此，要在图表上显示的数组的第一个元素保存第一个日期的所有“ **hours_worked** ”值，第二个元素保存第二个日期的所有**“hours_worked”**值，依此类推。

显然，我不能将所有记录**的“hours_worked”**值放入一个数组中，因为这样会完全忽略**“date”属性。**如果我有一个**'hours_worked'**数组，其中两个元素在同一个**'date'**上，则图表不会知道这一点，并且会简单地显示它们，而根本不确认**'date'**。

我的伪代码“解决方案”：

我虽然可以尝试遍历所有**“时间”**记录并将它们拆分为**“日期”**已经存在于一个数组中的记录，然后将所有副本放在另一个数组中：

```
@array1 = []#Original values
@array2 = []

@task.time_and_attendances.each do |f|
 if f.date is not in @array2
 @array2 << f

else

  @array1 << f 
```

然后我想比较这两个数组，如果@array2 包含@array1 包含的任何日期，只需将**“hours_worked”**加在一起。因为@array1 将包含需要此添加的所有记录，所以具有多条记录的日期将仅将它们**的“hours_worked”**属性组合在一起。这会给我一个数组，其中每个值是每个日期的**“hours_worked”总量。**

这将是我的问题的理想解决方案，但我对如何实施它感到困惑。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:21:29.680

也许是这样的：

```
Time.select('date, sum(hours_worked) as total_hours_worked').group('date(date)') 
```

这应该为您提供一组具有 date 和 total_hours_worked 属性的 Time 对象。

# java - 是否可以从模板参数扩展？

> ID：15621647
> 
> 赞同：2
> 
> 时间：2013-03-25T18:02:43.890
> 
> 标签：java

我想装饰一组派生自一个公共类（TextView）的类。这些类存在于库中，因此我不能简单地修改基类或插入它们的继承层次结构。

```
class A {
}

class B extends A {
}

class C extends A {
}

class D extends B {
    void decoration(){}
} 
```

在上面的例子中，D 类是装饰类。装饰功能对我的每个装饰类都是通用的。

我的问题是，是否可以在 Java 中模板化基类？就像是：

```
class D<T> extends <T ? extends A> {} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:11:38.670

所以你的问题是关于向现有类动态添加方法？类似于 Objective-C 中的类别。这在 Java 中并不简单，因为一旦通过**ClassLoader**加载了一个类，就不能动态地向它添加任何内容。

我想到的最简单的事情是提供一个自定义映射，它可能会在现有类之外。就像是：

```
interface Method<T extends A> {
  public void invoke(T ref);
}

class MethodForA implements Method<A> {
  public void invoke(A ref) { .. }
}

class MethodMapper {
  Map<Class<?>, Method<? extends A>> mapping;

  MethodMapper() {
    mapping = new HashMap<Class<?>, Method<? extends A>>();
    mapping.put(A.class, new MethodForA());
  }

  void invoke(A object) {
    Method<? extends A> method = mapping.get(object.getClass());
    if (method != null) {
      method.invoke(object);
    }
  } 
```

我现在刚刚写了这个样板代码，所以一切都不一定正确，但它的工作方式就是这个。我想你需要做一些运行时类型检查以避免盲目地转换东西。

相反，如果您想知道这是否合法：

```
class A {    
}

class B<T> extends A {   
}

class C<T, U> extends B<T> {
} 
```

是的。您可以通过引入类型参数来使子类成为泛型。

# c++ - DirectX 的新手，自定义类已损坏

> ID：15621652
> 
> 赞同：1
> 
> 时间：2013-03-25T18:02:56.560
> 
> 标签：c++, directx

我是 Stack Overflow 的新手，虽然几年来我一直在编写基本和中级 C++ 程序，但我一直无法超越。我最近通过从 www.planetchili.net 获得的框架了解了如何在 DirectX 中工作。我正在尝试为将演示 AI 和寻路的编程类开发类似于 Asteroid 类型游戏的东西。玩家不会炸毁小行星，而是与其他三角船进行狗斗。

该框架带有一个 Game 对象，我通过它完成了大部分工作。但是，我意识到我可能应该为 Ship 编写自己的类，其中包含执行 Ship 相关操作所需的变量，例如绘制船和跟踪位置和得分等统计数据。

但是，我遇到了一个似乎是 Inception 级悖论的问题。该框架使用称为 D3Dgraphics 的东西，它声明并使用称为 gfx 的 D3D 对象。为了使用 Ship 中的 D3D 绘图功能，我包含了 D3D 库并在 Ship.h 中创建了一个 D3D 对象。

我可以在 Game 中声明和实例化 Ship 对象，但是直接在游戏中使用的绘图功能在通过 ship 对象使用时不起作用。我不知道为什么会这样，但我相信这可能是因为我编织了这个令人讨厌的网络。被反对的 Game 使用了一个 D3D 对象，该对象具有一个名为 Go() 的函数，该函数似乎可以绘制和销毁帧，Ship 对象使用 D3D 对象但无法访问 Game 的 Go() 方法，然后 Game 使用 Ship。

这是我的一些代码...请理顺我。

```
Ship.cpp
    //Ship.cpp
    #include "Ship.h"
    #include <math.h>
    enter code here
    //Constructor
    Ship::Ship(HWND hWnd)
    :   gfx ( hWnd )
    {}
    void Ship::drawLine(int x1, int x2, int y1, int y2){
    //Draws a line using gfx.putPixel- This function works perfectly if declared and used directly in Game.cpp
    }

Ship.h
    //Ship.h
    #pragma once

    #include "D3DGraphics.h"
    #include "Keyboard.h"
    #include <vector>

    class Ship{
    private:
        D3DGraphics gfx;
    public:
        Ship::Ship(HWND hWnd); //Default Constructor
    };

 //Game.h
    #pragma once
    #include "Ship.h"
    #include "D3DGraphics.h"
    #include "Keyboard.h"

    class Game
    {
    public:
        Game( HWND hWnd,const KeyboardServer& kServer );
        void Go();
        //Member functions
    private:
        void ComposeFrame();

    private:
        D3DGraphics gfx;
        KeyboardClient kbd;
        Ship psp;
    };

//Game.cpp
#include "Game.h"
#include <math.h>

Game::Game( HWND hWnd,const KeyboardServer& kServer )
:   gfx ( hWnd ),
    psp(hWnd),
    kbd( kServer )
{}

void Game::Go()
{
    gfx.BeginFrame();
    ComposeFrame();
    gfx.EndFrame();
}

void Game::ComposeFrame()
{
    psp.drawShip();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T13:06:33.963

`D3DGraphics`您的`Game`类正在使用的对象在内存中与该对象不同`Ship` `D3DGraphics`。您必须使用指针来确保使用相同的对象进行绘制，将其更改为以下片段：

```
 class Ship{
        private:
            D3DGraphics *gfx;
        public:
            Ship::Ship(D3DGraphics *pGfx); //Default Constructor
        }; 
```

-

```
//Constructor
        Ship::Ship(D3DGraphics *pGfx)
        {
            gfx = pGfx;    
        } 
```

-

```
Game::Game( HWND hWnd,const KeyboardServer& kServer )
:   gfx ( hWnd ),
    psp(gfx),
    kbd( kServer )
{} 
```

而不是使用`gfx.`你现在必须`gfx->`在你的`Ship`课堂上使用。IE`gfx->PutPixel()`而不是`gfx.PutPixel()`.

附带说明一下，尝试将变量名称更改为使用常用匈牙利表示法提供更多信息的名称：[http ://en.wikipedia.org/wiki/Hungarian_notation](http://en.wikipedia.org/wiki/Hungarian_notation)

# c# - 使用 Entity Framework 5.0 进行数据注释（数据库优先）

> ID：15621656
> 
> 赞同：22
> 
> 时间：2013-03-25T18:03:07.357
> 
> 标签：c#, entity-framework, entity-framework-5, data-annotations

如果我使用实体框架（v5.0）数据库优先方法，使用数据注释进行验证的最佳方法是什么？

这是我由实体框架创建的部分类：

```
//------------------------------------------------------------------------------
// <auto-generated>
//    This code was generated from a template.
//
//    Manual changes to this file may cause unexpected behavior in your application.
//    Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System.ComponentModel.DataAnnotations;

namespace ACore
{
    using System;
    using System.Collections.Generic;

    public partial class PayrollMarkup_State
    {
        [UIHint("StatesEditor")] // <-- I added this line but it will be overwritten
        public string State { get; set; }
        public Nullable<float> MaintenancePercentage { get; set; }
        public Nullable<float> OfficePercentage { get; set; }
    }
} 
```

我试过这个没有成功....

实体框架生成的文件：'PayrollMarkup_State.cs'

```
//------------------------------------------------------------------------------
// <auto-generated>
//    This code was generated from a template.
//
//    Manual changes to this file may cause unexpected behavior in your application.
//    Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System.ComponentModel.DataAnnotations;

namespace ACore
{
    using System;
    using System.Collections.Generic;

    public partial class PayrollMarkup_State
    {
        public string State { get; set; }
        public Nullable<float> MaintenancePercentage { get; set; }
        public Nullable<float> OfficePercentage { get; set; }
    }
} 
```

然后我在另一个目录中创建了这个文件：'PayrollMarkup_state.cs'

```
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Web;

namespace ACore.Models
{
    [MetadataType(typeof(PayrollMarkupMetadata))]
    public partial class PayrollMarkup_State
    {
    }

    public class PayrollMarkupMetadata
    {
        [UIHint("StatesEditor")]
        public string State; // Has to have the same type and name as your model
    }
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-25T18:14:26.810

虽然有点痛苦，但您需要创建一个类来用作[`MetadataType`](http://ryanhayes.net/blog/data-annotations-for-entity-framework-4-entities-as-an-mvc-model/)模型类。

```
[MetadataType(typeof(PayrollMarkupMetadata))
public partial class PayrollMarkup_State
{
  ...
}

public class PayrollMarkupMetadata
{
    [UIHint("StatesEditor")]
    public string State; // Has to have the same type and name as your model
    // etc.
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T18:31:55.463

您有一个命名空间问题 - 您定义了两个不同的 PayrollMarkup_State 类，一个在 ACore 命名空间下，一个在 ACore.Models 命名空间下。在包含元数据类型定义的文件中将命名空间更改为 ACore（来自 ACore.Models）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-20T12:24:11.503

您可以使用**部分元数据类**

[http://www.asp.net/mvc/overview/getting-started/database-first-development/enhancing-data-validation](http://www.asp.net/mvc/overview/getting-started/database-first-development/enhancing-data-validation)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-26T20:12:29.907

我使用了两个额外的类：Map 和 Meta，这是我的地图：

```
namespace Whatever.Models
{
    [MetadataType(typeof(ThisMeta))]
    public partial class This
    {
    }

} 
```

现在这里是元类：

```
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;

namespace Whatever.Models
{
    public class ThisMeta
    {

        [DisplayName("")]
        public int UID { get; set; }

    }
} 
```

# python - 刮痧。从div中提取html而不包装父标签

> ID：15621657
> 
> 赞同：3
> 
> 时间：2013-03-25T18:03:11.900
> 
> 标签：python, html, xpath, css-selectors, scrapy

我使用scrapy来抓取一个网站。

我想提取某些 div 的内容。

```
<div class="short-description">
{some mess with text, <br>, other html tags, etc}
</div>

loader.add_xpath('short_description', "//div[@class='short-description']/div") 
```

通过该代码，我得到了我需要的东西，但结果包括包装 html ( `<div class="short-description">...</div>`)

**如何摆脱那个父html标签？**

**注意**。像 text()、node() 这样的选择器无法帮助我，因为我的 div 包含`<br>, <p>, other divs, etc.`、空格，我需要保留它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T03:33:00.660

尝试`node()`结合`Join()`：

```
loader.get_xpath('//div[@class="short-description"]/node()', Join()) 
```

结果看起来像：

```
>>> from scrapy.contrib.loader import XPathItemLoader
>>> from scrapy.contrib.loader.processor import Join
>>> from scrapy.http import HtmlResponse
>>>
>>> body = """
...     <html>
...         <div class="short-description">
...             {some mess with text, <br>, other html tags, etc}
...             <div>
...                 <p>{some mess with text, <br>, other html tags, etc}</p>
...             </div>
...             <p>{some mess with text, <br>, other html tags, etc}</p>
...         </div>
...     </html>
... """
>>> response = HtmlResponse(url='http://example.com/', body=body)
>>>
>>> loader = XPathItemLoader(response=response)
>>>
>>> print loader.get_xpath('//div[@class="short-description"]/node()', Join())

            {some mess with text,  <br> , other html tags, etc}
             <div>
                <p>{some mess with text, <br>, other html tags, etc}</p>
            </div>
             <p>{some mess with text, <br>, other html tags, etc}</p>
>>>
>>> loader.get_xpath('//div[@class="short-description"]/node()', Join())
u'\n            {some mess with text,  <br> , other html tags, etc}\n
   <div>\n         <p>{some mess with text, <br>, other html tags, etc}</p>\n
   </div> \n     <p>{some mess with text, <br>, other html tags, etc}</p> \n' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T01:35:55.603

```
hxs = HtmlXPathSelector(response)
for text in hxs.select("//div[@class='short-description']/text()").extract(): 
    print text 
```

# javascript - console.log 主干模型，attributes 属性

> ID：15621659
> 
> 赞同：0
> 
> 时间：2013-03-25T18:03:15.400
> 
> 标签：javascript, firebug

我想确保我正确理解了 Firebug。我打印出我的模型。在萤火虫的控制台中，我在属性中看到它有“myProperty”。但是当我这样做时：

```
if (_.has(model, "myProperty")) 
```

或者

```
if (model.hasOwnProperty('myProperty')) 
```

两者都不返回结果。我对 Firebug 或 JS 有什么不了解的地方吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:53:15.780

如果`myProperty`是您为模型提供的属性，那么它将存在于属性对象中：`model.attributes.myProperty`。可以？

请注意，在[文档](http://backbonejs.org/#Model-has)中，如果`myProperty`为 null 或未定义，`model.has(myProperty)`则将返回`false`。

# ios - 动画 UIView 调用方法

> ID：15621660
> 
> 赞同：0
> 
> 时间：2013-03-25T18:03:25.673
> 
> 标签：ios, uiview, uiviewanimation

我有一个应该启动动画的功能。三角形是用“drawrect”设计的，我在控制器中有一个按钮，当按下它时，它会调用“startTriangleAnimation”。

问题是“startTriagnleAnimation”方法没有添加动画。我确信该程序会进入此方法，因为它会打印 NSLOG。

有人知道该怎么做吗？

```
- (void)startTriangleAnimation
{
    [self setNeedsDisplay];
    if (_leftFoot) {
            NSLog(@"LEFT FOOT ANIMATION STARTING");
        [UIView animateWithDuration:15
                              delay:0
                            options: UIViewAnimationOptionCurveLinear
                         animations:^{
                             self.transform = CGAffineTransformMakeRotation(DEGREES_TO_RADIANS(-FIRST_ROTATION));
                         } completion:^(BOOL finished) {
                             [UIView animateWithDuration:15
                                                   delay:0.5
                                                 options: UIViewAnimationOptionCurveLinear
                                              animations:^{
                                                  self.transform = CGAffineTransformRotate(self.transform, DEGREES_TO_RADIANS(-SECOND_ROTATION));
                                              } completion:^(BOOL finished) {
                                                  [UIView animateWithDuration:15
                                                                        delay:0.5
                                                                      options: UIViewAnimationOptionCurveLinear
                                                                   animations:^{
                                                                       self.transform = CGAffineTransformRotate(self.transform, DEGREES_TO_RADIANS(-THIRD_ROTATION));
                                                                   }completion:^(BOOL finished) {
                                                                       [UIView animateWithDuration:15
                                                                                        animations:^{
                                                                                            self.transform = CGAffineTransformRotate(self.transform, DEGREES_TO_RADIANS(-FOURTH_ROTATION));
                                                                                        }];
                                                                   }];
                                              }];
                         }];

    } else {
         NSLog(@"RIGHT FOOT ANIMATION STARTING");
        [UIView animateWithDuration:15
                              delay:0
                            options: UIViewAnimationOptionCurveLinear | UIViewAnimationOptionBeginFromCurrentState
                         animations:^{
                             NSLog(@"animating");
                             self.transform = CGAffineTransformMakeRotation(DEGREES_TO_RADIANS(FIRST_ROTATION));
                         } completion:^(BOOL finished) {
                             [UIView animateWithDuration:15
                                                   delay:0.5
                                                 options: UIViewAnimationOptionCurveLinear | UIViewAnimationOptionBeginFromCurrentState
                                              animations:^{
                                                  self.transform = CGAffineTransformRotate(self.transform, DEGREES_TO_RADIANS(SECOND_ROTATION));
                                              } completion:^(BOOL finished) {
                                                  [UIView animateWithDuration:15
                                                                        delay:0.5
                                                                      options: UIViewAnimationOptionCurveLinear | UIViewAnimationOptionBeginFromCurrentState
                                                                   animations:^{
                                                                       self.transform = CGAffineTransformRotate(self.transform, DEGREES_TO_RADIANS(THIRD_ROTATION));
                                                                   }completion:^(BOOL finished) {
                                                                       [UIView animateWithDuration:15
                                                                                        animations:^{
                                                                                            self.transform = CGAffineTransformRotate(self.transform, DEGREES_TO_RADIANS(FOURTH_ROTATION));
                                                                                        }];
                                                                   }];
                                              }];
                         }];

    }
}

- (void)drawRect:(CGRect)rect
{
    CGFloat x = self.bounds.size.height;
    CGFloat y = self.bounds.size.width;

    [[UIColor redColor] setStroke];

    UIBezierPath *path = [UIBezierPath bezierPath];
    [path moveToPoint:CGPointMake(x/2, y - 20)];
    [path addLineToPoint:CGPointMake(x/2 - 10, y)];
    [path addLineToPoint:CGPointMake(x/2 + 10, y)];
    [path closePath];
    [path fill];
    //[path stroke];

    if (_leftFoot) {
        self.transform = CGAffineTransformMakeRotation(DEGREES_TO_RADIANS(10));

    } else {
        self.transform = CGAffineTransformMakeRotation(DEGREES_TO_RADIANS(-10));

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T22:36:55.790

一种可能的解释是您的 FIRST_ROTATION 等变量中有意外的值。

另一个是你在drawRect中旋转。在我看来，这会产生意想不到的后果。如果您希望您的“基础三角形”不是直的，只需计算路径的适当点并立即绘制它。

# ios - 我需要为 iPhone 4 和 iPhone 5 设置单独的图像吗？

> ID：15621662
> 
> 赞同：1
> 
> 时间：2013-03-25T18:03:30.463
> 
> 标签：ios, iphone-5

我有一个适用于 iPhone 4 的应用程序，其中包含 1000 多个 .jpg 照片图像。我的问题是：我需要为 iPhone 5 设置单独的图像吗？我猜答案一定是“是”，因为经过广泛的谷歌搜索后我找不到任何东西，但我真的很想在开始一项大任务之前确认，从原件调整大小，这也将涉及裁剪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:18:36.367

这取决于。唯一需要 iPhone 5 特定图像来避免图像拉伸的情况应该是当您拥有 UIImageViews 时，其尺寸会随屏幕尺寸（例如全屏图像）而变化。

由于全屏 UIImageView 将是 1136x640 而不是 960x480，因此您需要为 iPhone 5 再次创建图像，因为该尺寸与屏幕尺寸直接相关。但是，如果您有任何具有标准化尺寸的 UIImageView（例如 100x100 UIButton 图像），则这些图像可以保持原样，因为 iPhone 5 只需要与 iPhone 4 加载相同的 200x200 视网膜图像。

# javascript - Superbox JS 和流沙组合问题

> ID：15621667
> 
> 赞同：0
> 
> 时间：2013-03-25T18:03:50.933
> 
> 标签：javascript, jquery, quicksand

我在这里有一个投资组合部分...... [http://bvh.delineamultimedia.com/?page_id=2](http://bvh.delineamultimedia.com/?page_id=2)和 Superbox - （[http://toddmotto.com/introducing-superbox-the-reimagined-lightbox-gallery/](http://toddmotto.com/introducing-superbox-the-reimagined-lightbox-gallery/)）正在工作但是在我点击流沙“过滤器”链接后，超级框似乎被禁用了。有没有办法来解决这个问题。这是JavaScript。我有点困惑为什么会这样。我猜流沙有点贪心，但我不确定。

先谢谢了！

```
;(function($) {

$.fn.SuperBox = function(options) {

    var superbox      = $('<div class="superbox-show"></div>');
    var superboximg   = $('<img src="" class="superbox-current-img">');
    var superboxclose = $('<div class="superbox-close"></div>');

    superbox.append(superboximg).append(superboxclose);

    return this.each(function() {

        //$('.superbox-list').click(function() {
        $('.superbox').on('click', '.superbox-list', function() {

            var currentimg = $(this).find('.superbox-img');
            var imgData = currentimg.data('img');
            superboximg.attr('src', imgData);

            if($('.superbox-current-img').css('opacity') == 0) {
                $('.superbox-current-img').animate({opacity: 1});
            }

            if ($(this).next().hasClass('superbox-show')) {
                superbox.toggle();
            } else {
                superbox.insertAfter(this).css('display', 'block');
            }

            $('html, body').animate({
                scrollTop:superbox.position().top - currentimg.width()
            }, 'medium');

        });

        $('.superbox').on('click', '.superbox-close', function() {
            $('.superbox-current-img').animate({opacity: 0}, 200, function() {
                $('.superbox-show').slideUp();
            });
        });

    });
};
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:07:27.027

当流沙过滤器处于活动状态时，它会为 设置一个新的高度，`filterable-grid` `ul`并设置`overflow:hidden`隐藏超级框不被显示..正在正确调用，它只是隐藏在溢出中`ul`..可能需要修改`quicksand`脚本或找到另一个解决方法..

# jquery - Jquery 表单验证 - 返回 false 不会结束循环

> ID：15621668
> 
> 赞同：0
> 
> 时间：2013-03-25T18:03:52.353
> 
> 标签：jquery

我想验证一个表单，以便填写所有文本输入字段。为此，我在下面编写了函数，但我的问题是它总是向我显示经过验证的消息。如果我将某些字段留空，它会同时显示为空和已验证的警报。

如果你请帮助或建议更好的方法。

```
function validate() {
    $("#myform :text").each(function(){
        if($.trim(this.value).length==0){
            alert("Empty!");
            return false;
        }
    });
    return 1;
}
$(document).on('click','#addnew',function() {
    if(validate() != 1){
        return false;
    }
    alert('Verified.');
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:07:34.483

`return false;`只会退出`$.each()`循环。您需要在循环中设置一个变量，然后返回：

```
function validate() {
    var ret = true;
    $("#myform :text").each(function(){
        if($.trim(this.value).length==0){
            alert("Empty!");
            ret = false;
            return false;
        }
    });
    return ret;
} 
```

然后您需要`click`适当地更改您的处理程序（使用 bools 而不是 -1）；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:09:39.423

在您的代码中，空字段之后的任何已完成字段都会导致您的函数返回 1。要解决此问题，请创建一个定义为 true 的变量，如果任何字段为空，则将其设置为 false。

```
function validate() {
    var isValid = true;
    $('#myform :text').each(function () {
        if($.trim(this.value).length === 0){
            alert('Empty!');
            isValid = false;
        }
    });
    return isValid;
}
$(document).on('click', '#addnew', function () {
    var isValid = validate();
    if (isValid) {
        return false;
    }
    alert('Verified.');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T18:09:51.963

我更改了您的代码以返回一个名为 fail 的变量，而不是尝试从您的函数中提前返回。应该更好地工作：

```
 function validate() {
    var fail = false;
    $("#myform :text").each(function(){
        if($.trim(this.value).length==0){
            alert("Empty!");
            fail = true;
            return false;
        }
    });
    return !fail;
}
$(document).on('click','#addnew',function() {
    if(validate()){  
        return false;
    }
    alert('Verified.');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T18:07:41.687

首先，我发现使用 console.log 进行 JavaScript 调试比使用警报更容易（它们不会阻止脚本执行，使时间更加明显）。

因此，您的 validate 函数似乎从未真正返回 -1，它返回 false。正因为如此，click 函数中的比较永远不会是真的，这意味着“已验证”。警报将始终显示。

# json - IE9 中奇怪的 iframe 行为

> ID：15621669
> 
> 赞同：1
> 
> 时间：2013-03-25T18:03:55.083
> 
> 标签：json, internet-explorer, iframe, whitespace

在有人抱怨之前，我不使用`iframes`（但在尝试修复错误时，我发现该问题与`iframe`IE9 中的一种奇怪行为有关，并且它是由其他人编码的）。

单击提交后，我有一个 JSON 被发送到 iframe：

```
 <a id="general_Submit.Label" class="formActionLink" href="javascript:submitAndSendEmail();"/>

    <form name="fileUploader" id="fileUploader" enctype="multipart/form-data" method="post" action="ajaxFileUploadAction.action" target="upload_target">
        <input type="file" name="upload" id="upload" size="40" onchange="dynFileUploader.uploadFile(this);" onkeyup="dynFileUploader.checkValidFile(this)" />
        <iframe name="upload_target" id="upload_target" src="" onload="javascript:dynFileUploader.uploadDone();"> </iframe>
    </form> 
```

**问题**

操作正确返回了 JSON：

```
{"JSONClass":"com.lalala.process.email.util.FileContentHolder",
"contentType":"application/pdf","data":[],"fileLength":348364,
"fileName":"001a.<space>bla<space>refrigeration<space><space>-<space>aaa<space>- <space>Tenderer<space>Instructions.pdf",
"tempFileName":"C:\\Users\\humbleUser\\AppData\\Local\\Temp\\UPLOADED_7567343180347343279_001a.<space>bla<space>refrigeration<space><space>-<space>aaa<space>-<space>TendererInstructions.pdf"} 
```

问题出在文件名中：在冷藏一词之后有两个空格。当我们将此 json 发送到 iframe 时，使用`target="upload_target"`，它到达 iframe 时没有这些空格之一。例如：

如果我们有文件：test1.pdf，在 IE 中，它作为 test1.pdf 进入 iframe

为什么我们会有这种行为？当然，它不会发生在 Firefox 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T14:01:31.160

我可以看到没有人从未面对过它，我得出结论这是 IE 的另一种行为，它必须将连续的空格视为唯一一个。在搜索时，我注意到这是文件名的常见问题，正如我们在此[链接](http://www.binaryfortress.com/NotepadReplacer/Discussions/View/filenames-with-multiple-consecutive-spaces/?ID=4c64d45b-b748-46f2-bd60-ecbe66b51475)中看到的那样。

无论如何，在我看来，这个问题的答案是它是来自 IE 的错误。我解决了我的错误（当用户试图上传一个文件名包含多个连续空格的文件时，它没有被正确保存，因为这些空格被减少到只有一个，所以我通过替换下划线的空格来修复它，它工作得很好！）

# c - Windows 复制命令（如 XCOPY、COPY、ROBOCOPY）在 System() 中的 C 语言中不起作用

> ID：15621670
> 
> 赞同：1
> 
> 时间：2013-03-25T18:04:05.193
> 
> 标签：c, file, copy, xcopy, copying

我正在用 C 语言编写这段代码，我首先找出登录的用户，然后从该用户的 AppData 中，我需要复制一些文件。我能够找到，用户，我能够生成路径，但问题是我不知道如何使用 C 复制文件夹及其内容，所以我想到了使用 System() 命令。但是现在如果我使用 COPY 命令，它说路径不正确，而实际上如果我在 CMD 上使用相同的命令，它是正确的并且工作正常。此外，如果我使用 XCOPY，它会说该命令不被识别为内部或外部命令，而 XCOPY 在 CMD 上工作正常。

那么有人可以告诉我如何实际复制文件夹及其内容吗？

我正在分解部分代码以生成文件路径和复制命令。

```
//making path variable
char path[100]; 
strcat(path,"C:\\Users\\");
strcat(path,username); //username is variable it gets value from function

strcat(path,"\\AppData\\Local\\Google\\Chrome\\*.*");
printf(path);

char command[100]; 
strcat(command,"copy ");
strcat(command,path);
strcat(command," D:\\myFolder");
printf("\n");
printf(command);
printf("\n");
system(command); 
```

**更新**

这是我的完整代码，有人可以完成这项工作吗？

```
#include <stdio.h>
#include <sys/types.h>
#include <dirent.h>
#include <windows.h>
#include <Lmcons.h>

int main()

{
//getting current user
TCHAR username[UNLEN+1];
DWORD len = UNLEN+1;
GetUserName(username, &len);
printf(username);
printf("\n");

//making path variable
char path[100]; 
strcpy(path,"C:\\Users\\");
strcat(path,username);

strcat(path,"\\AppData\\Local\\Google\\Chrome\\*.*");
printf(path);

//listing dir
DIR *dfd = opendir(path);
struct dirent *dp;
if(dfd != NULL) {
    while((dp = readdir(dfd)) != NULL)
        printf("%s\n", dp->d_name);
    closedir(dfd);
}

char command[100]; 
strcpy(command,"copy ");
strcat(command,path);
strcat(command," D:\\myFolder\\");
printf("\n");
printf(command);
printf("\n");
//sprintf(command, "copy %s/*.* D:/myfolder",path);
system(command);

return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:02:07.553

您正在使用未初始化的数组。

改变

```
strcat(path,"C:\\Users\\");
strcat(command,"copy "); 
```

至

```
strcpy(path,"C:\\Users\\");
strcpy(command,"copy "); 
```

# java - Java 套接字写入错误

> ID：15621673
> 
> 赞同：0
> 
> 时间：2013-03-25T18:04:37.593
> 
> 标签：java, sockets, tcp, client, client-server

我收到“套接字写入错误”。在 StackOverflow 上搜索时，我发现了一些使用 flush(); 的建议。通过流发送字节的方法。我遇到的问题是在使用 flush(); 方法，我仍然得到错误。我不确定是什么导致了问题。有任何想法吗？这是完整的客户端代码：

```
import java.io.*;
import java.net.*;
import java.util.ArrayList;
import java.util.Scanner;

public class TCPClient {

   public static void main(String[] args) throws Exception {

      String origSentence;
      String modifiedSentence;
      boolean win = false;
      boolean lose = false;

      //BufferedReader inFromUser;
      //inFromUser = new BufferedReader(new InputStreamReader(System.in));
      Scanner inFromUser = new Scanner(System.in);
      Socket clientSocket = new Socket("10.64.121.145", 6784);
      boolean first = true;
      DataOutputStream outToServer =
              new DataOutputStream(clientSocket.getOutputStream());
      origSentence = inFromUser.nextLine();
      outToServer.writeBytes(origSentence + '\n');
      outToServer.flush();

      Scanner inFromServer = new Scanner(clientSocket.getInputStream());
      modifiedSentence = inFromServer.nextLine();
      GUI gui = new GUI(Integer.parseInt(modifiedSentence));
      System.out.println("The word is " + modifiedSentence + " letters long. Pick a letter!");
      gui.isNotSolved();

      while (win != true && lose != true) {
         origSentence = inFromUser.nextLine();
         System.out.println(origSentence);
         outToServer.writeBytes(origSentence + '\n'); //The failure is on this line
         outToServer.flush();
         modifiedSentence = inFromServer.nextLine();
         if (modifiedSentence.equals(""))//guess not in word so add a miss
         {
            if (gui.addMiss(origSentence) == false) {
               lose = true;
            }
         }
         if (!modifiedSentence.equals(""))//guess is in word so display where letter occurs
         {
            ArrayList<Character> list = new ArrayList<Character>();
            int length = modifiedSentence.length();
            for (int i = 0; i < length; i++) {
               list.add(modifiedSentence.charAt(i));
            }
            for (char c : list) {
               if (c == ' ') {
                  list.remove(c);
               }
            }
            for (int i = 0; i < list.size(); i++) {
               String s = list.get(i).toString();
               gui.addLetter(origSentence.charAt(0), Integer.parseInt(s));
            }

         }

         if (gui.isNotSolved() == false)//game won send server "won" message to terminate connection
         {
            String won = "won";
            outToServer.writeBytes(won);
            outToServer.flush();
         }

         if (lose == true)//game lost send server "lost" message to
         {            //have server send the word to display for player
            String lost = "lost";
            outToServer.writeBytes(lost);
            gui.setWord(modifiedSentence);
            outToServer.flush();
         }
      }
      clientSocket.close();

   }
} 
```

...代码继续，但它似乎并没有进入其余的代码。我有点迷茫为什么它总是失败。我在第一次使用 outToServer 后刷新（），但在第二次使用时失败。我猜这是一个客户端问题。有什么帮助吗？谢谢。这是服务器代码：

```
import java.io.*;
import java.net.*;
import java.util.Scanner;

public class TCPServer {

   public static void main(String[] args) throws Exception {
      String clientSentence;
      Word word = new Word();
      int wordLen = word.getLength();
      ServerSocket welcomeSocket = new ServerSocket(6784);
      System.out.println(InetAddress.getLocalHost());
      boolean begin = true;

      while (true) {
         Socket connSocket = welcomeSocket.accept();
         Scanner inFromClient = new Scanner(connSocket.getInputStream());
         clientSentence = inFromClient.nextLine(); //cap would go after this
         DataOutputStream outToClient =
                 new DataOutputStream(connSocket.getOutputStream());

         if (begin == true) {
            //DataOutputStream outToClient =
            //new DataOutputStream(connSocket.getOutputStream());
            System.out.println("begin " + word.getWord());
            outToClient.writeBytes("" + word.getLength());
            outToClient.flush();
         }
         if (begin == false) {
            System.out.println("hello");
            //DataOutputStream outToClient =
            //new DataOutputStream(connSocket.getOutputStream());
            String pos = word.getSpots(clientSentence.charAt(0));
            outToClient.writeBytes(pos);
            outToClient.flush();
         }
         if (clientSentence.equals("lost")) {
            outToClient.writeBytes(word.getWord());
            outToClient.flush();
         }
         if (clientSentence.equals("won")) {
            connSocket.close();
         }
         begin = false;
         connSocket.close();
      }

   }
} 
```

这是错误：

```
Exception in thread "main" h //Ignore the 'h', it's just a print statement checking input
java.net.SocketException: Software caused connection abort: socket write error
at java.net.SocketOutputStream.socketWrite0(Native Method)
at java.net.SocketOutputStream.socketWrite(Unknown Source)
at java.net.SocketOutputStream.write(Unknown Source)
at java.io.DataOutputStream.writeBytes(Unknown Source)
at TCPClient.main(TCPClient.java:35)

The error now is:
Exception in thread "main" java.net.ConnectException: Connection timed out: connect
at java.net.PlainSocketImpl.socketConnect(Native Method)
at java.net.PlainSocketImpl.doConnect(Unknown Source)
at java.net.PlainSocketImpl.connectToAddress(Unknown Source)
at java.net.PlainSocketImpl.connect(Unknown Source)
at java.net.SocksSocketImpl.connect(Unknown Source)
at java.net.Socket.connect(Unknown Source)
at java.net.Socket.connect(Unknown Source)
at java.net.Socket.<init>(Unknown Source)
at java.net.Socket.<init>(Unknown Source)
at TCPClient.main(TCPClient.java:17) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:56:01.810

您将立即关闭服务器中的连接：

```
Socket connSocket = welcomeSocket.accept();
Scanner inFromClient = new Scanner(connSocket.getInputStream());
clientSentence = inFromClient.nextLine(); //cap would go after this
DataOutputStream outToClient =
    new DataOutputStream(connSocket.getOutputStream());

[...]
connSocket.close(); 
```

所以很明显，一旦服务器读取了客户端的第一行并发送了响应，连接就关闭了，客户端不能再发送任何东西了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T21:20:21.467

应该与服务器代码中的以下更改一起使用：

```
Socket connSocket = welcomeSocket.accept();
Scanner inFromClient = new Scanner(connSocket.getInputStream());
DataOutputStream outToClient = new DataOutputStream(connSocket.getOutputStream());
while (inFromClient.hasNext()) {
    clientSentence = inFromClient.nextLine(); //cap would go after this
    System.out.println("received from client: "+clientSentence);
}
.
.
.
.
connSocket.close(); 
```

您的客户端只创建一次 IO 流，而服务器为每次迭代都创建了一次，因此无法建立连接。

# php - 不同大小的表单域的问题

> ID：15621676
> 
> 赞同：0
> 
> 时间：2013-03-25T18:04:45.143
> 
> 标签：php, html

我不知道如何使这项工作。我们必须使用 PHP 构建一个 CSV 文件。用于创建 CSV 文件的表单是此问题的主题。该程序涉及品牌/型号/年份。

第 1 页提出问题：“你想要多少品牌” 第 2 页提出问题：“每个品牌有多少型号”

这是我到目前为止所拥有的：index.php：

```
<form action="import_page_1.php" method="post">
Number of Makes: <input type="text" name="num_makes" value="Enter a number"></input><hr>
<input type="submit" value="Next.." />

import_page_1.php:

<form action="import_page_2.php" method="post" />
<?php
$num_makes = (int) $_POST['num_makes'];
$count = 0;
$make_array = array();
    for ($i = 0; $i < $num_makes; $i++) {
        $count++;
        echo "Make $count: <input type='text' name='$make_array['make'] /><br />";
}
?>
<hr>
    <input type="submit" value="Next.." />
</form> 
```

我不知道如何让 $make_array 填充用户输入的每件事。我不能像我在示例中所做的那样仅指定 ['make']，因为那样我得到的只是最后一个结果。

因此，也许我的做法是错误的，或者这是一些简单的解决方案，可以根据先前给出的字段数量创建表单，然后根据“Toyota”等品牌创建数组。我的测试用例是 1：日产，2：丰田。在下一页上，我从 $_POST 数组中得到的只是最后一个输入的“Toyota”，我假设是因为它覆盖了 for 循环中的每个“make”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:37:59.867

首先，我不会说英语，所以如果有什么不清楚的地方我真的很抱歉，但我会尽力而为。

好的，如果我理解您的问题，您需要做的是输入数组来获取下一页中的所有值。

现在我知道几种方法，我会告诉你我认为最简单的方法，它是为 (for()) 循环中的每个输入赋予不同的名称，如下所示：

```
<?php
<form action="import_page_1.php" method="post">
Number of Makes: <input type="text" name="num_makes" value="Enter a number"></input><hr>
<input type="submit" value="Next.." />

import_page_1.php:

<form action="import_page_2.php" method="post" />
<?php
$num_makes = (int) $_POST['num_makes'];
        for ($i = 0; $i < $num_makes; $i++) {
            echo 'Make '.($i+1).': <input type="text" name="new_input"'.$i.' /><br />';
    }

?>
<input type="hidden" value="<?php echo $num_makes?>" name="total_new_inputs"/> 
```

然后在下一页中，您可以通过使用另一个循环 (for()) 重新构造之前编写的输入名称来获取值，如下所示：

```
for ($i = 0; $i < $_POST['total_new_inputs']; $i++) {
        $value.$i = $_POST['new_input'.$i];
        echo $value.$i;

} 
```

我希望你得到了一切。

# c - 在使用 fscanf 操作之前检查字符串的大小？

> ID：15621682
> 
> 赞同：1
> 
> 时间：2013-03-25T18:05:03.333
> 
> 标签：c

我正在尝试编写安全的文件输入。我的缓冲区大小固定为 128。我想从文件中读取字符串，但在复制它们之前，我想检查它们的长度是否小于或等于`128`。

我可以做类似的事情：

```
fscanf(fp, "%128s", myString) 
```

我已经看到以相同方式使用的 scanf 会限制读入的字符数，但没有看到对它的任何引用以这种方式与 fscanf 和字符串一起使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T18:11:08.140

是的，你可以这样做，但你差了 1。所以如果你有一个长度为 128 个字符的数组：

```
char myString[128] = {'\0'};
fscanf(fp, %127s", myString); 
```

您提到您已经看到在 中使用的语法`scanf()`，这与以下内容相同：

```
fscanf(stdin, "%127s", myString); // just like scanf("%127s", myString); 
```

请注意[手册页](http://linux.die.net/man/3/scanf)`scanf()`如何具有与和的格式字符串有关的相同信息`fscanf()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:08:20.377

如果您在 Windows 平台上，我认为您可以使用`fscanf_s`，否则我认为最好使用`fgets`和/或`sscanf`:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T18:08:34.740

你可以[`char * fgets ( char * str, int num, FILE * stream );`](http://www.cplusplus.com/reference/cstdio/fgets/)用来避免缓冲区溢出

喜欢：

```
fgets(myString, 127, fp); 
```

# sql-server - 将一列数据旋转到行，同时保持其他列不变

> ID：15621683
> 
> 赞同：0
> 
> 时间：2013-03-25T18:05:04.320
> 
> 标签：sql-server, sql-server-2005, pivot

我正在从 SQL Server 2005 数据库中检索几条记录：

![在此处输入图像描述](../Images/0ee69cdeae13c7e0624e8d5f115e0ef0.png)

我想透视数据以显示如下结果：

![在此处输入图像描述](../Images/5cdf445380e76ae48564fc10e3cc2095.png)

日期和过程可以是无限的，所以我想使用动态枢轴。我尝试了一些解决方案，但无法使其发挥作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:11:03.847

好吧，首先，你不能在一个表中拥有无限数量的列，所以我假设你有更少的 1023 个进程。无论如何，您需要为此使用动态枢轴：

```
DECLARE @Processes AS NVARCHAR(MAX), @Query  AS NVARCHAR(MAX);

SELECT @Processes = STUFF(( SELECT DISTINCT ',' + QUOTENAME(Process) 
                            FROM YourTable
                            WHERE Process IS NOT NULL
                            FOR XML PATH(''), 
                            TYPE).value('.', 'NVARCHAR(MAX)'),1,1,'')

SET @Query = '
SELECT *
FROM YourTable T
PIVOT(SUM([Percent]) FOR Process IN ('+@Processes+')) AS PT'

EXEC(@Query) 
```

[](http://sqlfiddle.com/#!3/1e761/9)**这是一个带有现场演示[**的 sqlfiddle 。**](http://sqlfiddle.com/#!3/1e761/9)**

# c# - 将 SQL 表转换为 ASP.Net EF 5 Code First 的实体

> ID：15621685
> 
> 赞同：0
> 
> 时间：2013-03-25T18:05:05.607
> 
> 标签：c#, ef-code-first, entity-framework-5, asp.net-4.5

我正在尝试将旧网站转换为使用 ASP.Net 4.5 和 EF5 Code First，但是旧网站中有一个表我无法弄清楚如何转换，因为它有两列都引用了父表中的同一列. 谁能帮我转换这张表？

```
 CREATE TABLE dbo.tblCollectionsList
    (
        ListID smallint IDENTITY(0,1) NOT NULL,
        SectionID smallint NOT NULL,
        IncludedSectionID smallint NOT NULL,
        CONSTRAINT PK_CollectionsList_ListID PRIMARY KEY CLUSTERED (ListID ASC),
        CONSTRAINT FK_CollectionList_SectionInfo FOREIGN KEY (SectionID) REFERENCES dbo.tblSectionInfo (SectionID),
        CONSTRAINT FK_CollectionList_SectionInfo2 FOREIGN KEY (IncludedSectionID) REFERENCES dbo.tblSectionInfo (SectionID)
    ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:29:40.070

这就是使用属性，你也可以在没有属性的情况下做同样的事情，而是使用 FluentApi in `OnModelCreating`.

```
[Table("tblCollectionsList")]
public class CollectionsList
{
[Key]
public byte ListID {get;set;}
public byte SectionID {get;set;}
public byte IncludedSectionID {get;set;}

[ForeignKey("SectionID")]
public virtual Section Section {get;set;}
[ForeignKey("IncludedSectionID")]
public virtual Section IncludedSection {get;set;}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:52:34.367

请原谅个人偏好表名，但您面临的问题是级联删除，您可以在模型创建中关闭此行为：

```
[Table("Section")]
public class Section
{
    [Key]
    public virtual int Id { get; set; }
    public virtual string Description { get; set; }
}

[Table("List")]
public class List
{
    [Key]
    public virtual int Id { get; set; }
    [Required]
    [ForeignKey("Section")]
    public virtual int SectionId { get; set; }
    public virtual Section Section { get; set; }
    [Required]
    [ForeignKey("IncludedSection")]
    public virtual int IncludedSectionId { get; set; }
    public virtual Section IncludedSection { get; set; }
}

public class SectionContext : DbContext
{
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>();   
        base.OnModelCreating(modelBuilder);
    }
    public DbSet<Section> Sections { get; set; }
    public DbSet<List> Lists { get; set; }
} 
```

# android - 破坏方法Android的问题

> ID：15621687
> 
> 赞同：1
> 
> 时间：2013-03-25T18:05:15.753
> 
> 标签：android, loops, methods, media-player, break

下面的代码不会破坏方法或循环，而是永远循环播放音乐。当`(n==maxCount)`它应该改变 OnCompletionListener 的值`n=1`并从 OnCompletionListener 出来时，即音乐应该停止播放，这就是我想要的。

我怎样才能解决这个问题 ？

```
 protected void playsound() {
    mp.setOnCompletionListener(new OnCompletionListener() {
        @Override
        public void onCompletion(MediaPlayer mp) {
            if (n<=maxCount) {
                mp.start();
                n++;
                if(n==maxCount){
                    n=1;
                    return;
                }
            }
        }
    });
    mp.start(); 
```

maxCount 值取决于 Spinner 值并`n=1`在全局范围内声明。

下面是它完美运行的更正代码，下面的代码有什么错误吗？因为一些用户说“使用此代码，您将面临错过退出条件的危险，因为如果您输入时 n == maxCount，则在您 n++ 之后 n > maxCount。简而言之，它会一直运行直到您达到 maxint，然后它会崩溃”？

```
protected void playsound() {
    // TODO Auto-generated method stub
    mp.setOnCompletionListener(new OnCompletionListener() {
        @Override
        public void onCompletion(MediaPlayer mp) {
            if (n<=maxCount) {
                mp.start();
                n++;
                if(n==maxCount){
                    n=1;
                    mp.pause();
                    mp.seekTo(0);

                }
            }
        }
    });
    mp.start();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:18:00.367

我认为您需要`mp.start()`在内部 if 之后放置。由于您每次都开始播放音乐，它总是会回到`onCompletion`，即使在播放 maxCount 之后也可以再次开始播放，因为您正在设置`n=1;`

```
 public void onCompletion(MediaPlayer mp) {
        if (n < maxCount) {
            n++;
            if(n == maxCount){
                n = 1;
                return;
            }
            mp.start();
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:16:57.537

问题是你在哪里运行`mp.start()`。将其移至 else ，如下所示：

```
if (n<maxCount) {
    n++;
    if(n==maxCount){
        // Don't play the sound anymore.
        n=1;
        return;
    } else {
        // Continue playing the sound.
        mp.start();
    }
} 
```

您遇到的问题是您检查了`if(n==maxCount)`，但是您以任何一种方式播放声音，然后您将 n 重置为 1 以便它继续播放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T18:08:13.423

**编辑：**

你不能用`mp.start();`你需要的音乐来`mp.stop()`代替

* * *

你正在检查 `if (n<maxCount) {`

在您正在检查的相同条件下`n==maxCount`，世界上的值如何小于等于该数字的数字，即`n==maxCount`永远不会满足，因此您需要像这样更改条件

```
if(n<=maxCount) 
```

> 下面的代码不会破坏方法或循环，而是永远循环音乐

是的，因为您的 return 语句永远不会满足 n==maxCount

# prettyfaces - @URLMappings 注释，该操作将用于每个映射

> ID：15621689
> 
> 赞同：0
> 
> 时间：2013-03-25T18:05:32.540
> 
> 标签：prettyfaces

你好，我在 java 类中有两个 URL 映射，一个是调用超链接，另一个是按钮

在我打电话的超链接上

```
@URLAction(mappingId="abc")
//method..
private String hello(){
return null;
} 
```

在我打电话的按钮上

```
@URLAction(mappingId="def")
//method..
private String hi(){
return null;
} 
```

我第一次在超链接上调用 hello() 它工作正常，但是当我在按钮上调用 hi() 时它也工作正常但是 hello() 也被调用

如在 OCPSOFT 中，如果带注释的方法所属的类使用 @URLMappings 注释声明了多个 URL 映射，则该操作将用于每个映射。 [http://ocpsoft.org/docs/prettyfaces/3.3.3/en-US/html/Configuration.html](http://ocpsoft.org/docs/prettyfaces/3.3.3/en-US/html/Configuration.html)

我的问题是我想在每个 urlmapping id 上调用一个方法有什么想法吗？提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T13:55:18.363

如果您通过单击类似的东西提交 JSF 表单`<h:commandButton>`，JSF 将始终执行回发，这意味着请求将返回到原始页面。这就是第二次执行您的方法的原因。如果您不希望这样，您可以配置 PrettyFaces 以跳过回发的页面操作方法调用：

```
@URLAction(mappingId="abc", onPostback=false)
private String hello(){
    return null;
} 
```

# python - 数据类型错误

> ID：15621691
> 
> 赞同：1
> 
> 时间：2013-03-25T18:05:36.253
> 
> 标签：python, types, numpy, python-imaging-library

当我运行此代码时，我得到输出：

```
TypeError: an integer is required 
```

我不知道为什么会这样，因为我将这两种数据类型分别设置为 uint8 和 uint64。显然我不太了解数据类型。

```
from PIL import Image

from numpy import random

N = 100

##open an image
im=Image.open('/Users/grahamwarner/Desktop/Experiment/gwarner/labeled_photos/masks/003030.png')

##create a random image
rand_matrix = random.randint(0, 255, (500, 500, 3)).astype('uint8')

rand_image = Image.fromarray(rand_matrix)

##select N random pixels
rand_pix = random.randint(0,499, (N,2)).astype('uint64')

##replace the random values at these pixels with the original values
for ii in range(N):

  rand_image.putpixel(tuple(rand_pix[ii,:]), im.getpixel(tuple(rand_pix[ii,:]))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:36:36.447

PIL 中的`getpixel`方法似乎对其输入非常挑剔，特别想要一个`int`s 的元组（与 Numpy 的`uint64`类型不同）。以下对我有用：

```
for ii in range(N):
    coordinate = tuple(map(int, rand_pix[ii,:]))
    rand_image.putpixel(coordinate, im.getpixel(coordinate)) 
```

# c# - 按钮字体重量不起作用

> ID：15621695
> 
> 赞同：3
> 
> 时间：2013-03-25T18:05:47.210
> 
> 标签：c#, xaml, fonts, windows-phone-7.1

我尝试设置 Button 的 fontWeight 但字体粗细仍然相同。

我的按钮

```
<Button x:Name="MyButton"
    Grid.Row="3"
    FontWeight="Bold"
    Content="something"
    Padding="16,10,12,12"
    FontSize="24"
    Background="White"
    Foreground="#400000"
    HorizontalContentAlignment="Left" /> 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:11:10.297

要设置`FontWeight`你必须实际设置 FontWeight。
请参阅下面我将此属性添加到您的代码并将其设置为“Thin”的位置：

对于 WP7.x，任何页面级别的样式都会显式覆盖您正在执行的操作，因此您需要做更多的工作：

```
 <Button x:Name="MyButton"
            Grid.Row="3"
            Padding="16,10,12,12"
            FontSize="24"
            Background="White"
            HorizontalContentAlignment="Left" >
            <TextBlock Text="something"
                       Style="{StaticResource PhoneTextNormalStyle}" 
                       Foreground="#400000"
                       FontWeight="Thin" />
        </Button> 
```

请注意，我必须为内容设置样式，然后应用一个 FontWeight，它将覆盖样式中的内容。

这个（更简单的版本）适用于 WP8

```
 <Button x:Name="MyButton"
                FontWeight="Thin"
                Grid.Row="3"
                Content="something"
                Padding="16,10,12,12"
                FontSize="24"
                Background="White"
                Foreground="#400000"
                HorizontalContentAlignment="Left" /> 
```

# sql - 究竟是什么让这两个 getdate() 不同

> ID：15621697
> 
> 赞同：0
> 
> 时间：2013-03-25T18:05:55.047
> 
> 标签：sql

```
 dateadd(D, 1, getdate()), dateadd(Y, 1, getdate()) 
```

这两者有什么区别？谁能解释为什么他们给出相同的结果？

我试图让培训完成日期应该大于或等于一年。此外，我需要根据培训完成日期找出未来 30 天内谁会来加入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:33:25.783

这个[SQL Fiddle](http://sqlfiddle.com/#!6/97730/5)演示了两者之间的区别。

例如，使用当前日期 ( `GETDATE()`) 作为数据库中的日期，我们有一个可能看起来像...的表

```
id    date
1     March, 25 2013 18:20:29+0000
... 
```

第一个参数是`datepart`. 这可以是`year (yy,yyyy)`, `quarter (qq,q)`,`dayofyear (dy,y)`等...整个列表可以在[msdn](http://msdn.microsoft.com/en-us/library/ms174420.aspx)中找到。

我们使用 D 表示日期...这将在日期上增加 1 天。 `SELECT dateadd(D,1,getdate()) FROM test;`将返回`March, 26 2013 18:24:27+0000`。

虽然你可能认为 Y 会被使用一年，但你错了。Y 用于*一年中的某一天*。我们必须使用`YY`或`YYYY`一年才能添加。

`SELECT dateadd(Y,1,getdate()) FROM test;`将导致`March, 26 2013 18:24:27+0000`，这与我们之前的查询相同。这是因为一年中的日子与日子相同。

`SELECT dateadd(YY,1,getdate()) FROM test;`将输出预期的`getdate()`+ `1 year`... ( `March, 25 2014 18:31:27+0000`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:12:58.110

对于第二个“y”获取一年中的日期，并不是说添加一年。所以他们俩都在说同样的话。第一个说在当天添加一天，第二个说在今年的当天添加一天。要添加一年，您需要说 dateadd(YY, 1, getdate())。

[http://msdn.microsoft.com/en-us/library/ms186819.aspx](http://msdn.microsoft.com/en-us/library/ms186819.aspx)

我不遵循您关于您要做什么的最后陈述。但是，如果您使用上面链接中定义的日期部分，您应该能够添加您需要的天数/月数/年数。

# jsf - JSF 2.0 (IceFaces 3.2) ApplicationScoped bean、共享数据和 PUSH

> ID：15621705
> 
> 赞同：0
> 
> 时间：2013-03-25T18:06:29.983
> 
> 标签：jsf, icefaces, icefaces-3, icepush

我在共享数据和推送方面遇到了一点问题。

我有一个包含三行的表格；这些行根据所选的参考日期而有所不同（每个用户可以选择不同的参考日期，因此它在会话范围内），例如，假设我有：

*   [{1, 'a', "active"}, {2, 'b', "active"}, {3, 'c', "inactive"}] 参考日期为 2013 年 2 月 10 日和
*   [{4, 'a', "inactive"}, {5, 'b', "active"}, {6, 'c', "inactive"}] 参考日期为 2013 年 3 月 13 日。

对象是 {ID, LABEL, STATUS} 类型的三元组。

这些行应该在观看相同参考日期的用户之间共享，例如用户 U1 和 U2 正在观看参考日期为 10-Feb-13 的表格。理想情况下，当 U1 将行 {1, 'a', "active"} 更改为 "inactive" 时，修改会通过推送通知（实际上是 IcePush）传播给也看到它的用户 U2。到目前为止，一切都很好。

当更多用户观看不同的参考日期时会出现我的问题，因为我必须过滤掉不在用户特定参考日期中的行并尝试“释放”不需要的行，因为 bean 是应用程序范围的。

我们最初认为我们可以统计观看特定参考日期的用户，但这就像参考计数垃圾收集一样，我不愿意深入研究，所以我问你，你会怎么做？

顺便说一句，我们认为它应该以这种方式工作，因为我们阅读[了本](http://www.icesoft.org/wiki/display/ICE/Easy+Ajax+Push)教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T19:08:42.183

不能按用户修改应用程序范围 bean 中的共享数据。使用会话范围的 bean。

# c# - 单击红色X时让应用程序停止C#

> ID：15621707
> 
> 赞同：2
> 
> 时间：2013-03-25T18:06:32.497
> 
> 标签：c#

所以我的程序有多种形式，我需要一种方法让某人单击 X 并结束程序。我发现 Environment.exit(0) 有效，除了当我完成表格并关闭以继续下一个时，程序结束。所以我需要在单击关闭按钮时进行特定调用，以便我可以将关闭代码放在那里。或等效的建议，以便可以从任何屏幕结束程序。作为 C# 的新手，我目前正在使用 ShowDialog() 来规范每个表单的输入。

```
protected override void OnFormClosing(FormClosingEventArgs e)
{
    Environment.Exit(0);
} 
```

这是我目前的方法，但只要表单关闭就会激活，因此不是我需要的。这是在 Windows 窗体中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:09:06.413

```
Application.Exit(); 
```

它将关闭与您的应用程序相关的所有正在运行的进程。并使用

```
this.close(); 
```

关闭您当前活动的表单。您可以在按钮单击事件中调用这些方法。

在您的情况下，我建议您使用`bool`类型变量`flag`。创建一个类型的全局变量`bool`并命名它`flag`，当您处于可以关闭整个应用程序的特定部分时，请设置`flag = true`，当您不在该条件时，将其设置为`false`. 现在在您的表单关闭事件中，使用以下代码：

```
protected override void OnFormClosing(FormClosingEventArgs e)
{
    if(flag == true)
         Environment.Exit(0);
} 
```

# c# - 选择一个 Sp 语音字符

> ID：15621708
> 
> 赞同：1
> 
> 时间：2013-03-25T18:06:35.853
> 
> 标签：c#, voice, speech, synthesizer

我正在使用 SpeechLib 命名空间来合成两种声音。我下载了两种说话人的声音，一种是西班牙语的（Hilda），一种是中文的（han-han）。问题是我不知道如何选择要说话的人。例如，

```
private SpVoice spanishSpeaker = new SpVoice();
private SpVoice chineseSpeaker = new SpVoice(); 
```

程序总是使用第一个下载的声音初始化变量。我想知道如何更改、选择、选择用于任何合成器声音的声音。

参考： [http ://www.microsoft.com/en-us/download/details.aspx?id=27224](http://www.microsoft.com/en-us/download/details.aspx?id=27224)

# html - 如何在不扩展表格单元格高度的情况下使表格单元格的内容垂直溢出？

> ID：15621712
> 
> 赞同：12
> 
> 时间：2013-03-25T18:06:47.500
> 
> 标签：html, css, html-table

我有一个带有`div`内部的表格单元格。我希望`div`溢出到表格单元格之外。我怎样才能做到这一点？需要明确的是，我不希望表格单元格使用`div`. 下面的代码是我尝试过的，但它不起作用。

HTML：

```
<table>
    <tr class="row">
        <td class="cell">
            <div class="overflow">Overlow outside of this cell</div>
        </td>
    </tr>
</table> 
```

CSS：

```
.row {
    height:24px;
    overflow:visible;
}
.cell {
    overflow:visible;
    max-height:24px !important;
}
.overflow {
    height:24px;
    font-size:12px;
    clear:both;
    white-space: nowrap;
    line-height:16px;
    zoom:1;
    text-align:left;
    overflow:hidden;
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-25T18:18:39.277

如果我说对了，[这](http://jsfiddle.net/7zps4/)可能会有所帮助：

```
.row {
  height: 24px;
  overflow: visible;
}

.cell {
  overflow: visible;
  max-height: 24px !important;
  border: 1px solid #cccccc;
  width: 10px;
}

.overflow {
  height: 24px;
  font-size: 12px;
  line-height: 16px;
  position: absolute;
}
```

```
<table>
  <tr class="row">
    <td class="cell">
      <div class="overflow">Overlow outside of this cell</div>
    </td>
  </tr>
</table>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-22T06:44:26.550

```
.overflow {
    height: 100px;
    width: 100px !important;
    overflow-y: scroll;
} 
```

# sql-server-2005-express - 连接到 SQL Server 数据库时出错：不受信任的连接

> ID：15621714
> 
> 赞同：0
> 
> 时间：2013-03-25T18:06:54.713
> 
> 标签：sql-server-2005-express, trustedconnection

我们在一家公司的服务器上安装了 SQL Server 2005 express。一些工作站在使用我们的带有 Windows 身份验证的应用程序时连接到服务器。

但是有一台计算机无法连接。当用户打开任何应用程序时，它会在几秒钟后显示下一个错误：

![错误](../Images/c880af0cabde5fa06723df0be770d317.png)

这台计算机与其他计算机位于同一个工作组中（没有域，只有一个工作组），并且连接字符串与其他计算机相同（所有快捷方式都指向服务器上的同一可执行文件）。

有什么提示吗？谢谢

# google-app-engine - 按 Ref 对象化过滤器

> ID：15621716
> 
> 赞同：9
> 
> 时间：2013-03-25T18:07:00.910
> 
> 标签：google-app-engine, objectify

我与 Objectify 有 mn 关系，我想获得关系的一方。

我试图用这个查询来解决它：

```
 Query query = ofy().load().type(Person.class);
        query.filter("position", ceo);
        return query.list(); 
```

返回 CEO 列表。Position 是一个 Ref<Position>。

我努力了：

```
query.filter("position", Ref.create(ceo));
query.filter("position", Key.create(ceo));
query.filter("position", ceo.key); 
```

但是没有，有谁知道如何做到这一点？

* * *

编辑：这是一个索引问题。对不起！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-25T20:25:57.130

```
query = query.filter("position", ceo); 
```

所有 Objectify 命令对象都是不可变的。

# java - 为什么我重新运行程序时服务会崩溃？

> ID：15621717
> 
> 赞同：0
> 
> 时间：2013-03-25T18:07:07.213
> 
> 标签：java, android, service

我现在开始编写服务例程，每次重新运行代码时都会收到一条错误消息，而无需更改任何内容。

这是服务例程：

公共类 PollingService 扩展服务{

```
private static final String TAG = PollingService.class.getSimpleName();

private Polling updater;

public boolean isRunning = false;

@Override
public IBinder onBind(Intent intent) {
    return null;
}

@Override
public void onCreate() {
    super.onCreate();
    updater = new Polling();
    Log.d(TAG, "On Create'd");
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    // Start the Polling updater
    if(!this.isRunning){
        updater.start();
        this.isRunning = true;
    }
    Log.d(TAG, "On Start'd");
    return super.onStartCommand(intent, flags, startId);
}

@Override
public synchronized void onDestroy() {
    super.onDestroy();
    // Stop the Polling updater
    if(this.isRunning){
        updater.interrupt();
    }
    Log.d(TAG, "On Destroy'd");
}

// Polling Thread
class Polling extends Thread {
    static final long DELAY = 3000;

    @Override
    public void run() {
        while (isRunning) {
            try {
                // Do something
                Log.d(TAG, "Polling run'ing");
                // Sleep
                Thread.sleep(DELAY);
            } catch (InterruptedException e) {
                // Interrupted
                isRunning = false;
            }
        }
    }

} 
```

}

当我运行应用程序时，我在 LogCat 中看到“On Create'd”和“On Start'd”以及“Polling run'ing”，但是，我重新运行程序以查看我是否仅获得“On Start'd”在 LogCat 中。但是我得到了这个错误：

ActivityManager: 开始: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.project.keegan/.StartApp } ActivityManager: 警告: Activity 未启动，其当前任务已完成带到了最前面

当我检查 LogCat 时，它仍然显示“正在轮询”。所以我进入了模拟器：菜单->应用程序管理器->我停止了服务。

当我重新运行程序时，我遇到了同样的两个错误，我的应用程序启动了，但服务没有启动。但有趣的是，每当我对代码进行任何更改（例如，如果我只是按空格键然后退格键）并单击“保存”，然后重新运行程序，服务就会再次运行。

这是我调用它的类：

公共类 StartApp 扩展 Activity 实现 View.OnClickListener{

```
TextView disp_hello;
Button but_go2send, but_go2request;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.start_app);
    Vars();
    startService(new Intent(this, PollingService.class));
    but_go2send.setOnClickListener(this);
    but_go2request.setOnClickListener(this);
} 
```

. . . }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:35:38.253

您的问题与您的代码无关。Eclipse 足够聪明，可以检测到您没有更改任何代码，它会跳过替换设备上的应用程序。

而不是重新启动应用程序（这将涉及杀死它），它只是将它带回前面。

如果要重新启动它，则需要存在/终止该应用程序或像以前一样执行并插入空格。

# jquery - jQuery动态文本框问题

> ID：15621738
> 
> 赞同：0
> 
> 时间：2013-03-25T18:08:10.177
> 
> 标签：jquery

我一直在尝试在我的网页上动态生成文本框。我使用我找到的一个示例让它工作，但是我在添加到每一行的“删除”按钮时遇到了问题。

Firebug 在最后一行给了我一个语法错误，但我不知道它为什么抱怨。

这是jQuery函数：

```
$(document).on('ready', function () {

    var counter = 2;

    $("#addButton").click(function () {
        if(counter>10){
            alert("Only 10 learning objectives allowed per page.");
            return false;
        }   

        var newTextBoxDiv = $(document.createElement('div'))
             .attr("id", 'TextBoxDiv' + counter);
        newTextBoxDiv.after().html('<label>Page Objective ' + counter + ' : </label>' +
            '<input type="text" name="tbObjective' + counter +
            '" id="tbObjective' + counter + '" value="" >' +
            '<input type="button" value="Remove Objective" class="removeObjective">').click(function() {
                alert('fired');
                $(this).remove();
            });
    });
        newTextBoxDiv.appendTo("#TextBoxesGroup");
        counter++;
    });

    $("#removeButton").click(function () {
        alert('fired');
        if(counter==1){
            alert("No more textbox to remove");
            return false;
        }   
        counter--;
        $("#TextBoxDiv" + counter).remove();
    });

    $(".removeObjective").click(function () {
        alert('fired');
        var $id = $(this);
        $($id).remove();
    });

});   //Firebug is showing a syntax error here? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:11:55.420

第 20 行有一个额外的集合，`]);`它提前关闭了包含就绪的回调。

这段代码现在在语法上是正确的：

```
$(document).on('ready', function () {

    var counter = 2;

    $("#addButton").click(function () {
        if(counter>10){
            alert("Only 10 learning objectives allowed per page.");
            return false;
        }   

        var newTextBoxDiv = $(document.createElement('div'))
             .attr("id", 'TextBoxDiv' + counter);
        newTextBoxDiv.after().html('<label>Page Objective ' + counter + ' : </label>' +
            '<input type="text" name="tbObjective' + counter +
            '" id="tbObjective' + counter + '" value="" >' +
            '<input type="button" value="Remove Objective" class="removeObjective">').click(function() {
                alert('fired');
                $(this).remove();
            });
        newTextBoxDiv.appendTo("#TextBoxesGroup");
        counter++;
    });

    $("#removeButton").click(function () {
        alert('fired');
        if(counter==1){
            alert("No more textbox to remove");
            return false;
        }   
        counter--;
        $("#TextBoxDiv" + counter).remove();
    });

    $(".removeObjective").click(function () {
        alert('fired');
        var $id = $(this);
        $($id).remove();
    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:12:40.500

如果计数器的全部目的是为文本框提供唯一的 ID，则不需要递减它。实际上我认为减少它会导致问题。

代替

```
($this).remove 
```

利用

```
$('#TextBoxDiv' + counter).remove(); 
```

# shell - 在时间条件下在脚本中运行命令

> ID：15621743
> 
> 赞同：0
> 
> 时间：2013-03-25T18:08:19.160
> 
> 标签：shell

我想在脚本中运行某些命令。就像是：

```
if(today is monday){
  do something;
} 
```

有没有办法在 shell 脚本中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:23:46.410

如果您使用的是 POSIX 兼容的 shell：

```
if [ "$(date +%A)" = "Monday" ]; then
    echo "something"
fi 
```

*+%A*将返回当天的全名。看

```
date --help 
```

更多格式选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:22:25.037

假设一个 bash 脚本：

```
#!/bin/bash

# Use the date command to get the numerical representation of the week 
# (or whatever format you are looking for)
check=$(date +%u)

if [ "$check" == 1 ]; then
    # Monday
    # Do something
elif [ "$check" == 2 ]; then
    # Monday
    # Do something
...
elif [ "$check" == 7 ]; then
    # Sunday
    # Do something
fi 
```

*编辑 - 添加 bin/bash 以确保完整性*

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-25T18:12:48.160

如果使用 Windows，您可以使用它来安排特定日期/时间的进程：

```
schtasks 
```

[http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/schtasks.mspx?mfr=true](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/schtasks.mspx?mfr=true)

如果您只想查看日期，前 3 个字符`%DATE%`是星期几

# nginx - nginx 高级重写

> ID：15621753
> 
> 赞同：0
> 
> 时间：2013-03-25T18:08:28.810
> 
> 标签：nginx, rewrite

我正在尝试在 nginx 中创建一个我似乎无法正常工作的重写...

我正在尝试做的事情：

改写：
`bleh.com/productPage/productname/?action=yes&id=12`

至：
`bleh.com/productPage/index.php?product=productname&action=yes&id=12`

到目前为止，我得到的最接近的是：

```
location / {
rewrite ^/productPage/(.*)/(.*)$ /productPage/index.php?$1 last;
}
location ~ \.php$ {
fastcgi_index ... (and the rest of the working fastcgi config) 
```

但是，我只打 404 的..

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:52:26.353

尝试：

```
location /productPage/ {
  rewrite ^/productPage/(.*)/$ /productPage/index.php?product=$1 index.php last;
} 
```

注意：[重写指令](http://nginx.org/en/docs/http/ngx_http_rewrite_module.html#rewrite)匹配不包含参数[的 $uri 变量](http://wiki.nginx.org/HttpCoreModule#.24uri)上的正则表达式，参数将自动附加到重写的 url，除非您以`?`

# vb.net - 导入 txt 文件并操作字符串进行计算？

> ID：15621756
> 
> 赞同：0
> 
> 时间：2013-03-25T18:08:31.870
> 
> 标签：vb.net, visual-studio-2010, .net-4.0

在 VB2010 中，我需要处理一个包含多行的文本文件，如下所示：

```
学生姓名, 65, 42, 71, 55
学生姓名 2、40、42、54、45
等等
```

我需要处理文件，发现：

1.  每个用户收到的年终总成绩和等级
2.  得最高分的学生
3.  平均总分
4.  达到用户可以指定的特定成绩的学生列表。

等级：70% - 100% = D，60% - 70% = P1，50% - 60% = P2，40% - 50% = P3，0% - 39% = F

我正在尝试将数据结构放入公共类

```
Structure Student
    Dim name as String
    Dim Paper1 as String
    Dim Paper2 as String
    Dim Paper3 as String
    DIm Paper4 as String.
End Structure

'I am also trying to to do an array
Dim Students() as Student

'Open txt File

Dim FileStreamReader As IO.StreamReader
FileStreamReader = IO.File.OpenText("c:/textfile.txt") 
```

一次读取一行文件

```
While not fileStreamReader.EndofStream
    Dim linein as String
    linein = FileStreamReader.readline() 
```

我有两个主要问题：

1.  我在正确的轨道上吗？如果是这样，
2.  有什么想法可以从 txt 文件中处理信息吗？我已经尝试了好几天，但我不断收到错误！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T21:33:40.057

您应该使用专用的 csv 解析器来解析文件中的行。不要使用正则表达式。不要使用 String.Split()。不要尝试自己编写。您可以使用 Microsoft.VisualBasic.TextFieldParser 类。

您不应该使用具有可更改字段的结构。将其设为类而不是结构，或将所有字段设为只读（无公共 Set 选项）并且仅更改构造函数中的字段。

# c - 生成随机字节流

> ID：15621764
> 
> 赞同：12
> 
> 时间：2013-03-25T18:09:06.503
> 
> 标签：c

我正在测试一个使用 UDP/TCP 将数据包发送到远程服务器的网络程序，为此，我想生成一些随机字节流。

这是功能：

```
unsigned char *gen_rdm_bytestream(int num_bytes)
{
    unsigned char *stream = malloc(num_bytes);
    /*
     * here how to generate?
     */
    return stream;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T18:16:09.690

对于每个字节，您可以调用一个随机数生成器函数。C 标准提供了函数`rand`。在使用它之前，您应该通过调用来初始化随机序列`srand`。

`gen_rdm_bytestream`然后可能看起来像这样：

```
#include <stdlib.h>
#include <time.h>

unsigned char *gen_rdm_bytestream (size_t num_bytes)
{
  unsigned char *stream = malloc (num_bytes);
  size_t i;

  for (i = 0; i < num_bytes; i++)
  {
    stream[i] = rand ();
  }

  return stream;
}

srand ((unsigned int) time (NULL)); 
```

由于`stream`是无符号的，如果返回的值`rand`大于`UCHAR_MAX`，她将被减少（模`UCHAR_MAX`）。因此，您将获得 0 到 255 之间的伪随机数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T18:13:46.490

是的，你[`int rand (void);`](http://www.cplusplus.com/reference/cstdlib/rand/?kw=rand)在 C 中有函数，

> 返回介于 0 和 RAND_MAX 之间的伪随机整数。RAND_MAX 是 <cstdlib> 中定义的常数。

> 这个数字是由一种算法生成的，每次调用它时都会返回一系列明显不相关的数字。该算法使用种子生成系列，应使用函数[srand() 将其初始化为某个独特的值。](http://www.cplusplus.com/reference/cstdlib/srand/)

**编辑**：

正如您评论的那样，我为您编写了一个代码，可以帮助您演示如何使用 rand()，该程序及其输出是：

```
#include <stdio.h>     
#include <stdlib.h>  /* srand, rand */
#include <time.h>    
int main (){
 int i=0;
 srand (time(NULL));
 printf("Five rand numbers: \n");
 for(i = 1; i <= 5; i++){
   printf("\n %d", rand());
 }
 printf("Five rand numbersb between 2 to 5: \n");
 for(i = 1; i <= 5; i++){
   printf("\n %d", (2 + rand()%4));
 }    
 return 1;
} 
```

输出：

```
 Five rand numbers: 

 1482376850
 1746468296
 1429725746
 595545676
 1544987577

 Five rand numbers, between 2 to 5: 

 2
 5
 3
 4
 3 
```

[**键盘链接**](http://codepad.org/9pRLCgt2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T19:08:42.623

这是在给定范围内生成随机整数值的通用函数：

```
#include <stdlib>

/**
 * Assumes srand has already been called
 */
int randInRange( int min, int max )
{
  double scale = 1.0 / (RAND_MAX + 1);
  double range = max - min + 1;
  return min + (int) ( rand() * scale * range );
} 
```

利用它来创建无符号`char`值：

```
u_char randomByte()
{
  return (u_char) randInRange( 0, 255 );
} 
```

所以，

```
for ( i = 0; i < numBytes; i++ )
  stream[i] = randomByte(); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-05-08T00:11:30.150

以下是一个实际流 (std::istream) 并使用 C++11 <random> 库。

这并不是写得特别快，但它很有趣：

```
#include <iostream>
#include <string>
#include <array>
#include <algorithm>
#include <random>

class RandomBuf : public std::streambuf
{
 private:
  size_t m_size;
  std::array<char, 64> m_buf;
  std::mt19937_64 m_twister;
  std::uniform_int_distribution<char> m_dist;

 protected:
  int_type underflow() override {
    if (m_size == 0)
      return EOF;

    size_t size = std::min(m_size, m_buf.size());
    setg(&m_buf[0], &m_buf[0], &m_buf[size]);
    for (size_t i = 0; i < size; ++i)
      m_buf[i] = m_dist(m_twister);
    m_size -= size;
    return 0;
  }

 public:
  RandomBuf(size_t size, char b, char e) : m_size(size), m_dist(b, e) { }
};

class Random : public std::istream
{
  private:
   RandomBuf m_streambuf;

  public:
   Random(size_t size, char b, char e) : m_streambuf(size, b, e)  {
     rdbuf(&m_streambuf);
   }
};

// Example usage:

int main()
{
  Random random(100, 'a', 'z'); // Create an istream that produces 100 pseudo-random characters in the interval ['a', 'z'].
  // Read random stream to a string:
  std::string str;
  random >> str;
  // Print result.
  std::cout << str << std::endl;
} 
```

该程序的输出（确切地说，因为标准保证默认构造的 Mersenne twister 具有给定的种子）：

ugsyakganihodonwmktggixegfszuclgupylingbnscxadzqhjmhhyqtssbmctlpchqfflzfwhvjywmajtnkaxczrmtpnlvwmzxd

编辑：

对于额外的奖励积分，我添加了一个 StreamHasher 类： [https ://wandbox.org/permlink/bIDCVTnJjkdafARo](https://wandbox.org/permlink/bIDCVTnJjkdafARo)

只是添加的类：

```
class StreamHasherBuf : public std::streambuf
{
 private:
  size_t m_hash;
  std::array<char, 64> m_buf;   // The resulting hash value is a function of the size of the array!
  static constexpr size_t bufsize = std::tuple_size_v<decltype(m_buf)>;

  void add_and_reset_put_area()
  {
    boost::hash_combine(m_hash, boost::hash_range(pbase(), pptr()));
    setp(&m_buf[0], &m_buf[bufsize]);
  }

 protected:
  int_type overflow(int_type c) override
  {
    if (c != EOF)
    {
      if (pptr() == epptr())
        add_and_reset_put_area();
      *pptr() = c;
      pbump(1);
    }
    return 0;
  }

 public:
  StreamHasherBuf() : m_hash(0) { setp(&m_buf[0], &m_buf[bufsize]); }

  size_t hash()
  {
    add_and_reset_put_area();
    return m_hash;
  }
};

class StreamHasher : public std::ostream
{
 private:
  StreamHasherBuf m_streambuf;

 public:
  StreamHasher() { rdbuf(&m_streambuf); }
  size_t hash() { return m_streambuf.hash(); }
}; 
```

例如

```
int main()
{
  RandomBuf random(100, 'a', 'z'); // Create a streambuf that produces 100 pseudo-random characters in the interval ['a', 'z'].
  StreamHasher hasher;
  hasher << &random;
  std::cout << hasher.hash() << '\n';
} 
```

# jquery - 根据选择的单选按钮列表输入隐藏和显示多个区域

> ID：15621768
> 
> 赞同：0
> 
> 时间：2013-03-25T18:09:23.367
> 
> 标签：jquery, asp.net, html

我之前有一个类似的问题，但我不得不修改它，因为用户改变了主意。我正在编写一个脚本，如果选择了选项 0，它应该显示“提醒”，否则将其隐藏。如果选择了选项 2，则应取消隐藏“cc”，否则将其隐藏。我的问题是，无论选项 0 还是 2，一旦触发事件，两个区域都会打开。我只是想知道我是否能得到一些帮助让他们分开工作。这是JS：

```
 $('#rbPType').change(function () {
 var op1 = $(this).attr('value', '0');
 var op2 = $(this).attr('value', '2');

 if (op1) {
    $('#remind').fadeIn();
 } else {
    $('#remind').fadeOut();
 }

 $(this).change(function () {
     $('#remind').toggle();
 });

 if (op2) {
     $('#cc').fadeIn();
 } else {
     $('#cc').fadeOut();
 }

 $(this).change(function () {
     $('#cc').toggle();
 });

 }); 
```

HTML

```
<div class="another">
<label for="rbPType">Select One</label>
<asp:RadioButtonList runat="server" ID="rbPType" ClientIDMode="Static">
    <asp:ListItem Value="0" Text="1"></asp:ListItem>
    <asp:ListItem Value="1" Text="2"></asp:ListItem>
    <asp:ListItem Value="2" Text="3"></asp:ListItem>
</asp:RadioButtonList>
</div>
<div id="remind">
<label for="ddlReminderMonth">Remind Me</label>
<asp:DropDownList runat="server" ID="ddlReminderMonth" AppendDataBoundItems="true" AutoPostBack="false" />
</div>
<div id="cc">
<label for="ddlReminderMonth">Remind Me Two</label>
<asp:DropDownList runat="server" ID="ddlReminderMonth" AppendDataBoundItems="true" AutoPostBack="false" />
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:28:08.863

您不能有两个相同的下拉列表`ddlReminderMonth`。

由于切换，您的控件在单击后出现和消失。Toggle 使您的代码非常混乱。

```
<div class="another">
    <label for="rbPType">
        Select One</label>
    <asp:RadioButtonList runat="server" ID="rbPType" ClientIDMode="Static">
        <asp:ListItem Value="0" Text="1"></asp:ListItem>
        <asp:ListItem Value="1" Text="2"></asp:ListItem>
        <asp:ListItem Value="2" Text="3"></asp:ListItem>
    </asp:RadioButtonList>
</div>
<div id="remind">
    <label for="ddlReminderMonth">
        Remind Me</label>
    <asp:DropDownList runat="server" ID="ddlReminderMonth1" AppendDataBoundItems="true"
        AutoPostBack="false" />
</div>
<div id="cc">
    <label for="ddlReminderMonth">
        Remind Me Two</label>
    <asp:DropDownList runat="server" ID="ddlReminderMonth2" AppendDataBoundItems="true"
        AutoPostBack="false" />
</div>

<script>
    $('#rbPType').change(function () {
        var value = $('#rbPType input:checked').val();

        if (value == '0') {
            $('#remind').fadeIn();
            $('#cc').fadeOut();
        }
        else if (value == '1') {
            // Show or hide
        }
        else { // value == '2'
            $('#remind').fadeOut();
            $('#cc').fadeIn();
        }
    }); 
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:17:48.383

我认为您在这里编写了很多不必要的代码。jquery toggle 采用布尔参数，当为 true 时将显示所选字段，当为 false 时将隐藏它。

```
 $('#rbPType').change(function () {
     var op1 = $(this).attr('value', '0');
     var op2 = $(this).attr('value', '2');
     $('#remind').toggle(op1);
     $('#cc').toggle(op2);
    }); 
```

这是你想要的？

# xml - XSLT：元素排序和计算

> ID：15621769
> 
> 赞同：0
> 
> 时间：2013-03-25T18:09:24.463
> 
> 标签：xml, xslt

对于完全没有使用 XML 的经验，我深表歉意，但解决这个问题将帮助我理解 XSLT 计算的工作原理。

我们有一个结构如下的示例数据库：

```
<HospitalML>
<Patients>
    <Patient>
        <Name>
            <FirstName>Salvatore</FirstName>
            <LastName>Piscuoglio</LastName>
        </Name>
        <Diagnoses>
            <Diagnosis>
                <Name>HCC</Name>
                <Weight>1.2</Weight>
            </Diagnosis>
            <Diagnosis>
                <Name>CRC</Name>
                <Weight>2.2</Weight>
            </Diagnosis>
        </Diagnoses>
    </Patient>
</Patients>
<Hospitals>
    <Hospital>
        <HospitalName>LondonGeneral</HospitalName>
        <Diagnoses>
            <Diagnosis>
                <Name>HCC</Name>
                <Weight>2.1</Weight>
            </Diagnosis>
            <Diagnosis>
                <Name>CRC</Name>
                <Weight>0.2</Weight>
            </Diagnosis>
        </Diagnoses>
    </Hospital>
    <Hospital>
        <HospitalName>EastEnd</HospitalName>
        <Diagnoses>
            <Diagnosis>
                <Name>HCC</Name>
                <Weight>1.7</Weight>
            </Diagnosis>
            <Diagnosis>
                <Name>CRC</Name>
                <Weight>0.7</Weight>
            </Diagnosis>
        </Diagnoses>
    </Hospital>
</Hospitals> 
```

每个患者都有一组诊断，其中“体重”值表明它们的严重程度。每个医院元素都有“诊断”子元素，指示他们管理的疾病和“权重”元素分数，指示他们在每个方面的表现如何。

我想从患者 Salvatore 的数据库中评估医院，并给出一个按分数排名的医院列表，表明他的诊断最好的医院。

将不胜感激任何想法。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T23:20:20.873

这个 xslt ：

```
 <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">

    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/">
        <!-- You could select one specific patient instead of all if you prefer.-->
        <xsl:apply-templates select=".//Patient"/>
    </xsl:template>

    <!-- This template just copy a patient and his name and 'do the job' for all the diagnoses. -->
    <xsl:template match="Patient">
        <xsl:copy>
            <xsl:copy-of select="Name"/>
            <xsl:apply-templates select="Diagnoses/Diagnosis"/>
        </xsl:copy>
    </xsl:template>

    <!-- Here is the template for the patient diagnosis (the predicate is just there to prevent mistakes with diagnosis element child of hospital) -->
    <xsl:template match="Diagnosis[ancestor::Patient]">
        <!-- we store the name and weight inside variables to simplify the xpaths below.
            Actually you may use the current() function, but was'nt sure about its support in XSLT 1.0-->
        <xsl:variable name="name" select="Name"/>
        <xsl:variable name="patientWeight" select="Weight"/>
        <!-- first statement, copy the diagnosis and its name. -->
        <xsl:copy>        
            <xsl:copy-of select="Name"/>
            <!-- then, search for hospitals which got same diagnosis -->
            <xsl:apply-templates select="//Hospital[.//Diagnosis/Name = $name]">
                <!-- sort them by their weight in the current diagnosis. This is the "real job", where you got your hospital 'rank' for a diagnosis.  -->
                <xsl:sort select=".//Diagnosis[Name = $name]/Weight" order="descending"/>
                <!-- use this param to be able to output only the weight of the current diagnosis -->
                <xsl:with-param name="diagnosis" select="$name"/>
                <xsl:with-param name="patientWeight" select="$patientWeight"/> 
            </xsl:apply-templates>
        </xsl:copy>
    </xsl:template>

    <!-- A simple template, that just output the hospital, its name and its weight score (aka : hospital weight * patient weight.  -->
    <xsl:template match="Hospital">
        <xsl:param name="diagnosis"/>
        <xsl:param name="patientWeight"/>
        <xsl:element name="Weight">                   
        <xsl:value-of select="number(.//Diagnosis[Name=$diagnosis]/Weight) * $patientWeight"/>
        </xsl:element>
    </xsl:template>

</xsl:stylesheet> 
```

提供此 xml 输出：

```
<?xml version="1.0" encoding="utf-8"?>
<Patient>
   <Name>

      <FirstName>Salvatore</FirstName>

      <LastName>Piscuoglio</LastName>

   </Name>
   <Diagnosis>
      <Name>HCC</Name>
      <Hospital>
         <HospitalName>LondonGeneral</HospitalName>
         <Weight>2.52</Weight>
      </Hospital>
      <Hospital>
         <HospitalName>EastEnd</HospitalName>
         <Weight>2.04</Weight>
      </Hospital>
   </Diagnosis>
   <Diagnosis>
      <Name>CRC</Name>
      <Hospital>
         <HospitalName>EastEnd</HospitalName>
         <Weight>1.54</Weight>
      </Hospital>
      <Hospital>
         <HospitalName>LondonGeneral</HospitalName>
         <Weight>0.44</Weight>
      </Hospital>
   </Diagnosis>
</Patient> 
```

您可以通过将 xsl:copy 和 xsl:copy-of 调用切换为您的个人输出格式来更改输出格式。

希望这会有所帮助。

# django - Django：尽管 SQL 直接在 MySQL 中工作，但 objects.raw() 无法获取结果

> ID：15621771
> 
> 赞同：2
> 
> 时间：2013-03-25T18:09:32.977
> 
> 标签：django, django-database, django-managers, rawsql

我为 Django 编写了一个函数，它允许用户输入一个单词或短语，并获取指定模型中的所有实例，其中该实例的所有这些单词在一系列指定字段中以任意顺序出现。我选择使用 objects.raw 方法并为此编写自定义 SQL，因为使用 Django Q 对象构建正确的查询存在问题。

```
def fuzzy_search(objmodel,columns,q='',limit=None,offset=0):
    """
        TEMPORARY PATCH version for fuzzy_search, gets around a native Django bug.
    """ 
    if len(q)<3:
        return [] #No results until you reach 3 chars
    words = q.strip().split(" ")
    #Get model table name:
    print "All results: %s" % objmodel.objects.all() 
    db_table = objmodel._meta.db_table
    print("DB_table = %s" % db_table)
    #Construct fields into list of kwarguments!
    sql = "SELECT * FROM %s" % (db_table,)
    userparams = []
    whereands = []
    #Construct the SQL as 
    for word in words:
        if len(word)<2:
            continue #Ignore computationally expensive single char strings
        whereors = []
        for col in columns:
            whereors.append('`%s`.`%s` LIKE "%s##*##"' % (db_table,col,"##P##"))    #STARTSWITH word... The third param will be converted via injection proof means 
            whereors.append('`%s`.`%s` LIKE "(%s##*##"' % (db_table,col,"##P##")) #STARTSWITH (word... The third param will be converted via injection proof means
            whereors.append('`%s`.`%s` LIKE "##*## %s##*##"' % (db_table,col,"##P##"))  #CONTAINS word... The third param will be converted via injection proof means 
            whereors.append('`%s`.`%s` LIKE "##*## (%s##*##"' % (db_table,col,"##P##")) #CONTAINS (word... The third param will be converted via injection proof means
        if whereors not in boolfalse:
            whereorstr= "(" + " OR ".join(whereors) + ")"
            for i in range(0,len(whereors)):
                userparams.append(word) #Need to match the number of supplied params to the number of clauses
            whereands.append(whereorstr)    #Build into an SQL string
        else:
            continue
    #Build the final sql:
    results = []
    if whereands not in boolfalse:
        sql+= " WHERE " + " AND ".join(whereands)
        sql = sql.replace("##P##","%s") #Necessary to get around %s persistence restriction
        sql = sql.replace("##*##","%%") #Makes everything a bit clearer!
        #For big datasets, it is more efficient to apply LIMITS and OFFSETS at SQL level:
        if limit:
            sql+= " LIMIT %s" % int(limit)  #This is injection proof as only ints are accepted
        if offset:
            sql+= " OFFSET %s" % int(offset)    #This is injection proof as only ints are accepted  
        #Perform the raw query, but with params carefully passed in via SQLi escaped method:
        ### objects.raw method ###
        resultsqset = objmodel.objects.raw(sql,userparams)
        print("Fuzzy SQL: \n%s\n" % resultsqset.query.__str__())    #View SQL
        results = list(resultsqset)
        print("Results: %s" % results)
        ### direct cursor method ###
        #cursor = connection.cursor()
        #cursor.execute(sql,userparams)
        #results = dictfetchall(cursor) #Ensures the results are fetched as a dict of fieldname => value
        return results
    return results 
```

这个函数是这样调用的：

```
from modules.documents.models import Data_icd10_en
results = fuzzy_search(Data_icd10_en,["code","long_label"],"diab mel",30) 
```

型号为：

```
class Data_icd10_en(models.Model):
    code = models.CharField(max_length=10)
    short_label = models.CharField(max_length=100)
    long_label = models.CharField(max_length=100) 
```

当我调用该函数时，我可以在控制台中看到实际的 SQL 转储：

```
print("Fuzzy SQL: \n%s\n" % resultsqset.query.__str__())    #View SQL
Fuzzy SQL: 
<RawQuery: u'SELECT * FROM documents_data_icd10_en WHERE (`documents_data_icd10_en`.`code` LIKE "diabetes%" OR `documents_data_icd10_en`.`code` LIKE "(diabetes%" OR `documents_data_icd10_en`.`code` LIKE "% diabetes%" OR `documents_data_icd10_en`.`code` LIKE "% (diabetes%" OR `documents_data_icd10_en`.`long_label` LIKE "diabetes%" OR `documents_data_icd10_en`.`long_label` LIKE "(diabetes%" OR `documents_data_icd10_en`.`long_label` LIKE "% diabetes%" OR `documents_data_icd10_en`.`long_label` LIKE "% (diabetes%") AND (`documents_data_icd10_en`.`code` LIKE "mell%" OR `documents_data_icd10_en`.`code` LIKE "(mell%" OR `documents_data_icd10_en`.`code` LIKE "% mell%" OR `documents_data_icd10_en`.`code` LIKE "% (mell%" OR `documents_data_icd10_en`.`long_label` LIKE "mell%" OR `documents_data_icd10_en`.`long_label` LIKE "(mell%" OR `documents_data_icd10_en`.`long_label` LIKE "% mell%" OR `documents_data_icd10_en`.`long_label` LIKE "% (mell%") LIMIT 30'> 
```

如果我将此 SQL 直接复制并粘贴到数据库后端 (MySQL) 中，则会返回正确的结果（诊断“糖尿病”的 30 行变体）。但是，python 函数本身无法返回任何内容（结果只是一个空列表）。我试过 print(resultsqset)，这只是揭示了这个 RawQuerySet：

```
Results: <RawQuerySet: u'SELECT * FROM documents_data_icd10_en WHERE (`documents_data_icd10_en`.`code` LIKE "diab%" OR `documents_data_icd10_en`.`code` LIKE "(diab%" OR `documents_data_icd10_en`.`code` LIKE "% diab%" OR `documents_data_icd10_en`.`code` LIKE "% (diab%" OR `documents_data_icd10_en`.`long_label` LIKE "diab%" OR `documents_data_icd10_en`.`long_label` LIKE "(diab%" OR `documents_data_icd10_en`.`long_label` LIKE "% diab%" OR `documents_data_icd10_en`.`long_label` LIKE "% (diab%") AND (`documents_data_icd10_en`.`code` LIKE "mel%" OR `documents_data_icd10_en`.`code` LIKE "(mel%" OR `documents_data_icd10_en`.`code` LIKE "% mel%" OR `documents_data_icd10_en`.`code` LIKE "% (mel%" OR `documents_data_icd10_en`.`long_label` LIKE "mel%" OR `documents_data_icd10_en`.`long_label` LIKE "(mel%" OR `documents_data_icd10_en`.`long_label` LIKE "% mel%" OR `documents_data_icd10_en`.`long_label` LIKE "% (mel%") LIMIT 30'> 
```

我还尝试将 rawqueryset 转换为列表，并手动对其进行迭代并打印行。两者都不产生任何东西。

最后，为了检查模型对象是否真的是我认为的那样，尝试`print "All results: %s" % objmodel.objects.all()`给我一个 40 左右的列表，`<Data_icd10_en: Data_icd10_en object>`这是我所期望的。

那么，这里发生了什么？为什么我的代码在通过 modelname.objects.raw() 运行时没有产生任何结果，但是当在数据库 shell 中运行完全相同的 SQL 时正在获取结果，并且当相同的模型名在其中获取所有行时也正确地获取结果那个功能？

---- 编辑 ---- 测试确认是的，我确实通过 Django 应用程序和外壳访问同一个数据库。此外，一行中的简单原始查询确实有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T18:19:26.660

经过进一步调查，打开 MySQL 日志记录并给 Django 开发人员发送电子邮件，结果证明我的代码没有问题。

而是有一个原生的小错误`QuerySet.query.__str__()`：当这将实际的 SQL 内容输出到控制台时，它无法打印封装用户提供的参数的引号。

因此，当控制台声明时：

```
<RawQuery: u'SELECT * FROM documents_data_icd10_en WHERE (`documents_data_icd10_en`.`code` LIKE "(diabetes%"... 
```

实际执行的是：

```
"<RawQuery: u'SELECT * FROM documents_data_icd10_en WHERE (`documents_data_icd10_en`.`code` LIKE "("diabetes%""... 
```

...这是无效的。

故事的精神：不要相信什么`QuerySet.query.__str__()`告诉你，不要将用户提供的字符串封装在引号中`Model.objects.raw(sql,PARAMS)`，因为这将为你完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-12T20:22:34.337

#这将执行任何类型的原始查询，它可以是子查询等..\

```
 query ="""this will be the raw query"""\ 
 X=cursor.execute(query) \
 answers = cursor.fetchall()\
 print ("answers---",answers)\ 
```

# java - 无法识别的 SSL 消息

> ID：15621772
> 
> 赞同：0
> 
> 时间：2013-03-25T18:09:32.853
> 
> 标签：java, ftps

刚刚确认 FTPS 服务器确实在使用 Filezilla 工作。对这个例外感到很困惑。

**代码**

```
FTPSClient client = null;
        try {
            client = new FTPSClient(protocol, isImpicit);
        } catch (NoSuchAlgorithmException e1) {
            // TODO Auto-generated catch block
            Logger.debug(e1);
            e1.printStackTrace();
        }
        client.setDataTimeout(timeoutInMillis);
        //client.addProtocolCommandListener(new PrintCommandListener(new  PrintWriter(System.out)));

        System.out.println("################ Connecting to Server ################################");

        try
        {
            int reply;
            System.out.println("################ Connect Call ################################");
            client.connect(ftpServer, ftpPort);

            client.login(username, password);

            System.out.println("################ Login Success ################################");

            //client.setFileType(FTP.BINARY_FILE_TYPE);
            client.setFileType(FTP.NON_PRINT_TEXT_FORMAT);
            client.execPBSZ(0);  // Set protection buffer size
            client.execPROT("P"); // Set data channel protection to private
            client.enterLocalPassiveMode();

            System.out.println("Connected to " + server + ".");
            reply = client.getReplyCode();

            if (!FTPReply.isPositiveCompletion(reply))
            {
                client.disconnect();
                System.err.println("FTP server refused connection.");
                System.exit(1);
            }

            client.listFiles();
            //boolean retrieved = client.retrieveFile(remoteFile, new FileOutputStream(localFile));
        }
        catch (Exception e)
        {
            if (client.isConnected())
            {
                try
                {
                    client.disconnect();
                }
                catch (IOException ex)
                {
                    ex.printStackTrace();
                }
            }
            System.err.println("Could not connect to server.");
            e.printStackTrace();
            return client;
        }
        finally
        {
            //client.disconnect();
            try {
                client.logout();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                Logger.debug(e);
                e.printStackTrace();
            }
            System.out.println("# client disconnected");
        }
        return client; 
```

**堆栈跟踪**

```
################ Connecting to Server ################################
################ Connect Call ################################
Could not connect to server.
javax.net.ssl.SSLException: Unrecognized SSL message, plaintext connection?
    at com.sun.net.ssl.internal.ssl.InputRecord.handleUnknownRecord(InputRecord.java:523)
    at com.sun.net.ssl.internal.ssl.InputRecord.read(InputRecord.java:355)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:798)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1138)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1165)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1149)
    at org.apache.commons.net.ftp.FTPSClient.sslNegotiation(FTPSClient.java:240)
    at org.apache.commons.net.ftp.FTPSClient._connectAction_(FTPSClient.java:166)
    at org.apache.commons.net.SocketClient.connect(SocketClient.java:178)
    at myFtpService.getFtpConnection(myFtpService.java:61) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T16:46:27.817

将 isImpcit 设置为 false。看起来服务器需要明确的 SSL 连接（即整个连接都是 SSL 加密的）。

# asp.net-mvc - 虚拟路径提供程序中的基础 vs 以前

> ID：15621776
> 
> 赞同：1
> 
> 时间：2013-03-25T18:09:41.227
> 
> 标签：asp.net-mvc

当您注册一个 VirtualPathProvider 时，您仍然希望以前的 VPP 工作。我已经看到通过两种方式完成此操作：一种是使用`base`（例如，`if base.FileExists(virtualPath)`），另一种是使用`Previous`（例如，`if Previous.FileExists(virtualPath)`）。这些之间有什么区别，一种优于另一种？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:48:57.313

看起来，当您向 注册 a`VirtualPathProvider`时`HostingEnvironment`，它会为`VirtualPathProvider`您`Initialize`的`VirtualPathProvider`. 此初始化方法将提供的 VPP 保存到字段中`_previous`。

基类提供的虚方法`VirtualPathProvider`使用`_previous`方式如下：

```
public virtual bool FileExists(string virtualPath)
{
    return this._previous != null && this._previous.FileExists(virtualPath);
} 
```

每个方法都会检查以确保它`_previous`被重视，然后提供相关的响应。看起来 call`base`比 call 更安全`Previous`，因为它`base`会为你做所有的`null`检查。

# svn - 詹金斯和 SVN 凭证的缓存

> ID：15621777
> 
> 赞同：3
> 
> 时间：2013-03-25T18:09:45.620
> 
> 标签：svn, jenkins, credentials, svnkit

像很多人一样，我（再次）对 Jenkins 和 subversion 插件进行了猛烈抨击。通过网站的身份验证（输入凭据）在身份验证时失败。有趣，因为我可以使用相同的凭据访问 svn。

我已删除：

*   `$HOME/.subversion`
*   中的所有条目`hudson.scm.SubversionSCM.xml`
*   作业中的 svn 凭据

它发生了什么故障？我重新安装了`jenkins.war`in tomcat，从那以后，Jenkins 无法再访问 svn。

我以前一直走这条路，由于跟踪错误的情况，我从来没有理解这种痛苦的设置是如何工作的，以防止下次出现这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T21:01:08.490

这些是我将 jenkins 安装移动到另一台机器时遇到的 SVN 问题。

1.  首先，确保 svn 命令适用于控制台/终端中的 jenkins 用户。

2.  您是否直接从以前的安装中复制了配置文件？在我的情况下，配置文件中的凭据被散列并且不能在不同的机器上工作。我删除了以前的配置文件并从头开始。删除旧的配置文件后，我在 webui 中再次设置凭据。

3.  您是否将 Jenkins 作为服务运行？确保 jenkins 服务的“登录身份”用户与您使用的凭据匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T02:05:29.250

当您输入要签出的 URL 时，Jenkins 将放置一个链接，您可以在其中输入凭据以检查它是否无法访问该 URL。

您可以以*Jenkins User*身份登录，然后手动输入凭据。我相信詹金斯会在可能的情况下使用它们。但是，Jenkins 不会将其凭据存储在那里。它们存储在`$JENKINS_HOME`XML 文件的目录中的某个位置。文件名将包含颠覆，但它不会是标准`.subversion`文件。

我现在无法访问我的 Jenkins 服务器来查看文件名。我建议您创建一个特殊的 Jenkins 用户 ID，该用户 ID 可以直接访问您的 Subversion 存储库，而不是使用当前用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T05:29:32.800

您是否尝试以 jenkins 用户身份从 jenkins 服务器上的命令行访问 svn 主机？这可能有助于让 svn 再次记住凭据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-08T21:22:55.983

对我来说，我找到了位于 ~/.jenkins/jobs/ABCJob/subversion.credentials 的凭据

# php - 多选组合框

> ID：15621787
> 
> 赞同：0
> 
> 时间：2013-03-25T18:10:11.057
> 
> 标签：php

```
 ComBox1(Allows Multiple Selection)             ComboBox2
    __________________________________             __________

    Fruits                                         
    Vegetables 
```

我有一个组合框1（允许多项选择），其中包含以下项目：水果和蔬菜。

ComboBox2 中的项目将根据基于 ComboBox1 的选择进行填充。

如果选择了“水果”，那么 ComboBox2 中的项目应该是：苹果、橙子、香蕉

```
 ComBox1(Allows Multiple Selection)             ComboBox2
    __________________________________             __________

    Fruits  (selected)                             Apple
    Vegetables                                     Orange
                                                   Banana 
```

如果同时有水果和蔬菜，那么 ComboBox2 项目应该是：苹果、橙子、香蕉、萝卜、生菜。

```
 ComBox1(Allows Multiple Selection)             ComboBox2
    __________________________________             __________

    Fruits  (selected)                             Apple
    Vegetables (selected)                          Orange
                                                   Banana
                                                   Radish
                                                   Lettuce 
```

我需要使用 PHP 来做到这一点。任何人都可以建议如何使用 Jquery 或 ajax 或 javascript 来实现此功能？

实际上，我从数据库中获取两个组合框中的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:34:36.853

使用 jquery，包含 jquery 库

```
<script type='text/javascript' src="http://code.jquery.com/jquery.js"></script> 
```

然后使用以下脚本：

```
<script type='text/javascript'>
 $(document).ready(function(){
  $('#typeSelect').change(function(){
   $.ajax({
    url:"data.php",
    data: { type: $('#typeSelect').val() },
    type: "POST",
   }).success(function(data){
    $("#itemSelect").html(data);
   });
  });
 });
</script> 
```

使用这种形式：

```
<form>
 <select id="typeSelect" multiple="multiple">
  <option value="fruit">Fruit</option>
  <option value="vege">Vegetables</option>
 </select>
 <select id="itemSelect" multiple="multiple">

 </select>
</form> 
```

在 data.php 中，您可以输入：

```
<?php
$a = array(
 "fruit" => array(
  "apples" => "Apples",
  "bananas" => "Bananas", 
  "pears" => "Pears"
 ),
 "vege" => array(
  "toma" => "Tomatoes", 
  "cucu" => "Cucumber", 
  "rad" => "Radish"
 )
);

foreach($_POST['type'] as $type){
 foreach($a[$type] as $key => $val){
  echo "<option val='{$key}'>{$val}</option>";
 }
} 
```

当然你会用 PHP 填充第一个选择框，并根据发布的值生成数组，但为了展示如何填充选择框，我使用了一个静态数组。

# c# - 仅从 c# 运行签名的 powershell 脚本

> ID：15621788
> 
> 赞同：5
> 
> 时间：2013-03-25T18:10:12.870
> 
> 标签：c#, powershell, executionpolicy

我有一个下载脚本然后运行它的 Windows 服务。

我一直在努力让我的 Windows 服务更安全，让它只接受签名的 power-shell 脚本。

我在服务器上运行了 Set-ExecutionPolicy AllSigned 命令，这适用于 windows power shell 命令提示符。

但是，即使 set-executionpolicy 设置为受限，我的代码仍会同时运行已签名和未签名的脚本。

我尝试了两种方法：

RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();

```
 Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
        runspace.Open();

        RunspaceInvoke scriptInvoker = new RunspaceInvoke(runspace);
        Pipeline pipeline = runspace.CreatePipeline();         
        pipeline.Commands.AddScript(@"Set-ExecutionPolicy AllSigned");
        pipeline.Commands.AddScript(@"Get-ExecutionPolicy");
        pipeline.Commands.AddScript(script);
        Collection<PSObject> results = pipeline.Invoke(); 
```

还有另一种方法：

```
using (PowerShell ps = PowerShell.Create())
                {
                    ps.AddCommand("Set-ExecutionPolicy").AddArgument("Restricted");
                    ps.AddScript("Set-ExecutionPolicy Restricted");
                    ps.AddScript(script);
                    Collection<PSObject> results = ps.Invoke();
                  } 
```

在这两种情况下，代码也会运行未签名的脚本。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T23:19:11.720

我找到了解决方案。限制代码运行未签名脚本的唯一方法是自己使用 Get-AuthenticodSignature 检查脚本：

```
 public bool checkSignature(string path)
    {

        Runspace runspace = RunspaceFactory.CreateRunspace();
        runspace.Open();
        RunspaceInvoke scriptInvoker = new RunspaceInvoke(runspace);
        Pipeline pipeline = runspace.CreatePipeline();
        pipeline.Commands.AddScript(String.Format("Get-AuthenticodeSignature \"{0}\"", path));
        Collection<PSObject> results = pipeline.Invoke();
        Signature check = (Signature)results[0].BaseObject;
        runspace.Close();
        if (check.Status == SignatureStatus.Valid)
        {
            return true;
        }
        return false;
    } 
```

谢谢，

担

# excel - MS Excel - 通过组合逻辑运算符、总和、数据透视表和表格来获取和呈现结果

> ID：15621800
> 
> 赞同：0
> 
> 时间：2013-03-25T18:11:13.563
> 
> 标签：excel, report, logical-operators

在我提出这个问题之前，我想声明我已经花时间研究这个问题的解决方案，部分运气。

*所以，这里的场景是：* 有 X 个用户，使用 Y 个产品。每个用户可以使用一种或多种产品。一些用户在家工作，其他用户在办公室工作。

例如

```
ID  Office  Home Dept    P1 P2 P3   
1   loc1    1    dep1    1  1  0
2   loc1    0    dep1    0  0  1
3   loc2    1    dep1    1  1  1
4   loc4    1    dep2    1  0  1
5   loc3    0    dep2    1  1  0            
6   loc3    0    dep1    1  1  0                    
7   loc1    0    dep3    1  0  0 
```

*我想要实现的目标：* 我想计算并呈现各种产品组合的共同用户数和用户总数。我知道我可以使用逻辑函数'or'和'and'来确定'union'和'intersection'，并计算列总和以获得用户总数和共同用户数。但是，我希望能够选择各种产品组合，而无需每次都创建新配方；带有复选框的东西。

*我想展示的内容：* 至于数据的展示，我是否能够通过数据透视表创建有用的东西，或者我应该查看自定义表单，其中包括 P1、P2、P3 的复选框...... ? 任何提示和建议将不胜感激。

谢谢，amx13

# python-3.x - 在 openSuSE 中使用带有 python3 的 virtualenv

> ID：15621801
> 
> 赞同：0
> 
> 时间：2013-03-25T18:11:14.453
> 
> 标签：python-3.x, virtualenv, opensuse

在带有 Python3 的 openSuSE 12.3 中使用 virtualenv 时遇到问题：

我安装了`python3`和`python3-devel`包。然后我使用 pip 安装了最新的`distribute`最后`pip`是 virtualenv。

当我尝试创建 virtualenv 时，出现以下错误：

```
$ virtualenv-3.3 venv01
Using base prefix '/usr'
New python executable in venv01/bin/python3.3
Also creating executable in venv01/bin/python
Installing distribute.........................................................................................................................................................................................................................................................................................................................................................................................................done.
Installing pip....
  Complete output from command /home/user/venv01/bin/python3.3 -x /home/user/venv01/bin/easy_install /usr/local/lib/pytho...ort/pip-1.3.1.tar.gz:
  /home/user/venv01/bin/python3.3: can't open file '/home/user/venv01/bin/easy_install': [Errno 2] No such file or directory
----------------------------------------
...Installing pip...done.
Traceback (most recent call last):
  File "/usr/local/bin/virtualenv-3.3", line 9, in <module>
    load_entry_point('virtualenv==1.9.1', 'console_scripts', 'virtualenv-3.3')()
  File "/usr/local/lib/python3.3/site-packages/virtualenv.py", line 979, in main
    no_pip=options.no_pip)
  File "/usr/local/lib/python3.3/site-packages/virtualenv.py", line 1094, in create_environment
    install_pip(py_executable, search_dirs=search_dirs, never_download=never_download)
  File "/usr/local/lib/python3.3/site-packages/virtualenv.py", line 667, in install_pip
    filter_stdout=_filter_setup)
  File "/usr/local/lib/python3.3/site-packages/virtualenv.py", line 1057, in call_subprocess
    % (cmd_desc, proc.returncode))
OSError: Command /home/user/venv01/bin/python3.3 -x /home/user/venv01/bin/easy_install /usr/local/lib/pytho...ort/pip-1.3.1.tar.gz failed with error code 2 
```

运行它会`-vvv`产生一些有趣的输出，显示`distribute` 提取到`<venv>/local/lib/python3.3/site-packages/`.

我想知道为什么没有安装分发`<venv>/lib/python3.3/site-packages/`？

有谁知道为什么会发生这种情况以及如何在 openSuSE 中使用 virtualenv 而无需`python3`自己编译？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:07:31.760

**[现在在 opensuse 的最新补丁中修复]**

[哦！我刚刚意识到你和原来的链接是同一个人。对不起。但我会留下这个，因为它是谷歌搜索在这个问题上的最高结果（正在搜索自己的任何更新），所以它可以帮助其他人。]

这是一个已知问题，在[https://forums.opensuse.org/english/get-technical-help-here/applications/484475-using-virtualenv-python-3-a.html](https://forums.opensuse.org/english/get-technical-help-here/applications/484475-using-virtualenv-python-3-a.html)进行了讨论，在[https ://bugzilla.novell.com/show_bug.cgi?id=809831](https://bugzilla.novell.com/show_bug.cgi?id=809831)

我知道的唯一解决方法是自己安装所有东西。这并不难，我在[http://www.acooke.org/cute/GettingPyt0.html描述了必要的内容](http://www.acooke.org/cute/GettingPyt0.html)

基本上：

*   从源代码安装 python 3.3（执行“altinstall”安装为 /usr/local/bin/python3.3）

*   修复 lib 问题（将 lib_dynload 从 /usr/local/lib64/python3.3 链接到 /usr/local/lib/python3.3）

*   安装 distutils

*   安装虚拟环境

然后您可以按预期使用等`python3.3`。`virtual-env-3.3`

# objective-c - 检测从其他 ViewController 中点击了哪个 UIBarButton

> ID：15621822
> 
> 赞同：1
> 
> 时间：2013-03-25T18:12:12.150
> 
> 标签：objective-c, uipopovercontroller, uibarbuttonitem

我有 4 个 UIBarButtons，点击时会显示 PopoverController。根据点击的按钮，我必须显示不同的弹出框内容，这必须在 PopoverController viewDidLoad 方法中完成。

这是我处理 UIBarButton 轻按的弹出窗口的方式。在 (VC1.m)

```
[PopoverController presentPopoverFromBarButtonItem:[self.navigationItem.rightBarButtonItems objectAtIndex:[self.navigationItem.rightBarButtonItems count] -1]
                                 permittedArrowDirections:UIPopoverArrowDirectionAny
                                                 animated:YES]; 
```

我想把条件放在 viewDidLoad，（PopoverController.m）

```
- (void)viewDidLoad {
   [super viewDidLoad];
   if ([super.navigationItem.rightBarButtonItems objectAtIndex:[self.navigationItem.rightBarButtonItems count] -1]) {
      // Trigger method# 1
    }
    else {
      // Trigger method# 2
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:44:43.657

我建议为您将要使用的初始选项卡状态添加一个属性。基本上：

```
@property NSInteger tabState; 
```

然后，您可以在初始化后立即设置，也可以在 init 函数中设置。

假设`PopoverController`在上面的代码中是`UIPopoverController`您在某处实例化的子类，您可以更改 init 函数（通常在调用 init 期间将选项卡状态传递`– initWithContentViewController:`给`– initWithContentViewController:tabState:`然后传入：

```
– initWithContentViewController:(UIViewController*)vc tabState:(NSInteger)newTabState
{
     self = [super initWithContentViewController: vc];
     if (self) {
         self.tabState = newTabState;
     }
     return self;
} 
```

然后在您的`-viewDidLoad`方法中，您可以触发`self.tabState`您的状态信息，而无需与先前视图紧密绑定。

# sql - 根据另一个表中的数据更新一个 SQL 表

> ID：15621826
> 
> 赞同：2
> 
> 时间：2013-03-25T18:12:26.297
> 
> 标签：sql, count, sql-server-2008-r2

我正在运行 Microsoft SQL Server 2008 R2，并从两个表中提取信息以创建一个新表。

表 A 具有具有唯一潜在客户编号和其他信息的潜在客户。
表 B 的销售额具有唯一的销售编号，以及与之关联的潜在客户编号。
两个表中的数据都被提取到 SQL Server 中的临时表中，因此我可以更改和更新我需要的任何内容，并且此输出将进入一个新表。

表 A 中的一个潜在客户可以在表 B 中与多个销售相关联。

我想根据潜在客户编号在表 B（销售）中出现的次数来更新表 A（潜在客户）中的销售数量列。因此，如果表 B（销售）的潜在客户编号与七 (7) 次销售相关联，则表 A（潜在客户）中的销售数量列将更新为 7。

我使用 COUNT 函数尝试了一些变体，但没有成功。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:19:37.553

假设字段名称为：这应该对您有用`leadNo`：

```
update tablea 
set sales = (select count(*) 
             from tableb 
             where tableb.leadNo = tablea.leadNo) 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/bcb97/1)

# java - 为什么我需要调用 find() 两次？

> ID：15621831
> 
> 赞同：1
> 
> 时间：2013-03-25T18:12:42.143
> 
> 标签：java, regex

我正在编写一个程序来解析一堆数据，（您可以在此处获取数据集本身的示例：[https ://explore.data.gov/Geography-and-Environment/Worldwide-M1-Earthquakes-Past-7-天/7tag-iwnu](https://explore.data.gov/Geography-and-Environment/Worldwide-M1-Earthquakes-Past-7-Days/7tag-iwnu)）。

下面的类工作得很好，但**我不知道为什么我需要在我的方法`matcher.find()`中的每个项目之间调用一个额外的时间。`parseEarthquake()`这是为什么？这是我必须处理的正常怪癖，还是我错误地设置了我的模式/匹配器？**

该方法接受一个包含数据行之一的字符串（例如，`nc,71958020,1,"Thursday, March 21, 2013 17:13:34 UTC",38.8367,-122.8298,1.4,2.60,28,"Northern California"`），并为数据返回一个地震对象。

```
import java.text.DecimalFormat;
import java.text.FieldPosition;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.TimeZone;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class Earthquake {

    String src="xx";
    String eqid="00000000";
    short version;
    long dateTime;
    float lat, lon;
    float mag, dep;
    short nst;
    String region="Nowhere";

    private Earthquake(){
        date.setTimeZone(TimeZone.getTimeZone("UTC"));
    }

    private static DecimalFormat 
            coords      = new DecimalFormat( "##0.0000" ),
            magnitude   = new DecimalFormat( "###0.0" ),
            depth       = new DecimalFormat( "###0.00" );
    private static SimpleDateFormat date = new SimpleDateFormat("'\"'EEEE', 'MMMM' 'dd', 'yyyy' 'HH':'mm':'ss' 'zzz'\"'");

    // Src, Eqid, Version, Datetime, Lat, Lon, Magnitude, Depth, NST, Region;

    public static Earthquake parseEarthquake(String string){
        Earthquake result = new Earthquake();

        Matcher matcher = Pattern.compile("(\".*?\")|([^,]*)").matcher(string);

        try {

                                matcher.find(); result.src = matcher.group();
                matcher.find(); matcher.find(); result.eqid = matcher.group();
                matcher.find(); matcher.find(); result.version = Short.parseShort(matcher.group());
                matcher.find(); matcher.find(); result.dateTime = date.parse(matcher.group()).getTime();
                matcher.find(); matcher.find(); result.lat = coords.parse(matcher.group()).floatValue();
                matcher.find(); matcher.find(); result.lon = coords.parse(matcher.group()).floatValue();
                matcher.find(); matcher.find(); result.mag = magnitude.parse(matcher.group()).floatValue();
                matcher.find(); matcher.find(); result.dep = depth.parse(matcher.group()).floatValue();
                matcher.find(); matcher.find(); result.nst = Short.parseShort(matcher.group());
                matcher.find(); matcher.find(); result.region = matcher.group();    

        } catch (ParseException e) {
            e.printStackTrace();
        } catch (NumberFormatException e) {
            e.printStackTrace();
        }

        return result;
    }

    public String toString(){
        StringBuffer buf = new StringBuffer();

                            buf.append(src);
        buf.append(',');    buf.append(eqid);
        buf.append(',');    buf.append(version);
        buf.append(',');    date.format(dateTime, buf, new FieldPosition(0));
        buf.append(',');    coords.format(lat, buf, new FieldPosition(0));
        buf.append(',');    coords.format(lon, buf, new FieldPosition(0));
        buf.append(',');    magnitude.format(mag, buf, new FieldPosition(0));
        buf.append(',');    depth.format(dep, buf, new FieldPosition(0));
        buf.append(',');    buf.append(nst);
        buf.append(',');    buf.append('"'); buf.append(region); buf.append('"');

        return buf.toString();

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:33:07.963

更改`([^,]*)`为`([^,]+)`，因为前者将始终匹配 - 即使它只匹配任何内容。

# python - subprocess.popen pid 更改

> ID：15621840
> 
> 赞同：1
> 
> 时间：2013-03-25T18:13:16.333
> 
> 标签：python, process, subprocess, popen, pid

我有一个脚本，我在其中使用 subprocess.Popen 来启动一个外部程序，并在它启动后就使用 process.kill() 来杀死它。每次脚本试图杀死它时，我都会收到 Windows 错误 [5]（拒绝访问）。我意识到程序的 pid 在打开后实际上正在发生变化。有没有办法在 Python 中监视更改的过程，或者只检索新的 pid？

这是代码：

```
import subprocess
import time

proc  =  subprocess.Popen(Path/to/WinSCP.exe)
time.sleep(2)
proc.kill() 
```

错误：

```
Traceback (most recent call last):
File "C:\Python27\lib\lib-tk\Tkinter.py", line 1410, in __call__
return self.func(*args)
File "C:\Path", line 231, in __call__
self.scpsetup()
File "C:\Path", line 329, in scpsetup
proc.kill()
File "C:\Python27\lib\subprocess.py", line 1019, in terminate
_subprocess.TerminateProcess(self._handle, 1)
WindowsError: [Error 5] Access is denied 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T14:16:08.307

这就是我最终要做的；

```
import tempfile
import subprocess
import time

# Create a temp file to receive output
tf      =  tempfile.NamedTemporaryFile(delete=False)
output  =  open(tf.name, "w")

# Open and close WinSCP
subprocess.Popen(Path/To/WinSCP.exe)
time.sleep(2)
subprocess.call("TASKKILL /IM WinSCP.exe", stdout=output)
tf.close() 
```

我以前用这种方法遇到的问题是我无法隐藏命令的输出。这可能不是完成此任务的最漂亮方法，但它确实有效。

另请注意，我使用的是 Windows 8。我了解命令本身在不同版本的 Windows 中可能略有不同。

# java - 如何以 12 小时格式而不是 24 小时格式显示时间 - timeEt.setIs24HourView(false); 不管用

> ID：15621846
> 
> 赞同：0
> 
> 时间：2013-03-25T18:14:17.447
> 
> 标签：java, android, string, time, timepicker

我创建了一个数据库，该数据库存储时间选择器中的 currentHour 和 currentMinute 但我想以 12 小时格式而不是 24 格式显示它，并且我当前的实现

```
timeEt.setIs24HourView(false); 
```

不工作。

附言

当前分钟也缺少 0 整数，因此时间显示为 14:3 而不是 14:03 [正确的 24 小时格式] 或 2:03 [正确的 12 小时格式]

帮助！

菜鸟忍者

```
import android.app.Activity;
import android.app.AlertDialog;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.ViewGroup;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.FrameLayout;
import android.widget.TimePicker;

public class AddEditCountry extends Activity {

     private long rowID; 
     private EditText nameEt;
     private EditText capEt;
     private EditText codeEt;
     private TimePicker timeEt;

       @Override
       public void onCreate(Bundle savedInstanceState) 
       {
          super.onCreate(savedInstanceState); 
          setContentView(R.layout.add_country);

          nameEt = (EditText) findViewById(R.id.nameEdit);
          capEt = (EditText) findViewById(R.id.capEdit);
          codeEt = (EditText) findViewById(R.id.codeEdit);
          timeEt = (TimePicker) findViewById(R.id.timeEdit);

          Bundle extras = getIntent().getExtras(); 

          if (extras != null)
          {
             rowID = extras.getLong("row_id");
             nameEt.setText(extras.getString("name"));  
             capEt.setText(extras.getString("cap"));  
             codeEt.setText(extras.getString("code"));    
             String time = extras.getString("time");
             String[] parts = time.split(":");
             timeEt.setCurrentHour(Integer.valueOf(parts[0]));
             timeEt.setCurrentMinute(Integer.valueOf(parts[1]));
             timeEt.setIs24HourView(false);
          }

          Button saveButton =(Button) findViewById(R.id.saveBtn);
          saveButton.setOnClickListener(new OnClickListener() {

              public void onClick(View v) 
              {
                 if (nameEt.getText().length() != 0)
                 {
                    AsyncTask<Object, Object, Object> saveContactTask = 
                       new AsyncTask<Object, Object, Object>() 
                       {
                          @Override
                          protected Object doInBackground(Object... params) 
                          {
                             saveContact();
                             return null;
                          }

                          @Override
                          protected void onPostExecute(Object result) 
                          {
                             finish();
                          }
                       }; 

                    saveContactTask.execute((Object[]) null); 
                 }

                 else
                 {
                    AlertDialog.Builder alert = new AlertDialog.Builder(AddEditCountry.this);
                    alert.setTitle(R.string.errorTitle); 
                    alert.setMessage(R.string.errorMessage);
                    alert.setPositiveButton(R.string.errorButton, null); 
                    alert.show();
                 }
              } 
         });
       }

           private void saveContact() 
           {
              DatabaseConnector dbConnector = new DatabaseConnector(this);

              if (getIntent().getExtras() == null)
              {
                  dbConnector.insertContact(nameEt.getText().toString(),
                          capEt.getText().toString(),
                          timeEt.getCurrentHour().toString() + ":"
                              + timeEt.getCurrentMinute().toString(),
                          codeEt.getText().toString());
              }
              else
              {
                 dbConnector.updateContact(rowID,
                         nameEt.getText().toString(),
                            capEt.getText().toString(),
                              timeEt.getCurrentHour().toString() + ":"
                                  + timeEt.getCurrentMinute().toString(),
                              codeEt.getText().toString());
              }
           }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:38:08.460

要获得显示分钟的前导 0，您可以使用以下内容：

```
DecimalFormat df =   new DecimalFormat  ("00");
String minutes = df.format(min); 
```

要计算 12 小时格式，为什么不在必要时减去 12 小时？

# nhibernate - 将实体添加到一对多集合时，是否需要设置 ONE 侧的值？

> ID：15621848
> 
> 赞同：1
> 
> 时间：2013-03-25T18:14:24.887
> 
> 标签：nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

这似乎是一个非常明显的问题，但我一直无法找到明确的答案。我正在使用 FluentNHibernate 自动映射和 DefaultCascade.All() 约定。

实体正在保存，但在一对多的关系中，即使我通过添加到集合来保存，我也必须在我的多方面提供一侧。一个例子可能会更好地解释这一点：

假设我有这两个类：

```
public class Owner
{
    public virtual IList<PetDog> Dogs { get; set; }
}

public class PetDog
{
    public virtual Owner Owner { get; set; }
} 
```

为了将新的 PetDog 添加到所有者的 Dogs 集合中，我觉得我应该可以调用

```
Owner.Dogs.Add(new PetDog()); 
```

并处置我的 ISession。但是，我只是让所有者节省，仅此而已。如果我明确设置

```
Owner.Dogs.Add(new PetDog { Owner = Owner }) 
```

有用。

有没有办法避免明确提供该值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:22:59.887

这可以通过在 Owner 映射中设置 inverse = false 将 Owner 类标记为关系的所有者来完成，即

```
HasMany(x => x.Dogs)
    .Not.Inverse()
    .Cascade.AllDeleteOrphan(); 
```

然后在提交时会填充 PetDog 表中的 owner_id 外键，即

```
using (var transaction = session.BeginTransaction())
{
    var order = new Owner() {Dogs = new List<PetDog>()};
    order.Dogs.Add(new PetDog() );
    order.Dogs.Add(new PetDog() );

    session.Save(order);
    transaction.Commit();
} 
```

或者，您可以调用`session.Flush()`而不是使用事务，这将导致新数据插入数据库，即

```
 var order = new Owner() {Dogs = new List<PetDog>()};
    order.Dogs.Add(new PetDog() );
    order.Dogs.Add(new PetDog() );

    session.Save(order);
    session.Flush(); // data persisted to DBMS here. 
```

请注意，`session.Flush()`不推荐使用最佳实践。建议使用显式事务。有关详细信息，请参阅Ayende Rahien 的这篇[博文。](http://ayende.com/blog/3775/nh-prof-alerts-use-of-implicit-transactions-is-discouraged)

# video - Away3d 等距矩形到立方投影

> ID：15621851
> 
> 赞同：0
> 
> 时间：2013-03-25T18:14:39.090
> 
> 标签：video, away3d

尝试创建一个使用 equirectangular 视频作为源文件的 360 视频播放器。就像 flickr 上的这些，但视频，而不是静止图像。 [http://www.flickr.com/groups/equirectangular/pool/](http://www.flickr.com/groups/equirectangular/pool/)

我在 github 上遇到过这个项目，但是它将原始源投影到球体内的视频纹理上，我认为效率较低，并且还存在仅限于 1 个最大尺寸为 2048 像素的纹理的问题。

[https://github.com/Visuall-Interactive/OVP-basic](https://github.com/Visuall-Interactive/OVP-basic)

任何 Away3d 专家都可以建议我如何将 equirectangular 视频源映射到立方体内部（即从 equirectangular 转换为立方体）？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T10:54:37.253

在我早期的 Away3D 日子里，我接手了一个项目，该项目试图将所有内容映射到球形环境。我重新渲染了资产，以便在平面或倒置立方体上使用三次映射。我们当时从 4 fps 到 30 fps。

我建议在 Skybox 上使用三次映射，例如设置（倒置立方体或 6 个平面）并预处理视频以进行匹配。这将是获得更好质量和性能的最有效方法。

立方体/平面方法还具有具有 6 个纹理的优点，因此可以实现更高的分辨率。但理论上，您也可以将球体分割成多个部分并使用多个纹理。

请记住，VideoTexture 很慢，而且不是 GPU 加速的。您可以重新渲染或预处理这些视频吗？还是您必须按原样加载它们？

# ruby - 使用正则表达式（在 Ruby 中）同时包含单个和多个文本字符串？

> ID：15621852
> 
> 赞同：0
> 
> 时间：2013-03-25T18:14:40.217
> 
> 标签：ruby, regex, ole, open-uri

所以我有这个问题，我要使用 Open-URI 在 Excel 的列表中列出每个国家/地区。一切正常，但我似乎不知道如何让我的 RegExp-“字符串”包括单名国家（如“瑞典”），但也包括南非等国家，用空格等分隔。我希望我'已经让自己得到了公平的理解，下面我将包含相关的代码。

我要匹配的文本如下（例如）：

```
<a href="wf.html">Wallis and Futuna</a>
<a href="ym.html">Yemen</a> 
```

我目前坚持使用这个正则表达式：

```
/a.+="\w{2}.html">(\w*)<.+{1}/ 
```

如您所见，匹配“也门”没有问题。虽然我仍然希望代码能够匹配“Wallis and Futuna AND Yemen。也许如果有办法将所有内容包含在给定的“>blabla bla<”中？有什么想法吗？我将非常感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:26:35.780

在处理 HTML 实体提取时使用 Regex 通常是不好的

```
require 'nokogiri' 

parser = Nokogiri::HTML.parse(your_html)
country_links = parser.css("a")
country_links.each{|link| puts link['href']; puts link.text;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:23:03.467

对于您的测试样品，

```
/<a[^>]+href="\w{2}.html">([\w\s]+)<\/a>/ 
```

# c++ - std::map 声明 - 错误的模板

> ID：15621853
> 
> 赞同：0
> 
> 时间：2013-03-25T18:14:42.317
> 
> 标签：c++, c++11

对于以下代码行，我收到以下编译错误，说明模板参数的数量错误。你能告诉我这个声明有什么问题吗？在我看来没问题。ServicePartitionKey 的内容在底部给出。

```
 //Line 107 where template arguments issue happens is this declaration line
   std::map<ServicePartitionKey key, std::vector<EndPointAddr*>* > mServiceMap; 
```

**编译消息：**

```
In file included from ServiceRegistrar.hpp:8:0,
                 from ServiceRegistrar.cpp:7:
 ../control_api/ServiceRegistrarAPI.hpp:107:66: error: wrong number of template  arguments (1, should be 4)
In file included from /usr/include/c++/4.7/map:61:0,
             from ../control_api/ServiceRegistrarAPI.hpp:9,
             from ServiceRegistrar.hpp:8,
             from ServiceRegistrar.cpp:7: 
```

**类 ServicePartitionKey**

```
#include <cstdint>

class ServicePartitionKey
{
 public:  
    ServicePartitionKey() {};
    ServicePartitionKey(uint32_t instanceNo, uint64_t version);
    ~ServicePartitionKey() {};

   bool operator < (const ServicePartitionKey &rhs) const;

   void setInstanceNo(uint32_t instanceNo) { mInstanceNo = instanceNo; }  
   uint32_t getInstanceNo() const { return mInstanceNo; }

   void setVersion(uint64_t version) { mVersion = version; }  
   uint64_t getVersion() const { return mVersion; } 

 private:
   uint32_t mInstanceNo;
   uint64_t mVersion;
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T18:15:28.853

模板应该只是类型。您为第一个提供了类似声明的语法：

```
std::map<ServicePartitionKey key, std::vector<EndPointAddr*>* > mServiceMap;
//                           ^^^ 
```

它应该只是：

```
std::map<ServicePartitionKey, std::vector<EndPointAddr*>* > mServiceMap; 
```

# c# - Windows Phone 8 的独立存储文件或 Windows.Storage API？

> ID：15621855
> 
> 赞同：6
> 
> 时间：2013-03-25T18:14:51.510
> 
> 标签：c#, file-io, windows-runtime, windows-phone-8, isolatedstorage

我正在为 Windows Phone 8 开发一个幕后库。我们需要将文件系统用作原始缓存。不过，我发现有两个适用于 Windows Phone 8 的 API。有一个典型的从 Windows Phone 7 继承的 IsolatedStorageFile API。但是，现在还有新的 Windows.Storage.ApplicationData API 集，我假设它是从 WinRT 继承的。

我应该使用哪一个？有什么区别，为什么我应该使用其中一种？另外，它们是如何交互的？如果我在 IsolatedStorage 中创建文件，我可以在 Windows.Storage 中看到它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T18:36:01.300

如果您只针对 WP8，那么我从 Microsoft 收到的建议是，您应该使用`Windows.Storage`API。

预计其他人将在未来被弃用。

该指南实际上更笼统。转述：

> 如果有多种方法可以做某事，如果您不需要向后支持，请使用“Windows”命名空间下的功能。

# iphone - 为什么这些约束不起作用？

> ID：15621858
> 
> 赞同：1
> 
> 时间：2013-03-25T18:14:56.290
> 
> 标签：iphone, ios, uiscrollview, constraints, autolayout

我有一个滚动视图，我想在 viewDidLoad 方法中添加到我的超级视图中。我使用以下代码执行此操作：

```
[self.view addSubview:self.scroll];
NSMutableArray *constraints = [NSMutableArray arrayWithCapacity:4];
[constraints addObject:[NSLayoutConstraint constraintWithItem:self.scroll
                             attribute:NSLayoutAttributeLeft
                             relatedBy:NSLayoutRelationEqual
                                toItem:self.view
                             attribute:NSLayoutAttributeLeft
                            multiplier:1
                              constant:0]];
[constraints addObject:[NSLayoutConstraint constraintWithItem:self.scroll
                                                    attribute:NSLayoutAttributeRight
                                                    relatedBy:NSLayoutRelationEqual
                                                       toItem:self.view
                                                    attribute:NSLayoutAttributeRight
                                                   multiplier:1
                                                     constant:0]];
[constraints addObject:[NSLayoutConstraint constraintWithItem:self.scroll
                                                    attribute:NSLayoutAttributeBottom
                                                    relatedBy:NSLayoutRelationEqual
                                                       toItem:self.view
                                                    attribute:NSLayoutAttributeBottom
                                                   multiplier:1
                                                     constant:0]];
[constraints addObject:[NSLayoutConstraint constraintWithItem:self.scroll
                                                    attribute:NSLayoutAttributeHeight
                                                    relatedBy:NSLayoutRelationEqual
                                                       toItem:self.view
                                                    attribute:NSLayoutAttributeHeight
                                                   multiplier:0.5
                                                     constant:0]];

[self.view addConstraints:constraints]; 
```

滚动视图旨在放置在视图的底部，它的高度应该是超级视图高度的一半。

我收到以下错误：

```
Probably at least one of the constraints in the following list is one you don't want. Try this: (1) look at each constraint and try to figure out which you don't expect; (2) find the code that added the unwanted constraint or constraints and fix it. (Note: If you're seeing NSAutoresizingMaskLayoutConstraints that you don't understand, refer to the documentation for the UIView property translatesAutoresizingMaskIntoConstraints) 
```

（“”、“”、“”、“”）

将尝试通过打破约束来恢复

请有人告诉我我做错了什么？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:39:07.737

rdelmar 解决了这个问题：

您可以尝试添加 [self.scroll setTranslatesAutoresizingMaskIntoConstraints:NO]

# php - SimpleXML 解析嵌套命名空间 - PHP

> ID：15621859
> 
> 赞同：0
> 
> 时间：2013-03-25T18:15:03.307
> 
> 标签：php, namespaces, simplexml

我在解析位于下面的名为“q0:”的嵌套命名空间中的标签时遇到了一个小问题。

```
//Tag that I am trying to parse
  <q0:CustomerTransactionId> 
```

由于某种原因，我能够访问所有“v12：”命名空间标签，但不能访问“q0：”标签。

谢谢！

**这是XML**

```
<?xml version="1.0" encoding="UTF-8"?>
 <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
 <env:Header 
       xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" 
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
<soapenv:Body>
<v12:ProcessShipmentReply 
    xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:v12="http://fedex.com/ws/ship/v12">
    <v12:HighestSeverity>ERROR</v12:HighestSeverity>
    <v12:Notifications>
        <v12:Severity>ERROR</v12:Severity>
        <v12:Source>ship</v12:Source>
        <v12:Code>3058</v12:Code>
        <v12:Message>Recipient Postal code or routing code is required</v12:Message>
        <v12:LocalizedMessage>Recipient Postal code or routing code is required</v12:LocalizedMessage>
    </v12:Notifications>
    <q0:TransactionDetail xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:q0="http://fedex.com/ws/ship/v12">
        <q0:CustomerTransactionId>21445634</q0:CustomerTransactionId>
    </q0:TransactionDetail><q0:Version xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:q0="http://fedex.com/ws/ship/v12">
    <q0:ServiceId>ship</q0:ServiceId>
    <q0:Major>12</q0:Major>
    <q0:Intermediate>0</q0:Intermediate>
    <q0:Minor>0</q0:Minor>
  </q0:Version>
  </v12:ProcessShipmentReply>
  </soapenv:Body>
  </soapenv:Envelope> 
```

**这是我的解析**

```
 $xml = simplexml_load_string($result, NULL, NULL, 'http://schemas.xmlsoap.org/soap/envelope/');
    $xml->registerXPathNamespace('env', 'http://schemas.xmlsoap.org/soap/envelope/');
    $xml->registerXPathNamespace('v12', 'http://fedex.com/ws/ship/v12');
    $xml->registerXPathNamespace('q0', 'http://fedex.com/ws/ship/v12');

    $bodies = $xml->xpath('env:Body');

    foreach($bodies as $body){

        $reply = $body->children('v12', TRUE)->ProcessShipmentReply;
        $reply2 = $body->children('q0', TRUE)->TransactionDetail;

        $custInfoArr['status'] = (string) $reply->HighestSeverity;

        if(strtolower($custInfoArr['status'])=="error"){

            $custInfoArr['invoiceNum'] = (string)$reply2->CustomerTransactionId;
            $custInfoArr['notificationSeverity']= (string) $reply->Notifications->Severity;
            $custInfoArr['notificationSource']= (string) $reply->Notifications->Source;
            $custInfoArr['notificationCode']= (string) $reply->Notifications->Code;
            $custInfoArr['notificationMessage']= (string) $reply->Notifications->Message;
            $custInfoArr['notificationLocalizedMessage']= (string) $reply->Notifications->LocalizedMessage;

        }

        $custInfoArr['trackingCode'] = (string) $reply->CompletedShipmentDetail->CompletedPackageDetails->TrackingIds->TrackingNumber;
        $custInfoArr['labelCode'] = (string) $reply->CompletedShipmentDetail->CompletedPackageDetails->Label->Parts->Image;
        $custInfoArr['labelCode'] = base64_decode($custInfoArr['labelCode']);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T13:40:04.863

`<q0:TransactionDetail>`不是 的孩子`<env:Body>`，而是 的孩子`<v12:ProcessShipmentReply>`，所以你需要在里面寻找它`$reply`，而不是`$body`：`$reply2 = $reply->children('q0', TRUE)->TransactionDetail;`

要记住的重要一点是，`->TagName`运算符和`->children()`方法*都只查看特定节点的直接子节点*，它们不会像 XPath 那样进行“深度搜索”。

事实上，看，两者`v12:`和`q0:`都是同一个命名空间的别名（' [http://fedex.com/ws/ship/v12](http://fedex.com/ws/ship/v12) '），所以下一行可以是`$reply2 = $reply->TransactionDetail`. 如果您只是说`$reply = $body->children('http://fedex.com/ws/ship/v12')->ProcessShipmentReply`而不是依赖别名，这会变得更清晰（并且更安全，因为这些别名可能会更改）。

顺便说一句，除非您将它用于其他用途，否则您还可以摆脱所有 XPath 代码（包括所有`registerXPathNamespace`调用）并直接编写`$body = $xml->children('http://schemas.xmlsoap.org/soap/envelope/')->Body`（我很确定 SOAP 只允许每条消息一个正文）。

# php - 通过php在Mysql表上插入Varbinary数据

> ID：15621862
> 
> 赞同：0
> 
> 时间：2013-03-25T18:15:07.980
> 
> 标签：php, mysql, insert, pack, varbinary

我有一个小问题，我相信有人有解决方案我有一个从一组无符号整数转换而来的二进制数据

> $_BIN=pack('I*', 3563547,6587568,5468456,6458568,4568568);

我想将它插入到包含 varbinary 列的表中

> $strSQL = "INSERT INTO table_name (id, ba) VALUES($id, $_BIN)";

出于某种原因，我收到以下错误

Erreur SQL ：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行 SQL 字符串的 '_' 附近使用正确的语法：INSERT INTO table_name (id, ba) VALUES(467, *('ùZ¢O ^,* ¦EòÇjÞ|²EÎóÇjÞ| ²EÎóp>)

希望大家能帮帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:22:19.503

这对我有用：

```
DROP TABLE IF EXISTS `binary`;
CREATE TABLE `binary`(
id INT NOT NULL AUTO_INCREMENT, 
ba VARBINARY( 100 ),
PRIMARY KEY(`id`)
) ENGINE=MYISAM; 
```

和 PHP 代码（使用 PDO）：

```
<?php
$db = new PDO('mysql:dbname=test;host=localhost:4040','xxx','xxxx');

$_BIN=pack('I*', 3563547,6587568,5468456,6458568,4568568);

$rs = $db->prepare("INSERT INTO `binary`(`ba`) VALUES(?)");

$rs->execute(array($_BIN)); 
```

**更新**

根据您建议的带有命名参数的代码，请参见下面的代码：

```
<?php
$_SNB = 23;
$_USR = "toto";
$_BIN = pack('I*', 24325, 2556456, 547577, 675746, 535646, 4564575, 575474, 4735);

$db = new PDO('mysql:host=localhost:4040;dbname=test','xxxx','xxxx');
$db->exec('SET CHARACTER SET utf8');
$rs = $db->prepare("INSERT INTO `spw_license` (`serial_num`, `user`, `ba_struct`) 
                  VALUES(:serial_num, :username, :ba_struct)");

$rs->bindValue(':serial_num', $_SNB, PDO::PARAM_INT);
$rs->bindValue(':username', $_USR);
$rs->bindValue(':ba_struct', $_BIN, PDO::PARAM_LOB);

try {
    if(!$rs->execute()) {
        var_dump($db->errorInfo());
    }
} catch(Exception $e) {
    echo 'got Exception: ' . $e->getMessage() . PHP_EOL;
} 
```

这是启动后表格的样子：

```
mysql> select * from `spw_license`;
+------------+------+----------------------------------+
| serial_num | user | ba_struct                        |
+------------+------+----------------------------------+
|         23 | toto | ♣_  (☻' ∙ вO
 ^ _жE Є ⌂↕   |
+------------+------+----------------------------------+
1 row in set (0.00 sec) 
```

# matlab - 在MATLAB中的矩阵中绘制点之间的线

> ID：15621867
> 
> 赞同：1
> 
> 时间：2013-03-25T18:15:21.320
> 
> 标签：matlab, plot, line

我有一个 n 行 4 列的矩阵。列是 x0、y0 和 x1、y1（所以基本上我在 2D 中有 n 对点坐标）。我想在对应的点对之间画一条线（即仅在一行的 x0, y0 和 x1, y1 之间）。

是否可以在没有循环的情况下做到这一点？因为以下工作但很慢。

```
for i = 1:size(A.data, 1)
    plot([A.data(i, 1), A.data(i, 3)], [A.data(i, 2), A.data(i, 4)], 'k-')
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-25T23:26:57.743

这适用于我拥有的数据结构：

```
data = [
        0, 0, 1, 0;...
        1, 0, 1, 1;...
        1, 1, 0, 1;...
        0, 1, 0, 0 ...
       ];

figure(1);
hold off;

%slow way
for i = 1:size(data, 1)
    plot([data(i, 1) data(i, 3)], [data(i, 2) data(i, 4)], 'r-');
    hold on;
end

%fast way ("vectorized")
    plot([data(:, 1)' data(:, 3)'], [data(:, 2)' data(:, 4)'], 'b-');
axis equal 
```

这个特殊的例子画了一个正方形。

关键是 MATLAB在参数中按*列绘制线条。*也就是说，如果 的参数`plot`有*n*列，则该行将有*n* -1 段。

在向量中的所有点都必须连接的“连接点”场景中，这是无关紧要的，因为如果需要，MATLAB 会转置以获得列向量。它在我的应用程序中变得很重要，因为我*不想*连接列表中的每个点 - 只连接点对。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-10T04:13:28.030

我来到这里寻找相同的答案。我基本上希望每个 x,y 点都有一条水平线，从该点的 xy 值开始，到下一个 xy 对的 x 值结束，没有一条线将该线段连接到下一个 xy 对的线段。我可以通过在旧 y 和新 x 之间添加新点来制作线段，但我不知道如何分解线段。但是你的措辞（矩阵）给了我一个想法。如果您将 xy 对加载到一对 x、y 向量中，然后 - 等待它 - 在 x 和 y 向量中将您的对与 nan 分开会怎样。我用一个很长的正弦波尝试过，它似乎有效。大量不相交的线段，可立即绘制和缩放。:) 看看它是否能解决你的问题。

```
% LinePairsTest.m
% Test fast plot and zoom of a bunch of lines between disjoint pairs of points 
% Solution: put pairs of x1,y1:x2,y2 into one x and one y vector, but with
% pairs separated by x and or y = nan.  Nan is wonderful, because it leaves
% your vector intact, but it doesn't plot.
close all; clear all;
n = 10000; % lotsa points
n = floor(n/3); % make an even set of pairs
n = n * 3 - 1;  % ends with a pair
x = 1:n; % we'll make a sine wave, interrupted to pairs of points.
% For other use, bring your pairs in to a pair of empty x and y vectors,
% padding between pairs with nan in x and y.
y = sin(x/3);
ix = find(0 == mod(x,3)); % index 3, 6, 9, etc. will get...
x(ix) = nan; % nan.
y(ix) = nan; % nan.
figure;
plot(x,y,'b'); % quick to plot, quick to zoom.
grid on; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-25T18:32:50.930

`line`例如尝试

```
X=[1:10 ; 2*(1:10)];
Y=fliplr(X); 

line(X,Y) 
```

# asp.net-mvc - 用现有的数据和/或业务层替换 MVC 中的模型？

> ID：15621871
> 
> 赞同：1
> 
> 时间：2013-03-25T18:15:33.090
> 
> 标签：asp.net-mvc, data-access-layer, business-logic-layer

问题是我想将我们的一些小型 WinForms 应用程序转移到 ASP.NET

我有数据访问层 dll 和业务层 dll。

用这些 dll 替换模型并使用控制器和视图来创建 MVC 应用程序是一种好习惯吗？

或者我应该重新创建我的图层以促进 MVC 编程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T20:04:20.490

MVC 只是一种模式，而 ASP.NET 在这方面是相当松散耦合的。默认情况下，DAL 由实体框架处理，视图由 Razor 处理，但您可以将它们替换掉。特别是对于模型层，有些人更喜欢使用 NHibernate 之类的东西而不是实体框架。因此，同样可以使用您自己的 DAL。

# database-design - 在订单表上建模多对多

> ID：15621872
> 
> 赞同：0
> 
> 时间：2013-03-25T18:15:36.983
> 
> 标签：database-design, entity-relationship

我正在为实体模式建模，如果我建立多对多关系的方式在我的情况下是最有效的，我并不肯定。业务需求是有复合订单。**`ParentId`**为了灵活，我需要订单之间的多对多关系（而不是仅仅通过粘在**`Order`**桌子 上来创建一对多）。
我决定添加**`CompoundOrder`**表来支持多对多关系。

这是模拟这种情况的唯一方法吗？它是最有效的吗？

这是一个例子：

![我的模特](../Images/92f781b073175ab1006d1b0c436e7d2d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:32:31.333

这不是标准的做法。标准方式是销售订单有许多行项目。

```
SALES_ORDER
id
order_date
vendor_party_id
customer_party_id
bill_to_party_id
bill_to_address_id

ORDER_ITEM
id
order_id 
product_id
quantity
unit_price
ship_to_party_id
ship_to_address_id 
```

# php - 我的网站有问题？对齐两个 div 时遇到问题

> ID：15621875
> 
> 赞同：0
> 
> 时间：2013-03-25T18:15:44.543
> 
> 标签：php, html, css

所以我正处于想要退出的地步，因为这个问题给我带来的所有麻烦。因此，如果有人可以帮助我，那就太好了：D！

所以在我的网站上，我想做的是在网站的左侧有一个 div 框，那里会有一个“了解更多”链接，可以将您带到另一个页面，解释我的网站是关于什么的，我也想在那里成为它正下方的视频（由我解释我的网站）

在另一个 div 框中，我希望有一个“注册表格”，一个基本的注册表格，供用户注册我的网站

现在我的问题不是让盒子或注册表单并排对齐。

现在我的问题是盒子顶部的对齐方式。当我输入“float:left;” 它并排对齐它们（就像我想要的那样）但是盒子的一个顶部边框比另一个高

例如，到目前为止，这是我的网站[http://www.shoportrade.org/](http://www.shoportrade.org/) 如您所见，这些框与边框顶部并没有完全对齐，一个比另一个低

我希望它看起来像这样[http://www1.picturepush.com/photo/a/12506959/640/12506959.png](http://www1.picturepush.com/photo/a/12506959/640/12506959.png)

有人可以帮我吗？我碰壁了，我真的很想解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:25:05.413

我不知道为什么你有所有的中断标签，但这是你的语法需要的样子：

```
<div id="header">

</div>

<div id="container">
    <div class="ex">

    </div>
    <div class="myform">

    </div>
    <div class="clear"></div>
</div> 
```

您的标题将保持不变。您的容器需要包装两个盒子。通常这是在页面上使用此 CSS 居中对齐：

```
.container { width:980px; margin: 0 auto; } 
```

您的 .ex 类将保持不变（float：left;），并且您的 .myform 类也将保持不变（float：left;）。

.clear 类负责帮助浏览器计算最终显示高度，通常如下所示：

```
.clear { clear: both; height: 1px; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:26:35.690

这是一种不使用浮点数的方法。两个盒子的高度会根据容器的高度而变化。

如果您希望盒子的高度不同，请更改它们的“底部”值。

[http://jsfiddle.net/Calum/m783T/](http://jsfiddle.net/Calum/m783T/)

**CSS**

```
 #container {
    height: 500px;
    width: 800px;
    position: relative;
    background-color: green;
}

#box, #box2 {
    position: absolute;
    top: 50px;
    width: 200px;
}

#box {
    background-color: blue;
    left: 50px;
    bottom: 50px;
}

#box2 {
    background-color: red;
    right: 50px;
    bottom: 50px;
} 
```

**HTML**

```
<div id="container">
    <div id="box">
        <p>This is box 1</p>
    </div>
    <div id="box2">
        <p>This is box 2</p>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:43:34.387

首先，您的编码中有一些错误。喜欢

```
<div id='header'></a href='http://www.shoportrade.org/'><img src='mylogo1.png'></img></a> 
```

应该

```
<div id='header'><a href='http://www.shoportrade.org/'><img src='mylogo1.png' /></a></div> 
```

我相信您正在声明 class myform in `<style>`，但我在您的代码中看到您正在尝试实现 this `<div id="myform">`，这是完全错误的。应该是`<div class="myform">`。如果您实际上想为该 div 实现不同的样式，那么我认为您应该使用不同的 id 名称，例如`<div id='boxstyle'></div>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T18:24:36.520

这是因为你有`<br>`你的`<div id="myform">`.

# android - Android Drawable hdpi xhdpi mdpi ldpi 概念

> ID：15621876
> 
> 赞同：-1
> 
> 时间：2013-03-25T18:15:45.327
> 
> 标签：android, android-drawable

我在可绘制概念中有一个查询。我有固定尺寸的图像，我把它们放在可绘制的文件夹中。我已经从 eclipse 项目中删除了我的其他文件夹，例如 drawable-hdpi、mdpi、ldpi、xhdpi，并制作了我的项目的 APK。

我的问题是我的应用程序（生成的 apk）是否可以在所有设备和平板电脑上运行（我不关心 UI 的外观）？或者它是否可以在某些设备/平板电脑上创建 ResourceNotFound 异常，因为并非所有可绘制文件夹都存在？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:16:58.740

没有任何限定符（布局、可绘制、原始、值等）的文件夹是默认文件夹。如果在符合该设备条件的文件夹中找不到，Android 会查找其中的每个资源。如果您在其中有任何资源的副本，那么您永远不*应该*为该特定资源获得 ResourceNotFound 异常，除非制造商在他们的 ROM 中引入了错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:18:02.843

只要您有一个可绘制文件夹，那么当操作系统搜索其他文件夹并没有找到它们时，它将默认为唯一可用的可绘制文件夹。

# php - 什么更有效，为什么：每页一个数据库连接或每个函数一个数据库连接？

> ID：15621877
> 
> 赞同：6
> 
> 时间：2013-03-25T18:15:47.253
> 
> 标签：php, mysql, performance, mysqli

我正在一个非常 MySQL DB 驱动的网站上工作。所以我有很多疑问。

在[本主题](https://stackoverflow.com/questions/2129162/how-do-you-efficiently-connect-to-mysql-in-php-without-reconnecting-on-every-que)中，每个人都建议在页面顶部连接到数据库，并在页面底部断开连接。

我想知道什么更有效，或者一般来说是最佳实践：**每页建立一个数据库连接，还是只根据需要连接？**（或者没有普遍的答案，这取决于？）

此外，我正在寻找**为什么**这是最佳实践，您从哪个角度看待场景（例如安全性，速度，......我不知道数据库连接可能会影响什么？！）

[我相信这个问题在此](https://stackoverflow.com/questions/6197024/keeping-one-connection-to-db-or-openning-closing-per-need)之前已经被问过- 但不是针对 PHP，因此我觉得它没有帮助。

我目前的做法是通过*mysqli连接到数据库*对于我编写的每个函数，并在函数末尾断开连接，因为它对我来说似乎更干净。这样，如果页面不调用需要数据库访问的函数，则永远不会打开连接。但是，根据用户在网站上的操作，每个页面加载可能最多有大约 10 个连接。现在我认为这可能是资源的公平分配。如果我理解正确，则只能始终打开 1 个 DB 连接。因此，我假设所有连接请求都将排队。因此，如果用户有多个、长且复杂的查询，则该用户不会阻塞所有流量，因为在每个查询之间，可能会处理其他短查询。但这只是我在编造东西，我不知道它是否真的会那样工作......：D

我也知道这里的很多开发人员都喜欢使用*PDO*。刚开始开发的时候选择使用*mysqli*，暂时没有切换的打算。我希望我的问题适用于这两个图书馆。

谢谢 ：-）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T18:29:10.403

通常，创建数据库连接的成本很高。这就是为什么大多数人建议创建一次连接并重复使用它直到执行停止，或者如果数据库客户端库允许，甚至更长时间。

例如，PDO 允许创建持久连接，这可能会提高性能，因为该连接将被重复用于连续服务多个请求。从[http://php.net/manual/en/pdo.connections.php](http://php.net/manual/en/pdo.connections.php)：

> 许多 Web 应用程序将受益于与数据库服务器建立持久连接。持久连接不会在脚本结束时关闭，但会在另一个脚本使用相同凭据请求连接时被缓存并重新使用。持久连接缓存允许您避免每次脚本需要与数据库通信时建立新连接的开销，从而提高 Web 应用程序的速度。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-25T18:50:21.743

我建议您考虑使用连接工厂模式。这将允许您仅在需要它的函数中调用工厂（如果从不需要连接，则避免连接的开销），同时允许您在以前建立连接时重用连接（避免重复构造和解构连接）。

也许你的页面中包含了一个 connectionFactory.php，或者可以通过你的加载器获得。

```
class ConnectionFactory{

private static $factory;
public static function getFactory(){
    if (!self::$factory){
        self::$factory = new ConnectionFactory();
        $this->db = null;
    }
    return self::$factory;
}

private $db;

public function getConnection(){
    if (is_null($this->db))
        $this->db = new mysqli('localhost', 'my_user', 'my_password', 'my_db');
        if ($this->db->connect_error){
            throw new Exception("Connect Error ("
                . $this->db->connect_errno
                . ") "
                . $this->db->connect_error
        );
    }
    return $this->db;
}

public function closeConnection(){
   if (! is_null($this->db)){
       $this->db::close();
       $this->db = null;
   }
} 
```

}

然后，您可以稍后在函数中使用它：

```
function doStuff(){
try{
    $conn = ConnectionFactory::getFactory()->getConnection();
}catch (Exception $e){

} 
```

}

如果您根本不使用连接，这可以确保您永远不会产生开销，如果您这样做，则可以利用该连接。

devzone.zend.com 说：*“打开的连接（和类似的资源）在脚本执行结束时会自动销毁。”*

因此，您不必显式关闭连接。但是，出于性能原因，有时可能需要这样做。这将取决于您正在运行的上下文，当您查看上下文时，您必须自己平衡。

您可能还会查看类似的[Global 或 Singleton 用于数据库连接？](https://stackoverflow.com/questions/130878/global-or-singleton-for-database-connection)

注意：我没有测试过任何这段代码，它是一个可能工作的例子。;-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T18:31:18.497

> 每页一个数据库连接还是每个函数一个数据库连接？

每页一个

> 为什么这是最佳实践，

速度和常识

> 如果我理解正确，则只能始终打开 1 个 DB 连接。

错误的。唯一的限制可以在 DB 端设置。而且总是有一个游泳池。

> 每页建立一个数据库连接，还是只根据需要连接？

是什么阻止您连接**一次**但仅**在需要时**连接？如果没有打开的连接，则使您的 db 函数自动连接，如果存在则重用它。虽然我觉得“非常 MySQL DB 驱动”的网站不值得一团糟。

# php - JQuery 准备崩溃

> ID：15621878
> 
> 赞同：3
> 
> 时间：2013-03-25T18:15:51.713
> 
> 标签：php, jquery, html, css

如果我将任何输入 ajax 到我的页面中，则以下代码可以工作，但是如果我打印一些特定代码，则会出现异常，警报 test3 永远不会触发。

```
alert("test2");
$(html).hide().prependTo("#current table.vtable").fadeIn("slow");
alert("test3"); 
```

我得到 jquery 异常：

```
Uncaught TypeError: Cannot set property 'cur' of undefined 
```

正如我所说的 CSS 工作正常，我尝试打印其他类，它工作得很好，唯一的区别是我使用

```
print <<<END
...
END; 
```

而不是普通的打印和 tr 是一个不同的类

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T22:26:30.310

从 jquery 1.7 升级到 1.9 后，我刚刚遇到了这个问题。这是fadeIn() 实现中的一个错误。

这与当您查询不存在的键时 data() 方法现在返回 undefined 而不是 null 的事实有关。

无论如何，我发现的一种解决方法是先添加数据，然后获取新的、预先添加的内容的 jquery 句柄，然后将其淡入*。*

由于您将新内容插入到表格中，因此找到您刚刚插入的内容有点烦人，因为它实际上不是第一个孩子（它隐含地包含在“tbody”标签中）。我通过在插入的东西上设置一个临时属性，搜索它，然后删除它来解决这个问题*。*这显然是一个巨大的黑客攻击，但它*确实*有效。

```
var html = "<tr><td>new thing1</td><td>new thing2</td>";

$("#clickme").click(function () {
    var target = $("#current table.vtable");
    $(html).attr("jquery_workaround","sigh").hide().prependTo(target);
    var newstuff = target.find("[jquery_workaround=sigh]");
    newstuff.removeAttr("jquery_workaround").fadeIn("slow");
}); 
```

对于摆弄：http: [//jsfiddle.net/BUVUj/](http://jsfiddle.net/BUVUj/)

# mootools - mooTools 绑定所有类

> ID：15621879
> 
> 赞同：1
> 
> 时间：2013-03-25T18:15:52.403
> 
> 标签：mootools

我不习惯使用 mooTools，它看起来很像 Prototype JS。谁能告诉我如何将它绑定到每个班级？

```
// This grabs all the classes
var mousy = $$('.hf-item-images');

// I don't think this is correct to apply this scroller to all the above classes
var scroll = new Scroller(mousy, {area: 100, velocity: 1});

// Mousemove
mousy.addEvent('mouseover', scroll.start.bind(scroll));
mousy.addEvent('mouseout', scroll.stop.bind(scroll)); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T14:37:57.997

您需要对此更加聪明，循环遍历 nnnn 项以制作 scollers 可能会很昂贵。在每个事件上附加一对事件也是如此。

给定标记，如下所示：

```
<div id="container">
    <div class="hf-item-images">...</div>
    <div class="hf-item-images">...</div>
</div> 
```

您可以将东西委托给父级，并且只在需要它的元素上实例化一个滚动器实例，然后再重用它。

```
var container = document.id('container'),
    settings = {
        area: 100,
        velocity: 1
    };

container.addEvents({
    'mouseover:relay(.hf-item-images)': function(e, el){
        var scroll = el.retrieve('scroller');
        if (!scroll){
            // create instance the first mouseenter and store for later
            scroll = new Scroller(el, settings);
            el.store('scroller', scroll);
        }
        scroll.start();
    },
    'mouseout:relay(.hf-item-images)': function(e, el){
        el.retrieve('scroller').stop();
    }
}); 
```

# c# - 将 ObservableCollection 绑定到 ListView

> ID：15621882
> 
> 赞同：0
> 
> 时间：2013-03-25T18:16:08.433
> 
> 标签：c#, wpf, listview, data-binding, observablecollection

我在将我的收藏绑定到我的列表视图时遇到了一些麻烦。我在这里尝试了很多与其他人不同的方法进行绑定，并且最初也遵循[了本教程](http://msdn.microsoft.com/en-us/library/ms748365.aspx)。我让它工作，但这不是我想要的方式。

无论如何，这里是 XML：

```
 <ListView Grid.Row="0" ItemsSource="{Binding SongList}"  SelectionMode="Extended" x:Name="ListViewMain" VerticalAlignment="Top"  ScrollViewer.VerticalScrollBarVisibility="Visible" Margin="0,1,0,0" Height="264" >
        <ListView.View>
            <GridView>
                <GridViewColumn Header="Title" DisplayMemberBinding="{Binding Title}" Width="500"/>
                <GridViewColumn Header="Artist" DisplayMemberBinding="{Binding Artist}" Width="100"/>
                <GridViewColumn Header="Album" DisplayMemberBinding="{Binding Album}" Width="100"/>
                <GridViewColumn Header="Length" DisplayMemberBinding="{Binding Length}" Width="100"/>
                <GridViewColumn Header="Location" DisplayMemberBinding="{Binding Songfile}" Width="100"/>
            </GridView>
        </ListView.View>
    </ListView> 
```

在我的代码中，要将项目添加到我的收藏中，我会：

```
public MainWindow()
{
     InitializeComponent();
         ...
     PlayListItem addsong = new PlayListItem(title, artist, album, length, filename);
} 
```

带有 ObservableCollection 的 PlayListItem 类：

```
public class PlayListItem
{
 public ObservableCollection<Song> _SongList = new ObservableCollection<Song>();
 public ObservableCollection<Song> SongList { get { return _SongList; } }       

 public PlayListItem(string _Title, string _Artist, string _Album, string _Length, string _Filename)
{
     _SongList.Add(new Song
    {
     Title = _Title,
     Artist = _Artist,
     Album = _Album,
     Length = _Length,
     SongFile = _Filename,
    });
}

 public class Song
  {
    public string Artist { get; set; }
    public string Album { get; set; }
        public String Title { get; set; }
        public string Length { get; set; }
        public String SongFile { get; set; }
  }
} 
```

我认为每次调用构造函数时都会正确添加我的项目，但它不会在 ListView 上得到更新。我也没有关于输出窗口中的绑定的一些错误。

任何想法和帮助将不胜感激。

编辑 ：

通过添加 ：

```
ListViewMain.ItemsSource = addsong.SongList; 
```

在创建一个新的 PlayListItem 之后似乎解决了这个问题，因为 ListView 现在正在打印该项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:51:14.677

两个问题。1) 我看不到 DataContext 的设置位置。您可以在窗口级别或单独控制级别执行此操作。2）。PlayListItem 没有实现 INotifyPropertyChanged。如果在 InitializeComponent 之后设置 SongList，则需要 INotifyPropertyChanged，但如果在之前则不需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:20:04.783

您是否尝试过使用双向绑定？单向绑定不会更新另一侧。添加这个：`Mode="TwoWay"`在 itemsource 绑定中。

# javascript - MongoDB 中两个集合之间的 Diff()

> ID：15621883
> 
> 赞同：4
> 
> 时间：2013-03-25T18:16:09.350
> 
> 标签：javascript, node.js, mongodb, diff

我做过研究。如果这是一个重复的问题，我深表歉意，但其他问题的解决方案并不适合我，因此，我提出了一个新问题。

用 Javascript 比较两个集合的最佳方法是什么？

我有数千个这种 Mongo 文档格式的标题：

```
{
    "url": "google.com",
    "headers": {
        "location": "http://www.google.com/",
        "content-type": "text/html; charset=UTF-8",
        "date": "Mon, 25 Mar 2013 18:12:08 GMT",
        "expires": "Wed, 24 Apr 2013 18:12:08 GMT",
        "cache-control": "public, max-age=2592000",
        "server": "gws",
        "content-length": "219",
        "x-xss-protection": "1; mode=block",
        "x-frame-options": "SAMEORIGIN"
    }
} 
```

我今天跑了我的刮刀。将来，我会再次运行它，并将其存储在第二个集合中。此外，我希望能够比较三个特定的标头对象，即`server`、`x-aspnet-version`和`x-powered-by`，并检测是否有任何整数增量。

遍历两个集合并执行 diff() 的最佳方法是什么？

我做对了吗？任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T23:49:34.553

几个建议：

您可以使用 url 和访问日期（至少是 datetime 对象的一部分）的组合作为这些对象的 _id，因为据我所知，您计划每月抓取一次每个 url。

例子：

```
{
    "_id": {
        "url": "www.google.com",
        "date": ISODate("2013-03-01"),
    },
    // Other attributes
} 
```

这会产生性能、唯一性和查询红利（请参阅[这篇 4sq 博客文章](http://engineering.foursquare.com/2011/02/09/mongodb-strategies-for-the-disk-averse/)）。您可以查询执行以下操作：

```
db.collection.find({
    "_id": {
        "$gte": {
            "url": yourUrl,
            "date": rangeStart
         },
         "$lt": {
            "url": yourUrl,
            "date": rangeEnd
         },
    }
}) 
```

这会产生出色的、很好的排序（按 url THEN 按日期，这似乎正是您想要的）结果。如果您只想要一组漂亮的所有 url 和已抓取的月份，您也可以使用此索引执行覆盖查询（通过 _id 字段）（这可以很好地设置您一次浏览每个 url） .

如果您有兴趣比较的文档的特定属性（`headers.server`例如）以及您想要为它们进行的特定比较（例如寻找版本号的任何增量），我会使用某种正则表达式来抓取与版本号相关的元素（快速而肮脏的元素可能只是检索所有数字元素）并为每个 url 绘制图表（我假设这可以让您可视化服务器软件随时间的变化）。您可以通过按顺序扫描它们并在字符串不相同时触发一些事件来轻松报告这些属性中的任何一个更改（可能然后报告更改或更改的数字部分）。

# javascript - JavaScript / HTML - 新的音频 JavaScript 在 IE 8 和更少版本中失败？

> ID：15621885
> 
> 赞同：2
> 
> 时间：2013-03-25T18:16:20.593
> 
> 标签：javascript, html, audio

我怎样才能解决这个问题？例如：

* * *

```
snd = new Audio("foo/bar.wav")

alert("abc") //in IE this line wont run??!

snd.play() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T22:24:31.660

如果您检测到功能（支持的类型），您的脚本将不会在其他不支持音频的浏览器（移动设备等）中引发错误。

你可以让它成为有条件的跨浏览器，即。

```
if (typeof window.Audio != 'undefined') { 
  /* var snd = new Audio("foo/bar.wav"); ... */ 
} 
```

或考虑使用[Modernizr](http://modernizr.com)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:19:19.653

IE8- 不支持该`<audio>`元素。请参阅[http://caniuse.com/#feat=audio](http://caniuse.com/#feat=audio)。如果你可以分离你的脚本，你可以这样做：

```
<!--[if lte IE 8]>
  <script>
    alert("Old IE.");
  </script>
<![endif]-->
<!--[if IE 9]>
  <script>
    snd = new Audio("foo/bar.wav");
    alert("IE9");
    snd.play()
  </script>
<![endif]-->
<!--[if !IE]> -->
  <script>
    snd = new Audio("foo/bar.wav");
    alert("Not IE (Or IE10+)");
    snd.play()
  </script>
<!-- <![endif]--> 
```

IE10 完全放弃了条件注释，因此它将使用`!IE`脚本。

# javascript - 检查css类是否存在，如果存在多少次

> ID：15621887
> 
> 赞同：2
> 
> 时间：2013-03-25T18:16:23.343
> 
> 标签：javascript, jquery, html, css, dom

我想知道一种风格是否`class`存在，如果有，有多少元素。

要知道是否`class`存在样式，我使用：

```
if ($("*").hasClass('ui-state-active')) {
    alert("class exist : "+nb_checked);
} 
```

但是要知道类有多少元素，我无法弄清楚。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-25T18:17:41.990

这是一种更简单的方法：

```
$('.ui-state-active').length 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-25T18:17:49.387

做就是了：

```
$('.ui-state-active').length 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T18:20:21.610

```
if($('.ui-state-active').length){
     alert("class exist : "+$('.ui-state-active').length);
} 
```

文档在这里：

[http://api.jquery.com/length/](http://api.jquery.com/length/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-25T18:18:08.280

您可以将其用于两者

```
c = $('.ui-state-active').length;
if (c>0) {
    console.log('There is '+c+' elements having required class');
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-25T18:24:42.973

使用 jQuery，您可以直接选择具有某个类的[所有元素。](http://api.jquery.com/class-selector/)其语法与 CSS 选择器的语法相同：

```
$(".className") 
```

这将创建一个[jQuery 对象](http://api.jquery.com/jquery/)，它是匹配元素的集合。这个对象有很多有用的属性，其中之一就是[`length`](http://api.jquery.com/length/)集合中元素的数量。

在您的情况下，找到所需元素的数量就像

```
$(".ui-state-active").length 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-25T18:18:18.543

您可以一次性完成这两项工作：

```
var elements = $('.ui-state-active');
if(elements.length === 0) {
    alert('No elements with class ui-state-active!')
} else {
    alert(elements.length +  ' elements with class ui-state-active');
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-25T18:18:20.197

怎么样：

```
$(".ui-state-active").length; 
```

# go - 逐元素矩阵运算 Google Go？

> ID：15621889
> 
> 赞同：0
> 
> 时间：2013-03-25T18:16:27.703
> 
> 标签：go

我想知道是否有一个包可以在 Go 中提供有效的元素矩阵运算？类似于 GSL 的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:26:47.580

通过 cgo 调用例如 cblas 很容易：

```
package main

// #include <cblas.h>
// #cgo LDFLAGS: -L/usr/lib64/atlas -lcblas
import "C"

import "fmt"

type matrix struct {
    rows  int
    cols  int
    elems []float32
}

func (a matrix) cblasmul(b matrix) (c matrix) {
    c = matrix{a.rows, b.cols, make([]float32, a.rows*b.cols)}
    C.cblas_sgemm(
        C.CblasRowMajor, C.CblasNoTrans, C.CblasNoTrans,
        C.int(a.rows), C.int(b.cols), C.int(a.cols),
        1.0,
        (*C.float)(&a.elems[0]), C.int(a.cols),
        (*C.float)(&b.elems[0]), C.int(b.cols),
        0.0,
        (*C.float)(&c.elems[0]), C.int(c.cols))

    return c
}

func main() {
    a := matrix{100, 100, make([]float32, 100*100)}
    b := matrix{100, 100, make([]float32, 100*100)}
    // ...
    c := a.cblasmul(b)
    fmt.Println(c)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:44:20.210

GSL 有各种 cgo 绑定，甚至还有一些纯 Go 端口的尝试。似乎还没有一个得到太多认可（就明星而言）并且已经闲置了几个月，但您可能想看看代码：

[http://godoc.org/?q=gsl](http://godoc.org/?q=gsl)

# c - 如何让 GCC 使用 SSE 指令对这个简单的复制循环进行矢量化？

> ID：15621891
> 
> 赞同：4
> 
> 时间：2013-03-25T18:16:33.000
> 
> 标签：c, gcc, sse, vectorization, compiler-optimization

这是关于让 GCC在循环中优化的[问题](https://stackoverflow.com/questions/15554565/forcing-gcc-to-perform-loop-unswitching-of-memcpy-runtime-size-checks)的后续内容；`memcpy()`我已经放弃并决定直接手动优化循环。

不过，我试图尽可能地保持便携性和可维护性，所以我想让 GCC 在不诉诸 SSE 内在函数的情况下对一个简单优化的重复循环内复制本身进行矢量化。然而，无论我给它多少手，它似乎都拒绝这样做，尽管手动矢量化版本（使用 SSE2`MOVDQA`指令）在经验上对于小数组（<32 个元素）和至少 17较大的（> = 512）更快。

这是未手动矢量化的版本（有尽可能多的提示告诉 GCC 对其进行矢量化）：

```
__attribute__ ((noinline))
void take(double * out, double * in,
          int stride_out_0, int stride_out_1,
          int stride_in_0, int stride_in_1,
          int * indexer, int n, int k)
{
    int i, idx, j, l;
    double * __restrict__ subout __attribute__ ((aligned (16)));
    double * __restrict__ subin __attribute__ ((aligned (16)));
    assert(stride_out_1 == 1);
    assert(stride_out_1 == stride_in_1);
    l = k - (k % 8);
    for(i = 0; i < n; ++i) {
        idx = indexer[i];
        subout = &out[i * stride_out_0];
        subin = &in[idx * stride_in_0];
        for(j = 0; j < l; j += 8) {
            subout[j+0] = subin[j+0];
            subout[j+1] = subin[j+1];
            subout[j+2] = subin[j+2];
            subout[j+3] = subin[j+3];
            subout[j+4] = subin[j+4];
            subout[j+5] = subin[j+5];
            subout[j+6] = subin[j+6];
            subout[j+7] = subin[j+7];
        }
        for( ; j < k; ++j)
            subout[j] = subin[j];
    }
} 
```

这是我第一次尝试手动矢量化，我用它来比较性能（它肯定可以进一步改进，但我只是想测试最简单的转换）：

```
__attribute__ ((noinline))
void take(double * out, double * in,
          int stride_out_0, int stride_out_1,
          int stride_in_0, int stride_in_1,
          int * indexer, int n, int k)
{
    int i, idx, j, l;
    __m128i * __restrict__ subout1 __attribute__ ((aligned (16)));
    __m128i * __restrict__ subin1 __attribute__ ((aligned (16)));
    double * __restrict__ subout2 __attribute__ ((aligned (16)));
    double * __restrict__ subin2 __attribute__ ((aligned (16)));
    assert(stride_out_1 == 1);
    assert(stride_out_1 == stride_in_1);
    l = (k - (k % 8)) / 2;
    for(i = 0; i < n; ++i) {
        idx = indexer[i];
        subout1 = (__m128i*)&out[i * stride_out_0];
        subin1 = (__m128i*)&in[idx * stride_in_0];
        for(j = 0; j < l; j += 4) {
            subout1[j+0] = subin1[j+0];
            subout1[j+1] = subin1[j+1];
            subout1[j+2] = subin1[j+2];
            subout1[j+3] = subin1[j+3];
        }
        j *= 2;
        subout2 = &out[i * stride_out_0];
        subin2 = &in[idx * stride_in_0];
        for( ; j < k; ++j)
            subout2[j] = subin2[j];
    }
} 
```

（实际代码在处理一些特殊情况时稍微复杂一些，但不会影响 GCC 矢量化，因为即使上面给出的版本也不矢量化：我的测试工具可以在[LiveWorkspace](http://liveworkspace.org/code/2jBtjJ)上找到）

我正在使用以下命令行编译第一个版本：

```
gcc-4.7 -O3 -ftree-vectorizer-verbose=3 -march=pentium4m -fverbose-asm \
    -msse -msse2 -msse3 take.c -DTAKE5 -S -o take5.s 
```

并且用于主复制循环的结果指令始终是`FLDL`/`FSTPL`对（即以 8 字节为单位复制）而不是`MOVDQA`指令，这是我手动使用 SSE 内在函数时产生的。

的相关输出`tree-vectorize-verbose`似乎是：

> 在 take.c:168
> 
> 168 分析循环：vect_model_store_cost：硬件支持未对齐。
> 168：vect_model_store_cost：inside_cost = 8，outside_cost = 0。
> 168：vect_model_load_cost：硬件支持未对齐。
> 168：vect_model_load_cost：inside_cost = 8，outside_cost = 0。
> 168：成本模型：为循环版本化别名添加检查成本。
> 
> 168：成本模型：结语剥离迭代器设置为 vf/2 因为循环迭代是未知的。
> 168：成本模型：向量迭代成本=16除以标量迭代成本=16大于等于向量化因子=1。
> 168：未向量化：向量化不盈利。

我不确定为什么它指的是“未对齐”的存储和加载，无论如何，问题似乎是无法证明矢量化是有利可图的（即使从经验上看，它适用于所有情况，并且我不确定在什么情况下不会）。

是否有任何我在这里遗漏的简单标志或提示，或者 GCC 无论如何都不想这样做？

[如果这是显而易见的事情，我会感到尴尬，但希望这也可以帮助其他人，如果是的话。]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T18:31:34.973

所有`__attribute__ ((aligned (16)))`指令的实现都很少，因为它们只是定义了指针变量本身的对齐方式，而不是指针指向的数据。

您可能需要查看[__builtiin_assume_aligned](http://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html)。

# java - 当春天看到 在 webapp 中检查哪些上下文？

> ID：15621893
> 
> 赞同：2
> 
> 时间：2013-03-25T18:16:36.820
> 
> 标签：java, spring, spring-mvc

我有一个 servlet 的应用程序上下文 XML 文件 ( `/app/feature`)。整个 Web 应用程序也有一个应用程序上下文（即 servlet 上下文`/app`），并且有多个带有其他 XML 文件的 servlet。我了解`/app`作为`/app/feature`.

当我放入`<task:annotation-driven/>`子应用程序上下文时，检查了哪些 bean 的 @Async 和 @Scheduled 注释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T21:43:54.337

像这样的`task:annotation-driven`寄存器 BeanPostProcessors 是`ScheduledAnnotationBeanPostProcessor`针对每个容器的：

```
...beans that are defined in one container are not post-processed by 
a BeanPostProcessor defined in another container, even if both containers 
are part of the same hierarchy. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T00:13:52.100

内部逻辑是这样的，例如：`applicationContext.xml`你说的是父文件，`spring-servlet.xml`是你说的子文件。然后当tomcat启动时，首先将applicationContext.xml中的所有bean都实例化，其次将spring-servlet.xml中的所有bean实例化，然后会发生一些事情，如果bean A在applicationContext.xml和spring中都配置了-servlet.xml，那么 A 的第一个实例将被第二个实例覆盖。所以如果你添加`<task:annotation-driven/>`in `applicationContext.xml`，它就不起作用了，因为整个 bean 已经被 spring-servlet.xml 中实例化的 bean 覆盖了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-08T10:54:19.637

它将寻找@Async，其中@Scheduled 将使您能够安排每5000 毫秒之后的执行。

# ruby-on-rails-3 - 使用 Capistrano 将 Ruby on Rails 应用程序部署到 Windows Azure VM 时出现超时错误

> ID：15621894
> 
> 赞同：1
> 
> 时间：2013-03-25T18:16:37.363
> 
> 标签：ruby-on-rails-3, deployment, azure, capistrano, azure-virtual-machine

我是 Capistrano 和 Windows Azure 的新手，在将我的 Ruby on Rails 应用程序部署到我的 Azure 虚拟机时遇到问题。我能够使用 SSH 登录并连接到 VM。此外，我在连接到 VM 时成功创建了一个新的 Rails 应用程序（能够通过 VM 的 DNS 访问它）。但是，我不知道如何从 VM 服务器获取 Rails 代码，以便我可以在本地对其进行编辑，然后将更改推送回服务器。

无论如何，我在本地创建了一个简单的 Rails 应用程序，并希望将它（使用 Capistrano）部署到我的 Azure VM。`cap deploy`运行（和）时出现以下错误`cap deploy:setup`：

```
connection failed for: fb-shanghai.cloudapp.net (Errno::ETIMEDOUT: Operation timed out - connect(2)) 
```

我一直在玩`deploy.rb`配置文件，但一直收到同样的错误。另外，当我将`:web`角色从VM DNS“fb-shanghai.cloudapp.net”更改为公共VIP并运行`cap deploy`时，我收到了输入密码的提示，但无论我输入什么，它都失败了。

在这一点上，我真的不知道我需要做什么才能在我的 Azure VM 上运行我的 RoR 应用程序。任何帮助将不胜感激！

我的环境：

*   Mac OS X 10.7.5
*   红宝石 1.9.3
*   导轨 3.2.9
*   为我的虚拟机使用 Ruby-Stack-1-9-3-6-Ubuntu-12-10 映像

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:08:30.543

我有同样的问题，但我的仍然无法使用 IP 而不是 name_of_app.cloudapp.net。我花了一段时间才弄清楚，但由于某种原因，Azure 在我创建 VM 时将默认公共端口创建为随机端口号（不是 22），因此我将其编辑为 22 并且它工作正常。

我还应该提到我使用 VM 仓库中的 Bitnami ruby​​stack 来安装我的 VM。

就 deploy.rb 文件而言，我使用了上面发布的教程中的这个[gist](https://gist.github.com/3273427)文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T19:31:10.910

原来我需要为服务器配置行指定 VIP：

所以`server "xxx.xx.xxx.xxx", :web, :app, :db, primary: true`

代替`server "name_of_app.cloudapp.net", :web, :app, :db, primary: true`

然后，我需要`require "bundler/capistrano"`在文件顶部添加`deploy.rb`。

最后，我遵循了[Capistrano wiki](https://github.com/capistrano/capistrano/wiki/2.x-from-the-beginning)以及[Windows Azure 上的 Ruby on Rails 教程](https://github.com/WindowsAzure/azure-content/blob/master/DevCenter/Other/Tutorials/ruby-on-rails.md)中的一些说明。

# javascript - 打字稿：无类型数组

> ID：15621896
> 
> 赞同：1
> 
> 时间：2013-03-25T18:16:40.367
> 
> 标签：javascript, typescript

只是为了好玩，我决定看看 TypeScript。

我有一个问题（到目前为止）；给定以下打字稿代码...

```
class EP {

  id: number;
  TY: string;

  constructor(id: number, ty: string) {
    this.id = id;
    this.TY = ty;
  }

} 
```

以及以下打字稿代码...

```
var ep = new EP(1, "Yes");
var x = [ep.id, ep.TY]; 
```

JavaScript 会认为这是有效的，但是 TypeScript 抱怨“数组文字表达式中的类型不兼容”。我应该如何注释“x”以清除此错误？

对于那些感兴趣的人，我需要创建数组以将值传递给 SQLite。

此外，当使用 this 作为函数调用的参数时，相同的语法是什么，例如 SQLite 插入...

```
db.transaction.executeSql("...", [ep.id, ep.TY], ...); 
```

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T18:19:18.840

尝试`any[]`您的阵列类型。

# python - 如何通过 Facebook OpenGraph 检索所有帖子评论/喜欢

> ID：15621903
> 
> 赞同：20
> 
> 时间：2013-03-25T18:17:12.940
> 
> 标签：python, facebook, facebook-graph-api, facebook-opengraph

我正在尝试通过 Facebook 的 opengraph API 检索特定帖子的评论和喜欢。虽然我确实得到了一些信息，但它并不总是与帖子中提到的评论/点赞*数相符。*我想这可以归因于我正在使用的令牌的访问权限。但是，我注意到结果因我使用的请求*限制*而异，有时我还会在请求之间获得重复条目。

例如，截至撰写本文时，帖子 10376464573_150423345118848 大约有 14000 个赞，但我最多只能检索到 5000 个左右。默认限制为 25，我最多可以得到 3021 个赞。100 的值给出 4501，而 1000、2000、3000 和 5000 的限制都返回相同数量的喜欢，即 4959（当然，绝对值没有太大意义，它们只是用于比较）。

我注意到在较小规模的评论中出现了类似的结果。

我正在使用[一个简单的 python 脚本](https://gist.github.com/mpitid/5fab9ade98df02455577)来获取页面。它按照 Facebook 提供的分页链接遍历数据，将检索到的每个页面写入一个单独的文件。一旦遇到空回复，它就会停止。

在较小的限制下（例如默认值为 25），我注意到当我浏览分页链接时返回的结果数量单调递减，这看起来很奇怪。

关于什么可能导致这种行为以及如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-28T18:03:16.430

如果您正在寻找对特定帖子的每个赞/评论的名称列表，我认为您会遇到 API 限制（即使有分页）。

如果您只是在寻找点赞、评论、分享或链接点击的总数，您只需使用帖子端点中提供的 summary=true 参数即可。有点像这样：

```
try:
    endpoint = 'https://graph.facebook.com/v2.5/'+postid+'/comments?summary=true&access_token='+apikey
    response = requests.get(endpoint)
    fb_data = response.json()
    return fb_data 
```

您还可以检索任何特定页面的所有帖子及其摘要数据点：

```
{page_id}/posts?fields=message,likes.limit(1).summary(true) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-26T11:58:27.010

您可以使用下面的 url 或 api 检索特定帖子的评论和点赞数或其他信息。

```
https://graph.facebook.com/{0}/comments?access_token={1}&limit={2}&fields=from,message,message_tags,created_time,id,attachment,like_count,comment_count,parent&order=chronological&filter=stream'.format(post_id,access_token,limit) 
```

由于这里的 order 指定为按时间顺序排列，您还需要在同一 url 中使用 after 参数，其值可以在`paging.cursor.after`第一个响应的部分中获得。

# python - 如何让应用程序 threadedcomments_extras 显示或被忽略？

> ID：15621904
> 
> 赞同：1
> 
> 时间：2013-03-25T18:17:13.370
> 
> 标签：python, django, social-networking, pinax, threaded-comments

我越来越：

```
ImportError at /
No module named threadedcomments_extras
Request Method: GET
Request URL:    http://stornge.com:8000/
Django Version: 1.5
Exception Type: ImportError
Exception Value:    
No module named threadedcomments_extras
Exception Location: /home/jonathan/virtual_environment/local/lib/python2.7/site-packages/django/utils/importlib.py in import_module, line 35
Python Executable:  /home/jonathan/virtual_environment/bin/python
Python Version: 2.7.3
Python Path:    
['/home/jonathan/clay/apps',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/pinax/apps',
 '/home/jonathan/clay',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/distribute-0.6.24-py2.7.egg',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/pip-1.1-py2.7.egg',
 '/home/jonathan/virtual_environment/lib/python2.7',
 '/home/jonathan/virtual_environment/lib/python2.7/plat-linux2',
 '/home/jonathan/virtual_environment/lib/python2.7/lib-tk',
 '/home/jonathan/virtual_environment/lib/python2.7/lib-old',
 '/home/jonathan/virtual_environment/lib/python2.7/lib-dynload',
 '/usr/lib/python2.7',
 '/usr/lib/python2.7/plat-linux2',
 '/usr/lib/python2.7/lib-tk',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages',
 '/home/jonathan/virtual_environment/local/lib/python2.7/site-packages/PIL']
Server time:    Mon, 25 Mar 2013 13:59:14 -0400 
```

media/apps 目录中有一些东西在我看来就像一个 Django 应用程序：

```
(virtual_environment)jonathan@li393-189:~/clay$ find . | grep -i threadedcomments
./media/apps/threadedcomments_extras
./media/apps/threadedcomments_extras/__init__.pyc
./media/apps/threadedcomments_extras/templatetags
./media/apps/threadedcomments_extras/templatetags/comments_tag.pyc
./media/apps/threadedcomments_extras/templatetags/comments_tag.py
./media/apps/threadedcomments_extras/templatetags/__init__.pyc
./media/apps/threadedcomments_extras/templatetags/__init__.py
./media/apps/threadedcomments_extras/__init__.py
./media/projects/intranet_project/templates/threadedcomments
./media/projects/intranet_project/templates/threadedcomments/comments.html
./media/templates/default/threadedcomments
./media/templates/default/threadedcomments/comments.html
(virtual_environment)jonathan@li393-189:~/clay$ 
```

但是，将媒体应用程序复制到 ./apps/ 会立即终止工作线程。在 settings.py 中注释掉 'threadedcomments_extras' 也是如此。

我如何才能安装并运行 threadedcomments_extras，或者消除对 threadedcomments_extras 的所有期望？

谢谢，

# ssis - SSIS 2012 和 Excel 2010 提供程序问题

> ID：15621905
> 
> 赞同：1
> 
> 时间：2013-03-25T18:17:13.847
> 
> 标签：ssis

## 我正在使用 Windows 7 64 位、VS 2010 和 MS Office 2010。尝试使用 excel 源构建 ssis pkg，出现以下问题。

无法检索连接管理器“Excel 连接管理器”的表信息。

## 无法使用连接管理器“Excel 连接管理器”连接到源

我在互联网上找到了一些解决方案，通过 1) 安装 MS Access 数据库引擎 2010 redistributable_x64.exe 尝试了这些步骤。我重新启动了系统，但问题仍然存在。我在 oledb 源的提供程序列表中找不到提供程序，因此选择了 jet 4.0 oledb 提供程序并将扩展属性更改为 Excel 12.0，然后我收到以下错误：

* * *

## 由于初始化提供程序时出错，测试连接失败。找不到可安装的 ISAM。

而且，如果我使用 excel 源代码，它会向我抛出上面给出的错误。

2) 此外，将运行 64 位运行时更改为 false 并再次返回 True。3）试图改变项目的平台，但它被禁用。

你能帮帮我吗。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-18T06:51:53.733

虽然有点晚了，但可能对其他人很有帮助。

Visual Studio 2010/2012 只附带 32 位版本，因此它不能使用 ACE OLEDB 64 位版本，安装 Office 2010 64 位版本。

所以这里的解决方案是卸载 64 位版本的 office 2010 并安装它的 32 位版本。重新尝试添加excel连接管理器。

这解决了我的问题，也解决了其他人的希望。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T10:12:03.030

您需要安装 32 位提供程序。

即使您的 Windows 是 64 位，SSDT 开发环境也是 32 位环境。在提供者列表中找不到提供者的原因是它只显示 32 位数据提供者。您只能在开发机器上看到具有 32 位版本的 64 位提供程序。

# android - Android：onBackPressed() 用于片段中的 Web 视图

> ID：15621907
> 
> 赞同：0
> 
> 时间：2013-03-25T18:17:20.683
> 
> 标签：android, webview, gps, fragment

我是一个相对较新的 Android 开发人员，目前正在完成我的第一个 Android 应用程序。

此应用程序是 Web 应用程序的“外壳”应用程序，它使用片段，但我有两个问题。我进行了广泛的研究，但我找不到任何我发现可行的想法，所以我希望我能在这里得到一些答案。先感谢您！

1) 我希望用户能够使用他们设备上的后退按钮返回 web 视图

2）我正在尝试从类中的方法传递 GPS 纬度和经度，从变量 myLongitude 和 myLatitude

这是 MainActivity 的代码

```
public class MainActivity extends FragmentActivity implements ActionBar.TabListener
{
@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    //Without this, location is not fetched
    LocationManager mlocManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
    LocationListener mlocListener = new MyLocationListener();
    mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, mlocListener);
    //mlocManager.removeUpdates(mlocListener); // This needs to stop getting the location data and save the battery power.

    // Set up the action bar to show tabs.
    final ActionBar actionBar = getActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

    // For each of the sections in the app, add a tab to the action bar.
    actionBar.addTab(actionBar.newTab().setText("Browse").setTabListener(this));
    actionBar.addTab(actionBar.newTab().setText("My City").setTabListener(this));
    actionBar.addTab(actionBar.newTab().setText("Search").setTabListener(this));
    actionBar.addTab(actionBar.newTab().setText("Favs").setTabListener(this));
    actionBar.addTab(actionBar.newTab().setText("Help").setTabListener(this));
}

// The serialization (saved instance state) Bundle key representing the current tab position.
private static final String STATE_SELECTED_NAVIGATION_ITEM = "selected_navigation_item";

@Override
public void onRestoreInstanceState(Bundle savedInstanceState) 
{
    // Restore the previously serialized current tab position.
    if (savedInstanceState.containsKey(STATE_SELECTED_NAVIGATION_ITEM)) 
    {
        getActionBar().setSelectedNavigationItem(savedInstanceState.getInt(STATE_SELECTED_NAVIGATION_ITEM));
    }
}

@Override
public void onSaveInstanceState(Bundle outState)
{
    // Serialize the current tab position.
    outState.putInt(STATE_SELECTED_NAVIGATION_ITEM, getActionBar().getSelectedNavigationIndex());
}

@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

//Gets the Device ID
public String getDeviceId()
{
    final String androidId, deviceId;
    androidId = android.provider.Settings.Secure.getString(getContentResolver(), android.provider.Settings.Secure.ANDROID_ID);
    deviceId = androidId.toString();

    return deviceId;
}

public class MyLocationListener implements LocationListener
{
    Double myLatitude;  //This is passing a NULL value down to onTabSelected because it is not getting a value from onLocationChanged
    Double myLongitude; //This is passing a NULL value down to onTabSelected because it is not getting a value from onLocationChanged

    @Override
    public void onLocationChanged(Location loc)
    {
        myLatitude = loc.getLatitude();
        myLongitude = loc.getLongitude();

        String Text = "My current location is: " + "Latitude = " + myLatitude + "Longitude = " + myLongitude;
        Toast.makeText(getApplicationContext(), Text, Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onProviderDisabled(String provider)
    {
        Toast.makeText(getApplicationContext(), "Gps Disabled", Toast.LENGTH_SHORT ).show();
    }

    @Override
    public void onProviderEnabled(String provider)
    {
        Toast.makeText(getApplicationContext(), "Gps Enabled", Toast.LENGTH_SHORT).show();  
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras)
    {}

}

// When the given tab is selected, assign specific content to be displayed //
@Override
public void onTabSelected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction)
{
    Fragment fragment = new SectionFragment();
    Bundle args = new Bundle();

    final String deviceId = getDeviceId();

    MyLocationListener location = new MyLocationListener();

    final Double myLatitude = location.myLatitude; //This is returning a NULL value
    final Double myLongitude = location.myLongitude; //This is returning a NULL value   

    //Assigns a specific URL to "ARG_SECTION_URL" for each tab
    if(tab.getPosition()==0)
    {
        args.putString(SectionFragment.ARG_SECTION_URL, "http://www.myurl.com/countries.asp?Country=&State=&City=&Category=&Latitude=&Longitude=&ListingID=&AppId=aDG&DeviceID=" + deviceId + "&OrderBy=Name");         
    }
    else if(tab.getPosition()==1)
    {
        args.putString(SectionFragment.ARG_SECTION_URL, "http://www.myurl.com/landing.asp?Country=&State=&City=&Category=&Latitude=" + myLatitude + "&Longitude=" + myLongitude + "&ListingID=&AppId=aDG&DeviceID=" + deviceId + "&OrderBy=Name");          
    }
    else if(tab.getPosition()==2)
    {
        args.putString(SectionFragment.ARG_SECTION_URL, "http://www.myurl.com/searchform.asp?Latitude=&Longitude=&ListingID=&AppId=aDG&DeviceID=" + deviceId);
    }
    else if(tab.getPosition()==3)
    {
        args.putString(SectionFragment.ARG_SECTION_URL, "http://www.myurl.com/favorites.asp?Latitude=&Longitude=&ListingID=&AppId=aDG&DeviceID=" + deviceId + "&OrderBy=Name");
    }
    else if(tab.getPosition()==4)
    {
        args.putString(SectionFragment.ARG_SECTION_URL, "http://www.myurl.com/help.asp?Latitude=&Longitude=&ListingID=&AppId=aDG&DeviceID=" + deviceId);
    }

    fragment.setArguments(args);
    getSupportFragmentManager().beginTransaction().replace(R.id.container, fragment).commit();  
}

@Override
public void onTabUnselected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) 
{}

@Override
public void onTabReselected(ActionBar.Tab tab, FragmentTransaction fragmentTransaction) 
{}

@Override
public void onBackPressed() 
{

}

//A fragment representing a section of the app, but that simply displays content.
public static class SectionFragment extends Fragment 
{
    //The fragment argument representing the section number for this fragment.
    public static final String ARG_SECTION_URL = "section_url";

    public SectionFragment() 
    {}

    @SuppressLint("SetJavaScriptEnabled")
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) 
    {        
        //Create a new WebView and set its URL to the fragment's argument value.
        WebView myWebView = new WebView(getActivity());
        WebSettings webSettings = myWebView.getSettings();
        webSettings.setJavaScriptEnabled(true);
        myWebView.loadUrl(getArguments().getString(ARG_SECTION_URL));
        myWebView.setWebViewClient(new MyWebViewClient());
        myWebView.getSettings().setAppCacheEnabled(true);
        myWebView.getSettings().setDatabaseEnabled(true);
        myWebView.getSettings().setDomStorageEnabled(true);    
        return myWebView;
    }   

    private class MyWebViewClient extends WebViewClient 
    {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) 
        {
            view.loadUrl(url);
            return true;
        }

    }

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-19T10:10:45.277

我觉得这种方法更简单。

在`WebViewActivity.java`中，我添加了 1 个方法：

```
@Override
public void onBackPressed() {

    WebViewFragment fragment = (WebViewFragment)
            getSupportFragmentManager().findFragmentById(R.id.fragmentContainer);
    if (fragment.canGoBack()) {
        fragment.goBack();
    } else {
        super.onBackPressed();
    }
} 
```

在`WebViewFragment.java`中，我添加了 2 种方法：

```
public boolean canGoBack() {
    return mWebView.canGoBack();
}

public void goBack() {
    mWebView.goBack();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-06T16:33:47.033

我所做的是在活动中实现它，然后有一个公共静态，所以：

在主要活动中：

公共类 MainActivity 扩展 FragmentActivity{ 公共静态 WebView myWebView; ...

```
@Override
public void onBackPressed() {
    if (getSupportFragmentManager().findFragmentByTag("yourtag") != null) {
        if(myWebView.canGoBack())
            myWebView.goBack();
        else {
            super.onBackPressed();
        }
    }
    else
        super.onBackPressed();
}
... 
```

并在片段中引用它：

```
MainActivity.myWebView = (WebView) getView().findViewById(R.id.webview); 
```

并确保在创建片段时添加标签

```
transaction.replace(R.id.yourfragid, newfragment, "yourtag"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-28T08:33:19.810

1.  使用 WebView 在 Snippet 中实现 View.OnKeyListener ；

    ```
    public class ItemMenuFragment extends Fragment implementsView.OnKeyListener 
    ```

2.  将 onKeyListener 监听器连接到 WebView；

    ```
    webView.setOnKeyListener(this); 
    ```

3.  重写 OnKeyListener.onKey 方法；

    ```
    @Override
    public boolean onKey(View v, int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_BACK && event.getAction() == MotionEvent.ACTION_UP && webView.canGoBack()) {
            webView.goBack();
            return true;
        }
        return false;
    } 
    ```

# android - Android：ListView在方向改变后不加载项目

> ID：15621920
> 
> 赞同：0
> 
> 时间：2013-03-25T18:18:12.947
> 
> 标签：android, android-listview

**编辑 - 请先阅读！**

事实证明，我犯了一个非常愚蠢的错误。我的布局包含一个与*ListView*具有完全相同背景颜色的*WebView*。*WebView*在活动加载后的某个时间点被隐藏，但我忘记在方向更改后隐藏它，所以它覆盖了*ListView*并使它看起来像是空的，而实际上它已正确加载。我将把这个问题留在这里，因为它提供了一个关于如何在方向更改后恢复*ListView*数据的工作示例：)

 *****---------------------------------**

嗯，这在当时似乎很容易。我正在尝试在方向更改后恢复 ListView 上的数据。数据是从 Web 服务中获取的，所以起初我只是在更改发生后调用 Web 服务。这工作正常，但是对于如此简单的情况，重新获取数据太慢了，所以我想我宁愿保存 ListView 的状态，然后直接恢复它而不必返回服务器。

我正在使用*onSaveInstanceState*执行此操作：

```
protected void onSaveInstanceState (Bundle outState) {
    ListAdapter adapter = this.listView.getAdapter();

    if (adapter != null) {
        try {
            String dataSource = ((JSONArrayAdapter)adapter).getDataSource().toString(1);
            outState.putString("dataSource", dataSource);
        } catch (Exception e) {
            Log.w("MainActivity", "Invalid data adapter", e);
        }
    }
} 
```

*JSONArrayAdapter*是我正在使用的自定义适配器，它使用*JSONArray*对象作为其数据源。我知道它可以工作，因为它在方向改变之前正确显示了所有内容。

将 ListView 数据保存为 JSON 字符串后，我尝试使用*onCreate*恢复它：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    listView = (ListView)findViewById(R.id.listView);
    progressBar = (ProgressBar)findViewById(R.id.progressBar);

    String dataSource = null;
    if (savedInstanceState != null) {
        dataSource = savedInstanceState.getString("dataSource");
    }

    if (dataSource == null) {
        reloadList(); //this is a call to the web service
    } else {
        try {
            JSONArray array = new JSONArray(dataSource);

            this.listView.setAdapter(new JSONArrayAdapter(getApplicationContext(), array));
            this.progressBar.setVisibility(View.GONE);
        } catch (JSONException e) {
            Log.w("MainActivity", "Invalid data adapter", e);
            reloadList();
        }
    }
} 
```

结果是我翻转了设备并且没有错误，但是 ListView 是空的（或者它的项目至少是不可见的）。使用调试器，我已验证 JSON 字符串是否正确存储。我什至通过适配器上的*getView*方法来确保正确生成视图。还值得注意的是，代码没有进入任何 catch 块。有谁知道是什么导致 ListView 为空？谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-25T19:06:40.677

在应用程序的清单文件中声明[android:configChanges](http://developer.android.com/guide/topics/manifest/activity-element.html)并在[onConfigurationChanged](http://developer.android.com/reference/android/app/Activity.html#onConfigurationChanged%28android.content.res.Configuration%29)中执行您想要更改屏幕方向的操作。

[您可以在此处](https://stackoverflow.com/questions/2902886/changing-orientation-losing-all-my-list-items)找到更详细的讨论。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-25T19:09:51.743

也许 ：

```
protected void onSaveInstanceState (Bundle outState) {
    super.onSaveInstanceState(outState);
    // same as you do
} 
```***

# javascript - flexslider 上的数据轮播

> ID：15621929
> 
> 赞同：0
> 
> 时间：2013-03-25T18:18:39.927
> 
> 标签：javascript, jquery, carousel, flexslider

我用 flexslider 制作了一个旋转木马，但是我遇到了问题。我的页面上有 10 多个轮播。每个轮播都有自己的类。

这是html：

```
<div class="box-product-details hide" data-carousel="1">
    <div class="container">
        <div class="product-carousel">
            <ul>
                <li><img src="../images/product-detail.jpg" height="338" width="430" alt="" /></li>
                <li><img src="../images/product-detail.jpg" height="338" width="430" alt="" /></li>
                <li><img src="../images/product-detail.jpg" height="338" width="430" alt="" /></li>
            </ul>
        </div><!-- /product-carousel -->
    </div><!-- /container -->
</div><!-- /box-product-details -->
<div class="box-product-details hide" data-carousel="2">
    <div class="container">
        <div class="product-carousel">
            <ul>
                <li><img src="../images/product-detail.jpg" height="338" width="430" alt="" /></li>
                <li><img src="../images/product-detail.jpg" height="338" width="430" alt="" /></li>
                <li><img src="../images/product-detail.jpg" height="338" width="430" alt="" /></li>
            </ul>
        </div><!-- /product-carousel -->
    </div><!-- /container -->
</div><!-- /box-product-details --> 
```

唯一的区别是盒子产品 div 上的数据轮播属性。

**现在我的问题** 是我怎样才能分开开始轮播。与盒子产品上的轮播属性。我怎样才能分开这个轮播。这是我的javascript。

```
$('.product-carousel').flexslider({
     namespace: "carousel-",
     animation: 'fade',
     selector: 'ul > li',
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T03:43:37.077

如果你能做到：

```
$('.product-carousel').each(function() {
  var sliderCarousel = $(this).closest('.box-product-details').data('carousel');
  $(this).flexslider({
    // flexslider options and you can use sliderCarousel in here.
  });
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-25T18:32:05.503

```
 $('.box-product-details[data-carousel="2"]').flexslider({
     namespace: "carousel-",
     animation: 'fade',
     selector: 'ul > li',
 }); 
```

或者如果已经实例化

```
$('.box-product-details[data-carousel="2"]').play() ; 
```

html 5 数据属性的文档：

[http://html5doctor.com/html5-custom-data-attributes/](http://html5doctor.com/html5-custom-data-attributes/)

[http://api.jquery.com/data/](http://api.jquery.com/data/)

# android - 在android中使用onBackPressed

> ID：15621931
> 
> 赞同：0
> 
> 时间：2013-03-25T18:18:43.573
> 
> 标签：android, android-intent, android-activity, start-activity

我正在做一个`android application`到目前为止已经超过 8 个的项目`activities`。我需要了解后退按钮在 android 中的行为。因为我需要覆盖它并在按下它时执行一些操作。当按下后退按钮时，android 会查找跟踪文件并转到您来自当前活动的活动。但是，在我的应用程序中，您可以从其他几个活动转到一个活动。而且我应该知道我从哪里来的这个活动，以便我可以决定是否应该覆盖`onBackPressed`方法。但我不想通过携带一些参数来做到这一点，比如`putExtra`and `startActivity`。有没有更好的方法来处理这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:36:32.360

肯定会覆盖 onbackpressed 并使用意图来遍历您想要移动的任何类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:33:24.210

您可以通过调用找出启动此活动的活动`getCallingActivity ()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T18:26:27.640

您可以尝试做一个 BaseActivity 并将您的自定义逻辑放在那里。

您的所有 8 个活动都将扩展具有自定义行为的 BaseActivity。

从该 BaseActivity 中，您可以根据您要发送的自定义变量在 onBackPressed 中执行您想要的任何逻辑。

我不建议永远覆盖 onBackPressed。检查其他生命周期方法：onPause 或 onDestroy。

如果您想做自定义导航之类的操作，则应改为检查 ActionBar goUp。

# php - 使用适用于 PHP 的开发工具包制作一致的 Amazon EBS 快照的正确方法是什么？

> ID：15621934
> 
> 赞同：2
> 
> 时间：2013-03-25T18:18:52.900
> 
> 标签：php, amazon-web-services, amazon-ec2, snapshot, amazon-ebs

我是 Amazon Web Services (AWS) 的新手，想使用[AWS SDK for PHP创建一个](http://aws.amazon.com/sdkforphp/)[Amazon Elastic Block Store (EBS)](http://aws.amazon.com/ebs/)快照。我写了以下代码：

```
 $aws = Aws::factory($config);
    $ec2 = $aws->get('Ec2');    
    $ec2->createSnapshot( array('VolumeId'=>'vol-11c22825','Description'=>'My Description') ); 
```

快照创建正确，但我担心数据完整性。有没有更好的方法来使用 PHP SDK 创建一致的快照？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T20:32:12.913

如果你想完全一致，你需要冻结文件系统。如果您在本地运行脚本，则可以这样做，但如果远程运行，您可能需要通过 ssh 发出命令。

您可能对此感兴趣：[https ://github.com/alestic/ec2-consistent-snapshot](https://github.com/alestic/ec2-consistent-snapshot)

# jasper-reports - 在 JR 3.1.4 上成功运行的饼图不显示 JR 5.0.1 中的数据

> ID：15621935
> 
> 赞同：0
> 
> 时间：2013-03-25T18:18:55.857
> 
> 标签：jasper-reports, ireport

我正在使用*iReport*显示一个包含 6 个不同字段的饼图。我使用*3.1.4*是因为它与*Bizflow Advreport*兼容。在*iReport 3.1.4*中预览图表时，饼图/图例/标题都正确显示。但是，当我把它放在网站上时，它只显示标题。将文件带入*5.0.1*没有任何显示，就像它在网站上所做的一样。

我试图弄乱条带的边距和大小，但我似乎无法正确显示饼图。

我还附上了我从*3.1.4*收到的两个不同的预览：

![3.1.4](../Images/89497ef66f77d31443288e19ed81df9f.png)

另一个来自 5.0.1：

![5.0.1](../Images/421709b5a85b83f5dde4e746ef4b498d.png)

这里还有*jrxml*文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="380" pageHeight="300" columnWidth="380" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
    <queryString>
        <![CDATA[Select CapabilityAreaName , SUM(ProjectedDevelopmentCost) as TotalProjectedDevelopmentCost, ROUND(100*SUM(ProjectedDevelopmentCost)/(SELECT SUM(ProjectedDevelopmentCost) FROM RequirementFunding),2)AS percentOfTotal
FROM Requirement
INNER JOIN CapabilityArea
ON Requirement.CapabilityAreaId = CapabilityArea.CapabilityAreaId
INNER JOIN RequirementFunding
ON Requirement.RequirementId = RequirementFunding.RequirementId
GROUP BY CapabilityAreaName]]>
    </queryString>
    <field name="CapabilityAreaName" class="java.lang.String">
        <fieldDescription><![CDATA[]]></fieldDescription>
    </field>
    <field name="TotalProjectedDevelopmentCost" class="java.lang.Double">
        <fieldDescription><![CDATA[]]></fieldDescription>
    </field>
    <field name="percentOfTotal" class="java.lang.Double">
        <fieldDescription><![CDATA[]]></fieldDescription>
    </field>
    <background>
        <band/>
    </background>
    <title>
        <band height="50">
            <staticText>
                <reportElement x="0" y="12" width="380" height="25"/>
                <textElement textAlignment="Center">
                    <font size="14" isBold="true"/>
                </textElement>
                <text><![CDATA[Project Development Cost By Capability Area]]></text>
            </staticText>
            <line>
                <reportElement x="0" y="49" width="380" height="1"/>
            </line>
            <line>
                <reportElement x="0" y="0" width="380" height="1"/>
            </line>
        </band>
    </title>
    <columnHeader>
        <band height="250">
            <pieChart>
                <chart hyperlinkType="Reference">
                    <reportElement x="0" y="0" width="380" height="250"/>
                    <chartTitle/>
                    <chartSubtitle/>
                    <chartLegend/>
                </chart>
                <pieDataset>
                    <keyExpression><![CDATA[$F{CapabilityAreaName}]]></keyExpression>
                    <valueExpression><![CDATA[$F{TotalProjectedDevelopmentCost}]]></valueExpression>
                    <labelExpression><![CDATA[$F{percentOfTotal}.toString() + "% - $" + $F{TotalProjectedDevelopmentCost}]]></labelExpression>
                    <sectionHyperlink hyperlinkType="Reference">
                        <hyperlinkReferenceExpression><![CDATA["http://ess-bizflow:8080/bizflowadvreport/flow.html?_flowId=reportTinkerViewReportFlow&reportUnit=/reports/standard_reports/IR_D/AMOD/ActiveRequirementsCostTimeBreakdownTable&&CASelected=" + $F{CapabilityAreaName}]]></hyperlinkReferenceExpression>
                    </sectionHyperlink>
                </pieDataset>
                <piePlot>
                    <plot/>
                </piePlot>
            </pieChart>
        </band>
    </columnHeader>
</jasperReport> 
```

有谁知道可能导致此问题的原因。如果需要，我也可以提供文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T05:59:00.080

从 XML 看来，您已将饼图放在`<columnhearder>`带中尝试将图表放在`<summary>`带中。

```
<columnHeader>
    <band height="250">
        <pieChart>
            <chart hyperlinkType="Reference">
                <reportElement x="0" y="0" width="380" height="250"/>
                <chartTitle/>
                <chartSubtitle/>
                <chartLegend/>
            </chart>
            <pieDataset>
                <keyExpression><![CDATA[$F{CapabilityAreaName}]]></keyExpression>
                <valueExpression><![CDATA[$F{TotalProjectedDevelopmentCost}]]></valueExpression>
                <labelExpression><![CDATA[$F{percentOfTotal}.toString() + "% - $" + $F{TotalProjectedDevelopmentCost}]]></labelExpression>
                <sectionHyperlink hyperlinkType="Reference">
                    <hyperlinkReferenceExpression><![CDATA["http://ess-bizflow:8080/bizflowadvreport/flow.html?_flowId=reportTinkerViewReportFlow&reportUnit=/reports/standard_reports/IR_D/AMOD/ActiveRequirementsCostTimeBreakdownTable&&CASelected=" + $F{CapabilityAreaName}]]></hyperlinkReferenceExpression>
                </sectionHyperlink>
            </pieDataset>
            <piePlot>
                <plot/>
            </piePlot>
        </pieChart>
    </band>
</columnHeader> 
```

尝试这个：-

```
 <?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="380" pageHeight="300" columnWidth="380" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
<property name="ireport.zoom" value="1.0"/>
<property name="ireport.x" value="0"/>
<property name="ireport.y" value="0"/>
<queryString>
    <![CDATA[Select CapabilityAreaName , SUM(ProjectedDevelopmentCost) as  
             TotalProjectedDevelopmentCost, 
             ROUND(100*SUM(ProjectedDevelopmentCost)/(SELECT 
        SUM(ProjectedDevelopmentCost) FROM RequirementFunding),2)AS percentOfTotal
      FROM Requirement
      INNER JOIN CapabilityArea
      ON Requirement.CapabilityAreaId = CapabilityArea.CapabilityAreaI d
      INNER JOIN RequirementFunding
      ON Requirement.RequirementId = RequirementFunding.RequirementId
     GROUP BY CapabilityAreaName]]>
</queryString>
<field name="CapabilityAreaName" class="java.lang.String">
    <fieldDescription><![CDATA[]]></fieldDescription>
</field>
<field name="TotalProjectedDevelopmentCost" class="java.lang.Double">
    <fieldDescription><![CDATA[]]></fieldDescription>
</field>
<field name="percentOfTotal" class="java.lang.Double">
    <fieldDescription><![CDATA[]]></fieldDescription>
</field>
<background>
    <band/>
</background>
<title>
    <band height="50">
        <staticText>
            <reportElement x="0" y="12" width="380" height="25"/>
            <textElement textAlignment="Center">
                <font size="14" isBold="true"/>
            </textElement>
            <text><![CDATA[Project Development Cost By Capability Area]]></text>
        </staticText>
        <line>
            <reportElement x="0" y="49" width="380" height="1"/>
        </line>
        <line>
            <reportElement x="0" y="0" width="380" height="1"/>
        </line>
    </band>
</title>
<summary>
    <band height="300">
        <pieChart>
            <chart hyperlinkType="Reference">
                <reportElement x="14" y="15" width="348" height="270"/>
                <chartTitle/>
                <chartSubtitle/>
                <chartLegend/>
            </chart>
            <pieDataset>
                <keyExpression><![CDATA[$F{CapabilityAreaName}]]></keyExpression>
                <valueExpression><![CDATA[$F{TotalProjectedDevelopmentCost}]]></valueExpression>
                <labelExpression><![CDATA[$F{percentOfTotal}.toString() + "% - $" + $F{TotalProjectedDevelopmentCost}]]></labelExpression>
                <sectionHyperlink hyperlinkType="Reference">
                    <hyperlinkReferenceExpression><![CDATA["http://ess-bizflow:8080/bizflowadvreport/flow.html?_flowId=reportTinkerViewReportFlow&reportUnit=/reports/standard_reports/IR_D/AMOD/ActiveRequirementsCostTimeBreakdownTable&&CASelected=" + $F{CapabilityAreaName}]]></hyperlinkReferenceExpression>
                </sectionHyperlink>
            </pieDataset>
            <piePlot>
                <plot/>
                <itemLabel/>
            </piePlot>
        </pieChart>
    </band>
</summary> 
```

# android - 什么是懒惰列表？

> ID：15621936
> 
> 赞同：21
> 
> 时间：2013-03-25T18:19:01.957
> 
> 标签：android, lazylist

我无法在任何真正可靠的来源中找到解释 LazyList 是什么。任何人？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-03-25T18:44:30.487

**延迟列表**是从 sd 卡或使用 url 的服务器延迟加载图像。这就像按需加载图像。

图像可以缓存到本地 sd 卡或手机内存中。URL 被认为是关键。如果密钥存在于 sd 卡中，则从 sd 卡中显示图像，否则它会从服务器下载图像并将其缓存到您选择的位置。您可以设置缓存限制。您还可以选择自己的位置来缓存图像。缓存也可以清除。

与用户等待下载大图像然后显示它们不同，惰性列表按需加载图像。由于图像被缓存，您可以离线显示图像。

[https://github.com/thest1/LazyList](https://github.com/thest1/LazyList)。懒惰列表

在你的 getview

```
imageLoader.DisplayImage(imageurl, imageview); 
```

ImageLoader 显示方法

```
 public void DisplayImage(String url, ImageView imageView) //url and imageview as parameters
    {
    imageViews.put(imageView, url);
    Bitmap bitmap=memoryCache.get(url);   //get image from cache using url as key
    if(bitmap!=null)         //if image exists
        imageView.setImageBitmap(bitmap);  //display iamge
     else   //downlaod image and dispaly. add to cache.
     {
        queuePhoto(url, imageView);
        imageView.setImageResource(stub_id);
     }
   } 
```

惰性列表的替代方法是通用图像加载器

[https://github.com/nostra13/Android-Universal-Image-Loader](https://github.com/nostra13/Android-Universal-Image-Loader)。它基于惰性列表（它的工作原理相同），但它有很多其他配置。我更喜欢使用****Universal Image Loader****，因为它为您提供了更多配置选项。如果下载失败，它会显示错误图像。它可以显示带有圆角的图像。它可以缓存在磁盘或内存上。它可以压缩图像。

在您的自定义适配器构造函数中

```
 File cacheDir = StorageUtils.getOwnCacheDirectory(a, "your folder");

 // Get singletone instance of ImageLoader
 imageLoader = ImageLoader.getInstance();
 // Create configuration for ImageLoader (all options are optional)
 ImageLoaderConfiguration config = new ImageLoaderConfiguration.Builder(a)
          // You can pass your own memory cache implementation
         .discCache(new UnlimitedDiscCache(cacheDir)) // You can pass your own disc cache implementation
         .discCacheFileNameGenerator(new HashCodeFileNameGenerator())
         .enableLogging()
         .build();
 // Initialize ImageLoader with created configuration. Do it once.
 imageLoader.init(config);
 options = new DisplayImageOptions.Builder()
.showStubImage(R.drawable.stub_id)//display stub image
.cacheInMemory()
.cacheOnDisc()
.displayer(new RoundedBitmapDisplayer(20))
.build(); 
```

在你的 getView()

```
 ImageView image=(ImageView)vi.findViewById(R.id.imageview); 
  imageLoader.displayImage(imageurl, image,options);//provide imageurl, imageview and options 
```

您可以使用其他选项配置 Universal Image Loader 以满足您的需求。

与 LazyList/Universal Image Loader 一起，您可以查看此网站以获得平滑滚动和性能。 [http://developer.android.com/training/improving-layouts/smooth-scrolling.html](http://developer.android.com/training/improving-layouts/smooth-scrolling.html)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-25T18:28:09.937

AFAIK，我将通过示例向您解释如果您的列表包含大量带有文本的图像，则加载列表需要一些时间，因为您需要下载图像并且需要将它们填充到列表中。假设您的列表包含 100 张图片，下载每张图片并显示列表项将花费大量时间。让用户等到图像加载对用户不友好。所以我们需要做什么。此时，惰性列表出现了。这是让图像在后台加载并显示文本的想法。

每个人都知道 listview 为每个视图回收它的视图。即，如果您的列表视图包含 40 个元素，那么列表视图不会为 40 个项目分配内存，而是为可见项目分配内存，也就是说，您一次只能看到 10 个项目。所以 listview 将分配 10 个项目的内存。

因此，当您滚动视图时，视图将刷新。因为您将失去对图像的引用，您需要重新下载它们。为了避免这种情况，缓存出现了。

这个例子是基于我在 listview 中的知识，我并不是说这只是正确的。答案可能有误，如果有人发现请随时通知我。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-25T18:21:52.873

我认为这是相反的。AFAIK，[延迟加载](http://en.wikipedia.org/wiki/Lazy_loading)是定义，只有在需要时才实际加载数据，这是一个很好的设计实践。

所以我相信这同样适用，只是这次它指的是列表视图。

如果我错了，请纠正我。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-25T18:27:54.270

惰性列表的最佳示例是 facebook 通知、消息、请求。当您滚动时，将加载数据。

# iphone - Xcode 错误：枚举器“MJPopupViewAnimation”的重新定义

> ID：15621943
> 
> 赞同：0
> 
> 时间：2013-03-25T18:19:25.793
> 
> 标签：iphone, xcode, include

我正在尝试集成到 MJPopupViewAnimation，以便我的应用程序中的一些页面。但似乎您不能在超过 1 个文件中定义函数。我得到的错误是：

枚举器“MJPopupViewAnimationFade”的重新定义 枚举器“MJPopupViewAnimationSlideBottomTop”的重新定义 枚举器“MJPopupViewAnimationSlideBottomBottom”的重新定义

等等...

有人可以解释为什么我不能在超过 1 页中使用它吗？

/大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:13:45.173

I'm not familiar with MJPopupViewAnimation, but copy-pasting the code into your app in multiple places is not the best thing to do (you can probably make it work, but it's not ideal).

As per the instructions on [GitHub](https://github.com/martinjuhasz/MJPopupViewController), you should:

1.  Add the MJPopupViewController source files to your project
2.  In the files where you wish to use the animation, import the category:

`#import "UIViewController+MJPopupViewController.h"`

Then you can go ahead and use the animations:

```
[self presentPopupViewController:detailViewController animationType:MJPopupViewAnimationFade];
[self dismissPopupViewControllerWithanimationType:MJPopupViewAnimationFade]; 
```

# java - UrlConnection.getHeaderField(string name) 返回 null

> ID：15621944
> 
> 赞同：2
> 
> 时间：2013-03-25T18:19:33.557
> 
> 标签：java, http, http-headers

处理 URlconnection 问题

连接对象是通过在 URL 上调用 openConnection() 方法创建的，并且对一般请求进行操作。然后我初始化了一个字符串，我期望函数 getHeaderfield(string name) 有一个 uniqueid。之后，我需要使用 connect() 方法执行与远程对象的实际连接

```
 call for openConnection()
   String uniqueid=null;
   call for connect()
   uniqueid=UrlConnection.getHeaderField(Headername); 
```

在这里，我将 uniqueid 的值设为空。

当我研究主题时，我知道实际函数 getHeaderField(string) 仅返回 null（在 java.net.UrlConection.class 下的 java 包中的 rt.jar 中找到）。

但是 oracle 文档说 [http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLConnection.html#getHeaderField%28java.lang.String%29](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLConnection.html#getHeaderField%28java.lang.String%29) 它返回命名的值标题。谁能解释 getHeaderField()method 的行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T18:28:29.110

java.net 中的 UrlConnection 是抽象的，因此您正在使用的 UrlConnection 可能是一个子类（可能是匿名的）。

尝试使用 .getClass() 将 UrlConnection 的类名打印到您实际使用的内容，然后查看该文档。

至于为什么你得到空值，我猜你提供的 headerName 与标题中的任何内容都不匹配。尝试使用 .getHeaderFields() 获取所有标题的映射并打印 keySet() 以查看您的标题是否在其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-05T00:09:12.633

如果没有移动数据或 WiFi 连接，getHeaderFields() 可能会返回 null。

# .net - 带有 .NET 超媒体框架的 REST

> ID：15621954
> 
> 赞同：1
> 
> 时间：2013-03-25T18:20:26.373
> 
> 标签：.net, rest, asp.net-web-api, servicestack, hateoas

[想要开始一个 Web API 项目并想知道（两个？）框架中的哪一个可以让我在Richardson 成熟度模型](http://martinfowler.com/articles/richardsonMaturityModel.html)中以最少的摩擦走得更远。

也许是一个 HOWTO 的链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T18:31:36.983

您可以在几乎所有现有的面向 HTTP 的框架（如 ASP.NET Web API、NancyFX 或 ServiceStack 等）中应用 Richardson 提到的许多实践。这是我写的一篇文章，描述了如何使用 ASP.NET Web API 构建超媒体服务

[http://msdn.microsoft.com/en-us/magazine/jj883957.aspx](http://msdn.microsoft.com/en-us/magazine/jj883957.aspx)

# xamarin.ios - 如何通过 MVVMcross 中的绑定将视图模型中的更改反映到 tableviewcell 视图

> ID：15621956
> 
> 赞同：1
> 
> 时间：2013-03-25T18:20:27.177
> 
> 标签：xamarin.ios, mvvmcross

在`MvxBindableTableViewCell`. 我在 iOS 上使用 MvvmCross 的 vNext 分支。

一切都已正确设置，并且在首次加载/显示列表时可以看到初始值。该列表是 a`ObservableCollection<T>`并且 ViewModels 继承自`MvxViewModel`（因此实现了 INotifyPropertyChanged）。

主视图模型如下所示：

```
public abstract class BaseViewModel : MvxViewModel, IMvxServiceConsumer
{
    //... just regular implementation
}

public class UploadListViewModel: BaseViewModel
{
    private readonly IUploadItemTasks uploadItemTasks;
    private readonly IPhotoPickerService photoPickerService;

    public IObservableCollection<UploadItemViewModel> Uploads { get { return this.LoadUploadItems(); }  }

    public UploadListViewModel()
    {
        this.uploadItemTasks = this.GetService<IUploadItemTasks>();
        this.photoPickerService = this.GetService<IPhotoPickerService>();
    }

    private IObservableCollection<UploadItemViewModel> LoadUploadItems()
    {
        using (var unitOfWork = UnitOfWork.Start ())
        {
            return new SimpleObservableCollection<UploadItemViewModel>(uploadItemTasks.GetAll());
        }
    }

    public void StartUpload ()
    {
        if (this.Uploads == null || this.Uploads.Count == 0) {
            ReportError("Error", "No images to upload");
            return;
        }

        this.Uploads.ForEach (uploadItem => PostCallback (uploadItem));
    }

    private void PostCallback (UploadItemViewModel uploadAsset)
    {
        IProgressReporter progressReporter = uploadAsset;

        this.photoPickerService.GetAssetFullImage(uploadAsset.ImageUrl,
                                                  (image) => {
            UIImage fullImage = image;
            NSData jpeg = fullImage.AsJPEG();

            byte[] jpegBytes = new byte[jpeg.Length];           
            System.Runtime.InteropServices.Marshal.Copy(jpeg.Bytes, jpegBytes, 0, Convert.ToInt32(jpeg.Length));

            MemoryStream stream = new MemoryStream(jpegBytes);
            Uri destinationUrl = new Uri(uploadAsset.DestinationUrl + "&name=" + uploadAsset.Name + "&contentType=image%2FJPEG");

            //TO DO: Move this to plugin
            var uploader = new Uploader().UploadPicture (destinationUrl, stream, UploadComplete, progressReporter);
            uploader.Host = uploadAsset.Host;

            ThreadPool.QueueUserWorkItem (delegate {
                uploader.Upload ();                 
                jpeg = null;
            });
        });
    }

    private void UploadComplete (string name)
    {
        if (name == null){
            ReportError("Error","There was an error uploading the media.");
        } else 
        {
            //ReportError("Succes", name);
        }
    } 
```

项目 ViewModel 看起来像：

```
public interface IProgressReporter
{
    float Progress { get; set;} 
}

public abstract class BaseAssetViewModel: BaseViewModel, IBaseAssetViewModel
{
    //... just regular properties 
}

public class UploadItemViewModel: BaseAssetViewModel, IProgressReporter
{
    public UploadItemViewModel(): base()
    {
    }

    private float progress;
    public float Progress {
        get {
            return this.progress;
        }
        set {
            this.progress = value;
            this.RaisePropertyChanged(() => Progress);
        }
    }
} 
```

项目的视图继承自`MvxBindableTableViewCell`并具有以下属性：

```
private float progress;
public float ProgressMarker {
    get {
        return progress;
    }
    set {
        progress = value;
        // change progressbar or textfield here
    }
} 
```

tableviewcell`UploadItemViewModel`通过 BindingText 绑定到：

```
public const string BindingText = @"ProgressMarker Progress, Converter=Float;"; 
```

`Uploader`片段中提到的类`UploadListViewModel`实现了一个私有方法，该方法试图在 IProgressReporter 上设置进度。

```
 float progressValue;
    void SetProgress (float newvalue)
    {
        progressValue = newvalue;

        this.dispatcher.InvokeOnMainThread (delegate {
            if (ProgressReporter != null)
                ProgressReporter.Progress = progressValue;
        });
    } 
```

在第一次查看列表期间，我可以看到 ViewModel 和 View 中的属性都被命中，但是当我通过接口更新 ViewModel 时，tableviewcell`IProgressReporter`中的 View 中的新值`Progress`没有更新，也没有调用该属性.

我做错了什么或者我在这里错过了什么？

**更新：**检查这个问题的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T00:58:16.237

我找到了绑定不起作用的原因。我一遍又一遍地替换 ObservableCollection。我按照如下所述更改了那段代码，现在它反映了对单元格视图中的 UploadItemViewModel 所做的更改。

```
 private IObservableCollection<UploadItemViewModel> uploads;
    private IObservableCollection<UploadItemViewModel> LoadUploadItems()
    {
        if (uploads == null)
        {
            using (var unitOfWork = UnitOfWork.Start ())
            {
                uploads = new SimpleObservableCollection<UploadItemViewModel>(uploadItemTasks.FindAll());
            }
        }
        return uploads;
    } 
```

# javascript - 脚本加载未在 Android 中触发

> ID：15621960
> 
> 赞同：1
> 
> 时间：2013-03-25T18:21:04.407
> 
> 标签：javascript, android, jquery, script-tag

我正在尝试有条件地加载 jQuery，并且在 android 设备上运行我的应用程序时未调用 onload 函数。它确实适用于 Chrome 和 iPhone。

```
 if (!window.jQuery) { 
        var jqscript   = document.createElement("script");
        jqscript.type  = "text/javascript";
        jqscript.src   = "js/lib/jQuery.js";
        document.body.appendChild(jqscript);
        jqscript.onload = jqLoaded;
    } 
```

.

```
function jqLoaded(){
    jQuery.noConflict();
    alert('jqueryloaded');
} 
```

我可能会忘记条件加载，但是有什么理由不应该工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-27T20:59:59.223

改变你的

```
document.body.appendChild(jqscript); 
```

至

```
document.getElementsByTagName('head')[0].appendChild(jqscript); 
```

# c++ - 访问模板构造函数和函数，包括静态和非静态的

> ID：15621963
> 
> 赞同：0
> 
> 时间：2013-03-25T18:21:19.237
> 
> 标签：c++, templates, static

我是模板新手，发现这件事相当混乱。我有一个模板类，用作将实体映射到字符串的表，我的类代码是这样的

```
template<class GENERIC_ENTITY> class EntityTable
{
private:

    map<wstring, GENERIC_ENTITY*> entityTable;

    // I want to put init in the default constructor so it gets initialized, but this doesn't compile 
    EntityTable<GENERIC_ENTITY>::EntityTable () {
        init();
    }

    void init()
    {
            entityTable[L"Entity1"] = new Entity1();
            entityTable[L"Entity2"] = new Entity2();
            entityTable[L"Entity3"] = new Entity3();
    }

public:

    // This function doesn't compile unless I remove the keyword static
    static template <class GENERIC_ENTITY> GENERIC_ENTITY retriveEntity(wstring identifier)
    {
        return entityTable[identifier];
    }
}; 
```

然后我想在另一个类中调用这个模板函数并使用`wstring`标识符检索相应的实体。但不幸的是，我既不能构造类也不能调用这个函数，不管函数是否是静态的。它甚至不编译。

如果函数是静态的，我想做类似的事情`EntityTable<T>::retriveEntity(wstring)`，如果不是静态的，我想先实例化它，但我不知道如何用模板来做，因为我听说模板不是一个类。我将它声明为堆栈上的实际数据，因此我不必在我不知道它是什么样的构造函数上调用 new，但我仍然无法访问该函数。

我完全糊涂了，有人可以帮我解决一下吗？

**编辑：**

顺便说一句，我在另一个类中声明这个模板的方式是`template<class GENERIC_BOT> EntityTable entityTable;`. 不确定这是否正确

所有实体类都继承自两个公共类（纠正了一个的错误）但这些类是抽象的，所以我不能通过做类似的事情来实例化它`Entity retrieveEntity(wstring info)`

我希望这个类是一种单例，在它被初始化的地方构造一次，并在任何地方调用静态函数。地图在构建后是不可变的。`wstring`传递给模板，模板将返回与该`wstring`标签关联的相应类。我只需要一种快速的检索方式，考虑到桌子很大的情况，为了方便，我只显示了两个项目。

PS 我知道我也可以使用 if 或 switch 语句返回相应的类型，但这既长又麻烦，并且违背了使用地图的目的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:16:49.580

这应该编译得很好：

```
template<class GENERIC_ENTITY> class EntityTable
{
private:

    map<wstring, GENERIC_ENTITY*> entityTable;

    EntityTable::EntityTable () {
        init();
    }

    void init()
    {
            entityTable[L"Entity1"] = new Entity1();
            entityTable[L"Entity2"] = new Entity2();
            entityTable[L"Entity3"] = new Entity3();
    }

public:

    GENERIC_ENTITY* retriveEntity(wstring identifier)
    {
        return entityTable[identifier];
    }
}; 
```

如果您希望它是静态的，只需应用单例模式或将 entityTable 声明为静态。但是，在这种情况下，不应该有任何构造函数可用，并且 init() 也必须是静态的，并且在代码中的某个位置调用。单例将保证 init() 只被调用一次。

# windows - Git 初始推送到网络驱动器上的新仓库失败

> ID：15621966
> 
> 赞同：8
> 
> 时间：2013-03-25T18:21:24.783
> 
> 标签：windows, git, repository, push

你能帮我理解为什么我的简单启动项目不起作用吗？我使用的是 Windows XP，从 Git-1.8.1.2-preview20130201.exe 安装了 Git。我正在使用安装时提供的 Git Bash。

在网络驱动器上，我执行以下操作：

```
cd /k/repos
mkdir LV_Libraries.git
cd LV_Libraries.git
git init --bare 
```

在我的项目本地副本中：

```
git init
git add *
git commit -m "Initial Commit"
git remote add origin /k/repos/LV_Libraries.git
git push origin master 
```

推送失败说，

```
"remote: error: unable to write sha1 filename ./objects/pack/pack-b69cd03c4c ... .pak: Permission denied"
"Remote: fatal: cannot store pack file"
"Error: unpack failed: index-pack abnormal exit"
"To k:/repos/LV_Libraries.git
   !   [remote rejected] master -> master (unpacker error)" 
```

我最初认为这可能是文件权限的问题，但我通过终端向网络驱动器写入或读取文件没有问题。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-27T10:40:13.193

我删除了我的 git 存储库，然后用

```
git init --bare --shared 
```

这为我解决了这个问题。其他答案提到为共享和裸机设置配置，但我发现只有重新创建存储库才有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-22T18:20:01.977

我在尝试通过托管在 Mac OS X 机器上的 Samba 共享从 Windows 机器推送更改时遇到了这个问题。我通过在 Mac OS X 机器上初始化 SSH 服务器然后在 Windows 机器上通过 SSH 再次克隆项目来解决这个问题。因此，Windows 机器的所有后续推送都运行良好，没有任何错误。

当我通过适用于 Windows 的 Git GUI 签出项目时，我对存储库使用了以下语法：

```
ssh://username@machost_ip:full_path_to_project 
```

用户名是用于创建项目的用户名，`machost_ip`是我的局域网上 Mac OS X 机器的 IP 地址，是Git 项目 `full_path_to_project`的完全限定的 Unix 路径。`origin/master`

即使在更改组权限后，我也没有成功继续使用共享驱动器。虽然，我确信用户名可能是分配给组的用户的用户名，该用户具有对项目的写入权限，如先前答案中指定的那样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T19:42:30.507

听起来您遇到了与此问题[git: can't push (unpacker error) 有关的权限](https://stackoverflow.com/questions/4025708/git-cant-push-unpacker-error)问题类似的问题，即 k: 磁盘上的权限问题，可能与用户权限有关。

您是否检查过您在 K: 上的文件夹的 UNC 路径上拥有的确切权限？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-07T09:46:55.050

有你的 CRLF 设置吗？

在玩弄这些设置时，我设法生成了一个导致与您的问题相同的更改。最后，我创建了远程 repo 的新克隆，并将我的更改慢慢合并回它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-12T09:23:35.587

我昨天遇到了同样的错误。我只是想使用 Git Bash 2.9.2 将一个 Big Git 存储库克隆到我的本地 Windows 机器。

在花费大量时间并阅读上述答案之后。我以管理员身份运行 Git Bash，它就像一个魅力。我能够克隆存储库。不确定是什么问题，我想这很可能与许多人指出的权限有关。

# mongodb - 将对象推入 Mongoose 中的数组模式

> ID：15621970
> 
> 赞同：59
> 
> 时间：2013-03-25T18:21:33.523
> 
> 标签：mongodb, mongoose

我有这个猫鼬模式

```
var mongoose = require('mongoose');

var ContactSchema = module.exports = new mongoose.Schema({
  name: {
    type: String,
    required: true
  },
  phone: {
    type: Number,
    required: true,
    index: {unique: true}
  },
  messages: [
  {
    title: {type: String, required: true},
    msg: {type: String, required: true}
  }]
}, {
    collection: 'contacts',
    safe: true
}); 
```

并尝试通过这样做来更新模型：

```
Contact.findById(id, function(err, info) {
    if (err) return res.send("contact create error: " + err);

    // add the message to the contacts messages
    Contact.update({_id: info._id}, {$push: {"messages": {title: title, msg: msg}}}, function(err, numAffected, rawResponse) {
      if (err) return res.send("contact addMsg error: " + err);
      console.log('The number of updated documents was %d', numAffected);
      console.log('The raw response from Mongo was ', rawResponse);

    });
  }); 
```

我不是在声明`messages`要获取一组对象吗？
**错误：** MongoError：无法将 $push/$pushAll 修饰符应用于非数组

有任何想法吗？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2014-05-04T05:06:02.067

猫鼬在一次操作中为您完成此操作。

```
Contact.findByIdAndUpdate(
    info._id,
    {$push: {"messages": {title: title, msg: msg}}},
    {safe: true, upsert: true},
    function(err, model) {
        console.log(err);
    }
); 
```

请记住，使用此方法，您将无法使用模式的“pre”功能。

[http://mongoosejs.com/docs/middleware.html](http://mongoosejs.com/docs/middleware.html)

从最新的 mogoose findbyidandupdate 开始，需要添加一个“new : true”可选参数。否则，您会将旧文档退还给您。因此，Mongoose 版本 4.xx 的更新转换为：

```
Contact.findByIdAndUpdate(
        info._id,
        {$push: {"messages": {title: title, msg: msg}}},
        {safe: true, upsert: true, new : true},
        function(err, model) {
            console.log(err);
        }
    ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2021-02-10T08:38:05.897

有两种方法可以在数组中推送数据

第一种方式：

```
let newMessage = {title: "new title", msg: "new Message"}
let result = await Contact.findById(id);
result.messages.push(newMessage);
await result.save(); 
```

第二种方式

```
let result = await Contact.findByIdAndUpdate(
        id,
        {$push: {"messages": {title: title, msg: msg}}},
        {upsert: true, new : true}) 
```

# matlab - 联动算法后的聚类数据

> ID：15621971
> 
> 赞同：1
> 
> 时间：2013-03-25T18:21:33.937
> 
> 标签：matlab, statistics, hierarchical-clustering

我不是统计和数据分析方面的专家，因此我无法理解我获得的行为是否正确。我在这里寻求你的帮助。

假设我有这些我想聚类的样本（平面上的 10 个点 - 问题的简化版本）：

```
 [X Y] =

266   450
266   400
258   168
290   442
295   438
273   432
294   158
318   161
250   423
253   413 
```

要对它们进行聚类，我可以使用聚类树

```
Z = linkage([ X Y ],'complete'); 
```

这是（由`dendrogram(Z,10)`）

![在此处输入图像描述](../Images/16fe2d859c55260d8d4f1a1ba6093891.png)

现在我想根据连接到树节点的距离来提取集群。

说我的距离是`150`，我希望那个电话

```
 T = cluster(Z,'Cutoff',150); 
```

归还我`2`集群。但它只给了我一个（我想），即

```
T =

 1
 1
 1
 1
 1
 1
 1
 1
 1
 1 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:03:02.497

使用`inconsistent(Z,150)`并查看第 4 列中的值。从一个小的正数开始增加截止值，沿着树前进。

例如

```
cluster(Z,'cutoff',0.7) 
```

没有给你你想要的（我认为）

但

```
cluster(Z,'cutoff',0.8) 
```

做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-09T17:12:31.333

默认情况下，***标准***是**不一致**( )。`cluster`**`'inconsistent'`**

 **由于高度`dendrogram`是**距离**，您可以将***标准***更改为`'distance'`，即：

```
T = cluster(Z, 'Cutoff', 150, 'criterion', 'distance'); 
```**

# c# - 地图制作应用

> ID：15621975
> 
> 赞同：1
> 
> 时间：2013-03-25T18:21:52.243
> 
> 标签：c#

我创建了一个有点完整的应用程序，它允许我创建一个地图（.txt 文件，其中包含有关地图所有点的信息）、加载它并绘制它。

我对此的解决方案是，在 windows 窗体应用程序中，放置一个面板（因为我需要能够在地图上移动）和该面板图片框（因为我想在它们上放置背景图像和图像）代表点大小为 50x50 像素的地图。我现在面临的问题是我的应用程序的加载时间增加了，因为我正在将图片加载到图片框中......

有人对我一直在尝试的事情有任何替代建议吗？视觉表示可能会有所帮助：

![注意：图片框在这里只有背景颜色...](../Images/225438b9a43f464bc0e853aa4f6c8dea.png)

代码，按要求：（嗯，其中一些）

```
 private void Load_Map()
    {
        for (int i = Y - 12; i < Y + 12; i++)
        {
            if ((i >= 0) & (i < Int32.Parse(MP.Mheight)))
            {
                string Line = xline[i];
                for (int j = X - 12; j < X + 12; j++)
                {
                    if ((j >= 0) & (j < Int32.Parse(MP.Mwidth)))
                    {
                        int X = i * Int32.Parse(MP.Mwidth) + j;
                        int Z = Int32.Parse(Line[j].ToString());
                        Map_Location[X] = Z;

                        Color H = new Color();
                        Map_Point(j, i, Map_Height(Z, H), 50);
                    }
                }
            }
        }
    } 
```

创建点：

```
 private void Map_Point(int X, int Y, Color H, int Point_Size)
    {
        PictureBox MP = new PictureBox();
        MP.Name = Map_Coordinates(X, Y);
        MP.Size = new Size(Point_Size, Point_Size);
        MP.Location = new Point(Y * (Point_Size + 1) + 4, X * (Point_Size + 1) + 4);
        MP.BackColor = H;

        Control MW = this.Controls["WorldMap"];
        MW.Controls.Add(MP);

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T18:26:42.437

`System.Windows.Forms.Control`您最好通过派生和覆盖该`OnPaint`方法并自己进行绘图和处理单击事件来创建自定义控件。

以您的方式使用大量 WinForms 控件是一种痛苦的练习，因为 WinForms 将为`hWnd`每个控件创建一个对象，不幸的是，WinForms 不能很好地扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:25:10.343

你应该使用`System.Drawing.Graphics`

这是它的[MSDN 教程](http://msdn.microsoft.com/en-CA/library/sfwzeec0%28v=vs.90%29.aspx)。

它有一个名为 的方法`DrawImage`，您可以使用它来代替图片框。对于网格，您应该将其绘制为具有背景颜色和垂直/水平线以构成网格的矩形。

# mobile - 如何在 Blogger Post 中检测移动设备？

> ID：15621979
> 
> 赞同：2
> 
> 时间：2013-03-25T18:22:01.007
> 
> 标签：mobile, blogger

有没有办法在不使用 JavaScript 的情况下在 Blogger Post 中检测移动设备？我们可以使用原语（即 cond=data:mobile）在博客模板中轻松完成，但我在帖子中找不到方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T18:09:38.740

Blogger 条件标签仅适用于模板，不适用于帖子/小部件。

如果您想要移动网站中特定网址的内容，

使用条件 url 标签`<b:if cond='data:blog.url == PUT_URL_HERE'>`

和

移动条件标签`<b:if cond='data:blog.pageType == data:blog.isMobile'>`

一起。

# c++ - 从注册表 C++ 崩溃中获取价值

> ID：15621981
> 
> 赞同：1
> 
> 时间：2013-03-25T18:22:11.270
> 
> 标签：c++, winapi

怎么了？当我想获得 AUVersion 的值时它会崩溃。该键存在于注册表中，但我无法获取。

```
int main(int argc, char *argv[])
{
    HKEY key;
    if (RegOpenKey(HKEY_LOCAL_MACHINE, TEXT("SOFTWARE\\JavaSoft\\Auto Update\\"), &key) != ERROR_SUCCESS)
    {
        cout << "Unable to open registry key\n\n";
    }

    char path[1024];
    DWORD value_length = 1024;
//here is the crash
    RegQueryValueEx(key, "AUVersion", NULL, (LPDWORD)REG_SZ, (LPBYTE)&path, &value_length);
    cout << "the value read from the registry is: " << path << endl;

    system("pause");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T18:25:30.563

第四个参数是一个`LPDWORD`-- 一个指向 DWORD 的指针。您获取了一个常规整数并将其转换为一个指针，该指针（取消引用时）会崩溃。

该参数*接收*注册表值的类型。如果您对了解类型不感兴趣，请将其设置为 NULL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-25T18:26:25.480

调用有两个错误[`RegQueryValueEx()`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms724911%28v=vs.85%29.aspx)：

*   写入的类型参数必须是有效地址，这不是：

    ```
    (LPDWORD)REG_SZ 
    ```

这就是坠机的可能原因。

*   `&path`应该`path`

改成：

```
DWORD type;
RegQueryValueEx(key, "AUVersion", NULL, &type, (LPBYTE) path, &value_length); 
```

您必须检查结果`RegQueryValueEx()`以确保`path`已填充并且后续代码未处理未初始化的变量：

```
const DWORD result = RegQueryValueEx(key,
                                     "AUVersion",
                                     NULL,
                                     &type,
                                     (LPBYTE) path,
                                     &value_length);

// Check status of the query and ensure it was a string
// that was read.
if (ERROR_SUCCESS == result && REG_SZ == type)
{
    // Success.
} 
```

# asp.net-mvc - 使用实体框架动态创建字段

> ID：15621982
> 
> 赞同：0
> 
> 时间：2013-03-25T18:22:14.177
> 
> 标签：asp.net-mvc, database, asp.net-mvc-4, content-management-system, entity-framework-5

我正在开发一个 CMS，我有一个这样的类别类：

```
public partial class Category
{
   public int CategoryId {get;set;}
   public string CategoryName {get;set;}
   public string CategoryType {get;set;}
} 
```

我正在使用实体框架在我的数据库中存储和创建这样的数据库表。现在，如何将动态字段添加到此模型并因此添加到数据库中。我允许用户添加他想要添加的自定义字段。所以，我的数据库模式变成了

> 类别（CategoryId，CategoryName，CategoryType，CustomField1，CustomField2）；

如何使用 EF 5 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T19:42:57.197

你不能以你期望的方式。您不需要将自定义字段添加到`Category`表中，而是需要诸如`CategoryExtension`要存储的表之类的东西`CategoryId`，`FieldName`以及`FieldValue`（与特定类别记录相关的键值对）`CategoryId`将是 FK 到`Category`表的位置，例如`CategoryId`，`FieldName`将构建复合 PK。您的课程将如下所示：

```
public partial class Category
{
   public int CategoryId {get;set;}
   public string CategoryName {get;set;}
   public string CategoryType {get;set;}
   public virtual ICollection<CategoryExtension> Extensions { get; set; }
}

public class CategoryExtension 
{
   public int CategoryId { get; set; }
   public string Name { get; set; }
   public string Value { get; set; }
} 
```

# php - VXML 值到 PHP 变量

> ID：15621983
> 
> 赞同：0
> 
> 时间：2013-03-25T18:22:15.973
> 
> 标签：php, forms, variables, vxml

我有一个单页 VXML 脚本，我已将拨号 DTMF 传递给一个表单，并且工作正常。

但我也想将值传递给 PHP 变量。

那可能吗 ？

```
<prompt> <value expr="Digits"/> </prompt> 
```

这可行，但是如何在 PHP 中将“数字”分配给 $test ？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:34:02.180

在 VoiceXML 中，将变量传递到服务器端脚本的过程通常使用三个标签（ 或 ）之一`<submit>`来`<subdialog>`完成`<data>`。所有这三个都支持提供 URL、HTTP 方法（get 或 post）和将发送到 Web 服务器的变量名称列表的标准约定。

假设您有一个相当简单的 VoiceXML 脚本：

```
<?xml version="1.0"?>
<vxml version="2.1">
  <form>
    <field name="Digits" type="digits">
      <prompt>Please enter some digits.</prompt>
      <filled>
        <prompt>You entered: <value expr="Digits"/></prompt>
        <submit next="path/to/script.php" method="post" namelist="Digits"/>
      </filled>
    </field>
  </form>
</vxml> 
```

然后，您将使用普通的 $_POST 变量访问 VoiceXML 中的变量：

```
<?php
  $test = $_POST['Digits'];
  echo("<?vxml version=\"1.0\"?>\n");
?>
<vxml version="2.1">
  <form>
    <block>
      <prompt>You posted: <?=htmlspecialchars($test)?>.</prompt>
    </block>
  </form>
</vxml> 
```

这种架构允许 VoiceXML 运行为具有 HTTP POST 和响应的传统 Web 服务器/Web 浏览器。您还可以使用该`<data>`标签更接近地模仿现代 AJAX 风格的应用程序，您可以在其中发布名称/值对并返回可以使用普通 Javascript DOM 访问的任意 XML 文档。

# scala - Scala：Breeze (scalanlp.org) 语法？

> ID：15621984
> 
> 赞同：1
> 
> 时间：2013-03-25T18:22:18.213
> 
> 标签：scala, syntax, scala-breeze

请帮助理解以下 Breeze 使用示例。下面的代码既有 Scala 对象方法调用，如等`f.subplot(0)`，`f.saveas`也有函数调用：`linspace(0.0,1.0)`, `plot(x, x :^ 2.0)`.

像往常一样，生成的文档中描述了对象方法：[http ://www.scalanlp.org/api/index.html#breeze.plot.Plot](http://www.scalanlp.org/api/index.html#breeze.plot.Plot)

问题：

1）我在哪里可以找到函数调用的规范：`linspace(0.0,1.0)`，`plot(x, x :^ 2.0)`？据我所知，用于绘制 Breeze 使用 JFreeChart ( [http://www.jfree.org/jfreechart/download.html](http://www.jfree.org/jfreechart/download.html) )。也许这些是从 JFreeChart 包导入的 Java 对象`linspace`？`plot`

2) 是什么`x :^ 3.0`意思？

```
import breeze.plot._

val f = Figure()
val p = f.subplot(0)
val x = linspace(0.0,1.0)
p += plot(x, x :^ 2.0)
p += plot(x, x :^ 3.0, '.')
p.xlabel = "x axis"
p.ylabel = "y axis"
f.saveas("lines.png") // save current figure as a .png, eps and pdf also supported 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:31:01.350

**1**您可以`linspace`在微风包对象中找到规范，`linalg`并且`plot`在包对象中`plog`：

[http://www.scalanlp.org/api/index.html#breeze.linalg.package](http://www.scalanlp.org/api/index.html#breeze.linalg.package) [https://github.com/scalanlp/breeze/blob/master/math/src/main/scala/breeze/linalg/package .scala#L127](https://github.com/scalanlp/breeze/blob/master/math/src/main/scala/breeze/linalg/package.scala#L127)

```
 /**
   * Generates a vector of linearly spaced values between a and b (inclusive).
   * The returned vector will have length elements, defaulting to 100.
   */
  def linspace(a : Double, b : Double, length : Int = 100) : DenseVector[Double] = {
    val increment = (b - a) / (length - 1)
    DenseVector.tabulate(length)(i => a + increment * i)
  } 
```

[http://www.scalanlp.org/api/index.html#breeze.plot.package](http://www.scalanlp.org/api/index.html#breeze.plot.package) [https://github.com/scalanlp/breeze/blob/master/viz/src/main/scala/breeze/plot/package .scala#L24](https://github.com/scalanlp/breeze/blob/master/viz/src/main/scala/breeze/plot/package.scala#L24)

```
 /**
   * Plots the given y versus the given x with the given style.
   *
   * @param x X-coordinates, co-indexed with y (and indexed by keys of type K).
   * @param y Y-coordinates, co-indexed with x (and indexed by keys of type K).
   * @param style Matlab-like style spec of the series to plot.
   * @param name Name of the series to show in the legend.
   * @param labels Optional in-graph labels for some points.
   * @param tips Optional mouse-over tooltips for some points.
   */
  def plot[X,Y,V](x: X, y: Y, style : Char = '-', colorcode : String = null, name : String = null,
                  lines : Boolean = true, shapes : Boolean = false,
                  labels : (Int) => String = null.asInstanceOf[Int=>String],
                  tips : (Int) => String = null.asInstanceOf[Int=>String] )
                 (implicit xv: DomainFunction[X,Int,V],
                  yv: DomainFunction[Y, Int, V], vv: V=>Double):Series = new Series {
    ... 
```

**2**这是逐元素取幂。因此`x :^ 3.0`将 x 与每个元素一起返回到三次方。在给出的示例中，x 是`DenseVector`介于 0 和 1 之间的 100 个值中的一个。因此`x :^ 3.0`会给您另一个`DenseVector`介于 0 和 1 之间的 100 个值，但它们被取为三次方，这是一个很好的图表。

# arrays - Matlab：如何在 dsolve 函数中使用数组？

> ID：15621988
> 
> 赞同：0
> 
> 时间：2013-03-25T18:22:36.623
> 
> 标签：arrays, matlab, ode, dsolve

我有一个由两个方程组成的 ODE 系统，但想通过只使用一个方程和另一个方程的结果来最小化它。

1)

```
t=linspace(0,2,3);
syms x(t) y(t);
inits='x(0)=2,y(0)=0';
[x,y]=dsolve('Dx=y','Dy=(y*2)-x', inits) 
```

x = 2*exp(t) - 2*t*exp(t);
y = -2*t*exp(t)

```
xx=eval(vectorize(x)); 
```

xx = 2.0000；0; -14.7781

```
yy=eval(vectorize(y)); 
```

YY = 0; -5.4366；-29.5562

得到结果后，我尝试只用一个方程求解，并在 Dy 方程中使用 xx 数组。

2)

```
inits='y(0)=0';
[y]=dsolve('Dy=(y*2)-xx', inits); 
```

y = xx/2 - (xx*exp(2*t))/2

```
yy=eval(vectorize(y)); 
```

YY = 0; 0; 396.0397

这些值与第一个示例中的值不同。如何使用数组获得相同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T14:17:22.293

一个问题似乎是变量 xx 不是符号，因此符号求解器似乎将其视为常数。

一个更大的问题是，当它只是一个三点向量时，您真的没有确定您希望 matlab 如何将 xx 值视为连续函数！您甚至期望第二种情况的输出相同的事实表明对我有某种误解。

但为了明确这一点，我们假设您希望将 xx 视为 ZOH（零阶保持）连续信号。为了象征性地处理这个问题，我相信您需要使用 Heaviside 函数显式构造 ZOH 信号。

或者，您可以使用 ode45 进行数值求解，例如

```
t  = [0,1,2];
xx = [2, 0, -14.7781];
dydy = @(t,y) 2*y - xx(1+trunc(t));
y = ode45(dydt, [0,2], 0); 
```

这将分别在**[0, 1, 2]**的 t 值处返回**[0, -6.39, -47.21]**的 yy 值。

 **这与ZOH 系统的**[0, 1-e^2, e^2-e^4]**的理论值（手动计算）非常吻合。

如您所见，上述答案更符合您的 yy = **[0, -5.4366, -29.5562]**的原始解决方案。然而，这两个系统自然不同，因为第一个系统输入的是连续时间指数信号，而第二个系统输入的是非常粗略的采样近似值！

您可以通过以更快的速率（更细的时间间隔）进行采样，以及使用比 ZOH 更好的东西对采样间点进行插值，从而使两者更加相似。

更新： *谢谢。也许你能帮我创建 ZOH 连续信号吗？怎么做？*

在上面的示例中，我通过使用 xx 向量中的三个给定点并使用“xx(1+trunc(t))”访问这些点，在我的导函数 (dydx) 中创建了一个 ZOH。这使用 trunc（截断）在样本间（非整数）时间内显式保持输入常数。

鉴于您的 ODE 是线性的，您还可以使用 matlab 函数“lsim()”，它允许您直接指定时间向量和输入向量，还可以直接指定输入插值的类型（包括 ZOH，这实际上是默认）。

例如：

```
t=[0,1,2]
x=[2,0,-2*e^2]
num=-1
den=[1,-2]
mytf = tf(num,den)
y = lsim(mytf,x,t,0,'zoh'); 
```

与我之前的 ode45 数值解一样，这给出了相同的解，

```
y = [0.00000; -6.38906; -47.20909] 
```

更新（再次） *谢谢。也许你能帮我创建 ZOH 连续信号吗？怎么做？*

重新符号求解器。我无法访问 Matlab 符号库，但如果您真的想使用符号求解器，那么正如我之前解释的，您可以使用 heaviside（单位步长）函数构造一个连续时间 ZOH 信号。应该这样做：

```
syms xzoh(t)
xzoh = xx(1)*heaviside(t) + (xx(2)-xx(1))*heaviside(t-1) + (xx(3)-xx(2))*heaviside(t-2) 
```**

# codenameone - 代号一 为什么会禁用事件？

> ID：15621989
> 
> 赞同：0
> 
> 时间：2013-03-25T18:22:36.873
> 
> 标签：codenameone

请问我该怎么办？

在代号一中的代号一设计器事件被禁用，我该如何解决这个......？我看到了消息，但对我来说不清楚....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T13:00:52.823

您需要提供有关您所做的事情的其他信息。通常，如果资源文件不在项目的 src 目录中，或者如果您删除了项目根目录中的项目属性，则会发生这种情况。

# java - 如何让我的 JTable 出现在按钮单击时？

> ID：15621990
> 
> 赞同：0
> 
> 时间：2013-03-25T18:22:44.010
> 
> 标签：java, swing, jtable

以下代码有效，但仅在按下显示值和调整大小按钮之后。直到我按下显示值并按下调整大小按钮后，它才会出现。仅按下“显示值”按钮时如何使其显示？

```
 public class myClass extends JFrame{
      String[] colNames = {"Item Name",
                    "Department",
                    "Original Price",
                    "Sales Price"};
     Object[][] input = {
     {"Kathy", "Smith",
     new Double(10), new Integer(5)},
     {"John", "Doe",
      new Double(10), new Integer(3)},
     {"Sue", "Black",
     new Double(10), new Integer(2)},
     {"Jane", "White",
      new Double(10), new Integer(20)},
     {"Joe", "Brown",
     new Double(10), new Integer(10)}
    };

    //display values
    JButton buttonDisplay = new JButton();
    buttonDisplay.setText("Display Values");
    container.add(buttonDisplay);        

    buttonDisplay.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent evt) {

            JTable jt = new JTable( input, colNames );
            JScrollPane pane = new JScrollPane( jt );
            jt.setPreferredScrollableViewportSize(
            new Dimension(200,200));
            pane.add(jt);
            container.add( pane );
            container.add(jt);
           /*Must use a JTextBox or JTable to display all the stored values for:
            * 
            * Item name 
                Department
                Original price
                Sale price 
            */
        }
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T18:31:46.297

您只需要添加滚动窗格，而不需要同时添加滚动窗格和表格。所以删除

```
container.add(jt); 
```

线。此外，如果您将某些内容添加到`Container`已经可见的 a 中，则应`Container`按照 javadoc 中的说明使 a 无效。添加

```
container.revalidate();
container.repaint(); 
```

应该使表格可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:36:43.427

`pack()`添加新组件后尝试调用。这将调整 JFrame 的大小以适应所有内容。这就是我假设您的“调整大小按钮”正在做的事情。

```
public void actionPerformed(ActionEvent evt) {
    // ... your other code ...
    container.pack();
} 
```

# asp.net - 使用 Window 身份验证时 User.Identity.Name 为空

> ID：15621991
> 
> 赞同：3
> 
> 时间：2013-03-25T18:22:52.947
> 
> 标签：asp.net, asp.net-mvc

我在 MVC 4 中有一个网站，在 IIS7 上运行 .net 4.5，例如：www.mysite.com 和一个文件夹 www.mysite.com/admin

www.mysite.com 使用表单身份验证并允许某些页面匿名，我希望 www.mysite.com/admin 使用窗口身份验证。

我在 IIS 安全性中设置了该文件夹以使用窗口身份验证（它不是 IIS 中的应用程序）

在我的管理控制器中，我需要从域中捕获用户名，它始终为空，代码如下：

```
 WindowsIdentity winId = WindowsIdentity.GetCurrent();         
  if (winId != null)
  {
   string name = winId.Name;        
  } 
```

User.Identity.Name 也是空的请让我知道我错过了什么。

我确信这是很常见的事情，无法弄清楚为什么它不能与 MVC 一起使用，我有使用 Web 表单的旧站点并且具有相同的设置并且它正在工作。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T00:53:29.370

如果您对页面使用 Windows 身份验证，请尝试以下操作，看看它是否有任何数据。听起来您可能已经尝试过了，但我没有看到包含的 Page 对象。

确保您的 web.config 启用了 Windows 身份验证。

```
<authentication mode="Windows">
     </authentication> 
```

字符串用户 = Page.User.Identity.Name;

希望这会有所帮助我可能会研究内置的角色和会员功能，我不熟悉您向我道歉的路线。

[http://www.codeproject.com/Articles/342061/Understanding-ASP-NET-Roles-and-Membership-A-Begin](http://www.codeproject.com/Articles/342061/Understanding-ASP-NET-Roles-and-Membership-A-Begin)

# php - 扩展 Sonata User Bundle 并添加新字段

> ID：15621993
> 
> 赞同：11
> 
> 时间：2013-03-25T18:22:56.593
> 
> 标签：php, symfony, symfony-sonata

我正在扩展 Sonata 用户包并在新用户实体中创建一些额外的字段。这些字段只会在用户下的 Sonata 管理区域内更新，因此它们不需要在编辑配置文件表单中可用。我无法通过 Sonata 用户管理器更新这些字段，并尝试了几种不同的方法来扩展/实现 Application\Sonata\UserBundle 中的该类。有没有人遇到过这种情况，可以给我一个教程或一步一步的过程来扩展新的用户实体的最干净的方法？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-25T21:21:12.993

## 1.创建一个新包

像 AcmeUserBundle 之类的东西。像往常一样创建并注册它。

## 2.创建一个新的用户实体

然后创建一个扩展and的`User`and`Group`实体。您还应该添加主键的配置，例如：`Sonata\UserBundle\Entity\BaseUser``Sonata\UserBundle\Entity\BaseGroup`

```
/**
* @ORM\Entity
* @ORM\Table(name="fos_user")
*/
class User extends BaseUser
{
    /**
    * @ORM\Id
    * @ORM\Column(type="integer")
    * @ORM\GeneratedValue(strategy="AUTO")
    */
    protected $id;
} 
```

## 3.配置实体

然后，转到您的`app/config/config.yml`文件并配置这些新实体：

```
sonata_user:
    class:
        user: Acme\UserBundle\Entity\User
        group: Acme\UserBundle\Entity\Group 
```

## 4\. 覆盖 UserAdmin 类

然后，您需要创建一个新的 UserAdmin 类。为此，只需`UserAdmin`在您的包中创建一个新类，扩展`Sonata\UserBundle\Admin\Model\UserAdmin`并覆盖如下方法：

```
namespace Acme\UserBundle\Admin;

use Sonata\UserBundle\Admin\Model\UserAdmin as SonataUserAdmin;

class UserAdmin extends SonataUserAdmin
{
    /**
        * {@inheritdoc}
        */
    protected function configureFormFields(FormMapper $formMapper)
    {
        parent::configureFormFields($formMapper);

        $formMapper
            ->with('new_section')
                ->add(...)
                // ...
            ->end()
        ;
    }
} 
```

## 5.替换旧的UserAdmin类

然后，您需要确保 Sonata 使用新的 UserAdmin 类。您只需将`sonata.user.admin.user.class`参数设置为您的新类并准​​备好！

```
# app/config/config.yml
parameters:
    sonata.user.admin.user.class: Acme\UserBundle\Admin\UserAdmin 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-02T16:09:37.483

我发现这个问题是一个教义问题。我的扩展包使用了原始的 xml 字段映射。我删除了这些文件并恢复为注释。从那里开始一切都很顺利。我希望这可以帮助遇到同样问题的其他人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T21:14:45.713

这很容易，但是[`SonataUserBundle`文档](http://sonata-project.org/bundles/user/master/doc/reference/installation.html#extending-the-bundle)很短。[基本上，按照此处](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md#installation)和[此处](http://sonata-project.org/bundles/user/master/doc/reference/installation.html#installation)所述设置两个捆绑包后：

您需要创建一个类来`Sonata\UserBundle\Entity\BaseUser`扩展`SonataUserBundle`. 请注意，如果您覆盖构造函数，您仍然**必须**调用父对象的构造函数。

```
namespace Your\Bundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\ORM\EntityManager;
use Sonata\UserBundle\Entity\BaseUser as BaseUser;

/**
 * @ORM\Entity
 * @ORM\Table(name="user",indexes={@ORM\Index(name="username_idx", columns={"username"})})
 */

class User extends BaseUser {

    public function __construct()
    {
        parent::__construct();
        // your code here
    }

    /**
     * @ORM\Column(type="string")
     */
    protected $firstName = "";

    public function getFirstName() {
        return $this->firstName;
    }

    public function setFirstName($firstName) {
        $this->firstName = $firstName;
    }
} 
```

如果需要，您也可以`Sonata\UserBundle\Entity\BaseGroup`以类似的方式覆盖对象。

然后，编辑你`config.yml`以匹配你的命名空间，像这样

```
# FOS User Bundle Configuration
fos_user:
    user_class: Your\Bundle\Entity\User
    # To also override the Group object
    # group:
    #     group_class: Your\Bundle\Entity\Group

# Sonata User Bundle configuration
sonata_user:
    class:
        user:               Your\Bundle\Entity\User
        # To also override the Group object
        # group:              Your\Bundle\Entity\Group 
```

清除缓存。将使用您的实体而不是内置实体。

# azure - 获取发布文件 Windows azure

> ID：15621996
> 
> 赞同：2
> 
> 时间：2013-03-25T18:23:08.887
> 
> 标签：azure

我采取的步骤：

1) 获取-AzurePublishSettingsFile

然后我下载文件。

2) 导入-AzurePublishSettingsFile

现在问题来了，我把第一个文件放在了C盘，但是好像找不到。

我执行以下操作

导入-AzurePublishSettingsFile C:\-credentials.publishsettings

powershell 返回以下错误

*   CategoryInfo : InvalidArgument: (:) [Import-AzurePublishSettingsFile], ParameterBindingException
*   FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.WindowsAzure.Management.Cmdlets.ImportAzurePublish SettingsCommand

任何想法如何解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T21:18:26.543

您在命令中传递了不正确的 publishsettings 文件位置，如下所示，这就是您收到异常的原因：

```
PS> import-AzurePublishSettingsFile C:\-credentials.publishsettings 
```

没有人知道您将 publishsettings 存储在计算机中的哪个位置，因此您真正需要的是使用 Get-AzurePublishSettingsFile PS 命令再次下载 publishsettings 文件，这一次请记住您将其保存在本地计算机的哪个位置。

一旦您知道 publishsettings 文件路径，使用 import-AzurePublishSettingsFile PS 命令正确传递它，它将起作用。

```
PS> import-AzurePublishSettingsFile CORRECT_PATH_TO_PUBLISHSETTINGS_FILE 
```

我创建了一个示例 PS 脚本菜单以使用 Windows Azure，因此您可以在[这里查看](https://github.com/Avkash/AzurePowershellmenu/blob/master/PowershellMenuPub.ps1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T17:06:15.550

据我了解，有两种使用 VS 2012 发布到 Azure 的方法：第一种是 1）通过“发布”和 2）第二种是“通过 azure 发布”。

1）如果您选择仅针对 Azure 网站的“发布”，虽然它放弃了选择下载的发布设置的选项，但这些设置实际上并未导入，而我部署网站的唯一方法是手动设置配置文件.

2) 要使用下载的发布设置，您必须选择“发布到 azure”，然后导入证书并允许您继续 VS 2012 部署到云服务中的后续步骤。

我花了一段时间才明白，通过 VS 2012 发布与使用 Azure Powershell 管理 Azure VM（或 blob）是一个完全独立的过程，这还需要您使用我在下面的“下载”文件夹中留下的已下载发布设置：

PS C:> Import-AzurePublishSettingsFile 'C:\Users[me]\Downloads[Pay-As-You-Go-credentials.publishsettings]'

注意：单引号似乎是必需的。