# StackOverflow 问答 15256000-15256999

# ruby-on-rails-3 - 我无法在 Rails3 中创建控制器？

> ID：15256000
> 
> 赞同：0
> 
> 时间：2013-03-06T19:14:51.947
> 
> 标签：ruby-on-rails-3, rake, execjs

> C:\Sites\guestbook>rails 生成控制器条目
> 
> ```
>  C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs/runtimes.rb:51:in `autodetect': 
> ```
> 
> 找不到 JavaScript 运行时。有关可用运行时的列表，请参阅[https://github.com/sstephenson/execjs](https://github.com/sstephenson/execjs)。(ExecJS::RuntimeUnavailable)

```
gem install execjs 
```

我使用上面的命令安装了，但再次出现错误。我正在尝试执行此命令：

```
rails generate controller entries 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:18:27.950

您使用的 gem 要求您在系统上安装一个单独的 javascript 库。在 linux 上，您需要通过包管理器安装 nodeJS、rhino 或类似的东西。在 Windows 上，我想您必须手动安装。

如果您不想这样做，最简单的方法是删除 execjs gem，除非您真的需要它。

# javascript - 如何使用 JQuery 隐藏元素？

> ID：15256001
> 
> 赞同：1
> 
> 时间：2013-03-06T19:14:54.043
> 
> 标签：javascript, jquery, html

在下面的例子中我做错了什么？在这种情况下，jquery 代码需要放在页脚 div 之上。

```
<html>
<head>
<title></title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
</head>
<body>

<script>
#(document).ready(function(){
$('#footer').hide();
});
</script>

<div id="footer">testing footer</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-06T19:15:49.690

错字：

```
#(document).ready(function(){ 
```

应该：

```
$(document).ready(function(){ 
```

如果您使用当前代码，您应该在浏览器窗口（或控制台）中看到某种错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T19:17:26.420

实际上，jQuery 代码的放置与此工作与否无关。

问题是您使用的是`#`代替`$`来引用 jQuery 对象。这段代码应该是：

```
$(document).ready(function() {
...
} 
```

# c# - 我应该创建使用 Workflow Foundation 建模的长时间运行的线程吗？

> ID：15256017
> 
> 赞同：1
> 
> 时间：2013-03-06T19:15:32.940
> 
> 标签：c#, .net, windows, iis, workflow-foundation-4

我工作的公司正在考虑采用和实施托管在 IIS 中的 Workflow Foundation 来处理数据。我们仍在设计我们的问题域，但有人担心长时间运行的线程在 IIS 内部并不理想。以下是我们所做的一些假设，因为 Workflow 对我们的团队来说仍然是一项新技术：

我们正在区分“长时间运行的进程”和“长时间运行的工作流”，其中长时间运行的进程正在积极消耗 CPU，而长时间运行的工作流只是简单地保留了无法确定的时间，等待额外的请求来完成它的工作.

**我的问题是：创建一个长时间运行的线程作为 IIS 中托管的窗口工作流的一部分是一种好习惯，还是我们应该通过传统的 Windows 服务在 IIS 之外实现长时间运行的进程？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T15:37:13.813

使用 AppFabric 只需坚持你的循环（我假设它必须是一个循环，因为否则 Receive 或 Delay 将在空闲时卸载，因此不会发生长时间运行的进程），启用实例控制并将未处理异常的操作设置为 Abandon（恢复WF 实例到最后一个持久点）。

在应用程序池中，禁用回收、快速失败等。这是否是好的做法取决于很多事情，例如部署问题、是否要使用 wcf 调用与进程交互、是否要轻松扩展等.. 就我个人而言，我不喜欢 Windows 服务的麻烦，而且我认为您总是必须处理意外的进程终止，那么为什么不假设它会发生并使用安全的持久点走 IIS 路线呢？

# google-apps-script - 谷歌表单确认脚本

> ID：15256019
> 
> 赞同：4
> 
> 时间：2013-03-06T19:15:34.580
> 
> 标签：google-apps-script

我一直在尝试按照此处所述整理确认脚本：http: [//alamoxie.com/blog/tech-tips/sending-confirmation-emails-google-docs-form/](http://alamoxie.com/blog/tech-tips/sending-confirmation-emails-google-docs-form/)

但我总是得到这个错误代码：

```
TypeError: Cannot read property "values" from undefined. (line 5, file "Confirmation Email") 
```

标准确认的脚本的目的是提供一种易于阅读和打印的表格，该表格仅占用一页，仅包含相关信息，而不是吐出 12 页的标准确认。

在这种情况下，我使用它来创建食品订单。请求者将选择他们想要的活动项目，提交，然后电子邮件确认将发送给管理员，可以打印并交给厨房拉。我已经成功地制作了一个邮件合并类型的文档，但是它发送了对列表中所有内容的确认，而我想要的只是输入的最新行（因此是确认脚本）。

所以这是我的代码：

```
 function onFormSubmit(e) {

  // First establish the variables. Name each variable by the e.values (column number in the spreadsheet).

  var timeStamp = e.values[0];
  var Activity = e.values[2];
  var pickUp = e.values[3];
  var pickUptime = e.values[4];
  var nPeople = e.values[5];
  var submitUser = e.values[6];
  var Equipment = e.values[7];
  var Drinks = e.values[8];
  var Breakfast = e.values[9];
  var Lunch = e.values[10];
  var Dinner = e.values[11];
  var eveningProgram = e.values[12];  
  var Event = e.values[13];
  var Snacks = e.values[14];
  var Notes = e.values[15];
  var userEmail = e.values[17];

  // These are the components of the email confirmation

   var emailTo = userEmail;
   var CCAddr = "admin@adminaddress.com";
   var subject = "Food Order Request";
   var emailBody =  "Food Order Requisition\n\n" +
                    "Pick up Date:" + pickUp + 
                    "\nPick up Time:" + pickUptime +
                    "\nSubmitted by:" + submitUser +
                    "\nDate Submitted:" + timeStamp +
                    "\n\nActivity:" + Activity +
                    "\nPeople:" + nPeople +
                    "\nMeal:" +Event +
                    "\nThe following is needed for" + Activity + "by" + submitUser + "who can be reached at" + userEmail +
                    "\n\nEquipment and Supplies:\n" + Equipment +
                    "\n\nDrinks:\n" + Drinks +
                    "\n\nSnacks:\n" + Snacks +
                    "\n\nBreakfast:\n" + Breakfast +
                    "\n\nLunch:\n" + Lunch +
                    "\n\nDinner:\n" + Dinner +
                    "\n\nEvening Program/Special Events:\n" + eveningProgram +
                    "\n\nThe following special notes were also requested:\n" + Notes +
                    "\n\nProcessed by:___________________ Processed Date & Time:_________________________Food Order Requisition";

  /**
   * Un-comment this to use it for debugging
   */
//  for (var i in e.values) {
//    Logger.log("" + i + ":" + e.values[i]);
//  }

                    MailApp.sendEmail(emailTo, subject, emailBody);

} 
```

问题是它告诉我我的价值观是未定义的，我不知道为什么......有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:26:00.550

此脚本无法从脚本编辑器执行，它仅在由表单提交触发时才有效，这就是`e`（事件信息）获取其参数的方式。如果从脚本编辑器启动，则事件信息为`undefined`，这是合乎逻辑的，因为没有发生任何事件。

所以你应该通过发送表格来测试它。

编辑：您必须创建一个`onFormSubmit trigger`以使脚本在提交表单时运行：请参阅此处和[此处的](https://developers.google.com/apps-script/understanding_events)[文档](https://developers.google.com/apps-script/understanding_triggers)

# ssh - Maven Build 无法部署到 Javadoc 服务器：缺少 SSH known_hosts

> ID：15256021
> 
> 赞同：1
> 
> 时间：2013-03-06T19:15:38.363
> 
> 标签：ssh, jenkins

我们正在使用 CloudBees Jenkins 运行 Maven 作业，但在尝试将 Javadoc 部署到我们的私有 Javadoc 服务器时构建失败。这是日志中的错误：

```
The authenticity of host 'javadoc.foo.com' can't be established.
RSA key fingerprint is 3e:69:41:8a:ec:d1:4c:d9:75:ef:7d:71:b7:7d:51:d0.
Are you sure you want to continue connecting? (yes/no):
The authenticity of host 'javadoc.foo.com' can't be established. 
```

我想修改`known_hosts`m1.large 和 m1.small 节点上的文件，但我不知道如何。

只是大声思考，我是否应该有一个预先构建步骤来动态修改`known_hosts`文件？或者也许复制目录中的预构建`known_hosts`文件`/private`？

对不起，如果这是一个新手问题，但我对整个“动态创建的构建机器”是新手......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T11:59:00.787

最安全的方法是使用您期望的值预先配置已知主机 - 为您要连接的服务器附加适当的行。

```
# Run this manually:
ssh -o UserKnownHostsFile=foo javadoc.foo.com

# Take that file and put it in your private DAV share, and then
ssh -o UserKnownHostsFile=/private/<account>/known_hosts javadoc.foo.com 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T14:56:48.410

Ben W 的回答非常好。或者，我会确保我可以通过控制台从该机器登录到任何地方，以便 ssh 客户端自行存储设置。

# c# - 解决方案中的多个项目 - 实体框架和 ASP.Net MVC 4

> ID：15256027
> 
> 赞同：4
> 
> 时间：2013-03-06T19:15:57.907
> 
> 标签：c#, wcf, entity-framework, asp.net-mvc-4

对于一个学校项目，我正在构建一个必须拆分为多个项目的应用程序。

将创建的项目是类库、wcf 服务和 asp.net MVC4 应用程序。

类库将是一个状态库、一个无状态库和一个数据逻辑库。

理想情况下，实体框架应该在datalogic库中，生成的模型应该放在状态库中，无状态的类包含保存这些模型的静态方法。

但是，我似乎无法将 Entity Framework (v5) 生成的模型放到另一个类库 (State) 中。有没有办法做到这一点？还是我想错了，我应该使用其他架构吗？

**这个问题解决了：** [Entity Framework 5 and Visual Studio 2012 POCO Classes in different Project](https://stackoverflow.com/questions/12375090/entity-framework-5-and-visual-studio-2012-poco-classes-in-different-project)

仍然欢迎有关架构的建议：

如果我的结构被证明是错误的或效率不如建议的那样，我愿意改变这种结构。

（我可能需要提供的其他信息是 WCF 服务将通过无状态库的方法，而 ASP.Net MVC4 应用程序正在使用这些方法来获取模型和一些控制器功能）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T20:33:46.050

（所以你可以标记一个答案）

你在使用 EF DbContext POCO 生成器吗？

然后在不同的程序集中拥有 .edmx 上下文和 poco 模型是相当直接的 - [msdn.microsoft.com/en-US/data/jj206878](http://msdn.microsoft.com/en-US/data/jj206878) -</p>

正如您所发现的 - 这篇关于[Entity Framework 5 and Visual Studio 2012 POCO Classes in different Project](https://stackoverflow.com/questions/12375090/entity-framework-5-and-visual-studio-2012-poco-classes-in-different-project)的帖子很好地解释了该过程。

Julie Lerman 还从她的书籍和课程中获得了[可下载的解决方案](http://learnentityframework.com/LearnEntityFramework/downloads/)，其中展示了 POCo T4 模板和许多其他良好实践

# java - 如何确保 ZK Popup 出现在适当的组件下方，并在需要时滚动？

> ID：15256028
> 
> 赞同：0
> 
> 时间：2013-03-06T19:16:01.433
> 
> 标签：java, zk

我正在为文本字段实现自动完成弹出窗口，因此我需要弹出窗口始终出现在文本字段下方。在 ZK 中执行此操作的标准方法是：

```
 popup.open( field, "after_start" ); 
```

这很好，除了我的文本框是网格控件的一部分。当用户在靠近屏幕底部的一行输入数据时，没有足够的空间来显示字段下方的弹出窗口，ZK 会调整弹出窗口的位置以使其完全可见，从而遮挡文本框控件。

我的桌面设计有足够的空间来显示字段下方的弹出窗口；我只需要确保客户端滚动，以便弹出窗口保持在该字段下方。

我试过使用`Clients.scrollIntoView( popup );`，但这无济于事，因为弹出窗口会自动显示。

我知道的另一种可能性是使用`"end_before"`位置值将弹出窗口定位在文本框的右侧，但这与自动完成弹出窗口的标准 UI 约定不一致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T12:54:17.183

`opts`可以使用 Popup 小部件的方法的参数`open`（从客户端）调整弹出位置。有关更多详细信息，请参阅该方法的[参考](http://www.zkoss.org/javadoc/latest/jsdoc/zul/wgt/Popup.html#open%28zk.Widget,%20_global_.Offset,%20_global_.String,%20_global_.Map%29)。

不幸的是，无法从 Java 代码中设置此参数值，您应该覆盖客户端（即 javascript）`open`方法的默认行为以获取结果。

[本文](http://books.zkoss.org/wiki/ZK%20Client-side%20Reference/General%20Control/Widget%20Customization)描述了小部件方法的覆盖。

在您的情况下，您应该`opts.overflow`在调用原始`open`方法之前将属性设置为任何值。例如：

```
<popup xmlns:w="http://www.zkoss.org/2005/zk/client">
    <attribute w:name="open">
        function (ref, offset, position, opts) {
            var _opts = opts || {}; // opts can be undefined! 
            _opts.overflow = true;
            this.$open(ref, offset, position, _opts);
        }
    </attribute>
</popup> 
```

`popup.open`如果需要，使用打开此弹出窗口后`Clients.scrollIntoView`使其可见。

# php - UPS 向第三方托运人开账单？

> ID：15256029
> 
> 赞同：2
> 
> 时间：2013-03-06T19:16:07.360
> 
> 标签：php, api, ups

我试图弄清楚如何使用 API 向第三方 UPS 发件人帐号收费，当我尝试下面列出的内容时，它不起作用！它在错误消息中显示“每次装运需要一个计费选项”。任何人都知道什么是错的？

```
$ShipmentConfirmRequestXML->push('PaymentInformation');
                $ShipmentConfirmRequestXML->push('Prepaid');
                    $ShipmentConfirmRequestXML->push('BillThirdParty');
                            $ShipmentConfirmRequestXML->element('AccountNumber', 'XXXXX');
                    $ShipmentConfirmRequestXML->pop(); // end BillShipper 
                $ShipmentConfirmRequestXML->pop(); // end Prepaid
            $ShipmentConfirmRequestXML->pop(); // end PaymentInformation 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-08T18:26:57.567

第三方计费不在预付费容器内。根据 UPS API 开发人员指南，最终结果 XML 应如下所示：

```
<PaymentInformation>
    <BillThirdParty>
        <BillThirdPartyShipper>
            <AccountNumber>ABC123</AccountNumber>
            <ThirdParty>
                <Address>
                    <PostalCode>12345-6789</PostalCode>
                    <CountryCode>US</CountryCode>
                </Address>
            </ThirdParty>
        </BillThirdPartyShipper>
    </BillThirdParty>
</PaymentInformation> 
```

由于某种原因，UPS API 在测试模式下总是会因第三方计费而失败，并给出瞬态 120001 错误，“XML 运输系统不可用，请稍后再试”。关闭测试模式可以解决问题 - 在您确认您的代码有效后将货物作废。

此外，如果您为第三方计费输入了错误的帐户代码，则会返回相同的 120001 错误。

# r - 根据这些值的向量从数据集中删除值

> ID：15256030
> 
> 赞同：1
> 
> 时间：2013-03-06T19:16:07.800
> 
> 标签：r

我有一个看起来像这样的数据集，除了它更长并且具有更多值：

```
dataset <- data.frame(grps = c("a","b","c","a","d","b","c","a","d","b","c","a"), response = c(1,4,2,6,4,7,8,9,4,5,0,3)) 
```

在 R 中，我想使用要删除的值向量删除包含值“b”或“c”的所有行，即

```
remove<-c("b","c") 
```

实际数据集非常长，需要删除数百个值，因此一个接一个地删除值将非常耗时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T19:18:39.637

尝试：

```
dataset[!(dataset$grps %in% remove),] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:36:00.697

还有`subset`：

```
subset(dataset, !(grps %in% remove)) 
```

...这实际上只是一个包装器，当有多个子集标准时，`[`它可以让您一遍又一遍地跳过写入。`dataset$`但是，正如帮助页面警告的那样：

> 这是一个旨在以交互方式使用的便利功能。对于编程，最好使用像“[”这样的标准子集函数，特别是参数“子集”的非标准评估可能会产生意想不到的后果。

我从来没有遇到过任何问题，但是我的大部分 R 代码都是我自己使用的脚本，输入相对静态。

* * *

2013-04-12

我现在遇到了问题。如果您正在为 CRAN 构建一个包，`R CMD check`如果您在代码中以这种方式使用，则会抛出一个注释`subset`- 它会想知道是否`grps`是一个全局变量，即使`subset`是在 的环境中评估它`dataset`（而不是全局变量）。因此，如果有任何可能您的代码最终会出现在一个包中，并且您对 NOTEs 感到不安，请坚持使用 Rcoster 的方法。

# android - 如何在停止前测试旋转量？

> ID：15256032
> 
> 赞同：0
> 
> 时间：2013-03-06T19:16:14.220
> 
> 标签：android, sprite, libgdx

我有一个旋转的精灵，当释放触摸输入时，它会快速旋转回 0 度。如何在释放触摸输入之前获得精灵的旋转（度数或其他）？

我已经看过并且找不到任何方法来实现，谷歌的棘手问题。

编辑对不起潜在的回应。到目前为止，这是我的代码，我可以使用 rPower 变量来引导弹丸吗？还没走到那一步。

```
@Override
    public boolean touchDown(int x, int y, int pointer, int button) {

        if (Gdx.input.isTouched(0)) {
        cam.unproject(touchPoint.set(Gdx.input.getX(), Gdx.input.getY(), 0));
        }
        if (Gdx.input.isTouched(1)) {
            cam.unproject(touchPoint2.set(Gdx.input.getX(), Gdx.input.getY(), 0));
        }
    return true;
    }

    @Override
    public boolean touchDragged(int x, int y, int pointer) {

    if (Gdx.input.isTouched(0)) {
        cam.unproject(dragPoint.set(Gdx.input.getX(), Gdx.input.getY(), 0));
        dx = touchPoint.x - dragPoint.x;
        dy = touchPoint.y - dragPoint.y;
        throwerLowerArmSprite.setRotation(dx * 30);
    }
    if (Gdx.input.isTouched(1)){
        cam.unproject(dragPoint2.set(Gdx.input.getX(), Gdx.input.getY(), 0));
        d1x = dragPoint2.x - touchPoint2.x;
        d1y = dragPoint2.y - touchPoint2.y;
        throwerUpperArmSprite.setRotation(d1x * 30);

    }
    return true;
    }

    @Override
    public boolean touchUp(int x, int y, int pointer, int button) {
        if (!Gdx.input.isTouched(0)) {
        cam.unproject(releasePoint.set(Gdx.input.getX(), Gdx.input.getY(), 0));
        rPower = releasePoint.x - touchPoint.x;
        throwerLowerArmSprite.setRotation(0);
        }
        if (!Gdx.input.isTouched(1)) {
            cam.unproject(releasePoint2.set(Gdx.input.getX(), Gdx.input.getY(), 0));
            rPower = releasePoint2.x - touchPoint2.x;
            throwerUpperArmSprite.setRotation(0);
            }
        return true;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T16:29:41.143

由于方法中的这一点，您的精灵会旋转回 0 度`touchUp`：

```
throwerLowerArmSprite.setRotation(0); 
```

所有有`setRotation`方法的对象也[有一个`getRoatation()`方法](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g2d/Sprite.html#getRotation%28%29)。因此，您可以使用以下方法保存当前旋转：

```
float oldRotation = mySprite.getRotation(); 
```

与问题无关，但您可以简化所有输入事件回调。您正在混合事件轮询方法以查找事件回调已经提供的数据。例如，您的`touchDown`方法可以像这样使用它的参数：

```
public boolean touchDown(int x, int y, int pointer, int button) {
    if (pointer == 0) {
       cam.unproject(touchPoint.set(x, y, 0));
    } else if (pointer == 1) {
       cam.unproject(touchPoint2.set(x, y, 0));
    }
    return true;
} 
```

`touchUp`这在您的方法中更加有用，其中`pointer`参数将告诉您什么`Gdx.input.isTouched`不能（即哪个指针是不再触摸屏幕的指针）。

# jquery - 通过 Spring MVC API+ 基于 Jquery 的 Front END HTML Web App 上传文件

> ID：15256036
> 
> 赞同：0
> 
> 时间：2013-03-06T19:16:25.807
> 
> 标签：jquery, api, spring-mvc, file-upload, spring-3

我希望使用基于 Spring MVC 的 REST API 上传文件。该 API 将是一个典型的 Java Web 应用程序，并将充当后端。

前端将是一个使用 JQuery 的 HTML Web 应用程序。

我想显示一个上传框，用户可以使用该框选择要上传的文件。现在这个文件必须作为参数传递给 API，以便它可以被 API 存储。

这些是我的问题——

(1) 在服务类中，我正在考虑将 File 对象作为参数传递。但是，如何将正在上传的文件与此文件对象输入参数连接起来？我这样想是正确的，还是有其他方法可以做到这一点？

(2) 如果我建议的方法有效并且还有其他方法也可以实现相同的目标，那么对于这种情况，您会推荐哪种方法 - 如果您可以向我指出教程/指南/如何解释如何上传文件根据上述情况，或者自己解释一下——这对我很有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T21:05:44.723

你不应该使用 java.io.File，你应该使用[org.springframework.web.multipart.MultipartFile](http://static.springsource.org/autorepo/docs/spring/3.2.0.M1/api/org/springframework/web/multipart/MultipartFile.html)。您可以直接在处理程序方法中传递它，也可以使其成为 Form Bean/Command Object 的成员。它为您提供了原始文件名和内容类型等细节。

就“上传框”而言，您只需在 HTML 页面上创建一个“文件”类型的输入元素。浏览器处理其余部分。

我不确定您在第二部分中要问什么。

# ajax - jQuery UI Ajax 选项卡加载不显示

> ID：15256038
> 
> 赞同：1
> 
> 时间：2013-03-06T19:16:36.033
> 
> 标签：ajax, jquery-ui, jquery, jquery-ui-tabs

我正在使用 jQuery UI 垂直选项卡，内容是通过 AJAX 加载的。我几乎从这里的帖子中尝试了所有东西，到目前为止没有任何帮助..：/

我想显示一个 css3 加载动画放置在`<div id="loading-image">...</div>`. 到目前为止，几乎没有任何事情发生。

我的代码

```
$(function() {
    $( "#messages_tabs_div" ).tabs({
        beforeLoad: function( event, ui ) {
            console.log(ui);
            ui.jqXHR.error(function() {
                ui.panel.html("Couldn't load your messages. Try refreshing your page."+
                    " If you think this is bug you can help us by submitting it at bugs@go-out-sport.com "  );
            });
            ui.jqXHR.complete(function(response){                
                console.log(response);                    
            });
        },
        disabled: [6],
        select: function(event, ui) {
            alert('ASDAD');
        }
    }).addClass( "ui-tabs-vertical ui-helper-clearfix" );
    $( "#messages_tabs_div li" ).removeClass( "ui-corner-top" ).addClass( "ui-corner-left" );
});

//jQuery MINE
$(document).ready(function(){
    $('#loading-image').hide();
    //Set loading bar for all ajax requests
    $('#loading-image').bind('ajaxStart', function(){
        alert('AJAXXX');
        $(this).show();
    }).bind('ajaxStop', function(){
        $(this).hide();
    });    

    $('#loading-image').bind('tabsselect', function(event, ui) {
        alert('TABSSSSS');
        $(this).show();
    }).bind('tabsload', function(event, ui) {
        $(this).hide();
    });
}); 
```

我唯一得到的是`AJAX alert`. 我尝试删除`$('#loading-image').hide();`并且加载始终存在。

请帮忙 ....

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:30:43.133

我建议使用全局 ajax 加载..

```
$(document).ajaxStart(function() {
    $("#loading").fadeIn(200);
}).ajaxStop(function() {
    $("#loading").fadeOut(300);
}).ajaxSuccess(function() {
}); 
```

但是，如果您想针对多个事件进行个性化设置，请参阅以下问题：

[如何在特定的 ajax 调用中调用 .ajaxStart()](https://stackoverflow.com/questions/1191485/how-to-call-ajaxstart-on-specific-ajax-calls)

[jQuery 我应该使用多个 ajaxStart/ajaxStop 处理](https://stackoverflow.com/questions/1061922/jquery-should-i-use-multiple-ajaxstart-ajaxstop-handling)

# php - 我应该如何根据结果表显示测验问题？

> ID：15256041
> 
> 赞同：0
> 
> 时间：2013-03-06T19:16:45.770
> 
> 标签：php, game-engine

我有一个简单的查询，可以从 DB 中选择所有测验。

```
$mysqli->query("SELECT * FROM quizz WHERE quizz_level = $level"); 
```

为了显示这个结果，我做了简单的`foreach`.

我还有一个结果表，我可以在其中保存测验的结果

```
result_id, user_id, quizz_id, result_value 
```

现在我想修改原始的foreach，如果特定用户的特定测验结果存在，请以不同的方式标记它（如回答）。

我打算执行以下操作，选择结果表并获取特定用户的所有 quizz_id。把它放到一个数组中。在进行原始 foreach 以显示测验问题时，将其与结果数组中的键匹配。

这个问题有更好的解决方案吗？

可以通过mysql子查询来完成吗？

ps可能是我有史以来最糟糕的问题:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:27:00.273

怎么样

```
SELECT q.*,case when r.user_id = $user_id then 1 else 0 end case as answered
FROM quizz q
inner join results r on q.quizz_id = r.quizz_id
 WHERE q.quizz_level = $level 
```

然后过滤在您的 php 代码上的回答

编辑

我已将左外部更改为内部，因为左外部没有意义。还将连接的列更改为 quizz_id

选择从表 quizz (q.*) 中获取所有记录，并且通过内部连接链接到 quizz_id 列上的结果表。

然后在选择部分我用例检查 user_id 是否是您正在寻找的那个

```
 case when r.user_id = $user_id then 1 else 0 end case as answered 
```

然后，recorset 将包含所有测验表列加上一个称为已回答的列，如果值为 1，则 user_id 回答了测验，如果值为 0，则 user_id 没有回答。

# sparql - 为什么指定谓词和对象在 Fuseki 中不起作用？

> ID：15256042
> 
> 赞同：1
> 
> 时间：2013-03-06T19:16:47.763
> 
> 标签：sparql, jena, fuseki

我正在尝试将 DBpedia 的 Ontology Infoxbox 属性[http://downloads.dbpedia.org/3.8/en/mappingbased_properties_en.ttl.bz2](http://downloads.dbpedia.org/3.8/en/mappingbased_properties_en.ttl.bz2)、[http://wiki.dbpedia.org/Downloads38#h227-1](http://wiki.dbpedia.org/Downloads38#h227-1)加载到正在运行的 Fuseki 服务器中在我的机器上。

为此，我做了以下

1.  使用以下命令创建 tdb

    java tdb.tdbloader --loc=dbpedia mappingbased_properties_en.ttl

2.  使用以下命令运行服务器

    .\fuseki-server.bat --loc=../dbpedia /dbpedia

尝试一个简单的查询，例如

```
PREFIX dbpedia: <http://dbpedia.org/resource/>
PREFIX dbpedia-owl: <http://dbpedia.org/ontology/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>

select ?s ?p ?o
where
{?s ?p ?o.}
LIMIT 100 
```

效果很好，给出的结果像

```
| dbpedia:Animal_Farm | foaf:name          | "Animal Farm"@en
| dbpedia:Animal_Farm | foaf:name          | "Animal Farm: A Fairy Story"@en
| dbpedia:Animal_Farm | dbpedia-owl:author | dbpedia:George_Orwell 
```

当我指定谓词时会出现问题

```
select ?s ?o
where
{?s foaf:name ?o.}
LIMIT 100 
```

或对象

```
select ?s ?p
where
{?s ?p dbpedia:George_Orwell.}
LIMIT 100 
```

我得到空结果的地方。

但是，指定主题是有效的

```
select ?p ?o
where
{dbpedia:Animal ?p ?o.}
LIMIT 100 
```

为什么指定谓词或对象不起作用的任何想法？

注意：确切的查询在 DBpedia 上工作得很好。因此，我怀疑 Fuseki，但我无法确定它不起作用的原因

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T08:36:50.957

我加载了数据，您的查询对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-17T20:20:57.817

它也适用于我的机器（ubuntu 14.0，Fuseki v1）

# objective-c - 从主应用程序启动 Mac OS X (LoginItem) 帮助应用程序

> ID：15256047
> 
> 赞同：5
> 
> 时间：2013-03-06T19:17:06.280
> 
> 标签：objective-c, macos, cocoa, appstore-sandbox

我在 Main.app/Library/LoginItems 文件夹中有一个应用程序**Main.app**和一个应用程序**Helper.app**。Main.app可由用户启动，然后用户可以将Helper.app设置为登录项。（使用 SMLoginItemSetEnabled()），这非常有效。当用户将 Helper.app 设置为登录项时，它也会启动。

但是，也应该可以在不将其设置为登录项的情况下启动 Helper.app。我试过用

```
[[NSWorkspace sharedWorkspace] launchApplication: newPath]; 
```

这给出了一个*lsboxd: Not allowed process to launch...*错误，并且

```
[NSTask launchedTaskWithLaunchPath:newPath arguments: [NSArray array]]; 
```

这给出了*拒绝禁止沙盒重新初始化*错误。（大概是因为 Helper.app在 Main.app*里面*？）

newPath 找到如下：

```
NSMutableArray *pathComponents = [NSMutableArray arrayWithArray:[[[NSBundle mainBundle] bundlePath] pathComponents]];
[pathComponents addObject:@"Contents"];
[pathComponents addObject:@"Library"];
[pathComponents addObject:@"LoginItems"];
[pathComponents addObject:@"Helper.app"];
[pathComponents addObject:@"Contents"];
[pathComponents addObject:@"MacOS"];
[pathComponents addObject:@"Helper"];
NSString *newPath = [NSString pathWithComponents:pathComponents]; 
```

我怎样才能解决这个问题？:)

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T11:06:51.977

您还可以使用 NSTask 和 launchctl。示例 或者您可以使用 NSTask 和 bash 脚本。例子：

```
#Run Menu
if [ $(ps -u $USERNAME | grep -v grep | grep -m1 '/Library/Menu/Menu.app/Contents/MacOS/Menu' | awk '{print $5}') ]; then 
    echo "Menu already  running";
else 
    echo "Menu not  running"
    if [ $(users $USERNAME ) == $USERNAME ]; then
        echo "User logined"
        echo "running menu for user $USERNAME"
        sudo -u $USERNAME /Library/Menu/Menu.app/Contents/MacOS/Menu&
    else
        echo "User not logined"
    fi
fi 
```

# php - 自动删除目录中的所有文件？

> ID：15256048
> 
> 赞同：0
> 
> 时间：2013-03-06T19:17:06.630
> 
> 标签：php, file, webserver, file-management

在 PHP 中，如何在不删除目录本身的情况下每 24 小时删除目录中的所有文件？它必须在 PHP 中，不能是 Cron Job。

您能否也提供代码背后的解释？我还在学习PHP。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:17:58.407

如果不使用 PHP，则无法在 PHP 中执行此操作。对不起。

开玩笑，但如果你想这样做，你需要某种任务调度程序（如 cron）。

也就是说，您可以对您的个人计算机进行编程，使其每 24 小时向服务器发送一次请求，但您要么必须手动完成，要么在本地安排任务。

我的意思是，您需要 cron，但它不需要与 PHP 文件在同一主机上运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T19:53:00.213

如果没有 cron，您必须将这样的代码添加到常用页面中：

```
$scheduledclean = strtotime("midnight"); // 00:00:00 of the current day
$lastcleanfile = '/path/to/my/app/lastclean';
$lastcleantime = (file_exists($lastcleanfile)) ? filemtime($lastcleanfile) : 0;
$curtime = time();

if( ($curtime > $scheduledclean) && ($lastcleantime < $scheduledclean) ) {
    touch($lastcleanfile); //touch first to prevent multiple executions
    // file cleanup code here
} 
```

在午夜之后对页面的第一个请求时，清理将启动，但是发出请求的不幸的人可能会延迟为他们的页面提供服务，这与清理所需的时间一样长。您可以通过将清理作为后台 shell 命令运行来缓解这种情况，例如`shell_exec('rm -rf /path/to/dir/* &');`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:43:34.963

我很久以前做过类似的事情。这是一个糟糕的主意，但是您可以拥有一个文件来存储您的目录最后一次被清除的时间。每次用户访问相关页面时，在 PHP 脚本中检查该文件（您也可以检查修改时间）。如果已经足够远，请更新文件并运行您的删除脚本。

缺点：

*   不保证每 24 小时运行一次（也许你有一天没有访客）
*   每天让一位用户等待更长的时间
*   丑陋的

至于删除文件，

```
function delete_contents( $dirpath ) {
    $dir = opendir( $dirpath );
    if( $dir ) {
        while( ($s = readdir( $dir )) !== false ) {
            if( is_dir( $s ) ) {
                delete_contents( $s );
                rmdir( $s );
            } else {
                unlink( $s );
            }
        }
        closedir( $dir );
    }
} 
```

要非常小心。在粗略的服务器设置上，`delete_contents('/')`将删除每个文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:22:22.457

1.  制作一个删除目录中所有文件的 PHP 脚本，查找函数[readdir()](http://www.php.net/manual/en/function.readdir.php)和[unlink()](http://php.net/manual/en/function.unlink.php)来删除文件。

2.  设置[Cron 作业](http://www.google.nl/search?client=opera&q=cron%20job&sourceid=opera&ie=utf-8&oe=utf-8&channel=suggest)以每 24 小时自动运行一次脚本。您必须如何执行此操作完全取决于您的主机。您还可以使用以下网站：[http ://www.google.nl/search?q=cronjobs+webservice](http://www.google.nl/search?q=cronjobs+webservice)

祝你好运！

# php - 通过 POST 向 PHP 发送 HTML 字符串。回显时得到奇怪的字符

> ID：15256051
> 
> 赞同：0
> 
> 时间：2013-03-06T19:17:17.513
> 
> 标签：php, html, post, encoding, echo

所以我正在制作一个简单的脚本，我通过 POST 向 PHP 发送一个 HTML 字符串，当我尝试回显它时，它会被一些奇怪的字符编码

我发送的字符串：

```
'Yo <i>whats up</i>' 
```

当我用 PHP 回显它时我得到了什么

```
Yo+%3Ci%3Ewhats+up%3C%2Fi%3E 
```

这里发生了什么？是否有一些 PHP 方法可以用来将其恢复为原始 HTML 字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:20:07.030

你想用

```
echo htmlspecialchars(urldecode('Yo+%3Ci%3Ewhats+up%3C%2Fi%3E')); 
```

原因是您的数据被[x-www-form-urlencoded](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.1)用于发布。所以在服务器端，你必须再次解码——这就是[urldecode()](http://php.net/manual/en/function.urldecode.php)所做的。

[htmlspecialchars()](http://www.php.net/manual/en/function.htmlspecialchars.php)阻止您的 HTML-Tags 被呈现，因此它们仅显示为字符串（如果这是您想要的）。

因此，在 HTML 上下文中，`echo urldecode('Yo+%3Ci%3Ewhats+up%3C%2Fi%3E');`将输出

> 哟*怎么了*

如果你还用 htmlspecialchars() 包装它，你的输出将是

> `Yo <i>whats up</i>`

再次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T19:20:31.880

看起来您的帖子字符串正在为 url 编码。

您可以使用 urldecode 删除这些字符

```
echo urldecode($_POST['string']); 
```

# exception - 在 Glassfish 中部署 ADF 时出现异常

> ID：15256055
> 
> 赞同：1
> 
> 时间：2013-03-06T19:17:25.500
> 
> 标签：exception, deployment, glassfish-3, oracle-adf, jdeveloper

嗨，我正在使用 Jdeveloper glassfish 3.1.2.2 在 ubuntu 中制作 Fusion Web 应用程序 ADF。我在部署我的网络应用程序时遇到了这个异常。

> 部署期间发生错误：加载应用程序时出现异常：java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalArgumentException: java.lang.ClassNotFoundException: oracle.adf.share.glassfish .listener.ADFGlassFishAppLifeCycleListener。有关详细信息，请参阅 server.log

```
[#|2013-03-06T20:13:56.349+0100|WARNING|glassfish3.1.2|org.apache.catalina.connector.Request|_ThreadID=16;_ThreadName=Thread-2;|PWC4011: Unable to set request character encoding to UTF-8 from context , because request parameters have already been read, or ServletRequest.getReader() has already been called|#]

[#|2013-03-06T20:13:56.604+0100|INFO|glassfish3.1.2|org.glassfish.admingui|_ThreadID=16;_ThreadName=Thread-2;|GUI deployment: uploadToTempfile|#]

[#|2013-03-06T20:13:56.653+0100|INFO|glassfish3.1.2|org.glassfish.admingui|_ThreadID=16;_ThreadName=Thread-2;|uploadFileName=Application4_ViewController_webapp.war|#]

[#|2013-03-06T20:13:59.664+0100|WARNING|glassfish3.1.2|global|_ThreadID=25;_ThreadName=Thread-2;|Error in annotation processing: java.lang.NoClassDefFoundError: weblogic/servlet/http/AbstractAsyncServlet|#]

[#|2013-03-06T20:13:59.714+0100|WARNING|glassfish3.1.2|global|_ThreadID=25;_ThreadName=Thread-2;|Error in annotation processing: java.lang.NoClassDefFoundError: weblogic/servlet/http/AbstractAsyncServlet|#]

[#|2013-03-06T20:13:59.828+0100|SEVERE|glassfish3.1.2|org.apache.catalina.core.ContainerBase|_ThreadID=25;_ThreadName=Thread-2;|ContainerBase.addChild: start: 
org.apache.catalina.LifecycleException: java.lang.IllegalArgumentException: java.lang.ClassNotFoundException: oracle.adf.share.glassfish.listener.ADFGlassFishAppLifeCycleListener
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:5332)
    at com.sun.enterprise.web.WebModule.start(WebModule.java:498)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:917)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:733)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:2019)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1669)
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:109)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at org.glassfish.admin.rest.ResourceUtil.runCommand(ResourceUtil.java:214)
    at org.glassfish.admin.rest.ResourceUtil.runCommand(ResourceUtil.java:207)
    at org.glassfish.admin.rest.resources.TemplateListOfResource.createResource(TemplateListOfResource.java:148)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)
    at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)
    at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer._service(GrizzlyContainer.java:182)
    at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer.service(GrizzlyContainer.java:147)
    at org.glassfish.admin.rest.adapter.RestAdapter.service(RestAdapter.java:148)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.IllegalArgumentException: java.lang.ClassNotFoundException: oracle.adf.share.glassfish.listener.ADFGlassFishAppLifeCycleListener
    at org.apache.catalina.core.StandardContext.addListener(StandardContext.java:2743)
    at org.apache.catalina.core.StandardContext.addApplicationListener(StandardContext.java:1966)
    at com.sun.enterprise.web.TomcatDeploymentConfig.configureApplicationListener(TomcatDeploymentConfig.java:235)
    at com.sun.enterprise.web.TomcatDeploymentConfig.configureWebModule(TomcatDeploymentConfig.java:94)
    at com.sun.enterprise.web.WebModuleContextConfig.start(WebModuleContextConfig.java:274)
    at com.sun.enterprise.web.WebModuleContextConfig.lifecycleEvent(WebModuleContextConfig.java:172)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:149)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:5329)
    ... 62 more
Caused by: java.lang.ClassNotFoundException: oracle.adf.share.glassfish.listener.ADFGlassFishAppLifeCycleListener
    at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1509)
    at org.glassfish.web.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1359)
    at org.apache.catalina.core.StandardContext.loadListener(StandardContext.java:4806)
    at com.sun.enterprise.web.WebModule.loadListener(WebModule.java:1599)
    at org.apache.catalina.core.StandardContext.addListener(StandardContext.java:2740)
    ... 69 more
|#]

[#|2013-03-06T20:13:59.829+0100|WARNING|glassfish3.1.2|javax.enterprise.system.container.web.com.sun.enterprise.web|_ThreadID=25;_ThreadName=Thread-2;|java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalArgumentException: java.lang.ClassNotFoundException: oracle.adf.share.glassfish.listener.ADFGlassFishAppLifeCycleListener
java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalArgumentException: java.lang.ClassNotFoundException: oracle.adf.share.glassfish.listener.ADFGlassFishAppLifeCycleListener
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:921)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:733)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:2019)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1669)
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:109)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at org.glassfish.admin.rest.ResourceUtil.runCommand(ResourceUtil.java:214)
    at org.glassfish.admin.rest.ResourceUtil.runCommand(ResourceUtil.java:207)
    at org.glassfish.admin.rest.resources.TemplateListOfResource.createResource(TemplateListOfResource.java:148)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)
    at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)
    at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer._service(GrizzlyContainer.java:182)
    at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer.service(GrizzlyContainer.java:147)
    at org.glassfish.admin.rest.adapter.RestAdapter.service(RestAdapter.java:148)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:662)
|#]

[#|2013-03-06T20:13:59.832+0100|SEVERE|glassfish3.1.2|javax.enterprise.system.tools.admin.org.glassfish.deployment.admin|_ThreadID=25;_ThreadName=Thread-2;|Exception while invoking class com.sun.enterprise.web.WebApplication start method
java.lang.Exception: java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalArgumentException: java.lang.ClassNotFoundException: oracle.adf.share.glassfish.listener.ADFGlassFishAppLifeCycleListener
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:138)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at org.glassfish.admin.rest.ResourceUtil.runCommand(ResourceUtil.java:214)
    at org.glassfish.admin.rest.ResourceUtil.runCommand(ResourceUtil.java:207)
    at org.glassfish.admin.rest.resources.TemplateListOfResource.createResource(TemplateListOfResource.java:148)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)
    at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:134)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)
    at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer._service(GrizzlyContainer.java:182)
    at com.sun.jersey.server.impl.container.grizzly.GrizzlyContainer.service(GrizzlyContainer.java:147)
    at org.glassfish.admin.rest.adapter.RestAdapter.service(RestAdapter.java:148)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:662)
|#]

[#|2013-03-06T20:13:59.834+0100|SEVERE|glassfish3.1.2|javax.enterprise.system.core.com.sun.enterprise.v3.server|_ThreadID=25;_ThreadName=Thread-2;|Exception while loading the app|#]

[#|2013-03-06T20:13:59.842+0100|SEVERE|glassfish3.1.2|javax.enterprise.system.tools.admin.org.glassfish.deployment.admin|_ThreadID=25;_ThreadName=Thread-2;|Exception while loading the app : java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalArgumentException: java.lang.ClassNotFoundException: oracle.adf.share.glassfish.listener.ADFGlassFishAppLifeCycleListener|#]

[#|2013-03-06T20:13:59.899+0100|INFO|glassfish3.1.2|org.glassfish.admingui|_ThreadID=16;_ThreadName=Thread-2;|Exception Occurred :Error occurred during deployment: Exception while loading the app : java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: java.lang.IllegalArgumentException: java.lang.ClassNotFoundException: oracle.adf.share.glassfish.listener.ADFGlassFishAppLifeCycleListener. Please see server.log for more details.|#] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:40:52.440

根据对 Shay 关于部署到 ADF Essentials 的博客条目的回复 ( [https://blogs.oracle.com/shay/entry/deploying_oracle_adf_applications_to](https://blogs.oracle.com/shay/entry/deploying_oracle_adf_applications_to) )：

“ADFGlassFishAppLifeCycleListener 是 adf-share-glassfish.jar 文件的一部分，如果您让 JDeveloper 知道您正在通过应用程序级别的部署配置文件部署到 GlassFish（上面的步骤 4,5），该文件将添加到您的 EAR 文件中。如果您有唯一一个不会发生这种情况的 JDeveloper 实例，那么只需将该 JAR 手动添加到您的 EAR 中。”

# c# - 绑定操作在局部视图之外不起作用

> ID：15256056
> 
> 赞同：0
> 
> 时间：2013-03-06T19:17:26.273
> 
> 标签：c#, javascript, jquery, asp.net-mvc

当我从 PartialView 中取出单击操作 jquery 时，代码停止工作：

局部视图：

```
@model Heelp.ViewModels.CategoryGetAllBySearchListViewModel

<p class="float-left margin-top align-left"><span>Encontrámos <em><a href="#">@Model.TotalSearchCount</a></em> resultados nas categorias:</span></p>
<div class="clear-both">
    <div id="searchResultsList" class="float-left">
        <ul>
            @foreach (var item in Model.CategoryGetAllBySearch)
            {
                <li>
                    @Html.ActionLink(
                        String.Format("{0} {1} ver »", item.SearchCount, item.Name),
                        MVC.Company.GetAllByCategory(item.Id, Model.Search, Model.Location, Model.IsCenterFromUser, Model.CenterLng, Model.CenterLat, Model.SearchRadius),
                        new { id = "getCompanies" })
                </li>
            }        
        </ul>
    </div>
</div>
<script>

$("#getCompanies").on("click", function() 
{
    $.ajax({
        url: this.href,
        cache: false,
        success: function (result) {
            companyGetAllByCategoryOnSuccess(result);
        }
    });

    return false;
});

</script> 
```

如果我把脚本代码放在一个外部的JS文件中，代码不起作用，为什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T00:51:25.947

我从项目中删除了所有验证和不显眼的 js 文件，并从 NuGet 重新加载它们，一切都得到了解决。

谢谢您的帮助。

# hibernate - Hibernate JPA 不在集合表中为空值插入行

> ID：15256061
> 
> 赞同：5
> 
> 时间：2013-03-06T19:17:49.073
> 
> 标签：hibernate, jpa, collections, null

我尝试过使用 List 和 Map，但我无法弄清楚如何强制 Hibernate 3.6.4 在这些集合中保留空值。这是我尝试过的：

```
@ElementCollection(fetch=FetchType.EAGER)
@Column(columnDefinition="longtext")
private Map<Integer, String> parameterValues; 
```

和

```
@ElementCollection(fetch=FetchType.EAGER)
@OrderColumn
@Lob @Column(length=65535)
private List<String> parameterValues; 
```

如果 Map 或 List 包含一个空值，Hibernate 不会将它持久保存在集合表中的一行中。从数据库中检索集合时，它的元素比存储时少，因为那些为 null 的元素不会被恢复。列表恢复了具有非空值的第一个和最后一个索引之间的索引的空值，但列表末尾的任何空值都被忽略了。Map 仅包含非空值的条目。

我希望这是有道理的。对我来说，这似乎是 Hibernate 中的一个错误，但我希望它可以通过不同的配置来修复。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T16:45:55.637

原来这是 Hibernate 中的一个错误......好吧，不是根据 Gavin King 的说法，而是根据许多其他想将 Null 存储在 DB 中的人的说法。见[HHH-772](https://hibernate.atlassian.net/browse/HHH-772)。这个问题显然永远不会得到解决。

因此，我不得不通过为我的参数值添加一个 @Embeddable 类来解决它，该类在数据库中愉快地存储一个空值，如下所示：

```
@Embeddable
@Access(AccessType.FIELD)
public final class ParameterValue {
    @Basic(optional=false)
    private int id;

    @Column(columnDefinition="longtext")
    private String value;

    /** For JPA */
    ParameterValue() {} 

    public ParameterValue(int id, String value) {
            this.id = id;
        this.value = value;
    }

    /**
     * @return the id
     */
    public int getId() {
            return id;
    }

    /**
     * @return the value
     */
    public String getValue() {
            return value;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T20:06:29.033

我似乎有同样的问题，但是：

1.  发生在**Oracle** 11g 上，但**不在**MySQL 上，**也不**在 HSQL 上
2.  对我来说，*空白*值似乎也是插入表时自动变成*空值的问题*
3.  这些行的值为*null*并且 Hibernate 加载的集合是空的（实际上是空的，因为地图只有一个条目）（尝试了 Hibernate 3.6.8、3.6.10 和 4.1.10）
4.  然后发生的情况是，当我更新 Map 时，Hibernate 想要更新集合（Hibernate 认为它是空的），而数据库中已经存在相同的条目，导致 ORA-00001 Unique Constraint Violation

我想知道在表格中插入*空白*变为*空的神奇之处是什么。**为空白*和*空*值插入伪值似乎很乏味。我再次指出，我只有在**Oracle**下才有问题。相同的软件在 MySQL 和 HSQL 下运行良好。

# php - 需要 html 复选框由 mysql 结果检查

> ID：15256062
> 
> 赞同：1
> 
> 时间：2013-03-06T19:17:56.417
> 
> 标签：php, javascript, html, mysql

我需要通过 mysql 选择结果检查一个复选框...

这是我的mysql表

```
username | hobbies              
----------------------------
abc      | reading painting 
```

当我选择用户名'abc'并提交时，它进入编辑页面..

在那个页面我需要编辑爱好..

```
<html>
<body>
<input type="checkbox" name="hobbies[]" value="reading">Reading
<input type="checkbox" name="hobbies[]" value="painting">painting
<input type="checkbox" name="hobbies[]" value="gaming">gaming
</body>
<html> 
```

当我用爱好阅读和绘画选择'abc'时，只有第一个和第二个复选框必须选中......我怎么能用php，mysql做到这一点？请帮助......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:27:10.690

首先将数据库记录拆分为单独的数组条目

```
<?php
    $hobbies = explode(" ", $mysql_result['hobbies']);
?> 
```

然后检查每个值是否数组包含该值并将复选框设置为选中

```
<input type="checkbox" name="hobbies[]" value="reading" <?php if(in_array("reading", $hobbies)) echo "checked=\"checked\""; ?>>Reading 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:23:18.283

您必须使用以下 HTML 标签：

```
<input type="checkbox" name="hobbies[]" value="reading" checked="checked" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:24:42.700

```
<input type="checkbox" name="hobbies[]" value="reading" <?php echo status;?>>Reading 
```

然后让您的 php 根据您的 SQL 查询确定复选框的状态并将其存储在变量中

```
status 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:48:01.600

考虑更改您的架构。每个字段都应该是原子的 - 具有一个值。

创建一个爱好表，更改用户表，添加一个表以启用用户和爱好之间的多对多关系。创建一个显示用户爱好的视图。

这意味着您将能够执行类似的查询。

```
select * from `hobby` ; -- means your hobby check box can now be created dynamically
select * from `username_hobby` where username_id = 1 ; -- means you already have the username hobbies as separate elements. 
```

有关数据规范化的更多详细信息 => [https://www.google.com.au/search?q=atomic+data+normalization](https://www.google.com.au/search?q=atomic+data+normalization)

sqlfiddle 示例[http://sqlfiddle.com/#!2/5cdef/1/0](http://sqlfiddle.com/#!2/5cdef/1/0)

建议的架构如下。

```
DROP TABLE IF EXISTS `hobby`;

CREATE TABLE `hobby` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `hobby` varchar(31) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `hobby` (`id`, `hobby`)
VALUES
    (1,'reading'),
    (2,'painting'),
    (3,'gaming');

DROP TABLE IF EXISTS `username`;

CREATE TABLE `username` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `username` varchar(31) DEFAULT '',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `username` (`id`, `username`)
VALUES
    (1,'abc');

DROP VIEW IF EXISTS `username_hobbies_view`;

CREATE TABLE `username_hobbies_view` (
   `username` VARCHAR(31) DEFAULT '',
   `hobby` VARCHAR(31) DEFAULT NULL,
   `username_id` INT(11) UNSIGNED NOT NULL,
   `hobby_id` INT(11) UNSIGNED NOT NULL
) ENGINE=MyISAM;

DROP TABLE IF EXISTS `username_hobby`;

CREATE TABLE `username_hobby` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `username_id` int(11) unsigned NOT NULL,
  `hobby_id` int(11) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  KEY `username_relationship` (`username_id`),
  KEY `hobby_relationship` (`hobby_id`),
  CONSTRAINT `hobby_relationship` FOREIGN KEY (`hobby_id`) REFERENCES `hobby` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `username_relationship` FOREIGN KEY (`username_id`) REFERENCES `username` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `username_hobby` (`id`, `username_id`, `hobby_id`)
VALUES
    (1,1,1),
    (2,1,2);

DROP TABLE `username_hobbies_view`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `username_hobbies_view`
AS SELECT
   `username`.`username` AS `username`,
   `hobby`.`hobby` AS `hobby`,
   `username_hobby`.`username_id` AS `username_id`,
   `username_hobby`.`hobby_id` AS `hobby_id`
FROM ((`username` join `username_hobby` on((`username`.`id` = `username_hobby`.`username_id`))) join `hobby` on((`hobby`.`id` = `username_hobby`.`hobby_id`))); 
```

# iphone - 自定义类“无法识别的选择器发送到实例”

> ID：15256066
> 
> 赞同：1
> 
> 时间：2013-03-06T19:18:04.317
> 
> 标签：iphone, ios, objective-c, cocoa-touch

### 背景故事

我目前正在创建一个处理/模仿 Facebook 菜单应用程序外观的自定义类，我已经在一个单独的项目（工作）中创建了这个功能，并认为使代码可重用是一个好主意。

### 问题

我收到“无法识别的选择器发送到实例”错误，而我确实确定我已经实现了“处理”方法，但我无法弄清楚出了什么问题。如果有人愿意帮助我。或者把我推向正确的方向

### 编辑

我的输出窗口生成的完整错误

> 2013-03-06 19:56:39.520 SwipeMenuProject[14347:c07]-[__NSArrayM 句柄：]：无法识别的选择器发送到实例 0x7558310

### 编码

> UISwipeMenuControl.m

```
#import "UISwipeMenuControl.h"

@implementation UISwipeMenuControl

@synthesize frontWindow = _frontWindow, backWindow = _backWindow, navController = _navController, btnHandle = _btnHandle;

-(id)init
{
    self.frontWindow = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.backWindow = [[UIWindow alloc] initWithFrame:CGRectMake(-61,0,[[UIScreen mainScreen] bounds].size.width,[[UIScreen mainScreen] bounds].size.height)];

    self.btnHandle = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    [self.btnHandle setFrame:CGRectMake(0, 0, 60, 20)];
    [self.btnHandle setTitle:@"Handle" forState:UIControlStateNormal];

    UIPanGestureRecognizer * dragGesture = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handle:)];
    [self.btnHandle addGestureRecognizer:dragGesture];

    UIViewController * viewController = [[UIViewController alloc] initWithNibName:nil bundle:nil];
    [viewController setTitle:@"Swipe Menu"];
    [viewController.navigationItem setLeftBarButtonItem:[[UIBarButtonItem alloc] initWithCustomView:self.btnHandle]];

    self.navController = [[UINavigationController alloc] initWithRootViewController:viewController];
    [self.frontWindow setRootViewController:self.navController];

    return self;
}

-(UIWindow *)getFrontWindow
{
    return self.frontWindow;
}

-(UIWindow *)getBackWindow
{
    return self.backWindow;
}

-(UINavigationController *)getNavigationController
{
    return self.navController;
}

-(void) setRootViewController:(UIViewController *)viewController
{
    self.navController = [[UINavigationController alloc] initWithRootViewController:viewController];
    [viewController.navigationItem setLeftBarButtonItem:[[UIBarButtonItem alloc] initWithCustomView:self.btnHandle]];
    [self.frontWindow setRootViewController:self.navController];
}
-(void)handle:(id)sender
{
    //unrelated code here
} 
```

> Appdelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    UISwipeMenuControl * swipeMenu = [[UISwipeMenuControl alloc] init];

    CustomViewController * cViewController = [[CustomViewController alloc] initWithNibName:nil bundle:nil];
    [swipeMenu setRootViewController:cViewController];

    self.window = [swipeMenu getFrontWindow];
    [self.window setBackgroundColor:[UIColor redColor]];
    [self.window makeKeyAndVisible];

    return YES;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:26:27.827

看起来这是一个所有权/内存问题。`UISwipeMenuControl`当识别器发送它的动作时，它似乎被释放了。

让僵尸调查这是否是问题所在。

# c# - 在 Excel 中设置条件图标集

> ID：15256068
> 
> 赞同：1
> 
> 时间：2013-03-06T19:18:08.087
> 
> 标签：c#, excel

使用 c# 向工作表添加条件格式时
如何设置正在使用的 IconSet？
下面目前不工作。它给了我一组默认图标，但不是我想要的。

```
Excel.IconSetCondition cfIconSet =
    (Excel.IconSetCondition)excelWorksheet.get_Range(cellNumber, cellNumber)
      .FormatConditions
      .AddIconSetCondition();
cfIconSet.IconSet = Excel.XlIconSet.xl3Flags; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:35:04.053

解决了

```
cfIconSet.IconSet = cfIconSet.IconSet(Excel.XlIconSet.xl3Flags); 
```

# php - 动态创建链接，并为链接创建内容，php

> ID：15256075
> 
> 赞同：0
> 
> 时间：2013-03-06T19:18:30.050
> 
> 标签：php, on-the-fly

我有一个 index.php，它调用一个函数 post_themes_front()，该函数从 SQL 数据库中获取所有“帖子”并创建所有内容，包括链接。示例：图片 A 链接到 www.index.com/picture_a_name

代码示例：

```
while($row = mysql_fetch_array($result))
    {

    echo '

     <div class="post">
        <h2>

        <a href=http://www.meetthemes.com/'. $row['name'] .'" title="'. $row['name'] .'">'. $row['name'] .'</a>
        </h2>

    <div class="infos b20">

     By <em>MeetThemes</em> on <em>'. $row['date'] .'</em>

     <span class="label label-important pull-right">'. $row['views'] .' views</span> 
     <a href="http://www.meetthemes.com/'. $row['name'] .'#comments" class="label label-info pull-right r5" title="Comments">'. $row['comments'] .'</a>
     <a href="http://www.meetthemes.com/'. $row['name'] .'" class="label label-info pull-right r5">'. $row['catagory'] .'</a>
     <a href="http://www.meetthemes.com/'. $row['catagory'] .'" class="label label-info pull-right r5">'. $row['catagory'] .'</a>
  </div>

  <p>
     <a href="http://www.meetthemes.com/'. $row['name'] .'" title="ThemeForest - Silicon - Responsive WordPress Theme">
     <img alt="ThemeForest - Silicon - Responsive WordPress Theme" src="img/'. $row['image_path'] .'" class="post_img" />
     </a>
     </div>
    ';
} 
```

没有像“picture_a_name”这样的文件，当用户点击它时，id 喜欢创建它，并将从 SQL 获取的评论、链接等的适当值发送给他。

但是点击创建它是否为时已晚？

是否必须在此之前创建？我可以创建一个函数来创建索引中所有帖子的内容，并在索引上调用它，然后单击将它们发送到那里，但这会占用相当多的客户端资源.....在加载时间的情况下（我知道它的服务器端）...

欢迎任何建议

我想要实现的示例，newone.org 的首页，包含大量“帖子”，它们都链接到单独的内容。

我知道有很多 CMS 可以为我做这件事，但我不喜欢使用 drupal / joomla / wordpress

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:36:05.180

您可以做的是制作一个[.htaccess](http://en.wikipedia.org/wiki/Htaccess)文件，该文件会捕获对不存在文件的所有请求，如下所示：

```
<IfModule mod_rewrite.c>
  RewriteEngine On

  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^(.*)$ createContent.php?file=$1 [QSA,L]
</IfModule> 
```

因此，当 'picture_a_name' 不存在时，请求被重定向到**createContent.php?file=picture_a_name**。在 createContent 中，您现在可以创建询问的内容并将其保存到“picture_a_name”。

# sql - 如何改进此查询？

> ID：15256082
> 
> 赞同：1
> 
> 时间：2013-03-06T19:18:50.787
> 
> 标签：sql, oracle

以下查询有效，但不是特别快：

```
select distinct controlid, (
                select max(Orderno) From my_table
                Where ControlID = #param1#
                    and a = 3 and b = 13 and c = 0 and d = 0
            ) colA, (
                Select max(Orderno) From my_table
                Where ControlID = #param1#
                    and a = 2
            ) colB, (
                Select max(Orderno) From my_table
                Where ControlID = #param1# 
                    and a = 1 and b = 14 and e = 1
            ) colC, (
                Select max(Orderno) From my_table
                Where ControlID = #param1# 
                    and a = 3 and b = 13 and e = 1 and c = 0 and d = 0
            ) colD, (
                Select a From my_table
                Where ControlID = #param1#
                    and Orderno = #param2#  
            ) colE
            from my_table
            where controlid = #param1# 
```

被查询的表有超过 300K 行，并且特定 controlid（在 distinct 子句之前）的行数从 1 到 61 不等。分析器说响应时间是 234/42 毫秒。表上没有索引。

显然，缺少索引是一个问题，但除此之外，任何人都可以推荐一种更有效的方式来编写这个查询吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T19:26:18.897

使用聚合而不是子查询：

```
select distinct controlid, 
  max (case when a=3 and b=13 and c=0 and d= 0 then OrderNo end) as colA,
  max (case when a=2                           then OrderNo end) as colB,
  max (case when a=1 and b=14 and e=1          then OrderNo end) as colC,
  max (case when a=3 and b=13 and e=1 and c=0 and d=0 then OrderNo end) as colD,
  max (case when OrderNo=#param2# then a end) as colE
from my_table
where controlid = #param1#
group by controlid 
```

我不知道您使用哪个 RDBMS，因此`case when`可能必须将构造修改为您的本地方言。这个应该对 MSSQL 有效

更新：我的眼镜不能正常工作，所以我没有注意到 ORACLE 标签。尴尬...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T19:28:15.517

您应该能够避免多次打表并进行一次表扫描

```
SELECT controlID,
       MAX( CASE WHEN a = 3
                  AND b = 13
                  AND c = 0 
                  AND d = 0
                 THEN orderNo
                 ELSE NULL
              END) colA,
       MAX( CASE WHEN a = 2
                 THEN orderNo
                 ELSE NULL
              END) colB,
       MAX( CASE WHEN a = 1
                  AND b = 14
                  AND e = 1
                 THEN orderNo
                 ELSE NULL
              END) colC,
       MAX( CASE WHEN a = 3
                  AND b = 13
                  AND e = 1
                  AND c = 0
                  AND d = 0
                 THEN orderNo
                 ELSE NULL
              END) colD,
       MAX( CASE WHEN orderNo = #param2#
                 THEN a
                 ELSE NULL
              END) colE
  FROM my_table
 WHERE controlId = #param1#
 GROUP BY controlID 
```

当然，在表上拥有适当的索引并进行多次索引扫描可能会更有效。在不知道您的数据的情况下，很难知道。

# deployment - 在 EC2 中使用 Rubber 部署 Rails 应用程序后无法连接到服务器

> ID：15256084
> 
> 赞同：0
> 
> 时间：2013-03-06T19:18:54.800
> 
> 标签：deployment, amazon-ec2

我刚刚在 EC2 上使用 Rubber 部署了 rails 应用程序。此外，还为数据库创建了一个 RDS 实例。跑

```
$ cat /etc/host 
```

在生产中获得橡胶配置为![在此处输入图像描述](../Images/4ebc8a1f62d80ddcfd0162dd1ee5ae56.png)

但是当我浏览[http://web01.musemebackend.com/admin/login](http://web01.musemebackend.com/admin/login)时，我得到了“504 Gateway Time-out, server didn't response time”的错误

apache2中的错误日志显示：

```
[ pid=1813 thr=12161140 file=utils.rb:176 time=2013-03-06 20:49:28.175 ]: 
*** Exception PhusionPassenger::UnknownError in PhusionPassenger::Rack::ApplicationSpawner (Can't connect to MySQL server on 'musemedb.cfmz4gvshyts.us-east-1.rds.amazonaws.com' (110) (Mysql2::Error)) (process 1813, thread #<Thread:0x000000017320e8>): 
```

当我修改 config/database.yml 时：

```
production:
  adapter: mysql2
  encoding: utf8
  database: muse_me_backend_production
  username: app_admin
  password: MYPASSWORD
  host: musemedb.cfmz4gvshyts.us-east-1.rds.amazonaws.com
  port: 3306 
```

修改 config/rubber/rubber-mysql.yml 为：

```
# REQUIRED: The credentials for creating/accessong your app's database
#
db_user: app_admin
db_pass: MYPASSWORD
db_name: muse_me_backend_production
db_host: musemedb.cfmz4gvshyts.us-east-1.rds.amazonaws.com 
```

和 config/rubber/common/database.yml 作为

```
<%
  @path = "#{Rubber.root}/config/database.yml"
%>

<%= Rubber.env %>:
  adapter: <%= YAML::load(File.open("#{Rubber.root}/config/database.yml"))["production"]["adapter"] %>
  encoding: utf8
  database: <%= rubber_env.db_name %>
  username: <%= rubber_env.db_user %>
  password: <%= rubber_env.db_pass %>
  host: <%= rubber_env.db_host %>
  pool: 5 
```

该应用程序应已成功部署。数据库迁移也很成功。连接服务器有什么我错过的吗？我需要拥有musemebackend.com 的域名吗？现在我不拥有它。我在教程中看到它只是 foo.com。这有关系吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T21:31:25.380

问题是我没有将应用角色实例的安全组添加到数据库安全组。现在它被修复了。

# javascript - 如何使用 jquery 或 javascript 修改标记的 src 属性的值

> ID：15256089
> 
> 赞同：1
> 
> 时间：2013-03-06T19:19:12.843
> 
> 标签：javascript, jquery

我正在解析一个 html 字符串片段并更改图像标签的 src 属性。（即替换以“..”开头的路径

```
var hstr = $.parseHTML(str);
$(hstr).find('img').each(function(e){
var srcvalue = $(this).attr('src');
srcvalue = srcvalue.replace(/../gi, "");
$(this).attr('src', srcvalue);
}); 
```

然后通过附加结果来设置 div 元素的内容

```
document.getElementById('#section').append($(hstr)); 
```

但它不工作......谁能告诉我出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:21:14.867

不要搞乱纯 JS DOM 和 Jquery。利用`$('#section').append($(hstr))`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T19:22:48.820

*不要与 Jquery [(#ID)](http://api.jquery.com/id-selector/)选择器*混淆，使用任何一个

```
$('#section').append($(hstr)); 
```

或（在 DOM 元素中*不需要`#`和使用 appendChild*）

```
document.getElementById('section').appendChild($(hstr)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:21:07.573

您应该附加被操纵的对象，您正在创建另一个对象，DOMElement 对象也没有`append`方法。

```
$(hstr).find('img').each(function(e){
    // ...
}).appendTo('#section'); 
```

使用`prop`方法：

```
$(hstr).find('img').prop('src', function(index, srcValue) {
    return srcValue.replace(/../g, "");
}).appendTo('#section'); 
```

# macros - C中没有定义的宏

> ID：15256090
> 
> 赞同：5
> 
> 时间：2013-03-06T19:19:19.300
> 
> 标签：macros, c-preprocessor

没有定义的宏功能的用途/适用性是什么：

```
#ifndef __SYSCALL
#define __SYSCALL(a, b)
#endif 
```

可以在 Linux 系统的头文件中找到这个宏`/usr/include/asm/msr.h`

我还注意到以下类型的宏。

```
#define _M(x) x 
```

并且唯一的理由是定义这种我认为使代码统一的宏。就像在[#define SOMETHING (1 << 0)](https://stackoverflow.com/questions/15095350/define-something-1-0)中一样。这种宏还有其他隐藏（更好）的用途吗？

带有示例的答案将非常有帮助。也有人可以给我一个文本/链接来阅读这个。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-06T21:34:09.537

这种形式的宏最常见的情况之一：

```
#define _M(x) x 
```

是为仅支持 C 的原始 K&R 方言的编译器提供向后兼容性，该方言早于现在无处不在的 ANSI C 方言。在该语言的原始 K&R 方言中，声明函数时未指定函数参数。1989 年，ANSI 对该语言进行了标准化并进行了许多改进，包括声明参数类型数量的函数原型。

```
int f(int x, double y); /* ANSI C. K&R compilers would not accept this */

int f(); /* Function declared in the original K&R dialect */ 
```

虽然现在支持 C 的原始 K&R 方言的编译器很少（或已绝迹），但当需要支持这两种编译器时编写了很多软件，而宏提供了一种支持这两种编译器的简单方法。仍然有很多提供这种向后兼容性的标头。

为了为 K&R 编译器提供向后兼容性，许多头文件具有以下内容：

```
#if ANSI_PROTOTYPES
#  define _P(x) x
#else
#  define _P(x) ()
#endif

...

int f _P((int x, double y)); 
```

如果`ANSI_PROTOTYPES`定义已正确设置（由用户或某些先前的`#ifdef`逻辑），那么您将获得所需的行为：

*   如果定义了 ANSI_PROTOTYPES，则定义扩展为`int f(int x, double y)`.
*   如果未定义 ANSI_PROTOTYPES，则定义扩展为`int f()`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-06T19:21:34.180

这通常与条件表达式一起使用，通过将宏预处理为空来禁用宏。例如（简化）：

```
#ifdef DEBUG
#define ASSERT(x) if(!(x)) { abort(); }
#else
#define ASSERT(x) /* nothing */
#endif 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-10T18:48:42.043

只是我的问题的后续行动。

我得到了很好的答案。但我还添加了一些更有用的示例，其中没有定义的宏很有用，将来会发现它很有帮助：

**(1)** :[*为什么我在 C 库中看到 THROW？*](https://stackoverflow.com/questions/2486386/why-do-i-see-throw-in-a-c-library?answertab=votes#tab-top)
用于在 C 和 C++ 之间共享头文件。宏名称是`_THROW(x)`

```
#ifdef __cplusplus
    #define __THROW(x) throw(x)
#else
    #define __THROW(x)
#endif 
```

**(2)** [*消除不使用函数参数时的警告：*](https://stackoverflow.com/questions/9187628/c-empty-function-macros/9187855#9187855)
此用途适用于 c++。[在 C 中，参数太少](http://codepad.org/WbSlIXkc)会导致错误但在[C++ 中，它可以正常工作](http://codepad.org/HJQs184z)：（*键盘链接*）

```
#define UNUSED(x)
int value = 0;
int foo(int UNUSED(value))
{
    return 42;
}
int main(){
   foo(value);
} 
```

（*为此我在我的问题中添加了 c++ 标签*）

另外，
**（3）：**的使用`#define _M(x) x`如下，只是为了让代码统一排列：

```
/* Signed.  */
 # define INT8_C(c)      c
 # define INT16_C(c)     c
 # define INT32_C(c)     c
 # if __WORDSIZE == 64
 #  define INT64_C(c)    c ## L
 # else
 #  define INT64_C(c)    c ## LL
 # endif 
```

文件是：[/usr/include/stdint.h](http://repo-genesis3.cbi.utsa.edu/crossref/ns-sli/usr/include/stdint.h.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-06T19:20:51.203

这意味着使用该宏的代码将有条件地预处理为空。

作为简单的示例，请考虑调试代码、日志记录或断言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-06T19:28:48.977

这可能是调试宏或平台宏。例如，假设我有一个附加到 INT3 的调试器。我调试的时候可能有这个

```
 #define debug() INT3() 
```

然后为了安全起见，我会将其添加到生产代码中（以确保我将它们全部取出）

```
 #define debug() 
```

这看起来像类似的东西

可能在某些情况下，在某些系统上，此代码需要调用——例如在某个 CPU 架构或操作系统上。但是在您的系统上，它只是没有操作。

# javascript - 在 JavaScript 中解析日期？

> ID：15256091
> 
> 赞同：-3
> 
> 时间：2013-03-06T19:19:23.203
> 
> 标签：javascript

有没有办法我可以从`'03/05/2013'`

如果是这样，怎么做？

谢谢

有没有一种安全的方法可以检查它的格式是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:23:52.410

您拥有`Date.parse`解析 Date 字符串并返回其时间戳的方法，因此您可以调用`new Date()`.

像这样的东西：

```
new Date(Date.parse('03/06/2013')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:29:25.090

最简单的是使用[split()](http://www.w3schools.com/jsref/jsref_split.asp)函数，我认为：

```
var date = "03/05/2013";
var dateParts = date.split("/");

var day = dateParts[0];
var month = dateParts[1];
var year = dateParts[2]; 
```

[http://jsfiddle.net/s7ma2/1/](http://jsfiddle.net/s7ma2/1/)

# php - 在 php.ini 中格式化日期。插入换行符

> ID：15256096
> 
> 赞同：2
> 
> 时间：2013-03-06T19:19:37.210
> 
> 标签：php

我正在使用 PHP 来显示日期和时间。是否可以显示它们之间的换行符？还是需要两次使用 date() 函数？

我有这行代码：

```
echo date('d-M-Y \n G:i', strtotime($thread[$i]['time'])); 
```

放置 \n 会产生一个新行，但 n 在第一行的末尾可见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-28T10:41:42.103

逃避`<br>`是一种解决办法。r 被转义了两次，因为它对日期函数和 CR 都有意义。

```
 date('d m \<\b\\r\> Y'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-07T18:10:37.140

我知道这是一个老问题，但我认为这可能会对某人有所帮助。我遇到了与操作员相同的问题。我发现使用 php 提供的[nl2br()](http://php.net/manual/en/function.nl2br.php)函数结合`\n`解决了这个问题，而其他似乎都没有。

## 例子：

```
nl2br(date("m/d/Y \n h:i:s A", $timestamp)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:20:42.017

请用户使用双引号输入“\n”

```
" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:22:34.443

如果这是一个 html 换行符，则必须添加元素 'br'

在您的字符串中，否则 Vineet1982 是文本换行符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-06T19:23:48.270

您需要使用双引号

> 如果字符串用双引号 (") 括起来，PHP 将为特殊字符解释更多的转义序列

见[http://php.net/manual/en/language.types.string.php](http://php.net/manual/en/language.types.string.php)

# sql-server - SQL Server 2005 小型数据库备份

> ID：15256098
> 
> 赞同：1
> 
> 时间：2013-03-06T19:19:43.567
> 
> 标签：sql-server

我有一个 SQL 2005 数据库，目前根本没有备份。我需要实施备份策略，但我不知道该怎么做。每天大约有 1% 的数据库更新，因此我需要至少每 30 分钟运行一次我的后台策略。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:32:20.723

尝试使用 [sqlbackupandftp](http://sqlbackupandftp.com/)它每天最多可以免费使用 2 个数据库。可以轻松备份到邮件 ftp 和保管箱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:02:38.957

根据您的描述很难给出建议，但我建议您查看此备份概述（特别是如果您负责为生产数据库制定备份策略）：

[http://msdn.microsoft.com/en-us/library/ms175477(v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms175477(v=sql.90).aspx)

你是如何达到每天更新 1% 的，我不确定.. 但如果真的是这种情况，那么我会特别注意差异备份选项。

# html - 使用 .htaccess 重定向到 403 页面时出现 404 错误？

> ID：15256100
> 
> 赞同：2
> 
> 时间：2013-03-06T19:19:54.593
> 
> 标签：html, .htaccess

我收到一个 404 问题：

```
Additionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request. 
```

我的 .htaccess 看起来像这样。我的 .htaccess 和 index.html 位于“bar”文件夹中：

```
 ErrorDocument 403 /public_html/foo/bar/errorpages/403.html

order deny,allow

deny from all

allow from 123.456 
```

* * *

我的错误页面中也有一个 .htaccess：

```
order deny,allow
allow from all 
```

我重定向错了吗？

**更新**

我也尝试将目录更改为

```
/bar/errorpages/403.html 
```

但仍然是同样的问题:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:25:15.383

尝试使用

```
order allow, deny 
```

反而。

看看[这里](http://www.htaccess-guide.com/deny-visitors-by-ip-address/)的例子。

# java - LinkedList 的迭代器类的 remove()

> ID：15256101
> 
> 赞同：2
> 
> 时间：2013-03-06T19:19:56.710
> 
> 标签：java, iterator, linked-list

所以我试图更好地理解 LinkedLists，一个练习告诉我为`remove()`我编写的链表类添加实现迭代器类的方法。我的迭代器类如下所示：

```
public java.util.Iterator<T> iterator() {
    return new java.util.Iterator<T>() {
        Node prev= null,curr = head;

        public boolean hasNext() {  
            if (curr != null) {
                return true;
            }
            return false;
        }

        public T next() {
            T temp = curr.data;
            prev = curr;
            curr = curr.next;
            return temp;
        }

        public void remove() {
            if(prev==null || curr==null)
                head=head.next;
            else
                prev.next=curr.next;
        }
    };
} 
```

我为它写的一个测试有点像这样：

```
public void testiterator(){
    BasicLinkedList<String> basicList = new BasicLinkedList<String>();
    basicList.addToFront("Blue").addToEnd("Red").addToFront("Yellow");
    for(Iterator<String> i = basicList.iterator(); i.hasNext();){
        if(i.next().equals("Blue"))
            i.remove();
    }
    assertTrue(basicList.toString().equals("\" Yellow Red \""));
} 
```

但是，当我打印 basicList 时，它告诉我列表包含黄色和蓝色而不是黄色和红色。我是在执行该`remove()`方法错误，是我使用它错误，还是两者兼而有之？

谢谢你们的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:34:39.517

问题在于`curr`它不是指返回的最后一个元素，而是指要返回的下一个元素。

`remove()`旨在删除前者，而您的方法删除了后者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:39:58.753

为什么不直接将当前节点设置为下一个节点。为什么要在 remove 方法中检查 null。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:53:33.940

试试这个伙伴：

```
public java.util.Iterator<T> iterator() {
    return new java.util.Iterator<T>() {
        Node<T> prev = null;
        Node<T> curr = null;

        public boolean hasNext() {
            if (curr == null) {
                return (head != null);
            }
            return (curr.next != null);
        }

        public T next() {
            if (!hasNext()) {
                return null;
            }
            if (curr == null) {
                curr = head;
            } else {
                prev = curr;
                curr = curr.next;
            }
            return curr.data;
        }

        public void remove() {
            if (curr != null) {
                if (prev != null) {
                    prev.next = curr.next;
                } else {
                    head = curr.next;
                }
            }
        }
    };
} 
```

# sql-server - SQL Server Management Studio 2012 中的 1:1 关系

> ID：15256106
> 
> 赞同：1
> 
> 时间：2013-03-06T19:20:19.413
> 
> 标签：sql-server, sql-server-2012, foreign-key-relationship, ssms

我想在 SQL Server Management Studio 2012 中创建一个 1:1 的关系，请帮助我，找不到正确的方法，每次我尝试它都会创建一个一对多的关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:23:50.373

您可以创建一个唯一约束，也可以只将该信息包含在表本身中。

下面的 SQL 应该可以帮助您入门：

```
ALTER TABLE myTable
ADD CONSTRAINT myOneToOneColumn UNIQUE (myColumn); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:22:23.917

实际上，1 对 1 关系是 1 对 n 关系，`unique`其中在对应于`n`关系部分的列中添加了约束。

因此，您需要为`unique`外键添加约束。

# java - JAVA：SVG 到 JPG 转换器

> ID：15256112
> 
> 赞同：3
> 
> 时间：2013-03-06T19:20:39.393
> 
> 标签：java, svg, png, converter, batik

是否有任何库可以将**SVG**转换为**JPG**？除了**蜡染**？我使用**了 BATIK**，但我发现了一些像这个异常这样的问题：

> java.lang.NullPointerException at org.apache.batik.css.engine.CSSEngine.getCascadedStyleMap(CSSEngine.java:684) at org.apache.batik.css.engine.CSSEngine.getComputedStyle(CSSEngine.java:755) at org. apache.batik.bridge.CSSUtilities.getComputedStyle(CSSUtilities.java:96) at org.apache.batik.bridge.CSSUtilities.convertDisplay(CSSUtilities.java:509) at org.apache.batik.bridge.GVTBuilder.buildGraphicsNode(GVTBuilder. java:176) 在 org.apache.batik.bridge.GVTBuilder.buildComposite(GVTBuilder.java:148) 在 org.apache.batik.bridge.GVTBuilder.build(GVTBuilder.java:76) 在 org.apache.batik.transcoder .SVGAbstractTranscoder.transcode(SVGAbstractTranscoder.java:165) 在 org.apache.batik.transcoder.image.ImageTranscoder.transcode(ImageTranscoder.java:86) 在 org.apache.batik.transcoder.XMLAbstractTranscoder。转码（XMLAbstractTranscoder.java:132）

这是我的代码：

```
 JPEGTranscoder transcoder = new JPEGTranscoder();

      transcoder.addTranscodingHint(JPEGTranscoder.KEY_XML_PARSER_CLASSNAME,
          "org.apache.crimson.parser.XMLReaderImpl");
      transcoder.addTranscodingHint(JPEGTranscoder.KEY_QUALITY,
          new Float(1.0));

      TranscoderInput input = new TranscoderInput(new FileInputStream("C:/Taha/SmartPlannerNew/rectangles.svg"));
      OutputStream ostream = new FileOutputStream("C:/Taha/SmartPlannerNew/out.jpg");
      TranscoderOutput output = new TranscoderOutput(ostream);

      try {
        transcoder.transcode(input, output);
    } catch (TranscoderException e) { 
        System.out.println("error***************************************************************************************************************************");
        e.printStackTrace();
    }
      System.out.println("done.");
      ostream.close();
      System.exit(0); 
```

有人能帮帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:27:43.850

***蜡染正是您正在寻找的，完全稳定，而且真的没有太多其他东西。***

您可以阅读有关使用蜡染的转码器部分的便捷官方教程：http: [//xmlgraphics.apache.org/batik/using/transcoder.html](http://xmlgraphics.apache.org/batik/using/transcoder.html)

如果您仍然遇到问题，请尝试发布您正在使用的导致错误的代码以及完整的堆栈跟踪。这里有人可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T14:55:55.510

我的错误是我使用了不同版本的 jar 文件我删除了所有的 jar 并从同一个下载了一组新的 jar

# symfony - 多对多，Doctrine 的实体生成器和多元化

> ID：15256117
> 
> 赞同：3
> 
> 时间：2013-03-06T19:20:48.260
> 
> 标签：symfony, doctrine-orm, many-to-many

Doctrine 的多对多逻辑让我有点困惑。我有一个非常简单的食谱与类别的多对多关系。我的基础实体类同样简单。

配方实体类...

```
class Recipe
{
    /**
     * @ORM\ManyToMany(targetEntity="Category", inversedBy="categories")
     * @ORM\JoinTable(name="recipe_category")
     **/
    private $categories;

    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string
     *
     * @ORM\Column(name="title", type="string", length=255)
     */
    private $title;

    public function __construct() {
        $this->categories = new \Doctrine\Common\Collections\ArrayCollection();
    }
} 
```

和类别实体类...

```
class Category
{
    /**
     * @ORM\ManyToMany(targetEntity="Recipe")
     **/
    private $recipes;

    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string
     *
     * @ORM\Column(name="name", type="string", length=255)
     */
    private $name;

    public function __construct() {
        $this->recipes = new \Doctrine\Common\Collections\ArrayCollection();
    }
} 
```

看起来很困难，并且与 Doctrine（和 Symfony2 的）文档示例相匹配。当我尝试通过 Symfony 控制台应用程序为这些类生成 getter 和 setter 时，就会出现奇怪的行为。

关系设置器/获取器不正确。以生成的 Recipe 类中的 Category 设置器为例...

```
/**
 * Add categories
 *
 * @param \Namespace\CookbookBundle\Entity\Category $categories
 * @return Recipe
 */
public function addCategorie(\Namespace\CookbookBundle\Entity\Category $categories)
{
    $this->categories[] = $categories;

    return $this;
} 
```

看起来方法名称的自动生成功能已关闭。它应该是“addCategory”并且应该传递一个“类别”。

虽然我可以手动更正此问题，但如果我重新运行实体生成器，它只会再次添加它们。

我做错了还是这只是实体生成器的怪癖？我可以通过注释指定覆盖吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-12T00:45:23.013

你没有做错任何事，因为这就是 symfony 生成它们的方式。我通常不使用应用程序/控制台来生成它们，因为目前它们做得不好。一个例子是你提到的单词的复数形式。另一个明显的事实是它使用的`[]`符号几乎将`ArrayCollection`对象视为 PHP 数组。您**永远不应**将 ArrayCollections 视为数组。

这就是我自己实现它的方式：

```
public function addCategory(Category $category)
{
    if (!$this->categories->contains($category)
        $this->categories->add($category);

    return $this;
} 
```

如果已添加，则不会将重复项添加到 Array 集合中。删除也是如此：

```
public function removeCategory(Category $category)
{
    if ($this->categories->contains($category)
        $this->categories->remove($category);
} 
```

我多次遇到的是假设您有 4 个类别，然后添加和删除它们

```
$r = new Recipe();
$c1 = new Category();
$c2 = new Category();

$r->addCategory($c1);
$r->addCategory($c2);
// at this point $r->getCategories()->toArray()[0] contains $c1
// and $r->getCategories()->toArray()[1] contains $c2

$r->removeCategory($c1);
// now $r->getCategories()->toArray()[0] is empty and
// $r->getCategories()->toArray()[1] contains $c2 still
// so in order to get the first category you need to:

$r->getCategories()->first(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-30T12:35:51.797

你没有做错任何事。只是当集合属性有复数名称时，Doctrine 会自动尝试将方法存根的名称单数化。这是 Doctrine 在您运行命令 dictionary:generate:entities 时调用的函数：

```
$methodName = Inflector::singularize($methodName); 
```

在您的情况下，Doctrine 尝试“单数化”单词*categories*但无法正确识别单数形式，因此它只是从返回的末尾删除了一个 's' *categorie*。

此外，如您所见，Doctrine 不会将传递给方法存根的参数单数化，而是保留`$categories`而不是保持一致并将其修改为`$categorie`.

如果你想避免这种情况，要么不使用复数的集合，要么使用复数，然后改变方法。正如@keyboardSmasher 对您的帖子的评论，当使用命令教义：生成：实体时，教义不会覆盖您已经拥有的方法，如果不理会错误的方法不会有太大的伤害。

* * *

最后一点：使用*ArrayCollections*作为*数组*非常好，所以这段代码是正确的：

```
$this->categories[] = $category; 
```

*ArrayCollection*对象实现*Collection*，后者又实现*ArrayAccess*。这样做正是为了能够将*ArrayCollections*用作数组。

# c++ - Windows 编程新手，遇到代码块问题

> ID：15256120
> 
> 赞同：0
> 
> 时间：2013-03-06T19:20:57.043
> 
> 标签：c++, windows

有人可以告诉我这段代码的问题吗？我正在构建一个 Windows 应用程序，而不是一个控制台。我是否正确使用了这些功能。我应该使用哪些类型？好的，我修复了分号错误，其他错误？仍然无法正常工作。

```
#include <windows.h>
int WINAPI WinMain(HINSTANCE thisin,HINSTANCE previn,LPSTR lpstr,INT int_)
{
    LPTSTR buffer;
    DWORD size;
    SetConsoleTitle("Console Title");
    if(!GetConsoleTitle(buffer,size))
        cout << "error" << endl;
    else cout << *buffer << endl; 

    system("Pause");
    return 0;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:38:21.670

它有两个问题，首先是';' 最后，如果这是一个 C++ 错误输入错误并且每个人都这么说，但第二个是：对于每个获取缓冲区以返回某些内容的 API，您应该提供一个有效的缓冲区。假设`GetConsoleTitle`实现为：

```
BOOL GetConsoleTitle(LPTSTR p, DWORD dwSize)
{
    LPTSTR actualTitle = /* Get actual title from somewhere */;
    while (dwSize--)
    {
        *p++ = *actualTitle++;
        if (!*p++) return TRUE;
    }
    // Not enough buffer
    return FALSE;
} 
```

现在看看你的程序，你传递了一个未初始化`LPTSTR`的函数，一旦 API 调用`*p++ = *actualTitle++`，它就会导致分段错误或`Access violation`. 所以为了解决它，你必须传递一个有效的缓冲区作为第一个参数，因为你应该有`LPTSTR`一个 typedef ：`TCHAR*`

```
const DWORD dwSize = 128;
TCHAR buffer[dwSize];
if (GetConsoleTitle(buffer, dwSize)) std::cout << "OK!" << std::endl; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:24:27.383

第一件事是第一件事。您的声明会打印是否有错误。在那里使用 else ：

```
if(!GetConsoleTitle(buffer,size))
    cout << "error" << endl;
else
    cout << *buffer << endl; 
```

在`;`你`if`的错字之后，我在上面更正了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:26:40.767

您正在为控制台应用程序使用 API。创建一个控制台应用程序，将此代码复制到控制台项目 c 或 cpp 源文件并替换

> int WINAPI WinMain(HINSTANCE thisin,HINSTANCE previn,LPSTR lpstr,INT int_)

和

> int _tmain(int argc, char *argv[])

也删除';' （分号）来自“if”语句。

# wpf - WPF 数据模板布局

> ID：15256123
> 
> 赞同：1
> 
> 时间：2013-03-06T19:21:01.023
> 
> 标签：wpf, layout, dockpanel

我正在创建 ListBoxItem 行，每个行都包含以下 3 个项目：

```
1) Button
2) TextBox
3) CheckBox 
```

我希望它们看起来像这样，复选框停靠在右侧：

```
| 1 222           3 |
| 1 222222222     3 |
| 1 222222        3 | 
```

但相反，我得到了这个：

```
| 1 222 3           |
| 1 222222222 3     |
| 1 222222 3        | 
```

这是我的项目模板：

```
<ListBox.ItemTemplate>
  <DataTemplate x:Name="foo" DataType="{x:Type bar}">
    <DockPanel LastChildFill="True">
      <Button DockPanel.Dock="Left" />
      <CheckBox DockPanel.Dock="Right" />
      <TextBlock Text="Foo" />
    </DockPanel>
  </DataTemplate>
</ListBox.ItemTemplate> 
```

诚然，我并不完全理解 StackPanels/DockPanels/Grids 的细微差别，但我们将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:23:31.860

尝试将此添加到列表框定义中：

```
HorizontalContentAlignment="Stretch" 
```

这将允许项目使用列表框的整个水平宽度。

# sharepoint - 在编辑器窗格中隐藏自定义属性，但允许它们导出。

> ID：15256124
> 
> 赞同：0
> 
> 时间：2013-03-06T19:21:01.030
> 
> 标签：sharepoint, sharepoint-2010

我有一个具有自定义属性的自定义 Web 部件。要编辑属性，我有一个自定义 EditorPart。

我需要这些属性才能使用 webpart 导出。为此，我必须将 WebBrowsable 属性设置为 true，这使得自定义属性在编辑器窗格中显示两次，一次是使用我的编辑器部分和我的自定义验证，一次是自动显示。

有没有办法在不将 WebBrowsable 设置为 true 的情况下获取要导出的属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T14:50:31.433

您可能想尝试设置 WebPart 的 ExportMode 属性

MSDN上有一个很好的解释here

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webparts.webpart.exportmode.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webparts.webpart.exportmode.aspx)

# html - 谷歌地图中未显示对话框

> ID：15256125
> 
> 赞同：0
> 
> 时间：2013-03-06T19:21:05.073
> 
> 标签：html, google-maps, css, google-maps-api-3

我无法在谷歌地图中看到对话框......我调整了地图的宽度和高度，但它不起作用......还有其他方法......在下面提供我的代码......

[http://jsfiddle.net/KNPZB/4/embedded/result/](http://jsfiddle.net/KNPZB/4/embedded/result/)

```
<div class="row features">

            <div class="span6">

              <h3>Our office is located at:</h3>
                <p>
                   47653, Lakeview Blvd, Fremont, CA 94538
                </p>
                <p>
                   Ph. (510)-657-8981 | F:(510)-657-8983|E:cs@defie.co
                </p>
                <p>
                   47653, Lakeview Blvd, Fremont, CA 94538
                </p>

            </div>

            <div class="span6">
                <iframe width="265" height="190" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q=47657+Lakeview+Blvd.+Fremont,+Ca.+94538&amp;sll=37.472223,-121.931554&amp;sspn=0.008225,0.019569&amp;vpsrc=0&amp;ie=UTF8&amp;hq=&amp;hnear=47657+Lakeview+Blvd,+Fremont,+California+94538&amp;z=14&amp;ll=37.472223,-121.931554&amp;output=embed"></iframe><br>
                <small>
                  <a href="http://maps.google.com/maps?f=q&amp;source=embed&amp;hl=en&amp;geocode=&amp;q=47657+Lakeview+Blvd.+Fremont,+Ca.+94538&amp;sll=37.472223,-121.931554&amp;sspn=0.008225,0.019569&amp;vpsrc=0&amp;ie=UTF8&amp;hq=&amp;hnear=47657+Lakeview+Blvd,+Fremont,+California+94538&amp;z=14&amp;ll=37.472223,-121.931554" style="color:#0000FF;text-align:left">View Larger Map</a>
                </small>

            </div>

        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:30:59.570

我认为您需要根据浏览器窗口的大小制作嵌入式谷歌地图比例。

所以尝试使用这个：`<iframe width="50%" height="50%"...`

Sitepoint 有一个很好的 CSS 参考：[http ://reference.sitepoint.com/css](http://reference.sitepoint.com/css)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T22:09:02.883

我不知道您打算如何将信息气泡放在这么小的空间中，因为气泡本身大于您为`<iframe>`元素分配的大小。

在任何情况下，您要做的是将大头针保持在正确的位置（查找`q`and`sll`参数），但通过摆弄**`ll`参数**（即纬度和经度）将地图本身的中心向下和向左移动一点.

我在里面为你摆弄了一下`[this demo](http://jsbin.com/idunir/1/edit)`。仅供参考，我推你`ll`的只是`+0,0083/+0,0035`。所以我们说的是少量。

我还向您展示了可以同时放置图钉和信息气泡的最小空间**：**您**需要**一个正方形 around `260px × 260px`，即使这样它也几乎不适合，与控件重叠。所以你可能想给你的地图更多的喘息空间，或者考虑使用**[静态地图](https://developers.google.com/maps/documentation/staticmaps/)**。

# sql-server-2008 - 索引无法在 SQL Server 中索引的视图的低维护替代方案？

> ID：15256126
> 
> 赞同：2
> 
> 时间：2013-03-06T19:21:06.413
> 
> 标签：sql-server-2008, triggers, window-functions, indexed-views

我试图索引我的视图，因为数据是相对静态的，它可以提高性能。

我无法索引视图，因为它包含“排名或聚合窗口函数”。有解决方法吗？

```
SELECT r.Id, r.Value, r.TestSessionId, t.Type AS TestType, r.StudentId, ROW_NUMBER() OVER (partition BY r.StudentId, r.TestSessionId ORDER BY r.Id) AS AttemptNumber
FROM dbo.Responses r
INNER JOIN dbo.TestSessions ts ON r.TestSessionId = ts.Id
INNER JOIN dbo.Tests t ON ts.TestId = t.Id 
```

这个视图只是在学生对问题的回答中添加了一个尝试次数，我认为这对于索引视图来说是一个完美的场景，但是 SQL Server 不支持对具有窗口函数的视图进行索引。

我可以手动生成一个缓存表，但*我希望这是低维护的*，所以我不必记住做这样的事情：

例如，也许我可以创建某种触发器（我不熟悉触发器），当基表更改时将视图插入缓存表......这基本上是视图上的索引应该做的事情在底层（虽然效率更高，因为它可以*更新*索引而不是在基表数据更改时完全替换它）。

# java - Groovy 脚本无法正确解析 XML

> ID：15256140
> 
> 赞同：2
> 
> 时间：2013-03-06T19:21:55.867
> 
> 标签：java, xml, parsing, groovy

我正在尝试使用 Groovy 解析以下 XML：

```
<list>
    <list>
        <widget>
            <fizz id="3" />
            <buzz>false</buzz>
            <explanations/>
        </widget>
        <widget>
            <fizz id="3" />
            <buzz>true</buzz>
            <explanations>
                <string>What is the meaning of life?</string>
                <string>I like the color blue.</string>
            </explanations>
        </widget>
        <widget>
            <fizz id="45" />
            <buzz>true</buzz>
            <explanations>
                <string>I could really go for some pizza right now.</string>
            </explanations>
        </widget>
    </list>
</list> 
```

如果一个`<widget/>`元素有一个`true` `<buzz/>`子元素，那么它将开始将所有`explanations/string`子元素聚合到一个主元素中`List<String>`。因此，给定上面的示例 XML，它将具有以下行为：

1.  首先`list/list/widget/buzz`是`false`，所以不要做任何事情
2.  二`list/list/widget/buzz`是`true`，所以搞*字符串聚合*模式：
    1.  第二个`list/list/widget/explanations`有2个`<string/>`孩子；将它们都添加到主列表 ( `masterList`)
3.  第三 `list/list/widget/buzz`是`true`，所以继续将其子字符串聚合到主列表中。
    1.  第三个`list/list/widget/explanations`有1个`<string/>`孩子；将其添加到主列表 ( `masterList`)
4.  现在`masterList`有 3 个字符串：2 个来自第二个小部件，1 个来自第三个小部件

到目前为止，这是我最好的尝试：

```
boolean buzzesExist = false;
List<String> masterList = new ArrayList<String>();

use(DOMCategory) {
    element.normalize();

    element.'widget'.each { widget ->
        // If widget/buzz is true, then buzzes exist.
        if(widget.'buzz'.text) {
            buzzesExist = true;
        }

        // If buzzes exist, then aggregate all explanation strings into
        // into "masterList".
        if(buzzesExist) {
            for(String exp : widget.'explanations')
                masterList.add(exp);
    }
} 
```

这会运行，但会导致其中`masterList`包含各种奇怪的 DOM 内容（太大，我无法粘贴）。任何 Groovy 大师都可以发现我要去哪里吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:22:12.507

为什么不是 XmlParser？

**更新**：

```
list = new XmlParser().parseText xml

widgetWithExplanations = list.breadthFirst()
  .findAll { it.buzz.text() == "true" }

masterList = widgetWithExplanations
  .collect { it.explanations.string*.text() }
  .flatten()

assert masterList == [
    "What is the meaning of life?", 
    "I like the color blue.", 
    "I could really go for some pizza right now."]

emptyExplanations = widgetWithExplanations
    .count { !it.explanations.string }

assert emptyExplanations == 0 
```

否则，您的 domcategory 可能`exp.text()`在 for 循环中丢失。

# ios - 当 MFMessegeComposeViewController 最终加载时，我需要一个回调

> ID：15256141
> 
> 赞同：1
> 
> 时间：2013-03-06T19:21:58.460
> 
> 标签：ios, objective-c

我的应用程序中有一个 MFMessageComposeViewController，有时收件人数可以达到 200 左右。在 4S 上进行测试时，单击按钮后最多需要 10 秒 (!!) 才能加载 sms 视图。我想使用旧设备可能会更长。

对于没有加载视图的阻塞调用来说，这显然太长了，但是如果在视图实际加载时我没有回调，我就无法放置加载视图！MFMessageComposeViewControllerDelegate 协议中只有 1 个回调，但仅在关闭 sms 视图后回调，而不是在加载时回调。有任何想法吗？

我在想也许从模态视图加载逻辑中的其他地方获取回调，或者最后的手段我可以放一个 5-10 秒的加载屏幕，希望到那时它就可以了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:32:32.800

[MFMessageComposeViewController 是 UINavigationController 的子类](http://developer.apple.com/library/ios/#documentation/MessageUI/Reference/MFMessageComposeViewController_class/Reference/Reference.html)。您是否尝试过实现 UINavigationControllerDelegate 的任何方法。具体来说：

```
- (void)navigationController:(UINavigationController *)navigationController didShowViewController:(UIViewController *)viewController animated:(BOOL)animated; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:15:58.093

经过一番挖掘，我发现我使用的是旧版本的[UIViewController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW75) `presentViewController:animated:completion:`，所以我没有实现“完成”部分。这绝对是我在完成块中关闭加载视图的最佳选择，但它仅适用于 iOS 5.0 及更高版本。如果您必须支持低于 5.0 的版本，那么 Edwin 的回答可能会有所帮助。

**更新**：使用我上面的方法实际上并没有在实践中起作用。如果我抛出一个进度视图然后调用`presentViewController:animated:completion:`，`MFMessageComposeViewController`它仍然会在进度视图出现之前进行阻塞调用。我假设这与在阻塞调用开始之前未完成运行循环有关，因此不会出现 UI 更改。

相反，我只是让我的进度视图在它实际出现时进行回调，然后在回调中我将开始加载`MFMessageComposeViewController`. 然后，当`MFMessageComposeViewController`回调被触发时，我会关闭我的进度视图以及`MFMessageComposeViewController`. 成功！

# xslt - 使用 XSLT 中的媒体名称空间 - 导致仅支持 1.0 功能？

> ID：15256142
> 
> 赞同：0
> 
> 时间：2013-03-06T19:22:02.687
> 
> 标签：xslt, rss, media

我有一个简单的 XML 文件，并且正在尝试创建一个 XSLT 文件来将 XML 处理为 HTML。

XML

```
<?xml version="1.0" ?>
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
<title>PDF</title>
<ttl>10</ttl>
<link>https://teele.box.com/shared/3m9en769bdh36d4y2hjy/rss.xml</link>
<description>PDF file updates</description>
<lastBuildDate>Tue, 05 Mar 2013 13:59:22 -0800</lastBuildDate>
<copyright>Copyright 2009 box.net</copyright>
<webMaster>no-reply@box.com (No reply)</webMaster>
<item>
  <title>Kat Martin - Sinclair Sisters Trilogy 02 - Desert Heat.pdf</title>
  <description></description>
  <pubDate>Sun, 03 Feb 2013 17:19:36 -0800</pubDate>
  <link>https://teele.box.com/index.php?rm=box_download_shared_file&amp;shared_name=3m9en769bdh36d4y2hjy&amp;file_id=f_5920615203&amp;rss=1</link>
  <media:content url="https://teele.box.com/index.php?rm=box_download_shared_file&amp;shared_name=3m9en769bdh36d4y2hjy&amp;file_id=f_5920615203&amp;rss=1" />
  <media:text></media:text>
  <media:title>Kat Martin - Sinclair Sisters Trilogy 02 - Desert Heat.pdf</media:title>
  <media:thumbnail url="https://ak3.boxcdn.net/resources/rcxnqksqis/thumbs/43x51/application/pdf.gif"  height="48" width="48"/>
</item> 
```

和我的 XSLT

```
<?xml version='1.0'?>
<xsl:stylesheet version="2.0"
            xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
             xmlns:media="http://search.yahoo.com/mrss/">

 <xsl:output method="html" />

<xsl:template name="Content">
  <xsl:for-each select="rss/channel/item">
    <xsl:value-of select="media:thumbnail/@url"/>
  </xsl:for-each>
</xsl:template>

<xsl:template match="/">
  <xsl:call-template name="Content" />
</xsl:template>
</xsl:stylesheet> 
```

当我处理这个时，我从我正在测试 XSLT的[http://www.online-toolz.com/tools/xslt-transformation.php](http://www.online-toolz.com/tools/xslt-transformation.php)收到以下错误

**错误：XSLTProcessor::importStylesheet() [xsltprocessor.importstylesheet]: xsl:version: only 1.0 features are supported**

它与 media: 标签有关，但我不知道它是什么意思，我定义了命名空间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:30:32.657

只需将 version="2.0" 设置为 version="1.0" 就不会抛出错误。

此外，您可以像这样获取有关 XSLT 处理器的一些信息：

```
xsl:version=<xsl:value-of select="system-property('xsl:version')" />
xsl:vendor=<xsl:value-of select="system-property('xsl:vendor')" />
xsl:vendor-url=<xsl:value-of select="system-property('xsl:vendor-url')" />
xsl:product-name=<xsl:value-of select="system-property('xsl:product-name')" />
xsl:product-version=<xsl:value-of select="system-property('xsl:product-version')" />
xsl:is-schema-aware=<xsl:value-of select="system-property('xsl:is-schema-aware')" />
xsl:supports-serialization=<xsl:value-of select="system-property('xsl:supports-serialization')" />
xsl:supports-backwards-compatibility=<xsl:value-of select="system-property('xsl:supports-backwards-compatibility')" />
msxsl:version=<xsl:value-of select="system-property('msxsl:version')" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:48:13.167

看起来是网站上的处理器对 v2 功能不满意。

[http://www.online-toolz.com/tools/xslt-transformation.php](http://www.online-toolz.com/tools/xslt-transformation.php)

它在 SharePoint 2010 中工作

# javascript - 将文本附加到选项卡标题？

> ID：15256144
> 
> 赞同：0
> 
> 时间：2013-03-06T19:22:06.090
> 
> 标签：javascript, google-chrome, google-chrome-extension

我想让我的扩展程序在标签标题的末尾附加一个小文本标签（类似于“（已记录！）”），以向用户表明它已经注意到给定的标签已被查看。以下代码似乎在调试器中工作（也就是说，在 if 条件完成后，调试器告诉我 tab.title 是 [tab.title + (Recorded!)]），但 chrome 中的选项卡标题不是改变了。我是否需要使用代码刷新选项卡才能看到标题的变化？如果是这样，我该如何在不再次触发 onUpdated 侦听器的情况下做到这一点？如果没有，我该怎么办？

```
// get title of updated tab, increment if it has "NYTimes.com" in it (crude equivalent for article)
chrome.tabs.onUpdated.addListener(function(url, changeInfo, Tab)
{
    chrome.tabs.getSelected(null, function(tab) 
    {
        var title = tab.title;

        if (title.indexOf("NYTimes.com") != -1 && changeInfo.status == "complete")
        {
            tab.title = title + ' (Recorded!)';
            localStorage.setItem('nyt', ++nytCount);
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:06:03.647

您必须使用内容脚本才能执行此操作。chrome.tabs API 只提供对标签信息*的只读*访问。

似乎以编程方式注入（[https://developer.chrome.com/trunk/extensions/content_scripts.html#pi](https://developer.chrome.com/trunk/extensions/content_scripts.html#pi)）适合您的情况。

因为内容脚本在一个孤立的世界中执行（[https://developer.chrome.com/trunk/extensions/content_scripts.html#execution-environment](https://developer.chrome.com/trunk/extensions/content_scripts.html#execution-environment)），您需要将 <script> 注入页面并修改标题在那里设置 document.title。

这是一个示例（替换`tab.title = title + ' (Recorded!)';`）：

```
chrome.tabs.executeScript(tab.id, {code: 
    "var script = document.createElement('script');" + 
    "script.appendChild(document.createTextNode('" +
    "document.title = document.title + \" (Recoorded!)\";" + 
    "'));" + 
    "document.body.appendChild(script);"}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-17T21:03:54.277

我使用了 jquery，效果很好。

```
var title = $(document).prop('title'); 
if (title.indexOf('new prefix') == -1) {
    $(document).prop('title', 'new prefix - '+title);
} 
```

但请务必将其包含在 manifest.json 的内容脚本部分

```
"content_scripts": [ {
  "js": [ "jquery-3.1.0.min.js", "myscript.js" ],
  "matches": [ "http://*/*", "https://*/*" ]
}] 
```

# bash - 带有管道、引号等的命令中的 Bash 变量

> ID：15256149
> 
> 赞同：8
> 
> 时间：2013-03-06T19:22:23.123
> 
> 标签：bash, variables, pipe

我有一个用于获取 hostname.localdomain 的命令：

```
dig axfr @dc1.localdomain.com localdomain.com | grep -i Lawler | awk '{ getline ; $1=substr($1,1,length($1)-1); print $1 ; exit }' 
```

这很好地返回了如下结果：

> michael.lawler.localdomain.com

我想进一步将该结果用作 Bash 脚本中的变量。

看来我很难通过第一个管道。

如果我`VAR="dig axfr @dc1.localdomain.com localdomain.com | grep -i Lawler | awk '{ getline ; $1=substr($1,1,length($1)-1); print $1 ; exit }'"`

...我拿回整个区域转移。我还尝试了许多小的更改，在命令`$`之前添加`dig`，不带引号，但似乎没有任何效果。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-06T19:25:29.200

```
VAR=$( dig axfr @dc1.localdomain.com localdomain.com |
     grep -i Lawler |
     awk '{ getline ; $1=substr($1,1,length($1)-1); print $1 ; exit }' ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T19:23:57.120

使用反引号而不是引号：

```
VAR=`dig axfr @dc1.localdomain.com localdomain.com | grep -i Lawler | awk '{ getline ; $1=substr($1,1,length($1)-1); print $1 ; exit }'` 
```

Backtics 实际上的意思是“运行此处的任何内容并返回标准输出作为表达式的值”，但引号不会这样做。

# android - Sqlite Listview 后按时清除

> ID：15256152
> 
> 赞同：1
> 
> 时间：2013-03-06T19:22:32.930
> 
> 标签：android, sqlite, listview

这是日志猫。这里的错误似乎是什么？

```
03-07 03:11:55.841: D/dalvikvm(292): GC_EXTERNAL_ALLOC freed 4085 objects / 243720 bytes in 190ms
03-07 03:11:56.221: D/dalvikvm(292): GC_EXTERNAL_ALLOC freed 303 objects / 16040 bytes in 85ms
03-07 03:12:06.990: W/KeyCharacterMap(292): No keyboard for id 0
03-07 03:12:06.990: W/KeyCharacterMap(292): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
03-07 03:12:07.190: E/Cursor(292): Invalid statement in fillWindow() 
```

从我的 sqliteadapter 获取数据的第一个活动

```
 public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.search);
  setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);

  mySQLiteAdapter = new SQLiteAdapter(this);
  mySQLiteAdapter.openToRead();

  Cursor cursor = mySQLiteAdapter.queueAll();
  startManagingCursor(cursor);

  String[] from = new String[]{SQLiteAdapter.KEY_FOODNAME,SQLiteAdapter.KEY_CALORIES};
  int[] to = new int[]{R.id.tv1, R.id.tv2};

  SimpleCursorAdapter cursorAdapter =
   new SimpleCursorAdapter(this, R.layout.row, cursor, from, to);

  listContent1.setAdapter(cursorAdapter);
  listContent1.setOnItemClickListener(listContentOnItemClickListener); 
  mySQLiteAdapter.close();
   private ListView.OnItemClickListener listContentOnItemClickListener = new ListView.OnItemClickListener(){
 public void onItemClick(AdapterView<?> parent, View view, int position,
        long id) {

  Cursor cursor = (Cursor) parent.getItemAtPosition(position);

  String item_content1 = cursor.getString(cursor.getColumnIndex(SQLiteAdapter.KEY_FOODNAME));
  String item_content2 = cursor.getString(cursor.getColumnIndex(SQLiteAdapter.KEY_CALORIES));
  arlene = arlene + Integer.parseInt(item_content2);
  String item = String.valueOf(" Food Name: " + item_content1 ) + "\n" +
          " Calories: " +  item_content2;

   Toast.makeText(Search.this, item, Toast.LENGTH_LONG).show();      

   food.setText(item_content1);
   calories.setText(String.valueOf(arlene));

   Intent myIntent = new Intent(Search.this, Foodlog.class);
   Bundle bundle = new Bundle();
   bundle.putString("SQLITEDATA1", food.getText().toString()); 
   bundle.putString("SQLITEDATA2", calories.getText().toString()); 
   myIntent.putExtras(bundle);
   startActivity(myIntent); 

   SavePreferences("calories", calories.getText().toString());
   LoadPreferences(); 
```

获取数据的第二个活动

```
 Bundle bundle = getIntent().getExtras();  
   if( bundle != null){
   String food = bundle.getString("SQLITEDATA1");
   String calories = bundle.getString("SQLITEDATA2");

   String[] values = new String[] { food, calories }; //That you got from your intent bundle
   LVAdapter adapter = new LVAdapter(this, R.layout.foodlist, values);
   setListAdapter(adapter); 
```

当我按下后，它将清除我第一次活动的所有列表视图数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T07:35:11.893

在 onCreate 删除

```
mySQLiteAdapter.close(); 
```

将其移至 onDestroy

```
@override
protected void onDestroy()
{
    mySQLiteAdapter.close();  
} 
```

# android - Android 字体字距调整：Nexus 7 与 Galaxy Tab 2

> ID：15256155
> 
> 赞同：4
> 
> 时间：2013-03-06T19:22:36.950
> 
> 标签：android, fonts, android-4.2-jelly-bean, kerning

我目前正在开发一个最初打算仅在 Nexus 7 和 Android 4.2 上运行的应用程序。但是，计划发生了变化，现在它打算在 Galaxy Tab 2、Android 4.1.1 上运行。

我正在使用在 Nexus 7 上表现出色的自定义字体。但是，当降级 Android 版本并切换到 Galaxy Tab 2 时，字体字距调整完全混乱，看起来很糟糕。间距与应有的距离相去甚远。

有什么提示可以为我指明解决此问题的正确方向吗？我不知道如何解决这个问题，除了切换到不同的字体，这不太理想。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T14:37:12.460

听起来您可能遇到了此处描述的字距调整问题：[Android 自定义视图代码在 Jelly Bean 4.2 中停止正常工作](https://stackoverflow.com/questions/14405132/android-custom-view-code-stopped-working-correctly-in-jelly-bean-4-2/14635792#14635792)

可以解决它。

# jquery - 如何更改有效表单字段的类别 - jQuery 表单验证插件

> ID：15256159
> 
> 赞同：2
> 
> 时间：2013-03-06T19:22:54.280
> 
> 标签：jquery, css, jquery-validate

我正在使用 bassistance jQuery 表单验证插件。

[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

[http://jquery.bassistance.de/validate/demo/](http://jquery.bassistance.de/validate/demo/)

我用表单域制作了一个表单并设置了规则；

JavaScript

```
$(document).ready(function() {
    $.validator.setDefaults({
        submitHandler: function() {
          alert("submitted!");
        }
    });
    var validator = $("#testform").validate({
        rules: {
            field1: "required",
        },
        messages: {
            field1: "",
        },
        error: function(element) {
            element.addClass("error");
        },
        success: function(label) {
            label.addClass("checked");
        }
    });
}); 
```

CSS

```
#testform input{
  border: solid 2px black;
}
#testform input.error{
  border: solid 2px #CC0000;
}
#testform input.checked{
  border: solid 2px #094AB2;
} 
```

HTML

```
<form id="testform" name="testform">
<input id="field1" name="field1" type="text" value="">
<input id="field2" name="field2" type="text" value="">
<input type="submit" value="submit"/>
</form> 
```

误差函数工作正常。但是成功功能不是为输入类型=文本添加样式，而是出现默认样式（黑色边框而不是蓝色）。我该如何解决这个问题？

这是工作**[小提琴](http://jsfiddle.net/CgUqE/)**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T19:36:49.703

将您的更改`#testform input.checked`为`#testform input.valid`. 我通过提交表单并使用开发人员工具或萤火虫检查课程来得到这个。我看到类名更改为有效且未检查

这是一个[现场演示](http://jsfiddle.net/CgUqE/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:37:10.827

方法中的`success`回调[`validate`](http://docs.jquery.com/Plugins/Validation/validate#options)传入给定表单输入的标签。如果标签不存在，则创建一个。

您的代码无法按预期工作的原因是因为您的 CSS 假定`checked`该类将添加到实际添加到标签的输入中。

validate 方法自动将`valid`类添加到通过验证的输入和未通过验证的`error`类。除非您计划执行其他任务，否则您可能可以删除特定的回调。

**CSS**

```
#testform input.valid{
  border: solid 2px #094AB2;
} 
```

**JS**

```
var validator = $("#testform").validate({
    rules: {
        field1: "required",
    },
    messages: {
        field1: "",
    }
}); 
```

**[演示](http://jsfiddle.net/qHLuu/)**

# automata - 形式语言语法

> ID：15256160
> 
> 赞同：0
> 
> 时间：2013-03-06T19:22:58.007
> 
> 标签：automata, formal-languages

这是问题：

显示：

`L = {0m1n, m > 1, n > 1, n < m }`, 其中 m & n 是上标

不规律。

我不确定在这种情况下上标是什么意思？是不是这样的意思：

```
0^5 = 00000 or 1^7 = 1111111 
```

PS如何在SO中显示上标？

# android - Android 菜单的图标在平板电脑上不可见

> ID：15256162
> 
> 赞同：0
> 
> 时间：2013-03-06T19:23:10.910
> 
> 标签：android, menu, menuitem

大家好，这是我的代码。该菜单在我的手机（Android 2.3）上完美运行。但在我的平板电脑（Android 4.0）上，它不显示图标。菜单工作正常。有人可以帮助我吗？为什么会这样？我正在使用`Theme_Black_NoTitleBar`.`AndroidManifest.xml`

```
public final class IntentsDemoActivity extends Activity implements
        OnItemClickListener {

    public static final int ABOUT = 0;
    public static final int INFO = 1;
    public static final int WEBSITE = 2;

    // This is the value of Intent.EXTRA_LOCAL_ONLY for API level 11 and above.
    private static final String EXTRA_LOCAL_ONLY = "android.intent.extra.LOCAL_ONLY";
    private static final String VIDEO_ID = "-Uwjt32NvVA";
    private static final String PLAYLIST_ID = "PLF3DFB800F05F551A";
    private static final String USER_ID = "Google";
    private static final int SELECT_VIDEO_REQUEST = 1000;

    private List<DemoListViewItem> intentItems;

    public boolean onCreateOptionsMenu(android.view.Menu menu) {
        super.onCreateOptionsMenu(menu);
        menu.add(0, ABOUT, 0, "About").setIcon(R.drawable.about);
        menu.add(0, INFO, 0, "Info").setIcon(R.drawable.info);
        menu.add(0, WEBSITE, 0, "Website").setIcon(R.drawable.website);
        return true;
    }

    public boolean onMenuItemSelected(int featureId, MenuItem item) {
        switch (item.getItemId()) {
        case ABOUT:
            Toast.makeText(IntentsDemoActivity.this, "About", Toast.LENGTH_SHORT).show();
            Uri uri = Uri.parse("https://www.google.com/about);
            Intent it = new Intent(Intent.ACTION_VIEW,uri);
            startActivity(it);
            return true;

            case PAGE:
            Toast.makeText(IntentsDemoActivity.this, "Info", Toast.LENGTH_SHORT).show();
            Uri uri = Uri.parse("https://www.google.com/info");
            Intent it = new Intent(Intent.ACTION_VIEW,uri);
            startActivity(it);
            return true;
           case WEBSITE:
          Toast.makeText(IntentsDemoActivity.this, "Webiste", Toast.LENGTH_SHORT).show();
          Uri uri1 = Uri.parse("http://www.google.com/");
            Intent it1 = new Intent(Intent.ACTION_VIEW,uri1);
            startActivity(it1);
          return true;

          }
          return false;
      }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.intents_demo);

        intentItems = new ArrayList<DemoListViewItem>();
        intentItems.add(new IntentItem("X", IntentType.X));
        intentItems.add(new IntentItem("Play Video", IntentType.PLAY_VIDEO));
        intentItems.add(new IntentItem("Open Playlist",
                IntentType.OPEN_PLAYLIST));
        intentItems.add(new IntentItem("Play Playlist",
                IntentType.PLAY_PLAYLIST));
        intentItems.add(new IntentItem("Open User", IntentType.OPEN_USER));
        intentItems.add(new IntentItem("Open Search Results",
                IntentType.OPEN_SEARCH));
        intentItems
                .add(new IntentItem("Upload Video", IntentType.UPLOAD_VIDEO));

        ListView listView = (ListView) findViewById(R.id.intent_list);
        DemoArrayAdapter adapter = new DemoArrayAdapter(this,
                R.layout.list_item, intentItems);
        listView.setAdapter(adapter);
        listView.setOnItemClickListener(this);

        TextView youTubeVersionText = (TextView) findViewById(R.id.youtube_version_text);
        String version = YouTubeIntents.getInstalledYouTubeVersionName(this);
        if (version != null) {
            String text = String.format(
                    getString(R.string.youtube_currently_installed), version);
            youTubeVersionText.setText(text);
        } else {
            youTubeVersionText
                    .setText(getString(R.string.youtube_not_installed));
        }
    }

    public boolean isIntentTypeEnabled(IntentType type) {
        switch (type) {
        case PLAY_VIDEO:
            return YouTubeIntents.canResolvePlayVideoIntent(this);
        case OPEN_PLAYLIST:
            return YouTubeIntents.canResolveOpenPlaylistIntent(this);
        case PLAY_PLAYLIST:
            return YouTubeIntents.canResolvePlayPlaylistIntent(this);
        case OPEN_SEARCH:
            return YouTubeIntents.canResolveSearchIntent(this);
        case OPEN_USER:
            return YouTubeIntents.canResolveUserIntent(this);
        case UPLOAD_VIDEO:
            return YouTubeIntents.canResolveUploadIntent(this);
        }

        return false;
    }

    @Override
    public void onItemClick(AdapterView<?> parent, View view, int position,
            long id) {
        IntentItem clickedIntentItem = (IntentItem) intentItems.get(position);

        Intent intent;
        switch (clickedIntentItem.type) {
        case X:
            // This will load a picker view in the users' gallery.
            // The upload activity is started in the function onActivityResult.
            intent = new Intent(Intent.ACTION_PICK, null).setType("video/*");
            intent.putExtra(EXTRA_LOCAL_ONLY, true);
            startActivityForResult(intent, SELECT_VIDEO_REQUEST);
            break;

        case PLAY_VIDEO:
            intent = YouTubeIntents.createPlayVideoIntentWithOptions(this,
                    VIDEO_ID, true, false);
            startActivity(intent);
            break;
        case OPEN_PLAYLIST:
            intent = YouTubeIntents.createOpenPlaylistIntent(this, PLAYLIST_ID);
            startActivity(intent);
            break;
        case PLAY_PLAYLIST:
            intent = YouTubeIntents.createPlayPlaylistIntent(this, PLAYLIST_ID);
            startActivity(intent);
            break;
        case OPEN_SEARCH:
            intent = YouTubeIntents.createSearchIntent(this, USER_ID);
            startActivity(intent);
            break;
        case OPEN_USER:
            intent = YouTubeIntents.createUserIntent(this, USER_ID);
            startActivity(intent);
            break;
        case UPLOAD_VIDEO:
            // This will load a picker view in the users' gallery.
            // The upload activity is started in the function onActivityResult.
            intent = new Intent(Intent.ACTION_PICK, null).setType("video/*");
            intent.putExtra(EXTRA_LOCAL_ONLY, true);
            startActivityForResult(intent, SELECT_VIDEO_REQUEST);
            break;
        }
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode,
            Intent returnedIntent) {
        if (resultCode == RESULT_OK) {
            switch (requestCode) {
            case SELECT_VIDEO_REQUEST:
                Intent intent = YouTubeIntents.createUploadIntent(this,
                        returnedIntent.getData());
                startActivity(intent);
                break;
            }
        }
        super.onActivityResult(requestCode, resultCode, returnedIntent);
    }

    private enum IntentType {
        X, PLAY_VIDEO, OPEN_PLAYLIST, PLAY_PLAYLIST, OPEN_USER, OPEN_SEARCH, UPLOAD_VIDEO;
    }

    private final class IntentItem implements DemoListViewItem {

        public final String title;
        public final IntentType type;

        public IntentItem(String title, IntentType type) {
            this.title = title;
            this.type = type;
        }

        @Override
        public String getTitle() {
            return title;
        }

        @Override
        public boolean isEnabled() {
            return isIntentTypeEnabled(type);
        }

        @Override
        public String getDisabledText() {
            return getString(R.string.intent_disabled);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:08:07.620

Drawble-ldpi、mdpi、hdpi、xhdpi 文件夹必须保存自己的文件，因此请将同名图标放在不同的文件夹中。我认为您的代码没有错，只有跳蚤错误。如果您要创建不同的视觉效果，您的布局文件也必须位于具有相同名称的不同可绘制文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:29:24.517

确保您在所有 Drawable 文件夹中粘贴了相同的图标，即 ldpi、mdpi、hdpi，尤其是平板电脑的 xhdpi。

如果相应文件夹中有所有版本的图标，请发布 menu.xml 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:02:51.610

> 但在我的平板电脑（Android 4.0）上，它不显示图标。

如果图标位于操作栏的溢出菜单中，则不应显示该图标。溢出菜单是纯文本的。

# asp.net-mvc - 如何让 ASP.Net MVC 忽略 jQuery Mobile 添加到 URL 的“&ui-page”？

> ID：15256165
> 
> 赞同：0
> 
> 时间：2013-03-06T19:23:20.610
> 
> 标签：asp.net-mvc, jquery-mobile

我有一个使用**jQuery Mobile 1.3 的 ASP.Net MVC 站点。**

在某些情况下，jQuery Mobile 会将您带到以下 URL：

```
http://{domain}/{controller}/{action}/{id}&ui-page={jQueryMobile.PageId} 
```

如何设置我的网站，以便 MVC 忽略`&ui-page=`之后的所有内容。

我相信第一步是进行设置，以便当 a`"&"`在 URL 中时 MVC 不会引发验证错误。为此，我将以下内容添加到 web.config。

```
<system.web>
  <httpRuntime requestPathInvalidCharacters="&lt;,&gt;,*,%,:,\" /> 
```

但是，在我这样做之后，我的下一个问题是`&`抛出了我的路由规则。

编辑：我刚刚设置了默认路线，所以这是我的路线：

```
routes.MapRoute(
  name: "Default",
  url: "{controller}/{action}/{id}",
  defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
); 
```

# c# - Visual Studio 添加了按字母顺序排列资源文件中的值

> ID：15256169
> 
> 赞同：1
> 
> 时间：2013-03-06T19:23:42.040
> 
> 标签：c#, visual-studio-addins, visual-studio-sdk

我想制作一个视觉工作室的插件，它能够在每次有人编辑资源文件时按字母顺序对资源文件进行排序。我不是在寻找解决方案，但我以前从未使用过 Visual Studio sdk。我只是想知道是否有使用 Visual Studio sdk 经验的人知道这是否可能？也感谢任何关于如何开始制作插件的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T13:28:10.037

如果你从未使用过 Visual Studio 可扩展性，我推荐你这个页面： [制作解决方案笔记本工具窗口](http://www.codeproject.com/Articles/32906/Use-Visual-Studio-Extensibility-to-Make-a-Solution)

有一些关于如何与 Visual Studio 交互以将数据保存在 sln 和 suo 文件中的有用信息，您还可以找到有关一些属性的信息，这些属性可以用来告诉 Visual Studio 您的包（或插件）需要做什么。虽然这是一个常识性的事情，但与您想做的事情没有直接关系。

[此链接](https://stackoverflow.com/questions/2525457/automating-visual-studio-with-envdte)是关于如何收听一些特定事件的 Visual Studio 触发，它向您展示了在插件中创建侦听器的一般方法

[这](http://social.msdn.microsoft.com/Forums/is/vsx/thread/e17f0688-c61b-487a-989d-222c899c554b)实际上是关于您需要做什么（它告诉您如何在 Visual Studio 保存文件之前捕获触发的事件）

最重要的一个：用于为 Visual Studio 创建自定义源代码控制[的源代码](https://bitbucket.org/zzsergant/hgsccpackage/src/d7e76fa7fe855851a144146ab698ec804f873c8b/HgSccPackage/SccProvider.cs)，这是我找到了解 Visual Studio 可扩展性所需的大部分信息的地方

通过所有这些链接，您应该可以开始使用，当然您还有关于扩展 Visual Studio的[官方 msdn 文档](http://msdn.microsoft.com/en-us/library/bb165336.aspx)

您需要做的是创建一个插件，该插件将在项目即将保存在 Visual Studio 中时侦听触发的事件。我认为 resx 文件没有特定的事件，因此您可能必须测试保存了哪个文件，但这应该是全部。获得项目后，您可以找到物理文件并对其进行排序。

另一件事，我发现在 DTE 对象中声明的事件并没有真正起作用（至少对我来说没有），这就是为什么我建议您实现侦听器模式来捕获您需要的事件。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-18T18:27:38.517

我实际上就是这样做[的](https://visualstudiogallery.msdn.microsoft.com/7adfbbd0-de40-4caf-a591-9e1eea65bcda)。

[您可以在GitHub](https://github.com/seldary/Ersx.Net)中找到扩展的源代码。它向您展示了如何从解决方案资源管理器获取文件句柄、添加上下文菜单操作、写入输出菜单等。

# javascript - Javascript 无法在 IE8 上运行

> ID：15256171
> 
> 赞同：1
> 
> 时间：2013-03-06T19:23:43.203
> 
> 标签：javascript, internet-explorer-8

在我的网页中，我有以下在正文中称为 onLoad 的 javascript 函数：

```
function changeDivWidth()
{   
    d = document.getElementById('background');   
    document.getElementById("backgroundImg").style.height = window.innerHeight+"px";
    imgWidth = document.getElementById("backgroundImg").width;
    marginLeft = ($(window).width() - imgWidth)/2;   
    d.style.width = imgWidth+"px";
    d.style.left = marginLeft+"px";
    document.getElementById("backgroundImg").style.visibility="visible";
    document.getElementById("menu").style.visibility="visible";
} 
```

该脚本基本上采用浏览器页面的高度并将其设置为元素的高度。除了没有加载脚本的 IE7 和 IE8 之外，这在所有浏览器中都可以正常工作。你能建议我一个解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:25:28.443

`window.innerHeight`在 IE8 及以下版本中不起作用。试用`document.body.clientHeight`

编辑：等一下……你在第 6 行使用 jQuery 吗？：

```
marginLeft = ($(window).width() - imgWidth)/2; 
```

如果是，请`$(window).height()`改为使用获取高度。

# sql-server - Sql Server 2008 - 捕获链接服务器上运行的存储过程引发的执行错误

> ID：15256178
> 
> 赞同：0
> 
> 时间：2013-03-06T19:23:59.427
> 
> 标签：sql-server, sql-server-2008, error-handling, try-catch, linked-server

为了提供一些背景细节，假设有一个“Person”表和一个存储过程“PersonPerformance”，它返回给定 PersonId 的 Person 的性能。这两个对象都驻留在链接的 sql server 2000 实例上。

我的目标是为每个 PersonId 运行 PersonPerformance proc，并将结果存储在驻留在 Sql Server 2008 实例上的表中。如果在存储过程的执行过程中发生执行错误，我想指出它“失败”并在存储过程完成时发送一封电子邮件，列出所有失败的 PersonId。

我试过使用 try..catch 块并检查 @@error != 0 但都没有奏效。我假设这是因为存储过程在抛出错误后继续执行并最终返回结果，即使它们无效。存储过程本身是一个长批次，没有错误处理。

这是我到目前为止的代码：

```
{@ReturnTable is defined here}

declare cur cursor for 
select PersonId from [linked-server-name].DB.dbo.Person
open cur
declare @pId int
fetch next from cur into @pId
while (@@FETCH_STATUS = 0)
begin
    begin try
        print(@pId)
        insert into @ReturnTable exec [linked-server-name].DB.dbo.PersonPerformance @pId
    end try
    begin catch
        print('store person that failed here')
    end catch

    fetch next from cur into @pId
end
close cur
deallocate cur 
```

我想我理解为什么它没有像我预期的那样工作，原因是我之前提到的（存储过程继续），但我想知道是否有办法绕过这个问题并捕获执行错误，即使过程继续。

这是执行期间生成的输出的快照：

```
101
The statement has been terminated.
Msg 2627, Level 14, State 1, Procedure OSPerfAttribution_ps, Line 626
Violation of PRIMARY KEY constraint 'PK__@SecMaster__2CD2DAF1'. Cannot insert duplicate key in object '#2BDEB6B8'.
The statement has been terminated.
Msg 515, Level 16, State 2, Procedure OSPerfAttribution_ps, Line 1047
Cannot insert the value NULL into column 'BasketBenchmarkId', table '@ReturnTable'; column does not allow nulls. INSERT fails.

(3 row(s) affected)
102

(36 row(s) affected)
106

(32 row(s) affected) 
```

错误消息从存储的过程传播到外部 sql 的输出这一事实使我相信必须有一种方法来捕获它。我只是很难找到方法，所以我希望在这里得到一些帮助。

最后的手段我可能只需要将整个输出保存到日志文件并搜索错误。这不是一个糟糕的选择，但我仍然想知道是否有办法在执行期间捕获错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:30:35.607

`SET XACT_ABORT ON`如果您希望整个批次回滚，我会使用。

[http://msdn.microsoft.com/en-us/library/ms188792.aspx](http://msdn.microsoft.com/en-us/library/ms188792.aspx)

# python - 需要帮助使用泰勒级数在 python 中逼近正弦函数

> ID：15256181
> 
> 赞同：3
> 
> 时间：2013-03-06T19:24:17.553
> 
> 标签：python

我对 Python 很陌生，正在尝试使用[这个](http://i.imgur.com/6GMBhgt.png?1)系列来近似正弦函数。

我的代码如下所示：

```
import math
def sin(x,n):
sine = 0
for i in range(n):
    sign = (-1)**i
    sine = sine + ((x**(2.0*i-1))/factorial(2**i-1))*sign
return sine 
```

这不会返回我希望的答案，但我很困惑，找不到我的错误......或者我只是完全错误的方式（正如我所说，我很新到python和一般的编程）。

[给定这个](http://i.imgur.com/SxebUNY.png)系列，它似乎类似于我前段时间编写的近似 pi 的程序：

```
def piApprox(n):
pi = 0
for i in range(n):
    sign = (-1)**i
    pi = pi + 1.0/(2*i+1)*sign
return 4*pi 
```

我不知道这是否有用，但这是我试图用它来找出我的正弦方法。任何解决此问题或为我指明正确方向的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:27:14.027

*sin( x* )的泰勒级数为：

![sin(x) 的泰勒级数](../Images/684c8a175700eb8f18aad78f1cf861fc.png)

将您的代码与该定义进行比较，这两部分有一些错误：

```
x**(2.0*i-1)
factorial(2**i-1) 
```

减号应该是加号，阶乘中的指数应该是乘法。

```
x**(2.0*i+1)
factorial(2*i+1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-25T11:58:27.410

您可以使用符号库 SymPy 使用泰勒级数构建近似函数：

```
from sympy import sin
from sympy.abc import x

# creates a generator
taylor_series = sin(x).series(n=None)

# takes the number of terms desired for your generator
taylor_series = sum([next(taylor_series) for i in range(num_of_terms)])

# creates a function that calculates the approximated sine function
mysin = sympy.lambdify((x,), taylor_series) 
```

# python - 如何使用 Fabric 通过 2 个网关将 SSH 隧道连接到远程主机？

> ID：15256183
> 
> 赞同：5
> 
> 时间：2013-03-06T19:24:26.647
> 
> 标签：python, ssh, fabric, ssh-tunnel

我正在尝试弄清楚如何使用 Fabric 来简化 SSH 进入并在由两个网关分隔的机器上运行命令。设置如下所示：

```
Local host -> Gateway 1 -> Gateway 2 -> Remote host 
```

我已经查看了对[fabric: how to double tunnel](https://stackoverflow.com/questions/6161548/fabric-how-to-double-tunnel)以及[http://docs.fabfile.org/en/1.6/usage/env.html#gateway](http://docs.fabfile.org/en/1.6/usage/env.html#gateway)的响应，但这些似乎并没有完成我的工作追了

有任何想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-06-17T01:58:20.673

您可以在 gw1 上放置一个脚本来运行通过 gw2 连接到远程主机的结构脚本吗？

就像是：

1.  在您的本地结构 ssh 到 gw1 并在 gw1 中运行 cmd1.sh
2.  在 gw1 中，cmd1.sh 将运行一个结构命令以使用 gw2 连接到远程主机。这意味着您需要 gw1 中的织物。

希望能帮助到你。

# c++ - 有限空间内的记忆

> ID：15256188
> 
> 赞同：0
> 
> 时间：2013-03-06T19:24:41.603
> 
> 标签：c++, map, memoization, stdmap

在尝试提高我对[本次比赛](http://www.codechef.com/MARCH13/problems/RDF)的回答速度时，我有一个函数，它接受两个值`n`并`k`产生一个输出。计算是重复的，所以我要记住它。我不能使用二维数组，因为`n`and的约束`k`是`10^5`! 所以我正在使用地图：

```
std::map<std::pair<int,int>,double> m;

double solve(int n, int k)
{
    if(k==0) return n;
    if(k==1) return (n-1)/2.0;

    std::pair<int,int> p = std::make_pair(n,k);
    std::map<std::pair<int,int>,double>::iterator it;

    if( (it=m.find(p)) != m.end())
        return it->second;

    double ans = 0;
    for(int i=1 ; i<=n-1 ; i++)
        ans += solve(i,k-1);
    ans = ans/n;
    m[p] = ans;

    return ans;
} 
```

但显然，这种方法太慢了。我的记忆有问题吗？或者我可以像数组一样获取恒定时间而不是从地图中获取对数？

这个函数解决了这个重复：

![公式](../Images/2a78baffd39d71a98c03bc1a5610c0e8.png)

`f(x,0) = x`和`f(x,1) = (x-1)/2`

这可以用更好的方式解决吗？提前非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:40:09.493

小改进：记住 find 返回的迭代器并取消引用它，而不是使用 operator[]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:30:14.260

您不必存储二维值数组。代替记忆，扭转问题并改用动态编程。

为了节省一些时间，请注意`f(x, y) = 0`如果`x <= y`.

计算`f(i, 0)`for的值`1 <= i <= x - k`并将它们存储到一维数组中。然后计算`f(i, 1)`、`2 <= i <= x - k + 1`等`f(i, 2)`，`3 <= i <= x - k + 2`直到`f(i, k - 1)`得到`k <= i <= x - 1`。然后就可以计算了`f(x, k)`。在每一步，您只需要两个长度数组`x - k`。

计算`f(i, j)`需要`i - j - 1`加法和除法。所以总时间是 ϴ((x - k) ² k)。但是如果你先计算总和然后除法会更快，因为每个总和只是比前一个多一个元素，所以总时间是 ϴ((x - k) k)。

# php - 是否有 PHP 库或脚本可以将 UA 转换为对人类友好的浏览器 ID 和版本？

> ID：15256190
> 
> 赞同：0
> 
> 时间：2013-03-06T19:24:45.713
> 
> 标签：php, user-agent

理想情况下，这样的脚本会将用户代理（浏览器）字符串作为输入，例如：

> Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 (.NET CLR 3.5.30729)

和输出：

> 火狐 3.6.13 (Windows XP)

或者可能：

```
array('os' => 'Windows XP', 'browser' => 'Firefox', version => '3.6.13') 
```

想法？这存在吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:27:37.050

```
function getBrowser() 
{ 
    $u_agent = $_SERVER['HTTP_USER_AGENT']; 
    $bname = 'Unknown';
    $platform = 'Unknown';
    $version= "";

    //First get the platform?
    if (preg_match('/linux/i', $u_agent)) {
        $platform = 'linux';
    }
    elseif (preg_match('/macintosh|mac os x/i', $u_agent)) {
        $platform = 'mac';
    }
    elseif (preg_match('/windows|win32/i', $u_agent)) {
        $platform = 'windows';
    }

    // Next get the name of the useragent yes seperately and for good reason
    if(preg_match('/MSIE/i',$u_agent) && !preg_match('/Opera/i',$u_agent)) 
    { 
        $bname = 'Internet Explorer'; 
        $ub = "MSIE"; 
    } 
    elseif(preg_match('/Firefox/i',$u_agent)) 
    { 
        $bname = 'Mozilla Firefox'; 
        $ub = "Firefox"; 
    } 
    elseif(preg_match('/Chrome/i',$u_agent)) 
    { 
        $bname = 'Google Chrome'; 
        $ub = "Chrome"; 
    } 
    elseif(preg_match('/Safari/i',$u_agent)) 
    { 
        $bname = 'Apple Safari'; 
        $ub = "Safari"; 
    } 
    elseif(preg_match('/Opera/i',$u_agent)) 
    { 
        $bname = 'Opera'; 
        $ub = "Opera"; 
    } 
    elseif(preg_match('/Netscape/i',$u_agent)) 
    { 
        $bname = 'Netscape'; 
        $ub = "Netscape"; 
    } 

    // finally get the correct version number
    $known = array('Version', $ub, 'other');
    $pattern = '#(?<browser>' . join('|', $known) .
    ')[/ ]+(?<version>[0-9.|a-zA-Z.]*)#';
    if (!preg_match_all($pattern, $u_agent, $matches)) {
        // we have no matching number just continue
    }

    // see how many we have
    $i = count($matches['browser']);
    if ($i != 1) {
        //we will have two since we are not using 'other' argument yet
        //see if version is before or after the name
        if (strripos($u_agent,"Version") < strripos($u_agent,$ub)){
            $version= $matches['version'][0];
        }
        else {
            $version= $matches['version'][1];
        }
    }
    else {
        $version= $matches['version'][0];
    }

    // check if we have a number
    if ($version==null || $version=="") {$version="?";}

    return array(
        'userAgent' => $u_agent,
        'name'      => $bname,
        'version'   => $version,
        'platform'  => $platform,
        'pattern'    => $pattern
    );
} 

// now try it
$ua=getBrowser();
$yourbrowser= "Your browser: " . $ua['name'] . " " . $ua['version'] . " on " .$ua['platform'] . " reports: <br >" . $ua['userAgent'];
print_r($yourbrowser);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:28:37.043

您可以使用[`get_browser()`](http://php.net/manual/en/function.get-browser.php)，但请阅读底部的注释：*您*有责任使 browscap 文件保持最新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:27:56.203

您可以使用[get_browser()](http://php.net/manual/en/function.get-browser.php)。PHP 文档是一个强大的工具！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:35:51.403

似乎很难，因为许多 Web 浏览器退出并发现即使是不同的版本或不同的网站浏览器也代表相同的用户代理字符串。因此，很难创建这样的东西。用户代理列表可以在[这里找到](http://www.useragentstring.com/pages/useragentstring.php)

但是我在这里找到了非常好的[小程序](http://techpatterns.com/downloads/php_browser_detection.php)。它确实运行得非常快，并将用户代理字符串更改为：

```
Your Computer Info
==================
Operating System:    Windows
NT 5.1 (Windows XP)
Current Browser / UA: Mozilla/ Firefox 19.0
ProductSub: 20100101
Layout Engine: Gecko
Engine Version: 19.0

HTML Support
HTML 5 Basic: Good
HTML 5 Forms: Good
XHTML: Yes

System Language    
Primary Language id: en-us
Primary Language: English (United States)
Current Screen Resolution: 1366 x 768 pixels
JavaScript: JavaScript is enabled.
Cookies: Cookies are enabled
PHP Browser Detection: Run Time: 0.00032091 Seconds 
```

上面的输出是由小程序的脚本提供的，它还检测维护移动网站浏览器和机器人的主要列表，这是我迄今为止看到的惊人的。

# node.js - 可以使用许多 socket.io 事件吗？

> ID：15256196
> 
> 赞同：0
> 
> 时间：2013-03-06T19:25:16.727
> 
> 标签：node.js, socket.io

在 node.js 的 socket.io 中，您使用以下方法创建事件： socket.on('my event', function (data) {...});

在我的情况下，我可能需要使用很多不同的事件（接近 100 个），所以我想知道这些事件中的每一个是否为每个客户端套接字创建一个单独的侦听器，并且会占用更多的资源而不仅仅是一个事件接收一个包含标识符的对象，我可以在该对象上使用 switch 来处理我需要的事件。哪个选项会更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:26:53.587

socket.io 连接的事件超过 100 个应该不会有问题。

每个甚至都**不会**创建新的连接，因此不应该存在“连接太多”的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:27:33.993

他们不会为每个事件创建新的套接字，您可以发送任意数量的事件。当套接字数据包通过线路时，事件名称只是一个文本属性。

如果您使用自己的事件名称系统，那么您可能只是重写已经存在的系统。

# typescript - 如何从构造函数的事件内部访问类函数？

> ID：15256198
> 
> 赞同：0
> 
> 时间：2013-03-06T19:25:27.893
> 
> 标签：typescript

我在 typescript 中的类构造函数中向 ID 添加了一个更改事件，并且在该更改事件中我想访问一个类函数，但是在事件内部时，“this”似乎不是类。如何从那里访问该功能？

```
export class Document_Uploads {

        constructor() {
            $("#FormBrokerReferenceID").change(function () {
                 = $("#FormBrokerReferenceID").val();

                //inside this event it does not work           
                this.Validate()

            });

             // works here inside constructor
            this.Validate()

        }

    Validate() {
            var valid: bool = true;
             some other code
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T21:21:30.933

您的问题有两种解决方案。

首先是让 TypeScript 为您处理范围：

```
 constructor() {
        $("#FormBrokerReferenceID").change( () => {
             = $("#FormBrokerReferenceID").val();

            // Should now work...         
            this.Validate()

        });

         // works here inside constructor
        this.Validate()
    } 
```

第二个是自己处理它，尽管这是手动执行 TypeScript 会为您做的事情 - 值得知道它不是魔术。如果您不想覆盖`this`事件中的含义，但也想访问“外部” this，这可能很有用。

```
 constructor() {
        var self = this;

        $("#FormBrokerReferenceID").change(function () {
             = $("#FormBrokerReferenceID").val();

            // Should now work...         
            self.Validate()

        });

         // works here inside constructor
        this.Validate()
    } 
```

# mysql - 重新格式化表数据sql

> ID：15256203
> 
> 赞同：0
> 
> 时间：2013-03-06T19:25:32.750
> 
> 标签：mysql, sql

我有一个`name`包含以下行的字段：

```
`name`
------
John Smith
George Washington
Ash Ketchum
Bill O'Reilly 
```

我想重新格式化输出的行：

```
`name`
------
SMITH, JOHN
WASHINGTON, GEORGE
KETCHUM, ASH
O'REILLY BILL 
```

我知道我可以使用`upper(` `x.name` `)`大小写，但是如何重新格式化名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:27:51.757

试试这个：

```
SELECT SUBSTRING_INDEX( `name` , ' ', -1 ) + ', ' + SUBSTRING_INDEX( `name` , ' ', 1 )
FROM MyTable 
```

@Ben，很好地说明了名称中包含多个空格的名称。我怀疑这会给你在这些情况下你想要的输出，但它应该让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:30:27.730

假设您的 rdbms 是 mySql，则需要针对不同的 sql 方言定制答案。

```
SELECT concat( substring(name, locate(name, ' ')), ', ',  substring(name, 0, locate(name, ' ') - 1)) FROM NAMES; 
```

然而，这里真正的问题是数据完整性。您需要为名称的每个部分设置单独的列，以确保数据库中的格式一致。理想情况下，你会想要这样做——

```
Select concat(last_name,  ', ', first_name) FROM NAMES; 
```

允许

```
 'name' 
-------------------
John Smith
Smith, John
J Smith
Smith J
John q Smith
Jhon 'the smithmeister' Smith 
```

由于多种原因，所有在表的同一列中都是一件坏事，因此应该明确防止这种情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:44:00.810

试试这个

```
 SELECT Concat(SUBSTRING_INDEX( `name` , ' ', -1 ) , ', ' , SUBSTRING_INDEX( `name` , ' ', 1 )) as name
 FROM your_Table 
```

# linux - 用于更新多个文件夹的命令的 Linux shell 脚本

> ID：15256206
> 
> 赞同：1
> 
> 时间：2013-03-06T19:25:37.613
> 
> 标签：linux, shell, scripting

我有一个我创建的脚本，它只是一个命令列表（cp、mkdir、rm 等）。这基本上是用源文件夹的内容更新一堆文件夹的内容。

现在我有大约 15 个文件夹要修改，每个文件夹大约有 30 个命令。所以当我需要添加一个文件夹时，我需要再添加 30 个命令并指定那个文件夹。

脚本中有没有办法创建一组文件夹来更改和循环遍历它或其他什么？

我的脚本现在只包含通常在命令行中运行的基本命令，所以没有什么高级的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:29:01.360

是的，你可以这样做：

```
for x in "folder1" "folder2" "folder3"; do
  mkdir $x
  cp foobar $x
done 
```

更好的是，使用数组来保存文件夹名称，例如

```
arr=("folder1" "folder2" "folder3")

for x in ${arr[*]} do
  mkdir $x
  cp foobar $x
done 
```

如果您有遵循某种模式的特定名称，您可能可以使用循环自动生成该名称列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:32:39.430

这是一种方法：

```
#!/bin/bash

# This function does all you clever stuff
# $1 contains the first parameter, $2 the second and so on
function my_cmds()
{
    echo $1
}

# You can loop over folders like this
for i in folder1 folder2 folder3
do
    # here we call a function with the string as parameter 
    my_cmds $i
done

# ... or like this
folders[0]="folder0"
folders[1]="folders1"
folders[2]="folders2"

for i in "${folders[@]}"
do
    my_cmds $i
done 
```

初始化整个数组的一种方便方法是

```
array=( element1 element2 ... elementN ) 
```

符号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:05:08.537

这类似于使用`for`循环的答案，但使用 here 文档来存储文件夹列表。这就像在脚本中嵌入了一个数据文件。

```
while read -r folder <&3; do
    mkdir "$folder"
    # etc
done 3<<EOF
folder1
folder2
folder with space
EOF 
```

我将文件描述符 3 用于此处文档，以防循环主体中有尝试从标准输入读取的命令。

# c# - 为什么构造函数不接受具有较低可访问性的类的参数？

> ID：15256208
> 
> 赞同：1
> 
> 时间：2013-03-06T19:25:42.823
> 
> 标签：c#, constructor

这里是：

我有两个表单和一个类，我想通过一个参数（属于第二个表单的构造函数）将这个类的实例从 Form1 传递到 Form2。

```
public partial class Form1 : Form
{
    Class1 cl = new Class1();

    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Form2 frm_2 = new Form2(cl);
    }
} 
```

因此，我收到以下错误：

*可访问性不一致：参数类型“WindowsFormsApplication1.Class1”比方法“WindowsFormsApplication1.Form2.Form2(WindowsFormsApplication1.Class1)”更难访问*

```
public partial class Form2 : Form
{
    public Form2(Class1 c)
    {
        InitializeComponent();
        Class1 c_1 = new Class1();
        c_1 = c;
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-06T19:28:39.087

`Class1`是您的程序集的内部类，但您正在创建一个公共类的公共方法，该公共类`Class1`作为参数。这就像您公开发布广告说“我们正在接受工作申请，但如果您已经在这里工作，您只能获得申请表的副本”。它没有任何意义，所以编译器不允许它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T19:34:11.837

您已将您定义`Class1`为`internal`：

```
internal class Class1
{
} 
```

或（相同）：

```
class Class1
{
} 
```

但是您有一个`public`接受类型参数的方法（在本例中为构造函数）`Class1`。`public`表示它对任何其他程序集可见，但`internal`意味着它仅在定义它的程序集（您的程序集）中可见。所以，你有一个任何人都可以调用的方法，它接受一个只有你才能看到的类型的参数。那是行不通的。您在这里有两个选择：

### 选项 1：`Class1`公开

```
public class Class1
{ } 
```

如果您不介意可以从任何程序集中访问该类。

### 选项 2：将表单的构造函数设为内部

```
internal Form2(Class1 c)
{ } 
```

如果您不介意除了您的程序集之外的任何其他程序集都不能创建该表单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:27:09.880

Class1 需要被声明为公共类，即`public class Class1() {...}`为了被其他公共类使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:47:38.683

您的 Class1 应该是公共的，因为 Form2 并且它的构造函数具有公共范围。如果我们不将 Class1 设为 public，那么访问是有限的。这就是编译器显示此消息的原因。

```
public partial class Form2 : Form
{
    public Form2()
    {
        InitializeComponent();
    }

    public Form2(Class1 c)
    {
        InitializeComponent();
        Class1 c_1 = new Class1();
        c_1 = c;
    }
}

public class Class1
{

    // Your code for Class1
} 
```

# python - GitHub 上的 Python 文件结构

> ID：15256213
> 
> 赞同：9
> 
> 时间：2013-03-06T19:26:08.833
> 
> 标签：python

我一直在查看一些关于 Python 的开源项目，并且看到了很多我不熟悉的文件和模式。

首先，很多项目只有一个名为 的文件`setup.py`，它通常包含一个函数：

```
setup(blah, blah, blah) 
```

其次，很多包含一个简单调用的文件，`__init__.py`并且几乎不包含任何信息。

第三，一些`.py`文件包含类似这样的语句：

```
if __name__ == "__main__" 
```

最后，我想知道在 git 存储库中划分 Python 文件是否有任何“最佳实践”。在 Java 中，由于类结构，文件分割的想法很自然地出现。使用 Python，许多脚本根本没有类，有时程序会有 OOP 方面，但逐类划分并没有那么大的意义。它只是“使代码最易读的任何东西”，还是在某处有一些关于此的指导方针？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-06T19:34:35.577

这`setup.py`是 Python 模块分发的一部分，使用分发[实用程序](http://docs.python.org/2/distutils/index.html)。它允许[轻松安装](http://docs.python.org/2/install/index.html)Python 模块，并且在您想要将项目作为整个 Python 模块分发时很有用。

`__init__.py`用于 Python 的包[系统](http://docs.python.org/2/tutorial/modules.html#packages)。一个空文件通常足以让 Python 将它所在的目录识别为一个包，但您也可以在其中定义不同的东西。

最后，`__name__ == '__main__'`检查是确保当前脚本直接运行（例如从命令行），而不是仅仅导入到其他脚本中。在 Python 脚本执行期间，只有一个模块的`__name__`属性将等于`__main__`. 另请参阅[我在此处的回答](https://stackoverflow.com/questions/13323827/i-dont-understand-pythons-main-block-what-is-that-thing/13323859#13323859)或关于该主题的更[一般的问题](https://stackoverflow.com/questions/419163/what-does-if-name-main-do)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T19:37:33.760

这`setup.py`是[distutils](http://docs.python.org/2/distutils/setupscript.html)设置过程的一部分。如果您要分发一个模块，而不仅仅是一个基本脚本，那么您将需要其中一个（即使这样，拥有一个也是一个好主意，以便您以后可以轻松地扩展成一个模块）。

`__init__.py`python[模块导入过程](http://effbot.org/pyfaq/what-is-init-py-used-for.htm)的一部分：

> 名为**init** .py 的文件用于将磁盘上的目录标记为 Python 包目录。如果你有文件
> 
> mydir/spam/ **init** .py mydir/spam/module.py 和 mydir 在你的路径上，你可以将 module.py 中的代码导入为：
> 
> 导入 spam.module 或
> 
> from spam import module 如果您删除了**init** .py 文件，Python 将不再在该目录中查找子模块，因此导入模块的尝试将失败。

`if __name == "__main__"`是一种指示在文件直接运行而不是导入时将执行的代码的方法。

要回答如何布局代码，`distfiles`文档对此有[很好的指导](http://docs.python.org/2/distutils/examples.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-06T19:37:54.617

除了@poke 的回答，请参阅有关python 项目的目录结构应该是什么的[相关问题。](https://stackoverflow.com/questions/193161/what-is-the-best-project-structure-for-a-python-application)[这](https://blogs.gnome.org/jamesh/2012/05/21/python-zip-files/)是另一个关于如何使您的项目易于运行的有用教程。

# javascript - 如何使用 jQuery 在我的 HTML 页面中创建所有跨度

> ID：15256216
> 
> 赞同：0
> 
> 时间：2013-03-06T19:26:19.177
> 
> 标签：javascript, jquery, json, html, textinput

我通过以下方式在我的 HTML 页面中获取所有输入文本：

```
 var inputs = data.context.find(':input');
 $('#result').text(JSON.stringify(inputs.serializeArray())); 
```

然后我有一个 JSON 字符串，其中包含每个输入文本的 id 和值。

我正在尝试做类似的事情，但我所有的跨度。我的 HTML 文件中有这个：

```
 <td class="name"><span>{%=file.name%}</span></td> 
```

我可以拥有任意数量的`<td class="name"> ...`标签。所以我必须得到所有它们的值并转换为 JSON 字符串，就像我对上面的输入文本所做的那样。

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:32:14.137

此代码片段：`$('.name span')`将返回一个对象数组，因此为了从每个对象中获取文本，您需要将其作为数组运行：

```
$('.name span').each(function(index,val){
   //do something with val
}); 
```

[您可以在此处](http://api.jquery.com/jQuery.each/)查看此方法的参考。

简单的小提琴：http: [//jsfiddle.net/CMdBa/1/](http://jsfiddle.net/CMdBa/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T19:34:26.780

迭代`.name`（或在必要时更深入地指定），构建您的数据结构（使用`data`），然后将其转换为 JSON。工作示例：http: [//jsfiddle.net/tLuPC/](http://jsfiddle.net/tLuPC/)

以下是模拟`id`您是否需要获得帖子中提到的内容。使用`data-`属性存储信息。否则，您可以简单地获得`name`.

```
var data = [],
    jsonData = null;

$('.name').each(function () {
    var item = $(this);

    data.push({
        id: item.data('id'),
        name: $('span', item).text()
    });
});

jsonData = JSON.stringify(data);

console.log(JSON.stringify(jsonData)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:34:51.580

您可以使用`map`函数来枚举和格式化集合。

```
var spanTextArray = $('td.name span').map(function(){
    return $.trim(this.innerHTML);
}).get(); 
```

这将输出一个文件名数组，您可以轻松修改返回以输出一个键值对数组。

# php - 多维数组的PHP foreach

> ID：15256221
> 
> 赞同：0
> 
> 时间：2013-03-06T19:26:28.287
> 
> 标签：php, foreach

我有一个数组，它里面有两个数组......我可以通过这样做来访问我想要的第一行......

```
print_r( $_SESSION['shopcart']['cart']['qty']); 
```

我将如何在 foreach 中编写它？

谢谢，J

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:30:39.410

如果要遍历多个维度，可以嵌套foreach如下：

```
foreach($_SESSION['shopcart'] as $cart) {
    foreach ($cart as $qty) {
        // do something
    }
} 
```

尽管我需要更多关于数组结构的信息以及您真正想要做什么才能提供可用的代码，但这可能是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:27:53.420

```
foreach($_SESSION['shopcart']['cart']['qty'] as $value) {
    echo $value;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:28:41.380

你会做这样的事情：

转储数组：`$_SESSION['shopcart']['cart']`

```
foreach($_SESSION['shopcart']['cart'] as $key=>$value){
    echo $key." => ".$value."<br/>";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:46:39.630

我建议你这样做：

```
foreach($_SESSION['shopcart'] as $key=>$value){
    if(is_array( $value ) ){
       foreach($value => k1 => $v1){

        //do something here if array 

         echo $k1." => ".$v1."<br/>";
       }
    }else{
         //do something here if not array 
    }
} 
```

# r - 如何让 ESS 识别 R 中的动态提示？

> ID：15256222
> 
> 赞同：2
> 
> 时间：2013-03-06T19:26:29.677
> 
> 标签：r, command-prompt, ess

我按照这里的建议... [R：在 R 命令行中显示一个时钟，](https://stackoverflow.com/questions/4222476/r-display-a-time-clock-in-the-r-command-line)以使我的 R 提示符显示我最后一次输入命令的时间。但是现在`M-r`和`M-p`被破坏了，因为 ESS 不再将我不断变化的命令提示符识别为命令行的开始。

有谁知道要更改哪个选项，以便对于必须检测提示的所有目的，而不是匹配整个提示字符串，ESS 将只匹配它的恒定尾端，或者更好的是，像“^ [0-”这样的正则表达式9]{6} [0-9]{2}:[0-9]{2} >"

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T21:25:37.643

我的`ess/ess-custom.el`包含以下几行：

```
;; does it make sense to customize here, as we currently set this *directly*
;; in the FOO-BAR-cust-alist's ???
;; VS: Right. It only confuses users. It should be set in post-run-hook if
;; desired;  inferior-S-prompt should be customized instead.
(defvar inferior-ess-primary-prompt "> "
  "Regular expression used by `ess-mode' to detect the primary prompt.")

(make-variable-buffer-local 'inferior-ess-primary-prompt)
;; (setq-default inferior-ess-primary-prompt "> ")

(defvar inferior-ess-secondary-prompt nil
  "Regular expression used by ess-mode to detect the secondary prompt.
(This is issued by S to continue an incomplete expression).
Set to nil if language doesn't support secondary prompt.")
;; :group 'ess-proc
;; :type 'string)

(make-variable-buffer-local 'inferior-ess-secondary-prompt)
;; (setq-default inferior-ess-secondary-prompt "+ ")

;; need to recognise  + + + > > >
;; and "+ . + " in tracebug prompt
(defcustom inferior-S-prompt "[]a-zA-Z0-9.[]*\\([>+.] \\)*[+>] "
  "Regexp used in S and R inferior and transcript buffers for prompt navigation.

You can set it to \"[]a-zA-Z0-9.[]*\\(> \\)+\" if you want to
skip secondary prompt when invoking `comint-previous-prompt'.
 "
  :group 'ess-proc
  :type 'string) 
```

所以我希望自定义这些变量中的任何一个都会有所帮助。可能从可定制的开始，即`inferior-S-prompt`.

# sql - 根据状态选择

> ID：15256228
> 
> 赞同：1
> 
> 时间：2013-03-06T19:26:44.300
> 
> 标签：sql, oracle

我有这个用于计算组件的 SQL 查询：

```
SELECT COUNT(CS.COMPONENTTYPEID) AS CNT
FROM COMPONENTTYPE CT LEFT
OUTER JOIN COMPONENTSTATS CS ON CS.COMPONENTTYPEID = CT.COMPONENTTYPEID
WHERE CT.COMPONENTTYPEID IN (?, ?)
GROUP BY CT.NAME,
         CT.COMPONENTTYPEID
ORDER BY CT.COMPONENTTYPEID 
```

我想选择所有具有`status = 'Active'`. 我必须插入它的正确位置在哪里？也许是这样：

```
SELECT COUNT(CS.COMPONENTTYPEID) AS CNT
FROM COMPONENTTYPE CT LEFT
OUTER JOIN COMPONENTSTATS CS ON CS.COMPONENTTYPEID = CT.COMPONENTTYPEID
WHERE CT.COMPONENTTYPEID IN (?, ?) WHERE STATUS = 'Active'
GROUP BY CT.NAME,
         CT.COMPONENTTYPEID
ORDER BY CT.COMPONENTTYPEID 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:34:35.273

```
SELECT COUNT(CS.COMPONENTTYPEID) AS CNT
FROM COMPONENTTYPE CT 
    LEFT OUTER JOIN COMPONENTSTATS CS ON CS.COMPONENTTYPEID = CT.COMPONENTTYPEID AND CS.STATUS = 'Active'
WHERE CT.COMPONENTTYPEID IN (?, ?) 
GROUP BY CT.NAME, CT.COMPONENTTYPEID
ORDER BY CT.COMPONENTTYPEID 
```

过滤器应该在连接子句上，因为它用于创建连接表的结果集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T19:35:16.860

你要么需要一个复合 whereclause，否则你的左连接无效。

```
SELECT COUNT(CS.COMPONENTTYPEID) AS CNT
FROM COMPONENTTYPE CT 
LEFT OUTER JOIN COMPONENTSTATS CS 
  ON CS.COMPONENTTYPEID = CT.COMPONENTTYPEID
WHERE CT.COMPONENTTYPEID IN (?, ?) and (STATUS = 'Active' or Status is null)
GROUP BY CT.NAME,
         CT.COMPONENTTYPEID
ORDER BY CT.COMPONENTTYPEID 
```

或者您必须将限制标准放在连接本身上。

```
SELECT COUNT(CS.COMPONENTTYPEID) AS CNT
FROM COMPONENTTYPE CT 
LEFT OUTER JOIN COMPONENTSTATS CS 
  ON CS.COMPONENTTYPEID = CT.COMPONENTTYPEID
  AND (STATUS = 'Active')
WHERE CT.COMPONENTTYPEID IN (?, ?) 
GROUP BY CT.NAME,
         CT.COMPONENTTYPEID
ORDER BY CT.COMPONENTTYPEID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:35:17.910

由于`STATUS`列在`COMPONENTSTATS`表中，查询应该是

```
SELECT COUNT(CS.COMPONENTTYPEID) AS CNT
FROM COMPONENTTYPE CT LEFT
OUTER JOIN COMPONENTSTATS CS ON CS.COMPONENTTYPEID = CT.COMPONENTTYPEID
WHERE CT.COMPONENTTYPEID IN (?, ?) AND CS.STATUS = 'Active'
GROUP BY CT.NAME,
         CT.COMPONENTTYPEID
ORDER BY CT.COMPONENTTYPEID 
```

# linq-to-sql - LINQ2SQL InvalidCastException

> ID：15256229
> 
> 赞同：0
> 
> 时间：2013-03-06T19:26:52.177
> 
> 标签：linq-to-sql, asp.net-mvc-2, sql-server-2008-r2, iis-7.5, .net

我有一个网站，有时会失去对数据库的访问权限。该网站仍然在 IIS 上运行，我可以毫无问题地访问首页。

我在开发或测试中没有遇到这个错误，只有在现场。

> 我第一个记录的异常似乎总是一个 InvalidCastException，带有以下堆栈跟踪。

```
06-03-2013 09:06:26 
The exception was: Specified cast is not valid.
at System.Data.SqlClient.SqlBuffer.get_Int32()
at System.Data.SqlClient.SqlDataReader.GetInt32(Int32 i)
at Read_Question(ObjectMaterializer`1 )
at System.Data.Linq.SqlClient.ObjectReaderCompiler.ObjectReader`2.MoveNext()
at System.Linq.Enumerable.SingleOrDefault[TSource](IEnumerable`1 source)
at System.Data.Linq.EntityRef`1.get_Entity()
at DB.TempQuestion.get_Question() in xxxx\DBLinq.designer.cs:line 9808
at xxxx.TestController.BuildBarHelperForPersonAssignment(PersonAssignment pa) in xxxx\TestController.cs:line 751
at xxxx.TestController.BuildMovieModel(TempMovie tm, PersonAssignment pa) in xxxx\TestController.cs:line 792
at xxxx.TestController.ShowMovie(TempMovie tm, PersonAssignment pa) in xxxxx\TestController.cs:line 636
at xxxx.TestController.Index(String id, FormCollection form, Nullable`1 currentid, String type, Int32[] selectedTest) in xxxx\TestController.cs:line 313 
```

在此之后，我收到各种 InvalidCastExceptions 和“服务器无法恢复事务”错误。

很清楚错误发生在哪里。我的问题是为什么会发生这种情况以及为什么会导致应用程序无法访问数据库？

我认为错误出现在所有这些之前。

> 我的应用程序设置：

ASP.NET MVC2、LINQ2SQL、MsSQL Server 2008 R2、IIS 7.5 (ASP 2.0)

> 我的控制器设置：

我担心我需要重新设计我的控制器，它们几乎都是这样的。

```
[Authorize(Roles = "xxxxx")]
Public class ABController : Controller
{
    private readonly DBLinqDataContext _db = new DBLinqDataContext();

    public ActionResult Index()
    {
        ...
    }
} 
```

由于未关闭的 DBLinqDataContext 会发生此错误吗？

添加以下覆盖的方法可能有帮助吗？

```
 protected override void Dispose(bool disposing)
    {
        _db.Dispose();
        base.Dispose(disposing);
    } 
```

如果您需要更多信息，请与我们联系！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:30:58.390

看起来您已将其中一个`TempQuestion`属性类型从`int`更改为某物，但忘记更改相应表列的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:09:41.713

解决了...

这是由于多个未处理的dataContext

# jms - 使用 activemq 客户端连接到 ibm mq 代理

> ID：15256236
> 
> 赞同：0
> 
> 时间：2013-03-06T19:27:13.447
> 
> 标签：jms, activemq, ibm-mq

我使用本地机器上的 IBM MQ 连接到客户端机器上的远程 IBM MQ 队列管理器以发送和接收消息。由于某些问题，我需要卸载 IBM MQ。我可以使用 Apache ActiveMQ 连接到客户端远程队列管理器吗？（使用 SSL）

如果可能的话，请指导我如何进行。如果没有，请建议任何替代解决方案进行连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:37:19.487

不可以。使用 WebSphere MQ 客户端连接到它。它可作为[SupportPac MQC75](http://ibm.co/SupptPacMQC75)免费下载，并支持多种语言，包括 C 和 Java。请安装整个客户端分发，而不仅仅是获取 jar 文件。IBM 在该发行版中包含许多诊断实用程序、跟踪等。这些使调试变得更加容易，如果您打开支持票证，IBM 会要求安装它们。由于客户端是免费的，因此要求安装诊断工具似乎是合理的。

客户的文档在[这里](http://pic.dhe.ibm.com/infocenter/wmqv7/v7r5/index.jsp)。

Active MQ 使用不同的有线协议，它的客户端不能与 WebSphere MQ 一起工作。

# c - 基本的 C 编程练习卡住了

> ID：15256238
> 
> 赞同：0
> 
> 时间：2013-03-06T19:27:17.780
> 
> 标签：c

我一直在做很多练习和例子来掌握 C 的窍门，它终于开始慢慢地沉入其中，但肯定是。虽然我对此有一个小问题并且无法为我的生活修改它：

```
#include "stdafx.h"
#include <stdio.h>

int _tmain(int argc, _TCHAR * argv[]) {
    int i, grades[] = {98, 87, 92, 79, 85};
    for(i = 0; i <= 4; ++i) {
        printf("Element %d is %d\n"
        i, grades[i]);
    }
    i = getchar();
    return 0;
} 
```

问题是**我**期待一个括号，我不知道为什么，我尝试过的任何修改都失败了，我知道这是一个简单的问题，但它让我卡住了。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:28:12.257

问题是您缺少一个逗号来分隔调用中的参数`printf`：

```
printf("Element %d is %d\n", i, grades[i]);
//                         ^
//                      This one 
```

# javascript - 从 ExpressJS 服务器获取主干模型

> ID：15256239
> 
> 赞同：0
> 
> 时间：2013-03-06T19:27:21.137
> 
> 标签：javascript, node.js, backbone.js, express

我在创建客户端骨干模型时遇到困难，该模型在初始化时会从 ExpressJS 服务器检索一些 XML。创建 Backbone 模型时，初始化函数会调用`model.fetch()`并在查询字符串中传入其模型 ID。服务器应该读取 ID 并返回正确的 XML。

这目前不起作用（下面的代码），当我在浏览器中调试时，我可以看到网络请求似乎是正确的，例如请求可能是`/biomodels?id=BIOMD0000000001`，但是当它从 Backbone 启动时，请求保持挂起状态。

但是，如果我使用我的浏览器 (Chrome)，然后转到，`/biomodels?id=BIOMD0000000001`则正确检索模型。

Express 服务器路由处理程序：

```
/*global exports require*/
exports.getModel = function (req, res) {
    // Dependencies
    var biomodels = require('biomodels').BioModelsWSClient;
    // Get SBML From ID
    console.log('requested ID: ' + req.query.id)
    console.log(biomodels.getModelSBMLById(req.query.id, function (err, results) {
        console.log(err + results);
        res.send(err + results);
    }));
}; 
```

骨干模型：

```
define([
    'underscore',
    'backbone'
], function (_, Backbone) {
    'use strict';

    var BioModel = Backbone.Model.extend({
        defaults: {
            sbml: 'was not fetched',
            id: 'was not assigned'
        },

        initialize: function () {
            var modelId = this.id,
                modelSbml = this.sbml;
            this.fetch({
                data: {
                    id: modelId
                },
                type: 'GET',
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log('error in GET: ' + textStatus + errorThrown);
                },
                url: 'biomodels',
                success: function (data, textStatus, jqXHR) {
                    modelSbml = data;
                    console.log('loaded ' + modelSbml);
                }
            });
        }
    });

    return BioModel;
}); 
```

# javascript - 创建一个可以读取 Python 并将其转换为 HTML 的框架

> ID：15256240
> 
> 赞同：0
> 
> 时间：2013-03-06T19:27:23.873
> 
> 标签：javascript, python, html

大家好，这是我的第一篇文章，因为我已经用尽了谷歌，正在寻求一点帮助。

我是一名学校老师，我正在为我的学校创建一个 ELearning 网站，目前我正在尝试创建一个代码窗口，我的学生可以在其中输入一些 python 语法，然后单击代码转换并显示在相邻的窗口中。与 W3schools 中用于其示例和各种电子学习网站的内容非常相似。

有没有人知道我应该从哪里开始或有任何关于创建这个的链接？当按下“提交代码”按钮时，我可能会按照用户输入代码创建一个 javascript 对象，然后使用某种 ajax 将其渲染到相邻的结果框中。

谢谢大家的好意，问候安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:34:56.367

最简单的方法是创建一个带有 iframe 的页面，调用它`result`。然后创建一个简单的`<form>`并给表单标签一个属性`target="result"`。在表单中包含一个文本区域。您学生的代码通过一个简单的`form submit`. 然后，当您的服务器生成 HTML 响应时，它会在 iframe 中呈现。

不需要javascript。吻！

# php - 我无法让表单数据进入数据库。我究竟做错了什么？

> ID：15256247
> 
> 赞同：1
> 
> 时间：2013-03-06T19:27:41.510
> 
> 标签：php, database, forms

代码已更新，仍然无法正常工作。我知道我显然正在使用将过时的 mysql 函数。但现在我想要的只是让这段代码工作。我想知道我做错了什么:(

我对 php 和数据库非常陌生...我一直在努力获取简单的 html 表单数据以进入数据库表。而且我无法让它工作:(谁能帮忙看看我的代码有什么问题？我刚刚在数据库中做了一个简单的表，其中包含字段 ID、FIRSTNAME 和 SURNAME。这是代码：

```
 <?php 
    //connect to database
    $mysql_host = 'localhost';
    $mysql_user = 'root';
    $mysql_pass = '';

    $mysql_db = 'test';

    if (!mysql_connect ($mysql_host, $mysql_user, $mysql_pass)||!mysql_select_db ($mysql_db) ) {
        die(mysql_error());

    }   

    // Code     
    if (isset($_POST['firstname'])&&
    isset($_POST['surname'])) {

    $firstname = $_POST['firstname'];
    $surname = $_POST['surname'];

    if (!empty($username)&&!empty($password)) {
    $query = "INSERT INTO `test`.`test_tabell` 
    VALUES ('', '" . mysql_real_escape_string($firstname) . "', '" . mysql_real_escape_string($surname) . "')";
    /*$query = "INSERT INTO `test`.`test_tabell` VALUES (``, `.$firstname.`, `.$surname.`)"; */
    $query_run = mysql_query($query);
if (!$query_run) echo mysql_error(); 
}
}
    ?>

    <form action="add.php" method="POST">
    Firstname:<br> <input type="text" name="firstname" value="<?php if (isset($firstname)) { echo $firstname; } ?>"><br><br>
    Surname:<br> <input type="text" name="surname" value="<?php if (isset($surname)) { echo $surname; } ?>"><br><br>
    <input type="submit" value="Submit">
    </form> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:43:37.367

不要使用 mysql 特定的语法，它已经过时了，当你需要做一些高级别的事情时它开始很烦人，而且你不能切换到 sqlite 或 postgresql。

我建议使用 PDO，您可以执行以下操作：

```
// Usage:   $db = connectToDataBase($dbHost, $dbName, $dbUsername, $dbPassword);
// Pre:     $dbHost is the database hostname, 
//          $dbName is the name of the database itself,
//          $dbUsername is the username to access the database,
//          $dbPassword is the password for the user of the database.
// Post:    $db is an PDO connection to the database, based on the input parameters.
function connectToDataBase($dbHost, $dbName, $dbUsername, $dbPassword)
{
    try
    {
         return new PDO("mysql:host=$dbHost;dbname=$dbName;charset=UTF-8", $dbUsername, $dbPassword);
    }
    catch(PDOException $PDOexception)
    {
        exit("<p>An error ocurred: Can't connect to database. </p><p>More preciesly: ". $PDOexception->getMessage(). "</p>");
    }
} 
```

然后初始化变量（我想你忘了定义数据库的名称）；

```
$host = 'localhost';
$user = 'root';
$dataBaseName = 'databaseName';
$pass = ''; 
```

现在您可以通过以下方式访问您的数据库

```
$GLOBALS['db'] = connectToDataBase($host , $databaseName, $user, $pass); 
```

现在您有一个 PDO 数据库连接的实例。

我想指出的一件事是，您很喜欢 sql 注入，您想在查询中使用准备好的语句，例如：

```
$query = "INSERT INTO test(first_name, sur_name) VALUES (:firstname, :surname);"; 
```

我们将在查询中执行两个变量 $firstName 和 $surName，使它们替换 :firstName 和 :surName 的值，让我首先创建一个简单的插入函数来向您展示：

```
function insertFunction($db, $query, $firstName, $surName)
{
    $statement = $db->prepare($query);
    return $statement->execute(array(":firstName" => $firstName, ":surName" => $surName));
} 
```

所以你很容易做类似的事情

```
$firstName = 'Smith';
$surName = 'John';
$db = $GLOBALS['db'];

$success = insertFunction($db, $query, $firstName, $surName); 
```

现在您可以通过检查 $success 是真还是假来检查它是否成功。

如果您想查看 PDO 的更高级使用（多行等），那么您可以在此处查看我的评论之一：[Javascript function as php?](https://stackoverflow.com/questions/15164828/javascript-function-as-php) （不是顶级评论）。

我希望这有帮助。如果有什么奇怪的地方请评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:32:10.827

很难在没有看到您的架构的情况下分辨，但试试这个：

```
$query = "INSERT INTO `test`.`test_tabell` VALUES ('', '$firstname', '$surname')";
$query_run = mysql_query($query); 
```

您使用的是反引号而不是撇号。此外，您正在尝试在定义查询是什么之前执行查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:32:41.560

您的插入查询是错误的**，并且还对 SQL 注入开放**。应该是这样的：

```
$query = "INSERT INTO `test`.`test_tabell` 
    VALUES ('', '" . mysql_real_escape_string($firstname) . "', '" . mysql_real_escape_string($surname) . "')"; 
```

注意 all`backticks`变为`apostrophe`。

* * *

此外，您正在尝试在定义之前执行查询。

* * *

## 编辑

根据您与表定义相关的信息，您可以跳过`id`表中的字段。INSERT 查询将变为：

```
$query = "INSERT INTO `test`.`test_tabell` (`FIRSTNAME`, `SURNAME`)
    VALUES ('" . mysql_real_escape_string($firstname) . "', '" . mysql_real_escape_string($surname) . "')";
$query_run = mysql_query( $query ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:38:02.407

正如评论中所发布的，你真的不应该使用/学习/练习使用任何以“mysql_”开头的函数，因为一旦 PHP 更新它就不会工作。这些功能即将推出。祝你学习使用 PHP 和 SQL 数据库好运——只要确保你正在学习一些对未来有用的东西。请务必阅读与 PHP 以及 PDO 和 mysqli_* 函数相关的面向对象编程 (OOP)。

# amazon-web-services - EC2 中的数据密集型流程 - 任何提示？

> ID：15256253
> 
> 赞同：1
> 
> 时间：2013-03-06T19:27:54.357
> 
> 标签：amazon-web-services, amazon-ec2, oracle11g, etl

我们正在尝试在 Amazon EC2 上的**高 I/O 实例中运行 ETL 进程。**在装备精良的笔记本电脑（带有 SSD）上本地执行相同的过程大约需要 1/6 的时间。这个过程基本上是将数据（大约 3000 万行）从平面表转换为同一个 Oracle 实例中的第 3 范式模式。

关于什么可能会减慢我们的速度的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T00:08:37.147

或者另一种选择是简单地离开 AWS 并在 Rackspace 之类的地方租用带有 SSD 的坚固盒子（原始硬件）。

我们已将大部分 ETL 流程从 AWS/EMR 中移出。我们将大部分内容托管在 Rackspace 上，并获得更多的 CPU/存储/性能。不要误会我的意思，AWS 很棒，但有一点是不划算的。最重要的是，您永远不知道他们如何真正管理/虚拟化适用于您的特定应用程序的硬件。

我的两分钱。

# asp.net - Windows CE (.NET CF 1.0) 应用程序可以访问 Web 服务吗？

> ID：15256254
> 
> 赞同：1
> 
> 时间：2013-03-06T19:27:55.167
> 
> 标签：asp.net, web-services, rest, compact-framework, windows-ce

我们正计划用某种简化的服务来替换旧的“服务器”应用程序（一个 Windows 窗体应用程序，尽管它并不真正需要它，一个 GUI 表示（显示状态消息））。服务器/服务响应数据请求并发送所述数据。旧版 (.NET CF 1.0) 应用程序是否能够更新到更新的技术（因为它们运行的​​手持设备没有空间容纳更新/更大的 .NET Compact Framework 运行时）能够访问“新奇”的服务，例如 asp.net RESTful Web 服务？如果没有，还有哪些其他选择？或者，即使在可行的情况下还有更好的选择，你们会建议什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:35:53.493

不，较旧的 .Net “服务参考”不理解较新的格式/协议。

但是，归根结底，这只是一堆自动生成的将“对象”映射到 XML 的代码。

建议：

只需直接解析 XML。

如果有疑问，请使用[SoapUI使用您的目标服务](http://www.soapui.org/)

除非您有一个*非常*复杂的架构，否则这可能是最容易编程且内存效率最高的解决方案。

恕我直言...

# string - 八度音阶字符串错误

> ID：15256256
> 
> 赞同：0
> 
> 时间：2013-03-06T19:27:57.967
> 
> 标签：string, count, octave

我在 Octave 中遇到问题我想在文本中找到所有不同（！）的两个字母对（没有空格，只有字母）

例如：我的文字=“abcdabcd”

我想找到看起来像这样的数组（或向量？）：ab bc cd da

我如何以最简单的方式做到这一点？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T23:27:20.763

您可以使用该`unique()`功能来执行此操作。唯一的技巧是创建两个字符的列表，这可以通过使用两行来完成，移动一个字符。

```
str = "abcdabcd";
str(2,:) = shift (str, -1);
str(:,end) = [];  # remove last column
unique (str', "rows") 
```

# xna-4.0 - XNA游戏工作室简单精灵动画

> ID：15256257
> 
> 赞同：0
> 
> 时间：2013-03-06T19:28:00.063
> 
> 标签：xna-4.0

好的，所以我在写像泡泡一样的 2d 游戏，但我不想要某种非常复杂的动画。我想要这样的东西：我有 2 个玩家图像右面生物和左面生物图像的矩形大小完全相同，我也有：

`Vector2 playerPosition`宣布

`player = Content.Load<Texture2D>("PlayerRight");`在我的`LoadContent`

`spriteBatch.Draw(player, playerPosition, Color.White);`在我的绘图功能中

我想要的只是当我按下右/左箭头按钮时，我的播放器图像在右/左图像之间切换

我不知道什么样的代码以及我必须为该任务编写的位置。如果您需要有关该任务的更多信息，请告诉我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T07:53:12.153

this is not best solution, but it could give you hint.

```
playerRight = Content.Load<Texture2D>("PlayerRight");
playerLeft = Content.Load<Texture2D>("PlayerLeft");
playerCameraFacing = Content.Load<Texture2D>("playerCameraFacing"); 
```

declare PlayerSprite as Texture2D in player class

update funciton pseudo:

```
PlayerSprite = playerCameraFacing ;
if key.left then PlayerSprite = playerLeft;
if key.right then PlayerSprite = playerRight; 
```

draw function pseudo:

```
draw(PlayerSprite, Position, Color) 
```

i put all my animation frames into single image, and then show them using "sourceRectangle". [what is source rectangle in spritebatch.draw in xna](https://stackoverflow.com/questions/5189833/what-is-source-rectangle-in-spritebatch-draw-in-xna) [http://msdn.microsoft.com/en-us/library/ff433988.aspx](http://msdn.microsoft.com/en-us/library/ff433988.aspx)

# ruby-on-rails - 在两个表之间添加 JOIN

> ID：15256258
> 
> 赞同：0
> 
> 时间：2013-03-06T19:27:59.960
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, rails-activerecord

这是我的课程：

```
Model Organization
has_many Students

Model Student
has_many Classes
belongs_to Organization

Model Class
a field named : price
belongs_to Student
scope :top_expensive_classes, joins(:students).order('price DESC') 
```

**现在我想列出前 10 名昂贵的课程**

至少我遇到的第一个问题是，`params`我有`organization_id`基于它的过滤器但是我这样写我的控制器不起作用，因为它认为它应该在模型中找到组织 ID，`Class`但它在`Student`模型中。

```
@results = Class.top_expensive_classes.where(organization_id: params[:id]).limit(RESULT_SET_COUNT) 
```

所以我想知道是否有办法解决这个问题？我想我应该在某个地方引入一个新加入？但无法弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:30:06.887

您的范围内有一个错字：`joins:(:programs)`应该是`joins(:programs)`

要根据 Student 中的组织 ID 获取，您可以执行以下操作：

```
@results = Class.top_expensive_classes
  .joins(student: :organization)
  .where(organization: {id: params[:id]}) 
```

# jsf-2 - JSF 2.0。.png 的问题

> ID：15256260
> 
> 赞同：1
> 
> 时间：2013-03-06T19:28:04.333
> 
> 标签：jsf-2

我在尝试使用 jsf 2.0 渲染.png 图像时遇到问题，因为 JPG 可以正常工作

**h:graphicImage library="img" name="logo.png"** --> 不行，空指针如下图

**h:graphicImage library="img" name="logo.jpg** --> 没问题

* * *

**更新** 我从 Chrome 开发人员工具控制台资源中看到以下内容解释为 Image 但使用 MIME 类型 text/html 传输

不确定是否需要在 web.xml 中设置内容类型

* * *

**资源结构**

网页内容/资源/img/logo.png

* * *

```
ErrorPageWrit E   An exception occurred
                                 java.lang.NullPointerException
        at com.ibm.ws.webcontainer.srt.SRTServletResponse.setContentType(SRTServletResponse.java:1345)
        at org.apache.myfaces.application.ResourceHandlerImpl.handleResourceRequest(ResourceHandlerImpl.java:333)
        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:183)
        at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1657)
        at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:939)
        at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:502)
        at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:179)
        at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3935)
        at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:276)
        at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:931)
        at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1583)
        at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:186)
        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452)
        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511)
        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305)
        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:276)
        at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:214)
        at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:113)
        at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
        at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
        at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
        at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
        at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
        at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775)
        at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
        at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1604) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T22:03:06.097

解决。

似乎是 mime 映射的问题。由于某种原因，服务器无法识别 png。在 web.xml 中为 png 添加了 mime 映射

使用 MyFaces 实现，WAS7。

**相关帖子**： http: [//forum.primefaces.org/viewtopic.php?f=9](http://forum.primefaces.org/viewtopic.php?f=9&t=19880) &t=19880 。

# joomla - 从 Joomla 1.5.20 更新到最安全的版本

> ID：15256262
> 
> 赞同：1
> 
> 时间：2013-03-06T19:28:05.697
> 
> 标签：joomla, joomla1.5, updates

我正在为我的一个朋友更新一个 Joomla 页面——当前在线的版本（当它没有被黑客破坏时）是 1.5.20。据我所知，[没有可用的更新补丁](http://joomlacode.org/gf/project/joomla/frs/?action=index)来更新它。我知道我无法将它更新到 2.x 或 3.x 版本，但如果我至少可以将它升级到 1.5.x 版本的最新版本，那对安全性有好处.

那么，我应该选择什么补丁，在哪里可以找到呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:36:53.760

来自[Joomla 文档](http://docs.joomla.org/Upgrading_1.5_from_an_existing_1.5x_version)；

> *   如果您使用的是当前版本之前的版本，请使用从先前版本更新到当前版本的文件（例如，[Joomla_1.5.25_to_1.5.26-Stable-Patch_Package](http://joomlacode.org/gf/download/frsrelease/16891/73387/Joomla_1.5.25_to_1.5.26-Stable-Patch_Package.zip)）。
> *   如果您使用的是旧版本，请使用 1.5.0 到当前版本文件（例如，[Joomla_1.5.0_to_1.5.26-Stable-Patch_Package](http://joomlacode.org/gf/download/frsrelease/16891/73384/Joomla_1.5.0_to_1.5.26-Stable-Patch_Package.zip)）。

在您的情况下，由于您当前拥有 1.5.20 并且 1.5.26 是最新发布的 1.5.x 版本，因此后者将是正确的选择。

进一步的更新说明在上面链接的文档中，请先阅读它们，尤其是。在备份现有站点时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:51:55.040

没有补丁可以从任何 Joomla 1.5 版本升级到当前版本。

当前的长期版本 (LTR) 是 Joomla 2.5，最新的短期版本 (STR) 是 Joomla 3.0。

这两者都不能从任何 1.5 版本直接升级。

您最好的选择是使用以下工具进行迁移：

[http://extensions.joomla.org/extensions/migration-a-conversion/joomla-migration/15609](http://extensions.joomla.org/extensions/migration-a-conversion/joomla-migration/15609)

请注意，Joomla 1.5 现在不受支持，没有发布任何安全补丁来修复任何漏洞。您的 Joomla 1.5 安装将很快变得不安全。

正如 Joachim 所说，先备份，再恢复。

# javascript - 更改动态生成的下拉列表的选定值

> ID：15256265
> 
> 赞同：0
> 
> 时间：2013-03-06T19:28:17.107
> 
> 标签：javascript, dom

我在 JSP 页面中生成了一个动态下拉列表，如下所示：

```
<table BORDER=4 BORDERCOLOR=ORANGE width="300px">
    <tr>
        <td>Model:</td>
        <td><select name="model" id="model">
            <c:forEach items="${model_list}" var="item">
                <option value="${item.modelId}">${item.modelName}</option>
            </c:forEach>
        </select></td>
    </tr>
</table> 
```

我只想根据从这里获得的另一个值更改这些下拉列表的选定值：

```
<table BORDER=4 BORDERCOLOR=ORANGE width="120px" id="product_table">
<c:forEach items="${product_list}" var="car">
    <tr>
        <td><INPUT type="checkbox" name="chk_group" value="${car.carId}" /></td>
        <td><c:out value="${car.carId}" /></td>
        <td><c:out value="${car.model.modelName}" /></td>
        <td><c:out value="${car.model.modelId}" /></td>

</table> 
```

这是脚本：

```
function findRowNumber() {
    var rowIdx;
    var rowData = new Array();
    var table = document.getElementById('product_table');
    var rows = table.getElementsByTagName('tr');
    var selectedRow;
    for ( var i = 0; i < rows.length; i++) {
        rows[i].onclick = function() {
            rowIdx = this.rowIndex;
            selectedRow = rows[rowIdx];
            document.getElementById('model').value = selectedRow.cells[3].innerHTML;

        }
    }
} 
```

注意：`selectedRow.cells[3].innerHTML`返回 3 但值不变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:31:26.153

我在您的 HTML 中没有看到任何 id 为`model`. 您的意思是*名称*为的输入`model`也具有该 ID 吗？

我还注意到你的第二张桌子没有结尾`</tr>`。

不要使用`var rowData = new Array();`使用文字表示法：`var rowData = [];`.

添加 id 后，添加几个`<tr>`s，它对我来说很好：

[http://jsfiddle.net/FJfZK/](http://jsfiddle.net/FJfZK/)

请注意，您呈现的 HTML 输出在调试 JavaScript 问题时会更有帮助**。**当它是一个 DOM 操作问题时，我们通常不关心您的服务器在做什么。

# asp.net-mvc - 我的 asp.net MVC 部分视图在初始 ajax 调用后没有响应？

> ID：15256269
> 
> 赞同：1
> 
> 时间：2013-03-06T19:28:25.950
> 
> 标签：asp.net-mvc, jquery, partial-views

我正在开发一个 asp.net mvc 4 应用程序，并且我正在使用 PartialView 作为索引视图中的一个表。在我进行初始 ajax 调用后，请求成功并且 UI 会相应更新。但是当我再次尝试更新时，JavaScript 对点击事件没有响应。

这是典型的吗？

AJAX 调用：

```
 $("#button").click(function(){
           $.ajax({
                url: 'url',
                type: "POST",
                data: $("#form0").serialize()
            }).done(function (allData) {

                $("#mypartialId").html(allData);
                ResizeContent();

            }).fail(function (jqXHR, textStatus) {
                alert("Request failed: " + textStatus);
            });
            }); 
```

像这样的东西在我的控制器索引操作中：

```
 if(Request.IsAjaxRequest())
        {
            return PartialView("_PartialView", model);
        }

       return View(model); 
```

Razor Ajax.BeginForm，默认 id 为 form0：

```
 @using (Ajax.BeginForm("Index", "MyController",
                       new AjaxOptions
                           {
                               HttpMethod = "POST",
                               UpdateTargetId = "mypartialId"
                           })) 
```

我在索引中的部分渲染：

```
 <div id="mypartialId">
        @{Html.RenderPartial("_PartialView", Model);}
    </div> 
```

这工作一次，但是当我单击按钮开关在 partialView 中时，JavaScript 变得无响应。我猜它的索引视图没有用 partialView 重新加载……有什么办法解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:46:56.013

我使用了 .on() 函数，而不仅仅是 @Sergey Akopov 建议的 .click() 函数。在那之后我又遇到了另一个问题，因为返回的数据是一个表格，所以 IE9 给了我 UI 问题。

修复方法是从表格标签中删除空格，然后将其注入 DOM

```
 var expr = new RegExp('>[ \t\r\n\v\f]*<', 'g');
                table = table.replace(expr, '><');

                $("#mypartialId").html(table); 
```

这是指向在 IE9 中显示奇怪的“td”问题的[链接。](https://stackoverflow.com/questions/7267014/ie9-table-has-random-rows-which-are-offset-at-random-columns)

# java - JTable 模型列

> ID：15256271
> 
> 赞同：0
> 
> 时间：2013-03-06T19:28:30.923
> 
> 标签：java, swing, model, jtable, dynamic-columns

我有一个 JTable 和该表的模型。

现在我想更改列的顺序并隐藏或显示一些列（例如，通过右键单击菜单在“详细视图”中的 Windows 资源管理器）。

我的第一个问题是 getColumnName 函数。我是否必须跟踪哪个列在哪个位置，然后返回正确的 columnName 或者这已经是模型的一部分？getValueAt 函数也是如此。如果我得到 columnIndex = 0，我是否可以始终返回第一列的值，即使用户已将此列拖到表的末尾？

添加/删除列的问题几乎相同。如果我这样做，当然我必须触发TableStructureChanged，但我是否还必须适应例如getColumnName 函数？

我还没有找到这方面的教程。所有教程都停留在“您可以使用模型”。我真的很想看到这样一个动态模型的例子。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:34:16.457

您应该使用模型的 getColumn(int) 方法，并且为了访问模型，您需要使用[JTable](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html)的[convertRowIndexToModel(int)](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html#convertRowIndexToModel%28int%29)、[convertColumnIndexToModel(int)](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html#convertColumnIndexToModel%28int%29)和用于转换的等价物来转换行和列视图索引模型索引以查看索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T04:55:14.633

您需要了解“视图”和“模型”之间的区别。当您对 JTable（视图）中的列重新排序时，这不会更改模型中数据的顺序。

如果要访问您使用的表中显示的第一列：

```
table.getValueAt(row, 0); 
```

如果要访问模型中的第一列，则使用：

```
table.getModel().getValueAt(row, 0); 
```

> 我想隐藏或显示一些列

请参阅[表列管理器](http://tips4java.wordpress.com/2011/05/08/table-column-manager/)。

# vb.net - 在 SSRS 中，如何仅在前一个参数选择了一个选项时才使下拉参数可见？

> ID：15256278
> 
> 赞同：0
> 
> 时间：2013-03-06T19:28:48.520
> 
> 标签：vb.net, reporting-services, ssrs-2008

我有一种情况，我想让下拉参数只有在以前的多下拉参数时才可见。有一个选择（在许多选择中）。

![在此处输入图像描述](../Images/a187373013b9287c48cf897bb7b99f48.png)

到目前为止我尝试过的是设置默认值。下拉参数是这样的：

```
=iif( Parameters!AccountIDs.Count >0 , 1, Nothing) 
```

但它不起作用。任何提示表示赞赏，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T14:39:25.810

您将无法像这样禁用或启用参数。（至少在没有变得非常复杂并破解页面的情况下并非如此）

但是您可以使第二个参数具有动态可用选项。然后将其设置为单个选项，例如`"<Not applicable>"`，如果较早的参数具有多个值，则选择该选项。

您将需要创建一个返回可用参数的数据集。像这样的东西可能会起作用：

```
SELECT
    '<Not Applicable>' AS ParameterValue
WHERE
    @ParamOneCount > 1
UNION ALL
SELECT
    SourceName
FROM
    someTable
WHERE
    @ParamOneCount = 1 
```

（您可以将第二个替换为`SELECT`多个选择以具有多个硬编码值。）然后在此数据集的参数中，将参数之一设置为“ParamOneCount”并将其值设置为`=Parameters!Account.Count`

# unit-testing - 自定义数据注释未在单元测试中触发

> ID：15256283
> 
> 赞同：1
> 
> 时间：2013-03-06T19:28:50.833
> 
> 标签：unit-testing, validation, data-annotations

我目前正在试验验证属性，现在我正在尝试验证我的 ViewModel，它包含一个带有自定义验证属性的 EmailAddress。

```
public class UserLoginModel
{
    [Required]
    [EmailAddress]
    public string email { get; set; }

    [Required]
    public string password { get; set; }

    public bool rememberMe { get; set; }
} 
```

我做了一个单元测试，我提供了一个虚假的电子邮件地址并尝试验证我的视图模型。

```
[TestMethod]
public void TestingInvalidEmailAddress()
{
    UserLoginModel model = new UserLoginModel();
    model = GetAValidLoginModel(); //Get a default-model where all parameters are correct
    model.email = "thisisnotavalidemail.com";

    ValidationContext context = new ValidationContext(model, null, null);
    var results = new List<ValidationResult>();
    bool validModel= Validator.TryValidateObject(model, context, results);
    //This is always true

    Assert.IsFalse(validModel);
} 
```

此测试的结果始终为 False。

所以我检查了我的属性，因为我认为我可能犯了一个错误：

```
[TestMethod]
public void Email()
{
    string email;
    var attr = new EmailAddressAttribute();

    email = "myemail@domain.com";            
    Assert.IsTrue(attr.IsValid(email));

    email = "thisisnotavalidemail.com";
    Assert.IsFalse(attr.IsValid(email)); //If this fails, the test is successfull
} 
```

这确实通过了测试，使用完全相同的电子邮件地址。

当我在浏览器中测试它时，它也会正确验证。

那么为什么它没有告诉我我的电子邮件地址在第一个测试方法中无效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T09:13:25.707

我在[这里](https://stackoverflow.com/questions/10165143)找到了我的解决方案。显然我只是缺少一个额外的参数。

```
bool validModel= Validator.TryValidateObject(model, context, results, **true**); 
```

# java - 字符串拆分，包括重音字符的单词

> ID：15256288
> 
> 赞同：15
> 
> 时间：2013-03-06T19:29:07.853
> 
> 标签：java, regex

我正在使用这个正则表达式：

```
x.split("[^a-zA-Z0-9']+"); 
```

这将返回一个包含字母和/或数字的字符串数组。

如果我使用这个：

```
String name = "CEN01_Automated_TestCase.java";
String[] names = name.Split.split("[^a-zA-Z0-9']+"); 
```

我有：

```
CEN01
Automated
TestCase
Java 
```

但如果我使用这个：

```
String name = "CEN01_Automação_Caso_Teste.java";
String[] names = name.Split.split("[^a-zA-Z0-9']+"); 
```

我有：

```
CEN01
Automa
o
Caso
Teste
Java 
```

如何修改此正则表达式以包含重音字符？（á，ã，õ等...）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-06T19:37:01.930

来自[http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)

> 行为类似于方法的类别（不推荐使用的类别除外）可通过指定属性具有名称的相同语法获得。`java.lang.Character boolean is***methodname***``\p{prop}``javamethodname`

由于`Character`类包含`isAlphabetic`您可以使用的方法

```
name.split("[^\\p{IsAlphabetic}0-9']+"); 
```

你也可以使用

```
name.split("(?U)[^\\p{Alpha}0-9']+"); 
```

但是您需要使用`UNICODE_CHARACTER_CLASS`可以通过添加`(?U)`正则表达式来使用的标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T19:31:39.627

我会查看[关于正则表达式的 Java 文档](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html)。我相信有一个 unicode 部分是您可能正在寻找的。

编辑：示例

另一种方法是匹配您要查找的字符代码。例如

```
\uFFFF where FFFF is the hexadecimal number of the character you are trying to match. 
```

例子： `\u00E0 matches à`

意识到如果您将反斜杠用作字符串文字，则需要在 Java 中对其进行转义。

[在此处](http://www.regular-expressions.info/unicode.html)阅读更多相关信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-06T19:41:41.080

你可以使用这个：

```
String[] names = name.split("[^a-zA-Z0-9'\\p{L}]+"); 
```

`System.out.println(Arrays.toString(names));`将输出：

**[CEN01, Automação, Caso, Teste, java]**

有关更多信息，请参阅[此](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#ubc)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-06T19:36:09.233

为什么不拆分分隔符？

```
String[] names = name.split("[_.]"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-06T19:40:17.543

您可以随时将您想要的字符列入白名单，而不是将所有您不想要的字符列入黑名单：

```
^[^<>%$]*$ 
```

表达式 [^(many characters here)] 只匹配未列出的任何字符。

但这是个人意见。

# node.js - 读取 CSV 文件的最后一行并提取一个值

> ID：15256290
> 
> 赞同：5
> 
> 时间：2013-03-06T19:29:14.980
> 
> 标签：node.js, csv

Node.js 新手，尝试从 CSV 文件的最后一行提取值。这是 CSV：

```
Unit ID,Date,Time,Audio File
Log File Created,3/6/2013,11:18:25 AM,file:\\\C:\Users\Ben\Documents\1_03-06-2013_1114-50.mp3
1,3/6/2013,11:20:24 AM,file:\\\C:\AlertLog\1_03-06-2013_1120-24.mp3
1,3/6/2013,11:20:39 AM,file:\\\C:\AlertLog\1_03-06-2013_1120-24.mp3 
```

我试图抓住的部分是`file:\\\C:\AlertLog\1_03-06-2013_1120-24.mp3`- 最好摆脱这`file:\\\`部分。

抱歉，我没有任何代码要显示，只有几个小时的 Node.js 经验，似乎找不到任何关于如何完成这样的事情的文档。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-06T19:48:30.797

## 常规文件

像普通文件一样读取文件，将文件内容分成几行，取最后一行，用逗号分隔并取最后一部分。

```
var fs = require('fs'); // file system module

fs.readFile('/path/to/file.csv', 'utf-8', function(err, data) {
    if (err) throw err;

    var lines = data.trim().split('\n');
    var lastLine = lines.slice(-1)[0];

    var fields = lastLine.split(',');
    var audioFile = fields.slice(-1)[0].replace('file:\\\\', '');

    console.log(audioFile);
}); 
```

[文件系统模块文档](http://nodejs.org/api/fs.html#fs_fs_readfile_filename_encoding_callback)

## CSV 解析器

您还可以使用[node-csv-parser](https://github.com/wdavidw/node-csv-parser)模块。

```
var fs = require('fs');
var csv = require('csv');

csv()
 .from.stream(fs.createReadStream('/path/to/file.csv'))
 .to.array(function(data, count) {
    var lastLine = data.slice(-1)[0];
    var audioFile = lastLine.slice(-1)[0].replace('file:\\\\', '');
    console.log(audioFile);
  }); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-17T20:42:22.747

我通过向后读取文件来做到这一点，直到最后一行被读取：

```
var fs = require('fs');
var path = require('path');
var fileName = path.join(__dirname, 'test.txt');
var readLastLine = function(name, callback) {
    fs.stat(name, function(err, stat) {
        fs.open(name, 'r', function(err, fd) {
            if(err) throw err;
            var i = 0;
            var line = '';
            var readPrevious = function(buf) {
                fs.read(fd, buf, 0, buf.length, stat.size-buf.length-i, function(err, bytesRead, buffer) {
                    if(err) throw err;
                    line = String.fromCharCode(buffer[0]) + line;
                    if (buffer[0] === 0x0a) { //0x0a == '\n'
                        callback(line);
                    } else {
                        i++;
                        readPrevious(new Buffer(1));
                    }
                });
            }
            readPrevious(new Buffer(1));
        });
    });
}
readLastLine(fileName, function(line) {
    console.log(line);
}); 
```

# java - Netbeans 部署了哪个 WAR？

> ID：15256292
> 
> 赞同：1
> 
> 时间：2013-03-06T19:29:17.337
> 
> 标签：java, maven, tomcat, netbeans

**解释：**

我目前在 Netbeans 中有一个 Java Web 项目，并且正在使用 Maven。最近我`pom`在项目中更改了，以便在构建时生成 2 个 war 文件：一个用于开发（我希望 Netbeans 在选择“运行项目”时部署它），另一个用于生产。

为了在以前的部署中保持一定的标准，我将生产 WAR 保留为相同的（默认）名称，`ReportsPortal.war`并在开发版本中`-dev`附加了 a。

**参考：**

这是`pom`我更改的文件部分：

```
<plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.1.1</version>       
                <executions>
                    <execution>
                        <id>package-prod</id>
                        <phase>package</phase>
                        <configuration>                                       
                            <webResources>                        
                                <resource>                        
                                    <directory>src/main/env/prod</directory>                        
                                </resource>                          
                            </webResources>                    
                        </configuration>
                        <goals>                            
                            <goal>war</goal>                                  
                        </goals>
                    </execution>
                    <execution>
                        <id>package-dev</id>
                        <phase>package</phase>
                        <configuration>
                            <classifier>dev</classifier>                            
                            <webResources>                        
                                <resource>
                                    <directory>src/main/env/dev</directory>                        
                                </resource>                          
                            </webResources>
                        </configuration>
                        <goals>                            
                            <goal>war</goal>                                  
                        </goals>
                    </execution>
                </executions>                    
            </plugin> 
```

它生成两个文件 (`ReportsPortal.war`和`ReportsPortal-dev.war`)。每个都有其环境变量（并且它们之间不同）。

当右键单击 ReportsPortal 项目并选择**Run**时，Netbeans 启动 Tomcat 并且部署的应用程序具有正确的值，所以我猜它正在使用`ReportsPortal-dev.war`，但我不能确定。

**我的问题：**

*我如何知道或更改 Netbeans 用于在 Tomcat 中部署的 war 文件？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:51:33.100

您应该为每个 war 文件创建一个单独的 maven 构建配置文件。然后，您可以在进行开发工作时调用开发配置文件，而仅在您想要发布时才调用生产配置文件。这将允许您准确控制正在构建的内容。

# c# - 从网络摄像头输入以编程方式更新 WPF 图像控件

> ID：15256302
> 
> 赞同：3
> 
> 时间：2013-03-06T19:30:21.300
> 
> 标签：c#, wpf, webcam

我正在从网络摄像头捕获图像帧，但是当我将它们设置为 WPF 的图像控件时，它显示为空白。

我正在使用的库返回一个 Bitmap，因此我将其转换为 BitmapImage，然后通过 Dispatcher 将 Image 控件的源设置为 BitmapImage：

```
void OnImageCaptured(Touchless.Vision.Contracts.IFrameSource frameSource, Touchless.Vision.Contracts.Frame frame, double fps)
    {
        image = frame.Image; // This is a class variable of type System.Drawing.Bitmap 
        Dispatcher.Invoke(new Action(UpdatePicture));
    }

    private void UpdatePicture()
    {
        imageControl.Source = null;
        imageControl.Source = BitmapToBitmapImage(image);
    }

    private BitmapImage BitmapToBitmapImage(Bitmap bitmap)
    {
        using (MemoryStream ms = new MemoryStream())
        {
            bitmap.Save(ms, ImageFormat.Png);
            ms.Position = 0;
            BitmapImage bi = new BitmapImage();
            bi.BeginInit();
            bi.StreamSource = ms;
            bi.EndInit();
            return bi;
        }
    } 
```

我的 Image 控件上的 XAML 声明尽可能通用：

```
<Image x:Name="imageControl" HorizontalAlignment="Left" Height="100" Margin="94,50,0,0" VerticalAlignment="Top" Width="100"/> 
```

Image 控件中没有显示任何内容 - 没有运行时错误。我究竟做错了什么？
非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:35:53.103

您需要`bi.CacheOption = BitmapCacheOption.OnLoad`在创建 BitmapImage 时进行设置。没有它，位图会被延迟加载，并且当 UI 开始请求它时，流将被关闭。[Microsoft 在BitmapImage.CacheOption](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.cacheoption.aspx)的文档中对此进行了说明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T20:10:33.483

除了将图像写入临时 MemoryStream 之外，您还可以通过调用直接从`Bitmap`to转换：`BitmapSource`[`Imaging.CreateBitmapSourceFromHBitmap`](http://msdn.microsoft.com/en-us/library/system.windows.interop.imaging.createbitmapsourcefromhbitmap.aspx)

```
private void UpdatePicture()
{
    imageControl.Source = Imaging.CreateBitmapSourceFromHBitmap(
        image.GetHbitmap(), IntPtr.Zero, Int32Rect.Empty,
        BitmapSizeOptions.FromEmptyOptions());
} 
```

# animation - 如何在 HighCharts 散点图中动画一个点从一个位置到另一个位置的移动

> ID：15256307
> 
> 赞同：1
> 
> 时间：2013-03-06T19:30:33.173
> 
> 标签：animation, highcharts, scatter-plot

在 HighCharts 散点图中，我想使用平滑动画将一个点从其位置移动到另一个位置。例如，在以下代码（[jfiddle](http://jsfiddle.net/kd8A9/)链接）中定义的散点图中：

```
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container'
            },
            xAxis: {
                min: -0.5,
                max: 5.5
            },
            yAxis: {
                min: 0
            },
            title: {
                text: 'Scatter plot with regression line'
            },
            series: [{
                type: 'scatter',
                name: 'Observations',
                data: [[1, 1.5], [2.8, 3.5], [3.9, 4.2]],
                marker: {
                    radius: 4
                }
            }]
        });
    });

}); 
```

我想将第一个点从 (1,1.5) 移动到 (2,2)。可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:58:04.567

是的，使用`point.update`.
这接受点选项作为参数，因此您可以传递`x`和`y`值。

看看下面的代码：

```
chart.series[0].points[0].update({x: 2, y: 2}); 
```

将对象作为动画选项的第三个参数传递，您可以在参考部分看到选项。

```
chart.series[0].points[0].update({x: 2, y: 2}, true, {duration: 500, easing: 'linear'}); 
```

*参考*：

*   [http://api.highcharts.com/highstock#Point.update()](http://api.highcharts.com/highstock#Point.update())
*   [动画类型](http://api.highcharts.com/highstock#chart.animation)

[**演示**](http://jsfiddle.net/ricardolohmann/SM33n/)

# java - 数组中的java继承

> ID：15256308
> 
> 赞同：-5
> 
> 时间：2013-03-06T19:30:35.203
> 
> 标签：java, arrays, inheritance, casting

假设我有一个带有 toString() 的父类，它返回“父”。然后，我在子类中重写此方法，使其返回“child”。如果我将孩子放在父母的数组中，然后调用 toString() 而不进行任何转换，将调用哪个方法？

请尽快回复，提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:31:38.290

它将调用`toString`子类的方法。

# java - 我将如何让一组团队一次又一次地互相比赛？

> ID：15256315
> 
> 赞同：3
> 
> 时间：2013-03-06T19:30:48.393
> 
> 标签：java, for-loop, iteration

我不知道如何让他们互相玩一次，而且只有一次。例如，这里是一个团队示例（我稍后会添加评分，主要是寻找逻辑帮助）：

```
class MyTeams {
    String teamName;
    int wins;
    int losses;
}

public class BasketallSeason {

    public static void main(String[] args) {

        MyTeams aoTeams[] = new MyTeams[9];

        aoTeams[0].teamName = "Utah";
        aoTeams[1].teamName = "USC";
        aoTeams[2].teamName = "Saint Mary's";
        aoTeams[3].teamName = "Oregon";
        aoTeams[4].teamName = "San Diego";
        aoTeams[5].teamName = "San Francisco";
        aoTeams[6].teamName = "UCLA";
        aoTeams[7].teamName = "Washington";
        aoTeams[8].teamName = "Loyola";
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:34:35.877

这是给你的基本算法

*   拿阵第一队
*   让该团队与阵列中的所有其他团队比赛
*   从阵列中删除该团队，或以其他方式将该团队标记为已经玩过所有人，以便您忽略它。
*   重复

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T14:30:44.867

我实际上花了一些时间并编写了答案。这是一个非常有趣的问题。有**很多**方法可以解决这个问题：

1.  花式迭代
2.  递归
3.  退出团队时进行迭代
4.  使用单独的结构将团队“标记”为已处理

这张图片可能会有所帮助：

```
 0 1 2 3
0 - A A A
1 B - A A
2 B B - A
3 B B B - 
```

该矩阵的 X 和 Y 轴显示您想要的答案。Set A 或 Set B 都会给你答案。请注意，您不希望团队像矩阵中的破折号所示那样自行比赛。以下是使用迭代的 3 个选项：

```
public class BBall {

public static void main(String args[]) {

    List<String> teams = new ArrayList<String>();
    teams.add("Boston");
    teams.add("LA");
    teams.add("New York");
    teams.add("Chicago");
    teams.add("Dallas");

    // This option might be a little easier to read.
    int index1 = 0;
    System.out.println("Easy to read:");
    for (String team1 : teams) {
        index1++;
        for (int index2 = index1; index2 < teams.size(); ++index2) {
            System.out.println(team1 + " plays " + teams.get(index2));
        }
    }
    System.out.println("This is set A:");
    for (int x = 1; x < teams.size(); x++) {
        for (int y = x - 1; y >= 0; y--) {
            System.out.println(teams.get(x) + " plays " + teams.get(y));
        }
    }
    System.out.println("This is set B:");
    for (int x = 0; x < teams.size() - 1; x++) {
        for (int y = x + 1; y < teams.size(); y++) {
            System.out.println(teams.get(x) + " plays " + teams.get(y));
        }
    }
}
} 
```

输出：

易于阅读：

```
 Boston plays LA
    Boston plays New York
    Boston plays Chicago
    Boston plays Dallas
    LA plays New York
    LA plays Chicago
    LA plays Dallas
    New York plays Chicago
    New York plays Dallas
    Chicago plays Dallas 
```

这是设置A：

```
 LA plays Boston
    New York plays LA
    New York plays Boston
    Chicago plays New York
    Chicago plays LA
    Chicago plays Boston
    Dallas plays Chicago
    Dallas plays New York
    Dallas plays LA
    Dallas plays Boston 
```

这是B组：

```
 Boston plays LA
    Boston plays New York
    Boston plays Chicago
    Boston plays Dallas
    LA plays New York
    LA plays Chicago
    LA plays Dallas
    New York plays Chicago
    New York plays Dallas
    Chicago plays Dallas 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:37:04.100

定义两个嵌套`for`循环，每个循环遍历您的团队。通常情况下，这将让每支球队与其他球队比赛两次，每支球队将自己比赛一次。

您不希望这样，因此将内`for`循环的循环变量初始化为外循环的循环变量的当前值加一`for`。这确保了团队的每个组合都只迭代一次，并且团队不会自己玩。

然后调用内部`for`循环中的任何游戏逻辑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-06T19:49:13.150

像这样循环：

```
for(int i = 0; i < aoTeams.length - 1; i++) {
     for(int j = i+1; j < aoTeams.length; j++) {
         aoTeams[i].playAgainst(aoTeams[j]);
     }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-06T20:12:53.447

应该是对的：

```
for (int i = aoTeams.length-1; i >= 0; i--)
    for (int j = i-1; j >= 0; j--)
        System.out.println(aoTeams[j].teamName + " : "+ aoTeams[i].teamName); 
```

不要忘记在 java 中的类中使用第一个大写字母，并始终以驼峰形式编写字段，以小写字母开头；-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-06T19:40:19.700

在您的类中维护一个[**`java.util.BitSet`**](http://docs.oracle.com/javase/7/docs/api/java/util/BitSet.html)引用，`myTeams`并使用与团队数量相等的数字对其进行实例化。默认情况下，所有值在开始时*都未设置*(false)。

当一支球队试图与另一支球队进行比赛时，`aoTeams`检查`BitSet`对手数组索引中的值。如果未设置，则让它播放并在该索引处*设置值。*对其他团队也这样做。

示例实现可能如下所示：

```
class Team {

    String teamName;
    int wins;
    int losses;
    BitSet playRecord;

    public Team(String name, int size) {
        this.teamName = name;
        playRecord = new BitSet(size);
    }

    public boolean hasPlayed(int index) {
        return playRecord.get(index);
    }

    public void finishedPlaying(int index) {
        playRecord.set(index);
    }

} 
```

这就是你使用它的方式：

```
public static void main(String[] args) {
    int size = 9;
    Team aoTeams[] = new Team[size];
    aoTeams[0] = new Team("Utah", size);
    aoTeams[1] = new Team("USC", size);
    play(aoTeams, 0, 1);
}

private static void play(Team[] teams, int indexA, int indexB) {
    if (teams[indexA].hasPlayed(indexB)) {
        // Teams have already played together
    } else {
        // Teams playing for the first time
        teams[indexA].finishedPlaying(indexB);
        teams[indexB].finishedPlaying(indexA);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-06T19:44:17.840

在 myTeams 类中创建一个布尔数组（比如 alreadyPlayed），在构造函数中将它们初始化为全部 false，当 team1 与 team2 一起玩时，设置 alreadyPassed[2] = true（在 team1 的对象中）并在 team2 的对象中设置 alreadyPassed[1] = true .

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-06T21:16:43.553

一个简单的嵌套循环。遍历两个列表并发出对，在第一个循环索引的 1+ 处开始第二个循环。

# facebook-graph-api - 我应该使用 Facebook FQL 吗？

> ID：15256323
> 
> 赞同：2
> 
> 时间：2013-03-06T19:31:03.313
> 
> 标签：facebook-graph-api

我正在使用 Koala gem 与 Facebook Graph API 进行交互。[作者在其 Github](https://github.com/arsduo/koala)中提到 Koala 还支持 Facebook REST API，该 API 将在未来被弃用，并举个例子：

```
@rest = Koala::Facebook::API.new(oauth_access_token)    
@rest.fql_query(my_fql_query) # convenience method
@rest.fql_multiquery(fql_query_hash) # convenience method
@rest.rest_call("stream.publish", arguments_hash) # generic version 
```

我对此的看法是，它`FQL`是 REST api 的一部分，如果我不需要，我不应该使用它。我无法通过谷歌搜索来确认这一点。

FQL 真的是 REST api 的一部分吗？如果是这样，我应该尽可能避免吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-07-08T06:18:33.363

你最好不要使用 fql。

请参阅此[https://developers.facebook.com/docs/reference/fql/](https://developers.facebook.com/docs/reference/fql/)

> Facebook 平台 API 2.0 版是 FQL 可用的最后一个版本。2.0 之后的版本将不支持 FQL。请迁移您的应用程序以使用 Graph API 而不是 FQL。请查看我们的变更日志以获取当前版本信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-06T19:34:04.380

[根据文档](https://developers.facebook.com/docs/reference/fql/)，FQL 几乎完全被弃用，**您不应该将它用于新项目**（并且还应该尽快将现有项目从它迁移出去）。我的旧答案在下面供后代使用。

* * *

您还可以针对 Graph API 发出 FQL 查询请求，如下所示：

```
http://graph.facebook.com/fql?
    q=SELECT%20uid,%20name%20FROM%20user%20WHERE%20uid%20=%2015504121 
```

产量：

```
{
    "data": [
        {
            "uid": 15504121,
            "name": "Jimmy Sawczuk"
        }
    ]
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-08-11T06:31:20.713

FQL 已从 2.1 版中弃用。

# android - AndroidViewClient 中的 findViewByIdOrRaise 出现问题

> ID：15256324
> 
> 赞同：0
> 
> 时间：2013-03-06T19:31:03.207
> 
> 标签：android, monkeyrunner, androidviewclient

尝试使用 MonkeyRunner 执行一些测试并希望使用 AndroidViewClient 来处理 EditText 小部件。

我相信我正确使用了 AndroidViewClient （下面的相关内容），`findViewByIdOrRaise()`总是抛出错误。我已经尝试了所有想到的指定 ID 的变体。

这是我活动的 XML 中的一个片段：

```
<EditText
    android:id="@+id/someText"
    ... >
    <requestFocus />
</EditText>
<!-- Yes, that is the actual id of my EditText --> 
```

在我的 MonkeyRunner 脚本中，我有以下内容：

```
device, serialno = ViewClient.connectToDeviceOrExity(serialNo=myDeviceId)
vc = ViewClient(device=device, serialno=serialno)
device.installPackage(apkPath)
device.startActivity(component='com.app.name/com.app.name.ActivityName')
editTextId = 'id/someText'
try:
    someText = vc.findViewByIdOrRaise(editTextId)
    someText.touch()
    someText.type('Derp derp derp')
except ViewNotFoundException, e:
    # The comma above is because Jython 2.5.3 does not support the AS keyword
    print ' [*] %s' % (e) 
```

当然，我的代码比显示的要多一点（但不多）。我去掉了所有看起来不相关的东西。我很乐意把它全部放在那里，但不想一开始就在这里吐出所有代码。

我已经查看了有关该主题的所有内容：

*   [AndroidViewClient/AndroidViewClient/examples/email-send.py](https://github.com/dtmilano/AndroidViewClient/blob/master/AndroidViewClient/examples/email-send.py)
*   [monkeyrunner：与视图交互](http://dtmilano.blogspot.ca/2012/02/monkeyrunner-interacting-with-views.html)
*   [如何使用monkeyrunner在文本字段中输入文本](https://stackoverflow.com/questions/12931728/how-to-enter-text-in-text-field-using-monkeyrunner)
*   [如何使用 monkeyrunner 向文本字段输入值](https://stackoverflow.com/questions/12741355/how-to-enter-values-to-a-text-field-using-monkeyrunner)

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T07:45:25.557

最新版本的 ViewClient 为应用程序中的每个视图提供了唯一的 ID。id 格式为 i/no_id/number。您可以使用名为 dump.py 的脚本来查看当前视图。它位于 ViewClient 的示例文件夹中。

# ruby-on-rails - DotCloud (EC2) 生产与 Macbook air 开发相比 ActiveRecord Postgres 慢 8-10 倍

> ID：15256325
> 
> 赞同：0
> 
> 时间：2013-03-06T19:31:08.537
> 
> 标签：ruby-on-rails, performance, postgresql, amazon-ec2, dotcloud

我在本地和 DotCloud 上设置了 Rails 3.2.12 应用程序。我看到 Dotcloud 上的 ActiveRecord (postgres) 性能非常缓慢，无法弄清楚原因：

**页面加载 Macbook Air（开发模式下的 Rails 应用）：**

```
Completed 200 OK in 617ms (Views: 361.3ms | ActiveRecord: 39.1ms) 
```

**页面加载DotCloud（生产模式下的rails应用程序，相同的数据库和页面）：**

```
Completed 200 OK in 796ms (Views: 315.3ms | ActiveRecord: 329.4ms) 
```

这不是一个不稳定的时间，而是所有页面加载的标准性能增量。我的数据库只有 16MB，所以不大。postgres 服务上的内存分配是足够的（128MB），只使用了 30MB。我检查了我的本地 postgres.conf 设置是默认的，未调整的 postgresql.app 设置。

这种糟糕的性能只是云中的预期吗？是网络服务器和数据库服务器之间的网络延迟吗？

非常感谢有关如何调试和修复此问题的想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:59:46.250

作为一名[dotCloud](http://www.dotcloud.com/)员工，我必须告诉您，如果您想彻底查看您的应用程序以了解它为什么没有达到您的预期，您必须[提交支持票](http://support.dotcloud.com)。我还应该告诉您，如果您处于沙盒模式，与处于其中一个付费层（例如 Live 或 Enterprise）相比，您可能会期望性能较低。

然而，作为一名开发人员，我可以快速指出本地开发环境和[dotCloud](http://www.dotcloud.com/)环境之间的两个主要区别。

1.  您的开发环境在同一主机上运行您的 DBMS (PostgreSQL) 和 Rails 应用程序，从而消除了由往返数据库引起的任何明显延迟。使用 dotCloud，它们可能位于不同的主机上，甚至可能位于不同的数据中心中。

2.  您的开发环境可能使用固态驱动器 (SSD)（取决于您的 MacBook Air 的使用年限），而您刚刚迁移到 EBS（Amazon Elastic Block Store），这是一种网络附加存储（在硬盘驱动器上）。

在这两个变化之间，我对响应时间的增加并不完全感到震惊，但我的好奇心被你的 ActiveRecord 时间增加了 290 毫秒而你的整体响应时间只增加了 180 毫秒所激起。

我不想推测您的响应时间在哪里消耗，所以我再次建议您尽快[在 support.dotcloud.com 提交支持票，以便我们仔细查看。](http://support.dotcloud.com)如果你这样做了，请提及我的名字或这个 StackOverflow 线程，并包含你的应用程序的 URL。

# ruby-on-rails-3 - 对我的路线如何相互作用感到困惑

> ID：15256337
> 
> 赞同：0
> 
> 时间：2013-03-06T19:31:46.073
> 
> 标签：ruby-on-rails-3, rails-routing

好的，我会尽量具体一点。这是我的代码：

**路线.rb**

```
root to: "users#index"
match "/users/:id/about", to: "users#about", as: :about
match "/users/:id/blog", to: "users#blog", as: :blog
match "users/:id/contact", to: "users#contact", as: :user_contact
match "/contact", to: "static_pages#contact", as: :static_contact

resources :sessions, only: [:new, :create, :destroy]
resources :users do
  resources :portfolios do
    resources :pictures
  end
end 
```

这是我的导航栏，其中包含我主页上的所有链接：

```
 <nav>
    <ul class="sf-menu" id="nav">
      <li class="<%= "selected" if current_page?(root_path) %>"><%= link_to "home", root_path %></li>
      <li class="<%= "selected" if current_page?(about_path) %>"><%= link_to "about me", about_path %></li>
      <li><%= link_to "my portfolio" %>
        <ul>
          <% @user.portfolios.each do |portfolio| %>
            <li><%= link_to portfolio.name, user_portfolio_path(@user, portfolio) %></li>
          <% end %>
        </ul>
      </li>
      <li class="<%= "selected" if current_page?(blog_path) %>"><%= link_to "blog", blog_path %></li>
      <li class="<%= "selected" if current_page?(user_contact_path) %>"><%= link_to "contact", user_contact_path %></li>
    </ul>
  </nav> 
```

当我从任何链接（家庭、关于我、博客、联系人）链接到任何其他链接时，一切正常。例如，当我在关于我的页面 (/users/8/about) 上时，我可以链接到联系页面 (users/8/contact)。问题是当我登陆投资组合页面 (/users/8/portfolios/31) 并尝试链接到 about me 页面时，例如，url 变为：/users/31/about 而不是返回到 /users /8/关于。用户 31 不存在，但投资组合 31 存在。

# ios - Xcode / iOS：单元测试、方案和配置

> ID：15256345
> 
> 赞同：6
> 
> 时间：2013-03-06T19:32:20.350
> 
> 标签：ios, xcode

我的 iOS 项目有五个方案：Local Development、Integration、QA、Demo 和 Production。每个方案都使用不同的配置来控制网络轮询频率、API 端点、分析等。

同样，我们有五个对应的目标：本地开发、集成、QA、演示和生产。每个目标都有几个用户定义的构建设置，其中包含 API 密钥、计时数值等。

我们的应用程序`Info.plist`文件使用应用程序变量，例如`${SOME_ENDPOINT_URL}`在相应的用户定义的构建设置中绘制。

要检索变量，我执行以下操作：

```
[[[NSBundle mainBundle] infoDictionary] valueForKey:@"Some Endpoint URL"] 
```

这将对应于用户定义的构建设置，如下所示：

```
"Some Endpoint URL" = ${SOME_ENDPOINT_URL} 
```

我现在正在研究如何适当地配置项目以执行单元和逻辑测试。

要构建测试以确定环境是否配置正确，我不确定最佳实践是什么。

*   为每个环境构建五个额外的特定于测试的目标是否正确？
*   还是更好地覆盖每个方案的测试组件的“运行操作的参数”设置，并提供类似参数的东西来指定我们正在查看的方案？
*   是否有任何现有的参考资料可以为具有多个环境的 iOS 项目配置单元和逻辑测试？这个项目的复杂性似乎超出了大多数文档的范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-13T08:49:44.430

以下是我所做的。

信息列表

*   创建主 Info.plist 文件
*   为每个方案编写一个运行脚本（Shell Script），通过修改主Info.plist中的设置来生成环境特定的Info.plist（使用PlistBuddy -c）
*   将运行脚本添加到构建阶段（在“编译源”上方）

.h 文件

*   在 .h 文件中定义配置设置（例如 config.h）

    ```
    #if defined (CONFIG_FILE) 
    #import CONFIG_FILE
    #endif 
    ```

*   在您的代码中导入 config.h

*   对每个方案使用预处理器宏来选择目标 .h 文件。

    ```
    -DCONFIG_FILE=local-env-config.h 
    ```

# asp.net-mvc - 标记为 HiddenFor 的字段未绑定到 MVC4 中的模型

> ID：15256349
> 
> 赞同：1
> 
> 时间：2013-03-06T19:32:26.787
> 
> 标签：asp.net-mvc

我已经为应用程序实现了一个图像上传子操作表单。我有一个强类型的局部视图。

```
public class ImageViewModel{
 public long ImageId{get;set;}
 public long OwnerId{get;set;}
 public string ImageName{get;set;}
 public string ImageDescription{get;set;}
 public IEnumerable<HttpPostedFileBase> Files { get; set; }
} 
```

Razor 代码如下所示：

```
<form action="UploadImage" method="post" enctype="multipart/form-data">
  @Html.ValidationSummary()
  @Html.HiddenFor(m => m.OwnerId)
  @Html.HiddenFor(m => m.ImageId)
  @HtmlEditorFor(m=>m.ImageName)
  <input type="file" name="Files" id="file0" />
  <input type="submit" value="Upload" />
 </form> 
```

这是问题所在。当表单被回发时，模型已经上传了文件和 ImageName 值。但是缺少使用 HiddenFor 绑定的值。

```
[HttpPost]
public ActionResult UploadImage(ImageViewModel model)
{ ...} 
```

我已经检查了 HTML 源代码。隐藏字段使用与模型命名的属性匹配的 ID 和名称进行更正。在回邮时，我检查了原始请求。两个隐藏字段都在表单集合中进行。但是模型绑定并没有在属性中设置这些字段的值。这些隐藏字段有什么我遗漏的吗？

谢谢

# php - PHP在while条件下获取numrows数据的值

> ID：15256351
> 
> 赞同：-5
> 
> 时间：2013-03-06T19:32:37.913
> 
> 标签：php, html

我希望能够通过 $_SESSION 标签将所选主题的值发送到另一个页面，但它总是获取数据库中最后一个数据的值

```
$sqltpc = "SELECT * FROM forum_question";
$resulttpc = mysql_query($sqltpc) or die('Error: '.mysql_error());
while($linetpc = mysql_fetch_array($resulttpc, MYSQL_ASSOC)){
   echo "
    <tr id='trow' class='right'><input type='hidden' name='hidden' value=".$linetpc['id']." />
          <td><img src='Images/logosmallforum.png' /><a href='lentech_topic.php'>".$linetpc['id']." ".$linetpc['topic']."</a></td>
      <td><a href='#'>".$linetpc['username']."</a></td>
      <td><a href='#'>".$linetpc['view']."</a></td>
      <td><a href='#'>".$linetpc['reply']."</a></td>
    </tr>";
   }

$viewtpc = $_POST['hidden'];
$_SESSION['idset'] = $viewtpc; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:44:10.350

您需要指定`hidden`输入是一个数组，方法是将其写为：

```
<input type='hidden' name='hidden[]' value=".$linetpc['id']." /> 
```

注意到方括号了吗？`$_POST['hidden']`然后将是所有值的数组，而不仅仅是列表中最后一个值的字符串。

请注意，您实际上必须发布表单才能使其生效（您目前的代码表明您没有）。如果您不打算发布表单，而是将值存储在输入字段中，您只需`$_SESSION['idset']`在循环中添加到数组中：

```
$sqltpc = "SELECT * FROM forum_question";
$resulttpc = mysql_query($sqltpc) or die('Error: '.mysql_error());
while($linetpc = mysql_fetch_array($resulttpc, MYSQL_ASSOC)){

   $_SESSION['idset'][] = $linetpc['id'];

   echo "
    <tr id='trow' class='right'>
          <td><img src='Images/logosmallforum.png' /><a href='lentech_topic.php'>".$linetpc['id']." ".$linetpc['topic']."</a></td>
      <td><a href='#'>".$linetpc['username']."</a></td>
      <td><a href='#'>".$linetpc['view']."</a></td>
      <td><a href='#'>".$linetpc['reply']."</a></td>
    </tr>";
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T16:36:04.167

我知道了！所需要的只是`$_GET`将变量的值传递到另一页。

感谢您的回复，并为我迟到的回复感到抱歉

# android - Android：如何在连续移动时找到使用 GPS 覆盖的总距离？

> ID：15256354
> 
> 赞同：3
> 
> 时间：2013-03-06T19:32:43.763
> 
> 标签：android, gps, distance, locationmanager

这是我的代码。请告诉我它无法计算距离。在这段代码`res`中是一个长变量，它应该存储所覆盖的总距离。此代码应该在纬度和经度发生变化时根据 GPS 计算距离。

```
String serviceString = Context.LOCATION_SERVICE;
LocationManager locationManager;
locationManager= (LocationManager)getSystemService(serviceString);

String provider = LocationManager.GPS_PROVIDER;
final Location loc1=locationManager.getLastKnownLocation(provider);
//Location loc1=new Location("");

String netprovider=LocationManager.NETWORK_PROVIDER;

lat1=loc1.getLatitude();
lon1=loc1.getLongitude();               

LocationListener myLocationListener = new LocationListener() 
                        {
                            public void onLocationChanged(Location loc1) 
                            {

                            Location loc2=new Location("");
                            lat2=loc2.getLatitude();
                            lon2=loc2.getLongitude();
                            dtvalue.setText(lat1+","+lon1+","+lat2+","+lon2);

                            Location.distanceBetween(lat1,lon1,lat2,lon2,dist);
                            res=res+(long)dist[0];

                            lat1=lat2;
                            lon1=lon2;
                        }
                        public void onProviderDisabled(String provider)
                        {
                            // Update application if provider disabled.
                        }
                        public void onProviderEnabled(String provider)
                        {
                            // Update application if provider enabled.
                        }
                        public void onStatusChanged(String provider, int status,
                                Bundle extras)
                        {
                            // Update application if provider hardware status changed.
                        }
                    };
locationManager.requestLocationUpdates(provider, 5000, 1, myLocationListener);
locationManager.requestLocationUpdates(netprovider, 5000, 1, myLocationListener); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:42:46.817

您定义一个空位置`Location loc2=new Location("");`然后使用它的问题。

您可以在您的班级中定义`lat1`和。`lon1`

```
public void onLocationChanged(Location loc1) 
{

    if(lat1 != 0 && long1 != 0) { 
       Location.distanceBetween(lat1,lon1,loc1.getLatitude(),loc1.getLongitude(),dist);
       res+=(long)dist[0];
    }

    lat1=loc1.getLatitude();
    lon1=loc1.getLongitude();
} 
```

# xamarin.ios - MonoTouch 状态栏和 EAGLView 大小

> ID：15256359
> 
> 赞同：1
> 
> 时间：2013-03-06T19:33:01.090
> 
> 标签：xamarin.ios

在我的应用程序中，我希望状态栏使用透明黑色可见。我希望我的帧缓冲区与设备屏幕的大小相同，并且我希望 (0,0) 处的触摸输入位于设备的左上角，而不是在状态栏的正下方。

就像现在一样，EAGLView 正在将帧缓冲区初始化为 320x460，所以我无法为状态栏绘制任何内容以使其透明。此外，如果用户点击屏幕的左上角，则触摸位置给我为 (0,-20)，而我想要 (0,0)。

我的问题是：

**1.**让EAGLView初始化framebuffer到设备全屏尺寸的正确方法是什么？

**2.**为什么我的输入偏移量是（0,0）在状态栏下面？我如何解决它？

我现在正在做的是在 ConfigureLayer 中强制 Layer.Bounds 为 320x480。这使帧缓冲区的大小正确，但如果我将 EAGLView.Bounds 或 EAGLView.Layer.Bounds 设置为任何值，它会不断重置为 320x460。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T03:14:05.717

这里的修复是设置 ViewController.WantsFullScreenLayout = true。如果没有该设置，它会自动调整视图大小以位于状态栏下方。

# extjs4.1 - 显示字段和文本字段更改

> ID：15256360
> 
> 赞同：0
> 
> 时间：2013-03-06T19:33:07.707
> 
> 标签：extjs4.1

我创建了一个窗口，该窗口有一个网格和一个表单，当单击该表单时，该表单会在网格中记录的普通显示字段中显示值。

表单有一个“新建”按钮，一旦用户单击，显示字段应该切换到文本字段，这应该允许您将新记录输入数据库。

为了做到这一点，任何人都可以将我指向某个方向吗？我是 ExtJS 的新手，才刚刚开始学习 ExtJS4。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T23:16:21.113

我建议查看行编辑插件。

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.grid.plugin.RowEditing](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.grid.plugin.RowEditing)

您需要将其添加到网格上的插件配置项，然后将编辑器配置添加到您要编辑的每个列。编辑器配置通常只是 Ext.form.field.* 中的组件之一的 xtype 和配置选项。

# android - Android 故障 [INSTALL_FAILED_MISSING_SHARED_LIBRARY]

> ID：15256362
> 
> 赞同：2
> 
> 时间：2013-03-06T19:33:22.410
> 
> 标签：android, installation, adb

我使用 adb install 方法通过命令行接收到失败 [INSTALL_FAILED_MISSING_SHARED_LIBRARY]。当我将 ARM(armeabi-v7a) CPU 与 Google API 一起使用时，它工作正常，但出于纯粹的性能原因，我尝试使用 Intel Atom(x86) CPU。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T19:36:40.370

英特尔模拟器不支持 Google-API

功能请求： [http ://code.google.com/p/android/issues/detail?id=34066](http://code.google.com/p/android/issues/detail?id=34066)

以前提出的答案：[android 中缺少共享库。](https://stackoverflow.com/questions/2283398/shared-library-missing-in-android)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:36:46.633

您使用的应用程序不是针对 x86 编译的。`.so`在您获得 x86来替换现有的 arm 库（`.so`文件）之前，您将无法继续。

如果您正在编译 C/C++ 库，您自己确保您选择了正确的指令集进行编译。

# restful-architecture - 用户友好和宁静（rails 3）

> ID：15256363
> 
> 赞同：1
> 
> 时间：2013-03-06T19:33:23.190
> 
> 标签：restful-architecture

我是一名 Rails 程序员，现在正在进行他的第三个项目（当然是新项目）。我正在寻找关于 Restful 架构的一般问题的答案。我确信我正在做的事情已经有了一个很好的既定答案。

在 restful 方法中，我们公开资源，但有时这种方法感觉有点不友好。例如，我可以通过 show 方法公开产品，然后我有另一个名为 sales 的资源，我可以通过 product/:id/sales show 模板公开以显示产品的所有销售额。但我要让用户通过额外的点击这里。理想的情况是在一个页面上显示产品及其所有相关销售。但这违反了 Restful 规则。

我只是想问一下，这些规则是否通常被打破以使网站用户友好？作为一个新人，我不想采用不理想的方式，所以我想我应该问这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:36:17.987

添加特定产品的销售额不会打破 RESTful 架构的任何约束。您在 HTTP 请求中有产品 ID，因此您也可以获取该产品的销售额。您的关注点分离不应该受到影响，并且您不需要存储状态来获取此信息。只需扩展您使用视图返回的模型。

您似乎更关心偏离 Rails 提倡的配置约定。此扩展意味着您的模型不会仅与数据库中的一个表相关联，但这很好。这些约定旨在减少您需要做的配置工作，而不是限制您的功能。

# asp.net-mvc - 在 Safari 中传递到服务器的空值

> ID：15256367
> 
> 赞同：2
> 
> 时间：2013-03-06T19:33:33.777
> 
> 标签：asp.net-mvc, mvvm, safari, null

我们在客户端有一个带有 MVVM 的 C#.NET MVC 4 应用程序。当在应用程序中执行特定操作时，客户端中将传递给 webAPI 的参数是正常的，但是一旦在 webAPI 中，控制器会收到一个空参数，因此它会给出错误。这仅在我们第一次执行该操作时发生，第二次运行正常，并且仅在 Apple Safari 上运行应用程序时才会发生（它在 Microsoft Internet Explorer、Google Chrome 和 Mozilla Firefox 中运行良好）。有任何想法吗？提前致谢。

# objective-c - 使用 Objective-C 框架创建 MonoTouch 绑定

> ID：15256368
> 
> 赞同：1
> 
> 时间：2013-03-06T19:33:43.030
> 
> 标签：objective-c, binding, xamarin.ios

我在 Objective-C 中有一个库，我想在 monotouch（xamarin 工作室）中绑定它。该库正在使用我从第三方供应商处下载的框架（“Firebase”框架）。我编译了这个库，它在 XCode 上构建得很好，然后为 i386 和 armv7 架构创建了 .a 文件，并使用 lipo 生成了我的 lib.a 文件。现在，我创建了一个绑定项目，并将我的 .a 文件添加到其中，从而生成了一个 .linkwith.cs 文件。但是，当我使用绑定项目时，它给出了以下错误：

**“ld：找不到框架 Firebase”**

我的问题是 - 如何指定 Firebase 框架？我试过这个：

```
[assembly: LinkWith ("libtestfirebaseclient.a", LinkTarget.ArmV7 | LinkTarget.Simulator, ForceLoad = true, Frameworks = "CFNetwork Security Foundation Firebase")] 
```

然而，问题似乎仍然没有得到解决。有人能告诉我如何为依赖于第三方框架的 obj-c 库创建绑定吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T08:19:09.527

您可能不需要将其`Firebase`作为平台进行引用，而是（如果它不包含在 中`libtestfirebaseclient.a`）为其添加一个新的 LinkWith 属性：

```
[assembly: LinkWith ("libtestfirebaseclient.a", LinkTarget.ArmV7 | LinkTarget.Simulator, ForceLoad = true, Frameworks = "CFNetwork Security Foundation")]
[assembly: LinkWith ("libfirebase.a", LinkTarget.ArmV7 | LinkTarget.Simulator, ForceLoad = true, Frameworks = "CFNetwork Security Foundation")] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T21:45:11.470

我建议确保您已完成所有必要的过程，例如完成 ApiDefinition.cs 文件并在 StructsAndEnums.cs 文件中定义所有必要的枚举等。另外，我很确定您不需要在 LinkWith Frameworks 部分中包含 Firebase。

在我看来，解决这个问题的最好方法是查看已绑定在 monotouch-bindings 存储库中的现有库，并准确了解需要如何布置所有内容。下载一个已经绑定好的库，看看每个东西是如何对应的，对自己的项目也一样。

Xamarin 的网站上有关于[绑定 Objective-C 库](http://docs.xamarin.com/guides/ios/advanced_topics/binding_objective-c_libraries)的详细指南以及作为参考的[绑定类型参考指南](http://docs.xamarin.com/guides/ios/advanced_topics/binding_objective-c_libraries/binding_types_reference_guide)。

# mongoose - MongooseJS：使用数组元素作为查询获取记录并使用回调不起作用

> ID：15256369
> 
> 赞同：1
> 
> 时间：2013-03-06T19:33:43.840
> 
> 标签：mongoose

我有一系列邮政编码，如下所示：

```
zipCodes = [1234, 5678, 1357, 2468]; 
```

现在，我需要根据这些邮政编码获取位置。我这样做如下：

```
locations = [];
zipCodes.forEach(function(zip) {
    Addresses.findOne({ zipCode: zip }, function(error, address) {
        //assuming it is a success
        locations.push(address);
    }
});

//data which works on locations 
```

问题是在位置上工作的数据（最终）没有所有的地址 - 至少在被访问时是这样。如果我延迟 5 到 10 秒（在 zipCodes.forEach() 之后使用 setTimeOut），则位置包含所有地址。
我怀疑的原因是`push()`进入位置是异步发生的，而不是最终访问位置时发生的时间。
在不使用 setTimeOut() 的情况下，如何确保所有地址都填写在位置中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:56:55.223

你的预感是正确的；回调异步发生，`findOne`因此您必须等到它们完成后再处理`locations`。

处理这个问题的一种方法是使用像[async](https://github.com/caolan/async)这样的流控制库。

```
locations = [];
async.each(zipCodes, function(zip, callback) {
  Addresses.findOne({ zipCode: zip }, function(error, address) {
    //assuming it is a success
    locations.push(address);
    callback();
  });
}, function (err) {
  //data which works on locations 
}); 
```

# jquery - 带有可编辑下拉列表的 jquery 日期选择器

> ID：15256372
> 
> 赞同：0
> 
> 时间：2013-03-06T19:33:56.490
> 
> 标签：jquery, asp.net

我将这里给出的解决方案用于我的可编辑下拉列表

[可编辑的下拉列表](http://www.codeproject.com/Articles/290218/Custom-ASP-NET-Editable-DropDownList)。它工作正常。但是我添加了一个日期字段并尝试使用 JQUERY UI 日期选择器。这两个似乎不能一起工作。一旦我添加 jquery-ui-version.js 文件，可编辑的下拉列表就不起作用。所以 js 文件中的某些东西弄乱了下拉列表。开始解决此问题的最佳方法是什么？是否有我可以使用的简单版本的 jquery datepicker？

或者在 asp.net 中是否有另一种可编辑下拉列表的解决方案？

谢谢。

是的，你是对的。可编辑下拉列表所需的文件是（它使用 jquery UI 的一些组件）

```
 jquery.ui.core.js
              jquery.ui.widget.js
              jquery.ui.button.js
              jquery.ui.position.js
              jquery.ui.autocomplete.js
              jquery.ui.combobox.js 
```

主要的 UI js 是

```
 jquery-ui-1.10.1.js 
```

这是使可编辑下拉列表失败的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:55:32.523

由于 Editable DropdownList 依赖于 JQuery UI。您已经包含了许多 JQuery UI 组件。

您可能已经下载了完整版的 JQuery UI，其中包括之前已经包含的相同组件。

转到[http://jqueryui.com/download/](http://jqueryui.com/download/)并构建 JQuery UI Bundle，其中包含您需要的所有功能以及 datepicker。

然后删除旧的 jquery.ui 组件，只包含新的下载。还要用新的替换 css 和图像。

# html - 如何创建简单的联系表格？

> ID：15256381
> 
> 赞同：-4
> 
> 时间：2013-03-06T19:34:29.923
> 
> 标签：html

我在 w3schools 上找到了这个示例并将电子邮件更改为我的电子邮件，但是当我单击发送时没有任何反应。问题出在哪里？

```
<h3>Send e-mail to someone@example.com:</h3>

<form action="MAILTO:someone@example.com" method="post" enctype="text/plain">
Name:<br>
<input type="text" name="name" value="your name"><br>
E-mail:<br>
<input type="text" name="mail" value="your email"><br>
Comment:<br>
<input type="text" name="comment" value="your comment" size="50"><br><br>
<input type="submit" value="Send">
<input type="reset" value="Reset">
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:19:46.280

当您使用 mailto:someone@example.org 时，您并没有真正发送电子邮件您所做的只是告诉浏览器它应该处理以下作为电子邮件地址的内容，因此浏览器将打开默认邮件客户端。

以编程方式发送电子邮件的唯一方法，我认为这是您正在尝试做的，是使用服务器端脚本。像 PHP 或 ASP.NET 这样的东西只举两个例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:41:24.390

不要这样做。它不可靠，因为它取决于用户安装的邮件客户端，您无法对此进行测试。

相反，您应该将表单数据发布到使用

php mail() 函数——简单易学

```
<?php
$to      = 'nobody@example.com';
$subject = 'the subject';
$message = $_POST['comment'];
$headers = 'From:'. $_POST['email']. "\r\n" .
    'Reply-To: webmaster@example.com' . "\r\n" .
    'X-Mailer: PHP/' . phpversion();

mail($to, $subject, $message, $headers);
?> 
```

或使用 cgi 脚本，如

[http://www.response-o-matic.com/](http://www.response-o-matic.com/)

# java - 我在 Netbeans 的类路径中包含的许多 jar 都出现“找不到类”错误

> ID：15256385
> 
> 赞同：0
> 
> 时间：2013-03-06T19:34:37.330
> 
> 标签：java, netbeans, jar, classpath, netbeans-7

我正在尝试在 Netbeans 中创建一个使用许多外部 JAR 文件的 Java Web 应用程序项目。

我创建了一个`lib`文件夹并将所有 JAR 文件放在那里，并将这些 Jar 文件添加到构建路径中。但是我仍然`Package XYZ does not exist`在 Netbeans 中遇到错误。

我在这里做错了什么？我该如何解决这个错误？有没有办法验证我的 JAR 是否包含在内？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:39:26.857

右键单击您的项目并转到 Source/Binary fromat >> 如果您已经选择了较高版本的 JDK，请选择较低版本的 JDK。否则尝试选择其他版本，看看是否有所不同。

# php - if 语句和函数参数

> ID：15256388
> 
> 赞同：1
> 
> 时间：2013-03-06T19:34:41.047
> 
> 标签：php, wordpress, function, arguments

我有一个必须填写的函数，而我看到的唯一方法就是一团糟。我的功能是：

```
public function($keys = array(), $pages = array()){} 
```

本质上，目标是：

*   如果键是一个数组并且每个键都**没有**设置，做一些事情。
*   如果 Keys 不是数组**且未**设置，请执行一些操作。

同样的概念也适用于页面。

所以这是四个 if 语句，然后我们这样做：

*如果 key 是数组但 pages 不是，如果 pages 是数组但 key 不是。如果两者都是数组....*

到目前为止，我所拥有的是：

```
public function sidebar($keys = array(), $pages = array()){
    $builder = AisisCore_Factory_Pattern::create('AisisCore_Template_Builder');

    if(is_array($keys)){
        foreach($keys as $key){
            if(!$builder->get_specific_option($key)){
                get_sidebar();
            }
        }
    }else{
        if(!$builder->get_specific_option($keys)){
            get_sidebar();
        }
    }

    if(is_array($pages)){
        foreach($pages as $page){
            if(!$page){
                get_sidebar();
            }
        }
    }else{
        if(!$pages){
            get_sidebar();
        }
    }

} 
```

你可以看到它很快变得一团糟。`get_specific_option`将检查该密钥是否存在。数组是这样完成的：`array('key', 'secondKey')`等等。页面是这样完成的：`array(is_page(), is_category())`- 每个都返回真或假，因此是布尔检查。`get_sidebar()`例如，如果未设置键或页面不等于 true，则将获得侧边栏。

我不确定如何创建此功能而不会造成灾难。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:39:34.660

您可以通过始终转换为数组来消除很多复杂性（快速单行）

```
$keys = is_array($keys) ? $keys : ($keys ? array($keys) : array());
$pages = is_array($pages) ? $pages : ($pages ? array($pages) : array()); 
```

你现在的功能：

```
public function sidebar($keys = array(), $pages = array()){
    $builder = AisisCore_Factory_Pattern::create('AisisCore_Template_Builder');
    $keys = is_array($keys) ? $keys : ($keys ? array($keys) : array());
    $pages = is_array($pages) ? $pages : ($pages ? array($pages) : array());

    foreach ($keys as $key) {
        if (!$builder->get_specific_option($key)) {
            get_sidebar();
        }
    }

    foreach ($pages as $page) {
        if (!$page) {
            get_sidebar();
        }
    }
} 
```

这似乎有很多潜在的侧边栏包含。只是说。但是，您可以传递`NULL`两个参数中的任何一个，它根本不会运行`foreach`内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:43:28.070

如果选项是可选的，您可以将值提供为 null，例如：

```
public function sidebar($keys = NULL, $pages = NULL){
  //Do something here
} 
```

这可能对你有用吗？

```
<?php
    $search_array = array(
              'first' => 1, 
              'second' => 4);
    if (array_key_exists('first', $search_array)) {
         echo "The 'first' element is in the array";
    }
?> 
```

# ruby - 如何在没有 Rails 的情况下使用 LiveReload 在浏览器中提供 html

> ID：15256391
> 
> 赞同：1
> 
> 时间：2013-03-06T19:34:53.887
> 
> 标签：ruby, web, livereload

我正在研究一个简单的 web 项目的 css 和 html。

每当我对项目中的任何文件进行更改时，我都想使用[livereload 即时更新在浏览器中呈现的内容。](http://livereload.com/)

从 livereload 网站上的描述：

> **LiveReload 是做什么的？**
> 
> LiveReload 监视文件系统中的变化。保存文件后，会根据需要对其进行预处理，并刷新浏览器。
> 
> 更酷的是，当您更改 CSS 文件或图像时，浏览器会立即更新，而无需重新加载页面。

由于这不是 rails/sinatra 项目，而只是简单的 html/css/js，我可以使用什么来进行实时重新加载？

例如，gem 存储库中是否有一些轻量级服务器可以为我解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:09:37.453

您可以使用[catapult gem](https://github.com/maccman/catapult#catapult)设置一个简单的 sprockets 应用程序，无需 sinatra 或 rails。它只是一个静态站点，可以轻松使用某种`asset pipeline`. 我已经使用了很多，我喜欢它。

然后在你的你可以在[这里](https://github.com/guard/guard-livereload#guardlivereload)`Gemfile`添加`gem 'guard-livereload'`项目。

只需按照设置说明进行操作，您可能还需要检查[guard](https://github.com/guard/guard)以使一切正常工作。

我只建议使用弹射器，因为它使设置一个简单的静态站点变得非常容易`sprockets`，`coffeescript`并且具有`sass`.

要在不使用弹射器的情况下执行此操作，只需`bundle init`在根目录中运行（假设您安装了 bundler gem），这将创建一个`Gemfile`. 然后你需要做的就是`guard-livereload`像我上面写的那样添加gem。

请享用

# angularjs - AngularJS中如何使用属性前缀“x-”和“data-”

> ID：15256396
> 
> 赞同：33
> 
> 时间：2013-03-06T19:35:03.430
> 
> 标签：angularjs, angularjs-directive

我是 Angular 的新手，并试图理解“x-”和“data-”前缀的含义。在指令文档（[http://docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)）中，它说这些前缀将使指令“符合 HTML 验证器”。这到底是什么意思？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-06T19:37:52.120

HTML5 规范允许任意属性，只要它们以 data- 为前缀，如下所示：

```
<div data-myattribute=""></div> 
```

而这将是无效的 HTML5：

```
<div myattrbute=""></div> 
```

[有关数据属性的更多信息，请查看此处。](http://www.w3.org/TR/2011/WD-html5-20110525/elements.html#embedding-custom-non-visible-data-with-the-data-attributes)

至于“x-”属性，我认为您的意思是“x:”属性和元素，它们特定于 XHTML 验证......

为了扩展这一点，如果您（出于某种原因）要使用 XHTML，您可以像这样定义具有命名空间的自定义属性（我只是在这里总结要点）：

```
<html xmlns:x="http://sample.com/mynamespace">
<body>
   <div x:whatever=""></div>
   <x:mytag></x:mytag>
</body>
</html> 
```

其中 xmlns 中的 URL 实际上只是为了防止类似元素之间的冲突。此外，可以为验证目的提供自定义元素和属性的 DTD，作为 DOCTYPE 声明的一部分。

*浏览器中的行为会随着这种 xmlns 方法而变化。

不过，总而言之：**使用过去三年发布的大多数浏览器或 IE8+，您不必担心这些事情。**只有在非常特殊的情况下，您才会真正关心。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-07-27T20:56:29.497

来自 HTML5 规范：[http ://www.w3.org/html/wg/drafts/html/master/single-page.html](http://www.w3.org/html/wg/drafts/html/master/single-page.html)

> 以两个字符“x-”开头的属性名称保留给用户代理使用，并保证永远不会正式添加到 HTML 语言中。

还：

> 对于旨在与[HTML 语法一起使用的](http://www.w3.org/html/wg/drafts/html/master/single-page.html#syntax)标记级功能，扩展应限于“ `x-vendor-feature`”形式的新属性，其中 vendor 是一个短字符串，用于标识负责扩展的供应商，而 feature 是特征。不应创建新的元素名称。对此类扩展使用属性仅允许来自多个供应商的扩展在同一个元素上共存，这对于元素是不可能的。使用 " `x-vendor-feature`" 形式允许进行扩展，而不会有与规范的未来添加冲突的风险。

# wpf - 如何使用 MVVM 数据绑定 WPF 更新用户控件的多个实例？

> ID：15256403
> 
> 赞同：0
> 
> 时间：2013-03-06T19:35:20.327
> 
> 标签：wpf, mvvm, wpf-controls

我`UserControl`用 a`ProgressBar`和 a 创建了 a `Label`。

```
<Label Content="{Binding ElementName=UserControl, Path=StatusProperty}" Grid.Row="1" Height="28" HorizontalAlignment="Left" Margin="76,0,0,32" Name="lblStatus" VerticalAlignment="Bottom" Grid.RowSpan="2" />
<ProgressBar Grid.Row="2" Height="20" HorizontalAlignment="Left" Margin="12,3,0,0" Name="pbCheckProgress" Style="{DynamicResource ProgressBarStyle}" Maximum="{Binding ElementName=UserControl, Path=MaximumProperty}" Minimum="{Binding ElementName=UserControl, Path=MinimumProperty}" Value="{Binding ElementName=UserControl, Path=ValueProperty}" VerticalAlignment="Top" Width="156" /> 
```

然后我创建了以下内容`DependencyProperties`：

```
// Dependency Properties for labels
public static readonly DependencyProperty StatusProperty = DependencyProperty.Register("Status", typeof(string), typeof(UserControl1), new FrameworkPropertyMetadata("", FrameworkPropertyMetadataOptions.BindsTwoWayByDefault));

// Dependency Properties for progress bar properties
public static readonly DependencyProperty MinimumProperty = DependencyProperty.Register("Minimum", typeof(double), typeof(UserControl1), new FrameworkPropertyMetadata(0.0d, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault));

public static readonly DependencyProperty MaximumProperty = DependencyProperty.Register("Maximum", typeof(double), typeof(UserControl1), new FrameworkPropertyMetadata(0.0d, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault));

public static readonly DependencyProperty ValueProperty = DependencyProperty.Register("Value", typeof(double), typeof(UserControl1), new FrameworkPropertyMetadata(0.0d, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault)); 
```

现在我想`UserControl`在同一页面中创建这个的多个实例，并`ProgressBar`使用 MVVM 更新后面的代码。但我无法弄清楚这一点。我是否需要有一个 ViewModel，`UserControl`以便每个实例都有自己的 ViewModel 副本。

有没有办法从页面 ViewModel 更新所有实例？

谢谢和问候， 巴拉特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:59:06.607

如果我理解正确，听起来您想为此创建一个 ViewModel `UserControl`，然后拥有该 ViewModel 的多个实例（视图`UserControl`上的每个实例一个）。如果你有一个 ViewModel`UserControls`绑定了多个，它们都会显示完全相同的东西。

听起来您已经有了 Page 的 ViewModel，因此您可以简单地将 ViewModel 添加为`UserControl`Page ViewModel 的属性，如下所示：

```
public class PageViewModel : INotifyPropertyChanged
{
    private UCViewModel _ucViewModel;

    //Other ViewModel Code

    public UCViewModel UserControlViewModel
    {
        get { return _ucViewModel; }
    }
} 
```

其中 UCViewModel 是您的`UserControl`. 然后，在您的 XAML 中，您只需绑定到 UCViewModel 上的属性，如下所示：

```
<local:myControl Status="{Binding UserControlViewModel.Status}"... /> 
```

如果你有一个 UCViewModel 的集合，你需要稍微不同地处理它，但概念还是一样的。

# c# - if条件中的s ql select语句

> ID：15256404
> 
> 赞同：1
> 
> 时间：2013-03-06T19:35:31.123
> 
> 标签：c#, sql-server, tsql, if-statement

我想创建如下语句：

```
if (select statement1 returns rows){
   select statement2
}
else {
  select statement3
} 
```

此`if`语句是更大查询的一部分

```
 select from products where p.id in (
        if (select statement1 returns rows){
           select statement2
       }
       else {
        select statement3
      } 
```

这在 SQL Server 中是否可行，还是我的想法不正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:37:35.353

您需要使用`EXISTS`和的组合`CASE..END`：

```
select *
from products
where p.id in (
  case when (exists ( <statement1> ))
    then ( <statement2> )
    else ( <statement3> )
  end
) 
```

`<statement1>`可能在哪里：`SELECT * FROM Customer WHERE Id = 123`

`<statement2>`可能：`SELECT MIN(field) FROM someTable`

`<statement3>`可能：`SELECT 0 as DefaultValue`

如果您可以展示一些您想要这些实际陈述的示例，我可以提供更具体的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:44:40.150

实际上，出于性能考虑，SQL 更加严格。您的查询看起来更像这样：

```
select *
from products
where  1 = case when (exists ( <statement1> ))
              then case when p.id in ( <statement2> ) then 1 else 0 end
              else case when p.id in ( <statement3> ) then 1 else 0 end
           end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:47:59.487

由于您正在检查相同的`id`存在，我认为您可以在`UNION`这里做一个。

```
select *
from products 
where p.id in  (select id from table1
                union 
                select id from table2) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-06T19:55:53.430

我建议在您的两个条件之间使用 UNION 来帮助避免性能问题......并且可能也更容易阅读。

```
 SELECT FROM products p
    WHERE EXISTS (SELECT STATEMENT1)
    AND EXISTS (SELECT STATEMENT2 s2 WHERE s2.p_id = p.id)
    UNION
    SELECT FROM products p
    WHERE NOT EXISTS (SELECT STATEMENT1)
    AND EXISTS (SELECT STATEMENT3 s3 WHERE s3.p_id = p.id) 
```

Depending on the nature of the statements, you might be able to leave off the Not Exists in the second select.

# hibernate - 限制为 JPA / Hibernate 中的列表获取数据的首选方法是什么？

> ID：15256405
> 
> 赞同：2
> 
> 时间：2013-03-06T19:35:41.453
> 
> 标签：hibernate, jpa

我试图找出正确的方法来只加载显示数百行的列表视图的一些属性。

例如，想象一个 Person 实体，它有很多属性，但我只想获取列表的名字和姓氏。

使用 Hibernate/JPA 实现这一目标的最佳方法是什么？

A) 我是否应该安排我的实体，使它们只包含几个属性，而其余的则使用一对一的关系在单独的实体（和表）中？

B) 我应该使用 Hibernate 的惰性属性获取吗？甚至手册都说它“主要是营销功能”？

C）还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:45:33.123

您可以使用 JPQL`NEW`运算符。您可以创建一些 DTO 对象并在 JPQL 查询中对其进行初始化：

```
public class PersonDTO {

   private String firstName;
   private String surname;

   public PersonDTO(String firstName, String surname) {
      this.firstName = firstName;
      this.surname = surname;
   }

   // getters setters

}

Select NEW PersonDTO(p.firstName, p.surname) From Person p; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:46:17.570

为了`ORM`最好地使用它，我会选择一种解决方案来尊重`OOP`范式并尝试封装事物。我猜如果你主要只需要两个属性，那么有一个专门用于这两个属性的类并将其与其他一些类相关联是有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T20:04:00.333

您可以考虑的另一种可能性是简单地为同一个表定义两个不同的映射。例如`PersonOverview`，将仅映射几个属性，并且主要用于获取大量人员集合，而`PersonDetails`将映射所有可用的人员属性，但仅在需要获取一个特定人员以进行显示/编辑时才使用。

# scripting - Gephi 的脚本插件是否接受十六进制而不仅仅是“红色”或“蓝色”？

> ID：15256411
> 
> 赞同：-1
> 
> 时间：2013-03-06T19:35:58.487
> 
> 标签：scripting, jython, gephi

代码：

```
g.filter(join_month == "2008.03").nodes.color = red 
```

为什么以下不起作用？

```
g.filter(join_month == "2008.03").nodes.color = #FFFFFF 
```

我只是有十六进制颜色的格式错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T21:12:01.047

Gephi 似乎使用[Jython](http://www.jython.org/jythonbook/en/1.0/JythonAndJavaIntegration.html)作为其 Python 解释器的基础。

您应该能够通过创建一个`java.awt.Color`对象并将您的十六进制值传递给构造函数来获得所需的结果，如下所示：

```
>>> from java.awt import Color
>>> mycolor = Color(0xFFFFFF)
>>> g.filter(join_month == "2008.03").nodes.color = mycolor 
```

根据[此处](http://wiki.gephi.org/index.php/Scripting_Plugin#Applying_Filters)找到的示例，看起来另一种方法是使用 Gephi 的`color`类：

```
>>> red = 0xFF
>>> green = 0xFF
>>> blue = 0xFF
>>> g.filter(join_month == "2008.03").nodes.color = color(red, green, blue) 
```

# symfony - Symfony2：使用作曲家时如何解决两个捆绑包需求冲突？

> ID：15256416
> 
> 赞同：10
> 
> 时间：2013-03-06T19:36:18.940
> 
> 标签：symfony, dependencies, bundle, composer-php

我需要使用两个捆绑包：

*   [dsyph3r/google-geolocation-bundle](https://packagist.org/packages/dsyph3r/google-geolocation-bundle)
*   [mlpz/邮戳包](https://packagist.org/packages/mlpz/postmark-bundle)

我在尝试更新作曲家时遇到问题，因为他们对**kriswallsmith/buzz**捆绑包有不同的要求：

1.  克里斯沃尔史密斯/嗡嗡声：<=0.5
2.  克里斯沃尔史密斯/嗡嗡声：> = 0.9

解决此问题的最佳方法是什么？我必须在捆绑 github 问题跟踪器中报告问题吗？还是更好地分叉 google-geolocation-bundle 来更新其依赖项？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-06T19:40:44.537

您可以尝试在 composer 中使用非真实的 Buzz 版本号，如下所示：

```
"kriswallsmith/buzz": "v0.9 as 0.5" 
```

但这并不是事实，因为它可能`google-geolocation-bundle`不适用于更高版本的嗡嗡声。

但也尝试使用某些东西而不是`dsyph3r/google-geolocation-bundle`. 很奇怪，它需要旧版本的捆绑包......

# ios - UIProgressView 不显示进度

> ID：15256424
> 
> 赞同：2
> 
> 时间：2013-03-06T19:36:50.733
> 
> 标签：ios, objective-c, uiprogressview

我不明白我在哪里下蛋。我需要更新progreesView 的进度。我在 IB 中创建 UIProgressView 并仅更改颜色。我有财产和下一个代码

```
@property (weak, nonatomic) IBOutlet UIProgressView *progressView; 
```

属性连接到 IB 中的插座

```
- (void)viewDidLoad
{
[super viewDidLoad];
self.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"DefaultSS.png"]];
}

- (void) viewDidAppear:(BOOL)animated
{
  [self connectToServer];
}

- (void) connectToServer
{
  //some code...
    sleep(2);
[self.progressView setProgress:0.2 animated:YES];
sleep(1);
[self.progressView setProgress:0.4 animated:YES];
sleep(1);
[self.progressView setProgress:0.7 animated:YES];
sleep(1);
[self.progressView setProgress:1.0 animated:YES];
sleep(1);
 //some code...
 } 
```

睡眠效果很好，但 UIProgressView 的进度不会随时间变化。我哪里弄错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T19:39:18.190

sleep() 阻塞主线程，因此不会发生 UI 更新。您需要使用 NSTimer 或类似的东西。

# jquery - jQuery - 除非请求，否则如何停止图像加载

> ID：15256426
> 
> 赞同：1
> 
> 时间：2013-03-06T19:37:00.633
> 
> 标签：jquery, image, load

是否可以停止加载图像，直到通过 jQuery 请求？

我目前正在使用 jQuery Waypoints，并且只想在该特定位置将图像加载到文档中一次......

这适用于 IMG 标签中的图像，以及背景图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:40:38.393

任何时候`<img>`创建一个标签，或者一个`Image`对象`.src`设置了它的属性，它就会开始尝试加载。

我知道做你想做的唯一方法是确保在实际需要之前不会创建元素。

如果您知道图像有多大，您可以使用按比例放大到正确尺寸的 1x1 占位符，然后`.src`在需要时将占位符替换为正确的图像。这至少应该使您的页面布局保持稳定并避免重排。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T16:57:15.327

您可以简单地创建没有任何标签的图像，因此浏览器将无需加载任何内容。然后在需要时强制浏览器加载图像。查看本教程，[了解如何按需加载图像](http://podlipensky.com/2013/06/css-only-load-images-on-demand/)

# mysql - 使用另一个表值更新一个表记录

> ID：15256433
> 
> 赞同：0
> 
> 时间：2013-03-06T19:37:24.300
> 
> 标签：mysql, sql

我有两张表，一张包含作者姓名及其联系地址，另一张包含作者姓名及其 ID。

两个表中的作者姓名具有相同的值，我想从一个表中获取 ID 并更新名称相同的另一个表。

我尝试了这个查询，我相信它可以在 T-SQL 中使用（子查询也可以在 MySQL 中使用），但它在 MySQL 中不起作用：

```
UPDATE authors
set ID = (select b.ID from authors a, authorsID b 
where trim(a.name)=trim(b.name)); 
```

你能告诉我如何完成这项工作吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:39:24.193

```
UPDATE authors a
inner join authorsID b on trim(a.name) = trim(b.name)
set a.ID = b.ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:43:03.080

询问：

```
UPDATE authors
SET ID = (SELECT b.ID 
          FROM authorsID b
          WHERE trim(authors.name)=trim(b.name)) 
```

# python - z3 解数

> ID：15256437
> 
> 赞同：5
> 
> 时间：2013-03-06T19:37:41.097
> 
> 标签：python, z3, solver

如何使用 z3 计算解决方案的数量？例如，我想证明对于 any `n`，方程组有 2 个解`{x^2 == 1, y_1 == 1, ..., y_n == 1}`。以下代码显示了给定的可满足性`n`，这不是我想要的（我想要任意的解决方案数量`n`）。

```
#!/usr/bin/env python

from z3 import *

# Add the equations { x_1^2 == 1, x_2 == 1, ... x_n == 1 } to s and return it.
def add_constraints(s, n):
    assert n > 1
    X = IntVector('x', n)
    s.add(X[0]*X[0] == 1)
    for i in xrange(1, n):
        s.add(X[i] == 1)
    return s

s = Solver()
add_constraints(s, 3)
s.check()
s.model() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-06T20:47:42.107

如果有有限数量的解决方案，您可以使用不等于其分配的模型值的常量（您的 x_i）的析取来枚举所有这些。如果有无限的解决方案（如果你想证明所有自然数 n 的情况就是这种情况），你可以使用相同的技术，但当然不能枚举它们，但可以使用它来生成许多解决方案一些绑定你选择。如果要对所有 n > 1 证明这一点，则需要使用量词。我在下面添加了对此的讨论。

虽然您没有完全提出这个问题，但您也应该看到这个问题/答案：[Z3：找到所有令人满意的模型](https://stackoverflow.com/questions/13395391/z3-finding-all-satisfying-models/13398853)

这是您执行此操作的示例（此处的 z3py 链接：[http](http://rise4fun.com/Z3Py/643M) ://rise4fun.com/Z3Py/643M ）：

```
 # Add the equations { x_1^2 == 1, x_2 == 1, ... x_n == 1 } to s and return it.
def add_constraints(s, n, model):
    assert n > 1
    X = IntVector('x', n)
    s.add(X[0]*X[0] == 1)
    for i in xrange(1, n):
        s.add(X[i] == 1)

    notAgain = []
    i = 0
    for val in model:
      notAgain.append(X[i] != model[val])
      i = i + 1
    if len(notAgain) > 0:
      s.add(Or(notAgain))
      print Or(notAgain)
    return s

for n in range(2,5):
  s = Solver()
  i = 0
  add_constraints(s, n, [])
  while s.check() == sat:
    print s.model()
    i = i + 1
    add_constraints(s, n, s.model())
  print i # solutions 
```

如果你想证明对于 n 的任何选择都没有其他解决方案，你需要使用量词，因为前面的方法只适用于有限的 n（并且它很快变得非常昂贵）。这是显示此证明的编码。您可以对此进行概括，以结合上一部分中的模型生成功能，以提出更通用的公式的 +/- 1 解决方案。如果方程有多个独立于 n 的解（如您的示例中），这将允许您证明方程具有一些有限数量的解。如果解决方案的数量是 n 的函数，则您必须弄清楚该函数。z3py 链接：[http ://rise4fun.com/Z3Py/W9En](http://rise4fun.com/Z3Py/W9En)

```
x = Function('x', IntSort(), IntSort())
s = Solver()
n = Int('n')
# theorem says that x(1)^2 == 1 and that x(1) != +/- 1, and forall n >= 2, x(n) == 1
# try removing the x(1) != +/- constraints
theorem = ForAll([n], And(Implies(n == 1, And(x(n) * x(n) == 1, x(n) != 1, x(n) != -1) ), Implies(n > 1, x(n) == 1)))
#s.add(Not(theorem))
s.add(theorem)
print s.check()
#print s.model() # unsat, no model available, no other solutions 
```

# c# - 使用基于层的对撞球 C# Unity 难以陶醉对象

> ID：15256438
> 
> 赞同：0
> 
> 时间：2013-03-06T19:37:44.003
> 
> 标签：c#, unity3d

我在让机制在我的游戏中正常运行时遇到了一些麻烦。基本上我有两个区域： Collidersight 和 Colliderfatal，由连接到由大炮发射的炮弹上的对撞机球体定义。本质上，我希望在 Collidersight 区域内的任何对象只要在该特定区域内就可以显示出来，如果它们在该区域之外，它们应该恢复为不可见。如果一个对象与 Colliderfatal 发生碰撞，那么即使在外壳被破坏之后，该对象也应该永久显示。我曾尝试单独初始化游戏对象，但这似乎非常令人困惑并且不适用于这种情况。游戏对象已经存在于场景中，我没有在其中实例化它们。有人告诉我，

这是代码。

```
using UnityEngine;
using System.Collections;
using System.Collections.Generic;
public class zone : MonoBehaviour {

 public LayerMask m_SightLayers;
public LayerMask  s_FatalityLayers;
    public Vector3 m_Position;
    public float m_Radius;
    public float m_Force;
    public float s_Radius;
    public Vector3 s_Position;
    public Invisible1 revealenemy1;
    public Invisible1 enemykill1; 

    public float s_Force;

    public InvisibleKill makeDead;

    public GameObject EnemyCube1; 

    //public GameObject enemydead; 
    bool hasExploded;
    public bool inZone;
    public bool inKillzone;
    //public float removeTime = 5.0f;

    bool hasBeenhit;

    void Awake(){

    GameObject[] objects = GameObject.FindGameObjectsWithTag("Enemy");  

    }

    void start (){

    makeDead = (InvisibleKill) EnemyCube1.GetComponent (typeof(InvisibleKill));

    revealenemy1 = (Invisible1) EnemyCube1.GetComponent(typeof(Invisible1));    

    }

    void OnCollisionEnter(Collision explode){

        if(explode.gameObject.name == "Terrain" || explode.gameObject.name == "EnemyCube" || explode.gameObject.name == "EnemyCube1" ){
            hasExploded = true;
        }

    }
    void FixedUpdate ()
    {
        if (hasExploded == true){

        Collider[] collidersight;
        Collider[] colliderfatal;
        Rigidbody rigidbody;

        collidersight = Physics.OverlapSphere (transform.position + m_Position, m_Radius, m_SightLayers);
        foreach (Collider collider in collidersight)
        {
            if(collider.tag == "Enemy"){

                Debug.Log("stuff");

                }

            rigidbody = (Rigidbody) collider.gameObject.GetComponent (typeof (Rigidbody));
            if (rigidbody == null)
            {
                    continue;
                    }

            if(rigidbody.gameObject.tag == "Enemy"){
                inZone = true;

            if(inZone == true){

            revealenemy1.Reveal1(); 
          //  revealenemy2.Reveal2();
            //revealenemy3.Reveal3();

                Debug.Log ("hit");

                    hasBeenhit = true;

                    if(hasBeenhit == false){
                        hasBeenhit = false;
                    //  revealenemy1.Hidden();
                    ////    revealenemy2.Hidden2();
                //      revealenemy3.Hidden3();

                    }

            }else{

                }
                }

            }   
        //Debug.Log (hasExploded);
        colliderfatal = Physics.OverlapSphere (transform.position + s_Position,s_Radius,s_FatalityLayers);
        foreach (Collider collider in colliderfatal)
        {

            inKillzone = true; 
        rigidbody = (Rigidbody) collider.gameObject.GetComponent (typeof (Rigidbody));
            if (rigidbody ==null)
            {
            continue;   

            }
            rigidbody.AddExplosionForce (s_Force * -1, transform.position + s_Position,s_Radius);
            Debug.Log("hasbeenkilled");

                }

        }

        if(hasBeenhit == false){

            revealenemy1.Hidden();
            //revealenemy2.Hidden2();
            //revealenemy3.Hidden3 ();
        hasBeenhit = false;
        }

        if(inKillzone == true){

            //EnemyCube1.GetComponentInChildren (typeof(Invisible1));
            hasBeenhit = true;
            //revealenemy.renderer.enabled = true;
        //  makeDead.isdead = true; 
                //(typeof(Invisible1));

        }

        if(makeDead.isdead == true){

            revealenemy1.Reveal1();

        }

    }

  void OnDrawGizmosSelected ()  {
        Gizmos.color = Color.red;
        Gizmos.DrawWireSphere (transform.position + m_Position, m_Radius);
        //Gizmos.DrawWireSphere (transform.position + s_Position, s_Radius);
    }

    void OnDrawGizmos()
    {

        Gizmos.color = Color.blue;

        Gizmos.DrawWireSphere (transform.position + s_Position, s_Radius);

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T21:13:48.337

为什么不简单地在对象渲染器进入*区域*时激活/停用它们？您规定进入“致命”区域的对象是永久可见的，我认为这是指即使它们离开该区域也是可见的。

要放置在要更改其可见性的任何对象上的可见性类：

```
public class Visibility : MonoBehaviour {
    public bool LockVisibility = false;

    public void SetVisible(bool state){
        if(LockVisibility)return;
        renderer.enabled = state;
    }
} 
```

和碰撞检测类。

```
public class CollisionRender : MonoBehaviour {
//example collision types
public enum CollisionTypes { Fatal,InSight };
public CollisionTypes CollisionType = CollisionTypes.InSight;

//turn renderer on.  
void OnTriggerEnter(Collider other) {
    Visibility vis = other.gameObject.GetComponent<Visibility>();

    if(CollisionType == CollisionTypes.InSight){
        vis.SetVisible(true);
    }else if(CollisionType == CollisionTypes.Fatal){

        //if in 'fatal' zone, make visible and lock visibility.
        vis.SetVisible(true);
        vis.LockVisibility = true;
    }
}
void OnTriggerExit(Collider other) {
    Visibility vis = other.gameObject.GetComponent<Visibility>();
    vis.SetVisible(false);
}
} 
```

我正在使用触发器，因此您的对撞机需要检查“IsTrigger”才能工作。

# xslt - XSLT 不匹配元素 - 命名空间声明

> ID：15256439
> 
> 赞同：1
> 
> 时间：2013-03-06T19:37:44.923
> 
> 标签：xslt, metadata, xslt-2.0

我敢肯定这是一个非常简单的修复，但我很难过。我有输入 XML 与以下根元素，并重复子元素：

```
<modsCollection 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://www.loc.gov/mods/v3"
    xsi:schemaLocation="
      http://www.loc.gov/mods/v3
      http://www.loc.gov/standards/mods/v3/mods-3-4.xsd">
  <mods version="3.4">
            ... 
```

我有一个 XSLT 表，其中包含以下内容来匹配每个节点，并将其作为一个由元素`<mods>`命名的单独文件踢出。`<identifier type="local">`

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<xsl:stylesheet version="2.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns="http://www.loc.gov/mods/v3">
  <xsl:output method="xml" indent="yes"/>   

  <xsl:template match="/modsCollection">
    <xsl:for-each select="mods">
      <xsl:variable name="filename" 
          select="concat(normalize-space(
                           identifier[@type='local']),
                         '.xml')" />
      <xsl:result-document href="{$filename}">            
        <xsl:copy-of select="."></xsl:copy-of>     
      </xsl:result-document>
    </xsl:for-each>
  </xsl:template>

</xsl:stylesheet> 
```

如果XML 输入在根元素中没有 xmlns:xsi、xmlns 或 xsi:schemaLoaction 属性，则此方法*有效。*因此，例如，它适用于以下方面：

```
<modsCollection>   
  <mods version="3.4">
            ... 
```

我知道我们的一些 MODS 文件包含了前缀，但我不清楚如果我们的 XSLT 匹配不是在寻找前缀，为什么没有前缀就无法工作。任何想法或建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:57:28.033

```
<xsl:template match="/modsCollection"> 
```

匹配`modsCollection`没有命名空间。你要

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns="http://www.loc.gov/mods/v3"
    xmlns:m="http://www.loc.gov/mods/v3"> 
```

然后

```
<xsl:template match="/m:modsCollection"> 
```

为了在 mods 命名空间中匹配 `modsCollection`，并且类似地`m:`在样式表中的所有 xslt 模式和 xpath 表达式中使用前缀。

# c# - IE通过AJAX调用改变Xml

> ID：15256441
> 
> 赞同：1
> 
> 时间：2013-03-06T19:37:51.523
> 
> 标签：c#, jquery, asp.net

我正在使用以下代码从文件中获取 xml ..

```
var uploadInfo = context.Request.Files[0];
                var uploadStream = uploadInfo.InputStream;
                var upload = new byte[uploadInfo.ContentLength];
                uploadStream.Read(upload, 0, uploadInfo.ContentLength);
                var payload = System.Text.Encoding.UTF8.GetString(upload);

                context.Response.ContentType = "text/plain";
                context.Response.Write(payload); 
```

xml 看起来像这样，因为这一点正如预期的那样..

```
<?xml version="1.0"?>  
 <AData>
 <DataElement name="Comments" type="String"></DataElement> 
 <DataElement name="ModAuthor" type="String"></DataElement>  
 <DataElement name="CreateDate" type="Datetime"></DataElement>    
 <DataElement name="Author" type="String"></DataElement>   
 </AData> 
```

我用这段代码调用我的处理程序..

```
 $.ajaxFileUpload({

                url: 'AjaxFileUploader.ashx',
                secureuri: false,
                fileElementId: 'fileToUpload',
                dataType: 'text',
                success: function (data, status) {

                    alert(data);

                },

                error: function (data, status, e) {
                    alert(e);
                }

            } 
```

在 chrome 中一切都很好，但在 IE 中测试成功方法返回以下内容..

```
<DIV class=e><SPAN class=b>&nbsp;</SPAN> <SPAN class=m>&lt;?</SPAN><SPAN class=pi>xml version="1.0" </SPAN><SPAN class=m>?&gt;</SPAN> </DIV>
<DIV class=e>
<DIV style="TEXT-INDENT: -2em; MARGIN-LEFT: 1em" class=c><A class=b onfocus=h() onclick="return false" href="#">-</A> <SPAN class=m>&lt;</SPAN><SPAN class=t>AData</SPAN><SPAN class=m>&gt;</SPAN></DIV>
<DIV>
<DIV class=e>
<DIV style="TEXT-INDENT: -2em; MARGIN-LEFT: 1em"><SPAN class=b>&nbsp;</SPAN> <SPAN class=m>&lt;</SPAN><SPAN class=t>DataElement</SPAN> <SPAN class=t>name</SPAN><SPAN class=m>="</SPAN><B>Comments</B><SPAN class=m>"</SPAN><SPAN class=t> type</SPAN><SPAN class=m>="</SPAN><B>String</B><SPAN class=m>"</SPAN><SPAN class=m> /&gt;</SPAN> </DIV></DIV>
<DIV class=e>
<DIV style="TEXT-INDENT: -2em; MARGIN-LEFT: 1em"><SPAN class=b>&nbsp;</SPAN> <SPAN class=m>&lt;</SPAN><SPAN class=t>DataElement</SPAN> <SPAN class=t>name</SPAN><SPAN class=m>="</SPAN><B>ModAuthor</B><SPAN class=m>"</SPAN><SPAN class=t> type</SPAN><SPAN class=m>="</SPAN><B>String</B><SPAN class=m>"</SPAN><SPAN class=m> /&gt;</SPAN> </DIV></DIV>
<DIV class=e>
<DIV style="TEXT-INDENT: -2em; MARGIN-LEFT: 1em"><SPAN class=b>&nbsp;</SPAN> <SPAN class=m>&lt;</SPAN><SPAN class=t>DataElement</SPAN> <SPAN class=t>name</SPAN><SPAN class=m>="</SPAN><B>CreateDate</B><SPAN class=m>"</SPAN><SPAN class=t> type</SPAN><SPAN class=m>="</SPAN><B>Datetime</B><SPAN class=m>"</SPAN><SPAN class=m> /&gt;</SPAN> </DIV></DIV>
<DIV class=e>
<DIV style="TEXT-INDENT: -2em; MARGIN-LEFT: 1em"><SPAN class=b>&nbsp;</SPAN> <SPAN class=m>&lt;</SPAN><SPAN class=t>DataElement</SPAN> <SPAN class=t>name</SPAN><SPAN class=m>="</SPAN><B>Author</B><SPAN class=m>"</SPAN><SPAN class=t> type</SPAN><SPAN class=m>="</SPAN><B>String</B><SPAN class=m>"</SPAN><SPAN class=m> /&gt;</SPAN> </DIV></DIV>
<DIV><SPAN class=b>&nbsp;</SPAN> <SPAN class=m>&lt;/</SPAN><SPAN class=t>AData</SPAN><SPAN class=m>&gt;</SPAN></DIV></DIV></DIV> 
```

有什么想法可以简单地返回从处理程序代码中获得的 xml 字符串？它在 chrome 中返回 xml，但 IE 自动为我提供了看起来是 html 和样式的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:21:21.233

尝试添加`X-Content-Type-Options: nosniff`标题：http:
[//blogs.msdn.com/b/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx](http://blogs.msdn.com/b/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)

```
context.Response.ContentType = "text/plain";
context.Response.AppendHeader("X-Content-Type-Options", "nosniff"); 
```

# c++ - 通过交替渲染或两个单独的线程连续渲染到同一个 wxPanel 上的两个 wxglcanvas

> ID：15256450
> 
> 赞同：1
> 
> 时间：2013-03-06T19:38:12.287
> 
> 标签：c++, opengl, wxwidgets

我有两个从 wxGLcanvas 派生的类 bGLpanel 和 bGLpanel1，而 bpane 和 bpane1 分别是这两个类的实例我想在两个 wxGLcanvas 上连续渲染（通过两个单独的线程）或者同时渲染两者。怎么做？现在只是第一个（ bpane) 正在我的 App.wxPanel 上呈现，它是 wxNotebook 的一部分。

附加信息：

wiki.wxwidgets.org/Using_wxImage_to_load_textures_for_OpenGL 我正在使用此链接中给出的示例 我正在制作两个不同的类，因为需要打开两个完全不同的流，因此有两种不同的渲染方法，我不知道如何使用它进行替代渲染例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:43:36.767

从两个不同的线程更新您的显示器将不起作用。wxWidgets 只会从一个主线程更新显示。如果你尝试，讨厌的、意想不到的事情就会发生。

但是，如果您有两个 wxGLCanvas 小部件，那么您可以在刷新请求后依次渲染每个小部件，它看起来会很好。

你有两个选择：

1.  每次刷新时更新一个画布，并保留一个标志以便交替完成。

2.  每次刷新时更新两个画布。

您选择哪个几乎无关紧要。我自己猜#2，但尝试两者并看看你喜欢哪个没什么大不了的。

像这样的东西：

```
EVT_PAINT(MyApp::RenderRequest)

void MyApp::RenderRequest( wxPaintEvent& evt )
{
  glPlaneA->Render( evt );
  glPlaneB->Render( evt );
} 
```

# c# - 如何用BingMap计算地图4个角（边）的坐标？

> ID：15256451
> 
> 赞同：2
> 
> 时间：2013-03-06T19:38:12.023
> 
> 标签：c#, geolocation, coordinates, bing-maps

我从几天前开始使用 bing。我可以显示带有我的 bing 地图坐标经度和纬度的图像。

但**我想计算****图像 4 个边缘的**位置坐标。现在我唯一知道的是原点的中心点。问题是我仅限于 API。我为游戏 xna c # 工作，不幸**的是不能使用**微软的 Class Map :-(。http: [//msdn.microsoft.com/en-us/library/hh846504.aspx](http://msdn.microsoft.com/en-us/library/hh846504.aspx)

**我知道以下值：（**样本值）

级别缩放：17

图像宽度：800 像素

图片高度：800 像素

纬度：46.6023

经度：7.0964

是否可以用这5个已知值计算出我图像4个角的坐标？这是一张解释我想要的图。 ![在此处输入图像描述](../Images/9889a1c679435af13091c4a162a96ea3.png) 非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T16:45:28.550

根据 bing maps api 为 17 级缩放给出的比例 1.19 m/pixel，这给了我们 800 * 1.19 = 95'000 米的边缘（[http://msdn.microsoft.com/en-us/library/aa940990。 .aspx](http://msdn.microsoft.com/en-us/library/aa940990.aspx) )

您应该可以这样计算：（算法：[https](https://gis.stackexchange.com/questions/2951/algorithm-for-offsetting-a-latitude-longitude-by-some-amount-of-meters) ://gis.stackexchange.com/questions/2951/algorithm-for-offsetting-a-latitude-longitude-by-some-amount-of-meters ）

```
 //Position, decimal degrees
 lat = 46.6023
 lon = 7.0964

 //Earth’s radius, sphere
 R=6378137

 // DO THE SAME FOR B C D

 //offsets in meters for A
 dn = -47600
 de = -47600

 //Coordinate offsets in radians
 dLat = dn/R                      // -0.0074629942881440144669203562106
 dLon = de/(R*Cos(Pi*lat/180))    // -0.00746374633301685016002447644032

 //OffsetPosition, decimal degrees
 latA = lat + dLat * 180/Pi // 46.174701924759107796879309401922
 lonA = lon + dLon * 180/Pi // 6.6687588357618898589751458712973 
```

这使用简化的平面地球计算，这不是最准确的方法，但应该满足您的需要。

# ios6 - iPhone 5 屏幕大小黑条

> ID：15256453
> 
> 赞同：2
> 
> 时间：2013-03-06T19:38:16.537
> 
> 标签：ios6, xcode4.5, iphone-5, iphone-4, screen-size

我在使我的 iPhone 4（3.5 英寸屏幕）在 iPhone 5 屏幕上工作时遇到问题。我已经尝试为启动图像导入 Default-568h@2x.png 图像，它在模拟器中正常工作，并且在真实设备上运行时，屏幕顶部和底部都有黑条。有没有人有类似的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T08:16:27.347

所有不包含 Default-568h@2x.png 文件的应用程序都显示在一个信框中。包含 Default-568h@2x.png 将使您的应用程序在 4 英寸视网膜设备上填满屏幕。

希望这能解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T14:57:08.760

您可以在模拟器本身中测试此问题。对此有两种可能的解决方案。下面列出：

1.  在`UIVIew`'s attributes 检查器的 'Simulated Metrics' 部分中，您可以选择 3,5" 或 4" 尺寸。选择 3,5"，并使您的视图和子视图可调整大小。这将使其自动缩放您的视图以适应 iPhone 5 的屏幕。

2.或者您可以使用**自动布局**（约束）和iOS 6+的部署目标。

希望这能解决问题。

# ios - 按名称搜索核心数据用户

> ID：15256454
> 
> 赞同：0
> 
> 时间：2013-03-06T19:38:18.527
> 
> 标签：ios, objective-c, search, core-data

我正在尝试获取从 tableview 中选择名称并存储在所选数组中的用户列表。

我的代码有什么问题？抱歉，这是我第一次使用 CoreData，所以我真的不知道出了什么问题。

```
NSFetchRequest *request= [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"AUser"   inManagedObjectContext:_managedObjectContext];
for (id a in selected) {
   NSPredicate *predicate =[NSPredicate predicateWithFormat:@"name==%@",a]; //each user has a name attribute
   [request setEntity:entity];
   [request setPredicate:predicate];

   NSError *error = nil;

   NSArray *array = [_managedObjectContext executeFetchRequest:request error:&error];
   //This array is always empty! Why? What am I doing wrong with the request
} 
```

如果您需要更多信息/进一步解释，请告诉我。

其他需要注意的事项 - 没有警告/错误迹象 - 所有未在此处声明的变量都在其他地方声明

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:55:22.933

由于您没有收到任何错误响应，因此空数组意味着获取成功完成，但它没有找到任何满足您的谓词的东西。在您的代码中，这意味着`selected`不包含`name`可以在您的数据存储中找到的值。

您的代码似乎假设这是一个与您的某些存储对象的值匹配的 s`selected`数组。如果不是这种情况——如果它包含其他东西，那么可能——一个空集是可以预期的。被宣布为 an的事实让我想知道那里到底有什么。`NSString``name``NSString``a``id`

# python - Python指令计数

> ID：15256458
> 
> 赞同：2
> 
> 时间：2013-03-06T19:38:25.133
> 
> 标签：python, instructions

是否有可能有一些函数在函数中的每条指令上运行一个计数器，并且如果达到一个数字会做一些行为？

解释一下，如果一个函数最终占用了虚拟机中一定数量的字节码指令，我希望能够引发异常。因此，如果有人创建了一个列表推导式，它会产生一个无限循环，或者创建一个无限 while 循环，它会提前强制中断。

这可以在 Python 中完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:40:25.617

我对此表示怀疑。通常，唯一可靠的方法是在单独的进程中运行不受信任的代码，并适当地沙盒。

考虑一下如果不受信任的代码获得了一些关键资源（例如锁），然后因为花费太长时间而被杀死，会发生什么情况。如果有人试图获取相同的锁，整个过程将陷入僵局。

# sql-server-2008 - with(updlock) 会减少选择查询中的死锁吗？

> ID：15256462
> 
> 赞同：2
> 
> 时间：2013-03-06T19:38:33.630
> 
> 标签：sql-server-2008, deadlock, locks, query-hints

我们的 SQL Server 2008 DB（正常隔离级别）中有同时写入和读取的表。

一位同事想知道在针对该表的选择查询上使用（updlock）的查询提示是否会减少死锁，但我不太确定该怎么做。

我在想，如果正常的共享读锁会导致超时，那么在这种情况下，更新锁肯定也会导致死锁吗？！还是我错过了什么？

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-06T00:43:59.473

更新锁与共享锁不兼容，因此在某些情况下基本上可以同时运行更少的 SELECT 语句。我相信这对您的问题没有帮助。

您是否考虑过打开 Read Committed Snapshot (RCSI) 数据库选项？这是您首先要在测试环境中测试的内容。它给 tempdb 带来了一些用于版本存储的开销，但由于 RSCI 的乐观锁定，您的数据库吞吐量应该会更高。

# android - 在 Android 中登录过程后 Facebook 会议关闭

> ID：15256467
> 
> 赞同：1
> 
> 时间：2013-03-06T19:38:52.933
> 
> 标签：android, facebook, session, login

我正在开发需要 facebook 登录才能发布 facebook 评论的 android 应用程序。但是我一直无法登录。所以我按照[https://developers.facebook.com/docs/tutorials/androidsdk/3.0/scrumptious/authenticate/](https://developers.facebook.com/docs/tutorials/androidsdk/3.0/scrumptious/authenticate/)上的教程进行操作，但我得到了 state.isCloced() == true登录后（facebook登录按钮也不会更改它的注销文本）。我看不出它不起作用的任何原因。谁能帮我？

参考教程我有片段：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
<com.facebook.widget.LoginButton
    android:id="@+id/login_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"
    android:layout_marginBottom="30dp"
    android:layout_marginTop="30dp" />
</LinearLayout> 
```

在我的 MainActivity 中：

```
 private UiLifecycleHelper uiHelper;
private Session.StatusCallback callback = new Session.StatusCallback() {
    @Override
    public void call(Session session, SessionState state, Exception exception)                 {
        onSessionStateChange(session, state, exception);
    }
};

    @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    uiHelper = new UiLifecycleHelper(this, callback);
    uiHelper.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);
}

private void onSessionStateChange(Session session, SessionState state, Exception exception) {
    if (state.isOpened()) {
        Log.i("FacebookFragment", "State is opened");
    } else if (state.isClosed()) {
        Log.i("FacebookFragment", "State is closed");
    }
}

@Override
public void onResume() {
    super.onResume();
    uiHelper.onResume();
}

@Override
public void onPause() {
    super.onPause();
    uiHelper.onPause();
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    uiHelper.onActivityResult(requestCode, resultCode, data);
}

@Override
public void onDestroy() {
    super.onDestroy();
    uiHelper.onDestroy();
}

@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    uiHelper.onSaveInstanceState(outState);
} 
```

单击LoginButton后，弹出fb权限对话框，单击确定，然后看到圆形进度条，然后再次看到登录按钮。在 LogCat 中，状态仍然是关闭的 :(

难道我做错了什么？或者可能是因为带有 loginButton 的 Fragment 嵌套在另一个 Fragment 中？

我正在安装了 android 4、本机 FB 应用程序的设备上进行测试。

谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T12:14:04.527

Ok I solved it, based on "remote_app_id does not match stored id" exception i found answer [https://stackoverflow.com/a/14421260/1618316](https://stackoverflow.com/a/14421260/1618316) and printed facebook app id. First I generated app id with command from fb tutorial, but it was different to one printed by answer above. So I put new key at fb and now it works.

But I still wonder how is possible that command from tutorial gave me wrong hash :/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:51:54.927

如果您在片段中使用 LoginButton，则需要从包含片段中调用 loginButton.setFragment，并覆盖该片段中的 onActivityResult 方法。

请参阅此处的教程[https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/](https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/)

# sql - 尝试开发语法以基于第三个表的连接使用另一个表中的值更新一个表

> ID：15256470
> 
> 赞同：2
> 
> 时间：2013-03-06T19:39:11.430
> 
> 标签：sql, oracle, oracle11g

下面的测试用例显示了表的构造。我需要`tab_1`根据`tab_2`和上的连接来更新地址数据`_3`。显示的更新脚本返回**'missing right parenthesis'**，我确信它指向语法错误。在获得正确更新基表的语句方面提供任何帮助或指导。

```
create table tab_1(address varchar2(25), city varchar2(25), state varchar2(2),zip varchar2(10), office_id varchar2(25));

create table tab_2 (company varchar2(25), office varchar2(25), address_id varchar2(5), office_id varchar2(5));

create table tab_3 (address_id varchar2(5), address varchar2(25), city varchar2(25), state varchar2(2),zip varchar2(10));

insert into tab_1(office_id) values(46);

insert into tab_2(company, office, address_id, office_id) 
    values('Stone', 'north', '45', '15');
insert into tab_3(address_id, address, city, state, zip) 
    values('15', '12Main', 'York', 'NY', '12345');

ALTER TABLE TAB_1 ADD 
CONSTRAINT tab_1_PK
 PRIMARY KEY (OFFICE_ID)
 ENABLE
 VALIDATE;

 ALTER TABLE TAB_2 ADD 
CONSTRAINT tab_2_PK
 PRIMARY KEY (OFFICE_ID)
 ENABLE
 VALIDATE;

ALTER TABLE TAB_3 ADD 
CONSTRAINT tab_3_PK
 PRIMARY KEY (ADDRESS_ID)
 ENABLE
 VALIDATE;

update (select tab_3.address, tab_3.city, tab_3.state, tab_3.zip, tab_1.address,     tab_1.city, tab_1.state, tab_1.zip
        FROM
    INNER JOIN tab_1 ON (tab_1.office_id=tab_2.office.id) 
    INNER JOIN tab_3 ON (tab_2.address_id = tab_3.address_id))
        SET tab_1.address=tab_3.address, tab_1.city=tab_3.city, tab_1.state=tab_3.state, tab_1.zip=tab_3.zip;

UPDATE ( SELECT src.x src_x, src.y src_y , tgt.x tgt_x, tgt.y tgt_y FROM src 
INNER JOIN tgt ON ( src.id = tgt.id ) ) SET tgt_x = src_x , tgt_y = src_y

*******************************************************

UPDATE tab_1
   SET (address,
        city,
        state,
        zip) =
          (SELECT (address, city, state, zip)
             FROM tab_3, tab2
            WHERE     tab_1.office_id = tab_2.office_id
                  AND tab_2.address_id = tab_3.address_id); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:57:28.733

您的前两个`update`语句不完整-它们甚至没有指定要更新的表。它们相距甚远，恐怕我会忽略它们，因为我看不出它们是如何可挽救的 *8-)

您的第三个作为额外的括号；您在子查询中选择的列列表周围不需要它们（并且它们无效），它试图将其解释为不存在的进一步子查询。您在其中一个表名中也有错字：

```
UPDATE tab_1
   SET (address, city, state, zip) =
       (SELECT address, city, state, zip
          FROM tab_3, tab_2
         WHERE tab_1.office_id = tab_2.office_id
           AND tab_2.address_id = tab_3.address_id); 
```

我建议您使用现代`join`语法，特别是如果这是相当新的语法并且您还没有学会（可以说）坏习惯：

```
UPDATE tab_1
   SET (address, city, state, zip) =
       (SELECT address, city, state, zip
          FROM tab_2
          JOIN tab_3
            ON tab_3.address_id = tab_2.address_id
         WHERE tab_2.office_id = tab_1.office_id); 
```

# haskell - Haskell 中的嵌套控制结构

> ID：15256471
> 
> 赞同：1
> 
> 时间：2013-03-06T19:39:16.357
> 
> 标签：haskell, if-statement

有没有办法创建嵌套的控制结构？例如我试过这个。但我得到了错误。

```
bmiTell :: (RealFloat a) => a -> String  

bmiTell bmi  = if bmi <= 18.5  then if bmi==16.0 then "asdasdasdsad"
           else if bmi <= 25.0 then "You're supposedly normal. Pffft, I bet  you're ugly!"  
           else if bmi <= 30.0 then "You're fat! Lose some weight, fatty!"  
           else    "You're a whale, congratulations!" 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-06T19:44:24.463

`if`表达式被解析为

```
if bmi <= 18.5   -- no else!
  then if bmi==16.0
         then "asdasdasdsad"
         else if bmi <= 25.0
                then "You're supposedly normal. Pffft, I bet  you're ugly!"  
                else if bmi <= 30.0
                       then "You're fat! Lose some weight, fatty!"  
                       else "You're a whale, congratulations!" 
```

请注意，第一个`if`有`then`分支但没有`else`分支。

**在 Haskell 中，每个`if`表达式都必须有一个`then`分支*和*一个`else`分支。所以这是你的问题。**

我赞同 bchurchill 关于使用守卫而不是嵌套`if`表达式的建议。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-06T19:43:18.600

是的，您只需要正确缩进即可。ghc 可能也不喜欢被告知它很胖。在任何一种情况下，缩进决定了哪些分支对应于哪些语句，我可能有点搞乱了顺序：

```
bmiTell bmi  = if bmi <= 18.5  
               then if bmi==16.0 
                    then "asdasdasdsad"
                    else if bmi <= 25.0 
                         then "You're supposedly normal. Pffft, I bet  you're ugly!"  
                         else if bmi <= 30.0 
                              then "You're fat! Lose some weight, fatty!"  
                              else    "You're a whale, congratulations!"  
               else "foobar" 
```

更好的方法是使用受保护的条件，例如

```
bmiTell bmi
  | bmi < 18.5 = "foo"
  | bmi < 25.0 = "bar"
  | bmi < 30.0 = "buzz" 
```

# ruby-on-rails - ActionMailer Observer 中的 Message.body 为空

> ID：15256472
> 
> 赞同：2
> 
> 时间：2013-03-06T19:39:17.403
> 
> 标签：ruby-on-rails, actionmailer, observers

我正在使用观察者记录传出的电子邮件；它可以正确触发，但是当我尝试提取电子邮件正文时，我得到一个空字符串。电子邮件绝对不是空白的，并且肯定会创建日志记录。断点和检查`message.body`确认它是一个空字符串。

```
class MailObserver
  def self.delivered_email(message)
    for address in message.to
      user = User.find_by_email(address)
      if user
        UserMailerLogging.create!(user_id: user.id, email_type: message.subject, 
                                  contents: message.body, sent_at: Time.now)
      end
    end
  end
end

ActionMailer::Base.register_observer(MailObserver) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:15:09.820

在 Rails 3 中，电子邮件是使用[Mail](https://github.com/mikel/mail) gem 构建和发送的。根据他们的文档

```
message.text_part # plaintext version
message.html_part # html version 
```

您还可以更进一步，具体取决于您的电子邮件是否是多部分的。

```
message.text_part.body.decoded 
```

[SO](https://stackoverflow.com/questions/4868205/rails-mail-getting-the-body-as-plain-text)上的这个问题也可能很重要。

# javascript - 获取工具提示以处理我的实际 jquery 库

> ID：15256475
> 
> 赞同：-2
> 
> 时间：2013-03-06T19:39:24.750
> 
> 标签：javascript, jquery

我没有 JS 技能，我想在我的表单中实现工具提示。

实际上，我可以设法使它与许多已发布的[jQuery 库之一（这个更具体）一起](http://jquerytools.org/demos/tooltip/form.html)工作。

问题是当我添加这些工具提示库时，我的旧 jquery 函数停止工作（切换隐藏/显示等）。当我删除新库时，我的功能恢复工作，工具提示显然停止工作。

我怎样才能将仅工具提示添加到我当前的 JS 库中？

实现我正在寻找的结果的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:42:49.237

我写了一个插件来解决这个问题：[https ://github.com/yckart/jquery.tooltip.js](https://github.com/yckart/jquery.tooltip.js)

这是一个例子，滚动到最后一个，在那里你可以找到forms-demo：http: [//yckart.github.com/jquery.tooltip.js/](http://yckart.github.com/jquery.tooltip.js/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:53:46.360

听起来您在使用工具提示库时引入了一个错误，错误控制台中是否有任何内容（这将是第一个查看的地方），如果是这样，您将需要进行一些调试

使用 jQuery，你真的不需要库/插件来创建工具提示，你只需要几行代码，只是为了让你开始这里是一个基本的例子......

```
jQuery(".toolTipEnable").hover(function(e){
    var offset = jQuery(this).offset();
    jQuery("#toolTip")
        .css({"top":offset.top+40,"left":offset.left+40})
        .text('Tooltip text')
        .show()
},function(e){
    jQuery("#toolTip").hide()
}) 
```

绝对位置的空 div 在哪里

还有更多示例，例如[此处](http://www.mkyong.com/jquery/how-to-create-a-tooltips-with-jquery/)将详细向您展示如何操作

# .net - 使用 AT 命令未从 GSM 调制解调器获得响应

> ID：15256479
> 
> 赞同：0
> 
> 时间：2013-03-06T19:39:31.757
> 
> 标签：.net, c#-4.0, serial-port, gsm, at-command

我正在用 C# 学习 AT 命令。

```
public static void Main(string[] args)
    {

        String command = "AT";
        SerialPort serialPort = new SerialPort
                                    {
                                        PortName = "COM4",
                                        BaudRate = 9600,
                                        DataBits = 8,
                                        Parity = Parity.None,
                                        ReadTimeout = 300,
                                        WriteTimeout = 300,
                                        StopBits = StopBits.One,
                                        Handshake = Handshake.None
                                    };
        serialPort.Open();
        serialPort.WriteLine(command + "\r");
        String outPut = serialPort.ReadExisting();

        Console.WriteLine(outPut);

    } 
```

我确定**PortName**。我在程序中做错了什么？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:43:56.117

很难说这是否是您唯一的问题，但[`SerialPort.ReadExisting()`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.readexisting.aspx)只读取*立即*可用的数据（即在流和缓冲区中）。

您的程序将数据写入调制解调器，并`ReadExisting()`立即调用。`ReadExisting`将在没有可用数据的情况下立即返回，因为调制解调器没有时间响应。

# asp.net-mvc - jquery表单提交成功和失败回调

> ID：15256484
> 
> 赞同：2
> 
> 时间：2013-03-06T19:40:15.100
> 
> 标签：asp.net-mvc, jquery, razor

我正在构建一个 ASP.Net Mvc 4 应用程序。我看到我可以使用 @Ajax.BeginForm 异步执行 POST 请求。API 似乎也有一个 OnSuccess 和 On Failure 参数，它接受在成功/失败时执行的 javascript 函数。我读过这适用于 MS Ajax，但这也适用于 jquery 吗？我似乎无法单独使用 jquery

```
@using (Ajax.BeginForm("Create", "Comment", null, new AjaxOptions
                                                       {
                                                           InsertionMode = InsertionMode.Replace,
                                                           HttpMethod = "Post",
                                                           OnSuccess = "people.successfulSave",
                                                           OnFailure = "people.saveFailure"
                                                       }, 
```

如果没有，我想通过表单提交用 jquery 来做。目前我正在做

```
$('#commentSubmitInput').click(function() {
        $("#commentForm").submit();
    } 
```

提交表格。但是在我的控制器中，我正在做一些模型验证，如果模型无效，则返回带有模型错误的 Html，否则返回带有更新 html 的部分视图。现在我读到我可以将 ajax 调用绑定到具有以下语法的函数

```
$("#commentForm").bind('ajax:complete', function () {
        alert('bla');
    }); 
```

但是，有没有办法可以让表单提交成功和失败回调？有点像 Jquery ajax 调用语法

```
$.ajax({
            url: $(this).attr('ajaxUrl'),
            type: 'POST',
            success: function (data) {                   
                $("#comment_" + data.Id).remove();
            },
            error: function (data) {
                window.location.reload();
            }
        }); 
```

任何帮助/建议表示赞赏。

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T07:00:15.813

据我所知，您可以检查一下：[ASP.NET MVC 4 - Ajax.BeginForm and html5](https://stackoverflow.com/questions/12512417/asp-net-mvc-4-ajax-beginform-and-html5)

也许这个（你可以在这里得到一两个想法）：[MVC4 - Ajax.BeginForm and Partial view give 'undefined'](https://stackoverflow.com/questions/11036942/mvc4-ajax-beginform-and-partial-view-gives-undefined)

# performance - 在 DataTable 中过滤数据：多个查询与 DataView

> ID：15256492
> 
> 赞同：0
> 
> 时间：2013-03-06T19:40:41.070
> 
> 标签：performance, google-visualization

我正在使用 Google 图表，在本例中是 Google ColumnChart。我的项目是从数据库中获取数据并将其放入[ColumnChart](https://developers.google.com/chart/interactive/docs/gallery/columnchart)。数据加载到[DataTable](https://developers.google.com/chart/interactive/docs/reference#dataparam)后，可以过滤数据。

例如：用户希望数据仅来自 2012 年，而不是从 2010 年到 2013 年。

现在我有两个选择：

1.  执行一次数据库查询以获取所有数据并使用 DataView 对其进行过滤。使用此 DataView，可以显示一部分 DataTable。因此，每次用户更改过滤器选项时，都会根据过滤器选项创建一个新的 DataView。

2.  每次用户更改过滤器选项时执行新的数据库查询。可以使用结果创建一个新的 DataTable。

选项一中的查询将返回大约 2000 行，每行大约有 20 个值，大约有 50 个用户同时请求该页面。大约有 50 个过滤器选项可用。

哪个选择的性能最好？

如果选择一个是最好的，那么内存使用情况如何？

简而言之，最好的选择是什么？

如果还有其他可用的选项，请告诉我。

提前致谢

# apache - mod重写两个单独的文件夹

> ID：15256493
> 
> 赞同：0
> 
> 时间：2013-03-06T19:40:42.327
> 
> 标签：apache, mod-rewrite

我有一个脚本可以创建一个漂亮的文件夹目录列表。我称它为mydrive。我有两个素材，公共的和私人的，我在重新路由具有漂亮网址的人时遇到了问题。

放置在 /mydrive/public/folder1 中的文件被调用： /mydrive/files/mydrive.cgi?path=public/folder1

放置在 /mydrive/private/folder1 中的文件被调用： /mydrive/files/mydrive.cgi?path=private/folder1

我希望它像这样工作：

URL：www.domain.com/mydrive/folder1 调用：/mydrive/files/mydrive.cgi?path=public/folder1

URL：www.domain.com/mydrive/private/folder1 调用：/mydrive/files/mydrive.cgi?path=private/folder1

我已经尝试了几个食谱，但无法让它发挥作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:57:55.440

```
RewriteEngine On

RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
RewriteRule ^/mydrive/(private/.*)$ /mydrive/files/mydrive.cgi?path=$1 [PT,L]

RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
RewriteRule ^/mydrive/(.*)$ /mydrive/files/mydrive.cgi?path=public/$1 [PT,L] 
```

如果你把它放在你的虚拟服务器配置中，应该可以解决问题。

# primefaces - p:galleria 注册后不显示，但是直接yes

> ID：15256502
> 
> 赞同：0
> 
> 时间：2013-03-06T19:41:07.370
> 
> 标签：primefaces, jsf-2, galleria

登录后，我试图在新的 xhtml 中在 primefaces Galleria 中显示一些图片，但没有任何反应。

这是“sing in”页面（index.xhtml，“Bejelentkezés”在匈牙利语中的意思是“登录”）：

![索引.xhtml](../Images/b27998b10f9ead068aaf1d1578345032.png)

当我用“viktor”（用户名和密码）填充文本时，它会导航到“home.xhtml”，这将显示向上的画廊，中间的图片名称和下面的一张图片。但我得到了这个：

![没有画廊](../Images/6f1c25014bdf2b8da7df32d47bb7a84a.png)

如果我在浏览器中写入“localhost:8080/Primefaces_test1/home.xhtml”，回车，看到奇迹，我得到了：

![在此处输入图像描述](../Images/d097b476f4d81b154bc753faf911245b.png)

如您所见，图片的名称每次都在那里。怎么可能？我的 home.xhtml：

![画廊](../Images/b6029180e1221a0452b2f1dafef6d472.png)

GalleriaBean.java:

```
@ManagedBean(name = "galleriaBean")
@SessionScoped
public class GalleriaBean {

    private List<String> images;
    private String image;

    @PostConstruct  
    public void init() {
        images = new ArrayList<>();
        for(int i=1; i<=6; i++) {
            images.add(i+".jpg");
        }
        image = images.get(0);
    }

    public List<String> getImages() {
        return images;
    }

    public void setImages(List<String> images) {
        this.images = images;
    }

    public String getImage() {
        return image;
    }

    public void setImage(String image) {
        this.image = image;
    }

} 
```

该项目：

![项目](../Images/106dddab7b8508c2fd83763c77268b7b.png)

有任何想法吗？

还有一个问题。为什么画廊里的图片尺寸不合适，就像下面那张孤独的图片一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-07T13:17:06.143

尝试在 p:commandButton 元素中设置 ajax="false"。

# java - 每分钟关闭并重新打开 Java 窗口

> ID：15256504
> 
> 赞同：0
> 
> 时间：2013-03-06T19:41:13.610
> 
> 标签：java, awt, jfreechart

我正在开发一个使用 Java 和 JFreeChart 的应用程序。在我的主要我想使用计时器来关闭类的窗口/对象并创建一个新的对象和类的窗口。JFreeChart 的动态功能似乎不适用于我正在使用的 API，这是我可以给图形带来动态感觉的唯一方法。

下面的代码是我目前的主要代码，但它所做的只是打开一个窗口，然后关闭它并在一分钟后打开一个新窗口。显然，很清楚为什么会发生这种情况，但我似乎想不出一个好的方法来让它在计时器内创建和删除所有对象。

```
 public static void main(final String[] args) throws Exception {
    Scanner in = new Scanner(System.in);
    final String host = "";
    final String username = "";
    final String password = "";
    final String id = "testStream"; 

    final GraphStream demo = new GraphStream("Dia Example graph", host, username, password, id);
    demo.pack();
    RefineryUtilities.centerFrameOnScreen(demo);
    demo.setVisible(true);
    new java.util.Timer().schedule( 
            new java.util.TimerTask() {
                @Override
                public void run() {
                    demo.setVisible(false);
                    demo.dispose();
                    try {
                        final GraphStream demo2 =new GraphStream("Dia Example graph", host, username, password, id);
                        demo2.pack();
                        RefineryUtilities.centerFrameOnScreen(demo2);
                        demo2.setVisible(true);
                    } catch (DataServiceException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                }
            }, 
            60000); 
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:56:41.277

我建议将构造函数拆分为极简构造函数和刷新方法：

```
public static void main(final String[] args) throws Exception {
   final String host = "";
   final String username = "";
   final String password = "";
   final String id = "testStream"; 
   final GraphStream demo = new GraphStream( "Dia Example graph" );
   new java.util.Timer().schedule( 
      new java.util.TimerTask() {
         @Override
         public void run() {
            demo.refresh( host, username, password, id );
            demo.pack();
            RefineryUtilities.centerFrameOnScreen(demo);
            demo.setVisible( true );
         }
      }, 
      0, 60000); 
} 
```

[如您所见， timer.schedule()](http://docs.oracle.com/javase/7/docs/api/java/util/Timer.html#schedule%28java.util.TimerTask,%20long,%20long%29)可能有 3 个参数可以立即启动。

# python - 从项目中解析类和函数依赖项

> ID：15256509
> 
> 赞同：4
> 
> 时间：2013-03-06T19:41:40.300
> 
> 标签：python, regex, python-2.6

我正在尝试对 Python 代码库中的类和函数依赖项进行一些分析。`csv`我的第一步是使用 Python 的模块和正则表达式创建一个用于导入 Excel 的 .csv 文件。

我所拥有的当前版本如下所示：

```
import re
import os
import csv 
from os.path import join

class ClassParser(object):
   class_expr = re.compile(r'class (.+?)(?:\((.+?)\))?:')                                                                                                                                                                                    
   python_file_expr = re.compile(r'^\w+[.]py$')

   def findAllClasses(self, python_file):
      """ Read in a python file and return all the class names
      """
      with open(python_file) as infile:
         everything = infile.read()
         class_names = ClassParser.class_expr.findall(everything)
         return class_names

   def findAllPythonFiles(self, directory):
      """ Find all the python files starting from a top level directory
      """
      python_files = []
      for root, dirs, files in os.walk(directory):
         for file in files:
            if ClassParser.python_file_expr.match(file):
               python_files.append(join(root,file))
      return python_files

   def parse(self, directory, output_directory="classes.csv"):
      """ Parse the directory and spit out a csv file
      """
      with open(output_directory,'w') as csv_file:
         writer = csv.writer(csv_file)
         python_files = self.findAllPythonFiles(directory)
         for file in python_files:
            classes = self.findAllClasses(file)
            for classname in classes:
               writer.writerow([classname[0], classname[1], file])

if __name__=="__main__":
   parser = ClassParser()
   parser.parse("/path/to/my/project/main/directory") 
```

这会生成格式为 .csv 的输出：

```
class name, inherited classes (also comma separated), file
class name, inherited classes (also comma separated), file
... etc. ... 
```

除了类名之外，我还想开始解析函数声明和定义。我的问题：*有没有更好的方法来获取类名、继承的类名、函数名、参数名等？*

注意：我考虑过使用 Python`ast`模块，但我没有使用它的经验，也不知道如何使用它来获取所需的信息，或者它是否可以做到这一点。

编辑：**响应 Martin Thurau 的更多信息请求**——我试图解决这个问题的原因是因为我继承了一个相当长的（100k+ 行）项目，它的模块、类和函数没有明显的结构；它们都作为文件集合存在于单个源目录中。

一些源文件包含几十个相切相关的类，并且有 10k+ 行长，这使得它们难以维护。我开始使用[The Hitchhiker's Guide to Packaging](http://docs.python-guide.org/en/latest/shipping/packaging/)作为基础，分析将每个课程打包成更具凝聚力的结构的相对难度。我关心的部分分析是一个类与其文件中的其他类是如何交织在一起的，以及特定类依赖于哪些导入或继承的类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T10:38:21.837

我已经开始实施这一点。将以下代码放入文件中并运行它，传递文件或目录的名称进行分析。它将打印出它找到的所有类、找到它的文件以及类的基础。它并不智能，因此如果您`Foo`在代码库中定义了两个类，它不会告诉您正在使用哪个类，但这是一个开始。

此代码使用 python`ast`模块检查`.py`文件，并找到所有`ClassDef`节点。然后它使用这个[`meta`包](https://github.com/srossross/Meta/)来打印它们的一部分——你需要安装这个包。

```
$ pip install -e git+https://github.com/srossross/Meta.git#egg=meta 
```

示例输出，针对[django-featured-item](https://bitbucket.org/tim_heap/django-featured-item)运行：

```
$ python class-finder.py /path/to/django-featured-item/featureditem/
FeaturedField,../django-featured-item/featureditem/fields.py,models.BooleanField
SingleFeature,../django-featured-item/featureditem/tests.py,models.Model
MultipleFeature,../django-featured-item/featureditem/tests.py,models.Model
Author,../django-featured-item/featureditem/tests.py,models.Model
Book,../django-featured-item/featureditem/tests.py,models.Model
FeaturedField,../django-featured-item/featureditem/tests.py,TestCase 
```

编码：

```
# class-finder.py
import ast
import csv
import meta
import os
import sys

def find_classes(node, in_file):
    if isinstance(node, ast.ClassDef):
        yield (node, in_file)

    if hasattr(node, 'body'):
        for child in node.body:
            # `yield from find_classes(child)` in Python 3.x
            for x in find_classes(child, in_file): yield x

def print_classes(classes, out):
    writer = csv.writer(out)
    for cls, in_file in classes:
        writer.writerow([cls.name, in_file] +
            [meta.asttools.dump_python_source(base).strip()
                for base in cls.bases])

def process_file(file_path):
    root = ast.parse(open(file_path, 'r').read(), file_path)
    for cls in find_classes(root, file_path):
        yield cls

def process_directory(dir_path):
    for entry in os.listdir(dir_path):
        for cls in process_file_or_directory(os.path.join(dir_path, entry)):
            yield cls

def process_file_or_directory(file_or_directory):
    if os.path.isdir(file_or_directory):
        return process_directory(file_or_directory)
    elif file_or_directory.endswith('.py'):
        return process_file(file_or_directory)
    else:
        return []

if __name__ == '__main__':
    classes = process_file_or_directory(sys.argv[1])
    print_classes(classes, sys.stdout) 
```

# javascript - javascript/jquery 更改 location.href

> ID：15256514
> 
> 赞同：3
> 
> 时间：2013-03-06T19:41:49.490
> 
> 标签：javascript, window.location, submit-button

这是我的 HTML

```
 <form id="procurar-novo">
          <input type="text" name="procurar" placeholder="Pesquisar no Site" value="">
          <input id="procurar-submit" type="button" value="&rsaquo;">
        </form> 
```

这是我的 jQuery

```
<script type="text/javascript">
  $(document).ready(function(){
    $('#procurar').submit(function(e) {
      e.preventDefault();
      //edited
      window.open = ('http://www.psicotropicus.org/'+'/busca'+encodeURIComponent($('#procurar-submit').val()), '_blank');
      return false;
    });
  });
</script> 
```

想法是通过单击提交，javascript/jquery 将获取#procurar-submit 值并将其添加到 URL 并重定向用户。

_blank 仍然不起作用

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:45:48.440

使用带有第二个参数 _blank 的 window.open

```
window.open('url', '_blank'); 
```

也试试这个：

```
<script type="text/javascript">
  $(document).ready(function(){
    $('#procurar').submit(function(e) {
      e.preventDefault();
      //edited
      window.open = ('http://www.psicotropicus.org/'+'/busca'+encodeURIComponent($('#procurar-submit').val()), '_blank');
      return false;
    });
  });
</script> 
```

最后编辑：

```
<script>
  $(document).ready(function(){
    $('form#procurar-novo').submit(function(e) {
      //e.preventDefault();
      //edited
      var url = 'http://www.psicotropicus.org'+'/busca'+ encodeURIComponent('&' + $('input[name=procurar]').val());
       window.open(url, '_blank');
      return false;
    });
  });
</script>

<form id="procurar-novo">
          <input type="text" name="procurar" placeholder="Pesquisar no Site" value="">
          <input id="submitsss" type="submit" value="&rsaquo;">
</form> 
```

**请考虑表单元素的名称和 ID :)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:54:14.160

看起来您没有在表单标签上指定操作。为什么不将第二个输入元素从 更改`type=submit`为`type=button`。然后，您可以在该按钮上绑定一个单击事件，并完全控制接下来会发生什么。您不必担心会阻止默认提交操作。您可以执行以下操作：

```
$(document).ready(function(){
  $(document).on('click', '#procurar-submit', function() {
    window.location.href = 'http://www.psicotropicus.org/busca'+$('input[name="procurar"]').val();
  });
}); 
```

要在“_blank”上打开一个新窗口，您可以将代码更改为：

```
$(document).ready(function(){
  $(document).on('click', '#procurar-submit', function() {
    window.open('http://www.psicotropicus.org/busca'+$(input[name="procurar"]).val(), '_blank');
  });
}); 
```

但要小心弹出窗口拦截器

**编辑** 我更改了获取文本字段值的选择器。我可能会在该文本字段上添加一个类或 ID，以便可以将其与其他字段区分开来。看到这个[小提琴](http://jsfiddle.net/TN4CB/1/)

# variables - 多重分配如何工作？

> ID：15256516
> 
> 赞同：5
> 
> 时间：2013-03-06T19:41:57.457
> 
> 标签：variables, lua, variable-assignment

来自[Lua 编程的第 4.1 节](http://www.lua.org/pil/4.1.html)。

> 在多重赋值中，Lua 首先计算所有值，然后才执行赋值。因此，我们可以使用多重赋值来交换两个值，如
> 
> x, y = y, x -- 交换`x' for`y'

任务实际上是如何工作的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-06T20:00:53.113

如何实现多重赋值取决于您使用的 Lua 实现。只要保留语义，实现就可以随意做任何事情。也就是说，无论事情如何实现，您都应该得到相同的结果，就像在将它们分配给 LHS 之前将所有值保存在 RHS 中一样，正如 Lua 书所解释的那样。

* * *

如果您仍然对实际实现感到好奇，您可以做的一件事是查看为某个程序生成的字节码是什么。例如，采取以下程序

```
local x,y = 10, 11
x,y = y,x 
```

并将其传递给`luac -l`Lua 5.2 的字节码编译器 ( ) 给出

```
main <lop.lua:0,0> (6 instructions at 0x9b36b50)
0+ params, 3 slots, 1 upvalue, 2 locals, 2 constants, 0 functions
    1   [1] LOADK       0 -1    ; 10
    2   [1] LOADK       1 -2    ; 11
    3   [2] MOVE        2 1
    4   [2] MOVE        1 0
    5   [2] MOVE        0 2
    6   [2] RETURN      0 1 
```

MOVE 操作码将右侧寄存器中的值分配给左侧寄存器（有关更多详细信息，请参见 Lua 源代码中的 lopcodes.h）。显然，正在发生的事情是寄存器 0 和 1 被用于`x`和`y`插槽 2 被用作临时额外插槽。`x`并`y`在前两个操作码中使用常量进行初始化，在接下来的三个 3 个操作码中，使用“临时”第二个插槽执行交换，有点像您手动执行的操作：

```
tmp = y -- MOVE 2 1
y = x   -- MOVE 1 0
x = tmp -- MOVE 0 2 
```

鉴于 Lua 在进行交换赋值和静态初始化时如何使用不同的方法，如果您为不同类型的多个赋值得到不同的结果，我不会感到惊讶（设置表字段可能看起来非常不同，特别是从那时起由于元方法，顺序应该很重要......）。我们需要在源代码中找到发出字节码的部分，以便 100% 确定。正如我之前提到的，所有这些都可能在 Lua 版本和实现之间有所不同，特别是如果您查看 LuaJIT 与 PUC Lua。

# java - Android：AdMob 的问题

> ID：15256521
> 
> 赞同：0
> 
> 时间：2013-03-06T19:42:09.743
> 
> 标签：java, android, admob

我添加到我的应用 AdMob 中。

```
 @Override
public void onResume()
{
    super.onResume();

    if(adView == null)
    {
        // Create the adView
        adView = new AdView(this, AdSize.BANNER,LabelsShow.AD_UNIT_ID_GOES_HERE);
        // Lookup your LinearLayout assuming it’s been given
        // the attribute android:id="@+id/mainLayout"
        LinearLayout layout = (LinearLayout)findViewById(R.id.l_eadds);
        // Add the adView to it
        layout.addView(adView);
        // Initiate a generic request to load it with an ad
        adView.loadAd(new AdRequest());
    }
} 
```

xml:

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"

              android:layout_height="fill_parent">

    <LinearLayout
            android:orientation="vertical"
            android:id="@+id/l_eadds"
            android:background="@drawable/bgg"
            android:scrollbars="none"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"/>

    <LinearLayout
            android:orientation="vertical"
            android:layout_width="fill_parent"
            android:layout_height="53dip" android:background="@drawable/bg_fill">
        <TableRow
                android:layout_width="fill_parent"
                android:layout_height="fill_parent">
            <EditText
                    android:layout_width="fill_parent"
                    android:layout_height="47dp"
                    android:text=""
                    android:id="@+id/editText" android:layout_toRightOf="@+id/textView" android:layout_alignParentTop="true"
                    android:layout_marginTop="6dp" android:layout_marginLeft="6dp" android:layout_marginBottom="3dp"
                    android:layout_weight="1"

                    android:drawableLeft="@drawable/e"/>
            <Button
                    android:layout_width="wrap_content"
                    android:layout_height="fill_parent"
                    android:text="@string/search"
                    android:id="@+id/look" android:layout_alignParentLeft="true"
                    android:layout_alignBaseline="@+id/textView" android:layout_marginLeft="6dp"
                    android:minWidth="100dip" android:background="@drawable/btn_no"
                    android:layout_marginRight="6dp" android:layout_marginTop="6dp" android:layout_marginBottom="6dp"/>
        </TableRow>
    </LinearLayout>
    <WebView
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:id="@+id/webView" android:layout_gravity="center"
            android:layout_alignParentBottom="true"

            android:layout_below="@+id/look">
        <requestFocus />
            </WebView>

    <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="E"
            android:id="@+id/textViewik" android:layout_alignParentLeft="true" android:layout_marginLeft="11dp"
            android:layout_alignParentTop="true" android:layout_marginTop="19dp"/>
</LinearLayout> 
```

简而言之：在 Android 4+ 中，我的应用程序中的 admob 有效。但在 Android 2.3 中不起作用。我在 4 部手机上进行了测试。两个4+和两个2.3。在没有横幅的 2.3 活动中（在其他应用程序中，admob 有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T10:35:43.997

我使用不同的策略。

在 xml 中：

```
<com.google.ads.AdView
xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
android:id="@+id/adView"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
app:adSize="BANNER"
app:adUnitId="AD_UNIT_ID_GOES_HERE" >
</com.google.ads.AdView> 
```

在java类中：

```
package com.example.packagename;

     import com.google.ads.AdRequest;
     import com.google.ads.AdView;

     import android.os.Handler;

     public class ClassName extends Activity {

        private AdRequest re;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            setContentView(R.layout.main);
            final AdView adview = (AdView) findViewById(R.id.adView);
            re = new AdRequest();
            adview.loadAd(re);

            final Handler handler = new Handler();
            handler.postDelayed(new Runnable() {
                public void run() {
                    re = new AdRequest();

                    adview.loadAd(re);
                    handler.postDelayed(this, 15000);
                }
            }, 15000);

            --rest of code
        } 
```

希望你可以使用这个。

# unix - 使用 UNIX 命令替换模式

> ID：15256523
> 
> 赞同：1
> 
> 时间：2013-03-06T19:42:31.163
> 
> 标签：unix

我有一些字符串，例如：

样本输入：

```
Also known as temple of the city,
xxx as Pune Banglore as kolkata Delhi India,
as Mumbai India or as Bombay India,
Calcutta,India is now know as Kolkata,India, 
```

从上面我想将**as xxx xxxx xx**转换为**as xxx_xxxx_xx，**并且应该在最后一个**as**之后生效。

上面的示例输出：

```
Also known as temple_of_the_city,
xxx as Pune Banglore as kolkata_Delhi_India,
as Mumbai India or as Bombay_India,
Calcutta,India is now know as Kolkata,India, 
```

**在**最后一行之后不应有空格分隔的字符串。

如果不清楚，请告诉我。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:11:12.557

保罗说得对，这并不是一项简单的任务。这是`sed`我放在一起的解决方案：

```
sed 's/\(.*as \)/\1\n/;h;y/ /_/;G;s/.*\n\(.*\)\n\(.*\)\n.*/\2\1/' file.txt 
```

演示您的数据：

```
$ echo 'Also known as temple of the city,
> xxx as Pune Banglore as kolkata Delhi India,
> as Mumbai India or as Bombay India,
> Calcutta,India is now know as Kolkata,India,' | \
> sed 's/\(.*as \)/\1\n/;h;y/ /_/;G;s/.*\n\(.*\)\n\(.*\)\n.*/\2\1/'
Also known as temple_of_the_city,
xxx as Pune Banglore as kolkata_Delhi_India,
as Mumbai India or as Bombay_India,
Calcutta,India is now know as Kolkata,India, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:05:26.307

我倾向于使用瑞士军用电锯 Perl，但 sed 也是一种选择。在任何一种情况下，您都会看到大量的学习曲线。

您描述的替换可能足够复杂，您最好编写一个脚本而不是尝试将其作为一个衬里来完成。

如果您要编写脚本并且还不了解 Perl，那么只要它具有某种文本模式匹配语法，您就没有理由不选择您选择的脚本语言（python、ruby 等）。

我不知道进行这种复杂模式匹配和替换的简单、浅层学习曲线方法。这是一次性的事情，您只需要进行此更换吗？或者你将来会做类似的复杂模式替换。如果你打算经常这样做，你真的应该花时间学习一些脚本语言，但我不会把我的 Perl 偏见强加给你。只需选择任何似乎可以访问的语言。

# ruby-on-rails-3 - 为什么模型创建不起作用

> ID：15256527
> 
> 赞同：1
> 
> 时间：2013-03-06T19:42:36.223
> 
> 标签：ruby-on-rails-3

一旦产品保存在我的产品控制器中，我正在尝试创建事务日志。出于某种原因，当我尝试保存事务日志时出现错误。产品保存成功。

代码：

```
def create 
  @product = Product.new(params[:product])                                                                                                      

  respond_to do |format|                                                                                                                        
  if @product.save
    ProductTransaction.create(
      :product_id => @product.id,                                                                                                             
      :user_id => current_user.id,                                                                                                            
      :message => "Product created"                                                                                                           
    )                                                                                                                                         

    format.html { 
      redirect_to product_path(@product.id), 
      :flash => { :success => "Product was successfully created." } 
    }                      
    else
      format.html { render action: "new" }                                                                                                      
    end                                                                                                                                         
  end                                                                                                                                           
end 
```

错误：

```
PGError: ERROR:  column "product_id" is of type integer but expression is of type character varying at character 117
HINT:  You will need to rewrite or cast the expression.
: INSERT INTO "product_transactions" ("created_at", "message", "product_id", "updated_at", "user_id") VALUES ($1, $2, $3, $4, $5) RETURNING "id" 
```

我不明白上面的错误。我仔细检查了我的表，product_id 是一个整数。另外，我尝试对数字进行硬编码，以查看是否可以将其保存。那没有用。然后我从 create 函数中删除了所有参数，但仍然出现相同的错误。我什至从头开始重新创建表格，结果相同。ProductTransaction 没有验证要求。我究竟做错了什么？

代码（已删除参数）：

```
def create 
  @product = Product.new(params[:product])                                                                                                      

  respond_to do |format|                                                                                                                        
  if @product.save
    ProductTransaction.create()                                                                                                                                                                                     

    format.html { 
      redirect_to product_path(@product.id), 
      :flash => { :success => "Product was successfully created." } 
    }                      
    else
      format.html { render action: "new" }                                                                                                      
    end                                                                                                                                         
  end                                                                                                                                           
end 
```

产品架构：

```
Product(id:integer, name:string, etc.) 
```

产品交易模式：

```
ProductTransaction(id:integer, user_id:integer, product_id:integer, message:integer) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T20:06:49.707

发现了我的问题。无论出于何种原因，我都必须刷新我的应用程序。

运行以下，它的工作：

```
touch tmp/restart.txt 
```

现在，如果我能把我生命中的那两个小时找回来就好了。:-)

# javascript - 如何使用文档重写段落

> ID：15256529
> 
> 赞同：-3
> 
> 时间：2013-03-06T19:42:43.060
> 
> 标签：javascript, html, forms

```
document.getElementById("txtOutput").value = result; 
```

而不是使用`.value=result`，我可以写点别的，重写到特定的 div 或段落吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:47:09.950

如果你想写一些东西（包括html格式）你可以使用innerHTML，或者如果你只需要文本使用innerText：

**内部HTML**

```
document.getElementById("txtOutput").innerHTML = result 
```

**内部文本**

```
document.getElementById("txtOutput").innerText = result; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:00:15.943

是的你可以。以这个简单的[JsFiddle](http://jsfiddle.net/K8yUW/)为例。

HTML：

```
<div id="me">
    <span>old stuff</span>
</div> 
```

脚本

```
document.getElementById('me').innerHTML = "new stuff"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:44:28.510

你可以使用innerHTML：

```
 document.getElementById("txtOutput").innerHTML = 'some content'; 
```

# javascript - 向 Bootstrap.js 添加自定义函数

> ID：15256530
> 
> 赞同：0
> 
> 时间：2013-03-06T19:42:43.457
> 
> 标签：javascript, plugins, twitter-bootstrap, parameter-passing, prototype

我最近遇到了一种情况，我想从根本上改变 Bootstrap 的默认行为。我想向`Modal`该类添加一个自定义方法，以便可以像任何其他库存方法一样调用自定义`Modal`方法：

```
$('#my-modal').modal('myMethod', myParameter); 
```

我通过向`Modal`的构造函数添加一个函数来实现这一点：

```
$.fn.modal.Constructor.prototype.myMethod = function (myParameter) {
  ...
} 
```

但是，`myParameter`变量没有被传递。如何访问/传递`myParameter`给自定义 Bootstrap 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:04:25.147

您无法按原样执行此操作。[模型用来调用函数的代码](https://github.com/twitter/bootstrap/blob/839b0c893fe2f2760682bee9dc49d5fa0b9c0412/js/bootstrap-modal.js#L206)不考虑参数；

```
 $.fn.modal = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('modal')
        , options = $.extend({}, $.fn.modal.defaults, $this.data(), typeof option == 'object' && option)
      if (!data) $this.data('modal', (data = new Modal(this, options)))
      if (typeof option == 'string') data[option]() // <-- here
      else if (options.show) data.show()
    })
  } 
```

最好的办法是向 中添加一个方法`$.fn`，然后`Model`通过 检索实例`$(this).data('modal')`，因为这是 Bootstrap 存储实例的地方；

```
$.fn.foo = function (param) {
    return this.each(function () {
        var model = $(this).data('modal');

        // blah blah blah
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T22:42:16.903

我找到了一种方法来做到这一点，尽管不幸的是它涉及到对 Bootstrap 源的更改。执行实际方法调用的代码如下：

```
$.fn.modal = function (option) {
  return this.each(function () {
    var $this = $(this)
      , data = $this.data('modal')
      , options = $.extend({}, $.fn.modal.defaults, $this.data(), typeof option == 'object' && option)
    if (!data) $this.data('modal', (data = new Modal(this, options)))
    if (typeof option == 'string') data[option]()
    else if (options.show) data.show()
  })
} 
```

要更改这一点，应修改第 7 行（[源代码](https://github.com/twitter/bootstrap/blob/839b0c893fe2f2760682bee9dc49d5fa0b9c0412/js/bootstrap-modal.js#L206)中的第 206 行）以传递最初传递给封闭函数的任何附加参数。此外，必须为 jQuery`.each()`函数的每次迭代提供原始参数。这是工作代码：

```
$.fn.modal = function (option) {
  return this.each(function () {
    var $this = $(this)
      , data = $this.data('modal')
      , options = $.extend({}, $.fn.modal.defaults, $this.data(), typeof option == 'object' && option)
    if (!data) $this.data('modal', (data = new Modal(this, options)))
    if (typeof option == 'string') data[option].apply($this.data('modal'), Array.prototype.slice.call(arguments, 1)); // pass the parameters on
    else if (options.show) data.show()
  }, arguments) // execute each iteration with the original parameters
} 
```

我仍在尝试确保此更改不会产生任何不良副作用，但到目前为止，一切都按预期工作。欢迎任何更优雅的解决方案。

# excel - 在特定文件夹中的 Excel 2010 中打开插入超链接

> ID：15256532
> 
> 赞同：0
> 
> 时间：2013-03-06T19:42:45.667
> 
> 标签：excel, vba

我们遇到了插入超链接问题，因为网络文件夹中有大量文件（Windows 7， *xp*很好......哦，过去的美好时光。是的，我已经尝试了一切，禁用搜索、不同的 reg 条目等......我想要一个不同且不那么 hacky 的解决方案。）

我正在寻找的是一个宏，它会提示输入一个数字（在本例中为客户端文件号），然后在特定文件夹中打开“插入超链接”对话框（例如，用户输入的文件号可能是 4321，并且然后插入超链接对话框将在文件夹 z:\clients\4321\ 中打开，这是 z:\clients 文件夹，其中包含愚蠢数量的文件夹）

将被超链接的实际文件将在那里的某个地方，因此用户必须进行额外的浏览。而且我不确定宏在知道要超链接的内容方面的确切行为（大概当前单元格对我来说是有意义的）。

感谢您的任何帮助，您可以提供！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:55:39.467

...您可能需要稍微尝试一下，但最好的选择可能是`Hyperlink Base`为每个用户的工作表设置 ，然后在工作表本身中设置相关超链接。

希望这可以帮助...

# android - 带有图标的 Android 自定义 EditText

> ID：15256535
> 
> 赞同：5
> 
> 时间：2013-03-06T19:42:53.850
> 
> 标签：android, user-interface

我正在尝试学习 Android 及其 UI。是否可以在`EditText`下面创建一个像我的设计？

![编辑文本设计](../Images/221d58ce10e37c67413adae389737ee2.png)

其中应包括：

*   左侧的小图标应该在事件发生时可以更改（猜测这是以编程方式完成的）
*   图标旁边的右边框边缘
*   悬停时粗笔划

可能可以弄清楚如何在事件发生时更改图标和粗笔划，但不知道如何对带有右边框边缘的图标进行`editText`平滑编码。帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:54:27.483

您可以使用

```
android:drawableLeft="@drawable/your_drawable" 
```

在 xml 中的 EditText 上。

从java你可以像这样改变它

```
Drawable img = getContext().getResources().getDrawable( R.drawable.your_other_drawable );
txtVw.setCompoundDrawablesWithIntrinsicBounds( img, null, null, null ); 
```

如果您希望编辑框具有与示例图像中相同的圆角/方角，则必须制作自己的背景资源。

# ios - 更改 UITableViewCell 的减号动画

> ID：15256536
> 
> 赞同：1
> 
> 时间：2013-03-06T19:42:57.633
> 
> 标签：ios, objective-c, cocoa-touch, uitableview

我在编辑表格视图时遇到问题：

我将编辑模式下的减号位置更改为单元格的右侧。
问题是按钮从左侧滑动，这使它看起来很奇怪。
有没有办法改变这个动画？

此外，撤消删除选项时有一个动画（显示红色删除按钮时单击减号），知道为什么吗？

[这是](http://www.youtube.com/watch?v=aKqECITNnVE.)显示该问题的视频：

---编辑---
这就是我改变位置的方式：

```
- (void)layoutSubviews {
[super layoutSubviews];

//Indent to the left instead of right
self.contentView.frame = CGRectMake(0,
                                    self.contentView.frame.origin.y,
                                    self.contentView.frame.size.width,
                                    self.contentView.frame.size.height);

if ((self.editing
    && ((state & UITableViewCellStateShowingEditControlMask)
        && !(state & UITableViewCellStateShowingDeleteConfirmationMask))) ||
    ((state & UITableViewCellStateShowingEditControlMask)
     && (state & UITableViewCellStateShowingDeleteConfirmationMask)))
{
    float indentPoints = self.indentationLevel * self.indentationWidth;

    self.contentView.frame = CGRectMake(indentPoints - 35,
                                        self.contentView.frame.origin.y,
                                        self.contentView.frame.size.width - indentPoints,
                                        self.contentView.frame.size.height);
}

//Change editAccessoryView location
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationBeginsFromCurrentState:YES];
[UIView setAnimationDuration:0.0f];
//If can't use private classes (UITableViewCellDeleteConfirmationControl..), use [self.subviews objectAtIndex:0];

for (UIView *subview in self.subviews) {

    if ([NSStringFromClass([subview class]) isEqualToString:@"UITableViewCellDeleteConfirmationControl"]) {
        CGRect newFrame = subview.frame;
        newFrame.origin.x = 10;
        subview.frame = newFrame;
    }
    else if ([NSStringFromClass([subview class]) isEqualToString:@"UITableViewCellEditControl"]) {
        CGRect newFrame = subview.frame;
        newFrame.origin.x = 280;
        subview.frame = newFrame;

    }
    else if ([NSStringFromClass([subview class]) isEqualToString:@"UITableViewCellReorderControl"]) {
        CGRect newFrame = subview.frame;
        newFrame.origin.x = 200;
        subview.frame = newFrame;
    }
}
[UIView commitAnimations];

}

- (void)willTransitionToState:(UITableViewCellStateMask)aState {
[super willTransitionToState:aState];
self.state = aState;
} 
```

---edit2---
我确定导致减号跳转问题的部分是
//Change editAccessoryView 位置。
没有它就没有跳跃，但减号按钮又回到了单元格的左侧。
有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:06:25.323

只是一个猜测，但您是否尝试过颠倒视图？您也许可以使用`UIView` `transform`.

（代码来自网络，不知道可靠性如何）

```
CGAffineTransform rotateTransform;
rotateTransform = CGAffineTransformRotate(CGAffineTransformIdentity, M_PI);
myView.transform = rotateTransform; 
```

# zxing - 我将如何修改 ZXing 以针对特定的条形码类型进行优化？

> ID：15256539
> 
> 赞同：0
> 
> 时间：2013-03-06T19:43:09.280
> 
> 标签：zxing

ZXing 目前在我对 Code 39 和 Code 128 的测试中表现不佳，这是我们对我们的应用程序感兴趣的唯一一维条形码类型。

我们可以采取什么策略来优化这些类型的 ZXing 代码？

如果我们想要，我们应该关注 ZXing 源代码的哪些部分，例如，首先告诉它停止尝试查找和解释其他 1D 条形码格式（我假设这将有助于它识别 39/ 129)?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:18:37.900

您可以做的最重要的事情是不扫描所有其他格式。只需使用`Code39Reader`and进行扫描`Code128Reader`，而不是`MultiFormatReader`（或者，使用它，但发送提示以限制所考虑的格式）。在 Android 应用程序中，这意味着它可以只为您的格式检查更多帧。

如果您有一个速度非常快的移动设备 - 或者正在使用台式计算机 - 启用`TRY_HARDER`模式。

如果您想破解代码 - 检测一维条码最需要关注的是`Binarizer`. 如果您有几个月的图像处理背景和背景，您可能会写出更好的东西。

后者是 Barcode Scanner 应用付费版本的一部分，称为[Barcode Scanner+](https://play.google.com/store/apps/details?id=com.srowen.bs.android)。如果您愿意花 3 美元，您可以看到更好的图像处理可能对您的用例产生多大的影响。

# c# - 排序和搜索数据表

> ID：15256540
> 
> 赞同：0
> 
> 时间：2013-03-06T19:43:11.877
> 
> 标签：c#, .net, vb.net, gridview, datatable

我有一个数据表，它在后面的代码中绑定到 Gridview。这意味着我必须在后面的代码中对列进行排序，并且在搜索记录时，我想这也将在后面的代码中完成。

我必须对gridview进行排序的代码是

```
Private Function GetCustData As Datatable
Dim dt as new datatable

dt = GetDataFromBusinessLayer(CustomerID)
Return dt

End Function 
```

以及要排序的代码

```
Private Sub gv_Sorting(sender As Object, e As System.Web.UI.WebControls.GridViewSortEventArgs) Handles gv.Sorting
    If e.SortExpression = "Name" 
        gv.DataSource = GetCustData '.DefaultView.Sort = "Name" & "DESC"
        gv.DataBind()
    End If
End Sub 
```

正如你所知道的，我尝试使用 .DefaultView.Sort = "Name" & "DESC" 但这没有用并得到错误*数据源是无效类型。它必须是 IListSource、IEnumerable 或 IDataSource*。搜索大多数都在使用 Viewstate，但这似乎不适用于我的情况。

谁能建议我如何对一列/多列进行排序？

此外，我希望有一个文本框来搜索名称列。我认为上述内容就足够了，但如果没有的话，有人可以让我走上正确的轨道，这样我现在就可以朝着这个方向努力，而不必在以后改变我正在做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:51:03.613

我认为您可以创建一个行列表

```
List<DataRow> list = dt.AsEnumerable().ToList(); 
```

然后当你有一个列表时，你现在可以使用 sort

```
list.OrederBy(c=>c.///specific value in your list) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:02:21.160

首先，您当前的代码没有空格。要按名称 DESC 排序，您的排序字符串需要是：“名称 DESC”。

要将排序字符串设置为多列，只需在每列之间添加一个逗号，如下所示：

```
Dim dt as new datatable = GetCustData(1)
dt.DefaultView.Sort = "Name DESC, FirstName ASC"
gv.DataSource = dt.DefaultView
gv.DataBind() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:02:13.277

用什么`Linq`来为你做排序。

```
Dim dt as new datatable

dt = From dr as Datarow in GetDataFromBusinessLayer(CustomerID)
     Order by dr.item("First Sort field), dr.Item("Second Sort Field")
     Select dr

Return dt 
```

...我在没有 IDE 的情况下做到了这一点，但我相信这应该可以解决问题。

这是一个在线示例 -[使用 Linq 对数据表进行排序](http://msmvps.com/blogs/deborahk/archive/2009/07/23/linq-sorting-a-datatable.aspx)

希望这可以帮助。

# ruby-on-rails - Rails 关联 has_many ：通过

> ID：15256541
> 
> 赞同：1
> 
> 时间：2013-03-06T19:43:13.090
> 
> 标签：ruby-on-rails, has-many-through, mass-assignment

我开始使用 Ruby on Rails，但遇到了`has_many :through`关联问题。

我正在使用的模型是：

```
class Phrase < ActiveRecord::Base
  attr_accessible :event_type_id, :template_pieces

  belongs_to :event_type
  has_many :phrases_pieces
  has_many :template_pieces, :through => :phrases_pieces
end

class TemplatePiece < ActiveRecord::Base
  attr_accessible :datatype, :fixed_text, :name

  has_many :phrase_pieces
  has_many :phrases, :through => :phrases_pieces
end

class EventType < ActiveRecord::Base
  attr_accessible :name

  has_many :phrases
end

class PhrasesPiece < ActiveRecord::Base
  attr_accessible :order, :phrase_id, :template_piece_id

  belongs_to :phrase
  belongs_to :template_piece
end 
```

我正在尝试创建一个新短语，将其默认形式编辑为：

```
<%= form_for(@phrase) do |f| %>
  <% if @phrase.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@phrase.errors.count, "error") %> prohibited this phrase from being saved:</h2>

      <ul>
      <% @phrase.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  Select the event type:
    <%= collection_select(:phrase, :event_type_id, EventType.all, :id, :name) %>
    Select the phrases to be used:
    <%= collection_select(:phrase, :template_pieces, TemplatePiece.all, :id, :name) %>

  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

我首先遇到了 Mass Assignment 的问题，但我修复了将其添加`attr_accessible :template_pieces`到短语模型中的问题。我不确定这是否是修复它的正确方法，但至少它停止抱怨它无法批量分配受保护的属性。

现在，提交新短语时出现以下错误：

> “1”的未定义方法“每个”：字符串

我有点认为这是因为一个给定的短语应该有很多 template_pieces，但我目前一次只能提交一个。所以它只是找到一个，尝试遍历它并失败。

我将如何解决这个问题？有没有更好的方法将模型输入`has_many :through`到数据库中？我是否必须手动进行（如解除默认控制器`@phrase = Phrase.new(params[:phrase]`）？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:29:57.203

您应该使用`fields_for`帮助器来包装嵌套属性：

```
<%= f.fields_for :template_pieces do |template_f| %>
  <%= template_f.collection_select, :event_type_id, EventType.all, :id, :name %>
  Select the phrases to be used:
  <%= template_f.collection_select, :template_pieces, TemplatePiece.all, :id, :name %>
<% end %> 
```

**参考**

`fields_for` [文档](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-fields_for)。

# php - 通过cronjob运行curl时在哪里存储cookie？

> ID：15256545
> 
> 赞同：0
> 
> 时间：2013-03-06T19:43:28.360
> 
> 标签：php, cookies, crontab

我有一个使用 curl 登录网站的 PHP 脚本。当我在浏览器中运行脚本时，脚本可以正常登录。当我通过 cronjob 运行它时，它不会登录，因为 cookie 没有存储在我预期的位置。

如何存储 cookie？

* * *

这是脚本的相关部分。在此之前定义 URL ($url) 和登录数据 ($post_string)。

```
class curl {
    function __construct($use = 1) {
        $this->ch = curl_init();
        if($use = 1) {
            curl_setopt ($this->ch, CURLOPT_POST, 1);
            curl_setopt ($this->ch, CURLOPT_COOKIEJAR, $_SERVER['DOCUMENT_ROOT'].'/verwaltung/cookie.txt');
            curl_setopt ($this->ch, CURLOPT_COOKIEFILE, $_SERVER['DOCUMENT_ROOT'].'/verwaltung/cookie.txt');
            curl_setopt ($this->ch, CURLOPT_FOLLOWLOCATION, 1);
            curl_setopt ($this->ch, CURLOPT_RETURNTRANSFER, 1);
        } else {
            return 'There is the possibility, that this script wont work';
        }
    }
    function first_connect($loginform,$logindata) {
        curl_setopt($this->ch, CURLOPT_URL, $loginform);
        curl_setopt ($this->ch, CURLOPT_POSTFIELDS, $logindata);
    }
    function store() {
        $store = curl_exec ($this->ch);
    }
    function execute($page) {
        curl_setopt($this->ch, CURLOPT_URL, $page);
        $this->content = curl_exec ($this->ch);
    }
    function close() {
        curl_close ($this->ch);
    }
    function __toString() {
        return $this->content;
    }
}

$getit = new curl();
$getit->first_connect($url, $post_string);
$getit->store();
$getit->execute($url);
$getit->close(); 
```

* * *

问题已编辑以反映 Wrikken 和 Colin Morelli 在下面的评论。谢谢你俩！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:46:57.017

从命令行运行脚本时，`$_SERVER['DOCUMENT_ROOT']`变量将为空（毕竟，没有服务器，也没有文档根目录）。

This means that `$_SERVER['DOCUMENT_ROOT'].'/verwaltung/cookie.txt'` will eventually resolve to `'/verwaltung/cookie.txt'` (and a PHP notice). This directory will probably not exist (it's directly in the root filesystem; there shouldn't be anything besides the default Unix system directories) and your script will not be able to create the cookie file (and subsequently, not save any cookies set by cURL).

Instead of `$_SERVER['DOCUMENT_ROOT']`, you could for example use `.` (the current directory), `/tmp` (should be writable by all users -- and also readable, be careful!), `__DIR__` (the directory the PHP script resides in) or any other directory at your discretion that does not depend on server variables.

# c++ - 通过 sscanf 读取全名

> ID：15256547
> 
> 赞同：6
> 
> 时间：2013-03-06T19:43:29.420
> 
> 标签：c++, c

我正在使用 C++，但我决定使用`sscanf`. 读取每一行后，它应该提取数据并将它们存储到变量中。

```
string test = "[06/03/2013 18:15:23] INFO - Open [Johny Cage]";

int day, month, year, second, minute, hour;
char name[128];

int c = sscanf(test.c_str(), "[%d/%d/%d %d:%d:%d] INFO - Open [%127[^\n]%c]",
               &day, &month, &year, &second, &minute, &hour, name);

if (c == 7)
{
    cout << name << endl;
} 
```

我需要将名称读取为`Johny Cage`（名称可能有空格）并将其存储到`name`，但输出为：

> 约翰尼凯奇]

问题是尾随`]`. 我怎样才能使用`sscanf`它最后没有读到的`]`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-06T19:50:14.757

使用`[^]]`而不是`[^\n]`. 另外，删除`%c`扫描格式字符串的 at then 结尾。

```
int c = sscanf(test.c_str(), "[%d/%d/%d %d:%d:%d] INFO - Open [%127[^]]]",
               &day, &month, &year, &second, &minute, &year, name); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T19:47:43.383

通过检查它。试试这个：

```
int c = sscanf(test.c_str(), "[%d/%d/%d %d:%d:%d] INFO - Open [%127[^\]\n]]%*[^\n]\n",
           &day, &month, &year, &second, &minute, &year, name); 
```

] 必须被转义，否则它将被理解为“分隔符字符串的结尾”，这将是空的......因此是非法的。

有了这个添加，它将在换行符或 ] 处停止，无论先发生什么。

当然删除 %c ......毕竟，你不会将它保存到任何变量中。

最后一个添加将读取到它找到的下一个换行符，并丢弃它沿途找到的任何符号（因此是 *）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:56:53.790

我不确定您匹配名称的方式会发生什么，但这对我有用：

`int c = sscanf(test.c_str(), "[%d/%d/%d %d:%d:%d] INFO - Open [%[^]]"`

这匹配除了结束括号之外的任何内容。

# delphi - Delphi 和快速手册示例

> ID：15256549
> 
> 赞同：0
> 
> 时间：2013-03-06T19:43:31.673
> 
> 标签：delphi, sdk, quickbooks

我们创建了一个 delphi 应用程序来连接到 quickbooks 11 pro。我们正在尝试使用 TLB 文件中的 BeginSession，它在创建新公司时工作正常，但在从我们的一个客户恢复文件后，它可能来自较新的版本，它不会连接。但是QB没有给出任何错误信息，有没有办法做到这一点？

谢谢

安迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T13:52:05.433

如果您尚未下载 QuickBooks SDK，请尝试使用 SDKTestPlus3 工具查看它是否可以访问公司文件。如果不能，问题可能出在公司文件上，如果可以，问题可能出在您的程序上。

# r - ggplot的axis.text的vjust是否取决于角度？

> ID：15256555
> 
> 赞同：1
> 
> 时间：2013-03-06T19:43:43.003
> 
> 标签：r, plot, ggplot2

我正在尝试使用 ggplot 降低轴刻度标签，但遇到了意想不到的困难。

“hjust”工作正常，但 ggplot 的“vjust”参数似乎取决于“角度”的值。

[下面的示例（从https://github.com/hadley/ggplot2/wiki/Axis-Attributes](https://github.com/hadley/ggplot2/wiki/Axis-Attributes)修改代码）显示了“角度”的值似乎如何影响“vjust”：

```
plot1 <- function(){
#create simple dataframe for plotting
xy <- data.frame(x=1:10, y=10:1)

#create base plot
    p <- ggplot(data = xy)+ geom_point(aes(x = x, y = y))

#plot base plot
    p <- p + theme(axis.text.x = element_text(colour="red", angle = 45, size = 10, vjust = 7))
    print(p)    
} 
```

沿线 y=2.5 生成带有轴刻度标签 (2.5, 5.0, 7.5, 10.0) 的图。

但是，删除倒数第二行中的“角度”参数，即

```
p <- p + theme(axis.text.x = element_text(colour="red", size = 10, vjust = 7)) 
```

生成一个带有 x 轴下方的轴刻度标签的图（因为它们通常是 - 但“vjust”没有改变）。

根据文档，从技术上讲，vjust（和 hjust）应该只在区间 [0,1] 内，但无论我为“vjust”选择什么值（正/负/大/小），我都无法得到轴刻度标签向上或向下移动而不将“角度”定义为某个非零值。

我很抱歉，但我无法发布任何图片，因为这是我的第一个问题，而且我没有足够的声望点。

这是我第一次提出问题，因为之前我在这个网站上已经被问过（并回答了）任何 ggplot 问题。我已经看了一遍，但还没有找到其他遇到同样问题的人。

任何帮助将不胜感激。

我正在运行 R 2.15.1 和 ggplot2 0.9.3，并且 sessionInfo() 产生：

```
other attached packages:
[1] ggplot2_0.9.3 rj_1.1.0-4   

loaded via a namespace (and not attached):
 [1] colorspace_1.2-0   dichromat_1.2-4    digest_0.6.0       grid_2.15.2       
 [5] gtable_0.1.2       labeling_0.1       MASS_7.3-22        munsell_0.4       
 [9] plyr_1.8           proto_0.3-9.2      RColorBrewer_1.0-5 reshape2_1.2.2    
[13] rj.gd_1.1.0-1      scales_0.2.3       stringr_0.6.2      tools_2.15.2 
```

# html - 如何使 KineticJs 自定义形状

> ID：15256556
> 
> 赞同：2
> 
> 时间：2013-03-06T19:43:46.780
> 
> 标签：html, kineticjs, shape

我正在尝试制作 KineticJs html 5 自定义形状。

但它不适用于谷歌浏览器。在 Firefox 中不可拖动，形状大小也不相同。

谁能告诉我为什么？

实时代码[http://jsfiddle.net/prantor19/wGE2a/8/](http://jsfiddle.net/prantor19/wGE2a/8/)

```
var stage = new Kinetic.Stage({
    container: 'canvas-container',
    width: 500,
    height: 500,
});

var layer = new Kinetic.Layer();

drawWindow = function(canvas) {
    var context = canvas.getContext();
    context.beginPath();
    context.moveTo(this.attrs.x,this.attrs.y);
    context.lineTo(this.attrs.width,this.attrs.y);
    context.lineTo(this.attrs.width,this.attrs.height);
    context.lineTo(this.attrs.x,this.attrs.height);
    context.closePath();
    context.clip();
    context.drawImage(img,this.attrs.img_x,this.attrs.img_y);
}

img = document.createElement('img');
img.src= "http://upload.wikimedia.org/wikipedia/commons/thumb/1/14/Nature_reserve_Kladrubska_hora_in_summer_2011_(17).JPG/1024px-Nature_reserve_Kladrubska_hora_in_summer_2011_(17).JPG";

var window1 = new Kinetic.Shape({
    drawFunc: drawWindow,
    x: 0,
    y: 0,
    width: 100,
    height: 100,
    img:img,
    img_x:0,
    img_y:0,
    draggable: true
});

var window2 = new Kinetic.Shape({
    drawFunc: drawWindow,
    x: 10,
    y: 60,
    width: 100,
    height: 100,
    img:img,
    img_x:-250,
    img_y:0,
    draggable: true
});

pointercursor = function() {
    document.body.style.cursor = 'pointer';
}
defaultCursor = function() {
    document.body.style.cursor = 'default';
}

window1.on('mouseover',pointercursor );
window1.on('mouseout', defaultCursor);
window2.on('mouseover',pointercursor );
window2.on('mouseout', defaultCursor);

layer.add(window1);
layer.add(window2);

stage.add(layer); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:06:41.910

您的脚本中有错误

> 无法从画布获取图像数据，因为画布已被跨域数据污染。kinetic-v4.3.2-beta.js:4365 未捕获错误：SecurityError: DOM Exception 18

Chrome 拒绝在 cavas 上处理跨域图像。

对于拖动，您需要为形状添加此设置描边

```
stroke: 'black', 
```

并在 drawFunc 结束时

```
canvas.fillStroke(this); 
```

这是你的我的工作版本

[http://jsfiddle.net/W7SGT/](http://jsfiddle.net/W7SGT/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T03:05:16.660

在 KienticJS 中绘制自定义形状时，您应该使用画布渲染器，否则它无法处理形状上的事件。这是关于自定义形状的教程：

[http://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-shape-tutorial/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-shape-tutorial/)

您还可以查看 Kinetic.Image 形状以了解它如何专门处理图像：

[https://github.com/ericdrowell/KineticJS/blob/master/src/shapes/Image.js](https://github.com/ericdrowell/KineticJS/blob/master/src/shapes/Image.js)

# c# - 在 Rx 中实现滑动窗口的麻烦

> ID：15256557
> 
> 赞同：13
> 
> 时间：2013-03-06T19:43:46.790
> 
> 标签：c#, system.reactive, rx.net

我为响应式扩展创建了一个`SlidingWindow`操作符，因为我想轻松监控滚动平均值等内容。举个简单的例子，我想订阅听到鼠标事件，但每次有一个事件我想接收最后三个（而不是等待每第三个事件接收最后三个）。这就是为什么我发现的 Window 重载似乎没有给我开箱即用的东西。

这就是我想出的。鉴于其频繁的 List 操作，我担心它可能不是最高效的解决方案：

```
public static IObservable<List<T>> SlidingWindow<T>(this IObservable<T> seq, int length)
{
    var seed = new List<T>();

    Func<List<T>, T, List<T>> accumulator = (list, arg2) =>
    {
        list.Add(arg2);

        if (list.Count > length)
            list.RemoveRange(0, (list.Count - length));

        return list;
    };

    return seq.Scan(seed, accumulator)
                .Where(list => list.Count == length);
} 
```

可以这样调用：

```
var rollingSequence = Observable.Range(1, 5).SlidingWindow().ToEnumerable(); 
```

然而，令我大吃一惊的是，并没有收到预期的结果

```
1,2,3
2,3,4
3,4,5 
```

我收到结果

```
2,3,4
3,4,5
3,4,5 
```

任何见解将不胜感激！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-05-17T15:07:08.927

使用您的原始测试，计数参数为 3，这给出了所需的结果：

```
public static IObservable<IList<T>> SlidingWindow<T>(
    this IObservable<T> source, int count)
{
    return source.Buffer(count, 1)
                 .Where(list => list.Count == count);
} 
```

像这样测试：

```
var source = Observable.Range(1, 5);
var query = source.SlidingWindow(3);
using (query.Subscribe(i => Console.WriteLine(string.Join(",", i))))
{

} 
```

输出：

```
1,2,3
2,3,4
3,4,5 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-05T00:32:49.927

只是`source.Window(count, 1)`- 或者`source.Buffer(count, 1)` 它是“计数”项目的窗口/缓冲区，滑动一个。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-01-24T22:29:14.053

这里的滑动窗口实现不足以满足我对滑动窗口的想法。最接近的是使用`Buffer(N, 1)`但是是一个问题，因为它在发出第一个结果之前等待前 N 个项目，然后滑出序列的末尾。我想要一次最多发出 N 个项目。

我最终得到了这个实现：

```
public static IObservable<IList<T>> SlidingWindow<T>(this IObservable<T> obs, int windowSize) =>
    Observable.Create<IList<T>>(observer =>
    {
        var buffer = new CircularBuffer<T>(windowSize);
        return obs.Subscribe(
            value =>
            {
                buffer.Add(value);
                observer.OnNext(buffer.ToList());
            },
            ex => observer.OnError(ex),
            () => observer.OnCompleted()
        );
    }); 
```

我最初使用队列作为缓冲区，但想使用更轻量级的东西。

```
public class CircularBuffer<T> : IReadOnlyList<T>
{
    private readonly T[] buffer;
    private int offset;
    private int count;
    public CircularBuffer(int bufferSize) => this.buffer = new T[bufferSize];
    public int Capacity => buffer.Length;
    public int Count => count;
    public T this[int index] => index < 0 || index >= count
        ? throw new ArgumentOutOfRangeException(nameof(index))
        : buffer[(offset + index) % buffer.Length];
    public void Add(T value)
    {
        buffer[(offset + count) % buffer.Length] = value;
        if (count < buffer.Length) count++;
        else offset = (offset + 1) % buffer.Length;
    }
    public IEnumerator<T> GetEnumerator()
    {
        for (var i = 0; i < count; i++)
            yield return buffer[(offset + i) % buffer.Length];
    }
    IEnumerator IEnumerable.GetEnumerator() => GetEnumerator();
} 
```

它将产生以下序列`Observable.Range(0, 10).SlidingWindow(3)`：

```
 0,1,2,3,4,5,6,7,8,9
[0]
[0,1]
[0,1,2]
  [1,2,3]
    [2,3,4]
      [3,4,5]
        [4,5,6]
          [5,6,7]
            [6,7,8]
              [7,8,9] 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-03-06T20:20:08.880

试试这个 - 我必须坐下来考虑一下它的相对性能，但它~~至少~~ *可能*一样好，而且更容易阅读：

```
public static IObservable<IList<T>> SlidingWindow<T>(
       this IObservable<T> src, 
       int windowSize)
{
    var feed = src.Publish().RefCount();    
    // (skip 0) + (skip 1) + (skip 2) + ... + (skip nth) => return as list  
    return Observable.Zip(
       Enumerable.Range(0, windowSize)
           .Select(skip => feed.Skip(skip))
           .ToArray());
} 
```

试验台：

```
var source = Observable.Range(0, 10);
var query = source.SlidingWindow(3);
using(query.Subscribe(Console.WriteLine))
{               
    Console.ReadLine();
} 
```

输出：

```
ListOf(0,1,2)
ListOf(1,2,3)
ListOf(2,3,4)
ListOf(3,4,5)
ListOf(4,5,6)
... 
```

编辑：顺便说一句，自从因为不这样做而被烧伤一次后，我发现自己有强迫症`.Publish().RefCount()`……我认为这里没有严格要求。

编辑 yzorg：

如果您像这样扩充该方法，您将更清楚地看到运行时行为：

```
public static IObservable<IList<T>> SlidingWindow<T>(
    this IObservable<T> src, 
    int windowSize)
{
    var feed = src.Publish().RefCount();    
    // (skip 0) + (skip 1) + (skip 2) + ... + (skip nth) => return as list  
    return Observable.Zip(
    Enumerable.Range(0, windowSize)
        .Select(skip => 
        {
            Console.WriteLine("Skipping {0} els", skip);
            return feed.Skip(skip);
        })
        .ToArray());
} 
```

# php - 使用 implode 和 magic __get() 从 DB 存储和获取 CSV 列

> ID：15256564
> 
> 赞同：0
> 
> 时间：2013-03-06T19:44:16.980
> 
> 标签：php, mysql, get, explode, implode

我有 PHP 代码可以从 tbl_categorie 中选择类别，现在我有一个多选形式，其中一篇文章可以有多个类别。在数据库中插入值时，我想将多个类别值存储在一列/属性中。其中 ID_CAT 属性将仅存储 tbl_categorie 的类别 ID，由逗号 (,) 分隔。我在一个数据库中有两个表，

```
 tbl_blog:                           
  ID_BLOG    ID_CAT               TITLE          ARTICL        DATE
  1          1,3                  title1         article1      2013-03-04
  2          4,10                 title2         article2      2013-03-04 
  3          3,6                  title3         article3      2013-03-04

 tbl_categorie:                           
  ID_CAT    NOM_CAT               
  1          HTML                
  2          CSS                
  3          DESIGN
  4          PHP
  5 .. 
```

尽管我使用了 implode() 语句，但我首先遇到了为一篇文章添加两个 ID_CAT 的问题，但是当我将 ID_CAT 的类型从 int 更改为 varchar 时，她可以工作，这是添加文章的过程：

```
Article::creatArticle(0,$_POST['title'],implode(', ', $_POST['id_categorie']),$_POST['article']); 
```

这是从 class_article 添加文章的功能：

```
/**
 * function créeArticle
 */ 
public static function creatArticle($id_article,$title,$id_categorie,$article)
{
    global $db; 
    $req = $db->prepare("INSERT INTO blog (ID_BLOG,TITLE,ID_CAT, ARTICLE,DATE) VALUES ('',:title,:id_categorie,:article,'".date('Y-m-d')."')"); 
    $ok = $req->execute(Array('title' =>$title,'id_categorie' => $id_categorie,'article' => $article));
     return $db->lastInsertId();
    //$erreur = $req->errorInfo();
} 
```

现在我有问题要获取每篇文章中应包含的所有类别，这就是我在后台使用魔术方法 get() 获取文章表的方式，她只返回第一个值中的第一个值：

```
 <?php
    foreach(Article::getAllArticle()as $blog ){
        $article= new Article($blog->ID_BLOG);
        $categorie = new Categorie($article->getIDCategorie());

        echo'
                    <tr>';
                            echo '<td><input type="checkbox" /></td>';
                            echo '<td>'.$article->getTitlearticle().'</td>';
                            echo '<td>'.$categorie->getNomCategorie().'</td>';
                            echo '<td>'.$article->getDatearticle().'</td>';
                            echo '<td>35</td>';
                            echo ' <td class="actions">';
                            echo '<a href="javascript:editArticle('.$article->getIDarticle().');" title="Edit this content"><img src="img/icons/actions/edit.png" alt="" /></a>';
                            echo ' <a href="javascript:deleteArticle('.$article->getIDarticle().');" title="Delete this content"><img src="img/icons/actions/delete.png" alt="" /></a></td>';
                            echo '</tr>';

                        } .. 
```

我知道我必须使用explode() 语句或制作一个循环，但我无法弄清楚如何:(，而且我怀疑ID_CAT 的类型应该是varchar 导致问题吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T21:23:15.813

很难理解你在做什么以及你想做什么。我不确定您是从 CSV 文件还是从数据库中获取结果？

如果它来自数据库，据我所知，您需要规范化您的数据库表。在博客和类别之间创建一个链接表，这样可以更轻松地返回结果。一个简单的连接 sql 将获取一个类别中的所有文章或获取与该文章关联的所有类别。

```
tbl_blog:                           
  ID_BLOG                TITLE          ARTICL        DATE
  1                      title1         article1      2013-03-04
  2                      title2         article2      2013-03-04 
  3                      title3         article3      2013-03-04

 tbl_categorie:                           
  ID_CAT    NOM_CAT               
  1          HTML 

tbl_blogcat
 ID_BLOG    ID_CAT 
 1           1
 1           3
 2           4
 2           10 
```

现在可能需要做一些额外的工作，但将来值得。将您的类别存储为逗号分隔的字符串会使搜索变得困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T21:45:31.230

这个问题可以很容易地解决，你可以创建一个新表来存储**tbl_blog 和 tbl_catagory**的主要 id 的信息。这样做的好处是，当您选择更多类别的博客时，它将存储您的博客每个类别的信息。桌子看起来像......

```
 tbl_combine:

ID_COMB    ID_Blog    ID_Cat
1          1          2
2          1          1
3          1          3
4          2          3
5          2          2
6          3          1
7          3          2
8          3          3 

```

上面我们只放了 3 个博客和 3 个类别。**tbl_combine**可以在每一行中存储其所选博客的 每个博客类别的主 ID。所以我们可以插入无限类别的博客。不需要爆炸或内爆功能。

然后我们可以检索任何博客类别。查询看起来像。

```
 SELECT
      (SELECT category_name FROM tbl_catagory 
       WHERE id_cat=A.id_cat) 
       AS catagory_name 
FROM tbl_combine 
AS A 
WHERE id_blog=$blog_id 

```

注意我们只存储**tbl_blog 和 tbl_catagory**表的 id 是**tbl_combine**它不会慢

# python - 用整数、浮点数和字符串替换列表中的值而不更改列表结构

> ID：15256569
> 
> 赞同：0
> 
> 时间：2013-03-06T19:44:29.363
> 
> 标签：python, string, list, int

我有这个代码

```
a=[0,['hello','charles', 'hey', 'steve', 'hey', 0.0, 1.5, 23]]  
for row in a:
   for ix, char in enumerate(row):
       if 'hello' in char:
           row[ix] = 'Good Morning' 
```

但这不起作用，因为我在同一个列表中有整数、浮点数和字符串。我需要用 Good Morning 更改 hello 并保存数据结构和属性类型，因为稍后我将使用该数据进行一些算术计算。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:50:41.317

如果您只想将“Hello”替换为“早上好”，您可以这样做：

```
a = [[0], ['hello','charles', 'hey', 'steve', 'hey', 0.0, 1.5, 23]]  
for row in a:
    for index, item in enumerate(row):
        if item == "hello":
            row[index] = "Good morning" 
```

如果您真的想替换任何包含“hello”的字符串，我会将整个内容包装在 try except 块中：

```
a = [[0], ['hello','charles', 'hey', 'steve', 'hey', 0.0, 1.5, 23]]  
for row in a:
    for index, item in enumerate(row):
        try:
            if "hello" in item:
                row[index] = "Good morning"
        except TypeError:
            pass 
```

顺便说一句，“char”是一个糟糕的变量名。您的行不包含长度为一的字符串，因此它们不是字符。

第一行实际上应该是一个包含单个整数的列表。如果出于某种原因您真的不想这样做，则必须将整个事情包装在另一个 try/except 块中：

```
a = [0, ['hello','charles', 'hey', 'steve', 'hey', 0.0, 1.5, 23]]  
for row in a:
    try:
        for index, item in enumerate(row):
            if item == "hello":
                row[index] = "Good morning"
    except TypeError:
        pass 
```

# php - PHP OOP 购物车设计/类型提示建议

> ID：15256571
> 
> 赞同：0
> 
> 时间：2013-03-06T19:44:32.260
> 
> 标签：php, shopping-cart, type-hinting

我创建了我的第一个类，一个购物车类。它很棒，可以满足我的所有需求。然而，总有一个然而，...

我已经阅读了很多关于类型提示的内容，并被建议只向我的购物车类传递一个提示变量：

```
$cart = new cart(item $id); 
```

我理解这样做的原因，但我对我的项目类应该做什么以及如果我选择实现它在其中使用什么方法感到困惑。

目前我的网站使用受 MVC 启发的结构来分离方法/视图和控制器。我的视图包含一个发布表单，它将项目 ID 发送到创建对象并调用 additem 方法（或其他相关方法）的控制器。

你觉得我实现网站的方式受益于项目类吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-06T19:55:57.450

类型提示是一种通知方法的用户他们应该*如何*调用它们的方法。作为实现该方法的人，它还允许您*依赖*所传递参数的某些特性。

这是一个没有类型提示的购物车示例

```
<?php
class Cart {
    protected $items = array();

    public function addItem($item) {
        $this->items[] = $item;
    }
}

$cart = new Cart();
$cart->addItem('My Super Cool Toy'); 
```

`$cart`运行上述内容后，您所拥有的是`Cart`一个项目“我的超级酷玩具”的实例。但是，该`Cart`对象不知道该项目是什么。它不知道如何与它交互或用它做什么。例如，我如何获得上面购物车的小计？我不能。

这是一个带有类型提示的示例：

```
<?php
class Cart {
    protected $items = array();

    public function addItem(Item $item) {
        $this->items[] = $item;
    }

    public function getSubTotal() {
        $total = 0;
        foreach ($this->items as $item) {
            $total += $item->getPrice();
        }
        return $total;
    }
}

class Item {
    protected $name;
    protected $price;

    public function __construct($name, $price) {
        $this->name = $name;
        $this->price = $price;
    }

    public function getName() {
        return $this->name;
    }

    public function getPrice() {
        return $this->price;
    }
}

$cart = new Cart();
$cart->addItem(new Item('My Super Cool Toy', 10.99)); 
```

现在我处于完全不同的境地。我知道我`Cart`的全是`Item`s。我知道我可以`getPrice()`的`Item`。我可以依赖它，因为你可以调用我的方法的唯一`addItem`方法是给我一个`Item`对象。

没有类型提示也可以做同样的事情吗？是的。**但是**，*没有什么好的方法可以依赖任何特定的实现*。作为调用者，我*可能*会给你一个 Item 对象。但我也可能会给你一个字符串或一个数字。如果你只有一个字符串或一个数字，你怎么能确定地给我一个价格？

**现在让我们让它变得更好一点**

并快速进入接口编码。假设我有玩具类型：遥控车和洋娃娃。大概，我们以不同的方式玩它们。在这种情况下，一个“项目”对象不起作用，因为它们可以做不同的事情。*但是*，它们都表现出相同类型的行为。它们都是玩具。所以让我们为此创建一个接口：

```
<?php
interface Toy {
    public function play();
} 
```

让我们为我们的玩具创建一些具体的类：

```
<?php
class RemoteControlledCar implements Toy {
    public function play() {
        print "I'm driving a car";
    }
}

class Doll implements Toy {
    public function play() {
        print "GI Joe";
    }
} 
```

现在，我们要将玩具存放在玩具箱中：

```
<?php
class ToyBin {
    protected $toys = array();

    public function addToy(Toy $toy) {
        $this->toys[] = $toy;
    }

    public function playWithMyToys() {
        foreach ($this->toys as $toy) {
            $toy->play();
        }
    }
} 
```

看看那，你已经成功*地正确*编程了。你知道你有一个装满玩具物品的玩具箱。你不必关心它们是什么类型的玩具，也不必关心你将如何与它们互动。你只知道你可以用它们做某些事情（在这种情况下，`play`用它们）。正因为如此，你有一个可以依赖的界面。

**为什么这更好？** 接口确实是编程的方式，原因有几个

1.  它们只需要界面创建者的很少努力。接口不需要具有任何功能。它只是作为其他人实施的“合同”。
2.  它们让您*依赖*可用的特定功能。在我的示例中，您知道可以使用任何**使其**进入您的“玩具” 。而且你不必担心如何。`ToyBin``play()`
3.  它们允许在不牺牲代码质量的情况下灵活地实现。您可以对可以以任何方式玩的任何类型的玩具进行编程。

希望这有助于澄清问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:56:15.847

最大限度地遵循 MVC 的原则，您会期望将项目建模为一个类。即使这只是一个子类数据库记录，它也为将来的扩展提供了一个简单的平台。但是，我希望在方法上看到类“item”的这个类型提示变量，`addItem()`而不是必要的 cart 类的构造函数。是否意味着您的购物车将只有一件商品？

从设计模式的角度来看，无论如何为您的项目设置一个类是有意义的。您现在可能没有任何这些要求，但在稍后阶段您可能希望将方法添加到项目类以：

*   获取相关项目
*   获取图片
*   评价项目

等等。

使用 PHP 面向对象，如果可以的话，使用类型提示通常总是一个好主意（如果参数肯定需要是固定类型）。对于像整数这样的简单类型，始终值得检查或转换为该类型作为您在方法中做的第一件事。这样更安全，并且通过随着时间的推移检查错误，您将了解很多可能存在于代码库中的错误。

# email - 加载 magento 电子邮件模板

> ID：15256572
> 
> 赞同：0
> 
> 时间：2013-03-06T19:44:34.993
> 
> 标签：email, magento, templates

我正在使用自己的代码在电子邮件发出的同时向客户发送短信。我通过获取电子邮件模板代码来做到这一点

```
$code = $this->getTemplateCode(); 
```

然后尝试加载相应的短信模板

```
$sms = $this->loadByCode('sms_'.$code)->getTemplateText(); 
```

`$sms`然后我在继续发送文本之前检查是否为空，这意味着我可以随意添加或删除连接的 SMS 模板。我遇到的问题是，有时，当没有连接的“sms_*”模板时，我会将完整的电子邮件作为 SMS 发送出去，而不是发送任何文本。

我已经通过发送它尝试作为实际短信加载的模板来调试代码，并收到“sms_creditmemo”，但是当我用上面的方法加载它并执行`var_dump($sms); exit;`它时，它显示它加载了模板“creditmemo_invoice”这是我在检测到付款方式时使用的电子邮件模板，而不是“creditmemo”。`$code`无论付款方式如何，我都确保在（用于加载 SMS 模板）中使用原始模板字符串。

现在我的问题是这怎么可能，loadByCode 是否采用最佳匹配模板，还是我错过了其他一些更严重的错误，也许有更好的方法来加载模板并进行正确检查以查看它们是否存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T07:19:44.910

我通过检查是否加载了正确的电子邮件模板来解决这个问题

```
if ($this->loadByCode($template)->getTemplateCode() == $template) 
```

# python - 终端中的python堆叠线

> ID：15256576
> 
> 赞同：0
> 
> 时间：2013-03-06T19:44:55.847
> 
> 标签：python

Python 不会继续替换终端中的同一行，但它会替换“名称”并将进度条添加到新行中，这会导致大量进度条......这仅在我使用“\n”时发生在“名称”之前。我怎样才能让结果看起来像这样？

```
[###                                                               ] 4%
name2 
```

Python

```
mylist = ['name1', 'name2', 'name3',...'name66']

for name in mylist:
  sys.stdout.write('\r[%-66s] %d%%' % ('#'*prog, (prog*1.51515151515))+'\n'+name)
  sys.stdout.flush() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:48:20.437

您可以为此尝试[进度](https://pypi.python.org/pypi/progressbar/2.2)条。根据我的经验，它运行良好并且易于配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:56:13.127

您可以通过使用足够的空格来实现这一点，看起来像一个新行，但实际上不使用换行符。然后使用退格字符`\b`将光标移回行首并覆盖您所写的所有内容。

我稍微扩展了您的示例，使其成为一个可运行的脚本，方法是在其中放置一个 sleep 并手动递增`prog`.

```
import sys
from time import sleep
import os

# Get the number of columns in the terminal
rows, columns = os.popen('stty size', 'r').read().split()
columns = int(columns)

mylist = ['name1', 'name2', 'name3','name4']
prog = 0
for name in mylist:
    prog += 10
    bar = '[%-66s] %d%%' % ('#'*prog, (prog*1.51515151515))
    spaces_left = columns-len(bar)
    sys.stdout.write(bar+(" "*spaces_left)+name+('\b'*(len(name) + columns)))
    sys.stdout.flush()
    sleep(.5) 
```

# c# - 从 API 将 Byte[] 读入数据库

> ID：15256579
> 
> 赞同：1
> 
> 时间：2013-03-06T19:45:04.533
> 
> 标签：c#, linq, api, bytearray, evernote

我一直在阅读[这篇](https://stackoverflow.com/questions/1271225/c-sharp-reading-a-file-line-by-line)文章，因为我想通过 LINQ 做到这一点。但是，我一直无法弄清楚如何从 API 读取数据。

当我输出`resource.Data.Body`它说，`Byte[]`.

当我输出`resource.Data.Size`它说，`834234822`. （或类似的东西）

我正在尝试将内容保存到我的数据库中，如下所示：

```
newContent.ATTACHMENT = resource.Data.Body; 
```

但是，从未加载任何数据。我假设我必须遍历`Body`并将内容存储在一个变量中，但我不确定如何。

有人可以帮我在这里连接点吗？

**编辑：**

这是我试图阅读的二进制数据的来源[http://dev.evernote.com/start/core/resources.php](http://dev.evernote.com/start/core/resources.php)

**编辑2：**

我正在使用以下代码，它为我提供二进制数据并保存到数据库，但它一定是损坏的，或者是因为当我打开文件时 Windows 照片查看器说它已损坏或太大......

```
Resource resource = noteStore.getResource(authToken, attachment.Guid, true, false, true, true);

            StringBuilder data = new StringBuilder();

            foreach(byte b in resource.Data.Body)
            {
                data.Append(Convert.ToString(b, 2).PadLeft(8, '0'));  
            }
...
newContent.ATTACHMENT = System.Text.Encoding.ASCII.GetBytes(data.ToString()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T21:16:03.760

鉴于`resource.Data.Body`is`byte[]`和`newContent.ATTACHMENT`is `System.Data.Linq.Binary`，您应该使用`System.Data.Linq.Binary`接受类型为输入参数的构造函数`byte[]`。[http://msdn.microsoft.com/en-us/library/bb351422.aspx](http://msdn.microsoft.com/en-us/library/bb351422.aspx)

```
newContent.ATTACHMENT = new System.Data.Linq.Binary(resource.Data.Body); 
```

# javascript - 如何判断是否没有重点？

> ID：15256580
> 
> 赞同：1
> 
> 时间：2013-03-06T19:45:08.500
> 
> 标签：javascript, jquery

我想知道如何在 js / jQuery 中为 if 语句编写条件，即什么都不关注。

我想一个可以解决这个问题的方法是一切都模糊了？

我需要一些帮助将其转换为 if 语句，我可以将代码作为套件放入其中，然后仅在当前没有关注任何内容时才执行它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:55:11.530

`$('*:focus').length`将返回关注页面的元素数量。

*   [jsFiddle](http://jsfiddle.net/A8bca/1/)

要在 if 语句中使用它，您可以简单地检查是否没有匹配的元素，然后运行您想要的任何代码。

```
if ($('*:focus').length == 0) {
     //do Something
} 
```

**参考：**

*   [。长度](http://api.jquery.com/length/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:56:47.750

你可以试试这个

它不是一个完整的解决方案，但如果没有发布您使用的代码，它就已经是病态了。你大概可以从这里弄清楚。

```
<div id="content">
<input tabIndex="1">
<input tabIndex="2">
<select tabIndex="3">
<option>select menu</option>
</select>
<div tabIndex="4">
a div
</div> 
```

> 这测试没有使用 ! 操作员

```
$(document).ready(function(){
if (!$(':input').is(':focus')){
alert('no focus');
}
}); 
```

[http://jsfiddle.net/Jvev2/](http://jsfiddle.net/Jvev2/)

# jquery - 关于在 mvc razor 中使用 Kendo ui 上传的过滤器文件类型

> ID：15256585
> 
> 赞同：2
> 
> 时间：2013-03-06T19:45:35.443
> 
> 标签：jquery, asp.net-mvc-3, file-upload, razor, kendo-ui

我使用剑道上传来上传图片，但我无法过滤上传的文件类型。我使用此代码将其过滤为“.jpg”文件。我不知道如何更改并将其用于所有图像扩展名，例如“.png”、“.gif”……而且此代码区分大小写。这意味着如果文件扩展名相同“.jpg”，它不会识别它。

```
var onSelect = function(e) {
    $.each(e.files, function(index, value) {
      if(value.extension != ".JPG") {
        e.preventDefault();
        alert("Please upload jpg image files");
      }
    });
};

// initialize and configure an Upload widget with a select event handler
$("#photos").kendoUpload({
    select: onSelect
}); 
```

我怎样才能改变和纠正它？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T21:23:00.737

这不受支持，它几乎不取决于您的目标浏览器。基本上，您可以在 Upload**初始化**后应用 accept 属性，如下所示：

```
$('#uploadName').attr('accept',"audio/*,video/*,image/*") 
```

您可以在此[问题](https://stackoverflow.com/questions/8938124/how-to-filter-input-type-file-dialog-by-specific-file-type)中找到有关该属性的更多信息。

# java - 输入键以在可编辑的 JComboBox 上表现为 Tab

> ID：15256588
> 
> 赞同：0
> 
> 时间：2013-03-06T19:45:58.800
> 
> 标签：java, swing, listener, jcombobox

我有一个 JComboBox 设置为可编辑，我希望用户能够在按下回车键后跳转到下一个控件。我尝试了很多方法，但都没有奏效，其中一个事件被成功触发（EditorCompoment.keyRelease）但是方法“transferFocus（）”并没有像它应该的那样将焦点转移到下一个控件。任何帮助深表感谢。谢谢

```
public static void addEnterKeyListener(final javax.swing.JComboBox field)
{
    field.putClientProperty("JComboBox.isTableCellEditor", Boolean.TRUE);
    field.setFocusTraversalKeysEnabled(false);

    Action myAction = new AbstractAction() {

    @Override
    public void actionPerformed(ActionEvent e) {

        field.transferFocus();
    }

    };

    field.getActionMap().put("enter-action", myAction);

    field.getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT).put(KeyStroke.getKeyStroke("ENTER"), "enter-action");

    field.addKeyListener(new KeyAdapter()
    {
        @Override
        public void keyReleased(final KeyEvent e)
        {
            if (e.getKeyCode() == KeyEvent.VK_ENTER)
            {
                System.out.println("Pressed enter inside JComboBox");
                field.transferFocus();
            }
        }
    });

    field.getEditor().getEditorComponent().addKeyListener(new KeyAdapter()
    {
        @Override
        public void keyReleased(final KeyEvent e)
        {
            System.out.println("Pressed enter inside JComboBox #2");

            if (e.getKeyCode() == KeyEvent.VK_ENTER)
            {                    
                field.transferFocus();
                /*This will fire but will not transfer the focus to the next control*/
                System.out.println("Transfered the focus from JComboBox");
            }
        }
    });

    field.getEditor().addActionListener(new ActionListener() 
    {
        @Override public void actionPerformed(ActionEvent arg0) 
        {
            field.transferFocus();
        }               
    });

    System.out.println("Added enter events to JComboBox");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:22:47.177

将 ActionListener 应用于组合编辑器的 editorComponent（一个 JTextField）：

```
import java.awt.*;
import java.awt.event.*;

import javax.swing.*;

public class JComboBoxDemo implements Runnable
{
  public static void main(String[] args)
  {
    SwingUtilities.invokeLater(new JComboBoxDemo());
  }

  public void run()
  {    
    JComboBox comboBox = new JComboBox(new String[]{"A", "B", "C"});
    comboBox.setEditable(true);

    final JTextField editorComponent = (JTextField) comboBox.getEditor().getEditorComponent();
    editorComponent.addActionListener(new ActionListener()
    {
      @Override
      public void actionPerformed(ActionEvent e)
      {
        editorComponent.transferFocus();
      }
    });

    JPanel panel = new JPanel(new FlowLayout());
    panel.add(new JLabel("Field 1"));
    panel.add(comboBox);
    panel.add(new JLabel("Field 2"));
    panel.add(new JTextField(10));
    panel.add(new JLabel("Field 3"));
    panel.add(new JTextField(10));

    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setLocationRelativeTo(null);

    Container c = frame.getContentPane();
    c.setLayout(new BorderLayout());
    c.add(panel, BorderLayout.CENTER);
    frame.pack();
    frame.setVisible(true);
  }
} 
```

# c# - 防止网格视图中的 SQL 注入

> ID：15256594
> 
> 赞同：1
> 
> 时间：2013-03-06T19:46:25.120
> 
> 标签：c#, asp.net, .net, sql-injection

我想仔细检查以确保这可以正确防止注射。

我有在 ASP .NET 3.5 中使用 GridView（很久很久以前由其他人编写）的旧代码。

在 .aspx 页面中（GridView 使用此数据源）：

```
<asp:SqlDataSource ID="sdsUserTables" runat="server" 
    ConnectionString="<%$ ConnectionStrings:Main %>" 
    DeleteCommand="DELETE FROM [MyTable] WHERE [tableID] = @tableID">
    <DeleteParameters>
        <asp:Parameter Name="tableid" Type="Int32" />
    </DeleteParameters>        
</asp:SqlDataSource> 
```

这会阻止对 tableId 的注入吗？

后面的代码是这样的：

```
protected void sdsUserTables_Deleting(object sender, SqlDataSourceCommandEventArgs e)
{
    e.Command.Parameters["@tableId"].Value = myTableId;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:34:06.543

我认为在您上面给出的示例中，您绝对是安全的。清理输入始终是最佳实践。

假设您有一个带有文本框的表单（某种类型），它对可以输入的文本数量没有限制（这可能*非常*糟糕）。

这是一个例子：

```
sqlParameter sqlParam = new SqlParameter();
sqlParam.ParameterName = "@testParam";
sqlCommand.Parameters.AddWithValue("@testParam", textBox1.Text); 
```

在上面的示例中，再次假设您的文本框未绑定，您将潜在的恶意字符串填充到参数中的事实可以*防止*原始数据对您的表/数据库产生不良影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:25:43.393

在我看来，这段代码可以防止 SQL 注入攻击：

*   您正在为 SQL 查询使用`<asp:Parameter>`标签。通过这种方式，它不会成为 SQL 命令的一部分，而是作为参数发送到 SQL 服务器：这是正确的方式，无论其类型如何。

*   标记中的 SQL 命令和连接字符串`<asp:SqlDataSource>`将嵌入到程序集中：它对用户不可用，也不在页面中可见。所以它不能被篡改。

如果你想强制执行一般的 SQL 注入保护：

确保`[validateRequest][1]`您的页面参数设置为“true”：

```
// This parameter is normally set to "true" by default in the machine.config file
<pages validateRequest="true" /> 
```

*   还有一个好习惯是验证**所有**用户输入，并将输入长度限制为必要数量的字符。

例如：

```
// assuming myTableId is a string

try
{
    int i = int.Parse(myTableId)
    e.Command.Parameters["@tableId"].Value = i;
}
catch
{
    throw new ApplicationException("Table Id should be an integer");
} 
```

如果您的用户输入是字符串，那么如果您使用参数，则无需检查每个 SQL 关键字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T19:54:07.450

是的，您正在使用一个变量并且它的类型已声明，这两个因素将防止 SQL 注入攻击。

见... [http://www.mikesdotnetting.com/Article/113/Preventing-SQL-Injection-in-ASP.NET](http://www.mikesdotnetting.com/Article/113/Preventing-SQL-Injection-in-ASP.NET)

您可以通过将您的 sql 代码转换为存储过程并将变量传递给该过程来执行完全相同的操作。

# python - 向调用者命名空间添加动态类

> ID：15256595
> 
> 赞同：0
> 
> 时间：2013-03-06T19:46:38.200
> 
> 标签：python

### 问题

> 无法在函数内动态创建具有本地范围的类，但可以在顶层工作。

### 问题

> 如何在正确的命名空间范围内动态创建类。

* * *

我正在尝试动态创建添加到调用者命名空间的类。

这样我就可以做到以下几点。

```
import creator
creator.make('SomeClass')
print "SomeClass :", SomeClass 
```

这可以在顶层添加动态类时工作，**但是**当试图在函数中做同样的事情时，这样创建的类只有本地范围，它不起作用。

我看到当放置在函数内部时有一些***[hack可以工作，但它会消失。](https://stackoverflow.com/a/1549221/1481060)***

下面的代码显示的问题显然`creator.py`比显示的要多。

```
# creator.py    
import inspect

def make(classname):
    t = type(classname, (object,), { })
    frame = inspect.currentframe()
    print "WILL make() - callers locals :", frame.f_back.f_locals.keys()
    frame.f_back.f_locals[classname] = t
    print "DID  make() - callers locals :", frame.f_back.f_locals.keys()
    return t 
```

* * *

```
# example.py
import creator

print  "WILL __main__ - locals :", locals().keys()
creator.make('SomeClass')
print  "DID  __main__ - locals :", locals().keys()

print "SomeClass :", SomeClass
print "-" * 80

def closed():
    # This hack helps
    # https://stackoverflow.com/a/1549221/1481060
    # exec ''

    class ClosedClass: pass

    print  "WILL closed() - locals :", locals().keys()
    creator.make('AnotherClass')
    print  "DID  closed() - locals :", locals().keys()

    # NOT EXPECTED
    try: print  AnotherClass
    except NameError, ex: print "OUCH:", ex

closed() 
```

输出：

```
WILL __main__ - locals : ['creator', '__builtins__', '__file__', '__package__', '__name__', '__doc__']
WILL make() - callers locals : ['creator', '__builtins__', '__file__', '__package__', '__name__', '__doc__']
DID  make() - callers locals : ['creator', '__builtins__', 'SomeClass', '__file__', '__package__', '__name__', '__doc__']
DID  __main__ - locals : ['creator', '__builtins__', 'SomeClass', '__file__', '__package__', '__name__', '__doc__']
SomeClass : <class 'creator.SomeClass'>
--------------------------------------------------------------------------------
WILL closed() - locals : ['ClosedClass']
WILL make() - callers locals : ['ClosedClass']
DID  make() - callers locals : ['ClosedClass', 'AnotherClass']
DID  closed() - locals : ['ClosedClass', 'AnotherClass']
OUCH: global name 'AnotherClass' is not defined 
```

我当然不想要`OUCH:..`。

`locals()`在一个内部看`closed`会想象它应该可以工作，但正如 hack 中提到的那样，Python 编译器正在优化本地变量并且错过了新动态编译器的引入。

如果我取消注释该`exec ''`行，那么它可以工作。

我可以创建具有全局范围的这些类，但我试图保持我的命名空间干净。

我当然可以，`AnotherClass = creator.make('AnotherClass')`但我正在努力保持它`DRY`。

有没有办法让它在没有`exec ''`黑客的情况下工作？

还是让它们全球化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:59:43.730

**没有**。访问局部变量的*唯一*[`locals()`](http://docs.python.org/2/library/functions.html#locals)方法是通过or`vars()`并且在这两种情况下，文档都明确指出不能保证对`dict`返回的修改会影响局部变量，因此：没有办法可靠地做到这一点。

如果您想*静态*地修改局部变量，那么*也许*您可以修改与函数关联的代码对象以提供更多局部变量，但这可能是不可能的，或者很难可靠地做到这一点，我认为没有理由这样做。

# javascript - 如何在 D3 节点中偏移文本

> ID：15256598
> 
> 赞同：1
> 
> 时间：2013-03-06T19:46:42.693
> 
> 标签：javascript, d3.js, label, force-layout

我正在尝试使用 D3 javascript 库来制作一个力导向图，并且我想偏移附加到我的节点的文本。但是，我似乎尝试更改的任何属性都不会对此产生影响。相反，我的文本覆盖在节点上，很难阅读：

![在此处输入图像描述](../Images/8c905878f43c05f71e7a485f6c8c82c7.png)

这是我附加文本的方式：

```
 node.append("text")
      .attr("dy", -3)
      .attr("text-anchor", "right")
      .style("color", "white", null)
      .text(function(d) { return d.name; }); 
```

我尝试了不同的*dx*和*dy*值，但似乎没有任何东西可以抵消文本。它看起来总是一样的。

* * *

编辑：完整代码（[http://g.nychis.com/force-directed.zip](http://g.nychis.com/force-directed.zip)并打开 force-edges-names.html）

```
<!DOCTYPE html>
<html>
  <head>
    <title>Force-Directed Layout</title>
    <script type="text/javascript" src="d3.v2.js"></script>
    <style type="text/css">

div.node {
  border-radius: 12px;
  width: 24px;
  height: 24px;
  margin: -6px 0 0 -6px;
  position: absolute;
}

div.link {
  position: absolute;
  border-bottom: solid #999 1px;
  height: 0;
  -webkit-transform-origin: 0 0;
  -moz-transform-origin: 0 0;
  -ms-transform-origin: 0 0;
  -o-transform-origin: 0 0;
  transform-origin: 0 0;
}

    </style>
  </head>
  <body bgcolor="#000000">
  <FONT COLOR="#FFFFFF">Floor: 1</FONT>
    <script type="text/javascript">

var width = 700,
    height = 500,
    radius = 6,
    fill = d3.scale.category20();

var force = d3.layout.force()
    .gravity(0)
    .charge(-100)
    .linkDistance(function(d) { return (d.value-d.sub)*8; })
    .size([width, height]);

var vis = d3.select("body").append("div")
    .style("width", width + "px")
    .style("height", height + "px");

d3.json("home.json", function(json) {
  var link = vis.selectAll("div.link")
      .data(json.links)
    .enter().append("div")
      .attr("class", "link");

  var node = vis.selectAll("div.node")
      .data(json.nodes)
    .enter().append("div")
      .attr("class", "node")
      .style("background", function(d) { return fill(d.group); })
      .style("border-color", function(d) { return d3.rgb(fill(d.group)).darker(); })
      .call(force.drag);

  node.append("text")
        .style("color", "white", null)
      .text(function(d) { return d.name; });

  force
      .nodes(json.nodes)
      .links(json.links)
      .on("tick", tick)
      .start();

  function tick() {
    node.style("left", function(d) { return (d.x = Math.max(radius, Math.min(width - radius, d.x))) + "px"; })
        .style("top", function(d) { return (d.y = Math.max(radius, Math.min(height - radius, d.y))) + "px"; });

    link.style("left", function(d) { return d.source.x + "px"; })
        .style("top", function(d) { return d.source.y + "px"; })
        .style("width", length)
        .style("-webkit-transform", transform)
        .style("-moz-transform", transform)
        .style("-ms-transform", transform)
        .style("-o-transform", transform)
        .style("transform", transform);
  }

  function transform(d) {
    return "rotate(" + Math.atan2(d.target.y - d.source.y, d.target.x - d.source.x) * 180 / Math.PI + "deg)";
  }

  function length(d) {
    var dx = d.target.x - d.source.x,
        dy = d.target.y - d.source.y;
    return Math.sqrt(dx * dx + dy * dy) + "px";
  }
});

    </script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T18:39:04.827

```
node.append("text")
  .attr({
    "dy": -3,
    "transform": "translate(" + 15 + "," + 5 + ")"
  })
  .style("color", "white", null)
  .text(function(d) { return d.name; }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:54:16.047

您可以翻译文本元素：

```
node.append("div")
    .style("transform", "translate(0px,-10px)")
    ...
    .html(...); 
```

“转换”属性的名称取决于您使用的浏览器，请参见[此处](http://www.w3schools.com/cssref/css3_pr_transform.asp)。您可能想要设置所有这些。

# angularjs - 在嵌套的 ng-repeat 中传递 2 个 $index 值

> ID：15256600
> 
> 赞同：329
> 
> 时间：2013-03-06T19:46:51.700
> 
> 标签：angularjs, angularjs-ng-repeat

所以我有一个 ng-repeat 嵌套在另一个 ng-repeat 中，以构建导航菜单。在每个`<li>`内部 ng-repeat 循环中，我设置了一个 ng-click，它通过传入 $index 来调用该菜单项的相关控制器，让应用程序知道我们需要哪个控制器。但是，我还需要从外部 ng-repeat 传入 $index，以便应用程序知道我们在哪个部分以及哪个教程。

```
<ul ng-repeat="section in sections">
    <li  class="section_title {{section.active}}" >
        {{section.name}}
    </li>
    <ul>
        <li class="tutorial_title {{tutorial.active}}" ng-click="loadFromMenu($index)" ng-repeat="tutorial in section.tutorials">
            {{tutorial.name}}
        </li>
    </ul>
</ul> 
```

这是一个 Plunker [http://plnkr.co/edit/bJUhI9oGEQIql9tahIJN?p=preview](http://plnkr.co/edit/bJUhI9oGEQIql9tahIJN?p=preview)

* * *

## 回答 #1

> 赞同：480
> 
> 时间：2013-03-06T20:38:07.847

每个 ng-repeat 使用传递的数据创建一个子作用域，并`$index`在该作用域中添加一个附加变量。

所以你需要做的是达到父范围，并使用它`$index`。

见[http://plnkr.co/edit/FvVhirpoOF8TYnIVygE6?p=preview](http://plnkr.co/edit/FvVhirpoOF8TYnIVygE6?p=preview)

```
<li class="tutorial_title {{tutorial.active}}" ng-click="loadFromMenu($parent.$index)" ng-repeat="tutorial in section.tutorials">
    {{tutorial.name}}
</li> 
```

* * *

## 回答 #2

> 赞同：207
> 
> 时间：2014-01-03T19:35:24.510

比`$parent.$index`使用更优雅的解决方案[`ng-init`](http://docs.angularjs.org/api/ng.directive:ngInit)：

```
<ul ng-repeat="section in sections" ng-init="sectionIndex = $index">
    <li  class="section_title {{section.active}}" >
        {{section.name}}
    </li>
    <ul>
        <li class="tutorial_title {{tutorial.active}}" ng-click="loadFromMenu(sectionIndex)" ng-repeat="tutorial in section.tutorials">
            {{tutorial.name}}
        </li>
    </ul>
</ul> 
```

Plunker：[http ://plnkr.co/edit/knwGEnOsAWLhLieKVItS?p=info](http://plnkr.co/edit/knwGEnOsAWLhLieKVItS?p=info)

* * *

## 回答 #3

> 赞同：122
> 
> 时间：2015-07-17T13:53:40.210

使用这种语法怎么样（看看这个[plunker](http://plnkr.co/edit/tc7j8wWrReiq0xvA1bjH?p=preview)）。我刚刚发现了这一点，它非常棒。

```
ng-repeat="(key,value) in data" 
```

例子：

```
<div ng-repeat="(indexX,object) in data">
    <div ng-repeat="(indexY,value) in object">
       {{indexX}} - {{indexY}} - {{value}}
    </div>
</div> 
```

使用此语法，您可以为这两个索引命名`$index`并区分这两个索引。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2015-07-12T22:23:22.307

只是为了帮助到达这里的人......你不应该使用 $parent.$index 因为它不是很安全。如果你在循环中添加一个 ng-if，你会得到 $index 的混乱！

**正确的路**

```
 <table>
    <tr ng-repeat="row in rows track by $index" ng-init="rowIndex = $index">
        <td ng-repeat="column in columns track by $index" ng-init="columnIndex = $index">

          <b ng-if="rowIndex == columnIndex">[{{rowIndex}} - {{columnIndex}}]</b>
          <small ng-if="rowIndex != columnIndex">[{{rowIndex}} - {{columnIndex}}]</small>

        </td>
    </tr>
  </table> 
```

检查：[plnkr.co/52oIhLfeXXI9ZAynTuAJ](http://plnkr.co/52oIhLfeXXI9ZAynTuAJ)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-06-02T12:41:00.353

只需使用`ng-repeat="(sectionIndex, section) in sections"`

这将在下一个级别 ng-repeat down 上可用。

```
<ul ng-repeat="(sectionIndex, section) in sections">
    <li  class="section_title {{section.active}}" >
        {{section.name}}
    </li>
    <ul>
        <li ng-repeat="tutorial in section.tutorials">
            {{tutorial.name}}, Your section index is {{sectionIndex}}
        </li>
    </ul>
</ul> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-03-06T20:38:33.453

在处理对象时，您希望尽可能方便地忽略简单的 id。

如果您将点击线更改为此，我认为您会顺利进行：

```
<li class="tutorial_title {{tutorial.active}}" ng-click="loadFromMenu(tutorial)" ng-repeat="tutorial in section.tutorials"> 
```

另外，我认为您可能需要更改

```
class="tutorial_title {{tutorial.active}}" 
```

类似于

```
ng-class="tutorial_title {{tutorial.active}}" 
```

请参阅[http://docs.angularjs.org/misc/faq](http://docs.angularjs.org/misc/faq)并查找 ng-class。

# css - 使用 ColdFusion 通过 URL 设置 CSS 类

> ID：15256601
> 
> 赞同：3
> 
> 时间：2013-03-06T19:46:57.483
> 
> 标签：css, coldfusion, cfml

在下面的代码中，我希望`li`根据我当前使用的 URL 以编程方式使用 ColdFusion 将类设置为“活动”。所以在这个例子中，我已经登陆 main.cfm 并且需要将该特定`li`类设置为活动的。如果我在 www.mysite.com/review.cfm，我想将该类设置为“活动”。

```
<div id="menu">
    <ul>
        <li class="active"><a href="main.cfm">Main</a></li>
        <li class=""><a href="review.cfm" title="">Review</a></li>
        <li class=""><a href="https://www.mysite.com">My Site</a></li>
        <li class=""><a href="reporting">Reporting</a></li>
        <li class=""><a href="#">Logout</a></li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:56:28.370

冷融合 9：

```
<cfset class = ListLast(cgi.Script_Name, '/') EQ "main.cfm" ? "active" : "">
<li class="#class#"><a href="main.cfm">Main</a></li> 
```

ColdFusion 8 或以下，使用好旧的`<cfif>`

```
<cfset class = "">
<cfif ListLast(cgi.Script_Name, '/') EQ "main.cfm">
   <cfset class = "active">
</cfif>
<li class="#class#"><a href="main.cfm">Main</a></li> 
```

**更新**：或者正如 KRC 在评论中建议的那样（ColdFusion 8 或更低版本）：

```
<li IIF(ListLast(cgi.Script_Name, '/') EQ "main.cfm", DE('class="active"'), '')>
  <a href="main.cfm">Main</a>
</li> 
```

# android - 在没有用户交互的情况下在安卓游戏期间保持屏幕开启

> ID：15256602
> 
> 赞同：3
> 
> 时间：2013-03-06T19:47:00.703
> 
> 标签：android, mobile, libgdx

我正在为我的安卓游戏使用 Libgdx。游戏运行良好，但如果没有用户交互，它会在运行时自动暂停。如何避免游戏暂停？

我的主类实现`AndroidApplication`，我的游戏类实现`ApplicationListener`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-06T20:25:18.873

虽然 JRowan 的回答对一般的 Android 应用程序很好，并且可以与 Libgdx 一起使用，但您也可以使用 Libgdx 支持来获取唤醒锁。见[`useWakelock`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/backends/android/AndroidApplicationConfiguration.html#useWakelock)中[`AndroidApplicationConfiguration`](https://github.com/libgdx/libgdx/blob/master/backends/gdx-backend-android/src/com/badlogic/gdx/backends/android/AndroidApplicationConfiguration.java)。Libgdx 将为您跟踪唤醒锁。不过，您仍然需要清单中的适当权限。

具体来说，在您的扩展类中`AndroidApplication`：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    AndroidApplicationConfiguration cfg = new AndroidApplicationConfiguration();
    cfg.useWakelock = true;

    initialize(new MyGdxGame(), cfg);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:50:11.663

```
PowerManager powerManager = (PowerManager) getSystemService(Context.POWER_SERVICE);
    wakeLock = powerManager.newWakeLock(PowerManager.FULL_WAKE_LOCK, "GLGame");
wakeLock.acquire(); 
```

你必须把权限唤醒锁放在你的清单中

当你完成唤醒锁时释放它

```
wakeLock.release(); 
```

或者

更安全的方法是对活动中的某些视图使用 setKeepScreenOn() 或 android:keepScreenOn。您不需要 WAKE_LOCK 权限，并且您不能因为未能释放它而轻易搞砸它。一旦 keep-screen-on 视图不再位于前台，设备行为就会恢复正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-04T14:46:57.240

更好更简单的方法，无需担心释放任何东西

只需将此代码复制到 AndroidLauncher.java 文件中

> @Override protected void createWakeLock(boolean use) { use=true; super.createWakeLock(使用); }

有关更多信息，请参见[在此处输入链接描述](https://stackoverflow.com/questions/40160469/how-to-awake-screen-while-game-play-in-libgdx/41466524#41466524)

# javascript - javascript假导航器

> ID：15256604
> 
> 赞同：0
> 
> 时间：2013-03-06T19:47:03.723
> 
> 标签：javascript

这是我的脚本：

```
function ShowProps(obj, objName)
{
    var result = '';
    for (var i in obj) 
    {
          var obj_i = obj[i];
        result += i + ": " + obj[i] + "\n";
        alert(result); // PRINT
    }
}
var fakenav = navigator;
fakenav.platform = "fake";
navigator = fakenav;

ShowProps(navigator); 
```

如您所见，我只是想替换导航器的“平台”属性。但它没有改变，打印时显示“Win32”，但我想要的是“假的”。

我究竟做错了什么？

问候！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T19:49:52.130

对于初学者，您不能真正更改导航器对象的平台属性。它是只读的！

通过分配`navigator`给`fakenav`您并没有真正复制它。你只是参考。

目前尚不清楚您真正想要实现的目标，但这条路线可能不是到达那里的方式..

# jquery - .load() 在 jquery 1.9.1 中无法正常运行

> ID：15256607
> 
> 赞同：0
> 
> 时间：2013-03-06T19:47:12.540
> 
> 标签：jquery

我正在运行以下简单脚本：

```
$(function(){
$('#divName').load('http://www.mydomain.com/someurl/');
}); 
```

在 jQuery 1.8.3 中，它按预期将外部页面（相同的域名）加载到 #divName 中。在 1.9.1 中，它什么也不做。有趣的是，如果我运行：

```
$('#divName').load('http://www.mydomain.com/someurl/'); 
```

在控制台中，它按预期运行；它只是没有在 document.ready 上自动执行。jQuery 迁移插件修复了这个问题，但是它没有给我任何指示问题所在的警告。

我没有迫切需要升级到 1.9，所以现在我坚持使用 1.8.3，但我肯定想知道 1.9 中的哪些变化导致了这个问题，以便我 (a) 了解未来(b) 可以按照我的喜好继续使用最新版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:50:33.360

考虑到细节，我能想到的唯一可能的解释是，您 `<div id="divName">`是通过 ajax 添加到 DOM 就绪的，因此它在 DOM 就绪处理程序的早期部分尚不可用。

尝试执行`console.error($('#divName').length)`并查看节点是否存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:05:57.617

问题是由不相关的插件中的错误引起的。删除插件后，问题自行解决。

# matlab - 笛卡尔积的Matlab矢量化

> ID：15256609
> 
> 赞同：0
> 
> 时间：2013-03-06T19:47:28.670
> 
> 标签：matlab, vectorization

假设我有两个数组 X 和 Y，我需要一个矩阵 M(i, j) = some_func(X(i), Y(j))。我怎样才能在不使用循环的情况下得到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T21:07:10.710

最好的答案是使用 bsxfun，如果它是一个选项。根据 bsxfun 的帮助，它适用于任何一般的二元函数，只要：

```
 FUNC can also be a handle to any binary element-wise function not listed
    above. A binary element-wise function in the form of C = FUNC(A,B)
    accepts arrays A and B of arbitrary but equal size and returns output
    of the same size. Each element in the output array C is the result
    of an operation on the corresponding elements of A and B only. FUNC must
    also support scalar expansion, such that if A or B is a scalar, C is the
    result of applying the scalar to every element in the other input array. 
```

如果您的函数只接受标量输入，那么循环是简单的替代方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T19:53:12.247

很难回答您的模糊问题，这最终取决于您的功能。您可以做的是使用`meshgrid`然后执行您的操作，通常使用点运算符

例如

```
x = 1:5;
y = 1:3;

[X,Y] = meshgrid (x,y)

M = X.^Y; 
```

# ruby-on-rails - RVM Ruby / Brew 安装问题

> ID：15256616
> 
> 赞同：1
> 
> 时间：2013-03-06T19:47:49.107
> 
> 标签：ruby-on-rails, ruby, homebrew

当我尝试在运行 OSX 10.8.2 的 Mac Mini 上安装 ruby​​ 或 brew 时，我遇到了这个问题：

```
$ rvm install 1.9.3
Searching for binary rubies, this might take some time.
No binary rubies available for: osx/10.8/x86_64/ruby-1.9.3-p392.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.
Installing requirements for osx/10.8/x86_64, might require sudo password
Skipping `brew update` make sure your formulas are up to date.
/usr/local/bin/brew: /usr/local/Library/brew.rb: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby: bad interpreter: No such file or directory
/usr/local/bin/brew: line 21: /usr/local/Library/brew.rb: Undefined error: 0
/usr/local/bin/brew: /usr/local/Library/brew.rb: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby: bad interpreter: No such file or directory
/usr/local/bin/brew: line 21: /usr/local/Library/brew.rb: Undefined error: 0 
```

我不确定发生了什么。我应该重新安装 XCode 来清理我的框架吗？

出了什么问题，我该如何解决？如果之前有人问过这个问题，我很抱歉，但无论是谷歌还是 symbolhound 都无法找到有关该错误的任何结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T20:46:28.530

问题源于我安装的 Ruby。显然，如[本答案](https://stackoverflow.com/a/9905801/1292230)所述，“非 LLVM 版本的 GCC”不再包含在 XCode 命令行工具中。

安装红宝石：

`rvm install ruby --with-gcc=clang`

工作，我在大约 10 分钟内安装了 RVM、Ruby 和 Rails，尽管我花了一周的时间进行调试和重新安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:54:46.643

做`sudo rvm install 1.9.3`。这应该可以解决您的问题。

# php - php & cookies : 数组中最后一次访问的 $articleid

> ID：15256617
> 
> 赞同：0
> 
> 时间：2013-03-06T19:47:56.170
> 
> 标签：php, cookies

我对饼干的经验很少，所以我不知道该怎么做。

我有一家 T 恤店，每件 T 恤都有一个`$articleID`.

每次用户访问 T 恤页面时，我都想将其添加`$articleID`到 cookie 中。然后将其添加到数组或其他东西中，以便我以后可以检索它。`$articleID`即使访问者访问了`$articleID`两次，也不应该有任何重复。

然后在主页上，我想检索最近 5 次`$articleID`访问的列表并显示 ID 列表。

我怎么能那样做？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:04:02.780

为了在您的 cookie 中存储一个数组，您需要对其进行序列化，因此请检查此代码是否有帮助

```
$articles = array();

if ( isset($_COOKIE["viewed_articles"]) )
  $articles = unserialize($_COOKIE["viewed_articles"]);

if ( ! in_array($articleID, $articles)){
    $articles[] = $articleID;
}
// at the end update the cookies
setcookie("viewed_articles", serialize($articles)); 
```

我希望这会有所帮助，并在此[链接上有一个循环](http://www.w3schools.com/php/php_cookies.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:53:31.337

像这样的东西？

```
<?php
$article_id = 1; // Whichever article you're currently viewing
session_start();

if ( ! isset($_SESSION['viewed_articles']))
{
    $_SESSION['viewed_articles'] = array();
}

if ( ! in_array($article_id, $_SESSION['viewed_articles']))
{
    $_SESSION['viewed_articles'][] = $article_id;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:53:31.483

您是否尝试过使用会话？Cookies 将值存储在用户计算机上。每次页面加载时，该数据都会传输到您的 Web 服务器。

会话将数据存储在服务器端。会话通过将会话 ID 作为 cookie 存储在用户浏览器上来工作，该 cookie 对应于存储在服务器上的会话。

如果您使用的是 PHP，您可以使用

```
<?php
session_start();
$_SESSION['key'] = 'value';
echo $_SESSION['key']; // outputs: value
?> 
```

# ruby - dRuby 服务器在其侦听的端口上探测时崩溃

> ID：15256619
> 
> 赞同：0
> 
> 时间：2013-03-06T19:47:59.360
> 
> 标签：ruby, jruby, drb

我有这个测试代码：

```
require 'drb/drb'

DRb.start_service(nil, "hello")
puts DRb.uri
DRb.thread.join() 
```

如果我随后使用 nmap 之类的东西探测它抓取的端口，经过几次探测，应用程序就会崩溃。

在 JRuby 1.7 下，我得到了这个堆栈：

```
Errno::ENOPROTOOPT: Protocol not available - Protocol not available
   setsockopt at org/jruby/ext/socket/RubyBasicSocket.java:294
  set_sockopt at /Users/kimptoc/.rvm/rubies/jruby-1.7.3/lib/ruby/1.9/drb/drb.rb:1005
   initialize at /Users/kimptoc/.rvm/rubies/jruby-1.7.3/lib/ruby/1.9/drb/drb.rb:927
       accept at /Users/kimptoc/.rvm/rubies/jruby-1.7.3/lib/ruby/1.9/drb/drb.rb:991
    main_loop at /Users/kimptoc/.rvm/rubies/jruby-1.7.3/lib/ruby/1.9/drb/drb.rb:1615
          run at /Users/kimptoc/.rvm/rubies/jruby-1.7.3/lib/ruby/1.9/drb/drb.rb:1465 
```

在 Ruby 1.9.3-392 下，堆栈是这样的：

```
/Users/kimptoc/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/drb/drb.rb:964:in `setsockopt': Invalid argument (Errno::EINVAL)
from /Users/kimptoc/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/drb/drb.rb:964:in `set_sockopt'
from /Users/kimptoc/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/drb/drb.rb:886:in `initialize'
from /Users/kimptoc/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/drb/drb.rb:950:in `new'
from /Users/kimptoc/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/drb/drb.rb:950:in `accept'
from /Users/kimptoc/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/drb/drb.rb:1574:in `main_loop'
from /Users/kimptoc/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/drb/drb.rb:1424:in `block in run' 
```

有没有办法让 dRuby 更健壮（例如某处的选项或配置设置）并且在这些情况下不会崩溃。

更新

通过将代码放在这样的循环中，这似乎使其更具弹性 - 但这是最​​好的前进方式：

```
while true
  begin
    DRb.start_service("druby://localhost:12345", "hello")
    puts DRb.uri
    DRb.thread.join()
  rescue Exception => e
    puts e.message
  end
end 
```

TIA

# apache-pig - 猪中的自我交叉加入被忽略

> ID：15256621
> 
> 赞同：9
> 
> 时间：2013-03-06T19:48:07.880
> 
> 标签：apache-pig, cross-join

如果有这样的数据：

```
A = LOAD 'data' AS (a1:int,a2:int,a3:int);

DUMP A;
(1,2,3)
(4,2,1) 
```

然后在 A、A 上进行交叉连接：

```
B = CROSS A, A;

DUMP B;
(1,2,3)
(4,2,1) 
```

为什么第二个 A 从查询中优化出来？

信息：猪版本 0.11

== 更新 ==

如果我对 A 进行排序：

```
C = ORDER A BY a1;
D = CROSS A, C; 
```

它将给出正确的交叉连接。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-06T21:49:53.527

davek 是正确的——你不能`CROSS`（或`JOIN`）与自身建立关系。如果您希望这样做，您必须创建数据的副本。在这种情况下，您可以使用另一个`LOAD`语句。如果您想对管道下方的关系执行此操作，则需要使用`FOREACH`.

我有几个我经常使用的宏，`IMPORT`默认情况下在我的所有 Pig 脚本中使用，以备不时之需。一个用于此目的：

```
DEFINE DUPLICATE(in) RETURNS out
{
        $out = FOREACH $in GENERATE *;
}; 
```

这将适用于您在管道中需要副本的任何地方：

```
A1 = LOAD 'data' AS (a1:int,a2:int,a3:int);
A2 = DUPLICATE(A1);
B = CROSS A1, A2; 
```

请注意，即使`A1`和`A2`相同，您也不能假设记录的顺序相同。但是，如果您正在执行`CROSS`or `JOIN`，这可能无关紧要。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-06T19:58:16.610

我认为您必须两次加载数据才能达到您想要的效果。

IE

```
A1 = LOAD 'data' AS (a1:int,a2:int,a3:int);
A2 = LOAD 'data' AS (a1:int,a2:int,a3:int);
B = CROSS A1, A2; 
```

# c# - 点击如何关闭TAB页面？

> ID：15256622
> 
> 赞同：2
> 
> 时间：2013-03-06T19:48:10.077
> 
> 标签：c#, winforms, browser

我正在制作一个**Web 浏览器**，我已经完成了一些部分，例如新标签页、书签、主页、默认搜索引擎等。我对如何关闭**TAB PAGE**感到困惑。我已经尝试过 Double click 、 Mouse down 、 up 等等，但我无法解决问题。我已经创建了这样的**TABPAGE**。提前感谢等待回复......

```
 private void tabControl1_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (tabControl1.SelectedTab.Text == "+")
        {
            AddNewTab();
        }
        foreach (Control item in tabControl1.SelectedTab.Controls)
        {
            if (item.GetType() == typeof(WebBrowser))
            {
                WebBrowser wb = (WebBrowser)item;
                toolStripButton1.Enabled = wb.CanGoBack;
                toolStripButton2.Enabled = wb.CanGoForward;
            }
        } 
```

快照我的 Window 表单应用程序

![在此处输入图像描述](../Images/cb445172f3ef2fda106b632a33418cc7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:14:58.383

只需尝试处理 TabPage。假设表单上有一个名为“关闭选项卡”的按钮：

```
private void closeTab_Click(object sender, EventArgs e) {
  if (tabControl1.SelectedTab != null) {
    tabControl1.SelectedTab.Dispose();
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:56:52.877

如果您有多个选项卡，则更改选项卡应该会触发代码。您的标记是否在标签声明中有 runat="server" ？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:55:22.257

您将需要 Javascript 来执行此操作。使用[window.close()：](https://developer.mozilla.org/en-US/docs/DOM/window.close)

```
close(); 
```

注意：当前窗口是隐含的。这是等价的：

```
window.close(); 
```

或者您可以指定不同的窗口。

所以：

```
function close_window() {
  if (confirm("Close Window?")) {
    close();
  }
} 
```

使用 HTML：

```
<a href="javascript:close_window();">close</a> 
```

或者：

```
<a href="#" onclick="close_window();return false;">close</a> 
```

您在此处返回 false 以防止事件的默认行为。否则，浏览器将尝试访问该 URL（显然不是）。

现在[window.confirm()](https://developer.mozilla.org/en-US/docs/DOM/window.confirm)对话框上的选项将是 OK 和 Cancel（不是 Yes 和 No）。如果你真的想要是和否，你需要创建某种模态 Javascript 对话框。

**注意**：与上述内容存在特定于浏览器的差异。如果您使用 Javascript（通过 window.open()）打开窗口，那么您可以使用 javascript 关闭窗口。Firefox 不允许您关闭其他窗口。我相信IE会要求用户确认。其他浏览器可能会有所不同。

# c++ - C++ 中取消的数值问题

> ID：15256624
> 
> 赞同：1
> 
> 时间：2013-03-06T19:48:16.897
> 
> 标签：c++, mpi, numeric, floating-accuracy, cancellation

我在浮点运算中确实存在取消问题。我知道问题出在哪里，但我想不出一个有效的解决方案。

这是我的问题：我有一个 3D 粒子模拟，所以每个粒子都有 3 个坐标（x，y，z）。整个域被分成子单元。在某一时刻，我计算了粒子在某个时间步长所在的子单元格的 ID。这是一个简单的公式：

```
 int cellOffset_y = (pos[1] - y_min) / cellWidth_y; 
```

pos[1] 是粒子的 x 坐标，y_min 是域的开始，cellWidth 是单元格的宽度。

这是我的问题：我有一个测试用例，在这种情况下粒子的坐标应该是 0。由于浮点不准确，它大约是。-3e-18。当我使用这个公式时，-3e-18 由于取消而下降。现在最大的问题是，由于粒子位置为负，并且边界正好在 0，我得到的 cellID 与粒子实际所在的 cellID 不同。

那么有人知道如何解决这个问题吗？我希望它说清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:01:11.013

基本上有两个选择（好吧，三个，如果你把“忍受这个问题”算作一个有效的选择！）：

1.  稍微移动网格中的边界，以允许一定程度的上游不准确。所以计算会变成`(pos - y_min + k) / width`，对于一些小的值`k`。

    当然，这并不能处理在另一个方向上发生的错误（即数字稍微太大）；事实上，这使情况变得更糟。但是没有通用的方法来解决这个问题；您的代码无法“知道” -3e-18 是正确的还是稍微错误的！

2.  修复上游计算。

# android - 在使用来自 youtube 的视频的视频视图中，android 使用线程更新搜索栏时出错

> ID：15256634
> 
> 赞同：1
> 
> 时间：2013-03-06T19:49:07.983
> 
> 标签：android, multithreading, performance, youtube, android-videoview

我将确切地解释我遇到的问题，在我为 android 开发的应用程序中，我有一个活动，我正在显示来自 youtube 的视频，以显示我正在使用**VideoView**的视频。我也有一个 progressSeekBar 能够更改视频的当前位置并能够看到剩下的内容。

为此，我做了下一个：

```
new Thread(new Runnable() {
            public void run() {
                try {
                    Log.d("Voizee", "Vengo al runnable.");

                    vSeekBarProgress.setProgress(getMediaPlayer()
                            .getCurrentPosition());
                    if (getMediaPlayer().getCurrentPosition() < getMediaPlayer()
                            .getDuration()) {
                        vSeekBarProgress.postDelayed(this, 1000);
                    }

                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }).start(); 
```

该代码正在运行，并且在播放视频时可以完美地移动搜索栏，但是视频的性能很差，并且显示缓慢并在不同的场景中跳跃。

所以请你帮我解决我遇到的这个问题。还有一件事要补充，如果我删除这个线程，视频它运行良好，没有任何性能问题，所以它与线程有关。

非常感谢您的帮助。

# python - OGR 距离单位

> ID：15256638
> 
> 赞同：0
> 
> 时间：2013-03-06T19:49:24.593
> 
> 标签：python, distance, units-of-measurement, gdal, ogr

我在 Python 中使用 OGR 距离来确定点和线之间的最短距离。我的结果与我使用 QGIS 得到的结果完全不同。我假设 OGR 使用的单位取决于坐标系？会不会是 OGR 使用度数？如果是这样，我怎么能将这些转换为米？我的代码如下所示：

```
import ogr

driver = ogr.GetDriverByName('ESRI Shapefile')

roads = driver.Open('G:/Basedata/OR/infra/TigerRoads2010/OR_TIGERroads_2010_merge.shp', 0)
point = driver.Open('U:/My Documents/Tool/shp/testareacentro.shp', 0)

roadslayer = roads.GetLayer()
pointl = point.GetLayer()

roadsfeature = roadslayer.GetNextFeature()
pointf = pointl.GetNextFeature()

roadgeom = roadsfeature.GetGeometryRef()
pointgeom = pointf.GetGeometryRef()

dist = pointgeom.Distance(roadgeom)

print dist 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:15:16.070

我的距离之所以关闭，是因为我只比较了第一个特征。这将产生与 QGIS 相同的结果：

```
import ogr

driver = ogr.GetDriverByName('ESRI Shapefile')

lineshp = driver.Open('U:/My Documents/Tool/shp/line.shp', 0)
linelyr = lineshp.GetLayer()

pointshp = driver.Open('U:/My Documents/Tool/shp/point.shp', 0)
pointlyr = pointshp.GetLayer()

linefeat = linelyr.GetNextFeature()
pointfeat = pointlyr.GetNextFeature()

point_geom = pointfeat.GetGeometryRef()

distlist = []
while linefeat:
    line_geom = linefeat.GetGeometryRef()
    dist = point_geom.Distance(line_geom)
    distlist.append(dist)
    linefeat.Destroy()
    linefeat = linelyr.GetNextFeature()

print min(distlist) 
```

# windows-phone - Windows Phone 滚动查看器不滚动

> ID：15256639
> 
> 赞同：2
> 
> 时间：2013-03-06T19:49:36.677
> 
> 标签：windows-phone, scrollviewer, stackpanel

由于某种原因，我位于 ScrollViewer 内的 StackPanel 没有滚动。

代码：

```
<ScrollViewer Height="478" Name="scrollerButtons" Width="Auto" Canvas.Left="668" Canvas.Top="2" VerticalAlignment="Bottom" ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Disabled" HorizontalContentAlignment="Center" VerticalContentAlignment="Bottom" HorizontalAlignment="Left">
        <StackPanel Name="stackPanelButtons" Orientation="Vertical" Canvas.Left="162" Canvas.Top="43" VerticalAlignment="Center" HorizontalAlignment="Center" Width="Auto">
            <Image Height="60" Name="imgA" Source="Images/a.png" Stretch="Fill" Width="60" Tap="imgA_Tap"></Image>
            <Image Height="60" Name="imgB" Source="Images/b.png" Stretch="Fill" Width="60" Tap="imgB_Tap"></Image>
        </StackPanel>
 </ScrollViewer> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:15:46.640

从禁用更改`ScrollViewer.VerticalScrollBarVisibility="Disabled"`为自动。

# c# - 如何使用 C# 函数进行 XML 到 XSLT 的转换

> ID：15256642
> 
> 赞同：1
> 
> 时间：2013-03-06T19:49:41.247
> 
> 标签：c#, xml, xslt, xslt-1.0

我有如下动态生成的 XML，它在运行时填充节点值。

```
<?xml version="1.0" encoding="utf-8" ?>
<master>
  <child>
    <category1>Category1_A</category1>
    <category2>Category2_B </category2>
  </child>
</master> 
```

我的 web.config 中有一个类别代码配置键，如下所示

```
<add  key="Code"  value="A1|A2" /> 
```

下面是我的 XSLT，我知道这不是很好的格式。

我在这个 XSLT 中有以下问题

1.  我如何在下面的函数中传递配置键，因为它不在 XML 中。
2.  如果此方法返回 false，那么我想从 XSLT 属性返回字符串消息，例如“抱歉，组合不匹配”。</li>
3.  我知道这有点令人困惑，但我知道这很有趣。

    ```
    <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        xmlns:msxsl="urn:schemas-microsoft-com:xslt"
        xmlns:user="urn:my-scripts">

      <msxsl:script language="C#" implements-prefix="user">
        <![CDATA[
         public string checkCategory (string category1,string category2)
         {
        if( (category1=="Category1_A" && category1==" Category2_B") && ConfigurationManager.AppSetting["Code"].contains("A1"))
           return true;
           else
          return false;
         }
          ]]>
      </msxsl:script>
      <xsl:template match="master">
        <child>
          <circumference>
            <xsl:value-of select="user: checkCategory (category1,category2)"/>
            <!--if method return false then : return Sorry, Combination doesn’t match.”-->
          </circumference>
        </child>
      </xsl:template>
    </xsl:stylesheet> 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T23:09:06.400

如果您的函数返回`true`and `false`，那么您应该将返回类型更改为`bool`：

```
<msxsl:script language="C#" implements-prefix="user">
    <![CDATA[
     public bool checkCategory (string category1,string category2)
     {
       if( (category1=="Category1_A" && category2==" Category2_B") && ConfigurationManager.AppSetting["Code"].contains("A1"))
         return true;
       else
         return false;
     }
   ]]>
</msxsl:script> 
```

你可以稍微简化一下代码：

```
<msxsl:script language="C#" implements-prefix="user">
   <![CDATA[
     public bool checkCategory (string category1,string category2)
     {
        return (category1 == "Category1_A" && category2 == "Category2_B") &&
                 ConfigurationManager.AppSetting["Code"].contains("A1");
     }
   ]]>
</msxsl:script> 
```

然后你可以只使用一个`xsl:if`：

```
 <xsl:template match="master">
    <child>
      <circumference>
        <xsl:if select="user:checkCategory(category1,category2)">
           <xsl:text>Sorry, Combination doesn’t match.</xsl:text>
        </xsl:if>
      </circumference>
    </child>
  </xsl:template> 
```

# java - 带有 GSON 的 Java - 仅将值反序列化为 JSON 字符串的 ArrayList

> ID：15256646
> 
> 赞同：0
> 
> 时间：2013-03-06T19:49:58.250
> 
> 标签：java, json, arraylist, deserialization, gson

我的 JSON 响应字符串的结构如下：

```
{
    "1":{
        "data1":"1","data2":"test1", ...
    },
    "2":{
        "data1":"6","data2":"test2", ...
    },
    ...
} 
```

我想将*值*放入`ArrayList<MyItem>`. 我使用 GSON，通常我可以这样做：

```
ArrayList<MyItem> items = 
    gson.fromJson(jsonString, new TypeToken<ArrayList<MyItem>>() {}.getType()); 
```

问题是，它不起作用，因为我的 JSON 字符串有数字作为键，但我只想获取要放入的值`ArrayList`（不幸的是，我自己无法更改 JSON 字符串）。我怎样才能有效地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:13:49.033

我可能会将 JSON 反序列化为 a ，使用[方法](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#values%28%29)从as a`java.util.Map`获取值[，](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#values%28%29)然后使用带有 a 的构造函数创建一个新[的](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html#ArrayList%28java.util.Collection%29)。`Map``Collection`[`Map.values()`](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#values%28%29)`ArrayList`[`Collection`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html#ArrayList%28java.util.Collection%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T22:26:57.377

编写自定义反序列化器。

```
class MyItem 
{
    String data1;
    String data2;
    // ...
}

class MyJSONList extends ArrayList<MyItem> {}

class MyDeserializer implements JsonDeserializer<MyJSONList> 
{
    public MyJSONList deserialize(JsonElement je, Type type, JsonDeserializationContext jdc) 
        throws JsonParseException
    {
        MyJSONList list = new MyJSONList();
        for (Entry<String, JsonElement> e : je.getAsJsonObject().entrySet())
        {
            list.add((MyItem)jdc.deserialize(e.getValue(), MyItem.class));
        }

        return list;
    }

} 
```

例子：

```
String json = "{\"1\":{\"data1\":\"1\",\"data2\":\"test1\"},\"2\":{\"data1\":\"6\",\"data2\":\"test2\"}}";
Gson g = new GsonBuilder()
            .registerTypeAdapter(MyJSONList.class, new MyDeserializer())
            .create();
MyJSONList l = g.fromJson(json, MyJSONList.class);

for (MyItem i : l)
{
    System.out.println(i.data2);
} 
```

输出：

> 测试1 测试
> 2

# java - Android上的Java是原生的吗？

> ID：15256651
> 
> 赞同：3
> 
> 时间：2013-03-06T19:50:12.350
> 
> 标签：java, android, sdk, android-ndk, native

我最近阅读了一些关于移动应用程序的内容，尤其是关于 Android 应用程序的内容。在我的研究中，我发现有两种应用程序，原生应用程序和 WebApps。到目前为止，一切都很好，但现在我想知道用 Java 编写的 Android 应用程序是否是原生的。我问这个问题是因为也有可能使用 NDK（本机开发工具包）在 C/C++ 中编程。当 Android 的 Java 应用程序不是原生的时，它是什么？并且当它是原生的时，如果还有名称中已经包含“原生”一词的 NDK，怎么能争论呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-06T19:51:43.243

“本地”是一个在不同语境中具有不同含义的词。

在比较和对比基于 Java 的 Android 应用程序开发与 Web 应用程序或所谓的“混合”应用程序（例如 PhoneGap）时，“本机”指的是 Java。

在比较和对比基于 Java 的 Android 应用程序开发与使用 NDK 的 C/C++ Android 应用程序开发时，“本机”指的是 C/C++。

# git - Git删除TFS git存储库中的远程分支

> ID：15256653
> 
> 赞同：31
> 
> 时间：2013-03-06T19:50:16.793
> 
> 标签：git, tfs, azure-devops

我们在 Team Foundation Service 中使用 git，我们正在尝试通过运行以下命令来找到删除远程分支的方法。

```
git push origin --delete TheBranchName 
```

远程服务器不断拒绝并出现以下错误

```
 ! [remote rejected] TheBranchName (TF401026: The ForcePush permission is required to perform this action.) error: failed to push some refs to 'https://xxx.visualstudio.com/DefaultCollection/_git/Xxxxxx' 
```

知道如何在 TFS 中为用户设置正确的权限吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-12-16T15:18:44.640

可以在以下位置访问存储库的安全选项
1\. Code->Explorer
2\. 从资源管理器中选择一个
存储库 3\. 在存储库的详细信息中，您应该单击资源管理器旁边的存储库名称。
4\. 选择管理存储库...菜单

您可以在此处配置每个贡献者组和个人用户对存储库及其分支的权限。“重写和销毁历史（强制推送）”选项应该是允许或继承允许能够强制推送。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-30T14:37:06.330

要删除远程分支，您可以使用：

```
git push origin :TheBranchName 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-06T22:32:44.503

从`git push`手册页：

```
-f
--force
    Usually, the command refuses to update a remote ref that is not an ancestor of the
    local ref used to overwrite it. This flag disables the check. This can cause the
    remote repository to lose commits; use it with care. 
```

看起来您要删除的分支不是您所在分支的祖先 - 添加此`--force`参数并查看它是否有帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-19T07:39:10.197

我想编辑[Ursegor 的答案](https://stackoverflow.com/a/20614321/6685280)，但我缺乏这样做的声誉。

在版本 14.102.25423.0（Team Foundation Server 2015 Update 3）中，可以在以下位置访问存储库的安全/权限选项：

1.  `Code/Explorer`
2.  从资源管理器中选择一个存储库
3.  `...`单击存储库名称旁边的三个点。
4.  选择**`Security`**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-26T16:54:04.047

在此[链接](https://stackoverflow.com/questions/2196874/cannot-delete-remote-branch-in-git)的第一个答案和第一条评论中回答了您的问题：

*“有人在远程仓库中启用了一个禁止删除的钩子——通常这样做是为了让某人无法将重新定位的分支推送到仓库中。（我维护了相当大的 git 存储库集合，它们都已配置这种方式，虽然不是用钩子。）*

*查看远程存储库中的 hooks/ 目录。会有一个名为“update”的脚本；这就是拒绝让你删除分支的原因。”*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-23T15:59:13.467

我遇到了这个问题，寻找一种在 VSO 中删除分支的方法。对于登陆这里的其他人，我有一个有点麻烦但有效的过程。从分支创建拉取请求。创建拉取请求后，放弃它。放弃请求后，您会看到一个删除源分支按钮。单击以删除分支。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-17T18:23:03.997

我只需要打开 Git UI 工具，打开 repo 并从那里删除分支，它工作正常。我无法从 TFS 做到这一点。

# sql-server - Named pipes error when connecting to remote Express Edition server

> ID：15256654
> 
> 赞同：4
> 
> 时间：2013-03-06T19:50:23.623
> 
> 标签：sql-server, sql-server-2008

I am trying to connect to MS SQL Server 2008 R2 Express Edition through a Remote computer. I am getting this error :

> A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)

On running `SELECT CONVERT(char(20), SERVERPROPERTY('InstanceName')) instancenameting`

I get `NULL` as the instance name. I have started SQL Browser service, checked TCP/IP are enabled.

What else can be done?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:07:29.380

Use

```
Data Source=IP-0A6E3175;Network=DBMSSOCN;... 
```

Or

```
Data Source=<<ip address>>;Network=DBMSSOCN;... 
```

You'll also need to make sure that TCP/IP is enabled on the host using SQL Server Configuration Manager, that you aren't blocked by a firewall, etc.

And just for kicks, also please try:

```
Data Source=<<ip address>>\SQLEXPRESS;Network=DBMSSOCN;... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:40:47.367

In addition to Aaron's suggestion to ensure your connection string uses tcp, run SQL Server Configuration manager and check the following:

*   do you have more than one instance?
*   tcp/ip enabled?
*   if the instance you are targeting is not the default instance, it will not be on port 1433 but rather some dynamic port. The Microsoft libraries figure out which port using [SQL Server Browser](http://msdn.microsoft.com/en-us/library/ms181087%28v=sql.105%29.aspx) on port 1434\. Your firewall needs to allow that also (UDP).
*   if your Express instance is the only instance, you can change to use port 1433\. Then you don't need SQL Server Browser.

# c++ - 在行星模拟器中使用 boost::thread

> ID：15256655
> 
> 赞同：1
> 
> 时间：2013-03-06T19:50:23.447
> 
> 标签：c++, boost-thread

我正在制作一个太空行星模拟器，问题是，我无法模拟超过 100 颗行星，因为模拟速度呈指数级下降。为了解决这个问题，我认为使用线程可以解决我的问题，因为我可能没有足够的经验使用显卡处理器进行计算。

我的程序中有两个函数用于计算行星之间的引力，另一个用于检查碰撞。我以某种方式实现了线程，所以我计算一个线程中的重力和另一个线程中的碰撞。

问题是模拟在不使用线程的情况下并没有运行得更快。也许我执行错误？

```
int main()
{
    int numOfPlanets;
    cout << "Enter the maximum number of planets to generate: ";
    cin >> numOfPlanets;
    App.Create(sf::VideoMode(1366, 740), "SFML Galaxy Simulator");
    App.Clear(sf::Color(20,20,20));

    generateRandomPlanets(500, 500, numOfPlanets);
    //createPlanet(planets, sf::Vector2f(500,500), sf::Vector2f(0,0), 5, 500);

    thread thread_1;
    thread thread_2;

    while(App.IsOpened())
    {
        sf::Event Event;
        while (App.GetEvent(Event))
        {
            if (Event.Type == sf::Event::Closed)
                App.Close();
        }

        App.Clear(sf::Color(20,20,20));
        thread_1 = thread(checkCollision);
        thread_2 = thread(calculateForce);
        thread_1.join();
        thread_2.join();
        updatePlanets();
        App.Display();
    }
    thread_2.join();
    thread_1.join();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:35:44.207

```
 thread_1 = thread(checkCollision);
    thread_2 = thread(calculateForce);
    thread_1.join();
    thread_2.join();
    updatePlanets(); 
```

这会启动两个新线程以并行执行一些工作，然后阻塞等待它们完成，然后再运行`updatePlanets`。你可能想要：

```
 thread_1 = thread(checkCollision);
    thread_2 = thread(calculateForce);
    updatePlanets();
    thread_1.join();
    thread_2.join(); 
```

这将并行运行三个函数。

此外，这是结尾处的错误`main`：

```
thread_2.join();
thread_1.join();
return 0; 
```

您已经加入了线程，您不能再次加入它们。

实际上没有必要在循环之外声明`thread_1`和`thread_2`重用它们，你可以在循环中声明它们：

```
 thread thread_1(checkCollision);
    thread thread_2(calculateForce);
    updatePlanets();
    thread_1.join();
    thread_2.join(); 
```

另请注意，如果`updatePlanets`抛出异常，它将终止您的程序，因为`thread_2`析构函数将在线程可连接时运行，因此 call `terminate()`，这在该程序中可能没问题，但需要牢记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T14:15:13.203

在发布问题后，我进行了更多研究，发现模拟性能的主要问题是计算每个行星相对于所有其他行星的引力的算法的时间复杂度`O(n^2)`。

我发现，解决这个问题的一种或最好的方法是使用[Barnes-Hut](http://arborjs.org/docs/barnes-hut)算法进行 n 体模拟，其时间复杂度为`O(n log n)`. 该算法的工作方式是将所有行星划分为四叉树节点，然后根据每个节点的中心质量计算力。

因此，将所有这些加在一起，使用 Barnes-Hut 算法和线程是解决这个问题的最佳方法。

# sql-server - 这个查询的输出是什么？

> ID：15256656
> 
> 赞同：-1
> 
> 时间：2013-03-06T19:50:23.847
> 
> 标签：sql-server, sql-server-2008

```
SELECT '(Current Week)'
UNION SELECT Convert(varchar, dbo.firstOfWeek(DateAdd(dd, -7, GetDate()), default), 101)
UNION SELECT Convert(varchar, dbo.firstOfWeek(DateAdd(dd, -14, GetDate()), default), 101)
UNION SELECT Convert(varchar, dbo.firstOfWeek(DateAdd(dd, -21, GetDate()), default), 101)
UNION SELECT Convert(varchar, dbo.firstOfWeek(DateAdd(dd, -28, GetDate()), default), 101)
UNION SELECT Convert(varchar, dbo.firstOfWeek(DateAdd(dd, -35, GetDate()), default), 101)
UNION SELECT Convert(varchar, dbo.firstOfWeek(DateAdd(dd, -42, GetDate()), default), 101)
order by 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:13:12.027

我想你的意思是：

```
SELECT '(Current Week)'
UNION SELECT Convert(varchar, DateAdd(dd, -7, GetDate()), 101)
UNION SELECT Convert(varchar, DateAdd(dd, -14, GetDate()), 101)
UNION SELECT Convert(varchar, DateAdd(dd, -21, GetDate()), 101)
UNION SELECT Convert(varchar, DateAdd(dd, -28, GetDate()), 101)
UNION SELECT Convert(varchar, DateAdd(dd, -35, GetDate()), 101)
UNION SELECT Convert(varchar, DateAdd(dd, -42, GetDate()), 101)
order by 1

(Current Week)
01/23/2013
01/30/2013
02/06/2013
02/13/2013
02/20/2013
02/27/2013 
```

# javascript - 当用户开始输入时，使突出显示的输入字段“未突出显示”

> ID：15256657
> 
> 赞同：0
> 
> 时间：2013-03-06T19:50:30.677
> 
> 标签：javascript, jquery, forms, input, highlight

如果您单击“加入”按钮并将字段留空，我使用 javascript 制作了一个简单的表单，该表单会突出显示红色字段。

即使在你填满它之后，直到按下“加入”按钮，它也会继续保持红色。因此，我只想在用户开始输入后取消突出显示，而不是单击。

JSFiddle： http: [//jsfiddle.net/LCBradley3k/xqcJS/6/](http://jsfiddle.net/LCBradley3k/xqcJS/6/) Javascript：

```
$(document).ready(function(){

      /*  setTimeout(function(){ 
        $('.inputs').show("slide", { direction: "down" }, 1000);
        }, 2000);
    });*/

    $('#join').click(function(){

        var correct = true;

        $('input[type="text"]').each(function(indx){
            var $currentField = $(this);
            if ($currentField.val() === ''){
                $currentField.addClass('empty');
                correct = false;
            } else{
                $currentField.removeClass('empty');
            }

        });
        if (correct) {
            $('#answer').html('Thank You!');
            setTimeout(function(){
        $('.inputs').hide("slide", { direction: "up" }, 1000);
        }, 2000);
        } else {
        $('#answer').html('Please fill highlighted fields.') ;     
        }

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:54:12.650

在表单输入上添加一个`keyup`处理程序以删除该类：

```
$('input[type="text"]').keyup(function (event) {
    var $currentField = $(this);
    if ($currentField.val() !== '') {
        $currentField.removeClass('empty');
    }
}); 
```

**[演示](http://jsfiddle.net/6TTfP/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:54:31.997

当然，只需绑定到 keydown。

[http://jsfiddle.net/xqcJS/7/](http://jsfiddle.net/xqcJS/7/)

```
if ($currentField.val() === ''){
    $currentField.addClass('empty');
    correct = false;
    $currentField.one('keydown',function(){
        $currentField.removeClass('empty');
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:55:22.347

```
$('input[type="text"]').keydown(function() {
    if ( $(this).val != "" )
        $(this).removeClass('empty');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:58:52.130

您可以使用焦点或使用 keyup。

```
$('input[type="text"]').keyup(function(e){
  $(this).removeClass('empty');
}) 
```

如果您想使用焦点，您可以用焦点替换 keyup，因为它不会在您每次键入时触发事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-06T20:23:25.493

添加以下代码：

```
$('input[type="text"]').focus(function() {            
   $(this).removeClass('empty');
}); 
```

当您专注于字段时，将删除“空”类。

# python - 在对数刻度轴上设置 matplotlib 刻度的颜色

> ID：15256660
> 
> 赞同：4
> 
> 时间：2013-03-06T19:50:43.087
> 
> 标签：python, matplotlib

根据[更改 matplotlib 中绘图的轴颜色、刻度和标签的颜色](https://stackoverflow.com/questions/4761623/changing-the-color-of-the-axis-ticks-and-labels-for-a-plot-in-matplotlib)的建议，我设法使用以下方法设置了我的图形的脊椎、标签、数字和刻度的颜色：

```
ax.spines['left'].set_color('#FF9000')
ax.yaxis.label.set_color('#FF9000')
ax.tick_params(axis='y', colors='#FF9000') 
```

但是，当我将图表的轴设置为对数刻度时，刻度再次恢复为黑色。

例如：

```
ax.set_yscale('log')
ax.spines['left'].set_color('#FF9000')
ax.yaxis.label.set_color('#FF9000')
ax.tick_params(axis='y', colors='#FF9000') <-- now only half works 
```

这会绘制我想要的颜色的数字（所以我知道该命令仍然可以执行某些操作）但不会影响刻度。

有没有办法设置对数刻度刻度的颜色？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-06T19:59:11.207

这在我的系统上正常工作（运行非常接近当前的 git master）：

您只需要添加 kwarg `which='both'` [(doc)](http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes.tick_params)

```
figure()
ax = gca()

ax.set_yscale('log')
ax.spines['left'].set_color('#FF9000')
ax.yaxis.label.set_color('#FF9000')

ax.tick_params(axis='y', colors='#FF9000', width=5, which='both') 
```

我把蜱虫做得更厚，以便更容易看到颜色。

在对数刻度中，小刻度是次要刻度，默认情况下`tick_params`只更改主要刻度，您只需要告诉它两者都执行或显式分别执行每个（主要和次要）。

# ios - Dropbox 使用 delta IOS 检测文件更改

> ID：15256661
> 
> 赞同：1
> 
> 时间：2013-03-06T19:50:45.530
> 
> 标签：ios, dropbox

如果保管箱文件夹中的任何文件发生更改，我希望通知用户。为此，我必须使用以下代码：

```
[self.restCLient loadDelta: nil]; 
```

和方法：

```
-(void)restClient:(DBRestClient *)client loadedDeltaEntries:(NSArray *)entries reset:(BOOL)shouldReset cursor:(NSString *)cursor hasMore:(BOOL)hasMore{
NSLog(@"WORKED: %@, %@, %c, %c", entries, cursor, hasMore, shouldReset);
 }

 -(void)restClient:(DBRestClient *)client loadDeltaFailedWithError:(NSError *)error{

NSLog(@"THE ERROR: %@", error);
} 
```

这是我得到的响应类型：

```
2013-03-06 20:46:33.373 Splash-it[1659:907] WORKED: (
"<DBDeltaEntry: 0x1e2afbf0>",
"<DBDeltaEntry: 0x1e0e4030>",
"<DBDeltaEntry: 0x1e013640>",
"<DBDeltaEntry: 0x1e28e590>"
) 
```

如果我的保管箱发生了变化，我该如何理解这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-05T21:38:07.267

这个问题有点老了，但我想我还是会回答。:)

您将要访问`DBDeltaEntry`对象的属性。

**第 1 步：导入 DBDeltaEntry.h**

我不知道为什么这不包含在 Dropbox 的其他东西中（我给 Dropbox 发了电子邮件询问原因）。将此添加到您的课程中：

```
#import "DBDeltaEntry.h" 
```

**第 2 步：循环遍历结果**

在`loadedDeltaEntries`委托方法中，您可以像这样循环遍历结果：

```
for(DBDeltaEntry *file in entries) {
  NSLog(@"Entry name: %@ / Metadata: %@",file.lowercasePath, file.metadata.filename);
} 
```

要查看您可以访问 DBDeltaEntry 对象的元数据的其他内容，请查看 DBMetadata.h：

```
BOOL thumbnailExists;
long long totalBytes;
NSDate* lastModifiedDate;
NSDate *clientMtime; // file's mtime for display purposes only
NSString* path;
BOOL isDirectory;
NSArray* contents;
NSString* hash;
NSString* humanReadableSize;
NSString* root;
NSString* icon;
NSString* rev;
long long revision; // Deprecated; will be removed in version 2\. Use rev whenever possible
BOOL isDeleted;

NSString *filename; 
```

**第 3 步：了解结果**

此条目列表表示您的 Dropbox 文件夹的最新更改（修改、删除或添加了哪些文件）。在该方法中使用`cursor`很重要，`loadedDeltaEntries`因为它可以帮助您跟踪您知道哪些更改。您可以存储光标，然后在每次 delta 调用中将其传递给 Dropbox，“据我所知，这是关于更改的”，而 Dropbox 只会告诉您自该光标以来发生了什么变化。

我希望这会有所帮助。

# mysql - mySQL 列返回值的列名

> ID：15256664
> 
> 赞同：-1
> 
> 时间：2013-03-06T19:51:08.587
> 
> 标签：mysql, identity-column

我有这个问题，选择返回列的名称，其中包含值。我不知道是什么导致了这种行为。

上表是我得到的结果，下表是我想要获得的整个表的一部分。将 wys 中的 0 替换为字符串 wys 并且由于此查询，我的脚本不起作用

![在此处输入图像描述](../Images/1eaf611bd4d52263de64292e34d5894d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:56:04.943

您在 wys 上使用常规引号，表示字符串文字；

```
'wys' 
```

而不是 - 就像您在其他列上所做的那样 - 表示表列名称的反引号；

```
`ocena` 
```

这使得 MySQL 使用*字符串文字* `wys`而不是*表列* `wys`的内容作为查询中该结果列的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:56:29.280

您应该像这样更改 SELECT 查询：

```
SELECT `zdjecie`, `opis`, `tekst`, `ocena`, `wys`
  FROM POSTY
 LIMIT 0, 30 
```

# ruby-on-rails - Mysql2::Error: Duplicate entry for key -- ActiveRecord::RecordNotUnique 没有捕捉到错误？

> ID：15256665
> 
> 赞同：5
> 
> 时间：2013-03-06T19:51:09.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3, exception-handling

我正在开发一个 Rails 应用程序，并且经常收到以下错误：

```
Mysql2::Error: Duplicate entry '3022093-2000000028003-visited' for key 'unique_user_place_relationship' 
```

虽然我已将问题的根源缩小到以下几行：

```
begin
  up = UserPlace.new(user_place_params)
  up.skip_logging
  up.save!
rescue ActiveRecord::RecordNotUnique => e
  Rails.logger.warn(e)
end 
```

在我的表中，我有以下索引：

```
key_name                         seq_in_index    column_name
unique_user_place_relationship   1               user_id
unique_user_place_relationship   2               place_id
unique_user_place_relationship   3               relationship 
```

**我的问题是我没有`validate_uniqueness_of`user_id、place_id 和关系`user_place.rb`吗？**

据我了解，`ActiveRecord:RecordNotUnique`应该捕获此错误，因为事务不符合数据库级别的索引约束。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-27T15:56:39.943

医生[说](http://api.rubyonrails.org/classes/ActiveRecord/Validations/ClassMethods.html#method-i-validates_uniqueness_of-label-Concurrency+and+integrity)：

> 结合使用此验证方法 `ActiveRecord::Validations#save`并不能保证不存在重复记录插入，因为`uniqueness`应用程序级别的检查天生就容易出现竞争条件。例如，假设两个用户尝试同时发表评论，并且评论的标题必须是唯一的。在数据库级别，这些用户执行的操作可以按以下方式交错...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T22:20:20.343

不太确定添加有什么问题，`validates_uniqueness_of`但是如果您真的不想使用它并且您说`rescue`没有捕获异常，请尝试将`ActiveRecord::RecordNotUnique => e`所有内容一起删除，看看它是否在这种情况下捕获了异常。

尝试以下操作：

```
rescue Exception => e
  if e.is_a? ActiveRecord::RecordNotUnique
    Rails.logger.warn(e)
  end 
```

# java - 蛮力算法字符集问题 - 索引超出范围异常

> ID：15256667
> 
> 赞同：0
> 
> 时间：2013-03-06T19:51:13.043
> 
> 标签：java, arrays, algorithm, brute-force

我在 Java 中制作了一个蛮力破解程序，您提供一个散列 (SHA1) 密码，它会遍历给定的字符集，直到找到正确的密码。

我的第一个字符集包括：

```
"0123456789abcdefghijklmnopqrstuvwxyz" 
```

第二个字符集：

```
"9876543210zyxwvutsrqponmlkjihgfedcba" 
```

第一个字符集就像一个梦一样工作，但是一旦我更改字符集顺序的任何部分，它就会导致程序崩溃并抱怨索引越界。我确定这与增量方法有关，但我不确定如何调整它以满足我需要能够遍历多个字符集的需求。

任何建议将不胜感激，这里有一些示例代码可以为您提供一个想法：

```
 char[] charsetA = "0123456789abcdefghijklmnopqrstuvwxyz".toCharArray(); 
    char[] charsetB = "9876543210zyxwvutsrqponmlkjihgfedcba".toCharArray(); 

    charset = charsetA; // charsetA works but not charsetB

    BruteForce bf = new BruteForce(hashPassword, charset, 1);
    String attempt = bf.toString();
    attempt = pd.calcSha1(attempt);
    while (true) {
        if (attempt.equals(hashPassword)) {
            System.out.println("Password Found!");
            System.out.println("Password as plaintext : " + currentGuess);
            break;
        }
        attempt = bf.toString();
        currentGuess = attempt;
        attempt = pd.calcSha1(attempt);
        bf.increment();
    }
}

private char[] cs;  // Character Set
private char[] cg;  // Current Guess
String hashPassword; // Password searching for

public BruteForce(String password, char[] characterSet, int guessLength) {
    hashPassword = password;
    cs = characterSet;
    cg = new char[guessLength];
    Arrays.fill(cg, cs[0]);
}

public void increment() {
    int index = cg.length - 1;
    //System.out.println("index = " + index);
    while (index >= 0) {
        if (cg[index] == cs[cs.length - 1]) {
            if (index == 0) {
                cg = new char[cg.length + 1];
                Arrays.fill(cg, cs[0]);
                break;
            } else {
                cg[index] = cs[0];
                index--;
            }
        } else {
            cg[index] = cs[Arrays.binarySearch(cs, cg[index]) + 1];
            break;
        }
    }
} 
```

编辑：

我试图遍历字符集中的每个字符，直到它到达可能字符的末尾，当它到达时，我想添加另一个字符并循环遍历这两个字符组合的所有可能性，依此类推，直到它用尽所有可能性最多 6 个字符（7 个字符以上需要很长的时间）。

我从教程中获得了上面的增量函数，但我试图找出代码，以便它接受任何字符集输入。

任何提示或伪代码都是我所追求的。

# ios - iOS URL Scheme：在线完成重定向挑战

> ID：15256669
> 
> 赞同：1
> 
> 时间：2013-03-06T19:51:20.170
> 
> 标签：ios

我们有一个 iOS 原生应用程序，它允许通过外部网页为教会在线捐赠。原生应用程序打开浏览器，一旦用户在网页上完成在线捐赠，它就会使用 URL 方案返回到原生应用程序。

这很好用，但并不理想，因为当用户稍后返回他们的网络浏览器时，他们会看到外部网页的残余。

目前我们只是做一些 JavaScript 并清理页面以避免重复的礼物等。有没有办法可以将页面重定向到用户的默认页面或主页？

或者有没有更好的方法来处理这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T19:53:48.347

您可以在内部[UIWebView](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html)中处理您的在线礼物，这将使您可以更好地控制应用程序的这方面。

# java - 用 Java 写一个 LaTeXParser，从概念上攻击

> ID：15256679
> 
> 赞同：0
> 
> 时间：2013-03-06T19:52:16.717
> 
> 标签：java, parsing, latex, stack

好吧，所以我必须用 java 编写一个 LaTeXParser，我将接收一个类似于下面这个的文件并读取它的有效性和错误。现在我不是真的在寻找帮助或代码，而是更多的概念理解，如何解决问题。我将使用 Stacks 来存储块并确保所有内容都正确排序。所以我的问题是，如何处理它？

例如，我是否应该首先获取所有“\begin{ *_* }”并将它们放入堆栈，然后将它们与相应的“\end{}”一起弹出？我想知道使用基于字符串的大小写切换系统，当找到特定字符串时，它会在我的堆栈上根据该字符串执行必要的操作。

或者可能是 2 个相互抵消的堆栈，所有的 \begins 在一个中，\end 在另一个中，并且它们的 { *_* _} 匹配，我开始将它们弹出等等。

所以，是的，只是想知道 SOF 的聪明头脑对我应该如何思考这个问题以及如何处理它有什么看法。感谢您的输入！

```
\documentclass{article}
\usepackage{amsmath, amssymb, amsthm}
\begin{document}
    {\Large \begin{center} Homework Problems \end{center}}\begin{itemize}\item\end{itemize}
    \begin{enumerate}
            \item Prove: For all sets $A$ and $B$, $(A - B) \cup
                    (A \cap B) = A$.
                    \begin{proof}
                            \begin{align}
                                    & (A - B) \cup (A \cap B) && \\
                                    & = (A \cap B^c) \cup (A \cap B) && \text{by
                                    Alternate Definition of Set Difference} \\
                                    & = A \cap (B^c \cup B) && \text{by Distributive Law} \\
                                    & = A \cap (B \cup B^c) && \text{by Commutative Law} \\
                                    & = A \cap U && \text{by Union with the Complement Law} \\
                                    & = A && \text{by Intersection with $U$ Law}
                            \end{align}
                    \end{proof}
            \item If $n = 4k + 3$, does 8 divide $n^2 - 1$?
                    \begin{proof}
                            Let $n = 4k + 3$ for some integer $k$. Then
                            \begin{align}
                                    n^2 - 1 & = (4k + 3)^2 - 1 \\
                                    & = 16k^2 + 24k + 9 - 1 \\
                                    & = 16k^2 + 24k + 8 \\
                                    & = 8(2k^2 + 3k + 1) \text{,}
                            \end{align}
                            which is certainly divisible by 8.
                    \end{proof}
    \end{enumerate}
\end{document} 
```

编辑：大声笑我认为每个人都想太多了，我不是在寻找任何可以识别和编译代码的东西，或者实际上通过这个文件执行 LATEX 语言的操作。我只是希望能够编写一个文本文件，就像上面的那个，让我的程序打开它，阅读它，然后说“嘿！这会工作，因为每个开始的块也会结束！” 或者“嘿，第 10 行有错误！” 不多也不少。只是一个简单的验证器/错误检查器，它使用堆栈来包含块，然后在找到结束时弹出它们等等。同样，我不是在寻找代码或讲义！我想要的只是一些解决这个问题的好主意和方法，也许充其量是一些伪代码结构！

例如......我正在考虑将这一切都包含在我的主类中的 1 个类中，并制作一个堆栈来保存文件中的所有字符串，这些字符串被编码为这样的“\begin{ **_ *}”然后当我找到相应的“ \end{*** } ”只是将其弹出并从列表或其他内容中检查它。如果在文件运行结束时弹出每个开始块，则我有一个有效的 .txt 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:00:12.527

尝试推出自己的解析器是一项艰巨的任务。有许多[解析器生成器](http://en.wikipedia.org/wiki/Comparison_of_parser_generators)可以将一些繁忙的工作从任务中解脱出来。[ANTLR](http://www.antlr.org/)是一种流行的 Java 语言。

您需要做的第一件事就是找出乳胶是哪种语言？更复杂的语言（如 C++）无法使用相同类型的解析器进行解析，而您可以使用这些解析器来解析更常规的语言。

下面的[Jules Bean 帖子](http://www.mail-archive.com/lyx-devel@lists.lyx.org/msg09966.html)让我认为 Latex 比大多数编程语言更难解析。

> 我很确定它不是 LALR 语言。它依赖于上下文并且能够修改它自己的语法。我认为在不实际执行宏的情况下解析可能在技术上是不可能的。即你需要一个 TeX 状态机来全面解析它。
> 
> 不过，“表现良好”的 LaTeX 可能是 LALR。

# php - 为什么这个简单的注册页面不起作用？

> ID：15256683
> 
> 赞同：0
> 
> 时间：2013-03-06T19:52:23.310
> 
> 标签：php, html, forms, login

我不确定为什么这不起作用，它没有给我任何错误，但它不会显示结果。我只想显示 3 个文本字段的结果。我想做的下一步是将数据输入数据库，然后显示它，但我想接下来会出现。谢谢你。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<?php
$Fname = $_POST["Fname"];
$Lname = $_POST["Lname"];
$Pword = $_POST["Pword"];

if (!isset($_POST['submit'])) { // if page is not

?>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
</head>

<body>

<form method = "post" action = "<?php echo $PHP_SELF;?>">

First name<input name="Fname" type="text" maxlength="12"
/>
<br />
<br />

Last name<input name="Lname" type="text" maxlength="12"
/>
<br />
<br />

<!--Address <input name="register_address" type="text" maxlength="12"
/>
<br />
 <br />-->
<!--<select name="state" value="State"></select>-->

Password<input name="Pword" type="text" maxlength="12"
/>
<br />
<br />

<!--Re-type Password<input name="register_password_confirm" type="text" maxlength="12"
/>
<br />
<br />-->

<input name="submit" type="button" value="Submit" />

</form>

<?
} else {
echo "Hello, ".$Fname." ".$Lname.".<br />";
echo "Your Password is, " .$Pword.".<br />";
}
?>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:58:49.910

我看到的三个问题

**1 - 您的按钮不是提交按钮**

改变：

```
<input name="submit" type="button" value="Submit" /> 
```

至

```
<input name="submit" type="submit" value="Submit" /> 
```

**2 - 注册全局变量可能被关闭**

改变：

```
<?php echo $PHP_SELF;?> 
```

至

```
<?php echo $_SERVER['PHP_SELF'];?> 
```

**3 - 短开标签可能会被关闭**

改变：

```
<?
} else {
echo "Hello, ".$Fname." ".$Lname.".<br />";
echo "Your Password is, " .$Pword.".<br />";
}
?> 
```

至

```
<?php
} else {
echo "Hello, ".$Fname." ".$Lname.".<br />";
echo "Your Password is, " .$Pword.".<br />";
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:59:35.757

您的提交按钮需要更改为`type="submit"`，您可能还需要在 else 语句中移动变量声明以避免 PHP 警告：

```
<input name="submit" type="submit" value="Submit" /> 
```

和：

```
<?php
} else {
    $Fname = $_POST["Fname"];
    $Lname = $_POST["Lname"];
    $Pword = $_POST["Pword"];
    echo "Hello, ".$Fname." ".$Lname.".<br />";
    echo "Your Password is, " .$Pword.".<br />";
}
?> 
```

最后，我会尽量减少你把它放在`if`语句中的 html 的数量，如果你将来改变条件的处理方式，这可能会导致冲突：

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Untitled Document</title>
    </head>
    <body>

    <?php
    if (!isset($_POST['submit'])) { // if page is not
        ?>
        <form method = "post" action = "<?php echo $_SERVER['PHP_SELF'];?>">
            First name<input name="Fname" type="text" maxlength="12" /><br /><br />
            Last name<input name="Lname" type="text" maxlength="12" /><br /><br />
            <!--Address <input name="register_address" type="text" maxlength="12" /> <br /> <br />-->
            <!--<select name="state" value="State"></select>-->
            Password<input name="Pword" type="text" maxlength="12" /><br /><br />
            <!--Re-type Password<input name="register_password_confirm" type="text" maxlength="12" /><br /><br />-->
            <input name="submit" type="submit" value="Submit" />
        </form>
        <?php
    } else {
        $Fname = $_POST["Fname"];
        $Lname = $_POST["Lname"];
        $Pword = $_POST["Pword"];
        echo "Hello, ".$Fname." ".$Lname.".<br />";
        echo "Your Password is, " .$Pword.".<br />";
    }
    ?>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T19:56:51.120

尝试添加一个

```
<input type="hidden" name="submitted" value="1" /> 
```

并检查

```
$_POST['submitted'] == 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:58:03.407

尝试像这样回显结果：

```
echo "Hello, $Fname $Lname.<br />
      Your Password is, $Pword.<br />"; 
```

我忘了补充一点，当使用双引号回显时，您不需要变量后的点。

# sql - 查找匹配正负的行

> ID：15256688
> 
> 赞同：0
> 
> 时间：2013-03-06T19:52:34.503
> 
> 标签：sql, sql-server-2008

我有 3 行，但我只需要确定偏移的行，这意味着正数与负数匹配，对于相同的供应商 + 发票 + 支票号码组合。

```
Vendor_Code  Invoice_Number  Check_Number  Payment_Amount  Subcontract_Job
-----------  --------------  ------------  --------------  ---------------
DEVONEL      6462            35272             8257.50     BUP008
DEVONEL      6462            35272            -8257.50     BUP008
DEVONEL      6462            35665             8257.50     BUP008 
```

应该只返回前两行，因为第三行没有匹配的负偏移量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:22:01.577

```
SELECT x1.<cols>, x2.<cols> 
FROM dbo.YourTable AS x1
INNER JOIN dbo.YourTable AS x2
  ON x1.Vendor_Code    = x2.Vendor_Code
 AND x1.Invoice_Number = x2.Invoice_Number
 AND x1.Check_Number   = x2.Check_Number
 AND x1.Payment_Amount = -x2.Payment_Amount; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T15:40:53.517

如果金额相同（没有四舍五入的差异或某种“接近”类型的问题 - 如果是这样，请考虑四舍五入金额字段或从中添加/减去保证金。）然后你可以进行基于集合的比较，例如：

```
Select VendorCode, InvoiceNumber, CheckNumber, Amount from dbo.tablename
intersect
Select VendorCode, InvoiceNumber, CheckNumber, Amount from dbo.tablename 
```

它会给你匹配的付款清单。如果您只想查找不匹配的记录，您可以使用 except 而不是 intersect。（就像您执行上述操作并将其传递到更新中，以防您有一个标志字段来标记发票系统中的非平衡付款。）

我会在 CTE 中使用上述内容，然后将其提供给更新。

# c - LZ压缩技术

> ID：15256689
> 
> 赞同：-4
> 
> 时间：2013-03-06T19:52:34.677
> 
> 标签：c, encryption, compression, lzw

我试图实现 LZ 压缩....并试图使用它来压缩一些文件....但是我遇到了一些逻辑问题...我真的不知道如何存储数据返回文件...真正的问题是：假设我现在有一个匹配的字符串“ls”[表中的条目已经在第 289 个索引处完成] 如果将文件中的 289 替换为 ls 那么该怎么做？ ? 因为如果较早的“ls”占用 2 个字节，那么现在 289 将占用 3 个字节。如果以上是正确的，那么为什么这种方法称为压缩，如果不是，那么正确的方法是什么……我只需要一个答案，特别是详细地阐明我对这个逻辑的了解。

我到现在为止制作的一些代码：

```
int main()
{
    int id,flag,d;
    char ch,a[2],newstr[1000],currstr[1000];
    FILE *fr;
    FILE *fw;
    createTable();
    fr=fopen("old.txt","rb");
    fw=fopen("new.txt","wb");
    flag=0;
    fscanf(fr,"%c",&ch);
    fprintf(fw,"%c",ch);
    a[0]=ch;
    a[1]='\0';
    strcpy(currstr,a);
    while(!feof(fr))
    {
        showTable();
        fscanf(fr,"%c",&ch);
        a[0]=ch;
        a[1]='\0';
        strcat(currstr,a);
        strcpy(newstr,currstr);
        id=lookTable(newstr);
        if(id!=5000)
        {
            strcpy(currstr,newstr);
            flag=1;
            d=id;
        }
        else
        {
            if (flag==0)
            {
                fprintf(fw,"%s",a);
            }
            else
            {
                fprintf(fw,"%d",d);
                printf("%d new data\n",d);
            }
            addEntry(newstr);
            strcpy(currstr,a);
            flag=0;
        }
    }
    fprintf(fw,"%s",currstr);
    fclose(fr);
    fclose(fw);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:07:13.277

通常，压缩数据不存储为文本文件，因此您的值`289`可能不应该存储为 text `'2', '8', '9'`，而是存储`289`为两个字节的数量（289/256 =`1`和 289/256 = `33`）。您显然必须对所有（子）字符串执行此操作，并将翻译表存储在输出文件中，以便您可以再次将其翻译回来。

# c# - bool 作为 CheckBox 的数据源（在其他线程中进行 Bool 更新，而不是它影响的线程）

> ID：15256690
> 
> 赞同：6
> 
> 时间：2013-03-06T19:52:44.183
> 
> 标签：c#, winforms, visual-studio-2010, checkbox, .net-3.5

我试图找到如何将布尔值分配给复选框。我希望我的 checkbox.checked 值在我的布尔数据更改时自动刷新。我知道对于 ComboBox 有一个 DataSource 属性，它用一个列表组成，但我找不到复选框的等价物。

我尝试使用 checkBox.DataBindings 但它似乎不起作用。另一方面，我真的不知道第三个属性是什么意思。

```
checkBox.DataBindings.Add("Checked", DisableBugWatcher, "check"); 
```

我需要它，因为我有两个独立的窗口可以刷新相同的复选框值！

**编辑 ：**

我尝试使用事件来更新我的主 GUI，但它说：*跨线程操作无效：控制'checkBox'从创建它的线程以外的线程访问。*

问题在于 bool 值是从其他线程刷新的事实，而不是它影响的线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T06:47:01.370

要使 DataBindings 工作，您必须在包含您的 bool 值的类中实现[INotifyPropertyChange 。](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged%28v=vs.110%29.aspx)如果您从 UI 线程以外的线程访问 myValue，则必须使用 SynchronizationContext 并在 UI 线程中初始化 myObject。

```
public class myObject : INotifyPropertyChanged
{
    // The class has to be initialized from the UI thread
    public SynchronizationContext context = SynchronizationContext.Current;

    bool _myValue;
    public bool myValue
    {
        get
        {
            return _myValue;
        }
        set
        {
            _myValue = value;

            // if (PropertyChanged != null)
                // PropertyChanged(this, new PropertyChangedEventArgs("myValue"));

            if (PropertyChanged != null)
            {
                context.Send(
                    new SendOrPostCallback(o => 
                       PropertyChanged(this, new PropertyChangedEventArgs("myValue"))
                    ), null);
            }
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

然后，将您的 DataBinding 设置为：

```
checkBox1.DataBindings.Add("Checked", myObject.GlobalObject, "myValue"); 
```

第一个参数是要绑定的 UI 对象的属性。第二个属性是你的目标对象实例，第三个是需要绑定到第一个的目标对象的属性名。

我尽力使用每秒切换 myValue 的计时器来反映您的场景（相应地选中复选框）。这是我使用的表格的代码：

```
System.Timers.Timer x = new System.Timers.Timer();
myObject target;

public Form1()
{
    InitializeComponent();

    target = new myObject();

    x.Elapsed += (s, e) =>
        {
            target.myValue = !target.myValue;
        };
    x.Interval = 1000;

    checkBox1.DataBindings.Add("Checked", target, "myValue");

    x.Start();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T19:46:02.780

我和朋友一起找到了一种更简单的方法来解决我的问题。我使用表单中的 DialogResult。当我从表单返回时，它给了我按钮单击的状态，它给了我文本框的值。相同的代码适用于我的复选框问题。

这是代码的示例：

```
public partial class MainWindow : Form
{

    private OtherWindow m_otherWindow;

    public MainWindow()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        // Lazy create other window if it doesn't exist.
        m_otherWindow = m_otherWindow ?? new OtherWindow();

        // Passe textbox value to other window.
        m_otherWindow.PassedValue=textBox1.Text;
        if (m_otherWindow.ShowDialog()==DialogResult.OK)
        {
            // Clicked ok : update textbox value with textbox value of other window.
            textBox1.Text=m_otherWindow.PassedValue;
        }
    }

    private void button2_Click(object sender, EventArgs e)
    {
        Close();
    }
}

public partial class OtherWindow : Form
{

    /// <summary>
    /// Value to be passed to the window.
    /// </summary>
    public string PassedValue
    {
        get { return textBox1.Text; }
        set { textBox1.Text = value; }
    }

    public OtherWindow()
    {
        InitializeComponent();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        DialogResult = DialogResult.OK;
    }
} 
```

# c# - 通过抽象 C# WPF MVVM 约定链接事件（我正在做的工作——它“正确”吗？）

> ID：15256691
> 
> 赞同：0
> 
> 时间：2013-03-06T19:52:50.417
> 
> 标签：c#, .net, wpf, events, conventions

约定难题：

为简单起见，假设我有一个名为 FruitView 的视图，其标签上写着“选择一种水果：”，并在 ListBox 中选择了苹果、橙子、梨等。

每个项目都是一个类的实例（Apple.cs、Orange.cs、Pear.cs 等）。

ViewModel 使用绑定属性跟踪选定的水果：

```
public Fruit CurrentFruit { get; set; } 
```

“水果”本身就是苹果、橙子、梨子等每一个派生出来的接口。

现在，另一个步骤，Apple、Orange、Pear 等 Apple.cs 中的每一个都依赖于名为 AppleManager、OrangeManager、PearManager 等的静态类，它们具有方法和事件。这些管理器有很大不同，并且不是从任何公共基础或接口派生的。

例如，AppleManager 可能有：

```
public delegate void ColorChangedEventHandler(string color);

public static event ColorChangedEventHandler ColorChanged;

private void RaiseColorChanged(string color)
{
    if (ColorChanged != null)
    {
        ColorChanged(color);
    }
} 
```

当在视图中选择“苹果”时，视图的其余按钮、图像等需要对源自 AppleManager 的事件做出反应；when "orange" is selected, the view needs to react to events in OrangeManager.

那么，问题是，将 View 的反应方法连接到 ViewModel 中 CurrentFruit 的管理器的正确途径是什么？

我的意思是，有可能去：

```
private void FruitListBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    // pseudocode: if apple selected, AppleManager.ColorChanged += new ColorChangedEventHandler(CurrentFruit_ColorChanged);
}

private void CurrentFruit_ColorChanged(string color)
{
    FruitColorTextBox.Text = color;
} 
```

这是不可接受的原因是因为它破坏了设计模式，并且意味着我需要处理每种水果。

实际上，我有很多医疗设备，而不是水果选项，我想将接口用作*接口*，而不是添加额外的逻辑。

我当前的解决方案是将事件添加到接口 VCONF，如下所示：

```
public interface VCONF
{
    public static event CallIncomingEventHandler CallIncoming;
    public static event EventArgs CallStarted;
    public static event EventArgs CallEnded;
} 
```

现在 VCONF1、VCONF2、VCONF3 等都是从 VCONF 派生的，它们实现了这些事件，并有方法来引发它们。

*这意味着我必须在每个 VCONF1 等中编写相同的事件行，但这与让多个类继承 INotifyPropertyChanged 相同——这就是我以这种方式设置它的原因）。这也意味着在 VCONF1Manager 中编写相同的事件和引发方法——引发事件链，上层引发事件，上层引发事件，等等，直到 View 可以对其做出反应。VCONF1Manager.CallIncoming -> VCONF1.CallIncoming -> 查看反应*

VCONF1订阅VCONF1Manager中的事件，VCONF2订阅VCONF2Manager中的事件等。

其他 VCONF？甚至可能没有经理，只是有自己的方式来确定何时引发这些事件。

View 在被选中时订阅当前 VCONF 的事件：

```
private void VCONF_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    (this.DataContext as VCONFViewModel).CurrentVCONF = (sender as ListBox).SelectedValue as VCONF;

    (((sender as ListBox).SelectedValue as VCONF).Device as VCONF).CallIncoming += new CallIncomingEventHandler(CurrentVCONF_CallIncoming);
    // same for other events
    ...
} 
```

所以，我在这里真正要问的是，通过层/抽象链接事件*的*首选/传统方式是什么？

我正在做的工作，但我不禁觉得连续加倍和链接事件并不是最好的方法。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:12:46.400

您的视图应该绑定到您的视图模型的属性，您的视图模型中不应该有视图事件处理程序。`CurrentFruit_ColorChanged`因此，您的视图应该绑定到它的`Color`属性，而不是事件处理程序`DataContext`，所以本质上，`fruit.Color`。然后，您可以根据属性更改而不是导致更改的事件在视图模型中做出适当的反应。

如果您的视图需要针对不同类型的水果看起来不同，您应该使用[数据模板](http://msdn.microsoft.com/en-us/library/ms742521.aspx)并让视图在当前水果发生变化时自动配置自己。IE：

```
<Window.Resources>
    <DataTemplate DataType="{x:Type Apple}">
        <!-- ... view for Apples ... -->
    </DataTemplate>
    <DataTemplate DataType="{x:Type Orange}">
        <!-- ... view for Oranges ... -->
    </DataTemplate>
    <DataTemplate DataeType="{x:Type Pear}">
        <!-- ... view for Pears ... -->
    </DataTemplate>
</Window.Resources>
<ContentControl Content="{Binding Path=CurrentFruit}"/> 
```

上面示例中的水果特定视图将连接到其 DataType 的属性。当视图连接到视图模型属性而不是视图模型尝试订阅视图事件时，您的管理器概念可能（应该）消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T18:44:50.890

正如我在评论中提到的，我按照 Microsoft 的 .NET 标准约定重新设计了事件路径。

我不再将 ViewModel 用于此路径，ViewModel 仅用于保存视图直接使用和显示的对象，例如设备集合（或水果，或其他）。

视图基于接口与当前设备对话，该接口具有设备将引发到视图的任何事件，使用标准 EventHandlers，没有数据 EventArgs。

每个设备都实现这些事件，并在其内部逻辑决定这样做时引发它们（取决于设备管理器类）。

还接口和实现了包含我之前试图通过事件传递的数据的属性。

视图一被选中就连接到当前设备的事件，当这些事件被引发时，视图通过“sender.IncomingCallerID”或“sender.CallStatus”等属性访问这些值。

因此，它基本上遵循 Microsoft 如何在 ListBox 上设置 SelectionChanged，然后您从发件人访问 SelectedValue 属性。

# php - 与导航（数组）php在同一行上的搜索表单

> ID：15256693
> 
> 赞同：0
> 
> 时间：2013-03-06T19:52:56.880
> 
> 标签：php, arrays, wordpress

我在 wordpress 中工作，希望搜索表单与导航栏位于同一行。如果导航是一个 div，我想我会知道如何处理，但我正在处理的主题是将导航作为数组处理。这行代码位于我的 header.php 导航文件中：

```
<?php
  wp_nav_menu( array(
        'theme_location' => 'top', 
        'name' => 'top', 
        'container' => 'nav', 
        'container_id' => 'main-nav', 
        'menu_id' => 'top')
    );
?> 
```

这是搜索表单的代码：

```
<div id="search"><?php get_search_form(); ?></div> 
```

如果有任何问题，我想我也知道如何调整 css，但是关于如何将此数组与 div 组合的任何想法？这可能很简单，但我仍在学习......谢谢！

作为对评论的回应......这是该部分生成的html：

```
<div id="container">
<div class="containerInner">
<header id="header">
<div class="logo">
<a href=""><img src="" /></a></div> 
<div id="search">
<form action="https://beta.harvest-express.com/" id="searchform" method="get"> 
<input type="text" value="" name="s" id="s" placeholder="Search for products" />
<input type="submit" class="button add_to_cart_button product_type_simple" id="searchsubmit" value="Go" /> 
<input type="hidden" name="post_type" value="product" /></form></div> 
<div class="clear"></div>
<nav id="main-nav" class="menu-main-navigation-container"><ul id="top" class="menu">
<li id="menu-item-10962" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-10717 current_page_item menu-item-10962"><a href="https://beta.harvest-express.com/">Home</a></li>
<li id="menu-item-10956" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10956"><a href="https://beta.harvest-express.com/who-we-are/">Who we are</a></li>
<li id="menu-item-10954" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10954"><a href="https://beta.harvest-express.com/how-this-works/">How This Works</a></li>
<li id="menu-item-10953" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10953"><a href="https://beta.harvest-express.com/delivery/">Delivery</a></li>
<li id="menu-item-10955" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10955"><a href="https://beta.harvest-express.com/membership/">Membership</a></li>
<li id="menu-item-10961" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-10961"><a href="https://beta.harvest-express.com/contact-us-4/">Contact Us</a></li> 
```

```
 </header> 
```

这是搜索表单和导航的相关CSS：

```
.menu{
width:100%;
text-align: center;
padding:0 ;
margin-top: 10px;
background: url(images/line2.png) repeat-x bottom; 
```

}

```
/* level 0
-------------------------------------------------------------- */

.menu > ul > li:first-child,
#main-nav > ul > li:first-child {
    margin-left:40px;
}
.menu > ul > li:last-child,
#main-nav > ul > li:last-child {
    margin-right:20px;
}

.menu > ul > li,
#main-nav > ul > li {
    padding: 3px 1px;
    margin-left:5px;
    display:inline-block;
    position: relative;
}
.menu > ul > li .sf-sub-indicator,
#main-nav > ul > li .sf-sub-indicator {
    display: none;
}
.menu > ul > li.clearence,
#main-nav > ul > li.clearence {
    float:right;
}

.menu > ul > li.current_page_item,
#main-nav > ul > li.current_page_item ,
.menu > ul > li:hover,
#main-nav > ul > li:hover {
    padding: 2px 0px;
    border:1px solid #acacac;
    border-bottom:1px solid #fff;
    background: white;
}
#search {
float:right;
width:235px;
text-align: left;
margin-bottom: 0; 
```

}

```
#search input[type="text"] {
    width:190px;
    color:#828282;
    font-size:11px;
    padding-right: 30px;
}

#search input[type="submit"] {
    color: #818181;
}
#search .button {
    margin-left:-30px;
    padding:0;
    border:none;
    background: none;
}
#search .button span {
    color:#828282;
    background: none;
    text-transform: uppercase;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:58:27.100

你可以从：

```
#search, #main-nav {
  float: right;
}
#search + .clear {
  clear: none;
} 
```

但是，如果您可以删除`<div class="clear"></div>`两个元素之间的，则不需要第二条规则。

# concrete5 - 具体5 表单 - 根据下拉菜单更改收件人电子邮件

> ID：15256700
> 
> 赞同：0
> 
> 时间：2013-03-06T19:53:27.083
> 
> 标签：concrete5

当您在concrete5 中创建一个表单时，您可以`Recipient Email`在编辑模式中指定一个。

是否可以根据下拉菜单选择将电子邮件发送到某个地址？

对此的任何帮助/资源表示赞赏。

在此先感谢，迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T03:55:44.460

不，不是开箱即用。而且我也想不出具体5中的一个好的、简单的解决方案。您可以查看市场中的附加组件（至少有一个高级模板出售）。

你也可以，也许，发送给每个人（通过逗号，或分发地址），让收件人自己弄清楚。

如果您要构建自己的解决方案，这非常简单：

1.  在表单中创建一个新字段（“问题”）。
2.  将控制器复制到您的 /blocks/form 目录（根据扩展concrete5的教程）。
3.  在发送电子邮件之前编辑 PHP 代码以检查是否已发布您指定名称的问题。如果是这样，请检查*，然后发送到该地址而不是默认地址。

*重要——不要只相信表单发布的内容......做一个基本的检查（比如确保它在你的域中，或者一个硬编码的白名单。否则一些脚本会发现它可以“破解”表单并添加任意地址，您将成为不知情的垃圾邮件发送者。

# php - 将 Canvas 图像保存到 mysql

> ID：15256703
> 
> 赞同：2
> 
> 时间：2013-03-06T19:53:31.637
> 
> 标签：php, javascript, html, mysql, ajax

每隔 5 秒，我就会运行我的 javascript 来调用 update.php 文件（希望将 base64 代码添加到 mysql - 虽然还没有弄清楚）。

目前，我只是将 base64 代码写入名为**debugConsole**的文本区域。

我只是不明白我应该如何将 javascript 变量传递给我的 php 更新文件。

HTML：

```
<script type="text/javascript">
function saveViaAJAX()
{
    var testCanvas = document.getElementById("testCanvas");
    var canvasData = testCanvas.toDataURL("image/png");
    var postData = "canvasData="+canvasData;
    var debugConsole= document.getElementById("debugConsole");
    debugConsole.value=canvasData;

    //alert("canvasData ="+canvasData );
    var ajax = new XMLHttpRequest();
    //ajax.open("POST",'testSave.php',true);
    ajax.setRequestHeader('Content-Type', 'canvas/upload');
    //ajax.setRequestHeader('Content-TypeLength', postData.length);

    ajax.onreadystatechange=function()
    {
        if (ajax.readyState == 4)
        {
            //alert(ajax.responseText);
            // Write out the filename.
                document.getElementById("debugFilenameConsole").innerHTML="Saved as<br><a target='_blank' href='"+ajax.responseText+"'>"+ajax.responseText+"</a><br>Reload this page to generate new image or click the filename to open the image file.";
        }
    }

    ajax.send(postData);
}
setInterval(function() { saveViaAJAX(); }, 5000);
</script>

<script language='javascript' type='text/javascript'>
//Every 5 seconds calls php update
//syncronized jax:
function myjax() {
    oXhr = new XMLHttpRequest();
    oXhr.open("POST", "update.php?game=<?php echo $game; ?>", false);
    oXhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded; charset=utf-8");
    oXhr.send(null);
}

//set an interval each 5 seconds to call your myjax method
setInterval(function() { myjax(); }, 5000);
</script>
</head>

     <div>
        <canvas id="testCanvas" width="300" height="300"></canvas>
      </div>
      <div>
    <textarea id="debugConsole" rows="10" cols="60">Data</textarea>

      </div>
    <script type="text/javascript">
        // This portion of the code simply draws random circles into the canvas (it has nothing todo with saving the canvas).
        var canvas = document.getElementById("testCanvas");
        if (canvas.getContext)
        {
            var canvasContext = canvas.getContext("2d");
            for (i=0; i<150; i++)
            {
                canvasContext.fillStyle="rgb("+(parseInt(Math.random()*255))+","+(parseInt(Math.random()*255))+","+(parseInt(Math.random()*255))+")";
                canvasContext.beginPath();
                canvasContext.arc(Math.random()*350,Math.random()*350,Math.random()*20, 0,Math.PI*2,true);
                canvasContext.fill();
            }
        }
    </script> 
```

PHP：

```
<?php

$random =  rand(); 
$game = $_GET["game"];

mysql_query("UPDATE paint_s SET paint_points='$random' WHERE id ='$game'") or die(mysql_error());
echo "Updated";
?> 
```

对不起，我缺乏知识，我一直在做一些教程，只是试图扩展教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:06:32.387

您要做的第一件事是打开您的请求

```
ajax.open("POST",'testSave.php',true); 
```

然后想要发送您的数据，`application/x-www-url-form-encoded`以便在内容类型中设置它

```
ajax.setRequestHeader('Content-Type', 'application/x-www-url-form-encoded'); 
```

为确保您的数据正确编码，请使用`encodeURIComponent`

```
var postData = "canvasData="+encodeURIComponent(canvasData); 
```

您还应该检查状态以查看请求是否实际成功

```
if (ajax.readyState == 4)
{
    if (ajax.status == 200){
    //success
    }
    else{
    //failure
    }
} 
```

我不知道每 5 秒保存一次 base64 编码图像是否是个好主意。

# command-line - 如何将单个文字波浪号（在运行时路径中）作为模式传递给 VimScript 中的替代（）？

> ID：15256706
> 
> 赞同：1
> 
> 时间：2013-03-06T19:53:35.297
> 
> 标签：command-line, vim

我正在尝试在启动期间使用 VimScript 替换 Vim 中的默认值`runtimepath`（aka ） 。我不能使用，因为我设置的值在里面不可用。然而，似乎 Vim 抱怨每次尝试将模式（第二个参数）传递给或最终什么都不做。`rtp`[`substitute()`](http://vimdoc.sourceforge.net/htmldoc/eval.html#substitute%28%29)`.vimrc``.vimrc``~``substitute()`

我如何告诉 Vim 匹配并随后替换波浪号？我想做的大致是这样的：

```
vim -c 'let &rtp = substitute(&rtp, "\\~", "/absolute/path", "g")' 
```

结果`\~`给了我：（`E33: No previous substitute regular expression`虽然这是模式，*而不是*替代品）。但是在命令行上使用上述`\\~`内容，虽然 Vim 没有给我错误，但我也没有看到 th 的值有任何变化`runtimepath`。

**注意：**我将附加`-c 'set rtp'`到上面的命令行，因此 Vim 会立即向我显示该值。

**替换**`~`VimScript中`runtimepath`变量中所有实例的任何替代方法也是可以接受的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T22:10:56.090

我不了解你，但在这里，`&rtp`不包含一个波浪号：所有文件路径都是绝对的：`/home/romainl/.vim/something`。

```
let aaa = substitute(&rtp, "/home/romainl", "~", "g") 
```

将所有相关文件路径转换为`~/.vim/something`​​.

```
let bbb = substitute(aaa, "\\~", "/home/romainl", "g") 
```

把所有的`~/.vim/something`背变成`/home/romainl/.vim/something`.

# php - jquery mobile navbar没有激活

> ID：15256710
> 
> 赞同：0
> 
> 时间：2013-03-06T19:53:49.657
> 
> 标签：php, jquery-mobile

我正在开发一个高度动态的应用程序。由于推送了很多东西，我创建了一个模板来将我所有的实际内容加载到：

```
<!DOCTYPE html> 
<html>      
<?php echo $head ?>
<body>
    <?php if ($pagetype = 1) { $segment = 1 ;} else { $segment = 2; } ?>
<div data-role="page" data-add-back-btn="true" id="<?php echo $this->uri->segment($segment)?>">

    <div data-id="pageheader" data-role="header" data-add-back-btn="true" data-position="fixed">
        <?php echo $header ?>
    </div>

    <div data-role="content">
        <?php echo $scripts ?>
        <?php echo $notification_list ?>
        <?php echo $content ?>
    </div>

    <div data-role="panel" id="navpanel" data-position="left" data-display="push" data-position-fixed="true" data-dismissible="true" data-theme="a">        
        <?php echo $nav ?>
    </div>

    <div data-role="footer" data-id="footer" data-position="fixed">
        <?php echo $footer ?>
    </div>
</div>
</body>
</html> 
```

现在，问题在于加载我的导航栏的`footer`位置：`$footer`

```
<div data-role="navbar">
        <ul>
        <li><a href="<?php echo base_url()?>structures/info/<?php echo $str_info['str_id'] ?>" data-icon="info" >Info</a></li>
        <li><a href="<?php echo base_url()?>structures/upgrade/<?php echo $str_info['str_id'] ?>" data-icon="gear" >Upgrade</a></li>
        <li><a href="<?php echo base_url()?>structures/recruit/<?php echo $str_info['str_id'] ?>" data-icon="refresh" ">Recruit</a></li>
        <li><a href="#" data-icon="gear" >City</a></li>
        <li><a href="#" data-icon="gear" >Military</a></li>
        </ul>
</div> 
```

关于导航栏根本不起作用的原因，是否有任何易于查看的原因？链接有效，但除非我手动指定，否则它们永远不会激活..

`<?php if ($pagetype = 1) { $segment = 1 ;} else { $segment = 2; } ?>`只是一种玩弄页面名称的方法。

# ruby-on-rails - 更好地重写我的 RoR 网站或寻找另一个虚拟主机？(Ruby on Rails)

> ID：15256712
> 
> 赞同：0
> 
> 时间：2013-03-06T19:54:03.903
> 
> 标签：ruby-on-rails, ruby-on-rails-3, web-hosting

我是 Ruby on Rails 的新手，在过去的一周里写了我的第一个网站。我正在将它从本地服务器部署到生产环境，但我意识到我的网络主机只安装了 Rails**版本 2.3.14 或 2.3.17**。
我正在使用 webhost 的 cpanel 来安装 Rails 版本，以使过程更容易。我使用 Rails 3.2.3 来编写我的整个网站。关于什么是最佳解决方案的任何建议？我应该对 Rails 2.x 版本进行所有调整吗？还是我应该寻找新的虚拟主机？或其他选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:16:07.170

新的虚拟主机。我建议您查看 Heroku - 特别是对于新的/小型项目，您可以在其中免费弄湿您的脚。

[https://devcenter.heroku.com/articles/rails3](https://devcenter.heroku.com/articles/rails3)

另请参阅[https://github.com/fastestforward/heroku_san](https://github.com/fastestforward/heroku_san)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:14:38.033

使用 bluehost.com 时我也遇到了同样的情况。

我考虑过使用 Heroku.com 进行部署，但后来我发现 Ryan Bates 编写的关于如何将我的应用程序部署到 VPS 的精彩教程：[http ://railscasts.com/episodes/335-deploying-to-a-vps](http://railscasts.com/episodes/335-deploying-to-a-vps)

您没有 cPanel 的所有优势，但它可以让您完全控制服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:27:58.297

获得一个 VPS 是件好事，而且从好的方面来说，你会学到一两件关于基本 linux 管理的知识。

# c# - Monotouch 绑定到 Cordova 的问题 (NSInvalidArgumentException)

> ID：15256719
> 
> 赞同：3
> 
> 时间：2013-03-06T19:54:19.510
> 
> 标签：c#, ios, cordova, xamarin.ios

我正在构建一个将使用 MonoTouch (Xamarin.iOS) 和 Cordova (PhoneGap) 组合的应用程序。UI 将主要使用 Cordova 制作，我们的业务逻辑将主要使用 MonoTouch 编写。

我找到了[描述这种情况的指南](http://scott.blomqui.st/2012/08/embedding-cordova-phonegap-in-monotouch-apps/)，所以我知道这是可能的，并且作者[在他们的 monotouch-bindings 项目的分支中添加了一个 Cordova 绑定](https://github.com/sblom/monotouch-bindings/tree/master/Cordova/Binding)。

不幸的是，当我尝试使用绑定创建单视图项目时，我几乎立即开始遇到问题。我使用提供的 Cordova 库中的 make 文件为此构建了 dll，并`ViewDidLoad`在我的测试应用程序的简单视图控制器中添加了方法`MyViewController`。这是我的来源

```
public class MyViewController : UIViewController
{
    private CDVViewController cdv;

    public MyViewController()
    {
    }

    public override void ViewDidLoad()
    {
        base.ViewDidLoad();

        View.Frame = UIScreen.MainScreen.Bounds;
        View.BackgroundColor = UIColor.White;
        View.AutoresizingMask = UIViewAutoresizing.FlexibleWidth | UIViewAutoresizing.FlexibleHeight;

        cdv = new CDVViewController();

        RectangleF rect = new RectangleF (0, 0, 320, 480);

        CDV.View.Frame = rect;

        View.AddSubview(cdv.View);
    }
} 
```

当我构造 时`CDVViewController`，我得到以下异常：

```
MonoTouch.Foundation.MonoTouchException: Objective-C exception thrown.  Name: NSInvalidArgumentException Reason: -[__NSCFArray dictionaryWithLowercaseKeys]: unrecognized selector sent to instance 0xc892680
  at at (wrapper managed-to-native) MonoTouch.ObjCRuntime.Messaging:IntPtr_objc_msgSend (intptr,intptr)
  at CordovaIOS.CDVViewController..ctor () [0x00000] in <filename unknown>:0
  at <Project_name>.MyViewController.ViewDidLoad () [0x00043] in /Users/jstarke/tmp/<Project_name>/MyViewController.cs:32
  at at (wrapper managed-to-native) MonoTouch.ObjCRuntime.Messaging:void_objc_msgSend  (intptr,intptr)
  at MonoTouch.UIKit.UIWindow.MakeKeyAndVisible () [0x00010] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIWindow.g.cs:126
  at <Project_name>.AppDelegate.FinishedLaunching (MonoTouch.UIKit.UIApplication app, MonoTouch.Foundation.NSDictionary options) [0x00031] in /Users/jstarke/tmp/<Project_name>/AppDelegate.cs:23
  at at (wrapper managed-to-native) MonoTouch.UIKit.UIApplication:UIApplicationMain (int,string[],intptr,intptr)
  at MonoTouch.UIKit.UIApplication.Main (System.String[] args, System.String principalClassName, System.String delegateClassName) [0x0004c] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIApplication.cs:38
  at <Project_name>.Application.Main (System.String[] args) [0x00000] in /Users/jstarke/tmp/<Project_name>/Main.cs:17 
```

到目前为止，我对这个问题的研究表明，这几乎可以肯定是一个具有约束力的问题。我对绑定还不太了解，但我正在努力学习，任何帮助或建议将不胜感激。重申一下，我正在使用的绑定，从这里找到：[https ://github.com/sblom/monotouch-bindings/tree/master/Cordova/Binding](https://github.com/sblom/monotouch-bindings/tree/master/Cordova/Binding)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T21:53:27.490

根据[这个线程](https://groups.google.com/forum/?fromgroups=#!topic/phonegap/z5MrloZGol4)，这是一个链接器/加载器问题。

该线程所指的链接已失效，但看起来该文档也可在此处获得： http: [//docs.phonegap.com/en/1.9.0/guide_cordova-webview_ios.md.html](http://docs.phonegap.com/en/1.9.0/guide_cordova-webview_ios.md.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T22:34:57.117

所以尽管这很尴尬，但我不得不承认我认为这是一个 PEBKAC（键盘和椅子之间存在问题）问题。

我正在关注的教程（[此处](http://scott.blomqui.st/2012/08/embedding-cordova-phonegap-in-monotouch-apps/)）实际上是处理旧版本的 Cordova，但作者提供的 make 文件实际上会拉下 Cordova 存储库的头部以构建绑定。

但实际上，这是一条红鲱鱼，真正的问题是用户（我）的问题。我检查了最新版本的 Cordova，并根据作者的说明使用它来设置示例项目，当我复制 config.plist（不存在）时，我错误地认为它是只是重命名为不同的名称，然后复制了该文件。当没有可用的插件时，系统将崩溃并显示上述错误消息。

我相信它是在 Cordova 2.1 中，但肯定是在 2.3 中，config.plist 被删除，并替换为 config.xml。绑定确实需要一些小的更新，但我认为这不会导致我的错误。

# python - 如何仅通过一个操作系统调用在python中获取目录的所有孙子

> ID：15256720
> 
> 赞同：3
> 
> 时间：2013-03-06T19:54:21.463
> 
> 标签：python

我正在尝试在 Python 中获取某个目录的所有孙子。出于性能原因，我不想一直循环调用操作系统函数（它是一个网络文件系统）。这就是我目前所拥有的。有没有更简单的方法来做到这一点？

```
dirTree = os.walk(root)
children = [os.path.join(root, x) for x in dirTree.next()[1]]
grandChildren = []
for root, dirs, files in dirTree:
    if root in children:
        for dir in dirs:
            grandChildren.append(os.path.join(root, dir)) 
```

编辑：我不清楚我对 os.walk 的调用是否是懒惰的。我的意图是在我打电话后整棵树都应该在内存中，但我不确定。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T20:17:42.933

如果我的问题是正确的。

您可以使用 glob 通过提供通配符符号来获取文件或目录。例如，在列表中获取“/home/”中的所有目录，您可以这样做。

```
glob.glob('/home/*/*/') 
```

或者要知道所有文件，你可以做

```
glob.glob('/home/*/*') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:13:18.870

在 POSIX 或 Windows 中，您无法在一次操作系统调用中获取所有数据。`opendir`对于 POSIX，每个目录（ , `readdir`, ）至少有三个`close`，每个目录条目（`stat`）加上一个。

* * *

我相信接下来的内容将导致操作系统调用少于您发布的内容。是的，`os.walk()`调用是懒惰的；也就是说，整个树在从 的返回时**不在**`walk()`内存中，而是在对 的调用期间被零散地读取`next()`。

因此，我的版本将只读取一阶后代目录，并且`stat`只读取直系子孙目录。您的版本也适用于所有曾孙，只要您的目录结构有多深。

```
root='.'
grandChildren = []
for kid in next(os.walk('.'))[1]:
  x = next(os.walk(os.path.join('.', kid)))
  for grandKid in x[1]:  # (or x[1]+x[2] if you care about regular files)
    grandChildren.append(os.path.join(x[0], grandKid)) 
```

或者，作为列表推导而不是 for 循环：

```
import os
root='.'
grandChildren = [
  os.path.join(kid, grandKid)
  for kid in next(os.walk(root))[1]
    for grandKid in next(os.walk(os.path.join(root, kid)))[1]] 
```

最后，将`os.walk`s 分解为一个函数：

```
def read_subdirs(dir='.'):
  import os
  return (os.path.join(dir,x) for x in next(os.walk(dir))[1])

root='.'
grandChildren = [
  grandKid
  for kid in read_subdirs(root)
    for grandKid in read_subdirs(kid)] 
```

* * *

通过测试，我们可以看到，`stat`如果有曾孙，我的版本调用次数比你的要少得多。

例如，在我的主目录中，我运行了我的代码 ( `/tmp/a.py`) 和你的 ( `/tmp/b.py`)，在每种情况下都`root`设置为：`'.'`

```
$ strace -e stat python /tmp/a.py 2>&1 > /dev/null | egrep -c stat
1245
$ strace -e stat python /tmp/b.py 2>&1 > /dev/null | egrep -c stat
36049 
```

# asp.net - MVC 半复杂模型绑定另一半始终为空

> ID：15256721
> 
> 赞同：0
> 
> 时间：2013-03-06T19:54:25.500
> 
> 标签：asp.net, asp.net-mvc-4, model-binding

**更新！**

好的，我现在已经测试了根据您发送的表单创建两个操作结果。

其中一个视图始终正确绑定登录模型。另一个未绑定总是返回null。

模型的结构是这样的

```
public class RegisterAndLogin
{
    public LogOnModel Login { get; set; }
    public interested_users Register { get; set; }
}

//This model never any values after HTTP post
public class interested_users
{
    [Required]
    [Display(Name = "Email")]
    public string Email { get; set; }
    [Required]
    [Display(Name = "UserType")]
    public string UserType { get; set; }    
    [Display(Name = "Date Inserted")]
    public DateTime DateInserted { get; set; }   
    [Display(Name = "IP")]
    public string IpAdress { get; set; }
    public List<SelectListItem> SelectItems { get; set; }
} 
```

和视图

```
@model MvcApplication2.Models.ViewModel.RegisterAndLogin

@{
ViewBag.Title = "Start by filling in your email";
}

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript">       </script> 
```

```
<h2 class="title">Sign up!</h2>

@using (Html.BeginForm("Index","Home", FormMethod.Post))
{   

 <div class="form-item">
         @Html.EditorFor(model => model.Register.Email,null,"emailbox",null)
        @Html.ValidationMessageFor(model => model.Register.Email)
    </div>
 <div class="form-item">
     @Html.DropDownListFor(model => model.Register.UserType,Model.Register.SelectItems, new { @class = "emailbox" })
    </div>
 <input type="submit" name="Register"  value="Register" class="form-submit" />
 } 
```

**更新！**

我在主视图中加载了两个局部视图。

其中一个是上面的，另一个是部分登录视图。

有点可疑..如果我告诉 @using (Html.BeginForm()) 的 NOT WORKING 视图

它不会在没有 HTTP 的情况下返回 ActionReslut，它会再次返回 HTTP。这告诉我另一个表单（登录表单）正在做一些我不知道的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:57:37.987

试试看

```
@Html.EditorFor(model => model.Register.Email,"emailbox") 
```

# memory - OpenCL 缓冲区大小填充

> ID：15256726
> 
> 赞同：0
> 
> 时间：2013-03-06T19:54:45.460
> 
> 标签：memory, opencl, padding, memory-alignment

当我在 OpenCL 中有一个内存缓冲区时，我知道我需要将其中的数据对齐到 16 字节边界。

但是，如果我的整个数据（不是数据结构，实际的数据集合）只有 15 个字节大，我该怎么办？
我应该把它放入一个 16 字节的大缓冲区还是一个 15 字节的缓冲区？
有性能差异吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T01:43:00.560

如果您要使用许多 15 字节数据结构并计划使用本地内存，我建议保留 15 字节结构并一次加载其中 16 个的倍数。我认为“许多”在您的工作组中至少是几 kb 的数据。这样做的原因是，当您为每 15 个字节牺牲额外的字节时，您会增加 6% 的传输开销。将大小保留为 15 还有助于在将数据写回内存（本地和全局内存）时避免存储库冲突。

[有关银行冲突的更多信息。](https://stackoverflow.com/questions/3841877/what-is-a-bank-conflict-doing-cuda-opencl-programming)

# android - 防止多次按下android按钮

> ID：15256729
> 
> 赞同：0
> 
> 时间：2013-03-06T19:54:47.090
> 
> 标签：android, button, sdk

我试过了`Thread.sleep(x)`，我试过了

```
setEnabled(false);
setClickable(false); 
```

但两者都没有按预期工作。我在某处读到点击排队，因此以前的解决方案不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T19:56:48.987

您可以在 onClick 中设置一个标志，例如`clickable = false`单击一次，然后在需要时重新启用它。`clickable`仅当is时才运行相关的 onClick 代码`true`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:59:14.287

您可以在单击后禁用它。在 xml 中为点击添加一个监听器

```
<Button
   android:id="@+id/button1"
   android:layout_height = "wrap_content"
   android:layout_width ="wrap_content"
   android:text = "lets do this"
   android:onClick = "DoIt"
/> 
```

然后在点击列表器中禁用它

```
public void DoIt(View v){
    ((Button) v).setEnabled(false);

    ...your code...
} 
```

# string - 如何比较 BASH 脚本中的字符串？

> ID：15256731
> 
> 赞同：1
> 
> 时间：2013-03-06T19:54:51.730
> 
> 标签：string, bash, command-line, terminal

我只想知道如何读取字符串然后进行比较。如果是“加号”，则继续

```
#!/bin/bash 

echo -n Enter the First Number:
read num
echo -n Please type plus:
 read opr

if [ $num -eq 4 && "$opr"= plus ]; then

echo this is the right

fi 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T19:59:31.137

```
#!/bin/bash 

read -p 'Enter the First Number: ' num
read -p 'Please type plus: ' opr

if [[ $num -eq 4 && $opr == 'plus' ]]; then
    echo 'this is the right'
fi 
```

如果您使用的是 bash，那么我强烈建议您使用双括号。它们比单括号好得多；例如，它们更合理地处理未引用的变量，您可以`&&`在括号内使用。

如果你使用单括号，那么你应该这样写：

```
if [ "$num" -eq 4 ] && [ "$opr" = 'plus' ]; then
    echo 'this is the right'
fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:59:21.817

```
#!/bin/bash 

echo -n Enter the First Number:
read num
echo -n Please type plus:
 read opr

if [[ $num -eq 4 -a "$opr" == "plus" ]]; then
#               ^            ^    ^
# Implies logical AND        Use quotes for string
    echo this is the right
fi 
```

# history - 第一种编程语言是如何编写的？

> ID：15256732
> 
> 赞同：-2
> 
> 时间：2013-03-06T19:54:55.303
> 
> 标签：history

甚至需要一种编程语言来接受一种语言。那么它最初是在哪里写的呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T19:56:43.067

[编译器引导。](http://en.wikipedia.org/wiki/Bootstrapping_%28compilers%29)第一个编译器（汇编器）是用纯硬件或机器代码实现的。

# responsive-design - 是否可以让浏览器忽略/禁用所有媒体查询？

> ID：15256740
> 
> 赞同：0
> 
> 时间：2013-03-06T19:55:33.240
> 
> 标签：responsive-design, media-queries, fixed-width

基本上，我必须（暂时）制作一个固定宽度的网站，但不幸的是，有许多 CSS 文件，其中包含媒体查询，遍及所有文件。我已经为`body`标签添加了一个固定的像素宽度，但是当浏览器重新调整大小时媒体查询仍然有效，例如`div`元素清除和移动到布局中的其他元素下方。

我能想到的唯一方法是浏览所有 CSS 文件，注释掉所有可能很痛苦的媒体查询。在我这样做之前，你知道是否有更快的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T23:58:12.653

Body or wrapper, set a static width and use override.

body{ width: 1280px !important; }

# iphone - 由于未捕获的异常“NSUnknownKeyException”而终止应用程序，原因：“[ setValue:forUndefinedKey:]:

> ID：15256744
> 
> 赞同：4
> 
> 时间：2013-03-06T19:55:43.400
> 
> 标签：iphone, xcode, ipad

我正在 Xcode 中制作应用程序，但我一直收到错误消息

“由于未捕获的异常'NSUnknownKeyException'而终止应用程序，原因：'[setValue：forUndefinedKey：]：此类不符合键值编码的键值”

最近。我一直在寻找几个小时，我似乎找不到与我的情况相匹配的答案。当我添加新对象并删除 .h 文件中的一些对象时发生了此错误，但我已双重三重四重检查每个出口是否正确连接。没有什么是幻连接或不连接的，一切都很好。当我试图删除错误代码中提到的密钥时，它转到下一个密钥并继续，基本上每个连接都是坏的。我已经正确连接了视图（我认为），因为当我在 .h 文件中添加新插座时，我能够在 xib 文件中看到它并连接它，但每次打开应用程序时，我仍然会收到此错误。

我最近将视图控制器 id thingy 更改为 XcodeProjectViewController 并且我检查了我的所有文件（h、m 和 xib）以查看它们是否匹配。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-08T03:03:31.377

我在最新的应用程序 Label Dispenser PRO 中遇到了此错误消息。这很烦人，因为所有代码*看起来*都不错（因为它们是）。

经过几个小时的调查，事实证明（就我而言）问题是我指定（意外？）XIB 文件作为 Target 的摘要区域中“iPad 开发信息”部分的主界面。这是说明此位置的图片： ![在此处输入图像描述](../Images/2138154c913d6fd5f7cf1f6f3e02c8e5.png)

删除这个字段解决了这个问题。我猜这是因为编译器很困惑，因为我在 AppDelegate 中根据 if 语句评估“if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)”手动呈现 XIB。

希望这可以帮助某人。干杯。

# c# - Linq to XML 没有获取任何元素

> ID：15256746
> 
> 赞同：2
> 
> 时间：2013-03-06T19:55:50.450
> 
> 标签：c#, xml, linq, xml-parsing, xml-namespaces

试图解析这个 xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<feed gd:kind="shopping#products"
      gd:etag="&quot;pUAQLMOCjdnNh1LcpqK05ByVY7g/Gsdf7eFzzI3Z-HW0Z-XItKMrp8c&quot;"
      xmlns="http://www.w3.org/2005/Atom"
      xmlns:gd="http://schemas.google.com/g/2005"
      xmlns:s="http://www.google.com/shopping/api/schemas/2010">
    <entry gd:kind="shopping#product">
        <s:product>
            <s:googleId>11111</s:googleId>
            <s:author>
                <s:name>ebay.de</s:name>
                <s:accountId>11111</s:accountId>
            </s:author>
            <s:creationTime>2012-08-16T19:20:24.000Z</s:creationTime>
            <s:modificationTime>2013-03-01T17:50:54.000Z</s:modificationTime>
            <s:country>It</s:country>
            <s:language>de</s:language>
            <s:title>Blomus Rund-Magnete</s:title>
            <s:brand>Blomus</s:brand>
            <s:condition>new</s:condition>
            <s:mpns>
                <s:mpn>66742</s:mpn>
            </s:mpns>
            <s:inventories>
                <s:inventory channel="online" availability="inStock">
                    <s:price shipping="4.9" currency="EUR">4.2</s:price>
                </s:inventory>
            </s:inventories>
            <s:images>
            </s:images>
        </s:product>
    </entry>
</feed> 
```

林克：

```
XNamespace s = "http://www.google.com/shopping/api/schemas/2010";

var q = from product in XMLDoc.Root.Elements("entry").Elements(s+"product")
        let inventory = product.Element(s + "inventories").Element(s + "inventory")
        let price = (decimal)inventory.Element(s + "price")
        let shipping = (decimal)inventory.Element(s +"price").Attribute("shipping")
        let totalprice = price + shipping
        select new
        {
            Name = (string)product.Element(s + "author").Element(s + "name"),
            Shipping = shipping,
            TotalPrice = totalprice,
            Price = price+shipping
        }; 
```

返回的`q`计数始终为 0，可能有什么问题？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:08:12.897

您`entry`缺少名称空间。我已尝试将其替换为`s:entry`（和） `XMLDoc.Root.Elements("entry")`，`XMLDoc.Root.Elements(s + "entry")`并且您的查询运行良好。

问题是您已经定义了默认命名空间`xmlns="http://www.w3.org/2005/Atom"`。因此，您也必须将它用于没有前缀的元素，如下所示：

```
XNamespace def = "http://www.w3.org/2005/Atom"; 
```

然后`xDoc.Root.Elements(def + "entry")`。

# twitter-bootstrap - 无法让自定义 css 在 Twitter Bootstrap 中级联

> ID：15256750
> 
> 赞同：0
> 
> 时间：2013-03-06T19:55:54.127
> 
> 标签：twitter-bootstrap

我正在开发我的第一个 TB 站点并试图了解如何自定义 css。我宁愿不碰 bootstrap.css 文件，而是有一个 mycustom.css 文件。然而，级联似乎没有工作，尽管我在我的标签中最后调用了它。举个简单的例子：我想改变导航栏链接的颜色。如果我在 bootstrap.css 文件中更改它，我可以让它工作。如果我在 mycustom.css 中放置相同的样式声明并在那里更改颜色，它没有任何效果。这是我所指的 css，但情况与我尝试自定义的任何内容相同。

`

```
.navbar .nav > li > a:focus,
.navbar .nav > li > a:hover {

  color:#93a4bb;   /* light blue  */

}` 
```

关于结核病，还有什么我不了解的事情吗？

# android - 将 File[] 转换为 String[] 以将其放入 arrayadapter

> ID：15256757
> 
> 赞同：0
> 
> 时间：2013-03-06T19:56:15.000
> 
> 标签：android, file, casting, android-arrayadapter

我需要用文件名填充数组适配器。我调用了这个函数来检索目录中的文件列表：

```
File dir_path = getApplicationContext().getDir(getResources().getString(R.string.app_name), MODE_PRIVATE);
File[] children = dir_path.listFiles(); 
```

现在我需要将子数组中的所有文件名放入数组适配器中。我需要逐个元素地投射，还是有另一种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T19:58:16.907

尝试类似以下的操作。[getName()](http://developer.android.com/reference/java/io/File.html#getName%28%29)将为您提供与 File 对象关联的文件的名称，并且循环将使用名称填充 String 数组。

```
String names = new String[children.length];
for(int i=0;i<children.length;i++) {
    names[i] = children[i].getName();
} 
```

然后只需将`names`数组传递给您的 ArrayAdapter。

# symfony - 如何使用 FOSUserBundle 强制更改密码？

> ID：15256759
> 
> 赞同：12
> 
> 时间：2013-03-06T19:56:18.057
> 
> 标签：symfony, symfony-2.1, fosuserbundle

我正在尝试在 Symfony 2.1 项目中实现安全功能，管理员可以使用初始密码创建用户，然后在用户第一次登录时自动触发更改密码处理程序。

我遇到了覆盖 FOSUserBundle 类的问题，我认为这肯定已经以某种方式内置，至少部分内置，尽管我在任何地方的文档中都看不到它。

我想在实体中使用 credentials_expired 标志。当管理员创建用户时，这将设置为 1。当用户首次登录时，会检查 credentials_expired，而不是抛出异常，而是触发 change-password。我已经做到了这一步。

然后，ChangePasswordController 将确保密码实际上已更改（这似乎不是 FOS 中的默认行为），并且 credentials_expired 设置为 0。这就是我卡住的地方。有太多的服务层，我似乎无法正确地定制东西。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-08T00:15:59.823

这是详细的答案。感谢 Manu 的跳板！

首先，确保在 composer.json 文件中获得正确的 FOSUserBundle（“dev-master”，而不是“*”）：

```
"friendsofsymfony/user-bundle":"dev-master" 
```

以下全部包含在我自己的用户包中，它按照安装文档中的说明扩展了 FOSUserBundle。

PortalFlare/Bundle/UserBundle/Resources/config/services.xml：

```
<container xmlns="http://symfony.com/schema/dic/services"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://symfony.com/schema/dic/services  http://symfony.com/schema/dic/services/services-1.0.xsd">

<parameters>
    <parameter key="portal_flare_user.forcepasswordchange.class">PortalFlare\Bundle\UserBundle\EventListener\ForcePasswordChange</parameter>
    <parameter key="portal_flare_user.passwordchangelistener.class">PortalFlare\Bundle\UserBundle\EventListener\PasswordChangeListener</parameter>
</parameters>

<services>
    <service id="portal_flare_user.forcepasswordchange" class="%portal_flare_user.forcepasswordchange.class%">
        <argument type="service" id="router" />
        <argument type="service" id="security.context" />
        <argument type="service" id="session" />
        <tag name="kernel.event_listener" event="kernel.request" method="onCheckStatus" priority="1" />
    </service>
    <service id="portal_flare_user.passwordchange" class="%portal_flare_user.passwordchangelistener.class%">
        <argument type="service" id="router" />
        <argument type="service" id="security.context" />
        <argument type="service" id="fos_user.user_manager" />
        <tag name="kernel.event_subscriber" />
    </service>
</services>

</container> 
```

PortalFlare/Bundle/UserBundle/EventListener/ForcePasswordChange.php：

```
 <?php

namespace PortalFlare\Bundle\UserBundle\EventListener;

use Symfony\Component\HttpFoundation\RedirectResponse;
use Symfony\Component\HttpKernel\Event\GetResponseEvent;

use Symfony\Component\Security\Core\SecurityContext;
use Symfony\Bundle\FrameworkBundle\Routing\Router;
use Symfony\Component\HttpFoundation\Session\Session;

/**
 * @Service("request.set_messages_count_listener")
 *
 */
class ForcePasswordChange {

  private $security_context;
  private $router;
  private $session;

  public function __construct(Router $router, SecurityContext $security_context, Session $session) {
    $this->security_context = $security_context;
    $this->router           = $router;
    $this->session          = $session;

  }

  public function onCheckStatus(GetResponseEvent $event) {

    if (($this->security_context->getToken()) && ($this->security_context->isGranted('IS_AUTHENTICATED_FULLY'))) {

      $route_name = $event->getRequest()->get('_route');

      if ($route_name != 'fos_user_change_password') {

        if ($this->security_context->getToken()->getUser()->hasRole('ROLE_FORCEPASSWORDCHANGE')) {

          $response = new RedirectResponse($this->router->generate('fos_user_change_password'));
          $this->session->setFlash('notice', "Your password has expired. Please change it.");
          $event->setResponse($response);

        }

      }

    }

  }

} 
```

PortalFlare/Bundle/UserBundle/EventListener/PasswordChangeListener.php：

```
<?php
namespace PortalFlare\Bundle\UserBundle\EventListener;

use FOS\UserBundle\FOSUserEvents;
use FOS\UserBundle\Event\FormEvent;
use FOS\UserBundle\Doctrine\UserManager;
use Symfony\Component\EventDispatcher\EventSubscriberInterface;
use Symfony\Component\HttpFoundation\RedirectResponse;
use Symfony\Component\Routing\Generator\UrlGeneratorInterface;
use Symfony\Component\Security\Core\SecurityContext;

/**
 * Listener responsible to change the redirection at the end of the password change
 */
class PasswordChangeListener implements EventSubscriberInterface {
  private $security_context;
  private $router;
  private $usermanager;

  public function __construct(UrlGeneratorInterface $router, SecurityContext $security_context, UserManager $usermanager) {
    $this->security_context = $security_context;
    $this->router           = $router;
    $this->usermanager      = $usermanager;
  }

  /**
   * {@inheritDoc}
   */
  public static function getSubscribedEvents() {
    return array(
      FOSUserEvents::CHANGE_PASSWORD_SUCCESS => 'onChangePasswordSuccess',
    );
  }

  public function onChangePasswordSuccess(FormEvent $event) {

    $user = $this->security_context->getToken()->getUser();
    $user->removeRole('ROLE_FORCEPASSWORDCHANGE');
    $this->usermanager->updateUser($user);

    $url = $this->router->generate('_welcome');
    $event->setResponse(new RedirectResponse($url));
  }
} 
```

FOSUserBundle 的问题实际上并没有确保用户更改密码是另一天的问题。

我希望这可以帮助别人。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-07T15:42:39.927

一个好的方法是开始定义一个 ROLE_USER，它是可以访问整个应用程序的角色。当用户注册时，自动添加他 ROLE_CREDENTIAL_EXPIRED 或类似的东西。使用[JMSSecurityExtraBundle](http://jmsyst.com/bundles/JMSSecurityExtraBundle)，您可以在控制器中使用注释，决定具有给定角色的用户是否可以访问。[还要检查Symfony 如何处理 HTTP Authentication](http://symfony.com/doc/2.1/book/security.html)的文档。

# file-upload - Struts 2 文件上传 - 空指针异常

> ID：15256761
> 
> 赞同：1
> 
> 时间：2013-03-06T19:56:22.823
> 
> 标签：file-upload, struts2

我正在尝试使用 Struts2 和 Spring 一起上传文件。但是，不知何故，在达到我的行动课程后，我的文件`filename`和文件内容类型都以`null`. 我尝试搜索问题但没有结果。下面是我的文件上传代码。

**`index.jsp`：**

```
<%@ taglib prefix="s" uri="/struts-tags" %>
<html>
<head>
<s:head />
</head>
 <s:actionerror />
<s:form action="uploadAction" method="POST" enctype="multipart/form-data">

<s:file name="fileUpload" label="Choose File" size="40" />

<s:submit value="Upload" name="submit" />

</s:form> 
```

**Struts.xml**

```
 <?xml version="1.0" encoding="UTF-8"?>

    <!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">

    <struts>
        <include file="struts-default.xml"/>
        <package name="a" extends="struts-default">

   <action name="resultAction" class="ManagePlanDataFileUploadActionBean"   method="executeFileUploadDemo">

            <interceptor-ref name="fileUpload">
                <param name="maximumSize">10240</param>
                <param name="allowedTypes">text/plain</param>
            </interceptor-ref>                
            <interceptor-ref name="defaultStack" />
    <result name="success">displayResultsJSP</result>

</action>
        </package>
    </struts> 
```

**applicationContext-web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jee="http://www.springframework.org/schema/jee"
    xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
    http://www.springframework.org/schema/jee
    http://www.springframework.org/schema/jee/spring-jee-2.0.xsd
    http://www.springframework.org/schema/aop
    http://www.springframework.org/schema/aop/spring-aop-2.0.xsd
    http://www.springframework.org/schema/tx
    http://www.springframework.org/schema/tx/spring-tx-2.0.xsd">
    <bean id="ManagePlanDataFileUploadActionBean" scope="prototype"

    class="com.hix.action.planmanagement.ManagePlanDataFileUploadAction">

    </bean>
</beans> 
```

**ManagePlanUploadAction**

```
package com.hix.action.planmgmt;

import java.io.File;

import javax.servlet.http.HttpServletRequest;

import org.apache.commons.io.FileUtils;

import com.opensymphony.xwork2.ActionSupport;

public class ManagePlanUploadAction extends ActionSupport{

      private HttpServletRequest request;

      private File fileUpload;
      private String fileUploadContentType;
      private String fileUploadFileName;

       public void setServletRequest(HttpServletRequest paramHttpServletRequest) {
             this.request = paramHttpServletRequest;
       }

       public HttpServletRequest getServletRequest() {
             return request;
       }

        public File getFileUpload() {
            return fileUpload;
        }

        public void setFileUpload(File fileUpload) {
            this.fileUpload = fileUpload;
        }

        public String getFileUploadContentType() {
            return fileUploadContentType;
        }

        public void setFileUploadContentType(String fileUploadContentType) {
            this.fileUploadContentType = fileUploadContentType;
        }

        public String getFileUploadFileName() {
            return fileUploadFileName;
        }

        public void setFileUploadFileName(String fileUploadFileName) {
            this.fileUploadFileName = fileUploadFileName;
        }

        public String executeFileUploadDemo() throws Exception {
            try {
                String filePath = "C:/Myuploads2";
                System.out.println("Server path:" + filePath);
                File fileToCreate = new File(filePath, fileUploadFileName);
                FileUtils.copyFile(fileUpload, fileToCreate);
                } catch(Exception e) {
                    e.printStackTrace();
                    addActionError(e.getMessage());
                    return SUCCESS;
                }       
                    System.out.println("File :" + fileUpload);
                    System.out.println("Filename : " + fileUploadFileName);
                    System.out.println("File type : " + fileUploadContentType);
                return SUCCESS; 
        }
} 
```

**瓷砖-def.xml**

```
<!DOCTYPE tiles-definitions PUBLIC
       "-//Apache Software Foundation//DTD Tiles Configuration 2.0//EN"
       "http://tiles.apache.org/dtds/tiles-config_2_0.dtd">

<tiles-definitions>
<definition name="displayResultsJSP" template="/jsp/planmgmt/Result.jsp">

<put-attribute name="header" value="/jsp/template/defaultHeader.jsp" /> 

<put-attribute name="footer" value="/jsp/template/defaultFooter.jsp" />

</definition>

</tiles-definitions> 
```

**结果.jsp**

```
<%@ taglib prefix="s" uri="/struts-tags" %>
<html>

<body>
   File Name : <s:property value="fileUploadFileName"/> 
  <br/>
   Content Type : <s:property value="fileUploadContentType"/> 
  <br/>
   File : <s:property value="fileUpload"/> 
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-09T19:11:19.470

我的问题现在已经解决了。我必须将 jars（commons fileupload 和 commons io）添加到我的类路径中，还要添加到 RAD 的“部署程序集”中。

# vb.net - 有没有办法在 Visual Studio 中调试 VB.NET With 子句？

> ID：15256776
> 
> 赞同：5
> 
> 时间：2013-03-06T19:56:55.367
> 
> 标签：vb.net, visual-studio-2010, visual-studio-debugging, with-statement

有时您并不真正关心变量的名称，因为它不会超出您的子范围。事实上，指定名称会添加额外的代码行。现在您还可以处理这个名称，这可能会增加潜在的重构工作（如果您决定稍后重命名它）。看看下面的代码：

```
Dim fileInfo As New FileInfo("filename.txt")
With New FileSystemWatcher
  .Path = fileInfo.DirectoryName
  .Filter = fileInfo.Name
  .EnableRaisingEvents = True
  AddHandler .Changed, AddressOf OnChanged
End With 
```

它是一个完全有效的 VB.NET 结构，看起来整洁干净。但是，当涉及到调试时，假设您在子句中放置了一个断点`With`，则没有选项可以抓住它`.Path`来确保它被正确设置。

**我在这里遗漏了什么，还是 Visual Studio 真的没有为语句中的`.Property`语法提供调试`With`？我用的是2010。**

显然，在上面的代码中没有太多需要调试的地方，但是可以有很多例子说明这种*无名* `With`的方法何时会派上用场。

顺便说一句，命名`With`子句有同样的问题，即如果我要写：

```
Dim fsw As New FileSystemWatcher
With fsw
  .Path = fileInfo.DirectoryName
  .Filter = fileInfo.Name
  .EnableRaisingEvents = True
  AddHandler .Changed, AddressOf OnChanged
End With 
```

我仍然无法提取 的值`.Path`，必须始终为其添加前缀`fsw`。

当您将`With`子句相互嵌套时，问题就会越来越大。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T12:10:44.317

带有未命名变量的 With 语句对于调试器来说是一个巨大的挑战，没有解决方法。像“fsw”这样的小型命名辅助变量没有任何问题，它无论如何都存在，由编译器自动生成。这不是无名的，只是无法形容的。像 一样`VB$t_ref$L0)`，调试器不会让您输入它，因为它使用在 VB.NET 标识符名称中无效的字符。这是有意的，它确保它永远不会与您使用的名称发生冲突。这也可以防止它出现在“自动”窗口中。

您已经通过命名变量找到了正确的解决方法。从那里进行调试很简单，只需将鼠标悬停在变量名称上，而不是字段名称上。当然，在所有其他调试器窗口中都运行良好，尤其是 Autos 窗口将焕发生机。并且不要犹豫放弃 With 语句，而只支持完整地编写语句，IntelliSense 有助于使这不那么繁琐*。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T09:51:35.617

一个选项是将这些变量添加到监视列表中，并从监视窗口查看值。

# objective-c - const 声明导致 Xcode 中的链接器错误

> ID：15256777
> 
> 赞同：3
> 
> 时间：2013-03-06T19:56:57.870
> 
> 标签：objective-c, xcode, header, constants, linker-errors

我正在创建一个 openGL 引擎（一侧用于 ES 1.1，一侧用于 ES 2.0）。两个引擎目前都有一些恒定的顶点（如下所示）。不幸的是，在编译时我收到以下错误：

```
 ld: 1 duplicate symbol for architecture i386
 clang: error: linker command failed with exit code 1 (use -v to see invocation) with the duplicate symbol being _Verticies. 
```

为什么 Xcode 在两个单独的文件中抱怨重复的常量值？符合相同协议的文件......但大部分是它们的连接。在 C++ 中，此方法可以正常工作，但在转换为 Objective-C 时会导致指出的错误。

```
//Define the positions and colors of two triangles
const Vertex Verticies[] = { //per vertex data
    {{-0.5f, -0.866f},{1.0f, 1.0f, 0.5f, 1.0f}},
    {{0.5f, -0.866f},{1.0f, 1.0f, 0.5f, 1.0f}},
    {{0.0f, 1.0f},{1.0f, 1.0f, 0.5f, 1.0f}},
    {{-0.5f, -0.866f},{0.5f, 0.5f, 0.5f, 0.0f}},
    {{0.5f, -0.866f},{0.5f, 0.5f, 0.5f}},
    {{0.0f, -0.4f},{0.5f, 0.5f, 0.5f}},
}; 
```

解决方案：目前看来，默认情况下，Objective-C 中的 const 值受项目范围的影响，而不仅仅是文件的范围。在 C++ 中，当创建一个 const 值时，作用域会自动限制在它所在的文件中。要在 Objective-C 中解决这个问题，必须使用静态标记来将作用域限制为该特定文件。您也可以使用 extern 标签（但这需要更多的工作）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T20:11:31.730

它在 C++ 中有效，因为在 C++ 中，全局变量 with`const`也暗示为`static`. 在 C 中情况并非如此。当您更改为从 C“继承”的 Objective-C 时，这种行为会丢失并且`const`符号突然变为`extern`.

`const`为变量添加前缀`static`以获得与 C++ 中相同的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T20:00:47.030

如果该`Verticies`变量仅在一个编译单元（文件）中使用，则应使用存储类说明符声明它`static`。

这可以防止编译器发出链接器可见的外部符号。在 C 语言中：符号具有内部链接。

C 和 C++ 之间的许多细微差别之一是`const`在 C 中并不意味着内部链接。

# gwt - 动态生成内容的 GWT 国际化

> ID：15256782
> 
> 赞同：3
> 
> 时间：2013-03-06T19:57:12.440
> 
> 标签：gwt, internationalization

对于我的大多数应用程序，我可以使用[https://developers.google.com/web-toolkit/doc/latest/DevGuideI18n](https://developers.google.com/web-toolkit/doc/latest/DevGuideI18n)中推荐的国际化技术（主要是 UIBinder 方法）。

我目前正在使用一个接收对象并动态显示其属性/字段的小部件，因此无法使用 UIBinder 和上述国际化技术。

我是否只需要更改我的设计并为我希望显示的每种类型的对象创建多个小部件，还是我尚未找到已建立的国际化技术？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T08:58:46.447

[您需要从标题为Dynamic String Internationalization](https://developers.google.com/web-toolkit/doc/latest/DevGuideI18n#DevGuideDynamicStringInternationalization)的部分重新阅读开发指南。

该方法意味着您需要为语言环境支持编写代码。我们已经使用[Dictionary](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/i18n/client/Dictionary.html)类完成了这项工作。提供语言环境支持的诀窍是为每个语言环境都有一个字典。

**第 1 步 -** 确保将 GWT module.gwt.xml 的语言环境概念与 cookie 一起使用。确保在 gwt 应用程序加载之前设置 cookie GWT_LOCALE。

```
<extend-property name="locale" values="en,ar,de" />
<set-property name="locale" value="en" />
<set-property-fallback name="locale" value="en" />
<set-configuration-property name="locale.cookie" value="GWT_LOCALE" />
<set-configuration-property name="locale.useragent" value="Y" /> 
```

**第 2 步 -** 使用 html 脚本标签预先加载 WidgetMessages.js，如果您希望按需延迟获取，请使用 RequestBuilder。WidgetMessages.js 的内容

```
var widget_messages_en = {
    "today" : "Today",
    "now" : "Now"
};

var widget_messages_ar= {
    "today"  : "۷ڤدجچ",
    "now"  : "چڤت"
}

var widget_messages_de= { 
    "today"  : "Today",
    "now"  : "Now"
} 
```

**第 3 步**- 处理字典并将其加载到本地哈希图中。

```
 private static Map<String, Dictionary> I18N_DICTIONARIES = new HashMap<String, Dictionary>();

    private static Dictionary createDictionary( String dictionaryName)
    {
            String moduleId = dictionaryName + "_messages_" + LocaleInfo.getCurrentLocale().getLocaleName();
            Dictionary dictionary = Dictionary.getDictionary( moduleId );
            I18N_DICTIONARIES.put( dictionaryName, dictionary );
            return dictionary;
    }

    public static String getI18NString(String dictionaryName, String stringToInternationalize )
    {
        Dictionary dictionary = I18N_DICTIONARIES.get( dictionaryName);
        if ( dictionary == null )
        {
            dictionary = createDictionary( dictionaryName);
        }
        String i18string = null;
        if ( dictionary == null )
            return stringToInternationalize;
        try
        {
            i18string = dictionary.get( stringToInternationalize );
        }
        catch ( Exception e )
        {
        }
        return i18string;
    } 
```

**注意**- 您可以尝试上述方法的几种变体来将字符串处理为 i18nstrings 并将它们用于小部件....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T01:33:13.160

你检查过字典类吗？它应该满足您的需求，除非您的标签需要对区域设置敏感 [http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/i18n/client/Dictionary.html](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/i18n/client/Dictionary.html)

# caching - 如何将 Expires 响应标头添加到 WebAPI 操作响应？

> ID：15256785
> 
> 赞同：15
> 
> 时间：2013-03-06T19:57:20.793
> 
> 标签：caching, http-headers, asp.net-web-api

我很确定“过期”是有效的 HTTP 响应标头类型。但是当我尝试在我的代码中设置它时：（这是在 ActionFilter.OnActionExecuted 方法中）

```
actionExecutedContext.Response.Headers.Add("Expires", (DateTime.Now + Timespan.FromDays(7)).ToString("R")); 
```

我最终遇到了一个例外：

> InvalidOperationException：误用的标头名称。确保请求标头与 HttpRequestMessage 一起使用，响应标头与 HttpResponseMessage 一起使用，内容标头与 HttpContent 对象一起使用。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-06T20:09:56.367

Expires 是一个内容标题。试试这个：

```
actionExecutedContext.Response.Content.Headers.Expires = DateTimeOffset.Now.AddDays(7); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:12:22.473

尝试

```
response.Content.Headers.Expires = DateTimeOffset.Now.AddDays(7); 
```

# php - 在 PHP 中存储这些结构化信息的最合乎逻辑的方式是什么？

> ID：15256786
> 
> 赞同：1
> 
> 时间：2013-03-06T19:57:27.183
> 
> 标签：php

因此，我试图根据特定应用程序具有的选项数量动态生成 HTML 列表。

列表中的项目应采用以下形式：

```
 <li>
           <a href="$HREF" title="$LINK_TITLE">
               <i class="$ICON_CLASS"></i> $OPTION_NAME
           </a>
       </li> 
```

其中，对于应用程序中的每个“选项”，都有四个与之关联的字符串：`href`、`link_title`、`icon-class`和`option_name`.

现在，如果我用 C 编程，我可能会使用结构来保存这些信息。不过在 PHP 中，我不太确定。我为每个选项存储这四个字段的最合乎逻辑的方式是什么？理想情况下，我正在尝试对其进行设置，以便可以使用简单的 for 循环生成列表。

PHP 中的最佳实践是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T19:59:39.120

多维数组：

```
array(
    'option' => array('href' => 'url', 'title' => 'title', 'icon' => 'icon'), 
    'option' => array('href' => 'url', 'title' => 'title', 'icon' => 'icon')
); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T20:02:29.473

您可以使用一个类：

```
class MyOption {
    public $href;
    public $link_title;
    public $icon_class;
    public $option_name;
}
$op = MyOption();
$op->href = "http://www.google.com"; 
```

或者一个数组：

```
$op = array(
    'href'        => "http://www.google.com";
    'link_title'  => "Google";
    'icon_class'  => "image";
    'option_name' => "name";
);
echo $op['icon_class']; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-06T20:03:09.267

最简单的方法是只使用关联数组：

```
$array = array(
  array(
    "href"=>"value",
    "link_title"=>"value",
    "icon_class"=>"value",
    "option_name"=>"value"
  ),
  array(
    "href"=>"value",
    "link_title"=>"value",
    "icon_class"=>"value",
    "option_name"=>"value"
  ),
); 
```

然后您可以在主数组上使用`foreach`循环，并获取变量的关联索引。

或者，如果您更喜欢 OOP，您可以尝试以下方法：

```
class Option {
    private $href="";
    private $link_title="";
    private $icon_class="";
    private $option_name="";
    public function __construct($a,$b,$c,$d) {
        $this->href = $a;
        $this->link_title = $b;
        $this->icon_class = $c;
        $this->option_name = $d;
    }
    public function __toString() {
        return "<li><a href=\"".$this->href."\" title=\"".$this->link_title."\">"
           ."<i class=\"".$this->icon_class."\"></i> ".$this->option_name."</a></li>";
    }
}
$array = array(
    new Option("href","title","class","name"),
    new Option("href","title","class","name")
);
echo implode("\n",$array); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-06T20:03:30.737

如果你想走 OOP 的方式，你也可以使用一个对象：

```
<?php
    class link {
        public $href;
        public $title;
        public $icon;
        public $option;
        public function __construct($href, $title, $icon, $option) {
            $this->href = $href;
            $this->title = $title;
            $this->icon = $icon;
            $this->option = $option;
        }
    }

    $links = array();
    $links[] = new link('http://www.google.com', 'Google', 'google.png', 'google_option');

    foreach ($links as $link) {
        ?>
            <li>
                <a href="<?=$link->href?>" title="<?=$link->title?>">
                    <i class="<?=$link->icon?>"></i> <?=$link->option?>
                </a>
            </li>
        <?php
    }
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-06T20:18:03.843

有几种好方法，具体取决于列表的大小和您想用它做什么。

仅使用数组：

```
$links = array();
$links[] = array('href'=>$href, 'title'=>$title, 'class'=>$class, 'name'=>$name);
$links[] = array('href'=>$href2, 'title'=>$title2, 'class'=>$class2, 'name'=>$name2);

foreach ($links as $link) {
    echo "<li>
           <a href=\"{$link['href']}\" title=\"{$link['title']}\">
               <i class=\"{$link['class']}\"></i> {$link['name']}
           </a>
          </li>";
} 
```

也可以为这种情况构造对象并将对象存储在数组中：

```
class linkClass {
    public $href;
    public $title;
    public $class;
    public $name;

    function __construct($href, $title, $class, $name) {
        $this->href = $href;
        $this->title = $title;
        $this->class = $class;
        $this->name = $name;
    }

    function listItem() {
        return "<li>
                  <a href=\"{$this->href}\" title=\"{$this->title}\">
                    <i class=\"{$this->class}\"></i> $this->name}
                  </a>
                </li>";
    }
}

$array_of_link_objects = array();
$array_of_link_objects[] = new link($href, $title, $class, $name);
$array_of_link_objects[] = new link($href2, $title2, $class2, $name2);

foreach ($array_of_link_objects as $link_object) {
    echo $link_object->listItem();
} 
```

为了将来参考，如果您需要在不使用哈希表的情况下存储大量项目，请尝试查看 php.net 上的 splFixedArray 文档。它只允许使用数字键，所以 $spl_object['href'] 不起作用。不过，对于大型 splFixedArrays，内存节省是巨大的。对于您的情况，如果您要在许多不同的文件中使用这些链接，我可能会说尝试使用对象方法，以便以后轻松维护代码。如果它被隔离到一个文件并且您没有使用 100k 链接（因为数组对于 PHP 中的内存来说非常糟糕），那么只使用多维数组就可以了。

# postgresql - 从 PostgreSQL 中的存储过程删除或创建数据库

> ID：15256793
> 
> 赞同：5
> 
> 时间：2013-03-06T19:57:40.920
> 
> 标签：postgresql, stored-procedures, plpgsql, ddl, dblink

我有一个看起来像这样的函数：

```
BEGIN
  DROP DATABASE IF EXISTS db_1;
END; 
```

我收到以下错误：

> 错误：不能从函数或多命令字符串执行 DROP DATABASE。

不能从 PostgreSQL 的存储过程中删除数据库吗？我正在使用 plpgsql。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T00:31:52.110

[错误消息与手册](http://www.postgresql.org/docs/current/interactive/sql-dropdatabase.html)一样清楚：

> `DROP DATABASE`不能在事务块内执行。

plgpsql 函数自动被事务块包围。长与短：你不能直接这样做。有什么特殊原因不能只调用 DDL 命令吗？

```
DROP database $mydb; 
```

您*可以使用*[@Igor](https://stackoverflow.com/questions/15256793/drop-or-create-database-from-stored-procedure-in-postgresql#comment21522666_15256793)建议的附加模块[**dblink**](http://www.postgresql.org/docs/current/interactive/dblink.html)来规避这些限制。您需要为每个数据库安装一次 - 您调用 dblink 函数的数据库，而不是您执行命令的（其他）数据库。 允许您使用如下方式编写函数：
[`dblink_exec()`](http://www.postgresql.org/docs/current/interactive/contrib-dblink-exec.html)

```
CREATE OR REPLACE FUNCTION f_drop_db(text)
  RETURNS text LANGUAGE sql AS
$func$
SELECT dblink_exec('port=5432 dbname=postgres'
                  ,'DROP DATABASE ' || quote_ident($1))
$func$; 
```

`quote_ident()`防止可能的 SQL 注入。

称呼：

```
SELECT f_drop_db('mydb'); 
```

成功后您会看到：

> 删除数据库

连接字符串甚至可以指向您的会话运行的同一个数据库。该命令在事务块之外运行，这有两个后果：

*   它无法回滚。
*   它允许您`DROP DATABASE`从函数中“通过代理”调用。

您可以创建 a`FOREIGN DATA WRAPPER`和 a`FOREIGN SERVER`来存储连接并简化调用：

```
CREATE FOREIGN DATA WRAPPER postgresql VALIDATOR postgresql_fdw_validator;

CREATE SERVER your_fdw_name_here FOREIGN DATA WRAPPER postgresql
OPTIONS (hostaddr '12.34.56.78', port '5432', dbname 'postgres'); 
```

使用默认维护 db `postgres`，这将是显而易见的选择。但是任何数据库都是可能的。

使用它的简化功能：

```
CREATE OR REPLACE FUNCTION f_drop_db(text)
  RETURNS text LANGUAGE sql AS
$func$
SELECT dblink_exec('your_fdw_name_here', 'DROP DATABASE ' || quote_ident($1))
$func$; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:27:45.797

您不能从过程中执行此操作，因为`drop database`不能在事务中执行，并且存储过程本身被视为事务。（见[参考](http://www.postgresql.org/docs/current/static/sql-dropdatabase.html)）

那么[dropdb](http://www.postgresql.org/docs/current/static/app-dropdb.html)呢？

# algorithm - 找出重复 2 次或更多次的最长子串

> ID：15256794
> 
> 赞同：-4
> 
> 时间：2013-03-06T19:57:41.097
> 
> 标签：algorithm

我只是想编写逻辑来检查给定字符串的最长子字符串，该字符串重复 2 次或 2 次以上

ex - 字符串 str = aabbcaaaaaaaabbcaaabbccaabddaab

```
 To find out Longest substring which repeated 2 or more times.

      output:  aabbcaa 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T19:59:22.410

为了有效地做到这一点，您应该考虑尝试。

这是[有关使用尝试的教程](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=usingTries)的链接。特别是前缀树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:02:02.903

这是一个简单（但效率低下）的算法：循环所有可能的子字符串长度，从最大值到 1。对于每个长度，将该长度的所有子字符串放入字典中。如果发现重复，请停止。它应该是最大的一个。下面是对应的 C# 代码：

```
public static string FindDuplicateSubstring(string s)
    {
        for (int len = s.Length-1; len > 0; len--) {
            var dict = new Dictionary<string, int>();
            for (int i = 0; i <= s.Length - len; i++) {
                string sub = s.Substring(i, len);
                if (dict.ContainsKey(sub)) return sub;
                else dict[sub] = i;
            }
        }
        return null;
    } 
```

例如，当应用于您的问题文本时，最长的重复子字符串是“实现”。请注意，允许重叠子字符串，即输入“bbbb”返回“bbb”。如果您想排除重叠案例，您的问题并不清楚。有关更快的方法，请参阅我的其他答案。

或者

[好的例子。这里](http://www.experts-exchange.com/Programming/Programming_Languages/C_Sharp/Q_21083206.html)

我必须先对 ArrayList 进行排序，然后将 ontacts[ i ] 与 contacts[ i-1 ] 进行比较

```
contacts.Sort();

for (int i=1; i <= contacts.Count-1; i++)
{
Console.WriteLine(contacts[ i ]);
Console.WriteLine(contacts[ i-1] );
if(contacts[ i ].ToString() == contacts[ i-1 ].ToString())
{
Console.WriteLine("Duplicate: "+contacts[ i ]);
}
} 
```

# python - 函数作为参数传递时是否被评估？

> ID：15256795
> 
> 赞同：1
> 
> 时间：2013-03-06T19:57:44.280
> 
> 标签：python, function, parameter-passing

如果我有这样的代码：

```
def handler(self):
   self.run(self.connect)

def connect(self, param):
   #do stuff...

def run(self, connector):
   self.runner = connector 
```

当我调用 self.run(self.connect) 时首先评估什么？

运行连接中的东西已经完成了吗？或与 self.connect 连接尚未评估？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T20:00:25.670

将函数作为参数传递不会调用它：

```
In [105]: def f1(f):
   .....:     print 'hi'
   .....:     return f
   .....: 

In [106]: def f2():
   .....:     print 'hello'
   .....:     

In [107]: f1(f2)
hi
Out[107]: <function __main__.f2> 
```

当然，如果你将一个函数*调用*传递给另一个函数，你传递的是返回值：

```
In [108]: f1(f2())
hello
hi 
```

注意它们被调用的顺序： `f2`首先被调用，它的返回值被传递给`f1`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T19:59:55.480

您问题中的代码实际上`connect()`都没有调用 ，因此永远不会调用该函数。所做`self.run(self.connect)`的只是`self.runner`使`self.connect`.

# regex - 分隔符集之间的子字符串，反之亦然

> ID：15256796
> 
> 赞同：0
> 
> 时间：2013-03-06T19:57:45.020
> 
> 标签：regex, perl

我使用带有一组分隔符的正则表达式来标记一本书。

```
my $a='A B?C&D"E.F"G,H;I;J/K/L?M:N';
print $a."\n";
my @b=split( /[ ?&".,;\/]/ , $a );
foreach (@b) {  print"|".$_."|,"; } print"\n"; 
```

这已经有效：

```
A B?C&D"E.F"G,H;I;J/K/L?M:N
|A|,|B|,|C|,|D|,|E|,|F|,|G|,|H|,|I|,|J|,|K|,|L|,|M:N|, 
```

但是什么样的正则表达式只会将 $a 中的分隔符返回到标量或列表？

```
my $c = $a =~ REGEXP_I_AM_LOOKING_FOR  --> ' ?&".",;;//?' 
```

任何尽可能简单地做到这一点的提示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:59:40.987

在否定字符类上拆分`[^...]`？

```
my @b=split( /[^ ?&".,;\/]/ , $a ); 
```

或者使用带有`/g`(global) 修饰符的正则表达式

```
my @b = /[ ?&".,;\/]/g; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:59:56.053

```
# ' ', '?', '&', '"', ...
my @seps = $a =~ /([ ?&".,;\/])/g; 
```

或者你可能更喜欢：

```
# 'A', ' ', 'B', '?', 'C', ...
my @both = split /([ ?&".,;\/])/, $a; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:10:12.273

另一种不使用单行正则表达式的方法。

```
my @delimiters = ();
while($a =~ /([ ?&\"\.\,\;\/])/g) {
  push(@delimiters, $1);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T22:10:13.113

将分隔符保存在字符串中。

```
my $input = 'A B?C&D"E.F"G,H;I;J/K/L?M:N';
my $delimiters = ' ?&".",;;//?';

my @found_fields = split( /[$delimiters]/, $input );
print "|$_|," foreach (@found_fields); 
```

现在您可以通过使用否定字符类来获取字符串中看到的分隔符，就是这样`[^...]`

```
my @found_delimiters = split( /[^$delimiters]/, $input );
print "|$_|," foreach (@found_delimiters); 
```

# c# - 我怎样才能得到谓词 Lambda 表达式的值？

> ID：15256799
> 
> 赞同：0
> 
> 时间：2013-03-06T19:57:53.767
> 
> 标签：c#, .net

我有以下方法：

```
private List<T> GetEntities<T>(T entity) {
    // ...
} 
```

和

```
public virtual List<T> Find<T>(Predicate<T> match) {
    // ...
} 
```

如何获取 lambda 表达式中的值`Predicate<T>`？

我想做类似的事情：

```
var result = Find<MyObject>(o => o.Name == "Something") 
```

在`Find`方法中我会：

```
public virtual List<T> Find<T>(Predicate<T> match) {
    // ...
    string name = myObj.Name  // equals to "Something"        
    return GetEntities<T>(myObj) //Note that here is my object with the parameters passed via lambda
    // ...
} 
```

我怎样才能做到这一点？

**编辑：**已经有一个接收 MyObject 的方法，**我只想要一个可以使用 lambda 表达式的方法，而不需要实例化一个对象来过滤一个实体**。不知道我是使用 Func 还是 Predicate

**编辑2：**根据要求，这是我将实现的具体示例：

目前，当我想检索具有特定过滤器的对象时，我使用：

```
Person p = new Person() { Name = "John" };
var result = GetEntities<Person>(p); 
```

我喜欢做什么：

```
var result = Find<Person>(p => p.Name = "John"); 
```

**但是**，内部想继续使用以前的方法，我只是将表达式变成一个对象，然后使用`GetEntities<Person>(p)`

**结论：** 我对谓词和 Func 做了很多混淆。我以为我可以将它们视为对象，但它们是表达式，我的问题完全脱离了这些元素的概念。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T22:25:28.190

From the signature and usage, following code is what I inferred for you. It compiles, however, **it's incorrect for use**.

*   Classes

    ```
    public partial class MyObject {
        public String Name;
    }

    public partial class MyGeneric<U> where U: MyObject {
        private List<T> GetEntities<T>(T entity) where T: U {
            throw new NotImplementedException(); // not implemented yet
        }

        public virtual List<T> Find<T>(Predicate<T> match) where T: U {
            foreach(var myObj in m_List)
                if(match(myObj as T)) {
                    // ...
                    var name=myObj.Name;
                    // ...
                    return this.GetEntities(myObj as T);
                }

            return new List<T>();
        }

        List<U> m_List;
    } 
    ```

*   Test

    ```
    var myGeneric=new MyGeneric<MyObject>();
    var result=myGeneric.Find<MyObject>(o => o.Name=="Something"); 
    ```

Here're something I'd like to tell:

1.  You might misunderstood of generic.

    As you see the class `MyGeneric` and those two method, all have constraints. From the usage of your code, almost cannot go without these constraints, but this is just unnecessarily complicated.

2.  You might misunderstood of `Predicate<T>` and also lambda expressions

    The definition of `Predicate<T>` is

    ```
    public delegate bool Predicate<T>(T obj); 
    ```

    That is, it's a delegate. `obj` is the argument *pass to* the delegate. Therefore you cannot get `obj` with a different context. However, you can do something like

    ```
    MyObject x;
    var myGeneric=new MyGeneric<MyObject>();
    var result=myGeneric.Find<MyObject>(o => (x=o).Name=="Something"); 
    ```

    Here `x` references to `o`, but with your `Find` method, it's not possibly to do. So the object pass to the `Predicate<T>`, must already be somewhere you can access it, otherwise you can never.

I post with the code that demonstrates what the compilable syntax of statement that you can do, and even possibly works. But I **STRONGLY** suggest that **DON'T** do something like this.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:31:29.213

如果我正确理解您的问题，您的第二种方法应该是这样的：

```
public virtual List<T> Find<T>(Expression<Predicate<T>> match)
{
    return _myCollection.Where(match).ToList();
} 
```

然后，您可以将 lambda 表达式传递给该方法并返回匹配列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T21:28:23.553

在您的示例中，这将是正确的：

```
public virtual List<T> Find(T myObj)
{
    return GetEntities(myObj);
} 
```

`Func<T, bool>`只有当您想从 IEnumerable 中过滤项目并且您的问题中没有任何 IEnumerable 时，您才需要传递谓词 ( )。如果你有 IEnumerable 那么：

```
private IEnumerable<T> _list;
public virtual List<T> Find(Func<T, bool> predicate)
{
    T myObj = _list.FirstOrDefault(predicate);
    return GetEntities(myObj);
} 
```

扩展一下，你`o => o.Name == "Something"`的相当于：

```
private bool Filter(MyObject enumeratedObject)
{
    return enumeratedObject.Name == "Something";
} 
```

在枚举发生并开始为列表的每个元素调用 Filter(...) 之前，它不包含任何值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T20:47:54.543

尝试这个

```
public virtual List<T> Find<T>(Func<T,bool> match)
{
   return lst.Where(match).ToList();
} 
```

# android - 如何为 IME 设置背景图片？

> ID：15256802
> 
> 赞同：2
> 
> 时间：2013-03-06T19:58:03.447
> 
> 标签：android, background, ime, android-keypad

我想知道如何在按键后面显示图像。我试过这样：

```
<ImageView android:id="@+id/imageView1" 
    android:layout_height="wrap_content" 
    android:layout_width="wrap_content" 
    android:layout_centerHorizontal="true"
    android:layout_marginTop="50px"
    android:padding="12dip"
    android:background="#FFFFFF">
</ImageView>

<Keyboard xmlns:android="http://schemas.android.com/apk/res/android"
    android:keyWidth="10%p"
    android:horizontalGap="0px"
    android:verticalGap="0px"
    android:keyHeight="50%p" >

    <Row>
        <Key android:codes="113" 
            android:keyEdgeFlags="left" />
    </Row>

</Keyboard> 
```

我知道缺少一些基本的东西，比如钥匙上的图像（以及至少 25 个其他钥匙），但我只是想给你看一个例子。

TL;DR（虽然这不是一篇很长的帖子）：我想在背景中有一个图像，在前景中有一个常用的键盘。

提前致谢 ：）

更新：我现在试过了：

```
<Keyboard xmlns:android="http://schemas.android.com/apk/res/android"
    android:keyWidth="1%p"
    android:horizontalGap="20px"
    android:verticalGap="300px"
    android:keyHeight="1%p"
    android:background="@drawable/example" 
    >

    <Row>
        <Key android:codes="113" 
            android:keyEdgeFlags="left"></Key>
        <Key android:codes="113" 
            android:keyEdgeFlags="left"></Key>

    </Row>
    <Row>
        <Key android:codes="113" 
            android:keyEdgeFlags="left"></Key>
        <Key android:codes="113" 
            android:keyEdgeFlags="left"></Key>
    </Row>

</Keyboard> 
```

没用 :( xml 设置正确，因为它显示某种键盘，但背景只是黑色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:57:03.700

你可以使用一个[`KeyboardView`](http://developer.android.com/reference/android/inputmethodservice/KeyboardView.html)对象。它 extends `View`，所以你可以使用常规`android:background`属性来做你所追求的。然后，附上你`Keyboard`的`setKeyboard()`.

# ms-access - 使用派生字段

> ID：15256805
> 
> 赞同：1
> 
> 时间：2013-03-06T19:58:07.047
> 
> 标签：ms-access, calculated-columns

我有两张桌子。一个是 InvoiceHeader，另一个是 InvoiceDetails。我在 InvoiceHeader 中有一个名为 total 的字段，我想从 InvoiceDetails 表中计算与该 InvoiceID 关联的所有成本。

我能做的最简单的方法是什么？

我也在研究 Access。如果您有任何问题，请询问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:35:38.513

假设成本值存储在名为`cost`in的数字字段中`InvoiceDetails`，并且`InvoiceID`也是两个表中的数字字段...

```
SELECT
    ih.*,
    DSum("cost", "InvoiceDetails", "InvoiceID = " & ih.InvoiceID)
        As total_cost
FROM InvoiceHeader AS ih; 
```

或者您可以使用聚合查询来计算每个的总数`InvoiceID`并将其连接到`InvoiceHeader`.

```
SELECT ih.*, sub.total_cost
FROM
    InvoiceHeader AS ih
    INNER JOIN
    (
        SELECT InvoiceID, Sum(cost) AS total_cost
        FROM InvoiceDetails
        GROUP BY InvoiceID
    ) AS sub
    ON ih.InvoiceID = sub.InvoiceID; 
```

如果您的表足够大，可以注意到这两种方法之间的速度差异，我猜第二种方法会更快。无论您选择哪一个，都会极大地受益于`InvoiceDetails.InvoiceID`.

# hadoop - 使用 hadoop 流解压缩文件

> ID：15256808
> 
> 赞同：4
> 
> 时间：2013-03-06T19:58:18.143
> 
> 标签：hadoop, zip, hadoop-streaming

我在 HDFS 中有很多文件，它们都是一个 zip 文件，里面有一个 CSV 文件。我正在尝试解压缩文件，以便可以在它们上运行流式传输作业。

我试过了：

```
hadoop jar /usr/lib/hadoop-mapreduce/hadoop-streaming.jar \
    -D mapred.reduce.tasks=0 \
    -mapper /bin/zcat -reducer /bin/cat \
    -input /path/to/files/ \
    -output /path/to/output 
```

但是我收到一个错误（`subprocess failed with code 1`）我也尝试在单个文件上运行，同样的错误。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-30T16:42:11.450

问题的根本原因是：您从 hadoop 获得了许多（文本）信息（在您接收数据之前）。

例如 hdfs dfs -cat hdfs://hdm1.gphd.local:8020/hive/gphd/warehouse/my.db/my/part-m-00000.gz | 猫猫 | wc -l 也不起作用 - 带有“gzip：stdin：不是 gzip 格式”错误消息。

因此，您应该跳过这个“不必要的”信息。就我而言，我必须跳过 86 行

因此我的一行命令将是这样的（用于计算记录）： hdfs dfs -cat hdfs://hdm1.gphd.local:8020/hive/gphd/warehouse/my.db/my/part-m-00000.gz |尾-n+86 | 猫猫 | wc -l

注意：这是一种解决方法（不是真正的解决方案）并且非常丑陋 - 因为“86” - 但它工作正常:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-29T16:13:17.383

无论出于何种原因，在 HDFS 中解压缩/解压缩文件的简单方法

```
hadoop fs -text /hdfs-path-to-zipped-file.gz | hadoop fs -put - /hdfs-path-to-unzipped-file.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-28T10:35:04.553

经过试验，我发现如果您对 hadoop 流进行此修改，您将在一个新目录中解压缩所有 gzip 文件。文件名全部丢失（重命名为典型的部分 XXXX 名称），但这对我有用。

我推测这是可行的，因为 hadoop 在后台自动解压缩 gzip 文件，而 cat 只是在回显解压缩的输出

```
hadoop jar /usr/iop/4.2.0.0/hadoop-mapreduce/hadoop-streaming.jar \
    -D mapred.reduce.tasks=0 \
    -mapper /bin/cat \
    -input  /path-to-gzip-files-directory \
    -output /your-gunzipped-directory 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-08-24T23:25:54.427

Hadoop 可以读取以 gzip 格式压缩的文件，但这与 zip 格式不同。Hadoop 无法读取 zip 文件 AFAIK。

# r - 控制百分比轴并将值添加到 HH 李克特图

> ID：15256810
> 
> 赞同：0
> 
> 时间：2013-03-06T19:58:27.593
> 
> 标签：r, graphics, plot, lattice, survey

考虑以下最小示例：

```
tab = structure(c(187, 189, 205, 167, 273, 275, 295, 231, 385, 575, 
409, 363, 899, 707, 751, 667, 2007, 1953, 2101, 2531, 1043, 1023, 
1071, 971, 385, 575, 409, 363, 181, 241, 157, 163, 123, 163, 
133, 131), .Dim = c(4L, 9L), .Dimnames = list(NULL, c("-4", "-3", 
"-2", "-1", "0", "1", "2", "3", "4"))) 
```

该矩阵`tab`包含 9 点李克特量表的计数。

一个基本的情节很容易产生：

```
 likert(tab,
           auto.key=list(between=0.5, between.columns=1),
           main="Attitudes",
           BrewerPaletteName="RdBu",as.percent=TRUE, rightAxisLabels=NULL, 
           rightAxis=NULL, ylab.right="") 
```

它看起来不错。现在，问题：

*   我想控制百分比轴的增量。在某些情况下，加上其他计数，它只显示 50%。我想强制执行 10% 的增量
*   我想将 % 计数添加为标签。最重要的是 0 类。就像在 Excel 中一样，您可以右键单击并说“添加数据标签”。一定有类似的东西。

我也考虑过ggplot，但是，它不支持发散图。加上标签也相当混乱，尤其是对于 tikz 导出。

**编辑** 我尝试过使用 panel.text。但是，我仍然没有正确排列数字。

```
#does not work right!
trellis.focus("toplevel")
for(pp in 1:nrow(tab)){
panel.text(0.5, (pp/nrow(tab))*0.84+0.16, tab[pp,5], cex = 1, font = 2)
}
trellis.unfocus() 
```

如何在每个条形图中找到正确的位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:07:32.093

要更改`x`轴值，您应该添加参数`scales=`并为轴添加`at=`参数`x`。

```
likert(tab,
       auto.key=list(between=0.5, between.columns=1),
       main="Attitudes",
       BrewerPaletteName="RdBu",as.percent=TRUE, rightAxisLabels=NULL, 
       rightAxis=NULL, ylab.right="",
       scales=list(
         x=list(
           at=seq(-50,50,10)))) 
```

# entity-framework - 从 NHibernate 转换为实体框架检查实例的类型

> ID：15256813
> 
> 赞同：1
> 
> 时间：2013-03-06T19:58:36.197
> 
> 标签：entity-framework, fluent-nhibernate, structuremap

我正在与之合作的团队的任务是将 MVC 4 应用程序从使用 FluentNHibernate 转换为使用 Entity Framework 5。

该项目使用 StructureMap 进行依赖注入。目前国际奥委会是这样的：

```
ForSingletonOf<ISessionFactory>().Use(SessionConfiguration.get_session_factory);

For<ISession>()
    .HttpContextScoped()
    .Use(ctx => ctx.GetInstance<ISessionFactory>().OpenSession())
    .EnrichWith((ISession session) => new TransactionManagementSessionDecorator(session)); 
```

该项目包含一些对象扩展，其中之一是：

```
public static bool is_instance_of<T>(this object instance)
{
    if (instance is INHibernateProxy)
        return ObjectFactory.GetInstance<ISession>().GetSessionImplementation().PersistenceContext.Unproxy(instance) is T;

    return instance is T;
} 
```

例如，上面的扩展名将像这样使用：

```
CartItemType get_cart_item_type(Registration registration)
{
    if (registration.is_instance_of<FirstTimeRegistration>())
        return CartItemType.FirstTime;

    if (registration.is_instance_of<ReplacementRegistration>())
        return CartItemType.Replacement;

    if (registration.is_instance_of<RenewalRegistration>())
        return CartItemType.Renewal;
               ...
               ...

    throw new ArgumentException("Registration Type is unknown");
} 
```

FirstTimeRegistration、ReplacementRegistration 和 RenewalRegistration 类都继承了 Registration 类。

以下已添加到我们的 IOC 以转换为 EF：

```
For<RegistrationContext>()
    .HttpContextScoped()
    .Use(x => new RegistrationContext());

For(typeof(IEFRepository<>)).Use(typeof(EFRepository<>)); 
```

我似乎遇到的问题是弄清楚如何更改 is_instance_of<> 扩展以与实体框架一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:42:15.253

你可能在这里遇到了麻烦。NHibernate 支持很多 Entity Framework 5（甚至 6）不支持的东西。我也很惊讶，但经过一番[研究](http://www.dennisdoomen.net/2013/03/entity-framework-56-vs-nhibernate-3.html)，我很确定你有一个不可能完成的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:15:00.457

在这里只是从臀部拍摄（我对NHibernate不太了解），使用框架中的Type.IsInstanceOfType（）怎么样[（参考msdn）](http://msdn.microsoft.com/en-gb/library/system.type.isinstanceoftype.aspx)？

所以你的代码看起来像

```
CartItemType get_cart_item_type(Registration registration)
{
    if (typeof(FirstTimeRegistration).IsInstanceOfType(registration))
    return CartItemType.FirstTime;

    if (typeof(ReplacementRegistration).IsInstanceOfType(registration))
    return CartItemType.Replacement;

    if (typeof(RenewalRegistration).IsInstanceOfType(registration))
    return CartItemType.Renewal;
           ...
           ...

    throw new ArgumentException("Registration Type is unknown");
} 
```

表情看起来有些倒退，但是……

# php - 检测用户是否登录

> ID：15256816
> 
> 赞同：0
> 
> 时间：2013-03-06T19:58:51.917
> 
> 标签：php, wordpress

这是 WordPress 上下文中的一个 php 问题。我需要该`join`按钮仅显示该`(is_user_logged_in())`值是否为假。

这是我当前的代码：

```
<div align="right"><a href="www.google.com" class="join-button">Join</a>
 |<?php wp_loginout(); ?></div> 
```

我想修改此代码以遵循此逻辑：

```
if user is logged in = false
    display join button 'class="join-button"
else
    do not display join button 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-30T15:34:28.977

这对我也不起作用。我在[codex](http://codex.wordpress.org/Function_Reference/is_user_logged_in)中找到了解决方案。

```
<?php
    if ( is_user_logged_in() ) {
        echo 'Welcome, registered user!';
    } else {
        echo 'Welcome, visitor!';
    }
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:01:52.830

```
<?php if( ! is_user_logged_in()): ?>
show button
<?php endif; ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T20:01:58.060

[http://codex.wordpress.org/Function_Reference/is_user_logged_in](http://codex.wordpress.org/Function_Reference/is_user_logged_in)

```
<div align="right">
<?php if ( !is_user_logged_in() ): ?>
    <a href="www.google.com" class="join-button">Join</a>
    |
<?php endif; ?>
<?php wp_loginout(); ?>
</div> 
```

**编辑** 因为评论;）

# android - Android 媒体播放器流媒体 - 在模拟器中工作，在硬件上失败

> ID：15256818
> 
> 赞同：2
> 
> 时间：2013-03-06T19:58:52.767
> 
> 标签：android, media-player, emulation, hardware

我面临一个与 Android、流媒体和媒体播放器相关的奇怪问题。

实际的应用程序相当复杂，但我提出了最简单的测试用例：“Hello, World”活动启动带有硬编码 URL 的媒体播放器。这在 Android 模拟器中运行良好，API 级别 7（这是真实应用程序的最低级别）和 API 级别 17。但是，同一个应用程序在 API 级别 15 的硬件设备上失败 - 媒体播放器在 prepare() 调用期间失败：

*   如果使用阻塞 prepare()，它会因 IOException 而失败
*   如果使用非阻塞 prepareAsync()，它将失败并触发 onErrorListener（不引发异常）。

失败总是（阻塞和非阻塞准备）显示“错误（1，-2147483648）”。媒体播放器文档没有这样的错误代码 -2147483648 (0xffffffff)。

该应用程序具有访问 Internet (android.permission.INTERNET) 的适当权限，并且设备的 Internet 连接正常（同一应用程序可以从 Internet 下载文件）。

这不是编解码器问题 - 因为模拟器可以播放相同的流，并且因为任何其他流在硬件设备上以相同的方式失败。

尝试了许多其他没有帮助的事情：

*   使用 pepareAsync() 和 onPreparedListener 调用 start()
*   在媒体播放器上调用 reset()
*   通过 Uri.parse() 设置数据源
*   从音频管理器获取音频焦点

硬件工作正常，因为同一设备可以使用 Android 内置的默认音频播放器应用程序从其存储中播放音频文件。

我不太相信鬼魂，但我已经没有其他选择了。有人见过这样的吗？该应用程序可以在模拟器中运行，但不能在硬件上运行？

任何人都可以在硬件设备上尝试此代码（我只有 1 个 Android 设备）吗？

```
public class MainActivity extends Activity {

private MediaPlayer mediaPlayer;
private String listen_url = "http://stream15.top-ix.org:80/radiojukebox-low";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mediaPlayer = new MediaPlayer();
    //mediaPlayer.reset();

    try {
        mediaPlayer.setDataSource(listen_url);
        //mediaPlayer.setDataSource(this, Uri.parse(listen_url));
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (SecurityException e) {
        e.printStackTrace();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        mediaPlayer.prepare();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
                    // We fail here!
        e.printStackTrace();
    }

    mediaPlayer.start();
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:22:19.580

这通常是因为您使用的设备不支持流类型。您尝试过简单的 MP3 流吗？

# iphone - iOS 6.1.2 收据验证

> ID：15256819
> 
> 赞同：0
> 
> 时间：2013-03-06T19:58:53.743
> 
> 标签：iphone, ios, in-app-purchase, verification, receipt

我的一些客户抱怨在购买带有 iOS 6.1.2 的产品时出现错误。收据验证（苹果代码）未通过以下测试：

```
 NSString *localIdentifier                   = [[[UIDevice currentDevice] identifierForVendor] UUIDString];
    NSString *purchaseInfoUniqueVendorId        = [purchaseInfoFromTransaction objectForKey:@"unique-vendor-identifier"];
    NSString *verifiedReceiptVendorIdentifier   = [verifiedReceiptReceiptDictionary objectForKey:@"unique_vendor_identifier"];

    if(verifiedReceiptVendorIdentifier)
    {
        if (![purchaseInfoUniqueVendorId isEqualToString:verifiedReceiptVendorIdentifier]
            || ![purchaseInfoUniqueVendorId isEqualToString:localIdentifier])
        {
            // Comment this line out to test in the Simulator.
            [self error:@"verified/local problem"];

            failCount++;
        }
    } 
```

其他人是否也遇到此问题？

# c# - 如何在c#中的所有文件之间使用方法？

> ID：15256823
> 
> 赞同：0
> 
> 时间：2013-03-06T19:58:58.713
> 
> 标签：c#, visual-studio-2010, extension-methods

所以我试图在我的 C# 项目中的所有文件中使用一个简单的日志记录功能。(visual studio 2010) 我在 vb.net 中制作了这个项目，现在我正在尝试重写它并在 c# 中清理它。我也是 C# 的新手，所以提前道歉。

在 vb.net 中非常简单：

*   创建一个 .vb 文件
*   把它放在项目的libraries文件夹中
*   然后在任何你想在库文件中使用方法的文件中，在顶部放置“Imports”。

太棒了，只有 c# 似乎不允许这样做。我试过“使用”。但智能感知只允许我将“使用 .Library”放在库是类所在文件夹的名称的位置。

经过一些谷歌搜索和研究后，似乎 C# 不允许使用全局方法，我认为这通常是一种不鼓励的做法。

记录方法具有要写入哪个文件以及要附加的消息是什么的输入参数。它不是很长，但我觉得在我想使用它的每个类中重新编写代码是一种浪费。

我可以在使用它的类中创建所说的 utils 类的实例，但我不需要在 vb.net 中这样做。（只需导入，然后该方法就可以使用）

那么我只是在这里分裂头发还是有一种我没有看到或不知道的简单方法来做到这一点？

谢谢！

编辑：应要求添加的代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;

namespace ProjectProgram.Library
{
    public class ApplicationUtilities
    {

    public string homeLogPath = System.Environment.ExpandEnvironmentVariables("%SystemRoot%\\System32\\folderName\\Logs");

    public void toLogFile(string LogName, string logEntry)
    {

        string LogFile = homeLogPath + "\\" + LogName;
        if (!File.Exists(LogFile))
        {
            File.WriteAllText(LogFile, string.Empty, Encoding.UTF8);
        }

        File.AppendAllText(LogFile, DateTime.Now + " " + logEntry + "\n");

    }

}
} 
```

这是我想在另一个类中使用的代码。如何从另一个类调用 toLogFile 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:11:31.813

制作您的日志记录类及其方法`public static`，并将其包含在您要使用的所有文件中。然后你可以简单地通过做类似的事情来访问它

```
 Logger.WriteLine("log message"); 
```

或者只是使用像 Log4Net [http://logging.apache.org/log4net/这样的库](http://logging.apache.org/log4net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:08:51.760

您的实用程序类应类似于：

```
namespace Code.Utilities{
    public class MyUtilities{

        public static void LogString(string input){
            //Do something
        }
    }
} 
```

然后任何其他想要使用 LogString() 的类将类似于：

```
using Code.Utilities;    

namespace SomeSpace{
     public class SomeClass{
         public void F(string input){
             MyUtilities.LogString(input);
         }
     }    
} 
```

# json - AS3 将嵌套数组转换为 JSON 对象

> ID：15256824
> 
> 赞同：1
> 
> 时间：2013-03-06T19:59:02.497
> 
> 标签：json, actionscript-3

有本机 JSON.stringify 方法，但这不是我需要的

我需要转换以下

```
[['user1',150],['user2',270],['user3',500]] 
```

到正确的 JSON 对象

```
{"user1" : 150,
"user2" : 270,
"user3" : 500
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:11:37.907

好的回答我自己的问题

```
var jsonOb={}

var L:int=testArray.length;

for(var i:int=0;i<L;i++){

    jsonOb[testArray[i][0]]=testArray[i][1]

}

trace('jsonOb=='+jsonOb+ ' and JSON.stringify(jsonOb) = '+JSON.stringify(jsonOb)); 
```

# java-me - （J2ME 应用程序）从 WAP 下载 JAD 时不支持文件

> ID：15256825
> 
> 赞同：0
> 
> 时间：2013-03-06T19:59:04.163
> 
> 标签：java-me, download, installation, wap, jad

我使用 Tracfone T301G 进行测试，每次尝试下载 WAP 服务器中的任何文件甚至图像文件时，都会弹出不支持文件的消息。

我又尝试了大约 5 个应用程序、JPG 文件和 PNG 文件。没有任何效果。

请告诉我在提交之前我可以做些什么来在电话上测试我的申请。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T10:12:42.303

有些手机在文件下载和 OTA 安装方面非常挑剔。对于这些电话，具有 .jad 扩展名的文件不足以让电话接受它作为实际的 jad 文件。在接受文件扩展名之前，他们需要正确的 mime 类型。

因此，您必须添加/编辑服务器设置，为您能够下载/安装的文件类型添加 mime 类型。

以下是 mime 类型的一些示例：

```
.jar application/java-archive
.jad text/vnd.sun.j2me.app-descriptor
.mmf application/vnd.smaf
.nth application/vnd.nok-s40theme
.png image/png
.class application/java-vm 
```

# c - 无法在分叉的进程中设置 OpenMP 线程关联

> ID：15256826
> 
> 赞同：1
> 
> 时间：2013-03-06T19:59:06.443
> 
> 标签：c, linux, fork, openmp, libgomp

我正在尝试使用 openMP 在不同的 CPU 上运行两个进程。在这种情况下，每个 CPU 有 6 个带有超线程的内核（因此有 12 个硬件线程）。他们需要做一些同步，如果他们知道彼此的 PID，这似乎更容易一些。所以我`sigC`从`sigS`使用 a开始一个过程，`fork()`并`execve()`为`GOMP_CPU_AFFINITY`环境变量使用不同的值。`fork()/execve()`调用后，`sigS`仍然有正确的亲和力但`sigC`打印

```
libgomp: no cpus left for affinity setting 
```

并且所有线程都在同一个核心上。

的代码`sigS`：

```
#define _GNU_SOURCE
#include <stdio.h>
#include <unistd.h>
#include <errno.h>
#include <omp.h>
#include <sched.h>

int main( void )
{
   omp_set_num_threads(12); //12 hardware threads per CPU
   //this loop runs as expected
   #pragma omp parallel for
   for( int i = 0; i<12; i++ ) {
      #pragma omp critical 
      {
         printf("TEST PRE-FORK: I am thread %2d running on core %d\n",
                omp_get_thread_num(), sched_getcpu());
      }
   }

   pid_t childpid = fork();

   if( childpid < 0 ) {
      perror("Fork failed");
   } else {
      if( childpid == 0 ) { //<------ attempt to set affinity for child
         //change the affinity for the other process so it runs
         //on the other cpu
         char ompEnv[] = "GOMP_CPU_AFFINITY=6-11 18-23"; 
         char * const args[]    = { "./sigC", (char*)0 };
         char * const envArgs[] = { ompEnv,   (char*)0 };
         execve(args[0], args, envArgs);
         perror("Returned from execve");
         exit(1);
      } else {
         omp_set_num_threads(12);
         printf("PARENT: my pid     = %d\n", getpid());
         printf("PARENT: child pid  = %d\n", childpid);
         sleep(5); //sleep for a bit so child process prints first

         //This loop gives the same thread core/pairings as above
         //this is expected
         #pragma omp parallel for
         for( int i = 0; i < 12; i++ ) {
            #pragma omp critical
            {
               printf("PARENT: I'm thread %2d, on core %d.\n",
                      omp_get_thread_num(), sched_getcpu());
            }
         }
      }
   }
   return 0;
} 
```

的代码中`sigC`只有一个 omp 并行 for 循环，但为了完整性：

```
#define _GNU_SOURCE
#include <stdio.h>
#include <unistd.h>
#include <errno.h>
#include <omp.h>
#include <sched.h>

int main( void )
{
   omp_set_num_threads(12);
   printf("CHILD: my pid     = %d\n", getpid());
   printf("CHILD: parent pid = %d\n", getppid());
   //I expect this loop to have the core pairings as I specified in execve
   //i.e thread 0 -> core 6, 1 -> 7, ... 6 -> 18, 7 -> 19 ... 11 -> 23
   #pragma omp parallel for
   for( int i = 0; i < 12; i++ ) {
      #pragma omp critical
      {
         printf("CHILD: I'm thread %2d, on core %d.\n",
                omp_get_thread_num(), sched_getcpu());
      }
   }
   return 0;
} 
```

输出：

```
$ env GOMP_CPU_AFFINITY="0-5 12-17" ./sigS 
```

这部分符合预期

```
TEST PRE-FORK: I'm thread  0, on core 0.
TEST PRE-FORK: I'm thread 11, on core 17.
TEST PRE-FORK: I'm thread  5, on core 5.
TEST PRE-FORK: I'm thread  6, on core 12.
TEST PRE-FORK: I'm thread  3, on core 3.
TEST PRE-FORK: I'm thread  1, on core 1.
TEST PRE-FORK: I'm thread  8, on core 14.
TEST PRE-FORK: I'm thread 10, on core 16.
TEST PRE-FORK: I'm thread  7, on core 13.
TEST PRE-FORK: I'm thread  2, on core 2.
TEST PRE-FORK: I'm thread  4, on core 4.
TEST PRE-FORK: I'm thread  9, on core 15.
PARENT: my pid     = 11009
PARENT: child pid  = 11021 
```

这就是问题所在 - 子进程中的所有线程都在核心 0 上运行

```
libgomp: no CPUs left for affinity setting
CHILD: my pid     = 11021
CHILD: parent pid = 11009
CHILD: I'm thread  1, on core 0.
CHILD: I'm thread  0, on core 0.
CHILD: I'm thread  4, on core 0.
CHILD: I'm thread  5, on core 0.
CHILD: I'm thread  6, on core 0.
CHILD: I'm thread  7, on core 0.
CHILD: I'm thread  8, on core 0.
CHILD: I'm thread  9, on core 0.
CHILD: I'm thread 10, on core 0.
CHILD: I'm thread 11, on core 0.
CHILD: I'm thread  3, on core 0. 
```

（我省略了父线程打印，因为它与 pre-fork 相同）

关于如何解决这个问题或者它是否是正确的方法的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T21:22:18.680

-ed`fork()`子进程继承其父关联掩码。`libgomp`将此关联掩码与集合 from 相交`GOMP_CPU_AFFINITY`并以空集合结束，因为这两个集合是互补的。这种行为没有记录，但查看源代码可以`libgomp`确认确实如此。

`execve()`解决方案是在调用之前重置子进程的关联掩码：

```
if (childpid == 0) { //<------ attempt to set affinity for child
   cpu_set_t *mask;
   size_t size;
   int nrcpus = 256; // 256 CPUs should be more than enough

   // Reset the CPU affinity mask
   mask = CPU_ALLOC(nrcpus);
   size = CPU_ALLOC_SIZE(nrcpus);
   for (int i = 0; i < nrcpus; i++)
      CPU_SET_S(i, size, mask);
   if (sched_setaffinity(0, size, mask) == -1) { handle error }
   CPU_FREE(mask);

   //change the affinity for the other process so it runs
   //on the other cpu
   char ompEnv[] ="GOMP_CPU_AFFINITY=6-11 18-23"; 
   char * const args[]    = {"./sigC", (char*)0};
   char * const envArgs[] = {ompEnv,   (char*)0};
   execve(args[0], args, envArgs);
   perror("Returned from execve");
   exit(1);
} else { 
```

# c++ - 在不使用解决方案的情况下使用 Visual Studio 2010

> ID：15256840
> 
> 赞同：2
> 
> 时间：2013-03-06T19:59:46.843
> 
> 标签：c++, visual-studio-2010, intellisense, vi

我发现自己为一个拥有非常大的 C++ 代码库的团队工作，该团队不使用 Visual Studio 接受作为编译器。我们正在使用 make 文件。如果没有诸如智能感知、去定义和重构之类的视觉工作室高级功能，我感觉完全瘫痪了。有没有什么好的技巧可以让 Visual Studio 2010 在没有项目和解决方案的情况下拥有这些功能？或者，有没有好的面向 VI 的替代方案？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T21:45:20.713

鉴于文件不必与解决方案位于同一目录中，您可以做的是在完全不同的文件夹中创建解决方案，并从其位置包含您想要的文件。这会将您的 C++ 代码与您的解决方案分开。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T20:05:16.977

我不确定这是可能的。

但是，我真的很喜欢在 c++/c 开发中使用 code::block ( [http://www.codeblocks.org/](http://www.codeblocks.org/) )。有自动完成和其他类似于 VisualStudio 的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T21:53:11.510

我不认为您可以删除解决方案的概念，但您可以创建一个 makefile 项目，它允许您指定用于构建/清理项目的命令行。

在我的工作中，我们所有的代码都是在 linux（驱动程序）中构建的，但我在 VS2010 中使用 SAMBA 来访问文件和 pterm（putty 的一部分）来发送构建命令。

# c - 为什么这个 perror 的输出？

> ID：15256841
> 
> 赞同：0
> 
> 时间：2013-03-06T19:59:51.690
> 
> 标签：c, linux, gcc, clang, cc

我以前从未见过：

![在此处输入图像描述](../Images/4fe175e37d4f7919c005ce8d42c7d6d4.png)

上面的左下角是什么？该程序的最新版本是

```
#include <stdio.h>
#include <stdlib.h> 
int main(int argc, char **argv)
{
   int ch;
   char file_name[25] = "/proc/scsi/scsi";
   FILE *fp; 
   fp = fopen(file_name,"r"); // read mode 
   if (fp == NULL)
   {
      perror(file_name);
      exit(EXIT_FAILURE);
   } 
   printf("The contents of %s file are :\n", file_name); 
   while ((ch = fgetc(fp)) != EOF)
      putchar(ch); 
   fclose(fp);
   return 0;
} 
```

测试

```
$ cc driveinfo.c;./a.out 
The contents of /proc/scsi/scsi file are :
Attached devices:
Host: scsi0 Channel: 00 Id: 00 Lun: 00
  Vendor: ATA      Model: WDC WD2500JS-75N Rev: 10.0
  Type:   Direct-Access                    ANSI  SCSI revision: 05
Host: scsi1 Channel: 00 Id: 00 Lun: 00
  Vendor: ATA      Model: ST3250824AS      Rev: 3.AD
  Type:   Direct-Access                    ANSI  SCSI revision: 05
Host: scsi2 Channel: 00 Id: 00 Lun: 00
  Vendor: TSSTcorp Model: DVD+-RW TS-H653A Rev: D300
  Type:   CD-ROM                           ANSI  SCSI revision: 05
Host: scsi3 Channel: 00 Id: 00 Lun: 00
  Vendor: Optiarc  Model: DVD-ROM DDU1681S Rev: 102A
  Type:   CD-ROM                           ANSI  SCSI revision: 05
Host: scsi4 Channel: 00 Id: 00 Lun: 00
  Vendor: Lexar    Model: USB Flash Drive  Rev: 1100
  Type:   Direct-Access                    ANSI  SCSI revision: 00
Host: scsi5 Channel: 00 Id: 00 Lun: 00
  Vendor: WD       Model: 5000AAKB Externa Rev: l108
  Type:   Direct-Access                    ANSI  SCSI revision: 00 
```

以下重现了奇怪的输出：

```
#include <stdio.h>
#include <stdlib.h> 
int main(int argc, char **argv)
{
   int ch;
   char file_name[25] = "/proc/scsi/scsi-notExist";
   FILE *fp; 
   fp = fopen(file_name,"r"); // read mode 
   if (fp == NULL)
   {
      perror(&file_name[25]);
      exit(EXIT_FAILURE);
   } 
   printf("The contents of %s file are :\n", file_name); 
   while ((ch = fgetc(fp)) != EOF)
      putchar(ch); 
   fclose(fp);
   return 0;
} 
```

## 更新

clang 编译器会发出警告，但不会 (g)cc：

```
$ clang -Wconversion cpu-disk-info.c
cpu-disk-info.c:14:15: warning: array index of '25' indexes past the end of an
      array (that contains 16 elements) [-Warray-bounds]
      perror(&file_name[25]);
              ^         ~~
cpu-disk-info.c:6:4: note: array 'file_name' declared here
   char file_name[] = "/proc/scsi/scsi";
   ^
1 warning generated.
dev@dev-OptiPlex-745:~$ gcc -Wconversion cpu-disk-info.c
dev@dev-OptiPlex-745:~$ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:03:20.643

这很可能是由于没有将有效的 const char* 传递给[void perror(const char *s)](http://pubs.opengroup.org/onlinepubs/009696899/functions/perror.html)，这使得输出中的文件名`<filename>: No such file or directory`成为垃圾/不可打印字符。

> perror() 函数应将通过符号 errno 访问的错误号映射到与语言相关的错误消息，该错误消息应写入标准错误流，如下所示：
> 
> **首先（如果 s 不是空指针并且 s 指向的字符不是空字节）， s 指向的字符串后跟冒号和 a 。**
> 
> 然后是一个错误消息字符串，后跟一个 .

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T20:07:33.183

我认为您更正了警告 driveinfo.c:17 或发布您的代码。还可以；）

祝你好运 ！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T20:13:23.520

“varning att scicka heltal utan konvertering ...” 听起来像是对`perror`不是字符串的东西的调用，也许？

如果您发布代码，我们可能会看得更清楚，但我很确定警告和输出是相关的。

编辑：如果您传递`filename[25]`给该函数，我希望收到此警告。如果您通过`&filename[25]`，那么您可能传递的东西根本不是字符串，因此会打印一些随机字节，这几乎可以打印任何东西。

# c# - 检查像素的颜色是否是预定义的系统颜色？

> ID：15256846
> 
> 赞同：0
> 
> 时间：2013-03-06T20:00:00.830
> 
> 标签：c#, bitmap, getpixel

在以下代码中：

```
 Bitmap bmp = new Bitmap((int)ArrayHeight, (int)ArrayWidth, System.Drawing.Imaging.PixelFormat.Format32bppArgb);
    Graphics gBmp = Graphics.FromImage(bmp);
    gBmp.CompositingMode = CompositingMode.SourceCopy;
    System.Drawing.Color green = System.Drawing.Color.FromArgb(0x40, 0, 0xff, 0);
    System.Drawing.Brush greenBrush = new SolidBrush(green);
    gBmp.FillPolygon(greenBrush, polygonPoints);

    for (int i = 0; i < ArrayHeight; i++)
    {
        for (int j = 0; j < ArrayWidth; j++)
        {
            System.Drawing.Color pixel = bmp.GetPixel(i,j);

            if (pixel.IsSystemColor.Equals("green"))
            {
                PolyArray[i, j] = (byte)TerrainValue;
            }
        }
    } 
```

我想检查位图中该位置的像素是否是系统绘图颜色“绿色”，但它永远不会返回 true。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:03:46.447

我不确定为什么需要与`green`系统颜色进行比较。 `IsSystemColor`返回一个`bool`。

但这应该有效。

```
if (pixel.IsSystemColor)
{
    PolyArray[i, j] = (byte)TerrainValue;
} 
```

或（我真的认为这就是你想要的）

```
if (pixel == green)
{
    PolyArray[i, j] = (byte)TerrainValue;
} 
```

# css - 自动调整不同行 div 的大小

> ID：15256848
> 
> 赞同：0
> 
> 时间：2013-03-06T20:00:14.220
> 
> 标签：css, html, height

好吧，我在不同的页面上有两行相同的类 div。在第 1 页上，有一行包含相当多的文本，并且它的大小设置效果很好。在第 2 页上，div“框”中的文本要少得多，但尺寸太大。

我想要完成的是让第 1 页上的 3 个 div 具有正确的当前高度设置，但我希望第 2 页上的 div 具有更短的高度设置。唯一的问题是这必须在一个 Css 类（父级和兄弟级）中完成。

这是一个例子的图片：

![在此处输入图像描述](../Images/74178927d9f2de364cdcaeeb7e019d5a.png)

2a：这是当前的高度设置，它可以完美地处理大量文本。

2b：较短的文本框太长，需要缩短但仍与2a的同一类。

2c & 2d：正确的自动调整高度

```
.box{
    height: 400px;
}

.box .box_content{
    height: 90%;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:09:17.507

如果您删除 .box 上的高度设置，高度将动态填充内容。

如果每一行需要相等的高度，您可以使用 jquery 找到该行中最高的 div 并相应地设置其他。

# authentication - SimpleMembership MVC 4 保持身份验证，但未通过身份验证

> ID：15256850
> 
> 赞同：0
> 
> 时间：2013-03-06T20:00:16.357
> 
> 标签：authentication, asp.net-mvc-4

我正在使用“开箱即用”的 ASP.NET MVC 4 SimpleMembership。

我在控制器上将身份验证要求设置为 deco`[Authorize(Roles = "User")].`

它工作正常，除非在没有注销的情况下离开网站。下一次回来，`Request.IsAuthenticated`还是这样，但是当我去一个视图时，我得到“ `A network-related or instance-specific error occurred while establishing a connection to SQL.`”实际上，它看起来像是在尝试连接到本地数据库：`"SQLExpress database file auto-creation error'`- 在 App_Data 文件夹中。但是我没有指向这个的连接字符串，它都在 Azure Sql 上。

知道这是什么吗？为什么它假装保持登录状态？为什么要尝试创建数据库？

```
------------------------------------Stack trace-------------------------------------------

[SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)]
   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) +5296071
   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose) +558
   System.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean withFailover) +5308555
   System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover) +145
   System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout) +889
   System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance) +307
   System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions) +434
   System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions) +5311099
   System.Data.ProviderBase.DbConnectionFactory.CreateNonPooledConnection(DbConnection owningConnection, DbConnectionPoolGroup poolGroup, DbConnectionOptions userOptions) +38
   System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection) +5313314
   System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions) +143
   System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry) +83
   System.Data.SqlClient.SqlConnection.Open() +96
   System.Web.Management.SqlServices.GetSqlConnection(String server, String user, String password, Boolean trusted, String connectionString) +76

[HttpException (0x80004005): Unable to connect to SQL Server database.]
   System.Web.Management.SqlServices.GetSqlConnection(String server, String user, String password, Boolean trusted, String connectionString) +131
   System.Web.Management.SqlServices.SetupApplicationServices(String server, String user, String password, Boolean trusted, String connectionString, String database, String dbFileName, SqlFeatures features, Boolean install) +89
   System.Web.Management.SqlServices.Install(String database, String dbFileName, String connectionString) +27
   System.Web.DataAccess.SqlConnectionHelper.CreateMdfFile(String fullFileName, String dataDir, String connectionString) +386 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:21:36.730

如果您使用 SimpleMembership“开箱即用”设置，它会使用 cookie 保持用户登录。SimpleMembership 使用 EF 代码优先，如果它认为数据库不存在，它将尝试创建一个数据库。它使用延迟加载机制，因此在您点击 AccountController 之前它不会尝试创建它（即您被带到登录或注册页面）。如果授权失败，您将被重定向到登录页面。如果您使用“开箱即用”设置，那么它希望使用 web.config 中名为 DefaultConnection 的连接字符串。它看起来像这样

```
 <add name="DefaultConnection" connectionString="Data Source=(LocalDb)\v11.0;Initial Catalog=aspnet-ProjectName-20130125152904;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnet-ProjectName-20130125152904.mdf" providerName="System.Data.SqlClient" /> 
```

其中 ProjectName 是您第一次使用 MVC 4 Internet 模板创建 MVC 项目时的名称。您将需要更改此设置以使用 Azure。

**2013 年3 月 7 日更新** 由于您没有使用默认连接字符串，因此您需要更新在两个地方使用的连接字符串。你提到你在初始化程序中更新了它，所以我假设你的意思是在 SimpleMembershipInitializer 中，它的代码看起来像这样。

```
 public SimpleMembershipInitializer()
    {
        Database.SetInitializer<UsersContext>(null);

        try
        {
            using (var context = new UsersContext())
            {
                if (!context.Database.Exists())
                {
                    // Create the SimpleMembership database without Entity Framework migration schema
                        ((IObjectContextAdapter)context).ObjectContext.CreateDatabase();
                }
            }

            WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "UserName", autoCreateTables: true);
        }
        catch (Exception ex)
        {
            throw new InvalidOperationException("The ASP.NET Simple Membership database could not be initialized. For more information, please see http://go.microsoft.com/fwlink/?LinkId=256588", ex);
        } 
```

我假设（因为您没有在问题中提供任何代码）您更新了 InitializeDatabaseConnection 中的第一个参数以使用您的连接字符串的名称。这很好，但它只处理配置数据库连接。如果您查看检测数据库是否已创建并实际创建它的代码，则高于设置此连接。连接字符串也在 UserContext 中设置，您可以在 AccountModels.cs 中找到它。代码是

```
public UsersContext()
    : base("DefaultConnection")
{
} 
```

如您所见，连接字符串被传递到基本上下文。如果您没有在此处更改它，那么它将使用 DefaultConnection 连接字符串检查是否存在并尝试创建它。我相信如果缺少连接字符串，它将尝试创建一个名为 DefaultConnection 的本地数据库。

如果您使用表单身份验证，我建议您删除初始化程序并按照[本文所述](http://kevin-junghans.blogspot.com/2013/01/seeding-customizing-aspnet-mvc.html)自行处理。这个初始化器被设计成模板生成的代码可以在开发人员不想使用表单身份验证的情况下工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-20T20:45:02.280

我终于想通了这个问题！当我找到这个帖子时，我遇到了同样的问题，但由于没有明确的答案，我不得不自己四处寻找。

发生的情况是 UsersContext 最终将失去对其连接的跟踪。通过完全绕过 UserContext 并避免构造函数，连接将保持稳定。

注意：我不再自动生成简单的成员资格表，所以我不确定如果是这样的话这是否会奏效。

请在此处查看 AccountModels.cs 中的 UsersContext。您应该注释掉/删除此代码。

```
public class UsersContext : DbContext
{
    public UsersContext()
        : base("YourDBContext")
    {
    }

    public DbSet<UserProfile> UserProfiles { get; set; }
    public DbSet<webpages_Membership> webpages_Memberships { get; set; }
    public DbSet<UsersInRole> webpages_UsersInRoles { get; set; }
    public DbSet<Role> webpages_Roles { get; set; }
} 
```

将来自 UsersContext 的 DbSet 添加到您自己的上下文中：

```
public class YourDBContext : DbContext
{
    public DbSet<Blah> Blahs{ get; set; }
    public DbSet<Something> Somethings { get; set; }

    public DbSet<UserProfile> UserProfiles { get; set; }
    public DbSet<webpages_Membership> webpages_Memberships { get; set; }
    public DbSet<UsersInRole> webpages_UsersInRoles { get; set; }
    public DbSet<Role> webpages_Roles { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
    }

} 
```

当然，在您完成所有操作后，您必须将对 UsersContext 的任何引用更改为 YourDBContext，即

```
UsersContext uc = new UsersContext(); 
```

变成

```
YourDBContext ydb = new YourDBContext(); 
```

这样做的额外好处是您不必跟踪两个不同的 DBContext。

# asp.net-mvc - 使用get时mvc路由无效

> ID：15256851
> 
> 赞同：0
> 
> 时间：2013-03-06T20:00:18.480
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-routing

我正在尝试让 MVC 生成正确的 url。

现在结果是这样的： [http ://domain.com/Live/Schedule?date=2013-03-29](http://domain.com/Live/Schedule?date=2013-03-29)

它当然应该像这样正确地生成它：http: [//domain.com/Live/Schedule/2013-03-29](http://domain.com/Live/Schedule/2013-03-29)

我的全球.Asax

```
routes.MapRoute(
name: "LiveSchedule", // Route name
url: "Live/{action}/{date}", // URL with parameters
defaults: new { controller = "Live", action = "Schedule", date = UrlParameter.Optional }
); 
```

网页上触发请求的代码：

```
@using(Html.BeginForm("Schedule", "Live", FormMethod.Get))
{
<div>
    Specify a date: @Html.DropDownList("date", Model.SelectedDateList) <input type="submit" value="Display"/>
</div>
} 
```

结果：

```
<form action="/Live/Schedule" method="get">                    
<div>
Select a date: <select id="date" name="date"><option value="2013-03-27">27 onsdag</option>
<option value="2013-03-28">28 torsdag</option>
<option selected="selected" value="2013-03-29">29 fredag</option>
<option value="2013-03-30">30 l&#246;rdag</option>
<option value="2013-03-31">31 s&#246;ndag</option>
...
</select> <input type="submit" value="Display"/>
</div>
</form> 
```

接受输入的控制器：

```
public ActionResult Schedule(string date)
{
    var model = getModel(date);
    return View(model);
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-19T00:44:00.120

您混淆的是，生成获取 url 的是常规 HTML，而不是 ASP.NET MVC 的函数。

如规范（[RFC1866](http://www.ietf.org/rfc/rfc1866.txt)，第 46 页；[HTML 4.x](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.3.4)第 17.13.3 节）所述：

> 如果方法是“get”并且操作是一个 HTTP URI，用户代理会获取 action 的值，附加一个 `?' 到它，然后附加表单数据集，使用“application/x-www-form-urlencoded”内容类型编码。

# cuda - 为什么 CUDA 占用是根据活动经线数超过支持的最大经线数来定义的

> ID：15256852
> 
> 赞同：6
> 
> 时间：2013-03-06T20:00:18.580
> 
> 标签：cuda

占用率定义为活动扭曲的数量超过一个流多处理器上支持的最大扭曲的数量。假设我在一个 SM 上运行了 4 个块，每个块有 320 个线程，即 10 个 warp，所以一个 SM 上有 40 个 warp。占用率为 40/48，假设一个 SM 上的最大扭曲为 48 (CC 2.x)。

但总的来说，我在一个 SM 上运行了 320 * 4 个线程，而一个 SM 上只有 48 个 CUDA 内核。为什么入住率不是100%？我正在使用所有 CUDA 内核...

我很确定我错过了什么......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-06T20:10:16.613

因为占用与核心无关。CUDA 是一种流水线 SIMD 风格的架构。您的 48 个内核是从管道（实际上是双发）中的*每个 warp指令馈送的。*您需要大量的扭曲来保持指令流水线充满，否则所有内核都会停止。这就是为什么占用率是量化给定内核提供足够并行工作以实现合理性能的能力的一个有用的指标。

# content-management-system - 如何制作可以放到页面上的新 OpenCMS 内容类型

> ID：15256856
> 
> 赞同：0
> 
> 时间：2013-03-06T20:00:30.230
> 
> 标签：content-management-system, opencms

我正在使用 OpenCMS 进行开发，到目前为止，我对模板、模型页面、如何创建空间以放入可编辑内容等有了一些了解。

我有一些我想放入的元素不是标准内容类型，如文本块或灵活内容。事实上，这些元素根本不存在。

我想做一些事情：

1.  包含我编写的 HTML
2.  只有我的客户可以轻松编辑的某些部分。

我不希望我的客户必须进入灵活内容小部件中的 HTML，例如，在 jQuery 手风琴中编辑一些文本或在 jQuery 手风琴的句柄上放置标题。

需要帮助。OpenCMS 术语对我来说似乎也有点混乱。如果您是专家，请参考关键词。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T14:16:29.763

我不是 OpenCms 方面的专家，但据我所知，您可以定义自己的结构化内容类型，就像 .xsd 文件中的 v8.Article 一样。在那里您可以设置可以在 ADE 中编辑的字段。您的 HTML 代码可以添加到自定义 formatter-jsp 中。希望这个对你有帮助。OpenCms 文档不是很广泛... Alkacon 提供支持，但价格非常高...

# android - 市场访问

> ID：15256860
> 
> 赞同：-2
> 
> 时间：2013-03-06T20:00:43.457
> 
> 标签：android, google-play

应用程序开发人员是否会在将应用程序投放市场之前对其进行标记，以便进行搜索或分类等？还是根据描述进行搜索？

是否可以创建一个显示/可以访问来自市场及其描述的应用程序的应用程序？这个应用程序还应该允许应用程序下载和安装..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:05:26.450

> 应用程序开发人员是否会在将应用程序投放市场之前对其进行标记，以便进行搜索或分类等？还是根据描述进行搜索？

Google Play 根据您在描述和标题文本中所写的内容进行搜索索引。虽然没有明确禁止以这种格式添加标签`Tags: abc, xyz`，但在某些情况下，使用此类标签的应用程序会被视为垃圾邮件，并且偶尔会暂停开发者帐户。

> 是否可以创建一个显示/可以访问来自市场及其描述的应用程序的应用程序？

有一些非官方的 API 可以从 Google Play 中提取和显示信息，比如[这个](http://code.google.com/p/android-market-api/)。

但是，如果您正在寻找官方实现，您最多可以使用[此处](http://developer.android.com/distribute/googleplay/promote/linking.html)描述的意图在 Google Play 应用程序中启动特定页面。

> 这个应用程序还应该允许应用程序下载和安装..

如果您想允许用户通过您的应用程序下载和安装应用程序，您需要要求开发人员向您提供他们应用程序的 apk，您将其存储在服务器上并提供给您的用户。此外，您将无法像 Google Play 那样进行“静默”安装，用户必须明确授予安装每个应用程序的权限。

# email - Powershell 脚本无法发送给多个收件人

> ID：15256862
> 
> 赞同：6
> 
> 时间：2013-03-06T20:00:45.810
> 
> 标签：email, powershell, smtp

我正在使用一个 powershell 脚本，它将创建磁盘空间的 HTML 报告并将其作为电子邮件发送。不幸的是，我无法将脚本发送给多个电子邮件收件人。我正在使用的脚本可以在这里找到：

[http://gallery.technet.microsoft.com/scriptcenter/6e935887-6b30-4654-b977-6f5d289f3a63](http://gallery.technet.microsoft.com/scriptcenter/6e935887-6b30-4654-b977-6f5d289f3a63)

以下是脚本的相关部分...

```
$freeSpaceFileName = "FreeSpace.htm" 
$serverlist = "C:\sl.txt" 
$warning = 90 
$critical = 75 
New-Item -ItemType file $freeSpaceFileName -Force 

Function sendEmail 
{ param($from,$to,$subject,$smtphost,$htmlFileName) 
$body = Get-Content $htmlFileName 
$smtp= New-Object System.Net.Mail.SmtpClient $smtphost 
$msg = New-Object System.Net.Mail.MailMessage $from, $to, $subject, $body 
$msg.isBodyhtml = $true 
$smtp.send($msg) 
} 

$date = ( get-date ).ToString('yyyy/MM/dd') 
$recipients = "to1@email.com", "to2@email.com"
sendEmail from@email.mail $recipients "Disk Space Report - $Date" smtp.server $freeSpaceFileName 
```

我收到以下错误

```
New-Object : Exception calling ".ctor" with "4" argument(s): "The specified string is not in the form required for an e
-mail address."
At E:\DiskSpaceReport.ps1:129 char:18
+ $msg = New-Object <<<<  System.Net.Mail.MailMessage $from, $to, $subject, $body
+ CategoryInfo          : InvalidOperation: (:) [New-Object], MethodInvocationException
+ FullyQualifiedErrorId : ConstructorInvokedThrowException,Microsoft.PowerShell.Commands.NewObjectCommand 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-06T20:55:50.890

您使用的 MailMessage 构造函数只需要一个电子邮件地址。请参阅 MSDN 文档 [http://msdn.microsoft.com/en-us/library/5k0ddab0.aspx](http://msdn.microsoft.com/en-us/library/5k0ddab0.aspx)

您应该尝试使用`Send-MailMessage`，因为它的`-To`参数接受地址数组

`Send-MailMessage -from from@email.mail -To $recipients -Subject "Disk Space Report - $Date" -smptServer smtp.server -Attachments $freeSpaceFileName`

注意：Send-MailMessage 是在 PowerShell v2.0 中引入的，这就是为什么仍然有使用其他命令的示例的原因。如果您需要使用 v1.0，那么我将更新我的答案。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-05-23T18:57:07.850

使用 PowerShell 发送电子邮件有两种方法：

1.  对于**`Send-MailMessage`**方法（在 PowerShell 版本 2 中引入）：

    `$to = "to1@email.com", "to2@email.com"`

2.  对于**`System.Net.Mail`**方法（来自 PowerShell 版本 1 的作品）：

    `$msg.To.Add("to1@email.com")`

    `$msg.To.Add("to2@email.com")`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-06-05T10:31:18.393

您也可以在`System.Net.Mail`一行中完成此操作。只需确保在单个字符串中添加括号和以逗号分隔的所有收件人：

```
$msg = New-Object System.Net.Mail.MailMessage("from@email.com","to@email1.com,to@email2.com","Any subject,"Any message body") 
```

这也适用于 RFC-822 格式的电子邮件地址：

```
System.Net.Mail.MailMessage("Sender <from@email.com>","Rcpt1 <to@email1.com>,Rcpt2 <to@email2.com>","Any subject,"Any message body") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-08-18T13:07:25.083

[根据https://docs.microsoft.com/en-us/dotnet/api/system.net.mail](https://docs.microsoft.com/en-us/dotnet/api/system.net.mail.mailmessage.-ctor?redirectedfrom=MSDN&view=net-5.0#System_Net_Mail_MailMessage__ctor_System_String_System_String_System_String_System_String)，看起来 MailMessage 构造函数已被 Microsoft 修复，因为它接受多个收件人，用逗号字符 (",") 分隔。 [mailmessage.-ctor?redirectedfrom=MSDN&view=net-5.0#System_Net_Mail_MailMessage__ctor_System_String_System_String_System_String_System_String](https://docs.microsoft.com/en-us/dotnet/api/system.net.mail.mailmessage.-ctor?redirectedfrom=MSDN&view=net-5.0#System_Net_Mail_MailMessage__ctor_System_String_System_String_System_String_System_String) _

> to String - 包含电子邮件收件人地址的字符串。多个电子邮件地址必须用逗号字符 (",") 分隔。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-06T20:08:04.437

试试这个：

```
Function sendEmail 
{ param($from,[string[]]$to,$subject,$smtphost,$htmlFileName) 
$body = Get-Content $htmlFileName 
$smtp= New-Object System.Net.Mail.SmtpClient $smtphost 
$msg = New-Object System.Net.Mail.MailMessage 
$msg.from =$from

foreach($a in $to)
{
   $msg.to.Add($a)
}

$msg.Subject= $subject
$msg.Body = $body 
$msg.isBodyhtml = $true 
$smtp.send($msg) 
} 

sendemail  -from from@email.mail -to $recipients -smtphost smtp.server -subject "Disk Space Report - $Date" -htmlFileName  $freeSpaceFileName 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-06T20:15:50.670

我建议在 powershell 中使用 send-mailmessage 而不是定义自己的函数。我的猜测是你的一个参数类型不匹配。

# git - Git：每次拉取原始主机都会导致与消息合并

> ID：15256864
> 
> 赞同：12
> 
> 时间：2013-03-06T20:00:47.540
> 
> 标签：git, git-merge, git-pull

每次我做一个

```
git pull origin master 
```

Git 会弹出一个编辑器，让我在提交之前写一个关于合并的评论。知道为什么会发生这种情况吗？另一位开发人员也在做 master 的工作，并且没有遇到这个问题。

据我所知，分支配置是正确的。除了在我拉动时发生的烦人的合并提交之外，我还能够像往常一样拉下更改并上推更改。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T20:25:49.623

`git pull``git fetch`紧随其后的是`git merge`。从 Git 1.7.10 开始，`git merge`合并时会弹出一个编辑器（请参阅[发行说明](https://git.kernel.org/cgit/git/git.git/tree/Documentation/RelNotes/1.7.10.txt)）。其他开发人员可能正在使用旧版本的 Git。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-03-04T01:44:00.637

我不是 git 专家，但我遇到了这种行为并设法恢复到工作状态，所以这里是我的提示，所有这些都使用 git 版本 2.28.0（以及可能的早期版本） . 我怀疑更专业的人`git`可以进一步简化这个答案。

当我做了一些事情来搞砸我的本地`master`/`main`分支导致它与它应该跟踪的不同步时，就会发生这种情况。我还没有弄清楚我做了什么来搞砸它，因为它发生的频率还不够高，我无法诊断出我行为中的错误。[更新：我想我现在已经在自己的工作流程中看到了导致这种情况的一种行为。我去 GitHub 查看 PR 并使用“查看命令行说明”信息中的复制链接来了解如何在我的工作区中获取 PR 的副本。复制的两个命令中的第一个是`git checkout -b ...`. 但是，有时，我无意中在已经有一个具有该名称的分支的工作区中执行此操作（通常，我已经尝试过 PR 的早期草稿），因此命令失败，我仍在我的 master/main 分支上，然后粘贴下一个命令并将分支合并到我的主/主。然后我花了一段时间才意识到事情搞砸了]。

我注意到有两种方式进入了这种状态：

*   通过我这样做时弹出的编辑器窗口`git pull origin master`（如OP中所述）
*   当我推送到 GitHub 的 PR 显示表单提交时`Merge branch 'master' of https://github.com/[myOrg]/[myRepo] into master`

这是我在发生此问题时的解决方法：

*   首先，我在我的分支历史中找到了包含此消息的最旧的合并提交：
    *   浏览日志：`git log`
    *   使用消息及时搜索最旧的提交`Merge branch 'master' of https://github.com/[myOrg]/[myRepo] into master`
    *   在此之前查找提交的 SHA（即，我的`master`分支与它应该跟踪的分支不同的点）
*   将我的分支备份到该 SHA：`git checkout [SHA]`
    *   这将使您的分支进入“分离 HEAD”状态
*   重命名我搞砸的主分支以将其排除在外`git branch -m master master-broken` （可选，您可以删除它，但这更安全，您以后可以随时删除它）
*   将我当前分离的 HEAD 分支重命名为 master：`git checkout -b master`
*   将分支赶回它应该在的位置：（ `git pull [upstream source] master`在 OP 的情况下，我希望这是`git pull origin master`）

理解这个修复的一个关键见解是要意识到这个分支并没有什么特别之处`master`——它只是一个约定。所以删除它（或重命名它）并使用该名称创建一个新的没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-09T09:09:13.180

我不知道为什么会发生这种情况，但我可以提供解决方案。正如您所注意到的，它只发生在您身上，而不会发生在其他开发人员身上。所以有些东西在你这边坏了。我也有这个问题，因此历史看起来并不干净。一个激进的解决方案是在本地删除 master 并重新获取它，就这么简单。

# java - 有没有办法确保在使用继承时将我的 jaxb 元素设置在属性之前？

> ID：15256865
> 
> 赞同：1
> 
> 时间：2013-03-06T20:00:50.133
> 
> 标签：java, jaxb

我有一个扩展 ParentClass 的类（ChildClass）。解组时，我从 setPropFromElementList() 中得到一个异常，即我传入的值在列表中不存在，即使它确实存在于列表中。我相信问题是由 JAXB 在设置子元素之前尝试设置父属性引起的。

我看到各种博客文章和问题，建议将父类设为 Transient，然后在子类上使用 propOrder（也包括父类中的元素）。这对我没有帮助 - 我收到了 IllegalAnnotationException。

有任何想法吗？（示例代码如下——它不是我使用的*确切*代码，所以我不能 100% 确定它会编译。但是，它确实显示了我在真实代码中所做的事情。）

父类.java

```
@XmlTransient //on the entire class - not shown here

private String propFromElementList

@XmlAttribute
String getPropFromElementList() {
    return this.propFromElementList;
}

void setPropFromElementList(String value) {
    checkThatValueIsInList(value);
    this.propFromElementList = value;
}

protected abstract void checkThatValueIsInList(String value); 
```

ChildClass.java 扩展了 ParentClass

@XmlType(propOrder={ "list", "propFromElementList" })

```
private String[] list;

@XmlElement
public String[] getList() {
    return this.list;
}

public void setList(final String... list) {
    this.list = list;
}

@Override
protected void checkThatValueIsInList(String value) {
    //search for String and throw RuntimeException if not found
} 
```

XML

```
<child propFromElementList="A">
    <list>A B C D</list>
</child> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:04:43.040

**更新**

> 有没有办法确保在使用继承时将我的 jaxb 元素设置在属性之前？

您无法控制[JAXB (JSR-222)](http://jcp.org/en/jsr/detail?id=222)实现填充域模型的顺序。JAXB impl 最喜欢填充对象模型，因为它在解组操作期间执行 XML 文档的深度优先遍历。这意味着属性通常会在任何子元素之前处理，这似乎是导致用例中问题的原因。

您可能需要考虑将验证逻辑移到`setPropFromElementList`方法之外并将其放入`afterUnmarshal`方法中。

*   [http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.html#unmarshalEventCallback](http://docs.oracle.com/javase/6/docs/api/javax/xml/bind/Unmarshaller.html#unmarshalEventCallback)

* * *

**原始答案**

上的`propOrder`设置`@XmlType`仅在编组时使用。您不能在`propOrder`on中包含使用 @XmlAttribute 映射的属性`@XmlType`。既然你有：

```
@XmlAttribute
String getPropFromElementList() {
    return this.propFromElementList;
} 
```

则`propFromElementList`不能出现在`propOrder`其中仅针对非属性节点。

# mongodb - oplog.rs 上的 MongoDB C# 驱动程序可尾游标

> ID：15256872
> 
> 赞同：2
> 
> 时间：2013-03-06T20:01:15.107
> 
> 标签：mongodb, mongodb-.net-driver

我正在尝试使用类似于在 Java [Here](https://github.com/mongodb/mongo-java-driver/blob/master/examples/ReadOplog.java)中实现的 MongoDB C# 驱动程序编写一个 oplog 观察程序。

到目前为止，我已经设法写了：

```
public static void Read()
{
    const string connectionString = "mongodb://127.0.0.1:27017,127.0.0.1:27018/?replicaSet=rs0";
    MongoClient mongoClient = new MongoClient(connectionString);

    MongoDatabase local = mongoClient.GetServer().GetDatabase("local");
    MongoCollection opLog = local.GetCollection("oplog.$main");
    BsonValue lastId = BsonMinKey.Value;
    while (true)
    {
        var query = Query.GT("_id", lastId);
        var cursor = opLog.FindAs<BsonDocument>(query)
                    .SetFlags(
                        QueryFlags.AwaitData |
                        QueryFlags.TailableCursor |
                        QueryFlags.NoCursorTimeout)
                    .SetSortOrder(SortBy.Ascending("$natural"));
        using (var enumerator = (MongoCursorEnumerator<BsonDocument>)cursor.GetEnumerator())
        {
            while (true)
            {
            // I get a "tailable cursor requested on non capped collection" Exception
                if (enumerator.MoveNext())
                {
                    var document = enumerator.Current;
                    lastId = document["_id"];
                }
                else
                {
                    if (enumerator.IsDead)
                    {
                        break;
                    }
                    if (!enumerator.IsServerAwaitCapable)
                    {
                        Thread.Sleep(TimeSpan.FromMilliseconds(100));
                    }
                }
            }
        }
    }
} 
```

我已经在服务器上创建了 oplog 并使用[此处](http://docs.mongodb.org/manual/tutorial/change-oplog-size/)找到的说明从 mongo 命令行成功查询了它，但我无法弄清楚为什么异常说它没有上限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T19:28:42.970

如果您正在使用并设置了副本集，则您有一个 oplog。

要查询 oplog，您可以使用数据库“本地”。

然后改变

```
local.GetCollection("oplog.$main"); 
```

至

```
local.GetCollection("oplog.rs"); 
```

# java - 同一行上出现的字符串

> ID：15256875
> 
> 赞同：0
> 
> 时间：2013-03-06T20:01:25.667
> 
> 标签：java, hashmap, bufferedreader, indexof

我有计算文本文件中一周中出现的天数的代码。截至目前，如果它是该行上唯一的字符串，它只会计算星期几。例如，如果我有一条写着 (Monday abcd) 的行，它将不计入该星期一。我尝试使用 indexOf 并通过拆分、修剪和添加回哈希映射来解决此问题，但我不知道该怎么做。

下面是一些代码，在此之前我声明了关键字，打开文本文件并将每个关键字放入映射中，值为 0

```
public class DayCounter
{

public static void main(String args[]) throws IOException 
{

    String[] theKeywords = { "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"};

    // put each keyword in the map with value 0 
    Map<String, Integer> DayCount = new HashMap<String, Integer>();
    for (String str : theKeywords)
    {
        DayCount.put(str, 0);
    }

    try (BufferedReader br = new BufferedReader(new FileReader("C:\\Eclipse\\test.txt")))
    {

String sCurrentLine;

// read lines until reaching the end of the file
 while ((sCurrentLine = br.readLine()) != null) 
 {

   if (sCurrentLine.length() != 0) 
    {

    // extract the words from the current line in the file
     if (DayCount.containsKey(sCurrentLine))
     {
      DayCount.put(sCurrentLine, DayCount.get(sCurrentLine) + 1);
     }
    }
  } 
```

这是输出部分

```
 for(String day : theKeywords)
 {
  System.out.println(day + " = " + DayCount.get(day));

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:35:54.847

您需要在字符串中搜索一周中的实际天数。现在你在问“DayCount 是否包含一个名为 [整行] 的键”，你想要的是检查每一行是否出现一周中的每一天。一种快速而肮脏的方法是围绕该单词（例如“Monday”）拆分字符串并计算结果列表的长度：

```
while ((sCurrentLine = br.readLine()) != null) {
    // For every line in the reader...

    for (String dayOfWeek : (Set<String>) DayCount.keySet()) {
        // For each day of the week (the keys in the DayCount map), count how
        // many times that key shows up in the line.
        int occurrences = sCurrentLine.split(dayOfWeek, -1).length - 1;

        // Now increase the appropriate counter by the number of occurrences (0+)
        DayCount.put(dayOfWeek, (Integer) DayCount.get(dayOfWeek) + occurrences);
    }
} 
```

由于您在迭代 Set 时遇到问题（这是一个谜，但超出了您原始问题的范围），您也可以这样写（正如我在评论中提到的那样 - 请注意内部循环中的更改):

```
while ((sCurrentLine = br.readLine()) != null) {
    // For every line in the reader...

    //NOTE: I strongly advise renaming theKeywords to something more descriptive!
    for (String dayOfWeek : theKeywords) {
        // For each day of the week, count how many times that key shows up.
        int occurrences = sCurrentLine.split(dayOfWeek, -1).length - 1;

        // Now increase the appropriate counter by the number of occurrences (0+)
        DayCount.put(dayOfWeek, (Integer) DayCount.get(dayOfWeek) + occurrences);
    }
} 
```

这一切都很简单。唯一奇怪的是：

```
int occurrences = sCurrentLine.split(dayOfWeek, -1).length - 1; 
```

此代码调用`split`当前行上的方法。它在一周中的某一天四处分裂，看起来`-1`像“maxSplits”。这个负值告诉`split`方法在结果的行尾包含空字符串。否则，尽管该行`"a b c Monday "`将按预期返回一个长度为 2 的数组 ( `["a b c ", " "]`)，但该行`"a b c Monday"`（末尾没有空格）将返回一个长度为 1 的数组，因为最后一项将为空。

一旦我们在一周中的每一天都有正确的数组拆分，我们计算其中的项目数并减去一个以获得实际的出现次数。这始终是合法的，因为我们的数组将具有的最小大小为 1（在没有发生拆分的情况下，因此原始 String 是返回数组中的唯一元素）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:07:02.977

DayCount 类的规范是什么？在不知道的情况下很难弄清楚代码的意图是什么。

无论如何，您可以使用 contains 方法确定一行是否包含星期几；

`if(sCurrentLine.contains("Monday") || sCurrentLine.contains("Tuesday") || ...) then ...`

# java - 将一个 int 数组附加到一个 ArrayList

> ID：15256876
> 
> 赞同：3
> 
> 时间：2013-03-06T20:01:32.530
> 
> 标签：java, arraylist

是否有将 int 数组添加（实际上是附加）到 ArrayList 的快捷方式？对于以下示例

```
ArrayList<Integer> list=new ArrayList<Integer>();  
    int[] ints={2,4,5,67,8}; 
```

还是我必须将整数的元素一一添加到列表中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T20:04:33.827

按照其他人的建议使用`Arrays.asList(ints)`是行不通的（它会给出一个列表`int[]`而不是列表`Integer`）。

我能想到的唯一方法就是一个一个地添加元素：

```
 for (int val : ints) {
        list.add(val);
    } 
```

如果你可以把你的`int[]`into `Integer[]`，那么你可以使用`addAll()`：

```
 list.addAll(Arrays.asList(ints)); 
```

# javascript - 用 document.URL 替换当前 url

> ID：15256877
> 
> 赞同：2
> 
> 时间：2013-03-06T20:01:36.227
> 
> 标签：javascript, url, replace, window.location

我试图获取当前 URL 并将其替换为其他内容。但是如果 x = document.URL 我的代码不起作用，但是对于 x = "String" 一切正常

```
function test(){

    var x = document.URL    
    var url = window.location.toString();
    window.location = url.replace( x , 'whatever');
}
test(); 
```

谢谢你帮助我

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T20:16:19.560

变量`url`和的值`x`是相同的，因此您只需将整个 URL 替换为“whatever”。为什么不直接使用`window.location = 'whatever'`呢？

如果要替换整个 URL，则需要在放置的字符串中提供完整的 URL `whatever`，否则它将作为相对 URL 而不是绝对 URL。

所以尝试类似的东西`window.location = "[http://www.google.com](http://www.google.com)"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:13:44.810

你应该只使用`window.location.href = 'whatever'`. 那不能解决你的问题吗？

`window.location = 'whatever'`也可以，但它在技术上是不完整的。然而，Javascript 将正确地实现它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:08:51.130

可能对你有`window.location = 'whatever';`帮助吗？

[例子](http://jsfiddle.net/69YRH/)

# java - java.lang.NoClassDefFoundError 将 svg 文件读取为 BufferedImage

> ID：15256880
> 
> 赞同：0
> 
> 时间：2013-03-06T20:01:47.523
> 
> 标签：java, swing, svg, java-2d, batik

我有一个 .svg 文件来创建一个地图，该地图将具有与边界相关的侦听器（我猜它称为可伸缩矢量图形的“节点”）。但是，我正在尝试将此文件添加为 JPanel 上的 BufferedImage。（我是关于摇摆组件的新手，所以如果您有更好的想法，请分享）。此外，我使用了[Batik](http://xmlgraphics.apache.org/batik/)库并阅读了一些有关它的信息，并使用此代码示例将这个 .svg 文件作为 BufferedImage

```
package org.pulpcore.tools.res;

import java.awt.image.BufferedImage;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import org.apache.batik.dom.svg.SVGDOMImplementation;
import org.apache.batik.transcoder.TranscoderException;
import org.apache.batik.transcoder.TranscoderInput;
import org.apache.batik.transcoder.TranscoderOutput;
import org.apache.batik.transcoder.TranscodingHints;
import org.apache.batik.transcoder.image.ImageTranscoder;
import org.apache.batik.util.SVGConstants;
import org.apache.commons.io.FileUtils;

public class SVGRasterizer {

    /**
     Rasterizes an SVG file using Batik.

     @param svgFile The svg file.
     @return The rasterized image.
     @throws IOException if the svg file could not be rasterized.
     */
    public static BufferedImage rasterize(File svgFile) throws IOException {

        final BufferedImage[] imagePointer = new BufferedImage[1];

        // Rendering hints can't be set programatically, so
        // we override defaults with a temporary stylesheet.
        // These defaults emphasize quality and precision, and
        // are more similar to the defaults of other SVG viewers.
        // SVG documents can still override these defaults.
        String css = "svg {" +
                "shape-rendering: geometricPrecision;" +
                "text-rendering:  geometricPrecision;" +
                "color-rendering: optimizeQuality;" +
                "image-rendering: optimizeQuality;" +
                "}";
        File cssFile = File.createTempFile("batik-default-override-", ".css");
        FileUtils.writeStringToFile(cssFile, css);

        TranscodingHints transcoderHints = new TranscodingHints();
        transcoderHints.put(ImageTranscoder.KEY_XML_PARSER_VALIDATING, Boolean.FALSE);
        transcoderHints.put(ImageTranscoder.KEY_DOM_IMPLEMENTATION,
                SVGDOMImplementation.getDOMImplementation());
        transcoderHints.put(ImageTranscoder.KEY_DOCUMENT_ELEMENT_NAMESPACE_URI,
                SVGConstants.SVG_NAMESPACE_URI);
        transcoderHints.put(ImageTranscoder.KEY_DOCUMENT_ELEMENT, "svg");
        transcoderHints.put(ImageTranscoder.KEY_USER_STYLESHEET_URI, cssFile.toURI().toString());

        try {

            TranscoderInput input = new TranscoderInput(new FileInputStream(svgFile));

            ImageTranscoder t = new ImageTranscoder() {

                @Override
                public BufferedImage createImage(int w, int h) {
                    return new BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB);
                }

                @Override
                public void writeImage(BufferedImage image, TranscoderOutput out)
                        throws TranscoderException {
                    imagePointer[0] = image;
                }
            };
            t.setTranscodingHints(transcoderHints);
            t.transcode(input, null);
        }
        catch (TranscoderException ex) {
            // Requires Java 6
            //throw new IOException("Couldn't convert " + svgFile, ex);
            ex.printStackTrace();
            throw new IOException("Couldn't convert " + svgFile);
        }
        finally {
            cssFile.delete();
        }

        return imagePointer[0];
    }
} 
```

这是我使用 GUI 组件的课程，也是我尝试使用 BufferedImage 的部分

```
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.swing.JFrame;
import javax.swing.JPanel;

public class JRisk {

    private JFrame mainMap;

    public JRisk() throws IOException{

        initComponents();
    }

    private void initComponents() throws IOException{

        mainMap = new JFrame();
        mainMap.setResizable(false);

                JPanel mainPanel = new JPanel();

                File riskMap = new File("src\\src\\risk.svg");

                BufferedImage bufImage = SVGRasterizer.rasterize(riskMap);

                mainMap.setIconImage(bufImage);

        mainMap.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                mainMap.add(mainPanel);
                mainMap.pack();
                mainMap.setVisible(true);
    }

} 
```

最后，包含 main 方法的测试程序。

```
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.SwingUtilities;

public class Test {

    /**
     * @param argsh
     */
    public static void main(String[] args) {

        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                        try {
                            new JRisk();
                        } catch (IOException ex) {
                            Logger.getLogger(Test.class.getName()).log(Level.SEVERE, null, ex);
                        }
            }
        });
    }
} 
```

那么我的问题是编译器给出了一个错误

```
Exception in thread "AWT-EventQueue-0" java.lang.NoClassDefFoundError: org/w3c/dom/svg/SVGDocument 
```

整个错误是

```
at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
    at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at org.apache.batik.dom.svg.SVGDOMImplementation.createDocument(Unknown Source)
    at org.apache.batik.dom.util.SAXDocumentFactory.startElement(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:506)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(XMLNSDocumentScannerImpl.java:376)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl$NSContentDriver.scanRootElementHook(XMLNSDocumentScannerImpl.java:602)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:3063)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:881)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:607)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:116)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:488)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:835)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:764)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1210)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:568)
    at org.apache.batik.dom.util.SAXDocumentFactory.createDocument(Unknown Source)
    at org.apache.batik.dom.util.SAXDocumentFactory.createDocument(Unknown Source)
    at org.apache.batik.dom.svg.SAXSVGDocumentFactory.createDocument(Unknown Source)
    at org.apache.batik.dom.svg.SAXSVGDocumentFactory.createDocument(Unknown Source)
    at org.apache.batik.transcoder.XMLAbstractTranscoder.transcode(Unknown Source)
    at org.apache.batik.transcoder.SVGAbstractTranscoder.transcode(Unknown Source)
    at src.SVGRasterizer.rasterize(SVGRasterizer.java:74)
    at src.JRisk.initComponents(JRisk.java:31)
    at src.JRisk.<init>(JRisk.java:17)
    at src.Test$1.run(Test.java:24)
    at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:251)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:705)
    at java.awt.EventQueue.access$000(EventQueue.java:101)
    at java.awt.EventQueue$3.run(EventQueue.java:666)
    at java.awt.EventQueue$3.run(EventQueue.java:664)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:675)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:117)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:113)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:105)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:90)
Caused by: java.lang.ClassNotFoundException: org.w3c.dom.svg.SVGDocument
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    ... 51 more 
```

如果您能就这个话题提供帮助，即使有有用的建议，我将不胜感激！无论如何谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-12T13:27:32.543

尝试添加**xml-apis.jar**和/或**xml-apis-ext.jar**。这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T11:26:25.627

以下帖子解决了您的问题：
[蜡染不在类路径中](https://stackoverflow.com/questions/7891250/batik-not-in-classpath)

好像 jar 文件可能不包含在 Batik 下载中，您只需下载所需的 jar 库并将其添加到您的项目中即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-31T15:15:51.133

在我的情况下，蜡染需要多个 jar 文件才能将 SVG 文件渲染到 BufferedImage。错误：几个 `java.lang.NoClassDefFoundError`。不确定是否全部需要，究竟缺少什么，或者是否有重叠但值得尝试：

```
w3c-css
w3c-dom
org.w3c.dom.smil
org.w3c.css.sac     
org.w3c.dom.svg
W3C SVG DOM Bindings For Java (aXSL Build)
svg-dom-java
apatche xmlgraphics-commons 
```

# c++ - 我在哪里定义谓词和函数对象？

> ID：15256882
> 
> 赞同：1
> 
> 时间：2013-03-06T20:01:57.460
> 
> 标签：c++, predicate, function-object

我的问题纯粹是组织性质的，因此我意识到潜在的答案可能是主观的。经过多年的 C# 工作，我终于回到了 C++ 并且正在努力适应如何正确组织文件。

基本上，我想知道定义谓词和函数对象的最佳位置在哪里。目前，我在单个类中为 STL 算法使用了一个简单的函数对象。这个函数对象对任何其他类都没有用，那么我把它放在哪里呢？我是否将它放在同一个命名空间和头文件或 .cpp 文件中？我是将它放在匿名命名空间中还是将它放在它自己的头文件/cpp 文件中？

预先感谢您的任何和所有答案，

凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:21:55.063

取决于谓词的用途。由于您说它在其他任何地方都没有用，因此最好在您的 cpp 文件中声明它，以免在人们包含您的头文件时弄乱命名空间。

如果它在文件范围内甚至没有用，如果不是太复杂，您可以考虑使用 lambdas。如果您无法访问 C++11 的 lambda（或 Boost.Lambda），您甚至可以在函数范围内声明本地函子。这很方便！但是，请记住，您不能在文件范围级别使用模板化仿函数，这通常是您想要的（这里的一个示例是使用“模板化迭代器”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:14:48.793

我假设您不能使用 C++11，否则我建议尽可能使用 lambdas ;) 但是，由于我没有好的论据，这正是我通常会做的：

如果我只在一个函数中使用谓词，我在函数中声明它，如果我只在一个代码文件中使用它，我把它放在匿名命名空间中。我喜欢保持 .h 文件尽可能干净，以减少重建和文件依赖的数量。

我相信使用匿名命名空间或将它们放入函数中有助于避免名称冲突并产生更清晰的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T20:06:58.640

这真的取决于谓词是什么，如果它对最终用户有任何用处，我会将它的声明放在标题中，理想情况下作为 const ref 采用的自由函数，并在源文件中实现。

如果它是程序的一部分（而不是库），那么为了简单起见，我也会这样做。

如果它只供内部使用并且您不希望最终用户使用它，那么您可以将它放在源文件中的匿名命名空间中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-06T20:22:04.200

如果它只供一个类使用，并且您不希望它对其他人有用，那听起来正是嵌套类的时间：

```
class SomeClass {
public:
    //...

    struct MyPredicate {
        bool operator() (const SomeData&) const;
    };

}; 
```

上面类的实际名称是`SomeClass::MyPredicate`，因此如果`operator()`在其声明中未定义 ，则需要在`SomeClass::MyPredicate::operator()`某处定义。但是在你们中的任何成员中`SomeClass`都可以输入`MyPredicate`.

您还可以使谓词成为`private`其包含类的成员，在这种情况下，甚至不允许外部代码键入该类的名称。

# java - 如果在远程服务器上工作，我是否需要 JDBC 驱动程序

> ID：15256890
> 
> 赞同：0
> 
> 时间：2013-03-06T20:02:29.393
> 
> 标签：java, sql, jdbc

我是网络和数据库的新手。我正在为我的数据库类做一个项目，将 java 与 SQL 结合起来。我使用 putty 连接到学校的服务器，我可以访问我的 java 文件，一切都很好。但是当我运行我的java文件时，我得到了“ `java.lang.ClassNotFoundException: com.mysql.jdbc.Driver`”。现在我需要在我的家用 PC 上安装 JDBC 驱动程序吗？我不认为我会这样做，因为我在学校的服务器上运行所有东西，就像我在学校使用腻子做同样的事情一样。

对于任何含糊之处，我深表歉意，老实说，我对自己在做什么不太了解。我已经尝试寻找解决问题的方法，但我无法理解其他人在说什么。我很乐意提供任何需要的信息，我只是不知道该提供什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:14:10.707

当您在远程服务器上运行 java 程序时，您当前在类路径中缺少 mysql jdbc 驱动程序。

你需要运行`javac`编译你的java类。

```
> javac TestMyQuery.java 
```

这将生成一个 TestMyQuery.class 文件。要运行程序，假设它有一个`main()`方法：

```
> java -cp .;<the name of the jar containing the driver> TestMyQuery 
```

注意`.;`，这会将当前目录添加到类路径中。这也会将您的 TestMyQuery.class 文件添加到类路径中。

查看您的远程服务器目录，也许 jar 已经在其中某个地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:13:14.150

您已经生成了一个 jar，如果是这样，您的 MySQL JDBC 驱动程序必须包含在类路径中。在您的 jar 中，您可以将 mysql 驱动程序复制到您的 jar 的“classes”文件夹中或再次生成您的 jar，但将 mysql 作为项目的一部分包含在内以获取包含驱动程序的 jar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:11:15.817

您需要将[mysql 连接器](http://dev.mysql.com/downloads/connector/j/)jar 添加到您的类路径中。为您的数据库服务器的 MySQL 的确切版本下载连接器 jar。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T22:24:07.797

My instructor gave me instructions on how to connect to the driver remotely. I did not have to do anything with a jar file or classpaths. Sorry for the time.

# vim - vim EasyTags，每个文件类型标签命令？

> ID：15256893
> 
> 赞同：4
> 
> 时间：2013-03-06T20:02:47.007
> 
> 标签：vim, tags, exuberant-ctags

我将出色的[EasyTags](https://github.com/xolox/vim-easytags)插件与 vim 一起使用。我唯一的问题是 Exuberant CTags 不支持 Haskell。但是，有几个程序可以正确生成 Haskell vim 标签文件，我已经在 EasyTags 中使用了 per file type tags file 选项。

有没有办法告诉 EasyTags 在每个文件类型的基础上使用不同的 ctags 程序？我可以编写一个包装脚本并将其设置为全局 ctags 程序，但更喜欢更清洁的解决方案。

我试过了

```
:autocmd FileType haskell let g:easytags_cmd = '~/.cabal/bin/lushtags' 
```

但是 EasyTags 似乎试图在 ctags 程序中查询支持的语言列表，因此当我打开启用此选项的 Haskell 文件时出现错误。

```
`"Data/Csv/Conduit.hs" [RO] 51L, 1950C
Error detected while processing function xolox#easytags#register..xolox#easytags#get_tagsfi
le..xolox#easytags#supported_filetypes..34_check_filetype:
line    3:
E605: Exception not caught: Failed to get supported languages! (output: Usage: lushtags [op
tions] [--] )
Error detected while processing function xolox#easytags#register..xolox#easytags#get_tagsfi
le..xolox#easytags#supported_filetypes:
line   14:
E171: Missing :endif
Error detected while processing function xolox#easytags#register..xolox#easytags#get_tagsfi` 
```

* * *

 `## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T16:27:14.490

在这里的 EasyTags 用户，我也一直想要这个功能（对于[`jsctags`](http://doctorjs.org/)）。我已经实现了一个允许为特定语言配置单独的可执行文件的[补丁。](https://github.com/xolox/vim-easytags/pull/40)

在合并之前（不幸的是，过去几个月没有任何活动），您可以使用[我的 fork](https://github.com/inkarkat/vim-easytags)。配置将是这样的：

```
let g:easytags_languages = {
\   'haskell': {
\       'cmd': '~/.cabal/bin/lushtags',
\       'args': [],
\       'fileoutput_opt': '-f',
\       'stdout_opt': '-f-',
\       'recurse_flag': '-R'
\   }
\} 
````

# c# - 当前上下文中不存在名称“xx”

> ID：15256896
> 
> 赞同：1
> 
> 时间：2013-03-06T20:03:09.770
> 
> 标签：c#, winforms

不太确定我做错了什么。我得到的错误是：

当前上下文中不存在名称“_questions”-FormChoose.cs

代码：

表单选择.cs

```
using System;
using System.IO;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Xml.Linq;
using System.Xml.Serialization;

namespace WindowsFormsApplication1
{
    public partial class FormChoose : Form
    {
        public FormChoose()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            _questions = GetQuestions("1");
        }
    }
} 
```

Form1.cs

```
using System;
using System.IO;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Xml.Linq;
using System.Xml.Serialization; 
```

任何有关如何实现这一目标的输入或答案将不胜感激。任何可以帮助 ltn 的帖子的人都可能获得奖励/激励，这样我就可以让它发挥作用。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T20:07:58.320

您正在尝试从未声明的位置访问成员和方法。您尝试访问的方法和成员（`_questions`和`GetQuestions()`）是 的一部分`Form1`，并且您尝试在 中访问它们`FormChoose`。做到这一点的唯一方法是`Form1`引用`FormChoose`. 而且我并没有真正看到您声明`path`应该在的任何地方`Form1`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T20:11:15.833

除了 CL4pTR4P 的答案，你还有这个：

```
private List<Question> GetQuestions(string difficulty)
{
    var quiz = XDocument.Load(path); 
```

但路径未在您的代码中的任何地方声明，这就是为什么您在当前上下文中不存在名称“路径”-Form1.cs

您需要声明它并将其设置为合适的值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:25:35.610

_questions 和 GetQuestions 属性在 Form1 中声明，而不是在 formChoose 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T21:27:58.893

1 - 创建一个新类来放置您的问题存储库。

```
namespace WindowsFormsApplication1
{
    public class QuestionController
    {
        private static List<Question> _questions = new List<Question>();

        public static void LoadData(string path)
        {
            //Load Data from path->_questions
        }

        public static List<Question> GetQuestionsByDifficulty(int difficulty)
        {
            return _questions.Where(p => p.Difficulty == difficulty).ToList();
        }
    }
} 
```

2 - 在应用程序启动代码中加载您的存储库。在你的情况下：

```
public Form1()
{
    InitializeComponent();
    QuestionController.LoadData("");
} 
```

只要在范围内，您就应该能够访问问题控制器方法。

# java - 消息队列类似于命令队列吗？

> ID：15256898
> 
> 赞同：0
> 
> 时间：2013-03-06T20:03:11.817
> 
> 标签：java, android, linked-list, queue, rabbitmq

我正在尝试将 Android 用作多用户系统。因此，我试图在不经历 4 年的 compsci 的情况下绕开排队。但我并不懒惰，愿意阅读、学习和学习。

与消息队列相反，命令队列到底是什么？

如果我想对意图进行排队，以便队列中的最后一个意图/命令仅在前一个意图/命令完成之前运行，我应该学习/使用什么数据结构？

Android/Java 提供了这个：http: [//developer.android.com/reference/java/util/Queue.html](http://developer.android.com/reference/java/util/Queue.html)。但我为什么不使用这个：[http ://www.rabbitmq.com/java-client.html](http://www.rabbitmq.com/java-client.html)

我坚持的事情是……命令或意图也不能成为消息吗？

意图基本上是命令，我是在告诉系统执行某些操作。但我想让用户只有在其他人的“某事”执行后才能执行“某事”。

我有很多人可以使用一个 android 的方法，我只需要对实现对混乱的控制有所了解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:19:26.930

> 我正在尝试将 Android 用作多用户系统。因此，我试图在不经历 4 年的 compsci 的情况下绕开排队。

对于任何想要重写操作系统部分的人来说，拥有“4 年的 compsci”将是一个合理的想法，正如您似乎希望做的那样。

> 与消息队列相反，命令队列到底是什么？

一个有“命令”这个词。另一个有“消息”一词。因此，唯一的其他区别在于您赋予这两个词的任何含义。

例如，有些人可能会争辩说“命令”是一种“消息”，但反之则不然。

> 如果我想排队意图基本上是命令，以便队列中的最后一个意图/命令仅在前一个意图/命令完成之前运行。

您没有提供任何关于您使用这些“意图基本上命令”的指示。Android 中的 An`Intent`用于启动 Activity，启动或绑定到服务，或发送广播。行为的特征`Intent`将取决于您使用的目的`Intents`。

例如，`sendBroadcast()`没有严格的“队列”概念。但是，`IntentService`当与`startService()`-- 一起使用时，它会缓冲`Intents`，等待`onHandleIntent()`完成对当前的处理，`Intent`然后再将其传递给下一个。

> Android/Java 提供了这个：http: [//developer.android.com/reference/java/util/Queue.html](http://developer.android.com/reference/java/util/Queue.html)。但我为什么不使用这个：[http ://www.rabbitmq.com/java-client.html](http://www.rabbitmq.com/java-client.html)

*RabbitMQ 用于机器之间*的消息队列。您可以通过阅读链接到的页面来判断这一点（“RabbitMQ Java 客户端库允许 Java 代码与 AMQP 服务器交互”）。

`Queue`*是在单个应用程序*中使用的数据结构，与`java.util`包中的所有内容一样。

> 命令或意图也不能成为消息吗？

欢迎您为术语“命令”和“消息”赋予任何含义。

> 但我想只在某人的“某事”执行后才允许用户执行“某事”。

Android中没有通用的相互`Intent`同步模型。因此，如果不重写某些操作系统，就无法确保所寻求的协调。

# javascript - 如何改进这个 JavaScript 类？

> ID：15256900
> 
> 赞同：0
> 
> 时间：2013-03-06T20:03:19.587
> 
> 标签：javascript, oop

我是 JavaScript 新手，我知道我的代码很奇怪，我该如何解决这个问题？另外，如何在函数中调用函数？我想将所有值转换为数字或浮点数并调用解决方案。

```
 <script type="text/javascript">

    function Math(){                        

        var firstNumber = document.getElementById("firstnumber");
        var secondNumber = document.getElementById("secondnumber");

        this.add = function(){          
            var fN = Number( firstNumber.value );
            var sN = Number( secondNumber.value );
            return ( fN + sN );
        }

        this.sub = function(){          
            var fN = Number( firstNumber.value );
            var sN = Number( secondNumber.value );
            return ( fN - sN );
        }

        this.div = function(){          
            var fN = Number( firstNumber.value );
            var sN = Number( secondNumber.value );
            return ( fN - sN );
        }

        this.mul = function(){          
            var fN = Number( firstNumber.value );
            var sN = Number( secondNumber.value );
            return ( fN * sN );
        }

    }

    var myNewMath = new Math();         

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:08:26.570

如果有点重复，代码对于初学者来说一点也不*差。*

为了让事情变得简单，我可能会做这样的事情来避免重复调用`Number(element.value)`：

```
function Calculator() { // NB: not "Math" - that's a standard object                   

    var firstNumber = document.getElementById("firstnumber");
    var secondNumber = document.getElementById("secondnumber");

    function op1() {
        return Number(firstNumber.value);
    }

    function op2() {
        return Number(secondNumber.value);
    }

    this.add = function() {          
        return op1() + op2();
    }

    this.sub = function() {
        return op1() - op2();
    }

    ...
} 
```

# c++ - 通过函数的字符串数组的大小

> ID：15256906
> 
> 赞同：0
> 
> 时间：2013-03-06T20:03:40.693
> 
> 标签：c++, arrays, function, parameters, size

如何查找传递给函数的字符串数组的大小。大小应该在函数内部计算。

```
#include<iostream>

using namespace std;

template <typename T,unsigned S>
unsigned arraysize(const T (&v)[S]) { return S; }

void func(string args[])
{
   unsigned m=arraysize(args);
   cout<<m;
}

int main()
{
    string str_arr[]={"hello","foo","bar"};

    func(str_arr);  
} 
```

我不明白的是：

如果在 main 中使用该语句`arraysize(str_arr)`，则不会造成问题。str_arr 是一个数组，所以 str_arr 充当一个指针，所以当我们使用 arraysize(str_arr) 时，这意味着我们正在将地址发送给 arraysize 函数。（如果我错了，请纠正我）。

但是在函数func（）中，我不明白为什么会出现问题，即语句`arraysize(args)`发送字符串数组args的地址（或指针args的地址）..还是因为它变成了一些双指针而变得更复杂？解释？

另外请更正上面的代码..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:09:34.917

当发送到函数时，无法确定数组的大小。您还必须记住，只有一个指向数组的指针被发送给函数，这使得计算数组的大小在理论上甚至是非常不可信的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:11:26.700

`string args[]`数组大小的信息在您的函数中永远不可见，因为您在决定将其用于参数时将其丢弃。从编译器的角度来看，它与`string* args`. 您可以将功能更改为：

```
template<size_t M>
void func(string (&args)[M])
{
   cout<<M;
} 
```

但似乎你已经知道了，对吧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:11:48.790

`str_arr`是一个字符串数组。当你这样做时`sizeof(str_arr)`，你会得到那个数组的大小。然而，尽管它`args`看起来像一个字符串数组，但事实并非如此。看起来像数组的参数实际上是指针类型。即由编译器`string args[]`转换为。`string* args`当你这样做时，`sizeof(args)`你只是得到指针的大小。

您可以将数组的大小传递给函数，也可以使用模板参数大小获取对数组的引用（就像您对 所做的那样`arraysize`）：

```
template <size_t N>
void func(string (&args)[N])
{
   // ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T20:25:46.517

> 如果在 main 中使用该语句`arraysize(str_arr)`，则不会造成问题。是`str_arr`一个数组，所以`str_arr`充当一个指针，所以当我们使用它时`arraysize(str_arr)`，我们将地址发送给 `arraysize`函数。（如果我错了，请纠正我）。

我必须在这里纠正你。你陈述了一个正确的前提，却得出了错误的结论。

关键点确实`str_arr`是`main`. 虽然数组在许多（大多数）表达式上下文中衰减为指针，但当对数组的引用被初始化时，这并不适用。这就是为什么`array_size`声明要引用数组参数的原因 - 这是拥有数组类型参数的唯一方法，这意味着它具有定义的长度。

情况并非如此`func`。当函数参数被声明为普通数组类型时，指向指针衰减的数组将应用于该声明。您的声明`func`等同于`void func(string * args)`. 因此`args`是指针，而不是数组。你可以`func`称之为

```
string str_non_array;
func(&str_non_array); 
```

因此，对数组的引用不能绑定到它。无论如何，`args`已经完全丢失了有关它指向的数组大小的所有信息。

您可以使用与以下相同的引用数组技巧`arraysize`：声明`func`为

```
template <std::size_t N>
void func(string (&args)[N]); 
```

但这在任何地方都是不切实际的（如果天真地应用于所有数组处理代码，可能会导致代码膨胀）。其他语言中可用的具有长度的数组的 C++ 等效项是`std::vector<string>`（对于动态大小的数组）或`std::array<string,N>`（对于在编译时已知的固定大小）。请注意，后者可能会导致与上述相同的代码膨胀，因此在大多数情况下，`std::vector<string>`它将是您需要传递给各种函数的数组的首选类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-15T09:02:10.937

德米特里是对的，我想进一步解释一下。它发生的原因是因为数组不是 C++ 中的[一等公民](http://en.wikipedia.org/wiki/First-class_object)，当作为参数传递时，它会衰减为指针，而您在调用函数中得到的是指向其第一个元素的指针，并且大小丢失。您可以将[C++ 数组作为函数参数引用](https://stackoverflow.com/questions/2867783/c-arrays-as-function-arguments)，以查看可用的替代选项。

# asp.net-mvc - MVC 实体框架说该字段为 NULL 但它不是

> ID：15256907
> 
> 赞同：0
> 
> 时间：2013-03-06T20:03:43.860
> 
> 标签：asp.net-mvc, entity-framework

我需要创建新对象并将其添加到数据库。首先，我将唯一 ID 设置为 Product（我的实体）。并返回用户可以设置其他字段的视图。

```
 public ViewResult Create()
     {
         var product = new Product { ProductID = GetFreeId() };    
         return View("Edit",product);
     } 
```

风景：

```
@using (Html.BeginForm()) {
@Html.EditorForModel()
<input type="submit" value="Save" />} 
```

然后通过控制器我们来到这个方法：

```
public void AddProduct(Product product)
{
     context.Products.Add(product);   
     context.SaveChanges();
} 
```

如果我在最后一个方法上放一个断点，我会看到`product.ProductID=10`但在`string context.SaveChanges();`我得到异常：

> 无法插入 ProductID=null 的实体。

错误在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:13:55.013

如果您想手动提供密钥并且密钥不是数据库中自动生成的身份，您必须将此告知实体框架，例如在`Product`模型中使用数据注释：

```
public class Product
{
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int ProductID { get; set; }

    //...
} 
```

使用 Fluent API 它是：

```
modelBuilder.Entity<Product>()
    .Property(p => p.ProductID)
    .HasDatabaseGeneratedOption(DatabaseGeneratedOption.None); 
```

键的默认设置`int`是 EF 假定 ID 是在数据库中生成的，并且 EF 不会将 ID 值发送到 DB，即使它是在您的模型中设置的。然后数据库抛出异常，因为它没有在 INSERT 语句中获得键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:08:47.220

可能当您回发时，ID 未设置。您应该在 post 方法中设置它。

# asp.net - 使用 DataAdapter/Dataset 的 Asp.net 参数化 SQL 查询

> ID：15256912
> 
> 赞同：0
> 
> 时间：2013-03-06T20:04:20.063
> 
> 标签：asp.net, sql, vb.net, parameters

我想要做的是查找在分配给 Valor 的 textbox4 上输入的文本，如果找到则显示，下面的代码正在工作，但我想使用参数化查询（安全原因），我不知道如何修改我的现有的代码来完成它。（例如，123-A）

我将查找“123-A”，但在当前代码中出现“无效列 A”错误，我将查找“123-A”的 SQL 列是“ID_LALTest”

```
Try
            ' *--------search by Unique ID-------*
            Dim CON As New SqlConnection
            Dim DA As New SqlDataAdapter
            Dim DS As New DataSet
            Dim SQL As String
            Dim Valor As String
            Valor = TextBox4_SearchData_LALTest.Text

            CON.ConnectionString = "not displayed"
            CON.Open()

            SQL = "SELECT ID_LALTest, LALTest_SeqRef_CH, LALTest_SeqRef_Year FROM LALTest WHERE ID_LALTest=@Valor"
            DA = New SqlDataAdapter(SQL, CON)
            DA.SelectCommand.Parameters.AddWithValue("@Valor", Valor)
            DA.SelectCommand.ExecuteNonQuery()
            DA.Fill(DS, 0)

            If DS.Tables(0).Rows.Count > 0 Then
                ' *--------Found, Display Data Grid-------*
                Label2_SearchData_LALTest.Visible = False
                GridView2_SearchData_LALTest.Visible = True
                GridView3_SearchData_LALTest.Visible = True
                GridView1_SearchData_LALTest.Visible = False

            Else
                Label2_SearchData_LALTest.Text = "Record Not Found"
                Label2_SearchData_LALTest.Visible = True
                GridView2_SearchData_LALTest.Visible = False
                GridView3_SearchData_LALTest.Visible = False
                GridView1_SearchData_LALTest.Visible = False

            End If
            con.dispose()
        Catch ex As Exception
            MsgBox(Err.Description)
        End Try 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T21:09:59.350

是的，你对 sql-injection 很开放。取决于不同的数据库（您只有 SQL，但它是 SQL-Server、MySQL、Access/SQL 数据库等）。

无论如何，它离你所拥有的并不太远。不专攻VB，我会给你一些伪代码......

更改您的查询，并为您要从输入中应用的“变量”放入一个“占位符”... 例如：

```
"select (your fields) from (yourtable) where ID_LALTest = @parmValor" 
```

然后，将参数添加到为数据适配器创建的 sql 命令中......类似于......

```
DA.SelectCommand.Parameters.Add( "@parmValor", theInputFromYourVariable ); 
```

现在，如果您有多个要应用的条件，只需继续添加“@someParm”值并以与查询中存在的相同顺序添加参数......我过去从其他人那里听说过，这只是与查询不匹配的参数的序数序列可能/确实会导致问题……例如数据类型期望。

# javascript - 替代字符串终止

> ID：15256920
> 
> 赞同：1
> 
> 时间：2013-03-06T20:05:07.787
> 
> 标签：javascript, string, terminate

我只是想问一下，Javascript 中是否有一些替代（不同于引号）字符串终止符？我听说过用于 IE 的 NULL 字节。

我知道字符串不能超过 1 行，因为下一行被视为下一行代码，但是在这种情况下，javascript 只报告“未终止的字符串”错误。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:11:21.073

您可以转义换行符：

```
var a = "beginning of string\ 
```

其余字符串";

或者您可以使用字符串连接：

```
var a = "beginning of string" +
        "rest of string"; 
```

# javascript - 使用 javascript 在 phonegap 应用程序中操作 iframe 内容

> ID：15256924
> 
> 赞同：1
> 
> 时间：2013-03-06T20:05:19.337
> 
> 标签：javascript, cordova, iframe

我想访问 iframe 中的表单。此 iframe 内的页面来自其他域。但是，我在 phonegap/native (iOS) 中。在浏览器中，我注意到如果页面来自同一来源，我只能访问和操作 iframe 内容。因为在 phonegap 中，不存在 XSS 之类的东西，我希望我可以从其他域访问 iframe。无论如何，以防万一，这是我的代码：

```
<iframe id="iframe" src="http://login.site.com" width="500" height="500"></iframe>

....

var $ifc = $('#iframe').contents() ;
$ifc.find("input[name=username]").val("Bob");
$ifc.find("input[name=password]").val("secret");
$ifc.find("input[type=submit]").click() ; 
```

这也显示了我想要实现的目标；自动填写登录表单并提交

有什么建议么 ？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:14:41.200

iframe在Phonegap 中[不能很好地工作。](https://github.com/phonegap/phonegap/wiki/iFrame-Usage)

但是，应该可以通过 javascript 访问 iframe。

```
var iframeDoc = document.getElementById("iframe").document; 
```

# android - 菜单中的新页面

> ID：15256925
> 
> 赞同：0
> 
> 时间：2013-03-06T20:05:21.230
> 
> 标签：android, android-layout, android-optionsmenu

我想为菜单项创建一个新布局。例如，菜单有项目：`About`和`Exit`。当我单击该项目`About`时，我希望它转到显示学分的新页面。

我做了这样的事情，但我得到一个错误，有什么帮助吗？

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.xsi_zero, menu);

    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch(item.getItemId()) {
    case R.id.aboutMenu:
        setContentView(R.layout.about);
        break;
    case R.id.exitGame:
        XsiZero.this.finish();
        break;
    }

    return true;
} 
```

我在这一行得到错误：

```
setContentView(R.layout.about); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:29:06.730

如果你想启动一个活动，你可以使用`Intents.`Intends 来传递我们的消息，简单定义的请求。

```
//This creates a new Intent object that has home and target
Intent niceIntent = new Intent(YourCurrentActivityName.this, TargetActivityName.class);

//Now start your Activity(Operation)
startActivity(niceIntent);

... 
```

以上关于我们的 Home Activity 的代码，我们也必须在 Target Activity 中做一些事情。

在您的 Target 活动的 onCreate 方法 AFTER `super.onCreate`.. 中，您必须设置`setContentView(R.layout.about);`以查看您的关于页面。

## 还有一个重要的问题是关于`AndroidManifest.xml`

Android系统必须知道每一个变化。如果您向应用程序添加新活动，则必须通知`AndroidManifest.xml`

**如何通知 AndroidManifest.xml 以获取新的 Activity？**

```
 <activity
        android:name="com.yourpackagename.projectname"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity> 
```

# spring - spring/hibernate：每次打开/关闭会话 VS getCurrentSession

> ID：15256931
> 
> 赞同：1
> 
> 时间：2013-03-06T20:05:53.213
> 
> 标签：spring, hibernate, session

这些方法之间有什么区别，哪一种更好？到目前为止，我有如下代码：

```
public void delete(Song song) {
    session = sessionFactory.getCurrentSession();
    session.delete(song);
    session.flush();
} 
```

但是在运行上述代码时，记录并不总是被删除（准确地说：id=1 永远不会被删除，其他 id 总是被删除）。我读到保持打开的会话会稍微加快应用程序的速度——这就是我共享会话对象的原因。我的业务对象通过 DI 获取会话工厂：

```
@Autowired
private SessionFactory sessionFactory;

Session session = null;

public void setSessionFactory(SessionFactory sessionFactory) {
    this.sessionFactory = sessionFactory;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:12:53.730

根据我对 Hibernate 的经验，我得出的结论是，最好的策略是将 Hibernate 会话生命周期与单个事务的持续时间相匹配。根据您的具体需求，您可能需要做其他事情，但我敢打赌，所提出的策略将适用于 95% 的实际案例。

# mysql - NodeJS 会话、cookie 和 mysql

> ID：15256933
> 
> 赞同：1
> 
> 时间：2013-03-06T20:05:59.123
> 
> 标签：mysql, node.js, session

我正在尝试构建一个身份验证系统并且我有 app.js

```
var express = require('express')
  , MemoryStore = require('express').session.MemoryStore
  , app = express();

app.use(express.cookieParser());
app.use(express.session({ secret: 'keyboard cat', store: new MemoryStore({ reapInterval: 60000 * 10 })}));
app.use(app.router); 
```

和 route.index 作为

```
var express = require('express')
  , mysql = require('mysql')
  , crypto = require('crypto')
  , app = module.exports = express();

app.get('/*',function(req,res){
    var url = req.url.split('/');
    if (url[1] == 'favicon.ico')
        return;

    if (!req.session.user) {
        if (url.length == 4 && url[1] == 'login') {     
            var connection = mysql.createConnection({
                host     : 'localhost',
                user     : 'user',
                password : 'pass',
            });
            var result = null;
            connection.connect();
            connection.query('use database');
            var word = url[3];
            var password = crypto.createHash('md5').update(word).digest("hex");
            connection.query('SELECT id,level FROM users WHERE email = "'+url[2]+'" AND password = "'+password+'"', function(err, rows, fields) {
              if (err) throw err;
                for (i in rows) {
                    result = rows[i].level;
                }
                req.session.user = result;
            });
            connection.end();
        }
    }

console.log(req.session.user) 
```

当我第一次访问[http://mydomain.com/login/user/pass](http://mydomain.com/login/user/pass)时，它显示在最后一次控制台调用中，但第二次访问时 cookie 是干净的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:26:35.423

为什么不直接使用 Express 的会话处理？如果您使用 express 命令行工具，因为`express --sessions`它将创建具有会话支持的项目模板。从那里您可以将会话行复制到您当前的项目中。在[如何使用 Node.js 在 Express.js 中进行会话？](https://stackoverflow.com/questions/5522020/how-do-sessions-work-in-express-with-nodejs)（这看起来可能是重复的）

至于清理 SQL，您似乎正在使用该库，如果您使用参数化查询（即 ? 占位符），它将为您的输入清理。

最后一件事，您使用 Express 错误（没有冒犯）。Express 的路由器将允许您拆分很多路由（同时允许您配置 favicon。请参阅[Unable to Change Favicon with Express.js](https://stackoverflow.com/questions/11658035/unable-to-change-favicon-with-express-js)（第二个答案）。使用“/*”路由只会捕获所有 GET 请求，这极大地限制路由器可以为您做的事情。

（接评论；把它放在这里作为代码块）现在你有一个支持会话的应用程序，试试**这两条路线**：

```
app.get('/makesession', function (req, res) {
    req.session.message = 'Hello world';
    res.end('Created session with message : Hello world');
});
app.get('/getsession', function (req, res) {
    if (typeof req.session.message == 'undefined') {
        res.end('No session');
    } else {
        res.end('Session message: '+req.session.message);
    }
}); 
```

如果您在浏览器中导航到 /makesession，它会设置一个会话消息并通知您它确实如此。现在，如果您导航到 /getsession，如果会话消息存在，它将向您发送回会话消息，否则它将告诉您会话不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:18:41.040

您需要将 cookie 值保存在**响应**对象中：

```
res.cookie('session', 'user', result); 
```

[http://expressjs.com/api.html#res.cookie](http://expressjs.com/api.html#res.cookie)

# c# - .NET MVC4 SimpleMembershipProvider - 覆盖密码加密/存储？

> ID：15256934
> 
> 赞同：3
> 
> 时间：2013-03-06T20:06:02.777
> 
> 标签：c#, asp.net-mvc-4, asp.net-membership, simplemembership

我有一个生产应用程序，我希望在 MVC4 上重新构建（基础）。使用 SimpleMembershipProvider 进行身份验证和授权似乎非常适合我的需求，除了一件事：密码加密。

该应用程序的当前生产版本有一个自定义 MembershipProvider 加密密码并通过生成盐来存储它们，使用盐 (SHA256) 对密码进行哈希处理，然后将盐存储为数据库存储密码的前 X 个字符：

**MyApp.Security.MyAppMembershipProvider：System.Web.Security.MembershipProvider：**

```
public override MembershipUser CreateUser(string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, out MembershipCreateStatus status) {

    // ...

    u.Email = email.ToLower();

    string salt = GenerateSalt();
    u.Password = salt + Helper.FormatPassword(salt, password, this.PasswordFormat);
    u.FirstName = String.Empty;
    u.LastName = String.Empty;

    // ...

} 
```

当我将应用程序转换为 MVC4 时，明显的问题是我希望我的用户的旧密码继续对他们进行身份验证。我愿意迁移到新的数据*架构*，但旧的身份验证信息需要继续工作。

我的问题是，是否可以使用 SimpleMembershipProvider 以相同的方式覆盖？我是否必须使用 ExtendedMembershipProvider 的实现？或者，*交叉手指*，是否有一些巫毒教简单的方法可以在不完全创建自定义会员提供程序的情况下做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-18T23:14:08.703

您正在寻找的是实现您自己的 ExtendedMembershipProvider。似乎没有任何方法可以干扰 SimpleMembershipProvider 的加密方法，因此您需要自己编写（例如 PBKDF2）。我选择将 salt 与 PBKDF2 迭代一起存储在 pages_Membership 的 PasswordSalt 列中，这样您就可以在以后计算机变得更快并即时升级旧密码时增加此值。

这样的模板示例可能如下所示：

```
 using WebMatrix.Data;
    using WebMatrix.WebData;
    using SimpleCrypto;
    public class CustomAuthenticationProvider : ExtendedMembershipProvider
    {
        private string applicationName = "CustomAuthenticationProvider";
        private string connectionString = "";
        private int HashIterations = 10000;
        private int SaltSize = 64;

        public override void Initialize(string name, System.Collections.Specialized.NameValueCollection config)
        {
            try
            {
                if (config["connectionStringName"] != null)
                    this.connectionString = ConfigurationManager.ConnectionStrings[config["connectionStringName"]].ConnectionString;
            }
            catch (Exception ex)
            {
                throw new Exception(String.Format("Connection string '{0}' was not found.", config["connectionStringName"]));
            }
            if (config["applicationName"] != null)
                this.connectionString = ConfigurationManager.ConnectionStrings[config["applicationName"]].ConnectionString;

            base.Initialize(name, config);
        }

        public override bool ConfirmAccount(string accountConfirmationToken)
        {
            return true;
        }

        public override bool ConfirmAccount(string userName, string accountConfirmationToken)
        {
            return true;
        }

        public override string CreateAccount(string userName, string password, bool requireConfirmationToken)
        {
            throw new NotImplementedException();
        }

        public override string CreateUserAndAccount(string userName, string password, bool requireConfirmation, IDictionary<string, object> values)
        {
            // Hash the password using our currently configured salt size and hash iterations
            PBKDF2 crypto = new PBKDF2();
            crypto.HashIterations = HashIterations;
            crypto.SaltSize = SaltSize;
            string hash = crypto.Compute(password);
            string salt = crypto.Salt;

            using (SqlConnection con = new SqlConnection(this.connectionString))
            {
                con.Open();
                int userId = 0;
                // Create the account in UserProfile
                using (SqlCommand sqlCmd = new SqlCommand("INSERT INTO UserProfile (UserName) VALUES(@UserName); SELECT CAST(SCOPE_IDENTITY() AS INT);", con))
                {
                    sqlCmd.Parameters.AddWithValue("UserName", userName);
                    object ouserId = sqlCmd.ExecuteScalar();
                    if (ouserId != null)
                        userId = (int)ouserId;
                }
                // Create the membership account and associate the password information
                using (SqlCommand sqlCmd = new SqlCommand("INSERT INTO webpages_Membership (UserId, CreateDate, Password, PasswordSalt) VALUES(@UserId, GETDATE(), @Password, @PasswordSalt);", con))
                {
                    sqlCmd.Parameters.AddWithValue("UserId", userId);
                    sqlCmd.Parameters.AddWithValue("Password", hash);
                    sqlCmd.Parameters.AddWithValue("PasswordSalt", salt);
                    sqlCmd.ExecuteScalar();
                }
                con.Close();
            }
            return "";
        }

        public override bool ChangePassword(string username, string oldPassword, string newPassword)
        {
            // Hash the password using our currently configured salt size and hash iterations
            PBKDF2 crypto = new PBKDF2();
            crypto.HashIterations = HashIterations;
            crypto.SaltSize = SaltSize;
            string oldHash = crypto.Compute(oldPassword);
            string salt = crypto.Salt;
            string newHash = crypto.Compute(oldPassword);

            using (SqlConnection con = new SqlConnection(this.connectionString))
            {
                con.Open();
                con.Close();
            }
            return true;
        }

        public override bool ValidateUser(string username, string password)
        {
            bool validCredentials = false;
            bool rehashPasswordNeeded = false;
            DataTable userTable = new DataTable();

            // Grab the hashed password from the database
            using (SqlConnection con = new SqlConnection(this.connectionString))
            {
                con.Open();
                using (SqlCommand sqlCmd = new SqlCommand("SELECT m.Password, m.PasswordSalt FROM webpages_Membership m INNER JOIN UserProfile p ON p.UserId=m.UserId WHERE p.UserName=@UserName;", con))
                {
                    sqlCmd.Parameters.AddWithValue("UserName", username);
                    using (SqlDataAdapter adapter = new SqlDataAdapter(sqlCmd))
                    {
                        adapter.Fill(userTable);
                    }
                }

                con.Close();
            }

            // If a username match was found, check the hashed password against the cleartext one provided
            if (userTable.Rows.Count > 0)
            {
                DataRow row = userTable.Rows[0];

                // Hash the cleartext password using the salt and iterations provided in the database
                PBKDF2 crypto = new PBKDF2();
                string hashedPassword = row["Password"].ToString();
                string dbHashedPassword = crypto.Compute(password, row["PasswordSalt"].ToString());

                // Check if the hashes match
                if (hashedPassword.Equals(dbHashedPassword))
                    validCredentials = true;

                // Check if the salt size or hash iterations is different than the current configuration
                if (crypto.SaltSize != this.SaltSize || crypto.HashIterations != this.HashIterations)
                    rehashPasswordNeeded = true;
            }

            if (rehashPasswordNeeded)
            {
                // rehash and update the password in the database to match the new requirements.
                // todo: update database with new password
            }

            return validCredentials;
        }
} 
```

加密类如下（在我的例子中，我使用了一个名为[SimpleCrypto](http://www.shawnmclean.com/blog/2012/04/simplecrypto-net-a-pbkdf2-hashing-wrapper-for-net-framework/)的 PBKDF2 加密包装器）：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Security.Cryptography;
using System.Text;
using System.Threading.Tasks;

namespace SimpleCrypto
{

    /// <summary>
    /// 
    /// </summary>
    public class PBKDF2 : ICryptoService
    {
        /// <summary>
        /// Initializes a new instance of the <see cref="PBKDF2"/> class.
        /// </summary>
        public PBKDF2()
        {
            //Set default salt size and hashiterations
            HashIterations = 100000;
            SaltSize = 34;
        }

        /// <summary>
        /// Gets or sets the number of iterations the hash will go through
        /// </summary>
        public int HashIterations
        { get; set; }

        /// <summary>
        /// Gets or sets the size of salt that will be generated if no Salt was set
        /// </summary>
        public int SaltSize
        { get; set; }

        /// <summary>
        /// Gets or sets the plain text to be hashed
        /// </summary>
        public string PlainText
        { get; set; }

        /// <summary>
        /// Gets the base 64 encoded string of the hashed PlainText
        /// </summary>
        public string HashedText
        { get; private set; }

        /// <summary>
        /// Gets or sets the salt that will be used in computing the HashedText. This contains both Salt and HashIterations.
        /// </summary>
        public string Salt
        { get; set; }

        /// <summary>
        /// Compute the hash
        /// </summary>
        /// <returns>
        /// the computed hash: HashedText
        /// </returns>
        /// <exception cref="System.InvalidOperationException">PlainText cannot be empty</exception>
        public string Compute()
        {
            if (string.IsNullOrEmpty(PlainText)) throw new InvalidOperationException("PlainText cannot be empty");

            //if there is no salt, generate one
            if (string.IsNullOrEmpty(Salt))
                GenerateSalt();

            HashedText = calculateHash(HashIterations);

            return HashedText;
        }

        /// <summary>
        /// Compute the hash using default generated salt. Will Generate a salt if non was assigned
        /// </summary>
        /// <param name="textToHash"></param>
        /// <returns></returns>
        public string Compute(string textToHash)
        {
            PlainText = textToHash;
            //compute the hash
            Compute();
            return HashedText;
        }

        /// <summary>
        /// Compute the hash that will also generate a salt from parameters
        /// </summary>
        /// <param name="textToHash">The text to be hashed</param>
        /// <param name="saltSize">The size of the salt to be generated</param>
        /// <param name="hashIterations"></param>
        /// <returns>
        /// the computed hash: HashedText
        /// </returns>
        public string Compute(string textToHash, int saltSize, int hashIterations)
        {
            PlainText = textToHash;
            //generate the salt
            GenerateSalt(hashIterations, saltSize);
            //compute the hash
            Compute();
            return HashedText;
        }

        /// <summary>
        /// Compute the hash that will utilize the passed salt
        /// </summary>
        /// <param name="textToHash">The text to be hashed</param>
        /// <param name="salt">The salt to be used in the computation</param>
        /// <returns>
        /// the computed hash: HashedText
        /// </returns>
        public string Compute(string textToHash, string salt)
        {
            PlainText = textToHash;
            Salt = salt;
            //expand the salt
            expandSalt();
            Compute();
            return HashedText;
        }

        /// <summary>
        /// Generates a salt with default salt size and iterations
        /// </summary>
        /// <returns>
        /// the generated salt
        /// </returns>
        /// <exception cref="System.InvalidOperationException"></exception>
        public string GenerateSalt()
        {
            if (SaltSize < 1) throw new InvalidOperationException(string.Format("Cannot generate a salt of size {0}, use a value greater than 1, recommended: 16", SaltSize));

            var rand = RandomNumberGenerator.Create();

            var ret = new byte[SaltSize];

            rand.GetBytes(ret);

            //assign the generated salt in the format of {iterations}.{salt}
            Salt = string.Format("{0}.{1}", HashIterations, Convert.ToBase64String(ret));

            return Salt;
        }

        /// <summary>
        /// Generates a salt
        /// </summary>
        /// <param name="hashIterations">the hash iterations to add to the salt</param>
        /// <param name="saltSize">the size of the salt</param>
        /// <returns>
        /// the generated salt
        /// </returns>
        public string GenerateSalt(int hashIterations, int saltSize)
        {
            HashIterations = hashIterations;
            SaltSize = saltSize;
            return GenerateSalt();
        }

        /// <summary>
        /// Get the time in milliseconds it takes to complete the hash for the iterations
        /// </summary>
        /// <param name="iteration"></param>
        /// <returns></returns>
        public int GetElapsedTimeForIteration(int iteration)
        {
            var sw = new Stopwatch();
            sw.Start();
            calculateHash(iteration);
            return (int)sw.ElapsedMilliseconds;
        }

        private string calculateHash(int iteration)
        {
            //convert the salt into a byte array
            byte[] saltBytes = Encoding.UTF8.GetBytes(Salt);

            using (var pbkdf2 = new Rfc2898DeriveBytes(PlainText, saltBytes, iteration))
            {
                var key = pbkdf2.GetBytes(64);
                return Convert.ToBase64String(key);
            }
        }

        private void expandSalt()
        {
            try
            {
                //get the position of the . that splits the string
                var i = Salt.IndexOf('.');

                //Get the hash iteration from the first index
                HashIterations = int.Parse(Salt.Substring(0, i), System.Globalization.NumberStyles.Number);

            }
            catch (Exception)
            {
                throw new FormatException("The salt was not in an expected format of {int}.{string}");
            }
        }

    }
} 
```

如果没有界面，它就不会完整：

```
public interface ICryptoService
    {
        /// <summary>
        /// Gets or sets the number of iterations the hash will go through
        /// </summary>
        int HashIterations { get; set; }

        /// <summary>
        /// Gets or sets the size of salt that will be generated if no Salt was set
        /// </summary>
        int SaltSize { get; set; }

        /// <summary>
        /// Gets or sets the plain text to be hashed
        /// </summary>
        string PlainText { get; set; }

        /// <summary>
        /// Gets the base 64 encoded string of the hashed PlainText
        /// </summary>
        string HashedText { get; }

        /// <summary>
        /// Gets or sets the salt that will be used in computing the HashedText. This contains both Salt and HashIterations.
        /// </summary>
        string Salt { get; set; }

        /// <summary>
        /// Compute the hash
        /// </summary>
        /// <returns>the computed hash: HashedText</returns>
        string Compute();

        /// <summary>
        /// Compute the hash using default generated salt. Will Generate a salt if non was assigned
        /// </summary>
        /// <param name="textToHash"></param>
        /// <returns></returns>
        string Compute(string textToHash);

        /// <summary>
        /// Compute the hash that will also generate a salt from parameters
        /// </summary>
        /// <param name="textToHash">The text to be hashed</param>
        /// <param name="saltSize">The size of the salt to be generated</param>
        /// <param name="hashIterations"></param>
        /// <returns>the computed hash: HashedText</returns>
        string Compute(string textToHash, int saltSize, int hashIterations);

        /// <summary>
        /// Compute the hash that will utilize the passed salt
        /// </summary>
        /// <param name="textToHash">The text to be hashed</param>
        /// <param name="salt">The salt to be used in the computation</param>
        /// <returns>the computed hash: HashedText</returns>
        string Compute(string textToHash, string salt);

        /// <summary>
        /// Generates a salt with default salt size and iterations
        /// </summary>
        /// <returns>the generated salt</returns>
        string GenerateSalt();

        /// <summary>
        /// Generates a salt
        /// </summary>
        /// <param name="hashIterations">the hash iterations to add to the salt</param>
        /// <param name="saltSize">the size of the salt</param>
        /// <returns>the generated salt</returns>
        string GenerateSalt(int hashIterations, int saltSize);

        /// <summary>
        /// Get the time in milliseconds it takes to complete the hash for the iterations
        /// </summary>
        /// <param name="iteration"></param>
        /// <returns></returns>
        int GetElapsedTimeForIteration(int iteration);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T04:42:24.420

我想我毕竟会走一条稍微不同的路线：

[http://pretzelsteelersfan.blogspot.com/2012/11/migrating-legacy-apps-to-new.html](http://pretzelsteelersfan.blogspot.com/2012/11/migrating-legacy-apps-to-new.html)

基本上，如果 SimpleMembership 验证失败，则将旧用户数据按原样迁移到 UserProfile 表并创建一个类来验证旧算法的凭据。如果遗留验证成功，则通过 WebSecurity.ResetToken 将密码更新为新算法以使其现代化。

谢谢您的帮助。

# java - 将字符串中的项目获取到带有模式的数组中

> ID：15256935
> 
> 赞同：1
> 
> 时间：2013-03-06T20:06:12.433
> 
> 标签：java, string

我有一个字符串，上面有一堆像这样的纬度和经度

`LINESTRING (-79.0578544444577 43.0929133770364, -79.0559554404751 43.0929995585932, -79.0540564364926 43.09308574015, -79.0504086322323 43.0931797561892, -79.0503228015438 43.0911427096913)`

我想将坐标从字符串中取出到一个数组中。我知道这可以做到，`string splitting`但我不明白如何编写表达式以仅从字符串中获取坐标。

有人可以帮我解决这个问题吗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T20:12:27.307

1.  `(`第一个和最后一个之间的子字符串`)`
2.  拆分`", "`，您将获得 String[] 数组，其中包含类似的对`"-79.0578544444577 43.0929133770364","-79.0559554404751 43.0929995585932",...`
3.  现在您可以在每一对上用空格分割`" "`以获得另一个 String[] 数组，这次包含`"-79.0578544444577", "43.0929133770364"`

* * *

您还可以使用正则表达式以 [可选`-`][一位或两位数][点][多于一位数] 形式查找数字。这种模式看起来像`"-?\\d{1,2}[.]\\d+"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T20:21:22.437

```
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class Coordinates {
   static class LatLon {
      double lat;
      double lon;
      public LatLon( double lat, double lon ) {
         this.lat = lat;
         this.lon = lon;
      }
      @Override public String toString(){ return lat + ", " + lon; }
   }
   public static void main( String[] args ){
      String info =
         "LINESTRING (" +
            "-79.0578544444577 43.0929133770364, " +
            "-79.0559554404751 43.0929995585932, " +
            "-79.0540564364926 43.09308574015, " +
            "-79.0504086322323 43.0931797561892, " +
            "-79.0503228015438 43.0911427096913)";
      Pattern p = Pattern.compile( "[^\\(]+\\(([^\\)]+).*" );
      Matcher m = p.matcher( info );
      if( m.matches()) {
         List< LatLon > coordinates = new java.util.LinkedList<>();
         String[] coords = m.group( 1 ).split( "," );
         for( int i = 0; i < coords.length; ++i ) {
            String[] latLon = coords[i].trim().split( " " );
            coordinates.add(
               new LatLon(
                  Double.parseDouble( latLon[0] ),
                  Double.parseDouble( latLon[1] )));
         }
         System.out.println( coordinates );
      }
   }
} 
```

输出：

```
[-79.0578544444577, 43.0929133770364, -79.0559554404751, 43.0929995585932, -79.0540564364926, 43.09308574015, -79.0504086322323, 43.0931797561892, -79.0503228015438, 43.0911427096913] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T20:16:05.473

如果您很高兴将它们全部放在一个数组中：

```
String str = "LINESTRING (-79.0578544444577 43.0929133770364, -79.0559554404751 43.0929995585932, -79.0540564364926 43.09308574015, -79.0504086322323 43.0931797561892, -79.0503228015438 43.0911427096913)";
String[] arr = str.split("\\(|\\)")[1].split(",? ");
for (String s: arr)
   System.out.println(a); 
```

`split("\\(|\\)")``(`表示在或上分割`)`。所以那将是`{"LINESTRING ", "-79...", ""}`。

`[1]`因为这是包含 的位置`"-79..."`。

`split(",? ")`表示拆分`,`后跟一个空格或只是一个空格。

如果要成对提取坐标：

```
for (int i = 0; i < arr.length; i += 2)
{
   System.out.println("coordinate 1 = "+arr[i]);
   System.out.println("coordinate 2 = "+arr[i+1]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T20:14:30.293

尝试这个：

```
String[] coordinates = LINESTRING.split(",*\\s+"); 
```

这应该立即用空格和逗号分开。此正则表达式查找零个或多个逗号，然后查找一个或多个空白字符作为分隔符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-06T20:11:22.047

如果 LineString 是您的变量的名称，而括号内是它的值（不包括括号），则：

```
String[] coords = LINESTRING.split(" "); 
```

应该管用 ！

# shopify - Shopify：将搜索查询字符串传递给着陆页搜索功能？

> ID：15256936
> 
> 赞同：0
> 
> 时间：2013-03-06T20:06:18.403
> 
> 标签：shopify, liquid, google-ads-api

我目前正在为一家千篇一律的公司管理一个 Google AdWords 帐户，并且想出了一个想法来从我们的广告系列登陆页面中获得最有效的转化，但这需要一些我目前没有的技术知识过多的。

这是我的想法：

在 AdWords 中，您可以为您拥有的每个广告创建目标网页，这应该是与触发广告的搜索词最相关的网页。这很好，除非您有几千种产品要销售。我做了很多研究，了解到您可以通过查看 URL 来找到用户的确切搜索词。这很简单，但我想动态/自动执行此操作，我相信在此链接中对此进行了描述：

[http://www.quickr.org/PHP_function_to_get_search_engine_referral_keywords](http://www.quickr.org/PHP_function_to_get_search_engine_referral_keywords)

例如，一个 AdWord 链接如下所示：

[http://www.google.com/aclk](http://www.google.com/aclk)？... &q=梅森+罐子+饼干+切割机

我希望将术语“mason jar cookie切割器”推送到网站的搜索功能，该功能将采用该字符串并在页面加载或其他内容时自动搜索该术语。如果这个过程需要几秒钟以上的时间来完成，我希望有某种启动/加载屏幕，就像旅游网站搜索或加载您的查询时出现的那样。我想要这个，因为它会减少人们从网站反弹，因为它看起来像一些过程正在发生。

从理论上讲，这将有效地为每个客户提供一个独特且相关的登录页面，该页面已经具有他们所需术语的搜索结果，该搜索结果来自他们最初的谷歌搜索。

我不熟悉 Shopify 平台以及除了 Liquid 语言之外支持或不支持的语言。我尝试搜索，但找不到明确的答案

这是我在这个网站上的第一个问题，看起来你们拥有一个令人难以置信的聪明和有天赋的用户社区。我将不胜感激有关此事的任何和所有意见，以及任何改进我的问题的建议。

谢谢！

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-04-30T07:16:55.370

**嗨用户2121180。**

我找到了您的帖子，因为我搜索了：*“使用查询字符串构建 adwords 登录页面”*

现在这会生成以下格式的 SERPS URL：

https://www.google.com /search?num=100&client=firefox-a&hs=DhQ&rls=org.mozilla%3Ade%3Aofficial&q=build+adwords+landing+pages+with+query+string&oq=build+adwords+landing+ pages+with+query+string&gs_l=serp.3...0.0.0.202035.0.0.0.0.0.0.0.0..0.0...0.0...1c..11.serp.LyoL9Ab_xz8

一旦我点击了一个 Adwords 按钮，然后在我的浏览器中返回（历史（-1）），如果我再次将鼠标悬停在同一个广告上，我可以看到以下链接。所以基本上这就是链接，一旦我点击广告就会被调用....

http: //www.google.com /aclk?sa=l&ai=CqAWQsGx_UYT5IeWS0wWUtoD4C-_r0v4Cp52RkVG34uzdBAgAEAIgtlQoA1DH74CFB2CV-vCBjAegAdmK6OMDyAEBqQITlu9gnbWSPqoEKE_QkMDqa8IZvHQjiFZUuCqr5yMmiWaTIsfVTTDRYZp-E8Y5bN5NhTOABZBOgAeP9Zcc&sig=AOD64_023WkGcg-Uze3A72XOc-cNmor6nA&ved=0CDcQ0Qw&adurl=http: //lp1.pagewiz.com/Zielseiten%3Fcmp%3Dggl282812%26t% 3D301%26cmpn%3Dgermany&rct=j&q=build+adwords+landing+pages+with+query+string

或者或者这个链接：

http: //www.google.com /aclk?sa=l&ai=CUOQGxm1_UcqoEOWS0wWUtoD4C9ep8HeVq4CbNMeuu7oBEAIoCFCF7Ivo-f___ *8BYJX68IGMB6AB-bT* _gPIAQGpAggSgG2w-LU-qgQoT9BTixgE7SyYVxCD9P4-g3Jf-EyWFbWU69IRBNoqGkKhGdWJSx4siIAH78qAAQ&num=5&sig=AOD64_0O6ikX0qnkP6MFTu5zakOWARSaWg&ved=0CNoHENEM&adurl=http: //www.gandke.de/google- adwords-optimieren.html&rct=j&q=build+adwords+landing+pages+with+query+string

把它归结为

http://www.google.com /aclk?sa=l&q=build+adwords+landing+pages+with+query+string

这意味着一个简单的 PHP

```
if isset ($_GET['q']) {
  $myvar = $_GET['q'];
} 
```

或者

```
if isset ($_POST['q']) {
  $myvar = $_POST['q'];
} 
```

会做的工作。然后你可以使用这个 $myvar 并做很多有趣的事情：在你的标题中像

```
<html>
<head>
<title><?php echo($myvar); ?> - YOUR COMPANY NAME</title>
<meta name="description" content="<?php echo($myvar); ?>, some more descriptive text" />
<meta name="keywords" content="<?php echo($myvar); ?>, other,keywords,and,more" />
</head>
<body>
<h1>Are you looking for <?php echo($myvar); ?>?</h1>
<p>
Lorem Ipsum dolor etc otherwise do dang dung peng pong. Lorem Ipsum dolor etc otherwise do dang dung peng pong. Lorem Ipsum dolor etc otherwise do dang dung peng pong. Lorem Ipsum dolor etc otherwise do dang dung peng pong. 
</p>
<h3>Your solution for <?php echo($myvar); ?>?</h3>
<p>
Lorem Ipsum dolor etc otherwise do dang dung peng pong. etc...
</p>
</body>
</html> 
```

# ruby-on-rails - rake:test 不在子目录中运行自定义测试

> ID：15256938
> 
> 赞同：8
> 
> 时间：2013-03-06T20:06:23.893
> 
> 标签：ruby-on-rails, testing, testunit, ruby-on-rails-4

我正在使用 Rails 4.0.0.beta1。我添加了两个目录：`app/services`和`test/services`.

我还添加了这段代码，基于阅读[test.rake of railties](https://github.com/rails/rails/blob/v4.0.0.beta1/railties/lib/rails/test_unit/testing.rake)：

```
namespace :test do
  Rake::TestTask.new(services: "test:prepare") do |t|
    t.libs << "test"
    t.pattern = 'test/services/**/*_test.rb'
  end
end 
```

我发现在;中`rake test:services`运行测试 `test/services`但是，`rake test`不会运行这些测试。看起来*应该*；这是[代码](https://github.com/rails/rails/blob/v4.0.0.beta1/railties/lib/rails/test_unit/testing.rake#L75)：

```
Rake::TestTask.new(:all) do |t|
  t.libs << "test"
  t.pattern = "test/**/*_test.rb"
end 
```

我忽略了什么吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-06T21:00:15.527

在您的测试任务定义之后添加这样的一行：

```
Rake::Task[:test].enhance { Rake::Task["test:services"].invoke } 
```

我不知道为什么它们没有自动被拾取，但这是我发现的唯一适用于 Test::Unit 的解决方案。

我认为，如果您要运行`rake test:all`它，它将运行您的其他测试，但`rake test`如果没有上面的代码段，它就不会单独运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-25T13:52:50.640

对于那些使用更新的 Rails 版本（在我的例子中是 4.1.0）的人

使用`Rails::TestTask`代替`Rake::TestTask`和覆盖`run`任务：

```
namespace :test do
  task :run => ['test:units', 'test:functionals', 'test:generators', 'test:integration', 'test:services']
  Rails::TestTask.new(services: "test:prepare") do |t|
    t.pattern = 'test/services/**/*_test.rb'
  end
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-24T18:29:30.213

Jim 的解决方案有效，但是它最终将额外的测试套件作为单独的任务而不是作为整体的一部分运行（至少使用 Rails 4.1 是这样）。因此，测试统计信息会运行两次而不是汇总。我觉得这不是这里想要的行为。

这就是我最终解决这个问题的方式（使用 Rails 4.1.1）

```
# Add additional test suite definitions to the default test task here

namespace :test do
  Rails::TestTask.new(extras: "test:prepare") do |t|
    t.pattern = 'test/extras/**/*_test.rb'
  end
end

Rake::Task[:test].enhance ['test:extras'] 
```

`test:extras`通过简单地将新任务包含在由`rake test`默认执行的任务集中，这会导致完全预期的行为`rake`。您可以使用这种方法以这种方式添加任意数量的新测试套件。

如果您使用的是 Rails 3，我相信只需更改为`Rake::TestTask`对您有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-15T01:26:10.907

或者干脆跑`rake test:all`

如果要默认运行所有测试，请覆盖测试任务：

```
namespace :test do
  task run: ['test:all']
end 
```

# ruby - 在 Ruby 中，我如何实现一个类，它的新方法会创建它自己的子类？

> ID：15256940
> 
> 赞同：2
> 
> 时间：2013-03-06T20:06:27.317
> 
> 标签：ruby

在 Ruby 中，`Struct`类的`new`方法会创建一个子类，该子类的`Struct`行为会根据传递给它的参数而有所不同。如何在 Ruby 中对我自己的类做类似的事情？（我只会复制`Struct`的源代码，但它是用 C 编写的。）

```
irb(main):001:0> Foo = Struct.new(:foo, :bar)
=> Foo
irb(main):002:0> x = Foo.new
=> #<struct Foo foo=nil, bar=nil>
irb(main):003:0> Foo.superclass
=> Struct 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:11:25.553

```
class A
  def self.new; Class.new(self) end
end

A.new # => #<Class:0x007f009b8e4200> 
```

**编辑**这可能更符合 OP 的意图。

```
class A
  singleton_class.class_eval{alias :old_new :new}
  def self.new
    Class.new(self){singleton_class.class_eval{alias :new :old_new}}
  end
end 
```

# javascript - 如何在 Rails 资产管道中使用我的 Jquery 插件？

> ID：15256942
> 
> 赞同：0
> 
> 时间：2013-03-06T20:06:29.970
> 
> 标签：javascript, ruby-on-rails, jquery-plugins, ruby-on-rails-3.2, asset-pipeline

我的公司介绍了一种使用社交分享按钮的方法，无需在页面加载时向社交网站提供跟踪数据：[jquery.socialshareprivacy](http://www.heise.de/extras/socialshareprivacy/)。

如何在 Rails 3.2 资产管道中使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:06:29.970

该插件由一个 JS 文件和一个包含 css 和图像的目录组成。

Rails 3.2 带有 jQ​​uery 1.9.x 和`jquery.socialshareprivacy.js`uses 函数，在 1.9 ( `.live $.browser`) 中删除，所以你必须修补它（[首先](https://gist.github.com/mameier/5099718)获取补丁）使用资产管道需要为图像使用不同的文件路径，所以我修补了CSS（见[第二个要点](https://gist.github.com/mameier/5102433)）并将其转换为 SCSS（附加`.scss`到文件名）。
我基本上变成了`url()`三个`image-url()`。

我把 JS`vendor/assets/javascripts`和整个 CSS+images 文件夹（socialshareprivacy）放在下面`vendor/assets/stylesheets`

当我将共享按钮放在页面上时（请参阅[本文档](http://www.heise.de/extras/socialshareprivacy/)），我在选项中设置了图像 url：

```
<div id="socialshareprivacy"></div>
<script type="text/javascript">
    $(function(){
        $('#socialshareprivacy').socialSharePrivacy({
            'css_path': '<%= asset_path 'socialshareprivacy/socialshareprivacy.css' %>',
            services: {
                facebook: {dummy_img: '<%= asset_path 'socialshareprivacy/images/dummy_facebook.png' %>'},
                twitter: {dummy_img: '<%= asset_path 'socialshareprivacy/images/dummy_twitter.png' %>'},
                gplus: {dummy_img: '<%= asset_path 'socialshareprivacy/images/dummy_gplus.png' %>'}
            }
        });
    });
</script> 
```

如果您在多个地方需要它，请考虑将其转换为部分。

# php - 如何诊断缓慢的 php 图像代理？

> ID：15256946
> 
> 赞同：2
> 
> 时间：2013-03-06T20:06:44.830
> 
> 标签：php, proxy, nginx

我的网站上有一个图像代理，它在我的域的 https 上提供图像，以允许完全信任 SSL 连接。

以这个链接为例：

[https://www.mylesgray.com/lastfm/85982517.png](https://www.mylesgray.com/lastfm/85982517.png)

这通过我的域上的 HTTPS 提供来自 last.fm 的 CDN 的专辑插图，该 CDN 在 HTTP 上。

然而，它长期缓慢，我不知道为什么，它正在访问的页面是：

[http://userserve-ak.last.fm/serve/64s/85982517.png](http://userserve-ak.last.fm/serve/64s/85982517.png)

如您所见，速度差异很大，虽然我不知道为什么我的脚本这么慢，但它的操作非常简单：

```
$args = $_GET['q'];
list($img) = explode("/", $args);

header('Content-Type: image/png');
echo file_get_contents('http://userserve-ak.last.fm/serve/64s/' . $img); 
```

它所做的只是抓取图像并重新提供它。

有什么方法可以在整个堆栈的哪个阶段（从 Web 服务器到 php 脚本）进行调试，导致速度如此缓慢？

当您比较这两个页面时，您可以看到它的效果：

[https://mylesgray.com](https://mylesgray.com)

[https://mylesgray.com/blog](https://mylesgray.com/blog)

第二个使用代理来提供图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:13:48.143

由于您的网络服务器存在访问 CDN 的问题，因此它们可能会限制您，或者您的网络服务器上存在 DNS 解析问题。

因此，您的网络服务器必须等待某些 DNS 请求超时才能向另一台服务器发出另一个 DNS 请求以获得答案……这需要很长时间。

祝你的项目好运。

# visual-studio-2010 - 可以保存visual studio pro prj，以便免费版本的visual studio 可以读取它吗？

> ID：15256950
> 
> 赞同：1
> 
> 时间：2013-03-06T20:06:58.493
> 
> 标签：visual-studio-2010

可以保存 Visual Studio Pro 2010 项目以便免费版本的 Visual Studio 可以读取它吗？

我在工作和部分在家写作，我的家庭系统有一个免费版本，我的一所大学也将使用免费版本。有时我需要专业版，当免费版本无法完成时，但并非我所有的项目都是这样，我开始喜欢专业版，所以我想知道是否有可能以免费 2010 版的格式保存可以理解（用于C#和C++分离的项目）

请注意，这些项目不是 C# 和 C++ 在一个项目中的组合

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:19:14.533

如果您不使用免费版本中没有的任何功能，则 .sln 和 .xxproj 文件是兼容的。

例如在 VS 2010 中，免费版本不能在同一个 .sln 中混合 C# 和 C++。对于 C++，配置文件引导优化不可用。可能还有更多示例，但首先想到的是这些。

如果你选择 VS 2012，新的桌面版允许混合 C# 和 C++。

# facebook - 脸书上的照片是否真的从脸书数据库中删除过？

> ID：15256952
> 
> 赞同：-1
> 
> 时间：2013-03-06T20:06:59.737
> 
> 标签：facebook, image

如果我从 Facebook 删除照片，链接是否仍然有效？如果删除了某些照片，但我仍然有链接（可能在 JSON 文件中），我能否根据保存在我的 JSON 文件中的链接再次发布照片？Facebook 上的照片和视频也会保留其地址，还是会随着时间的推移而更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T20:13:05.010

根据 2012 年 8 月 16 日的这篇 Ars Technica 文章：

[http://arstechnica.com/business/2012/08/facebook-finally-changes-photo-deletion-policy-after-3-years-of-reporting/](http://arstechnica.com/business/2012/08/facebook-finally-changes-photo-deletion-policy-after-3-years-of-reporting/)

三年后，删除您在 Facebook 上的照片现在确实有效 经过多年的照片囤积，Facebook 现在可以在 30 天内删除用户照片。

我敢肯定，如果你想跟进写这个故事的记者，她会回应的。她的页面位于：http: [//arstechnica.com/author/jacqui-cheng/](http://arstechnica.com/author/jacqui-cheng/)

# iphone - 使用 YouTube API 提取 YouTube 视频链接

> ID：15256965
> 
> 赞同：0
> 
> 时间：2013-03-06T20:07:39.633
> 
> 标签：iphone, ios, youtube-api

我开发了一个应用程序来加载用户的视频，当他们点击表格视图中的单元格时，它会转到另一个包含一堆不同信息的视图控制器。

我正在尝试从特定视频中提取实际的 YouTube 链接。我打印出我得到的链接，它们以这种形式出现。

**[https://www.youtube.com/v/Xf5pXlZJr1U?version=3&f=user_uploads&app=youtube_gdata](https://www.youtube.com/v/Xf5pXlZJr1U?version=3&f=user_uploads&app=youtube_gdata)**

但我希望它是这种形式。

**[http://www.youtube.com/watch?v=Xf5pXlZJr1U](http://www.youtube.com/watch?v=Xf5pXlZJr1U)**

原因是我希望人们通过社交媒体分享链接，但是当它采用第一种格式时会显得很奇怪。

有什么方法可以轻松转换链接？

* * *

示例代码和答案编辑

```
GDataEntryBase *entry2 = [[feed entries] objectAtIndex:indexPath.row];
NSString *title = [[entry2 title] stringValue];
NSArray *contents = [[(GDataEntryYouTubeVideo *)entry2 mediaGroup] mediaContents];
GDataMediaContent *flashContent = [GDataUtilities firstObjectFromArray:contents withValue:@"application/x-shockwave-flash" forKeyPath:@"type"];
NSString *tempURL = [flashContent URLString];

NSArray *thumbnails = [[(GDataEntryYouTubeVideo *)entry2 mediaGroup] mediaThumbnails];
NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:[[thumbnails objectAtIndex:0] URLString]]];
UIImage *image = [UIImage imageWithData:data];

GDataYouTubeMediaGroup *mediaGroup = [(GDataEntryYouTubeVideo *)entry2 mediaGroup];
GDataMediaDescription *desc2 = [mediaGroup mediaDescription];
NSString *mystring = [desc2 stringValue];

NSArray *listItems = [tempURL componentsSeparatedByString:@"/"];
NSString *NewURL = @"";

NewURL = [NewURL stringByAppendingString:[listItems objectAtIndex:0]];
NewURL = [NewURL stringByAppendingString:@"//"];
NewURL = [NewURL stringByAppendingString:[listItems objectAtIndex:2]];
NewURL = [NewURL stringByAppendingString:@"/"];
NewURL = [NewURL stringByAppendingString:@"watch"];
NewURL = [NewURL stringByAppendingString:@"?v="];

NSArray *listItems2 = [[listItems objectAtIndex:4] componentsSeparatedByString:@"?"];    
NewURL = [NewURL stringByAppendingString:[listItems2 objectAtIndex:0]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:12:14.620

如果您查看[NSString](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)文档，那么您会发现许多有用的方法供您自己使用，例如**`componentsSeparatedByString`** ，根据某些特定字符将字符串分成两个不同的块 ，并将字符串**`stringByAppendingString`**附加到现有字符串。这些方法使用起来并不难，根据自己的需要使用即可。

# appfabric-cache - 本地机器上的 httpruntime.cache 和服务器上的 appfabric 缓存

> ID：15256967
> 
> 赞同：0
> 
> 时间：2013-03-06T20:07:54.907
> 
> 标签：appfabric-cache, httpruntime.cache

任何人都可以帮助我开发一个缓存体系结构，我可以在使用 localmachine（用于开发目的）时使用 httpruntime.cache 并在应用程序在服务器上运行时使用 appfabric 缓存吗？

我目前已经实现了 appfabric 代码。我知道需要逻辑来识别本地机器的使用情况并将缓存机制切换到 httpruntime.cache ...

提前感谢所有大师...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T12:48:20.277

首先，您需要为所有旅游缓存提供者提供相同的通用客户端接口：Get、Put、Remove，......这并不难，您可以看看[Service Stack Caching](https://github.com/ServiceStack/ServiceStack/wiki/Caching)。

像 StructureMap 或 Unity 这样的 Ioc 框架将帮助您使用基于静态或动态测试的适当提供程序。

# javascript - 如何向 URL 添加参数，然后使用 Greasemonkey 重新加载页面？

> ID：15256977
> 
> 赞同：3
> 
> 时间：2013-03-06T20:08:19.973
> 
> 标签：javascript, dom, greasemonkey

如果您没有登录，Quora 网站会模糊其大部分内容。解决此问题的一种方法是在其 URL 中添加参数“?share=1”。我认为通过 Greasemonkey 执行此操作的步骤是：

0/ 存储当前 URL

1/ 检查参数是否已经存在。如果是，请打破。

2/如果不是，添加参数。

3/ 使用更新的 URL 重新加载。

它类似于[这个问题](https://stackoverflow.com/questions/10675049/greasemonkey-add-parameters-to-url)，但在我看来，这可以在没有正则表达式的情况下完成？我可能是错的。

这是我正在尝试使用的代码：

```
// ==UserScript==
// @name       Quora Share
// @namespace  kevmo.info
// @version    0.1
// @description  adds "?share=1" to URLS, i.e. let's you view full Quora content w/o being logged in.
// @include      https://*.quora.com/*
// @include      http://*quora.com/*
// @copyright  Creative Commons
// ==/UserScript==

var url = window.location.href;

if (url.indexOf("?share=1") !== -1){
    break;
}
else{
    url +="?share=1";
    window.location.replace(url)
} 
```

注意：在“设置”中，我将脚本设置为在文档开始时运行。

我知道这种基本方法不适用于其他网站，但仅附加“？share = 1”*应该*适用于 Quora（请参阅：[http](http://blog.quora.com/Making-Sharing-Better) ://blog.quora.com/Making-Sharing-Better ）

当我访问[http://www.quora.com/Animals/What-are-some-mind-blowing-facts-from-the-animal-kingdom](http://www.quora.com/Animals/What-are-some-mind-blowing-facts-from-the-animal-kingdom)时，页面不会重新加载带有添加参数的所需新 URL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T22:20:15.757

**元编辑：**您正在使用“break;” 而不是循环结构。

```
 function share_redirect() {
    var new_url = false;

    if (window.location.hash.length === 0  && window.location.search.lenth === 0) {
         new_url = window.location.href+"?share=1"
    } else {

         if (window.location.search.indexOf('share=1') != -1) {
             return false; // already sharing
         }

         if (window.location.search.length && window.location.hash.length) {

             new_url = window.location.href.split('#')[0]+"&share=1"+window.location.hash;
         } else if (window.location.search.length === 0 && window.location.hash.length) {
             new_url = window.location.href.split('#')[0]+"?share=1"+window.location.hash;
         } else {
             new_url = window.location.href+"&share=1";
         }
    }
    if (new_url) {
        window.location = new_url;
    }
} 
```

# android - 更新列表视图

> ID：15256981
> 
> 赞同：1
> 
> 时间：2013-03-06T20:08:28.710
> 
> 标签：android, android-listview, android-adapter

我正在开发一个使用 a 的程序，`ListView`其中包含用户输入的字符串。我希望它在用户单击按钮后列出每个字符串。此外，我希望在 中显示的每个字符串值`ListView`也都在一个数组中，以便我以后可以操作该列表。这就是我现在所拥有的：

```
public ArrayList<String> choices = new ArrayList<String>();
public String[] choicesArray;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    final ListView listView = (ListView) findViewById(R.id.listView1);
    choicesArray = new String[] { "You have not entered a choice yet" };
    final ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, android.R.id.text1,
            choicesArray);
    listView.setAdapter(adapter);

    final Button addButton = (Button) findViewById(R.id.Button1);
    addButton.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            EditText editText = (EditText) findViewById(R.id.edit_choice);
            String message = editText.getText().toString();
            adapter.add(message);

            //choices.add(message);
            //choicesArray = choices.toArray(choicesArray);

            //listView.setAdapter(adapter);
        }
    });
} 
```

此代码会产生错误：

```
FATAL EXCEPTION: main
java.lang.UnsupportedOperationException
at java.util.AbstractList.add(AbstractList.java:404)
at java.util.AbstractList.add(AbstractList.java:425)
at android.widget.ArrayAdapter.add(ArrayAdapter.java:179)
at MainActivity$1.onClick(MainActivity.java:38) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:02:59.787

您的列表未更新的原因是您从未将数据项添加到适配器。您只是将它们添加到`choicesArray`您传递给 new ArrayAdapter() 构造函数的数组中。

该构造函数不会将适配器绑定到数组，而是基本上将数组复制到适配器中（在您调用构造函数时） 此后对数组所做的更改将不会反映在 ArrayAdapter 中。

我喜欢认为 ArrayAdapter<> 与 ArrayList<> 基本相同，另外还可以为某些 AdpaterView 父级生成子视图。您可以将它传递`array[]`给开头，它会使用该数组中的值初始化自身，但它不会将数组链接到适配器或 ListView。在初始构造函数调用之后，对任何一个的任何更改都不会反映在另一个中。

因此，您应该将代码更改为如下所示：

```
addButton.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {
        EditText editText = (EditText) findViewById(R.id.edit_choice);
        String message = editText.getText().toString();
        adapter.add(message);

        //adapter.notifyDataSetChanged(); //<-- you might need to call this, but I think it might work without if you do it this way.
        //listView.setAdapter(adapter); //<-- you shouldn't need to call this each time. Once at the begining is enough.
    }
}); 
```

**编辑：**

更改您的 ArrayAdapter 构造函数并删除choiceArray 参数，因此您应该保留以下内容：

```
final ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
        android.R.layout.simple_list_item_1, android.R.id.text1); 
```

在那之后，我认为你应该好好去。本质上问题在于，由于您传入了一个数组，并且由于数组的大小是固定的（您的长度为 1），因此不允许您添加任何内容。我怀疑您可能可以根据需要使用 an`ArrayList<String>`而不是`String[]`，但老实说，对于您的情况，我认为在需要添加新参数时直接跳过该参数并直接将项目添加到适配器会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:11:07.997

将新的添加`String`到您的列表后，您只需使用`notifyDataSetChanged()`您的适配器，它告诉适配器更新显示，它将`ListView`使用新字符串更新

```
addButton.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {

        EditText editText = (EditText) findViewById(R.id.edit_choice);
        String message = editText.getText().toString();
        choices.add(message);
        choicesArray = choices.toArray(choicesArray);

        adapter.notifyDataSetChanged();

    }
}); 
```

**更新**

您也应该考虑进行此更改

```
choicesArray = new String[choices.size()];
choicesArray = choices.toArray(choicesArray); 
```

# ruby-on-rails-3 - 重构后 RoR、RSpec 测试失败

> ID：15256983
> 
> 赞同：0
> 
> 时间：2013-03-06T20:08:31.347
> 
> 标签：ruby-on-rails-3, rspec, railstutorial.org, renderpartial

我是编程新手，在 Hartl 的 Ruby on Rails 3 教程中无法找出预期的错误。在重构了一些布局页面后，我在似乎是 {visit signup_path} 的地方经常出现错误。

这是我所做的部分重构：

_fields 部分：

```
<%= render 'shared/error_messages' %>
<%= f.label :name %>
<%= f.text_field :name %>

<%= f.label :email %>
<%= f.text_field :email %>

<%= f.label :password %>
<%= f.password_field :password %>

<%= f.label :password_confirmation, "Confirm Password" %>
<%= f.password_field :password_confirmation %> 
```

在 new.html.erb 上：

```
<% provide(:title, 'Sign up') %>
<h1>Sign up</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_for(@user) do |f| %>
      <%= render 'fields', f: f %>
      <%= f.submit "Create my account", class: "btn btn-large btn-primary" %>
    <% end %>
  </div>
</div> 
```

在 edit.html.erb 上

```
<% provide(:title, "Edit user") %> 
<h1>Update your profile</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_for(@user) do |f| %>
      <%= render 'fields', f: f %>
      <%= f.submit "Save changes", class: "btn btn-large btn-primary" %>
    <% end %>

    <%= gravatar_for @user %>
    <a href="http://gravatar.com/emails" target="_blank">change</a>
</div> 
```

以及导致 20 次失败的测试规范：

```
require 'spec_helper'

describe "User pages" do

  subject { page }

  describe "index" do

    let(:user) { FactoryGirl.create(:user) }

    before do
      sign_in user
      visit users_path
    end

    it { should have_selector('title', text: 'All users') }
    it { should have_selector('h1',    text: 'All users') }

    describe "pagination" do

      before(:all) { 30.times { FactoryGirl.create(:user) } }
      after(:all)  { User.delete_all }

      it { should have_selector('div.pagination') }

      it "should list each user" do
        User.paginate(page: 1).each do |user|
          page.should have_selector('li', text: user.name)
        end
      end
    end

    describe "delete links" do

      it { should_not have_link('delete') }

      describe "as an admin user" do
        let(:admin) { FactoryGirl.create(:admin) }
        before do
          sign_in admin
          visit users_path
        end

        it { should have_link('delete', href: user_path(User.first)) }
        it "should be able to delete another user" do
          expect { click_link('delete') }.to change(User, :count).by(-1)
        end
        it { should_not have_link('delete', href: user_path(admin)) }
      end
    end
  end

  describe "signup page" do
    before { visit signup_path }

    it { should have_selector('h1',    text: 'Sign up') }
    it { should have_selector('title', text: full_title('Sign up')) }
  end

  describe "profile page" do
  let(:user) { FactoryGirl.create(:user) }
  before { visit user_path(user) }

  it { should have_selector('h1',    text: user.name) }
  it { should have_selector('title', text: user.name) }
  end

  describe "signup" do

    before { visit signup_path }

    let(:submit) { "Create my account" }

    describe "with invalid information" do
      it "should not create a user" do
        expect { click_button submit }.not_to change(User, :count)
      end
      describe "after submission" do
        before { click_button submit }

        it { should have_selector('title', text: 'Sign up') }
        it { should have_content('error') }
      end
    end

    describe "with valid information" do
      before do
        fill_in "Name",         with: "Example User"
        fill_in "Email",        with: "user@example.com"
        fill_in "Password",     with: "foobar"
        fill_in "Confirmation", with: "foobar"
      end
      describe "after saving the user" do
        before { click_button submit }
        let(:user) { User.find_by_email('user@example.com') }

        it { should have_selector('title', text: user.name) }
        it { should have_selector('div.alert.alert-success', text: 'Welcome') }
        it { should have_link('Sign out') }
      end

      it "should create a user" do
        expect { click_button submit }.to change(User, :count).by(1)
      end
    end
  end

  describe "edit" do
    let(:user) { FactoryGirl.create(:user) }
    before do
      visit signup_path
      sign_in user
      visit edit_user_path(user)
    end

    describe "page" do
      it { should have_selector('h1',    text: "Update your profile") }
      it { should have_selector('title', text: "Edit user") }
      it { should have_link('change', href: 'http://gravatar.com/emails') }
    end

    describe "with invalid information" do
      before { click_button "Save changes" }

      it { should have_content('error') }
    end

    describe "with valid information" do
      let(:new_name)  { "New Name" }
      let(:new_email) { "new@example.com" }
      before do
        fill_in "Name",             with: new_name
        fill_in "Email",            with: new_email
        fill_in "Password",         with: user.password
        fill_in "Confirm Password", with: user.password
        click_button "Save changes"
      end

      it { should have_selector('title', text: new_name) }
      it { should have_selector('div.alert.alert-success') }
      it { should have_link('Sign out', href: signout_path) }
      specify { user.reload.name.should  == new_name }
      specify { user.reload.email.should == new_email }
    end
  end
end 
```

以及运行 bundle exec rspec spec/ 后的终端输出

```
Failures:

  1) User pages edit with valid information 
     Failure/Error: visit signup_path
     ActionView::Template::Error:
       /Users/ajorczak/rails_projects/sample_app/app/views/users/_fields.html.erb:14: syntax error, unexpected keyword_ensure, expecting $end
     # <internal:prelude>:10:in `synchronize'
     # ./app/views/users/new.html.erb:7:in `block in _app_views_users_new_html_erb__3426326572903275614_70133147147220'
     # ./app/views/users/new.html.erb:6:in `_app_views_users_new_html_erb__3426326572903275614_70133147147220'
     # ./spec/requests/user_pages_spec.rb:111:in `block (3 levels) in <top (required)>'

  2) User pages edit with valid information 
     Failure/Error: visit signup_path
     ActionView::Template::Error:
       /Users/ajorczak/rails_projects/sample_app/app/views/users/_fields.html.erb:14: syntax         error, unexpected keyword_ensure, expecting $end
     # <internal:prelude>:10:in `synchronize'
     # ./app/views/users/new.html.erb:7:in `block in _app_views_users_new_html_erb__3426326572903275614_70133147147220'
     # ./app/views/users/new.html.erb:6:in `_app_views_users_new_html_erb__3426326572903275614_70133147147220'
     # ./spec/requests/user_pages_spec.rb:111:in `block (3 levels) in <top (required)>' 
```

等等。我没有列出每个错误，因为我确信（Hartl 说这是预期的）这是测试文档中的相同错误。谁能给我一些指导？

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:02:18.157

不知道我做了什么来解决这个问题，但它似乎是其他领域的一些语法错误。虽然找到了解决方案；文本从“确认”更改为“确认密码”。感谢那些愿意看的人。我会标记为已解决。

# elasticsearch - 在 Pentaho ElasticSearch 更新运行期间进行搜索

> ID：15256989
> 
> 赞同：0
> 
> 时间：2013-03-06T20:09:00.547
> 
> 标签：elasticsearch, pentaho

我们正在使用 ES 从数据库中索引约 150 万条记录。为了填充索引，我们使用了 Pentaho ES 组件，该组件设置为“如果存在则覆盖”（运行约 15 分钟）。此外，可以通过 Java 服务检索、更新或删除单个索引文档。

问题是，在完整的 Pentaho 更新运行期间 ES 会返回什么？例如，我们有 150 万个版本为 1 的索引文档。下一次更新会将这个版本更改为 2。如果我们在 Pentaho 更新它时请求一个文档——我们会收到它的旧版本吗？该特定文件将无法提供服务吗？另外，如果我们收到旧版本，新版本会在更新后立即可用还是会等到全批次更新（pentaho 组件以 5k 为单位发送行）？

Pentaho - 4.4

弹性搜索 - 0.19.4

Lucene - 3.6.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T20:21:11.993

1.  如果新版本尚未提交，您将收到旧版本的文档。该服务将继续可用。
2.  新版本将根据`refresh_interval`elasticsearch 中的设置提供。这默认为每个`1s`.

pentaho 可能会`refresh_interval`在数据加载期间旋转。如果是这种情况，那么您将不得不等到 pentaho`refresh`直接调用该方法或直到它重置参数。

您可以简单地开始运行，然后检查通过的设置`refresh_interval`：

```
curl -XGET "http://my-es-server:9200/my-index-name/_settings" 
```

# ios - ALAsset GPS 元数据与 exif GPS 数据不匹配

> ID：15256993
> 
> 赞同：0
> 
> 时间：2013-03-06T20:09:12.173
> 
> 标签：ios, gps, latitude-longitude, exif, alasset

我正在更新我的应用程序以允许在使用 UIImagePickerControllerSourceTypeSavedPhotosAlbum 时将照片上传到包含 GPS 元数据。GPS 数据的准确性非常重要。我遇到了一个问题，即使用 ALAsset 派生的位置数据与我在 Photoshop 中打开同一张照片时可以看到的照片的实际 exif 数据不同。

我使用了两种方法来读取 xcode 中的 GPS 数据：

```
ALAssetsLibraryAssetForURLResultBlock resultblock = ^(ALAsset *myasset) {

CLLocation *location = [myasset valueForProperty:ALAssetPropertyLocation];

latitudeString = [NSString stringWithFormat:@"%g",point.latitude];

longitudeString = [NSString stringWithFormat:@"%g",point.longitude];

} 
```

和

```
ALAssetRepresentation *representation = [myasset defaultRepresentation];
NSDictionary *metadata = [representation metadata];

NSDictionary *gpsDict = [metadata objectForKey:@"{GPS}"];

NSNumber *latitudeNumber = [gpsDict objectForKey:@"Latitude"];

NSNumber *longitudeNumber = [gpsDict objectForKey:@"Longitude"];

if ([[gpsDict valueForKey:@"LatitudeRef"] isEqualToString:@"S"]) 
{

   //latitudeNumber = -latitudeNumber;
}

if ([[gpsDict valueForKey:@"LongitudeRef"] isEqualToString:@"W"])
 {

  //longitudeNumber = -longitudeNumber);

} 
```

在我使用的代表性照片上，上面的两组代码都给了我 47.576333 的纬度，它转换为 47,34,35N

如果我查看 Photoshop exif 数据 - 纬度是 47,34,59N

这些数字很接近——但它们并不相同。这发生在我没有大约 30% 的照片的情况下。知道为什么吗？

编辑 - 照相馆不给出秒数 - 它给出了 34.59 分钟，这确实是准确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T09:09:42.910

您的转换是错误的，Photoshop 更正确。

47.576333 (DEG) 转换为 47* 34.5799' (DM)。可以四舍五入到 47* 34.58
，这是 photoshop 明显显示的格式。

转换为 DMS，它会给出您的值：47* 34' 35" N。（请将所有“*”替换为度数符号。）

因此，您将 DMS（Degress Minutes Seconds）与 DM（Degrees Minutes）表示交换。

# c# - 设置根 XElement 的值而不影响子元素

> ID：15256994
> 
> 赞同：1
> 
> 时间：2013-03-06T20:09:16.007
> 
> 标签：c#, xml, .net-3.5, linq-to-xml

更新：我仍然有这个问题，更好的解释。

我有一个 XElement 列表，我正在遍历它们以检查它是否与正则表达式模式匹配。如果有匹配，我需要在不影响他的子元素的情况下替换当前元素的值。

例如，

```
<root>{REGEX:@Here}<child>Element</child> more content</root 
```

在这种情况下，我需要替换根元素下的 {REGEX:@Here} 而不是子元素！如果使用：

```
string newValue = xElement.ToString();
if(ReplaceRegex(ref newValue))
   xElement.ReplaceAll(newValue); 
```

我丢失了子元素，标签被转换为值中的 & lt;child & gt; 元素。如果我使用：

```
xElement.SetValue(newValue); 
```

xElement 的值将是，

```
"{REGEX:Replaced} Element more content" 
```

因此也会丢失子元素。

如果正则表达式模式位于根元素或子元素下，我该怎么做才能替换将保留子元素并起作用的值。

PS：我将在这里添加正则表达式功能以供理解

```
 private bool ReplaceRegex(ref string text)
    {
        bool match = false;
        Regex linkRegex = new Regex(@"\{XPath:.*?\}", System.Text.RegularExpressions.RegexOptions.Multiline);

        Match m = linkRegex.Match(text);

        while (m.Success)
        {
            match = true;
            string substring = m.Value;
            string xpath = substring.Replace("{XPath:", string.Empty).Replace("}", string.Empty);

            object temp = this.Container.Data.XPathEvaluate(xpath);

            text = text.Replace(substring, Utility.XPathResultToString(temp));

            m = m.NextMatch();
        }
        return match;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T21:05:09.260

```
private void ReplaceRegex(XElement xElement)
{
    if(xElement.HasElements)
    {
        foreach (XElement subElement in xElement.Elements())
            this.ReplaceRegex(subElement);
    }
    foreach(var node in xElement.Nodes().OfType<XText>())
    {
        string value = node.Value;
        if(this.ReplaceRegex(ref value))
            node.Value = value;
    }
} 
```

**编辑 ：**

关于您的混合内容评论，编辑代码以处理文本节点。看看它是否有效。

# java - 空错误 Java 迷宫求解器

> ID：15256998
> 
> 赞同：-1
> 
> 时间：2013-03-06T20:09:20.333
> 
> 标签：java, algorithm, nullpointerexception, maze

我有 2 个对象。一种称为 Cell，一种称为 FinalSolve。该程序的目的是通过遍历每个单元格寻找出口来解决迷宫问题。

单元格对象代表迷宫中的单元格，并具有 4 个实例变量、1 个构造函数和 4 个返回指定实例变量的其他实例方法。

```
 //the variables
    private int value;
    private int column;
    private int row;
    private char symbol;
    private int nuValue;

    //the methods
    public value()
    {
    return value
    } 
```

等等。我的迷宫对象包含 6 个实例方法，如下所示：

*   解决
*   标记路径

*   找邻居
*   findCellWithValue
*   设置值

他们有一个非常直截了当的名字，他们返回的正是我对他们的期望。

## 解决

这是使用算法并利用上面指定的所有方法尝试解决迷宫的方法

```
public void solve()
{
    Cell[] entrance = findCellWithValue(250);
    Cell[] neighborsOf = findNeighbors(entrance[0]);
    for(Cell neighbor : neighborsOf)
    {
        setTheValue(1, neighbor);
    }
    int moveCount = 1;
    boolean foundExit = false;
            try{
    while(!foundExit && moveCount <= 200)
    {
        Cell[] theCells = findCellWithValue(moveCount);
        for(Cell justOne : theCells)
        {
            if(justOne.symbol() == '!')
            {
                foundExit = true;
                markPath();
                                    break;
            }
            else
            {
                Cell[] moreNeighbors = findNeighbors(justOne);
                for(Cell prostie : moreNeighbors)
                {
                    if(prostie.value() == 0)
                    {
                    setTheValue(moveCount+1, prostie);
                    }
                }
            }

        }
        moveCount++;
    }
            }catch(Exception e)
            {
            System.out.println("" + moveCount);
            System.out.println("" + e.getMessage());
            }

} 
```

## 标记路径

一旦solve方法解决了程序，这个方法就会被调用，它会标记从出口到入口的路径。由于我在程序中遇到错误，此方法仍在进行中，它只打印“Hello”

```
public void markPath()
{
    System.out.println("Hello");
} 
```

## 找邻居

在迷宫中查找指定单元格的邻居（即空白）并将它们返回到数组中。

```
 public Cell[] findNeighbors(Cell theCell)
    {
        Cell[] neighborsCell = new Cell[1];
        int neighbors = 0;
        int column = theCell.column();
        int row = theCell.row();
                    if(column - 1 < 0);
                    else
                    {
                        char some = maze[column-1][row].symbol();
                        if(some == ' ')
                        {
                            if(neighbors == neighborsCell.length)
                            {
                                Cell[] biggerArray = new Cell[neighborsCell.length + 1];
                                System.arraycopy(neighborsCell, 0, biggerArray, 0, neighbors - 1);
                                neighborsCell = biggerArray;

                            }
                            neighborsCell[neighbors] = maze[column-1][row];
                        }
                    }
                    if(column + 1 > 20 );
                    else
                    {
                        char someElse = maze[column+1][row].symbol();
                        if(someElse == ' ')
                        {
                            if(neighbors == neighborsCell.length)
                            {
                                Cell[] biggerArray = new Cell[neighborsCell.length + 1];
                                System.arraycopy(neighborsCell, 0, biggerArray, 0, neighbors - 1);
                                neighborsCell = biggerArray;

                            }
                            neighborsCell[neighbors] = maze[column+1][row];

                        }
                    }
                    if(row - 1 < 0);
                    else
                    {
                        char someElse = maze[column][row-1].symbol();
                        if(someElse == ' ')
                        {
                            if(neighbors == neighborsCell.length)
                            {
                                Cell[] biggerArray = new Cell[neighborsCell.length + 1];
                                System.arraycopy(neighborsCell, 0, biggerArray, 0, neighbors - 1);
                                neighborsCell = biggerArray;

                            }
                            neighborsCell[neighbors] = maze[column][row-1];

                        }

                    }
                    if(row + 1 > 10);
                    else
                    {
                        char someElse = maze[column][row+1].symbol();
                        if(someElse == ' ')
                        {
                            if(neighbors == neighborsCell.length)
                            {
                                Cell[] biggerArray = new Cell[neighborsCell.length + 1];
                                System.arraycopy(neighborsCell, 0, biggerArray, 0, neighbors - 1);
                                neighborsCell = biggerArray;

                            }
                            neighborsCell[neighbors] = maze[column][row+1];

                        }

                    }

        return neighborsCell;
    } 
```

## 

覆盖默认的 toString 方法并返回从文件中读取时的迷宫

```
@Override
    public String toString()
    {
        String result = "";
        for(int row = 0; row < HEIGHT; row++)
        {
            for(int column = 0; column < WIDTH; column++) {
                            switch(maze[column][row].nuValue())
                            {
                            case HEDGE: result += HEDGE_REP; break;
                            case SPACE: result += SPACE_REP; break;
                            case ENTRANCE: result += ENTRANCE_REP; break;
                            case EXIT: result += EXIT_REP; break;

                            }
                        }//switch
                result += NLS;

        }//for
        return result;

    }//toString 
```

## findCellWithValue

循环整个迷宫以搜索具有作为参数的指定 int 值的单元格

```
 public Cell[] findCellWithValue(int theValue)
{
    int currentNoOfCells = 0;
    Cell[] theCells = new Cell[INITIAL_ARRAY_SIZE];
        for(int row = 0; row < HEIGHT; row++)
        {
            for(int column = 0; column < WIDTH; column++)
            {
                if(maze[column][row].value() == theValue)
                {
                    if(currentNoOfCells == theCells.length)
                    {
                        Cell[] biggerArray = new Cell[theCells.length + ARRAY_RESIZE_FACTOR];
                                            System.arraycopy(theCells, 0, biggerArray, 0, theCells.length);
                        theCells = biggerArray;

                    }
                    theCells[currentNoOfCells] = maze[column][row];
                    currentNoOfCells++;

                }

            }

        }
    return theCells;
} 
```

## 设置值

将单元格的值设置为作为参数给出的指定 int

```
public void setTheValue(int value, Cell someCell)
{
    int column = someCell.column();
    int row = someCell.row();
    char symbol = someCell.symbol();
    maze[column][row] = new Cell(column, row, symbol, value);
} 
```

我的解决方法中的 try and catch 语句纯粹是为了找出错误发生的原因和位置。当我得到 NullPointerException 时，它打印出 moveCount 为 6。

文件中的迷宫是一个 10 x 20 的矩形，周围有一个用“#”表示的树篱。空格表示为“”，退出为“！” 并通过“？”进入

也有人可能已经注意到，我的求解方法从找到 250 的单元格值开始。这是迷宫构造函数中给出的入口值，如下所示：

## 构造函数

```
 public FinalSolve(Scanner input)
    {

        for(int row = 0; row < HEIGHT; row++)
        {
            String mazeLine = input.nextLine();
            for(int column = 0; column < WIDTH; column++)
            {

                char character = mazeLine.charAt(column);
                switch(character)
                {
                case SPACE_REP:
                if(column == 7 && row == 7) 
                                    {
                maze[column][row] = new Cell(column, row, SPACE_REP, 20);
                                    }else{
                maze[column][row] = new Cell(column, row, SPACE_REP, 0);
                                    }

                break;

                case HEDGE_REP: maze[column][row] = new Cell(column, row, HEDGE_REP, 0);break;
                case ENTRANCE_REP: maze[column][row] = new Cell(column, row, ENTRANCE_REP, 250);break;
                case EXIT_REP: maze[column][row] = new Cell(column, row, EXIT_REP, 0);break;

                }//switch
            }//for
            }//for

        solve();            
        }//constructor 
```

## 错误

方法求解中的第 51 行。这一行：

```
 if(justOne.symbol() == '!') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T20:53:21.780

基于您提到的行的相关代码导致`NullPointerExpection`.

```
Cell[] theCells = (moveCount);
for(Cell justOne : theCells)
{
  if(justOne.symbol() == '!')
  ... 
```

这意味着这`justOne`是`null`出于某种原因。`justOne`包含数组中的值之一`theCells`。`theCells`来自目录`findCellWithValue()`。该数组被初始化为具有一些默认大小，并且仅在找到匹配项时分配。如果未找到匹配项，则数组中的每个元素都将包含`null`.

这意味着您需要做两件事之一。1）检查数组中的值是否`null`在处理它之前（并打破循环，因为您正在递增地添加值）。2) 不传回空值。

我个人认为 2 是更好的选择，因为它不会对该方法的用户提出额外的要求。`findCellWithValue()`被写入以便它根据需要增长数组。这正是`ArrayList`设计的目的。如果你使用它，你不会得到这种错误，它会简化你的代码。如果您的集合会增长或不能保证始终具有相同的大小，那么使用`List`.

编辑：
正如其他人指出的那样，您的问题很大。我解释了我是如何追踪问题的，以显示找到错误所需的很少。当您提出问题时，请尝试包含重现问题所需的最少代码量。如果出现异常，请始终包含错误消息**和**堆栈跟踪。应该清楚的是，类似的事情`markPath()`与`toString()`问题无关（除非在堆栈跟踪中提到它们，否则只有可能）。

# php - PHP：HTML 特殊字符的字符串格式错误（UTF8）

> ID：15256999
> 
> 赞同：0
> 
> 时间：2013-03-06T20:09:21.420
> 
> 标签：php, utf-8

我有一个从普通 JSON 提要中提取数据的 CURL 脚本。提要返回 html 代码，但特殊 html 字符的格式错误。

例如，我得到以下字符串：

★ 美丽的新图形 ★ 华丽的新有机环境 ★ 新的障碍

数据存储到数据库中，我也想存储特殊的 html 字符。

如何保留特殊的 html 字符。我的脚本如下：

```
$curl_session = curl_init();

curl_setopt($curl_session, CURLOPT_URL,'https://itunes.apple.com/lookup?id=572395608');
curl_setopt($curl_session, CURLOPT_CONNECTTIMEOUT,10); 
curl_setopt($curl_session, CURLOPT_TIMEOUT, 10);                
curl_setopt($curl_session, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl_session, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curl_session, CURLOPT_SSL_VERIFYPEER, 0);
$source = curl_exec($curl_session);

$source_decoded = json_decode($source, true);

print_r($source_decoded);
exit; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:02:40.700

您收到的字符是 UTF-8，因为这是 JSON 中唯一允许和可能的编码。

但是你输出它们不是 UTF-8。改变这个。发送一个内容类型标头，告诉客户端已使用哪种编码。或者将字符转换为您正在使用的编码，并冒丢失那些无法使用它编码的字符的风险。