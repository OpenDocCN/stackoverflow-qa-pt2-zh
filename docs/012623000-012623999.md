# StackOverflow 问答 12623000-12623999

# sql-server - SSRS 2012 图表未呈现

> ID：12623002
> 
> 赞同：4
> 
> 时间：2012-09-27T13:51:56.443
> 
> 标签：sql-server, reporting-services, sql-server-2012

我们最近升级到 SQL Server 2012，几天前重新启动后，我们所有的图表都停止工作了。

当我尝试从报表查看器控件查看它们时，各种报表中的所有图表现在都显示为左上角带有红色“x”的损坏图像。这在报表管理器和使用报表查看器控件显示报表的第三方应用程序中都会发生。在以附件 PDF 形式发送报告的报告订阅中，图表也会损坏。

但是，图表可以在我们的自定义 Web 应用程序中正常工作，这些应用程序不使用报表查看器控件——我们有代码可以将报表直接呈现为 pdf，并在 Web 浏览器中将它们显示为 PDF。

有谁知道可能导致问题的最近更新的任何问题？或者，有什么我应该添加到 web.config 中的吗？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T20:26:32.897

我能够通过从 SQL Server 安装程序运行修复操作来解决问题。我猜报表服务器已损坏。

# php - symfony：如何设置调用学说模型类时自动执行的属性和方法？

> ID：12623003
> 
> 赞同：1
> 
> 时间：2012-09-27T13:51:57.043
> 
> 标签：php, model, symfony1, doctrine, symfony-1.4

我想给一个Doctrine模型类添加一些属性和方法，这样每次创建这个类的实例时，自动设置一次属性，可以用相关的getter访问，但是这些值并没有存储在数据库，而是根据同一类的其他属性（这些属性存储在数据库中）计算得出。

例如，假设我在 schema.yml 中有这个类 MyModel：

```
MyModel:
  actAs:
    Timestampable: ~
  tableName: my_model
  columns:
    id:         { type: integer(8), primary: true, notnull: true, autoincrement: true }
    quantity:   { type: decimal(12), scale: 3, notnull: true }
    price:      { type: decimal(12), scale: 3, notnull: true } 
```

通常我需要知道总量，但我不想将其存储在数据库中：我可以这样做

```
class MyModel extends BaseMyModel
{
  public function getTotalAmount()
  {
    $this->total_amount = $this->getQuantity() * $this->getPrice(); 
  }    
} 
```

然后每次我需要知道总金额时，我就可以打电话给`$my_model->getTotalAmount()`.

但是，我想要这样的东西

```
class MyModel extends BaseMyModel
{
  public function setTotalAmount()
  {
    $this->total_amount = $this->getQuantity() * $this->getPrice(); 
  }

  public function getTotalAmount()
  {
    return $this->total_amount;
  }
} 
```

并且在创建 MyModel 类的新实例时，例如

```
$my_model = Doctrine_Core::getTable("MyModel")->find(1); 
```

我希望该`setTotalAmount()`函数自动执行，因此该`total_amount`值只计算一次，并且可以使用 来访问，`$my_model->getTotalAmount()`而不必在每次调用该函数时重新计算它。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:23:15.797

这是完全错误的：

```
class MyModel extends BaseMyModel
{
  public function setTotalAmount()
  {
    $this->total_amount = $this->getQuantity() * $this->getPrice(); 
  }

  public function getTotalAmount()
  {
    return $this->total_amount;
  }
} 
```

设置值意味着实际传递一个参数，并更新相关字段。即使您在水合时更新了此类值，但如果您稍后更改此类值并访问，该`getTotalAmount`怎么办？`setTotalAmount`每次更新任何东西时都应该打电话吗？没门。

```
class MyModel extends BaseMyModel
{
  public function getTotalAmount()
  {
    $this->total_amount = $this->getQuantity() * $this->getPrice(); 
  }    
} 
```

这是完全正确的——你得到一个基于两个存储值的值，具有最大的一致性。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-27T14:18:12.403

您可以[覆盖](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/working-with-models.html#overriding-the-constructor)对象的构造函数。所以它会是这样的：

```
class MyModel extends BaseMyModel
{
  private $total_amount = null;

  public function construct()
  {
    $this->setTotalAmount();
  }

  public function setTotalAmount()
  {
    $this->total_amount = $this->getQuantity() * $this->getPrice();
  }

  public function getTotalAmount()
  {
    if (null === $this->total_amount)
    {
      $this->setTotalAmount();
    }

    return $this->total_amount;
  }
} 
```

# jsf - 以 inputtext 作为参数的 primefaces 对话框

> ID：12623005
> 
> 赞同：2
> 
> 时间：2012-09-27T13:52:00.313
> 
> 标签：jsf, input, dialog, primefaces

我想将 inputText 的内容作为参数提供给支持 bean 中的函数，我知道我可以在支持 bean 中发送内容，但这在我的对象模型中没有多大意义。我知道在数据表中，您可以提供一个名为“var”的函数，我想我可以通过传递 inputText 的 ID 来使用相同的机制，但它总是发送 null。有没有办法做到这一点？

```
<p:dialog id="dialog" header="Reason for obsolescence" modal="true" widgetVar="dlg">  
    <h:form>  

       <h:panelGrid columns="2" cellpadding="5">  
           <h:outputLabel for="reason" value="Reason for obsolescence :" />  
           <p:inputText value="default"  id="reason" required="true" label="reason" />  

               <p:commandButton id="provideReason" value="Ok" update=":form:tabView:table-metadata"   
                   action="#{tableMetadataController.setSelectedObsolete(reason)}"   
                   oncomplete="dlg.hide()"/>  
       </h:panelGrid>  

    </h:form>  
</p:dialog> 
```

谢谢

# c# - 在 C# 中使用 Delphi 本机 dll（DllImport 问题）

> ID：12623008
> 
> 赞同：1
> 
> 时间：2012-09-27T13:52:03.320
> 
> 标签：c#, delphi, pinvoke

我在将 Delphi 本机 dll 导入 .net 时遇到问题。我得到*System.EntryPointNotFoundException*。

**这是我的delphi dll：**

```
procedure ProcedimientoEncriptar(texto,clave,resultado:PChar); export stdcall;
    var ...
    begin
    ....
    ....
    end;

    exports
      ProcedimientoEncriptar ; 
```

**这是我在 .Net (C#) 上的 DllImport 代码：**

```
[DllImport("CryptoDLL.dll", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Auto)]
        public static extern void ProcedimientoEncriptar([MarshalAs(UnmanagedType.LPStr)]string texto, [MarshalAs(UnmanagedType.LPStr)]string clave, [MarshalAs(UnmanagedType.LPStr)] StringBuilder resultado); 
```

任何帮助将不胜感激，迭戈。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:03:10.987

唯一的解释`System.EntryPointNotFoundException`是 C# 代码找到的 DLL 不是您显示的 Delphi 代码生成的 DLL。因此，也许 C# 代码正在获取 DLL 的过时版本。或者它可能正在选择一个完全不同的 DLL。

例如，我的系统有一个名为`cryptdll.dll`system32 目录的 DLL。这很可能是您的 C# 代码正在查找的 DLL。

为了确保找到正确的 DLL，您需要将 Delphi DLL 的副本放在与 C# 可执行文件相同的目录中。

# android - 如何解决平板电脑中的以下冲突？

> ID：12623009
> 
> 赞同：0
> 
> 时间：2012-09-27T13:52:09.023
> 
> 标签：android, tablet

我为手机和平板电脑开发了一个 Android 应用程序。它一直在两个模拟器中运行。当我在平板电脑模拟器中运行时，小部件的大小正在填满屏幕。我应该怎么做才能解决这个冲突？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T13:56:52.970

`res/layout`您可以在（用于手柄）和`res/layout-large`（用于平板电脑）中为手柄和平板电脑制作两种不同的布局。布局文件名必须相同。您可以在此处找到更多解释和其他方法：

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T13:56:57.850

我认为您最好在拥有所有信息的开发者网站上查看它。这是 [http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

```
<supports-screens 
    android:resizeable="true" 
    android:smallScreens="true" 
    android:normalScreens="true" 
    android:largeScreens="true" 
    android:anyDensity="true"/> 
```

# php - Zend_Form 表装饰器 4 列

> ID：12623015
> 
> 赞同：0
> 
> 时间：2012-09-27T13:52:24.593
> 
> 标签：php, zend-framework, zend-form

Zend_Form 有可能有 4 列吗？例子：

```
<table>
    <tr>
        <td>Element 1 label</td>
        <td>element1</td>
        <td>Element 2 label</td>
        <td>element2</td>
    </tr>
</table> 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:02:13.360

是的！
是你的`viewScript Decorator`朋友。

```
//the viewScript
<article class="login">
    <form action="<?php echo $this->element->getAction() ?>"
          method="<?php echo $this->element->getMethod() ?>">
        <table>
            <tr>
                <th>Login</th>
            <tr>
                //renders just the Label decorator
                <td><?php echo $this->element->name->renderLabel() ?></td>
                //renders just the viewHelper decorator
                <td><?php echo $this->element->name->renderViewHelper() ?></td>
            </tr>
            <tr>
                 //renders just the Label decorator
                <td><?php echo $this->element->password->renderLabel() ?></td>
                 //renders just the viewHelper decorator
                <td><?php echo $this->element->password->renderViewHelper() ?></td>
            </tr>
            <tr>
                 //renders the entire element
                <td><?php echo $this->element->submit ?></td>
            </tr>
        </table>
    </form>
</article> 
```

表格

```
<?php
class Application_Form_Login extends Zend_Form
{

    public function init() {
        $this->setMethod('POST');
        $this->setAction('/index/login');

        /**
         * Set the viewScript decorator
         */
        $this->setDecorators(array(
            array('ViewScript', array(
                    'viewScript' => '_login.phtml'
            ))
        ));

        /**
         * Text element 'name'
         */
        $name = new Zend_Form_Element_Text('name');
        $name->setLabel('Name');
        $name->setAttrib('placeholder', 'Username');
        $name->setOptions(array('size' => 20));

        /**
         * Password element for 'password'
         */
        $password = new Zend_Form_Element_Password('password');
        $password->setLabel('Password');
        $password->setAttrib('placeholder', 'Password');
        $password->setOptions(array('size' => 20));

        $submit = new Zend_Form_Element_Submit('submit');
        $submit->setLabel('Login');

        $this->addElements(array($name, $password, $submit));
    }
} 
```

希望这可以帮助。

# python - 使用 cython 的 Python TA-Lib

> ID：12623019
> 
> 赞同：0
> 
> 时间：2012-09-27T13:53:04.890
> 
> 标签：python

我在 Ta-Lib python 安装上有几个线程。我已经下载了 Cython 并尝试进行 easy_install 但收到以下错误：

```
talib.c:256:28: error: ta-lib/ta_libc.h: No such file or directory
talib.c: In function ‘__pyx_pf_5talib_ACOS’:
talib.c:2391: warning: assignment from incompatible pointer type
talib.c:2502: warning: implicit declaration of function ‘TA_Initialize’
talib.c:2511: warning: implicit declaration of function ‘TA_ACOS_Lookback’
talib.c:2569: warning: implicit declaration of function ‘TA_ACOS’
talib.c:2578: warning: implicit declaration of function ‘TA_Shutdown’
talib.c:2587: error: ‘TA_SUCCESS’ undeclared (first use in this function)
talib.c:2587: error: (Each undeclared identifier is reported only once
talib.c:2587: error: for each function it appears in.)
talib.c: In function ‘__pyx_pf_5talib_2AD’: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T15:25:26.640

我编写了[TA-Lib python wrapper](http://github.com/mrjbq7/ta-lib)，它使用 Cython 来包装 TA-Lib 中的所有函数，并在 Github 上发布。它对我来说非常好用，使用 Numpy 数组，比 SWIG 界面快 2-4 倍，更“pythonic”，并且更容易安装（适用于 Mac OS X）。

您似乎没有正确链接到底层`TA-Lib`C 库——您安装了吗？在 Mac OS X 上，您可以`brew install ta-lib`. 有关其他安装指南，请查看[TA-Lib.org](http://github.com/mrjbq7/ta-lib)

# c - APUE：如何在两个过程中交替打印一些东西？

> ID：12623022
> 
> 赞同：0
> 
> 时间：2012-09-27T13:53:13.290
> 
> 标签：c, unix

```
#include<apue.h>
#include<signal.h>

static void charatatime(char *str)
{
    char *ptr;
    int c;
    setbuf(stdout,NULL);
    for (ptr = str;(c = *ptr++) != 0;)
        putc(c,stdout);
}

int main(int argc , char *argv[])
{
    pid_t   pid;
    int i;
    TELL_WAIT();

    if ((pid = fork()) < 0)
        err_sys("fork error");
    else if (pid == 0)
    {

        for (i = 0;i < 10;++i)
        {
            WAIT_PARENT();
            charatatime("ouput from child\n");
        }

        exit(0);
    }
    else
    {

        for (i = 0;i < 10;++i)
        {
            charatatime("output from parent\n");
            TELL_CHILD(pid);
        }
    }
    return 0;
} 
```

它只需打印两次而没有任何循环即可正常工作。但是当我尝试使用`for`循环打印更多次时似乎很糟糕......我认为父进程应该在`TELL_CHILD(pid)`完成后等待子进程......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:15:06.913

您的问题是，在写入之后，父母不会等待孩子接管。所以你的代码只确保孩子在父母至少写过一次之后才会写。

我无法测试代码所以检查错误，但也许这样的事情会起作用：

```
#include<apue.h>
#include<signal.h>

static void charatatime(char *str)
{
    char *ptr;
    int c;
    setbuf(stdout,NULL);
    for (ptr = str;(c = *ptr++) != 0;)
        putc(c,stdout);
}

int main(int argc , char *argv[])
{
    pid_t   pid;
    int i;
    TELL_WAIT();

    if ((pid = fork()) < 0)
        err_sys("fork error");
    else if (pid == 0)
    {
        TELL_PARENT();

        for (i = 0;i < 10;++i)
        {
            WAIT_PARENT();
            charatatime("ouput from child\n");
            TELL_PARENT();
        }

        exit(0);
    }
    else
    {

        for (i = 0;i < 10;++i)
        {
            WAIT_CHILD(pid);
            charatatime("output from parent\n");
            TELL_CHILD(pid);
        }
    }
    return 0;
} 
```

# ruby-on-rails - link_to 没有控制器也没有动作

> ID：12623023
> 
> 赞同：0
> 
> 时间：2012-09-27T13:53:15.100
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing, link-to

我对以下链接生成器有看法：

```
- @tags.each do |tag|
  = link_to tag.name, :controller => "images", :action => "#{tag.name}" 
```

`@tags`是`Tag.all`。它显示具有正确名称的链接，鼠标悬停显示例如

```
http://localhost:3000/Images/tagname 
```

但如果我点击一个错误是：

```
No route matches {:controller=>"", :action=>""} 
```

当我指定时它怎么能说`:controller`是空的`:controller => "images"`？

**rake 路线（相关部分）：**

```
images GET           /images(.:format)                     images#index
POST                 /images(.:format)                     images#create
new_image GET        /images/new(.:format)                 images#new
edit_image GET       /images/:id/edit(.:format)            images#edit
image GET            /images/:id(.:format)                 images#show
PUT                  /images/:id(.:format)                 images#update
DELETE               /images/:id(.:format)                 images#destroy
tags GET             /Images(.:format)                     tags#index
POST                 /Images(.:format)                     tags#create
new_tag GET          /Images/new(.:format)                 tags#new
edit_tag GET         /Images/:id/edit(.:format)            tags#edit
tag GET              /Images/:id(.:format)                 tags#show
PUT                  /Images/:id(.:format)                 tags#update
DELETE               /Images/:id(.:format)                 tags#destroy 
```

一个标签，例如“ `saturn`”，所以我也添加了这条路线`routes.rb`：

```
match '/Images/saturn'                => 'images#saturn' 
```

这导致：

```
Images_saturn        /Images/saturn(.:format)              images#saturn 
```

我的图像控制器中也有一个方法“ `saturn`”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:06:30.440

尝试

= link_to tag.name, {:controller => "images", :action => "#{tag.name)}"}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:27:40.720

在我看来，您有大小写问题。您的路线中有 /images 和 /Images ...您可以尝试修复它吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:15:35.570

你有一个额外的“）”之后

```
"#{tag.name)}" 
```

# go - 使用什么语言来编写游戏库，Go 还是 Rust？

> ID：12623026
> 
> 赞同：5
> 
> 时间：2012-09-27T13:53:18.257
> 
> 标签：go, game-engine, rust

你会使用 Go 和 Rust 之间的哪种语言来创建游戏库（无绑定）？

Go 是一种更简单的语言，它更依赖于垃圾收集。Rust 是一种更复杂的语言，完全可以在没有 GC 的情况下安全使用，非常适合低级系统编程。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-27T23:37:27.387

因为我花了两个夏天在 Rust 上工作，所以我有偏见，但如果你愿意投入必要的时间来跟上快速变化的语言，Rust 对游戏来说真的很好。它有一组非常好的内置并发原语，因此很容易分离不同的组件，如渲染引擎、人工智能等，并利用多核计算机。也可以避免垃圾收集的需要，因此您不必担心不可预知的 GC 暂停。它旨在与现有的 C 代码很好地集成，并且许多数据类型直接映射到 C 类型。一旦 LLVM 完成，Rust 的多态性方法会导致一些非常好的组装。

现在很多游戏都是在网页浏览器中运行的，这说明网页浏览器和游戏有着相似的需求。Mozilla 正在设计 Rust 及其新的并行浏览器引擎，这意味着该语言将继续以适合游戏编程的方式发展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:21:18.410

Rust：[这是 alpha 级软件，有许多已知的错误、不完整的功能和计划的未来更改。使用风险自负，预计暂时会出现一些不稳定、中断和源级不兼容。](https://github.com/mozilla/rust/wiki) 不适合商业游戏。

您根本无法使用 Go 为游戏制作库。不支持在 Go 中创建库。使用 Go，您可以创建仅用于 Go 的 mobule(library)。

您可以在 Go 中使用 C++ 库。但是你不能在 C++ 中使用 Go lib。

您可能会问哪种语言更适合 Rust 或 Go 游戏。

**更新 2015 年** Go 1.4 具有对 Android 的 office/beta 支持，Go 1.5（2015 夏季）将具有 iOS 支持。

现在为 android 构建是很棘手的。您必须安装 docker 映像

# r - 如何在 R 中分析不规则的时间序列

> ID：12623027
> 
> 赞同：14
> 
> 时间：2012-09-27T13:53:21.730
> 
> 标签：r, time-series, zoo

我`zoo`在 R 中有一个时间序列：

```
d <- structure(c(50912, 50912, 50912, 50912, 50913, 50913, 50914, 
50914, 50914, 50915, 50915, 50915, 50916, 50916, 50916, 50917, 
50917, 50917, 50918, 50918, 2293.8, 2302.64, 2310.5, 2324.02, 
2312.25, 2323.93, 2323.83, 2338.67, 2323.1, 2320.77, 2329.73, 
2319.63, 2330.86, 2323.38, 2322.92, 2317.71, 2322.76, 2286.64, 
2294.83, 2305.06, 55.9, 62.8, 66.4, 71.9, 59.8, 65.7, 61.9, 67.9, 
38.5, 36.7, 43.2, 30.3, 42.4, 33.5, 48.8, 52.7, 61.2, 30, 41.7, 
50, 8.6, 9.7, 10.3, 11.1, 9.2, 10.1, 9.6, 10.4, 5.9, 5.6, 6.6, 
4.7, 6.5, 5.2, 7.5, 8.1, 9.5, 4.6, 6.4, 7.7, 9.29591864400155, 
10.6585128174944, 10.4386464748912, 11.5738448647708, 10.9486074772952, 
10.9546547052814, 10.3733963771546, 9.15627378048238, 8.22993822910891, 
5.69045896511178, 6.95269658370746, 7.78781665368086, 7.20089569039135, 
4.9759716583555, 8.99378907920762, 10.0924594632635, 10.3909638115674, 
6.28203685114275, 9.16021859457356, 7.56829801052175, 0.695918644001553, 
0.9585128174944, 0.138646474891241, 0.473844864770827, 1.74860747729523, 
0.854654705281426, 0.773396377154565, -1.24372621951762, 2.32993822910891, 
0.0904589651117833, 0.352696583707458, 3.08781665368086, 0.700895690391349, 
-0.224028341644497, 1.49378907920762, 1.99245946326349, 0.890963811567351, 
1.68203685114275, 2.76021859457356, -0.131701989478247), .Dim = c(20L, 
6L), .Dimnames = list(NULL, c("station_id", "ztd", "zwd", "iwv", 
"radiosonde", "error")), index = structure(c(892094400, 892116000, 
892137600, 892159200, 892180800, 892245600, 892267200, 892288800, 
892332000, 892353600, 892375200, 892418400, 892440000, 892461600, 
892504800, 892526400, 892548000, 892591200, 892612800, 892634400
), class = c("POSIXct", "POSIXt")), class = "zoo") 
```

我想执行`ts`软件包允许我执行的一些分析，例如将时间序列分解为趋势和季节性，并查看自相关函数。但是，尝试执行其中任何一项都会出现以下错误：`Error in na.fail.default(as.ts(x)) : missing values in object`。

更深入地研究这一点，似乎所有这些功能都适用于`ts`根据定义具有规则间隔观察的对象。我的观察结果不是，所以我最终得到了很多`NA`s 并且一切都失败了。

有没有办法分析 R 中的不规则时间序列？还是我需要以某种方式将它们转换为常规？如果是这样，有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-27T14:06:03.823

我过去曾使用加法模型分析过此类不规则数据，以“分解”季节性和趋势成分。由于这是一种基于回归的方法，您需要将残差建模为时间序列过程，以解决残差缺乏独立性的问题。

我使用**mgcv**包进行这些分析。基本上拟合的模型是：

```
require(mgcv)
require(nlme)
mod <- gamm(response ~ s(dayOfYear, bs = "cc") + s(timeOfSampling), data = foo,
            correlation = corCAR1(form = ~ timeOfSampling)) 
```

哪个适合季节项的一年中的一天变量的循环样条曲线，`dayOfYear`趋势由`timeOfSampling`哪个数字变量表示。残差在这里建模为连续时间 AR(1)，使用`timeOfSampling`变量作为 CAR(1) 的时间分量。这假设随着时间分离的增加，残差之间的相关性呈指数下降。

我写了一些关于这些想法的博客文章：

1.  [平滑时间相关数据](http://www.fromthebottomoftheheap.net/2011/07/21/smoothing-temporally-correlated-data/)
2.  [加性建模和 HadCRUT3v 全球平均温度系列](http://www.fromthebottomoftheheap.net/2011/06/12/additive-modelling-and-the-hadcrut3v-global-mean-temperature-series/)

其中包含额外的 R 代码供您遵循。

# python - 来自数据库（Django）的模型的值

> ID：12623030
> 
> 赞同：0
> 
> 时间：2012-09-27T13:53:29.547
> 
> 标签：python, sql, django, models

我有这个模型

```
class Type(models.Model):
    type = models.CharField(max_length=50)
    value = models.CharField(max_length=1) 
```

在其中，我有一些来自 sql 文件的数据：

```
INSERT INTO quest_type (type, value) VALUES ('Noun', '1');
INSERT INTO quest_type (type, value) VALUES ('Adjective', '2');
INSERT INTO quest_type (type, value) VALUES ('Duration', '3'); 
```

如何在 python shell 中访问这些值？例如，如果我知道类型，我如何获得值（反之亦然）？我不确定语法是如何工作的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:01:00.517

你应该能够得到它

`Type.objects.filter(type=typeImInterestedIn)`

需要注意的几件事：-您可能希望避免手动写入正在使用 ORM 的数据库。它只会造成不匹配的可能性。- 命名对象类型几乎没有问题，因为它非常接近 Python 原生函数类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:01:10.680

从您的问题中不清楚您对数据库了解多少，所以如果这个答案对您来说太基本了，我深表歉意（如果是这样，请编辑您的问题以包含有关您正在使用的实际数据库引擎的信息并显示一些示例代码尝试从数据库中读取）。

您拥有的 SQL 文件与 SQL 数据库不同。它是一系列将在 SQL 数据库中创建记录的命令。首先，您必须在您的机器上安装和配置数据库引擎，然后“运行”该 .sql 文件，以便在数据库中创建记录。

在您拥有一个实际的数据库之后，您必须配置 Django，以便它知道您正在使用哪种 SQL 引擎以及数据库的名称和位置。

最后，一旦创建了数据库并将 Django 配置为与引擎对话，您将编写 python 代码来实例化 Type 类的实例，从数据库中读取记录并检查值。

另外，让我指出，`Type`对于任何编程语言中的类来说，这都是一个非常非常糟糕的名称，并且`type`对于`value`SQL 数据库中的列来说，这两个名称都是糟糕的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:03:40.307

如果您首先使用 django 的 python shell (python manage.py shell) 您必须将模型导入命名空间，因此输入 from my_app.models import Type。

现在，如果您只想从 db 语法中获取一个对象是：

```
result = Type.objects.get(type='your_query') 
```

如果你想获取更多，那么一个对象语法如下：

```
result = Type.objects.filter(type='your_query') 
```

第二种方法返回列表而不是单个对象

使用过滤器写入后循环列表：

```
for item in result:
    item.value #will print values from matched rows 
```

# ldap - 是否有可用于将用户信息存储到typo3 中的ldap 目录的扩展程序？

> ID：12623031
> 
> 赞同：0
> 
> 时间：2012-09-27T13:53:31.550
> 
> 标签：ldap, typo3

我已经安装了一个 LDAP 服务器并完成了它的设置。我想知道的是是否存在允许我通过表单提交将用户存储到 LDAP 服务器的扩展。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:58:16.230

看看这里：http: [//xavier.perseguers.ch/en/tutorials/typo3/articles/ldap-backend-for-extbase.html](http://xavier.perseguers.ch/en/tutorials/typo3/articles/ldap-backend-for-extbase.html)

# api - 如何使用 API 向 SalesForce 用户发送临时密码？

> ID：12623034
> 
> 赞同：3
> 
> 时间：2012-09-27T13:53:33.913
> 
> 标签：api, soap, salesforce

我正在使用 SOAP 合作伙伴 API，并且我有一个开发人员版本。我正在使用 API 创建用户。在创建用户后，我想通过电子邮件向这些用户发送临时密码，他们可以使用该密码登录到 SalesForce。

这是我的代码：

```
SaveResult[] results = connection.create(new SObject[] { user });

if (results[0].isSuccess())
{
out.println("Created user: " + results[0].getId());

//connection.setPassword(results[0].getId(), "password");
ResetPasswordResult rpr = connection.resetPassword(results[0].getId());
String result = rpr.getPassword();
  System.out.println("The temporary password for user ID " + results[0].getId()
        + " is " + result);
}
else
{
out.println("Error: " + results[0].getErrors()[0].getStatusCode() + 
                   ":" + results[0].getErrors()[0].getMessage());
} 
```

这是我在控制台中得到的输出：

```
The temporary password for user ID 005E0000000MwkZIAS is ucQD2PADs 
```

但是，用户没有收到任何密码。:-(

谢谢，

瓦普劳

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:52:02.987

如果您在soap 请求中构建并传递一个[EmailHeader](http://www.salesforce.com/us/developer/docs/api/index_Left.htm#StartTopic=Content/sforce_api_header_emailheader.htm)，您可以控制从您的请求中发送哪些类型的电子邮件。

看起来您正在使用 WSC，因此您可以在调用 resetPassword 之前添加此调用，这将使电子邮件能够发送给用户。这应该会发送标准的重置密码电子邮件。

```
connection.setEmailHeader(false, false, true); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-27T15:14:43.133

使用此类发送电子邮件。在要发送给用户的字符串中包含 pwd 变量。有一个例子说明了一切

[http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_email_outbound.htm](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_email_outbound.htm)

# c++ - 用于优化的数据结构

> ID：12623039
> 
> 赞同：1
> 
> 时间：2012-09-27T13:53:44.553
> 
> 标签：c++, design-patterns, database-design

我正在考虑一种更有效地处理数据的方法。让我解释一下：

目前有一个类，叫做`Rules`，它有很多成员函数，比如`Rules::isForwardEligible()`, `Rules::isCurrentNumberEligible()`....所以这些函数用来检查具体情况（当其他进程调用它们时），它们都返回 bool 值。

在这些函数的主体中是`if`s，它们将查询 DB 以比较数据，最后返回 turn 或 false。

所以整个事情就像`if(Rules::isCurrentNumberEligible())`--->Check content in `Rules::isCurrentNumberEligible()`---> `if(xxxx)`（xxxx又是另一个功能，查询DB），我觉得这种方式不好。我想改进它。

我想象的是使用更少的代码，但查询更多的信息。

所以我可以在第一步`if(Rules::isCurrentNumberEligible())`进行查询，我可以设置不同的表进行查询，这样`if(xxx){if(xx){if(xx)....}}`会少一些。一个解决方案是建立一个类，其角色就像一个协调员，每次询问他不同的查询。合适吗？

我不确定这是控制这种情况的好方法，或者可能有一些好的解决方案。请帮助我，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T20:52:19.433

基于规则的系统的经典算法是[RETE 算法](http://en.wikipedia.org/wiki/Rete_algorithm)。它力求最小化要评估的规则数量。诀窍在于，除非至少一个相关事实发生了变化，否则对规则的重新评估是没有意义的。

一般来说，应该首先查询那些承诺最大信息增益的规则。这有助于在尽可能少的问题中确定相应的案例。鉴别诊断的医生总是将他/她的问题从一般到具体排序。在信息论中，这被称为[最大熵原理](http://en.wikipedia.org/wiki/Principle_of_maximum_entropy)。

# php - 鉴于他们的新政策，如何使用 Cron Job 访问 facebook Graph

> ID：12623042
> 
> 赞同：1
> 
> 时间：2012-09-27T13:53:50.803
> 
> 标签：php, facebook, curl, cron, facebook-access-token

我很难弄清楚这一点。Facebook 正在实施一项新政策[https://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)这不再允许您过去被允许获得的更简单的“offline_access”令牌。我正在开发一个应用程序，该应用程序需要使用 cronjob 每 3 小时访问一次 Graph API，我不知道如何设置它以便我不需要登录来访问它，因为我无法使用 cronjob 登录重定向到登录页面。我假设我需要在 php 脚本中使用某种 Curl 调用来使其正常工作。我不需要发布任何内容，我所做的只是从几个公共页面抓取帖子。有任何想法吗？假设我首先使用 login_url 登录，我已经有一个脚本可以做我想做的事。只需要这个与 cronjob 一起工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T13:57:28.910

首先回答第一个问题——你这边没有什么可做的。facebook 的改变仅仅意味着这种应用程序不再可能。您可以做的最好的事情是请求一个扩展令牌，然后持续大约 30 天（或 60 天，不确定）。要请求它，您需要调用 fb api - 如此处和[此处](https://stackoverflow.com/questions/11921886/where-to-request-extended-access-token-in-facebook-app-using-php-sdk)[所示](https://stackoverflow.com/a/9671065/1039678)（尽管不是 python 示例，它们是有用的指针）。官方FB的解释在[这里](https://developers.facebook.com/roadmap/offline-access-removal/#extend_token)。

但是，每次用户更改密码、删除应用程序或注销 Facebook 时，此令牌都会失效。您需要查看哪些请求失败并手动通知用户更新您身边的令牌并存储新令牌。

关于抓取公共帖子的第二个问题-您甚至需要访问令牌吗？尝试在没有它的情况下使用 Graph API，看看您是否可以获得您感兴趣的信息。

# c# - 你应该使用 return 还是其他？其中哪一个是最优的？

> ID：12623043
> 
> 赞同：0
> 
> 时间：2012-09-27T13:54:13.710
> 
> 标签：c#

其中哪一个更优化？你用哪一个有关系吗？

```
If (condition is true)
{
    MessageBox.Show("bad data");
    return;
}

//mode code here 
```

或者

```
If (condition is true)
{
    MessageBox.Show("bad data"); 
}
else
{
    //mode code here
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T13:59:28.403

两者在功能上是相同的。在行为或表现方面，两者实际上都不优于另一个。这里唯一真正的问题是可读性，这将根据示例的具体情况和所涉及的编程团队而有所不同。所以简而言之，选择任何你想要的。

请注意，您的示例可能应该更完整一些，才能使这些断言成立。真的应该比较；

```
public static void returnMethod()
{
    if (true)
        MessageBox.Show("bad data");

    //restOfMethod
} 
```

和：

```
public static void elseMethod()
{
    if (true)
        MessageBox.Show("bad data");
    else
    {
        //restOfMethod
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:02:37.413

我想你的意思更像是

```
If (condition is true) 
{ 
    MessageBox.Show("bad data"); 
    return; 
} 

...more code here... 
```

对比

```
If (condition is true)    
{    
    MessageBox.Show("bad data");     
}    
else    
{    
    ...more code here...
} 
```

不，没有性能差异。

这将更多地取决于设计偏好。有些人是顽固的，从不使用returns-to-get-out-of-a-method，而另一些人则喜欢保持他们的代码简单整洁，如果使用return有帮助，那就更好了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:04:18.707

我会说永远不要有一个空的 else {} 语句，除非它只是一个占位符，在这种情况下做类似的事情

```
 else
    {
        //Todo: Fill in logic to handle the else case, waiting for business to get back to me
    } 
```

就我个人而言，我认为在“if”中返回很好，但如果在 if 之下没有任何内容，请写“return;”。浪费了几百个像素。如果它用几个像素做完全相同的事情并且不难理解，我会一直坚持下去。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T14:11:52.643

在 if-else 和 return 会做同样事情的情况下（其他答案中提供了一些示例），我认为可读性很重要。

我认为对于一个“如果”来说，写一个“其他”或直接“返回”并不重要。当嵌套一些“if-else”语句时，情况会变得更糟。在方法中使用多个“返回”也可能非常难以理解。

我不喜欢嵌套 if-else，也不喜欢在同一个方法中放置多个返回。但如果我必须选择，我更喜欢有多个“回报”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T13:57:38.567

这取决于几件事。条件之后是否有其他代码不再适用？如果是这样，那么 return 会更优化，因为它会阻止即将发生的语句运行。

另一个想法是如何放置？如果这是在一个有返回的方法中，你会使用它。同样，如果不适用让周围的函数接受返回，你就不想使用*return*。

这有什么意义吗？

# sql-server - DATEADD 的情况

> ID：12623045
> 
> 赞同：0
> 
> 时间：2012-09-27T13:54:17.400
> 
> 标签：sql-server, case, where, between

我正在尝试编写一个 SQL，它将调出所有日期范围或过去 90 天的日期。一切正常，但以下代码决定了要查看的日期。

```
WHERE 
   CASE @All_90 
      WHEN @All_90 = 1 
      THEN td.DateSeen NOT BETWEEN DATEADD(day,-90,GETDATE()) and GETDATE() 
```

`@All_90`是用于确定代码是查看所有日期还是仅查看 90 天之前的日期的变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:13:49.690

我认为这会为你做到：

```
WHERE 
    (@All_90 = 1 AND td.DateSeen NOT BETWEEN DATEADD(day,-90,GETDATE()) and GETDATE())
    OR (@All_90 = 0 AND td.DateSeen BETWEEN DATEADD(day,-90,GETDATE()) and GETDATE()) 
```

# android - 我可以使用 SL4A 启用 USB 网络共享吗？

> ID：12623051
> 
> 赞同：1
> 
> 时间：2012-09-27T13:54:47.507
> 
> 标签：android, sl4a

我已经在[API 参考](http://code.google.com/p/android-scripting/wiki/ApiReference)中搜索了启用 USB 网络共享的类/方法，但没有找到。我想知道它是否仍然可能。

有关信息，我使用带有 Cyanogenmod 7 和 Android 2.3.7 的 HTC Wildfire。

如果不可能，我对 Java 示例代码很感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T10:56:50.710

不使用内置 API（正如您所检查的那样），这仅意味着不，如果您不愿意做一些工作，则不会。

但是，如果您使用的是 Beanshell、JRuby 或 Rhino，那么根据[SL4A 常见问题解答（“API 桥？”问题）](http://code.google.com/p/android-scripting/wiki/FAQ#Is_this_a_complete_API_bridge,_or_are_there_restrictions?)，*“您可以直接调用 Java 调用”*建议*“查看这些解释器的文档”*以了解如何操作所以（虽然我找不到它）。但是在[非官方发布](http://code.google.com/p/android-scripting/wiki/Unofficial)页面上，它指出：

> “Beanshell 和 Rhino 都可以直接访问 android api。但是，许多 Android api 调用需要一个上下文，由于它们的运行方式，这些解释器没有。正在寻求解决方案......感谢建议。 "

根据[这个答案](https://stackoverflow.com/a/7049074/584026)，我相信 a`Context`是必需的，尽管我可能错了。

最后，您的最后一个选择是[克隆](http://code.google.com/p/android-scripting/source/checkout)您正在使用的任何解释器的源代码并添加您需要的调用。再次引用FAQ；*“RPC 层易于扩展。”* 甚至还有[一些演练](https://groups.google.com/d/msg/android-scripting/hlUxn852nEw/0pzKD5zN6wIJ)。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T17:00:59.803

如果您启用了 root，您只需尝试使用 SL4A 或 Android 即可。我使用这个脚本：

```
#!/system/bin/sh
iptables -D droidwall-3g -m owner --uid-owner 0 -j RETURN
iptables -I droidwall-3g -m owner --uid-owner 0 -j RETURN
iptables -t nat -D POSTROUTING -o rmnet0 -j MASQUERADE
iptables -t nat -I POSTROUTING -o rmnet0 -j MASQUERADE
echo 1 > /sys/class/usb_composite/rndis/enable
ifconfig usb0 192.168.42.129 up
echo 1 > /proc/sys/net/ipv4/conf/usb0/forwarding
echo 1 > /proc/sys/net/ipv4/conf/rmnet0/forwarding 
```

也许对于其他设备（我的是 SE Xperia X10），您需要调整`/sys/class/usb_composite/rndis/enable`.

# php - 如何在 div 中为不同的屏幕分辨率设置背景图像？

> ID：12623052
> 
> 赞同：1
> 
> 时间：2012-09-27T13:54:48.553
> 
> 标签：php, css

我正在开发一个网页，在 div 的帮助下设置背景，但我的问题是，当屏幕的分辨率发生变化时，图像不适合，它会在大屏幕上的屏幕两侧显示空白。有没有一种方法可以让我制作一个适用于所有屏幕的标准案例。

这就是我设置 div 的方式

```
mheaderimgs {
width:1007px;
margin:auto auto;
height:auto;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T13:58:51.490

width:100% 会拉伸它，如果你把它做成一个稍微大一点的图像，它会在大多数情况下缩小它，只需要 1 个图像。

据我所知，没有非javascript方法来获取屏幕大小，然后与设置大小进行比较

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:00:07.120

CSS 背景尺寸属性，

```
background-size:contain; 
```

如需更多参考，请参阅

[http://www.w3schools.com/cssref/css3_pr_background-size.asp](http://www.w3schools.com/cssref/css3_pr_background-size.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T14:00:21.757

PHP 不知道客户端屏幕有多大。考虑 javascript 或[媒体查询](http://mediaqueri.es/) 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T14:01:19.683

也许你可以试试这个（CSS3属性）：

```
background-size: cover; 
```

否则，我认为您可以在 javascript 中执行此操作。

# javascript - Javascript 中的 void(0) 说明？

> ID：12623053
> 
> 赞同：3
> 
> 时间：2012-09-27T13:54:54.277
> 
> 标签：javascript, html, void

阅读后：

[“void 0”和“undefined”之间的区别](https://stackoverflow.com/questions/4806286/difference-between-void-0-and-undefined)，[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/void](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/void)

我还有一些问题。

我读过 `window.undefined` *可以*覆盖的 vwhere`void`运算符将返回未定义的值`always`

但引起我注意的例子是 MDN 中的例子：

```
<a href="javascript:void(0);">Click here to do nothing</a> 
```

为了什么*都不*做，我一直认为我应该写：

```
href="javascript:return false;" 
```

这让我想到了另一个问题：（在`Href`上下文中！）：

`javascript:void(0);`对比`javascript:return false;`

有什么区别？

还有 - 是否

```
function doWork() {
    return void( 0 );
} 
```

正是*_*

```
function doWork() {

    return undefined;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T14:14:17.053

这将无法正常工作：

```
href="javascript:return false;" 
```

因为你不在一个函数中。你在想这个：

```
onclick="return false;" 
```

这是正确的，因为`return false;`它被放置在一个函数中。该`false`值告诉`onclick`防止元素的默认行为。

要使`return`语句在`href`属性中起作用，您需要一个完整的函数。

```
href="javascript:(function() { return false; })();" 
```

但这又长又丑，正如评论所指出的，`href`通常不鼓励使用 JavaScript。

***编辑：*** *我刚刚学到了一些东西。上面的非`undefined`表达式似乎用返回值替换了元素（至少在 Firefox 中）。我并不完全熟悉在 中使用 JavaScript 的全部后果`href`，因为我从不这样做。*

* * *

是的，这个：

```
return undefined; 
```

返回完全相同的东西：

```
return void 0; 
```

只要`undefined`变量没有被其他值重新定义或遮蔽。

但是虽然它们可能*返回相同的东西，但说它们**是*相同的东西并不完全准确，因为：

*   `undefined`是一个全局变量，其默认值为`undefined`原始值

*   `void`是一个*一元运算符*`undefined`，它将用原语替换其操作数的返回值

所以它们都产生了`undefined`原语，但它们以非常不同的方式实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T14:28:46.757

如果您指定`javascript: something`为`href`属性值，`something`则会在有人激活该链接时对其进行评估。

将检查此评估的结果：如果其`typeof`评估为`'undefined'`字符串，则不会发生任何事情；如果没有，页面将重新加载评估结果作为其内容：

```
<a href="javascript: void(0);">Nothing to see here, move along...</a>
<a href="javascript: undefined;">No, still nothing...</a>
<a href="javascript: prompt('Where would you like to go today?');">Check this out!</a> 
```

这里的前两个链接基本上什么都不做。但第三个更有趣：无论你输入什么，`prompt`都会显示给你——甚至是一个空字符串！但这还不是全部：如果您单击`Cancel`，您仍然会看到一个新页面 -`null`打印（作为取消的`prompt`返回`null`，并且，您可能知道，`typeof null`实际上是`object`；并且`null`转换为 String 是，好吧`'null'`）。

它可能会变得更有趣：

```
<a href="javascript: window.undefined = 333; void(0);">What happens here?</a>
<a href="javascript: window.undefined = 333; undefined;">And here?</a> 
```

好吧，在这里我们仍然在第一个链接上一无所获。但是第二个链接会在 IE8 中显示 333。:)

我想，这也回答了你的第二个问题： typeof void(0) 将**永远**是`undefined`. `typeof undefined`如果有人认为将它们重新分配给`window.undefined`. )

...是的，`javascript: return false;`这是错误的：你不能从非功能环境中返回。您可能将其与 混淆了`onclick: return false`，但这完全是另一回事。)

# java - 如何修复无法对非静态输入字段进行静态引用的错误？

> ID：12623054
> 
> 赞同：1
> 
> 时间：2012-09-27T13:54:54.240
> 
> 标签：java, arrays, methods

我正在学习java。我编写了以下代码，但是当我尝试接受输入时，我在 Arrayfunction() 中收到此错误“无法对非静态输入字段进行静态引用”。为什么会这样，我该如何解决？

```
import java.util.*;
public class MultidimArrays {

Scanner input= new Scanner(System.in);

public static void main(String args[])
{       
    int array[][]= new int[2][3];

    System.out.println("Passing array to a function");

    Arrayfunction(array);
}

public static void Arrayfunction(int array[][])
{
    System.out.println("Inside Array function");

    for(int i=0;i<array.length;i++)
    {
        for(int j=0;j<array[i].length;j++)
        {
            System.out.println("Enter a number");
            array[i][j]=input.nextInt();// error
    }
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T13:56:02.167

扫描仪未定义为静态，因此在错误的范围内

在内部创建 Scanner 实例 `Arrayfunction`或使用

```
private static Scanner input= new Scanner(System.in); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T13:57:27.567

这个错误的原因是：由于你没有创建对象，所以非静态变量`input`不存在，所以你不能使用它。要修复它，您可以制作`input`为`static`

```
static Scanner input= new Scanner(System.in); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T13:57:37.453

要么使您的 Scanner 成为静态并在静态方法中使用它，要么从您的静态方法创建一个访问扫描器类的实例。

```
static Scanner input= new Scanner(System.in);
public static void Arrayfunction(int array[][])
{          
            System.out.println("Enter a number");
            array[i][j]=input.nextInt();// error
 } 
```

**或者**

```
Scanner input= new Scanner(System.in);
public static void Arrayfunction(int array[][])
{
            System.out.println("Enter a number");
            array[i][j]=new MultidimArrays().input.nextInt();// error
      } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T13:59:37.460

`non static`引用与 的相关`instances`联`class`。虽然所有`static`代码都与`class`自身相关联。

您必须添加`static keyword`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T14:02:24.173

`input`在你的类中是一个*实例变量*（因为它没有定义为`static`），这意味着每个实例`MultidimArrays`都有它自己的一个。`static`字段或方法（通常称为“类变量/方法”）在类的所有实例之间共享。

因为`Arrayfunction`is `static`，它不能引用其类的实例成员——它无法知道使用*哪个* `MultidimArray`。您可以通过将`input`自身设为静态来解决此问题，也可以通过`static`从类中删除限定符`ArrayFunction`并创建类的实例来解决此问题：

```
public static void main(String args[])
{       
    int array[][] arr = new int[2][3]; //typo here, variable needs a name :)

    System.out.println("Passing array to a function");
    MultidimArray ma = new MultidimArray();
    ma.Arrayfunction(arr);
} 
```

# c# - 使用计时器的 Windows 窗体应用程序中的 WCF ASynchronous 调用

> ID：12623056
> 
> 赞同：1
> 
> 时间：2012-09-27T13:54:55.503
> 
> 标签：c#, winforms, wcf, asynchronous

我是使用 Windows 窗体应用程序开发的新手，我有一个问题可以通过一些关于我应该采用的最佳实践方法的帮助/指导来解决。

背景：

我有一个基于表单的应用程序，它需要使用 WCF 服务中的数据每分钟刷新一次，然后使用列表视图控件中的最新结果更新 UI。我有这一切在原则上工作，但应用程序间歇性崩溃，我需要解决这个问题。我已经删除了下面代码的主要部分。可能不需要实际的螺母和螺栓。

代码：

```
public partial class Form1 : Form
{
readonly MatchServiceReference.MatchServiceClient _client = new MatchServiceReference.MatchServiceClient();

public Form1()
    {
        _client.GetMMDataCompleted += new EventHandler<GetMMDataCompletedEventArgs>(_client_GetMMDataCompleted);
    }    

//Arm Timer
private void ArmTimer(object sender, EventArgs e)
    {
        aTimer = new Timer();

        aTimer.Elapsed += OnTimedEvent;

        aTimer.Interval = 60000;
        aTimer.Enabled = true;
    }

//Timer elapsed event
 private void OnTimedEvent(object source, ElapsedEventArgs e)
    {
        try
        {
            LoadMatches();

            if (LastUpdated.InvokeRequired)
            {
                LastUpdated.Invoke(new MethodInvoker(delegate { LastUpdated.Text = e.SignalTime.ToString(); }));
            }
        }
        catch (Exception exception)
        {

        }

    }

//Load matches
private void LoadMatches()
    {
        try
        {
            aTimer.Enabled = false;
            _client.GetMMDataAsync();
        }
        catch (Exception e)
        {
            //EventLog.WriteEntry("Application", e.InnerException.ToString(), EventLogEntryType.Error);
            aTimer.Enabled = true;
        }
    }

void _client_GetMMDataCompleted(object sender, GetMMDataCompletedEventArgs e)
    {
        if (e.Result != null)
        {

            var matches = e.Result;

            Debug.WriteLine("Matches received from service");

            if (!IsHandleCreated && !IsDisposed) return;

            // Invoke an anonymous method on the thread of the form.
            Invoke((MethodInvoker) delegate
                                       {
                                           try
                                           {
                                               LoadTheMonitorMatches(matches);
                                           }
                                           catch (Exception exception)
                                           {
                                               Debug.WriteLine("INNER EXCEPTION" + exception.InnerException);
                                               Debug.WriteLine("EXCEPTION MESSAGE" + exception.Message);
                                           }
                                       });
        }
        aTimer.Enabled = true;
    }
} 
```

}

例外：

我得到的例外如下 -

> 异常信息：System.Reflection.TargetInvocationException 堆栈：在 System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary() 在 MM.Form1._client_GetMMDataCompleted(System.Object, MM.MatchServiceReference.GetMMDataCompletedEventArgs) 在 MM.MatchServiceReference.GetMMDataCompletedEventArgs.get_Result() 在 MM。 MatchServiceReference.MatchServiceClient.OnGetMMDataCompleted(System.Object) 在 System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(System.Object) 在 System.Threading.ExecutionContext.runTryCode(System.Object) 在 System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode, CleanupCode , System.Object) 在 System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object) 在 System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean) 在 System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem() 在 System.Threading.ThreadPoolWorkQueue.Dispatch()在 System.Threading._ThreadPoolWaitCallback.PerformWaitCallback()

对此的任何帮助/建议将不胜感激。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:14:23.907

您使用了错误的计时器。`System.Timers.Timer`旨在在服务器上使用。对于 Winform 应用程序，您应该使用`System.Windows.Forms.Timer`并将其作为控件添加到您的表单中。当你使用它时，UI 会在计时器滴答之间做出响应，但是当它带入数据时，UI 将变得无响应。如果它对您来说不够好，您应该使用`BackgroundWorker`.

如果使用这些组件后问题仍然存在，请再次提问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:34:27.020

线

```
 if (e.Result != null) 
```

实际上是调用 getter 来获取结果。由于事件 args 派生自 AsyncCompletedEventArgs，因此如果操作被取消或出错，这可能会引发错误。在测试结果之前先检查取消和错误属性，您应该能够捕获问题。

从文档： `If the component's asynchronous worker code assigns an exception to the Error property or sets the Cancelled property to true, the property will raise an exception if a client tries to read its value.`

# html - HTML5 文件 api - 无法在 Windows 上的 Firefox 中拖放 flex 应用程序

> ID：12623058
> 
> 赞同：0
> 
> 时间：2012-09-27T13:55:00.283
> 
> 标签：html, apache-flex, firefox, file-upload, drag-and-drop

所以这里是设置。我有一个 flex 应用程序，它填充了整个浏览器窗口，我想让用户选择将文件拖放到应用程序的任何位置以将文件上传到我的服务器。或者同样好，将该文件的内容发送到应用程序本身。作为参考，我当前的设置非常接近[此处](http://thunderheadxpler.blogspot.com/2012/03/dnd-file-using-html5-into-flex-web-app.html)概述的设置。

我有一个绝对定位的、透明的 div，它填满了整个屏幕并位于作为我的拖放区的 flex 内容之上。

在我尝试过的所有支持文件 api 的浏览器中都没有问题，**除了**Windows 上的 Firefox。在这种情况下，只要将文件拖到 flex 内容上，我的光标就会变成空符号，并且所有拖放事件都被抑制。

我有最新版本的 Firefox 和 Flash Player，Windows 是 7 Pro 64 位（虽然这似乎无关紧要，因为我已经在许多不同的 Windows 机器上尝试过）。mac 上的 Firefox 没有问题。

我尝试了几种不同的场景都无济于事：

*   使用 iframe 作为拖放区
*   为 dropzone 提供图像背景（透明 png）

但是，如果放置区不透明 - 一切都很好。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T18:19:56.843

听起来像一个 Firefox 错误。

您可以尝试使用 css opacity 将 div 设置为略低于透明。

# java - 从另一个系统更新 JPA TableGenerator

> ID：12623059
> 
> 赞同：0
> 
> 时间：2012-09-27T13:55:05.083
> 
> 标签：java, jakarta-ee, jpa

我有一个表，它有一个由表生成器生成的主键：

@TableGenerator(name = "resourceIdGenerator", table = "SEQUENCE", pkColumnName = "NAME", pkColumnValue = "resource_type_id", valueColumnName = "NEXTID", allocationSize = 1) 它工作正常。

但是，我有另一个系统（非 java），它通过向其中插入新记录来不时修改同一个表。我想知道是否可以从另一个不使用 JPA 的系统更新我的这个表生成器的值？还是 JPA 自己维护它，并且它是唯一管理 tablegenerator 表的人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:14:51.030

JPA 不能神奇地使用表格并禁止其他任何人使用它。如果您在其他系统中使用与 Hibernate 用于生成 ID 的策略相同的策略，那么它没有理由不起作用。

由于分配大小为 1，您可能只需要启动一个新事务，`select for update`即序列表的相应行，获取其值并将其加 1。

# iphone - 如何在加载下一个视图之前执行 UIButton 操作

> ID：12623060
> 
> 赞同：0
> 
> 时间：2012-09-27T13:55:06.380
> 
> 标签：iphone, objective-c, storyboard, xcode4.5

我有一个用户输入 3 个 sting 字段的视图。按下按钮时，字段存储在数组中。该按钮还可以更改视图。

我遇到的问题是当我从另一个视图中的数组中获取字符串时。返回的值是之前输入的值。

我添加了一些行来记录正在发生的事情和从数组中出来的内容。从日志中我可以看到数组在设置之前被调用。

如何让按钮在更改视图之前运行其操作？

这是我的日志：

```
2012-09-27 14:56:49.530 BeerDivider[1585:907] GetArray:(null)
2012-09-27 14:56:49.543 BeerDivider[1585:907] SetArray:(
    3,
    will,
    Harry
) 
```

编辑：这是我的代码。 [http://pastebin.com/BX5gqp17](http://pastebin.com/BX5gqp17)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:09:50.183

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"yourSegue"]) {
       //do what you need
    }
} 
```

# android - 打开状态设置页面

> ID：12623061
> 
> 赞同：0
> 
> 时间：2012-09-27T13:55:07.767
> 
> 标签：android, android-activity, settings, status

有谁知道如何以编程方式打开设置>关于手机>状态活动？

谢谢！![在此处输入图像描述](../Images/bfc702ef9c564dfb837045660bc5fc8f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-07-18T15:20:28.373

通过使用**adb logcat ActivityManager:V *:S**这个命令，我得到了像**com.android.settings/.Settings$StatusActivity**这样的活动名称。然后我创建了一个 Intent。

`Intent statusIntent = new Intent(); statusIntent.setAction("android.intent.action.MAIN"); statusIntent.setClassName("com.android.settings","com.android.settings.Settings$StatusActivity"); startActivity(statusIntent);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:00:47.260

创建一个意图，使用以下值设置类名/类路径并启动意图

意图 { act=android.intent.action.MAIN cmp=com.android.settings/.deviceinfo.Status }

# bash - 使用 Sh 列出文件

> ID：12623064
> 
> 赞同：0
> 
> 时间：2012-09-27T13:55:11.900
> 
> 标签：bash, shell, unix

> **可能重复：**
> [根据时间戳获取最新文件](https://stackoverflow.com/questions/3495609/get-the-newest-file-based-on-timestamp)

我主要想从特定文件夹中选择最新的转储文件，以便我可以存储在变量中并使用导入脚本导入

我想列出特定文件中的特定文件，我试过：

```
a= $(ls -ltr /home/oracle/testora/MAUL01*.dmp | awk '{print $9}' | tail -1)
echo $a 
```

我想要输出为：

```
MAUL01.DP.09-27-2012_09_15.dmp 
```

代替：

```
/home/oracle/testora/MAUL01.DP.09-27-2012_09_15.dmp 
```

问题： ls 在 sh 内对我不起作用（从 unix 可以正常工作）文件名显示为路径（我使用 basename，但无法使其工作）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:08:32.273

在 bash 中，您可以使用`${parameter##word}`语法删除最后一个`/`.

你也可以用`ls -tr1`，然后就不需要了`awk`。

如下所示：

```
a=$(ls -tr1 /home/oracle/testora/MAUL01*.dmp | tail -1)
echo ${a##*/} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:21:28.703

您的代码无法运行；后面有一个空格`a=`。`basename`轻松解决此问题：

```
name="$(basename /home/oracle/testora/MAUL01*.dmp)" # Assumes only one glob match
echo "$name" 
```

此外，[使用 More Quotes™</a> 并且](http://mywiki.wooledge.org/BashGuide/Practices/#Quoting)[不要解析`ls`输出](http://mywiki.wooledge.org/ParsingLs)。如果问题是对文件进行排序，请检查[此解决方案](https://unix.stackexchange.com/a/35797/3645)：

```
IFS= read -r -d '' -u 9 9< <(find /home/oracle/testora/ -maxdepth 1 -name 'MAUL01*.dmp' -printf '%TY-%Tm-%TdT%TH:%TM:%TS %p\0' | sort -rz)
path="${REPLY#* }"
echo "$(basename "$path")" 
```

是的，在 Bash 中处理文件名很麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:46:33.817

通过参数扩展轻松（且安全）地完成；不需要 ls （这很危险并且在操作系统之间的行为不同）或 find （这也是危险的，除非与 -print0 和一些技巧来处理 NUL 分隔的流一起使用）。这是 POSIX sh 兼容版本：

```
set -- /home/oracle/testora/MAUL01*.dmp
for filename; do
  echo "${filename##*/}"
done 
```

如果您改用 bash，则可以将 glob 的输出存储在数组中，因此不会覆盖`$@`：

```
shopt -s nullglob
filenames=( /home/oracle/testora/MAUL01*.dmp )
for filename in "${filenames[@]}"; do
  echo "${filename##*/}"
done 
```

如果您只想过滤最近的文件，请参阅[http://mywiki.wooledge.org/BashFAQ/003](http://mywiki.wooledge.org/BashFAQ/003)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T13:59:39.547

我们开始吧（那里不需要basename）：

```
cd /home/oracle/testora
latest="$(ls -t MAUL01*.dmp | sed q)"
echo "The latest one is $latest $USER" 
```

并找到：

```
cd /home/oracle/testora
latest="$(
    find -maxdepth 1 -name 'MAUL01*.dmp' -printf '%As %f\n' |
    sort -nk1 |
    tail -1
)" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T14:01:11.687

尝试这个：

```
a=$(ls -ltr /home/oracle/testora/MAUL01*.dmp | awk '{print $9}' | tail -1)
echo $(basename $a) 
```

# linux-kernel - 使用 LKM 实现 Linux 系统调用

> ID：12623066
> 
> 赞同：5
> 
> 时间：2012-09-27T13:55:12.570
> 
> 标签：linux-kernel, system-calls, kernel-module

我试图向 linux 内核 3.2.x 添加一个新的系统调用。在互联网上搜索有用的参考资料时，我的印象是不可能将系统调用实现为可加载模块，因为在 SO 问题中[是否可以通过 LKM 添加系统调用？](https://stackoverflow.com/questions/463332/is-it-possible-to-add-a-system-call-via-a-lkm)

我找到了另一个链接，上面写着“有一种方法可以添加系统调用，而无需使用模块作为包装器重新编译内核，但这超出了本文档的范围”。来源[http://hekimian-williams.com/?p=20](http://hekimian-williams.com/?p=20)

我知道静态实现系统调用将要求我每次进行任何更改时都编译内核代码。是否有上述博客中指定的方法可以将其实现为模块。

非常感谢任何有关方向的建议或指示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T22:38:09.473

1.  定位`sys_call_table/ia32_sys_call_table`
2.  复制并根据需要进行修改（顺其自然`my_sys_call_table`）
3.  找到[system_call](http://lxr.linux.no/linux+v3.5.4/arch/x86/kernel/entry_32.S#L489)条目（这个和其他）
4.  在表大小发生变化的情况下修改`NR_syscalls`比较[指令](http://lxr.linux.no/linux+v3.5.4/arch/x86/kernel/entry_32.S#L497)
5.  修改[system_call](http://lxr.linux.no/linux+v3.5.4/arch/x86/kernel/entry_32.S#L500)`sys_call_table`处的引用以指向：`my_sys_call_table`

    ```
    500        call *sys_call_table(,%eax,4)
          ->
    500        call *my_sys_call_table(,%eax,4) 
    ```

6.  利润？

玩得开心 ：）

# lua - 在 Lua 中使用 iup 时遇到问题

> ID：12623074
> 
> 赞同：2
> 
> 时间：2012-09-27T13:55:38.930
> 
> 标签：lua, iup

我试图让 Iup 在 Lua 中工作。我已经在 C 中成功安装并运行了 iup，但是我的 gui 中有一个嵌入式 lua 解释器，能够从解释器加载对话框会很有帮助。但是，当我尝试执行时`require("iuplua")`，出现以下错误：

```
> require("iuplua")
stdin:1: module 'iuplua' not found:
    no field package.preload['iuplua']
    no file './iuplua.lua'
    no file '/usr/local/share/lua/5.1/iuplua.lua'
    no file '/usr/local/share/lua/5.1/iuplua/init.lua'
    no file '/usr/local/lib/lua/5.1/iuplua.lua'
    no file '/usr/local/lib/lua/5.1/iuplua/init.lua'
    no file '/usr/share/lua/5.1/iuplua.lua'
    no file '/usr/share/lua/5.1/iuplua/init.lua'
    no file './iuplua.so'
    no file '/usr/local/lib/lua/5.1/iuplua.so'
    no file '/usr/lib/x86_64-linux-gnu/lua/5.1/iuplua.so'
    no file '/usr/lib/lua/5.1/iuplua.so'
    no file '/usr/local/lib/lua/5.1/loadall.so'
stack traceback:
    [C]: in function 'require'
    stdin:1: in main chunk
    [C]: ? 
```

我认为这是因为 iup 的 Lua 库没有正确安装。我试图直接移动到包含该`iuplua.lua`文件的目录并再次尝试，并得到：

```
> require("iuplua")
./iuplua.lua:6: attempt to index global 'iup' (a nil value)
stack traceback:
    ./iuplua.lua:6: in main chunk
    [C]: in function 'require'
    stdin:1: in main chunk
    [C]: ? 
```

这似乎意味着`iuplua.lua`文件中的错误。我通过从 sourceforge 下载二进制文件安装了 iup（我没有从源代码编译），并从 apt 存储库安装了 lua 5.1（我的项目需要 5.1。请不要推荐并升级到 5.2）。我正在运行 Mint 13。

非常感谢任何有关解决这些问题的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T16:55:47.970

您的 Lua 配置必须在寻找“iuplua51”文件，如果没有查看 IUP 或 LuaBinaries 文档以了解如何设置它。

[http://luabinaries.sourceforge.net/](http://luabinaries.sourceforge.net/)

# .net - 此代码中的 Continue 和 GoTo Start 之间有什么区别吗？

> ID：12623082
> 
> 赞同：0
> 
> 时间：2012-09-27T13:56:12.250
> 
> 标签：.net, vb.net, syntax, coding-style, continue

```
 While True
Start:
        Continue While
        GoTo(Start)
    End While 
```

注意：我知道 GoTo 在此示例中永远无法到达。我只是想知道使用 GoTo (X) 和 (Exit / Continue) 语句之间是否存在任何计算差异？我倾向于使用 GoTo 语句，即使 Continue 或 Exit 就足够了。这是不好的风格吗？我不经常在其他程序员的代码中看到 GoTo。

编辑：正如人们亲切地指出的那样，GoTo 不会在有条件的 while 循环中评估条件。这让我问以下两段代码是否会编译成完全相同的 CLR 代码：

```
Dim x as Integer = 0
While x < 5
    Continue
End While 
```

和

```
 Dim x As Integer = 0
JumpPoint:
    If x < 5 Then
        GoTo JumpPoint
    End If 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T13:59:27.340

有一点区别：对于`Continue`，重新评估 while 循环的条件，`GoTo`简单地从 Start 标签继续执行而不查看 while 条件。

```
Start:

    GoTo(Start) 
```

将与

```
While True
    Continue While
End While 
```

就“发生了什么”而言。但是一旦引入条件，`GoTo`就不会这样做。

* * *

对于您更新的问题：是的，再次有一个区别。第一个语句包括`Continue`which （基本上）与 `GoTo`. 但是，您的示例中未包含的情况是，由于在两者之间发生的任何操作而未调用`Continue`or的情况。`GoTo`如果`Continue`跳过，`End While`则将循环到下一个`While`评估并运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T13:58:25.823

如果在循环条件下进行任何评估，则会有所不同，例如：

```
While var < 5 
```

通过使用`goto(start)`的值`var`不会再次评估。

至于编码风格，没有人会阻止你使用`goto`但已经跳转`continue`到定义明确的代码点，在许多情况下`exit`降低了它的有用性。`goto`

# visual-studio - 如何在 Visual Studio 项目命令/属性值中转义 $

> ID：12623083
> 
> 赞同：1
> 
> 时间：2012-09-27T13:56:17.127
> 
> 标签：visual-studio

我想在我的 Visual Studio 项目中创建一个使用 $ 符号的自定义构建命令，例如

```
echo $(SomethingIDontWantExpanded) > MyFile 
```

我似乎无法弄清楚如何进入`$(SomethingIDontWantExpanded)`文件，它总是放入一个空字符串（因为它试图将它扩展为一个变量）。我试过了`$$(SomethingIDontWantExpanded)`，，，`\$(SomethingIDontWantExpanded)`...

# html - 为什么我的页脚不粘？

> ID：12623084
> 
> 赞同：0
> 
> 时间：2012-09-27T13:56:18.053
> 
> 标签：html, css, footer

我想将页脚粘贴到页面的最底部而没有间距，因此它在每个屏幕上都显示相同。

这是它目前的样子：

[http://www.slyfiles.com/login.php](http://www.slyfiles.com/login.php)

页脚代码：

```
<div class="footer">
<div class="container">
<span id="footer"> &copy; 2012 SlyFiles &nbsp;<a href="#">About</a>  &nbsp<a     href="#">TOS</a>  &nbsp<a href="#">DMCA</a>  </span>
</div>
</div> 
```

和CSS：

```
.footer {
background: #1d1d1d;
width: 100%;
height: 32px;
border-top: solid 10px #017cc5;
margin-top: 5px;
} 
```

为什么它不会粘在底部？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T13:58:10.847

将此添加到您的 CSS 中`.footer`：

```
position: fixed;
bottom: 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:03:02.507

看这里：

[http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)

[http://matthewjamestaylor.com/blog/bottom-footer-demo.htm](http://matthewjamestaylor.com/blog/bottom-footer-demo.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:07:36.340

添加 clear:both 也。

```
.footer{
clear:both;
} 
```

我关注了[http://www.cssstickyfooter.com/](http://www.cssstickyfooter.com/)

# asp.net-mvc-3 - Ravendb Lambda (OrderBy) 获取 NotSupportedException

> ID：12623085
> 
> 赞同：1
> 
> 时间：2012-09-27T13:56:19.590
> 
> 标签：asp.net-mvc-3, linq, lambda, ravendb

全部...

我正在使用使用 NuGet 和 MVC 3 的 RavenDB 嵌入式最新稳定版本。

```
 public JsonResult GetStudents(GridFilter filter)
    {
        using (var session = _store.OpenSession())
        {
            var students = session.Query<Student>();
            students.OrderBy(x => x.FirstName);

            return Json(students.ToList());
        }
    } 
```

此代码不会中断。它也不按 Student.FirstName 排序。我查看了 RavenQueryInspector（将鼠标悬停在学生集合上），发现以下内容......

```
AsyncDatabaseCommands = '(((Raven.Client.Linq.RavenQueryInspector<UMA.KendoGrid.Entities.Student>)(students))).AsyncDatabaseCommands' threw an exception of type 'System.NotSupportedException' 
```

如果我做

```
var students = from x in session.Query<Student>()
        orderby x.FirstName descending
        select x; 
```

效果很好。首先，我不明白为什么在使用 long linq 语法时使用 lambda 会失败。我真正需要的是按任何领域过滤学生，因为我使用的是具有排序能力的网格。我想使用 Microsoft 的 System.Linq.Dynamic 文件按字符串名称排序，这样我就可以按排序集合中传递的任何字段进行排序。

但是，要开始，我想我需要弄清楚为什么我的 RavenDB 嵌入式版本不允许我使用 lambda 表达式。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T13:58:15.780

关于这个声明：

```
students.OrderBy(x => x.FirstName); 
```

...您忽略了通话的结果。这是“忽略字符串调用的结果”错误的 LINQ 等效项：

```
text.Substring(5, 10); 
```

LINQ 调用永远不会改变它们被调用的内容——它们会返回一个经过适当转换的新集合。所以你要：

```
students = students.OrderBy(x => x.FirstName); 
```

或更好：

```
var students = session.Query<Student>.OrderBy(x => x.FirstName); 
```

# xml - 使用 XSL 复制 XML 并省略元素/属性的值

> ID：12623093
> 
> 赞同：3
> 
> 时间：2012-09-27T13:56:40.407
> 
> 标签：xml, xslt

行。使用 XSLT 复制 XML 文件并创建精确副本但没有任何值是否容易。基本上我只想要布局。IE

```
<rootnode lang="EN">
    <child1>Hello</child1>
    <child2>
        <child2_1>hello</child2_1>
    </child2>
</rootnode> 
```

和输出

```
<rootnode lang="">
    <child1></child1>
    <child2>
        <child2_1></child2_1>
    </child2>
</rootnode> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:15:05.643

**身份规则的这个简单修改**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="@*">
  <xsl:attribute name="{name()}" namespace="{namespace-uri()}"/>
 </xsl:template>
 <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<rootnode lang="EN">
    <child1>Hello</child1>
    <child2>
        <child2_1>hello</child2_1>
    </child2>
</rootnode> 
```

**产生想要的正确结果：**

```
<rootnode lang="">
   <child1/>
   <child2>
      <child2_1/>
   </child2>
</rootnode> 
```

# search - 从搜索窗格中删除查询提交的处理程序

> ID：12623096
> 
> 赞同：2
> 
> 时间：2012-09-27T13:56:50.260
> 
> 标签：search, microsoft-metro, winrt-xaml

根据许多在线示例，我通过将处理程序附加到应用程序的搜索窗格来在 Metro 应用程序中实现搜索：

```
public void DoSearch() {
    var mySearchPane = SearchPane.GetForCurrentView();
    if (null == mySearchPane) return;
    mySearchPane.QuerySubmitted +=
        new TypedEventHandler<SearchPane, SearchPaneQuerySubmittedEventArgs>(OnQuerySubmitted);
    mySearchPane.Show();
}

private void OnQuerySubmitted(...) {
    // ...blah, blah
} 
```

问题：QuerySubmitted 事件的处理程序是否最终需要在搜索结束后删除？如果必须删除它，那么在搜索完成后如何删除事件处理程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:27:52.513

看起来您正在连接特定的用户操作，例如单击按钮，以启动搜索，包括连接到搜索事件。这不是正确的方法。

您可能希望在创建页面时调用`SearchPane.GetForCurrentView`并挂钩`QuerySubmitted`一次事件。用户可以随时调用 Charm 栏并执行搜索。如果我的假设是正确的，那么您的应用程序将无法处理这种情况。

如果您想从 UX 打开搜索窗格（顺便说一句，这通常不是一个好的 UX 实践），那么您需要将 mySearchPane 设置为一个类变量，可以随时访问页面的其余部分并`mySearchPane.Show()`从您的内部调用像现在一样单击处理程序。

如果您以这种方式处理事情，则无需担心断开`QuerySubmitted`处理程序，因为当您离开页面时，处理程序将被清理。

# html - 在换行上排列浮动元素

> ID：12623103
> 
> 赞同：0
> 
> 时间：2012-09-27T13:57:15.777
> 
> 标签：html, css, css-float, responsive-design

我有以下设置：http: [//jsfiddle.net/GdDhT/](http://jsfiddle.net/GdDhT/)

当浮动div的行换行时，第二行的第一个不是我想要的（因为它上面的div的大小）

我不能像这样添加一个清除 div：

因为当屏幕变大时，#floating-div-1, 2 和 3 会并排出现在一行中。出于同样的原因，我无法在特定的 div 上添加清除。:nth-child css 规则也有同样的问题。

这是响应式设计的一部分，所以我不能依赖精确的宽度计算，因为 div 的大小会有所不同。

根据屏幕尺寸，我想要达到的结果是：![在此处输入图像描述](../Images/9fd22dfaa43480f1a8db24b6e2cb4a44.png)

或者

![在此处输入图像描述](../Images/23e943946a1bba72f2c7a027ef0553e4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:10:41.503

第 n 个孩子可能会帮助你 - 让每一行的第一个 div 清楚它是剩下的：

```
#parent-div div:nth-child(2n-1){
    clear: left;
} 
```

jsfiddle：http: [//jsfiddle.net/k5DXN/1/](http://jsfiddle.net/k5DXN/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T01:14:26.640

将您的每个 div 包装在具有 min-height 的 div 包装器中，然后它们会像您想要的那样破裂。但这也意味着您的包装器是固定高度。这种类型的解决方案适用于 jQuery，它可以获取第一个内容 div 的高度并将包装器 div 的其余部分设置为它的高度。

我已经更新了[jsFiddle](http://jsfiddle.net/GdDhT/1/)， box-shadow 只是为了显示包装的最小高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:09:49.627

不确定我是否完全理解您的不同用例，但添加：

```
clear:left 
```

应该把`#floating-div-3`它撞到下面`#floating-div-1`。

# html - SVG 或 Canvas：填充/着色 2 个圆圈的重叠区域

> ID：12623106
> 
> 赞同：0
> 
> 时间：2012-09-27T13:57:21.273
> 
> 标签：html, canvas, svg

我试图找到一种方法来填充两个任意重叠的圆圈区域。

在我正在使用的工具中，用户可以创建圆圈并在屏幕上拖动它们。如果两个或多个圆圈重叠，用户可以选择重叠区域（想想维恩图）。我需要用颜色或渐变填充重叠区域。

这可以在浏览器中使用 SVG 和/或 Canvas 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T18:14:00.150

我想出了一个办法：

1.  我用easeljs（html5画布）正常画了2个圆圈
2.  使用“destination-in”的复合操作在单独的容器中再次绘制 2 个圆圈
3.  缓存容器（否则合成操作会吹走整个图像）
4.  将缓存的容器添加到舞台

代码：

```
var s1 = new createjs.Shape(), 
    s2 = new createjs.Shape(), 
    s3 = new createjs.Shape(),
    s4 = new createjs.Shape(),
    c1 = new createjs.Container(),
    c2 = new createjs.Container(),
    container = new createjs.Container();

s1.graphics.ss(2).beginStroke("black").beginLinearGradientFill(["#f6f6f6","#e5e5e5"],[0,1],0,-40,0,40).drawCircle(0,0,40);
s1.x = s1.y = 80;
c1.addChild(s1);

s2.graphics.ss(2).beginStroke("black").beginLinearGradientFill(["#f6f6f6","#e5e5e5"],[0,1],0,-40,0,40).drawCircle(0,0,40);
s2.x = s2.y = 120;
c1.addChild(s2);

container.addChild(c1);         

s3.graphics.ss(2).beginStroke("black").beginRadialGradientFill(["#FFF","#0FF"],[0,1],0,0,0,0,0,40).drawCircle(0,0,40);
s3.x = s3.y = 80;
c2.addChild(s3);

s4.graphics.ss(2).beginStroke("black").beginLinearGradientFill(["#f6f6f6","#e5e5e5"],[0,1],0,-40,0,40).drawCircle(0,0,40);
s4.x = s4.y = 120;
s4.compositeOperation = "destination-in"
c2.addChild(s4);
c2.cache(0,0,220,220);

container.addChild(c2); 
```

# jquery - 如何选择表单上的所有选择元素，除了具有特定类的选择元素

> ID：12623110
> 
> 赞同：0
> 
> 时间：2012-09-27T13:57:26.393
> 
> 标签：jquery, select

标题几乎是不言自明的。我需要选择表单上的所有选择元素，除了那些具有“.notSelectable”类的元素

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T13:58:06.860

```
$('#yourform select').not('.notSelectable') 
```

或者

```
$('#yourform select:not(.notSelectable)') 
```

[通常首选](http://api.jquery.com/not-selector/)第一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:00:59.730

尝试[.not()](http://api.jquery.com/not/)方法

```
$("select").not('select.notSelectable'); 
```

# c++ - python <=> c++ 跨语言哈希

> ID：12623111
> 
> 赞同：4
> 
> 时间：2012-09-27T13:57:27.510
> 
> 标签：c++, python, hash

我正在编写一个 python 程序来查找文件。该文件由 C++ 程序创建，文件名 ( `std::hash<std::string> hash_fn`) 为散列。我知道创建散列的字符串，但我找不到产生相同散列的python散列函数（我试过`hash()`了`hashlib`）。例如，字符串

```
file:///home/ubuntu/Untitled.skp 
```

应该给出哈希：

```
3133433022 
```

不幸的是，我无法控制 C++ 程序，只能控制 python 脚本（或最终的 python 扩展）。是否有可能找到或实现 C++ 使用的相同哈希函数？还是我应该尝试另一种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:14:18.193

在大多数情况下，内部散列函数（如`std::hash`C++ 或 Python 散列函数）不是为外部使用而设计的。当您设计此类系统时，请严格指定使用的散列函数，并在两个系统中实现它。

如果为时已晚，并且您已经使用过`std::hash`，那么您所能做的就是找到它的源（取决于编译器，可能不可用），对它们进行反向工程以找到使用的散列算法，指定它作为你的哈希，并用任何需要的语言重新实现它。（您需要在自己的代码中实现它，因为它可能会在编译器的下一个版本中发生变化。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:11:06.433

为了兼容，请在两侧使用已知的哈希，例如 SHA-1。Python 内置了它，如果 c++ 没有内置它，那么有很多库可以。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T14:04:40.440

如果您可以控制 C++ 部分，则可以确保在双方都使用相同的散列算法。或者，您可以随时查看 的实现`hash_fn`并尝试在 Python 中重新实现相同的功能。

否则可能很难尝试匹配散列功能。

# .htaccess - 重定向到子目录中的文件（如果存在）

> ID：12623116
> 
> 赞同：0
> 
> 时间：2012-09-27T13:57:33.690
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

我有一个包含此代码的“.htaccess”文件：（
它应该重定向名称，如“P7-product_number_7”）

```
RewriteEngine On
RewriteBase /
# if:
RewriteCond %{DOCUMENT_ROOT}/cache%{REQUEST_URI}.html -f
# then:
RewriteRule ([A-z])([0-9]+)-([^/]*)?$ /cache%{REQUEST_URI}.html [B,L]
# else:
RewriteRule ([A-z])([0-9]+)-([^/]*)?$ index.php?type=$1&id=$2&label=$3 [B,L] 
```

检查文件是否存在（在“缓存”目录中）工作正常，但重定向不起作用。
***为什么 ？***

我曾尝试使用“ **RewriteRule ^(.*)$ /cache/$1.html [L]** ”而不是第一个 RewriteRule，但它也没有用。
（如果 HTML 文件不存在（在 /cache/ 中）的重定向工作正常，'.htaccess' 和 'cache/' 目录在 '/var/www' 目录中，所以 %{REQUEST_URI} 是 "/P7 -product_number_7")

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:59:01.870

您的规则正在循环，因为您没有检查 URI 的开头。您可能会注意到`label` **$_GET**参数是**product_number_7.html**，`.html`最后是 。这意味着正在应用第一个规则，然后是规则循环，但第二次第一个条件失败（因为没有`P7-product_number_7.html.html`）所以第二个规则被应用：

1.  URI =`/P7-product_number_7`
2.  条件检查：`%{DOCUMENT_ROOT}/cache%{REQUEST_URI}.html -f`-> true
3.  应用规则：匹配`([A-z])([0-9]+)-([^/]*)?$`-> true
4.  URI重写为`/cache/P7-product_number_7.html`
5.  启动 URI `/P7-product_number_7`!= `/cache/P7-product_number_7.html`，重写引擎循环：
    1.  URI =`/cache/P7-product_number_7.html`
    2.  条件检查：`%{DOCUMENT_ROOT}/cache%{REQUEST_URI}.html -f`-> **false**（`/cache/cache/P7-product_number_7.html.html`不存在）
    3.  应用规则：matches `([A-z])([0-9]+)-([^/]*)?$`-> true（匹配 URI 的 /cache/ **P7-product_number_7** .html 部分）
    4.  URI被重写为`/index.php?type=P&id=7&label=product_number_7.html`

因此，您要么需要在规则的开头添加一个不再重写的直通：

```
RewriteCond %{ENV:REDIRECT_STATUS} 200
RewriteRule ^ - [L] 
```

或者您可以简单地匹配正则表达式中 URI 的开头：

```
# need ^ ---v
RewriteRule ^([A-z])([0-9]+)-([^/]*)?$ /cache%{REQUEST_URI}.html [B,L]
# and here -v:
RewriteRule ^([A-z])([0-9]+)-([^/]*)?$ index.php?type=$1&id=$2&label=$3 [B,L] 
```

# css - 为什么在这个例子中 CSS 相对定位不能正常工作？

> ID：12623120
> 
> 赞同：2
> 
> 时间：2012-09-27T13:57:39.363
> 
> 标签：css, css-position

我正在用 CSS 定位做一些测试，我注意到一个奇怪的行为。

假设我有一个绝对定位的容器 div（红色）。在这个 div 中，我想放置两个块（绿色和蓝色），与容器相对位置。这些块应该粘在顶部并且它们之间有 50 像素的距离，如下所示

![在此处输入图像描述](../Images/b02166682ab9ccfc4d3663364d3bb8a3.png)

所以我想我应该用`top:0px; left:0px;`第一个，把他放在左上角附近。我在其宽度上添加 50 作为间距，然后得到`top:0px; left: 100px;`第二个块。[（这里](http://jsfiddle.net/BBog/Wfqvc/)是jsfiddle ）。

我没有看到预期的行为，而是得到了这个定位

![在此处输入图像描述](../Images/52eeef71f7b3134319a27a4b6ae943d1.png)

似乎第二个块`top`相对于第一个块，而不是父容器。所以第二个块的正确 CSS 代码应该是`top: -50px; left: 100px;`，就像在[这个](http://jsfiddle.net/BBog/Wfqvc/1/)小提琴中一样。

这不是我第一次注意到这一点。在某些情况下，`left`财产是有过错的，在这种情况下是`top`.

无论如何，我知道**如何**解决这些问题并获得正确的显示，但我不明白**为什么**它不能像我认为的那样工作。

我很可能误解了整个绝对/相对定位，但我不知道它是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:00:12.803

第二个块有它的`top`和`left`相对于*自身*，而不是第一个块或父容器。

当您相对定位某物时，它的偏移值会在这些方向上将其从应用相对定位之前的原始位置移开。偏移量永远不会基于其兄弟姐妹、祖先或后代的位置（除非它们是`auto`，这是它们的初始值）。

# php - Laravel 不能使用 mysql_real_escape_string()

> ID：12623121
> 
> 赞同：3
> 
> 时间：2012-09-27T13:57:43.503
> 
> 标签：php, mysql, laravel

尝试`mysql_real_escape_string()`在 Laravel 中使用时出现数据库连接错误。Fluent 查询正常工作，因此我假设数据库已正确配置。

应该如何`mysql_real_escape_string()`从 Laravel 中使用？由于 Fluent 的限制，我正在使用它来转义我需要自己构建的 SQL 查询中的值。

**构建我自己的 SQL 查询的 PHP 代码**

```
 foreach($listings as $listing) {
        $listing = get_object_vars($listing);
        $query = 'INSERT IGNORE into archive ';
        $query .= '(' . implode(',', array_keys($listing)) . ') ';
        $query .= 'VALUES(' . implode(',', array_values( array_map('mysql_real_escape_string', $listing) )) . ')';
        DB::query($query);
    } 
```

**错误**

```
mysql_real_escape_string() [function.mysql-real-escape-string]: 
Access denied for user 'nobody'@'localhost' (using password: NO) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-01-07T10:43:29.823

改为使用`DB::connection()->getPdo()->quote()`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-09T22:22:02.703

我对此的解决方案：

1.  在 app/lib/helpers.php 中创建自定义帮助文件
2.  将此添加到 composer.json 中的自动加载：

    ```
    "files": [
        "app/lib/helpers.php"
    ], 
    ```

3.  添加此功能（在 php.net 上找到）

    ```
    if ( !function_exists('mysql_escape'))
    {
        function mysql_escape($inp)
        { 
            if(is_array($inp)) return array_map(__METHOD__, $inp);

            if(!empty($inp) && is_string($inp)) { 
                return str_replace(array('\\', "\0", "\n", "\r", "'", '"', "\x1a"), array('\\\\', '\\0', '\\n', '\\r', "\\'", '\\"', '\\Z'), $inp); 
            } 

            return $inp; 
        }
    } 
    ```

4.  `php artisan dump-autoload`

现在您可以在代码中的任何地方使用 mysql_escape。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-27T14:02:24.117

`mysql_real_escapes_string()`使用创建的数据库链接`mysql_connect()`，所以它只能在你调用之后使用`mysql_connect()`。

关于这一点的重要说明（来自评论）：

> .. 但不应在选择 PDO 为数据库驱动程序的环境中使用。事实上， mysql_connect() 根本不应该再使用了。– 罗宾诉 G.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-27T14:01:09.747

Laravel 使用[PDO](http://php.net/manual/en/book.pdo.php)，所以没有转义，只是准备好的语句。请参阅[有关数据库的 Laravel 手册](http://laravel.com/docs/database/raw)。

# jquery - 谷歌地图地方api

> ID：12623123
> 
> 赞同：1
> 
> 时间：2012-09-27T13:57:49.563
> 
> 标签：jquery, google-maps, google-places-api

我正在使用 google place api。这是我的代码，它运行良好，但是当我在过去的某个时间后刷新页面时，萤火虫一直给我这个错误**google.maps.event is undefined**。

我看萤火虫的网络标签我看到**GET js?sensor=false&libraries=places Aborted maps.googleapis.com**

我该如何解决这个问题？

`<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script>`

```
 var map;
  var infowindow;

  function initialize() {
    var pyrmont = new google.maps.LatLng(-33.8665433, 151.1956316);

    map = new google.maps.Map(document.getElementById('mapCanvas'), {
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      center: pyrmont,
      zoom: 15
    });

    var request = {
      location: pyrmont,
      radius: 500,
      types: ['school']
    };
    infowindow = new google.maps.InfoWindow();
    var service = new google.maps.places.PlacesService(map);
    service.search(request, callback);
  }

  function callback(results, status) {
    if (status == google.maps.places.PlacesServiceStatus.OK) {
      for (var i = 0; i < results.length; i++) {
        createMarker(results[i]);
      }
    }
  }

  function createMarker(place) {
    var placeLoc = place.geometry.location;
    var marker = new google.maps.Marker({
      map: map,
      position: place.geometry.location
    });

    google.maps.event.addListener(marker, 'click', function() {
      infowindow.setContent(place.name);
      infowindow.open(map, this);
    });
  }

  google.maps.event.addDomListener(window, 'load', initialize); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T11:35:04.907

Google 建议您始终在 script 标签的 src 属性中提到的 URL 中使用 Google API Key。

js?sensor=false&libraries=places& **key=xxxxxxxxxxxxxxxx**

请尝试并告诉我。

问候

戈文达拉扬

# node.js - 自己的直通流不管道数据

> ID：12623124
> 
> 赞同：2
> 
> 时间：2012-09-27T13:57:53.770
> 
> 标签：node.js, stream

我目前正在学习 node.js 流，因此我想编写自己的自定义流模块。这是我目前所拥有的：

index.js：

```
fs = require("fs")
var module = require("./module")
var ws = fs.createWriteStream("out.txt")

fs.createReadStream("in.txt")
  .pipe(module())
  .pipe(ws) 
```

模块.js：

```
var Stream = require('stream').Stream;

module.exports = function() {
  var stream = new Stream();

  this.writable = true;
  this.readable = true;

  stream.write = function(data) {
    console.log("write")
    stream.emit("data", data)
  }

  stream.end = function() {
    console.log("end")
    stream.emit("end")
  }

  stream.destroy = function() {
    console.log("destroy")
    stream.emit("close")
  }

  return stream;
} 
```

在.txt：

```
text
text
text
text
text
text
text
text
text
text 
```

问题是它`out.txt`是空的并且该`stream.write`函数永远不会被调用。为什么呢？如果我注释掉我的中间管道一切正常！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:49:06.057

您的代码中有一个可以轻松修复的错误。

`module.js`变化中：

```
this.writable = true;
this.readable = true; 
```

至：

```
stream.writable = true;
stream.readable = true; 
```

它会起作用。

此外，如果您想了解有关如何使用流的更多信息，substack 以[流手册](https://github.com/substack/stream-handbook)的形式创建了一个很好的资源。

# asp.net - ASP.NET MVC4 - 使用模型在 2 个单独的 MySQL 表中创建新记录

> ID：12623128
> 
> 赞同：0
> 
> 时间：2012-09-27T13:58:07.873
> 
> 标签：asp.net, mysql, asp.net-mvc, razor

我有一个控制器，“硬件”，它有一个“创建”动作。

模型看起来像：

```
namespace Inventory.Models
{
public class HardwareModel
    {
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int ID { get; set; }

    public string UPDATED { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "Brand")]
    public string BRAND { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "Model")]
    public string MODEL { get; set; }
    }
} 
```

这与生成的 /Hardware/Create/ 控制器一起工作得很好（创建操作使用 Razor 模板），但是，当创建一个新项目时，我还想更新另一个表来跟踪哪个项目被更新（来自 HardwareModel 的 ID）以及更新时间。我能够获得我需要的这两个字段 - 但我的问题是，如何扩展此模型以在 2 个单独的表中创建新记录？（使用 MVC4）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:17:12.997

这听起来像是服务层的候选方法。

如果您的业务逻辑规定创建 HardwareModel 实体还需要创建两个其他实体，请在服务方法中强制执行该规则并单元测试调用这两个实体的创建方法。

# php - 三个小时过去了吗？

> ID：12623139
> 
> 赞同：0
> 
> 时间：2012-09-27T13:58:47.653
> 
> 标签：php, mysql

我想设置一个 url 在用户单击忘记密码按钮后 3 小时过期，但我不知道将当前时间与时间戳进行比较以检查它是否超过 3 小时。

前任。在数据库中

request_time(timestamp) = 2012-10-22 02:00:00

expire_time(timestamp) = 2012-10-22 05:00:00

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:02:39.930

这就是我要做的：

1.  在 MySQL 中创建一个整数列，在生成 URL 时存储当前时间戳（使用 strtotime('now')）
2.  在 PHP 中，当有人使用链接时，我会检查`strtotime('now')`存储的时间戳

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:01:43.197

```
<?php

if( strtotime('2012-10-22 02:00:00') + 60*60*3 < time() )
{
    // expired
} 
```

# c# - 使用函数在 SQL 查询中出错

> ID：12623142
> 
> 赞同：3
> 
> 时间：2012-09-27T13:58:52.023
> 
> 标签：c#, sql, sql-server-2008-r2

当我通过 C# 适配器运行此查询时，它会导致错误：

> *使用附近的语法不正确*

有任何想法吗？当我在 SQL Server 2008 R2 中运行它时，它工作正常。

```
create FUNCTION [dbo].[fn_Split] (@sep nvarchar(10), @s nvarchar(4000))
RETURNS table
AS
  RETURN (
  WITH Pieces(pn, start, stop) AS (
  SELECT 1, 1, CHARINDEX(@sep, @s)
  UNION ALL
  SELECT pn + 1, stop + (datalength(@sep)/2), 
    CHARINDEX(@sep, @s, stop + (datalength(@sep)/2))
  FROM Pieces
  WHERE stop > 0
)
SELECT pn,
SUBSTRING(@s, start, CASE WHEN stop > 0 THEN stop-start ELSE 4000 END) AS value
FROM Pieces
)
;

/****** Object: Table [dbo].[drillDowntable1] Script Date: 09/24/2012 18:43:32 ******/
USE [master]

SET ANSI_NULLS ON
;
SET QUOTED_IDENTIFIER ON
;
SET ANSI_PADDING ON
;
CREATE TABLE [dbo].[drillDowntable1](
[id] [int] IDENTITY(1,1) NOT NULL,
[name] [varchar](20) NULL,
[json] [varchar](max) NULL,
[isActive] [bit] NOT NULL
) ON [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T14:03:25.527

你需要一个`GO`把东西放在自己的批次里。

```
FROM Pieces
)
;

GO -- < this is important
/****** Object: Table [dbo].[drillDowntable1] Script Date: 09/24/2012 18:43:32 ******/
USE [master] 
```

# jsf - XHTML 和视口标签

> ID：12623143
> 
> 赞同：4
> 
> 时间：2012-09-27T13:58:54.760
> 
> 标签：jsf, jquery-mobile, xhtml, viewport

建议使用 Viewport 标签（如下），以优化移动浏览器中的缩放级别：

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

上面的想法在[这里](http://jquerymobile.com/demos/1.2.0-rc.1/docs/pages/page-anatomy.html)和[这里](https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag)都提到了。

我在我的项目中使用 jQuery Mobile 和 JSF，因此使用了 XHTML 页面。

XHTML 不允许像上面那样使用视口标签，而是需要一个结束标签，如下所示：

```
<meta name="viewport" content="width=device-width, initial-scale=1"/> 
```

但如果与结束标签一起使用，缩放级别与 iPhone 中的预期不同。

# macos - MAC OS 在强制退出应用程序之前要求输入密码

> ID：12623148
> 
> 赞同：2
> 
> 时间：2012-09-27T13:59:11.037
> 
> 标签：macos, cocoa, kiosk

我正在使用可可开发一个应用程序，它只允许管理员关闭或退出我的应用程序，如果我的应用程序在访客帐户上运行，我不希望访客强制退出它。当访客用户尝试强制退出应用程序时，无论如何都会弹出密码窗口。

我正在使用 Kiosk 模式，当我的应用程序全屏时，强制退出被禁用，但是当它不是全屏时，用户仍然可以强制退出它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:06:27.637

这是不可能的。强制退出由系统控制。如果您能够阻止它，它将允许您创建恶意软件。

[如果您认为自己有一个有效的用例，您应该在http://bugreporter.apple.com](http://bugreporter.apple.com)提交增强请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-09T18:37:32.543

使您的应用程序成为代理（应用程序是代理=true）您的应用程序不会出现在用户强制关闭的列表中。

# python - 删除 MacPorts 并安装自制软件后的 Python 库

> ID：12623155
> 
> 赞同：1
> 
> 时间：2012-09-27T13:59:30.600
> 
> 标签：python, macports, homebrew

我最近删除了 Macports 及其所有软件包，并使用 Homebrew 安装了 Python、Gphoto 和其他一些位。但是，python 在查找库时会崩溃，因为它正在 MacPorts 路径中查找它们。我的 PATH 是正确的，python 配置显示正确的路径 /usr/local/Cellar 等。

有人可以告诉我如何设置 Python 以使用通过 Homebrew 安装的库，我想有效地改变路径吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:16:30.143

我不会在 Homebrew 中使用 Macports 包。我会重新安装它们。很多 Python 包都是编译的，或者至少有编译的元素。你要求很多潜在的麻烦将它们混合在一起。

# .net - 像 Nintex Workflow 这样的 CRM Dynamics Workflow Designer？

> ID：12623156
> 
> 赞同：0
> 
> 时间：2012-09-27T13:59:32.333
> 
> 标签：.net, dynamics-crm, workflow-foundation-4, crm, sharepoint-designer

我有相当复杂的工作流程要开发。我当然可以选择 SharePoint + Nintex Workflow，但作为技术限制，我必须使用 CRM 工作流。

我希望我能找到像 Nintex Workflow for CRM Dynamics 这样的东西，可以集成到它的设计器中；就像 Nintex 对 SharePoint 所做的那样。这样我就可以在 CRM 本身中设计**复杂的工作流程**，而不是使用 SharePoint——想法是将 CRM 用作 xRM 本身。

在这种情况下，我可以依靠以下内容：

*   简单的工作流程 --> 使用 CRM 设计器
*   复杂 --> 使用 Nintex Workflow + windows 工作流基础

**问：CRM2011可以用来开发复杂的工作流程吗？使用 WWF 或任何其他第三方工作流引擎？**

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T19:38:14.473

You can create custom XAML workflows and registered them in Dynamics CRM 2011 using Visual Studio (or theoretically other commercial products), but this is only support for the On-premise installation.

See this link for more information: [http://msdn.microsoft.com/en-us/library/gg309458.aspx](http://msdn.microsoft.com/en-us/library/gg309458.aspx)

# javascript - 在 css/js 中：在鼠标悬停时创建链接（悬停）显示 h1 中的内容

> ID：12623157
> 
> 赞同：1
> 
> 时间：2012-09-27T13:59:34.380
> 
> 标签：javascript, css, hyperlink

我有一个 css 文件，我想将其添加到链接选项中，以使它们从链接页面中抓取并显示第一个 h1 标记，并在鼠标悬停在链接上时显示它（作为标题或 alt 文本）。（或者如何使用中央 javascript 文件来做到这一点？

示例：[http](http://en.wikipedia.org/wiki/Main_Page) ://en.wikipedia.org/wiki/Main_Page 该页面中的任何链接，显示链接页面的标题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:02:36.513

除非我遗漏了您的问题，否则您只是在谈论常规的 HTML Title 属性。至少，在您的示例页面上，这就是正在发生的一切 - 链接有标题。

# database - 搜索子表单，数据不匹配错误

> ID：12623163
> 
> 赞同：1
> 
> 时间：2012-09-27T13:59:47.777
> 
> 标签：database, ms-access

我正在使用 Access 2007。

我有一个 txt 框，用于过滤名为 fsGetRFIDOwnership 的子表单。

我正在使用的代码在 txtbox 的更新后如下。

Me.fsGetRFIDOwnership.Form.Filter = "RFID = '" & Me.txtSearch & "' OR Country = '" & Me.txtSearch & "' OR BuildingName = '" & Me.txtSearch & "' OR RFIDType = '" & Me.txt 搜索 & "'"

我遇到的问题是这一切都很好，直到我也添加了 RFID 搜索，RFID 是一个自动编号。现在我得到一个数据不匹配错误。其他字段是文本。这里到底出了什么问题，我该如何解决？或者有没有更好的方法来做到这一点？

干杯乍得维克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:03:39.077

不要对数字字段使用引号：

```
Me.fsGetRFIDOwnership.Form.Filter = "RFID = " & Me.txtSearch _
& " OR Country = '" & Me.txtSearch & "' OR BuildingName = '" _
& Me.txtSearch & "' OR RFIDType = '" & Me.txtSearch & "'" 
```

编辑

```
sCriteria = "Cstr(RFID) = '" & Me.txtSearch _
& "' OR Country = '" & Me.txtSearch & "' OR BuildingName = '" _
& Me.txtSearch & "' OR RFIDType = '" & Me.txtSearch & "'"

If DCount("ID","MyTable", sCriteria)>0 Then
    Me.fsGetRFIDOwnership.Form.Filter = sCriteria
    Me.fsGetRFIDOwnership.Form.FilterOn = True
End If 
```

# javascript - Jquery IE 问题，DOM 已更新，但页面未更新

> ID：12623164
> 
> 赞同：2
> 
> 时间：2012-09-27T13:59:49.933
> 
> 标签：javascript, jquery, internet-explorer, dom

我在 javascript/jquery 中工作，我的代码在 Chrome 和 FF 中工作。我需要它在 IE 中工作，但它不需要。输出中没有明确的错误，但我所做的没有效果。所有警报都表明一切正常。我正在使用这样的框架集：

```
<frameset rows="25%,75%">
    <frame name="frame1" src="ex.asp">
    <frameset cols="40%,60%">
        <frame name="frame2" src="wai.asp">
        <frame name="frame3" src="zee.asp">
    </frameset>
</frameset> 
```

我正在使用 JS 函数来填充第 1 帧中的表。当在第 2 帧或第 3 帧中选择某些内容时会发生这种情况。选择数据后，使用 Jquery 向表中添加一行。

```
var test = window.top;
var body = $(test.frames[0].document.body);
$(body).find('#TxList').append('<tr>').text(sPayload); 
```

还有一些表格是这样填充的：

```
window.top.frames[0].document.FORM.SELECTEDTX.value = sPayload; 
```

等等

因此，这适用于 Chrome 和 FF，但不适用于 IE。我曾经DebugBar并查看了页面的DOM，我的jquery数据出现在那里，好像没有问题一样。但是，它不会显示在页面上，也不会出现在“查看源代码”中。

我所有的脚本都在一个外部 .js 文件上。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:12:08.820

您需要`TD`添加文本并`TR`确保`#TxList``table`

尝试 -

```
$('#TxList').append('<tr><td>'+sPayload+'</td></tr>'); 
```

# c# - 询问c#反序列化

> ID：12623166
> 
> 赞同：1
> 
> 时间：2012-09-27T14:00:01.423
> 
> 标签：c#, deserialization

我有一个 XML：

```
<g1:Person xmlns:g1="http://api.google.com/staticInfo/">
  <g1:Id> 005008</g1:Id>
    <g1:age>23></g1:age>
    </g1:Person> 
```

如何将其反序列化为 Person 对象。

我只是想办法。

```
 XmlDocument xdc = new XmlDocument();
                xdc.Load(xmlpath);

                xdc.LoadXml(xdc.InnerXml.Replace("g1:",""));

                xdc.Save(xmlpath); 
```

任何其他方法使它变得容易。或使用它的高级方法。

```
 xs = new XmlSerializer(typeof(Person));
        XmlDocument xdc = new XmlDocument();
        xdc.Load(xmlpath);

        xdc.LoadXml(xdc.InnerXml.Replace("g1:",""));

        xdc.Save(xmlpath);

      Stream  stm = new FileStream(xmlpath, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);

   Person p= xs.Deserialize(stm) as Person; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:17:22.560

使用[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)类并为[XmlElement](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlelementattribute.aspx)和[XmlRoot](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlrootattribute.aspx)属性指定命名空间：

```
using System.Xml.Serialization;

...

// TODO: Move the namespace name to a const variable
[XmlRoot(ElementName = "Person", Namespace = "http://api.google.com/staticInfo/")]
public class Person
{
    [XmlElement(ElementName="Id", Namespace="http://api.google.com/staticInfo/")]
    public int ID { get; set; }
    [XmlElement(ElementName = "age", Namespace = "http://api.google.com/staticInfo/")]
    public int Age { get; set; }
}

...

string input =
    @"<g1:Person xmlns:g1=""http://api.google.com/staticInfo/"">
        <g1:Id>005008</g1:Id>
        <g1:age>23</g1:age>
      </g1:Person>";

XmlSerializer xmlSerializer = new XmlSerializer(typeof(Person));
Person person = (Person)xmlSerializer.Deserialize(new StringReader(input)); 
```

或者，可以在 XmlSerializer 的构造函数中指定默认命名空间，并且不指定 Namespace 属性：

```
XmlSerializer xmlSerializer = new XmlSerializer(typeof(Person), 
    "http://api.google.com/staticInfo/"); 
```

要确保命名空间前缀为“q1”，请指定要使用的[XmlSerializerNamespaces](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializernamespaces.aspx)。例如：

```
Person person; // Assuming it is populated as above
using(MemoryStream memoryStream = new MemoryStream())
{
    xmlSerializer.Serialize(memoryStream, person, 
        new XmlSerializerNamespaces(new [] { new XmlQualifiedName("q1", "http://api.google.com/staticInfo/") }));
    memoryStream.Flush();
    Console.Out.WriteLine(Encoding.UTF8.GetChars(memoryStream.GetBuffer()));
} 
```

表明：

```
<?xml version="1.0"?>
<q1:Person xmlns:q1="http://api.google.com/staticInfo/">
  <q1:Id>5008</q1:Id>
  <q1:age>23</q1:age>
</q1:Person> 
```

# sql - 删除动态 ROW_NUMBER() OVER ORDER BY 语句中的重复项

> ID：12623167
> 
> 赞同：1
> 
> 时间：2012-09-27T14:00:03.173
> 
> 标签：sql, sql-server-2005, refactoring

我有以下来自 SQL 语句的片段

```
ROW_NUMBER() OVER (ORDER BY CASE
    WHEN @SortBy = 'column1 ASC' THEN cast(column1 AS sql_variant)
    WHEN @SortBy = 'column2 ASC' THEN cast(column2 AS sql_variant)
    WHEN @SortBy = 'column3 ASC' THEN cast(column3 AS sql_variant)
    WHEN @SortBy = 'column4 ASC' THEN cast(column4 AS sql_variant)
    ELSE NULL
END ASC,
CASE
    WHEN @SortBy = 'column1 DESC' THEN cast(column1 AS sql_variant)
    WHEN @SortBy = 'column2 DESC' THEN cast(column2 AS sql_variant)
    WHEN @SortBy = 'column3 DESC' THEN cast(column3 AS sql_variant)
    WHEN @SortBy = 'column4 DESC' THEN cast(column4 AS sql_variant)
    ELSE NULL
END DESC) AS RowNumber 
```

它有效，但它非常重复，有没有办法使 ASC/DESC 也动态化，所以我不需要重复的`CASE`语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:11:34.910

您可以执行此操作的一种方法是在不同级别定义列别名，以便您可以引用它两次而无需重复表达式。

```
SELECT *,
       Row_number() OVER (ORDER BY 
                 CASE WHEN @SortBy LIKE '% ASC' THEN sort_col END ASC, 
                 CASE WHEN @SortBy LIKE '% DESC' THEN sort_col END DESC) AS RowNumber
FROM   YourTable
       CROSS APPLY (SELECT CASE
                             WHEN @SortBy LIKE 'column1 %' THEN Cast(column1 AS SQL_VARIANT)
                             WHEN @SortBy LIKE 'column2 %' THEN Cast(column2 AS SQL_VARIANT)
                             WHEN @SortBy LIKE 'column3 %' THEN Cast(column3 AS SQL_VARIANT)
                             WHEN @SortBy LIKE 'column4 %' THEN Cast(column4 AS SQL_VARIANT)
                           END) C(sort_col) 
```

不过，我会考虑为此使用动态 SQL。这种捕获所有查询将扼杀获得可以使用索引来避免排序的好计划的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:14:56.023

我不确定你是否会认为这更简单。它使用算术运算来获得结果，基于降序行号是总计数减去升序这一事实：

```
((case when @SortBy like '%DESC' then 1 else -1 end) *
 (case when @SortBy like '%DESC'
       then count(*) over ()
       else 0
  end) -
 (ROW_NUMBER() OVER
      (ORDER BY CASE WHEN @SortBy like 'column1%' THEN cast(column1 AS sql_variant)
                     WHEN @SortBy like 'column2%' THEN cast(column2 AS sql_variant)
                     WHEN @SortBy like 'column3%' THEN cast(column3 AS sql_variant)
                     WHEN @SortBy like 'column4%' THEN cast(column4 AS sql_variant)
                     ELSE NULL
                 END)
 )
) 
```

它确实将列列表限制为一个 case 语句。

# ruby-on-rails - Rails Resque 运行后台作业 - 它如何加速应用程序

> ID：12623168
> 
> 赞同：0
> 
> 时间：2012-09-27T14:00:04.533
> 
> 标签：ruby-on-rails, controller, resque, worker

我在 Raiscast 上关注了这个关于 Resque 的教程：[http: //railscasts.com/episodes/271-resque](http://railscasts.com/episodes/271-resque)

在教程中，有一个关于代码荧光笔的示例，它位于控制器的 #create 方法中：

```
def create
  @snippet = Snippet.new(params[:snippet])
  if @snippet.save
    uri = URI.parse('http://pygments.appspot.com/')
    request = Net::HTTP.post_form(uri, {'lang' => @snippet.language, 'code' => @snippet.plain_code})
    @snippet.update_attribute(:highlighted_code, request.body)
    redirect_to @snippet, :notice => "Successfully created snippet."
  else
    render 'new'
  end
end 
```

据说

> “通过 Rails 请求与外部服务通信通常是一个坏主意，因为它们可能会响应缓慢，因此会占用整个 Rails 进程和任何其他尝试连接它的请求。最好将外部请求移出到“

它想说的是：Resque 有助于加快 Rails 应用程序的速度。但是，我不太明白为什么/如何将这段代码移出控制器来加速应用程序。它寻找我只是将它从控制器移动到另一个库。谁能给我解释一下？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:44:53.343

如果您查看应用程序正在做什么，它正在调用外部应用程序 (pygments.appspot.com) 来执行突出显示。

让我们假设这个网站很受欢迎，因此需要 20 秒来响应。使用控制器中的代码，您的应用程序将花费您处理响应所需的时间，加上 pygments 在您的用户看到响应之前的 20 秒。

当您将其移至后台作业时，这 20 秒现在发生在后台，用户将能够看到响应，但不会突出显示语法。如果他们在突出显示完成后在 20 秒内刷新，那么他们会看到它。

因此，要回答您的问题，将代码移动到应用程序中的其他位置并不能加快速度。代码不会运行得更快。将代码移动到 a`background job`意味着对速度的影响不会影响对用户的响应时间。

# serialization - protobuf-net 并使用接口序列化链表

> ID：12623178
> 
> 赞同：3
> 
> 时间：2012-09-27T14:00:20.557
> 
> 标签：serialization, interface, protobuf-net

我遇到了 protobuf-net 的问题，并将其缩小到这个最简单的情况。我想要一个链表类型结构，其中一个类具有相同类型的属性。当我序列化它时，它工作得很好。但是，如果类型是接口而不是类，我会收到以下错误：一旦为 ConsoleApplication1.foo (ConsoleApplication1.ifoo) 生成了序列化程序，就无法更改类型

这是我必须生成此错误的代码：

```
class Program
{
    static void Main(string[] args)
    {
        var toSerialize = new foo();
        toSerialize.data = "foo1";

        var subf = new foo();
        subf.data = "foo2";

        toSerialize.subfoo = subf;

        using (var pbfsc = new FileStream("testfile.proto", FileMode.Create))
        {
            using (var cs = new GZipStream(pbfsc, CompressionMode.Compress))
            {
                ProtoBuf.Serializer.Serialize(cs, toSerialize);
            }
            pbfsc.Close();
        }
    }
}

[ProtoContract, ProtoInclude(2000, typeof(foo))]
public interface ifoo
{
    [ProtoMember(1)]
    string data { get; set; }
    [ProtoMember(2)]
    ifoo subfoo { get; set; }
}
[ProtoContract]
public class foo : ifoo
{

    [ProtoMember(1)]
    public string data { get; set; }
    [ProtoMember(2)]
    public ifoo subfoo { get; set; }
} 
```

我已经完成了所有关于该主题的阅读，但我看不出我做错了什么。我尝试将我的对象放在一个包装类中，因为它看起来类似于接口列表的问题（代码未显示），但这仍然没有帮助。

如果我将 subfoo 更改为 foo 类型，那么它可以正常工作，但在我更复杂的现实世界问题中，我宁愿坚持使用界面。我在这里做错了什么还是protobuf-net有问题？

非常感谢任何帮助。

干杯

亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T06:32:27.157

当顶层对象实现一个契约接口时，需要完成一些出色的工作来改进对*顶层对象的处理。*基本上，目前它只处理根对象的非接口部分，但处理属性/子对象等的接口。

您看到的异常*有点奇怪*`ifoo`-由于属性，我希望它及时知道`subfoo`，但是可以通过添加以下内容来避免这里的基本问题：

```
Serializer.PrepareSerializer<ifoo>(); 
```

在序列化代码之前（理想情况下很早；你只需要调用一次）。

但是，我还应该注意，您实际上在这里进行了双重序列化：当序列化`ifoo subfoo`属性时，它将从*接口*( `ifoo`)*和*具体类型 ( `foo`) 序列化修饰的成员。这些实际上是相同的值，所以这里有一些冗余。

我*想说*：从具体类型中去掉成员级别的属性，但是根对象故障使这有点问题。解决*这两个*问题（不再需要`PrepareSerializer`）的另一个修复是：

```
using ProtoBuf;
using System;
class Program
{
    static void Main(string[] args)
    {
        var root = new foo();
        root.data = "foo1";

        var subf = new foo();
        subf.data = "foo2";

        root.subfoo = subf;
        var toSerialize = new FooRoot { root = root };

        // this does the same as your file-code, but runs
        // both serialize and deserialize - basicaly, it is
        // a lazy way of checking it end-to-end
        var clone = Serializer.DeepClone(toSerialize).root;
        Console.WriteLine(clone.data); // "foo1"
        Console.WriteLine(clone.subfoo.data); // "foo2"
    }
}
[ProtoContract]
public class FooRoot
{
    [ProtoMember(1)]
    public ifoo root { get; set; }
}
[ProtoContract, ProtoInclude(2000, typeof(foo))]
public interface ifoo
{
    [ProtoMember(1)]
    string data { get; set; }
    [ProtoMember(2)]
    ifoo subfoo { get; set; }
}
[ProtoContract]
public class foo : ifoo
{
    public string data { get; set; }
    public ifoo subfoo { get; set; }
} 
```

当根对象/接口支持故障得到解决时，`FooRoot`将不需要包装器，但我可能需要添加一些开关来启用/禁用修复，以获得旧版支持。

# jquery - MVC 4 - Uploadify 500（swf 做额外的请求）

> ID：12623180
> 
> 赞同：1
> 
> 时间：2012-09-27T14:00:23.060
> 
> 标签：jquery, asp.net-mvc, uploadify

在 MVC 4 中，我有一个 /Book/Create 页面。在此页面中，有一个 EditorTemplate，其中包含以下代码：

```
<input type="file" name="file_upload" id="file_upload" /> 
```

我还制作了一个 javascript 文件，其中包含：

```
$(document).ready(function () {
    $('#file_upload').uploadify({
        swf: '/Content/Flash/uploadify.swf',
        debug: true,
        auto: false
    });
}); 
```

现在我将 Uploadify 3.2 与 .swf 文件一起使用，一切正常。除了页面的初始化，首先调用/Book/Create。然后在调用 /Book/ 之后（索引操作）。

Firebug 说：

**答案标题**

```
HTTP/1.1 500 Internal Server Error
Cache-Control: private
Content-Type: text/html; charset=utf-8
Server: Microsoft-IIS/8.0
X-AspNet-Version: 4.0.30319
X-MiniProfiler-Ids: ["fa95eddf-e604-4678-adb3-9f3ea445b7e2"]
X-SourceFiles: =?UTF-8?B?RDpcVHJhY2VIZXJcUHJvamVjdHNcVHJhY2VcVHJhY2UuSGVyVUlcQmFiZVw=?=
X-Powered-By: ASP.NET
Date: Thu, 27 Sep 2012 13:49:38 GMT
Content-Length: 1342 
```

**请求标头**

```
GET /Book/ HTTP/1.1
Host: localhost:42740
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/20100101 Firefox/15.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: nl,en-us;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://localhost:42740/Content/Flash/uploadify.swf?preventswfcaching=1348753776045 
```

**SWF 调试**

```
---SWFUpload Instance Info---
Version: 2.2.0 2009-03-25
Movie Name: SWFUpload_0
Settings:
    upload_url:               /Book/uploadify.php
    flash_url:                /Content/Flash/uploadify.swf?preventswfcaching=1348753776045
    use_query_string:         false
    requeue_on_error:         false
    http_success:             
    assume_success_timeout:   30
    file_post_name:           Filedata
    post_params:              [object Object]
    file_types:               *.*
    file_types_description:   All Files
    file_size_limit:          0
    file_upload_limit:        0
    file_queue_limit:         999
    debug:                    true
    prevent_swf_caching:      true
    button_placeholder_id:    file_upload
    button_placeholder:       Not Set
    button_image_url:         /Book/
    button_width:             120
    button_height:            30
    button_text:              
    button_text_style:        color: #000000; font-size: 16pt;
    button_text_top_padding:  0
    button_text_left_padding: 0
    button_action:            -110
    button_disabled:          false
    custom_settings:          [object Object]
Event Handlers:
    swfupload_loaded_handler assigned:  false
    file_dialog_start_handler assigned: true
    file_queued_handler assigned:       true
    file_queue_error_handler assigned:  true
    upload_start_handler assigned:      true
    upload_progress_handler assigned:   true
    upload_error_handler assigned:      true
    upload_success_handler assigned:    true
    upload_complete_handler assigned:   true
    debug_handler assigned:             true

SWF DEBUG: SWFUpload Init Complete
SWF DEBUG: 
SWF DEBUG: ----- SWF DEBUG OUTPUT ----
SWF DEBUG: Build Number:           SWFUPLOAD 2.2.0
SWF DEBUG: movieName:              SWFUpload_0
SWF DEBUG: Upload URL:             /Book/uploadify.php
SWF DEBUG: File Types String:      *.*
SWF DEBUG: Parsed File Types:      
SWF DEBUG: HTTP Success:           0
SWF DEBUG: File Types Description: All Files (*.*)
SWF DEBUG: File Size Limit:        0 bytes
SWF DEBUG: File Upload Limit:      0
SWF DEBUG: File Queue Limit:       999
SWF DEBUG: Post Params:
SWF DEBUG: ----- END SWF DEBUG OUTPUT ----
SWF DEBUG: 
```

我认为这与swf 调试中的**button_image_url有关。**但即使我在 javascript 中设置了**buttonImage**属性，它也不会改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:11:24.400

很难在谷歌上找到这个问题的答案（搜索了一个多小时），所以我也会在这篇文章中添加答案：

[https://stackoverflow.com/a/12369252/267740](https://stackoverflow.com/a/12369252/267740)

# jquery - 输入类型范围 jquery

> ID：12623181
> 
> 赞同：0
> 
> 时间：2012-09-27T14:00:23.850
> 
> 标签：jquery, html, firefox, input, range

您好，我尝试使用 jquery 插件使输入类型范围适用于 FF 和 IE。

所以我使用以下代码：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Dokument bez tytułu</title>
<script src="http://cdn.jquerytools.org/1.2.7/full/jquery.tools.min.js"></script>
<script>
    $(":range").rangeinput();
  </script></head>

<body>
<input type="range" min="0" max="100" step="5" />

</body>
</html> 
```

但它不适用于 FF 和 IE，它只显示输入类型的文本。

有人有想法吗？

亲切的问候。

SP

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:13:56.180

也许喜欢

```
$(document).ready(function(){
    $("input[type='range']").rangeinput();
}); 
```

# c - Wireshark - 以编程方式修改来自 pcap 文件的数据包

> ID：12623186
> 
> 赞同：1
> 
> 时间：2012-09-27T14:00:30.420
> 
> 标签：c, protocols, wireshark

我在 pcap 文件中有一系列具有各种协议的数据包，例如 GTPV2、S1AP、Diameter 等。我需要知道是否有办法以编程方式修改某些字段，例如：

对于 GTPV2 协议：MCC 字段 - 移动国家代码，MNC 字段 - 用于 S1AP 协议的移动网络代码： Protocolie-Field 等

我设法通过专门解决我感兴趣的缓冲区的偏移量来获取 proto_tree 并修改 tvbuff 内容，但我可以说这样的话：

```
e212.mcc = "something" 
```

e212.mccc 是 Wireshark 过滤器在哪里？我在问这是否可以用任何语言完成，但我的猜测是解析器仅用于显示，而不是修改，并且我没有 API 可以通过 Wireshark 过滤器直接访问数据包的字段。如果是这样，您是否知道任何可以根据某些规则（最好/也包括 Wireshark 过滤器）修改来自 pcap 文件的数据包的开源工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:33:13.293

我不完全理解你的问题，但如果我是对的，我`sed`会为你做好这项工作。正则表达式将允许您浏览文件，选择特定模式（甚至偏移量）并替换它们。当我需要将机密信息密封在必须移交给第 3 方的文件上时，我会直接在 pcap 文件上使用这种技术。

检查 [这里](http://www.panix.com/~elflord/unix/sed.html)并试一试:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T23:31:54.083

我在 perl 中做过类似的事情，通过使用 wireshark 将捕获文件导出为文本，然后将该文本文件构建到一个数组中，其中每个十六进制数据包都是一个条目，然后我只是将该数组运行到一个 foreach 循环中，向下钻取到GTP 层和 IE 字段解析，根据需要调整相关 IE 的十六进制值。然后我将数组打印到一个新的文本文件中（重新生成左侧的十六进制偏移量是棘手的部分），然后将新的文本文件读入 text2pcap 实用程序以将其重新生成为 .pcap 文件。

# eclipse - Eclipse Juno 中的 Glassfish 适配器丢失

> ID：12623190
> 
> 赞同：2
> 
> 时间：2012-09-27T14:00:45.563
> 
> 标签：eclipse, glassfish

所以我已经从我的 Eclipse Juno EE 中的以下站点下载了 Glassfish 应用程序服务器包。

[http://download.java.net/glassfish/eclipse/juno](http://download.java.net/glassfish/eclipse/juno)

其中包含 App Server 运行时和 Glassfish 服务器工具。我可以在已安装的软件中看到它们，所以我猜它们安装正常。

但是，当我想添加新的服务器实例时，由于某种原因，服务器适配器列表中缺少 Glassfish。

我在网上对其进行了研究，并以几种不同的方式进行了研究（即，从 Eclipse 市场下载 dwonload 或从添加服务器对话框中下载附加服务器适配器），但它仍然是相同的 - 无法添加 Glassfish 服务器。

如果有人有任何建议，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T09:02:54.337

原来我是个傻瓜，即使我将工作区 Java 设置为 1.6 JDK，由于某种原因，我的 Windows JAVA_HOME 设置为 1.5 .....当我改变它时，GLassfish 适配器出现了。

# mysql - 错误 1142 (42000)：ALTER 命令被拒绝

> ID：12623193
> 
> 赞同：2
> 
> 时间：2012-09-27T14:00:55.377
> 
> 标签：mysql

我的 MySQL 服务器有奇怪的行为。我确定我有一个拥有所有权限的帐户。这是证明：

```
mysql> show grants;

+-------------------------------------------------------------------------+
| Grants for ***@localhost                                   |
+-------------------------------------------------------------------------+
| GRANT USAGE ON *.* TO '***'@'localhost' IDENTIFIED BY PASSWORD '***'    |
| GRANT ALL PRIVILEGES ON `***`.* TO '***'@'localhost'                    |
| GRANT ALL PRIVILEGES ON `***`.* TO '***'@'localhost'                    |
| GRANT ALL PRIVILEGES ON `***`.* TO '***'@'localhost'                    |
+-------------------------------------------------------------------------+
4 rows in set (0.04 sec) 
```

但是为什么我在执行此语法时总是收到错误消息：

```
mysql> ALTER TABLE outbox_multipart.ID AUTO_INCREMENT = 12;
ERROR 2006 (HY000): MySQL server has gone away
No connection. Trying to reconnect...
Connection id:    13924219
Current database: ***

ERROR 1142 (42000): ALTER command denied to user '***'@'localhost' for table 'ID' 
```

我几乎可以做所有事情（插入、更新、删除、截断等），但使用该帐户进行更改。知道有什么问题吗？

我尝试用 phpmyadmin 和 php 脚本做同样的事情，但得到了相同的结果。似乎我无法更改该列。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T14:11:26.010

用户`'***'@'localhost'`拥有数据库的所有权限`'***'`，但您正在尝试 ALTER 另一个数据库中的表 - `outbox_multipart`。向此数据库添加权限，重新连接并尝试 ALTER。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-25T06:04:19.103

授予命令后，您应该以 root 身份运行命令

```
flush privileges; 
```

之后，您的赠款将有效。

# ios - 使用 writeImageDataToSavedPhotosAlbum 保存图像会修改实际图像数据

> ID：12623204
> 
> 赞同：0
> 
> 时间：2012-09-27T14:01:16.547
> 
> 标签：ios, alassetslibrary

我在相机胶卷中有一张图像。如果图像和 md5 校验和它，我会得到数据表示。我们将图像作为 img0.jpg 写入文档目录 删除原始图像并使用 ALAssetLibrary 的 writeImageDataToSavedPhotosAlbum 将数据表示写回相机胶卷。

查看相册，图像看起来是一样的。再次从相机胶卷中读取新保存的图像。

预期结果 - 计算 md5。实际结果 - 不同的 md5。

保存此文件以及 img2.jpg

Hexdump 两者，看看有什么区别：

```
Dans-Mac:Desktop dan$ hexdump img1.jpg | head
0000000 ff d8 ff e1 26 31 45 78 69 66 00 00 4d 4d 00 2a
0000010 00 00 00 08 00 05 01 1a 00 05 00 00 00 01 00 00
0000020 00 4a 01 1b 00 05 00 00 00 01 00 00 00 52 01 28
0000030 00 03 00 00 00 01 00 02 00 00 02 13 00 03 00 00
0000040 00 01 00 01 00 00 87 69 00 04 00 00 00 01 00 00
0000050 00 5a 00 00 00 b4 00 00 00 48 00 00 00 01 00 00
0000060 00 48 00 00 00 01 00 07 90 00 00 07 00 00 00 04
0000070 30 32 32 31 91 01 00 07 00 00 00 04 00 00 00 00
0000080 a0 00 00 07 00 00 00 04 30 31 30 30 a0 01 00 03
0000090 00 00 00 01 00 01 00 00 a0 02 00 04 00 00 00 01

Dans-Mac:Desktop dan$ hexdump img2.jpg | head
0000000 ff d8 ff e1 26 31 45 78 69 66 00 00 4d 4d 00 2a
0000010 00 00 00 08 00 05 01 1a 00 05 00 00 00 01 00 00
0000020 00 4a 01 1b 00 05 00 00 00 01 00 00 00 52 01 28
0000030 00 03 00 00 00 01 00 02 00 00 02 13 00 03 00 00
0000040 00 01 00 01 00 00 87 69 00 04 00 00 00 01 00 00
0000050 00 5a 00 00 00 b4 00 00 00 48 00 00 00 01 00 00
0000060 00 48 00 00 00 01 00 07 90 00 00 07 00 00 00 04
0000070 30 32 32 31 91 01 00 07 00 00 00 04 00 00 00 01
0000080 a0 00 00 07 00 00 00 04 30 31 30 30 a0 01 00 03
0000090 00 00 00 01 00 01 00 00 a0 02 00 04 00 00 00 01 
```

如果您查看第 0000070 行，最后一个字符会有所不同。某些图像（大多数）会发生这种情况，但并非所有图像都经过测试。在这种特殊情况下，标题中只有一个字符差异，但测试的其他图像更糟糕，因为很多数据都不同。

iOS上有什么方法可以将实际图像数据写入未受污染的照片库吗？在我将图像保存到照片库后，我的应用程序正在做的事情依赖于 md5 校验和。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T12:19:12.573

Assets-Libray 在某些情况下会向图像添加元数据。我观察到，对于 JPEG 文件，Assets-Library 添加了一个 JFIF 元数据字典（如果还没有的话）。这将导致文件变大并且 MD5-Check 失败。使用 Assets-Library 无法防止这种情况发生。

但是，如果您只在应用程序中使用 JPEG，则可能有一种解决方法来实现您想要的。

1) 在导入之前，使用 ImageIO 提取嵌入的缩略图并为此生成校验和。

2) 导入后，从 Assets-Library 中读取前 128KB（或 64KB 也可以），并使用 imageIO 再次提取缩略图。然后生成缩略图的校验和。如果校验和匹配，它应该是相同的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T15:07:46.170

我不相信有可靠的方法来做到这一点。当我尝试使用图库保存透明的 PNG 时，如果 PNG 是从电子邮件中批量存储的，它们会被 iOS 转换为 jpeg。然后我尝试使用 iCloud，但没有成功保存 PNG 的原始格式。如果您正在寻找不变的东西，请尝试从 URL 中提取 id。然后至少你知道你正在处理同样的事情，即使数据可能会改变。

# php - 为什么 Symfony2 URL 验证器会跳过 TLD？

> ID：12623208
> 
> 赞同：0
> 
> 时间：2012-09-27T14:01:23.847
> 
> 标签：php, url, symfony

因此，我在 Symfony2 中开发了一个简单的 URL 缩短器——其中一项要求是输入必须是有效的 URL。

所以我已经设置了所有内容并且正在验证它，但它没有验证 TLD！它将通过诸如“A”之类的东西作为有效域！

这是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:09:09.773

您不仅要验证 TLD，还要验证 TLD 是否在公共后缀列表中：

*   [公共后缀列表](http://publicsuffix.org/)

另请参阅有关库列表的相关问题：[Get the subdomain from a URL](https://stackoverflow.com/q/288810/367456)

# javascript - 点击链接会触发哪些其他事件

> ID：12623221
> 
> 赞同：1
> 
> 时间：2012-09-27T14:02:18.367
> 
> 标签：javascript, events

我想自动启动购物车提交。我有

```
<a href="javascript:alert('javascript');" onclick="alert('onclick')" class="simpleCart_checkout hudbtn primary right">Checkout</a> 
```

和 javascript

```
<script>
$('.simpleCart_checkout').trigger('click');
</script> 
```

因此，我`click`在页面加载时收到警报，但没有收到警报，`javascript`并且简单的购物车未提交数据。那么我还需要触发什么才能完全模仿链接点击？

谢谢

PS 当我在 Checkout 上单击鼠标时，simplecart 将数据提交到带有购物车项目等的另一个页面。但是如果我尝试模仿点击警报，只会发生而不是购物车提交。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:04:58.043

第一件事是第一件事。从 DOM 元素中删除所有内联的愚蠢：

```
<a href="#" class="simpleCart_checkout hudbtn primary right">Checkout</a> 
```

第二。如果您要使用 jQuery，请使用 jQuery！

```
<script>
$('.simpleCart_checkout').on('click', function() {
     alert("onclick");
     return false;
}).trigger('click');
</script> 
```

演示：http: [//jsfiddle.net/maniator/dY26m/](http://jsfiddle.net/maniator/dY26m/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:09:32.150

`.trigger()`使用;来模拟对锚点的真实点击是不可能的。如果用户点击它，它只会执行默认行为。

`.trigger('click')`只会运行`onclick`处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:07:12.150

首先，像

```
javascript:alert(''); 
```

不应该使用。当我复制粘贴代码时，我看到两个点击警报。我同意尼尔发布的方式。你就是这样做的。请记住，当您将 javascript 与 html 混合使用时，一切都会变得一团糟。

您会注意到这一点，但触发点击事件不允许重定向到新页面。这意味着实际上您无法通过触发点击链接来导航到新页面。由于 javascript:alert(''); 在 href 属性中，它将不起作用。

触发器旨在触发捕获的事件。不是实际点击次数。

# language-agnostic - 使用位掩码创建用户权限的替代方法

> ID：12623236
> 
> 赞同：0
> 
> 时间：2012-09-27T14:02:58.647
> 
> 标签：language-agnostic, permissions, bitmask

所以我们正在编写的应用程序具有用户可以拥有的某些权限，起初我们只是制作了一个简单的位掩码并将每个权限保存为一个单独的位，并将最终值作为 long 存储到我们的 DB 表中。但是现在我们拥有如此多的权限，以至于该值不再适合数据库中的 long 了。我想我们可以将它存储为字符串而不是长字符串并进行转换，但这让我想知道这是否是解决问题的最佳方法。

例如：用户有权限 1-3-5-7

他的安全值是 2^0 + 2^2 + 2^4 + 2^7 = 149

但是一旦我有 100 个权限，这种方法似乎有点混乱，因为计算 2^99 似乎很昂贵并且很难在数据库表中查看（必须将其存储为字符串，因为它比 long 大）。那么当权限的数量变得非常大并且工作迅速并且不太复杂时，是否有人有不同的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:49:50.200

我相信我已经找到了最好的方法，所以我会继续回答我自己的问题，因为它已经开放了这么长时间。最好的方法似乎是在数据库中创建一个外部参照表，将用户与权限联系起来，就像这样。

安全表：

```
身份证 | 用户权限
--------------------------
1 | 能够编辑记录
2 | 能够创建记录
...ETC

```

用户表：

```
身份证 | 用户名
--------------
1 | 凯文
2 | 鲍勃
3 | 账单

```

外部参照表：

```
用户名 | 安全ID
--------------------
1 | 1
1 | 2
2 | 2
3 | 1
3 | 2

```

这使您可以拥有任意数量的权限，并且不限于创建权限所基于的 long 的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T11:48:43.317

您可以添加第二个长列。如果权限的索引大于x，你在第二列中查找（或存储）？

# javascript - onsubmit 方法不会停止提交

> ID：12623244
> 
> 赞同：9
> 
> 时间：2012-09-27T14:03:35.853
> 
> 标签：javascript, html, forms, onsubmit

我`onsubmit`的不工作。我的想法是放置一些必填字段，为了实现这一点，我`onsubmit`在 HTML 中的表单中使用了该方法，该方法称为 JavaScript 函数。

这个想法是，如果所有必填字段都已填写，javascript 函数将返回`true`并转到 page `/control/Cadastro.php`。否则，如果任何必填字段为空，它将返回`false`并且不会移动到 page `/control/Cadastro.php`，一直停留在当前页面直到为真。

不幸的是，如果没有像预期的那样填写所有必填字段，该函数确实会返回`false`，但它仍然会移动到 page `/control/Cadastro.php`，即使它不应该这样做。

我将切断一些代码以使我的观点易于理解。

```
<!DOCTYPE html>
<html>
    <head>
        <script>
            function ValidateRequiredFields()
            {
                var message = new String('\nCampos obrigatórios:\n');
                var flag=new Boolean(1);
                var x=document.forms["theForm"]["nr_processoCA"].value;
                if (x==null || x==""){
                    message += '\nNº do processo\n'; 
                    flag = new Boolean(0);
                } 
                if (flag == false){
                    alert(message);
                }
                return flag;    
            }
        </script>
    </head>
    <body>
        <form name="theForm" onsubmit="return ValidateRequiredFields()" method="post" action="../control/Cadastro.php"> 
            Nº do Processo: <br>
            <input type="text" name="nr_processoCA" class="input-xlarge">
            <br>
            <div class="row-fluid" style="text-align:center;">
                <input type="submit" class="btn btn-primary btn-large" value="Gravar">
            </div>   
         </form>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-27T14:15:15.743

您应该`preventDefault`在 onsubmit 函数中使用。我修改了你的代码：

```
function ValidateRequiredFields()
{
    var message = new String('\nCampos obrigatórios:\n');
    var flag=new Boolean(1);

    var x=document.forms["theForm"]["nr_processoCA"].value;
    if (x==null || x==""){
        message += '\nNº do processo\n'; 
        flag = new Boolean(0);
    }

    if (flag == false){
        if(event.preventDefault){
            event.preventDefault();
        }else{
            event.returnValue = false; // for IE as dont support preventDefault;
        }
        alert(message);
    }

    return flag;
} 
```

[演示](http://jsfiddle.net/UbjzU/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T14:20:47.833

为了使这项工作，您的`ValidateRequiredFields`函数需要返回一个布尔值。然后你应该将该方法附加到`onSubmit`事件中。请记住，`onsubmit`您需要使用`return`关键字。

此代码示例有效：

```
<!DOCTYPE html>
<html>
<head>
<script>
    function ValidateRequiredFields() {
        var message = new String('\nCampos obrigatórios:\n');
        var flag=1;

        var x=document.forms["theForm"]["nr_processoCA"].value;
        if (x==null || x==""){
            message += '\nNº do processo\n'; 
           alert(message);
           return false;
        }
        return true;
    }
</script>
</head>

<body>

<form name="theForm" method="post" action="../control/Cadastro.php" onSubmit="return ValidateRequiredFields()">

Nº do Processo: <br><input type="text" name="nr_processoCA" class="input-xlarge"><br>

<div class="row-fluid" style="text-align:center;">
    <input type="submit" class="btn btn-primary btn-large" value="Gravar">
</div>   

</form>

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T14:08:55.893

我建议放置一个按钮，如果为真，它将运行表单：

```
 <input type='button' onclick="if (ValidateRequiredFields()) document.forms['theForm'].submit();" /> 
```

就这样....

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T14:14:11.157

一个对象总是会评估为真，即使它是一个值为假的布尔对象。

放在`flag = true`函数的顶部，`flag = false`而不是创建一个布尔值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-22T16:44:18.013

我遇到了类似的问题。结果证明我的验证中有一个错误（嵌套了几个函数），导致 JavaScript 在到达 return 语句之前退出函数的执行。此时它将继续提交。

我建议任何找到此页面以寻找“onsubmit 方法不会停止提交”答案的人的建议是使用细齿梳逐步完成您的验证功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-07T02:37:23.277

在四处寻找对我有用的答案后，我决定创建一个解决方案。以下代码允许在提交或运行另一个函数（在 Chrome 中测试）之前运行原生 HTML5 表单验证。确保在函数之后返回 false 以防止表单提交。

```
<input type="submit" value="Submit" onclick='if (document.getElementById("mainForm").checkValidity()) { submitData(); return false;}' />
```

# c++ - 如何将 jobject 类“转换”为复杂的 C++ 类型？

> ID：12623250
> 
> 赞同：4
> 
> 时间：2012-09-27T14:03:56.030
> 
> 标签：c++, java-native-interface

我有一个与 C++ 类匹配的 Java 类。java类被命名`SDClass_JNI`，C++类被调用`SDClass`。我将 Java 类作为`jobject`参数传递给我的 JNI 方法。在该 JNI 方法中，我想将`jobject`在我的 JNI 方法中作为参数传入的转换为“匹配”C++ 方法。（例如`SDClass_JNI`-> `SDCLass`）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:23:42.270

如果我理解正确，您想要从 java 类到相应的 c++ 类的隐式转换。

这是不可能的，您应该编写代码来处理编组过程。

就像是：

```
SNDClass toSND(JNIEnv *env, jobject obj) {

    SNDClass result;

    jclass cls = env->FindClass("com/.../SDClass_JNI");
    checkException(env);
    //TODO release jclass object (env->DeleteLocalRef(cls);)(maybe use some sort of scoped smart pointer )

    jmethodID mid = env->GetMethodID(mCls, "getField1", "()D");
    checkException(env);
    jdouble value = env->CallDoubleMethod(obj, mid);
    checkException(env);
    result.setField1(jdouble);
    .....
}

void checkException(JNIEnv *env)
{
    jthrowable exc = env->ExceptionOccurred();
    if (NULL == exc)
    {
        return;
    }
    //TODO decide how to handle
} 
```

# c++ - 更改遗留代码的类层次结构

> ID：12623251
> 
> 赞同：2
> 
> 时间：2012-09-27T14:03:57.873
> 
> 标签：c++, refactoring

更改已经在软件中使用了很长时间（10 年以上）并且被广泛使用的类的类层次结构有什么缺点吗？我有一个`class A`，它不继承任何东西。我想做的是让它继承自一个新的抽象基类，并将其当前方法中的 2 个更改为虚拟方法。我通常会这样做，但我的同事更不情愿，那么这可能会导致什么问题呢？谢谢

编辑：我想这样做的原因：

我们正在创建一个新模块，它可以将旧类 A 或新创建的类 B 作为“源”。所以我正在考虑创建一个抽象类 SourceofX，类 A 和 B 将从中继承。“多态性”只能由采用 SourceofX 对象的新类/方法使用。如果您有比这更好的想法，我会全力以赴

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:15:23.413

更改遗留代码时总是存在风险。其中大部分是你无法预见的。

大多数情况下，原因是其他人完成的“hacky”错误修复并有机地成为软件的一部分。现在它已经稳定了，那些骇人听闻的修复可能会引入一些其他错误，并导致其他一些修复这些错误的骇客修复。该软件已有 10 年历史，因此我保证存在此类修复程序。

即使是对旧代码的最小更改，我个人也会非常谨慎。引入新的继承级别是不小的代码更改。所以，是的，这是非常危险的。

高级分析只会指出设计问题，但您会遇到仅在测试中出现的问题。如果那段特定的代码有所有者，去问问他。然后，再问他一次。打扰他，在你找到什么之前不要停下来。

我的建议是编写单元测试（如果你还没有它们，在这种情况下 - 完美），测试该类的 s&%t，孩子们......好吧，一切。

之后，再编写一些单元测试。多次运行测试。在多个平台上。晚上。在周三。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:32:09.120

如果您真的认为新结构更好，那么我会同意 Luchian Grigore 所说的，但这不是唯一的选择。例如，您可以使用代理：

```
struct Base {
  virtual void doSomething() = 0;
};

void someFunction(Base &base)
{
  ...
  base.doSomething();
  ...
}

struct NewClass : Base {
  virtual void doSomething();
};

struct OldClassProxy : Base {
  OldClassProxy(OldClass &old) : old(old) { }

  virtual void doSomething()
  {
    old.doSomething();
  }

  OldClass &old;
}; 
```

现在您可以将新函数与旧类的实例一起使用，而无需修改旧类：

```
NewClass a;
OldClass b;
someFunction(a);
OldClassProxy b_proxy(b);
someFunction(b_proxy); 
```

如果有很多地方需要代理，那么你可以编写一个重载：

```
void someFunction(OldClass &old_class)
{
  OldClassProxy proxy(old_class);
  someFunction(proxy);
} 
```

这将让你这样做：

```
NewClass a;
OldClass b;
someFunction(a);
someFunction(b); 
```

# entity-framework - 我的 Repository 项目引用的项目中的 IRepository 使得很难实际使用它们

> ID：12623253
> 
> 赞同：0
> 
> 时间：2012-09-27T14:03:58.177
> 
> 标签：entity-framework, repository, automapper

我目前正在使用 EF5 在 asp.net mvc 4 中工作，并且正在尝试让我的依赖注入与 Ninject 一起使用。

我在我的解决方案中做了 4 个不同的项目：

*   Gui -> 包含我的 MVC 项目
*   业务逻辑 -> 业务逻辑
*   DataAccess -> 我的 edmx 文件和存储库（参考常见）
*   通用 -> 模型、视图模型和 IRepository。

现在我正在尝试写这个：

存储库：

```
 IQueryable<PictureSource> PictureSource { get; } 
```

存储库：

```
 IQueryable<PictureSource> IRepository.PictureSource
        {
            get { return context.PictureSource }
        } 
```

现在的问题是我无法在我的 IRepository 中调用 PictureSource，因为它是我的 EF 中的一个实体，它位于我的 DataAccess 中。我尝试在我的存储库中以下列方式使用自动映射器：

```
 public IQueryable<PictureSourceModel> PictureSource()
        {
            Mapper.CreateMap<List<PictureSource>, List<PictureSourceModel>>();
     return Mapper.Map<List<PictureSource>,List<PictureSourceModel>>
     (context.PictureSource.ToList());
        } 
```

这会在 dbSet 中给出有关它的错误。有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:35:26.740

如果您无法从您的 IRepository 访问某些模型类，那么您没有应用您的结构。

该类**和所有其他实体应该在您的公共项目中**`PictureSourceModel`。 然后“如预期”所有其他项目将访问这些类。

 **为了能够将 EF 实体分离到另一个项目，您可以考虑使用名为“ ***Ef DbContext Generator*** ”的 Visual Studio 扩展。

如果您需要更多帮助，请告诉我。

*顺便说一句：尽量不要在 DAL 中使用 AutoMapper。它应该在 Gui 项目中使用。*

* * *

***更新***

将实体分离到 POCO 类

*   ***安装名为“ Ef DbContext Generator*** ”的Visual Studio 扩展。
*   打开您的 edmx 文件并右键单击空白区域，然后选择“添加代码生成项”
*   From the list select "Ef DbContext Generator"
*   Then just move the new file to another project
*   After that you should open .tt file to correct the .edmx file path**

# java - Java：对于每个循环，对扩展对象的迭代

> ID：12623255
> 
> 赞同：7
> 
> 时间：2012-09-27T14:03:59.540
> 
> 标签：java, foreach, polymorphism

我的问题可能很简单，

我有一个`Result`包含一些内部字段、setter 和 getter 的类。

此外，我有`Special1Result`扩展`Result`并包含更多字段和`Special2Result`更多数据的类。

在不同的类`Dispatcher`中，我编写了以下方法：

`processResults(List<? extends Result> results)`，这只是熟悉`Result`（我需要这个方法来查询扩展的 Result 对象中是否有特定的字段 - 我正在使用注释）。

所以我决定使用扩展的 for-each 循环：`for (Result res : results) {}`

那么我的问题是什么？我试图在网上找到如何为扩展对象编写这个 for 循环，例如像这样的东西`for (? extends Results res: results){}`

是否可以？正确的写法是怎样的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T14:06:42.973

你所知道的关于 a`List<? extends Result>`的所有元素都是 a `Result`- 所以你可以在增强的 for 循环语法中添加所有内容。

如果您需要未在 中声明的成员，则`Result`需要在循环内进行强制转换：

```
for (Result result : results) {
    if (result instanceof CleverResult) {
        CleverResult clever = (CleverResult) result;
        // Use clever here
    }
} 
```

想想如果你*不*使用增强的 for 循环你会写什么——你仍然需要写演员，不是吗？

当然，如果您知道列表实际上应该*只*包含一种特定类型，那么您总是可以在循环中无条件地强制转换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T14:09:11.567

> 我试图在网上找到如何为扩展对象编写这个 for 循环，例如像这样的东西

```
for (? extends Results res: results){} 
```

不，这是不可能的：您不能静态键入在运行时动态提供的项目。

> 正确的写法是怎样的？

你已经在这样做了：

```
for (Results res: results) {
} 
```

如果您想`Special2Result`在该循环内部进行测试，您可以这样做，但通常它表明您的设计可以改进。更好的选择是使用双重分派机制，例如[*访问者模式*](http://en.wikipedia.org/wiki/Visitor_pattern)，来隐藏子类特殊处理的细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T14:07:41.083

Java 有类型擦除——集合的具体类型参数在运行时不存在。

因此，如果您有一个 List，java 编译器将确保没有代码会将任何不是 Result 子类的内容放入列表中。

因此，在运行时，您的循环可以知道的所有内容都是 Result 的子类 - 因此循环它们的唯一方法是作为对 Result 的一组引用，以及由于任何子类而存在的任何多态行为在列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T14:10:44.233

由于您的具体子类仅因字段的性质而有所不同，因此我建议您从简单的多态性中受益。

您最终会得到一个`Result`接口/抽象类，该类定义一个`execute()`方法类，该方法类由您需要的多个类或子类实现，其中包含要执行的操作。

因此，您的客户端代码只能使用：

```
for (Result res : results){    //results being as a List<Result> type
  res.execute(); 
} 
```

# c# - c#关于datagridview更改背景颜色和分组结果的一些问题

> ID：12623257
> 
> 赞同：1
> 
> 时间：2012-09-27T14:04:19.557
> 
> 标签：c#, datagridview, datatable, backcolor

> **可能重复：**
> [如果一行不为空，c#更改颜色](https://stackoverflow.com/questions/12621070/c-sharp-change-color-for-a-row-if-its-not-empty)

我的表中有一些值，我对如何更改它有一些疑问：

1.如果“KundeID”不是空的紫罗兰色，我想改变背景，我试过--->

```
foreach (DataGridViewRow row1 in dataGridView2.Rows)
    {
        if (row1.Cells[2].Value != null)
    {
        row1.DefaultCellStyle.BackColor = Color.Violet;
    }
    } 
```

但它给我所有的桌子上色

2.我想在对象 6 中有两个 X，

```
object[] o5 = { 6, "XX", "Sprite"+"Jogurt" }; table.Rows.Add(o6); 
```

当我有 2 个“产品”并想在我的表中显示它时，不知道如何

我的表：

```
KundeID KundeName Comment        Jogurt Fanta Sprite    

1       Michael   "nichts"         x                  //violet
2       Raj       "Ich bin cool"                      //violet
        Gary      "yahoo"                 x     
        Miky                                     x       
5       MM                                       x    //violet
(6      XX                         x             x)   // Want to do two X's,    violet 
```

我的代码：

```
 DataTable table = new DataTable("Kunde");

        table.Columns.Add("KundeID", typeof(Int32));
        table.Columns.Add("KundeName", typeof(String));
        table.Columns.Add("Produkt", typeof(String));

        DataTable comment = new DataTable("Comment");

        comment.Columns.Add("KundeName", typeof(String));
        comment.Columns.Add("Comment", typeof(String));

        DataSet ds = new DataSet("DataSet");

        ds.Tables.Add(table);
        ds.Tables.Add(comment);

        object[] o1 = { 1, "Michael", "Jogurt" };
        object[] o2 = { 2, "Raj" };
        object[] o3 = { null, "Gary", "Fanta" };
        object[] o4 = { null, "Miky", "Sprite" };
        object[] o5 = { 5, "MM", "Sprite" };

        object[] c1 = { "Raj", "Ich bin cool" };
        object[] c2 = { "Gary", "yahoo" };
        object[] c3 = { "Michael", "nichts" };

        table.Rows.Add(o1);
        table.Rows.Add(o2);
        table.Rows.Add(o3);
        table.Rows.Add(o4);
        table.Rows.Add(o5);

        comment.Rows.Add(c1);
        comment.Rows.Add(c2);
        comment.Rows.Add(c3);

        var results = from table1 in table.AsEnumerable()
                      join table2 in comment.AsEnumerable()
                      on table1.Field<string>("KundeName") equals table2.Field<string>("KundeName") into prodGroup
                      from table4 in prodGroup.DefaultIfEmpty()

                      select new
                      {
                          KundeID = table1.Field<Int32?>("KundeID"),
                          KundeName = table1.Field<String>("KundeName"),
                          Produkt = table1.Field<String>("Produkt"),
                          Comment = table4 != null ? table4.Field<String>("Comment") : null,
                      };
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        var result = new DataTable();
        result.Columns.Add("KundeID", typeof(Int32));
        result.Columns.Add("KundeName", typeof(String));
        result.Columns.Add("Comment", typeof(String));
        result.Columns.AddRange(
            (from c in
                 (from r in table.AsEnumerable()
                  where !r.IsNull("Produkt") && !string.IsNullOrEmpty(r.Field<string>("Produkt"))
                  select r.Field<string>("Produkt")).Distinct()
             select new DataColumn(c, typeof(bool))).ToArray()
        );

        foreach (var r in results)
        {
            var productIndex = result.Columns.IndexOf(r.Produkt);
            var vals = new List<object>() { r.KundeID, r.KundeName, r.Comment };
            for (int i = 3; i < result.Columns.Count; i++)
            {
                if (i == productIndex)
                {
                    vals.Add(true);
                }
                else
                {
                    vals.Add(false);
                }
            }

            result.LoadDataRow(vals.ToArray(), true);
        }

        dataGridView2.DataSource = result ;

        //Here will change all background to violet, I want just some of them
        //foreach (DataGridViewRow row1 in dataGridView2.Rows)
        //{
        //    if (row1.Cells[2].Value != null)
        //    {
        //        row1.DefaultCellStyle.BackColor = Color.Violet;
        //    }
        //}
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:13:40.390

对于 ASPX（网格）：连接`OnRowDataBound`以向您的行添加颜色：

```
<asp:GridView ID="dataGridView2" runat="server" OnRowDataBound="RowDataBound" /> 
```

并将其放入您的代码隐藏文件中：

```
protected void RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowIndex == -1)
    {
        return;
    }

    if(!string.IsNullOrEmpty(e.Row.Cells[2].Text))
    {
         e.Row.BackColor = Color.Violet;   
    }
} 
```

对于 WINFORMS：`DataBindingComplete`通过如下方式附加事件或使用设计器连接事件：

```
dataGridView1.DataBindingComplete += new DataGridViewBindingCompleteEventHandler(dataGridView1_DataBindingComplete); 
```

然后在处理程序中你有这样的东西：

```
private void dataGridView1_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
{
    if (e.ListChangedType != ListChangedType.ItemDeleted)
    {
        DataGridViewCellStyle violet = dataGridView1.DefaultCellStyle.Clone();
        violet.BackColor = Color.Violet;

        foreach (DataGridViewRow r in dataGridView1.Rows)
        {
            if (r.Cells[2].Value != null)
            {
                r.DefaultCellStyle = violet;
            }
        }
    }
} 
```

# sql-server - T-SQL 日期转换

> ID：12623258
> 
> 赞同：0
> 
> 时间：2012-09-27T14:04:28.870
> 
> 标签：sql-server, tsql

我有以下`92845`代表的日期格式`hhmmss`。

我想将其转换为`datetime`SQL 中的。

我可以使用这样的东西：

```
SELECT STUFF(STUFF('84936',3,0,'-'),6,0,'-') 
```

但似乎 T-SQL 不喜欢这个`hour`部分。

谢谢你！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T14:12:18.833

好像你下午写的代码，现在早上不行。如果要基于绝对定位进行填充，则需要确保字符串始终具有相同的长度。一种方法是用 0 填充字符串，然后取最右边的 6 个字符。此外，您不需要`:`H `-`/M 分隔符。

```
SELECT STUFF(STUFF(RIGHT('0' + '84936', 6),3,0,':'),6,0,':'); 
```

结果：

```
08:49:36 
```

现在可以将其转换为日期时间：

```
SELECT CONVERT(DATETIME, STUFF(STUFF(RIGHT('0' + '84936', 6),3,0,':'),6,0,':')); 
```

结果：

```
1900-01-01 08:49:36.000 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:17:08.877

我不知道`92845`当前存储在哪里。如果它在一个变量中，那么这样的事情将起作用：

```
declare @t varchar(6) = '92845';
declare @fullt char(6) = RIGHT('000000' + @t,6)

select DATEADD(second,
     SUBSTRING(@fullt,1,2) * 3600 +
     SUBSTRING(@fullt,3,2) * 60 +
     SUBSTRING(@fullt,5,2),0) 
```

结果：

```
1900-01-01 09:28:45.000 
```

如果它在结果集的列中，那么您可以使用例如子查询进行类似的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:32:38.053

试试这个：

```
declare @t varchar(6) = '134524'
select CASE WHEN len(@t)=5 then convert(datetime,convert(varchar(10),CAST(getdate() as date))+' '+'0'+LEFT(@t,1)+':'+SUBSTRING(@t,2,2)+':'+SUBSTRING(@t,4,2))
else convert(datetime,convert(varchar(10),CAST(getdate() as date))+' '+LEFT(@t,2)+':'+SUBSTRING(@t,3,2)+':'+SUBSTRING(@t,5,2)) end 
```

# iphone - 如何在 iOS 6 中为 UIActivityViewController 设置收件人？

> ID：12623260
> 
> 赞同：33
> 
> 时间：2012-09-27T14:04:35.233
> 
> 标签：iphone, objective-c, ios6, uiactivityviewcontroller

我正在使用`UIActivityViewController`iOS6 中的新类为用户提供各种共享选项。您可以将一组参数传递给它，例如文本、链接和图像，其余的由它完成。

如何定义收件人？例如，通过邮件或 SMS 共享应该能够接受收件人，但我不知道如何调用此行为。

我不想必须单独使用`MFMessageComposeViewController`和`UIActivityViewController`，因为这违背了共享控制器的目的。

有什么建议么？

[UIActivityViewController 类参考](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIActivityViewController_Class/Reference/Reference.html)

**编辑：这现已提交给 Apple，随后与重复的错误报告合并。**

[关于 OpenRadar 的错误报告](http://openradar.appspot.com/radar?id=2050404)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-06-28T16:02:33.547

要在 iOS6 上使用 UIActivityViewController 为电子邮件添加**主题**，这是任何人都可以使用的最佳解决方案。您所要做的就是在初始化 UIActivityViewController 时调用以下命令。

```
UIActivityViewController *activityViewController = [[UIActivityViewController alloc] initWithActivityItems:activityItems applicationActivities:applicationActivities];
[activityViewController setValue:@"My Subject Text" forKey:@"subject"]; 
```

你的 UIActivityViewController 填充了一个主题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-29T18:50:46.907

我只是想出了一个解决这个问题的方法（在我的例子中设置电子邮件的主题）：在内部，UIActivityViewController 将在某个时候调用 MFMailComposeViewController 类的 setMessageBody:isHTML: 方法，只需拦截该调用并在内部进行调用 setSubject: 方法。由于“方法混合”技术，它看起来像：

```
#import <objc/message.h>

static void MethodSwizzle(Class c, SEL origSEL, SEL overrideSEL)
{
    Method origMethod = class_getInstanceMethod(c, origSEL);
    Method overrideMethod = class_getInstanceMethod(c, overrideSEL);

    if (class_addMethod(c, origSEL, method_getImplementation(overrideMethod), method_getTypeEncoding(overrideMethod))) {
        class_replaceMethod(c, overrideSEL, method_getImplementation(origMethod), method_getTypeEncoding(origMethod));
    } else {
        method_exchangeImplementations(origMethod, overrideMethod);
    }
}

@implementation MFMailComposeViewController (force_subject)

- (void)setMessageBodySwizzled:(NSString*)body isHTML:(BOOL)isHTML
{
    if (isHTML == YES) {
        NSRange range = [body rangeOfString:@"<title>.*</title>" options:NSRegularExpressionSearch|NSCaseInsensitiveSearch];
        if (range.location != NSNotFound) {
            NSScanner *scanner = [NSScanner scannerWithString:body];
            [scanner setScanLocation:range.location+7];
            NSString *subject = [NSString string];
            if ([scanner scanUpToString:@"</title>" intoString:&subject] == YES) {
                [self setSubject:subject];
            }
        }
    }
    [self setMessageBodySwizzled:body isHTML:isHTML];
}

@end 
```

在使用 UIActivityViewController 之前调用以下代码行：

```
MethodSwizzle([MFMailComposeViewController class], @selector(setMessageBody:isHTML:), @selector(setMessageBodySwizzled:isHTML:)); 
```

然后向 UIActivityViewController 传递一个自定义 UIActivityItemProvider ，它为 UIActivityTypeMail 返回一个 HTML NSString，如：

```
<html><head>
<title>Subject of the mail</title>
</head><body>
Body of the <b>mail</b>
</body></html> 
```

电子邮件的主题是从 HTML 标题中提取的（该部分使用纯文本，没有 html 实体或标签）。

使用该方法，我让您详细说明设置邮件收件人的优雅方法。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-17T16:41:56.673

虽然目前看来 mailto: 设置电子邮件主题和正文的解决方案不起作用，但如果您想将电子邮件正文设置为包含 HTML 并仍然使用 Apple 的系统电子邮件图标，这无论如何都不够通过 UIActivityViewController。

这正是我们想要做的：使用系统图标，但让电子邮件包含 HTML 正文和自定义主题。

我们的解决方案有点像 hack，但它运行良好，至少目前是这样。它确实涉及使用 MFMailComposeViewController，但它仍然允许您将系统邮件图标与 UIActivityViewController 一起使用。

第 1 步：创建一个符合 UIActivityItemSource 的包装类，如下所示：

```
 @interface ActivityItemSource : NSObject <UIActivityItemSource>
    @property (nonatomic, strong) id object;
    - (id) initWithObject:(id) objectToUse;
    @end

    @implementation ActivityItemSource

   - (id) initWithObject:(id) objectToUse
    {
        self = [super init];
        if (self) {
            self.object = objectToUse;
        }
        return self;
    }

    - (id)activityViewController:(UIActivityViewController *)activityViewController                 itemForActivityType:(NSString *)activityType
    {
    return self.object;
    }

    - (id)activityViewControllerPlaceholderItem:(UIActivityViewController *)activityViewController
    {

        return self.object;
    } 
```

第 2 步：继承 UIActivityViewController 并将其变成 MFMailComposeViewControllerDelegate，如下所示：

```
 @interface ActivityViewController : UIActivityViewController         <MFMailComposeViewControllerDelegate>

    @property (nonatomic, strong) id object;

    - (id) initWithObject:(id) objectToUse;
    @end

    @implementation ActivityViewController

    - (void)mailComposeController:(MFMailComposeViewController*)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error
    {

        switch (result)
        {
            case MFMailComposeResultSent:
            case MFMailComposeResultSaved:
                //successfully composed an email
                break;
            case MFMailComposeResultCancelled:
                break;
            case MFMailComposeResultFailed:
                break;
        }

    //dismiss the compose view and then the action view
        [self dismissViewControllerAnimated:YES completion:^() {
            [self.presentingViewController dismissViewControllerAnimated:YES completion:nil];        
        }];

    }

    - (id) initWithObject:(id) objectToUse
    {

        self = [super initWithActivityItems:[NSArray arrayWithObjects:[[ActivityItemSource alloc] initWithObject:objectToUse], nil] applicationActivities:nil];

        if (self) {
            self.excludedActivityTypes = [NSArray arrayWithObjects: UIActivityTypePostToWeibo, UIActivityTypePrint, UIActivityTypeCopyToPasteboard, UIActivityTypeAssignToContact, UIActivityTypeSaveToCameraRoll, nil];

            self.object = objectToUse;
        }
        return self;
    } 
```

注意：当您打电话时，`super initWithActivityItems`您正在包装您将在自定义 ActivityItemSource 中共享的对象

第 3 步：当用户点击邮件图标时，启动您自己的 MFMailComposeViewController 而不是系统控制器。

您可以`activityViewController:(UIActivityViewController *)activityViewController itemForActivityType:(NSString *)activityType`在 ActivityItemSource 类的方法中执行此操作：

```
 - (id)activityViewController:(UIActivityViewController *)activityViewController                 itemForActivityType:(NSString *)activityType
    {
        if([activityType isEqualToString:UIActivityTypeMail]) {
                //TODO: fix; this is a hack; but we have to wait till apple fixes the         inability to set subject and html body of email when using UIActivityViewController
                [self setEmailContent:activityViewController];
                return nil;
            }
         return self.object;
    }

    - (void) setEmailContent:(UIActivityViewController *)activityViewController 
    {

       MFMailComposeViewController *mailController = [ShareViewController mailComposeControllerWithObject: self.object withDelegate: activityViewController];

        [activityViewController presentViewController:mailController animated:YES completion:nil];

    } 
```

在该`mailComposeControllerWithObject`方法中，您实例化 MFMailComposeViewController 类的实例并将其设置为包含您想要的任何数据。另请注意，您会将 设置`activityViewController`为撰写视图的委托。

这样做的原因是，当显示一个撰写模式时，它会阻止显示其他模式，即您显示自己的撰写视图会阻止显示系统撰写视图。绝对是一个 hack，但它可以完成工作。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-21T11:11:02.990

这里的所有功劳都归功于 Emanuelle，因为他提出了大部分代码。

虽然我想我会发布他的代码的修改版本，以帮助设置收件人。

我在 MFMailComposeViewController 上使用了一个类别

```
#import "MFMailComposeViewController+Recipient.h"
#import <objc/message.h>

@implementation MFMailComposeViewController (Recipient)

+ (void)load {
    MethodSwizzle(self, @selector(setMessageBody:isHTML:), @selector(setMessageBodySwizzled:isHTML:));
}

static void MethodSwizzle(Class c, SEL origSEL, SEL overrideSEL)
{
    Method origMethod = class_getInstanceMethod(c, origSEL);
    Method overrideMethod = class_getInstanceMethod(c, overrideSEL);

    if (class_addMethod(c, origSEL, method_getImplementation(overrideMethod), method_getTypeEncoding(overrideMethod))) {
        class_replaceMethod(c, overrideSEL, method_getImplementation(origMethod), method_getTypeEncoding(origMethod));
    } else {
        method_exchangeImplementations(origMethod, overrideMethod);
    }
}

- (void)setMessageBodySwizzled:(NSString*)body isHTML:(BOOL)isHTML
{
    if (isHTML == YES) {
        NSRange range = [body rangeOfString:@"<torecipients>.*</torecipients>" options:NSRegularExpressionSearch|NSCaseInsensitiveSearch];
        if (range.location != NSNotFound) {
            NSScanner *scanner = [NSScanner scannerWithString:body];
            [scanner setScanLocation:range.location+14];
            NSString *recipientsString = [NSString string];
            if ([scanner scanUpToString:@"</torecipients>" intoString:&recipientsString] == YES) {
                NSArray * recipients = [recipientsString componentsSeparatedByString:@";"];
                [self setToRecipients:recipients];
            }
            body = [body stringByReplacingCharactersInRange:range withString:@""];
        }
    }
    [self setMessageBodySwizzled:body isHTML:isHTML];
}

@end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-27T15:48:01.097

您应该能够使用带有 mailto: 方案（或 sms: 用于文本消息）的 NSUrl 对象包括收件人。

从 UIActivity 类参考：

> **UIActivityTypeMail** 该对象将提供的内容发布到新的电子邮件中。使用此服务时，您可以提供 NSString 和 UIImage 对象以及指向本地文件的 NSURL 对象作为活动项的数据。您还可以指定其内容使用 mailto 方案的 NSURL 对象。

因此，这样的事情应该有效：

```
NSString *text = @"My mail text";
NSURL *recipients = [NSURL URLWithString:@"mailto:foo@bar.com"];

NSArray *activityItems = @[text, recipients];

UIActivityViewController *activityController =
                    [[UIActivityViewController alloc]
                    initWithActivityItems:activityItems
                    applicationActivities:nil];

[self presentViewController:activityController
                   animated:YES completion:nil]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-09T18:34:23.930

我不确定收件人，但似乎在 iOS 7 及更高版本中，您可以通过符合`UIActivityItemSource`协议并实现方法来设置电子邮件的主题`activityViewController:subjectForActivityType:`。

# wpf - 如何将对象显示为一行 wpf 数据网格并将其转换回对象

> ID：12623262
> 
> 赞同：1
> 
> 时间：2012-09-27T14:04:44.970
> 
> 标签：wpf, datagrid, datatemplate

我有一个类似于

```
class Quote
{
    string Ticker {set; get; }
    string Rating {set; get;}
    People Sender {set; get;}
} 
```

Peaple被定义为，

```
class People
{
    string Email {set; get;}
    int Age {set; get;}
    string Firm {set; get;}
} 
```

我也有一个 ObservableCollection 的报价单，

```
ObservableCollection <Quote> QuoteList; 
```

现在我想在 DataGrid 中显示 QuoteList，这样每一行都有以下 3 个单元格，1\. Quote.Ticker 2\. Quote.Rating 3\. Quote.Sender.Email

我还想，如果我单击每一行，我可以获得该单击行的 Quote 对象。请问我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:08:04.377

如果您将您的对象绑定`DataGrid`到其中`ItemsSource`的一个，则`ObservableCollection<Quote>`每个对象都`DataGridRow`将`Quote`按照它的原样`DataContext`（数据层）构建。

默认情况下，DataGrid 将自动为数据项上的每个属性生成一个列，因此在您的情况下，它将为 、 和 生成`Ticker`一个`Rating`列`Sender`。

您可以通过设置`AutoGenerateColumns="False"`和定义自己的来覆盖它`<DataGrid.Columns>`，其中包括绑定到的列`Sender.Email`

```
<DataGrid ItemsSource="{Binding Quotes}" AutoGenerateColumns="False">
    <DataGrid.Columns>
        <DataGridTextColumn Header="Ticker"  Binding="{Binding Ticker}"/>
        <DataGridTextColumn Header="Rating"  Binding="{Binding Rating}"/>
        <DataGridTextColumn Header="Email"  Binding="{Binding Sender.Email}"/>
    </DataGrid.Columns>
</DataGrid> 
```

或者您可以使用隐式 DataTemplate 告诉 WPF`Sender`使用包含`Email`属性的字符串绘制对象

```
<DataGrid ItemsSource="{Binding Quotes}">
    <DataGrid.Resources>
        <DataTemplate TargetType="{x:Type local:People}">
            <TextBlock Text="{Binding Email}" />
        </DataTemplate>
    </DataGrid.Resources>
</DataGrid> 
```

在这两个中，我会根据您的情况选择第一个，因为您不需要为编辑之类的事情编写任何额外的代码

至于单击行时获取数据对象，只需检查`DataContext`行的，或绑定`CommandParameter`到`"{Binding }"`

# java - Windows Azure 表存储问题

> ID：12623271
> 
> 赞同：0
> 
> 时间：2012-09-27T14:05:14.620
> 
> 标签：java, azure-storage

在 Windows Azure 表存储上，我正在执行下一个查询：

```
CloudTableClient ctc=TableStorage.getTableClient();
String q1=TableQuery.generateFilterCondition(TableConstants.PARTITION_KEY, QueryComparisons.EQUAL, Long.toHexString(partitionId));
TableQuery<Actividad> rangeQuery=TableQuery.from(tableName, Actividad.class).where(q1).take(2);
int e=0;
for(Actividad ac:ctc.execute(query)){
    e++;
}
System.out.println(e); 
```

但是我得到了分区上的所有行，而不仅仅是在 take(2) 上指定的前 2 行。

有什么建议吗？

回复 smarx:

我使用 Wireshark 查看 http 请求：

最初的请求是：

`GET /actividadreciente?$filter=PartitionKey%20eq%20%2717%27&$top=2&timeout=60`

服务有响应，然后发出很多请求：

`GET /actividadreciente? $filter=PartitionKey%20eq%20%2717%27&$top=2&NextRowKey=1%2124%21RkZGRkZFQzY2REYzMTA3Mw--&timeout=60&NextPartitionKey=1%214%21MTc-`

`GET /actividadreciente?$filter=PartitionKey%20eq%20%2717%27&$top=2&NextRowKey=1%2124%21RkZGRkZFQzY3Mjk2MEZEOA--&timeout=60&NextPartitionKey=1%214%21MTc-`

`GET /actividadreciente?$filter=PartitionKey%20eq%20%2717%27&$top=2&NextRowKey=1%2124%21RkZGRkZFQzY3Mjk5MzVGOQ--&timeout=60&NextPartitionKey=1%214%21MTc-`

等等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:08:21.600

Smarx 是对的，可以迭代所有结果，但如果你只迭代前 2 个，那么库只会对这些项目发出请求。使用附加请求进行后续迭代。所以解决方案是使用下面的代码：

```
CloudTableClient ctc=TableStorage.getTableClient();
final int limit=2;
String q1=TableQuery.generateFilterCondition(TableConstants.PARTITION_KEY, QueryComparisons.EQUAL, Long.toHexString(partitionId));
TableQuery<Actividad> rangeQuery=TableQuery.from(tableName, Actividad.class).where(q1).take(limit);
int e=0;
for(Actividad ac:ctc.execute(query)){
    e++;
    //Use ac
    if(e==limit)break;
}
System.out.println(e); 
```

非常感谢Smarx！

# javascript - 如何检查一个字符串数组是否包含 JavaScript 中的一个字符串？

> ID：12623272
> 
> 赞同：262
> 
> 时间：2012-09-27T14:05:14.630
> 
> 标签：javascript, arrays, string, testing

我有一个字符串数组和一个字符串。我想根据数组值测试这个字符串并对结果应用条件 - 如果数组包含字符串，则执行“A”，否则执行“B”。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：463
> 
> 时间：2012-09-27T14:06:54.877

所有数组都有一种[`indexOf`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf)方法（Internet Explorer 8 及以下版本除外），它将返回数组中元素的索引，如果它不在数组中，则返回 -1：

```
if (yourArray.indexOf("someString") > -1) {
    //In the array!
} else {
    //Not in the array
} 
```

如果你需要支持旧的 IE 浏览器，你可以使用[MDN 文章](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf#Compatibility)中的代码 polyfill 这个方法。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2012-09-27T14:10:15.867

您可以使用该`indexOf`方法并使用以下方法“扩展” Array 类`contains`：

```
Array.prototype.contains = function(element){
    return this.indexOf(element) > -1;
}; 
```

结果如下：

`["A", "B", "C"].contains("A")`等于`true`

`["A", "B", "C"].contains("D")`等于`false`

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2012-09-27T14:08:32.300

```
var stringArray = ["String1", "String2", "String3"];

return (stringArray.indexOf(searchStr) > -1) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-09-27T14:11:08.223

创建这个函数原型：

```
Array.prototype.contains = function ( needle ) {
   for (var i in this) { // Loop through every item in array
      if (this[i] == needle) return true; // return true if current item == needle
   }
   return false;
} 
```

然后您可以使用以下代码在数组 x 中搜索

```
if (x.contains('searchedString')) {
    // do a
}
else
{
      // do b
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-09-27T14:07:16.840

这将为您完成：

```
function inArray(needle, haystack) {
    var length = haystack.length;
    for(var i = 0; i < length; i++) {
        if(haystack[i] == needle)
            return true;
    }
    return false;
} 
```

我在*[与 PHP 的 in_array() 等效的 Stack Overflow 问题 JavaScript](https://stackoverflow.com/questions/784012/javascript-equivalent-of-phps-in-array)*中找到了它。

# c# - 在 Visual Studio 中为 Winforms 应用创建 SQL Server 数据库

> ID：12623274
> 
> 赞同：0
> 
> 时间：2012-09-27T14:05:35.727
> 
> 标签：c#, visual-studio-2010, sql-server-2008

我需要在教育中做win-forms应用程序，最近我在asp.net上完成了项目，在那里我毫无问题地创建了新的SQL Server数据库并将其发送到SQL Server，并将其添加到项目中。

但是如何使用简单的 Windows 窗体来做到这一点？有什么好的教程吗？（我也需要像 db Designer 这样的东西）。

在 asp.net mvc 上，我使用 linq... 但找不到在 winforms 上创建、发送和附加 SQL Server 数据库的好教程。

我使用 .net 4.0 和 SQL Server 2008 以及 Microsoft Visual Studio 2010 执行此操作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:48:07.693

您可以使用 Entity Framework Code First 来设计您的数据库，然后调用 Database.SetInitializer 来创建数据库。看看这篇文章[先了解实体框架代码中的数据库初始化器](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm)

# java - 无法在java中停止ExecutorService

> ID：12623275
> 
> 赞同：-1
> 
> 时间：2012-09-27T14:05:39.497
> 
> 标签：java, multithreading, thread-safety, threadpool, runnable

我对 ExecutorService 有疑问。我在 GUI 中有一个按钮，它调用包含 ExecutorService 的 Runnable 类。我尝试了一切来停止 ExecutorService （或主线程），但我没有找到结束它的方法。这是我的代码。请张贴您的答案和建议。此致。

```
public void actionPerformed(ActionEvent e) {
    final FindGateWaysAndIps scanner = new FindGateWaysAndIps();
    if (e.getActionCommand()=="Start Scan"){
        scanner.start();
    }
    if (e.getActionCommand()=="Stop Scan"){
                scanner.interrupt();
                scanner.stopScans();
    }
} 
```

“FindGateWaysAndIps”类

```
String ip = "192.168.";
String sql =" ";
static volatile boolean stop = false;
PingResult AllResaults = new PingResult();
int [] AllGateWays = new int [256];

final int NUM_THREADS = Runtime.getRuntime().availableProcessors(); 
ExecutorService exec = Executors.newFixedThreadPool(NUM_THREADS*5);

public void run() {
    stop=true;
    while(stop){
    for (;GateWayKey<=GateWayKeyStop;GateWayKey++){
        if (!stop){
            exec.shutdownNow();
            Thread.currentThread().interrupt();
            break;
        }
        ip="192.168."+GateWayKey+".1";
        AllSQLs.add(exec.submit((new PingTask(ip,GateWayKey,true))));
    }
    if (!stop) {
        exec.shutdownNow();
        Thread.currentThread().interrupt();
        break;
    }
    AllGateWays=GetVectorData.GiveMeGateWays();
    for (int j=0; j<= AllGateWays.length;j++){
        System.out.println("stop je: "+stop);
        if (!stop){
            exec.shutdownNow();
            Thread.currentThread().interrupt();
            break;
        }
        removeDuplicateinVectors();
        //System.out.println("Sada je j"+j);
        for (;SubNetKey<=SubNetKeyStop;SubNetKey++){
            if (!stop){
                exec.shutdownNow();
                Thread.currentThread().interrupt();
                break;
            }
            ip="192.168."+AllGateWays[j]+"."+SubNetKey;         
            AllSQLs.add (exec.submit((new PingTask(ip,AllGateWays[j],false))));
        }

        // Process the result here (this is where you insert into the DB)
        //WriteAllDataIntoDataBase();
    }
    exec.shutdown();
    //WriteAllDataIntoDataBase();
}

public void stopScans(){
    exec.shutdownNow();
    stop=false;
} 
```

抱歉，这里是 PingTask 类

```
public class PingTask implements Callable <String> {
    String ips;
    String sql;
    PingResult PassDataToExternalClass = new PingResult();
    //FindGateWaysAndIps DataProccesor = new FindGateWaysAndIps();  
    int GateWay;
    ScanFrame MonitorData = new ScanFrame();
    boolean GateWayORSubNet;
    int [] AllGateWays = new int [256];
    int i=0;
    public int[] GiveMeGateWays(){
        return AllGateWays;
    }
    public PingTask (){
    }
    public PingTask (String ip, int GateWayKey, boolean GateWayORSubNets){
        ips=ip;
        GateWay=GateWayKey;
        GateWayORSubNet=GateWayORSubNets;
    }

    public String call(){
        InetAddress address;
        try {
            address = InetAddress.getByName(ips);//ako nade gateway neka skoci u petlju u kojoj nade IP adrese pripadajuceg gatewaya
            System.out.println("PINGAM: "+ips);
            try {
                if (address.isReachable(2000)) { //pinga gatewaya s 1000ms (jeli je moguce ovo smanjiti da se ubrza proces)?
                    System.out.println("Nasa sam IP: "+ips);
                    AllGateWays[i]=GateWay;
                    i++;
                        MonitorData.WriteMonitorData(ips,address.getHostName().toString(),"2000","da");

                    if (GateWayORSubNet){
                            sql="REPLACE INTO `gateways` (`ID_GATEWAY` , `GATEWAY_IP` , `GATEWAY_NAME`) VALUES ('"+GateWay+"', '"+ips+"', '"+address.getHostName().toString()+"');";
                            return sql;
                        }
                        else{
                            sql="REPLACE INTO `subnets` (`IP` , `COMPUTER_NAME` , `GATEWAY_KEY`) VALUES ('"+ips+"', '"+address.getHostName().toString()+"', '"+GateWay+"');";
                            return sql;
                        }
                    } else {
                            return ";";
                    }
                } catch (IOException e) {
                    return ";";
                }
            } catch (UnknownHostException e) {
                return ";";
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:34:39.550

实际上，为了使线程停止，由 ExecutorService 初始化的池中的每个线程都必须定义一个在该线程被中断时的处理。

这就是守护进程从以下开始的原因：

```
while(true){
} 
```

不合适，并且是无法关闭线程池的原因之一。

更喜欢例如：

```
while(!Thread.currentThread.isInterrupted){
}
//do here what to do in order to exit and clean safely your job and used resources like open filed. 
```

但即使这样，你也会想知道它可能不起作用......

避免吞下 InterruptedException!：

```
catch(InterruptedException e){
//do nothing
} 
```

事实上，当异常被捕获时，中断标志就会被清除！所以不要忘记通过重新中断线程将其设置为 true：

```
catch(InterruptedException e){
    Thread.currentThread.interrupt();
} 
```

如需更详细的说明，请打开此链接： [http ://www.ibm.com/developerworks/java/library/j-jtp05236/index.html](http://www.ibm.com/developerworks/java/library/j-jtp05236/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T16:09:55.237

您的问题可能`address.isReachable(...)`是不可中断的。像@Mik378 提到的那样，中断线程会在线程上设置中断位并导致某些方法（`Thread.sleep()`、`Object.wait()`和其他方法） throw `InterruptedException`。不幸的是，`InetAddress.isReachable(...)`不会被打断。

如果您试图让您的打印线程立即完成以便应用程序可以退出，您可以让它们成为守护线程。看这里：

> [将可调用线程作为守护进程](https://stackoverflow.com/questions/10030808/making-callable-threads-as-daemon/10030824#10030824)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:09:01.457

我猜您`PingTask`正在进行 URL 连接，并且 connect() 调用是不可中断的调用。

[ExecutorService#shutdownNow()](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html#shutdownNow%28%29)提供了一种通过中断线程立即关闭的方法，但由于这些线程不能被中断，它没有提供额外的好处。

它仅在线程定义了其中断策略并执行可中断操作时才提供好处。

# regex - 正则表达式模式总是在 glassFish 上返回 false

> ID：12623278
> 
> 赞同：1
> 
> 时间：2012-09-27T14:05:53.143
> 
> 标签：regex, glassfish

我有一个在tomcat上运行良好的应用程序。今天，我试着把它放在 glassfish 上。部署失败，因为在我的应用程序中使用的 1 个正则表达式总是在 glassfish 的服务器上返回 false，但在 tomcat 上工作正常。我已经尝试过这种简单的测试模式：

```
Pattern p = Pattern.compile("[a-z]");
Matcher m = p.matcher("toto");
System.out.println(m.matches()); 
```

此测试失败。有什么解决办法吗？

* * *

我有这种模式在 glassfish 的服务器上失败了

```
public static boolean isPatternValid(String pattern, String string){
    Pattern p = Pattern.compile(pattern);
    Matcher m = p.matcher(string);
    return m.matches();
}

public static String patternExtension(String extension){
    return "([^\\s]+(\\.(?i)("+extension+"))$)";
} 
```

我在[http://www.mkyong.com/regular-expressions/how-to-validate-image-file-extension-with-regular-expression/上使用这个正则表达式](http://www.mkyong.com/regular-expressions/how-to-validate-image-file-extension-with-regular-expression/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:06:48.980

你需要重复这组

```
Pattern p = Pattern.compile("[a-z]+"); 
```

如果您使用`*`而不是`+`，即使您与空字符串进行比较，它也会匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:12:23.190

[az] 只匹配从 a 到 z 的一个字符，添加 + 将匹配一个或多个

```
[a-z]+ 
```

添加 * 匹配任意数量，包括无。

```
[a-z]* 
```

# django - 我如何从 Tastypie JSON 访问 Backbone 集合元素？

> ID：12623284
> 
> 赞同：2
> 
> 时间：2012-09-27T14:06:14.203
> 
> 标签：django, json, backbone.js, tastypie

我用 Tastypie-Django 编写了一个 API，我想用 Backbone 做一个网页来更简单地访问模型。我在 Backbone 中创建了一个模型和一个这样的集合：

```
var Abstract =  Backbone.Model.extend({
    defaults : {
   }
});

var AbstractCollection = Backbone.Collection.extend({
   model: Abstract,
   url : "http://192.168.0.195/api/v1/abstract/?format=json"
}); 
```

它在 View 中的 fetch 方法是这样的：

```
var abs = new PocketsAbstractCollection();
abs.fetch({
     success: function (collection, response) {
         console.log(abs.length);
         console.log(abs.models);
      }
 }); 
```

问题是我从这个表单中收到了一个 JSON：

```
 {"meta": {"limit": 20, "next": null, "offset": 0, "previous": null, "total_count": 12}, "objects": [{ ... }]} 
```

当我在属性中看到集合的模型时，我有 2 个元素，一个 Meta 和一个带有元素的 Objects Array。如何访问对象数组元素？

如果我写 abs.attributes 这会给我一个错误。

```
attributes: Object
  meta: Object
  objects: Array[12]
    0: Object
    1: Object
    2: Object
    3: Object
    4: Object
    .
    .
    .
   length: 12 
```

有人能帮我吗？

谢谢！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T14:59:38.980

Backbone 期望接收一个对象数组。

Tastypie 返回“objects”属性下的对象数组。

将 API 响应操作为 Backbone 所需格式的推荐方法是通过集合的[`parse`函数](http://backbonejs.org/#Collection-parse)：

```
var AbstractCollection = Backbone.Collection.extend({
   model: Abstract,

   url : "http://192.168.0.195/api/v1/abstract/?format=json",

   parse: function(response) {
      return response.objects;
   }
}); 
```

您还可以使用 Backbone-Tastypie '插件'：[https ://github.com/PaulUithol/backbone-tastypie](https://github.com/PaulUithol/backbone-tastypie)

# asp.net - 检查数据库表中的值以查看新记录是否会与现有记录冲突

> ID：12623293
> 
> 赞同：1
> 
> 时间：2012-09-27T14:06:50.717
> 
> 标签：asp.net, c#-4.0, insert, validation, detailsview

我有一个包含多个字段的详细信息视图，始终设置为插入模式。在这些字段中，我想在用户插入新记录之前检查该用户是否已经输入了该日期的记录。

我真的需要想办法检查多个要求，例如请求的日期是否是假期，或者是否已经有两个不同用户在同一日期发出了两个不同的请求（因为请求同一日期的人不能超过两个.)

我无法让自定义验证器工作，因为我唯一的回发时间是按下插入时。

我想知道是否有任何方法可以在按下插入时检查不同的验证，但只有在全部通过时才执行插入？

我需要检查表格中的多个列。用户 ID 和日期。

我希望这是有道理的。

asp:DetailsView ID="DetailsView1" runat="server" DataSourceID="ObjectDataSource1" DataKeyNames="bwrequestid" Height="29px" Width="928px" AutoGenerateRows="False" CellPadding="4" ForeColor="#333333" GridLines ="无" 样式="margin-right: 0px; text-align: left; margin-top: 0px;" ondatabound="DetailsView1_DataBound" oniteminserting="EntValid_ItemInserting"

```
 protected void EntValid_ItemInserting(object sender, DetailsViewInsertEventArgs e)
    {
        for (int i = 0; i < e.Values.Count; i++)
        {
            if (e.Values[i] != GetData())
            {
                e.Cancel = true;

                return;
            }
        }
    } 
```

--------获取数据是这样的

私有数据集 GetData() { ConnectionStringSettingsCollection csc = ConfigurationManager.ConnectionStrings;

```
 var sql = "SELECT LEAVETYPE, LEAVECODE FROM TEST.LVTYPE ORDER BY LEAVECODE";

        using (iDB2Connection conn = new iDB2Connection(GetConnectionString()))
        {
            conn.Open();

            using (iDB2Command cmd = new iDB2Command(sql, conn))
            {
                cmd.DeriveParameters();

                using (iDB2DataAdapter da = new iDB2DataAdapter(cmd))
                {
                    DataSet ds = new DataSet();
                    da.Fill(ds);

                    return ds;
                }
            }
        }
    } 
```

* * *

```
 protected void EntValid_ItemInserting(object sender, DetailsViewInsertEventArgs e)
    {
        for (int i = 0; i < e.Values.Count; i++)
        {
            if (e.Values[i] != GetData())
            {
                e.Cancel = true;

                return;
            }
        }
    } 
```

--------获取数据是这样的

私有数据集 GetData() { ConnectionStringSettingsCollection csc = ConfigurationManager.ConnectionStrings;

```
 var sql = "SELECT LEAVETYPE, LEAVECODE FROM TEST.LVTYPE ORDER BY LEAVECODE";

        using (iDB2Connection conn = new iDB2Connection(GetConnectionString()))
        {
            conn.Open();

            using (iDB2Command cmd = new iDB2Command(sql, conn))
            {
                cmd.DeriveParameters();

                using (iDB2DataAdapter da = new iDB2DataAdapter(cmd))
                {
                    DataSet ds = new DataSet();
                    da.Fill(ds);

                    return ds;
                }
            }
        } 
```

## }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:34:13.853

我假设您只使用服务器端验证这是正确的吗？如果是这样（顺便说一句，我建议同时进行服务器和客户端验证，但这无关紧要）您首先需要处理 Details 视图的 ItemInserting 事件。

届时，您将拥有对该记录的完全访问权限。有关详细信息， 请参阅[MSDN 。](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.iteminserting.aspx)

在 ItemInserting 事件处理程序中，进行验证，如果失败，使用 e.Cancel = true;

前任：

```
void CustomerDetail_ItemInserting(object sender, 
    DetailsViewInsertEventArgs e)
{
    for (int i = 0; i < e.Values.Count; i++)
    {
        if (e.Values[i] != *your validation here*)
        {
            e.Cancel = true;

            //set your validation summary message here
            ...

            return;
        }
    }
} 
```

只是不要忘记连接这个处理程序：

```
<asp:DetailsView ID="CustomerDetail" 
    DataSourceID="Details" AutoGenerateRows="false"
    *other properties*
    OnItemInserting="CustomerDetail_ItemInserting" > 
```

# windows - 明显的疑虑

> ID：12623296
> 
> 赞同：0
> 
> 时间：2012-09-27T14:06:57.513
> 
> 标签：windows, winapi, sdk, manifest

我按照以下步骤操作。
1.我从一个 exe(a) 中调用 2 个 exe(b&c)，它们都是基于 mingw 的。
2.我为 a、b、c 创建了 3 个单独的清单文件，使用`mageui.exe`.
3.对所有 3 个清单文件和相应的 exe 执行以下命令。

```
mt.exe –manifest temp.manifest –outputresource:YourApp.exe;#1 
```

我的问题：
1\. 以上步骤是否正确？
2.如果正确，是否需要将清单文件与exe一起分发？
3\. 是否可以只使用一个清单文件而不是每个 exe 的 3 个清单文件进行管理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:18:39.143

您根本不需要分发清单文件。通过使用`mt.exe`，您已将清单嵌入到可执行文件中。使用资源编辑工具确认清单确实已作为 Windows 资源嵌入。

您可以对所有可执行文件使用相同的清单吗？这取决于清单中的内容。如果您要指定`processorArchitecture`，那么如果您同时拥有 32 位和 64 位可执行文件，则需要不同的清单。但我认为这个问题没有实际意义，因为您不需要分发清单。

# android - 获取图像的元数据 - Android

> ID：12623302
> 
> 赞同：5
> 
> 时间：2012-09-27T14:07:25.947
> 
> 标签：android, metadata, android-image

[http://www.isco.com/webproductimages/appBnr/bnr1.jpg](http://www.isco.com/webproductimages/appBnr/bnr1.jpg)

我使用[一个网站](http://regex.info/exif.cgi?dummy=on&imgurl=http://www.isco.com/webproductimages/appBnr/bnr1.jpg)来查看图像的元数据。在这个网站上，它显示了图像的所有信息。我想知道如何在 android 中获取上述图像的“标题”标签。

我在这里找到了仅适用于 iOS 的类似问题：[How to get image metadata in ios](https://stackoverflow.com/questions/12478502/how-to-get-image-metadata-in-ios)

但是我不知道如何在 android 上获取图像的“元数据”。`ExifInterface`只提供一些信息。但我无法获得“标题”标签。

您能否提供任何代码片段以在 android 中获取图像的元数据？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T06:43:25.030

从这里给出的链接下载元数据提取器......[点击下载库](http://code.google.com/p/metadata-extractor/downloads/list) 选择版本2.5.0.RC-3.zip

提取jar文件夹

并将 jar 导入项目中的 libs 文件夹，然后执行以下代码

```
 try {
            InputStream is = new URL("your image url").openStream();
            BufferedInputStream bis = new BufferedInputStream(is);
            Metadata metadata = ImageMetadataReader.readMetadata(bis,true);

    for (Directory directory : metadata.getDirectories()) {
    for (Tag tag : directory.getTags()) {
        System.out.println(tag);
    }
 }

            }
        catch (ImageProcessingException e){}
        catch (IOException e) {} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:25:05.380

如果您想检索有关图像的元数据信息，[ExifInterface](http://developer.android.com/reference/android/media/ExifInterface.html)就是您要查找的内容。这是如何使用此接口的一个很好的示例：[http ://android-er.blogspot.com/2009/12/read-exif-information-in-jpeg-file.html](http://android-er.blogspot.com/2009/12/read-exif-information-in-jpeg-file.html)

但是，如果您想检索在线图像的信息，恐怕还不可能。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-10-22T15:47:22.070

如果您想从 Android 项目中的图像中检索元数据，那么您可以借助以下工具来实现：[https ://github.com/drewnoakes/metadata-extractor](https://github.com/drewnoakes/metadata-extractor)

在你的 gradle 中使用

```
implementation 'com.drewnoakes:metadata-extractor:2.12.0' 
```

完整代码如下

```
private static String getImageMetaData(Uri image1) {
    try {
        InputStream inputStream = FILE_CONTEXT.getContentResolver().openInputStream(image1);
        try {
            image1.getEncodedUserInfo();
            Metadata metadata = ImageMetadataReader.readMetadata(inputStream);

            for (Directory directory1 : metadata.getDirectories()) {
                if (directory1.getName().equals("Exif IFD0")) {
                    for (Tag tag : directory1.getTags()) {
                        if (tag.getTagName().equals("Date/Time")) {
                            return tag.getDescription();
                        }
                    }
                }
            }
        } catch (ImageProcessingException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }
    return null;
} 
```

# android - BroadcastReceiver 在 os 2.3.6 上不起作用？

> ID：12623306
> 
> 赞同：0
> 
> 时间：2012-09-27T14:07:32.910
> 
> 标签：android

我正在开发触发手机启动（完成启动）的应用程序，当我在三星 Galaxy s2（ICS）上尝试时，broadcastreceiver 在启动时收到了接收器，但在 Galaxy y 或具有 2.3.6 操作系统版本的 Galaxy Pocket 上却没有t 触发广播接收器。

请帮忙。

在这里编辑是我在清单中的接收器：

```
 <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>

 <receiver android:name=".MyReceiver" android:enabled="true" android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.BOOT_COMPLETED"/>

            </intent-filter>
        </receiver>

        <receiver android:name=".MyReceiverMessages" android:enabled="true" android:exported="true">
            <intent-filter>
               <action android:name="android.provider.Telephony.SMS_RECEIVED" />

            </intent-filter>
        </receiver> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T14:32:51.753

因为我在我的应用程序上使用了 2 个接收器，并且我在启动接收器上设置了延迟时间，所以低端手机（如 Galaxy y 和 Galaxy Pocket）只有 10 秒的最大延迟时间，如果延迟时间更长，它不会触发超过 10 秒，

我对我的应用程序使用了句柄运行延迟。感谢所有对此主题发表评论的人。

# api - Google oAuth api检索具有权限的联系人问题

> ID：12623307
> 
> 赞同：0
> 
> 时间：2012-09-27T14:07:32.860
> 
> 标签：api, oauth-2.0

将 Api 请求传递到此 URL [https://www.google.com/m8/feeds/contacts/default/full](https://www.google.com/m8/feeds/contacts/default/full)

出现一个请求此权限的屏幕。是否有任何 URL 只要求用户“检索您的联系人”而不是管理它。

SHOPBOX.IO 正在请求以下权限：

```
Manage your contacts
Perform these operations when I'm not using the application 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T18:50:25.690

在授权屏幕上要求用户的权限取决于您指定的范围。当然，要访问不同的端点，您必须请求某些范围。

要访问[Google 的联系人 API](https://developers.google.com/google-apps/contacts/v3/#authorizing_requests_with_oauth_20)，此范围是必需的：

> *https://www.google.com/m8/feeds* - 对联系人和联系人组的读/写访问权限

由于这是您唯一的选择，并且没有可用的只读范围，因此会警告用户您*可以*编辑他的联系人，即使您不会这样做。

# sql - sql语句插入与选择？

> ID：12623315
> 
> 赞同：0
> 
> 时间：2012-09-27T14:07:56.040
> 
> 标签：sql, sql-server, sql-server-2005

我有一个带有列的表：

```
StudentID
Value1
Value2
Value3 
```

...我有三个查询，每个查询都带有 studentID 和一个值（1 到 3）字段

我想做的是使用并行值更新此表，如果存在学生，则更新相应的列，如果不存在，则创建一个新行。

我正在使用 SQL Server 2005

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:18:39.550

像你刚才说的那样写：

```
IF EXISTS(SELECT * FROM table WHERE StudentID = @StudentID)
BEGIN
--update
END
ELSE
BEGIN
--insert
END 
```

# java - 虚假唤醒会影响 Future.get() 吗？

> ID：12623317
> 
> 赞同：3
> 
> 时间：2012-09-27T14:07:58.020
> 
> 标签：java, future, executor, callable

Future.get( timeout, unit ) 是否容易受到与 Javadoc 中 Object.wait() 和 Condition.await() 记录的相同类型的虚假唤醒的影响？

```
someType  result;
Future<someType> future = executor.submit( new callableTask() );

result = future.get( 1000, TimeUnit.MILLISECONDS ); 
```

假设线程在超时之前没有结束，它是否可能不会等待 1000 毫秒？似乎它必须等待完全超时（并生成超时异常），否则结果会是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:11:37.087

不，因为它使用更高的同步原语

```
java.util.concurrent.locks.AbstractQueuedSynchronizer 
```

# codeigniter - 使用具有非活动数据库的实用程序的 codeigniter

> ID：12623318
> 
> 赞同：0
> 
> 时间：2012-09-27T14:08:03.080
> 
> 标签：codeigniter

我在codeigniter中使用一个模型在我的脚本中的许多数据库之间切换，我想使用Utility类，当我使用它时，它处理在数据库配置文件中作为active_group写入的数据库，我可以改变它来处理任何其他数据库不活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T22:17:49.750

我认为[如何使用忽略 active_group 的多个 dbs](https://stackoverflow.com/questions/1113570/codeigniter-database-connection-issue?rq=1 "如何使用忽略 active_group 的多个 dbs")是您正在寻找的。

# matlab - 如果我将对数似然分解为其总和，MLE 似然评估怎么会如此不同？

> ID：12623321
> 
> 赞同：3
> 
> 时间：2012-09-27T14:08:23.657
> 
> 标签：matlab, statistics

这是我在尝试执行 MLE 时在 Matlab 中注意到的。我的第一个估计器使用了 pdf 的对数似然，并将产品分解为一个总和。例如，`(f(x)=b ax^(a-1)exp(-bx^a))`分解的日志 weibull pdf 是：

`log_likelihood=log(b)+log(a)+(a-1)log(x)-bx^a`

对此的评估与此大不相同：

`log_likelihood=log(bax^(a-1)exp(-bx^a))`

计算机在这两个阶段做的有什么不同？第一个给出了更大的数字（几个数量级）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:38:55.013

根据您使用的数字，这可能是一个数字问题：如果您将非常大的数字与非常小的数字组合在一起，由于数字精度的限制，您可能会得到不准确。

一种可能性是在第二种情况下您会失去一些准确性，因为您是在不同的规模下操作的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T14:59:03.087

我从事一个实现系统发育树的最大似然性的科学软件项目，并且一直遇到有关数值精度的问题。通常情况下，下降是...

1.  在模型中具有相同值的竞争应用程序之间，
2.  手动计算 MLE 分数时，
3.  按照计算中的操作顺序。

这真的都归结为第三，甚至在你的情况下。当在计算过程中缩放它们的指数时，小数和非常大数的乘法会导致奇怪的结果。[在（臭名昭著的）“每个计算机科学家应该知道的关于浮点运算的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)”中有很多关于此的内容。但是，如果这就是您感兴趣的全部，我提到的是它的不足之处。

总而言之，您看到的问题是计算函数时浮点/双精度数字和运算的表示形式的严格数字问题。我对 MATLAB 不太熟悉，但它们可能具有任意精度类型，可以为您提供更好的结果。

除此之外，尽可能长时间地保持它们的符号性，并且如果您对变量大小有任何直觉（因为`a`与 相比总是非常大`x`），那么请确保您明智地选择括号的顺序。

第一个方程应该更好，因为它处理添加`log`s，并且应该比第二个更稳定——`x^a`尽管它会主导方程，但让我有点厌倦，但无论如何它在实践中都会。

# javascript - 使用 Javascript 进行基本表单验证

> ID：12623328
> 
> 赞同：2
> 
> 时间：2012-09-27T14:08:34.043
> 
> 标签：javascript, forms, validation

我试图了解 (http://www.w3schools.com/js/js_form_validation.asp) 上的函数并使用 getElementsByClassName 对其进行返工（如下）以查找我添加到 HTML 输入标记的类属性。我对 Javascript 很陌生，我不明白为什么必须在下面的语句末尾添加 .value （W3 示例）或 .view （我的示例）才能使其正常工作。据我了解，函数中的第一条语句说查看文档，并将变量 X 分配给具有类属性 reqname 的任何输入字段。

谢谢你。

我的功能：

```
function validateForm()
{
var x=document.getElementsByClassName("reqname").view;
if (x==null || x=="")
  {
  alert("First name must be filled out");
  return false;
  }
} 
```

W3 的功能：

```
function validateForm()
{
var x=document.forms["myForm"]["fname"].value;
if (x==null || x=="")
  {
  alert("First name must be filled out");
  return false;
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:12:05.683

诸如输入字段之类的表单元素通常具有`value`，即已输入到输入字段中的字符串。

通过指定`.value`，他们明确地检查元素的*内容*是否为空。没有它，他们将检查*元素本身*是否为空，即元素是否*存在*。

您的代码还有一些问题。`.view`你使用的没有意义。此外，`getElementsByClassName`返回一个元素列表，而不是单个元素，因此您将无法立即访问其`.value`.

如果您知道只有一个元素，则可以检查`getElementsByClassName("reqname")[0].value`. 如果您想验证*所有*“reqname”字段的值，您必须遍历您的集合并单独检查每个项目：

```
var elements =document.getElementsByClassName("reqname");
for(var i = 0, l = elements.length; i < l; i++) {
   var x = elements[i].value;
   if(x == null || x == '') {
      alert("First name must be filled out");
      return false;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:14:31.623

可能对以下有用：

[http://tetlaw.id.au/view/javascript/really-easy-field-validation](http://tetlaw.id.au/view/javascript/really-easy-field-validation)

jQuery插件

[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:17:21.437

输入字段的属性不仅仅是它的“值”（这是写入其中的文本）。因此，您必须通过在名称（在您的情况下为“值”）附加“。”来说明要访问的属性。如果你真的想做表单验证，也一定要在你的 php 文件中做！javascript 所做的一切都在客户端，因此人们可以 - 基本上 - 忽略它，只需将一些随机数据发送到您的 .php 文件。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-27T14:16:44.760

写起来更简单

```
function ValidateForm() {
    var x = $("#inputOID").val();
    if (x == null || x == "")
        alert("......");
    return false;
} 
```

所以你的功能是ValidateForm。您声明一个变量 x，并通过输入 ID 从输入中给出值。例如`<input id="inputOID" .... />`. 所以 x 将包含输入的值。您验证是否为空或为空，如果是，您将提醒用户。就这样！祝你好运！

# java - 如何获取过滤扩展数据表的选定行？

> ID：12623329
> 
> 赞同：3
> 
> 时间：2012-09-27T14:08:37.490
> 
> 标签：java, jsf, datatable, richfaces

在我的应用程序（RichFaces 4.1）中，我有一个扩展数据表，在我的支持 bean 中，我需要跟踪选定的行。我使用以下代码实现了这一点：

JSF：

```
<rich:extendedDataTable id="freie"
    selectionMode="multipleKeyboardFree"
    selection="#{myBean.tableSelection}"
    ...
<a4j:ajax execute="@this" event="selectionchange" 
          listener="#{myBean.tableSelection}"
          render="indicatorPanel" /> 
```

爪哇：

```
 UIExtendedDataTable dataTable= (UIExtendedDataTable) event.getComponent();
    Object originalKey= dataTable.getRowKey();
    _tableSelectedEntries.clear();
    for (Object selectionKey: _tableSelection) {
        dataTable.setRowKey(selectionKey);
        if (dataTable.isRowAvailable()) {
            _tableSelectedEntries.add((Entry) dataTable.getRowData());
        }
    }
    dataTable.setRowKey(originalKey); 
```

这工作正常，只要表没有被过滤。我使用标准的 RichFaces 方式来过滤表格：

```
<rich:column sortBy="#{mitarbeiter.vorname}"
 filterValue="#{mitarbeiterFilterBean.firstNameFilter}"
 filterExpression="#{fn:containsIgnoreCase(mitarbeiter.vorname, mitarbeiterFilterBean.firstNameFilter)}"> 
```

当表被过滤并且我选择例如第一行时，我在后备 bean 中获得未过滤表的第一行的 rowKey。过滤表时如何获取所选行的rowData？

我认为我的代码的工作方式与[展示](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=extendedDataTable&sample=exTableSelection&skin=blueSky)中的相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T07:13:50.633

我可以通过使过滤器 bean SessionScoped 来解决我的问题。我也不再将当前选定的行绑定到我的支持 bean。我使用以下方法获取选定的行：

```
public void tableSelection (AjaxBehaviorEvent event) {
    UIExtendedDataTable dataTable= (UIExtendedDataTable) event.getComponent();
    for (Object selectionKey: dataTable.getSelection()) { 
```

也可以使用[rowKeyVar](https://stackoverflow.com/a/1982048/1207146)来获得正确的行索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T12:08:35.597

也许你忽略了一些东西，因为我尝试过它并且它有效。

我复制了源`selectableTable`并添加了过滤器方法`filterTable`

示例用法：要获取选定的项目/项目数据，只需对选定项目列表使用 get 方法

* * *

源代码（xhtml）：

```
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      xmlns:h="http://java.sun.com/jsf/html">
    <h:head>
        <title>Richfaces Welcome Page</title>
    </h:head>
    <h:body>

        <h:panelGrid columns="2">
            <h:form>
                <fieldset style="margin-bottom: 10px;">
                    <legend>
                        <h:outputText value="Selection Mode " />
                    </legend>
                    <h:selectOneRadio value="#{exTableSelect.selectionMode}">
                        <f:selectItem itemLabel="Single" itemValue="single" />
                        <f:selectItem itemLabel="Multiple" itemValue="multiple" />
                        <f:selectItem itemLabel="Multiple Keyboard-free" itemValue="multipleKeyboardFree" />
                        <a4j:ajax render="table, res" />
                    </h:selectOneRadio>
                </fieldset>
                <rich:extendedDataTable value="#{exTableSelect.inventoryItems}" var="car"
                                        selection="#{exTableSelect.selection}" id="table" style="height:300px; width:500px;"
                                        selectionMode="#{exTableSelect.selectionMode}">
                    <a4j:ajax execute="@form" event="selectionchange" listener="#{exTableSelect.selectionListener}"
                              render=":res" />
                    <f:facet name="header">
                        <h:outputText value="Cars marketplace" />
                    </f:facet>
                    <rich:column filterValue="#{exTableSelect.vendorFilter}"
                                 filterExpression="#{fn:containsIgnoreCase(car.vendor, exTableSelect.vendorFilter)}">
                        <f:facet name="header">
                            <h:panelGroup>
                                <h:outputText value="Vendor " />
                                <h:inputText value="#{exTableSelect.vendorFilter}">

                                    <a4j:ajax render="table" execute="@this" event="change" />
                                </h:inputText>
                            </h:panelGroup>
                        </f:facet>
                        <h:outputText value="#{car.vendor}" />
                    </rich:column>
                </rich:extendedDataTable>
            </h:form>
            <a4j:outputPanel id="res">
                <rich:panel header="Selected Rows:" rendered="#{not empty exTableSelect.selectionItems}">
                    <rich:list type="unordered" value="#{exTableSelect.selectionItems}" var="sel">
                        <h:outputText value="#{sel.vendor} - #{sel.model} - #{sel.price}" />
                    </rich:list>
                </rich:panel>
            </a4j:outputPanel>
        </h:panelGrid>
    </h:body>
</html> 
```

托管豆：

```
public class ExTableSelect {

    private String selectionMode = "multiple";
    private Collection<Object> selection;

    private List<InventoryItem> inventoryItems;
    private List<InventoryItem> selectionItems = new ArrayList<InventoryItem>();

    private String vendorFilter;

    public void selectionListener(AjaxBehaviorEvent event) {
        UIExtendedDataTable dataTable = (UIExtendedDataTable) event.getComponent();
        Object originalKey = dataTable.getRowKey();
        selectionItems.clear();
        for (Object selectionKey : selection) {
            dataTable.setRowKey(selectionKey);
            if (dataTable.isRowAvailable()) {
                selectionItems.add((InventoryItem) dataTable.getRowData());
            }
        }
        dataTable.setRowKey(originalKey);
    }

     public Filter<?> getFilterVendor() {
        return new Filter<InventoryItem>() {
            public boolean accept(InventoryItem t) {
                String vendor = getVendorFilter();
                if (vendor == null || vendor.length() == 0 || vendor.equals(t.getVendor())) {
                    return true;
                }
                return false;
            }
        };
    }

    @PostConstruct
    public void addInventory(){

        InventoryItem i = new InventoryItem();
        i.setVendor("A");
        InventoryItem i2 = new InventoryItem();
        i2.setVendor("AB");
        InventoryItem i3 = new InventoryItem();
        i3.setVendor("AC");
        InventoryItem i4= new InventoryItem();
        i4.setVendor("E");
        InventoryItem i5 = new InventoryItem();
        i5.setVendor("F");
        InventoryItem i6 = new InventoryItem();
        i6.setVendor("G");
        InventoryItem i7 = new InventoryItem();
        i7.setVendor("H");
        InventoryItem i8 = new InventoryItem();
        i8.setVendor("I");
        InventoryItem i9 = new InventoryItem();
        i9.setVendor("J");

        inventoryItems= new ArrayList<InventoryItem>();

        inventoryItems.add(i);
        inventoryItems.add(i2);
        inventoryItems.add(i3);
        inventoryItems.add(i4);
        inventoryItems.add(i5);
        inventoryItems.add(i6);
        inventoryItems.add(i7);
        inventoryItems.add(i8);
        inventoryItems.add(i9);
    }

    public Collection<Object> getSelection() {
        return selection;
    }

    public void setSelection(Collection<Object> selection) {
        this.selection = selection;
    }

    public List<InventoryItem> getInventoryItems() {
        return inventoryItems;
    }

    public void setInventoryItems(List<InventoryItem> inventoryItems) {
        this.inventoryItems = inventoryItems;
    }

    public InventoryItem getSelectionItem() {
        if (selectionItems == null || selectionItems.isEmpty()) {
            return null;
        }
        return selectionItems.get(0);
    }

    public List<InventoryItem> getSelectionItems() {
        return selectionItems;
    }

    public void setSelectionItems(List<InventoryItem> selectionItems) {
        this.selectionItems = selectionItems;
    }

    public String getSelectionMode() {
        return selectionMode;
    }

    public void setSelectionMode(String selectionMode) {
        this.selectionMode = selectionMode;
    }

    public void setVendorFilter(String vendorFilter) {
        this.vendorFilter = vendorFilter;
    }

    public String getVendorFilter() {
        return vendorFilter;
    }
} 
```

# android - 检查查询是否在 Android 的 sqlite 中成功

> ID：12623330
> 
> 赞同：5
> 
> 时间：2012-09-27T14:08:40.823
> 
> 标签：android, mysql, sqlite

为了将数据插入到 android 中名为 mytable 的 sqlite 表中，我使用查询：

```
db.execSQL("INSERT INTO MYTABLE VALUES('','"+name+"',NOW());"); 
```

我想检查这个查询是否成功插入到表中。在php（使用mysql）中，您可以轻松做到

```
if($result) 
    echo 'success';
else        
    echo 'not inserted'; 
```

但是在 android (with sqlite)**中检查查询是否已成功执行且没有任何错误**的等效代码是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-27T14:15:30.300

根据文档[execSQL](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#execSQL(java.lang.String)) throws an [SQLException](http://developer.android.com/reference/android/database/SQLException.html)所以我认为你最好的选择是用 try catch 包围你的 execSQL 调用。然后，您可以处理 catch 中发生的任何错误。所以像这样的东西就是你想要的

```
try {
  db.execSQL("INSERT INTO MYTABLE VALUES('','"+name+"',NOW());");
} catch (SQLException e) {
  ...deal with error
} 
```

# scala - 隐含点和括号的Scala优先级

> ID：12623331
> 
> 赞同：3
> 
> 时间：2012-09-27T14:08:43.467
> 
> 标签：scala, operator-precedence

以下“括号”如何？

```
val words = List("foo", "bar", "baz")
val phrase = "These are upper case: " + words map { _.toUpperCase } mkString ", " 
```

是不是一样

```
val words = List("foo", "bar", "baz")
val phrase = "These are upper case: " + words.map(_.toUpperCase).mkString(", ") 
```

换句话说，隐含的点（“.”）和括号是否与真实的具有相同的优先级？

第一个版本是否与第一个版本相同

```
val words = List("foo", "bar", "baz")
val phrase =
  "These are upper case: " + (words map { _.toUpperCase } mkString ", ") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:21:39.950

以字母开头的运算符的优先级最低。`+`具有低优先级但高于`map`or `mkString`。所以

```
"These are upper case: " + words map { _.toUpperCase } mkString ", " 
```

应该被解析为：

```
(("These are upper case: " + words).map{ _.toUpperCase }).mkString(", ") 
```

把它想象成：

```
v1 + v2 map v3 mkString v4
((v1 + v2) map v3) mkString v4 
```

有关更多信息，请参阅我的其他答案：[When to use parenthesis in Scala infix notation](https://stackoverflow.com/questions/5592642/when-to-use-parenthesis-in-scala-infix-notation/5597154#5597154)

# forms - Symfony2 一种形式的两个动作

> ID：12623333
> 
> 赞同：0
> 
> 时间：2012-09-27T14:08:49.380
> 
> 标签：forms, symfony

我正在学习 Symfony2，这是我的问题。

我创建了一个表单，其中一个嵌入在第一个表单中。问题是我想为这两个部分制作一个具有不同操作的提交按钮。我想知道我尝试的方式是否可行？

这是我的表格：

```
class creaGrpType extends AbstractType
{
    private $codeEtapeList;

    public function __construct(array $codeEtapeListFromController)
    {
        $this->codeEtapeList = $codeEtapeListFromController;
    }

    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
        ->add('codeEtape', 'choice', array(
            'choices'   => $this->codeEtapeList,
            'required'  => false))
        ->add('listeStudents', new CreaGrp2Type);

    } 
```

这是我的树枝：

```
<form method="post" {{ form_enctype(formCreaGrp) }}>

    <table>         
                <tr>
            <td>
            {{ form_label(formCreaGrp.codeEtape, "Année d'étude:") }}
                        {{ form_errors(formCreaGrp.codeEtape) }}
            </td>
        </tr>
        <tr>
            <td>
                        {{ form_widget(formCreaGrp.codeEtape) }}
            <input action = "{{ path('EnsgtiEnsgtiBundle_refreshListe')}}" type="submit" value="Rafraichir la liste des étudiants">
    </form><hr>
            </td>
        </tr>
        <tr>
            <td>
            <form method="post" {{ form_enctype(formCreaGrp) }}>
            {{ form_label(formCreaGrp.listeStudents, "Choisir les membres du groupe:") }}
            {{ form_errors(formCreaGrp.listeStudents) }}
            {{ form_widget(formCreaGrp.listeStudents) }}
            <input action = "{{ path('EnsgtiEnsgtiBundle_creaGrp2')}}" type="submit"/>
            </form>
            </td>
        </tr><hr>
        </table>
    </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:56:34.793

参见 Symfony2 Book 的[Embedded Forms](http://symfony.com/doc/current/book/forms.html#embedded-forms)部分。这解释了如何实现您正在尝试做的事情。

# pdf - 如何从 UIWebView 中显示的 PDF 中复制所选数据

> ID：12623334
> 
> 赞同：0
> 
> 时间：2012-09-27T14:08:53.457
> 
> 标签：pdf, uiwebview, uimenucontroller, uiresponder

我正在开发一个在 UIWebView 中显示 PDF 的项目。我向 UIMenuController 添加了另一个 UIMenuItem，以便对已选择的 UIWebView 中的文本执行各种操作。问题是我无法在我新创建的选择器方法中访问选定的文本。如果我首先在选定文本上使用复制命令，那么我可以从粘贴板中获取先前复制的文本，但是像 [myWebView copy:sender] 这样的命令；从我的新选择器调用什么都不做。如何在我的新选择器中接收选定的文本？我知道在 UIWebView 中使用 HTML 时可以使用 javascript 轻松完成此操作，人们通常如何处理 UIWebView 中显示的 PDF 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T21:28:31.263

您可以使用以下代码从第一响应者调用复制命令：

```
[[UIApplication sharedApplication] sendAction:@selector(copy:) to:nil from:self forEvent:nil]; 
```

然后您可以简单地从粘贴板中检索它：

```
[UIPasteboard generalPasteboard].string; 
```

这似乎是从显示 PDF 的 UIWebView 接收所选文本的唯一方法，javascript 方法不适用于 PDF 文件，仅适用于 HTML。

# android - Android 相机应用程序收到错误 100

> ID：12623338
> 
> 赞同：2
> 
> 时间：2012-09-27T14:09:03.250
> 
> 标签：android, camera

`Camera Error 100`遵循谷歌提供给我们的教程并使用模拟器时，我收到了 A。[http://developer.android.com/guide/topics/media/camera.html](http://developer.android.com/guide/topics/media/camera.html)。当我使用我的实际设备时，它可以工作！我必须对本教程进行的另一个更改是当对我的调用`Camera.open()`必须传入一个整数`Camera.open(0)`并且我不得不将 API 提高到 9 时。谁能告诉我为什么我的模拟器在 logcat 上给我相机错误 100，但是实际设备可以正常工作吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-16T17:51:16.073

Camera Error 100 表示“媒体服务器死机。在这种情况下，应用程序必须释放 Camera 对象并实例化一个新对象。” 看看[http://developer.android.com/reference/android/hardware/Camera.html](http://developer.android.com/reference/android/hardware/Camera.html)

![CAMERA_ERROR_SERVER_DIED](../Images/9d2e8c76675c97dcdc036989c1d9fa5b.png) 您可以看到为什么会收到相机错误 100。

希望能帮到你。。

# android - 从日历到 ISO 8601 的 Android 转换

> ID：12623339
> 
> 赞同：-1
> 
> 时间：2012-09-27T14:09:04.503
> 
> 标签：android, date, datetime, calendar, iso8601

我需要从日历（从类导入 java.util.Calendar）转换为标准 ISO 8601 数据时间，即：

```
 YYYY-MM-DDThh:mm:ss 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:29:01.427

[`SimpleDateFormat`](http://developer.android.com/reference/java/text/SimpleDateFormat.html)与您所需的格式字符串一起使用。

# vb.net - 计划的控制台应用程序中的 ContextSwitchDeadlock 错误

> ID：12623346
> 
> 赞同：0
> 
> 时间：2012-09-27T14:09:21.270
> 
> 标签：vb.net, exception, scheduled-tasks, console-application, production-environment

我正在开发一个不再在这里工作的人开发的控制台应用程序。在调试时，抛出了 ContextSwitchDeadlock 异常（我在异常上发现了这个[问题](https://stackoverflow.com/questions/2797677/contextswitchdeadlock-was-detected-error-in-c-sharp)）。如果我忽略它，该应用程序最终将通过它发生的循环运行。该应用程序每天都作为计划任务运行，但并不是每次都调用这个特定的过程。

我想知道是否可以允许此异常投入生产。除了这个例外，这个应用程序的作者将它投入生产，并且从那时起它一直在运行。我是否应该只进行（与此异常无关的）更新并将应用程序保持原样？还是我应该尝试解决这个问题？解决它对我来说似乎令人生畏：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:59:58.493

本。我会说“不”。除非您的异常是 ThreadAbortException（即用户关闭了一个窗口，因此进程已死）或类似的事情，否则这样的异常可能会使您的代码出现级联故障。根据我们在我工作的地方所做的：

1.  我认为，作为一个创可贴，您应该用 Try-Catch 封装有问题的代码，并将其连接起来以在每次捕获时向您发送一封电子邮件，这样您就有了正在发生的事情的文档，并防止级联故障传播贯穿您的代码（隔离问题）。

2.  为了修复（当你有时间的时候），调试它并逐步找出你的主线程为什么要花这么长时间，如果可以的话，创建一个工作线程来处理它（免责声明：这将是我在这个问题，基于您提供的链接的答案。我没有测试过这个，我也没有足够的经验来明确地说这会起作用）。

编辑：在我自己运行一个特别长时间的进程遇到此错误后，我在 msdn 上遇到了这些答案：

[http://social.msdn.microsoft.com/Forums/en/vsto/thread/bf71a6a8-2a6a-4c0a-ab7b-effb09451a89](http://social.msdn.microsoft.com/Forums/en/vsto/thread/bf71a6a8-2a6a-4c0a-ab7b-effb09451a89)

虽然我解决了我的错误（我正在将 System.IO.FileStream 读入 String Builder 而不是使用 String 和 StreamReader ReadToEnd 方法），但我认为它可能对您有所帮助。

# tfs - 变更集可以阻止其他变更集吗？

> ID：12623350
> 
> 赞同：3
> 
> 时间：2012-09-27T14:09:32.080
> 
> 标签：tfs

我有一个变更集，比如 #1000，它没有从 Dev > Test 合并。一旦这个变更集被合并，当我执行另一个合并操作时，我看到一个以前不可用的变更集列表突然显示出来。

为什么会这样？

# objective-c - 读取每个视图的 JSON 数据

> ID：12623352
> 
> 赞同：0
> 
> 时间：2012-09-27T14:09:37.373
> 
> 标签：objective-c, ios, json

我对 iOS 开发非常陌生，正在编写一个具有多个视图的应用程序，每个视图都有一个 tableview。

对于每个视图，我都需要读取一个单独的 JSON URL，然后显示结果。我一直在检查的所有教程都读取 ViewController.m 中的数据，但是由于每个视图都有一个单独的 URL，我可以概括代码并将其写在其他地方吗？

另外，我想把它放在最有效地加载数据的地方，即当我点击一个按钮时，我的应用程序没有太多的等待时间。

我正在使用以下链接作为参考：[http ://www.raywenderlich.com/5492/working-with-json-in-ios-5](http://www.raywenderlich.com/5492/working-with-json-in-ios-5)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-25T10:31:44.720

I would suggest you to have a separate parser class `iTemplateParser`

Then in other View Controller you can create the `iTemplateParser` object.

```
@property (nonatomic, strong) iTemplateParser *templateData;

- (void)viewDidLoad {

    NSData *theData = [NSData dataWithContentsOfFile:[[NSBundle mainBundle] pathForResource:templateFileName ofType:@"json"]];
    self.templateData = [[iTemplateParser alloc] initWithTemplateData:[NSJSONSerialization JSONObjectWithData:theData options:NSJSONReadingMutableContainers error:nil]];
} 
```

Now in `iTemplateParser` you can define many functions as per your need. E.g.

```
- (id)initWithTemplateData:(NSDictionary *)iDataDict;
- (CGRect)frameForTableView;
- (UIFont *)fontForTableView;
- (UIColor *)tableBackgroudColor; 
```

etc.

Now this methods you can call in your `ViewController` to display UI components.

**Hope this will help you.**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-25T10:11:57.657

您可以制作单独的解析器、模型类来解析单独的 json url。然后在每个视图加载中加载解析的数据。

# objective-c - UitableView 以编程方式自定义单元格宽度

> ID：12623354
> 
> 赞同：0
> 
> 时间：2012-09-27T14:09:47.260
> 
> 标签：objective-c, ios, uitableview

你好我正在尝试以编程方式更改表格视图中单元格的宽度我最初有这个代码

`

```
-(void)viewDidLoad
{
[super viewDidLoad];
    [self.theTableView setSeparatorStyle:UITableViewCellSeparatorStyleNone];
    CGRect frame = CGRectMake(100, 0, 200.0, 768.0);                         
    self.theTableView = [[UITableView alloc] initWithFrame:frame];
    theTableView.delegate = self;
    theTableView.dataSource = self;
    [self.view addSubview:theTableView];
    self.title = @"TableView"; 
```

` 以一种方式工作，但问题是单元格被复制，如下所示

[图片](http://i47.tinypic.com/sbsocw.png)

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:28:20.140

放置在表格视图中的单元格应自动调整为表格视图的宽度。在您的代码中，您将 tableview 的宽度设置为 200。因此单元格也应为 200。您是使用自定义单元格还是仅使用默认的 UITableViewCell？如果您使用自定义单元格并将单元格的宽度设置为与 tableview 宽度不同的值，则可能会导致重复。

# sql - 按数据区间分组

> ID：12623358
> 
> 赞同：6
> 
> 时间：2012-09-27T14:09:48.997
> 
> 标签：sql, postgresql, nosql, aggregate-functions, generate-series

我有一个表，它存储一段时间内网络上的带宽使用情况。一列将包含日期时间（主键），另一列将记录带宽。每分钟记录一次数据。我们将在其他列中及时记录其他数据。

如果用户每隔 15 分钟请求数据（在给定开始和结束日期的 24 小时内），是否可以通过单个查询来获取我需要的数据，或者我是否必须编写存储过程/游标来执行此操作? 然后用户可以请求 5 分钟间隔数据等。

我很可能会使用 Postgres，但还有其他更好的 NOSQL 选项吗？

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-27T15:09:49.203

```
WITH t AS (
   SELECT ts, (random()*100)::int AS bandwidth
   FROM   generate_series('2012-09-01', '2012-09-04', '1 minute'::interval) ts
   )

SELECT date_trunc('hour', ts) AS hour_stump
      ,(extract(minute FROM ts)::int / 15) AS min15_slot
      ,count(*) AS rows_in_timeslice               -- optional
      ,sum(bandwidth) AS sum_bandwidth
FROM   t
WHERE  ts >= '2012-09-02 00:00:00+02'::timestamptz -- user's time range
AND    ts <  '2012-09-03 00:00:00+02'::timestamptz -- careful with borders 
GROUP  BY 1, 2
ORDER  BY 1, 2; 
```

[CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html) 提供的数据类似于您的表可能包含的数据：每分钟一个带有数字的`t`时间戳。（您不需要那部分，而是使用您的桌子。）`ts``bandwidth`

这是一个非常相似的问题的非常相似的解决方案 - 详细解释了这个特定聚合是如何工作的：

*   [PostgreSQL 中的 date_trunc 5 分钟间隔](https://stackoverflow.com/questions/12165827/date-trunc-5-minute-interval-in-postgresql/12167385#12167385)

*以下是关于运行*总和的类似问题的类似解决方案- 详细说明和使用的各种函数的链接：

*   [PostgreSQL：“按分钟”查询的运行行数](https://stackoverflow.com/questions/8193688/postgresql-running-count-of-rows-for-a-query-by-minute/8194088#8194088)

### 评论中的附加问题

```
WITH -- same as above ...

SELECT DISTINCT ON (1,2)
       date_trunc('hour', ts) AS hour_stump
      ,(extract(minute FROM ts)::int / 15) AS min15_slot
      ,bandwidth AS bandwith_sample_at_min15
FROM   t
WHERE  ts >= '2012-09-02 00:00:00+02'::timestamptz
AND    ts <  '2012-09-03 00:00:00+02'::timestamptz
ORDER  BY 1, 2, ts DESC; 
```

每 15 分钟间隔检索*一个未聚合的样本 - 从窗口中的**最后一个可用行*。如果该行没有丢失，这将是第 15 分钟。关键部分是`DISTINCT ON`和`ORDER BY`。
有关此处使用的技术的更多信息：

*   [在每个 GROUP BY 组中选择第一行？](https://stackoverflow.com/questions/3800551/select-first-row-in-each-group-by-group/7630564#7630564)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-27T14:32:36.383

```
select
    date_trunc('hour', d) + 
    (((extract(minute from d)::integer / 5 * 5)::text) || ' minute')::interval
    as "from",
    date_trunc('hour', d) + 
    ((((extract(minute from d)::integer / 5 + 1) * 5)::text) || ' minute')::interval
    - '1 second'::interval
    as "to",
    sum(random() * 1000) as bandwidth
from 
    generate_series('2012-01-01', '2012-01-31', '1 minute'::interval) s(d)
group by 1, 2
order by 1, 2
; 
```

5分钟的范围。15 分钟除以 15。

# gdb - GDB 加载不正确的库

> ID：12623362
> 
> 赞同：0
> 
> 时间：2012-09-27T14:09:56.790
> 
> 标签：gdb, cgdb

我有两个不同版本的库，比如说 libxyz.so

在两个不同的位置

```
1) /home/maverick/dev/libxyz.so ( development Version)
2) /home/maverick/prod/libxyz.so ( Production Version ) 
```

我有一个设置，可以编译我的程序并根据 LD_LIBRARY_PATH 链接到适当版本的库。例如，如果我想将我的程序与 libxyz 的 dev 版本链接，我将 LD_LIBRARY_PATH 更改为添加 /home/maverick/dev，如果我想与 prod 版本链接，我将 LD_LIBRARY_PATH 更改为添加 /home/maverick/prod。

我通过链接开发版本和输出来编译我的程序

```
ldd MyProg 
```

是

```
libxyz.so => /home/maverick/dev/libxyz.so 
```

如果我运行程序，它会从

```
/home/maverick/dev/libxyz.so 
```

并且运行良好。这一点我的 LD_LIBRARY_PATH 包括 /home/maverick/dev 而不是 /home/maverick/prod

但是当我尝试通过 GDB 调试这个程序时

```
gdb MyProg 
```

它从位置加载 libxyz.so

```
/home/maverick/prod/libxyz.so 
```

我在调试期间无法让 GDB 加载正确版本的库。所以到目前为止，我正在做的是首先启动程序（加载开发版本）并将gdb附加到该PID，这样它就可以正常工作了。但如果它像

```
gdb MyProg 
```

它没有

我尝试了所有方法来解决这个问题，比如在 GDB 中设置 sysroot、solib-search-path，但没有任何效果。如果事实上当我设置 sysroot 指向库 gdb 的调试版本时给出了一些类似的消息

```
.dynamic section for XXX is not at the expected address 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:58:25.083

> 我在调试期间无法让 GDB 加载正确版本的库。

让我猜猜：你正在使用`tcsh`，对吧？

问题很可能来自您`~/.cshrc`重置`LD_LIBRARY_PATH`为`/home/maverick/prod`.

当您`run`在 GDB 中执行程序时，它会执行`$SHELL -c your-program [args...]`（以便允许您使用 I/O 重定向）。

解决方案：不要在你`.cshrc`的非交互式 shell 中触摸环境，例如：

```
if ($?prompt  ==  0) exit 
```

# c# - LINQ：没有使用点符号的 long final 匿名变量的多个 JOINS

> ID：12623363
> 
> 赞同：1
> 
> 时间：2012-09-27T14:09:56.990
> 
> 标签：c#, linq

我有一个使用点符号的 Linq 查询，它必须与几个不同的枚举进行连接。我发现进行多重连接的方法是一个接一个地进行：而不是等同于以下 SQL 语句：

```
SELECT
   blah blah blah
FROM
   tableOne as One, tableTwo as Two, tableThree as Three
WHERE
   One.fieldOne == Two.fieldOne AND
   One.fieldTwo == Three.fieldTwo AND
   One.fieldThree == something 
```

它最终是这样的：

```
SELECT
    blah blah blah
FROM
    (
      SELECT 
          blah blah blah
      FROM
          tableOne as One, tableTwo as Two
      WHERE
          One.fieldOne == Two.fieldOne
          One.fieldThree == something
    ) as firstJoin,
    tableThree as Three
WHERE
    firstJoin.fieldTwo == Three.fieldTwo 
```

Linq 中的 .Join() 看起来像：

```
localTableOne.Join(localTableTwo,
                   One => One.fieldOne,
                   Two => Two.fieldOne,
                   (One, Two) => new { One, Two }) 
```

我遇到的问题是，一旦我进入第二个 JOIN，前一个 JOIN 结果的结果的匿名变量没有属性“fieldOne”或“fieldTwo”或本地表的任何字段加入。它有一个属性“One”，它具有第一个表中的属性，以及一个属性“Two”，其中包含表 2 中的属性。所以，如果我想将这些结果与另一个表连接起来，内部的 lambda 函数桌子看起来像

```
firstJoinResult => firstJoinResult.One.fieldOne 
```

如果我只加入三个表，这不会是一个问题。我目前正在加入 7 张桌子。Linq 查询以 .Select() 函数结束，因此 lambda 函数的字段最终看起来像：

```
fieldOne = seventhJoin.sixthJoin.fifthJoin.fourthJoin.thirdJoin.secondJoin.firstJoinResult.One.fieldOne 
```

有什么办法可以让这个电话变小吗？以某种方式直接访问我正在寻找的领域？另一种进行多重连接的方法？

谢谢

**UPD**

我忘了提到我正在寻找使用点符号 Linq 的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T14:13:01.970

使用查询语法它看起来像这样

```
var query = from One in tableOne 
            from Two in tableTwo
            from Three in tableThree
            where One.fieldOne == Two.fieldOne
            where One.fieldTwo == Three.fieldTwo
            where One.fieldThree == something
            select new {
            }; 
```

# templates - 另一个模板中的 Facelets 模板

> ID：12623366
> 
> 赞同：4
> 
> 时间：2012-09-27T14:10:20.800
> 
> 标签：templates, jsf-2, facelets

我想在另一个模板中使用 Facelets 模板。目前我有一个“基本”模板，到目前为止已经足够我完成的所有页面。它有一个顶部和一个内容区域。

顶部具有徽标、菜单、登录/注销功能，而内容区域则显示内容。

现在我需要做另一个页面（保存用户个人资料信息），我想在左侧有一个菜单并在右侧显示结果。此页面应插入基本模板内容区域。

是否可以创建一个定义这两个区域（profile_left 和 profile_content）的新模板，并以某种方式仍然使用基本模板？

我看不出为什么我不能只复制基本模板中的代码并添加我想要的新“定义”（profile_left 和 profile_content），但我仍然想知道是否可以继续使用原始基本模板。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-27T14:17:36.880

您可以根据需要从模板扩展。您可以仅从一个模板或您似乎认为的其他东西进行扩展，这是不正确的。

例如：

`/WEB-INF/templates/base.xhtml`

```
<!DOCTYPE html>
<html lang="en"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
>
    <h:head>
        <title><ui:insert name="title">Default title</ui:insert></title>
    </h:head>
    <h:body>
        <div id="header">Header</div>
        <div id="menu">Menu</div>
        <div id="content"><ui:insert name="content">Default content</ui:insert></div>
        <div id="footer">Footer</div>
    </h:body>
</html> 
```

`/WEB-INF/templates/profile.xhtml`

```
<ui:composition template="/WEB-INF/templates/base.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
>
    <ui:define name="content">
        <div id="profile_left"><ui:insert name="profile_left" /></div>
        <div id="profile_right"><ui:insert name="profile_right" /></div>
    </ui:define>
</ui:composition> 
```

`/user.xhtml`

```
<ui:composition template="/WEB-INF/templates/profile.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
>
    <ui:define name="title">User profile</ui:define>
    <ui:define name="profile_left">
        Profile left.
    </ui:define>
    <ui:define name="profile_right">
        Profile right.
    </ui:define>
</ui:composition> 
```

### 也可以看看：

[如何使用 JSF 2.0 Facelets 在 XHTML 中包含另一个 XHTML？](https://stackoverflow.com/questions/4792862/how-to-include-another-xhtml-in-xhtml-using-jsf-2-0-facelets/4793959#4793959)

# django - Django如何标记安全链接而不是gettext翻译中的参数

> ID：12623368
> 
> 赞同：1
> 
> 时间：2012-09-27T14:10:22.913
> 
> 标签：django, django-templates, gettext

假设我们有这样的消息：

```
 messages.add_message(request, messages.SUCCESS,
                _('Document <a href="%(url)s">%(doc_type_name)s %(name)s (%(fname)s)</a> created.') % {
                    'doc_type_name': conditional_escape(document.doc_type.name),
                    'name': conditional_escape(document.title),
                    'fname': conditional_escape(document.name),
                    'url': document.get_absolute_url()
                }) 
```

在这里，只有当我们显示消息时它才会起作用，`{{ message|safe }}`但我们不希望这样，因为如果其中有一些代码，`%(name)`它也会被执行。

如果我使用：

```
 messages.add_message(request, messages.SUCCESS,
                mark_safe(_('Document <a href="%(url)s">%(doc_type_name)s %(name)s (%(fname)s)</a> created.') % {
                    'doc_type_name': conditional_escape(document.doc_type.name),
                    'name': conditional_escape(document.title),
                    'fname': conditional_escape(document.name),
                    'url': document.get_absolute_url()
                })) 
```

`mark_safe`不起作用。

我在那里阅读了一个解决方案：[https ://stackoverflow.com/a/12600388/186202](https://stackoverflow.com/a/12600388/186202)

但这是我在这里需要的相反：

```
_('Document %s created.') % mark_safe('') 
```

一旦它通过`ugettext function`它就不再安全了。

我应该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T00:31:56.780

您试图通过在 Python 代码中放置 HTML 来混合视图和逻辑。好吧，有时您只需要这样做，但事实并非如此。

mark_safe() 返回由 Django 模板特别处理的 SafeString 对象。如果 SafeString 由 ugettext 或 % 评估，您将再次获得字符串，这是预期的行为。您不能仅将格式化字符串标记为安全，或者使用文档名称/标题等完成输出，或者一切都不安全。即，它不会以这种方式工作。

您可以将 HTML 放入模板并使用 render_to_string()，这可能是最好的选择。

文档标题、名称和 doc_type.name 是否由用户设置？如果没有，您可以跳过 mark_safe 和使用文档属性中的 HTML 作为功能的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-08T08:57:21.903

之前的回答是正确的：您应该尽可能避免混合使用 python 和 html。

要解决您的问题：

```
from django.utils import six  # Python 3 compatibility
from django.utils.functional import lazy
from django.utils.safestring import mark_safe
from django.utils.translation import ugettext_lazy as _
mark_safe_lazy = lazy(mark_safe, six.text_type) 
```

然后：

```
lazy_string = mark_safe_lazy(_("<p>My <strong>string!</strong></p>")) 
```

在 django 文档中找到： [https ://docs.djangoproject.com/en/1.9/topics/i18n/translation/#s-other-uses-of-lazy-in-delayed-translations](https://docs.djangoproject.com/en/1.9/topics/i18n/translation/#s-other-uses-of-lazy-in-delayed-translations)

# java - android - 包括布局或片段

> ID：12623369
> 
> 赞同：1
> 
> 时间：2012-09-27T14:10:26.570
> 
> 标签：java, android, layout, include, fragment

假设我有一个调用`title_bar.xml`布局文件的类 TitleBar。一些 TextViews 设置在`TitleBar.java`文件中，因此`title_bar.xml`依赖于它。包含此布局文件的最简单方法是什么？显然，使用只是`include layout`不会完成这项工作。在这种情况下我应该使用片段吗？我更喜欢使用`include`，但我只是不知道如何调用代码隐藏文件？

希望我的问题足够清楚。

谢谢

**编辑：** 目前，TitleBar 是一项活动。我应该将其更改为其他内容吗？

**编辑 2：** 让我尝试以不同的方式提问：我有 MainActivity 和 activity_main.xml 文件。如何在 activity_main.xml 中包含新布局文件 (title_bar.xml) 并将 TitleBar.java 类与这个新视图相关联？TitleBar.java 应该是什么样子？我也应该将其创建为一项活动吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:15:35.697

您只需要布局文件或 TitleBar 功能吗？为什么不在`<path.to.your.TitleBar/>`布局中使用？从 View 扩展 TitleBar 是合乎逻辑的。

其他选项包括在您想要标题栏的位置（您想要包含的位置）放置一个空容器。例如`<LinearLayout android:id="@+id/toolbarWillBeHere"`，当合适的时间到来时（例如在您的活动 onCreate 中），只需找到该容器并将工具栏放入其中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:16:55.227

你正在寻找的是在这里：http: [//developer.android.com/guide/topics/ui/custom-components.html](http://developer.android.com/guide/topics/ui/custom-components.html)

基本上，您可以使用以下方式在 xml 中添加视图/布局：

```
<com.your.package.name.TitleBar
  id="@+id/titleBar"
  ... /> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-27T14:16:33.757

通过只是`including the layout`会做的工作。

一旦您的布局附加到您的`layout xml file`.`findViewByID``View.`

# php - SoapFault 异常：发送方和接收方时钟之间缺乏同步

> ID：12623370
> 
> 赞同：1
> 
> 时间：2012-09-27T14:10:28.620
> 
> 标签：php, api, soap, linux-kernel

我正在使用 DocuSign API 并遇到了一些问题。将数据请求发送到他们的服务器时，我收到以下错误：

```
SoapFault exception: [q0:InvalidSecurity] An error was discovered 
processing the <Security> header ---> WSE065: Creation time of the 
timestamp is in the future. This typically indicates lack of synchronization 
between sender and receiver clocks. Make sure the clocks are synchronized 
or use the timeToleranceInSeconds element in the microsoft.web.services3 
configuration section to adjust tolerance for lack of clock synchronization. 
```

我查看了他们的社区论坛，我能从他们的论坛管理员那里找到的唯一回复是：

```
The message means that the client clock is wrong. The timezone might be set 
incorrectly. If the SOAP request is timestamped too far in the future or in the 
past, the server will reject it.  We generally run into this error with mobile 
apps since folks don't always have their devices set to sync to network time. 
```

我检查了我的服务器时间以及我的计算机时间，以确保一切正常。我的电脑时间设置为EST，服务器设置为CST。我已经尝试在我的计算机上更新和同步我的系统时钟，并尝试将我的时区调整为 CST 以确保它们都匹配。我还将我的计算机时间更改为格林威治标准时间，因为这就是他们所说的服务器时间。我也尝试过更新我服务器的时钟，因为它似乎有点不对劲。（我的时钟和服务器时钟之间似乎有 6 分钟的差异）。

**我在服务器上运行了这个命令：**

```
sudo ntpdate ntp.ubuntu.com 
```

**回复：**

```
27 Sep 08:51:41 ntpdate[18858]: step time server 91.189.94.4 offset -357.639332 sec 
```

我还尝试在服务器上编辑我的 grub 配置文件（/boot/grub/grub.conf）。**我尝试将这些参数的不同组合添加到内核行的末尾：**

```
clock=pit 
acpi=off 
noapic 
```

**以及尝试使用此命令更新硬件时钟：**

```
hwclock=systohc 
```

**肥皂标题如下：**

该请求是在上午 10:41（我的计算机时间 [EST]）、上午 9:47（我的服务器时间 [CST]）发出的。

**要求：**

```
POST /api/3.0/api.asmx HTTP/1.1
Host: www.docusign.net
Connection: Keep-Alive
User-Agent: PHP-SOAP/5.3.16
Content-Type: text/xml; charset=utf-8
SOAPAction: "http://www.docusign.net/API/3.0/CreateEnvelope"
Content-Length: 116157 
```

**回复：**

```
HTTP/1.1 500 Internal Server Error
Cache-Control: private
Content-Length: 1696
Content-Type: text/xml; charset=utf-8
Server: Microsoft-IIS/7.5
X-AspNet-Version: 2.0.50727
X-Powered-By: ASP.NET
Date: Thu, 27 Sep 2012 14:41:13 GMT
Vary: Accept-Encoding
Strict-Transport-Security: max-age=7776000; includeSubDomains 
```

如果有人对可能导致此错误的原因有任何想法，或者如果有人对如何同步我的时钟有任何进一步的建议，我很想听听他们的意见。

提前感谢您的时间和考虑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:51:58.230

我最终联系了我托管我的虚拟服务器的公司，事实证明这根本不是我可以控制的任何问题。事实证明，他们的管理程序（虚拟机监视器 - VMM）出现了问题，所以当我的服务器与其同步时间时，我的时间被抵消了大约 7 分钟。由于我的服务器的系统时钟由它控制，这也使我无法使用以下命令手动设置时间：

```
date -s "27 SEP 2012 HH:MM:SS" 
```

因为这些更改将被 VMM 取代。

# android - 使用 apache ant 时如何忽略 AndroidManifest 错误？

> ID：12623371
> 
> 赞同：0
> 
> 时间：2012-09-27T14:10:34.157
> 
> 标签：android, ant, admob

当我在 Eclipse 中构建应用程序时，一切正常，但是当我尝试使用 apache ant 构建时，我遇到了一些错误：

```
[aapt] ...\AndroidManifest.xml:10: error: No resource identifier found for attribute 'hardwareAccelerated' in package 'android'
[aapt] ...\AndroidManifest.xml:23: error: Error: String types not allowed (at 'configChanges' with value 'keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize|fontScale'). 
```

我使用 minSDKVersion=7 的“uses-sdk”（我需要在 Android 2.1 设备上运行应用程序）。当我从“configChanges”中删除“uiMode|screenSize|smallestScreenSize”值并删除“hardwareAccelerated”时，ANT 正确完成了它的工作，但 AdMob 无法正常工作。

我知道，“uiMode|screenSize|smallestScreenSize”值首先在 SDK API 级别 13 中引入，但是当我使用 Eclipse 构建应用程序时，在 Android 2.1 上一切正常。

我不知道我该怎么办;(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:15:43.857

尝试将 targetSDKVersion 设置为 13？

```
<uses-sdk android:minSdkVersion="7" android:targetSdkVersion="13"/> 
```

# java - 我需要找到一个合适的数据结构

> ID：12623372
> 
> 赞同：0
> 
> 时间：2012-09-27T14:10:35.780
> 
> 标签：java, algorithm

我不确定应该使用什么数据结构来解决它，我有一个类别列表和与它们相关联的值列表，如下所示：

```
Categories           Values 
Smart             **person1**,person2
Handsome          person3,person6,**person1**
Hard-Working      person7,person9 
```

例如，person1 是 Smart 和 Handsome，因为他同时属于 Handsome 和 Smart 类别。（一个值（人）可以有很多类别）并且 person2 是 Smart 但不是 Handsome。

人对象具有姓名、年龄和性别，例如人 1 是

```
John 43 Male 
```

我想知道如何设计它，**我在考虑一个二维阵列**，但这不是一个好主意，因为我会有一些空闲的地方

```
Cat1 v3,v6 Spare Spare
Cat2 v10 Spare Spare Spare
cat4 v6,v7,v8,v9 
```

**我想最好是有一个列表，但**不确定如何找出哪个值是哪个或哪个类别的（例如上面示例中与 cat1 和 cat4 相关联的 V6）

```
 V3 v6 v7 v8 v9 v10 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:12:29.177

你可以使用类似的东西

`Map<Category, List<Person>>`

由于`Map`应该提供 O(1) 访问权限，因此您希望您的密钥成为您最常用于查找的密钥（在您的情况下为类别，来自我收集的内容）。所以如果你有

`Map<Category, List<Person>> categoryLookup = new HashMap<Category, ArrayList<Person>>();`

你可以做

`List<Person> values = myCategoryLookup.get(someCategory);`

然后迭代这些值。对相同值的引用可以在多个列表中——这不是问题。

对于下面的 Yameo，如果您想获取某个人的类别，您可以

1.  `Person`维护其类别 列表
2.  “反转”上面的数据结构；即也保持一个`Map<Person, List<Category>>`

这些解决方案的替代方法是在`Category`和`Person`类本身中设置关系。例如，`Person`将 a`List<Category>`作为其类属性之一，并且类似地`Category`将 a`List<Person>`作为其类属性之一。但我觉得这更像是一个数据结构问题。如果您有一个包含实际数据的数据库并且打算使用 ORM 工具将数据映射到 Java 类，那么您可能会这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:20:35.697

在数据库中，您将使用[联结表](http://en.wikipedia.org/wiki/Junction_table)。另请参见[多对多](http://en.wikipedia.org/wiki/Many-to-many_%28data_model%29)。根据您的需要，您可以将`enum`a 用于类别，将 a`MultiMap<Person, Category>`用于存储。

# php - 除了 SQL 注入之外，我还应该注意网站中的哪些其他安全漏洞？

> ID：12623373
> 
> 赞同：0
> 
> 时间：2012-09-27T14:10:36.010
> 
> 标签：php, html, css, security, codeigniter

我通常使用 codeigniter 框架，它提供了一些防止 sql 注入的帮助，例如 xss clean of form input data。

我对什么是 sql 注入以及如何阻止它的发生有一个基本的了解，但是我的一个朋友有一个非常基本的站点，其中唯一的用户输入是电子邮件脚本的 cgi 表单 - 该站点的某些部分被替换为一些成人内容。

所以我很好奇有人如何控制这样一个基本站点，以及在构建自己的站点时应该注意哪些漏洞？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T14:13:10.393

一个好的起点是[OWASP](https://www.owasp.org/)。

特别是[OWASP Top 10 详细介绍了最常见的安全问题](https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project)。

原则上你应该...

*   **永远不要**相信用户输入（包括表单输入、URL 输入、cookies - 用户可以更改的任何内容，包括使用 Firebug 等检查工具或 Fiddler 等中间人工具）。有很多这样的类别，但 OWASP 确实单独涵盖了它们。

*   **永远不要**相信其他人的脚本（例如，您将他们的 JavaScript 文件包含在您的网站中，或者将他们的 PHP 文件包含在您的网站中）

*   **切勿**通过纯 HTTP 执行登录或其他敏感数据交换

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:24:00.247

最好的办法是阅读 OWASP 前 10 名。如果您不熟悉它，那就是开放 Web 应用程序安全项目，它是一个致力于 Web 应用程序安全的社区。

最容易被恶意用户利用的是 SQL 注入和 XSS。XSS 可能对您的用户不利，但单个 SQL 注入漏洞可能会危及您的整个服务器。可以通过简单地使用参数化查询来防止 SQLI，并且可以通过良好的输入验证和输出编码来防止 XSS。

从软件工程的角度来看，用户提供的输入（包括隐藏字段）不应该驱动核心功能。例如，如果您在您的网站上销售产品并且有一个带有价格的隐藏字段，这是非常糟糕的，因为有人可以很容易地修改该值。

如果您正在收集用户名和密码，请确保它们经过哈希处理和加盐处理，并确保所有显示或收集用户信息的登录屏幕和页面都具有 SSL (https)。

可以在以下网址找到 OWASP 前 10 名文档：[https ://www.owasp.org/index.php/Top_10_2010](https://www.owasp.org/index.php/Top_10_2010)

如果您在输入验证和编码方面需要帮助，请查看 OWASP ESAPI - [https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API](https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API)并单击 PHP 选项卡。

对于 SQL 注入，只要您正确使用框架，像 codeigniter 这样的框架就应该保护您。谢天谢地，由于框架使用的增加，SQLI 的问题越来越少。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T14:26:35.123

安全问题与代码行数一样多。一些例子：

*   SQL注入
*   后端的 XSS（包括远程代码`require_once($_GET['x']`）
*   前端的 XSS（包括 JAVASCRIPT 进入页面以劫持会话）
*   代表用户运行不需要的操作 - 每个操作，如“更改密码”、“更改配置文件”、“注销”、“添加内容”都应该需要一个唯一的令牌，否则有人可以将用户重定向到这些操作
*   如果您从`svn checkout`保护每个公共目录中的 .svn 文件夹中释放

您始终可以使用一些扫描器，例如[http://code.google.com/p/skipfish/](http://code.google.com/p/skipfish/)来帮助您发现应用程序中的安全问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-27T14:12:44.933

您可以查看 www.enigmagroup.org/，这对于了解不同的攻击和漏洞非常有用。

# hubot - 是否有 hubot 命令可以查看频道中的人员？

> ID：12623375
> 
> 赞同：2
> 
> 时间：2012-09-27T14:10:39.740
> 
> 标签：hubot

我想要当前频道中所有人的列表。

我怎样才能得到这个`hubot`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-20T00:50:03.420

至少你可以`channellist_item`在[IRC API](https://node-irc.readthedocs.org/en/latest/API.html)中尝试，它说

> 为服务器返回的每个通道发出。channel_info 对象包含键“name”、“users”（频道上的用户数）和“topic”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T15:44:57.910

不 - 似乎这是不可能的。最好的`hubot`办法是跟踪人们进入和离开频道，但没有简单的命令可以获取所有当前的人。

# .net - System.Net 类型的 Type.GetType 失败

> ID：12623380
> 
> 赞同：1
> 
> 时间：2012-09-27T14:10:52.767
> 
> 标签：.net, reflection

我只是在尝试通过反射实例化 WebProxy 实例时遇到了这个奇怪的问题：

```
 Dim proxyType As Type = GetType(System.Net.WebProxy)
    MsgBox(proxyType.FullName)

    Dim reflProxyType As Type = Type.GetType(proxyType.FullName)
    MsgBox(reflProxyType.FullName) ' Here, reflProxyType is null => NullReferenceException 
```

将第一行更改为其他系统命名空间（即 System.Text.StringBuilder 或 System.String）可以正常工作。

```
 Dim systemType As Type = GetType(System.Text.StringBuilder)
    MsgBox(systemType.FullName)

    Dim reflSystemType As Type = Type.GetType(systemType.FullName)
    MsgBox(reflSystemType.FullName) ' Here, everything works fine 
```

这种行为有什么原因吗？我错过了什么吗？MS 是否对 System.dll 设置了一些限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:14:50.143

答案在[MSDN 文档](http://msdn.microsoft.com/en-us/library/w3f99sx1.aspx)中`Type.GetType (string)`

> 参数
> 
> typeName 类型：System.String
> 
> 要获取的类型的程序集限定名称。请参阅 AssemblyQualifiedName。**如果该类型在当前执行的程序集中或在 Mscorlib.dll 中，**则提供由其命名空间限定的类型名称就足够了。

该类[`WebProxy`](http://msdn.microsoft.com/en-us/library/system.net.webproxy.aspx)位于*System.dll*中，而不是 Mscorlib.dll。因此，您必须：

1.  提供程序集限定名称而不仅仅是完全限定名称。（或者）
2.  使用[`Assembly.GetType(string)`](http://msdn.microsoft.com/en-us/library/y0cd10tb.aspx)方法。

# windows - WebControl 与 Win32/MFC 之间的 2 路通信

> ID：12623381
> 
> 赞同：1
> 
> 时间：2012-09-27T14:10:55.497
> 
> 标签：windows, winapi, visual-c++, mfc

我正在开发一个 win32/MFC 应用程序；在这个应用程序中，我在对话框中嵌入了 WebControl。

当应用程序启动时，它将加载网页，用户将输入一些字段，然后按提交按钮。

一旦用户按下提交，服务器将处理该数据并向用户显示一些唯一的 ID。

现在我们的要求是，我们不想在网页上显示该唯一 ID，而是该网页需要将该数据发送到我们的客户端应用程序 (Win32/MFC)。

为此，我找到了一个解决方案：

[从运行在 Web 浏览器控件中的 JavaScript 脚本调用 C++ 函数](https://stackoverflow.com/questions/3747414/calling-c-function-from-javascript-script-running-in-a-web-browser-control)

这是正确的方法还是有其他解决方案。

请帮我解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T20:52:24.493

覆盖[OnGetExternal](http://msdn.microsoft.com/en-us/library/bat7a958%28v=VS.80%29.aspx)（或者如果您在自己的窗口中托管，请[更改您的 IDocHostUIHandler::GetExternal 实现](http://msdn.microsoft.com/en-us/library/aa770041%28v=VS.85%29.aspx#GetExternal)）并返回指向 CComTarget 的指针，该指针具有[通过自动化公开](http://msdn.microsoft.com/en-US/library/w7a36sdf%28v=vs.80%29.aspx)的 appsubmit 方法。更改网页以添加一个[onsubmit 处理程序](http://msdn.microsoft.com/en-us/library/ie/ms536972%28v=vs.85%29.aspx)，该处理程序使用隐藏字段的值调用您的方法

```
return window.external.appsubmit(uniqueId); 
```

# outlook - 搜索每个人的 Outlook 日历

> ID：12623383
> 
> 赞同：1
> 
> 时间：2012-09-27T14:11:01.097
> 
> 标签：outlook, exchange-server

有人问我是否可以用 C#（最好是 ASP.net）编写一个应用程序，给定日期和关键字，可以在我们的 Exchange 服务器上搜索每个人的 Outlook 日历，并返回一个名称列表。

这甚至可能吗？如果是这样，有人指出我正确的方向吗？

谢谢，迈克

# android - 使用电话：使用电话分机发起呼叫

> ID：12623387
> 
> 赞同：4
> 
> 时间：2012-09-27T14:11:17.790
> 
> 标签：android, html, mobile, anchor, tel

格式化电话的正确方法是什么：与电话分机链接？我已经看到了一些不同的建议，但我不清楚哪一个是最终的方法。

```
<a href="tel:5555555,555">555-5555 ext. 555</a> 
```

使用 android 2.3.4，我无法通过拨打电话分机的链接拨打电话。

[RFC3966](https://www.rfc-editor.org/rfc/rfc3966#section-3)表明这是正确的格式：

```
extension = ";ext=" 1*phonedigit 
```

但我不清楚 1* 的用途，我也无法使这种格式工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-21T03:29:54.400

The 1* is for the ABNF generative grammar used by RFC3966 and means 1 or more digits make up the extension field.

See [http://en.wikipedia.org/wiki/Augmented_Backus%E2%80%93Naur_Form](http://en.wikipedia.org/wiki/Augmented_Backus%E2%80%93Naur_Form) for the ABNF used.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-14T06:44:02.727

您可以尝试 `<a href="tel:5555555p555">555-5555 ext. 555</a>` p 暂停 1 秒

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-13T06:37:22.877

语法是用[RFC2234](https://www.rfc-editor.org/rfc/rfc2234)中描述的 ABNF 表示法编写的。

URI的语法`tel`是（缩写）：

```
telephone-uri        = "tel:" telephone-subscriber
telephone-subscriber = global-number / local-number
global-number        = global-number-digits *par
local-number         = local-number-digits *par context *par
par                  = parameter / extension / isdn-subaddress
extension            = ";ext=" 1*phonedigit 
```

和`"tel:"`标记`";ext="`是文字字符串。
该`1*phonedigit`符号表示以下一种或多种产生式（例如`phonedigit`）。

据我所知，电话号码应标记为：

```
<a href="tel:5555555;ext=555">555-5555 ext. 555</a> 
```

**免责声明**：我从未使用过电话号码 URI，也不知道浏览器的支持情况如何。我什至不确定这是对`ext`参数的适当使用。

另请注意，[RFC3966](https://www.rfc-editor.org/rfc/rfc3966#section-5.1.5)指出：

> 本地号码**必须**具有`phone-context`标识其有效性范围的参数。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-09-27T14:13:53.920

这应该有效：

```
<a href="tel:+18881234567">Make a call</a> 
```

通常在开头使用 + 会更容易（要求您有国家代码，但要保证手机正确识别号码）。

# c# - 以安全的方式设置密码文本框值

> ID：12623391
> 
> 赞同：1
> 
> 时间：2012-09-27T14:11:22.547
> 
> 标签：c#, asp.net, textbox

是否有任何**安全**的方法可以在密码模式下为文本框设置值？

我有一个带有密码文本框的自定义登录表单：
`<asp:TextBox ID="tbPassword" runat="server" TextMode="Password"></asp:TextBox>`
在页面加载时，我想放一些我在 cookie 的代码隐藏中解密的记住密码。

我发现 95% 的答案是设置文本框值，例如：
`tbPassword.Attributes["value"] = "ThePassword";`

但是，这不是最安全的方式，因为它会生成以下 HTML 代码，在查看源代码时可见，其中密码以纯文本形式存储：

```
<input id="tbPassword" type="password" value="ThePassword" name="ctl00$cpMainContentParent$tbPassword"> 
```

我用 jQuery 尝试了不同的方式，设置值：

```
$("#tbLogin").val("ThePassword"); 
```

这要好得多，因为该值在查看源代码中不可见，但密码在页面上的 jQuery 脚本中可见...

我也尝试注册客户端脚本并运行它，但因为我无法“取消注册”它，所以结果与普通的 jQuery sript 相同......

您是否知道设置该值而不在源代码中显示它的任何解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:22:57.753

不要在 INPUT 元素中设置密码。相反，将其设置为随机或固定值（如果您想指示已设置密码），否则为空。正如您所说，这意味着密码在页面源中可见。要处理更改密码，请在密码值时设置一个标志，以便服务器或客户端的处理代码知道密码何时被修改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:25:43.587

正如鲍勃的评论所说，整个概念是有缺陷的。如果 cookie 有效，则跳过密码提示。如果它无效，那么您就没有什么可自动填充的了。

话虽如此，您无法直接填充无法以某种方式拦截的文本框。即使您通过加载后 AJAX 调用填充它，用户仍然可以通过 FireBug 之类的东西看到内容。这是网络浏览器的本质所固有的——浏览器本身没有什么是安全的，因为浏览器需要理解它才能呈现它。

如果您**真的**想这样做，一种选择是计算包含时间戳（或其他一次性值）的密码的自定义哈希，并将文本框设置为该值。您需要接受标准密码和哈希作为有效，但哈希将不可重复使用，因此用户是否看到它并不重要。

# php - 在 Yii（或任何支持 ORM 的框架）中放置 sql 查询的位置？

> ID：12623393
> 
> 赞同：0
> 
> 时间：2012-09-27T14:11:24.580
> 
> 标签：php, activerecord, orm, yii

对于使用 MVC 架构的项目，这更像是一个编码风格问题。

我正在使用 Yii 框架开发一个项目。每个数据库表都有自己的模型类，让我可以利用 Yii 的 Active Record 东西。凉爽的。

但是现在我需要使用复杂的逻辑和很多要连接的表进行 SQL 查询。最好和最快的方法是编写一个原始 SQL 并将其放入某种`getSomeComplexLogicData`方法中。

问题是，我把这个方法放在哪里？将它放在我调用它的控制器中是一个好习惯（它极不可能在其他任何地方重复使用），还是应该将它放在它最对应的某个模型类中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T15:13:24.080

Yii 的“模型”不强制扩展`CActiveRecord`。

您可以创建一个简单的[域对象](http://c2.com/cgi/wiki?DomainObject)，其中包含代码中某些结构的业务逻辑，并为该结构具有单独的[映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)，其中包含复杂的 SQL 查询。

您应该尽量避免将所有内容集中在一个类中，因为您最终会违反[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)，这是活动记录模式通常被认为是有害的主要原因之一（当然，也有一些例外）。它将机器人域逻辑和存储逻辑结合在单个类上，从而使其难以测试和维护。

* * *

如果您使用的是正确的 MVC 或受 MVC 启发的设计模式，则不会有“模型”。模型[应该是](https://stackoverflow.com/a/5864000/727208)一个层。不是类或对象。而且您不应该将任何域业务逻辑暴露给控制器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:19:37.880

1）您可以将此方法放入 components/Controller.php 以便您可以将此方法用于您的每个应用程序控制器。

2）最好的方法是制作自己的组件。您可以从控制器、模型、视图中调用您的组件。

```
Yii::app()->yourcomponentname->methodname 
```

学习如何制作组件的链接：[http ://www.yiiframework.com/wiki/187/how-to-write-a-simple-application-component/](http://www.yiiframework.com/wiki/187/how-to-write-a-simple-application-component/)

# java - 具有弹簧集成的 UDP 服务器

> ID：12623394
> 
> 赞同：5
> 
> 时间：2012-09-27T14:11:25.180
> 
> 标签：java, spring-integration

我想知道是否可以使用能够接受请求并返回响应的 spring-integration 框架创建一个 UDP 服务器。

对于 TCP，有允许请求/响应处理的 TCP 网关，但对于 UDP，我没有看到类似的东西。

设置 UDP 侦听器和接收数据包很容易，但是我看不到如何返回响应，因为我只能将它路由到预定义的输出通道。

此外，我看不到发件人的 IP 和端口，因为转换器没有收到 DatagramPacket 对象，而只收到数据。

这是我的配置：

```
<int:channel id="ChannelIn" />

<ip:udp-inbound-channel-adapter id="ChannelReceiver"
    channel="ChannelIn"
    port="5555"
    multicast="false"
    check-length="false" 
    pool-size="10"
    />

<int:transformer
    ref="datagramToPacketTransformer"
    input-channel="ChannelIn"
    output-channel="ChannelSA" 
    method="toPacket"/>

<int:channel id="ChannelSA" />

<int:service-activator id="ChannelActivator" 
    input-channel="ChannelSA"
    ref="PacketHandler"
    method="process"
/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-12T07:58:41.743

我找到了处理 UDP 的方法。下面是我的配置

```
<int-ip:udp-inbound-channel-adapter id="ChannelReceiver"
                                    channel="serverBytes2StringChannel"
                                    port="9000"
                                    multicast="false"
                                    check-length="false" 
                                    pool-size="10"
                                    lookup-host="false"
/>

<int:transformer id="serverBytes2String"
                 input-channel="serverBytes2StringChannel"
                 output-channel="udpSA" 
                 expression="new String(payload)"

/>

<int:service-activator input-channel="udpSA" 
                       ref="deviceService" 
                       method="udpMessage"/> 
```

`deviceService`bean 有这个代码：

```
 public Message udpMessage(Message message) {
        String response = "KO";
        try {
            response = process(message);
        } catch (Throwable th) {
            //do something
        }
        Message msg = MessageBuilder.withPayload(response.getBytes()).copyHeaders(message.getHeaders()).build();
        sendReply(msg);
        return null;
    }
    private void sendReply(Message message) {
        try {
            int port = (Integer) message.getHeaders().get("ip_port");
            String ip = (String) message.getHeaders().get("ip_address");
            InetAddress IPAddress = InetAddress.getByName(ip);

            byte[] sentence = (byte[]) message.getPayload();
            byte[] sendData = new byte[sentence.length];
            byte[] receiveData = new byte[1024];
            sendData = sentence;
            DatagramPacket sendPacket = new DatagramPacket(sendData, sendData.length, IPAddress, port);
            DatagramSocket clientSocket = new DatagramSocket();
            clientSocket.send(sendPacket);
            clientSocket.close();
        } catch (Exception ex) {
            throw new RuntimeException("KO");
        }
    } 
```

这在我的个人计算机上运行良好，但是当我在 Amazon AWS 上部署此代码时它不起作用。我发现即使程序正在侦听 UDP 9000 端口，但在服务器端没有收到通信。尽管我已允许该 AWS 实例的所有 UDP 端口，但这可能是 AWS 设置的问题。

有关如何在 Amazon AWS 上进行这项工作的任何提示？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:59:11.107

近两年前我开了一个新功能JIRA

[https://jira.springsource.org/browse/INT-1809](https://jira.springsource.org/browse/INT-1809)

但它没有收到投票或观察者，所以我关闭了它。

随意添加评论，我们可以重新打开它。

发件人的 ip 在邮件头中，但不是他的端口...

```
 message = MessageBuilder.withPayload(payload)
                    .setHeader(IpHeaders.HOSTNAME, hostName)
                    .setHeader(IpHeaders.IP_ADDRESS, hostAddress)
                    .build(); 
```

如果您想为此打开一个新的 JIRA，只需进行很小的更改即可进入 2.2。即将发布的版本（但网关不会制作 2.2）。

[https://jira.springsource.org/browse/INT](https://jira.springsource.org/browse/INT)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-27T17:54:45.583

谢谢你，加里！

我注意到远程 IP 地址在标头中，但远程端口不在，所以我做了一些更改来添加它。

我扩展了 UnicastReceivingChannelAdapter 以覆盖构造 Message 的 asyncSendMessage。我也必须扩展 DatagramPacketMessageMapper。如果我可以在 UnicastReceivingChannelAdapter 中注入我自己的 DatagramPacketMessageMapper 实现，那会更容易，但这是不可能的。

然后在弹簧配置中，我删除了

```
<ip:udp-inbound-channel-adapter id="ChannelReceiver"...> 
```

定义并添加以下

```
<bean id="udpInboundChannelAdapterBean" 
          class="me.spring.integration.udp.UnicastReceivingChannelAdapterExt" init-method="run">
          <constructor-arg name="port" value="5555" />
          <property name="poolSize" value="10"/>
          <property name="lookupHost" value="false"/>
          <property name="outputChannel" ref="ChannelIn" /> 
```

这似乎可行，尽管我还没有时间对其进行全面测试。

我的想法是使用远程 IP 和端口以及来自 udpInboundChannelAdapterBean 的 DatagramSocket 引用来创建一个新的激活服务，它只会将响应写入套接字。

我将按照您的建议为远程端口打开一个新的 jira。

# java - 正常程序逻辑和异常

> ID：12623400
> 
> 赞同：1
> 
> 时间：2012-09-27T14:11:49.833
> 
> 标签：java, exception

我正在审查一些团队代码，我发现了这样的东西：

```
MyObj obj = null;

try {
  obj = myService.findObj(objId)
} catch (MyObjNotFoundException e) {
  // The object wasn't found, it's the "normal" path
  // Here they create the object in DB (but don't touch the obj variable)
  // There is about 60 line of code
}
if (obj != null) {
  // The object already exist, logs are written and some queue is filled
  // with current objId to be processed later on
} 
```

在我的评论中，我会写到，`Exception`就性能或可维护性而言，使用来控制正常的程序流程并不是一个好主意。最好的办法是修改服务以返回`null`而不是抛出异常但是：

*   我不确定他们是否拥有该服务（可能是另一个项目/团队）
*   他们可能真的在其他地方需要这个例外

所以除了除非不抛出异常否则无法解决的性能问题，我想给他们一个“更干净”的代码。

这是我知道服务仅发送此异常的想法：

```
try {
  obj = myService.findObj(objId)
} finally {
}

if (obj == null) {
  // The object wasn't found, it's the "normal" path
} else {
  // The object already exist, logs are written and some queue is filled
  // with current objId to be processed later on
} 
```

你会走这条路吗？它真的在可读性上迈出了一步吗？你会想点别的吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:20:26.040

在您的建议中，如果服务抛出 ObjectNotFoundException，您的方法也会抛出。在不更改服务签名的情况下，代码当前所做的是唯一的方法。

或者你的意思是

```
try {
    obj = myService.findObj(objId)
} 
catch (ObjectNotFoundException) {
    // ignore, obj stays null
}

if (obj == null) {
    // The object wasn't found, it's the "normal" path
} 
else {
    // The object already exist, logs are written and some queue is filled
    // with current objId to be processed later on
} 
```

这与当前的代码非常相似。无论如何，恕我直言，为了使代码更干净，应该做的是将正常路径的 60 行代码提取到另一个方法中，该方法本身分为几个子方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:20:02.217

就个人而言，我认为您的更改根本不会产生任何重大影响。也许对 Java 字节优化有更好了解的人可以加入，但我希望仍然内置异常处理的额外“权重”，即使异常块中没有任何内容。

避免使用异常处理作为流控制的最大原因之一是抛出异常的代价。编译器不是为优化异常处理而设计的；他们希望它们仅在特殊情况下被抛出（请原谅双关语） - 即：当应用程序遇到意外情况时。因此，所有重点都放在优化标准流控制逻辑（if/else、for、while 等）上。从可读性和性能的角度来看，使用异常进行流控制是一个糟糕的主意。

找不到对象并不是意外情况。事实上，它是逻辑/流程图的一部分，应该在开发代码之前设计，并根据预期结果记录正确的返回值。数据库响应失败将是可接受的异常条件——这种情况很少发生，而且确实是一种意外状态。

从本质上讲，在我看来，您提出的更改会使阅读变得更加复杂。问题的核心是抛出的异常。如果这无法补救，我不相信你的空尝试/捕获真的有很大帮助。如果有的话，您的代码首先说您打算忽略所有未找到的异常，但后来您选择处理它，这有点矛盾。如果从中获得性能提升，我会理解，但就像我说的，我相信最昂贵的部分是抛出异常，而不是真正捕获它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T14:21:05.630

`Exception`当逻辑经常做一些不希望出现在运行良好的系统中的事情时，这是非常适合的。例如，每个`Person`对象必须有一个`firstname`. 一个不包含一个名字的人是一个例外的事情，必须使用`Exception`.

相反，用于`null`表示情况“正常”但不涉及重大结果。为了保持同样的例子，一个人可能有两个名字，但它实际上是可选的。在这种情况下，一个名为的概念方法`retrieveSecondFirstName()`将有效地返回。`null`

我更喜欢`Null Pattern`在适应时使用。看看[http://en.wikipedia.org/wiki/Null_Object_pattern](http://en.wikipedia.org/wiki/Null_Object_pattern)

此外，投掷`Exception`或使用避免了客户端`Null Pattern`的典型情况。`NullPointerExcetion`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T14:14:58.280

我喜欢使用异常而不是返回 null，因为您可以将发生错误的原因传递给用户。从我的角度来看，这比仅仅返回 null 要好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T14:18:08.253

没有正确或错误的方法可以做到这一点。我只能告诉您，*[`ObjectNotFoundException`](http://docs.oracle.com/javaee/1.3/api/javax/ejb/ObjectNotFoundException.html)-模式*从 J2EE 和 EJB 2.0 的早期就已经存在。[`FinderException`](http://docs.oracle.com/javaee/1.3/api/javax/ejb/FinderException.html)当一个典型的业务逻辑涉及捕获大约 17 亿个烦人的检查异常只是为了将它们中的大部分包装起来`RuntimeExceptions`以便能够将它们重新抛出到 Nirvana 中时，抛出该子类是很常见的。

如今，返回`null`可能会再次变得更流行，因为无论如何找不到对象并不是这样的例外，并且`null`恰好具有这种语义。除此之外，`null`并不比`ObjectNotFoundException`. 只是口味问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T14:31:28.513

没有明确的答案，这取决于 findObj() 的预期工作方式。在大多数情况下它会返回一个对象吗？如果找不到对象，是不是异常情况，是不是出乎意料？我认为在这种情况下不会，我会在这里返回 null 。基于异常的版本更难阅读和维护。

# ruby-on-rails - 将值读入数组

> ID：12623403
> 
> 赞同：1
> 
> 时间：2012-09-27T14:11:52.163
> 
> 标签：ruby-on-rails, ruby, arrays, ruby-on-rails-3, csv

我正在尝试以最简单的方式将一些值读入 .each 代码块中的数组，但我遇到了问题。我正在通过我构建的 rake 文件导入 csv 文件，该文件将使用新行更新表，从而创建新的 id。我正在尝试获取创建的每个 id 并将它们保存到一个数组中。而且我希望能够在另一个 rake 任务中访问存储在该数组中的值。

以下代码用于将导入 csv 文件的 rake 文件，并且我希望在数组中捕获其新生成的 id。它目前做了它应该做的事情，但你一次只能导入一个新行。

Import_incidents_csv.rake

```
require 'csv'

namespace :import_incidents_csv do

task :create_incidents => :environment do
    puts "Import Incidents"

    csv_text = File.read('c:/rails/thumb/costrecovery_csv/lib/csv_import/incidents.csv')
    csv = CSV.parse(csv_text, :headers => true)
    csv.each do |row|
        row = row.to_hash.with_indifferent_access
        Incident.create!(row.to_hash.symbolize_keys)
    end

    @last_incident_id = Incident.last.id

    end
  end 
```

这是另一个 rake 文件，它导入另一个 csv 文件，我需要将值存储在分配给的数组中。再说一次，如果你只导入一个新行，目前它工作得很好，但是如果你导入多行，那么一切都会变得有点混乱。

Import_timesheets_csv.rake

```
require 'csv'

namespace :import_timesheets_csv do

 task :create_timesheets => :environment do
    puts "Import Timesheets"

    csv_text = File.read('c:/rails/thumb/costrecovery_csv/lib/csv_import/timesheets.csv')
    csv = CSV.parse(csv_text, :headers => true)
    csv.each do |row|
        row = row.to_hash.with_indifferent_access
        Timesheet.create!(row.to_hash.symbolize_keys)
    end

    timesheet = Timesheet.last
    timesheet.incident_id = @last_incident_id
    timesheet.save

    @last_timesheet_id = Timesheet.last.id

     end
end 
```

我读了这个处理数组的资源[http://www.tutorialspoint.com/ruby/ruby_arrays.htm](http://www.tutorialspoint.com/ruby/ruby_arrays.htm)，它看起来很混乱。这是我对 Import_incidents_csv.rake 文件在将值读入数组时的最佳猜测。最后我有puts，所以我可以验证整数是否正确存储在数组中。一旦我让一切正常，我会删除它。

```
require 'csv'

def inc_id
@inc_id = Incident.last.id
end

namespace :import_incidents_csv do

 task :create_incidents => :environment do
    puts "Import Incidents"

    csv_text = File.read('c:/rails/thumb/costrecovery_csv/lib/csv_import/incidents.csv')
    csv = CSV.parse(csv_text, :headers => true)
    csv.each do |row|
        row = row.to_hash.with_indifferent_access
        Incident.create!(row.to_hash.symbolize_keys)
        Incident.last.id = @inc_id
        id_array = Array.new(@inc_id)
    end

    puts "#{id_array}"

      end
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:26:27.637

我不确定您要在这里做什么，您的问题还不清楚，但可能是您正在尝试将`id`插入记录的值收集到数组中：

```
id_array = [ ]

csv.each do |row|
  incident = Incident.create!(row.to_hash.symbolize_keys)
  id_array << incident.id
end 
```

完成后，`id_array`将在其中包含所有创建的记录`id`值。请注意，如果这些`create!`调用中的任何一个失败，您将得到一个`ActiveRecord::RecordInvalid`异常，您需要以某种方式抢救和处理。`Indcident.transaction do ... end`因此，假设您的数据库支持事务，将整个操作包装在其中以确保在失败时可以回滚整个操作是有意义的。如果你不关心失败，你可以调用`create`它不会抛出异常。

您的示例中有很多冗余，已被省略。`Array.new`几乎不需要调用，因为就像 JavaScript 一样，您可以声明一个新数组，`[ ]`其中可以是空的，也可以预先填充类似`[ 1 ]`or的东西`[ 1, 2 ]`。

# c# - 可以知道 asp.net mvc 3 中的 OutputCache 大小吗？

> ID：12623405
> 
> 赞同：2
> 
> 时间：2012-09-27T14:11:52.797
> 
> 标签：c#, asp.net-mvc-3, outputcache

我读了这篇文章：[如何在 ChildAction 上删除 OutputCache？](https://stackoverflow.com/questions/5126751/how-to-remove-outputcache-on-childaction)和[MSDN](http://msdn.microsoft.com/en-us/library/system.web.mvc.outputcacheattribute%28v=vs.108%29.aspx)。

我`OutputCache`在一些包含大量数据的操作上应用了属性。我想知道内存中占用了多少（大小）。

你能告诉我如何在**C# 代码**中查看大小吗？

因为在 MSDN 上他们没有提到缓存大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:16:55.273

您可以为此使用**“内存分析器”**。

```
.NET Memory Profiler
 ANTS Performace Profiler 
```

# build - Teamcity：使用 TFS 中的标记版本获取源代码

> ID：12623406
> 
> 赞同：2
> 
> 时间：2012-09-27T14:11:52.690
> 
> 标签：build, tfs, continuous-integration, teamcity

如何配置 TeamCity 以从 TFS 的标记版本中获取更改？

在团队城市

```
Administration
    Edit Build Configuration
        Edit VCS Root 
```

这在当前版本（v7）中可能吗？我找不到那个选项。

干杯

# c - 来自文件 C 的字符串

> ID：12623408
> 
> 赞同：2
> 
> 时间：2012-09-27T14:12:03.380
> 
> 标签：c, string

我正在从文件中读取一个字符串，然后尝试在字符串中添加零直到它达到 100，然后我正在打印字符串，但我不知道出了什么问题，我尝试了不止一种方法，但它们似乎都不起作用。

```
int main(int argc, char *argv[])
{
    if (argc != 2 ){
        fprintf(stderr, "usage: server filename \n");
        exit(1);
    }
    FILE *file = fopen(argv[1], "r");
    if (file==0)
    {
        printf("file couldn't be opened\n");
        exit(1);
    } 
    int i;
    char str1[100];
    //char str2[100];
    //memset(str2,0,sizeof(str2));
     //for(i = 0; i < 100; i++)
         // fprintf(stdout, "str2[%u]: %u\n",i,str2[i]);

    while (fscanf(file, "%s", str1) != EOF) 
    {
        for(i=13 ; i < 100; i++)
            str1[i]=0;

    }

         for(i = 0; i < 100; i++)
         fprintf(stdout, "str1[%u]: %u\n",i,str1[i]);

    return 0;
} 
```

但我打印出来了

```
str1[0]: 119
str1[1]: 111
str1[2]: 114
str1[3]: 108
str1[4]: 100
str1[5]: 0
str1[6]: 0
str1[7]: 0
up till 99 
```

尽管文件“hello”中有一个字符串，但我不明白这一点，然后我试过了

```
int main(int argc, char *argv[])
{
    if (argc != 2 ){
        fprintf(stderr, "usage: server filename \n");
        exit(1);
    }
    FILE *file = fopen(argv[1], "r");
    if (file==0)
    {
        printf("file couldn't be opened\n");
        exit(1);
    } 
    int i;
    char str1[12];
    char str2[100];
    memset(str2,0,sizeof(str2));
     //for(i = 0; i < 100; i++)
         // fprintf(stdout, "str2[%u]: %u\n",i,str2[i]);

    while (fscanf(file, "%s", str1) != EOF) 
    {

     strcpy(str2,str1);

    }

         for(i = 0; i < 100; i++)
         fprintf(stdout, "str2[%u]: %u\n",i,str2[i]);

    return 0;
} 
```

我给了我与第一个完全相同的结果，所以我不明白这里发生了什么，以及为什么我会得到这些结果。如果您能解释我在这里做错了什么，我将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:15:42.793

在最后一个代码片段中，您不应该这样做：

```
memset(str2,0,sizeof(str2)); 
```

但反而：

```
memset(str2,0,sizeof(char) * 100); 
```

检查 sizeof 上的链接：[http ://en.wikibooks.org/wiki/C_Programming/Pointers_and_arrays#sizeof](http://en.wikibooks.org/wiki/C_Programming/Pointers_and_arrays#sizeof)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:16:55.447

这里有很多错误的东西。

对我来说最明显的一个是您将每个字符打印为`%u`，即`unsigned int`. 您应该将每个字符打印为`char`，即`%c`。

*其次，正如fableal*所指出的，你`memset()`也是错的。使用`sizeof(str2)`表示 的大小`str2`，它是一个指针，在 32 位架构中，它将是 32 位。这显然不是你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T14:17:40.793

您看不到字符的原因是 printf 正在打印整数。将其更改为`%c`：

```
fprintf(stdout, "str2[%u]: %c\n",i,str2[i]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T14:26:22.397

如果我理解正确，您的目标是拥有一个字符数组，其中包含文件中的单行，除此之外还有 0。例如：

文件：

```
hello 
```

数组结果：

```
[h][e][l][l][o][0][0][0]... 
```

因此，最简单的方法是先将数组初始化为 0，然后读出该行：

```
char str1[100] = {'0'};
fgets(str1, 100, file); 
```

要打印它们，您可以像字符串一样打印它：

```
printf("%s\n", str1); 
```

但请记住，您将整个内容设置为 0（空终止符），因此您只会看到“hello”。如果您像以前一样使用小数打印：

```
for(i=0; i<100; i++)
  printf("%d ", str1[i]); 
```

你会在 ASCII 中看到 hello，后跟 0

```
104 101 108 108 111 10 0 0 0 0 0 0 0 0 0... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T14:17:43.320

这个：

```
memset(str2,0,sizeof(str2)); 
```

不需要，因为这样：

```
while (fscanf(file, "%s", str1) != EOF) 
{
 strcpy(str2,str1);
} 
```

覆盖`str2`每次`str1`迭代。这意味着前一个字符串被丢弃。您的意思可能是`strcat()`，在这种情况下，您应该在循环之前使用 str2[0] = '\0';`。

# android - 如何使用 android.util.log 将日志存储在 txt 文件中

> ID：12623415
> 
> 赞同：10
> 
> 时间：2012-09-27T14:12:16.993
> 
> 标签：android, file, logging

我知道这个话题已经谈了很多，但不是这个意思。我需要将日志存储在 .txt 文件中，但我不能使用 log4j 或任何其他类，但 android.util.log 我有这个解决方案，但它不是最好的。对于具有与以下相同的信息：Log.i(TAG, "An INFO Message"); 我得写...

```
ERROR = logLevel < 3;
WARNING = logLevel < 2;
INFO = logLevel < 1;
if (INFO){ 

    appendLog("LEVEL: I    TIME: "+java.util.GregorianCalendar.DAY_OF_MONTH +
                        "-"+ java.util.GregorianCalendar.MONTH +" "+GregorianCalendar.HOUR_OF_DAY +":"+GregorianCalendar.MINUTE +
                        ":"+GregorianCalendar.SECOND +"."+GregorianCalendar.MILLISECOND + "    PID: "+
                        android.os.Process.myPid()+ "    TID: "+android.os.Process.myTid()+ "    Application: com.example.myapplication"+
                        "    TAG:" +TAG+ "    TEXT: An INFO Message");
} 
```

接着...

```
public void appendLog(String text) {        
    File logFile = new File("sdcard/log.txt"); 
    if (!logFile.exists()) { 
        try { 
            logFile.createNewFile(); 
        }catch (IOException e){ 
            e.printStackTrace(); 
      } 
   } 
   try { 
       BufferedWriter buf = new BufferedWriter(new FileWriter(logFile, true));  
       buf.append(text); 
       buf.newLine(); 
       buf.close(); 
   } catch (IOException e) { 
       e.printStackTrace(); 
   } 
} 
```

有没有人有比这更优雅的解决方案？感谢你们对我的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-10-18T08:13:18.393

**在这里，我附上了简单的 Logger 类定义，您可以使用它。要将日志信息存储到 SDCARD 中的 Log.txt 文件中，请使用 at it** is。

```
package com.clientname.projectname;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.util.logging.FileHandler;

import android.os.Environment;
import android.util.Log;

/**
 * @author Rakesh.Jha
 * Date - 07/10/2013
 * Definition - Logger file use to keep Log info to external SD with the simple method
*/

public class Logger {

    public static  FileHandler logger = null;
    private static String filename = "ProjectName_Log";

    static boolean isExternalStorageAvailable = false;
    static boolean isExternalStorageWriteable = false; 
    static String state = Environment.getExternalStorageState();

    public static void addRecordToLog(String message) {

        if (Environment.MEDIA_MOUNTED.equals(state)) { 
            // We can read and write the media 
            isExternalStorageAvailable = isExternalStorageWriteable = true; 
        } else if (Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) { 
            // We can only read the media 
            isExternalStorageAvailable = true; 
            isExternalStorageWriteable = false; 
        } else { 
            // Something else is wrong. It may be one of many other states, but all we need 
            //  to know is we can neither read nor write 
            isExternalStorageAvailable = isExternalStorageWriteable = false; 
        }

        File dir = new File("/sdcard/Files/Project_Name");      
        if (Environment.MEDIA_MOUNTED.equals(state)) {  
            if(!dir.exists()) {
                Log.d("Dir created ", "Dir created ");
                dir.mkdirs();
            }

            File logFile = new File("/sdcard/Files/Project_Name/"+filename+".txt");

            if (!logFile.exists())  {
                try  {
                    Log.d("File created ", "File created ");
                    logFile.createNewFile();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
            try { 
                //BufferedWriter for performance, true to set append to file flag
                BufferedWriter buf = new BufferedWriter(new FileWriter(logFile, true)); 

                buf.write(message + "\r\n");
                //buf.append(message);
                buf.newLine();
                buf.flush();
                buf.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }
} 
```

**现在，一旦您创建了此文件，您想将日志信息存储到 log.txt 文件中的任何位置，请使用以下代码。**-

```
package com.clientname.projectname;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.util.Log;

/**

 * @author Rakesh.Jha
 * Date - 03/10/2013
 * Definition -  //ToDO

*/

public class MainActivity extends Activity {

    private static final String TAG = null;
    Logger logger;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.d("Testing     :","log"); // no need to do this line, use below line
        logger.addRecordToLog("Testing     : log " );

        logger.addRecordToLog("TAG MediaPlayer audio session ID: " );

        MediaPlayer mediaPlayer = MediaPlayer.create(MainActivity.this, R.raw.test);//test is audio file, u have to keep in raw folder

        logger.addRecordToLog( "MediaPlayer audio session ID: " + mediaPlayer.getAudioSessionId()); 
        logger.addRecordToLog( "Media Player started " + "Started !");

        mediaPlayer.start(); // no need to call prepare(); create() does that for you
    }

    private void prepareMediaServer() { }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T14:26:20.843

创建一个包装器类来包装 Android 的`Log`类。这个包装类将`Log`通过另外将文本记录到文件中来扩展类的功能。

例子：

```
public class MyLog{
    public static void i(String TAG, String message){

        // Printing the message to LogCat console
        Log.i(TAG, message);

        // Write the log message to the file
        appendLog(message);
    }

    public static void d(String TAG, String message){
        Log.d(TAG, message);
        appendLog(message);
    }

    // rest of log methods...
} 
```

然后你应该像这样使用它：

```
MyLog.i("LEVEL 1", "Your log message here..."); 
```

# c# - 当启动的窗口关闭时，如何在 Silverlight 中刷新网格？

> ID：12623421
> 
> 赞同：0
> 
> 时间：2012-09-27T14:12:51.927
> 
> 标签：c#, silverlight, mvvm, telerik-grid, silverlight-5.0

我正在`HtmlPage.Window.Navigate(Uri, "_blank");`使用上下文菜单从网格行启动一个窗口，以进行特定于该行引用的页面的一些自定义编辑。我在银光中使用 Telerik-grid。当用户关闭该窗口时，我想刷新网格。我怎样才能做到这一点？

请分享一些想法，这可能吗？或者在哪里寻找开始解决这个问题？

**更新**：我正在使用 Silver-light **MVVM**模型。我从 silver-light 打开的子窗口是 web 浏览器，我实际上需要一种技术，当我关闭 web 浏览器时，我可以在 silver-light 应用程序中使用网格来刷新。此外，我正在使用**RIA 服务**来公开 Web 浏览器的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T04:29:00.227

在您的 Silverlight 应用程序中公开一个可从 Javascript 访问的方法。

```
namespace SilverlightApplication
{
    public partial class Page : UserControl
    {
        public Page()
        {
            InitializeComponent();

            HtmlPage.RegisterScriptableObject("Page", this);            
        }

        [ScriptableMember]
        public void UpdateDataGrid()
        {
            myDataGridItemsReload(); // your routine
        }
    }
} 
```

然后在新打开的窗口中，可以在 Silverlight 实例上执行一个方法

```
<script>
    window.onunload = refreshParentGrid;
    function refreshParentGrid() {
        var hostDiv = window.opener.document.getElementById("silverlightControlHost");
        var control = hostDiv.children[0];           
        control.Content.Page.UpdateDataGrid();
    }
</script> 
```

# asp.net-mvc-3 - Telerik MVC 导出到 excel

> ID：12623425
> 
> 赞同：1
> 
> 时间：2012-09-27T14:13:10.833
> 
> 标签：asp.net-mvc-3, export, telerik-grid

我在 MVC3 项目中使用 Telerik Grid。在此我必须使用导出功能。为了导出数据，我需要将所有当前可用的项目导出为 excel 格式。

我完成了导出。但我需要导出网格中当前可用的所有数据。意思是在过滤的时候不仅是当前页面的数据，还应该导出所有过滤后的数据。

我做了这样的事情：但它不只导出过滤后的数据，而是导出网格中的所有数据。

**查看代码**

```
@(Html.Telerik().Grid(Model)
    .Name("Grid")
            .ToolBar(commands => commands
                .Custom()
                    .HtmlAttributes(new { id = "export" })
                    .Text("Export to Excel")
                    .Action("ExportExcel", "Grid",
                            new { page = 1, orderBy = "~", filter = "~" }))

        .DataKeys(keys =>
        {
            keys.Add(Id => Id.Itemid);
        }) 
```

**我的控制器中的操作方法**

```
public ActionResult ExportExcel(int page, string orderBy, string filter)
    {
        IEnumerable orders = GetItems()
                             .AsQueryable()
                             .ToGridModel(page, int.MaxValue, orderBy,
                                          string.Empty, filter).Data; 
```

有什么办法可以解决这个问题。请为此提供帮助。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T07:10:32.890

以下示例显示如何仅导出相关数据：[http ://demos.telerik.com/aspnet-mvc/grid/customcommand](http://demos.telerik.com/aspnet-mvc/grid/customcommand)

还有一个代码库项目展示了如何将网格数据导出到 Excel：[http ://www.telerik.com/support/kb/aspnet-mvc/grid/export-to-excel.aspx](http://www.telerik.com/support/kb/aspnet-mvc/grid/export-to-excel.aspx)

# ios - MonoTouch 和 CFStream API 的问题

> ID：12623429
> 
> 赞同：2
> 
> 时间：2012-09-27T14:13:30.470
> 
> 标签：ios, xamarin.ios, ios-simulator, cfstream, cfsocket

我目前正在开发一个需要通过套接字连接与 MQTT 服务器通信的应用程序。由于 System.Net.Sockets API 在从 WiFi 网络切换到 3G 网络时往往会出现异常行为（实际上这种情况经常发生），我决定尝试使用 CFStream API。在这样做的过程中，我遇到了几个问题，如下所示。

`CreatePairWithSocketToHost`只要我在其中一个流上调用 Open()，创建一对流就会使应用程序崩溃。

```
CFStream.CreatePairWithSocketToHost(GetEndPoint(), out mReadStream, out mWriteStream);
mReadStream.EnableEvents(CFRunLoop.Current, CFRunLoop.CFDefaultRunLoopMode);
mWriteStream.EnableEvents(CFRunLoop.Current, CFRunLoop.CFDefaultRunLoopMode);
mReadStream.Open();
mWriteStream.Open(); 
```

无论我是否打电话，都会发生崩溃`EnableEvents()`。例外是：

```
[ERROR] FATAL UNHANDLED EXCEPTION: MonoTouch.CoreFoundation.CFException: The operation couldn’t be completed. Cannot allocate memory
  at MonoTouch.CoreFoundation.CFStream.CheckError () [0x0000f] in /Developer/MonoTouch/Source/monotouch/src/shared/CoreFoundation/CFStream.cs:236 
  at MonoTouch.CoreFoundation.CFStream.Open () [0x00040] in /Developer/MonoTouch/Source/monotouch/src/shared/CoreFoundation/CFStream.cs:248 
  at TestCfNework.RootViewController.TestCreatePairToHost () [0x00041] in /Users/adrian/Projects/TestCfNework/TestCfNework/RootViewController.cs:79 
  at TestCfNework.RootViewController.ViewDidLoad () [0x00000] in /Users/adrian/Projects/TestCfNework/TestCfNework/RootViewController.cs:24 
  at MonoTouch.UIKit.UIWindow.MakeKeyAndVisible () [0x00008] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIWindow.g.cs:124 
  at TestCfNework.AppDelegate.FinishedLaunching (MonoTouch.UIKit.UIApplication app, MonoTouch.Foundation.NSDictionary options) [0x0002e] in /Users/adrian/Projects/TestCfNework/TestCfNework/AppDelegate.cs:32 
  at MonoTouch.UIKit.UIApplication.Main (System.String[] args, System.String principalClassName, System.String delegateClassName) [0x0004c] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIApplication.cs:38 
  at TestCfNework.Application.Main (System.String[] args) [0x00000] in /Users/adrian/Projects/TestCfNework/TestCfNework/Main.cs:17 
```

`CreatePairWithSocket`通过首先创建和连接 a来创建一对流`CFSocket`允许`Open()`继续进行而不会崩溃，但`CanAcceptBytesEvent`永远不会被触发，`CanAcceptBytes()`始终是错误的，并且任何写入尝试都会因超时而失败。

```
mSocket = new CFSocket(AddressFamily.InterNetwork, 
    SocketType.Stream, 
    ProtocolType.Tcp, 
    CFRunLoop.Current);
mSocket.ConnectEvent += delegate {
    Console.WriteLine("Socket connected");

    CFStream.CreatePairWithSocket(mSocket, out mReadStream, out mWriteStream);
    mReadStream.EnableEvents(CFRunLoop.Current, CFRunLoop.CFDefaultRunLoopMode);
    mWriteStream.EnableEvents(CFRunLoop.Current, CFRunLoop.CFDefaultRunLoopMode);

    mReadStream.Open();
    mWriteStream.Open();

    mWriteStream.CanAcceptBytesEvent += delegate {
        Console.WriteLine("Write stream can now accept data");
    };
    mWriteStream.ErrorEvent += delegate {
        Console.WriteLine(mWriteStream.GetError());
    };
};
mSocket.Connect(GetEndPoint(), 0); 
```

使用创建一对流`CreatePairWithPeerSocketSignature`是唯一实际产生一对我可以使用的流：打开不会崩溃，我可以分别写入和读取。

API 在模拟器和实际设备上都以这种方式运行。那么，这是我做错了吗？是 MonoTouch 的问题吗？它是 CFStream API 本身的错误吗？

MonoTouch 版本：6.0.1。XCode 版本：4.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T08:07:59.513

我在 MonoMac / MonoTouch 中编写了大部分 CFNetwork 代码，所以我希望能够帮助你:-)

你的代码对我来说看起来不错。它适用于 MonoMac（Mac 上的独立 Cocoa 应用程序），但我发现 MonoTouch 存在同样的问题。打开读取流有时有效，有时无效，打开写入流总是失败。

`CFStream.CreatePairWithSocketToHost()`来电`CFStreamCreatePairWithSocketToCFHost()`。

添加新的重载版本后：

```
 public static void CreatePairWithSocketToHost (string host, int port,
                                                   out CFReadStream readStream,
                                                   out CFWriteStream writeStream) 
```

调用`CFStreamCreatePairWithSocketToHost()`，这现在工作正常。

我刚刚看了看，发现了问题，很快就会解决。

关于您的第二个问题，CFSocket API 在内部访问了相同的代码路径，因此它也受到此错误的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T20:44:44.827

要唤醒 3G 网络，您要使用：

[http://iosapi.xamarin.com/?link=T%3aMonoTouch.ObjCRuntime.Runtime%2fM%2fStartWWAN](http://iosapi.xamarin.com/?link=T%3aMonoTouch.ObjCRuntime.Runtime%2fM%2fStartWWAN)

# ruby-on-rails-3 - 存储后台作业的用户特定密码

> ID：12623430
> 
> 赞同：1
> 
> 时间：2012-09-27T14:13:36.993
> 
> 标签：ruby-on-rails-3

我正在开发一个应用程序，它应该从用户的电子邮件帐户中导入所有电子邮件并将它们存储在自己的数据库中以供进一步使用。所有电子邮件的收集应在后台作业中完成（通过延迟作业或类似的）。

为此，我需要将用户的电子邮件密码存储在我的应用程序中的某个位置。因为这将是一个内部应用程序，信任我的应用程序不会是问题。

我正在寻找关于如何以及在何处尽可能安全地存储这些电子邮件密码的最佳实践。

使用用户的登录密码加密电子邮件密码到我的应用程序不是一种选择，因为我必须在后台运行该作业。

对此有何建议？提前致谢。

环境：带有 MongoDB 的 Rails 3.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T08:04:00.990

我通过使用[attr_encrypted](https://github.com/shuber/attr_encrypted) Gem 解决了这个问题。`encoding: true`使用 MongoId 时请务必使用该选项。

作为加密的密钥，我使用我的应用程序的秘密令牌。我认为这对我的目的来说已经足够安全了。

感谢这个答案：[https ://stackoverflow.com/a/6686132/1437361](https://stackoverflow.com/a/6686132/1437361)

# tcl - Tk Tablelist，如何使用鼠标左键禁用交互式编辑

> ID：12623432
> 
> 赞同：0
> 
> 时间：2012-09-27T14:13:46.790
> 
> 标签：tcl, tk

默认情况下，当我用鼠标左键单击可编辑单元格时，Tk tablelist 开始编辑。我希望单元格是可编辑的，但我想以其他方式编辑它，而不是按鼠标左键。我想使用鼠标左键单击其他内容。当我单击鼠标左键时，如何使表格列表不开始交互式单元格编辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:41:28.410

我找到了。我`return -code break`在鼠标左键单击处理程序中使用过。你可以在这里阅读[http://www.tcl.tk/man/tcl/TclCmd/return.htm](http://www.tcl.tk/man/tcl/TclCmd/return.htm)。

# vb.net - 使用 vb.net 比较两个不同数据表中的两个数据集

> ID：12623436
> 
> 赞同：0
> 
> 时间：2012-09-27T14:13:53.573
> 
> 标签：vb.net, vb.net-2010

请告诉我如何比较两个不同数据集中的两个数据表。我有一个数据表在一个数据集中有 5 列，另一个数据表在另一个数据集中有 2 列。两个数据表中的第 1 列应该相同。我必须比较不同数据集中两个数据表中的第一列。如果两行相同，则应在数据表 2 的第三列中保留一个表示是或否的标志。它还应将数据集 1 中的数据表 1 中的其他列 2、3、4 和 5 合并到数据表 2 中数据集2。

我正在从具有多个工作表的 excel 工作簿中导入值的两个数据表。所以一个工作表到一个数据表。同样有两个工作簿。

第一个数据集中的第一个数据表就像

ABCDE

1 2 3 4 5

2 3 4 5 6

3 4 5 6 7

第二个数据集中的第二个数据表就像

自动对焦

1 2

2 3

3 4

第二个数据集中的输出数据表 2 应该像

ABCDEFG

1 2 3 4 5 2 是

2 3 4 5 6 3 是

3 4 5 6 7 4 是

请建议我如何进行，我正在尝试学习 vb.net

提前致谢

吉廷

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:22:07.300

你可以

*   在两个数据表上[定义一个主键](http://msdn.microsoft.com/en-us/library/z24kefs8%28v=vs.80%29.aspx)
*   创建一个包含所有列的新数据表
*   遍历 DataTable 1 中的所有行并使用 pk 查找 DataTable 2 中的“匹配”行
*   在新的 DataTable 中为每个结果插入一行

然后，如果您还希望新 DataTable 中的这些行，您将需要一些额外的逻辑来查找仅存在于 DataTable 1 或 2 中的所有那些行。

您是否考虑过更改填充两个数据表的方式？如果这是 2 个查询的结果，也许您可​​以在 SQL 中使用 join 语句？

# vim - vim-addons 仅显示 4 个插件

> ID：12623444
> 
> 赞同：0
> 
> 时间：2012-09-27T14:14:13.060
> 
> 标签：vim, vim-plugin

我想还有更多的插件！这很奇怪，不是吗？我使用 Ubuntu 12.04。如何增加显示的插件数量？对于我使用的最后一个配置，有更多可能的插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:29:28.753

这意味着更少的“插件”被移植到最新版本的[vim-addon-manager](https://launchpad.net/ubuntu/+source/vim-addon-manager/0.4.4)。如果您想知道*原因*，您必须询问维护者或[发布问题](https://bugs.launchpad.net/ubuntu/+source/vim-addon-manager)。

如果您需要此软件包中没有的特定“插件”，您只需手动安装即可。

这是一个 Ubuntu 问题，而不是编程或 Vim 问题。您应该在 AskUbuntu 上询问 agin。

# jsf - 如何更改的值 动态地基于 ?

> ID：12623452
> 
> 赞同：1
> 
> 时间：2012-09-27T14:14:29.833
> 
> 标签：jsf, primefaces

我有 3 个不同类型的数据列表，我想`<p:dataTable>`根据`<p:selectOneButton>`按下的情况将它们单独显示，如下所示：

*   如果用户点击“按钮 1”，我想显示`list1`在`<p:dataTable>`
*   如果用户点击“按钮 2”，我想显示`list2`在`<p:dataTable>`

这是视图：

```
<p:selectOneButton value="#{managedBean.perspective}">
    <f:selectItem itemLabel="Button 1" itemValue="1" />
    <f:selectItem itemLabel="Button 2" itemValue="2" />
    <f:selectItem itemLabel="Button 3" itemValue="3" />
    <f:ajax event="change" render="table" />
</p:selectOneButton>

<p:dataTable id="table" value="#{managedBean.list}" var="object">
    <p:column headerText="title">
        ...
    </p:column>
</p:dataTable> 
```

这是模型：

```
private List<Object1> list1 = new ArrayList<Object1>();
private List<Object2> list2 = new ArrayList<Object2>();
private List<Object3> list3 = new ArrayList<Object3>(); 
```

如何将相同的对象重复`<p:dataTable>`用于不同的对象列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T11:35:50.603

您需要有一个对象属性的集合，以便您可以使用它[`<p:columns>`](http://www.primefaces.org/showcase/ui/datatableDynamicColumns.jsf)来动态生成列。

例如

```
<p:selectOneButton value="#{bean.type}">
    <f:selectItem itemLabel="Button 1" itemValue="1" />
    <f:selectItem itemLabel="Button 2" itemValue="2" />
    <f:selectItem itemLabel="Button 3" itemValue="3" />
    <p:ajax listener="#{bean.change}" update="table" />
</p:selectOneButton>

<p:dataTable id="table" value="#{bean.list}" var="object">
    <p:columns value="#{bean.properties}" var="property">
        #{object[property]}
    </p:columns>
</p:dataTable> 
```

和

```
private static final List<String> OBJECT1_PROPERTIES = Arrays.asList("property1", "property2", "property3");
private static final List<String> OBJECT2_PROPERTIES = Arrays.asList("foo", "bar");
private static final List<String> OBJECT3_PROPERTIES = Arrays.asList("p1", "p2", "p3", "p4", "p5");

private List<Object1> list1 = new ArrayList<Object1>();
private List<Object2> list2 = new ArrayList<Object2>();
private List<Object3> list3 = new ArrayList<Object3>();

private String type;
private List<?> list;
private List<String> properties;

public void change() {
    if ("1".equals(type)) {
        list = list1;
        properties = OBJECT1_PROPERTIES;
    }
    // ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T09:52:20.420

添加 valueChangeListener 为`p:selectOneButton`：

监听器示例：

```
public void yourListener(ValueChangeEvent event) {
    String newValue = (String) event.getNewValue();

    if ("1".equals(newValue){
        list = list1;
    } else if ("2".equals(newValue){
        list = list2;
    }else if ("3".equals(newValue){
        list = list3;
    }
} 
```

并设置为`p:selectOneButton`：

```
 <f:ajax update="table" /> 
```

# iphone - 从 AVCaptureAudioDataOutputSampleBufferDelegate 播放音频

> ID：12623455
> 
> 赞同：9
> 
> 时间：2012-09-27T14:14:33.490
> 
> 标签：iphone, objective-c, ios, avfoundation

我正在使用 AVCaptureAudioDataOutputSampleBufferDelegate 捕获音频

```
 _captureSession = [[AVCaptureSession alloc] init];
  [self.captureSession setSessionPreset:AVCaptureSessionPresetLow];

  // Setup Audio input
  AVCaptureDevice *audioDevice = [AVCaptureDevice
                                defaultDeviceWithMediaType:AVMediaTypeAudio];
  AVCaptureDeviceInput *captureAudioInput = [AVCaptureDeviceInput deviceInputWithDevice:audioDevice error:&error];
  if(error){
      NSLog(@"Error Start capture Audio=%@", error);
  }else{
      if ([self.captureSession canAddInput:captureAudioInput]){
          [self.captureSession addInput:captureAudioInput];
      }
  }

  // Setup Audio output
  AVCaptureAudioDataOutput *audioCaptureOutput = [[AVCaptureAudioDataOutput alloc] init];
  if ([self.captureSession canAddOutput:audioCaptureOutput]){
      [self.captureSession addOutput:audioCaptureOutput];
  }
  [audioCaptureOutput release];

  //We create a serial queue 
  dispatch_queue_t audioQueue= dispatch_queue_create("audioQueue", NULL);
  [audioCaptureOutput setSampleBufferDelegate:self queue:audioQueue];
  dispatch_release(audioQueue);

  /*We start the capture*/
  [self.captureSession startRunning]; 
```

代表：

```
 - (void)captureOutput:(AVCaptureOutput *)captureOutput  didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection {

  // do something with sampleBuffer
  } 
```

问题是如何从 sampleBuffer 播放音频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:52:27.373

您可以使用以下代码创建`NSData`，`CMSampleBufferRef`然后使用 AVAudioPlayer 播放。

```
- (void)captureOutput:(AVCaptureOutput *)captureOutput  didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection {

    AudioBufferList audioBufferList;
    NSMutableData *data= [NSMutableData data];
    CMBlockBufferRef blockBuffer;
    CMSampleBufferGetAudioBufferListWithRetainedBlockBuffer(sampleBuffer, NULL, &audioBufferList, sizeof(audioBufferList), NULL, NULL, 0, &blockBuffer);

    for( int y=0; y< audioBufferList.mNumberBuffers; y++ ){

        AudioBuffer audioBuffer = audioBufferList.mBuffers[y];
        Float32 *frame = (Float32*)audioBuffer.mData;

        [data appendBytes:frame length:audioBuffer.mDataByteSize];

    }

    CFRelease(blockBuffer);

    AVAudioPlayer *player = [[AVAudioPlayer alloc] initWithData:data error:nil];
    [player play];
} 
```

不过，我担心这将如何提高性能。可能有更好的方法来做你想要完成的事情。

# php - sql 在 mysqli php sql 中选择顶部

> ID：12623457
> 
> 赞同：2
> 
> 时间：2012-09-27T14:14:37.757
> 
> 标签：php, select, mysqli

我在mysqli中有查询：

```
function getPicByAlbumt($query)
{
    $sqlStr = "SELECT TOP 10 * FROM tbl_albumpictures WHERE album_Id = ? ".$query;
    return $sqlStr;
} 
```

这是这个查询的过程：

```
<?php
        $sqlu = getPicByAlbumt("order by rating");
    if ($result2u = $mysqli->prepare($sqlu)) 
    {
        $rekzak = 76;
        $result2u->bind_param("i",$rekzak);
        $result2u->execute();   
        $result2u->store_result();
        $rows2u = $result2u->num_rows;      
    }
    if($rows2u>0)
    {
    $rowu = fetch($result2u);
    for($g=0; $g<$rows2u; $g++)
    {
    $picname = $rowu[$g]["pic_name"];
    ?>
            <div style="float:right; width:115px; height:96px; background:url(<?=$site_url?>/images/t/girlpicbg.png); margin-right:1px; margin-top:2px;">
            <img src="<?=$site_url?>/uploads/albums/<?=$picname?>" style="width:106px; height:88px; margin-top:3px; margin-right:6px;" />
            </div>
    <?php
    }
    }
    ?> 
```

,,,我的问题是 TOP 10 * 在 mysqli 中不起作用 :S .. 任何建议或帮助请 :S ?.. 换句话说：如果我有 20 张照片...按评级排序....我的意思是如果他的订单是 1，则最后一张照片可能是第一张……如果他的订单是 20，则第一张可能是最后一张……所以我想订购前 10 张 id，但是这 10 张是按评级订购的。 .我的意思是..如果我选择了前 10 张 id（照片）...并且第一张照片评分为 20...在这个组中（前 10 张按 id 排列的照片），我希望第一张照片排在最后。因为他的id是20，评分值最大

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:16:23.823

`SELECT TOP`用于 SQL-Server，而不是 MySQL。您正在寻找的是`LIMIT`：

```
SELECT * FROM tbl_albumpictures WHERE album_Id = ? LIMIT 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:16:17.177

你用`MySQL`对了吗？使用`LIMIT 10`代替`TOP 10`（*对于 MSSQL*）。

```
SELECT...
FROM...
WHERE...
ORDER BY...
LIMIT 10 
```

# java - 使用 Selenium 选择无效的 html 标记

> ID：12623461
> 
> 赞同：0
> 
> 时间：2012-09-27T14:14:51.250
> 
> 标签：java, selenium, selenium-webdriver

我正在尝试使用 Selenium 获取 WebElement：

```
driver.findElement(By.xpath("//input[@name='j_username']")) 
```

但是 Selenium 说：“无法使用 XPath 找到元素......”。XPath 是有效的，我用 FirePath 对其进行了验证。但输入元素有以下无效代码：

```
<input size="10" type="text" name="j_username" maxlength="8"> 
```

我无法更改 html 文件，尽管事实上是否有任何解决方案可以获取 webElement？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:58:30.103

尝试使用 css 选择器选择元素。并在firepath中验证（firebug插件该元素位置正确）。所以你的css选择器就像

```
input[name='j_username'] 
```

第二种方法是使用内部 firebug 机制来查找元素的 xPath。请参阅下面的屏幕 ![在此处输入图像描述](../Images/2b249b70f4e4041dbb48fa5f8b680f70.png)

在这些操作之后，驱动程序应该正确处理元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T13:40:33.597

最好的解决方案是找出 selenium 做错了什么，但是没有 URL 或示例页面来测试它有点困难。无论如何，您可以将 HTML 转储到[jsfiddle 中](http://jsfiddle.net/)吗？如果有这样做并将网址粘贴到问题中，我相信有人可以找到解决方案。

但是，如果不是，另一种获得结果的方法是使用 jQuery。如果萤火虫正在拾取它而不是硒，那么 jQuery 没有理由不得到它。如果需要，以下是如何执行此操作：

**第 1 步：**页面上是否已经存在 jQuery？如果是这样，那么您不需要执行此操作，否则您需要自己添加它，方法是使用`driver.executeScript(addjQueryScript)`脚本[执行类似](https://stackoverflow.com/questions/7474354/include-jquery-in-the-javascript-console#7474386)操作的位置。

**第 2 步：**调用`WebElement input = driver.executeScript(elementSelector);`elementSelector 脚本类似于`\"return $('input[name=\"j_username\"]')\");`

我的 jQuery 不太好，但我相信它应该可以工作......

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T11:09:36.050

好吧，我建议在您的 html 代码中添加一个 id -

```
<input id="j_username"size="10" type="text" name="j_username" maxlength="8"> 
```

并按 id 查找元素 -

```
driver.findElement(By.id("j_username")); 
```

我在 xpath（borwser 问题？？）方面遇到过类似的问题，但 id 对我来说从来没有失败过。;)

顺便说一句，我觉得你的代码应该是 -

```
driver.findElement(By.xpath(".//*[@name='j_username']")); 
```

# python - 选择性 Numpy 数组操作（取决于值）

> ID：12623463
> 
> 赞同：3
> 
> 时间：2012-09-27T14:14:53.200
> 
> 标签：python, numpy

假设我有以下 Numpy 数组：

```
array([[3, 5, 0], [7, 0, 2]]) 
```

我现在想在值不为 0 的地方添加 2。最快的方法是什么？我必须操作相当大的多维数组？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T14:16:20.870

在我看来，这：

```
a[a!=0] += 2 
```

应该管用。

（对于非零性测试的有限情况），您*可能*可以加快速度（您需要`timeit`查看）：

```
mask = a.astype(bool)
a[mask] += 2 
```

* * *

当然，*如果*您可以在不同的位置重用相同的掩码（这是一个非常严格的约束），您可以节省掩码计算：

```
mask = a != 0
a[mask] += 2
#some more code ...
a[mask] *= 3
#more code ... 
```

* * *

当然，如果这足以成为瓶颈，您总是可以编写一个小的 C/Fortran 扩展来为您执行此操作（分别使用`Cython`或`f2py`）。这将避免创建掩码的开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:19:36.180

这取决于数组的大小，但您可以考虑为此使用[numexpr](http://code.google.com/p/numexpr/)：

```
# from your exemmple
>>> a = array([[3, 5, 0], [7, 0, 2]])
>>> %timeit a[a!=0] += 2
100000 loops, best of 3: 18.6 us per loop
>>> timeit numexpr.evaluate("a + 2 * (a != 0)")
10000 loops, best of 3: 42.6 us per loop 
```

但是使用更大的数组：

```
# make a big array with 10% of zeros :
a = np.random.rand(10000)
a[a<0.1] = 0
# same test:
>>> timeit a[a!=0] += 2
1000 loops, best of 3: 364 us per loop
>>> timeit numexpr.evaluate("a + 2 * (a != 0)")
10000 loops, best of 3: 119 us per loop 
```

这是一个单核。如果可能，Numepxr 会使用所有可用的内核。

# asp.net - asp.net URL 路由问题

> ID：12623469
> 
> 赞同：0
> 
> 时间：2012-09-27T14:15:06.430
> 
> 标签：asp.net, asp.net-mvc, url-routing

控制器中的索引函数采用三个参数，比如“a”、“b”、“c”。目前，我可以将值传递给 url 中的那些参数，例如 action?a="1"&'b'=2&'c'=3。

我想以 action/"value" 或 action/b="value" 的形式将值发送到 url 中的参数“b”。我尝试在 Global.asax.cs 中编辑路由，但出现错误“找不到路径的控制器或未实现 iController”。对此问题的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:23:04.477

您应该以这种方式将其构建到 global.asax 中的路由表中：

```
RouteTable.Routes.Add(new Route
{
    Url = "[controller]/[action]/[a]/[b]/[c]",
    Defaults = new { controller = "myController", action = "myAction", a = "1", b = "2", c = "3" },
    RouteHandler(typeof(MvcRouteHandler)
}); 
```

为了分解它，Url 参数显示了预期 Url 的结构，defaults 参数提供了任何可能为空的默认值。请记住，这将始终期望路由`myDomain.com/myController/myAction/1/2/3`或与结构相匹配的东西，例如`myDomain.com/myController/myAction///`. 如果您需要这些值的不同子集，则需要相应地调整您的路线。此外，您需要确保这条路线在您的路线定义中出现得相当早。路线由它找到的第一个匹配路线确定，因此更复杂（更难到达）的路线应该总是提前，以允许默认路线捕捉任何错过的东西。

参考：[http ://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)

# objective-c - 推送 tableview 导致 cellForRowAtIndexPath 异常

> ID：12623471
> 
> 赞同：1
> 
> 时间：2012-09-27T14:15:16.913
> 
> 标签：objective-c, xcode

我正在尝试构建一个多层 xmlparser，它在 tableview 中显示数据并根据所选行切换到下一个视图（很可能是同一个 viewcontroller）。

我从故事板转场开始，但由于我使用的是动态单元格，所以我不知道如何创建多个推送转场（因为它需要推送到各种视图控制器）。所以我保留了故事板视图，删除了所有的 segue 并改用下面的代码。

但是，当新视图尝试填充该行时，它会引发此异常：

> 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“UITableView 数据源必须从 tableView 返回一个单元格：cellForRowAtIndexPath：”

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"index: %i", indexPath.row);

    switch (indexPath.row) {
        case 0:
        {
            DetailViewController *detailViewController = [DetailViewController alloc];
            [self.navigationController pushViewController:detailViewController animated:YES];
            break;
        }
        //...
        default:
        {
            LayerViewController *layerViewController= [LayerViewController alloc];
            [layerViewController setStartUpWithIndex:indexPath.row andLayer:layercount];
            [self.navigationController pushViewController:layerViewController animated:YES];
            break;
        }

    }

} 
```

setStartUpWithIndex:andLayer: 是我的初始化方法...

当我使用以下 segue 代码通过 storyboard segue 推送时，不会发生此问题：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
        NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
        [[segue destinationViewController] setStartUpWithIndex:indexPath.row andLayer:layercount];
} 
```

我想我错过了“segue”方法所做的一些事情，我需要将其包含在我的 didSelectRowAtIndexPath 作为 cellForRowAtIndexPath: 在视图的第一层中正常工作。

请求编辑：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"LayerCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    cell.textLabel.text = [[articles objectAtIndex:indexPath.row]objectForKey:@"HerstellerName"];
//    cell.textLabel.text = @"ololol";

    return cell;
} 
```

顺便说一句，文章数组正在工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:59:57.020

您没有创建任何单元格。我不知道为什么 Apple 没有在默认实现中包含这个，但是之后：

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath]; 
```

您需要添加：

```
if (cell==nil){
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
} 
```

否则，您只是依赖在 tableView 加载时不存在的出列单元格。

编辑：如果您不使用 ARC，则需要使用自动释放包装该 alloc 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:33:49.213

您正在推动另一个 viewController 被查看，而下一个 viewController 没有实现 dataSource 方法。这是发生了什么。

据我了解，您正在尝试以每个表行包含呈现节点的子节点的方式呈现一个带有表的 xml 节点。选择带有 chld 节点的行会让您进入下一个表视图，该视图显示带有所选节点的子节点的表。

IMO 您可能只需要一个视图控制器来呈现当前的 xml 节点，它只更改要在表中呈现的数据并再次重新加载表。所以不需要推送视图控制器。您可以使用 then 方法

```
– reloadRowsAtIndexPaths:withRowAnimation: 
```

对于表中的所有节点，设置类似于更改视图控制器的动画（也就是向左滑动旧表）

# vim - 如何更正整个文件中的拼写？

> ID：12623472
> 
> 赞同：4
> 
> 时间：2012-09-27T14:15:19.033
> 
> 标签：vim

拼写错误可以通过将光标指向拼写错误的单词并按`z=` *（出现一个列表，您可以选择正确的单词）*来修复。但这只会修复一次错误*（在当前单词上）*。这不是我们很多人想要的，大多数人都会很乐意在整个文件中进行替换。我该怎么做？

### 不成功的尝试：

我想到了用正确的错误*(ie `:%s/badspell/goodspell/g`)*代替那个错误。但不好的是，这很痛苦。首先，我需要（至少）纠正一个单词，然后将错误的拼写和更正的拼写存储在**我的缓冲区** *（大脑）*中，然后编写替换命令*（我可能会在编写错误的拼写和正确的拼写时出错。）*。虽然它也需要时间。

* * *

StackOverflow 上有一个[类似的问题](https://stackoverflow.com/a/12047896/939986)`:spellrepall`，它说我可以在更正后解决我的问题。唯一的问题是我不想所有这些打字。每次有拼写更正时，我都想自动执行此操作。

[*并且不要向我推荐插件。*]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:58:02.350

你可以在 .vimrc 中设置法术

```
set spell 
```

或者如果你直接在 vim 上执行这个，在 vim 命令模式下执行。

```
:set spell 
```

一旦法术开启，您需要知道以下命令：

```
]s — move to the next mispelled word
[s — move to the previous mispelled word
zg — add a word to the dictionary
zug — undo the addition of a word to the dictionary
z= — view spelling suggestions for a mispelled word 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T14:59:20.747

如果大多数时候您从查询中选择第一个修复程序，则可以使用重新映射`1z=`：

```
nnoremap 1z= 1z=:spellrepall<cr> 
```

尽管我建议`:spellrepall`像许多人已经建议的那样绑定到单独的键。我非常怀疑你已经用完了所有这些`<leader>`和`<localleader>`组合的键绑定。（类似的东西`<leader>z`将是一个完美的候选人）

如果你不放松你的期望，我认为这不会变得更容易。

# c# - 极慢的 WatiN.Core.Document.FileUpload 集

> ID：12623480
> 
> 赞同：1
> 
> 时间：2012-09-27T14:15:44.340
> 
> 标签：c#, testing, internet-explorer-9, watin

我在 Windows 7 64 位上使用 WatiN 2.1.0 (C#) 和 IE 9。

我的问题是调用这个函数

```
ie.FileUpload(Find.ByName(someRegExp)).Set(fileName); 
```

非常慢。
我的意思是很好地找到了对象。此代码打开文件对话框，但在很长一段时间后开始输入文件名，大约 3 到 5 分钟，比 WatiNs 超时时间长得多。在剩下的测试工作正常之后。

有什么治疗方法吗？这种巨大的延迟非常烦人，当有更多带有文件上传的测试用例时，它会显着延长测试持续时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T11:13:00.630

好的，这不是每个说的 Watin 解决方案，但我们遇到了完全相同的问题；我们的文件浏览器测试占用了大量的总测试时间，我通过踢掉 Watin 来进行文件上传解决了这个问题，而是使用了（可怕的）UIAutomation 框架。

示例用法：

```
 public CustomFileUpload FileUpload
    {
        get
        {
            return new CustomFileUpload(WebBrowser.Current.hWnd, "_Layout");
            //return Document.FileUpload(Find.ByName("file"));
        }
    } 
```

您必须在测试项目中添加对“UIAutomationClient”和“UIAutomationTypes”的引用。下面的解决方案不是通用的，因此您可能需要对其进行调整以满足您的需求。

```
public class CustomFileUpload
{
    private readonly IntPtr _browserHandle;
    private readonly string _tabHeader;

    public CustomFileUpload(IntPtr browserHandle, string tabHeader)
    {
        _browserHandle = browserHandle;
        _tabHeader = tabHeader;
    }

    public void Set(string filePath)
    {
        Automate(filePath);
    }

    private void Automate(string filePath)
    {
        AutomationElement browser = AutomationElement.FromHandle(_browserHandle);

        AutomationElement tab = FindTab(browser, _tabHeader);

        // IE10 adds the name (or value?) "Browse..." to the upload-button. Need to hack it :)
        AutomationElement uploadButton = tab.FindFirst(TreeScope.Children,
                                                            new AndCondition(
                                                                new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Button),
                                                                new PropertyCondition(AutomationElement.NameProperty, "Browse..."))) ??
                                                                tab.FindFirst(TreeScope.Children,
                                                        new AndCondition(
                                                            new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Button),
                                                            new PropertyCondition(AutomationElement.NameProperty, "")));

        ClickButton(uploadButton);

        var openFileDialog = WaitUntilOpenFileDialogAvailable();

        var valuePattern = FindFileNameTextBox(openFileDialog).GetCurrentPattern(ValuePattern.Pattern) as ValuePattern;

        if (valuePattern == null)
            throw new InvalidOperationException("Can't set the file path");

        valuePattern.SetValue(filePath);

        SetFocusToSomethingElse(browser);

        var okButton = WaitUntilOkButtonLoaded(openFileDialog);

        ClickButton(okButton);
    }

    private static AutomationElement FindTab(AutomationElement browser, string tabHeader)
    {
        return browser.FindFirst(TreeScope.Descendants,
                                 new AndCondition(
                                     new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Pane),
                                     new PropertyCondition(AutomationElement.NameProperty, tabHeader)));
    }

    private static void SetFocusToSomethingElse(AutomationElement elementWhichShouldNotBeSelected)
    {
        do
        {
            foreach (AutomationElement element in AutomationElement.RootElement.FindAll(TreeScope.Children, new PropertyCondition(AutomationElement.IsKeyboardFocusableProperty, true)))
            {
                if (element != elementWhichShouldNotBeSelected)
                {
                    element.SetFocus();
                    return;
                }
            }

        } while (true);
    }

    private static AutomationElement WaitUntilOkButtonLoaded(AutomationElement openFileDialog)
    {
        AutomationElement okButton;

        do
        {
            okButton = openFileDialog.FindFirst(TreeScope.Children,
                                                new AndCondition(
                                                    new PropertyCondition(AutomationElement.IsContentElementProperty, true),
                                                    new PropertyCondition(AutomationElement.IsControlElementProperty, true),
                                                    new PropertyCondition(AutomationElement.NameProperty, "Open"),
                                                    new PropertyCondition(AutomationElement.IsInvokePatternAvailableProperty, true)
                                                    ));

        } while (okButton == null);

        return okButton;
    }

    private static AutomationElement WaitUntilOpenFileDialogAvailable()
    {
        AutomationElement openFileDialog = null;

        do
        {

            AutomationElement openFileDialogContainer = AutomationElement.RootElement.FindFirst(TreeScope.Children, new PropertyCondition(AutomationElement.ClassNameProperty, "Alternate Modal Top Most"));

            if (openFileDialogContainer != null)
                openFileDialog = openFileDialogContainer.FindFirst(TreeScope.Children, Condition.TrueCondition);
        } while (openFileDialog == null);

        return openFileDialog;
    }

    private static void ClickButton(AutomationElement button)
    {            
        var clickPattern = button.GetCurrentPattern(InvokePattern.Pattern) as InvokePattern;

        if (clickPattern == null)
            throw new InvalidOperationException("Can't find the buttons click pattern");

        clickPattern.Invoke();
    }

    private static AutomationElement FindFileNameTextBox(AutomationElement openFileDialog)
    {
        AutomationElement findElementToTypePathInto;

        do
        {
            findElementToTypePathInto = openFileDialog.FindFirst(TreeScope.Descendants, new AndCondition(new PropertyCondition(AutomationElement.NameProperty, "File name:"), new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Edit)));
        } while (findElementToTypePathInto == null);

        return findElementToTypePathInto;
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-03T11:46:19.337

我有一个稍微简单的解决方案（再次依赖自动化，但仅用于选择文件）我在文件输入上使用 .ClickNoWait() 不会导致浏览器挂起。

然后我写了一个扩展方法来设置我要选择的文件：

```
public static void UploadFile(this Browser browser, string uploadPath)
{
    var trw = new TreeWalker(Condition.TrueCondition);
    var mainWindowElement = trw.GetParent(AutomationElement.FromHandle(browser.hWnd));

    // Wait for the dialog to open
    Thread.Sleep(1000);

    // Get the select dialog
    var selectDialogElement = mainWindowElement.FindFirst(TreeScope.Descendants, 
        new PropertyCondition(AutomationElement.NameProperty, "Choose File to Upload"));

    // Get the file name box and set the path
    var selectTextElement = selectDialogElement.FindFirst(
        TreeScope.Descendants,
        new AndCondition(new PropertyCondition(AutomationElement.NameProperty, "File name:"),
            new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Edit)));
    var selectValue = (ValuePattern)selectTextElement.GetCurrentPattern(ValuePattern.Pattern);
    selectValue.SetValue(uploadPath);

    // Get the open button and click it
    var openButtonElement = selectDialogElement.FindFirst(TreeScope.Descendants,
        new AndCondition(new PropertyCondition(AutomationElement.NameProperty, "Open"),
            new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Button)));
    var openButtonClick = (InvokePattern)openButtonElement.GetCurrentPattern(InvokePattern.Pattern);
    openButtonClick.Invoke();
} 
```

示例用法：

```
var browser = (IE)Document.DomContainer;     
Document.FileUpload(Find.BySelector("#FileUpload")).ClickNoWait();
browser.UploadFile("c:\\myfile.txt");
Document.Button(Find.BySelector("#submit")).Click(); 
```

UIAutomation 将从调用 UploadFile(filepath) 接管并找到对话窗口，并像用户那样填写表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:43:31.867

在 WatiN 开始在文件上传对话框中输入文件名之前，我还经历了 3 到 5 分钟的延迟。

每当在 IE 中打开开发人员工具窗格时，这似乎都会发生在我身上。当它未打开时，立即开始输入。

关于默认浏览器和类似弹出窗口的提示似乎也会导致延迟。

# objective-c - Objective-C中的只读层次模型

> ID：12623486
> 
> 赞同：2
> 
> 时间：2012-09-27T14:16:14.083
> 
> 标签：objective-c, ios, macos

在我的 Objective-C 应用程序中，我有一个`NSObject`构成模型的子类层次结构。这些对象本身没有功能，即它们只有属性并且它们的唯一目的是保存数据。此外，我有一个控制器来管理此层次结构（树）的实例。

只有该控制器才被允许对树进行更改（例如树中对象的属性）。程序的其他部分应具有对（整个）树的只读访问权限。

完成此类访问管理的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:47:27.960

这是[朋友班](http://en.wikipedia.org/wiki/Friend_class)的经典案例。虽然 ObjC 没有对友元类的语言支持，但创建它们并不难。

首先，模型的公共接口应该声明属性`readonly`。那部分应该是显而易见的。

然后在模型内部，您可以根据需要在类扩展中使您的属性可读写。（如果你习惯了 ObjC，这也应该很明显；如果不明显，我会更新答案。）

现在剩下的故事。创建一个“朋友”类别（或“作家”或“受保护”或任何对您有意义的名称）。

```
@interface ModelObject (Friend)
- (void)setSomeProperty:(id)someProperty;
@end 
```

这只是告诉任何导入此类别的人`setSomeProperty:`存在。现在您的控件将导入此文件 ( `ModelObject+Friend.h`) 并能够设置属性。其他人都导入`ModelObject.h`并且该属性看起来是只读的。

这适用于您需要访问的任何内容，当然不仅仅是属性。我经常创建不可变的类，然后创建一个“仅限朋友”的`initWithX:andY:andZ:`方法。

# android - 删除库项目的不必要文件

> ID：12623490
> 
> 赞同：1
> 
> 时间：2012-09-27T14:16:19.580
> 
> 标签：android, xml, apk

我正在为 android 创建一个应用程序，在其中一项活动中，我使用了一个库项目来创建一个从上到下下降的面板。一切正常，没有错误。发布此问题的原因是我的 .apk 文件中包含一些未使用的图像，这会增加应用程序的大小。我尝试使用 winrar 打开我的 apk 文件，然后删除未使用的图像，然后再次将其扩展名重命名为 .apk。但它在我的手机上不起作用，因为`error parsing the XML file`当我尝试安装应用程序时出现错误说明。请提供解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:19:28.923

从您的项目中删除未使用的图像并再次导出 .apk 文件。
确保您没有删除所需的图像。

# mysql - 登录新会话后表不存在

> ID：12623495
> 
> 赞同：0
> 
> 时间：2012-09-27T14:16:26.697
> 
> 标签：mysql, corrupt

这是一个奇怪的案例，绝对不是我在表格损坏时看到的其他案例之一......

我从一个全新的会话开始（清除浏览器历史记录、会话和 cookie 以在 chrome 或任何其他浏览器中初始化）我可以使用网站的登录系统登录。当我登录网站时，每个其他带有 MySQL 查询的页面都会导致表不存在错误。

show table、create table、repair table select * from、drop table 和对表的任何其他操作导致表不存在错误。

任何可能发生的情况？它是一个已知的错误还是什么？我没有移动或更改服务器上可能导致此问题的任何内容，也没有尝试删除表。

有趣的是，每当我清除浏览器历史记录或会话时，这都是可以重现的

一些版本信息：

> innodb_version 1.1.8
> protocol_version 10
> slave_type_conversions
> version 5.5.15
> version_comment MySQL Community Server (GPL)
> version_compile_machine x86
> version_compile_os Win64
> 
> PHP 版本 5.2.17

一直有效，直到今天

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T12:19:00.333

我们已经有了解决方案，我们将多个数据库用于多种目的。我的一位同事更改了文件，其中与主数据库的连接位于顶部，然后是第二个数据库连接语句。由于数据库名称相同，我们没有注意到这一点。

# windows - makefile波浪线扩展，windowsXP和windows7的区别

> ID：12623499
> 
> 赞同：0
> 
> 时间：2012-09-27T14:16:38.067
> 
> 标签：windows, makefile

我正在重新编译一个项目。以前我使用的是 WindowsXP，但我切换到了 Windows7。

makefile 的问题部分是：

```
%else
        INSTALL_DIR := C:\PROGRA~1\micros~1.0\VC
%endif

%if !%exists($(INSTALL_DIR))
%error blablabla...
%endif 
```

看来，这`PROGRA~1`已经在第一行扩展了，因为我收到以下错误：

```
(line 25): Test: ')' expected; got "Files". Stop. 
```

为什么行为与 WindowsXP 下不同？如何应对？（这不是我使用这种结构的唯一地方......）

* * *

Maximus - 谢谢你的回答 - 它对我帮助很大；）我想确保一切正常，我注意到我犯了愚蠢的错误。

再次，更多代码：

```
%ifdef OMAKE_MSVC_INSTALL_DIR
    INSTALL_DIR := $(OMAKE_MSVC_INSTALL_DIR)
%echo case 1
%echo $(INSTALL_DIR)
%else
    INSTALL_DIR := C:\PROGRA~1\micros~1.0\VC
    %echo case 2
%endif

%if !%exists($(INSTALL_DIR))
    %error blablabla
%endif 
```

我以为，案例 2 已执行，但实际上案例 1 已执行……现在一切都清楚了 :) 谢谢 :-)

# javascript - 重新初始化 youtube iframe api

> ID：12623510
> 
> 赞同：2
> 
> 时间：2012-09-27T14:17:08.723
> 
> 标签：javascript, youtube, youtube-api

我正在使用 ajax 添加我的 YouTube iframe（在模态/灯箱层中）。一次一个。由于我正在这样做（并且无法更改），因此我无法在准备好文档时运行 youtube api。该脚本需要在 iframe 存在时附加并运行，才能找到 iframe 的 ID。

第一个 iframe 一切正常。使用 ajax 获取 iframe 时，我还附加了 javascript。

但是：当我关闭那个模态层（我关闭它，我不删除它 - 出于性能原因）并打开另一个带有新视频的层时，我想再次运行 youtube 脚本。现在添加第二个 youtube api 脚本时它不起作用。

注意：当我关闭模式时，我会使用 api 暂停视频。这只适用于第一个 iframe。

我应该怎么办？是否有运行重新初始化 api 的函数？

* * *

感谢您尝试帮助 tsturzl，但这不起作用。

我打开一个模式并使用 ajax 加载内容（包含 iframe 和其他元素）。然后我运行 youtube API 并将 ID 设置为 iframe ID。

当我关闭模式时，我运行 player.pauseVideo(); 并暂停视频。模态现在隐藏（未删除，视频暂停），iframe 仍在 html 中，youtube api 的 ID 为“已保存”。

现在我想用另一个 youtube iframe 打开另一个模式（这个也加载了 ajax）。我再次运行 api 并尝试保存该 ID，因此当我关闭（隐藏）该模式时，新视频会暂停，但它不起作用。

知道怎么做吗？

注意：在这些模式中，视频显示在一个预览 div 中，用户可以隐藏/显示 iframe。当他们隐藏它时，视频应该暂停。当 iframe 隐藏时，预览 div 中会显示一个图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:45:01.177

似乎没有，但是您可以自己重新初始化它。看到您没有提供代码，我将在[此处参考文档上的代码](https://developers.google.com/youtube/iframe_api_reference)

初始化你创建“var player;” 这是您使用函数“onYouTubeIframeAPIReady()”创建实例的变量。也许您不是每次创建模态时都重新创建 iframe。

您做模态框的方式可能是将内容存储在javascript中的字符串中。因此，每次关闭它时，div 元素都会消失，因此 youtube API 可能会因为缺少初始化它的元素而出错。

我的猜测是每次打开或关闭模式时都应该创建和删除 iframe（即“播放器”对象）。

不幸的是，我不能确定，我没有代码片段可以作为基础。由于您提供的信息很少。

所以我想要的是这样的：

```
 var isReady=0;
      var player;
      function onYouTubeIframeAPIReady() {
        isReady=1;
      }

      // 4\. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
        event.target.playVideo();
      }

      // 5\. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
      function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING && !done) {
          setTimeout(stopVideo, 6000);
          done = true;
        }
      }
      function stopVideo() {
        player.stopVideo();
      }
      function onModalOpen(){
        if(isReady==1){
          player = new YT.Player('player', {
            height: '390',
            width: '640',
            videoId: 'u1zgFlCw8Aw',
            events: {
              'onReady': onPlayerReady,
              'onStateChange': onPlayerStateChange
            }
          });
        }
      }
      function onModalClose(){
        player=null;
      } 

```

当然，您需要为每个 iframe 创建一个“播放器”对象。您还需要为每个播放器对象调用 onModalOpen/Close，您可以将其作为参数传递给事件处理程序。

# .net - 将 MVC3 项目升级到 VS2012 后出现 AccessViolationException

> ID：12623517
> 
> 赞同：2
> 
> 时间：2012-09-27T14:17:29.097
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-3, visual-studio, visual-studio-2012

我使用 VS2010 开发了一个 MVC3 网站，效果很好。我最近将我的开发环境升级到了 VS2012 RTM。我现在无法在调试器中运行网站，而不会导致开发 Web 服务器崩溃。

> WebDev.WebServer40.exe 已停止工作

我在 VS2012 中看到了两个类似的堆栈跟踪之一：

首先，一个`AccessViolationException`：

```
mscorlib.dll!System.StringComparer.GetHashCode(object obj) + 0xc bytes  
mscorlib.dll!System.Collections.Hashtable.GetHash(object key) + 0x10 bytes  
mscorlib.dll!System.Collections.Hashtable.InitHash(object key, int hashsize, out uint seed, out uint incr) + 0xf bytes  
mscorlib.dll!System.Collections.Hashtable.Remove(object key) + 0x38 bytes   
System.dll!System.Collections.Specialized.NameObjectCollectionBase.BaseRemove(string name) + 0x2e bytes 
System.Web.dll!System.Web.SessionState.SessionStateItemCollection.Remove(string name) + 0x56 bytes  
System.Web.dll!System.Web.SessionState.HttpSessionStateContainer.Remove(string name) + 0xc bytes    
System.Web.dll!System.Web.HttpSessionStateWrapper.Remove(string name) + 0xf bytes   
Dive7.Site.dll!Dive7.Site.D7WebViewPage<object>.IsAdmin.get() Line 56 + 0x19 bytes  C# 
```

其次，一个`NullReferenceException`：

```
mscorlib.dll!System.StringComparer.GetHashCode(object obj) + 0x33 bytes 
mscorlib.dll!System.Collections.Hashtable.GetHash(object key) + 0x10 bytes  
mscorlib.dll!System.Collections.Hashtable.InitHash(object key, int hashsize, out uint seed, out uint incr) + 0xf bytes  
mscorlib.dll!System.Collections.Hashtable.Remove(object key) + 0x38 bytes   
System.dll!System.Collections.Specialized.NameObjectCollectionBase.BaseRemove(string name) + 0x2e bytes 
System.Web.dll!System.Web.SessionState.SessionStateItemCollection.Remove(string name) + 0x56 bytes  
System.Web.dll!System.Web.SessionState.HttpSessionStateContainer.Remove(string name) + 0xc bytes    
System.Web.dll!System.Web.HttpSessionStateWrapper.Remove(string name) + 0xf bytes   
Dive7.Site.dll!Dive7.Site.D7WebViewPage<object>.IsAdmin.get() Line 56 + 0x19 bytes  C# 
```

发生的确切事件似乎是随机的。

据我所知，我所做的只是安装 VS2012，重新启动，然后在新版本的 VS 中打开我的 VS2010 解决方案，看着它说升级成功，然后按`F5`。

我没主意了。谁能建议可能发生的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T23:00:12.020

[请阅读链接http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253815](http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253815)中的“安装 ASP.NET MVC 4 破坏 ASP.NET MVC 3 RTM 应用程序”部分。按照 setps“必需的更新”，让我知道这个错误是否仍然存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T12:30:17.450

正如 Anand 所指出的，当您在 VS2012 中打开 MVC3 应用程序时，您必须对它进行一些手动更改，因为安装 VS2012 也会导致安装 MVC4。这些更改允许并行操作：

在`Web.config`：

```
<appSettings>
    <add key="webpages:Version" value="1.0.0.0"/>
    <add key="ClientValidationEnabled" value="true"/>
    <add key="UnobtrusiveJavaScriptEnabled" value="true"/>
</appSettings> 
```

然后编辑您的 MVC 项目的`.csproj`文件。替换这些行：

```
<Reference Include="System.Web.WebPages"/> 
<Reference Include="System.Web.Helpers" /> 
```

（它们可能看起来像这样）：

```
<Reference Include="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
    <SpecificVersion>False</SpecificVersion>
    <HintPath>..\..\..\..\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Pages\v1.0\Assemblies\System.Web.WebPages.dll</HintPath>
</Reference>
<Reference Include="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
    <SpecificVersion>False</SpecificVersion>
</Reference> 
```

使用这些行：

```
<Reference Include="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL "/> 
<Reference Include="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL" /> 
```

取自[MVC4 发行说明](http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253815)。

# xml - 如何在 XML 中创建有序数据

> ID：12623525
> 
> 赞同：3
> 
> 时间：2012-09-27T14:17:42.437
> 
> 标签：xml

我想将多边形定义为一系列点，如下所示：

```
<polygon>
   <point x="0"     y="0" z="0" />
   <point x="100.0" y="100.0" z="100.0" />
   <point x="50.0"  y="100.0" z="50.0"  />
</polygon> 
```

当我阅读它们时，保留点的顺序很重要

我编写了以下 xsd 文件：

```
<xs:element  name="point_type">
   <xs:complexType>
      <xs:attribute name="x" type="xs::double"/>
      <xs:attribute name="y" type="xs::double"/>
      <xs:attribute name="z" type="xs::double"/>
   </xs:complexType>
</xs:element>

<xs:element name="polygon_type">
  <xs:complexType>
    <xs:sequence maxOccurs="unbounded">
      <xs:element name="point" type="point_type"/>
    </xs:sequence>
  </xs:complexType>
</xs:element> 
```

但有人指出，`xs:sequence`这并不一定意味着`<points>`会井井有条。事实上，[http://www.w3schools.com/schema/el_sequence.asp](http://www.w3schools.com/schema/el_sequence.asp)似乎定义了该序列

```
 <xs:sequence maxOccurs="unbounded">
      <xs:element name="A" type="A_type"/>
      <xs:element name="B" type="B_type"/>
    </xs:sequence> 
```

只会确保`B`'s 在`A`'s之后

```
<super>
  <A/>
  <B/>
  <A/>
  <B/>
</super> 
```

并且没有说明 {AB} 对的顺序。

有人知道吗？你能指出我支持一个论点的参考文献吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:43:34.840

我建议您`id`向点添加一个属性，以便您可以显式跟踪应用程序中点的顺序，而不是依赖 XML 解析器以正确的顺序返回元素。[我使用过的所有 XML 解析器都遵守元素顺序，但我在XML 规范](http://www.w3.org/TR/REC-xml/)中找不到任何关于此的内容。

```
<polygon>
   <point id="0" x="0"     y="0" z="0" />
   <point id="1" x="100.0" y="100.0" z="100.0" />
   <point id="2" x="50.0"  y="100.0" z="50.0"  />
</polygon> 
```

# matlab - 取消切换所有图形工具栏按钮

> ID：12623528
> 
> 赞同：4
> 
> 时间：2012-09-27T14:17:54.557
> 
> 标签：matlab, user-interface, toolbar

我想在图形工具栏中添加一个新的切换按钮。单击它时，我想“取消切换”任何其他已切换的按钮。例如，如果按下“旋转”或“缩放”切换按钮，我想取消切换它们及其效果。简单地获取它们的所有句柄是行不通的，因为这不会取消它们的效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:36:45.950

您应该首先找到工具栏的所有子项。您可以通过以下命令执行此操作（假设这`currentToggleButton`是当前切换按钮的句柄）：

```
 get( get(currentToggleButton,'Parent'),'Children'); 
```

然后执行以下操作：

```
 set(children,'State','off'); 
```

当然，您需要将当前按钮的状态返回到`on`.

```
 set(currentToggleButton,'State','on'); 
```

顺便说一句，如果您使用的是 GUIDE，您可以添加和`zoom`作为预定义工具。在这种情况下，Matlab 将自动处理切换。`rotate``pan`

* * *

为了关闭缩放/平移/旋转的效果，你可以这样做：

```
 zoom('off')
 pan('off')
 rotate3d('off') 
```

或者您可以使用其他语法版本（正如@Eitan 也提到的）

```
 zoom off
 pan off
 rotate3d off 
```

# java - Java - 将 OutputStream 上传为 HTTP 文件上传

> ID：12623532
> 
> 赞同：3
> 
> 时间：2012-09-27T14:18:09.580
> 
> 标签：java, upload, httpurlconnection, multipartform-data, apache-commons-httpclient

我有一个写入 的旧应用程序，`OutputStream`我希望将此流的内容作为文件上传到 Servlet。我已经`commons-fileupload`使用 JMeter 测试了 Servlet，它工作得很好。

我会使用 Apache HttpClient，但它需要一个`File`而不只是一个输出流。我*无法*在本地写入文件；如果有一些内存实现`File`可能会起作用？

我尝试过使用`HttpURLConnection`（如下），但服务器响应“MalformedStreamException：流意外结束”。

```
 URL url = new URL("http", "localhost", 8080, "/upload");
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setDoOutput(true);
        String boundary = "---------------------------7d226f700d0";
        connection.setRequestProperty("Content-Disposition", "form-data; name=\"file\""); 
        connection.setRequestProperty("Content-Type", "multipart/form-data; boundary="+boundary);
        connection.setRequestProperty("Accept", "application/json");
        connection.setRequestMethod("POST");   
        connection.setChunkedStreamingMode(0);
        connection.connect();           

        OutputStream out = connection.getOutputStream();
        byte[] boundaryBytes =("--" + boundary + "\r\n").getBytes();
        out.write(boundaryBytes);

        //App writes to outputstream here

        out.write("\r\n".getBytes());
        out.write(("--"+boundary+"--").getBytes());
        out.write("\r\n".getBytes());

        out.flush();
        out.close();
        connection.disconnect(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:38:35.663

PostMethod 允许您设置一个 RequestEntity，这是一个*您*可以实现的接口。您只需要`RequestEntity.writeRequest`适当地实现该方法。

或者，如果您希望 HttpClient 为您处理多部分内容，您可以将 MultipartRequestEntity 与自定义部分一起使用。

# c++ - 重载提取和插入运算符 C++

> ID：12623535
> 
> 赞同：1
> 
> 时间：2012-09-27T14:18:15.447
> 
> 标签：c++, overloading, extraction, insertion

您好，我已经重载了插入和提取运算符。当我运行我的程序时，尽管提取正在将值放入类中，但插入似乎没有输出值。似乎实例的插入视图中没有任何值。

主要的

```
/ Input Poly
cout << "Input p1: " << endl;
Polynomial P1;
cin >> P1;

// Output Poly
cout << "p1(x) = " << P1 << '\n' << endl; 
```

类功能

```
//Insertion
ostream& operator<<(ostream& os, Polynomial Poly){

for (int i=0; i < Poly.polyNum; i++) {
    os << Poly.poly[i] << " x^" << i;

    if(i != Poly.polyNum - 1){
        os << " + ";
    }
}

return os;
}

//Extraction
istream& operator>>(istream& is, Polynomial Poly){

int numP = 0;
int * tempP;

is >> numP;

tempP = new int [numP+1];

for (int i=0; i < numP; i++) {
    is >> tempP[i];
}

Poly.polyNum = numP;

Poly.poly = new int[Poly.polyNum +1];

for (int i=0; i < Poly.polyNum; i++) {
    Poly.poly[i] = tempP[i];
}

return is;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:19:41.620

```
istream& operator>>(istream& is, Polynomial Poly) 
```

应该

```
istream& operator>>(istream& is, Polynomial& Poly) 
```

您现在所做的只是更改对象**副本**的成员：

```
Polynomial P1;
cin >> P1; 
```

`P1`在此之后不修改。

# ajax - 社交网络，如何构建“你有新的未读消息”架构

> ID：12623536
> 
> 赞同：0
> 
> 时间：2012-09-27T14:18:18.737
> 
> 标签：ajax, architecture, social-networking, web-architecture

[例如，当我们在http://facebook.com](http://facebook.com)或[http://gmail.com](http://gmail.com)上有新消息时，网站会向我们发出信号，而这发生在没有刷新页面的情况下。这个怎么运作？我是这样想象的：

一些 Jhon 是现场注册用户。

有 javascript 代码，每 10 秒向消息表发送 AJAX 请求，用于检查：在表中，是否有未读消息给 john（架构，如何标记就绪/未读消息，这里不重要），如果是，站点给出信号对 Jhon “你有几条新消息”。

请告诉我，我是否更接近真相？如果是，我还有一个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:19:48.830

在现代站点中，我们使用[websockets](http://en.wikipedia.org/wiki/WebSocket)，它使服务器能够以更少的开销和无延迟地将信息推送到浏览器。这就是SO上使用的。

但是由于[某些浏览器仍然不支持它们](http://caniuse.com/#feat=websockets)，因此我们有时必须退回到您所描述的拉循环。

在服务器上，它可以在每个浏览器请求时使用队列而不是数据库查询来处理。但是在这一点上可能有许多不同的实现。

# html - CSS 下拉菜单在 IE 中不可用 工作中的客户要求我们将表单转换为他们导航上的下拉菜单。本身不是问题，但是我们这里不允许使用任何 JS。如果我们不能想出任何其他修复方法，尽管他们将允许一个小的 vanilla JS 脚本来处理这个问题。问题表单上的输入不能在 Internet Explorer 中使用，因为整个菜单在单击表单元素时隐藏。我已经为这个问题做了一个 JS Fiddle，并且希望任何人都可以在这里提供任何帮助。HTML/CSS 不是我自己的。它已经在项目中，不幸的是，我无法将它

> ID：12623541
> 
> 赞同：3
> 
> 时间：2012-09-27T14:18:35.900
> 
> 标签：html, css, forms, select, drop-down-menu

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T09:23:27.377

可以为 IE9 使用 :target 选择器。在您的示例中，您将 div.button 替换为 a.button：

```
 <a href="#basket-container" class="button">Shopping Basket</a> 
```

将锚点添加到 div.basket-container：

```
<div class="basket-container" id="basket-container">
...
</div> 
```

然后使用 :target 选择器打开下拉菜单：

```
.head-basket .basket-container:target {
    background: #fff;
    display: block;
} 
```

[http://jsfiddle.net/HssXt/10/](http://jsfiddle.net/HssXt/10/)

[http://www.quirksmode.org/css/contents.html#t316](http://www.quirksmode.org/css/contents.html#t316)

不过，您将需要一些额外的关闭按钮来从该目标中删除哈希。而且在这种情况下，IE8 及以下版本仍然没有任何解决方案。

所以这是不可避免的。您要么使用 JS 添加一些“活动”类，要么将 select 替换为文本输入。

要考虑的另一件事是完全从下拉列表中删除该选择输入。对我来说，改变购物车下拉列表中的数量似乎是一个非常罕见的用例。无论如何，该功能都将出现在结帐页面上（会吗？），因此您可以简化界面并同时解决问题。

# google-apps-script - Google Drive 与 Google Apps 脚本的交互

> ID：12623546
> 
> 赞同：1
> 
> 时间：2012-09-27T14:19:01.780
> 
> 标签：google-apps-script, google-drive-api

我想知道如何/是否可以仅使用 Google Apps 脚本将 Google Drive 中的特定文件夹链接到特定的 Google Apps 用户？

这样做的原因是我们使用 google 表单及其背后的一些 Google Apps 脚本创建了新的 Google Apps 用户。之后，我们希望每个用户都有一个特定的公司文件夹链接到他们的“我的云端硬盘”

欢迎任何提示:)

问候，

基斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:13:20.377

确定的事！

如果您制作了一个包含几个值的表单，请使用以下代码：

```
function myFunction(e) {
  var username = e.namedValues.username;
  var givenName = e.namedValues.givenName;
  var familyName = e.namedValues.familyName;
  var password = e.namedValues.password;

  var user = UserManager.createUser(username, givenName, familyName, password);
  var folder = DocsList.createFolder(username);
  folder.addEditor(user.getEmail());

} 
```

使用事件触发：onFormSubmit

亲切的问候，

托马斯·范拉图姆

# c# - C# UTF8 解码，返回字节/数字而不是字符串

> ID：12623548
> 
> 赞同：2
> 
> 时间：2012-09-27T14:19:11.450
> 
> 标签：c#, encoding, utf-8, io, byte

我在使用 UTF8Encoder 解码文件时遇到问题。

我正在从使用 UTF8（字符串 > 字节）编码的文件中读取文本，请参阅以下方法。

```
public static void Encode(string Path)
    {
        string text;
        Byte[] bytes;
        using (StreamReader sr = new StreamReader(Path))
        {
            text = sr.ReadToEnd();
            UTF8Encoding Encoding = new UTF8Encoding();
            bytes = Encoding.GetBytes(text);
            sr.Close();
        }
        using (StreamWriter sw = new StreamWriter(Path))
        {
            foreach (byte b in bytes)
                sw.Write(b.ToString());
            sw.Close();
        }
    } 
```

然后我使用该方法对其进行解码

```
 public static String Decode(string Path)
    {
        String text;
        Byte[] bytes;
        using (StreamReader sr = new StreamReader(Path))
        {
            text = sr.ReadToEnd();
            UTF8Encoding Encoding = new UTF8Encoding();
            bytes = Encoding.GetBytes(text);
            text = Encoding.GetString(bytes);
            return text;
        }
    } 
```

但是，它没有解码字节以使其返回文本，而是将其作为一串数字返回。我看不出我做错了什么，因为我对此并没有太多经验。

编辑：澄清我想要实现的目标。我试图让一个文本文件将文本保存为字节，而不是字符/数字。这是为文件提供非常简单的加密，因此您无法修改它们，除非您知道自己在做什么。然后使用解码函数从文件中读取文本（字节）并将它们转换为可读文本。我希望这能澄清我想要实现的目标。

PS：对不起，没有评论，但我认为它足够短，可以理解

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T15:08:32.640

你到底想达到什么目的？UTF-8（和所有其他`Encoding`s）是一种将字符串转换为字节数组（文本到原始数据）的方法，反之亦然。`StreamReader`并`StreamWriter`用于从/向文件读取/写入*字符串。*无需在那里重新编码任何东西。只需使用`reader.ReadToEnd()`将返回正确的字符串。

您的一段代码似乎试图编写一个包含与给定文本的 UTF-8 字节相对应的数字列表（作为可读的文本表示形式）的文件。好的。尽管这是一个非常奇怪的想法（我希望你不要试图用它来做任何“加密”之类的事情。），如果这确实是你想要做的，这绝对是可能的。但是您需要以某种方式分隔可读的数字，例如通过换行符，并在读回它们时对其进行解析：

```
public static void Encode(string path)
{
    byte[] bytes;
    using (var sr = new StreamReader(path))
    {
        var text = sr.ReadToEnd();
        bytes = Encoding.UTF8.GetBytes(text);
    }
    using (var sw = new StreamWriter(path))
    {
        foreach (byte b in bytes)
        {
            sw.WriteLine(b);
        }
    }
}

public static void Decode(string path)
{
    var data = new List<byte>();
    using (var sr = new StreamReader(path))
    {
        string line;
        while((line = sr.ReadLine()) != null)
            data.Add(Byte.Parse(line));
    }
    using (var sw = new StreamWriter(path))
    {
        sw.Write(Encoding.UTF8.GetString(data.ToArray()));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:53:24.560

此代码会将加密的字符串解码为文本，它对我有用。

```
public static String Decode(string Path)
    {
        String text;
        using (StreamReader sr = new StreamReader(Path))
        {
                text = st.ReadToEnd();
                byte[] bytes = Convert.FromBase64String(text);
                System.Text.UTF8Encoding encoder = new System.Text.UTF8Encoding();
                System.Text.Decoder decoder = encoder.GetDecoder();
                int count = decoder.GetCharCount(bytes, 0, bytes.Length);
                char[] arr = new char[count];
                decoder.GetChars(bytes, 0, bytes.Length, arr, 0);
                text= new string(arr);

                return text;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T15:03:19.667

该类将为您处理解码，因此您的[`StreamReader`方法](http://msdn.microsoft.com/library/system.io.streamreader.aspx)`Decode()`可以像这样简单：

```
public static string Decode(string path)
{
    // This StreamReader constructor defaults to UTF-8
    using (StreamReader reader = new StreamReader(path))
        return reader.ReadToEnd();
} 
```

我不确定您的`Encode()`方法应该做什么，因为其意图似乎是将文件读取为 UTF-8，然后将文本写回与 UTF-8 完全相同的文件。这样的事情可能更有意义：

```
public static void Encode(string path, string text)
{
    // This StreamWriter constructor defaults to UTF-8
    using (StreamWriter writer = new StreamWriter(path))
        writer.Write(text);
} 
```

# php - 在单个查询中合并到两个表以对数据进行排序

> ID：12623552
> 
> 赞同：2
> 
> 时间：2012-09-27T14:19:14.150
> 
> 标签：php, mysql, sql

我有两张桌子`word_term_relationships`和`word_posts`

我正在做的是使用`while`循环来从`word_term_relationships`表中获取某个值为真的某个记录。

```
$query = "SELECT object_id 
          FROM `word_term_relationships` 
          WHERE `term_taxonomy_id` = '54'"; 
```

然后我在循环中使用另一个查询来使用从上一个查询中检索到的数据，以便从另一个表中获取数据`word_posts`

```
$query2 = "SELECT post_title, post_date, post_date_gmt, guid 
           FROM `word_posts` 
           WHERE `ID` = '$post_id'"; 
```

我可以做到这一点并且工作正常。

唯一的问题是我需要按日期和时间对结果进行排序，我可以在没有`while`循环的情况下使用`ORDER BY`函数和`word_posts`表格来执行此操作。

但是，我尝试像这样（如下）在查询中链接表，以便对数据进行排序。但显然这是不正确的——我只是无法在查询中查明出了什么问题。

```
$query = "SELECT word_term_relationships.object_id 
          FROM word_term_relationships 
          WHERE word_term_relationships.term_taxonomy_id = '54' 
          ORDER BY word_posts.post_date ASC"; 
```

我知道上面的查询缺少一些东西，我`where`在`ORDER BY word_posts.post_date ASC`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:22:07.517

一个简单的`INNER JOIN`就可以解决你的问题。试试这个，

```
SELECT a.post_title, 
       a.post_date, 
       a.post_date_gmt, 
       a.guid 
FROM   word_posts a 
       INNER JOIN word_term_relationships b
           ON a.ID = b.object_id
WHERE  b.term_taxonomy_id= '54'
ORDER BY a.post_date ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:23:51.117

```
$query = "SELECT post_title
               , post_date
               , post_date_gmt
               , guid
          FROM word_posts a INNER JOIN word_term_relationships b on a.ID = b.object_id
          WHERE term_taxonomy_id = '54'
          ORDER BY a.post_date ASC"; 
```

# arrays - 使用 MongoDB，当元素位置未知时，如何更新子数组的子文档？

> ID：12623554
> 
> 赞同：0
> 
> 时间：2012-09-27T14:19:20.453
> 
> 标签：arrays, mongodb

我正在尝试更新子数组的子文档，但我不能指望元素在数组中的位置始终相同，那么我该如何更新它。

例如，这是我的文档，我只想将另一个标签对象（key/val）推送到pdf的`tags`数组：1和`real_pagenum``_id``ObjectId("50634e26dc7c22c64d00000a")`

```
{
    "_id" : ObjectId("503b83dfad79cc8d26000004"),
    "pdfs" : [
        {
            "_id" : ObjectId("50634e26dc7c22c64d00000a"),
            "pages" : [
                {
                    "real_pagenum" : 1,
                    "_id" : ObjectId("50634e74dc7c22c64d00002b"),
                    "tags" : [
                        {
                            "key" : "Item",
                            "val" : "foo"
                        },
                        {
                            "key" : "Item",
                            "val" : "bar"
                        }

                    ]

                },
                {
                    "real_pagenum" : 2,
                    "_id" : ObjectId("50634e74dc7c22c64d00002b")
                }
            ],
            "title" : "PDF3",
            "version" : 3
        }
    ],
} 
```

重申一下，目标是首先定位正确的 pdf by `_id`，然后是正确的 page by`real_pagenum`并推入该 pdf 的页面`tags`数组。

我试过：

```
db.projects.update({'pdfs.pdf_id':ObjectId("50634e25dc7c22c64d000007")},
    {$push:{'pages.$.tags':{'key':'foo','val':'bar'}}},false,false); 
```

但这并没有达到我需要的水平。我读过我可以使用[位置运算符与实际元素位置的组合](https://stackoverflow.com/questions/10341151/mongodb-update-deep-array)，但同样，我不能保证或知道元素的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:14:46.963

目前这是不可能的。您只能使用位置运算符寻址文档树中的最高级别数组。只有知道确切的元素位置，才能访问任何更深的数组。

这是当前一个未解决的问题：[https ://jira.mongodb.org/browse/SERVER-831](https://jira.mongodb.org/browse/SERVER-831)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:15:41.863

位置运算符不能用于嵌套数组是 mongodb 中当前提交的错误：

[https://jira.mongodb.org/browse/SERVER-831](https://jira.mongodb.org/browse/SERVER-831)

位置运算符也不能在一个查询中多次使用，暂时。

在您的情况下处理此问题的最佳方法可能是更改您的架构。一般来说，在文档中包含会增长到任意大小的数组并不是一个好主意，因为 BSON 文档的最大大小为 16mb。

特别是因为在这种情况下，您的文档似乎基本上只是一个 pdf 数组。您是否考虑过为 pdf 创建单独的集合？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T15:45:17.693

就对文档进行原子更新而言，其他答案是正确的。

我非常同意这看起来不是最佳模式 - 每个 pdf 的文档可能更有意义，然后您在每个文档中只有一个页面数组，您可以使用位置运算符进行原子更新。

如果您无法修改架构，您仍然可以进行所需的更新，但它可能不是线程安全的。您可以将整个文档读入您的应用程序，修改代码中的相应字段，然后保存该项目。如果您想确保多个线程不会相互踩踏，您必须在每个文档中保留一个版本并在每次“更新”时增加它，这取决于版本没有同时更改. 它更复杂，它仍然需要当前模式中的附加字段，但至少它允许您执行您声明需要执行的操作。

# c# - 带有可空 int 的总和的 Linq

> ID：12623555
> 
> 赞同：2
> 
> 时间：2012-09-27T14:19:21.577
> 
> 标签：c#, .net, linq

我正在尝试使用 Linq 计算可空 int 的总和。我的查询如下所示：

```
int? surveysPromotersFromChatsGroup = (from surveyResult in surveyResultsFromChats
                                            where surveyResult.FirstScoreNPS.HasValue && surveyResult.GroupID == gr && surveyResult.FirstScoreNPS >= 9
                                            select surveyResult.FirstScoreNPS).Sum(); 
```

FirstScoreNPs 字段是一个可为空的 int。我的问题是总和总是返回 null 无论如何。我看不出这背后的逻辑。我检查并确定某些实体在该字段中确实具有值，并且 sum 方法应该总结这些值。

我尝试的另一种方法是这样的：

```
int surveysPromotersFromChatsGroup = (from surveyResult in surveyResultsFromChats
                                      where surveyResult.FirstScoreNPS.HasValue && surveyResult.GroupID == gr && surveyResult.FirstScoreNPS >= 9
                                      select surveyResult.FirstScoreNPS).Sum(score => score.Value); 
```

但我得到一个异常“linq null 值不能分配给具有类型的成员”。

没有办法使用 linq 总结该字段中的非空值吗？

surveyResultsFromChat 实际上来自另一个查询：

```
 var surveyResultsFromChats = from surveyResult in db.SurveyResults
                                    join survey in db.Surveys on surveyResult.SurveyID equals survey.SurveyID
                                    join userGroup in db.UserGroupMaps on surveyResult.UserID equals userGroup.UserID
                                    where surveyResult.CreatedDate >= startDate && surveyResult.CreatedDate <= endDate && surveyResult.UserID.HasValue && surveyResult.ChatSessionID.HasValue
                                    select new { surveyResult.ResultID, survey.BrandID, userGroup.GroupID, surveyResult.CompletedDate, surveyResult.FirstScoreNPS }; 
```

我的模型中的 FirstScoreNPS 是一个 Nullable int。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T14:24:52.143

你可以试试

```
(from surveyResult in
 surveyResultsFromChats
where surveyResult.FirstScoreNPS.HasValue && surveyResult.GroupID == gr && 
surveyResult.FirstScoreNPS >= 9
   select surveyResult.FirstScoreNPS).
Select(score => score.Value ?? 0).Sum(); 
```

# forms - 如果 isset 在 php 中不起作用

> ID：12623556
> 
> 赞同：0
> 
> 时间：2012-09-27T14:19:23.543
> 
> 标签：forms, post, isset

我有一个只有一个提交按钮的表单。我不知道为什么，但是当我使用此代码并单击提交按钮时，什么也没有发生。如果我使用 ! 在 isset 之前，您会在页面中看到回声。我不知道它有什么问题。

```
<form>
    <input type="submit" value="Toevoegen" name="addImg" />
</form>
<?
    if (isset($_POST['addImg'])) {echo "haaallloooo";}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:23:38.860

也许，表单默认是通过get发送变量，尝试在表单标签中使用method="POST"属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:26:19.097

您必须将方法设置为 POST。

否则，您可以使用：

`$_REQUEST['addImg']`

该变量`$_REQUEST`可以同时访问`GET`和`POST`参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:38:33.223

形式需要一个动作和一个方法。

```
<form action="" method="post">
    <input type="submit" value="Toevoegen" name="addImg" />
</form>
<?
    if (isset($_POST['addImg'])) {echo "haaallloooo";}
?> 
```

关于“isset”，如果 $_POST['addImg'] 没有设置，它不会回显“haaallloooo”。

> isset — 确定变量是否已设置且不为 NULL

检查[http://hk.php.net/manual/en/function.isset.php](http://hk.php.net/manual/en/function.isset.php)

# regex - 谷歌分析正则表达式

> ID：12623559
> 
> 赞同：0
> 
> 时间：2012-09-27T14:19:40.047
> 
> 标签：regex, google-analytics

对 Rgeluar 表达式有点陌生，为了学习，想知道如何在一行中执行以下操作：

页面匹配正则表达式：.pdf/$

和包含“somestring”的页面

和不包括“someotherstring”的页面

我可以使用上面的 3 条规则获得我想要的输出。我的问题是我可以使用正则表达式将所有内容放在一行中吗？所以第一行是这样的：

```
page matching reg exp: .pdf/$ somestring+ (then regex for does not contain in GA) someotherstring 
```

是否可以将所有内容放在一个中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:31:12.523

[Lookahead](http://www.regular-expressions.info/lookaround.html)将帮助您在一个表达式中匹配多个独立的事物，甚至允许要求不匹配。在你的情况下：

```
/^(?=.*somestring)(?!.*someotherstring).*\.pdf$/ 
```

# java - Joda MutableDateTime 的 setDate(DateTime) 方法是如何工作的？

> ID：12623566
> 
> 赞同：0
> 
> 时间：2012-09-27T14:20:14.730
> 
> 标签：java, jodatime

我有一个测试：

```
@Test
public void testJodaStartDate2a() {

    DateTime dateTime = new DateTime(2010,10,10,4,0, DateTimeZone.forID("America/Caracas"));

    MutableDateTime mutableDateTime = dateTime.toMutableDateTime();
    mutableDateTime.setDate(dateTime);
    assertEquals(dateTime, mutableDateTime.toDateTime());
} 
```

这很简单，在其中我想将 dateTime 值的日期部分设置为 dateTime 值的日期部分，这应该是有效的，并且断言应该成功。然而它失败了。

由于我无法调试 Joda 的方法，我创建了另一个测试，它模拟 setDate() 必须执行的操作：

```
@Test
public void testJodaStartDate() {

    DateTime dateTime = new DateTime(2010,10,10,4,0, DateTimeZone.forID("America/Caracas"));

    long instantMillis = DateTimeUtils.getInstantMillis(dateTime);
    Chronology instantChrono = DateTimeUtils.getInstantChronology(dateTime);
    DateTimeZone zone1 = instantChrono.getZone();
    if (zone1 != null) {
        instantMillis = zone1.getMillisKeepLocal(DateTimeZone.UTC, instantMillis);
    }

    MutableDateTime mutableDateTime = dateTime.toMutableDateTime();
    mutableDateTime.setMillis(mutableDateTime.getChronology().millisOfDay().set(instantMillis,
                                                                                mutableDateTime.getMillisOfDay()));
    assertEquals(dateTime, mutableDateTime);
} 
```

此测试是 setDate() 内容的副本。正如我在调试过程中看到的那样，起初，之后

```
long instantMillis = DateTimeUtils.getInstantMillis(dateTime); 
```

InstantMillis 变量的值是 1286699400000，即 2010-10-10 04:00 (VET) 和 2010-10-10 08:30 (UTC)。

后

```
instantMillis = zone1.getMillisKeepLocal(DateTimeZone.UTC, instantMillis); 
```

InstantMillis 是 1286683200000，即 2010-10-10 00:00 (VET) 和 2010-10-10 04:00 (UTC)。

**在断言中， mutableDateTime**的毫秒值为 1286613000000，即 2010-10-09 **04:00** (VET) 和 2010-10-09 08:30 (UTC)。

 **这个函数不应该只是将 mutableDateTime 的日期部分重新计算为参数值的日期部分吗？我在测试中缺少什么？我非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:52:27.230

您似乎发现了一个错误。

以下行是错误的——它应该使用`this`正在使用的时区。

```
instantMillis = zone1.getMillisKeepLocal(DateTimeZone.UTC, instantMillis); 
```

快速搜索没有发现当前的错误。我已经提交了一个（[在这里](https://sourceforge.net/tracker/?func=detail&aid=3572478&group_id=97367&atid=617889)）。

我跑了一些测试来检查这次哪些时区有问题。基本上，当给定时区的日期与 UTC 的日期不同时（在同一时刻），似乎会出现问题。

```
@Test
public void minus0401() {
    DateTime dateTime = new DateTime("2010-10-10T04:00:00",
            DateTimeZone.forOffsetHoursMinutes(-4, 1));
    testDate(dateTime);
}

@Test
public void testIds() {
    List<String> failedIds = new ArrayList<>();
    for (String id : DateTimeZone.getAvailableIDs()) {
        DateTime dateTime = new DateTime("2010-10-10T04:00:00",
                DateTimeZone.forID(id));
        try {
            testDate(dateTime);
        } catch (AssertionError e) {
            failedIds.add(id);
        }
    }
    assertEquals(failedIds.toString(), 0, failedIds.size());
}

@Test
public void testHours() {
    List<Integer> failedHours = new ArrayList<>();
    for (int i = -12; i < 12; i++) {
        DateTime dateTime = new DateTime("2010-10-10T04:00:00",
                DateTimeZone.forOffsetHours(i));
        try {
            testDate(dateTime);
        } catch (AssertionError e) {
            failedHours.add(i);
        }
    }
    assertEquals(failedHours.toString(), 0, failedHours.size());
}

private void testDate(DateTime dateTime) {
    MutableDateTime mutableDateTime = dateTime.toMutableDateTime();
    mutableDateTime.setDate(dateTime);
    assertEquals(dateTime, mutableDateTime.toDateTime());
} 
```**

# python - 对数对数图的多项式拟合

> ID：12623571
> 
> 赞同：1
> 
> 时间：2012-09-27T14:20:37.783
> 
> 标签：python, matplotlib, scipy

我有一个简单的问题是在对数刻度上拟合一条直线。我的代码是，

```
data=loadtxt(filename)
xdata=data[:,0]
ydata=data[:,1]
polycoeffs = scipy.polyfit(xdata, ydata, 1)
yfit = scipy.polyval(polycoeffs, xdata)
pylab.plot(xdata, ydata, 'k.')
pylab.plot(xdata, yfit, 'r-') 
```

现在我需要在对数刻度上绘制拟合线，所以我只需更改 x 和 y 轴，

```
ax.set_yscale('log')
ax.set_xscale('log') 
```

然后它没有绘制正确的拟合线。那么如何更改拟合函数（以对数刻度）以便它可以在对数刻度上绘制拟合线？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:24:34.893

编辑：

```
from scipy import polyfit
data = loadtxt("data.txt")
xdata,ydata = data[:,0],data[:,1]
xdata,ydata = zip(*sorted(zip(xdata,ydata))) # sorts the two lists after the xdata    

xd,yd = log10(xdata),log10(ydata)
polycoef = polyfit(xd, yd, 1)
yfit = 10**( polycoef[0]*xd+polycoef[1] )

plt.subplot(211)
plt.plot(xdata,ydata,'.k',xdata,yfit,'-r')
plt.subplot(212)
plt.loglog(xdata,ydata,'.k',xdata,yfit,'-r')
plt.show() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T09:57:02.700

你要

`log(y) = k log(x) + q`， 所以

`y = exp(k log(x) + q) = exp(k log(x)) * exp(q) = exp(log(x^k)) * exp(q) = A x^k`

如您所见，一个要求是`y(0) = 0`.

从代码的角度来看，您仅使用数据的 x 绘制拟合函数，可能最好添加点：

```
xfit = scipy.linspace(min(xdata), max(xdata), 50)
yfit = scipy.polyval(polycoeffs, xfit)
ax.plot(xfit, yfit, 'r-') 
```

# c# - 我可以使用 Outlook 2003 互操作读取 .msg 文件及其嵌入的图像吗

> ID：12623572
> 
> 赞同：2
> 
> 时间：2012-09-27T14:20:43.027
> 
> 标签：c#, outlook-2003

我想通过在 C# 中使用 Microsoft.Office.Interop.Outlook 2003 加载**.msg 文件来****读取附件和嵌入图像**。基本上我想阅读电子邮件，然后将这些图像作为电子邮件转发，就像您通常在 Outlook 中转发电子邮件一样，您会获得电子邮件中的所有图像。我找到了使用 Office 2007 及更高版本阅读附件的文章，但我有 Outlook 2003。所以我想知道如何使用 Interop 在 Outlook 2003 中做到这一点？

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:45:00.093

你可以参考这个微软链接： http: [//msdn.microsoft.com/en-us/library/aa289167 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa289167(v=vs.71).aspx)

从所需消息中获得参考后，您可以提取图像。您可以使用 Outlook 互操作创建消息并附加图像，也可以使用 System.Net.Mail.MailMessage 发送和通过电子邮件发送附件。

希望这可以帮助。**

# entity-framework - 实体框架：流畅的 API。我应该如何映射这种关系？

> ID：12623573
> 
> 赞同：0
> 
> 时间：2012-09-27T14:20:44.633
> 
> 标签：entity-framework, ef-code-first

我的表如下：

```
create table Entities(
    EntityId bigint not null identity(1, 1),
    Name nvarchar(64) not null,
    ParentEntityId bigint null
)
alter table Entities add constraint PK primary key (EntityId)
alter table Entities add constraint FK foreign key (ParentEntityId) references Entities(EntityId) 
```

我的模型如下所示：

```
public class Entity
{
    [Required]
    public virtual long EntityId { get; set; }

    [Required]
    public virtual string Name { get; set; }

    public virtual long? ParentEntityId { get; set; }

    public virtual Entity ParentEntity { get; set; }
} 
```

我正在尝试`ParentEntity`使用流利的 api 映射来映射属性，但我无法让它工作。我该怎么做？
提前致谢！

编辑：固定代码差异。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:54:49.267

这种流利的东西会为你工作：

```
 modelBuilder.Entity<Entity>()
            .HasOptional(e => e.ParentEntity)
            .WithMany()
            .HasForeignKey(e => e.ParentEntityId ); 
```

为我创建了这个数据库：

![在此处输入图像描述](../Images/343bee25d9d59c34ac0a1bb085df6b1b.png)

# c++ - 在我的机器上操作大向量时，CUDA 推力很慢

> ID：12623574
> 
> 赞同：6
> 
> 时间：2012-09-27T14:20:46.180
> 
> 标签：c++, c, cuda, thrust

我是一个 CUDA 初学者，正在阅读一些推力教程。我编写了一个简单但组织得非常糟糕的代码，并试图弄清楚推力的加速度。（这个想法正确吗？）。我尝试通过在 cpu 上添加数组并在 gpu 上添加 device_vector 来将两个向量（具有 10000000 int）添加到另一个向量。

事情是这样的：

```
#include <iostream>
#include "cuda.h"
#include "cuda_runtime.h"
#include "device_launch_parameters.h"
#include <thrust/device_vector.h>
#include <thrust/host_vector.h>

#define N 10000000
int main(void)
{
    float time_cpu;
    float time_gpu;
    int *a = new int[N];
    int *b = new int[N];
    int *c = new int[N];
    for(int i=0;i<N;i++)
    {
        a[i]=i;
        b[i]=i*i;
    }
    clock_t start_cpu,stop_cpu;
    start_cpu=clock();
    for(int i=0;i<N;i++)
    {
        c[i]=a[i]+b[i];
    }
    stop_cpu=clock();   
    time_cpu=(double)(stop_cpu-start_cpu)/CLOCKS_PER_SEC*1000;
    std::cout<<"Time to generate (CPU):"<<time_cpu<<std::endl;
    thrust::device_vector<int> X(N);
    thrust::device_vector<int> Y(N);
    thrust::device_vector<int> Z(N);
    for(int i=0;i<N;i++)
    {
        X[i]=i;
        Y[i]=i*i;
    }
    cudaEvent_t start, stop;
    cudaEventCreate(&start);
    cudaEventCreate(&stop);
    cudaEventRecord(start,0);       
    thrust::transform(X.begin(), X.end(),
        Y.begin(),
        Z.begin(),
        thrust::plus<int>());
    cudaEventRecord(stop,0);
    cudaEventSynchronize(stop);
    float elapsedTime;
    cudaEventElapsedTime(&elapsedTime,start,stop);
    std::cout<<"Time to generate (thrust):"<<elapsedTime<<std::endl;
    cudaEventDestroy(start);
    cudaEventDestroy(stop); 
    getchar();
    return 0;
} 
```

CPU 结果看起来真的很快，但是 gpu 在我的机器上运行真的很慢（i5-2320,4G,GTX 560 Ti），CPU 时间大约是 26，GPU 时间大约是 30！我只是在代码中犯了愚蠢的错误吗？还是有更深层次的原因？

作为一个 C++ 菜鸟，我一遍又一遍地检查我的代码，但在 GPU 上的推力仍然很慢，所以我做了一些实验来展示用五种不同方法计算 vectorAdd 的区别。我使用 windows API`QueryPerformanceFrequency()`作为统一的时间测量方法。

每个实验看起来像这样：

```
f = large_interger.QuadPart;  
QueryPerformanceCounter(&large_interger);  
c1 = large_interger.QuadPart; 

for(int j=0;j<10;j++)
{
    for(int i=0;i<N;i++)//CPU array adding
    {
        c[i]=a[i]+b[i];
    }
}
QueryPerformanceCounter(&large_interger);  
c2 = large_interger.QuadPart;  
printf("Time to generate (CPU array adding) %lf ms\n", (c2 - c1) * 1000 / f); 
```

这是我添加 GPU 数组的简单`__global__`函数：

```
__global__ void add(int *a, int *b, int *c)
{
    int tid=threadIdx.x+blockIdx.x*blockDim.x;
    while(tid<N)
    {
        c[tid]=a[tid]+b[tid];
        tid+=blockDim.x*gridDim.x;
    }
} 
```

该函数被称为：

```
for(int j=0;j<10;j++)
{
    add<<<(N+127)/128,128>>>(dev_a,dev_b,dev_c);//GPU array adding
} 
```

我将向量 a[N] 和 b[N] 添加到向量 c[N] 中，循环 10 次：

1.  在 CPU 上添加数组
2.  在 CPU 上添加 std::vector
3.  在 CPU 上添加推力::host_vector
4.  在 GPU 上添加推力::device_vector
5.  在 GPU 上添加数组。这是结果

N=10000000

我得到了结果：

1.  CPU阵列增加268.992968ms
2.  CPU std::vector 添加 1908.013595ms
3.  CPU Thrust::host_vector 添加 10776.456803ms
4.  GPU Thrust::device_vector 添加 297.156610ms
5.  GPU阵列增加5.210573ms

这让我很困惑，我不熟悉模板库的实现。容器和原始数据结构之间的性能真的差别很大吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-27T15:25:48.467

Most of the execution time is being spent in your loop that is initializing X[i] and Y[i]. While this is legal, it's a *very* slow way to initialize large device vectors. It would be better to create host vectors, initialize them, then copy those to the device. As a test, modify your code like this (right after the loop where you are initializing the device vectors X[i] and Y[i]):

```
}  // this is your line of code
std::cout<< "Starting GPU run" <<std::endl;  //add this line
cudaEvent_t start, stop;   //this is your line of code 
```

You will then see that the GPU timing results appear almost immediately after that added line prints out. So all of the time you're waiting is spent in initializing those device vectors directly from host code.

When I run this on my laptop, I get a CPU time of about 40 and a GPU time of about 5, so the GPU is running about 8 times faster than the CPU for the sections of code you are actually timing.

If you create X and Y as host vectors, and then create analogous d_X and d_Y device vectors, the overall execution time will be shorter, like so:

```
thrust::host_vector<int> X(N);     
thrust::host_vector<int> Y(N);     
thrust::device_vector<int> Z(N);     
for(int i=0;i<N;i++)     
{     
    X[i]=i;     
    Y[i]=i*i;     
}   
thrust::device_vector<int> d_X = X;
thrust::device_vector<int> d_Y = Y; 
```

and change your transform call to:

```
thrust::transform(d_X.begin(), d_X.end(),      
    d_Y.begin(),      
    Z.begin(),      
    thrust::plus<int>()); 
```

OK so you've now indicated that the CPU run measurement is faster than the GPU measurement. Sorry I jumped to conclusions. My laptop is an HP laptop with a 2.6GHz core i7 and a Quadro 1000M gpu. I'm running centos 6.2 linux. A few comments: if you're running any heavy display tasks on your GPU, that can detract from performance. Also, when benchmarking these things it's common practice to use the same mechanism for comparison, you can use cudaEvents for both if you want, it can time CPU code the same as GPU code. Also, it's common practice with thrust to do a warm up run that is untimed, then repeat the test for a measurement, and likewise it's common practice to run the test 10 times or more in a loop, then divide to get an average. In my case, I can tell the clocks() measurement is pretty coarse because successive runs will give me 30, 40 or 50\. On the GPU measurement I get something like 5.18256\. Some of these things may help, but I can't say exactly why your results and mine differ so much (on the GPU side).

OK I did another experiment. The compiler will make a big difference on CPU side. I compiled with -O3 switch and the CPU time dropped to 0\. Then I converted the CPU timing measurement from the clocks() method to cudaEvents, and I got a CPU measured time of 12.4 (with -O3 optimization) and still 5.1 on GPU side.

Your mileage will vary based on timing method and which compiler you are using on the CPU side.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:39:24.510

首先，`Y[i]=i*i;`不适合 10M 个元素的整数。整数大约包含 1e10，而您的代码需要 1e14。

其次，看起来转换的时间是正确的，并且应该比 CPU 更快，无论您使用的是哪个库。Robert 建议在 CPU 上初始化向量，然后传输到 GPU，这对于这种情况来说是一个很好的建议。

第三，由于我们不能做整数倍数，下面是一些更简单的 CUDA 库代码（使用我工作的[ArrayFire](http://accelereyes.com/arrayfire)）来做类似的浮点数，用于您的基准测试：

```
int n = 10e6;
array x = array(seq(n));
array y = x * x;
timer t = timer::tic();
array z = x + y;
af::eval(z); af::sync();
printf("elapsed seconds: %g\n", timer::toc( t)); 
```

祝你好运！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-20T17:36:24.320

我最近在我的 Quadro 1000m 上使用 CUDA Thrust 进行了类似的测试。我使用thrust::sort_by_key作为基准来测试它的性能，结果太好了以至于不能说服我的嘘声。排序512MB对需要100+ms。

对于您的问题，我对两件事感到困惑。

(1) 为什么你将这个 time_cpu 乘以 1000？没有1000，它已经在几秒钟内。

```
time_cpu=(double)(stop_cpu-start_cpu)/CLOCKS_PER_SEC*1000; 
```

(2) 而且，提到 26、30、40，您是指秒还是毫秒？'cudaEvent' 报告以 'ms' 而非 's' 为单位的经过时间。

# r - 将坐标多边形内的区域转换为米

> ID：12623577
> 
> 赞同：1
> 
> 时间：2012-09-27T14:20:51.607
> 
> 标签：r, gis

给定一组坐标

```
 lat <- c(47.2325618, 47.2328269, 47.2330041, 47.2330481, 47.2330914, 
          47.2331172, 47.2331291, 47.2331499)
 lon <- c(11.3707441, 11.3707791, 11.3708087, 11.3708031, 11.3707818, 
          11.3707337, 11.3706588, 11.370284)
coords <- cbind(lon,lat) 
```

我想计算多边形的面积。我使用`areapl()`package *splancs*中的函数：

```
library(splancs)
areapl(coords)
# [1] 1.4768e-07 
```

这给我留下了一个以度为单位的维度（？）。所以我的问题是：我**如何将其转换为米/公里？**

提前非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T15:03:04.407

`spTransform`在包中使用转换为笛卡尔网格系统（例如 UTM 区域） ，或在包`sp`中尝试。`areaPolygon``geosphere`

```
> areaPolygon(coords)
[1] 7688.568 
```

# c++ - basic_string 分配器

> ID：12623580
> 
> 赞同：2
> 
> 时间：2012-09-27T14:21:01.917
> 
> 标签：c++, reverse-engineering

我想知道这是做什么的：

```
std::basic_string<char, std::char_traits<char>, std::allocator<char>>::
basic_string<char, std::char_traits<char>, std::allocator<char>>
(&myText, "hello world"); 
```

我的第一个猜测是，如果这是真的，它会将“hello world”分配给一个`myText`变量，那么在这种情况下它会做什么：

```
 if ( v106 == v67 || 
  std::basic_string<char, std::char_traits<char>, std::allocator<char>>::
  basic_string<char, std::char_traits<char>, std::allocator<char>>
  (&v109,"program"), v137 = 1)
  {
    BYTE3(v95) = 0;
  } 
```

这不是一个真正的条件......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:39:14.640

我猜这是来自 Hex-Ray 的 IDA 反编译器插件的输出，对吗？这是它显示`std::string`类的构造函数调用的方式。`v109`是分配在堆栈上以保存`std::string`实例的内存，而第二个参数`"hello world"`是用于初始化它的字符串。

在多个条件导致相同结果代码的情况下，编译器通常选择重用来自先前条件的（等效）代码片段以最小化生成的字节码的大小。Hex-Ray 的反编译器插件通常使用[Comma-operator](http://en.wikipedia.org/wiki/Comma_operator)显示它们，直到 1.5 版本 - 较新版本的反编译器[对这种情况有更好的理解](http://www.hex-rays.com/products/decompiler/v16_vs_v15.shtml#2)。

```
if (v106 == v67)
    BYTE3(v95) = 0;

std::basic_string<char, std::char_traits<char>,
                  std::allocator<char>>
                  ::basic_string<char, 
                      std::char_traits<char>, 
                      std::allocator<char>>(&v109,"program");
v137 = 1;
BYTE3(v95) = 0; 
```

这更有可能看起来像实际来源。`std::basic_string<...>`用简单的声明替换巨大的构造`std::string`使其更具可读性。

```
if (v106 == v67)
    BYTE3(v95) = 0;

std::string v109("program");
v137 = 1;
BYTE3(v95) = 0; 
```

# c# - Silverlight Prism 在加载时无法解析模块，但并非总是如此

> ID：12623582
> 
> 赞同：1
> 
> 时间：2012-09-27T14:21:03.807
> 
> 标签：c#, silverlight, prism

我正在使用 prism 4.1 和 mef 来开发前台应用程序，但我遇到了问题。有时在模块加载过程中，应用程序会因异常而失败

> 无法加载文件或程序集“Sl.Common.Model，版本 = 1.0.0.0，文化 = 中性，PublicKeyToken = null”或其依赖项之一。找不到指定的文件。

模块具有依赖关系（AuditModule 和 LoadersModule 依赖于 CommonModule）。

```
<Modularity:ModuleCatalog xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
                          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
                          xmlns:sys="clr-namespace:System;assembly=mscorlib" 
                          xmlns:Modularity="clr-namespace:Microsoft.Practices.Prism.Modularity;assembly=Microsoft.Practices.Prism">

<!-- language: lang-xml -->    
    <Modularity:ModuleInfo  Ref="Sl.Common.Model.xap" InitializationMode="WhenAvailable" ModuleName="CommonModule"/>
    <Modularity:ModuleInfo Ref="Sl.Loaders.xap" ModuleName="LoadersModule">
        <Modularity:ModuleInfo.DependsOn>
            <sys:String>CommonModule</sys:String>
        </Modularity:ModuleInfo.DependsOn>
    </Modularity:ModuleInfo>
    <Modularity:ModuleInfo Ref="Sl.Audit.xap" ModuleName="AuditModule">
        <Modularity:ModuleInfo.DependsOn>
            <sys:String>CommonModule</sys:String>
        </Modularity:ModuleInfo.DependsOn>
    </Modularity:ModuleInfo>

</Modularity:ModuleCatalog> 
```

应用程序有时可以正常启动，但是当 AuditModule 或 LoadersModule 由于“CommonModule”而无法解决时，我遇到了一个问题，上面描述了异常。

```
public class Bootstrapper : MefBootstrapper
{
    private const string ModuleCatalogUri = "/ModerationSlUserInteface;component/ModulesCatalog.xaml";

    protected override void ConfigureAggregateCatalog()
    {
        base.ConfigureAggregateCatalog();
        this.AggregateCatalog.Catalogs.Add(new AssemblyCatalog(typeof(Bootstrapper).Assembly));
        this.AggregateCatalog.Catalogs.Add(new AssemblyCatalog(typeof(StackPanelRegionAdapter).Assembly));
    }

    protected override IModuleCatalog CreateModuleCatalog()
    {
        var catalog = Microsoft.Practices.Prism.Modularity.ModuleCatalog.CreateFromXaml(new Uri(ModuleCatalogUri, UriKind.Relative));
        return catalog;
    }

    protected override DependencyObject CreateShell()
    {
        return this.Container.GetExportedValue<Shell>();
    }

    protected override void InitializeShell()
    {

        //base.InitializeShell();
        Application.Current.RootVisual = (UIElement)this.Shell;
    }

    protected override RegionAdapterMappings ConfigureRegionAdapterMappings()
    {
        RegionAdapterMappings mappings = base.ConfigureRegionAdapterMappings();
        var stackPanelAdapterInstance = ServiceLocator.Current.GetInstance<StackPanelRegionAdapter>();
        mappings.RegisterMapping(typeof(StackPanel), stackPanelAdapterInstance);
        return mappings;
    }
} 
```

代码可以从[这里获取](https://docs.google.com/open?id=0B8c3ZPcCrhUjMnBZclNIOEc4YUE)

PS 在 Shell.xaml.cs 中，当我在 if (e.ModuleInfo.ModuleName == LoadersModuleName) 上打断点时

如果第一个模块是 CommonModule 则应用程序启动正常。否则它会例外。

```
[Export]
public partial class Shell : UserControl, IPartImportsSatisfiedNotification
{
    private const string LoadersModuleName = "LoadersModule";
    private static Uri LoadersViewUri = new Uri("/LoadersView", UriKind.Relative);

    public Shell()
    {
        this.InitializeComponent();
    }

    [Import(AllowRecomposition = false)]
    public IModuleManager ModuleManager;

    [Import(AllowRecomposition = false)]
    public IRegionManager RegionManager;

    public void OnImportsSatisfied()
    {
        this.ModuleManager.LoadModuleCompleted += (s, e) =>
        {
            if (e.ModuleInfo.ModuleName == LoadersModuleName)
            {
                this.RegionManager.RequestNavigate(RegionNames.MainRegion, LoadersViewUri);
            }
        };
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:46:58.960

我们发现您还必须将模块中的任何引用添加到入口点项目。

因此，如果您`Microsoft.Practices.Prism.UnityExtensions`在`AuditModule`（例如）中引用，那么您也需要添加对它的引用，`MainProject`即使它没有被`MainProject`.

# xslt - XPATH 选择整个树，仅包括第一个

> ID：12623586
> 
> 赞同：1
> 
> 时间：2012-09-27T14:21:13.900
> 
> 标签：xslt, xpath

给定以下结构，在 XPATH 中，我想选择整个树，但只包括第一个日期，因此排除所有其他日期。第一个日期之后的日期数不是恒定的。有任何想法吗？我很抱歉，格式不正确。

```
<A>
    <B>
        <DATE>04272011</DATE>
        <C>
           <D>
                <DATE>02022011</DATE>
           </D>
           <D>
                <DATE>03142011</DATE>
           </D>
        </C>
    </B>
</A> 
```

* * *

我的道歉。

一个更好的例子

`<NOTICES>`

`<SNOTE>`

```
 <DATE>01272011</DATE>
    <ZIP>35807</ZIP>
    <CLASSCOD>A</CLASSCOD>
    <EMAIL>
        <ADDRESS>address 1</ADDRESS>
    </EMAIL>
    <CHANGES>
        <MOD>
            <DATE>02022011</DATE>
            <MODNUM>12345</MODNUM>
            <EMAIL>
                <ADDRESS>address 2</ADDRESS>
            </EMAIL>
        </MOD>
        <MOD>
            <DATE>03022011</DATE>
            <MODNUM>56789</MODNUM>
            <EMAIL>
                <ADDRESS>address 3</ADDRESS>
            </EMAIL>
        </MOD>
    </CHANGES>
</SNOTE> 
```

`</NOTICES>`

我将一个大的 xml 文件分解成单独的 XML 文件。我原来的 XPATH 语句是

/通知/通知

每个单独的 xml 文件看起来都很好，除了它包含所有日期：这是我想要的输出。

`<SNOTE>`

```
<DATE>01272011</DATE>
<ZIP>35807</ZIP>
<CLASSCOD>A</CLASSCOD>
<EMAIL>
    <ADDRESS>address 1</ADDRESS>
</EMAIL>
<CHANGES>
    <MOD>
        <MODNUM>12345</MODNUM>
        <EMAIL>
            <ADDRESS>address 2</ADDRESS>
        </EMAIL>
    </MOD>
    <MOD>
        <MODNUM>56789</MODNUM>
        <EMAIL>
            <ADDRESS>address 3</ADDRESS>
        </EMAIL>
    </MOD>
</CHANGES> 
```

`</SNOTE>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:09:41.623

XPath 是一种用于 XML 文档的*查询*语言，因此它不能改变文档的结构（例如插入/删除/重命名节点）。

**您需要的是 XSLT 转换——就这么简单**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="DATE[preceding::DATE]"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<A>
    <B>
        <DATE>04272011</DATE>
        <C>
            <D>
                <DATE>02022011</DATE>
            </D>
            <D>
                <DATE>03142011</DATE>
            </D>
        </C>
    </B>
</A> 
```

**产生了想要的正确结果**：

```
<A>
   <B>
      <DATE>04272011</DATE>
      <C>
         <D/>
         <D/>
      </C>
   </B>
</A> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T16:06:29.513

如果“选择整个树”是指“选择树中所有节点的集合”（非第一个 DATE 元素除外），则可以这样做：

```
"//node()[not(self::DATE) or not(preceding::DATE)]" 
```

然后，非第一个`<DATE>`元素节点本身不会在所选节点集中，但所选节点集中的节点（例如根节点，或`<D>`）仍然有`<DATE>`后代。

相反，如果您想选择树（即根节点），或者更确切地说是它的修改版本，使得`<D>`元素没有任何子节点`<DATE>`，那么这需要修改树。XPath 不能自己修改 XML 树。您需要 XML 转换技术，例如 XSLT 或 XML DOM 库。

# json - 强制杰克逊映射器始终在 writeValue 上添加类类型而无需注释

> ID：12623600
> 
> 赞同：4
> 
> 时间：2012-09-27T14:21:45.447
> 
> 标签：json, jackson

是否可以将杰克逊配置为始终将序列化对象的类型添加到生成的 json 输出中。

例如：

```
package org.acme;

class ClassA
{
    String a;
    String b;
} 
```

我希望生成的 json 为： ["org.acme.ClassA",{"a":"str1","b":"str2"}]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-10T06:17:37.090

您可以使用 ObjectMapper 的 enableDefaultTyping() 来做到这一点

例如

```
mapper.enableDefaultTyping(DefaultTyping.OBJECT_AND_NON_CONCRETE); 
```

请参阅[ObjectMapper API](http://fasterxml.github.io/jackson-databind/javadoc/2.0.0/com/fasterxml/jackson/databind/ObjectMapper.html#enableDefaultTyping%28%29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-02T15:23:34.087

如果您可以自由地从 Jackson 更改并且不需要与您展示的格式相匹配的格式，您可以尝试 Genson [http://code.google.com/p/genson](http://code.google.com/p/genson)。

例如，如果您的要求是能够基于您序列化的对象的原始类型来反序列化接口或抽象类，您可以这样做：

```
interface Entity {}
static class Person implements Entity {}

Genson genson = new Genson.Builder().setWithClassMetadata(true).create();
// json will be equal to {"@class":"my.package.Person"}
String json = genson.serialize(new Person());

// and now Genson is able to deserialize it back to Person using the information 
// in the Json Object
Person person = (Person) genson.deserialize(json, Entity.class); 
```

另一个不错的功能是为您的类定义别名的能力，因此您在 json 流中显示的信息更少，但这也允许您进行重构而无需担心现有的 json 流（例如，如果您将其存储在数据库中）。

```
Genson genson = new Genson.Builder().addAlias("person", Person.class).create();
// json value is {"@class": "person"}
String json = genson.serialize(new Person()); 
```

看看[维基](http://code.google.com/p/genson/wiki/GettingStarted)。

# liferay - Liferay liferay-ui：搜索切换未显示（在搜索表单上）

> ID：12623602
> 
> 赞同：3
> 
> 时间：2012-09-27T14:21:54.113
> 
> 标签：liferay, search-form

我正在尝试为我的 portlet 创建一个搜索表单。portlet 是一个地址簿应用程序，所有 dao 和服务都使用服务构建器构建。我想为用户提供一个基本/高级搜索表单（就像 liferay 上的其他表单一样，例如控制中心的“用户和组织”。

我已经实现了查看 liferay 源代码（6.1 GA1）的所有逻辑和页面，但是搜索表单没有以任何方式显示，我将把代码放在这里。

在 view.jsp 中：

```
<%
PortletURL portletURL = renderResponse.createRenderURL();
portletURL.setParameter("jspPage", "/html/addressbookportlet/view.jsp");
pageContext.setAttribute("portletURL", portletURL);
String portletURLString = portletURL.toString();
%>

<aui:form action="<%= portletURLString %>" method="get" name="fm">
    <liferay-portlet:renderURLParams varImpl="portletURL" />
    <aui:input name="isSearch" type="hidden" value="true" />
    <aui:input name="redirect" type="hidden" value="<%= portletURLString %>" />

    <liferay-ui:search-container 
        searchContainer="<%= new ABContactSearch(renderRequest, portletURL) %>"
    >

        <% 
        ABContactDisplayTerms displayTerms = (ABContactDisplayTerms)searchContainer.getDisplayTerms();
        ABContactSearchTerms searchTerms = (ABContactSearchTerms)searchContainer.getSearchTerms();

        Long societyId = GetterUtil.getLong(searchTerms.getSocietyId(),0);
        Long contactTypeId = GetterUtil.getLong(searchTerms.getContactTypeId(), 0);
        Long brandId = GetterUtil.getLong(searchTerms.getBrandId(),0);
        Long channelId = GetterUtil.getLong(searchTerms.getChannelId(),0);
        %>

        <liferay-ui:search-form 
            searchContainer="<%=searchContainer%>" 
            servletContext="<%= this.getServletConfig().getServletContext() %>" 
            showAddButton="true"
            page='<%= request.getContextPath() + "/html/addressbookportlet/contact_search_form.jsp" %>'
        />

        <liferay-ui:search-container-results>
            <%

                if (searchTerms.isAdvancedSearch()) {
                    results = AddressbookSearchUtil.searchAdvanced(scopes, searchTerms, searchTerms.isAndOperator(), searchContainer.getStart(), searchContainer.getEnd()); //, searchContainer.getOrderByComparator());
                    total = AddressbookSearchUtil.countAdvanced(scopes, searchTerms, searchTerms.isAndOperator());
                }
                else {
                    results = AddressbookSearchUtil.searchFullText(scopes, searchTerms.getKeywords(), searchContainer.getStart(), searchContainer.getEnd()); //, searchContainer.getOrderByComparator());
                    total = AddressbookSearchUtil.countFullText(scopes, searchTerms.getKeywords());
                }
                pageContext.setAttribute("results", results);
                pageContext.setAttribute("total", total);
            %>

        </liferay-ui:search-container-results>

        <liferay-ui:search-container-row
            className="it.mir4unicomm.addressbook.model.ABContact"
            escapedModel="<%= true %>"
            keyProperty="contactId"
            modelVar="abcontact"
        >

            <liferay-ui:search-container-column-text 
                title="Surname"
                property="surname"
            />

            <liferay-ui:search-container-column-text 
                title="Name"
                property="name"
            />

            <liferay-ui:search-container-column-text 
                title="Position"
                property="position"
            />

        </liferay-ui:search-container-row>

        <liferay-ui:search-iterator />
    </liferay-ui:search-container>
</aui:form> 
```

contact_search_form.jsp：

```
<%@ include file="/html/addressbookportlet/init.jsp" %>

<%
the
ABContactDisplayTerms displayTerms = (ABContactDisplayTerms)searchContainer.getDisplayTerms();

List<ABSociety> societyList = ABSocietyLocalServiceUtil.getABSocieties(0, Integer.MAX_VALUE);
List<ABBrand> brandList = ABBrandLocalServiceUtil.getABBrands(0, Integer.MAX_VALUE);
List<ABContactType> contactTypeList = ABContactTypeLocalServiceUtil.getABContactTypes(0, Integer.MAX_VALUE);
List<ABChannel> channelList = ABChannelLocalServiceUtil.getABChannels(0, Integer.MAX_VALUE);
%>

<liferay-ui:search-toggle
    id="toggle_id_contact_search"
    displayTerms="<%= displayTerms %>"
    buttonLabel="search-contact"
>
    <aui:fieldset>

        <aui:input name="<%= ABContactDisplayTerms.SURNAME %>" size="20" value="<%= displayTerms.getSurname() %>" />

        <aui:input name="<%= ABContactDisplayTerms.NAME %>" size="20" value="<%= displayTerms.getName() %>" />

        <aui:input name="<%= ABContactDisplayTerms.POSITION %>" size="20" value="<%= displayTerms.getPosition() %>" />

        <aui:input name="<%= ABContactDisplayTerms.DETAIL_VALUE %>" size="20" value="<%= displayTerms.getDetailValue() %>" />

    </aui:fieldset>
</liferay-ui:search-toggle>

<c:if test="<%= windowState.equals(WindowState.MAXIMIZED) %>">
    <aui:script>
        Liferay.Util.focusFormField(document.<portlet:namespace />fm.<portlet:namespace /><%= ABContactDisplayTerms.SURNAME %>);
        Liferay.Util.focusFormField(document.<portlet:namespace />fm.<portlet:namespace /><%= ABContactDisplayTerms.KEYWORDS %>);
    </aui:script>
</c:if>meDisplay.setIncludeServiceJs(true);
ABContactSearch searchContainer = (ABContactSearch)request.getAttribute("liferay-ui:search:searchContainer"); 
```

ABContactDisplayTerm.java：

```
public class ABContactDisplayTerms extends DisplayTerms {

    public static final String NAME = "name";

    public static final String SURNAME = "surname";

    public static final String POSITION = "position";

    public static final String SOCIETY_ID = "societyId";

    public static final String CONTACT_TYPE_ID = "contactTypeId";

    public static final String BRAND_ID = "brandId";

    public static final String CHANNEL_ID = "channelId";

    public static final String DETAIL_VALUE = "detailValue";

    protected String name;
    protected String surname;
    protected String position;
    protected Long societyId;
    protected Long contactTypeId;
    protected Long brandId;
    protected Long channelId;
    protected String detailValue;

    public ABContactDisplayTerms(PortletRequest portletRequest) {
        super(portletRequest);

        name = ParamUtil.getString(portletRequest, NAME);
        surname = ParamUtil.getString(portletRequest, SURNAME);
        position = ParamUtil.getString(portletRequest, POSITION);
        societyId = ParamUtil.getLong(portletRequest, SOCIETY_ID);
        contactTypeId = ParamUtil.getLong(portletRequest, CONTACT_TYPE_ID);
        brandId = ParamUtil.getLong(portletRequest, BRAND_ID);
        channelId = ParamUtil.getLong(portletRequest, CHANNEL_ID);
        detailValue = ParamUtil.getString(portletRequest, DETAIL_VALUE);
    }

    public String getName() {
        return name;
    }

    public String getSurname() {
        return surname;
    }

    public String getPosition() {
        return position;
    }

    public Long getSocietyId() {
        return societyId;
    }

    public Long getContactTypeId() {
        return contactTypeId;
    }

    public Long getBrandId() {
        return brandId;
    }

    public Long getChannelId() {
        return channelId;
    }

    public String getDetailValue() {
        return detailValue;
    }

} 
```

最后是 ABContactSearch.java

```
public class ABContactSearch extends SearchContainer<ABContact> {

    private static Log _log = LogFactoryUtil.getLog(ABContactSearch.class);

    static List<String> headerNames = new ArrayList<String>();
    static Map<String, String> orderableHeaders = new HashMap<String, String>();

    static {
        headerNames.add("name");
        headerNames.add("surname");
        headerNames.add("position");
        headerNames.add("society");
        headerNames.add("contact-type");
        headerNames.add("channel");
        headerNames.add("brand");
        headerNames.add("detail-value");

        orderableHeaders.put("name", "name");
        orderableHeaders.put("surname", "surname");
        orderableHeaders.put("society", "society");
        orderableHeaders.put("contact-type", "contact-type");
    }

    public static final String EMPTY_RESULTS_MESSAGE = "no-contacts-were-found";

    public ABContactSearch(PortletRequest portletRequest, PortletURL iteratorURL) {
        super(
            portletRequest, new ABContactDisplayTerms(portletRequest),
            new ABContactSearchTerms(portletRequest), DEFAULT_CUR_PARAM,
            DEFAULT_DELTA, iteratorURL, headerNames, EMPTY_RESULTS_MESSAGE);

        ABContactDisplayTerms displayTerms = (ABContactDisplayTerms)getDisplayTerms();

        iteratorURL.setParameter(
                ABContactDisplayTerms.NAME, displayTerms.getName());
        iteratorURL.setParameter(
                ABContactDisplayTerms.SURNAME, displayTerms.getSurname());
        iteratorURL.setParameter(
                ABContactDisplayTerms.POSITION, displayTerms.getPosition());
        iteratorURL.setParameter(
                ABContactDisplayTerms.DETAIL_VALUE, displayTerms.getDetailValue());
        iteratorURL.setParameter(
                ABContactDisplayTerms.SOCIETY_ID, String.valueOf(displayTerms.getSocietyId()));
        iteratorURL.setParameter(
                ABContactDisplayTerms.CONTACT_TYPE_ID, String.valueOf(displayTerms.getContactTypeId()));
        iteratorURL.setParameter(
                ABContactDisplayTerms.BRAND_ID, String.valueOf(displayTerms.getBrandId()));
        iteratorURL.setParameter(
                ABContactDisplayTerms.CHANNEL_ID, String.valueOf(displayTerms.getChannelId()));

        try {
            String orderByCol = ParamUtil.getString(
                portletRequest, "orderByCol", "surname");
            String orderByType = ParamUtil.getString(
                portletRequest, "orderByType", "asc");

//          OrderByComparator orderByComparator =
//              UsersAdminUtil.getUserOrderByComparator(
//                  orderByCol, orderByType);

            setOrderableHeaders(orderableHeaders);
            setOrderByCol(orderByCol);
            setOrderByType(orderByType);
//          setOrderByComparator(orderByComparator);
        }
        catch (Exception e) {
            _log.error(e.getMessage());
            _log.debug(e.getMessage(), e);
        }
    }

} 
```

搜索容器本身运行良好，因为默认情况下使用空字符串执行基本搜索，但未显示“搜索表单”。我尝试在contact_search_form.jsp 上放置一些调试消息，但它们都没有打印到控制台中。taglib 似乎没有找到或处理该文件。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-27T06:18:01.183

我的 100% 工作示例，其中使用 liferay-ui: search-container、liferay-ui: search-form 和 liferay-ui: search-toggle:

我的 100% 工作示例，其中使用 liferay-ui: search-container, liferay-ui: search-form 和 liferay-ui: search-toggle: **view.jsp:**

```
<%@ include file="/init.jsp" %>

<%
PortletURL portletURL = renderResponse.createRenderURL();
portletURL.setParameter("mvcPath", "/html/view.jsp");
pageContext.setAttribute("portletURL", portletURL);

%>  

<aui:form name="searchForm" action="<%= portletURL.toString() %>" method="post">

    <liferay-ui:search-container searchContainer="<%= new UserSearch(renderRequest, portletURL) %>" >
        <aui:input disabled="<%= true %>" name="usersRedirect" type="hidden" value="<%= portletURL.toString() %>" />

        <%
        UserSearchTerms searchTerms = (UserSearchTerms)searchContainer.getSearchTerms();
        UserDisplayTerms displayTerms = (UserDisplayTerms)searchContainer.getDisplayTerms();

        long organizationId = searchTerms.getOrganizationId();
        long userGroupId = searchTerms.getUserGroupId();

        Organization organization = null;

        if (organizationId > 0) {
            try {
                organization = OrganizationLocalServiceUtil.getOrganization(organizationId);
            }
            catch (NoSuchOrganizationException nsoe) {
            }
        }

        UserGroup userGroup = null;

        if (userGroupId > 0) {
            try {
                userGroup = UserGroupLocalServiceUtil.getUserGroup(userGroupId);
            }
            catch (NoSuchUserGroupException nsuge) {
            }
        }
        %>

        <c:if test="<%= organization != null %>">
            <aui:input name="<%= UserDisplayTerms.ORGANIZATION_ID %>" type="hidden" value="<%= organization.getOrganizationId() %>" />

            <h3><%= HtmlUtil.escape(LanguageUtil.format(pageContext, "users-of-x", organization.getName())) %></h3>
        </c:if>

        <c:if test="<%= userGroup != null %>">
            <aui:input name="<%= UserDisplayTerms.USER_GROUP_ID %>" type="hidden" value="<%= userGroup.getUserGroupId() %>" />

            <h3><%= LanguageUtil.format(pageContext, "users-of-x", HtmlUtil.escape(userGroup.getName())) %></h3>
        </c:if>

        <liferay-ui:search-form
            page="/html/user_search.jsp"
            searchContainer="<%= searchContainer %>"
            servletContext="<%= this.getServletConfig().getServletContext() %>"
        />

        <%
        LinkedHashMap userParams = new LinkedHashMap();

        if (organizationId > 0) {
            userParams.put("usersOrgs", new Long(organizationId));
        }

        if (userGroupId > 0) {
            userParams.put("usersUserGroups", new Long(userGroupId));
        }
        %>

        <liferay-ui:search-container-results>
            <c:choose>
                <c:when test="<%= GetterUtil.getBoolean(PropsUtil.get(PropsKeys.USERS_INDEXER_ENABLED)) && GetterUtil.getBoolean(PropsUtil.get(PropsKeys.USERS_SEARCH_WITH_INDEX)) %>">
                    <%@ include file="/html/user_search_results_index.jspf" %>
                </c:when>
                <c:otherwise>
                    <%@ include file="/html/user_search_results_database.jspf" %>
                </c:otherwise>
            </c:choose>
        </liferay-ui:search-container-results>

        <liferay-ui:search-container-row
            className="com.liferay.portal.model.User"
            escapedModel="<%= true %>"
            keyProperty="userId"
            modelVar="curUser"
            rowIdProperty="screenName"
        >
            <liferay-portlet:renderURL varImpl="rowURL" windowState="<%= WindowState.MAXIMIZED.toString() %>">
                <portlet:param name="mvcPath" value="/html/user_display.jsp" />
                <portlet:param name="redirect" value="<%= searchContainer.getIteratorURL().toString() %>" />
                <portlet:param name="userId" value="<%= String.valueOf(curUser.getUserId()) %>" />
            </liferay-portlet:renderURL>

            <%@ include file="/html/search_columns.jspf" %>
        </liferay-ui:search-container-row>

        <c:if test="<%= (organization != null) || (userGroup != null) %>">
            <br />
        </c:if>

        <c:if test="<%= organization != null %>">
            <aui:input name="<%= UserDisplayTerms.ORGANIZATION_ID %>" type="hidden" value="<%= organization.getOrganizationId() %>" />

            <liferay-ui:message key="filter-by-organization" />: <%= HtmlUtil.escape(organization.getName()) %><br />
        </c:if>

        <c:if test="<%= userGroup != null %>">
            <aui:input name="<%= UserDisplayTerms.USER_GROUP_ID %>" type="hidden" value="<%= userGroup.getUserGroupId() %>" />

            <liferay-ui:message key="filter-by-user-group" />: <%= HtmlUtil.escape(userGroup.getName()) %><br />
        </c:if> 

        <div class="separator"><!-- --></div>

        <liferay-ui:search-iterator />
    </liferay-ui:search-container>
</aui:form> 
```

**用户搜索.jsp：**

```
<%@ include file="/init.jsp" %>

<%
UserSearch searchContainer = (UserSearch)request.getAttribute("liferay-ui:search:searchContainer");

UserDisplayTerms displayTerms = (UserDisplayTerms)searchContainer.getDisplayTerms();
%>

<liferay-ui:search-toggle
    buttonLabel="search"
    displayTerms="<%= displayTerms %>"
    id="toggle_id_user_search"
>
    <aui:fieldset>
        <aui:input name="<%= displayTerms.FIRST_NAME %>" size="20" type="text" value="<%= displayTerms.getFirstName() %>" />

        <aui:input name="<%= displayTerms.MIDDLE_NAME %>" size="20" type="text" value="<%= displayTerms.getMiddleName() %>" />

        <aui:input name="<%= displayTerms.LAST_NAME %>" size="20" type="text" value="<%= displayTerms.getLastName() %>" />

        <aui:input name="<%= displayTerms.SCREEN_NAME %>" size="20" type="text" value="<%= displayTerms.getScreenName() %>" />

        <aui:input name="<%= displayTerms.EMAIL_ADDRESS %>" size="20" type="text" value="<%= displayTerms.getEmailAddress() %>" />
    </aui:fieldset>
</liferay-ui:search-toggle> 
```

**user_search_results_index.jspf：**

```
<%@ page import="com.liferay.portal.kernel.search.Hits" %>
<%@ page import="com.liferay.portal.kernel.search.Sort" %>
<%@ page import="com.liferay.portal.kernel.search.SortFactoryUtil" %>
<%@ page import="com.liferay.portlet.usersadmin.util.UsersAdminUtil" %>

<%
userParams.put("expandoAttributes", searchTerms.getKeywords());

Sort sort = SortFactoryUtil.getSort(User.class, searchContainer.getOrderByCol(), searchContainer.getOrderByType());

while (true) {
    Hits hits = null;

    if (searchTerms.isAdvancedSearch()) {
        hits = UserLocalServiceUtil.search(company.getCompanyId(), searchTerms.getFirstName(), searchTerms.getMiddleName(), searchTerms.getLastName(), searchTerms.getScreenName(), searchTerms.getEmailAddress(), searchTerms.getStatus(), userParams, searchTerms.isAndOperator(), searchContainer.getStart(), searchContainer.getEnd(), sort);
    }
    else {
        hits = UserLocalServiceUtil.search(company.getCompanyId(), searchTerms.getKeywords(), searchTerms.getStatus(), userParams, searchContainer.getStart(), searchContainer.getEnd(), sort);
    }

    Tuple tuple = UsersAdminUtil.getUsers(hits);

    boolean corruptIndex = (Boolean)tuple.getObject(1);

    if (!corruptIndex) {
        results = (List<User>)tuple.getObject(0);
        total = hits.getLength();

        break;
    }
}

pageContext.setAttribute("results", results);
pageContext.setAttribute("total", total);
%> 
```

**user_search_results_database.jspf：**

```
<%
if (searchTerms.isAdvancedSearch()) {
    results = UserLocalServiceUtil.search(company.getCompanyId(), searchTerms.getFirstName(), searchTerms.getMiddleName(), searchTerms.getLastName(), searchTerms.getScreenName(), searchTerms.getEmailAddress(), searchTerms.getStatus(), userParams, searchTerms.isAndOperator(), searchContainer.getStart(), searchContainer.getEnd(), searchContainer.getOrderByComparator());
    total = UserLocalServiceUtil.searchCount(company.getCompanyId(), searchTerms.getFirstName(), searchTerms.getMiddleName(), searchTerms.getLastName(), searchTerms.getScreenName(), searchTerms.getEmailAddress(), searchTerms.getStatus(), userParams, searchTerms.isAndOperator());
}
else {
    results = UserLocalServiceUtil.search(company.getCompanyId(), searchTerms.getKeywords(), searchTerms.getStatus(), userParams, searchContainer.getStart(), searchContainer.getEnd(), searchContainer.getOrderByComparator());
    total = UserLocalServiceUtil.searchCount(company.getCompanyId(), searchTerms.getKeywords(), searchTerms.getStatus(), userParams);
}

pageContext.setAttribute("results", results);
pageContext.setAttribute("total", total);
%> 
```

**user_display.jsp：**

```
<%@ include file="/init.jsp" %>

<%
String backURL = ParamUtil.getString(request, "redirect");

portletDisplay.setURLBack(backURL);

long userId = ParamUtil.getLong(request, "userId");
%>

<liferay-ui:user-display
    displayStyle="<%= 2 %>"
    userId="<%= userId %>"
/> 
```

**search_columns.jspf：**

```
<liferay-ui:search-container-column-text
    href="<%= rowURL %>"
    name="first-name"
    orderable="<%= true %>"
    property="firstName"
/>

<liferay-ui:search-container-column-text
    href="<%= rowURL %>"
    name="last-name"
    orderable="<%= true %>"
    property="lastName"
/>

<liferay-ui:search-container-column-text
    href="<%= rowURL %>"
    name="screen-name"
    orderable="<%= true %>"
    property="screenName"
/>

<liferay-ui:search-container-column-text
    href="<%= rowURL %>"
    name="organizations"
>
    <liferay-ui:write bean="<%= curUser %>" property="organizations" />
</liferay-ui:search-container-column-text> 
```

**用户搜索.java：**

```
package kz.b2e.kudos.portal.searchuser.search;

import com.liferay.portal.kernel.dao.search.SearchContainer;
import com.liferay.portal.kernel.log.Log;
import com.liferay.portal.kernel.log.LogFactoryUtil;
import com.liferay.portal.kernel.util.JavaConstants;
import com.liferay.portal.kernel.util.OrderByComparator;
import com.liferay.portal.kernel.util.ParamUtil;
import com.liferay.portal.kernel.util.Validator;
import com.liferay.portal.kernel.workflow.WorkflowConstants;
import com.liferay.portal.model.User;
import com.liferay.portal.util.PortletKeys;
import com.liferay.portlet.PortalPreferences;
import com.liferay.portlet.PortletPreferencesFactoryUtil;
import com.liferay.portlet.usersadmin.util.UsersAdminUtil;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.portlet.PortletConfig;
import javax.portlet.PortletRequest;
import javax.portlet.PortletURL;

public class UserSearch extends SearchContainer<User> {

    static List<String> headerNames = new ArrayList<String>();
    static Map<String, String> orderableHeaders = new HashMap<String, String>();

    static {
        headerNames.add("first-name");
        headerNames.add("last-name");
        headerNames.add("screen-name");
        //headerNames.add("email-address");
        headerNames.add("job-title");
        headerNames.add("organizations");

        orderableHeaders.put("first-name", "first-name");
        orderableHeaders.put("last-name", "last-name");
        orderableHeaders.put("screen-name", "screen-name");
        //orderableHeaders.put("email-address", "email-address");
        orderableHeaders.put("job-title", "job-title");
    }

    public static final String EMPTY_RESULTS_MESSAGE = "no-users-were-found";

    public UserSearch(PortletRequest portletRequest, PortletURL iteratorURL) {
        this(portletRequest, DEFAULT_CUR_PARAM, iteratorURL);
    }

    public UserSearch(
        PortletRequest portletRequest, String curParam,
        PortletURL iteratorURL) {

        super(
            portletRequest, new UserDisplayTerms(portletRequest),
            new UserSearchTerms(portletRequest), curParam, DEFAULT_DELTA,
            iteratorURL, headerNames, EMPTY_RESULTS_MESSAGE);

        PortletConfig portletConfig =
            (PortletConfig)portletRequest.getAttribute(
                JavaConstants.JAVAX_PORTLET_CONFIG);

        UserDisplayTerms displayTerms = (UserDisplayTerms)getDisplayTerms();
        UserSearchTerms searchTerms = (UserSearchTerms)getSearchTerms();

        String portletName = portletConfig.getPortletName();

        if (!portletName.equals(PortletKeys.USERS_ADMIN)) {
            displayTerms.setStatus(WorkflowConstants.STATUS_APPROVED);
            searchTerms.setStatus(WorkflowConstants.STATUS_APPROVED);
        }

        iteratorURL.setParameter(
            UserDisplayTerms.STATUS, String.valueOf(displayTerms.getStatus()));

        iteratorURL.setParameter(
            UserDisplayTerms.EMAIL_ADDRESS, displayTerms.getEmailAddress());
        iteratorURL.setParameter(
            UserDisplayTerms.FIRST_NAME, displayTerms.getFirstName());
        iteratorURL.setParameter(
            UserDisplayTerms.LAST_NAME, displayTerms.getLastName());
        iteratorURL.setParameter(
            UserDisplayTerms.MIDDLE_NAME, displayTerms.getMiddleName());
        iteratorURL.setParameter(
            UserDisplayTerms.ORGANIZATION_ID,
            String.valueOf(displayTerms.getOrganizationId()));
        iteratorURL.setParameter(
            UserDisplayTerms.ROLE_ID, String.valueOf(displayTerms.getRoleId()));
        iteratorURL.setParameter(
            UserDisplayTerms.SCREEN_NAME, displayTerms.getScreenName());
        iteratorURL.setParameter(
            UserDisplayTerms.USER_GROUP_ID,
            String.valueOf(displayTerms.getUserGroupId()));

        try {
            PortalPreferences preferences =
                PortletPreferencesFactoryUtil.getPortalPreferences(
                    portletRequest);

            String orderByCol = ParamUtil.getString(
                portletRequest, "orderByCol");
            String orderByType = ParamUtil.getString(
                portletRequest, "orderByType");

            if (Validator.isNotNull(orderByCol) &&
                Validator.isNotNull(orderByType)) {

                preferences.setValue(
                    PortletKeys.USERS_ADMIN, "users-order-by-col", orderByCol);
                preferences.setValue(
                    PortletKeys.USERS_ADMIN, "users-order-by-type",
                    orderByType);
            }
            else {
                orderByCol = preferences.getValue(
                    PortletKeys.USERS_ADMIN, "users-order-by-col", "last-name");
                orderByType = preferences.getValue(
                    PortletKeys.USERS_ADMIN, "users-order-by-type", "asc");
            }

            OrderByComparator orderByComparator =
                UsersAdminUtil.getUserOrderByComparator(
                    orderByCol, orderByType);

            setOrderableHeaders(orderableHeaders);
            setOrderByCol(orderByCol);
            setOrderByType(orderByType);
            setOrderByComparator(orderByComparator);
        }
        catch (Exception e) {
            _log.error(e);
        }
    }

    private static Log _log = LogFactoryUtil.getLog(UserSearch.class);

} 
```

**UserSearchTerms.java：**

```
package kz.b2e.kudos.portal.searchuser.search;

import com.liferay.portal.kernel.dao.search.SearchContainer;
import com.liferay.portal.kernel.log.Log;
import com.liferay.portal.kernel.log.LogFactoryUtil;
import com.liferay.portal.kernel.util.JavaConstants;
import com.liferay.portal.kernel.util.OrderByComparator;
import com.liferay.portal.kernel.util.ParamUtil;
import com.liferay.portal.kernel.util.Validator;
import com.liferay.portal.kernel.workflow.WorkflowConstants;
import com.liferay.portal.model.User;
import com.liferay.portal.util.PortletKeys;
import com.liferay.portlet.PortalPreferences;
import com.liferay.portlet.PortletPreferencesFactoryUtil;
import com.liferay.portlet.usersadmin.util.UsersAdminUtil;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.portlet.PortletConfig;
import javax.portlet.PortletRequest;
import javax.portlet.PortletURL;

public class UserSearch extends SearchContainer<User> {

    static List<String> headerNames = new ArrayList<String>();
    static Map<String, String> orderableHeaders = new HashMap<String, String>();

    static {
        headerNames.add("first-name");
        headerNames.add("last-name");
        headerNames.add("screen-name");
        //headerNames.add("email-address");
        headerNames.add("job-title");
        headerNames.add("organizations");

        orderableHeaders.put("first-name", "first-name");
        orderableHeaders.put("last-name", "last-name");
        orderableHeaders.put("screen-name", "screen-name");
        //orderableHeaders.put("email-address", "email-address");
        orderableHeaders.put("job-title", "job-title");
    }

    public static final String EMPTY_RESULTS_MESSAGE = "no-users-were-found";

    public UserSearch(PortletRequest portletRequest, PortletURL iteratorURL) {
        this(portletRequest, DEFAULT_CUR_PARAM, iteratorURL);
    }

    public UserSearch(
        PortletRequest portletRequest, String curParam,
        PortletURL iteratorURL) {

        super(
            portletRequest, new UserDisplayTerms(portletRequest),
            new UserSearchTerms(portletRequest), curParam, DEFAULT_DELTA,
            iteratorURL, headerNames, EMPTY_RESULTS_MESSAGE);

        PortletConfig portletConfig =
            (PortletConfig)portletRequest.getAttribute(
                JavaConstants.JAVAX_PORTLET_CONFIG);

        UserDisplayTerms displayTerms = (UserDisplayTerms)getDisplayTerms();
        UserSearchTerms searchTerms = (UserSearchTerms)getSearchTerms();

        String portletName = portletConfig.getPortletName();

        if (!portletName.equals(PortletKeys.USERS_ADMIN)) {
            displayTerms.setStatus(WorkflowConstants.STATUS_APPROVED);
            searchTerms.setStatus(WorkflowConstants.STATUS_APPROVED);
        }

        iteratorURL.setParameter(
            UserDisplayTerms.STATUS, String.valueOf(displayTerms.getStatus()));

        iteratorURL.setParameter(
            UserDisplayTerms.EMAIL_ADDRESS, displayTerms.getEmailAddress());
        iteratorURL.setParameter(
            UserDisplayTerms.FIRST_NAME, displayTerms.getFirstName());
        iteratorURL.setParameter(
            UserDisplayTerms.LAST_NAME, displayTerms.getLastName());
        iteratorURL.setParameter(
            UserDisplayTerms.MIDDLE_NAME, displayTerms.getMiddleName());
        iteratorURL.setParameter(
            UserDisplayTerms.ORGANIZATION_ID,
            String.valueOf(displayTerms.getOrganizationId()));
        iteratorURL.setParameter(
            UserDisplayTerms.ROLE_ID, String.valueOf(displayTerms.getRoleId()));
        iteratorURL.setParameter(
            UserDisplayTerms.SCREEN_NAME, displayTerms.getScreenName());
        iteratorURL.setParameter(
            UserDisplayTerms.USER_GROUP_ID,
            String.valueOf(displayTerms.getUserGroupId()));

        try {
            PortalPreferences preferences =
                PortletPreferencesFactoryUtil.getPortalPreferences(
                    portletRequest);

            String orderByCol = ParamUtil.getString(
                portletRequest, "orderByCol");
            String orderByType = ParamUtil.getString(
                portletRequest, "orderByType");

            if (Validator.isNotNull(orderByCol) &&
                Validator.isNotNull(orderByType)) {

                preferences.setValue(
                    PortletKeys.USERS_ADMIN, "users-order-by-col", orderByCol);
                preferences.setValue(
                    PortletKeys.USERS_ADMIN, "users-order-by-type",
                    orderByType);
            }
            else {
                orderByCol = preferences.getValue(
                    PortletKeys.USERS_ADMIN, "users-order-by-col", "last-name");
                orderByType = preferences.getValue(
                    PortletKeys.USERS_ADMIN, "users-order-by-type", "asc");
            }

            OrderByComparator orderByComparator =
                UsersAdminUtil.getUserOrderByComparator(
                    orderByCol, orderByType);

            setOrderableHeaders(orderableHeaders);
            setOrderByCol(orderByCol);
            setOrderByType(orderByType);
            setOrderByComparator(orderByComparator);
        }
        catch (Exception e) {
            _log.error(e);
        }
    }

    private static Log _log = LogFactoryUtil.getLog(UserSearch.class);

} 
```

**UserDisplayTerms.java**

```
package kz.b2e.kudos.portal.searchuser.search;

import com.liferay.portal.kernel.dao.search.DisplayTerms;
import com.liferay.portal.kernel.util.GetterUtil;
import com.liferay.portal.kernel.util.ParamUtil;
import com.liferay.portal.kernel.util.Validator;
import com.liferay.portal.kernel.workflow.WorkflowConstants;

import javax.portlet.PortletRequest;

public class UserDisplayTerms extends DisplayTerms {

    public static final String EMAIL_ADDRESS = "emailAddress";

    public static final String FIRST_NAME = "firstName";

    public static final String LAST_NAME = "lastName";

    public static final String MIDDLE_NAME = "middleName";

    public static final String ORGANIZATION_ID = "organizationId";

    public static final String ROLE_ID = "roleId";

    public static final String SCREEN_NAME = "screenName";

    public static final String STATUS = "status";

    public static final String USER_GROUP_ID = "userGroupId";

    public UserDisplayTerms(PortletRequest portletRequest) {
        super(portletRequest);

        String statusString = ParamUtil.getString(portletRequest, STATUS);

        if (Validator.isNotNull(statusString)) {
            status = GetterUtil.getInteger(statusString);
        }

        emailAddress = ParamUtil.getString(portletRequest, EMAIL_ADDRESS);
        firstName = ParamUtil.getString(portletRequest, FIRST_NAME);
        lastName = ParamUtil.getString(portletRequest, LAST_NAME);
        middleName = ParamUtil.getString(portletRequest, MIDDLE_NAME);
        organizationId = ParamUtil.getLong(portletRequest, ORGANIZATION_ID);
        roleId = ParamUtil.getLong(portletRequest, ROLE_ID);
        screenName = ParamUtil.getString(portletRequest, SCREEN_NAME);
        userGroupId = ParamUtil.getLong(portletRequest, USER_GROUP_ID);
    }

    public String getEmailAddress() {
        return emailAddress;
    }

    public String getFirstName() {
        return firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public String getMiddleName() {
        return middleName;
    }

    public long getOrganizationId() {
        return organizationId;
    }

    public long getRoleId() {
        return roleId;
    }

    public String getScreenName() {
        return screenName;
    }

    public int getStatus() {
        return status;
    }

    public long getUserGroupId() {
        return userGroupId;
    }

    public boolean isActive() {
        if (status == WorkflowConstants.STATUS_APPROVED) {
            return true;
        }
        else {
            return false;
        }
    }

    public void setStatus(int status) {
        this.status = status;
    }

    protected String emailAddress;
    protected String firstName;
    protected String lastName;
    protected String middleName;
    protected long organizationId;
    protected long roleId;
    protected String screenName;
    protected int status;
    protected long userGroupId;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T23:34:25.843

把你的代码放进去

```
<aui:form action="<%= portletURL.toString() %>" method="post" name="yourForm">
</aui:form> 
```

# jquery - 在表单数据验证期间防止 Telerik Radbutton 回发

> ID：12623604
> 
> 赞同：1
> 
> 时间：2012-09-27T14:21:57.863
> 
> 标签：jquery, asp.net, telerik, postback

我试图防止使用 JQuery 回发页面。

```
<script type="text/javascript" language="javascript">

    $(document).ready(function() {
        $('#<%= btnAddAircraft.ClientID %>').click(function() {
            var Passengers = $('#<%= txtPassengers.ClientID %>').val();
            if (parseInt(Passengers) == 0) 
            {
                $('#<%= txtPassengers.ClientID %>').focus();
                alert("Number of passengers should not be Zero.");
                return false;                
            }

            });
    }); 
```

```
<telerik:radbutton id="btnAddAircraft" onclick="btnAddAircraft_Click" validationgroup="P1" text="Add Aircraft" runat="server"> </telerik:radbutton> 
```

验证过程发生但不能保留控制以防止回发。
注意：这个问题我已经`OnClientClick`使用`RadButton`. 但我想在我的`document.ready`功能中解决它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:25:36.317

您想附加到 OnClientClicking 客户端事件，该事件可以被取消。Telerik 用于事件 Clicking/Clicked 事件名称。有关更多信息，请参阅事件：http: [//demos.telerik.com/aspnet-ajax/button/examples/clientsideevents/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/button/examples/clientsideevents/defaultcs.aspx)

要取消，您应该可以设置`e.set_cancel(true);`

因为是 ASP.NET AJAX，所以不能在 document.ready 中附加 AJAX 组件；AJAX 没有及时初始化以使其正常工作。

# iphone - NSObject 类别类方法无法识别

> ID：12623606
> 
> 赞同：1
> 
> 时间：2012-09-27T14:22:05.490
> 
> 标签：iphone, objective-c, crash

我在 NSObject 上创建了一个类别，因为我希望我的所有类都继承我编写的 2 个类方法：

```
@interface NSObject (MyCategory)

+ (MyEnum) getXYZ;
+ (void) setXYZ:(MyEnum)myEnum;

@end 
```

然后我将这个类别导入到我的 PCH 文件中：

```
#ifdef __OBJC__
    #import <Foundation/Foundation.h>
    #import <UIKit/UIKit.h>
    #import "NSObject+MyCategory.h"
#endif 
```

然后我在我的一个类中使用了该方法：

```
[[self class]getXYZ]; 
```

并在运行时出现此错误：

```
+[MyClass getXYZ]: unrecognized selector sent to class 0xd04f4
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', 
reason: '+[MyClass getXYZ]: unrecognized selector sent to class 0xd04f4' 
```

我做错什么了吗？类别写得好吗？类方法不是继承的吗？我应该使用 [super class] 而不是 [self class] 吗？PCH 文件是导入我的类别的地方吗？

谢谢，努尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:14:15.673

如果您的类别位于主项目的其他项目中，则必须添加链接器标志“-all_load”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:17:44.170

您不应在前缀标头 (.pch) 文件中导入您的类别。在大多数情况下，您只需要在其他几个文件中使用您的类别，因此只需将它们导入那里。仅在整个项目中使用的前缀标头中导入文件。

如果您确定要在前缀标题中包含该类别，请尝试将 Build Setting 设置`Precompile Prefix Header`为`No`. 或者清理项目。有时 Xcode 会忘记重新编译前缀头文件。

![在此处输入图像描述](../Images/fba66c367e8cccd202f354a50f572290.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:37:06.290

我想你还没有在 category(NSOBject) 的实现文件 (.m) 中定义 getXYZ 方法。并且用于调用 NSObject 的类方法...使用

```
[NSObject getXYZ]; 
```

不是

```
 [[self class]getXYZ]; 
```

# excel - 如何在Excel中的类别中排名？

> ID：12623609
> 
> 赞同：4
> 
> 时间：2012-09-27T14:22:18.530
> 
> 标签：excel, vba

我有一个按地区列出的具有销售价值的客户列表。我想按销售价值创建所有客户的总体排名，以及按区域内的销售价值对客户进行排名，并使用这两个排名来计算分数。有没有办法在 Excel 中做到这一点？

公式或 VBA 代码对我都有帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-27T14:35:11.517

显然，对于整体排名，您可以使用 RANK 函数，例如，对于 A2:A100 中的客户、B2:B100 中的区域和 C2:C100 中的销售值，您可以在 D2 中使用此公式按销售值计算整体客户排名（最高排名 1）

`=RANK(C2,C$2:C$100)`

对于区域内的排名，您可以在复制下来的 E2 中使用此版本

`=SUMPRODUCT((B$2:B$100=B2)*(C$2:C$100>C2))+1`

# hibernate - 在 Hibernate 中比较日期和时间

> ID：12623610
> 
> 赞同：2
> 
> 时间：2012-09-27T14:22:24.430
> 
> 标签：hibernate, compare

我在数据库中有一个定义的列 notification_date 作为*DATETIME 。*

当用户过滤时，我只得到日期。所以我正在使用 Java 将数据和时间转换为数据。例如，如果 userSearch 日期是“ *2012-09-26* ”。最终转换的日期和时间格式为 ' *2012-09-26 17:34:00* '

当我想搜索日期过滤器操作，如等于、小于、大于和日期之间时，我无法使用休眠条件查询大于和小于操作获得正确的结果。

使用的代码

```
crit.add(Restrictions.gt("notificationDate",notificationVO.getNotificationDate())); 
```

限制会根据情况而改变

仅比较日期，Hibernate 中是否有可用的功能？

还有其他想法来解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T08:19:53.160

从您的评论中：

> 如果用户输入 2012-09-26 并且搜索条件小于，我需要所有小于 2012-09-26 的日期

那么限制应该是：

```
crit.add(Restrictions.lt("notificationDate", notificationVO.getNotificationDate())); 
```

如果用户输入相同的日期，并且搜索条件“大于”，并且您使用以下限制：

```
crit.add(Restrictions.gt("notificationDate", notificationVO.getNotificationDate())); 
```

您当然会得到日期和时间大于 2012-09-26 00:00:00 的所有条目，当然包括 2012-09-26 日期的所有条目。

# android - 致命异常：主要

> ID：12623611
> 
> 赞同：-2
> 
> 时间：2012-09-27T14:22:25.940
> 
> 标签：android, exception, android-logcat

我是 android 新手，在使用 Hello World 扩展的第一个应用程序时遇到问题。附加了 Logcat。任何人都可以请帮助为什么应用程序关闭？

```
09-27 19:05:57.442: E/AndroidRuntime(528): FATAL EXCEPTION: main
09-27 19:05:57.442: E/AndroidRuntime(528): java.lang.RuntimeException: Unable to start receiver com.livelihood.hello.world.ScanSMSReceiver: java.lang.ArrayIndexOutOfBoundsException: length=0; index=0
09-27 19:05:57.442: E/AndroidRuntime(528):  at android.app.ActivityThread.handleReceiver(ActivityThread.java:2126)
09-27 19:05:57.442: E/AndroidRuntime(528):  at android.app.ActivityThread.access$1500(ActivityThread.java:123)
09-27 19:05:57.442: E/AndroidRuntime(528):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1197)
09-27 19:05:57.442: E/AndroidRuntime(528):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-27 19:05:57.442: E/AndroidRuntime(528):  at android.os.Looper.loop(Looper.java:137)
09-27 19:05:57.442: E/AndroidRuntime(528):  at android.app.ActivityThread.main(ActivityThread.java:4424)
09-27 19:05:57.442: E/AndroidRuntime(528):  at java.lang.reflect.Method.invokeNative(Native Method)
09-27 19:05:57.442: E/AndroidRuntime(528):  at java.lang.reflect.Method.invoke(Method.java:511)
09-27 19:05:57.442: E/AndroidRuntime(528):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-27 19:05:57.442: E/AndroidRuntime(528):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-27 19:05:57.442: E/AndroidRuntime(528):  at dalvik.system.NativeStart.main(Native Method)
09-27 19:05:57.442: E/AndroidRuntime(528): Caused by: java.lang.ArrayIndexOutOfBoundsException: length=0; index=0
09-27 19:05:57.442: E/AndroidRuntime(528):  at com.livelihood.hello.world.ScanSMSReceiver.onReceive(ScanSMSReceiver.java:40)
09-27 19:05:57.442: E/AndroidRuntime(528):  at android.app.ActivityThread.handleReceiver(ActivityThread.java:2119)
09-27 19:05:57.442: E/AndroidRuntime(528):  ... 10 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:39:14.593

在 ScanSMSReceiver.java 类中的第 40 行中，您使用了一个未正确实例化的 Array 对象。

然后错误告诉您您正在尝试从其中包含 0 个对象的数组中访问索引 0。如果您尝试访问的索引比项目数少 1（数组中的项目数 -1），那么您的程序将抛出

```
java.lang.ArrayIndexOutOfBoundsException 
```

并使您的程序崩溃。

浏览您的代码并检查您声明 Array 对象的位置并使用特定大小对其进行实例化

```
int[] myArray = new int[5]; 
```

（或您使用的任何类型的数组）然后，当您尝试访问索引 0 时，它将不再崩溃。

# php - 后期静态绑定

> ID：12623612
> 
> 赞同：1
> 
> 时间：2012-09-27T14:22:29.467
> 
> 标签：php, static, this

我们是否需要在以下情况下使用`static::$attribute`而不是：`$this->attribute`

**b.php**

```
class B {
public function tellAttribute(){
// $this OR static ??
    echo $this->attribute;
}
} 
```

**一个.php**

```
include 'b.php';

class A extends B {
public $attribute = 'foo';
}

$test = new A();
$test->tellAttribute(); 
```

问这个是因为对我来说它不应该工作，除非我使用`static::$attribute`但它仍然在呼应**foo**。是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:46:20.730

B 类定义了一个名为的公共函数`tellAttribute()`，如下所示：

```
public function tellAttribute(){
    echo $this->attribute;
} 
```

然后实例化 A 类 - B 类的子类 - 并执行以下操作：

```
$test = new A();
$test->tellAttribute(); 
```

所以，你实例化一个类的对象，`A`然后调用`tellAttribute()`这个对象。因为该`tellAttribute()`方法使用`$this`您所指的变量，您已实例化的实际对象。即使您`tellAttribute()`在类`B`中定义 - 父级 - 它实际上将指向`A`您拥有公共`$attribute`属性的子对象（ class 的实例）。这就是它打印的原因`foo`以及您不需要使用`static::`.

另一方面，考虑一下：

```
class B {
    public static $attribute = 'foo';
    public function tellAttribute(){
        echo self::$attribute; // prints 'foo'
    }
    public function tellStaticAttribute() {
        echo static::$attribute; // prints 'bar'
    }
}

class A extends B {
    public static $attribute = 'bar';
}

$test = new A();
$test->tellAttribute();
print "<BR>";
$test->tellStaticAttribute(); 
```

在此示例中，我没有使用`$this`变量 and 而是使用`self::`and `static::`。`tellAttribute()`具有并且将`self::`始终打印`foo`. 这是因为`self::`只能引用当前类。使用`tellStaticAttribute()`并将`static::`“动态”打印类。我对技术术语等不太了解，所以我会给你一个手册的链接（我想你已经从你的帖子中读过）： http: [//php.net/manual/en/language .oop5.late-static-bindings.php](http://php.net/manual/en/language.oop5.late-static-bindings.php)

希望这能回答你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:48:46.373

> 我们是否需要在以下情况下使用 static::$attribute 而不是 $this->attribute ：<code>

**不**，您绝对不会`static`在您描述的场景中使用关键字，并且没有理由*不*工作。将上下文`$this`视为将所有不同的继承类“加起来”为一个的结果。也就是说，如果`class B extends A`和`class C extends B`，通过实例化 C，类 A、B 和 C 的所有属性和函数都可以通过`$this`类内的上下文获得，并且 C 在自己的函数中使用属性是完全可以的在 B 中定义，反之亦然，因为一切都在那里，就好像它是您实例中的一个独立类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:25:10.693

是的，它会起作用....`$attribute`是公开的......而且A也继承了`tellAttribute()`我不确定你在哪里期待什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T14:26:00.997

您没有在任何地方使用“静态”关键字。您在这里的一般类设置对我来说有点奇怪，但是如果您希望 $attribute 成为静态变量，则需要键入：

```
 public static $attribute = 'foo'; 
```

请记住，静态变量基本上是全局变量，您可以在此处查看更多信息：http: [//php.net/manual/en/language.oop5.static.php](http://php.net/manual/en/language.oop5.static.php)

# ios - 通过标签从 Instagram 将照片返回到我的 ios 应用程序

> ID：12623619
> 
> 赞同：0
> 
> 时间：2012-09-27T14:23:13.707
> 
> 标签：ios, instagram

我有一个应用程序，我希望有**10 个 UIImage**对象，这些对象通过标签***#clock*****保存前10 个**图像。做这个的最好方式是什么？我必须授权进入**Instagram**吗？

 **** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:14:01.497

使用连接到[Instagram API](http://instagram.com/developer/)`NSURLConnection`。API 端点将以 JSON 格式返回您的响应。然后，您将需要使用类似`NSJSONSerialization`. 从响应中选择图像 URL 并从中创建`UIImage`实例。

大多数 API 调用都不需要进行身份验证，但需要请求客户端 ID。看起来你可以使用`tags/tag-name/media/recent`Instagram API 的端点来做你想做的事情。***

# android - 想要没有 OpenCV 或任何其他使用 NDK 的库的 Android 图像处理

> ID：12623621
> 
> 赞同：0
> 
> 时间：2012-09-27T14:23:21.747
> 
> 标签：android, image-processing

我正在开发需要实时图像处理任务的 android 应用程序我正在使用 OpenCV 教程 0 进行相机设置并使用相同的类我已经完成编码直到接收实时图像，现在我想检测一个徽标并检测最微笑我在互联网上进行的搜索是基于 OpenCV 的，或者使用了这样的库，这些库使应用程序变得如此严重，或者使用了我发现很难集成的 NDK。我想要一个简单的 java 实现来检测占用很少资源的功能，因为我必须同时执行许多其他任务 谁能给我推荐一些书或网站或任何其他链接或任何用于图像匹配和微笑检测技术的代码，请帮助我真的被卡住了我已经尝试了以下代码，但没有太大帮助，因为像素到像素匹配

```
private boolean  bit_match(Bitmap bmp1, Bitmap bmp2)
{  
    boolean first_x = false;
    int x1 = -2, x2 = -2,y1,y2;
    int minx1=-1,maxx2=-1,miny1=-1,maxy2=-1;
    int w = bmp1.getWidth();
    int h = bmp1.getHeight();

    int[]  pixels1 = new int[w * h];
    int[] pixels2 = new int[w * h];

      total_rounds=0;
      match_count=0;

    //long start = new Date().getTime();
     bmp1.getPixels( pixels1, 0,w, 0, 0, w, h );
     bmp2.getPixels( pixels2, 0,w, 0, 0, w, h );

     for (int i = 0; i < w; i++) {
            for (int j = 0; j < h; j++) 
            {
                    if (pixels2[i + j * w] != pixels1[i + j * w]) 
                    {
                        if(!first_x){ minx1=i; miny1=j; maxx2=i; maxy2=j; first_x = true; }
                        if(minx1>i) minx1 = i;
                        if(miny1>j) miny1 = j;
                        if(maxx2<i) maxx2 = i;
                        if(maxy2<j) maxy2 = j;
                        // System.out.println(i +"x"+ j);
                    }else{ match_count++;}

                    total_rounds++;
            }
     }
     if(minx1==maxx2 && maxy2==miny1)
     { 
         //System.out.println("Un singur pixel modificat");
         //Toast.makeText(this,"Un Modified", Toast.LENGTH_LONG).show();
         return true;
     }
     else{
        // System.out.println("Modified part (rectangle): "+minx1+","+miny1+"<->"+maxx2+","+maxy2);
         //Toast.makeText(this,"Modified part (rectangle): "+minx1+","+miny1+"<->"+maxx2+","+maxy2, Toast.LENGTH_LONG).show();
     return false;  
     }

} 
```

准确性并不重要，我现在可以在准确性上妥协，因为我只需要这个想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T17:39:44.973

如果您想使用 OpenCV for Android 进行图像处理，则无需使用 NDK。请检查[此说明](http://docs.opencv.org/doc/tutorials/introduction/android_binary_package/dev_with_OCV_on_Android.html#java)。我知道这并不简单，但在您的开发级别上，您只需要编写纯 Java 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:33:14.987

这是通过 NDK 进行图像处理的示例[https://github.com/chrisbanes/PhotoProcessing](https://github.com/chrisbanes/PhotoProcessing) 如果您不想弄乱 NDK，您也可以使用 OpenGL 进行图像处理，尽管对于您想要做的事情我会推荐NDK

# objective-c - 替代 NSData 已弃用的 dataWithContentsOfMappedFile

> ID：12623622
> 
> 赞同：5
> 
> 时间：2012-09-27T14:23:29.127
> 
> 标签：objective-c, ios, mmap

所以[+(id)dataWithContentsOfMappedFile:(NSString *)path](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/clm/NSData/dataWithContentsOfMappedFile:)自 iOS 5.0 以来显然已弃用。听起来我应该避免使用它，但是我应该使用什么来代替呢？

我使用 mmap 创建内存映射文件，它适用于 iOS5，但在 iOS6 中，出现问题，因为我一尝试更新或读取缓冲区就会出错。

```
 int fd = open(path, O_RDWR);
  off_t offset = 0;
  snapshotData = mmap(NULL, size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, offset);
  close(fd); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-27T14:30:53.210

使用`+dataWithContentsOfFile:options:error:`. 通过`NSDataReadingMappedIfSafe`作为选项。您也可以`NSDataReadingMappedAlways`改用，但我建议使用前者，除非它真的必须被映射。如果它真的必须被映射，`NSDataReadingMappedAlways`仍然只是一个提示，所以没有承诺。[如 CIMG 所述](http://www.cimgf.com/2012/02/17/extending-nsdata-and-not-overriding-dealloc)，要获得承诺，您需要自己编写。

# ios - Passkit 推送通知不适用于 Urban Airship

> ID：12623623
> 
> 赞同：4
> 
> 时间：2012-09-27T14:23:34.253
> 
> 标签：ios, urbanairship.com, passbook

我安装了通行证。当安装在注册到我的服务器的设备上时，设备 ID 也会注册到 Urban Airship 服务。

到目前为止，一切都很好。

当我尝试从城市飞艇的仪表板发送推送消息，或者冰壶，或者让服务器发送推送时，设备永远不会收到它。推送 passkit 更新时，我有什么特别需要考虑的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T06:06:06.330

经过大量的修补，我得到了这个工作。解决方案并不直观：

1.  确保您在 Urban Airship 上创建的“应用程序”正在推送到 Apple 的生产服务器。Passbook 将无法识别向开发服务器推送的存折（您只能在创建应用程序时执行此操作 - 之后无法修改它）。

2.  确保上传用于签署 Pass ID 的证书，而不是用于标准推送通知的证书。这很重要，因为证书中嵌入了 PassID。

3.  不管苹果怎么说，你需要在有效载荷中包含一些东西。据我所知，这是必要的，因为 Urban Airship 不会推送空的有效载荷。有效载荷的内容无关紧要。该设备只关心它得到*了什么*，所以它知道需要更新。例如，这有效（python）：

    airship = urbanairship.Airship(_UrbanAirshipPassbookKey, _UrbanAirshipPassbookMasterSecret) airship.push({'aps': {'alert': 'Go.'}}, device_tokens=tokens)

Urban Airship 有望在未来改变这种状况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T06:59:40.860

当我对后端有更多的控制权时，我想通了。

```
 Server response was malformed (Wrong type object for key lastUpdated in response dictionary. Expected NSString but found __NSCFNumber.) 
```

所以现在它适用于城市飞艇

# c# - 在哪里存储可以在运行时修改的应用程序范围的设置？

> ID：12623626
> 
> 赞同：2
> 
> 时间：2012-09-27T14:23:43.100
> 
> 标签：c#, .net, configuration, app-config, application-settings

> **可能重复：**
> [如何绕过只读的应用程序范围设置？](https://stackoverflow.com/questions/1687321/how-do-i-get-around-application-scope-settings-being-read-only)

我有一个 ac# WinForms 应用程序，它需要存储一个应用程序范围的设置，该设置也可以在运行时进行编辑和保存。简而言之，当我的应用程序首次启动时，它将连接到 Web 服务并检索我需要在本地存储的字符串。该字符串在未来的所有通信中都会发送到 Web 服务，并用于识别软件/计算机的特定安装。

.NET 提供的应用程序设置功能似乎不符合我的需要，因为应用程序范围的设置在运行时是只读的。我的第一个想法是在 CommonApplicationData 位置下方创建一个新的文件夹结构 (MyCompanyName\MyApplicationName) 并在那里写入设置。据推测，我会通过我的安装程序执行此操作，然后我可能需要适当地设置权限，以便所有用户都可以读/写 MyApplicationName 文件夹。在我走这条路之前，有没有更好的方法来存储/编辑/保存应用程序（不是用户）范围设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:28:31.823

我会将字符串保存在 Windows 注册表中`HKEY_LOCAL_MACHINE\SOFTWARE\MYAPP`

# html - Outlook 背景图片

> ID：12623628
> 
> 赞同：0
> 
> 时间：2012-09-27T14:23:53.510
> 
> 标签：html, css, outlook

为什么这不起作用，我无法让后台重复停止在 Outlook html 电子邮件中平铺。

```
<body style="background-image:url(http://www.blaaa.com/email-bg.jpg); background-repeat:no-repeat"></body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:31:37.050

为电子邮件使用背景图像是没有意义的，因为电子邮件客户端（Outlook、Hotmail、Gmail ......）并不广泛支持它们

请参阅此处了解您可以在电子邮件中获得的内容
[http://www.campaignmonitor.com/css/](http://www.campaignmonitor.com/css/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:26:13.977

用 ; 分隔样式 不是 ，

```
style="background-image:url(http://www.blaaa.com/email-bg.jpg); background-repeat:no-repeat" 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-02T17:11:41.370

你需要为outlook添加这个

背景重复：**重复-y**不重复；

# html - 使用 pandoc 从 html 读取时是否可以保留文本对齐？

> ID：12623630
> 
> 赞同：1
> 
> 时间：2012-09-27T14:23:56.927
> 
> 标签：html, formatting, pandoc

在解析 html 时，p 元素上的文本对齐在此过程中被剥离。在阅读 html 阅读器的源代码时，似乎在表格单元格之外的文本对齐方面没有任何内容，但我对 Haskell 并不流利。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:38:45.050

你说的对。pandoc 文档模型不允许在表格中以外的其他对齐方式，因此简单地忽略对齐信息。

# data-structures - 找到代码的增量器和总成本？

> ID：12623632
> 
> 赞同：1
> 
> 时间：2012-09-27T14:24:03.977
> 
> 标签：data-structures, complexity-theory

这是上周的一个测验。我认为下面问题的答案是 Line:3 。但是，教练告诉我第 4 行更好。我还是不明白为什么？并引出另一个问题，我怎么知道我的最佳增量？

![在此处输入图像描述](../Images/2638a45af305385d93a4983cffe04b8a.png)

我想问的第二个问题，**如何使用 Summations 表示下面运行代码的成本？**我搜索了很多，我发现的只是找到与此无关的代码的复杂性。

我希望你们把一切都告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:50:00.470

当您将整数乘以 2 时，编译器会自动将其转换为右移操作（这非常有效）。此外，比较浮点数比比较整数更昂贵。由于第 4 行将被执行的次数与第 3 行被执行的次数相同，第 4 行将是总成本的最佳代表。

代码总成本

```
= total cost of comparing i with n and incrementing i + 
  total cost of comparing j with n and right shifting j + 
  total cost of comparing two floats + 
  total cost of incrementing a float

<= c1*n + c2*n*n/2 + c3*n*n/2 + c4\sum_{1 <= i <= n, 1 <= k <= n/2}d(i,2k), 
                 where d(i, j) is 1 if array[i] > array[j] and 0 otherwise.

<= c1*n + c2*n^2  + c3n^2 + c4n^2

<= c*n^2 for some constant c 
```

# android - 菜单长按上的吐司显示在错误的位置 - android

> ID：12623634
> 
> 赞同：2
> 
> 时间：2012-09-27T14:24:10.843
> 
> 标签：android, split, optionmenu, contextual-action-bar

我有上下文菜单 - ICS 4.0.4 在底部显示菜单选项。Toast 会在长按时显示，文本设置为菜单标题。问题是，显示的吐司显示在顶部，而它应该显示在菜单选项的正上方。

下面是代码：

在清单文件中：

```
 <activity
        android:name=".SampleMenuActivityActivity"
        android:label="@string/app_name"
        android:uiOptions="splitActionBarWhenNarrow" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

在菜单文件中：

```
<item android:id="@+id/id1"
    android:title="Title!"
    android:icon="@drawable/ic_launcher"
    android:orderInCategory="0"
    android:showAsAction="ifRoom|withText" /> 
```

在活动中：

```
 @Override
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);
    getMenuInflater().inflate(R.menu.trial_option, menu);
    return true;
} 
```

MI缺少什么？

提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-04T03:11:09.197

如果项目的标题不可见并且您无法修改或更改此 toast，则在长按 actionBar 项目时，您总是会在项目上方看到一个“toast”。但是如果你想改变吐司的位置，还有另一种解决方案：

- 首先你需要隐藏顶级吐司。将显示项目的标题，而不是`android:showAsAction="ifRoom|withText"`使用。`android:showAsAction="withText"`

- 现在您需要处理该项目的长按。我在[这里](https://stackoverflow.com/a/18454874/3552945)找到了一种解决方案。

# mysql - mysql 优化表或新建一个

> ID：12623636
> 
> 赞同：1
> 
> 时间：2012-09-27T14:24:21.197
> 
> 标签：mysql, maintenance

我有一个 MySQL MyISAM 表，它有 6.5G 开销。我怀疑我是否应该优化表，或者只是创建一个新表，从旧表填充并重命名它。

这是一个生产环境，因此停机时间应尽可能短。最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:38:38.640

创建一个新表并转置数据意味着原始表仍然可读，但是，如果您允许对其进行写入，则必须在复制完成后转置这些写入。优化过程更可靠，因为它在操作完成之前不允许写入，但正如您所注意到的，这确实涉及一些停机时间。

这实际上取决于此表上是否有足够的写入活动来导致问题。

您可能应该从测试机器上的备份中恢复此数据库，并尝试几种不同的方法来执行此操作，然后再将其提交到您的生产系统上。

# c# - 无法从 Directoryentry 中获取用户

> ID：12623637
> 
> 赞同：1
> 
> 时间：2012-09-27T14:24:22.020
> 
> 标签：c#, active-directory, directoryentry

我在这里疯了，我真的很感激一些帮助！只是我想使用 DirectoryEntry 类从 Active Directory 中获取用户名或任何内容。

我使用了 userprinciple 并且效果很好，但是我需要获取的属性（用户的经理）仅在 DirectoryEntry 中可用。

我的问题是，我在网上看了很多，我从那里得到了代码，但由于某种原因它从来没有用过，总是返回 Null。这是一个例子：

```
public static DirectoryEntry GetUser(string UserName)
{
    //create an instance of the DirectoryEntry
    DirectoryEntry de = new DirectoryEntry("LDAP://" + "OU=AnotherOU,OU=xx,OU=Testvironments,DC=abc,DC=local");

    //create instance fo the direcory searcher
    DirectorySearcher deSearch = new DirectorySearcher(de);

    deSearch.SearchRoot = de;
    //set the search filter
    deSearch.Filter = "(&(objectCategory=user)(cn=" + UserName + "))";
    //deSearch.SearchScope = SearchScope.Subtree;

    //find the first instance
    SearchResult results = deSearch.FindOne();

    //if found then return, otherwise return Null
    if (results != null)
    {
        //de= new DirectoryEntry(results.Path,ADAdminUser,ADAdminPassword,AuthenticationTypes.Secure);
        //if so then return the DirectoryEntry object
        return results.GetDirectoryEntry();
    }
    else
    {
        return null;
    }
} 
```

我不知道为什么这段代码返回 null。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:36:48.657

你可以这样尝试

```
//create instance for directory entry
DirectoryEntry de = new DirectoryEntry("LDAP://" + "OU=AnotherOU,OU=xx,OU=Testvironments,DC=abc,DC=local");

//create instance fo the directory searcher
DirectorySearcher deSearch = new DirectorySearcher(de );;

//set the search filter
deSearch.Filter = "(&(objectClass=user)(|(SAMAccountName=" + UserName+ ")(givenName=" + UserName+ ")(name=" + UserName+ ")(SN=" + UserName+ "))";

//find the first instance
SearchResult results = deSearch.FindOne();

//if found then return, otherwise return Null
if (results != null)
{
    //The desired property you want , you can extract in this way.
   DomainName = results .Properties["SamAccountName"][0].ToString();
   return domainName
}
else
{
    return null;
} 
```

希望这是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:31:56.350

您想要`cn`、`samAccountname`或属性吗`displayName`？是传统 (NT 4.0) 样式的用户名，通常是名字加姓氏，格式类似于电子邮件地址 (user@domain.name)。`userPrincipalName``samAccountName``displayName``userPrincipalName`

无论哪种方式，如果您想测试不同的查询，请使用交互式 LDAP 查询工具，如[ldp.exe](http://support.microsoft.com/kb/224543)。这可能比在代码中尝试它们要容易得多。

# asp.net-mvc - Asp.Net MVC 3 和网络服务

> ID：12623638
> 
> 赞同：0
> 
> 时间：2012-09-27T14:24:28.720
> 
> 标签：asp.net-mvc, asp.net-mvc-3, wcf, web-services, soap

我正在开发和 ASP.Net MVC 3 网站。

我必须通过网络服务访问某些功能。

1.  有没有办法在 Asp:net MVC 3 中直接执行此操作？（例如，使用特殊控制器？我的所有动作都是控制器的可用动作）
2.  如果是，这是推荐吗？
3.  否则我将创建一个 WCF 服务，但这是否可能和/或建议将其托管在 Asp.Net MVC 应用程序中？我需要在与主网站相同的域/端口上访问 Web 服务。我怎样才能做到这一点？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:31:57.563

A) 是的，有，[这个 CodeProject](http://www.codeproject.com/Articles/233572/Build-truly-RESTful-API-and-website-using-same-ASP)概述了一个带有 MVC 3 的 RESTful 服务。虽然，最好的方法是使用[Web API](http://www.asp.net/web-api)，它是 MVC4 的一部分。

B) 是的，这是使用 MVC 创建 RESTful 服务的好方法。是否需要 RESTful 服务的问题取决于项目。

C）我从未见过这种情况，虽然我可能更愿意将两者放在单独的项目和应用程序池中。

# c++ - 使用运行时类型信息分配内存

> ID：12623641
> 
> 赞同：1
> 
> 时间：2012-09-27T14:24:36.297
> 
> 标签：c++, typeid

我开始了解 C++ 中的运行时类型信息。这可以通过 c++ 中的 typeid 关键字来完成。

```
int main()
{
        //these two where user-defined class
        Complex x;
        Point3D y;

        const type_info& s = typeid(x);

        cout<<typeid(y).name()<<endl; //works...(1)
        cout<<s.name()<<endl;         //works...(2)

        Complex * tp = new s[10];     //does not work...(3)
} 
```

正如代码中所标记的，我成功地打印出 (1) 和 (2) 中的数据对象类型。

现在我希望通过使用 type_info/typeid 来分配内存。有人可以这样做吗？有没有可能。我没有任何虚拟功能。

这样的壮举能否通过任何其他方式完成。我不想使用虚函数，因为它对代码向量化有负面影响。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:32:14.177

不，这是不可能的。你要找的是[工厂](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。

这是这样一个工厂的一个例子。假设您有以下类型：

```
class point_t
{
};

class complex_t : public point_t
{
};

class point3d_t : public point_t
{
}; 
```

您可以定义以下工厂：

```
typedef point_t* (*makeptr)();

class point_factory
{
   static point_t* make_complex()
   {
      return new complex_t();
   }

   static point_t* make_point3d()
   {
      return new point3d_t();
   }
   static std::map<std::string, makeptr> _map;
public:
   static void init()
   {
      _map.insert(make_pair(typeid(complex_t).name(), &point_factory::make_complex));
      _map.insert(make_pair(typeid(point3d_t).name(), &point_factory::make_point3d));
   }
   static point_t* make_point(const type_info& type)
   {
      std::map<std::string, makeptr>::iterator pos = _map.find(type.name());
      if(pos != _map.end())
         return (*(pos->second))();
      return NULL;
   }
};

std::map<std::string, makeptr> point_factory::_map; 
```

并像这样使用它：

```
point_factory::init();
point_t* p = point_factory::make_point(typeid(point3d_t)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:32:32.203

在您的代码`s`中不是类型，它是对对象的引用。类型是句法结构，仅在编译期间存在，当程序编译为本机代码时，即使不是全部，大部分类型信息都会丢失！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:42:20.643

如果你没有任何虚函数，你就没有 RTTI，`typeid(x).name()`总是这样`Complex`，你可以简单地写

```
Complex *tp = new Complex[10]; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-27T14:36:23.230

如果代码在模板函数中，您可能会做类似的事情。但是在查看了 type_info 的文档之后，我认为它不会满足您的需求。

[http://www.cplusplus.com/reference/std/typeinfo/type_info/](http://www.cplusplus.com/reference/std/typeinfo/type_info/)

现在 C# 可以使用反射来做你想做的事。但是由于您的本机 C++ 没有反射，因此您很不走运。

# winforms - DataGridViewColumn 属性未向下传播到控件

> ID：12623642
> 
> 赞同：0
> 
> 时间：2012-09-27T14:24:41.000
> 
> 标签：winforms, datagridviewcolumn

我正在通过 MSDN 网站上的一个示例在[datagridview 中托管自定义控件](http://msdn.microsoft.com/en-us/library/7tas5c80%28VS.80%29.aspx)。我遇到的问题是我在 DataGridviewColumn 上有一个可以在设计时设置的属性，但它没有传递到列中的各个单元格。

```
public class CalendarColumn : DataGridViewColumn
{
    public string MyCoolNewProperty {get;set;}

    public CalendarColumn() : base(new CalendarCell())
    {
    }

    public override DataGridViewCell CellTemplate
    {
        get
        {
            return base.CellTemplate;
        }
        set
        {
            // Ensure that the cell used for the template is a CalendarCell.
            if (value != null && 
                !value.GetType().IsAssignableFrom(typeof(CalendarCell)))
            {
                throw new InvalidCastException("Must be a CalendarCell");
            }
            base.CellTemplate = value;
        }
    }

    public override object Clone()
    {
        CalendarColumn obj = (CalendarColumn)base.Clone();
        obj.MyCoolNewProperty = this.MyCoolNewProperty ;
        return obj;
    }
}

   public class CalendarCell : DataGridViewTextBoxCell
    {
public string MyCoolNewProperty {get;set;}
    public CalendarCell()
        : base()
    {
        // Use the short date format.
        this.Style.Format = "d";
    }

    public override void InitializeEditingControl(int rowIndex, object 
        initialFormattedValue, DataGridViewCellStyle dataGridViewCellStyle)
    {
        // Set the value of the editing control to the current cell value.
        base.InitializeEditingControl(rowIndex, initialFormattedValue, 
            dataGridViewCellStyle);
        CalendarEditingControl ctl = 
            DataGridView.EditingControl as CalendarEditingControl;
        ctl.Value = (DateTime)this.Value;
    }

    public override Type EditType
    {
        get
        {
            // Return the type of the editing contol that CalendarCell uses.
            return typeof(CalendarEditingControl);
        }
    }

    public override Type ValueType
    {
        get
        {
            // Return the type of the value that CalendarCell contains.
            return typeof(DateTime);
        }
    }

    public override object DefaultNewRowValue
    {
        get
        {
            // Use the current date and time as the default value.
            return DateTime.Now;
        }
    }

    public override object Clone()
    {
        CalendarCell obj = (CalendarCell)base.Clone();
        obj.MyCoolNewProperty = this.MyCoolNewProperty ;
        return obj;
    }
} 
```

我怎样才能让属性传播到单元格，然后传播到控件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:27:35.900

我完全忽略了在创建单元格时调用的 CalendarCell 类中的 InitializeEditingControl 函数。从这里我添加了访问它所属列的属性所需的一行。

```
 public class CalendarCell : DataGridViewTextBoxCell
    {
public string MyCoolNewProperty {get;set;}
    public CalendarCell()
        : base()
    {
        // Use the short date format.
        this.Style.Format = "d";
    }

    public override void InitializeEditingControl(int rowIndex, object 
        initialFormattedValue, DataGridViewCellStyle dataGridViewCellStyle)
    {
        // Set the value of the editing control to the current cell value.
        base.InitializeEditingControl(rowIndex, initialFormattedValue, 
            dataGridViewCellStyle);
        CalendarEditingControl ctl = 
            DataGridView.EditingControl as CalendarEditingControl;
        ctl.Value = (DateTime)this.Value;
        // Access any Column Properties
        ctl.MyCoolNewProperty = ((CalendarColumn)base.OwningColumn).MyCoolNewProperty; 
    }

    public override Type EditType
    {
        get
        {
            // Return the type of the editing contol that CalendarCell uses.
            return typeof(CalendarEditingControl);
        }
    }

    public override Type ValueType
    {
        get
        {
            // Return the type of the value that CalendarCell contains.
            return typeof(DateTime);
        }
    }

    public override object DefaultNewRowValue
    {
        get
        {
            // Use the current date and time as the default value.
            return DateTime.Now;
        }
    }

    public override object Clone()
    {
        CalendarCell obj = (CalendarCell)base.Clone();
        obj.MyCoolNewProperty = this.MyCoolNewProperty ;
        return obj;
    }
} 
```

# mysql - 错误：错误 1005：无法创建表（错误号：121）

> ID：12623651
> 
> 赞同：109
> 
> 时间：2012-09-27T14:25:15.413
> 
> 标签：mysql

我`forward engineering`的 MySQL 数据库在 WAMP 服务器中出现问题。我打算发布架构的图像，但因为这是我的第一篇文章，所以我不能。

下面是执行的脚本..

```
use aquaticstar;

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Table `Students`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Students` ;

CREATE  TABLE IF NOT EXISTS `Students` (
  `id` VARCHAR(10) NOT NULL ,
  `studentName` VARCHAR(45) NOT NULL ,
  `gender` CHAR NOT NULL ,
  `birthDate` DATETIME NOT NULL ,
  `mNo` VARCHAR(10) NOT NULL ,
  `contactName` VARCHAR(45) NOT NULL ,
  `contactEmail` VARCHAR(45) NOT NULL ,
  `contactPhone` INT(10) NOT NULL ,
  `startDate` DATETIME NOT NULL ,
  `remarks` VARCHAR(200) NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `Waiting List`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Waiting List` ;

CREATE  TABLE IF NOT EXISTS `Waiting List` (
  `wait_id` VARCHAR(5) NOT NULL ,
  `name` VARCHAR(45) NULL ,
  `contactName` VARCHAR(45) NULL ,
  `contactPhone` INT(10) NULL ,
  `contactEmail` VARCHAR(45) NULL ,
  `status` CHAR NULL ,
  `remarks` VARCHAR(200) NULL ,
  PRIMARY KEY (`wait_id`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `Schedule`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Schedule` ;

CREATE  TABLE IF NOT EXISTS `Schedule` (
  `lesson_id` VARCHAR(10) NOT NULL ,
  `day` VARCHAR(3) NOT NULL ,
  `branch` VARCHAR(30) NOT NULL ,
  `level` VARCHAR(30) NOT NULL ,
  `time` TIME NOT NULL ,
  `ae` VARCHAR(45) NOT NULL ,
  PRIMARY KEY (`lesson_id`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `Link`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Link` ;

CREATE  TABLE IF NOT EXISTS `Link` (
  `link_id` VARCHAR(10) NOT NULL ,
  `id` VARCHAR(10) NOT NULL ,
  `lesson_id` VARCHAR(10) NOT NULL ,
  PRIMARY KEY (`link_id`) ,
  INDEX `id_idx` (`id` ASC) ,
  INDEX `lesson_id_idx` (`lesson_id` ASC) ,
  CONSTRAINT `id`
    FOREIGN KEY (`id` )
    REFERENCES `Students` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `lesson_id`
    FOREIGN KEY (`lesson_id` )
    REFERENCES `Schedule` (`lesson_id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `Attendance`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Attendance` ;

CREATE  TABLE IF NOT EXISTS `Attendance` (
  `date` DATETIME NOT NULL ,
  `attendance` VARCHAR(5) NOT NULL ,
  `link_id` VARCHAR(10) NOT NULL ,
  INDEX `link_id_idx` (`link_id` ASC) ,
  CONSTRAINT `link_id`
    FOREIGN KEY (`link_id` )
    REFERENCES `Link` (`link_id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `Students`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `Students` (`id`, `studentName`, `gender`, `birthDate`, `mNo`, `contactName`, `contactEmail`, `contactPhone`, `startDate`, `remarks`) VALUES ('s001', 'Sam Khew', 'm', '12/12/1991', 'nm', 'May Khew', 'may@gmail.com', 0198829387, '12/07/2011', NULL);
INSERT INTO `Students` (`id`, `studentName`, `gender`, `birthDate`, `mNo`, `contactName`, `contactEmail`, `contactPhone`, `startDate`, `remarks`) VALUES ('s002', 'Joe Biden', 'm', '13/03/2003', 'nm', 'Layla Biden', 'layla@gmail.com', 0199283763, '14/05/2011', NULL);
INSERT INTO `Students` (`id`, `studentName`, `gender`, `birthDate`, `mNo`, `contactName`, `contactEmail`, `contactPhone`, `startDate`, `remarks`) VALUES ('s003', 'Bob Builder', 'm', '14/02/2002', 'LK920K', 'Mama Builder', 'mama@yahoo.com', 0167728376, '29/02/2012', NULL);
INSERT INTO `Students` (`id`, `studentName`, `gender`, `birthDate`, `mNo`, `contactName`, `contactEmail`, `contactPhone`, `startDate`, `remarks`) VALUES ('s004', 'Kenny Koh', 'm', '18/02/1999', 'MM992', 'Lisa Koh', 'lk@hotmail.com', 0123160231, '19/01/2012', NULL);
INSERT INTO `Students` (`id`, `studentName`, `gender`, `birthDate`, `mNo`, `contactName`, `contactEmail`, `contactPhone`, `startDate`, `remarks`) VALUES ('s005', 'Jane Doe', 'f', '29/09/1999', 'nm', 'Jackie Doe', 'jackied@gmail.com', 0127736254, '02/03/2012', NULL);
INSERT INTO `Students` (`id`, `studentName`, `gender`, `birthDate`, `mNo`, `contactName`, `contactEmail`, `contactPhone`, `startDate`, `remarks`) VALUES ('s006', 'Lola Lai', 'f', '02/05/2004', 'nm', 'Mark Lai', 'mark@gmail.com', 0198827365, '11/09/2011', NULL);

COMMIT;

-- -----------------------------------------------------
-- Data for table `Schedule`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `Schedule` (`lesson_id`, `day`, `branch`, `level`, `time`, `ae`) VALUES ('sat1_s4', 'Sat', 'Sunway', 'basic', '4pm', 'Aini');
INSERT INTO `Schedule` (`lesson_id`, `day`, `branch`, `level`, `time`, `ae`) VALUES ('sat1_s5', 'Sat', 'Sunway', 'basic', '5pm', 'Aini');
INSERT INTO `Schedule` (`lesson_id`, `day`, `branch`, `level`, `time`, `ae`) VALUES ('sat1_s6', 'Sat', 'Sunway', 'basic', '6pm', 'Aini');
INSERT INTO `Schedule` (`lesson_id`, `day`, `branch`, `level`, `time`, `ae`) VALUES ('sat2_s4', 'Sat', 'Sunway', 'advance', '4pm', 'Nina');
INSERT INTO `Schedule` (`lesson_id`, `day`, `branch`, `level`, `time`, `ae`) VALUES ('sat2_s5', 'Sat', 'Sunway', 'advance', '5pm', 'Nina');
INSERT INTO `Schedule` (`lesson_id`, `day`, `branch`, `level`, `time`, `ae`) VALUES ('sat3_s6', 'Sat', 'Sunway', 'pre-comp', '6pm', 'Marcus');

COMMIT;

-- -----------------------------------------------------
-- Data for table `Link`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `Link` (`link_id`, `id`, `lesson_id`) VALUES ('L001', 's001', 'sat1_s4');
INSERT INTO `Link` (`link_id`, `id`, `lesson_id`) VALUES ('L002', 's002', 'sat1_s5');
INSERT INTO `Link` (`link_id`, `id`, `lesson_id`) VALUES ('L003', 's003', 'sat1_s6');
INSERT INTO `Link` (`link_id`, `id`, `lesson_id`) VALUES ('L004', 's004', 'sat2_s4');
INSERT INTO `Link` (`link_id`, `id`, `lesson_id`) VALUES ('L005', 's005', 'sat1_s5');

COMMIT;

-- -----------------------------------------------------
-- Data for table `Attendance`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `Attendance` (`date`, `attendance`, `link_id`) VALUES ('26/9/2012', '1', NULL);

COMMIT; 
```

但后来我得到这个错误：

```
Executing SQL script in server
ERROR: Error 1005: Can't create table 'aquaticstar.link' (errno: 121) 
```

我不知道为什么。谁能帮我？

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2012-09-27T14:39:23.123

我迅速寻找你，它把我带到了[这里](https://dba.stackexchange.com/questions/425/error-creating-foreign-key-from-mysql-workbench)。我引用：

> 如果您尝试添加名称已在其他地方使用过的约束，您将收到此消息

要检查约束，请使用以下 SQL 查询：

```
SELECT
    constraint_name,
    table_name
FROM
    information_schema.table_constraints
WHERE
    constraint_type = 'FOREIGN KEY'
AND table_schema = DATABASE()
ORDER BY
    constraint_name; 
```

在那里查找更多信息，或尝试查看错误发生的位置。对我来说，外键似乎有问题。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-03-03T17:18:23.073

### 外键约束名称在数据库中必须是唯一的

@Dorvalla[的回答](https://stackoverflow.com/a/12623947/1797912)和上面提到的[这篇博文都为我指明了为自己解决问题的正确方向；](http://thenoyes.com/littlenoise/?p=81)引用后者：

> 如果您尝试创建的表包含外键约束，并且您为该约束提供了自己的名称，请记住它在数据库中必须是唯一的。

我没有意识到这一点。我已经根据以下模式更改了外键约束名称，Ruby on Rails 应用程序似乎也使用了该模式：

```
<TABLE_NAME>_<FOREIGN_KEY_COLUMN_NAME>_fk 
```

例如，对于 OP 的表，这将是`Link_lession_id_fk`。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-27T14:29:30.053

您可以登录到mysql并输入

```
mysql> SHOW INNODB STATUS\G 
```

您将获得所有输出，并且您应该更好地了解错误是什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-01-02T21:53:55.647

我遇到了这个错误（errno 121），但它是由 mysql 创建的孤立的中间表引起的，即使我的任何表中都不存在这样的约束名称，我也无法更改表。在某些时候，我的 MySQL 崩溃或无法清理中间表（表名以 #sql- 开头），最终出现错误，例如：Can't create table '#sql-' (errno 121)尝试运行具有某些约束名称的 ALTER TABLE 时。

根据[http://dev.mysql.com/doc/refman/5.7/en/innodb-troubleshooting-datadict.html](http://dev.mysql.com/doc/refman/5.7/en/innodb-troubleshooting-datadict.html)上的文档，您可以使用以下命令搜索这些孤儿表：

```
SELECT * FROM INFORMATION_SCHEMA.INNODB_SYS_TABLES WHERE NAME LIKE '%#sql%'; 
```

我使用的版本是 5.1，但上面的命令仅适用于 >= 5.6 的版本（手册对于它适用于 5.5 或更早版本是不正确的，因为此类版本中不存在 INNODB_SYS_TABLES）。通过在命令行中搜索我的 mysql 数据目录，我能够找到孤立的临时表（与消息中命名的表不匹配）：

```
find . -iname '#*' 
```

在发现文件名后，例如#sql-9ad_15.frm，我能够在 MySQL 中删除该孤立表：

```
USE myschema;
DROP TABLE `#mysql50##sql-9ad_15`; 
```

这样做之后，我就能够成功运行我的 ALTER TABLE。

为了完整起见，根据链接的 MySQL 文档，“#mysql50# 前缀告诉 MySQL 忽略 MySQL 5.1 中引入的文件名安全编码。”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-09T08:49:26.580

如果您在某个表中有外键定义，并且外键的名称在其他地方用作另一个外键，您将遇到此错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-02T17:52:49.843

如果您想快速修复，请再次转发工程师并选中“生成 DROP SCHEMA”选项并继续。

我假设数据库不包含数据，所以删除它不会影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-16T04:29:11.983

我注意到我的数据库中有“other_database”和“Other_Database”。这导致了这个问题，因为我实际上在其他数据库中有相同的引用导致了这个神秘的错误！

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2014-08-24T19:46:06.380

```
mysql> SHOW ENGINE INNODB STATUS; 
```

但在我的情况下，只有这种方式才能有所帮助：
1\. 备份当前数据库
2\. 删除数据库（不是所有表，而是数据库）
3\. 创建数据库（检查您是否仍有特权）
4\. 从备份中恢复数据库

# iphone - ios6 应用内购买

> ID：12623652
> 
> 赞同：0
> 
> 时间：2012-09-27T14:25:20.203
> 
> 标签：iphone, in-app-purchase, ios6

我今天注意到应用内购买不适用于 ios6。我没有更改任何代码行，我的应用内购买适用于 ios 5.1 或更早版本，但不适用于 ios6。
发生了什么？这是我的代码的错吗？我应该更改ios6的代码吗？
谢谢。

# ruby-on-rails - 单个或多个 Rails 应用程序

> ID：12623653
> 
> 赞同：1
> 
> 时间：2012-09-27T14:25:30.560
> 
> 标签：ruby-on-rails, ruby-on-rails-3, database-design, architecture, subdomain

我想创建一个包含多个子域的站点，每个子域都提供不同的功能。

他们的共同点是：

*   布局
*   用户
*   为该用户付款

那么，设计架构的最佳方式是什么（在 RoR3 上）：

*   一个具有不同命名空间的应用
*   很少有共享用户表的应用程序
*   别的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:27:03.097

如果您将所有网站保留在同一个应用程序中，您应该确保问题域都相似，功能相似，只有内容不同（例如问答网站上的所有变体，但内容/域不同覆盖）。如果是这种情况，可能值得将它们保存在同一个站点中，因为它可以让您轻松共享登录信息和其他内容，如模板/代码。

否则恕我直言，您最好将它们拆分为单独的应用程序，这些应用程序共享代码和用户数据库，但在其他方面是不同的，并且随着它们的增长可能会出现分歧，同时在有意义的地方共享。

如果您分离应用程序，您可以将共享代码/模板放入 gem 或库（毕竟这就是 rails 的启动方式），然后您在所有应用程序之间共享，和/或将任何公共服务放入另一个后端 Web 应用程序中为他们提供服务，但用户从未见过。

登录不会跨域持续存在，因此您只能共享用户名/密码，而不是让他们持续登录，除非您创建一个与所有应用程序对话的服务。有关更多详细信息，请参阅此答案。

[如何创建跨多个域的共享登录服务？](https://stackoverflow.com/questions/4306728/how-to-create-a-shared-login-service-across-multiple-domains)

# visual-studio - Visual Studio f2 refactor.rename, file.rename

> ID：12623656
> 
> 赞同：13
> 
> 时间：2012-09-27T14:25:38.297
> 
> 标签：visual-studio, visual-studio-2010, keyboard-shortcuts

当我在解决方案资源管理器中选择文件或目录并按 F2 键时，我试图让 Visual Studio 重命名文件。但是，当我按下 F2 并且我在编辑器窗口中将光标放在变量上时，我还希望 Visual Studio 进行重构重命名。我知道这与设置每个（全局、文本编辑器等）的上下文有关。但是，我似乎找不到合适的组合。没有“解决方案资源管理器”上下文

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-04-29T10:02:03.333

以下是我在 Visual Studio (2013) 中为让 F2 在编辑器和解决方案资源管理器中工作所做的工作：

*   转到**工具/选项**菜单，然后选择**环境/键盘**
*   在“显示包含的命令”中放置**File.Rename**
*   在“使用新的快捷方式”中选择**解决方案资源管理器**
*   在“按快捷键”中按 F2，然后单击“分配”
*   在“显示包含的命令”中放置**Refactor.Rename**
*   在“使用新的快捷方式”中选择**文本编辑器**
*   在“按快捷键”中按 F2 并单击“分配”

我无法让它与“全球”一起工作。考虑到使用 F2 对 Microsoft 产品进行重命名无处不在，这对我来说似乎很奇怪，但至少它足够灵活，可以让您进行设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T17:15:40.083

我使用 Global 作为解决方案资源管理器，使用文本编辑器作为文本编辑器......到目前为止一切都很好

# jquery - 链接事件和 DOM 迭代

> ID：12623658
> 
> 赞同：8
> 
> 时间：2012-09-27T14:25:49.173
> 
> 标签：jquery

下面我有两个 jQuery 选择器。

首先在缓存对象中搜索 DOM 元素，然后搜索其父级，然后在父级（表）中搜索另一个 dom 元素。**（例如 2）**

第二行（2 行）通过缓存元素进行搜索。 **（例如 1）**

```
 $('element', table.setting.body).on('blur focus', table.focus).parents('parent').find('another element').on('click', function); // ex2

    $('element', table.setting.body).on('blur focus', function); // ex 1
    $('another element', table.setting.body).on('click', function); // ex 1 
```

哪一个更快/最佳实践？
前任。1毫无疑问会更快地引用jQuery函数，即。`.hide().animate().show()`但是，搜索 DOM 元素的时间是什么时候？

![在此处输入图像描述](../Images/5a685fe5ae47cfe397d1ac535683e1c7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T13:56:28.353

在我看来，这不是速度问题，而是可维护性和良好编码风格的问题。

这就是示例 1 比示例 2 好得多的地方。

避免混淆并将事情分开。您想将 2 个事件附加到 2 个不同的元素 - 编写 2 个语句。这使您的代码更具结构化和可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T13:47:50.030

我看到的唯一区别是在您的第一种方法中使用了父母。jQuery.parents 使用函数目录中的循环查找所需的父级：

```
parents: function( elem ) {
    return jQuery.dir( elem, "parentNode" );
},

// ...

dir: function( elem, dir, until ) {
    var matched = [],
        cur = elem[ dir ];

    while ( cur && cur.nodeType !== 9 && (until === undefined || cur.nodeType !== 1 || !jQuery( cur ).is( until )) ) {
        if ( cur.nodeType === 1 ) {
            matched.push( cur );
        }
        cur = cur[dir];
    }
    return matched;
}, 
```

(http://code.jquery.com/jquery-1.8.2.js)

`cur = elem[ dir ]`意味着`elem["parentNode"]`并且对所有父母重复，因为直到未定义。如果将想要的父级作为参考，则没有捷径可走。

根据您要查找的第一个元素和文档的根之间的路径长度，第一种方法需要更多的 DOM 操作。

所以我推荐第二种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:05:02.353

看起来您正在尝试匹配来自这些后代的不同后代`table.setting.body`并对这些后代执行不同的任务，而无需指定`table.setting.body`两次。

您可以使用[end()](http://api.jquery.com/end/)来实现这一点。例如，如果`table.setting.body`是一个 jQuery 对象，你可以这样写：

```
table.setting.body.find("element").on("blur focus", function).end()
                  .find("another element").on("click", function); 
```

（如果`table.setting.body`是 DOM 元素，则必须先应用`$()`它）。

上面的代码只对缓存的对象进行一次评估，执行两次调用`find()`（根据我的经验，比您`$()`使用`context`参数调用稍快），两次调用`on()`（与您的相同）和一次调用`end()`（仅弹出一个项目）一个堆栈，应该很快）。

# validation - Grails验证：从错误对象获取消息作为字符串

> ID：12623679
> 
> 赞同：2
> 
> 时间：2012-09-27T14:27:01.470
> 
> 标签：validation, grails

我的控制器方法中有一个验证命令对象，当验证失败时，我想打印出呈现为 JSON 的错误消息：

```
def doSomething(MyCommand cmd) {
    if (cmd.hasErrors()) {
        render ([success: false, error: cmd.errors.getFieldError("myfield")] as JSON)
    }
} 
```

这将打印字段错误的 JSON 表示，但我只想打印已解决的错误消息。我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T15:06:50.017

啊，我解决了这个问题：

```
render ([success: false, error: message(error: cmd.errors.getFieldError("myfield"))] as JSON) 
```

之前，我使用 message() 时出错，也许我当时又犯了另一个错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-05T09:16:02.320

这对我有用

`def errMsgList = domainClassObj.errors.allErrors.collect{g.message([error : it])}`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-03T14:58:26.527

帖子很旧，但这是我的解决方案。

```
import org.codehaus.groovy.grails.commons.ApplicationHolder

def myCommand = new MyCommand()

myCommand.errors.reject('Foo error')
myCommand.errors.reject('Bar message')
myCommand.errors.reject('myCommand.myfield.nullable')

def appHolder = ApplicationHolder.application.mainContext.getBean('org.codehaus.groovy.grails.plugins.web.taglib.ApplicationTagLib')
def list = myCommand.errors.allErrors.collect{appHolder.g.message([error: it])}
list 
```

结果：

```
["Foo error","Bar message","Property myfield cannot be null"] 
```

# ruby - 在 env.rb 文件（ruby/cucumber）中初始化全局路径

> ID：12623680
> 
> 赞同：2
> 
> 时间：2012-09-27T14:27:11.993
> 
> 标签：ruby, cucumber

尝试为 cucumber/ruby 测试框架创建初始配置，我正在考虑在 env.rb 文件中定义一些全局路径，如下所示：

```
def project_path
 File.expand_path(File.dirname(__FILE__) + '/../../../')
end

def config_path
 "#{project_path}/features/support/config"
end 
```

考虑然后从 ruby​​ 代码中调用这些路径。

我遇到的问题是，当我尝试运行测试时，它们失败了：

```
undefined local variable or method `config_path' for Configuration:Class (NameError) 
```

我想在模块/类尝试使用它之前没有定义'config_path'？有没有办法表明我们希望在完成其他任何事情之前处理 env.rb 文件中的所有内容？（不确定这是否已经完成并且失败在另一点？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T06:58:19.173

在 env.rb 中试试这个

```
ENV["RAILS_ENV"] ||= "cucumber"
require File.expand_path(File.dirname(__FILE__) + '/../../config/environment')

require 'cucumber/formatter/unicode'
require 'cucumber/rails/world'
require 'cucumber/rails/active_record'
require 'cucumber/web/tableish'
require 'webrat'
require 'webrat/core/matchers'

Webrat.configure do |config|
 config.mode = :rails
 config.open_error_files = false   
end

ActionController::Base.allow_rescue = false

Cucumber::Rails::World.use_transactional_fixtures = true 
```

# javascript - Javascript对象编程和对象表示

> ID：12623681
> 
> 赞同：0
> 
> 时间：2012-09-27T14:27:14.217
> 
> 标签：javascript, oop, methods, constructor

**设想**

当我写下以下代码（[此处](http://jsfiddle.net/UJmu6/)为演示）时，我正在玩弄一些 Javascript 对象编程：

```
 var o = {
        "key":1,
        "value": 1234,
        toString: function(){
            var res = this.key + ";" + this.value;
            return res;
        }
    };

    var p = {
        "key":2,
        "value": 5678
    };

    document.write(o);
    document.write("</br>");
    document.write(p); 
```

如您所见，拥有一个 toString() 方法`o object`可以在不调用 toString() 方法的情况下显示 ，而`p object`显示为...作为什么？

**问题**

1.  文字是`toString`对象表示的一种默认名称吗？或者还有什么？

2.  `[object Object]`符号是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:44:08.743

> toString 文字是对象表示的一种默认名称吗？或者还有什么？

它是`toString`对象属性的函数。

在 Javascript 中，当一个对象被转换为一个字符串时（[EcmaScript §9.8: ToString](http://ecma-international.org/ecma-262/5.1/#sec-9.8)，例如在字符串连接中使用时，或者在`alert()`or中`document.write()`）它的`toString`方法被调用（通过[ToPrimitive](http://ecma-international.org/ecma-262/5.1/#sec-9.1)和[DefaultValue - §8.12.8](http://ecma-international.org/ecma-262/5.1/#sec-8.12.8)）。

通常，您会在自定义对象的原型上指定它，并且所有内置类型都有一个（例如`Array.prototype.toString`，用逗号连接值）。您已在对象文字中明确设置它。

> [object Object] 表示法是什么意思？

这是`toString`对象的默认实现的结果，即。对于`Object`. [EcmaScript §15.2.4.2](http://ecma-international.org/ecma-262/5.1/#sec-15.2.4.2)指定`Object.prototype.toString`返回`[object`+ *class* + `]`，普通对象的内部 [[class]] 是“Object”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:29:59.253

toString 不是文字，它是一个函数，是为所有对象定义的。记住函数是 javascript 中的“头等舱”。

这`[object Object]`是浏览器默认 toString() 对象的返回值。

这是 Mozilla 的优秀文档：

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/toString](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/toString)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:33:01.123

1.  当一个对象被发送到 write 时，write 在内部调用对象的 toString 方法，该方法可能（如在 o 中）或可能不会（如在 p 中）被覆盖。

2.  在 toString 的默认实现中，第一个`object`定义它是一个对象（与数组或原语相反），第二个`Object`定义它是一个 Object 类型的对象。一些没有有意义的字符串表示的内置对象类型（例如 DOM 节点）返回它们的类型名称而不是 Object。当您希望自己的对象在传递给 write 时输出其类型名称，您必须重写 toString。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T14:36:48.070

JavaScript 中的每个对象都有一个`toString()`方法，当对象在字符串上下文中使用时会隐式调用该方法，例如 with ，`document.write(o)`但也可以在编写`o + ' another string'`.

该方法`'[object Object]'`默认返回，这不是很有用，但可以覆盖它以返回您喜欢的任何内容；对象，例如`Numeric`，`String`或`Date`执行此操作。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-27T14:35:46.790

'[object Object]' 由默认`toString`方法返回，该方法由`Object`.

# javascript - 活动 | jQuery 还是骨干网？

> ID：12623682
> 
> 赞同：5
> 
> 时间：2012-09-27T14:27:22.153
> 
> 标签：javascript, jquery, backbone.js

下面是来自 Backbone.js 的相关代码

Backbone 事件是否与 jQuery 事件有任何关系？或者你应该选择。

例如对于[jQuery click](http://api.jquery.com/click/)你使用：

```
$("#target").click(function() {
  alert("Handler for .click() called.");
}) 
```

对于骨干，他们[有这个](http://backbonejs.org/#Events)

```
var object = {};

_.extend(object, Backbone.Events);

object.on("alert", function(msg) {
  alert("Triggered " + msg);
});

object.trigger("alert", "an event"); 
```

**带事件触发器的主干模型**

```
var Sidebar = Backbone.Model.extend({
  promptColor: function() {
    var cssColor = prompt("Please enter a CSS color:");
    this.set({color: cssColor});
  }
});

window.sidebar = new Sidebar;

sidebar.on('change:color', function(model, color) {
  $('#sidebar').css({background: color});
});

sidebar.set({color: 'white'});

sidebar.promptColor(); 
```

**骨干网相关事件代码**

```
var Events = Backbone.Events = {
    on: function(events, callback, context) {
        var calls, event, node, tail, list;
        if (!callback) {
            return this;
            events = events.split(eventSplitter);
            calls = this._callbacks || (this._callbacks = {});
        while (event = events.shift()) {
            list = calls[event];
            node = list ? list.tail : {};
            node.next = tail = {};
            node.context = context;
            node.callback = callback;
            calls[event] = {tail: tail, next: list ? list.next : node};
        }
        return this;
    },
    off: function(events, callback, context) {
        var event, calls, node, tail, cb, ctx;
        if (!(calls = this._callbacks)) return;
        if (!(events || callback || context)) {
            delete this._callbacks;
            return this;
        }
        events = events ? events.split(eventSplitter) : _.keys(calls);
        while (event = events.shift()) {
            node = calls[event];
            delete calls[event];
            if (!node || !(callback || context)) continue;
            tail = node.tail;
            while ((node = node.next) !== tail) {
                cb = node.callback;
                ctx = node.context;
                if ((callback && cb !== callback) || (context && ctx !== context)) {
                    this.on(event, cb, ctx);
                }
            }
        }
        return this;
    },
    trigger: function(events) {
        var event, node, calls, tail, args, all, rest;
        if (!(calls = this._callbacks)) return this;
        all = calls.all;
        events = events.split(eventSplitter);
        rest = slice.call(arguments, 1);
        while (event = events.shift()) {
            if (node = calls[event]) {
                tail = node.tail;
                while ((node = node.next) !== tail) {
                    node.callback.apply(node.context || this, rest);
                }
            }
            if (node = all) {
                tail = node.tail;
                args = [event].concat(rest);
                while ((node = node.next) !== tail) {
                    node.callback.apply(node.context || this, args);
                }
            }
        }
        return this;
    }
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:30:34.823

从[文档](http://documentcloud.github.com/backbone/#View-delegateEvents)，骨干网：

> 使用 jQuery 的委托函数为视图中的 DOM 事件提供声明性回调。

代码的显着片段是[这样](http://documentcloud.github.com/backbone/docs/backbone.html#section-156)的：

```
if (selector === '') {
  this.$el.bind(eventName, method);
} else {
  this.$el.delegate(selector, eventName, method);
} 
```

...它要求 jQuery（或 zepto，或任何其他提供`$`操作员的东西）来处理事件委托。

因此，如果有问题的事件是使用视图的[`delegateEvents`](http://documentcloud.github.com/backbone/docs/backbone.html#section-156)方法绑定的，则绑定是通过 jQuery 发生的。

然而，该`Backbone.Events`模块本身旨在与独立对象（而不是 DOM 元素）一起使用，并在[Backbone 源](http://documentcloud.github.com/backbone/docs/backbone.html#section-18)中独立定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:32:33.823

您的问题对我来说有点莫名其妙，我不确定您是否想知道 Backbone 核心与 jQuery 核心的来龙去脉，或者您对 MVVM 以及为什么要使用它感到困惑。无论哪种方式，将每个库的核心分开是无关紧要的，因为它们以不同的方式用于实现相同的目标。

由于框架的不同，这两种方法是不同的。Backbone.js（和 Knockout）是 MVVM 框架的一部分，允许在 JavaScript 函数和表示层之间进行一层分离。然而，jQuery 没有。

IE

MVVM：

用户控制 -> ViewModel -> JavaScript 处理

这种 JavaScript 处理可以通过 jQuery 函数来完成，jQuery 和 Backbone.js 可以无缝地协同工作。

主要优势？MVVM (Backbone.js)，你不依赖控制 ID，如果它们改变了，那么你的代码仍然有效。jQuery专门分配ID的方式，不是这样的。

就我个人而言，我会采用 MVVM 方法。

# ruby - rails 3中的未定义方法

> ID：12623688
> 
> 赞同：1
> 
> 时间：2012-09-27T14:28:01.090
> 
> 标签：ruby, ruby-on-rails-3

好的，我正在尝试学习 ruby​​/rails（我在 1993 年开始学习 C++）

谁能告诉我这是为什么：

```
class FeedHolder
    @rssfeed
    @rss

    #attr_accessor :rssfeed,:rss

    def rssfeed
        @rssfeed
    end

    def initialize(feed,rss)
        @rssfeed,@rss = feed, rss
    end
end 
```

像这样填充

```
 @rssfeeds.each do |rssfeed|
    @myrssurl=rssfeed.url.gsub(/'/,"")  
    @rss=Feedzirra::Feed.fetch_and_parse(@myrssurl) 
    @myfeedguy = FeedHolder.new(rssfeed,@rss)
    @myrsslist.push(@myfeedguy) 
```

给我这个错误

“#FeedHolder:0xa0a8bec 的未定义方法 `rssfeed'”

当我这样做？顺便说一句，即使它没有 getter，它也不会抱怨对 myfeedguy.rss 的调用，是的，我尝试了 attr_accessor 和其他一些东西。

```
<% @myrsslist.each do |myfeedguy| %>
<% if(myfeedguy.rss == 0) then %>
        "No feeds to show"</br>
    <% else %>
        <%=myfeedguy.rssfeed%>

        </br>
            <a href='' onclick='showfeed("")'>x</a>
        </br>
    <% end %>
<%end%> 
```

提前谢谢斯图尔特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:52:43.477

好像你在正确的轨道上。这个例子有帮助吗？

```
class FeedHolder
  def initialize(feed,rss)
    @rssfeed, @rss = feed, rss
  end
  attr_accessor :rssfeed,:rss
end

@rssfeeds = %w(a b c d)
@myrsslist = []

def fetch_and_parse(rssurl)
  "Imagine this was fetched and parsed from: #{rssurl}"
end

@rssfeeds.each do |rssfeed|  
  myrssurl = rssfeed.gsub(/'/,"")  
  rss = fetch_and_parse(myrssurl) 
  myfeedguy = FeedHolder.new(rssfeed, rss)
  @myrsslist.push(myfeedguy)
end

require 'pp'
pp @myrsslist 
```

输出：

```
$ ruby tmp.rb 
[#<FeedHolder:0x00000001b00800
  @rss="Imagine this was fetched and parsed from: a",
  @rssfeed="a">,
 #<FeedHolder:0x00000001b00738
  @rss="Imagine this was fetched and parsed from: b",
  @rssfeed="b">,
 #<FeedHolder:0x00000001b00670
  @rss="Imagine this was fetched and parsed from: c",
  @rssfeed="c">,
 #<FeedHolder:0x00000001b005a8
  @rss="Imagine this was fetched and parsed from: d",
  @rssfeed="d">] 
```

# c++ - QSharedPointer 和 QObject::deleteLater

> ID：12623690
> 
> 赞同：9
> 
> 时间：2012-09-27T14:28:07.837
> 
> 标签：c++, qt, shared-ptr, qobject, qsharedpointer

我有一种情况，一个`QSharedPointer`托管对象表示它已经完成了它的目的并准备好很快删除（在执行后离开函数发出我的`readyForDeletion`信号）。使用*普通*指针时，我只调用对象，但是使用-managed 实例`QObject::deleteLater`是不可能的。`QSharedPointer`我的解决方法如下：

```
template<typename T>
class QSharedPointerContainer : public QObject
{
   QSharedPointer<T> m_pSharedObj;

public:

   QSharedPointerContainer(QSharedPointer<T> pSharedObj)
      : m_pSharedObj(pSharedObj)
   {} // ==> ctor

}; // ==> QSharedPointerContainer

template<typename T>
void deleteSharedPointerLater(QSharedPointer<T> pSharedObj)
{
   (new QSharedPointerContainer<T>(pSharedObj))->deleteLater();
} // ==> deleteSharedPointerLater 
```

这很好用，但是使用这种方法有很多开销（分配一个新的`QObject`等等）。有没有更好的解决方案来处理这种情况？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-27T14:44:04.500

您可以将`QSharedPointer` [构造函数](http://qt-project.org/doc/qt-4.8/qsharedpointer.html#QSharedPointer-3)与`Deleter`：

> deleter 参数指定此对象的自定义删除器。当强引用计数下降到 0 时，将调用自定义删除器，而不是运算符 delete()。例如，这对于在 QObject 上调用 deleteLater() 很有用：

```
 QSharedPointer<MyObject> obj =
         QSharedPointer<MyObject>(new MyObject, &QObject::deleteLater); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-16T00:37:19.767

另一种方法是使用[QPointer](http://doc.qt.io/qt-5/qpointer.html)而不是[QSharedPointer](http://doc.qt.io/qt-5/qsharedpointer.html)，引用文档：

> QPointer 类是一个模板类，它提供指向 QObject 的受保护指针。
> 
> 受保护的指针 QPointer 的行为类似于普通的 C++ 指针 T *，只是它在被引用的对象被销毁时自动设置为 0（与普通的 C++ 指针不同，在这种情况下会变成“悬空指针”）。T 必须是 QObject 的子类。

# c# - 页面处理之间的会话变量值以某种方式发生变化

> ID：12623691
> 
> 赞同：1
> 
> 时间：2012-09-27T14:28:09.187
> 
> 标签：c#, asp.net, session-variables

我有一个处理搜索查询的脚本。结果返回时带有一个可排序的标题，因此单击 Lot # 列标题将按批次 # ASC 对结果进行排序。但是，如果您已经对它进行了 ASC 排序（它存储在会话变量中），它将更改它以按批次 # DESC 对其进行排序（并更新该会话变量）。

只要搜索结果中不包含缩略图，所有这些都可以完美运行。当我确实包含它们时（所做的只是将搜索查询更改为包含图像路径，然后为图像列输出图像），一切都会中断。这是发生的事情：

当页面加载时，我`response.write(Session["sort"])`看看我是如何排序的（ASC 或 DESC）。

如果单击列标题，我会检查新的“order by”列是否已经是“order by”列（也存储在会话变量中`Session["orderby"]`）。

如果之前未将其设置为 order by 变量，则它将排序会话变量设置为 ASC，并将 order by session 变量设置为列名。

如果它以前被设置为 order by 变量，它会检查当前排序会话变量等于什么。如果它等于 ASC，那么它将排序会话变量设置为 DESC，并且会话变量的顺序保持不变。如果它等于 DESC，它将排序会话变量设置为 ASC，并且 order by 变量保持不变。

这部分实际上仍然有效。问题是在处理页面结束时，我再次`response.write(Session["sort"])`查看变量已设置为什么。这是页面加载到屏幕之前发生的最后一件事。所以请记住，当页面被点击时发生的第一件事就是打印出排序会话变量，而它做的最后一件事就是再次打印出该变量。

因此，当页面中包含图像时，单击一列将使其按 ASC 或 DESC 排序（取决于我单击的列，因为它似乎与其他列交替出现）。因此，假设我单击的列导致第一个`response.write(Session["sorty"])`为空白（因为尚未设置），第二个打印 ASC。当我再次单击该列时，第一个将打印 DESC（应该是 ASC，因为在最后一个打印的和第一个打印的之间绝对没有任何变化），第二个再次打印 ASC。

所以不知何故，当最后一次打印和第一次打印之间绝对没有页面处理时，会话变量在页面加载之间被更改。（并且在每隔一列中，它是相反的，每次都在顶部显示 ASC，在底部显示 DESC。）同样，这在没有图像的情况下完美运行。

这是其中包含缩略图的唯一代码：

```
 if (Session["incThumb"] != null)
    {
        resultText += "<table style=\"width:100%;\">\n<tr style=\"font-weight:bold;text-align:left;\">\n<th style=\"border-bottom:1px solid #000;\">Thumb</th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_id\">Item ID</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=item_title\">Title</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_lot\">Lot</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_cs_txt_id\">Consignor ID</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblMcat.mcat_name\">Master Category</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblCat.cat_name\">Category</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_est_lo\">Low Est.</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_est_hi\">High Est.</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_reserve\">Reserve</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_status\">Status</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_pr\">Hammer Price</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblMailList.mail_ID\">Bidder ID</a></th>\n</tr>\n";
    }
    else
    {
        resultText += "<table style=\"width:100%;\">\n<tr style=\"font-weight:bold;text-align:left;\">\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_id\">Item ID</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=item_title\">Title</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_lot\">Lot</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_cs_txt_id\">Consignor ID</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblMcat.mcat_name\">Master Category</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblCat.cat_name\">Category</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_est_lo\">Low Est.</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_est_hi\">High Est.</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_reserve\">Reserve</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_status\">Status</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblItem.item_pr\">Hammer Price</a></th>\n<th style=\"border-bottom:1px solid #000;\"><a style=\"font-weight:bold; font-color:#000000;\" href=\"searchResults.aspx?page=" + page + "&orderBy=tblMailList.mail_ID\">Bidder ID</a></th>\n</tr>\n";
    } 
```

然后就在下面，我在打印 SQL 结果时也考虑了它，即（英文），如果用于包含缩略图的会话变量不为空，则包含用于缩略图的额外表格单元格并添加到图像中。

不用说，这个让我难过。我将不胜感激任何和所有的回应/评论。如果您想查看更多代码，请告诉我。

**编辑**

这是 response.write 代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    Response.Write(Session["sort"] + " 1<br/>");
    string orderBy = "";

    base.SubNavItems.Add("Search Home", "searchHome.aspx");

    if (!IsPostBack)
    {
    }

    if (!String.IsNullOrEmpty(Request.QueryString["page"]))
    {
        if (!String.IsNullOrEmpty(Request.QueryString["orderBy"])){
            orderBy = Request.QueryString["orderBy"].ToString();
        }
        get_page(Int32.Parse(Request.QueryString["page"].ToString()), orderBy);
    }

    if (!String.IsNullOrEmpty(Request.Form["ctl00$ContentPlaceHolder1$save"]))
    {
        click_search();
    }

    Response.Write(Session["sort"] + " 1<br/>");
} 
```

所以因为页面总是设置在列标题中，所以`get_page()`当我对列进行排序时会调用该方法。 `orderBy`通过查询字符串设置并传递给`protected void get_page(Int32 page, String orderBy)`包含以下代码的方法。在该方法的末尾也是`Response.Write(Session["sort"] + " 2<br/>");`一行，它是该方法所做的最后一件事。此时没有其他方法运行。此外，我刚刚从 .aspx 页面打印出排序变量，得到的结果与上次打印出的 .aspx.cs 页面打印的变量相同（这与下一次打印的第一个不同）。

我想我会继续并将逻辑添加到整个 order by/sort 中：

```
 if (Session["orderBy"] != null)
    {
        if (Session["orderBy"].ToString() == orderBy)
        {
            if (Session["sort"].ToString() == "ASC")
            {
                Session["sort"] = "DESC";
            }
            else
            {
                Session["sort"] = "ASC";
            }
        }
        else if (!String.IsNullOrEmpty(orderBy))
        {
            Session["sort"] = "ASC";
            Session["orderBy"] = orderBy;
        }
    }
    else if (!String.IsNullOrEmpty(orderBy))
    {
        Session["sort"] = "ASC";
        Session["orderBy"] = orderBy;
    }
    else
    {
        Session["sort"] = "ASC";
        Session["orderBy"] = "tblItem.item_id";
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:03:13.693

我猜你在 IE 中遇到过这种情况。

此外，我猜测很可能存在无效的图像源，因此它会发回根目录。我们曾经也遇到过这个问题，直到您使用类似`FireBug`或`Fiddler`. 由于`Page_Load`.

实际上，当图像 URL 失败时，ASP.NET 将在页面的根目录接收请求，从而回发并清除信息。

另外，请遵循@peer 的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:59:49.433

当我读到你的帖子时，我想知道为什么你把变量放在会话中，变量在控件/页面的上下文中，所以你应该把它们放在 ViewState 中。当您将它们放入会话中时，它将在您网站的多个页面上共享，这可能会导致您的行为。我猜当您在站点上使用后退按钮时，您还会有意外的行为，这是由于将变量存储在会话中而不是视图状态中造成的。

将所有 Session 替换为 ViewState（orderBy 和 sort），看看你是否仍然有奇怪的行为。

# objective-c - 这行代码是如何工作的？AFNetworking/CFURLCopyPassword

> ID：12623698
> 
> 赞同：1
> 
> 时间：2012-09-27T14:28:30.027
> 
> 标签：objective-c, ios, authentication, afnetworking

这行代码是如何工作的？

我正在尝试修改 URL 以使其正常工作，但是从查看 Apple 文档来看，它并没有提供太多关于我应该将密码/URL 放在哪里的信息。

```
 NSString *password = [(NSString *)CFURLCopyPassword((CFURLRef)[self.request URL]) autorelease]; 
```

这行代码是 AFNetworking 框架的一部分，因此我可以通过身份验证。

应该如何构建 URL 以正确获取密码？我还没有运气。

我试着把它放在前面的用户名：密码，但这是不对的。密码不会被抓住。

所以基本上[http://userid:password@www.anywhere.com/](http://userid:password@www.anywhere.com/)完全绕过了这个方法，这不是我想做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:33:29.747

[您可以在此处](http://www.cs.rutgers.edu/~watrous/user-pass-url.html)找到此身份验证方式的简短描述，有关更多详细信息，您必须查找正确的标准描述 URL。

URL 示例，以防页面稍后不可用：`ftp://username:password@hostname/`

[https://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSURLConnectionDelegate_Protocol/Reference/Reference.html](https://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSURLConnectionDelegate_Protocol/Reference/Reference.html)

> 如果委托未实现此方法，则使用默认实现。**如果请求的有效凭据** **作为 URL 的一部分提供**，或者可从 NSURLCredentialStorage 获得，**则 [challenge sender] 将发送 ** *useCredential:forAuthenticationChallenge:*和凭据**。如果质询没有凭据或凭据无法授权访问，则 continueWithoutCredentialForAuthenticationChallenge: 被发送到 [challenge sender]。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:37:05.340

本质上 - 一些 URL 的结构包含用户名和密码

```
http://userid:password@www.anywhere.com/ 
```

如果您将具有这种格式的 URL 传递给函数，如果格式正确，它将返回 URL 的密码部分，否则返回空字符串`(CFSTR(""))`。

以同样的方式，您可以使用该`CFURLCopyUserName`功能获取用户 ID。

# ios - 调整 nib 中 UIImageView 的宽度

> ID：12623700
> 
> 赞同：0
> 
> 时间：2012-09-27T14:28:39.473
> 
> 标签：ios

我真的很难理解为什么这不起作用：我在笔尖中有一个 UIImageView，我需要在 viewDidLoad 中覆盖它的框架，因为宽度会根据用户输入而改变。这是我尝试更改其框架的方式：

```
CGRect blueBarStart = blueBar.frame;
blueBarStart.size.width = .1*blueBarStart.size.width;
[blueBar setFrame:blueBarStart]; 
```

然而`blueBar`，在负载时显示其完整的、未改变的宽度。不知道我错过了什么。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:33:05.680

期间视图未完全加载/配置`viewDidLoad`，因此您在期间所做的任何更改`viewDidLoad`都可能被覆盖/重置。尝试将调整大小的代码移动到`viewWillAppear`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:58:55.710

事实证明，因为我使用 'Left' 作为 的模式`UIImageView`，它会强制显示其中的完整图像，无论我将宽度设置为多少。

# c++ - 为什么我的 lexical_words 函数中的 forloop 没有将字符串数组（'keyWords'）中的单词与字符串迭代器中的单词进行比较？

> ID：12623701
> 
> 赞同：0
> 
> 时间：2012-09-27T14:28:38.857
> 
> 标签：c++, regex, list, for-loop

```
#include<iostream>
#include<regex>
#include<string>
#include<fstream>
#include<list>
#include<vector>
#include<string>

using namespace std;

void lexical_words(string,string*,vector<string> &); // the forloop is not properly   comparing the            words in my "keyWords" with words from the iterator
void lexical_integer(string);
void lexical_operators(string);
void lexical_reals(string);
void lexical_separators(string);
void lexical_identifies(string);

list<string> someWords;

void lexical_integer(string seq)
{
    ofstream fout;
    fout.open("output.txt",ios::app);

    regex digits("(\\d+)");
    regex_iterator<string::iterator> itd(seq.begin(), seq.end(), digits);
    regex_iterator<string::iterator> end;

    for (; itd != end; ++itd)
    {
        cout << itd->str() <<" " <<" integer"<< endl;
        fout<<itd->str()<< " "<<" integer"<<endl;
    }
    fout.close();
}

void lexical_identifier(string seq)
{
    ofstream fout;
    fout.open("output.txt",ios::app);

    regex digits("^[a-zA-Z_][a-zA-Z0-9_]*$");
    regex_iterator<string::iterator> itd(seq.begin(), seq.end(), digits);
    regex_iterator<string::iterator> end;

    for (; itd != end; ++itd)
    {
        cout << itd->str() <<" " <<" identifier"<< endl;
        fout<<itd->str()<< " "<<" identifier"<<endl;
    }
    fout.close();
}

void lexical_separators(string seq)
{
ofstream fout;
fout.open("output.txt",ios::app);

regex digits("(\\W)");
regex_iterator<string::iterator> itd(seq.begin(), seq.end(), digits);
regex_iterator<string::iterator> end;

for (; itd != end; ++itd)
{
    cout << itd->str() <<" " <<" Separator"<< endl;
    fout<<itd->str()<< " "<<" Separator"<<endl;
}
fout.close();
    }

   void lexical_reals(string seq)
    {
ofstream fout;
fout.open("output.txt",ios::app);

regex digits("^[0-9]*(\\.[0-9]+)$");
regex_iterator<string::iterator> itd(seq.begin(), seq.end(), digits);
regex_iterator<string::iterator> end;

for (; itd != end; ++itd)
{
    cout << itd->str() <<" " <<" real number"<< endl;
    fout << itd->str() <<" " <<" real number"<< endl;
}
fout.close();
    } 

   **void lexical_words(string seq,string * keyWords,vector<string>& sVector)
   {
ofstream fout;
fout.open("output.txt",ios::app);
regex words("(\\w+)");
regex_iterator<string::iterator> itd(seq.begin(), seq.end(), words);
regex_iterator<string::iterator> end;
//int size;

//size = sizeof(keyWords);

    for (; itd != end; itd++)
    {   
        for(int k = 0; k < sVector().size;k++)
        {
            if(keyWords[k] == itd->str())
            {
            cout << itd->str() <<" " <<" keyword"<< endl;
            fout << itd->str() <<" " <<" keyword"<< endl;
            }
        }
    }

fout.close();
           }**

      int main()
     {

char operators[] ={'+','-','*','`','!','\\','&','|','~',
'<','>','=',':','%','^'}; 

char separators[] = { '(', ')', '{','}','[', ']',  ';', ':', '"', '?', ',', '.',      '//', '#'}; 

char numbers[] = {'0','1','2','3','4','5','6','7','8','9'};

string keyWords[] = {"while","for","do","if","else","int","double","long","array","break",
    "case","catch","switch","bool","char","class","const","continue","default","delete",
    "enum","event","enum class","explicit","extern","false","finally","float","friend","goto"
    "new","private","protected","static","short","true","void","try","this","struct","throw","signed","cin","cout","using"
"namespace","std"};

    vector<string> sVector;
    sVector.assign(keyWords,keyWords+47);

string line;
ifstream fin;
string fName;
//cout<<"please enter your file name"<<endl;
//cin>>fName;
//fin.open(fName.c_str());
//while(!fin)
//{
    //cout<<"wrong file name"<<endl;
    //cin>>fName;
    fin.open("C:\\Users\\vishal\\Desktop\\tokens.txt");
//}
while(!fin.eof())
{

fin>>line;
lexical_words(line,keyWords,sVector);
lexical_identifier(line);
lexical_separators(line);
lexical_integer(line);
lexical_reals(line);

}
cout<<"The same output has also been created in a file called output.txt"<<endl;
system("pause");
return 0; 
```

}

我写了一个分词器程序。我想将我从正则表达式迭代器中获得的单词与我的列表中名为“keyWords”的单词进行比较，如果它们匹配则将它们输出到屏幕上。但是，由于某种原因，我的 forloop 没有推进计数器，并且只有我的列表 "keyWords" 的第一个单词，即 "while"，正在与迭代器生成的单词进行比较。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:30:56.037

这是不正确的：

```
size = sizeof(keyWords); 
```

因为它将返回`sizeof(std::string*)`，而不是数组中的元素数`keyWords`。要么将数组中的元素数量作为参数传递，要么更改为可以查询它的[`std::vector<std::string>`](http://en.cppreference.com/w/cpp/container/vector)(or )，或者使用and进行迭代。例如：[`std::array<std::string, N>`](http://en.cppreference.com/w/cpp/container/array)`size()``begin()``end()`

```
const std::array<std::string, 2> keyWords = { { "do",
                                                "while" }
                                            }; 
```

更改函数以`const std::array<std::string, 2>&`取而代之的是一个参数。为方便起见，您可以`typedef`使用数组：

```
typedef std::array<std::string, 2> keyword_array_t; 
```

# ruby-on-rails - 无法在 Rails 中创建数据库对象

> ID：12623708
> 
> 赞同：1
> 
> 时间：2012-09-27T14:29:09.580
> 
> 标签：ruby-on-rails

我正在创建一个简单的费用表，ActiveRecord 方法似乎都不适用于创建数据对象并传递参数。我以前做过同样的事情，没有任何问题，它适用于现有的表，所以我必须遗漏一些简单的东西（我是新手）。

这是我所做的：1）创建了一个迁移：

```
rails generate migration create_expenses 
```

2）修改迁移：

```
class CreateExpenses < ActiveRecord::Migration
  def up
    create_table 'expenses' do |t|
      t.string :description
      t.date :date
      t.timestamps
    end
  end
  def down
    drop_table 'expenses'
  end
end 
```

3) 迁移

```
rake db:migrate 
```

4) 创建模型

```
class Expense < ActiveRecord::Base
end 
```

5）测试并尝试创建费用

```
testexp= Expense.create!(description: "Test Expense", date: "9/27/12")
 SQL (1.7ms) INSTERT INTO "expenses" ("created_at", "date", "description", "updated_at") VALUES (?,?,?,?) [["created_at", Thu, 27 Sep 2012 13:50:47 UTC +00:00],["date", nil], ["description", nil], ["updated_at", Thu, 27 Sep 2012 13:50:47 UTC +00:00]]
=> #<Expense id: 1, description:nil, date:nil, created_at: "2012-09-27 13:50:47", updated_at: "2012-09-27 13:50:47"> 
```

*我已经尝试了所有不同形式的散列、创建、新建等。似乎都不起作用。创建后，我可以通过 testexp.description = "Test Expense", testexp.save 更改值。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:35:23.060

看来您的数据库确实存在并且正在查找，因此是新创建的记录。
我认为您的问题可能是您在创建时没有正确添加参数，它实际上应该如下所示：

```
Expense.new(:description => "Test Expense", :date => "9/27/12") 
```

# iphone - 在 TableViewController 中使用 UINavigationController 方法

> ID：12623714
> 
> 赞同：0
> 
> 时间：2012-09-27T14:29:37.470
> 
> 标签：iphone, ios, uinavigationcontroller

我有一个关于 UINavigationController 的问题。我所做的是，我设置了一个导航控制器来处理一个视图控制器，我们将其命名为 A。现在我要做的是在视图控制器 A 上放置一个 UIView，并在该视图之上放置一个 tableview。tableViewcontroller 及其委托在单独的类中定义。现在我想做的是在用户单击表格单元格时使用“pushViewController”方法推送一个新的视图控制器。我是否必须将导航控制器的引用一直传递到我的 tableview 控制器？或者我应该如何从 tabelviewcontroller 类中获取我的导航控制器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:34:18.533

这是我能够开始工作的[教程。](http://codenugget.org/how-to-embed-a-navigation-controller-inside-a)

我还阅读了有关该主题的官方 SDK 文档： [Combining Tab Bar and Navigation Controllers](http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/CombiningToolbarandNavigationControllers/CombiningToolbarandNavigationControllers.html#//apple_ref/doc/uid/TP40007457-CH8-SW1)。由于我仍在学习，因此本[教程](http://codenugget.org/how-to-embed-a-navigation-controller-inside-a)对我的帮助超过了文档。

否则试试这段代码

```
- (void)applicationDidFinishLaunching:(UIApplication *)application { 

// Create instance of UINavigationController
UINavigationController *myNavigationController;
// Create initialized instance of UITabBarController
UITabBarController *tabBarController = [[UITabBarController alloc] init];
// Create initialized instance of NSMutableArray to hold our UINavigationControllers
NSMutableArray *tabs = [[NSMutableArray alloc] init];

// Create first UIViewController
UIViewController *myFirstViewController = [[UIViewController alloc] init];
[myFirstViewController setTitle:@"First"];
// Initialize the UINavigationController
myNavigationController = [[UINavigationController alloc] initWithRootViewController:myFirstViewController];
// Add UINavigationController to you tabs
[tabs addObject:myNavigationController];
// Release UIViewController and UINavigationController
[myFirstViewController release], [myNavigationController release];

// Create second UIViewController
UIViewController *mySecondViewController = [[UIViewController alloc] init];
[mySecondViewController setTitle:@"Second"];
// Initialize the UINavigationController
myNavigationController = [[UINavigationController alloc] initWithRootViewController:mySecondViewController];
// Add UINavigationController to you tabs
[tabs addObject:myNavigationController];
// Release UIViewController and UINavigationController
[mySecondViewController release], [myNavigationController release];

// Add the tabs to the UITabBarController
[tabBarController setViewControllers:tabs];
// Add the view of the UITabBarController to the window
[self.window addSubview:tabBarController.view];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:48:54.767

在您拥有 UITableViewDelegates 的单独 UITableView 类中说（yourTableView），`id delegate;` 从您的 viewController 中声明一个属性 A ，主题`yourTableView.delegate = self;`

也许在 yourTableViewClass 的 didSelectRowAtIndexPath 中推送 didSelect 一如既往地创建要推送的 newController 实例（例如 newController）最后..

```
[delegate.navigationController pushViewController:newController animated:YES]; 
```

这里'delegate'原来是viewController A，你已经分配了一个UINavigationController。希望这有效

# umbraco - 如何更改 Umbraco 网站的根目录？

> ID：12623716
> 
> 赞同：1
> 
> 时间：2012-09-27T14:29:45.677
> 
> 标签：umbraco

我有一个网站和我开发网站的子页面。例子：

```
www.developersite.com/website1   
www.developersite.com/website2 
```

然后我为每个页面设置了 Umbraco。但是当我去现场

```
www.website1.com
www.website2.com 
```

我想确保媒体链接等指向正确的位置。我的问题是，我可以将 www.developersite.com/website1 设置为 website1 的根吗？使媒体文件的形式

```
img src="/media/example.png" 
```

工作正常等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T21:44:51.443

如果您要在 Umbraco 中托管多个站点（并且对此的支持非常好），我认为您希望将站点置于根目录。听起来您正在添加一些容器来保存层次结构中较高的子站点。

你应该有：

```
root
--www.website1.com
--www.website2.com 
```

不是：

```
root
--www.developersite.com
----www.website1.com
----www.website2.com 
```

现在`/media/1.jpg`调用 from 时`website1.com/index.htm`将解析为`website1.com/media/1.jpg`

# sql - 对按多个字段分组的数量求和

> ID：12623717
> 
> 赞同：0
> 
> 时间：2012-09-27T14:29:50.157
> 
> 标签：sql, database, oracle, plsql, sum

这是我之前的问题的后续。我只是觉得如果我再次解释这一切会更容易，因为我想尝试从我的查询中获取更多细节。所以我们开始：

示例表：（注意：该表有 100 个 ID，每个 ID 都有许多不同的 LOTNO）

ITEMNO LOTNO TRANS_QUAN TRANS_TYPE

* * *

```
 1      45        16          PO  
 1       3         2          PO  
 1      45        47          MH  
 1      45         3          MH
 1       3         8          MH 
```

到目前为止，我没有考虑每个 ID 的不同 LotNo，而是根据 ID 和 TYPE 求和。下面的代码汇总了 ID = 1 的 TYPE = 'PO' 的所有数量值。然后将它们与 ID = 1 的 TYPE = 'MANUAL/BACKFLUSH' 的所有总数量值进行比较。此代码在这方面非常有效（非常感谢给尼古拉斯克拉斯诺夫这个）：

```
 SELECT * 
 FROM (SELECT TR.ITEMNO
         , ROUND(SUM(TR.TRANS_QUAN * (DECODE(TR.TRANS_TYPE, 'PO', 1, 0)))) AS SUM_IN
         , ROUND(SUM(TR.TRANS_QUAN * (DECODE(TR.TRANS_TYPE, 'MANUAL/BACKFLUSH', 1,0))))AS SUM_OUT
     FROM IQMS.TRANSLOG TR
     GROUP BY IQMS.TR.ITEMNO
     ORDER BY IQMS.TR.ITEMNO)
 WHERE SUM_OUT > SUM_IN 
```

我想进一步分解总和计算并合并 LOTNO 字段。所以在上表中，对于 ID = 1，我想对 ID = 1、LotNo = 45 和 TYPE = PO 的所有值求和，然后将它们与 ID = 1、LotNo = 45 和 TYPE = 'MANUAL\BACKFLUSH' 进行比较。

然后我想继续比较 (ID = 1, LOTNO = 3, TYPE = 'PO') 与 (ID = 1, LOTNO = 3, TYPE ='MANUAL/BACKFLUSH') 等等。

我也只想返回 SUM_OUT > SUM_IN 的记录

我希望我的输出是这样的

```
ID      LOTNO     SUM_IN      SUM_OUT    

 1        45        30           50
 1         3         2            8 
```

关于如何将其合并以提供更具体的结果集的任何想法？可能是一些简单的东西，比如额外的 GROUP BY 什么的？我希望我已经清楚我希望实现的目标。

感谢小伙伴们一直以来的支持！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:56:18.300

根据您的样本数据，这就是您要找的吗？

```
select *
  from ( SELECT TR.ITEMNO
              , tr.lotno
              , ROUND(SUM(TR.TRANS_QUAN * (DECODE(TR.TRANS_TYPE, 'PO', 1, 0)))) AS SUM_IN
              , ROUND(SUM(TR.TRANS_QUAN * (DECODE(TR.TRANS_TYPE, 'MH', 1,0))))AS SUM_OUT
          FROM TRANSLOG TR
         GROUP BY TR.ITEMNO, tr.lotno
         ORDER BY TR.ITEMNO
       )
 where sum_out > sum_in 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:33:39.993

我认为以下查询可以满足您的要求。. .

```
select id, lotno,
       sum(case when type = 'PO' then quantity else 0 end) as sum_in,
       sum(case when type = 'MANUAL/BACKFLUSH' then quantity else 0 end) as sum_out
from IQMS.TRANSLOG TR
group by id, lotno 
```

`case`语句为标准 SQL ；`decode`特定于 Oracle。另外，我不确定要使用哪些列名，因为它们在您的问题和代码示例之间不一致。我用了最短的形式。

要返回记录 where `sum_out > sum_in`，您可以将其嵌入为子查询：

```
select t.*
from (select id, lotno,
             sum(case when type = 'PO' then quantity else 0
                 end) as sum_in,
             sum(case when type = 'MANUAL/BACKFLUSH' then quantity else 0
                 end) as sum_out
      from IQMS.TRANSLOG TR
      group by id, lotno
     ) t
where sum_out > sum_in 
```

您也可以使用`having`子句来执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:57:12.743

知道了！！！:) :)

```
SELECT *
FROM

  (SELECT TR.ITEMNO, TR.LOTNO,
       SUM(CASE WHEN TR.TRANS_TYPE = 'PO' THEN TR.TRANS_QUAN ELSE 0 END) AS SUM_IN,
       SUM(CASE WHEN TR.TRANS_TYPE = 'MANUAL/BACKFLUSH' THEN TR.TRANS_QUAN ELSE 0 END)AS SUM_OUT
   FROM IQMS.TRANSLOG TR
   GROUP BY TR.ITEMNO, TR.LOTNO
   ORDER BY TR.ITEMNO, TR.LOTNO)

WHERE SUM_OUT > SUM_IN
AND SUM_IN != '0' 
```

谢谢大家的帮助！！

# java - 如何将 log4j 用于旧版 JVM

> ID：12623720
> 
> 赞同：-2
> 
> 时间：2012-09-27T14:30:09.453
> 
> 标签：java, logging, log4j

请解释我如何在旧版本的虚拟机中实现 log4j？请分享任何解释相同的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:40:41.880

有一些 log4j 版本可以与 Java 1.1 以及此后的每个版本一起使用：请参阅log4j FAQ 中的[此条目](http://logging.apache.org/log4j/1.2/faq.html#a1.3)。除了选择正确的版本（在 Java 1.1 的情况下）之外，在旧的 JVM 上使用 log4j 不需要做任何特别的事情。

如果你有一个特定的问题，你需要把它拼出来。

# groovy - 自定义列表排序

> ID：12623728
> 
> 赞同：3
> 
> 时间：2012-09-27T14:30:50.497
> 
> 标签：groovy

嗨，我有一个包含元素的列表`[daily,monthly,weekly]`或`[monthly,weekly,daily]``[weekly,daily]`

我需要以这样的方式对列表进行排序

```
[daily,monthly,weekly] == [daily,monthly,weekly]

[monthly, weekly, daily] == [daily, monthly, weekly]

[weekly, daily] == [daily, weekly] 
```

有人可以帮我吗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T14:54:30.920

假设您的意思是您有一个字符串列表，那么这应该可以工作：

```
customSorter = { 
  [ 'daily', 'monthly', 'weekly' ].indexOf( it )
}

assert [ 'daily', 'monthly', 'weekly' ].sort( customSorter ) == [ 'daily', 'monthly', 'weekly' ]
assert [ 'monthly', 'weekly', 'daily' ].sort( customSorter ) == [ 'daily', 'monthly', 'weekly' ]
assert [ 'weekly', 'daily' ].sort( customSorter ) == [ 'daily', 'weekly' ] 
```

或者您可以这样做（以避免重复创建列表）

```
customSorter = { a, b, order=['daily','monthly','weekly'] ->
  order.indexOf( a ) <=> order.indexOf( b )
} 
```

# pdf - 在 reportviewer 中进行正面/背面（双面）打印

> ID：12623732
> 
> 赞同：0
> 
> 时间：2012-09-27T14:30:57.380
> 
> 标签：pdf, printing, report, reportviewer

我的报告为 1000 多个不同的客户生成电话账单。我创建了一个包含所有账单的 PDF，以便用户更轻松地打印，但如果当前账单以奇数结尾，它将在前一个客户的最后一页的背面开始打印。

如果当前页码是奇数，我需要插入一个额外的分页符（空白页）。但是我很难找出我应该如何以及在哪里测试它以及如何解决这个问题。

有任何想法吗？

# php - 使用 htaccess 获得良好的 SEO 链接

> ID：12623733
> 
> 赞同：2
> 
> 时间：2012-09-27T14:30:58.253
> 
> 标签：php, .htaccess, mod-rewrite, seo

我建立了一个 Web 论坛，其链接如下所示：

```
http://127.0.0.1/website/comments.php?topic_id=2/create+good+seo+links 
```

生成链接的链接如下所示

```
<a href="comments.php?topic_id=<?php echo (int)($forum_topic['topic_id']); >/<?php echo urlencode(htmlspecialchars($forum_topic['topic_head'])); > "> 
```

问题：如何使链接看起来像

```
http://127.0.0.1/website/comments/topic/create-good-seo-links/2 
```

我尝试在 .htaccess 文件中应用此代码：

```
 RewiteEngine on
   RewriteBase /website
   RewriteRule ^comments/([a-zA-Z0-9_-)/([0-9]+)\.php$ comments.php?id=$1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:32:51.243

您在 RewriteRule 中缺少右括号和限制器`[a-zA-Z0-9_\-]+`

您还需要将 id 指针更改为，`$2`因为它匹配第二个正则表达式规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:38:07.020

您将需要类似这样的 htaccess 规则：

```
RewiteEngine on
RewriteRule ^website/comments/([a-zA-Z0-9_-])/([a-zA-Z0-9_-])/([0-9]+)$ comments.php?topic_id=$3 
```

这会将友好的 URL 重定向到正常的脚本文件，`$3`即重写规则第一部分中的第三组括号（即数字）。

因此，您需要将输出更改为：

```
<a href="comments.php?topic_id=<?php echo $forum_topic['name']; ?>/<?php echo urlencode(htmlspecialchars($forum_topic['topic_head'])); ?>/<?php echo (int)$forum_topic['topic_id'] ?>"> 
```

注意我不确定，`$forum_topic['name']`所以你需要检查你的代码中调用了什么变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:42:19.430

```
RewiteEngine on
RewriteRule ^subdir/comments/([a-zA-Z0-9_-])/([a-zA-Z0-9_-])/([0-9]+)$ comments.php?topic_id=$3 
```

如果您想做好 SEO，请在 URL 示例中使用一些需求关键字如果您有下载门户

```
www.domain.com/games/mobile-os/game-name/id/page.html 
```

它将帮助您在谷歌中获得良好的排名

# java - 更改时钟表盘图像

> ID：12623734
> 
> 赞同：0
> 
> 时间：2012-09-27T14:30:59.557
> 
> 标签：java, android, eclipse, widget, settings

我正在创建一个用于学习目的的模拟时钟小部件，并且想知道如何进行设置布局以更改时钟表盘图像。我已经完成了小部件，但我似乎无法获得 onclicklstener 来调出设置布局。

这就是我所拥有的：

```
@Override
public void onDeleted(Context  context, int[] appWidgetIds) 
{super.onDeleted(context, appWidgetIds);
}

@Override
public void onDisabled(Context  context) {
        super.onDisabled(context);
        }

@Override
public void onReceive(Context context, Intent intent)
{
    String action = intent.getAction();
    if (AppWidgetManager.ACTION_APPWIDGET_UPDATE.equals(action))
    {

        RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget);

        Intent AlarmClockIntent = new Intent(Intent.ACTION_MAIN).addCategory(Intent.CATEGORY_LAUNCHER).setComponent(new ComponentName("com.android.alarmclock", "com.android.alarmclock.AlarmClock"));
        PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, AlarmClockIntent, 0);
        views.setOnClickPendingIntent(R.id.Widget, pendingIntent);

        AppWidgetManager.getInstance(context).updateAppWidget(intent.getIntArrayExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS), views);
    }
}
@Override
public void onUpdate(Context context, AppWidgetManager appWidgetManager,
    int[] appWidgetIds) 
{
        super.onUpdate(context, appWidgetManager, appWidgetIds);
        RemoteViews updateViews = new RemoteViews(context.getPackageName(), R.layout.settings);
        Intent launchActivity = new Intent(context,Widget.class);
        PendingIntent pendingIntent = PendingIntent.getActivity(context,0, launchActivity, 0);
        updateViews.setOnClickPendingIntent(R.id.Widget, pendingIntent);
        ComponentName myComponentName = new ComponentName(context, Settings.class);
        AppWidgetManager manager = AppWidgetManager.getInstance(context);
        manager.updateAppWidget(myComponentName, updateViews);
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T04:56:17.237

[这个问题在这里](https://stackoverflow.com/questions/12945402/settings-activity-not-launching/12945420#12945420)又被问到了。

对于未来的访客：

将确保`PendingIntent`已设置的代码放入`onUpdate()`方法中。这样可以确保将小部件放在设置的主屏幕上`PendingIntent`。

所以：

```
public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgets) {
    RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget_activity);
    Intent intent = new Intent(context, Info.class);
    PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, 0);
    remoteViews.setOnClickPendingIntent(R.id.Widget, pendingIntent); 
```

还：

如果您还希望`Activity`在首次将小部件添加到主屏幕时自动弹出信息，您应该阅读[这条有用的信息](http://developer.android.com/guide/topics/appwidgets/index.html#Configuring)。

# wordpress - Dom 操作和 wordpress

> ID：12623736
> 
> 赞同：0
> 
> 时间：2012-09-27T14:31:07.803
> 
> 标签：wordpress

我已经设置了一个 wordpress 站点，它加载一个初始页面，然后使用 jquery .load 来抓取其他 php 页面。这些页面最初是在 wordpress 中创建的，其中包含 php 包含到相应的文本 .php 文件中。

因此，站点加载其标题一次，然后使用 .load 创建和删除 DOM 元素。我现在正在设置站点的博客以显示 wordpress 帖子。我创建了一个遍历帖子的小循环。当我通过 example.com/myLoop 打开循环时，它可以工作，但是当我通过指向它的 .php 文件来加载它时，我收到一个 php 错误“调用未定义的函数 get_posts()”。

```
 <div id="postsContainer">
    <?php
    global $post;
    $args = array( 'numberposts' => 100 );
    $lastposts = get_posts( $args );
    foreach($lastposts as $post) : setup_postdata($post); ?>
        <div class="postBody">
        <h1 class="postTitle"><?php the_title(); ?></h1>
            <?php the_content(); ?>
            <div class="postAttachment">
            <?php
            //display image attachments
            $args = array( 'post_type' => 'attachment', 'numberposts' => -1, 'post_status' => null, 'post_parent' => $post->ID ); 
            $attachments = get_posts($args);
            if ($attachments) {
                foreach ( $attachments as $attachment ) {
                    //echo apply_filters('testies', $attachment->post_title );
                    //echo "help me";
                }

            }
            ?>
            </div>
            <p class="postInfo">Posted by <?php $author = get_the_author(); echo $author . ', '; the_date(); ?></p>
            <div class="socialButtons">
            <a class="" href="mailto:type email address here?subject=I want to share this post with you from <?php bloginfo('name'); ?>&body=<?php the_title('','',true); ?>:&#32;&#13;<?php the_permalink(); ?>" title="Email to a friend" target="_blank">email this  |</a>
            <a href="http://www.facebook.com/sharer.php?u=<?php the_permalink() ?>">  share on facebook  |</a>
            <a href="https://plusone.google.com/_/+1/confirm?hl=en&url=<?php the_permalink() ?>">  share on google+  |</a>
            <a href="https://twitter.com/share?url=<?php the_permalink() ?>">  tweet</a>
            </div>

        </div>      
    <?php endforeach; ?>
    </div> 
```

# javascript - Javascript 后缀表示法

> ID：12623740
> 
> 赞同：-3
> 
> 时间：2012-09-27T14:31:13.943
> 
> 标签：javascript, postfix-notation

我想在后缀表示法中使用以下表达式的帮助，例如“4 5.2 + 5.7 / 6.1 5--”。

首先，它必须读取表达式，然后测试运算符和操作数，然后计算表达式。最后，“document.write”每次推送和弹出都在单独的行中。请帮助，因为我已经用完了从 YouTube 到这个网站的地方。我什至不知道从哪里开始，所以一个非常简单的例子可以帮助我开始。我有一些 JS 知识，但并不精通，对于这个特定的示例，我在其他地方几乎找不到帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T18:02:14.953

考虑将问题分解为更简单的步骤。例如，您给出的原始问题陈述，用于评估字符串

```
4 5.2 + 5.7 / 6.1 5 - - 
```

一次做所有事情太难了。最好将问题分解为可管理的部分。一种分解是：

1.  将字符串分解为标记。

2.  开发一个处理令牌的解释器。

这种分解是解决这类问题的标准方法。像[PLAI](http://www.cs.brown.edu/~sk/Publications/Books/ProgLangs/)这样的书涵盖了如何做第2部分。第2部分并不难：保持一堆数字。当你走令牌时：

1.  如果您看到一个数字，请将其压入堆栈。

2.  如果你看到一个运算符，将两个数字从堆栈中弹出，用运算符对其进行操作，然后将结果推回堆栈。

此过程是逆波兰表示法 ( [RPN](http://en.wikipedia.org/wiki/Reverse_Polish_notation) ) 计算器的核心。

如果您愿意使用正则表达式等工具，第一个问题也不会太难。正则表达式可以检测字符串中的模式并将字符串分成几段。例如，以下示例显示了我们如何将字符串沿空间边界拆分为一系列单词：

```
var s = "hello this is a test";
var pieces = s.split(" "); 
```

出于您的目的，您的字符串不会总是很好地间隔开，因此您需要沿数字和运算符边界进行拆分。您需要尝试[正则表达式模式](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)，以使标记化按您希望的方式工作。

* * *

您要解决的问题实际上不是初学者材料。这个问题是给计算机科学第二学期的学生的，他们已经完成了诸如[如何设计程序](http://www.ccs.neu.edu/home/matthias/HtDP2e/)或其他类似课程之类的课程，并假设学生已经了解他们最喜欢的编程**语言**。如果你不能在不复制和粘贴别人的例子的情况下编写程序，那么你还没有做这个问题的背景。先做简单的问题，掌握语言，然后再回到这个问题上。

# validation - 使用 ScriptBlock 作为 Mandatory 的决定

> ID：12623749
> 
> 赞同：4
> 
> 时间：2012-09-27T14:31:38.490
> 
> 标签：validation, function, powershell

我希望我可以设置一个 cmdlet，以便它使用环境变量作为参数值（如果存在），或者以其他方式提示。

```
function Test-Mandatory
{
  [CmdletBinding()]
  param(
    [Parameter(Mandatory = { [string]::IsNullOrEmpty($Env:TEST_PARAM) })]
    [string]
    $foo = $Env:TEST_PARAM
  )

  Write-Host $foo
} 
```

不幸的是，似乎无论我是否`$Env:TEST_PARAM`有一套，cmdlet 总是提示输入 $foo。

我可以重新进行验证以使用`[ValidateScript({ #snip #})`，但是我不会再让 Powershell 提示输入所需的值，不应该`$Env:TEST_PARAM`存在。我只会得到一个验证错误。

所以这里有2个问题

*   为什么我什至可以将脚本块分配给 Mandatory 如果它似乎没有被尊重？
*   给定我指定的标准，是否有一种简单的方法来获取默认的 PS 提示行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T14:41:44.493

仅供参考，这是微软不得不说的：

> “这不是一个真正的错误。脚本块是有效的属性参数 - 例如 ValidateScriptBlock 否则不会很好地工作。
> 属性参数总是转换为参数类型。在强制的情况下 - 它需要一个布尔值，并且任何时候转换一个 ScriptBlock 来布尔，你会得到价值 $true。你永远不会调用一个脚本块来做一个转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:50:18.377

对于第二个问题，您始终可以验证脚本中的值。只需将值设置为环境变量作为默认值。当我尝试使用`($foo -eq $null)`它进行验证时，它不起作用，所以我将其切换到`($foo -eq "")`. 这是我测试的样本，以获得您的要求：

```
function Test-Mandatory
{
  [CmdletBinding()]
  param(
    [string] $foo = $Env:TEST_PARAM
  )
begin {
    if ($foo -eq "") { 
        $foo = Read-Host "Please enter foo: "
    }
} #end begin
process {
  Write-Host $foo
} #end process
} #end function 
```

至于必选题，我相信如果你分配一个默认值（即使它是空的），它会满足必选分配。当它去检查值是否存在时，因为它被分配了一个值，强制检查为真，允许它继续前进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-07T23:42:07.330

值得注意的是，这并不像您期望的那样工作......我希望 $foo**仅在 $Env:TEST_PARAM 不存在时才**被标记为强制。

但是，即使 $Env:TEST_PARAM 存在，shell 也会提示 :(

```
function Test-Mandatory
{
  [CmdletBinding()]
  param(
    [Parameter(Mandatory = { [string]::IsNullOrEmpty($Env:TEST_PARAM) })]
    [string]
    $foo
  )

if (!$PsBoundParameters.foo) { $foo = $Env:TEST_PARAM }

  Write-Host $foo
} 
```

# android - 从图库中选择图像

> ID：12623750
> 
> 赞同：0
> 
> 时间：2012-09-27T14:31:42.523
> 
> 标签：android, android-intent

我在 ActivityGroup 中有一个 Activity。我有获取图像的代码：

```
Intent intent = new Intent();
intent.setType("image/*");
intent.setAction(Intent.ACTION_GET_CONTENT);
startActivityForResult(intent,IMAGE_PICK); 
```

选择图片的视图已启动，我可以选择一张图片。但是当它回到我的应用程序时，永远不会调用 onActivityResult（在 ActivityGroup 和 Activity 中都没有）。

我已经检查了几个问题，以防万一我错过了接收器，并且我发现了这个[从图库中选择图像](https://stackoverflow.com/questions/2791545/pick-an-image-from-the-gallery)。但是所有的标志似乎都关闭了。

有谁知道问题可能是什么？非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T17:20:32.410

这里可能存在与 Activies 层相关的问题。

父 Activity 应该调用 startActivityForResult，因此在启动图像选择器的 Activity 中使用它来代替

```
getParent().startActivityForResult(intent, IMAGE_PICK); 
```

然后 ActivityGroup 应该会收到 onActivityResult 事件。然后使用 LocalAreaManager 将事件传递给活动。

```
if (YourActivityName.class.equals(getLocalActivityManager().getCurrentActivity()){    
    getLocalActivityManager().((YourActivityName) getCurrentActivity()).handleOnActivityResult(requestCode, resultCode, data);
} 
```

然后在您的活动中，创建一个名为 handleOnActivityResult 的静态类，您将在其中处理活动结果。

# c - 如何将无符号转换为 uint64_t？

> ID：12623751
> 
> 赞同：1
> 
> 时间：2012-09-27T14:31:45.723
> 
> 标签：c, c99, unsigned

我有一个`unsigned`并且想把它转换成一个`uint64_t`（如果可能的话，再回来）。

我怎么做？如果可能的话，我想避免依赖未定义的行为。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T14:34:45.987

从任何整数类型到无符号整数类型的转换完全由标准定义（第 6.3.1.3 节，第 2 段）。如果该值可以在目标类型中表示，则保留该值，否则将该值模减少`2^WIDTH`，其中`WIDTH`是目标类型的宽度（值位数）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:34:16.633

例如：

```
const uint64_t bigvalue = (uint64_t) 42u; 
```

不确定演员阵容是否必要，因为这不会丢失信息。反之：

```
const unsigned int smallvalue = (unsigned int) bigvalue; 
```

将需要演员表，因为它（可能，假设`int`< `uint64_t`）是一种更窄的类型。

注意：我的意思是弱的“需要”；由于在转换为更窄的类型时存在丢失信息的风险，因此编译器可能会发出警告。演员阵容增加了一种“我知道我在做什么”的感觉，这就是这种警告通常被静音的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:35:12.903

您可以通过类型转换来做到这一点：

`uint64_t new = (uint64_t) old;`

`old`你的无符号整数在哪里。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-27T14:34:15.597

由于您在 C 领域，因此演员将是您唯一的方式。简单地做

```
uint64_t foo = (uint64_t)myVar; 
```

或者，反过来

```
unsigned int bar = (unsigned int)foo; 
```

您的编译器应该自动进行转换，尽管在`uint64_t`->的情况下`unsigned int`，您应该收到有关截断的警告。此外，除非您在 64 位环境中编译，否则在转换回时该值当然会被截断。

# php - Smarty foreach 不工作

> ID：12623753
> 
> 赞同：0
> 
> 时间：2012-09-27T14:31:49.033
> 
> 标签：php, html, smarty

我正在用 Smarty 做一些实验，但我在使用 foreach 循环时遇到了问题，它不起作用，我不明白为什么。这是我的代码：

默认.tpl

```
 <select name="user">
    {html_options values=$id output=$names selected="5"}
</select>

<table>
{foreach $names as $name}
{strip}
   <tr bgcolor="{cycle values='#eeeeee,#dddddd'}">
      <td>{$name}</td>
   </tr>
{/strip}
{/foreach}
</table>

<table>
{foreach $users as $user}
{strip}
   <tr bgcolor="{cycle values='#aaaaaa,#bbbbbb'}">
      <td>{$user.name}</td>
      <td>{$user.phone}</td>
   </tr>
{/strip}
{/foreach}
</table> 
```

和 default.php

```
<?php

include('Smarty.class.php');

//create object
$smarty = new Smarty;

$smarty->template_dir = 'C:\xampp\htdocs\smarty\templates';
$smarty->config_dir = 'C:\xampp\htdocs\smarty\config';
$smarty->cache_dir = 'C:\xampp\php\smarty\cache';
$smarty->compile_dir = 'C:\xampp\php\smarty\templates_c';

$smarty->assign('names', array('Bob', 'Jimmy', 'Freddy', 'Walter', 'Jerry'));

$smarty->assign('users', array(
                        array('name' => 'bob', 'phone' => '555-3425'),
                        array('name' => 'jim', 'phone' => '555-4364'),
                        array('name' => 'joe', 'phone' => '555-3422'),
                        array('name' => 'jerry', 'phone' => '555-4973'),
                        array('name' => 'fred', 'phone' => '555-3235')
));

//display information
$smarty->display('default.tpl');
?> 
```

测试时出现以下错误：

致命错误：Smarty 错误：[在 default.tpl 第 16 行]：语法错误：无效属性名称：C:\xampp\php\Smarty\libs\Smarty 中的“$names”（Smarty_Compiler.class.php，第 1550 行）。第 1094 行的 class.php。

$users 也是如此。因为我知道这些值正在传递，因为它正在工作，所以我无法理解发生了什么。

提前谢谢。

编辑：我从 smarty 网站上拿了这个例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:38:01.177

```
{foreach name=$names}
.
.
.
.
<td> {$name} </td> 
```

这就是它的工作原理。我从未尝试过您在 smarty 中使用 foreach 的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:46:35.107

smarty 网站上的示例似乎不起作用。这是我必须做的才能让它工作：

```
 <table>
    {foreach from=$names item=name}
    {strip}
       <tr bgcolor="{cycle values='#eeeeee,#dddddd'}">
          <td>{$name}</td>
       </tr>
    {/strip}
    {/foreach}
</table>

<table>
    {foreach from=$users item=user}
    {strip}
       <tr bgcolor="{cycle values='#aaaaaa,#bbbbbb'}">
          <td>{$user.name}</td>
          <td>{$user.phone}</td>
       </tr>
    {/strip}
    {/foreach}
</table> 
```

# jquery - 如何计算一个div的高度并在jquery中增加另一个？

> ID：12623760
> 
> 赞同：0
> 
> 时间：2012-09-27T14:31:57.787
> 
> 标签：jquery

我有以下问题。

我有一个包含内容的 paneldiv1 - 当我减小浏览器大小时，内容会聚集在一起并增加 div 的高度，这很好。

由于 paneldiv1 的增加是高度，我希望 paneldiv2 根据 paneldiv1 的大小重新计算其大小。

所以如果 paneldiv1 是 100px 高度并增加 20px 到 120px

并且 paneldiv2 的高度为 150px - 我希望 paneldiv2 增加 20px = 到 170px

我怎么能在 jquery 中做到这一点？

示例：http: [//jsfiddle.net/zidski/9CvzV/](http://jsfiddle.net/zidski/9CvzV/)

# forms - 在 Zend Framework2 中使用表单而不是字段集的带有集合元素的 Zend 表单示例

> ID：12623761
> 
> 赞同：3
> 
> 时间：2012-09-27T14:32:04.103
> 
> 标签：forms, element, zend-framework2

我需要一个简单的工作示例，如何在 Zend Form 中包含一个集合元素，我已经从 Zend Framework 2[站点](http://zf2.readthedocs.org/en/latest/modules/zend.form.elements.html#collection-element)和 StackOverflow 中的先前帖子中看到了一些示例，其中大多数都指向此[链接](http://www.michaelgallego.fr/blog/?p=190)。但是现在我没有使用 Fieldsets 并继续使用 Forms，所以如果有人能以正确的方式指导我，当用户获得一个用户可以从显示的页面中选择多个选项时，我如何包含一个简单的集合元素收集表格。从数据库中填充收集表单会更好。

我已经在互联网上搜索了很长一段时间，并认为我会在这里发布，以便 Zend profis 可以提供他们的建议。

仅供参考：通常可以以这种方式在 Zend Form 中包含一个静态下拉框

```
$this->add(
    array(
        'name'       => "countr",
        'type'       => 'Zend\Form\Element\Select',
        'options'    => array(
            'label' => "Countries",
            'options' => array(
                'country1' => 'Brazil',
                'country2' => 'USA',
                'country3' => 'Mexico',
                'country4' => 'France',
            )
        )
    )
); 
```

所以我期待一个简单的例子，它可以让我基本了解如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:47:38.413

老实说，我在这里看不到你的问题。由于表单集合`Fieldset`extends which extends `Element`，您可以将其作为常规元素添加到表单中。视图助手将递归处理渲染。

**第 1 步：**创建表单集合（创建 的实例`Zend\Form\Element\Collection`）。如果必须以某种方式动态添加元素，我会为此创建一个工厂类。

**第 2 步：**将其添加到表单中。（例如使用`$form->add($myCollectionInstance)`.）

**第 3 步：**渲染它。`Zend\Form\View\Helper\Collection`是一个很好的视图助手，可以毫无痛苦地渲染整个表单。

您还可以创建一个新类扩展`Zend\Form\Element\Collection`并使用构造函数添加您需要的字段。因此，您可以使用粘贴在问题中的数组将其添加到表单中。此外，您可以直接在注释中使用它。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T18:16:56.057

如果您只想用选项值填充选择列表，您可以将数组添加到控制器中的选择列表中：

```
$form = new MyForm();
$form->get('countr')->setOptions(array('value_options'=>array(
                    'country1' => 'Brazil',
                    'country2' => 'USA',
                    'country3' => 'Mexico',
                    'country4' => 'France',
                )); 
```

该数组可以从数据库中获取。

这是以最简单的方式使用表单集合的另一个示例。在此示例中，它在集合中创建输入文本元素并填充它们。元素的数量取决于数组：

```
class MyForm extends \Zend\Form\Form
{
    $this->add(array(
        'type' => '\Zend\Form\Element\Collection',
        'name' => 'myCollection',
        'options' => array(
            'label' => 'My collection',
            'allow_add' => true,
    )
    ));
}

    class IndexController extends AbstractActionController
    {

    public function indexAction
    {
        $form = new MyForm();

        $this->addElementsFromArray($form, array(

                'country1' => 'Brazil',
                'country2' => 'USA',
                'country3' => 'Mexico',
                'country4' => 'France',
            ));

    //the above line can be replaced if fetching the array from a db table:
    //$arrayFromDb = getArrayFromDb(); 
    //$this->addElementsFromArray($form, $arrayFromDb);

    return array(
        'form' => $form
    );
    }

    private function addElementsFromArray($form, $array)
    {
        foreach ($array as $key=>$value)
        {
        $form->get('myCollection')->add(array(
                //'type' => '\Zend\Form\Element\SomeElement',
                'name' => $key,
                'options' => array(
                        'label' => $key,
                ),
                'attributes' => array(
                        'value' => $value,
                )
        ));
        }
    }
} 
```

索引.phtml：

```
$form->setAttribute('action', $this->url('home'))
     ->prepare();
echo $this->form()->openTag($form);
echo $this->formCollection($form->get('myCollection'));
echo $this->form()->closeTag(); 
```

# jquery - 当您在 <= IE 8 中鼠标悬停时，悬停不会消失

> ID：12623763
> 
> 赞同：4
> 
> 时间：2012-09-27T14:32:08.893
> 
> 标签：jquery, html, css, internet-explorer-8, internet-explorer-7

我遇到了一个在其他地方找不到的有趣问题。

看看[这个 JSFiddle](http://jsfiddle.net/kPXWS/2/)。我有一个 div，当您将鼠标悬停在它上面时会发生两件事：（1）它通过 :hover 伪类获得一些 CSS 格式，以及（2）在图像底部弹出一个包含有关图像的一些信息的叠加层（通过 jQuery）。

这在所有现代浏览器中都可以正常工作，但在 IE 7 或 8 中打开它。将鼠标悬停在框架上。如果将鼠标悬停在框架顶部，则没有问题——覆盖消失，CSS 格式被删除。但是，如果您的鼠标在鼠标移出时直接经过叠加层，则 :hover 格式会保留。jQuery 知道您已将鼠标移出，因为覆盖已被删除，但 IE 不知道，因为 CSS :hover 格式仍然存在。有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T14:35:50.273

**对除链接**之外的所有元素的CSS`:hover`支持不完整/IE < 8 不支持。**`<a>..</a>`**

[http://www.quirksmode.org/css/contents.html#t16](http://www.quirksmode.org/css/contents.html#t16)

> IE 5/6 仅在链接上支持两者。IE 7 在所有元素上都支持 :hover，但不支持 :active。
> 
> IE 8-10（也可能是旧版本）有一个小错误：在嵌套元素上单击鼠标不会触发 :active。通过在其中一个代码示例上按下鼠标按钮在测试页面中进行尝试。:active 样式不会生效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:39:58.537

鉴于您已经在使用 jQuery 进行悬停，我建议您将脚本更改为：

```
$(document).ready(function() {
    $('#frame').hover(
        function() {
            $('#frame').addClass('hover').append('<div id="overlay">blah blah</div>');
        }, 
        function() {
             $('#frame').removeClass('hover')
            $('#overlay').remove();
        }
    );
}); 
```

然后将所有相关元素的 CSS 从 更改`:hover`为。`.hover`按照这个小提琴：

[http://jsfiddle.net/BZj2v/](http://jsfiddle.net/BZj2v/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T14:49:34.963

这是 jQuery 中广为人知的事情，因为 Internet Explorer 的鼠标离开功能是专有的。您将需要使用 jquery 的 mouseleave/mouseenter 方法。

这是您使用and方法~~[更新的小提琴](http://jsfiddle.net/kPXWS/3/)~~ **[小提琴。](http://jsfiddle.net/kPXWS/6/)**它可以工作并且已经在 IE7-9 中测试过了。`mouseenter()``mouseleave()`

为方便起见，我也在此处包含代码：

**JS：**

```
$(document).ready(function() {
    $('#frame').mouseenter(function() {
        var $this = $(this);
        $this.append('<div id="overlay">blah blah</div>');
        $this.addClass("hover");
    }).mouseleave(function() {
        $('#overlay').remove();
        $(this).removeClass("hover");
    });
    $('#overlay').mouseleave(function() {
        $(this).remove();
    });
}); 
```

**CSS：**

```
#frame {
    padding:5px;
    border:1px solid black;
    width:150px;
    text-align:center;
    position:relative;
}
#frame.hover {
    border:1px solid red;
}
#frame img {
    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=25)";
    filter: alpha(opacity=25);
    -moz-opacity: 0.25;
    opacity: 0.25;
}
#frame.hover img {
    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";
    filter: alpha(opacity=100);
    -moz-opacity: 1;
    opacity: 1;
}
#overlay {
    background-color:black;
    color:white;
    height:25px;
    width:100%;
    font-size:10px;
    position:absolute;
    bottom:0;
    left:0;
} 
```

**编辑：**根据您在评论中描述的结果，我已经更新了我的小提琴和上面的代码。它应该完全有效 - 如果没有，请告诉我。

**更详细一点：**

该解决方案使用 jQuery`mouseenter`和`mouseleave`方法，因为 IE 使用该`hover`方法存在许多问题。正如您可能知道或可能不知道的那样，`hover`它是`mouseenter`/的简写版本`mouseleave`，但该方法存在许多问题，`hover`从 IE6-9（也可能是 IE 10，尽管我没有测试过）。对于某些特定问题，请在 Stack Overflow 或 Google 中搜索“jQuery hover IE issues”并查看出现的一些结果。出于这个原因，我总是多花十秒钟来输入`mouseenter`/`mouseleave`而不是使用`hover`，尤其是当我在 IE 中的代码已经遇到问题时。

如果您有任何问题/困难，请告诉我。祝你好运！:)

# java - 从hibernate createCriteria检索时如何替换''值而不是null？

> ID：12623766
> 
> 赞同：0
> 
> 时间：2012-09-27T14:32:13.357
> 
> 标签：java, hibernate, hibernate-criteria

当我使用实体注释从休眠 createCriteria 检索时，我想替换数据库中的 '' 值而不是空值。

```
List<Configuration> kist=new ArrayList<Configuration>();        
Criteria crq=getSession().createCriteria(Configuration.class); 
```

请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:55:40.770

你可以使用一个`Interceptor`类。据我说，这是实现您的要求的几种方法之一。

看到这个链接，很好解释：[http ://www.mkyong.com/hibernate/hibernate-interceptor-example-audit-log/](http://www.mkyong.com/hibernate/hibernate-interceptor-example-audit-log/)

# python - 比较jinja2模板中的两个变量

> ID：12623768
> 
> 赞同：13
> 
> 时间：2012-09-27T14:32:27.670
> 
> 标签：python, google-app-engine, flask, jinja2

鉴于我有两个变量`{{ profile }}`，其值为“test”，另一个变量`{{ element.author }}`值为“test”。在 jinja2 中，当我尝试使用 if 比较它们时，什么也没有出现。我进行如下比较：

```
{% if profile == element.author %}
{{ profile }} and {{ element.author }} are same
{% else %}
{{ profile }} and {{ element.author }} are **not** same
{% endif %} 
```

我得到输出出了`test and test are not same`什么问题，我该如何比较？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2015-04-10T10:15:27.467

我有同样的问题，两个具有整数值的变量在它们是相同的值时不相等。

有没有办法以任何方式使这项工作。还尝试使用 str() == str() 或 int() == int() 但总是存在未定义的错误。

**更新**

**找到解决方案：**`{{ var|string() }}`只需使用过滤器， 例如`{{ var|int() }}` [https://stackoverflow.com/a/19993378/1232796](https://stackoverflow.com/a/19993378/1232796)

阅读文档可以在这里找到[http://jinja.pocoo.org/docs/dev/templates/#list-of-builtin-filters](http://jinja.pocoo.org/docs/dev/templates/#list-of-builtin-filters)

在你的情况下，你想做

```
{% if profile|string() == element.author|string() %}
{{ profile }} and {{ element.author }} are same
{% else %}
{{ profile }} and {{ element.author }} are **not** same
{% endif %} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T20:14:34.593

`profile`并且`element.author`不是同一类型，否则不相等。但是，它们在转换为字符串时确实会输出相同的值。您需要正确比较它们或将它们的类型更改为相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-01T08:32:55.170

您可以使用jinja2 提供的众多[内置测试之一来检查变量的类型。](http://jinja.pocoo.org/docs/templates/#builtin-tests)例如`string()`或`number()`。我有同样的问题，我意识到那是类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-06T20:01:42.767

我建议使用`|lower`过滤器：

```
{% if profile|lower == element.author|lower %} 
```

这不仅将变量转换为相同的字符串类型，而且还有助于避免来自不同名称可能键入方式的不匹配。

# asp.net - 由于违规字符，asp.net 页面无法将文本框中的 html 标记插入数据库

> ID：12623770
> 
> 赞同：0
> 
> 时间：2012-09-27T14:32:32.280
> 
> 标签：asp.net, html, tags, insertion

我有一个用于在 detailview aspx 页面中提交的基本表单。

在我的 textareas 中包含 html 代码`<br>`。每当我尝试进行插入时，它都会失败，并且我得到一个通用的：

> 服务器返回的状态码是500

我知道问题是 html 代码有问题，`<br>`因为删除后，它插入得很好。

是否有此字段的模板视图设置允许插入时允许 html 标记？

任何指针表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T19:42:40.550

在您的页面声明中确保 ValidateRequest="false"...当心，这会为您打开 XSS、跨站点脚本。

确保在将 textarea 中的数据发送到数据库之前对其进行编码，然后当您将其返回显示时，您将对其进行解码。

来自微软。**编码输出

如果输出包含来自用户或其他来源（如数据库）的输入，则使用 HttpUtility.HtmlEncode 方法对输出进行编码。HtmlEncode 替换代表这些字符的 HTML-to-HTML 变量中具有特殊含义的字符。例如，< 替换为 < 并且 " 替换为 "。编码数据不会导致浏览器执行代码。相反，数据被呈现为无害的 HTML。

同样，使用 HttpUtility.UrlEncode 对输出 URL 进行编码（如果它们是从输入构造的）。**

[http://msdn.microsoft.com/en-us/library/ff649310.aspx](http://msdn.microsoft.com/en-us/library/ff649310.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:56:22.840

asp.net Web 表单（假设是 Web 表单）中文本框中的任何 HTML 都会导致此错误。您需要在 JavaScript 中对其进行编码，将 @Page 属性上的 ValidateRequest 属性设置为 false，或者使用其他一些实用程序（那里有一些，不知道具体的，也许是 HTML 敏捷包？）。

# php - 计算错误？

> ID：12623774
> 
> 赞同：2
> 
> 时间：2012-09-27T14:32:39.823
> 
> 标签：php

> **可能重复：**
> [.NET 中的双倍乘法是否损坏？](https://stackoverflow.com/questions/1420752/is-double-multiplication-broken-in-net)
> [浮点到 int 类型转换的 PHP 意外结果](https://stackoverflow.com/questions/3385685/php-unexpected-result-of-float-to-int-type-cast)

```
echo (int) ( (0.1+0.7) * 10); 
```

给我答案 7 但不是 8。

```
echo (int) ( (0.1+0.8) * 10); 
```

给出正确的答案 9

怎么了？谁能解释

谢谢，-Navi

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:37:37.637

尝试

```
echo (float) ( (0.1+0.7) * 10); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:33:56.173

这很正常——在处理浮点数时有一种叫做精度的东西。它存在于大多数现代语言中。请参阅此处：[http](http://www.mredkj.com/javascript/nfbasic2.html) ://www.mredkj.com/javascript/nfbasic2.html了解更多信息。

`((0.1+0.7) * 10)`可能是这样`7.9999999`的`(int) 7.9999999 = 7`

另一方面`((0.1+0.8) * 10)`可能`9.00000001`是`(int)9.00000001 = 9`

> 浮点数的精度有限。尽管取决于系统，但 PHP 通常使用 IEEE 754 双精度格式，由于在 1.11e-16 的数量级四舍五入，这将给出最大的相对误差。非初等算术运算可能会产生更大的误差，当然，当多个运算复合时，必须考虑误差传播。
> 
> 此外，可以精确表示为以 10 为底的浮点数的有理数，如 0.1 或 0.7，没有精确表示为以 2 为底的浮点数，无论尾数大小如何，它都在内部使用。因此，它们不能被转换成它们内部的二进制对应物，而不会有小的精度损失。这可能会导致令人困惑的结果：例如， floor((0.1+0.7)*10) 通常会返回 7 而不是预期的 8，因为内部表示将类似于 7.9999999999999991118...。
> 
> 所以永远不要相信浮点数结果到最后一位，也不要直接比较浮点数是否相等。如果需要更高的精度，可以使用任意精度的数学函数和 gmp 函数。

来源： http: [//php.net/manual/en/language.types.float.php](http://php.net/manual/en/language.types.float.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:37:45.000

使用浮动

```
echo (float) ( (0.1+0.7) * 10); 
```

它会给你完美的答案

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T14:57:41.993

尝试

```
echo (int) round( ( (0.1+0.7) * 10)); 
```

这应该补偿浮点计算误差。

# mysql - 计算从最后一个 SQL 查询中插入的行数

> ID：12623778
> 
> 赞同：8
> 
> 时间：2012-09-27T14:32:48.473
> 
> 标签：mysql

我有这个查询：

```
INSERT INTO db1.outbox (DestinationNumber, TextDecoded)
SELECT User.CellPhone, '$SMSMessage' as TextDecoded
FROM db2.User
WHERE User.PurchaseDate BETWEEN 2012-01-01 AND 2012-01-31 
```

它对“发件箱”表进行多行插入。但我不知道插入了多少行。如何从该 SQL 语法中插入行数？谢谢。

**更新** 我得到'-1'作为这个命令的结果：

```
$insertedRows = mysql_query("SELECT ROW_COUNT()");
$rowInserted = mysql_fetch_array($insertedRows);
$rowInserted = $rowInserted[0];
echo $rowInserted; 
```

但我看到我的桌子上插入了 27 行。我做错什么了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-27T14:34:30.547

把它放在你的最后一个陈述中；

```
SELECT ROW_COUNT(); 
```

**更新 1**

如何使用**[`mysql_affected_rows`](http://php.net/manual/en/function.mysql-affected-rows.php)**，例如

```
<?php

   $link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
   if (!$link) 
   {
       die('Could not connect: ' . mysql_error());
   }
   mysql_select_db('mydb');

   /* this should return the correct numbers of deleted records */
   mysql_query('you SQL QUERY HERE');
   printf("Records deleted: %d\n", mysql_affected_rows());

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T15:07:58.673

以下是一些可能性：

» 如果你有一`AUTO_INCREMENT`列，你可以获取插入前后的行号

»`SELECT ROW_COUNT()`返回最后一条语句更改、删除或插入的行数（如果它是`UPDATE`、`DELETE`或`INSERT`( [doc](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_row-count) )

» You can use `mysqli_affected_rows` (since `mysql_` functions are being deprecated) to get the number of affected rows in a previous MySQL operation ([doc](http://php.net/manual/en/mysqli.affected-rows.php))

```
$link = mysqli_connect("localhost", "my_user", "my_password", "world");

if (!$link) {
    printf("Can't connect to localhost. Error: %s\n", mysqli_connect_error());
    exit();
}

/* Insert rows */
mysqli_query($link, "INSERT INTO myTable VALUES (1)");
printf("Affected rows (INSERT): %d\n", mysqli_affected_rows($link)); 
```

# vba - 处理完成编辑单元格值的事件（vba）

> ID：12623779
> 
> 赞同：1
> 
> 时间：2012-09-27T14:32:50.207
> 
> 标签：vba, excel, excel-2003

嗨，在我的 EXCEL 工作簿中，我正在使用 vba。如何处理单元格失去焦点或完成编辑其值的事件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T14:45:03.267

您可以使用该`Worksheet_Change`事件。例如，在下面的代码中，我们正在检查单元格中是否进行了任何更改`A1`

```
Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Target, Range("A1")) Is Nothing Then
        MsgBox "Hello World"
    End If
End Sub 
```

请注意，即使您按下`F2`并按下`Enter`上述事件也会触发。如果您仅在单元​​格中有实际更改时才需要运行代码，那么您将不得不借助一个`Public`变量来存储单元格的先前值。

该`Worksheet_Change`事件进入工作表代码区域。请看截图。

![在此处输入图像描述](../Images/c4c66de4e915ba638b475c25e3e2089f.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:43:58.763

看到这个链接： http: [//www.wiseowl.co.uk/blog/s194/event-handling-vba.htm](http://www.wiseowl.co.uk/blog/s194/event-handling-vba.htm)

有五篇关于事件、如何使用它们以及您可以使用哪些事件的简短而有用的文章。这篇文章对我也有帮助。

# ios - 我删除了 Xcode 中的本地化，然后我无法添加任何本地化

> ID：12623783
> 
> 赞同：28
> 
> 时间：2012-09-27T14:32:58.257
> 
> 标签：ios, xcode, localization

我错误地从项目信息中删除了项目的本地化。故事板和相关语言都被删除了。

我从以前的文件中取回了故事板，但是当我想添加新的本地化时，弹出一个窗口并要求我“*选择文件和参考语言以创建英语本地化*”并且根本没有资源文件。

如何添加回本地化？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-09-21T07:37:38.933

### 添加回本地化

当您删除本地化时，有时您会遇到无法在 Xcode 中添加回任何本地化的情况。转到命令行并在项目中的某处创建一个带有 lproj 扩展名的[ISO 639-1 两字母语言缩写文件夹。](http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes)

### 创建一个空的语言文件夹

例如：

```
${SRCROOT}/Resources/Translations/nb.lproj 
```

或者

```
${SRCROOT}/Resources/Translations/en.lproj 
```

### 将语言文件重新添加到项目中

在文件夹中创建一个名为的空文件`Localizable.strings`并将此文件添加到您的项目中。不要添加`.lproj`文件夹，只添加内容。然后，当您返回项目文件时，您将在本地化下看到该语言。现在，当您添加此内容时，您应该会在项目中看到本地化。

### 没有复选框

如果添加的文件（如情节提要）旁边没有复选框，表明这是该语言本地化的一部分，您可能需要通过另一种语言来回往返。为此，请在项目中添加一种新语言。它应该提示您将现有的本地化文件复制到新语言。然后删除损坏的本地化并重新添加。

### 我的例子

作为一个具体的例子，我将 nb.lproj 目录中的故事板添加到项目中。挪威语 Bokmål 出现在项目中，但情节提要检查器中的语言复选框不允许我添加它。我在项目中创建了 nb_NO，它提示我复制故事板。然后故事板选中了该复选框。我删除了“nb”本地化并重新添加了它。现在一切都如我所愿。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-09T13:51:07.590

我不得不解决同样的问题，并找到了一个解决方案：

您需要在查找器中找到您的 *.xcodeproj 文件并将其作为容器打开（ctrl+单击它，您将在上下文菜单中看到它）

在这里你可以看到 project.pbxproj 文件，在 Xcode 中打开它。它的大（但仍然可读的文件）。（在你开始之前，最好在保存点制作一些副本）

现在它的任务是将缺少的语言添加到这个文件中，并且它完成了。（你可以在其他具有本地化的项目上尝试它）。

您需要添加一个段落。在这个文件中搜索这个`/* End PBXSourcesBuildPhase section */`（它的段落就在缺少本地化段落之前的段落）并在之后添加类似这样的内容：

```
/* Begin PBXVariantGroup section */
        27548D921611B0BE008EA1CD /* Localizable.strings */ = {
            isa = PBXVariantGroup;
            children = (
                27548D941611B0BE008EA1CD /* en */,
            );
            name = Localizable.strings;
            path = ../Code;
            sourceTree = "<group>";
        };
/* End PBXVariantGroup section */ 
```

你必须先做一些改变。查看`27548D921611B0BE008EA1CD`长号，它的本地化文件（或某些 xib 文件，或其他可本地化文件...）的 ID，如果您在 procject 中没有，只需将一些 Localizable.string 文件添加到项目中，重新打开（或刷新）这个project.pbxpro，找到这个`Localizable.string`你应该找到这样的东西：

`275490591611B0BE008EA1CD /* Localizable.strings in Resources */`

这就是您需要在本地化段落中替换的内容

您还需要对路径参数和 sourceTree 进行正确设置。这两个在 xcode 的文件检查器中是可读的。

“sourceTree”参数是位置 - 主要是相对于组所以`sourceTree = "<group>";`

路径是从组到文件的相对路径（如果您不知道，请尝试在不同的项目中制作一些本地化文件并查看 project.pbxpro，这一切都有效）

在此之后，您可以保存 project.pbxpro，并且您应该在 xcode 信息部分“en”本地化中看到，您可以添加更多本地化和所有其他本地化内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-01-17T17:06:53.967

在 xcode 6 中，执行以下操作：

1.  使用命令行，在项目目录之外的某处创建以下目录/文件结构：

    *   /en.lproj/InfoPlist.strings

    *   /en.lproj/Localizable.strings

2.  在 Xcode 中，打开您的项目并选择 File>Add Files to ProjectName 以添加最近创建的 en.lproj 目录。

3.  之后，您将在 Localizations 列表中看到英语。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-05T19:41:56.080

这是一个老话题，但是在遇到这个问题之后，然后尝试了解决方案（并且让它无法正常工作），我想我会详细说明 DID 的工作原理。

像原始海报一样，我不小心删除了所有本地化，并且在 Xcode 中没有明显的追索权——在 Info 下的项目设置中，它只是说“这个项目尚未本地化”，当我点击下面的加号按钮时，提供了一份空白的资源文件列表。

我遵循@Cameron 的指南，但发现带有 Localizable.strings 文件的语言文件夹已经存在于 Finder 中，但没有被 Xcode 确认。我无法决定如何继续，但我碰巧看到一条关于将文件添加到 Xcode 的无关评论，所以我尝试添加现有的 en.lproj 文件夹及其 Localizable.strings 文件。

这很有效，并且作为开发语言的英语列表也出现在 Info 下。

希望这会帮助遇到同样问题的任何人！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-20T07:17:50.453

我遵循了@user2070775 回复的类似方法。

Firstyl 当您删除`Storyboard`并`Launchscreen`以编程方式使用您自己的创建或代码时，在本地化中您可能会在以下空白屏幕中看到类似的内容。

[![在此处输入图像描述](../Images/6aaf647ba9fa86ca6fc11da99f427fa3.png)](https://i.stack.imgur.com/b8Rmi.png)

然后首先你应该知道语言代码，例如使用**法语**本地化它的**fr**等

使用 Project Navigator 中的项目文件夹，您必须添加`New Group -> {LANGUAGE_CODE}.lproj`. 然后你应该添加`New File -> Strings File -> Localizable.strings`. 在@user2070775 答案中，还`InfoPlist.strings`添加了文件，所以我现在也添加了。

在 Localizable.strings 文件中，您可以将`<KEY> = <VALUE>`字符串对添加到本地化。

我们的一对是`"this-is-key" = "and-this-is-value-for-spesific-language-on-localizable-string";`现在。

> 提示：在键值对中，当我没有放置分号时，XCode 会针对这种情况给出错误。

到现在为止，下面的项目方案，一定是你的成果。

[![在此处输入图像描述](../Images/73a1d5e35b51a841d65bef84b17b04a9.png)](https://i.stack.imgur.com/SyNYS.png)

[![在此处输入图像描述](../Images/79b102220ccd59030dd85f6ff4d68cde.png)](https://i.stack.imgur.com/Kzvqy.png)此外，当您查看 or etc. 时，`Project -> Info -> Localizations`必须`French`添加如下图所示的语言。

### 测试

基本上你可以得到你做了什么的结果[![在此处输入图像描述](../Images/a062be78b5a05914d795bfc7aaa18649.png)](https://i.stack.imgur.com/QSX4l.png)

其余部分可以从模拟器中设置。您必须更改模拟器语言，因为这个答案正确的是法语。

再次转到`Settings -> General -> Language & Region -> French`并运行该项目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-21T06:28:45.233

只需在 finder 中创建一个文件夹“Base.lproj”，然后将要本地化的 Xib 粘贴到其中，然后将此文件夹添加到您的项目中。现在您可以毫无问题地添加其他语言。

# visual-studio-2010 - VSIX：添加的项目不会复制到 vsix 安装文件夹中

> ID：12623785
> 
> 赞同：0
> 
> 时间：2012-09-27T14:33:02.803
> 
> 标签：visual-studio-2010, vsix

我需要从 vsix 中运行 perl 脚本。

1.  我创建了一个 vsix 包并添加了现有项目“test.pl”
2.  我将它移到“资源”文件夹下，并将其属性更改为“嵌入式资源”和“请勿复制”。

`GetManifestResourceNames()`我在代码中使用并执行它来访问这个 .pl 。当我构建项目时，test.pl 在 bin/debug 和 bin/release 文件夹中创建。我正在使用 streamToOutputFile 代码来做到这一点。

**第一个问题是**- 这是在 vsix 项目中嵌入第三方脚本或说 exe 的正确方法吗？

当我**安装 vsix**并开始使用它时，实际问题就开始了。我的 vsix 包文件夹在*%LocalAppData%\..\Extensions*下创建，但 test.pl 不存在。

此外，当我从 VS 运行 extn 时，它抛出了一个错误 - '访问路径 'C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\test.pl' 被拒绝。

**我错过了什么吗？**

# php - PHPUnit 测试总是成功，无论是 $this->once() 还是 $this->never()?

> ID：12623797
> 
> 赞同：3
> 
> 时间：2012-09-27T14:33:34.727
> 
> 标签：php, unit-testing, testing, symfony, phpunit

我知道我做错了什么，因为这很奇怪，我从几天开始就在学习 PHPUnit。测试对象是`receive()`控制器动作：

```
class ReportController
{
    /**
     * @var \Symfony\Component\EventDispatcher\EventDispatcherInterface
     */
    private $dispatcher;

    public function __construct(EventDispatcherInterface $dispatcher)
    {
        $this->dispatcher = $dispatcher;
    }

    /**
     * @param \Gremo\SkebbyBundle\Message\InboudSkebbyMessage $message
     * @return \Symfony\Component\HttpFoundation\Response
     */
    public function receive(InboudSkebbyMessage $message)
    {
        $this->dispatcher->dispatch(SkebbyEvents::MESSAGE_RECEIVED,
            new InboundMessageEvent($message)
        );

        return new Response();
    }
} 
```

当控制器抛出一个事件时，我需要模拟一个事件订阅者（实现[`Symfony\Component\EventDispatcher\EventSubscriberInterface`](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/EventDispatcher/EventSubscriberInterface.php)）。有一个静态方法`getSubscribedEvents()`。测试方法助手（获取模拟）：

```
public function getMockSubscriber(array $events)
{
    $class = $this->getMockClass(
        'Symfony\Component\EventDispatcher\EventSubscriberInterface',
        array_merge(array_values($events), array('getSubscribedEvents'))
    );

    // Static stub method
    $class::staticExpects($this->once())
        ->method('getSubscribedEvents')
        ->will($this->returnValue($events))
    ;

    return new $class;
} 
```

然后在我的测试方法中，我正在注册（模拟）订阅者，发出请求并检查是否`onMessageReceived()`被调用了一次。（实际上很大）问题是**测试总是成功**，即使我将模拟更改为`$subscriber->expects($this->never())->method('onMessageReceived')`. 执行：

```
public function testApiCall()
{
    $client = $this->createClient();

    // Router (for route generation) and dispatcher (for subscribing the mock)
    $router    = $client->getContainer()->get('router');
    $dispatcer = $client->getContainer()->get('event_dispatcher');

    // Get mock event subscriber
    $subscriber = $this->getMockSubscriber(array(
        'messsage.received' => 'onMessageReceived'
    ));

    // Register the mock subscriber with the dispatcher
    $subscriber->expects($this->once())->method('onMessageReceived');
    $dispatcer->addSubscriber($subscriber);

    // Make the request
    $request  = Request::create(
        $router->generate('controller_receive'),
        'POST',
        array(
            'sender'    => 'sender',
            'receiver'  => 'receiver',
            'text'      => 'text',
            'timestamp' => time(),
            'smsType'   => 'smsType'
        )
    );

    $client->getKernel()->handle($request);
} 
```

**编辑**：模拟订户已在调度程序中正确注册。`var_dump($dispatcher->getListeners())`：

```
array(7) {
  'messsage.received' =>
  array(1) {
    [0] =>
    array(2) {
      [0] =>
      class Mock_EventSubscriberInterface_19b191af#34 (2) {
        ...
      }
      [1] =>
      string(17) "onMessageReceived"
    }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T20:51:14.973

我会使用模拟对象，而不是从类名创建一个新对象：

```
public function getMockSubscriber(array $events)
{
    $subscriberMock = $this->getMock(
        'Symfony\Component\EventDispatcher\EventSubscriberInterface',
        array_merge(array_values($events), array('getSubscribedEvents'))
    );

    // Static stub method
    $class = get_class(subscriberMock);
    $class::staticExpects($this->once())
        ->method('getSubscribedEvents')
        ->will($this->returnValue($events))
    ;

    return $subscriberMock;
} 
```

# android - 小部件不适合 Jelly Bean

> ID：12623802
> 
> 赞同：0
> 
> 时间：2012-09-27T14:33:52.473
> 
> 标签：android, android-widget, android-4.2-jelly-bean

我有一个为 Android 2.3 制作的小部件。它有以下维度：

```
android:minHeight="76dip"
android:minWidth="146dip" 
```

问题是 Google 已经改变了 Jelly Bean 甚至 ICS 中单元格的高度。一个单元格现在是 40dp，2 个单元格是 110dp。这使我的小部件拉伸到 110dp。这看起来很丑，因为它被拉伸了很多。如果我增加我的小部件和空格的字体大小，我可以使它适合 110dp 的高度。但是在 Android 2.3 上它看起来会很丑。

我想知道如何使小部件在 JB 和 Android 2.3 上看起来不错。有推荐的指南吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:27:11.547

每个设备可能有不同的网格大小。唯一万无一失的解决方案是使用灵活的布局、[9-patch drawables](http://developer.android.com/tools/help/draw9patch.html)等。

# list - Ada：访问通用列表的各个元素

> ID：12623807
> 
> 赞同：1
> 
> 时间：2012-09-27T14:34:03.027
> 
> 标签：list, generics, package, ada, gnat

我使用“Indefinite_Doubly_Linked_Lists”列表在 Ada 中编写了一堆通用数字。

弹出和推送操作是通过 append 和 delete_last 实现的，但对于排序方法，我需要访问列表的各个项目。

我确实制定了一种仅使用追加/前置 delete_last/first 的排序方法，但结果远非优雅（而且可能不正确）

```
procedure sort is
   elem1: Item;
   elem2: Item;
   --l is a package-private Indefinite_Doubly_linked_lists'
begin
   if Integer(MyList.Length(l)) > 1 then
      for i in 0 .. Integer(MyList.Length(l))-1 loop
         for j in 0 .. Integer(MyList.Length(l))-1 loop
            --Inner sort loop
            elem1 := MyList.Element(l.first);
            l.Delete_First;
            elem2 := MyList.Element(l.first);
            l.Delete_First;
            if elem1>elem2 then
               l.Prepend(elem1);
               l.Append(elem2);
            else
               l.Prepend(elem2);
               l.Append(elem1);
            end if;
         end loop;
      end loop;
   end if;
end; 
```

如何从泛型类型列表中访问单个元素（或迭代）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T15:39:54.000

几件事：

除非你练习的重点是写一个排序，否则你可以……呃……使用通用排序：

```
package List_Sort is new MyList.Generic_Sorting; 
```

如果您使用的是 Ada 2012 编译器，[广义循环](http://www.ada-auth.org/standards/12rm/html/RM-5-5-2.html)可让您轻松访问每个元素：

```
procedure Iterate is 
begin
   for Elem of L loop
      Put_Line(Item'Image(Elem));
   end loop;
end Iterate; 
```

如果您不使用 Ada 2012，您可以自行使用游标：

```
procedure Cursor_Iterate is

   C : MyList.Cursor := L.First;

   use type MyList.Cursor;

begin
   loop 
      exit when C = MyList.No_Element;
      Put_Line(Item'Image(MyList.Element(C)));
      MyList.Next(C);
   end loop;
end Cursor_Iterate; 
```

或使用 MyList 的 Iterate 过程：

```
procedure Iterate
  (Container : in List;
   Process   : not null access procedure (Position : in Cursor)); 
```

# windows-8 - 如何在 Metro 应用程序的另一个 js 文件中调用 js 函数？

> ID：12623811
> 
> 赞同：2
> 
> 时间：2012-09-27T14:34:15.657
> 
> 标签：windows-8, microsoft-metro, winjs

我有一个 Metro 应用程序，我想在其中调用另一个 .js 文件中的 javascript 函数？谁能帮我。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T16:18:57.367

javascript 中的所有脚本都合并到一个“脚本上下文”中。这意味着如果您有：

文件1.js：

```
function a() { b(); } 
```

文件2.js：

```
function b() { alert("hi"); } 
```

那么只要在调用 b 之前包含 file2.js ，一切都会好起来的。这意味着在你的 HTML 中应该包含`<script>`标签，你会很好的。

如果你使用的是 WinJS，一个更好的例子可能是：

文件1.js：

```
WinJS.Namespace.define("MyNamespace", {
    firstFunction: function() { MyNamespace.secondFunction(); }
}); 
```

文件2.js

```
WinJS.Namespace.define("MyNamespace", {
    secondFunction: function() { alert("hi"); }
}); 
```

默认.html：

```
<script src="/file1.js"></script>
<script src="/file2.js"></script> 
```

**然而**，JavaScript 没有内置的“引用”动态加载。你必须建立或使用你自己的。

给这只猫剥皮的方法有很多，所以我建议你看看它们，然后决定哪种方法能满足你的需求。

*   [需要 JS](http://requirejs.org/)
*   在 WinJS 中内置页面控件/片段加载。如果你在 WinJS 中定义一个页面，当该页面的 html 文件被加载时，在 html 中声明的任何脚本都会被自动引入。原始片段加载也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:06:12.490

您可以只在调用函数的文件之前引用包含函数定义的文件，就像如果它是浏览器而不是 Windows 8 应用程序一样。

事实上，甚至不需要那么多。如果您在 window.load 或 document.load 之后调用该函数，那么这意味着您引用的所有 javascript 文件都已加载，因此引用序列甚至无关紧要。

# push-notification - Microsoft 推送通知服务定价

> ID：12623813
> 
> 赞同：2
> 
> 时间：2012-09-27T14:34:24.097
> 
> 标签：push-notification, windows-phone, mpns

我已经阅读了有关他们为 Windows 手机提供的推送通知服务的 Microsoft 文档，但没有关于定价的信息。我在某处读到，每天/每个应用程序/每个设备可以免费使用最多 500 个通知，并且它是未经身份验证的模式，但也有没有每日限制且需要花费一些钱的身份验证模式。这是真的吗？如果是，价格是多少？

如果用户在发送时未处于活动状态，我也对有关在服务器中保存消息的信息感兴趣。在开始丢弃之前，Microsoft Push Service 可以为一个设备/用户保存多少推送消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:15:13.457

它是免费的，无论是否经过身份验证。

不确定他们是否真的将消息存储在要传递的服务器上。当您发送一个时，他们会给您客户端连接状态作为响应的一部分。

# heroku - Heroku 运行 rake db.migrate / 错误：连接尝试失败

> ID：12623814
> 
> 赞同：1
> 
> 时间：2012-09-27T14:34:27.577
> 
> 标签：heroku, connection, rake

我遇到了“heroku run rake db:migrate”命令的问题。它抱怨“！Heroku 客户端内部错误”，请参阅下文了解全部内容。Git push 和 heroku 创建工作（见下文），但最终 rake db:migrate 崩溃。

我能做些什么？

一切顺利

斯特凡

以下是我从 Heroku 输入和获得的内容。

```
C:\Sites\demo_app_rt32>git push -u  origin master
Enter passphrase for key '/z/.ssh/id_rsa':
Counting objects: 102, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (91/91), done.
Writing objects: 100% (102/102), 32.37 KiB, done.
Total 102 (delta 8), reused 0 (delta 0)
To git@github.com:StefanHelber/demo_app_rt32.git
 * [new branch]      master -> master
Branch master set up to track remote branch master from origin.

C:\Sites\demo_app_rt32>heroku create --stack cedar
Creating murmuring-thicket-9165... done, stack is cedar
http://murmuring-thicket-9165.herokuapp.com/ | git@heroku.com:murmuring-thicket-
9165.git
Git remote heroku added

C:\Sites\demo_app_rt32>git push heroku master
Enter passphrase for key '/z/.ssh/id_rsa':
Counting objects: 102, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (91/91), done.
Writing objects: 100% (102/102), 32.37 KiB, done.
Total 102 (delta 8), reused 0 (delta 0)

-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.2.1
       Running: bundle install --without development:test --path vendor/bundle -
-binstubs bin/
       Fetching gem metadata from https://rubygems.org/.........
       Installing rake (0.9.2.2)
       Installing i18n (0.6.1)
       Installing multi_json (1.3.6)
       Installing activesupport (3.2.3)
       Installing builder (3.0.3)
       Installing activemodel (3.2.3)
       Installing erubis (2.7.0)
       Installing journey (1.0.4)
       Installing rack (1.4.1)
       Installing rack-cache (1.2)
       Installing rack-test (0.6.2)
       Installing hike (1.2.1)
       Installing tilt (1.3.3)
       Installing sprockets (2.1.3)
       Installing actionpack (3.2.3)
       Installing mime-types (1.19)
       Installing polyglot (0.3.3)
       Installing treetop (1.4.10)
       Installing mail (2.4.4)
       Installing actionmailer (3.2.3)
       Installing arel (3.0.2)
       Installing tzinfo (0.3.33)
       Installing activerecord (3.2.3)
       Installing activeresource (3.2.3)
       Using bundler (1.2.1)
       Installing coffee-script-source (1.3.3)
       Installing execjs (1.4.0)
       Installing coffee-script (2.2.0)
       Installing rack-ssl (1.3.2)
       Installing json (1.7.5) with native extensions
       Installing rdoc (3.12)
       Installing thor (0.14.6)
       Installing railties (3.2.3)
       Installing coffee-rails (3.2.2)
       Installing jquery-rails (2.0.2)
       Installing pg (0.12.2) with native extensions
       Installing rails (3.2.3)
       Installing sass (3.2.1)
       Installing sass-rails (3.2.4)
       Installing uglifier (1.2.3)
       Your bundle is complete! It was installed into ./vendor/bundle
       Post-install message from rdoc:
       Depending on your version of ruby, you may need to install ruby rdoc/ri data:
       <= 1.8.6 : unsupported
       = 1.8.7 : gem install rdoc-data; rdoc-data --install
       = 1.9.1 : gem install rdoc-data; rdoc-data --install
       >= 1.9.2 : nothing to do! Yay!

       Cleaning up the bundler cache.
-----> Writing config/database.yml to read from DATABASE_URL
-----> Preparing app for Rails asset pipeline
       Running: rake assets:precompile
       Asset precompilation completed (13.78s)
-----> Rails plugin injection
       Injecting rails_log_stdout
       Injecting rails3_serve_static_assets
-----> Discovering process types
       Procfile declares types      -> (none)
       Default types for Ruby/Rails -> console, rake, web, worker
-----> Compiled slug size: 9.0MB
-----> Launching... done, v5
       http://murmuring-thicket-9165.herokuapp.com deployed to Heroku

To git@heroku.com:murmuring-thicket-9165.git
 * [new branch]      master -> master

C:\Sites\demo_app_rt32>heroku run rake db:migrate
Running `rake db:migrate` attached to terminal... up, run.1
 !    Heroku client internal error.
 !    Search for help at: https://help.heroku.com
 !    Or report a bug at: https://github.com/heroku/heroku/issues/new

    Error:       A connection attempt failed because the connected party did not
 properly respond after a period of time, or established connection failed becau
se connected host has failed to respond. - connect(2) (Errno::ETIMEDOUT)
    Backtrace:   C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/lib/heroku/client/rendezvous.rb:39:in `initialize'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/lib/heroku/client/rendezvous.rb:39:in `open'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/lib/heroku/client/rendezvous.rb:39:in `block in start'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/timeout.rb:68:in `ti
meout'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/lib/heroku/client/rendezvous.rb:31:in `start'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/lib/heroku/command/run.rb:125:in `rendezvous_session'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/lib/heroku/command/run.rb:112:in `run_attached'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/lib/heroku/command/run.rb:21:in `index'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/lib/heroku/command.rb:206:in `run'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/lib/heroku/cli.rb:28:in `start'
                 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/heroku-2.3
2.4/bin/heroku:16:in `<top (required)>'
                 C:/RailsInstaller/Ruby1.9.3/bin/heroku:19:in `load'
                 C:/RailsInstaller/Ruby1.9.3/bin/heroku:19:in `<main>'

    Command:     heroku run rake db:migrate
    Version:     heroku-toolbelt/2.32.4 (i386-mingw32) ruby/1.9.3 autoupdate

C:\Sites\demo_app_rt32> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:44:49.740

请参阅[https://devcenter.heroku.com/articles/oneoff-admin-ps](https://devcenter.heroku.com/articles/oneoff-admin-ps)

> heroku 运行进程在端口 5000 上打开与 Heroku 的连接。如果您的本地网络或 ISP 阻塞了端口 5000，或者您遇到连接问题，您将看到类似于以下内容的错误：
> 
> ```
> $ heroku run rails console
> Running rails console attached to terminal... 
> Timeout awaiting process 
> ```
> 
> 您可以通过尝试使用 telnet 到rendezvous.runtime.heroku.com 直接连接到端口5000 来测试您与Heroku 的连接。成功的会话将如下所示：
> 
> ```
> $ telnet rendezvous.runtime.heroku.com 5000
> Trying 50.19.103.36...
> Connected to ec2-50-19-103-36.compute-1.amazonaws.com.
> Escape character is '^]'. 
> ```
> 
> 如果您没有得到此输出，您的计算机将被阻止访问我们的服务。我们建议与您的 IT 部门、ISP 或防火墙制造商联系以解决此问题。

# php - 嘿伙计们，我在这里得到了一个意想不到的 ¦¦ T_STRING，虽然错误本身看起来很简单，但我不知道如何解决它

> ID：12623816
> 
> 赞同：0
> 
> 时间：2012-09-27T14:34:29.890
> 
> 标签：php, header

意外的 ¦¦ T_STRING 在第 20 行。我已经尝试用 !isset 替换空，但错误保持不变。所以它不是空的是什么导致它

```
if (empty($hp) ¦¦ empty($money)) { ( // Line 20 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:35:41.233

无论字符“¦”是什么，都不是您需要使用的字符。您需要使用返回键上方的管道，例如“|”

```
if (empty($hp) || empty($money)){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:40:40.853

删除您可以使用的“¦”运算符

(空($hp) || 空($money))

条件或 `(empty($hp) OR empty($money))`

“或”运算符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:37:07.373

`if (empty($hp) ¦¦ empty($money)){`需要`if (empty($hp) || empty($money)){`...条件或符号不正确。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T14:36:00.923

```
 if (empty($hp) ¦¦ empty($money)){ 
```

问题在于[逻辑`or`运算符](http://php.net/manual/en/language.operators.logical.php)的尝试。它应该是两个完整的酒吧`||`，而你有破碎的酒吧`¦¦`。这被视为一个常量名称；然后，当不存在具有该名称的常量时，将其转换为字符串。显然，在这种情况下，字符串无效，因此出现错误。

您的键盘设置可能配置不正确，或者您可能需要一个不寻常的组合键（可能使用`AltGr`，具体取决于您的特定键盘）。

# flash - 为什么我启动时 FDT 不启动 ADL 或显示任何内容？

> ID：12623817
> 
> 赞同：0
> 
> 时间：2012-09-27T14:34:36.327
> 
> 标签：flash, air, fdt

当我启动一个简单的 AIR 项目时。ADL 没有启动/或者我什么也没看到：

```
Starting Full Build of Application.
Compiler arguments:
  -output 
    C:\Dev\FDT5\fdt_workspace\Application\bin\Application.swf
  -+configname=air +flexlib=
    C:\Dev\flex_sdk_4.6\frameworks
  --compiler.debug=false
  --debug-password=
  --compiler.source-path+=
    C:\Dev\FDT5\fdt_workspace\Application\src
  --compiler.library-path+=
    C:\Dev\flex_sdk_4.6\frameworks\libs\air\airglobal.swc,
    C:\Dev\flex_sdk_4.6\frameworks\libs\textLayout.swc,
    C:\Dev\flex_sdk_4.6\frameworks\libs\osmf.swc,
    C:\Dev\flex_sdk_4.6\frameworks\libs\authoringsupport.swc,
    C:\Dev\flex_sdk_4.6\frameworks\libs\core.swc,
    C:\Dev\flex_sdk_4.6\frameworks\libs\air\aircore.swc,
    C:\Dev\flex_sdk_4.6\frameworks\libs\air\applicationupdater.swc,
    C:\Dev\flex_sdk_4.6\frameworks\libs\air\applicationupdater_ui.swc,
    C:\Dev\flex_sdk_4.6\frameworks\libs\air\servicemonitor.swc
  -static-link-runtime-shared-libraries=
    true
  -target-player=11.1
  -library-path+=
    C:\Dev\flex_sdk_4.6/frameworks/locale/en_US
  -default-size=550,400
  -- 
 C:\Dev\FDT5\fdt_workspace\Application\src\com\powerflasher\SampleApp\Application.as

INFO Loading configuration file C:\Dev\flex_sdk_4.6\frameworks\air-config.xml

Pure build time: 265 ms. 
Save compiler information in 6 ms. 
Clean compiler information in 0 ms. 
828 bytes written to file C:\Dev\FDT5\fdt_workspace\Application\bin\Application.swf
in 273 ms

Launching AIR Debug Launcher
C:\Dev\flex_sdk_4.6\bin\adl.exe
    -nodebug
    -profile
    desktop
    C:\Dev\FDT5\fdt_workspace\Application\bin\Application-app.xml
    C:\Dev\FDT5\fdt_workspace\Application\bin 
```

我什么都没看到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:34:36.327

只要您的权限正确（您可以在 Flex SDK 中执行文件）并且 ADL 实际上正在启动（使用您的操作系统的进程查看器进行检查），最可能的解决方案是`<visible>`您的 description.xml 中的属性不是设置或设置为假。

将其更改为 true：

```
<visible>true</visible> 
```

更高版本的 FDT 将能够将其切换为 GUI 选项。

# sql-server - 如何避免 SQL Server 上的双重问题

> ID：12623818
> 
> 赞同：-2
> 
> 时间：2012-09-27T14:34:37.537
> 
> 标签：sql-server, filter, double

我正在使用 SQL Server 2008 R2

正如您在 LIB_TOURNE 1 已拍摄的图像 NOID 29 上所见，我怎么能忽略 LIB_TOURNE 2 拍摄的 NOID 29

所以当日期 X 的 NOID 是唯一的时。日期为 2012-09-27 11:47:52.000 的 NOID 29 仅出现一次。

![在此处输入图像描述](../Images/411b526570fe08529d511d18cbfc2f57.png)

提前谢谢你，史蒂夫

PS：我也尝试过：

> 从 LETTRE_VOIT_FINAL 上选择 DISTINCT *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:39:34.797

您可以使用以下命令执行此操作`group by`：

```
select min(lib_tourne), <all columns but lib_tourne>
from (<your query here>) t
group by <all columns but lib_tourne> 
```

# c - 指针算术和地址

> ID：12623821
> 
> 赞同：0
> 
> 时间：2012-09-27T14:34:39.980
> 
> 标签：c, pointers, memory-address

我遇到了这样的代码：

```
#include <stdio.h>

int main(void)
{
 int a[5] = { 1, 2, 3, 4, 5};
 int *ptr = (int*)(&a + 1);
 int *ptr2 = (int*) &a;
 ptr2 +=1 ;
 printf("%d %d %d \n", *(a + 1),*(ptr - 1) ,*ptr2 );
 return 0;
} 
```

除了这一行之外，指针算法为我做了：

```
int *ptr = (int*)(&a + 1); 
```

它是未定义的行为吗？为什么我们要`5`取消引用`*(ptr - 1)`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:36:34.170

的大小`a`为“5 `int`s”。所以`&a + 1`指的是*过去*所有的第一个内存位置`a`，因为指针运算是以 的大小为单位完成的`a`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:52:44.660

试试看！

```
int a[5] = {1, 2, 3, 4, 5};
printf("%#x, %#x, %#x, %#x\n", a, &a, a+1, &a+1);

0xbfa4038c, 0xbfa4038c, 0xbfa40390, 0xbfa403a0 
```

那么这告诉我们什么呢？

`0xbfa4038c == 0xbfa4038c`这意味着`a == &a`。这是数组或 中第一个元素的地址`a[0]`。

我们知道 int 的大小是 4，并且您知道`*(a+1)`== `a[1]`（数组中的第二个元素），这可以通过以下方式证明：

`0xbfa4038c + 0x4 = 0xbfa40390`意思是`a + one int = address of the next element`

因此，如果我们看到`&a+1 == 0xbfa403a0`，这意味着我们有`((0xa0-0x8c)/4)`= 5 个元素进入数组。你知道那`a[5]`是无效的，所以这意味着我们已经通过了数组的末尾。

所以如果你采取：

```
int *ptr = (int*)(&a + 1); //one passed last element in the array
printf("%d",*(ptr - 1));//back up one, or last element in the array and deference 
```

这就是为什么你得到`5`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T11:11:46.687

对于类型为 T 的 n 个元素的数组，则第一个元素的地址类型为“指向 T 的指针”；[整个数组的地址](http://publications.gbdirect.co.uk/c_book/chapter5/arrays_and_address_of.html)类型为“指向 T 类型的 n 个元素的数组的指针”；

```
int *ptr = (int*)(&a + 1); //&a-> address whole array, size=20 bytes, 
         //ptr=&a+1: next element =adress of a +20 bytes.
         //ptr - 1 = address of a +16 = address of last a's element = address of 5 
```

# c - 在keil ide中从c源代码调用汇编程序

> ID：12623826
> 
> 赞同：2
> 
> 时间：2012-09-27T14:34:59.807
> 
> 标签：c, assembly, 8051, keil

我在汇编语言中有 8051 微控制器的延迟例程。Ana 我可以在汇编语言程序中使用它们，但我想从 c 语言中使用这些例程，因为这些例程对我来说是完美的延迟。

我在下面发布的延迟代码是 delay.asm 文件...

```
;ALL DELAYS ROUTINES HERE
DELAY_SEG SEGMENT CODE
RSEG DELAY_SEG
;DELAY OF 1MS SUBROUTINE
DELAY1MS:
     MOV R7,#250
     DJNZ R7,$
     MOV R7,#247
     DJNZ R7,$
     RET
;DELAY OF 100MS SUBROUTINE
DELAY100MS:
     MOV R6,#99;1MUS
L1:
     ACALL DELAY1MS ;99MS
     DJNZ R6,L1;198MUS
     MOV R6,#250;1MUS
     DJNZ R6,$;500US
     MOV R6,#147;1US
     DJNZ R6,$;294US
     NOP
     RET;1US
;DELAY 0F 1SEC SUB ROUTINE
DELAY1S:
     MOV R5,#9
L2:
     ACALL DELAY100MS
     DJNZ R5,L2
     MOV R5,#99
L3:
     ACALL DELAY1MS
     DJNZ R5,L3
     MOV R5,#250
     DJNZ R5,$
     MOV R5,#138
     DJNZ R5,$
     RET 
```

我将这段代码包含在汇编语言中并简单地使用。但我想从 c 源代码中调用这些例程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:47:29.113

我不知道您的汇编器和 C 编译器之间的接口是如何工作的，但通常您必须告诉汇编器导出函数（应该有一个指令，请查看汇编器手册）。通常，汇编程序中的函数名称前需要有一个下划线，例如`_DELAY1S`. 然后您需要`extern`在引用该函数的源代码中创建一个声明，例如

```
extern void DELAY1S(void); 
```

您的工具可能会有所不同，请*阅读文档*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T15:51:32.723

要正确连接您的汇编器函数，您需要执行以下步骤：

*   为您的模块提供与文件名相同的名称，不带扩展名（我假设您的源文件具有 name `delays.a51`）：

> ```
> MODULE DELAYS 
> ```

*   在每个您希望在 C 模块中可见的函数名称前加上下划线。

*   对于每个函数，您需要使用
    以下命名约定声明一个单独的代码段：

> ?PR?FunctionName?ModuleName

*   将每个函数放入它自己的段中。
*   还应制作每个函数名称`PUBLIC`

因此，对于您的 DELAY1MS 功能，您有以下内容：

```
?PR?_DELAY1MS?DELAYS    SEGMENT CODE
    RSEG        ?PR?_DELAY1MS?DELAYS
    PUBLIC      _DELAY1MS
_DELAY1MS:
    ...
    ...
    RET 
```

要使 C 编译器可以使用函数，您应该在没有任何修改（没有下划线）的情况下声明它们，因此对于 DELAY1MS，您有：

> `void Delay1ms(void);`

链接器需要所有这些带有名称和段的棘手游戏，因为它构建调用图以在链接时为局部变量静态分配内存。

# android - 具有触摸事件和页面转换的应用程序的最佳设置

> ID：12623827
> 
> 赞同：0
> 
> 时间：2012-09-27T14:35:02.937
> 
> 标签：android, ios, windows, mobile

我一直在寻找设置/选择我的移动开发库的最佳方式。这让我对所有的选择感到头疼。

我尝试过 UXI、Zepto、JQMobile、Sencha 等等。

我正在寻找的是一个高度跨设备支持的轻量级库。我只想将它用于专注于滑动等移动事件的事件处理。而且我很想使用一些页面转换。

谁能谈谈我的一些道理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:42:39.927

你介意看看 Zepto 和 JQM 有什么问题吗？

Zepto 非常轻巧，可以精美地处理动画。不幸的是，文档不是很好，所以弄​​清楚它有点棘手。如果你有耐心学习它，我会选择它。

JQM 不那么轻量级，但有*很好的*文档，而且很多人可以在 stackoverflow 上为您提供帮助。它非常适合您的事件处理和转换。

Sencha 有非常好的功能，但天哪，它和我用过的任何东西都不一样。如果你能弄清楚，你可以制作一些漂亮的应用程序，但由于它的重量与你想做的事情相比，我会偏离这个方向。

[不过，这里有一些东西](http://fusiongrokker.com/post/using-the-zepto-js-touch-events-plugin-for-more-responsive-phonegap-apps-without-zepto)可以帮助您真正快速地进行触摸事件/事件处理。

# python - 用列表理解替换循环而不是循环获取一个函数以在列表理解中返回一个新数组

> ID：12623835
> 
> 赞同：1
> 
> 时间：2012-09-27T14:35:23.660
> 
> 标签：python, list, loops, numpy, list-comprehension

基本上，在我有如下代码之前，我试图避免循环遍历大数组：

```
for rows in book:
        bs = []
        as = []
        trdsa = []
        trdsb = []
        for ish in book:
            var = (float(str(ish[0]).replace(':',"")) - float(str(book[0]).replace(':',"")))
            if var < .1 and var > 0 :
                bs.append(int(ish[4]))
                as.append(int(ish[5]))
                trdsa.append(int(ish[-2]))
                trdsb.append(int(ish[-1]))
                time = ish[0]
            bflow = sum(numpy.diff(bs))
            aflow = sum(numpy.diff(as))
            OFI = bflow - aflow - sum(trdsb) + sum(trdsa)
            OFIlist.append([time,bidflow,askflow,OFI]) 
```

我不想循环遍历列表两次，因为它消耗了太多时间。我在想我可以做一个列表理解，但我不确定我是否走在正确的轨道上

```
OFIcreate(x,y):
    bs = []
    as = []
    trdsa = []
    trdsb = []
    var = (float(str(y[0]).replace(':',"")) - float(str(x[0]).replace(':',"")))
    if var < .1 and var >= 0 :
        bs.append(int(ish[4]))
        as.append(int(ish[5]))
        trdsa.append(int(ish[-2]))
        trdsb.append(int(ish[-1]))
        time = ish[0]
    bflow = sum(numpy.diff(bs))
    aflow = sum(numpy.diff(as))
    OFI = bflow - aflow - sum(trdsb) + sum(trdsa)
    OFIlist.append([time,bidflow,askflow,OFI])
    return OFIlist

    OFIc = [ OFIcreate(x,y) for x in book for y in book) 
```

问题是我想遍历列表并将 var >=0 和 var <.1 的所有实例分组，然后将值附加到新列表中。我现在拥有它的方式我不认为它会这样做，因为它只会继续创建长度为 1 的列表。关于我如何做到这一点的任何想法？或者更确切地说，我怎样才能使第一段代码更有效率？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:48:26.787

> 我不想循环遍历列表两次，因为它消耗了太多时间。我在想我可以做一个列表理解，但我不确定我是否走在正确的轨道上

可能不是。列表推导除了循环遍历给定的列表之外什么都不做，所以它应该没有明显的区别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:14:26.637

虽然列表推导确实比常规循环解释得更快，但它们不能适用于所有情况。我不认为你可以用`for`列表理解替换你的主循环。但是，可能还有一些改进的空间：

*   您可以`time`通过列表理解构建您的列表。

    ```
    time = [ish[0] for ish in book] 
    ```

*   您可以通过列表推导计算列表`var`并将其转换为`np.array`.

    ```
    var = np.array([t.replace(':',',') for t in time], dtype=float)
    var -= float(str(book[0]).replace(":", ",")) 
    ```

*   `bs`您可以为,构建 4 个 numpy int 数组`as`（您**需要**重命名，`as`是 Python 关键字）...

*   然后，您可以`bs`使用精美的索引过滤 ... 数组：

    ```
    bs_reduced = bs[(var < 0.1) & (var >=0)] 
    ```

# ios - 添加注释以从另一个视图映射

> ID：12623836
> 
> 赞同：0
> 
> 时间：2012-09-27T14:35:23.770
> 
> 标签：ios, uiviewcontroller, mkmapview, mkannotation, appdelegate

我正在尝试`plotParkingLots`从我的 AppDelegate 调用，因为我希望在应用程序启动时首先调用它（然后每隔 x 秒我将在稍后实现）。

`plotParkingLots`如果我通过我的 MapViewController`viewDidLoad`调用它可以正常工作，但是当我从 AppDelegate 调用它时，它不起作用。

我知道它被调用了，但是当我切换到我的地图视图时，没有显示注释！

MapViewController.h

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>

#define METERS_PER_MILE 1609.344

@interface MapViewController : UIViewController <MKMapViewDelegate>

@property (strong, nonatomic) IBOutlet MKMapView *mapView;

- (void)plotParkingLots;

@end 
```

MapViewController.m

```
- (void)plotParkingLots {
    NSString *url = [NSString stringWithFormat:@"http:/localhost/testes/parking.json"];
    NSData *jsonData = [NSData dataWithContentsOfURL: [NSURL URLWithString:url]];

    if (jsonData == nil) {
        UIAlertView *alertBox = [[UIAlertView alloc] initWithTitle: @"Erro de conexão" message: @"Não foi possível retornar os dados dos estacionamentos" delegate: self cancelButtonTitle: @"Ok" otherButtonTitles: nil];
        [alertBox show];
    }
    else {
        NSError *error;
        NSDictionary *json = [NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers error:&error];

        NSArray *parkings = [json objectForKey:@"parkings"];
        for (NSDictionary * p in parkings) {
            Parking *annotation = [[Parking alloc] initWithDictionary:p];
            [_mapView addAnnotation:annotation];
        }
    }
 }

- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {

    static NSString *identifier = @"Parking";
    if ([annotation isKindOfClass:[Parking class]]) {
        MKPinAnnotationView *annotationView = (MKPinAnnotationView *) [_mapView dequeueReusableAnnotationViewWithIdentifier:identifier];
        if (annotationView == nil) {
            annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:identifier];
        } else {
            annotationView.annotation = annotation;
        }

        annotationView.enabled = YES;
        annotationView.canShowCallout = YES;
        annotationView.image=[UIImage imageNamed:@"car.png"];

        return annotationView;
    }

    return nil;    
} 
```

AppDelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    [[MapViewController alloc] plotParkingLots];

    return YES;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T20:57:03.390

您不是在与向用户显示的 MapViewController 交谈。在您的 AppDelegate 中，您暂时分配了一个 MapViewController，绘制停车场，然后放弃该 MapViewController 并且不再使用它。

You'll need to keep a handle to that controller so that when the user presses something to make that viewcontroller get displayed it is the same one that has just plotted the parking lots.

# css - td元素上的Firefox css边框宽度

> ID：12623837
> 
> 赞同：0
> 
> 时间：2012-09-27T14:35:24.620
> 
> 标签：css, firefox, html-table

我无法在 Firefox 中将边框宽度设为 3px 纯绿色，即使它在 Chrome 中运行也是如此。我怎样才能解决这个问题？我的代码如下。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
        <head>
                <style>
                           td {border: 3px solid green; background:blue;}
                </style>
        </head>
        <body>
                <table>
                        <tr>
                               <td></td>
                               <td></td>
                               <td></td>
                        </tr>
                        <tr>
                               <td></td>
                               <td></td>
                               <td></td>
                        </tr>
                        <tr>
                               <td></td>
                               <td></td>
                               <td></td>
                        </tr>
                </table>
        </body> 
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:36:45.290

要消除空格并避免单元格之间的双边框，您必须折叠它们，例如：

```
table {
    border-collapse: collapse;
} 
```

[**演示**](http://jsfiddle.net/avcfp/1/)

使用某种 CSS 差异消除器也是一个好主意，它可以为您节省大量时间并有助于避免此类情况 -[***规范化 CSS***](http://necolas.github.com/normalize.css/)或[***CSS 重置***](http://meyerweb.com/eric/tools/css/reset/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:41:47.753

这是 jsfiddle (http://jsfiddle.net/jw5Gg/1/) 我添加了填充以给它一些空间。但实际上它有你只需要内容的边界。我希望这有帮助。

# iis - 使用 MSDeploy 从 IIS 6 迁移到 IIS 7.5 时忽略应用程序池

> ID：12623839
> 
> 赞同：0
> 
> 时间：2012-09-27T14:35:26.250
> 
> 标签：iis, migration, msdeploy, application-pool

我目前正在将我的网站从带有 IIS 6 的 Windows Server 2003 ( **SourceServer** ) 迁移到带有 IIS 7.5 的 Windows Server 2008 R2 ( **DestServer** )。

我使用**MSDeploy**工具来执行操作。检查依赖项后（仅*Windows Authentication*，已安装在**DestServer**中），我在 SourceServer 中创建**包**：

> msdeploy -verb:sync -source:metakey=lm/w3svc/5 -dest:package=c:\Site5.zip > WebDeployPackage.log

我将它复制到**DestServer**中。从**DestServer**我使用以下方法测试部署：

> msdeploy -verb:sync -source:package=c:\Site5.zip -dest:metakey=lm/w3svc/5 -whatif > WebDeploySync.log

但它给了我一个与**缺少应用程序池**相关的错误。事实上，我的目标之一是让网站更上一层楼，因为在**SourceServer**中，负责部署的人对命名约定（包括池和站点）搞得一团糟，一次分配了太多的应用程序（甚至 10 个）应用程序池等。

**因此，我的目标是在DestServer**的专用全新应用程序池中运行该站点。但是，如果 MSDeploy 在 DestServer 中找不到与**SourceServer 同名**的应用程序池，则它不会在**DestServer上部署****包**。

我还尝试`-enableLink: AppPoolExtension`在创建和部署包时使用 MSDeploy 中的命令来获取应用程序池。该软件包然后正确安装，但我不知道为什么，它在配置文件中给出错误。例如，我无法启用任何类型的身份验证模块。

有什么方法可以让 MSDeploy 在部署时忽略应用程序池？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T13:26:16.517

```
msdeploy -verb:sync 
         -source:metakey=lm/w3svc/1,computerName=original,encryptPassword="pwd",includeAcls=true 
         -disableLink:ContentExtension 
         -dest:package=original.zip,encryptPassword="pwd" 
         -enableLink:AppPool 
         -skip:WebApplication="^.*$"  >original.log 
```

# iphone - 为较小尺寸的 iPhone 屏幕（4、4s）创建一个新的 iOS 项目

> ID：12623840
> 
> 赞同：1
> 
> 时间：2012-09-27T14:35:27.700
> 
> 标签：iphone, ios

这让我发疯，我认为这很简单。我正在尝试使用 Xcode 4.5 创建一个新的 iOS 5.1 / iPhone 4 应用程序并使用我的 iPhone 5 进行测试。我用故事板制作了一个新项目，当我在我的设备上测试它时，它会缩放以填满屏幕——我的所有图像都被拉伸了。我想为旧设备（4、4s 等）修复较小的屏幕尺寸。

我需要调整视图控制器/视图上的哪些设置才能执行此操作？还是在构建设置中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:46:59.130

在 Traget Build Settings 中将允许的构建从默认设置`armv7 armv7s`为 only`armv7`并删除文件：`Default-568h@2x.png`.

# objective-c - 如何跨多个视图访问核心数据？

> ID：12623843
> 
> 赞同：1
> 
> 时间：2012-09-27T14:35:28.740
> 
> 标签：objective-c, ios, core-data

我正在尝试在我的应用程序的多个视图中保存和检索数据，现在我已经保存了数据，并且我可以检索该数据，只要我在 AppDelegate 中，但我已经向应用程序添加了另一个视图，我想在哪里检索和显示新存储的数据，但我不确定如何从另一个视图中访问核心数据，我该如何实现呢？

这是我到目前为止所拥有的，

***AppDelegate.m:***

```
// store the data
AppDelegate *app = [UIApplication sharedApplication].delegate;
STUDENT *std = (STUDENT *)[NSEntityDescription insertNewObjectForEntityForName:@"STUDENT" inManagedObjectContext:app.managedObjectContext];
[std setName:@"John"];
[std setNumber:[NSNumber numberWithInteger:1]];
[std setPlace:@"USA"];
[app.managedObjectContext save:nil];

// read the data
NSFetchRequest *req = [[NSFetchRequest alloc]init];
[req setEntity:[NSEntityDescription entityForName:@"STUDENT" inManagedObjectContext:app.managedObjectContext]];
[req setPredicate:[NSPredicate predicateWithFormat:@"name == %@", @"John"]];
STUDENT *stud = [[app.managedObjectContext executeFetchRequest:req error:nil] lastObject];

NSLog(@"%@",stud); 
```

NSLog 输出你所期望的，

```
<STUDENT: 0x518b860> (entity: STUDENT; id: 0x518e0a0 <x-coredata://5A6AC621-11C1-4857-82BF-9BEEF258B171/STUDENT/p10> ; data: {
    name = John;
    number = 1;
    place = USA;
}) 
```

我想从中访问数据的另一个视图控制器名为`FirstViewController.m/.h/.xib`，我对 Objective C 很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:39:05.700

应用程序委托是一种单例，因此您应该能够从任何视图访问它

```
MyAppDelegate *appDelegate = (MyAppDelegate *)[[UIApplication sharedApplication] delegate]; 
```

从那里你可以调用任何你想要的方法来检索和存储数据。

关于将核心数据堆栈保存在何处以通过应用程序访问存在各种问题，[这里](https://stackoverflow.com/questions/1267520/where-to-place-the-core-data-stack-in-a-cocoa-cocoa-touch-application/1267549#1267549)是其中之一。丹尼尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:55:50.687

您需要导入 appDelegate 的标头。您将使用它来访问 appDelegate 的托管对象上下文。您使用该上下文来获取您需要获取的信息。您还需要导入实体的类表示的标题。进行提取和插入是相同的过程。您可能还想查看[NSFetchedResultsController](http://developer.apple.com/library/ios/#DOCUMENTATION/CoreData/Reference/NSFetchedResultsController_Class/Reference/Reference.html)文档以帮助您使用 tableViews 等。

# image - 如何在不延迟恢复动画的情况下暂停连续的幻灯片动画？

> ID：12623846
> 
> 赞同：0
> 
> 时间：2012-09-27T14:35:38.003
> 
> 标签：image, jquery-animate, slider, continuous

我正在开始我的 jQuery 研究。我在制作连续幻灯片动画时遇到了困难，一些客户的图像经过屏幕。一切都很好，直到当用户将鼠标移到正在传递的对象上时我尝试暂停该功能`<ul>`。发生这种情况时，动画停止。但是要重新启动，它需要一个短暂的延迟（即使使用`.clearQueue();`），这个短暂的延迟仍然存在。我该如何纠正这个以消除延迟？

**功能：**

```
animar('.clientesHome ul');

// pauses / iniciate animation
    $('.clientesHome ul').hover(

        function () {
            $('.clientesHome ul').clearQueue();
            $('.clientesHome ul').stop();   
        },
        function () {
            $('.clientesHome ul').clearQueue();
            animar('.clientesHome ul');
        }
    );

function animar(oque) {
        if(!stoped){
            $(oque).css('left', $(oque).position().left);
            $(oque).clearQueue();

            var regressivo  = 2000;

            $(oque).animate({
                left: '-' + $('.clientesHome ul li').width() + 'px'
            },  regressivo ,
            'linear',
            function (){
                //
                $('.clientesHome ul li:first').clone().appendTo('.clientesHome ul');
                $('.clientesHome ul li:first').remove();

                    $(oque).css('left','0');
                    animar(oque);
            });
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:31:27.413

当您试图找到错误时，最好的方法是精简代码，使其尽可能简单。这是您在 jsfiddle 中剥离的代码：http: [//jsfiddle.net/r86Hk/](http://jsfiddle.net/r86Hk/)。这个例子工作得很好，没有延迟。为了找到你的bug，开始一一添加代码的特性，当你看到延迟时，你就找到了你的bug。

如果没有你原来的 HMLT/CSS，这是我能做的最好的。

# c# - C# 中的 KNXnetIP 实现

> ID：12623847
> 
> 赞同：5
> 
> 时间：2012-09-27T14:35:39.330
> 
> 标签：c#, knx

我正在用 C# 开发一个应用程序来控制我的 KNX 家庭系统。因此，我使用了 ETS3Demo 软件，使用软件 Wireshark 可以“看到”ETS3 发送到 KNX/IP 接口的 IP 数据报。

我已经成功使用“Connection_Request”、“ConnectionState_Request”和“Disconnect_Request”，即我发送请求数据报并且 KNX/IP 接口响应。

唯一让我头疼的请求是“Tunnelling_Request”。我发送信息的方式与发送以前的数据报完全相同，但这个似乎不起作用。

我“逐字节”发送数据报，您可以在以下代码中看到：

```
byte[] byteToSend1 = { 06, 16, 04, 32, 00, 21, 04 };

string communicationChannel = ComunicationChannelNum.Text;
byte bytesnew = Convert.ToByte(communicationChannel);

byte[] byteToSend2 = { 00, 00, 17, 00, 188, 224, 00, 00, 09, 01, 01, 00, 129 };

writer.WriteBytes(byteToSend1);
writer.WriteByte(bytesnew);
writer.WriteBytes(byteToSend2); 
```

我已经将与源地址和组地址对应的字节更改为“int”变量，但仍然不起作用。

有人可以给我一个建议或我可能做错的事情。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-01-19T06:38:29.680

对于任何来这里查找线程的人：

您始终可以使用可以免费下载的 KNX 协会 Falcon 库，并允许执行所有操作（运行时和管理）。它需要你理解 KNX 协议，虽然它不是最漂亮、最干净的库，但它可以工作。

在这里：[https ://my.knx.org/en/downloads/falcon](https://my.knx.org/en/downloads/falcon)

注意：可能需要您注册，但这是免费的。[我不能在这里分享它，因为它会违反许可协议。谢谢布米先生！]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T09:23:51.990

我正在使用 knx 来打开/关闭灯 我使用[此](http://www.eb-systeme.de/?page_id=479)链接发送隧道请求。

# php - Drupal 7 日期/文本字段问题

> ID：12623852
> 
> 赞同：2
> 
> 时间：2012-09-27T14:35:43.823
> 
> 标签：php, drupal, date, drupal-7, drupal-views

我在 Drupal 中有一个内容类型，它是一个文本字段，其中包含用户输入的日期。不，不幸的是，它不是实际的日期字段（ugghhh）。我需要做的是创建一个具有公开字段的视图，该字段可以提取两个日期之间的内容。例如，我想获取日期字段在 2012-09-01 和 2012-09-30 之间的所有节点。

我猜我可以使用带有`strtotime()`. 但是我会遇到的问题是无法在暴露的过滤器中过滤 2 次（基本上是 2 个数字字符串）。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-02T22:23:11.077

在内容类型上创建一个日期字段。日期字段将与您已有的文本字段“平行”。使用 hook_node_presave 之类的钩子（或者您可以使用规则）将日期字段更新为文本字段的转换日期格式。然后，您可以使用该日期字段作为原始数据进行排序。

但是，它还不是日期字段真的有充分的理由吗？

# tridion - 向 PublishItemsGroup 添加小功能区按钮

> ID：12623855
> 
> 赞同：4
> 
> 时间：2012-09-27T14:35:46.540
> 
> 标签：tridion

抱歉，如果这已被涵盖。我找到了如何添加新的功能区工具栏小按钮组，但我似乎无法找到（或弄清楚）如何将小按钮添加到现有的小按钮组。我正在尝试向 PublishItemsGroup 添加一个新按钮（在“发布/取消发布”按钮右侧的“发布/取消发布”下）。如果我这样做，它会创建一个全新的组：

```
 <ext:ribbontoolbars>
      <ext:add>
        <ext:extension pageid="HomePage" 
                       groupid="PublishItemsGroup" 
                       name="Expire" 
                       assignid="ext_expireWorkflow_Btn">
          <ext:command>StartWorkflowExpiration</ext:command>
          <ext:title>Expire</ext:title>
                        <ext:issmallbutton>true</ext:issmallbutton>
          <ext:dependencies>
            <cfg:dependency>mycompany.Resources.Workflow.StartWorkflowExpiration</cfg:dependency>
          </ext:dependencies>
          <ext:apply>
            <ext:view name="DashboardView">
              <ext:control id="DashboardToolbar"/>
            </ext:view>
          </ext:apply>
        </ext:extension>
      </ext:add>
    </ext:ribbontoolbars> 
```

但是，如果我只使用“PublishGroup”，那么它会将小按钮放在 Publish/Unpublish 的右侧（不在下方）

```
<ext:ribbontoolbars>
  <ext:add>
    <ext:extension pageid="HomePage" 
                   groupid="PublishGroup" 
                   name="Expire" 
                   assignid="ext_expireWorkflow_Btn">
      <ext:command>StartWorkflowExpiration</ext:command>
      <ext:title>Expire</ext:title>
                        <ext:issmallbutton>true</ext:issmallbutton>
      <ext:dependencies>
        <cfg:dependency>mycompany.Resources.Workflow.StartWorkflowExpiration</cfg:dependency>
      </ext:dependencies>
      <ext:apply>
        <ext:view name="DashboardView">
          <ext:control id="DashboardToolbar"/>
        </ext:view>
      </ext:apply>
    </ext:extension>
  </ext:add>
</ext:ribbontoolbars> 
```

是否可以向该组添加一个小按钮？还是我必须覆盖并创建一个全新的组，然后隐藏现有的 PublishItemsGroup？谢谢~华纳

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T07:20:32.457

不，不可能将小按钮添加到现有子组（组底部有标题，它们用垂直线分隔）。是的，您可以使用子组中的按钮添加新组并隐藏原始组。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-29T08:20:50.467

[我在tridiondeveloper.com](http://www.tridiondeveloper.com/ribbon-item-group)上写了关于如何使用功能区项目组的说明。它基本上是您需要指定的 Tridion 用户控件 (.ascx)，并且您将功能区项目组指定为扩展配置文件中的扩展。

# ios - 在 IOS 中创建自定义选项卡？

> ID：12623856
> 
> 赞同：0
> 
> 时间：2012-09-27T14:35:48.777
> 
> 标签：ios, uinavigationcontroller, uitabbarcontroller, custom-controls

我正在尝试在我的 IOS 应用程序中创建自定义选项卡。我遵循了这个简单的指南[http://kurrytran.blogspot.se/2011/10/ios-5-tutorial-creating-custom-tab-bar.html](http://kurrytran.blogspot.se/2011/10/ios-5-tutorial-creating-custom-tab-bar.html)每个选项卡应该有 2 个背景图片，一个被选中，一个被选中未选中。我的问题是，在我的真实项目中，我的标签栏控制器和视图控制器之间也有导航控制器，这似乎把一切都搞砸了。根本没有任何反应，我所有的标签都是黑色的，里面没有任何内容。我该怎么做才能让它工作？

这是放在 firstviewCotroller.m

```
- (void)viewDidLoad
{
UIImage *selectedImage0 = [UIImage imageNamed:@"HomeDB.png"];
UIImage *unselectedImage0 = [UIImage imageNamed:@"HomeLB.png"];

UIImage *selectedImage1 = [UIImage imageNamed:@"ScheduleDB.png"];
UIImage *unselectedImage1 = [UIImage imageNamed:@"ScheduleLB.png"];

UIImage *selectedImage2 = [UIImage imageNamed:@"BuildingsDB.png"];
UIImage *unselectedImage2 = [UIImage imageNamed:@"BuildingsLB.png"];

UIImage *selectedImage3 = [UIImage imageNamed:@"InformationDB.png"];
UIImage *unselectedImage3 = [UIImage imageNamed:@"InformationLB.png"];

UIImage *selectedImage4 = [UIImage imageNamed:@"MoreDB.png"];
UIImage *unselectedImage4 = [UIImage imageNamed:@"MoreLB.png"];

UITabBar *tabBar = self.tabBarController.tabBar;
UITabBarItem *item0 = [tabBar.items objectAtIndex:0];
UITabBarItem *item1 = [tabBar.items objectAtIndex:1];
UITabBarItem *item2 = [tabBar.items objectAtIndex:2];
UITabBarItem *item3 = [tabBar.items objectAtIndex:3];
UITabBarItem *item4 = [tabBar.items objectAtIndex:4];

[item0 setFinishedSelectedImage:selectedImage0 withFinishedUnselectedImage:unselectedImage0];
[item1 setFinishedSelectedImage:selectedImage1 withFinishedUnselectedImage:unselectedImage1];
[item2 setFinishedSelectedImage:selectedImage2 withFinishedUnselectedImage:unselectedImage2];
[item3 setFinishedSelectedImage:selectedImage3 withFinishedUnselectedImage:unselectedImage3];
[item4 setFinishedSelectedImage:selectedImage4 withFinishedUnselectedImage:unselectedImage4];
[super viewDidLoad];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:53:53.480

将 UINavigationControllers 分别放在 MainWindow.xib 中的每个选项卡中，然后在您的 App 委托中使用上述代码更改 App Delegate 中的选项卡栏项目不是更好。

我在我的 App Delegate 的“didFinishLaunchingWithOptions”方法中执行以下操作。

```
UITabBar *tabBar = self.tabBarController.tabBar;
UITabBarItem *item0 = [tabBar.items objectAtIndex:0];
UITabBarItem *item1 = [tabBar.items objectAtIndex:1];
UITabBarItem *item2 = [tabBar.items objectAtIndex:2];

[item0 setFinishedSelectedImage:[UIImage imageNamed:@"tab-1-selected.png"] withFinishedUnselectedImage:[UIImage imageNamed:@"tab-1.png"]];
[item1 setFinishedSelectedImage:[UIImage imageNamed:@"tab-2.png"] withFinishedUnselectedImage:[UIImage imageNamed:@"tab-2.png"]];
[item2 setFinishedSelectedImage:[UIImage imageNamed:@"tab-3-selected.png"] withFinishedUnselectedImage:[UIImage imageNamed:@"tab-3.png"]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:46:50.140

感谢您的回答 AndyDev！这是我下面的代码....

**我的 AppleDelegate.h 文件：**

```
@interface AppDelegate : UIResponder <UIApplicationDelegate>{

UITabBarController *tabBarController;
}

@property (strong, nonatomic) UIWindow *window;
@property (nonatomic, retain) IBOutlet UITabBarController *tabBarController;

@end 
```

**我的 AppleDelegate.m 文件：**

```
#import "AppDelegate.h"

@implementation AppDelegate
@synthesize tabBarController;
@synthesize window = _window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

UITabBar *tabBar = self.tabBarController.tabBar;
UITabBarItem *item0 = [tabBar.items objectAtIndex:0];
UITabBarItem *item1 = [tabBar.items objectAtIndex:1];
UITabBarItem *item2 = [tabBar.items objectAtIndex:2];
UITabBarItem *item3 = [tabBar.items objectAtIndex:3];
UITabBarItem *item4 = [tabBar.items objectAtIndex:4];  

[item0 setFinishedSelectedImage:[UIImage imageNamed:@"BuildingsDB.png"] withFinishedUnselectedImage:[UIImage imageNamed:@"BuildingsLB.png"]];

[item1 setFinishedSelectedImage:[UIImage imageNamed:@"BuildingsDB.png"] withFinishedUnselectedImage:[UIImage imageNamed:@"BuildingsLB.png"]];

[item2 setFinishedSelectedImage:[UIImage imageNamed:@"BuildingsDB.png"] withFinishedUnselectedImage:[UIImage imageNamed:@"BuildingsLB.png"]];

 [item3 setFinishedSelectedImage:[UIImage imageNamed:@"BuildingsDB.png"] withFinishedUnselectedImage:[UIImage imageNamed:@"BuildingsLB.png"]];  

 [item4 setFinishedSelectedImage:[UIImage imageNamed:@"BuildingsDB.png"] withFinishedUnselectedImage:[UIImage imageNamed:@"BuildingsLB.png"]]; 

return YES;
} 
```

我可能做错了什么。我以前从未尝试在 IOS 中定制任何东西，这是我在 IOS 中开发的第一个项目。我还需要每个 ViewController.m 文件中的任何代码吗？这段代码至少没有任何反应......

# c - fprintf 和 NULL 终止符

> ID：12623859
> 
> 赞同：3
> 
> 时间：2012-09-27T14:35:59.487
> 
> 标签：c, string, null, printf

我正在使用 fprintf 将字符串附加到文档中，这是我有疑问的行：

```
fprintf(win, bff[i - 2] != '\n' && bff[i - 2] != '\r' ? "\nmultiscreen=1" : "multiscreen=1"); 
```

该代码有效，它附加`multiscreen=1`到文件中的下一个可用行。

但是，如果我理解正确，它不会`NULL`在末尾添加一个字符`multiscreen=1`吗？这是否重要，因为我将它写入文件并且`NULL`字符串中的尾随是 C 的东西？

还是使用`fputs`而不是更正确`fprintf`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T14:37:37.830

字符串文字自动将 a`0`作为最后一个字符。所以你不需要自己添加一个。

`NUL`终止符仅用于（或您正在使用的`fprintf`任何字符串函数）知道何时停止从指针写入字符；no`NUL`实际上曾经写入文件。

是的，我建议您使用`fputs`而不是，`fprintf`因为您没有使用任何格式化工具`fprintf`，除非您在问题的评论中使用pmg的建议，它确实使用了格式化序列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:37:55.683

您不需要`NULL`文件中的 。这是一个 C 约定，与文件无关。你很厉害。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T14:38:28.173

`\0`如果您写入文件，则不需要尾随。这正是 C 用来分隔字符串的方式，因为否则无法知道字符串的结束位置

# tfs - 如何以编程方式跨多个分支跟踪 TFS 变更集？

> ID：12623863
> 
> 赞同：5
> 
> 时间：2012-09-27T14:36:04.533
> 
> 标签：tfs, tfs-sdk

我有一个 TFS 更改集 ID，它已在多个分支中合并。我希望能够找到所有相关的变更集 ID。有没有办法用来`VersionControlServer.TrackMerges`查找这些信息，或者是否有不同的 API 调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T13:44:46.450

是的，VersionControlServer.TrackMerges() 是您要使用的 API。在 sourceItem 参数中，传递要从中跟踪更改的分支的根。在 targetItems 参数中，传递要跟踪变更集的分支的根。请注意，这仅适用于具有合并关系的分支根。确保这是真的最好的方法是查看分支层次结构并使分支直接相关或通过某些路径相关。

假设您想在分支层次结构中跟踪从 $/Proj/Main 到 $/Proj/Feature2 的变更集，如下所示：

```
$/Proj/Main
    $/Proj/Dev
       $/Proj/Feature2 
```

然后你会想要传递 $/Proj/Main 作为你的 sourceItem 和 $/Proj/Dev AND $/Proj/Feature2 作为 targetItems。

如果您有任何问题，请告诉我。

# ios - NSManagedObject 删除无法正常工作

> ID：12623864
> 
> 赞同：0
> 
> 时间：2012-09-27T14:36:09.733
> 
> 标签：ios, macos, cocoa, core-data, nsmanagedobject

我正在使用语句删除 NSManagedObject

> [managedObjectContext deleteObject:obj];

然后将更改存储到该持久存储中。当我尝试使用一些数据库查看器查看我的实际表时，我可以看到该对象仍然存在于表中。我很困惑，我在删除后进行了刷新调用，如下所示（就在保存到持久存储之前）。

> [managedObjectContext refreshObject:obj mergeChanges:YES];

当我现在尝试查看表格时，我看不到对象。它现在正在工作，但我很困惑，因为有两个原因。

1：我正在删除许多其他地方的许多对象，并没有在每个地方都进行刷新，尽管我正在保存到持久存储中。

2：我不明白刷新已经删除的对象的概念。

谁能帮我吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:06:09.267

没有更多的上下文就不容易回答。

也就是说，如果您删除一个托管对象，除非它们是在同一个 managedobjectContext 上创建的，否则 fetchedResultsController 不会被更新。换句话说，如果从两个不同的托管上下文发出的两个数据库获取将具有数据库状态的不同步视图。

我建议您检查一下是否不是这种情况。

此外，您不必执行刷新 - 除非在非常特殊的情况下 - NSFetchresultController 会收到有关数据库更改的通知，前提是您实现了 NSFetchedResultsControllerDelegate 协议。

# facebook - 在 Facebook 中播放嵌入的 mp4 视频，点赞或使用 Flash 分享

> ID：12623865
> 
> 赞同：28
> 
> 时间：2012-09-27T14:36:09.983
> 
> 标签：facebook, facebook-like, facebook-opengraph, embedded-video

我有一个 H.264 编码的 mp4 文件，当提供它的页面被点赞或共享时，我试图将其嵌入到 Facebook 帖子中。

我的理解是，我只需要在被喜欢/共享的 URL 上放置[正确的 Open Graph`<meta>`标签。](http://developers.facebook.com/docs/opengraph/objects/builtin/#video)但是，我尝试了几组不同的`<meta>`标签，当我将 URL 粘贴到我的状态更新并发布时，视频仍然没有嵌入。它确实嵌入了`og:image`属性中的图像，但是单击图像只会将用户传递给`og:url`.

当我使用[Facebook Debugger 工具](http://developers.facebook.com/tools/debug)时，它为*Raw Open Graph Document Information*显示的内容如下：

```
Meta Tag:   <meta property="fb:app_id" content="000000000000000" />
Meta Tag:   <meta property="og:url" content="http://www.testdomain.com/path/to/shared/page" />
Meta Tag:   <meta property="og:title" content="Example Page" />
Meta Tag:   <meta property="og:description" content="Example Description" />
Meta Tag:   <meta property="og:site_name" content="Example" />
Meta Tag:   <meta property="og:image" content="http://content.example.com/images/example.png" />
Meta Tag:   <meta property="og:type" content="video.other" />
Meta Tag:   <meta property="og:video:width" content="400" />
Meta Tag:   <meta property="og:video:height" content="300" />
Meta Tag:   <meta property="og:video" content="http://static.example.com/flowplayer-3.2.15.swf?config=%7b%22clip%22%3a%22http%3a%2f%2fcontent.example.com%2fpath%2fto%2fvideo.mp4%3fv%3d0%22%7d" />
Meta Tag:   <meta property="og:video:type" content="application/x-shockwave-flash" />
Meta Tag:   <meta property="og:video" content="http://content.example.com/path/to/video.mp4?v=0" />
Meta Tag:   <meta property="og:video:type" content="video/mp4" />
Meta Tag:   <meta property="og:video" content="http://www.testdomain.com/path/to/shared/page" />
Meta Tag:   <meta property="og:video:type" content="text/html" /> 
```

^(上面的值已被替换为虚拟值，但它们都是有效的链接。)

Facebook 似乎正确地解析了这一点，因为它显示在*Type of Share -> Video*下：

```
status: Video embedding on Facebook enabled
1:  application/x-shockwave-flash
2:  text/html 
```

当我直接转到 Flash 播放器 url ( `http://static.example.com/flowplayer-3.2.15.swf?config=%7b%22clip%22%3a%22http%3a%2f%2fcontent.example.com%2fpath%2fto%2fvideo.mp4%3fv%3d0%22%7d`) 时，视频可以正确播放（嵌入在 Flash 播放器中）。

我尝试过/考虑过的事情：

**跳过 Flash 播放器**

最初我什至在列表中都没有 Flash 播放器，`og:video`而是尝试先使用 mp4 文件。Facebook 没有选择它并将喜欢/分享视为普通链接分享。

**白名单**

在允许嵌入视频之前，必须将应用程序/域列入白名单。[这不再是必要](http://developers.facebook.com/blog/post/486/)的了。我没有将我的域列入白名单。

**HTTPS**

一些消息来源说，正在使用的 Flash 播放器需要通过 HTTPS 托管。我的研究表明，这仅适用于用户通过 HTTPS 浏览 Facebook 的情况，而我在测试时没有这样做过。

*我目前正在使用支持 HTTPS 的 Flash 播放器运行一些测试，以查看是否有任何变化。*

**旧标签**

最糟糕的是，我尝试[添加较旧的 Facebook](http://garethhooper.com/articles/social-media/45-integration/152-share-on-facebook-how-to-embed-your-own-videos-on-someones-facebook-wall-when-your-web-pages-are-shared-on-facebook.html) `<meta>`和`<link>`标签（例如`title`，`video_src`），看看它是否会选择它们。它没有。

**缓存刷新**

我`?fbrefresh=1`在 Facebook 调试器中传递了 URL 和 URL，以确保 URL 的缓存版本被清除。这确实导致最新的元信息被拉入，但仍然没有嵌入。

**iPad**

因为我的标签中有`video/mp4`后备`og:video`，所以我在 iPad 应用程序中查看了我的 Facebook 新闻提要。令人兴奋的是，缩略图上覆盖了一个小播放按钮。但是，触摸播放按钮会导致重定向到共享 URL，而不是内联播放视频。iPad 上的 Safari 具有相同的行为（但没有播放按钮覆盖）。

**文档命名空间**

我将适当的 Open Graph / Facebook 命名空间添加到我的标记中：

```
<html xmlns:og="http://ogp.me.ns#" xmlns:fb="http://www.facebook.com/2008/fbml">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# video: http://ogp.me/ns/video#"> 
```

但它似乎没有效果。我不认为他们是必需的。

* * *

有什么我在这里想念的吗？我觉得到目前为止我发现的很多资源可能已经过时了，因为 Facebook 已经多次更改了他们的 API，所以我可能错过了一个新的要求。

**如何让视频在 Facebook 时间线中嵌入和播放？**

* * *

看看 YouTube 的`og:`元标签，我能发现的唯一区别是：

1.  YouTube`og:url`和`og:video`来自同一域*和*子域 ( `www.youtube.com`)。我的服务来自同一个域，但不同的子域（媒体：`content.example.com`，播放器：） `static.example.com`。**子域是否必须与所有`og:`元信息相同？**
2.  YouTube 的分享 URL 本身并不是直截了当`.swf`的，但它是 Flash 内容：

    ```
    rob@uvm:~$ curl "http://www.youtube.com/v/oHg5SJYRHA0?version=3&autohide=1" > yt
      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                     Dload  Upload   Total   Spent    Left  Speed
    100  4242  100  4242    0     0  43522      0 --:--:-- --:--:-- --:--:-- 55815
    rob@uvm:~$ file yt
    yt: Macromedia Flash data (compressed), version 10 
    ```

* * *

刚刚意识到我的一个 URL 实际上位于不同的域中。我有一种感觉，那就是罪魁祸首。我现在正在移动一些东西来尝试一下。我已经更新了上面的元标记数据。[没有提前做出这个观察感到有点不好意思。]

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-01T21:29:45.440

这就是最终为我工作的东西。

```
<!-- These two aren't necessary for embedding. -->
<meta property="og:site_name" content="Example">
<meta property="fb:app_id" content="000000000000000">

<!-- These are mostly needed. A few are probably still optional, but they're all good to have. -->
<meta property="og:type" content="movie">
<meta property="og:title" content="Example Page">
<meta property="og:description" content="Example Description">
<meta property="og:url" content="http://www.testdomain.com/path/to/shared/page">
<meta property="og:image" content="http://content.example.com/images/example.png">
<meta property="og:video" content="http://static.example.com/player.swf?file=http%3a%2f%2fcontent.example.com%2fpath%2fto%2fvideo.mp4%3fv%3d0&amp;autoplay=true">
<meta property="og:video:type" content="application/x-shockwave-flash">

<!-- Not necessary, but might (can't find up-to-date docs) be used for iOS fallback. -->
<meta property="og:video" content="http://content.example.com/path/to/video.mp4?v=0">
<meta property="og:video:type" content="video/mp4"> 
```

一些观察和有用的信息：

**Flash播放器**

*   我切换到使用[JWPlayer 是](http://www.longtailvideo.com/players)因为它的查询参数 flashvars 配置比[FlowPlayer](http://flowplayer.org/)稍微简单一些。我想我可以让 FlowPlayer 更努力地工作。JWPlayer 还有一个[很好的 Facebook 嵌入指导页面](http://www.longtailvideo.com/blog/19150/publish-your-videos-to-facebook-with-a-jw-player)。*（注意：许多 Flash 播放器需要购买许可证才能用于商业用途 - 确保在必要时获得一个。）*

**打开图形`<meta>`标签**

*   使用**电影**为`og:type`. 我最初使用`video`和`video.other`。那些可能也有效，但使用电影*肯定*对我有用。
*   嵌入不需要**以下**属性`og:`：, , .**`fb:app_id``og:video:width``og:video:height`**
***   请注意**URLEncoded** `file`查询参数。需要这样做应该是相当明显的，但请记住分别对参数值进行编码。之前的 & 符号 ( `&`) 在`autoplay=true`添加到页面标记之前是 XML 编码的。在 Facebook 调试器的“对象属性”部分中查看与符号时，它被正确解码。*   在不同的子域上托管内容和共享 url**并不重要**。唯一*可能*导致问题的域问题是 Flash 播放器本身，并且可以通过[`crossdomain.xml`](http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html)在内容服务器上正确配置来避免。**

 ****Facebook 调试器工具观察**

*   [Debugger Tool](http://developers.facebook.com/tools/debug)的“共享类型”部分*有点*误导： ![视频](../Images/d3bb38fb25fe3ce8a28b26547da2aca9.png) 这是我同时拥有`application/x-shockwave-flash`和`video/mp4`类型时显示的内容。我本来希望它在这个列表中有两个项目，但它只有第二个。尽管如此，Flash 播放器仍然是嵌入式的。
*   当我看到 Facebook 将所有内容都显示为 unicode 时，我最初想知道 Facebook 是否正在使用 URLEncoded 参数： ![独角兽^H^Hde](../Images/f8e61c13103017d56a27857597e47ae0.png) 但是，看起来这不是问题。不要让它混淆你。

**HTTPS**

*   上面的代码没有嵌入 https Facebook 浏览。此外，**`og:video:secure_url`元属性不起作用**（[可能是因为这个](http://developers.facebook.com/bugs/374114345976370/)）。我最终做的是通过 https 为 flash 播放器及其源 mp4 参数**提供**服务。`file`生成的元标记看起来像：

    ```
    <meta property="og:video" content="https://static.example.com/player.swf?file=https%3a%2f%2fcontent.example.com%2fpath%2fto%2fvideo.mp4&amp;autostart=true" /> 
    ```

    是`og:video`唯一需要通过 https 的；`og:image`,`og:url`等仍然可以通过 http 提供服务。

希望这能帮助其他人避免我在调试和学习所有这些时遇到的死胡同和红鲱鱼。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-23T17:51:44.937

FYI video/mp4 目前在 2014 年在这里有效。

请参阅[此页面](https://developers.facebook.com/docs/opengraph/creating-custom-stories/#propertytypes-video)上提供的元数据（ctrl-f mp4）：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-21T15:09:38.857

好像 facebook 只接受 application/x-shockwave-flash 或 video/mp4 而不是 text/html。

> 视频的 MIME 类型。应用程序/x-shockwave-flash 或视频/mp4。

[https://developers.facebook.com/docs/sharing/webmasters](https://developers.facebook.com/docs/sharing/webmasters)**

# python - Django 按字段对结果进行分组

> ID：12623866
> 
> 赞同：2
> 
> 时间：2012-09-27T14:36:15.587
> 
> 标签：python, django, django-models, django-templates, iteration

对不起菜鸟问题。假设我们有一个具有关系的模型：

```
 class Book(models.Model):
     name = models.CharField(max_length=300)
     category = models.ForeignKey(Category)

  class Category(models.Model):
     name = models.CharField(max_length=300) 
```

是否有可能以某种方式对结果进行分组，以便在模板中我们可以有这样的东西？

```
<ul>
   {% for category in book_categories%}
              <li> 
                  {{category.name}} 
                   <br/>  
                  {% for book in category%}
                      {{book.name}} , {{book.author}}, etc...
                  {% endfor %} 
             </li>
   {% endfor %}           
</ul> 
```

还是我让事情变得复杂并且有一种更简单的方法来实现这样的 html 输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:39:09.330

将类别传递给您的模板，然后您可以执行以下操作

```
<ul>
   {% for category in categories %}
              <li> 
                  {{category.name}} 
                   <br/>  
                  {% for book in category.book_set.all %}
                      {{book.name}} , {{book.author}}, etc...
                  {% endfor %} 
             </li>
   {% endfor %}           
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:42:41.030

您可以仅加载按类别排序的书籍，然后在模板中包含如下内容：

```
<ul>
  {% for book in books %}
    <li>
        {% ifchanged book.category__name %}
            {{ book.category__name }}
        {% endifchanged %}

        <br/>  
        {{book.name}} , {{book.author}}, etc...
    </li>
  {% endfor %}          
</ul> 
```

# php - 从 php 运行 python 文件不会生成输出文件

> ID：12623868
> 
> 赞同：1
> 
> 时间：2012-09-27T14:36:18.073
> 
> 标签：php, python, exec, os.system

我从 php.ini 运行另一个文件时遇到问题。我希望我的 php 参数是运行一个调用另一个文件本身的 python 文件的输出。

这是我的 php 文件：

```
<?php
    if (isset($_POST['submit'])) {
    $params = solve();
}

function solve() {
  exec("python array.py", $output);
  return $output;
}
?> 
```

如果 array.py 很简单：

```
if __name__ == "__main__":
    print 1
    print 2
    print 3
    print 4 
```

我的输出将得到 1,2,3,4，但是一旦我将 array.py 更改为以下调用 os.system 的文件，我什么也得不到。所以新的array.py是：

```
import os

def main():
    os.system("python test.py") #test.py creates tmp.txt with 4 lines w/ values 1,2,3,4

def output():
    f = open("tmp.txt", "r")
    myReturn = []
    currentline = f.readline()

    while currentline:
          val = currentline[:-1]  #Getting rid of '\n'
          val = int(val)
          myReturn = myReturn + [val]
          currentline = f.readline()
    f.close()
    return myReturn

if __name__ == "__main__":
     main()
     o = output()
     print o[0]
     print o[1]
     print o[2]
     print o[3] 
```

另外，如果我只运行 test.py，则输出是文件 tmp.txt：

```
 1
 2
 3
 4 
```

所以现在，当我运行我的 php 文件时，输出 tmp.txt 甚至没有在目录中创建，因此我也没有从我的 php 中获得任何输出。我不确定为什么会发生这种情况，因为当我自己运行 array.py 时，我得到了所需的输出，并创建了 tmp 文件。

编辑：我忘了包括：上面的导入操作系统。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:40:15.300

将执行更改为：

```
exec("python array.py 2>&1", $output) 
```

或者检查 web 服务器或 php 错误日志。这会将 python 脚本的错误输出返回到您的 php 脚本（通常不是您在生产中想要的）。

# oracle - 在 Oracle 中插入日期时出错

> ID：12623869
> 
> 赞同：0
> 
> 时间：2012-09-27T14:36:21.593
> 
> 标签：oracle

我正在尝试运行此插入命令

```
INSERT INTO DW_BATCH_HIST   
(DW_BATCH_HIST.BATCH_NBR, DW_BATCH_HIST.TRANS_START_DATE, DW_BATCH_HIST.BATCH_STATUS) 
VALUES(82,to_date('27-SEPT-2012 11:00:00.000','DD-MON-YYYY hh:mi:ss'), 1) 
```

我收到此错误：

> ORA-01841: （完整）年份必须介于 -4713 和 +9999 之间，而不是 0

年份是有效年份，所以我不明白为什么会收到此错误。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:40:48.883

面具部分的月份`MON`应该是三个字母的缩写，而不是你所拥有的四个。

**编辑**：正如其他人所指出的，毫秒也应该被删除。

```
'27-SEP-2012 11:00:00' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:44:18.767

将“SEPT”更改为“SEP”并从时间值中删除毫秒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:43:16.910

如果您想在 Oracle（和大多数其他数据库）中保持日期/时间格式的安全，请使用 SQL 标准时间戳文字格式。在你的情况下，写

```
TIMESTAMP '2012-09-27 11:00:00.000' 
```

如果这不是一个选项，请固定您的日期：

```
to_date('27-SEP-2012 11:00:00','DD-MON-YYYY hh:mi:ss')
-- removed the T from SEPT, as well as the millisecond part 
```

# android - Horizo ntalScrollView OutOfMemoryError

> ID：12623874
> 
> 赞同：0
> 
> 时间：2012-09-27T14:36:37.520
> 
> 标签：android, out-of-memory, horizontalscrollview

我正在尝试用 5 张图片做一个 Horizo​​ntalScrollView。我像这样实现了xml

```
 <?xml version="1.0" encoding="utf-8"?>
<HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/gallery"
        android:layout_width="match_parent"
        android:layout_height="match_parent" 
        android:spacing="40dp"
        android:scrollbars="horizontal"
        android:fadeScrollbars="false"
        android:layout_marginBottom="50dp">

<LinearLayout 
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" 
    android:background="@drawable/background"/>

</HorizontalScrollView> 
```

代码是这样的

```
package com.infobest.praiser.activity;

import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.widget.HorizontalScrollView;
import android.widget.ImageView;
import android.widget.LinearLayout;

import com.infobest.praiser.R;
import com.infobest.praiser.actionbar.ActionBarActivity;

public class TutorialActivity extends ActionBarActivity
{
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.tutorial);
        Integer[] mImageIds = {R.drawable.tutorial1, R.drawable.tutorial2, R.drawable.tutorial3,
            R.drawable.tutorial4, R.drawable.tutorial5};
        HorizontalScrollView h = (HorizontalScrollView) this.findViewById(R.id.gallery);
        LinearLayout topLinearLayout = new LinearLayout(this);
        topLinearLayout.setOrientation(LinearLayout.HORIZONTAL);

        for (int i = 0; i < 5; i++)
        {
            final ImageView imageView = new ImageView(this);

            imageView.setImageResource(mImageIds[i]);
            topLinearLayout.addView(imageView);

        }
        h.addView(topLinearLayout);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu)
    {
        MenuInflater menuInflater = getMenuInflater();
        menuInflater.inflate(R.menu.menu_tutorial, menu);

        // Calling super after populating the menu is necessary here to ensure
        // that the
        // action bar helpers have a chance to handle this event.
        return super.onCreateOptionsMenu(menu);
    }

} 
```

我到底做错了什么，因为我得到了 OutOfMemoryError

日志猫

```
 FATAL EXCEPTION: main  java.lang.OutOfMemoryError     at
 android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)    at
 android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:483) 
    at
 android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:351)
    at
 android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:773)
    at android.content.res.Resources.loadDrawable(Resources.java:1937) 
    at android.content.res.Resources.getDrawable(Resources.java:664)    at
 android.widget.ImageView.resolveUri(ImageView.java:542)    at
 android.widget.ImageView.setImageResource(ImageView.java:315)      at
 com.infobest.praiser.activity.TutorialActivity.onCreate(TutorialActivity.java:30)
    at android.app.Activity.performCreate(Activity.java:4465)   at
 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
    at
 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1919)
    at
 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
    at android.app.ActivityThread.access$600(ActivityThread.java:122) 
    at
 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146) 
    at android.os.Handler.dispatchMessage(Handler.java:99)      at
 android.os.Looper.loop(Looper.java:137)    at
 android.app.ActivityThread.main(ActivityThread.java:4340)      at
 java.lang.reflect.Method.invokeNative(Native Method)   at
 java.lang.reflect.Method.invoke(Method.java:511)   at
 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)     at
 dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:36:20.707

您的图像占用了太多内存，我遇到了同样的问题，为我解决的问题是按照此处找到的指南进行操作：

[http://developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)

它包含 4 个关于如何在不耗尽内存的情况下以最佳方式显示位图的教程。这可能有点令人困惑，但它确实很好用。

另一方面，如果你想要一个快捷方式，你总是可以在 GIMP 或其他东西中手动缩小图像。尽管如果用户将为您的应用选择自己的图片，这并不能解决长期问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T09:21:53.793

使用可以肯定工作的较低分辨率的图像......例如图像尺寸
`width=320` by `height=320`或 `width=200` by `height=200`

# iphone - 在 App Store 中更改开发者名称

> ID：12623879
> 
> 赞同：3
> 
> 时间：2012-09-27T14:36:57.777
> 
> 标签：iphone, ios, app-store, provisioning-profile, ios-provisioning

假设我的公司设法在 App Store 的开发者帐户中更改了开发者名称。在这种情况下，现有应用程序会发生什么：

1.  现有的应用程序会在 App Store 中愉快地保留下来而没有任何影响吗？
2.  我需要从开发者门户获取新证书吗？
3.  如果是，我是否需要向 App Store 提交我的应用程序的新版本？
4.  如果是，我的后续版本的捆绑标识符会有所不同吗？
5.  如果是，那么用户将如何获得应用程序的更新？

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:22:06.510

[我在这里](https://stackoverflow.com/questions/8050136/app-store-developer-renaming)问过，我们进行了重命名。我们的应用程序都没有被强制重新提交。我们使用了所有旧名称的证书，并且效果很好。我无法提供有关我们发送给 Apple 的法律信息的信息（不是编码人员这样做的），但有一天我们刚刚在 App Store 中看到另一个公司名称，我们对我们的应用程序没有做任何事情。

# wpf - 实现基于多选树视图的文件资源管理器

> ID：12623884
> 
> 赞同：1
> 
> 时间：2012-09-27T14:37:07.113
> 
> 标签：wpf, file, treeview, explorer

我是初学者 WPF。我在工作中开发了一个新项目，我需要插入一个具有多项选择的文件资源管理器控件。

该概念需要类似于 acronis 文件资源管理器：（带有复选框的 Treeview）

![查看示例](../Images/65d4a4e9ac44579dfc519b8d2412ad8f.png)

看看左边的容器，我需要实现类似的东西，我通过谷歌搜索了很多，我看到了很多实现，但没有什么与这个不相似。

因为我在 WPF 方面没有太多经验，所以我很难开始。

你有一些技巧或类似的项目可以帮助我吗？

我的项目基于 MVVM DP。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-27T15:41:04.080

重塑 Treeview 非常简单，您可以从要绑定的集合开始，即

```
<Grid>
  <TreeView ItemsSource="{Binding Folders}"/>
</Grid> 
```

但是，您随后需要定义如何显示已绑定的数据。我假设您的项目只是 FolderViewModels 和 FileViewModels（都具有 Name 属性）的 IEnumerable（任何列表或数组），所以现在我们需要说明如何显示它们。你可以通过定义一个 DataTemplate 来做到这一点，因为这是一棵树，我们使用一个 HeirarchicalDataTemplate 因为它也定义了 subItems

```
<Grid.Resources>
  <HierarchicalDataTemplate DataType="{x:Type viewModel:FolderViewModel}"
                              ItemsSource="{Binding SubFoldersAndFiles}">
        <CheckBox Content="{Binding Name}"/>
  </HierarchicalDataTemplate>
<Grid.Resources/> 
```

文件相同但不需要子项

```
<HierarchicalDataTemplate DataType="{x:Type viewModel:FolderViewModel}">
   <CheckBox Content="{Binding Name}"/>
</HierarchicalDataTemplate> 
```

所以把它们放在一起你会得到

```
<Grid>
    <Grid.Resources>
        <HierarchicalDataTemplate DataType="{x:Type viewModel:FolderViewModel}"
                              ItemsSource="{Binding SubFoldersAndFiles}">
            <CheckBox Content="{Binding Name}"/>
       </HierarchicalDataTemplate>
       <HierarchicalDataTemplate DataType="{x:Type viewModel:FolderViewModel}">
            <CheckBox Content="{Binding Name}"/>
      </HierarchicalDataTemplate>
    <Grid.Resources/>
    <TreeView ItemsSource="{Binding Folders}"/>
</Grid> 
```

**图标** 如果要显示图标，则更改 CheckBox 中的内容，我假设您将在 ViewModel 上定义图像。

```
 <CheckBox>
            <CheckBox.Content>
                <StackPanel Orientation="Horizontal">
                    <Image Source="{Binding Image}"/>
                    <TextBlock Text="{Binding Name}"/>
                </StackPanel>
            </CheckBox.Content> 
```

**选择**

最后，您必须处理项目的选择。我建议将 IsSelected 属性添加到您的 FileViewModel 和 FolderViewModels。对于文件来说，这非常简单，它只是一个布尔值。

```
 public class FileViewModel : INotifyProperty
   ...
   public bool IsSelected //Something here to handle get/set and NotifyPropertyChanged that depends on your MVVM framework, I use ReactiveUI a lot so that's this syntax
   { 
      get { return _IsSelected;}
      set { this.RaiseAndSetIfChanged(x=>x.IsSelected, value); }
   } 
```

和

```
<CheckBox IsChecked="{Binding IsSelected}"> 
```

FolderViewModel 稍微复杂一些，我稍后会看一下逻辑。首先是 Xaml，只需将当前 CheckBox 声明替换为

```
<CheckBox IsThreeState="True" IsChecked="{Binding IsSelected}">
    <!--IsChecked = True, False or null--> 
```

所以现在我们需要返回一组`Nullable<bool>`(aka `bool?`)。

```
public bool? IsSelected
{
   get
   { 
      if (SubFoldersAndFiles.All(x=>x.IsSelected) return true;
      if (SubFoldersAndFiles.All(x=>x.IsSelected==false) return false;
      return null;
   }
   set
   {
      // We can't set to indeterminate at folder level so we have to set to 
      // set to oposite of what we have now
      if(value == null)
         value = !IsSelected;

      foreach(var x in SubFoldersAndFiles)
          x.IsSelected = value;
   } 
```

或者非常相似的东西...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-17T08:06:19.183

在查看@AlSki 的答案后，我认为它既不直观也不够通用，不适合我的喜好，于是我想出了自己的解决方案。然而，使用我的解决方案的缺点是它需要更多样板。另一方面，它提供了更多的灵活性。

下面的示例假定您使用 .NET 4.6.1 和 C# 6.0。

```
/// <summary>
/// A base for abstract objects (implements INotifyPropertyChanged).
/// </summary>
[Serializable]
public abstract class AbstractObject : INotifyPropertyChanged
{
    /// <summary>
    /// 
    /// </summary>
    [field: NonSerialized()]
    public event PropertyChangedEventHandler PropertyChanged;

    /// <summary>
    /// 
    /// </summary>
    /// <param name="propertyName"></param>
    public void OnPropertyChanged(string propertyName)
    {
        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
    }

    /// <summary>
    /// 
    /// </summary>
    /// <typeparam name="TKind"></typeparam>
    /// <param name="Source"></param>
    /// <param name="NewValue"></param>
    /// <param name="Names"></param>
    protected virtual bool SetValue<TKind>(ref TKind Source, TKind NewValue, params string[] Notify)
    {
        //Set value if the new value is different from the old
        if (!Source.Equals(NewValue))
        {
            Source = NewValue;

            //Notify all applicable properties
            Notify?.ForEach(i => OnPropertyChanged(i));

            return true;
        }

        return false;
    }

    /// <summary>
    /// 
    /// </summary>
    public AbstractObject()
    {
    }
} 
```

具有检查状态的对象。

```
/// <summary>
/// Specifies an object with a checked state.
/// </summary>
public interface ICheckable
{
    /// <summary>
    /// 
    /// </summary>
    bool? IsChecked
    {
        get; set;
    }
}

/// <summary>
/// 
/// </summary>
public class CheckableObject : AbstractObject, ICheckable
{
    /// <summary>
    /// 
    /// </summary>
    [field: NonSerialized()]
    public event EventHandler<EventArgs> Checked;

    /// <summary>
    /// 
    /// </summary>
    [field: NonSerialized()]
    public event EventHandler<EventArgs> Unchecked;

    /// <summary>
    /// 
    /// </summary>
    [XmlIgnore]
    protected bool? isChecked;
    /// <summary>
    /// 
    /// </summary>
    public virtual bool? IsChecked
    {
        get
        {
            return isChecked;
        }
        set
        {
            if (SetValue(ref isChecked, value, "IsChecked") && value != null)
            {
                if (value.Value)
                {
                    OnChecked();
                }
                else OnUnchecked();
            }
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <returns></returns>
    public override string ToString()
    {
        return base.ToString();
        //return isChecked.ToString();
    }

    /// <summary>
    /// 
    /// </summary>
    protected virtual void OnChecked()
    {
        Checked?.Invoke(this, new EventArgs());
    }

    /// <summary>
    /// 
    /// </summary>
    protected virtual void OnUnchecked()
    {
        Unchecked?.Invoke(this, new EventArgs());
    }

    /// <summary>
    /// 
    /// </summary>
    public CheckableObject() : base()
    {
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="isChecked"></param>
    public CheckableObject(bool isChecked = false)
    {
        IsChecked = isChecked;
    }
} 
```

检查系统对象的视图模型：

```
/// <summary>
/// 
/// </summary>
public class CheckableSystemObject : CheckableObject
{
    #region Properties

    /// <summary>
    /// 
    /// </summary>
    public event EventHandler Collapsed;

    /// <summary>
    /// 
    /// </summary>
    public event EventHandler Expanded;

    bool StateChangeHandled = false;

    CheckableSystemObject Parent { get; set; } = default(CheckableSystemObject);

    ISystemProvider SystemProvider { get; set; } = default(ISystemProvider);

    ConcurrentCollection<CheckableSystemObject> children = new ConcurrentCollection<CheckableSystemObject>();
    /// <summary>
    /// 
    /// </summary>
    public ConcurrentCollection<CheckableSystemObject> Children
    {
        get
        {
            return children;
        }
        private set
        {
            SetValue(ref children, value, "Children");
        }
    }

    bool isExpanded = false;
    /// <summary>
    /// 
    /// </summary>
    public bool IsExpanded
    {
        get
        {
            return isExpanded;
        }
        set
        {
            if (SetValue(ref isExpanded, value, "IsExpanded"))
            {
                if (value)
                {
                    OnExpanded();
                }
                else OnCollapsed();
            }
        }
    }

    bool isSelected = false;
    /// <summary>
    /// 
    /// </summary>
    public bool IsSelected
    {
        get
        {
            return isSelected;
        }
        set
        {
            SetValue(ref isSelected, value, "IsSelected");
        }
    }

    string path = string.Empty;
    /// <summary>
    /// 
    /// </summary>
    public string Path
    {
        get
        {
            return path;
        }
        set
        {
            SetValue(ref path, value, "Path");
        }
    }

    bool queryOnExpanded = false;
    /// <summary>
    /// 
    /// </summary>
    public bool QueryOnExpanded
    {
        get
        {
            return queryOnExpanded;
        }
        set
        {
            SetValue(ref queryOnExpanded, value);
        }
    }

    /// <summary>
    /// 
    /// </summary>
    public override bool? IsChecked
    {
        get
        {
            return isChecked;
        }
        set
        {
            if (SetValue(ref isChecked, value, "IsChecked") && value != null)
            {
                if (value.Value)
                {
                    OnChecked();
                }
                else OnUnchecked();
            }
        }
    }

    #endregion

    #region CheckableSystemObject

    /// <summary>
    /// 
    /// </summary>
    /// <param name="path"></param>
    /// <param name="systemProvider"></param>
    /// <param name="isChecked"></param>
    public CheckableSystemObject(string path, ISystemProvider systemProvider, bool? isChecked = false) : base()
    {
        Path = path;
        SystemProvider = systemProvider;
        IsChecked = isChecked;
    }

    #endregion

    #region Methods

    void Determine()
    {
        //If it has a parent, determine it's state by enumerating all children, but current instance, which is already accounted for.
        if (Parent != null)
        {
            StateChangeHandled = true;
            var p = Parent;
            while (p != null)
            {
                p.IsChecked = Determine(p);
                p = p.Parent;
            }
            StateChangeHandled = false;
        }
    }

    bool? Determine(CheckableSystemObject Root)
    {
        //Whether or not all children and all children's children have the same value
        var Uniform = true;

        //If uniform, the value
        var Result = default(bool?);

        var j = false;
        foreach (var i in Root.Children)
        {
            //Get first child's state
            if (j == false)
            {
                Result = i.IsChecked;
                j = true;
            }
            //If the previous child's state is not equal to the current child's state, it is not uniform and we are done!
            else if (Result != i.IsChecked)
            {
                Uniform = false;
                break;
            }
        }

        return !Uniform ? null : Result;
    }

    void Query(ISystemProvider SystemProvider)
    {
        children.Clear();
        if (SystemProvider != null)
        {
            foreach (var i in SystemProvider.Query(path))
            {
                children.Add(new CheckableSystemObject(i, SystemProvider, isChecked)
                {
                    Parent = this
                });
            }
        }
    }

    /// <summary>
    /// 
    /// </summary>
    protected override void OnChecked()
    {
        base.OnChecked();

        if (!StateChangeHandled)
        {
            //By checking the root only, all children are checked automatically
            foreach (var i in children)
                i.IsChecked = true;

            Determine();
        }
    }

    /// <summary>
    /// 
    /// </summary>
    protected override void OnUnchecked()
    {
        base.OnUnchecked();

        if (!StateChangeHandled)
        {
            //By unchecking the root only, all children are unchecked automatically
            foreach (var i in children)
                i.IsChecked = false;

            Determine();
        }
    }

    /// <summary>
    /// 
    /// </summary>
    protected virtual void OnCollapsed()
    {
        Collapsed?.Invoke(this, new EventArgs());
    }

    /// <summary>
    /// 
    /// </summary>
    protected virtual void OnExpanded()
    {
        Expanded?.Invoke(this, new EventArgs());

        if (!children.Any<CheckableSystemObject>() || queryOnExpanded)
            BeginQuery(SystemProvider);
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="SystemProvider"></param>
    public async void BeginQuery(ISystemProvider SystemProvider)
    {
        await Task.Run(() => Query(SystemProvider));
    }

    #endregion
} 
```

用于查询系统对象的实用程序；注意，通过定义自己的`SystemProvider`，您可以查询不同类型的系统（即本地或远程）。默认情况下，会查询您的本地系统。如果要显示来自远程服务器（如 FTP）的对象，则需要定义一个`SystemProvider`使用适当 Web 协议的对象。

```
/// <summary>
/// Specifies an object capable of querying system objects.
/// </summary>
public interface ISystemProvider
{
    /// <summary>
    /// 
    /// </summary>
    /// <param name="Path">The path to query.</param>
    /// <param name="Source">A source used to make queries.</param>
    /// <returns>A list of system object paths.</returns>
    IEnumerable<string> Query(string Path, object Source = null);
}

/// <summary>
/// Defines base functionality for an <see cref="ISystemProvider"/>.
/// </summary>
public abstract class SystemProvider : ISystemProvider
{
    /// <summary>
    /// 
    /// </summary>
    /// <param name="Path"></param>
    /// <param name="Source"></param>
    /// <returns></returns>
    public abstract IEnumerable<string> Query(string Path, object Source = null);
}

/// <summary>
/// Defines functionality to query a local system.
/// </summary>
public class LocalSystemProvider : SystemProvider
{
    /// <summary>
    /// 
    /// </summary>
    /// <param name="Path"></param>
    /// <param name="Source"></param>
    /// <returns></returns>
    public override IEnumerable<string> Query(string Path, object Source = null)
    {
        if (Path.IsNullOrEmpty())
        {
            foreach (var i in System.IO.DriveInfo.GetDrives())
                yield return i.Name;
        }
        else
        {
            if (System.IO.Directory.Exists(Path))
            {
                foreach (var i in System.IO.Directory.EnumerateFileSystemEntries(Path))
                    yield return i;
            }
        }
    }
} 
```

然后是一个继承的`TreeView`，它将所有这些放在一起：

```
/// <summary>
/// 
/// </summary>
public class SystemObjectPicker : TreeViewExt
{
    #region Properties

    /// <summary>
    /// 
    /// </summary>
    public static DependencyProperty QueryOnExpandedProperty = DependencyProperty.Register("QueryOnExpanded", typeof(bool), typeof(SystemObjectPicker), new FrameworkPropertyMetadata(false, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, OnQueryOnExpandedChanged));
    /// <summary>
    /// 
    /// </summary>
    public bool QueryOnExpanded
    {
        get
        {
            return (bool)GetValue(QueryOnExpandedProperty);
        }
        set
        {
            SetValue(QueryOnExpandedProperty, value);
        }
    }
    static void OnQueryOnExpandedChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        d.As<SystemObjectPicker>().OnQueryOnExpandedChanged((bool)e.NewValue);
    }

    /// <summary>
    /// 
    /// </summary>
    public static DependencyProperty RootProperty = DependencyProperty.Register("Root", typeof(string), typeof(SystemObjectPicker), new FrameworkPropertyMetadata(string.Empty, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, OnRootChanged));
    /// <summary>
    /// 
    /// </summary>
    public string Root
    {
        get
        {
            return (string)GetValue(RootProperty);
        }
        set
        {
            SetValue(RootProperty, value);
        }
    }
    static void OnRootChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        d.As<SystemObjectPicker>().OnRootChanged((string)e.NewValue);
    }

    /// <summary>
    /// 
    /// </summary>
    static DependencyProperty SystemObjectsProperty = DependencyProperty.Register("SystemObjects", typeof(ConcurrentCollection<CheckableSystemObject>), typeof(SystemObjectPicker), new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault));
    /// <summary>
    /// 
    /// </summary>
    ConcurrentCollection<CheckableSystemObject> SystemObjects
    {
        get
        {
            return (ConcurrentCollection<CheckableSystemObject>)GetValue(SystemObjectsProperty);
        }
        set
        {
            SetValue(SystemObjectsProperty, value);
        }
    }

    /// <summary>
    /// 
    /// </summary>
    public static DependencyProperty SystemProviderProperty = DependencyProperty.Register("SystemProvider", typeof(ISystemProvider), typeof(SystemObjectPicker), new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, OnSystemProviderChanged));
    /// <summary>
    /// 
    /// </summary>
    public ISystemProvider SystemProvider
    {
        get
        {
            return (ISystemProvider)GetValue(SystemProviderProperty);
        }
        set
        {
            SetValue(SystemProviderProperty, value);
        }
    }
    static void OnSystemProviderChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        d.As<SystemObjectPicker>().OnSystemProviderChanged((ISystemProvider)e.NewValue);
    }

    #endregion

    #region SystemObjectPicker

    /// <summary>
    /// 
    /// </summary>
    public SystemObjectPicker() : base()
    {
        SetCurrentValue(SystemObjectsProperty, new ConcurrentCollection<CheckableSystemObject>());
        SetCurrentValue(SystemProviderProperty, new LocalSystemProvider());

        SetBinding(ItemsSourceProperty, new Binding()
        {
            Mode = BindingMode.OneWay,
            Path = new PropertyPath("SystemObjects"),
            Source = this
        });
    }

    #endregion

    #region Methods

    void OnQueryOnExpandedChanged(CheckableSystemObject Item, bool Value)
    {
        foreach (var i in Item.Children)
        {
            i.QueryOnExpanded = Value;
            OnQueryOnExpandedChanged(i, Value);
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="Value"></param>
    protected virtual void OnQueryOnExpandedChanged(bool Value)
    {
        foreach (var i in SystemObjects)
            OnQueryOnExpandedChanged(i, Value);
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="Provider"></param>
    /// <param name="Root"></param>
    protected virtual void OnRefreshed(ISystemProvider Provider, string Root)
    {
        SystemObjects.Clear();
        if (Provider != null)
        {
            foreach (var i in Provider.Query(Root))
            {
                SystemObjects.Add(new CheckableSystemObject(i, SystemProvider)
                {
                    QueryOnExpanded = QueryOnExpanded
                });
            }
        }
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="Value"></param>
    protected virtual void OnRootChanged(string Value)
    {
        OnRefreshed(SystemProvider, Value);
    }

    /// <summary>
    /// 
    /// </summary>
    /// <param name="Value"></param>
    protected virtual void OnSystemProviderChanged(ISystemProvider Value)
    {
        OnRefreshed(Value, Root);
    }

    #endregion
} 
```

显然，它比@AlSki 的答案要复杂得多，但是，您再次获得了更大的灵活性，并且已经为您处理了困难的事情。

另外，如果你对这样的事情感兴趣，我已经在[我的开源项目（3.1）的最新版本中发布了这段代码；](https://github.com/imagin-tech/Imagin.NET)如果没有，上面的示例就是让它工作所需的全部内容。

如果您不下载该项目，请注意以下事项：

*   您会发现一些不存在的扩展方法，可以用它们的对应物来补充（例如，`IsNullOrEmpty`扩展与 相同`string.IsNullOrEmpty()`）。
*   `TreeViewExt`是`TreeView`我设计的自定义，所以如果您不关心，只需更改`TreeViewExt`为`TreeView`; 无论哪种方式，您都不必为它定义一个特殊的控制模板，因为它是为与`TreeView`的现有设施一起工作而设计的。
*   在示例中，我使用了我自己的并发版本`ObservableCollection`；这样您就可以在后台线程上查询数据而无需费力。将其更改为`ObservableCollection`并使所有查询同步或使用您自己的并发`ObservableCollection`来保留异步功能。

最后，这里是你将如何使用控件：

```
<Controls.Extended:SystemObjectPicker>
    <Controls.Extended:SystemObjectPicker.ItemContainerStyle>
        <Style TargetType="TreeViewItem" BasedOn="{StaticResource {x:Type TreeViewItem}}">
            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        </Style>
    </Controls.Extended:SystemObjectPicker.ItemContainerStyle>
    <Controls.Extended:SystemObjectPicker.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding Children, Mode=OneWay}">
            <StackPanel Orientation="Horizontal">
                <CheckBox
                    IsChecked="{Binding IsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    Margin="0,0,5,0"/>
                <TextBlock 
                    Text="{Binding Path, Converter={StaticResource FileNameConverter}, Mode=OneWay}"/>
            </StackPanel>
        </HierarchicalDataTemplate>
    </Controls.Extended:SystemObjectPicker.ItemTemplate>
</Controls.Extended:SystemObjectPicker> 
```

**去做**

*   添加一个属性以`CheckableSystemObject`公开系统对象的视图模型；这样，您可以访问与其路径关联的`FileInfo`/`DirectoryInfo`或其他描述它的数据源。如果对象是远程的，您可能已经定义了自己的类来描述它，如果您有对它的引用，这可能很有用。
*   在查询本地系统时捕获可能的异常；如果无法访问系统对象，它将失败。`LocalSystemProvider`也无法解决超过 260 个字符的系统路径；但是，这超出了本项目的范围。

**版主须知**

为方便起见，我引用了自己的开源项目，因为我在最新版本中发布了上述示例；我的目的不是自我推销，所以如果不赞成引用您自己的项目，我将继续删除链接。

# symfony - 学习 Symfony2，使用资产有问题

> ID：12623885
> 
> 赞同：0
> 
> 时间：2012-09-27T14:37:11.377
> 
> 标签：symfony, twig, assets, symfony-2.1

我正在使用 KnPUniversity 关于 Symfony2 入门的视频教程，除了视频是基于 2.0.3 版的教学并且我使用的是 2.1.x-dev 之外，一切都进展顺利。当我到达视频中的某个点时，它会指示我编写代码块 #1，然后对其进行修改以更有效地使用代码块 #2，但代码块 #2 不起作用。它不会抛出任何错误，只是无法实际检测到样式表。在页面的源代码中，使用代码块 #2 对任何 CSS 样式表的引用为零。知道我做错了什么吗？

```
{# this causes the page to be styled and works fine #}
{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('bundles/event/css/event.css') }}">
<link rel="stylesheet" href="{{ asset('bundles/event/css/events.css') }}">
<link rel="stylesheet" href="{{ asset('bundles/event/css/main.css') }}">
{% endblock %} 
```

.

```
{# this causes the page to be unstyled. Missing stylesheet links in page source #}
{% block stylesheets %}
{% stylesheets
    'bundes/event/css/*'
    filter='cssrewrite'
%}
<link rel="stylesheet" href="{{ asset_url }}">
{% endstylesheets %}
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:08:48.453

好吧，我有一个错字。这不是“捆绑”，而是“捆绑”。问题解决了，我是个白痴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:54:48.943

当您使用 {{asset() }} 时，它会创建一个指向您的网络（公共）目录的链接。

但是对于第二部分，Assetic 管理 css 文件 - 因此它会在您的应用程序中查找该文件，然后将其写入您的 Web 目录。

要解决您的问题，您可以像这样更改样式表：

```
{% stylesheets
    '%kernel.root_dir%/../web/bundes/event/css/*'
    filter='cssrewrite'
%} 
```

但我建议阅读更多关于assetic的内容，以了解你应该如何管理你的css文件[Symfony 2 Assetic](http://symfony.com/doc/current/cookbook/assetic/asset_management.html)

# dos - Windows 命令提示符 (Dos) 复制所有以指定文件名开头的文件

> ID：12623888
> 
> 赞同：-1
> 
> 时间：2012-09-27T14:37:19.030
> 
> 标签：dos, command-prompt

如果您在 Dos 中键入

```
copy c:\a.txt 
```

它将复制 a.txt*（a.txt1、a.txtb 等）

我怎样才能复制a.txt？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T22:33:07.583

您的问题不正确 -`copy c:\a.txt`只会将单个文件复制到当前目录。它将忽略其他文件，如`a.txt1`和`a.txtb`。

您一定已经尝试过`copy c:\*.txt`- 这将复制所有表单，因为模式匹配搜索长名称和短名称 (8.3)。

您可以使用 FINDSTR 消除该问题：

```
for /f "eol=: delims=" %F in ('dir /b /a-d c:\*.txt^|findstr /eli ".txt"') do @copy "c:\%F" 
```

# android - SQLite 数据库不起作用

> ID：12623891
> 
> 赞同：0
> 
> 时间：2012-09-27T14:37:30.003
> 
> 标签：android, sqlite

看来我无法将数据插入我的数据库，我不知道问题出在哪里。这是数据库代码：

```
public class Database {
    public static final String KEY_ROWID = "_id";
    public static final String KEY_NAME = "Name";
    public static final String KEY_PERIOD = "Period";
    public static final String KEY_FREQUENCY = "Frequency";
    public static final String KEY_RECIEVINGTIME = "Recieving_time";
    public static final String KEY_STATS = "Stats";

    private static final String DATABASE_NAME = "Reports";
    private static final String DATABASE_TABLE = "Table1";
    private static final int DATABASE_VERSION = 1;

    private DbHelper myHelper;
    private final Context myContext;
    private SQLiteDatabase myDatabase;

    private static class DbHelper extends SQLiteOpenHelper{

        public DbHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
            // TODO Auto-generated constructor stub
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            // TODO Auto-generated method stub
            db.execSQL("CREATE TABLE " + DATABASE_TABLE + " (" +
                    KEY_ROWID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
                    KEY_NAME + " TEXT NOT NULL, " +
                    KEY_PERIOD + " TEXT NOT NULL, " +
                    KEY_FREQUENCY + " TEXT NOT NULL, " +
                    KEY_RECIEVINGTIME + " TEXT NOT NULL, " +
                    KEY_STATS + " TEXT NOT NULL);"
                    );
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
            onCreate(db);
        }
    }

    public Database(Context c){
        myContext = c;
    } 

    public Database open(){
        myHelper = new DbHelper(myContext);
        myDatabase = myHelper.getWritableDatabase();
        return this;
    }

    public void close(){
        myDatabase.close();
    }

    public void writeEntry(String name, long period, long frequency, long recievingTime, String stats){
        ContentValues cv = new ContentValues();
        cv.put(KEY_NAME, name);
        cv.put(KEY_PERIOD, period);
        cv.put(KEY_FREQUENCY, frequency);
        cv.put(KEY_RECIEVINGTIME, recievingTime);
        cv.put(KEY_STATS, stats);
        myDatabase.insert(DATABASE_TABLE, null, cv);
    }

    public Cursor query(String[] columns, String selection, String[] selectionArgs, String groupBy) {
        // TODO Auto-generated method stub
        Cursor c = myDatabase.query(DATABASE_TABLE, columns, selection, selectionArgs, groupBy, null, null);
        return c;
    }   
} 
```

我尝试使用这种方法插入数据：

```
public void save(){
    sharedPrefs = context.getSharedPreferences(SPNAME, 0);
    Log.v(" info", sharedPrefs.getAll().toString());
    Database database = new Database(context);
    database.open();
    database.writeEntry(
            sharedPrefs.getString(NAME, "No data was found"), 
            sharedPrefs.getLong(PERIOD, 0),
            sharedPrefs.getLong(FREQUENCY, 0), 
            sharedPrefs.getLong(RECIEVINGTIME, 0), 
            sharedPrefs.getString(STATS, "No data was found")
            );
    database.close();

    editor.remove(NAME);
    editor.remove(FREQUENCY);
    editor.remove(RECIEVINGTIME);
    editor.remove(PERIOD);
    editor.remove(FREQUENCY);
    editor.remove(STATS);
    editor.commit();
} 
```

我用这种方法检索数据：

```
 public ReportItem getReportInfo(String rowId){
    ReportItem item = new ReportItem();
    database = new Database(context);
    database.open();
    cursor = database.query(new String[]{
            Database.KEY_NAME,
            Database.KEY_PERIOD,
            Database.KEY_FREQUENCY,
            Database.KEY_RECIEVINGTIME,
            Database.KEY_STATS}, Database.KEY_ROWID +" = "+rowId, null, null);

    if(cursor.moveToFirst()){
        item.setName(cursor.getString(cursor.getColumnIndex(Database.KEY_NAME)));
        item.setPeriod(cursor.getLong(cursor.getColumnIndex(Database.KEY_PERIOD)));
        item.setFrequency(cursor.getLong(cursor.getColumnIndex(Database.KEY_FREQUENCY)));
        item.setReceivingTime(cursor.getLong(cursor.getColumnIndex(Database.KEY_RECIEVINGTIME)));
        item.setStats(cursor.getString(cursor.getColumnIndex(Database.KEY_STATS)));         
    }
    cursor.close(); 
    database.close();   
    Log.v("Data from database", item.toString());
    return item;
} 
```

在将数据插入数据库日志之前的 save() 方法中显示：

```
09-27 17:19:54.973: V/info(31638): <!>com.dailyreports.ainius.Report 75<!> {Period=86400000, Name=report1, Stats=23 24 26 , Frequency=86400000, RecievingTime=62340000} 
```

但是在从数据库日志中检索相同信息后的 getReportInfo(String) 方法中显示：

```
09-27 17:20:06.263: V/Data from database(31638): <!>com.dailyreports.ainius.Report 117<!>  0 0 0 
```

有什么建议么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T16:28:07.183

您没有匹配的条目`rowId`：

```
Database.KEY_ROWID +" = "+rowId 
```

所以在`getReportInfo()`：

1.  `if(cursor.moveToFirst())`返回假，
2.  ReportItem`item`没有收到新值，
3.  `item`返回默认值：空字符串和`0l`长整数。

仔细检查您的值`rowId`。

# mysql - SQL - 删除中间的数值时。如何将所有数字更改为有序？

> ID：12623893
> 
> 赞同：1
> 
> 时间：2012-09-27T14:37:36.140
> 
> 标签：mysql, sql, database, workbench

例子：

有 3 个不同的数值：

1 2 3

我删除了 2，留下 1 和 3。如何更改数字以使 3 变为 2？

1 3 -> 1 2

请记住，我有很多数字，所以我想一次全部更改，而不是一一更改。那会花很多时间。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:40:25.140

如果它们是简单的位置代码并且你想要你可以做

```
delete from mytable where position=2
update mytable set position=position-1 where position>2 
```

如果它们是某些东西的 id，那么这会很糟糕，因为您将对可能相关的表进行大量更新。

# c# - 在 html 文本框 mvc 中使用短日期字符串

> ID：12623895
> 
> 赞同：2
> 
> 时间：2012-09-27T14:37:38.813
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我有一个模型如下，我正在使用 Linq to SQL

```
public class CustomerDetails
    {
        public Customer customer { get; set; }

    } 
```

“客户”由数据库中的单个客户填充。客户有一个字段“NextEmailDate”。我想将它绑定到一个文本框，但只显示日期而不是时间

```
@Html.TextBoxFor(m=> m.Customer.NextEmailDate) 
```

但是我得到了一个文本框，其中包含文本 16/09/2012 00:00:00 我如何使这只是 2012 年 9 月 16 日？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T14:55:29.017

假设`Customer`是您的实际实体，请引入视图模型并将其传递给您的视图。这样你就可以用你需要的所有格式/验证属性来装饰它，例如

```
public class CustomerViewModel
{
    [Required(ErrorMessage = "Next email date is required!")]
    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:dd/MM/yyyy}"]
    public DateTime NextEmailDate { get; set; }
    ...
}

public class CustomerDetails
{
    public CustomerViewModel Customer { get; set; }
} 
```

您可以手动映射属性或使用[AutoMapper](https://github.com/AutoMapper/AutoMapper)之类的库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T14:39:33.563

如果`NextEmailDate`是`DateTime`，您可以使用`NextEmailDate.ToShortDateString()`. 如果 is not 不是 a `DateTime`，你必须告诉我它是什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T14:39:43.830

将此注释添加到`NextEmailDate`属性。

```
[DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:dd/MM/yyyy}")] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-27T14:40:39.893

```
<%= Html.TextBoxFor(m => m.Customer.NextEmailDate, new { @Value = m.Customer.NextEmailDate.ToString("dd/MM/yyyy") })%> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-27T16:32:34.543

我知道 mvc 3 已标记，但 mvc 4 有 Html.TextBox 的附加参数“格式”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T14:39:26.187

```
@Html.TextBoxFor(m=> m.Customer.NextEmailDate.ToString("dd/MM/yyyy")) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-22T13:14:37.163

```
@Html.TextBoxFor(p => p.DataFim,"{0:d}", new { @class = " datepicker form-control" }) 
```

# android - Android 自定义 ListAdapter - 更改字体

> ID：12623896
> 
> 赞同：0
> 
> 时间：2012-09-27T14:37:39.343
> 
> 标签：android

我的 ListAdapter 有问题。

我这样创建它：

```
 public class MyAdapter extends BaseAdapter {

    private List<Object> objects;
    private final Context   context;

    public MyAdapter (Context context, List<Object> objects) {
        this.context = context;
        this.objects = objects;
    }

    public int getCount() {
        return objects.size();
    }

    public Object getItem(int position) {
        return objects.get(position);
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

       Object obj = objects.get(position);

       tvRow = (TextView)findViewById(R.id.tvRow);
       tvRow.setText(obj.toString());

       Typeface typeface = Typeface.createFromAsset(getAssets(), "Fonts/DS-DIGIT.TTF");
           tvRow.setTypeface(typeface);
           return tvRow;
            }
    } 
```

在使用我的 custom 之前`ListAdapter`，我是这样使用它的：

```
private ArrayAdapter<String> m_lapList;
setListAdapter(new ArrayAdapter<String>(this, R.layout.laps_row));
m_lapList = (ArrayAdapter<String>)getListAdapter(); 
```

如何使用我的新 ListAdapter？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:45:42.760

要使用您提供的代码作为示例，它应该如下所示：

```
private MyAdapter m_lapList;
setListAdapter(new MyAdapter(this, new ArrayList<Object>()));
m_lapList = (MyAdapter)getListAdapter(); 
```

# ruby - 机械化登录oracle账户

> ID：12623901
> 
> 赞同：1
> 
> 时间：2012-09-27T14:37:50.363
> 
> 标签：ruby, mechanize

我正在尝试创建一个 ruby​​ 工具，该工具使用 mechanize 将我登录到我的 oracle 帐户并显示以下主站点。

```
#!/usr/bin/ruby
require 'rubygems'
require 'open-uri'
require 'mechanize' 
require 'nokogiri'

agent = Mechanize.new
login_form = agent.get("https://login.oracle.com/mysso/signon.jsp").form("LoginForm")
login_form.request_id = 'username'
login_form.locale = 'password'

page = agent.submit(login_form, login_form.buttons.first)
page.body.match /content="1;URL=(.*?)"/
nexturl = $1
newpage = agent.get nexturl
puts newpage.body 
```

目前我可以加载下一页，但我只收到登录失败的消息（“系统错误。请重试您的操作。”）。也许问题是登录站点是 https:// 站点？

我发现问题在于 Mechanize 甚至没有获得所需的登录字段：

```
<form method="post" action="/oam/server/sso/auth_cred_submit" name="LoginForm"         autocomplete="off">
<input type="hidden" name="v" value="v1.4">
<input type="hidden" name="request_id" value="">
<input type="hidden" name="locale" value="">
<span id="errormsg" class="error-show">
Error! Do not use bookmarked URL.<br>Please type the URL you are trying to reach directly into your browser.
</span>
</form> 
```

如果我卷曲网站，我会收到这些错误，并且必填字段甚至不在收到的表单中。我需要登录的字段从错误消息所在的位置开始......

谢谢你的帮助

# ruby - 使用 Nokogiri在随机选择的标签之间选择所有 标签

> ID：12623902
> 
> 赞同：2
> 
> 时间：2012-09-27T14:37:52.167
> 
> 标签：ruby, xpath, nokogiri

我正在尝试使用 Nokogiri 和 Ruby 解析一些 HTML，但在做我想做的事情时遇到了一些障碍。我的示例文件如下所示：

```
<div id="main-body">
  <p>
    <span>First Text</span>
    <span>Second Text</span>
    <span>Third Text</span>
    <span>Fourth Text</span>
    <br>
    <span>Fifth Text</span>
    <span>Sixth Text</span>
    <span>Seventh Text</span>
    <br>
    <span>Eight Text</span>
    <span>Ninth Text</span>
    <br>
  </p>
</div 
```

我正在尝试找到一种方法来遍历并仅选择随机中断标记之间或第一次中断之前的文本。

基本上我想让我的输出每次都不同。所以示例输出将是例如

```
=>First Text
=>Second Text
=>Third Text
=>Fourth Text 
```

一次，然后，也许下一次它会在休息 2 和 3 之间得到东西

```
=>Eight Text
=>Ninth Text 
```

我在想，如果我可以计算 HTML 中的中断次数，我可以使用 rand() 随机选择一个并打印出文本，直到我点击下一个，但我不能完全正确地记下来。

到目前为止，我的代码是将整个页面加载到 Nokogiri 类型并尝试从那里解析。

```
doc = Nokogiri::HTML(open(targeturl))
puts doc.xpath("./br").length #gives me the count of break tags in the document 
```

从那里我实际上可以将中断分配给一个变量并一个一个地访问它们，但我不知道该去哪里，或者我什至从这里走在正确的轨道上，我觉得我只是对此感到困惑观点 ：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T00:58:40.033

另一个选项是 slice_before：

```
doc.search('p *').slice_before{|x| x.name == 'br'}.each do |slice|
  puts '*', slice.select{|x| x.name == 'span'}
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:54:17.170

`count()`您可以使用and来根据前面的 br 标签数量来抓取节点`preceding-sibling`。

```
puts doc.xpath("//span[count(preceding-sibling::br)=0]")
#=> <span>First Text</span>
#=> <span>Second Text</span>
#=> <span>Third Text</span>
#=> <span>Fourth Text</span>

puts doc.xpath("//span[count(preceding-sibling::br)=1]")
#=> <span>Fifth Text</span>
#=> <span>Sixth Text</span>
#=> <span>Seventh Text</span>

puts doc.xpath("//span[count(preceding-sibling::br)=2]")
#=> <span>Eight Text</span>
#=> <span>Ninth Text</span> 
```

要获得随机选择，只需随机化前兄弟的数量：

```
puts doc.xpath("//span[count(preceding-sibling::br)=#{rand(doc.xpath("//br").length)}]") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T17:30:34.227

**这是一个 XPath 单行表达式，它选择`$k`-th`br`之前但不选择`$k`-1th之前的所有文本节点`br`：**

```
/*/p/br[2]/preceding-sibling::*[count(preceding-sibling::br)=1]/text() 
```

因此，如果您`k`在区间中有一个随机数`[1, count(/*/p/br)]`，那么您只需将其替换为上述 Xpath 表达式并对其进行评估。

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output  method="text"/>

 <xsl:template match="/">
     <xsl:copy-of select=
     "/*/p/br[2]/preceding-sibling::*[count(preceding-sibling::br)=1]/text()
     "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<div id="main-body">
    <p>
        <span>First Text</span>
        <span>Second Text</span>
        <span>Third Text</span>
        <span>Fourth Text</span>
        <br/>
        <span>Fifth Text</span>
        <span>Sixth Text</span>
        <span>Seventh Text</span>
        <br/>
        <span>Eight Text</span>
        <span>Ninth Text</span>
        <br/>
    </p>
</div> 
```

**评估 XPath 表达式，并将此评估的结果（所有选定的文本节点）复制到输出**：

```
Fifth TextSixth TextSeventh Text 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T15:00:22.727

这是我的解决方案，如果你只想要 span 元素的内容（要获取整个节点，只需删除 map 操作）：

```
require 'nokogiri'

doc = Nokogiri::XML(File.read("test.xml"))

def get_spans(doc)
    br_list = doc.css("br")
    br = br_list[rand(br_list.size)]

    span_list = []
    span = br.previous_element

    while span && span.name == "span"
         span_list << span
         span = span.previous_element
    end

    span_list.reverse.map(&:content)
end

p get_spans(doc) 
```

# java - String.replaceAll() 问题

> ID：12623905
> 
> 赞同：2
> 
> 时间：2012-09-27T14:37:55.187
> 
> 标签：java, regex

我想替换所有完全匹配的

```
 fm.get('Order# 
```

在一个带有值的冗长字符串中

```
 fm.get('Order__' 
```

我使用的语法如下：

```
 String calcStr = "return fm.get('Order#');";
    String fname = "Order#";
    String validfName = "Order__";

    String modifiedCalc1 = calcStr.replaceAll("fm.get('"+fname+"\\b", "fm.get('"+validfName);
    System.out.println(modifiedCalc1); 
```

但我收到模式错误。

```
 Exception in thread "main" java.util.regex.PatternSyntaxException:
    Unclosed group near index 18
    \bfm.get('Order#\b
              ^
at java.util.regex.Pattern.error(Unknown Source)
at java.util.regex.Pattern.accept(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:38:43.860

您需要转义左括号和要点。

`\b`在这个特定案例的末尾也删除。

```
String modifiedCalc1 = calcStr.replaceAll("fm\\.get\\('"+fname, "fm.get('"+validfName); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:50:33.737

如果要使用需要正则表达式的 API 替换文字字符串，可以使用`Pattern.quote`(用于模式端) 和`Matcher.quoteReplacement`(用于替换端)：

```
calcStr.replaceAll(Pattern.quote("fm.get('Order#"),
                   Matcher.quoteReplacement("fm.get('Order__")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T15:09:30.217

在这种情况下，似乎真的不需要正则表达式功能。

因此可以使用更有效的普通字符串替换：

```
String modifiedCalc1 = calcStr.replace("fm.get('"+fname, "fm.get('"+validfName); 
```

# jsp - 未向 PropertyEditorManager 注册属性编辑器：自定义标记调用错误

> ID：12623908
> 
> 赞同：2
> 
> 时间：2012-09-27T14:38:02.423
> 
> 标签：jsp, jakarta-ee, jsp-tags

调用我的时出现以下错误`testtag.jsp`：

> org.apache.jasper.JasperException：无法将字符串“<c:out var='myvar'/>”转换为属性“att1”的类“javax.servlet.jsp.tagext.JspFragment”：属性编辑器未注册属性编辑器管理器

（详细的堆栈跟踪无关紧要）

我使用的是 J2EE 1.4 服务器（即 JSP 2.0）

我的`WEB-INF/testtag.tag`

```
<%@ tag body-content="scriptless" %>
<%@ tag description="Renders some test html" %>
<%@ attribute name="att1" fragment="true" required="true"  %>

<h1><jsp:invoke fragment="att1"/></h1> 
```

`testtag.jsp`使用这个标签的jsp ：

```
<%@page contentType ="text/html" pageEncoding="UTF-8" buffer="none" session="false" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="t" tagdir="/WEB-INF/tags" %>

<c:set var="myvar" value="hello world"/>
<t:testtag att1="<c:out var='myvar'/>" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:38:02.423

根据[JSP 2.0 规范](http://download.oracle.com/otndocs/jcp/jsp-2.0-fr-oth-JSpec/ "JSP 2.0 规范")的 JSP.7.1.6 （粗体强调我的），

> 在翻译阶段，页面的各个部分被翻译成`javax.servlet.jsp.tagext.JspFragment`抽象类的实现，然后传递给标记处理程序。对于在 TLD中声明为片段或类型为 的*命名属性*（由 定义的属性）**主体中的任何 JSP 代码，**这将自动完成。*`<jsp:attribute>``JspFragment`*

 *也就是说，在`testtag.jsp`片段中应该以其他方式传递：

```
<%@page contentType ="text/html" pageEncoding="UTF-8" buffer="none" session="false" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="t" tagdir="/WEB-INF/tags" %>

<c:set var="myvar" value="hello world"/>
<t:testtag>
    <jsp:attribute name="att1"><c:out value='${myvar}'/></jsp:attribute>
</t:testtag> 
```*

# android - permission.C2D_MESSAGE gcm android包以大写字母开头

> ID：12623911
> 
> 赞同：1
> 
> 时间：2012-09-27T14:38:03.310
> 
> 标签：android, eclipse, package, manifest, google-cloud-messaging

我的 android 清单包名称有问题。它以大写字母开头。我正在尝试向 gcm 注册，但我不能。任何解决方案，因为我的应用程序已经上传到 Play 商店。

在我的清单中，例如： `<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="Com.Example" android:versionCode="2" android:versionName="1.1">`

`<uses-permission android:name="Com.Example.permission.C2D_MESSAGE">` 当我尝试运行我的应用程序时尝试授予我的包权限 时，我得到 INSTALL_PARSE_FAILED_MANIFEST_MALFORMED 。我的应用程序已经在 Playstore 上，所以我无法将带有大写字母的名称包更改为小写字母。请帮忙。

非常感谢。

# sas - 替换 sas 中的观察结果

> ID：12623915
> 
> 赞同：2
> 
> 时间：2012-09-27T14:38:09.103
> 
> 标签：sas

我想将“ondays”变量中的一些观察值分配到新值之下，这些值取决于变量“失败”是0还是1。这是我的数据集

```
 ID         X       ONDAYS       FAILURE
    1          0         59          1
    2          0        514          1
    3          0        313          0
    4          0        631          1
    5          0        107          1
    6          0         71          0
    7          0        583          1
    8          0         91          1
    9          0         66          1
   10          0         95          0 
```

我的目标是对 ONDAYS 进行排序——从最低到最高（我可以这样做）——对 ONDAYS 中的值进行排序，然后创建一个名为“NEWDAYS”的新变量，如果 FAILURE=，它将具有与 ONDAYS 中相同的值1，但如果 FAILURE=0，NEWDAYS 将等于与 ONDAYS 中的 FAILURE=1 值对应的最接近（较低的值）。例如，在 NEWDAYS 观察 1 将等于 59，但观察 6 将等于 66（因为最接近 71 的有序“failure=1”值是 66）。你能帮我怎么做吗？

谢谢。

罗兰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:52:55.990

像这样？

```
data have;
input ID         X       ONDAYS       FAILURE;
datalines;
    1          0         59          1
    2          0        514          1
    3          0        313          0
    4          0        631          1
    5          0        107          1
    6          0         71          0
    7          0        583          1
    8          0         91          1
    9          0         66          1
   10          0         95          0
   ;;;;
run;
proc sort data=have;
by ondays;
run;
data want;
set have;
by ondays;
retain prev_ondays;
if failure=0 then new_ondays=prev_ondays;
else new_ondays=ondays;
output;
prev_ondays=new_ondays;
run; 
```

只需跟踪以前的 ONDAYS 并在需要时将其分配给新的 ONDAYS。

另一种选择：SQL。这会更新当前表，这可能是需要的，也可能不是；如果没有，请创建一个新表并应用它。

```
proc sql undopolicy=none;
update have H set ondays=(select max(ondays) from have V where H.ondays ge V.ondays and V.failure=1)
where failure=0;
quit; 
```

# c# - 阻止设计师打开文件 Visual Studio 2010 的奇怪警告消息

> ID：12623918
> 
> 赞同：0
> 
> 时间：2012-09-27T14:38:20.663
> 
> 标签：c#, winforms, visual-studio, warnings, designer

我有一个从现有表格派生的表格。现有形式完美运行。当我尝试（第一次）打开新表单时，我收到设计师的错误：

为了防止在加载设计器之前可能丢失数据，必须解决以下错误：

拒绝访问路径“C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\Logs\eventlog.dat”。

这个文件甚至不存在。如果我查看调用堆栈，它会变得更加奇怪。在派生表单的构造函数中，有一个创建日志文件的类。

```
at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost)
at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize)
at MeterView.MVLogger..ctor() in C:\Users\glevenson\Documents\Visual Studio 2010\Projects\MeterView\MeterView\MVDataLogger.cs:line 67
at MeterView.MVLogger.get_Instance() in C:\Users\glevenson\Documents\Visual Studio 2010\Projects\MeterView\MeterView\MVDataLogger.cs:line 79
at MeterView.frmSingle..ctor() in C:\Users\glevenson\Documents\Visual Studio 2010\Projects\MeterView\MeterView\frmSingle.cs:line 167 
```

这是引用实际上创建目录和日志文件的行代码，但来自应用程序当前目录。这根本没有意义。

为什么会生成有关不存在文件的警告，为什么它会阻止我在设计器中执行任何操作？因为这个，我现在完全死在了水里。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T15:18:22.580

你在这里犯了两个错误。第一个是您没有指定文件的完整路径名。您只需指定“eventlog.dat”即可创建/打开日志文件。当默认工作目录未设置在您希望的位置时，就会出错。在设计模式下，它肯定不会被设置在任何满意的地方。在您发布项目后，它*永远不会*正确设置，您无法写入 c:\program 文件的子目录。您必须使用 Environment.GetFolderPath() 来选择您可以写入的 AppData 路径。

第二个错误是您允许此代码在设计模式下运行。使用 DesignMode 属性来防止这种情况发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:49:49.893

根据您那里的内容进行疯狂猜测，但了解 Visual Studio，以下是我的猜测（在评论中格式不正确，所以各位大神，请原谅我）：

1.  `MVDataLogger`由于缺乏正确的初始化，类有问题
2.  `MVDataLogger`尝试加载/读取/写入名为“Logs\eventlog.dat”的文件
3.  `MVDataLogger`不确保文件/目录在打开之前存在。

我相信修复这些项目将解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-15T10:10:45.317

错误是由构造函数中的代码生成的。尝试注释构造函数的所有自定义代码。如果一切正常，请取消注释行，直到您再次收到错误。尽量避免在构造函数中进行不安全的初始化。或使用：

```
if(!DesignerProperties.GetIsInDesignMode(this))
{
   // do something not dupported in designer 
} 
```

# build - Cmake 自动生成节俭代码

> ID：12623921
> 
> 赞同：8
> 
> 时间：2012-09-27T14:38:22.760
> 
> 标签：build, cmake, thrift

所以我找到的唯一像样的例子是[http://grokbase.com/t/thrift/user/1162hvgrdn/recommended-way-to-incorporate-thrift-to-the-build-system](http://grokbase.com/t/thrift/user/1162hvgrdn/recommended-way-to-incorporate-thrift-to-the-build-system)，但它似乎非常有问题，例如 if 语句缺少 ${THRIFT_FILE} 。

也就是说，我正在关注执行进程命令返回：“execute_process given uknown argument - “STUFF”，其中的东西看起来是一个适当的节俭命令。

有什么建议吗？这里有什么问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-02-21T19:11:19.003

迟到总比不好。使用[add_custom_command](http://cmake.org/cmake/help/v2.8.12/cmake.html#command%3aadd_custom_command)

```
add_custom_command(
OUTPUT
    ${GEN_FILES_PATH}/DebugProtoTest_types.cpp
    ${GEN_FILES_PATH}/DebugProtoTest_types.h
COMMAND
    $<TARGET_FILE:compiler> --gen cpp:dense ${TEST_PATH}/DebugProtoTest.thrift
DEPENDS
    compiler
WORKING_DIRECTORY
    ${CMAKE_BINARY_DIR}
) 
```

[我用它在这里](https://github.com/snikulov/thrift.cmake)为 Apache thrift 生成测试相关的东西

# c# - 在 onStartup 完成之前动画不会开始

> ID：12623924
> 
> 赞同：1
> 
> 时间：2012-09-27T14:38:31.420
> 
> 标签：c#, wpf, animation, splash-screen

我正在开发 WPF、C# 应用程序。

因为加载过程很长，我们需要创建一个动画启动屏幕，以便在应用程序加载时显示。

问题是所有的初始化代码都在“OnStartup”方法中。我注意到动画在 OnStartup 完成之前不会开始，所以我猜你在应用程序启动结束之前不能显示任何动画。

我对这个假设是否正确？如果是，有没有办法在启动完成之前显示动画，或者我应该将代码移动到另一个地方？（我不喜欢这样做，因为这将是应用程序流程的巨大变化）。

**编辑**

我尝试使用新线程并使用调度程序启动启动，但调度程序的调用直到 OnStartup 完成后才开始。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:48:01.350

你应该做：

```
protected override void OnStartup(StartupEventArgs e)
{
    //Start your animation here.

    Task.Factory.StartNew(() => 
    {
       //Start long loading operation here

       Application.Current.Dispatcher.Invoke(
          new Action(() => 
             { 
                //Stop your animation here
                //Note: it needs to run on the UI thread, so we dispatch it.
             })
       );
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:01:43.897

使用动画创建一个新窗口。首先启动此窗口，然后在其启动时创建主窗口并在加载主窗口后关闭第一个窗口。您可以将动画窗口设置为“始终在顶部”以防止主窗口覆盖动画。

# gwt - 如何制作不可编辑的 CellTable？

> ID：12623929
> 
> 赞同：0
> 
> 时间：2012-09-27T14:38:37.307
> 
> 标签：gwt, gwt-platform, celltable

我使用这个问题作为指南制作了一个动态 CellTable：[动态创建 GWT CellTable](https://stackoverflow.com/questions/7172262/create-gwt-celltable-dynamically)

但是这样我只能制作一个可编辑的CellTable，我不知道为什么。

检查我的代码：

```
@UiField
CellTable<List<String>> tableDynamic;
@UiField
SimplePager pagerDynamic;

private SingleSelectionModel<List<String>> 
selectionModelDynamic = new SingleSelectionModel<List<String>>();
private List<String> columns = new ArrayList<String>();
private List<List<String>> data = new ArrayList<List<String>>();
private ListDataProvider<List<String>> providerDynamic 
= new ListDataProvider<List<String>>(); 
```

我的工厂

```
@UiFactory
public CellTable<List<String>> getTabelaDynamic() {
    CellTable<List<String>> table
            = new com.google.gwt.user.cellview.client.CellTable<List<String>>();

    //List<String> columnsArray = colunas;
    List<String> columnsArray = columns();
    for (int column = 0; column < columnsArray.size(); column++) {
        table.addColumn(new IndexedColumn(column), new
                TextHeader(columnsArray.get(column)));
    }
    table.setKeyboardSelectionPolicy
 (HasKeyboardSelectionPolicy.KeyboardSelectionPolicy.ENABLED);
    table.setSelectionModel(selectionModelDynamic);
    providerDynamic.addDataDisplay(table);
    providerDynamic.setList(new ArrayList<List<String>>());
    return table;
} 
```

获取列的方法：

```
//Just a static test 
public List<String> columns(){
    colunas.add("Tables");
    return colunas;
} 
```

仅用一列设置数据的方法。

```
@Override
public void setSingleData(List<String> bankData) {
    for (String s : bankData) {
         List<String> help = new ArrayList<String>();
         help.add(s);
         dados.add(help);
    }
    providerDynamic.setList(data);
} 
```

我执行 rpc 调用（onBind 方法）来获取列表并填充 setsingledata 方法。

为什么我收到一个可编辑的单元格表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T02:20:38.467

您的表格是可编辑的，因为 IndexedColumn 在另一个问题中使用 EditTextCell。使用 TextCell，您的表格将不可编辑。

# sql - SQL获取另一个字段最大的最大主键

> ID：12623932
> 
> 赞同：1
> 
> 时间：2012-09-27T14:38:47.673
> 
> 标签：sql, grouping, max

这是一个示例数据集。

```
shareId mode    shareLevel  targetId    targetItemId
26          1   5           0           2
32          1   5           0           21
33          2   1           1           21
34          1   3           0           21 
```

我正试图把它作为我的结果：

```
shareId mode    shareLevel  targetId    targetItemId
26          1   5            0          2
33          2   1            1          21 
```

*因此，我需要“shareId”字段。

*按 TargetItemId 分组，所以我只取回给定 targetItemId 的一条记录

*但我需要具有最高模式值的记录，因此在分组期间，我想要具有 MAX(mode) 的字段

这是我尝试过的，但它不起作用：

```
select shareId FROM shares group by targetItemId having mode = MAX(mode) 
```

它只返回：

```
shareId mode    shareLevel  targetId    targetItemId
26          1   5            0          2 
```

所以基本上，我如何获得每个唯一 targetItemId 的 shareId，但我想要具有最大模式的给定 targetItemId 的行。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:42:30.583

您可以使用排名函数执行此操作：

```
select shareId, mode, shareLevel, targetId, targetItemId
from (select t.*,
             row_number() over (partition by targetItemId order by mode desc) as seqnum
      from t
     ) t
where seqnum = 1 
```

这假设您只需要一行，即使模式的最大值重复。如果您想要所有值，请使用`dense_rank`而不是`row_number`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:42:36.013

这应该适用于任何 rdbms ：

```
select shareId
from shares s
join (select max(mode) as mode,targetItemId from shares group by targetItemId) s_max
  on s.mode=s_max.mode 
 and s.targetItemId =s_max.targetItemId 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T14:42:39.823

如果你正在使用`MSSQL 2008+`，试试这个

```
WITH latestRecord
AS
(
    SELECT  shareId, [mode]    ,shareLevel  ,targetId   , targetItemId,
            ROW_NUMBER() OVER (PARTITION BY targetItemId ORDER BY [mode] DESC) AS RN
    FROM    tableName
)
SELECT  shareId, [mode]    ,shareLevel  ,targetId   , targetItemId
FROM    latestRecord
WHERE   RN = 1 
```

# android - Android：如何从一个来源构建两个不同的应用程序（具有不同的命名空间）

> ID：12623937
> 
> 赞同：0
> 
> 时间：2012-09-27T14:38:57.877
> 
> 标签：android, eclipse, ant, configuration-management

目前我在 Eclipse 中有一个 Android 应用程序“com.mysite.MyApp”。我需要从“com.mysite.MyApp”的来源制作两个应用程序（“com.mysite.App1”和“com.mysite.App2”），具体取决于一些“配置”类常量。我需要在 Eclipse 中完成，或者使用 apache ant。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:43:52.403

变成`com.mysite.MyApp`一个包含所有公共代码的[库项目](http://developer.android.com/tools/projects/index.html#LibraryProjects)，并有两个独立的应用程序项目 App1 和 App2 引用它。

# google-app-engine - 如何为选定的时间添加 cron 作业

> ID：12623938
> 
> 赞同：-1
> 
> 时间：2012-09-27T14:38:59.680
> 
> 标签：google-app-engine, cron

我想在谷歌应用引擎中添加一个每 5 分钟而不是每小时发生一次的 cron 作业。那可能吗？

大约每 5 分钟 7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0

unix 格式会是这样的......？（不确定）：*/5 0,7-23 * * *

目标是减少使用的实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T14:58:01.493

你甚至读过文档吗？它几乎就在那里。 [https://developers.google.com/appengine/docs/python/config/cron](https://developers.google.com/appengine/docs/python/config/cron)

```
every 5 minutes from 7:00 to 0:00 
```

# doctrine - Symfony2 prePersist/preUpdate 监听器通知

> ID：12623950
> 
> 赞同：1
> 
> 时间：2012-09-27T14:39:26.303
> 
> 标签：doctrine

我在使用 Doctrine/Symfony2 prePersist/preUpdate 监听器时遇到了问题。

多对一关系中有两个实体（一个位置可以被多个人引用）。我构建了一个表单，我在其中执行了一些 AJAX-Stuff 来帮助用户为已经存在的新人员选择一个位置。因此，我使用的是“entity_id”表单域。我还想让用户可以为数据库中不存在的新人员创建新位置。这由表单中的第二个字段处理，用户可以在其中插入新位置的名称。在持久化人的实体时，我正在检查数据库中是否存在引用的位置。如果没有，我正在生成一个新的位置实体。这是（简而言之）我在 Entity-Class Person 中的 prePersist-Lifecyclecallback：

```
public function prePersist() {
   if($this->ort == null) 
       $this->ort = new Ort($this->ortsname);
} 
```

当我创建一个新人时，这非常有效。问题是更新程序。因此，当之前有一个位置与此人相关联，并且我想通过相同的过程（使用 preUpdate-Listener）创建一个新位置时，我会收到如下通知：

```
Notice: Undefined index: 000000004a0010250000000058426bec in ...Doctrine/ORM/UnitOfWork.php line 983 
```

我不知道如何解决这个问题。我认为它必须与位置对象有关，它在引用到 Person 对象之前，但我不知道如何告诉 Entity-Manager 引用到 Person 的 Location-Object 是一个新实体。我还尝试了一个 Listener-Class，例如：

```
if( $entity instanceof Person) {
    if( $entity->getLocation() == null ) {
         $entity->setLocation( new Location( $entity->getLocatioName() );
         $em->persist($entity->getLocation());
         $em->flush();
    }
} 
```

$em->persist ... 东西应该无关紧要，因为在映射中启用了“cascade={persist}”表示法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T10:51:20.867

我想你会遇到麻烦`preUpdate`。对于这样的情况，有两件事意味着`preUpdate`不是最好的事件处理程序：

*   刷新操作不再识别对传递实体的关联的更改。
*   强烈建议不要对 EntityManager#persist() 或 EntityManager#remove() 进行任何调用，即使与 UnitOfWork API 结合使用，也不会在刷新操作之外按预期工作。

（这两点取自本节底部： http: [//docs.doctrine-project.org/en/2.0.x/reference/events.html#preupdate](http://docs.doctrine-project.org/en/2.0.x/reference/events.html#preupdate)）

此外，`preUpdate`在 Doctrine 的 flush 操作中调用，`flush`再次调用会导致问题。

因此，我建议您`onFlush`改用：[http ://docs.doctrine-project.org/en/2.0.x/reference/events.html#onflush](http://docs.doctrine-project.org/en/2.0.x/reference/events.html#onflush)

如果你这样做了，你需要告诉 Doctrine 一旦你添加了 Location 之后 Person 实体已经改变了。获取更改后的 Person 对象本身也稍微复杂一些。在你的处理程序中尝试这样的事情`onFlush`：

```
public function onFlush(OnFlushEventArgs $args)
{
    $em = $args->getEntityManager();
    $uow = $em->getUnitOfWork();

    foreach ($uow->getScheduledEntityUpdates() AS $entity) {
        if ($entity instanceof Person) {
            if ($entity->getLocation() == null ) {
                $entity->setLocation( new Location( $entity->getLocationName() ));

                // have to tell Doctrine that the Location has been updated
                $cmf = $args->getEntityManager()->getMetadataFactory();
                $class = $cmf->getMetadataFor(get_class($entity));
                $args->getEntityManager()->getUnitOfWork()->computeChangeSet($class, $entity); // don't use recomputeSingleEntityChangeSet here - that doesn't care about relationships
            }
        }
    }
} 
```

# javascript - LocalStorage 使用点/括号表示法获取项目不适用于 JSON.parse()

> ID：12623951
> 
> 赞同：1
> 
> 时间：2012-09-27T14:39:26.423
> 
> 标签：javascript, json, local-storage, stringify

**如果可能的话，我希望能够使用速记符号从中获取项目`localStorage`，然后`JSON.parse()`在其上使用。**

在下面的代码中，如果我使用以下代码，它可以工作：

```
var retrievedObject = JSON.parse(localStorage.getItem('testObject')); //works 
```

但是，如果我使用以下两个速记选项之一，它将不起作用：

```
var retrievedObject = JSON.parse(localStorage.testObject); //doesn't work

var retrievedObject = JSON.parse(localStorage['testObject']); //doesn't work 
```

**我的所有代码都在 jsFiddle 下方和上：http: [//jsfiddle.net/TestB/1/](http://jsfiddle.net/TestB/1/)。**

```
//var retrievedObject = JSON.parse(localStorage.getItem('testObject')); //works
var retrievedObject = JSON.parse(localStorage.testObject); //doesn't work
//var retrievedObject = JSON.parse(localStorage['testObject']); //doesn't work

if (retrievedObject == null) {

  var testObject = { 'one': 1, 'two': 2, 'three': 3 };

  // Put the object into storage
  localStorage.testObject = JSON.stringify(testObject);

}

else {

 retrievedObject.four = 4;

 // Put the object into storage
 localStorage.testObject = JSON.stringify(retrievedObject);

}
// Retrieve the object from storage
var retrievedObject = JSON.parse(localStorage.getItem('testObject'));

console.log('retrievedObject: ', retrievedObject);​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:59:36.610

问题第一次出现，当时`localStorage.testObject`尚未定义..

在那种情况下`localStorage.testObject`是未定义的并且`JSON.parse`因该论点而失败

另一方面，该`getItem`方法在内部处理它并返回`null`..

你可以使用`JSON.parse(localStorage.testObject || null)`

# hibernate - 如何在 Hibernate 和 JBoss AS 7 连接池中使用动态 @PersistenceContext

> ID：12623955
> 
> 赞同：3
> 
> 时间：2012-09-27T14:39:35.000
> 
> 标签：hibernate, persistence, jboss7.x, entitymanager

早上好，我正在尝试制作一个数据库脚本执行器。

当 Web 应用程序启动时，将向用户显示可用数据源的列表（在 JBoss AS7 中预先注册）。

选择所需的数据源后，应用程序将根据用户所做的选择使用@PersistenceContext。

说明如何列出我在这里找到的数据源的答案： [James R. Perkins - Answer](https://stackoverflow.com/a/9706511/1703546)

以及如何从我在这里找到的 JNDI 创建 EntityManagers 的答案： [Nayan Wadekar - Answer](https://stackoverflow.com/a/4295515)

我的问题是。可以从 JNDI 定义 @PersistenceContext 吗？如果我不使用声明的 JTA 数据源（“jta-data-source”），我的“persistence.xml”文件将如何？

目前它看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence"                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="database" transaction-type="JTA">
        <jta-data-source>java:jboss/datasources/DefaultDS</jta-data-source>
        <properties>
            <property name="hibernate.show_sql" value="true" />
        </properties>
    </persistence-unit>
</persistence> 
```

是否有任何教程或源代码示例可以解释此操作的工作原理？

注意：我想控制 JBoss AS 连接池，我不会安排它，我相信 JBoss 会比我创建的任何代码更好地管理池。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T05:17:47.507

如果您的所有数据源都使用不同的数据库模式连接到一个数据库，则有一个解决方案。在这种情况下，您可以创建一个数据源，在 persistence.xml 中定义它并基于此数据源动态创建 EntityManagerFactory，但用于另一种数据库方案：

```
private Map<String, EntityManagerFactory> entityManagers = Collections.synchronizedMap(new HashMap<String, EntityManagerFactory>());

public EntityManager getEntityManager(String databaseSchema) {
    EntityManagerFactory emf = entityManagers.get(databaseSchema.toUpperCase());
    if (emf == null) {
        emf = Persistence.createEntityManagerFactory("your_persistent_unit_name", createMap(databaseSchema));
        entityManagers.put(databaseSchema, emf);
    }
    return emf.createEntityManager();
}

public static java.util.Map createMap(String databaseSchema) {
    java.util.Map map = new HashMap();
    map.put("provider", "org.hibernate.ejb.HibernatePersistence");
    map.put("hibernate.cache.provider_class", "org.hibernate.cache.HashtableCacheProvider");
    map.put("hibernate.default_schema", databaseSchema.toUpperCase());
    map.put("hibernate.show_sql", "false");
    map.put("hibernate.ejb.naming_strategy", "org.hibernate.cfg.ImprovedNamingStrategy");
    map.put("hibernate.transaction.jta.platform", "org.hibernate.service.jta.platform.internal.JBossAppServerJtaPlatform");
    map.put("hibernate.ejb.entitymanager_factory_name", databaseSchema+ "_entity_manager");
    return map;
} 
```

# c++ - cpp Linux套接字编程错误接受

> ID：12623957
> 
> 赞同：1
> 
> 时间：2012-09-27T14:39:41.850
> 
> 标签：c++, linux, sockets

这是我的第一个 linux 套接字程序。我正在使用服务器客户端模型。我已阅读教程并创建了服务器和客户端。但是我遇到了服务器端代码的问题。

我在接受行“'int*' 到 'socklen_t* {aka unsigned int*}' 的无效转换”收到此错误消息。
我该如何解决这个问题？下面是服务器代码。

```
#include <stdio.h>
#include <unistd.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <stdlib.h>
#include <string.h>
#include <netdb.h>

using namespace std;
#define MAX_SIZE 50

int main()
{
    int sock_descriptor, conn_desc;
    struct sockaddr_in serv_addr, client_addr;
    char buff[MAX_SIZE];
    sock_descriptor = socket(AF_INET, SOCK_STREAM, 0);
    if(sock_descriptor < 0)
        cout << "Failed creating socket" << endl;
    bzero((char *)&serv_addr, sizeof(serv_addr));
    serv_addr.sin_family = AF_INET;
    serv_addr.sin_addr.s_addr = INADDR_ANY;
    serv_addr.sin_port = htons(1234);

    if(bind(sock_descriptor, (struct sockaddr *)&serv_addr, sizeof(serv_addr)) < 0)
        cout << "Failed to bind" << endl;

    listen(sock_descriptor, 5);
    cout << "Waiting for connection...\n" << endl;

    int size = sizeof(client_addr);
    conn_desc = accept(sock_descriptor, (struct sockaddr *)&client_addr, &size);
    if(conn_desc == -1)
        cout << "Failed accepting connection" << endl;
    else
        cout << "Connected" << endl;

    if(read(conn_desc, buff, sizeof(buff)-1) > 0)
        cout << "Received %s" << buff << endl;
    else
        cout << "Failed receiving" << endl;

    close(conn_desc);
    close(sock_descriptor);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:41:59.500

代替

```
int size = sizeof(client_addr); 
```

和

```
socklen_t size = sizeof(client_addr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:41:59.693

也许您应该将 size 声明为

```
socklen_t size; 
```

# ios - 为 UIButton 拉伸背景图像

> ID：12623961
> 
> 赞同：34
> 
> 时间：2012-09-27T14:39:58.240
> 
> 标签：ios, uibutton, uiimage, textures

我得到了比我的 UIButton 更短的纹理。

我得到了这个纹理：

![在此处输入图像描述](../Images/3b186b66c43b97f7b933b9299a11294e.png)

我应该创建这个按钮：

![在此处输入图像描述](../Images/0d2155580e2b6be8bb2c38c9ed0d1fcd.png)

我应该如何拉伸（而不是平铺）这种纹理？水平方向拉伸

谢谢

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-09-27T15:38:36.420

`UIImage`从您提供的示例图像中，我很确定您正在寻找[`resizableImageWithCapInsets:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIImage_Class/Reference/Reference.html#//apple_ref/occ/instm/UIImage/resizableImageWithCapInsets:)

```
UIImage *originalImage = [UIImage imageNamed:@"myImage.png"];
UIEdgeInsets insets = UIEdgeInsetsMake(top, left, bottom, right);
UIImage *stretchableImage = [originalImage resizableImageWithCapInsets:insets];
[myButton setBackgroundImage:stretchableImage forState:UIControlStateNormal];
// the image will be stretched to fill the button, if you resize it. 
```

UIEdgeInsets 结构中的值决定了您不想被拉伸的边距。您的左右值可能大约是这个宽度：

![在此处输入图像描述](../Images/60fff466c3f4f4a2a90145340fe0a616.png)

顶部和底部值可以是 0（如果您不想垂直调整按钮的大小），或者可能是总高度的一半。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2015-03-02T08:27:13.927

使用 Xcode 6（和**iOS7+**目标），您可以在处理图像资源时使用切片编辑器。使用编辑器切换切片模式**-> 显示切片**菜单或在使用编辑器选择特定图像时按**显示切片按钮（如下所示）。**

![显示切片按钮](../Images/243ac57bd2ccb8c79a049388e194eb63.png)

然后，您可以选择特定显示比例的图像并拖动规则或手动编辑插入值。

![规则](../Images/2ad1b7947b03122021598b5f50eea56f.png)

之后，您可以在*Interface Builder*中为*UIButton* **背景图像**选择此图像（IB 按钮的表示可能看起来很糟糕，但在运行时应该没问题）。

我的按钮看起来不错（运行 iOS 7.1 模拟器和 iOS 8 设备）。

![在此处输入图像描述](../Images/4094269531ac335b694b6bd99e1e8357.png)

这个 Apple 文档[链接](https://developer.apple.com/library/ios/recipes/xcode_help-image_catalog-1.0/chapters/SlicinganImage.html)可能会有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-27T14:49:14.573

通过不平铺，我假设您因此不能使用

```
- (UIImage *)resizableImageWithCapInsets:(UIEdgeInsets)capInsets 
```

做你想做的事情的方法是使用：

```
UIGraphicsBeginImageContextWithOptions(newSize, NO, 0); // should be proportionally larger
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextDrawImage(context, (CGRect){{0,0}, newSize}, [yourImage CGImage]);
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
return image; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-01T21:31:30.417

使用`stretchableImageWithLeftCapWidth:topCapHeight:`方法。

参考：[https ://github.com/boctor/idev-recipes/tree/master/StretchableImages](https://github.com/boctor/idev-recipes/tree/master/StretchableImages)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-07T22:49:09.680

或使用**可拉伸图像**：

```
UIImage* imgbkg =[[UIImage imageNamed: @"my_bkg_image.png"] stretchableImageWithLeftCapWidth:10 topCapHeight:10];

[_button setBackgroundImage: imgbkg forState: UIControlStateNormal]; 
```

如果您不想拉伸某一侧，请使用**0 。**

# eclipse - Eclipse GWT 示例问候项目 RPC 失败

> ID：12623964
> 
> 赞同：1
> 
> 时间：2012-09-27T14:40:07.183
> 
> 标签：eclipse, gwt

我已经使用 Eclipse 有一段时间了，但是当我（编译后）将“war”文件夹的内容复制到 mac 上的“站点”文件夹时，突然之间我的 GWT 项目不再运行。这工作得非常好，但现在我不断收到 RPC 失败 -

> 尝试联系服务器时出错。请检查您的网络连接，然后重试。

![在此处输入图像描述](../Images/a8cf96c015d6da4b4639bf90ef851e03.png)

我现在只是在创建新的 Google Web 应用程序项目（它们内置了问候示例），当我在 Eclipse 中运行 Debug 或 Run（使用 Jetty 然后是默认值）时，这仍然可以正常工作，但当我复制战争时却不行到网站。

编辑 - 根据建议，我现在已将应用程序移植到 Tomcat7，它可以正常工作。我仍然对为什么它在 mac 上工作感到困惑，但现在对配置感到满意。

> Appengine 版本：1.7.2
> GWT 版本：2.4.0
> Eclipse 版本：4.2(juno) Java SE 6 (MacOS X)

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T03:01:43.710

Mac 上的“站点”文件夹允许使用 Apache Web 服务器 (http://httpd.apache.org/) 提供内容，该服务器足够聪明，可以分发文件，并且知道如何与各种可以在服务器上运行应用程序的“模块”。也就是说，从用户的站点文件夹中提供的任何文件都不会作为应用程序运行，至少在默认配置下是这样。

此外，默认示例项目是用 Java 编写的，旨在在 Servlet 容器上运行。那里有许多 servlet 容器（Tomcat、Jetty、JBoss），但 Apache HTTP Server 不是其中之一。我从未听说过作为 apache 模块运行的 servlet 容器，尽管至少有一个模块允许 apache 轻松与 Tomcat 通信。

因此，您看到的是静态内容——html、编译后的 JavaScript、样式和图像——但是当示例应用程序尝试与服务器通信时，它失败了，因为 apache 并不是真正设计用于运行服务器的示例应用程序的片段。相反，请考虑下载 Tomcat 或 Jetty 的副本，并将 war 文件夹复制到它们的 webapps/ 目录中，然后从那里提供服务。

# php - PHP：使用 Header() 函数下载失败

> ID：12623966
> 
> 赞同：0
> 
> 时间：2012-09-27T14:40:08.337
> 
> 标签：php, http-headers, download

我收到一些用户报告他们无法下载文件。

这是下载计数器文件中的脚本。

```
<?php
$id = $_GET['id'];
require('conn.php');
$stmt = write_conn()->prepare("UPDATE links SET dl_count = dl_count + 1 WHERE ID=" . $id);
$stmt->execute();
header('Location: ' . $row['mp3_url'] );
?> 
```

我听说使用`Header()`将用户重定向到下载链接的功能有一些限制，并且在 IE 上效果不佳。是对的吗 ？

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:45:10.263

header(Location: ...) IE6 肯定有一些问题，甚至可能是更高版本。

尝试对生成的字符串（链接）进行 url 解码，看起来 IE 在 header(Location: ...) 中的链接字符串被 url 编码时存在一些问题。

也一定要在 heder 之后退出...

出口;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:45:28.703

```
header('Content-Disposition: attachment; filename="'.$fileName.'"');
header('Content-Type: application/force-download');
header('Content-Type: application/octet-stream');
ob_flush();
readfile($row['mp3_url']);
exit; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T10:38:23.403

在研究和尝试了大量的测试和试验之后，我发现了一些关于`header()`功能和`readfile()`或类似的事实。

1.  首先你应该知道它`header()`与不同浏览器的兼容性问题。所以不要试图寻找完美无缺的功能。问题不在于 php 函数，而是浏览器具有不同的分析下载标头的方式，因此它们的行为都不同。你可能已经知道了，最大的麻烦是IE

2.  如果您想解决问题并使其工作`header()`，您必须添加/强制一些标题详细信息（`Content-Type`等），但这在您的 php 代码中是不可能的。无论您尝试多少次，它都不起作用。我对此没有太多信息，但我只知道即使您`Content-Type`在实际添加标题之前`header()`它也不起作用。似乎它们完全出于不同的目的。

3.  您可以使用添加必要的标题并改用该`readfile()`功能，它会正常工作。但是你应该知道这个函数会将你调用的文件/url加载/读取到内存中。这可能是一个大问题，并且可能会减慢您的网络服务器，最糟糕的情况是它也可能崩溃。如果您的下载程序过多或文件过多，则可能会发生这种情况。

不幸的是，正如我之前提到的，您无法在 php 代码中解决此问题。所以我为了解决这个问题所做的就是在我的网络服务器虚拟主机中添加标​​题。

Nginx：

```
location ~ ^/.*\.mp3$ {
        add_header Pragma "public";
        add_header Expires "0";
        add_header Cache-Control "must-revalidate, post-check=0, pre-check=0";
        add_header Content-Disposition "attachment";
        add_header Content-Type "application/force-download";
        add_header Content-Type "application/octet-stream";
        add_header Content-Type "application/download";
        add_header Content-Transfer-Encoding "binary";
        } 
```

就我而言，用户必须下载的文件是 mp3 格式。但是您可以更改它或设置一个全局指令，以便它可以使用任何格式。

# html - 让 divs z-index 与绝对定位的 div 重叠

> ID：12623968
> 
> 赞同：0
> 
> 时间：2012-09-27T14:40:13.333
> 
> 标签：html, css

有谁知道我怎样才能让我的页面顶部的标志出现在窗帘的顶部。

[http://nuigums.tumblr.com/](http://nuigums.tumblr.com/)

徽标与 z-index 为 2 的其余内容一起位于部分标记内，这是获得我想要的页脚显示效果所必需的。窗帘的 z-index 为 3。我尝试将 logo div 的 z-index 设置为 4，但我认为部分样式会覆盖它？

我希望徽标也随着页面内容滚动。

谢谢。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:36:14.397

离开元素`position:relative`。`section`和徽标：

```
#logo{
    position:absolute;
    z-index:10;
    width:890px;
    text-align:center;
} 
```

您将需要更改`slider(top, left, z-index)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:43:52.557

div#logo 需要位于该部分之外，该部分已经位于#curtain 下方。

将 div#logo 放在该部分之前并设置，`position:absolute`然后您应该能够看到您想要的堆叠类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T15:43:57.313

缺少一行：

```
position:relative; 
```

如果指定位置，则只能调整 z-index。

# azure - 以共同管理员的身份创建网站？

> ID：12623970
> 
> 赞同：1
> 
> 时间：2012-09-27T14:40:17.027
> 
> 标签：azure

我正在尝试从图库中创建一个 WordPress 网站，但我无法选择我知道自己是其共同管理员的订阅。如果我转到旧门户，我可以看到我是另一个订阅的共同管理员，但在创建新网站时我无法选择该帐户。

如果我创建云服务和其他一些类型，我*可以*看到我想要使用的订阅，但是当我尝试创建网站时看不到正确的订阅。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T16:11:34.167

为了能够创建 Azure 网站（以及虚拟机、媒体服务和移动服务），您需要首先启用该预览功能。只有管​​理员可以选择启用订阅的预览功能。默认情况下不启用它们。帐户管理员可以从 Windows Azure 站点 (http://www.windowsazure.com/) -> 帐户部分 -> 帐户中心 -> 预览功能执行此操作。激活这些功能可能需要一些时间。

# html - Windows Phone 中标签前出现的缩进

> ID：12623971
> 
> 赞同：2
> 
> 时间：2012-09-27T14:40:21.690
> 
> 标签：html, css, windows-phone-7, html-email

在编写 HTML 电子邮件时，我们遇到了一个奇怪的问题，即在没有明显原因的情况下，缩进出现在 span 中。

我在下面包含了 HTML，但据我所知，没有填充、边距等应用于跨度。内联样式似乎都不是原因。假设我在这里遗漏了一些非常基本的东西。

底部两个电话号码左侧的缩进：（图片来自 Litmus 电子邮件测试应用程序的 Windows 7 HTC 手机测试） ![在此处输入图像描述](../Images/e6f40b83d5ac30c43d35f093357acd72.png)

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
    <html>
        <head>
        <title>Title</title>
        <meta name="robots" content="noindex,nofollow" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <meta name="viewport" content="width=device-width" />

                  <style type="text/css">

@media only screen and (max-device-width: 480px) {
body img.banner {max-width: 300px !important; height: auto !important;}
table {max-width: 300px overflow:visible; width: auto; }
}

div, p, a, li, td { -webkit-text-size-adjust:none; }

span { padding: 0; margin: 0; }

.appleLinks a {color:#400400; text-decoration:none;}

.appleLinksGray a:link,.appleLinksGray a:visited {color:#808080;}

.appleLinksGrayClean a:link,.appleLinksGrayClean a:visited {color:#808080; text-decoration:none;}

</style> 
    </head>
    <body style="font-family: 'trebuchet ms', arial, helvetica, sans-serif; font-size: 12px;">
        <table style="background-color: #ffffff; margin: auto; font-family: 'trebuchet ms', arial, helvetica, sans-serif; font-size: 13px;" border="0" cellspacing="0" cellpadding="0" width="627">
            <tbody>
                <tr>
                    <td colspan="2"><img class="banner" src="" alt="Alt" width="625" height="100" /></td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: left; padding-bottom: 20px; padding-left: 20px; padding-right: 20px; font-family: 'trebuchet ms', arial, helvetica, sans-serif; padding-top: 20px; color: #400400;"><p>Dear ~goesBy~,<br />
                      <br>
                      Text</p>
                      <p>Regards,<br>
                        Text
                          <br>
                          <br>
                      </p>
                      <p><span class="appleLinks">Address<br>
<br>
5:00 – 7:00 pm
                     </span></p>
                      <p><b style="font-family: arial, helvetica, sans-serif; color:#000;">Name<br />
    </b><span style="font-family: arial, helvetica, sans-serif; white-space: nowrap; color: #808080; font-size: 8pt;">Manager<br />
      <br />
      </span><b><span style="font-family: 'times new roman', times, serif; color: #00644c; font-size: 10pt;"><br />
        COMPANY </span></b><br />
  <span class="appleLinksGrayClean" style="font-family: arial, helvetica, sans-serif; color: #808080; font-size: 8pt;">Address Line 1</span><br />
  <span class="appleLinksGrayClean" style="font-family: arial, helvetica, sans-serif; color: #808080; font-size: 8pt;">Address Line 2</span><br />
    <span class="appleLinksGray" style="font-family: arial, helvetica, sans-serif; color: #808080; font-size: 8pt;">111.111.1111</span><br />
    <span class="appleLinksGray" style="font-family: arial, helvetica, sans-serif; color: #808080; font-size: 8pt;">111.111.1111 direct</span><br />
    <span class="appleLinksGray" style="font-family: arial, helvetica, sans-serif; color: #808080; font-size: 8pt;">111.111.1111 mobile</span><br />
    <a href="mailto:person@example.com" style="font-family: arial, helvetica, sans-serif; color: #808080; font-size: 8pt;"><span class="appleLinksGray" >person@example.com</span></a></p></td>
                </tr>
                <tr>
                    <td style="padding-top: 20px;" colspan="2">
                    <div style="text-align: left; font-family: verdana; color: #333333; font-size: 9px;">Copyright</div>
                    </td>
                </tr>
            </tbody>
        </table>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T08:21:46.410

你检查隐藏字符了吗？有时，当您复制粘贴代码时，会包含特殊字符。主要来自字符集差异。尝试删除 html 标签之间的所有空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:33:01.287

try removing `colspan='2'` from all the `td`s

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T13:44:51.727

我建议删除所有行上的无关代码，以消除渲染引擎在每行开头拾取额外空格的可能性`<span>`

```
<span class="appleLinksGray" style="font-family: arial, helvetica, sans-serif; color: #808080; font-size: 8pt;">111.111.1111<br />111.111.1111 direct<br />111.111.1111 mobile</span> 
```

我已经看到 IE 添加空格（尤其是在表格布局中）只是通过在我的代码中使用回车（以帮助我更容易阅读）。

# java - 从 java 发送表单数据（图像和一些参数），如 curl

> ID：12623972
> 
> 赞同：3
> 
> 时间：2012-09-27T14:40:22.213
> 
> 标签：java, post, curl, httpurlconnection, multipartform-data

我有这个来运行这个命令，它给了我正确的输出，我想在java中使用HttpUrlConnection（或任何第三方库）来模拟它

```
curl http://localhost/myservice/ -v  -H 'Content-Type: multipart/form-data' -F 'file=@/home/xyz/abc.jpg' -F 'type=image' -F 'id=123' 
```

该服务接受一个文件、一个类型和一个 ID。

我当前的代码如下所示-

```
 String urlToConnect = "http://localhost/myservice/";
    String boundary = Long.toHexString( System.currentTimeMillis() ); // Just generate some unique random value
    HttpURLConnection connection = (HttpURLConnection) new URL( urlToConnect ).openConnection();
    connection.setDoOutput( true ); // This sets request method to POST.
    connection.setRequestProperty( "Content-Type", "multipart/form-data; boundary="+boundary);
    PrintWriter writer = null;
    try
    {
    writer = new PrintWriter( new OutputStreamWriter( connection.getOutputStream(), "UTF-8" ) );

        writer.println( "--" + boundary );

        // -F type =1
        writer.println( "Content-Disposition: form-data; name=\"type\"" );
        writer.println( "Content-Type: text/plain; charset=UTF-8" );
        writer.println();
        writer.println( "image" );
        //writer.println( "--" + boundary );
        // -F id=1
        writer.println( "Content-Disposition: form-data; name=\"id\"" );
        writer.println( "Content-Type: text/plain; charset=UTF-8" );
        writer.println();
        writer.println( 123 );
        //writer.println( "--" + boundary );

        writer.println( "Content-Disposition: form-data; name=\"file\"; filename=\"abc.jpg\"" );
        writer.println( "Content-Type: image/jpeg;" );
        writer.println();
        BufferedReader reader = null;
        try
        {
            reader = new BufferedReader( new InputStreamReader( new FileInputStream(
                "/home/xyz/abc.jpg" ), "UTF-8" ) );
            for( String line; (line = reader.readLine()) != null; )
            {
                writer.println( line );
            }
        }
        finally
        {
            if( reader != null ) try
            {
                reader.close();
            }
            catch( IOException logOrIgnore )
            {
            }
        }

    }
    finally
    {
        if( writer != null ) writer.close();
    }

    // Connection is lazily executed whenever you request any status.
    int responseCode = ((HttpURLConnection) connection).getResponseCode();
    System.out.println( responseCode ); // Should be 200

    StringBuffer responseContent = new StringBuffer();
    BufferedReader rd = null;
    try
    {
        rd = new BufferedReader( new InputStreamReader( connection.getInputStream() ) );
    }
    catch( Exception e )
    {
        rd = new BufferedReader( new InputStreamReader( connection.getErrorStream() ) );
    }
    String temp = null;
    while( (temp = rd.readLine()) != null )
    {
        responseContent.append( temp );
    }

    System.out.println( "Response : " + responseContent );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T08:47:40.920

我已经尝试过使用 apache httpClient，现在我的代码看起来像

```
 HttpClient httpclient = new HttpClient();
    File file = new File( "/home/abc/xyz/solar.jpg" );

    // DEBUG
    logger.debug( "FILE::" + file.exists() ); // IT IS NOT NULL        
    try
    {
    PostMethod filePost = new PostMethod( "http://localhost/myservice/upload" );

    Part[] parts = { new StringPart( "type","image"),new StringPart( "id","1"), new FilePart( "file", file ) };
    filePost.setRequestEntity( new MultipartRequestEntity( parts, filePost.getParams() ) );

    // DEBUG

        int response = httpclient.executeMethod( filePost );
        logger.info( "Response : "+response );
        logger.info( filePost.getResponseBodyAsString());
    }
    catch( HttpException e )
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    catch( IOException e )
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

现在我得到了正确的响应代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T07:08:38.420

首先，您不能使用 a`BufferedReader`来读取 jpeg 图像。此类仅用于阅读文本内容。您需要读取原始字节`FileInputStream`并将它们按原样发送到`output stream`您从`connection.getOutputStream()`. 中间没有作家。

# java - 可以在 Java 中强制执行包依赖层次结构吗？

> ID：12623973
> 
> 赞同：3
> 
> 时间：2012-09-27T14:40:22.610
> 
> 标签：java, maven, dependencies, package

基本上我有包...

```
com.me.application
com.me.application.thing
com.me.library 
```

我想强制执行规则中的任何内容都`com.me.application`不能包含`com.me.library`，除了`com.me.application.thing`.

这在 Java 代码、Maven、类路径或任何其他大致相当于 C 语言链接的 Java 层上是否可行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T17:56:46.707

与其试图强迫编译器去做，为什么不使用源代码分析呢？

我建议使用现在嵌入在[Sonar中的](http://www.sonarsource.org/)[架构规则引擎](http://docs.codehaus.org/display/SONAR/Architecture+Rule+Engine)。将此与[构建破坏](http://docs.codehaus.org/display/SONAR/Build+Breaker+Plugin)插件结合使用，如果开发人员违反您的层次结构规则，您可以触发构建失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T16:47:50.797

您可以使用 Checkstyle 的[导入控制](http://checkstyle.sourceforge.net/config_imports.html#ImportControl)规则强制执行检查。[将Maven Checkstyle 插件](http://maven.apache.org/plugins/maven-checkstyle-plugin/)配置到您的 pom.xml 中，任何违规都可以设置为导致构建失败。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T14:51:13.273

我能想到的唯一方法是通过[AspectJ](http://www.eclipse.org/aspectj/)。

AspectJ 是一种面向方面的语言，用于通过单独的编译过程将横切关注点添加到您的应用程序中。AspectJ 的经典用途之一是策略执行，它适合您的场景。

基本上，您声明的规则决定可以从哪个包调用哪些代码，并在遇到违反这些规则的方法调用（或在您的情况下为变量声明）时抛出编译错误。您可以在优秀的书籍[AspectJ in Action中了解详细信息](http://www.manning.com/laddad2/)

[AspectJ 可以通过AspectJ 插件](http://mojo.codehaus.org/aspectj-maven-plugin/)很好地集成到 Maven 构建中

如果您仅将 AspectJ 用于策略实施，您将不会有任何额外的运行时依赖项，因为您的字节码不会被修改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T14:50:41.647

您需要通过单独的 maven 项目构建 com.me.application、com.me.application.thing 和 com.me.library，每个项目都构建一个 jar 文件。com.me.application 的 pom 将不包含对 com.me.library 的依赖，而 com.me.application.thing 的 pom 将包含对 com.me.library 的依赖。

但这是一个奇怪的包结构。为什么要阻止这种情况？

# asp.net-mvc-3 - SQL Azure Entity 框架的 RetryPolicy 机制

> ID：12623976
> 
> 赞同：1
> 
> 时间：2012-09-27T14:40:27.307
> 
> 标签：asp.net-mvc-3, entity-framework-4.1, azure-sql-database

我正在使用`TransientFaultHandling.RetryPolicy`. 我想知道重试策略是否足以仅连接实体框架。连接实体后，我将在多个地方使用实体。在打开连接和使用连接之间，如果连接丢失怎么办？重试策略会处理连接吗？

**连接类**

```
static class Azure
{
    static RetryPolicy policy = new RetryPolicy<MyRetryStrategy>  (5,TimeSpan.FromSeconds(2),  TimeSpan.FromSeconds(2));

    public static CrmEfEntities ConnectCustomerEntity()
    {
        CrmEfEntities customerEntity = null;
        policy.ExecuteAction(() =>
        { 
            customerEntity = new Entities(ConnectionStringCustomerDB());
            string federationCmdText = @"USE FEDERATION       Customer_Test_Federation(TestId =" + testId + ") WITH RESET, FILTERING=ON";
            customerEntity.Connection.Open();
            customerEntity.ExecuteStoreCommand(federationCmdText);                  
        });  
        return customerEntity;
    }
} 
```

我在控制器中调用上述方法，如下所示：

```
public class EmployeeController : Controller
{      
    private static readonly CrmEfEntities _db = Azure.ConnectCustomerEntity();

    public ActionResult Index()
    {            
        var employeeList = GetEmployeeDetails().ToList();            
        return View(employeeList);
    }

    private static IEnumerable<EmployeeModel> GetEmployeeDetails()
    {
        var employee= from emp in _db.Employees
        from coun in _db.Countries
        where emp.CountryId == coun.Id
        select new CompanyDetailsModel
        {
            Id = emp.Id,   
            Name = emp.Name,                                           
            countryName=coun.Name
        };
        return employee;
    }
} 
```

# objective-c - 在 iOS 中处理大量音频文件的最佳做法是什么？

> ID：12623977
> 
> 赞同：2
> 
> 时间：2012-09-27T14:40:28.890
> 
> 标签：objective-c, ios, xcode, avfoundation

目前我正在开发一个包含大量视频和音频的 iPhone 应用程序。我使用运行良好的 HTTP Live Streaming 实现了视频。但是对于那些音频文件，我想也许也可以进行流式传输。但是每一个都很小，总播放时间只有2-3秒。所以我根本不必使用 HLS。

问题是 for `AVAudioPlayer`，它只支持本地文件，但是把这些音频文件放到包里似乎很傻。我可以同步下载文件并将`NSData`指针传递给`AVAudioPlayer`，但是如果我想按顺序播放多个音频文件，则很难控制播放循环。

希望你们能帮助我解决这个问题或给我一些提示。非常感谢。

# c++ - 被释放的c++指针未被分配

> ID：12623978
> 
> 赞同：0
> 
> 时间：2012-09-27T14:40:31.053
> 
> 标签：c++, memory, dynamic, operator-overloading

您好，我正在尝试删除班级中的动态内存，但出现以下错误：

```
a.out(2830) malloc: *** error for object 0x7fb38a4039c0: pointer being freed was not allocated 
```

***在 malloc_error_break 中设置断点以调试 Abort 陷阱：6

我认为这与我的重载“=”运算符不直接访问我的类“&”有关。

```
class Polynomial{
    public:
        //Constructors / Destructors
        Polynomial();
        Polynomial(int tempNum, int * tempPoly);
        ~Polynomial();

        //Member Functions & Operator overloading
        //Addition
        Polynomial operator+(Polynomial& Poly);
        //Subtraction
        Polynomial operator-(Polynomial& Poly);
        //Multiplication
        Polynomial operator*(Polynomial& Poly);
        //Assignment
        Polynomial operator=(Polynomial Poly);

        //Insertion
        friend ostream& operator<<(ostream& os, Polynomial& Poly);
        //Extraction
        friend istream& operator>>(istream& is, Polynomial& Poly);

    private:
        //Data Members
        //Int array (degree of polynomial + 1)
        int * poly;
        int polyNum;
};

Implementation: 

Polynomial::Polynomial(){
    polyNum = 0;
}

Polynomial::~Polynomial(){
    //Delete Dynamic Memory
    delete [] poly;
}

Polynomial::Polynomial(int tempNum, int *tempPoly){

    poly = new int[tempNum+1];

    polyNum = tempNum;

    for (int i=0; i < tempNum; i++) {
        poly[i] = tempPoly[i];
    }
}

//Addition
Polynomial Polynomial::operator+(Polynomial &Poly){
    Polynomial temp;

    if(polyNum > Poly.polyNum){
        temp.polyNum = polyNum;
    }
    else{
        temp.polyNum = Poly.polyNum;
    }

    temp.poly = new int[temp.polyNum + 1];

    for(int i=0; i < temp.polyNum; i++){
        temp.poly[i] = Poly.poly[i] + poly[i];
    }

    return (temp);
}

//Subtraction
Polynomial Polynomial::operator-(Polynomial& Poly){
    Polynomial temp;

    if(polyNum > Poly.polyNum){
        temp.polyNum = polyNum;
    }
    else{
        temp.polyNum = Poly.polyNum;
    }

    temp.poly = new int[temp.polyNum + 1];

    for(int i=0; i < temp.polyNum; i++){
        temp.poly[i] = poly[i] - Poly.poly[i];
    }

    return (temp);
}

//Multiplication
Polynomial Polynomial::operator*(Polynomial& Poly){

    Polynomial temp;

    //make coefficient array
    temp.polyNum = (polyNum + Poly.polyNum) - 1;

    temp.poly = new int [temp.polyNum];

    for (int i = 0; i < temp.polyNum; i++)
    {
        for (int j = 0; j < Poly.polyNum; j++){
            temp.poly[i+j] += poly[i] * Poly.poly[j];
        }
    }

    return temp;
}

//Assignment
Polynomial Polynomial::operator=(Polynomial Poly){

    polyNum = Poly.polyNum;

    poly = new int[polyNum+1];

    for (int i=0; i < polyNum; i++) {
        poly[i] = Poly.poly[i];
    }

    return *this;
}

//Insertion
ostream& operator<<(ostream& os, Polynomial& Poly){

    for (int i=0; i < Poly.polyNum; i++) {
        os << Poly.poly[i] << " x^" << i;

        if(i != Poly.polyNum - 1){
            os << " + ";
        }
    }

    return os;
}

//Extraction
istream& operator>>(istream& is, Polynomial& Poly){

    int numP = 0;
    int * tempP;

    is >> numP;

    tempP = new int [numP+1];

    for (int i=0; i < numP; i++) {
        is >> tempP[i];
    }

    Poly.polyNum = numP;

    Poly.poly = new int[Poly.polyNum +1];

    for (int i=0; i < Poly.polyNum; i++) {
        Poly.poly[i] = tempP[i];
    }

    delete [] tempP;

    return is;
} 
```

主要的

```
int main(){

// Input Polynomial #1 (P1)
cout << "Input polynominal p1: " << endl;
Polynomial P1;
cin >> P1;

// Output Polynominal
cout << "p1(x) = " << P1 << '\n' << endl;

// Input Polynomial #2 (P2)
cout << "Input polynominal p2: " << endl;
Polynomial P2;
cin >> P2;

// Output Polynominal
cout << "p2(x) = " << P2 << '\n' << endl;

// Copy P2 to P3 and output P3
Polynomial P3;
P3 = P2;
cout << "Copy p2 to p3, p3(x) = " << P3 << '\n' << endl;

// Add P1 to P2 and output to P3
Polynomial P4;
P4 = P1 + P2;
cout << "p3(x) = p1(x) + p2(x) = " << P4 << '\n' << endl;

// Subtract P1 from P2 and output to P3
Polynomial P5;
P5 = P1 - P2;
cout << "p3(x) = p1(x) - p2(x) = " << P5 << '\n' << endl;

// Subtract P2 from P1 and output to P3
Polynomial P6;
P6 = P2 - P1;
cout << "p3(x) = p2(x) - p1(x) = " << P6 << '\n' << endl;

// Multiply P1 by P2 and output to P3
Polynomial P7;
P7 = P1 * P2;
cout << "p3(x) = p1(x) * p2(x) = " << P7 << '\n' << endl;

return 0; 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T14:55:10.847

您有一个默认构造函数（有一个错误）和赋值运算符，但您还需要定义一个复制构造函数。如果不这样做，则 a 的每个副本`Polynomial`都会获得与从中`poly`复制它的那个相同的指针，并且每次这些副本中的一个被销毁时，您都会释放相同的指针。第二次发生这种情况时，您调用`delete[]`了一个已经被`delete[]`编辑的指针，导致了这个错误。

您的复制构造函数应该看起来像这样

```
Polynomial::Polynomial(const Polynomial& rhs) : poly(new int[rhs.polynum]), polynum(rhs.polynum) {
    std::copy(rhs.poly, rhs.poly + polynum, poly);
} 
```

也就是说，如果您使用，则`std::vector`不必拥有赋值运算符或复制构造函数，甚至不需要单独的变量来跟踪`poly`您拥有多少 s，因此我建议您这样做。

您还需要修复默认构造函数；至少设置`poly`为`nullptr`这样你`delete[]`的析构函数中就不会出现未初始化的指针。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T14:57:24.210

```
Polynomial::Polynomial(){
    polyNum = 0;
}
Polynomial::~Polynomial(){
    //Delete Dynamic Memory
    delete [] poly;           // <-- bug
} 
```

这是给你的一个错误：poly 没有在默认 ctor 中初始化，而是在 dtor 中删除。

*编辑*

真的你应该使用`std::vector<int>`：

```
class polynomial
{
  std::vector<int> _pol;       
public:
  size_t degree() const { return _pol.empty()? 0 : _pol.size() - 1; }
  polynomial() = default;                   // could be omitted (compiler generated anyway)
  polynomial(polynomial const&) = default;  // ----
  /// evaluate polynomial
  template<typename T>
  T operator() (T const&x) const
  {
    T y(0);
    T p(1);
    for(auto i : _pol) {
      y += *i * p;
      p *= x;
    }
    return y;
  }
  polynomial& operator+=(polynomial const&other)
  {
    auto j = other._pol.begin();
    for(auto i = _pol.begin(); i!=_pol.end() && j!=other._pol.end(); ++i,++j)
      *i += *j;
    for(; j != other._pol.end(); ++j)
      _pol.push_back(*j);
    return*this;
  }
  polynomial operator+(polynomial const&other) const
  {
    polynomial _p(*this);
    return _p += other;           
  }
  // etc
}; 
```

您还应该适当地实现移动 ctor 和运算符，以便`polynomial sum = a+b;`在复制临时文件时不需要重新分配内存等表达式。

# sql-server - sql server 在还原前后备份文件

> ID：12623983
> 
> 赞同：0
> 
> 时间：2012-09-27T14:40:47.760
> 
> 标签：sql-server, database-restore

我有一个 sql server 数据库备份文件（从 R2 版本备份）。备份文件最初为 700 MB。但是我删除了一些表，当我再次备份它时，它几乎达到了 4 MB。

不幸的是，当我将其还原到另一个 SQL 服务器实例（再次为 R2）时，数据库大小再次增长到近 700 MB。

你能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T14:47:09.503

我不确定我是否理解您的问题，但[缩小数据库](http://msdn.microsoft.com/en-us/library/ms189035.aspx)可能会对您有所帮助。

# javascript - 通过 javascript 访问 Facebook 图表

> ID：12623985
> 
> 赞同：0
> 
> 时间：2012-09-27T14:40:50.723
> 
> 标签：javascript, facebook-graph-api

我正在尝试创建一个自定义的 javascript“小部件”，以便我们可以将状态等从 Facebook 拉到我们的各种网站。我尝试在 FB 开发人员中心创建一个应用程序，获取访问令牌等，但没有运气。

谁能指出我正确的方向以至少获得身份验证？如果可能的话，我们希望能够在多个站点上重用代码。

作为参考，这是我当前在尝试访问[https://graph.facebook.com/statuses/?id=thePfisterHotel&access_token=_TOKEN_HERE_时收到的错误消息](https://graph.facebook.com/statuses/?id=thePfisterHotel&access_token=_TOKEN_HERE_)

```
{
    "error": {
        "message": "A user access token is required to request this resource.",
        "type": "OAuthException",
        "code": 102
     }
} 
```

任何帮助和指导将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:43:51.220

您似乎正在尝试使用应用程序访问令牌，但您需要的是一个访问令牌，它是用户授权您的应用程序的结果。

您可以在编写应用程序时使用[Graph API Explorer](http://developers.facebook.com/tools/explorer/)来玩弄它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:15:19.727

我强烈推荐使用官方支持的[Facebook Javascript SDK](https://developers.facebook.com/docs/reference/javascript/)。有了它，您可以轻松添加 Facebook 登录按钮。[您可以在Facebook for Websites](https://developers.facebook.com/docs/guides/web/)文档中找到更详细的示例。

# xcode - 如何使用 CMake 在“其他链接器标志”中设置库？

> ID：12623988
> 
> 赞同：5
> 
> 时间：2012-09-27T14:40:58.337
> 
> 标签：xcode, cmake

我正在尝试使用 cmake 生成一个 Xcode 项目，但我无法在项目设置中定义“其他链接器标志”。我使用过“target_link_libraries”，但它不起作用。有什么线索吗？我想要做的是定义哪些库必须包含在链接中。如果我手动操作，例如我会输入“-lopencv_core”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:43:55.780

*target_link_libraries* 应该为您处理它。如果您还没有使用[FindOpenCV.cmake](http://opencv.willowgarage.com/wiki/FindOpenCV.cmake)模块来定位可能存在问题的库，那么接下来您应该尝试一下。为此，首先获取 FindOpenCV.cmake 文件并将其放置在您的项目路径中（通常是 {project_dir}/cmake/Modules），然后将以下行添加到您的 CMakeLists.txt 中：

```
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_CURRENT_SOURCE_DIR}/cmake/Modules/") 
```

这将告诉 CMake 在解析库时使用自定义 FindOpenCV.cmake。然后加：

```
FIND_PACKAGE( OpenCV REQUIRED )
TARGET_LINK_LIBRARIES( PROJECT_NAME_HERE ${OpenCV_LIBS} ) 
```

尽管您不需要这样做，但您可以通过[CMAKE_SHARED_LINKER_FLAGS](http://www.cmake.org/Wiki/CMake_Useful_Variables)设置链接器标志。

# c - 使线程获得相等的时间片

> ID：12623993
> 
> 赞同：8
> 
> 时间：2012-09-27T14:41:33.240
> 
> 标签：c, multithreading, operating-system

我正在运行这个程序，我有多个线程。三个线程正在为同一个父进程生成信号。有四个处理线程用于处理由信号生成线程生成的信号。我有一个监控线程，它也接收相应的信号和进程。不过，我有一个情况。我可以看到信号分配不均。我的意思是信号被定向到相同的过程。我有四个处理程序线程和一个监视线程等待信号。所以他们中的任何一个人都可以接收到信号。我期待它均匀分布。但是，我可以看到处理程序线程有时会接收到整个信号突发。下一次整个信号突发由监视器线程处理。为什么不统一。在处理程序/监视器线程完成处理一个信号后，我添加了一个睡眠调用。因此，一旦处理程序/监视器完成一个信号，它就应该给另一个机会来处理下一个信号。但是，输出没有显示这种情况

```
#include <pthread.h>
#include <signal.h>
#include <stdlib.h>
#include <iostream>
#include <unistd.h>
#include <sys/types.h>
#include <sys/time.h>
#include <signal.h>
#include <cstdio>
#include <stdlib.h>

#define NUM_SENDER_PROCESSES 3
#define NUM_HANDLER_PROCESSES 4
#define NUM_SIGNAL_REPORT 10
#define MAX_SIGNAL_COUNT 100000

using namespace std;

volatile int usrsig1_handler_count = 0;
int usrsig2_handler_count = 0;
int usrsig1_sender_count = 0;
int usrsig2_sender_count = 0;
int monitor_count = 0;
int usrsig1_monitor_count = 0;
int usrsig2_monitor_count = 0;
double time_1[10];
double time_2[10];
int lock_1 = 0;
int lock_2 = 0;
int lock_3 = 0;
int lock_4 = 0;
int lock_5 = 0;

double timestamp() {
  struct timeval tp;
  gettimeofday(&tp, NULL);
  return (double)tp.tv_sec + tp.tv_usec / 1000000.;
}

void sleepMs(double seconds) {
  usleep((unsigned int)(seconds*1000000));
}

void *senderfunc(void *parm) {
  srand(time(0));
  while(true) {
    int signal_id = rand()%2 + 1;
    if(signal_id == 1) {
      while(__sync_lock_test_and_set(&lock_3,1) != 0) {
      }
      usrsig1_sender_count++;
      lock_3 = 0;
      kill(getpid(), SIGUSR1);
    } else {
      while(__sync_lock_test_and_set(&lock_4,1) != 0) {
      }
      usrsig2_sender_count++;
      lock_4 = 0;
      kill(getpid(), SIGUSR2);
    }

    int r = rand()%10 + 1;
    double s = (double)r/100;
    sleepMs(s);
  }
}

void *handlerfunc(void *parm)
{
  int *index = (int *)parm;
  sigset_t set;
  sigemptyset(&set);
  //cout << (*index) << endl;
  if((*index) % 2 == 0) {
    sigaddset(&set, SIGUSR1);
  } else {
    sigaddset(&set, SIGUSR2);
  }

  int sig;

  while(true) {
    sigwait(&set, &sig);
    //cout << "Handler" << endl;
    if (sig == SIGUSR1) {
      while(__sync_lock_test_and_set(&lock_1,1) != 0) {
      }
      usrsig1_handler_count++;        
      lock_1 = 0;
    } else if(sig == SIGUSR2) {
      while(__sync_lock_test_and_set(&lock_2,1) != 0) {
      }
      usrsig2_handler_count++;
      lock_2 = 0;
    }

    sleepMs(0.0001);
  }

}

void *monitorfunc(void *parm) {

  sigset_t set;
  sigemptyset(&set);

  sigaddset(&set, SIGUSR1);
  sigaddset(&set, SIGUSR2);

  int sig;  

  while(true) {
    sigwait(&set, &sig);
    //cout << "Monitor" << endl;
    if(sig == SIGUSR1) {
      time_1[usrsig1_monitor_count] = timestamp();
      usrsig1_monitor_count++;
    } else if(sig == SIGUSR2) {
      time_2[usrsig2_monitor_count] = timestamp();
      usrsig2_monitor_count++;
    }
    monitor_count++;
    //cout << monitor_count << endl;

    if(monitor_count == NUM_SIGNAL_REPORT) {
      double difference_1 = 0;
      double difference_2 = 0;
      if(usrsig1_monitor_count > 1) {
        for(int i=0; i<usrsig1_monitor_count-1; i++) {
          difference_1 = difference_1 + time_1[i+1] - time_1[i];
        }
        cout << "Interval SIGUSR1 = " << difference_1/(usrsig1_monitor_count-1)<< endl;
      }

      if(usrsig2_monitor_count > 1) {
        for(int i=0; i<usrsig2_monitor_count-1; i++) {
          difference_2 = difference_2 + time_2[i+1] - time_2[i];
        }
        cout << "Interval SIGUSR2 = " << difference_2/(usrsig2_monitor_count-1) << endl;
      }
      cout << "Count SIGUSR1 = " << usrsig1_sender_count << endl;
      cout << "Count SIGUSR2 = " << usrsig2_sender_count << endl; 
      monitor_count = 0;
      usrsig1_monitor_count = 0;
      usrsig2_monitor_count = 0;
    }

    sleepMs(0.001);

  }
}

int main(int argc, char **argv)
{
  if(argc != 2) {
    cout << "Required parameters missing. " << endl;
    cout << "Option 1 = 1 which means run for 30 seconds" << endl;
    cout << "Option 2 = 2 which means run until 100000 signals" << endl;
    exit(0);
  }

  int option = atoi(argv[1]);
  int i;

  pthread_t handlers[NUM_HANDLER_PROCESSES];
  pthread_t generators[NUM_SENDER_PROCESSES];
  pthread_t monitor;

  sigset_t set;
  sigset_t oldset;
  sigemptyset(&oldset);
  sigemptyset(&set);
  sigaddset(&set, SIGUSR1);
  sigaddset(&set, SIGUSR2);

  pthread_sigmask(SIG_BLOCK, &set, &oldset);

  int handler_mask[4] = {0,1,2,3};
  //Initializing the handler threads
  for(i=0; i<NUM_HANDLER_PROCESSES; i++) {
    pthread_create(&handlers[i], NULL, handlerfunc, (void *)&handler_mask[i]);
  }

  pthread_create(&monitor, NULL, monitorfunc, NULL);

  sleep(5);

  for(i=0; i<NUM_SENDER_PROCESSES; i++) {
    pthread_create(&generators[i], NULL, senderfunc, NULL);
  }

  if(option == 1) {
    cout << "Option 1 " << endl;
    //sleep(30);
    while(true){

    }
    exit(0);
  } else {
    while(true) {
      if((usrsig1_handler_count + usrsig2_handler_count) >= MAX_SIGNAL_COUNT) {
        cout << "Count SIGUSR1 = " << usrsig1_handler_count << endl;
        cout << "Count SIGUSR2 = " << usrsig2_handler_count << endl;
        exit(0);
      } else {
        pthread_yield();
      }
    }
  }
} 
```

这是我的输出

```
HandlerHandler

Handler
Handler
Monitor
Monitor
... whole bunch of Monitor messages
Monitor
Monitor
Handler
Handler
... whole bunch of Handler messages
Handler
Handler 
```

您可以看到监视器的爆发，然后是处理程序的爆发。但是，在代码中，一旦处理程序/监视器处理信号并进行 sigwait，我添加了一个睡眠调用，以便将轮到传递给下一个可用线程。但是，这没有帮助。我猜这应该使它变得统一。但是，显示器仍然会爆裂并打印。即使在监视器中我已经在它完成信号工作后进入睡眠状态

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T19:05:51.930

您使用的是什么操作系统？您需要一个实时操作系统 (RTOS) 来可靠地执行此操作。我使用名为[On Time RTOS-32](http://www.on-time.com/rtos-32.htm)的非常小的 RTOS来驱动机器人控制器，取得了很好的效果。它可以在保证延迟的情况下进行时间切片，或者您可以选择进行协作调度。它为 Win API 的子集设置了 Window 仿真。我们使用 Visual Studio/VC++ 作为 IDE。现在可能有相当多的 RTOS 可用。那是差不多 10 年前的事了。Google for RTOS 和“实时操作系统”。

另一种方法（在快速、专用的机器上可能已经足够好）是编写自己的“操作系统中的操作系统”来“手动”调度线程。您将不得不更改线程等待分配的方式。

我在黑暗中拍摄。为什么需要平衡线程之间的负载？任务是什么？预算是多少？它必须在特定硬件上运行吗？在特定的操作系统上？如果有，是哪个？如果它突然发生了怎么办？有人咕哝了一句脏话去吃午饭，还是太空探测器的鼻子潜入太阳？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T07:34:26.603

操作系统不知道您要在多个线程之间分配作业，因此操作系统以最高优先级运行第一个可用线程，它继续运行该线程直到当前线程等待某些东西（用户输入、磁盘或网络活动或...）或另一个具有更高优先级的线程变得可用。- 为了提高性能并避免过多的上下文切换，操作系统尝试在同一线程上调度请求（与您的需要相反）。

例如，考虑 MonitorThread 计划运行并且它的调用`sigwait`得到满足，现在它执行它的操作（虽然这个线程拥有 CPU，操作系统没有办法调度其他线程），当它的操作完成（while 结束）它调用`sigwait`时，如果有那里有任何挂起的信号，操作系统将接收该信号并再次通过循环，该线程将执行此过程，直到没有更多的挂起信号并`sigwait`阻止其操作，并且下次该操作将与其他预定线程重复。

现在为了平等地发送信号，我必须实现自己的机制（因为操作系统没有这种机制）。我可以`condition_variable`为每个线程创建一个并强制他们每个人首先等待自己的`condition_variable`然后调用`sigwait`，完成执行后它将设置`condition_variable`下一个线程并且操作按原样进行！。

# java - Android：如何更新数组列表中的对象变量

> ID：12623994
> 
> 赞同：0
> 
> 时间：2012-09-27T14:41:43.353
> 
> 标签：java, android, arraylist

我创建了一个包含货币对象的 ArrayList（货币有名称和价格）。
我还创建了扩展 baseAdapter 和应用程序类的类。因此，每次我将货币添加到列表中时，它都会使用以下代码通过应用程序类：

```
getApplicationClass().addCurrency(currency); 
```

但是，货币价格不断更新。
所以我想知道如何更新货币价格？我可以从库中使用任何功能吗？

（ArrayList 在应用程序类中）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:55:43.360

虽然可以将货币列表保留在 Application 类中以便显示它，但该列表也必须位于 BaseAdapter 的子类中。当您通过 Application 类将货币添加到列表中时，您将绕过 UI 正在侦听的 BaseAdapter 子类。如果您在调用 Application 类的 addCurrency() 方法时将 BaseAdapter 的子类连接到 UI，则 UI 不会看到这些更改。相反，最好通过 BaseAdapter 子类进行添加，以便它可以调用 notifyDataChanged() 以便 UI 知道更改。此外，由于它包含对 Application 类中相同实例的引用（我假设这是您所做的），因此 Application 引用也将被更新。

如果特定货币的价格发生变化，您只需调用 BaseAdapter 子类上的 notifyDataChanged() 来告诉 UI 重绘，因为支持模型中的某些内容已更改。

在不了解您的程序的更多细节的情况下，这就是我可以给出的所有建议，并且我也在对您正在做的事情做出一些假设（即 Application 类中的 ArrayList 与给 BaseAdapter 子类的实例相同 - 不是副本） .

# javascript - 递归/嵌套函数 - 参数范围

> ID：12623998
> 
> 赞同：1
> 
> 时间：2012-09-27T14:41:57.407
> 
> 标签：javascript, recursion, google-chrome-extension

我正在尝试遍历书签树（分类为文件夹和子文件夹），并使用它们的“路径”为每个文件夹创建标签列表，例如 - 存储在“开发”>“JS”>“中的书签博客的标签将映射为`['Dev, 'JS, 'Blogs']`

该结构的 Chrome 的默认结构 using `chrome.bookmarks.getTree`，如下所示：

```
[{
    'title' : '',
    children : [{
           'title' : 'a title',
           'url' : 'http://www.example.com'
       },
       {
           'title' : 'a folder category',
           'children' : [{...}]
        },
    }]
}]; 
```

...我的代码是：

```
function processTreeNodes(tree, tags) {
    console.log(tags);
    var t = tags || [];
    for (var i=0; i < tree.length; i++) {
        processNode(tree[i], t);
    }
}

function processNode(n, tags) {
    if(n.children) {
        tags.push(n.title);
        //It's a group, loop over it
        processTreeNodes(n.children, tags);
    } else { 
        //Do something with the bookmark
    }
}

chrome.bookmarks.get(function(bmTree) {
    processTreeNodes(bmTree);
}); 
```

我期望的是`console.log`展示

```
[ 'category1', 'subcat1', ...] 
```

接着

```
['category2, 'subcatA', ...] 
```

我最终得到的是

```
['category1, 'subcat1', ..., 'category2', 'subcatA', ...] 
```

它通过并拉出所有信息，但在我看来，当我退回堆栈时，该“级别”的参数尚未保存。我认为这可能与递归/闭包有关，但我迷路了！

抱歉，如果这没有任何意义，我正在努力理解它，让我知道，如有必要，我可以尝试进一步解释！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T14:49:50.550

看起来您只创建了一个数组，然后将其传递给所有递归子函数。我将让您编写代码，但看起来您需要在层次结构中的每个点克隆您的数组，以便您传递对新对象的引用，而不是一直传递同一个对象。