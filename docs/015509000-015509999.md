# StackOverflow 问答 15509000-15509999

# javascript - 访问变量打印未定义？

> ID：15509000
> 
> 赞同：0
> 
> 时间：2013-03-19T19:44:30.783
> 
> 标签：javascript, jquery, closures

嗨，我尝试按如下方式访问变量，

```
for(var k=0;k<resultSet.length;k++)
{
   alert(resultSet[k]);
   $.get('/api/TagsApi/ElementsTagsIntersect?ids='+resultSet[k], function (data) {
        testingarr = [];
        for (var i = 0; i < data.length; i++) {                    
            testingarr.push(data[i]["ID"]);
        }
        for (var w = 0; w <3; w++) {
             if (($.inArray(testingarr[w], selectedloc)) > -1) {
                    var str = "<input type='checkbox' name ='test[]' value='" + resultSet[k] + "'/>" + resultSet[k] + "</br>";
                    $('#childs').append(str);
                     alert(resultSet[k]);
                    break;
                }
        }
}, 'json'); 
```

第一个警报显示我期望的确切值，但是当涉及到内部 for 循环时，警报返回未定义并添加一个带有未定义侧的复选框.. 我想我正在使用正确的初始化但混淆它为什么这样做?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:50:32.573

原因是`k`改变了值，所以当内部函数被调用时，`k`已经等于`resultSet.length`. 您可以将整个内容包装在另一个函数中并`k`作为参数传递以将其绑定到不会随原始变量更改的新变量`k`：

```
for(var k=0;k<resultSet.length;k++)
{
  (function (result) {
    $.get('/api/TagsApi/ElementsTagsIntersect?ids='+result, function (data) {
      var testingarr = [];
      for (var i = 0; i < data.length; i++) {                    
        testingarr.push(data[i]["ID"]);
      }
      for (var w = 0; w <3; w++) {
        if (($.inArray(testingarr[w], selectedloc)) > -1) {
          var str = "<input type='checkbox' name ='test[]' value='" + result + "'/>" + result + "</br>";
          $('#childs').append(str);
          break;
        }
      }
    }, 'json');
  })(resultSet[k]);
} 
```

# java - Libgdx 教程：无法打开桌面应用程序

> ID：15509002
> 
> 赞同：1
> 
> 时间：2013-03-19T19:44:34.187
> 
> 标签：java, libgdx

我正在尝试完成 libgdx 教程（[https://code.google.com/p/libgdx/wiki/ProjectSetupNew](https://code.google.com/p/libgdx/wiki/ProjectSetupNew)），但我无法运行桌面应用程序。我阅读了这个，有些人说这将是由于缺少 jar 文件引起的。我返回并确保应用程序引用了主项目，并且我使用了三个必要的 jar 文件：gdx-natives.jar、gdx-backend lwjgl.jar 和 gdx-backend-lwjgl-natives.jar。尽管如此，当我尝试运行应用程序时，会弹出一个窗口一秒钟然后崩溃，我收到此错误：

```
 JavaVM WARNING: JAWT_GetAWT must be called after loading a JVM
    _NSJVMLoadLibrary: NSAddLibrary failed for /libjawt.dylib
    JavaVM FATAL: lookup of function JAWT_GetAWT failed. Exit
    AL lib: ReleaseALC: 1 device not closed 
```

任何想法为什么会发生这种情况？附带说明一下，一些论坛表示 JRE 7 之前曾引起过问题，但此后已得到修复。我正在使用 JRE 1.7.0_17。我真的坚持这一点，任何帮助将不胜感激。

代码如下所示：

```
package com.me.mygdxgame;

import com.badlogic.gdx.backends.lwjgl.LwjglApplication;
import com.badlogic.gdx.backends.lwjgl.LwjglApplicationConfiguration;

public class Main {
public static void main(String[] args) {
    LwjglApplicationConfiguration cfg = new LwjglApplicationConfiguration();
    cfg.title = "my-gdx-game";
    cfg.useGL20 = false;
    cfg.width = 480;
    cfg.height = 320;

    new LwjglApplication(new MyGdxGame(), cfg);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T19:57:44.743

我猜你在Mac上。我认为它仍然是JDK7错误。问题在于 LWJGL+Mac+Java 的组合。我相信 Libgdx 还没有升级到 LWJGL 的前沿（这可能已经解决了这个问题？），因为升级引入了其他问题（尽管我对此并不完全肯定）。

如果您使用的是 Mac，那么您的问题可能与这个问题有关： [Can't load libgdx desktop app on mac osx](https://stackoverflow.com/questions/13571726/cant-load-libgdx-desktop-app-on-mac-osx)

# python - 简单的密码程序

> ID：15509004
> 
> 赞同：1
> 
> 时间：2013-03-19T19:44:40.287
> 
> 标签：python

我正在尝试制作一个简单的小程序，告诉用户密码错误。
但是，当我希望程序恢复他们输入的密码并说它错误时，它不会让我这样做。来人帮帮我..

```
username = raw_input("Please enter your username: ")
password = raw_input("Please enter your password: ")
fail1 = raw_input("Your password is very insecure, make a new one: ")
print "Your password [password] is too weak!" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T19:47:21.150

Python 不会神奇地格式化字符串，你需要*明确地*这样做：

```
print "Your password {} is too weak!".format(password) 
```

有关该方法如何工作的更多信息，请参阅[格式化字符串语法。](http://docs.python.org/2/library/string.html#formatstrings)`.format()`

或者，使用以下任何一种：

```
print "Your password", password, "is too weak!"
print "Your password %s is too weak!" % password
import string
template = string.Template("Your password ${password} is too weak!")
print template.substitute(password=password) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T19:47:14.570

如果要在另一个字符串中显示字符串，则需要使用 %。例如：

```
print "Your password [%s] is too weak" % password 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T19:47:19.820

尝试：

```
print "Your password %s is to weak!" % password 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T19:47:52.097

```
print "Your password", password, "is to weak!" 
```

# php - 通过 jQuerys 的 Load 函数发送数据

> ID：15509005
> 
> 赞同：2
> 
> 时间：2013-03-19T19:44:40.983
> 
> 标签：php, jquery

我有一个像这样工作的 jQuery 加载函数：

```
function admin_loadPage(page) {
    history.pushState(null, null, '?page='+page);
    $('#page').html('<center><img src="../includes/images/loader.gif" /></center>');
    $('#page').load('content/'+page+'.php');
} 
```

无论我想加载什么页面，我如何将数据发送到我的内容/+page+.php，以及如何接收页面本身的数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:02:51.570

您可以通过在第二个参数中发送对象并在第三个回调函数中获取响应来发送数据

```
$('#page').load('content/'+page+'.php', {data1: 'yourdata', data2: 'otherdata'},function(result){
    alert(result);
}) 
```

**页面.php**

您可以通过邮寄方式获取发送数据

```
 $data=$_POST['data1'];  //will give you yourdata
 $anotherdata=$_POST['data2']; //will give you otherdata 
 echo "test"; 
```

在这里，您正在打印`test`作为响应，因此帖子中的警报应该给您一个带有测试的警报...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T19:54:52.363

要发送数据，只需在 load 方法的第二个参数中放置一个包含您的数据的 javascript 对象。

```
$('#page').load('content/'+page+'.php', {param1: 'SomeData', param2: 'SomeOtherData'}) 
```

我不确定您所说的“我如何接收页面本身的数据？”是什么意思？在本例中，load 方法将从服务器返回的内容附加到 ID 为“page”的 HTML 元素。这不是你想要做的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T20:00:22.697

你应该使用 ajax 来做到这一点。如果我理解正确，您想将日期发送到服务器并接收您将在页面上显示的数据？很好地做到这一点，正如我所提到的，ajax 是你最好的朋友。[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

使用 ajax，您可以将 javascript 对象发送到服务器（通常为 JSON 格式），服务器将对其进行处理并返回一些值给您。jquery ajax 方法还有一个回调函数，您可以使用它来显示返回给您的任何数据。由于我们看不到您的服务器端代码，这对我们来说很难提供帮助，但这是一般的想法。

# android - 如何在Android中将UI元素放置到我们想要的位置？

> ID：15509011
> 
> 赞同：1
> 
> 时间：2013-03-19T19:45:07.650
> 
> 标签：android

我的 android 应用程序中有一些按钮、文本框等，但是当我用鼠标在 xml 文件中拖动它们时，它们的位置没有改变，或者改变但它们没有放在我真正想要的位置。如何调整它们在屏幕中的位置？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:54:32.243

不幸的是，在 android 中没有绝对定位之类的东西（`AbsoluteLayout`多年来不推荐使用 RIP。）

相反，您必须根据其父级和同一父级中的其他视图定位视图。

首先，您必须定义您需要的父级（如果您想在一行中使用一些 viens，请使用`LinearLayout`. 更自定义的布局：使用`RelativeLayout`...）

然后你可以在里面拖放视图，但它们总是会相对于它们的父视图和/或相对于其他视图捕捉一个位置。

你当然可以玩边距。

可以在[此页面上找到具有一些高级技术的布局类型列表](http://developer.android.com/guide/topics/ui/declaring-layout.html)

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T19:48:56.287

您将 RelativeLayout 作为布局的组布局，因此使用鼠标定位可以稍微容易一些。

最好是从 xml 代码中安排它们。只需了解如何使用相对布局、LinearLayout 和 TableLayout

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T19:51:04.370

了解 XML 的工作原理。对于 LinearLayout，项目按列出的顺序排列。对于 RelativeLayout，项目通过其 layout_XXX 属性的值相关联。那么您就不必担心 WYSIWYG 工具无法正常工作。

仅供参考，与 eclipse 捆绑在一起的工具非常有问题。不要指望手机上有什么东西来做任何不重要的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T20:18:26.440

就像其他人写的那样，使用 xml 编辑器编辑布局更容易。您可以在此处阅读更多内容[http://developer.android.com/guide/topics/ui/declaring-layout.html](http://developer.android.com/guide/topics/ui/declaring-layout.html)。

# javascript - jQuery .text() 返回 NaN，这是为什么呢？

> ID：15509013
> 
> 赞同：3
> 
> 时间：2013-03-19T19:45:11.977
> 
> 标签：javascript, jquery

```
$('span#pricetotal').text(function() {
    var val = 0;
    for (var i = 0; i < 15; i++) {
        val += parseInt($('span#itemtotal_' + i).text());
    };
    return val;
}); 
```

我有 15 倍`<span>`，我用 jQuery`text()`函数定价。在上面的代码中，我想计算它们的总和并将其放入`span#pricetotal`.

`(20+20=40)`然而，发生的事情是元素显示而不是添加`2020`。在上面我使用的代码中`parseInt`- 这将返回`NaN`.

我究竟做错了什么？谢谢你。

编辑：元素的 HTML 如下所示：

```
<span id="itemtotal_0">16</span> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:00:52.327

```
$('#pricetotal').text(function() {
    var val = 0;
    for (var i = 0; i < 14; i++) {        
        var value = $.trim($('span#itemtotal_' + i).text());
        val +=parseInt( $.isNumeric(value) ? value : 0);
    };
    return val;
}); 
```

***[演示](http://jsfiddle.net/jDnVy/6/)***

**笔记：**

如果您的跨度包含任何`space`或`non-numeric`数据，这是安全的。在演示中你会发现一个`span`有字母`a`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T19:53:39.397

use condition to check..

try this

```
$('span#pricetotal').text(function() {
  var val = 0;
   for (var i = 0; i < 15; i++) {
      if($('span#itemtotal_' + i).text() != ""){  // <-- check if not empty since empty gives Nan when used pareseInt
        val += parseInt($('span#itemtotal_' + i).text());

      }
   };
 return val;
}); 
```

OR

```
for (var i = 0; i < 15; i++) {
    val += parseInt($('span#itemtotal_' + i).text()) || 0;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T19:56:15.663

它完美地工作：http: [//jsfiddle.net/jDnVy/5/](http://jsfiddle.net/jDnVy/5/)

```
$('span#pricetotal').text(function() {
    var val = 0;
    for (var i = 0; i < 15; i++) {        
        val +=parseInt($('span#itemtotal_' + i).text());

    };
    return val;
}); 
```

请检查您的 itemtotal spans 是否以 开头`itemtotal_0`，而不是`itemtotal_1`

可能是它试图找到`span#itemtotal_0`，但它不存在。请仔细检查。

# c# - 如何从具有不同内容的单个 Android 应用程序创建多个应用程序

> ID：15509018
> 
> 赞同：10
> 
> 时间：2013-03-19T19:45:27.767
> 
> 标签：c#, android, content-management-system

我有两个程序。第一个是桌面应用程序 (C#)，另一个是 android 应用程序。

C# 制作一些文本文件并将它们放在一些 android 应用程序文件夹中。所以我们可以有多个不同内容的安卓应用。android 应用程序是预编译的。并且 c# 应用程序只是将测试文件放入（使用 7za）并重新打包（使用 zipalign）。

问题是，所有这些应用程序都有一个来源！表示相同的包名和相同的应用程序名！

如您所知，android 将相同的包名称视为相同的应用程序！我怎么解决这个问题？并从具有不同文本文件（内容）的单个 android 应用程序创建单独的应用程序

**更多详细信息：** 我有一个 android 应用程序 (test.apk)。我的 C# 应用程序应该编辑这个 zip 文件并重新打包它。将文本文件放在资产文件夹中效果很好。但是通过这种方法，C# app 输出的 apk 都是一样的！我不能将它们单独安装在移动设备上，因为 android OS 会相互替换它们。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-24T21:39:43.583

我发现自己处于类似的境地。

我有一个应用程序，但为不同的客户构建（具有特定的自定义，如资源、属性......）。我最终决定使用 maven 来管理整个事情。

我所做的是在我的代码库中创建一个“配置”文件夹，并在其中添加了专业客户一个文件夹，其中包含与他相关的属性、字符串、图片。

我的结构是这样的：

```
MyAppBase
 src/
 build/
 BaseAndroidManifest.xml
 ...
 config/
   customerA/
      logo.png
      customerA.xml
      customerA.properties
   customerB/
   customerC/
   ... 
```

使用 Maven 工件进行复制、移动、替换然后我设法通过以下方式构建客户特定的 apk：

1) 创建一个临时的客户特定源文件夹，所有代码都复制到其中

```
<copy todir="src_${customer}">
  <fileset dir="src"/>
</copy> 
```

2) 重命名包和导入

```
<!-- Rename main package -->
<move file="src_${customer}/ch/wizche/myapp" tofile="src_${customer}/ch/wizche/${customer}"/>
<!-- Replace package imports with the newly one -->
<replace dir="src_${customer}/" value="ch.wizche.${customer}">
  <include name="**/*.java"/>
  <replacetoken>ch.wizche.myapp</replacetoken>
</replace> 
```

3）根据客户更换特定资源

```
<!-- Copy images icon to the drawable folder -->
<copy file="./configs/${customer}/ic_launcher_l.png" tofile="./res/drawable-ldpi/ic_launcher.png" overwrite="true" verbose="true"/>
<copy file="./configs/${customer}/ic_launcher_m.png" tofile="./res/drawable-mdpi/ic_launcher.png" overwrite="true" verbose="true"/> 
```

4) 替换“模板”AndroidManifest 并注入客户版本、名称、...

```
 <copy file="./BaseAndroidManifest.xml" tofile="./AndroidManifest.xml" overwrite="true" verbose="true"/>
 <replace file="./AndroidManifest.xml" value="ch.wizche.${customer}" token="ch.wizche.myapp"/>
 <replace file="./AndroidManifest.xml" value="android:versionCode="${versionCode}" token="android:versionCode="1"/> 
```

5) 使用客户别名签名

6) 构建 APK

7) 删除​​临时客户文件夹

因此，要构建客户特定的应用程序，我只需要：

```
mvn install -Dcustomer=customerA -P release 
```

希望这可以给你一些意见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T21:02:34.303

我有一个类似的问题，我想要多个具有不同图形分辨率的 apk（一个包含所有显示尺寸的所有图像的单个 apk 太大）。

我最终创建了一个自定义构建过程，我在其中插入了一个“预构建”AntTask，它基本上复制了构建的正确资源并预处理了源代码，以便为每个 apk 更新包。

找不到任何官方文档，但这应该是一个好的开始.. [using-ant-to-automate-building-android](http://www.androidengineer.com/2010/06/using-ant-to-automate-building-android.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T20:16:17.493

您可以尝试分发未签名的 .apk，然后使用 C# 应用程序中的不同密钥对其进行签名。我已经使用 signapk.jar 从命令行对未签名的 .apk 进行签名。

风险在于您将私钥分发给您的客户。如果这不是问题，因为从某种意义上说，他们正在使用您的工具构建自己的应用程序，那么可能值得一试。

有关更多信息，请参见以下几行：

[如何签署 APK Zip 文件](http://www.londatiga.net/general/how-to-sign-apk-zip-files)

[Windows 上没有 Eclipse 的 Android 应用程序代码签名](https://stackoverflow.com/questions/12017746/android-app-code-signing-without-eclipse-on-windows/12017766#12017766)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-24T21:44:37.230

[How to support multiple android version in your code?](https://stackoverflow.com/questions/4552250/how-to-support-multiple-android-version-in-your-code/12542812#12542812)对此有很好的讨论？，它着眼于创建应用程序的多个版本。答案包含执行此操作的明确策略以及所涉及过程的详细信息。

# javascript - 如何在 Backbone 代码库中强制“使用严格”？

> ID：15509019
> 
> 赞同：0
> 
> 时间：2013-03-19T19:45:29.820
> 
> 标签：javascript, jquery, backbone.js

想想当你有很多视图、模型、集合和一个路由器并且你使用`Require.js`

有没有更好的方法`use strict`通过将其指定为配置或设置而不是这样做来在整个代码库中强制执行？

![在此处输入图像描述](../Images/ff90a94fa6d3906e4cf5ed622e2ab751.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T22:44:25.953

您可以在函数内部或外部声明“使用严格”，但无论哪种方式，它都只适用于您声明它的文件；没有“全局使用严格”。

就我个人而言，我只是配置我的 IDE (Eclipse) 以在我的新文件模板中为我写出“使用严格”，但如果你不喜欢这样做，你可以总是（正如 WiredPrairie 建议的那样）在某种形式的“编译”步骤。

# php - preg_replace 用于替换字符串中的数值

> ID：15509023
> 
> 赞同：0
> 
> 时间：2013-03-19T19:45:40.227
> 
> 标签：php, preg-replace

语言使用 PHP TimeString = 1500-1550

我想使用 preg_replace 将字符串的 1550 的一半更改为 1530。我尝试使用模式`(/d|/d/d)50` 我遇到困难的地方是我不知道如何使用替换功能来更改任何 /d50 或 /d/d50有一个 30 后缀。我不想在 php 中起诉 str replace，因为它会在 50 场比赛后第一次将 1500 更改为 130。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:05:36.313

这里..

```
<?php
    $numbers = array (1500, 1550, 140, 150, 15000);
    foreach ($numbers as $number) {
        echo preg_replace('/(\d|\d\d)50\b/', '${1}30', $number);
        echo "\n";
    }
?> 
```

将返回：

```
1500
1530
140
130
15000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T19:47:54.323

要匹配您需要使用的数字`\d`。不是`/d`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T19:47:53.373

```
preg_replace('/(\d\d)50/', '${1}30', $string) 
```

# java - 用于管理顺序命令列表的数据结构/Java 技术

> ID：15509026
> 
> 赞同：2
> 
> 时间：2013-03-19T19:45:46.423
> 
> 标签：java, sql, design-patterns, data-structures, middle-tier

我不确定这个用例是否存在特殊的东西——但感觉就像有人可能已经做出了某种有用的结构/技术/设计模式的情况。

**我的情况**

*   我有一组从中间层（Java）执行的 SQL 命令，通过来自相关临时表的连接将数据插入/更新/删除到一组非常大的表中的任何一个。

*   我有更多的 SQL 命令可以根据临时表/实际表内容更新各种派生表。不同的表将通过不同的查询与不同的派生表交互（像往常一样）。根据用例，这些命令可能必须与第一组交错 - 所以，我不一定要同时执行 set 1 然后 set 2 。

**我的问题**

所以，我需要构建一个顺序执行的命令链，如果其中任何一个失败，我需要触发回滚。我想以最清晰、有记录的方式做到这一点。

*有谁知道这种编码的标准方法？我敢肯定，任何从存储过程代码迁移到中间层代码的人以前都这样做过，如果有好的选择，我不想重新发明轮子。*

* * *

**附加信息**

我的主要担忧之一是让一切变得清晰。为了详细说明，我将有一组专门用于：

*   截断临时表 A' 并使用针对删除记录的主键填充它
*   根据与 A' 的连接从实际表 A 中删除
*   截断登台表 A' 并用完整数据填充它以进行更新插入
*   根据连接将记录从 A' 更新/插入到 A

相同的逻辑将适用于表 B、C、D 等。不幸的是，可能只有 A 和 C 需要额外的步骤，例如将删除同步到某个派生表，在删除之后但在删除之前完成更新。

我显然想对更新表的所有逻辑进行分组，我也想对更新派生表的所有逻辑进行分组，但在执行时它们必须智能交错，这对我来说听起来很乱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T19:49:05.983

不要自己写这样的东西。这就是[JTA](https://stackoverflow.com/questions/1647844/java-transaction-api-jta-overview-help)的诞生。

您可以使用[JPA](http://www.ibm.com/developerworks/java/library/j-ts2/index.html)或[Spring](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/transaction.html)来执行此操作。

将工作单元注释为事务性的，让数据库和 JDBC 处理它。

如果您必须自己做，请遵循面向方面的方法，并使其成为装饰性的“前后”实现。

# database - DBIx::Class 中的填充和创建方法有什么区别？

> ID：15509030
> 
> 赞同：0
> 
> 时间：2013-03-19T19:46:03.113
> 
> 标签：database, perl, dbix-class

有人可以解释在哪些情况下我必须在 DBIx::Class 的 ResultSet 上使用`create`或方法吗？`populate`如果每个人都习惯于向数据库插入一些数据，那么彼此之间有什么区别？

**例如，**UPD 。**我必须向 table1 插入一些数据。它有创建和填充方法。所以`create`如果有任何关系我必须使用，否则我必须使用`populate`，不是吗？**

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T19:48:10.797

创建插入一行（以及可能在其他表中关联的行）。填充插入多行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-19T11:31:29.903

作为补充信息和预防措施：

插入总是有效的（并且通常如预期的那样）。您可以使用它来插入许多表，问题是性能。

插入大量数据时，填充速度要快得多。然而，它有时会表现得很奇怪，所以你应该仔细测试它（就像一切一样;））。通常，它工作正常，但是当您插入数千个条目时，您会注意到速度显着提高。**

# powershell - 批量创建 AD 帐户

> ID：15509031
> 
> 赞同：-3
> 
> 时间：2013-03-19T19:46:04.817
> 
> 标签：powershell, active-directory

我有一个包含大量姓名（学生）的 CSV，基本上想在 AD 中为他们创建帐户 - 将它们放在默认组中，并为它们提供所有相同的密码。

如何在 Powershell 中做到这一点？或任何其他命令行工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T19:58:10.827

您可以安装[RSAT 工具](http://www.microsoft.com/en-us/download/details.aspx?id=7887)中的 Active Directory Powershell 模块， 然后将 csv 导入对象数组，并使用 AD 模块创建用户。就像是：

```
Import-CSV c:\yourfile.csv | Foreach-Object {
    New-ADUser -Name $_.Name -AccountPassword $_.AccountPassword -WhateverParameter $_.SomevaluefromCSV
} 
```

这不是一个要求完整解决方案的地方，所以这就是我想去的地方，所以我不鼓励其他人提出这个“开放”的问题。

# python - 使用python查找单词的评分

> ID：15509039
> 
> 赞同：2
> 
> 时间：2013-03-19T19:46:29.287
> 
> 标签：python, regex, python-2.7

这是我的程序，如果我给出完整的名称，就像我输入一样`eng`，它会显示值，而不是只显示`eng`值

```
import re
sent = "eng"
#sent=raw_input("Enter word")
#regex = re.compile('(^|\W)sent(?=(\W|$))')
for line in open("sir_try.txt").readlines():
    if sent == line.split()[0].strip():
        k = line.rsplit(',',1)[0].strip()
        print k
gene name        utr length
ensbta                  24
ensg1                   12
ensg24                  30
ensg37                  65
enscat                  22
ensm                    30 
```

实际上我想做的是我想搜索`highest value from the text file`不通过单词，它从文本文件中删除相同单词的所有值，其值小于上面应该`12 , 30`为 ensg 删除的文本中的最大值，然后`it should find the minimum value from the utr values and display it with name` 你们的回答是，我已经完成了，我在展示我的程序之前提到了它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:05:20.467

尝试代替`if sent ==`并将其替换为`if sent in (line.split()[0].strip()):`

在这种情况下，这应该检查 sent (engs) 的值是否在参数 (line.split()[0].strip()) 中的任何位置。

如果你仍然试图只取最高值，我只会创建一个变量值，然后是类似的东西

```
if line.split()[1].strip() > value:
    value = line.split()[1].strip() 
```

测试一下，让我们知道它是如何为您工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:17:17.580

请试试这个

```
file=open("sir_try.txt","r")
list_line=file.readlines()
file.close()
all_text=""

dic={}
sent="ensg"
temp_list=[]
for line in list_line:
    all_text=all_text+line
    name= line.rsplit()[0].strip()
    score=line.rsplit()[1].strip()
    dic[name]=score
for i in dic.keys():
    if sent in i:
        temp_list.append(dic[i])
hiegh_score=max(temp_list)

def check(index):
    reverse_text=all_text[index+1::-1]
    index2=reverse_text.find("\n")
    if sent==reverse_text[:index2+1][::-1][1:len(sent)+1]:
        return False
    else:
        return True

list_to_min=dic.values()
for i in temp_list:
    if i!=hiegh_score:
        index=all_text.find(str(i))
        while check(index):
            index=all_text.find(str(i),index+len(str(i)))
        all_text=all_text[0:index]+all_text[index+len(str(i)):]
        list_to_min.remove(str(i))
#write all text to "sir_try.txt"
file2=open("sir_try.txt","w")
file2.write(all_text)
file2.close()
min_score= min(list_to_min)
for j in dic.keys():
    if min_score==dic[j]:
        print "min score is :"+str(min_score)+" for person "+j 
```

功能检查是针对独奏中的错误，以解释您的文件何时

```
gene name        utr length
ali                     12
ali87                   30
ensbta                  24
ensg1                   12
ensg24                  30
ensg37                  65
enscat                  22
ensm                    30 
```

程序删除阿里分数，但我们没有
通过添加检查功能我解决它
，这个版本是最终版本答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:17:36.427

```
import operator
f = open('./sir_try.txt', 'r')
f = f.readlines()
del f[0]

gene = {}
matched_gene = {}

for line in f:
    words = line.strip().split(' ')
    words = [word for word in words if not word == '']
    gene[words[0]] = words[1]

# getting user input
user_input = raw_input('Enter gene name: ')
for gene_name, utr_length in gene.iteritems():
    if user_input in gene_name:
        matched_gene[gene_name] = utr_length
m = max(matched_gene.iteritems(), key=operator.itemgetter(1))[0]
print m, matched_gene[m]  # expected answer

# code to remove redundant gene names as per requirement

for key in matched_gene.keys():
    if not key == m:
        matched_gene.pop(key)
for key in gene.keys():
    if user_input in key:
        gene.pop(key)

final_gene = dict(gene.items() + matched_gene.items())
out = open('./output.txt', 'w')
out.write('gene name' + '\t\t' + 'utr length' + '\n\n')
for key, value in final_gene.iteritems():
    out.write(key + '\t\t\t\t' + value + '\n')
out.close() 
```

**输出：**

```
Enter gene name: ensg
ensg37 65 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T20:18:15.137

要找出关联最大值（第二列）的名称（第一列），您需要首先在名称和值之间的空白处[拆分](http://docs.python.org/2/library/stdtypes.html#str.split)行。然后您可以使用内置[`max()`](http://docs.python.org/2/library/functions.html#max)函数找到最大值。让它以值列作为排序标准。然后，您可以轻松找到相应的名称。

例子：

```
file_content = """
gene name        utr length
ensbta                  24
ensg1                   12
ensg24                  30
ensg37                  65
enscat                  22
ensm                    30
"""

# split lines at whitespace
l = [line.split() for line in file_content.splitlines()]

# skip headline and empty lines
l = [line for line in l if len(line) == 2]

print l

# find the maximum of second column
max_utr_length_tuple = max(l, key=lambda x:x[1])

print max_utr_length_tuple

print max_utr_length_tuple[0] 
```

输出是：

```
$ python test.py
[['ensbta', '24'], ['ensg1', '12'], ['ensg24', '30'], ['ensg37', '65'], ['enscat', '22'], ['ensm', '30']]
['ensg37', '65'] 
ensg37 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-19T20:34:19.973

简短而甜蜜：

```
In [01]: t=file_content.split()[4:]
In [02]: b=((zip(t[0::2], t[1::2])))
In [03]: max(b, key=lambda x:x[1])
Out[03]: ('ensg37', '65') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T06:25:10.460

既然你已经标记了你的问题[regex](/questions/tagged/regex "显示标记为“正则表达式”的问题")，
这是你想看到的东西，它是（目前）唯一使用 regex 的东西！

```
import re

sent = 'ensg' # your sequence
# regex that will "filter" the lines containing value of sent  
my_re = re.compile(r'(.*?%s.*?)\s+?(\d+)' % sent)

with open('stack.txt') as f:
    lines = f.read() # get data from file

filtered = my_re.findall(lines) # "filter" your data
print filtered

# get the desired (tuple with maximum "utr length")
max_tuple = max(filtered, key=lambda x: x[1]) 
print max_tuple 
```

输出：

```
[('ensg1', '12'), ('ensg24', '30'), ('ensg37', '65')]
('ensg37', '65') 
```

# c# - 实体框架返回空子，底层SQL没问题

> ID：15509042
> 
> 赞同：1
> 
> 时间：2013-03-19T19:46:42.237
> 
> 标签：c#, linq, entity-framework

我目前在使用连接到普遍数据库的实体框架时遇到空子值的奇怪问题。我是相当新的 EF，所以我的术语可能是错误的。

我有两个类，我们称它们为 Parent 和 Child。这是它们的设置方式：

```
public class Parent
{        
    public int ParentUK { get; set; }
    public int ParentName { get; set; }
    public int Status { get; set; }
    public virtual IList<Child> Children { get; set; }
} 
```

带有映射文件

```
public class Parent_Map : SchemaNameEntityTypeConfiguration<Parent>
{
    public Parent_Map(string schemaName)
        : base(schemaName)
    {
        ToTable("Parent");
        HasKey(p => p.ParentUK);

        Property(p => p.ParentUK)
            .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);

        Property(p => p.ParentName)
            .IsRequired();

        Property(p => p.Status)
            .IsRequired();

        HasMany(p => p.Children)
            .WithRequired()
            .HasForeignKey(c => c.ParentUK);
    }
} 
```

还有儿童班

```
public class Child
{
    public int ParentUK { get; set; }        
    public int Sequence { get; set; }
    public int ChildName { get; set; }
} 
```

映射：

```
public class Child_Map : SchemaNameEntityTypeConfiguration<Child>
{
    public Child_Map(string schemaName)
        : base(schemaName)
    {
        ToTable("Child");

        HasKey(t => t.ParentUK);
        HasKey(t => t.Sequence);

        Property(t => t.ParentUK)
             .IsRequired();

        Property(t => t.Sequence)
             .IsRequired();

        Property(t => t.ChildName)
             .IsRequired();

     }
} 
```

当我运行以下查询时，我希望得到一个包含 2 个父母和 3 个孩子的列表。

```
var result = context.Parents
     .Include(p => p.Children)
     .Where(p => p.ParentUK < 3);

foreach (var thing in result)
{
     if (thing.Children != null)
     {
          Console.WriteLine(thing.ParentName+ "  has some children " + thing.Children.Count);
     } 
     else
     {
          Console.WriteLine(thing.ParentName+ "  has NO children ");
     }
} 
```

我已经验证了底层 SQL 包括两个表之间的连接并返回 6 行。

我正在努力解决的问题是第一个结果确实包含一个子列表，但第二个结果的列表为空。如果我在单个 ID 之后运行查询，则一切正常，所以我不知道我的映射是否有问题。

如果我以更多结果运行查询，它将类似于

```
P1  has some children 3
P2  has NO children
P3  has NO children
P4  has NO children
P5  has some children 3
P6  has NO children
P7  has NO children
P8  has NO children 
```

如果我使用延迟加载运行查询，我会得到类似的结果，但 P7 会有孩子，而 P5 不会。

这是一个通用示例，但它应该说明我的问题。我真的不确定为什么 EF 正在努力填充列表。它不会抛出任何异常，但我不确定它是否在某处静默记录。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T20:27:31.453

尝试更换...

```
HasKey(t => t.ParentUK);
HasKey(t => t.Sequence); 
```

...经过...

```
HasKey(t => new { t.ParentUK, t.Sequence }); 
```

...这是定义复合键的正确方法。在您的原始映射`HasKey(t => t.Sequence)`覆盖`HasKey(t => t.ParentUK)`中，EF 仅将`Sequence`视为键。

# shell - 编写shell脚本

> ID：15509058
> 
> 赞同：2
> 
> 时间：2013-03-19T19:47:48.110
> 
> 标签：shell

我想编写一个 shell 脚本，它将从标准输入读取文件，删除所有字符串和空行字符，并将输出写入标准输出。该文件如下所示：

```
#some lines that do not contain <html> in here
<html>a<html>
<tr><html>b</html></tr>
#some lines that do not contain <html> in here
<html>c</html> 
```

因此，输出文件应包含：

```
#some lines that do not contain <html> in here
a
<tr>b</html></tr>
#some lines that do not contain <html> in here
c</html> 
```

我尝试编写这个 shell 脚本：

```
read INPUT #read file from std input
tr -d '[:blank:]'
grep "<html>" | sed -r 's/<html>//g'
echo $INPUT 
```

但是这个脚本根本不起作用。任何的想法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:54:48.497

awk 可以轻松做到：

```
awk '/./ {gsub("<html>","");print}' INPUTFILE 
```

首先，它对至少有一个字符的每一行进行操作（因此空行被丢弃），并用`<html>`该行上的一个空字符串全局替换“”，然后打印它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:03:10.027

纯重击：

```
#!/bin/bash

while read line
do
    #ignore comments
    [[ "$line" = "\#" ]] && continue
    #ignore empty lines
    [[ $line =~ ^$ ]] && continue
    echo ${line//\<html\>/}
done < $1 
```

输出：

```
$ ./replace.sh input
#some lines that do not contain in here
a
<tr>b</html></tr>
#some lines that do not contain in here
c</html> 
```

纯sed：

```
sed -e :a -e '/^[^#]/N; s/<html>//; ta' input | sed '/^$/d' 
```

# javascript - 将 Facebook 的 FB.api 包含到 jquery 函数中

> ID：15509059
> 
> 赞同：0
> 
> 时间：2013-03-19T19:47:50.293
> 
> 标签：javascript, jquery, facebook, facebook-graph-api, facebook-javascript-sdk

是否可以将 Facebook 的*postLike 函数包含*到下面的 jquery 代码中以处理**按钮单击或提交**？

```
function postLike(){FB.api("/me/og.likes","post",{object:"http://test.com/test"})}

$(".bookmark_form").live("submit",function(a){a.preventDefault();$.post("/",
$(this).serialize(),function(){$("#buddy").html("&nbsp;");
$.ajax({url:$("#buddy").attr("rel"),
dataType:"html",success:function(c){$("#buddy").html(c)}});return false})}); 
```

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:01:58.077

是的，很有可能。

包括 JS SDK。包括 jQuery。

```
$(document).ready(function(){

$("#id of button").click(function(){
   FB.api('/me/og.likes',{object:'URL OF YOUR OPEN GRAPH OBJECT'}, function(response){
    if(response){
       alert(Success! It was liked!");
    }else{
       alert("Failure! Something went wrong.");
    }
  });
});

}); 
```

在*您的 OPEN Graph OBJECT 的 URL*上，您必须通过[Open Graph Protocol实现一个对象](https://developers.facebook.com/docs/opengraphprotocol/)

# c++ - msvc 相当于 gcc 的 __BASE_FILE__

> ID：15509061
> 
> 赞同：8
> 
> 时间：2013-03-19T19:47:52.537
> 
> 标签：c++, visual-c++, gcc, macros

`__BASE_FILE__`在 Visual C++ 中是否有任何等价物？我想知道*当前*由 VC++ 编译的文件的名称。

注意：`__FILE__`扩展为当前文件，例如它可能是`#include`s 之一。

* * *

来自 gcc 的文档：

`__BASE_FILE__`

此宏以 C 字符串常量的形式扩展为主输入文件的名称。这是在调用 C 编译器时指定为参数的源文件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-06-20T08:03:39.100

感谢约翰的评论，这是一个解决方法。如果您简单地说`__BASE_FILE__=%(Filename)`，它不会生成文字字符串。所以把它放在双引号之间；我还添加了扩展名，因为 %(Filename) 没有它。

```
__BASE_FILE__="%(Filename)%(Extension)" 
```

这一行必须写在项目属性页的预处理器页中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T19:57:20.770

看起来没有等价物：http: [//msdn.microsoft.com/en-us/library/b0084kay%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/b0084kay%28v=vs.80%29.aspx)

# node.js - phpstorm/webide - node.js下的coffeescript调试器

> ID：15509069
> 
> 赞同：0
> 
> 时间：2013-03-19T19:48:22.380
> 
> 标签：node.js, coffeescript, phpstorm, web-ide

jetbrains 最近发表[的关于如何使用 sourcemaps 调试咖啡脚本的博客文章](http://blog.jetbrains.com/webide/2013/03/coffeescript-debugging-with-sourcemaps-in-webstorm-6-phpstorm-6/)。

不幸的是，这种方法只能用于调试在某些 html 页面中运行的标准 javascript（如何在文章末尾看到），而不是 node。

我在我的节点项目中确实需要这个功能，现在有人如何在 node.js 中使用它吗？

# reverse-proxy - svn 支持反向代理（磅）选项授权失败

> ID：15509071
> 
> 赞同：1
> 
> 时间：2013-03-19T19:48:30.127
> 
> 标签：reverse-proxy

如何在[磅](http://linux.die.net/man/8/pound)上实现 WebDav 支持？

错误：

> svn：“[repo]”的选项“授权失败”

我找不到任何例子。我所拥有的`unknown directive`

```
ListenHTTPS
        Address 192.168.1.200
        Port 443
        Cert "/etc/pound/server.pem"
        WebDav 1
        HTTPSHeaders 1 "Front-End-Https: on"'

        Service
                HeadRequire "Host: .*svn.mydomain.com.*"
                BackEnd
                        Address 192.168.1.21
                        Port    80
                End
        End
        Service
                HeadRequire "Host: .*svn.mydomain.org.*"
                BackEnd
                        Address 192.168.1.21
                        Port    80
                End
        End
End 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:07:44.507

解决方案`xHTTP 2`

```
ListenHTTPS
        Address 192.168.1.200
        Port 443
        Cert "/etc/pound/server.pem"

        xHTTP 2

        Service
        ... 
```

来自`man pound`（*谁知道手册有有用的信息？*）：

```
xHTTP value
              Defines which HTTP verbs are accepted. The possible values are:
              ...
              2  additionally  allow  standard WebDAV verbs (LOCK, UNLOCK, PROPFIND, PROPPATCH, SEARCH, MKCOL, MOVE, COPY, OPTIONS, TRACE, MKACTIVITY, CHECKOUT, MERGE, REPORT).
               ... 
```

# c# - DataGridView 只读“错误”

> ID：15509073
> 
> 赞同：3
> 
> 时间：2013-03-19T19:48:35.493
> 
> 标签：c#, .net, winforms, datagridview

我有一个`datagridview`显示一些数据。数据之间的某些行是`separator rows`这样的`readonly`。在某些情况下，整体`datagridview`可能是`readonly`. 但是当我将它切换回时`readonly = false`，所有行都是可编辑的。是否有可能不必`readonly`手动重新设置每一行的属性，我的行会像以前一样返回？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T11:40:46.207

据我所见，使用反射器，设置`DataGridView.ReadOnly`为`true`也将设置`ReadOnly`为`false`网格中的所有行和列 - 大概假设您以后永远不会再设置`DataGridView.ReadOnly`为`false`。

所以我能看到你解决这个问题的唯一方法是“记住”哪些行应该是只读的，例如通过在 中设置一个合适的值，然后使用它来手动`DataGridViewRow.Tag`恢复状态。`ReadOnly`

例如，如果您将`DataGridViewRow.Tag`属性设置`true`为只读行，则可以使用`DataGridView.ReadOnlyChanged`类似于以下未经测试的代码的处理程序来处理事件：

```
void DataGridView_ReadOnlyChanged(object sender, EventArgs e)
{
    DataGridView dataGridView = (DataGridView) sender;
    if (!dataGridView.ReadOnly)
    {
        // DataGridView.ReadOnly has just been set to false, so we need to 
        // restore each row's readonly state.
        foreach(DataGridViewRow row in dataGridView.Rows)
        {
            if (row.Tag != null && ((bool)row.Tag))
            {
                row.ReadOnly = true;
            }
        }
    }
} 
```

然而，似乎很明显，它的`DataGridView`设计并不是为了允许`ReadOnly`以这种方式切换其属性。也许您可以设计您的应用程序，这样您就不需要设置`DataGridView.ReadOnly`为`true`？

例如，如果您想阻止用户通过双击单元格进行编辑，您可以设置`DataGridView.EditMode`为`DataGridViewEditMode.EditProgramatically`而不是设置`DataGridView.ReadOnly`为`true`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:09:23.277

如果该类是由您自己实现的，那么您可以设置您`DataGrid1.ReadOnly = true`的属性并使属性 ReadOnly 需要为 ReadOnly。

像这样：

```
string _myProperty;
public string MyProperty
{
   get{return _myProperty;}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:35:22.120

如果您使用代码手动填充 DataGridView 而不是将其绑定到 DataSource，那么您可以在添加时简单地将行的 readonly 属性设置为 true。

如果上述方法不起作用，那么我不明白您的代码实际上做了什么，就像@Dilshod 所说，如果您发布它会很方便，或者至少链接到它的要点（[http://www.gist .github.com](http://www.gist.github.com)）。

# google-chrome - 内容脚本与后台页面之间的通信，Manifest v2（Chrome 扩展）

> ID：15509079
> 
> 赞同：0
> 
> 时间：2013-03-19T19:48:52.020
> 
> 标签：google-chrome, google-chrome-extension

我一直在尝试从我的内容脚本与背景页面（对于 XHR）进行通信，但是，我什至无法建立通信。

**这是content_script.js**的一个片段

 **```
$('.genericStreamStory').each(function(){
       var link = $(this).find('.uiStreamSource a').attr('href');

       $(this).find('.uiStreamFooter').append("<span class='a1' style='color:red !important;'> · Sample</span>");
       document.querySelector('.a1').onclick=function(){

                            //alert('span clicked');
            chrome.extension.sendMessage({method: "getHTML", data: 'hello'});

       };//end of anonymous function
    }); 
```

**返回.js**

```
chrome.extension.onMessage.addListener(function(request, sender, sendResponse) {
   if (request.method === "getHTML") {
     console.log('check.. '+request.data);
     }
  }); 
```

最后是**manifest.json**

```
{
"name": "App1",
"version": "0.1",

"description": "Yay, I'm so useless.",

"content_scripts": [
    {
        "matches": ["https://*.facebook.com/*"],
        "js": [
                "/js/external/jquery.js", 
                "/js/content_script.js"
            ]
    }
],

"background": {
    "scripts": ["/js/back.js"]    
},

"manifest_version": 2
} 
```

所以这个扩展基本上试图在每个 Facebook 帖子之后创建一个“跨度”。当我单击 Span 元素时，我会在警报框中收到消息（我现在已经评论过）。理想情况下，此操作应与我的 back.js 页面进行通信。

在 back.js 中，我将内容脚本发送的消息记录到控制台。

**但是，我在控制台屏幕上什么也没有！**

我尝试了以下方法：

1.  我用 onRequest 和 sendRequest 替换了 onMessage 和 sendMessage。出现[端口错误](https://stackoverflow.com/questions/11913575/port-error-while-changing-chrome-extension-from-manifest-v1-to-v2/13565529#13565529)
2.  还尝试从替换内联脚本的 .js 文件加载外部脚本。- 空白控制台！

我的代码中有错误吗？我在哪里犯错？**

# c++ - 返回值时程序崩溃的一些可能原因是什么？

> ID：15509080
> 
> 赞同：-2
> 
> 时间：2013-03-19T19:48:53.303
> 
> 标签：c++, crash, return

我有一堆代码大致相当于这个：

```
bool test(double e, short a, short b, short c) {
    // Things being calculated here...
    cout << "debug_3" << endl;
    return (1 - abs(cos_th)) < (1 - cos(e));

}

int main() {

// something...

 cout << "debug_0" << endl;
        if(test(e,1,2,0)) {
            cout << "debug_4" << endl;
            // Bunch of useful operations...
        }

// something...

} 
```

运行代码生成输出：

```
debug_3 
```

之后程序崩溃（在 Windows 中显示“程序已停止工作...”）。我从来没有遇到过价值回报崩溃，我不知道是什么原因造成的，也不知道如何修复它。对这个问题有什么想法吗？

编辑：更多信息：

在我的构建中，我还验证 和 的值`cos_th`是否`e`有效。

人们似乎指出第二件事是问题的根源，但是当我通过调用`test()`...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:07:16.177

我们唯一可以在不知道是什么的情况下解决的问题`system`是更改 和 的类型，因为`a` `b`它们只是数组索引，并确保它们在数组范围内。您可能还需要确保这不为零，因为您除以结果：`c``unsigned short`

```
sqrt((Xca*Xca+Yca*Yca+Zca*Zca)*(Xba*Xba+Yba*Yba+Zba*Zba)) 
```

使用`cerr`而不是`cout`确保输出已刷新，但您仍然看不到`debug 4`.

将更多输出放在 else 条件内或`if`: 之后，也许函数返回 false？

如果无法准确定位错误，请使用调试器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:22:37.697

返回时崩溃通常意味着您的函数覆盖了堆栈（因此覆盖了返回地址）并且您的程序无处跳转。您可以通过在反汇编级别逐条指令来验证这一点。

# c++ - C++ 中的 normrnd 函数

> ID：15509081
> 
> 赞同：3
> 
> 时间：2013-03-19T19:48:54.137
> 
> 标签：c++, random

在 MATLAB 中，函数***normrnd(mu,sigma)***用于生成正态随机数。它在 C++ 中的等效函数是什么以及在哪个库下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T19:51:33.923

查看[随机](http://en.cppreference.com/w/cpp/numeric/random)库，这是一个示例：

```
#include <iostream>
#include <iomanip>
#include <string>
#include <map>
#include <random>

int main()
{
    std::random_device rd;

    //
    // Engines 
    //
    std::mt19937 e2(rd());
    //std::knuth_b e2(rd());
    //std::default_random_engine e2(rd()) ;

    //
    // Distribtuions
    //
    std::normal_distribution<> dist(2, 2);
    //std::student_t_distribution<> dist(5);
    //std::poisson_distribution<> dist(2);
    //std::extreme_value_distribution<> dist(0,2);

    std::map<int, int> hist;
    for (int n = 0; n < 10000; ++n) {
        ++hist[std::round(dist(e2))];
    }

    for (auto p : hist) {
        std::cout << std::fixed << std::setprecision(1) << std::setw(2)
                  << p.first << ' ' << std::string(p.second/200, '*') << '\n';
    }
} 
```

这是[normal_distribution的特定页面](http://en.cppreference.com/w/cpp/numeric/random/normal_distribution/normal_distribution)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T19:50:40.197

您可以将 Boost.Random 与[正态分布](http://www.boost.org/doc/libs/1_53_0/libs/math/doc/sf_and_dist/html/math_toolkit/dist/dist_ref/dists/normal_dist.html)一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T11:34:46.167

如果你只是想写你自己的...

```
double normrnd(double mean, double stdDev) {
    double u, v, s;
    do {
        u = ((double)rand()/(double)RAND_MAX) * 2.0 - 1.0;
        v = ((double)rand()/(double)RAND_MAX) * 2.0 - 1.0;
        s = u * u + v * v;
    } while (s >= 1 || s == 0);
    double mul = sqrt(-2.0 * log(s) / s);
    return mean + stdDev * u * mul;
} 
```

从[http://en.wikipedia.org/wiki/Marsaglia_polar_method#Implementation的算法简化](http://en.wikipedia.org/wiki/Marsaglia_polar_method#Implementation)

# php - JQuery POST 在 PHP 脚本中显示为空数组

> ID：15509084
> 
> 赞同：1
> 
> 时间：2013-03-19T19:49:01.547
> 
> 标签：php, javascript, ajax, post

在 JS 文件中，我正在执行此功能：

```
$(function() {
    $(".button").click(function() {

        //get the button's ID (which is equal to its row's report_id)
        var emergency = this.id;
        var button = this.attributes['name'].value;
        var dataString = 'reportid=' + emergency;

        alert(dataString);
        if (button == "clockin") {
            $.ajax({
                type: "POST",
                url: "/employeetimeclock.php",
                data: dataString,
                success: function() {
                    window.location = "/employeetimeclock.php";
                }
            });
        } else if (button == "closereport") {
            var r = confirm("Are you sure you want to close this report?\nThis action CANNOT be undone!");
            if (r == true) {
                $.ajax({
                    type: "POST",
                    url: "/closeemergencyreport.php",
                    data: dataString,
                    success: function() {
                        alert("Report Successfully Closed!");
                        window.location = "/closeemergencyreport.php";
                    },
                    error: function() {
                        alert("An error has occured, the report was not closed");
                    }
                });
            } else {
                alert("Report was not closed.");
            }
        }
    });
}); 
```

对于 else if（到 closeemergencyreport.php），该 php 脚本中的代码如下：

```
<?php

require_once("models/config.php");
require_once("models/header.php");
require_once("models/dbconnect.php");

$reportid = $_POST['reportid'];

var_dump($_POST);

$sql = "UPDATE emergency_report SET report_closed = '1' WHERE report_id IN ( $reportid )";
//execute and test if succesful
$result = mysql_query($sql) or die(mysql_error());
if($result){
} else{
}
?> 
```

我在其他 3 个页面上做了同样的事情，它完美地工作，但这给我带来了麻烦，在那个 php 脚本上 VAR_DUMP 说它返回一个空数组。我已经阅读和重新阅读代码大约一个半小时了，所以我认为我已经筋疲力尽了，需要有一个外部的看法。我已经遍及整个网站，没有人找到适合我的解决方案。

我知道它正在发布，因为火虫在运行 javascript 的表单页面上显示了这个：http:
[//i.imgur.com/hItdVU1.png](http://i.imgur.com/hItdVU1.png)（抱歉不能发布图片）

# javascript - .append() 和 .empty() 上的问题

> ID：15509088
> 
> 赞同：0
> 
> 时间：2013-03-19T19:49:10.563
> 
> 标签：javascript, jquery

我有以下代码，如果单击#test 按钮，将在#currentActivities 中生成内容。还有另一个#hide 按钮，可以简单地隐藏#currentActivities 的内容。我的问题是如果我第一次单击#test，我可以获得内容。当我单击#hide 时，#currentActivities 的内容可以按预期隐藏。但是，如果我再次单击#test，则无法生成内容。我曾尝试`$('#currentActivities').empty();`在开始时添加，但似乎不起作用。谁能帮助我并指出我的问题？

```
$("#test").click(function() {

    $('#currentActivities').empty();

    $.ajax({
        type: "GET",
        dataType: "jsonp",
        jsonpCallback: "jsoncallback",
        data: {
            //some data here            
        },
        url: "http://mydomain.com/check.php?jsoncallback=?",
        success: function(data) {

            $.each(data, function(index, student) {
                $('#currentActivities').append(
                    '<li><a href="tutor_student_detail.html" data-name="' + data[index].data.NameA + '">' +
                    '<h4>' + data[index].data.NameA + '</h4>' +
                    '<p>' + data[index].data.NameA + '</p>' +
                    '</a></li>');

                $("li a").click(function() {
                    window.localStorage["view"] = $(this).data('name');
                    window.localStorage["Request"] = "true";
                }); //end of li a

            });
            $('#load2').hide();
            $('#filter').show();
            $('#currentActivities').listview('refresh');
        },
        error: function(jqXHR, textStatus) {
            alert("Request failed: " + textStatus);
        }
    });

    return false;
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T19:50:25.773

您需要使用委托事件（又名实时事件）。因为您正在使用动态加载的 DOM 元素。

就像是：

```
$('body').on('click', '#test', function() {

   // all code belong to click handler

}); 
```

有关使用委托事件绑定的更多信息，`.on()` *[请参见此处](http://api.jquery.com/on/)*。

**笔记：**

而不是`body`用户所有新加载和附加元素的任何静态容器。

由于您的问题是在 jquery mobile 上，所以我认为对于实时 evnet 委托，您可以尝试以下操作：

```
$('#test').live('click', function() {

 // all codes belong to click hander

}); 
```

另一种方法是：

```
$(document).delegate('#test', 'click', function() {

  // codes

}); 
```

# java - apache commons httpclient 4.23 表单登录问题 不同请求中使用的不同会话cookie

> ID：15509090
> 
> 赞同：0
> 
> 时间：2013-03-19T19:49:24.510
> 
> 标签：java, session, cookies, httpclient

我有一个受保护的资源，需要我登录。我使用具有以下代码块的公共客户端。

```
 HttpClient httpClient = new HttpClient();
    httpClient.getParams().setParameter("http.protocol.cookie-policy", CookiePolicy.BROWSER_COMPATIBILITY);
    httpClient.getParams().setParameter("http.protocol.single-cookie-header", Boolean.TRUE);

    PostMethod postMethod = new PostMethod("/admin/adminlogon.do");
    postMethod.setRequestEntity(new StringRequestEntity("action=logon&adminUser=admin&adminPassword=password",
            "application/x-www-form-urlencoded",
            "UTF-8"));
    postMethod.addParameter("action","logon");
    postMethod.addParameter("adminUser","admin");
    postMethod.addParameter("adminPassword","password");

    httpClient.executeMethod(postMethod);
    String response2 = postMethod.getResponseBodyAsString(); 
```

以上是我基本上登录的地方。这很好，我得到了一个不错的小 JSESSIONID cookie。

```
 GetMethod get = new GetMethod("/admin/api.do?action=getSomeJson");
    httpClient.executeMethod(get); 
```

当我检查第二个请求的服务器上的逻辑时，我注意到我们使用了不同的 JSESSIONID。因此，get 似乎无法登录。我的印象是 httpClient 管理 cookie 并将相同的 cookie 发回。当我通过 UI 正常登录我的应用程序时，我在每个请求中看到相同的 cookie，只是在此测试代码中没有。

```
 String s = get.getResponseBodyAsString();
    get.releaseConnection(); 
```

我是否需要对 httpClient 做一些事情以确保它在执行 get 请求时使用与第一个 post 请求相同的 cookie？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T06:25:52.220

您对 HTTP 客户端 cookie 行为的假设是正确的。在您的情况下，您不使用相同的 httpClient 实例。要修复它，您只需分配一次 httpClient（在 PostConstructor 中）：

```
 httpClient = new DefaultHttpClient(); // or new HttpClient(); 
```

然后，您使用相同的客户端实例执行调用。客户端将从响应中获取 cookie，将其存储在 cookieStore 中，并与下一个请求一起发送。

[在评论后添加]以下代码适用于我：

```
 httpClient = new DefaultHttpClient();
    // Create a local instance of cookie store
    cookieStore = new BasicCookieStore();
    // Set the store
    httpClient.setCookieStore(cookieStore); 
```

# python - 交叉编译 gcc 失败（Python）

> ID：15509091
> 
> 赞同：0
> 
> 时间：2013-03-19T19:49:31.540
> 
> 标签：python, linux, gcc, cross-compiling

我正在尝试编译 Python 以移植到带有 DD-WRT（DD-WRT v24-sp2（SVN 修订版：14896））的路由器（ASUS RT-N16）。JFFS2（因此 ipkg）和 Optware 不是选项。我需要做一个直接的交叉编译。我是交叉编译的新手。

我尝试遵循这些指示： [http ://www.cnx-software.com/2011/02/04/cross-compiling-python-for-mips-and-arm-platforms/](http://www.cnx-software.com/2011/02/04/cross-compiling-python-for-mips-and-arm-platforms/)

我也尝试了这些方向，但得到了同样的错误（这是我刚刚完成的）： [http ://www.embecosm.com/appnotes/ean9/ean9-howto-newlib-1.0.pdf](http://www.embecosm.com/appnotes/ean9/ean9-howto-newlib-1.0.pdf)

但我不断收到以下信息：

```
majik@ubuntu:~/Desktop/Python-2.7.3$ sudo CC=mipsel-linux-gcc CXX=mipsel-linux-g++ AR=mipsel-linux-ar RANLIB=mipsel-linux-ranlib ./configure -host=mipsel-linux -target=mipsel-linux -prefix=/python
configure: WARNING: if you wanted to set the --build type, don't use --host.
    If a cross compiler is detected then cross compile mode will be used
checking for --enable-universalsdk... no
checking for --with-universal-archs... 32-bit
checking MACHDEP... linux2
checking EXTRAPLATDIR... 
checking machine type as reported by uname -m... i686
checking for --without-gcc... no
checking for mipsel-linux-gcc... mipsel-linux-gcc
checking whether the C compiler works... no
configure: error: in `/home/majik/Desktop/Python-2.7.3':
configure: error: C compiler cannot create executables
See `config.log' for more details 
```

我的 config.log 包含以下内容：

```
This file contains any messages produced by compilers while
running configure, to aid debugging if configure makes a mistake.

It was created by python configure 2.7, which was
generated by GNU Autoconf 2.67\.  Invocation command line was

  $ ./configure -host=mipsel-linux -target=mipsel-linux -prefix=/python

## --------- ##
## Platform. ##
## --------- ##

hostname = ubuntu
uname -m = i686
uname -r = 3.2.0-37-generic-pae
uname -s = Linux
uname -v = #58-Ubuntu SMP Thu Jan 24 15:51:02 UTC 2013

/usr/bin/uname -p = unknown
/bin/uname -X     = unknown

/bin/arch              = unknown
/usr/bin/arch -k       = unknown
/usr/convex/getsysinfo = unknown
/usr/bin/hostinfo      = unknown
/bin/machine           = unknown
/usr/bin/oslevel       = unknown
/bin/universe          = unknown

PATH: /usr/local/sbin
PATH: /usr/local/bin
PATH: /usr/sbin
PATH: /usr/bin
PATH: /sbin
PATH: /bin

## ----------- ##
## Core tests. ##
## ----------- ##

configure:2756: checking for --enable-universalsdk
configure:2797: result: no
configure:2806: checking for --with-universal-archs
configure:2823: result: 32-bit
configure:2980: checking MACHDEP
configure:3129: result: linux2
configure:3135: checking EXTRAPLATDIR
configure:3150: result: 
configure:3161: checking machine type as reported by uname -m
configure:3164: result: i686
configure:3177: checking for --without-gcc
configure:3221: result: no
configure:3242: checking for mipsel-linux-gcc
configure:3269: result: mipsel-linux-gcc
configure:3538: checking for C compiler version
configure:3547: mipsel-linux-gcc --version >&5
./configure: line 3549: mipsel-linux-gcc: command not found
configure:3558: $? = 127
configure:3547: mipsel-linux-gcc -v >&5
./configure: line 3549: mipsel-linux-gcc: command not found
configure:3558: $? = 127
configure:3547: mipsel-linux-gcc -V >&5
./configure: line 3549: mipsel-linux-gcc: command not found
configure:3558: $? = 127
configure:3547: mipsel-linux-gcc -qversion >&5
./configure: line 3549: mipsel-linux-gcc: command not found
configure:3558: $? = 127
configure:3578: checking whether the C compiler works
configure:3600: mipsel-linux-gcc    conftest.c  >&5
./configure: line 3602: mipsel-linux-gcc: command not found
configure:3604: $? = 127
configure:3642: result: no
configure: failed program was:
| /* confdefs.h */
| #define _GNU_SOURCE 1
| #define _NETBSD_SOURCE 1
| #define __BSD_VISIBLE 1
| #define _BSD_TYPES 1
| #define _DARWIN_C_SOURCE 1
| #define _XOPEN_SOURCE 600
| #define _XOPEN_SOURCE_EXTENDED 1
| #define _POSIX_C_SOURCE 200112L
| /* end confdefs.h.  */
| 
| int
| main ()
| {
| 
|   ;
|   return 0;
| }
configure:3647: error: in `/home/majik/Desktop/Python-2.7.3':
configure:3649: error: C compiler cannot create executables
See `config.log' for more details

## ---------------- ##
## Cache variables. ##
## ---------------- ##

ac_cv_env_CC_set=set
ac_cv_env_CC_value=mipsel-linux-gcc
ac_cv_env_CFLAGS_set=
ac_cv_env_CFLAGS_value=
ac_cv_env_CPPFLAGS_set=
ac_cv_env_CPPFLAGS_value=
ac_cv_env_CPP_set=
ac_cv_env_CPP_value=
ac_cv_env_LDFLAGS_set=
ac_cv_env_LDFLAGS_value=
ac_cv_env_LIBS_set=
ac_cv_env_LIBS_value=
ac_cv_env_build_alias_set=
ac_cv_env_build_alias_value=
ac_cv_env_host_alias_set=set
ac_cv_env_host_alias_value=mipsel-linux
ac_cv_env_target_alias_set=set
ac_cv_env_target_alias_value=mipsel-linux
ac_cv_prog_CC=mipsel-linux-gcc

## ----------------- ##
## Output variables. ##
## ----------------- ##

AR='mipsel-linux-ar'
ARCH_RUN_32BIT=''
ARFLAGS=''
BASECFLAGS=''
BLDLIBRARY=''
BLDSHARED=''
BUILDEXEEXT=''
CC='mipsel-linux-gcc'
CCSHARED=''
CFLAGS=''
CFLAGSFORSHARED=''
CONFIGURE_MACOSX_DEPLOYMENT_TARGET=''
CONFIG_ARGS=' '\''-host=mipsel-linux'\'' '\''-target=mipsel-linux'\'' '\''-prefix=/python'\'' '\''host_alias=mipsel-linux'\'' '\''target_alias=mipsel-linux'\'' '\''CC=mipsel-linux-gcc'\'''
CPP=''
CPPFLAGS=''
CXX='mipsel-linux-g++'
DEFS=''
DLINCLDIR=''
DLLLIBRARY=''
DYNLOADFILE=''
ECHO_C=''
ECHO_N='-n'
ECHO_T=''
EGREP=''
EXEEXT=''
EXPORT_MACOSX_DEPLOYMENT_TARGET='#'
EXTRAMACHDEPPATH=''
EXTRAPLATDIR=''
FRAMEWORKALTINSTALLFIRST=''
FRAMEWORKALTINSTALLLAST=''
FRAMEWORKINSTALLAPPSPREFIX=''
FRAMEWORKINSTALLFIRST=''
FRAMEWORKINSTALLLAST=''
FRAMEWORKUNIXTOOLSPREFIX='/python'
GNULD=''
GREP=''
HAS_HG=''
HAVE_GETHOSTBYNAME=''
HAVE_GETHOSTBYNAME_R=''
HAVE_GETHOSTBYNAME_R_3_ARG=''
HAVE_GETHOSTBYNAME_R_5_ARG=''
HAVE_GETHOSTBYNAME_R_6_ARG=''
HGBRANCH=''
HGTAG=''
HGVERSION=''
INSTALL_DATA=''
INSTALL_PROGRAM=''
INSTALL_SCRIPT=''
INSTSONAME=''
LDCXXSHARED=''
LDFLAGS=''
LDLAST=''
LDLIBRARY=''
LDLIBRARYDIR=''
LDSHARED=''
LIBC=''
LIBFFI_INCLUDEDIR=''
LIBM=''
LIBOBJS=''
LIBRARY=''
LIBS=''
LIBTOOL_CRUFT=''
LINKCC=''
LINKFORSHARED=''
LIPO_32BIT_FLAGS=''
LN=''
LTLIBOBJS=''
MACHDEP='linux2'
MACHDEP_OBJS=''
MAINCC=''
OBJEXT=''
OPT=''
OTHER_LIBTOOL_OPT=''
PACKAGE_BUGREPORT='http://bugs.python.org/'
PACKAGE_NAME='python'
PACKAGE_STRING='python 2.7'
PACKAGE_TARNAME='python'
PACKAGE_URL=''
PACKAGE_VERSION='2.7'
PATH_SEPARATOR=':'
PKG_CONFIG=''
PYTHONFRAMEWORK=''
PYTHONFRAMEWORKDIR='no-framework'
PYTHONFRAMEWORKIDENTIFIER='org.python.python'
PYTHONFRAMEWORKINSTALLDIR=''
PYTHONFRAMEWORKPREFIX=''
RANLIB='mipsel-linux-ranlib'
RUNSHARED=''
SGI_ABI=''
SHELL='/bin/bash'
SHLIBS=''
SIGNAL_OBJS=''
SO=''
SOVERSION='1.0'
SRCDIRS=''
SVNVERSION=''
THREADHEADERS=''
THREADOBJ=''
TRUE=''
UNICODE_OBJS=''
UNIVERSALSDK=''
UNIVERSAL_ARCH_FLAGS=''
USE_SIGNAL_MODULE=''
USE_THREAD_MODULE=''
VERSION='2.7'
ac_ct_CC=''
bindir='${exec_prefix}/bin'
build_alias=''
datadir='${datarootdir}'
datarootdir='${prefix}/share'
docdir='${datarootdir}/doc/${PACKAGE_TARNAME}'
dvidir='${docdir}'
exec_prefix='NONE'
host_alias='mipsel-linux'
htmldir='${docdir}'
includedir='${prefix}/include'
infodir='${datarootdir}/info'
libdir='${exec_prefix}/lib'
libexecdir='${exec_prefix}/libexec'
localedir='${datarootdir}/locale'
localstatedir='${prefix}/var'
mandir='${datarootdir}/man'
oldincludedir='/usr/include'
pdfdir='${docdir}'
prefix='/python'
program_transform_name='s,x,x,'
psdir='${docdir}'
sbindir='${exec_prefix}/sbin'
sharedstatedir='${prefix}/com'
sysconfdir='${prefix}/etc'
target_alias='mipsel-linux'

## ----------- ##
## confdefs.h. ##
## ----------- ##

/* confdefs.h */
#define _GNU_SOURCE 1
#define _NETBSD_SOURCE 1
#define __BSD_VISIBLE 1
#define _BSD_TYPES 1
#define _DARWIN_C_SOURCE 1
#define _XOPEN_SOURCE 600
#define _XOPEN_SOURCE_EXTENDED 1
#define _POSIX_C_SOURCE 200112L

configure: exit 77 
```

任何建议将不胜感激。我有我正在尝试编译的系统，但我无法访问路由器，除非我在工作（直到下周二才能回到那里）。但问题出在交叉编译器上。据我了解，一旦编译完成，只需将文件夹复制（通过 scp）到路由器。谢谢！

~BB

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:30:13.333

我想知道您是否在桌面上安装了 mipel-gcc 交叉编译器。

由于路由器具有 mipsel 架构，因此 MIPS 架构采用 Little Endian (MIPSEL) 格式。在编译该架构中的 python 代码之前，您必须安装 mipsel-gcc 交叉编译器。一旦你编译了代码，你就可以在你的路由器上运行代码。

一旦你安装了 mipsel，你可以将它添加到你的路径变量中，代码就可以工作了。

# dom - YUI3 DOM 未定义？

> ID：15509096
> 
> 赞同：1
> 
> 时间：2013-03-19T19:49:44.890
> 
> 标签：dom, yui, javascript, yui3

我是 Javascript 的新手，负责将我们产品的 UI 从 YUI2 迁移到 YUI3。看起来任何地方都没有迁移指南，所以我现在正在浏览互联网帖子和 yui 文档。

在我的全球范围内，我暂时添加了类似

```
var Y = YUI().use('*',function(Y){});
```

我在其他地方遇到了不适用于 YUI3 的 YAHOO.util.Dom.get(...)，看起来 Y.DOM.byId(...) 是推荐的迁移。但是，我收到“Y.DOM”未定义的错误！

谁在使用 Y.DOM.(...)，这是如何解决的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T19:54:24.197

我不知道你从哪里找到的想法`Y.DOM.byId`

尝试

```
var node = Y.one('#elementID'); 
```

或者如果你想使用类：

```
var nodes = Y.all('.className'); 
```

有关如何在 YUI3 中获取节点的更多信息，请参阅他们的[文档](http://yuilibrary.com/yui/docs/node/)

编辑：

```
<script>
YUI().use('node', function (Y) {
    var node = Y.one('#elementID');
});
</script> 
```

# sed - Sed 错误：sed：-e 表达式 #1，字符 25：`s' 的未知选项

> ID：15509098
> 
> 赞同：5
> 
> 时间：2013-03-19T19:50:00.753
> 
> 标签：sed

我有文件 .config 行：
*projdir name_of_the_projdir*
我需要用我自己的变量替换 name_of_the_projdir。我试着用

```
sed -i 's/^projdir .*$/projdir '$projdir'/' .le/.config 
```

但我得到错误

```
sed: -e expression #1, char 25: unknown option to `s' 
```

有人知道该怎么做吗？...我尝试将 first ' 和 last 替换为 " 并且 first 和 alst / 替换为 @ 。但仍然无法正常工作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T20:04:27.443

您会收到该错误，因为`/`您与替换命令一起使用的分隔符与目录分隔符冲突。您可以将它们更改为其他内容：

```
sed -i 's!^projdir .*$!projdir '$projdir'!' .le/.config 
```

# php - PHP最大执行时间

> ID：15509104
> 
> 赞同：2
> 
> 时间：2013-03-19T19:50:33.807
> 
> 标签：php, apache, execution-time, mod-fcgid

在我的 Plesk 11 中，PHP 5.4.7。Apache/2.4.3 系统，当我做 cron 作业时，我从 error.log 文件中得到这个错误。

```
[Tue Mar 19 21:33:18 2013] [warn] [client 88.44.55.66] mod_fcgid: read data timeout in 45 seconds
[Tue Mar 19 21:33:18 2013] [error] [client 88.44.55.66] Premature end of script headers: index.php 
```

所以我用这个检查了执行时间：

```
echo ini_get('max_execution_time'); 
```

我得到了这个值：`1560000`

这似乎不是超时问题，但我收到超时错误？

供将来参考的答案：使用 vim
编辑文件。 更改为。 重启阿帕奇。然后将解决快速 CGI 超时问题。`/etc/httpd/conf.d/fcgid.conf`
`FcgidIOTimeout 45``FcgidIOTimeout 600`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-19T19:55:11.557

那是`mod_fcgid`超时，而不是 PHP 超时。查看[`mod_fcgid`文档](https://httpd.apache.org/mod_fcgid/mod/mod_fcgid.html)以了解如何更改它，尤其是在[`FcgidIOTimeout`](https://httpd.apache.org/mod_fcgid/mod/mod_fcgid.html#fcgidiotimeout).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-19T19:54:53.023

如果构建正确，则 Cron 脚本不应通过 apache 运行。您的错误表明您遇到了 mod_fcgi 设置的超时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T19:54:31.697

如果你通过 cronjob 中的 http 访问它，那么它将作为网页请求工作，然后它可能会受到 apache 超时的影响，因为 apache 参与了该过程。您可以使用 php 解释器以绝对路径直接运行 php 脚本以绕过 apache

# ruby-on-rails - Capybara：使用域而不是基于 IP 的 URL

> ID：15509105
> 
> 赞同：2
> 
> 时间：2013-03-19T19:50:36.570
> 
> 标签：ruby-on-rails, capybara

我的 Rails 应用程序是 Facebook 应用程序，FB 需要域作为应用程序 URL（即，不是带端口的 IP）。

因此，我希望 Capybara 使用

```
http://myapp.test 
```

作为根 URL 而不是

```
http://127.0.0.1:53386 
```

我该如何设置这个环境？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:10:33.740

在你的 spec_helper 或 env.rb

```
Capybara.app_host = 'myapp.test' 
```

# autohotkey - 你如何将 alt0189 发送到 autohotkey

> ID：15509111
> 
> 赞同：1
> 
> 时间：2013-03-19T19:50:48.893
> 
> 标签：autohotkey

在 word 和其他程序中，当您按住 alt 键并在数字键盘上键入 0189 时，您将获得半英寸符号 ½。如何使用热键在自动热键中发送此序列

提前感谢蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:55:10.673

一般来说：发送，{ASC 00189}

我这样做：

```
; ================================== FRACTIONS ==================================
^2::
    Send, ½
    TrayTip, For 2 Squared,press Ctrl + Shift 2,1,1
Return

^3::
    Send, ¾
    TrayTip, For 3 Cubed,press Ctrl + Shift 3,1,1
Return

^4::Send, ¼

; ==================================  POWERS ==================================
+^0::Send, °
+^1::Send, ¹
+^2::Send, ² ; Shift Control 2@
+^3::Send, ³ ; Shift Control 3# 
```

`Ctrl`+2 = ½
`Ctrl`+3 = ¾
`Ctrl`+4 = ¼
`Shift``Ctrl`+ 0 = °
`Shift``Ctrl`+ 1 = ¹
`Shift``Ctrl`+ 2 = ²
`Shift``Ctrl`+ 3 = ³

# javascript - Highcharts 显示钻取图表到不同的容器？

> ID：15509112
> 
> 赞同：0
> 
> 时间：2013-03-19T19:50:54.823
> 
> 标签：javascript, jquery, highcharts

我有一个销售数据，需要在不同的容器中向下钻取到 N 级。

例如：第一个图表将显示国家/地区的销售情况，单击一个国家，它会向下钻取到不同容器中的州级图表，而不是与第一个图表重叠......单击州进一步向下钻取到不同部分的地区级销售。

请帮助我..努力创造一个这样的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T14:24:42.083

下钻基于适当的系列图，因此如果您准备了多个级别的数据点，您可以拥有任何级别的 deep ：

[http://jsfiddle.net/2tjPp/](http://jsfiddle.net/2tjPp/)

```
data = [{
                y: 55.11,
                color: colors[0],
                drilldown: {
                    name: 'MSIE versions',
                    categories: ['MSIE 6.0', 'MSIE 7.0', 'MSIE 8.0', 'MSIE 9.0'],
                    data: [{
                        y: 10.85,
                        drilldown: {
                            name: 'MSIE versions',
                            categories: ['MSIE 6.0', 'MSIE 7.0', 'MSIE 8.0', 'MSIE 9.0'],
                            data: [4,3,2,1],
                            color: colors[0]
                        }
                    },
                    7.35, 33.06, 2.81],
                    color: colors[0]
                }
            }] 
```

# python - 只能得到stderr的第一行

> ID：15509113
> 
> 赞同：0
> 
> 时间：2013-03-19T19:50:55.553
> 
> 标签：python, subprocess, msys, python-3.3

分配我想启动一个进程并检索`stdout`and `stderr`。我真的不关心实时获得这个。

我想使用`subprocess.check_ouput()`，**但**该过程可能会失败。阅读 StackOverflow 和 Python 文档后，我添加了一个`try .. catch`块：

```
def execute(cmd,timeinsec=60):
  print("execute ",cmd, " with time out ",timeinsec)
  try:
    output = subprocess.check_output(cmd, stderr=subprocess.STDOUT, timeout=timeinsec,universal_newlines=True)
  except subprocess.TimeoutExpired:
    print("timeout expired")
    return "",2
  except subprocess.CalledProcessError:
    print("called process failed")
    return "",1
  print ('The command returned the following back to python:'+output)
  return output,0 
```

但是当我打印输出时， `output.decode('utf-8')` 我只得到输出的第一行。

注意：我在 Windows 上随 Msysgit 1.8 分发的 MSys 环境中运行它。

你知道什么是错的吗？你知道有什么更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T21:03:21.103

您必须使用[python-3.x](/questions/tagged/python-3.x "显示标记为“python-3.x”的问题")。请相应地标记您的问题。另外，我不确定您为什么要`read()`调用`output`. 这`output`是一个[字节字符串](http://docs.python.org/3.3/library/subprocess.html#subprocess.check_output)，没有`read()`方法。以下代码适用于我：

```
#! /usr/bin/env python3
import subprocess

try :
    retcode = 0
    cmd = ["/bin/ls", "/usr/local"]
    output = subprocess.check_output(cmd, stderr=subprocess.STDOUT)
except subprocess.CalledProcessError as e:
    output = e.output
    retcode = e.returncode

print(output.decode('utf-8'))
print(retcode) 
```

输出是：

```
bin
etc
games
include
lib
man
sbin
share
src

0 
```

`/usr/local`如果我通过替换为`/usr/localfoo`（不存在）触发错误，则输出为：

```
/bin/ls: cannot access /usr/localfoo: No such file or directory

2 
```

最后，您可以添加[`universal_newlines=True`](http://docs.python.org/3.3/library/subprocess.html#frequently-used-arguments)到`check_output()`调用，而不必担心调用`decode()`输出：

```
...
output = subprocess.check_output(cmd, stderr=subprocess.STDOUT,universal_newlines=True)
...
...
print(output) 
```

请看上面的例子，看看你是否可以让它重现你的问题。如果您可以重现该问题，请发布您的代码、其输出和所有错误消息（复制、粘贴和重新格式化 SO）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T10:41:15.327

**解决方案**

问题是在子进程中启动的 Windows 中的应用程序正在分配一个控制台（使用 Visual 构建），并且该进程的标准输出已经重定向到外部，并且在此重定向之前在原始 cout 中只完成了一次打印

# java - 使用 HSQLDB 第二次加载实体时瞬态字段不为空

> ID：15509115
> 
> 赞同：0
> 
> 时间：2013-03-19T19:51:05.577
> 
> 标签：java, hibernate, jpa, hsqldb, transient

我有一个`Entity`简化的，看起来像这样：

```
@Entity
@Table(name = "SOMETABLE")
public class SomeEntity {

    // real code has id and more columns

    @Column(name = "SOMECOLUMN")
    private String someColumn;

    @Transient
    private SomeObject transientObject;

    // getters and setters
} 
```

`@NamedQuery`DAO 方法通过使用 a和 JPA `EntityManager`（大致存根）加载实体列表：

```
@Transactional
public List<SomeEntity> getSomeEntities() {
    TypedQuery<SomeEntity> query = entityManager.createNamedQuery("findSomeEntities", SomeEntity.class);
    List<SomeEntity> someEntities = query.getResultList();
    for (SomeEntity someEntity : someEntities) {
        someEntity.setTransientObject(<some value here>);
        return someEntities;
    }
} 
```

请注意，此方法还设置`transientObject`（在代码示例中进行了简化）。

下次`getSomeEntities()`调用时，`query.getResultList();`返回`transientObject`仍然设置的对象列表。我希望瞬态对象为空，但事实并非如此。没有启用一级或二级缓存。

为了进一步混淆这一点，这只发生在单元测试期间，我们使用 HSQL 内存数据库。在 Tomcat 服务器上运行 Web 应用程序时，它工作正常。

我调试了一下，我发现在运行单元测试时，**会话缓存**（我理解它总是为 Hibernate 启用）似乎加载了所有以前加载的对象，但在应用程序服务器上运行时它是空的。我怀疑这意味着休眠从缓存而不是数据库中获取对象。

另外值得一提的是它是一个 Spring 应用程序。

**这是什么原因？**或者改写我的主要问题：**为什么第二次使用 HSQLDB 加载实体时瞬态对象不为空？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T00:06:49.577

你在你的测试用例上使用@Transactional 吗？如果是，请尝试删除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:12:46.483

听起来像是与一级缓存/会话缓存有关。

第一级缓存存储会话上下文中的所有对象并重用它。这在您使用应用程序服务器时不会产生影响，因为每个事务都会启动一个新会话。

换句话说，每次调用 DAO 方法都会导致创建一个新会话，这意味着缓存是空的。

要解决此问题，请尝试在第二次通话之前关闭会话并创建一个新会话。

您也可以尝试将它包含在两个不同的事务中。这也可能让它发挥作用。

编辑：回答马格努斯的问题

我真的应该换一种说法。每个休眠会话将在事务结束时关闭。

根据[Session 的休眠文档](http://docs.jboss.org/hibernate/orm/3.5/javadoc/org/hibernate/Session.html)，

> Session 的生命周期受逻辑事务的开始和结束的限制。（长事务可能跨越多个数据库事务。）

从应用服务器的角度来看，在绝大多数情况下（可能是为了实用的所有情况），它无法识别包含多个物理事务的逻辑事务。

因此，它将每个物理事务视为逻辑事务。这意味着会话在每个物理事务结束时关闭。

在`Seam`'s Conversation Scope 和 Java EE 6 中的新 Scopes的上下文中，`@ViewScoped`有争议的是，可以识别跨越多个物理事务的逻辑事务。但是，我不认为它那么简单，也不相信它是以这种方式实现的。但是，无论哪种方式，我都没有任何信息可以证实这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-13T12:08:51.370

这是 Hibernate 一级缓存的效果——它*始终处于*开启状态。一级缓存提供了这种行为：

如果您从同一个 Session 中获取同一行两次，您会从 Session 对象中获得相同的实体实例（即，具有 == 语义）。

听起来您在测试时对 getSomeEntities 的多次调用具有相同的会话 - 但在运行时没有。这让我认为您的测试用例的处理方式与您的应用程序代码不同。

# c# - 从网页获取缩略图

> ID：15509116
> 
> 赞同：6
> 
> 时间：2013-03-19T19:51:07.137
> 
> 标签：c#, asp.net-mvc, image

我有用于从 URL 中获取图像的 C# 代码，`http://i.imgur.com/QvkaduU.jpg`但我将如何从这样的网页中获取图像：`http://imgur.com/gallery/QvkaduU`？

是否有任何“简单”的方法可以做到这一点，或者我将不得不获取 HTML 并构建一个 C# 解析器，该解析器在 HTML 中查找比其他所有图像都大的图像？

让我澄清一下。如果您将`http://imgur.com/gallery/QvkaduU`（HTML 版本）粘贴到例如 Facebook 的状态更新字段中，它将找到主图像并从中制作缩略图，这正是我正在寻找的行为。问题是，这是怎么做到的？我必须编写自己的 HTML 解析器还是有简单的方法来获得它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T15:26:17.007

没有简单的方法可以为任意 URL 获取“好的”缩略图。

Facebook 这样做的算法相当复杂。页面开发人员可以通过向 中添加各种元标记来给出提示`<head>`，包括：

```
<meta property="og:image" content="http://url_to_your_image_here" /> 
```

或者

```
<link rel="image_src" href="http://www.code-digital.co.uk/preview.jpg" /> 
```

（[更多关于这个](http://www.seosmarty.com/how-to-force-facebook-to-grab-the-best-image-from-your-page/)）

...因此，如果您想复制 Facebook 的算法，则需要获取页面源，将其解析为上述任何“提示”（您最好检查一下我没有错过任何其他“提示”格式)，如果页面不包含其中之一，则提出一个后备算法。

更现实的解决方案是使用其他人的 URL -> 缩略图系统。

如果您喜欢 Facebook 的版本，我认为您应该能够通过他们的 API 为给定 URL 请求 Facebook 的缩略图。

提供此类服务的其他服务包括：

*   [http://webthumb.bluga.net/home](http://webthumb.bluga.net/home) （不是免费的）
*   [http://immediatenet.com/thumbnail_api.html](http://immediatenet.com/thumbnail_api.html) （免费，可能有限制性 TOS）
*   [https://www.google.com/search?q=get+thumbnail+for+url](https://www.google.com/search?q=get+thumbnail+for+url)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T21:31:34.930

如果 html 页面和图像之间的 QvkaduU 部分始终相同，您可以只进行字符串替换吗？

" [http://imgur.com/gallery/QvkaduU](http://imgur.com/gallery/QvkaduU) ".Replace("imgur.com/gallery","i.imgur.com") + ".jpg";

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T13:34:31.127

我将获取整个 HTML 源代码并使用正则表达式放置所有`<img ... src="...">`参数以及`< ... style="... background-image: ...;">`css 内联属性，并尝试临时下载链接后面的所有文件。然后我会（尝试将其转换为位图并）检查像素大小，最大的图片应该是你想要的图片。

Google 可能会帮助您检查像素大小和转换任何图像。

从 HTML 源获取所有图像链接的正则表达式应该是

`<img[^>]+src=\"([^"]+)\".*?>|<[^>]+style=\"[^"]*background-image:\s*url\(\s*'?([^')])\s*'?)\s*;.*?>`（未经测试，但很确定）

结果将在第 2 组或第 3 组索引中，也不要忘记在相对链接上添加当前 url 的前缀。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-27T20:41:54.720

您已经走在正确的轨道上，是的，最可靠的方法是获取 HTML，解析它并查找图像，然后根据位置和大小对图像进行排名。例如，如果您找到的第一张图片足够大可以制作缩略图，那么很酷，如果它很小，您就转到下一张图片等。最好使用像 Timthumb 这样的图片插件（我认为我曾经看过一个 ASP.NET 版本）并缓存图像，这样一旦您查找了代表网站的缩略图，您就可以从 catch 中调用图像。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-19T20:11:37.270

你能尝试做这样的事情吗？

```
public void ProcessRequest(HttpContext context)
    {
      {
            // load here the image 
            ....
            // and send it to browser
            ctx.Response.OutputStream.Write(imageData, 0, imageData.Length);
       }
    } 
```

您也可以尝试他们在这里谈论的内容。我试过了，它就像一个魅力。

[http://www.dotnetspider.com/resources/42565-Download-images-from-URL-using-C.aspx](http://www.dotnetspider.com/resources/42565-Download-images-from-URL-using-C.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-19T21:23:46.837

你能试试这个吗

```
public Bitmap getImageFromURL(String sURL)
{
    HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(sURL);
    myRequest.Method = "GET";
    HttpWebResponse myResponse = (HttpWebResponse)myRequest.GetResponse();
    System.Drawing.Bitmap bmp = new System.Drawing.Bitmap(myResponse.GetResponseStream());
    myResponse.Close();

    return bmp;
} 
```

从 [如何从 URL 中获取图片到图片框？（Windows 移动版）](https://stackoverflow.com/questions/2396288/how-to-get-an-image-to-a-picturebox-from-an-url-windows-mobile)

# html - 为什么元“视口”标签让我的页面在 Android 设备上看起来被放大了？

> ID：15509119
> 
> 赞同：0
> 
> 时间：2013-03-19T19:51:12.537
> 
> 标签：html, css, responsive-design, meta-tags, viewport

我正在尝试使我的网站在移动设备上更具“响应性”。

[http://healthybodyguru.com](http://healthybodyguru.com)

我已经尝试了很多“视口”元标记的变体，目前是：

```
<meta name="viewport" content="width=device-width, initial-scale=1" /> 
```

但由于某种原因，在我的 HTC Vivid 上，页面加载非常放大：

![HTC Vivid Screeny](../Images/bd8b90e083d6d16fc9f9df1edc73bb10.png)

有什么想法可以调整视口以使页面在我的 Android 上 100% 可见吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:52:55.170

Maybe try something like this:

```
<meta name="viewport" content="width=320px, initial-scale=1, maximum-scale=1"/> 
```

I'm still trying to understand the `viewport` to be honest. But I think, I maybe got it now. The viewport `width` should be set to the default viewable width of the content. For example: If you just have an `<img/>` with `width: 320px`, than the image will be fullscreen if you use the code above.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T19:58:59.330

```
initial-scale=1 
```

导致它加载放大。您可以将其删除，也可以将其替换为最大比例或最小比例（无论您想要实现什么）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T10:56:54.470

这段代码对我很有用......我希望它也对你有用......

```
// fit the width of screen
myWebView.getSettings().setLayoutAlgorithm(LayoutAlgorithm.SINGLE_COLUMN); 
// remove a weird white line on the right size
myWebView.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY); 
```

# knockout.js - Combining $parent and $index in a foreach

> ID：15509130
> 
> 赞同：3
> 
> 时间：2013-03-19T19:51:36.843
> 
> 标签：knockout.js

I have a view model that has two arrays. I want to iterate over one array and access the value at the same index on the other array, but it seems that you can't use `$parent` with `$index`. See [here](http://jsfiddle.net/znnSc/):

```
function viewModel(factors,models) {
    this.name="parent View model";
    this.factors = ko.observableArray(factors);   
    this.models = ko.observableArray(models);
}

function subViewModel(name, array) {
    this.anotherArray = ko.observableArray(array);
    this.name = name;
}

ko.applyBindings(new viewModel(
    ["factor1","factor2"],
    [ new subViewModel("model1", ["foo","bar"]), 
    new subViewModel("model2", ["one","two"])
]));

<div data-bind="text:name"></div><hr/>
<div data-bind="foreach:models">
    <div data-bind="text: $parent.factors()[$index]"></div>
    <div data-bind="text:name"></div>
    <hr/>
</div> 
```

If you change `$parent.factors()[$index]` to `$parent.factors()[0]` it will display the right entry from the `factors` array. If you replace it with just `$index`, you get the right indexes. But if you combine them, it seems knockout isn't able to parse `$index` in an expression that already has `$parent`?

Anybody else seen this?

I know I could combine my arrays into a single array of a view model that combines the properties, but I have a reason for not doing that. This is part of a much more complex view model.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T19:53:37.510

`$index` is an observable itself.

From the [documentation](http://knockoutjs.com/documentation/binding-context.html):

> This is the zero-based index of the current array entry being rendered by a foreach binding. **Unlike the other binding context properties, $index is an observable...**

So you need to write `$index()` if you are using it inside in an expression:

```
<div data-bind="text: $parent.factors()[$index()]"></div> 
```

Demo [JSFiddle.](http://jsfiddle.net/Dv6eB/)

# image - Mathematica : Add text to imported image / graphic as a label

> ID：15509139
> 
> 赞同：2
> 
> 时间：2013-03-19T19:52:14.177
> 
> 标签：image, text, wolfram-mathematica, label, graphic

Ive searched for hours ... but Im at a loss !

I have imported an image int Mathematica -> dimensions 2x2cm at 72DPI.

I am trying to "label" the image with a text string that: - has font color "fontColor" - has a black outline, so it contrasts to any underlying color - sits in the bottom right corner of the imported image - has size h/w in cm - optionally sits in a text box with a white background

This is how far ive come:

MathCode:

```
image = Import["myimg.jpg"];
inchFactor = 2.54;(* 1 inch = 2.54cm *)
docRes = 72;
pixelConverter = docRes/inchFactor/2;

myText = First[
   First[ImportString[
     ExportString[
      Style["glorious label string here", Bold, FontSize -> 15, 
       FontFamily -> "Verdana"], "PDF"], "PDF", 
     "TextMode" -> "Outlines"]]];

myTextGraphic = 
  Graphics[{EdgeForm[Directive[Black, Thickness[0.01]]], White, 
    myText}, Background -> White, 
   ImageSize -> {10*pixelConverter, 2*pixelConverter}];
myTextGraphic = Rasterize[myTextGraphic];

combined = SetAlphaChannel[myTextGraphic, myTextGraphicAlphaVersion]; 
```

I found the above method (PDF wrapper) for the black outline of the text string.

I am adding an AlphaChannel to the graphic of the text string using a version of it that only uses black/white.

I then try to combine the images with Overlay.

As none of this seems to work concerning the outputted image size and positioning, Im kindly asking for help. There´s no need to "fix" that messy code.

Maybe you could point me to a script or tutorial - all I really want is to add and position a text string or text box to an underlying image.

Thanks a lot !

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:21:58.883

看看这个。还有其他方法。

```
img = Import["http://todayinsci.com/H/Hilbert_David/HilbertDavidThm.jpg"];

Column[{
  img,
  Text[Style["Professor Hilbert", Red]]
}]

imgCtr = Round[ImageDimensions[img]/2];

overlay = Framed[Graphics[{Text[Style["Professor Hilbert", Red, 9], imgCtr]},ImageSize-> {66, 14}], FrameStyle -> Green]

Overlay[{img, overlay}, Alignment -> Center] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T22:51:18.270

这里已经很晚了，所以这只是为您提供解决方案的开始，但这是向图像添加文本标签的简单方法：

```
lbl = Graphics[Text[Style["Bottom", Red, Large]]] 
```

它会创建一个带有大字体红色文本“底部”的图像。接下来，给定一个名为`img1`

```
ImageCompose[img1,lbl] 
```

将文本放在图像的中心。 `ImageCompose`具有允许您在第一张图像上放置第二张图像（即标签）的选项。您可以将标签放在彩色背景上，如下所示：

```
lbl = Graphics[Text[Style["Bottom", Red, Large, Background -> Blue]]] 
```

我还没有弄清楚如何用彩色轮廓编写文本。

# mysql - Selecting objects from a table using IN

> ID：15509151
> 
> 赞同：0
> 
> 时间：2013-03-19T19:53:08.407
> 
> 标签：mysql, sql

That title is probably terrible so let me try to explain with an example

I have a table that consists of top 10 teams called _top 10\. In order to select all the teams that have played a top 10 team at home I can run this query.

```
SELECT      g.home_team,
            IFNULL(SUM(g.home_wins), 0) AS formula 
FROM        games g
WHERE 
            away_team IN (SELECT team_id FROM _top_10) 
GROUP BY    g.home_team 
ORDER BY    formula DESC 
```

This will return a list of all the teams that have played top 10 teams at home along with a number of home many wins against top 10 teams at home they have. What I want included in this list is all the teams that haven't played a top 10 team at home and obviously a zero for wins against top 10 teams at home. Hope this makes sense.

Here is the union code I tried in order to combine the results

```
SELECT      g.home_team,
            IFNULL(SUM(g.home_wins), 0) AS formula ,
            t.*
FROM        games g
INNER JOIN _top_10 AS t ON g.away_team = t.team_id

UNION

SELECT      g.home_team,
            SUM(0) AS formula ,
            t.*
FROM        games g
LEFT JOIN _top_10 AS t ON g.away_team = t.team_id
WHERE t.team_id IS NULL
GROUP BY    g.home_team 
ORDER BY    formula DESC; 
```

**UPDATE**

I've put everything together and I'm getting

> Error Code: 1248\. Every derived table must have its own alias

Here is my final query

```
SELECT     IF(@last_ranking <> formula, @current_rankings := @current_rankings + 1, @current_rankings)  AS rank, 
            @last_ranking := formula, 
            prequery.team, 
            prequery.formula
FROM        (select @current_rankings := 0) sqlvars, 
            (SELECT    team, 
                        SUM(score) formula 
            FROM (SELECT     g.home_team, 
                            SUM(CASE WHEN t.team_id IS NULL THEN 0 ELSE g.home_wins END) AS formula 
            FROM            games g LEFT JOIN 
                        _top_10 AS t ON g.away_team = t.team_id 
            WHERE       
                        g.season = 2012 AND 
                        g.completed = 1 
        UNION ALL SELECT     g.away_team, 
                        SUM(CASE WHEN t2.team_id IS NULL THEN 0 ELSE g.away_wins END) AS formula 
            FROM        games g LEFT JOIN 
                        _top_10 AS t2 ON g.home_team = t2.team_id 
            WHERE      
                        g.season = 2012 AND 
                        g.completed = 1), 
                            (SELECT @current_rankings := 0, @last_ranking := 0) r 
                GROUP BY team ORDER BY formula DESC ) prequery; 
```

Any help would be greatly appreciated

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:55:54.293

`JOIN`表而不是`IN`谓词：

```
SELECT      g.home_team,
            IFNULL(SUM(g.home_wins), 0) AS formula ,
            t.*
FROM        games g
INNER JOIN _top_10 AS t ON g.away_team = t.team_id
GROUP BY    g.home_team 
ORDER BY    formula DESC; 
```

要获得那些没有在主场打过前 10 名球队的球队，请使用`LEFT JOIN`with `WHERE t.team_id IS NULL`：

```
SELECT      g.home_team,
            IFNULL(SUM(g.home_wins), 0) AS formula ,
            t.*
FROM        games g
LEFT JOIN _top_10 AS t ON g.away_team = t.team_id
WHERE t.team_id IS NULL
GROUP BY    g.home_team 
ORDER BY    formula DESC; 
```

* * *

## 更新：

您可以使用一个查询来做到这一点：

```
SELECT 
  g.home_team, 
  SUM(CASE WHEN t.team_id IS NULL THEN 0 ELSE g.home_winsEND) AS formula,
  ...
FROM games g 
LEFT JOIN _top_10 AS t ON g.away_team = t.team_id 
GROUP BY g.home_team, ...; 
```

# html - CSS第一个列表项，但不是嵌套的

> ID：15509158
> 
> 赞同：2
> 
> 时间：2013-03-19T19:53:34.267
> 
> 标签：html, css

我有

```
<style>
li {
    font-size: 80%;
}
</style>

<ul>
    <li> level1
    <ul>
        <li> level2
            <ul>                
                <li>level3</li>
            </ul>        
        </li>
    </ul>
    </li>
</ul> 
```

我希望三个中的所有文本都`<li>`相同，但它们会变小，我如何将它们设置为`font-size: 80%`？

**编辑**

最好不要添加类名，因为我正在考虑使用 markdown 来预处理嵌套的项目符号（使其难以影响 html 输出）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T19:55:02.303

使用类来设置元素的样式。这将防止`font-size`越来越小。

```
<ul class="myList">
    <li> level1
    <ul>
        <li> level2
            <ul>                
                <li>level3</li>
            </ul>        
        </li>
    </ul>
    </li>
</ul> 
```

**CSS**

```
.myList{
  font-size: 80%;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T19:59:53.433

凯文的答案可能是您最好的方法，但只是为了提供替代解决方案：

```
<style>
li {
    font-size: 80%;
}
li li {
    font-size: 100%;
}
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T19:59:09.703

您使用的是相对字体大小，这意味着它们将变为父级大小的 80%，因此每个嵌套列表将逐渐变小。

我建议使用与其父级无关的测量值 - 将它们设置为`px`或什`[rem][1]`至与根大小相关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T20:21:13.833

可能更适合 Markdown 情况的答案是这样的

```
<style>
.page>ol, .page>ul {
    font-size: 80%;
}
</style>

<div class="page">
<ul>
    ...
</ul>   
</div> 
```

尖括号仅选择直接子节点

# mysql - 在 mysql 的子查询中使用相同的字段

> ID：15509163
> 
> 赞同：0
> 
> 时间：2013-03-19T19:53:49.703
> 
> 标签：mysql, sql, group-by, sql-insert

我怎样才能使这样的工作？

```
INSERT INTO age.page(domain,title_count,youtube_count,ipaddress,updated)
SELECT * FROM 
(
    SELECT domain,
    COUNT(domain) AS titlecount,
   (SELECT COUNT(*) FROM table2 WHERE title = table1.title) AS YoutubeCount, ipaddress
    NOW() AS timeNow
    FROM table1
    GROUP BY domain
    ORDER BY title DESC
) a; 
```

我想使用子查询来获取不同表的计数，但使用主查询中的相同字段。

我想这样做的原因是我不必运行两个查询，而是只运行一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:59:36.917

您可以`COUNT`在子查询中执行此操作，然后`JOIN`在第一个表中执行此操作：

```
INSERT INTO age.page(domain, title_count, youtube_count, ipaddress, updated)
SELECT * FROM 
(
    SELECT 
      domain,
      COUNT(domain) AS titlecount,
      t2.titlecount AS YoutubeCount, 
      ipaddress,
      NOW() AS timeNow
    FROM table1
    INNER JOIN
    (
       SELECT title, COUNT(*) Titlecount
       FROM table2 
       GROUP BY title
    ) AS t2 ON t2.title = table1.title   
    GROUP BY domain
    ORDER BY table1.title DESC
) a; 
```

# matlab - pca in matlab - 2D curve stretching

> ID：15509165
> 
> 赞同：1
> 
> 时间：2013-03-19T19:53:51.443
> 
> 标签：matlab, 2d, pca

I have N 3D observations taken from an optical motion capture system in XYZ form. The motion that was captured was just a simple circle arc, derived from a rigid body with fixed axis of rotation. I used the princomp function in matlab to get all marker points on the same plane i.e. the plane on which the motion has been done.

(See a pic representing 3D data on the plane that was found, below)

![http://i.imgur.com/ea9Pz20.png](../Images/709ff88a7c988c24f0ebb5155bd0abcd.png)

What i want to do after the previous step is to look the fitted data on the plane that was found and get the curve of the captured motion in 2D. In the princomp how to, it is said that

> The first two coordinates of the principal component scores give the projection of each point onto the plane, in the coordinate system of the plane.

(from "Fitting an Orthogonal Regression Using Principal Components Analysis" article on mathworks help site)

So i thought that if i just plot those pc scores -plot(score(:,1),score(:,2))- i'll get the motion curve. Instead what i got is this.

(See a pic representing curve data in 2D derived from pc scores, below)

![enter image description here](../Images/097036ffeebfbd1f8fcf746de57a000c.png)

The 2d curve seems stretched and nonlinear (different y values for same x values) when it shouldn't be. The curve that i am looking for, should be interpolated by just using simple polynomial (polyfit) or circle fit in matlab. Is this happening because the plane that was found looks like rhombus relative to the original coordinate system and the pc axes are rotated with respect to the basis of plane in such way that produce this stretch?

Then i thought that, this is happening because of the different coordinate systems of optical system and Matlab. Optical system's (ie cameras) co.sys. is XZY oriented and Matlab's default (i think) co.sys is XYZ oriented. I transformed my data to correspond to Matlab's co.sys through a rotation matrix, run again princomp but i got the same stretch in the 2D curve (the new curve just had different orientation now).

Somewhere else i read that

> Principal Components Analysis chooses the first PCA axis as that line that goes through the centroid, but also minimizes the square of the distance of each point to that line. Thus, in some sense, the line is as close to all of the data as possible. Equivalently, the line goes through the maximum variation in the data. The second PCA axis also must go through the centroid, and also goes through the maximum variation in the data, but with a certain constraint: It must be completely uncorrelated (i.e. at right angles, or "orthogonal") to PCA axis 1.

I know that i am missing something but i have a problem understanding why i get a stretched curve. What i have to do so i can get the curve right?

Thanks in advance.

EDIT: Here is a sample data file (3 columns XYZ coords for 2 markers) w w w.sendspace.com/file/2hiezc

# python - Regex to obtain last digits in years and first three letters of surnames

> ID：15509167
> 
> 赞同：1
> 
> 时间：2013-03-19T19:53:55.313
> 
> 标签：python, regex

I need two different regex. The first one is to match the last two digits of a year, for instance if I have "2010" I would like to obtain "10". I tried doing something like

```
\d{2}\Z 
```

but it didn't work. The second one is two obtain the first three letters of various names and surnames separated by "and". For instance I have

```
John Smith and Paul Anthony Doe 
```

I would like a regex that returns "SmiDoe" but only "Smi" if Doe is not present. It would be nice it works also with more that just two names and surnames.

**Edit:** The provided solutions work perfectly, and now I'm trying to use them to build bibtex (.bib extension) snippets using Ultisnips plugin for Vim. The snippet I tried is

```
snippet ta "Test" b
@Article{${1/\s(\w{,3})\w*($|\sand)/$1/g}${2/\d{2}$/$0/g},
 author={${1:John Smith and Paul Anthony Samuelson}}
 year={${2:2010}}}
endsnippet 
```

The problem is that when the snippet is expanded I get "JohnSmi Paul AnthonySam2010" and I would like to obtain "SmiSam10".

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:29:52.260

你真的需要一个正则表达式，还是会这样做？

```
>>> def AbbreviateAuthors(names):
...     return ''.join(i.split()[-1][:3] for i in names.split(' and '))
>>> AbbreviateAuthors('John Smith and Paul Anthony Doe and Chris Burns')
34: 'SmiDoeBur'
>>> AbbreviateAuthors('John Smith and Paul Anthony Doe')
35: 'SmiDoe'
>>> AbbreviateAuthors('John Smith')
36: 'Smi'
>>> AbbreviateAuthors('Smith')
37: 'Smi'
>>> AbbreviateAuthors('Sm')
38: 'Sm' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T19:55:06.503

这是获取最后两位数字的方法：

```
"/\d{2}$/" -> "2010" -> 10 
```

[http://rubular.com/r/IgVeKXucJ0](http://rubular.com/r/IgVeKXucJ0)

并从您拥有的字符串中获取姓氏的前三个字母：

```
"/\s(\w{,3})\w*($|\sand)/" -> "John Smith and Paul Anthony Doe" -> 1\. Smi 2\. Doe 
```

[http://rubular.com/r/f8OXDB9pDq](http://rubular.com/r/f8OXDB9pDq)，显然想要比赛中的第一项

# jboss - LoadRunner suggested approach to monitoring cloud based JBoss infrastructure

> ID：15509169
> 
> 赞同：1
> 
> 时间：2013-03-19T19:54:03.033
> 
> 标签：jboss, cloud, monitoring, loadrunner, rhq

My Project has a technical platform consisting of a cloud-based set up with JBoss nodes running on Linux VMs and databases connected to these further below. Obviously I can configure each JBoss instance to accept Remote monitoring via JMX and use VisualVM to monitor them. But as the number of JBoss (combined app server and web app server) increases the monitoring gets out-of-hand as there is a lot of nodes to monitor. I have been thinking about using our JBoss Operations Networking (JON) and maybe monitor on this abstraction level, but is there a way to configure LoadRunner to monitor i.e. through JON?

General question: Does anybody have experience in monitoring a could based JBoss infrastructure through LoadRunner or do you monitor through i.e. JON instead when running the LoadTest?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:15:57.520

SiteScope 中的所有监控

*   基本操作系统 通过 SiteScope 进行监控
*   SiteScope 中的 JMX 监控
*   （备用路线）通过 SiteScope 为 JBOSS 和您的操作系统提供 SNMP 代理

当您开始运行测试时，从您的 LR/Performance Center 控制器连接到您的 SiteScope 实例并拉入 SiteScope Stats。作为 SiteScope 业务可用性中心的替代方案，也可以使用。

# ruby - Scraping Table with Nokogiri and need JSON output

> ID：15509170
> 
> 赞同：0
> 
> 时间：2013-03-19T19:54:06.290
> 
> 标签：ruby, screen-scraping, nokogiri, watir, page-object-gem

So, I have a table with multiple rows and columns.

```
<table>
  <tr>
    <th>Employee Name</th>
    <th>Reg Hours</th>
    <th>OT Hours</th>
  </tr>
  <tr>
    <td>Employee 1</td>
    <td>10</td>
    <td>20</td>
  </tr>
  <tr>
    <td>Employee 2</td>
    <td>5</td>
    <td>10</td>
  </tr>
</table> 
```

There is also another table:

```
<table>
  <tr>
    <th>Employee Name</th>
    <th>Revenue</th>
  </tr>
    <td>Employee 2</td>
    <td>$10</td>
  </tr>
  <tr>
    <td>Employee 1</td>
    <td>$50</td>
  </tr>
</table> 
```

Notice that the employee order may be random between the tables.

How can I use nokogiri to create a json file that has each employee as an object, with their total hours and revenue?

Currently, I'm able to just get the individual table cells with some xpath. For example:

```
puts page.xpath(".//*[@id='UC255_tblSummary']/tbody/tr[2]/td[1]/text()").inner_text 
```

**Edit:**

Using the page-object gem and the link from @Dave_McNulla, I tried this piece of code just to see what I get:

```
class MyPage
  include PageObject

  table(:report, :id => 'UC255_tblSummary')

  def get_some_information
    report_element[1][2].text
  end
end

puts get_some_information 
```

Nothing's being returned, however.

Data: [https://gist.github.com/anonymous/d8cc0524160d7d03d37b](https://gist.github.com/anonymous/d8cc0524160d7d03d37b)

There's a duplicate of the hours table. The first one is fine. The other table needed is the accessory revenue table. (I'll also need the activations table, but I'll try to merge that from the code that merges the hours and accessory revenue tables.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T16:49:57.577

我认为一般的做法是：

1.  为键为员工的每个表创建一个哈希
2.  将两个表的结果合并在一起
3.  转换为 JSON

**为键为员工的每个表创建一个哈希**

这部分你可以在 Watir 或 Nokogiri 中完成。仅当 Watir 由于大表而导致性能不佳时，才有意义使用 Nokogiri。

瓦提尔：

```
#I assume you would have a better way to identify the tables than by index
hours_table = browser.table(:index, 0)
wage_table = browser.table(:index, 1)

#Turn the tables into a hash
employee_hours = {}
hours_table.trs.drop(1).each do |tr| 
    tds = tr.tds
    employee_hours[ tds[0].text ] = {"Reg Hours" => tds[1].text, "OT Hours" => tds[2].text}     
end
#=> {"Employee 1"=>{"Reg Hours"=>"10", "OT Hours"=>"20"}, "Employee 2"=>{"Reg Hours"=>"5", "OT Hours"=>"10"}}

employee_wage = {}
wage_table.trs.drop(1).each do |tr| 
    tds = tr.tds
    employee_wage[ tds[0].text ] = {"Revenue" => tds[1].text}   
end
#=> {"Employee 2"=>{"Revenue"=>"$10"}, "Employee 1"=>{"Revenue"=>"$50"}} 
```

野小切：

```
page = Nokogiri::HTML.parse(browser.html)

hours_table = page.search('table')[0]
wage_table = page.search('table')[1]

employee_hours = {}
hours_table.search('tr').drop(1).each do |tr| 
    tds = tr.search('td')
    employee_hours[ tds[0].text ] = {"Reg Hours" => tds[1].text, "OT Hours" => tds[2].text}     
end
#=> {"Employee 1"=>{"Reg Hours"=>"10", "OT Hours"=>"20"}, "Employee 2"=>{"Reg Hours"=>"5", "OT Hours"=>"10"}}

employee_wage = {}
wage_table.search('tr').drop(1).each do |tr| 
    tds = tr.search('td')
    employee_wage[ tds[0].text ] = {"Revenue" => tds[1].text}   
end
#=> {"Employee 2"=>{"Revenue"=>"$10"}, "Employee 1"=>{"Revenue"=>"$50"}} 
```

**将两个表的结果合并在一起**

您希望将两个哈希合并在一起，以便对于特定员工，哈希将包括他们的工作时间以及他们的收入。

```
employee = employee_hours.merge(employee_wage){ |key, old, new| new.merge(old) }
#=> {"Employee 1"=>{"Revenue"=>"$50", "Reg Hours"=>"10", "OT Hours"=>"20"}, "Employee 2"=>{"Revenue"=>"$10", "Reg Hours"=>"5", "OT Hours"=>"10"}} 
```

**转换为 JSON**

基于this [previous question](https://stackoverflow.com/questions/3183786/how-to-convert-a-ruby-hash-object-to-json)，您可以将哈希转换为json。

```
require 'json'
employee.to_json 
```

# ios - Why is implicit animation missing when I add a sublayer to a layer?

> ID：15509172
> 
> 赞同：3
> 
> 时间：2013-03-19T19:54:10.593
> 
> 标签：ios, core-animation

In a UIView subclass, I have this method:

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch * aTouch = [touches anyObject];
    CGPoint loc = [aTouch locationInView:self];

    CALayer * layer = [CALayer layer];
    [layer setBackgroundColor: [[UIColor colorWithHue:(float)rand()/RAND_MAX saturation:1 brightness:1 alpha:1] CGColor]];
    [layer setFrame:CGRectMake(0, 0, 64, 64)];
    [layer setCornerRadius:7];
    [layer setPosition:loc];

    [layer setOpacity:0];

    [self.layer addSublayer:layer];

    CABasicAnimation * opacityAnim = [CABasicAnimation animationWithKeyPath:@"opacity"];
    opacityAnim.duration=2.42;
    opacityAnim.fromValue=[NSNumber numberWithFloat:0];
    opacityAnim.toValue=  [NSNumber numberWithFloat:1];
    opacityAnim.fillMode = kCAFillModeForwards;
    opacityAnim.timingFunction= [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseOut];
    opacityAnim.removedOnCompletion=NO;
    opacityAnim.delegate=self;

//  explicit animation is working as expected
//  [layer addAnimation:opacityAnim forKey:@"opacityAnimation"];

//     Why isn't the implicit animation working ?
[layer setOpacity:1];
} 
```

What am I missing ? I expect the CALayer `layer`'s opacity to be implicitly animated with the last line in this method.

# My solution

Here is how I solved the problem thanks to Duncan's answer.

```
-(CALayer *) layerFactory:(CGPoint) loc {
    CALayer * layer = [CALayer layer];
    [layer setBackgroundColor: [[UIColor colorWithHue:(float)rand()/RAND_MAX saturation:1 brightness:1 alpha:1] CGColor]];
    [layer setFrame:CGRectMake(0, 0, 64, 64)];
    [layer setCornerRadius:7];
    [layer setPosition:loc];
    [layer setOpacity:0];
    return layer;
}

-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

    UITouch * aTouch = [touches anyObject];
    CGPoint loc = [aTouch locationInView:self];

    [CATransaction begin];
    CALayer * layer = [self layerFactory:loc];
    [self.layer addSublayer:layer];
    [CATransaction commit];

    [CATransaction begin];
    [CATransaction setAnimationDuration:0.45];
    [layer setOpacity:1];
    [CATransaction commit];

} 
```

You only need to put the creation of the layer, and the modifiction of the opacity in two different CATransaction blocks. However, moving the creation (not the adding) of the layer to the layerFactory method changes nothing to the situation.

I don't know whether it's the best solution, but it's working.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T13:40:36.320

您不能创建图层并设置其不透明度，然后以相同的方法将不透明度设置为新值并获得隐式动画。尝试将您的创建/配置层代码放在 CATransaction 开始/结束块中，然后将不透明度设置为 1 的代码放在另一个事务开始/结束块中。

我认为这会奏效，但必须尝试才能确定。

如果这不起作用，请调用代码以使用 performSelector:withObject:afterDelay 和延迟值 0 将不透明度设置为 1。这将使系统添加不透明度为 0 的图层，然后将不透明度更改为1 作为单独的交易。

# design-patterns - symfony2 route pattern

> ID：15509173
> 
> 赞同：1
> 
> 时间：2013-03-19T19:54:14.860
> 
> 标签：design-patterns, symfony, routes

This pattern:

```
pattern:  /Messages/.{_format} 
```

Not working when i go to url /Messages

I want to redirect me to the /Messages/ like without the {_format} at the end of the pattern.

HOW?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T21:54:13.803

它不起作用，因为`/Messages`您正在调用未定义的模式。我想问题出在`/.`. 相反，你应该尝试这样的事情：

```
messages_show:
    pattern:  /Messages.{_format}
    defaults: { _controller: AcmeDemoBundle:Messages:show, _format: html }
requirements:
    _format:  html|rss 
```

顺便提一句。当前 Symfony2 路由文档：[http ://symfony.com/doc/current/book/routing.html](http://symfony.com/doc/current/book/routing.html)

# java - 如何在 JAX-RS (Jersey) 中接受 base64 编码的数据？

> ID：15509182
> 
> 赞同：2
> 
> 时间：2013-03-19T19:54:32.427
> 
> 标签：java, rest, encoding, jersey, base64

因为在浏览器中还没有普遍支持[通过 XHR (AJAX) 发送二进制文件](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Sending_and_Receiving_Binary_Data)，所以我需要以 base64 编码发送 PNG 图像（`Content-Encoding: base64`大概带有 HTTP 标头）。

在泽西一侧解码 base64 编码数据的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T19:59:53.207

使用其中一种`decode`方法`com.sun.jersey.core.util.Base64`。您还可以引入 Apache Commons Codec 并使用他们的 DigestUtils 类，但如果您已经在使用 Jersey 库，那完全没有必要。

# android - android异步任务：只有创建视图层次结构的原始线程才能触摸其视图

> ID：15509183
> 
> 赞同：2
> 
> 时间：2013-03-19T19:54:36.370
> 
> 标签：android, multithreading, android-asynctask

我在 doInBackround 中有一个异步任务，我做了各种各样的事情，在各个部分之后我运行了一个

```
 onProgressUpdate("You proceeded a bit further 1/5"); 
```

这可以正常工作多次，直到（仍然全部在 doInBackground 中）我有

```
HttpSessionToken = (HttpURLConnection)new URL("http://myserver").openConnection();
HttpSessionToken.setRequestMethod("GET");   
HttpSessionToken.setRequestProperty("Accept", "application/json");

onProgressUpdate("Still everything is working fine");
int returnCode = HttpSessionToken.getResponseCode();
onProgressUpdate("This onProgressUpdate crashes!"); 
```

所以最后一个 onProgressUpdate 崩溃了，但是为什么会崩溃呢？getResponseCode() 是否切换了我正在运行的线程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:00:03.713

您不直接调用`onProgressUpdate`，您必须调用`publishProgress`并让 AsynTask 框架处理`onProgressUpdate`要在 UI 线程上回调的 。

# java - 在列表中获取列表？

> ID：15509184
> 
> 赞同：0
> 
> 时间：2013-03-19T19:54:43.663
> 
> 标签：java

如果我有这样的地图设置：

```
Map<Fruit, Map<Double, ArrayList<Fruit>>> total = new HashMap<Fruit, Map<Double, ArrayList<Fruit>>>(); 
```

我可以通过执行以下操作访问外层：

```
for (Entry<Fruit, Map<Double, ArrayList<Fruit>>> entry : total.entrySet()) {
} 
```

但是我如何获得`Map<Double, ArrayList<Fruit>>`（内部地图）？....似乎无法弄清楚。

我想我可以做这样的事情：

```
for (Entry<Fruit, Map<Double, ArrayList<Fruit>>> entry : total.entrySet()) {
    for (Map<Double, ArrayList<Fruit>> entry2 : entry.getValue()) {

    }
} 
```

不能在这里使用 entry.getValue() ......但它是包含 Double、ArrayList 的值

但还没有运气......有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T19:58:39.247

只需应用您对外部 Map 所做的相同操作，然后检索 EntrySet。

```
for (Entry<Fruit, Map<Double, ArrayList<Fruit>>> entry : total.entrySet()) {
    for (Entry<Double, ArrayList<Fruit>> entry2 : entry.getValue().entrySet()) {

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T19:58:37.177

尝试

```
 for ( Map<Double, ArrayList<Fruit> map : total.values()) { 

    } 
```

# c++ - '['令牌c ++之前的预期不合格ID

> ID：15509200
> 
> 赞同：0
> 
> 时间：2013-03-19T19:55:18.653
> 
> 标签：c++, compiler-errors

我正在尝试制作一个标记器功能，但我遇到了一个烦人的错误。我是 C++ 新手，语法不及格。感谢你给与我的帮助。

```
using namespace std;

string[] tokenizer(const string &str, const char &delim){
    string tokens[3];
    for(int i = 0; i < 3; i++) tokens[i] = "";
    int start = 0;
    int toks = 0;
    for(int i = 0; i < str.length(); i++){
        if (str[i] == delim){
            for(int j = start; j < i; j++)
                tokens[toks] += str[i];
        }
    }
    return tokens;
} 
```

错误在函数头中。

```
expected unqualified-id before '[' token 
```

对于所有这些粗心的错误，我们深表歉意。我修复了它们，但我仍然得到同样的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:58:11.097

括号在哪里？！

`if str[i] == delim{`至`if (str[i] == delim){`

和

`tokens[i] == ""`至`tokens[i] = ""`

和

`return toks[];`至`return toks;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:27:44.617

你的函数的签名

```
string[] tokenizer(const string &str, const char &delim) 
```

不是有效的 C++。执行此操作的典型方法是`std::vector<>`：

```
std::vector<string> tokenizer(const string &str, const char &delim) 
```

然后：

```
string tokens[3]; 
```

现在忘记这个。甚至是什么`3`意思？您为什么不将索引设置为`tokens`？像这样的代码是所有关于 C 和 C++ 的恶言恶语的根源。使用`std::vector`：

```
std::vector<string> tokens; 
```

要将项目添加到`std:vector`，请使用`push_back()`或`emplace_back()`。

然后，在 C++ 中迭代项目的惯用方法是使用迭代器或基于范围的：

```
for(auto it = str.begin(), end = str.end(); it!=end; ++it) 
```

或者 ...

```
for(auto c : str) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:22:46.520

您的语法很奇怪（我假设您来自 Java 或 C#）并且缺少很多上下文，但我假设您的目标是获取一个字符串并“标记化”它。这是一个工作实现，大致基于您的代码。它无论如何都不是*最佳*的，但它有效，你应该能够理解它。

```
#include <iostream>
#include <string>
#include <vector>

std::vector<std::string> tokenizer(const std::string &str,
                                   char delim = ' ',
                                   bool emptyok = false)
{
    std::vector<std::string> tokens;
    std::string t;

    for(int i = 0; i < str.length(); i++) 
    {       
        if (str[i] == delim) 
        {
            if(emptyok || (t.length() != 0)) 
                tokens.push_back(t);

            t.clear();      
            continue;
        }

        t.push_back(str[i]);
    }

    // And take care of anything that's left over...
    if(emptyok || (t.length() != 0)) 
        tokens.push_back(t);

    return tokens;
}

int main(int, char **)
{       
    std::string s = "This is a test of the emergency broadcast system yo!";

    std::vector<std::string> x = tokenizer(s, ' ');

    for(int i = 0; i != x.size(); i++)
        std::cout << "Token #" << i << ": \"" << x[i] << "\"" << std::endl;

    return 0;
} 
```

# asp.net - 单击同一行中的按钮时如何读取该行的数据

> ID：15509202
> 
> 赞同：-1
> 
> 时间：2013-03-19T19:55:29.337
> 
> 标签：asp.net, datagridview

我在网格中显示的数据如下：

开始日期结束日期按钮

16/3/2013 17/3/2013 注册--->这是一个 ASP 按钮

18/3/2013 19/3/2012 注册---->这是一个 ASP 按钮

20/3/2012 20/3/2012 注册---->这是一个 ASP 按钮

当我单击第一行注册按钮时，我想要带有 c# 代码的 asp.net，我想获取第一行的数据。如果单击第二行，我只想要第二行开始日期和结束时间的数据。我怎样才能做到这一点？请在这方面帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:29:04.530

在 asp 按钮中，设置属性： CommandName="SignUp" CommandArgument='<%# Container.DataItemIndex%>'

现在，当单击此按钮时，它会调用 Gridview 的 RowCommand 事件

在那种情况下， e.CommandArgument 包含您的行号。

GridViewRow gvr= gvLinkImages.Rows[e.CommandArgument];

现在您可以使用 gvr.Cells[column number] 获取特定文本（不推荐）或使用 findcontrol 获取开始/结束日期的标签或文字（假设您使用的是 Templatefields）下面的示例代码

**C＃**

```
protected void gvResults_RowCommand(object sender, GridViewCommandEventArgs e)
{
if (e.CommandName == "SignUp") 
     {
    int rwNumber = Convert.ToInt32(e.CommandArgument);
    GridViewRow gvr = gvResults.Rows(rwNumber);

    System.DateTime rowStartDate = default(System.DateTime);
    System.DateTime rowEndDate = default(System.DateTime);

    //If you are using Templatefields
    Literal lblRowStartDate = gvr.FindControl("lblStartDate") as Literal;
    Literal lblRowEndDate = gvr.FindControl("lblEndDate") as Literal;
    rowStartDate = Convert.ToDateTime(lblRowStartDate.Text);
    rowEndDate = Convert.ToDateTime(lblRowEndDate.Text);

    //Incase you are not using TemplateFields or Autobinding your grid
    rowStartDate = Convert.ToDateTime(gvr.Cells[0].Text);
    rowEndDate = Convert.ToDateTime(gvr.Cells[1].Text);

}
} 
```

**ASPX**

```
 <asp:GridView runat="server" ID="gvResults" AutoGenerateColumns="false" OnRowCommand="gvResults_RowCommand">
    <Columns>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:Literal runat="server" ID="lblStartDate" Text='<%#Container.DataItem.StartDate%>'></asp:Literal>

            </ItemTemplate>

        </asp:TemplateField>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:Literal runat="server" ID="lblStartDate" Text='<%#Container.DataItem.EndDate%>'></asp:Literal>

            </ItemTemplate>

        </asp:TemplateField>
          <asp:TemplateField>
            <ItemTemplate>
                <asp:Button runat="server" ID="btnSignUp" CommandName="SignUp" CommandArgument="<%# Container.DataItemIndex %>"  />

            </ItemTemplate>

        </asp:TemplateField>
    </Columns>

</asp:GridView> 
```

# java - 双击 JavaFX 2.2 时禁用 TreeItem 的默认展开/折叠

> ID：15509203
> 
> 赞同：5
> 
> 时间：2013-03-19T19:55:36.617
> 
> 标签：java, treeview, mouseevent, javafx-2, javafx

我正在开发一个 JavaFX 2.2 项目，我想在 TreeItem 上设置鼠标（双击）单击事件的自定义处理。使用**treeview.setOnMouseClicked**我触发我的代码没有错误，但问题是 TreeItem，在每次鼠标双击时，它会在展开和折叠之间切换。我想这是默认行为，但我如何禁用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-12T11:23:57.643

我遇到了同样的问题并及时使用`EventDispatcher`.

```
class TreeMouseEventDispatcher implements EventDispatcher {
    private final EventDispatcher originalDispatcher;

    public TreeMouseEventDispatcher(EventDispatcher originalDispatcher) {
      this.originalDispatcher = originalDispatcher;
    }

    @Override
    public Event dispatchEvent(Event event, EventDispatchChain tail) {
        if (event instanceof MouseEvent) {
           if (((MouseEvent) event).getButton() == MouseButton.PRIMARY
               && ((MouseEvent) event).getClickCount() >= 2) {

             if (!event.isConsumed()) {
               // Implement your double-click behavior here, even your
               // MouseEvent handlers will be ignored, i.e., the event consumed!
             }

             event.consume();
           }
        }
        return originalDispatcher.dispatchEvent(event, tail);
    }
} 
```

然后将其`TreeMouseEventDispatcher`用于`TreeCell`：

```
treeView.setCellFactory(new Callback<TreeView<T>, TreeCell<T>>() {
  @Override
  public TreeCell<T> call(TreeView<T> param) {
    return new TreeCell<T>() {
      @Override
      protected void updateItem(T item, boolean empty) {
        if (item != null && !empty) {
          EventDispatcher originalDispatcher = getEventDispatcher();
          setEventDispatcher(new TreeMouseEventDispatcher(originalDispatcher));
        }
      }
    };
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-01T15:09:58.990

事实证明，尽管 Bolg 的答案有效，但严格来说它并不是“正确”的方法，并且可能会导致一些意想不到的行为。

[此错误](https://bugs.openjdk.java.net/browse/JDK-8092146)中描述了此问题的原因。总结一下：树单元的默认双击行为实际上是由鼠标*按下事件引发的，因此在鼠标**单击*侦听器中消耗该事件并阻止它为时已晚。

接受的答案有效的原因是它不过滤鼠标事件*类型*，这意味着它消耗与主按钮相关的所有鼠标事件和两次点击次数。这也意味着用户操作被处理了 3 次，这可能不是预期的行为。

修复只是对 Bolg 答案的单行更改，但我认为最好不要涉及 EventDispatcher。像下面这样的东西应该可以正常工作：

```
node.addEventHandler(MouseEvent.ANY, event -> {
    if (event.getClickCount() == 2 && event.getButton().equals(MouseButton.PRIMARY)) {
        if (event.getEventType().equals(MouseEvent.MOUSE_CLICKED)) {
            System.out.println("hello"); // perform some action
        }

        event.consume();
    }
}); 
```

# google-static-maps - 谷歌静态地图仅在不同浏览器选项卡中查看地图后短暂显示地图

> ID：15509205
> 
> 赞同：0
> 
> 时间：2013-03-19T19:55:50.607
> 
> 标签：google-static-maps

我正在构建一个 Rails 应用程序，并尝试将多个 Google 静态地图放入视图中。这些地图将始终显示损坏的图像占位符，除非它在以下情况下起作用：

- 使用 firebug 获取地图图像的 src URL -
将 URL 粘贴到另一个浏览器选项卡
中 - 使用 Google 静态地图刷新我的应用程序页面
- 然后我可以查看我粘贴的 URL 的静态地图，但没有其他的，只有约1分钟。

然后，我重复此过程的页面上的任何地图都可以查看大约 1 分钟。然后大约 1 分钟后，如果我刷新页面，该地图将恢复为损坏的图像占位符。

我的应用程序中的示例 URL（没有我的 API 密钥）是：

[http://maps.googleapis.com/maps/api/staticmap?center=Paris%2C+France&zoom=13&size=600x300&maptype=roadmap&sensor=false&markers=color:blue|label:A|Paris%2C+France](http://maps.googleapis.com/maps/api/staticmap?center=Paris%2C+France&zoom=13&size=600x300&maptype=roadmap&sensor=false&markers=color:blue|label:A|Paris%2C+France)

将其粘贴（或单击）到您的浏览器中，您会看到它有效。*我将此带有 API 密钥的*URL 粘贴到我的浏览器中，它可以工作，并且我的应用程序将在有限的时间内显示静态地图，然后它会再次被破坏。如果我粘贴*没有我的 API 密钥*的 URL ，则此过程不起作用。这就像在另一个浏览器选项卡中查看地图以某种方式将其暂时缓存在我的浏览器中，然后它将在我的应用程序中运行......但它会在一分钟内中断。还没有找到任何其他方法可以使地图图像可见。

任何想法为什么会发生这种情况？

编辑：

这非常奇怪。为了诊断这一点，我复制/粘贴/保存了包含损坏的地图图像的应用程序页面源，并将其放在 World 中的远程服务器上。在这个新的完全静态的页面中，我得到了相同的结果：我看到了损坏的占位符图像，谷歌地图图片应该在哪里。但是在我复制图像的 src URL 并将其粘贴到另一个浏览器选项卡中后，我可以返回静态页面，刷新并只显示该地图图像。

更奇怪的是（也许？），它也出现在我的本地主机应用程序上。它还显示在我保存为 HTML 文件的应用程序页面源的静态本地副本/粘贴上。

所以，并不是说这*一定*是它，但它似乎是一个浏览器缓存问题。无论视图页面在哪里表示，无论是本地的还是远程的，也无论是动态生成的还是静态的 HTML，原始行为都保持不变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-15T10:23:15.667

也许您没有考虑到推荐人是显示静态地图的人。检查这些示例：

1.  [https://developers.google.com/maps/documentation/static-maps/styling?hl=nl](https://developers.google.com/maps/documentation/static-maps/styling?hl=nl)中显示的静态地图：引荐来源网址是[https://developers.google.com](https://developers.google.com)
2.  你抓住这个链接（已经在项目符号 1 的 URL 中）[https://maps.googleapis.com/maps/api/staticmap?size=512x512&zoom=15&​​center=Brooklyn&style=feature:road.local%7Celement：几何%7Ccolor:0x00ff00%7Cweight:1%7Cvisibility:on&style=feature:landscape%7Celement:geometry.fill%7Ccolor:0x000000%7Cvisibility:on&style=feature:administrative%7Celement:labels%7Cweight:3.9%7Cvisibility:on%7Cinverse_lightness: true&style=feature:poi%7Cvisibility:simplified&key=YOUR_API_KEY](https://maps.googleapis.com/maps/api/staticmap?size=512x512&zoom=15&center=Brooklyn&style=feature:road.local%7Celement:geometry%7Ccolor:0x00ff00%7Cweight:1%7Cvisibility:on&style=feature:landscape%7Celement:geometry.fill%7Ccolor:0x000000%7Cvisibility:on&style=feature:administrative%7Celement:labels%7Cweight:3.9%7Cvisibility:on%7Cinverse_lightness:true&style=feature:poi%7Cvisibility:simplified&key=YOUR_API_KEY)并将其粘贴到浏览器中：引荐来源网址是您的公共 IP。

因此，如果链接在任何浏览器中都不起作用但在确定的网页中起作用，这是正常的。当授权推荐人只是网络的主机时，就会发生这种情况。

还要考虑您可能会达到每天显示的免费限制。

# xml - dhtmlx ColdFusion 查询到 XML 或 JSON

> ID：15509206
> 
> 赞同：1
> 
> 时间：2013-03-19T19:55:51.073
> 
> 标签：xml, json, coldfusion, dhtmlx

我希望为这个伟大的产品被推向正确的方向。

我想做的是运行查询或存储过程，获取结果数据集，然后将结果格式化以在 dhtmlxGrid 中使用。我不需要将数据写回数据库，我只需要显示它们。

我已经获得了使用基本文本和 xml 文件的演示

（[http://docs.dhtmlx.com/doku.php?id=tuto](http://docs.dhtmlx.com/doku.php?id=tuto) ...填充）

但是，有没有办法获取查询结果并将它们直接传递给 dhtmlxGrid 而无需将数据写入文件然后读取它？

我尝试过这样的事情：

```
var mygrid;
function doInitGrid(){

mygrid = new dhtmlXGridObject('mygrid_container');
mygrid.setImagePath("codebase/imgs/");
mygrid.setHeader("Model,Qty,Price");
mygrid.setInitWidths("*,150,150");
mygrid.setColAlign("left,right,right");
mygrid.setSkin("light");
mygrid.init();
mygrid.parse(<cfoutput>#xmlString#</cfoutput>); 
```

xmlString 是一个有效的 XML 对象，但网格的格式不是这样。源出来是这样的：

```
var mygrid;
function doInitGrid(){

mygrid = new dhtmlXGridObject('mygrid_container');
mygrid.setImagePath("codebase/imgs/");
mygrid.setHeader("Model,Qty,Price");
mygrid.setInitWidths("*,150,150");
mygrid.setColAlign("left,right,right");
mygrid.setSkin("light");
mygrid.init();
mygrid.parse(<?xml version="1.0" encoding="UTF-8"?>
<users columns="3" rows="3"><user fname="Nathan" id="292B71DC-9DDD-BA4F-    A95BF84F85CAF661" lname="Dintenfass"/><user fname="Ben" id="292B71DD-0893-326D-    79269A1DCFD46D37" lname="Archibald"/><user fname="Raymond" id="292B71DE-E781-43FE-    A4DCD955A1A5C044" lname="Jones"/></users>);

} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T21:35:01.063

You could try wrapping your #xmlString# in JSStringFormat()

```
mygrid.parse('<cfoutput>#JSStringFormat(xmlString)#</cfoutput>'); 
```

I would look at the [XML Syntax documentation](http://docs.dhtmlx.com/doku.php?id=dhtmlxgrid%3asyntax_templates) on how the XML should be structured.

You would need to write a custom function to take a query and convert it over to the XML Syntax that the dhtmlx is expecting.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T10:40:01.240

除了 Abbottmw 的[`jsStringFormat`](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_in-k_46.html)建议之外，请注意他将 ColdFusion 输出用引号括起来，这些引号是必需的，但您的代码中没有这些引号。

如果 XML 不适合您，您可能会使用用 ColdFusion 创建的 JSON 加载它，[`SerializeJSON`](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_s_03.html)或者使用带有函数的 CFC和DHTMLX 中的[`returnformat="JSON"`](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_f_21.html)这个规范，或者从 ColdFusion的使用中加载。[`JSON`](http://docs.dhtmlx.com/doku.php?id=dhtmlxgrid%3adata_loading#loading_data_from_json)[`array`](http://docs.dhtmlx.com/doku.php?id=dhtmlxgrid%3adata_loading#loading_from_js_array)[`toScript`](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions-pt0_04.html)

> 但是，有没有办法获取查询结果并将它们直接传递给 dhtmlxGrid 而无需将数据写入文件然后读取它？

确实。从 JSON 加载说明：

> 要从远程文件（静态 JSON 文件**或将生成 json 输出**的任何类型的脚本）加载数据，应使用以下代码字符串：

这意味着动态生成 json 输出的简单 .cfm 或 .cfc（推荐）页面。例如，如果您使用带有名为 dhtmlxJSON 的函数的 CFC，您将在网格中这样调用它。`grid.load("myJsonGenerator.cfc?method=dhtmlxJSON","json");`

# ios5 - iOS 5 中的 UICollectionView

> ID：15509208
> 
> 赞同：1
> 
> 时间：2013-03-19T19:55:55.640
> 
> 标签：ios5, ios6

在自定义类中创建相同的功能后，我刚刚了解了 UICollectionView。所以我正在考虑使用删除我编写的所有代码并仅使用 UICollectionView。

我知道我的应用程序在 iOS 5 上获得了很多安装。而且我知道很多不精通技术的朋友和家人仍然安装了它。

我用谷歌搜索了这个，它说我可以使用其他人的库（在编写自定义类之前我应该​​知道的另一件事）。但答案并不明确。

所以我的问题是，Apple 是否包含适用于 iOS 5 的桥梁，或者如果我使用 UICollectionView，我的应用程序会失败吗？

我的目标部署设置为 5.0，它没有给我任何警告。

文卡特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:58:45.360

`UICollectionView`仅适用于 iOS6。您可以包含额外的代码来检查 iOS6 并在 iOS5 上使用您的自定义类。但没有办法`UICollectionView`在 iOS5 中使用实际。

这就是“其他人的图书馆”所做的。它有一个兼容 iOS5 的克隆，`UICollectionView`并基于要使用的操作系统进行检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-13T02:51:44.400

也许你想试试这个作为替代方案： [https ://github.com/steipete/PSTCollectionView](https://github.com/steipete/PSTCollectionView)

# azure - 天蓝色移动服务身份验证

> ID：15509211
> 
> 赞同：3
> 
> 时间：2013-03-19T19:56:05.170
> 
> 标签：azure, windows-phone-8

我正在为 Windows Phone 8 开发一个应用程序。我正在尝试使用这个非常简单的示例来实现身份验证：http: [//www.windowsazure.com/en-us/develop/mobile/tutorials/get-started-with-users -wp8/](http://www.windowsazure.com/en-us/develop/mobile/tutorials/get-started-with-users-wp8/)，然后是这个：http: [//www.windowsazure.com/en-us/develop/mobile/tutorials/authorize-users-in-scripts-wp8/](http://www.windowsazure.com/en-us/develop/mobile/tutorials/authorize-users-in-scripts-wp8/)。我的应用程序必须继续能够验证和控制我的应用程序用户的访问权限。具体来说，我的问题在这里：

```
private async System.Threading.Tasks.Task Authenticate()
{
    while (user == null)
    {
        string message;
        try
        {
            user = await App.MobileService
                        .LoginAsync(MobileServiceAuthenticationProvider.MicrosoftAccount);
            message = string.Format("You are now logged in - {0}", user.UserId);
        }
        catch (InvalidOperationException e)
        {
            message = e + "You must log in. Login Required";
        }
        MessageBox.Show(message);
    }
} 
```

这与两个教程的代码一样多。它启动登录屏幕，`user = await App.MobileService .LoginAsync(MobileServiceAuthenticationProvider.MicrosoftAccount);` 但在接受登录凭据后，它开始显示错误消息，即：

```
+       $exception  {System.InvalidOperationException: Cannot start a login operation because login is already in progress.

at Microsoft.WindowsAzure.MobileServices.MobileServiceClient.<SendLoginAsync>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at System.Runtime.CompilerServices.TaskAwaiter1.GetResult()
at SeeThrough.MainPage.<Authenticate>d__7.MoveNext()}   System.Exception {System.InvalidOperationException} 
```

它重复这个过程，因为“用户”永远不会被分配，因为“登录已经在进行中”的情况。我在网上找不到任何可以帮助的东西，我已经搜索了这个错误，并且只得到了 4 个确切问题的命中，这些问题是 github 代码的一部分，据我所知没有任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T11:11:26.543

我认为您没有正确配置帐户。请在实时仪表板的应用注册页面中提供正确的移动服务 URL。如果 URL 不正确，则更有可能出现此类异常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-09T02:10:15.350

老问题，但这对我有帮助。

引用[MSDN 论坛的答案](https://social.msdn.microsoft.com/forums/azure/en-US/95c6569e-2fa2-43c8-af71-939e006a9b27/mobile-services-loginasync-remote-procedure-call-failed-hresult-0x800706be?forum=azuremobile)

> 我忘了提一下，我们的教程尚未针对 windows phone 8.1 进行更新，因此您还需要在 app.xaml.cs 中添加以下代码（此代码段适用于通用应用程序，phone 8.1 将是相同的只是不需要它是有条件的）

```
protected override void OnActivated (IActivatedEventArgs args)
{
    base.OnActivated (args);

#if WINDOWS_PHONE_APP
    if (args.Kind == ActivationKind.WebAuthenticationBrokerContinuation)
        App.<mobileservice>.LoginComplete (args as WebAuthenticationBrokerContinuationEventArgs);
#endif
} 
```

# ios - 仅在执行产品时出错 --> 存在语义问题的存档

> ID：15509214
> 
> 赞同：2
> 
> 时间：2013-03-19T19:56:14.107
> 
> 标签：ios, objective-c, xcode4, archiving

如果我将它编译到设备或模拟器，它运行良好。但是当我做产品->存档时，它会出错：

```
Login.m
! Semantic Issue
  Use of undeclared identifier 'kLogin_URL' 
```

但这适用于模拟器和设备

我正在使用 Xcode 版本 4.6 (4H127)。这是常量文件。

```
#ifndef MyMobileApp_AllUrls_h
    #define MyMobileApp_AllUrls_h

    #ifdef QA
        #define kLogin_URL              @"https://b2bgateway.qa.mycompany.com/authenticate"
        #define ktran_URL               @"https://b2bgateway.qa.mycompany.com/.../lookup"

        #define LOGIN_REQUEST_TIMEOUT   15.0f
        #define TRAN_REQ_TIMEOUT        60.0f
    #endif

    #ifdef PROD
        #define kLogin_URL              @"https://b2bgateway.mycompany.com/authenticate"
        #define ktran_URL               @"https://b2bgateway.mycompany.com/.../lookup"

        #define LOGIN_REQUEST_TIMEOUT   15.0f
        #define TRAN_REQ_TIMEOUT        30.0f
    #endif
#endif 
```

-prefix.pch 的内容是

```
#import <Availability.h>

#ifndef __IPHONE_5_0
#warning "This project uses features only available in iOS SDK 5.0 and later."
#endif

#ifdef __OBJC__
    #import <UIKit/UIKit.h>
    #import <Foundation/Foundation.h>
    #import "AllUrls.h"
#endif 
```

感谢您的投入。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:03:51.363

确保您的构建设置预处理器宏包含`PROD`在您的发布配置下。

根据您的评论，只是想确保这是您所做的。

```
#ifdef QA
    #define kLogin_URL              @"https://b2bgateway.qa.mycompany.com/authenticate"
    #define ktran_URL               @"https://b2bgateway.qa.mycompany.com/.../lookup"

    #define LOGIN_REQUEST_TIMEOUT   15.0f
    #define TRAN_REQ_TIMEOUT        60.0f
#else
    #define kLogin_URL              @"https://b2bgateway.mycompany.com/authenticate"
    #define ktran_URL               @"https://b2bgateway.mycompany.com/.../lookup"

    #define LOGIN_REQUEST_TIMEOUT   15.0f
    #define TRAN_REQ_TIMEOUT        30.0f
#endif 
```

# exchange-server - Exchange Web 服务，无法设置约会的 startTimeZone (java api)

> ID：15509217
> 
> 赞同：2
> 
> 时间：2013-03-19T19:56:21.550
> 
> 标签：exchange-server, exchangewebservices, exchange-server-2007

尝试设置约会的开始时区时（在 ews java API 1.1.5 中）出现错误。我正在尝试设置时区，因为在使用 Appointment.setStart 时会引发异常。

```
Appointment = new Appointment(service);

appointment.setStartTimeZone(new TimeZoneDefinition() {{setId("what should go hère")}});

appointment.setStart(startTime);.... 
```

使用交换 2007

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-23T20:00:37.343

最终看来，JAVA EWS API 是 C# 版本的一个糟糕（且充满错误）的端口。所以规则就是不要使用它。

有一些替代方案：

[J-交换](http://sourceforge.net/projects/j-xchange/)

对于我的具体问题，看起来 setStartTimeZone 函数需要一个 C# 对象，这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-18T17:13:31.177

我可以通过注释掉关于 StartTimeZone 的验证代码（Appointment.java 的第 247-256 行）并重新编译 jar 来解决这个问题。如果我根据 UTC 传入日期/时间，则会在用户的时区中创建约会。

# excel - Excel 工作簿打开宏重新打开关闭的工作簿

> ID：15509218
> 
> 赞同：-1
> 
> 时间：2013-03-19T19:56:33.890
> 
> 标签：excel, vba

我作为宏执行以下操作

1.  打开文件列表
2.  复制一些值
3.  关闭它们

之后，当我退出并重新打开包含宏的文件时，它也会打开我之前打开的文件。即使是我使用过 app.workbook.close 的那些

我无法找出问题所在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T13:05:16.243

宏在哪里？在普通模块中？

最后，看到您已经将变量指向它，您不妨说

```
currentWB.close False 
```

然后关闭

```
Set currentWB = Nothing 
```

具有宏的文件和它创建的文件之间是否有一些链接？

# javascript - 通过 ender 的 jquery 库

> ID：15509222
> 
> 赞同：1
> 
> 时间：2013-03-19T19:56:48.947
> 
> 标签：javascript, jquery, node.js, ender

我尝试将 jquery 构建到 ender.js 中。

```
ender build jquery 
```

该库已正确安装，但我看到许多我不需要的依赖项。

它是我可以通过 ender 嵌入的 jquery 的最小版本还是打算从 Node.js 使用的版本？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T19:59:35.150

ender 的一个典型用途是用不同的 ender“库”（qwery、bean 等）替换 jQuery。如果您真的想将 jQuery 与 ender 捆绑在一起，我相信它会为您提供完整版的 jQuery（所有功能）。您可以随时[构建自己的](https://github.com/jquery/jquery#what-you-need-to-build-your-own-jquery)并将其与 Ender 捆绑在一起。

# node.js - 单元测试 Node.js 和 WebSockets (Socket.io)

> ID：15509231
> 
> 赞同：71
> 
> 时间：2013-03-19T19:57:11.627
> 
> 标签：node.js, unit-testing, websocket, socket.io

任何人都可以使用 WebSockets (Socket.io) 为 Node.js 提供坚如磐石、极其简单的单元测试吗？

我将 socket.io 用于 Node.js，并查看了 socket.io-client 以在测试中建立与服务器的客户端连接。但是，我似乎遗漏了一些东西。

在下面的示例中，“worked...”永远不会被打印出来。

```
var io = require('socket.io-client')
, assert = require('assert')
, expect = require('expect.js');

describe('Suite of unit tests', function() {

    describe('First (hopefully useful) test', function() {

        var socket = io.connect('http://localhost:3001');
        socket.on('connect', function(done) {
            console.log('worked...');
            done();
        });

        it('Doing some things with indexOf()', function() {
            expect([1, 2, 3].indexOf(5)).to.be.equal(-1);
            expect([1, 2, 3].indexOf(0)).to.be.equal(-1);
        });

    });
}); 
```

相反，我只是得到：

```
 Suite of unit tests
    First (hopefully useful) test
      ✓ Doing some things with indexOf() 

  1 test complete (26 ms) 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-03-21T16:30:48.640

经过进一步的戳戳，我发现了一些[非常有用的信息](http://blog.foundry376.com/2012/09/connecting-to-a-socket-io-server-from-node-js-unit-tests)。在作者的示例中，他指出了在**`before`**钩子中建立套接字监听器的关键步骤。

这个例子有效：

> 假设服务器正在监听套接字连接`localhost:3001`，当然

```
var io = require('socket.io-client')
, assert = require('assert')
, expect = require('expect.js');

describe('Suite of unit tests', function() {

    var socket;

    beforeEach(function(done) {
        // Setup
        socket = io.connect('http://localhost:3001', {
            'reconnection delay' : 0
            , 'reopen delay' : 0
            , 'force new connection' : true
        });
        socket.on('connect', function() {
            console.log('worked...');
            done();
        });
        socket.on('disconnect', function() {
            console.log('disconnected...');
        })
    });

    afterEach(function(done) {
        // Cleanup
        if(socket.connected) {
            console.log('disconnecting...');
            socket.disconnect();
        } else {
            // There will not be a connection unless you have done() in beforeEach, socket.on('connect'...)
            console.log('no connection to break...');
        }
        done();
    });

    describe('First (hopefully useful) test', function() {

        it('Doing some things with indexOf()', function(done) {
            expect([1, 2, 3].indexOf(5)).to.be.equal(-1);
            expect([1, 2, 3].indexOf(0)).to.be.equal(-1);
            done();
        });

        it('Doing something else with indexOf()', function(done) {
            expect([1, 2, 3].indexOf(5)).to.be.equal(-1);
            expect([1, 2, 3].indexOf(0)).to.be.equal(-1);
            done();
        });

    });

}); 
```

我发现,监听器`done()`中的位置对于建立连接至关重要。例如，如果您在侦听器中注释掉，然后将其添加到一个范围之外（*就在退出之前*），您将看到*“no connection to break...”*消息而不是*“disconnecting...”*消息。像这样：`beforeEach``socket.on('connect'...)``done()`*`beforeEach`*

 **```
beforeEach(function(done) {
    // Setup
    socket = io.connect('http://localhost:3001', {
        'reconnection delay' : 0
        , 'reopen delay' : 0
        , 'force new connection' : true
    });
    socket.on('connect', function() {
        console.log('worked...');
        //done();
    });
    socket.on('disconnect', function() {
        console.log('disconnected...');
    });
    done();
}); 
```

我是 Mocha 的新手，所以可能有一个非常明显的原因将启动放置`done()`在套接字范围本身内。希望这个小细节能让其他人在我的鞋子里免于拉扯头发。

对我来说，上面的测试（*具有正确的范围`done()`*）输出：

```
 Suite of unit tests
    First (hopefully useful) test
      ◦ Doing some things with indexOf(): worked...
      ✓ Doing some things with indexOf() 
disconnecting...
disconnected...
      ◦ Doing something else with indexOf(): worked...
      ✓ Doing something else with indexOf() 
disconnecting...
disconnected...

  2 tests complete (93 ms) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-05-30T04:32:52.110

在此处提供已接受答案的扩展。具有基本的客户端到服务器通信，可用作其他未来测试的样板。使用 mocha、chai 和 expect。

```
var io = require('socket.io-client')
  , io_server = require('socket.io').listen(3001);

describe('basic socket.io example', function() {

  var socket;

  beforeEach(function(done) {
    // Setup
    socket = io.connect('http://localhost:3001', {
      'reconnection delay' : 0
      , 'reopen delay' : 0
      , 'force new connection' : true
      , transports: ['websocket']
    });

    socket.on('connect', () => {
      done();
    });

    socket.on('disconnect', () => {
      // console.log('disconnected...');
    });
  });

  afterEach((done) => {
    // Cleanup
    if(socket.connected) {
      socket.disconnect();
    }
    io_server.close();
    done();
  });

  it('should communicate', (done) => {
    // once connected, emit Hello World
    io_server.emit('echo', 'Hello World');

    socket.once('echo', (message) => {
      // Check that the message matches
      expect(message).to.equal('Hello World');
      done();
    });

    io_server.on('connection', (socket) => {
      expect(socket).to.not.be.null;
    });
  });

}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2021-02-26T07:25:14.413

自己处理回调和 Promise 可能很困难，而且不平凡的示例很快变得非常复杂且难以阅读。

有一个名为[socket.io-await-test](https://www.npmjs.com/package/socket.io-await-test)的工具可通过 NPM 获得，它允许您在测试中暂停/等待，直到使用 await 关键字触发事件。

```
 describe("wait for tests", () => {
    it("resolves when a number of events are received", async () => {
        const tester = new SocketTester(client);
        const pongs = tester.on('pong');

        client.emit('ping', 1);
        client.emit('ping', 2);
        await pongs.waitForEvents(2) // Blocks until the server emits "pong" twice. 

        assert.equal(pongs.get(0), 2)
        assert.equal(pongs.get(1), 3)
    })
}) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-01-27T16:01:05.260

查看这个基于**承诺**和**良好实践的****样板**解决方案。您可以用它测试您的服务器的整个 io 事件，毫不费力。您只需要复制样板测试并根据需要添加自己的代码。

 ****查看 GitHub 上的 repo 以获取完整的源代码。

[https://github.com/PatMan10/testing_socketIO_server](https://github.com/PatMan10/testing_socketIO_server)

```
const io = require("socket.io-client");
const ev = require("../utils/events");
const logger = require("../utils/logger");

// initSocket returns a promise
// success: resolve a new socket object
// fail: reject a error
const initSocket = () => {
  return new Promise((resolve, reject) => {
      // create socket for communication
      const socket = io("localhost:5000", {
        "reconnection delay": 0,
        "reopen delay": 0,
        "force new connection": true
      });

      // define event handler for sucessfull connection
      socket.on(ev.CONNECT, () => {
        logger.info("connected");
        resolve(socket);
      });

      // if connection takes longer than 5 seconds throw error
      setTimeout(() => {
        reject(new Error("Failed to connect wihtin 5 seconds."));
      }, 5000);
    }
  );
};

// destroySocket returns a promise
// success: resolve true
// fail: resolve false
const destroySocket = socket => {
  return new Promise((resolve, reject) => {
    // check if socket connected
    if (socket.connected) {
      // disconnect socket
      logger.info("disconnecting...");
      socket.disconnect();
      resolve(true);
    } else {
      // not connected
      logger.info("no connection to break...");
      resolve(false);
    }
  });
};

describe("test suit: Echo & Bello", () => {
  test("test: ECHO", async () => {
    // create socket for communication
    const socketClient = await initSocket();

    // create new promise for server response
    const serverResponse = new Promise((resolve, reject) => {
      // define a handler for the test event
      socketClient.on(ev.res_ECHO, data4Client => {
        //process data received from server
        const { message } = data4Client;
        logger.info("Server says: " + message);

        // destroy socket after server responds
        destroySocket(socketClient);

        // return data for testing
        resolve(data4Client);
      });

      // if response takes longer than 5 seconds throw error
      setTimeout(() => {
        reject(new Error("Failed to get reponse, connection timed out..."));
      }, 5000);
    });

    // define data 4 server
    const data4Server = { message: "CLIENT ECHO" };

    // emit event with data to server
    logger.info("Emitting ECHO event");
    socketClient.emit(ev.com_ECHO, data4Server);

    // wait for server to respond
    const { status, message } = await serverResponse;

    // check the response data
    expect(status).toBe(200);
    expect(message).toBe("SERVER ECHO");
  });

  test("test BELLO", async () => {
    const socketClient = await initSocket();
    const serverResponse = new Promise((resolve, reject) => {
      socketClient.on(ev.res_BELLO, data4Client => {
        const { message } = data4Client;
        logger.info("Server says: " + message);
        destroySocket(socketClient);
        resolve(data4Client);
      });

      setTimeout(() => {
        reject(new Error("Failed to get reponse, connection timed out..."));
      }, 5000);
    });

    const data4Server = { message: "CLIENT BELLO" };
    logger.info("Emitting BELLO event");
    socketClient.emit(ev.com_BELLO, data4Server);

    const { status, message } = await serverResponse;
    expect(status).toBe(200);
    expect(message).toBe("SERVER BELLO");
  });
}); 
```

**---- 脚注 ----**

根据您设置服务器环境的方式，您可能会遇到同时从同一项目运行的 socket.io 和 socket.io-client 之间的环境冲突。在这种情况下，最好将项目分成“测试客户端”和服务器。如果您遇到此问题，请在下面的 repo 中结帐。

[https://github.com/PatMan10/testing_socketIO_server_v2](https://github.com/PatMan10/testing_socketIO_server_v2)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-10-22T15:51:07.840

In OP's code,

```
socket.on('connect', function(done) {
    console.log('worked...');
    done();
}); 
```

the `done` was applied to the wrong callback. It should be removed from the `socket.on` callback and added to Mocha's `it` block callback:

```
it('First (hopefully useful) test', function (done) {
  var socket = io.connect('http://localhost:3001');
  socket.on('connect', function () {
    console.log('worked...');
    done();
  });
}); 
```

* * *

## A complete example

Existing answers are great but don't show the server ultimately being tested. Here's a complete version with `console.log`s to illustrate what's going on. Explanation follows.

### `src/server.js`:

```
const express = require("express");

const createServer = (port=3000) => {
  const app = express();
  const http = require("http").Server(app);
  const io = require("socket.io")(http);

  io.on("connection", socket => {
    console.log("[server] user connected");

    socket.on("message", msg => {
      console.log(`[server] received '${msg}'`);
      socket.emit("message", msg);
    });
    socket.on("disconnect", () => {
      console.log("[server] user disconnected");
    });
  });

  http.listen(port, () =>
    console.log(`[server] listening on port ${port}`)
  );
  return {
    close: () => http.close(() => 
      console.log("[server] closed")
    )
  };
};
module.exports = {createServer}; 
```

### `test/server.test.js`:

```
const {expect} = require("chai");
const io = require("socket.io-client");
const {createServer} = require("../src/server");
const socketUrl = "http://localhost:3000";

describe("server", function () {
  this.timeout(3000);

  let server;
  let sockets;
  beforeEach(() => {
    sockets = [];
    server = createServer();
  });
  afterEach(() => {
    sockets.forEach(e => e.disconnect())
    server.close();
  });

  const makeSocket = (id=0) => {
    const socket = io.connect(socketUrl, {
      "reconnection delay": 0,
      "reopen delay": 0,
      "force new connection": true,
      transports: ["websocket"],
    });
    socket.on("connect", () => {
      console.log(`[client ${id}] connected`);
    });
    socket.on("disconnect", () => {
      console.log(`[client ${id}] disconnected`);
    });
    sockets.push(socket);
    return socket;
  };

  it("should echo a message to a client", done => {
    const socket = makeSocket();
    socket.emit("message", "hello world");
    socket.on("message", msg => {
      console.log(`[client] received '${msg}'`);
      expect(msg).to.equal("hello world");
      done();
    });
  });

  it("should echo messages to multiple clients", () => {
    const sockets = [...Array(5)].map((_, i) => makeSocket(i));

    return Promise.all(sockets.map((socket, id) =>
      new Promise((resolve, reject) => {
        const msgs = [..."abcd"].map(e => e + id);
        msgs.slice().forEach(e => socket.emit("message", e));

        socket.on("message", msg => {
          console.log(`[client ${id}] received '${msg}'`);
          expect(msg).to.equal(msgs.shift());

          if (msgs.length === 0) {
            resolve();
          }
        });
      })
    ));
  });
}); 
```

In summary, the server exports a function that lets a server app be created from scratch, allowing each `it` block to be idempotent and avoid server state from carrying between tests (assuming no persistence on the server otherwise). Creating an app returns an object with a `close` function. `socket.disconnect()` must be called per socket in each test to avoid timeouts.

Given these requirements, the testing suite follows this per-test setup/teardown workflow:

```
let server;
let sockets;
beforeEach(() => {
  sockets = [];
  server = createServer();
});
afterEach(() => {
  sockets.forEach(e => e.disconnect())
  server.close();
}); 
```

`makeSocket` is an optional helper to reduce the repeated boilerplate of connecting and disconnecting a socket client. It does produce a side effect on the `sockets` array for cleanup later, but this is an implementation detail from the `it` block's perspective. Test blocks shoudn't touch `server` or `sockets` variables, although other workflows are likely depending on need. The critical takeaways are test case idempotency and closing all connections after each test case.

Options on the `socket.connect` object on the client let you choose transport and behavior of the socket. `"force new connection": true` creates a new `Manager` per socket instead of reusing an existing one and `transports: ["websocket"]` upgrades to WS protocol from long polling immediately.

Use `it("should ... ", done => { /* tests */ });` and invoke `done()` after all work is completed in callbacks or return a promise (and omit the `done` parameter to the `it` callback). The example above shows both approaches.

* * *

Used in this post:

*   `node`: 12.19.0
*   `chai`: 4.2.0
*   `express`: 4.16.4
*   `mocha`: 5.2.0
*   `socket.io`: 2.2.0
*   `socket.io-client`: 2.2.0

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-02-25T09:00:40.477

我遇到了这个问题：如果您不知道服务器需要多长时间响应，如何使用“socket.io-client”进行单元测试？

我已经使用*mocha*和*chai*解决了：

```
var os = require('os');
var should = require("chai").should();
var socketio_client = require('socket.io-client');

var end_point = 'http://' + os.hostname() + ':8081';
var opts = {forceNew: true};

describe("async test with socket.io", function () {
this.timeout(10000);

it('Response should be an object', function (done) {
    setTimeout(function () {
        var socket_client = socketio_client(end_point, opts);  

        socket_client.emit('event', 'ABCDEF');

        socket_client.on('event response', function (data) {
            data.should.be.an('object');
            socket_client.disconnect();
            done();
        });

        socket_client.on('event response error', function (data) {
            console.error(data);
            socket_client.disconnect();
            done();
            });
        }, 4000);
    });
}); 
```******

# python - 如何构建 html5lib 解析器来处理混合的 XML 和 HTML 标签？

> ID：15509233
> 
> 赞同：5
> 
> 时间：2013-03-19T19:57:21.830
> 
> 标签：python, xml, parsing, beautifulsoup

我正在尝试使用 BeautifulSoup 解析一个 HTML 文件，该文件由许多从 LexisNexis（法律数据库）批量下载的单个文档组成。

*   我的第一个任务是将 HTML 文件拆分为其组成文档。我认为这很容易，因为文件被包围 `<DOC NUMBER=1>body of the 1st document</DOC>` 等等。

*   但是，此`<DOC>`标记是 XML 标记，而不是 HTML 标记（文件中的所有其他标记都是 HTML）。因此，对于常规 HTML 解析器，此标记在树中不可用。

*   如何在 bs4 中构建一个解析器来获取这个 XML 标记？我附上 HTML 文件的相关部分：

    `<!-- Hide XML section from browser <DOC NUMBER=1> <DOCFULL> --> BODY <!-- Hide XML section from browser </DOCFULL> </DOC> -->`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T20:43:19.923

实例化 BeautifulSoup 对象时，您可以在 bs4 中指定 xml：

```
xml_soup = BeautifulSoup(xml_object, 'xml') 
```

这应该可以解决您的问题。您*可以*使用该`xml_soup`对象来解析剩余的 html，但是我建议专门为 html 实例化另一个汤对象：

```
soup = BeautifulSoup(html_object) 
```

# java - 树集字母排序

> ID：15509234
> 
> 赞同：3
> 
> 时间：2013-03-19T19:57:27.033
> 
> 标签：java, sorting, treeset

如何让树集按字母顺序排序？并删除重复项......这让我疯了一天。也许我需要睡一觉。。

```
public static void main(String[] args) {
        String fileName = args[0];
        String words;
        Scanner s = null;
        Iterator itr;

        try {
            s = new Scanner(new BufferedReader(new FileReader(fileName)));
                while (s.hasNext()) {
                    words = s.next();

                    TreeSet<String> ts = new TreeSet<String>();
                    ts.add(words);

                    System.out.println(ts);
                }
            } catch (FileNotFoundException fnfe) {
            System.exit(0);
        } finally {
               if (s != null) {
                   s.close();
                }
            }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T20:05:40.893

`TreeSet`将集合保存在按自然顺序自动排序的树结构中。每个实现`Comparable`接口的类都会被排序。String 类`Comparable`已经实现了该接口，因此您无需对它进行任何排序，只需将其添加到`TreeSet`.

`hashCode()`如果和`equals()`方法按照应有的方式实现，则集合不能包含重复项。

编辑：`TreeSet<String> ts = new TreeSet<String>();`位于`while()`循环范围内。您在每个循环都对其进行初始化，并丢失前一个循环中的数据。在循环之外声明它并且不要使用`Collection.sort()`

# r - 用于行 cor.test 函数的映射

> ID：15509237
> 
> 赞同：0
> 
> 时间：2013-03-19T19:57:41.860
> 
> 标签：r

我正在尝试在 2 个矩阵中的行上使用 cor.test，即 cer 和 par。

```
cerParCorTest <-mapply(function(x,y)cor.test(x,y),cer,par) 
```

但是，mapply 适用于列。

此问题已在[Efficient apply or mapply for multiple matrix arguments by row](https://stackoverflow.com/questions/5626296/efficient-apply-or-mapply-for-multiple-matrix-arguments-by-row)中讨论。我尝试了拆分解决方案（如下）

```
cer <- split(cer, row(cer))
par <- split(par, row(par)) 
```

它会导致错误（而且速度很慢）

```
In split.default(x = seq_len(nrow(x)), f = f, drop = drop, ...) :
data length is not a multiple of split variable 
```

我还尝试了 t(par) 和 t(cer) 让它在行上运行，但它会导致错误

```
Error in cor.test.default(x, y) : not enough finite observations 
```

martices 如下所示（对于 cer 和 par 相同）：

```
 V1698       V1699       V1700      V1701
YAL002W(cer)  0.01860500  0.01947700  0.02043300  0.0214740
YAL003W(cer)  0.07001600  0.06943900  0.06891200  0.0684330
YAL005C(cer)  0.02298100  0.02391900  0.02485800  0.0257970
YAL007C(cer) -0.00026047 -0.00026009 -0.00026023 -0.0002607
YAL008W(cer)  0.00196200  0.00177360  0.00159490  0.0014258 
```

我的问题是为什么转置矩阵不起作用，什么是一个简短的解决方案，它允许使用 mapply for cor.test() 在行上运行。

对于这篇长篇文章，我深表歉意，并提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:41:26.643

我不知道你的矩阵的尺寸是多少，但这对我来说很好

```
N <- 3751 * 1900
cer.m <- matrix(1:N,ncol=1900)
par.m <- matrix(1:N+rnorm(N),ncol=1900)
ll <- mapply(cor.test,
             split(par.m,row(par.m)),
             split(cer.m,row(cer.m)),
             SIMPLIFY=FALSE) 
```

这将为您提供 3751 个元素的列表（每行的相关性）

**编辑**不拆分，你给出行的索引，这应该很快

```
ll <- mapply(function(x,y)cor.test(cer.m[x,],par.m[y,]),
             1:nrow(cer.m),
             1:nrow(cer.m),
             SIMPLIFY=FALSE) 
```

**EDIT2**如何获得估计值：

例如，要获取`estimate`值：

```
sapply(ll,'[[','estimate') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T21:07:51.320

你总是可以在 for 循环中编程，在这些维度上看起来相当快：

```
x1 <- matrix(rnorm(10000000), nrow = 2000)
x2 <- matrix(rnorm(10000000), nrow = 2000)

out <- vector("list", nrow(x1))

system.time(
for (j in seq_along(out)) {
  out[[j]] <- cor.test(x1[j, ], x2[j, ])
}
)
   user  system elapsed 
   1.35    0.00    1.36 
```

*编辑*：如果你只想要估计，我不会将结果存储在列表中，而是一个简单的向量：

```
out2 <- vector("numeric", nrow(x1))

  for (j in seq_along(out)) {
    out2[j] <- cor.test(x1[j, ], x2[j, ])$estimate
  }
head(out2) 
```

如果您想存储所有结果并简单地从每个结果中提取估计值，那么这应该可以解决问题：

```
> out3 <- as.numeric(sapply(out, "[", "estimate"))
#Confirm they are the same
> all.equal(out2, out3)
[1] TRUE 
```

权衡是第一种方法将所有数据存储在一个列表中，这可能对进一步处理有用，而 mroe 简单方法只获取您最初想要的内容。

# javascript - 获取两个日期之间的差异

> ID：15509238
> 
> 赞同：1
> 
> 时间：2013-03-19T19:57:42.160
> 
> 标签：javascript, date, parseint

我正在做一个必须使用 Javascript 的任务。在我的应用程序中，用户在表单中键入日期。然后我尝试将该日期与当前日期进行比较。不同之处在于他们必须完成一项任务的天数。但是，在计算方面我遇到了一些麻烦。dueDate 是动态创建的对象的参数。

```
function getFormData() {
    var adate = document.getElementById("dueDate").value;
    if (checkInputText(dueDate, "Please enter a date")) return;    

...
}

function processDate(adate) {
 var splitArray = adate.split("-");
 var year = splitArray[0];
 var month = splitArray[1] - 1;
 var day = splitArray[2];
 var date = new Date(year, month, day);
 var dateParse = date.getTime();
 return dateParse;
}

function compareDates(dueDate) { //dueDate is the value from the form
        var cdate = new Date();
        console.log("this is todays date" + " " + cdate); //shows correct date
        var cdateparse = Date.parse(cdate);
        var dueDateparse = Date.parse(dueDate);
        var diff = dueDateparse - cdateparse;
        var daysCal = diff / 1000 / 60 / 60 / 24;
        var days = parseInt(daysCal); //where I'm having trouble
        console.log(days);
        if (days == 0) {
            mymessage = " you have to do this task today";
        }
        try {
            if (days < 0) {
                mymessage = "this task is overdue by" + " " + -days + " " + "days";
                throw new Error("you are overdue");
            }
        } catch (ex) {
            alert(ex.message);
            return;
        }
        if (days > 0) {
            console.log("the difference is greater than 0");
            mymessage = "you have" + " " + days + " " + "more days";
        }
    } 
```

当我将当前日期输入表格时，就会出现问题。我试过 math.floor 和 math.round 但这个数字总是四舍五入并抛出我的信息，说任务过期了。使用 parseInt 使我最接近我想要的结果，但是当我输入明天的日期时，它说我已经过期了。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:17:17.387

[http://jsfiddle.net/sujesharukil/QspFj/](http://jsfiddle.net/sujesharukil/QspFj/)

利用

```
 var days = Math.ceil(daysCal); 
```

而不是 parseInt。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:24:26.557

您应该注意这`new Date(year, month, day);`会为 0:00 AM 创建一个时间戳。

因此，那天发生*的*所有事情都已经有了负面影响`diff`（`> -1`尽管如此）。所以你应该使用`Math.ceil`而不是四舍五入。或者您将截止日期设置为 23:59:59（即只需将日期增加 1）。

# python - Python socket.recv 异常

> ID：15509245
> 
> 赞同：6
> 
> 时间：2013-03-19T19:58:09.113
> 
> 标签：python, sockets, networking

我正在开发一个非常简单的 python 套接字服务器。我使用非阻塞套接字。服务器和客户端在带有 python 2.7.3 的 windows 7 x64 上运行。这是我从客户端接收数据的代码：

```
def listenToSockets(self):

    while True:

        changed_sockets = self.currentSockets

        ready_to_read, ready_to_write, in_error = select.select(changed_sockets,[],[])

        for s in ready_to_read:
            # if its the server master socket someone is connecting
            if s == self.socket:
                (client_socket, address) = s.accept()
                print "putting " + address[0] + " onto connections\n";
                client_socket.setblocking(0)

                self.currentSockets.append(client_socket)
                print "current client count : " + str(len(self.currentSockets) - 1)

            else:

                data = ''
                try:

                    while True:
                        part = s.recv(4096)
                        if part != '':
                            data = data + part
                        elif part == '':
                            break

                except socket.error, (value,message): 
                    print 'socket.error - ' + message

                if data != '':
                    print "server received "+data
                else:
                    print "Disconnected "+str(s.getsockname())

                    self.currentSockets.remove(s)
                    s.close() 
```

这是客户端一遍又一遍地发送一些数据：

```
#client example
import socket
import time

client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client_socket.connect(('192.168.0.41', 9999))

while 1:
    client_socket.send("test")
    time.sleep(2) 
```

我看到服务器一遍又一遍地收到消息“测试”。但在它打印出收到的内容之前，我收到以下错误消息。

```
socket.error - A non-blocking socket operation could not be completed immediately. 
```

显然抛出了异常，`part = s.recv(4096)`但为什么呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-19T20:24:23.430

这正是非阻塞套接字应该做的。

*   读取可用数据（如果有）
*   如果没有可用的东西，则**引发错误而不是阻塞**

因此，每次尝试接收并且没有可用数据时，您都会遇到异常。

# tomcat - Tomcat 无法启动（directwebremoting）

> ID：15509249
> 
> 赞同：1
> 
> 时间：2013-03-19T19:58:30.977
> 
> 标签：tomcat, dwr

我是新来的，所以大家好。

我正在寻找答案，为什么我的 Tomcat 无法启动，但我找不到任何解决方案。我在 Tomcat 实例上部署了 App。在 Windows 上一切正常，但在 Ubuntu 12.04 LTS 上我无法启动。我收到此错误消息：

```
20:30:14,476 ERROR [RMI TCP Connection(6)-127.0.0.1] DispatcherServlet.initServletBean(457) | Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name '__dwrConfiguration': Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'filters' of bean class [org.directwebremoting.spring.SpringConfigurator]: Bean property 'filters' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1396)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
    at javax.servlet.GenericServlet.init(GenericServlet.java:212)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1206)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1026)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4421)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4734)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)
    at org.apache.catalina.startup.HostConfig.manageApp(HostConfig.java:1429)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:297)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:762)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:631)
    at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:568)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:295)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:762)
    at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1454)
    at javax.management.remote.rmi.RMIConnectionImpl.access$300(RMIConnectionImpl.java:74)
    at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1295)
    at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1387)
    at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:818)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:303)
    at sun.rmi.transport.Transport$1.run(Transport.java:159)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:155)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:535)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:790)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:649)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
    at java.lang.Thread.run(Thread.java:662)
Caused by: org.springframework.beans.NotWritablePropertyException: Invalid property 'filters' of bean class [org.directwebremoting.spring.SpringConfigurator]: Bean property 'filters' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.BeanWrapperImpl.setPropertyValue(BeanWrapperImpl.java:1064)
    at org.springframework.beans.BeanWrapperImpl.setPropertyValue(BeanWrapperImpl.java:924)
    at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:76)
    at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:58)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1393)
    ... 60 more 
```

我的 pom.xml 包含依赖项：

```
<dependency>
            <groupId>org.directwebremoting</groupId>
            <artifactId>dwr</artifactId>
            <version>3.0</version>
        </dependency> 
```

我不知道问题出在哪里。我尝试更改 dwr 版本，但这并不能解决问题。我正在使用 IntelliJ Idea 12 和 Tomcat6。

预先感谢您的任何回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-28T15:21:35.467

在使用 DWR (3.0) 的官方版本后，我们注意到使用候选版本 RC2 会更好。

这是我们使用的 Maven 依赖项：

```
<dependency>
    <groupId>org.directwebremoting</groupId>
    <artifactId>dwr</artifactId>
    <version>3.0.RC2</version>
</dependency> 
```

即使我们总是尝试只使用已发布的第三方软件的最终版本，我们也没有在我们的项目中发现任何阻塞问题。

# spring - Spring Integration - 池大小、任务执行器和队列的队列容量的动态配置

> ID：15509250
> 
> 赞同：1
> 
> 时间：2013-03-19T19:58:36.490
> 
> 标签：spring, spring-integration

在我的 Spring 集成配置中，我有队列、任务执行器。我想更改队列容量、任务执行器池大小和固定延迟。我想要一个 UI 页面，如果有更多消息要处理或者负载很重而不必重建和部署应用程序，我应该能够更改配置。

前任：

```
<si:service-activator input-channel="MessageChannel" ref="messageHandler" 
                          method="handleMessage" output-channel="ackChannel">

    <si:poller task-executor="messageTaskExecutor" fixed-delay="1000"/>
</si:service-activator>

<task:executor id="messageTaskExecutor" pool-size="10"
queue-capacity="10" keep-alive="1" rejection-policy="CALLER_RUNS"/> 
```

我想动态更改此数字并重新加载配置以获取更改。如果你能指出我正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:23:14.247

您需要将您的任务执行器、队列等作为常规 bean 注入。然后在运行时为它们设置参数。例如

```
<task:executor id="messageTaskExecutor" pool-size="10"
     queue-capacity="10" keep-alive="1" rejection-policy="CALLER_RUNS"/> 
```

将产生`ThreadPoolExecutor`具有 name类型的 bean `messageTaskExecutor`。因此，它可能被注入为：

```
@Autowired @Qualifier("messageTaskExecutor") // or @Inject @Named("messageTaskExecutor")
ThreadPoolExecutor messageTaskExecutor; 
```

之后你可以调用[messageTaskExecutor.setMaximumPoolSize](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html#setMaximumPoolSize%28int%29)

# android - 在具有不同互联网连接的物理 android 浏览器上运行 web 项目

> ID：15509254
> 
> 赞同：0
> 
> 时间：2013-03-19T19:58:40.723
> 
> 标签：android

当我在物理 Android 设备的浏览器中运行我的“网络项目”时，它运行成功，因为两者具有相同的互联网连接。

如果我的手机和我的电脑都有不同的互联网连接怎么办。我仍然想做同样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:31:08.477

我猜您正在引用仅在您的网络上有效/可见/可访问的本地 IP。要向其他人开放此 IP，您可以使用 DynDNS 之类的服务，或者通过服务器共享数据，在该服务器上，双方都只知道他们与之通信的服务器。

# algorithm - VBA冒泡排序算法慢

> ID：15509255
> 
> 赞同：1
> 
> 时间：2013-03-19T19:58:40.707
> 
> 标签：algorithm, vba, bubble-sort

我很惊讶这种冒泡排序算法使用 VBA 的速度有多慢。所以我的问题是我做错了什么/效率低下，或者这只是最好的 VBA 和冒泡排序吗？例如，使用 VARIANT、太多变量等可能会大大降低性能。我知道冒泡排序不是特别快，但我没想到会这么慢。

算法输入：二维数组和一或两列排序依据，每个 asc 或 desc。我不一定需要闪电般的速度，但5000行30秒是完全不能接受的

```
Option Explicit

Sub sortA()

Dim start_time, end_time
start_time = Now()

Dim ThisArray() As Variant
    Dim sheet As Worksheet
    Dim a, b As Integer
    Dim rows, cols As Integer

    Set sheet = ArraySheet
    rows = 5000
    cols = 3
    ReDim ThisArray(0 To cols - 1, 0 To rows - 1)

    For a = 1 To rows
        For b = 1 To cols
            ThisArray(b - 1, a - 1) = ArraySheet.Cells(a, b)
        Next b
    Next a

    Call BubbleSort(ThisArray, 0, False, 2, True)

end_time = Now()
MsgBox (DateDiff("s", start_time, end_time))

End Sub

'Array Must Be: Array(Column,Row)
Sub BubbleSort(ThisArray As Variant, SortColumn1 As Integer, Asc1 As Boolean, Optional SortColumn2 As Integer = -1, Optional Asc2 As Boolean)

    Dim FirstRow As Integer
    Dim LastRow As Integer
    Dim FirstCol As Integer
    Dim LastCol As Integer
    Dim lTemp As Variant
    Dim i, j, k As Integer
    Dim a1, a2, b1, b2 As Variant
    Dim CompareResult As Boolean

    FirstRow = LBound(ThisArray, 2)
    LastRow = UBound(ThisArray, 2)
    FirstCol = LBound(ThisArray, 1)
    LastCol = UBound(ThisArray, 1)

    For i = FirstRow To LastRow
        For j = i + 1 To LastRow

            If SortColumn2 = -1 Then 'If there is only one column to sort by
                a1 = ThisArray(SortColumn1, i)
                a2 = ThisArray(SortColumn1, j)

                If Asc1 = True Then
                    CompareResult = compareOne(a1, a2)
                Else
                    CompareResult = compareOne(a2, a1)
                End If

            Else 'If there are two columns to sort by
                a1 = ThisArray(SortColumn1, i)
                a2 = ThisArray(SortColumn1, j)
                b1 = ThisArray(SortColumn2, i)
                b2 = ThisArray(SortColumn2, j)

                If Asc1 = True Then
                    If Asc2 = True Then
                        CompareResult = compareTwo(a1, a2, b1, b2)
                    Else
                        CompareResult = compareTwo(a1, a2, b2, b1)
                    End If
                Else
                    If Asc2 = True Then
                        CompareResult = compareTwo(a2, a1, b1, b2)
                    Else
                        CompareResult = compareTwo(a2, a1, b2, b1)
                    End If
                End If
            End If

            If CompareResult = True Then ' If compare result returns true, Flip rows
                 For k = FirstCol To LastCol
                     lTemp = ThisArray(k, j)
                     ThisArray(k, j) = ThisArray(k, i)
                     ThisArray(k, i) = lTemp
                 Next k
            End If
        Next j
    Next i

End Sub

Function compareOne(FirstCompare1 As Variant, FirstCompare2 As Variant) As Boolean

    If FirstCompare1 > FirstCompare2 Then
        compareOne = True
    Else
        compareOne = False
    End If

End Function

Function compareTwo(FirstCompare1 As Variant, FirstCompare2 As Variant, SecondCompare1 As Variant, SecondCompare2 As Variant) As Boolean

    If FirstCompare1 > FirstCompare2 Then
        compareTwo = True
    ElseIf FirstCompare1 = FirstCompare2 And SecondCompare1 > SecondCompare2 Then
        compareTwo = True
    Else
        compareTwo = False
    End If

End Function 
```

非常感谢您的任何帮助或建议！

编辑：我决定改用快速排序。如果有兴趣，请参阅下面的代码以获取代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T20:58:39.293

首先：不要对 5000 行使用冒泡排序！这将需要 5000^2/2 次迭代，即 12.5B 次迭代！最好使用体面的快速排序算法。在这篇文章的底部，您会找到一个可以用作起点的文章。它只比较第 1 列。在我的系统上，排序耗时 0.01 秒（而不是优化冒泡排序后的 4 秒）。

现在，对于挑战，请查看以下代码。它以大约原始运行时间的 30% 运行 - 同时显着减少了代码行数。

主要杠杆是：

*   对主数组使用 Double 而不是 Variant（Variant 在内存管理方面总是有一些开销）
*   减少变量的调用/切换次数 - 我没有使用您的 subs CompareOne 和 CompareTwo，而是内联代码并对其进行了优化。另外，我直接访问了这些值而不将它们分配给临时变量
*   仅填充数组就花费了总时间的 10%。相反，我批量分配了数组（必须为此切换行和列），然后将其转换为双数组
*   速度可以通过有两个单独的循环来进一步优化——一个用于一列，一个用于两列。这将运行时间减少了约 10%，但会使代码膨胀，因此将其排除在外。

```
Option Explicit

Sub sortA()

    Dim start_time As Double
    Dim varArray As Variant, dblArray() As Double
    Dim a, b As Long

    Const rows As Long = 5000
    Const cols As Long = 3

    start_time = Timer
    'Copy everything to array of type variant
    varArray = ArraySheet.Range("A1").Resize(rows, cols).Cells

    'Cast variant to double
    ReDim dblArray(1 To rows, 1 To cols)
    For a = 1 To rows
        For b = 1 To cols
            dblArray(a, b) = varArray(a, b)
        Next b
    Next a

    BubbleSort dblArray, 1, False, 2, True

    MsgBox Format(Timer - start_time, "0.00")

End Sub

'Array Must Be: Array(Column,Row)
Sub BubbleSort(ThisArray() As Double, SortColumn1 As Long, Asc1 As Boolean, Optional SortColumn2 As Long = -1, Optional Asc2 As Boolean)

    Dim LastRow As Long
    Dim FirstCol As Long
    Dim LastCol As Long
    Dim lTemp As Double
    Dim i, j, k As Long
    Dim CompareResult As Boolean

    LastRow = UBound(ThisArray, 1)
    FirstCol = LBound(ThisArray, 2)
    LastCol = UBound(ThisArray, 2)

    For i = LBound(ThisArray, 1) To LastRow
        For j = i + 1 To LastRow
            If SortColumn2 = -1 Then    'If there is only one column to sort by
                CompareResult = ThisArray(i, SortColumn1) <= ThisArray(j, SortColumn1)
                If Asc1 Then CompareResult = Not CompareResult
            Else    'If there are two columns to sort by
                Select Case ThisArray(i, SortColumn1)
                    Case Is < ThisArray(j, SortColumn1): CompareResult = Not Asc1
                    Case Is > ThisArray(j, SortColumn1): CompareResult = Asc1
                    Case Else
                        CompareResult = ThisArray(i, SortColumn2) <= ThisArray(j, SortColumn2)
                        If Asc2 Then CompareResult = Not CompareResult
                End Select
            End If
            If CompareResult Then    ' If compare result returns true, Flip rows
                For k = FirstCol To LastCol
                    lTemp = ThisArray(j, k)
                    ThisArray(j, k) = ThisArray(i, k)
                    ThisArray(i, k) = lTemp
                Next k
            End If
        Next j
    Next i
End Sub 
```

这是一个快速排序的实现：

```
Public Sub subQuickSort(var1 As Variant, _
    Optional ByVal lngLowStart As Long = -1, _
    Optional ByVal lngHighStart As Long = -1)

    Dim varPivot As Variant
    Dim lngLow As Long
    Dim lngHigh As Long

    lngLowStart = IIf(lngLowStart = -1, LBound(var1), lngLowStart)
    lngHighStart = IIf(lngHighStart = -1, UBound(var1), lngHighStart)
    lngLow = lngLowStart
    lngHigh = lngHighStart

    varPivot = var1((lngLowStart + lngHighStart) \ 2, 1)

    While (lngLow <= lngHigh)
        While (var1(lngLow, 1) < varPivot And lngLow < lngHighStart)
            lngLow = lngLow + 1
        Wend

        While (varPivot < var1(lngHigh, 1) And lngHigh > lngLowStart)
            lngHigh = lngHigh - 1
        Wend

        If (lngLow <= lngHigh) Then
            subSwap var1, lngLow, lngHigh
            lngLow = lngLow + 1
            lngHigh = lngHigh - 1
        End If
    Wend

    If (lngLowStart < lngHigh) Then
        subQuickSort var1, lngLowStart, lngHigh
    End If
    If (lngLow < lngHighStart) Then
        subQuickSort var1, lngLow, lngHighStart
    End If

End Sub

Private Sub subSwap(var As Variant, lngItem1 As Long, lngItem2 As Long)
    Dim varTemp As Variant
    varTemp = var(lngItem1, 1)
    var(lngItem1, 1) = var(lngItem2, 1)
    var(lngItem2, 1) = varTemp
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:10:07.597

我的想法：

*   您真的不想对超过 20-30 个项目（最多）的任何东西使用 N^2 算法。如果你有 5000-10000 行，从 BubbleSort 开始是一个错误，恕我直言
*   VBA 是不可预测的。除了放弃bubbleSort（[问巴拉克奥巴马](http://www.youtube.com/watch?v=k4RRi_ntQc8)）之外，您还想尝试在VBA 中做事的不同方式。

例如：

*   `for ... next`用循环替换`for ... each`循环：后者（自相矛盾）可以更快
*   尝试使用变体而不是立即转换为原始类型并使用它们。过去，VBA 处理变体的速度要快得多，但是 YMMV。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T23:06:35.363

这是我对任何感兴趣的人的快速排序实现。我确信代码可以清理很多但是，但这是一个好的开始。此代码在不到一秒的时间内对 10,000 行进行了排序。

```
 Option Explicit

  ' QuickSort for 2D array in form Array(cols,rows)
  ' Enter in 1, 2, or 3 columns to sort by, each can be either asc or desc
Public Sub QuickSortStart(ThisArray As Variant, sortColumn1 As Integer, asc1 As Boolean, Optional sortColumn2 As Integer = -1, Optional asc2 As Boolean = True, Optional sortColumn3 As Integer = -1, Optional asc3 As Boolean = True)

    Dim LowerBound As Integer
    Dim UpperBound As Integer

    LowerBound = LBound(ThisArray, 2)
    UpperBound = UBound(ThisArray, 2)

    Call QuickSort(ThisArray, LowerBound, UpperBound, sortColumn1, asc1, sortColumn2, asc2, sortColumn3, asc3)

End Sub

Private Sub QuickSort(ThisArray As Variant, FirstRow As Integer, LastRow As Integer, sortColumn1 As Integer, asc1 As Boolean, sortColumn2 As Integer, asc2 As Boolean, sortColumn3 As Integer, asc3 As Boolean)

    Dim pivot1 As Variant
    Dim pivot2 As Variant
    Dim pivot3 As Variant
    Dim tmpSwap As Variant
    Dim tmpFirstRow  As Integer
    Dim tmpLastRow   As Integer
    Dim FirstCol As Integer
    Dim LastCol As Integer
    Dim i As Integer

    tmpFirstRow = FirstRow
    tmpLastRow = LastRow
    FirstCol = LBound(ThisArray, 1)
    LastCol = UBound(ThisArray, 1)

    pivot1 = ThisArray(sortColumn1, (FirstRow + LastRow) \ 2)
    If sortColumn2 <> -1 Then
        pivot2 = ThisArray(sortColumn2, (FirstRow + LastRow) \ 2)
    End If
    If sortColumn3 <> -1 Then
        pivot3 = ThisArray(sortColumn3, (FirstRow + LastRow) \ 2)
    End If

    While (tmpFirstRow <= tmpLastRow)

        While (compareFirstLoop(ThisArray, pivot1, pivot2, pivot3, tmpFirstRow, sortColumn1, asc1, sortColumn2, asc2, sortColumn3, asc3) And tmpFirstRow < LastRow)
            tmpFirstRow = tmpFirstRow + 1
        Wend

        While (compareSecondLoop(ThisArray, pivot1, pivot2, pivot3, tmpLastRow, sortColumn1, asc1, sortColumn2, asc2, sortColumn3, asc3) And tmpLastRow > FirstRow)
            tmpLastRow = tmpLastRow - 1
        Wend

        If (tmpFirstRow <= tmpLastRow) Then
            For i = FirstCol To LastCol
                tmpSwap = ThisArray(i, tmpFirstRow)
                ThisArray(i, tmpFirstRow) = ThisArray(i, tmpLastRow)
                ThisArray(i, tmpLastRow) = tmpSwap
            Next i
            tmpFirstRow = tmpFirstRow + 1
            tmpLastRow = tmpLastRow - 1
        End If
    Wend

    If (FirstRow < tmpLastRow) Then
        Call QuickSort(ThisArray, FirstRow, tmpLastRow, sortColumn1, asc1, sortColumn2, asc2, sortColumn3, asc3)
    End If

    If (tmpFirstRow < LastRow) Then
        Call QuickSort(ThisArray, tmpFirstRow, LastRow, sortColumn1, asc1, sortColumn2, asc2, sortColumn3, asc3)
    End If

End Sub

Private Function compareFirstLoop(ThisArray As Variant, pivot1 As Variant, pivot2 As Variant, pivot3 As Variant, checkRow As Integer, sortColumn1 As Integer, asc1 As Boolean, sortColumn2 As Integer, asc2 As Boolean, sortColumn3 As Integer, asc3 As Boolean)

    If asc1 = True And ThisArray(sortColumn1, checkRow) < pivot1 Then
        compareFirstLoop = True
    ElseIf asc1 = False And ThisArray(sortColumn1, checkRow) > pivot1 Then
        compareFirstLoop = True

    'Move to Second Column
    ElseIf sortColumn2 <> -1 And ThisArray(sortColumn1, checkRow) = pivot1 Then
        If asc2 = True And ThisArray(sortColumn2, checkRow) < pivot2 Then
            compareFirstLoop = True
        ElseIf asc2 = False And ThisArray(sortColumn2, checkRow) > pivot2 Then
            compareFirstLoop = True

        'Move to Third Column
        ElseIf sortColumn3 <> -1 And ThisArray(sortColumn2, checkRow) = pivot2 Then
            If asc3 = True And ThisArray(sortColumn3, checkRow) < pivot3 Then
                compareFirstLoop = True
            ElseIf asc3 = False And ThisArray(sortColumn3, checkRow) > pivot3 Then
                compareFirstLoop = True

            Else
                compareFirstLoop = False
            End If
        Else
            compareFirstLoop = False
        End If
    Else
        compareFirstLoop = False
    End If

End Function

Private Function compareSecondLoop(ThisArray As Variant, pivot1 As Variant, pivot2 As Variant, pivot3 As Variant, checkRow As Integer, sortColumn1 As Integer, asc1 As Boolean, sortColumn2 As Integer, asc2 As Boolean, sortColumn3 As Integer, asc3 As Boolean)

    If asc1 = True And pivot1 < ThisArray(sortColumn1, checkRow) Then
        compareSecondLoop = True
    ElseIf asc1 = False And pivot1 > ThisArray(sortColumn1, checkRow) Then
        compareSecondLoop = True

    'Move to Second Column
    ElseIf sortColumn2 <> -1 And ThisArray(sortColumn1, checkRow) = pivot1 Then
        If asc2 = True And pivot2 < ThisArray(sortColumn2, checkRow) Then
            compareSecondLoop = True
        ElseIf asc2 = False And pivot2 > ThisArray(sortColumn2, checkRow) Then
            compareSecondLoop = True

        'Move to Third Column
        ElseIf sortColumn3 <> -1 And ThisArray(sortColumn2, checkRow) = pivot2 Then
            If asc3 = True And pivot3 < ThisArray(sortColumn3, checkRow) Then
                compareSecondLoop = True
            ElseIf asc3 = False And pivot3 > ThisArray(sortColumn3, checkRow) Then
                compareSecondLoop = True
            Else
                compareSecondLoop = False
            End If

        Else
            compareSecondLoop = False
        End If
    Else
        compareSecondLoop = False
    End If

End Function 
```

# mysql - 尝试使用 mysql 中的存储过程更新表时出错

> ID：15509256
> 
> 赞同：0
> 
> 时间：2013-03-19T19:58:44.650
> 
> 标签：mysql, procedure

更新 IDConfig SET FemaleID = FemaleID + 1；

出现错误，例如您正在使用安全更新模式，并且您尝试更新没有使用 KEY 列的 WHERE 的表 要禁用安全模式，请切换 Preferences -> SQL Queries 中的选项并重新连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:01:03.517

您的 SQL 工具使用此机制告诉您即将更新表中的所有记录。通常你有一个 WHERE 子句来限制应该更新的数据。

因此，要真正更新所有记录，请更改配置中的该选项或使用 WHERE 子句来限制要更新的数据。

您可能可以使用此查询欺骗您的工具

```
UPDATE IDConfig 
SET FemaleID = FemaleID + 1
WHERE 1 = 1 
```

# jquery - 为 jQuery 使用 CDN 时出错

> ID：15509266
> 
> 赞同：2
> 
> 时间：2013-03-19T19:59:18.520
> 
> 标签：jquery, asp.net, cdn

可能是显而易见的，但我对 jQuery 和 ajax 总体上还是很陌生。环境 - ASP.NET

我像这样引用jQuery：

```
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.10.1/jquery-ui.min.js" type="text/javascript"></script> 
<link href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.10.1/themes/blitzer/jquery-ui.css" rel="stylesheet" type="text/css"/> 
```

当我启动 web 项目时，我收到错误弹出窗口：

```
Unhandled exception at line 4, column 10920 in http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js

0x800a139e - JavaScript runtime error: Syntax error, unrecognized expression: img["data-over"]:eq(0) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:12:04.617

`data-over`是财产；它的价值，如果你有一个，被放在引号里。

`$('img[data-over]:eq(0)')`

对比

`$('img[data-over="somevalue"]:eq(0)')`

请参阅[此 Fiddle](http://jsfiddle.net/xjNw6/)以获取演示。

# java - 终止 (number).(number)[a](number)[d0] 在 java 中的 output(printf) 中意味着什么？

> ID：15509267
> 
> 赞同：1
> 
> 时间：2013-03-19T19:59:19.750
> 
> 标签：java, output

我有个问题。当我保存程序输出的 *.txt 时，我得到：0.021111111111111112a118d0 和更多的东西。

问题是：

这个数字中的“d0”和“a”是什么意思？
我不知道“d0”是否与格式（双精度或十进制）有关，而“a”与指数或其他事物有关。
我在网上搜索，但没有。你能告诉我的任何事情我都会感谢你的。
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:06:17.003

我猜你说的是[十六进制数](http://en.wikipedia.org/wiki/Hexadecimal)，它有底数`16`（从 0 到 9 ，然后是 a(10) ， b(11) ， c(12) ， d(13) ， e(14) 和 f(15) )

我认为`d0`是 d-->(13) 和 0-->(0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:22:49.907

```
String.format("%a, or in capitals %A", 0x1.5p3, 0x1p3); 
```

十六进制浮点文字看起来像`0x(mantissa)p(exponent)`. 使用[格式](http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#syntax) 。`%a`

# c++ - std::mt19937 是否需要预热？

> ID：15509270
> 
> 赞同：47
> 
> 时间：2013-03-19T19:59:20.773
> 
> 标签：c++, random, c++11, standard-library, mersenne-twister

我读过许多伪随机数生成器需要许多样本才能“预热”。使用 std::random_device 播种 std::mt19937 是这种情况，还是我们可以期望它在构造后准备好？有问题的代码：

```
#include <random>
std::random_device rd;
std::mt19937 gen(rd()); 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-03-19T20:37:21.020

Mersenne Twister 是一个基于移位寄存器的 pRNG（伪随机数生成器），因此会受到长期运行 0 或 1 的不良种子的影响，这会导致相对可预测的结果，直到内部状态充分混合。

然而，采用单个值的构造函数对该种子值使用了一个复杂的函数，该函数旨在最大限度地减少产生这种“坏”状态的可能性。还有第二种方法可以`mt19937`通过符合 SeedSequence 概念的对象来初始化直接设置内部状态的位置。这是第二种初始化方法，您可能需要关注选择“良好”状态或进行热身。

* * *

该标准包括一个符合 SeedSequence 概念的对象，称为`seed_seq`. `seed_seq`获取任意数量的输入种子值，然后对这些值执行某些操作，以生成适合直接设置 pRNG 内部状态的不同值序列。

这是一个使用足够随机数据加载种子序列以填充整个`std::mt19937`状态的示例：

```
std::array<int, 624> seed_data;
std::random_device r;
std::generate_n(seed_data.data(), seed_data.size(), std::ref(r));
std::seed_seq seq(std::begin(seed_data), std::end(seed_data));

std::mt19937 eng(seq); 
```

这确保了整个状态是随机的。此外，每个引擎都指定了它从 seed_sequence 读取的数据量，因此您可能需要阅读文档以找到适用于您使用的任何引擎的信息。

`std::random_device`尽管在这里我完全从,加载了 seed_seq ，但是`seed_seq`指定了一些不是特别随机的数字应该可以正常工作。例如：

```
std::seed_seq seq{1, 2, 3, 4, 5};
std::mt19937 eng(seq); 
```

在下面的评论中，Cubbi 表示`seed_seq`通过为您执行热身序列来工作。

以下是播种的“默认值”：

```
std::random_device r;
std::seed_seq seed{r(), r(), r(), r(), r(), r(), r(), r()};
std::mt19937 rng(seed); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-05-06T09:41:54.470

如果您只使用一个 32 位值作为种子，那么您将得到的只是通过状态空间的相同 2^32 轨迹之一。如果您使用带有 KiB 状态的 PRNG，那么您可能应该将所有这些作为种子。如@bames63'答案的评论中所述，`std::seed_seq`如果您想用随机数初始化整个状态，使用可能不是一个好主意。可悲的是，`std::random_device`不符合这个`SeedSequence`概念，但您可以编写一个包装器：

```
#include <random>
#include <iostream>
#include <algorithm>
#include <functional>

class random_device_wrapper {
    std::random_device *m_dev;
public:
    using result_type = std::random_device::result_type;
    explicit random_device_wrapper(std::random_device &dev) : m_dev(&dev) {}
    template <typename RandomAccessIterator>
    void generate(RandomAccessIterator first, RandomAccessIterator last) {
        std::generate(first, last, std::ref(*m_dev));
  }
};

int main() {

    auto rd = std::random_device{};
    auto seedseq = random_device_wrapper{rd};
    auto mt = std::mt19937{seedseq};
    for (auto i = 100; i; --i)
        std::cout << mt() << std::endl;

} 
```

这至少在您启用概念之前有效。根据您的编译器是否知道`SeedSequence`C++20 `concept`，它可能无法工作，因为我们只提供缺少的`generate()`方法，没有别的。但是，在鸭式模板编程中，该代码就足够了，因为 PRNG 不存储种子序列对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T20:04:50.813

我相信在某些情况下，MT 可以“较差”地播种，从而导致非最佳序列。如果我没记错的话，全零播种就是这样一种情况。如果这对您来说是一个严重的问题，我建议您尝试使用 WELL 生成器。我相信它们更灵活——种子的质量并不重要。（也许更直接地回答您的问题：专注于播种可能更有效，而不是播种不佳然后尝试生成一堆样本以使生成器达到最佳状态。）

# html - iFrame 链接不起作用

> ID：15509275
> 
> 赞同：2
> 
> 时间：2013-03-19T19:59:25.397
> 
> 标签：html, facebook, iframe, soundcloud, facebook-iframe

我创建了一个位于 heroku 的 Ruby on Rails 应用程序，您可以在此处查看“ [http://soundcloud-dj-contest.herokuapp.com/](http://soundcloud-dj-contest.herokuapp.com/) ”

应用程序运行良好，我已将其放在 facebook 上的 iFrame 中，因此它应该像 facebook 应用程序一样工作。每个链接都在“Logirajte se da uploadate”顶部的此按钮旁边工作。此链接指向另一个页面，soundcloud “soundcloud-dj-contest.herokuapp.com/login”。

它在主页上工作，但在 iFrame 内我无法让它工作。我不知道该怎么办 ：/

我在这里上传了 iFrame [http://facemaskbliss.com/test/test_frame.html](http://facemaskbliss.com/test/test_frame.html)

请告诉我如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:06:13.360

尝试放置`target="_blank"`并提供完整路径，而不仅仅是“/ login”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T11:02:03.157

iFrame 中的链接也有同样的问题。我使用的是绝对网址（“ [http://example.com](http://example.com) ”）。

我终于通过使用页面的相对路径（“../example_folder/”）让它工作了。

我的猜测是，出于安全原因，使用**https**的“外部”链接现在在 iFrame 中被“解除”，即使它们位于同一个域中。因为链接（绝对网址）在不使用**https**时有效。

编辑：现在我想到这是因为我混合了**http**和**https**。

# mysql - MySQL 到 JSON 的格式不正确

> ID：15509276
> 
> 赞同：0
> 
> 时间：2013-03-19T19:59:34.690
> 
> 标签：mysql, json

我正在尝试从 MySQL 查询返回 JSON 格式的结果，但无法获得正确的格式 - 它需要是例如

```
{comCom:'test 3', comUid:'63',... etc 
```

但我得到的是没有撇号

```
{comCom:test 3, comUid:63,... etc 
```

我在 PHP 中运行如下查询（为便于阅读而缩短）

```
$result = mysql_query("select...

...GROUP_CONCAT(CONCAT('{comCom:',ww.comment, ', comUid:',h.user_id,', comName:',h.name,', comPic:',h.live_prof_pic,',comUrl:',h.url,',comWhen:',time_ago(ww.dateadded),'}')) comment,... 
```

我怎样才能得到标点符号？

我知道`mysql_query`顺便说一句已被弃用，只是在将东西转移到`MySQLi`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:13:01.260

你不能用 逃避这个`'`角色`\'`吗？

```
...GROUP_CONCAT(CONCAT('{comCom:\'',ww.comment, '\', comUid:\'',h.user_id,'\', comName:\'',h.name,'\', comPic:\'',h.live_prof_pic,'\',comUrl:\'',h.url,'\',comWhen:\'',time_ago(ww.dateadded),'\'}')) 
```

或混合`"`使用`'`

```
...GROUP_CONCAT(CONCAT("{comCom:'",ww.comment, "', comUid:'",h.user_id,"', comName:'",h.name,"', comPic:'",h.live_prof_pic,"',comUrl:'",h.url,"',comWhen:'",time_ago(ww.dateadded),"'}")) 
```

# c# - 在 static void main 中使用非静态自定义类

> ID：15509277
> 
> 赞同：-1
> 
> 时间：2013-03-19T19:59:35.073
> 
> 标签：c#

我正在关注这个 C# 教程[http://csharp-station.com/Tutorial/CSharp/Lesson20](http://csharp-station.com/Tutorial/CSharp/Lesson20)，这是一个初学者问题。

下面我正在创建一个新的字典集合**客户**的**客户**公共但不是静态类。简单的问题是我不能在我的方法中使用该`customers.Add`行。`static void main`我在这里想念什么？**客户**也必须是静态的吗？我应该在这里做什么才能创建**客户**对象。

```
Dictionary<int, Customer> customers = new Dictionary<int, Customer>();

Customer cust1 = new Customer(1, "Cust 1");
Customer cust2 = new Customer(2, "Cust 2");
Customer cust3 = new Customer(3, "Cust 3");

customers.Add(cust1.ID, cust1);
customers.Add(cust2.ID, cust2);
customers.Add(cust3.ID, cust3);

foreach (KeyValuePair<int, Customer> custKeyVal in customers)
{
    Console.WriteLine(
        "Customer ID: {0}, Name: {1}",
        custKeyVal.Key,
        custKeyVal.Value.Name);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:03:06.407

您的代码工作正常。我无法打开您发布的链接，但我猜您在此过程中误解了一些东西。

您不能从静态上下文访问类的非静态成员。让我解释...

```
class Foo
{
    int id;
    static void doStuff()
    {
        id++; // <-- Error!
    }
} 
```

但这很好：

```
class Foo
{
    static void doStuff()
    {
        var fooBar = new Dictionary<Foo, Bar>(); // Create instance
        fooBar.Add(new Foo(), new Bar()); // No error :)
    }
} 
```

就此而言，这也是（请注意，我指`id`的是 的成员`foo`）：

```
class Foo
{
    int id;
    static void doStuff()
    {
        var foo = new Foo(); // Create instance
        foo.id++; // No error :)
    }
} 
```

只要确保你的程序类看起来像这样......

```
public static class Program
{
    public static void Main()
    {
        Dictionary<int, Customer> customers = new Dictionary<int, Customer>();

        Customer cust1 = new Customer(1, "Cust 1");
        Customer cust2 = new Customer(2, "Cust 2");
        Customer cust3 = new Customer(3, "Cust 3");

        customers.Add(cust1.ID, cust1);
        customers.Add(cust2.ID, cust2);
        customers.Add(cust3.ID, cust3);

        foreach (KeyValuePair<int, Customer> custKeyVal in customers)
        {
            Console.WriteLine(
                "Customer ID: {0}, Name: {1}",
                custKeyVal.Key,
                custKeyVal.Value.Name);
        }
    }
} 
```

# unity3d - EA Games 使用什么来为 iPhone 开发游戏？

> ID：15509281
> 
> 赞同：2
> 
> 时间：2013-03-19T19:59:49.390
> 
> 标签：unity3d, game-engine

EA Games (Electronic Arts) 用什么来开发具有如此高画质的 iPhone 游戏？它是否使用内置的 OpenGL 功能，或者它们是否具有我们可以使用的引擎，例如 Unity 游戏开发引擎？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T15:38:49.153

iOs 上的所有引擎都使用 OpenGL ES 进行渲染。EA 与大多数大型发行商一样与许多平台合作。[2010 年EA 表示他们将在部分游戏中使用 Unity3D](http://techcrunch.com/2010/09/22/ea-unity/)时，这是一个很大的支持。查看[“Made with Unity”](http://unity3d.com/gallery/made-with-unity/game-list)页面，了解更多使用该引擎的标题。

# jquery - 自定义提交网站中包含的谷歌表单的通知

> ID：15509285
> 
> 赞同：0
> 
> 时间：2013-03-19T19:59:54.030
> 
> 标签：jquery, jquery-validate, google-sheets

**我尝试使验证谷歌表单内置网站并在提交表单时显示自定义通知。**

*   对于表单验证，我使用[jquery 验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)——一切都很好。

*   我找到了如何[在 iframe 中使用提交和显示通知的提示](http://www.2webvideo.com/customizing-google-docs-form-for-email-validation-with-free-jquery-script)

> 对我来说，如果提交，则需要显示 div 和隐藏表单。

```
<script type="text/javascript">
$().ready(function() {

   $("#ss-form").validate({meta: "validate"});

   function showHide() {
      $('#form_is_submitted').css('display', 'block');
      $('#ss-form').css('display', 'none');
   }
});
</script>

<div id="form_is_submitted" style="display:none;">ok! form is submitted</div>

<form action="spreadsheet link" id="ss-form" method='post' onsubmit="showHide(); return false;">
                               ...form code...
</form> 
```

此代码无法正常工作...通过谷歌表单重定向到通知

**我究竟做错了什么？**

* * *

**编辑**

当我使用此代码时 - 我看到我的通知 (#form_is_submitted) 并且表单已验证但信息未提交到谷歌电子表格

```
<script type="text/javascript">
   $(document).ready(function () {

    $('#ss-form').validate({ 
        submitHandler: function (form) {
            $('#form_is_submitted').css('display', 'block');
            $('#ss-form').css('display', 'none');
        }
    });

});

    </script>

    <div id="form_is_submitted" style="display:none;">ok! form is submitted</div>

    <form action="spreadsheet link" id="ss-form" method='post'>
                                   ...form code...
    </form> 
```

* * *

当我使用此代码时 - 表单已验证，信息已提交到谷歌电子表格，但页面被重定向到谷歌表单通知。

```
<script type="text/javascript">
   $(document).ready(function () {

    $("#ss-form").validate({meta: "validate"});

   });

 </script>

    <div id="form_is_submitted" style="display:none;">ok! form is submitted</div>

    <form action="spreadsheet link" id="ss-form" method='post'>
                                   ...form code...
    </form> 
```

对于之前的愚蠢错误，我正在努力解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T04:56:39.603

不太确定你在这里做什么，但使用内联`onSubmit`处理程序是完全多余和不必要的。

**1)** 使用 jQuery，您将永远不需要使用内联 JavaScript。任何内联 JavaScript 都可以替换为 jQuery 事件侦听器函数。 [请参阅 jQuery`.on()`](http://api.jquery.com/on/)。

**2)** 但是在这种情况下，jQuery Validate 插件已经内置了所有各种事件侦听器。只需使用[jQuery Validate 插件](http://docs.jquery.com/Plugins/Validation/validate#toptions)[的内置`submitHandler`](http://docs.jquery.com/Plugins/Validation/validate#toptions)回调函数。它仅在表单有效时触发。

**演示：http: [//jsfiddle.net/eP7kS/](http://jsfiddle.net/eP7kS/)**

```
$(document).ready(function () {

    $('#ss-form').validate({ 
        // your rules and options,
        submitHandler: function (form) {
            $('#form_is_submitted').css('display', 'block');
            $(form).css('display', 'none');
            return false;
        }
    });

}); 
```

* * *

**编辑：**

你从来没有清楚地解释过你想要这一切做什么。但是，听起来您想要[jQuery`.ajax`](http://api.jquery.com/jQuery.ajax/)，并且它也包含在`submitHandler`.

```
$(document).ready(function () {

    $('#ss-form').validate({ 
        // your rules and options,
        submitHandler: function (form) {
            $(form).ajax({
                url:  'spreadsheet link',  // whatever url to your action
                data: $(form).serialize(),  // the form data
                success: function () {
                    $('#form_is_submitted').css('display', 'block');
                    $(form).css('display', 'none');
                }
            });
            return false;  // this is critical to prevent the page from reloading
        }
    });

}); 
```

**演示：http: [//jsfiddle.net/cG7RW/1/](http://jsfiddle.net/cG7RW/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:11:38.077

感谢 Sparky 的建议。

```
<style>
#hidden_iframe,
#form_is_submitted{
    display: none;
}
</style>

<script>
    $(document).ready(function () {

        $("#ss-form").validate({meta: "validate"});

        $('#ss-form').submit(function () {
            if ($("#ss-form").valid() == true) { 
               $('#form_is_submitted').css('display', 'block');
               $("#ss-form").css('display', 'none');
               return true;
            }
        });

   });
</script>

<div id="form_is_submitted">ok!</div>

<iframe name="hidden_iframe" id="hidden_iframe"></iframe>

<form action="google_form_link" method="POST" id="ss-form" target="hidden_iframe">

    ..form code..

</form> 
```

*   **[电子表格](https://docs.google.com/spreadsheet/ccc?key=0AqmhWQ_A7q_adFZxazJLNjdaX0JOOW1CYWpTZ1pLbHc#gid=0)**
*   **[形式](https://docs.google.com/forms/d/1OKdiKB_bWtYHldIR_agoaG2hW8_MLKcVHUXGe2A1r6o/viewform)**
*   **[jsfiddle](http://jsfiddle.net/v2pwww/HmVqj/6/)**

# c++ - 带有迭代器的 for 循环产生错误的结果 c++

> ID：15509298
> 
> 赞同：1
> 
> 时间：2013-03-19T20:01:19.620
> 
> 标签：c++, unix, g++

我正在创建一个 HTML 文件，该文件创建一个名为 Quake 的对象的 Google 地图，其中包含纬度、经度、幅度和深度。另一个名为 QuakeData 的类是创建 Quake 对象向量的类。

下面的函数获取对象的向量，并获取它们的详细信息（纬度、经度和幅度），然后以这种格式将它们输出到 HTML 中：

```
[58.678, -151.887, 'M2.6'], 
```

其中第一个数字是纬度，第二个是经度，第三个是幅度，显示格式。

这是我目前拥有的循环，它使用 getter 提取纬度、经度和幅度：

```
double mag;
double lat;
double lon;
string complete;
ostringstream out;
vector<Quake>::const_iterator i;
for (i = quakes.begin(); i != quakes.end(); i++)
{
    mag = i->getMagnitude();
    lat = i->getLatitude();
    lon = i->getLongitude();

    out << "[" << lat << ", " << lon << ", 'M" << mag << "'],";
    complete = out.str();
    outfile << complete << endl;
} 
```

但是，这会产生如下结果：

```
[58.678, -151.887, 'M2.6'], (end of line)
[58.678, -151.887, 'M2.6'],[33.92, -117.08, 'M2.9'],(end of line)
[58.678, -151.887, 'M2.6'],[33.92, -117.08, 'M2.9'],[-3.203, 142.864, 'M4.7'],(end of line) 
```

我想要的是：

```
[58.678, -151.887, 'M2.6'],(end of line)
[33.92, -117.08, 'M2.9'],(end of line)
[-3.203, 142.864, 'M4.7'],(end of line) 
```

这里到底有什么问题？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T20:03:13.377

每个循环都将新数据附加到现有流中：将声明移动到循环内，以便它为每一行使用一个新实例。

```
for (i = quakes.begin(); i != quakes.end(); i++)
{
  ostringstream out; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T20:03:14.147

您需要在迭代之间清除 ostringstream。使用`out.str(""); out.clear();`（[在此处](https://stackoverflow.com/questions/5288036/how-to-clear-ostringstream)查看解释）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T20:07:18.177

```
complete = out.str();
out.str(""); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T20:22:43.010

正如人们指出的那样，您需要重置`ostringstream`或缩小其范围。

编写代码的一种更惯用和更有效的方法是提取代码以将 a 输出`Quake`到 an `ostream`，然后`copy`直接使用标准算法将其输出到输出流，而无需中间`ostringstream`：

```
ostream& operator<<(ostream& os, const Quake& quake) {
    os << "["
       << quake.getLatitude() << ", "
       << quake.getLongitude() << ", "
       << "'M" << quake.getMagnitude()
       << "']";
    return os;
}

int main() {
    vector<Quake> quakes;
    ofstream outfile("quakes.txt");

    copy(quakes.begin(), quakes.end()
        ostream_iterator<Quake>(outfile, ",\n"));
} 
```

# python - 在python中从多个列表中构建单词字典

> ID：15509299
> 
> 赞同：0
> 
> 时间：2013-03-19T20:01:50.273
> 
> 标签：python, dictionary, count, frequency

我有一个 100 分的字典列表，如下所示：

```
datapoint1 a:1 b:2 c:6
datapoint2 a:2 d:8 p:10
.....
datapoint100: c:9 d:1 z:12 
```

我想将列表打印到文件中，如下所示：

```
 a b c d ...... z
datapoint1 1 2 6 0 ...... 0
datapoint2 2 0 0 8 ...... 0
.........
.........
datapoint100 0 0 9 1 ...... 12 
```

这里提到的 a,b,c...z 只是举例，实际字数是事先不知道的，所以总字数不是 26，它可以是 1000/ 10000 和 a, b, ... . 将被替换为真实的单词，例如“my”、“hi”、“tote”……等。

我一直在考虑尝试这样做：

1.  建立一个单词字典让我们称之为全局字典
2.  然后构建一个字典列表，其中每个字典代表一个数据点
3.  然后尝试将字典列表映射到全局字典

但是这种方法在python中似乎很复杂。在python中有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:26:43.400

如果您不太关心列对齐的繁琐位，这还不错：

```
datapoints = [{'a': 1, 'b': 2, 'c': 6},
              {'a': 2, 'd': 8, 'p': 10},
              {'c': 9, 'd': 1, 'z': 12}]

# get all the keys ever seen
keys = sorted(set.union(*(set(dp) for dp in datapoints)))

with open("outfile.txt", "wb") as fp:
    # write the header
    fp.write("{}\n".format(' '.join([" "] + keys)))
    # loop over each point, getting the values in order (or 0 if they're absent)
    for i, datapoint in enumerate(datapoints):
        out = '{} {}\n'.format(i, ' '.join(str(datapoint.get(k, 0)) for k in keys))
        fp.write(out) 
```

生产

```
 a b c d p z
0 1 2 6 0 0 0
1 2 0 0 8 10 0
2 0 0 9 1 0 12 
```

正如评论中提到的，[熊猫](http://pandas.pydata.org)解决方案也很不错：

```
>>> import pandas as pd
>>> df = pd.DataFrame(datapoints).fillna(0).astype(int)
>>> df
   a  b  c  d   p   z
0  1  2  6  0   0   0
1  2  0  0  8  10   0
2  0  0  9  1   0  12
>>> df.to_csv("outfile_pd.csv", sep=" ")
>>> !cat outfile_pd.csv
 a b c d p z
0 1 2 6 0 0 0
1 2 0 0 8 10 0
2 0 0 9 1 0 12 
```

如果你真的需要很好地对齐列，那么也有办法做到这一点，但我从不需要它们，所以我对它们了解不多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:31:18.813

**程序：**

```
data_points = [
    {'a': 1, 'b': 2, 'c': 6},
    {'a': 2, 'd': 8, 'p': 10},
    {'c': 9, 'd': 1, 'z': 12},
    {'e': 3, 'f': 6, 'g': 3}
]

merged_data_points = {
}

for data_point in data_points:
    for k, v in data_point.items():
        if k not in merged_data_points:
            merged_data_points[k] = []
        merged_data_points[k].append(v)

# print the merged datapoints
print '{'
for k in merged_data_points:
    print '  {0}: {1},'.format(k, merged_data_points[k])
print '}' 
```

**输出：**

```
{
  a: [1, 2],
  c: [6, 9],
  b: [2],
  e: [3],
  d: [8, 1],
  g: [3],
  f: [6],
  p: [10],
  z: [12],
} 
```

# sql - 根据打印报告的时间显示结果

> ID：15509300
> 
> 赞同：1
> 
> 时间：2013-03-19T20:01:50.580
> 
> 标签：sql, oracle

我正在创建一个 Oracle 报告，我想根据我打印报告的时间来显示某些结果。有一个名为 apply_date 的字段。例如，如果我打印报告 <= sysdate of 3/15，那么我只想显示 apply_date 为 3/1 - 3/15 的记录。这也适用于每月 30 日的打印。如果我在 3/15 之后打印报告，那么它只会显示 apply_date >= 3/16 的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:51:24.033

你想要一个`where`像这样的子句：

```
where (to_char(sysdate, 'DD') <= '15' and
       to_char(apply_date, 'YYYY-MM') = to_char(sysdate, 'YYYY-MM') and
       to_char(apply_date, 'DD') between '00' and '15'
      ) or
      (to_char(sysdate, 'DD') >= '16' and
       to_char(apply_date, 'YYYY-MM') = to_char(sysdate, 'YYYY-MM') and
       to_char(apply_date, 'DD') >= '16'
      ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:03:32.007

为了充分利用索引并为优化器提供基数的最佳估计，我将尝试构建 SQL，以便谓词不依赖于应用于 apply_date 的函数：

```
 where apply_date >= case
                     when extract(day from sysdate) < 16
                     then trunc(sysdate,'MM')
                     else trunc(sysdate,'MM')+16
                     end
   and apply_date <  case
                     when extract(day from sysdate) >= 16
                     then add_months(trunc(sysdate,'MM'),1)
                     else trunc(sysdate,'MM')+16
                     end 
```

在执行时，谓词的 RHS 将转换为：

```
 where apply_date >= <date>
   and apply_date <  <date> 
```

# php - 使用 htmlspecialchars 转换引号并在 PHP 中保留 HTML 标签

> ID：15509302
> 
> 赞同：0
> 
> 时间：2013-03-19T20:01:53.303
> 
> 标签：php, html, quotes, double-quotes, htmlspecialchars

我有一个隐藏的输入标签，我希望它的值在其中包含引号。我将如何转义引号以便我可以将它用于值？

HTML

```
<input type="hidden" name="edited_terms" 
value="<p>\"Please enter any additional terms and conditions here.\"</p>" /> 
```

PHP

```
$terms = mysql_real_escape_string($terms);
echo '<input type="hidden" name="edited_terms" value="'.$terms.'" />'; 
```

我想同时使用单引号和双引号，但是将其设置为`value='<p>\"Please enter any additional terms and conditions here.\"</p>'`不允许我使用单引号。

该功能`htmlspecialchars`让我完成此操作，但它会摆脱 HTML 标记。例如，`<p>`将转换为`&lt;p&gt;`. 我希望能够保留`<p>`标签并将引号转换为`&quot;`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:15:12.097

试试这个丹尼尔：

```
<input name="edited_terms" 
value="<p>&quot;Please enter any additional terms and conditions here.&quot;</p>" /> 
```

**更新PHP：**

```
$terms ="<p>&quot;Please enter any additional terms and conditions here.&quot;</p>";           
echo '<input type="hidden" name="edited_terms" value="'.$terms.'" />'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:18:44.873

首先，HTML 不是 MySQL。所以 MySQL 函数在这里无济于事。

二、[`htmlspecialchars`](http://php.net/htmlspecialchars)在 HTML 属性值上使用：

```
$terms = htmlspecialchars($terms);
echo '<input type="hidden" name="edited_terms" value="'.$terms.'" />'; 
```

对于单引号中的属性值，请`htmlspecialchars`与*ENT_QUOTES*标志一起使用。

# asp.net - 逐字说明符后应有关键字、标识符或字符串：@

> ID：15509303
> 
> 赞同：4
> 
> 时间：2013-03-19T20:01:53.577
> 
> 标签：asp.net

我的页面上有一个奇怪的问题...我有这两个页面，如果您没有打开它们，您的应用程序将无法启动...

如果这两个页面已关闭，我会收到我在这个问题的标题中描述的错误。

```
 Error 1   Keyword, identifier, or string expected after verbatim specifier: @ 
```

它总是指向第`line`一个`page.apsx:`

```
 <%@ Page Title="Forza - Chamados" Language="C#" MasterPageFile="~/MasterAdm.Master" AutoEventWireup="true" CodeBehind="TodosChamados.aspx.cs" Inherits="Testando.TodosChamados" %>

<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Relatorio.aspx.cs" Inherits="Testando.Relatorio" %> 
```

会是什么呢 ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-19T20:23:09.827

我找到了解决我奇怪问题的方法......我不知道为什么，我也不知道 set a page property 之间的区别`Build Action = Content / Complie`。但我所做的只是将它们设置为`Content`而不是`compile`像魅力一样工作！

感谢[这篇](https://stackoverflow.com/a/2090381/1919644)文章。

# c# - 从未映射的抽象中间类继承的连接子类

> ID：15509306
> 
> 赞同：2
> 
> 时间：2013-03-19T20:01:56.143
> 
> 标签：c#, nhibernate, mapping-by-code

我有一个在概念上类似于此的类层次结构：

![在此处输入图像描述](../Images/7d0d7109a2aca9c6fae9b81ee0d9b642.png)

也就是说，有一个抽象基类 ( `Relation`) 和几个派生类。在实践中，`Customer`共享`Supplier`了很多代码，所以我将共同点重构为一个抽象类`BusinessContact`。现在实际的类层次结构如下所示：

![在此处输入图像描述](../Images/e6f5967aace9f31c40d97fca5bb8299c.png)

或在代码中：

```
public abstract class Relation
{
    public virtual int Id { get; set; }
}

public class ContactPerson : Relation
{
    public virtual string PhoneNumber { get; set; }
}

public abstract class BusinessContact : Relation
{
    public virtual string Name { get; set; }
}

public class Customer : BusinessContact
{
    public virtual string CustomerNumber { get; set; } 
}

public class Supplier : BusinessContact
{
    public virtual string SupplierNumber { get; set; }
} 
```

我想使用 NHibernate 中的连接子类，使用按代码映射 ( )将此层次结构映射到四个表 ( `Relation`、`ContactPerson`和)。我的映射如下所示：`Customer``Supplier``ModelMapper`

```
var mapper = new ModelMapper();

mapper.Class<Relation>(map =>
{
    map.Id(x => x.Id, id => id.Generator(Generators.Native));
});

mapper.JoinedSubclass<ContactPerson>(map =>
{
    map.Key(key => key.Column("Id"));
    map.Property(x => x.PhoneNumber);
});

mapper.JoinedSubclass<Customer>(map =>
{
    map.Key(key => key.Column("Id"));
    map.Property(x => x.Name);
    map.Property(x => x.CustomerNumber);
});

mapper.JoinedSubclass<Supplier>(map =>
{
    map.Key(key => key.Column("Id"));
    map.Property(x => x.Name);
    map.Property(x => x.SupplierNumber);
}); 
```

但是，一旦我尝试将映射添加到配置中，就会出现异常：

```
NHibernate.MappingException: Cannot extend unmapped class: BusinessContact 
```

我基本上明白为什么会发生这种情况。生成的映射如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<hibernate-mapping xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" namespace="JoinedSubClassMapping" assembly="JoinedSubClassMapping" xmlns="urn:nhib    ernate-mapping-2.2">
  <class name="Relation" abstract="true">
    <id name="Id" type="Int32">
      <generator class="native" />
    </id>
  </class>
  <joined-subclass name="ContactPerson" extends="Relation">
    <key column="Id" />
    <property name="PhoneNumber" />
  </joined-subclass>
  <joined-subclass name="Customer" extends="BusinessContact">
    <key column="Id" />
    <property name="CustomerNumber" />
  </joined-subclass>
  <joined-subclass name="Supplier" extends="BusinessContact">
    <key column="Id" />
    <property name="SupplierNumber" />
  </joined-subclass>
</hibernate-mapping> 
```

`Customer`并在他们的属性中`Supplier`定义，就好像模型中的“正常”实体一样。由于没有 的映射，因此失败，或者当然。请注意，“名称”属性（定义在其中也不会出现在映射中。`BusinessContact``extends``BusinessContact``BusinessContact``BusinessContact`

我*希望*映射看起来像这样：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" namespace="JoinedSubClassMapping" assembly="JoinedSubClassMapping" xmlns="urn:nhibernate-mapping-2.2">
  <class name="Relation" abstract="true">
    <id name="Id" type="Int32">
      <generator class="native" />
    </id>
  </class>
  <joined-subclass name="ContactPerson" extends="Relation">
    <key column="Id" />
    <property name="PhoneNumber" />
  </joined-subclass>
  <joined-subclass name="Customer" extends="Relation">
    <key column="Id" />
    <property name="CustomerNumber" />
    <property name="Name" />
  </joined-subclass>
  <joined-subclass name="Supplier" extends="Relation">
    <key column="Id" />
    <property name="SupplierNumber" />
    <property name="Name" />
  </joined-subclass>
</hibernate-mapping> 
```

也就是说，创建`Supplier`和`Customer`扩展 Relation 并包含（否则未映射的）`BusinessContact`类的所有映射属性。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:14:30.340

这是一个解决方案：

```
class MyInspector : ExplicitlyDeclaredModel {
    public override bool IsEntity(Type type) {
        if (type == typeof (BusinessContact))
            return false;
        return base.IsEntity(type);
    }
}

var mapper = new ModelMapper(new MyInspector()); 
```

# android - 外包安卓应用登录

> ID：15509309
> 
> 赞同：0
> 
> 时间：2013-03-19T20:01:58.117
> 
> 标签：android, python, google-app-engine, oauth-2.0, endpoint

我已经阅读了很多关于将 OAuth2.0 与 google 端点一起使用的内容，以至于我头晕目眩。我还阅读[了需要 SignIn 的 Android 应用程序的 OpenID](https://stackoverflow.com/questions/3330761/openid-for-android-apps-that-require-signin)。也许我在兜圈子；我不知道。所以也许这里有人可以真正帮助我。

通常，当我开发后端时，我会推出自己的用户身份验证协议。就像是：

*   注册：用户`POST`注册表到我的后端；后端将用户添加到`user_db`：电子邮件，用户名，密码等。

*   登录：用户`POST`登录表单（用户名、密码）；后端返回令牌；用户使用令牌随后调用我的后端 api 来访问任何内容；直到用户注销。

但我现在正在专门为移动应用开发一个后端：带有应用引擎后端的安卓移动应用，该后端使用 python 和 google-endpoint 注释构建。因此，我不想拥有一个典型的`Login or Register`页面，而是想外包用户登录：我希望用户使用他们的谷歌帐户通过`OAuth2.0`. 所以新的流程是这样的：

*   用户从 Google Play 下载我的应用
*   用户使用 google OAuth2.0 登录（或者我的应用程序会自动登录？--首选）
*   使用从`Google OAuth2.0`用户获得的令牌（？）可以访问我的后端 api 来做任何事情。

所以很自然我的问题是：成功完成此任务的人会用一些代码分享他们的智慧吗？另外，请解释我的后端如何知道用户确实经过身份验证。用户注销怎么样，我要处理吗？这又是一个带有应用引擎后端（使用端点注释）的 android 应用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:45:56.437

我可以用一组新的项目符号回答您的部分问题：

新的流程将是这样的：

*   用户下载应用（接受 GET_ACCOUNTS 和 USE_CREDENTIALS 权限）
*   用户第一次运行应用程序（激活它）。
    （您的应用现在有权针对此设备上的 Google 帐户进行身份验证。）
*   如果用户有多个 Google 帐户，您可以询问他们使用哪个帐户。
*   您验证所选的 Google 帐户。
    （您需要的代码示例[在这里](https://developers.google.com/appengine/docs/python/endpoints/consume_android#making-authenticated-calls)。）
*   您的服务器代码接收 App Engine 'User' 对象作为 Endpoint 调用的第一个参数。

上面的链接也指向井字游戏示例。它的后端是用 Java 编写的，但它应该对你仍然有用，尤其是 Android 的东西。当我因阅读而头晕目眩时，是时候开始编码了。

# java - AsyncTask：我误解了什么？

> ID：15509311
> 
> 赞同：1
> 
> 时间：2013-03-19T20:02:02.303
> 
> 标签：java, android, asynchronous, android-asynctask

My`activity`包含一个 inner `private class`，这基本上就是它的样子，但有问题：

```
public class MyActivity extends Activity
{
    // My xmlData that I want to fill in the asynchronous task
    XMLData xmlData;

    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);

        GetXMLTask task = new GetXMLTask(this);
        task.execute(url);

        if(xmlData == null) System.out.print("problem");
        // Prints "problem" : my xmlData is null, why?
    }

    private class GetXMLTask extends AsyncTask<String, Void, Void>
    {
        public GetXMLTask(Activity context)
        {
            // Constructor
        }

        protected Void doInBackground(String... params)
        {
            // Here some stuff to get and parse my XML
            xmlData = new XMLData(list);
            System.out.print(xmlData.list.size());
            // this line shows that I correctly fill my xmlData object
        }
    }
} 
```

问题是在调用内部异步类之后，我的 xmlData 值为 null，我不知道为什么。我也在我的`GetXMLTask`：

```
MyActivity.this.xmlData = new XMLData(list); 
```

还是不行，为什么呢？我究竟做错了什么？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-19T20:04:36.480

异步任务发生在不同的线程上。原始线程立即继续。所以 xmlData 变量直到未来某个未知时间才会更新，它不会立即准备好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-19T20:09:57.223

正如 Gabe 在他的回答中指出的那样，在任务完成之前它不会可用。出于这个原因，你有`onPostExeccute()`. 您将检索`doInBackground()`到的数据从`onPostExecute()`您对数据执行所需操作的位置传递或将其发送到主函数中的函数`Activity`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T20:10:41.487

返回 doInBackGround 中的值并将其捕获 onPostExecute 以便在不阻塞 UI 线程的情况下顺利执行，还有另一种方法可以在 Asycn 任务对象上调用 get() 方法，但这会阻塞您的 UI

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T20:13:12.120

如果创建 XML 数据需要相当长的时间，您可以先创建一个空的 XMLData 对象，将其填充到 AsyncTask 的背景部分，然后在 on Finish 方法中继续您的操作。这样加载将在后台线程中进行，但您可以在 UI 线程上执行加载后操作。

# python - 从 HTML 中读取元素 -

> ID：15509316
> 
> 赞同：-4
> 
> 时间：2013-03-19T20:02:13.440
> 
> 标签：python, html, parsing, python-3.x, html-table

我有以下 HTML：

```
<tr style='background:#DDDDDD;'>
    <td><b>ASD</b></td>
    <td colspan='3'>1231</td>
</tr> 
```

这个元素在页面上没有重复，所以它是独一无二的。我想将单元格的内容（1231）放入某个变量中。我尝试使用 HTML.parser 但它不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:12:21.777

看用beautifulsoup 很棒，

```
from BeautifulSoup import BeautifulSoup

soup = BeautifulSoup(html) ## feed your html page to beautifulsoup

pleaseFind = soup.find(text="ASD")

whatINeed = pleaseFind.findNext('td')

print whatINeed.text 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:14:11.983

您可以使用 urllib2（您不必安装任何新的东西（至少对于 Windows 版本的 Python））：[http ://docs.python.org/2/howto/urllib2.html](http://docs.python.org/2/howto/urllib2.html)

例子：

```
import urllib2
response = urllib2.urlopen('your URL')
html = response.read()
#html is a string containing everything on your page

#this line (it could be a bit cleaner) finds substring "<td colspan='3'>" and
#searches between it's position and the next "</td>"
pos=html.find("<td colspan='3'>")
print html[pos+len("<td colspan='3'>")+1:html.find("</td>", pos))] 
```

# java - 在 libgdx UI 中设置复选框图像的大小

> ID：15509317
> 
> 赞同：7
> 
> 时间：2013-03-19T20:02:14.333
> 
> 标签：java, checkbox, libgdx, game-engine

我不知道如何管理复选框图像大小。当然，可以在我的纹理图集中创建不同大小的图像并获取合适的图像，但我不想这样做。

这是我的代码：

```
AtlasRegion checkboxOn = AssetsHelper.textures.findRegion("checked");
AtlasRegion checkboxOff = AssetsHelper.textures.findRegion("unchecked");
CheckBoxStyle checkBoxStyle = new CheckBoxStyle();
checkBoxStyle.font = AssetsHelper.font66yellow;
checkBoxStyle.checkboxOff = checkboxOff;
checkBoxStyle.checkboxOn = checkboxOn;
CheckBox cbSound = new CheckBox(" Sound", checkBoxStyle); 
```

cbSound 对象没有这样的方法来调整复选框的图像，但是有方法 getImage()，但似乎也不起作用。这不起作用：

```
cbSound.getImage().width = 120;
cbSound.getImage().height = 120; 
```

仅供参考：例如，当我想绘制图像时，我确实是这样的：

```
batch.draw(textureRegion, 0, 0, widthIwant, heightIwant); 
```

但是在 CheckBox 类中只有这个被覆盖（不设置宽度和高度）：

```
public void draw (SpriteBatch batch, float parentAlpha) {
    image.setRegion(isChecked ? style.checkboxOn : style.checkboxOff);
    super.draw(batch, parentAlpha);
} 
```

**问题**：如何更改复选框图像的宽度和高度？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T18:56:42.290

libgdx 小部件使用可绘制对象来绘制图像。可绘制对象会自动缩放以适合其所在的单元格。因此，要更改图像大小，请更改单元格大小：

```
cbSound.getCells().get(0).size(widht, height); 
```

为了获得更好的结果，您应该为可绘制对象使用九个补丁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-23T14:28:32.440

您需要设置图像缩放类型。方法 getImageCell 也比方法 getCells().get(0) 更正确。默认为无。

```
CheckBox soundCB = new CheckBox("Sound", uiskin);
soundCB.getImage().setScaling(Scaling.fill);
soundCB.getImageCell().size(GameConfig.WIDTH/6);
soundCB.left().pad(PAD);
soundCB.getLabelCell().pad(PAD);
//...
content.add(soundCB).width(GameConfig.WIDTH/1.5f).row(); //add to table 
```

# php - 从 PHP 对象中获取信息

> ID：15509318
> 
> 赞同：1
> 
> 时间：2013-03-19T20:02:17.833
> 
> 标签：php, yii

我正在尝试通过一个继承的 Yii 框架站点。以前很少有面向对象的知识。

我正在打印一些用户信息，看看有什么像这样的......

```
print_r(Yii::app()->user); 
```

那就是打印出这个...

```
CWebUser Object (
[allowAutoLogin] => 1
[guestName] => Guest
[loginUrl] => Array
    (
        [0] => /site/login
    )

[identityCookie] => 
[authTimeout] => 7200
[autoRenewCookie] => 
[autoUpdateFlash] => 1
[loginRequiredAjaxResponse] => 
[_keyPrefix:CWebUser:private] => 7c6285462394c9a141b5d66dce54e8f2
[_access:CWebUser:private] => Array
    (
        [Admin] => 
        [Judge] => 
        [Student] => 1
    )

[behaviors] => Array
    (
    )

[_initialized:CApplicationComponent:private] => 1
[_e:CComponent:private] => 
[_m:CComponent:private] => 
) 
```

我正在尝试获取该用户是学生的信息。我看到了！在那里！

```
[Student] => 1 
```

但是我如何才能得到这些信息呢？

**更新：**

这是 CWebUser 的部分似乎与 _access 有关

```
private $_access=array();

    public function checkAccess($operation,$params=array(),$allowCaching=true)
{
    if($allowCaching && $params===array() && isset($this->_access[$operation]))
        return $this->_access[$operation];

    $access=Yii::app()->getAuthManager()->checkAccess($operation,$this->getId(),$params);
    if($allowCaching && $params===array())
        $this->_access[$operation]=$access;

    return $access;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:28:08.640

以下内容应告诉您用户是否具有“学生”访问权限：

`$isStudent = Yii::app()->user->checkAccess('Student') == 1;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:09:24.010

'student' 是 $_access 数组的一部分。但是 $_access 是私有的，所以你不能直接访问它。

但是必须有方法（函数）才能得到它！在`CWebUser`课堂上看应该有一个类似的方法

```
getStudent();

isStudent(); 
```

或者可能

```
$access = getAccess();
$access['student']; 
```

编辑： [checkAccess](http://www.yiiframework.com/doc/api/1.1/CWebUser#checkAccess-detail) 似乎是这样使用的`checkAccess('student');`

# jquery - 我想根据鼠标位置更改背景颜色

> ID：15509320
> 
> 赞同：5
> 
> 时间：2013-03-19T20:02:23.270
> 
> 标签：jquery

这是我的代码：

```
$(document).mousemove(function(e){
    var $width = ($(document).width())/255;
    var $height = ($(document).height())/255;
    var $pageX = e.pageX / $width;
    var $pageY = e.pageY / $height;
    $("body").css("background-color", "rgb("+$pageX+","+$pageY+","+$pageX+")");
}); 
```

这种工作，除了 mousemove 似乎每次移动时都不会刷新。它似乎滞后，我是否缺少某些设置？第 x 页和第 y 页乘以文档的相对大小为 255，从而使用整个频谱。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-19T20:09:37.317

可能是因为你得到了分数。

尝试：

```
var $pageX = parseInt(e.pageX / $width,10);
var $pageY = parseInt(e.pageY / $height,10); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/BrZjJ/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:17:28.907

每次鼠标移动最少量时您的代码都会运行，因此最好将该事件回调中的任何代码保持在最低限度，以便它可以尽可能快地运行以避免滞后。因此，最好只在一次情况下计算一件事情。所以这样的事情会好一点：

```
var w = Math.round($(document).width() / 255);
var h = Math.round($(document).height() / 255);
var body = $("body");

$(document).mousemove(function(e){
    var pageX = Math.round(e.pageX / w);
    var pageY = Math.round(e.pageY / h);
    body.css("background-color", "rgb("+pageX+","+pageY+","+pageX+")");
}); 
```

如果您希望代码响应不同的屏幕尺寸，那么您只需在文档中添加一个“resize”事件，该事件将在必要时重置`w`和`h`变量。

作为一个侧面点，在没有 jquery 的情况下本地分配背景颜色也可能更快：

```
body.style.backgroundColor = "rgb("+pageX+","+pageY+","+pageX+")"; 
```

# android - 动态壁纸识别是否显示在锁屏上

> ID：15509322
> 
> 赞同：1
> 
> 时间：2013-03-19T20:02:28.730
> 
> 标签：android, live-wallpaper

我正在玩弄为我的锁屏制作动态壁纸的想法。就目前而言，我只是发现如果您在常规主屏幕上也有动态壁纸，您可以在锁屏上拥有动态壁纸......所以我决定考虑制作自己的壁纸。

我想让我的壁纸在我的日历中显示日期、时间和接下来的几个即将发生的事件......但如果我不在我的锁屏上，我不希望这些元素显示。

是否可以以编程方式确定手机是否已解锁并且不显示文本？还是反过来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:27:28.337

根据：[检测屏幕何时锁定](https://stackoverflow.com/questions/8317331/detecting-when-screen-is-locked)

```
KeyguardManager myKM = (KeyguardManager)  
context.getSystemService(Context.KEYGUARD_SERVICE);
if( myKM.inKeyguardRestrictedInputMode()) {
     //it is locked 
} else {
     //it is not locked
} 
```

# shapefile - 自然地球：如何获取属于一个州的所有省份的位置

> ID：15509323
> 
> 赞同：0
> 
> 时间：2013-03-19T20:02:36.350
> 
> 标签：shapefile, geojson

这个问题是关于[Natural earth 1:10 states and Provincial.shp](http://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-1-states-provinces)文件的。我正在使用 ogr2ogr 并想知道我需要传递的 id 的名称。为了拉出正确的州区域来制作一个geojson文件。我使用了几个不起作用的属性名称（-where "adm0_a3 IN ('MLI')" \ ，-where "iso_a2 = 'ML'" \ ）。我从[Let's make a map](http://bost.ocks.org/mike/map/) tutorial 获得了这些 id，但它们引用了另一个形状文件。谁能帮我 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:20:23.597

您可以尝试使用`-sql`变体，但我发现界面有点倾斜。在你的鞋子里，我会将 shapefile 导入[PostGIS](http://www.PostGIS.org)表，然后从那里开始工作。[您可以通过ST_AsGeoJSON](http://www.postgis.org/documentation/manual-2.0/ST_AsGeoJSON.html)获得可靠的查询和对 GeoJSON 导出的原生支持。

# java - JAVA中的日期转换器

> ID：15509329
> 
> 赞同：-3
> 
> 时间：2013-03-19T20:02:54.513
> 
> 标签：java, date

我有日期`Tue Mar 19 00:41:00 GMT 2013`，如何将其转换为`2013-03-19 06:13:00`？

```
final DateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
final Date date = bdate; 
Date ndate = formatter.parse(formatter.format(date)); 
System.out.println(ndate); 
```

给出相同的日期。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T20:04:21.010

使用两个具有适当格式的 SimpleDateFormat 对象，并使用第一个将字符串解析为日期，第二个将日期再次格式化为字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T20:13:53.847

正如第一个答案所说。首先使用 SimpleDateFormat 解析您的日期，如下所示：

```
Date from = new SimpleDateFormat("E M d hh:mm:ss z yyyy").parse("Tue Mar 19 00:41:00 GMT 2013"); 
```

然后使用它来使用 SimpleDateFormat 的另一个实例格式化生成的日期对象，如下所示：

```
String to = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss").format(from); 
```

[在此处](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)查看 SimpleDateFormat 的 javadoc 。希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T20:56:21.520

其他人遗漏的一件主要事情是处理时区（TZ）。每当您使用 SimpleDateFormat 来往/从日期的字符串表示时，您确实需要了解您正在处理的 TZ。除非您在 SimpleDateFormat 上明确设置 TZ，否则它将在格式化/解析时使用**默认TZ。**除非您只处理默认时区中的日期字符串，否则您会遇到问题。

您输入的日期代表 GMT 日期。假设您还希望将输出格式化为 GMT，您需要确保在 SimpleDateFormat 上设置 TZ：

```
public static void main(String[] args) throws Exception
{
    String inputDate = "Tue Mar 19 00:41:00 GMT 2013";
    // Initialize with format of input
    SimpleDateFormat sdf = new SimpleDateFormat("EEE MMM dd HH:mm:ss z yyyy");
    // Configure the TZ on the date formatter. Not sure why it doesn't get set
    // automatically when parsing the date since the input includes the TZ name,
    // but it doesn't. One of many reasons to use Joda instead
    sdf.setTimeZone(TimeZone.getTimeZone("GMT"));
    Date date = sdf.parse(inputDate);
    // re-initialize the pattern with format of desired output. Alternatively,
    // you could use a new SimpleDateFormat instance as long as you set the TZ
    // correctly
    sdf.applyPattern("yyyy-MM-dd HH:mm:ss");
    System.out.println(sdf.format(date));
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T20:10:25.377

以这种方式使用[SimpleDateFormat ：](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)

```
final DateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
final Date date = new Date();
System.out.println(formatter.format(date)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-19T20:13:05.083

如果您使用日期进行任何计算或解析，请使用 JodaTime，因为标准的 JAVA 日期支持确实有问题

# loops - SAS结合数据集、二分搜索、索引

> ID：15509330
> 
> 赞同：3
> 
> 时间：2013-03-19T20:02:55.080
> 
> 标签：loops, dataset, sas, indices

在 SAS 中，对于下面的两个测试数据集 - 对于“y”和“z”内的每个“数量”值，我需要提取相应的“x”。可能有多个符合标准的“x”值。最终结果应如下所示：

```
/*
4 banana eggs
15 .
31 .
7 banana
22 fig
1 eggs
11 coconut
17 date
41 apple
*/ 
```

我意识到这依赖于使用索引或二进制搜索，但我想不出一个可行的解决方案！任何帮助将不胜感激！谢谢！

```
data test1;
   input x $ y z;
   datalines;
   apple 29 43
   banana 2 7
   coconut 9 13
   date 17 20
   eggs 1 5
   fig 18 26
   ;
run;

data test2;
   input amount;
   datalines;
   4
   15
   31
   7
   22
   1
   11
   17
   41
   ;
run; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T21:35:58.477

加入两个数据集，使其`amount`介于`y`和之间`z`。

```
proc sql;
create table join as 
select a.amount
      ,b.*
from test2 a
       left join
     test1 b
       on a.amount between b.y and b.z;
quit; 
```

按转置量对结果进行排序。

```
proc sort data=join; by amount; run; 
```

转置它。

```
proc transpose data=join out=trans;
by amount;
var x;
run; 
```

现在您的水果都在其自己的变量中，名为`col1`, `col2`, ...。如果您希望它们全部放在一个由空格分隔的变量中，只需将它们连接起来。

```
data trans2(keep= amount text);
set trans(drop=_name_);
array v{*} _character_;
text = catx(' ', of v{*});
run; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:49:57.020

这是使用“老式”数据步骤代码加上的可能解决方案`PROC TRANSPOSE`：

```
data test1;
    input x $ y z;
    datalines;
    apple 29 43
    banana 2 7
    coconut 9 13
    date 17 20
    eggs 1 5
    fig 18 26
run;

data test2;
    input amount;
    datalines;
    4
    15
    31
    7
    22
    1
    11
    17
    41
run;

data want(keep=amount x);
   set test2;
   found = 0;
   do _i_=1 to nobs;
      set test1 point=_i_ nobs=nobs;
      if y <= amount <= z then do;
         found = 1;
         output;
         end;
      end;
   if not found then do;
      x = ' ';
      output;
      end;
run;

proc transpose data=want out=want2(drop=_name_);
   by amount notsorted;
   var x;
run; 
```

请注意，我的结果与您的示例不匹配；金额 31 是一个“苹果”。

# ios - Rails - 添加一个按钮，该按钮可以转到用户的默认电子邮件，并带有适当的地址

> ID：15509331
> 
> 赞同：0
> 
> 时间：2013-03-19T20:02:57.717
> 
> 标签：ios, ruby-on-rails, ipad

我正在构建一个应用程序，并希望允许用户在演示时提供持续的反馈。我想在地址栏中添加一个“反馈”按钮，该按钮会将 iPad 用户直接带到他们的默认电子邮件，而我的团队的支持框已经在地址中。甚至可能在电子邮件正文中提供有关他们所在网站的一些信息。关于从哪里开始的任何提示？

谢谢。

# java - 使用 JDO 在 Google Datastore 中创建实体时出错

> ID：15509332
> 
> 赞同：1
> 
> 时间：2013-03-19T20:02:59.973
> 
> 标签：java, google-app-engine, google-cloud-datastore, jdo, datanucleus

我正在使用 JDO 在 Google App Engine 中创建一个 Web 应用程序，我得到一个`JDOFatalUserException`：

```
javax.jdo.JDOFatalUserException: Detected attempt to establish User(15) as the 
parent of SessionToken("VALID_USER_TOKEN") but the entity identified 
by SessionToken("VALID_USER_TOKEN") has already been persisted 
without a parent.  A parent cannot be established or changed once an 
object has been persisted. 
```

我有类 User，它有一个 SessionToken。我想将 User 和 SessionToken 都存储在 Datastore 中。User 密钥是自动生成的，而 SessionToken 密钥是我自己生成的。

```
@PersistenceCapable
public class User {

  @PrimaryKey
  @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
  private Key key;
  @Persistent
  private SessionToken sessionToken;

  //getters and setters...
} 
```

和：

```
@PersistenceCapable
public class SessionToken { 

  @PrimaryKey
  private Key token;

  public SessionToken(Key token) {
    this.token = token;
  }

  //getters and setters...
} 
```

然后我想创建一个用户，所以我这样做：

```
PersistenceManager pm = PMF.get().getPersistenceManager();

User user = new User();

Key key = KeyFactory.createKey(SessionToken.class.getSimpleName(), 
    "VALID_USER_TOKEN");
user.setSessionToken(new SessionToken(key));

try {
  pm.makePersistent(user);
} finally {
  pm.close();
} 
```

这是完整的异常转储：

```
javax.jdo.JDOFatalUserException: Detected attempt to establish User(15) as the parent of SessionToken("VALID_USER_TOKEN") but the entity identified by SessionToken("VALID_USER_TOKEN") has already been persisted without a parent.  A parent cannot be established or changed once an object has been persisted.
    at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:498)
    at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.java:736)
    at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.java:756)
    at com.mockgaeapp.UsersEndpoint.register(UsersEndpoint.java:38)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.google.appengine.tools.development.agent.runtime.Runtime.invoke(Runtime.java:115)
    at com.google.api.server.spi.SystemService.invokeServiceMethod(SystemService.java:239)
    at com.google.api.server.spi.SystemServiceServlet.execute(SystemServiceServlet.java:161)
    at com.google.api.server.spi.SystemServiceServlet.doPost(SystemServiceServlet.java:120)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.api.socket.dev.DevSocketFilter.doFilter(DevSocketFilter.java:74)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.ResponseRewriterFilter.doFilter(ResponseRewriterFilter.java:123)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:34)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:61)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:409)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

我不明白这个错误，因为我在持久化用户之前没有持久化 SessionToken 对象......

这个异常是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T21:40:31.193

`User`您的代码告诉 JDO 在和对象之间具有“拥有”关系`SessionToken`，其中子实体应该将父项的键作为其父项（在数据存储术语中），而您在没有父项的情况下显式设置键。

请尝试使用[“无主”关系](https://developers.google.com/appengine/docs/java/datastore/jdo/relationships#Unowned_Relationships)。

# java - 为什么我的静态代码块不执行？

> ID：15509337
> 
> 赞同：4
> 
> 时间：2013-03-19T20:03:13.140
> 
> 标签：java, static

我正在尝试运行此代码，但发现 final with static 的这种行为：代码运行时没有执行 A 的静态块。请告诉我原因。

```
class A {
  final static int a=9;
    static { //this block is not executing ??
      System.out.println("static block of A");
     }
}

class Manager {
  static {
    System.out.println("manager sib");
  }

  public static void main(String ...arg) {
    System.out.println("main");
    System.out.println(A.a);
  }
} 
```

为什么A类的静态块不运行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T20:05:57.983

问题是它`A.a`是一个[常量变量](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.4)。

> 原始类型或 String 类型的变量，它是 final 并使用编译时常量表达式（第 15.28 节）进行初始化，称为常量变量。

因此，您的方法*完全*`Manager.main`按照以下方式编译：

 *```
public static void main(String ...arg) {
    System.out.println("main");
    System.out.println(9);
} 
```

不再有真正的引用`A.a`，因此`A`该类甚至不需要*存在*，更不用说初始化了。（您可以删除`A.class`并仍然运行`Manager`。）

如果您依靠 using`A.a`来确保类型已初始化，则不应添加 no-op 方法：

```
public static void ensureClassIsInitialized() {
} 
```

然后从你的方法中调用*它。*`main`不过，需要这样做是非常不寻常的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:29:31.830

规范[http://docs.oracle.com/javase/specs/jls/se7/jls7.pdf](http://docs.oracle.com/javase/specs/jls/se7/jls7.pdf) 第 4.12.1 节说，

原始类型或 String 类型的变量，它是 final 并使用编译时常量表达式（第 15.28 节）初始化，称为常量变量。变量是否为常量变量可能对类初始化（§12.4.1）、二进制兼容性（§13.1、§13.4.9）和明确赋值（§16）有影响。

由于您只访问常量，因此不需要类初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-09T21:11:05.487

您可以强制加载所需的任何类：

```
public final class ClassUtils {
  private ClassUtils() {}

  public static void forceLoad(Class<?>... classes) {
    for (Class<?> clazz : classes) {
      try {
        Class.forName(clazz.getName(), true, clazz.getClassLoader());
      } catch (ClassNotFoundException e) {
        throw new AssertionError(clazz.getName(), e);
      }
    }
  }
}

class Manager {
  static {
    ClassUtils.forceLoad(A.class);
// ...
  }

  public static void main(String ...arg) {
// ...
  }
} 
```*

# xcode - 如何将 sharekit 操作添加到 tableview 单元格？

> ID：15509340
> 
> 赞同：1
> 
> 时间：2013-03-19T20:03:42.070
> 
> 标签：xcode, uitableview, sharekit

我刚刚将 sharekit 添加到我的项目中。它的动作是否只能通过使用导航栏中的“共享”按钮来实现？我有一个表格视图，我想通过按一个单元格来使用共享操作。有可能（最终在不同的单元格中分离不同的服务）？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:07:17.490

它绝对有可能。Checkout`UITableView`的委托方法`didSelectRowAtIndex:`。然后在您的实现中调用适当的共享工具包服务。

```
// Check if the SLComposeViewController is available.
if (NSClassFromString(@"SLComposeViewController")) {

    SLComposeViewController *FBPostSheet = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];

    [FBPostSheet setInitialText:@"I'm posting to Facebook!"];
    [FBPostSheet addURL:[NSURL URLWithString:@"http://www.Apple.com"]];

    [FBPostSheet setCompletionHandler:^(SLComposeViewControllerResult result) {
        switch (result) {
            case SLComposeViewControllerResultCancelled:
                NSLog(@"Cancelled");
                break;
            case SLComposeViewControllerResultDone:
                NSLog(@"Cancelled");
                break;
        }
    }];

    // Apparently its possible for composeViewControllerForServiceType: to return nil... better check.
    if (FBPostSheet) {
        [self presentViewController:FBPostSheet animated:YES completion:nil];
    } else {
        NSLog(@"Error Creating Post Sheet");
    }
} 
```

# llvm - LLVM蹦床有多少空间

> ID：15509341
> 
> 赞同：16
> 
> 时间：2013-03-19T20:03:42.903
> 
> 标签：llvm

我试图弄清楚如何在 LLVM中使用[蹦床内在函数。](http://llvm.org/docs/LangRef.html#llvm-init-trampoline-intrinsic)该文档提到了存储蹦床所需的一些存储空间，这取决于平台。我的问题是，我如何确定需要多少？

我找到[了这个例子](https://gist.github.com/rikusalminen/4682367)，显然没有理由选择 32 个字节。如何选择一个好的价值？

```
declare void @llvm.init.trampoline(i8*, i8*, i8*);
declare i8* @llvm.adjust.trampoline(i8*);

define i32 @foo(i32* nest %ptr, i32 %val)
{
    %x = load i32* %ptr
    %sum = add i32 %x, %val
    ret i32 %sum
}

define i32 @main(i32, i8**)
{
    %closure = alloca i32
    store i32 13, i32* %closure
    %closure_ptr = bitcast i32* %closure to i8*

    %tramp_buf = alloca [32 x i8], align 4
    %tramp_ptr = getelementptr [32 x i8]* %tramp_buf, i32 0, i32 0
    call void @llvm.init.trampoline(
            i8* %tramp_ptr,
            i8* bitcast (i32 (i32*, i32)* @foo to i8*),
            i8* %closure_ptr)
    %ptr = call i8* @llvm.adjust.trampoline(i8* %tramp_ptr)
    %fp = bitcast i8* %ptr to i32(i32)*

    %val2 = call i32 %fp (i32 13)

    ; %val = call i32 @foo(i32* %closure, i32 42);

    ret i32 %val2
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-17T21:23:54.367

是的，蹦床用于“即时”生成一些代码。目前还不清楚你为什么需要这些内在函数，因为它们用于实现 GCC 的嵌套函数扩展（特别是当嵌套函数的地址被捕获并且函数访问封闭函数内部的东西时）。

找出蹦床缓冲区的必要大小和对齐方式的最佳方法是对“TRAMPOLINE_SIZE”和“TRAMPOLINE_ALIGNMENT”的 grep gcc 源。

据我所知，在撰写本文时，72 字节的缓冲区和 16 字节的对齐对于 gcc / LLVM 支持的所有平台来说已经足够了。

# jquery - .getJSON 不处理文件

> ID：15509343
> 
> 赞同：0
> 
> 时间：2013-03-19T20:03:49.827
> 
> 标签：jquery, json, getjson

您好，我是使用 jQuery 读取 JSON 文件的新手。我正在使用以下代码：

```
 $.getJSON('updateProfile.js', function(data) {
    var Options = [];
    $.each(data.Options, function(key, val) {
    alert('we have data for ' + val.id + ' and ' + val.label);
     }); 
```

我使用了 JSON 验证工具，并且文件有效。我在 FF 中使用了 chrome 和 firebug 来确认文件的状态为 200。但是，当我在 .getJSON 调用上设置断点时，代码会被绕过。

我使用了一个本地 tomcat 服务器，并将这个放在一个实际的服务器上，所有这些都以相同的方式执行。

这是我要阅读的 JSON

```
{"Options":[
"title": "User Profile",
"description": "Your preferences can be modified below. Click on the section on the left. This will present the details on the right. Once you have updated your profile, click the Save button to save your changes.",
"id": "userprofileStackTabs",
"children": [
    {
        "id": "up001",
        "linkID": "namePhones",
        "label": "Name and Phones",
        "description": "",
        "default": "true"
    },
    {
        "id": "up002",
        "linkID": "password",
        "label": "Password",
        "description": " "
    },
    {
        "id": "up003",
        "linkID": "physAddrss",
        "label": "Physical Address",
        "description": " "
    },
    {
        "id": "up004",
        "linkID": "dfShippingAddrss",
        "label": "Default Shipping Address",
        "description": " "
    },
    {
        "id": "up005",
        "linkID": "cpgnPref",
        "label": "Campaign Preferences",
        "description": " "
    },
    {
        "id": "up006",
        "linkID": "appPref",
        "label": "Application Preferences",
        "description": " "
    },
    {
        "id": "up007",
        "linkID": "langPref",
        "label": "Language Preferences",
        "description": " "
    },
    {
        "id": "up008",
        "linkID": "agentLic",
        "label": "Agent Licenses",
        "description": " "
    },
    {
        "id": "up009",
        "linkID": "searchPref",
        "label": "Search Preferences",
        "description": " "
    },
    {
        "id": "up010",
        "linkID": "socMedAcct",
        "label": "Social Media Accounts",
        "description": " "
    }
],
"buttons": [
    {
        "id": "upButn_Save",
        "label": "Save"
    },
    {
        "id": "upButn_Cancel",
        "label": "Cancel"
    }
] 
```

]}

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:12:10.293

我不知道你为什么要在 $.get 中创建 Options 数组。我认为这是不需要的，你根本没有使用它......

尝试这个

```
$.each(data.Options[0].children, function(key, val) {
   alert('we have data for ' + val.id + ' and ' + val.label);
 }); 
```

你很想得到选项数组内的孩子的 id 和标签`[0]`..所以循环遍历 obecjt 的 chilren 数组并获取它..

# python - 从 Python 日期中提取两位数的月份和日期

> ID：15509345
> 
> 赞同：155
> 
> 时间：2013-03-19T20:03:53.087
> 
> 标签：python, datetime, iso

有没有办法使用 isoformats 提取月份和日期？假设今天的日期是 2013 年 3 月 8 日。

```
>>> d = datetime.date.today()
>>> d.month
3
>>> d.day
8 
```

我想：

```
>>> d = datetime.date.today()
>>> d.month
03
>>> d.day
08 
```

我可以通过编写 if 语句并连接前导 0 来做到这一点，以防日或月是单个数字，但我想知道是否有一种自动生成我想要的方法的方法。

* * *

## 回答 #1

> 赞同：244
> 
> 时间：2013-03-19T20:24:35.800

查看这些属性的类型：

```
In [1]: import datetime

In [2]: d = datetime.date.today()

In [3]: type(d.month)
Out[3]: <type 'int'>

In [4]: type(d.day)
Out[4]: <type 'int'> 
```

两者都是整数。所以没有*自动*的方法来做你想做的事。所以狭义上，你的问题的答案是**否定**的。

如果您想要前导零，则必须以一种或另一种方式格式化它们。为此，您有多种选择：

```
In [5]: '{:02d}'.format(d.month)
Out[5]: '03'

In [6]: '%02d' % d.month
Out[6]: '03'

In [7]: d.strftime('%m')
Out[7]: '03'

In [8]: f'{d.month:02d}'
Out[8]: '03' 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-03-19T20:14:37.167

您可以使用字符串格式化程序用零填充任何整数。它的行为就像 C 的一样`printf`。

```
>>> d = datetime.date.today()
>>> '%02d' % d.month
'03' 
```

**针对 py36 更新：** 使用 f 字符串！对于 general `int`，您可以使用`d`格式化程序并明确告诉它用零填充：

```
 >>> d = datetime.date.today()
 >>> f"{d.month:02d}"
 '07' 
```

但是`datetime`s 是特殊的，并且带有已经被零填充的特殊格式化程序：

```
 >>> f"{d:%d}"  # the day
 '01'
 >>> f"{d:%m}"  # the month
 '07' 
```

# c# - 在实体框架中参数化原始 Oracle SQL 查询

> ID：15509346
> 
> 赞同：10
> 
> 时间：2013-03-19T20:04:14.347
> 
> 标签：c#, oracle, entity-framework-4

我正在尝试为 EF 4 中的 Oracle 同义词（非实体）参数化原始 SQL 查询，但遇到了一些问题。目前，根据我看到的一些示例，我正在做类似下面的代码：

```
 string term="foo";
 OracleParameter p = new OracleParameter("@param1", term);
 object[] parameters = new object[] { p };
 var model = db.Database.SqlQuery<ProjectTask>("SELECT * FROM (SELECT * FROM web_project_task_vw WHERE project_num like '%@param1%') WHERE rownum<=100", parameters).ToList(); 
```

运行它不会返回任何结果。如果我用类似的东西替换参数

```
"SELECT * FROM web_project_task_vw WHERE project_num like '%"+term+"%'" 
```

它返回我期望的结果，但这显然是一个 SQL 注入风险。

谁能指出我应该如何在 EF 4 中为 Oracle DB 工作的参数的正确方向？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-12-05T14:54:50.887

首先，就像 Mohammed 所写的那样，您需要在参数前面加上 ':'，但不是按照您的定义，只是在查询中。其次，您当前搜索的不是参数的值，而是包含字符串的字符串`@param1`。所以用 % 包围参数的值，你应该得到一个结果。

所以它应该看起来像这样：

```
string term="foo";
 OracleParameter p = new OracleParameter("param1", term);
 object[] parameters = new object[] { p };
 var model = db.Database.SqlQuery<ProjectTask>("SELECT * FROM (SELECT * FROM web_project_task_vw WHERE project_num like '%'||:param1||'%') WHERE rownum<=100", parameters).ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T20:14:19.170

您`p`的参数名称可能不正确；名字应该是`param1`，不是`@param1`。您的查询也不正确；替换`'%@param1%'`为`'%:param1%'`.

# java - 为 SWT Combo 小部件中的每个元素设置工具提示文本

> ID：15509350
> 
> 赞同：2
> 
> 时间：2013-03-19T20:04:31.937
> 
> 标签：java, user-interface, swt

我已经四处寻找了很长时间，似乎无法找到这是否可能。

我有一个 Combo 小部件，其中填充了一些字符串，并且不想将工具提示文本设置为 Combo 小部件中每个项目的不同内容。即，当您将鼠标悬停在 Combo 小部件中的某个项目上时，鼠标图标上方会显示一个字符串。

例如，如果 Combo 小部件中有 2 个项目，Foo 和 Bar，您能否将鼠标悬停在 Foo 上时将工具提示文本设置为“Foo”，将鼠标悬停在 Bar 上时将其设置为“Bar”？

任何建议/见解都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T12:38:33.633

Edward Thomson 的解决方案可能是最好的解决方案，但如果您不想编写代码，则可以使用[博客文章 Tooltip 为 SWT 启用 CCombo 的](http://s-weber.blogspot.cz/2010/08/tooltip-enabled-ccombo-for-swt.html)TooltipCCombo 类（风险自负）。

# ios - 实际内存使用 - MPFlipTransition

> ID：15509353
> 
> 赞同：1
> 
> 时间：2013-03-19T20:04:37.653
> 
> 标签：ios, ipad, memory, memory-management, uiimageview

我正在创建一个应用程序，`UIViewController`其中显示其他`UIViewControllers`内容`MPFlipTransition`。它就像 iPad 上的一本小书。每个`UIViewControllers`内部都是用 4-5`UIImageViews`内部的 xibs 创建的，其中一些图像使用 CoreAnimations（`[UIView animateWithDuration]`块）进行动画处理。我`viewDidDiseappear`在每个动画层上使用 QuartzCore 函数 removeAllAnimation 删除函数中的所有动画。但是当我在 iPad 3 上测试该应用程序时，它可以正常工作，但在 iPad 2 上，它在大约第 8 页更改时崩溃。我使用 Instruments 进行了分析，发现每次翻页时实际内存使用量都在增加（当`MPFlipTransition`出现）。但即使我从超级视图中删除以前的视图，实际内存使用量也不会减少。我认为它在 iPad 2 上造成了崩溃，因为当实际内存使用量超过 400 MB 值（而 iPad 2 只有 512MB ......）时，崩溃就发生了。

你怎么看这个问题？有什么帮助吗？我正在使用 ARC 进行内存管理...感谢您的帮助！随意询问是否需要精度...

# css - 使用jquery annimate在到达外部潜水边缘时停止div移动

> ID：15509360
> 
> 赞同：0
> 
> 时间：2013-03-19T20:04:48.027
> 
> 标签：css, jquery-animate, position

我有一个带有图像的 div，希望用户在 div 内移动它，但我不希望它移到 div 之外。随着 div 的移动，它仍然会超出父区域 div 并移动到我不想要的页面的其余部分

这是我使用的风格

```
<style>
#area{
    width: 500px;
    height: 500px;
    margin: auto;
    clear: both;
    background-color: red;
    position: absolute;
}
#one{
    width: 29px;
    height: 29px;
    background-image: url("images/fighter.png");
    position: relative;
    top: 50px;
}

button{
    float: left;
    width: 50px;
}
.gameControls{
    margin: auto;
    width: 150px;
}
.gameUp{
    margin: 0 0 0 50px;
}
.clear{
    clear: both;
} 
```

这是我使用的 jQuery 脚本

```
<script>
    $(document).ready(function(){
        $('.gameUp').click(function(event){
            $("#one").animate({"top": "-=50px"}, "slow");
        });
        $('.gameLeft').click(function(event){
            $("#one").animate({"left": "-=50px"}, "slow");
        });
        $('.gameDown').click(function(event){
            $("#one").animate({"top": "+=50px"}, "slow");
        });
        $('.gameRight').click(function(event){
            $("#one").animate({"left": "+=50px"}, "slow");
        });
    });
</script> 
```

还有我的身体密码

```
<div class="gameControls">
    <button class="gameUp">&uarr;</button>
    <div class="clear"></div>
    <button class="gameLeft">&larr;</button>
    <button class="gameDown">&darr;</button>
    <button class="gameRight">&rarr;</button>   
</div>
<div id="area">
<div id="one"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:48:44.853

我不确定是否可以仅使用 css 来完成`top`，因为`margin`,`padding`等可以分配给负值。

这是我的 js 解决方案：

[jsfiddle](http://jsfiddle.net/D6s6K/2/)

# java - 想知道如何直接输出到数组然后从数组输出

> ID：15509362
> 
> 赞同：0
> 
> 时间：2013-03-19T20:04:53.110
> 
> 标签：java, arrays, cubes

我必须编写一个程序，将前 10 个整数加载到一个数组中。我已经尝试了各种方法，但无法使其与数组一起使用。这是我所得到的。

```
public class midtermcube2 {

    public static void main(String[] args) {
        int totz;
        for (int numz=0; numz<=9;numz++)
        {
            totz=numz*numz*numz;
            System.out.println(totz);
        }           
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:27:37.687

尝试这个：

```
public class AddArray
{
public static void main(String[] args)
{
    int arr[]=new int[10];
    for(int i=0;i<10;i++)
    {
        arr[i]=i;
        System.out.println(arr[i]);
    }
}   
} 
```

# sorting - 元组索引的数据结构

> ID：15509364
> 
> 赞同：1
> 
> 时间：2013-03-19T20:05:01.377
> 
> 标签：sorting, tuples, radix-sort

我需要一个存储元组的数据结构，并允许我进行如下查询：给定`(x,y,z)`整数元组，找到下一个（它的上限）。我的意思是考虑自然排序`(a,b,c)<=(d,e,f) <=> a<=d and b<=e and c<=f`。我尝试过 MSD 基数排序，它将项目分成桶并对它们进行排序（并对元组中的所有位置递归地执行此操作）。有人有其他建议吗？理想情况下，我希望上述查询发生在 O(log n) 内，其中 n 是元组的数量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T08:05:30.083

两种选择。

对有序数组使用二分查找。如果您使用 (a<<64)|(b<<32)|c 构建键（假设 32 位 int）' 并将它们保存在一个简单的数组中，一个并排打包，您可以使用二进制搜索来定位该值您正在搜索（如果使用 C，甚至还有一个库函数可以执行此操作），而下一个只是一个位置。最坏情况的性能是 O(logN)，如果你可以做[http://en.wikipedia.org/wiki/Interpolation_search](http://en.wikipedia.org/wiki/Interpolation_search)那么你甚至可能接近 O(log log N)

二进制键的问题是添加新值可能很棘手，如果超出可用内存，可能需要旋转。但它很快，平均只有几次随机内存访问。

或者，您可以通过以某种形式生成带有 a|b|c 的键来构建哈希表，然后让哈希数据指向包含下一个值的结构，无论它可能是什么。一开始创建可能有点困难，因为在生成表时，您需要已经知道下一个值。

哈希方法的问题是它可能会比二进制搜索方法使用更多的内存，如果您没有遇到哈希冲突，性能会很好，但随后会开始下降，尽管在某些情况下该算法有一些变化会有所帮助。哈希方法可能更容易插入新值。

我还看到您在这些方面有类似的问题，所以我想我所说的内容是结合 A、b、c 来生成一个长键，并将其与二进制搜索、哈希甚至 b-tree 一起使用。如果密钥的长度是您的问题（什么语言），您可以将其视为字符串吗？

如果这个答案完全不符合标准，请告诉我，我会看看我是否可以删除这个答案，所以你的问题仍然没有答案，而不是无用的答案。

# delphi - 在 TChart 上设置左轴以将十进制值增加到 0.13？

> ID：15509367
> 
> 赞同：1
> 
> 时间：2013-03-19T20:05:11.970
> 
> 标签：delphi, delphi-xe, teechart

这个问题与此处的另一个持续问题有关：[正确格式化石头和磅？](https://stackoverflow.com/questions/15483676/format-stones-and-pounds-correctly)

我认为在决定做什么之前，在这里提出一个单独的问题会更合适。

如上面链接所述，我将 TChart 中的重量表示为石头和磅。

在我决定是否更改我当前使用的数据类型（双）之前，我想看看如何按照我最初的想法以石头和英镑显示我的图表。

请参阅我为演示目的操作的此示例图像：

![在此处输入图像描述](../Images/bd7d4ba3be29096ba332d8aaff99e7f8.png)

问题是图表的左轴，因为图像状态中的注释 - 图表在达到下一个整数（在本例中为石头）之前递增到 0.99（磅）。例如：

*   03.00
*   02.99 < .99 = 达到 3.00 之前的最大数量
*   02.98
*   02.97

我需要像这样设置左轴：

*   03.00
*   02.13 < .13 = 达到 3.00 之前的最大数量
*   02.12
*   02.11
*   02.10

并且还显示磅部分的所有标签。

在达到下一个整数（石头）之前，我可以使用某个设置来设置 .00（磅）的最大值吗？

目前似乎没有什么意义，根据我从另一个问题的理解是我应该使用整数并仅表示为磅。

不过，我想在进行任何更改之前看看它的外观，理想情况下，我希望图表尽可能与图像保持一致。

希望这是有道理的。

谢谢。

**更新**

只是想我会更新我最终开始工作的更改。

所有的功劳都归功于 David Heffernan，他坚持不懈地解释我哪里出错了，并写下了详细的信息和建议。

我还需要做一些工作，但现在这里是我现在拥有的更新图表：

![在此处输入图像描述](../Images/c200da0bf155453687ce09483c45d883.png)

我还没有完成标签中的值，但是从上面的示例图像中，这是我使用的值：

*   15.2
*   15.3
*   15.11
*   15.13
*   16.0
*   16.4

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:47:43.160

您不能使用当前的表示来绘制合理的图表。假设您有一个具有以下值的条形图：

```
第 10 个 12 磅
第 10 个 13 磅
第 11 个 0 磅
第 11 磅 1 磅

```

图表将如下所示：

![在此处输入图像描述](../Images/c3b30ca5e6dcc41c4d99190bf88ba0a9.png)

暂时忘记轴标签。看看酒吧之间的区别。每个相邻值之间的差值为 1lb。但这张图讲述了一个完全不同的故事。我在这里使用了条形图，但该原理适用于所有图表类型。

最重要的是，您需要用真正的十进制表示来表示您的体重值。您的表示不遵守基本的算术定律。所以，半个石头必须是 0.5。试图用数字 0.07 代表一半只是在寻求一个痛苦的世界。

使用此公式将石头和磅转换为重量的真实浮点表示：

```
FloatingPointWeightValue := Stones + Pounds/14.0; 
```

或者，如果您只存储磅，那么它只是

```
FloatingPointWeightValue := Pounds/14.0; 
```

我建议您确保`Increment`轴的 至少为 1。如果您需要小于该值，则必须进入自定义轴标签标题。当你添加你的值时，给它们一个标签。这将允许图表使用合理的标签来识别值。例如：

```
Series1.Add(10 + 12/14, '10st, 12lb');
Series1.Add(10 + 13/14, '10st, 13lb');
Series1.Add(11 + 00/14, '11st, 0lb');
Series1.Add(11 + 01/14, '11st, 1lb'); 
```

结果如下所示：

![在此处输入图像描述](../Images/2a543f64f99a3a8760f03dc7ec883551.png)

您显然会编写一堆辅助函数来处理这个问题。我建议将原始数据存储为磅。因此，第 11 个 1lb 将存储为 11*14 + 1 = 155。然后您将拥有这些助手：

```
function StonesFromPounds(Pounds: Integer): Double;
begin
  Result := Pounds / 14.0;
end;

function StonesPoundsLabel(Pounds: Integer): string;
begin
  Result := Format('%dst %dlb', [Pounds div 14, Pounds mod 14]);
end; 
```

然后数据群将如下所示：

```
Pounds := 152;
Series1.Add(StonesFromPounds(Pounds), StonesPoundsLabel(Pounds)); 
```

您可以完全自由地为您的权重创建文本标签。如果您想要比 10st 13lb 更简洁的东西，那么您可以根据需要调整辅助函数。

现在，这是一个很长的答案，所以我将总结我的建议：

1.  当您从任何来源获取数据时，将它们到达的任何格式转换为明确定义的存储格式，即原始数据格式。
2.  将此原始数据存储为整数值，以磅为单位。
3.  当您绘制权重时，将 转换为以石头为单位的浮点值`Stones := Pounds/14.0`。
4.  将文本标签与您绘制的每个值相关联，以便您可以以人类可读的形式呈现权重。
5.  如果您需要在宝石的整数值之间标注重量，请准备好提供自定义标签轴。

# google-cloud-storage - 是否可以自动化 Gsutil 登录？

> ID：15509368
> 
> 赞同：5
> 
> 时间：2013-03-19T20:05:16.730
> 
> 标签：google-cloud-storage

是否可以自动将基于 gsutil 的文件上传到谷歌云存储，以便登录时不需要用户干预？

我的用例是有一个 jenkins 作业，它轮询 SCM 位置以更改一组文件。如果它检测到任何更改，它会将所有文件上传到特定的 Google Cloud Store 存储桶。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-03T18:25:49.190

配置凭据后，gsutil 无需进一步干预。我怀疑您`gsutil configure`以用户 X 的身份运行，但 Jenkins 以用户 Y 的身份运行。因此，`~jenkins/.boto`不存在。如果您将 .boto 文件放置在正确的位置，您应该已准备就绪。

另一种选择是使用多个 .boto 文件，然后告诉 gsutil 哪个与`BOTO_CONFIG`环境变量一起使用：

```
gsutil config  # complete oauth flow
cp ~/.boto /path/to/existing.boto
# detect that we need to upload
BOTO_CONFIG=/path/to/existing.boto gsutil -m cp files gs://bucket 
```

我经常使用此模式将 gsutil 与多个帐户一起使用：

```
gsutil config  # complete oauth flow for user A
mv ~/.boto user-a.boto
gsutil config  # complete oauth flow for user B
mv ~/.boto user-b.boto
BOTO_CONFIG=user-a.boto gsutil cp a-file gs://a-bucket
BOTO_CONFIG=user-b.boto gsutil cp b-file gs//b-bucket 
```

# php - 如何配置我的服务器以在 HTTP 错误 500（内部服务器错误）上显示 php 错误

> ID：15509372
> 
> 赞同：1
> 
> 时间：2013-03-19T20:05:26.580
> 
> 标签：php, error-reporting, internal-server-error

我在 Windows server 2008 R2 上设置了本地服务器。但是，每当我在 PHP 或 MySql 代码中出现错误时，我都会收到一个 HTTP 500 Inertnal Sever Error，以显示错误是什么。

如何更改我的服务器配置以像任何其他服务器一样显示实际错误？

我尝试将其添加到我的 php 文件中

```
error_reporting(E_ALL);
ini_set('display_errors', 'On'); 
```

这是我的 php.ini 文件中的一些信息

```
error_reporting  =  E_ALL & ~E_NOTICE
display_errors = On
display_startup_errors = On 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:16:13.270

您是否回收了应用程序池以将更改应用到 php.ini？重新启动 IIS 实际上并不会重新加载 php.ini，即使您认为它会重新加载。我还将创建一个 phpinfo 文件来验证服务器上的错误报告 ini 设置是否已应用。

应用程序池回收说明： [http ://technet.microsoft.com/en-us/library/cc770764(WS.10).aspx](http://technet.microsoft.com/en-us/library/cc770764(WS.10).aspx)

# html - Chrome 中的奇怪显示。它在文档上方显示空框。IE 和 Firefox 都很好

> ID：15509374
> 
> 赞同：0
> 
> 时间：2013-03-19T20:05:30.423
> 
> 标签：html

Chrome 中的奇怪显示。它在文档上方显示空框。IE 和 Firefox 都很好

```
<tr>
    <td align='left' valign='middle'>
    <TABLE BORDER=5 ALIGN=CENTER CELLSPACING=5 CELLPADDING=5 width="600">
    <tr>
    <CAPTION ALIGN=CENTER>
    <B>Pay Period 20 (3/20/2011 - 4/2/2011)     Timesheet Deadline</B>
    <br><font color="red"><B>Wednesday 4/6/2011 12:00 PM Noon </B></font> 
    </B>
    </B></font> 
    <br><br><B><font color="blue" size="1">APPROVERS PLEASE NOTE:  
    IF YOUR EMPLOYEES DO NOT SUBMIT THEIR TIME SHEETS, YOU NEED TO ENTER THEIR 
    NORMAL STANDARD HOURS AND APPROVE THEIR TIME SHEETS</font></B>
    </tr>
    </td>
    </tr>
    <tr>
    <td align='left' valign='middle'>
    <TR>
    <TH COLSPAN="3"><font size=2><B>Documents</B></font></TH>
    </TR>
    </TABLE>
    <BR>
    </td>
    </tr> 
```

# .net - VB.NET - Sendkey 的问题

> ID：15509378
> 
> 赞同：0
> 
> 时间：2013-03-19T20:05:42.767
> 
> 标签：.net, vb.net, exception, sendkeys

我对 SendKeys 有疑问。我为在线多人游戏制作了 Keybinder。如果注册了一个键，例如：Numlock 1，我的软件会在 textbox1 中发送单词或字母或任何内容。一切正常。示例代码：My.Computer.Keyboard.SendKeys(Textbox1.text)

但是，如果我注册 Numlock1 和 Numlock2 并将 Numlock1 的 Sendkey 值设置为“Hi”，并将 Numlock2 的值设置为“It cost 100$”，软件会将 Numlock2 中的 1 替换为 Numlock1 的值。

我来自德国，我的技能不是很好，但我希望我已经解释了一切可以理解的:)

斯坦因

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-13T16:55:47.700

我很确定没有带有 Numlock2 按钮的键盘，我不完全理解你的问题。也许您想切换 Numlock 按钮？

以下是在 VB.net 应用程序中切换 [Numluck] 的方法：

在 Visual Studio 2013 中，将这段开源代码编译为 C# 控制台应用程序。sendkey.exe 可以在命令窗口中使用。

[发送密钥 v0.0.1](http://pastebin.com/raw/yWUTjUif)

在 VB.net 中，像这样使用 Sendkey v0.0.1：

```
Public Class ExecVBNet
Shared Sub Execut(command as String, arguments as String, permanent as Boolean) 
    Dim p as Process = new Process() 
    Dim pi as ProcessStartInfo = new ProcessStartInfo() 
    pi.Arguments = " " + if(permanent = true, "/K" , "/C") + " " + command + " " + arguments 
    pi.FileName = "cmd.exe" 
    p.StartInfo = pi 
    p.Start() 
End Sub
End Class 
```

然后像这样按下numlock按钮。它类似于按下（向下）和按下（向上）一次按钮。结果是，按钮被切换。

```
ExecVBNet.Execut("Sendkey", "NUMLOCK down", true)
ExecVBNet.Execut("Sendkey", "NUMLOCK up", true) 
```

在Execut方法中，也可以直接使用“sendkey.exe”，而不用“cmd.exe”打开控制台窗口

# ios - 如何将 UIView XIB“导入”到 UIViewController XIB？

> ID：15509386
> 
> 赞同：2
> 
> 时间：2013-03-19T20:06:14.787
> 
> 标签：ios, interface-builder, xib

我在这里看到了一些似乎符合我所追求的答案，但我无法让它们中的任何一个起作用。

`MyView`是一个 UIView 子类，其中有一些图像和文本字段`MyView.xib`在`MyView.(h|m)`. `File's Owner`在XIB中没有设置，但是MyView是顶层对象的类。在运行时，我通过`NSBundle's` `loadNibNamed`. 一切都很顺利。

但是我有另一个视图控制器，`MyVC`在设计时我想填充几个 MyView 实例。按照直觉，我在其中布局了一个`MyVC.xib`与 MyView 大小相同的 UIView 对象，将其类型设置为`MyView`，在 中添加了一个 IBOutlet 声明`MyVC.h`，并连接了连接。

当我运行时，`MyVC`显示 no `MyView`。但是调试表明连接已经建立，视图确实是 a `MyView`，并且`MyView's` `awakeFromNib`确实执行了。而且我确信它`MyVC's` `MyView`位于层次结构的顶部，因为我将它的背景设置为漂亮的鲜红色。那么恶魔在哪里`MyView`呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:40:31.760

最简单的解决方案是创建`MyView`一个子视图，它是其余子视图的容器。`MyVC.xib`这为您提供了 in和 what's in之间的单点联系`MyView.xib`，并允许您连接两个 xib 中的插座。

在`MyVC.xib`中，将每个占位符视图的类设置为`MyView`。

在`MyView.xib`中，将顶级视图的类设置为`UIView`。将 File's Owner 的类设置为`MyView`. 如果您有任何`MyView`已连接到的插座，`MyView.xib`则需要将它们重新连接到 File's Owner，因为顶级视图不再具有这些插座。

在`-[MyView initWithCoder:]`中，加载`MyView.xib`并添加其顶级视图作为您的子视图。未经测试的例子：

```
+ (UINib *)nib {
    static dispatch_once_t once;
    static UINib *nib;
    dispatch_once(&once, ^{
        nib = [UINib nibWithNibName:NSStringFromClass(self) bundle:[NSBundle bundleForClass:self]];
    });
    return nib;
}

- (id)initWithCoder:(NSCoder *)aDecoder {
    if (self = [super initWithCoder:aDecoder]) {
        NSArray *contents = [[self.class nib] instantiateWithOwner:self options:nil][0];
        UIView *containerView = contents[0];

        // Make sure the container view's size tracks my size.
        containerView.frame = self.bounds;
        containerView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
        self.autoresizesSubviews = YES;
        if ([self respondsToSelector:@selector(setTranslatesAutoresizingMaskIntoConstraints:)]) {
            self.translatesAutoresizingMaskIntoConstraints = YES;
            containerView.translatesAutoresizingMaskIntoConstraints = YES;
        }
        // If you're using autolayout in both xibs, you should probably create
        // constraints between self and containerView here.

        [self addSubview:containerView];
    }
    return self;
} 
```

这样做的效果是，您可以将`MyView`'s outlets 连接到 things in`MyVC.xib`和 things in `MyView.xib`，并且您可以将其他对象的 outlets`MyVC.xib`连接`MyView.xib`到`MyView`. 但是，您不能将其他对象的出口连接`MyVC.xib`到其他对象，`MyView.xib`反之亦然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:50:37.310

ORIGINAL：覆盖initWithCoder，正如下面的评论所说的那样是个坏主意

新建议：

*   使用您现在拥有的技术创建 MyVC 视图（MyView 实例本质上是空视图）

然后在 MyVC 的 viewDidLoad: 方法中：

*   使用您的 nib 创建新的 MyView 实例，MyView 中的每个实例一个

*   将每个空的（即占位符）MyViews 替换为您刚刚创建的，确保正确设置框架（设置任何属性/ivars，并使用 '- (void)exchangeSubviewAtIndex:(NSInteger)index1 withSubviewAtIndex:(NSInteger)index2 ' 用子视图数组中的新视图替换旧视图）

# html - 用溢出隐藏一半的 div 不起作用

> ID：15509387
> 
> 赞同：-1
> 
> 时间：2013-03-19T20:06:16.620
> 
> 标签：html, css

我已经使用溢出属性来制作我不想隐藏的 div 的一半，但整个 div 消失了。

```
.line {
    position: relative;
    overflow: hidden;
}

.gl {
    position: absolute;
    right: 10px;
    width: 100%;
    height: 5px;
    background-color: green;
    display: block;

}

.rl {
    position: absolute;
    width: 100%;
    left: 30px;
    height: 5px;
    background-color: red;
    display: block;
} 
```

和这个html代码

```
<div class='m1'>
        MAIN 1
        <div class='line'><div class="rl"></div><div class='gl'></div>
        </div>
        <div class='des'>kasjfnkvanj</div>
</div> 
```

我想隐藏绿色和红色两条线，只有溢出父 div 的扩展部分，但它们都被隐藏了

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:25:28.833

您想隐藏绿色和红色背景块，但想显示来自 div.des 的内容。正确的 ？你可以对那些 div 做 display:none 。如果不希望你可以通过移除高度来隐藏它们。如果我理解这一点是正确的。

```
height:0; 
```

检查这个[小提琴](http://jsfiddle.net/ZMD5N/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:36:37.860

You want hidden overflow green and red background from .line div and this time nothing is showing so you need just fixed parent div ( .line ) width and height.

```
.line {
    position: relative;
    overflow: hidden;
    width:100px; height:10px;
} 
```

# html - 有没有办法判断 Safari 是否全屏？（例如 document.fullscreenElement）

> ID：15509389
> 
> 赞同：8
> 
> 时间：2013-03-19T20:06:22.107
> 
> 标签：html, safari, fullscreen

我正在尝试使用 Javascript 确定 Safari 是否处于全屏模式。Chrome 和 Mozilla 都使用供应商前缀版本的 document.fullscreenElement：

```
isFullscreen = function() {
  return document.fullscreenElement
      || document.webkitFullscreenElement
      || document.mozFullScreenElement;
} 
```

但是，这在 Safari 5.1.7 上不起作用——文档上没有“webkitFullscreenElement”或类似属性。

有谁知道是否有办法判断 Safari 是否处于全屏模式？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-08-02T00:49:36.660

很难找到这个，但您正在寻找的属性是：

```
document.webkitCurrentFullScreenElement 
```

如您所见，它根本不符合标准，甚至不接近。

另外值得一提的是：检查是否支持全屏模式的属性也很难找到（我仍然没有......）所以要检查我的支持：

```
if (typeof document.webkitCurrentFullScreenElement !== 'undefined') ... 
```

因为该属性将为空（或全屏元素）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T19:40:31.193

由于对此没有回应，这是我最终使用的 hack，它应该非常广泛地适用于任何人。[据推测，一旦 Safari 添加了W3 标准](https://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html#dom-document-fullscreenelement)中指定的 document.fullscreenElement，在不久的将来就不需要这样做了。

就我而言，情况是我有一个全屏按钮，我希望全屏按钮在网站全屏时变成“缩小”按钮（如 YouTube 视频）。作为其中的一部分，我已经实现了 :fullscreen css 选择器，以便在站点全屏时将我的按钮变成“缩小”按钮。

我意识到 Safari 尊重 :-webkit-full-screen css 伪类。因此，检查我的按钮图像是否为“缩小”图像是一项快速的工作（AFAIK，您无法直接测试伪类），如果是，我们必须是全屏的。

所以：

CSS：

```
.fullscreen-button
   background-image: fullscreen.png

/* these match if .fullscreen-button is inside a fullscreen body element
   (comma-separated selectors don't seem to work here?) */
body:fullscreen .fullscreen-button
   background-image: fullscreen-exit.png
body:-webkit-full-screen .fullscreen-button
   background-image: fullscreen-exit.png
body:-moz-full-screen .fullscreen-button
   background-image: fullscreen-exit.png 
```

JS：

```
isFullscreen = function() {
  // this doesn't yet exist in Safari
  if (document.fullscreenElement
      || document.webkitFullscreenElement
      || document.mozFullScreenElement) {
    return true;
  }
  // annoying hack to check Safari
  return ~$(".fullscreen-button").css("background-image").indexOf("exit")
} 
```

任何人都应该可以使用此 hack。即使您没有在全屏模式下更改按钮的背景图像之类的操作，您也应该始终能够对一个元素进行一些微不足道的小 css 规则更改 - 特别是如果它实际上是不可见的，比如不可见元素的背景颜色，或者没有任何文本的元素的字体大小——并在 JavaScript 中进行测试。

# python - BeautifulSoup .prettify() 的自定义缩进宽度

> ID：15509397
> 
> 赞同：30
> 
> 时间：2013-03-19T20:07:30.817
> 
> 标签：python, beautifulsoup, indentation, code-formatting, pretty-print

有没有办法为`.prettify()`函数定义自定义缩进宽度？从我可以从它的来源获得的信息 -

```
def prettify(self, encoding=None, formatter="minimal"):
    if encoding is None:
        return self.decode(True, formatter=formatter)
    else:
        return self.encode(encoding, True, formatter=formatter) 
```

没有办法指定缩进宽度。我认为这是因为函数中的这一行`decode_contents()`-

```
s.append(" " * (indent_level - 1)) 
```

其固定长度为 1 个空格！（为什么！！）我尝试指定`indent_level=4`，结果就是这样 -

```
 <section>
     <article>
      <h1>
      </h1>
      <p>
      </p>
     </article>
    </section> 
```

这看起来很愚蠢。:|

现在，我可以解决这个问题，但我只是想确定我是否缺少任何东西。因为这应该是一个基本功能。：-/

如果你有更好的美化 HTML 代码的方法，请告诉我。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-20T01:06:34.630

实际上，我自己以最骇人听闻的方式处理了这个问题：通过对结果进行后处理。

```
r = re.compile(r'^(\s*)', re.MULTILINE)
def prettify_2space(s, encoding=None, formatter="minimal"):
    return r.sub(r'\1\1', s.prettify(encoding, formatter)) 
```

实际上，我`prettify_2space`在`prettify`课堂上打了补丁。这对解决方案来说不是必需的，但无论如何让我们这样做，并将缩进宽度作为参数而不是将其硬编码为 2：

```
orig_prettify = bs4.BeautifulSoup.prettify
r = re.compile(r'^(\s*)', re.MULTILINE)
def prettify(self, encoding=None, formatter="minimal", indent_width=4):
    return r.sub(r'\1' * indent_width, orig_prettify(self, encoding, formatter))
bs4.BeautifulSoup.prettify = prettify 
```

所以：

```
x = '''<section><article><h1></h1><p></p></article></section>'''
soup = bs4.BeautifulSoup(x)
print(soup.prettify(indent_width=3)) 
```

……给出：

```
<html>
   <body>
      <section>
         <article>
            <h1>
            </h1>
            <p>
            </p>
         </article>
      </section>
   </body>
</html> 
```

显然，如果你想和`Tag.prettify`一样打补丁`BeautifulSoup.prettify`，你必须在那里做同样的事情。（您可能想要创建一个可以应用于两者的通用包装器，而不是重复自己。）如果有任何其他`prettify`方法，同样的处理。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-20T00:59:57.057

据我所知，这个功能不是内置的，因为有一些解决方案可以解决这个问题。

假设您使用的是 BeautifulSoup 4，这是我想出的解决方案

硬编码它。这需要最少的更改，如果您不需要缩进在不同情况下有所不同，这很好：

```
myTab = 4 # add this
if pretty_print:
   # space = (' ' * (indent_level - 1))
    space = (' ' * (indent_level - myTab))
    #indent_contents = indent_level + 1
    indent_contents = indent_level + myTab 
```

先前解决方案的另一个问题是文本内容不会完全一致地缩进，但仍然很吸引人。如果您需要更灵活/一致的解决方案，您只需修改类即可。

找到 prettify 函数并对其进行修改（它位于 element.py 中的 Tag 类中）：

```
#Add the myTab keyword to the functions parameters (or whatever you want to call it), set it to your preferred default.
def prettify(self, encoding=None, formatter="minimal", myTab=2): 
    Tag.myTab= myTab # add a reference to it in the Tag class
    if encoding is None:
        return self.decode(True, formatter=formatter)
    else:
        return self.encode(encoding, True, formatter=formatter) 
```

然后向上滚动到 Tag 类中的 decode 方法并进行以下更改：

```
if pretty_print:
    #space = (' ' * (indent_level - 1))
    space = (' ' * (indent_level - Tag.myTab))
    #indent_contents = indent_level + Tag.myTab 
    indent_contents = indent_level + Tag.myTab 
```

然后转到 Tag 类中的 decode_contents 方法并进行以下更改：

```
#s.append(" " * (indent_level - 1))
s.append(" " * (indent_level - Tag.myTab)) 
```

现在 BeautifulSoup('<root><child><desc>Text</desc></child></root>').prettify(myTab=4) 将返回：

```
<root>
    <child>
        <desc>
            Text
        </desc>
    </child>
</root> 
```

**无需修补 BeautifulSoup 类，因为它继承了 Tag 类。修补 Tag 类足以实现目标。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-07-27T06:08:57.557

这是一种在不干预原始函数等的情况下增加缩进的方法。创建以下函数：

```
# Increase indentation of 'text' by 'n' spaces
def add_indent(text,n):
  sp = " "*n
  lsep = chr(10) if text.find(chr(13)) == -1 else chr(13)+chr(10)
  lines = text.split(lsep)
  for i in range(len(lines)):
    spacediff = len(lines[i]) - len(lines[i].lstrip())
    if spacediff: lines[i] = sp*spacediff + lines[i] 
  return lsep.join(lines) 
```

然后使用上述函数转换您获得的文本：

```
x = '''<section><article><h1></h1><p></p></article></section>'''
soup = bs4.BeautifulSoup(x, 'html.parser')  # I don't know if you need 'html.parser'
text = soup.prettify()                      # I do, otherwise I get a warning
text = add_indent(text,1) # Increase indentation by 1 space 
print(text)
'''
Output:
<html>
  <body>
    <section>
      <article>
        <h1>
        </h1>
        <p>
        </p>
      </article>
    </section>
  </body>
</html>
''' 
```

# scala - net.databinder.dispatch 因保持活动连接过多而失败

> ID：15509398
> 
> 赞同：4
> 
> 时间：2013-03-19T20:07:36.553
> 
> 标签：scala, scala-dispatch

我使用 net.databinder.dispatch 来调用 Web 服务器：

```
import dispatch._

def request(in: String, address: java.net.URI, headers: Map[String, String]): String = {
  val req = url(address.toString) << in <:< headers
  val s = Http(req OK as.String)
  s()
} 
```

客户定义：

```
Connection: keep-alive 
```

并且服务器定义：

```
Keep-Alive: timeout=120, max=256 
```

如果我连续多次调用网络服务器（但不是并行），我会收到错误消息：

```
Exception in thread "main" java.util.concurrent.ExecutionException: dispatch.StatusCode: Unexpected response status: 500
    at com.ning.http.client.providers.netty.NettyResponseFuture.abort(NettyResponseFuture.java:297)
19:32:46.474 [New I/O  worker #10] DEBUG c.n.h.c.p.n.NettyAsyncHttpProvider - Unexpected response status: 500
    at com.ning.http.client.providers.netty.NettyAsyncHttpProvider.abort(NettyAsyncHttpProvider.java:1326)
dispatch.StatusCode: Unexpected response status: 500
    at com.ning.http.client.providers.netty.NettyAsyncHttpProvider.access$700(NettyAsyncHttpProvider.java:137) 
```

关闭连接的其他 Web 服务器不会发生此错误。

这里有什么问题？网络服务器？客户端？

net.databinder.dispatch 是否真的使用了 keep-alive 功能（所以，重用同一个套接字），还是每次都创建一个新的？如何修改前面的示例以告诉 net.databinder.dispatch 使用 keep-alive 功能？

我正在使用的版本：

```
<dependency>
  <groupId>net.databinder.dispatch</groupId>
  <artifactId>dispatch-core_2.10</artifactId>
  <version>0.9.5</version>
</dependency> 
```

# android - 用于拆分操作栏的不同可绘制对象

> ID：15509401
> 
> 赞同：4
> 
> 时间：2013-03-19T20:07:58.427
> 
> 标签：android, android-actionbar

如果菜单项被推送到拆分操作栏，有没有办法提供不同的可绘制图标？我的拆分操作栏颜色与顶部栏有很大不同，并且单个图标样式在视觉上并不像我希望的那样令人愉悦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T12:10:18.043

将`Drawables`要用于拆分的`/res/drawable/`放入 并将其他放入`/res/drawable-w480dp`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-06-01T12:25:08.843

在 appcompat 库中，拆分 ActionBar 用于除大型、陆地或 sw480dp 之外的配置。如果您使用的是本机 ActionBar，我想您可以跳过大型配置。

![split_action_bar_is_narrow](../Images/79e11a7ce70535e150c4699b046a1ad8.png)

然后，要提供替代可绘制对象，您应该在这些值目录中定义适当的引用，例如：

在`values`：

```
<item name="action_search_drawable" type="drawable" format="reference">@drawable/ic_action_search_narrow</item> 
```

在`values-w480dp`：

```
<item name="action_search_drawable" type="drawable" format="reference">@drawable/ic_action_search</item> 
```

然后，在菜单配置中，您应该将此引用用作可绘制的图标。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-10-09T15:27:14.060

您可以`LevelListDrawable`在屏幕配置更改时使用图标并设置级别（这意味着`Activity.onCreate()`调用.

*   创建一个可在图标中使用的drawable

    ```
    <level-list xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:maxLevel="0" android:drawable="@drawable/**your bitmap dark**" />
    <item android:maxLevel="1" android:drawable="@drawable/**your bitmap light**" />
    </level-list> 
    ```

*   检测 ActionBar 是否被拆分。这部分似乎很棘手。我正在使用 SherlockActionBar 并且它以[这种方式工作（直到今天的 Android 版本）](https://stackoverflow.com/questions/10105473/determine-if-action-bar-is-split)

*   要更改一个可绘制对象，请使用 设置相应`ActionBar.Tab`的级别`getIcon().setLevel()`。请注意，您不需要强制转换为`LevelListDrawable`. 无论出于何种原因，级别概念都直接通过`Drawable`类实现。

# jsf-2 - 未调用 JSF2 中的自定义组件

> ID：15509402
> 
> 赞同：0
> 
> 时间：2013-03-19T20:08:04.660
> 
> 标签：jsf-2, facelets

我在我的应用程序中创建了一个自定义标签，但由于某种原因它不起作用，我按照[本](http://www.xinotes.org/notes/note/1558/ "这")教程（这是我发现放在这里作为参考的最清晰的教程）但是，就像我做的其他教程一样，我的自定义标签不叫。

**WEB-INF/example.taglib.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<facelet-taglib
    xmlns="http://java.sun.com/xml/ns/javaee"
    version="2.0">
    <namespace>http://example.com/facelettags</namespace>
    <tag>
        <tag-name>hello</tag-name>
        <handler-class>example.MenuTagHandler</handler-class>
    </tag>
</facelet-taglib> 
```

**我的标签处理程序类**

```
package example;

public class MenuTagHandler extends TagHandler {

    private String name = "Anonymous";

    public MenuTagHandler(TagConfig config) {
        //other constructor stuff
        Logger.getLogger(MenuTagHandler.class).info("aaaa");
        //other constructor stuff
    }

    @Override
    public void apply(FaceletContext context, UIComponent parent) throws IOException {
        Logger.getLogger(MenuTagHandler.class).info("aaaa");
        UIComponentBase c = new UIComponentBase() {
            @Override
            public void encodeEnd(FacesContext ctx) throws IOException {
                ResponseWriter w = ctx.getResponseWriter();
                w.write(String.format(
                        "<p>Hello %s! I am FaceletTag.</p>",
                        name));
            }

            // abstract method in base, must override
            @Override
            public String getFamily() {
                return "com.example.facelettag.test";
            }
        };
        parent.getChildren().add(c);
    }
} 
```

**我的 .xhtml 文件**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:exampler="http://example.com/facelettags" >
        <example:hello />
</ui:composition> 
```

***渲染的结果是***

```
<example:hello></example:hello> 
```

不幸的是，日志中没有打印任何内容，有人知道它为什么不调用标签处理程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:21:09.827

如果`*.taglib.xml`文件不在放置的`/META-INF`JAR 文件中`/WEB-INF/lib`，因此不会被自动检测和注册（就像所有那些 3rd 方 JSF 组件库，如 PrimeFaces、RichFaces 等），那么你会需要在webapp的手动注册`web.xml`如下：

```
<context-param>
    <param-name>javax.faces.FACELETS_LIBRARIES</param-name>
    <param-value>/WEB-INF/example.taglib.xml</param-value>
</context-param> 
```

* * *

**与具体问题无关**，请注意，您到目前为止不是自定义组件。这是一个自定义标记处理程序，它反过来创建一个匿名的`UIComponentBase`. 这不一定是“最佳”做法。如果您在视图构建期间不需要执行与组件树相关的任何操作，那么您根本不需要 taghandler 部分。只需创建一个完全有价值的`@FacesComponent`课程。

### 也可以看看：

*   [何时使用 <ui:include>、标记文件、复合组件和/或自定义组件？](https://stackoverflow.com/questions/6822000/when-to-use-uiinclude-tag-files-composite-components-and-or-custom-componen/6822269#6822269)

# windows - 需要一个批处理文件来复制新的和更改的文件

> ID：15509404
> 
> 赞同：3
> 
> 时间：2013-03-19T20:08:09.827
> 
> 标签：windows, batch-file

我需要将文件从一个位置复制到另一个位置，但只复制新文件或已更改的文件。

例如，我在 C:\Working 中有数据，其中包括文件夹和文件。这些文件被更改，并从那里删除，因为它们不再需要或项目已完成。

我需要一个批处理文件将该位置中的所有内容移动到 D:\Storage。由于某些文件可能没有更改，因此我不想复制这些文件，但是，我确实想复制和替换已修改的文件。

我相信我可以使用 Robocopy /E，这会给我我需要的递归。我不确定如何检查哈希或标记以验证文件是否已更改。我知道我可以使用 /XC 排除文件，但我认为这与我想要的相反。

现在我的文件如下：

```
@echo off
pushd C:\Working
>nul Robocopy /E . D:\Storage
popd 
```

编辑：我不想只复制所有内容，因为工作位置可能有超过 60GB 的空间，并且只需要复制 1-2GB。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T20:25:39.627

[http://ss64.com/nt/robocopy.html](http://ss64.com/nt/robocopy.html)

> 默认情况下，仅当源和目标具有不同的时间戳或不同的文件大小时，Robocopy 才会复制文件。

因此，`Robocopy . D:\Storage /E`应该没问题。您可能需要`/XO`根据需要添加选项。

# c++ - 在 Ad hoc 网络中发送洪水消息

> ID：15509408
> 
> 赞同：0
> 
> 时间：2013-03-19T20:08:28.690
> 
> 标签：c++, networking, adhoc

我正在编写一个 c++ 程序，它将在某种形式的 Linux（可能基于 debian）上运行，该程序需要连接到 ad hoc 网络然后发送洪水消息。我可以自己完成连接，但我不知道如何发送洪水消息。我可以为它编写自己的协议，因为网络上的所有机器都将运行我的软件，但我想让它向下工作。我在互联网上环顾四周，找不到任何用于发送洪水消息的 api。有谁知道如何做到这一点？

# sql - 通过多个数据库查询克服 ORA-00904 错误

> ID：15509412
> 
> 赞同：0
> 
> 时间：2013-03-19T20:09:09.370
> 
> 标签：sql, oracle

我有一些代码在 2 个不同的数据库中运行相同的查询。

```
SELECT
    P.MYID,
    CASE WHEN 
        SUBSTR(P.MYID, 1, 1) NOT IN ('W') THEN 
            'YOUR_ID_IS_NOT_START_WITH_W'                      
        ELSE
            (SELECT OTHER_ID FROM PERSON WHERE NUMBER = '2554' )
    END AS "ALTERNATE_ID"
FROM
    PERS_INFO P
WHERE
    P.NUMBER = '2554' 
```

此示例中的 OTHER_ID 是仅存在于第二个数据库中的列。这完全没问题，因为只有当 id 不以“W”开头时，查询才会在第一个数据库中执行。换句话说，这个查询只会在第一个数据库中运行，当 MYID 不以“W”开头时，并且只会在 MYID 确实以“W”开头时在第二个数据库中运行。

所以查询可以在两个数据库中工作，但是，查询在第一个数据库中失败并出现 ORA-00904，因为它说 OTHER_ID 在第一个数据库中是不合法的（这是真的，但我不在乎）。我如何强制 oracle 无论如何运行查询或解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:34:12.563

您可以在两个数据库中创建一个函数来获取 OTHER_ID 值。它只会在您的第一个数据库中返回 null 。

例如，在第一个数据库中：

```
create or replace function f_get_other_id(for_no in varchar2) return varchar2 is
begin
  return null;
end; 
```

在第二个数据库中：

```
create or replace function f_get_other_id(for_no in varchar2) return varchar2 is
  v_other_id varchar2(100);
begin
  select other_id into v_other_id from person where number = for_no;
  return other_id;
end; 
```

然后，您的查询可以是：

```
select p.myid,
       case 
         when substr(p.myid, 1, 1) not in ('W') then 'YOUR_ID_IS_NOT_START_WITH_W' 
         else f_get_other_id('2554') 
       end as "ALTERNATE_ID"
  from pers_info p
 where p.number = '2554' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:30:40.230

您是否听说过 EXECUTE_IMMEDIATE ( [http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/executeimmediate_statement.htm](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/executeimmediate_statement.htm) ) 命令或 DBMS_SQL（请参阅[http://docs.oracle.com/cd/B28359_01 /appdev.111/b28419/d_sql.htm](http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_sql.htm)）？

如果您正在使用具有不同表定义的各种数据库上的脚本，这可能是您的解决方案，尽管这需要 PL/SQL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T20:36:07.267

我不确定将这个列添加到当前不存在的数据库中会出现什么问题，但添加它似乎是一个相当低的工作量和低风险的练习，并且会永久解决这类问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T20:26:16.370

在检查数据库名称之后，您可能需要添加另一个 CASE。案例 db_name = db_name1 然后是您的 other_id 查询或者其他一些查询 lk select 1 from dual... 您可以从 v$database 视图获取 db_name。

# ruby-on-rails - 使用 rails 表单修改用户模型

> ID：15509413
> 
> 赞同：0
> 
> 时间：2013-03-19T20:09:15.940
> 
> 标签：ruby-on-rails, devise

这里的总轨道菜鸟，所以请多多包涵。很长一段时间以来，我一直在试图弄清楚如何制作一个允许登录用户通过文本字段更改用户模型的某些属性的页面。例如，我的用户模型有许多我想通过页面直接修改的“测量”属性。我的用户模型在 Devise 上运行——我不确定我是否通过直接修改用户模型来做正确的事情。

这是我的控制器。我将其设置为查找第二个用户，因为我只是对其进行测试以查看它是否有效。

```
class MeasurementsController < ApplicationController
    def index
        @person = User.find(2)
    end
end 
```

这是我的 index.html.erb：

```
<%= form_for @person do |f| %>
    <%= f.label :style %>:
    <%= f.text_field :style %><br />
    <%= f.submit "Update"%>
<% end %> 
```

但是，它吐出这个错误：

```
NoMethodError in Measurements#index
undefined method `user_path' 
```

任何帮助将非常感激。提前非常感谢。在这里真的迷路了。

编辑：这是我的 routes.rb：

```
Contourfw::Application.routes.draw do
  ActiveAdmin.routes(self)

  devise_for :admin_users, ActiveAdmin::Devise.config
  devise_for :users
  root :to => 'contourfw#landingpage'
  match "measurements" => "measurements#index"
  match "styles" => "styles#index"
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:33:14.853

看起来您需要在 config/routes.rb 中添加一个资源丰富的路由：

```
resources :users 
```

**更新** 默认情况下，它将假定一个名为 users_controller.rb 的控制器。如果您希望它使用上面的控制器，请将其修改为：

```
resources :users, :controller => "measurements" 
```

有关详细信息，请参阅[http://guides.rubyonrails.org/routing.html#customizing-resourceful-routes 。](http://guides.rubyonrails.org/routing.html#customizing-resourceful-routes)

# ruby - 在不使用 @ 符号的情况下访问实例变量

> ID：15509416
> 
> 赞同：8
> 
> 时间：2013-03-19T20:09:17.660
> 
> 标签：ruby

这是一本书的例子：

```
class TextCompressor
  attr_reader :unique, :index
  def initialize( text )
    @unique = []
    @index = []
    add_text( text )
  end
  def add_text( text )
    words = text.split
    words.each { |word| add_word( word ) }
  end
  def add_word( word )
    i = unique_index_of( word ) || add_unique_word( word )
    @index << i
  end
  def unique_index_of( word )
    @unique.index(word)
  end
  def add_unique_word( word )
    @unique << word
    unique.size - 1
  end
end 
```

在该方法中，作者在不使用@ 符号( )`add_unique_word`的情况下访问变量。这怎么可能，为什么会这样？`unique``unique.size - 1`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-19T20:13:13.213

此行为该属性`attr_reader :unique, :index`创建了一个：`getter`

```
def unique
 @unique
end 
```

您在该行中看到的`unique.size - 1`是对 getter 的方法调用，然后访问`size`它的属性。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-19T20:12:56.910

该`attr_reader :unique`调用添加了一个访问器，该访问器在`@unique`上公开可用`unique`。作者做出了一个奇怪的选择来混合和匹配使用两者`@unique`和`unique`虽然。

# sql - 按结果最高的人分组，然后按日期分组

> ID：15509420
> 
> 赞同：0
> 
> 时间：2013-03-19T20:09:30.480
> 
> 标签：sql, sql-server, group-by

我在这里找到了许多相关的主题，但没有真正解决我的问题。

销售表：

```
PersonID | SaleAmount | SaleDate | TransactionID
6117 | 10 | 2013-03-13 | 1
6117 | 10 | 2013-03-11 | 2
6400 | 100 | 2013-03-12 | 3
6400 | 10 | 2013-02-05 | 4
6525 | 0 | 2013-03-14 | 5
6400 | 0 | 2013-04-01 | 6 
```

我只想要每个人的最高销售额交易。如果来自同一个人的所有交易具有相同的销售额，则按日期返回最新的一笔。

预期结果：

```
PersonID | SaleAmount | SaleDate | TransactionID
6117 | 10 | 2013-03-13 | 1
6400 | 100 | 2013-03-12 | 3
6525 | 0 | 2013-03-14 | 5 
```

我可以按销售额最高的人分组，但如果一个人的所有销售额相同，我就无法获得最新的交易。

```
select personid, max(saleamount) from SalesTable group by personid 
```

这是错误的

```
select personid, max(saleamount), max(saledate) 
from SalesTable 
group by personid 
```

因为它会给我 6400 的错误日期

```
6117 | 10 | 2013-03-13 | 1
6400 | 100 | 2013-04-01 | 3
6525 | 0 | 2013-03-14 | 5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:19:14.463

尝试：

```
with cte as
(select s.*, 
        rank() over (partition by PersonID 
                     order by SaleAmount desc, SaleDate desc) rn
 from SalesTable s)
select PersonID, SaleAmount, SaleDate, TransactionID
from cte
where rn=1 
```

# batch-file - 为批处理文件添加空间

> ID：15509425
> 
> 赞同：0
> 
> 时间：2013-03-19T20:09:52.557
> 
> 标签：batch-file

我的批处理如何处理路径示例中的空间：

C:\Documents and Settings\K\Desktop\新建文件夹

```
@echo off
pushd "%~dp0"
IF EXIST "%1" GOTO DECODE_INDIVIDUAL

:DECODE_MULTIPLE
xcopy /s /c /d /e /h /i /r /y "%cd%\encoded" "%cd%\decoded\"
dir "%cd%\decoded\*.php"  /A:-D /B /O:N /S >> "%cd%\filelist.txt"

@echo on
for /F %%e in ("%cd%\filelist.txt") do ( copy "%%e" "bin\file.php" && "php.exe" "bin\decoder.php" "bin\file.php" && move "bin\file.php" "%%e" && del "bin\file.php")
del /Q "%cd%\filelist.txt"
GOTO DECODE_END

:DECODE_INDIVIDUAL
@echo on
"php.exe" "%cd%\bin\decoder.php" "%1"

:DECODE_END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T22:50:18.990

```
for /F "USEBACKQ delims=" %%e in ..... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:49:53.507

如果路径或文件名中有空格，则必须将分隔符设置为空：

```
for /F "usebackqdelims=" %%e in ("%cd%\filelist.txt") do ( copy "%%~e" "bin\file.php" && "php.exe" "bin\decoder.php" "bin\file.php" && move "bin\file.php" "%%~e" && del "bin\file.php") 
```

您应该使用 better `%%~z`than `%%z`，`~`确实会删除额外的双引号。

根据彼得赖特的回答编辑。

# html - html id 选择器与其他类型的选择器

> ID：15509427
> 
> 赞同：-2
> 
> 时间：2013-03-19T20:09:55.660
> 
> 标签：html, css, dom, selector

我听说 id 选择器是独一无二的，因为页面上只能有一个具有特定 ID 名称的元素。在实践中，当通过 javascript 和 css 中的 id 选择元素时，这似乎根本不正确，库或浏览器似乎都不关心，是否存在具有相同 id 的多个元素的任何剩余后果，例如浏览器对此要严格得多，如果存在具有相同 id 的元素，则不会加载页面？

如果“元素必须具有唯一的 id”这句话根本不正确，我会很满足

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:15:12.013

它们都会呈现（不同程度），但是当您使用 JS 的 CSS 在 ID 上进行选择时，后果是显而易见的。在这种情况下，它可能不会给您您要选择的那个。不确定哪个将被选中并且可能不可重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:22:02.053

如果您有多个具有相同 id 的元素，则更改 css 属性只会影响第一个元素。

```
 <div id="test"></div>
 <div id="test"></div>

 $("#test").css("border-color","red"); 
```

[http://jsfiddle.net/btevfik/tLB4U/](http://jsfiddle.net/btevfik/tLB4U/)

# tfs - TFS 构建与本地构建

> ID：15509431
> 
> 赞同：4
> 
> 时间：2013-03-19T20:10:05.013
> 
> 标签：tfs, visual-studio-2012, tfsbuild

虽然 MSDN 提供了很多定义，但我真的不明白 tfs build 的含义。

例如，我有一个 asp.net 项目。如果我通过本地机器上的本地构建并签入代码。一切都很好。

我曾经将代码复制（发布）到服务器，就是这样。

为什么我们需要 tfs 构建？tfs 构建和本地构建有什么不同。你可能会说，有些构建历史可以恢复到旧的。但我认为，由于代码是版本化的，我们可以检查它并在本地机器中重建，然后将项目重新发布到服务器。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T00:10:15.363

当我使用 TFS 时，我可以在本地机器上运行本地构建。然后在签入代码时，TFS 会自动在构建服务器上执行构建（这是通过构建定义指定的）。在这种情况下，构建服务器位于存放 TFS 源存储库主副本的机器上。

每个开发人员在本地构建是不够的，因为他们可能没有最新的代码。我认为 TFS 构建的重点在于它将在具有所有最新代码的构建服务器上运行构建。我认为这个想法是，如果在构建服务器上构建成功，那么签入代码就被认为是安全的。

反正我是这么理解的。如果有多个开发人员在一个项目上工作，这很有用。如果一台机器上只有一个开发人员，则可能不需要单独构建。

这回答了你的问题还是我误解了？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T08:06:14.687

CiaranG 的答案确实是一种看待它的方式。

此外，TF Build 服务器还可以使用签名的第 3 方 DLL 构建您的代码，并将所有内容放在一个地方，就像每次发布您的软件的新版本一样。这对于需要测试您的软件并且不需要开发工具的测试人员很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:05:13.307

除了 CiaranG 对持续集成好处的描述之外，还有安全性和清洁性。允许在可能存在病毒/恶意软件且配置未知/未记录的开发人员机器上构建生产代码只是糟​​糕的策略。通过在受保护的服务器上构建它，从不进行任何冲浪，您可以确保一个安全、干净、可重现的环境，从而为您的代码部署增加专业性。TFS 还添加了随时间、责任和存档的报告构建指标。

# php - 与/n相反？- ESC/POS 和 PHP 右/左对齐在同一行

> ID：15509437
> 
> 赞同：6
> 
> 时间：2013-03-19T20:10:23.540
> 
> 标签：php, string, printing, epson

所以我从我们的网络服务器（也在办公室）打印到办公室的联网热敏打印机，这样客户就可以在网站上下订单，然后他们就会出现在销售部门的办公桌上。这是我使用的代码，它工作得很好。然而，在打印单据上的项目时，我希望项目文本居中对齐，价格文本右对齐，但它不会让我这样做（因为我认为它是同一行）所以我怎么能说换行（\ n) 但随后将其反转。我已经尝试了 \033F 和 \F 但没有运气。有什么建议吗？

```
$texttoprint = "";
//center,bold,underline - close underline, close bold
$texttoprint .= "\x1b\x61\x01\x1b\x45\x01\x1b\x2d\x02\x1b\x21\x10\x1b\x21\x20 Company name \x1b\x2d\x00\x1b\x45\x00";
$texttoprint .= "\n";
//normal text
$texttoprint .= "\x1b\x21\x00 Address";
$texttoprint .= "\n"; 
//normal text
$texttoprint .= "\x1b\x21\x00 Adress2";
$texttoprint .= "\n";
//normal text
$texttoprint .= "\x1b\x21\x00 Tel : ...";
$texttoprint .= "\n";
$texttoprint .= "\n";
//normal text
$texttoprint .= "\x1b\x21\x00 Website order";
$texttoprint .= "\n";
$texttoprint .= "\n";
//center,bold,underline - close underline, close bold
$texttoprint .= "\x1b\x61\x01\x1b\x45\x01\x1b\x2d\x02\x1b\x21\x10\x1b\x21\x20 Tax Invoice \x1b\x2d\x00\x1b\x45\x00";
$texttoprint .= "\n";
$texttoprint .= "\n";
//align center, normal text
$texttoprint .= "\x1b\x61\x01\x1b\x21\x00 1x product";
//align right, normal text
$texttoprint .= "\x1b\x61\x02\x1b\x21\x00 $200";
... 
```

正如你在这里看到的，最后两个在同一条线上，我试图证明产品中心和价格是正确的。他们最终都居中，如果我在两者之间加上 /n，那么他们就在错误的行上正确地证明了这一点。

```
$texttoprint = stripslashes($texttoprint);

$fp = fsockopen("192.168.0.168", 9100, $errno, $errstr, 10);
if (!$fp) {
echo "$errstr ($errno)<br />\n";
} else {
fwrite($fp, "\033\100");
$out = $texttoprint . "\r\n";
fwrite($fp, $out);
fwrite($fp, "\012\012\012\012\012\012\012\012\012\033\151\010\004\001");
fclose($fp);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T20:56:10.393

您可以让打印机完成所有工作，但我认为将有关打印机特性的一些知识实施到输出例程中是一个更好的主意。您应该知道每行可以打印多少个字符。

然后，您可以使用`sprintf()`格式化整行，产品信息与左侧对齐，最大字段大小，价格与右侧对齐。

```
$texttoprint .= sprintf('%s %f', $article, $price); // very basic start: A string and a float
$texttoprint .= sprintf('%-30.30s %8.2f', $article, $price); 
// 30 chars for the string, will not exceed this length, and 8 chars for the price, with decimal dot and 2 decimal digits. 
```

请注意，您不应该`stripslashes()`在最终结果上使用。如果您对存在斜线有疑问，它们是由“魔术引号”引入的，应该在开头而不是结尾处消除。

一个不同的解决方案是将打印机切换到“Windows”模式并让他需要 CR/LF 来完成完整的行打印输出。这样，您可以通过仅打印 CR 来打印整行而不移动纸张，这会将打印头再次移动到行的开头。然后，您可以再次在已打印的行顶部打印，直到打印 LF。请注意，如果涉及实际的打印头，这可能会使事情变得更糟，因为它可能会触发额外的打印头移动以打印一行。印刷商通常能够优化打印头移动，以实现一条接一条的线。

# angularjs - 将当前范围传递给 AngularJS 服务

> ID：15509457
> 
> 赞同：106
> 
> 时间：2013-03-19T20:11:41.123
> 
> 标签：angularjs, data-binding, angularjs-scope, angular-services

将“当前”传递`$scope`给 AngularJS 服务是否正确？

我的情况是，我有一个 $service 知道它只被一个控制器使用，并且我想在 $service 方法本身中引用控制器的范围。

这在*哲学*上是正确的吗？

或者我最好将事件广播到 $rootScope 然后让我的控制器监听它们？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-03-19T20:56:59.450

为了让控制器知道什么时候异步发生了，使用[Angular 的 promises](http://docs.angularjs.org/api/ng.$q)。

要激发`$apply`，您不需要范围，您可以调用`$rootScope.$apply`，因为在特定范围或根中调用它没有区别。

关于变量读数，如果您收到参数会更好。但是您也可以从作用域中将其作为对象参数读取，但我会使用参数，这将使您的服务接口更加清晰。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-19T20:52:56.733

我会说，如果您的功能仅特定于一个控制器，那么您就不需要服务。

控制器的任务是操作特定的模型，而服务应该处理全局任务。我宁愿坚持这种范式，也不愿把事情混为一谈。

这就是文档所说的

**服务**

> Angular 服务是执行 Web 应用程序常见的特定任务的单例

**控制器**

> 在 Angular 中，控制器是一个 JavaScript 函数（类型/类），用于增加 Angular 范围的实例，不包括根范围。

PS：除此之外，如果您需要消化，您还可以在您的服务中注入 $rootScope。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-08-22T16:34:56.080

是的。您可以在初始化时将 $scope 传递给服务。在服务构造函数中，您可以将范围分配给类似 this._scope 的内容，然后在服务中引用范围！

```
angular.module('blah').controller('BlahCtrl', function($scope, BlahService) {

    $scope.someVar = 4;

    $scope.blahService = new blahService($scope);

});

angular.module('blah').factory('blahService', function() {

    //constructor
    function blahService(scope) {
        this._scope = scope;

        this._someFunction()
    }

    //wherever you'd reference the scope
    blahService.prototype._someFunction = function() {

        this._scope['someVar'] = 5;

    }

    return blahService;

}); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-12-16T15:55:47.110

我个人认为将整体传递`$scope`给服务是一个**坏主意**，因为它创建了一种循环引用：控制器依赖于服务，而服务依赖于控制器的范围。

除了在关系方面令人困惑之外，像这样的事情最终会妨碍垃圾收集器。

我首选的方法是将[域对象](http://c2.com/cgi/wiki?DomainObject)放在控制器范围内并将其传递给服务。这样，无论它是在控制器内部使用还是将来在另一个服务内部使用，服务都可以正常工作。

例如，如果服务应该从数组中推送和弹出元素`errors`，我的代码将是：

```
var errors = [];
$scope.errors = errors;
$scope.myService = new MyService(errors); 
```

然后服务通过在 上操作与控制器交互`errors`。当然，我必须小心不要清除整个数组引用，但归根结底，这是 JS 普遍关心的问题。

我永远不想使用广播`$apply`和/或类似的东西，因为恕我直言，好的 OO 实践总是胜过任何 Angular 魔法。

# javascript - 使用尽可能多的单独线程检索 5 个图像 - jquery ajax

> ID：15509458
> 
> 赞同：0
> 
> 时间：2013-03-19T20:11:43.073
> 
> 标签：javascript, jquery

考虑以下：

> 使用 ajax 调用和 json，使用 5 个单独的线程检索 5 个图像。结果应该在每个图像检索调用返回时填充视图。

所有这些都将在本地完成，我计划使用 jquery ajax 方法从 json 文件中检索这些图像。

我需要了解“使用 5 个单独的线程”来检索这些图像是什么意思。这将如何影响我的 ajax 调用？代码可能是什么样的？*单独的线程*是否表示单独的 ajax 调用？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:25:44.687

浏览器环境中的 JavaScript 仅支持通过 WebWorkers 进行线程化，而 WebWorkers 本身无权访问 DOM-Tree。

所有其他类型的并发都由基于事件的模型“模拟”。由于从 WebWorker 启动 XMLHttpRequest 并没有真正的意义，您所能做的就是进行单独的*异步*AJAX 调用并在相应的事件处理程序中处理编码的图像数据（但在 JSON 文件中编码图像数据并没有对我来说很有意义，除非你有一个非常特殊的应用程序。但这就是我理解你的问题的方式）。

编辑：一个如何实现这一点的简单示例，并考虑到您只想检索图像路径并将其分配给 id 为“img0”-“img4”的图像标签，您可以使用 jQuery 编写以下代码：

```
for (var i = 0; i < 5; i++) {
    jQuery.ajax(
        {
            'async': true,
            'url': 'imagePath.json?idx=' + i,
            'context': {'idx': i}
        })
    .done(function (data) {
        $("#img" + this.idx).attr('src', data.path);
    });
} 
```

# android - LSD - 线段检测器/Android？

> ID：15509461
> 
> 赞同：0
> 
> 时间：2013-03-19T20:11:59.387
> 
> 标签：android, line, segment

LSD 是一种线性时间线段检测器，可提供亚像素准确的结果。它旨在处理任何数字图像而无需参数调整。它控制自己的错误检测数量：平均而言，每张图像允许出现一个错误警报。该软件包包括一个小例子，

我可以在 android 中工作吗？如果可以，正确的方法是什么？

```
#include <stdio.h>
#include "lsd.h"

int main(void)
{
  image_double image;
  ntuple_list out;
  unsigned int x,y,i,j;
  unsigned int X = 512;  /* x image size */
  unsigned int Y = 512;  /* y image size */

  /* create a simple image: left half black, right half gray */
  image = new_image_double(X,Y);
  for(x=0;x<X;x++)
    for(y=0;y<Y;y++)
      image->data[ x + y * image->xsize ] = x<X/2 ? 0.0 : 64.0; /* image(x,y) */
      IplImage* imgInTmp = cvLoadImage("C:\Documents and Settings\Eslam farag\My Documents\Visual Studio 2008\Projects\line\hand.JPEG", 0);

  /* call LSD */

  out = lsd(image);

  /* print output */
  printf("%u line segments found:\n",out->size);
  for(i=0;i<out->size;i++)
    {
      for(j=0;j<out->dim;j++)
        printf("%f ",out->values[ i * out->dim + j ]);
      printf("\n");
    }

  /* free memory */
  free_image_double(image);
  free_ntuple_list(out);

  return 0;
} 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-05T12:36:22.517

我认为如果您使用 c 或 c++ 来开发您的 apk，那么您可以简单地包含该 lsd.h，它的源文件 lsd.cpp，然后您只需将参数传递给该线段检测器就足够了。但是，如果您将 java 用于您的 apk，那么您必须进行大量修改，要么您必须将其转换为 java 类，要么您必须找到一种替代方法将其包含到您的项目中。

# ios - NSURLResponse 返回 Content-Range，忽略我要求的范围

> ID：15509465
> 
> 赞同：4
> 
> 时间：2013-03-19T20:12:14.693
> 
> 标签：ios, nsurlrequest, nsurlcache

下载文件时，我希望能够恢复下载。例如：

```
NSFileManager *fm = [NSFileManager defaultManager];
NSString *downloadTempPath = [_tempPath path];
if ([fm fileExistsAtPath:downloadTempPath]) {
    // We have a partial download. Get the rest of the file starting at byteCount
    NSDictionary *dAttrib = [fm attributesOfItemAtPath:downloadTempPath error:nil];
    NSUInteger byteCount = [dAttrib fileSize];
    NSLog(@"Preparing to resume download: %@", downloadTempPath);
    NSString *requestRange = [NSString stringWithFormat:@"bytes=%d-", byteCount];
   [self.request setValue:requestRange forHTTPHeaderField:@"Range"];
} 
```

这将产生一个带有如下标头的 get 请求：

> 范围：字节=1000-

我希望第一个 206 响应给我一个我要求它开始的块，有一个像这样的标题和值（从 转储`allHeaderFields`）：

> “内容范围”=“字节 1000-340197/340198”；

但有时它会跳到前面并返回如下内容：

> “内容范围”=“字节 32000-340197/340198”；

这真的很糟糕，因为我需要从 1000 到 32000 的那些字节，但它并没有给我。

我知道没有服务器错误，因为当我卷曲到服务器时，它会返回我要求的部分。另外，当我使用wireshark 时，我看不到任何数据包进入服务器。所以这是 iOS 端的问题，可能与`NSURLCache`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:26:27.337

这似乎是`NSURLCache`. 当我检测到问题已经发生时，我执行以下操作并重试。

```
 [[NSURLCache sharedURLCache] removeCachedResponseForRequest:self.request]; 
```

一旦我这样做了，问题就不会再发生了。它似乎可以治愈缓存。我在 iOS5.0 上看到了这一点，由于我无法再复制，我不知道它是否会发生在较新的操作系统上。

# java - 如何确定应用程序的方法计数？

> ID：15509466
> 
> 赞同：19
> 
> 时间：2013-03-19T20:12:15.507
> 
> 标签：java, android

我的应用程序有太多方法时遇到问题。

在下面链接的最后一篇文章中，一位发帖人发布了他的应用程序的方法计数（按包细分）。我无法找到如何为我的申请获取此信息，有什么建议吗？

[https://code.google.com/p/android/issues/detail?id=20814](https://code.google.com/p/android/issues/detail?id=20814)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2014-05-21T10:24:14.450

我用

```
cat build/dex/debug/classes.dex | head -c 92 | tail -c 4 | hexdump -e '1/4 "%d\n"' 
```

我明白了`55176`。64k 限制即将到来：D

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-08-31T07:57:07.160

要获取每个构建的方法计数报告，请执行以下操作：

在`app/build.gradle`：

```
buildscript {
    repositories {
        mavenCentral() // or jcenter()
    }

    dependencies {
        classpath 'com.getkeepsafe.dexcount:dexcount-gradle-plugin:0.7.3'
    }
}

// make sure this line comes *after* you apply the Android plugin
apply plugin: 'com.getkeepsafe.dexcount' 
```

它将显示每个包的方法数量，用于您自己的项目和您使用的库。

来自：[https ://github.com/KeepSafe/dexcount-gradle-plugin](https://github.com/KeepSafe/dexcount-gradle-plugin)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-04-30T08:37:28.237

您可以在 Android Studio 中使用 APK Analyzer

[https://developer.android.com/studio/build/apk-analyzer.html](https://developer.android.com/studio/build/apk-analyzer.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-09-15T09:36:14.860

有一个工具[APK 方法计数](http://inloop.github.io/apk-method-count/)，用于计算您的 apk 中方法的数量。

还有一个服务[methodscount.com](http://www.methodscount.com/)来检查库的方法计数。该服务还具有[Android Studio/IntelliJ 插件](http://www.methodscount.com/plugins)，可解析您的 Android 库依赖项并将方法计数显示为方便的提示。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-19T20:15:33.960

尝试使用静态代码分析器；例如，[Source Monitor是免费的软件，并且有您要搜索的数量。](http://www.campwoodsw.com/sourcemonitor.html)

或者，如果您更喜欢不使用其他插件，请尝试这样做（仅限 Eclipse）：

*   按 Ctrl-H（搜索），然后选择“Java 搜索”选项卡（如果没有出现，请单击左下角的“自定义...”按钮）
*   在搜索框中输入 *
*   在“搜索”字段集中选择“方法”
*   在“限制到”字段集中选择“声明”
*   在“搜索范围”字段集中选择“来源”
*   在“范围”字段集中选择“工作区”
*   点击“搜索”

搜索完成后，您应该会在搜索视图中看到“XXXX 声明...”消息，这将是您的结果。

希望能帮助到你！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-19T20:15:55.420

您可以使用 JavaNCSS 来获取此类统计信息。它可以在这里找到：[http ://www.kclee.de/clemens/java/javancss/](http://www.kclee.de/clemens/java/javancss/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-14T12:46:55.880

你试过[https://github.com/KeepSafe/dexcount-gradle-plugin](https://github.com/KeepSafe/dexcount-gradle-plugin)吗？以图形和/或文本的方式向您显示每个包的方法数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-07-01T01:34:47.103

**在有或没有multidex**支持 的情况下查找和 Android 应用程序方法计数，请使用：

```
find | grep classes.dex | xargs -I {} hexdump -e '"%d {}\n"' -s 0x58 -n 4 {} 
```

# sql - ORDER BY 项目必须出现...但我没有 ORDER BY 子句

> ID：15509469
> 
> 赞同：0
> 
> 时间：2013-03-19T20:12:28.453
> 
> 标签：sql, sql-server, sql-server-2008, ms-access

我收到了有据可查的错误：

> 如果指定了 SELECT DISTINCT，则 ORDER BY 项目必须出现在选择列表中。

这是我的 SQL 语句：

```
INSERT INTO PropertyList
            (PropertyID, Initials)
SELECT DISTINCT P.PropertyID, "vSTEBCodes"
FROM Property AS P INNER JOIN ValiditySTEBCodes AS VC 
              ON P.ControlNumber=VC.ControlNumber 
```

如您所见，看不到 ORDER BY 语句。大概那里有一个隐含的 ORDER BY ，但我看不到它。

我正在针对链接到 SQL Server 2008 后端的 MS Access 中的链接表运行此语句。当我从完整版的 Access 2002 运行它时，它运行没有问题。如果我尝试从 Access 2000 运行时运行它，我会收到显示的错误。

我知道 Access 倾向于在将查询转发到 ODBC 源（尤其是多记录插入和更新）之前在后台重写查询。我想这可能是问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:47:29.797

从评论中编译，尝试：

```
INSERT INTO dbo.PropertyList(PropertyID, Initials)
  SELECT P.PropertyID, Initials = 'vSTEBCodes' -- alias and single quotes
  FROM dbo.Property AS P -- always use schema prefix
  INNER JOIN dbo.ValiditySTEBCodes AS VC 
  ON P.ControlNumber = VC.ControlNumber
  GROUP BY P.PropertyID  -- instead of DISTINCT
  ORDER BY P.PropertyID; -- maybe overrides Access stupidity 
```

# php - 在 MySQL 中使用带有数组的 WHERE 子句

> ID：15509470
> 
> 赞同：0
> 
> 时间：2013-03-19T20:12:29.117
> 
> 标签：php, mysql, mysqli

我在我的网站上有一个新闻提要查询，它选择登录用户与发布帖子的用户有关系（关注）的用户的所有帖子。听起来令人困惑，但这是我的查询：

```
SELECT DISTINCT * 
FROM    posts a 
        LEFT JOIN relations b
            ON a.user_id = b.user2
WHERE   b.user1 = $user_id AND 
    b.status IN (1) OR a.user_id = $user_id
ORDER BY a.post_id DESC LIMIT 300 
```

现在，如果用户设置了过滤器，则需要过滤帖子。参数设置在一个数组中，但我不确定如何在我的查询中设置一个条件来测试我创建的数组。如何构建我的 WHERE 子句？我正在测试 a.tag

包含参数的数组：$array

```
SELECT DISTINCT * 
FROM    posts a 
        LEFT JOIN relations b
            ON a.user_id = b.user2
WHERE   b.user1 = $user_id AND 
```

我需要帮助：

```
 a.tag IN ARRAY $array AND

    b.status IN (1) OR a.user_id = $user_id
ORDER BY a.post_id DESC LIMIT 300 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:15:05.987

您可以使用[`implode()`](http://php.net/implode)来连接值：

```
$escaped = array_map('mysqli_real_escape_string', $array);
$in = "IN ('" . implode("', '", $escaped) . "')"; 
```

然后，在查询中：

```
a.tag $in AND ... 
```

如果数组包含字符串，则必须对它们进行转义，这与您用于运行查询的驱动程序有关。

# node.js - Liferay/JSR 168 和 286 门户的替代方案？

> ID：15509471
> 
> 赞同：19
> 
> 时间：2013-03-19T20:12:29.990
> 
> 标签：node.js, liferay, portlet, user-experience, jsr286

我的团队一直在使用 Node.js、Twitter Boostrap、Mongo DB 和 Mule 为 ESB 编写仪表板应用程序。

最近，一位高管要求我们改变对像 Liferay 这样的 Portal/Portlet 容器的方法。

我们团队中的一些人有使用 Liferay 的经验，我们对此有相当负面的感受。处理整页刷新、portlet 生命周期、样式和主题问题以及有限的 DBMS 覆盖等问题是我们抱怨的首要问题。

我们看到我们的执行团队来自哪里。他们已决定要使仪表板可扩展且易于或更易于插入到其他组中。

有没有一种解决方案可以平衡用户对现代 Web 的期望与 IT 专业人员和管理人员的企业需求，他们关心使用 Liferay 构建和可扩展的应用程序？可插拔小部件在这里很重要。

Node 显然是我们的首选，Grails 之类的东西紧随其后。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T22:42:27.577

这个问题可能不太适合 StackOverflow 的格式，但我仍然可以提供一些想法。

如果您想坚持当前的平台，您需要准确地确定您的高管希望从迁移到新平台中获得哪些功能。您可以在当前平台中构建这些功能吗？与重写其他所有内容相比，这需要多少努力？在整个团队中学习一项新技能需要付出多大的努力？我确信您的团队可以有效地学习新技能，但这仍然需要努力，并且随着您的团队学习，会有成长的痛苦。如果您可以向您的主管表明您可以以相似或更少的努力获得相同的功能，并且您仍然可以拥有相似的总拥有成本，那么您可以提出继续使用当前平台的理由。

此外，我认为您低估了 Portlet 容器的功能。我主要使用 WebSphere Portal 工作，所以也许这就是为什么我认为您提到的大多数痛点对我来说并不难管理。仅仅因为您的容器需要特定的 DBMS 来管理自身并不意味着您不能使用单独的 DB 来满足您的自定义数据需求。JSR-286 引入了 serveResource 作为一种使 AJAX 更容易在 portlet 中实现的方法。在 WebSphere Portal（不了解 Liferay）中，在不重新加载页面的情况下更改整个页面内容可能是您列表中最困难的，但我承认。

现代不一定意味着尖端技术。如果您知道如何正确使用大型软件产品，它们仍然可以运行，就像任何其他工具一样。

# entity-framework-5 - 迁移到 Entity Framework 5 后的问题

> ID：15509476
> 
> 赞同：1
> 
> 时间：2013-03-19T20:12:47.670
> 
> 标签：entity-framework-5

我们刚刚将我们所有的实体转移到一个新的解决方案中，以便我们可以开始开发 EF5/MVC4/net4.5。但是，我遇到了一个让我非常困惑的问题，我一直在不懈地寻找可能的原因，但一无所获。

使用 Code-First，创建了迁移，没有问题地填充了数据库表。

问题是，无论我尝试查询什么实体，我都会收到以下错误： System.Data.EntityCommandCompilationException **{"The given key was not present in the dictionary."}**

这是堆栈跟踪：

```
 at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at System.Data.Mapping.ViewGeneration.Structures.MemberDomainMap.GetDomainInternal(MemberPath path)
   at System.Data.Mapping.ViewGeneration.QueryRewriting.FragmentQueryKB.CreateIsOfTypeCondition(MemberPath currentPath, IEnumerable`1 derivedTypes, MemberDomainMap domainMap)
   at System.Data.Mapping.ViewGeneration.QueryRewriting.FragmentQueryKB.CreateVariableConstraintsRecursion(EdmType edmType, MemberPath currentPath, MemberDomainMap domainMap, EdmItemCollection edmItemCollection)
   at System.Data.Mapping.ViewGeneration.QueryRewriting.FragmentQueryKB.CreateVariableConstraintsRecursion(EdmType edmType, MemberPath currentPath, MemberDomainMap domainMap, EdmItemCollection edmItemCollection)
   at System.Data.Mapping.ViewGeneration.ViewgenContext..ctor(ViewTarget viewTarget, EntitySetBase extent, IEnumerable`1 extentCells, CqlIdentifiers identifiers, ConfigViewGenerator config, MemberDomainMap queryDomainMap, MemberDomainMap updateDomainMap, StorageEntityContainerMapping entityContainerMapping)
   at System.Data.Mapping.ViewGeneration.ViewGenerator.CreateViewgenContext(EntitySetBase extent, ViewTarget viewTarget, CqlIdentifiers identifiers)
   at System.Data.Mapping.ViewGeneration.ViewGenerator.GenerateQueryViewForExtentAndType(StorageEntityContainerMapping entityContainerMapping, CqlIdentifiers identifiers, KeyToListMap`2 views, EntitySetBase entity, EntityTypeBase type, ViewGenMode mode)
   at System.Data.Mapping.ViewGeneration.ViewGenerator.GenerateQueryViewForSingleExtent(KeyToListMap`2 views, CqlIdentifiers identifiers, EntitySetBase entity, EntityTypeBase type, ViewGenMode mode)
   at System.Data.Mapping.ViewGeneration.ViewgenGatekeeper.GenerateTypeSpecificQueryView(StorageEntityContainerMapping containerMapping, ConfigViewGenerator config, EntitySetBase entity, EntityTypeBase type, Boolean includeSubtypes, Boolean& success)
   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.TryGenerateQueryViewOfType(EntityContainer entityContainer, EntitySetBase entity, EntityTypeBase type, Boolean includeSubtypes, GeneratedView& generatedView)
   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.SerializedGeneratedViewOfType(Pair`2 arg)
   at System.Data.Common.Utils.Memoizer`2.<>c__DisplayClass2.<Evaluate>b__0()
   at System.Data.Common.Utils.Memoizer`2.Result.GetValue()
   at System.Data.Common.Utils.Memoizer`2.Evaluate(TArg arg)
   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.TryGetGeneratedViewOfType(MetadataWorkspace workspace, EntitySetBase entity, EntityTypeBase type, Boolean includeSubtypes, GeneratedView& generatedView)
   at System.Data.Metadata.Edm.MetadataWorkspace.TryGetGeneratedViewOfType(EntitySetBase extent, EntityTypeBase type, Boolean includeSubtypes, GeneratedView& generatedView)
   at System.Data.Query.PlanCompiler.PreProcessor.ExpandView(Node node, ScanTableOp scanTableOp, IsOfOp& typeFilter)
   at System.Data.Query.PlanCompiler.PreProcessor.ProcessScanTable(Node scanTableNode, ScanTableOp scanTableOp, IsOfOp& typeFilter)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(FilterOp op, Node n)
   at System.Data.Query.InternalTrees.FilterOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitRelOpDefault(RelOp op, Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(ProjectOp op, Node n)
   at System.Data.Query.InternalTrees.ProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitRelOpDefault(RelOp op, Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(ProjectOp op, Node n)
   at System.Data.Query.InternalTrees.ProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfNode.VisitDefault(Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfNode.VisitPhysicalOpDefault(PhysicalOp op, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.Visit(PhysicalProjectOp op, Node n)
   at System.Data.Query.InternalTrees.PhysicalProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Process(Dictionary`2& tvfResultKeys)
   at System.Data.Query.PlanCompiler.PreProcessor.Process(PlanCompiler planCompilerState, StructuredTypeInfo& typeInfo, Dictionary`2& tvfResultKeys)
   at System.Data.Query.PlanCompiler.PlanCompiler.Compile(List`1& providerCommands, ColumnMap& resultColumnMap, Int32& columnCount, Set`1& entitySets)
   at System.Data.EntityClient.EntityCommandDefinition..ctor(DbProviderFactory storeProviderFactory, DbCommandTree commandTree) 
```

起初我以为这可能是我们对枚举或其他复杂类型的新实现，但由于即使是最简单的没有关系的实体也会抛出相同的错误，我不知所措。提前感谢您的任何意见。

# javascript - 拆分方法，然后连接

> ID：15509477
> 
> 赞同：1
> 
> 时间：2013-03-19T20:12:47.890
> 
> 标签：javascript, arrays, methods, split

我需要做的是让这个函数将输入的字符串的每个部分分开，然后在每个单词上加上 pig latin，这意味着它在每个单词的末尾添加了 ay。这是我到目前为止所拥有的：

```
function pigLatin(whatWeTitle) {

            var alertThis = " ";
            var splitArray = whatWeTitle.split(" ");

            for ( i = 0; i < splitArray.length; i++) {
                alertThis = makeSentenceCase(splitArray[i]) + " ";
                var newWord3 = splitArray.substring(1, whatWeTitle.length) + newWord + 'ay';
                alert(newWord3);

            }
        } 
```

现在，它只取字符串的第一个字母并将其添加到末尾。它不会将每个单词都更改为拉丁语，而是将整个短语。我想知道有人可以帮助我解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:14:47.937

您需要使用`[i]`来获取数组的项目：

```
 var word = splitArray[i];
 var newWord3 = word.substring(1,word.length) + word[0]  + 'ay'; 
```

最好的，如果你想用整个新句子结束，就是改变每个单词并在最后加入它们：

```
 var splitArray = whatWeTitle.split(" ");
  for ( i = 0; i < splitArray.length; i++) {
      var word = splitArray[i];
      splitArray[i] = word.substring(1,word.length) + word[0]  + 'ay';
  }
  var newSentence = splitArray.join(' ');
  alert(newSentence); 
```

如果你稍微测试一下，你会发现这个算法不喜欢你句子中的点或逗号。如果你想要更强大的东西，你需要一个正则表达式，例如：

```
var newSentence = whatWeTitle.replace(/[^\. ,]+/g, function(word){
   return word.slice(1) + word[0]  + 'ay';
});
alert(newSentence); 
```

这通过使用函数来转换每个单词来替换文本中的单词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:20:32.403

像这样的东西？

```
function pigLatin(whatWeTitle) {
    var alertThis = " ";
    var splitArray = whatWeTitle.split(" ");
    var finalString = "";
    for ( i = 0; i < splitArray.length; i++) {
        finalString += splitArray[i]+ "ay "; 
        }
    alert(finalString);
}

pigLatin("this is a test"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:27:01.000

您可能想要拆分第一个辅音值，然后将它们与“ay”一起附加。

我会使用正则表达式来完成此操作。这是一个显示示例[的 JSFiddle 。](http://jsfiddle.net/6vswR/4/)

第一部分是拆分单词

```
var words = text.split(" "); 
```

下一部分是 piglatinify™ 每个单词

```
words = words.map(function(word){ return pigLatinifyWord(word);}); 
```

这是 piglatinify™ 功能

```
function pigLatinifyWord(word){

    var result;

    var specialMatches = word.match(/(\W|\D)+$/);

    var specialChars;
    if(specialMatches && specialMatches.length >= 0){
        var specialIndex = word.indexOf(specialMatches[0]);
        specialChars = word.slice(specialIndex);
        word = word.substr(0, specialIndex);
    }

    var i = word.search(/^[^aeiou]/);

    if(i >= 0){
        result = word.slice(i+1) + word.slice(0, i+1) + "ay";
    }
    else{
        result = word + "ay";
    }

    if(specialChars){
        result += specialChars;
    }

    return result;
} 
```

**更新** JSFiddle 示例现在包括对非单词非数字字符的处理

# html - 多个tinymce textarea

> ID：15509484
> 
> 赞同：14
> 
> 时间：2013-03-19T20:13:15.890
> 
> 标签：html, tinymce

我将 tinymce 用于动态生成至少 5 个文本的网页。不幸
的是，我使用的配置只适用于第一个。`textarea`

```
tinyMCE.init({
    height : "300",
    mode : "exact",
    elements : "content",
    theme : "simple",
    editor_selector : "mceEditor",
    ...

<textarea class="mceEditor" name="content" rows="15" cols="40">content</textarea> 
```

**在all** 中启用 tinymce 编辑的配置是什么`textarea`。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2014-01-04T01:27:39.313

如果您使用“精确”模式，则需要指定要转换为编辑器的元素的 ID。

```
function initMCEexact(e){
  tinyMCE.init({
    mode : "exact",
    elements : e,
    ...
  });
}
// add textarea element with id="content" to document
initMCEexact("content");
// add textarea element with id="content2" to document
initMCEexact("content2");
// add textarea element with id="content3" to document
initMCEexact("content3"); 
```

或者，您可以使用“textarea”模式，它将编辑器不加选择地应用于所有 textarea。

```
function initMCEall(){
  tinyMCE.init({
    mode : "textareas",
    ...
  });
}
// add all textarea elements to document
initMCEall(); 
```

请记住，如果您正在动态创建 textareas，则需要在创建元素*后*调用 tinyMCE.init() ，因为它们需要存在，tinyMCE 才能转换它们。

[这是有关模式的文档](http://www.tinymce.com/wiki.php/Configuration3x%3amode)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-11-18T17:24:49.597

对于 TinyMCE 4.0，您必须使用选择器或为每个所需的配置定义 tinymce.init 对象/方法（[https://www.tinymce.com/docs/get-started/multiple-editors/](https://www.tinymce.com/docs/get-started/multiple-editors/)）。

例如，这是一个有 3 个编辑器的页面：

```
<!DOCTYPE html>
<html>
<head>
  <script src="http://cdn.tinymce.com/4/tinymce.min.js"></script>
  <script type="text/javascript">
  tinymce.init({
    selector: '#myeditable-h1',
    toolbar: 'undo redo'
  });
  tinymce.init({
    selector: '.standard-editor'
  });
  </script>
</head>

<body>
  <form method="post">
    <h1 id="myeditable-h1">This Title Can Be Edited If You Click Here</h1>
  </form>

  <form method="post">
    <div id="myeditable-div1" class="standard-editor">
      <p>This section1 of content can be edited...</p>
    </div>

    <div id="myeditable-div2" class="standard-editor">
      <p>This section2 of content can be edited...</p>
    </div>

  </form>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T09:19:35.533

您应该在配置中使用不同的模式。例如模式：“specific_textareas”适用于具有在 editor_selector 参数中指定的给定类的所有文本区域。

为了使用 mceEditor 类处理所有文本区域，您可以使用以下命令：

```
tinyMCE.init({
    mode : "specific_textareas",
    editor_selector : "mceEditor",
    ..... 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-12-13T06:25:03.407

在选择器中使用类我有两个或多个文本区域，我想用小 int 初始化那些

```
<textarea class="mytextarea"></textarea>
<textarea class="mytextarea"></textarea>
.
.
. 
```

在初始化 tinyint 代码中：

```
tinymce.init({
    selector: 'textarea.mytextarea',
    plugins : 'advlist autolink link lists preview table code pagebreak',
    .
    .
    . 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-04-15T15:18:02.497

根据[tinymce.com/wiki.php/Configuration:selector](http://www.tinymce.com/wiki.php/Configuration:selector)，选择器是选择哪些元素应该是可编辑的推荐方式。

对于所有 textarea 元素，根据要求：

```
selector: "textarea", 
```

或者更优雅地，只有那些带有特定 CSS 标签的元素：

```
selector: "textarea.editme",

<textarea class="editme"> 
```

# linux - 编译 SASS/Compass 服务器端

> ID：15509491
> 
> 赞同：1
> 
> 时间：2013-03-19T20:13:47.643
> 
> 标签：linux, sass, compass-sass

在 Linux 上编译 SASS/Compass 文件服务器端有哪些选择（如果有）？

我们在 Git 上拥有整个代码库。我们将 Compass/SASS 用于所有 CSS 工作，我认为没有理由跟踪编译文件。我们对编译后的 CSS 抛出合并错误感到头疼，因为它都在一行上。

编译 Compass/SASS 服务器端是一个可行的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:38:45.853

我们的部署脚本会将 sass 文件编译为 CSS，然后部署到生产服务器（但当然不会在 git 中跟踪已编译的文件，因为这会导致废话）...

不确定您使用什么堆栈来部署，但最好先编译，然后再部署，而不是让每个页面请求都尝试即时编译文件。

# d3.js - topojson.js:187：未捕获的类型错误：无法读取未定义的属性“类型”

> ID：15509493
> 
> 赞同：4
> 
> 时间：2013-03-19T20:13:49.720
> 
> 标签：d3.js

我试图用 D3 和 TopoJSON 为荷兰制作地图，包括各省。这是代码：

```
<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <title>D3 Test</title>
    <script type="text/javascript" src="http://localhost/webserver/d3/d3.js"></script>
    <script type="text/javascript" src="http://localhost/webserver/topojson/topojson.js"></script>
        <style type="text/css">

            div.bar {
                display: inline-block;
                width: 20px;
                height: 75px;
                background-color: teal;
                margin-right: 2px;
            }
            .pumpkin {
                fill: rgba(128, 0, 128, 0.75);
                stroke: yellow;
                stroke-width: 5;
            }
            .apple {
                fill: rgba(0, 255, 0, 0.55);
                stroke: green;
                stroke-width: 15;
            }
            .orange {
                fill: rgba(255, 255, 0, 0.55);
                stroke: orange;
                stroke-width: 10;
            }
            .subunit    { fill: #cdc; }
            .subunit-label  {
                fill: #777;
                fill-opacity: .25;
                font-size:  30px;
                font-weight: 300;
                text-anchor: middle;}

            .provincie  {fill: none; }
            .Utrecht    {fill: #ddd; }
            .Zuid-Holland   {fill: #dde; }
            .Noord-Holland  {fill: #dee; }
            .Drenthe    {fill: #aae; }
            .Gelderland     {fill: #eee; }
            .Friesland  {fill: #ddc; }
            .Groningen  {fill: #dcc; }
            .Limburg    {fill: #ccc; }
            .Noord-Brabant  {fill: #ddb; }
            .Overijssel     {fill: #dbb; }
            .Zeeland    {fill: #bbb; }
        </style>    
    </head>
    <body>
    <script type="text/javascript">

    var width = 960, height = 860;

    var projection = d3.geo.albers()
        .center([6, 49.40])
        .rotate([0, -1.9])
        .parallels([50, 60])
        .scale(11000)
        .translate([width / 2, height / 2]);

    var path = d3.geo.path()
        .projection(projection);

    var svg = d3.select("body").append("svg")
        .attr("width", width) 
        .attr("height", height);

    d3.json("http://localhost/webserver/data/nl.json", function(error, nl) {
        svg.selectAll(".subunit")
        .data(topojson.object(nl, nl.objects.subunits).geometries)
            .enter().append("path")
            .attr("class", function(d) { return "subunit " + d.id; })
        .attr("d", path);

        svg.selectAll(".subunit-label")
        .data(topojson.object(nl, nl.objects.subunits).geometries)
        .enter().append("text")
        .attr("x", -20)
        .attr("y", -50)
        .attr("class", function(d) { return "subunit-label " + d.id; })
        .attr("transform", function(d) { return "translate(" + path.centroid(d) + ")"; })
        .attr("dy", ".35em")
        .text(function(d) { return d.properties.name; });

        svg.selectAll(".provincie")
        .data(topojson.object(nl, nl.objects.provincies).geometries)
        .enter().append("path")
            .attr("class", function(d) { return "provincie " + d.properties.name; })
        .attr("d", path);

        svg.append("path")
        .datum(topojson.object(nl, nl.objects.places))
        .attr("d", path)
            .attr("class", "place");

        svg.selectAll(".place-label")
        .data(topojson.object(nl, nl.objects.places).geometries)
        .enter().append("text")
        .attr("class", "place-label")
        .attr("transform", function(d) { return "translate(" + projection(d.coordinates) + ")"; })
        .attr("dy", ".35em").text(function(d) { return d.properties.name; });

        svg.selectAll(".place-label")
        .attr("x", function(d) { return d.coordinates[0] > -1 ? 10 : -10; })
            .style("text-anchor", function(d) { return d.coordinates[0] > -1 ? "start" : "end"; });
        }); 
    </script>
    </body>
</html> 
```

结果是荷兰的地图，但它不包含省份（带有颜色和边界）。

我收到以下错误：

未捕获的类型错误：无法读取未定义的 topojson.js:187 的属性“类型”

这是第 186 和 187 行：

函数几何（o）{

var t = o.type, g = t === "GeometryCollection" ? {类型：t，几何：o.geometries.map（几何）}

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T00:49:54.813

看起来您正在引用拓扑中不存在的对象。

您的 TopoJSON 文件是否可能使用“provinces”的英文拼写而不是荷兰语的“provincies”？如果是这样，则为`nl.objects.provincies`null，您需要`nl.objects.provinces`在代码中引用，或者编辑 TopoJSON 文件以改用荷兰语拼写“provincies”。

您能否发布 nl.json 的内容以便我们查看（例如，在 Dropbox 上）？

# ruby-on-rails - Hartl Ch 6 规范说明

> ID：15509495
> 
> 赞同：0
> 
> 时间：2013-03-19T20:13:52.550
> 
> 标签：ruby-on-rails, rspec

我正在阅读 Michael Hartl 的书。我在第 6.3.3 节。我了解我们正在努力实现的目标。但是，对我来说，其中两个规范似乎在测试同一件事：

来自 user_spec.rb：[http ://ruby.railstutorial.org/chapters/modeling-users#code-authenticate_spec](http://ruby.railstutorial.org/chapters/modeling-users#code-authenticate_spec)

```
describe "return value of authenticate method" do
    before { @user.save }
    let(:found_user) { User.find_by_email(@user.email) }

    describe "with valid password" do
      it { should == found_user.authenticate(@user.password) }
    end

    describe "with invalid password" do
      let(:user_for_invalid_password) { found_user.authenticate("invalid") }

      it { should_not == user_for_invalid_password }          #1
      specify { user_for_invalid_password.should be_false }   #2
    end
  end 
```

如果用户的密码不正确，规范 1 和 2 是否都测试数据库不应该验证用户？这些测试有何不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T04:40:28.390

规格 1 和 2 是相反的。

在第一个中，您将有效密码传递给 authenticate 方法，在这种情况下，该方法返回用户对象本身，然后使用“应该”将其与主题用户对象进行比较

在第二个中，您传递了一个无效的密码来进行身份验证，然后它只返回 false，它“不应该”等于主题用户对象。

希望有帮助。

# c++ - 带有 lambda 的 FizzBu zz.cpp？

> ID：15509499
> 
> 赞同：5
> 
> 时间：2013-03-19T20:14:00.373
> 
> 标签：c++, c++11, lambda

我正在尝试使用 lambda 在 C++11 中编写 FizzBu​​zz，但我遇到了一个奇怪的编译器错误。

代码：

```
#include <iostream>
#include <string>
#include <sstream>
#include <list>
#include <algorithm>
using namespace std;

string fizzy(int n) {
  int a = n % 3, b = n % 5;

  if (a == 0 && b == 0) {
    return "FizzBuzz";
  }
  else if (a == 0) {
    return "Fizz";
  }
  else if (b == 0) {
    return "Buzz";
  }
  else {
    stringstream out;
    out << n;
    return out.str();
  }
}

void fizzbuzz() {
  string strings[100];
  list<int> range(0, 100);

  for_each(range.begin(), range.end(), [=](int i) {
      strings[i] = fizzy(i);
    });

  for_each(range.begin(), range.end(), [=](int i) {
      cout << strings[i] << endl;
    });
}

int main() { fizzbuzz(); } 
```

痕迹：

```
$ make
g++ -std=c++0x -o fizzy fizzy.cpp
fizzy.cpp: In lambda function:
fizzy.cpp:32:27: error: passing 'const std::string' as 'this' argument of 'std::basic_string<_CharT,
 _Traits, _Alloc>& std::basic_string<_CharT, _Traits, _Alloc>::operator=(std::basic_string<_CharT, _
Traits, _Alloc>&&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<ch
ar>, std::basic_string<_CharT, _Traits, _Alloc> = std::basic_string<char>]' discards qualifiers
make: *** [fizzy] Error 1 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-19T20:17:21.543

您应该**通过引用捕获，**而不是在 lambda 中按值捕获：

```
for_each(range.begin(), range.end(), [&](int i) {
//                                    ^
    strings[i] = fizzy(i);
    }); 
```

这也恰好解决了这个问题——生成的 lambda 闭包的调用运算符`const`默认标记为。

* * *

**笔记：**

进行此编译的另一种方法是使用`mutable`关键字，如下面的代码片段所示：

```
for_each(range.begin(), range.end(), [=](int i) mutable {
//                                              ^^^^^^^
    strings[i] = fizzy(i);
    }); 
```

`mutable`关键字的作用是在`const`生成的 lambda 闭包的调用运算符中删除。

但是，我相信您确实*不*希望这样：为什么要修改数组中的字符串，而当函数返回时您会忘记呢？

通过引用捕获将解决您的问题。

* * *

**更新：**

正如 Daniel Frey 在评论中指出的那样，这条指令：

```
list<int> range(0, 100); 
```

将创建一个大小为零的列表，其元素（其*零*元素）全部用值 100 初始化。可能不是您想要的。您可能希望将其更改为以下内容（`std::iota`仅当您使用 C++11 时才可用，否则您必须展开自己的分配循环）：

```
#include <algorithm>

list<int> range(100); // Creates a list of 100 elements
iota(begin(range), end(range), 0); // Assigns value 0..99 to those elements 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:18:49.840

此更改应修复它，因此您可以通过引用捕获：

```
for_each(range.begin(), range.end(), [&strings](int i) {
  strings[i] = fizzy(i);
}); 
```

同样正如 Daniel 和 Andy 指出的那样，您的初始化`range`可能不是您所期望的，因为它创建了一个`zero`大小合适的列表：

```
list<int> range(0, 100); 
```

# file - 使用 Servlet 返回多个项目

> ID：15509501
> 
> 赞同：0
> 
> 时间：2013-03-19T20:14:03.943
> 
> 标签：file, servlets, download

美好的一天，我正在开发一个 Servlet，它必须返回一个 PDF 文件和用于处理该文件的消息日志。

到目前为止，我正在传递一个布尔值，我评估并返回日志或文件，具体取决于用户选择，如下所示：

```
 //If user Checked the Download PDF
        if (isDownload) {
            byte[] oContent = lel;
            response.setContentType("application/pdf");
            response.addHeader("Content-disposition", "attachment;filename=test.pdf");
            out = response.getOutputStream();
            out.write(oContent);
        } //If user Unchecked Download PDF and only wants to see logs
        else {
            System.out.println("idCompany: "+company);
            System.out.println("code: "+code);
            System.out.println("date: "+dateValid);
            System.out.println("account: "+acct);
            System.out.println("documentType: "+type);

            String result = readFile("/home/gianksp/Desktop/Documentos/Logs/log.txt");
            System.setOut(System.out);

            // Get the printwriter object from response to write the required json object to the output stream      
            PrintWriter outl = response.getWriter();
            // Assuming your json object is **jsonObject**, perform the following, it will return your json object  
            outl.print(result);
            outl.flush();
        } 
```

有没有一种有效的方法可以同时退回这两个项目？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T06:44:48.280

HTTP 协议不允许您为每个 HTTP 请求发送多个 HTTP 响应。考虑到这一限制，您可以考虑以下替代方案：

1.  让客户端触发两个 HTTP 请求，例如通过指定`onclick`事件处理程序，或者，如果您在第一个响应中返回 HTML 页面，您可以在`window.load`或上触发另一个请求`page.ready`；
2.  让您有机会选择他想下载的内容并相应地在 servlet 中执行：如果他选择 PDF - 返回 PDF；如果他选择了文本 - 返回文本，如果他同时选择了两者 - 将它们打包并返回。

请注意，第一个变体既笨拙又不友好，就我而言，应该不惜一切代价避免。用户控制他得到什么的页面是一个更好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:18:48.597

您可以将它们包装在 DTO 对象中或将它们放在会话中以从 JSP 中引用。

# xml - XML Schema 为多个子元素添加唯一 ID

> ID：15509504
> 
> 赞同：2
> 
> 时间：2013-03-19T20:14:14.663
> 
> 标签：xml, validation, schema, unique

我有一个存储电影及其演员的 XML 文件。有 2 个电影元素（+ 他们的 movieID 属性），每个元素包含 2 个 actorID。每个actorID 还包含`known_for/movies/movie`一个movieID。

我已经设法使“主要”movieID 是唯一的，并且 actorID 在该movieID 中是唯一的。但是，我还想让`known_for/movies/movie`元素内部的 movieID 在其相应的 actorID 中是唯一的。我有点困惑，我需要在哪里为

```
known_for/movies/movie  movieID 
```

它可能必须在里面的某个地方`<xs:element name="movies`，我只是不太确定到底在哪里。

这是我的 XML 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<movies
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:noNamespaceSchemaLocation="test.xsd">

<movie movieID="1">
    <title>Movie 1</title>
    <cast>
        <actors>
            <actor actorID="1"> 
                <name>Jack</name>
                <known_for>
                    <movies>
                        <movie movieID="1">Movie 1</movie>
                        <movie movieID="2">Movie 2</movie>
                        <movie movieID="3">Movie 3</movie>
                    </movies>
                </known_for>
            </actor>
            <actor actorID="2">
                <name>James</name>
                <known_for>
                    <movies>
                        <movie movieID="1">Movie 1</movie>
                        <movie movieID="2">Movie 2</movie>
                        <movie movieID="3">Movie 3</movie>
                    </movies>
                </known_for>
            </actor>
        </actors>   
    </cast>
</movie>

<movie movieID="2">
    <title>Movie 2</title>
    <cast>
        <actors>
            <actor actorID="1"> 
                <name>Jack</name>
                <known_for>
                    <movies>
                        <movie movieID="1">Movie 1</movie>
                        <movie movieID="2">Movie 2</movie>
                        <movie movieID="3">Movie 3</movie>
                    </movies>
                </known_for>
            </actor>
            <actor actorID="2">
                <name>James</name>
                <known_for>
                    <movies>
                        <movie movieID="1">Movie 1</movie>
                        <movie movieID="2">Movie 2</movie>
                        <movie movieID="3">Movie 3</movie>
                    </movies>
                </known_for>
            </actor>
        </actors>   
    </cast>
</movie>
</movies> 
```

这是我的架构

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"  
    elementFormDefault="qualified" 
    attributeFormDefault="unqualified">

    <xs:element name="movies">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="movie" type="movieType" maxOccurs="unbounded">
                    <xs:unique name="unique_actorID">
                        <xs:selector xpath="cast/actors/actor"/>
                        <xs:field xpath="@actorID"/>
                    </xs:unique>
                </xs:element>
            </xs:sequence>
        </xs:complexType>
        <xs:unique name="unique_movieID">
            <xs:selector xpath="movie"/>
            <xs:field xpath="@movieID"/>
        </xs:unique>
    </xs:element>

    <xs:complexType name="movieType">
        <xs:sequence>
            <xs:element name="title" type="xs:string"/>
            <xs:element name="cast" type="castType"/>
        </xs:sequence>
        <xs:attribute name="movieID" type="xs:integer" use="required"/>
    </xs:complexType>

    <xs:complexType name="castType">
        <xs:sequence>
            <xs:element name="actors" type="actorsAll">
            </xs:element>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="actorsAll">
        <xs:sequence>
            <xs:element name="actor" type="actorType" maxOccurs="unbounded"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="actorType">
        <xs:sequence>
            <xs:element name="name" type="xs:string"/>
            <xs:element name="known_for" type="known_forGroup" minOccurs="0"/>
        </xs:sequence>
        <xs:attribute name="actorID" type="xs:integer" use="required"/>
    </xs:complexType>

    <xs:complexType name="known_forGroup">
        <xs:sequence>
            <xs:element name="movies" type="known_forType"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="known_forType">
        <xs:sequence>
            <xs:element name="movie" type="known_forMovies" maxOccurs="unbounded">
            </xs:element>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="known_forMovies">
        <xs:simpleContent>
            <xs:extension base="xs:string">
                <xs:attribute name="movieID" type="xs:integer"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>

</xs:schema> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T20:27:09.807

我已通过向位于“actorType”内的“known_for”元素添加唯一 ID 来解决此问题

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"  
    elementFormDefault="qualified" 
    attributeFormDefault="unqualified">

    <xs:element name="movies">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="movie" type="movieType" maxOccurs="unbounded">
                    <xs:unique name="unique_actorID">
                    <xs:selector xpath="cast/actors/actor"/>
                    <xs:field xpath="@actorID"/>
                </xs:unique>
            </xs:element>
        </xs:sequence>
    </xs:complexType>
    <xs:unique name="unique_movieID">
        <xs:selector xpath="movie"/>
        <xs:field xpath="@movieID"/>
    </xs:unique>
</xs:element>

<xs:complexType name="movieType">
    <xs:sequence>
        <xs:element name="title" type="xs:string"/>
        <xs:element name="cast" type="castType"/>
    </xs:sequence>
    <xs:attribute name="movieID" type="xs:integer" use="required"/>
</xs:complexType>

<xs:complexType name="castType">
    <xs:sequence>
        <xs:element name="actors" type="actorsAll">
        </xs:element>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="actorsAll">
    <xs:sequence>
        <xs:element name="actor" type="actorType" maxOccurs="unbounded"/>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="actorType">
    <xs:sequence>
        <xs:element name="name" type="xs:string"/>
        <xs:element name="known_for" type="known_forGroup" minOccurs="0">
            <xs:unique name="unique_known_for_movieID">
                <xs:selector xpath="movies/movie"/>
                <xs:field xpath="@movieID"/>
            </xs:unique>
        </xs:element>
    </xs:sequence>
    <xs:attribute name="actorID" type="xs:integer" use="required"/>
</xs:complexType>

<xs:complexType name="known_forGroup">
    <xs:sequence>
        <xs:element name="movies" type="known_forType"/>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="known_forType">
    <xs:sequence>
        <xs:element name="movie" type="known_forMovies" maxOccurs="unbounded">
        </xs:element>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="known_forMovies">
    <xs:simpleContent>
        <xs:extension base="xs:string">
            <xs:attribute name="movieID" type="xs:integer"/>
        </xs:extension>
    </xs:simpleContent>
</xs:complexType>

</xs:schema> 
```

# javascript - 将一个 javascript 嵌套对象数据结构转换为嵌套数组

> ID：15509505
> 
> 赞同：5
> 
> 时间：2013-03-19T20:14:14.747
> 
> 标签：javascript, jquery, json, object, loops

我正在尝试在 Javascript 对象文字中转换 JSON 字符串。我认为有一些循环是可能的，但我无法完成。目标结构如下所示，“chartData”。

小提琴可以在这里找到：http: [//jsbin.com/ajemih/13/edit](http://jsbin.com/ajemih/13/edit)

这是 JSON 数据：

```
{
   "1b":{
      "allLoad":"130",
      "loadMovement":"111",
      "allMovement":"111"
   },
   "1a":{
      "allLoad":"910",
      "loadMovement":"671",
      "allMovement":"280"
   },
   "systemLoad":"963"
} 
```

转换后应该是这样的：

```
chartData = [[['loadMovement', 111], 
              ['allMovement', 120], 
              ['allLoad', 130]], 
             [['Load+Move', 671], 
              ['allMovement', 280], 
              ['allLoad', 910]]]; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-19T20:25:11.313

我认为这会起作用：

工作演示：http: [//jsfiddle.net/jfriend00/YmjDR/](http://jsfiddle.net/jfriend00/YmjDR/)

```
var data = {
   "1b":{
      "allLoad":"130",
      "loadMovement":"111",
      "allMovement":"111"
   },
   "1a":{
      "allLoad":"910",
      "loadMovement":"671",
      "allMovement":"280"
   },
   "systemLoad":"963"
};

var chartData = [];

for (var i in data) {
    var item = data[i];
    var outer = [];
    // skip over items in the outer object that aren't nested objects themselves
    if (typeof item === "object") {
        for (var j in item) {
            var temp = [];
            temp.push(j);
            temp.push(item[j]);
            outer.push(temp);
        }
    }
    if (outer.length) {
        chartData.push(outer);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-19T20:23:49.130

你可以这样做：

```
var chartData = []

for(var key in data) {        
    var properties = data[key];

    if(typeof properties === "object") {
       var array = [];

       for(var propKey in properties) {
           array.push([propKey, properties[propKey]])
       }

       chartData.push(array);
    }             
} 
```

看看[小提琴](http://jsfiddle.net/Aeuv5/1/)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-19T20:25:24.817

您需要手动映射数据。那实际上是一项更加勤奋但常规的工作。

```
var jsonData = 'your json string';

Object.keys( jsonData ).map(function( key ) {
    if( typeof jsonData[ key ] === 'object' ) {
        return Object.keys( jsonData[ key ] ).sort(function( a, b ) {
            return +jsonData[ key ][ a ] - +jsonData[ key ][ b ];
        }).map(function( name ) {
            return [ name, jsonData[ key ][ name ] ];
        });
    }
}).filter( Boolean ); 
```

上面的代码将按其数值对每个组进行排序，然后以所需的样式映射一个新数组。由于`.map()`可能返回`undefined`非对象元素的值，因此我们需要在之前或之后过滤掉这些值。

见[http://jsfiddle.net/WjZB2/2/](http://jsfiddle.net/WjZB2/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-19T06:38:52.373

我有类似的问题。我的目标是将字符串列表转换为[http://ivantage.github.io/angular-ivh-treeview/的有效格式](http://ivantage.github.io/angular-ivh-treeview/)

这是我的出发点：

```
[
  "A\\A1\\Test1",
  "A\\A1\\Test2",
  "A\\A2\\Test3",
  "B\\Test4",
  "B\\Test5",
  "B\\B1\\Test6",
  "B\\B1\\Test7",
  "B\\B1\\Test8",
  "C\\C1\\C1a\\Test9",
  "C\\C1\\C1b\\Test10",
  "C\\C2\\C2a\\Test11",
  "C\\C2\\C2a\\Test12",
  "C\\C2\\C2a\\Test13",
  "C\\C3\\Test14",
  "C\\Test15",
  "C\\Test16"
] 
```

我需要以下格式：

```
[
  {
    "label": "Selected Tests",
    "children": [
      {
        "label": "A",
        "children": [
          {
            "label": "A1",
            "children": [
              {
                "label": "Test1",
                "value": true
              },
              {
                "label": "Test2",
                "value": true
              }
            ]
          },
          {
            "label": "A2",
            "children": [
              {
                "label": "Test3",
                "value": true
              }
            ]
          }
        ]
      }
    ]
  }
] 
```

请参阅我的解决方案[https://jsfiddle.net/ydt3gewn/](https://jsfiddle.net/ydt3gewn/)

# xamarin.ios - MonoTouch 对话框中 Section HeaderView 元素的定位

> ID：15509508
> 
> 赞同：0
> 
> 时间：2013-03-19T20:14:26.107
> 
> 标签：xamarin.ios, monotouch.dialog

我正在尝试自定义 MonoTouch 对话框中部分元素标题中文本的位置。我阅读了您应该如何创建自己的 UILabel 来创建样式文本，然后将其分配给 Section 对象的 HeaderView 。那部分效果很好。

我现在面临的问题是：**如何获得与默认无样式 Section 元素中使用的偏移量相似的文本偏移量**（参见附图中的比较）。无论我做什么，我似乎都找不到将“样式化部分”文本从屏幕左边缘移开的方法。我尝试更改 RectangleF 声明中指定的 x 坐标，但是在呈现视图时，我指定的任何内容似乎都被忽略了。

这是屏幕截图的支持代码：

```
Root = new RootElement ("Login2Screen");
var labelHeader = new UILabel();
labelHeader = new UILabel(new RectangleF(0, 0, 320, 48));
labelHeader.Text = "Styled 
labelHeader.TextColor = UIColor.Blue;
labelHeader.BackgroundColor = UIColor.Clear;

var styledSection = new Section(labelHeader);
styledSection.Add(new EntryElement("Username", string.Empty, string.Empty));
styledSection.Add(new EntryElement("Password", string.Empty, string.Empty));
Root.Add(styledSection);

var defaultStyleSection = new Section("Default Section");
Root.Add (defaultStyleSection); 
```

![在此处输入图像描述](../Images/bbba5944415192eb041458821067b537.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T23:03:05.613

将 labelHeader 添加到 UIView 中，然后将 UILabel 的 x 坐标设置为 10。

```
var viewLabelHeader = new UIView(new RectangleF(0, 0, 320, 48));
var labelHeader = new UILabel(new RectangleF(10, 0, 320, 48));
labelHeader.Text = "Styled section";
labelHeader.TextColor = UIColor.Blue;
labelHeader.BackgroundColor = UIColor.Clear;
viewLabelHeader.AddSubview (labelHeader);

var styledSection = new Section(viewLabelHeader); 
```

结果：

![在此处输入图像描述](../Images/92e959f798004ce92f8fccc8f5c745e2.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:21:50.507

尚未阅读有关元素中文本位置的任何内容`Section`，但是

```
labelHeader = new UILabel(new RectangleF(0, 0, 320, 48)); 
```

你把它定位在0,0？如果你让它 10,0 它应该移动。即移动x位置到10

```
labelHeader = new UILabel(new RectangleF(10, 0, 320, 48)); 
```

# haskell - Haskell 学院的代码共享

> ID：15509509
> 
> 赞同：3
> 
> 时间：2013-03-19T20:14:35.530
> 
> 标签：haskell

[我浏览了有关Haskell School of Haskell](https://www.fpcomplete.com/)的教程，也许我错过了它，但我没有看到如何在活动的 Haskell 元素之间共享代码？

例如，在下面`a`的两个其他活动 Haskell 元素之间共享。

```
``` active haskell shared
a = 2
```

``` active haskell
mian = print $ "a: " ++ show a
```

``` active haskell
b = 3
mian = print $ "a*b: " ++ show (a*b)
``` 
```

这将允许作者向类似 ghci 的会话添加注释，而无需大量重复代码。

BlogLiterately [-diagrams](http://hackage.haskell.org/package/BlogLiterately-diagrams)包提供了您可以在其[hackage 页面](http://hackage.haskell.org/package/BlogLiterately-diagrams)上的示例中看到的功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T03:16:28.300

您没有错过任何内容：该功能目前不存在。我们计划在不久的将来添加它。

# java - eclipse 无法解析 R.id/layout

> ID：15509510
> 
> 赞同：1
> 
> 时间：2013-03-19T20:14:36.903
> 
> 标签：java, android, eclipse

在我的日食中，值 R.id.[something] 和 R.layout.[something] 无法解析，但文件/ID 存在！

我已经多次清理项目，还尝试重命名文件/ID ...

**已解决：** 删除

```
import android.R 
```

然后它起作用了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:15:30.173

**编辑：**

删除您的 R.java 文件并清理一次，如果不起作用，请确保您的项目没有任何错误。签入问题（如果存在）

* * *

只需清理您的项目一次。

```
 Project-->clean..>select your prject. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T20:15:42.050

尝试在 Eclipse 中进行清理。如果这不起作用，请确保您的项目的 gen 文件夹包含在 Eclipse 项目的 Java 构建路径中，并且按路径顺序位于 src 文件夹之上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T08:02:43.750

1.  清理项目。
2.  确保没有任何不允许构建项目的错误。
3.  强制项目构建。

# ajax - codeigniter - 使用输入数据在同一表单上显示数据库查询结果

> ID：15509514
> 
> 赞同：0
> 
> 时间：2013-03-19T20:14:50.640
> 
> 标签：ajax, codeigniter

我已经在网上搜寻了一段时间，试图找到一个对我有帮助的解决方案，但没有运气。

我有一个简单的销售表格，用户在其中从下拉列表中选择产品。在选择一个值时，我希望将输入框值传递给数据库查询，并将查询结果（价格）显示在表单上。如果可能的话，我希望结果填充一个输入框，以便销售人员可以根据需要进行调整。

我正在使用 codeigniter，这使得找到一个好的例子变得非常困难。

**控制器**

```
function new_blank_order_lines() 
  {
   $this->load->view('sales/new_blank_order_lines');
  } 
```

**模型**

```
 function get_sku_price($q){
    $this->db->select('ProductPrice');
    $this->db->where('ProductCode', $q);
    $query = $this->db->get('ProductList');
    if($query->num_rows > 0){
      foreach ($query->result_array() as $row){
        $row_set[] = htmlentities(stripslashes($row['ProductPrice'])); //build an array
      }
      $this->output->set_content_type('application/json')->set_output(json_encode($row_set));

    }
  } 
```

**看法**

```
<table>
  <tr><td>Product</td><td>Price</td></tr>
  <tr>
   <td><select name="product">
       <option="sku1">product 1</option>
       <option="sku2">product 2</option>
       <option="sku3">product 3</option>
   <select></td>
   <td><input type="text" id="price" name="price" /></td>
  </tr>
</table> 
```

我已经加载了 jquery 库，1.9.1。

我有自动完成功能，但语法不一样。

所以我想要的是，当我从`product`下拉列表中选择产品代码时，将值传递给模型，然后在输入框中显示查询结果（价格）`price`。

谁能提供一些关于如何做到这一点的见解，或者一个好的工作示例？

感谢一百万，这个社区真棒！

**法比奥**

控制器：

```
function new_blank_order_lines() 
  {
   $this->load->view('sales/new_order');
  } 
```

风景：

```
<script>
$("#product").change(function () {
    //get the value of the select when it changes
    var value = $("#product").val()

    //make an ajax request posting it to your controller
    $.post('<?=base_url("sales/get_sku_prices")?>', {data:value},function(result) {
      //change the input price with the returned value
      $('#price').value(result);
    });
});
</script>
  <table>
  <tr><td>Product</td><td>Price</td></tr>
  <tr>
   <td><select name="product" id="product">
       <option value="sku1">product 1</option>
       <option value="sku2">product 2</option>
       <option value="sku3">product 3</option>
   </select></td>
   <td><input type="text" id="price" name="price" /></td>
  </tr>
</table> 
```

控制器获取数据库数据：

```
 function get_sku_prices(){
    //check if is an ajax request
    if($this->input->is_ajax_request()){
        //checks if the variable data exists on the posted data
        if($this->input->post('data')){
            $this->load->model('Sales_model');
            //query in your model you should verify if the data passed is legit before querying
            $price = $this->your_model->get_sku_price($this->input->post('data', TRUE));

            echo $price;
        }
    }
} 
```

模型：

```
 function get_sku_price($q){
    $this->db->select('ProductPrice');
    $this->db->where('ProductCode', $q);
    $query = $this->db->get('ProductList');
    if($query->num_rows > 0){
      foreach ($query->result_array() as $row){
        $row_set[] = htmlentities(stripslashes($row['ProductPrice'])); //build an array
      }
      $this->output->set_content_type('application/json')->set_output(json_encode($row_set));

    }
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:47:10.123

您的看法：

```
<table>
    <tr>
        <td>Product</td>
         <td>Price</td>
    </tr>
    <tr>
        <td>
            <select name="product" id="product">
                <option value="sku1">product 1</option>
                <option value="sku2">product 2</option>
                <option value="sku3">product 3</option>
            </select>
            </td>
        <td>
            <input type="text" id="price" name="price" />
        </td>
    </tr>
</table> 
```

javascript

```
<script>
  $("#product").change(function () {
    //get the value of the select when it changes
    var value = $("#product").val()

    //make an ajax request posting it to your controller
    $.post('<?=site_url("controller/function")?>', {data:value},function(result) {
      //change the input price with the returned value
      $('#price').value(result);
    });
  });
</script> 
```

控制器：

```
public function your_funtion(){
    //check if is an ajax request
    if($this->input->is_ajax_request()){
        //checks if the variable data exists on the posted data
        if($this->input->post('data')){
            $this->load_model('your_model')
            //query in your model you should verify if the data passed is legit before querying
            $price = $this->your_model->get_price($this->input->post('data', TRUE));

            echo $price;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:32:10.860

使用 jquery 的 ajax，[发布](http://api.jquery.com/jQuery.post/)或[获取](http://api.jquery.com/jQuery.get/)和更改事件..在这里使用发布

例子..

```
 $('select[name="product"]').change(function(){
      var val=$(this).val();
      $.post('path/to/controller',{data:val},function(result){
          $('#price').val(result.price);
      }, "json");
 }); 
```

控制器功能

```
$product=$this->input->post('data');  //this will give you the selected value of select
//make query to db in model..get price and
$price = ..//price that you got from db
echo json_encode(array('price'=> $price)); 
```

# c# - c#滚动条修改LargeChange onScroll not Value

> ID：15509515
> 
> 赞同：1
> 
> 时间：2013-03-19T20:14:52.350
> 
> 标签：c#, scrollbar

在滚动框拖动期间触发事件时，是否有保持滚动条保持在其当前位置（`myScrollBar.Value`）的方法？`Scroll`在拖动滚动框后释放滚动框后，我可以让它工作，但我试图在滚动它时让它**发生**。

```
// this example doesn't work, but it is what I am trying to do
private void myScrollBar_Scroll(object sender, ScrollEventArgs e)
{
   // as I scroll keep resetting NewValue back to 0 -
   // this makes the value 0 only after I release the scroll box
   e.NewValue = 0;
} 
```

任何关于如何解决这个问题的建议都会很棒。谢谢。

# asp.net - 如何将 mvc.net 添加到旧的 vb.net 站点

> ID：15509521
> 
> 赞同：1
> 
> 时间：2013-03-19T20:15:17.020
> 
> 标签：asp.net, asp.net-mvc, vb.net

这是我的第一个问题。我工作的公司使用一个相当大的旧 vb.net 站点。我们希望将 mvc.net 集成到该站点中。我一直在关注 Steven Sanderson 的一本书“Pro ASP.NET MVC 2 Framework”——将这两个系统合并在一起似乎并不复杂。

细分如下所示：

1.  更新构建文件 - 添加 GUID，以便 IDE 为 mvc 文件提供选项。
2.  为 mvc.net 添加程序集引用。
3.  启用路由。（我需要确保它仍然首先使用 vb.net 路由，然后是 mvc）
4.  合并 web.configs。（使用一个新的空白 mvc.net vb 项目，也是我从中获得 GUID 的地方）
5.  添加任何文件夹并开始使用 mvc。

作为参考，我们目前使用 .net 3.5，但我们的运营团队告诉我 4.0 应该没问题。

我遇到的问题是空白 mvc 项目中的 GUID 不起作用。当我将它们添加到旧项目时，我得到“此安装不支持项目类型”。错误。我对项目类型不是很熟悉，我不确定如何从这里开始。我尝试了几种组合都没有成功。

有谁知道如何获取或生成正确的 GUID 以使其正常工作？如果有人这样做了，还有其他我应该注意的陷阱吗？我已将项目复制到另一个分支，因此我可以自由地进行更改而不会影响其他任何内容。

编辑：这些是我们主站点项目的 GUID：{349c5851-65df-11da-9384-00065b846f21}；{F184B08F-C81C-45F6-A57F-5ABD9991F28F}

这些是来自新 mvc4 项目的 GUID（我对 MVC2-4 并不挑剔）{E3E379DF-F4C6-4180-9B81-6769533ABE47}；{349c5851-65df-11da-9384-00065b846f21}；{fae04ec0-301f-11d3-bf4b-00c04f79efbc}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T04:16:45.730

我建议您保留当前的代码库。

您可以在 ASP.Net MVC 中开始所有新的开发（新模块）。然后，您可以将这个新模块集成到您的应用程序中。这样，您可以将所有回归保留在受尊重的代码库中。

只有在会话的情况下，您才会遇到问题。如果您有 InProc 会话，那么分享起来会很困难。如果它已经是 OutProc 那就很容易了。

# ruby-on-rails - Rails +carrierwave 不创建条件版本

> ID：15509523
> 
> 赞同：0
> 
> 时间：2013-03-19T20:15:28.237
> 
> 标签：ruby-on-rails, ruby, carrierwave

我正在尝试在我的 Rails 应用程序中使用carrierwave 设置条件版本。[我已经实现了似乎与此处](https://github.com/jnicklas/carrierwave)提供的示例完全相同的内容。

除非我`is_ipod?`简单地返回，否则永远不会创建该版本`true`。下面的代码是我目前拥有但无法正常工作的代码。请注意我用来验证`image_type`属性是否正确设置的注释部分。

```
version :ipod_portrait_thumb, :if => :is_ipod? do

  process resize_to_fit: [150,200]

end

def is_ipod? image
  model.image_type == 'iPod Screenshot'

  #if (model.image_type == "iPod Screenshot")
  #if (model.image_type!=nil)
    #puts "+++++"+model.image_type
  #  if (model.image_type=="iPod Screenshot")
      #puts "+++++++ I AM HERE"
  #   return true
  #  end
  #end
end 
```

如果`is_ipod?`看起来像这样：

```
def is_ipod? image
  true
end 
```

该版本按预期创建。我错过了什么？谢谢！

**更新：**

我已将`is_ipod?`方法编辑为如下所示：

```
def is_ipod? image     
  puts (image.path || "") + ': ' + ((model.image_type||"") == 'iPod Screenshot').to_s
  model.image_type == 'iPod Screenshot'
end 
```

将其输出到控制台：

```
/public/uploads/tmp/20130325-1024-15906-5363/drawing.png: false
/public/uploads/tmp/20130325-1024-15906-5363/drawing.png: false
/public/uploads/app_image/image/59/drawing.png: true 
```

所以这个版本试图被创建三次，两次用于临时文件，一次用于最终文件。模型属性只为最终文件设置。这有关系吗？谁能告诉我这与这个例子有什么不同？

```
class MyUploader < CarrierWave::Uploader::Base

  version :monkey, :if => :is_monkey?

  protected

  def is_monkey? picture
    model.favorite_food == 'banana'
  end
end 
```

这是我的模型类，以防万一：

```
class AppImage < ActiveRecord::Base
  attr_accessible :app_id, :image, :image_type, :image_cache
  belongs_to :app

  mount_uploader :image, AppImageUploader

  validates :image_type, presence: true
  validates :image, presence: true
end 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-26T20:41:52.937

我遇到了类似的问题^，我尝试根据模型属性创建不同的尺寸。我的解决方案很简单：只需在保存后重新创建版本。

app/uploaders/project_item_picture_uploader.rb

```
class ProjectItemPictureUploader < CarrierWave::Uploader::Base

  ...

  version :preview do
    process dynamic_process: true
  end

  protected

  def dynamic_process(*args)
    resize_to_fill *(model.get_size) if model.persisted?
  end

end 
```

应用程序/模型/project_item.rb

```
class ProjectItem < ActiveRecord::Base
  mount_uploader :picture, ProjectItemPictureUploader
  validates_presence_of :picture

  def get_size
    double ? [168, 57] : [76, 57]
  end

  after_save :recreate_delayed_versions!
  def recreate_delayed_versions!
    picture.recreate_versions!
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T17:46:06.810

事实证明，这是因为该`AppImage`模型是另一个模型的子模型，并且正在以嵌套形式添加到此处。无论出于何种原因，子模型的属性都没有由载波处理版本的时间设置。

我已经通过向我的父模型添加载波附件来验证这一点`App`。处理`App`附件的版本时，会设置属性。

也许稍后我会更深入地尝试并更好地理解（我对 Rails 很陌生），但现在我正在通过没有条件版本来解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-19T08:49:40.500

我今晚有同样的问题，我正在做一些实验，最后我想通了，似乎当你第一次创建一个版本时（当你发布你的表单时），如果你有这行：

```
model.image_type == 'iPod Screenshot' 
```

这意味着您**必须**在表单中指定一个字段，`image_type`并且该字段的值应为“iPod Screenshot”

当您显示图像时，CarrierWave 会验证相同的内容，`article.image_url(:ipod_portrait_thumb)`这意味着您的数据库中应该有一个名为`image_type`“iPod Screenshot”的字段

所以如果你有这条线：

```
version :ipod_portrait_thumb, :if => :is_ipod? 
```

您是在告诉 CarrierWave 每次**创建或显示**记录时执行 ipod_portrait_thumb 函数

如果您的表单不包含`field image_type`带有值“iPod Screenshot”的情况，例如因为您在模型/控制器中设置它，方法是检查另一个字段以允许 CarrierWave 创建您的条件版本，所以很简单你可以做像这样的东西：

```
model.image_type == 'iPod Screenshot' || another_field_in_my_form_help_you_to_know_type_is_ipode == "something" # or just .present? rather than == "something" switch your case 
```

在这里，当 CarrierWave 第一次尝试创建版本时，它会检查这个 another_field_......，当您有一个显示您的记录（产品、文章....）的页面时，它会验证是否`model.image_type == 'iPod Screenshot'`已存储在您的数据库中

希望这对你有帮助:)

# ios - GKScores 存储到下一次连接？

> ID：15509529
> 
> 赞同：0
> 
> 时间：2013-03-19T20:15:38.453
> 
> 标签：ios, gamekit, leaderboard

在 Apple 的[GKLeaderboards](http://developer.apple.com/library/ios/#samplecode/GKLeaderboards/Introduction/Intro.html)示例代码中，它们展示了如何存储 GKScore 对象以供以后在发送失败时提交。但是，[向 Game Center 报告分数](https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/GameKit_Guide/LeaderBoards/LeaderBoards.html#//apple_ref/doc/uid/TP40008304-CH6-SW14)的文档说“如果由于某种原因由于网络错误而无法报告分数，Game Kit 会在网络可用时自动重新发送数据。”

这是否意味着不再需要 GKLeaderboards 中的重新发送基础设施？GameKit 是在哪个版本开始保存分数并将其重新发送到排行榜的？

我直到最近才使用 GameKit，所以我希望有人已经使用了一段时间并且可以确认它以节省我的一些测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T22:23:12.127

根据我的经验，我从来不需要实施 coeds 来重新发送连接断开时无法发送的分数！

所有数据都表明，通过自动重发，你我再也不用手动重发数据了！:)

那是一种解脱。

# ruby-on-rails - 问题将 Rails 2.3 升级到 3.2.11 - 类 `ActionController::Request' 的未定义方法 `normalize_parameters' (NameError)

> ID：15509534
> 
> 赞同：0
> 
> 时间：2013-03-19T20:15:58.277
> 
> 标签：ruby-on-rails

使用[rails_upgrade](https://github.com/rails/rails_upgrade)插件，我成功地将 2.3 应用程序升级到 3.0.6。我的目标是将该 2.3 应用程序升级到 3.2.11。使用相同的过程，我可以走得很远，但我陷入了这个 Active Support 错误。任何帮助，将不胜感激 -

```
/Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/activesupport-3.2.11/lib/active_support/core_ext/module/aliasing.rb:31:in `alias_method': undefined method `normalize_parameters' for class `ActionController::Request' (NameError)
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/activesupport-3.2.11/lib/active_support/core_ext/module/aliasing.rb:31:in `alias_method_chain'
from /Users/TravisKs/Sites/rabbitsferritsandgerbils.com/config/initializers/patch_for_1.9.2.rb:37:in `<class:Request>'
from /Users/TravisKs/Sites/rabbitsferritsandgerbils.com/config/initializers/patch_for_1.9.2.rb:31:in `<module:ActionController>'
from /Users/TravisKs/Sites/rabbitsferritsandgerbils.com/config/initializers/patch_for_1.9.2.rb:30:in `<top (required)>'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `block in load'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in `load_dependency'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/engine.rb:588:in `block (2 levels) in <class:Engine>'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/engine.rb:587:in `each'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/engine.rb:587:in `block in <class:Engine>'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `instance_exec'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `run'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/initializable.rb:55:in `block in run_initializers'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `each'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `run_initializers'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/application.rb:136:in `initialize!'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in `method_missing'
from /Users/TravisKs/Sites/rabbitsferritsandgerbils.com/config/environment.rb:5:in `<top (required)>'
from /Users/TravisKs/Sites/rabbitsferritsandgerbils.com/config.ru:3:in `require'
from /Users/TravisKs/Sites/rabbitsferritsandgerbils.com/config.ru:3:in `block in <main>'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize'
from /Users/TravisKs/Sites/rabbitsferritsandgerbils.com/config.ru:in `new'
from /Users/TravisKs/Sites/rabbitsferritsandgerbils.com/config.ru:in `<main>'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/rack-1.4.5/lib/rack/builder.rb:40:in `eval'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/rack-1.4.5/lib/rack/builder.rb:40:in `parse_file'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/rack-1.4.5/lib/rack/server.rb:200:in `app'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/commands/server.rb:46:in `app'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/rack-1.4.5/lib/rack/server.rb:304:in `wrapped_app'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/rack-1.4.5/lib/rack/server.rb:254:in `start'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/commands/server.rb:70:in `start'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/commands.rb:55:in `block in <top (required)>'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/commands.rb:50:in `tap'
from /Users/TravisKs/.rvm/gems/ruby-1.9.3-p392@rabbitsferritsandgerbils.com/gems/railties-3.2.11/lib/rails/commands.rb:50:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T19:03:19.060

删除 rabbitsferritsandgerbils.com/config/initializers/patch_for_1.9.2.rb 似乎解决了我的问题。我确实必须切换到 ruby​​ 1.9.3。

# jquery - jQuery .on 事件处理程序从锚元素“点击”不一致地触发

> ID：15509535
> 
> 赞同：1
> 
> 时间：2013-03-19T20:16:00.940
> 
> 标签：jquery, ajax, events

我最近开发了一个站点[http://www.bandwidthpool.com](http://www.bandwidthpool.com)，一个带宽竞标站点。我使用动态页面加载来获得更流畅的体验，但最近发现了一些问题。导航链接和按钮都是元素。很多次我注意到你必须点击链接/按钮两次，有时才能让它触发点击事件。似乎没有押韵或原因，我无法弄清楚这种行为背后的任何模式或推理。

我设置了一个测试页面来更好地说明这一点：

[http://www.bandwidthpool.com/_test/](http://www.bandwidthpool.com/_test/)

单击按钮，您会注意到有时您必须单击它几次才能触发事件。代码很简单...

## _Test.js 按钮事件处理程序

```
$(document)
.on('click', sel.testButton, function(e) {
    e.preventDefault();
    $(sel.testDisplay)
        .html($(this).html())
        .css('color', $(this).data('color'));
}); 
```

这些按钮只是列表中的锚元素：

它似乎在所有浏览器上都显示了这种行为。据我所知，'.on' 方法是附加事件处理程序的最新且可靠的方法......这是已知的错误吗？我正在使用 jQuery 1.7.1。感谢您的帮助，如果您需要更多信息，请告诉我。

## 完整的 _Test.js 代码

```
BWPool._Test = 
{
    handlers : [],                  // Container for event handlers       
    selectors : {
        testDisplay :  'div.test-display',
        testButton :   'div.test-buttons li a',
    },
    init : function() {
        var self = this; var sel = this.selectors        
        self.initHandlers();        
    },
    initHandlers : function() {
        var self = this; var sel = this.selectors        
        $(document)
        .on('click', sel.testButton, function(e) {
            e.preventDefault();
            $(sel.testDisplay)
                .html($(this).html())
                .css('color', $(this).data('color'));
        });
    },

    // Remove event handlers and timers
    destruct : function() {
        var self = this; var sel = self.selectors;         
        $.each(self.handlers, function(i, handler) {
            $(document).off(handler.event, handler.selector);    
        });        

    }      
};
$(function() {    BWPool._Test.init();    }) 
```

# regex - Sed中的正则表达式空格字符

> ID：15509536
> 
> 赞同：17
> 
> 时间：2013-03-19T20:16:04.820
> 
> 标签：regex, sed

我已经尝试了几乎所有东西（我猜）但没有任何效果。（操作系统：Ubuntu 12.04）

要匹配的表达式（从文本文件中删除）：

```
a c 4
a k 23
o s 1 
```

我尝试了什么：

```
's/[[a-z][:space:][a-z][:space:][0-9]]\{1,\}//gi'
's/.\s.\s[0-9]+//g'
's/[:alpha:][:space:][:alpha:][:space:][:digit:]+' 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-19T20:21:30.983

这应该匹配：

```
sed 's/[a-z][ ]*[a-z][ ]*[0-9]*//gi' 
```

你的第一次尝试错过了几个方括号，你不需要最外面的一个：

```
sed 's/[a-z][[:space:]][a-z][[:space:]][0-9]\{1,\}//gi' input 
```

您的第二个示例失败，因为您需要转义`+`，但它仍然只能在 gnu sed 中工作：

```
sed 's/.\s.\s[0-9]\+//g' input 
```

最后一个也有一些类似的问题：

```
sed 's/[[:alpha:]][[:space:]][[:alpha:]][[:space:]][[:digit:]]\+//' input 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T20:23:19.750

中间那个*很近*！由于我无法理解的原因，您必须逃避加号。我还将点“ `.`”替换为“”，`[a-z]`因此它只匹配字母。

```
sed 's/[a-z]\s[a-z]\s[0-9]\+//g' 
```

旧版本的奖励便携式版本`sed`（您好，Mac 用户！）。一些`sed`实现对“ `+`”很挑剔：

```
sed 's/[a-z]\s[a-z]\s[0-9][0-9]*//g' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T20:23:38.827

`[...]`定义一个字符类。`[a-z]`匹配从`a`到 的任何字符`z`。要匹配连续字符，您必须为每个字符使用一个类：`[a-z][[:space:]][a-z]`。

为了`+`具有特殊含义，您必须将其反斜杠：`[0-9]\+`.

命名字符类仅在字符类中起作用，即`[[:alpha:]][[:space:]]`.

# ruby-on-rails - ember-rails 和车把：一个视图不存在指定的模板名称，但所有其他视图都存在

> ID：15509537
> 
> 赞同：1
> 
> 时间：2013-03-19T20:16:06.170
> 
> 标签：ruby-on-rails, templates, ember.js, handlebars.js, ember-rails

我正在开发一个 ember-rails 应用程序，该应用程序通过 rails 管道预编译 Handlebars 资产。一切都通过 更新到最新版本`bundle update`。

当我们加载索引时，ember 数据不会呈现到列表中，尽管 (app/views/gigs/index.html.erb)：

```
<h1>Gigs</h1>

<script type="text/x-handlebars">
  {{ view App.ListGigsView }}
</script>

<script type="text/javascript">
  $(function() {
    App.gigsController.loadAll(<%= @gigs.to_json.html_safe %>);
  });
</script> 
```

因此，我检查了 ListGigsView，其中包含以下内容（app/assets/javascripts/app/views/gigs/list.js）：

```
App.ListGigsView = Ember.View.extend({
  templateName:    'app/templates/gigs/list',
  gigsBinding: 'App.gigsController',

  showNew: function() {
    this.set('isNewVisible', true);
  },

  hideNew: function() {
this.set('isNewVisible', false);
  },

 refreshListing: function() {
    App.gigsController.findAll()
  }

 }); 
```

似乎 templateName 指向很好（这在 new.js 中很相似）。尽管如此，浏览器控制台（Google Chrome 版本 25.0.1364.172）仍然返回以下内容：

`Uncaught Error: assertion failed: You specified the templateName app/templates/gigs/list for <App.ListGigsView:ember194>, but it did not exist.`

这是 app/assets/javascripts/app/templates/gigs/list.handlebars 中的文件：

```
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
  {{#each gigs}}
    {{view App.ShowGigView gigBinding="this"}}
  {{/each}}
 {{#if isNewVisible}}
    <tr>
      <td>*</td>
      <td>
        {{view App.NewGigView}}
      </td>
    </tr>
  {{/if}}
  </tbody>
 </table>
 <div class="commands">
  <a href="#" {{action "showNew"}}>New Gig</a>
  <a href="#" {{action "refreshListing"}}>Refresh Listing</a>
</div> 
```

为什么模板不渲染？`Ember.TEMPLATES`在控制台中运行会完整返回所有其他视图模板链接：

```
> Ember.TEMPLATES
=> Object {app/templates/gigs/edit: function, app/templates/gigs/event: function, app/templates/gigs/show: function, application: function} 
```

但不是为`list`. 为什么那个模板擅离职守？

*   作为参考，我根据浏览器控制台运行以下命令：

    Ember.VERSION：1.0.0-rc.1 ember.js:339 Handlebars.VERSION：1.0.0-rc.3 ember.js:339 jQuery.VERSION：1.9.1

-编辑：我刚刚发现在 index.html.erb 中包含对事件视图的 Handlebars 引用也会导致该模板消失：

```
<h1>Gigs</h1>

<script type="text/x-handlebars">
  {{ view App.ListGigsView }}
</script>

<script type="text/x-handlebars">
  {{ view App.EventView }}
</script>

<script type="text/javascript">
  $(function() {
    App.gigsController.loadAll(<%= @gigs.to_json.html_safe %>);
  });
</script> 
```

为什么会这样？我该如何避免呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T16:22:36.570

`app/templates/`默认情况下从模板名称中删除。试试`gigs/list`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T14:59:15.070

对我来说，它在剥离时起作用`templates`，例如`app/gigs/list`。

# web-services - Weblogic WebService 客户端依赖项

> ID：15509539
> 
> 赞同：0
> 
> 时间：2013-03-19T20:16:16.813
> 
> 标签：web-services, dependencies, weblogic-10.x, jdeveloper, jax-rpc

我想问哪个是功能性ws客户端到经过身份验证的weblogic JAX-RPC所需的正确jar文件。
情况：
我在 Jdeveloper 和 OEPE 上创建了相同的 WS 客户端。当我在 IDE 中运行时，我的客户端只能在 Jdeveloper 上运行。然后，当我运行该 jar 时，我从 Jdeveloper 生成了一个 Jar 文件，并从 OEPE ocurrs 生成了相同的错误。
我想这是因为缺少一些库。我真的需要帮助！
在将许多库放在类路径上之后，这是错误的：

> “线程“主”javax.xml.rpc.ServiceException 中的异常：无法解析 WSDL htp://url?WSDL weblogic.wsee.wsdl.WsdlException：由于 -- java.net.ConnectException，无法从 url 读取 wsdl 文件：连接被拒绝：在 weblogic.wsee.jaxrpc.ServiceImpl.loadWsdlDefinition(ServiceImpl.java:492) 在 weblogic.wsee.jaxrpc.ServiceImpl.(ServiceImpl) 处连接 weblogic.wsee.jaxrpc.ServiceImpl.throwServiceException(ServiceImpl.java:185) .java:126) 在 br.com.scopus.teste.ServicoAssinaturaImplService_Impl.(ServicoAssinaturaImplService_Impl.java:21) 在 br.com.scopus.teste.Client.main(Client.java:26) 引起：weblogic.wsee.wsdl .WsdlException：无法从 url 读取 wsdl 文件，原因是 -- java.net.ConnectException：连接被拒绝：在 weblogic.wsee.wsdl.WsdlReader 处连接。getDocument(WsdlReader.java:313) 在 weblogic.wsee.wsdl.internal.WsdlDefinitionsImpl.parse(WsdlDefinitions Impl.java:432) 在 weblogic.wsee.wsdl.internal.WsdlDefinitionsImpl.parse(WsdlDefinitions Impl.java:417) 在 weblogic .wsee.wsdl.WsdlFactory.parse(WsdlFactory.java:81) 在 weblogic.wsee.wsdl.WsdlFactory.parse(WsdlFactory.java:68) 在 weblogic.wsee.jaxrpc.ServiceImpl.loadWsdlDefinition(ServiceImpl.java: 483)。 .. 3 更多”68) 在 weblogic.wsee.jaxrpc.ServiceImpl.loadWsdlDefinition(ServiceImpl.java: 483) ... 3 更多"68) 在 weblogic.wsee.jaxrpc.ServiceImpl.loadWsdlDefinition(ServiceImpl.java: 483) ... 3 更多"

**也许重要信息：**

这些是我正在使用的 jar： wlfullclient.jar wsclient.jar adf-config.xml weblogic.jar wseeclient.jar wsclient_extended.jar glassfish.jaxws.rt_1.2.0.0_2-1-5.jar
Weblogic 版本：10.3.5
谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-08T09:47:43.080

这可能不是图书馆问题。您收到“java.net.ConnectException：连接被拒绝”。因此，Web 服务堆栈设法执行对 WSDL URL 的调用，但无法通过。一个原因可能是您的 URL 不正确，引用了不正确的接口（本地主机而不是实际主机名，反之亦然）或其他任何内容。

尝试复制粘贴它告诉您它无法在网络浏览器中访问的 URL，您应该会看到同样的问题。

# xcode - 动态改变 NSButton NSImage 颜色

> ID：15509540
> 
> 赞同：0
> 
> 时间：2013-03-19T20:16:17.437
> 
> 标签：xcode, macos, cocoa

我正在尝试使用带有 NSImage 的 NSButton，类似于 Apple 的“预览”应用程序标记按钮，这些按钮在选择时会改变颜色。

通过查看捆绑资源，Apple 似乎使用 PDF 图像（例如 TB_annotMarkupUnderlineTemplate.pdf）并在选择 VS 时以编程方式更改颜色。具有蓝色的交替图像。

我不能对 PDF 图像进行图像屏蔽，因为它具有 alpha 值。

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T03:51:23.560

如果我理解您的问题，您想在运行时更改图像的背景颜色。

即，在某些事件中，您将更改图像的背景颜色。此外，您知道 NSButton 没有背景，因为它们是由可可（ aqua ）样式直接绘制的。

您需要放置一些图像并隐藏按钮的标题（如果您不想显示标题）。

这是我的[示例代码](http://www.keepandshare.com/doc/6022049/nsbuttonbackground-45k?da=y)。

我在 NSComboBox 上使用了 IBAction，

```
- (IBAction)comboSelect:(id)sender {

    if ([[sender stringValue] isEqualToString:@"Red" ]) {
        [self.button setImage:[NSImage imageNamed:@"imgRed"]];
    }
    else if ([[sender stringValue] isEqualToString:@"Green" ]) {
        [self.button setImage:[NSImage imageNamed:@"imgGreen"]];
    }
    else if ([[sender stringValue] isEqualToString:@"Blue" ]) {
        [self.button setImage:[NSImage imageNamed:@"imgBlue"]];
    }
} 
```

# eclipse - 如何在网页上查找 UI 元素的 jsp 文件名

> ID：15509543
> 
> 赞同：0
> 
> 时间：2013-03-19T20:16:30.667
> 
> 标签：eclipse, jsp, tomcat, servlets

嗨，感谢您的帮助，

我正在尝试在我公司的 Intranet 站点上添加一个按钮，但如果没有 1000 个 jsp 文件阻碍了我的工作，那就麻烦了。

如何找出哪个文件包含特定的 UI 元素？

这是 FireBug 向我展示的内容：

```
<div class="TabContent TitleTabContainer">
<a class="TabTitle" role="tab" onclick="return !1;"href="javascript:void(null);"         title="Documents" style="width: auto;">Documents</a>
</div> 
```

谢谢你，WH

# java - 优化 Gson 反序列化

> ID：15509544
> 
> 赞同：14
> 
> 时间：2013-03-19T20:16:31.943
> 
> 标签：java, json, gson

优化反序列化的最佳方法是什么？

我目前正在使用标准的 Gson.toJson 和 Gson.fromJson 方法对一些复杂对象进行序列化和反序列化，并且我希望尽可能减少反序列化时间。

如果重要的话，我的对象中最复杂的包含 43 个变量。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-29T07:18:56.590

如果你想使用 Gson，而不是切换到另一个 Java-to/from-JSON API，如果 Gson 的自动数据绑定性能不够好，那么可以继续使用 Gson API，并挤出一些性能较好。

在[https://github.com/eishay/jvm-serializers/wiki上发布的最新几轮性能测试中，结果表明，通过使用](https://github.com/eishay/jvm-serializers/wiki)[流式传输](https://sites.google.com/site/gson/streaming)，Gson 序列化和反序列化的综合性能可能会提高约 25% [Gson 的 API，](https://sites.google.com/site/gson/streaming)而不是数据绑定。

请注意，这通常会使用户代码的实现显着复杂化，其中类似于使用数据绑定 API 的单行代码的解决方案，例如，`new Gson().toJson(something)`被（很容易）替换为数十行，包括循环和条件。因此，提高性能的代价是更复杂的代码。

有关使用流 API 与数据绑定 API 的示例，请查看[jvm-serializers 项目](https://github.com/eishay/jvm-serializers)[`JsonGsonManual`](https://github.com/eishay/jvm-serializers/blob/master/tpc/src/serializers/json/JsonGsonManual.java)中的和[`JsonGsonDatabind`](https://github.com/eishay/jvm-serializers/blob/master/tpc/src/serializers/json/JsonGsonDatabind.java)实现。

（注意：也可以在 Gson API 中使用树模型，而不是流式处理或数据绑定 API，但它似乎没有提供任何优于数据绑定的性能改进。有关示例，请参阅[`JsonGsonTree`](https://github.com/eishay/jvm-serializers/blob/master/tpc/src/serializers/json/JsonGsonTree.java)。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-22T09:18:47.947

There is no way to improve the Gson library serialization and deserialization time.

As Programmer Bruce said, if the execution time really matters to you, take a look at the [Jackson](https://github.com/FasterXML) library. It is, in my opinion, a little bit more "complicated" to use but it has been proven much faster than any other json libraries in benchmarks.

[Here](https://github.com/FasterXML/jackson-docs/wiki/Presentation:-Jackson-Performance) are some best practices to improve performances with Jackson.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-26T10:27:15.253

Gson 因其易用性而闻名和使用。如果你想要速度，你将不得不看看超级流行的 Jackson Json。

我已经对 Gson 和 Jackson 进行了测试和基准测试，我可以告诉你，在某些用例中，Jackson 在序列化和反序列化方面都快 15 倍，即使在非常大的对象上也是如此。

为了获得与 Json 类似的行为，我使用以下设置

```
public enum JsonMapper {
    INSTANCE;

    private final ObjectMapper mapper;

    private JsonMapper() {
        mapper = new ObjectMapper();
        VisibilityChecker<?> visibilityChecker = mapper.getSerializationConfig().getDefaultVisibilityChecker();
        mapper.setVisibilityChecker(visibilityChecker
                .withFieldVisibility(Visibility.ANY)
                .withCreatorVisibility(Visibility.NONE)
                .withGetterVisibility(Visibility.NONE)
                .withSetterVisibility(Visibility.NONE)
                .withIsGetterVisibility(Visibility.NONE));
    }

    public ObjectMapper mapper() {
        return mapper;
    }
} 
```

这将为相同的对象提供与 Gson 完全相同的 json 字符串。如果需要，您可以将其设置为仅使用 getter 和 setter。我建议您阅读有关处理子类型的所有杰克逊 json 注释（对 RPC 样式系统很有用）。

我的用例：当我需要将 blob 保存到存储系统（Redis、Cassandra、Mongo ......有时也是 mysql）时，我使用 jackson 作为序列化。我还将它用作我的 RPC 样式 API 的序列化，用于相当高流量的系统，尽管我更喜欢在可能的情况下使用 Protobuf。在最后一种情况下，我使用 Jackson 直接序列化为 byte[] 或流以获得更好的性能。

最后一点：对象映射器是线程安全的，并且像我刚刚提交的示例一样拥有一个静态实例将防止您产生轻微的实例化开销。

编辑：我知道我的示例没有遵循杰克逊页面中指出的许多最佳实践，但它使我可以轻松理解看起来像`Gson.toJson`and的代码`Gson.fromJson`（我也开始使用它，后来打开到杰克逊）

`Gson.toJson(object)`=> `JsonMapper.INSTANCE.mapper().writeValueAsString(object)` `Gson.fromJson(object, clazz)`=>`JsonMapper.INSTANCE.mapper().readValue(jsonString, clazz);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T20:47:19.783

我会切换到[Jackson](https://github.com/FasterXML/jackson)，并[在基准测试中考虑比 Gson 更快的其他解决方案。](https://github.com/eishay/jvm-serializers/wiki)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T18:01:42.423

优化 json 最重要的事情是将所有数据保持在一个级别。

如果一个对象有另一个对象作为它的字段，而这个字段又是另一个对象等等，每`new`一个都会消耗更多的时间来反序列化。如果对象的所有字段都具有原始类型，反序列化会更快一些。

Jackson 和 Gson 一直是帮助您的最佳图书馆。

# php - PHP 倒数计时器

> ID：15509546
> 
> 赞同：1
> 
> 时间：2013-03-19T20:16:38.757
> 
> 标签：php, javascript, timer, countdown

是否可以使用 PHP 创建一个计时器，以便在 60 秒后执行某些操作。所以它实际上向您显示了从 60 到 0 的倒计时。我会刷新 div，所以它实际上看起来像是在倒计时。我不介意使用 JavaScript，但我只想在 $_GET 变量为 = 时才运行计时器。

对于任何一种选择，有人可以帮忙吗？

现在，我正在使用从 Youtube 上的 EpicSoftworks 获得的这段代码，但这段代码的问题是您必须指定要使用的时间戳。

```
$future = -2211753540;
$current = time();
$difference = $future - $current;

$minutes = floor($difference/60);
$r_seconds = floor($difference - ($minutes = 60) );

echo '<h2>' . $minutes . ' - ' . $r_seconds . '</h4>'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:23:07.373

使用 PHP 从 URL 中获取变量，然后使用 javascript 处理其余部分。创建一个将循环运行 60 次的函数。在该循环内创建一个 setTimeOut，它将执行 1000（1 秒）超时的操作。

# youtube-api - 通过 YouTube API 上传的视频是否遵守默认获利设置？

> ID：15509548
> 
> 赞同：2
> 
> 时间：2013-03-19T20:16:43.223
> 
> 标签：youtube-api

我体验过，使用 Google-cl 时，没有启用货币化内容的选项。从命令行导入。

甚至可以通过api吗？

我在 youtube 中设置了默认设置以通过新内容获利，并通过 youtube 网站手动上传的内容得到正确配置。但是使用 google-cl 会忽略此设置。

有人可以指出我正确的方向还是不可能？

我每天有 4 个视频上传，不想手动编辑每个人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T19:11:49.357

通过 YouTube 数据 API（这是[google-cl](https://code.google.com/p/googlecl/)在后台使用的）上传的视频最好尊重您帐户中新视频的默认设置。

我会在内部跟进，看看你是否有任何理由在实践中没有看到这种情况发生。

# sql-server-2008 - 自定义 sp_who/sp_whoUsers

> ID：15509550
> 
> 赞同：0
> 
> 时间：2013-03-19T20:16:45.933
> 
> 标签：sql-server-2008, stored-procedures, context-switching

我需要允许开发`DW SQL 2K8R2`环境中的客户端查看和终止进程，但我不想授予`VIEW SERVER STATE`此人（他是前 sql dba，被认为是潜在的内部威胁）。

当我运行以下命令时，它返回一行，就好像用户使用他们当前的权限自己运行 sp。

```
USE [master] GO

SET ANSI_NULLS ON GO SET QUOTED_IDENTIFIER ON GO

CREATE PROCEDURE [dbo].[usp_who] with execute as owner AS BEGIN SET NOCOUNT ON; exec master.dbo.sp_who; END 
```

将“with execute as”更改为“self”（我是系统管理员）会返回相同的结果。我也尝试过以下而不是调用`sp_who`，它只返回一行。

select * from sysprocesses 在整个过程的执行过程中，上下文似乎没有切换或持续存在。这更不用说我将如何允许这个人“杀死”进程。

有人对这个看似独特的问题有解决方案或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:28:23.987

这听起来确实是一种独特的情况。我基于以下原因，没有针对该问题的非机器/人工或基于业务流程的解决方案（例如，没有可以制定的策略来拒绝客户的访问，因此实际上消除了问题）。

因此，对于技术解决方案，我不知道有任何纯基于 SQL 的解决方案可以做到这一点，但我在 DBA 领域的知识是有限的。但是，您可以做的是：

1.  创建一个 ASP.NET Web 应用程序（可能 Web 窗体在这里比 MVC 更好，但这只是我的意见），在部署时将设置为作为应用程序池身份作为在您的 AD 中创建的特定服务帐户运行（例如 svc_KillProcessAccount）。
2.  然后，服务帐户将成为访问数据库的对象（考虑到所需的最低权限），除了设置应用程序池身份的人之外，没有人需要知道密码（我们假设这是受信任的人）
3.  Web 应用程序可以使用[SMO](http://msdn.microsoft.com/en-us/library/ms162169%28v=sql.100%29.aspx)列出和[终止](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.server.killprocess%28v=sql.100%29.aspx)进程
4.  我还要说，Web 应用程序应该编写某种审计跟踪或类似的进程被查看和终止的时间
5.  Web 应用程序可能还需要在身份验证和授权方面的安全性，以限制可能使用它的用户（例如，将其限制为由某处管理员控制的单个 AD 组）

**但这**需要大量摆弄，需要维护另一个应用程序，需要审查更多审计信息等等。所以我认为这至少是一项中等规模的投资，它只会解决（或半解决）一个问题（我是假设这种情况不会出现太多）。

我认为对于 SMO 和应用程序所具有的那种能力，你需要小心。

所以，我想我已经给出了一个相当复杂的解决方案。也许有一个更简单的使用更多骨干 SQL（正如我所说，我不是 DBA 或这类事情的专家），但如果我提出上面的那种解决方案，它真的会让我有些停顿是否值得，或者我们是否可以找到某种“人”或业务流程解决方案来解决问题。

抱歉，最后一段有点自以为是——你可能不需要我支持所有这些:-)

HTH（至少在某种程度上）和祝你好运！弥敦道

# c# - 将带有集合容器的复合集合从 xaml 转换为 C#

> ID：15509551
> 
> 赞同：1
> 
> 时间：2013-03-19T20:16:50.727
> 
> 标签：c#, wpf, xaml, binding, compositecollection

基本上我想将我在 xaml 中所做的事情转换为 C#。这与以下问题有关： [Bind a string in xaml to a property](https://stackoverflow.com/questions/14530928/bind-a-string-in-xaml-to-a-property)

这就是在我的情况下需要和使用代理的原因： [http ://www.thomaslevesque.com/2011/03/21/wpf-how-to-bind-to-data-when-the-datacontext-is-not -遗传/](http://www.thomaslevesque.com/2011/03/21/wpf-how-to-bind-to-data-when-the-datacontext-is-not-inherited/)

允许我绑定到 CollectionContainer 的代理类：

```
public class BindingProxy : Freezable
{
    #region Overrides of Freezable

    protected override Freezable CreateInstanceCore()
    {
        return new BindingProxy();
    }

    #endregion

    public object Data
    {
        get { return (object)GetValue(DataProperty); }
        set { SetValue(DataProperty, value); }
    }

    // Using a DependencyProperty as the backing store for Data.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty DataProperty =
        DependencyProperty.Register("Data", typeof(object), typeof(BindingProxy), new UIPropertyMetadata(null));
} 
```

在我的控件资源中定义的代理：

```
<UserControl.Resources>
   <global:BindingProxy x:Key="proxy" Data="{Binding }" />
</UserControl.Resources> 
```

我最终想要转换为 C# 的 Xaml 代码：

```
<ComboBox ItemsSource="{Binding NameCollection}">
   <ComboBox.ItemsSource>
      <CompositeCollection>
         <x:StaticExtension Member="VM:NameClass.NoName " />
         <CollectionContainer Collection="{Binding Data.NameCollection, Source={StaticResource proxy}}" />
      </CompositeCollection>
   </ComboBox.ItemsSource>
 </ComboBox> 
```

我不想在我的视图模型集合中但希望向用户显示的字符串常量：

```
public class NameClass
{
   public const string NoName = "[None]";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T23:48:09.683

我想我是通过尝试包含代理来使其复杂化。但实际上这是一个非常简单的解决方案：

```
 ComboBox comboBox1 = new ComboBox { Height = 18, Width = 100, FontSize = 9.5 };

 CompositeCollection compositeCollection = new CompositeCollection();
 compositeCollection.Add(NameClass.NoName);

 CollectionContainer collectionContainer = new CollectionContainer();
 collectionContainer.Collection = ItemsSource1;

 compositeCollection.Add(collectionContainer);

 comboBox1.ItemsSource = compositeCollection; 
```

# javascript - 纯 JavaScript TagName 等

> ID：15509555
> 
> 赞同：0
> 
> 时间：2013-03-19T20:17:08.237
> 
> 标签：javascript, jquery, for-loop, getelementsbytagname, getelementsbyclassname

我仍然在尝试学习纯 javascript，因为我跳过它并去学习 jQuery，尽管我不再想要一个库。我想要速度，无论如何我对纯 JavaScript 有一些疑问。

**第一个问题：**

```
var profile = document.getElementsByClassName("postprofile-details");
var details = profile.getElementsByTagName("dd");
    details[0].style.display = "none"; 
```

我不断收到错误消息

```
TypeError: Object #<NodeList> has no method 'getElementsByTagName' 
```

我该怎么办？

**下一个问题**基本上与上面的相同代码有关，我知道 jQuery 有一个`.prepend()`，`.append()`那么我将如何在`var profile`上面插入额外的 HTML？

**第三个也是最后一个问题**

我想弄清楚这类问题，我一直在学习循环函数而不是，`.each()`这就是我想出的，但出现错误

```
var a = document.getElementsByClassName('postprofile-details');
   for (var i =0; i<a.length; i++) {
           a[i].getElementsByTagName('dd').style.display='none';
   } 
```

手头的问题是我实际上如何确保我在 for 循环函数中选择循环？难道我

**A** ) a[i].getEle...

或者

**B**）a.getEle...

这些问题的任何答案都会有所帮助，我只是厌倦了使用 jQuery

**跟随答案和评论**

让我看看我能不能写这个

```
var profile = document.getElementsByTagName('postprofile-details');
for (var i=0; i<profile.length; i++) {
  var dd = profile[i].getElementsByTagName('dd');
  dd.style.display='none';
  var newEle = document.createElement('div');
  newEle.id = 'toggle';
  profile[i].appendChild(newEle);
 } 
```

请让我知道我的代码中是否有任何问题，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:19:45.587

> TypeError: Object # has no method 'getElementsByTagName'

你应该使用：

```
profile[index].getElementsByTagName("dd"); 
```

使用所需的节点，您不能`getElementsByTagName`在节点列表上使用。

> 下一个问题基本上与上面的相同代码有关，我知道 jQuery 有一个 .prepend() 和 .append() 那么我如何将额外的 HTML 插入到上面的 var 配置文件中？

```
profile[index].appendChild(newNode); 
```

**最后一个答案：**

作为第一个答案，您需要迭代所有 nodeList `getElementsByTagName`\`getElementsByClassName`返回。

# ef-code-first - 实体框架代码优先迁移：设置主键值

> ID：15509564
> 
> 赞同：20
> 
> 时间：2013-03-19T20:17:33.807
> 
> 标签：ef-code-first, primary-key, entity-framework-5, entity-framework-migrations

我有一个表，它为表的某些行存储一些额外的数据，例如：

```
public class QuoteExtra
{
    [Key]
    public int QuoteId { get; set; }
    // More fields here
} 
```

我希望能够在我明确设置 PK 的表中添加行。

如果我只是像上面那样保留它，设置一个值并提交该行会导致该值被丢弃并替换为数据库中自动生成的值（并且该列被定义为实际模式中的 Identity 列）。

这似乎是正确的解决方案：

```
public class QuoteExtra
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int QuoteId { get; set; }
    // More fields here
} 
```

然而，这反而让我例外：

> 当 IDENTITY_INSERT 设置为 OFF 时，无法在表“EnumTest”中插入标识列的显式值。

那么，如何编写我的课程以便能够在 EF 中设置主键的值？

编辑：

我尝试添加以下基于代码的迁移以将 IDENTITY_INSERT 设置为 ON：

```
public override void Up()
{
    Sql("SET IDENTITY_INSERT QuoteExtra ON");
} 
```

我运行它并再次尝试，但得到与上述相同的异常。奇怪的是数据库确实反映了这个设置，并且直接对它运行 SQL 确实允许我为主键插入任意值 - 所以看起来实体框架本身正在执行这个规则，并且忽略了识别 IDENTITY_INSERT 不在事实设置为关闭。我需要在 EF 本身的某个地方设置它吗？

编辑2：

我误解了 IDENTITY_INSERT；我假设设置它曾经无限期地留在那张桌子上。事实上，它的存在时间与“会话”一样长，这意味着例如将其设置为迁移意味着它存在......只要迁移运行，并且与我后来的 .Add() 与 EF 的未来连接无关，这就解释了为什么我仍然得到那个异常 - 数据库确实是异常的来源，而不是 EF。由于 IDENTITY_INSERT 被限制为每个会话最多一个表，这是一种相当低效的方法 - 首先不创建 Identity PK 列似乎是一条更好的路线。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-03-19T22:20:26.657

这是在未启用身份自动增量的情况下创建 PK 的正确方法：

```
public class QuoteExtra
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int QuoteId { get; set; }
    // More fields here
} 
```

但是，如果在 EF Migrations 已经创建表之后添加 DatabaseGenerated(DatabaseGeneratedOption.None)]，它不会对表执行任何操作。如果这是您的场景，您需要添加手动迁移以删除表：

```
add-migration RecreateQuoteExtra 
```

在迁移中：

```
public override void Up()
{
    DropTable("QuoteExtra");
} 
```

然后，EF 自动迁移将自动重新创建没有身份约束的表，这将允许您随时设置 PK 值，而无需运行任何特殊命令，例如 IDENTITY_INSERT ON。

这听起来像 EF7（“数据运动”）中出现的破坏性较小的方法，或者如果您想避免丢失现有数据，您可以在迁移中自己编写大量手动 sql 来创建临时表并移动数据在表中。

编辑：根据您的情况，EF Migrations 可能不会重新创建表 - 如果该类已经存在并且已经添加到您的 DbContext 中，它只会删除它并保留它，这意味着您的手动迁移不仅要删除而且还要创建桌子。没什么大不了的，因为 EF Migrations 从 add-migration 为您生成的脚手架代码将为您创建这些语句，但它需要更多代码来检查问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-19T20:25:19.513

这是正确的解决方案，但仅适用于新表。如果您更改现有表的数据库生成选项，EF 迁移将无法执行此更改，并且您的`QuoteId`列仍标记为`Identity`在数据库中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-20T14:19:03.117

我无法用您的提示解决此问题，然后我尝试重新创建整个数据库，但它也无法正常工作。

要解决此问题，您必须在第一次（！）创建列（例如 Initial-Migration）时删除**identity: true属性。**

也许它会帮助某人..

# c# - C# 泛型类型转换为模板参数类型失败？

> ID：15509569
> 
> 赞同：0
> 
> 时间：2013-03-19T20:17:40.970
> 
> 标签：c#, templates, generics, casting

我正在尝试创建一个系统，通过将基类提升为派生类并照此使用它，但是如果您看到下面的错误，它似乎正在尝试将“NodeType”转换为派生类型，即使 NodeType 是不是真正的类型。

这不起作用：

```
class Node {}
class Navpoint : Node {}
class Jumppoint : Node {}

class Actor {
  public static void on<NodeType>(Actor actor, Node node) where NodeType : Node {
     actor.Navigate(node as NodeType);  // error: (CS1502) cannot convert NodeType to Navpoint
  }

  private static IDictionary<System.Type, Navigation> navigations = 
    new Dictionary<System.Type, Navigation>() {
     {typeof(Navpoint), on<Navpoint>},
     {typeof(Jumppoint), on<Jumppoint>},
  };

  public void Navigate(Node node) {
   navigations[node.GetType()](this, node);
  }
 public void Navigate(Navpoint navpoint) {
     // do something with navpoint
  }
  public void Navigate(Jumppoint jumppoint) {
     // do something with jumppoint
 }
} 
```

然而，这确实有效：

```
class Node {}
class Navpoint : Node {}
class Jumppoint : Node {}

class Actor {
  public static void onNavpoint(Actor actor, Node node) {
     actor.Navigate(node as Navpoint);  // works fine
  }
  public static void onJumppoint(Actor actor, Node node) {
     actor.Navigate(node as Jumppoint);  // works fine
  }

  private static IDictionary<System.Type, Navigation> navigations = 
    new Dictionary<System.Type, Navigation>() {
     {typeof(Navpoint), onNavpoint},
     {typeof(Jumppoint), onJumppoint},
 };

  public void Navigate(Node node) {
    navigations[node.GetType()](this, node);
  }
  public void Navigate(Navpoint navpoint) {
     // do something with navpoint
 }
  public void Navigate(Jumppoint jumppoint) {
     // do something with jumppoint
 }
} 
```

输入大约 20 行几乎重复的代码并没有什么大不了的，但我的问题是为什么？

我也在使用 Unity 和 MonoDevelop，我不知道 .NET 是否会以不同的方式处理这个问题。

# ruby-on-rails - Ember.js 通过提供程序使用 rails 处理授权

> ID：15509572
> 
> 赞同：0
> 
> 时间：2013-03-19T20:17:43.040
> 
> 标签：ruby-on-rails, json, ember.js, client-server

干杯! 我有 Ember + Rails 应用程序，Rails 端为我提供了 json 链接：

```
http://location/api/users/vk_auth_url.json 
```

它的内容是：

```
"http://location/users/auth/vkontakte" 
```

如何从我的应用程序 ember 的模板中访问它？

**更新：**

感谢 Jesse Wolgamott，我在视图中这样做了（在应用程序视图中临时）：

```
Bandyard.ApplicationView = Ember.View.extend({
  authUrl: null,

  didInsertElement: function(){
      var url = $("body").data("auth-url");
      this.set('authUrl', url);
    }
}); 
```

在模板中：

```
<a target="_blank" href="{{unbound view.authUrl}}">Sign up</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:27:19.173

我发现的最佳方法是将其添加到正文中。

```
<body data-auth-url="http://location/users/auth/vkontakte"></body> 
```

然后你可以抓住它并简单地使用它：

```
$("body").data("auth-url") 
```

# xml - 取消注释 xml 元素，添加属性并使用 xslt 打印输出 xml

> ID：15509574
> 
> 赞同：1
> 
> 时间：2013-03-19T20:17:48.133
> 
> 标签：xml, xslt

我有一个场景，当我需要从 server.xml (tomcat) 中取消注释 SSL 配置并且还需要在其中添加几个属性时。当 SSL 配置已经可用但我的模板不适用于刚刚未注释的部分时，我成功添加了两个属性。任何的想法？

```
<?xml version='1.0' encoding='utf-8'?>
<?xml-stylesheet type="text/xsl" href="new2.xsl"?>

<Server port="8005" shutdown="SHUTDOWN">

  <!--APR library loader. Documentation at /docs/apr.html -->
  <Listener className="org.apache.catalina.core.AprLifecycleListener" SSLEngine="on" />
  <!--Initialize Jasper prior to webapps are loaded. Documentation at /docs/jasper-howto.html -->
  <Listener className="org.apache.catalina.core.JasperListener" />
  <!-- Prevent memory leaks due to use of particular java/javax APIs-->
  <Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener" />
  <!-- JMX Support for the Tomcat server. Documentation at /docs/non-existent.html -->
  <Listener className="org.apache.catalina.mbeans.ServerLifecycleListener" />
  <Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener" />

  <!-- Global JNDI resources
       Documentation at /docs/jndi-resources-howto.html
  -->
  <GlobalNamingResources>
    <!-- Editable user database that can also be used by
         UserDatabaseRealm to authenticate users
    -->
    <Resource name="UserDatabase" auth="Container"
              type="org.apache.catalina.UserDatabase"
              description="User database that can be updated and saved"
              factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
              pathname="conf/tomcat-users.xml" />
  </GlobalNamingResources>

  <Service name="Catalina">

    <!--The connectors can use a shared executor, you can define one or more named thread pools-->
    <!--
    <Executor name="tomcatThreadPool" namePrefix="catalina-exec-"
        maxThreads="150" minSpareThreads="4"/>
    -->

    <Connector port="8080" URIEncoding="UTF-8" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443" />

    <!--NEED TO UNCOMMENT AND ADD ATTRIBUTES IN THE FOLLOWING ELEMENT--> 

    <!--<Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
               maxThreads="150" scheme="https" secure="true"
               clientAuth="false" sslProtocol="TLS" /> -->

    <!-- Define an AJP 1.3 Connector on port 8009 -->
    <Connector port="8009" protocol="AJP/1.3" redirectPort="8443" />

    <!-- You should set jvmRoute to support load-balancing via AJP ie :
    <Engine name="Catalina" defaultHost="localhost" jvmRoute="jvm1">         
    -->
    <Engine name="Catalina" defaultHost="localhost">

      <Realm className="org.apache.catalina.realm.UserDatabaseRealm"
             resourceName="UserDatabase"/>

      <!-- Define the default virtual host
           Note: XML Schema validation will not work with Xerces 2.2.
       -->
      <Host name="localhost"  appBase="webapps"
            unpackWARs="true" autoDeploy="true"
            xmlValidation="false" xmlNamespaceAware="false">
      </Host>
    </Engine>
  </Service>
</Server> 
```

xslt 紧随其后，取消注释该部分，如果该部分已取消注释，则在其中添加两个属性。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="@* | node()" name="Copy">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>
  <xsl:template match="@* | node()" mode="insertConnector">
    <xsl:call-template name="Copy" />
  </xsl:template>
<!--If the SSL configuration doesn't exist but availabe in comments, uncomment it-->
  <xsl:template match="comment()[not(../Connector[@scheme = 'https']) and
                                 contains(., 'Connector') and
                                 (contains(., 'scheme=https') or
                                  contains(., scheme='https'))]">

    <xsl:value-of select="." disable-output-escaping="yes"/> <!--This line uncomments the comment-->
  </xsl:template>

  <xsl:template match = "Connector[@scheme = 'https']" name="AddAttributes">
    <Connector keystoreFile="${user.home}/.keystore">
    <xsl:apply-templates select="@* | node()"/>
  </Connector>
  </xsl:template>
</xsl:stylesheet> 
```

请指导我如何在注释部分添加属性或在取消注释后立即在元素中添加属性。以上 XSLT 只是取消注释 SSL 配置部分。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:29:59.150

您可以通过编写您自己的扩展函数，或通过调用由您的 XSLT 处理器提供的扩展（例如 saxon:parse()（在 XSLT 3.0 中标准化为 parse-xml()）将注释的内容传递给 XML 解析器. 或者，按照@JLRiche 的建议，在禁用输出转义的帮助下使用两阶段管道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T16:07:35.537

只需在此处添加我的评论作为答案，因为这是您最终采用的方法：

我认为没有办法做到这一点，至少在 XSLT 1.0 中没有。取消注释过程只是将注释的内容输出为非转义文本，但不会将其识别为 XML 数据。您是否可以使用两遍方法，通过 XSLT 运行 XML 一次以取消注释该部分，然后再一次添加注释？

# mysql - SELECT AVG 只显示一个结果

> ID：15509575
> 
> 赞同：0
> 
> 时间：2013-03-19T20:17:50.993
> 
> 标签：mysql, sql, select, relational-database

对于车库数据库，尝试在部分测试期间找到制造商组件的平均分数。以下 SQL 似乎运行良好：

```
SELECT component.manufacturer_id, AVG(section.grades) AS Grade_Average 
FROM section
INNER JOIN component
  ON section.mod_id=component.cid
GROUP BY component.manufacturer_id 
```

但只会给出一行结果（即只有一个manufacturer_id）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:22:20.423

如果要返回所有`manufacturer_id`值，则需要使用 a `LEFT JOIN`：

```
SELECT component.manufacturer_id, 
  AVG(section.grades) AS Grade_Average 
FROM component
LEFT JOIN section
  ON status.mod_id=component.cid  
GROUP BY component.manufacturer_id; 
```

您当前的查询使用的`INNER JOIN`将只返回两个表之间匹配的行。

您也正在使用`status.mod_id`，`JOIN`但您正在加入`section`，您是否需要添加加入`status`或在您的原始帖子中输入错误的内容？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:21:24.767

您在部分和组件之间有一个内部连接。如果两个表中都没有特定制造商的匹配记录，则会将它们完全过滤掉。

# linux - 如何在 linux 中创建文件侦听器？

> ID：15509576
> 
> 赞同：10
> 
> 时间：2013-03-19T20:17:52.673
> 
> 标签：linux, bash, shell, listener

我正在尝试在特定目录上创建一个侦听器，只要文件出现在此路径中，它就会启动 Linux 命令。例如，每当一个文件出现在像 C:/home/ 这样的目录中时，我想从该文件中读取一串文本，然后启动另一个命令。我正在考虑使用循环，但这似乎效率低下。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-19T20:20:55.987

要获得有关文件创建、打开、修改等事件的通知，请查看[inotify](http://en.wikipedia.org/wiki/Inotify)。从 bash 中使用它的一个好方法是使用`inotifywait`命令 -[这](http://linux.die.net/man/1/inotifywait)是它的手册页。它会一直阻塞，直到您关心的事件发生。例如：

```
inotifywait -e create /path/to/watch
echo "ding!" 
```

当在该路径中创建文件或目录时会叮当。有关更多详细信息，请参见[手册页](http://linux.die.net/man/1/inotifywait)。

# java - 在多个环境中执行 JUnit 测试的配置

> ID：15509578
> 
> 赞同：5
> 
> 时间：2013-03-19T20:17:55.600
> 
> 标签：java, eclipse, jenkins, maven-3, junit4

我有一个包含 JUnit 测试的 Java 项目，需要通过 Jenkins 在不同的测试环境（Dev、Staging 等）上运行。

我目前必须在不同的环境中构建项目并将 url、用户名和密码传递给测试运行器的解决方案是在 POM 文件中为每个环境加载特定的属性文件。属性文件将通过 Maven 构建命令为每个环境设置：

> mvn clean install -DappConfig=/src/test/resouces/integration.environment.properties

在 pom.xml 中：

```
<plugins>
        <plugin>
            <artifactId>maven-surefire-plugin</artifactId>
            <configuration>
                <systemPropertyVariables>
                    <appConfig>${app.config}</appConfig>
                </systemPropertyVariables>
            </configuration>
        </plugin>
    </plugins> 
```

在 JUnit 测试运行器类中：

```
public class BoGeneralTest extends TestCase {

    protected WebDriver driver;
    protected BoHomePage boHomePage;
    protected static Properties systemProps;
    String url = systemProps.getProperty("Url");
    String username = systemProps.getProperty("Username");
    String password = systemProps.getProperty("Password");
    int defaultWaitTime = Integer.parseInt(systemProps.getProperty("waitTimeForElements"));
    String regUsername = RandomStringUtils.randomAlphabetic(5);

    final static String appConfigPath = System.getProperty("appConfig");

    static {
        systemProps = new Properties();
        try {

            systemProps.load(new FileReader(new File(appConfigPath)));

        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

这种配置的问题是，现在各个测试不能通过 Eclipse 单独运行，因为它们期望`appConfig`从 maven 接收，而我得到 NullPointerException。

任何建议都受到高度赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T10:21:53.367

运行单个测试的前提是每个测试用例都有一个运行配置，该配置将指定默认的执行环境。请注意，此设置必须在每个测试用例本地完成。

在 Eclipse Arguments 选项卡/VM Arguments 字段中，必须指定 VM 参数：

```
-DappConfig=src/test/resources/pp1.environment.properties 
```

它保存具有环境登录详细信息的相应属性文件的路径。

项目的 src/test/resources 源文件夹下定义了五个属性文件：

```
environment1.properties
environment2.properties
environment3.properties
environment4.properties
environment5.properties 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T09:55:31.520

白盒测试：

UnitTests 应该测试工作单元，而不是依赖于依赖项。一般规则是模拟依赖项和存根外部系统，以便您有一个安全的环境进行测试。

IntegrationTests 应该以某种方式在安全的环境中注入真正的依赖项并进行测试。

黑盒测试：

功能测试是我想你想要实现的。通常，您可以使用集成测试中的相同配置，将所有自动化测试捆绑在项目 pom 中，并在每个 mvn clean 上自动执行测试。一般流程是在预集成测试阶段启动一个 servlet 容器并针对它进行测试。您应该始终从用户的角度进行测试。

# excel - Excel/VBA - 检测服务器是否可访问

> ID：15509579
> 
> 赞同：6
> 
> 时间：2013-03-19T20:18:06.807
> 
> 标签：excel, vba, remote-server

在我的工作地点，不同的计算机在不同的子网中，如果 PC 与 Samba 服务器在同一子网中，我可以通过 访问文件服务器`\\myserv\MyFolder`，但是对于 PC 在不同的子网中，唯一的方法是我访问服务器是使用 IP `(i.e., \\1.2.3.4\MyFolder)`。

我只是想知道VBA，如果有什么办法可以说：

如果我可以找到使用的服务器`\\myserv`，则使用`myserv`，否则使用`1.2.3.4`？

不幸的是，我根本无法调整网络，我想以这种方式进行设置，以便至少在 IP 更改时，我的大多数用户仍然可以通过访问来使用该工具`\\myserv\MyFolder`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T22:17:45.770

这是我用来检查服务器可达性的一些代码。它使用 Windows winsock32 API，我没有遇到任何问题。我不必担心特权，所以我不知道它会如何处理。

我已经对代码进行了相当多的评论，因此希望您在需要对其进行调整时能够理解发生了什么。根据我使用的示例子，它可以工作。在检查网络路径后，我将让您执行设置文件夹的代码；）

这不是一项微不足道的任务，而是一个棘手的问题，所以我很乐意分享代码。从您将调用以进行检查的函数开始 - 请注意路径是如何定义的。我已经在我的网络上测试了这些，它们都可以工作，Diskstation 通过其网络名称和 IP 检查：

```
Sub TestMyPaths()
    TestPath ("C:\")
    TestPath ("\\Diskstation\")
    TestPath ("\\192.168.99.5\")
End Sub

Sub TestPath(sServerName As String)
    If sServerName = "" Then Exit Sub

    If Not CheckPath(sServerName) Then
        MsgBox "Cannot find " & sServerName
    Else
        MsgBox "Found " & sServerName
    End If
End Sub

Private Function CheckPath(sfile As String) As Boolean
    'Response Variables
    Dim bResponse As Boolean, bLocal As Boolean
    'File System Variables
    Dim oFS As Object, oDrive As Object, oTemp As Object
    'Variables for chkecing the server
    Dim strIPAddress  As String, Reply As ICMP_ECHO_REPLY, lngSuccess As Long, sServer As String

    If sfile = "" Then Exit Function
    bResponse = False

    On Error GoTo SomeProblem

    ' Determine if drive is local and resolve all remote paths to UNC filenames
    Set oFS = CreateObject("Scripting.FileSystemObject")
    Set oDrive = oFS.Drives
    bLocal = False
    If UCase(VBA.Left(sfile, 1)) Like "[A-Z]" Then
        For Each oDrive In oFS.Drives
            If oDrive.Path = UCase(VBA.Left(sfile, 2)) Then
                If oDrive.DriveType = 3 Then ' Remote Drive
                    sfile = Replace(sfile, (VBA.Left(sfile, 2)), oDrive.ShareName)
                Else
                    bLocal = True
                End If
                Exit For
            End If
        Next oDrive
    End If

    If bLocal Then
        'Allow for checking at the end of this if statement
        bResponse = True
    ElseIf VBA.Left(sfile, 1) <> "\" Then
        ' File Name only specified / Not a valid path
        bResponse = False
    Else
        'Otherwise we are dealing with a server path

        'Get the server name
        sServer = VBA.Mid$(sfile, 3, InStr(3, sfile, "\", vbTextCompare) - 3)

        'Set up networking to check
        If SocketsInitialize() Then
            strIPAddress = GetIPFromHostName(sServer)   'Get the ipaddress of the server name
            lngSuccess = ping(strIPAddress, Reply)      'Ping the IP that is passing the address and get a reply.
            Call WSACleanup                             'Clean up the sockets.
            If lngSuccess = 0 Then bResponse = True     'If we get a ping back we're all good
        End If
    End If

SomeProblem:
    CheckPath = bResponse
    Set oTemp = Nothing
    Set oDrive = Nothing
End Function 
```

然后是 API 声明（这些位于模块的顶部）。

```
 #If Win64 Then
        Private Declare PtrSafe Function gethostbyname Lib "WSOCK32.DLL" (ByVal hostname As String) As Long
        Private Declare PtrSafe Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (xDest As Any, xSource As Any, ByVal nbytes As Long)
        Private Declare PtrSafe Function WSAStartup Lib "WSOCK32.DLL" (ByVal wVersionRequired As Long, lpWSADATA As WSADATA) As Long
        Private Declare PtrSafe Function WSACleanup Lib "WSOCK32.DLL" () As Long
    #Else
        Private Declare Function gethostbyname Lib "WSOCK32.DLL" (ByVal hostname As String) As Long
        Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (xDest As Any, xSource As Any, ByVal nbytes As Long)
        Private Declare Function WSAStartup Lib "WSOCK32.DLL" (ByVal wVersionRequired As Long, lpWSADATA As WSADATA) As Long
        Private Declare Function WSACleanup Lib "WSOCK32.DLL" () As Long
    #End If

    'NETWORK AND PING API FUNCTIONS
    #If Win64 Then
        Public Declare PtrSafe Function IcmpCreateFile Lib "icmp.dll" () As Long
        Public Declare PtrSafe Function inet_addr Lib "WSOCK32.DLL" (ByVal cp As String) As Long
        Public Declare PtrSafe Function IcmpCloseHandle Lib "icmp.dll" (ByVal IcmpHandle As Long) As Long
        Private Declare PtrSafe Function IcmpSendEcho Lib "icmp.dll" _
           (ByVal IcmpHandle As Long, _
            ByVal DestinationAddress As Long, _
            ByVal RequestData As String, _
            ByVal RequestSize As Long, _
            ByVal RequestOptions As Long, _
            ReplyBuffer As ICMP_ECHO_REPLY, _
            ByVal ReplySize As Long, _
            ByVal Timeout As Long) As Long
    #Else
        Public Declare Function IcmpCreateFile Lib "icmp.dll" () As Long
        Public Declare Function inet_addr Lib "WSOCK32.DLL" (ByVal cp As String) As Long
        Public Declare Function IcmpCloseHandle Lib "icmp.dll" (ByVal IcmpHandle As Long) As Long
        Private Declare Function IcmpSendEcho Lib "icmp.dll" _
           (ByVal IcmpHandle As Long, _
            ByVal DestinationAddress As Long, _
            ByVal RequestData As String, _
            ByVal RequestSize As Long, _
            ByVal RequestOptions As Long, _
            ReplyBuffer As ICMP_ECHO_REPLY, _
            ByVal ReplySize As Long, _
            ByVal Timeout As Long) As Long
    #End If

    Public Const WINSOCK_ERROR = "Windows Sockets not responding correctly."
    Public Const INADDR_NONE As Long = &HFFFFFFFF
    Public Const WSA_SUCCESS = 0
    Public Const GWL_STYLE = -16
    Public Const WS_SYSMENU = &H80000
    Private Const ICMP_SUCCESS As Long = 0
    Private Const WS_VERSION_REQD As Long = &H101
    Private Const MAX_WSADescription As Long = 256
    Private Const MAX_WSASYSStatus As Long = 128

    'PING AND NETWORK ENUMS
    Private Type IP_OPTION_INFORMATION
       Ttl             As Byte
       Tos             As Byte
       Flags           As Byte
       OptionsSize     As Byte
       OptionsData     As Long
    End Type

    Public Type ICMP_ECHO_REPLY
       Address         As Long
       Status          As Long
       RoundTripTime   As Long
       DataSize        As Long
       Reserved        As Integer
       ptrData                 As Long
       Options        As IP_OPTION_INFORMATION
       data            As String * 250
    End Type

    Private Type WSADATA
        wVersion As Integer
        wHighVersion As Integer
        szDescription(0 To MAX_WSADescription) As Byte
        szSystemStatus(0 To MAX_WSASYSStatus) As Byte
        wMaxSockets As Long
        wMaxUDPDG As Long
        dwVendorInfo As Long
    End Type 
```

然后是通用网络功能：

```
 Public Function GetIPFromHostName(ByVal sHostName As String) As String
        'converts a host name to an IP address.
        Dim ptrHosent As Long  'address of hostent structure
        Dim ptrName As Long    'address of name pointer
        Dim ptrAddress As Long    'address of address pointer
        Dim ptrIPAddress As Long
        Dim sAddress As String
        sAddress = Space$(4)
        ptrHosent = gethostbyname(sHostName & vbNullChar)
        If ptrHosent <> 0 Then
            ptrName = ptrHosent
            ptrAddress = ptrHosent + 12
            'get the IP address
            CopyMemory ptrName, ByVal ptrName, 4
            CopyMemory ptrAddress, ByVal ptrAddress, 4
            CopyMemory ptrIPAddress, ByVal ptrAddress, 4
            CopyMemory ByVal sAddress, ByVal ptrIPAddress, 4
            GetIPFromHostName = IPToText(sAddress)
        End If
    End Function

    Private Function IPToText(ByVal IPAddress As String) As String
        IPToText = CStr(Asc(IPAddress)) & "." & _
                   CStr(Asc(Mid$(IPAddress, 2, 1))) & "." & _
                   CStr(Asc(Mid$(IPAddress, 3, 1))) & "." & _
                   CStr(Asc(Mid$(IPAddress, 4, 1)))
    End Function

    Public Function SocketsInitialize() As Boolean
        Dim WSAD As WSADATA
        SocketsInitialize = WSAStartup(WS_VERSION_REQD, WSAD) = ICMP_SUCCESS
    End Function

    Public Function ping(sAddress As String, Reply As ICMP_ECHO_REPLY) As Long
        'Function to ping an address and see if a response is obtained
        Dim hIcmp As Long, lAddress As Long, lTimeOut As Long, StringToSend As String

        StringToSend = "test"           'Short string of data to send
        lTimeOut = 1000 'ms             'ICMP (ping) timeout
        lAddress = inet_addr(sAddress)  'Convert string address to a long representation

        'If we have a valid response
        If (lAddress <> -1) And (lAddress <> 0) Then

            'Create the handle for ICMP requests.
            hIcmp = IcmpCreateFile()

            If hIcmp Then
                'Ping the destination IP address.
                Call IcmpSendEcho(hIcmp, lAddress, StringToSend, Len(StringToSend), 0, Reply, Len(Reply), lTimeOut)

                'Reply status
                ping = Reply.Status

                'Close the Icmp handle.
                IcmpCloseHandle hIcmp
            Else
                Debug.Print "failure opening icmp handle."
                ping = -1
            End If
        Else
            ping = -1
        End If
    End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-19T23:25:16.277

假设您在 Windows 环境中，这是一种替代方法（没有实际代码）：

1.  在 Excel VBA 中，使用 SHELL 函数执行网络视图函数并将输出发送到文件。IE：

> ```
> Dim vsFileName
> vsFileName = "C:\Temp\RandomFileName.txt"
> Shell("Net View \\myServ > " & vsFileName ) 
> ```

2.  之后，检查输出的文件大小。如果输出文件大小 > 0，意味着找到了路径。如果找不到路径，则输出文件大小将为 0。

> `If FileLen( vsFileName ) = 0 Then vsNetworkPath = "1.2.3.4"`

3.  通过以下方式清理自己：`Kill( vsFileName )`

如果您不想乱用 win32 函数，这是一种替代方法。每次运行代码时随机化文件名以避免冲突是个好主意。

# apache - 无法阻止对 pdf 文件的热链接

> ID：15509580
> 
> 赞同：0
> 
> 时间：2013-03-19T20:18:14.457
> 
> 标签：apache, .htaccess, hotlinking

我的网站上有数千个 pdf 文件，我注意到许多其他网站已经开始通过在他们的网站上添加指向这些 pdf 文件的直接链接来窃取我的 pdf。（糟透了！）。我一直在拼命地试图防止通过我的 htaccess 热链接到 pdf，但它不起作用。这就是我的 htaccess 中的内容：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^http://www.mysite.com$      [NC]
RewriteRule .*\.(pdf)$ http://www.mysite.com/index.php [R,NC] 
```

我也在网上搜索了很长时间，但找不到适用于 pdf 的解决方案。它们中的大多数用于图像、flash 等，他们还提到它也应该适用于 pdf，但它不适合我。我还阅读了一些将 pdf 移出 webroot 的建议。我也不想那样做。当我的网站上已经有 1000 份 pdf 文件时，它的工作量太大了。有人可以帮助我如何通过 htaccess 实现这一目标。如果将 htaccess 用于 pdf 无法正常工作，那么我该怎么做才能让人们无法使用直接链接或从其他网站引用的链接访问我的 pdf？

请记住，我仍然是新手，对这一切都是新手。我在 CentOS 上使用 Apache 和 Nginx 作为反向代理。请帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T23:23:05.360

如果您使用的是 Apache 和 nginx，我假设您使用的是典型的反向代理设置，nginx 提供静态内容，Apache 处理 PHP——或类似的东西。问题是，如果您使用 nginx 提供静态内容，那可能包括 PDF，因此永远不会遇到 apache 重写规则——nginx 在不打扰 Apache 的情况下提供 PDF。

我相信你需要修改你的`nginx.conf`文件，或者你有`server`声明的任何文件。我自己没有测试过，但这里有一个[例子](http://kuttler.eu/code/redirect-hotlinked-files-nginx/)。您必须确保`referer`启用和`rewrite`模块才能使其正常工作，并且显然将 .png 或 .mp4 更改为 .pdf。

# ios - 在 iOS 中查找顶视图

> ID：15509585
> 
> 赞同：0
> 
> 时间：2013-03-19T20:18:33.573
> 
> 标签：ios, uiview, uiviewcontroller, loading

我想创建一个加载视图页面以放在屏幕中所有视图的顶部。我使用以下代码来获取 rootViewController 的视图：

```
UIApplication.sharedApplication.keyWindow.rootViewController.view 
```

我创建了我的视图页面并将其作为子视图添加到 rootViewController 的视图中。我的问题是当我这样做时，如果 rootViewController 发生变化，我的加载页面将落后于新的 viewController 的视图。例如，我在发送 http 请求时调用了 showLoading 函数。当响应返回时，它会更改 viewController 并在其后面加载。有没有办法让我的加载独立于后台发生的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:23:37.413

您可以根据需要创建任意数量`UIWindows`。如果您真的想确保视图*始终*位于顶部，那么最好创建第二个`UIWindow`并将其添加到您的层次结构中。然后，无论另一个发生什么，`UIWindow`您的加载指示器都将保持在顶部。

**例子**

```
UIWindow *secondWindow = [[UIWindow alloc] initWithFrame:[[[UIApplication sharedApplication] keyWindow] frame]];
[secondWindow setWindowLevel:UIWindowLevelStatusBar];
[secondWindow makeKeyAndVisible];

UIViewController *aNewViewController = [[UIViewController alloc] initWithFrame:secondWindow.bounds];
[secondWindow setRootViewController:aNewViewController]; 
```

# java - 如何在java中的同一行上一次打印字符串战争游戏样式一个字母

> ID：15509596
> 
> 赞同：3
> 
> 时间：2013-03-19T20:19:22.870
> 
> 标签：java, string, printing

在我在网上找到的那一刻使用这个代码

```
 String welcome = "Would you like to play a game?";
 for (int i = 0; i < welcome.length(); i++) {
      System.out.println(welcome.charAt(i));

    } 
```

非常基本的东西，但它打印出来的速度非常快并且逐行打印，我怎样才能添加一个小暂停，并在前一个字符之后立即打印？所以最后它只是说你想玩游戏吗？

我在 CMD 和 Sublime 文本中工作。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T20:20:56.270

使用 System.out.print 而不是 println。使用 Thread.sleep 暂停。循环直到打印出整个字符串。

```
String welcome = "Would you like to play a game?";
for (int i = 0; i < welcome.length(); i++) {
    System.out.print(welcome.charAt(i));
    Thread.sleep(1000L); // in milliseconds
}
System.out.println(); // start a new line 
```

Thread.sleep 抛出 InterruptedException。如果此代码进入您的 main 方法，则处理它的最简单方法（假设您对通过中断它来取消线程不感兴趣）是添加`throws InterruptedException`到 main 方法声明（不会抛出异常，您只是保持编译器很高兴）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T20:20:57.537

使用`System.out.print`而不是`System.out.println`. 要添加一点延迟，最简单的方法是使用`Thread.sleep`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T20:22:53.920

```
 for (int i = 0; i < welcome.length(); i++) {
      System.out.print(welcome.charAt(i));
      Thread.sleep(100);
    } 
```

# c# - C# 写入多个文件而无需不断关闭/重新打开流。蒸汽作家？

> ID：15509597
> 
> 赞同：6
> 
> 时间：2013-03-19T20:19:26.177
> 
> 标签：c#, streamwriter, split, streamwriter.write

我正在尝试从 Access 数据库中读取表，然后将该表中的数据排序到多个文本文件中。关键是要写入的文件名取决于每条记录中的值。这是我正式的第一个 C# 应用程序，所以你可以认为我是“绿色的”。我还应该提到，我正在使用 Access 数据库，直到我可以敲定代码，最终它将从具有数百万条记录的 SQL 服务器中提取。

我现在有代码工作，但问题是有大量的文件打开/关闭操作。我只想打开每个文件一次进行写入，因为它将这些文件写入网络驱动器。这本质上是在服务器上运行的胶水应用程序 - 所以也有一些其他限制 - 我无法保存到本地驱动器然后复制到网络。我无法在拉取之前对查询进行排序。我不能在运行时对服务器资源产生不利影响。

可能最好的方法是使用哈希表。检查文件是否已经打开，如果没有，打开它并将文件句柄保存在哈希表中。然后在完成后立即将它们全部关闭。但是我找不到如何同时使用多个 StreamWriter 对象的示例。

我希望相对容易地找到答案，但我似乎找不到他的解决方案。我怀疑 StreamWriter 是用于此的错误类。

我能找到的最接近的先前问题来自[CodeProject page](http://www.codeproject.com/Questions/304287/How-do-I-keep-open-multiple-StreamWriter-handles)。在该页面上，他们说保持文件手打开的做法是不好的，应该避免，但该页面没有解释*原因*，也没有提供示例替代方案。有一个建议是将整个数据集加载到内存中然后对其进行操作，但这对我来说不是一个选项，因为表中的数据太多。

这是我到目前为止所拥有的。

```
String strConnection;
String strQuery;
String strPunchFileNameTemplate;

// Define our Variables
strConnection = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=ClockData.accdb";
strQuery = @"SELECT * FROM ClockPunches";   
strPunchFileNameTemplate = @"C:\PUNCHES\%READER%.TXT";      

// OleDbConnection implements iDisposable interface, so we must scope out its usage.
// Set up Connection to our data source
using (OleDbConnection ConnObj = new OleDbConnection(strConnection))    {

    // Create a Command with our Query String
    OleDbCommand CmdObj = new OleDbCommand(strQuery,ConnObj);

    // Open our Connection
    ConnObj.Open();

    // OledbDataReader implements iDisposable interface, so we must scope out its usage.
    // Execute our Reader
    using (OleDbDataReader ReaderObj = CmdObj.ExecuteReader(CommandBehavior.KeyInfo))   {

        // Load the source table's schema into memory (a DataTable object)
        DataTable TableObj = ReaderObj.GetSchemaTable();

        // Parse through each record in the Reader Object
        while(ReaderObj.Read()) {

            // Extract PunchTime, CardNumber, and Device to separate variables
            DateTime dtTime = ReaderObj.GetDateTime(ReaderObj.GetOrdinal("PunchTime"));
            Int16 intID = ReaderObj.GetInt16(ReaderObj.GetOrdinal("CardNumber"));
            String strReader = ReaderObj.GetString(ReaderObj.GetOrdinal("Device"));

            // Translate the device name into a designated filename (external function)
            strReader = GetDeviceFileName(strReader);

            // Put our dynamic filename into the path template
            String pathStr = strPunchFileNameTemplate.Replace("%READER%",strReader);

            // Check to see if the file exists.  New files need an import Header
            Boolean FileExistedBool = File.Exists(pathStr);

            // StreamWrite implements iDisposable interface, so we must scope out its usage.
            // Create a Text File for each Device, Append if it exists
            using (StreamWriter outSR = new StreamWriter(pathStr, true))    {

                // Write our Header if required
                if (FileExistedBool == false)   {
                    outSR.WriteLine("EXAMPLE FILE HEADER");
                }

                // Set up our string we wish to write to the file
                String outputStr = dtTime.ToString("MM-dd-yyyy HH:mm:ss") + " " + intID.ToString("000000");

                // Write the String
                outSR.WriteLine(outputStr);

                // End of StreamWriter Scope - should automatically close
            }
        }
        // End of OleDbDataREader Scope - should automatically close
    }
    // End of OleDbConnection Scope - should automatically close
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:41:00.430

这是你自己陷入的一个非常有趣的问题。

缓存文件处理程序的问题在于，大量的文件处理程序会耗尽系统资源，从而使程序和窗口性能不佳。

如果数据库中的设备数量不太高（少于 100 个），我认为缓存句柄是安全的。

或者，您可以缓存一百万条记录，将它们分发到不同的设备并保存一些，然后再读取一些记录。

您可以将记录放在字典中，如下所示：

```
class PunchInfo
{  
    public PunchInfo(DateTime time, int id)
    {
        Id = id;
        Time = time;
    }
    public DateTime Time;
    public int Id;
}

Dictionary<string, List<PunchInfo>> Devices;
int Count = 0;
const int Limit = 1000000;
const int LowerLimit = 90 * Limit / 100;
void SaveRecord(string device, int id, DateTime time)
{
   PunchInfo info = new PunchInfo(time, id);
   List<PunchInfo> list;
   if (!Devices.TryGetValue(device, out list))
   {
      list = new List<PunchInfo>();
      Devices.Add(device, list);
   }
   list.Add(info);
   Count++;
   if (Count >= Limit)
   {
       List<string> writeDevices = new List<string>();
       foreach(KeyValuePair<string, List<PunchInfo>> item in Devices)
       {
           writeDevices.Add(item.Key);
           Count -= item.Value.Count;
           if (Count < LowerLimit) break;
       }

       foreach(string device in writeDevices)
       {
          List<PunchInfo> list = Devices[device];
          Devices.Remove(device);
          SaveDevices(device, list);
       }
    }
}

void SaveAllDevices()
{
    foreach(KeyValuePair<string, List<PunchInfo>> item in Devices)
        SaveDevices(item.Key, item.Value);
    Devices.Clear();
} 
```

这样，您将避免打开和关闭文件并打开大量文件。

一百万条记录占用 20 MB 内存，您可以轻松地将其增加到 1000 万条记录而不会出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-18T01:46:33.100

您需要设置一组编写器。这是一个如何做的例子。

```
namespace example
{
    class Program
    {
    public static StreamWriter[] writer = new StreamWriter[3];

    static void Main(string[] args)
    {
        writer[0] = new StreamWriter("YourFile1.txt");
        writer[1] = new StreamWriter("YourFile2.txt");
        writer[2] = new StreamWriter("YourFile3.txt");

        writer[0].WriteLine("Line in YourFile1.");
        writer[1].WriteLine("Line in YourFile2.");
        writer[2].WriteLine("Line in YourFile3.");

        writer[0].Close();
        writer[1].Close();
        writer[2].Close();
    }
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:23:19.670

我可以建议将您的数据保存在内存中并仅在达到一定的三售出时才写入磁盘

```
const int MAX_MEMORY_BUFFER = 100000; // To be defined according to you memory limits
String strConnection;
String strQuery;
String strPunchFileNameTemplate;

strConnection = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=ClockData.accdb";
strQuery = @"SELECT * FROM ClockPunches";   
strPunchFileNameTemplate = @"C:\PUNCHES\%READER%.TXT";      

Dictionary<string, StringBuilder> data = new Dictionary<string, StringBuilder>();

using (OleDbConnection ConnObj = new OleDbConnection(strConnection))    
{
    OleDbCommand CmdObj = new OleDbCommand(strQuery,ConnObj);
    ConnObj.Open();

    using (OleDbDataReader ReaderObj = CmdObj.ExecuteReader(CommandBehavior.KeyInfo))   
    {
        while(ReaderObj.Read()) 
        {
            DateTime dtTime = ReaderObj.GetDateTime(ReaderObj.GetOrdinal("PunchTime"));
            Int16 intID = ReaderObj.GetInt16(ReaderObj.GetOrdinal("CardNumber"));
            String strReader = ReaderObj.GetString(ReaderObj.GetOrdinal("Device"));

            strReader = GetDeviceFileName(strReader);

            bool dataPresent = data.ContainsKey(strReader);
            if (dataPresent == false)   
            {
                StringBuilder sb = new StringBuilder("EXAMPLE FILE HEADER\r\n");
                data.Add(strReader, sb);
            }

            String outputStr = dtTime.ToString("MM-dd-yyyy HH:mm:ss") + " " + intID.ToString("000000");
            StringBuilder sb = data[strReader];
            sb.AppendLine(outputStr);
            if(sb.Length > MAX_MEMORY_BUFFER)
            {
                String pathStr = strPunchFileNameTemplate.Replace("%READER%",strReader);
                using(StreamWriter sw = new StremWriter(pathStr, true) // Append mode
                {
                    // Write the buffer and set the lenght to zero
                    sw.WriteLine(sb.ToString());
                    sb.Length = 0;
                }
            }
        }
    }

    // Write all the data remaining in memory
    foreach(KeyValuePair<string, StringBuilder> info in data)
    {
        if(info.Value.Length > 0)
        {
          String pathStr = strPunchFileNameTemplate.Replace("%READER%",info.Key);
          using(StreamWriter sw = new StremWriter(pathStr, true) // Append mode
          {
              sw.WriteLine(info.Value.ToString());
          }
        }
    }
} 
```

这段代码需要测试，但我想给你一个大致的想法。通过这种方式，您可以平衡您的 IO 操作。通过增加内存缓冲区来降低，反之亦然。当然，现在您还需要考虑可用于存储数据的内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T20:39:43.850

如果单个进程在较长时间内打开了 100 或 1000 个文件句柄，这通常被认为是有问题的。但是时代变了，这已经**不是问题了**。因此，如果情况需要，就去做。

在分析这些文件中的数据的过程中，我可以打开 100、1000 甚至 5000 个文件。这将持续几个小时。如果文件读/写性能下降，我在 Windows 操作系统上进行了测量。事实并非如此。由于现代机器现在可用的内存资源，在操作系统端的内存中拥有 5000 个文件描述符不会再导致任何问题。操作系统使它们保持排序（我猜），然后这些描述符的查找是 log(n)，所以没有任何可测量的事情发生。

打开这些句柄（文件描述符结构）肯定比用数据填充内存然后逐个文件将其刷新到磁盘要好得多。

# c++ - lxml._ElementTree.getpath(element) 为非默认名称空间中的元素返回“*”而不是标签名称

> ID：15509599
> 
> 赞同：5
> 
> 时间：2013-03-19T20:19:44.617
> 
> 标签：c++, python, xpath, lxml, libxml2

请帮助`getpath()`在 xpath 中返回完整的标签名称`getpath()`或找到解决方法

我正在尝试为 a 中的元素生成 xpath `lxml.etree._ElementTree`。`ElementTree`通过解析来自某些生产 WebService 的 600Kb 响应生成。

```
print elem.getroottree().getpath(elem) 
```

这是我得到的结果：

```
'/S:Envelope/S:Body/ns5:getPhysicalResponse/*[18]/*[12]/*[6]/*[2]' 
```

不幸的是，我无法发布原始 xml - 它包含专有的客户信息。此外，我尝试使用自动生成的具有 100 个嵌套级别的简单元素树来重现此结果，每个级别有 100 个子级但没有运气 -`getpath()`返回带有完整标签名称的 xpath。

**更新** 查看[lxml 源代码](https://github.com/lxml/lxml/blob/e01a81740c77ddd26f98b316cec4610b2914eb64/src/lxml/includes/tree.pxd#L330)- 它指向库中的`tree.h` `xmlGetNodePath`方法`libxml2`。所以这实际上是`libxml2`行为。

**更新** 做更多测试我发现每次标签具有非默认命名空间时都会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-16T07:50:00.533

根据需要使用`getelementpath()`和后处理命名空间。

# c# - gridview 编辑命令错误。行不会更改模式以更新

> ID：15509601
> 
> 赞同：0
> 
> 时间：2013-03-19T20:19:45.753
> 
> 标签：c#, asp.net

我有gridview，我对gridview 行的asp.net 编辑、删除、更新命令不是很专家。这里我想通过单击编辑模式将gridview行模式更改为编辑。但是当我单击编辑按钮时它什么也不做。有人可以检查出什么问题吗？

```
 <asp:GridView ID="GridViewTopics" runat="server" AutoGenerateColumns="False" DataKeyNames="Id"
                            GridLines="Horizontal" OnRowEditing="GridViewTopics_RowEditing" CssClass="gridstyle"
                            Style="margin-left: 30px;" Width="230px">
                            <Columns>
                                <asp:TemplateField HeaderText="Topics">
                                    <ItemTemplate>
                                        <table>
                                            <tr>
                                                <td>
                                                    <div>
                                                        <asp:Label ID="LabelTopicName" runat="server" Text='<%# Eval("Name") %>'></asp:Label>
                                                    </div>
                                                </td>
                                                <td valign="top" align="right" >
                                                    <div>
                                                        <asp:LinkButton ID="LinkButtonEdit" runat="server" Text="Edit" CommandName="Edit"></asp:LinkButton>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </ItemTemplate>
                                    <EditItemTemplate>
                                        <asp:TextBox ID="TextBoxEditTopicName" runat="server" Text='<%# Bind("Name") %>'></asp:TextBox>
                                        <asp:LinkButton ID="LinkButtonUpdate" runat="server" CausesValidation="True" CommandName="Update"
                                            Text="Update"></asp:LinkButton>
                                        <asp:LinkButton ID="LinkButtonCancel" runat="server" CausesValidation="False" CommandName="Cancel"
                                            Text="Cancel"></asp:LinkButton>
                                    </EditItemTemplate>
                                </asp:TemplateField>
                            </Columns>
                            <HeaderStyle CssClass="headerclass" />
                        </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:57:23.143

尝试使用命令字段。它还会为您自动生成更新和取消按钮。相应地处理事件。

下面的代码

**ASPX**

```
<asp:GridView ID="GridViewTopics" runat="server" AutoGenerateColumns="False" DataKeyNames="Id"
    GridLines="Horizontal" OnRowEditing="GridViewTopics_RowEditing" CssClass="gridstyle" OnRowCancelingEdit="GridViewTopics_RowCancelingEdit" OnRowUpdating="GridViewTopics_RowUpdating"
    Style="margin-left: 30px;" Width="230px">
    <Columns>
        <asp:TemplateField HeaderText="Topics">
            <ItemTemplate>
                <asp:Label ID="LabelTopicName" runat="server" Text='<%# Eval("Name") %>'></asp:Label>
            </ItemTemplate>
            <EditItemTemplate>
                <asp:TextBox ID="TextBoxEditTopicName" runat="server" Text='<%# Bind("Name") %>'></asp:TextBox>
            </EditItemTemplate>
        </asp:TemplateField>
        <asp:CommandField ButtonType="Link" ShowEditButton="true"/>
    </Columns>
    <HeaderStyle CssClass="headerclass" />
</asp:GridView> 
```

**C＃**

```
protected void Page_Load(object sender, System.EventArgs e)
{
if (!Page.IsPostBack) {
    GridViewTopics.DataSource = GetSomeSampleData();
    GridViewTopics.DataBind();
}
}
private DataTable GetSomeSampleData()
{
    DataTable dt = new DataTable();
    dt.Columns.Add("Name");
    dt.Columns.Add("Id");
    for (index = 1; index <= 10; index++) {
        DataRow dr = dt.NewRow();
        dr("Id") = index;
        dr("Name") = "SomeName" + index.ToString();
        dt.Rows.Add(dr);
  }
    return dt;
}

protected void GridViewTopics_RowEditing(object sender, GridViewEditEventArgs e)
{
   GridViewTopics.DataSource = GetSomeSampleData();
   GridViewTopics.EditIndex = e.NewEditIndex;
   GridViewTopics.DataBind();
}
protected void GridViewTopics_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)
{
//Handle accordingly
}
protected void GridViewTopics_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
//Handle accordingly
} 
```

# forms - 父页面内 iframe 中的提交按钮

> ID：15509606
> 
> 赞同：1
> 
> 时间：2013-03-19T20:20:15.070
> 
> 标签：forms, iframe, submit

我需要在父页面的 iframe 中提交一个按钮。

iframe 按钮：

```
<input class="button" type="submit" value="Search"  id="search_button" /> 
```

我试图在没有结果的父页面中使用它：

```
 <a href="#" class="btn_search row_right" onclick="document.getElementById('my-iframe').contentWindow.document.getElementById('search_button').submit()">Search</a> 
```

这也不起作用：

```
<a href="#" class="btn_search row_right" onclick="document.frames['my-iframe'].document.getElementById('search_button').submit()">Search</a> 
```

# json - Camel Route/ActiveMQ 解组 JSON 并发送到方法

> ID：15509608
> 
> 赞同：2
> 
> 时间：2013-03-19T20:20:16.953
> 
> 标签：json, spring, cxf, activemq, apache-camel

我有一个 JSON 响应被发布到我的 activemq 主题。我已经设置了我的路由来解组这个对 POJO 的响应。然后，我想连续执行 3 种不同的方法，这些方法利用 JSON 对象填充的 POJO 中的字段。

这基本上就是我想要做的。我的问题在于我还是 Camel 的新手，我不确定应该如何/如何将路由中的信息传递到我的方法中，以便我可以使用由 JSON 值填充的 POJO .

如果这有任何意义的话。我将在下面发布我的 Camel Route 和 Java 类，我将推迟 pojo，因为它很简单，只有 10 个字段在 int 和 string 之间变化，并带有一些 getter/setter 方法。

**EnrollResponse**是 POJO 的名称。

任何帮助或指导/提示将不胜感激！

**编辑/更新：**

在 Eclipse 的控制台中，我从我的“设置”方法中获取了 Sys，所以我知道它至少已经到了那一步。在我的日志中，虽然这是错误开始的地方：

15:38:11,919 调试 [读取 #0 - JmsConsumer[Test.Central]] SendProcessor : >>>> Endpoint[bean://TriggeredSendBean?method=setup] Exchange[JmsMessage[JmsMessageID: ID:LT_John-51650-1363715888983- 3:2:1:1:1]]

15:38:12,396 INFO [读取 #0 - JmsConsumer[Test.Central]] ReflectionServiceFactoryBean：从 WSDL 创建服务 { [http://testAPI.com/wsdl/partnerAPI](http://testAPI.com/wsdl/partnerAPI) }PartnerAPI：file:resources/META-INF/framework.wsdl

15:38:13,159 DEBUG [读取 #0 - JmsConsumer [Test.Central]] DefaultErrorHandler：（MessageId：topic_Test.Central_ID_LT_John-51650-1363715888983-3_2_1_1_1 在 ExchangeId 上的传递失败：ID-LT-John-52743-1363721881958-0- 1）。交付尝试：0 捕获：org.apache.camel.CamelExecutionException：在交易所执行期间发生异常：Exchange[JmsMessage[JmsMessageID: ID:LT_John-51650-1363715888983-3:2:1:1:1]]

15:38:13,160 错误 [读取 #0 - JmsConsumer [Test.Central]] DefaultErrorHandler：ExchangeId 上的（MessageId：topic_Test.Central_ID_LT_John-51650-1363715888983-3_2_1_1_1 的传递失败：ID-LT-John-52743-1363721881958-0- 1）。交付尝试后用尽：1 捕获：org.apache.camel.CamelExecutionException：在交易所执行期间发生异常：Exchange[JmsMessage[JmsMessageID:ID:LT_John-51650-1363715888983-3:2:1:1:1]]

org.apache.camel.CamelExecutionException：在交易所执行期间发生异常：Exchange[JmsMessage[JmsMessageID: ID:LT_John-51650-1363715888983-3:2:1:1:1]]

* * *

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- Configures the Camel Context-->

<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:camel="http://camel.apache.org/schema/spring"
   xsi:schemaLocation="
   http://www.springframework.org/schema/beans    http://www.springframework.org/schema/beans/spring-beans.xsd
   http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

<!-- load properties --> 

<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations" value="file:backend.properties" /> 
</bean>
<bean id="properties" class="org.apache.camel.component.properties.PropertiesComponent">
    <property name="location" value="file:backend.properties" /> 
</bean>

<bean id="jmsConnectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory">
    <property name="brokerURL" value="tcp://0.0.0.0:61616?useLocalHost=true" /> 
</bean>

<bean id="pooledConnectionFactory" class="org.apache.activemq.pool.PooledConnectionFactory">
    <property name="maxConnections" value="8" /> 
    <property name="maximumActive" value="500" /> 
    <property name="connectionFactory" ref="jmsConnectionFactory" /> 
</bean>

<bean id="jmsConfig" class="org.apache.camel.component.jms.JmsConfiguration">
    <property name="connectionFactory" ref="pooledConnectionFactory" /> 
    <property name="transacted" value="false" /> 
    <property name="concurrentConsumers" value="1" /> 
</bean>

<bean id="activemq" class="org.apache.activemq.camel.component.ActiveMQComponent">
    <property name="configuration" ref="jmsConfig" /> 
</bean>

<!-- Custom Loaded Beans -->

<bean id="TriggeredSendBean" class="com.backend.trigger.ClientTest"/>
<bean id="EnrollResponse" class="com.testObjects.EnrollResponse" />

 <!-- camel configuration --> 

<camel:camelContext xmlns="http://camel.apache.org/schema/spring">
    <camel:dataFormats>
        <json id="UnmarshalToPOJO" library="Jackson" unmarshalTypeName="com.testObjects.EnrollResponse" />
     </camel:dataFormats>

    <camel:route id="genericMessageHandler" streamCache="true">
    <from uri="activemq:topic:Test.Central" /> 
    <unmarshal ref="UnmarshalToPOJO" /> 

    <to uri = "bean:TriggeredSendBean?method=setup" /> 
    <to uri = "bean:TriggeredSendBean?method=addSubscriberAllList" />
    <to uri = "bean:TriggeredSendBean?method=sendWelcomeEmail" />

    </camel:route>
</camel:camelContext> 
```

* * *

```
public class ClientTest 
{
    static String user = null;
    static String password = null;
    static String customerKeyWelcomeEmailTest = null;
    static String validFromAddress = null;
    static String validFromName = null;

public static void setup(Exchange exchange) 
{   

    System.out.println("Exchange " + exchange.toString());

    //Retrieve settings from properties file
    Properties properties = getProperties();
    user = properties.getProperty("user");
    password = properties.getProperty("password");
    customerKeyWelcomeEmailTest = properties.getProperty("customerKeyWelcomeEmailTest");  
    validFromAddress = properties.getProperty("validFromAddress");
    validFromName = properties.getProperty("validFromName");

    System.out.println("user==> " + user);
    System.out.println("password==> " + password);
    System.out.println("customerKey==> " + customerKeyWelcomeEmailTest);
    System.out.println("validFromAddress==> " + validFromAddress);
    System.out.println("validFromName==> " + validFromName);

    //Create PartnerAPI stub.
    PartnerAPI service = new PartnerAPI();
    Soap stub = service.getSoap();
} 

/**
 * Adding specific subscriber to the "All subscribers" list in
 */

  private static void addSubscriberAllList(Soap stub, Exchange exchange, EnrollResponse enrollResponse) 
  {

      // Checking to see if enrollResponse is being populated
      System.out.println(enrollResponse.getEmail());
      System.out.println(enrollResponse.getFirstname());
      System.out.println(enrollResponse.getLastname());
      System.out.println(enrollResponse.getAcctid());
      System.out.println(enrollResponse.getCid());
      System.out.println(enrollResponse.getMyfridays());
      System.out.println(enrollResponse.getPhone());
      System.out.print(enrollResponse.getPoints());

      Subscriber subscriber = new Subscriber();

      subscriber.setEmailAddress(enrollResponse.getEmail());
      subscriber.setSubscriberKey(enrollResponse.getAcctid());  
      subscriber.setStatus(SubscriberStatus.ACTIVE);

      Attribute a1 = new Attribute();
      a1.setName("firstname");
      a1.setValue(enrollResponse.getFirstname());
      //Can add more attributes as needed

      Attribute[] AttributeLists = {a1};
      subscriber.getAttributes().addAll(Arrays.asList(AttributeLists));

      APIObject[] apiObjects = {subscriber};

      try
      {
          CreateRequest createRequest = new CreateRequest();
          createRequest.setOptions(new CreateOptions());
          createRequest.getObjects().addAll(Arrays.asList(apiObjects));

          CreateResponse createResponse = stub.create(createRequest);
          System.out.println("Subscriber created in all subscriber List: " + createResponse.getOverallStatus());
      } catch (Exception e)
      {
          e.printStackTrace();
      }
  } 

/**
 * Testing Triggered Send SPECIFIC SUBSCRIBER 
 */

private static void sendWelcomeEmail(Soap stub, Exchange exchange, EnrollResponse enrollResponse) 
{
    Subscriber[] testArray = new Subscriber[1];
    Owner ownerSubscriberValid = new Owner();

    System.out.println("****************** STARTING TRIGGERED SEND TEST ******************");

    //Specify TriggeredSendDefinition and initialize the TriggeredSend
    TriggeredSendDefinition triggeredSendDefinition = new TriggeredSendDefinition();
    triggeredSendDefinition.setCustomerKey(customerKeyWelcomeEmailTest); 
    TriggeredSend triggeredSend = new TriggeredSend();
    triggeredSend.setTriggeredSendDefinition(triggeredSendDefinition);

    //Create a valid Subscriber
    Subscriber subscriberValid = new Subscriber();
    subscriberValid.setEmailAddress(enrollResponse.getEmail()); 
    subscriberValid.setSubscriberKey(enrollResponse.getAcctid());
    ownerSubscriberValid.setFromAddress(validFromAddress);
    ownerSubscriberValid.setFromName(validFromName);
    subscriberValid.setOwner(ownerSubscriberValid);

    //Populate array of Subscribers
    testArray[0] = subscriberValid;
    java.util.List<Subscriber> list = Arrays.asList(testArray);        
    triggeredSend.getSubscribers().addAll( list ); 

    //Send the TriggeredSend using Create call
    try{
      CreateRequest createRequest = new CreateRequest();
      CreateOptions createOptions = new CreateOptions();
      createRequest.setOptions(createOptions);
      java.util.List<APIObject> listAPIObject = Arrays.asList(new APIObject[] {triggeredSend});
      createRequest.getObjects().addAll(listAPIObject);
      CreateResponse createResponse = stub.create(createRequest);

      System.out.println( "overall status message: " + createResponse.getOverallStatus() );
      java.util.List<CreateResult> listCreateResult = createResponse.getResults();
      CreateResult[] createResult = listCreateResult.toArray(new CreateResult[listCreateResult.size()]);

      for ( CreateResult status : createResult )
      {
          System.out.println("create status message: " + status.getStatusMessage());
          System.out.println("create status code: " + status.getStatusCode());
      }       

      //Validate the send and get failure information
      TriggeredSendCreateResult triggeredSendCreateResult = (TriggeredSendCreateResult)createResult[0];
      assert(triggeredSendCreateResult.getSubscriberFailures() != null);
      System.out.println("size of failures array: " + triggeredSendCreateResult.getSubscriberFailures().size());
      System.out.println("email address:     " + triggeredSendCreateResult.getSubscriberFailures().get(0).getSubscriber().getEmailAddress());
      System.out.println("error description: " + triggeredSendCreateResult.getSubscriberFailures().get(0).getErrorDescription());
      System.out.println("error code:        " + triggeredSendCreateResult.getSubscriberFailures().get(0).getErrorCode());
      assert( createResult != null );
      assert(createResult[0].getStatusMessage().equals("OK"));
      System.out.println( "****************** ENDING TRIGGERED SEND TEST ******************" );   
    } catch(Exception e) {
        e.printStackTrace();
    }
}    

/**
 * Retrieve properties file.
 * 
 */
public static Properties getProperties() 
{
    Properties properties = new Properties();
    try{
        FileInputStream fileInputStream = new FileInputStream("properties.xml");
        properties.loadFromXML(fileInputStream);
    } catch (Exception e){
        e.printStackTrace();
    }
    return properties;
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T08:24:55.623

Camel 具有强大的 bean 集成，在 Camel 网站上有很多关于此的文档，例如其中一些链接

*   [http://camel.apache.org/bean-integration.html](http://camel.apache.org/bean-integration.html)
*   [http://camel.apache.org/bean.html](http://camel.apache.org/bean.html)
*   [http://camel.apache.org/bean-binding.html](http://camel.apache.org/bean-binding.html)（尤其是关于bean参数绑定的）
*   [http://camel.apache.org/how-does-camel-look-up-beans-and-endpoints.html](http://camel.apache.org/how-does-camel-look-up-beans-and-endpoints.html)

如果你有一本 Camel in Action 这本书，那么第 4 章将涵盖所有关于在 Camel 中使用 bean 的内容。

# javascript - 我如何在 javascript 中进行地理编码以获得经纬度？

> ID：15509616
> 
> 赞同：0
> 
> 时间：2013-03-19T20:20:40.383
> 
> 标签：javascript, google-maps

这就是我正在尝试的方式，但我没有得到任何回应。有什么问题？

使用的 API：

```
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=***&sensor=false"
            type="text/javascript"></script>

function initialize() {
     var addrLookup = 'San Diego , CA   92101';
     var geoCoder = new google.maps.Geocoder();
     var geoRequest = { address: addrLookup };
     geoCoder.geocode(geoRequest,function(results,status){
        window.alert("response");
        console.log(status);
     });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:33:18.330

稍微修改你的脚本：

```
<html>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
    <script>
        function initialize() {
              var addrLookup = 'San Diego , CA   92101';
              var geoCoder = new google.maps.Geocoder();
              var geoRequest = { address: addrLookup };
              geoCoder.geocode(geoRequest,function(results,status){

                  console.log('latitude: ',results[0].geometry.location.lat());
                  console.log('longitude: ',results[0].geometry.location.lng());
              });
           }
    </script>

    <body onload="initialize()">

</body></html> 
```

# python - 如何从 python 中的日期时间对象以 3 个字母格式获取星期几？

> ID：15509617
> 
> 赞同：10
> 
> 时间：2013-03-19T20:20:44.850
> 
> 标签：python

我正在编写一个脚本，我必须在 Python 中使用 datetime 对象。在某些时候，我有其中一个对象，我需要以 3 个字母的格式（即 Tue、Wed 等）获取星期几（这是一个数字值）。这是代码的简短示例，在 dateMatch.group() 中，我所做的只是获取通过正则表达式匹配获得的字符串片段。

```
from datetime import datetime

day = dateMatch.group(2)
month = dateMatch.group(3)
year = dateMatch.group(4)
hour = dateMatch.group(5)
minute = dateMatch.group(6)
second = dateMatch.group(7)

tweetDate = datetime(int(year), months[month], int(day), int(hour), int(minute), int(second)) 
```

从那个日期时间对象我得到一个数字天值（即 18），我需要将其转换为（即星期二）。

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-19T20:22:31.010

[http://docs.python.org/2/library/datetime.html#strftime-and-strptime-behavior](http://docs.python.org/2/library/datetime.html#strftime-and-strptime-behavior)

> date、datetime 和 time 对象都支持一种`strftime(format)`方法，在显式格式字符串的控制下创建表示时间的字符串。
> 
> ...
> 
> %a — 区域设置的缩写工作日名称。

```
>>> datetime.datetime.now().strftime('%a')
   'Wed' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-19T20:34:23.670

[对象](http://docs.python.org/2/library/datetime.html#datetime.datetime)的[`strftime`方法](http://docs.python.org/2/library/datetime.html#datetime.datetime.strftime)使用当前[语言环境](http://docs.python.org/2/library/locale.html)来确定转换。[`datetime`](http://docs.python.org/2/library/datetime.html#datetime.datetime)

```
>>> from datetime import datetime
>>> t = datetime.now()
>>> t.strftime('%a')
'Tue'
>>> import locale
>>> locale.setlocale(locale.LC_ALL, 'fr_FR')
'fr_FR'
>>> t.strftime('%a')
'Mar' 
```

如果这是不可接受的（例如，如果您正在格式化一个日期以通过 Internet 协议传输，那么`Tue`无论用户的区域设置如何，您实际上都可能需要该字符串），那么您需要类似：

```
weekdays = 'Mon Tue Wed Thu Fri Sat Sun'.split()
return weekdays[datetime.now().weekday()] 
```

或者您可以明确请求“C”语言环境：

```
locale.setlocale(locale.LC_TIME, 'C')
return datetime.now().strftime('%a') 
```

但是像这样设置语言环境会影响程序中所有线程上的所有格式化操作，所以这可能不是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:43:47.773

我使用的文档：http: [//docs.python.org/2/library/datetime.html](http://docs.python.org/2/library/datetime.html)

首先你需要今天的日期：

```
today = date.today() # Which returns a date object 
```

可以使用以下方法从日期对象中找到工作日：

```
weekday = today.timetuple()[6] # Getting the 6th item in the tuple returned by timetuple 
```

这将返回自星期一以来的天数（0 表示星期一），使用此整数可以执行以下操作：

```
print ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][weekday] # Prints out the weekday in three chars 
```

结合你得到：

```
from datetime import date

today = date.today() # Gets the date in format "yyyy-mm-ddd"
print today
weekday = today.timetuple()[6] # Gets the days from monday
print ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][weekday] # Prints out the weekday in three chars 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-23T07:17:03.853

不要硬编码 ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]，尝试：

```
import calendar
weekdays = [x for x in calendar.day_abbr]  # in the current locale 
```

# routing - 如何定义路由并将其映射到 Zend Framework 2 应用程序模块的 module.config.php 中的操作？

> ID：15509620
> 
> 赞同：0
> 
> 时间：2013-03-19T20:20:52.107
> 
> 标签：routing, action, zend-framework2

我的应用程序有一个`Catalog`应该显示三个视图的模块：

*   城市列表，当 URI 为`/catalog/`
*   中的运动列表`%city%`，当 URI 为`/catalog/%city%`
*   `%sport%`中的课程列表`%city%`，当 URI 为`/catalog/%city%/%sport%`

我的路由选项目前看起来像这样：

```
<?php
return array(
    ...
    'router' => array(
        'routes' => array(
            'catalog' => array(
                'type'    => 'segment',
                'options' => array(
                    'route'    => '/catalog[/:city][/:sport][/]',
                    'constraints' => array(
                        'city'  => '[a-zA-Z][a-zA-Z0-9_-]*',
                        'sport' => '[a-zA-Z][a-zA-Z0-9_-]*',
                    ),
                    'defaults' => array(
                        'controller' => 'Catalog\Controller\Catalog',
                        'action'     => 'index',
                    ),
                ),
            ),
        ),
    ),
    ...
); 
```

我的`CatalogController`：

```
class CatalogController extends AbstractActionController {

    public function indexAction() {
        return new ViewModel();
    }

    public function listCitiesAction() {} // all cities

    public function listSportsAction() {} // all sports for the city

    public function listCoursesAction() {} // all courses for the sport in the city
} 
```

如何定义路线，使其映射到上述操作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T22:20:21.600

有用！

```
'router' => array(
    'routes' => array(
        'catalog' => array(
            'type'    => 'literal',
            'options' => array(
                'route'    => '/catalog',
                'defaults' => array(
                    'controller' => 'Catalog\Controller\Catalog',
                    'action'     => 'index',
                ),
            ),
            'may_terminate' => true,
            'child_routes' => array(
                'city' => array(
                    'type'    => 'segment',
                    'options' => array(
                        'route'    => '/:city',
                        'constraints' => array(
                            'city'  => '[a-zA-Z][a-zA-Z0-9_-]*',
                            'sport' => '[a-zA-Z][a-zA-Z0-9_-]*',
                        ),
                        'defaults' => array(
                            'controller' => 'Catalog\Controller\Catalog',
                            'action'     => 'list-sports',
                        ),
                    ),
                    'may_terminate' => true,
                    'child_routes' => array(
                        'sport' => array(
                            'type'    => 'segment',
                            'options' => array(
                                'route'    => '/:sport',
                                'constraints' => array(
                                    'city'  => '[a-zA-Z][a-zA-Z0-9_-]*',
                                    'sport' => '[a-zA-Z][a-zA-Z0-9_-]*',
                                ),
                                'defaults' => array(
                                    'controller' => 'Catalog\Controller\Catalog',
                                    'action'     => 'list-courses',
                                ),
                            ),
                        ),
                    ),
                ),
            ),
        ),
    ),
), 
```

# c++ - 查看C++编译后生成的指令大小？

> ID：15509631
> 
> 赞同：0
> 
> 时间：2013-03-19T20:21:15.253
> 
> 标签：c++, c, caching, assembly, cpu

如果我告诉你我为什么问这个会更容易——以防我没有问正确的问题。内联函数时，有时会使代码太大，从而导致 TLB 未命中。我也相信如果你过多地使用内联代码，你最终不会得到 L1 数据，而是 L1 指令缓存未命中。

编译后如何确定他们编译的程序集/机器代码有多大？可以测量吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:32:44.313

大多数编译器会生成带有正确指令的汇编语言输出（例如，-Fa 用于 VC++，-S 用于大多数其他）。

VC++ 还可以生成一个映射文件，它通常更容易从中分类——它是由链接器生成的，因此它包括链接时间优化之类的东西，并告诉你符号的地址。由于这是符号在可执行文件中的布局方式，因此连续地址之间的差异将告诉您每个地址的大小（填充后）。

# mysql - 在 MySQL 中使用 Not 条件进行分组

> ID：15509638
> 
> 赞同：0
> 
> 时间：2013-03-19T20:21:38.560
> 
> 标签：mysql, sql, group-by

我有一个包含以下数据的表 browsers_list。

```
name
--------------
Internet Explorer 8.0
Internet Explorer 9.0
Internet Explorer 10.0
Internet Explorer 11.0
Firefox 9.0.1
Firefox 6.0.2
Firefox 3.6.27
Safari 533.1
Safari 534.48.3
Safari 534.54.16
Opera 9.80
Chrome x.x.x
Chrome x.x.x
Chrome x.x.x 
```

我需要将此列表分组，以便获得以下输出。

```
name
--------------
Internet Explorer 8.0
Internet Explorer 9.0
Internet Explorer 10.0
Internet Explorer 11.0
Firefox
Safari
Opera
Chrome 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T20:33:04.423

类似的东西，虽然这是一个不同的顺序：

```
SELECT 
    CASE
      WHEN Name LIKE 'Internet Explorer%' THEN Name
      ELSE SUBSTRING_INDEX(Name, ' ', 1)
    END AS NewName
FROM TableA
GROUP BY NewName 
```

# python - 将反向特征添加到插入排序的典型方法是什么？

> ID：15509639
> 
> 赞同：6
> 
> 时间：2013-03-19T20:21:42.120
> 
> 标签：python, algorithm

我写了以下插入排序算法

```
def insertionSort(L, reverse=False):
    for j in xrange(1,len(L)):
        valToInsert = L[j]
        i=j-1
        while i>=0 and L[i] > valToInsert:
            L[i+1] = L[i]
            i-=1
        L[i+1] = valToInsert
    return L 
```

编辑：您需要做的就是将最终的 > 更改为 < 以使其反向工作。

然而，大多数人在这些情况下会怎么做？在两个 if 语句中编写算法两次，一个是 >，另一个是 <？通常处理这些变化很小但它只是完全改变循环/代码的性质的场景的“正确”方法是什么？

我知道这个问题有点主观。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-19T20:35:15.880

您可以为小于运算符使用变量：

```
import operator
def insertionSort(L, reverse=False):       
    lt = operator.gt if reverse else operator.lt        
    for j in xrange(1,len(L)):
        valToInsert = L[j]
        i = j-1
        while 0 <= i and lt(valToInsert, L[i]):
            L[i+1] = L[i]
            i -= 1
        L[i+1] = valToInsert
    return L 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:36:41.307

选项1：

```
def insertionSort(L, reverse=False):
    # loop is the same...
    if reverse:
        L.reverse()
    return L 
```

选项 2：

```
def insertionSort(L, reverse=False):
    if reverse:
        cmpfunc = lambda a, b: cmp(b, a)
    else:
        cmpfunc = cmp
    for j in xrange(1,len(L)):
        valToInsert = L[j]
        i=j-1
        while i>=0 and cmpfunc(L[i], valToInsert) > 0:
            L[i+1] = L[i]
            i-=1
        L[i+1] = valToInsert
    return L 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T21:14:18.577

您可能会注意到，[`sorted`](http://docs.python.org/3/library/functions.html#sorted)以及[`list.sort`](http://docs.python.org/3/library/stdtypes.html#list.sort)所有其他进行任何可能修饰处理的函数都有一个`key`参数，而那些专门进行排序的函数也有一个`reverse`参数。（[Sorting Mini-HOWTO](http://wiki.python.org/moin/HowTo/Sorting/)涵盖了这一点。）

所以，你可以看看它们是如何实现的。不幸的是，在 CPython 中，所有这些东西都是用 C 实现的。另外，它使用了一种称为“timsort”的自定义算法（在 参考资料中进行了描述[`listsort.txt`](http://hg.python.org/cpython/file/3.3/Objects/listsort.txt)）。但我认为可以解释这里的关键部分，因为它非常简单。代码与`list.sort`代码是分开的`sorted`，它们都分布在一系列函数中。但是如果你只看顶层函数[`listsort`](http://hg.python.org/cpython/file/3.3/Objects/listobject.c#l1902)，你可以看到它是如何处理`reverse`标志的：

```
1982     /* Reverse sort stability achieved by initially reversing the list,
1983     applying a stable forward sort, then reversing the final result. */
1984     if (reverse) {
1985         if (keys != NULL)
1986             reverse_slice(&keys[0], &keys[saved_ob_size]);
1987         reverse_slice(&saved_ob_item[0], &saved_ob_item[saved_ob_size]);
1988     } 
```

为什么要在开头和结尾颠倒列表？好吧，在列表几乎排序的情况下，许多排序算法——包括 timsort 和您的插入排序——从正确的顺序开始会比向后的顺序做得更好。是的，它浪费了一个 O(N)`reverse`调用，但是你已经在做其中之一了——而且，因为任何排序算法至少是 O(N log N)，而你的具体是 O(N^2)，所以这不会不要让它在算法上变得更糟。当然，对于较小的 N、更好的排序和随机顺序的列表，这个浪费的 2N 非常接近 N log N，因此它*可以*在实践中有所作为。随着 N 变大，这种差异会消失，但是如果您要对数百万个小`list`的 s 进行排序，而不是几个大的，则可能值得担心。

其次，请注意它通过*创建一个反向切片来进行反转*。这至少可以通过以相反的顺序引用原始`list`对象来优化`__getitem__`，这意味着两个反转实际上是 O(1)。最简单的方法是从字面上创建一个反向切片：`lst[::-1]`. 不幸的是，这实际上创建了一个新的 reversed `list`，因此 timsort 包含了它自己的自定义 reverse-slice 对象。但是你可以通过创建一个`ReversedList`类在 Python 中做同样的事情。

这在 CPython 中可能实际上不会更快，因为额外函数调用的成本可能高到足以掩盖差异。但是您抱怨这两个调用的*算法*成本`reverse`，这解决了问题，有效地与内置排序函数相同。

您还可以查看 PyPy 是如何做到的。它`list`在[`listobject.py`](https://bitbucket.org/pypy/pypy/src/9f15ce4319cf205bd7173ae0274bc567fa14ad07/pypy/objspace/std/listobject.py?at=default). 它根据列表包含的内容委托给几个不同的策略类之一，但是如果您查看所有策略（除了那些无关的策略），它们基本上做同样的事情：`sort`列表，然后`reverse`是它。

所以，它对于 CPython 来说已经足够好了，对于 PyPy 来说……它可能对你来说已经足够好了。

# php - 如果 URL 后面的文本是不同的页面？

> ID：15509641
> 
> 赞同：1
> 
> 时间：2013-03-19T20:21:51.977
> 
> 标签：php, .htaccess

以下是我想做的事情：如果有人访问我的域（即`url.com`），他们会像往常一样被带到 index.html。但是，如果他们转到`url.com/helloworld`，他们会被带到 profile.php 中，POST 值是他们在斜线后键入的任何内容，同时将 URL 栏中的 URL 保持在`url.com/helloworld`. 有没有办法用 htaccess 或其他方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T22:29:33.443

尝试将这些规则添加到文档根目录中的 htaccess 文件中（`http://url.com/`通常会解析到的位置）：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)$ /profile.php?$1 [L,QSA] 
```

这假定该`helloworld`部分不指向现有文件或目录，并且不包含任何斜杠。所以`hello/world`不会工作`index.html`也不会工作（假设你有一个名为`index.html`.

如果您需要斜杠来工作，您可以将`^([^/]+)$`上面的内容更改为，`^(.+)$`以便它捕获主机名之后的*所有内容。*

# c - MPI 点对点通信到集体通信：MPI_Scatterv 故障

> ID：15509653
> 
> 赞同：1
> 
> 时间：2013-03-19T20:22:26.007
> 
> 标签：c, parallel-processing, mpi

我正在研究将点对点通信转换为集体通信的项目。

本质上，我想做的是使用 MPI_Scatterv 而不是 MPI_Send 和 MPI_Recv。我无法确定的是 Scatterv 的正确论点。

这是我正在使用的功能：

```
 void read_block_vector (
    char        *s,      /* IN - File name */
    void       **v,      /* OUT - Subvector */
    MPI_Datatype dtype,  /* IN - Element type */
    int         *n,      /* OUT - Vector length */
    MPI_Comm     comm)   /* IN - Communicator */
{
   int        datum_size;   /* Bytes per element */
   int        i;
   FILE      *infileptr;    /* Input file pointer */
   int        local_els;    /* Elements on this proc */
   MPI_Status status;       /* Result of receive */
   int        id;           /* Process rank */
   int        p;            /* Number of processes */
   int        x;            /* Result of read */

   datum_size = get_size (dtype);
   MPI_Comm_size(comm, &p);
   MPI_Comm_rank(comm, &id);

   /* Process p-1 opens file, determines number of vector
      elements, and broadcasts this value to the other
      processes. */

   if (id == (p-1)) {
      infileptr = fopen (s, "r");
      if (infileptr == NULL) *n = 0;
      else fread (n, sizeof(int), 1, infileptr);
   }
   MPI_Bcast (n, 1, MPI_INT, p-1, comm);
   if (! *n) {
      if (!id) {
         printf ("Input file '%s' cannot be opened\n", s);
         fflush (stdout);
      }
   }

   /* Block mapping of vector elements to processes */

   local_els = BLOCK_SIZE(id,p,*n);

   /* Dynamically allocate vector. */

   *v = my_malloc (id, local_els * datum_size);
   if (id == (p-1)) {
      for (i = 0; i < p-1; i++) {
         x = fread (*v, datum_size, BLOCK_SIZE(i,p,*n),
            infileptr);
         MPI_Send (*v, BLOCK_SIZE(i,p,*n), dtype, i, DATA_MSG,
            comm);
      }
      x = fread (*v, datum_size, BLOCK_SIZE(id,p,*n),
             infileptr);
      fclose (infileptr);
   } else {
      MPI_Recv (*v, BLOCK_SIZE(id,p,*n), dtype, p-1, DATA_MSG,
         comm, &status);
   }
 // My Attempt at making this collective communication:
if(id == (p-1))
    {
        x = fread(*v,datum_size,*n,infileptr);

        for(i = 0; i < p; i++)
        {
            size[i] = BLOCK_SIZE(i,p,*n);

        }
        //x = fread(*v,datum_size,BLOCK_SIZE(id, p, *n),infileptr);
        fclose(infileptr);
    }
     MPI_Scatterv(v,send_count,send_disp, dtype, storage, size[id], dtype, p-1, comm);

} 
```

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T15:31:52.667

如果您发布一个小的、独立的、可重现的示例，人们会更容易回答您的问题。

对于[Scatterv](http://www.mcs.anl.gov/research/projects/mpi/www/www3/MPI_Scatterv.html)，您需要提供要发送到每个进程的计数列表，这似乎是您的`size[]`数组，以及要发送的数据中的位移。Scatter vs Scatterv 的机制[在this answer](https://stackoverflow.com/questions/9269399/sending-blocks-of-2d-array-in-c-using-mpi/9271753#9271753)中进行了详细描述。试图推断所有变量和未提供的函数/宏的作用，下面的示例将文件分散到进程中。

但也请注意，如果您这样做，实际使用[MPI-IO](http://beige.ucs.indiana.edu/B673/node179.html)直接协调文件访问并不难，避免需要一个进程首先读取所有数据。还提供了代码。

```
#include <stdio.h>
#include <stdlib.h>
#include <mpi.h>

int main(int argc, char **argv) {

    int id, p;
    int *block_size;
    int datasize = 0;

    MPI_Init(&argc, &argv);

    MPI_Comm_size(MPI_COMM_WORLD, &p);
    MPI_Comm_rank(MPI_COMM_WORLD, &id);

    block_size = malloc(p * sizeof(int));
    for (int i=0; i<p; i++) {
        block_size[i] = i + 1;
        datasize += block_size[i];
    }

    /* create file for reading */
    if (id == p-1) {
        char *data = malloc(datasize * sizeof(char));
        for (int i=0; i<datasize; i++)
            data[i] = 'a' + i;

        FILE *f = fopen("data.dat","wb");
        fwrite(data, sizeof(char), datasize, f);
        fclose(f);

        printf("Initial data: ");
        for (int i=0; i<datasize; i++)
            printf("%c", data[i]);
        printf("\n");
        free(data);
    }

    if (id == 0) printf("---Using MPI-Scatterv---\n");

    /* using scatterv */

    int local_els = block_size[id];
    char *v = malloc ((local_els + 1) * sizeof(char));
    char *all;

    int *counts, *disps;
    counts = malloc(p * sizeof(int));
    disps  = malloc(p * sizeof(int));

    /* counts.. */
    for(int i = 0; i < p; i++)
        counts[i] = block_size[i];

    /* and displacements (where the data starts within the send buffer) */
    disps[0] = 0;
    for(int i = 1; i < p; i++)
        disps[i] = disps[i-1] + counts[i-1];

    if(id == (p-1))
    {
        all = malloc(datasize*sizeof(char));

        FILE *f = fopen("data.dat","rb");
        int x = fread(all,sizeof(char),datasize,f);
        fclose(f);
    }

    MPI_Scatterv(all, counts, disps, MPI_CHAR, v, local_els, MPI_CHAR, p-1, MPI_COMM_WORLD);

    if (id == (p-1)) {
        free(all);
    }

    v[local_els] = '\0';
    printf("[%d]: %s\n", id, v);

    /* using MPI I/O */

    fflush(stdout);
    MPI_Barrier(MPI_COMM_WORLD);   /* only for syncing output to screen */

    if (id == 0) printf("---Using MPI-IO---\n");

    for (int i=0; i<local_els; i++)
        v[i] = 'X';

    /* create the file layout - the subarrays within the 1d array of data */
    MPI_Datatype myview;
    MPI_Type_create_subarray(1, &datasize, &local_els, &(disps[id]),
                                MPI_ORDER_C, MPI_CHAR, &myview);
    MPI_Type_commit(&myview);

    MPI_File mpif;
    MPI_Status status;

    MPI_File_open(MPI_COMM_WORLD, "data.dat", MPI_MODE_RDONLY, MPI_INFO_NULL, &mpif);

    MPI_File_set_view(mpif, (MPI_Offset)0, MPI_CHAR, myview, "native", MPI_INFO_NULL);
    MPI_File_read_all(mpif, v, local_els, MPI_CHAR, &status);

    MPI_File_close(&mpif);
    MPI_Type_free(&myview);

    v[local_els] = '\0';
    printf("[%d]: %s\n", id, v);

    free(v);
    free(counts);
    free(disps);

    MPI_Finalize();
    return 0;
} 
```

运行这个给出（为清楚起见重新排序输出）

```
$ mpirun -np 6 ./foo
Initial data: abcdefghijklmnopqrstu
---Using MPI-Scatterv---
[0]: a
[1]: bc
[2]: def
[3]: ghij
[4]: klmno
[5]: pqrstu
---Using MPI-IO---
[0]: a
[1]: bc
[2]: def
[3]: ghij
[4]: klmno
[5]: pqrstu 
```

# javascript - 在 Box2D 中动态禁用碰撞：当实体已经发生碰撞时不起作用

> ID：15509661
> 
> 赞同：2
> 
> 时间：2013-03-19T20:22:54.637
> 
> 标签：javascript, box2d, collision, game-physics, impactjs

我正在用 Impactjs 编写游戏，并且使用 Box2D 作为物理引擎（具体来说是 Box2DFlash）。所以玩家有一个动作，他不应该与敌人发生碰撞。实现这种碰撞过滤似乎是最好的方法。

所以我设置了敌人的夹具：

```
 var shapeDef = new b2.PolygonDef();
 shapeDef.filter.categoryBits = 0x0002; 
```

对于玩家：

```
var shapeDef = new b2.PolygonDef();
shapeDef.filter.categoryBits = 0x0004; 
```

当我想打开/关闭玩家与敌人的碰撞时，我调用这些函数：

```
ghost: function(){
 this.setMaskBits( 0x0001 ); // only collide with boundary
},
deghost: function () {
  this.setMaskBits( 0xFFFF ); // collide with everything
},
setMaskBits: function (bits) {
  this.body.GetShapeList().m_filter.maskBits = bits;
} 
```

它正在工作......但只有当它们没有相互碰撞时。当我面对墙壁并将 categoryBits 设置为`0x0000`.

**更新**

好的，我用一个肮脏的黑客修复了它：问题是，联系人仍然存在，所以我不得不以某种方式删除它们。我最初尝试手动删除它们但失败了。

在 Box2D 的手册中写道：

> AABB 不再重叠，触点被破坏。

所以我写了一个函数，让玩家在他所面对的目录中移动大约 6px（似乎可以工作的最小量）（如果他当时没有与墙壁碰撞），这将重叠实体并解决问题。

这是有问题的功能：

```
 changePosition: function (x,y) {
    this.facingWall = false;
    this.collision(); // will set facingWall to true if he's facing a wall.
    if(!this.facingWall) {
      this.body.m_xf.position.x = x;
      this.body.m_xf.position.y = y;
    }
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-09T11:22:07.867

您可以在更改了碰撞设置的灯具上调用 Refilter()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T13:56:10.223

好的，我用一个肮脏的黑客修复了它：问题是，联系人仍然存在，所以我不得不以某种方式删除它们。我最初尝试手动删除它们但失败了。

在 Box2D 的手册中写道：

> AABB 不再重叠，触点被破坏。

所以我写了一个函数，让玩家在他所面对的目录中移动大约 6px（似乎工作的最小量）（如果他当时没有与墙壁碰撞），这将重叠实体并解决问题。

这是有问题的功能：

```
 changePosition: function (x,y) {
    this.facingWall = false;
    this.collision(); // will set facingWall to true if he's facing a wall.
    if(!this.facingWall) {
      this.body.m_xf.position.x = x;
      this.body.m_xf.position.y = y;
    }
  } 
```

# php - 使用 php $_SERVER['QUERY_STRING'] 获取部分 url 是否安全？

> ID：15509662
> 
> 赞同：0
> 
> 时间：2013-03-19T20:23:04.013
> 
> 标签：php

我创建了一个登录表单。每个用户都有个人登录 URL（每个用户的唯一 URL）。例如，唯一的 UL 是这样的：

```
www.my-domain.com/unique-url-for-user 
```

我把这部分 url:`unique-url-for-user`连接到 MySQL 并检查是否`unique-url-for-user`存在。如果存在，请检查用户名和密码是否正确。得到`unique-url-for-user`我计划使用`$_SERVER['QUERY_STRING']`

问题是：

1.  恶意用户可以使用我的方法以某种方式损害网站吗？
2.  例如，恶意用户可以`www.my-domain.com/x`从 URL 中键入并暴力破解所有用户帐户吗？
3.  有什么方法可以代替 $_SERVER['QUERY_STRING'] 使用其他东西来获取实际 URL？

如果用户键入`www.my-domain.com/xyz`，我得到`xyz`并且用户不能给我另一个 URL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T01:21:55.413

我不同意@AlienWebguy。

所以你从请求中获得了价值。

当你想在 DB 中使用这个值时，你必须使用 Prepared Statements。

当您想在页面中显示它时：不允许 HTML -- 使用 htmlentities，允许 HTML -- 删除所有脚本，允许 HTML 和脚本 -- 当前用户必须是受信任的用户。

当您想在文件系统中使用它时（不要忘记 open_basedir），请检查允许的目录（真实路径）中的请求文件，并且文件名与预定义的掩码匹配。

PS如果我错了，请纠正我。

# java - Selenium WebDriver 与 Jenkins

> ID：15509666
> 
> 赞同：3
> 
> 时间：2013-03-19T20:23:11.317
> 
> 标签：java, selenium, jenkins, selenium-webdriver, jenkins-plugins

我正在研究将 Selenium WebDriver 与 Jenkins 一起使用。我们有一个在 Windows Server 2008 下运行的 Jenkins 服务器，并且想运行我所有的测试用例，我正在使用 mstest，而且我已经在 Windows 服务器上安装了 VS...这是我在我的服务器上安装的插件列表：

```
Selenium Auto Exec Server(AES) plugin
This plugin is for continuous regression test by Selenium Auto Exec Server (AES).      0.5          

Jenkins Selenium Builder plugin
1.1         

Hudson Seleniumhq plugin
This plugin integrates Seleniumhq to Hudson.
0.4         

Selenium HTML report
0.94            

SeleniumRC plugin
This plugin allows you to create Selenium server instance for each project build.
1.0 
```

Jenkins上是否安装了任何插件？

**编辑**

这是我用来实例化驱动程序的东西，我必须使用`RemoteDriver`吗？

```
public static IWebDriver GetDriver()
{
    string _url = new Uri(Common.Url).DnsSafeHost.ToString(); 

     switch (Common.BrowserSelected)
     {
         case "ff":
         FirefoxProfile profile = new FirefoxProfile();
         profile.SetPreference("network.http.phishy-userpass-length", 255);
         profile.SetPreference("network.automatic-ntlm-auth.trusted-uris", _url);
         drv = new FirefoxDriver(profile);
                    break;
          case "ie":
          var options = new InternetExplorerOptions();
           options.IntroduceInstabilityByIgnoringProtectedModeSettings = true;
           DesiredCapabilities capabilities = new DesiredCapabilities();
            capabilities.SetCapability(CapabilityType.AcceptSslCertificates, true);
                    drv = new InternetExplorerDriver(options);
                    break;
                case "chrome":
                    //_driver = new ChromeDriver();
                    break;
            }
            return drv;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T21:43:45.517

*Jenkins上是否安装了任何插件？*

-不，您不需要这些插件。

*这是我用来实例化驱动程序的东西，我必须使用`RemoteDriver`吗？*

我认为您需要执行测试，并且需要在函数`RemoteDriver`中为此添加初始化。`RemoteDriver``GetDriver()`

可能是你帮助这个[链接](https://stackoverflow.com/questions/12836114/selenium-webdriver-remote-setup)和[这个](https://code.google.com/p/selenium/wiki/Grid2)

我的配置：

```
firefox {
    capability = DesiredCapabilities.firefox()
    capability.setPlatform(Platform.LINUX)
    driver = {new RemoteWebDriver(new URL("http://some.domain:4444/wd/hub"), capability)}
} 
```

所以我使用[Geb](http://www.gebish.org)进行测试，但我认为没有区别。

# iframe - 检测点击 iframe 然后执行操作

> ID：15509671
> 
> 赞同：0
> 
> 时间：2013-03-19T20:23:26.297
> 
> 标签：iframe, click, action, detect

我想在我的网站上添加一个 iframe，其中有一个按钮，当有人点击它时，它会执行一个操作，比如转发到另一个页面或回显消息。我不关心代码是否是 java、php、html 等，只要它可以工作。我擅长编写某些东西，但这不是其中之一，请帮帮我。

更新： iframe 是： iframe src="http://ipget.tk" /iframe

当点击它时，我希望它转到 google.com，iframe 将出现在 scazioco.com 上的测试页面上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:24:48.517

使用 Jquery，您可以将事件绑定到您的 IFrame ：

```
 $('#iframe_id').bind('click', function(event) { 
        window.location = http://www.google.com    
     }); 
```

将 #iframe_id 替换为实际 iframe 的 ID

# java - 带有实数（正数和负数）的后缀中缀

> ID：15509672
> 
> 赞同：0
> 
> 时间：2013-03-19T20:23:27.243
> 
> 标签：java

我编写了一个程序，它允许从中缀转换为后缀表达式，但它只适用于一个数字`[A-Z][a-z][0-9]`。我该如何做才能使实数（正数和负数）成为可能？

```
Example: (50 + 3.75) + 50 --> 50 3.75 + 50 + 
```

doTrans() 允许从中缀到后缀的翻译

```
public String doTrans() {
        for (int j = 0; j < input.length(); j++) {
            char ch = input.charAt(j);
            theStack.displayStack("For " + ch + " ");
            switch (ch) {
            case '+':
            case '-':
                gotOper(ch, 1);
                break;
            case '*':
            case '/':
                gotOper(ch, 2);
                break;
            case '(':
                theStack.push(ch);
                break;
            case ')':
                gotParen(ch);
                break;
            default:
                output = output + ch;
                break;
            }
        }
        while (!theStack.isEmpty()) {
            theStack.displayStack("While ");
            output = output + theStack.pop();
        }
        theStack.displayStack("End ");
        return output;
    } 
```

这一行的问题`output = output + ch;`。我找不到如何获得整数而不是一位数的解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:44:06.460

You have to do a [Lexical analysis](http://en.wikipedia.org/wiki/Lexical_analysis). You have to convert your input stream to tokens and classify them. At the moment your program already does, but it is very very basic then your tokens consist only of one digit. Though tokens can be more complex, starting from simple integer number literals greater than 9, floating point number literal, string literals, simple operators and so on.

What you might have now is something that gives you on subsequent calls the next token to analyze process it and step to the next. something like:

```
String input = "1 + 2";
int actPos = 0 ;

....

char getNextToken() {
    return input.charAt(actPos++);
} 
```

What you need to do is to rewrite the `getNextToken()` so that it gives you a "complex" token back (consisting of more than one digit/char, thus a string) witch you have to classify in the next step.

```
String getNextToken() {
    String StringBuilder token = new StirngBuilde();

    // extract the next token from the input stream
    // using a state automata witch comes to a final
    // state when a token was recognized or an erroneous input

    return token.toString();
} 
```

**EIDT**

You need to write [finite state machine](http://en.wikipedia.org/wiki/Deterministic_finite_automaton#Formal_definition) to analyze the input stream and produce tokens.

Just to give you a very simple example (assuming you have read the definition in the link above), let's say you have the alphabet `{'0','1','2','3','4','5','6','7','8','9'}` and want to build tokens that are integers without a sign. You define integer as `[0-9]+`

Your state machine will need at least three states `START` witch is the start state, `INTEGER` witch is a final and accept state, and `ERROR` witch denotes that there is an error in the input.

Now You need a transition function and a [state transition table](http://en.wikipedia.org/wiki/State_transition_table), this is what takes the actual input and produces the next state according the actual state.

The state transition table could look something like that (very basic and cannot handle when given no input)

```
 i n p u t
              +----------+----------+
              | [0-9]    | else     |
s  +----------+----------+----------+
t  | START    | INTEGER  | ERROR    |
a  +----------+----------+----------+
t  | INTEGER  | INTEGER  | ERROR    |
e  +----------+----------+----------+
   | ERROR    | ERROR    | ERROR    |
   +----------+----------+----------+ 
```

So let's say you have the following input: `27`

*   At the start the state machine has the state `START` (actual state)
*   You read the first char `2` and pass it along with the actual state to the transition function
*   Since `2` is an integer your function brings you to the state `INTEGER` and since this is not an `ERROR` you put it in the buffer where you build the token char by char.
*   Now you read the next char `7` and pass it along with the actual state `INTEGER` to the transition function.
*   `7` is also an integer, the same thing happens as with `2`.
*   Now the token buffer has the content `27` and your state machine still has the state `INTEGER` witch is an accept state and there is no input left. At this moment you can return the content of the token buffer as being the next token.

Now suppose that you have the input: `2e7`

Your state machine proceeds like above with the first char `2` and the state `INTEGER`, then comes `e` witch does not meet the rule for integer numbers defined above (`[0-9]+`). Passing `e` with the actual state `INTEGER` to the transition function result in the transition the state `ERROR`. At this point you can notify that there is an error in the input at position/index of `e`.

My advise is that you read more about lexical analysis and how you can code a finite state machine the achieve it.

This been said, you could always use some tool like [JLex](http://www.cs.princeton.edu/~appel/modern/java/JLex/) that generates this analysis code for you, but you still have to define some rules for it to have generate code that does what you want it to do, witch leads you back to reading more about lexical analysis :)

Good luck!

# c# - MVC'ify WebForms 控件

> ID：15509674
> 
> 赞同：0
> 
> 时间：2013-03-19T20:23:35.083
> 
> 标签：c#, asp.net-mvc, webforms, asp.net-controls

目前，我正在将代码隐藏中的数据传递到隐藏字段中，如下所示：

后面的代码：`HiddenField statusValue.Value = progressPercent.ToString();`

.ASCX 页面：`<asp:HiddenField ID="statusValue" value="" runat="server" />`

在 MVC 中，我会将模型从控制器传递到视图。在网络表单中是否有类似的方法可以做到这一点？我开始有大量隐藏字段，这似乎是一种糟糕的编程方式......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:55:59.120

通常，拥有大量隐藏字段并不是最佳做法。您是否查看过 ASP.NET 视图状态？它可能会实现您正在寻找的东西。
[http://msdn.microsoft.com/en-us/library/bb386448(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/bb386448(v=vs.100).aspx)
[http://msdn.microsoft.com/en-us/library/ms972976.aspx](http://msdn.microsoft.com/en-us/library/ms972976.aspx)

# ruby-on-rails - 为什么 Team City 在运行我的测试时不会加载 shoulda-matchers？

> ID：15509677
> 
> 赞同：1
> 
> 时间：2013-03-19T20:23:46.410
> 
> 标签：ruby-on-rails, continuous-integration, teamcity

我正在使用 rspec-rails 测试我的 rails 应用程序，尤其是对于模型，应该是匹配器。当我在本地运行测试时，它们都运行良好，但是当我部署到我们的 Team City 服务器时，每个使用 shoulda-matchers 的测试都会失败，因为它找不到应该由 shoulda-matchers 提供的方法。例如，一个规范以：

```
require 'spec_helper'
describe Availability do
    it { should belong_to(:user) }
end 
```

此规范因错误而失败：

```
NoMethodError: undefined method `belong_to' for #<RSpec::Core::ExampleGroup::Nested_423:0x000000199a6348> 
```

TeamCity 运行测试的方式略有不同，但我看不出它会如何阻止这个 gem 被加载。

可能相关，我的几个 capybara-webkit 测试也失败了：

```
Capybara::DriverNotFoundError: no driver called :webkit was found, available drivers: :rack_test, :selenium 
```

shoulda-matchers、capybara 和 capybara-webkit gem 都在我的 Gemfile 中的“test”组中；rspec-rails 在开发和测试组中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T07:16:16.403

您确定您的测试服务器是在测试环境而不是开发环境中运行吗？尝试将 shoulda-matchers 放入 test/dev 组

# php - PHP 输出数组

> ID：15509683
> 
> 赞同：-1
> 
> 时间：2013-03-19T20:24:08.370
> 
> 标签：php

尽管花费了数小时的谷歌搜索和阅读各种书籍，但我似乎无法在我正在尝试创建的 PHP 程序中输出我的目标（我是新手！）。基本上，一开始我只是想创建一个简单的数组并尝试输出我最喜欢的足球队以及他们的位置或关于他们的事实，然后再进入任何太复杂的事情（不幸的是，即使这也有点困难！）。这是我到目前为止所得到的：

```
<?php
    <html>
    <head>
    <title>Football teams</title>
    </head>

    <body>
    <?php

    $numbers = array("one", "two", "three", "four");

    $counter = 0;
    do {
        if($counter > 0) {
            $verse = true;
        }
        echo "$numbers[$counter] " ;
        if ($verse) {
            echo "Team " ;
        }
        else {
            echo "Teams" ;
        }
        print "are the best teams in the world <br/>" ;
        $counter++;
    } while($counter < 4);
    $football = $counter;
    while($football) {
        echo "$numbers[$football] men, " ;
        if ($verse) {
            echo "n<br/>" ;
        }
        echo "and rarely lose any games\n\n<br/><br/>" ; 
        $football--;
    }
?>
    </body>
    </html> 
```

现在它可以正常工作，但没有任何错误，但它到处都是，而且顺序不正确，所以我很感激任何帮助。当没有错误时，我自己看不出有什么问题，所以我怀疑其中一个循环有问题。

谢谢你。

我希望得到：

```
one team are the best team in the world
and rarely lose any games

two teams are the best team in the world
two teams
and rarely lose any games

three teams are the best team in the world
three teams
and rarely lose any games

four teams are the best team in the world
four teams
and rarely lose any games 
```

等等

但我得到的是：

```
one team are the best team in the world
two teams are the best team in the world
three teams are the best team in the world
four teams are the best team in the world 
```

更新：

```
$counter = 0;
do {
if($counter > 0) {  
$verse = true;     
    }
echo "$numbers[$counter] " ;
if ($verse) {`
       echo "team " ; 
    }
    else {
        echo "teams " ;
    }
    print "are the best teams in the world<br/>" ;
    $football = $counter;
    while($football) {
    echo "$numbers[$football] teams, " ;
    if ($verse) {
        echo "<br/>" ;
    }
    echo "and rarely lose any games\n\n<br/><br/>" ; 
    $mower--;
}
$counter++;
} while($counter < 10);
?></body>
</html> 
```

使用这段代码我几乎完成了我的目标，这是我得到的输出：

```
one team are the best team in the world,
two teams are the best team in the world,
two teams,
and rarely lose any games

three teams are the best team in the world,
three teams,
and rarely lose any games

two teams,
and they rarely lose any games,

four teams are the best team in the world,
four teams,
and they rarely lose any games, 
```

**但是，我想要的是：**

```
 one team are the best team in the world,
 and they rarely lose any games,

two teams are the best team in the world,
two teams,
and they rarely lose any games,

three teams are the best team in the world,
three teams, two teams,
and they rarely lose any games,

four teams are the best team in the world,
four teams, three teams, two teams,
and they rarely lose any game, 
```

谢谢如果有人可以帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:51:51.560

是的，亲爱的，你是对的。你只是提前退出循环。

```
<?php
$numbers = array("one", "two", "three", "four");
$counter = 0;
$verse = false;
do {
        if($counter > 0) {
            $verse = true;
        }
        echo "$numbers[$counter] " ;
        if (!$verse) {
            echo "Team " ;
        }
        else {
            echo "Teams" ;
        }
        print "are the best teams in the world <br/>" ;
        $football = $counter;
        if($football > 0){
           while($football > 0){
            echo "$numbers[$football] Teams, " ;
            $football--;
           }
        }
        if ($verse) {
            echo "<br/>" ;
        }
        echo "and rarely lose any games\n\n<br/><br/>" ; 
        $football--;
    $counter++;
} while($counter < 4);    
?> 
```

然而，这不是编码这个东西的最佳方式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:37:55.510

您错过了数组中的美元符号：

```
echo "$numbers[football] men, " ; 
```

应该

```
echo "$numbers[$football] men, " ; 
```

尽管以这种方式将数组包含在字符串中是一种不好的做法，因为它很容易出错。这会更好

```
echo $numbers[$football] . " men, " ; 
```

另一个问题是当第一个循环结束`$counter`时将是 4，它高于`$numbers`数组的任何索引。在下一个循环中，您尝试访问`$numbers[4]`会产生所谓的越界错误。相反，`$football--`应该在第二个循环的开头，而不是结尾。现在第一次迭代，$football 将被设置为 3，然后`$numbers[3]`将被访问，在最后一次迭代中，1 将变为 0 并被`$numbers[0]`访问。之后`while($football)`不再正确，循环退出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:39:57.313

您正在寻找的接缝是如何通过数组循环并从中输出内容。像这样做：

```
$myArray = array( 'element1', 'element2', ... );

foreach ( $myArray as $element )
{
    echo $myelement;
} 
```

如果你有一些更复杂的结构，就像你说的，关于足球队的事实，你可以这样做：

```
$teams = array(
    array(
        'name' => 'Team1',
        'fact1' => 'fact1',
        ... etc ...
    ),
    array(
        'name' => 'Team1',
        'fact1' => 'fact1',
        ... etc ...
    ),
    ... etc ...
);

foreach ( $teams as $team )
{
    echo "Teamname: {$team['name']}";
    echo "Fact1: {$team['fact1']}";
    ... etc ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T20:53:13.987

```
$numbers = array("one", "two", "three", "four");

$numbersrev = array_reverse($numbers);

foreach ($numbers as $numbersIten) 
{
    echo "Team " . $numbersIten . ' are the best teams in the world<br/>';
}
foreach ($numbersrev as $numbersrevIten) 
{
    echo '<br/>'.$numbersrevIten . ' men, <br/> and rarely lose any games <br/>';
} 
```

# java - 使用 MP 在 android 中流式传输实时音频

> ID：15509684
> 
> 赞同：1
> 
> 时间：2013-03-19T20:24:10.640
> 
> 标签：java, android, streaming, android-mediaplayer, http-live-streaming

我正在尝试使用 setDataSource 从互联网流式传输实时音频，但是当我添加 url 时，它说这是一个未处理的异常.. 有什么想法吗？

```
String daytonPolice = "http://relay.radioreference.com:80/691484064";
MediaPlayer mp = new MediaPlayer();
mp.setAudioStreamType(AudioManager.STREAM_MUSIC);
mp.setDataSource(daytonPolice); // It will not take the string of my url
mp.prepareAsync();
mp.start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T03:52:33.550

问题是因为您在调用 prepareAsync() 之后立即调用 start()。您需要设置一个 onPreparedListener：

```
String daytonPolice = "http://relay.radioreference.com:80/691484064";
MediaPlayer mp = new MediaPlayer();

mp.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {

    @Override
    public void onPrepared(MediaPlayer mp) {
        mp.start();
    }
});

mp.setAudioStreamType(AudioManager.STREAM_MUSIC);
mp.setDataSource(daytonPolice); // It will not take the string of my url
mp.prepareAsync(); 
```

# c# - 如何将此 VBA Excel 代码转换为 C#

> ID：15509685
> 
> 赞同：1
> 
> 时间：2013-03-19T20:24:19.423
> 
> 标签：c#, excel, vba

我正在尝试将 excel VBA 代码转换为 c#。此代码必须在 excel 之外执行，我将转换我的 excel 宏来执行此操作。这是要转换的代码

```
ActiveWindow.Zoom = 85
    Range("A1").Select
    Range(Selection, Selection.End(xlToRight)).Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Cells.Select 
```

这是我到目前为止得到的：

```
var excelApp = new Microsoft.Office.Interop.Excel.Application();
excelApp.Visible = true;
excelApp.ActiveWindow.Zoom = 85;
excelApp.Range["A1"].Select(); 
```

我无法弄清楚下面的其余部分`Range("A1").Select`。对此有任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:41:59.793

with 语句只是 VB 的东西，使用 c# 你必须创建一个变量并显式调用该变量的每个属性

```
ActiveWindow.Zoom = 85;
Range["A1"].Select();
Range(Selection, Selection.End(xlToRight)).Select();
Selection.HorizontalAlignment = xlCenter;
Selection.VerticalAlignment = xlBottom;
Selection.WrapText = true;
Selection.Orientation = 0;
Selection.AddIndent = false;
Selection.IndentLevel = 0;
Selection.ShrinkToFit = false;
Selection.ReadingOrder = xlContext;
Selection.MergeCells = false;
Cells.Select(); 
```

（这只是一个示例，请根据需要调整您的 COM 处理）

编辑：在第二行将括号更改为方括号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-09T12:51:58.913

您需要命名空间“Microsoft.Office.Interop.Excel”。

```
using Microsoft.Office.Interop.Excel;

MyClass{
...
    var app = new Application { Visible = true, ScreenUpdating = true, DisplayAlerts = false }; 
    Workbook book = app.Workbooks.Open(path); //path is the fullFileName as string
    Worksheet sheet = book.Worksheets[1];
    Range range = sheet.get_Range("A1", "A1");
    range.Select();
    range.HorizontalAlignment = Constants.xlCenter;
    range.VerticalAlignment = Constants.xlBottom;
    range.WrapText = true;
    range.Orientation = 0;
    range.AddIndent = false;
    range.IndentLevel = 0;
    range.ShrinkToFit = false;
    range.ReadingOrder = Constants.xlContext;
    range.MergeCells = false;
} 
```

好好享受！

# scala - 价值类的鳞片检测

> ID：15509690
> 
> 赞同：1
> 
> 时间：2013-03-19T20:24:30.707
> 
> 标签：scala, reflection, scala-2.10

我正在使用 scalap 来挑选有关 Scala 类的信息。适用于案例类，但我想看看一个类是否是一个值类。到目前为止，我还没有找到任何可以告诉我的东西。任何人都知道区分价值类和非价值类的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T20:30:36.457

```
$ cat ValueClass.scala
class ValueClass(val s: String) extends AnyVal {
  def rcap = s.reverse.toUpperCase
}

$ scalap -cp . ValueClass
final class ValueClass extends scala.AnyVal {
  val s : scala.Predef.String = { /* compiled code */ }
  def this(s : scala.Predef.String) = { /* compiled code */ }
  def rcap : java.lang.String = { /* compiled code */ }
  override def hashCode() : scala.Int = { /* compiled code */ }
  override def equals(x$1 : scala.Any) : scala.Boolean = { /* compiled code */ }
}
object ValueClass extends scala.AnyRef {
  def this() = { /* compiled code */ }
  final def rcap$extension($this : ValueClass) : java.lang.String = { /* compiled code */ }
  final def hashCode$extension($this : ValueClass)() : scala.Int = { /* compiled code */ }
  final def equals$extension($this : ValueClass)(x$1 : scala.Any) : scala.Boolean = { /* compiled code */ }
} 
```

第一行给出了它，不是吗？：final class ValueClass extends **scala.AnyVal**

编辑：如果你不使用scalap并且你想在运行时这样做，你可以（非常hackishly）

```
class V(val v: Int) extends AnyVal {}
reflect.runtime.universe.typeOf[V].typeSymbol.companionSymbol.
  typeSignature.members.exists(_.name.toString.endsWith("$extension")) 
```

至少现在。也许将来会有一个更容易抓住的`isValueClass`旗帜。

# java - 如何为检查 RadioButton 分配一个数值并将其传递给下一个活动（类似于问卷应用程序）

> ID：15509692
> 
> 赞同：0
> 
> 时间：2013-03-19T20:24:34.443
> 
> 标签：java, android, if-statement

我是 Android 开发的新手，我正在尝试设计一个简单的问卷式应用程序。每个问题都在 RadioGroup 中设置了答案。我想为选中的 RadioButton 分配一个数值，这样我就可以将其发送到下一个活动，最终它将用于汇总分数并生成一条消息。

我已经能够制作吐司了；用于测试，以显示选中了哪个 RadioButton。但是一旦检查，我就无法为每个 RadioButton 分配一个值。我知道我需要使用 IF 语句，但不确定如何使用。任何人都可以帮助或给我发送一个好的教程的链接吗？

这是我的 .java 文件之一中的一些示例代码；

```
public class Diabetes_Question_1 extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.diabetes_question_1);

    Button btnBack = (Button) findViewById(R.id.btnBack1);
    btnBack.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            startActivity(new Intent(Diabetes_Question_1.this, Diabetes_Question_2.class));

        }
    });

    final RadioGroup radioDQ1Group = (RadioGroup) findViewById(R.id.radioDQ1Group1);
    Button btnNext = (Button) findViewById(R.id.btnNext1);
    btnNext.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            startActivity(new Intent(Diabetes_Question_1.this, Diabetes_Question_3.class));

            int selectedId = radioDQ1Group.getCheckedRadioButtonId();

            RadioButton rb1 = (RadioButton) findViewById(selectedId);

            Toast.makeText(Diabetes_Question_1.this, rb1.getText(), Toast.LENGTH_SHORT).show();
}
    });
    }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:27:23.667

每个视图都有一个标签——一个可以保存你想要的任何数据的对象。用它来保存整数值——你可以通过 setTag() 和 getTag() 来做到这一点。然后，当您启动新活动时，将其添加到您启动的意图的附加包中。然后，新活动应该从传入的意图中读取该值。

# sql - 将表 id 从一列复制到另一列，其中列数据在表之间匹配

> ID：15509694
> 
> 赞同：0
> 
> 时间：2013-03-19T20:24:40.203
> 
> 标签：sql, sql-server

我有两张桌子，Fruits 和 Meals，Meals 中的一列是 varchar(100)，里面有水果。我正在更改它，以便该列是 Fruits 表中水果的 id，我想通过比较两个表并从水果列匹配的 fruits 表中获取 id 来设置它。

```
Table: Fruits   
id | fruit
1    apple
2    banana
3    orange

Table: Meals
id | Meal | Fruit
1    xxxx   apple
2    xxxx   apple
3    xxxx   orange
4    xxxx   banana
5    xxxx   orange
6    xxxx   orange
7    xxxx   apple 
```

我尝试了以下脚本，但出现以下错误。

```
Update product_attribute set control_caption =
(
    Select DISTINCT T1.control_caption_id from control_caption T1
    INNER Join product_attribute T2
    On T1.control_caption = T2.control_caption
    Where T1.control_caption = T2.control_caption
)

Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:29:02.580

取决于您的 RDBMS，但这应该适用于 SQL Server：

```
Update pa
set pa.control_caption = cc.control_caption_id 
From product_attribute pa
   Join control_caption cc On 
         cc.control_caption = pa.control_caption 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-13T04:59:34.683

可以简化更新查询，并且可以使用 Join 来代替运行 select 语句的子查询。

```
Update P
    Set P.Control_Caption = C.Control_Caption_ID
    From Product_Attribute P
    join Control_Caption C on C.Control_Caption= P.Control_Caption 
```

这在 SQL Server 和 Oracle 上运行。

# sql - 酒店 - 多间客房中的多个家属单次预订

> ID：15509697
> 
> 赞同：1
> 
> 时间：2013-03-19T20:24:51.157
> 
> 标签：sql, oracle

我正在尝试列出个别客人的**家属**。预订酒店时，客人可以带上朋友或孩子（家属）。但是，预订房间时，每间客房只能容纳 3 人。因此，如果客人带来 4 人，则 2 名家属将留在 102 房间，而其他 3 人将留在 103 房间。但他们在同一个预订下，假设预订 id = 2002。

我正在尝试使用 sql oracle 查询来显示某个预订的所有家属。这是我尝试过的，效果很好：

```
SELECT b.BOOKINGID,
       b.GUESTID,
       d.DEPENDANTID,
       d.FORENAME AS firstname,
       d.SURNAME AS lastname,
       br.FLOORNO,
       br.ROOMNO
FROM  BOOKING b
      LEFT JOIN BOOKINGDEPENDANT bd
      ON b.BOOKINGID = bd.BOOKINGID
      LEFT JOIN DEPENDANT d
      ON d.DEPENDANTID = bd.DEPENDANTID
      LEFT JOIN BOOKINGROOM br
      ON b.BOOKINGID = br.BOOKINGID
WHERE b.BOOKINGID = &BOOKINGID; 
```

我在上述查询中面临的问题是它能够列出所有受抚养人，但是当预订与多个房间相关联时，它会不止一次地列出他们。

例如，预订 2002 使用房间 102 和 103。因此，所有家属都与 103 相关联，包括住在 103 的人。对于 103 也是如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:43:59.257

您需要家属和房间之间的映射。您所拥有的是从预订到家属的映射以及从预订到房间的单独映射。

让我假设你有一个房间 id `BookingDependant`。如果是这样，那么该`from`子句将是：

```
FROM  BOOKING b
      LEFT JOIN BOOKINGDEPENDANT bd
      ON b.BOOKINGID = bd.BOOKINGID
      LEFT JOIN DEPENDANT d
      ON d.DEPENDANTID = bd.DEPENDANTID
      LEFT JOIN BOOKINGROOM br
      ON bd.BookingId = br.BOOKINGID and
         bd.BookingRoomId = br.BookingRoomId 
```

此构造假设在`BookingDependent`表中进行预订的单个人。

如果您没有每个受抚养人的 roomid，则从查询中删除房间：

```
SELECT b.BOOKINGID, b.GUESTID, d.DEPENDANTID,
       d.FORENAME AS firstname, d.SURNAME AS lastname
FROM  BOOKING b
      LEFT JOIN BOOKINGDEPENDANT bd
      ON b.BOOKINGID = bd.BOOKINGID
      LEFT JOIN DEPENDANT d
      ON d.DEPENDANTID = bd.DEPENDANTID
WHERE b.BOOKINGID = &BOOKINGID; 
```

您没有从房间到依赖的映射，因此没有正确的方法来产生您想要的结果。如果你想完成一个作业，那么你可能应该问另一个问题，提供表格的布局和完成作业的规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:44:49.747

您需要一种方法来查看与 BOOKINGROOM 表关联的 DEPENDENT 表。类似于 BOOKINGDEPENDENT.ROOMID = BOOKINGROOM.ID。然后像这样加入：

```
SELECT b.BOOKINGID,
       b.GUESTID,
       d.DEPENDANTID,
       d.FORENAME AS firstname,
       d.SURNAME AS lastname,
       br.FLOORNO,
       br.ROOMNO
FROM  BOOKING b
      LEFT JOIN BOOKINGDEPENDANT bd
      ON b.BOOKINGID = bd.BOOKINGID
      LEFT JOIN DEPENDANT d
      ON d.DEPENDANTID = bd.DEPENDANTID
      LEFT JOIN BOOKINGROOM br 
      ON br.ID = bd.ROOMID and ON br.BOOKINGID = b.BOOKINGID
WHERE b.BOOKINGID = &BOOKINGID; 
```

# php - PHP cURL 获取只有部分文件名的文件

> ID：15509699
> 
> 赞同：1
> 
> 时间：2013-03-19T20:24:51.750
> 
> 标签：php, http, curl, ftp

我对 cURL 库还很陌生，所以我希望解决这个问题的方法不会太简单。

基本上我有一个远程目录，可以说`http://www.something.com/dir`。在此目录中存在以下文件：

*   文件1.xml
*   文件2.xml
*   file3_active.xml

有没有办法可以将文件名与短语“活动”匹配的文件转换为字符串？该解决方案是否适用于 http 和 ftp？

**编辑**：如何在远程目录中获取文件名列表/数组？如果我能做到这一点，我可以简单地使用`strpos`，获取完整的文件名并以简单的方式使用 cURL。

许多问候，
安德烈亚斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:54:05.013

> 如何获取远程目录中的文件名列表/数组。

在我的头顶上：

1.  如果您有 FTP 访问权限，则通过 FTP dir 命令。
2.  通过远程服务器上的自定义 PHP（或其他）脚本为您生成一个机器可解析的列表。
3.  通过 shellexec/popen/ssh_exec 到 ls 或 find 等 shell 命令，通过 SSH 运行。
4.  通过从远程服务器上的 Web 服务器生成的目录列表（即，由 Apache mod_autoindex 生成）解析 HTML。

这些选项中的每一个都需要托管远程服务器的人采取一些行动——所以如果它完全超出你的控制，我认为你就是 SOL。

# objective-c - theos mobilesubstrate 调整中的 id 对象，我无法禁用它 -(id)

> ID：15509700
> 
> 赞同：-2
> 
> 时间：2013-03-19T20:24:53.563
> 
> 标签：objective-c, c, theos, cydia-substrate

```
-(id)initWithUserSettings:(id)userSettings mqttSender:(id)sender;

    NSDictionary *settings3=[[NSDictionary alloc] initWithContentsOfFile:@"/var/mobile/Library/Preferences/myfilehere.plist"];

        if ([[settings3 objectForKey:@"invisiblechat"] boolValue]){

        return NULL;

        }

        else{%orig;}

    [settings3 release];

    } 
```

我不知道这段代码是否正确，我搜索了 2 天没有答案。在 -(void) 上，此代码工作得非常好，它会一直禁用 -(void)，直到禁用 objecForKey。我想要的是通过切换保持 (id)mqttSender 禁用/启用，但我做不到。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:58:42.803

我不太确定你想从你的解释中实现什么，但如果你要初始化一个作为 NSObject 子类的类，你至少需要调用 [super init] 并返回 self，如果你不调用 init 的话方法将无法获得对该对象的引用。

将返回值设置为“void”意味着该方法不应返回任何内容，如果您设置了“id”，则“id”代表您尚未定义的值，因此它几乎可以是任何值。

使用您的方法，您正在设置“id”的返回值，这意味着您应该从该方法返回一些东西。目前，您的“if”语句中有一个 return，但之后您的方法是开放式的，并且不会返回任何内容。在这种情况下，Xcode 会抛出一个编译错误，因为你没有返回任何东西，并且它期望至少有一些东西从方法中出来，即使它是 nil。

另一件事：在定义方法/函数时，您只用分号结束方法减速，当您实现方法/函数时，您不需要分号，因为您使用包含您的代码的花括号对于该方法/功能。

# search - 检索 Google 即时数据

> ID：15509701
> 
> 赞同：0
> 
> 时间：2013-03-19T20:24:56.083
> 
> 标签：search, web-applications, visualization, google-instant

我想开发一个应用程序，将 Google Instant 的推荐可视化。这是一个课程项目，目前我对网络编程工具知之甚少。我想知道的是是否可以从另一个网页检索该数据。如果您认为可能并且在哪个平台上可能，请您指导我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T03:55:52.853

需要像 javascript 一样运行或运行 javascript 引擎或浏览器插件并与该插件通信。

当您键入时会调用一个 javascript 函数。所以你需要自己调用这个函数或者模仿它的作用。我猜它使用您输入的内容以编程方式（ajax）调用网络服务/网页表单。服务器以建议进行响应。只要谷歌意识到你不是浏览器，它就不会拒绝你，这并不难。我认为他们只喜欢 100 个免费的 API 调用，但你可以用谷歌搜索一下。

java中的Http组件将有助于调用服务，使用cookies等。您应该使用Firefox上的开发工具来查看当您在谷歌搜索栏中键入并查看代码时会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:54:55.413

如果没有有关您实际尝试做什么的更多信息，很难给出正确的答案。据我所知，您只需要 Google 搜索中的自动完成项目列表，以便随心所欲地进行操作？

[在这种情况下，使用此处](https://stackoverflow.com/questions/6428502/google-search-autocomplete-api)评分最高的答案，您可以使用[http://suggestqueries.google.com/complete/search?client=firefox&q=YOURQUERY](http://suggestqueries.google.com/complete/search?client=firefox&q=YOURQUERY)为您提供一个 JSON 对象，然后您可以对其进行操作以获得自动- 完整的结果。这`client=`部分是必需的，但我还没有看过你可以放在那里的各种选项。

就个人而言，我以前从未使用过 JSON，因此无法为您提供有关如何解析它的任何帮助，但是您可以在[JSON 网站](http://www.json.org/)和[w3 网站](http://www.w3schools.com/json/)上找到有关它的更多信息。

# switch-statement - ExpressionEngine 表中的交替行颜色

> ID：15509702
> 
> 赞同：2
> 
> 时间：2013-03-19T20:24:59.223
> 
> 标签：switch-statement, expressionengine

我有一些代码可以创建一个表，该表根据条目的行值交替行颜色。

```
<table class="authorList" cellspacing="0">
{exp:channel:entries channel="team" disable="categories|member_data|pagination" orderby="team-last-name" sort="asc"}
{if team-not-with-us != 'y'}
    <tr class="{switch="odd|even"} authorInfo">

      <th class="authorName">
        {if team-bio != ''}<a href="{site_url}about/the-team/{url_title}">{/if}
          {title}
        {if team-bio != ''}</a>{/if}
      </th>
      <td class="position">{team-position}</td>

    </tr>
{/if}
{/exp:channel:entries}
</table> 
```

问题是当我删除一个条目时，我最终会连续有两个奇数或两个偶数，留下两个并排的颜色相同的行。

虽然 switch 函数很方便，但它引用了数据库中的行数。我不相信我可以应用它来引用 if 语句中的实际行数，这可以解决我的问题。（如我错了请纠正我。）

我知道如何使用 php 进行此更改：

```
<?php $oddevenrow = 0; ?>
{if team-not-with-us != 'y'}
    <?php $oddevenrow++; ?>
    <?php ($oddeven = ($oddevenrow % 2 ? 'odd' : 'even')); ?>
    <tr class="<?php echo $oddeven; ?> authorInfo"> 
```

但是我不允许在 EE 安装中打开 PHP。

我可以在 EE 中做类似的事情吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T12:03:46.800

您正在寻找 switch 标签。

{switch="奇数|偶数"}

但看起来你已经知道了。看起来您需要将变量 team-not-with-us 设置为 != 'y'。因为您在返回结果后进行验证，所以您将以多个奇数行或偶数行彼此相邻结束。避免这种情况的简单方法是使用 channel:entries 搜索参数。示例：search:team-not-with-us="not y"

```
<table class="authorList" cellspacing="0">
{exp:channel:entries 
    channel="team" 
    disable="categories|member_data|pagination" 
    orderby="team-last-name" 
    sort="asc"
    search:team-not-with-us="not y"
}
    <tr class="{switch="odd|even"} authorInfo">

      <th class="authorName">
        {if team-bio != ''}<a href="{site_url}about/the-team/{url_title}">{/if}
          {title}
        {if team-bio != ''}</a>{/if}
      </th>
      <td class="position">{team-position}</td>

    </tr>
{/exp:channel:entries}
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T21:21:18.127

您可能想尝试在[https://expressionengine.stackexchange.com/](https://expressionengine.stackexchange.com/)上询问 EE 窥视{count} 标签应该可以工作。这只是计算（在您的情况下）在团队频道中的每个条目，并且在您的“团队不与我们”字段组中不是 Y，我假设它是一个开关或一个选择框或其他东西。

你输出的代码是什么样的？

# ruby - 从 Liquid 和 Markdown 而不是 HTML 生成 Jekyll 页面

> ID：15509703
> 
> 赞同：2
> 
> 时间：2013-03-19T20:25:05.207
> 
> 标签：ruby, markdown, jekyll, liquid

我正在使用来自 Jekyll 文档的插件部分（[https://github.com/mojombo/jekyll/wiki/Plugins#generators](https://github.com/mojombo/jekyll/wiki/Plugins#generators)）的示例生成器的略微修改版本，我很好奇是否有任何解析方法液体/降价文件而不是示例中的纯 HTML 文件？

注意这一行：

```
self.read_yaml(File.join(base, '_layouts'), 'category_index.html') 
```

该类别 index.html 文件是将在生成的文件中使用的目标文件。我的目标是能够将一个对象从我的 _config 文件传递​​给我的生成器，然后我可以使用它从 .markdown 文件构建一堆页面。有谁知道这是否可能或有任何建议来实现这一目标？我查看了用于在内部解析 markdown 的 Kramdown 库，如果必须，我不反对自己调用它，只是不确定我是否比我需要的更深入一些应该如此简单的东西。我的生成器创建的 Page 对象的 API 在这里：[http ://ruby-doc.org/gems/docs/j/jekyll-0.12.0/Jekyll/Page.html](http://ruby-doc.org/gems/docs/j/jekyll-0.12.0/Jekyll/Page.html)

非常感谢，-基思

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-10T01:27:38.173

您可以在生成器中从几乎任何您想要的数据源生成几乎任何您想要的格式，因为您正在编写具有对 Jekyll 对象模型的完全访问权限的直接 Ruby。例如，这是我前几天晚上组装的一个生成器，用于[在`jekyll build`](https://github.com/codingthewheel/codingthewheel.com/blob/master/jekyll/app/_plugins/jekyll-fetch-github.rb).

我要问的问题是：

1.  我需要一个插件来完成这个吗？
2.  如果是这样，我是否需要[Jekyll 文档](http://jekyllrb.com/docs/plugins/)中讨论的正式生成器插件？
3.  或者我应该继承、猴子补丁或以其他方式更改内置生成器的行为？

此外，在这种情况下（您可以控制 100% 生成的内容），Markdown 和 HTML 文件之间的差异大多是名义上的。`read_yaml`IIRC 实际上会从两者中阅读前面的内容，所以这不应该是一个问题。

# android - AdMob findViewById 返回 null

> ID：15509706
> 
> 赞同：2
> 
> 时间：2013-03-19T20:25:12.213
> 
> 标签：android

我正在尝试在我的第一个 Android 项目中配置 AdMod。当我尝试运行应用程序时，findViewByID 总是返回 null。

这是我的主要活动的代码：

```
import android.app.Activity;
import android.content.Context;
import android.content.res.Configuration;
import android.graphics.Bitmap;
import android.graphics.Bitmap.Config;
import android.os.Bundle;
import android.os.PowerManager;
import android.os.PowerManager.WakeLock;
import android.view.Window;

   import android.view.WindowManager;

public abstract class MyAndroidApp extends Activity {
    AdView adView;
    public static final  String MY_PUBLISHER_ID = "***********";

 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    AdRequest adRequest = new AdRequest();
    adRequest.addTestDevice(AdRequest.TEST_EMULATOR);
    adView = new AdView(this, AdSize.BANNER, MY_PUBLISHER_ID);

    //R.id.main has value, I can see it in Eclipse
    RelativeLayout mainLayout = (RelativeLayout) findViewById(R.id.main);

    if ( mainLayout == null )
        Log.d("Error","Layout is null");
    else
    mainLayout.addView(adView);

    adView.loadAd(adRequest); 
```

XML 文件（在 res\layout 下）具有以下内容：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MyApp"     
    android:id="@+id/main">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world" />
</RelativeLayout> 
```

当我调试时，我可以看到 R.id.main 的价值。但是，mainLayout 的值仍然为 null。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T20:33:27.260

问题是您没有调用`setContentView()`onCreate() 方法：

```
public void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
   setContentView(R.layout.layoutId);
   RelativeLayout mainLayout = (RelativeLayout) findViewById(R.id.main);
} 
```

没有它，你总是会得到**`NPE`**，因为 UI 元素没有创建实例（setContentView 方法的目的）并且返回的 View`findViewById()`被分配给**`NULL`**.

所以添加这一行，它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:46:15.323

`setContentView`在调用之前，应该使用适当的布局调用该方法`findViewById`。它通常在`onCreate(Bundle savedInstance)`方法中调用。

# jquery - 如何查找元素在jquery中的嵌套深度

> ID：15509707
> 
> 赞同：0
> 
> 时间：2013-03-19T20:25:13.350
> 
> 标签：jquery

说我有这样的事情：

```
<ul id='B'>
  <li>
    <ul>
      <li id='A'></li>
    </ul>
 </li>
</ul> 
```

我想知道从 ab 到我需要走多远。我想把我需要去的父母的数量作为一个数字返回。我将如何实现它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T20:30:59.467

你可以试试：

`$('#B').parentsUntil('#A').length + 1; // last 1 because we're going until '#A'`

***[演示](http://jsfiddle.net/yW2Vv/1/)***

阅读更多关于***[.parentsUntil()](http://api.jquery.com/parentsUntil/)***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:28:11.707

尝试这个：

```
var parent = $('#A').parent();
var count = 1;

while ('B' != parent.attr('id')) {
    parent = parent.parent();
    ++count;
} 
```

**演示**

[http://jsfiddle.net/yW2Vv/](http://jsfiddle.net/yW2Vv/)

# javascript - 如何使用 primefaces 在同一张纸上打印整个网页和 iFrame

> ID：15509721
> 
> 赞同：1
> 
> 时间：2013-03-19T20:25:40.957
> 
> 标签：javascript, jquery, jsf, primefaces, jqprint

使用 primefaces 在一个巨大的门户网站上工作，门户单页由两部分组成

```
- PART I - the page layout
  - header
  - sidebar
  - footer
- PART II - the main content in iframe 
```

当我使用以下代码打印此页面时：

## 按钮

```
<p:printer target="printable" /> 
```

## 目标印刷

```
<h:panelGroup id="printable">
    <div class="pageTitle">
        <h:outputText value="#{main.moduleName}" rendered="false" />
    </div>

    <div class="userData">
        <h:outputLabel id="prtalTimeStamp" value="#{main.timeStamp}"
           rendered="false" />

        <h:outputLabel value="#{main.userIdLabel}" rendered="false" />
    </div>

    <div class="iframeDiv" id="content">
        <iframe src="#{main.currentFunctionUrl}" width="100%" id="ifr"
                    frameborder="0" height="100%" onload="disableContextMenu();" onMyLoad="disableContextMenu();" scrollbar='no' marginwidth='0' marginheight='0' hspace='0' align='middle'></iframe>
    </div>
</h:panelGroup> 
```

# 问题

1- primeface 打印机 (jqprint) 无法在同一纸页中打印布局页和 iframe，在单独的页面中打印。

2-如果页面充满了内容，它只打印一页。

* * *

请帮助，使用 primefaces 或普通的 html/css/js

# python - 从脚本运行scrapy（初学者）

> ID：15509722
> 
> 赞同：2
> 
> 时间：2013-03-19T20:25:41.057
> 
> 标签：python, web-scraping, scrapy, importerror

我开始接触 python，是的，我已经在这个网站和网络上搜索了答案，但不知何故我真的无法让它运行。

我创建了一个蜘蛛类 EbaySpider，驻留在 spider/ebay.py 中，我可以从命令行毫无问题地启动它（即使输出到 JSON 文件）。现在我想从另一个 .py 文件中启动 scrapy，这样我就可以直接访问爬取的数据并将其输出到 GUI（稍后会考虑如何做到这一点）。

我已经从[这个问题](https://stackoverflow.com/questions/7993680/running-scrapy-tasks-in-python)中获取了代码（提问者代码，因为我不需要多次运行蜘蛛）并添加

```
from spiders import ebay
from scrapy.crawler import CrawlerProcess 
```

从一开始，手头就有所有必要的资源。

我得到的错误是

> ImportError：无法导入名称 ebay。

自然地，我玩弄了importstatement，将其从“ebay”更改为“EbaySpider”，将“spiders”更改为“spiders.ebay”或“projectname.spiders.ebay”，但不知何故，它们似乎都不起作用。

如果你能告诉我如何解决这个问题，或者用另一种方式运行蜘蛛然后访问我的 python 程序中的爬取数据，那就太好了。我对任何有效并且可以理解的东西感到满意:)

感谢人们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:31:10.090

您可以尝试python 的[相对导入](http://www.python.org/dev/peps/pep-0328/#rationale-for-relative-imports)功能从相对于您的 python 脚本的目录中导入模块。您无法导入模块的原因是`spiders`模块不是您的`PYTHON_PATH`.

`from .spiders import ebay`

注意：前面的**点**`spiders`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:08:02.440

基本上你有三个选择；

*   将“spiders”目录作为模块安装在您的 PYTHONPATH 中
*   将“ebay.py”文件放在与脚本相同的目录中，然后`import ebay`.
*   修改你的 python 路径，以便 python 可以找到你的蜘蛛。

对于第三个选项，您必须`__init__.py`在`spiders`目录中创建一个文件。它可以是空的。然后你必须修改你的脚本如下（假设这`spiders`是你的程序运行目录的子目录）：

```
import os
import sys
sys.path.append(os.getcwd()+'/spiders')
print sys.path
from spiders import ebay 
```

# smalltalk - 如何从 Pharo Smalltalk 中的字符串创建英国日期？

> ID：15509725
> 
> 赞同：6
> 
> 时间：2013-03-19T20:25:52.003
> 
> 标签：smalltalk, pharo

我有一些代码可以成功解析字符串以创建日期：

```
date := string asDate 
```

但这假设美国日期格式 mm/dd/yyyy。

我知道我可以将日期输出为英国格式的字符串，如下所示：

```
date printFormat: #(1 2 3 $/ 1 1) 
```

所以我的问题是，如何从英国格式日期字符串 dd/mm/yyyy 创建日期？

我检查了 String>>asDate 方法，它没有任何格式参数。查看 Date 类>>readFrom: （asDate 调用）它似乎有英国代码，但如何规定这是我想要的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T01:20:21.063

这对你有用吗？

```
Date readFrom: '04/02/2013' readStream pattern: 'dd/mm/yyyy' 
```

# iphone - 使用 CCTMXLayer 处理大型地图

> ID：15509727
> 
> 赞同：3
> 
> 时间：2013-03-19T20:26:10.150
> 
> 标签：iphone, ios, cocos2d-iphone, tmx

我只是在我的游戏中进行一些事情，并且我正在使用 CCTMXLayer 作为我的平铺背景。当我的地图是 30x30 瓷砖时，一切都很好，但我的世界大约是 500x500 瓷砖。我只会使用这样大小的地图，但它在动画过程中会严重滞后。关于处理非常大的平铺地图而没有滞后的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:41:06.130

这里有偏见：查看[Koboldtouch](http://www.learn-cocos2d.com/store/koboldtouch)，特别是[我添加了哪些功能以使 tilemaps 更有用](http://www.koboldtouch.com/display/KTD/Tilemap+Feature+List)。其中对地图大小、瓦片集、图层没有限制——只要能容纳在内存中即可。

唯一的选择是 HKTMXTiledMap。我从未真正使用过它，[论坛帖子](http://www.cocos2d-iphone.org/forum/topic/17945)充满了（未解决的？）问题。

CCTMXTiledMap 不仅速度慢，您只能创建一个单层的 128x128 瓦片地图，并且所有瓦片都设置为非空。500x500 只有在您留下足够多的空白图块时才有可能，这样您就永远不会超过地图上的 16,384 个图块。不太可能。限制性的。

# ssrs-2008 - SSRS 2008（不是 R2）导出到 PDF 作品不同于 2 个不同的服务器

> ID：15509729
> 
> 赞同：0
> 
> 时间：2013-03-19T20:26:16.503
> 
> 标签：ssrs-2008

我有一个安装了 SSRS 2008 的 QA 和一个生产服务器（不是 R2）。

在生产服务器上，我有一个报告 A。

在我的工作站上，我打开浏览器并在生产服务器上运行报告，然后将其导出为 PDF 格式。

我将相同的报告部署到 QA 服务器，访问相同的数据库。

在我的工作站上，我打开浏览器并在 QA 服务器上运行报告，然后将其导出为 PDF 格式。

来自 QA 服务器的 PDF 在不同位置有分页符。

我尝试从 QA 服务器中删除报告并重新部署它们，重新启动服务器，我什至通过浏览器从生产服务器下载了 RDL 文件，并进行了部署，但分页符仍然不同。

我查看了安装的字体，我确定了数据库

我能看到的唯一区别是 QA 服务器安装了 Microsoft SQL Server SP3，而生产服务器安装了 Microsoft SQL Server SP1。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T03:02:31.550

对于任何 QA 任务，我都会尽量匹配 Prod 环境。如果您在 QA 上运行 SP3，而在 Prod 上运行 SP1，则您使用的不是同一个软件，所以我预计输出会出现一些差异。

我要么将 QA 降级到 SP1，要么（最好）将 Prod 升级到 SP3。这可能会从 SP3 中的其他错误修复中获得其他好处。

# php - 最简单的查询出现意外的字符串错误

> ID：15509730
> 
> 赞同：1
> 
> 时间：2013-03-19T20:26:19.887
> 
> 标签：php, sql, select

我对 PHP/SQL 非常陌生，我正在尝试为我设置的数据库编写最简单的查询，但我似乎无法做到正确。我使用的语法与我在无数教程中看到的完全相同，但无论我尝试什么，它都会返回错误。

```
<?php
$con=mysqli_connect("localhost","database_user","database_user_password","tourneys_db");

SELECT * FROM Warhammerk

mysqli_close($con);
?> 
```

“Warhammerk”是我数据库中名为“tourneys_db”的表的名称。该表由 34 列和 3 行数据组成。我有一个表单设置为在单击提交按钮时执行上述代码。返回的错误如下：

> 解析错误：语法错误，第 4 行 /home/tourneys/public_html/search40ktournament.php 中的意外 T_STRING

（我知道这种查询既不是最优的也不是安全的——我只需要知道语法错误是什么）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:35:14.170

您需要连接并使用它来执行查询。见[http://www.php.net/manual/en/mysqli.query.php](http://www.php.net/manual/en/mysqli.query.php)

例如，尝试

```
<?php
$con=mysqli_connect("localhost","database_user","database_user_password","tourneys_db");

$myQuery = "SELECT * FROM Warhammerk";
$result = mysqli_query($con, $myQuery);

mysqli_close($con);
?> 
```

您必须弄清楚如何处理`$result`，但有很多关于此的教程。查看：[http ://www.php.net/manual/en/class.mysqli-result.php](http://www.php.net/manual/en/class.mysqli-result.php)

# server-side - 暗星计划（红矮星）在哪里

> ID：15509734
> 
> 赞同：2
> 
> 时间：2013-03-19T20:26:28.237
> 
> 标签：server-side, serversocket

前几天我在搜索一个开源的 actionscript 服务器端，我找到了 Project Darkstar（红矮星），我把这个名字保存在我的脑海里，等我有空的时候再回来，现在我有空了，我想下载它，但我没有找到它。

这是怎么回事？如果我找到上传的服务器，我可以将它作为我的游戏服务器端吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-16T20:47:43.840

不幸的是，RedDwarf 服务器似乎没有被积极处理。虽然它的网站 ( [http://www.reddwarfserver.org](http://www.reddwarfserver.org) ) 不再活跃，但可以在[https://github.com/reddwarf-nextgen/reddwarf](https://github.com/reddwarf-nextgen/reddwarf)找到代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-14T06:59:43.727

[Darkstar 项目](http://en.wikipedia.org/wiki/Project_Darkstar)始于 1999 年 Jeff Kesselman 的个人项目。后来它成为 Sun Microsystems 的一个研究项目，2010 年 2 月 2 日，Oracle 关闭了该项目，并创建了一个名为[RedDwarf Server](http://en.wikipedia.org/wiki/RedDwarf_Server)的社区分支。RedDwarf 服务器在 GPLv2 下分发，服务器 API 在 GPLv2 + 类路径例外下特别可用。

[github中的代码](https://github.com/reddwarf-nextgen/reddwarf)

[sourceforge 中的代码](http://sourceforge.net/projects/reddwarf/)

# c# - 关于如何在 C# 中使用“对象”的困惑

> ID：15509735
> 
> 赞同：2
> 
> 时间：2013-03-19T20:26:29.580
> 
> 标签：c#, object

所以有一个对象类，一个对象类型，一个对象就是一个类的一个实例。三者有什么区别？

例如（简化）：

```
Class Human {              //A class named 'Human'
//some code
}

Human boy = new Human();   // 'boy' is an object, or instance of the Human class. 
```

对象类和对象类型在哪里合适？“对象”一词似乎含糊不清，因为它具有 3 个含义/用途。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-19T20:34:17.803

首先，`object`和`System.Object`是同义词。这只是编写相同类型名称的两种方法。这里没有两个概念。

至于你的问题是说它`object`是一种类型并且说一个对象是一种类型的实例是否不一致：

假设我告诉你那`fish`是一种动物。然后假设我递给你一条（活）鲑鱼并说“那是一条鱼”。你会说我以两种不一致的方式使用“鱼”吗？首先我说这`fish`是*分类方案的一部分*，然后我说不，“鱼”是一种*真正的活体动物*。你会觉得这很混乱吗？是模棱两可的吗？我们是否应该有两个词，一个用于*分类方案*，一个用于*特定实例*？

我想你可能不难处理这种歧义。`fish`根据句子的上下文，您可以确定是否引用了特定的鱼或一般类别。事实上，一个类别的名称和该类别的一个实例的名称可能看起来很自然。`newspapers`如果我们用一个词来表示一般类别，而另一个词完全用于特定报纸，等等，这似乎很奇怪。

对象，同样的事情。正如“鱼”既用于表示*类别*又表示该类别*的成员*一样， “对象”也是如此。

如果有帮助，当您将对象称为实例时，请说“对象”，而当您提及类型时，请说`object`. 我就是做这个的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-19T20:29:15.957

`System.Object`是一个类，它`object`是一个别名。两者都是类型（每个类都是一个类型，但不是每个类型都是一个类）。

术语“对象”通常也指一种类型的实例。因此只有两个不同的（尽管相关的含义：.NET 类型系统中特定名称的类型名称，以及表示该类型系统中类型实例的通用术语）。

现在它变得令人困惑：

```
object o; 
```

这`o`是一个类型的*对象*`object`。天啊！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:29:33.363

首先，有`System.Object`哪个是 .NET 中所有类的基类。
其次，一个对象是一个类的实例，这意味着你有一个类，描述实例的行为（它们的方法）和它们的数据（给它们一个标识并将它们与其他实例区分开来）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T20:29:41.963

```
// 'boy' is an object, or instance of the Human class. 
```

两个都！根据[文档](http://msdn.microsoft.com/en-us/library/system.object.aspx)。

> 这是 .NET Framework 中所有类的终极基类；它是类型层次结构的根。

因此，所有类型的所有实例都是 .NET 中的对象。

此外，`object`只是一个别名`System.Object`。两者是同义词。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-19T20:30:03.483

“Object”是支持所有其他类的 C# 类。它使您可以访问一组方法，例如 GetType、Equals 和 ToString。

基本上，您的人类对象继承自“Object”类，并可以访问“Object”拥有的所有方法。

使用它作为类型（例如 int），可以让你做一些非常不明智的事情。例如，您可以创建一个数组：

```
static void Main(string[] args)
    {
        object[] array = new object[4];
        array[0] = 1;
        array[1] = "1";
        array[2] = new object();
        array[3] = new StreamWriter(@"C:\file.txt");

        foreach (object o in array)
        {
            if (o != null)
            {
                Console.WriteLine("Found an object!  It's type is: " + o.GetType());    
            }
            else
            {
                Console.WriteLine("Didn't find an object");
            }
        }
        Console.ReadLine();
    } 
```

这给了你输出 -

![在此处输入图像描述](../Images/e56e1af48e158ad36e9adc9d75db4893.png)

这为您提供了一个不共享类型的对象数组（除了对象）！绝对不是他们在学校教你的。另外，永远不要这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-19T20:30:40.920

*   A`class` *定义*实例，并且通常被称为 (with `structs`) as `Types`。这些充当这些实例的行为模板。A`Type`可以从另一个“继承”行为`Type`，这就是继承的原则。例如（也许是不好的例子）， a`Boy`是 的子*类型*。`Human`
*   实例行为由`Type`它们定义，并且（通常）使用`new`运算符创建
*   any 的所有实例`Type`也是 的实例`System.Object`，它有一个简写表示`object`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-19T20:30:57.210

.net 中有一个[Object 类](http://msdn.microsoft.com/en-us/library/system.object.aspx)，它恰好是一个名为 Object 的类。这是所有类派生的基类。这意味着定义的任何新类都可以访问 Object 类的所有成员（包括示例中的 Human 类）。

您说对象是类的实例是正确的。听起来可能很奇怪，但可以有一个`Object`类对象。示例：

```
Object o = new Object();
       ^object
^class/type 
```

命名有点混乱，但希望这是有道理的。

我一直认为类型是可以描述类或原语的术语。所以`int`或`Object`可能是类型，但不是`o`来自我的示例。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-19T20:37:40.287

类是定义对象的代码块：

```
class MyObject
{
    //Code that defines what the object is and how it behaves
} 
```

当您尝试使用在类中定义的对象时，您会得到一个“对象的实例”：

```
MyObject foo = new MyObject(); 
```

“类型”是对您正在使用的对象类型的描述。其名称位于上面“类”块的开头。

```
Console.WriteLine(foo.GetType().Name); 
```

上面的行将打印“MyObject”。

TL;DR：“类”、“对象”、“类型”在含义上都非常接近，以至于在描述代码时它们经常互换。它们中的每一个都直接与面向对象编程中的对象定义相关。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-19T20:44:09.033

对象类：支持 .NET Framework 类层次结构中的所有类，并为派生类提供低级服务。这是 .NET Framework 中所有类的终极基类；它是类型层次结构的根。

对象类型：对象类型是 .NET Framework 中 Object 的别名。在 C# 的统一类型系统中，所有类型，预定义的和用户定义的，引用类型和值类型，都直接或间接地继承自 Object。您可以将任何类型的值分配给对象类型的变量。

对象：一个对象由实例成员组成，其值使其在一组相似的对象中是唯一的。C# 代码中使用的所有对象都是对象类型。当一个对象被实例化时，它会被分配一块内存并根据对象底层类提供的蓝图进行配置。

主要来自msdn。你应该检查一下：http: [//msdn.microsoft.com/en-us/library/67ef8sbd.aspx](http://msdn.microsoft.com/en-us/library/67ef8sbd.aspx)

希望能帮助到你。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-19T21:54:10.450

将每个类类型的存储位置（类型的变量`object`或任何其他类类型都符合此条件）视为保存“对象 ID”而不是保存对象可能会有所帮助[术语“引用”具有多种含义; 术语“对象 ID”将避免这种歧义]。因为对于对象 ID 并不能做很多事情，但是对于 ID 所引用的对象可能需要做很多事情，在许多 .net 语言中，将`.`运算符应用于对象 ID 将访问成员由*该 ID 引用的对象*。

请注意，对象 ID 没有文本表示，但从概念上讲，为它们分配任意数字可能很有用。假设`Car`是一个类类型，并且`FordFocus`是一个派生自它的类类型。一份声明

```
Car Fred = new FordFocus(); 
```

将选择一个未使用的对象 ID（假设它选择 #42），使用该 ID 生成 FordFocus 类的新实例，并将该 ID 存储在`Fred`. 请注意，`Fred`不能也不拥有 的实例`FordFocus`，也不拥有 的实例`Car`。相反，它可以保存的只是一个对象 ID，如果它标识任何内容，则可以保证标识其中一个实例`Car`或从其派生的类；在这种特殊情况下，它拥有#42。如果代码然后说：

```
Object Barney = Fred; 
```

代码将检查任何可能存储在 Fred 中的对象 ID 是否可以安全地存储在 Barney 中，确定它可以，然后继续将 Barney 设置为 #42。

如果代码然后说

```
Fred.Color = Blue; 
```

代码实际上不会影响`Fred`（它在语句之前保留“#42”，并将继续保留“#42”），但它会影响对象#42——把它变成一辆蓝色的汽车。

那时，如果代码说：

```
Fred = new HyundaiSonata(); 
```

系统将生成一个新 ID（例如 #57），使用该 ID 创建一个 HyundaiSonata 实例，并将 #57 存储到 Fred 中。该语句将覆盖 Fred 中的值（它曾经包含 #42，但现在它包含 #57），但它不会影响 Object #42（它仍然是蓝色的 FordFocus）。

# mysql - 您如何优化来自“高级搜索表单”的查询？

> ID：15509736
> 
> 赞同：0
> 
> 时间：2013-03-19T20:26:32.543
> 
> 标签：mysql, query-optimization

一般来说，当有这么多不同的可能性、列、表、结果等时，如何优化从具有 20-30 个可选字段的“高级搜索表单”生成的 MySQL 查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:35:26.140

一般来说，它们不会从数据库中返回。对于具有许多字段选项的高级搜索，可能还会从搜索服务器（如[Lucene](http://lucene.apache.org/core/)、[Sphinx](http://sphinxsearch.com/)或[Xapian](http://xapian.org/) ）返回一些布尔逻辑以进行良好测量。

从数据库返回几乎是不可能有效的。它通常通过动态构建查询来完成，例如：

```
SELECT ... WHERE 1=1 
```

然后，循环遍历其他字段并添加

```
AND field LIKE '%abc'
AND field_2 LIKE '%def%'
AND field LIKE 'GHI%' 
```

`%`如果可能（出于性能原因），最好在开始或结束时添加 whildchar ，或者同时在字段数据中进行搜索。

构建和运行此查询几乎不可能拥有良好的索引，这使它们变慢并且成为性能瓶颈的主要候选者。

# android - 页面转换不起作用（jquery mobile 1.3.0 和 phonegap 2.3）

> ID：15509740
> 
> 赞同：0
> 
> 时间：2013-03-19T20:26:38.290
> 
> 标签：android, jquery, cordova, jquery-mobile

**使用（jquery mobile 1.3.0 和 phonegap 2.3）页面转换不起作用我正在使用 jquery mobile 1.3 和 phonegap 2.3 构建应用程序，并且我有类似按钮**

```
 <a href="#page2" data-role="button" data-theme="e" data-transition="slide">Start</a> 
```

使用 data-transition="slide" 我为 android 构建它，但我尝试过的转换不起作用

```
 .ui-page {-webkit-backface-visibility:hidden} 
```

但它没有用。

有什么帮助吗？！！！

**注意：它在浏览器上运行良好，但是在我使用 phonegap 构建它之后，它会转到第二页，但过渡不是“幻灯片”，它只是闪烁然后第二页显示！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T04:18:33.697

我在[JSfiddle](http://jsfiddle.net/Qu27A/)中做了一个有 2 页的示例应用程序，它可以正常工作。你可以自己检查一下。

我想你搞砸`Page ID`了`Content ID`。您在锚标签中给出的标签应该是页面的 ID 而不是内容 div 的 ID。

这是工作示例。

```
<!-- Start of first page -->
<div data-role="page" id="page1">
    <div data-role="header">
            <h1>Page1</h1>

    </div>
    <!-- /header -->
    <div data-role="content">
        <p>I'm first in the source order so I'm shown as the page.</p> <a href="#page2" data-role="button" data-transition="slide">Page2</a>

    </div>
    <!-- /content -->
    <div data-role="footer">
            <h4>Page Footer</h4>

    </div>
    <!-- /footer -->
</div>
<!-- /page -->
<!-- Start of second page -->
<div data-role="page" id="page2">
    <div data-role="header">
            <h1>Page2</h1>

    </div>
    <!-- /header -->
    <div data-role="content">
        <p>I'm the second in the source order so I'm hidden when the page loads. I'm just shown if a link that references my id is beeing clicked.</p>  <a href="#page1" data-role="button">Back to Page1</a>

    </div>
    <!-- /content -->
    <div data-role="footer">
            <h4>Page Footer</h4>

    </div>
    <!-- /footer -->
</div>
<!-- /page --> 
```

# php - PHP多选表单在MySQL中插入多行

> ID：15509742
> 
> 赞同：1
> 
> 时间：2013-03-19T20:26:41.530
> 
> 标签：php, mysql

我有以下代码用于使用 PHP 将记录插入 MySQL 数据库。表单元素是一个多重选择，当只选择一个选项时可以正常工作。当我选择超过 1 个选项时，只插入最后一个选项。如何让表单为多选中选择的每个选项创建一个新行？

```
if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "InsertForm")) {
  $insertSQL = sprintf("INSERT INTO emplikons (EmpNo, IconId) VALUES (%s, %s)",
                       GetSQLValueString($_POST['insertRecordID'], "text"),
                       GetSQLValueString($_POST['icons'], "int"));

  mysql_select_db($database_techsterus, $techsterus);
  $Result1 = mysql_query($insertSQL, $techsterus) or die(mysql_error()); 
```

这是表单元素的代码。它使用记录集从另一个表中动态提取值：

```
<select name="icons" size="10" multiple="multiple">
            <?php
do {  
?>
            <option value="<?php echo $row_icons['id']?>"><?php echo $row_icons['name']?></option>
            <?php
} while ($row_icons = mysql_fetch_assoc($icons));
  $rows = mysql_num_rows($icons);
  if($rows > 0) {
      mysql_data_seek($icons, 0);
      $row_icons = mysql_fetch_assoc($icons);
  }
?>
          </select> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T20:56:25.013

添加`[]`到选择的名称，以获取所有选定值的数组。

```
<select name="icons[]" size="10" multiple="multiple"> 
```

然后，从`$_POST / $_GET`...中读取（假设`form method="post"`）

```
$sql = '';
foreach ($_POST['icons'] as $icon) {

    // no idea where to get EmpNo from, let's assume it is in $empno.
    $sql .= "('$empno','$icon'),";

}

$sql = "INSERT INTO tablename (EmpNo, IconId) VALUES " . trim($sql,',');

// Now, please use mysqli_* or PDO instead of mysql_* 
```

# vmware - PowerCLI 来安排 VM 硬件更新？

> ID：15509744
> 
> 赞同：0
> 
> 时间：2013-03-19T20:26:44.727
> 
> 标签：vmware, powercli

有人知道我可以运行一个脚本来在我的服务器上按计划时间安装 vmx-09 吗？

我有许多服务器需要升级，大多数只能在几个小时后关闭。因为我最好在早上进来之前完成这些，所以我想安排在早上 7 点左右。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-07-15T11:40:44.510

这将在下次重新启动时升级硬件兼容性：

```
$Spec = [VMware.Vim.VirtualMachineConfigSpec]@{
    ScheduledHardwareUpgradeInfo = [VMware.Vim.ScheduledHardwareUpgradeInfo]@{
        UpgradePolicy = 'always'
        VersionKey = 'vmx-10'
    }
}
$vm.ExtensionData.ReconfigVM_Task($Spec) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:32:34.410

[该](http://ict-freak.nl/2009/07/15/powercli-upgrading-vhardware-to-vsphere-part-2-vms/)脚本显然使用[UpgradeVM_Task](http://pubs.vmware.com/vsphere-51/index.jsp?topic=/com.vmware.wssdk.pg.doc/PG_VM_Config.12.10.html)方法来定位硬件 v7。我没试过。

如果您使用的是 Windows 任务计划程序，[这里](http://www.virtu-al.net/2009/07/10/running-a-powercli-scheduled-task/)有两种方法来计划 PowerCLI 任务。

[更新管理器](http://pubs.vmware.com/vsphere-51/index.jsp?topic=/com.vmware.vsphere.upgrade.doc/GUID-81FDD2AE-6E89-490E-9376-C7523C4DEFF8.html)听起来像是[另一件事](http://communities.vmware.com/message/2209442)要检查。

# objective-c - 在objective-c中是否有任何简单的方法可以在特殊字符前添加反斜杠？

> ID：15509745
> 
> 赞同：2
> 
> 时间：2013-03-19T20:26:46.290
> 
> 标签：objective-c, nsfilemanager, nstask

**注意：不知道为什么这被标记为重复，因为我明确表示我不想一遍又一遍地使用 stringByReplacingOccurrencesOfString。**

我对特殊字符文件名有疑问。

我已经实现了一个程序，这样当你打开一个或多个文件时，程序会读取所有这些文件名和本地路径并将它们存储到 NSMutableArray 中。这部分工作完美，没有问题。

我的程序还需要使用 NSTask 来操作这些文件。但是，问题是，有时文件名会包含特殊字符，例如 `/Users/josh/Desktop/Screen Shot 2013-03-19 at 2.05.06 PM.png`.

我必须用反斜杠和空格替换空格

```
NSString *urlPath = [[self url] path];
urlPath = [urlPath stringByReplacingOccurrencesOfString:@"(" withString:@"\\("];
urlPath = [urlPath stringByReplacingOccurrencesOfString:@")" withString:@"\\)"];
urlPath = [urlPath stringByReplacingOccurrencesOfString:@" " withString:@"\\ "]; 
```

到：`/Users/josh/Desktop/Screen\ Shot\ 2013-03-19\ at\ 2.05.06\ PM.png`

这样我就可以正确操作文件。

`(`和相同`)`。在此之前我还需要添加反斜杠。

但是特殊字符太多了。IE。

```
/Users/josh/Desktop/~!@#$?:<,.>%^&*()_+`-={}[]\|'';.txt 
```

我需要更改为：

```
/Users/josh/Desktop/\~\!@\#\$\?\:\<\,.\>\%^\&\*\(\)_+\`-\=\{\}\[\]\\\|\'\'\;.txt 
```

更不用说其他特殊字符（即重音）

**有什么简单的方法可以在每个特殊字符前面加上反斜杠，因为我不想`stringByReplacingOccurrencesOfString`一遍又一遍地打电话。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:56:37.733

我想你也许可以使用`NSRegularExpressionSearch`搜索。

它看起来像这样

```
+ (NSString *) addBackslashes: (NSString *) string
{
    // First convert the name string to a pure ASCII string
    NSData *asciiData = [string dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];

    NSString *asciiString = [[[NSString alloc] initWithData:asciiData encoding:NSASCIIStringEncoding] lowercaseString];

    // Define the characters that we will replace
    NSString *searchCharacters = @"PUT IN ALL OF YOUR SPECIAL CHARACTERS HERE";
    // example NSString *searchCharacters = @"!@#$%&*()";

    // replace them
    NSString *regExPattern = [NSString stringWithFormat:@"[%@]", searchCharacters];

    string = [asciiString stringByReplacingOccurrencesOfString:regExPattern withString: [NSString stringWithFormat:@"\\%@", regExPattern] options:NSRegularExpressionSearch range:NSMakeRange(0, asciiString.length)];
    return string;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T21:05:57.160

如`NSTask`该方法的文档中所述[`setArguments:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSTask_Class/Reference/Reference.html#//apple_ref/occ/instm/NSTask/setArguments%3a)，不需要进行特殊引用：

> **讨论**
> 
> 该`NSTask`对象在将*路径*和 *参数*中的字符串通过`argv[]`. *参数*中的字符串不进行 shell 扩展，因此您不需要做特殊的引用，并且 shell 变量，例如`$PWD`，不会被解析。

如果您觉得有必要，您能否提供一些您想在 ? 中运行的命令的示例`NSTask`？

[更新]：我在评论中看到您确实在使用`NSTask`来执行`bash`shell `-c`，这是我想知道的。我通常习惯于`NSTask`直接执行命令，而不是通过 shell，如下所示：

```
NSTask *task = [[NSTask alloc] init];
[task setLaunchPath:@"/bin/ls"];
[task setArguments:[NSArray arrayWithObjects:@"-l", self.url.path, nil]]; 
```

你能给出一个更准确的例子来说明你想要运行的实际命令吗？例如，您是否将一系列命令连接在一起？也许可能有另一种方法可以在不需要使用`bash`外壳的情况下实现相同的结果......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:58:19.787

您可以维护一组需要转义的字符串，并使用 NSScanner 通过迭代源字符串来构建新字符串，每次发现有问题的字符时，您首先添加`\\`到目标字符串并继续处理下一个字符。

```
NSString *sourceString = @"/Users/josh/Desktop/\"Screen Shot\" 2013-03-19 at 2\\05\\06 PM.png";
NSMutableString *destString = [@"" mutableCopy];
NSCharacterSet *escapeCharsSet = [NSCharacterSet characterSetWithCharactersInString:@" ()\\"];

NSScanner *scanner = [NSScanner scannerWithString:sourceString];
while (![scanner isAtEnd]) {
    NSString *tempString;
    [scanner scanUpToCharactersFromSet:escapeCharsSet intoString:&tempString];
    if([scanner isAtEnd]){
        [destString appendString:tempString];
    }
    else {
        [destString appendFormat:@"%@\\%@", tempString, [sourceString substringWithRange:NSMakeRange([scanner scanLocation], 1)]];
        [scanner setScanLocation:[scanner scanLocation]+1];
    }
}

NSLog(@"\n%@\n%@", sourceString, destString); 
```

结果：

```
/Users/josh/Desktop/Screen Shot 2013-03-19 at 2.05.06 PM.png
/Users/josh/Desktop/Screen\ Shot\ 2013-03-19\ at\ 2.05.06\ PM.png 
```

# visual-c++ - 创建指向大量分配的一维数组的子数组的指针并发布 VC++ 构建

> ID：15509747
> 
> 赞同：1
> 
> 时间：2013-03-19T20:26:53.623
> 
> 标签：visual-c++, compiler-optimization, dynamic-allocation, release-mode

这是我的第一篇文章，希望我没有犯任何错误。我有以下代码。我试图一次性分配和访问一个二维数组，更重要的是在一个字节数组中。我还需要能够单独访问每个子数组，如代码所示。它在调试模式下工作正常。尽管在 VS 2012 的发布版本中，当应用编译器优化时，它会在运行时引起一些问题。如果我禁用发布编译器优化，那么它可以工作。我需要做一些特殊的演员来通知编译器吗？

我在代码中的优先级是完整数组的快速分配和网络通信，同时使用它的子数组。

我不喜欢使用boost。

非常感谢 ：）

```
void PrintBytes(char* x,byte* data,int length)
{
    using namespace std;
    cout<<x<<endl;
    for(  int i = 0; i < length; i++ )
    {
        std::cout << "0x" << std::setbase(16) << std::setw(2) << std::setfill('0');
        std::cout << static_cast<unsigned int>( data[ i ] ) << " ";
    }
    std::cout << std::dec;
    cout<<endl;
}

byte* set = new byte[SET_SIZE*input_size];
for (int i=0;i<SET_SIZE;i++)
{
    sprintf((char*)&set[i*input_size], "M%06d", i+1);
}
PrintByte((byte*)&set[i*input_size]); 
```

# css - 移动设备和桌面上的 img（响应式设计）

> ID：15509749
> 
> 赞同：0
> 
> 时间：2013-03-19T20:26:59.870
> 
> 标签：css, mobile, responsive-design, image, desktop

幻灯片图像在移动设备上正确缩放（响应式）但是当我在桌面上调整窗口大小时我不希望它们缩小

* * *

```
.slideshow-wrapper{
      width:100%;
      max-width:980px; //this is the original width of image
}
#slideshow{
 clear:both;
 z-index:-5;
 width:100%;
}
#slideshow img{
 width:100%;
 height:auto;
} 
```

* * *

```
 jQuery.each(slideArray, function(index,value) {  $("<img src='img/slides/"+value+"'   
 width='980' height='450'>").appendTo("#slideshow");
 }); 
```

* * *

```
<div class="slideshow-wrapper">
 <div id="slideshow"> &nbsp; </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:49:14.277

这是检测移动用户的轻量级解决方案：[https ://code.google.com/p/php-mobile-detect/](https://code.google.com/p/php-mobile-detect/)

您可以使用它来加载两个不同的 CSS 文件。一种带有响应图像，一种带有静态图像。希望有帮助。

# android - android中的JSON请求不起作用

> ID：15509752
> 
> 赞同：1
> 
> 时间：2013-03-19T20:27:10.330
> 
> 标签：android, json, web-services, rest

我在 asp.net 中创建了一个 Web 服务，它接收以下 url：

```
http://localhost:31804/api/defaultapi/login?empNum=123456&surname=Yusuf 
```

并发送以下 json {"$id":"1","EmployeeID":2,"Firstname":"Abayomi","Surname":"Yusuf","DepartmentID":1,"EmployeeNumber":"123456" }

这适用于我的浏览器。

现在我正在尝试在我的 android 应用程序中使用该 Web 服务。我是一个初学者，我在这里使用 Andrew Barber 创建的 JSON 解析器类[How to parse JSON in Android](https://stackoverflow.com/questions/9605913/how-to-parse-json-in-android) (last comment)

```
public class JSONParser {
static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

// constructor
public JSONParser() {

}

public JSONObject getJSONFromUrl(String url) {

// Making HTTP request
try {
    // defaultHttpClient
    DefaultHttpClient httpClient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost(url);

    HttpResponse httpResponse = httpClient.execute(httpPost);
    HttpEntity httpEntity = httpResponse.getEntity();
    is = httpEntity.getContent();

} catch (UnsupportedEncodingException e) {
    e.printStackTrace();
} catch (ClientProtocolException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
}

try {
    BufferedReader reader = new BufferedReader(new InputStreamReader(
            is, "iso-8859-1"), 8);
    StringBuilder sb = new StringBuilder();
    String line = null;
    while ((line = reader.readLine()) != null) {
        sb.append(line + "\n");
    }
    is.close();
    json = sb.toString();
} catch (Exception e) {
    Log.e("Buffer Error", "Error converting result " + e.toString());
}

// try parse the string to a JSON object
try {
    jObj = new JSONObject(json);
} catch (JSONException e) {
    Log.e("JSON Parser", "Error parsing data " + e.toString());
}

// return JSON String
return jObj;

}
} 
```

这就是我在代码中使用它的方式。按钮具有 loadHome 方法作为其 onClick 事件

```
public class Main extends Activity {

private SharedPreferences employeeDetails;

private static final String EMP_ID = "EmployeeID";
private static final String EMP_NAME = "Firstname";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.login);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

public void loadHome(View view)
{
    EditText empNumEditText = (EditText)findViewById(R.id.employeeNumEditText);
    EditText surnameEditText = (EditText)findViewById(R.id.surnameEditText);
    TextView empNumError = (TextView)findViewById(R.id.empNumWarningTextView);
    TextView surnameError = (TextView)findViewById(R.id.surnameWarningTextView);
    TextView displayError = (TextView)findViewById(R.id.errorTextView);

    String employeeNumber = empNumEditText.getText().toString();
    String surname = surnameEditText.getText().toString();

    //ensure that the form was completed
    if((employeeNumber.length()>0) && (surname.length()>0))
    {
        try{
            String encodedEmployeeNumber = URLEncoder.encode(employeeNumber, "UTF-8");
            String encodedSurname = URLEncoder.encode(surname, "UTF-8");

            String loginURL = "localhost:31804/api/defaultapi/login?empNum=" + encodedEmployeeNumber + "&surname=" + encodedSurname;

            // Creating JSON Parser instance
            JSONParser jParser = new JSONParser();

            // getting JSON string from URL
            JSONObject json = jParser.getJSONFromUrl(loginURL);
            String empId = json.getString(EMP_ID);
            String empSur = json.getString(EMP_NAME);

            displayError.setText(empSur);
            }
        catch(Exception e){
            displayError.setText("Whoops - something went wrong!");
            e.printStackTrace();
        }

    } 
    else //display error messages
    {
        if (employeeNumber.length()>0){
            empNumError.setText(" ");
        }else{
            empNumError.setText("Enter Your Employee Number");
        }

        if (surname.length()>0){
            surnameError.setText(" ");
        }else{
            surnameError.setText("Enter Your Surname");
        }
    }

} 
```

我在 displayError textView 中不断收到错误消息（“哎呀 - 出了点问题！”）。我究竟做错了什么。

这是堆栈跟踪的链接 [http://3.bp.blogspot.com/-jJnZ71KC5ZM/UUjVQhbzKCI/AAAAAAAAAMk/v9j_bhIkOEg/s1600/1.jpg](http://3.bp.blogspot.com/-jJnZ71KC5ZM/UUjVQhbzKCI/AAAAAAAAAMk/v9j_bhIkOEg/s1600/1.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T09:51:43.310

我创建了一个库，我在过去一年中与所有与我一起工作的开发人员一起使用过。随意从 github 克隆它。尝试一下，看看它是否可以帮助您完成休息请求。

[https://github.com/darko1002001/android-rest-client](https://github.com/darko1002001/android-rest-client)

它可以帮助您处理请求的异步执行，并在带有线程池的单独服务中执行它们以管理并发连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T23:17:21.923

除非我遗漏了什么，否则您的问题可能出在您的网址中。你指定

```
String loginURL = "localhost:31804/api/defaultapi/login?empNum=" + encodedEmployeeNumber + "&surname=" + encodedSurname; 
```

主机名“localhost”应始终解析为 127.0.0.1。任何 127.xxx 地址都应指向您的本地堆栈...因此，如果您在手机上运行，​​这将是您的手机。根据您的配置，在 AVD 中运行时它可能是您的 AVD。尝试将其更改为可路由端口，看看是否有所不同。

如果您在 Windows 上，请转到命令提示符并使用：

```
ipconfig 
```

查找您的 LAN 适配器并使用 IPv4 地址而不是“localhost”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-09T12:48:31.037

```
String response = performRequestAsString(MY_URL, "GET");
Log.v("REsponse from web server",response); 
```

// 把它放在下面

```
public static String performRequestAsString(String url, String method) 
{
    String value = null;

    try {

        if (method == "POST") {
            DefaultHttpClient httpClient = new DefaultHttpClient();
            Log.e("Request_Url", "" + url);
            HttpPost httpPost = new HttpPost(url);              
            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            InputStream is = httpEntity.getContent();
            value = convertStreamToString(is);

        } else if (method == "GET") {
            DefaultHttpClient httpClient = new DefaultHttpClient();
            Log.e("Request_Url", "" + url);
            HttpGet httpGet = new HttpGet(url);
            HttpResponse httpResponse = httpClient.execute(httpGet);
            HttpEntity httpEntity = httpResponse.getEntity();
            InputStream is = httpEntity.getContent();
            value = convertStreamToString(is);
        }

    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        // e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return value;
} 
```

// 用于访问 WebAPI

```
new GetData().execute();

private class GetData extends AsyncTask<String, String, String> {
        private ProgressDialog progressDialog;
        private String response = "";
        private JSONArray jRootArray;

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            progressDialog = new ProgressDialog(mContext);
            progressDialog.setMessage("Loading ...");
            progressDialog.setIndeterminate(false);
            progressDialog.setCancelable(false);
            progressDialog.show();

        }

        @Override
        protected String doInBackground(String... args) {

            response = WebAPIRequest.performRequestAsString(MY_URL, "GET");

            runOnUiThread(new Runnable() {
                @Override
                public void run() {

                    if (response == null) {

                        Toast.makeText(mContext, "Please Try Again",
                                Toast.LENGTH_SHORT).show();
                    } else {

                    }

                }
            });
            return null;
        }

        @Override
        protected void onPostExecute(String args) {
            progressDialog.dismiss();

        }
    } 
```

# css - 显示 块中的元素正确

> ID：15509753
> 
> 赞同：-2
> 
> 时间：2013-03-19T20:27:13.493
> 
> 标签：css

**大家好！我想问我应该如何在块中显示 p 元素**

我有代码：[jsFiddle](http://goo.gl/aGFnr)，我不知道为什么即使在子块底部之后 HTML 也会显示它？它应该靠近其他元素向左移动，但它会继续移动到脚。如何解决？

对不起我的英语不好，但我希望你能理解并帮助我。

*   红色边框仅用于调试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:29:36.697

你在考虑内联块吗？display block 已经是 p 标签默认做的了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:39:44.577

我不知道我的问题是否正确，如果您想将所有标签放在一行中，请尝试此[演示](http://jsfiddle.net/qZnBE/11/)

```
 div#content div.layout a{
   display: block;
   width: 50px;
   height: 50px;
   border: 1px solid red;
   float:left;
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:48:18.590

尝试同时使用列和内联块：

[http://jsfiddle.net/qZnBE/13](http://jsfiddle.net/qZnBE/13)

```
div#content {
    background: rgba(0, 0, 0, 0.47);
    width: 400px;
    height: 200px;
    margin: 0 auto;
}
div#content div.layout {
    columns:5px 4;
    -webkit-columns:5px 4;
    /* Safari and Chrome */
    -moz-columns:5px 4;
    /* Firefox */
    width: 390px;
    height: 190px;
    margin: 0 auto;
    border: 1px solid red;
    float: left;
}
div#content div.layout p {
    display: inline-block;
    width: 50px;
    height: 50px;
    border: 1px solid red;
    margin: 0;
}

<div id="content">
    <div class="layout">
        <p>one</p>
        <p>two</p>
        <p>three</p>
        <p>four</p>
        <p>five</p>
    </div>
</div> 
```

请注意，IE < 10 不支持 CSS 列。[http://caniuse.com/multicolumn](http://caniuse.com/multicolumn)

# java - 插入 400 次（左右）后 JPA 插入失败 - 事务错误

> ID：15509754
> 
> 赞同：0
> 
> 时间：2013-03-19T20:27:13.653
> 
> 标签：java, hibernate, jpa, transactions, jboss7.x

更新：似乎在插入 #412 后，它在数据库级别的非空约束失败了。事务可能正在回滚。鉴于此设置，是否有可能建立新的交易？

我正在尝试在我的 oracle 数据库中插入很多行，并且 JPA 工作得很好，直到大约第 400 次插入。我希望有几千行要插入。

这是我的伪代码（为清楚起见而缩短）和 persistence.xml：

```
@Stateless
public class LocalContentService
{
    @Inject EntityManager em;

    public void mySavingMethod(){
        for(Foo foo : fooDao.fetchAllFoos()){
            Bar bar = new Bar(foo);

            em.persist(bar);
            em.flush();
            em.clear();
            log.debug("Saved content for: " + bar.getId());
        }
    }

<persistence-unit name="databaseTest" >
    <jta-data-source>java:/jdbc/testDS</jta-data-source>
        <exclude-unlisted-classes>true</exclude-unlisted-classes>
        <class>org.myorg.Bar</class>
        <properties>
            <property name="hibernate.dialect" value="org.hibernate.dialect.Oracle10gDialect" />
            <property name="hibernate.show_sql" value="false" />
            <property name="hibernate.format_sql" value="false" />
            <property name="hibernate.use_sql_comments" value="true" />
        </properties>
    </persistence-unit> 
```

大约 400 行后，我收到此错误消息，并且所有后续插入都失败：

> 错误 [stderr] (http--127.0.0.1-8080-1) javax.persistence.TransactionRequiredException: JBAS011469: 执行此操作需要事务（使用事务或扩展持久性上下文）

所以我的问题是双重的

1) 在这个过程中，我的交易到底发生了什么？可以避免吗？

2）有没有更好的方法来进行像这样的批量插入（请记住，我正在加载一堆 Foo，它们需要在持久化之前转换为 Bar。

我在 jBoss 7.1.1.Final AS 和 hibernate-jpa-2.0-api 中运行

# sql-server - 消除嵌套选择中的额外行

> ID：15509756
> 
> 赞同：0
> 
> 时间：2013-03-19T20:27:20.857
> 
> 标签：sql-server, select, nested, duplicate-removal

我正在尝试按月获取指定范围内的特定 UserRating。当我在下面使用它时，它可以工作，没有额外的行：

```
Select 

Distinct(Table2.AccountNumber), 

Jan11=Case 
When Datepart(yy,Org.Billdate)=2011 and Datepart(mm,Org.Billdate) = 01 then         Table2.UserRating
    END

From (

Select Distinct(Table1.AccountNumber) as UseThisNumber, Table1.RegionID as UseThisRegionID

From AccountDetail Table1 
Where Table1.RegionID in (  

Select Distinct(Reg.RegionID) 
From RegionOrganizationTable Reg  where Datepart(yy,Reg.Billdate)=2011 and         Datepart(mm,Reg.Billdate) = 01) and
    Table1.UserRating in (‘Very Satisfied’, ‘Mostly Satisfied, ‘Satisfied’)
    Group by Table1.AccountNumber, Table1.RegionID) GroupedValues, 

AccountDetail Table2
RegionOrganizationTable  Org

Where Table2.AccountNumber =GroupedValues.UseThisNumber 
and Table2 UseThisRegionID=GroupedValues.UseThisRegionID
and Org.RegionID= GroupedValues.UseThisRegionID

Order by Table2.AccountNumber 
```

但是，当我将嵌套组件中的 Datepart 条件更改为：

```
Datepart(yy,Reg.Billdate)>2010 
```

（因为这确实是我要检查的日期范围），并删除：

```
Datepart(mm,Reg.Billdate)=01 
```

从 2011 年 1 月起，所有之前符合条件的 AccountNumbers 都会重复，但返回 NULL 值。当我添加其他月份时，情况会更加复杂（即 Feb11=Case when....）

以下是第一种情况下的输出：

AccountNumber .....Jan11
123456 ......................非常满意
143457 ......................大部分满意
163458 ............满意
183459 ............非常满意
203460 ...... ..............非常满意

这是第二个（我在这里**加粗**了重复项以便于识别）

AccountNumber .....Jan11
**123456 ............非常满意
123456 ............NULL**
123499............空
133499............空
**143457....... ............大部分满足
143457............NULL**
143499............ .....NULL
153499............NULL
**163458............NULL
163458。 ......................满足**
173458............NULL
173499............ ..........NULL
**183459 ............非常满意
183459 ...... ...空**
183499 ....空
193459 ....空
**203460 ... ................NULL
203460..........................很满意**

# rest - 有没有办法只记录在 Spring 中因内部服务器错误而失败的 REST 请求主体

> ID：15509760
> 
> 赞同：0
> 
> 时间：2013-03-19T20:27:28.157
> 
> 标签：rest, spring-aop

我正在尝试记录出现某种内部服务器错误时失败的 REST 服务（POST 请求正文）的请求正文。我不想记录所有请求正文，因为这会占用我的磁盘上的大量内存。

异常发生在 dao 层的某处（如 Key 约束或某种未处理的异常），我无法访问整个请求。

我尝试使用一些 aop 建议（抛后），但我无法记录所需的信息。

有人可以建议一种需要遵循的方法来记录请求正文。

我使用 RESTful(javax.ws.rs) 网络服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:43:11.007

由于没有给出回应，我最终使用了一个过滤器[http://static.springsource.org/spring-framework/docs/3.2.0.M2/api/org/springframework/web/filter/AbstractRequestLoggingFilter.html](http://static.springsource.org/spring-framework/docs/3.2.0.M2/api/org/springframework/web/filter/AbstractRequestLoggingFilter.html)

# excel - Excel CustomUI 功能区布局

> ID：15509769
> 
> 赞同：4
> 
> 时间：2013-03-19T20:27:58.080
> 
> 标签：excel, ribbon

我正在尝试为 excel 创建一个自定义功能区，其中包含如下图所示的组。（2 行按钮，下方有一个下拉框）。

![期望结果的例子](../Images/b3a3288dfef23fa16453cf9b63ec5520.png)

我开始认为它不能完全按照我的意愿完成。

我尝试了几种不同的方法（其中一种如下），但它们都产生相同的输出。3 列，2x2 按钮，第三列中带有下拉框。

有谁知道这是否可能？

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<customUI onLoad="Ribbon.onLoad" xmlns="http://schemas.microsoft.com/office/2006/01/customui">
   <ribbon>
      <tabs>
         <tab id="toolRibbon" label="redacted">
            <group id="groupDocument" label="Secret Document">
               <box id="z" boxStyle="vertical">
                  <box id="a" boxStyle="horizontal">
                     <box id="aa" boxStyle="vertical">
                        <button id="aaa" label="AAA" />
                        <button id="aab" label="AAB" />
                     </box>
                     <box id="ab" boxStyle="vertical">
                        <button id="aba" label="ABA" />
                        <button id="abb" label="ABB" />
                     </box>
                  </box>
                  <comboBox id="b" label="Looms">
                     <item id="ba" label="BA" />
                     <item id="bb" label="BB" />
                     <item id="bc" label="BC" />
                  </comboBox>
               </box>
            </group>
         </tab>
      </tabs>
   </ribbon>
</customUI> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T22:01:14.413

在更彻底地查看可用控件后，我发现`buttonGroup`它允许我并排放置按钮。

现在把它们做成合适的尺寸..

```
<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui">
   <ribbon>
      <tabs>
         <tab id="toolRibbon" label="redacted">
            <group id="groupDocument" label="Specia; Document">
               <buttonGroup id="a">
                  <button id="aa" label="AA"/>
                  <button id="ab" label="AB"/>
               </buttonGroup>
               <buttonGroup id="b" >
                  <button id="ba" label="BA"/>
                  <button id="bb" label="BB"/>
               </buttonGroup>
               <comboBox id="c" label="Looms">
                  <item id="ca" label="ca"/>
                  <item id="cb" label="cb"/>
                  <item id="cc" label="cc"/>
               </comboBox>
            </group>
         </tab>
      </tabs>
   </ribbon>
</customUI> 
```

# java - 使用java运行风扇

> ID：15509774
> 
> 赞同：0
> 
> 时间：2013-03-19T20:28:16.107
> 
> 标签：java, multithreading, swing, user-interface

我需要用 3 个按钮（启动、反转、停止）和一个滚动条来模拟一个正在运行的风扇来控制速度。我写了一个代码，但它们没有错误，但它不起作用。起初，类扩展了 Jframe，出现了带有按钮和扇形弧线的窗口，但是当它扩展 Japplet 时，它没有出现。但这两种方式都不起作用。

```
package Ass3_10203038;

import javax.swing.JFrame;
import javax.swing.JPanel;
import java.awt.Graphics;
import javax.swing.JButton;
import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import  java.awt.Adjustable;
import java.awt.event.AdjustmentEvent;
import java.awt.event.AdjustmentListener;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;
import java.util.logging.Level;
import java.util.logging.Logger;

public class Ass3_10203038 extends JApplet implements Runnable {
private static
    Lock lock = new ReentrantLock();
Graphics fan;
JButton start = new JButton("Start");
JButton stop = new JButton("Stop");
JButton reverse = new JButton("Reverse");
JScrollBar speed = new JScrollBar();
Thread timer = new Thread();
int thr=50;
int strtpt=0;
 JFrame frame= new JFrame();

@Override
public void run() {
    repaint();
    while (true) {
        try {
            Thread.sleep(thr);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

  }

   public Ass3_10203038() {
    final ArcsPanel arcs = new ArcsPanel();

    JPanel p = new JPanel();

    p.setSize(500, 500);
    p.add(arcs);
  //  p.setSize(5000, 5000);
    p.add(start);
    p.add(stop);
    p.add(reverse);
    p.add(speed);
    p.setLayout(new GridLayout());

   frame.add(p);
  add(frame);

   frame.setTitle("Fan");
    start.addActionListener(new ActionListener(){
   public void actionPerformed(ActionEvent e){
  timer.start();

  for(int x=strtpt;x<362;x++)
 {if(x==361)
 x=0;
 else         
  arcs.initializex(x);
  arcs.paintComponent(fan);
 strtpt=x;
  }   

 }
 });

        stop.addActionListener(new ActionListener(){
 public void actionPerformed(ActionEvent e){

  lock.lock();

   timer.start();

}
});

         reverse.addActionListener(new ActionListener(){
  public void actionPerformed(ActionEvent e){
   timer.start();
    for(int x=strtpt;x>-1;x--)
    {if(x==0)
    x=360;

  else
    arcs.initializex(x);
      arcs.paintComponent(fan);
    strtpt=x;

     }

         }});

            speed.addAdjustmentListener(new AdjustmentListener(){
                    public void adjustmentValueChanged(AdjustmentEvent ae){
                        try {
                            switch (thr){
                                    case AdjustmentEvent.UNIT_INCREMENT:
                                   Thread.sleep( thr+=2);
                                break;

                                    case AdjustmentEvent.UNIT_DECREMENT:
                                      Thread.sleep(thr-=2);
                                        break;
                                            }
                            int value = ae.getValue();
                        } catch (InterruptedException ex) {
                            Logger.getLogger(Ass3_10203038.class.getName()).log(Level.SEVERE, null, ex);
                        }
                    }

            });

    }
   /**
   * Main method
   */
   public static void main(String[] args) {
    Ass3_10203038  window = new Ass3_10203038();

    window.setSize(500, 500);

    window.setLocation(50, 50); // Center the frame
     // frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    window.setVisible(true);

   }
  }

 // The class for drawing arcs on a panel
  class ArcsPanel extends JPanel {
   // Draw four blades of a fan

   public int initializex(int x){

  return x;
   }

public void paintComponent(Graphics g) {
    super.paintComponent(g);

    int xCenter = getWidth() / 2;
    int yCenter = getHeight() / 2;
    int radius = (int) (Math.min(getWidth(), getHeight()) * 0.4);

    int x = xCenter - radius;
    int y = yCenter - radius;

    {
        g.fillArc(x, y, 2 * radius, 2 * radius, 0+initializex(x), 30);
        g.fillArc(x, y, 2 * radius, 2 * radius, 90+initializex(x), 30);
        g.fillArc(x, y, 2 * radius, 2 * radius, 180+initializex(x), 30);
        g.fillArc(x, y, 2 * radius, 2 * radius, 270+initializex(x), 30);

    }

  }
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T23:00:09.677

这段代码有很多问题，我不会尝试解决所有问题。但是，我会列出我注意到的并描述出了什么问题。

首先，您的代码因异常而崩溃：

```
java.lang.IllegalArgumentException: adding a window to a container 
```

这发生在`Ass3_10203038`构造函数中，您尝试将 a 添加`JFrame`到新`Ass3_10203038`实例（这是 a `JApplet`，因此是容器）。由于`JFrame`only 持有 a `JPanel`，因此您可以通过直接将 the 添加`JPanel`到`Ass3_10203038`实例来解决此问题。当作为 Applet 运行时，这至少会显示您的 UI。

接下来，单击一个按钮将生成一个`NullPointerException`. 发生这种情况是因为您`paintComponent`直接调用，`fan`作为`Graphics`参数传入 - 但您从未初始化`fan`代码中的任何内容，因此它始终为空。作为一种解决方案，您不应该`paintComponent`直接调用，因为您没有*可*`Graphics`用于在屏幕上绘制的对象。不过 Swing 系统有这个对象，所以我们可以要求它重新绘制而不是`paintComponent`直接调用：

```
arcs.repaint(); 
```

现在程序在按下按钮时进入无限循环。发生的事情是这个循环永远不会结束：

```
for (int x = strtpt; x < 362; x++)
{
    if (x == 361)
        x = 0;
    else
        arcs.initializex(x);
    arcs.repaint();
    strtpt = x;
} 
```

它总是保持循环，因为 x 永远不会达到 362。假设您希望风扇连续旋转，这是有道理的，但是由于您在 UI 线程上运行此循环，它会冻结整个窗口。除此之外，风扇会旋转*得非常*快，因为在这个循环中没有计时 - 它会尽可能快地运行，这确实是非常快的。

显然你试图通过涉及一个`Thread`被调用来解决这个问题`timer`：

```
timer.start(); 
```

然而，因为`timer`它只是一个空白`Thread`对象，所以这一行绝对没有任何作用（至少，对您的程序没有任何重要意义）。为了在线程中运行代码，您必须扩展`Thread`和覆盖该`run`方法，或者将 a 传递`Runnable`给`Thread`. 但是，我认为 raw`Thread`不会让我们到达任何地方，因为它们仍然没有真正解决时间问题。我建议你调查一下`javax.swing.Timer`。

即使这样，您的风扇叶片仍然不会移动。这是因为您的`paintComponent`方法实际上从未将任何角度视为输入。看起来你试图通过调用`initializex(x)`上面显示的循环和`paintComponent`方法来传递一个角度，但`initializex`除了返回它的参数之外什么都不做 - 无论你传入什么，你都会立即返回。所以在`paintComponent`方法中，`initializex(x)`只是简单地返回 x 的值。这意味着代替您编写代码：

```
g.fillArc(x, y, 2 * radius, 2 * radius, 0 + initializex(x), 30); 
```

你也可以写

```
g.fillArc(x, y, 2 * radius, 2 * radius, 0 + x, 30); 
```

具有完全相同的效果。

我希望这可以解释一些错误的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:41:20.937

我修复了代码，但非常感谢你，我只需要在脑海中组织逻辑

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package assign3_10203038;

import java.awt.Color;
import java.awt.Font;
import java.awt.FontMetrics;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.Rectangle;
import java.awt.Shape;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.AdjustmentEvent;
import java.awt.event.AdjustmentListener;
import java.awt.image.ImageObserver;
import java.text.AttributedCharacterIterator;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JApplet;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollBar;

public class Assign3_10203038 extends JFrame {

private JButton start = new JButton("Start");
private JButton stop = new JButton("Stop");
private JButton reverse = new JButton("Reverse");
private JScrollBar speed = new JScrollBar();
private Thread timer;
private final ArcsPanel arcs;

 public Assign3_10203038() {
    arcs = new ArcsPanel();

    JPanel p = new JPanel();
    p.setSize(5000, 5000);
    p.add(arcs);
    p.add(start);
    p.add(stop);
    p.add(reverse);
    p.add(speed);
    p.setLayout(new GridLayout());
    add(p);

    start.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {
            timer = new Thread(arcs);
            timer.start();

        }
    });

    speed.addAdjustmentListener(new AdjustmentListener() {
        public void adjustmentValueChanged(AdjustmentEvent ae) {
            System.out.println(ae.getValue());
            arcs.speed(ae.getValue());
        }
    });

    reverse.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            arcs.reverse();

        }
    });

    stop.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            timer.stop();
        }
    });
}

public static void main(String[] args) {
    Assign3_10203038 window = new Assign3_10203038();

    //  (new Thread(window)).start();
    window.setSize(500, 500);

    window.setLocation(50, 50); // Center the frame
    //  window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    window.setVisible(true);
}
}

class ArcsPanel extends JPanel implements Runnable {
// Draw four blades of a fan

int thr = 1000;
int i = -20;

public void run() {
    while (true) {
        starting_x = (starting_x + i) % 360;
        repaint();
        try {
            Thread.sleep(thr);
        } catch (InterruptedException ex) {
            Logger.getLogger(Assign3_10203038.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
}

public void reverse() {
    i = -i;
}

 public void speed(int p) {
    thr = 1000 - (p += p) * 5;

 }
 int starting_x;

 public void initializex(int x_val) {
    starting_x = x_val;
 }

 public void paintComponent(Graphics g) {
    super.paintComponent(g);

    int xCenter = getWidth() / 2;
    int yCenter = getHeight() / 2;
    int radius = (int) (Math.min(getWidth(), getHeight()) * 0.4);

 int x = xCenter - radius;
int y = yCenter - radius;

{
g.fillArc(x, y, 2 * radius, 2 * radius, 0 + starting_x, 30);
g.fillArc(x, y, 2 * radius, 2 * radius, 90 + starting_x, 30);
g.fillArc(x, y, 2 * radius, 2 * radius, 180 + starting_x, 30);
g.fillArc(x, y, 2 * radius, 2 * radius, 270 + starting_x, 30);

}

}
} 
```

# sas - SAS：我如何指出对某个值的特定观察？

> ID：15509776
> 
> 赞同：4
> 
> 时间：2013-03-19T20:28:19.780
> 
> 标签：sas

我对 SAS 很陌生，我正在尝试找出其他语言中可用的一些基本内容。

我有一张桌子

```
ID  Number
--  ------
1   2
2   5
3   6
4   1 
```

我想创建一个新变量，在其中将 Number 的一个观察值与其他观察值相加，例如

```
Number2 = Number + Number[3]

ID  Number  Number2
--  ------  ------
1   2       8
2   5       11
3   6       12
4   1       7 
```

如何获得 Number 的第三次观察值并将其添加到`Number`新变量中的每个观察值中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T21:06:20.520

做这件事有很多种方法; 这是使用 SAS`POINT=`选项的一个：

```
data have;
   input ID  Number;
datalines;
1   2
2   5
3   6
4   1
run;

data want;
   retain adder;
   drop adder;
   if _n_=1 then do;
      adder = 3;
      set have point=adder;
      adder = number;
      end;

   set have;
   number = number + adder;
run; 
```

`RETAIN`and`DROP`语句定义一个临时变量来保存您要添加的值 。`RETAIN`意味着每次通过数据步骤都不会重新初始化该值以丢失，并且`DROP`意味着您不想将该变量包含在输出数据集中。

该`POINT=`选项允许人们从 SAS 数据集中读取特定的观察结果。该`_n_=1`部分是一种控制机制，只执行该位代码一次，将变量分配给`adder`第三次观察的值。

下一部分一次读取一个观察数据集并添加应用您的更改。

注意同一个数据集被读取两次；一个方便的 SAS 功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T21:13:17.497

我将首先建议 Base SAS 通常不会以这种方式工作。不是它不能，但通常你可以解决大多数问题而无需指向特定的行。

因此，尽管此答案将解决您的明确问题，但在现实世界中可能没有用处；通常在现实世界中，您将有一个匹配键或除“行号”之外的其他元素来组合，如果您这样做了，那么您可以更有效地做到这一点。您还可能以一种使此操作更方便的方式重新排列您的数据结构。

也就是说，你给出的具体例子是微不足道的：

```
data have;
input ID  Number;
datalines;
1   2
2   5
3   6
4   1
;;;;
run;

data want;
set have;
_t = 3;
set have(rename=number=number3 keep=number) point=_t ;
number2=number+number3;
run; 
```

如果您有 SAS/IML（SAS 的矩阵语言），它与 R 有点相似，那么无论您执行此操作的可能性以及如何执行此操作，这都是一个非常不同的故事。

```
proc iml;
 a= {1 2, 2 5, 3 6, 4 1}; *create initial matrix;
 b = a[,2] + a[3,2]; *create a new matrix which is the 2nd column of a added 
                      elementwise to the value in the third row second column;
 c = a||b; *append new matrix to a - could be done in same step of course;
 print b c;
quit; 
```

*用第一个*观察来做到这一点，要容易得多。

```
data want;
set have;
retain _firstpoint; *prevents _firstpoint from being set to missing each iteration;
if _n_ = 1 then _firstpoint=number; *on the first iteration (usually first row) set to number's value;
number = number - _firstpoint; *now subtract that from number to get relative value;
run; 
```

我将对此进行详细说明。SAS 在逐个记录级别上工作，其中每个记录都在 DATA 步骤中独立处理。（另一方面，PROC 可能不会以这种方式运行，尽管许多在某种程度上会这样做）。SAS 与 SQl 和类似数据库一样，并不真正承认任何行是“第一”或“第二”或“第 n”；但是，与 SQL 不同的是，它确实允许您根据当前排序假装它是。POINT= 随机访问方法是执行此操作的一种方法。

但是，大多数时候，您将使用数据中的某些内容来确定您想要做什么，而不是与数据排序相关的某些内容。这是一种与 POINT= 方法相同的方法，但使用 ID 的值：

数据需要；如果*n* = 1 然后设置 have(where=(ID=3) rename=number=number3); 设置有；数字2=数字+数字3；跑;

在数据步骤的第一次迭代中（`_N_`=1）从 HAVE 中取出 Id=3 的行，然后按顺序从 have 中取出行（真的是这样做的：）

```
*check to see if _n_=1; it is; so take row id=3;
*take first row (id=1);
*check to see if _n_=1; it is not;
*take second row (id=2);
... continue ... 
```

SET 语句中的变量会自动保留，因此 NUMBER3 会自动保留（耶！）并且不会在数据步骤循环的迭代之间设置为丢失。只要您不修改该值，它将在每次迭代中保留。

# html - 从选项范围中间的选项开始 [选择框]

> ID：15509780
> 
> 赞同：2
> 
> 时间：2013-03-19T20:28:25.493
> 
> 标签：html, html-select

我有一个选择框，用户可以在其中选择她/他出生的年份，我想在单击时从 1970 年开始，但默认情况下仍将“年份”保留为选定选项。

无论如何（即使用 JavaScript）我可以从选项范围的中间开始，比如 1970 年，并且有早年和晚年以下？

例子：

```
 <select>
                <option selected>Year</option>
                <option value="1950">1950</option>
                <option value="1951">1951</option>
                <option value="1952">1952</option>
                <option value="1953">1953</option>
                <option value="1954">1954</option>
                <option value="1955">1955</option>
                <option value="1956">1956</option>
                <option value="1957">1957</option>
                <option value="1958">1958</option>
                <option value="1959">1959</option>
                <option value="1960">1960</option>
                <option value="1961">1961</option>
                <option value="1962">1962</option>
                <option value="1963">1963</option>
                <option value="1964">1964</option>
                <option value="1965">1965</option>
                <option value="1966">1966</option>
                <option value="1967">1967</option>
                <option value="1968">1968</option>
                <option value="1969">1969</option>
                <option value="1970">1970</option>
                <option value="1971">1971</option>
                <option value="1972">1972</option>
                <option value="1973">1973</option>
                <option value="1974">1974</option>
                <option value="1975">1975</option>

        </select> 
```

# java - OutOfMemoryError: PermGen 空间

> ID：15509781
> 
> 赞同：2
> 
> 时间：2013-03-19T20:28:34.187
> 
> 标签：java, memory, spring-tool-suite

我知道关于这个问题有很多 SO 问题和答案；我已经尝试了 8 或 10 种对其他人有用的不同方法，并且觉得需要分析问题所在，而不是反复试验。

我在 Windows 64 位机器、Spring Tool Suite 3.1、Jetty 内部服务器上运行。我正在运行一个 Web 应用程序；它的初始屏幕出现，我单击一个执行操作的链接，它处理大约 10 秒，然后给我以下

```
HTTP ERROR 500
Problem accessing /corrserv/printRoom/printManagement.html;jsessionid=uroykwoyxr2y.     
Reason: 

PermGen space

Caused by:
java.lang.OutOfMemoryError: PermGen space
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClassFromSelf(ClassRealm.java:386)
at org.codehaus.plexus.classworlds.strategy.SelfFirstStrategy.loadClass(SelfFirstStrategy.java:42)
at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:244)
at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:230)
at org.eclipse.jdt.internal.compiler.Compiler.<init>(Compiler.java:109)
at org.apache.jasper.compiler.JDTJavaCompiler.compile(JDTJavaCompiler.java:498)
at org.apache.jasper.compiler.Compiler.generateClass(Compiler.java:368)
at org.apache.jasper.compiler.Compiler.compile(Compiler.java:437)
at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:608)
at org.apache.jasper.servlet.JspServletWrapper.loadTagFile(JspServletWrapper.java:261)
at org.apache.jasper.compiler.TagFileProcessor.loadTagFile(TagFileProcessor.java:683)
at org.apache.jasper.compiler.TagFileProcessor.access$000(TagFileProcessor.java:88)
at org.apache.jasper.compiler.TagFileProcessor$TagFileLoaderVisitor.visit(TagFileProcessor.java:739)
at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1501)
at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2291)
at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2341)
at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2347)
at org.apache.jasper.compiler.Node$Root.accept(Node.java:498)
at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2291)
at org.apache.jasper.compiler.TagFileProcessor.loadTagFiles(TagFileProcessor.java:757)
at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:222)
at org.apache.jasper.compiler.Compiler.compile(Compiler.java:435)
at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:608)

--------------------------------------------------------------------------------
Powered by Jetty:// 
```

以下是我的 STS.ini 文件：

```
-vm
C:/Program Files (x86)/Java/jdk1.6.0_43/bin/javaw.exe
-startup
plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_1.1.200.v20120522-1813
-product
org.springsource.sts.ide
--launcher.defaultAction
openFile
--launcher.XXMaxPermSize
512m
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Xms256m
-Xmx512m
-XX:MaxPermSize=512m 
```

对于最后三个值，我已经尝试了很多东西。我已输入 123456789m 以确保 STS 读取此特定文件（它不会以该值开头）。我只运行一个 Web 应用程序。我以前也有 -XX:PermSize，很乐意再试一次。不幸的是，我不知道这些是如何相互作用的。只有它们的基本含义。

我会很感激一些关于如何解决这个问题的指导，或者至少是如何攻击它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T19:18:41.907

这可以通过查看 JDK 的版本（位版本）来解决。就像使用 64 位 JDK 版本的 32 位应用程序一样。更改为正确的 JDK 版本和正确的 JRE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T20:32:48.813

问题似乎出在 jsp 本身。我猜它正在用类填充 PermGen。能发一下jsp代码吗？

添加内存不是解决此问题的方法。有一些东西在里面，你需要找到那个东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T20:37:24.030

1)将 MaxPermSize*限制*为 512m 可能不是一个好主意。我肯定会把它拿出来。

*2) 考虑增加*-Xmx并没有什么坏处。

3）这里有一些很好的链接：

*   [https://stackoverflow.com/a/8358209/421195](https://stackoverflow.com/a/8358209/421195)

*   [http://www.dbuggr.com/smallwei/permsize-maxpermsize-work-java/](http://www.dbuggr.com/smallwei/permsize-maxpermsize-work-java/)

*   [http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html](http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html)

4) 最重要的是在您的应用程序运行时对其进行分析，以查看您是否可以准确地弄清楚是什么在消耗您的 PermGen。以下是一些选项：

*   MAT（如果您使用的是 Eclipse）： http: [//www.eclipse.org/mat/](http://www.eclipse.org/mat/)

*   JVisualVM：[http ://docs.oracle.com/javase/6/docs/technotes/tools/share/jvisualvm.html](http://docs.oracle.com/javase/6/docs/technotes/tools/share/jvisualvm.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T21:03:17.483

也许我错了，但这个问题似乎与 Jasper 的错误使用有关……您是否调查了[OutOfMemoryError: PermGen Space -- Jasper Report with Spring 在 Tomcat 上运行](https://stackoverflow.com/questions/12943030/outofmemoryerror-permgen-space-jasper-report-with-spring-running-on-tomcat)的公认原因？

# wordpress - 修复本地托管的 wordpress 站点以进行迁移（删除 localhost）

> ID：15509784
> 
> 赞同：0
> 
> 时间：2013-03-19T20:28:51.543
> 
> 标签：wordpress

一个 Wordpress 新手，已经使用 MAMP 在本地设置了我的网站。不幸的是，所有样式的链接和我假设数据库等默认使用“localhost”进行路径，因此该站点只能在我的机器上运行。更改此路径以使 wordpress 正确显示该站点的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:37:34.357

对于数据库，您可以编辑站点根目录下的 wp-config.php 文件。

就您的样式而言，您必须浏览已设置的主题文件并调整这些样式表的相对路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:01:36.090

有几种选择。Kyle 关于编辑 wp-config.php 是正确的，这肯定会处理新的数据库连接。但是，如果可能的话，我建议不要手动调整样式表和标记。对于新手来说，最简单的方法可能是：使用“设置 > 导出”从本地安装中导出数据库。然后，在您的远程安装中，使用 WordPress 导入器，它应该会为您整理所有链接。这对我有用几次。

您可以在此处了解有关其他选项的更多信息：[http ://wp.tutsplus.com/tutorials/hosting/how-to-break-a-wordpress-install-and-fix-it-again/](http://wp.tutsplus.com/tutorials/hosting/how-to-break-a-wordpress-install-and-fix-it-again/)

更新：当然，除非您在样式表和标记中硬编码“localhost”。在这种情况下，请使用上述链接中的解决方案之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T00:48:32.630

如果您的主题使用序列化数据，那么您在移动网站时可能会遇到问题，只需执行查找和替换并以这种方式更改 URL。我建议您在移动网站时遵循 WordPress 指南。

[http://codex.wordpress.org/Moving_WordPress](http://codex.wordpress.org/Moving_WordPress)

它涉及使用特殊脚本来更改您网站的 URL。

# php - PHP 在一个输入中分隔两个不同的部分

> ID：15509785
> 
> 赞同：2
> 
> 时间：2013-03-19T20:28:56.783
> 
> 标签：php, regex, split

我正在开发一个基于 PHP 的应用程序扩展，它将通过 TVRage API 类扩展启动器样式的应用程序，以将结果返回给可能在任何地方的用户。这是通过 Alfred App (alfredapp.com) 完成的。

我想添加包含节目名称后跟 S##E## 的功能：示例：Mike & Molly S01E02

节目名称可以更改，所以我不能停在那里，但我想将 S##E## 与节目名称分开。这将允许我使用该信息通过 API 继续搜索。更好的是，如果有办法抓取数字，并且只有 S 和 E 之间的数字（在示例 01 中）和 E 之后的数字（在示例 02 中），那将是完美的。

我在想最好的功能是`strpos`，但仔细观察后，它会在字符串中搜索字符串。我相信我需要使用正则表达式来正确执行此操作。那会让我留下`preg_match`. 这导致我：

```
$regex = ?;
preg_match( ,$input); 
```

问题是我只是不太了解正则表达式来编写它。什么正则表达式可用于将节目名称与 S##E## 分开或仅获取两个单独的数字？

另外，如果你有一个教正则表达式的好地方，那就太好了。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:34:26.293

你可以把它转过来，[`strrpos`](http://php.net/manual/en/function.strrpos.php)用来查找字符串中的最后一个空格，然后[`substr`](http://php.net/manual/en/function.substr.php)根据你找到的位置来获取两个字符串。

例子：

```
$your_input = trim($input);    // make sure there are no spaces at the end (and the beginning)
$last_space_at = strrpos($your_input, " ");
$show = substr($your_input, 0, $last_space_at - 1);
$episode = substr($your_input, $last_space_at + 1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T21:38:29.920

## 正则表达式：

```
$text = 'Mike & Molly S01E02';
preg_match("/(.+)(S\d{2}E\d{2})/", $text, $output);
print_r($output); 
```

输出：

```
Array
(
    [0] => Mike & Molly S01E02
    [1] => Mike & Molly 
    [2] => S01E02
) 
```

* * *

如果你想要单独的数字：

```
$text = 'Mike & Molly S01E02';
preg_match("/(.+)S(\d{2})E(\d{2})/", $text, $output);
print_r($output); 
```

输出：

```
Array
(
    [0] => Mike & Molly S01E02
    [1] => Mike & Molly 
    [2] => 01
    [3] => 02
) 
```

* * *

## 解释：

**. -->**匹配每个字符

**.+ -->**匹配每个字符一次或多次

**\d -->**匹配一个数字

**\d{2} -->**匹配 2 位数字

括号是对结果进行分组。

[www.regular-expressions.info](http://www.regular-expressions.info/)是学习正则表达式的好地方。

# python - 从 Pyramid 应用程序视图中获取 Mako 模板

> ID：15509786
> 
> 赞同：2
> 
> 时间：2013-03-19T20:29:01.237
> 
> 标签：python, pyramid, mako

我目前正在使用 Pyramid Web 框架，并使用 Mako 模板对其进行了配置。我知道我可以在视图方法中将模板呈现为字符串（[Pyramid - Is it possible to render my mako template as a string in my view callable?](https://stackoverflow.com/questions/6321625/pyramid-is-it-possible-to-render-my-mako-template-as-a-string-within-my-view-c)），但是，我想知道是否可以得到实际的视图中的模板对象，而不仅仅是渲染模板的函数。

查看 Pyramid 源代码，在**mako_templating.py**中，我看到默认的 TemplateLookup 类被 Pyramid 的查找方法覆盖。反正有没有主要访问这个查找对象，所以我可以使用它的一部分*get_template*函数？

感谢您对此问题的任何指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T04:51:52.963

Pyramid 的渲染 API 不正式支持这种级别的内省。话虽如此，这是一种方法。这是完全无证的、不受支持的、私有的等等。意思是，当它停止工作时不要来抱怨。

```
from pyramid.mako_templating import IMakoLookup
lookup = request.registry.queryUtility(IMakoLookup, name='mako.')
tmpl = lookup.get_template('myapp:templates/foo.mako')

opts = {} # rendering context
result = tmpl.render_unicode(**opts) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-05T19:49:16.350

这对我有用：

```
from pyramid.renderers import render
sRenderedStuff = render('path/to/template.mak',dContext) 
```

一个示例用例将是这样的：

```
sEmailHtml = render("email/welcome_message_html.mak",dContext) 
```

在您的金字塔设置文件中使用以下行：

```
mako.directories = your_app:templates 
```

模板是从`your_app/templates/email/welcome_message.html`. All`inheritance`和`include`标签的工作方式与呈现给视图响应的模板一样。

# java - 在Java的方法语句中返回子字符串（n，m）的正确方法是什么？

> ID：15509789
> 
> 赞同：0
> 
> 时间：2013-03-19T20:29:04.837
> 
> 标签：java, string

我正在经历以前的考试问题，我的问题是确定字符串长度并返回它的正确方法是什么。

如果字符串的长度小于 5 个字符，那么我可以通过以下方式返回它：

```
public static String first5(String s){
     if(s.length() < 5)
     return s;
} 
```

但是，如果 String 大于 5 个字符，则可以通过以下方式返回：

```
public static String first5(String s){

     return s.substring(0, 4);
} 
```

我必须注意的是，当我之前在课堂测试中回答这类问题时，我的讲师强调我真的不应该使用“幻数”？不过，我不确定他实际上是什么意思。

有没有更好的方法来返回这种类型的方法？

我还在学习 Java，所以请原谅我的语法中的任何错误。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:33:13.193

这应该是你的方法`first5`：

```
public static String first5(String s){
  return s.length() < 5? s : s.substring(0, 5);
} 
```

这里没有幻数，但也许老师的意思是数字 5 是一个幻数，并希望您概括该函数：

```
public static String firstN(String s, int n){
  return s.length() < n? s : s.substring(0, n);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:34:11.633

本质上，如果需求发生变化，您可以轻松地在一个位置更改值；因此，它会在它被引用的任何地方被改变。您不必担心代码中漂浮的旧需求的任何片段。这通常是处理大量代码的好规则。

```
public class solution {
    static final int VAR1 = 0;
    static final int VAR2 = 4;
    static final int VAR3 = 5;
    public static String first5(String s){
        if(s.length() < VAR3) { 
            return s;
        } else {
            return s.substring(VAR1, VAR2);
        }
    }
} 
```

当然，变量名称必须命名为对类/应用程序本身有意义的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T20:39:25.893

请注意，使用 if 语句并没有什么可耻的：

```
String r = null;
if (s.length() < 5) {
    r = s;
}
else {
    r = s.substring(0,5);
}
return r; 
```

逻辑比使用`?:`. 后者的优势在于它占用的屏幕空间较小，因此您可以在屏幕上获得更多的大型功能——如果您拥有大型功能，则很有价值，但如果没有，则会适得其反。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T20:34:45.213

数字 5 在您的问题中吗？如果没有使用字符串输入获取数字作为输入参数。

# wpf - WPF列表框按子字符串分组

> ID：15509792
> 
> 赞同：0
> 
> 时间：2013-03-19T20:29:18.270
> 
> 标签：wpf, listbox, wpf-controls, wpf-4.0

我的对象具有存储更多由分隔符分隔的字符串的属性。我想在启用分组的 WPF 列表框中显示此类对象的列表。我需要的是根据子字符串进行分组。

*对象 1：属性 =“字符串 1；字符串 2；字符串 3”*

*对象 2：属性 =“字符串 2；字符串 3”*

我希望列表框像这样显示：

## 字符串1

对象 1

对象 2

## 字符串2

对象 1

## 字符串3

对象 1

对象 2

那可能吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T22:33:37.263

创建一个包装类。

```
class MyGroup
{
 public string GroupID;
 public object SomeObject;
} 
```

构建该包装类的平面列表。

```
private List<MyGroup> BuildItemsSourceTogether()
{
 List<MyGroup>itemsSource = new List<MyGroup>();
 foreach(var obj in myListWithObjectsWhichPropertiesAreStringsWhichFuthermoreContainSubstrings)
 {
   var stringArray = obj.Property123.Split(';');
   foreach(var str in stringArray)
   {
    itemsSource.Add(new MyGroup () { GroupID = str, SomeObject = obj});
   }
 }
 return itemsSource;
} 
```

告诉包装类中的哪些属性应该用于分组。

```
class Window1
{
  public Window1()
  {
    InitalizeComponents();
    var finalData = new ListCollectionView(BuildItemsSourceTogether());
    finalData.GroupDescriptions.Add(new PropertyGroupDescription("GroupID"));
    this.DataContext = finalData;
  }
} 
```

在 XAML 中设置您的组的外观，并让 WPF 为您分组该平面 ID 列表。

我使用了带有列的 DataGrid。您可以使用列表框。

```
<DataGrid ItemsSource="{Binding}">
      <DataGrid.GroupStyle>
        <GroupStyle>
            <GroupStyle.HeaderTemplate>
                <DataTemplate>
                    <StackPanel>
                        <TextBlock Text="{Binding Path=Name}" />
                    </StackPanel>
                </DataTemplate>
            </GroupStyle.HeaderTemplate>
            <GroupStyle.ContainerStyle>
                <Style TargetType="{x:Type GroupItem}">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type GroupItem}">
                                <Expander>
                                    <Expander.Header>
                                        <StackPanel Orientation="Horizontal">
                                          <TextBlock Text="{Binding Path=Name}" />
                                          <TextBlock Text="{Binding Path=ItemCount}"/>
                                          <TextBlock Text="Items"/>
                                        </StackPanel>
                                    </Expander.Header>
                                    <ItemsPresenter />
                                </Expander>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </GroupStyle.ContainerStyle>
        </GroupStyle>
    </DataGrid.GroupStyle>
    <DataGrid.Columns>
        <DataGridTextColumn Header="header1" Binding="{Binding SomeObject.Property321}" />
        <DataGridTextColumn Header="header2" Binding="{Binding SomeObject.Property678}" />
    </DataGrid.Columns>
</DataGrid> 
```

玩得开心。

# android - 创建 ContentNegotiatingViewResolver 时出现 BeanCreationException

> ID：15509802
> 
> 赞同：0
> 
> 时间：2013-03-19T20:29:46.520
> 
> 标签：android, apache, spring-mvc, web, content-negotiation

我正在尝试让我的 Android 应用程序与托管我的 Web 应用程序的服务器通信。对于 Web 端，我使用的是 Spring，一切正常。我可以使用 spring 等发送数据库数据。但是现在，我正试图让我的 android 应用程序与服务器通信。为此，我遵循了本教程：[http ://blog.trifork.com/2011/02/07/creating-an-android-app-for-your-website-with-spring-android-and-rest/](http://blog.trifork.com/2011/02/07/creating-an-android-app-for-your-website-with-spring-android-and-rest/)

现在，当我尝试打开网页时，会收到很多异常。（我什至不需要尝试从 Android 应用程序发送任何内容！）。它工作正常，直到我在 springmvc-servlet.xml 中编写了一些代码

因此，由于我是 Spring 新手，因此在解决此异常时遇到了麻烦。这是我的 sprinmvc-servlet.xml 代码（我更改了代码的某些部分，遵循其他教程，但是当我使用我使用的第一个教程中的代码时，我得到了相同的异常）

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc 
    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
    http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <context:component-scan base-package="com.puccamp.projetofinal" />
    <mvc:annotation-driven />
    <mvc:default-servlet-handler />

    <bean
        class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
        <property name="mediaTypes">
            <map>
                <entry key="html" value="text/html" />
                <entry key="json" value="application/json" />
            </map>
        </property>
        <property name="viewResolvers">
            <list>
                <bean class="org.springframework.web.servlet.view.BeanNameViewResolver" />
                <bean
                    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
                    <property name="prefix" value="/WEB-INF/views/" />
                    <property name="suffix" value=".jsp" />
                </bean>
            </list>
        </property>
        <property name="defaultViews">
            <list>
                <bean
                    class="org.springframework.web.servlet.view.json.MappingJacksonJsonView" />
            </list>
        </property>
    </bean>

</beans> 
```

这是例外情况（有很多，但不要害怕！：D）：

```
exception

javax.servlet.ServletException: Servlet.init() for servlet springmvc threw exception
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    java.lang.Thread.run(Unknown Source)
root cause

org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.web.servlet.view.ContentNegotiatingViewResolver#0' defined in ServletContext resource [/WEB-INF/springmvc-servlet.xml]: Cannot create inner bean 'org.springframework.web.servlet.view.json.MappingJacksonJsonView#129acbd' of type [org.springframework.web.servlet.view.json.MappingJacksonJsonView] while setting bean property 'defaultViews' with key [0]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.web.servlet.view.json.MappingJacksonJsonView#129acbd' defined in ServletContext resource [/WEB-INF/springmvc-servlet.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [org.springframework.web.servlet.view.json.MappingJacksonJsonView]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: org/codehaus/jackson/map/ObjectMapper
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveInnerBean(BeanDefinitionValueResolver.java:281)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:120)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveManagedList(BeanDefinitionValueResolver.java:353)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:153)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1325)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1086)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
    org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
    org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)
    org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:580)
    org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)
    org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)
    org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:442)
    org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:458)
    org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:339)
    org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:306)
    org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:127)
    javax.servlet.GenericServlet.init(GenericServlet.java:160)
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    java.lang.Thread.run(Unknown Source)
root cause

org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.web.servlet.view.json.MappingJacksonJsonView#129acbd' defined in ServletContext resource [/WEB-INF/springmvc-servlet.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [org.springframework.web.servlet.view.json.MappingJacksonJsonView]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: org/codehaus/jackson/map/ObjectMapper
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:965)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveInnerBean(BeanDefinitionValueResolver.java:270)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:120)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveManagedList(BeanDefinitionValueResolver.java:353)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:153)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1325)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1086)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
    org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
    org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)
    org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:580)
    org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)
    org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)
    org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:442)
    org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:458)
    org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:339)
    org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:306)
    org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:127)
    javax.servlet.GenericServlet.init(GenericServlet.java:160)
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    java.lang.Thread.run(Unknown Source)
root cause

org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [org.springframework.web.servlet.view.json.MappingJacksonJsonView]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: org/codehaus/jackson/map/ObjectMapper
    org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:141)
    org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:74)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:958)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveInnerBean(BeanDefinitionValueResolver.java:270)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:120)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveManagedList(BeanDefinitionValueResolver.java:353)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:153)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1325)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1086)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
    org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
    org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)
    org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:580)
    org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)
    org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)
    org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:442)
    org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:458)
    org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:339)
    org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:306)
    org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:127)
    javax.servlet.GenericServlet.init(GenericServlet.java:160)
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    java.lang.Thread.run(Unknown Source)
root cause

java.lang.NoClassDefFoundError: org/codehaus/jackson/map/ObjectMapper
    org.springframework.web.servlet.view.json.MappingJacksonJsonView.<init>(MappingJacksonJsonView.java:56)
    sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    java.lang.reflect.Constructor.newInstance(Unknown Source)
    org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:126)
    org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:74)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:958)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveInnerBean(BeanDefinitionValueResolver.java:270)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:120)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveManagedList(BeanDefinitionValueResolver.java:353)
    org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:153)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1325)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1086)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
    org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
    org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)
    org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:580)
    org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)
    org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)
    org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:442)
    org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:458)
    org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:339)
    org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:306)
    org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:127)
    javax.servlet.GenericServlet.init(GenericServlet.java:160)
    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:39:15.077

我正在寻找您问题的答案，我在 StackOverflow 中找到了这篇文章

[java.lang.ClassNotFoundException: Spring 3 项目中的 org.codehaus.jackson.map.ObjectMapper](https://stackoverflow.com/questions/11123596/java-lang-classnotfoundexception-org-codehaus-jackson-map-objectmapper-on-sprin)

也许该帖子的解决方案与您的问题有关。

所以可能[杰克逊](http://jackson.codehaus.org/)在你的类路径中丢失了

# powershell - 管道参数干扰 $args 数组

> ID：15509804
> 
> 赞同：1
> 
> 时间：2013-03-19T20:29:49.467
> 
> 标签：powershell, powershell-2.0

我正在尝试使用`$args`带有管道参数的数组。

该函数期望在第一个流水线参数之后有任意数量的参数（例如 param0）：

```
function rpt-params {

    param ( 
        [Parameter(ValueFromPipeline=$true,Position=0,Mandatory=$true)][CrystalDecisions.CrystalReports.Engine.ReportDocument]$reportDocument
    )

    try {
        write-host "count: " $args.count

        #TODO process args

    }
    catch [Exception] {
        write-host $_.Exception
    }
    finally {
        return $reportDocument
    }

} 
```

尝试调用该函数会产生一个错误，内容为“rpt-params：找不到与参数名称'param0'匹配的参数。”：

```
...
# syntax 0
rpt-params $rpt -param0 "mb-1" -param1 "me-1"
...

...
# syntax 1; explicitly naming the first parameter
rpt-params -reportDocument $rpt -param0 "mb-1" -param1 "me-1"
... 
```

我的语法是问题还是与使用流水线参数有关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:35:13.843

创建另一个参数，将其命名为 $rest 并用`[Parameter(ValueFromRemainingArguments = $true)]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T20:46:22.233

当您使用“[cmdletbinding()]”或“[Parameter()]”时，您的函数会变成高级函数。高级函数只能接受“参数”下指定的参数，不能再接受。要使您的功能像以前一样，就像基思建议的那样，您需要添加`[Parameter(ValueFromRemainingArguments = $true)]`

例如：

```
function rpt-params {
    param ( 
        [Parameter(ValueFromPipeline=$true,Position=0,Mandatory=$true)]
        [CrystalDecisions.CrystalReports.Engine.ReportDocument]$reportDocument,
        [Parameter(ValueFromRemainingArguments=$true)]$args
    )

    try {
        write-host "count: " $args.count

        #TODO Now args can have all remaining values
    }
    catch [Exception] {
        write-host $_.Exception
    }
    finally {
        return $reportDocument
    }
} 
```

# ruby-on-rails - ruby rails 为 rspec 测试创建 have_list_of_links 实用程序

> ID：15509808
> 
> 赞同：0
> 
> 时间：2013-03-19T20:30:10.013
> 
> 标签：ruby-on-rails, ruby, helper, utility, matcher

我是 ruby​​/rails 的新手，正在做一个 turorial 我想知道如何解决我的小问题......

我有一个*“带有有效信息”的描述，*它测试当用户使用有效信息登录时应该或不应该发生什么。在此过程中，我希望能够验证新页面上是否存在某些链接。在 tuto 中，只有 2 个链接，所以我们这样做：

```
it { should have_link('Profile', href: user_path(user)) }
it { should have_link('Sign out', href: signout_path) } 
```

但是如果我们有 10 个链接呢？我认为有一个助手会更容易吗？但是我不知道怎么写。这是我带来的...

```
 lol = Hash[ 'Profile'  => 'user_path(user)',
             'Sign out' => 'signin_path']
 it { should have_list_of_links(lol) } 
```

然后在 $PROJECT/spec/support/utilities.rb 文件中，我定义了新的 *have_list_of_links* 函数：

```
RSpec::Matchers.define :have_list_of_links do |lol|
  match do |page|
    lol.each_pair do |label, link| 
                page.should have_link(label, href: link) 
    end
  end
end 
```

我知道这不是正确的方法，但我不知道该怎么做......

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T11:08:44.537

我可以在这里看到两个小问题。首先使用[let](https://www.relishapp.com/rspec/rspec-core/v/2-13/docs/helper-methods/let-and-let!)语法在 rspec 中定义记忆变量。其次，在构建散列时，将***_path**助手周围的括号去掉。

所以说：

```
lol = Hash[ 'Profile'  => 'user_path(user)',
            'Sign out' => 'signin_path'] 
```

有：

```
let(:lol) { Hash[ 'Profile'  => user_path(user),
                  'Sign out' => signin_path] } 
```

您的描述块可能是：

```
describe "with valid information" do
  let(:lol) { Hash[ 'Profile'  => user_path(user),
                    'Sign out' => signin_path] }

  it { should have_list_of_links(lol) }
end 
```

作为副作用，我将向您展示一个小例子。鉴于您在**$PROJECT/spec/support/utilities.rb**文件中定义了匹配器，应用程序路由等...已正确设置，并且您的视图中有链接。

```
describe "Users pages" do
  before { visit root_path }
  let(:values) { Hash['Index' => users_path, 
                      'Sign out' => signout_path, 
                      'Sign in' => signin_path] }

  subject { page }

  describe "with valid informations" do
    it { should have_list_of_links(values) }
  end
end 
```

运行 rspec：

```
> rspec
.

Finished in 0.00267 seconds
1 example, 0 failures

Randomized with seed 67346 
```

运行 rspec -f 文档

```
>rspec -f documentation
Users pages
  with valid informations
    should have link "Sign in"

Finished in 0.00049 seconds
1 example, 0 failures

Randomized with seed 53331 
```

这不清楚和误导，特别是文档开关。在新应用程序上运行 rspec -f 文档是一种常见的做法，您只需动手（如果他们使用 rspec ofc）。为了更好地了解正在发生的事情。

如果您有：

```
describe "Users pages" do
  before { visit root_path }

  subject { page }

  describe "with valid informations" do
    it { should have_link('Index', href: users_path) }
    it { should have_link('Sign out', href: signout_path) }
    it { should have_link('Sign in', href: signout_path) }
  end
end 
```

运行 rspec：

```
>rspec
...

Finished in 0.0097 seconds
3 examples, 0 failures

Randomized with seed 53347 
```

运行 rspec -f 文档

```
>rspec -f documentation
Users pages
  with valid informations
    should have link "Index"
    should have link "Sign out"
    should have link "Sign in"

Finished in 0.00542 seconds
3 examples, 0 failures

Randomized with seed 40120 
```

我个人喜欢第二种情况（更详细的一种）。随着测试数量的增加和测试结构变得越来越复杂，它的价值也在增加。您可以简单地运行**rspec -f 文档**来学习如何使用应用程序，甚至无需阅读用户手册/教程。

# mysql - 重写 sql 以支持连接

> ID：15509810
> 
> 赞同：0
> 
> 时间：2013-03-19T20:30:16.143
> 
> 标签：mysql, sql, wordpress

我有以下查询，在 oracle 数据库中应该可以工作，但当前的 wordpress 安装使用 mysql 数据库。你能帮我重写下一个查询，以便它可以在 mysql 上运行吗？

```
$wpdb->get_results("SELECT a.ID, a.post_title, DAYOFMONTH(b.meta_value) as dom "
."FROM $wpdb->posts a, $wpdb->postmeta b "
."WHERE b.meta_value >= '{$thisyear}-{$thismonth}-01 00:00:00' "
."AND b.meta_value <= '{$thisyear}-{$thismonth}-{$last_day} 23:59:59' "
."AND a.post_type = 'post' AND a.post_status = 'publish' AND a.ID = b.postid AND   b.meta_key='Event Date'"
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:13:42.330

您可能对常量的日期格式有疑问。我建议使用 . 将日期转换为相同的格式`to_char()`。我在想一些事情：

```
SELECT a.ID, a.post_title, to_char(b.meta_value, 'DD') as dom "
."FROM $wpdb->posts a, $wpdb->postmeta b "
."WHERE to_char(b.meta_value, 'YYYY-MM-DD HH:MI:SS') >= '{$thisyear}-{$thismonth}-01 00:00:00' "
."AND to_char(b.meta_value, 'YYYY-MM-DD HH:MI:SS') <= '{$thisyear}-{$thismonth}-{$last_day} 23:59:59' "
."AND a.post_type = 'post' AND a.post_status = 'publish' AND a.ID = b.postid AND   b.meta_key='Event Date' 
```

或者，更简单地说：

```
SELECT a.ID, a.post_title, to_char(b.meta_value, 'DD') as dom "
."FROM $wpdb->posts a, $wpdb->postmeta b "
."WHERE to_char(b.meta_value, 'YYYY-MM') = '{$thisyear}-{$thismonth}' "
."AND a.post_type = 'post' AND a.post_status = 'publish' AND a.ID = b.postid AND   b.meta_key='Event Date' 
```

这假定`meta-value`存储为日期。如果没有，您必须处理将值转换为日期。我做出这个假设是因为你正在使用一个函数`DAYOFMONTH`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:38:32.530

据我所知，您在 MySQL 中的查询没有问题。以下两个语句产生相同的结果（尽管我更喜欢使用`JOIN`）。这是一个简化版本：

```
SELECT  *
FROM table1 t 
    JOIN table2 t2 on t.id = t2.id
WHERE t.dt >= '2011-01-02 00:00:00';

SELECT  *
FROM table1 t, table2 t2
WHERE t.dt >= '2011-01-02 00:00:00' 
   AND t.id = t2.id; 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/a5aba6/3)

# javascript - JS：OOP 私有函数/私有字段

> ID：15509811
> 
> 赞同：2
> 
> 时间：2013-03-19T20:30:18.543
> 
> 标签：javascript, oop, class

```
Systemname =
{

Question :
{
    send: function()
    {
        console.log("send");
    },

    read:   function()
    {
        console.log("read");
    },

    delete: function()
    {
        console.log("delete");
    }
},

Answer :
{
    send: function()
    {
        console.log("Answer sent");
    }
},

Person :
{
    foo: 'foo',
    bar: 'bar',

    add: function(name)
    {
        console.log('person "' + name + '" added');
    },

    remove: function(id)
    {
        console.log('person with id "' + id + '" removed');
    }
} 
```

}

我正在学习 oop 在 js 中的工作原理，现在我对私有方法和字段有点困惑。我想在人员部分有一些私人成员，例如“personCount”或“lastAddedPerson”。如果我像这样添加它们：

```
Person:
{
    personCount: 0,
    lastAddedPerson: '',
    ...
} 
```

在人员部分的开头，这些字段是公共的，可以使用 Systemane.Person.Field.... 我如何将它们设置为私有？对于方法也是如此。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:33:53.053

这是一种方法。

```
function Person(n) {
   var name = n;
   this.getName = function() {
     return name;
   }
   this.setName = function(newName) {
      name = newName;
   }
}

var person = new Person('roman'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:40:51.190

我喜欢使用一种工厂模式而不是`new`：

```
var Person = (function() {
   return { 
      create: function(name) {
         return (function(n) {
            var name = n;

            function getName() {
               return name;
            }

            function setName(newName) {
               name = newName;
            }

            return {
               getName: getName,
               setName: setName                    
            };
         }(name));
      }
   };   
})(); 
```

然后：

```
var person = Person.create("Bob");
person.getName(); //returns Bob

person.setName("Jimbo");
person.getName(); //returns Jimo 
```

看似复杂，其实很简单。

`Person`本质上被分配了匿名自调用函数的返回值。这个返回值有一个名为 的属性`create`，它是对另一个函数的引用，它或多或少像一个构造函数。该函数还返回另一个匿名自调用函数的返回值。但是，此返回值是您想要的对象的实际实例。在这个匿名自调用函数中，您可以看到我有一个名为`name`. 该变量是该匿名自调用函数的私有变量，并且在词法上绑定到定义它的范围。这意味着 的值`name`被保留在该函数中。基本上，即使在函数执行完成后它也会挂起。您可以访问或修改该变量的唯一方法是通过`getName`和`setName`功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:35:39.687

使用文字创建对象时，不能有私有属性或方法。实际上，JavaScript 中没有私有属性，但您可以通过使用构造函数并将私有属性和方法声明为变量来实现这一点：

```
function Person() {
    var privteProperty = 1;
    var privateMethod = function(){}

    this.publicProperty = 2;
    this.publicMethod = function(){}
} 
```

然后你可以创建一个实例：

```
var john = new Person(); 
```

# php - 检查mysql条目是否退出然后删除

> ID：15509815
> 
> 赞同：0
> 
> 时间：2013-03-19T20:30:32.710
> 
> 标签：php, mysql, forms, post

我有点陷入寻找解决方案的困境。

我需要检查表单中的输入数据 $coupon（在“发布”操作之后）是否等于 $Coupon 行中名为 Serial 的现有 MySQL 表中的数据。如果这两个条目匹配，我需要删除表“Serial”中的那个（删除自）。在另一种情况下，我需要显示一个错误，例如回显“您输入的优惠券号码无效”。

现在我有以下代码，但它不做检查。

```
$query4="SELECT EXISTS(SELECT 1 FROM serial WHERE Coupon='$coupon')";
$result = mysql_query($query4);

if($result){
    echo "Bravo!";
}
else{
    "The coupon number you've entered is invalid";
    exit;
}
// Delete data from mysql
$query2="DELETE FROM serial WHERE Coupon = '$coupon'";
$result = mysql_query($query2); 

// if successfully insert data into database, displays message "Successful".
if($result){
echo "Some info";
}
else {
die(mysql_error());
} 
```

非常感谢任何想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:51:10.137

你已经为自己创造了一个竞争条件。优惠券在您运行 SELECT 语句时存在这一事实并不意味着它在您运行 delete 语句时也会存在，特别是如果这是一个 Web 应用程序，或多线程/多进程。

DELETE 语句从 tbl_name 中删除行并返回已删除行数的计数。这个计数可以通过调用 ROW_COUNT() 函数来获得。

无条件地运行您的 DELETE，然后使用 ROW_COUNT 查看它是否存在并被删除或不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:42:19.477

首先逐步淘汰**mysql_***功能，否则您会遇到比检查结果更大的问题。您的代码容易受到**SQL 注入**的攻击。请改用 PDO 或 MySQLi。

其次，为什么在第一个查询中需要**EXISTS呢？**

这是 PDO 中的解决方案：

```
 $query = 'SELECT 1 FROM serial WHERE Coupon = :coupon';
 $stmt = PDO->prepare($query);
 $stmt->bindParam(':coupon', $coupon, DB::PARAM_STR);
 $stmt->execute();
 if ($stmt->rowCount() > 0) {
    //query 2
    $query2 = "DELETE FROM serial WHERE Coupon = :coupon";
    $stmt2 = PDO->prepare($query2);
    $stmt2->bindParam(':coupon', $coupon, DB::PARAM_STR);
    if ($stmt2->execute()) {
       echo 'Success';
    } else {
       echo 'Unable to Delete';
    }
 } else {
    echo 'Selected Coupon Is Invalid'; 
 } 
```

**或更简单地在一个查询中：**

```
$query = 'DELETE FROM serial WHERE coupon = :coupon';
$stmt = PDO->prepare($query);
$stmt->bindParam(':coupon', $coupon, DB::PARAM_STR);
if ($stmt->execute()) {
  echo 'Success';
} else {
  echo 'failure, invalid coupon';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:40:13.700

你实际上可以做`SELECT 1 FROM serial...`

然后：

```
$result = mysql_query($query4);
if (mysql_num_rows($result)) { 
```

如果它返回一行，你就知道它存在。您还可以添加`LIMIT 1`到查询中以使其更快。

* * *

顺便说一句，你的代码很容易被注入。您应该对 PDO 或 mysqli 使用正确的参数化查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-20T21:38:09.450

跟进mluebke的回答：

```
// Delete data from mysql
$query="DELETE FROM serial WHERE Coupon = '$coupon'";
mysql_query($query); 

//Did we delete something?
if (mysql_affected_rows()) {
  echo "Bravo!";
}
else{
    "The coupon number you've entered is invalid";
    exit;
} 
```

[http://www.php.net/manual/en/function.mysql-affected-rows.php](http://www.php.net/manual/en/function.mysql-affected-rows.php) [http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_row-count](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_row-count)

# c# - 字典 KeyCollection 奇怪

> ID：15509818
> 
> 赞同：4
> 
> 时间：2013-03-19T20:30:38.390
> 
> 标签：c#, .net

我有一个涉及字典的神秘情况，我从字典中枚举键，但字典不包含它所说的某些键。

```
Dictionary<uint, float> dict = GetDictionary(); // Gets values, 6268 pairs
foreach(uint key in dict.Keys)
{
   if (!dict.ContainsKey(key))
      Console.WriteLine("Wat? "+key);
} 
```

以上将打印 6268 个密钥中的两个。这两个键没有什么特别之处，都是小于 Int32.MaxValue 的正值（369099203 和 520093968）。

对计数的检查揭示了这一点：

```
Console.WriteLine(dict.Count);                           // 6268
Console.WriteLine(dict.Keys.Count());                    // 6268
Console.WriteLine(dict.Keys.Count(dict.Keys.Contains));  // 6266 
```

这是在 .NET4.5 CLR 下运行的~~单线程.NET4 代码。~~字典是香草，`Dictionary<uint, float>`即**没有自定义相等比较器**。我假设由于 uint/int 差异而发生哈希问题，但不`ContainsKey(key)`应该保证字典的 Key 集合中返回的所有键都是真的吗？尤其是当您只查看下面代码片段中的 KeyCollection 对象时，总计数和包含对象的计数是关闭的，这感觉像是一种奇怪的`ICollection`行为。

**编辑：**

正如预期的那样，似乎有一个合理的解释：集合在初始化期间*被*两个并发线程修改过。当某些东西“有时会中断”时，这是一个线程问题，果然如此。从多个线程访问一个 dict 显然会扰乱内部状态，使其在其生命周期的剩余时间内处于半功能状态，但不会导致任何异常。

我要切换到并发字典，并可能删除这个问题。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T21:04:12.840

我没有足够的代表发表评论 - 但我确实试图重现您的问题但无济于事。我会建议你发布 GetDictionary() 是如何工作的，我也建议不要像那样遍历字典，而是在下面做，看看是否能解决它：

```
foreach (KeyValuePair<uint, float> pair in dict)
    Console.WriteLine("[" + pair.Key + "]=" + pair.Value); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T21:10:04.753

GetDictionary() 在构造字典时是否有可能添加自定义键相等比较器？如果是这样，问题可能与比较器实现有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T22:04:29.517

我也遇到了 System.Uri 类似的奇怪行为。

结果是存储在字典中的键和我用来查找的键之间的架构不匹配。特别是，存储在字典中的 Uri 是 32 位的，而我正在寻找 64 位的。显然，由于**不同架构之间的 GetHashcode() 不相等**，因此字典无法匹配键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T21:16:55.320

**重要提示：**当我在`GetHashCode`整个帖子中提到时，我指的是`IEqualityComparer<T>.GetHashCode`. 默认情况下，字典将使用`EqualityComparer<T>.Default`，它将返回调用`GetHashCode`键本身的结果。但是，您可以在创建字典时提供特定的实现`IEqualityComparer<T>`以使用不同的行为。

如果键的结果`GetHashCode`在值添加到字典的时间和您枚举键的时间点之间发生变化，则可能会发生这种情况。当您枚举键时，它会返回数组中所有填充的“桶”的键。但是，当您查找*特定*键时，它会根据键的结果重新计算*预期*的存储桶`GetHashCode`。如果哈希码发生变化，那么字典桶中键/值对的实际位置和预期位置可能不再相同，在这种情况下`Contains`将返回 false。

您应该确保`GetHashCode`在将值添加到键的字典后，字典中键的结果不会改变。

# excel - 如何删除一系列单元格中的所有复选框

> ID：15509820
> 
> 赞同：0
> 
> 时间：2013-03-19T20:30:40.790
> 
> 标签：excel, vba

我有代码可以删除某个单元格中的复选框，但我需要它来删除我选择的范围内的所有复选框。以下是我删除某个单元格中的复选框的代码。

```
Columns("B:B").Select
Selection.Find(What:="FIELD SERVICES", After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
ActiveCell.Offset(1, -1).Select
Dim CB8 As CheckBox
For Each CB8 In ActiveSheet.CheckBoxes
    If CB8.TopLeftCell.Address = ActiveCell.Address Then CB8.Delete
    Next 
```

以下是我如何尝试更改它以删除我需要的范围内的单元格，但它只删除范围的第一个单元格中的复选框。

```
Columns("B:B").Select
Selection.Find(What:="FIELD SERVICES", After:=ActiveCell, LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate
Range(ActiveCell.Offset(1, -1), ActiveCell.Offset(8, 0).Select
Dim CB8 As CheckBox
For Each CB8 In ActiveSheet.CheckBoxes
    If CB8.TopLeftCell.Address = ActiveCell.Address Then CB8.Delete
    Next 
```

任何意见是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:48:12.073

```
Dim f as Range, cbRange as range
Dim CB8 As CheckBox

Set f = Columns("B:B").Find(What:="FIELD SERVICES", After:=ActiveCell, _
                            LookIn:=xlFormulas, LookAt:=xlPart)

if not f is Nothing then
   set cbRange = f.parent.range(f.Offset(1, -1), f.Offset(8, 0))
   For Each CB8 In ActiveSheet.CheckBoxes
     If not application.intersect(CB8.TopLeftCell, cbRange) is nothing Then CB8.Delete
   Next
end if 
```

# multithreading - OBSE 和 Boost.Asio：线程异步 UDP 服务器，在同一个 io_service 上具有 deadtime_timer

> ID：15509822
> 
> 赞同：0
> 
> 时间：2013-03-19T20:30:42.470
> 
> 标签：multithreading, plugins, boost, udp, boost-asio

*   **平台**：Windows 7 Professional 64 位
*   **编译器**：VS2010 Express
*   **提升**：版本 1.49
*   **插件系统**：OBSE 20（用于 Bethesda 的 Oblivion 游戏）

我有一个基于异步 udp 示例的类。我将 io 服务本身作为线程运行。这是该类的代码：

```
 // udp buffer queues
    extern concurrent_queue<udp_packet> udp_input_queue; // input from external processes
    extern concurrent_queue<udp_packet> udp_output_queue; // output to external processes

    using boost::asio::ip::udp;
    class udp_server
    {
    public:
        udp_server(boost::asio::io_service& io_service, short port)
            : io_service_(io_service),
              socket_(io_service_, udp::endpoint(boost::asio::ip::address_v4::from_string(current_address), port))//, // udp::v4()  
        {
            // start udp receive
            socket_.async_receive_from(
                boost::asio::buffer(recv_buf), sender_endpoint_,
                boost::bind(&udp_server::handle_receive_from, this,
                  boost::asio::placeholders::error,
                  boost::asio::placeholders::bytes_transferred));  

            send_timer_ = NULL;            
        }

        ~udp_server(){
            io_service_.stop();
            if(send_timer_){
                send_timer_->cancel();
                delete send_timer_;
            }
        }

        void start(){
            // start send timer                
            send_timer_ = new boost::asio::deadline_timer(io_service_, boost::posix_time::milliseconds(500));
            send_timer_restart();
        }

        void handle_send_to(const boost::system::error_code& error, size_t bytes_recvd);
        void handle_receive_from(const boost::system::error_code& error, size_t bytes_recvd);

        //void handle_send_timer(const boost::system::error_code& error);
        void handle_send_timer();
        void send_timer_restart();

        void stop()
        {
            io_service_.stop();
        }

        private:
            boost::asio::io_service& io_service_;
            udp::socket socket_;
            udp::endpoint sender_endpoint_; 
            std::vector<udp::endpoint> clientList;
            //std::auto_ptr<boost::asio::io_service::work> busy_work;
            udp_buffer recv_buf;
            boost::asio::deadline_timer* send_timer_;
    }; 
```

现在我像这样实例化类和线程：

```
 udp_server *udp_server_ptr=NULL;
    boost::asio::deadline_timer* dlineTimer=NULL;
    static void PluginInit_PostLoadCallback()
    {   
        _MESSAGE("NetworkPipe: PluginInit_PostLoadCallback called");

        if(!g_Interface->isEditor)
        {
            _MESSAGE("NetworkPipe: Starting UDP");
            udp_server_ptr = new udp_server(io_service, current_port);
            //dlineTimer = new boost::asio::deadline_timer(io_service);
            udp_thread = new boost::thread(boost::bind(&boost::asio::io_service::run, &io_service));         
            //
            _MESSAGE("NetworkPipe: UDP Started");
            NetworkPipeEnable = true;
        }
        else
        {
            _MESSAGE("NetworkPipe: Running in editor, not starting UDP");
        }    
    } 
```

现在注意 dlineTimer 在上面被注释掉了。如果我启用它，它将停止运行。我可以让 dlineTimer 与此 io 服务一起运行的唯一方法是在`udp_server::handle_receive_from`调用期间创建它。我认为这是因为它在另一个线程内运行。所以由于某种原因，`deadline_timer`对象不喜欢在它需要在内部运行的线程之外创建。

现在，为了与主线程通信，我使用`concurrent_queue`对象。所以这些让我可以非常简单地在线程中发送消息。理论上我可以`dlineTimer`在它自己的线程内部运行并使用输出队列来管理它的活动。但是，我喜欢与`udp_server`. 例如，`udp_server`对象在向量中跟踪客户端。当`deadline_timer`到期时，我会循环访问已知的客户端并向他们发送消息。然后我重新启动计时器。这使得我的响应独立于发送到服务器的 udp 数据包。因此，当数据包到达时，它们会被放入队列中，等待处理的另一部分。然后将后面的数据放在输出队列中，然后`deadline_timer`处理这些响应并将它们发送给适当的客户端。

所以我的主要问题是：

如何`deadline_timer`使用与对象相同的线程`io_service`更干净地创建`udp_server`对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T03:40:40.697

好吧，我真的很愚蠢地想着这个。

*   首先，deadline_timer 需要完全在我希望它计时的线程内。这意味着它需要在线程内创建。
*   其次，我需要定义线程循环中调用的函数，而不是将其设置为 io_service::run 函数。所以我把它做成了 udp_server::start 函数。在 start 调用中，我创建了自己的 deadline_timer。

所以这里是类：

```
 class udp_server
    {
    public:
        udp_server(boost::asio::io_service& io_service, short port)
            : io_service_(io_service),
              socket_(io_service_, udp::endpoint(boost::asio::ip::address_v4::from_string(current_address), port))//, // udp::v4()  
        {
            // start udp receive
            socket_.async_receive_from(
                boost::asio::buffer(recv_buf), sender_endpoint_,
                boost::bind(&udp_server::handle_receive_from, this,
                  boost::asio::placeholders::error,
                  boost::asio::placeholders::bytes_transferred));  

            send_timer_ = NULL;            
        }

        ~udp_server(){
            io_service_.stop();
            if(send_timer_){
                send_timer_->cancel();
                delete send_timer_;
            }
        }

        void start();

        void startSendTimer();

        void handle_send_to(const boost::system::error_code& error, size_t bytes_recvd);
        void handle_receive_from(const boost::system::error_code& error, size_t bytes_recvd);

        void handle_send_timer();
        void send_timer_restart();

        void stop()
        {
            io_service_.stop();
        }

        private:
            boost::asio::io_service& io_service_;
            udp::socket socket_;
            udp::endpoint sender_endpoint_; 
            std::vector<udp::endpoint> clientList;               
            udp_buffer recv_buf;
            boost::asio::deadline_timer* send_timer_;                
    }; 
```

以下是相关功能：

```
 void udp_server::start(){
        // startup timer
        startSendTimer();

        // run ioservice
        io_service_.run();
    }

    void udp_server::startSendTimer(){            
        // start send timer 
        if(!send_timer_)
            send_timer_ = new boost::asio::deadline_timer(io_service_, boost::posix_time::milliseconds(500));
        send_timer_restart();
    }

    void udp_server::send_timer_restart(){    
        if(send_timer_){
            // restart send timer
            send_timer_->expires_from_now(boost::posix_time::milliseconds(500));
            send_timer_->async_wait(boost::bind(&udp_server::handle_send_timer, this));
        }
    }        

    void udp_server::handle_send_timer(){            
        for(std::vector<udp::endpoint>::iterator itr = clientList.begin(); itr != clientList.end(); ++itr){
            socket_.async_send_to(
                boost::asio::buffer("heart beat", strlen("heart beat")), *itr,              
                boost::bind(&udp_server::handle_send_to, this,
                boost::asio::placeholders::error,
                boost::asio::placeholders::bytes_transferred));
        }

        send_timer_restart(); 
    } 
```

所以我一开始就认为这一切都是错误的。我需要定义线程开始执行的起点。我可以创建需要驻留在该线程内部的对象。

udp_server 现在像这样启动：

```
 static void PluginInit_PostLoadCallback()
    {   
        _MESSAGE("NetworkPipe: PluginInit_PostLoadCallback called");

        if(!g_Interface->isEditor)
        {
            _MESSAGE("NetworkPipe: Starting UDP");
            udp_server_ptr = new udp_server(io_service, current_port);                 
            udp_thread = new boost::thread(boost::bind(&udp_server::start, udp_server_ptr));         
            _MESSAGE("NetworkPipe: UDP Started");
            NetworkPipeEnable = true;
        }
        else
        {
            _MESSAGE("NetworkPipe: Running in editor, not starting UDP");
        }    
    } 
```

现在在udp_thread 中创建deadline_timer。在主线程中创建deadline_timer 对象会导致程序无法正常加载。

# java - 我的 TextView Layout Inflater 有什么问题？

> ID：15509823
> 
> 赞同：0
> 
> 时间：2013-03-19T20:30:42.810
> 
> 标签：java, android

我正在尝试将 TextView 动态添加到 LinearLayout，但出现错误并且不知道如何修复它：

```
03-19 16:25:07.057: ERROR/AndroidRuntime(16910): FATAL EXCEPTION: main
    android.view.InflateException: Binary XML file line #3: Error inflating class <unknown>
    at android.view.LayoutInflater.createView(LayoutInflater.java:613)
    at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
    at android.view.LayoutInflater.onCreateView(LayoutInflater.java:660)
    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:685)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:466)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:215)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220)
    at com.fincalc.financialcalculator.MainActivity.simulateDebtLifeSpan(MainActivity.java:220) 
```

这是被引用的 XML 布局文件：

```
<?xml version="1.0" encoding="utf-8"?>

<TextView xmlns:android="http://schemas.android.com/apk/res/android"
      android:layout_width="match_parent"
      android:layout_height="match_parent" /> 
```

我解决这个问题的代码：

```
 public void simulateDebtLifeSpan(CreditCard card){
    LinearLayout ll = (LinearLayout)getLayoutInflater().inflate(R.layout.simulatedminimumpayments,null);
    if (card.balance>0){
       -line 215- TextView sim = (TextView)getLayoutInflater().inflate(R.layout.paymentrow,null);
        double newBalance =  card.getBalance()-card.getMinimumPayment(card.getBalance());
        sim.setText("Starting Balance: " + card.getBalance() + " Minimum Payment: " + card.getMinimumPayment(actBalance) + " New Balance: " + newBalance);
         ll.addView(sim);
         card.setBalance(newBalance);
         simulateDebtLifeSpan(card);
        return;
    }else {
        setContentView(R.layout.simulatedminimumpayments);
     return;
    }
} 
```

充气机让我很困惑我仍然有类似的代码可以充气表格行，然后将它们添加到工作正常的表格布局中：/有人可以帮我理解我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:50:42.783

尝试这样的事情：

```
LinearLayout layout1 = (LinearLayout) LayoutInflater.from(mCtx).inflate(R.layout.one_fifty_two_init, null); 
```

如果您在一个内部类或其他位置（onTouchListener）等中。它无法访问上下文（即您不能使用关键字 this），您也可以尝试：

```
LinearLayout layout1 = (LinearLayout) LayoutInflater.from(MyActivity.this).inflate(R.layout.one_fifty_two_init, null); 
```

哦，尝试将您的 TextView 包装在 XML 中的线性布局中。

编辑：

尝试这个：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/wrapper_layout"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    >
<TextView
    ....your text view params
/>
</LinearLayout> 
```

我唯一的想法是，这可能是因为您的视图没有包含在充气器 barfs 的布局中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:54:59.990

尝试这个

```
TextView sim = (TextView) View.inflate(this,R.layout.paymentrow,null); 
```

# java - Java - 运行外部代码

> ID：15509828
> 
> 赞同：1
> 
> 时间：2013-03-19T20:31:01.953
> 
> 标签：java, file, external

我想要一个可以读取 .CLASS 文件并运行该代码的 Java 程序，将自身用作 .CLASS 文件的库。这是可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:52:38.293

`java.lang.ClassLoader`

将帮助您加载外部类。

`java.lang.reflect.Method`

将帮助您调用已加载的外部类的方法。

小例子：

```
ArrayList<URL> urls = new ArrayList<URL>();
urls.add(new File("/path/to/your.class").toURI().toURL()); //can add several..

ClassLoader cl = new URLClassLoader(urls.toArray(new URL[urls.size()]));
Class<?> c;
c = Class.forName("your.class.name", false, cl); //now you have your class

Method m = c.getMethod("main", String[].class); //now your have your method
m.invoke(null, new Object[] { "argument1", "argument2" }); //now you "run that code" 
```

我没有运行任何东西，我只是写它来向您展示一些可以帮助您的工具。

# asp.net - 我应该只在“丰富的 html 值”上使用 html sanitizer 吗？

> ID：15509829
> 
> 赞同：0
> 
> 时间：2013-03-19T20:31:02.457
> 
> 标签：asp.net, security, asp.net-mvc-4, xss

我是否需要清理传递给我的控制器的所有字符串值或只是像编辑器这样的富 html？

那么 input ， type 文本字段呢？

```
<input type="text" name"test1" value="<script></script>" />

public ActionResult TestAction(string test1){ //save in db } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:44:21.593

Always sanitize data being sent to the server. You don't want anyone to arbitrarily send data to your server of any type. Some HTML tags, such as `<script>` elements, can be harmful. You don't want the user storing JavaScript code in your content pages as it could be malicious for other users.

# ruby-on-rails-3 - Rails Omniauth-github (422) 你想要的改变被拒绝了

> ID：15509830
> 
> 赞同：1
> 
> 时间：2013-03-19T20:31:07.347
> 
> 标签：ruby-on-rails-3, omniauth, github-api

我已经为 Omniauth 和 Github 实施了[这个解决方案](http://railscasts.com/episodes/241-simple-omniauth-revised?view=asciicast)并且工作正常，但在过去几个月的某个时候它停止了工作。

我尝试登录时遇到的错误是：（422）您想要的更改被拒绝。

特别是在我看到的 Heroku 日志中：

```
ActiveRecord::RecordInvalid (Validation failed: Password can't be blank):
app/models/user.rb:18:in `create_from_omniauth'
app/models/user.rb:14:in `from_omniauth'
app/controllers/sessions_controller.rb:4:in `create' 
```

创建用户时是否需要保存凭据？

我的用户模型：

```
def self.from_omniauth(auth)
  where(auth.slice("provider", "uid")).first || create_from_omniauth(auth)
end

def self.create_from_omniauth(auth)
  create! do |user|
    user.provider = auth["provider"]
    user.uid = auth["uid"]
    user.name = auth["info"]["nickname"]
    user.email = auth["info"]["email"]
    user.image = auth["info"]["image"]
 end
end 
```

会话控制器：

```
class SessionsController < ApplicationController

def create
  user = User.from_omniauth(env["omniauth.auth"])
  session[:user_id] = user.id
  redirect_to root_url, notice: "Signed in!"
end

def destroy
  session[:user_id] = nil
  redirect_to root_url, notice: "Signed out!"
 end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-27T05:18:27.333

**由于您在模型中设置了验证，因此可能会出现**Facebook 的 omniauth 错误“您想要的更改被拒绝” 。**我不得不为拥有一封唯一电子邮件的用户重构我的验证，当用户尝试使用相同的电子邮件登录 facebook 时，该验证不起作用。**

 **看看你的日志。`heroku logs -t`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T23:14:30.000

看起来您要么正在验证`User`模型中是否存在密码字段，要么正在使用`has_secure_password`，这在幕后进行。

如果您自己进行验证，则只需`:if => :password_changed?`在验证中添加一个子句。

如果您使用的是`has_secure_password`，这取决于您使用的是哪个版本的 Rails。任何具有[这](https://github.com/rails/rails/commit/0e1e527654f286452fa6f86f5d229f278435319a) [两个](https://github.com/rails/rails/commit/0e1e527654f286452fa6f86f5d229f278435319a)更改的版本（我相信只有 Rails 4）都支持将`validations: false`选项传递给`has_secure_password`. 否则，除了在创建用户时设置一个随机的虚拟密码然后让他们立即更改之外，没有真正好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-24T21:38:42.063

当我的 gitlab 服务器上的时间不同步时，我遇到了这个问题，我重新启动了 ntpd，它更正了服务器上的时间并解决了问题**

# ios - didSelectItemAtIndexPath pushViewController

> ID：15509831
> 
> 赞同：0
> 
> 时间：2013-03-19T20:31:08.080
> 
> 标签：ios, model, nsmutablearray, uicollectionview

我正在尝试完成一些非常简单的事情。当我的集合视图中的唯一项目被推送时，我试图以编程方式推送到 viewController。什么都没发生。我相信在我纠结的一团糟中存在不止一个问题。我对数组基础知识的理解显然不是。如果我在下面的 if 语句中放入 NSLog 行，则在推送我的唯一项目时我什么也得不到。这是我的 didSelectItemAtIndexPath 方法：

```
NSMutableArray *itemApp = [model.viewControllers objectAtIndex:indexPath.row];

if (itemApp == 0) {
    NSLog (@"This does not appear")
    TableViewController *ctc = [[TableViewController alloc] initWithStyle:UITableViewStylePlain];
    [self.navigationController pushViewController:ctc animated:YES];
} 
```

模型在 viewDidLoad 中定义：

```
 model = [[SimpleModel alloc] init]; 
```

.m 实现中提到了 SimpleModel：

```
@implementation smileController;

{
SimpleModel *model;
} 
```

viewControllers 是 SimpleModel 类及其朋友应用程序的属性：

```
@property (nonatomic, strong) NSMutableArray *apps;
@property (nonatomic, strong) NSMutableArray *viewControllers; 
```

这是 SimpleModel.m

```
 - (id)init
{
if (self = [super init])
{

    self.apps = [NSMutableArray arrayWithObjects:@"1", nil];

    self.viewControllers = [NSMutableArray arrayWithCapacity:self.apps.count];

    TableViewController *tvc = [[TableViewController alloc] init];

    [self.viewControllers addObject:tvc];
}
return self;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:46:38.357

在`SimpleModel.m`您`viewControllers`使用单个`TableViewController`.

鉴于此，当您发布的第一个代码块应该更像这样：

```
TableViewController *itemApp = [model.viewControllers objectAtIndex:indexPath.row];

if (itemApp) {
    NSLog (@"This should appear")
    [self.navigationController pushViewController:itemApp animated:YES];
} 
```

这假设您要推送从`model.viewControllers`属性获得的视图控制器。

请注意，`itemApp`只能是`nil`if`model`或`model.viewControllers`are `nil`。

# php - .htaccess 将 html 重定向到 php 并访问没有 .php 扩展名的 php 文件

> ID：15509835
> 
> 赞同：2
> 
> 时间：2013-03-19T20:31:11.170
> 
> 标签：php, linux, .htaccess, mod-rewrite

我希望用这个 .htaccess 文件完成两件事。

1) 所有对 .html 的请求都指向 .php 例如。用户访问：[http](http://www.mywebsite.com/contact.html) ://www.mywebsite.com/contact.html 浏览器加载：[http ://www.mywebsite.com/contact.php](http://www.mywebsite.com/contact.php)

2）请求[http://www.mywebsite.com/contact](http://www.mywebsite.com/contact)将加载contact.php（这应该适用于所有页面，而不仅仅是联系页面。

这是我的 .htaccess 文件。

```
Options -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ $1.php [L] 
```

老实说，我不知道这些在做什么。我将它们从我读过的杂乱无章的文章中混合在一起。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T20:37:15.763

尝试这样的事情。关注评论线程以了解安全隐患，但这是您要求做的

```
RewriteEngine On
RewriteBase /

# Redirect HTML to PHP
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*).html$ $1.php [L]

# Otherwise, try PHP
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !\.php$
RewriteRule ^(.*)$ $1.php [L]

# Lastly, fallback to error page
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . 404.php [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:44:12.800

I need to explain something to you about htaccess file roles;

In this example, htaccess will try and match patterns, as you need in your example;

If a pattern is matched, then some action will happen;

you mark with () all the data than you need to be extracted from the url

For each rule, the first () will have the $1 id, the seccond () will have $2 and so on

if $1 is 'help' it will load the 'helpme.php' file maybe, and not the 'help.php' file; it will load the file that you want it to be loaded;

using $1, $2 ... you can pass parameters and values to the real/translated url request

in my example, i wanted to always use the index.php file, you will use whatever file you need

```
Options +SymLinksIfOwnerMatch

RewriteEngine on

RewriteRule ^([a-zA-Z-]+)$ index.php?action=$1 [NC,L]

RewriteRule ^(member)-([0-9-]+)$ index.php?action=member&id=$2 [NC,L]

RewriteRule ^([a-zA-Z-]+)/([a-zA-Z-]+)-([0-9-]+)$ index.php?action=$1&saction=$2&sid=$3 [NC,L]

RewriteRule ^([a-zA-Z-]+)/([0-9-]+)$ index.php?action=$1&id=$2 [NC,L]

RewriteRule ^([0-9-]+)/([a-zA-Z0-9-]+)/([a-zA-Z0-9-]+)/([a-zA-Z0-9-]+)/(.*).html$ index.php?action=details&id=$1&p1=$2&p2=$3&p3=$4 [NC,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:46:03.950

如果您希望所有 .html 文件都指向 .php 文件，那么一种简单的方法是

```
RewriteRule ([\w\d\-_]+)(\.html)? $1.php [L] 
```

这还允许您使用子目录

contact.html 会重定向到contact.php

/subdir/page.html 将重定向到 /subdir/page.php 等等

# jquery - jQuery验证不同的错误

> ID：15509837
> 
> 赞同：1
> 
> 时间：2013-03-19T20:31:17.603
> 
> 标签：jquery, html, css, jquery-validate

我有一个简单的 html 表单，有多个输入。

当用户点击提交按钮而没有正确填充它们时，我正在使用 jQuery 验证来更改这些输入的背景颜色（我知道这并不理想，但字段名称是不言自明的，红色背景对我来说就足够了）。

但是，有些字段是 type=radio 或 type=checkbox，我无法更改它们的背景颜色。我想将此字段的文本颜色更改为红色，或将文本的背景颜色更改为红色。我不知道如何将两个不同的类应用于 jQuery 验证中的不同元素。

以下是我的代码的相关部分：

JS：

```
<script>
    $(document).ready(function(){
        $("#registerForm").validate({
            rules: {
                firstname: {
                    required: true,
                    minlength: 2
                },
                lastname: {
                    required: true,
                    minlength: 2
                },
                gender: {
                    required: true  
                },
                policy: "required"
            },
            errorClass: 'invalidField'
    });
</script> 
```

HTML：

```
<input id="firstname" name="firstname" />

<input id="lastname" name="lastname" />

<input type="radio" id="gender" name="gender" value="male" />Masculino
<input type="radio" id="gender" name="gender" value="female" />Feminino

<input type="checkbox" id="policy" name="policy" value="accept" />Eu li e aceito os termos acima 
```

CSS：

```
.invalidField {
    background-color: #ffdddd;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T21:05:34.903

尝试这个：

HTML：

```
<input id="firstname" name="firstname" />

<input id="lastname" name="lastname" />

<div>
    <input type="radio" id="gender" name="gender" value="male" />
    <span class="highlightMe">Masculino</span>

    <br/>

    <input type="radio" id="gender" name="gender" value="female" />
    <span class="highlightMe">Feminino</span>
</div> 
```

CSS：

```
.invalidField {
    background-color: #ffdddd;
}

.invalidField ~ .highlightMe {
    background-color: #ffdddd;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T23:43:48.710

你可以试试errorPlacement。将其放在 validate 函数中的左括号之后：

```
$("#registerForm").validate({ 
    errorPlacement: function (error, element) {
       if (element.attr("name") == "elementName") {
            $(element).css('background-color', '#ffdddd')
       }
    }, // continue your validation code (rules + errorclass)    
}); 
```

将“elementName”更改为您输入的名称。您可以更改 element.attr() == '' 以测试它是 type=radio 还是 type=checkbox。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T23:24:53.473

你不能在 jQuery validate 的每个元素上使用相同的类，而是使用更具体的 CSS 规则来获得你想要的着色，例如：

```
.invalidField {
    background-color: #ffdddd;
}
input[type=checkbox].invalidField,
input[type=radio].invalidField {
    color: #ffdddd;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T15:27:52.380

您将需要使用`highlight`和`unhighlight`回调函数选项。从默认值开始，只需编辑它们以对元素执行不同`radio`的操作。`checkbox`

我已经通过更改条件语句来查找`radio`或`checkbox`元素来修改默认值。在验证每个元素时，这些回调会针对每个元素触发。

*   `hightlight`每当特定元素出现错误时触发。

*   `unhighlight`每当特定元素通过验证时触发。

您只需要调整这两个函数中每一个的一部分，即可对这些元素进行任何您需要的样式设置。

```
 highlight: function (element, errorClass, validClass) {
        if (element.attr("type") === "radio" || element.attr("type") === "checkbox") {
            // change this line to add special 'error' styling to radio and checkbox elements
            this.findByName(element.attr("name")).addClass(errorClass).removeClass(validClass);
        } else {
            $(element).addClass(errorClass).removeClass(validClass);
        }
    },
    unhighlight: function (element, errorClass, validClass) {
        if (element.attr("type") === "radio" || element.attr("type") === "checkbox") {
            // change this line to remove the special 'error' styling to radio and checkbox elements
            this.findByName(element.attr("name")).removeClass(errorClass).addClass(validClass);
        } else {
            $(element).removeClass(errorClass).addClass(validClass);
        }
    }, 
```

在演示中，我使用了[您回答](https://stackoverflow.com/a/15527491/594235)中的代码。

**演示：http: [//jsfiddle.net/qwj5S/](http://jsfiddle.net/qwj5S/)**

```
 highlight: function (element, errorClass, validClass) {
        if ($(element).attr("name") === "gender") {
            $('.genderError').addClass('invalidField');
        } else if ($(element).attr("name") === "policy") {
            $('.policyError').addClass('invalidField');
        } else {
            $(element).addClass(errorClass).removeClass(validClass);
        }
    },
    unhighlight: function (element, errorClass, validClass) {
        if ($(element).attr("name") === "gender") {
            $('.genderError').removeClass('invalidField');
        } else if ($(element).attr("name") === "policy") {
            $('.policyError').removeClass('invalidField');
        } else {
            $(element).removeClass(errorClass).addClass(validClass);
        }
    }, 
```

**CSS**：

没有特殊的 CSS。这使用相同的`invalidField`类，因为它共享相同的属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T15:14:54.843

我设法通过在收音机和复选框输入中添加一些特定的 JS 来做我想做的事。这是我所做的：

JS：

```
$('#policy').change(function(){
    if (this.checked) {
        $('.policyError').css('background-color', '#ffffff')
    }
    else {
        $('.policyError').css('background-color', '#ffdddd')
    }
});
$('.gender').change(function() {
    $('.genderError').css('background-color', '#ffffff')
}); 
```

HTML：

```
<input type="radio" class="gender" name="gender" value="male" ><span class="genderError">Masculino</span>
<input type="radio" class="gender" name="gender" value="female" /><span class="genderError">Feminino</span>
<input type="checkbox" id="policy" name="policy" value="accept" /><span class="policyError">Eu li e aceito os termos acima</span> 
```

CSS：

```
.invalidField {
    background-color: #ffdddd;
}
.invalidField ~ .genderError {
    background-color: #ffdddd;
}
.invalidField ~ .policyError {
    background-color: #ffdddd;
} 
```

# c++ - 添加断点会改变程序行为

> ID：15509839
> 
> 赞同：1
> 
> 时间：2013-03-19T20:31:23.047
> 
> 标签：c++, eclipse, breakpoints

我正在使用的一些代码存在一个奇怪的问题：据我所知，据我检查，代码中没有依赖任何随机的组件，例如系统时间等。但这足以只需在代码中添加一个断点，程序的行为就会发生变化。它没有做错任何事情，只是表现不同（在代码中通过某个值选择了几个对象，所有对象都为 0 - 它只是在添加断点时选择值为 0 的不同对象） . 不幸的是，不可能发布任何代码，因为它太多了。

什么可能导致这种行为？

编辑：我在这个问题上花了更多时间：它似乎与断点本身无关 - 产生不同结果的“最简单”方法如下：从项目的不同 .cpp 文件启动调试过程时输出已经不同了。当禁用“自动构建”时，这不再发生。我由此得出结论，即使代码没有变化，也会重建一些东西。我还将其范围缩小到实际导致不同行为的类：它是斐波那契堆的实现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T22:52:17.393

如果您不在 Windows 上运行，请考虑使用[Valgrind](http://valgrind.org/info/about.html) -[这些是受支持的平台](http://valgrind.org/info/platforms.html)。[Memcheck](http://valgrind.org/info/tools.html#memcheck)工具将运行您的程序（较慢），查看每个内存引用以跟踪未初始化变量的使用。

Memcheck 可以检测您的程序是否：

*   访问它不应该访问的内存（尚未分配的区域、已释放的区域、堆块末尾的区域、堆栈的不可访问区域）。
*   以危险的方式使用未初始化的值。
*   泄漏内存。
*   堆块的错误释放（双重释放，不匹配的释放）。
*   将重叠的源和目标内存块传递给 memcpy() 和相关函数。

# c++ - 类似类的 C++ 类模板

> ID：15509844
> 
> 赞同：0
> 
> 时间：2013-03-19T20:31:48.887
> 
> 标签：c++, oop, templates

我有一个套接字数据类型类，用于从套接字流中读取和解析一个值（也可以用于文件）。
让我的课是`mc_double`：

```
class mc_double {
    private:
           double value;
    public:
           bool read(socket);
           write(double);
} 
```

实际的类比较复杂，但这是原理。现在，我需要`float`从流中解析。Float 与 double 类似，因此已经实现`int`。我不能将这个类定义与 all和`double`以某种方式模板化吗？`int``float`

这就是我的意思：

```
 class mc_<typename = double or int or float> {
    private:
           typename value;
    public:
           bool read(socket);
           write(typename);
} 
```

然后将单独定义某些方法，因为`mc_double::method()`其他方法对于所有类型都是相同的：`mc_typename::general_method()`. 此外，对于某些人来说，我只需要对代码进行微小的更改：

```
typename mc_typename::return_value() {
         return val;
} 
```

或构造函数：

```
mc_typename::mc_typename(<int, long, char, double> number) {
        val = (typename)number;
} 
```

结果应该是**三个**类-`mc_int`和。 我找到了官方的 C++ 模板文档，但我只弄清楚了问题的最后一部分——我可以创建一个接受多种数据类型的函数。其余的似乎并不那么容易。`mc_float``mc_double`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:37:34.490

你可以让你的班级成为班级模板：

```
template<typename T, bool base = true>
class mc {
protected:
   T value;
public:
   bool read(socket);
   write(T);
}; 
```

此类将包含所有类型通用的成员函数`T`。然后，您可以针对不同的类型分别专门化此类模板，*并*让它们继承自`mc<T, true>`：

```
template<>
class mc<double, true> : public mc<double, false> {
public:
    // Member functions for double only...
};

template<>
class mc<int, true> : public mc<int, false> {
public:
    // Member functions for int only...
}; 
```

`protected`如果您希望派生类访问它们，请确保制作主类模板的非公共成员数据。

然后你可以用这种方式实例化它们：

```
mc<double> m;
mc<int> m;
// ... 
```

如果您真的想使用`mc_double`and`mc_int`名称，那么您可以：

a) 为它们创建类型别名：

```
typedef mc<double> mc_double;
typedef mc<int> mc_int; 
```

b) 将类模板的设计改为不使用特化，只有一个模板参数，并独立创建派生类：

```
template<typename T>
class mc {
protected:
   T value;
public:
   bool read(socket);
   write(T);
};

class mc_double : public mc<double> {
public:
    // Member functions for double only...
};

class mc_int: public mc<int> {
public:
    // Member functions for int only...
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:37:53.383

您可以在类定义中使用模板，如下所示：

```
template <typename T>
class mc
{
public:
   bool write(T _val);

private:
   T mVal;
}; 
```

但是您不能根据 T 的类型轻松地专门化某些方法而不是其他方法（即，您必须专门化整个类，而不仅仅是一种方法）。您可以通过某种继承层次结构来解决这个问题，其中无论类型如何都相同的方法在基类中，而专业化在派生类中。所以保留上述内容（假设`write`是一个不变的）并创建：

```
class mc_double : public mc<double>
{
public:
    void doSomethingSpecific() { /* code specific for 'doubles' */ }
}; 
```

# javascript - 弹出灯箱时，Internet Explorer 会触发“on(beforeunload)”

> ID：15509847
> 
> 赞同：2
> 
> 时间：2013-03-19T20:32:14.493
> 
> 标签：javascript, jquery, internet-explorer, onbeforeunload

这是我的代码：

```
$(window).on('beforeunload', function() {
   if ($('.jqmCustomize').css('display') == 'block')
     return 'You have not save your customization yet.';
}); 
```

这在 chrome 和 firefox 上运行良好，但在 Internet Explorer 上，当我的灯箱在同一页面中打开时，它会触发 on('beforeunload') 事件。有什么办法可以防止这种情况发生吗？我尝试过了：

```
var close=true;
window.onbeforeunload = closeConfirmation;
function closeConfirmation(){
   if(close)
     return 'You have not save your customization yet.';
} 
```

但我仍然得到相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:15:20.667

其实我看不出有什么问题。可能是我使用的是旧版本的 jqmodal 和 jquery，但它按预期工作：

[http://jsfiddle.net/xqhLx/5/](http://jsfiddle.net/xqhLx/5/)

```
$(function($){
  $('#jqModal').jqm();

   $('a').live('click',function(){
      $('#jqModal').jqmShow();    
      return false;
  }); 
});

$(window).on('beforeunload', function() {
   if ($('.jqmWindow').css('display') == 'block')
     return 'You have not save your customization yet.';
}); 
```

HTML：

```
<a href="/" >Test</a>

<div id="jqModal" class="jqmWindow" style="display: none;">This is the test</div> 
```

# android - Android facebook sdk 3.0 通过自定义按钮登录

> ID：15509848
> 
> 赞同：2
> 
> 时间：2013-03-19T20:32:21.653
> 
> 标签：android, facebook, facebook-android-sdk

Android facebook sdk 3.0 通过自定义按钮登录。我不想使用片段。只需单击一个按钮，然后 facebook 登录获取用户名、电子邮件、uid 和访问令牌。

如果 facebook 在一个对话框中登录没有问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-01-16T19:13:02.287

我意识到这是一个旧线程，但我遇到了类似的问题，而另一个答案对我不起作用。我想让我自己的自定义按钮具有与内置登录按钮相同的功能。

第一步是在我的 xml 文件中包含内置的 facebook 按钮，但将其可见性设置为“已消失”，因此用户无法看到它。

```
<com.facebook.widget.LoginButton
        android:id="@+id/authButton"
        android:visibility="gone"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:layout_marginTop="30dp"
        /> 
```

在我的主要活动中，我定义了隐藏的 facebook 按钮和我想使用的按钮

```
fbLoginButton = (Button) findViewById(R.id.authButton); //built in facebook button
customButton = (Button) findViewById(R.id.customButton); //my custom button 
```

然后在自定义按钮的 onClickListener 中，我在 facebook 按钮上使用了“.performClick”方法

```
customButton.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        fbLoginButton.performClick();
    }
}); 
```

这对我来说就像一个魅力。希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-19T21:16:03.157

1 - 在您的 AndroidManifest.xml 中添加 facebook 登录活动

```
 <activity android:name="com.facebook.LoginActivity" android:screenOrientation="portrait"></activity> 
```

2 - 按钮点击事件

```
Intent  i = new Intent(this,com.facebook.LoginActivity.class);
startActivity(i); 
```

这将打开 facebook 登录活动。

我向您推荐有关 facebook Session 的材料：[https ://developers.facebook.com/docs/reference/android/3.0/Session/](https://developers.facebook.com/docs/reference/android/3.0/Session/)

Session 可以由[UiLifecycleHelper管理](https://developers.facebook.com/docs/reference/android/3.0/UiLifecycleHelper/)

# opencv - 将大矩阵转换为图像

> ID：15509850
> 
> 赞同：0
> 
> 时间：2013-03-19T20:32:34.350
> 
> 标签：opencv, matrix

嗨所以我在文本文件中有一个大的 33 x 33 矩阵。我一直在研究一个 opencv 项目，它基本上读取帧并计算相似度。所以基本上，我现在有了这个充满数字的大文本文件。我如何在二维灰度图像中可视化这个矩阵？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:58:38.590

你的矩阵是一个`cv::Mat`对象吗？

如果是这样，请执行以下操作：

```
cv::Mat matrix;

//Load the matrix from the file
matrix = ...

//show the matrix
imshow("window name", matrix);

//save the image
imwrite("image.png", matrix); 
```

如果没有，请执行以下操作：

```
cv::Mat matrix = cv::Mat.create(33, 33, CV_32FC1);
float* floatPtr = matrix.ptr<float>();

for (int i=0;i<33*33;i++)
     //read data from file here
    *floatPtr++ = data[i] //if it's in an array
    //If you have a file stream then do: file>>*floatPtr++;

//show the image
imshow("window name", matrix);

//save the image
imwrite("image.png", matrix); 
```

# javascript - 单元测试 javascript 代码风格

> ID：15509851
> 
> 赞同：5
> 
> 时间：2013-03-19T20:32:35.287
> 
> 标签：javascript, node.js, unit-testing, jasmine, gruntjs

我开始使用 javascript 单元测试（使用 Jasmine）。

我有单元测试 C# 代码的经验。但是鉴于 javascript 是一种动态语言，我发现利用它并使用 javascript 的表达能力编写测试非常有用，例如：

```
describe('known plugins should be exported', function(){
    var plugins = ['bundle','less','sass','coffee','jsn','minifyCSS','minifyJS','forward','fingerprint'];

    plugins.forEach(function(plugin){
        it('should export plugin named ' + plugin, function(){
            expect(all[plugin]).toBeDefined();
        });
    });
}); 
```

至于做这种非常规的测试编写，我没有比做这种测试更进一步（带有非常相似的测试用例列表的数组）

所以我想我的问题是

编写这样的测试是否可以，或者我应该将自己限制在更“静态类型”的测试夹具上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T20:36:19.037

好问题！

是的，编写这样的单元测试非常好。甚至受到鼓励。

JavaScript 作为一种动态语言，可以让您真正轻松地模拟对象。DI 和 IoC*真的很*容易做到。一般来说，使用 Jasmine（或我个人更喜欢的 Mocha）进行测试是一种愉快而有趣的体验。

值得一提的是，由于您使用的是动态语言，因此您需要进行静态类型语言中没有的测试。测试通常强制执行现有的成员和方法以及类型。

没有接口来定义你的契约，通常，**你的测试定义了你的代码的契约**，所以在 C# 中你不会看到测试做这种验证（比如在你的代码中）并不罕见。

# regex - 正则表达式修改 Sysprep.inf 文件

> ID：15509852
> 
> 赞同：0
> 
> 时间：2013-03-19T20:32:36.393
> 
> 标签：regex, autoit

我目前需要解析 sysprep.inf 文件并插入最终用户输入的值。我正在使用 AutoIT 对这个实用程序进行编码，而我的正则表达式略有不同。我需要修改的行如下：

`ComputerName=%DeviceName%`

DeviceName 是 LANDesk 注入的变量。如果该设备先前已在 LANDesk 数据库中，则该名称将被注入到文件中。如果不是，则保留变量名。设备名称必须在`=`

这是我当前代码的片段：

```
$FileContents = StringRegExpReplace($FileContents,'ComputerName=[a-z]','ComputerName='& $deviceNameInput) 
```

感谢任何人都可以提供的任何指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:43:35.130

我不熟悉 AutoIT 或 BASIC ......但看起来你需要使用这样的东西：

```
$FileContents = StringRegExpReplace($FileContents,'.*ComputerName=(\%[a-zA-Z]*\%).*', $deviceNameInput) 
```

或者

```
$FileContents = StringRegExpReplace($FileContents,'ComputerName=\%[a-zA-Z]*\%', 'ComputerName='&$deviceNameInput) 
```

这只会替换 az 或 AZ 的设备名称。不是数字或包含空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T21:32:05.187

编写正则表达式可能很困难，因为正则表达式有很多方言。假设您正在使用支持类似 Perl 的方言的正则表达式库，您可能想为您的正则表达式尝试这个：

`^\s*ComputerName\s*=\s*(?:%DeviceName%|[a-zA-Z0-9_-]+)`

基本上，这个正则表达式将匹配文字字符串`ComputerName=%DeviceName%`或`ComputerName=<some actual device name that only contains the characters a-z, A-Z, 0-9, _, and ->`. 这个正则表达式也有点宽松，因为它将匹配在行首以及等号之前和/或之后包含空格的行。下图更详细地解释了这个正则表达式的组成部分。

ps 该图像是由[RegexBuddy](http://www.regexbuddy.com/)生成的，这是一个出色的正则表达式 IDE。

![在此处输入图像描述](../Images/bd5c802eaed835e6e915177a2fc6746e.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T16:04:06.417

Autoit 有一种处理 ini 文件的好方法 - IniWrite

```
IniWrite("SysPrep.ini", "write_section_here", "ComputerName", $deviceNameInput) 
```

使用以下命令创建或更新 SysPrep.ini：

```
[write_section_here]
ComputerName=localhost 
```

# jsp - 带有 NullPointerException 的对象数组

> ID：15509859
> 
> 赞同：0
> 
> 时间：2013-03-19T20:33:11.490
> 
> 标签：jsp

我正在编写一个带有 java 类的 JSP 程序并尝试构建一个对象数组，但得到 NullPointerException。请解决我的问题。

我的java类`MChart.java`在下面：

```
package myPackages;

public class MChart 
{
    private  String[] stateId = new String [100];  
    private  String[] rule      = new String[100];
    private  String[] dotPosition   = new String[100];
    private  String[] backPointer   = new String [100];
    private  String[] operation = new String[100];

    public void intialize (String s, String r, String dp, String bp, String o)
    {

        stateId[0]  =   s;
        rule[0]     =   r;
        dotPosition[0]  =   dp;
        backPointer[0]  =   bp;
        operation[0]    =   o;

    }
    public String getStateID(int i)
    {
        return stateId[i];
    }
    public String getRule(int i)
    {
        return rule[i];
    }
    public String getDotPosition(int i)
    {
        return dotPosition[i];
    }
    public String getBackPointer(int i)
    {
        return backPointer[i];
    }
    public String getOperation(int i)
    {
        return operation[i];
    }
} 
```

现在我的jsp文件如下：

```
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page import="java.sql.*" %>
<%@ page import="java.io.*" %>
<%@ page import="java.util.*" %>
<%@ page import="myPackages.MChart"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<title>QASKU URDU PARSER</title>
<!-- scripting code is deleted -->
</head>
<body>
<form name="myform" method="get"  >

<div align="center" onKeyPress="return checkSubmit(event)">
<h4>QASKU URDU PARSER</h4><br>
<h5>Type sentence using Urdu/Arabic script only and then press the 'Parse' button below</h5><br>
<textarea cols="100" rows="5" style="text-align: right" name="mytextarea" id="message" >Type here</textarea>
<script type="text/javascript"> blurfocus("message"); </script>
<br><br>
<input type="submit" value="Parse" >
</div>

</form>

<%
try
{
    if ( request.getParameter("mytextarea") == null)
    {
        out.println("<p align='center'>No Any Input Yet</p>");
    }
    else
    {
        <!-- database entries are deleted -->

        // inputting sentence from user and splitting into an array of strings

        String sent = request.getParameter("mytextarea");
        String[] input = sent.split(" ");

        //initialize chart and root rule
        MChart[] chart = new MChart[input.length+1];
        // only beginning instance is initiated and the rest will be initiated on 
           runtime // This also the NULL pointer creating statement
           chart[0].intialize("0", "ROOT S", "0,0", "-1", "Seed");

        out.println("<p><table align=center border='1' bgcolor='green' width='75%'><col width='25'><col width='25'><col width='25'><col width='25'><col width='25'>");
        out.println("<tr><th align=left>STATEID</th><th align=left>RULE</th><th align=left>DOT-POSITON</th><th align=left>BACK-POINTER</th><th align=left>OPERATION</th></tr>");
        out.println("<tr><td align=left>"+chart[i].getStateID(i)+"</td>");
        out.println("<td align=left>"+chart[i].getRule(i)+"</td>");
        out.println("<td align=left>"+chart[i].getDotPosition(i)+"</td>");
        out.println("<td align=left>"+chart[i].getBackPointer(i)+"</td>");
        out.println("<td align=left>"+chart[i].getOperation(i)+"</td></tr>");
        out.println("</table></p>");

}
catch (Throwable any) 
{
    out.println("<p align=center>Java ERROR: "+any+"</p>");
    any.printStackTrace();
}
%>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:48:57.470

`MChart[] chart = new MChart[input.length+1];`

这会分配一个`null`MChart 对象数组。你立即参考`chart[0].intialize("0", "ROOT S", "0,0", "-1", "Seed");`

您首先要做的是`chart[0] = new MChart()`或类似的事情。显然，您需要对阵列中的每个插槽执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:38:38.603

只看java我想我可以看到问题

预留 100 个字符串的空间

```
private  String[] stateId = new String [100]; 
```

FIRST 并且只有第一个被初始化为 s 输入

```
stateId[0]  =   s; 
```

0 以外的任何值都会给出空指针异常

```
public String getStateID(int i)
{
    return stateId[i];
} 
```

# php - 从 PHP 数组中删除不同条目的特定部分？

> ID：15509869
> 
> 赞同：0
> 
> 时间：2013-03-19T20:33:41.977
> 
> 标签：php, arrays

我有一个脚本，可以生成这样的数组：

```
[0] => 1_Result1  
[1] => 2_Result2  
[2] => 3_Result3 
```

但我希望它像这样出来：

```
[0] => Result1  
[1] => Result2  
[2] => Result3 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:37:23.310

好吧，了解有关如何过滤数组及其形成方式的更具体规则可能会有所帮助，但要回答您的具体问题：

PHP 5.4：

```
array_map(function ($elem) { return explode('_', $elem)[1]; }, $arr) 
```

PHP 5.3：

```
array_map(function ($elem) {
    $elem = explode('_', $elem);
    return $elem[1];
}, $arr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:36:02.663

```
foreach ($array as $key => $item) {
    //Cut 2 characters off the start of the string
    $array[$key] = substr($item, 2); 
} 
```

or if you want to be more fancy and cut off from the `_`:

```
foreach ($array as $key => $item) {
    //Find position of _ and cut off characters starting from that point
    $array[$key] = substr($item, strpos($item, "_")); 
} 
```

This will work in any version of PHP 4 and 5.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:45:31.470

这里：

```
<?php

    $results = array( "1_result1", "2_result2", "3_result3", "4_reslut4");
    $fixed_results = array();
    foreach ($results as $result) 
        {
                $fixed_results[]= substr($result, 2);
        }

    print_r($fixed_results);
?> 
```

将返回

```
Array
(
    [0] => result1
    [1] => result2
    [2] => result3
    [3] => reslut4
) 
```

警告：这仅在您知道要删除的前缀的大小时才有效（在这种情况下为 2）

# android - 通过在微调器中选择项目来启动活动

> ID：15509873
> 
> 赞同：0
> 
> 时间：2013-03-19T20:34:08.590
> 
> 标签：android, android-activity, spinner

我有一个微调器，用户可以在其中动态输入项目。我想当用户从微调器中选择一个项目来开始另一个活动时。

我用：

```
 ...
  m_myDynamicSpinner = (Spinner)findViewById(R.id.myspinner);
  m_addItemText = (EditText)findViewById(R.id.editTextItem);
  Button addButton = (Button)findViewById(R.id.add);
  Button removeButton = (Button)findViewById(R.id.remove);

  m_adapterForSpinner = new ArrayAdapter(this, android.R.layout.simple_spinner_item);
  m_adapterForSpinner.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
  m_myDynamicSpinner.setAdapter(m_adapterForSpinner);
  m_adapterForSpinner.add("Items List");

 ....

  }
 private void addNewSpinnerItem() {
     CharSequence textHolder = "" + m_addItemText.getText();
     m_adapterForSpinner.add(textHolder);
     }

     private void clearSpinnerItems() {
     m_adapterForSpinner.clear();
     m_adapterForSpinner.add("Items List");
     }
     public class MyOnItemSelectedListener implements OnItemSelectedListener {

     public void onItemSelected(AdapterView<?> parent,
     View view, int pos, long id) {

     m_addItemText.setText((CharSequence)parent.getItemAtPosition(pos).toString());

     if (pos == 1){
         Intent intent = new Intent(MainActivity.this, selection.class);
         MainActivity.this.startActivity(intent);
     }

     } 
```

但什么也没发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:48:16.300

将此添加到您的代码中

```
m_myDynamicSpinner.setOnItemSelectedListener(new MyOnItemSelectedListener()); 
```

希望这对您有所帮助。

# android - Titanium (Android) 检查正在运行的服务

> ID：15509883
> 
> 赞同：3
> 
> 时间：2013-03-19T20:34:32.667
> 
> 标签：android, titanium, titanium-mobile

我正在尝试实现一个易于使用的系统来处理 android 的状态栏通知，我正在考虑以下问题：

*   创建一个数据库，我存储何时以及显示什么
*   使用 API 提供的“间隔”服务创建在后台运行的服务
*   在该服务中检查是否需要根据数据库显示任何通知，然后显示它。

**唯一的问题是，我无法检测到是否需要启动服务。**我尝试了这些东西，但到目前为止没有一个效果很好：

**1.)**如果服务已经在本地存储上启动，则保存：

```
// Do this on application startup
var isRunning = Ti.App.Properties.getBool("service_running", false);    
if(!isRunning)
{
    var service = Titanium.Android.createService(...);

    service.addEventListener('start', function() 
    {
        Ti.App.Properties.setBool("service_running", true);
    });

    service.addEventListener('stop', function() 
    {
        Ti.App.Properties.setBool("service_running", false);
    });

    service.start();
} 
```

这显然是行不通的，因为如果服务没有异常终止（如用户强制停止应用程序）， Android 系统原生`onStop`和事件将不会被调度，因此停止事件也不会被触发。`onDestroy`

**2.)**尝试通过 访问任何活动服务`Titanium.Android.getCurrentService()`，但我收到一条错误消息，提示 Titanium.Android 没有名为 getCurrentService() 的方法。这很奇怪，因为 IDE 代码完成为我提供了这种方法。

**3.)**使用 Intent 清除之前运行的 Service

```
var intent = Titanium.Android.createServiceIntent
(
    {
       url : 'notification/NotificationService.js' 
    }
);

intent.putExtra('interval', 1000 * 60);

//Stop if needed        
Titanium.Android.stopService(intent);

//Then start it
Titanium.Android.startService(intent); 
```

但似乎我需要有相同的 Intent 实例，启动服务以停止它，因为在应用程序启动时执行此操作，然后退出并重新启动它会导致多个服务运行。

在这一点上，我对如何检查正在运行的服务没有任何想法。如果您知道任何方法可以做到这一点，请告诉我！感谢您的任何提示！

**编辑**

以下是让我想到尝试上述方法的源材料（也许只是我使用不正确）：

1.  本地存储：[Titanium.App.Properties](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.App.Properties)
2.  访问运行服务的方法：[Titanium.Android.getCurrentService](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.Android-method-getCurrentService)
3.  使用 Intent 停止服务的方法：[Titanium.Android.stopService](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.Android-method-stopService)

**以及我编写的 NotificationHandler“类”和 NotificationService.js 的完整源代码及其用法：[链接](http://pastebin.com/S1CK2v6q)**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-02T18:12:00.210

我来晚了一年，但也许这可以帮助其他人。

我们有相同的想法：永远运行服务并在每个周期进行检查（我必须检查 20 个不同的通信）。

我遇到了同样的问题：如何检测服务正在运行，如何不再运行以不重复检查。

为了解决这个问题，我所做的是获取每个周期的当前时间并将其保存到存储中。

然后，在启动新服务之前，我检查最后一次执行是否及时：如果为真，则服务已停止，否则正在运行。

不是很优雅，但这是我发现避免用户杀死应用程序（和服务）问题的唯一方法。

这是我的服务“启动器”代码。就我而言，我测试了 30 秒：

```
exports.createAndroidServiceForNotifications = function(seconds) {
    var moment = require('alloy/moment');
    var diffSeconds = moment().diff(Ti.App.Properties.getString('serviceLastRun', new Date().getTime() - 60000), 'second');

    if (diffSeconds > 30) {
        var now = new Date().getTime();
        var delta = new Date(now + (seconds * 1000));
        var deltaMS = delta - now;

        var intent = Ti.Android.createServiceIntent({
            url : 'notificationsService.js'
        });
        intent.putExtra('interval', deltaMS);
        Ti.Android.startService(intent);    
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-16T08:11:56.937

使用`Bencoding AlarmManager`它，它将提供您安排警报通知所需的一切：[https ://github.com/benbahrenburg/benCoding.AlarmManager](https://github.com/benbahrenburg/benCoding.AlarmManager)

这个模块提供了你需要的东西。这真的很容易 - 只需`daily`在调度`Notification or Service`.

有关完整功能的代码，请参阅[https://gist.github.com/itsamiths/6248106](https://gist.github.com/itsamiths/6248106)

我正在检查服务是否已启动然后显示每日通知或启动服务然后显示每日通知

```
var isRunning = Ti.App.Properties.getBool("service_running", false);//get service running bool status
if (isRunning) {
    Ti.API.info('service is running');
} else {
    Ti.API.info('service is not running');
    alarmManager.addAlarmService({
        service : 'com.mkamithkumar.whatstoday.DailyEventNotificatoinService',
        hour : "08",
        repeat : 'daily'
    });
} 
```

# java - NullPointerException（帮助！）

> ID：15509884
> 
> 赞同：0
> 
> 时间：2013-03-19T20:34:37.407
> 
> 标签：java, nullpointerexception

我一直在使用 bookClasses 类集来操作图像，并且在尝试消除图像中的红眼时出现 NullPointerException 错误。这是代码：

首先`removeRedEye`是 Picture.Java 类中的方法：

```
 public void removeRedEye(int startX, int startY, int endX, int endY, Color newColor){

    Pixel pixel = null;

    for (int x = startX; x < endX; x++){
        for (int y = startY; y < endY; y++){
            if (pixel.colorDistance(Color.RED) < 167){
                        pixel.setColor(newColor);
            }
        }
    }
  }
} 
```

和测试类：

```
public class TestRemoveRedEye{

    public static void main(String[] args){

        String fileName = FileChooser.getMediaPath("//jenny-red.jpg");

        Picture jennyPicture = new Picture(fileName);

        jennyPicture.removeRedEye(109,91,202,107,java.awt.Color.BLACK); 

        jennyPicture.explore();

    }
} 
```

如果有人能提出为什么我的程序不工作，将不胜感激。

这些行在错误中被挑出来： `if (pixel.colorDistance(Color.RED) < 167){`来自 removeRedEye 方法

`jennyPicture.removeRedEye(109,91,202,107,java.awt.Color.BLACK);` 从测试班

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:36:06.337

**pixel** is **null** you need to initialize it before you invoke methods on its reference.

```
Pixel pixel = null;// neew to initialize this.
pixel = new Pixel(); // somethin like this 
for (int x = startX; x < endX; x++){
    for (int y = startY; y < endY; y++){
        if (pixel.colorDistance(Color.RED) < 167){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:36:05.657

You assign null to `pixel` and you call a method on it just after. Hence the NPE.

```
Pixel pixel = null;
for (int x = startX; x < endX; x++){
    for (int y = startY; y < endY; y++){
        if (pixel.colorDistance(Color.RED) < 167){ // <==== pixel is null !
                    pixel.setColor(newColor);
        }
    }
} 
```

# scala - 快速scala编译器：无法建立与编译守护进程的连接

> ID：15509885
> 
> 赞同：6
> 
> 时间：2013-03-19T20:34:41.643
> 
> 标签：scala, fsc

我有一台 OpenVZ 虚拟化下的 ubuntu 机器。当我运行 fsc test.scala 我得到：

`Unable to establish connection to compilation daemon`

然后`ps aux`向我展示了很多看起来像这样的过程

```
ren      17482  0.0  0.0   4908  1400 pts/0    S    00:29   0:00 /bin/bash --posix /usr/bin/scala -Djava.net.preferIPv4Stack=true scala.tools
ren      17490  0.2  0.5 1246676 24268 pts/0   Sl   00:29   0:00 java -Djava.net.preferIPv4Stack=true -Djava.net.preferIPv4Stack=true -Xbootc 
```

我已经没有如何让它工作的想法了，版本是`Scala code runner version 2.9.2 -- Copyright 2002-2011, LAMP/EPFL`. 有任何想法吗？

**编辑：**

找到 [了这个](http://mclear.co.uk/2010/08/20/fsc-could-not-connect-to-compilation-daemon-in-centos/)，所以：

*   selinux 没有安装
*   出口 | grep SCALA 不返回任何内容，但是 scalac 和 scala 编译/运行正常，所以我认为这一步没问题
*   ping localhost - 有效
*   fsc -reset - 同样的错误
*   fsc -verbose >> logfile.log 2>&1 产生这个：

> ```
> Fast Scala compiler version 2.9.2 -- Copyright 2002-2011, LAMP/EPFL
> [Given arguments: -verbose]
> [Transformed arguments: -verbose -current-dir /home/ren]
> [VM arguments: ]
> [Temp directory: /tmp/scala-devel/ren]
> [Port number: 36737]
> java.net.SocketException: Invalid argument or cannot assign requested address
> [Connecting to compilation daemon at port 36737 failed; re-trying...]
> No compile server running: starting one with args ''
> [Executing command: scala scala.tools.nsc.CompileServer -v]
> Starting CompileServer on port 34962
> Redirect dir is /tmp/scala-devel/ren/output-redirects
> [Port number: 34962]
> java.net.SocketException: Invalid argument or cannot assign requested address
> [Connecting to compilation daemon at port 34962 failed; re-trying...]
> [Port number: 34962]
> java.net.SocketException: Invalid argument or cannot assign requested address
> [Connecting to compilation daemon at port 34962 failed; re-trying...]
> No compile server running: starting one with args '' and so on ... 
> ```

**编辑2：**

好吧，像这样启动编译服务器`scala scala.tools.nsc.CompileServer -v`确实有效！而且似乎 fsc 确实启动了所有这些服务器，但由于某种原因它决定它没有启动。`fsc -server localhost:port test.scala`作品。现在这已经足够好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T19:15:20.437

似乎 fsc 用于`hostname`连接到编译服务器。我的主机名没有响应 ping。将其更改为 localhost`/etc/hostname`解决了问题。

# javascript - 设计的表单选择 - onchange 提交不起作用

> ID：15509886
> 
> 赞同：0
> 
> 时间：2013-03-19T20:34:42.067
> 
> 标签：javascript, css, forms, onchange

在努力工作中，我创建了一个带有图像的选定表单，在兼容模式下正确显示在 Firefox、Chrome 和 Internet Explorer 中。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
  <head>
    <title>InputEdit Demo</title>
    <link rel="stylesheet" type="text/css" href="css/standard.css" />
    <script type="text/javascript" src="mootools.js"></script>
    <script type="text/javascript" src="inputedit.js"></script>  
    <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700' rel='stylesheet' type='text/css'/>
  </head>
  <body style="margin:30px;">
    <form action="form.php" method="post">
      <select id="sel_no1" name="sel_no1" class="inputEdit_select">
        <option value="1">Diese Woche</option>
        <option value="2">Diesen Monat</option>
        <option value="3">Hall of Fame</option>
      </select>
    </form>
  </body>
</html> 
```

我从那里使用了 Javascript 插件： [下载](http://blogfiles.ka-mediendesign.de/inputEdit.zip)他们使用了 MooTools，一个 JavaScript 框架。

现在到我的问题：当我想使用时，`onclick="this.form.submit();"`什么也没有发生。

你们中的任何人都可以让我更好地使用带有 onchange 提交的精心设计的选择表单吗？或者告诉我如何解决我的问题？

[在这里，我上传](http://downloads.tm-attacks.de/inputEdit.zip)了所有带有预览的文件。这个问题我尝试修复了很多小时。我希望有一个友好的人会帮助我。

问候罗宾

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:01:09.060

如果您只想在选择框更改时提交表单，请执行以下操作：

```
<form action="form.php" method="post" id="theForm">
      <select id="sel_no1" name="sel_no1" class="inputEdit_select" onchange="document.getElementById('theForm').submit();">
        <option value="1">Diese Woche</option>
        <option value="2">Diesen Monat</option>
        <option value="3">Hall of Fame</option>
      </select>
    </form> 
```

# php - 使用脚本导出和导入 .csv 文件

> ID：15509889
> 
> 赞同：0
> 
> 时间：2013-03-19T20:34:49.300
> 
> 标签：php, csv, calendar, mamp, icalendar

嗨，我在我正在使用的 Mac 上设置了 MAMP 服务器，我使用 php icalendar 源代码显示日历。我试图让这个显示一个我可以做的公共日历，但我需要它是最新的，所以我需要它来定期导入日历 csv 文件。所以我的问题是，有谁知道我如何以编程方式从公共日历中导出 .csv 文件，以及如何通过脚本或代码再次将其导入服务器上的某个位置？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T14:22:57.680

有很多方法可以下载 .csv 文件。

您可以使用 fopen、cURL 来下载文件。对于 fopen，您需要启用从 url 读取文件。

另一种方式，必须得到对方的支持。就是用ftp。

我认为最好的方法就是看看 php.net 如何让它们工作。

其次，你想做一份有计划的工作。我不知道它在macs中，但是使用linux你可以制作cron，你可以说这些需要每x次（1分钟，1天1周）运行一次。

在脚本中，您执行下载和更新部分。

希望能帮助到你

# java - 如何从 Web 项目创建一个战争和 jar？

> ID：15509893
> 
> 赞同：4
> 
> 时间：2013-03-19T20:34:57.403
> 
> 标签：java, maven

我有一个打包为“战争”的 Maven 网络项目。该包生成确认为war格式的war文件。但是，我喜欢将项目打包为“jar”以及默认的“war”格式。所以，我正在尝试使用“maven jar”插件来实现这一点。我正在使用以下 jar 插件配置。

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <executions>
                <execution>
                    <id>make-a-jar</id>
                    <phase>package</phase>
                    <goals>
                        <goal>jar</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <classesDirectory>${project.build.outputDirectory}</classesDirectory>
                <includes>
                    <include>../../src/main/webapp/**</include>
                    <include>**/*</include>
                </includes>
            </configuration>
        </plugin> 
```

“package”命令生成一个 jar 文件，其中包含类和“resources”文件夹的内容，war 文件生成一个正确的“war”文件。

但是 'src/main/webapp' 的内容不包含在 jar 文件中。如何使用 jar 插件将 src/main/webapp 的内容包含在 jar 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T08:57:54.683

使用 Maven 做到这一点的唯一干净方法是将项目分成两个项目，一个用于构建 jar，一个用于构建战争。（更简单的标准项目比一个大的非标准项目更好，尤其是 Maven）

现在，***如果***您还想共享 src/main/webapp 中的文件，您可以使用 war 覆盖（war 作为依赖项），或者使用类似 spring servletDispatcher 及其 mvc:resources 标记的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T00:46:58.160

通常[Maven war:war](http://maven.apache.org/plugins/maven-war-plugin/war-mojo.html)提供 2 个重要参数，如下所示：-

1`archiveClasses`

> 是否将为 webapp 中的类创建 JAR 文件。使用此可选配置参数将使*编译的类* **归档到 JAR 文件**中，然后*将类目录从 webapp 中排除*。 **默认值为**：假。 **用户属性是**：archiveClasses。

2`attachClasses`

> 类（即 WEB-INF/classes 目录的内容）是否应作为附加工件附加到项目中。默认情况下，附加工件的分类器是“类”。您可以使用参数更改它`<classesClassifier>someclassifier</classesClassifier>`。

即使这是提供[Maven War Plugin](http://maven.apache.org/plugins/maven-war-plugin/)的功能，也不包括`src/main/webapp`创建的 jar 文件。然后你可以考虑[Maven Asssembly Plugin](http://maven.apache.org/plugins/maven-assembly-plugin/)

> **用于 Maven 的程序集插件** 主要旨在允许用户将项目输出及其依赖项、模块、站点文档和其他文件聚合到一个可分发的存档中。目前它可以创建以下格式的发行版：

1.  压缩
2.  柏油
3.  压缩包
4.  tar.bz2
5.  罐
6.  目录
7.  战争
8.  以及已为 ArchiveManager 配置的任何其他格式

通过使用[程序集描述符](http://maven.apache.org/plugins/maven-assembly-plugin/advanced-descriptor-topics.html)，您可以[过滤一些分发文件](http://maven.apache.org/plugins/maven-assembly-plugin/examples/single/filtering-some-distribution-files.html)以及 [包含和排除工件](http://maven.apache.org/plugins/maven-assembly-plugin/examples/single/including-and-excluding-artifacts.html)等。这意味着您可以使用任何所需的内容/资源创建自己的存档。

如果您想使用前面提到的[Maven Jar 插件。](http://maven.apache.org/plugins/maven-jar-plugin/)它还提供以下内容：-

1.  从 jar 工件中包含/排除内容
2.  从项目创建附加的 jar 工件
3.  等等

使用[页面](http://maven.apache.org/plugins/maven-jar-plugin/usage.html)将为您提供更多信息。

我希望这可能会有所帮助。

# node.js - hubot 无法使用 flowdock 适配器启动

> ID：15509899
> 
> 赞同：1
> 
> 时间：2013-03-19T20:35:21.693
> 
> 标签：node.js, npm, hubot

```
 node: 0.10.0
 npm: 1.2.14 
```

我已经设置了环境变量`HUBOT_FLOWDOCK_LOGIN_EMAIL`和`HUBOT_FLOWDOCK_LOGIN_PASSWORD`，然后尝试了以下。

从 hubot 站点拉下预建的 hubot。如上修改package.json。运行 npm 安装

添加

```
 "hubot-flowdock": ">= 0.0.1", 
```

就在我的依赖项下`package.json`

从 hubot-scripts.json 中删除了 redis

跑`npm install`

然后运行`./bin/hubot -a flowdock -d`

有了这个实现，`./bin/hubot - flowdock`

产生以下堆栈跟踪：

```
 TypeError: Uncaught, unspecified "error" event.
    at TypeError (<anonymous>)
    at Session.EventEmitter.emit (events.js:74:15)
    at Request._callback (/Users/gb/workspace/hubot-2.2.0/node_modules/hubot-flowdock/node_modules/flowdock/lib/flowdock.js:49:17)
    at Request.self.callback (/Users/gb/workspace/hubot-2.2.0/node_modules/hubot-flowdock/node_modules/flowdock/node_modules/request/main.js:122:22)
    at Request.EventEmitter.emit (events.js:98:17)
    at Request.<anonymous> (/Users/gb/workspace/hubot-2.2.0/node_modules/hubot-flowdock/node_modules/flowdock/node_modules/request/main.js:661:16)
    at Request.EventEmitter.emit (events.js:117:20)
    at IncomingMessage.<anonymous> (/Users/gb/workspace/hubot-2.2.0/node_modules/hubot-flowdock/node_modules/flowdock/node_modules/request/main.js:623:14)
    at IncomingMessage.EventEmitter.emit (events.js:117:20)
    at _stream_readable.js:870:14 
```

查看 /Users/gb/workspace/hubot-2.2.0/node_modules/hubot-flowdock/node_modules/flowdock/lib/flowdock.js:49:17，这是响应 statusCode > 300 的失败。

到现在为止还挺好。将 console.log 添加到上面的行会产生未经授权的“401”。

如何？凭据是正确的（我经常使用该电子邮件/密码登录）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T01:59:20.523

对于任何关心的人，最终我意识到我的密码不正确。我试图使用我的电子邮件密码，而正确的答案是使用您第一次连接到 flowdock 时设置的密码

# linq - Web API、OData、EF5、Union：“Distinct”操作不能应用于指定参数的集合 ResultType

> ID：15509901
> 
> 赞同：5
> 
> 时间：2013-03-19T20:35:23.347
> 
> 标签：linq, entity-framework, odata, asp.net-web-api

我正在使用 OData Nuget 包开发 Web API 原型。我在使 LINQ to EF 查询正常工作时遇到了一些问题。

[这是我的数据模型。](http://i.stack.imgur.com/Zcy6o.jpg)它已被高度简化。

我正在尝试使用此 DTO 使查询正常工作：

```
public class Product
{
    public int Id { get; set; }
    public string Name { get; set; }
    public IEnumerable<Order> Orders { get; set; }
}

public class Order
{
    public int Id { get; set; }
    public DateTime Date { get; set; }
} 
```

查询如下所示：

```
[Queryable]
public IQueryable<Product> Get()
{
    var productA = _context.ProductA
                            .Select(p => new Product
                                {
                                    Id = p.id,
                                    Name = p.name,
                                    Orders = p.ProductAOrders.Select(o => new Order
                                        {
                                            Id = o.OrderId,
                                            Date = o.Orders.Date,
                                        })
                                });

    var productB = _context.ProductB
                            .Select(p => new Product
                                {
                                    Id = p.Id,
                                    Name = p.Name,
                                    Orders = p.ProductBOrders.Select(o => new Order
                                        {
                                            Id = o.OrderId,
                                            Date = o.Orders.Date,
                                        })
                                });

    return productA.Union(productB);
} 
```

当尝试联合这两个查询时，我收到此错误：

```
<Error><Message>An error has occurred.</Message><ExceptionMessage>The 'Distinct' operation cannot be applied to the collection ResultType of the specified argument.
Parameter name: argument</ExceptionMessage><ExceptionType>System.ArgumentException</ExceptionType><StackTrace>   at System.Data.Common.CommandTrees.ExpressionBuilder.Internal.ArgumentValidation.ValidateDistinct(DbExpression argument)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.UnionTranslator.TranslateBinary(ExpressionConverter parent, DbExpression left, DbExpression right)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.BinarySequenceMethodTranslator.Translate(ExpressionConverter parent, MethodCallExpression call)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.SequenceMethodTranslator.Translate(ExpressionConverter parent, MethodCallExpression call, SequenceMethod sequenceMethod)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.TypedTranslate(ExpressionConverter parent, MethodCallExpression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TypedTranslator`1.Translate(ExpressionConverter parent, Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateExpression(Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.Convert()
   at System.Data.Objects.ELinq.ELinqQueryState.GetExecutionPlan(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery.ToTraceString()
   at System.Data.Entity.Internal.Linq.InternalQuery`1.ToString()
   at System.Data.Entity.Infrastructure.DbQuery`1.ToString()
   at System.Convert.ToString(Object value, IFormatProvider provider)
   at System.Web.Http.Tracing.Tracers.HttpActionDescriptorTracer.&lt;ExecuteAsync&gt;b__2(TraceRecord tr, Object value)
   at System.Web.Http.Tracing.ITraceWriterExtensions.&lt;&gt;c__DisplayClass1b`1.&lt;&gt;c__DisplayClass1f.&lt;TraceBeginEndAsync&gt;b__13(TraceRecord traceRecord)
   at System.Web.Http.Tracing.SystemDiagnosticsTraceWriter.Trace(HttpRequestMessage request, String category, TraceLevel level, Action`1 traceAction)
   at System.Web.Http.Tracing.ITraceWriterExtensions.&lt;&gt;c__DisplayClass1b`1.&lt;TraceBeginEndAsync&gt;b__12(TResult result)
   at System.Threading.Tasks.TaskHelpersExtensions.&lt;&gt;c__DisplayClass3b`2.&lt;Then&gt;b__3a(Task`1 t)
   at System.Threading.Tasks.TaskHelpersExtensions.ThenImpl[TTask,TOuterResult](TTask task, Func`2 continuation, CancellationToken cancellationToken, Boolean runSynchronously)
</StackTrace></Error> 
```

我可以返回 productA 或 productB - 但返回这 2 个查询的 Union 会导致上述明显错误。

对我可能做错的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T06:44:31.390

看起来像一个EF错误。我假设您正在尝试让 MEST（相同类型的多个实体集）工作。您可以尝试，而不是您的查询，

```
public IQueryable<Product> Get()
{
    var productA = _context.ProductA
                            .Select(p => new Product
                            {
                                Id = p.id,
                                Name = p.name,
                            });

    var productB = _context.ProductB
                            .Select(p => new Product
                            {
                                Id = p.Id,
                                Name = p.Name,
                            });

    return
        productA
        .Union(productB)
        .Select(p => new Product
        {
            Id = p.Id,
            Name = p.Name,
            Orders = _context.Orders
                    .Where(o => o.ProductA.Id == p.Id || o.ProductB.Id == p.Id)
                    .Select(o => new Order
                    {
                        Id = o.OrderId,
                        Date = o.Orders.Date,
                    })
        });
} 
```

这个想法是将导航属性从联合中取出，然后再将它们添加回来。这只有在 Orders 有指向 ProductA 或 ProductB 的反向指针时才有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:10:00.073

这似乎是设计使然（或限制）。对于集合操作（​​UNION、INTERSECT、EXCEPT），我们只允许模型类型和“平面”瞬态类型（即没有集合属性的行类型（例如为投影创建））。这里的解决方法是通过强制执行查询来在客户端上进行联合，而不是这样做：

```
var query3 = query1.Union(query2); 
```

做这个：

```
var query3 = query1.ToList().Union(query2); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-21T16:12:56.087

刚刚尝试了这个查询......这似乎是使用导航属性的唯一方法。

```
var productA = _context.ProductA
                .Select(p => new Product
                {
                    Id = p.id,
                    Name = p.name,
                });

var productB = _context.ProductB
                .Select(p => new Product
                {
                    Id = p.Id,
                    Name = p.Name,
                });

return
    productA
    .Union(productB)
    .Select(p => new Product
        {
            Id = p.Id,
            Name = p.Name,
            Orders =   _context.ProductAOrders
                    .Where(x => x.ProductAId == p.Id)
                    .Select(o => new Order
                    {
                        Id = o.ProductAId,
                        Date = o.Orders.Date
                    })
                    .Union( _context.ProductBOrders
                            .Where(x => x.ProductBId == p.Id)
                            .Select(o => new Order
                            {
                                Id = o.ProductBId,
                                Date = o.Orders.Date
                            }))
        }); 
```

它导致此错误：

```
<Error><Message>An error has occurred.</Message><ExceptionMessage>The type 'API.Models.Product' appears in two structurally incompatible initializations within a single LINQ to Entities query. A type can be initialized in two places in the same query, but only if the same properties are set in both places and those properties are set in the same order.</ExceptionMessage><ExceptionType>System.NotSupportedException</ExceptionType><StackTrace>   at System.Data.Objects.ELinq.ExpressionConverter.ValidateInitializerMetadata(InitializerMetadata metadata)
   at System.Data.Objects.ELinq.ExpressionConverter.MemberInitTranslator.TypedTranslate(ExpressionConverter parent, MemberInitExpression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TypedTranslator`1.Translate(ExpressionConverter parent, Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateExpression(Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateLambda(LambdaExpression lambda, DbExpression input)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateLambda(LambdaExpression lambda, DbExpression input, DbExpressionBinding&amp; binding)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.OneLambdaTranslator.Translate(ExpressionConverter parent, MethodCallExpression call, DbExpression&amp; source, DbExpressionBinding&amp; sourceBinding, DbExpression&amp; lambda)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.SelectTranslator.Translate(ExpressionConverter parent, MethodCallExpression call)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.SequenceMethodTranslator.Translate(ExpressionConverter parent, MethodCallExpression call, SequenceMethod sequenceMethod)
   at System.Data.Objects.ELinq.ExpressionConverter.MethodCallTranslator.TypedTranslate(ExpressionConverter parent, MethodCallExpression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TypedTranslator`1.Translate(ExpressionConverter parent, Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.TranslateExpression(Expression linq)
   at System.Data.Objects.ELinq.ExpressionConverter.Convert()
   at System.Data.Objects.ELinq.ELinqQueryState.GetExecutionPlan(Nullable`1 forMergeOption)
   at System.Data.Objects.ObjectQuery.ToTraceString()
   at System.Data.Entity.Internal.Linq.InternalQuery`1.ToString()
   at System.Data.Entity.Infrastructure.DbQuery`1.ToString()
   at System.Convert.ToString(Object value, IFormatProvider provider)
   at System.Web.Http.Tracing.Tracers.HttpActionDescriptorTracer.&lt;ExecuteAsync&gt;b__2(TraceRecord tr, Object value)
   at System.Web.Http.Tracing.ITraceWriterExtensions.&lt;&gt;c__DisplayClass1b`1.&lt;&gt;c__DisplayClass1f.&lt;TraceBeginEndAsync&gt;b__13(TraceRecord traceRecord)
   at System.Web.Http.Tracing.SystemDiagnosticsTraceWriter.Trace(HttpRequestMessage request, String category, TraceLevel level, Action`1 traceAction)
   at System.Web.Http.Tracing.ITraceWriterExtensions.&lt;&gt;c__DisplayClass1b`1.&lt;TraceBeginEndAsync&gt;b__12(TResult result)
   at System.Threading.Tasks.TaskHelpersExtensions.&lt;&gt;c__DisplayClass3b`2.&lt;Then&gt;b__3a(Task`1 t)
   at System.Threading.Tasks.TaskHelpersExtensions.ThenImpl[TTask,TOuterResult](TTask task, Func`2 continuation, CancellationToken cancellationToken, Boolean runSynchronously)</StackTrace></Error> 
```

我无法理解为什么“API.Models.Product”出现在单个 LINQ to Entities 查询中的两个结构不兼容的初始化中。

如果我更换

```
 Orders =   _context.ProductAOrders
                .Where(x => x.ProductAId == p.Id)
                .Select(o => new Order
                {
                    Id = o.ProductAId,
                    Date = o.Orders.Date
                })
                .Union( _context.ProductBOrders
                        .Where(x => x.ProductBId == p.Id)
                        .Select(o => new Order
                        {
                            Id = o.ProductBId,
                            Date = o.Orders.Date
                        })) 
```

有了这个（为了让事情更简单）我得到了同样的错误

```
 Orders = _context.Orders.Select(o => new Order
            {
                Id = o.Id,
                Date = o.Date
            }) 
```

这些天似乎 LINQ to EF 不是我最好的朋友 :)

# python - 从 Python 中的 csv 列中检索每个唯一值的第一次出现的更有效方法

> ID：15509905
> 
> 赞同：0
> 
> 时间：2013-03-19T20:35:31.443
> 
> 标签：python, algorithm, iteration

给我的一个大 csv 有一个大的飞行数据表。我为帮助解析它而编写的一个函数迭代了 Flight ID 的列，然后返回一个字典，其中包含每个唯一 Flight ID 的索引和值（按首次出现的顺序）。

字典 = { 索引：FID, ... }

这是对旧功能的快速调整，不需要担心列中的 FID 重复（几十万行之后......）。

现在，我让它迭代并按顺序比较每个值。如果一个值等于它后面的值，它会跳过它。如果下一个值不同，它将值存储在字典中。我将其更改为现在还检查该值之前是否已经出现，如果是，则跳过它。
这是我的代码：

```
def DiscoverEarliestIndex(self, number):                                             
        finaldata = {}                                                        
        columnvalues = self.column(number)                                             
        columnenum = {}                                                         
        for a, b in enumerate(columnvalues):                                           
            columnenum[a] = b                                                   
        i = 0                                                                                                                    
        while i < (len(columnvalues) - 1):                                             
            next = columnenum[i+1]                                              
            if columnvalues[i] == next:                                                
                i += 1                                                          
            else:                                                               
                if next in finaldata.values():                                
                    i += 1                                                      
                    continue                                                    
                else:                                                           
                    finaldata[i+1]= next                                      
                    i += 1                                                      
        else:                                                                   
            return finaldata 
```

它的效率非常低，并且随着字典的增长而减慢。该列有 520 万行，所以用 Python 处理这么多显然不是一个好主意，但我现在坚持使用它。

有没有更有效的方法来编写这个函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:47:18.813

要直接回答您的问题，您应该能够使用 dict comprehensions 和 itertools 模块来做到这一点。

```
>>> import itertools as it
>>> data = {1: 'a', 2: 'a', 3: 'c', 4: 'c', 5:'d' }
>>> grouped_shit = {k: list(v) for (k,v) in it.groupby(data.iteritems(), lambda (_,v): v)}
>>> good_shit = {v[0][0]: k for (k, v) in grouped_shit.iteritems()}
>>> good_shit
{1: 'a', 3: 'c', 5: 'd'} 
```

我认为这可以稍微调整一下——我对两次复习字典不太高兴。但无论如何，我认为 dict 理解非常有效。此外，`groupby`假设您的键是有序的——也就是说，它假设所有 'a 的索引都组合在一起，这在您的情况下似乎是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T21:12:58.633

```
if next in thegoodshit.values(): 
```

可能是你的问题你在这里做什么

1.  创建列表
2.  搜索列表

也许您可以使用 a`set`来保存值并进行搜索-如下所示：

```
 while i < (len(columnvalues) - 1):                                             
        next = columnenum[i+1]                                              
        if columnvalues[i] == next:                                                
            i += 1                                                          
        else:                                                               
            if next in searchable_data:                                
                i += 1                                                      
                continue                                                    
            else:                                                           
                finaldata[i+1]= next
                searchable_data.add(next)                 
                i += 1                                                      
    else:                                                                   
        return finaldata 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T20:43:26.697

You are essentially looking for a database. Databases are made exactly for such operations on large datasets. It will be much faster to parse the entire CSV at once using the [CSV module](http://docs.python.org/2/library/csv.html) and sending them in a database than storing them in a dict and running checks against the entire dict.

[*large* python dictionary with persistence storage for quick look-ups](https://stackoverflow.com/questions/11837229/large-python-dictionary-with-persistence-storage-for-quick-look-ups)

# delphi - 过程中的无效类型转换

> ID：15509908
> 
> 赞同：-6
> 
> 时间：2013-03-19T20:35:36.130
> 
> 标签：delphi

我的程序代码在编译时一直给我带来问题。该程序的想法只是创建一个将文本文件读入数组的过程。然后该按钮将在 Richedit 上显示它们。

这是原始代码：

```
unit Unit1;

interface

uses
 Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
 Dialogs, StdCtrls, ComCtrls;
type
 ArrNames = array [1..10] of string;
 ArrSales = array [1..10] of integer;
type
 TForm1 = class(TForm)
 btnShowData: TButton;
 redt1: TRichEdit;
 procedure btnShowDataClick(Sender: TObject);
  private

  public
{ Public declarations }
end;
Procedure Showdata;
 var
   Form1: TForm1;

implementation

{$R *.dfm}

 Procedure ShowData;
   var c2u : textfile;
     count : integer;
     aNames : arrNames;
     aSales : arrSales;
   Begin
    If FileExists('data.txt') <> true then
     begin
       Messagedlg('File does not exist', mtError, [mbOK], 0);
       Exit;
   end;
       Count :=0;
       AssignFile(c2u, 'data.txt');
       Reset(c2u);
       While Not EOF(c2u) do
         begin
            Inc(Count);
            readln (c2u, aNames[count]);
            readln (c2u, aSales[count]);
         end;
       Closefile(c2u);
    End;

  procedure TForm1.btnShowDataClick(Sender: TObject);
    var J : integer;
        aNames : arrNames;
        aSales : arrSales;
   begin
     redt1.lines.add(aNames[J] +#9 + 'R' +IntToStr(aSales[J]));
   end;

  end. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T22:16:33.417

现在有了你的*真实代码*，我将列出你的*一些*错误：

*   `ShowData`从未被调用

*   `ShowData`是一个坏名字，因为它**不显示任何东西**，只从文件中**读取数据**，所以最好将它重命名为`ReadData`

*   `aNames`并且`aSales`是过程/方法的**局部**变量，并且生命周期仅在此过程/方法内。您无法访问另一个过程/方法的局部变量。`ShowData``TForm1.btnShowDataClick`

    解决方案：将它们定义为`TForm1`

* * *

作为一个*小*`T`的改进，您应该命名所有以（例如）开头的类型`TMyType`。这只是一个约定，但非常有帮助。

还有[更多的命名约定](https://stackoverflow.com/questions/14268441/what-does-fxxx-private-class-name-prefix-convention-came-from/14268873#14268873)

* * *

`If FileExists( 'data.txt' ) <> true`

没有错，但很糟糕，你应该把它写在你的脑海里“*如果文件不存在，我会做一些不同的事情*”

`if not FileExists( 'data.txt' )`

更具可读性（并且不会让几个用户感到头疼;o））

* * *

这是包含所有改进和一些评论的完整单元。

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ComCtrls;

type
  TArrNames = array [1 .. 10] of string;
  TArrSales = array [1 .. 10] of integer;

type
  TForm1 = class( TForm )
    btnShowData : TButton;
    redt1 : TRichEdit;
    procedure btnShowDataClick( Sender : TObject );
  private
    // private fields of TForm1
    aNames : TArrNames;
    aSales : TArrSales;

    procedure ReadData;  // now it is a private method of TForm1
  public
    { Public declarations }
  end;

  // procedure Showdata; -> renamed/moved to TForm1.ReadData

var
  Form1 : TForm1;

implementation

{$R *.dfm}

// procedure Showdata;
procedure TForm1.ReadData;
var
  c2u :   textfile;
  count : integer;
  // aNames : ArrNames;
  // aSales : ArrSales;
Begin
  // If FileExists( 'data.txt' ) <> true
  // better
  if not FileExists( 'data.txt' )
  then
    begin
      MessageDlg( 'File does not exist', mtError, [mbOK], 0 );
      Exit;
    end;
  count := 0;
  AssignFile( c2u, 'data.txt' );
  Reset( c2u );
  while not EOF( c2u ) do
    begin
      Inc( count );
      ReadLn( c2u, aNames[count] );
      ReadLn( c2u, aSales[count] );
    end;
  CloseFile( c2u );
End;

procedure TForm1.btnShowDataClick( Sender : TObject );
var
  J : Integer;
  // aNames : ArrNames;
  // aSales : ArrSales;
begin
  // first, read the data
  ReadData;
  // loop over each array item
  for J := 1 to 10 do
    redt1.Lines.Add( aNames[J] + #9 + 'R' + IntToStr( aSales[J] ) );
end;

end. 
```

# ios - 将 MKMapView 中的用户位置捕捉到线/轨迹

> ID：15509912
> 
> 赞同：2
> 
> 时间：2013-03-19T20:35:48.367
> 
> 标签：ios, objective-c, mkmapview

我正在开发一个路径/地图应用程序，该应用程序在一个区域中绘制了自定义路径，并将帮助用户在“森林”区域的一些路径周围导航。

目前，我正在使用 MKMapView 来获取用户数据/位置，并从 KML 文件中加载轨迹作为覆盖。我遇到的问题是，在测试应用程序时，我注意到在某些情况下，代表用户位置的蓝点偏离了轨迹覆盖，这是预期的，因为 GPS（尤其是在手机上）不是那么好，加上一些错误可能在获取要放入 KML 文件的路径的值时获得。

如果这一切有点令人困惑，我深表歉意，我的问题是：是否有可能将用户位置（我们都喜欢的蓝点）“捕捉”到地图上具有特定宽容？例如，如果蓝点看起来离轨迹有几个像素，那么它将被放置在轨迹的中间。如果距离很远，那么用户很可能已经走远了，用户的位置不会发生捕捉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T23:12:03.033

首先我不会打扰。如果它们仅相差几个像素，他们将不在乎，但如果它们距离较远，那么重要的是他们尽可能准确地知道自己在哪里。他们可能会在雪地里迷路并寻找踪迹。如果您继续这样做，您将不得不放弃 userLocation 点并构建我们自己的点。每次设备获取新的位置信息并将自定义注释点移动到您认为它们应该在的位置时，您都可以使用 LocationManager 得到通知。更麻烦的是它值得恕我直言。

# java - Structured data in java

> ID：15509917
> 
> 赞同：0
> 
> 时间：2013-03-19T20:35:59.640
> 
> 标签：java, class, data-structures, struct

In **C** I would create a data structure as below:

```
struct file_data_format
{
  char name[8][20];
  float amp[8];
  int filter[8];
};

extern struct file_data_format f_data; 
```

Then I could read or write this whole structure to a file or memory location.

How would I do this in a class in java?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:39:50.860

在提问之前，您应该阅读 Java 基础知识。C中的结构可以写成Java中的类。

```
public class FileDataFormat implements Serializable {

   String[][] name = new String[8][20];
   float[] amp = new float[8];
   int[] filter = new int[8];

   public FileDataFormat() {

   }

   public void setName(String[][] name) {
      this.name = name;
   }

   public String[][] getName() {
      return this.name;
   }

   // next getters and setters
} 
```

**我非常推荐 OOP（封装、多态、继承）。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T20:37:36.683

如果你想达到类似的效果，你可以执行以下操作。

不幸的是，您无法像在 c 中那样控制它在内存中的表示方式

```
public class file_data_format
{
  public char name[8][20];
  public float amp[8];
  public int filter[8];
} 
```

...

```
public static void main()
{
    file_data_format fdf = new file_data_format();
    fdf.name = charArrayIGotFromSomewhere
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T20:39:40.653

```
public class FileDataFormat {
    private String name;
    private float amp;
    private int filter;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public float getAmp() {
        return amp;
    }

    public void setAmp(float amp) {
        this.amp = amp;
    }

    public int getFilter() {
        return filter;
    }

    public void setFilter(int filter) {
        this.filter = filter;
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T20:53:09.840

正如其他答案向您展示的那样，Java 中结构的等价物是 JavaBean。

来自[Wikipedia](http://en.wikipedia.org/wiki/JavaBeans)的 JavaBean ：

*   是可序列化的
*   有一个 0 参数的构造函数
*   允许使用 getter 和 setter 方法访问属性。

要从文件或内存中写入和读取它，它不像在 C 中那么简单。您通常会使用[Java 对象序列化](http://docs.oracle.com/javase/7/docs/platform/serialization/spec/serialTOC.html)将对象写入/读取到 ObjectInputStream/ObjectOutputStream，它可以附加到文件或字节数组。

# c - 返回二维数组的问题

> ID：15509922
> 
> 赞同：1
> 
> 时间：2013-03-19T20:36:05.787
> 
> 标签：c, pointers, matrix, return, transpose

我被要求编写一个获取二维数组（矩阵）、列数和行数的程序，程序将返回转置矩阵（不使用 [][]，意味着仅使用指针算术）

我写的程序，确实对矩阵进行了转置，没问题。我的问题是了解如何返回。这是我的代码：

```
int** transpose_matrix(matrix mat1,int number_of_rows,int number_of_columns)
{
    matrix mat2;
    int row_index,column_index;
    for(row_index=0;row_index<number_of_rows;row_index++)
    {
        for(column_index=0;column_index<number_of_columns;column_index++)
            **(mat2+(column_index*number_of_rows)+row_index)=**(mat1+(row_index*number_of_columns)+column_index);
    }
    // at this point, mat2 is exactly the transpose of mat1
    return mat2;
} 
```

现在这是我的问题：我不能返回一个矩阵，我能做的最接近的事情是返回矩阵的第一个值的地址，但即使我这样做了，只要我这样做，矩阵的所有其余部分都将无法使用退出 transpose_matrix 函数回到 void main...我怎样才能返回 mat2？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:40:51.410

一、二维数组**不是**双指针。

二、动态分配。如果`matrix`是二维数组类型，那么写成这样：

```
typedef int matrix[ROWS][COLUMNS];
typedef int (*matrix_ptr)[COLUMNS];

matrix_ptr transpose_matrix(matrix m, int rows, int cols)
{
    matrix_ptr transposed = malloc(sizeof(*transposed) * rows);
    // transpose, then
    return transposed;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:10:05.907

好的：这里有 3 件事：

1.  您不能返回指向局部变量的指针（返回后它将是垃圾，并且它所在的堆栈（内存）被重用）。
2.  传递时数组衰减为指向第一个元素的指针。
3.  指针运算：p+1 将 p 中的地址增加 sizeof(*p)，因此 p 指向下一个元素，而不是下一个字节。

代码的简单修复（这适用于任何矩阵大小）：

```
 int* transpose_matrix(int *mat1,int number_of_rows,int number_of_columns)
    {
        int *mat2=malloc(number_of_rows*number_of_columns*sizeof(int));
        int row_index,column_index;
        for(row_index=0;row_index<number_of_rows;row_index++)
        {
            for(column_index=0;column_index<number_of_columns;column_index++)
                mat2[column_index*number_of_rows+row_index]=mat1[row_index*number_of_columns+column_index];
        }
        // at this point, mat2 is exactly the transpose of mat1
        return mat2;
    }

...
    print(m,r,c); // I hope you have a print()
    int *t=transpose_matrix(m,r,c);
    print (t,c,r);
...
    // use t[max: c-1][max: r-1]
    free(t); 
```

如果我们只有固定大小的矩阵（在 C99 中我们也可以使用可变长度数组！）。

```
typedef int  Matrix[ROWS][COLUMNS];
typedef int TMatrix[COLUMNS][ROWS];
typedef int (*pMatrix)[COLUMNS]; 
typedef int (*pTMatrix)[ROWS];  

pTMatrix transpose_matrix(Matrix m , int rows, int cols)
{
    pTMatrix t = malloc(sizeof(*t)*cols);
    for (int r=0; r<rows ; ++r)
    for (int c=0; r<cols ; ++r)
      t[c][r]=m[r][c];
    return t;
} 
```

好吧，如果行和列是固定的，你不需要传递它......嗯......

# css - 如何向包含已访问链接的列表元素添加样式？

> ID：15509933
> 
> 赞同：1
> 
> 时间：2013-03-19T20:36:42.667
> 
> 标签：css, css-selectors

我正在使用 Stylebot for Chrome 来覆盖我经常访问的网页上的一些样式。我想要实现的是在包含我已经访问过的链接的列表中隐藏元素。

因此，我有一个`<tr>`包含该类的类`table-row`，并且我想隐藏所有`table-row`包含已访问链接（`a:visited`）的 s。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:40:28.307

你不能，即使是 JavaScript。 `:visited`是一个绑定了隐私保护的特殊类。它不会在 DOM 选择器查询中返回任何元素。要使用 CSS 来做到这一点，您需要难以捉摸的祖先选择器，它目前不存在。即使这样做了，同样的隐私保护措施也可能会阻止它发挥作用。

有关更多信息，请参阅[选择器 API、隐私注意事项](http://www.w3.org/TR/selectors-api/#privacy)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T08:57:21.943

您不能隐藏或更改包含 a:visited 的列表元素，但可以更改它们的颜色。

我有同样的问题，然后我将它们的所有颜色都更改为背景颜色。它就在这里，但你看不到它们。

# string - Qt在函数中结合双/字符串

> ID：15509934
> 
> 赞同：0
> 
> 时间：2013-03-19T20:36:49.150
> 
> 标签：string, qt4, int

如何将变量`double`合并`string`为一个函数？

我将接收`double`参数的函数称为：

`counter(&filesize)`,

比调用函数：

```
void Properties::counter(double *filesize)
{
    double res = *filesize;
    QString filetyperes;

    if (res <= 1024) { res = res; filetyperes = "B"; }
    else if (res > 1024 && res <= 1024*1024) { res = res / 1024; filetyperes = "KiB"; }
    else if (res > 1024*1024 && res <= 1024*1024*1024) { res = res / 1024 / 1024; filetyperes = "MiB"; }
    else if (res > 1024*1024*1024) { res = res / 1024 / 1024 / 1024; filetyperes = "GiB"; }

    *filesize = res;
} 
```

它将接收双参数并正确计算。

但是，我有转换 MiB/KiB 所以而不是

`*filesize = res + filetyperes`它返回 example ( `1 KiB`) 作为示例。

但是我的参数只返回双倍，所以我可以添加`(const double *filesize)`但它会引发错误。

header.h 是：

```
private:
      void counter(double *filesize = 0); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:01:19.957

这应该返回一个 QString 与您的文件大小和文件类型连接：

```
QString Properties::counter(double *filesize)
{
    double res = *filesize;
    QString filetyperes;

    if (res <= 1024) { res = res; filetyperes = "B"; }
    else if (res > 1024 && res <= 1024*1024) { res = res / 1024; filetyperes = "KiB"; }
    else if (res > 1024*1024 && res <= 1024*1024*1024) { res = res / 1024 / 1024; filetyperes = "MiB"; }
    else if (res > 1024*1024*1024) { res = res / 1024 / 1024 / 1024; filetyperes = "GiB"; }

    *filesize = res;
    return QString::number(res) + filetyperes;
} 
```

# iframe - Google Calendar. Is there a way to hide morning hours for the iframe widget? Similar to the "hide morning and night" lab

> ID：15509935
> 
> 赞同：6
> 
> 时间：2013-03-19T20:36:50.767
> 
> 标签：iframe, time, calendar, embed

When all of my events are 9 a.m. onwards and i embed an iframe widget in my site, the users have to scroll down to see the events. A way to hide the early morning hours from the calendar widget would really make it a lot more usable. Is it possible?

Sometimes people ask if setting a certain displayed date is possible. The answer is yes. It is done through modifying an <.iframe.> parameter called

```
ctz=Europe%2FMoscow 
```

to

```
ctz=Europe%2FMoscow&dates=20130408/20130412 
```

So if that's possible, may be there is a parameter to set to make it display timespan from 9 a.m. to 5 p.m. Or at least to make calendar start at day time.

Here's the live presentation of what I am talking about: (if the question is going to be answered I'll try to keep the link alive for future generations, so you go try it in the year 2013++)

[http://center-president.ru/page212.html](http://center-president.ru/page212.html)

# java - Selenium webdriver 无法识别此单选元素。有人可以帮助我吗？

> ID：15509938
> 
> 赞同：-2
> 
> 时间：2013-03-19T20:37:09.013
> 
> 标签：java, selenium, radio-button, webdriver

```
<br>
<input id="workedWithGR" type="radio" onclick="showDiv('hiddenInput');" value="yes" checked="" name="workedWithGR" style="border:none;">

<label>Yes</label>

<input id="workedWithGR" type="radio" onclick="hideDiv('hiddenInput');" value="no" name="workedWithGR" style="border:0px;"> 
```

对于是和否按钮，我不断收到“Webdriver 找不到元素错误”。我不能做 xpath，因为 id 中有引号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T21:59:36.987

改用标签“值”或子节点“标签”，然后递归地向上树选择正确的元素。例如，我假设您的 html 具有以下内容：

```
<br>
  <input id="workedWithGR" type="radio" onclick="showDiv('hiddenInput');" value="yes" checked="" name="workedWithGR" style="border:none;">
    <label>Yes</label>
  <input id="workedWithGR" type="radio" onclick="hideDiv('hiddenInput');" value="no" name="workedWithGR" style="border:0px;">
    <label>No</label> 
```

所以尝试像下面这样关闭节点标签：

```
//input[@id=\"workedWithGR\"]/label[text()="Yes"]/../input 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T11:36:11.600

I use this approach for radio input. Avoid having to look for multiple input elements / works with variable number of radio buttons having same name.

```
String valueToSelect = "no";
List<WebElement> radios = driver.findElement(By.name("workedWithGR"));
if (radios.size() == null)
    return ;

for (WebElement radio : radios){
    if (radio.getAttribute("value").equals(valueToSelect)){
        radio.click();
        break;
    }
} 
```

# login - 最好检查用户名和密码还是只检查用户名？

> ID：15509940
> 
> 赞同：0
> 
> 时间：2013-03-19T20:37:20.647
> 
> 标签：login, passwords, while-loop

当用户尝试登录时，有两种方法可以检查用户是否有效。

方法一：执行如下查询，检查返回的行数是否为1。

```
SELECT * FROM users WHERE username = $_POST['username'] AND password = md5($_POST['password']) 
```

方法二：执行查询，然后检查密码是否匹配。

```
SELECT * FROM users WHERE username = $_POST['username']

while ($row = mysqli_fetch_array($r, MYSQLI_ASSOC)){
   if($row['password'] == md5($_POST['password'])) $logged_in = TRUE;
} 
```

这些方法中的一种是否优于另一种？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T20:39:06.240

使用密钥、盐和密码。`md5`不安全。

在服务器上，您存储一个密钥：

```
$key = 'fPu6AY;h0-5Q>cIel,@n2$gickGs9{ys~+DT,v|Mz-]~EU3tuj18|~Ch#1_$)fGR'; 
```

用户注册时会生成一个*唯一的*盐，并与加密密码一起存储在服务器上：

```
| 盐 | 密码 |
-------------------------------------------------- -------------------------------------------
| jAcTgi~4(Z | 877236d15a7b7a1f36febc49e58b142d70d72cf7d6e54dcfb252d7cde6b62a2d |
```

密码是这样加密的：

```
$hash = hash('sha256', $keyFromServer . $saltFromDb . $userPassword); 
```

然后，您必须使用方法 2 来获取 salt 和 hash 以将其与数据库密码进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T20:59:49.110

方法 2 是首选，因为您可以使用 PHPass 之类的库。它还使您能够告诉用户他们输入了无效的用户名，而不是让他们猜测他们是否输入了错误。Aarolama 关于 md5 不安全是正确的。不幸的是，SHA 系列也不是。这两者都是文件哈希，用于唯一标记和识别文件。使用加密哈希来保护密码，例如河豚。PHPass 为您处理了很多安全问题。盐应该是随机生成的，并且对于每个用户都是唯一的，而获得它们供自己使用的唯一方法是通过第二种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:15:52.037

要添加到*FreshPrinceOfSO*的答案，不要简单地将密钥与加盐的明文连接起来——而是使用 HMAC 方法：

```
$hash = hash_hmac('sha256', $saltFromDb . $userPassword, $keyFromServer); 
```

可以在[Wikipedia](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)和[RFC 2104](https://www.rfc-editor.org/rfc/rfc2104)中找到有关 HMAC 的更多详细信息，以及为什么这种简单方法存在缺陷的解释。还值得注意的是，与单独的底层哈希算法相比，HMAC 受冲突的影响要小得多，即尽管核心算法和输出大小相同，但它们更安全。

顺便说一下，关于输出大小。在上述 RFC 2104 的第 5 节中，指出截断散列（原始大小的一半或更大）在减少可能值的总数的同时，使通过蛮力恢复明文变得更加困难，如攻击者无法使用要检查的完整哈希值。这也适用于非 HMAC 哈希。

# java - 如何观察来自不同类的 JButton？

> ID：15509946
> 
> 赞同：-1
> 
> 时间：2013-03-19T20:37:28.347
> 
> 标签：java, swing, model-view-controller, jbutton, observer-pattern

因此，我有一个扩展 a 的类，`JPanel`并在构造函数中添加我的`JButtons`以及我需要添加的任何其他内容。我还有一个`MainFrame`容器`JFrame`类`FrameSwitcher`（`MainFrame`

我在这样做时遇到了麻烦，我找不到合适的方法来做到这一点。我也希望保持 JButtons 私有和非静态。

JPanel 示例：

```
public class MainMenu() {

    private JButton btnSinglePlayer, btnMultiPlayer;

    public MainMenu() {
        setLayout(null);

        btnSinglePlayer = new JButton("singlePlayer");
        btnSinglePlayer.setBounds(320, 25, 275, 130);
        add(btnSinglePlayer);

        btnMultiPlayer = new JButton("MultiPlayer");
        btnMultiPlayer.setBounds(320, 170 , 275, 130);
        add(btnMultiPlayer);

   }
} 
```

帧切换器：

```
public class FrameSwitcher implements panelListener { // panelListener is an interface defined else where.

    public FrameSwitcher(MainFrame frame) {
        // This is irrelevant to the question. 
    } 

    @Override
    public void gamePanel() {
        System.out.println("GamePanel Event: Recieved");
    }
    @Override
    public void mainMenu() {
        System.out.println("mainMenu Event: Recieved");
    }
    @Override
    public void scoreBoardPanel() {
        System.out.println("scoreBoardPanel Event: Recieved");
    }
} 
```

然后是我的 MainFrame：

```
public class MainFrame extends JFrame implements ActionListener {

    private PanelListener panelListener;
    private JFrame mainContainer = new JFrame("Game");
    private JPanel mainMenu = new MainMenu();

    public void start() {
         mainContainer(mainMenu);
    }

    public MainFrame(JPanel frame) {
        mainContainer.getContentPane().add(frame);
        mainContainer.pack();
        // Other methods to initialize the frame
        return mainContainer;
     }

    public void switchFrames(PanelListener panelListener) {
        this.panelListener = panelListener; // PanelListener is an interface.
    }

    public void actionPerformed(ActionEvent e) {

        JButton source = (JButton)e.getsource();

        if(source == MainMenu.btnSinglePlayer) {
            if(panelListener != null) {
                System.out.println("Recieved the event approriately.");
            }
        }
    }
} 
```

在这个例子中，它确实编译了，但没有做它应该做的事情。另一件事是我目前将 JButtons 作为公共和静态的，我不希望这样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T23:09:05.047

在您的`MainMenu`课程中，您需要添加某种感兴趣的各方可以注册的侦听器，以便在发生某些事件时通知他们。

最简单的解决方案是提供一个`addActionListener`委托给每个按钮的方法。然而，这可能会暴露您未暴露的应用程序部分（监听器现在可以直接访问`JButton`并可以对它做各种讨厌的事情）。

一个更好的解决方案是创建类似 a 的东西，`MainMenuListener`它有类似的方法`startSinglePlayer`和`startMultiPlayer`

`add/removeMainMenuListener`然后，您将在您的课程中提供一个方法`MainMenu`。

然后每个按钮将在那里注册`actionListener`并触发相应的菜单侦听器事件

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.EventListener;
import javax.swing.JButton;
import javax.swing.JPanel;

public class MainMenu extends JPanel {

    private JButton btnSinglePlayer, btnMultiPlayer;

    public MainMenu() {
        setLayout(null);

        btnSinglePlayer = new JButton("singlePlayer");
        btnSinglePlayer.setBounds(320, 25, 275, 130);
        add(btnSinglePlayer);
        btnSinglePlayer.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                fireStartSinglePlayer();
            }
        });

        btnMultiPlayer = new JButton("MultiPlayer");
        btnMultiPlayer.setBounds(320, 170, 275, 130);
        add(btnMultiPlayer);
        btnMultiPlayer.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                fireStartMultiPlayer();
            }
        });

    }

    public void addMainMenuListener(MainMenuListener listener) {
        listenerList.add(MainMenuListener.class, listener);
    }

    public void removeMainMenuListener(MainMenuListener listener) {
        listenerList.remove(MainMenuListener.class, listener);
    }

    public void fireStartSinglePlayer() {
        MainMenuListener[] listeners = listenerList.getListeners(MainMenuListener.class);
        if (listeners != null && listeners.length > 0) {
            for (MainMenuListener listener : listeners) {
                listener.startSinglePlayer();
            }
        }
    }

    public void fireStartMultiPlayer() {
        MainMenuListener[] listeners = listenerList.getListeners(MainMenuListener.class);
        if (listeners != null && listeners.length > 0) {
            for (MainMenuListener listener : listeners) {
                listener.startMultiPlayer();
            }
        }
    }

    public interface MainMenuListener extends EventListener {

        public void startSinglePlayer();
        public void startMultiPlayer();

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:44:35.310

首先你必须像这样创建一个 ActionListener

```
class MyActionListener implements ActionListener{
    public void actionPerformed(ActionEvent ae){
        //do your stuff
    }
} 
```

然后打电话，

```
yourButton.addActionListener(new MyActionListener()); 
```

# javascript - 使用逗号或半逗号的区别

> ID：15509953
> 
> 赞同：0
> 
> 时间：2013-03-19T20:37:38.983
> 
> 标签：javascript

`comma`我对在 JavaScript 代码中使用OR的区别有疑问`semicolon`。

它们是否存在差异并影响代码的工作方式？

在下面的代码中，我更改了 var 定义后的分号，该分号`fib`具有逗号值`0`，但代码没有运行。

有人可以解释一下吗？

它发生的斐波那契的完整代码在这里：

```
<script>
    document.write("<h2>Числа Фибоначчи </h2>");
    for (i = 0, j = 1, k = 0, fib = 0; i < 50; i++, fib = j + k, j = k, k = fib) {
        document.write("Fibonacci (" + i + ") = " + fib);
        document.write("<br>");
    }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:02:39.560

之前的答案确实是正确的，但我认为这不是关于`for`- 它是关于逗号，它实际上是一个运算符：

> 逗号运算符计算其两个操作数（从左到右）并返回第二个操作数的值。- [MDC](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comma_Operator)

[如果您想了解更多信息：Angus C. 在他的博客](http://javascriptweblog.wordpress.com/2011/04/04/the-javascript-comma-operator/)中详细解释了它的作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:39:28.383

[for](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)包含 3 个表达式：

*   初始化（在循环之前运行），
*   循环测试结束（在每次迭代之前运行），
*   和迭代后的语句。

javascript 中的语句由 . 分隔`;`。如果将 更改`;`为 a `,`，则不会结束 init 语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T20:45:27.327

可能让您感到困惑的部分是“正常”for循环需要三个语句，如下所示：

```
for (var i=0; i<5; i++)
  {
  x=x + "The number is " + i + "<br>";
  } 
```

但是您的示例将这些表达式替换为逗号分隔的参数。

`var i=0`->`i = 0, j = 1, k = 0, fib = 0`

`i++`->`i++, fib = j + k, j = k, k = fib`

顺便说一句，这是很糟糕的代码，阅读起来非常困难，而且更难维护。**不要使用它。**

# .net - 用于 Windows Server 事务/错误处理的服务总线 1.0

> ID：15509955
> 
> 赞同：2
> 
> 时间：2013-03-19T20:37:44.443
> 
> 标签：.net, wcf, msmq, msdtc, servicebus

我敢肯定我不是第一个这么说的人，但是关于 Windows Server 的 Service Bus 1.0 的细节方面的文档严重缺乏......我希望一些 MS 内部人员可以帮助清除一个几件事情...

1.  使用队列/主题的服务是否在隐式环境事务中运行？例如，考虑以下代码片段：

    ```
    [ServiceBehavior]
    public class MySbService : IDoWork
    {
        [OperationBehavior]
        void DoSomeWork(WorkRequest request)
        {
            DoDatabaseWork();

            DoMoreDatabaseWork();
        }
    } 
    ```

    在上面的示例中，如果没有创建明确的，如果抛出异常`TransactionScope`会`DoDatabaseWork()`被提交吗？`DoMoreDatabaseWork()`换句话说，排队操作是否在 MSDTC 跟踪的环境事务下运行？

2.  如果抛出异常，Service Bus 1.0 队列是否会自动重试（如 MSMQ 那样）？我问是因为我没有遇到任何指定重试行`.config`为的设置。此外，当使用我看到的最接近的东西`netMessagingBinding`创建队列时。来自 MSMQ 背景，我习惯于看到异常消息出现在重试/毒药队列中。在 Service Bus 1.0 世界中是否有与此同义的东西？`Service Bus Explorer``MaxDeliveryAttempt`

先感谢您

**更新：**

请在下面查看我的答案以获取更多详细信息。我正在修改这个问题以提出以下问题：

是否可以使用带有服务总线 1.0 的合同优先、IIS 托管的 WCF 来“覆盖”客户端在事务中发送到服务总线？如果是这样，怎么做？另外，使用的机制是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T16:01:36.540

我相信我已经找到了我的两个问题的答案......

1.  对于`Transactional`运营，我不相信存在“环境”交易。我已经通过在数据库操作后简单地抛出异常来证明这一点，果然，无论如何数据都已提交。我想知道是否有声明事务范围的首选方法，即：

    ```
    [OperationBehavior(TransactionScopeRequired = true)]
    public void MyServiceOperation(){ ... }

    //or using the TransactionScope

    public void MyServiceOperation()
    {
        using(var transScope = new TransactionScope(...)){ ... }
    } 
    ```

2.  `ReceiveContext`对于重试功能，您似乎需要启用[以下博客](http://weblogs.asp.net/cibrax/archive/2012/04.aspx)：

    ```
    [ServiceContract]
    public interface IMyService
    {
        [OperationContract(IsOneWay=true)]
        [ReceiveContextEnabled(ManualControl = true)]
        void MyServiceOperation();

    // and in the service implementation:

    [OperationBehavior]
    public void MyServiceOperation()
    {
        var incomingProperties = OperationContext.Current.IncomingMessageProperties;
        var property = incomingProperties[BrokeredMessageProperty.Name] as BrokeredMessageProperty;

        //Complete the Message

        ReceiveContext receiveContext;
        if (ReceiveContext.TryGet(incomingProperties, out receiveContext))
        {
            //Do Something                

            receiveContext.Complete(TimeSpan.FromSeconds(10.0d));
        }

        else
        {
            throw new InvalidOperationException("...");
        }
    } 
    ```

**更新：**

在深入挖掘之后，我发现如果您使用普通的、合同优先、IIS 托管、带有 Service Bus 1.0 的 WCF，那么 OperationContext 完成并不是一个真正的选择（不知道为什么，但我我希望有人能对此有所了解）

我发现关于事务行为的唯一理智选项如下：

```
[OperationBehavior]
public void MyServiceOperation()
{
    using(var transScope = new TransactionScope(...))
    {
        DbWork();
        transScope.Complete();
    }

    Client.SendToServiceBus(); // <-- Cannot be part of transaction, otherwise
                               //     exceptions will be thrown!
} 
```

问题仍然是，这种模式与 MSMQ 不同，如果将消息发送到服务总线失败，则不允许回滚整个操作。（当然，除非有人知道得更好……）

这也意味着您被迫滚动自己的重试逻辑，并且可能有一些机制在下一步验证上一步是否已提交。呸！

据我了解，工作流服务和直接处理代理消息为您提供了一些开箱即用的重试功能。但是，如果您通过 AppFabric 使用 IIS 托管您的工作流服务，那么微软不知何故想出了如何让事务覆盖发送到服务总线。（如果有人知道那个机制是什么，请告诉我！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T18:10:37.437

对于#2，您可以通过瞬态故障处理框架重试

[http://windowsazurecat.com/2011/02/transient-fault-handling-framework/](http://windowsazurecat.com/2011/02/transient-fault-handling-framework/)

通读本文档以了解与服务总线相关的用法。

[http://social.technet.microsoft.com/wiki/contents/articles/best-practices-for-leveraging-windows-azure-service-bus-brokered-messaging.aspx?Sort=MostRecent&PageIndex=1](http://social.technet.microsoft.com/wiki/contents/articles/best-practices-for-leveraging-windows-azure-service-bus-brokered-messaging.aspx?Sort=MostRecent&PageIndex=1)

# r - ggplot2 在此特定示例中更改图例标题

> ID：15509963
> 
> 赞同：4
> 
> 时间：2013-03-19T20:38:11.027
> 
> 标签：r, ggplot2, title, legend

我尝试了很多建议，但没有一个适合这个特别简单的例子。如何将图例标题更改为 Sample？

```
df1 <- data.frame(
  Order = c(1,1,2,2),
  Tissue = c("Bladder","Pancreas","Bladder","Pancreas"),
  Sample = c("WT","WT","Mutant","Mutant"),
  Percent = c(94.12,55,5.88,45)
)

ggplot(data = df1, aes(x = Tissue, y = Percent, group = Sample)) + 
    geom_point(aes(shape=reorder(Sample,Order), fill=reorder(Sample,Order)), size = 6) +
    scale_shape_manual(values=c(21,22)) +
    scale_fill_manual(values=c("deepskyblue1","yellow")) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T20:46:36.317

`scale_XX`接受`name`可以调整的参数：

```
scale_shape_manual(name = "Sample", values=c(21,22)) +
scale_fill_manual(name = "Sample", values=c("deepskyblue1","yellow")) 
```

如果您不将它传递给两个比例，它显然会默认创建两个单独的图例。

您也可以`reoder()`在传递到您的绘图代码之前做一些事情。

有关详细信息，请参见[此处](http://docs.ggplot2.org/current/scale_manual.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-19T20:52:30.167

另一种选择是使用`guides`

```
bp + guides(fill=guide_legend("Sample"),shape=guide_legend("Sample")) 
```

![在此处输入图像描述](../Images/b376a8cb4b275bd6a9a8e7f3564425b0.png)

# knockout.js - 可见绑定——淘汰JS

> ID：15509973
> 
> 赞同：0
> 
> 时间：2013-03-19T20:38:48.867
> 
> 标签：knockout.js, knockout-2.0

我正在尝试使用 3 张带有点击事件的图像来控制元素的可见性（下面小提琴代码中的黄色框）。它不工作。

我定义了以下可见性属性

```
 IsSelectionPoll = ko.observable(true);
    IsBoolPoll = ko.observable();
    IsRatePoll = ko.observable(); 
```

这是点击事件：

```
SetTypeId = function (typeId) {
  //selectPollType = typeId;
  $('<p/>').text(typeId).appendTo('body');
  IsSelectionPoll = (typeId == '1');
  console.log(typeId);
  IsBoolPoll = (typeId == '3');
  IsRatePoll = (typeId == '2');
 } 
```

我尝试使用 SELF 和 this 以及许多其他技巧，但我不知道为什么它不起作用。

请在此处查看代码：http: [//jsfiddle.net/goldenrate/NfDyX/](http://jsfiddle.net/goldenrate/NfDyX/)

谢谢，大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T21:11:01.883

您没有在其中创建任何视图模型 - 将函数声明更改为：

```
function PollWizardViewModel(initialData){ 
```

然后绑定线：

```
 ko.applyBindings(new PollWizardViewModel()); 
```

一旦完成，点击绑定本身应该可以正常工作。

**编辑**：另外，不要重新分配您的可观察对象，而只需更改它们的值，否则与 dom 的绑定会丢失（因为链接是与重新分配它们的引用时丢弃的旧可观察对象） - 例如，而不是：

```
this.IsSelectionPoll = (typeId == '1'); 
```

采用：

```
this.IsSelectionPoll(typeId == '1'); 
```

# uitableview - 在自定义 TableView 类下将按钮添加到自定义表格视图单元格

> ID：15509977
> 
> 赞同：1
> 
> 时间：2013-03-19T20:39:03.937
> 
> 标签：uitableview, storyboard

**编辑：**请参阅我的答案，了解以某种方式实现了我正在尝试做的功能的应用程序。

我已经检查了这一点并遵循了所有可用的教程——这一切看起来都很简单，但我的 Storyboard 和检查器现在只允许我执行以下操作：

-- 向自定义 UITableViewButtons 添加按钮（使用自定义类“Song Cell”）

每次我尝试这样做时，它都会将按钮放在表格视图上方的视图上。我尝试将单元格设置为动态、静态、基本以及我能找到的所有其他拨动开关。

我认为这是因为我在视图方面的设置有点尴尬，所以我也尝试将我的 TableView 设置为自定义类。但是，它没有出现在 Storyboard 的 Class Inspector 中。这是我所做的，将此表视图设置为自定义类，所以无济于事：

-- 创建继承自 UITableViewController 的自定义类，称为 SongTableViewController

-- 在 Storyboard 中，将一个表视图控制器的类设置为 SongTableViewController

请参阅此层次结构：

// 编辑 - 显然我没有 10 个代表来发布图片，所以我自己画吧：

```
▼ Voting View Controller - Current Songs
   ▼ View
     ▼ Table View     // This is where I would like the custom class, SongTableViewController
       > Song Cell     
       > Song Cell    //  These cells are where I would like to add the custom buttons
       > Song Cell
       > Constraints
     > Label - 00:00
     > Label - Voting will reset in:
    Navigation Item - Current Songs
First Responder
Exit 
```

当我选择 Table View 并去检查器更改它的类时，除了 UITableView 没有其他选项。尝试对此进行硬编码并点击“返回”也无济于事。

由于我的视图结构，我无法向这些单元格添加按钮吗？或者是其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T20:48:23.867

也许您应该使用自定义单元格创建一个 xib。例如，带有 xib“CustomeCell.xib”的类“CustomeCell”。

您通过 xib 文件将一些对象放在您的单元格上，并使用您的 UITableView 在您的类中，执行以下操作：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    CustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"CustomCell" owner:self options:nil];
        cell = [topLevelObjects objectAtIndex:0];
    }
    // configure cell 

    return cell;
} 
```

不要忘记在 xib 文件中为您的 TableView 链接您的数据源和委托，并在您的 UITableView 类中添加委托:)

故事板很有用，但有时，最好的方法是使用 xib 文件 :)

***编辑：***您可以阅读本教程，这是一个很好的示例，如何使用 xib 文件管理自定义单元格/表格视图：http: [//www.appcoda.com/customize-table-view-cells-for-uitableview/](http://www.appcoda.com/customize-table-view-cells-for-uitableview/)

希望对你有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:46:07.647

您可能不想更改表格视图的类。听起来您真正想做的是更改一个（或多个）单元原型的类。在情节提要中选择其中一个单元格并将其类更改为您的歌曲单元格类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T22:26:44.703

这是对正在发生的事情的描述，以及如何实现这一点的示例：

> 您有一个 UIViewController 子类，并通过在情节提要中拖放来将表格视图添加到其中。
> 
> 然后，您需要做一些额外的工作来填补表格视图控制器和普通视图控制器之间的空白 - 声明您符合数据源和委托协议，为表格视图创建一个出口，将出口连接到表格查看表视图的委托和数据源出口并将其连接到您的 VC。
> 
> 实现三个数据源方法（节数、行数和 cellForRow...），您就完成了。

[链接到原型](https://docs.google.com/open?id=0B3FbUXsjem4pcFJkeWpTVzVRdVU)

# reporting-services - MDX：如何将一个维度中的多个值合并为一个？

> ID：15509984
> 
> 赞同：0
> 
> 时间：2013-03-19T20:39:36.580
> 
> 标签：reporting-services, mdx, olap

我正在一个 OLAP 多维数据集上构建一个 SSRS 报告，该多维数据集按货币分解数据。货币进入列。不同之处在于用户只想查看几种主要货币（如美元、欧元、日元），并将其他所有货币组合到“其他”列中。

实际上，我需要将整个货币世界分解为美元、欧元、日元和其他货币。实现它的最佳方法是什么？我觉得这应该是可行的，但我找不到谷歌搜索的正确关键字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T00:54:51.203

假设您有一个可以安全地组合到“其他”组中的度量，您可以通过创建一组“主要”成员和一个新的“其他”成员来组合多个成员，该成员是具有“主要”的所有成员的聚合“那些被删除了。

这是一个针对 Adventure Works 的示例：

```
WITH 
    SET [Major] AS {
        [Source Currency].[Source Currency Code].&[100], 
        [Source Currency].[Source Currency Code].&[19],
        [Source Currency].[Source Currency Code].&[98]
        }
    MEMBER [Source Currency].[Source Currency Code].[Other] AS 
        Aggregate(Except([Source Currency].[Source Currency Code].[Source Currency Code], [Major]))
SELECT
    {[Major], [Other]} ON 0,
    [Customer].[Customer Geography].[Country] ON 1
FROM [Adventure Works]
WHERE [Measures].[Internet Sales Amount] 
```

结果：

```
 USD            CAD            GBP          Other
Australia           $9,012.50         (null)         (null)  $9,051,988.08 
Canada            $172,181.96  $1,805,662.90         (null)         (null)
France          $2,462,361.69         (null)      $1,084.33    $180,571.69 
Germany         $2,656,527.35         (null)         (null)    $237,784.99 
United Kingdom      $4,446.85         (null)  $3,387,265.36         (null)
United States   $9,388,934.97        $854.54         (null)         (null) 
```

# android - 使用 eclipse 和 sdk 包而不是手动配置的 eclipse 是否很好

> ID：15509989
> 
> 赞同：0
> 
> 时间：2013-03-19T20:39:48.963
> 
> 标签：android, eclipse

我是android的初学者。为了使用 android sdk，我得到了一个完整的包，它结合了 eclipse 和 android sdk，名为“adt-bundle-windows-”。使用这个捆绑包好还是我应该手动配置一个新的 Helios eclipse 经典？因为我在仿真和 sdk 管理器方面遇到了一些问题。基本上我想知道使用这个包比手动配置的eclipse更好吗？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:40:50.337

该捆绑包应该让您的生活更轻松 - 一切都为您正确配置。如果您真的愿意，可以手动完成，但不能保证该插件适用于旧版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T21:16:43.833

这是一个非常适合你的教程，有了它你会学到你想知道的一切，从头到尾你都有一切......希望你喜欢它！我正在使用它，它是完美的，

[http://www.youtube.com/course?list=EC2F07DBCDCC01493A](http://www.youtube.com/course?list=EC2F07DBCDCC01493A)

# gwt - 盯着 GWT 可视化 API 时的一系列异常。$wnd.google 未定义

> ID：15509995
> 
> 赞同：0
> 
> 时间：2013-03-19T20:40:06.487
> 
> 标签：gwt, charts, visualization, smartgwt

在这里，我试图显示我的[PieChart](http://code.google.com/p/gwt-google-apis/wiki/VisualizationGettingStarted)。

在我输入下面的代码之后

```
public void onModuleLoad() {
    // Create a callback to be called when the visualization API
    // has been loaded.
    Runnable onLoadCallback = new Runnable() {
      public void run() {
        Panel panel = RootPanel.get();

        // Create a pie chart visualization.
        PieChart pie = new PieChart(createTable(), createOptions());

        pie.addSelectHandler(createSelectHandler(pie));
        panel.add(pie);
      }
    };

    // Load the visualization api, passing the onLoadCallback to be called
    // when loading is done.
    VisualizationUtils.loadVisualizationApi(onLoadCallback, PieChart.PACKAGE);
  } 
```

由于 GWT 省略了 Runnable（？作为单线程`javascript`模型），它永远不会进入 run 方法（我真的很想知道为什么他们给出了那个示例代码）。

在这里有了一些[线索](https://stackoverflow.com/questions/5380343/wnd-google-visualization-is-undefined)后，我写了

```
<script type="text/javascript">
        google.load("visualization", "1", {'packages' : ["corechart"] });
</script> 
```

添加后，stackTrace 中甚至没有任何一行更改。在我一整夜过去之后，我仍然使用以下 stackTrace。

```
com.google.gwt.core.client.JavaScriptException: (TypeError): $wnd.google.visualization is undefined
    at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:248)
    at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNativeObject(ModuleSpace.java:269) 
```

看到错误后，我找到了一些解决方案，促使我在我的主机页面中添加脚本标签 [$wnd.google.visualization 未定义](https://stackoverflow.com/questions/5380343/wnd-google-visualization-is-undefined)

甚至没有运气。

我错过了什么吗？

这有什么线索吗？？

PS 我在我的文件中添加`charts`了`visualization`jars 和继承`gwt.xml`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T04:57:37.663

将以下代码段添加到 html 文档：

```
 <script type="text/javascript" src="http://www.google.com/jsapi"></script>
 <script type="text/javascript">
    google.load("visualization", "1", {'packages' : ["corechart"] });
 </script> 
```

# php - 需要 MySQL 错误代码

> ID：15509997
> 
> 赞同：0
> 
> 时间：2013-03-19T20:40:20.647
> 
> 标签：php, mysql, error-handling, http-status-code-404

即使数据与查询不匹配，MySQL 也会始终发送“默认响应”！

如果没有数据与查询匹配，我如何设计查询以从 MySQL 获取错误代码？

我需要来自 MySQL 的错误代码来创建 404 或 410 页面。

```
SELECT
place.ID AS id,
place.latitude AS lat,
place.longitude AS lng,

IF(
place.translationID IS NULL,
place.name,
placel10n.text
) AS cityname,

IF(
admcode.translationID IS NULL,
'',
statel10n.text
) AS statename,

IF (  
countrycode.translationID IS NULL,
countrycode.name,
countryl10n.Text
) AS countryname,

IF(
place.textID IS NULL,
'',
`l10n-strings`.text
) AS description

FROM
places AS place

LEFT JOIN `l10n-strings` AS placel10n ON (place.translationID = placel10n.translationID         AND placel10n.languageCode = 'de')
LEFT JOIN admin1codesascii AS admcode ON (place.admin1 = admcode.statecode AND     place.country = admcode.country)
LEFT JOIN `l10n-strings` AS statel10n ON (admcode.translationID =    statel10n.translationID AND statel10n.languageCode = 'de')
LEFT JOIN countries AS countrycode ON (place.country = countrycode.iso_alpha2)
LEFT JOIN `l10n-strings` AS countryl10n ON (countrycode.translationID =    countryl10n.TranslationID AND countryl10n.LanguageCode = 'de')

LEFT JOIN texts ON (place.textID = texts.id)
LEFT JOIN `l10n-strings` ON (texts.translationID = `l10n-strings`.translationID AND    `l10n-strings`.languageCode= 'de')

WHERE
place.id = '8'
AND
place.featurecode = 'A'
OR
place.featurecode = 'AB'
OR
place.featurecode = 'AAC'

LIMIT 0,1 
```

即使`where`语句错误，此查询也始终返回结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T20:52:48.773

是的，这就是 SQL 的工作方式。如果没有与您的查询匹配的行，则结果集将为空。这是嵌入 SQL 查询以响应“无行”情况并更改响应状态（更改为 404 或您有什么）的程序的工作（用 PHP 编写或您有什么）。SQL 查询不对 HTTP 状态代码负责——它是粉笔和奶酪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T01:13:11.103

在 MySQL 中，[AND 的运算符优先级高于 OR](http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html)，因此 WHERE 子句中的条件将被解释为

```
(place.id = '8' AND place.featurecode = 'A') OR
place.featurecode = 'AB' OR 
place.featurecode = 'AAC' 
```

使用括号来明确说明您想要的操作顺序。也许你是这个意思？

```
place.id = '8' AND 
   (place.featurecode = 'A' OR 
    place.featurecode = 'AB' OR 
    place.featurecode = 'AAC') 
```

# mysql - 由于单独的索引，MySQL 查询速度慢？

> ID：15509999
> 
> 赞同：2
> 
> 时间：2013-03-19T20:40:31.750
> 
> 标签：mysql, myisam

这是我的情况。我有一个 MySQL MyISAM 表，其中包含大约 400 万条记录，总共 13,3 GB 的数据。该表包含从外部系统接收到的消息。表中的两列跟踪时间戳和布尔值是否处理消息。

使用此查询时：

```
SELECT MIN(timestampCB) FROM webshop_cb_onx_message 
```

结果几乎立即出现。

但是，我需要找到未处理消息的最早时间戳，如下所示：

```
SELECT MIN(timestampCB ) FROM webshop_cb_onx_message WHERE handled = 0 
```

这个查询的结果在大约 3 分钟后出现，这对于我正在编写的脚本来说太慢了。

两列都是单独索引的，而不是一起索引的。但是，考虑到已经存在的数据量，向表中添加索引将花费非常长的时间。

我的问题是否源于两个列都被单独索引的事实，如果是这样，除了添加另一个索引之外，是否有人可以解决我的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T20:49:26.877

通常建议，如果索引的选择性超过 20%，则全表扫描优于索引访问。这意味着您的已处理索引很可能实际上不会导致使用该索引，而是在给定选择性的情况下进行全表扫描。

复合索引`handled, timestampCB`实际上可能会在给定复合索引的情况下提高性能，即使选择性不是很好，MySQL 很可能仍然会使用它——即使它没有，你也可以[强制它使用](http://dev.mysql.com/doc/refman/5.1/en/index-hints.html)。