# StackOverflow 问答 13905000-13905999

# mysql - sql消息表查询

> ID：13905000
> 
> 赞同：2
> 
> 时间：2012-12-16T20:03:12.447
> 
> 标签：mysql, sql, oracle

这是我的对话表：

```
conversationID  ||  userID
      1         ||    1
      1         ||    2
      2         ||    1
      2         ||    2
      2         ||    3 
```

如您所见，每个对话可以包含 2 个或更多用户。

我正在尝试获取只有 2 个用户在那里的对话的 ID。即只包含用户 1 和 2 的对话，答案是对话 1。

但我怎么得到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T20:15:16.770

你应该使用有子句。假设 ( conversationID, userID ) 是 PK 或 AK，您的查询是：

```
 select   conversationID
    from   your_Table
group by   conversationID
  having   count( * ) = 2 
```

**已编辑**加入 1,2 个用户对话，这是一种索引友好的方法，没有关联子查询，也没有逐行功能。

```
 select   t1 conversationID
        from   your_Table t1
  inner join 
               ( select distinct conversationID
                  from your_Table
                 where userId in (1, 2)
               ) t2
          on   t1.conversationID = t2.conversationID
    group by   t1.conversationID
      having   count( distinct t1.userId ) = 2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T21:28:37.003

这将选择具有用户 1 或用户 2 或两者的所有对话，但没有其他人：

```
select conversationID
from conversations
group by conversationID
having count(*) = count(case when userID in (1,2) then 1 end) 
```

如果您还想要所有只有用户 1 和 2 的对话，而没有其他人，您还必须添加一个 and 条件：

```
select conversationID
from conversations
group by conversationID
having count(*) = count(case when userID in (1,2) then 1 end)
       and count(*) = 2 -- number of elements in set 
```

如果 userID 可以重复，最好使用 distinct：

```
select conversationID
from conversations
group by conversationID
having
  count(distinct userID) = count(distinct case when userID in (1,2) then userID end)
  and count(distinct userID) = 2 -- number of elements in set 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-17T07:32:44.833

希望这对你有帮助，

```
select conversationID from conversation
group by ConversationID having count(distinct UserID)=2; 
```

[sqlfiddle 演示](http://sqlfiddle.com/#!2/3c775/16)

# php - 如何修复 Plesk 中的 FastCGI 超时问题？

> ID：13905004
> 
> 赞同：9
> 
> 时间：2012-12-16T20:03:33.837
> 
> 标签：php, centos, fastcgi, plesk, connection-timeout

PHP 支持当前设置为：作为快速 CGI 运行。

我在服务器日志中不断收到这些错误：

> mod_fcgid：45秒内读取数据超时
> 
> 脚本头过早结束：index.php

我认为应该是快速修复，但我找不到要编辑的文件。这是我可以从 Plesk 更改的东西吗？

任何人都知道如何增加超时？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-04-06T23:34:33.563

在 Plesk 12.x 和类似版本中，转到*Web 服务器设置*并设置以下指令：

*HTTP 和 HTTPS 的附加指令*

```
FcgidBusyTimeout 300
FcgidIOTimeout 250 
```

以上几行将更改静默时间过长且执行时间过长的脚本的超时时间。

*额外的 nginx 指令*

```
proxy_read_timeout 300; 
```

以上几行将更改代理超时。

如果问题仍然存在，请增加值。

另请参阅：[脚本头过早结束：index.php、mod_fcgid：读取数据超时](https://stackoverflow.com/q/14488567/55075)

* * *

检查屏幕截图以获取指导：

[![Plesk 12.x - Web 服务器设置 - 附加 Apache 指令：HTTP 和 HTTPS 的附加指令 - FcgidBusyTimeout 和 FcgidIOTimeout](../Images/712aa614a6fca52453dd129a4026c405.png)](https://i.stack.imgur.com/RHNAm.png)

[![Plesk 12.x - Web 服务器设置 - 附加 nginx 指令 - proxy_read_timeout](../Images/a7eaae1ec17ca8df6fcbe7cbd51bec73.png)](https://i.stack.imgur.com/tZaUW.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-13T12:09:48.417

Parallels 工作人员在 Plesk 论坛中提供的解决方案

> 编辑文件：
> 
> /etc/httpd/conf.d/fcgid.conf
> 
> 具体来说，改变
> 
> FcgidIO超时 45
> 
> 至
> 
> FcgidIO超时 3600
> 
> 3600 秒 = 1 小时。对于大多数人来说应该足够长，但如果需要向上调整。我在其中看到一个引用 7200 秒的示例。
> 
> 最后，重新启动 Apache 以激活新设置。
> 
> apachectl 优雅

希望能帮助到你

R

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-19T10:25:03.583

我对此的解决方案是根据屏幕截图更改 plesk 控制面板中的 PHP 设置。[PHP 设置](http://i.stack.imgur.com/a0EPE.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-26T11:41:49.823

在新版本的 Plesk 中，fcgid.conf 文件已移至：

> /etc/apache2/mods-available/fcgid.conf

我在将 xml 文件导入 wordpress 时遇到了一些问题。它继续给出 500 内部错误。错误日志显示：

> [2017 年 7 月 26 日星期三 13:18:00.219226] [fcgid:warn] [pid 4751] [client 145.97.205.8:60155] mod_fcgid：读取数据超时 45 秒
> 
> [2017 年 7 月 26 日星期三 13:18:00.219505] [fcgid:warn] [pid 4751] (110) 连接超时：[client 145.97.205.8:60155] mod_fcgid：ap_pass_brigade 在 handle_request_ipc 函数中失败

在遵循一些建议之后 - 由于 PHP.INI 设置没有任何区别 - 我按照建议更改了一些设置：

原来的：

```
FcgidIOTimeout 45 
```

至：

```
FcgidIOTimeout 3600 
```

还补充说：

```
<IfModule mod_fcgid.c>
FcgidMaxRequestsPerProcess 500
<IfModule !mod_fastcgi.c> 
```

像魅力一样工作。谢谢您的帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-12T19:14:03.503

在 /etc/php.ini 中更改 max_execution_time = 3600 后解决了我的问题。

# windows-phone-7 - Observable.FromAsyncPattern：传递给 BeginInvoke 的参数为空

> ID：13905007
> 
> 赞同：0
> 
> 时间：2012-12-16T20:04:16.633
> 
> 标签：windows-phone-7, linq-to-sql, system.reactive

我正在尝试使用 Rx 在 Windows Phone 7.5 上为 linq-to-sql 编写异步 DataContext。我的想法是在DataContext中定义一个方法：

```
IObservable<List<Fact>> GetFacts(Func<MyDataContext, IQueryable<Fact>> selector)
    {
        var selectFacts = Observable.FromAsyncPattern<MyDataContext, IQueryable<Fact>>(selector.BeginInvoke, selector.EndInvoke);
        return selectFacts(db).Select((query) => query.ToList());// db variable is MyDataContext instance, and is not null during the call or later
    } 
```

然后应该从客户端代码调用此方法，如下所示：

```
var q = GetFacts((database) => from item in database.Facts select item)
    .ObserveOnDispatcher()
    .Do((facts) => MessageBox.Show(facts.Count.ToString()))
    .Subscribe(); 
```

我面临的问题很奇怪。当`from item in database.Facts select item`实际调用客户端选择器 ( )时，`database`其上下文中的参数为空！因此，我显然得到了 NullReferenceException。但是当`selectFacts`被调用时，该`db`值是非空的，并且指向正确的实例。

这个事实有什么解释吗？如何克服它？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T20:39:36.430

我认为你正在以一种非常奇怪的方式解决这个问题。如果你想在后台运行代码并让它返回一个`IObservable<T>`（如任务），你应该使用`Observable.Start`：

```
IObservable<List<Fact>> factsFuture = Observable.Start(
    () => selectFacts(db).Select(query).ToList(), 
    Scheduler.ThreadPoolScheduler); 
```

# python - 为什么 Python 列表加法必须是同质的？

> ID：13905008
> 
> 赞同：24
> 
> 时间：2012-12-16T20:04:24.837
> 
> 标签：python, language-design, language-implementation, python-internals

任何熟悉 Python 内部结构（CPython 或其他实现）的人都可以解释为什么列表添加必须是同质的：

```
In [1]: x = [1]

In [2]: x+"foo"
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
C:\Users\Marcin\<ipython-input-2-94cd84126ddc> in <module>()
----> 1 x+"foo"

TypeError: can only concatenate list (not "str") to list

In [3]: x+="foo"

In [4]: x
Out[4]: [1, 'f', 'o', 'o'] 
```

为什么上述内容不应该返回与上述成绩单中`x+"foo"`的最终值相同的值？`x`

这个问题来自 NPE 的问题：[Python's list += iterable 的行为是否记录在任何地方？](https://stackoverflow.com/q/13904493/21640)

更新：我知道不需要异构`+=`工作（但确实如此），同样，不需要异构工作`+`是错误的。这个问题是关于为什么做出后一种选择。

说将序列添加到列表中的结果是不确定的，这太过分了。如果这是一个充分的反对意见，那么防止异质`+=`. 更新 2：特别是，python 总是将运算符调用委托给左侧操作数，因此不会出现“什么是正确的事情”的问题：左侧对象总是管理（除非它委托给右侧）。

更新 3：对于任何争论这是一个设计决定的人，请解释 (a) 为什么它没有记录在案；(b) 记录在案的地方。

Update4：“应该`[1] + (2, )`返回什么？” 它应该返回一个结果值，该值等于`x`最初保持`[1]`在 之后的变量的值`x+=(2, )`。这个结果是明确定义的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-16T20:53:52.693

来自 Python 之禅：

> 面对模棱两可，拒绝猜测的诱惑。

让我们看看这里发生了什么：

```
x + y 
```

这给了我们一个值，但是是什么类型的呢？当我们在现实生活中添加东西时，我们期望类型与输入类型相同，但如果它们是不同的呢？好吧，在现实世界中，我们拒绝添加`1`and `"a"`，这没有任何意义。

如果我们有类似的类型怎么办？在现实世界中，我们看上下文。计算机无法做到这一点，所以它必须猜测。Python 选择左操作数并让其决定。您的问题是由于缺乏上下文而发生的。

假设程序员想要做`["a"] + "bc"`- 这可能意味着他们想要`"abc"`或`["a", "b", "c"]`. 目前，解决方案是调用`"".join()`第一个操作数或`list()`第二个操作数，这允许程序员做他们想做的事情，并且清晰明确。

您的建议是让 Python 猜测（通过内置规则来选择给定的操作数），因此程序员可以通过加法来做同样的事情 - 为什么这样更好？这只是意味着更容易错误地得到错误的类型，我们必须记住一个任意规则（左操作数选择类型）。相反，我们得到一个错误，因此我们可以为 Python 提供进行正确调用所需的信息。

那么为什么不`+=`一样呢？嗯，那是因为我们给了 Python 那个上下文。通过就地操作，我们告诉 Python 修改一个值，所以我们知道我们正在处理我们正在修改的值的类型。这是 Python 进行正确调用所需的上下文，因此我们无需猜测。

当我谈论猜测时，我说的是 Python 猜测程序员的意图。这是 Python 经常做的事情——参见 3.x 中的除法。`/`做浮点除法，纠正了它在 2.x 中是整数除法的错误。

这是因为当我们尝试除法时，我们隐含地要求浮点除法。Python考虑到了这一点，它的操作就是按照这个来完成的。同样，这里是关于猜测意图。当我们添加`+`我们的意图是不清楚的。我们用`+=`的时候，就很清楚了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-17T13:50:22.977

这些错误报告表明这种设计怪癖是一个错误。

[问题12318](http://bugs.python.org/issue12318)：

> 是的，这是预期的行为，是的，它是不一致的。
> 
> 这种情况已经有很长一段时间了，Guido 说他不会再这样做了（这在他的遗憾清单中）。但是，我们不会通过更改代码来破坏代码（`list.__iadd__`工作方式类似`list.extend`）。

[问题575536](http://bugs.python.org/issue575536)：

> 意图是`list.__iadd__`完全对应于 `list.extend()`. 也没有必要 `list.__add__()`过度概括：不想对类似 Martin 的示例感到惊讶的人可以通过使用 plain `+`for 列表来避免它们。

（当然，我们当中有些人觉得这种行为非常令人惊讶，包括打开该错误报告的开发人员）。

（感谢@Mouad 找到这些）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-17T03:30:00.707

我相信 Python 设计人员以这种方式进行了加法运算，以便 '+' 运算符在结果类型方面保持一致的可交换性：`type(a + b) == type(b + a)`

每个人都希望 1 + 2 与 2 + 1 有相同的结果。你会希望 [1] + 'foo' 与 'foo' + [1] 相同吗？如果是，结果应该是什么？

您有 3 个选择，您可以选择左操作数作为结果类型，选择右操作数作为结果类型，或者引发错误。

+= 不可交换，因为它包含赋值。在这种情况下，您要么选择左操作数作为结果类型，要么抛出。这里的惊喜`a += b`是不一样`a = a + b`。`a += b`不会用英语翻译成“将 a 添加到 b 并将结果分配给 a”。它翻译为“将a添加到b”。这就是为什么它不适用于字符串或元组等不可变对象的原因。

感谢您的评论。编辑了帖子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T20:24:10.627

我的猜测是 Python 是强类型的，并且没有明确的指示在这里做*正确*的事情。您是在要求 Python 附加字符串本身，还是将字符串转换为列表（这是您表示希望它执行的操作）？

请记住，显式优于隐式。在最常见的情况下，这些猜测都不是正确的，并且您不小心尝试做一些您不打算做的事情。提出一个 TypeError 并让你解决它是最安全、最 Pythonic 的事情。

# php - 显示来自多个用户的具有共同主题标签的推文

> ID：13905014
> 
> 赞同：0
> 
> 时间：2012-12-16T20:05:05.473
> 
> 标签：php, regex, api, twitter

我正在构建一个程序，该程序使用通用标签显示一组特定用户的 twitter 提要。该程序从表单中的用户输入中获取一组用户名和一个标签。我正在使用正则表达式（我不太擅长的东西）来清除包含主题标签的推文，然后我想回应出来。但是，该程序目前无法运行。这是我的工作：

```
 <?php
        $hash = $_GET['hash'];
        $users = $_GET['users'];
        $users = str_replace(" ", "", $users);
        $hash = str_replace(" ", "", $hash);
        $users = explode(",",$users);
        $regex = "/^[#]+[a-zA-Z0-9_]+[ ]$/";
        $url = 'http://search.twitter.com/search.json?q='.$user.'&lang=en&rpp=100';

        foreach($users as $user){
        $jsontwitter = file_get_contents($url);
        $twitter = json_decode($jsontwitter, true);
        $twittertext = $twitter["results"];

        if(preg_match($regex, $twittertext['text'])){
        foreach($twittertext as $text){
        echo '<a href="http://twitter.com/'.$text['from_user'].'">@'.$text['from_user'].'</a>: '.$text['text'].'<br>';
            }
          }
        }
    ?> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T04:33:28.017

想通了，在朋友的帮助下。$url 变量需要在 for 循环中才能使用定义的 $user 变量运行搜索。从那里，json 被返回、解码，结果通过另一个 for 循环运行，以隔离包含指定主题标签的单个推文，在 if 语句中使用正则表达式。推文随后被回显。此外，处理正则表达式的方式不正确 - 它正在寻找以 # 开头并包含任何字符并以空格结尾的字符串。它应该寻找一个带有 # 的字符串，其后是 $hash 变量，后跟一个空格。

生成的工作脚本：

```
<?php
$hash = $_GET['hash'];
$users = $_GET['users'];

$users = str_replace(" ", "", $users);
$hash = str_replace(" ", "", $hash);
$users = explode(",",$users);

$regex = "/($i)#". $hash ."/";

foreach($users as $user){

    $url = 'http://search.twitter.com/search.json?q='.$user.'&lang=en&rpp=100';
    $jsontwitter = file_get_contents($url);
    $twitter = json_decode($jsontwitter, true);
    $twittertext = $twitter["results"];

    foreach($twittertext as $text){
        if(preg_match($regex, $text['text'])){
            echo '<a href="http://twitter.com/'.$text['from_user'].'">@'.$text['from_user'].'</a>: '.$text['text'].'<br>';

        }
    }
}       

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:15:22.933

你应该首先纠正错别字。您的 q= 变量为空，因为第 8 行的变量未在上面定义。看来您可能想在那里使用'$users'，如第 3 行所定义的那样。我将从命令行（如下所示）进行测试，并在第 2 行和第 3 行设置静态变量。在整个过程中放置​​打印语句以确定您的失败观点。

$ php test.html
警告：file_get_contents(http://search.twitter.com/search.json?q=&lang=en&rpp=100)：打开流失败：HTTP 请求失败！HTTP/1.0 403 禁止

# c# - 在 C# 中在 windows phone 8 中下载并启动默认应用程序

> ID：13905015
> 
> 赞同：0
> 
> 时间：2012-12-16T20:05:24.037
> 
> 标签：c#, live, windows-phone-8, onedrive

我正在使用**Live api**下载**SkyDrive**文件。

我的代码有一个触发**OnDownloadedCompleted 函数的下载点击事件。**

OnDownloadedCompleted 函数将文件复制到“文件名”。

并调用 DefaultLaunch()，它接受“文件名”并尝试通过 windows phone 8 中的默认程序启动它。

当我**执行**此代码时（下载的文件是 OneNote 文件）**OneNote 打开并说文件无法打开。**

谁能帮我验证这段代码？

**非常感谢！**

```
private void btnDownload_Click(object sender, RoutedEventArgs e)
    {

        if (App.Current.LiveSession == null)
        {
            infoTextBlock.Text = "You must sign in first.";
        }
        else
        {
            LiveConnectClient client = new LiveConnectClient(App.Current.LiveSession);
            client.DownloadCompleted += new EventHandler<LiveDownloadCompletedEventArgs>(OnDownloadCompleted);

            client.DownloadAsync("file_id");

        }
    } 
```

OnDownloadCompleted 的代码是

```
void OnDownloadCompleted(object sender, LiveDownloadCompletedEventArgs e)
    {
        if (e.Result != null)
        {
            var filestream = File.Create(@"filename");
            e.Result.Seek(0, SeekOrigin.Begin);
            e.Result.CopyTo(filestream);
            filestream.Close();
            DefaultLaunch();

            e.Result.Close();

        }
        else
        {
            infoTextBlock.Text = "Error downloading image: " + e.Error.ToString();
        }
    } 
```

默认启动功能的代码是

```
 async void DefaultLaunch()
    {

        try
        {
            string imageFile = @"File.one";
            var file = await Windows.ApplicationModel.Package.Current.InstalledLocation.GetFileAsync(imageFile);
            var success = await Windows.System.Launcher.LaunchFileAsync(file);
            if (success)
            {}
            else
            {}
        }
        catch (Exception e)
        {
            Console.WriteLine(e.StackTrace);
            Console.WriteLine(e.ToString());

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T20:59:19.303

试试这个教程.. [http://msdn.microsoft.com/en-us/live/ff519582.aspx](http://msdn.microsoft.com/en-us/live/ff519582.aspx) .. 那里给出了如何在 Windows 8 平台上使用 live sdk

# javascript - 如何将javascript字符串拆分为最多2部分？

> ID：13905016
> 
> 赞同：5
> 
> 时间：2012-12-16T20:05:35.090
> 
> 标签：javascript, string, coffeescript

我有这样的字符串

```
FOO hello world
BAR something else
BISCUIT is tasty
CAKE is tasty too 
```

目标是在第一个单词之后拆分字符串**一次。**到目前为止，我正在使用这个

```
# coffeescript
raw = 'FOO hello world'
parts = raw.split /\s/
[command, params] = [parts.shift(), parts.join(' ')]
command #=> FOO
params #=> hello world 
```

**我不喜欢这个有两个原因：**

1.  似乎效率低下
2.  我正在用一个`' '`字符重新加入字符串。真正的字符串参数可以由 a`' '`或 a分割`\t`，我想保持原件不变。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-16T20:09:59.017

试试这个：

```
[ command, params ] = /^([^\s]+)\s(.*)$/.exec('FOO hello world').slice(1); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-16T20:13:23.773

您可以使用`indexOf`查找空间（对于`\t`- 单独处理它并选择两个索引中较小的一个），然后`slice`在那里：

```
var command;
var params = '';
var space = raw.indexOf(" ");
if(space == -1) {
    command = e.data;
} else {
    command = raw.slice(0, space);
    params = raw.slice(space + 1);
} 
```

此外，它要快得多，因为它不使用正则表达式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-16T20:12:43.387

@NathanWall 答案的变体，没有不必要的变量：

```
 [command, params] = /([^\s]+)\s(.+)/.exec('FOO hello world').slice(1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T20:18:41.103

这里有一个简单的代码：

```
var t = "FOO hello world";
var part1 = t.match(/(\w+\s)/)[0];
var part2 = t.replace(part1,""); 
```

第 1 部分将包含“FOO”和第 2 部分“hello world”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-29T15:33:18.183

这是我的做法：

```
let raw = "FOO hello world"

raw.split(" ")
    .filter((part, index) => index !== 0)
    .join(" ") 
```

基本上，取单词，将其按空格（或其他）分割，然后过滤掉第一个单词，然后将其重新连接起来。

我发现这比上面的切片更直观。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-12-16T20:17:32.680

另一种选择是：

```
# coffeescript
raw = 'FOO hello world'
[command, params] = raw.split(/\s/, 2)
command #=> FOO
params #=> hello world 
```

我认为这看起来并不比您的原始代码更具*语义。*

# c# - C#使用WMI查询LogicalDisk信息

> ID：13905021
> 
> 赞同：0
> 
> 时间：2012-12-16T20:06:04.397
> 
> 标签：c#, wmi, performancecounter

我正在寻找使用 WMI 获取本地计算机上磁盘的性能信息。根据 Win32_PerfFormattedData_PerfDisk_LogicalDisk (http://msdn.microsoft.com/en-us/library/aa394261(v=vs.85).aspx) 的文档，看起来我应该能够查询信息并获取价值观。

但是，当我运行代码时，属性的每个值都会得到“0”。

```
var selectQuery = new SelectQuery("Select * from Win32_PerfFormattedData_PerfDisk_LogicalDisk");
var searcher = new ManagementObjectSearcher(selectQuery);

foreach (ManagementObject disk in searcher.Get())
{
    foreach (PropertyData property in disk.Properties)
    {
        var propertyValue = property.Value; // 0 value.
    }
} 
```

我还查询了 Win32_PerfRawData_PerfDisk_LogicalDisk 并且确实得到了实际的原始值。当然，我宁愿拥有格式化数据而不是原始数据。在使用 WMI 时，似乎缺少将原始数据转换为格式化数据的文档。

知道为什么每个值我都得到 0 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:17:12.423

这是一个刚刚测试过的工作示例

您可以使用 WMI[性能类计数器](http://msdn.microsoft.com/en-us/library/aa392738%28v=VS.85%29.aspx)。这方面的一个例子是轮询 PerfDisk_LogicalDisk

```
ManagementObjectSearcher mos = new ManagementObjectSearcher("select * from Win32_PerfFormattedData_PerfDisk_LogicalDisk");
foreach (ManagementObject service in mos.Get())
{
    foreach (PropertyData propData in service.Properties)
    {
        Console.WriteLine("{0} {1}", propData.Name, propData.Value);
    }
} 
```

# android - 程序化的 RelativeLayout 重叠

> ID：13905023
> 
> 赞同：0
> 
> 时间：2012-12-16T20:06:14.233
> 
> 标签：android, android-relativelayout

通过从代码实现相对布局，我遇到了问题。我想要的是，TextView1 位于左侧，TextView2 位于屏幕右侧一行。

它在 XML 中运行良好，但从代码中执行此操作却没有……可能是什么原因？

这项工作很好：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:text="@string/hello_world" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:text="TextView" />

</RelativeLayout> 
```

这不起作用（给出元素重叠）：

```
RelativeLayout rel = new RelativeLayout(this);
RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT,
        LayoutParams.WRAP_CONTENT);
rel.setLayoutParams(params);

TextView t1 = new TextView(this);   
t1.setText("balbla_1");
RelativeLayout.LayoutParams lp1 = new RelativeLayout.LayoutParams(
        RelativeLayout.LayoutParams.MATCH_PARENT,
        RelativeLayout.LayoutParams.WRAP_CONTENT);
lp1.addRule(RelativeLayout.ALIGN_PARENT_LEFT);
t1.setLayoutParams(lp1);

TextView t2 = new TextView(this);
t2.setText("balbla_2");
RelativeLayout.LayoutParams lp2 = new RelativeLayout.LayoutParams(
        RelativeLayout.LayoutParams.MATCH_PARENT,
        RelativeLayout.LayoutParams.WRAP_CONTENT);
lp2.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);
t2.setLayoutParams(lp2);        

rel.addView(t1);
rel.addView(t2);

setContentView(rel); 
```

但这可以正常工作：（替换`MATCH_PARENT`为`WRAP_CONTENT`）：

```
RelativeLayout rel = new RelativeLayout(this);
RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT,
        LayoutParams.WRAP_CONTENT);
rel.setLayoutParams(params);

TextView t1 = new TextView(this);   
t1.setText("balbla_1");
RelativeLayout.LayoutParams lp1 = new RelativeLayout.LayoutParams(
        RelativeLayout.LayoutParams.WRAP_CONTENT,
        RelativeLayout.LayoutParams.WRAP_CONTENT);
lp1.addRule(RelativeLayout.ALIGN_PARENT_LEFT);
t1.setLayoutParams(lp1);

TextView t2 = new TextView(this);
t2.setText("balbla_2");
RelativeLayout.LayoutParams lp2 = new RelativeLayout.LayoutParams(
        RelativeLayout.LayoutParams.WRAP_CONTENT,
        RelativeLayout.LayoutParams.WRAP_CONTENT);
lp2.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);
t2.setLayoutParams(lp2);        

rel.addView(t1);
rel.addView(t2);

setContentView(rel); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:08:32.713

Java 代码与 XML 不完全匹配，重叠是因为您忘记了：

```
lp2.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM); 
```

你也忽略了：

```
lp1.addRule(RelativeLayout.CENTER_VERTICAL); 
```

而且您使用`MATCH_PARENT`的是宽度而不是`WRAP_CONTENT`.

# c - 使用 bfs 的图中节点之间的距离

> ID：13905025
> 
> 赞同：1
> 
> 时间：2012-12-16T20:06:26.800
> 
> 标签：c

我编写了以下代码：

```
void bfs(graph *g, int start)
{
    int i;
    int visited[MAXVERTS], next;
    for (i = 0; i < g -> nodes; i++)
        visited[i] = 0;
    visited[start] = 1;
    printf("%d", start);
    queuePtr q;
    q = QueueCreate();
    QueueEnter(q,start);
    while(!QueueIsEmpty(q))
    {
        next=QueueDelete(q);
        node *p=g->adjList[next];
        while(p)
        {  
            if(!visited[p->index])  
                visited[p->index] = 1;  
            QueueEnter(q,p->index);  
        }  
        p=p->link;  
    }  
} 
```

我需要添加什么才能计算图中两个节点之间的距离？我一直在尝试，但我无法让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T04:38:01.000

好吧，我前段时间实现了相同的代码，但找不到它。Amyway，[Dijkstra 的](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)算法就是你所需要的。

干杯。

# java - Mercurial，等待被持有的锁

> ID：13905026
> 
> 赞同：4
> 
> 时间：2012-12-16T20:06:33.287
> 
> 标签：java, mercurial, locking

我正在使用 mercurial、maven、jenkins 设置构建服务器（java）。安装和配置 jenkins 后，我无法推送到我的存储库

```
waiting for lock on repository /home/javabuild/main-java-repository held by 'ubuntu:3949' 
```

计算机`'ubuntu'`是我在虚拟机中的测试服务器，我试图在我的主服务器上使用它之前记录所有内容（我对此完全陌生）。

当我随着时间的推移发出命令时，端口的值会发生变化。我在想这与詹金斯构建测试没有释放锁有关吗？

任何人？我怎样才能解决这个问题？

`.hg/store`编辑：这个问题之前已经被问过，但是删除or文件夹中的 wlock 或 lock 文件的答案`.hg/data`不起作用，因为在我的情况下，这些文件夹中没有这样的文件。

# .net - .Net 和其他应用程序中数据文件的序列化

> ID：13905027
> 
> 赞同：1
> 
> 时间：2012-12-16T20:06:36.527
> 
> 标签：.net, serialization, protocol-buffers, binaryfiles

我阅读了很多关于通过wire-xml、json、proto buf、合同序列化程序等使用的序列化技术的讨论。我很好奇关于哪种序列化技术最适合应用程序文件（即本地文件）的任何讨论从胖客户端应用程序保存。过去我将数据集序列化为 xml（和 gzipped），但也许这些其他格式中的一种更适合这个应用程序？我最感兴趣的是 .Net 的使用，但当然，部分讨论需要解决该文件以后如何轻松地被另一种语言或平台使用。

一些附加信息：如果数据允许，我同意 sqlite 的数据库格式。但是当我想到一个胖客户端应用程序时，我更多的是考虑一个基于文档的应用程序，即像一个 Office 类型的程序等。如果一个人可以在内部使用本机对象，然后简单地将一个完整的结构序列化到一个文件中，它将总是比尝试将对象映射到数据库表更容易使用。我是否正确假设大多数基于文档的应用程序只是在您单击“保存”时重写整个文件？

感谢您迄今为止的反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:12:21.570

我会使用 SQLite。

它将数据存储到磁盘上的单个文件中，它有一个 .net 提供程序，当然还有其他语言的提供程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:32:51.290

您提到的许多（xml、json、protobuf）对于大多数数据来说绝对没问题，并且大多数语言/平台都能够处理它们。如果数据很复杂，关系数据库文件可能更可取，但是：没有自动的理由偏爱一种方法而不是另一种方法。这在很大程度上取决于您的特定数据以及您如何使用它。

# sql - 用于查找文件路径的 SQLite 查询

> ID：13905031
> 
> 赞同：0
> 
> 时间：2012-12-16T20:07:10.813
> 
> 标签：sql, sqlite

我的 SQLite 数据库中有一个包含文件路径的列。给定文件路径的一部分，我需要返回所有下一个文件夹。我还想返回下一部分是否是字符串中的最后一个路径（或不以'/'结尾）。所以如果我有文件夹：

```
/my/folder/one
/my/folder/two
/my/folder/path/three
/another/path
/one/two/three 
```

我有路径：

```
/my/folder/ 
```

结果将返回以下内容：

```
+----------+------+
| isLast   | item |
+----------+------+
|    1     | one  |
|    1     | two  |
|    0     | path |
+----------+------+ 
```

我已经为此苦苦挣扎了一段时间，所以如果有人能提供任何指导，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T10:00:49.853

这个查询：

```
SELECT item NOT GLOB '*/*' AS isLast,
       item
FROM (SELECT substr(MyPath, length('/my/folder/') + 1) AS item
      FROM MyTable
      WHERE MyPath GLOB '/my/folder/' || '*') 
```

会给你这样的结果：

```
isLast  item
------  ----
1       one
1       two
0       path/three 
```

删除子路径需要[`instr()`函数](http://www.sqlite.org/lang_corefunc.html#instr)，最近才在 SQLite 3.7.15 中引入：

```
SELECT isLast,
       CASE WHEN isLast
         THEN item
         ELSE substr(item, 1, instr(item, '/') - 1)
       END AS item
FROM (SELECT item NOT GLOB '*/*' AS isLast,
             item
      FROM (SELECT substr(MyPath, length('/my/folder/') + 1) AS item
            FROM MyTable
            WHERE MyPath GLOB '/my/folder/' || '*')) 
```

# c - 总结一个中心点周围的所有点？

> ID：13905033
> 
> 赞同：0
> 
> 时间：2012-12-16T20:07:33.740
> 
> 标签：c, image, pgm

为了平滑图像，我需要总结给定中心像素周围的所有像素，然后建立平均值，这基本上就是我的新像素。现在有两个问题：

1）总结它们的好方法是什么？和

2）我怎样才能最好地避免角落像素？

这是我到目前为止所做的，但我认为这没有什么好处。

```
for(i = 0; i < image1->nx; i++)
{
    for(j = 0; j < image1->ny; j++)
    {
        if(i == 0 || j == 0 || i == image1->nx - 1 || j == image1->ny - 1)
        {                                                                  
            image2->image[i][j] = image1->image[i][j];
        }
        else
        {
            int average = 0;
            average += image1->image[i][j];
            average += image1->image[i+1][j];
            average += image1->image[i][j+1];
            average += image1->image[i+1][j+1];
            average += image1->image[i-1][j];
            average += image1->image[i-1][j+1];
            average += image1->image[i-1][j-1];
            average += image1->image[i][j-1];
            average += image1->image[i+1][j-1];
            average /= 9;
            image2->image[i][j] = average;
        }
    }
} 
```

我在 C 中的结构是这样的：

```
struct pgm_image
{
    int nx;             // row number
    int ny;             // cell number
    unsigned char image[N1][N2]; // image information
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:25:20.147

这看起来是对的。为了缩短一点，我想你可以使用 for 循环。

```
int min = -1;
int max = 1;
int average = 0;
int amount = 0;
for(int k = min; k <= max; k++){
    for(int l = min; l <= max; l++){
        amount++;
        average += image1->image[i+k][j+l];
    }
}
average /= amount;
image2->image[i][j] = average; 
```

它看起来仍然很乱，但是这样你可以通过改变最小和最大变量来改变平滑的“半径”。

# php - 使用 php 在本地保存 url 的内容，包括图像

> ID：13905034
> 
> 赞同：0
> 
> 时间：2012-12-16T20:07:36.897
> 
> 标签：php, linux, curl

我需要一些方法来使用 php 或 linux 命令行复制和保存网站以供“离线使用”。就像用浏览器保存链接一样，它会重写图像标签并下载它们。

问题是当我找到解决问题的方法时，我通常会将链接保存在某处。随之而来的问题是有时链接会死掉，所以我不能再访问它们了。

所以我在想的是创建一个工具，在我的服务器上为我保存页面并使用该 url。

我知道如何使用 file_get_contents 来获取文本/html，并且大多数情况下都有效，但我想，因为我正在创建一个工具，所以它也可以下载图像。我想用浏览器保存它并上传它，但我想要一种更干净的方法来做到这一点。

如果有人知道一些图书馆或类似的东西，请帮助我。

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:23:02.143

您可能想查看[wget](http://www.gnu.org/software/wget/manual/wget.html)是否在您的 Web 服务器上可用，因为它有一些非常有用的选项。其中之一是可以选择使用链接翻译制作网站的离线副本，以便网站可以在本地使用。

```
wget --domains example.com --recursive --html-extension --page-requisites --convert-links 
```

如果您尝试创建子文件夹的脱机副本（比如说`example.com/test/`），请添加`--no-parent`以防止 wget 报废父文件夹。

您可以通过 bash 脚本自行运行报废过程，也可以通过 PHP 使用[exec()](http://php.net/manual/en/function.exec.php)调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T20:12:08.273

您应该查看可能是您正在寻找的[cURL库。](http://php.net/manual/en/book.curl.php)

文档中还指定了一个[基本示例。](http://php.net/manual/en/curl.examples-basic.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T20:31:31.600

你可以考虑使用这个：[http ://www.httrack.com/](http://www.httrack.com/)

# ruby-on-rails - 酒店预订引擎与 Ruby on Rails 应用程序的集成

> ID：13905037
> 
> 赞同：1
> 
> 时间：2012-12-16T20:08:12.280
> 
> 标签：ruby-on-rails

我正在为一家酒店构建一个 Ruby on Rails 网站，并试图找出解决预订引擎集成问题的最佳方法。

有没有人在 3rd 方预订引擎方面有过良好的体验，该引擎可以与 Ruby On Rails 应用程序（酒店位于爱尔兰，如果这有任何相关性的话）集成得比较好？

或者是否有任何宝石可以为预订引擎奠定基础（我所看到的只是似乎不再维护的事件/日历宝石）？

还是我应该考虑完全从头开始构建？

非常感谢您的任何建议！

# entity-framework - 实体框架代码中的匿名类型“无效”异常首先 OnModelCreating

> ID：13905039
> 
> 赞同：0
> 
> 时间：2012-12-16T20:08:16.253
> 
> 标签：entity-framework, ef-code-first, anonymous-types

我在强类型 DbContext 的 OnModelCreating() 方法中指定了我自己的数据库表名和模式，如下所示：

```
modelBuilder.Entity<MyAssociativeClass>().ToTable("MYASSOCIATIVECLASS", schemaName: "MYSCHEMA");
        modelBuilder.Entity<MyAssociativeClass>()
            .HasKey(x => new { x.ClassA.ID, ClassBID = x.ClassB.ID }); 
```

但是，我收到以下错误：

> 属性表达式 'x => new <>f__AnonymousType1`2(ID = x.MyClassA.ID, MyClassBID = x.MyClassB.ID)' 无效。该表达式应表示一个属性：C#: 't => t.MyProperty' VB.Net: 'Function(t) t.MyProperty'。指定多个属性时使用匿名类型：C#: 't => new { t.MyProperty1, t.MyProperty2 }' VB.Net: 'Function(t) New From { t.MyProperty1, t.MyProperty2 }'。

如您所见，MyClassA 和 MyClassB 都有一个 ID 属性。我在匿名类型中为 MyClassB.ID 指定了一个不同的名称，因此两次使用相同的属性名称不会发生冲突。但这仍然会导致问题。为什么不允许这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:19:54.643

我认为您的班级 MyAssociativeClass 将不得不将外键公开为属性，这样您就可以这样做：

```
modelBuilder.Entity<MyAssociativeClass>().ToTable("MYASSOCIATIVECLASS", schemaName: "MYSCHEMA");
        modelBuilder.Entity<MyAssociativeClass>()
            .HasKey(x => new { x.ClassA_Id, ClassB_Id}); 
```

# javascript - 将对象编组到 cookie 中并保留功能

> ID：13905040
> 
> 赞同：0
> 
> 时间：2012-12-16T20:08:31.107
> 
> 标签：javascript, jquery, session, cookies, marshalling

我有当前序列化（成字符串）并存储在浏览器 cookie 中的会话 DOM 数据。然后在页面加载时反序列化（字符串到 DOM）。

问题是 DOM 创建的过程明显很慢。

我想知道并希望它可以“编组”整个 DOM，保持对话框、微调器、按钮等的功能。那些属于jquery ui的。

这是一个简化的示例：
给定一个输入标签： `<input id="spinner"/>`

通过初始化微调器，`$('#spinner).spinner()`

这样做，将我的低级输入标签包装成这样：

```
<span class="ui-spinner ui-widget ui-widget-content ui-corner-all">
   <input id="spinner" class="ui-spinner-input" aria-valuemin="1" autocomplete="off" role="spinbutton" aria-valuenow="14">
   <a class="ui-spinner-button ui-spinner-up ui-corner-tr ui-button ui-widget ui-state-default ui-button-text-only" tabindex="-1" role="button" aria-disabled="false"> 
```

其次，它将微调器函数/事件绑定到新的微调器对象，例如 click 和 onchange。

我能够将整个 DOM 存储为字符串。但问题是恢复微调器功能。我需要再次初始化 spinner.spinner()。我不能简单地将它用作微调器。但是那个init在第一个spinner标签周围包裹了另一堆spinner标签。

解决方法是：

我想要微调器函数绑定，但不想要额外的包装标签。

任何规避它的方法，无论是对话框、微调器、按钮等等。

# java - 从 bash 命令行和 OS X 的脚本中获取运行 SWT 应用程序的不同类路径行为

> ID：13905042
> 
> 赞同：3
> 
> 时间：2012-12-16T20:08:32.693
> 
> 标签：java, eclipse, jar, swt

我对 SWT 有点陌生，对 Java 和 Eclipse 很生疏。我一直在写一个简单的应用程序来恢复心态（它实际上是我孙女的算术事实测验程序）。我在 cocoa/osx/x86_64 平台上使用 SWT。最终目标是将应用程序打包到 OS X .app 包中。

这是我跌倒并且无法起床的地方：从 Eclipse IDE 内部执行时它可以正常工作，并且在使用 java 命令行从交互式 bash shell 独立执行时*也*可以正常工作，但是从运行时抛出 NoClassDefFoundError 异常在 shell 脚本中。有问题的脚本尽可能简单：

```
#!/bin/sh
exec java \
       -d64 \ 
       -XstartOnFirstThread \
       -jar MathDrill.jar 
```

堆栈跟踪是：

```
Exception in thread "main" java.lang.NoClassDefFoundError:  
Caused by: java.lang.ClassNotFoundException:  
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247) 
```

我已经把所有东西都塞进了一个 jar 文件中，这个 jar 包含 swt.jar（它又包含平台的 *.jnilib 文件）和一堆绑定框架 jar（哇，这很痛苦——但是我离题了）。我试过了：

a) 通过使用 Eclipse “export to runnable jar”文件创建清单。

b）通过“export to jar”创建清单（无论如何都会在清单中添加“Rsrc-Main-Class”行，所以我不确定真正的区别是什么）。

c) 通过将随附的 jar 解压缩到 aa 库目录并修改 shell 脚本以添加 -classpath .:./libdir 来创建可运行的 jar

有问题的清单是，从生成的 jar 中提取 META-INF 后：

```
Manifest-Version: 1.0
Rsrc-Class-Path: ./ swing2swt.jar org.eclipse.core.databinding_1.4.1.v  
 20120521-2329.jar org.eclipse.core.databinding.beans_1.2.200.v2012052
 3-1955.jar org.eclipse.core.databinding.observable_1.4.1.v20120521-23
 29.jar org.eclipse.core.databinding.property_1.4.100.v20120523-1955.j
 ar org.eclipse.jface.databinding_1.6.0.v20120521-2329.jar org.eclipse
 .equinox.common_3.6.100.v20120522-1841.jar com.ibm.icu_4.4.2.v2011082
 3.jar swt.jar
Ant-Version: Apache Ant 1.8.3
Class-Path: .
Created-By: 1.6.0_37-b06-434-10M3909 (Apple Inc.)
Rsrc-Main-Class: com.rutabaga.mathdrill.MathDrill
Main-Class: org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader 
```

一些问题：

1) 清单在“jar xf MathDrill.jar META-INF”命令之后显示为怪异的 80 列自动换行加上空格。这是正常的吗？在构建它的 ant 标签中肯定不是这样的。

2）清单中的Class-Path和Rsrc-Class-Path有什么区别？

3）当我在 Eclipse 中导出到 jar（而不是可运行的 jar）时，它会生成一个“jar-in-jar-loader.zip”文件。这是什么？我应该如何使用它？

4) 有没有办法直接从 OS X 包执行 java 而无需某种脚本来启动它？我已经尝试按照我在[http://www.eclipse.org/swt/macosx/](http://www.eclipse.org/swt/macosx/)找到的说明进行操作，并且我还尝试在这两种情况下都使用 Platypus——相同的类加载器异常。

5) 从 shell 脚本执行 java 时，环境是否发生了一些奇怪的事情？

任何帮助将不胜感激。我确定我做了一些愚蠢的事情，但我现在有点死在水里了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T22:54:27.937

您需要确保 shell 脚本将其工作目录更改为包含该`.jar`文件的目录。如果 shell 脚本和`.jar`文件在同一个目录中，你可能只需要在`exec java`:

```
cd "$(dirname "$0")" 
```

否则，您可能需要使用以下`.jar`命令在 shell 脚本中明确指定文件的路径：

```
exec java \
   -d64 \ 
   -XstartOnFirstThread \
   -jar "$(dirname "$0")/MathDrill.jar" 
```

# javascript - 如何使用 javascript/jquery 自动按 ENTER 键/确认警报框

> ID：13905043
> 
> 赞同：2
> 
> 时间：2012-12-16T20:08:34.923
> 
> 标签：javascript, jquery, userscripts

我正在编写一个用户脚本（javascript/jquery）来自动化浏览器游戏中的一些事情。有一个拍卖可以以折扣价购买产品。我想要一个在有 33% 折扣时自动购买商品的脚本。

该脚本在拍卖的 url (greasemonkey) 上运行，然后检查是否有至少 33% 折扣的产品 - 如果是这种情况，那么它将按下该行中的按钮来购买产品。

我现在面临的问题是：按下按钮后，您必须通过警告框确认您要购买商品。有没有办法自动化这个？

我用谷歌搜索并检查了stackoverflow，人们说javascript/jquery不可能。真的是这样吗？这意味着在我正在玩的浏览器游戏中自动购买商品基本上是不可能的。我正在考虑让脚本自动按 ENTER，因为这与在警报框中单击“确定”相同。但他们说那也是不可能的。所以现在我想知道：有没有办法自动化这个？

这是按钮背后的代码：

```
<input id="buybutton_3204781" class="button" type="button" onclick="if(confirm('Wil je deze producten kopen?')){document.submitForm.BuyAuctionNr.value=3204781; document.submitForm.submit();}{return false;}" value="Kopen"> 
```

编辑：

万岁，它通过更改按钮的属性 onClick 来工作！这是使用的代码：

$('元素').attr('一些属性','一些属性值');

现在可以关闭了，非常感谢各位，感谢您的帮助！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T20:33:38.040

根据浏览器的不同，可能会覆盖`window.confirm`，例如

```
(function() {
   'use strict';

    // Might was well save this in case you need it later
    var oldConfirm = window.confirm;
    window.confirm = function (e) {
        // TODO: could put additional logic in here if necessary
        return true;
    };

} ()); 
```

我没有做任何广泛的测试，但至少我能够覆盖`window.alert`并在萤火虫中。`window.confirm`

请注意，如果他们的脚本已经获得对警报/确认的引用（例如`var a = window.confirm; a('herp');`） ，这对您没有帮助

另一种方法是覆盖您自动单击的按钮的功能，或使用某些 xhr 手动发出 AJAX / POST。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T20:21:38.320

不用改变太多你可以试试这个

```
$(".button").each(function() {
  if (this.id.indexOf("buybutton")!=-1) this.onclick=function() {
    document.submitForm.BuyAuctionNr.value=this.id.replace("buybutton_","");
    document.submitForm.BuyAuctionNr.submit();
  } 
}); 
```

我使用`this`and`onclick`因为我想替换现有的 onclick 处理程序，而不是添加一个

如果您只想购买，请获取 ID 并使用您的用户脚本提交表单

因为我不知道你是怎么知道折扣的，所以可以举个例子

```
$(".button").each(function() {
  if (this.id.indexOf("buybutton")!=-1) {
    var ID = this.id.replace("buybutton_","");
    if ($("#discount_"+ID).val()<30) {
      document.submitForm.BuyAuctionNr.value=ID;
      document.submitForm.BuyAuctionNr.submit();
    }
  } 
}); 
```

它将提交它找到的第一个。将 submit 替换为 $.get 或 post 以提交所有打折的东西

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T20:58:53.530

使用 JavaScript，您可以以任何您喜欢的方式更改 HTML 和 JavaScript 代码。

我建议更改 OnClick 功能，以便

```
<input id="buybutton_3204781" class="button" type="button" 
onclick="
if(confirm('Wil je deze producten kopen?'))
{
    document.submitForm.BuyAuctionNr.value=3204781; 
    document.submitForm.submit();
}
{
    return false;
}" value="Kopen"> 
```

简单地变成

```
<input id="buybutton_3204781" class="button" type="button" 
    onclick=
    "document.submitForm.BuyAuctionNr.value=3204781; 
     document.submitForm.submit();" 
value="Kopen"> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-16T20:11:21.550

您必须用 jquery modal 替换原始系统警报才能实现这样的要求。

下面是介绍jquery modal的教程：

[http://www.jacklmoore.com/notes/jquery-modal-tutorial](http://www.jacklmoore.com/notes/jquery-modal-tutorial)

# android - 带有 Android Annotation REST 服务的 POST 请求

> ID：13905047
> 
> 赞同：4
> 
> 时间：2012-12-16T20:09:30.040
> 
> 标签：android, spring, rest, android-annotations

我在我的项目中使用[Android Annotation](http://androidannotations.org/)并尝试`POST`通过以下代码发送请求，但是以下代码有问题，因为我没有得到预期的响应：

```
@Rest(rootUrl = "http://xyz.com", converters = {GsonHttpMessageConverter.class})
public interface A {

    @Post("/authenticate/email/")
    public Object attemptLogin(Map data);
} 
```

`data`对在哪里`(key, value)`。有什么我遗漏的可能我必须设置`request-header`还是`data`不应该是 JSON？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-24T13:48:54.397

我[使用 Android-Annotations 从 Rest 客户端](http://www.sapandiwakar.in/technical/rest-client-using-android-annotations/)找到了解决方案。

> 与 GET 请求一样，使用 Android-Annotations 发送 POST 请求非常简单。一个区别是您需要将要发送的参数定义为自定义类（例如下面示例中的 Event 类），或者如果您想动态控制它，则需要定义一个 Map（例如 MultiValueMap）。请求的 url 仍然可以使用包含在 {...} 中的变量以类似的方式构造，并且可以像在 GET 请求中一样处理响应。

```
@Post("/events")
void addEvent(Event event);

@Post("/events/{id}")
void addEventById(Event event, long id);

@Post("/authenticate/event/")
Object authenticateEventData(MultiValueMap data); 
```

# java - HTTP 状态 500 - 空

> ID：13905048
> 
> 赞同：0
> 
> 时间：2012-12-16T20:09:38.113
> 
> 标签：java, jakarta-ee, servlets, jdbc, tomcat7

我写了一个 java servlet 程序，但是当我运行它时，它显示错误 HTTP 状态 500 - null 这是什么意思；我的源代码在[**这个页面上**](https://stackoverflow.com/questions/13904103/java-lang-classnotfoundexception-oracle-jdbc-driver-oracledriver#comment19161338_13904103)。

错误是

```
HTTP Status 500 - null
type Exception report
message null
description The server encountered an internal error that prevented it from fulfilling this request.
exception
 java.lang.NumberFormatException: null
java.lang.Integer.parseInt(Unknown Source)
java.lang.Integer.parseInt(Unknown Source)
skypark.Registration.doPost(Registration.java:56)
javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
javax.servlet.http.HttpServlet.service(HttpServlet.java:728) 
```

请帮我解决这个问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T20:15:14.663

可能

```
int phone=Integer.parseInt(phone1); 
```

`phone1``null`通过_

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T06:38:48.007

从错误中，我可以说除了`number`传递给您的函数之外还有其他内容，并且引发了此异常。

像这样的东西：

```
int a = Integer.ParseInt(aStr); 
```

`aStr`在哪里`abc`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-17T06:11:02.650

嘿正确你的html没有输入类型=数字正确如下

```
Phone Number
</td><td>
<input type="text" name="phone">
</td></tr><tr><td> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T09:31:56.073

您应该在输入标签中有属性名称。

```
<input type="text" name="xyz"> 
```

in d`servlet`解析后访问该值，如下。

```
int x=Integer.parseInt(request.getParameter("xyz")); 
```

# java - MVC上一个Jframe中带有按钮的多个Jpanel，如何在我的控制器中获取actionlistener？

> ID：13905051
> 
> 赞同：1
> 
> 时间：2012-12-16T20:09:53.073
> 
> 标签：java, swing, model-view-controller, uiviewcontroller, actionlistener

这是作业顺便说一句，

我被要求制作一个包含多个 jpanel 的 jframe，这些 jpanels 上附加了按钮和动作侦听器。我必须使用 MVC 模型来做到这一点，但是，由于我的按钮/动作在 jpanels 而不是 jframe 中，我不知道如何恢复它们。我不会放下我所有的代码，但只是看看我尝试做什么所需要的。我想首先从面板 3 中获取“ajouter”按钮来执行任何操作：

这是面板 3

```
import java.awt.FlowLayout;
import javax.swing.JButton;
import javax.swing.JPanel;

import ca.uqam.inf2120.tp2.modele.GestionAbsenceEmployes;

public class RechercherAbsenceP3 extends JPanel {

    private GestionAbsenceEmployes aControleur;
    private JButton ajouter, modifier, supprimer, afficher, fermer;
    FlowLayout gestionnaireComposant;

    RechercherAbsenceP3() {
    try {
        jbInitP3();
    } catch (Exception e) {
        e.printStackTrace();
    }
        ajouter.addActionListener(aControleur);
        modifier.addActionListener(aControleur);
        supprimer.addActionListener(aControleur);
        afficher.addActionListener(aControleur);
        fermer.addActionListener(aControleur);
    }

    private void jbInitP3() throws Exception {

    gestionnaireComposant = new FlowLayout(FlowLayout.RIGHT);

    this.setLayout(gestionnaireComposant);

    ajouter = new JButton("Ajouter");
    modifier = new JButton("Modifier");
    modifier.setEnabled(false);
    supprimer = new JButton("Supprimer");
    supprimer.setEnabled(false);
    afficher = new JButton("Afficher");
    afficher.setEnabled(false);
    fermer = new JButton("Fermer");

    this.add(ajouter);
    this.add(modifier);
    this.add(supprimer);
    this.add(afficher);
    this.add(fermer);

    }

    public JButton getAjouter() {
        return ajouter;
    }
} 
```

这是窗户

```
package ca.uqam.inf2120.tp2.interfacegraphique;

import java.awt.BorderLayout;
import ca.uqam.inf2120.tp2.interfacegraphique.RechercherAbsenceP3;
import javax.swing.JFrame;
import javax.swing.JPanel;

import ca.uqam.inf2120.tp2.modele.GestionAbsenceEmployes;

public class CreerRechercherAbsence extends JFrame {

    private GestionAbsenceEmployes aControleur;
    private JPanel absenceP1, absenceP2, absenceP3;

    private BorderLayout gestionnaireComposant;

    public CreerRechercherAbsence() {
        super("Gestionnaire des employés absents");

        try {
            jbInit();
        } catch (Exception ex) {
            ex.printStackTrace();
        }

        aControleur = new GestionAbsenceEmployes(this); 

    }

    void jbInit() throws Exception {

        gestionnaireComposant = new BorderLayout(5, 5);
        this.getContentPane().setLayout(gestionnaireComposant);

        absenceP1 = new RechercherAbsenceP1();
        absenceP2 = new RechercherAbsenceP2();
        absenceP3 = new RechercherAbsenceP3();

        this.getContentPane().add(absenceP1, BorderLayout.NORTH);
        this.getContentPane().add(absenceP2, BorderLayout.CENTER);
        this.getContentPane().add(absenceP3, BorderLayout.SOUTH);
    }

} 
```

现在未完成的控制器：

```
 package ca.uqam.inf2120.tp2.modele;

    import java.awt.event.ActionEvent;
    import java.awt.event.ActionListener;

    import ca.uqam.inf2120.tp1.partie1.adt.impl.ListeAdtArrayListImpl;
    import ca.uqam.inf2120.tp2.interfacegraphique.CreerRechercherAbsence;

    public class GestionAbsenceEmployes implements ActionListener{

        private AbsenceEmploye modele;
        private CreerRechercherAbsence vue;

        public GestionAbsenceEmployes(CreerRechercherAbsence uneVue) {
            this.modele = new AbsenceEmploye();
            vue = uneVue;
        }

        public AbsenceEmploye getModele() {
            return modele;
        }

        @Override
        public void actionPerformed(ActionEvent event) {
            Object source = event.getSource();
            if(source == vue.getAjouter()) {

            }
        }

} 
```

当我添加 vue.getAjouter() 它不知道它是什么！

我该怎么做/错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T20:53:53.287

问题是您正在调用`getAjouter()`实例`CreerRechercherAbsence` `JFrame`，`ActionListener`因为您希望调用`getAjouter()`实例`RechercherAbsenceP3` `JPanel`。

**我的解决方案：**

将您的`ActionListener`类转换`GestionAbsenceEmployes`为接受`RechercherAbsenceP3`作为参数，以便我们可以`getAjouter()`像这样调用它的实例：

```
class GestionAbsenceEmployes implements ActionListener {

    private AbsenceEmploye modele;
    private RechercherAbsenceP3 vue;

    public GestionAbsenceEmployes(RechercherAbsenceP3 uneVue) {
        this.modele = new AbsenceEmploye();
        vue = uneVue;
    }

    public AbsenceEmploye getModele() {
        return modele;
   }

    @Override
    public void actionPerformed(ActionEvent event) {
        Object source = event.getSource();
        if (source == vue.getAjouter()) {
        }
    }
} 
```

你会这样做：

```
 aControleur = new GestionAbsenceEmployes(absenceP3); 
```

但为了使上述语句起作用，您必须更改此：

```
private JPanel absenceP1, absenceP2,absenceP3; 
```

在`CreerRechercherAbsence`课堂上：

```
private JPanel absenceP1, absenceP2;
private RechercherAbsenceP3 absenceP3; 
```

因为您扩展`JPanel`以添加功能，`RechercherAbsenceP3`但是通过在`JPanel`向下转换时声明它，因此它无法访问扩展的方法，`JPanel` `RechercherAbsenceP3`只能访问默认的方法`JPanel`。

其他一些建议：

*   不要`JFrame`不必要地扩展课程

*   不需要`getContentPane.add(..)`因为 `add(..)`已经转移到*contentPane*

*   一定要在上面创建和操作 Swing 组件[`Event Dispatch Thread`](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T20:56:42.933

这是我将如何做到的。制作`GestionAbsenceEmployes`一个非静态内部类`CreerRechercherAbsence`

```
public class CreerRechercherAbsence extends JFrame {

    private GestionAbsenceEmployes aControleur;
    private JPanel absenceP1, absenceP2;
    private RechercherAbsenceP3 absenceP3;

    // code omitted
    public CreerRechercherAbsence() {
        super("Gestionnaire des employés absents");

        try {
            jbInit();
        } catch (Exception ex) {
            ex.printStackTrace();
        }

        aControleur = new GestionAbsenceEmployes(); 
    }

    // code omitted
    class GestionAbsenceEmployes implements ActionListener{

        private AbsenceEmploye modele;

        public GestionAbsenceEmployes() {
            this.modele = new AbsenceEmploye();
        }

        public AbsenceEmploye getModele() {
            return modele;
        }

        @Override
        public void actionPerformed(ActionEvent event) {
            Object source = event.getSource();
            if(source == absenceP3.getAjouter()) {

            }
        }
    } 
```

无需传递`this`给构造函数，控制器也不需要引用`vue`. 通过将其设为内部类，您可以免费获得所有这些。您的控制器可以访问视图的所有成员变量。因此，您现在可以使用该`getAjouter()`方法访问 absenseP3 面板。

有关何时使用内部类有意义的更多信息，请参阅[http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html 。](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-16T23:26:46.490

不确定以下方法是否会被视为 MVC，或者它是否会在您的作业中取得好成绩。

我对您当前方法的“问题”是可重用性仅限于模型，并且看起来很难为此代码编写一个体面的测试用例，除非您准备编写包含整个视图的测试。

当我需要编写一个 Swing 应用程序时，我似乎只得到了 2 个类：一个定义数据的模型类和对该数据可用的操作，以及视图类。视图类既可以作为视图，也可以作为控制器。当我在您的示例中有一个按钮时，我会附加一个`ActionListener`（或使用一个`Action`），它只是从视图中检索必要的信息而没有任何逻辑。它将所有信息直接传递到所有逻辑所在的模型端。

我在这种方法中看到的两个主要好处：

*   我可以毫无问题地重新设计我的视图。如果我决定删除 a`JButton`并向用户提供相同操作的另一种机制，那么我的所有更改都仅限于视图。除了在我的视图类中，我不依赖 UI 元素。我直接在我的视图类中看到所有“信息收集并将其传递给模型”，并且由于该视图的实现，这不会影响其他类。将其与您在`source == vue.getAjouter()`视图之外的类中进行检查的代码进行比较。
*   我可以在不需要我的实际视图的情况下测试模型及其所有逻辑。所以我可以在单元测试中跳过整个“启动 Swing UI”，仍然测试我的所有逻辑。如果我想测试 UI（例如，当某个字段留空时测试某个按钮是否被禁用）我可以在集成测试中单独进行测试（因为 UI 往往会减慢您的测试速度）。

我在这方面发现了一篇非常有趣的文章是[The Humble dialog box](http://home.arcor.de/fbdiplom/lit_pdf/fea02_thehumbledialogbox.pdf)

# python - 两次调用覆盖的超级方法以确保有效的状态/结果？

> ID：13905054
> 
> 赞同：0
> 
> 时间：2012-12-16T20:10:42.727
> 
> 标签：python, oop

我有 2 个类，一个`Child`类继承自一个`Parent`类`Parent`该类有一个调用的方法，该方法`getIt`使用一个属性`param`来计算一些值并返回它。值可以是`None`。当`Child`类继承`Parent`它时，它会覆盖`getIt`这样，如果`getIt`' 的返回值是`None`，它会更改`param`为某个值，该值肯定会返回除 之外的值`None`。所以目标是永远不要让`Child`类调用的实例`getIt`返回`None`。这是我的做法

```
class Parent(object):
    def __init__(self, some_params):
        self.param = some_value
    def getIt(self):
        val = # use self.param to do some logic   
        if val == []:
            raise RuntimeError("message")   

class Child(Parent):
    def __init__(self, some_params):
        super(Child, self).__init__(some_params)
    def getIt(self):
        try:
            val = super(Child, self).getIt()
        except RuntimeError:
            self.param = some_other_value     # setting self.param to some_other_value will surely make getIt return a non empty list`
            val = super(Child, self).getIt()
        return val 
```

有没有更好的方法来做到这一点？

# vim - 如何映射组合键以在 Vim 中执行命令？

> ID：13905055
> 
> 赞同：1
> 
> 时间：2012-12-16T20:10:51.697
> 
> 标签：vim

我想要组合键`<C-X>`来运行命令`:! python application.py`。根据我对映射的所有理解，我尝试了以下方法：*几乎*`:map <C-X> :! python application.py`可以工作。它只是打开命令行并输入命令，但我仍然必须按回车键才能启动命令。

 *有什么办法可以让它**运行**命令吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T20:10:51.697

在发布问题之前进行最后一次搜索时，我在不相关的帖子中找到了答案。似乎放在`<CR>`命令后面执行它，使它做我想要的：

```
:map <C-X> :! python application.py<CR> 
```

根据评论（感谢[melpomene](https://stackoverflow.com/users/1848654/melpomene)）`<CR>`意味着“回车”，这实际上意味着“按 Enter”，这正是我在这种情况下所需要的。

* * *

稍微相关的是，我还发现`:!!`重复执行的最后一个 shell 命令，使我的地图有些多余。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T01:53:28.033

不要忘记您可以使用`Ctrl``V`（在插入模式下）转义任何键序列。因此，另一种获取“返回”键码的方法是`Ctrl``V``Enter`. 它看起来像`^M`。*

# ios - 更改 Audio Core 中回调之间的调用时间

> ID：13905062
> 
> 赞同：0
> 
> 时间：2012-12-16T20:11:23.640
> 
> 标签：ios, audio, time, callback, core-audio

我使用 ExtAudioFile 为定时音乐应用程序创建了自定义回调，用于实时混合声音。

```
OSStatus MyAURenderCallack (
   void                        *inRefCon,
   AudioUnitRenderActionFlags  *ioActionFlags,
   const AudioTimeStamp        *inTimeStamp,
   UInt32                      inBusNumber,
   UInt32                      inNumberFrames,
   AudioBufferList             *ioData
); 
```

我需要更改调用每个回调的时间。

我正在检查每个新回调调用了多少滴答声......

```
soundStructPointerArray[inBusNumber].callTime=mach_absolute_time()-soundStructPointerArray[inBusNumber].last;
soundStructPointerArray[inBusNumber].last=mach_absolute_time(); 
```

在模拟器中我得到 aprox ... 11595773

我需要更改这个时间以更快。有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:04:09.303

您可以使用音频会话属性 kAudioSessionProperty_PreferredHardwareIOBufferDuration 来请求更频繁的音频单元缓冲区回调。

# java - Java 编译时接口更改

> ID：13905066
> 
> 赞同：3
> 
> 时间：2012-12-16T20:12:00.253
> 
> 标签：java, android

我是 Java 新手，并且继承了现有的 android 应用程序。最初的开发者选择使用常量接口。

我的问题是我需要更改其中一些常量来编译用于生产与开发的应用程序。如果我手动修改一些值，一切都会正常工作，但这只是处理这个问题的一种丑陋方式，我可能有一天会犯错误。

因此，我的目标是找到一种对其余代码透明的解决方案，并使用单个常量在开发和生产之间来回切换。

现有代码示例：

```
package package.common;
public interface Consts {

    // Define the Build Type
    boolean PRODUCTION_BUILD = false;

    String BASE_URL   = "https://domain.com/Dev/Mobile.ashx";

    interface RSA {
        String PUBLIC_KEY_SHA1 = "....";
    }

} 
```

并像这样使用

```
import package.common.Consts;

public class HttpsConn extends NetConnection {

    String url = Consts.BASE_URL;

} 
```

有没有办法在编译时使用 CONSTANT 来修改这个接口？还是我将不得不硬着头皮修改使用此接口作为解决方案一部分的代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T20:15:15.520

不，但你可以写这个`Consts`

```
boolean PRODUCTION_BUILD = false;
String BASE_URL = PRODUCTION_BUILD ? "..." : "..."; 
```

# jquery - jQuery FancyBox 初始化不起作用

> ID：13905073
> 
> 赞同：0
> 
> 时间：2012-12-16T20:12:48.733
> 
> 标签：jquery, fancybox

所以我有一个看起来像这样的照片库：

```
<div id="gallery">
  <a href="thumb1.jpg" class="fancybox">
    <img class="item"  src="thumb1.jpg">
  </a>
  ...
</div> 
```

我像这样在我的图像链接上初始化fancybox...

```
jQuery(document).ready(function() {
    jQuery('.fancybox').fancybox();
}); 
```

...但什么也没有发生-单击我画廊中的图像只是链接到href'd图像。

我从 Chrome 控制台中没有收到任何错误，并且`jQuery('.fancybox')`正确选择了我的所有`<a>`元素。

任何想法为什么fancybox似乎不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-16T23:28:13.583

您的清单（按此顺序加载文件）：

1.  首先加载 jQuery js 文件。确保您有此文件的单个实例，最好是最新版本（其他一些插件包括安装插件时加载的 jQuery 版本）

2.  加载您的 fancybox 的 js 和 css 文件。检查（完整）路径是否正确（如果您浏览源代码并单击这些文件的链接，您应该会看到源脚本，否则会看到错误 404 页面的 html）。

3.  加载您的自定义 fancybox 脚本。还要检查您的所有`<script>`标签是否都在标签`<head>`或`<body>`标签内（我已经看到了一些脚本介于两者之间的代码）

4.  最后，检查您的文档是否有正确的`DOCTYPE`. 还要检查语法错误和未正确关闭的标签。

请参阅与上面代码中具有相同初始化的**[完整示例。](http://jsfiddle.net/3JWL6/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-17T02:44:56.750

确保您使用的是最新版本的 FancyBox 和 jQuery。

# java - Spring Data MongoDB 索引（唯一=真）

> ID：13905076
> 
> 赞同：8
> 
> 时间：2012-12-16T20:12:56.313
> 
> 标签：java, mongodb, annotations, spring-data

当涉及到索引字段时， `Spring Data`我遇到了很多问题。`MongoDB`

我已经查看了文档，但他们不太擅长解释和之间的`@Indexed(unique=true)`区别`@Indexed(unique=false)`。

我有一个我想要索引的字段，所以我可以对它执行快速查询。在这种情况下，它的电子邮件地址通常应该是唯一的，但 emailAddress 可能在一段时间内为空。

但是，一旦有一条记录为空 emailAddress，我就不能有任何其他带有空 emailAddress 的记录。Spring Data 拒绝使用`null` **emailAddresses**插入任何其他记录。它没有抛出任何它不起作用的东西。

现在我将其设置为`unique=true`，但我正在考虑将其设置`unique=false`为解决此问题。

这会解决问题吗？

通过放松这个，我还能添加什么其他问题？

MongoDB 是否允许我拥有多个相同的电子邮件地址并且仍然可以快速查询？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-16T20:21:05.143

来自 mongodb 文档： [http ://docs.mongodb.org/manual/core/indexes/#unique-indexes](http://docs.mongodb.org/manual/core/indexes/#unique-indexes)

因此，如果您有唯一键，请不要将其设置为 null。

老实说，在您的用例（电子邮件字段）中，我相信您不需要使用唯一键，您可以使用稀疏键，因此，没有电子邮件的文档不会占用您的 btree 索引，这将节省您的空间，并提高查找速度。

# actionscript - 从主时间线的影片剪辑中删除事件侦听器

> ID：13905080
> 
> 赞同：1
> 
> 时间：2012-12-16T20:13:43.310
> 
> 标签：actionscript

所以，我以编程方式将影片剪辑对象添加到主时间轴上。在这些影片剪辑中，我使用计时器事件，因此一旦添加到舞台上，它们就会移动。

所以当我的游戏结束时，我想从舞台上移除影片剪辑对象，我可以这样做，但它会导致错误，因为对象的听众仍然在那里。

我无法从主时间轴访问影片剪辑对象时间轴中的代码以删除侦听器，并且我不知道如何在删除侦听器时从影片剪辑时间轴中删除它们！

我希望这是有道理的！

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-05T08:08:58.473

您的 MovieClip 可以侦听 Event.REMOVED_FROM_STAGE 以编程方式删除您之前添加的所有事件侦听器。这是一些示例代码来展示它是如何完成的。

```
 // add this code to an ActionScript class that extends Sprite
    // call initClips() in the constructor

    private var _clipA:MovieClip;
    private var _clipB:MovieClip;
    private var _clipACount:int;
    private var _clipBCount:int;

    private function initClips():void
    {
        // create 2 movieclips and add some common event listeners
        _clipA = new MovieClip();
        _clipA.addEventListener(Event.ADDED_TO_STAGE, onClipAddedToStage);
        _clipA.addEventListener(Event.REMOVED_FROM_STAGE, onClipRemovedFromStage);
        _clipA.addEventListener(Event.ENTER_FRAME, onEnterFrameClipA);

        _clipB = new MovieClip();
        _clipB.addEventListener(Event.ADDED_TO_STAGE, onClipAddedToStage);
        _clipB.addEventListener(Event.REMOVED_FROM_STAGE, onClipRemovedFromStage);
        _clipB.addEventListener(Event.ENTER_FRAME, onEnterFrameClipB);

        _clipACount = 0;
        _clipBCount = 0;

        addChild(_clipA);
        addChild(_clipB);
    }

    private function onClipAddedToStage(event:Event):void
    {
        var clip:MovieClip = event.currentTarget as MovieClip;
        if(clip == _clipA)
        {
            // position movieclip to dummy values
            clip.x = 40;
            clip.y = 40;
        }
        else if(clip == _clipB)
        {
            clip.x = 200;
            clip.y = 100;
        }
    }

    private function onClipRemovedFromStage(event:Event):void
    {
        var clip:MovieClip = event.currentTarget as MovieClip;
        // good habit to null check in case "as" casting fails
        if(clip != null)
        {
            // remove event listeners for this movieclip instance
            clip.removeEventListener(Event.ADDED_TO_STAGE, onClipAddedToStage);
            clip.removeEventListener(Event.REMOVED_FROM_STAGE, onClipRemovedFromStage);

            // there is no penalty for trying to remove event listeners that were not added to this object instance
            clip.removeEventListener(Event.ENTER_FRAME, onEnterFrameClipA); 
            clip.removeEventListener(Event.ENTER_FRAME, onEnterFrameClipB);
        }
    }

    private function onEnterFrameClipA(event:Event):void
    {
        _clipACount++;
        trace("onEnterFrame for clipA " + _clipACount);

        if(_clipACount > 10)
        {
            // for demonstration purposes
            // remove self after a few frames pass
            removeChild(_clipA);
        }

    }   

    private function onEnterFrameClipB(event:Event):void
    {
        _clipBCount++;
        trace("onEnterFrame for clipB " + _clipBCount);

        if(_clipBCount > 20)
        {
            removeChild(_clipB);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T10:47:46.587

当从舞台上移除 DisplayObject 时，会有事件接收通知。只需为 Event.ADDED、Event.ADDED_TO_STAGE、Event.REMOVED 和 Event.REMOVE_FROM_STAGE 设置侦听器，即可为 MovieClip 实现一个实时循环。添加 MovieClips 时开始工作。移除 MovieClip 时移除侦听器、停止计时器等。

# html - 垂直居中与 :after 伪元素不起作用

> ID：13905086
> 
> 赞同：0
> 
> 时间：2012-12-16T20:14:46.880
> 
> 标签：html, css

我正在尝试使用伪元素方法（如[本文](http://css-tricks.com/centering-in-the-unknown/)末尾所述）将我的`introWrap`容器垂直居中。我一直应用这种方法没有任何问题，但我的生活似乎无法理解为什么它在这种情况下不起作用（[http://jsfiddle.net/4yfru/2/](http://jsfiddle.net/4yfru/2/)）。`:after`

现在`introWrap`div 位于顶部，而它实际上应该位于垂直轴的中心。我尝试用`:after`a 替换伪元素`span`，并且效果很好。这里发生了一些可疑的事情，我不知道是什么。

任何善良的灵魂可以在这里帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T03:09:35.910

您应用的元素有误`:after`。您需要将其应用于“包装”元素，[如下所示](http://jsfiddle.net/4yfru/5/)：

```
#intro:after{
    content: "";
    display: inline-block;
    vertical-align: middle;
    height: 100%;
} 
```

# php - Slim 框架中的重写得到错误 500

> ID：13905093
> 
> 赞同：1
> 
> 时间：2012-12-16T20:15:21.157
> 
> 标签：php, mod-rewrite, slim

我有这个问题，我在本地运行一个应用程序（PHP 5.3.5）并且它可以工作，但是当我把它放到网上时它没有（我有 PHP 5.3.6）。

*   [http://domain.com/](http://domain.com/) //有效
*   [http://domain.com/route](http://domain.com/route) //不起作用 错误 500
*   [http://domain.com/index.php/route](http://domain.com/index.php/route) //有效

这是我的“.htaccess”

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [QSA,L] 
```

正如你所看到的，我只添加了这一行`RewriteCond %{REQUEST_FILENAME} !-d` ，我也尝试过使用原始的 .htaccess 但没有奏效。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:06:22.890

我只是尝试使用 Wordpress 默认的 .htaccess

```
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

它有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-21T13:12:47.203

这对我有用！我知道很多人都在为此苦苦挣扎。但我希望这也适用于你们。祝你好运也不要忘记将其添加到您的虚拟主机文件中...

```
AllowOverride All 
```

重写规则

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+)$ /$1.php [L,QSA] 
```

Thats works but when you send paramters. it just goes to 404 error. Anyone know how to solve that issue.?

# android - Android 文本转语音设置语言

> ID：13905096
> 
> 赞同：0
> 
> 时间：2012-12-16T20:15:33.150
> 
> 标签：android

除了 SDK 中最新 API 的软件包之外，我没有安装任何特殊软件包。我有一个带有葡萄牙语（葡萄牙）单词的字符串，我想让电话用葡萄牙语读取它，但它似乎是一个读取葡萄牙语的英语 tts 引擎，因为它听起来真的很糟糕......

我的代码：

```
Locale loc = new Locale("pt_BR");
tts.setLanguage(loc); 
```

是否需要安装任何额外的软件包？引擎或 w/e 在我的手机/eclipse 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:24:08.467

TTS 支持：英语、法语、德语、意大利语和西班牙语。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-12-02T18:43:39.310

设置 Locale 参数如下：

```
Locale loc = new Locale("pt", "BR"); 
```

并非所有设备都支持葡萄牙语。

# php - php“imagettftext”返回空图像（不工作）

> ID：13905097
> 
> 赞同：-1
> 
> 时间：2012-12-16T20:15:52.463
> 
> 标签：php, php-gd

我已经在本地服务器和在线网络服务器上进行了测试...但返回一个空图像...

检查返回结果... [http://s8.postimage.org/sthztzj5x/null_image.jpg](http://s8.postimage.org/sthztzj5x/null_image.jpg)

```
<?php
Set the content-type
header('Content-Type: image/png');
$im = imagecreatetruecolor(400, 30);
$white = imagecolorallocate($im, 255, 255, 255);
$grey = imagecolorallocate($im, 128, 128, 128);
$black = imagecolorallocate($im, 0, 0, 0);
imagefilledrectangle($im, 0, 0, 399, 29, $white);
$text = 'Testing...';
$font = 'arial.ttf';
imagettftext($im, 20, 0, 11, 21, $grey, $font, $text);
imagettftext($im, 20, 0, 10, 20, $black, $font, $text);
imagepng($im);
imagedestroy($im);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T20:23:54.767

此脚本的第二行导致 PHP 解析错误。像这样在它的前面添加双斜杠：

// 设置内容类型

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:29:42.957

这对我来说是正确的。

[http://www.laprbass.com/RAY_temp_rameez.php](http://www.laprbass.com/RAY_temp_rameez.php)

```
<?php // RAY_temp_rameez.php
error_reporting(E_ALL);

// Set the content-type
header('Content-Type: image/png');
$im = imagecreatetruecolor(400, 30);
$white = imagecolorallocate($im, 255, 255, 255);
$grey = imagecolorallocate($im, 128, 128, 128);
$black = imagecolorallocate($im, 0, 0, 0);
imagefilledrectangle($im, 0, 0, 399, 29, $white);
$text = 'Testing...';
$font = 'fonts/verdanaz.ttf';
imagettftext($im, 20, 0, 11, 21, $grey, $font, $text);
imagettftext($im, 20, 0, 10, 20, $black, $font, $text);
imagepng($im);
imagedestroy($im); 
```

# r - 如何从R中的城市名称和国家/地区获取经度和纬度坐标？

> ID：13905098
> 
> 赞同：14
> 
> 时间：2012-12-16T20:16:02.010
> 
> 标签：r, maps, openstreetmap, rjsonio

我有一长串城市名称和国家/地区，我想将它们绘制在地图上。为此，我需要每个城市的经度和纬度信息。

我的表被调用`test`并具有以下结构：

```
Cityname  CountryCode
New York  US
Hamburg   DE
Amsterdam NL 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-16T20:16:02.010

使用以下代码，我已经成功解决了这个问题。

```
library(RJSONIO)
nrow <- nrow(test)
counter <- 1
test$lon[counter] <- 0
test$lat[counter] <- 0
while (counter <= nrow){
  CityName <- gsub(' ','%20',test$CityLong[counter]) #remove space for URLs
  CountryCode <- test$Country[counter]
  url <- paste(
    "http://nominatim.openstreetmap.org/search?city="
    , CityName
    , "&countrycodes="
    , CountryCode
    , "&limit=9&format=json"
    , sep="")
  x <- fromJSON(url)
  if(is.vector(x)){
    test$lon[counter] <- x[[1]]$lon
    test$lat[counter] <- x[[1]]$lat    
  }
  counter <- counter + 1
} 
```

由于这是调用外部服务 (openstreetmaps.org)，因此对于较大的数据集可能需要一段时间。但是，您可能只在将新城市添加到列表中时才会偶尔执行此操作。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-16T20:34:28.663

为您提供其他一些选择。

**ggmap**

ggmaps 有一个`geocode`使用谷歌地图进行地理编码的功能。这将您限制为每天 2,500 个。

**taRifx.geo**

taRifx.geo 的最新版本具有`geocode`使用 Google 或 Bing 地图进行地理编码的功能。Bing 版本要求您使用（免费）Bing 帐户，但作为回报，您可以对更多条目进行地理编码。此版本的特点：

*   服务选择（Bing 和谷歌地图都支持）
*   登录支持（特别是对于 Bing，它需要一个帐户密钥，但作为交换，允许每天请求一个数量级）
*   一次对整个 data.frame 进行地理编码，包括一些节省时间的方法，例如忽略任何已被地理编码的行
*   强大的批量地理编码（这样任何错误都不会导致整个 data.frame 的地理编码价值丢失，用于更大的工作）
*   路线查找（从 A 点到 B 点的行程时间）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-03-25T09:36:41.433

试试这个我认为它会更好地解决这个问题

```
> library(ggmap) 
Loading required package: ggplot2
Google Maps API Terms of Service: http://developers.google.com/maps/terms.
Please cite ggmap if you use it: see citation('ggmap') for details.

#Now you can give city name or country name individually

> geocode("hamburg")
Information from URL : http://maps.googleapis.com/maps/api/geocode/json?address=hamburg&sensor=false
       lon      lat
1 9.993682 53.55108

geocode("amsterdam")
Information from URL : http://maps.googleapis.com/maps/api/geocode/json?address=amsterdam&sensor=false
       lon      lat
1 4.895168 52.37022

> geocode("new york")
Information from URL : http://maps.googleapis.com/maps/api/geocode/json?address=new+york&sensor=false
        lon      lat
1 -74.00594 40.71278
```

# python - 打印包含“word”python的行

> ID：13905101
> 
> 赞同：5
> 
> 时间：2012-12-16T20:16:39.467
> 
> 标签：python, pattern-matching, match

我只想在下面的输出中打印包含“服务器”的行：

```
Date: Sun, 16 Dec 2012 20:07:44 GMT
Expires: -1
Cache-Control: private, max-age=0
Content-Type: text/html; charset=ISO-8859-1
Set-Cookie: PREF=ID=da8d52b67e5c7522:FF=0:TM=1355688464:LM=1355688464:S=CrK5vV-qb3UgWUM1; expires=Tue, 16-Dec-2014 20:07:44 GMT; path=/; domain=.google.com
Set-Cookie: NID=67=nICkwXDM6H7TNQfHbo06FbvZhO61bzNmtOn4HA71ukaVDSgywlBjBkAR-gXCpMNo1TlYym-eYMUlMkCHVpj7bDRwiHT6jkr7z4dMrApDuTk_HuTrZrkoctKlS7lXjz9a; expires=Mon, 17-Jun-2013 20:07:44 GMT; path=/; domain=.google.com; HttpOnly
P3P: CP="This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info."
Server: gws
X-XSS-Protection: 1; mode=block
X-Frame-Options: SAMEORIGIN
Connection: close 
```

此信息是从名为 websiteheaders 的列表中获取的。我有下面的一段代码让我发疯，因为它不能正常工作......

```
for line in websiteheaders:
    if "Server" in line:
        print line 
```

现在，上面的这段代码打印出与我文章开头描述的完全相同的文本块。我只是似乎不明白为什么会这样......

正如我所说，我只想打印包含“服务器”的行，如果可能的话没有正则表达式。如果不可能，请使用正则表达式。

请帮忙，谢谢！

编辑：到目前为止，我的完整代码粘贴在这里：[http](http://pastebin.com/sYuZyvX9) ://pastebin.com/sYuZyvX9 编辑2：为了完整起见，在 hosts.txt 中目前有 1 个名为“google.com”的主机

**更新**

我的代码实际上运行良好，但在我的另一段代码中有一个错误，它确保放入列表 websiteheaders 的数据是 1 个大字符串而不是多个条目。在上面的代码中，它当然会找到“Server”并打印整个条目，在我的例子中是完整的（大）字符串。

使用

websiteheaders.extend(headers.splitlines())

代替

websiteheaders.append（标题）

为我做了伎俩。非常感谢你们。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-16T20:20:03.923

真的`websiteheaders`是一个被分割成一行的列表吗？因为如果它是一个字符串，你应该使用：

```
for line in websiteheaders.splitlines():
    if "Server" in line:
        print line 
```

另外，一个很好的提示：我建议添加一些`print`遇到此类问题的语句。如果您要添加以下内容：

```
else:
    print 'WRONG LINE:', line 
```

你可能会发现这个循环不是在每一行而是在每个字符上循环。

### 更新

那我不知道你的代码有什么问题。这就是我得到的：

```
In [3]: websiteheaders
Out[3]: 
['Date: Sun, 16 Dec 2012 20:07:44 GMT',
 'Expires: -1',
 'Cache-Control: private, max-age=0',
 'Content-Type: text/html; charset=ISO-8859-1',
 'Set-Cookie: PREF=ID=da8d52b67e5c7522:FF=0:TM=1355688464:LM=1355688464:S=CrK5vV-qb3UgWUM1; expires=Tue, 16-Dec-2014 20:07:44 GMT; path=/; domain=.google.com',
 'Set-Cookie: NID=67=nICkwXDM6H7TNQfHbo06FbvZhO61bzNmtOn4HA71ukaVDSgywlBjBkAR-gXCpMNo1TlYym-eYMUlMkCHVpj7bDRwiHT6jkr7z4dMrApDuTk_HuTrZrkoctKlS7lXjz9a; expires=Mon, 17-Jun-2013 20:07:44 GMT; path=/; domain=.google.com; HttpOnly',
 'P3P: CP="This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info."',
 'Server: gws',
 'X-XSS-Protection: 1; mode=block',
 'X-Frame-Options: SAMEORIGIN',
 'Connection: close"']

In [4]: for line in websiteheaders:
   ...:     if 'Server' in line:
   ...:         print line
   ...:         
Server: gws 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T20:21:49.587

```
for single_line in websiteheaders.splitlines():
    if `Server` in single_line:
        print single_line 
```

# c++ - 错误 LNK2019：函数 __tmainCRTStartup MSVCRTD.lib(crtexe.obj) 中引用了未解析的外部符号主

> ID：13905109
> 
> 赞同：2
> 
> 时间：2012-12-16T20:17:26.907
> 
> 标签：c++, templates, visual-c++, main, lnk2019

我不断收到以下两个错误，但我不知道为什么。

```
error LNK2019: unresolved external symbol _main referenced in function ___tmainCRTStartup MSVCRTD.lib(crtexe.obj)

error LNK1120: 1 unresolved externals 
```

确保我将它作为控制台运行 [即使在链接器属性中显示控制台] 我使用的是 VC++ 2012 Ultimate。我对术语和高级概念的技术导向并不疯狂，所以请尽量不要让我不知所措。

```
//Main.cpp
#include <conio.h>
#include "XArray.h"

int Main() {
    XArray<int> Test;
    Test.Add(3);
    getch();
    return 1;
} 
```

其次是。

```
#ifndef XARRAY_H
#define XARRAY_H

template <class X>
class XIndex {
public:
    X Value;
    XIndex<X> *Next;

    //Construct
    XIndex(X ArrayValue) { Value = ArrayValue; Next = nullptr; }

};

template <class X>
class XArray {
    XIndex<X> *First;
public:
    //Construct/Destruct;
    XArray() { First = nullptr; }
    ~XArray();

    //Operators that Alter the structure;
    void Add(X); //Add X to the end.
    void AddX(X, int); //Create Int amount of X values
    void Insert(int, X); //Insert X at Index int
    bool Remove(int); //Remove Index int. Return true if deleted, false if failed.
    //void Sort(); //Todo -- Sorts by value.
    //Operators that deal with the values.
    X Get(int);
    void Set(int, X);

};

template <class X>
void XArray<X>::AddX(X NewVal, int Quantity) {
    for (int i = 0; i < Quantity; i++)
        Add(NewVal);
}

template <class X>
void XArray<X>::Add(X NewVal) {
    XIndex<X> *CurrentIndex;
    XIndex<X> *NewNode; //Where we store NewVal
    NewNode = new XIndex<X>(NewVal);

    //List doesn't exist.
    if (!First) { 
        First = NewNode;
    } else {
        //Start at beginning.
        CurrentIndex = First;
        while ((*CurrentIndex).Next){ 
            CurrentIndex = (*CurrentIndex).Next;
        }
        (*CurrentIndex).Next = NewNode;
    }

}

template <class X>
void XArray<X>::Insert(int Index, X NewVal) {
    XIndex<X> *CurrentIndex;
    XIndex<X> *PrevIndex;
    XIndex<X> *NewNode; //Where we store NewVal
    iCounter = 0;
    NewNode = new XIndex<X>(NewVal);

    //List doesn't exist.
    if (!First) { 
        First = NewNode;
    } else {
        //Start at beginning.
        CurrentIndex = First;

        while ((*CurrentIndex).Next != nullptr && iCounter < Index){ 
            iCounter += 1
            PrevIndex = CurrentIndex;
            CurrentIndex = (*CurrentIndex).Next;
        }
        if (PreviousNode == nullptr) {
            First = NewNode;
            (*NewNode).Next = CurrentIndex;
        } else {
            (*PrevIndex).Next = NewNode;
            (*NewNode).Next = CurrentIndex;
        }
    }

}

template <class X>
bool XArray<X>::Remove(int Index) {
    XIndex<X> *CurrentIndex;
    XIndex<X> *PrevIndex;
    int iCounter = 0;
    if (First == nullptr) return false; //We never had a list.

    //It's the first one;
    if (Index == 0) {
        CurrentIndex = (*First).Next;
        delete First;
        First = CurrentIndex;
        return true;
    }

    //Starting as normal.
    CurrentIndex = First;

    //Loop until we reach the index.
    while (CurrentIndex != nullptr && iCounter < Index) {
        iCounter += 1
        PrevIndex = CurrentIndex;
        CurrentIndex = (*CurrentIndex).Next;
    }
    if (CurrentIndex != nullptr) {
        (*PrevIndex).Next = (*CurrentIndex).Next;
        delete CurrentIndex;
        return true;
    }
    return false;

}

//Destructor;
template <class X>
XArray<X>::~XArray() {
    XIndex<X> *NextIndex;
    XIndex<X> *CurrentIndex;

    //Start at beginning.
    CurrentIndex = First;

    //So long as we aren't at the end [when Next = nullptr];
    while (CurrentIndex != nullptr) {
        NextIndex = (*CurrentIndex).Next;
        delete CurrentIndex;
        CurrentIndex = NextIndex;
    }
}
#endif 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T20:19:55.347

在 C++ 中，主函数被声明为`int main()`或`int main(int argc, char *argv[])`（参见 C++ 标准，第 3.6.1 段主函数）。

在您的情况下，链接器找不到 的主体`main`，因此会引发错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-08T13:13:32.083

项目 -> 属性 -> 配置属性 -> 链接器 -> 系统

并将子系统更改为控制台。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-22T11:36:12.343

我不完全确定，但通常这些错误主要取决于您在创建项目时选择的项目类型。如果选择Console，一般需要按照

```
int _tmain(int argc, _TCHAR* argv[]) 
```

但是如果您选择了 Windows 类型的项目，那么您可以按照

```
int WinMain(HINSTANCE hInst,HINSTANCE hPrevInst,LPSTR lpCmdLine,int nShowCmd) 
```

但是，如果您在已经存在的项目中将 _tmain 修改为 WinMain 或反之亦然，您可能想要执行 Arivazhagan 一直建议的操作。

如果需要`WinMain(HINSTANCE hInst,HINSTANCE hPrevInst,LPSTR lpCmdLine,int nShowCmd)`格式化，您可以将属性 -> 配置属性 -> 链接器 -> 系统中的设置更改为 Windows

和

如果需要`_tmain(int argc, _TCHAR* argv[])`格式，请使用控制台。

# google-maps - 通过点击并按住位置在地图上添加标记

> ID：13905124
> 
> 赞同：0
> 
> 时间：2012-12-16T20:19:08.447
> 
> 标签：google-maps, google-maps-markers

我设法创建了一个谷歌 API 并使用地图和阅读指南，但它们都没有解决以下功能：

*   点击并按住某个位置以添加标记

在大多数现有指南中，都解释了如何制作“硬烧”标记，但事实并非如此。例如。[https://developers.google.com/maps/documentation/android/v1/hello-mapview](https://developers.google.com/maps/documentation/android/v1/hello-mapview)

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:04:10.537

这些应该适合你：

```
function tapHold(map, length)
{
    this.length_ = length;
    var me = this;
    me.map_ = map;
    google.maps.event.addListener(map, 'mousedown', function(e) { me.onMouseDown_(e) });
    };

tapHold.prototype.onMouseDown_ = function() { this.down_ = +new Date; };
new tapHold(map, 300);
google.maps.event.addListener( map,
                               'longpress',
                               function(event) 
                               {
                                   <YOUR CODE>
                                   };
                               ); 
```

# scala - Scala 类型编译错误

> ID：13905129
> 
> 赞同：1
> 
> 时间：2012-12-16T20:19:59.573
> 
> 标签：scala, syntax, type-alias

尝试了解如何在 scala 中使用类型：

```
object TypeSample extends App {

  type MyParams = Map[Int, String]

  def showParams(params: MyParams) = {
    params.foreach(x => x match { case (a, b) => println(a + " " + b) })
  }

  //val params = MyParams( 1 -> "one", 2 -> "two")
  val params = Map( 1 -> "one", 2 -> "two")

  showParams(params)

} 
```

此行引发编译异常：“无法解析符号'MyParams'”

```
//val params = MyParams( 1 -> "one", 2 -> "two") 
```

为什么？我不能像这样使用“类型”吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T20:33:25.800

`Map( 1 -> "one", 2 -> "two")` [意味着](https://stackoverflow.com/a/9738862/406435) `Map.apply( 1 -> "one", 2 -> "two")`。`Map`是一个单例对象。

试试这个：

```
val MyParams = Map.apply[Int, String] _ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-16T20:34:52.157

因为`MyParams`只是 type 的别名`Map[Int, String]`。要完成这项工作，您必须添加一个工厂，例如

```
object MyParams {
  def apply(params: (Int, String)*) = Map(params: _*)
} 
```

# module - OCaml 中的子类型和模块包含

> ID：13905131
> 
> 赞同：3
> 
> 时间：2012-12-16T20:20:03.487
> 
> 标签：module, ocaml, subtype

假设我有以下设置

```
module type FOO = sig type f val do_foo : f end
module type BAR = sig type b val do_bar : b end

module type FOOANDBAR =
  sig 
    include FOO
    include BAR
  end 
```

现在我想（以一种很好的方式，也就是不复制接口，因此 FOO 和 BAR 仍然是子类型）强制执行类型 f 和类型 b 相同的限制。

在 OCaml 中是否有一种很好的方法可以做到这一点，可能使用一些与 include 关键字不同的方法？

谢谢！！-约瑟夫

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-16T20:45:14.067

```
module type FOOANDBAR =
  sig 
    include FOO
    include (BAR with type b = f)
  end 
```

# javascript - How to redirect from one page to another in HTML site using HTML button

> ID：13905137
> 
> 赞同：2
> 
> 时间：2012-12-16T20:20:44.833
> 
> 标签：javascript

> **Possible Duplicate:**
> [How to make a page redirect using Javascript?](https://stackoverflow.com/questions/2201522/how-to-make-a-page-redirect-using-javascript)

i have an HTML pages i want to use to redirect from one page to another like response.redirect in ASP.Net. i think i must use JavaScript.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-16T20:22:49.163

```
<input type="button" onclick="document.location.href = 'http://google.com'" /> 
```

or without JS

```
<form action="/contact.html">
    <input type="submit">
</form> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-16T20:22:39.080

In JavaScript you can do:

```
window.location="http://someplace.com"; 
```

or on HTML button do this:

```
<input type="button" onclick="document.location='http://someplace.com'" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T20:23:35.920

```
onclick="document.location.href = 'http://google.com'" 
```

OR

```
onclick="window.location = 'http://google.com'" 
```

Should work fine if you add it into your tag, replacing google with your desired address of course.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T20:23:21.210

Or you could use a link styled as a button. If the only thing that button does is redirects to other page, then you should use a link, it would be semantically better.

# c# - 应用程序启动时 Visual Studio 滞后

> ID：13905140
> 
> 赞同：1
> 
> 时间：2012-12-16T20:21:14.770
> 
> 标签：c#, visual-studio-2010, xna

我正在使用 XNA 创建游戏，最近 Visual Studios 在我启动应用程序时开始滞后。今天早不是这样的，这令人惊讶。

我想知道是否有我可能需要删除的缓存或可能需要清除的内容以使其运行更顺畅

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T22:42:26.710

早些时候，我遇到了加载时间很长的类似问题，重置所有 Visual Studio 设置都有帮助。

我还没有弄清楚我的问题到底是由什么引起的，但我怀疑这是我的 Visual Studio 扩展之一。

您是否安装了任何扩展、插件或不寻常的东西？

* * *

如果是内容编译导致了这种滞后，您可以禁用编译内容的编译，因为您已经这样做了并且它没有被更改。

# html - 使用 RegEx 从 HTML 标记字段中删除第一行

> ID：13905141
> 
> 赞同：1
> 
> 时间：2012-12-16T20:21:20.397
> 
> 标签：html, regex, markup

我有一个包含 HTML 标记的文本字段。生成此字段内容的系统似乎总是生成第一行，其中包含不可见的回车值，如果这样做，我似乎无法阻止。

有谁知道从这个文本字段中删除第一行的方法（可能使用正则表达式）？

我宁愿保留字段中所有其他回车值的实例，所以如果它是一个 RegEx 语句，它只会删除文本字段的第一行，那对我有用。

任何建议都非常受欢迎。

干杯，

韦恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T20:25:28.870

通常`trim`（通常删除空格，CR）方法在许多编程语言中用于此目的。你没有说明你会用什么语言来做这个......

# objective-c - 模仿 iOS 6 相机旋转

> ID：13905142
> 
> 赞同：10
> 
> 时间：2012-12-16T20:21:25.873
> 
> 标签：objective-c, ios, avcam

我一直在使用 AVFoundation 对自定义相机进行一些实验，到目前为止一切都很好。AVCam 示例让我走得很远，我对结果非常满意。

但是，我仍然不明白的一件事是 iOS 默认相机应用程序如何处理旋转。似乎背景根本不旋转，但所有覆盖控件都会旋转。

这可能不是特定于相机的问题，但我怎样才能实现这种行为？

TLDR：有一个背景相机层，顶部有控件，如何在不旋转背景层的情况下旋转控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T08:11:48.123

我一直在想同样的...

我的猜测是本机 Camera viewController 不使用`UIViewController`旋转机制旋转

*   没有状态栏旋转
*   没有子视图的“基本”旋转 - 工具栏不移动，按钮是动画的
*   当然包含相机预览的视图不会旋转:)

相反，它必须调用`[UIDevice beginGeneratingDeviceOrientationNotifications]`和处理特定的 UI 更新（灰色按钮褪色位置切换和工具栏按钮图像旋转）

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(yourUpdateMethodForRotation:) notificationName: UIDeviceOrientationDidChangeNotification]; 
```

# ios - 将 autoResizingMask 与 CGRectZero 一起使用

> ID：13905144
> 
> 赞同：2
> 
> 时间：2012-12-16T20:21:30.320
> 
> 标签：ios, cocoa-touch, uitableview, uiview, autoresizingmask

我正在为 tableview 部分构建页脚。页脚的高度将在 中指定`heightForFooterInSection`，因此`viewForFooterInSection`我只想添加子视图并指定页脚视图应填充指定的任何页脚高度（此页脚大小将是动态的）。因此，我将`CGRectZero`其用作初始框架并告诉页脚视图展开以填充其父视图。

```
- (UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section
{
    UIView *footerView = [[UIView alloc] initWithFrame:CGRectZero];
    footerView = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
    footerView = [UIColor greenColor];
    return footerView;
} 
```

这按预期工作 - 表格视图的页脚完全被绿色视图填充。

但现在我想`UITextView`在页脚中添加一个。文本视图应填充相同的空间，但留下 5 点边框：

```
{
    UIView *footerView = [[UIView alloc] initWithFrame:CGRectZero];
    footerView = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
    footerView = [UIColor greenColor];

    UITextView *textView = [[UITextView alloc] initWithFrame:CGRectInset(footerView.frame, 5, 5)];
    textView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    textView.backgroundColor = [UIColor redColor];

    [footerView addSubview:textView];
    return footerView;
} 
```

文本视图根本不出现，而不是填充页脚视图（有 5 磅的边距）。它可能有一个框架`CGRectZero`（甚至可能是-5 x -5？）。但是，如果我将插图设置为 0、0，它会按预期扩展。

对此有何解释？如果我不能`CGRectZero`在初始帧中使用 inset，当无法知道 footerView 的帧时，我应该使用什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:46:33.647

CGRectInset 将基于现有矩形创建一个矩形。它不再引用页脚视图：仅在它计算一次时。在这种情况下，由于您试图插入一个大小为零的矩形，这适用于文档：

> **讨论**。矩形被标准化，然后应用插入参数。如果生成的矩形的高度或宽度为负，则返回空矩形。

因此，您正在使用空矩形创建标签。

我将创建具有“典型”大小的页脚，然后创建一个带有您想要的 autoResizingMask 的适当大小的标签，**然后**将您的 footerView 设置为零，如果这是您想要的设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:30:52.373

我猜想 TextView 在后台创建内容，所以在初始化时它是空的。我通常最终使用`[string sizeWithFont:constrainedToSize:lineBreakMode:]`

```
CGSize size = [aString sizeWithFont:[UIFont systemFontOfSize:12.0] constrainedToSize:CGSizeMake(320,500) lineBreakMode:NSLineBreakByWordWrapping];
CGRect frame = CGRectMake(0, 0, size.width, size.height); 
```

# php - 使用 PHP 制作 youtube 播放列表。我得到错误。我不确定出了什么问题

> ID：13905152
> 
> 赞同：0
> 
> 时间：2012-12-16T20:22:02.080
> 
> 标签：php, youtube

我正在制作一个网站，人们可以在其中搜索音乐（来自 YouTube），并在同一个网站上观看。（无需去 YouTube。）在我的数据库中，我有一个播放列表表。该表有 4 个值。ID、用户ID、艺术家和歌曲。

id 是唯一的 ID - 我为此使用 YouTube id - 。userID 是用户的 ID。如果他们已登录，他们将无法使用播放列表功能。我已经有一个数据库。

我有以下 PHP 代码，这些信息必须保存在数据库中，但它不起作用。

```
if (isset($_SESSION['username'])){

                        echo '<button type="add to playlist" action="post">ADD</button>';

                        include 'playlistdb.php';
                        $sql = "insert into playlist (i,d,a,t) values ('$_POST[ID]','$_POST[userID]','$_POST[artist]','$_POST[title]')";
                        $result = mysql_query($sql,$conn) or die(mysql_error());
                    }
                    else{
                        echo "You are not logged in, you can use the playlist.";
                    } 
```

但这不起作用。我收到以下错误。

注意：未定义索引：第 112 行 C:\wamp\www\IKEPROJECT GROUP 9\video.php 中的 ID

用户 ID、艺术家和标题也是如此。

我不确定这里出了什么问题。

错误来自这一行：

```
$sql = "insert into playlist (i,d,a,t) values ('$_POST[ID]','$_POST[userID]','$_POST[artist]','$_POST[title]')"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:34:01.663

考虑以可读的方式使用[PDO](http://php.net/manual/en/pdo.prepared-statements.php)和格式化代码。

```
$sth = $dbh->prepare("insert into playlist (i,d,a,t) values (?, ?, ?, ?)");
$sth->execute(array($_POST['ID'], $_POST['userID'], $_POST['artist'], $_POST['title'])); 
```

如果仍然存在错误，请确保您具有名称为“ID”的有效输入字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T20:32:00.177

我认为按钮实体是错误的。使用这样的格式 `<button type="submit" formmethod="post" formaction="submit.php">ADD</button>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T20:38:25.757

您需要引号 - 它不是 $_POST[ID]，而是 $_POST['ID']。有关属性 PHP 格式的信息，请参阅 Saeed Najafi 的评论。

此外，您的代码中确实存在严重的 SQL 注入漏洞......修复该漏洞非常重要，否则有人可能会入侵您的网站，擦除您的数据库等。

# perl - MP3::Tag - UTF-16 无法识别的 BOM

> ID：13905157
> 
> 赞同：1
> 
> 时间：2012-12-16T20:22:55.387
> 
> 标签：perl, encoding, mp3

我正在编写一个小的 perl 脚本来根据文件名重新标记我的 MP3 集合。

```
#!/usr/bin/perl

use strict;
use warnings;
use MP3::Tag;
use File::Find;

MP3::Tag->config(write_v24 => 1);
my $dirpath = "../MP3s/";
finddepth(\&wanted, $dirpath);
sub wanted {
    unless (-d $_) {
        my ($track,$artist,$title);
        if(($track,$artist,$title) = ($_ =~ m/(\d+) - (.+?) - (.+)\.mp3$/g)){
            #handle songs with a track number
            my $mp3 = MP3::Tag->new($_) or die $!;

            $mp3->track_set($track);
            $mp3->artist_set($artist);
            $mp3->title_set($title);
            $File::Find::dir =~ m/.*\/(.*)/;
            $mp3->album_set($1);
            $mp3->update_tags();
            $mp3->close();
            print "$track - $artist - $title\n";
        } elsif(($artist,$title) = ($_ =~ m/(.+?) - (.+)\.mp3$/g)){
            #handle songs without a track number
            my $mp3 = MP3::Tag->new($_) or die $!;

            $mp3->track_set("");
            $mp3->artist_set($artist);
            $mp3->title_set($title);
            $mp3->update_tags();
            $mp3->close();
            print "$artist - $title\n";
        }
    }   
} 
```

这工作正常，但有一些文件会导致脚本因此错误而崩溃： `UTF-16:Unrecognised BOM 3100 at C:/strawberry/perl/lib/Encode.pm line 175.`

是什么导致了这个错误？文件名没有像德语变音符号 (ä,ö,ü) 这样的特殊字符。

如何解决此问题或跳过此类文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T21:24:37.730

您应该首先添加[`use Carp::Always`](https://metacpan.org/module/Carp%3a%3aAlways)它会给您一个堆栈跟踪，显示您自己程序中的哪个语句是致命的。

# postgresql - Postgres 转储带有大写字母的特定表

> ID：13905162
> 
> 赞同：32
> 
> 时间：2012-12-16T20:23:29.867
> 
> 标签：postgresql, shell

我正在尝试使用 -t 执行特定表的 postgres 转储。但是，该表中有一个大写字母，我得到“未找到匹配的表”。我尝试在表名周围使用引号和双引号，但它们不起作用。如何让 pg 识别大写字母？谢谢！

```
pg_dump -h hostname dbname -t tableName > pgdump.sql 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-12-16T20:31:29.570

这是以普通模式转储表的完整命令：

```
pg_dump --host localhost --port 5432 --username "postgres" --role "postgres"  --format plain  --file "complete_path_file" --table "schema_name.\"table_name\"" "database_name" 
```

或者你可以这样做：

```
pg_dump -t '"tablename"' database_name > data_base.sql 
```

在此处查看最后一页：[文档](http://www.postgresql.org/docs/current/static/app-pgdump.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-04-19T16:00:45.923

以上解决方案在 Windows 7 x64 下对我不起作用。PostgreSQL 9.4.5。但这最终确实做到了（叹气）：

## `-t "cms.\"FooContents\""`

任何一个...

```
pg_dump.exe -p 8888 --username=user -t "cms.\"FooContents\"" basdb 
```

...或者...

```
pg_dump.exe -p 8888 --username=user -table="cms.\"FooContents\"" basdb 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-02-25T17:32:51.497

在 cmd 窗口中，如果表名包含大写字母，我必须在表名周围加上三个（！）双引号。示例 pg_dump -t """Colors""" 数据库 > database.colors.psql

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-04T08:25:24.383

这对我有用：

```
pg_dump -f file.sql -U user -t 'schema.\"Table\"' database 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-24T05:41:20.840

作为节点脚本的一部分，我必须用单引号和双引号括起来，例如

```
` ... --table 'public."IndexedData"'` 
```

公认的解决方案在 bash 控制台中工作，但不是作为节点脚本的一部分，仅作为单引号方法。

# asp.net - 如何使自定义错误页面在 ASP.NET MVC 4 中工作

> ID：13905164
> 
> 赞同：261
> 
> 时间：2012-12-16T20:23:52.593
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4

我想要为 500、404 和 403 显示自定义错误页面。这是我所做的：

1.  在 web.config 中启用了自定义错误，如下所示：

    ```
    <customErrors mode="On" 
                  defaultRedirect="~/Views/Shared/Error.cshtml">

        <error statusCode="403" 
               redirect="~/Views/Shared/UnauthorizedAccess.cshtml" />

        <error statusCode="404" 
               redirect="~/Views/Shared/FileNotFound.cshtml" />

    </customErrors> 
    ```

2.  在类中注册`HandleErrorAttribute`为全局动作过滤器`FilterConfig`如下：

    ```
    public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(new CustomHandleErrorAttribute());
        filters.Add(new AuthorizeAttribute());
    } 
    ```

3.  为上述每条消息创建了一个自定义错误页面。500 的默认值已开箱即用。

4.  在每个自定义错误页面视图中声明该页面的模型是`System.Web.Mvc.HandleErrorInfo`

对于 500，它显示自定义错误页面。对于其他人，它没有。

有什么我想念的吗？

`OnException`当我阅读类方法中的代码时，看起来这并不是显示自定义错误的全部`HandleErrorAttribute`，它只处理 500 个。

我该怎么做才能处理其他错误？

* * *

## 回答 #1

> 赞同：377
> 
> 时间：2012-12-16T21:57:45.517

我当前的设置（在 MVC3 上，但我认为它仍然适用）依赖于`ErrorController`，所以我使用：

```
<system.web>
    <customErrors mode="On" defaultRedirect="~/Error">
      <error redirect="~/Error/NotFound" statusCode="404" />
    </customErrors>
</system.web> 
```

控制器包含以下内容：

```
public class ErrorController : Controller
{
    public ViewResult Index()
    {
        return View("Error");
    }
    public ViewResult NotFound()
    {
        Response.StatusCode = 404;  //you may want to set this to 200
        return View("NotFound");
    }
} 
```

以及您实现它们的方式的视图。不过，我倾向于添加一些逻辑，以在应用程序处于调试模式时显示堆栈跟踪和错误信息。所以 Error.cshtml 看起来像这样：

```
@model System.Web.Mvc.HandleErrorInfo
@{
    Layout = "_Layout.cshtml";
    ViewBag.Title = "Error";
}
<div class="list-header clearfix">
    <span>Error</span>
</div>
<div class="list-sfs-holder">
    <div class="alert alert-error">
        An unexpected error has occurred. Please contact the system administrator.
    </div>
    @if (Model != null && HttpContext.Current.IsDebuggingEnabled)
    {
        <div>
            <p>
                <b>Exception:</b> @Model.Exception.Message<br />
                <b>Controller:</b> @Model.ControllerName<br />
                <b>Action:</b> @Model.ActionName
            </p>
            <div style="overflow:scroll">
                <pre>
                    @Model.Exception.StackTrace
                </pre>
            </div>
        </div>
    }
</div> 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-04-07T18:02:13.770

我已经完成了 pablo 解决方案，但我总是遇到错误（MVC4）

> 未找到视图“错误”或其主视图，或者没有视图引擎支持搜索的位置。

要摆脱这种情况，**请删除该行**

```
 filters.Add(new HandleErrorAttribute()); 
```

在 FilterConfig.cs 中

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-11-15T11:41:44.137

我做的事情比发布的其他解决方案需要更少的编码。

首先，在我的 web.config 中，我有以下内容：

```
<customErrors mode="On" defaultRedirect="~/ErrorPage/Oops">
   <error redirect="~/ErrorPage/Oops/404" statusCode="404" />
   <error redirect="~/ErrorPage/Oops/500" statusCode="500" />
</customErrors> 
```

控制器（/Controllers/ErrorPageController.cs）包含以下内容：

```
public class ErrorPageController : Controller
{
    public ActionResult Oops(int id)
    {
        Response.StatusCode = id;

        return View();
    }
} 
```

最后，视图包含以下内容（为简单起见已删除，但它可以包含：

```
@{ ViewBag.Title = "Oops! Error Encountered"; }

<section id="Page">
  <div class="col-xs-12 well">
    <table cellspacing="5" cellpadding="3" style="background-color:#fff;width:100%;" class="table-responsive">
      <tbody>
        <tr>
          <td valign="top" align="left" id="tableProps">
            <img width="25" height="33" src="~/Images/PageError.gif" id="pagerrorImg">
          </td>
          <td width="360" valign="middle" align="left" id="tableProps2">
            <h1 style="COLOR: black; FONT: 13pt/15pt verdana" id="errortype"><span id="errorText">@Response.Status</span></h1>
          </td>
        </tr>
        <tr>
          <td width="400" colspan="2" id="tablePropsWidth"><font style="COLOR: black; FONT: 8pt/11pt verdana">Possible causes:</font>
          </td>
        </tr>
        <tr>
          <td width="400" colspan="2" id="tablePropsWidth2">
            <font style="COLOR: black; FONT: 8pt/11pt verdana" id="LID1">
                            <hr>
                            <ul>
                                <li id="list1">
                                    <span class="infotext">
                                        <strong>Baptist explanation: </strong>There
                                        must be sin in your life. Everyone else opened it fine.<br>
                                    </span>
                                </li>
                                <li>
                                    <span class="infotext">
                                        <strong>Presbyterian explanation: </strong>It's
                                        not God's will for you to open this link.<br>
                                    </span>
                                </li>
                                <li>
                                    <span class="infotext">
                                        <strong> Word of Faith explanation:</strong>
                                        You lack the faith to open this link. Your negative words have prevented
                                        you from realizing this link's fulfillment.<br>
                                    </span>
                                </li>
                                <li>
                                    <span class="infotext">
                                        <strong>Charismatic explanation: </strong>Thou
                                        art loosed! Be commanded to OPEN!<br>
                                    </span>
                                </li>
                                <li>
                                    <span class="infotext">
                                        <strong>Unitarian explanation:</strong> All
                                        links are equal, so if this link doesn't work for you, feel free to
                                        experiment with other links that might bring you joy and fulfillment.<br>
                                    </span>
                                </li>
                                <li>
                                    <span class="infotext">
                                        <strong>Buddhist explanation:</strong> .........................<br>
                                    </span>
                                </li>
                                <li>
                                    <span class="infotext">
                                        <strong>Episcopalian explanation:</strong>
                                        Are you saying you have something against homosexuals?<br>
                                    </span>
                                </li>
                                <li>
                                    <span class="infotext">
                                        <strong>Christian Science explanation: </strong>There
                                        really is no link.<br>
                                    </span>
                                </li>
                                <li>
                                    <span class="infotext">
                                        <strong>Atheist explanation: </strong>The only
                                        reason you think this link exists is because you needed to invent it.<br>
                                    </span>
                                </li>
                                <li>
                                    <span class="infotext">
                                        <strong>Church counselor's explanation:</strong>
                                        And what did you feel when the link would not open?
                                    </span>
                                </li>
                            </ul>
                            <p>
                                <br>
                            </p>
                            <h2 style="font:8pt/11pt verdana; color:black" id="ietext">
                                <img width="16" height="16" align="top" src="~/Images/Search.gif">
                                HTTP @Response.StatusCode - @Response.StatusDescription <br>
                            </h2>
                        </font>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
```

就这么简单。它可以很容易地扩展以提供更详细的错误信息，但是[ELMAH](https://code.google.com/p/elmah/wiki/MVC)为我处理了这些，并且 statusCode 和 statusDescription 是我通常需要的。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2015-05-28T09:11:50.740

这里似乎有许多步骤混杂在一起。我会提出我从头开始做的事情。

1.  创建`ErrorPage`控制器

    ```
    public class ErrorPageController : Controller
    {
        public ActionResult Index()
        {
            return View();
        }

        public ActionResult Oops(int id)
        {
            Response.StatusCode = id;
            return View();
        }
    } 
    ```

2.  为这两个操作添加视图（右键单击 -> 添加视图）。这些应该出现在名为 ErrorPage 的文件夹中。

3.  里面`App_Start`打开`FilterConfig.cs`并注释掉错误处理过滤器。

    ```
    public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        // Remove this filter because we want to handle errors ourselves via the ErrorPage controller
        //filters.Add(new HandleErrorAttribute());
    } 
    ```

4.  在 web.config 中添加以下`<customerErrors>`条目，在`System.Web`

    ```
    <customErrors mode="On" defaultRedirect="~/ErrorPage/Oops">
        <error redirect="~/ErrorPage/Oops/404" statusCode="404" />
        <error redirect="~/ErrorPage/Oops/500" statusCode="500" />
    </customErrors> 
    ```

5.  测试（当然）。在您的代码中抛出一个未处理的异常，并看到它转到 id 为 500 的页面，然后使用指向不存在的页面的 URL 来查看 404。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-02-11T04:47:01.460

我会推荐使用 Global.asax.cs 文件。

```
 protected void Application_Error(Object sender, EventArgs e)
{
    var exception = Server.GetLastError();
    if (exception is HttpUnhandledException)
    {
        Server.Transfer("~/Error.aspx");
    }
    if (exception != null)
    {
        Server.Transfer("~/Error.aspx");
    }
    try
    {
        // This is to stop a problem where we were seeing "gibberish" in the
        // chrome and firefox browsers
        HttpApplication app = sender as HttpApplication;
        app.Response.Filter = null;
    }
    catch
    {
    }
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-08-23T17:02:02.950

基于 maxspan 发布的答案，我[在 GitHub 上整理了一个最小的示例项目，](https://github.com/Zenilogix-Carl/Samples/tree/master/RazorMVC/Exceptions)显示了所有工作部分。

基本上，我们只是在**global.asax.cs**`Application_Error`中添加一个方法来拦截异常，并让我们有机会重定向（或更准确地说，*传输请求*）到自定义错误页面。

 ***```
 protected void Application_Error(Object sender, EventArgs e)
    {
        // See http://stackoverflow.com/questions/13905164/how-to-make-custom-error-pages-work-in-asp-net-mvc-4
        // for additional context on use of this technique

        var exception = Server.GetLastError();
        if (exception != null)
        {
            // This would be a good place to log any relevant details about the exception.
            // Since we are going to pass exception information to our error page via querystring,
            // it will only be practical to issue a short message. Further detail would have to be logged somewhere.

            // This will invoke our error page, passing the exception message via querystring parameter
            // Note that we chose to use Server.TransferRequest, which is only supported in IIS 7 and above.
            // As an alternative, Response.Redirect could be used instead.
            // Server.Transfer does not work (see https://support.microsoft.com/en-us/kb/320439 )
            Server.TransferRequest("~/Error?Message=" + exception.Message);
        }

    } 
```

错误控制器：

```
/// <summary>
/// This controller exists to provide the error page
/// </summary>
public class ErrorController : Controller
{
    /// <summary>
    /// This action represents the error page
    /// </summary>
    /// <param name="Message">Error message to be displayed (provided via querystring parameter - a design choice)</param>
    /// <returns></returns>
    public ActionResult Index(string Message)
    {
        // We choose to use the ViewBag to communicate the error message to the view
        ViewBag.Message = Message;
        return View();
    }

} 
```

错误页面视图：

```
<!DOCTYPE html>

<html>
<head>
    <title>Error</title>
</head>
<body>

    <h2>My Error</h2>
    <p>@ViewBag.Message</p>
</body>
</html> 
```

`filters.Add(new HandleErrorAttribute())`除了在**FilterConfig.cs**中禁用/删除之外，不涉及其他任何内容

 **```
public class FilterConfig
{
    public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        //filters.Add(new HandleErrorAttribute()); // <== disable/remove
    }
} 
```

虽然实现起来非常简单，但我在这种方法中看到的一个缺点是使用查询字符串将异常信息传递到目标错误页面。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-05-08T01:57:19.630

我已经完成了所有设置，但在我们的暂存服务器上仍然看不到状态代码 500 的正确错误页面，尽管事实上在本地开发服务器上一切正常。

我发现Rick Strahl 的[这篇博文对我有帮助。](http://weblog.west-wind.com/posts/2009/Apr/29/IIS-7-Error-Pages-taking-over-500-Errors)

我需要添加`Response.TrySkipIisCustomErrors = true;`到我的自定义错误处理代码中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-01-05T19:35:41.320

这是我的解决方案。在我看来，使用**[ExportModelStateToTempData] / [ImportModelStateFromTempData]不舒服。**

~/Views/Home/Error.cshtml：

```
@{
    ViewBag.Title = "Error";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Error</h2>
<hr/>

<div style="min-height: 400px;">

    @Html.ValidationMessage("Error")

    <br />
    <br />

    <button onclick="Error_goBack()" class="k-button">Go Back</button>
    <script>
        function Error_goBack() {
            window.history.back()
        }
    </script>

</div> 
```

~/控制器/HomeController.sc：

```
public class HomeController : BaseController
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult Error()
    {
        return this.View();
    }

    ...
} 
```

~/Controllers/BaseController.sc：

```
public class BaseController : Controller
{
    public BaseController() { }

    protected override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        if (filterContext.Result is ViewResult)
        {
            if (filterContext.Controller.TempData.ContainsKey("Error"))
            {
                var modelState = filterContext.Controller.TempData["Error"] as ModelState;
                filterContext.Controller.ViewData.ModelState.Merge(new ModelStateDictionary() { new KeyValuePair<string, ModelState>("Error", modelState) });
                filterContext.Controller.TempData.Remove("Error");
            }
        }
        if ((filterContext.Result is RedirectResult) || (filterContext.Result is RedirectToRouteResult))
        {
            if (filterContext.Controller.ViewData.ModelState.ContainsKey("Error"))
            {
                filterContext.Controller.TempData["Error"] = filterContext.Controller.ViewData.ModelState["Error"];
            }
        }

        base.OnActionExecuted(filterContext);
    }
} 
```

~/Controllers/MyController.sc：

```
public class MyController : BaseController
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult Details(int id)
    {
        if (id != 5)
        {
            ModelState.AddModelError("Error", "Specified row does not exist.");
            return RedirectToAction("Error", "Home");
        }
        else
        {
            return View("Specified row exists.");
        }
    }
} 
```

祝你项目成功;-)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-12-14T12:45:42.263

您可以在不破解 global.cs、弄乱 HandleErrorAttribute、执行 Response.TrySkipIisCustomErrors、连接 Application_Error 或其他任何事情的情况下正常工作的错误：

在 system.web 中（只是通常，开/关）

```
<customErrors mode="On">
  <error redirect="/error/401" statusCode="401" />
  <error redirect="/error/500" statusCode="500" />
</customErrors> 
```

并在 system.webServer

```
<httpErrors existingResponse="PassThrough" /> 
```

现在事情应该按预期运行，您可以使用 ErrorController 来显示您需要的任何内容。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-08-30T08:06:55.893

在 web.config 中添加如下 system.webserver 标签，

```
<system.webServer>
<httpErrors errorMode="Custom" existingResponse="Replace">
  <remove statusCode="404"/>
  <remove statusCode="500"/>
  <error statusCode="404" responseMode="ExecuteURL" path="/Error/NotFound"/>
  <error statusCode="500" responseMode="ExecuteURL"path="/Error/ErrorPage"/>
</httpErrors> 
```

并添加一个控制器，

```
public class ErrorController : Controller
{
    //
    // GET: /Error/
    [GET("/Error/NotFound")]
    public ActionResult NotFound()
    {
        Response.StatusCode = 404;

        return View();
    }

    [GET("/Error/ErrorPage")]
    public ActionResult ErrorPage()
    {
        Response.StatusCode = 500;

        return View();
    }
} 
```

并加上他们尊重的观点，我想这肯定会奏效。

我找到的这个解决方案来自：[Neptune Century](http://www.neptunecentury.com/blogs/asp-net/mvc5/mvc-5-how-to-show-custom-error-pages)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-08-11T16:38:39.127

看来我来晚了，但你最好也检查一下。

因此`system.web`用于缓存应用程序中的异常，例如 return HttpNotFound()

```
 <system.web>
    <customErrors mode="RemoteOnly">
      <error statusCode="404" redirect="/page-not-found" />
      <error statusCode="500" redirect="/internal-server-error" />
    </customErrors>
  </system.web> 
```

并`system.webServer`用于追赶 IIS 捕获但未进入 asp.net 框架的错误

```
 <system.webServer>
    <httpErrors errorMode="DetailedLocalOnly">
      <remove statusCode="404"/>
      <error statusCode="404" path="/page-not-found" responseMode="Redirect"/>
      <remove statusCode="500"/>
      <error statusCode="500" path="/internal-server-error" responseMode="Redirect"/>
  </system.webServer> 
```

在最后一个中，如果您担心客户端响应，则将其更改`responseMode="Redirect"`为`responseMode="File"`并提供静态 html 文件，因为这将显示一个带有 200 响应代码的友好页面。*****

# matlab - 线性判别分析 LDA

> ID：13905166
> 
> 赞同：3
> 
> 时间：2012-12-16T20:23:56.947
> 
> 标签：matlab, analysis, lda

我有一个大型多维数据集（240 维）。

我是执行数据挖掘的初学者，我想通过使用 MATLAB 应用线性判别分析。但是，我看到网上解释了很多功能，但我不明白应该如何应用它们。

基本上，我想申请LDA。

在这一步之后，我希望能够对我的数据进行重建。

我可以手动执行此操作，但我想知道是否有任何预定义的函数可以执行此操作，因为它们应该已经过优化。

我的初始数据类似于：`size(x) = [2000 240]`. 所以基本上我有 240 个特征（维度）和 2000 个数据点。我想在这个数据集上执行 LDA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T11:28:03.097

Statistics Toolbox 中的函数`classify`执行线性（如果您设置了一些选项，则为二次）判别分析。文档中有几个工作示例解释了它应该如何使用：输入`doc classify`或`showdemo classdemo`查看它们。

鉴于您只有 2000 个观察值，即使您只有两个类，240 个特征也相当多。您可能希望在 LDA 之前应用降维方法，例如 PCA（请参阅 参考资料`doc princomp`）或使用特征选择方法（请参阅`doc sequentialfs`有关其中一种方法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-26T22:13:33.657

您可以使用 fitcdiscr 在 matlab 2014 中使用 LDA 进行分类

# php - 页面加载时出现 ReCaptcha “incorrect-captcha-sol”错误

> ID：13905167
> 
> 赞同：1
> 
> 时间：2012-12-16T20:24:00.737
> 
> 标签：php, validation, recaptcha

好的，我的联系表格 (http://jshjohnson.com/new/contact.php) 可以正常工作，但是 ReCaptcha 错误（通常在您输入错误的单词时出现）显示在页面加载中。

我已经设置了一个名为 message 的空变量，它应该会阻止它，但不幸的是它没有。

```
<?php
include("functions.php");
require_once('recaptchalib.php');

$publickey = "6LdLX9oSAAAAALZawj-uldWrjsI0zYcR-w_r_sNh";
$privatekey = "<removed>";
$resp = recaptcha_check_answer($privatekey,
$_SERVER["REMOTE_ADDR"],
$_POST["recaptcha_challenge_field"],
$_POST["recaptcha_response_field"]);
$recaptcha_form = recaptcha_get_html($publickey);
$message = "";

if (!$resp->is_valid) {
// What happens when the CAPTCHA was entered incorrectly
$message = "The reCAPTCHA wasn't entered correctly. Go back and try it again.
(reCAPTCHA said: " . $resp->error . ")";
} else {
// ADD YOUR CODE HERE to handle a successful ReCAPTCHA submission
// e.g. Validate the data

$myemail  = "contact@jshjohnson.com";
$firstname = $_POST['firstname'];
$surname = $_POST['surname'];
$fullname = $firstname . " " . $surname;
$email = $_POST['email'];
$contact = $_POST['message'];
$website = $_POST['website'];
$subject = "Website Contact";

if($firstname == '') {
    $message = 'Please type your first name' ;
} else if ($surname == '') {
        $message = 'Please type your surname';
    } else if ($email == '') {
        $message = 'Please type your email';

        if (preg_match("/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/", $email)) {
            $message = "Email address is valid";
        } else {
            $message = "Email address is invalid";
        }
    } else if ($contact == '') {
        $message = 'Please type your message';

    } else {

    /* Let's prepare the message for the e-mail */
    $contact = "Hello!

 Josh Johnson Web Design contact form has been submitted by:

 Name:* $fullname 
 E-mail:* $email
 Website: $website
 Budget: £

 Message:*
  $contact

 End of message
  ";

    /* Send the message using mail() function */
    mail($myemail, $subject, $contact);

    /* Redirect visitor to the thank you page */
    header('Location: index.php');
    exit();
}
  }
 ?> 
```

有任何想法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-11T05:11:25.010

您必须删除或忽略该错误。在 Rails 中，它是

```
 flash[:recaptcha_error] = nil 
```

对于您的 PHP，您始终检查它是否有效

```
if (!$resp->is_valid) { 
```

然后用 打印错误`$resp->error`。因此，即使在第一页加载时没有输入任何内容，它也可能认为它无效并打印错误。相反， `recaptcha_response_field`在验证 CAPTCHA 之前检查是否为空。

# c++ - 实现 realloc 的独立库？

> ID：13905172
> 
> 赞同：0
> 
> 时间：2012-12-16T20:25:04.923
> 
> 标签：c++, c, memory-management

任何人都知道一个实现 realloc() 的独立库，只需要管理一块内存？（堆。）

即在使用堆指针和大小初始化之后，它提供了管理该区域的free/malloc/realloc。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:33:02.970

查看 Kernighan 和 Ritchie 所著的“The C Programming Language”一书中的分配器示例。另请参阅 Doug Lea 的 malloc/realloc/free 实现（通常称为`dlmalloc`）。

前者将为您提供关于 malloc/realloc 函数实际工作方式的简单内部视图。

后者将使您更详细地了解分配器函数的行业标准实现。

GNU std-c 库的`realloc()`实现也不错。我希望这能回答你的问题。

# postgresql - 引用循环：ON DELETE CASCADE？

> ID：13905175
> 
> 赞同：0
> 
> 时间：2012-12-16T20:25:30.923
> 
> 标签：postgresql, entity-relationship, referential-integrity

![在此处输入图像描述](../Images/a923e9f7411917d9d4ae5508bab8d65e.png)

如果“ **predmet** ”是“ **predmeti** ”的外键，而“ **nositelj** ”是“ **nastavnici** ”的外键，

如果我为两个外键指定*ON DELETE CASCADE并删除其中一个实体会发生什么？*它会产生错误吗？

编辑：我正在使用最新版本的 PostgreSQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:29:10.540

阅读您的 RDBMS 手册（您尚未指定它）。通常禁止循环级联 - 创建时会出现错误。

更新：尝试[http://sqlfiddle.com/#!1/24df4/2/0](http://sqlfiddle.com/#!1/24df4/2/0)似乎没有被禁止 - 递归删除。

有人非常友善地贬低了我，因为我已经修复了标签，这使我的帖子不正确）

# ajax - 使用 ajax 和 webapi 进行长轮询有什么问题……它会杀死我的服务器吗？和字符串比较

> ID：13905176
> 
> 赞同：6
> 
> 时间：2012-12-16T20:25:40.380
> 
> 标签：ajax, asp.net-web-api, long-polling

我有一个非常简单的长轮询 ajax 调用，如下所示：

```
(function poll(){
    $.ajax({ url: "myserver", success: function(data){
        //do my stuff here

    }, dataType: "json", complete: poll, timeout: 30000 });
})(); 
```

我今天下午刚拿起这个例子，它似乎工作得很好。我正在使用它在我的页面上构建一些 html，据我所知，它几乎是即时的。我有点担心这会让我的服务器上的工作线程保持打开状态，并且如果我在服务器上的负载太大，它将完全停止。有人可以阐明这个理论吗？在后端，我有一个 webapi 服务（.net mvc 4），它调用数据库、构建对象，然后将对象传递回去。在我看来，为了使其正常工作，服务器必须不断调用数据库......这不太好，对吧？？？

我的下一个问题是客户端确定是否需要更新页面上的 html 的最佳方法是什么？目前，我正在使用 JSON.stringify() 将我的对象转换为字符串，并将返回的字符串与旧字符串进行比较，如果有增量，它会重写页面上的 html。现在还没有一个完整的对象中有很多下降，但它可能会变得非常大，我认为在客户端进行字符串比较可能会占用大量资源......特别是如果它几乎不断地进行。

对我来说，最重要的是：我不确定轮询的工作时间。我只是用谷歌搜索并找到了上面的示例代码并实现了它，从表面上看，它很棒。我只是担心它会陷入困境下来（在服务器上），我将旧结果与新结果进行比较的方式将陷入困境（在客户端）。

非常感谢您提供的任何和所有信息。

TIA。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-17T13:46:51.450

好的，我的两分钱：

1.  正如其他人所说，SignalR 是经过试验和测试的代码，所以我真的会考虑使用它而不是自己编写。
2.  SignalR 确实更改了一些 IIS 设置以针对此类工作优化 IIS。因此，如果您想实现自己的，请查看[SignalR 中完成的 IIS 设置更改](https://github.com/SignalR/SignalR/wiki/Performance)
3.  我想您正在进行长轮询，以便您的服务器可以实现某种形式的服务器推送。请记住，这会将**您的无状态 HTTP 机器变成有状态机器**，如果您想扩展，这不是很好。*负载均衡器后面的长时间轮询并不好*:)**对我来说，这是服务器推送最糟糕的事情。**
4.  ASP.NET 使用 ThreadPool 来处理请求。长轮询将占用 ThreadPool 线程。如果你有太多这样的线程，你最终可能会陷入线程饥饿（和眼泪）。作为一个大概的数字，100 不算太多，但 +1000 是。
5.  甚至 SignalR 团队也说针对 SingalR 优化的 IIS 框可能没有针对普通 ASP.NET 进行优化，他们建议将这些框分开。所以这意味着成本和开销。

**归根结底，如果您正在解决业务问题**（而不是因为它很酷），我建议使用长轮询，因为那样会支付其成本、间接费用和令人头疼的问题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-17T09:10:46.350

我同意 SLaks - 即如果您需要使用 WebApi [http://www.asp.net/signalr](http://www.asp.net/signalr)的实时网络，请使用 SignalR 。长轮询很难很好地实现，让其他人处理这种复杂性，即使用 SignalR（WebApi 的自然选择）或 Comet。

SignalR 在诉诸长轮询、Web 套接字、服务器发送事件和永久帧（[此处](https://github.com/SignalR/SignalR/wiki/Faq)）之前尝试了 3 种其他形式的通信。

在某些情况下，您可能会更好地使用简单的轮询，即每隔一秒左右更新一次……看看[这篇](http://www.websocket.org/quantum.html)文章。但这里引用一段话：

> 当您的消息量很大时，长轮询不会比传统轮询提供任何实质性的性能改进。事实上，情况可能更糟，因为长时间的投票可能会失控，变成一个不受限制的、连续的即时投票循环。

令人担心的是，如果您的网页上有任何显着负载，您的 30 秒 ajax 查询最终**可能会**成为您自己的拒绝服务攻击。

如果负载过多，即使是[Bayeux](http://svn.cometd.com/trunk/bayeux/bayeux.html#toc_69) ( [CometD ) 也会诉诸简单的轮询：](http://cometdproject.dojotoolkit.org/)

> 通过使用重新连接和间隔建议字段来限制客户端来解决增加的服务器负载和资源匮乏问题，在最坏的情况下会退化为传统的轮询行为。

**至于你问题的第二部分。**

如果您使用长轮询，那么理想情况下，您的服务器应该只在实际发生变化时才返回更新，因此您的 UI 应该可能“信任”响应并假设响应意味着新数据。任何服务器推送类型的方法都是如此。

如果您确实返回到简单的轮询*pullmethod*，那么您可以使用内置的 http 方法来检测使用 If-Modified-Since 标头的更新，这将允许您返回 304 Not Modified，因此服务器将检查时间戳对象，如果自上次请求以来已修改对象，则仅返回 200 和对象。

# css - IE9 画布比例问题。不会保持纵横比以适应容器

> ID：13905183
> 
> 赞同：3
> 
> 时间：2012-12-16T20:27:43.230
> 
> 标签：css, canvas, html5-canvas

我似乎无法缩放由 IE9 中固定容器内的图像填充的画布。有人知道解决方法吗？我记得读过一些关于 IE 如何将画布视为块元素的其他线程

```
<style type="text/css">
#container { max-width: 25%; max-height: 25%; }
canvas { max-width: 90%; max-height: 90%; }
</style>

<script type="text/javascript">
var img = new Image();
img.src = 'http://l.yimg.com/dh/ap/default/121214/babydeer340.jpg';

img.onload = function () { 
    $('canvas').each(function () {
        var ctx = this.getContext("2d");
        ctx.drawImage(img, 0, 0);
    });
};​
</script>
<div id="container">
    <canvas id='fit-to-specified-width-height-with-aspect-ratio'></canvas>
</div>

<canvas id='normal'></canvas> 
```

[http://jsfiddle.net/VAXrL/535/](http://jsfiddle.net/VAXrL/535/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T16:42:46.393

我也希望这种行为在所有浏览器中都是一致的，但它看起来像 IE9 和其他几个将画布视为块级元素，因此您需要设置宽度和高度的样式。

画布元素将不得不依赖其大小的硬像素，因为它是光栅化的。一种方法是根据图像的原始大小和所需的比例来计算和设置这些像素。

我分叉了你的 JSFiddle：http: [//jsfiddle.net/cbosco/ttU5L/3/](http://jsfiddle.net/cbosco/ttU5L/3/)

```
var img = new Image();

var SCALE = 0.25;

img.onload = function () { 
    $('canvas').each(function () {
        var w = img.width;
        var h = img.height;
        w *= SCALE;
        h *= SCALE;        

        this.width = w;
        this.height = h;
        var ctx = this.getContext("2d");
        ctx.scale(SCALE, SCALE);
        ctx.drawImage(img, 0, 0);

    });
};

// good idea to set src attribute AFTER the onload handler is attached             
img.src = 'http://l.yimg.com/dh/ap/default/121214/babydeer340.jpg';
​ 
```

# orchardcms - 在代码中删除 Orchard CMS HtmlWidget

> ID：13905185
> 
> 赞同：0
> 
> 时间：2012-12-16T20:28:22.713
> 
> 标签：orchardcms, orchardcms-1.6

我有一个带有 IdentityPart 的 HtmlWidget，其 Id 值类似于“/Identifier=40b3f227-61af-4d8b-95c9-53bd6021a70e”。

```
 <HtmlWidget Id="/Identifier=40b3f227-61af-4d8b-95c9-53bd6021a70e" Status="Published">
    <IdentityPart Identifier="40b3f227-61af-4d8b-95c9-53bd6021a70e" />
    .... 
```

在代码中删除这样的小部件的正确方法是什么？我假设我们以某种方式使用内容管理器抓取对象并删除或取消发布它。但我不确定这样做的确切机制。希望有一个例子和一些关于该方法的指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:47:05.177

基本上，您可以按照您的建议使用内容管理器检索项目。例如，如果您想通过其身份检索项目：

```
var item = _contentManager.Query<IdentityPart, IdentityPartRecord>()
    .Where(c => c.Identifier == "40b3f227-61af-4d8b-95c9-53bd6021a70e")
    .Slice(0, 1).FirstOrDefault(); 
```

然后将检索到的内容项传递回内容管理器以删除或取消发布：

```
if (item != null)
{
    //delete the item - remains in the db but is no longer a draft or published
    _contentManager.Remove(item.ContentItem);
    //or unpublish
    _contentManager.Unpublish(item.ContentItem);
} 
```

# jquery - 如何使这个插件与 jQuery Mobile 一起工作？

> ID：13905186
> 
> 赞同：0
> 
> 时间：2012-12-16T20:28:22.513
> 
> 标签：jquery, jquery-mobile, page-init

我有一个滚动条插件，只有在我刷新页面时才有效，我正试图让它无缝工作。我用这个来引用它：

```
<script type="text/javascript" src="cubiq-iscroll-bad88fb/src/iscroll.js"></script> 
```

整个插件 (iscroll.js) 包含在以下内容中：

```
(function(window, doc){a lot of stuff}); 
```

我可以以某种方式用这样的东西替换那个功能吗

```
$('#transPage, #categorizePage, #IDKPage').live('pageinit', function( ){a lot of stuff}); 
```

以便它加载而无需刷新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T22:37:13.517

不要在 jQM 项目上使用 iscroll。

请改用这两个插件：

1.  [JQM iscrollview](https://github.com/watusi/jquery-mobile-iscrollview) - 为 iScroll 与 jQuery 移动集成而创建的插件。
2.  [推翻](http://filamentgroup.github.com/Overthrow/)- 另一种选择

jQM 和 Pure iScroll 的组合并不是一个好的组合，主要是因为纯 iScroll 不是为使用 jQM 页面逻辑而构建的。

# ios - 使用 iOS 安装 json-framework

> ID：13905187
> 
> 赞同：0
> 
> 时间：2012-12-16T20:28:53.257
> 
> 标签：ios, json, json-framework

这似乎是一件简单愚蠢的事情，但我无法让它发挥作用。这是流程：

从 GitHub 下载并解压缩 json-framework 包。使用 XCode 创建一个新的标准单视图应用程序。在我的项目中创建一个名为“JSON”的新组。在我的项目目录中创建一个名为“JSON”的目录，并将文件从“json-framework-master/Classes/*”复制到此目录中。在 XCode 项目中，将我刚刚复制的文件拖到我创建的“JSON”组中。文件已成功添加到项目中。在我的代码中，我在顶部添加：

```
#include "SBJSON.h" 
```

在应用程序委托启动方法中，我添加了这个：

```
NSDictionary *myDict = [NSDictionary dictionaryWithObject:@"Hi" forKey:@"There"];
NSString *myString = [myDict JSONRepresentation]; 
```

这只是一个简单的测试，以确保 JSON 正常工作。一切都可以正常构建和编译，但我收到此错误：

```
-[__NSDictionaryI JSONRepresentation]: unrecognized selector sent to instance 0x1d537b20 
```

我什至尝试将“-all_load”链接器标志添加到项目和目标中，但这无济于事。我正在使用 iOS 6.0 构建 iPhone 5。

我也知道 iOS5+ 包含原生 JSON 支持，但我也需要支持旧版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:44:16.323

看起来问题在于 XCode 不会自动将 .m 文件添加到编译源列表中。我必须手动进入 ->Targets->Build Phases->Compile Sources 并手动添加与 JSON 关联的 .m 文件。

似乎这不应该是默认值..也许我不小心在 XCode 中的某个地方设置了一个配置设置，以使其成为添加文件时的默认行为？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:40:44.237

您应该尝试使用 JSONKit 而不是 SBJSon。

您还应该尝试使用 Cocoapods 来解决这些依赖项和设置问题

# php - Debian：使用 PHP 运行新屏幕

> ID：13905192
> 
> 赞同：0
> 
> 时间：2012-12-16T20:30:43.620
> 
> 标签：php, linux, exec, gnu-screen

我目前正在尝试使用 PHP 为我的 V-Server（运行 Debian 6.0.6）构建一个屏幕管理器。

我的脚本确实已经显示了 runnung 屏幕，但是我在运行新屏幕时失败了：

webstat.php：

```
exec('sudo -u root screen -ls',$result);
print_r($result); 
```

添加到 sudoers （我知道这是不安全的，但在测试阶段更容易）：

```
www-data ALL=(ALL) NOPASSWD: ALL 
```

这是我尝试在新屏幕中运行 PHP 文件的代码：

```
exec('sudo -u root screen -S screenId php /var/www/script.php parameter1=1',$result);
print_r($result); 
```

这只是输出“必须连接到终端。”，但使用 SSH 这个命令运行良好。

接下来我阅读了 SSH 命令并尝试了这个命令：

```
sudo -u root ssh -t root@box screen -S screenId php /var/www/script.php parameter1=1 
```

该命令使用 PuTTY 工作，但是当我在 PHP 中使用此命令时，它没有给出任何结果，也没有启动新的屏幕会话：

```
exec('sudo -u root ssh -t root@box screen -S screenId php /var/www/script.php parameter1=1',$result);
print_r($result); 
```

我的 V-Server 上没有禁用任何功能。我不想编写我用 PHP 调用的 bash 脚本，我想直接用 PHP 执行命令。

如果有人知道如何解决这个问题，那就太好了！

# c - 显示所有汽车的最大气缸容量 C — 结构

> ID：13905193
> 
> 赞同：0
> 
> 时间：2012-12-16T20:30:47.800
> 
> 标签：c, function, structure

```
#include <stdio.h>
#include <conio.h>
#include <string.h>
#include <stdlib.h>

typedef struct {
    char model[50], mark[50], color[50];
    int cylinderCap;
} car;

void read(car *cr, int *nr) {
    printf("Insert mark: ");
    (*nr)++;
    fflush(stdin);
    gets((cr + *nr)->mark);
    printf("Insert model: ");
    gets((cr + *nr)->model);
    printf("Insert color: ");
    gets((cr + *nr)->color);
    printf("Insert the cylinder capacity: ");
    scanf("%d", &((cr + *nr)->cylinderCap));
}

void display(car *cr, int nr) {
    printf("\n%-10s \t%-10s \t%-10s %d", (cr + nr)->mark, (cr + nr)->model,
           (cr + nr)->color, cr[nr].cylinderCap);
}

void search_model(car *cr, int *nr, char mod[50]) {
    int i;
    for(i = 0; i <= (*nr); i++)
        if(strcmp((cr + i)->model, mod) == 0)
            display(cr, i);
}

void search_cc(car *cr, int *nr, int cc) {
    int i;
    for(i = 0; i <= (*nr); i++)
        if((cr + i)->cylinderCap >= cc)
            display(cr, i);
}

void clear(car *cr, int *nr, char mod[50]) {
    int k = 0,i,j;

    for(i = 0; i <= (*nr); i++)
        if(strcmp((cr + i)->model, mod) == 0)
        {
            k++;
            for(j = i; j <= (*nr - k); j++)
                *(cr + j) = cr[j + 1];
        }
    *nr = *nr - k;
}

void main() {

    car cr[50];
    int opt, n = -1, i, cc = 1900;
    char mod[50];

    do{
        system("CLS");
        printf("1.Add a car\n");
        printf("2.Display cars\n");
        printf("3.Search a car after its model\n");
        printf("4.Display all the cars with cc > 1900\n");
        printf("5.Remove a car after its model\n");
        printf("6.Exit\n");
        printf("7.Display the biggest cyclinder capacity of all the cars\n");
        printf("Insert option: ");
        scanf("%d", &opt);

        switch(opt) {
            case 1:
                read(&cr[0], &n);
                break;

            case 2:
                printf("\n%-10s \t%-10s \t%-10s %s", "mark", "Model", "color", "Capacity");

                for(i = 0; i <= n; i++)
                    display(cr, i);
                break;

            case 3:
                printf("Insert model: ");
                scanf("%s", mod);
                printf("\n%-10s \t%-10s \t%-10s %s", "mark", "Model", "color", "Capacity");
                search_model(&cr[0], &n, mod);
                break;

            case 4:
                printf("\n%-10s \t%-10s \t%-10s %s", "mark", "Model", "color", "Capacity");
                search_cc(&cr[0], &n, cc);
                break;

            case 5:
                printf("Insert the model you wish to delete: ");
                scanf("%s", mod);
                clear(&cr[0], &n, mod);
                break;

            case 6:
                break;

            case 7:
                break;

            default: printf("Error! Please try another option!\n");
                break;
        }
        getch();
    }while(opt != 6);

    getch();
} 
```

这将显示：

```
1.Add a car
2.Display cars
3.Search a car after its model
4.Display all the cars with cc > 1900
5.Remove a car after its model
6.Exit
7.Display the biggest cylinder capacity of all the cars
Insert option: 
```

我不知道如何做最后一个，我什至不知道如何开始！我尝试了这样的事情，但没有成功：

```
void maximum(car *cr, int *nr, int max) {
    int i;
    for(i = 0; i <- (*nr); i++)
        if(((cr + i)->car) >=max))
            max = (cr + i)->car;
        display(max);
} 
```

但它并没有真正起作用，所以任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:00:48.890

你的`maximum`功能没有任何意义。您正在尝试使用对象类型作为结构的项目，使用多余的指针算术和其他已经在您的帖子评论中讨论过的东西。

```
void maximum(car *cr, int nr)
{
    int i, max = 0;
    for(i = 1; i <= nr - 1; i++)
    {
        if(cr[i].cilinderCap >= cr[max].cilinderCap)
        {
            max = i;
        }
    }
    display(cr, max);
} 
```

^(注意：在将其复制到您的文件之前，请尝试理解我的代码。)

这是人们可以获得的最直观的方法。注意我使用“汽缸容量”变量来实际检查，嗯，最大汽缸容量。

另请注意，如果您从索引 0 开始您的汽车，您应该搜索到`n - 1`，而不是`n`。引用的参数 for`nr`也是多余的，因为您甚至不尝试修改它。

所以，你只需调用：

```
maximum(cr, n); 
```

另一件事是您应该检查函数中的错误，因为在其当前状态下，如果列表中没有元素，它可能会崩溃。

您的代码中还有其他一些与问题无关的“道德上不正确的东西”，但我建议阅读 Google 上有关结构列表的一些文章。

# inform7 - 通知 7：根据特定物品是否在库存中取货

> ID：13905194
> 
> 赞同：8
> 
> 时间：2012-12-16T20:30:49.010
> 
> 标签：inform7

我正在使用 Inform 7 进行冒险。在冒险中，您可以捡起筹码。如果你的库存中有芯片，我希望能够拿起一个叫做袖珍电脑的东西。把它放在一个可能的通知句中：

```
If chip is in the inventory, take pocket computer. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T20:15:50.217

我想你最好换一种方式去做。毕竟，随身物品一般都是可以捡起来的；*如果他们没有*芯片，您似乎想要做的是*防止*服用它。我认为这样的事情可以工作：

 *```
Instead of taking the pocket computer when the player does not have the chip:
say "You need the chip first!" 
```

但是，我会考虑阻止玩家捡起它是否合理。袖珍电脑是否以某种方式固定到位，需要芯片才能解锁？或者仅仅是计算机在拥有芯片之前没有用吗？如果是后者，我建议您仍然允许玩家捡起它，因为在现实生活中没有什么能阻止他们这样做。仅仅因为它还没有用，它就打破了沉浸感以阻止合理的行动。*

# javascript - nodejs无法识别对象的功能

> ID：13905195
> 
> 赞同：1
> 
> 时间：2012-12-16T20:30:51.240
> 
> 标签：javascript, node.js, prototype

我正在 node.js 中构建一个 reddit API 包装器，以更加熟悉 js 和 node。到目前为止，这是我的代码：

./lib/reddit.js：

```
var request = require("request");

var reddit = function () {

  var self = this,
  userAgent = "node.js api wrapper",
  debug = false,
  uh = "",
  cookie = "";

  self.getJSON = function (url, callback) {
    request(url, function (error, response, body) {
      if (!error && response.statusCode == 200) {
        callback(body);
      }
    });
  };

  self.post = function (url, data, callback) {
    request.post(url, { form: data }, function (error, response, body) {
      if (!error && response.statusCode == 200) {
        callback(body);
      }
    });
  };

};

reddit.prototype = {

  login: function (username, password) {
    var data = {
      "user": username,
      "password": password,
      "rem": true
    };

    this.post("http://www.reddit.com/api/login", data, function (body) {
      var response = JSON.parse(body);
      this.uh = response.json.data.modhash;
      this.cookie = response.json.data.cookie;
      console.log(response);
      console.log(this.uh);
      console.log(this.cookie);
    });
  }

}

exports.reddit = reddit; 
```

应用程序.js：

```
var reddit = require("./lib.reddit").reddit;
reddit.login("username", "password"); 
```

我收到此错误：

```
[jet@cowboybebop reddit]$ node app.js 

/home/jet/projects/reddit/app.js:5
reddit.login("username", "password");
   ^
TypeError: Object function () {

  var self = this,
      userAgent = "node.js api wrapper",
      debug = false,
      uh = "",
      cookie = "";

  self.getJSON = function (url, callback) {
    request(url, function (error, response, body) {
      if (!error && response.statusCode == 200) {
        callback(body);
      }
    });
  };

  self.post = function (url, data, callback) {
    request.post(url, { form: data }, function (error, response, body) {
      if (!error && response.statusCode == 200) {
        callback(body);
      }
    });
  };

} has no method 'login'
at Object.<anonymous> (/home/jet/projects/reddit/app.js:5:8)
at Module._compile (module.js:449:26)
at Object.Module._extensions..js (module.js:467:10)
at Module.load (module.js:356:32)
at Function.Module._load (module.js:312:12)
at Module.runMain (module.js:492:10)
at process.startup.processNextTick.process._tickCallback (node.js:244:9) 
```

我最初的登录功能定义为

```
reddit.prototype.login = function () ..... 
```

但这也不起作用。另一个 SO question 建议像我现在一样格式化它，但它仍然无法识别它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T20:48:09.543

```
var reddit = require("./lib.reddit").reddit;

var a = new reddit();

a.login("username", "password"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:49:37.250

改变了我对这个问题的看法。并不是保留 get ，而是您试图通过混合两种类型的对象定义（作为函数和作为原型）在尚未实例化的函数中运行方法。self.post 在您实际实例化一个 reddit 对象之前不会存在。

我认为最好的办法是将您的 self.post 函数定义移动到原型，以便您可以将其用作静态方法，或者将您的登录函数定义移动到函数定义中并实际实例化对象以使用其方法.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T20:50:19.403

这个构造：

```
var reddit = function () { }; 
```

只是定义一个函数，而不是一个类。您需要`new`操作员调用它并创建一个对象。你可能想用这个：

```
var reddit = new function () { }; 
```

它调用该函数并创建您的（匿名）类的对象。您的其余代码应该按原样工作！

# c++ - 忽略 gcc/clang 的“-Wmissing-braces”警告是否明智？

> ID：13905200
> 
> 赞同：54
> 
> 时间：2012-12-16T20:31:32.143
> 
> 标签：c++, c++11, compiler-warnings

考虑以下程序：

```
#include <array>

int main()
{
  std::array<int, 1> x = { 0 }; // warning!
  x = { { 0 } }; // no warning
  return 0;
} 
```

第一次初始化导致 gcc 4.7.2 上的警告...

```
main.cpp:5:22: warning: unused variable ‘x’ [-Wunused-variable] 
```

...和铿锵3.1

```
main.cpp:5:28: warning: suggest braces around initialization of subobject [-Wmissing-braces]
  std::array<int, 1> x = { 0 }; 
```

就标准而言，至少在此示例中，双花括号或单花括号之间应该没有区别。

有两种处理警告的方法：

1.  把它关掉
2.  修复代码，让编译器开心

你有什么建议？恕我直言，双卷曲的表情看起来有些难看。另一方面，警告可能会在更复杂的示例中检测到真正的问题。你知道警告可以帮助你的例子吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-12-16T20:59:15.380

[`-Wmissing-braces``-Wall`出于您所描述的原因，从 4.8 开始，将不再在 GCC（用于 C++ 模式）中启用。](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=25137)对于当前版本的 GCC，无论是禁用还是忽略警告，您所拥有的代码都会按照应有的方式编写。

该警告可能旨在涵盖代码，例如

```
struct A { int a; int b; };
struct B { A a; int b; };
B b = {
  1,
  2 // initialises b.a.b, not b.b
}; 
```

但是，恕我直言，这已经被 处理得很好`-Wmissing-field-initializers`，它不会警告您的原始代码。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-03-09T07:05:39.157

我在 Xcode 6.1.1（截至 2015 年 3 月 9 日的当前版本）中收到相同的警告。当我在每个子对象周围添加额外的大括号时，我得到一个错误。当我在整个初始化列表周围添加一组额外的大括号时，警告就会消失。根据标准规范 14882:2011 23.3.2.1 [array.overview] 第 2 小节明确规定

```
array<T, N> a = { initializer-list }; 
```

> 其中 initializer-list 是一个逗号分隔的列表，最多包含 N 个元素，其类型可转换为 T

Xcode 6.1.1 中的代码结果（下）

```
array<int, 2> key1 = {1, 2}; // warning: suggest braces around initialization of subobject

array<int, 2> key2 = { {1}, {2} }; // error: no viable overload =

array<int, 2> key3 = array<int, 2> { {1}, {2} }; // error: excess elements in struct initializer

array<int, 2> key4 = { {1, 2} }; // no warning and no error 
```

当我们查看 14882:2011 8.5 [dcl.init] 第 1 小节时，我们看到“初始化器列表”可以选择包含“初始化器子句”，它本身可以是“支撑初始化器列表”。所以无论哪种方式都应该是正确的。尽管基于规范，我个人认为单大括号不应该为 std::array 初始化器列表输出编译器警告，而双大括号是矫枉过正的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-01-24T02:18:13.447

Clang 6.0 抑制了关于缺少大括号的警告。svn 日志说：

> 当聚合初始化具有单个字段的结构时，抑制 -Wmissing-braces 警告，该字段本身就是聚合。在 C++ 中，std::array 类型的这种初始化保证按标准工作，是完全惯用的，并且 Clang 的“建议”替代方案在技术上是无效的。

`-Wmissing-braces`因此，如果需要支持，我会在 6.0 之前省略大括号并禁用Clang。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-08-29T15:26:40.753

当使用 忽略 Clang 警告时`-Wno-missing-braces`，我建议启用`-Wmissing-field-initializers`（或使用`-Wextra`，其中也包括它）。否则，您会错过一个有用的警告，如本例所示：

```
#include <cstdio>

struct A
{
  int i;
  int arr[2];
  int j;
};

void print(const A& a)
{
  printf("i=%d, arr={%d,%d}, j=%d\n", a.i, a.arr[0], a.arr[1], a.j);
}

int main() {
  A a = {1, 2, 3}; // this is the critical line
  print(a); // output: i=1, arr={2,3}, j=0

  A b = {1, {2}, 3};
  print(b); // output: i=1, arr={2,0}, j=3

  A c = {1, {2,0}, 3};
  print(c); // output: i=1, arr={2,0}, j=3

  return 0;
} 
```

```
$ clang++ -Wall example.cpp
example.cpp:16:13: warning: suggest braces around initialization of
      subobject [-Wmissing-braces]
  A a = {1, 2, 3};
            ^~~~
            {   }
1 warning generated.

$ clang++ -Wall -Wno-missing-braces example.cpp
(no warnings)

$ clang++ -Wall -Wno-missing-braces -Wmissing-field-initializers example.cpp
example.cpp:16:17: warning: missing field 'j' initializer
      [-Wmissing-field-initializers]
  A a = {1, 2, 3};
                ^
1 warning generated.

$ clang++ --version
clang version 3.8.1 (tags/RELEASE_381/final) 
```

为了比较，这是 GCC 所做的：

```
$ g++ -Wall -Wextra example.cpp
(no warning)

$ g++ -Wall -Wmissing-field-initializers example.cpp
example.cpp: In function ‘int main()’
example.cpp:16:17: warning: missing initializer for member ‘A::j’ [-Wmissing-field-initializers]
   A a = {1, 2, 3};
                 ^ 
```

总之：

*   对于 Clang，我建议`-Wno-missing-braces -Wmissing-field-initializers`在不丢失其他有用警告的情况下使警告静音
*   GCC 在原始示例中没有抱怨`std::array<int, 1> x = { 0 };`，因此无需禁用任何警告。但是，我建议启用`-Wmissing-field-initializers`（或使用`-Wextra`），因为它不是由`-Wall`.

# c - 函数 cvShowImage 使程序崩溃。为什么？OpenCv

> ID：13905201
> 
> 赞同：0
> 
> 时间：2012-12-16T20:31:53.363
> 
> 标签：c, opencv

我在 Windows 8 中使用 OpenCV 2.3.1。当我调用函数`cvShowImage`时，程序崩溃。我正在使用代码块，但我不知道为什么会发生这种情况。

如果我评论该行，程序运行良好。

代码如下所示：

```
 IplImage *img1=NULL;
    img1=cvLoadImage("LenaComFormas.pgm",CV_LOAD_IMAGE_GRAYSCALE);
    cvShowImage("Original", img1);
    cvWaitKey(0); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:42:32.273

因为图像未加载（`cvLoadImage`返回`NULL`）。您可以使用[调试器](http://en.wikipedia.org/wiki/Debugger)来检查它。再次检查文件的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T20:51:30.797

您的代码在 Windows7 上使用 Qt 和 opencv 2.4.3 运行良好...您可以执行的可能检查...

1.  检查到库的链接...opencv_core231、opencv_highgui231、opencv_imgproc231...检查包括到 opencv2/opencv/core.hpp opencv2/opencv/highgui.hpp。
2.  检查 IplImage 指针 img1

`IplImage *img1 = cvLoadImage("",0);`

`if(img1==NULL)`

`return -1;`

3\. 检查 *.pgm 图像的支持...或者获取最新的 opencv 并尝试...

**编辑..** 4。只是为了检查尝试以下..

```
#include <opencv/opencv2/core.hpp>
#include <opencv/opencv2/highgui.hpp>

using namespace cv;

int main()
{
  Mat image;
  image = imread("",0);
  imshow("TEST",image);
  waitKey(0);
  return 0;
} 
```

# python - 为什么在这个 Python 代码中 '0.00' 比较不等于 0？

> ID：13905205
> 
> 赞同：0
> 
> 时间：2012-12-16T20:32:12.733
> 
> 标签：python, if-statement

我的 IF ELSE 语句有什么问题？

IF NOT 条件，做 A. ELSE，做 B。

但结果与我预期的完全不同。:S

```
data['stock'] = ['0.02', '0.03', '0.04', '0.00', '0.05', '0.04', '0.05']

x = 0
y = len(data['Keywords'])

while x <= y - 1:
    if data['stock'][x] != 0:
        print data["stock"][x]
        a = a + 1
    else:
        print "hello"
        a = a + 1

Output:
0.02
0.03
0.04
0.00
0.05
0.04
0.05 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-16T20:35:11.530

`'0.00'`是一个字符串。 `0`是一个数字。这些不相等。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-16T20:35:29.320

一个明显的问题是您的列表包含字符串，而您的代码需要数字。在 Python 中，您可以进行比较`0`（`"0"`它们比较不相等）。

一种解决方法：

```
data['stock'] = [0.02, 0.03, 0.04, 0.00, 0.05, 0.04, 0.05] 
```

此外，该循环看起来绝对不是 Pythonic。第一步是这样改写它：

```
for x in range(len(data['Keywords'])):
    if data['stock'][x] != 0:
        print data["stock"][x]
    else:
        print "hello" 
```

如果您不使用`x`除了索引到列表之外的值，那么计数器是不必要的：

```
for val in data["stock"]:
    if val != 0:
        print val
    else:
        print "hello" 
```

请注意，这假设`data["Keywords"]`具有相同的长度和`data["stock"]`。如果不是这种情况，则此代码不等同于您的代码。

# objective-c - 使用 NSWindowController 动画打开一个新窗口

> ID：13905213
> 
> 赞同：3
> 
> 时间：2012-12-16T20:33:57.963
> 
> 标签：objective-c, macos, cocoa, animation

从 Mac OS X 10.7 开始，新`NSDocument`窗口和警报窗口会以动画形式打开。`NSWindowController`但是，使用'方法打开的 Windows`showWindow:`没有动画。

有没有办法让这些窗口获得相同的动画？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-16T20:37:41.730

您可以定义窗口的打开方式。

在动画下的界面检查器中，您可以选择文档窗口样式，您应该得到相同的行为。

或在代码中：

```
[self.window setAnimationBehavior:NSWindowAnimationBehaviorDocumentWindow]; 
```

* * *

这里有你可以使用的所有行为

```
enum {
    NSWindowAnimationBehaviorDefault = 0,       // let AppKit infer animation behavior for this window
    NSWindowAnimationBehaviorNone = 2,          // suppress inferred animations (don't animate)

    NSWindowAnimationBehaviorDocumentWindow = 3,
    NSWindowAnimationBehaviorUtilityWindow = 4,
    NSWindowAnimationBehaviorAlertPanel = 5
}; 
```

# javascript - CSS3 和 Javascript：淡出文本，然后使用相同的功能

> ID：13905215
> 
> 赞同：0
> 
> 时间：2012-12-16T20:34:06.697
> 
> 标签：javascript, css, css-transitions

我正在尝试使用 JavaScript 和 CSS3 创建淡出和淡出效果。目标是在单击时缩小 div 的宽度，并使其中包含的文本同时淡出。然后当再次单击它时，div 会扩展回正常宽度，并且文本会淡入。

这是HTML：

```
<div id="box1" onclick="slide1()">
<p class="fader">Lorem ipsum.</p>
</div> 
```

这是CSS：

```
 #box1 {
position:relative;
left:0%;
top:0%;
width: 70%;
height: 100%;
background-color: #666;
z-index:4;
} 
```

这是javascript：

```
var box1
var fader

window.onload = function() {
    box1 = document.getElementById('box1');
    fader = document.getElementsByClassName('fader');
    } 

function slide1(){

if(box1.style.width=='10%'){
box1.style.width='70%';
fader[0].style.opacity='1';
fader[0].style.transition='opacity 0.25s ease-in';
    }
 else {
    box1.style.width='10%';
 fader[0].style.opacity='0';
    fader[0].style.transition='opacity 0.75s ease-in';
 }
} 
```

它适用于淡出，但对于淡入，它会立即从 0 不透明度过渡到 1 不透明度......没有淡入。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T20:56:26.190

我猜你甚至使用Firefox或Opera？我认为您的代码不适用于 safari 或 chrome，因为在这些浏览器上转换需要 webkit-prefix。您可以使用以下代码获得过渡支持：

```
var transform = (function () {
    var transforms = [
        'OTransform',
        'MozTransform',
        'msTransform',
        'WebkitTransform'
        ], transform = 'transform';

    while (transform) {
        if (document.body.style[transform] === undefined) {
            transform = transforms.pop();

        } else {
            return transform;

        }

    }

    return false;

}()); 
```

当我使用 CSS 过渡时，有时我会更改过渡样式，然后让浏览器在更改其他样式之前更新更改。您可以通过超时来执行此操作。在某些浏览器上，我注意到动画无法正常工作，除非这样做（某些 firefox 浏览器）。

```
fader[0].style.transition='opacity 0.75s ease-in';
setTimeout(function () {
    box1.style.width='10%';
    fader[0].style.opacity='0';
}, 4); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T02:05:08.963

实际上，我不久前就同样的问题问了一个非常相似的问题：[不透明度效果从 1.0 到 0，但不是 0 到 1.0](https://stackoverflow.com/questions/12699459/opacity-effect-works-from-1-0-to-0-but-not-0-to-1-0)。检查出来，看看它是否适合你。

否则，请尝试向推子元素添加一个类，而不是添加样式声明。然后，在您的实际 CSS 中，编写推子元素转换的代码。

# java - 我做了这个主要功能。有没有更快或更好的方法？

> ID：13905221
> 
> 赞同：2
> 
> 时间：2012-12-16T20:35:09.763
> 
> 标签：java, primes

> **可能重复：**
> [用 java 编写 isPrime 的最优雅方式](https://stackoverflow.com/questions/2385909/most-elegant-way-to-write-isprime-in-java)

我如何才能使它更快或更好？我让它解决了一个项目的欧拉问题，然后对其进行了优化，但我确信这不是最好的方法

```
public static boolean prime(int number){
    int limit = (int) (1 + Math.sqrt(number) );
    if (number < 1) return false;
    if (number == 2) return true;
    if (number % 2 == 0) return false;

    for(int i= 3; i < limit; i+=2)
        if(number % i == 0)
            return false;
    return true;
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T20:45:12.303

除了对数字的处理之外`1`，该功能看起来还不错。可以进行的一项改进是利用所有大于 的素数`3`的形式为 的事实`6k ± 1`。

您可以选择[更进一步](http://en.wikipedia.org/wiki/Wheel_factorization)，但您必须在提高性能与增加代码复杂性之间取得平衡。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-16T20:48:11.030

取决于你想得到多少花哨。

一个简单的改进是使用[轮因式分解](http://en.wikipedia.org/wiki/Wheel_factorization)——而不是只尝试每个奇数（*例如，*不能被 2 整除的数字），而是只尝试不能被几个小素数整除的数字。例如，这是一个检查可被 2 或 3 整除的实现：

```
for (int i = 6; i < limit; i += 6) {
    if (number % (i + 1) == 0) return false;
    if (number % (i + 5) == 0) return false;
} 
```

这只需要对每六个数字进行两次测试，而不是您的代码所做的 1/2。您可以通过添加额外的素数来进一步改进它（维基百科文章中的轮子测试了 30 个中的 8 个），但代价是快速增加代码大小。

如果您不介意用一些严肃的数学来弄脏您的手，那么可以使用疯狂的数论方法，例如[Miller-Rabin 测试](http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test)。请注意，使用正确的证人集，这些方法可证明对合理范围内的所有数字都是正确的（请参阅“测试的确定性变体”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T20:47:45.017

```
BigInteger.valueOf(x).isProbablePrime(50) 
```

假设您愿意容忍 1/1000000000000000 的错误机会，那可能会非常快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T20:45:56.073

看看 Eratosthenes 的筛子 [http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)

# algorithm - 在有根树中查找一定距离内的节点数

> ID：13905223
> 
> 赞同：6
> 
> 时间：2012-12-16T20:35:13.173
> 
> 标签：algorithm

在有根加权树中，如何找到距每个节点一定距离内的节点数？您只需要考虑向下边缘，例如从根向下的节点。请记住，每个边缘都有一个权重。

我可以`O(N^2)`使用来自每个节点的 DFS 及时完成此操作并跟踪行进的距离，但`N >= 100000`它有点慢。我很确定您可以使用 DP 使用未加权边缘轻松解决它，但是有人知道如何快速解决这个问题吗？（小于`N^2`）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T13:37:25.147

通过使用以下观察，可以改进我之前对**O(nlog d) 时间**和 O(n) 空间的回答：

> 给定节点 v 的足够接近节点的数量是其每个子节点的足够接近节点的数量之和，减去*刚刚变得*不够接近的节点的数量。

让我们称距离阈值 m，以及两个相邻节点 u 和 vd(u, v) 之间的边上的距离。

## 每个节点都有一个祖先，它是第一个错过的祖先

对于每个节点 v，我们将维护一个计数 c(v)，初始值为 0。

对于任何节点 v，考虑从 v 的父节点到根节点的祖先链。将此链中的第 i 个节点称为 a(v, i)。请注意，在此链中的第一个节点的某个数量 i >= 0 中，需要将 v 计算为足够接近，而在其他节点中则不需要。如果我们能够快速找到 i，那么我们可以简单地将c(a(v, i+1))*递减*（使其（可能进一步）低于 0），这样当 a(v, i+1) 的计数的孩子在稍后的传递中添加到它， v 被正确排除在计数之外。如果我们在将节点 v 的所有子节点添加到 c(v) 之前计算它们的完全准确计数，则任何此类排除都会正确“传播”到父节点计数。

棘手的部分是有效地找到 i。调用从 v 到根 s(v, j) 的路径上前 j >= 0 个边的距离之和，并调用这些路径长度的所有 depth(v)+1 的列表，按升序排列, s(v)。我们要做的是对路径长度 s(v) 的列表进行二进制搜索，以查找大于阈值 m 的第一个条目：这将在 log(d) 时间内找到 i+1。问题是构造 s(v)。我们可以使用从 v 到根的运行总计轻松构建它——但这将需要每个节点 O(d) 时间，从而抵消任何时间改进。我们需要一种在恒定时间内从 s(parent(v)) 构造 s(v) 的方法，但问题是当我们从节点 v 递归到它的子节点 u 时，路径长度会以“错误的方式”增长：每个路径长度 x 需要变为 x + d(u, v)，并且需要在开头添加一个新的路径长度 0。这似乎需要 O(d) 更新，但有一个技巧可以解决这个问题......

## 快速找到我

解决方案是在每个节点 v 处计算从 v 到根的路径上所有边的总路径长度 t(v)。这很容易在每个节点的恒定时间内完成：t(v) = t(parent(v)) + d(v, parent(v))。然后我们可以通过在 s(parent(v)) 的开头加上 -t 来形成 s(v)，并且在执行二分搜索时，考虑每个元素 s(v, j) 来表示 s(v, j) + t （或等效地，对 m - t 而不是 m 进行二分搜索）。通过让节点 v 的子节点 u 共享 v 的路径长度数组，可以在 O(1) 时间内在开始处插入 -t，其中 s(u) 被认为在 s(v) 之前开始一个内存位置。所有路径长度数组在大小为 d+1 的单个内存缓冲区中“右对齐”——具体而言，深度为 k 的节点的路径长度数组将从缓冲区内的偏移量 dk 开始，以便为它们的后代节点留出空间来添加条目。数组共享意味着兄弟节点将覆盖彼此的路径长度，但这不是问题：我们只需要 s(v) 中的值保持有效，同时在前序 DFS 中处理 v 和 v 的后代。

通过这种方式，我们获得了O(d) 路径长度在 O(1) 时间内增加的*效果。*因此，在给定节点找到 i 所需的总时间是 O(1)（构建 s(v)）加上 O(log d)（使用修改后的二进制搜索找到 i）= O(log d)。单个预序 DFS 通行证用于查找和减少每个节点的适当祖先计数；后序 DFS 传递然后将子计数与父计数相加。这两个遍可以组合成在递归之前和之后执行操作的节点上的单遍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-17T11:00:44.633

**[编辑：请参阅我的其他答案以获得更有效的 O(nlog d) 解决方案:) ]**

这是一个简单的 O(nd) 时间、O(n) 空间算法，其中 d 是树中任何节点的最大深度。具有 n 个节点的完整树（每个节点具有相同数量的子节点的树）的深度为 d = O(log n)，因此在大多数情况下，这应该比基于 O(n^2) DFS 的方法快得多在这种情况下，尽管如果每个节点足够接近的后代数量很少（即如果 DFS 仅遍历少量级别），那么您的算法也不应该太糟糕。

对于任何节点 v，考虑从 v 的父节点到根节点的祖先链。请注意，在此链中的第一个节点的某个数量 i >= 0 中，需要将 v 计算为足够接近，而在其他节点中则不需要。所以我们需要做的就是**对于每个节点，向上爬向根，直到总路径长度超过阈值距离 m，随着我们去增加每个祖先的计数。** 有n个节点，每个节点最多有d个祖先，所以这个算法很简单O(nd)。

# opengl - 每顶点网格变形

> ID：13905224
> 
> 赞同：1
> 
> 时间：2012-12-16T20:35:19.077
> 
> 标签：opengl, graphics, computer-vision, gpu

我正在做一个项目，我想在其中有我的顶点缓冲区（在 opengl 中），其中我有构成图像网格的顶点。这意味着图像的每个像素都由两个三角形（一个正方形像素）组成。我想我已经实现了这一点，方法是简单地用图像大小初始化一个窗口，然后有一个带有顶点网格的 vbo 也是图像大小（宽度和高度的网格）。

对于此图像，我还有一个视差/对应图（矢量场），想要对其进行插值并用于使此图像网格变形（使图像/顶点网格变形）。这个想法来自这篇文章[http://graphics.tu-bs.de/media/publications/stich08VTI.pdf](http://graphics.tu-bs.de/media/publications/stich08VTI.pdf)（第5节），这基本上是我想做的。

我想用网格表示图像并通过矢量场对其进行变形以获得新的虚拟视图。这怎么能很容易做到呢？我无法完全理解我应该如何移动顶点着色器中的顶点。

首先，它是像素对应（在矢量场中），但我只能移动顶点，一个顶点属于两个像素，那么我该如何处理（移动像素）？

其次，短语“每个顶点网格变形”是否只是将顶点着色器中的顶点移动了一些坐标（在这种情况下是矢量场）？

第三，如果我设法使网格变形，我如何正确采样原始图像以获得“新视图”？我是否只是通过与图像网格相同的矢量场对一组 UV 坐标进行变形，然后在片段着色器中将原始图像采样为纹理？

# android-mapview - api v2 中的 mapview 和 cameraupdate

> ID：13905230
> 
> 赞同：15
> 
> 时间：2012-12-16T20:35:26.050
> 
> 标签：android-mapview, google-maps-api-2

为什么 CameraUpdateFactory 类在我的项目中不起作用？如果执行以下命令，应用程序将崩溃：CameraUpdate pino= CameraUpdateFactory.newLatLng(new LatLng(location.getLatitude(), location.getLongitude())); 如果我删除该行（当然还有下一行），代码会成功启动并显示地图。我需要 mapView 并且需要使用新的 api v2。我以这种方式在布局中声明 mapView：

```
 <com.google.android.gms.maps.MapView
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:map="http://schemas.android.com/apk/res-auto"

    android:id="@+id/mappa"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_below="@+id/buttonBar"

    map:uiZoomControls="false"
     /> 
```

然后在 mainActivity.java 我写了这个：

```
 public class MainActivity extends FragmentActivity    implements LocationListener, LocationSource { 
public static boolean locatingMe=true;
public GoogleMap mappa;
public MapView mapView;
private OnLocationChangedListener onLocationChangedListener;
private LocationManager locationManager;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mapView = (MapView) findViewById(R.id.mappa);
    mapView.onCreate(savedInstanceState);

        locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);

    //You may want to pass a different provider in as the first arg here
    //depending on the location accuracy that you desire
    //see LocationManager.getBestProvider()
    Criteria locationCriteria = new Criteria();
    locationCriteria.setAccuracy(Criteria.NO_REQUIREMENT);
    locationManager.requestLocationUpdates(locationManager.getBestProvider(locationCriteria, true), 1L, 2F, this);

    if (mappa == null) {
        mappa=mapView.getMap();
        //This is how you register the LocationSource
        mappa.setLocationSource(this);
        mappa.getUiSettings().setMyLocationButtonEnabled(false);
        mappa.setMyLocationEnabled(true);
    }

}
@Override
public void onPause()
{
    if(locationManager != null)
    {
        locationManager.removeUpdates(this);
    }
    mapView.onPause();
    super.onPause();
}

@Override
public void onResume()
{
      checkGooglePlayServicesAvailability();
      checkGps();
      mapView.onResume();
      super.onResume();
}
@Override
protected void onDestroy() {
    mapView.onDestroy();
    super.onDestroy();
}

@Override
public void onLowMemory() {
    super.onLowMemory();
    mapView.onLowMemory();
}

@Override
public void activate(OnLocationChangedListener listener) 
{
    onLocationChangedListener = listener;
}

@Override
public void deactivate() 
{
    onLocationChangedListener = null;
}

@Override
public void onLocationChanged(Location location) 
{
    if( onLocationChangedListener != null )
    {
        onLocationChangedListener.onLocationChanged( location );

        //Move the camera to the user's location once it's available!
        //only if locatingMe is true
        if (locatingMe) {
            if (mappa!=null){
                CameraUpdate pino= CameraUpdateFactory.newLatLng(new LatLng(location.getLatitude(), location.getLongitude()));
                        mappa.animateCamera(pino);

            }

        }

    }
}

@Override
public void onProviderDisabled(String provider) 
{
    // TODO Auto-generated method stub
    Toast.makeText(this, "provider disabled", Toast.LENGTH_SHORT).show();
}

@Override
public void onProviderEnabled(String provider) 
{
    // TODO Auto-generated method stub
    Toast.makeText(this, "provider enabled", Toast.LENGTH_SHORT).show();
}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) 
{
    // TODO Auto-generated method stub
    Toast.makeText(this, "status changed", Toast.LENGTH_SHORT).show();
} 
```

LogCat 中的错误如下：

```
 Caused by: java.lang.NullPointerException: CameraUpdateFactory is not initialized. 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-12-17T15:18:39.073

我通过在“onCreate”上添加以下几行来解决问题：

```
 try {
     MapsInitializer.initialize(this);
 } catch (GooglePlayServicesNotAvailableException e) {
     e.printStackTrace();
 } 
```

原因是 CameraUpdateFactory 需要被初始化（即使从文档中看起来使用 mapview 它应该被自动初始化）

我什至将“公共类 MainActivity 扩展 FragmentActivity”替换为“公共类 MainActivity 扩展 Activity”。但我认为这最后一件事是不需要的..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-17T12:07:10.380

如果我使用：

```
try {
 MapsInitializer.initialize(this);
} catch (GooglePlayServicesNotAvailableException e) {
 e.printStackTrace();
} 
```

异常给了我这个错误：

```
Unreachable catch block for GooglePlayServicesNotAvailableException. 
```

这个异常永远不会从 try 语句体中抛出”。

我只使用：

```
MapsInitializer.initialize(this); 
```

:)

# c# - C# - 将多行文本框保存到文本文件

> ID：13905231
> 
> 赞同：1
> 
> 时间：2012-12-16T20:35:27.420
> 
> 标签：c#, list, multiline, savefiledialog

我正在创建一个供个人使用的小应用程序，它允许我清理我的对象列表。我正在使用各种过滤器在多行文本框中获取最终列表。完成后，我使用以下代码将文本框复制到剪贴板。

```
 #region COPY BUTTON
    private void button3_Click(object sender, EventArgs e)
    {
        Clipboard.SetText(textBox_ListDestination.Text);
    }
    #endregion 
```

我现在想做的是添加另一个按钮，允许我使用 SaveFileDialog 将相同的文本保存到 .txt 文件中。谁能帮我这个？我假设我会使用某种类型的 Streaming，但我在这里没有我的元素。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-16T20:39:33.580

尝试

```
File.WriteAllText (TargetFilePath, textBox_ListDestination.Text); 
```

有关包括示例代码在内的更多信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.io.file.writealltext.aspx)。

如果您想`TargetFilePath`通过`SaveFileDialog`查看[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.savefiledialog.aspx)获得。

更新

示例代码使用`SaveFileDialog`：

```
 if(saveFileDialog1.ShowDialog() == DialogResult.OK)
 {
     File.WriteAllText (saveFileDialog1.FileName, textBox_ListDestination.Text);
 } 
```

# php - 图片上传说它的工作，但没有文件

> ID：13905235
> 
> 赞同：0
> 
> 时间：2012-12-16T20:35:38.867
> 
> 标签：php, mysql, ftp

我使用教程仅将图像上传到我的服务器我似乎无法让它实际将图像放置在我服务器上的文件夹中？

我有以下...

```
if (isset($_POST['submit'])) { 

$allowedExts = array("jpg", "jpeg", "gif", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/png")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
&& ($_FILES["file"]["size"] < 20000)
&& in_array($extension, $allowedExts))
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br>";
    }
  else
    {
    echo "Upload: " . $_FILES["file"]["name"] . "<br>";
    echo "Type: " . $_FILES["file"]["type"] . "<br>";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br>";

    if (file_exists("/upload/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],
      "/upload/" . $_FILES["file"]["name"]);
      echo "Stored in: " . "/upload/" . $_FILES["file"]["name"];
      }
    }
  }
else
  {
  echo "Invalid file";
  }

  }; 
```

任何人都可以看到有什么问题吗？正如我所说，我收到一条成功消息，但正确的文件夹中似乎没有任何内容......

* * *

**html**

```
<form action="#" method="post" enctype="multipart/form-data">
<label for="file">Filename:</label>
<input type="file" name="file" id="file"><br>
<input type="submit" name="submit" value="Submit">
</form>

Array
(
[file] => Array
    (
        [name] => Screen shot 2012-12-16 at 8.40.49 PM.png
        [type] => image/png
        [tmp_name] => /tmp/phpVr7glY
        [error] => 0
        [size] => 6289
    )

) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:41:41.330

这对我来说似乎是一个路径问题。您是否尝试将路径更改为“上传/”：

```
move_uploaded_file($_FILES["file"]["tmp_name"], "upload/" . $_FILES["file"]["name"]); 
```

当然，名称是上传而不是上传或类似的东西。

相对路径和绝对路径可能有些棘手，老实说，我真的不记得例如 apache/php 如何处理绝对路径。

这也是假设您在 Linux 上并使用 apache，如果您在 Windows 上并使用 ISS，我记得临时文件夹有问题。但是，我没有适合您的解决方案。

好的，所以在查看了一段时间并最终测试它之后。似乎在explode的返回值上调用end导致了所有问题。所以如果你把它改成这样，它应该可以工作：

```
$parts = explode(".", $_FILES["file"]["name"]);
$extension = $parts[sizeof($parts)-1]; 
```

错误输出是这样的：

> 严格的标准：只有变量应该通过引用传递：

因此，请查看您的错误报告并尝试安装像 xdebug 这样的调试器。

# javascript - “检查一个字母是否是元音” - 函数返回假？

> ID：13905237
> 
> 赞同：4
> 
> 时间：2012-12-16T20:35:58.623
> 
> 标签：javascript

练习：编写一个函数，接收一个字符（即长度为 1 的字符串），如果它是元音则返回 true，否则返回 false。

我的代码：

```
var findVowel = function(letter) {

var vowels = ["a", "e", "i", "o", "u"];

for(var i in vowels){

    if(letter === i){
        return true;
    } else {
        return false;
    }
}

};

findVowel("e"); 
```

我研究了高低，对我来说，代码看起来好像应该，但无论是否给出元音，它都会返回 false。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-16T20:42:58.557

不要将 for..in 循环与数组一起使用。`i`是索引而不是值。此外，您的代码只会检查字母“a”。它永远不会进入循环的下一次迭代，因为它总是在第一次迭代后返回 true 或 false。

您需要将 return false 移到循环之后，这样它只会在检查完所有元音后才返回 false。

您还应该切换到更“传统”的 for..loop 样式。

我什至不会进入整个“'y'是元音吗？” 问题” ：）

这是固定的代码：

```
var findVowel = function(letter) {

    var vowels = ["a", "e", "i", "o", "u"];

    for(var i = 0; i < vowels.length; i++){ // don't use for...in with Arrays
        if(letter === vowels[i]){// Use array indexing instead
            return true;
         }
    }

    return false;// This is after the loop

}; 
```

试试看：http: [//jsfiddle.net/adamzr/3yhFS/](http://jsfiddle.net/adamzr/3yhFS/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:41:30.977

只需使用它，无需循环任何内容：

```
var findVowel = function(letter) {
    return "aeiou".indexOf(letter) != -1; // return if the letter is found in "aeiou"
}; 
```

或者，我个人最喜欢的：

```
var findVowel = function(letter) {
    return ~"aeiou".indexOf(letter);
}; 
```

`.indexOf()`如果在字符串中找不到参数，则返回`-1`，否则返回参数在字符串中的位置（从`0`to的 int `string length - 1`）。

所以在第一个示例中，如果`.indexOf()`返回`-1`，则该字母不是元音。如果它返回任何其他值，它就是。（因此`!= -1`）。

这`~`是一个按位非，反转该输出：
`-1`变成`0`--> 一个假值。
`X`（其中 X 为正或 0）变为`-(X+1)`--> 一个真实的值。

这样，如果字母是元音，该函数将返回 true-ish，如果不是，则返回 false-ish。

如果您需要“严格”布尔输出，请将其替换为`return`：

```
return !!~"aeiou".indexOf(letter); 
```

这`!!`是一个双布尔值`NOT`（因此，将布尔值反转两次），这会将 True-ish 值转换为 a `true`，并将 false-ish 值 ( `0`) 转换为 a `false`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T20:42:59.237

您仅将元音中的第一个元素与给定字母进行比较并返回该结果。相反，您必须遍历整个数组，看看是否有任何元音匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T20:38:57.973

`i`是 的迭代器中的当前索引`vowels`，而不是当前元音，因此：

```
if(letter === vowels[i]) ... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-18T12:59:37.403

尝试

```
function checkIfVowel(vowel) {  
  return /[aeiouAEIOU]/.test(vowel); 
} 
```

该函数接受一个字符参数并通过正则表达式检查它是否为元音，最后返回相应的值（真或假）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-08T12:32:42.223

您也可以将`.charAt`方法与方法一起使用`.toLowerCase`。

```
function vowelChecker(x) {
    // vowelChecker will grab the first letter (character)...
    var firstChar = x.toLowerCase().charAt(0);

    // Then check if that first letter is a vowel.
    if (firstChar === "a" || firstChar === "e" || firstChar === "i" || firstChar === "o" || firstChar === "u") {
        // If so... it will log true.
        console.log(true);
    } else {
        // If not... it will log false.
        console.log(false);
    }
} 
```

# php - 带有自定义值的php邮件功能

> ID：13905239
> 
> 赞同：1
> 
> 时间：2012-12-16T20:36:16.787
> 
> 标签：php, email

为什么这会发送电子邮件？

```
 $from_admin = $_POST[EMAIL]; 
 $message_admin = 'some html...';
 mail($to_admin,"subject",$message_admin,"FROM:$from_admin"); 
```

这封电子邮件看起来像是来自我的 gmail 帐户。

虽然这不会发送电子邮件。

```
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$headers .= 'To:' . $to . "\r\n";
$headers .= 'From: Registration <register@myserver.org>' . "\r\n";

mail($to, $subject, $message, $headers); 
```

当我联系我的托管支持时，他们说我需要进行 SMTP 身份验证。但是，那为什么第一个邮件功能会起作用呢？如果它实际上不使用该服务器，我会没问题，但人们可以回复 html 电子邮件并仍然到达正确的帐户。有没有办法解决？

# php - PHP/Joomla“脚本头过早结束：cgi_wrapper”

> ID：13905242
> 
> 赞同：0
> 
> 时间：2012-12-16T20:36:41.980
> 
> 标签：php, apache, joomla, centos, joomla1.5

我的网站出现 500 内部服务器错误。错误日志显示以下错误：“脚本头过早结束：cgi_wrapper”，在我的 Joomla 应用程序中。

它仅在加载一个特定文件时发生。应用程序/网站的其余部分正常工作。错误日志中没有显示其他相关问题 - 没有指示超时或权限错误。

导致错误的文件是模板/布局文件。此外，我已经确定了一段会导致错误的代码，当它被注释掉时，网站加载得很好。这里是：

```
 if( $question->type == '1' || $question->type == '2' || $question->type == '3' )
    {
        //shuffle items
        $shuffled_items = $this->shuffle_assoc($items);
        $output = '';
        $output .= '<table class="answer-table">';
        $output .= '<tr>';
        $output .= '<td>';
        $output .= '<ul class="answers">';

        foreach($shuffled_items as $item)
        {
            $output .= '<li num=' . $item->num . '>';
            $output .= $item->item;
            $output .= '</li>';
        }

        $output .= '</ul>';
        $output .= '</td>';
        $output .= '</tr>';
        $output .= '</table>';

        $output .= '<table class="answer-table correct-answer" style="display: none">';
        $output .= '<tr>';
        $output .= '<td>';
        $output .= '<p class="question-instructions">Correct Answer:</p>';
        $output .= '<ul class="answers correct-answer">';

        foreach($items as $item)
        {
            $output .= '<li num=' . $item->num . '>';
            $output .= $item->item;
            $output .= '</li>';
        }

        $output .= '</ul>';
        $output .= '</td>';
        $output .= '</table>';

        echo $output;
    } 
```

它使用在 view.html.php 文件中设置的变量 $questions（对于那些了解 Joomla 的人）。似乎是这个变量触发了错误。如果我不分配 $questions 变量，那么模板将加载得很好。

此外，在上面的示例中，它首先测试问题类型（$question->type）。如果 $question->type 不是 1、2 或 3，还有其他代码部分会被触发，并且仍然会产生错误。但为了简洁起见，我省略了其他代码，因为它仅在存在相关问题类型。当上面的代码单独运行时，它会导致错误。

所以，我在这里迷路了。让我感到困惑的是，只有这个模板文件和 $questions 变量会导致错误。其他一切正常。它在我的本地服务器上也运行良好。

差点忘了，使用的是 Joomla 1.5.22、PHP 5.3.3、Apache 2.2.3、Cent OS 5.8。该服务器还运行 Parallels Plesk Panel 10。

我希望有人可以指出我的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T01:59:56.213

检查 /var/log/httpd/suexec_log

和 /var/www/cgi-bin/cgi_wrapper/cgi_wrapper 的权限

它应该是

ls -la /var/www/cgi-bin/cgi_wrapper/cgi_wrapper

-rwxr-xr-x 1 根 5288 2011 年 7 月 14 日 /var/www/cgi-bin/cgi_wrapper/cgi_wrapper

# ios - 在 iOS 上显示或隐藏推送通知是谁的工作？

> ID：13905244
> 
> 赞同：0
> 
> 时间：2012-12-16T20:37:09.180
> 
> 标签：ios, apple-push-notifications

我有一个人们正在测试的 beta 应用程序。有些人说他们“关闭”了“设置”应用中的推送通知，但他们仍然收到通知。我的假设是，如果用户通过设置应用程序关闭了我的应用程序的通知，那么我仍然可以向他们的设备发送通知，并且不会显示通知。

我的处理方式有问题吗？我一直在搜索推送通知文档，但没有找到任何相关信息。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:45:57.280

允许他们是用户的工作。

获取/显示它们是系统的工作。

发送它们是服务器的工作。

# php - 在 tumblr 搜索 API 中访问图像的 url

> ID：13905245
> 
> 赞同：0
> 
> 时间：2012-12-16T20:37:07.913
> 
> 标签：php, json, multidimensional-array, tumblr

我正在尝试使用标签搜索 api 访问为 tumblr 搜索显示的第一张图片的网址。下面是我正在使用的测试搜索的 json。

```
 {
"meta": {
    "status": 200,
    "msg": "OK"
},
"response": [
    {
        "blog_name": "m00tzman",
        "id": 37918165271,
        "post_url": "http://m00tzman.tumblr.com/post/37918165271/test-image-for-tumblr-a…",
        "slug": "test-image-for-tumblr-api-thingy",
        "type": "photo",
        "date": "2012-12-14 18:13:25 GMT",
        "timestamp": 1355508805,
        "state": "published",
        "format": "html",
        "reblog_key": "IwlKk9r4",
        "tags": [
            "g6845e"
        ],
        "highlighted": [ ],
        "note_count": 29,
        "caption": "<p>test image for tumblr api thingy</p>",
        "photos": [
            {
                "caption": "",
                "alt_sizes": [
                    {
                        "width": 500,
                        "height": 628,
                        "url": "http://25.media.tumblr.com/af60fbe390c487125501e50b37781317/tumblr_…"
                    },
                    {
                        "width": 400,
                        "height": 502,
                        "url": "http://25.media.tumblr.com/af60fbe390c487125501e50b37781317/tumblr_…"
                    },
                    {
                        "width": 250,
                        "height": 314,
                        "url": "http://25.media.tumblr.com/af60fbe390c487125501e50b37781317/tumblr_…"
                    },
                    {
                        "width": 100,
                        "height": 126,
                        "url": "http://24.media.tumblr.com/af60fbe390c487125501e50b37781317/tumblr_…"
                    },
                    {
                        "width": 75,
                        "height": 75,
                        "url": "http://24.media.tumblr.com/af60fbe390c487125501e50b37781317/tumblr_…"
                    }
                ],
                "original_size": {
                    "width": 500,
                    "height": 628,
                    "url": "http://25.media.tumblr.com/af60fbe390c487125501e50b37781317/tumblr_…"
                }
            }
        ]
    }
] 
```

}

我的问题是我无法回显“原始大小”图像的 url。到目前为止，这是我的代码：

```
 <?php
    $search = file_get_contents('http://api.tumblr.com/v2/tagged?tag=g6845e&api_key=(api key)');
    $tumblrdata = json_decode($search, true);
    $photos = $tumblrdata['photos']['original_size'];
    $url = $photos['url'];
    echo $url;
    ?> 
```

对这里出了什么问题有任何猜测吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T04:46:27.403

尝试

```
$photos = $tumblrdata['response']['photos'][0]['original_size']; 
```

# youtube - Youtube订阅按钮的回调

> ID：13905246
> 
> 赞同：0
> 
> 时间：2012-12-16T20:37:16.150
> 
> 标签：youtube, youtube-api

如果用户通过订阅中心 ( [http://www.youtube.com/t/creators_downloads](http://www.youtube.com/t/creators_downloads) ) 按钮订阅 youtube 频道，有没有办法获得回调？在链接上单击并不能保证用户已订阅。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-08T21:40:06.997

原来他们现在添加了一个回调。

[https://developers.google.com/youtube/youtube_subscribe_button#Handling_Events](https://developers.google.com/youtube/youtube_subscribe_button#Handling_Events)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T19:02:51.067

抱歉，目前该按钮周围没有 API。

# jquery - 使用 PhoneGap 显示“返回”按钮

> ID：13905251
> 
> 赞同：0
> 
> 时间：2012-12-16T20:38:28.563
> 
> 标签：jquery, iphone, ios, jquery-mobile, cordova

我正在使用PhoneGap 开发一个带有HTML5、CSS 和jQuery 的iPhone 应用程序。但是，我对 PhoneGap 或 MWE 的理解似乎存在一些问题。

我使用了来自 codeforest.net 的以下代码：

```
<!DOCTYPE html>
<html>
    <head>
        <title>jQuery Mobile Tutorial on Codeforest.net</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0a1/jquery.mobile-1.0a1.min.css" />
        <script src="http://code.jquery.com/jquery-1.4.3.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.0a1/jquery.mobile-1.0a1.min.js"></script>
    </head>

    <body>

        <!-- Start of first page -->
        <div data-role="page" id="first">

            <div data-role="header">
                <h1>First</h1>
            </div><!-- /header -->

            <div data-role="content">
                <p>The content</p>
                <p>View internal page called <a href="#second">second</a></p>
            </div><!-- /content -->

            <div data-role="footer">
                <h4>Page Footer</h4>
            </div><!-- /footer -->
        </div><!-- /page -->

        <!-- Start of second page -->
        <div data-role="page" id="second">

            <div data-role="header">
                <h1>Second</h1>
            </div><!-- /header -->

            <div data-role="content">
                <p>I'm the second content</p>
                <p><a href="#first">Back to first</a></p>   
            </div><!-- /content -->

            <div data-role="footer">
                <h4>Page Footer</h4>
            </div><!-- /footer -->
        </div><!-- /page -->
    </body>
</html> 
```

在其单独的文件中启动代码将导致所需的行为（仅显示第一个`div`，`id="first"`当单击链接时，第二个页面加载时顶部有一个后退按钮）。

我想我可以使用 PhoneGap 将这个 HTML/CSS/JS 示例转换为工作 iOS 应用程序。

我从一开始就遇到的问题是我想要几个不同的`.html`文件，它们相互引用。这可行，但存在`back-button`标题中未显示本机的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T22:11:49.143

然后创建自己的后退按钮。

这部分代码将为您创建一个后退按钮：

```
<a class="ui-btn-left" data-icon="arrow-l" href="javascript:history.back(1) " data-theme="a">Back</a> 
```

这是一个 jsFiddle 示例：http: [//jsfiddle.net/Gajotres/ddsrx/](http://jsfiddle.net/Gajotres/ddsrx/)。它使用一个包含多个页面的文件，但它也可以处理几个单独的 html 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-11T15:18:28.983

原始提问者发布的答案（作为问题的更新-我已将其移至此处，因此在答案中）：

> 问题是应用程序无法从外部链接加载代码。在这里找到的解决方案：[外部链接或网址在 phonegap 上不起作用](https://stackoverflow.com/questions/7752732/external-links-or-url-doesnt-work-on-phonegap)

# javascript - 这个正则表达式是什么意思：/[\[\.]/

> ID：13905254
> 
> 赞同：0
> 
> 时间：2012-12-16T20:39:00.697
> 
> 标签：javascript, regex

这个正则表达式是什么意思？

```
var re = /[\[\.]/; 
```

感谢您的回复。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-16T20:40:12.797

`Javascript`? 这意味着匹配两个字符中的任何一个，`[`或者`.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:45:41.980

你应该先自己阅读。谷歌它，也检查这个。[https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions]

# javascript - 如何更改复合 svg 对象的颜色

> ID：13905255
> 
> 赞同：0
> 
> 时间：2012-12-16T20:39:11.680
> 
> 标签：javascript, svg

我有一个带有阴影和高光的复合 svg 对象。有没有办法改变对象的颜色而不必指定对阴影和突出显示的更改？

我尝试使用灰度底层 svg 和顶部的 svg，我可以在其中更改填充和不透明度，但生成的颜色看起来很平。

有没有这样做的图书馆？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T01:01:01.100

我创建了一个算法来循环遍历灰度 svg 的路径，其中路径按阴影（ta，Inkscape）排序，并更改阴影以创建我的彩色图像。

有关有用信息，请参阅此处的[着色阴影](https://stackoverflow.com/questions/6615002/given-an-rgb-value-how-do-i-create-a-tint-or-shade)和[rgbToHex 。](https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb/13943454#13943454)

效果很好。但现在我发现要获得“漂亮”的图像，我有 150kb 的 svg 文件（60 个着色路径，每个路径大约 10kb，2 个路径花费 36kb）。不太好，尤其是原始 png 只有 21kb。但谷歌搜索后，似乎移动应用程序大小高达 2gb 是可以的。这意味着我的，即使使用大 png 文件，也可能在 10mb 左右倾斜，应该没问题。

# uiscrollview - 如果翻页未完成，如何修复 uipageviewcontroller exc_bad_access？

> ID：13905257
> 
> 赞同：1
> 
> 时间：2012-12-16T20:39:20.063
> 
> 标签：uiscrollview, exc-bad-access, uipageviewcontroller, page-curl, page-flipping

我的应用程序中出现了 exc_bad_access，但我不知道如何修复它。我刚刚升级到 Xcode 4.5，我的目标是 IOS 5.0。这也是我第一次使用 UIPageViewController。我更喜欢尽可能多地使用故事板。

我正在尝试做的是重新创建一个高尔夫球场翻书，其中包含可以滚动和缩放的图像。我现在基本上已经有了几个主要工作的教程的混搭；

1）我设置了一个 UIPageviewController，它加载了一个 UIScrollview，它向它添加了一个 imageView。2）通过手势或点击翻转正在工作，滚动正在工作，我有捏缩放工作和自定义单指和两指点击以放大/缩小。3) 当您开始用滑动手势翻页，然后松开手指时，会出现崩溃。这基本上取消了翻转，但随后一条消息被发送到一个僵尸对象。

这是我的“GuideViewController.h”，它充当数据源和根。

```
#import <UIKit/UIKit.h>
#import "YardageHoleViewController.h"

@interface GuideViewController : UIViewController <UIPageViewControllerDataSource>

@property (strong, nonatomic) UIPageViewController *pageController;
@property (strong, nonatomic) NSArray *pageContent;

- (YardageHoleViewController *)viewControllerAtIndex:(NSUInteger)index storyboard (UIStoryboard *)storyboard;
- (NSUInteger)indexOfViewController:(YardageHoleViewController *)viewController;

@end 
```

这是实施

```
#import "GuideViewController.h"
#import "GolfCourseAppDelegate.h"
#import "Hole.h"
@interface GuideViewController ()
@end

@implementation GuideViewController
@synthesize pageContent = _pageContent;
@synthesize pageController = _pageController;

- (void)viewWillDisappear:(BOOL)animated
{
[[[GolfCourseAppDelegate sharedDelegate] locationManager] stopUpdatingLocation];
}

- (void)viewDidLoad
{
[super viewDidLoad];
[[[GolfCourseAppDelegate sharedDelegate] locationManager] startUpdatingLocation];
[self createContentPages];

NSDictionary *options =
[NSDictionary dictionaryWithObject:
 [NSNumber numberWithInteger:UIPageViewControllerSpineLocationMin]
                            forKey: UIPageViewControllerOptionSpineLocationKey];

self.pageController = [[UIPageViewController alloc]
initWithTransitionStyle:UIPageViewControllerTransitionStylePageCurl navigationOrientation:UIPageViewControllerNavigationOrientationVertical options: options];

//self.pageController.delegate = self;

self.pageController.dataSource = self;
[[self.pageController view] setFrame:[[self view] bounds]];

YardageHoleViewController *initialViewController = [self viewControllerAtIndex:0 storyboard:self.storyboard];

NSArray *viewControllers = [NSArray arrayWithObject:initialViewController];

[self.pageController setViewControllers:viewControllers
                         direction:UIPageViewControllerNavigationDirectionForward
                          animated:NO
                        completion:NULL];

[self addChildViewController:self.pageController];
[[self view] addSubview:[self.pageController view]];
[self.pageController didMoveToParentViewController:self];

}

- (YardageHoleViewController *)viewControllerAtIndex:(NSUInteger)index storyboard:(UIStoryboard *)storyboard
{
NSLog(@"getting data view controller at index: %d", index);
// Return the data view controller for the given index.
if (([self.pageContent count] == 0) || (index >= [self.pageContent count])) {
    return nil;
}

// Create a new view controller and pass suitable data.
YardageHoleViewController *yardageHoleViewController = [storyboard instantiateViewControllerWithIdentifier:@"YardageHoleViewController"];
yardageHoleViewController.dataObject = [self.pageContent objectAtIndex:index];
return yardageHoleViewController;
}

- (NSUInteger)indexOfViewController:(YardageHoleViewController *)viewController
{
// Return the index of the given data view controller.
// For simplicity, this implementation uses a static array of model objects and the view controller stores the model object; you can therefore use the model object to identify the index.
NSLog(@"returning indexOfViewController : %d", [self.pageContent indexOfObject:viewController.dataObject]);
return [self.pageContent indexOfObject:viewController.dataObject];
}

#pragma mark - Page View Controller Data Source

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerBeforeViewController:(UIViewController *)viewController
{
NSLog(@"getting view controller before view controller");
NSUInteger index = [self indexOfViewController:(YardageHoleViewController *)viewController];
if ((index == 0) || (index == NSNotFound)) {
    return nil;
}

index--;
return [self viewControllerAtIndex:index storyboard:viewController.storyboard];
}

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerAfterViewController:(UIViewController *)viewController
{
NSLog(@"getting view controller After view controller");
NSUInteger index = [self indexOfViewController:(YardageHoleViewController *)viewController];
if (index == NSNotFound) {
    return nil;
}

index++;
if (index == [self.pageContent count]) {
    return nil;
}
return [self viewControllerAtIndex:index storyboard:viewController.storyboard];
}

- (void) createContentPages
{
NSLog(@"creating content Pages");
int totalHoles = [[[GolfCourseAppDelegate appData] objectForKey:@"holes"] count];

NSMutableArray *holeData = [[NSMutableArray alloc] init];
for (int i = 1; i < totalHoles+1; i++)
{
    Hole *newHole = [[Hole alloc] initWithHoleNumber:i imageUrl:[NSString stringWithFormat:@"hole%@%d.jpg", (i < 10) ? @"0" : @"", i]];
    NSLog(@"Hole image url:%@",newHole.imageUrl);
    //int holeNumber = i;
    //NSString *imageUrl = [NSString stringWithFormat:@"hole%@%d.jpg", (i < 10) ? @"0" : @"", i];
   [holeData addObject:newHole];
}

self.pageContent = [[NSArray alloc] initWithArray:holeData];
NSLog(@"count of holeData %d", self.pageContent.count);
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}
@end 
```

现在对于视图，我们正在浏览“YardageHoleViewController.h”

```
#import <UIKit/UIKit.h>
#import <MediaPlayer/MediaPlayer.h>
#import <CoreLocation/CoreLocation.h>

@interface YardageHoleViewController : UIViewController <UIScrollViewDelegate, CLLocationManagerDelegate>

@property (strong, nonatomic) IBOutlet UIScrollView *scrollView;
@property (assign, nonatomic) int hole;
@property (assign, nonatomic) int totalHoles;
@property (strong, nonatomic) id dataObject;
@property (strong, nonatomic) IBOutlet UILabel *frontLabel;
@property (strong, nonatomic) IBOutlet UILabel *middleLabel;
@property (strong, nonatomic) IBOutlet UILabel *backLabel;
- (IBAction)nextPage:(id)sender;
- (IBAction)previousPage:(id)sender;
- (IBAction)infoPage:(id)sender;
- (IBAction)homePage:(id)sender;

- (void)updateDistanceDisplay;
- (NSString *)formatDistance:(NSNumber *)distance;

@end 
```

在这里你可以看到我有一些事情正在发生。有一些子视图可以根据位置等显示到杯子的距离。您还可以看到一些插座，除了手势之外，我还想在顶部有按钮进行导航，现在这不起作用，因为手势覆盖了按钮点击（稍后的另一个问题）。

所以这里是肉和土豆'YardageHoleViewController.m'

```
#import "YardageHoleViewController.h"
#import "GolfCourseAppDelegate.h"
#import "Hole.h"

@interface YardageHoleViewController ()
@property (nonatomic, strong) UIImageView *imageView;
- (void)centerScrollViewContents;
- (void)scrollViewDoubleTapped:(UITapGestureRecognizer*)recognizer;
- (void)scrollViewTwoFingerTapped:(UITapGestureRecognizer*)recognizer;
@end

@implementation YardageHoleViewController
@synthesize scrollView = _scrollView;
@synthesize hole = _hole;
@synthesize totalHoles = _totalHoles;
@synthesize imageView = _imageView;
@synthesize frontLabel = _frontLabel;
@synthesize middleLabel = _middleLabel;
@synthesize backLabel = _backLabel;
@synthesize dataObject = _dataObject;

/* The point of this method is to get around a slight annoyance with UIScrollView, which is: if the scroll view content size is smaller than its bounds, then it sits at the top-left rather than in the center. This method  positions the image view such that it is always in the center of the scroll view’s bounds.
 */
- (void)centerScrollViewContents {
CGSize boundsSize = self.scrollView.bounds.size;
CGRect contentsFrame = self.imageView.frame;

if (contentsFrame.size.width < boundsSize.width) {
    contentsFrame.origin.x = (boundsSize.width - contentsFrame.size.width) / 2.0f;
} else {
    contentsFrame.origin.x = 0.0f;
}

if (contentsFrame.size.height < boundsSize.height) {
    contentsFrame.origin.y = (boundsSize.height - contentsFrame.size.height) / 2.0f;
} else {
    contentsFrame.origin.y = 0.0f;
}

self.imageView.frame = contentsFrame;
}

- (void)scrollViewDoubleTapped:(UITapGestureRecognizer*)recognizer {
CGPoint pointInView = [recognizer locationInView:self.imageView];
CGFloat newZoomScale = self.scrollView.zoomScale * 1.5f;
newZoomScale = MIN(newZoomScale, self.scrollView.maximumZoomScale);
CGSize scrollViewSize = self.scrollView.bounds.size;
CGFloat w = scrollViewSize.width / newZoomScale;
CGFloat h = scrollViewSize.height / newZoomScale;
CGFloat x = pointInView.x - (w / 2.0f);
CGFloat y = pointInView.y - (h / 2.0f);
CGRect rectToZoomTo = CGRectMake(x, y, w, h);
[self.scrollView zoomToRect:rectToZoomTo animated:YES];
}

- (void)scrollViewTwoFingerTapped:(UITapGestureRecognizer*)recognizer {
// Zoom out slightly, capping at the minimum zoom scale specified by the scroll view
CGFloat newZoomScale = self.scrollView.zoomScale / 1.5f;
newZoomScale = MAX(newZoomScale, self.scrollView.minimumZoomScale);
[self.scrollView setZoomScale:newZoomScale animated:YES];
}

- (UIView*)viewForZoomingInScrollView:(UIScrollView *)scrollView {
// Return the view that you want to zoom
return self.imageView;
}

- (void)scrollViewDidZoom:(UIScrollView *)scrollView {
// The scroll view has zoomed, so you need to re-center the contents
[self centerScrollViewContents];
}

- (void)viewDidLoad {
[super viewDidLoad];
Hole *hole = (Hole*)self.dataObject;
self.hole = hole.holeNumber;
UIImage *image = [UIImage imageNamed:hole.imageUrl];
self.imageView = [[UIImageView alloc] initWithImage:image];
self.imageView.frame = (CGRect){.origin=CGPointMake(0.0f, 0.0f), .size=image.size};
[self.scrollView addSubview:self.imageView];
self.scrollView.contentSize = image.size;
//Here you’re setting up two gesture recognizers: one for the double-tap to zoom in, and one for the two-finger-tap to zoom out.
UITapGestureRecognizer *doubleTapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(scrollViewDoubleTapped:)];
doubleTapRecognizer.numberOfTapsRequired = 2;
doubleTapRecognizer.numberOfTouchesRequired = 1;
[self.scrollView addGestureRecognizer:doubleTapRecognizer];

UITapGestureRecognizer *twoFingerTapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(scrollViewTwoFingerTapped:)];
twoFingerTapRecognizer.numberOfTapsRequired = 1;
twoFingerTapRecognizer.numberOfTouchesRequired = 2;
[self.scrollView addGestureRecognizer:twoFingerTapRecognizer];
[[[GolfCourseAppDelegate sharedDelegate] locationManager] setDelegate:self];
[self updateDistanceDisplay];

self.totalHoles = [[[GolfCourseAppDelegate appData] objectForKey:@"holes"] count];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(didRotate:) name:@"UIDeviceOrientationDidChangeNotification" object:nil];
}

- (void)viewWillAppear:(BOOL)animated {
[super viewWillAppear:animated];

CGRect scrollViewFrame = self.scrollView.frame;
CGFloat scaleWidth = scrollViewFrame.size.width / self.scrollView.contentSize.width;
self.scrollView.minimumZoomScale = scaleWidth;
self.scrollView.maximumZoomScale = 1.5f;
self.scrollView.zoomScale = scaleWidth;
[self centerScrollViewContents];
}

- (void) didRotate:(NSNotification *)notification {
UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation];

if (orientation == UIDeviceOrientationLandscapeLeft || orientation == UIDeviceOrientationLandscapeRight) {
    [[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleBlackTranslucent];
    NSString *moviePath = [[NSBundle mainBundle] pathForResource:[NSString stringWithFormat:@"hole%@%d", (self.hole < 10) ? @"0" : @"", self.hole] ofType:@"mp4"];
    MPMoviePlayerViewController *viewController = [[MPMoviePlayerViewController alloc] initWithContentURL:[NSURL fileURLWithPath:moviePath]];
    viewController.moviePlayer.controlStyle = MPMovieControlStyleNone;
    viewController.view.backgroundColor = [UIColor blackColor];
    [self presentMoviePlayerViewControllerAnimated:viewController];
} else {
    [self dismissMoviePlayerViewControllerAnimated];
}
}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
[self updateDistanceDisplay];
}

- (void) updateDistanceDisplay {

CLLocation *userLocation = [[GolfCourseAppDelegate sharedDelegate] userLocation];

if (userLocation != nil) {
    NSMutableDictionary *holeLocations = [[[GolfCourseAppDelegate appData] objectForKey:@"holes"] objectForKey:[NSString stringWithFormat:@"hole%d", self.hole]];

    if (round([[[holeLocations objectForKey:@"front"] objectForKey:@"lat"] floatValue]) == 0) {
        self.frontLabel.text = @"---";
    } else {
        CLLocation *frontLocation = [[CLLocation alloc] initWithLatitude:[[[holeLocations objectForKey:@"front"] objectForKey:@"lat"] floatValue] longitude:[[[holeLocations objectForKey:@"front"] objectForKey:@"lng"] floatValue]];
        if (([frontLocation distanceFromLocation:userLocation]/1000)>1000){
            self.frontLabel.text = @"Out of Range";
        }else{
        self.frontLabel.text = [self formatDistance:[NSNumber numberWithFloat:([frontLocation distanceFromLocation:userLocation]/1000)]];
        }
    }

    if (round([[[holeLocations objectForKey:@"middle"] objectForKey:@"lat"] floatValue]) == 0) {
        self.middleLabel.text = @"---";
    } else {
        CLLocation *middleLocation = [[CLLocation alloc] initWithLatitude:[[[holeLocations objectForKey:@"middle"] objectForKey:@"lat"] floatValue] longitude:[[[holeLocations objectForKey:@"middle"] objectForKey:@"lng"] floatValue]];
        self.middleLabel.text = [self formatDistance:[NSNumber numberWithFloat:([middleLocation distanceFromLocation:userLocation]/1000)]];

    }

    if (round([[[holeLocations objectForKey:@"back"] objectForKey:@"lat"] floatValue]) == 0) {
        self.backLabel.text = @"---";
    } else {
        CLLocation *backLocation = [[CLLocation alloc] initWithLatitude:[[[holeLocations objectForKey:@"back"] objectForKey:@"lat"] floatValue] longitude:[[[holeLocations objectForKey:@"back"] objectForKey:@"lng"] floatValue]];
        self.backLabel.text = [self formatDistance:[NSNumber numberWithFloat:([backLocation distanceFromLocation:userLocation]/1000)]];

    }
}
}

- (NSString *) formatDistance:(NSNumber *)distance {

NSNumber *displayDistance;
NSString *unitSuffix = @"";

// Convert km to yards if prefs say so.
NSUserDefaults *preferences = [NSUserDefaults standardUserDefaults];

if ([[preferences stringForKey:@"measurementUnit"] isEqualToString:@"meters"]) {

    distance = [NSNumber numberWithFloat:([distance floatValue]*1000.0)];
    if ([distance floatValue] < 1000.0) {
        displayDistance = distance;
        unitSuffix = @"";
    } else {
        displayDistance = [NSNumber numberWithFloat:([distance floatValue]/1000.0)];
        unitSuffix = @"km";
    }

} else {

    distance = [NSNumber numberWithFloat:([distance floatValue]*1.0936133*1000.0)];
    if ([distance floatValue] < 1760.0) {
        displayDistance = distance;
        unitSuffix = @"";
    } else {
        displayDistance = [NSNumber numberWithFloat:([distance floatValue]/1760.0)];
        unitSuffix = @"mi";
    }

}

NSNumberFormatter *decimalStyle = [[NSNumberFormatter alloc] init];
[decimalStyle setFormatterBehavior:NSNumberFormatterBehavior10_4];
[decimalStyle setNumberStyle:NSNumberFormatterDecimalStyle];
[decimalStyle setRoundingMode:NSNumberFormatterRoundFloor];
[decimalStyle setRoundingIncrement:[NSNumber numberWithFloat:1.0]];

NSString *finalDistance = [decimalStyle stringFromNumber:displayDistance];

return [NSString stringWithFormat:@"%@%@", finalDistance, unitSuffix];
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
}

- (void)viewDidUnload {
[self setImageView:nil];
[self setScrollView:nil];
[self setFrontLabel:nil];
[self setBackLabel:nil];
[self setBackLabel:nil];
[self setFrontLabel:nil];
[self setMiddleLabel:nil];
[super viewDidUnload];
}
- (IBAction)nextPage:(id)sender {
//TODO
// [((UIPageViewController*)self.parentViewController) setViewControllers:
// target direction:UIPageViewControllerNavigationForward completion:nil];
}

- (IBAction)previousPage:(id)sender {
//TODO
//  [((UIPageViewController*)self.parentViewController) setViewControllers:<#(NSArray *)#> direction:UIPageViewControllerNavigationDirectionReverse animated:true completion:nil];
}

- (IBAction)infoPage:(id)sender {
//TODO
}

- (IBAction)homePage:(id)sender {
[self.navigationController popViewControllerAnimated:YES];
}
@end 
```

哇！大量阅读。所以我首先尝试的是设置异常断点。没运气。然后我添加了很多 NSlog 语句来查看我们崩溃的位置，最后在仪器中寻找僵尸。在这里，我们在 YardageHoleViewController 中的 malloc 上看到“一条 Objective-C 消息已发送到地址为 0x1386e0e0 的已释放对象（僵尸）”。

从我的 NSLog 语句中，我可以看到成功的翻页看起来像这样；2012-12-16 13:33:52.280 BAP 模板 [1365:13a03] 获取索引处的数据视图控制器：0 //从此处开始翻转 > 2012-12-16 13:34:06.289 BAP 模板 [1365:13a03] 获取视图控制器在视图控制器 2012-12-16 13:34:06.290 BAP 模板 [1365:13a03] 返回 indexOfViewController 之后：0 2012-12-16 13:34:06.292 BAP 模板 [1365:13a03] 在索引处获取数据视图控制器： 1

这是当您开始翻转然后发布 2012-12-16 13:36:18.613 BAP Template[1365:13a03] 在索引处获取数据视图控制器时发生的情况：0 //开始翻转然后发布 2012-12-16 13： 36:21.828 BAP 模板 [1365:13a03] 获取视图控制器后视图控制器 2012-12-16 13:36:21.829 BAP 模板 [1365:13a03] 返回 indexOfViewController：0 2012-12-16 13:36:21.831 BAP 模板 [ 1365:13a03] 在索引处获取数据视图控制器：1

所以从某种意义上说，它试图表现得好像它完成了翻转，但我们没有，然后就是我们遇到了糟糕的时刻 =(

我已将所有内容设置为强，我真的不知道接下来要尝试什么？

一般来说，对我的代码的任何建议将不胜感激。提前致谢！ ![僵尸简介](../Images/0973ffb9709b41e0c87f8701f2058b3e.png)

**更新**我查看了组织者线程 0 名称中的崩溃日志：调度队列：com.apple.main-thread 线程 0 崩溃：0 libobjc.A.dylib 0x3737bf78 objc_msgSend + 16 1 CoreLocation 0x3405ddc0 -[CLLocationManager onClientEventLocation:] + 1136 2 CoreLocation 0x3405d77e -[CLLocationManager onClientEvent:supportInfo:] + 194 3 CoreLocation 0x34057e38 __CLClientInvokeCallback_block_invoke_0 + 48 我已经注释掉了在 viewDidLoad / willDisappear 中开始/停止更新位置的两行。

不再崩溃，但为什么呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:27:55.767

由于在视图加载时开始位置更新，因此该方法

```
- (void)locationManager:didUpdateToLocation:fromLocation: 
```

在模拟器中被连续调用，就像每秒一样，但是在设备上它只有在检测到运动时才会被调用。该方法内部是调用 [self updateDistanceDisplay]，这就是它崩溃的原因。我实施的修复现在在设备上运行良好，但它不是防弹的。

首先，在 appDelegate 中，我们要修复 locationManager.distanceFilter 以便不是每个小动作都会触发委托方法。

```
self.locationManager.distanceFilter = 1.0f; 
```

接下来，修改 didUpdateToLocation 方法以仅在纬度或经度发生变化时更新显示。

```
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
   if ((newLocation.coordinate.latitude!=oldLocation.coordinate.latitude)||(newLocation.coordinate.longitude!=oldLocation.coordinate.longitude))
       [self updateDistanceDisplay];
} 
```

再次，不是防弹的。有一种情况，假设用户在高尔夫球车中行驶得足够快并试图翻页，我们可能会进入崩溃状态。

# c++ - 使用 next_permutation 访问置换值

> ID：13905262
> 
> 赞同：0
> 
> 时间：2012-12-16T20:39:50.907
> 
> 标签：c++

如何在 while 循环之外使用置换数字进行比较。因为我已经检查过，while 之外的向量与前面定义的相同。

```
void display(vector<int> vec){
    for (int i=0; i<vec.size();i++){
        cout<<vec[i];
    }
}
int main()
{
  vector <int> vec;
  vec.push_back(3);
  vec.push_back(2);
  vec.push_back(1);
  vec.push_back(4);
  sort(vec.begin(), vec.end());
  while (next_permutation( vec.begin(), vec.end() )){
  display(vec);
  cout<<endl;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:01:54.577

以下**完整程序**在 Visual C++ 和 g++ 中都能正常工作：

```
#include <algorithm>
#include <vector>
#include <iostream>
#include <utility>
using namespace std;

template< class Item >
wostream& operator<<( wostream& stream, vector<Item> const& v )
{
    stream << "[";
    for( auto p = v.begin(); p != v.end();  ++p )
    {
        if( p != v.begin() ) { wcout << ", "; }
        wcout << *p;
    }
    stream << "]";
    return stream;
}

int main()
{
    int const   data[]  = {1, 2, 3, 4};
    vector <int> vec( begin( data ), end( data ) ); 
    sort(vec.begin(),vec.end());
    do
    {
        wcout << vec << endl; 
    } while (next_permutation( vec.begin(), vec.end() ) );
} 
```

主要代码与您的代码相同（它被复制和粘贴，并且只是编辑了一点点以添加数据）。

那么，鉴于代码有效，问题到底出在哪里？

* * *

**编辑**：OP现在已经用不同的代码更新了问题，一个`while`循环而不是一个`do`循环，以及调用`next_permutation`和`display`更改的顺序，因此它无法显示原始排列。

给出的新代码，

```
void display(vector<int> vec){
    for (int i=0; i<vec.size();i++){
        cout<<vec[i];
    }
}
int main()
{
  vector <int> vec;
  vec.push_back(3);
  vec.push_back(2);
  vec.push_back(1);
  vec.push_back(4);
  sort(vec.begin(), vec.end());
  while (next_permutation( vec.begin(), vec.end() )){
  display(vec);
  cout<<endl;
} 
```

即使在添加必要的标头和`using namespace std;`.

虽然这只是由于缺少右大括号，但可以通过从工作版本*复制和粘贴代码来避免这种情况。*

这也少了很多工作要做。:-)

# matlab - Matlab：神经网络训练的问题

> ID：13905263
> 
> 赞同：0
> 
> 时间：2012-12-16T20:39:51.537
> 
> 标签：matlab, neural-network

我正在尝试使用 nprtool 和手动训练神经网络，调用 newpr 和 train 方法。**我使用面向行的样本，而不是默认的列**：

![nprtool](../Images/ac75956520b590721ce184a0a398587d.png)

使用 nprtool 没有问题，但是当我调用自动生成的 M 文件时，输出为：

```
??? Error using ==> network.train at 145
Targets are incorrectly sized for network.
Matrix must have 24 columns.

Error in ==> create_pr_net at 29
[net,tr] = train(net,inputs,targets); 
```

我的输入是 140x24，我的目标是 140x3。

Matlab生成的代码为：

```
function net = create_pr_net(inputs,targets)
%CREATE_PR_NET Creates and trains a pattern recognition neural network.
%
%  NET = CREATE_PR_NET(INPUTS,TARGETS) takes these arguments:
%    INPUTS - RxQ matrix of Q R-element input samples
%    TARGETS - SxQ matrix of Q S-element associated target samples, where
%      each column contains a single 1, with all other elements set to 0.
%  and returns these results:
%    NET - The trained neural network
%
%  For example, to solve the Iris dataset problem with this function:
%
%    load iris_dataset
%    net = create_pr_net(irisInputs,irisTargets);
%    irisOutputs = sim(net,irisInputs);
%
%  To reproduce the results you obtained in NPRTOOL:
%
%    net = create_pr_net(inputs,targets);

% Create Network
numHiddenNeurons = 2000;  % Adjust as desired
net = newpr(inputs,targets,numHiddenNeurons);
net.divideParam.trainRatio = 90/100;  % Adjust as desired
net.divideParam.valRatio = 5/100;  % Adjust as desired
net.divideParam.testRatio = 5/100;  % Adjust as desired

% Train and Apply Network
[net,tr] = train(net,inputs,targets);
outputs = sim(net,inputs);

% Plot
plotperf(tr)
plotconfusion(targets,outputs) 
```

我正在使用 Matlab R2010a。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T03:31:50.893

如 Matlab 帮助文件中所述：

INPUTS - Q R 元素输入样本的 RxQ 矩阵 TARGETS - Q S 元素相关目标样本的 SxQ 矩阵

在手动调用 Matlab 训练函数之前，您可能需要输入和目标矩阵的**转置。**

`Input = Input';`和 `Taget = Target';`

# php - 类的 PHP PDO 对象无法转换为字符串

> ID：13905270
> 
> 赞同：2
> 
> 时间：2012-12-16T20:40:46.103
> 
> 标签：php, pdo, smarty

我在 Smarty 中的对象功能上收到以下错误，我不知道如何解决该问题。

错误：

```
Catchable fatal error: Object of class users_class could not be converted to string 
```

这是我正在使用的对象的以下对象和功能。

```
class users_class
{
    public function fetchUser(array $conditions)
    {
        $db = Core::getInstance();
        $sql = "SELECT * FROM ".USERS." WHERE ";
        $i=0;
        $params = array();
        //$where = array();
        foreach ($conditions as $column => $value)
        {
            if (preg_match('/^[a-z-.-_]+$/', $column)) {
                if ($i!=0) {
                    $sql .= " AND ";
                }
                $sql .= "$column = ?";
                $params[] = $value;
                $i++;
            }
        }           
        //$sql .= implode(' AND ', $where);
        //$sql .= " order by title asc";    
        $res = $db->dbh->prepare($sql);
        $res->execute(array_values($params));
        return $res->fetch(PDO::FETCH_ASSOC);               
    }
} 
```

这是 Smarty 中的调用：

```
 {section name=ststval loop=$ststres}
    {if $ststres[ststval].type == 2}
       {assign var='udatas' value="$userObj->fetchUser(array('id'=>$ststres[ststval].to_id));"} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T19:46:51.277

我通过向对象添加 __toString() 方法解决了这个问题。显然，该对象只需要返回一个字符串。这让我很困惑，因为我不知道它应该返回什么，而且 php.net 上的指示也不清楚。对于学习 PHP 的人来说，在寻求帮助时需要解释事情，而不是指向每个人在学习 PHP 时阅读的相同文章。我相信我们会在这样的网站上寻求帮助，因为我们需要有更高知识的人的解释。我称之为懒惰和无益！

类用户类{

```
 protected $users_class='';

public function __toString() {

    return (string)$this->users_class;
}

public function fetchUser(array $conditions)
{
    $db = Core::getInstance();
    $sql = "SELECT * FROM ".USERS." WHERE ";
    $i=0;
    $params = array();
    //$where = array();
    foreach ($conditions as $column => $value)
    {
        if (preg_match('/^[a-z-.-_]+$/', $column)) {
            if ($i!=0) {
                $sql .= " AND ";
            }
            $sql .= "$column = ?";
            $params[] = $value;
            $i++;
        }
    }           
    //$sql .= implode(' AND ', $where);
    //$sql .= " order by title asc";    
    $res = $db->dbh->prepare($sql);
    $res->execute(array_values($params));
    return $res->fetch(PDO::FETCH_ASSOC);               
} 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:16:13.250

要以这种方式将对象转换为字符串，您需要定义一个神奇的[__toString()](http://www.php.net/manual/en/language.oop5.magic.php#object.tostring)方法

# android - android通过3g而不是wifi连接到服务器

> ID：13905272
> 
> 赞同：0
> 
> 时间：2012-12-16T20:40:51.397
> 
> 标签：android, wifi, 3g

我正在寻找创建一个应用程序，该应用程序使用 3g 从手机发送实时视频流以存储在服务器上。

我发现[spydroid](http://code.google.com/p/spydroid-ipcamera/)与我想做的非常相似。浏览代码我才意识到它使用的是 wifi 而不是 3g。

我的问题是我需要更改哪些内容才能使用 3g 而不是 wifi？（我正在寻找通用指针，我不希望您查看实际代码:)）

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T14:09:29.420

这可能与以下内容重复： [如何在 Android 应用程序中使用 3G 连接而不是 Wi-fi？](https://stackoverflow.com/questions/2513713/how-to-use-3g-connection-in-android-application-instead-of-wi-fi). 查看得分最高的答案。

# ios - IOS 上的 Hpple XPath 查询问题

> ID：13905279
> 
> 赞同：0
> 
> 时间：2012-12-16T20:41:50.280
> 
> 标签：ios, xpath, html-parsing, hpple

我有以下 HTML 片段：

```
 <divv id="items">
        <trr>
            <td>
                <p>Cars</p>
                <a>Toyota</a>
                <a>Opel</a>
                <a>Audi</a>
            </td>
        </tr>
        <tr>
            <td>
                <p>Planes</p>
                <a>A320</a>
                <a>B787</a>
                <a>B767</a>
            </td>
        </tr>
    <div/> 
```

我想要的是创建一个 XPath 查询，以便我只能检索汽车。
目前我正在使用这个：`//div[@id='items']/tr/td`. 但有了这个，我也得到了飞机物品。我不知道如何测试“p”标签。

任何人都可以帮助我吗？
谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:17:59.223

```
//div[@id='items']/tr/td[p='Cars'] 
```

最后一个谓词测试`<p>`带有文本内容的子元素的存在，`Cars`从而过滤掉`<td>`with `<p>Planes</p>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:02:38.460

如果选择第一组就足够了，那么您可以使用：

```
//div[@id='items']/tr/td[1] 
```

# javascript - jqGrid - 'in' op 不适用于过滤器

> ID：13905280
> 
> 赞同：2
> 
> 时间：2012-12-16T20:41:53.923
> 
> 标签：javascript, jquery, jqgrid

我有一个简单的演示，它可以在测试分数表上使用“大于”过滤器。[点击这里](http://pastebin.com/ExkDAbsB)可以找到源代码。如果您向下滚动到**var myfilter**，您会看到我已将其中一条规则注释掉。

```
var myfilter = {
    groupOp: "AND",
    rules: [
        {field: 'score', op: 'gt', data: 70},
        //{field: 'grade', op: 'in', data: [10, 11, 12]}
    ]
}; 
```

这条规则说只选择 10、11、12 年级的行。但是，当我取消注释这条规则时，它不起作用。事实上，它甚至打破了桌子。这是一个错误，还是我做错了？

为了清楚起见，我只是想找到一种使用**op: 'in'**功能的方法。jqGrid wiki on search lists **op: 'in'** under the values for **sopt**，所以应该有办法做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:56:59.253

你说的对。当前*本地*搜索的实现不支持`"in"`操作。它只是使用`"eq"`。

所以我建议你使用带有`"eq"`操作的块而不是`"in"`. 您问题中的示例可以重写为以下内容：

```
var myfilter = {
    groupOp: "AND",
    rules: [
        {field: 'score', op: 'gt', data: 70},
    ],
    groups: [
        {
            groupOp: "OR",
            rules: [
                {field: 'grade', op: 'eq', data: 10}
                {field: 'grade', op: 'eq', data: 11}
                {field: 'grade', op: 'eq', data: 12}
            ]
        }
    ]
}; 
```

`filters` [请参阅此处](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:advanced_searching#options)的完整格式说明。

# jquery - jQuery - Textarea - 使用时不要向上滚动

> ID：13905281
> 
> 赞同：1
> 
> 时间：2012-12-16T20:42:00.327
> 
> 标签：jquery, html

我有一个 jQuery 脚本，它向下滚动到文本区域框的末尾。此函数位于基于 Interval 的自动 div 重新加载器（下面的脚本）中。我想这样做，所以当有人在文本区域中滚动时，向下滚动的脚本部分将被停用。

```
var refreshId = setInterval(function()
{
    $('#chatArea').load('run/chatBox.php', function() {     
            $('#chatAreaBox').scrollTop($('#chatAreaBox')[0].scrollHeight);
    });
}, 2500); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:51:11.063

只需检查该`scrollTop`值即可知道用户是否在执行动画之前向下滚动

```
var refreshId = setInterval(function()
{
    $('#chatArea').load('run/chatBox.php', function() {    
            if($('#chatAreaBox').scrollTop === 0)
                $('#chatAreaBox').scrollTop($('#chatAreaBox')[0].scrollHeight);
    });
}, 2500); 
```

您还可以将时间戳（使用`date()`）存储在一个`scroll()`事件中并在您的间隔函数中检查它，然后如果最后一个滚动事件发生在 5 秒以上，则执行动画

```
var timestamp = null;

    $('#chatArea').scroll(function() {    
        var d = new Date();
        timestamp = d.getTime();    
    });

var refreshId = setInterval(function()
{
    $('#chatArea').load('run/chatBox.php', function() { 

        var d = new Date();

            if((d.getTime() - timestamp) > 5000)
                $('#chatAreaBox').scrollTop($('#chatAreaBox')[0].scrollHeight);
    });
}, 2500); 
```

# c++ - Eclipse 多态性使用 C++11 shared_ptr 错误

> ID：13905283
> 
> 赞同：2
> 
> 时间：2012-12-16T20:42:11.497
> 
> 标签：c++, eclipse, c++11, polymorphism, smart-pointers

给定以下示例代码：

```
#include <iostream>
#include <memory>
using namespace std;

struct A {
public:
    A(int aa) : a(aa) {}
    int a;
    virtual ~A() {}
};
struct B : A {
public:
    B(int aa, int bb) : A(aa), b(bb) {}
    int b;
};

void f(shared_ptr<A> a){
    shared_ptr<B> b = dynamic_pointer_cast<B>(a);
    if (b) {
        cout << b->b << endl;
    } else {
        cout << a->a << endl;
    }
}

int main() {
    auto a = make_shared<A>(3);
    auto b = make_shared<B>(7, 4);
    f(a);
    f(b);
    return 0;
} 
```

Eclipse 提示在线有错误

```
f(b); 
```

说`Invalid arguments ' Candidates are: void f(std::shared_ptr<A>) '`
因为a`shared_ptr<B>`已经通过了。这编译并运行，并有输出：

```
3
4 
```

正如预期的那样。

索引器和编译器已指定 -std=c++11。
编译器还`__GXX_EXPERIMENTAL_CXX0X__`定义了符号。

有没有办法摆脱这个错误及其在 Eclipse 中的红色曲线（最好不修改源代码）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-16T20:52:24.630

我建议您在它可能还不支持 C++11 的设置中禁用静态代码分析插件 Codan。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-17T22:57:53.583

这已在 CDT 的更高版本中修复（我刚刚尝试过）。

您可以使用此存储库使用 CDT 的夜间构建：转到帮助，然后输入 URL [http://download.eclipse.org/tools/cdt/builds/kepler/nightly](http://download.eclipse.org/tools/cdt/builds/kepler/nightly)

如果您不想使用夜间构建，您至少应该使用[http://download.eclipse.org/tools/cdt/确保您拥有最新发布的版本（在撰写本文时它是 8.1.1）发布/朱诺/](http://download.eclipse.org/tools/cdt/releases/juno/)

在这里可以找到我使用 C++11 的完整 Eclipse 设置：http: [//scrupulousabstractions.tumblr.com/post/36441490955/eclipse-mingw-builds](http://scrupulousabstractions.tumblr.com/post/36441490955/eclipse-mingw-builds)

# python - 如何使用 Python 在 Google App Engine 中使用应用程序部署图像

> ID：13905290
> 
> 赞同：1
> 
> 时间：2012-12-16T20:42:57.130
> 
> 标签：python, css, image, google-app-engine, deployment

每当我部署我的应用程序时，它都会正确部署，除了我在 main.css 中使用的背景图像没有出现。如果我将其更改为背景颜色，它可以工作，但背景图像无论出于何种原因都不起作用。当我使用 Browse 测试运行时，它可以工作，但是一旦我在 app.yaml 中更改了应用程序名称，Browse 就不起作用，但 Deployment 可以工作，但它不显示背景图像。如何让背景图像显示？

main.CSS 中的代码：

```
body {
  font-family: Comic Sans, Helvetica, sans-serif;
  background-image: url(../stylesheets/goku-wallpaper-2.jpg);
  background-repeat:repeat-x;
} 
```

app.yaml 中的代码：

```
application: guestbooksky
version: 1
runtime: python27
api_version: 1
threadsafe: true

handlers:
- url: /stylesheets
  static_dir: stylesheets  

- url: /.*
  script: helloworld.app

libraries:
- name: jinja2
  version: latest 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:50:10.070

probably:

```
background-image: url(/stylesheets/goku-wallpaper-2.jpg); 
```

if the image file is in the path of:

```
/stylesheets/ 
```

# android - Google Maps API 密钥 v2 是否适合 MapView 元素？

> ID：13905293
> 
> 赞同：0
> 
> 时间：2012-12-16T20:43:23.767
> 
> 标签：android, google-maps, android-mapview, api-key

我已经使用 MapView 元素和自定义逐项叠加创建了应用程序。然后，意外地，我丢失了我的 API 密钥 v1。不幸的是，不可能再获得新的 v1 密钥，我根本不想使用 MapFragment 重写应用程序。MapFragment 不支持 MapView 的大部分 API，这就是问题所在。

我尝试将生成的 v2 密钥插入 MapView 元素，但它不起作用。我不确定这是关键版本的问题还是我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T20:55:58.517

> 然后，意外地，我丢失了我的 API 密钥 v1

然后请停止所有软件开发，直到您了解如何维护开发机器的正确备份。

> 不幸的是，无法再获得新的 v1 密钥

是的。引用[文档](https://developers.google.com/maps/documentation/android/v1/mapkey)：

> Google Maps Android API 版本 1 已于 2012 年 12 月 3 日正式弃用。这意味着从 2013 年 3 月 3 日起，您将无法再请求此版本的 API 密钥。

在撰写本文时，时间是 2013 年 3 月 3 日之前。因此，您可以访问[Maps API 密钥注册页面](https://developers.google.com/maps/documentation/android/v1/maps-api-signup)并请求密钥。

> MapFragment 不支持 MapView 的大部分 API，这就是问题所在

我还没有遇到任何 V2 无法做到的 V1 可以做到的事情。是的，您必须移植您的代码才能使用新的类和方法。不过，您很有可能最终会使用更少的代码。

> 我尝试将生成的 v2 密钥插入 MapView 元素，但它不起作用。

如果您指的`MapView`是 Maps SDK 附加组件的原始版本，则这两个服务使用不同的密钥系统 AFAIK。

# java - 如何使用 JFileChooser 保存 txt 文件？

> ID：13905298
> 
> 赞同：1
> 
> 时间：2012-12-16T20:44:35.023
> 
> 标签：java, swing, file, jfilechooser

鉴于这种方法：

```
public void OutputWrite (BigInteger[] EncryptCodes) throws FileNotFoundException{

    JFileChooser chooser = new JFileChooser();

    chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);  
    chooser.showSaveDialog(null);

    String path = chooser.getSelectedFile().getAbsolutePath();

    PrintWriter file = new PrintWriter(new File(path+"EncryptedMessage.txt"));

    for (int i = 0; i <EncryptCodes.length; i++) { 
        file.write(EncryptCodes[i]+ " \r\n");     
    }
    file.close();
} 
```

忽略变量名称，此方法所做的是将数据写入`EncryptCodes`项目文件夹中生成的 txt 文件中，名为`EncryptedMessage.txt`.

我需要的是一种方法来保存该 txt 文件，而不是保存在项目文件夹中，以保存在用户在运行期间指定的位置（打开另存为对话框）。我认为它可以由 JFilechooser 完成，但我无法让它工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-16T21:07:52.060

您可以添加一个单独的方法来获取保存位置，如下所示：

```
private File getSaveLocation() {
   JFileChooser chooser = new JFileChooser();
   chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);  
   int result = chooser.showSaveDialog(this);

   if (result == chooser.APPROVE_OPTION) { 
      return chooser.getSelectedFile();
   } else {
      return null;
   }
} 
```

然后将结果用作`File`接受父/目录参数的重载构造函数的参数：

```
public void writeOutput(File saveLocation, BigInteger[] EncryptCodes)
                 throws FileNotFoundException {

   PrintWriter file = 
        new PrintWriter(new File(saveLocation, "EncryptedMessage.txt"));
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:47:09.283

像这样？

```
PrintWriter file = new PrintWriter(new File(filePathChosenByUser + "EncryptedMessage.txt")); 
```

# javascript - 检查一个 JavaScript 对象是否已经被实例化

> ID：13905302
> 
> 赞同：2
> 
> 时间：2012-12-16T20:45:21.113
> 
> 标签：javascript, object

我正在开发一个小游戏，我实例化了一些这样的对象：

```
this.polyfills = new Application.Polyfills(this.options); 
```

问题是那段代码在点击（页面上的某些元素）时被调用了很多次，我不想每次都实例化那个对象，因为它已经达到了它的目的。我尝试过这样的事情：

```
this.polyfills = window.Application.Polyfills || new Application.Polyfills(this.options); 
```

但上述显然行不通:) 那么我刚才描述的方法是什么？

**编辑：**点击实例化的对象（我称之为类）是这个：

```
Application.Level = function(_level, _levels, callback) {

    this.helpers = (this.helpers instanceof Application.Helpers) ? true : new Application.Helpers();

    var self = this,

        _options = {
            levels : {
                count : _levels,
                settings : (_level === undefined || _level === '') ? null : self.setLevelSettings(_level, _levels),
                template : 'templates/levels.php'
            },

            api : {
                getImages : {
                    service : 'api/get-images.php',
                    directory : 'assets/img/'
                }
            }
        };

    this.options = new Application.Defaults(_options);
    this.polyfills = (this.polyfills instanceof Application.Polyfills) ? true : new Application.Polyfills(this.options);

    return this.getImages(self.options.api.getImages.service, { url : self.options.api.getImages.directory }, function(data){
        return (typeof callback === 'function' && callback !== undefined) ? callback.apply( callback, [ data, self.options, self.helpers ] ) : 'Argument : Invalid [ Function Required ]';
    });
}; 
```

其中包含一个关于通过`prototype`. 所以我想要做的可能是不可能的？！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-16T20:48:22.773

关于什么 ？

```
this.polyfills = this.polyfills || new Application.Polyfills(this.options); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T20:52:55.410

使用实例：

```
this.polyfills = this.polyfills instanceof Application.Polyfills ? this.polyfills : new Application.Polyfills(this.options) 
```

这将验证它不仅仅是一个对象，而是一个 Application.Polyfills 实例化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-05T13:51:12.033

我使用简单的东西：

```
if(typeof myClass.prototype === "undefined") {
   // the class is instanciated
} 
```

请检查[这支笔](https://codepen.io/seb-rom-o/pen/eYZYyYO?editors=0012)以查看工作示例。

我喜欢它，因为它不依赖于调用的上下文。

# javascript - 删除事件上的主干模型集属性

> ID：13905304
> 
> 赞同：2
> 
> 时间：2012-12-16T20:45:25.673
> 
> 标签：javascript, javascript-events, backbone.js

这可能是因为我是 javascript 新手，我只是不知道正确的语法，但我无法使用当前语法在此 Drop Event 上设置我的主干模型属性。有什么建议么？我已经使用 handleDrop 进行了一些测试，并且能够设置和保存模型实例，但不能使用 handleDrop 函数中的当前代码。

其他关于更有效的写作方式的建议总是受欢迎的:)

```
 //Set the data contained by the draggable elements
        var sourceID;
        var payloads = {
            poolpricedraggable: "poolprice",
            nonedraggable: "none"
        };

        //Set the data contained in the droppable elements
        var targetID;
        var targets = {
            panelone: "panel_one:",
            paneltwo: "panel_two:",
            panelthree: "panel_three:",
            panelfour: "panel_four:",
            panelfive: "panel_five:",
            panelsix: "panel_six:"              
        }

        //Create variable for all draggable & droppable elements
        var element = function(id) { return document.getElementById(id); }

        //Create event handlers for all drag and drop events
        function handleDragStart(event) {
            sourceID = this.id;
        }
        function handleDrop(event) {
            if(event.preventDefault) event.preventDefault();
            targetID = this.id;
            var dataattribute = targets[targetID];
            var datavalue = payloads[sourceID];
            var data = dataattribute + " " + datavalue;
          preflist.set(data);
            preflist.save();
        }

        //Add listeners for those events to the correct dashboard elements
        element('poolpricedraggable').addEventListener('dragstart', handleDragStart, false);

        element('panelone').addEventListener('drop', handleDrop, false);
        element('paneltwo').addEventListener('drop', handleDrop, false);
        element('panelthree').addEventListener('drop', handleDrop, false);
        element('panelfour').addEventListener('drop', handleDrop, false);
        element('panelfive').addEventListener('drop', handleDrop, false);
        element('panelsix').addEventListener('drop', handleDrop, false); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T21:49:51.520

我假设这`preflist`是一个骨干模型。你的错误发生在这里：

```
var data = dataattribute + " " + datavalue;
preflist.set(data); 
```

这里的`data`变量是一个字符串，但是 Backbone 模型`set`函数将属性的哈希值作为键值对

> **设置**model.set（属性，[选项]）
> 
> 在模型上设置属性的散列（一个或多个）...

所以你应该这样做：

```
// var data = dataattribute + " " + datavalue; REMOVE THIS
var data = {};
data[dataattribute] = datavalue;
preflist.set(data); 
```

**编辑，亩太短的评论更好**

根据 Backbone.js[文档](http://backbonejs.org/#Model-set)

> 您还可以传递单个键和值。

所以这是一个更好的解决方案，显然：

```
preflist.set(dataattribute, datavalue); 
```

希望这可以帮助？

# javascript - 手机号码的正则表达式

> ID：13905306
> 
> 赞同：-2
> 
> 时间：2012-12-16T20:45:49.653
> 
> 标签：javascript, regex

什么是正确的 JavaScript 正则表达式来覆盖手机号码，如下所示？

```
000-00-0000 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T20:47:03.650

干得好：

```
[0-9]{3}-[0-9]{2}-[0-9]{4} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:47:22.727

像这样的东西：

```
/^[0-9]{3}-[0-9]{2}-[0-9]{4}$/ 
```

或更短：

```
/^\d{3}-\d{2}-\d{4}$/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T20:49:56.630

*\d*是数字的简写，所以我会用这样的东西：

```
var pattern = /^\d{3}-\d{2}-\d{4}$/;
if(orig_input.match(pattern)) {
    //do stuff...
} 
```

但是，这是因为我不知道电话号码在您的国家/地区 ID 中的外观可能还与最后一部分的其他内容一起使用，因为它的长度可能会有所不同，所以假设最小值为 4 位，最大值为六然后我会做这样的事情。

```
var pattern = /^\d{3}-\d{2}-\d{4,6}$/;
if(orig_input.match(pattern)) {
    //do stuff...
} 
```

注意正则表达式 \d{4,6} 的最后一部分。

此外，这不是一个非常棘手的问题，因此请听取社区（评论）并尝试在将来搜索类似的内容，如果您自己解决问题，您将始终了解更多信息。

# java - JList 没有响应 listModel.addElement(

> ID：13905308
> 
> 赞同：2
> 
> 时间：2012-12-16T20:45:57.140
> 
> 标签：java, swing, jlist, defaultlistmodel

我的 Java Swing 应用程序中有一个 JList，当用户单击一个按钮时，该列表将清除并且内容重置如下：

```
public void reset(ArrayList<String> content) {
    listModel.removeAllElements();
    System.out.println(content.size());
    for(int i = 0; i < content.size(); i++) {
       listModel.addElement(content.get(i));
       System.out.println("Added element " + content.get(i));
   }
} 
```

列表初始化如下

```
listModel = new DefaultListModel();
list = new JList(listModel); 
```

然而有一个问题。列表清除（重置之前，还有其他内容。此内容确实消失了），但新内容未显示。而且，从输出中，我可以看到添加了 6 个元素。但它们没有出现在列表中。为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T20:57:57.467

> 然而有一个问题。列表清除（重置之前，还有其他内容。此内容确实消失了），但新内容未显示。而且，从输出中，我可以看到添加了 6 个元素。但它们没有出现在列表中。为什么是这样？

没有人知道，只有[Swing 中的 Concurency](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)可能是问题，确保所有事件都将在 EDT 上完成，否则为了更好的帮助，请尽快发布[SSCCE](http://sscce.org/)，例如

编辑

添加了 @Robin 请求的 String 实例

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;

public class ListString extends JFrame {

    private static final long serialVersionUID = 1L;
    private DefaultListModel model = new DefaultListModel();
    private int i = 01;

    public ListString() {
        model.addElement(("one" + i++));
        model.addElement(("two" + i++));
        model.addElement(("three" + i++));
        model.addElement(("four" + i++));
        JList list = new JList(model);
        add(new JScrollPane(list));
        JButton btn = new JButton("Remove All Rows :");
        btn.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent ae) {
                model.removeAllElements();
            }
        });
        add(btn, BorderLayout.SOUTH);
        JButton btn1 = new JButton("Add New Rows:");
        btn1.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent ae) {
                model.addElement(("one" + i++));
                model.addElement(("two" + i++));
                model.addElement(("three" + i++));
                model.addElement(("four" + i++));
            }
        });
        add(btn1, BorderLayout.NORTH);
    }

    public static void main(String[] args) {
        UIManager.getLookAndFeelDefaults().put("List.selectionBackground", Color.red);
        ListString frame = new ListString();
        frame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
    }
} 
```

在@trashgod 请求的 JScrollPane 中渲染 JPanel

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;

public class ListPanel extends JFrame {

    private static final long serialVersionUID = 1L;
    private DefaultListModel model = new DefaultListModel();
    private int i = 01;

    public ListPanel() {
        model.addElement(createPanel("one" + i++));
        model.addElement(createPanel("two" + i++));
        model.addElement(createPanel("three" + i++));
        model.addElement(createPanel("four" + i++));
        JList list = new JList(model);
        list.setCellRenderer(new PanelRenderer());
        add(new JScrollPane(list));
        JButton btn = new JButton("Remove All Rows :");
        btn.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent ae) {
                model.removeAllElements();
            }
        });
        add(btn, BorderLayout.SOUTH);
        JButton btn1 = new JButton("Add New Rows:");
        btn1.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent ae) {
                model.addElement(createPanel("one" + i++));
                model.addElement(createPanel("two" + i++));
                model.addElement(createPanel("three" + i++));
                model.addElement(createPanel("four" + i++));
            }
        });
        add(btn1, BorderLayout.NORTH);
    }

    public static JPanel createPanel(String text) {
        JPanel panel = new JPanel();
        panel.add(new JLabel("Item: "));
        panel.add(new JLabel(text));
        return panel;
    }

    public static void main(String[] args) {
        UIManager.getLookAndFeelDefaults().put("List.selectionBackground", Color.red);
        ListPanel frame = new ListPanel();
        frame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
    }

    private class PanelRenderer implements ListCellRenderer {

        @Override
        public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
            JPanel renderer = (JPanel) value;
            renderer.setBackground(isSelected ? list.getSelectionBackground() : list.getBackground());
            return renderer;
        }
    }
} 
```

# android - Android静音/取消静音手机，带密码

> ID：13905310
> 
> 赞同：0
> 
> 时间：2012-12-16T20:46:05.133
> 
> 标签：android, volume, mute

我的目标是支持使手机静音的功能（可能启用/禁用振动），因此当收到电话或短信时，它不会发出噪音

取消静音电话但提示输入“取消静音密码”。

这对于任何其他应用程序仍然有效，它要求在取消静音之前输入密码......

我怎样才能做到这一点？AndroidManifest 需要哪些权限？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T21:08:06.130

以前在 Stackoverflow 上，[Android 静音/取消静音手机](https://stackoverflow.com/questions/7317974/android-mute-unmute-phone)。

这些答案讨论了权限和编码。此外，tasker 可以处理您想做的所有事情。

这[是教程的链接](http://www.mkyong.com/android/android-password-field-example/)。

下面的代码在模拟器中运行良好。当您运行它时，您可以在通知区域看到静音。除了代码之外，我还必须为`android.permission.MODIFY_AUDIO_SETTINGS`.

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    AudioManager audio = (AudioManager) this.getSystemService(Context.AUDIO_SERVICE);

    audio.setRingerMode(AudioManager.RINGER_MODE_SILENT);

    return true;
} 
```

# php - 如何将 PHP 字符串传递给 Javascript 函数调用？

> ID：13905313
> 
> 赞同：3
> 
> 时间：2012-12-16T20:46:39.513
> 
> 标签：php, javascript, string, parameters

> **可能重复：**
> [将 PHP 字符串传递给 Javascript 变量（并转义换行符）](https://stackoverflow.com/questions/168214/pass-a-php-string-to-a-javascript-variable-and-escape-newlines)

所以，基本上我试图从 PHP 页面传递一个字符串作为 javascript 函数的参数。PHP 包含在脚本所在的页面中，但它们位于两个单独的文件中。

但是，每当我尝试传递一个字符串时，它都会停止运行 javascript。我可以传递 PHP 整数，但不能传递字符串。有可能解决这个问题吗？我一直在互联网上寻找可能导致我的错误的原因，但我找不到任何东西。任何帮助将不胜感激。

## 这是PHP和HTML。该函数在单击提交时运行。

```
$comment = "7b";
echo"
    <table>
         <p><input type='text' id='newPostComment' value='' placeholder='WRITE YOUR COMMENT HERE...' size='35'/><input type='submit' value='UPLOAD' onclick='uploadPostComment($parentID, $comment);fetchComment()'/></p>
    </table> 
```

## 这是javascript函数。

```
function uploadPostComment(PostCID, Comment){

      var PostCommentData = "fsPostID="+PostCID;
      PostCommentData += "&fsPostComment="+Comment;

      var xmlHttp = new XMLHttpRequest();
      xmlHttp.open("post", "uploadPostComment.php", true);

      xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      xmlHttp.setRequestHeader("Content-length", PostCommentData.length);
      xmlHttp.setRequestHeader("Connection", "close");

      xmlHttp.onreadystatechange = function()
         {
             if(xmlHttp.readyState == 4)
             {
                if(xmlHttp.status == 200)
                {
                    alert("Message Posted");
                }
                else
                {
                    alert("Oh no, an error occured2"); 
                }
             }
         };
         xmlHttp.send(PostCommentData);} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T20:50:12.133

```
echo"
    <table>
         <p><input type='text' id='newPostComment' value='' placeholder='WRITE YOUR COMMENT HERE...' size='35'/><input type='submit' value='UPLOAD' onclick='uploadPostComment(\"$parentID\", \"" . str_replace('"', '\"', $comment) . "\");fetchComment()'/></p>
    </table> 
```

您需要引用这些字段。如果您的字段是整数，则不需要引用，如果是字符串则需要。我引用了两者，因为我不知道 parentID 是字符串 id 还是数字 id。当然，做你的应用程序需要的。

更新：关于迈克尔关于打破如果评论包含引用的评论。我们现在转义 $comment 中的所有双引号以防止这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T20:50:43.817

```
<input type='submit' value='UPLOAD' onclick='uploadPostComment($parentID, $comment);fetchComment()'/> 
```

是你的罪魁祸首，尤其是`uploadPostComment($parentID, $comment);`- 如果 $comment 是一个字符串，你需要把引号放在适当的位置：`uploadPostComment($parentID, \"$comment\");`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T20:50:43.520

将字符串包裹在转义的双引号中，例如`\"$comment\"`

```
$comment = "7b";
echo"
    <table>
         <p><input type='text' id='newPostComment' value='' placeholder='WRITE YOUR COMMENT HERE...' size='35'/><input type='submit' value='UPLOAD' onclick='uploadPostComment(\"$parentID\", \"$comment\");fetchComment()'/></p>
    </table> 
```

# ios - 创建uiview动画“无人机”还是“奴隶”？

> ID：13905314
> 
> 赞同：0
> 
> 时间：2012-12-16T20:46:49.377
> 
> 标签：ios, uiview, uiviewanimation

我创建了一个 uiview 子类，并对其进行了实例化（我们称之为主视图）。这个 uiview 子类包含它自己的手势识别器和触摸事件覆盖以及与这些触摸事件相对应的动画（例如旋转和翻转）。

我想创建这个子类（或类似的子类）的另一个实例，我们将其称为从视图。从视图在外观上应该与主视图相同，但不会响应触摸事件本身。相反，从本质上应该是一个遥控无人机，它与主视图同步动画。

我试图让我的大脑围绕如何做到这一点......似乎我可以创建一个从属子类，以便主人可以为从属视图调用动画委托方法。因此，主控中的每个动画调用也会调用从属中具有相同变换的方法。

父视图将有多个主从对，每个主从对独立动画。我真的不喜欢将手势识别器和动画移动到父级。

关于这个主从对的代码模式有什么想法吗？我对调用委托的理解可能会受到挑战，但我觉得当我去多个主/从对时委托方法在这里不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:25:32.843

哪个对象创建了从站？父视图还是主视图？如果你让master创建自己的slave，那么它可以将自己设置为slave的代表。拥有多个对不应该有任何问题，因为每个主控都将是从属类的特定实例的代表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:16:26.833

编辑：

在您发表评论后，我意识到我误解了您的问题。让奴隶成为适当主人的代表是要走的路。一旦以这种方式设置，那么主控可以在适当的时候调用委托方法（当然，假设设置了委托）。

# ruby-on-rails-3.2 - 在rails中访问连接表列中的记录的语法是什么？

> ID：13905322
> 
> 赞同：0
> 
> 时间：2012-12-16T20:48:01.390
> 
> 标签：ruby-on-rails-3.2, table-relationships

我有：

```
class Student < ActiveRecord::Base
    #attr_accessible :lastname, :name
    has_many :together
    has_many :teachers, :through => :together
end 
```

```
class Teacher < ActiveRecord::Base
    #attr_accessible :lastname, :name
    has_many :together
    has_many :students, :through => :together
end 
```

```
class Together < ActiveRecord::Base
  #attr_accessible :summary
  belongs_to :student
  belongs_to :teacher
end 
```

我想做类似的事情：

```
Student.find(1).together.summary 
```

我想访问联接表中“摘要”列中的数据...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:40:41.830

如果你只是想得到孩子，你可以这样做：

```
Student.find(1).teachers 
```

如果您的教师模型有一个汇总字段，您可以执行以下操作：

```
Student.find(1).teachers.first.summary 
```

我想如果您在连接表中有一个汇总字段并且您知道学生 ID，那么您可以这样做：

```
Together.find_by_student_id(1).summary 
```

还有其他方法可以做到这一点。给 Rails 猫换皮的几种方法。

# android - Android 在可见性更改后绘制最后一个可见状态

> ID：13905323
> 
> 赞同：3
> 
> 时间：2012-12-16T20:48:05.867
> 
> 标签：android, android-ui

我有一个始终不可见的自定义 ViewGroup。当视图不可见时，我通过调用清除所有孩子`removeAllViews()`。问题是当我更改可见性时，首先绘制旧内容，然后再更新到新内容，这会导致屏幕闪烁。我试着打电话`destroyDrawingCache()`没有帮助。我在这里有什么遗漏吗？

至于我的自定义 ViewGroup - 唯一要做的就是覆盖`onMeasure()`并`onLayout()`正确布置孩子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T18:28:29.943

发现问题！当我添加孩子时，我有一个将 fillAfter 标志设置为 true 的 ScaleAnimation。这导致了这个问题。删除 fillAfter 标志解决了该问题。它只发生在 ICS+ FYI 上，所以可能是硬件加速的问题。

# javascript - JQuery .on 仅在动态生成的元素上触发一次

> ID：13905328
> 
> 赞同：1
> 
> 时间：2012-12-16T20:48:14.223
> 
> 标签：javascript, jquery

所以我有以下问题。我正在尝试将两个事件添加到复选框表中。

这是html的示例。

```
<body>
<div id='container'> //static element, everything beyond this element is dynamic
 <div id='pane_x'>
  <div id='bottom_x'>
   <div id='bottom_left_x'>
    <div id='results_x'>
     <div id='list_x'>
      <div id='table_1'>
       <table>
        <tbody>
         <tr>
          <td>
           <input type='checkbox' name='blah' id='blah_obj.id_x' class='blahblah'>
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>
</div> 
```

我试图通过使用前缀选择器 [id^='blah_'] 来选择复选框。我能够使代码适用于第一个窗格，即：pane_0，但它不会在 pane_1 或更高版本上触发。

```
jquery(document).on("change", "[id^='blah_" + obj.id + "']", function() {
//code here
}); 
```

可能存在嵌套错误，因为我只是对 html 进行了粗略估计。奇怪的是我可以通过使用菊花链 .children() 语句看到它们，但我无法选择输入元素。

由于注释不支持与本节相同的代码块，我将在此处添加：

```
jquery(document).on("change", ".checked", function() {
 var ids = jquery(this).attr("id").split("_");
 if (ids[0] === "blah")
  //do code
 }
}); 
```

为清楚起见，编辑了 ID。id 结构是 "blah_" obj.id "_" 个体迭代器。所以窗格 0 上的 3 个复选框看起来像这样：blah_0_0 blah_0_1 blah_0_2

此页面上还有另外 2 组复选框列表，我不想使用这些功能作为目标，这就是我使用前缀选择器的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:58:38.990

使用`startsWith`选择器的目的是不要尝试完成整个值，就像你正在做的那样，`obj.id`甚至`obj.id`定义了。

以下将找到ID以现有或未来`input`开头的所有内容。`'blah_'`

```
jQuery(document).on("change", "input[id^='blah_']", function() {
//code here
}); 
```

如果它们都共享一个公共类，则将类用作选择器会更有意义

```
jQuery(document).on("change", "input.blahblah", function() {
//code here
}); 
```

另请注意，除非您在自己的代码中另行定义，否则您`jquery`应该输入错字`jQuery`

**重要说明**ID 可能不会在页面中重复，以防您一直重复相同的复选框 ID。根据定义，它们必须是唯一的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:07:42.950

这里是另一个示例：

```
$("body").on({
    click:function(){
        // where $(this) is the current item changed
    }
}, "input.blahblah"); 
```

​</p>

# node.js - 如何在nodejs中终止连接

> ID：13905332
> 
> 赞同：1
> 
> 时间：2012-12-16T20:48:32.030
> 
> 标签：node.js, sockets, connection

我有一个家庭作业，`http`只使用节点本机模块构建服务器。我试图保护服务器免于过载，因此每个请求都被散列并存储。如果某个请求达到很高的数字，比如 500，我调用`socket.destroy()`.

每个间隔（一分钟）我重新启动哈希表。问题是当我做一个以前死掉的套接字现在又可以工作了。每个间隔我唯一做的就是`requests = {}`，与连接无关。

任何想法为什么连接再次生效？有比 更好的功能`destroy()`吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:37:03.533

销毁套接字不一定会阻止客户端使用新套接字重试请求。

相反，您可以尝试仅使用非`OK`状态代码进行最低限度的响应：

```
if (requests[path] >= 500) {
    res.statusCode = 503;
    res.end();
} 
```

并且，在[`503`状态码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.4)上：

> 由于服务器临时过载或维护，服务器当前无法处理请求。

# android - Android RelativeLayout 放置带有样式的元素

> ID：13905334
> 
> 赞同：0
> 
> 时间：2012-12-16T20:48:37.780
> 
> 标签：android, styles, android-relativelayout

我想将两个元素排成一行，一个在右边，一个在左边。我想从代码中做到这一点......并使用样式。

首先我用静态 layout.xml 尝试了它：这很好用：

```
 <RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:text="@string/hello_world" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:text="TextView" />

 </RelativeLayout> 
```

然后我创造了风格，

```
 <style name="t1" parent="@android:style/TextAppearance.Large">
    <item name="android:layout_width">wrap_content</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:layout_alignParentLeft">true</item>
</style>

<style name="t2" parent="@android:style/TextAppearance.Large">
    <item name="android:layout_width">wrap_content</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:layout_alignParentRight">true</item>
</style> 
```

并尝试：

```
RelativeLayout rel = new RelativeLayout(this);
RelativeLayout.LayoutParams params = new 
        RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT,
            LayoutParams.WRAP_CONTENT);
    rel.setLayoutParams(params);

    TextView t1 = new TextView(this);   
    t1.setText("balbla_1");
    t1.setTextAppearance(this, R.style.t1);

    TextView t2 = new TextView(this);
    t2.setText("balbla_2");
    t2.setTextAppearance(this, R.style.t2);

    rel.addView(t1);
    rel.addView(t2);

    setContentView(rel); 
```

但是我看到元素重叠，因为不接受 align 的样式...是否可以在此类过程中使用样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:52:39.253

正如 javadoc 中所指定的，setTextAppearence 仅适用于某些属性：

```
/**
 * Sets the text color, size, style, hint color, and highlight color
 * from the specified TextAppearance resource.
 */ 
```

但是你可以做这样的事情

```
 TextView t1 = new TextView(this);
    t1.setText("balbla_1");
    t1.setTextAppearance(this, R.style.t1);
    RelativeLayout.LayoutParams t1_params = new RelativeLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);
    t1_params.addRule(RelativeLayout.ALIGN_PARENT_LEFT);

    TextView t2 = new TextView(this);
    t2.setText("balbla_2");
    t2.setTextAppearance(this, R.style.t2);
    RelativeLayout.LayoutParams t2_params = new RelativeLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);
    t2_params.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);

    rel.addView(t1, t1_params);
    rel.addView(t2, t2_params); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:55:38.703

你试过线性布局吗？喜欢;

```
 <LinearLayout
            android:layout_width="0dp"
            android:layout_height="match_parent"
            android:layout_weight="1"
            android:orientation="vertical" >

            <TextView
                android:id="@+id/textView1"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:gravity="center"
                android:text="@string/o1" />

            <TextView
                android:id="@+id/textView2"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:gravity="center"
                android:text="@string/o2" />
  </LinearLayout> 
```

# silverlight - 将视频功能添加到 Win8 MediaElement 控件的播放器

> ID：13905336
> 
> 赞同：1
> 
> 时间：2012-12-16T20:48:40.637
> 
> 标签：silverlight, xaml, windows-8, microsoft-metro, winrt-xaml

Windows 8 Metro XAML 媒体元素是最基本的，本质上只是一个渲染表面。

有谁知道一个很好的第三方控件，它添加了您期望在视频播放器上的所有功能？比如播放、暂停、滑条、全屏等？我正在寻找类似于大多数浏览器提供的 HTML5 Video 元素的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T07:11:49.537

MediaElement 控制得很好但有些功能受到限制。更增强的控制是“播放器框架”。

通过这个控件，可以播放每个编码的视频，播放器，搜索栏，暂停，播放，皮肤属性等。

[http://playerframework.codeplex.com/](http://playerframework.codeplex.com/)

![在此处输入图像描述](../Images/d0ce993c83810cc0b9a740c4c0cf9859.png)

问候 ;）

# javascript - JavaScript用另一个改变段落样式的第一个实例

> ID：13905337
> 
> 赞同：0
> 
> 时间：2012-12-16T20:48:43.880
> 
> 标签：javascript, styles, adobe-indesign, paragraph

我需要帮助编写一个 JavaScript，它将在每个文本框中搜索段落样式的第一个实例，然后将其替换为另一个段落样式。如果有办法用 grep 做到这一点，那也很好。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T10:55:02.890

开发这个你应该面对的一些工作点

*   第一个所有脚本都继承了 Application 类。

*   获取您正在处理的页面 - 类页面

*   获取所有 pageItems - ItemPage 或 PageItem（我现在不记得了）

*   遍历 pageItems 并获取文档中的所有文本框 - TextFrame 类

*   使用循环从所有文本框中获取第一段。就像是

    pageItem[i].textFrame[i].paragraph[0]

    *   将段落放入变量中，使用脚本上的文档并更改所需的样式

给你一个很好的阅读参考

[Jongware 页面](http://www.jongware.com/idjshelp.html)

# python - MySQL 连接、XAMPP 和 ODBC

> ID：13905338
> 
> 赞同：0
> 
> 时间：2012-12-16T20:48:48.047
> 
> 标签：python, mysql, xampp

注意：**我在 virtualenv 中使用 Python2.7 连接以访问未安装在 virtualenv 上的 XAMPP 上的 MySQL。

我正在尝试通过 python 连接 MySQL。我最近从 Oracle 下载了 MySQL 连接。我还从同一个站点下载了 ODBC 驱动程序。当我插入下面的信息时，我收到一个 2003 错误，告诉我它无法连接：

> mysql.connector.errors.InterfaceError：2003：无法连接到“127.0.0.1”上的 MySQL 服务器

但是当我在我的连接中包含端口号时，它会冻结并且没有任何反应。

这是我的代码：

```
>>>import mysql.connector
>>>cnx = mysql.connector.connect(user='[my username]',password='[my password]',host='127.0.0.1', database='FXPrices',port=80) 
```

之后，光标缩进——所以 python 提示没有箭头。每次我想让它停止时，我都必须按 control-z。我需要 mod_wsgi 来解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:56:37.850

您正在尝试连接到您机器上的 http 端口（端口 80）。

MySQL 默认侦听端口 3306，您应该尝试（如果省略`port`参数，则相同），或者尝试找出您的 mysql 服务器真正侦听的端口。

# android - 具有搜索功能的列表视图

> ID：13905339
> 
> 赞同：0
> 
> 时间：2012-12-16T20:48:52.807
> 
> 标签：android

我正在`listview`使用`BaseAdaptor`。它工作正常，但我也在应用搜索功能。它的代码是

```
 inputSearch.addTextChangedListener(new TextWatcher() {

                        @Override
                        public void onTextChanged(CharSequence cs, int arg1,
                                int arg2, int arg3) {                       

                            String searchText = inputSearch.getText().toString();
                            int textLength = searchText.length();
                            searchResults.clear();

                            for (int i = 0; i < productList.size(); i++) {
                                String prodName = productList.get(i).get(
                                        TAG_PRODUCT_NAME);
                                if (textLength <= prodName.length()) {
                                    if (searchText.equalsIgnoreCase(prodName
                                            .substring(0, textLength)))
                                        searchResults.add(productList.get(i));
                                }
                            }

                            adapter.notifyDataSetChanged();
                            lstProductList.setAdapter(adapter);
                        }

} 
```

虽然它没有给我任何错误，但搜索也不起作用。当我在搜索编辑文本中写入时，什么都没有发生。错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:00:46.163

您的 BaseAdapter 应该实现 Filterable 并且您应该使用此代码在`performFiltering()`. [以ArrayAdapter](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/widget/ArrayAdapter.java#ArrayAdapter)的源代码为例。这样，您可以检索结果的子集，但在清除 EditText 时仍然拥有原始数据的副本。

至于它的逻辑`onTextChanged()`看起来不错。虽然您可以使用`startsWith()`代替`equals()`和`substring()`.

# javascript - 鼠标悬停时无限旋转SVG多边形

> ID：13905340
> 
> 赞同：0
> 
> 时间：2012-12-16T20:48:56.940
> 
> 标签：javascript, svg, rotation

我想在鼠标悬停时旋转一个多边形，但我所能做的就是单次旋转，我认为因为角度是静态的。此外，多边形应该围绕自身旋转，而不是。我的代码如下所示：

```
<polygon id="stern"
        points="
        350,370.5  
        370.9,460.1 
        460.9,460.1  
        390.7,510.5
        420.3,600.1
        350  ,550
        270.7,600.1
        300.3,510.5
        230.1,460.1
        320.1,460.1"
        style="fill:#FACC2E"
        onmouseover="rotieren()"/>

<use x="365" y="-380" xlink:href="#stern" transform="scale(0.7)"/>
<use x="1060" y="400" xlink:href="#stern" transform="scale(0.4)"/>
<use x="500" y="700" xlink:href="#stern" transform="scale(0.5)"/> 
```

我尝试了很多功能，例如使用变量，但我无法在`.setAttribute("transform", "rotate(variable,0,0))`. 现在，我愿意

```
document.getElementByID("stern").setAttribut("transform","rotate(5,1060,400)") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:55:10.997

你能做这样的事情吗？

```
var stern = document.getElementByID("stern");
var i = 0;
var interval = setInterval(function(){
    stern.setAttribute("transform","rotate("+(++i)+",1060,400)")
},50) 
```

# winapi - WinAPI：如何获取大写锁定状态？

> ID：13905342
> 
> 赞同：11
> 
> 时间：2012-12-16T20:49:13.617
> 
> 标签：winapi, state, capslock

如何获得 Caps Lock 是打开还是关闭？我试图搜索它，但我发现的只是如何切换或打开/关闭它，这与我正在寻找的完全相反。

我正在尝试在 C++ 和 Delphi 中做到这一点。
请帮忙

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-16T20:54:31.587

我找到了这个[链接](http://vcpptips.wordpress.com/2009/01/19/how-to-check-the-caps-lock-is-on-or-off/)和下面的代码片段可能对你有帮助

```
if ((GetKeyState(VK_CAPITAL) & 0x0001)!=0)
  AfxMessageBox("Caps Lock ON!");
else
  AfxMessageBox("Caps Lock OFF!"); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-16T20:55:34.783

您想要 GetKeyState() 函数：

[http://msdn.microsoft.com/en-us/library/ms646301(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms646301(VS.85).aspx)

使用 VK_CAPITAL 密钥代码。其余的虚拟键代码在这里：

[http://technet.microsoft.com/en-us/subscriptions/index/dd375731(v=vs.85).aspx](http://technet.microsoft.com/en-us/subscriptions/index/dd375731(v=vs.85).aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-16T20:54:18.510

将[GetAsyncKeyState](http://msdn.microsoft.com/en-us/library/ms646293%28v=vs.85%29.aspx)与 VK_CAPITAL (0x14) 一起使用

# sql-server-2008 - 使用 sp_MSforeachdb 在数据库中“循环”并返回 1 个数据集

> ID：13905345
> 
> 赞同：0
> 
> 时间：2012-12-16T20:49:38.690
> 
> 标签：sql-server-2008, tsql, sql-server-2012, sp-msforeachdb

所以，我一直在努力解决我在好友网站上找到的代码：

[移动数据库登录的 8 个步骤](http://johnsterrett.com/2012/01/24/8-steps-to-moving-database-users-from-sql-2005-to-sql-2008/)

我想在一个输出中生成数据库级别安全性、角色和显式权限语句，这样我就不会一遍又一遍地复制和粘贴，以便它们为服务器上的所有数据库运行（当然要减去 tempdb）。

```
Declare @FullStatement varchar(MAX)
Set @FullStatement = ' use [?]; SELECT  dp.state_desc + N'' '' + dp.permission_name + N'' TO '' + cast(QUOTENAME(dpl.name COLLATE DATABASE_DEFAULT) as nvarchar(500))  AS TSQLScript
FROM sys.database_permissions AS dp
INNER JOIN sys.database_principals AS dpl ON (dp.grantee_principal_id = dpl.principal_id)
WHERE dp.major_id = 0
and dpl.name not like ''##%'' -- excluds PBM accounts
and dpl.name not in (''dbo'', ''sa'', ''public'')
ORDER BY dp.permission_name ASC, dp.state_desc ASC'

Exec sp_MSforeachdb  @FullStatement 
```

如何使用表变量、临时表等修改我所拥有的，按原样工作但不方便，以便所有语句都在一个数据集中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T21:15:50.240

大卫，

这是你想要的吗？

```
CREATE TABLE tempdb.dbo.Results (c1 VARCHAR(8000))

Declare @FullStatement varchar(MAX)
Set @FullStatement = 'SELECT ''use [?]''; SELECT  dp.state_desc + N'' '' + dp.permission_name + N'' TO '' + cast(QUOTENAME(dpl.name COLLATE DATABASE_DEFAULT) as nvarchar(500))  AS TSQLScript
FROM [?].sys.database_permissions AS dp
INNER JOIN [?].sys.database_principals AS dpl ON (dp.grantee_principal_id = dpl.principal_id)
WHERE dp.major_id = 0
and dpl.name not like ''##%'' -- excluds PBM accounts
and dpl.name not in (''dbo'', ''sa'', ''public'')
ORDER BY dp.permission_name ASC, dp.state_desc ASC'

INSERT INTO tempdb.dbo.Results Exec sp_MSforeachdb  @FullStatement

select * FROM tempdb.dbo.Results 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:11:49.990

有多种方法可以完成这项工作。您可以使用 powershell 循环遍历所有数据库并将结果放入 excel 中。Nelson 先生在他的 powershell sql 大学系列中有这个。抱歉，我会帮你拉链接，但我在机场用手机打字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-17T00:17:44.800

为什么要编写数据库用户和权限脚本？它们位于数据库中，并且在您迁移数据库时仍会存在。除非您从头开始重新创建数据库，否则您不需要这样做。

# mysql - 填充 mySQL 数据库的脚本的多个实例 ->

> ID：13905346
> 
> 赞同：0
> 
> 时间：2012-12-16T20:49:54.540
> 
> 标签：mysql

我有一个 MySQL 数据库，我有三个表：

```
 settings
Name     |   Value
curId    |    127 
contentId|    34

content1
Id   |   Name
5    |   XXX
34   |   YYY

content2
Id   |   Name
12   |   XXX
33   |   YYY 
```

我拥有的脚本使用设置表中的 curId 从另一个“DB”获取数据，然后如果它存在于另一个“DB”中，则将其添加到 content1 表中，如果不存在则将其添加到 content2 表中。它们都共享相同的 id，我们从 settings[çontentid] 中获取它。每次尝试后，它都会增加 contentId 和 curId，以便我知道它最后失败/停止/完成的位置。现在我想运行脚本的两个实例。他们俩都从 settings[curId] 获取 id 并在完成后递增它。

我的问题是：如果我只是让它们在不使用任何锁的情况下运行，是否会在某个时候从另一个“数据库”获取相同的对象并在 content1 中复制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T20:55:46.150

我不确定它是否会发生，但它可能会发生。为什么不让它们从不同的值开始到一定的限度呢？这样你甚至不需要第一张桌子。

# php - 按每年唯一的月份分组，而不仅仅是月份

> ID：13905353
> 
> 赞同：0
> 
> 时间：2012-12-16T20:50:23.070
> 
> 标签：php, mysql, sql

> **可能重复：**
> [MySQL 查询 GROUP BY 日/月/年](https://stackoverflow.com/questions/508791/mysql-query-group-by-day-month-year)

我有以下mysql：

```
SELECT MONTH( FROM_UNIXTIME(  `timeStamp` ) ) as month , COUNT(  `id` )  as count
FROM  `discusComments` 
GROUP BY MONTH( FROM_UNIXTIME(  `timeStamp` ) ) 
ORDER BY  MONTH( FROM_UNIXTIME(  `timeStamp` ) ) ASC 
LIMIT 15 
```

它获取过去 15 个月中每月的条目数量。我想知道为什么它只显示过去 12 个月……然后我意识到计数是所有年份的总和，而不是每个月的唯一年份。因此 12 月的值可能是 2012 年和 2011 年的总和。

我不想要这个。我想获取过去 15 个月以及 UNIQUE 月份年份的条目数量，例如 2012 年 12 月、2012 年 11 月等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T20:54:06.707

将年份添加到您的`SELECT`列列表并添加别名`GROUP BY`。

```
SELECT YEAR(FROM_UNIXTIME(`timestamp`))  AS year, 
       MONTH(FROM_UNIXTIME(`timestamp`)) AS month, 
       COUNT(`id`)                       AS count 
FROM   `discuscomments` 
GROUP  BY year, 
          month 
ORDER  BY year,
          month
LIMIT  15 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T20:55:25.823

我对此最直接的想法通常是将日期值的格式更改为唯一且说话的字符串，例如 2012 年 12 月的 2012-12 和 2011 年 10 月的 2011-10 等。

您可以使用的功能是[`DATE_FORMAT()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)：

```
 DATE_FORMAT(FROM_UNIXTIME(timeStamp), '%Y-%m') 
```

然后这些字符串很容易排序，例如 ASC：

```
2011-10
2011-11
2011-12
...
2012-10
2012-11
2012-12 
```

示例 SQL 查询：

```
SELECT
  DATE_FORMAT(FROM_UNIXTIME(timeStamp), '%Y-%m') as month, 
  COUNT(id) as count
FROM  discusComments
GROUP BY month
ORDER BY month ASC 
LIMIT 15 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T21:01:01.850

尝试这个

```
months_between(to_date ('2009/05/15', 'yyyy/mm/dd'), 
                     to_date ('2009/04/16', 'yyyy/mm/dd')) 
```

# c# - 创建泛型类型的实例时无法提供参数

> ID：13905359
> 
> 赞同：19
> 
> 时间：2012-12-16T20:50:51.137
> 
> 标签：c#, json, generics, encapsulation

我有一个对象，我想在创建后才读取它......即因为构造函数中的属性必须在 GetHashCode 中使用，因此一旦创建就不能更改。

我这是许多只读类之一：

```
public class AccountLabel
{ 
    private string result;

    public AccountLabel(string result)
    {
        // TODO: Complete member initialization
        this.result = result;
    }

    public string JSONRPCData { get { return this.result; } }
} 
```

我有一个像这样的通用结果类

```
 public  class JsonResult<T>  where  T : JObject, new()
  {
    private T bhash;
    private string p;
    private JsonErrorResponse error;
    private int _id;
    private Newtonsoft.Json.Linq.JObject ret;

    public JsonResult(Newtonsoft.Json.Linq.JObject ret)
    { 
        this.ret = ret;

        var tempError = ret["error"];
        var tempid = ret["id"];
        JsonErrorResponse error = new JsonErrorResponse(tempError);
        this.error = error;
        this._id = 1;

        var tempresult = ret["result"];
        T someResult = new T(tempresult);  // <--- here is my problem
    } 
```

我的问题是我想将一个对象传递给 T 的构造函数但不能。当我输入这个时，编译器告诉我`Cannot provide arguments when creating an instance of variable type`

解决这种情况的最佳方法是什么？

*   我应该有一个可以调用的接口来更新属性吗？

*   以前的接口会破坏封装还是允许对我的对象进行更改？

*   我还应该如何处理这个问题？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-16T21:01:01.997

您可以删除`new`类型约束，并`Activator.CreateInstance`改用。

而不是这个

```
T someResult = new T(tempresult); 
```

写这个：

```
T someResult = (T)Activator.CreateInstance(
    typeof(T)
,   new object[] { tempresult }
); 
```

由于经过反射，这可能会稍微慢一些，并且不会执行编译器的静态检查。但是，考虑到您的情况，看起来这些中的任何一个都不会出现重大问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-23T15:01:57.417

您可以将工厂委托传递给以下构造函数`JSonResult<T>`：

```
public class JsonResult<T> where T : JObject
{
    public JsonResult(Newtonsoft.Json.Linq.JObject ret, Func<object, T> factory)
    { 
        var tempresult = ret["result"];
        T someResult = factory(tempresult);
    }
} 
```

`object`in`Func<object, T>`可以替换为`tempResult`实际的类型。

# google-maps - 从谷歌地图 IFRAME 中删除所有控件

> ID：13905366
> 
> 赞同：0
> 
> 时间：2012-12-16T20:51:38.313
> 
> 标签：google-maps

以下是我的 iframe 的代码，请让我知道是否可以删除所有控件，例如从以下位置删除选择地图类型、方向控制：

```
<iframe width="80%" height="150" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps/ms?msa=0&amp;msid=214928275585170600122.0004d0fda61d060c1d69e&amp;iwloc=&amp;output=embed"></iframe> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-05T07:00:39.033

使用 embed (iframe) 方法时，您无法移除地图类型控件。您可以尝试使用 Maps API javascript API 开发您的地图，该 API 可以更精细地控制地图的外观。

# php - 查询结果适用于 PHPMyAdmin，但在 PHP 中返回 0 行

> ID：13905370
> 
> 赞同：1
> 
> 时间：2012-12-16T20:52:43.963
> 
> 标签：php, mysql

在我的搜索脚本中，我无法获得以下代码的结果：

```
 $sqlCommand = "SELECT `Loc.`, Model, Make, Description, `Tag No.`,
            MATCH(`Loc.`, Model, Make, Description, `Tag No.`)
            AGAINST ('$searchquery' IN BOOLEAN MODE) AS score FROM ag_combine
            WHERE MATCH(`Loc.`, Model, Make, Description, `Tag No.`)
            AGAINST ('$searchquery' IN BOOLEAN MODE) AND (Status='IN' or Status='OF') ORDER BY score DESC"; 
```

该查询在搜索列直到该`Tag No.`列时工作正常，然后它将显示 0 结果消息；但是 phpMyAdmin 中的相同查询将产生所需的标记号结果。

我猜它与列名中的空格有关，但不确定如何正确选择它。

这是我正在测试的完整代码：

```
<?php
 include "includes/config.php";

error_reporting(E_ALL);
ini_set('display_errors', '1');
$search_output = "";
if(isset($_POST['searchquery']) && $_POST['searchquery'] != ""){
     $searchquery = preg_replace('#[^a-z 0-9?!+-]#i', '', $_POST['searchquery']);
     if($_POST['filter1'] == "Combines"){
        $sqlCommand = "SELECT `Loc.`, Model, Make, Description, `Tag No.`,
                MATCH(`Loc.`, Model, Make, Description, `Tag No.`)
                AGAINST ('$searchquery' IN BOOLEAN MODE) AS score FROM ag_combine
                WHERE MATCH(`Loc.`, Model, Make, Description, `Tag No.`)
                AGAINST ('$searchquery' IN BOOLEAN MODE) AND (Status='IN' or Status='OF') ORDER BY score DESC";     
    } else if($_POST['filter1'] == "Tractors"){
        $sqlCommand = "(SELECT `Loc.`, Model, Make, Description, Status, `Tag No.` FROM ag_tractor WHERE MATCH (`Loc.`, Model, Make, Description,`Tag No.` ) AGAINST ('$searchquery' IN BOOLEAN MODE) AND  (Status='IN' or Status='OF'))";      
    }

    $query = mysql_query($sqlCommand) or die(mysql_error());
    $count = mysql_num_rows($query);
    if($count > 1){
        $search_output .= "<hr />$count results for <strong>$searchquery</strong><hr />$sqlCommand<hr />";
        while($row = mysql_fetch_array($query)){
            $loc = $row["Loc."];
            $tag = $row["Tag No."];
            $model = $row["Model"];
            $make = $row["Make"];
            $description = $row["Description"];
            $search_output .= "$loc: $tag: $make $model - $description<br />";
        } // close while
    } else {
        $search_output = "<hr />0 results for <strong>$searchquery</strong><hr />$sqlCommand";
    }
}
?>
<html>
<head>
</head>
<body>
<h2>Search the Exercise Tables</h2>
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
Search For: 
  <input name="searchquery" type="text" size="44" maxlength="88"> 
Within: 
<select name="filter1">
<option value="Combines">Combines</option>
<option value="Tractors">Tractors</option>
</select>
<input name="myBtn" type="submit">
<br />
</form>
<div>
<?php echo $search_output; ?>
</div>
</body> 
</html> 
```

# php - 如何在不刷新页面的情况下更新 Kohana 视图中的 php 变量？

> ID：13905371
> 
> 赞同：0
> 
> 时间：2012-12-16T20:52:51.063
> 
> 标签：php, ajax, kohana

我正在使用 Kohana PHP 框架开发一个 Web 应用程序，但我被卡住了。我在控制器中设置了一个 PHP 变量以在视图中使用它。我想在不刷新页面的情况下不断更新视图中的这个变量。我想做的是使用 SQL 数据库中的数据实时显示图表，其中曲线数据存储在这个 PHP 变量中。我怎样才能做到这一点？是否可以直接在视图中更新这个变量（使用我在模型中的函数）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T23:19:29.837

您可以使用 Javascript 向您的应用程序创建 AJAX 请求，而无需重新加载页面。发生的情况是向您的控制器/操作发出请求，在那里您可以查询您的数据库，并且您可以传回您喜欢的任何内容。AJAX 请求可以检索返回的数据并对其进行处理（在我们的示例中，将某些内容替换为新内容）。

您必须在您的页面上包含此 Javascript 代码。在本例中，我使用 jQuery 发出 AJAX 请求：

```
$.ajax({
  url: /do/something  /* URL of your controller/action */
  success: function(data) { /* the data variable will receive the new content from the controller/action */
    $('#the_id_of_your_html_tag').html(data); /* replace the html content with the new data */
  },
}); 
```

在您的 Kohana 控制器中，您有如下内容：

```
class Controller_Do extends Controller_Template
{
  public function action_something()
  {
    $this->auto_render = false;

     // make some call to your database, use your model whatever
     echo 'some string or variable';
     return;
  }
} 
```

您的视图 Html 将是这样的（根据示例）：

```
<div id="the_id_of_your_html_tag">something</div> 
```

# javascript - RegExp 用于解析数学表达式？

> ID：13905374
> 
> 赞同：1
> 
> 时间：2012-12-16T20:53:15.410
> 
> 标签：javascript, regex, math, string-parsing

嘿，我用 JavaScript 和 HTML5 编写了一个分形生成程序（[这里是链接](http://fractal.nodejitsu.com)），这是一个大约 2 年的过程，包括我对复杂数学和分形方程所做的所有研究，我正在寻找更新界面，因为人们看起来很吓人。在查看代码时，我注意到我做事的一些旧技术非常低效，例如我的[Complex.parseFunction](https://github.com/patrickroberts/Javascript-Complex-Math-Library)。

我正在寻找一种方法来使用 RegExp 来解析表达式的组件，例如函数、运算符和变量，以及为表达式实现正确的操作顺序。下面的一个例子可以说明我的意思：

```
//the first example parses an expression with two variables and outputs to string
console.log(Complex.parseFunction("i*-sinh(C-Z^2)", ["Z","C"], false))

"Complex.I.mult(Complex.neg(Complex.sinh(C.sub(Z.cPow(new Complex(2,0,2,0))))))"

//the second example parses the same expression but outputs to function
console.log(Complex.parseFunction("i*-sinh(C-Z^2)", ["Z","C"], true))

function(Z,C){
  return Complex.I.mult(Complex.neg(Complex.sinh(C.sub(Z.cPow(new Complex(2,0,2,0))))));
} 
```

我知道如何使用 RegExp 来处理`String.prototype.replace`所有这些，我所需要的只是 RegExp 本身。请注意，它应该能够通过注意它是否直接在a之后来区分减法运算符（例如“CZ^2”）和负函数（例如“i*-(Z^2+C)”）变量或运算符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:04:04.343

虽然您可以将正则表达式用作表达式解析器的一部分，例如分解标记，但正则表达式不具备解析正确嵌套的数学表达式的计算能力。这本质上是计算理论的核心结果之一（有限状态自动机与下推自动机）。您可能想查看诸如递归下降或 LR 解析之类的内容。

如果你只做一次，我也不会太担心解析表达式的效率。鉴于您正在做的所有其他数学运算，我怀疑它是否重要。

# php - 2表交互：插入、获取结果、插入

> ID：13905381
> 
> 赞同：2
> 
> 时间：2012-12-16T20:53:56.133
> 
> 标签：php, mysql, stored-procedures, multiple-tables

我需要对我的数据库/网络交互做出基本决定，我什至缺少找到合适搜索词的知识。

### 背景：

我正在建立一个家庭网站，它支持论坛、家谱、带有排名和更多细节的 pvp 游戏，所有这些都来自数据模型。现在的技术：面向对象的 PHP、MySQL、javascript。

### 要求：

在论坛数据模型中，将书面帖子处理为添加新论坛主题（线程）。

### 目前的做法：

在我当前的数据模型中，这将暗示并更新两个表：帖子和主题。我需要**在主题表中插入一行，然后获取新生成的 topicId(sequence)，然后在插入到 post 表中使用它**。

### 问题：

**我觉得这**对于需要发生的事情来说工作量太大，互动太多。但如果我坚持目前的方法，它将成为一个典型的要求。

问题：

1.  反正我是在正确的轨道上还是应该
2.  重构数据模型或
3.  选择另一种数据库交互方式（例如存储过程）
4.  我是否面临一个典型示例，您将使用方法/框架 xyz。

当前表格具有以下结构（大致基于erdiagrams.com的[此结构）](http://www.erdiagrams.com/datamodel-forum-idef1x.jpg)

**主题**：（'线程'）

```
id
Forum_ID (FK)
Person_ID (FK)(threadcreator)
IsLocked
IsSticky
Subject
ViewCount
DateCreated
Tc_post_id  - trigger to last post_id in this thread 
```

**邮政**

```
id
topic_id(FK)
person_id(FK)
subject
message
timestamp
replyto 
```

然后我有一个视图，它收集每个主题的最后一篇文章，并在触发器 Tc_post_id 上显示一些相关信息（例如最后一张海报图片）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T04:13:04.313

广告 1 和 2：您的数据模型很好。在这里使用外键至关重要。您需要注意的另一件事是数据库应确保每个 POST 都有一个 TOPIC 记录。这是通过设置 POST.topic_id *NOT NULL*属性来完成的。这在 DB 端是足够的安全机制，因为它确保不会留下没有 TOPIC 的任何 POST。无论您现在对 POST 做什么，您都有义务提供一个主题。

广告 3：此处不建议使用带有存储过程的触发器，因为您的 TOPIC 表中有其他数据（IsSticky、IsLocked 等），您可能希望在创建 TOPIC 记录时提供这些数据。此外，如果这样的触发器适用，则数据库设计将成为非规范化的主题。

广告 4：在业务逻辑方面，您现在可以通过编写一个自动化机制来帮助自己，每次创建一个没有指定 topic_id 的新 POST 记录时创建 TOPIC 记录。我建议为此使用一些 ORM，或者利用任何 MVC 框架中可用的数据模型。此类模型的蓝图如下所示：

```
abstract class AModel // this class should be provided by ORM or framework
{
    /**
     * @var PDO
     */
    protected $_db_driver;

    public function getLastInsertId()
    {
        $stmt = $this->_db_driver->prepare('SELECT LAST_INSERT_ID() AS id');
        $stmt->execute();
        return $stmt->fetch(PDO::FETCH_OBJ)->id;
    }

    public abstract function getFieldList();
}

class ForumTopicModel extends AModel
{
    public function insert(array $data)
    {
        $sql = 'INSERT INTO topic VALUES (:id, :forum_id, :person_id, :is_locked, ...)';
        $stmt = $this->_db_driver->prepare($sql);
        return $stmt->execute($data);
    }

    public function getFieldList()
    {
        return array('id', 'forum_id', 'person_id', 'is_locked', /*...*/);
    }

    // ...
}

class ForumPostModel extends AModel
{
    public function insert(array $data)
    {
        $sql = 'INSERT INTO post VALUES (:id, :topic_id, :person_id, :subject, ...)';
        $stmt = $this->_db_driver->prepare($sql);
        return $stmt->execute($data);
    }

    public function getFieldList()
    {
        return array('id', 'topic_id', 'person_id', 'subject', /*...*/);
    }

    public function insertInitialTopicPost(array $form_data)
    {
        $this->_db_driver->beginTransaction();

        $result = true;

        if ( empty($form_data['topic_id']) ) {
            // no topic_id provided, so create new one:
            $topic = new ForumTopicModel();
            $topic_data = array_intersect_key(
                $form_data, array_flip($topic->getFieldList())
            );
            $result = $topic->insert($topic_data);
            $form_data['topic_id'] = $topic->getLastInsertId();
        }

        if ( $result ) {
            $forum_post_data = array_intersect_key(
                $form_data, array_flip($this->getFieldList())
            );
            $result = $this->insert($forum_post_data);
        }

        if ( $result ) {
            $this->_db_driver->commit();
        }
        else {
            $this->_db_driver->rollBack();
        }

        return $result;
    }

    // ...
} 
```

注意：作为一种良好的 MVC 实践，这些模型应该是唯一可以直接对表行进行操作的地方。否则，您最终会遇到 SQL 错误（但数据模型将保持一致，因此您不必担心会出现问题）。

最后利用*控制器*层中的模型：

```
class ForumPostController extends AController
{
    public function createInitialTopicPostAction()
    {
        $form_data = $this->getRequest()->getPost(); /* wrapper for getting
            the $_POST array */

        // (...) validate and filter $form_data here

        $forumPost = new ForumPostModel();
        $result = $forumPost->insertInitialTopicPost($form_data);

        if ( $result ) {
            // display success message
        }
        else {
            // display failure message
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T20:58:14.690

我理解它的方式：主题是帖子的容器。

主题表会相当小，可能只包含一个`topic id (PK)`and `topic title`。

帖子本身将包含`post id (PK)`, `topic id (FK)`, `timestamps`, `author id`, `text`。

我会使用`InnoDB`和外键，因此删除的主题可能会删除其所有子帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T22:53:22.167

（编辑：）在这个答案中，我发布了一种使用**mysql_insert_id()**的方法，这仍然是一个技术上正确的解决方案（如果错了，请纠正我）。

然而，我现在将选择 PDO 包装器。而且，这不是一般建模/方法问题的答案。

不过，以下将是一种方法：

```
$sql = "INSERT INTO topic VALUES (NULL,'$forumId',<more parameters>)";
$result = mysql_query($sql);

#  get the generated id  
$topicId = mysql_insert_id();

#  and insert into the post table
$sql = "INSERT INTO post VALUES (NULL,'$topicId',<more parameters>)";
$result = mysql_query($sql);
mysql_free_result($result); 
```

来源： http: [//www.desilva.biz/mysql/insertid.html](http://www.desilva.biz/mysql/insertid.html)

# ruby-on-rails-3 - 如何在 Rails 3.2.x 引擎中使用 SASS、HAML 和 CoffeeScript？

> ID：13905389
> 
> 赞同：1
> 
> 时间：2012-12-16T20:55:25.167
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2, rails-engines

目前，我有一个 Rails 3.2.9 引擎，它正在使用`sass-rails`. 当我生成一个带有几个动作的控制器时，也会生成资产（即，javascript 和 CSS）。但是，Javascript 和 SASS 都是`*.js`和`*.css`文件。它们不是 CoffeeScript ( `*.js.coffee`) 或 SASS ( `*.css.sass`)。任何想法如何获得这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T00:57:19.697

这是一个不同的解决方案，默认情况下将使用`coffee-rails`和`sass-rails`gems - 也修复了`haml-rails`.

我将此添加到`engine.rb`文件的顶部：

```
require 'rails'
require 'coffee-rails'
require 'sass/rails'
require 'haml-rails' 
```

我所做的是检查这些文件的源代码，以了解它们在正常的 Rails 应用程序中是如何工作的。例如，在`haml-rails`我查看[`lib/haml-rails.rb`](https://github.com/indirect/haml-rails/blob/master/lib/haml-rails.rb)并看到以下内容：

```
require 'haml'
require 'rails'

module Haml
  module Rails
    class Railtie < ::Rails::Railtie
      if ::Rails.version.to_f >= 3.1
        config.app_generators.template_engine :haml
      else
        config.generators.template_engine :haml
      end
    ... 
```

`sass-rails`( [`lib/sass/rails/railtie.rb`](https://github.com/rails/sass-rails/blob/master/lib/sass/rails/railtie.rb)) 和`coffee-rails`( )存在类似的文件[`lib/coffee/rails/engine.rb`](https://github.com/rails/coffee-rails/blob/master/lib/coffee/rails/engine.rb)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T21:41:17.507

只需附加`--stylesheet_engine=sass --javascript_engine=coffee`到您的生成器命令（我假设`rails g controller`）。

# ajax - textarea 值不起作用

> ID：13905390
> 
> 赞同：-1
> 
> 时间：2012-12-16T20:55:25.720
> 
> 标签：ajax

我试过 $('#tresc_area').val() 但它没有用（不知道为什么）。输入正确发送信息，但 textarea 有问题。请帮我。

```
<form method="post">
    <input class="input" type="text" name="do_kogo" id="odbiorca" size="25" value="<?php print $odbiorca; ?>" />
    <input class="input" id="temat" type="text" name="temat" size="25" value="<?php print $temat; ?>"/>
    <textarea id="tresc_area" cols="45" rows="10" ></textarea>
    <input onclick="Check()" id="send_submit" type="submit" value="Send" />
</form>​ 
```

这是ajax。当我输入 tresc: "content" 时它会正确发送 "content" 但是当我尝试输入之前声明的 tresc.value 时，我们可以看到它有问题，即使我在那里声明 "$('#tresc_area' ).val()" 有什么建议吗？请帮我

```
 <script type="text/javascript">

var odbiorca = document.getElementById("odbiorca");
var temat = document.getElementById("temat");
var tresc = document.getElementById("tresc_area");

function Check() {
    $.ajax({
        type: "POST",
        url: "send_prv_msg.php",
        data: {
            do_kogo: odbiorca.value,
            temat: temat.value,
            tresc: tresc.value
        },
        success: function(odp) {
            $("p#error_box").html(odp);
        }
    });

}​

</script> 
```

tresc: tresc.value <-- 它不起作用。有人知道如何使它工作吗？请

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:17:25.470

既然您无论如何都在使用 jQuery，那么不妨利用它的 DOM 选择器。

```
function Check() {
    $.ajax({
        type: "POST",
        url: "send_prv_msg.php",
        data: {
            do_kogo: $("#odbiorca").val(),
            temat: $("#temat").val(),
            tresc: $("#tresc").val()
        },
        success: function(odp) {
            $("p#error_box").html(odp);
        }
    });

}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:23:24.897

这是一个简单的 js fiddle 如何从文本字段中读取值：[example](http://jsfiddle.net/jeWBm/)。在 textarea 中输入任何文本并点击`Send`按钮。记得`return false;`在 Check 函数的末尾添加，这样就不会提交表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-21T09:40:51.440

```
function get_comment_chk() {
    var ChkVars = {
        additional_register_mail_chk: 'Registered Mail $3.20 per parcel \n',
        additional_insurance_chk: 'Insurance $1.50 for every $100 of merchandise. \n',
        additional_international_chk: 'Registered Mail and insurance generally starts at $25 even for large letters, plus the cost of the postage. Please ask us for a quote.  \n'
    }

    var additonal = 'Additional Option: ';
    var mytextbox = document.getElementById('confirm_comment');
    var inputs = document.getElementsByTagName("input");

    mytextbox.value = '';
    mytextbox.value = mytextbox.value.replace(additonal  + ChkVars[this.name], "");
    for(var i = 0; i < inputs.length; i++) {
        if(inputs[i].type === "checkbox") {
            inputs[i].onchange = function(){

                $('input[name*=\'additional\']:checked').each(function(){
                    mytextbox.value = mytextbox.value  + additonal  + ChkVars[this.name];
                });

                /*if(this.checked){
                    mytextbox.value = mytextbox.value  + additonal  + ChkVars[this.name];
                } else {
                    mytextbox.value = mytextbox.value.replace(additonal  + ChkVars[this.name], ""); 
                }*/
            }
        }  
    }

} 
```

# c# - 我正在尝试使用 PDFSharp，但找不到predefinedFont.csHelvetica

> ID：13905395
> 
> 赞同：1
> 
> 时间：2012-12-16T20:56:00.080
> 
> 标签：c#, sharppdf

这是代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using sharpPDF;

namespace Lightnings_Extractor
{
    class PDF
    {
        pdfDocument myDoc = new pdfDocument("Lightnings-Graphs", "Daniel");

        public PDF()
        {
            pdfPage myPage = myDoc.addPage();
            myPage.addText("Hello World!", 200, 450, predefinedFont.csHelvetica, 20);
            myDoc.createPDF(@"d:\mypdf.pdf");
            myPage = null;
            myDoc = null;
        }

    }
} 
```

`predefinedFont`不存在。

所以我试着写：

```
sharpPDF.Fonts.pdfAbstractFont font; 
```

但是当我尝试创建字体时，没有`csHelvetica`

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:40:15.667

我错误地使用了sharpPDF。我现在已经下载了 PDFsharp。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-10T06:55:57.580

将以下行替换为

```
 myPage.addText("Hello World!", 200, 450, predefinedFont.csHelvetica, 20); 
```

经过

```
 myPage.addText("Hello World!", 200, 450, myDoc.getFontReference(predefinedFont.csHelvetica), 20); 
```

这个对我有用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-04-02T19:29:56.323

尝试替换`predefinedFont.csHelvetica`为`myDoc.getFontReference("Helvetica")`

# go - 嵌入式接口

> ID：13905398
> 
> 赞同：8
> 
> 时间：2012-12-16T20:56:23.913
> 
> 标签：go

我对 Go 还是很陌生，我很惊讶不能使用嵌入式接口的子类型。这是一个小例子来解释我的意思：

```
func test(sl bufio.ReadWriter){
    // cannot use sl(type bufio.ReadWriter) as type bufio.Reader in function argument
    readStuff(sl) 
    [...]
    writeStuff(sl) // same kind of error
}

func readStuff(sl bufio.Reader){
    [...]
} 
```

由于每个接口都具有相同的内存布局，并且 ReadWriter 是 Reader 和 Writer，因此我希望这段代码能够正常工作。我确实尝试使用以下方式转换接口类型：

```
readStuff(sl.(buffio.Reader)) 
```

但它也不起作用。所以我有两个问题：

*   为什么它不起作用？
*   关于这个问题的围棋哲学是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-16T21:03:00.377

他们是不同的类型。但是，a`bufio.ReadWriter`包含指向`bufio.Reader`类型和`bufio.Writer`类型的指针作为其结构的元素。所以通过正确的应该很容易。尝试这个：

```
func test(sl bufio.ReadWriter){
    readStuff(sl.Reader)
    [...]
    writeStuff(sl.Writer)
}

// Changed this bufio.Reader to a pointer receiver
func readStuff(sl *bufio.Reader) {
    [...]
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-17T07:09:19.057

[bufio.ReadWriter](http://golang.org/pkg/bufio/#ReadWriter)是具体类型，而不是接口。但是，它确实满足接口 (io.ReadWriter)，因此可以将其分配给适当接口类型的变量/函数参数。然后它会按照您预期的方式工作（您的代码实际上不使用任何接口）：

```
package main

import (
        "bufio"
        "bytes"
        "fmt"
        "io"
        "log"
)

func readStuff(r io.Reader) {
        b := make([]byte, 10)
        n, err := r.Read(b)
        if err != nil && err != io.EOF {
                log.Fatal(err)
        }
        fmt.Printf("readStuff: %q\n", b[:n])
}

func writeStuff(w io.Writer) {
        b := []byte("written")
        n, err := w.Write(b)
        if n != len(b) {
                log.Fatal("Short write")
        }

        if err != nil {
                log.Fatal(err)
        }
}

func test(rw io.ReadWriter) {
    readStuff(rw)
    writeStuff(rw)
}

func main() {
        r := io.Reader(bytes.NewBufferString("source"))
        var uw bytes.Buffer
        w := io.Writer(&uw)
        rw := bufio.NewReadWriter(bufio.NewReader(r), bufio.NewWriter(w))
        test(rw)
        rw.Flush()
        fmt.Printf("The underlying bytes.Buffer writer contains %q\n", uw.Bytes())
} 
```

（也在[这里](http://play.golang.org/p/VsEb5kZ61e)）

* * *

输出：

```
readStuff: "source"
The underlying bytes.Buffer writer contains "written" 
```

这种方式`test`可以消耗任何`io.ReadWriter`，而不仅仅是一个特定的。这暗示了您关于“哲学”的问题。

# gtk - 无法使用键盘在 VTE 中选择文本

> ID：13905400
> 
> 赞同：2
> 
> 时间：2012-12-16T20:56:27.157
> 
> 标签：gtk, terminal-emulator, vte

我正在使用 VTE 库用 C 语言编写自己的终端应用程序。一切都很好，除了我不能用键盘选择文本。例如，如果我刚刚输入了一些内容，在大多数终端中，您可以按住 shift 键并使用左箭头键选择上一个文本，然后您可以将其粘贴到您想要的任何位置。在 VTE 中，所发生的只是您在当前光标位置获得一个 D。我显然可以通过从按键返回 TRUE（我已经完成）来阻止终端中 D 的打印，但我仍然无法选择文本。

我以为我可以从 开始手动执行此操作`vte_terminal_get_cursor_position()`，但是一旦我有了选择的边界，就没有方法可以在 VTE 中选择一个文本块（我可以找到）。

我查看了其他基于 VTE 的项目，例如 tinyterm 和 evilvte，但是当按下该组合键时，它们也只会在终端中打印 D。

那么有没有办法使用键盘在 VTE 中选择文本呢？谢谢。

**更正：** 事实证明，很少有终端允许您使用键盘选择文本。不知道那是怎么进入我的脑海的。无论如何，我仍然认为这将是一个方便的功能，所以问题是存在的。任何想法将不胜感激。

# windows-8 - Windows 8 的 Monogame 出现错误

> ID：13905401
> 
> 赞同：1
> 
> 时间：2012-12-16T20:56:28.553
> 
> 标签：windows-8, monogame

如何在没有directx 11的平台上使用monogame？我尝试在我的机器上安装 directx 软件，但仍然出现一些错误。有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:39:13.357

我也遇到了同样的问题，但我尝试再次安装单声道并解决了问题。请尝试安装旧文件的 adirectx 和 sharpdx 的旧版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:21:44.803

我不确定您遇到的错误，但我只想问您如何安装 MonoGame？

MonoGame 人员添加了一个安装程序，有助于确保您获得运行 MonoGame 所需的所有必要文件，以及安装基本模板。您可以在此处找到 MonoGame 3.0 安装程序：http: [//monogame.codeplex.com/releases/view/96421](http://monogame.codeplex.com/releases/view/96421)

如果您需要有关安装的更多详细信息，请在此处查看我的教程：http: [//blogs.msdn.com/b/tarawalker/archive/2012/12/04/windows-8-game-development-using-c-xna-和-monogame-3-0-building-a-shooter-game-walkthrough-part-1-overview-installation-monogame-3-0-project-creation.aspx](http://blogs.msdn.com/b/tarawalker/archive/2012/12/04/windows-8-game-development-using-c-xna-and-monogame-3-0-building-a-shooter-game-walkthrough-part-1-overview-installation-monogame-3-0-project-creation.aspx)

# css - 将单位类型附加到 Sass 中的计算结果

> ID：13905407
> 
> 赞同：70
> 
> 时间：2012-12-16T20:56:56.373
> 
> 标签：css, sass

我最近一直在将我的 CSS 重构为 SASS 样式表。我正在使用 VS2012 的[Mindscape Web Workbench 扩展](http://visualstudiogallery.msdn.microsoft.com/2b96d16a-c986-4501-8f97-8008f9db141a)，每次保存 SCSS 时都会重新生成 CSS。我从类似这样的代码开始：

```
/* Starting point: */
h1 { font-size: 1.5em; /* 24px ÷ 16px */ } 
```

然后我尝试首先将其重构为：

```
/* Recfator: */
h1 { font-size: (24px / 16px)em; } 
```

但不幸的是，这会产生：

```
/* Result: */
h1 { font-size: 1.5 em; }              /* doesn't work, gives "1.5 em" */ 
```

注意我不想要的**额外空间。**我尝试了几种替代方案，这里有一些：

```
h1 { font-size: (24/16)em; }           /* doesn't work, gives "1.5 em" */
h2 { font-size: 24 / 16em; }           /* doesn't work, gives "24/16em" */
h3 { font-size: (24px / 16px) * 1em; } /* works but "* 1 em" feels unnecessary */
h4 { font-size: (24em) / 16; }         /* works, but without "px" it's not 
                                          really conveying what I mean to say */ 
```

我也用变量尝试了这些变体（因为无论如何我都想要这些），但这并没有太大改变这种情况。为了使这个问题中的示例保持流畅，我省略了变量。但是，我很乐意接受依赖于使用变量的解决方案（以一种干净的方式）。

我已经浏览了[有关 '/' 的相关 SASS 文档](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#division-and-slash)，并意识到这对 SASS 来说是一个艰难的文档，因为 '/' 字符已经在基本 CSS 中具有意义。无论哪种方式，我都希望有一个干净的解决方案。我在这里错过了什么吗？

PS。[这篇博文](http://erskinelabs.com/calculating-ems-scss/)确实提供了一种解决方案，使用用户定义的函数。不过，这似乎有点重，所以如果有符合我上述尝试的“更清洁”的解决方案，我很感兴趣。如果有人可以解释“功能方法”是更好（甚至唯一）的解决方案，那么我也会接受它作为答案。

PS。[这个相关的问题](https://stackoverflow.com/q/15513395/419956)似乎与同一件事有关，尽管人们特别想做进一步的计算。[接受的答案](https://stackoverflow.com/a/15514279/419956)是我的第三个解决方法（乘以`1em`），但是如果我愿意放弃进行进一步计算的能力，我很想知道是否有不同的（更清洁的）方法。也许上述问题（“插值”）中提到的方法对我有用？

* * *

***底线：****如何干净地将单位类型（例如`em`）附加到 SASS 中的计算结果中？*

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-12-16T21:23:43.140

**将单位添加到数字的唯一方法是通过算术**。

执行连接（例如`1 + px`）或插值（例如`#{1}px`）之类的操作只会创建一个看起来*像*数字的**字符串。**即使你绝对 100% 确定你永远不会在另一个算术运算中使用你的值，你*也不应该这样做*。

 **比无法执行算术运算更重要的是，您将无法将它们与其他需要数字的函数一起使用：

```
$foo: 1; // a number
$foo-percent: $foo + '%'; // a string

.bar {
    color: darken(blue, $foo-percent); //Error: "1%" is not a number!
} 
```

> $amount: "1%" 不是 `darken' 的数字

将数字转换为字符串不会有任何收获。始终使用算术（乘以 1 或加法 0）来添加单位：

```
$foo: 1; // a number
$foo-percent: $foo * 1%; // still a number! //or: $foo + 0%

.bar {
    color: darken(blue, $foo-percent); //works!
} 
```

输出：

```
.bar {
  color: #0000fa;
} 
```

这是我作为 Flexbox mixin 库的一部分编写的一个 mixin，如果你传入一个字符串，它会阻塞（对于那些不熟悉 Flexbox 的人，原始规范只允许该`box-flex`属性使用整数。 `flex: auto`或者`flex: 30em`不能与可比较的`box-flex`属性兼容，所以mixin 不用费心去尝试）

```
@mixin flex($value: 0 1 auto, $wrap: $flex-wrap-required, $legacy: $flex-legacy-enabled) {
    @if $legacy and unitless(nth($value, 1)) {
        @include legacy-flex(nth($value, 1));
    }

    @include experimental(flex, $value, flex-support-common()...);
}

@mixin legacy-flex($value: 0) {
    @include experimental(box-flex, $value, $box-support...);
} 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2015-08-27T11:24:41.947

您可以尝试以下任一方法：

```
font-size: $size * 1px; 
```

或者

```
font-size: $size + unquote("px"); 
```

`$size`你的计算结果在哪里。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-12-20T16:44:42.707

选择您喜欢的方法

```
$font: 24px;
$base: 16px; 
```

无变量

```
.item1 { font-size: #{(24px / 16px)}em; } 
```

仅使用变量

```
.item2 { font-size: #{$font / $base}em; } 
```

一个变量

```
.item3 { font-size: #{$font / 16px}em; }
.item4 { font-size: #{24px / $base}em; } 
```

所有这些的输出

```
.item1 { font-size: 1.5em; }
.item2 { font-size: 1.5em; }
.item3 { font-size: 1.5em; }
.item4 { font-size: 1.5em; } 
```

使用的方法称为[插值 #{}](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#interpolation_)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-06-26T21:53:31.940

我假设您问这个的原因是因为在周围的上下文中，1 em = 16 px，并且您希望使用这种关系将目标字体大小从像素转换为 em。

如果是这样，*正确*的做法是将字体大小乘以缩放因子 1em / 16px，如下所示：

```
$h1-font-size: 24px;
$body-font-size: 16px;

$body-em-scale: 1em / $body-font-size;

h1 {
  font-size: $h1-font-size * $body-em-scale;  // -> 1.5em
} 
```

要不就：

```
h1 {
  font-size: $h1-font-size * (1em / $body-font-size);  // -> 1.5em
} 
```

这也正是它在物理学中的工作原理：如果有，比如说，50[摩尔](https://en.wikipedia.org/wiki/Mole_(unit))水，并且你想知道它的重量是多少[克](https://en.wikipedia.org/wiki/Gram_(unit))，你可以将你拥有的水量（= 50 摩尔）乘以[摩尔质量](https://en.wikipedia.org/wiki/Molar_mass)水 (≈ 18 g/mol) 找出您的水样重 50 mol × 18 g/mol ≈ 900 克。在 SASS 中将像素转换为 em 的工作方式相同：首先找出每个像素有多少 em，在您打算使用规则的上下文中，然后将 px 中的大小乘以该比率，以 em 为单位表示/像素。

* * *

附言。当然，如果你要转换的单位有一个 SASS 已经知道的固定比率，那么你可以简单地让它为你自动转换，使用“零加技巧”。例如，如果您想将字体大小从 px 转换为 cm，您可以简单地执行以下操作：

```
h1 {
  font-size: 0cm + $h1-font-size;  // -> 0.635cm
} 
```

*这是有效的，因为 SASS 允许您将两个以兼容单位（如 px 和 cm）给出的值相加，并将以与总和中的第一个*值相同的单位表示结果。这个技巧对 px -> em*不起作用*的原因是这里的转换因子不是固定的，而是取决于周围的上下文，所以 SASS 不知道如何自动进行转换。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-11-17T11:15:07.633

添加单位的最佳方法是使用`... * 1em`或您想要获得的单位`... + 0em`在哪里：`em`

```
font-size: (24px/16px) + 0em; // ... + 0px for px
//or
font-size: (24px/16px) * 1em; 
//both produce: font-size: 1.5em; 
```

这样，它将保留为**数字**，因此您可以在数学运算或其他函数中使用它。

但是，如果您希望将结果作为字符串或由于某种原因不关心结果的数值，您也可以通过以下方式简单地获取它：

```
font-size: (24px/16px) + em; //font-size: 1.5em; //em does not include quotations 
```

无需使用`unquote`or `#{}`here（如其他答案中所写）！**

# javascript - mongojs：将元素推入数组字段

> ID：13905408
> 
> 赞同：0
> 
> 时间：2012-12-16T20:57:01.213
> 
> 标签：javascript, mongodb, mongojs

我在这个主题上搜索了很多，但我完全迷路了。这是我的问题（我将 node.js 与 mongojs 一起使用）：

我想要这样的文件：

```
{ 
    "_id" : ObjectId("50ce2f7f98fa09b20d000001"), 
    "beginTime" : 1355689855016, 
    "tags" : {
        "primary": [ 29, 12, 16], 
        "secondary": [6, 8, 9]
    },
    "user" : "50bdddc601de4681d666835f"
} 
```

但是，如果我尝试在“主要”下推送新标签（请注意，此字段来自变量），就像这样

```
tags = {};
tags[request.body.relevance] = request.body.tag;
return db.activities.update({
  '_id': db.ObjectId(request.body.activity),
  'user': request.session.user.id
}, {
  $push: {
    tags: tags
  }
}); 
```

然后我得到

```
{ "_id" : ObjectId("50ce2f7f98fa09b20d000001"), "beginTime" : 1355689855016, "tags" : [ { "primary" : 29 }, { "primary" : "24" }, { "primary" : "1" } ], "user" : "50bdddc601de4681d666835f" } 
```

我尝试了许多其他变体，包括嵌套 $push（女巫将其转换为字段 oo）。无论如何，我总是失败。也是在这一点上我真的很饿T_T

请帮我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:22:58.470

运算符的值`$push`需要是要推送到的数组字段，而不是父字段。

试试这个：

```
...
return db.activities.update({
  '_id': db.ObjectId(request.body.activity),
  'user': request.session.user.id
}, {
  $push: {
    'tags.primary': tags.primary,
    'tags.secondary': tags.secondary
  }
}); 
```

**更新**

要动态执行此操作，您需要执行以下操作：

```
...
var push = {};
push['tags.' + request.body.relevance] = request.body.tag;
return db.activities.update({
  '_id': db.ObjectId(request.body.activity),
  'user': request.session.user.id
}, {
  $push: push
}); 
```

# c - OpenMP 中的插入排序

> ID：13905410
> 
> 赞同：3
> 
> 时间：2012-12-16T20:57:10.717
> 
> 标签：c, multithreading, parallel-processing, openmp, insertion-sort

我正在尝试为插入排序编写 OpenMP 解决方案，但在使其并行运行并给出正确结果时遇到了问题:)。有什么方法可以让插入排序并行运行。

这是我的代码：

```
void insertionsort(int *A, int num)
{
    // clock_t start, stop;
    // 
    // start=clock();
    int k;
    #pragma omp parallel for shared(A) private(k)
    for(int n = 1; n < num; n++)
    {
        int key = A[n];
        k = n;
        #pragma omp critical
        for(;k>0 && A[k-1]> key;k--)
        {
            A[k] = A[k-1];   
        }
        A[k] = key;  
    }
// stop=clock();
// cas = (double)(stop-start)/CLOCKS_PER_SEC;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-17T06:36:21.247

您不应该`Insertion Sort algorithm`以这种方式并行化。从内部循环条件`A[k-1]> key;`可以看出，该算法假设对于给定的数组`key`位置`k`，如果实际键大于存储在数组前一个位置上的键，则元素*交换*停止。因此，该算法假设之前位置上的键`k`已经**排序**。

例如，当您使用两个线程引入并行性时，线程`0`和`1`分别从数组的开头和中间开始。但是，根据算法做出的（*错误*的）假设，数组的前半部分没有排序，因此会导致问题。

让我来说明这个问题，让我们`array = [-1,2,-3,4,-5,6,-7,8]`用 2 个线程对它进行排序：让我们修复一个给定的执行顺序（*实际上*它是不确定的）

*   1.  线程 0 需要 k = 1 和 key = 2；阵列状态`[-1,2,-3,4,-5,6,-7,8]`
*   2.  线程 1 需要 k = 5 和 key = 6；阵列状态`[-1,2,-3,4,-5,6,-7,8]`
*   3.  线程 0 需要 k = 2 和 key = -3；阵列状态`[-3,-1,2,4,-5,6,-7,8]`
*   4.  线程 1 需要 k = 6 和 key = -7；阵列状态`[-7,-3,-1,2,4,-5,6,8]`
*   5.  线程 0 需要 k = 3 和 key = 2；阵列状态`[-7,-3,-1,2,4,-5,6,8]`
*   6.  线程 1 需要 k = 7 和 key = 8；阵列状态`[-7,-3,-1,2,4,-5,6,8]`
*   7.  线程 0 需要 k = 4 和 key = 4；阵列状态`[-7,-3,-1,2,4,-5,6,8]`

最后结果 ：`[-7,-3,-1,2,4,-5,6,8]`

在第 4 行，线程从位置`1`获取键并将其放在数组的末尾，从位置（包括）向右一个位置筛选其所有元素，所以现在位于. 既然，（6）的旧位置将永远不会再被比较，将保持不变。因此，使数组未排序。`-7``6``1 to 6``-5``-7``-7``-5`

一个简单但*较差的*解决方案是将 OpenMP`ordered`子句添加到`parallel for`构造中。但是，使用此构造函数基本上会按顺序排列您的代码。

另一种可能的解决方案，虽然我不是 100% 确定它是否符合您的需求，但将通过常规采样使您的算法并行。您可以[在此处](http://www.uio.no/studier/emner/matnat/ifi/INF3380/v10/undervisningsmateriale/inf3380-week12.pdf)看到后一种技术应用的示例`quicksort`。

您的算法结构不是最适合直接并行化并实现良好的加速。由于内部循环的每次迭代都是相互依赖的，这将需要使用不确定互斥的方法，从而导致同步开销。您拥有可以直接并行化的更好的排序算法，通常是使用分治策略的算法，例如基数排序或快速排序等。

# c++ - 错误回复：私有成员的继承？

> ID：13905413
> 
> 赞同：0
> 
> 时间：2012-12-16T20:57:30.670
> 
> 标签：c++, inheritance

**这是一个错误吗？我认为私有成员不是从基类继承的：**

“HourlyEmployee类的定义没有提到成员变量name、ssn、netPay，但是HourlyEmployee类的每个对象都有成员变量name、ssn、netPay。成员变量name、ssn、netPay继承自类雇员。”

```
 //This is the header file hourlyemployee.h.
 //This is the interface for the class HourlyEmployee.
 #ifndef HOURLYEMPLOYEE_H
 #define HOURLYEMPLOYEE_H

 #include <string>
 #include "employee.h"
 using std::string;

namespace SavitchEmployees
{
class HourlyEmployee : public Employee
{
public:
    HourlyEmployee( );
    HourlyEmployee(const string& theName, const string& theSsn,
    double theWageRate, double theHours);
    void setRate(double newWageRate);
    double getRate( ) const;
    void setHours(double hoursWorked);
    double getHours( ) const;
    void printCheck( );
private:
    double wageRate;
    double hours;
};
 }//SavitchEmployees
 #endif //HOURLYEMPLOYEE_H 
```

其他头文件：

```
//This is the header file employee.h.
//This is the interface for the class Employee.
//This is primarily intended to be used as a base class to derive
//classes for different kinds of employees.
#ifndef EMPLOYEE_H
#define EMPLOYEE_H
#include <string>

using std::string;

namespace SavitchEmployees
{
    class Employee
    {
    public:
        Employee( );
        Employee(const string& theName, const string& theSsn);
        string getName( ) const;
        string getSsn( ) const;
        double getNetPay( ) const;
        void setName(const string& newName);
        void setSsn(const string& newSsn);
        void setNetPay(double newNetPay);
        void printCheck( ) const;
    private:
        string name;
        string ssn;
        double netPay;
    };
}//SavitchEmployees

#endif //EMPLOYEE_H 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T21:02:48.957

所有成员都由子类继承。如果它们是私有的，则无法（直接）访问它们。它们仍然可以通过调用公共方法（例如`setName`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T21:02:38.917

私有成员*存在*于子类中，但在大多数情况下不可访问。只有基类中的函数才能触及它们，没有`friend`声明或字节级黑客。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-16T21:02:47.463

报价是正确的。所有数据成员，无论是否私有，都由派生类继承。这意味着每个派生类的每个实例都包含它们。但是，派生类不能直接访问私有成员。

但是，您可以通过公共或受保护的访问器访问此类成员，例如`getName()`.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-16T21:04:40.910

为此，您拥有受保护的访问级别。所以使用受保护的而不是私有的。

# mysql - 在mysql中行的列

> ID：13905415
> 
> 赞同：-1
> 
> 时间：2012-12-16T20:57:34.070
> 
> 标签：mysql, sql, pivot

我需要帮助才能从反馈表中收集数据。

我有像这样的桌子

`tbl_parent_child_details`

```
fld_parent_id   fld_parent_name  fld_child_name   fld_class   fld_section
1               Tom              Ray               8          A
2               Dev              angelina         12          B 
```

`tbl_feedback_children`

```
fld_parent_id  fld_quetion_id   fld_ans 
1              1                1
1              2                3
1              3                2
2              1                4
2              2                5
2              3                2 
```

`tbl_feedback_admini`

```
fld_parent_id  fld_quetion_id   fld_ans 
1              1                1
1              2                3
1              3                2
2              1                4
2              2                5
2              3                2 
```

现在我的要求是我想要一行中每个父母的数据，例如：

```
Parent child q1 q2 q3 q4 q5 q6
tom ray 1 3 2 1 3 2
dev angelina 4 5 2 4 5 2 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:17:53.323

这种类型的操作称为 a `PIVOT`，但 MySQL 没有枢轴函数，因此您可以使用带有`CASE`语句的聚合函数来复制它。

您的查询将与此类似：

```
select pc.fld_parent_name,
  pc.fld_child_name,
  max(case when a.fld_quetion_id = 1 then a.fld_ans end) q1,
  max(case when a.fld_quetion_id = 2 then a.fld_ans end) q2,
  max(case when a.fld_quetion_id = 3 then a.fld_ans end) q3
from tbl_parent_child_details pc
left join tbl_feedback_admini a
  on pc.fld_parent_id = a.fld_parent_id
left join tbl_feedback_children c
  on pc.fld_parent_id = c.fld_parent_id
  and a.fld_quetion_id = c.fld_quetion_id
group by pc.fld_parent_name, pc.fld_child_name 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/c4b50/6)。

如果您有已知数量的要转换的问题，上述方法效果很好。如果您有未知号码，那么您可以使用类似于以下的准备好的语句：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'max(case when a.fld_quetion_id = ''',
      fld_quetion_id,
      ''' then a.fld_ans end) AS q',
      fld_quetion_id
    )
  ) INTO @sql
FROM tbl_feedback_admini;

SET @sql = CONCAT('SELECT pc.fld_parent_name, 
                    pc.fld_child_name, ', @sql, ' 
                  from tbl_parent_child_details pc
                  left join tbl_feedback_admini a
                    on pc.fld_parent_id = a.fld_parent_id
                  left join tbl_feedback_children c
                    on pc.fld_parent_id = c.fld_parent_id
                    and a.fld_quetion_id = c.fld_quetion_id
                  group by pc.fld_parent_name, pc.fld_child_name');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/c4b50/10)

两者都将返回结果：

```
| FLD_PARENT_NAME | FLD_CHILD_NAME | Q1 | Q2 | Q3 |
---------------------------------------------------
|             Dev |       angelina |  4 |  5 |  2 |
|             Tom |            Ray |  1 |  3 |  2 | 
```

# javascript - 将 AJAX POST 的参数传递给 Grails 控制器

> ID：13905416
> 
> 赞同：5
> 
> 时间：2012-12-16T20:57:43.663
> 
> 标签：javascript, jquery, ajax, grails, params

我正在用 Grails 构建一个社交网络，并坚持让用户在他们的 editprofile 页面内有机会将一个 youtube-Url 粘贴到一个文本字段中，并通过单击一个按钮，一个 JS 正则表达式将 id 从粘贴的 URL 中取出，一个 ajax 帖子是使用 youtube 视频的预览图像更新 div

html看起来像：

```
 <g:textField name="videoinput" class="videoinput reLef" value="" />
                    <span class="daten_videouploadbtn reLef" ></span>

        <g:render template="/forms/storedVideos" /> 
```

JS看起来像：

```
 $('.daten_videouploadbtn').click(function() {

        var string = document.editProfileForm.videoinput.value;
        var neu = string.replace(/http[s]?:\/\/(?:[^\.]+\.)*(?:youtube\.com\/(?:v\/|watch\?(?:.*?\&)?v=|embed\/)|youtu.be\/)([\w\-\_]+)/i, '$1'); 
        var id = RegExp.$1;

        jQuery.ajax({
        type:'POST',
        data:RegExp.$1, 
        url:'${createLink(action: 'addVideo')}',
        success:function(data,textStatus){jQuery('#storedvideos').html(data);},
        error:function(XMLHttpRequest,textStatus,errorThrown){}
        });
}); 
```

控制器看起来像：

```
def addVideo() {
    def videoitems = !!%%-- HOW TO PARSE YOUTUBE-ID HERE -%%!!
    render(template:"/forms/storedVideos", model: [newVideo:videoitems])
} 
```

和存储的视频看起来：

```
 <div id="storedvideos"><span><img src="http://img.youtube.com/vi/${newVideo}/default.jpg" width="225px" height="130px"/></span></div> 
```

我只是不明白如何捕获 Ajax Post 的数据并使用内部带有 id 的预览图像更新 div，

有人可以给个提示吗？它正在杀死我

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T21:05:10.427

您应该像这样发布数据：

```
jQuery.ajax({
  type: 'POST',
  data: { value: RegExp.$1 },
  ... 
```

之后，您可以使用`params.value`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-31T05:33:43.093

我在 Grails 2.0.4 上得到了这个：

**Javascript/Ajax**

```
var data = 
   {requestId: 12456,
    node: "node1",
    host: "mynode.com"};

    $.ajax({            
      url: '/myurl',
      data: JSON.stringify(data),
      type: 'post',
      contentType: 'application/json; charset=utf-8',
      dataType: 'json',
      success: function() ...
      },
      error: function() ...
      }
}); 
```

**在圣杯中......**

```
def service(){   
  def jsonObj = request.JSON
} 
```

我喜欢这种方法，因为它`request.JSON`解析数据并返回一个可以使用的对象。

# android - MapView：在路线上画线

> ID：13905417
> 
> 赞同：1
> 
> 时间：2012-12-16T20:57:46.427
> 
> 标签：android, android-mapview, draw, routes

我正在尝试在谷歌的 MapView 上绘制路线。但我的线不是像这样在屏幕截图中画在街道上

![示例图片](../Images/a313456ec1351fd64a0773d6e2da1e99.png)

我用过这段代码：

```
 GeoPoint gp1;
    GeoPoint gp2 = null;
    StringBuilder sb = new StringBuilder();
      sb.append("http://maps.google.com/maps/api/directions/xml").append("?origin=").append(origin)
      .append("&destination=").append(destination)
      .append("&mode=driving&sensor=true&language=de");
    System.out.println(sb.toString());
    xmlPaser parser = new xmlPaser();
    String xml = parser.getXmlFromUrl(sb.toString());
    Document doc = parser.XmlFromString(xml);
    System.out.println(doc);
    NodeList start = doc.getElementsByTagName("start_location");
    NodeList end = doc.getElementsByTagName("end_location");
    for (int intLoop = 0 ; intLoop < start.getLength() ; intLoop++){
        Element eStart = (Element) start.item(intLoop);
        Element eEnd = (Element) end.item(intLoop);
        String test = parser.getValue(eStart, "lat");
        String test2 = parser.getValue(eStart, "lng");
        if (intLoop == 0){
            gp1 = new GeoPoint((int) (Double.parseDouble(parser.getValue(eStart, "lat")) * 1E6),(int) (Double.parseDouble(parser.getValue(eStart, "lng")) * 1E6));
        }else{
            gp1 = gp2;
        }
        gp2 = new GeoPoint((int) (Double.parseDouble(parser.getValue(eEnd, "lat")) * 1E6),(int) (Double.parseDouble(parser.getValue(eEnd, "lng")) * 1E6));
        ViewMap.getMap().getOverlays().add(new DirectionPathOverlay(gp1, gp2));
    }
} 
```

如何在街道叠加层上画线？谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T11:58:42.733

我已经解决了这个问题。如果其他人有同样的问题，我会发布这个答案。

start- & end_location 只是路线的要点。要绘制路线的详细视图，您必须使用 xml 并将其解析为 geoPoint。

为此，我使用了此功能：[polyline to geoPoints](http://jeffreysambells.com/2010/05/27/decoding-polylines-from-google-maps-direction-api-with-java)

那么你必须将 geoPoints 传递给你的 draw 方法。

问候。

# fonts - 如何在 Lua 中更改字体颜色？

> ID：13905423
> 
> 赞同：0
> 
> 时间：2012-12-16T20:58:25.043
> 
> 标签：fonts, lua, coronasdk

我是 Lua 的新手，使用 Corona，我无法弄清楚如何更改字体颜色。 `color = { 163, 25, 12 }`不起作用。

```
myButton = widget.newButton{
        id = "open_id",
        left = 12,
        top = 360, 
        label = "open",
        fontSize = 16,
    font = "Helvetica Neue Bold",
    color = { 163, 25, 12 },
        width = 294, 
        height = 40,
        cornerRadius = 2,
        onEvent = onButtonEvent
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T03:36:51.760

尝试这个：

```
myButton = widget.newButton{
    id = "open_id",
    left = 12,
    top = 360, 
    label = "open",
    fontSize = 16,
    font = "Helvetica Neue Bold",
    labelColor = { default = { 163, 25, 12 }, over = { 163, 25, 12} },
    width = 294, 
    height = 40,
    cornerRadius = 2,
    onEvent = onButtonEvent
} 
```

看：

[http://docs.coronalabs.com/api/library/widget/newButton.html](http://docs.coronalabs.com/api/library/widget/newButton.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T08:31:12.540

[http://developer.coronalabs.com/reference/index/widgetnewbutton](http://developer.coronalabs.com/reference/index/widgetnewbutton)

标签颜色表。此表应包含标签颜色的红色、绿色、蓝色和 alpha 通道，处于“默认”和“过度”状态。这是一个示例表： { default={ 128, 255, 96, 255 }, over={ 0 } }

# sql-server-2008 - SQL Server TDE - 如何判断何时完成？

> ID：13905428
> 
> 赞同：4
> 
> 时间：2012-12-16T20:58:54.237
> 
> 标签：sql-server-2008, encryption, tde

使用 SQL 2008 TDE 时，有没有办法判断数据库何时完全加密？IE，

ALTER DATABASE mydb SET ENCRYPTION ON

我能想到的唯一方法是继续尝试分离 mydb。在所有页面都加密之前，它不会分离。但是，我想要一种不涉及分离的更清洁的方式？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T23:01:36.707

看起来可以在 中找到此信息[`sys.dm_database_encryption_keys`](http://msdn.microsoft.com/en-us/library/bb677274.aspx)。

`encryption_state = 3`表示数据库和日志是加密的。`encryption_state = 2` 表示正在进行加密，在这种情况下，您可能还想查看该`percent_complete`列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-15T19:27:06.463

旧的，但我会把它放在这里。注意“percent_complete”

SELECT DB_NAME(database_id) DbName, encryption_state EncryptState, percent_complete, key_algorithm KeyAlgorithm, key_length KeyLength, encryptor_type EncryptType FROM sys.dm_database_encryption_keys;

# file-upload - Alfresco 共享文件上传过滤器

> ID：13905434
> 
> 赞同：2
> 
> 时间：2012-12-16T20:59:23.793
> 
> 标签：file-upload, filter, yui, alfresco, alfresco-share

我的文件上传过滤器不适用于 Alfresco YUI（或 flash？）上传。我有以下代码：

```
 if (null == this.fileUpload) {
            this.fileUpload = Alfresco.getFileUploadInstance();
        }
        var filter = new Array({description:"Images", extensions:"*.jpg;*.png;*.gif"});
        var uploadConfig = {
            mode: this.fileUpload.MODE_SINGLE_UPLOAD
            , username: Alfresco.constants.USERNAME
            , siteId: Alfresco.constants.SITE
            , uploadDirectory: '/'
            , containerId: 'Logo'
            , filter: filter
            , onFileUploadComplete: {
                fn: this.onFileUploadComplete
                , scope: this
            }
        };
        this.fileUpload.show(uploadConfig); 
```

这一切都很酷，并且可以上传文件。我可以上传文件，没有问题。但问题是过滤器没有。我在这个配置中缺少什么？

我正在使用 Alfresco Share Community 版本 4.2c。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-23T15:02:26.367

兹拉杜里克，

我相信过滤器必须单独定义。以下对我有用：

```
this.fileUpload = Alfresco.getFileUploadInstance();
var description = "Images";
var extensions = ["*.jpeg", "*.jpg", "*.png", "*.gif"];
var filter = new Array(
    {description: description, extensions: extensions[0]},
    {description: description, extensions: extensions[1]},
    {description: description, extensions: extensions[2]},
    {description: description, extensions: extensions[3]}
);
var uploadConfig = {...};
this.fileUpload.show(uploadConfig); 
```

我希望这有帮助。

# javascript - Javascript按名称获取特定元素（父元素）

> ID：13905435
> 
> 赞同：8
> 
> 时间：2012-12-16T20:59:59.910
> 
> 标签：javascript, getelementsbyname

我正在使用自定义标签来定义应用程序中的部分，所以我有这样的东西：

```
<mysection>

   <form>
       <input name="myfield">
   </form>

</mysection> 
```

我正在使用以下内容并能够获取标签（打印到控制台，一切都很时髦）

```
var parent = document.getElementsByTagName('mysection'); 
```

我遇到的问题是按名称查找子字段：

```
var myfield = parent.getElementsByName("myfield"); 
```

...因为我不想接听任何其他可能具有名称为“myfield”的输入的“部分”。

**编辑：**

```
var parent = document.getElementsByTagName('mysection')[0]; 
```

被建议并返回到控制台部分内容，但是，`getElementsByName`抛出一个错误：

```
Uncaught TypeError: Object #<NodeList> has no method 'getElementsByName' 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-16T21:02:56.057

使用`getElementsByTagName()`and`getElementsByName()`将返回一个 NodeList，您需要像这样获取列表的第一个元素：

```
var parent = document.getElementsByTagName('mysection')[0];
var myfield = parent.getElementsByName("myfield")[0]; 
```

**编辑**

你是`getElementsByName`对的，对元素无效。我不确定如何在您尝试做的时候本地化它的功能。似乎它只适用于`document`. `getElementsByName`如果您想在本地化范围内使用它，您可能必须编写自己的实现。

**第二次编辑**

说得好，我为你做了那个实现：D 这就是它的“荣耀”。

```
Element.prototype.getElementsByName = function (arg) {
    var returnList = [];
    (function BuildReturn(startPoint) {
        for (var child in startPoint) {
            if (startPoint[child].nodeType != 1) continue; //not an element
            if (startPoint[child].getAttribute("name") == arg) returnList.push(startPoint[child]);
            if (startPoint[child].childNodes.length > 0) {
                BuildReturn(startPoint[child].childNodes);
            }
        }
    })(this.childNodes);
    return returnList;
};
var parent = document.getElementsByTagName('mysection')[0];
var myfield = parent.getElementsByName("myfield")[0]; 
```

**小修复**

我错误地将元素而不是它的子元素传递给递归。上面的代码已经用现在传递的正确参数进行了编辑。见工作小提琴：http: [//jsfiddle.net/js6NP/5/](http://jsfiddle.net/js6NP/5/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-18T14:44:37.143

我实际上找到了一种更简单的方法来处理这个问题：

```
document.querySelectorAll('mysection [name="myfield"]'); 
```

在这里您可以看到一个示例，它仅修改指定部分内的字段：http: [//jsfiddle.net/fluidbyte/kph6H/](http://jsfiddle.net/fluidbyte/kph6H/)

qSA 支持现代浏览器并兼容到 IE8，这是一个支持回到 IE7 的 polyfill：[https ://gist.github.com/2724353](https://gist.github.com/2724353)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-02-14T02:22:01.323

`getElementsByName`不适用于 DOM 元素引用。使用`querySelector`或`querySelectorAll`代替。例如：

```
var parent  = document.getElementsByTagName('mysection')[0];
var myfield = parent.querySelector("[name='myfield']"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-16T21:03:06.030

只需使用 ID：

```
<mysection>
    <form>
         <input name="myfield" id="fieldName">
    </form>
</mysection> 
```

```
var myfield = document.getElementById("fieldName"); 
```

ID[在页面上应该是唯一的](http://www.w3.org/TR/html401/struct/global.html#h-7.5.2)。所以你不应该在访问正确的元素时遇到问题。

如果您确实***必须***使用名称/标记名，`getElementsByTagName`并且`getElementsByName`两者都总是返回一个`array`（如果没有找到元素，则为空）。您可以访问正确的元素，就像访问数组中的元素一样：
`document.getElementsByTagName('mysection')[0];`对于带有 tagname 的第一个元素`mysection`。

# android - Android：固定数字键盘

> ID：13905438
> 
> 赞同：0
> 
> 时间：2012-12-16T21:00:29.583
> 
> 标签：android, android-layout, android-edittext

我有一个 EditText，当点击一个数字键盘时，通过`android:inputType="number"`. 发生这种情况时，尽管它会将上方的 TextViews 推离屏幕。我想知道是否有办法始终显示数字键盘（然后我可以为所有内容设置固定位置）？

（我没有太多的活动，所以这不像我想节省空间。）我希望用户能够看到被推离屏幕的 TextView，因为它们是根据输入更新的。这是它的样子：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".Name" >

// TextViews that get pushed off

<EditText
    android:id="@+id/editText"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_marginBottom="71dp"
    android:layout_toLeftOf="@+id/enter_input"
    android:ems="10"
    android:inputType="number" >

    <requestFocus />
</EditText>

</RelativeLayout> 
```

这可能吗？还是有更好的方法让所有内容都显示在屏幕上而没有隐藏任何内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:05:38.257

您可以`android:windowSoftInputMode="stateAlwaysVisible"`在 AndroidManifest.xml 中添加您的活动，以便它强制键盘始终显示。

```
<activity android:name="[activity_path]" android:windowSoftInputMode="stateAlwaysVisible"/> 
```

# java - 在java中读取c程序的stdout

> ID：13905450
> 
> 赞同：0
> 
> 时间：2012-12-16T21:02:21.987
> 
> 标签：java, c, stdout

所以我有一个通过 ProcessBuilder 调用 C 程序的 Java 程序，我需要 C 程序在发生某些事情时通知 Java 程序。我有以下java prog代码：

```
 String cmd[] = //string to run the c program in the terminal, no probs here
    ProcessBuilder builder = new ProcessBuilder(cmd);
    builder.redirectErrorStream(true);
    Process process = builder.start();

    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
    System.out.println(bufferedReader.ready());
    System.out.println(bufferedReader.readLine()); 
```

在给定点的 c 程序必须通知 java 程序一些事情。我尝试了很多事情，比如

```
char Buff[] = "output";
write(0, Buff, strlen(Buff)+1);
write(1, Buff, strlen(Buff)+1);
printf("output\n"); 
```

但我无法让 java 程序读取这个，我得到的唯一输出是

```
false
null 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:50:46.230

在刷新缓冲区之前，Java 程序不会看到输出。

级别的缓冲`write`取决于操作系统，即使在同一个操作系统中，不同类型的流也可能具有不同的默认缓冲模式。在 Linux 中，文档暗示`write`管道将立即被其他进程读取，并且`ProcessBuilder`至少在 Android 中使用管道。

`stdio.h`如果您使用它，很可能[`fflush`](http://www.codecogs.com/reference/computing/c/stdio.h/fflush.php)会将数据一直推送到套接字或管道。例如，我`fflush`在 Android 中使用`ProcessBuilder`.

行缓冲是操作系统的另一种可能选择。在这种情况下，附加`\n`到您的消息可能会产生影响。

顺便说一句，在同一个程序中混合`write`和`printf`调用是自找麻烦。正如已经提到`write(0`的，尝试写入`stdin`，并`strlen(buf)+1`导致将最后一个零字节发送到 Java 程序，这不太可能是您想要的。

# sql - sql文件中缺少GO

> ID：13905464
> 
> 赞同：0
> 
> 时间：2012-12-16T21:03:46.183
> 
> 标签：sql, eclipse, encoding

我有一个构建和执行 sql 语句/字符串的 java 应用程序。当我从 Eclipse 运行应用程序时，一切正常。

但是当我运行已部署/二进制应用程序（从二进制文件中读取 .sql 资源）时，我收到以下错误：

```
Exception in thread "main" java.lang.RuntimeException: Error executing sql:
..
Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Incorrect syntax near the keyword 'IF'. 
```

从 Eclipse 运行和运行已部署的应用程序时，我尝试将 sql 字符串写入文件。除了这些小差异之外，这两个文件几乎相同：

1）工作字符串以：'go'开头

2) 工作字符串在 IF 之前有 'go'

任何想法为什么源版本有这些标签而构建版本没有？我使用 gradle 构建并将编译器设置为使用 UTF-8：

```
[project.compileJava, project.compileTestJava]*.options*.encoding = 'UTF-8' 
```

这就是我从 jar 文件中读取文件的方式：

```
 InputStream inputStream = jarFile.getInputStream(entry);
  StringWriter writer = new StringWriter();
  IOUtils.copy(inputStream, writer, "UTF-8");
  String string = writer.toString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:18:52.200

这`go`不是 SQL 突击队，它是 Eclipse 中的突击队。它用于分隔查询批次。

要在 SQL 中运行查询，请删除`go`命令（如果可能，不更改结果），或在`go`命令上拆分文件并一次运行一批。

# asp.net - BreezeJS 与 JayData 在 ASP.NET MVC 上进行 SPA 开发

> ID：13905465
> 
> 赞同：15
> 
> 时间：2012-12-16T21:03:50.940
> 
> 标签：asp.net, entity-framework, knockout.js, breeze, jaydata

作为一名 Web 开发人员，我最近发现了使用[KnockoutJS](http://knockoutjs.com/)的乐趣，但在使用服务器时，我几乎只能靠自己了。我考虑[过 BreezeJS](http://www.breezejs.com/home)和[JayData](http://jaydata.org/)的 CRUD 功能和批处理操作，但我仍然不确定哪个最适合我。

我现在专注于使用 EF 进行 ASP.NET MVC 开发，但稍后我可能会切换到其他平台，因此我不希望局限于一个特定的框架。在这方面，JayData 在 BreezeJS 上提供了许多提供程序，例如 OData、webSQL、IndexedDB、localStore、Facebook 和 YQL，这几乎是压倒性的。BreezeJS 确实支持 OData，但仅用于消费。

但是，易用性、文档和其他我可能没有想到的关键特性呢？

感谢您帮助我在它们之间进行选择。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-17T09:41:55.057

我是 JayData 开发团队的成员，但我也尝试过 Breeze。通过易用性来比较它们是主观的，这取决于你的口味。这些库的目的是相同的：保护开发人员不实现协议并专注于数据管理。但是 JayData 不仅仅是一个 ORM 库，而是一个统一的数据管理范式和工具，可以在[服务器端](http://jaydata.org/blog/install-your-own-odata-server-with-nodejs-and-mongodb)使用它来构建自己的 PaaS/BaaS。由于 JayData 是在 2012 年 5 月发布的 provider-model，我们有更多的时间来实现更多的数据提供者（你错过了服务器端的 MongoDB 和 WebAPI，它们将在几天内发布）并支持许多开发者平台。我会提到 TypeScript 支持和[在线-离线](http://jaydata.org/blog/how-to-create-a-synchronized-online-offline-data-application-with-javascript-and-jaydata)*功能得益于统一的 API，如果您现在*想使用该库，这一点很重要。

Breeze 在路线图上也有很好的特性，我相信你总体上它将是一个有用的库，而不仅仅是用于以舒适的方式使用 WebAPI 服务。

文档或多或少相同，两个团队都提供企业和社区支持。

如果你只想从 JavaScript 访问 WebAPI，我会根据我喜欢的 UI 库/模板引擎来选择库：Breeze：Knockout、Angular、Backbone（希望 Breeze 的人会用内幕消息更新它） JayData：Knockout（带有动态查询)、Angular（即将推出教程）、Handlebars、Sencha（只读）、KendoUI（几天后推出）。

两个开发团队都很乐于助人并倾听标签，因此您可以询问这些库如何解决业务问题或满足项目的技术要求。

# android - 检测屏幕关闭/打开的替代方法

> ID：13905466
> 
> 赞同：0
> 
> 时间：2012-12-16T21:03:57.917
> 
> 标签：android, android-intent, broadcastreceiver, screen

是否有另一种方法来检测 Android 中的屏幕开/关？我目前正在使用接收器`ACTION_SCREEN_ON`并`ACTION_SCREEN_ON`捕获了意图，但在 API 17 中它被[窃听了](http://code.google.com/p/android/issues/detail?id=41513&q=action_screen_off&colspec=ID%20Type%20Status%20Owner%20Summary%20Stars)（结合接近唤醒锁定）。

# c# - 数据库中的继承在超类表中创建了不必要的外键列

> ID：13905468
> 
> 赞同：1
> 
> 时间：2012-12-16T21:04:05.297
> 
> 标签：c#, database-design, inheritance, entity-framework-4.1, ef-code-first

我在如何为实体类中的继承关系生成数据库时遇到问题。它正确地使子类表中的主键 ID 引用超类表中的 ID - 但它也在超类表中创建了一个不需要的外键。这是我的课程：

抽象超类：

```
public abstract class DaqObject
{
    public int ID { get; set; }
    public int AgencyID { get; set; }
    public int DaqObjectTypeID { get; set; }

    [ForeignKey("AgencyID")]
    public virtual Agency Agency { get; set; }
    [ForeignKey("DaqObjectTypeID")]
    public virtual DaqObjectType DaqObjectType { get; set; }

    public virtual Document InheritingDocument { get; set; }
} 
```

对应的数据库表有以下列：

*   ID（PK，int，不为空）
*   AgencyID (FK, int, not null)
*   DaqObjectTypeID (FK, int, not null)
*   InheritingWell_ID (FK, int, null)

子类：

```
public class Document : DaqObject
{
    public string Name { get; set; }
} 
```

使用具有以下列的相应数据库表：

*   ID（PK、FK、int，不为空）
*   名称 (nvarchar(max), null)

（这些类已被精简为示例。）

数据库中的 DaqObject 表以 InheritingDocument_ID 列结束。我可以自己创建数据库并在超类表中没有该外键的情况下建立关系。是否可以让 EF 代码先做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T23:09:09.883

`InheritingDocument`中的告诉EF 在和实体`DaqObject`之间创建一对多关系。这就是为什么您的数据库中有该列的原因。`Document``DaqObject``InheritingDocument_ID`

我想，这不是你想要的，你已经添加了`InheritingDocument`属性来使继承工作，对吧？没有必要，EF 会自动处理继承处理。有一篇不错的[博客文章](http://weblogs.asp.net/manavi/archive/2010/12/24/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-1-table-per-hierarchy-tph.aspx)，描述了使用 EF 处理继承类的可能策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T06:29:03.127

InheritingDocumentID 是为属性生成的字段

```
public virtual Document InheritingDocument { get; set; } 
```

该关系由 EF 默认创建。

目前尚不清楚，但是什么是`InheritingWell_ID (FK, int, null)`字段，我认为您发布的代码缺少某些内容。

您可以将`[NotMapped]`属性添加到 InheritingDocument 属性以避免为其生成字段，但要使其正常工作，您还需要将 DbSet 添加到 db 上下文中，这将为[每个层次结构提供五个表](http://weblogs.asp.net/manavi/archive/2010/12/24/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-1-table-per-hierarchy-tph.aspx)（一个表用于层次结构中的所有类型），速度更快但它不在 3NF 中。

# c++ - openCV 2.4.3 iOS 框架编译器无法识别一些 C++ 头文件

> ID：13905471
> 
> 赞同：11
> 
> 时间：2012-12-16T21:04:15.653
> 
> 标签：c++, ios, xcode, opencv

openCV 2.4.3 / Xcode 4.5.2 / mac osx 10.8.2

我正在尝试让 openCV 与 iOS 一起工作。我正在尝试使用来自 openCV.org 的预构建 2.4.3 框架。但是，我收到以下 xcode 项目构建错误，表明编译器不知道它正在处理 c++，例如

```
#include <list>       !'list' file not found

namespace cv          !unknown type name 'namespace' 
```

这似乎只涉及以下头文件：
“opencv2/nonfree/features2d.hpp”
“opencv2/nonfree/nonfree.hpp”
“opencv2/video/video.hpp”

如果我不在 opencv.hpp （或其他任何地方）中包含这三个文件，我似乎能够编译和使用 openCV ok。问题是，我在试验 SURF 时确实需要非自由文件——它最近已移至非自由文件。

这确实是一个双重问题（对不起;-)

*   如何让编译器相信这些是 C++ 头文件？
*   我需要使用 SURF 哪些标头？

**更新**

我已经克隆了 openCV git 存储库并从中构建了一个新框架。这种方法以前不起作用，但今天我意识到我没有使用当前版本的 CMAKE。我一直在使用 CMAKE 2.8.2，这将无法为 ios 构建 opencv。当前版本 CMAKE 2.8.10 构建它没有任何问题（这是遵守文档的对象教训，确实说 CMAKE min. v2.8.8 是必需的）。

现在，当我在 Xcode 项目中添加当前构建的 opencv 框架时，我可以包含*features2d*和*nonfree*并顺利构建。唯一的问题仍然是一个标题：`video/background_segm.hpp`，它仍然产生：

```
#include <list>       !'list' file not found 
```

如果我*将该*行注释掉，我会在下一行收到错误消息：

```
namespace cv          !unknown type name 'namespace' 
```

很明显，编译器不会将其识别为 C++ 头文件，即使它的后缀为`.hpp`.

如果`opencv2/video/video.hpp` 我删除

```
#include "opencv2/video/background_segm.hpp" 
```

我也可以构建`video.hpp`（尽管我想它在实践中是不可用的）。

不幸的是，我仍然无法让 SURF 工作。当我运行该项目时，它会因以下错误而崩溃：

> OpenCV 错误：功能/特性未实现（OpenCV 是在没有 SURF 支持的情况下构建的）

这是在以下情况下触发的`legacy/features2d.cpp`：

```
 Ptr<Feature2D> surf = Algorithm::create<Feature2D>("Feature2D.SURF");
   if( surf.empty() )
        CV_Error(CV_StsNotImplemented, "OpenCV was built without SURF support"); 
```

问题仍然...

*   如何说服编译器`background_segm.hpp`是合法的 c++ 头文件？
*   如何启用 SURF 支持？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-04T05:53:34.387

我现在一切正常。在对 openCV.org 提供的预构建 iOS 库不满意之后，这就是我所做的......

*   从 gitHub 存储库的克隆中为 iOS 编译 openCV。运行`build_framework.py`（在`ios`分发的文件夹中），指向您选择的输出目录。*确保拥有最新的 CMake 副本，*否则您会像我一样绊倒。

*   您的输出文件夹将包含两个子文件夹，`build`并且`opencv2.framework`. 将后者拖到您的 Xcode 项目中

`project-Prefix.pch`在文件中添加以下行

```
#ifdef __cplusplus
#import <opencv2/opencv.hpp>
#endif 
```

（应该*超过*线`#ifdef __OBJC__`）

这足以让大部分 openCV 正常工作。然而，避免“objective-C++”是一个非常好的主意（将你的 c++ 代码与你的objective-C 混合在同一个文件中）。为了管理这个，你创建一个瘦的“包装器”对象（它将是 obj-C++）在你的 obj-C 类和 c++ 代码之间进行调解。包装器本质上只有两个角色：转换数据格式（例如 UIImage <-> cv::Mat），以及在 obj-C 方法和 C++ 函数调用之间进行转换。有关详细信息，请参阅[我对这个问题的回答](https://stackoverflow.com/questions/13958321/iosretrieve-rectangle-shaped-image-from-the-background-image/14123682#comment19597798_14123682)（以及 github 托管的示例项目）

要使 SURF（和 SIFT）正常工作，需要几个额外的步骤，因为 SURF[由于许可问题而在某种程度上已被弃用](http://docs.opencv.org/trunk/modules/nonfree/doc/nonfree.html)（它已被移至`nonfree`不会自动加载的位置）。

这些包括需要添加到您使用 SURF 的文件中

```
#include <opencv2/nonfree/nonfree.hpp>
#include <opencv2/legacy/compat.hpp> 
```

我正在使用的代码使用 SURF 的 C 接口（例如`cvExtractSURF`），所以我们还需要在调用这些函数之前添加这一行：

```
 cv::initModule_nonfree(); 
```

我的问题的另一部分，即如何强制 Xcode 编译为 C++，有点牵强附会（我使用的 openCV 构建肯定存在兼容性问题）——并且不再需要此解决方案。然而答案是首先，将你的 .m 文件重命名为 .mm （对于 Objective-C++）或 .cpp （对于纯 C++）……但是如果这不起作用，你可以通过更改 'file 在文件检查器中强制问题类型'。

*更新*

您还需要注意在任何使用 openCV 框架的项目中正确设置 C++ 标准库。旧版本的 openCV (to.2.4.2) want `libstdc++`，新版本 (2.4.3+) expect `libc++`。详情在这里：

[https://stackoverflow.com/a/14186883/1375695](https://stackoverflow.com/a/14186883/1375695)

*更新 2*

openCV 现在与 cocoaPods 一起安装。引用[塞巴斯蒂安·蒂博的话](https://github.com/SebastienThiebaud/OpenCV-iOS)

> > OpenCV 在 Cocoapods 上可用。在您的 Podfile 中添加一行：pod 'OpenCV'。相当容易。

“很容易”......考虑到我们之前的所有麻烦，可能是[去年]的轻描淡写......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-03T10:59:31.437

openCV 实现类只需将 .m 添加到 .mm 作为实现文件。

```
#import <UIKit/UIKit.h>
#import <opencv2/opencv.hpp>

@interface ViewController : UIViewController

@end 
```

![在此处输入图像描述](../Images/91cdd6b02e47823ee6a562573abf7422.png) .mm 文件在 iOS 的 C++ 编译器中运行，因此不会显示错误。

# android - Android：如何获取最近的任务列表和 origActivity？

> ID：13905474
> 
> 赞同：-1
> 
> 时间：2012-12-16T21:04:41.877
> 
> 标签：android, task, activity-manager

我想获取最近的任务列表。

我使用以下代码，但是当我尝试获取 origActivity 信息时，origActivity 始终为空：

```
ActivityManager activityManager = (ActivityManager) c.getSystemService(Context.ACTIVITY_SERVICE);
List<RecentTaskInfo> recentTasks = activityManager.getRecentTasks(8,0); 
```

我想知道列表中所有活动的应用程序标签、包名和活动名。

了解这些元素的唯一方法是使用 RecentTaskInfo 中的 origActivity，但它始终为空（我得到 NullPOinterException）。

我能得到的唯一信息是活动 ID。

有没有办法知道所有最近任务的应用程序标签、包名称和活动名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-17T09:11:11.540

要获取所有包名和类名，请使用基本意图变量。下面的示例取自 AdapterView 的 getView() 函数。

```
final ActivityManager.RecentTaskInfo temp = this.getItem(position); 
final String packagename = temp.baseIntent.getComponent().getPackageName();
final String label = getPackageManager().getApplicationLabel(getPackageManager().getApplicationInfo(packagename, PackageManager.GET_META_DATA)) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-02-09T19:10:59.087

您必须持有此权限
`GET_TASKS`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-16T21:19:10.047

我使用此代码来初始化活动管理器

```
 activityManager = (ActivityManager) getSystemService(ACTIVITY_SERVICE); 
```

你为什么不使用

```
 List<RunningAppProcessInfo> rpinfo= activityManager.getRunningAppProcesses(); 
```

从这里你可以得到你想要的所有信息，并且列表根据最近的任务进行排序。意味着最近使用的任务位于顶部，您可以获得尽可能多的最近任务
并获得应用程序标签

```
PackageManager pm=getApplicationContext().getPackageManager();  
ApplicationInfo ai;

try {
    ai=pm.getApplicationInfo(processName, 0);
    name=(String) pm.getApplicationLabel(ai);
} 
```

# javascript - 使用 jQuery ASP.NET 网页错误发布表单值

> ID：13905479
> 
> 赞同：0
> 
> 时间：2012-12-16T21:05:13.080
> 
> 标签：javascript, jquery, json, asp.net-webpages, webmatrix-2

我正在尝试使用 jQuery 将转换为 JSON 的表单数据发送到另一个页面，. 但是，我相信我的 POST 方法不起作用，因为我总是收到错误消息 - 只显示“错误”。谁能帮我找出确切的错误或修改代码以使其正确？

我检查了数据是否正确地被 JSON 化（第一个警报显示正确的表单数据）。

```
$('#submit').click(function () {
    var rows = [];

    $('#Tinfo tbody tr').each(function () {

        var tds = $(this).children('td');  /* taking all the td elements of the current tr */
        rows.push({
            'sl': tds.eq(0).find('input').val(),
            'tname': tds.eq(1).find('input').val(),
            'ttype': tds.eq(2).find('select').val(),
            'tduration': tds.eq(3).find('input').val()

        });
    });
    rows = JSON.stringify(rows); 
    alert(rows);

    /* Using the post function to send data over to the database handler page */

    $.ajax({
        type: "POST",
        url: "/Insert",
        data: rows,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data, status) {
            alert(status);
        },
        error: function (xhr, textStatus, error) {
            console.log(xhr.statusText);
            console.log(textStatus);
            console.log(error);

        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:12:01.313

我认为您的网址有问题。它应该是： url: "Webpage/function" 你只是在使用函数部分。看这个例子：

[http://weblogs.asp.net/karan/archive/2010/09/12/calling-server-side-method-using-jquery-ajax.aspx](http://weblogs.asp.net/karan/archive/2010/09/12/calling-server-side-method-using-jquery-ajax.aspx)

# c - 不将二维数组的行数传递给c中的函数

> ID：13905482
> 
> 赞同：1
> 
> 时间：2012-12-16T21:05:57.590
> 
> 标签：c, rows, sizeof, multidimensional-array

我可以使用 c 中的 sizeof 运算符进行一些计算，以获取函数中的行数，该函数仅接收一个二维数组作为参数，而没有关于此传递数组中的行数或列数的任何信息？

```
void main(void){
    int A[5][6];
    int columnsC = sizeof(A[0]) / sizeof(int);
    int rowsC = ( sizeof(A)/sizeof(int) ) / columnsC;
    printf("rows: %d\ncolumns: %d\n", rowsC, columnsC);

    getch();
} 
```

以前的代码对我有用，但我找不到有用的资源来了解如何将其应用于以下标头的函数：

```
void fun(int arr[][10]) 
```

我正在学习编程语言原理课程，有时会以不同的方式思考问题并寻找学习资源，这很有帮助，但这次显然不是。

我很佩服任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-16T21:12:50.890

不。当传递给函数时，无法找到数组的大小。数组在传递给函数时衰减为指针。

这个：

```
void fun(int arr[][10]) 
```

实际上是合成糖：

```
void fun(int (*arr)[10]) 
```

相反，您可以将大小作为第三个参数传递，或者将大小作为数组本身的元素传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:12:32.393

我不相信这是可能的，除非您传递一个长度，或者您专门为数组分配一个额外的行。这个额外的行可以包含一个空字符。在函数 fun 中，您可以使用 while 循环循环遍历数组，直到达到空值。

```
int i = 0;
while (1) {
    if(arr[i]==NULL){
        //exits when hits end    
        break;
    }
    //do stuff with arr[i]
    i++;
} 
```

# c - 管道尺寸是多少

> ID：13905486
> 
> 赞同：0
> 
> 时间：2012-12-16T21:07:03.253
> 
> 标签：c, linux

> **可能重复：**
> [管道缓冲区大小是 4k 还是 64k？](https://stackoverflow.com/questions/4624071/pipe-buffer-size-is-4k-or-64k)

1.  在 linux 中，哪个头文件指定了可用于写入管道的大小？

2.  我捕获每个可配置周期的主应用程序的延迟并将该数据写入管道。一个单独的报告过程会读取该管道。通常，主应用程序每秒交换大约 10,000 条消息。因此，给定一秒的周期，主应用程序为每个消息交换收集 10k 延迟数据点，然后将它们写入一秒边界上的管道。在这种情况下我有以下问题

    *   有没有办法在创建时指定管道的大小，所以我可以确保管道中有足够的写入空间？
    *   写入管道是否昂贵？管道是如何实现的？对管道的写入是否会针对某些 mmap 文件或内存缓冲区？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:58:14.987

*   *有没有办法在创建时指定管道的大小？* **也许**。从 Linux 2.6.35 开始，您可以使用[fcntl(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/fcntl.2.html)将`F_SETPIPE_SZ`管道缓冲区设置为`/proc/sys/fs/pipe-max-size`. 在早期版本中，**没有**，但我想您可以改用套接字机制。大多数情况下它会比较慢，但是您可以指定缓冲量到 wmem_max，请参阅 socket(7)，并且您可以对内核内存分配进行某些其他控制。
*   *写入管道是否昂贵？* **不**，但是 write(2)*是*内核调用，因此管道 I/O 应尽可能缓冲。
*   *管道是如何实现的？*使用内核代码将数据传入和传出系统缓冲区缓存。
*   *对管道的写入是否会针对某些 mmap 文件或内存缓冲区？* 这是一个内存缓冲区

# c++ - 未处理的异常 (C++)

> ID：13905487
> 
> 赞同：-2
> 
> 时间：2012-12-16T21:07:12.093
> 
> 标签：c++, visual-studio-2010

我在用 DIrectX9 编写小游戏时遇到了一些问题。我遇到了一个未处理的异常，在许多尝试中我似乎无法修复它。我将不胜感激有关此问题的一些见解。我使用了调试器，我只是不知道如何修复异常。

输出：AACF.exe 中 0x00061afd 处的未处理异常：0xC0000005：访问冲突读取位置 0x00000000。

似乎“数据”结构中的数据都等于0x00000000；我将如何解决这个问题？

System.cpp 中对异常进行了注释。

异常位置文件：

```
// System.cpp //

#include "Core.h"

struct {
    LPDIRECT3D9 D3D;
    LPDIRECT3DDEVICE9 D3DDEV;
    LPD3DXSPRITE D3DSPT;
    LPD3DXFONT DXFONT;
    LPDIRECT3DTEXTURE9 DisplayTexture;
} Data;

void System::InitD3D(bool Windowed, int ScreenW, int ScreenH) {
    Data.D3D = Direct3DCreate9(D3D_SDK_VERSION);
    D3DPRESENT_PARAMETERS D3DPP;

    ZeroMemory(&D3DPP, sizeof(D3DPP));
    D3DPP.Windowed = Windowed;
    D3DPP.SwapEffect = D3DSWAPEFFECT_DISCARD;
    D3DPP.hDeviceWindow = hWnd;
    D3DPP.BackBufferFormat = D3DFMT_X8R8G8B8;
    D3DPP.BackBufferWidth = ScreenW;
    D3DPP.BackBufferHeight = ScreenH;
    D3DPP.PresentationInterval = D3DPRESENT_INTERVAL_IMMEDIATE;

    Data.D3D->CreateDevice(D3DADAPTER_DEFAULT,
                      D3DDEVTYPE_HAL,
                      hWnd,
                      D3DCREATE_SOFTWARE_VERTEXPROCESSING,
                      &D3DPP,
                      &Data.D3DDEV);
    D3DXCreateSprite(Data.D3DDEV, &Data.D3DSPT);

    Load_Display();

    return;
}

void System::Render_Frame(void) {
    // EXCEPTIONS START HERE
    // Data.D3DDEV->Clear gives an exception
    Data.D3DDEV->Clear(0, NULL, D3DCLEAR_TARGET, D3DCOLOR_XRGB(0, 0, 0), 1.0F, 0); // Exception line
    Data.D3DDEV->BeginScene();
    Data.D3DSPT->Begin(D3DXSPRITE_ALPHABLEND);

    Draw_Display();

    Data.D3DSPT->End();
    Data.D3DDEV->EndScene();
    Data.D3DDEV->Present(NULL, NULL, NULL, NULL);
    return;
}

void System::CleanD3D() {
    Data.DisplayTexture->Release();
    Data.D3DDEV->Release();
    Data.D3D->Release();
    return;
}

void System::Load_Display() {
    LoadTexture(&Data.DisplayTexture, L"DisplaySprites.png");
    D3DXCreateFont(Data.D3DDEV, 20, 0, FW_BOLD, 1, false, DEFAULT_CHARSET,
                   OUT_DEFAULT_PRECIS, ANTIALIASED_QUALITY, DEFAULT_PITCH | FF_DONTCARE,
                   L"Arial", &Data.DXFONT);
    return;
}

void System::Draw_Display() {
    return;
}

void System::LoadTexture(LPDIRECT3DTEXTURE9* Texture, LPCTSTR FileName) {
    D3DXCreateTextureFromFileEx(Data.D3DDEV, FileName, D3DX_DEFAULT, D3DX_DEFAULT,
                                D3DX_DEFAULT, NULL, D3DFMT_A8R8G8B8, D3DPOOL_MANAGED, D3DX_DEFAULT,
                                D3DX_DEFAULT, D3DCOLOR_XRGB(255, 0, 255), NULL, NULL, Texture);
    return;
}

void System::DrawTexture(LPDIRECT3DTEXTURE9 Texture, RECT TexCoords, float X, float Y, int A) {
    D3DXVECTOR3 Center(0.0F, 0.0F, 0.0F), Position(X, Y, 0.0F);
    Data.D3DSPT->Draw(Texture, &TexCoords, &Center, &Position, D3DCOLOR_ARGB(A,255,255,255));
    return;
}

void System::DrawString(const char* Text, int Count, RECT Rect, float X, float Y, int A, int R, int G, int B) {
    SetRect(&Rect, 0, 0, (int)X, (int)Y);
    Data.DXFONT->DrawTextA(NULL,
                      Text,
                      Count,
                      &Rect,
                      DT_BOTTOM | DT_RIGHT,
                      D3DCOLOR_ARGB(A, R, G, B));
}

void System::DrawNumber(int SetValue, RECT Rect, float X, float Y, int A, int R, int G, int B) {
    SetRect(&Rect, 0, 0, (int)X, (int)Y);
    static char Number[10];
    _itoa_s(SetValue, Number, 10);
    Data.DXFONT->DrawTextA(NULL,
                       (LPCSTR)&Number,
                       strlen((LPCSTR)&Number),
                       &Rect,
                       DT_BOTTOM | DT_RIGHT,
                       D3DCOLOR_ARGB(A, R, G, B));
} 
```

System.cpp 头文件：

```
// System.h //

// Include Guard //
#ifndef _SYSTEM_H
#define _SYSTEM_H

#include "Core.h"

// Globalizing Data Structure
struct Data;

// Define screen resolution and keyboard macros
#define SCREEN_WIDTH    (1000)
#define SCREEN_HEIGHT   (700)
#define KEY_DOWN(vk_code) ((GetAsyncKeyState(vk_code) & 0x8000) ? 1 : 0)
#define KEY_UP(vk_code) ((GetAsyncKeyState(vk_code) & 0x8000) ? 0 : 1)

// WinProc ProtoType
LRESULT CALLBACK WindowProc(HWND hWnd, UINT Message, WPARAM wParam, LPARAM lParam);

class System {
private:
    HWND hWnd;
public:
    System() {};
    void InitD3D(bool Windowed, int ScreenW, int ScreenH);
    void Render_Frame(void);
    void CleanD3D(void);
    void Load_Display();
    void Draw_Display();
    void LoadTexture(LPDIRECT3DTEXTURE9* Texture, LPCTSTR FileName);
    void DrawTexture(LPDIRECT3DTEXTURE9 Texture, RECT TexCoords, float X, float Y, int A);
    void DrawString(const char* Text, int Count, RECT Rect, float X, float Y, int A, int R, int G, int B);
    void DrawNumber(int SetValue, RECT Rect, float X, float Y, int A, int R, int G, int B);
};

#endif 
```

其它文件：

```
// Core.h //

// Include Guard //
#ifndef _CORE_H
#define _CORE_H

// Pragma Comments
#pragma comment(lib, "d3d9.lib")
#pragma comment(lib, "d3dx9.lib")

// External Include <> //
#include <Windows.h>
#include <WindowsX.h>
#include <d3d9.h>
#include <d3dx9.h>

#include <vector>
#include <map>
#include <iostream>
#include <tchar.h>

// Internal Incldue "" //
#include "System.h"

#endif

// Core.cpp //

#include "Core.h"

int WINAPI WinMain(HINSTANCE hInstance,
                   HINSTANCE hPrevInstance,
                   LPSTR lpCmdLine,
                   int nCmdShow) {
    System Sys;
    HWND hWnd;
    WNDCLASSEX WC;

    ZeroMemory(&WC, sizeof(WNDCLASSEX));

    WC.cbSize = sizeof(WNDCLASSEX);
    WC.style = CS_HREDRAW | CS_VREDRAW;
    WC.lpfnWndProc = (WNDPROC)WindowProc;
    WC.hInstance = hInstance;
    WC.hCursor = LoadCursor(NULL, IDC_ARROW);
    WC.lpszClassName = L"WindowClass";

    RegisterClassEx(&WC);
    hWnd = CreateWindowEx(NULL, L"WindowClass", L"Game Name",
                          WS_OVERLAPPEDWINDOW, 0, 0, SCREEN_WIDTH, SCREEN_HEIGHT,
                          NULL, NULL, hInstance, NULL);
    ShowWindow(hWnd, nCmdShow);
    // Set up Direct3D
    Sys.InitD3D(TRUE, SCREEN_WIDTH, SCREEN_HEIGHT);
    // Enter Main Loop
    MSG Msg;
    while(TRUE) {
        DWORD Starting_Point = GetTickCount();
        if(PeekMessage(&Msg, NULL, 0, 0, PM_REMOVE)) {
            if(Msg.message == WM_QUIT)
                break;
            TranslateMessage(&Msg);
            DispatchMessage(&Msg);
        }
        Sys.Render_Frame();
        // Check escape key
        if(KEY_DOWN(VK_ESCAPE))
            PostMessage(hWnd, WM_DESTROY, 0, 0);
        while((GetTickCount() - Starting_Point) < 25);
    }
    Sys.CleanD3D();
    return Msg.wParam;
}

LRESULT CALLBACK WindowProc(HWND hWnd, UINT Message, WPARAM wParam, LPARAM lParam) {
    switch(Message) {
    case WM_DESTROY:
        {
            PostQuitMessage(0);
            return 0;
        } break;
    }
    return DefWindowProc(hWnd, Message, wParam, lParam);
}

bool CheckCollision(float Ax, float Ay, float Aw, float Ah, float Bx, float By, float Bw, float Bh) {
    if(Ay+Ah < By) return false;
    else if(Ay > By+Bh) return false;
    else if(Ax+Aw < Bx) return false;
    else if(Ax > Bx+Bw) return false;

    return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:53:28.357

我不是 DirectX 方面的专家，但这是我要开始的地方。首先，您的 InitD3D() 可能应该返回一个 bool 或具有除 void 以外的返回类型，因为它可能会失败。

对于初学者，我会检查以确保 Create() 函数已成功。例如，我可能会添加如下内容：

```
//Returns NULL pointer on failure.
Data.D3D = Direct3DCreate9(D3D_SDK_VERSION);

if(!Data.D3D)
    return false; 
```

当你去创建设备时：

```
HRESULT hr = Data.D3D->CreateDevice(D3DADAPTER_DEFAULT,
                  D3DDEVTYPE_HAL,
                  hWnd,
                  D3DCREATE_SOFTWARE_VERTEXPROCESSING,
                  &D3DPP,
                  &Data.D3DDEV);

if(hr != D3D_OK)
    return false; 
```

我至少会做一些基本的错误检查。如果设备创建成功并且在调用时有值，您可以排除这种情况。自从我使用 DirectX 以来已经有一段时间了，所以您可能必须在返回 false 之前释放（）/清理一些东西，但这是基本思想。

很容易在调用时检查设备是否为价值。在发生异常的行上设置断点。当你点击它时，在调试器中检查 Data.D3DDEV 的值。如果它为 null 并且具有`0x00000000`您试图尊重空指针的值。

# python - 在opencv中计算python中的轮廓

> ID：13905499
> 
> 赞同：1
> 
> 时间：2012-12-16T21:09:52.950
> 
> 标签：python, opencv, count

我有一个 python 程序的问题，我想在 C 中计算以下示例中的硬币，并将其转换为 python。

[硬币轮廓](http://bsd-noobz.com/opencv-guide/60-1-counting-coins-in-an-image)

到目前为止，我无法找到 C 行的等价物：

```
sprintf(msg, "Found %d coins.", contours.size()); 
```

我的主要问题是“contours.size()”，我尝试用 len() 替换该代码，但它给了我 154 而不是 4，请参见下面的代码：

```
contours = cv.FindContours(cv.CloneImage(image_threshed), cv.CreateMemStorage(0), cv.CV_RETR_LIST, cv.CV_CHAIN_APPROX_SIMPLE)

cv.DrawContours(image, contours, cv.RGB(255,0,0), cv.RGB(0,255,55), 2,1,8)

NumeroContornos = str(len(contours))

font = cv.InitFont(cv.CV_FONT_HERSHEY_SIMPLEX, .5, .5, 0, 1, 8)
cv.PutText(image,NumeroContornos, (5,17),font, cv.RGB(250,0,0)) 
```

我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:18:14.180

当您使用 cv.FindContours 函数查找轮廓时，它会返回一个 cvSeq 对象。它返回多个链接序列，您必须遍历它们以获取所有轮廓。

所以起初，指针只指向第一个轮廓，比如你的第一枚硬币。当您使用`len(contour)`时，它只返回该轮廓内的点，即您的第一枚硬币的点。所以现在你可以想象你是如何得到 154 的。这不是轮廓的数量，而是轮廓内的点数。看到这些点，`print list(contour)`当你在图像上画出这些点时，你可以看到它们都构成了一枚硬币的边界。

现在选择下一个轮廓，或下一个硬币，使用`contour = contour.h_next()`等等。

我认为没有内置函数可以返回轮廓数，除非您遍历轮廓并对其进行计数。

试试这个并检查它是否打印 4 个 cvSeq 对象：

```
while contours:
    print contours
    contours = contours.h_next() 
```

我在这里解释了所有这些事情：['list（contour）'的结果是什么意思？](https://stackoverflow.com/questions/9060254/what-does-result-of-listcontour-denote)

相反，我建议您使用`cv2`更简单更好的新界面。在那里，轮廓作为 Numpy 数组列表返回，您可以使用 len(contour) 来查找轮廓的数量。

您可以在此处找到 cv 和 cv2 之间差异的简要说明：[所有这些 OpenCV Python 接口之间有什么不同？](https://stackoverflow.com/questions/10417108/what-is-different-between-all-these-opencv-python-interfaces/10425504)

旧`cv`界面很快就会过时。所以最好迁移到新`cv2`界面。

# objective-c - 除非文件类型为 png，否则 Air Print Action 不执行任何操作

> ID：13905501
> 
> 赞同：0
> 
> 时间：2012-12-16T21:10:27.757
> 
> 标签：objective-c, ios, xcode, printing, airprint

与 Air Print 争吵不按按钮做任何事情，我试图从屏幕上打印文件（我第一次实现这个）

我已经添加了`UIPrintInteractionControllerDelegate`in .h

.m 连接了我的按钮，该按钮已被检查为正常工作

按钮处理程序代码：

```
 NSString *path = [[NSBundle mainBundle] pathForResource:@"mylocalhtmlfile" ofType:@"HTML"];
NSData *dataFromPath = [NSData dataWithContentsOfFile:path];

UIPrintInteractionController *printController = [UIPrintInteractionController sharedPrintController];

if(printController && [UIPrintInteractionController canPrintData:dataFromPath]) {

    printController.delegate = self;

    UIPrintInfo *printInfo = [UIPrintInfo printInfo];
    printInfo.outputType = UIPrintInfoOutputGeneral;
    printInfo.jobName = [path lastPathComponent];
    printInfo.duplex = UIPrintInfoDuplexLongEdge;
    printController.printInfo = printInfo;
    printController.showsPageRange = YES;
    printController.printingItem = dataFromPath;

    void (^completionHandler)(UIPrintInteractionController *, BOOL, NSError *) = ^(UIPrintInteractionController *printController, BOOL completed, NSError *error) {
        if (!completed && error) {
            NSLog(@"FAILED! due to error in domain %@ with error code %u", error.domain, error.code);
        }
    };

    [printController presentAnimated:YES completionHandler:completionHandler];

} 
```

除非文件类型设置为`png`

# jquery - 不可见时隐藏图像

> ID：13905502
> 
> 赞同：0
> 
> 时间：2012-12-16T21:10:31.470
> 
> 标签：jquery, html, css, image, animation

我目前正在构建一个使用 jQuery 为滚动设置动画的单页网站。我有一个使用 jQuery Ajax 嵌入的 Tumblr 博客。当博客加载了所有图像时，它会滞后于滚动动画。

作为一种帮助方法，我不会加载博客，直到 scrollTop 处于某个范围或博客内，即使这样也只会在用户没有滚动至少半秒时加载（以在滚动过去时停止触发元素）

但是，就像我说的那样，一旦加载图像，就会导致滚动滞后。当不在视图中时隐藏图像（它们已经加载）并且仅在用户没有滚动经过它们时才显示它们的最佳方法是什么？这样当滚动动画直接经过它们时它们会保持隐藏状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:19:45.673

你可以简单地使用`jQuery("#your-image").hide();`

但是您可能遇到的问题是浏览器缓存泄漏。因此，您可以做的是从 DOM 中删除图像，但是您必须在用户每次滚动到时重新加载它们，您将获得巨大的数据传输。所以我建议简单地使用`hide()`jQuery 中的函数，但这并不能解决缓存问题。

启动 Google Chrome 并使用提供的开发人员工具是一件好事。只需按下`f12`键盘并查看`Timeline`. 在顶部（左侧）的第三个选项卡中，您可以选择`memory`，这非常高吗？像这样的网站的一个很大的危险是内存溢出。这意味着 JavaScript 垃圾收集器无法删除所有`unused`对象。所以确保你做对了。

*   [http://api.jquery.com/hide/](http://api.jquery.com/hide/)
*   [https://developers.google.com/chrome-developer-tools/](https://developers.google.com/chrome-developer-tools/)
*   [https://developers.google.com/chrome-developer-tools/docs/timeline](https://developers.google.com/chrome-developer-tools/docs/timeline)

**编辑**：我在 Smashing Magazine 的 Facebook 页面上发现[了这篇](http://www.html5rocks.com/en/tutorials/speed/scrolling/)文章，您可能会发现它很有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:35:57.647

也许您可以使用低分辨率或更小的缩放图像来替换当前不可见的图像。然后，一旦 scrollTop 使它们可见，您就可以重新加载这些图像的高分辨率版本。理想情况下，用户应该缓存这两个版本，这样他只能看到半秒钟的低分辨率图像。

# objective-c - ImageIO 链接器错误？

> ID：13905503
> 
> 赞同：0
> 
> 时间：2012-12-16T21:10:35.383
> 
> 标签：objective-c, macos, cocoa, linker, javax.imageio

尝试使用 ImageIO 框架从图像中准备元数据（例如`kCGImagePropertyExifBodySerialNumber`或 ）。`kCGImagePropertyExifLensModel`

不幸的是在编译期间链接器有一个麻烦：

```
Undefined symbols for architecture x86_64:
"_kCGImagePropertyExifBodySerialNumber", referenced from:
      -[AppDelegate applicationDidFinishLaunching:] in AppDelegate.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

`ImageIO/CGImageProperties.h`当然是导入的，并且`ImageIO.framework`包含在目标配置中的“链接框架和库”列表中。

仅当我尝试使用`kCGImagePropertyExifBodySerialNumber`or 时才会发生这种情况`kCGImagePropertyExifLensModel`。同一个项目`kCGImagePropertyExifFocalLength`，`kCGImagePropertyExifExposureTime`使用没有任何问题

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T03:47:47.220

这些常量似乎没有在 ImageIO 框架的 SDK 版本中定义。您可以使用以下命令自行检查：

```
nm /Volumes/Applications/Developer\ Tools/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk/System/Library/Frameworks/ApplicationServices.framework/Frameworks/ImageIO.framework/imageio | grep -F kCGImagePropertyExifBodySerialNumber 
```

（根据需要编辑 Xcode 的路径。）

我现在在一台 Lion 机器上，同一个框架的系统版本确实有它：

> ```
> % nm /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ImageIO.framework/imageio  | grep -F kCGImagePropertyExifBodySerialNumber
> 00000000000e4898 s _kCGImagePropertyExifBodySerialNumber 
> ```

因此，我建议[提交一个错误](https://bugreport.apple.com/)，然后作为一种解决方法，在项目的构建设置中取消设置 SDKROOT（“Base SDK”）。如果没有设置 SDK，它应该使用您正在构建的系统的框架和标头。

该解决方法的缺点是，如果您使用在 Mountain Lion 上引入的任何东西，您将无法在 Lion 上构建。

# php - PHP 未定义索引错误 - isset 似乎没有缓解

> ID：13905505
> 
> 赞同：0
> 
> 时间：2012-12-16T21:10:55.977
> 
> 标签：php, undefined-index

我正在帮助一个拥有较旧网站的客户遇到几年前编写的代码（不确定这是否相关，但我提到它以防万一）并且尽管使用了各种建议，但仍不断收到未定义的索引错误（即 isset）在网站上提到。大多数情况下，我正在从旧服务器上移动文件，该站点运行良好，所以我不确定为什么会收到此错误。我认为这与未设置变量“sessionID”有关，但我在现有代码中找不到设置它的任何地方 -

```
<?php
session_start();
error_reporting(E_ALL);
if ($_SESSION['sessionID'] != session_id() || !$_SESSION['userID']) { 
// login page   
} else {
// admin page
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:28:17.173

PHP 错误包含调试问题所需的所有信息。它提供：

1.  错误级别（E_WARNING、E_NOTICE、E_ERROR 等...）。
2.  通常描述问题的短消息（在您的情况下为未定义索引以及使用未定义索引的变量的名称）。
3.  发生错误的 PHP 脚本的名称（这包括系统上脚本的完整路径，以便您可以轻松找到它）。
4.  调用错误处理程序的行号（这正是该文件中发生错误的位置）。

这是一个 PHP 错误的例子，就像你得到的那样......

> 注意：未定义的索引：第 2 行 /tmp/test.php 中的 sessionID

你有一切你需要弄清楚你是如何得到这个错误的。例如，通过查看此错误消息，我可以告诉您的是，从文件**/tmp/test.php的****第 2 行**开始，我还没有在数组**$_SESSION中定义索引****sessionID**。

 ******这很容易通过始终检查变量是否首先使用[isset()](http://php.net/isset)定义来解决。

```
if (isset($_SESSION['sessionID']) && $_SESSION['sessionID'] != session_id()) {
    // login page 
} else {
    // admin page
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-16T21:17:11.257

未定义的索引是一个通知，而不是一个错误。设置 error_reporting(E_ALL ^ E_DEPRECATED ^ E_NOTICE) 并查看是否可以解决所有问题。******

# java - Android Java 代码没有正确计算

> ID：13905509
> 
> 赞同：-1
> 
> 时间：2012-12-16T21:11:29.707
> 
> 标签：java, android

添加两个数字时，我的 Android 程序的结果很奇怪。这是我用来找出发生了什么的测试代码：

```
private static final float yChannel[] = {12.0f, 8.0f, 4.0f, 0};

protected void onCreate(Bundle savedInstanceState) {
    Log.i("Rectangles","y1: " + yChannel[0]+2.0f);
    Log.i("Rectangles","y2: " + yChannel[0]);
} 
```

LogCat 结果是：

```
y1: 12.02.0
y2: 12 
```

我根本不明白所有变量都是浮动的。我的代码不起作用，因为它没有给出正确的结果。我还尝试清理 Eclipse 项目。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-16T21:13:17.260

```
"Rectangles","y1: " + yChannel[0]+2.0f 
```

是字符串连接，因为第一个操作数是字符串。

试试这个

```
Log.i("Rectangles","y1: " + (yChannel[0]+2.0f)); 
```

或者

```
float temp = yChannel[0]+2.0f;
    Log.i("Rectangles","y1: " + temp); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:14:58.253

您需要在浮点计算周围加上括号，因为参数在添加到字符串时会被转换为字符串

# android - 如果可能的话，如何（以及何时？）取消 LocationManager.requestSingleUpdate？

> ID：13905512
> 
> 赞同：1
> 
> 时间：2012-12-16T21:11:51.127
> 
> 标签：android, gps, locationmanager

关于 LocationManager 和获取用户位置的不同方法有很多问题。但是，他们中的大多数都集中在准确性上，由于要求不同，我的方法有点不同。我需要的是一个大约。用户的 GPS 位置，但应尽可能快（但仅在用户点击按钮后）和一些 EditText 框应填充坐标。问题是在大多数情况下，设备上的数据传输将被禁用，因此网络位置将不可用。我必须坚持使用设计无法快速的 GPS。所以这就是我所做的：

单击按钮时，我调用主 Activity 的 getGPS() 方法，因为我不关心准确性（我只需要获取大约坐标）我正在检查最后一个已知位置，代码中的注释是不言自明

```
public void getGPS(View view) {
    // load all available Location providers
    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    List<String> providers = locationManager.getProviders(false);
    // determine the last known location within 2 hours available from cache
    Location myLocation = null;
    Date now = new Date();
    long time = now.getTime();
    long timeDiff = LOCATION_MAX_AGE;
    for (int i=providers.size()-1; i>=0; i--) {
        Location l = locationManager.getLastKnownLocation(providers.get(i));
        if (l != null) {
            long t = l.getTime();
            if (time - t < timeDiff) {
                myLocation = l;
                time = t;
                timeDiff = time - t;
            }
        }
    }
    // if failed to get cached location or if it is older than 2 hours, request GPS position
    if (myLocation == null) {
        if (locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
            pIntent = PendingIntent.getBroadcast(context,
                    0,
                    new Intent(SINGLE_UPDATE_ACTION),
                    PendingIntent.FLAG_UPDATE_CURRENT);

            IntentFilter iFilter = new IntentFilter(SINGLE_UPDATE_ACTION);
            receiver = new BroadcastReceiver() {
                @Override
                public void onReceive(Context context, Intent intent) {
                    // when received an answer from the LocationManager
                    Location gpsLocation = (Location) intent.getExtras().get(LocationManager.KEY_LOCATION_CHANGED);
                    fillLocation(gpsLocation);
                    Log.d(TAG, "Received GPS location: " + gpsLocation.getLatitude() + ", " + gpsLocation.getLongitude() + " Time: " + gpsLocation.getTime());
                    locationManager.removeUpdates(pIntent);
                    unregisterReceiver(receiver);
                }
            };
            context.registerReceiver(receiver, iFilter);
            // I'm absolutely fine with getting the first available GPS position and that's enough to me.
            locationManager.requestSingleUpdate(LocationManager.GPS_PROVIDER, pIntent);
         // if GPS is disabled in settings allow user to enable it
        } else {
            showGPSDisabledAlertToUser();
        }
    } else {
        // if fresh enough lastKnownLocation is found
        fillLocation(myLocation);
    }
} 
```

一切都很好，在大多数情况下，用户点击按钮后会立即出现 lastKnownLocation 和坐标。但是当我不那么幸运时，GPS图标出现了，问题就来了。由于没有可用的数据连接，因此 GPS 定位需要比平时更长的时间。在此期间，Activity 仍然可以访问，用户并没有真正意识到坐标即将出现。另一个问题是当用户无法在合理的时间内获得 GPS 定位时，他应该能够取消请求。

所以，我的问题是：这里最好的方法是什么？更具体地说：是否有可能（以及如何？）向用户显示诸如等待对话框之类的内容（例如“正在获取 GPS 位置...”）和一个按钮“取消”，这可能会中断请求并使用户返回主界面活动，停止任何 GPS 活动并显示祝酒词，要求用户手动输入坐标？

抱歉，如果这很简单，我刚刚开始学习为 Android 开发，我的应用程序几乎完成了，除了这件事。我非常努力地搜索，不幸的是没有找到任何东西。提前谢谢了！

编辑：在我发布问题半小时后，我意识到我可能已经知道答案了。我可能需要打开一个带有等待光标的对话框来阻止 UI，显示我的消息和一个取消按钮并从那里请求 LocationManager。如果用户在我们得到修复之前单击取消，那么我应该取消注册我的接收器并关闭对话框。当然我明天会试试这个，但是非常欢迎任何想法或建议甚至评论！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T08:38:15.217

由于 Luis 回答了我的第二个问题（基本上是“何时？”取消请求），我将把答案添加到我的第一个和主要问题（虽然更简单）：是的，可以在 requestSingleUpdate 方法之后取消 GPS 搜索如果您只是取消注册侦听器并删除更新，请致电。我在取消按钮的 onClick 方法中执行此操作。还有一件事要记住：如果 GPS 得到修复并返回位置，则调用 ProgressDialog 的 cancel() 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:22:47.850

我建议您使用[ProgressDialog](http://developer.android.com/reference/android/app/ProgressDialog.html)来通知正在等待修复的用户。您也可以设置消息并向`Cancel`其添加按钮。请参阅此链接：[如何在进度对话框中设置取消按钮？](https://stackoverflow.com/questions/7037433/how-to-set-cancel-button-in-progress-dialog)

如果用户取消`ProgressDialod`，那么您将启动屏幕并请求手动输入。

问候。

# twig - Symfony 2.1 和 MopaBootstrapBundle（达到了“100”的最大函数嵌套级别，正在中止！）

> ID：13905513
> 
> 赞同：0
> 
> 时间：2012-12-16T21:11:54.840
> 
> 标签：twig, symfony-2.1

我在 symfony 2.1.5-DEV 中通过 Composer 安装了 MopaBootstrapBlundle。在 Appkernel.php 中激活捆绑包后，我收到一个致命错误。

致命错误：达到“100”的最大函数嵌套级别，正在中止！在第 78 行的 /home/sandy/desarrollo/www/bengala/frontbengala.dev/vendor/twig/twig/lib/Twig/Token.php

我在其他带有 sf 2.0.x 的项目中使用了这个包，没有问题。

如何解决错误？

# php - 突出关键字

> ID：13905518
> 
> 赞同：1
> 
> 时间：2012-12-16T21:12:30.903
> 
> 标签：php, regex, string

我想通过 PHP 突出显示句子中的关键字。

这是我的代码：

```
preg_replace("/\p{L}*?".preg_quote($string)."\p{L}*/ui", "<b>$0</b>", $info->plaintext) 
```

现在我想知道如何突出显示下一个和上一个单词。

例子：

> 好人不一定要温暖可爱

如果关键字是**Cuddly**，它应该会突出显示**温暖和可爱。**所以脚本应该绕过***和，或***用它突出**温暖**。

另一个简单的例子（`good`是关键字）：

句子：

> 这所学校是一所非常好的学校。

结果：

> 这所学校是一所**非常好的**学校。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:19:16.423

这些方面的东西：

```
preg_replace('/(\p{L}+\s+((and|or|a)\s+)*)?\p{L}*?' . preg_quote($string) . '\p{L}*/ui', '<b>$0</b>', $info->plaintext) 
```

如果您在单词后也需要“和 *”，只需将相同的逻辑应用到末尾即可。[这是一个演示。](http://codepad.viper-7.com/57cQL2)

# android - 使用 Android 注释时 Intellij IDEA 中的重复类

> ID：13905520
> 
> 赞同：1
> 
> 时间：2012-12-16T21:12:37.673
> 
> 标签：android, intellij-idea, android-annotations

我在我的 android 项目中使用 Intellij IDEA 和 Android Annotations。当我必须在重建项目之前删除手动自动生成的类时，如何避免这个小烦人的事情？

这是我正在谈论的错误

![在此处输入图像描述](../Images/a7fb126725fae6549552cf5b77a2562c.png)

为了让它工作，我必须手动删除由 Android Annotations 生成的类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T08:22:55.950

此问题将在 IDEA 12.0.1 中修复。

12.0 版本的解决方法：从编译中明确排除具有生成源的根。你可以在`Settings`| `Compiler`| **排除**.

# java - 为什么我们使用struts标签而不是旧的HTML标签，它带来了什么不同？

> ID：13905528
> 
> 赞同：3
> 
> 时间：2012-12-16T21:13:59.163
> 
> 标签：java, struts2

我是 struts 的新手，想知道为什么当它们似乎都在做同样的事情时，我们为什么要在以前的 html 标记上引用 struts 标记，使用 struts 标记而不是 html 标记的优势是什么。像

```
<s:form action="myAction">
    <s:textfield name="username"></s:textfield>
    <s:textfield name="password"></s:textfield>
    <s:submit name="submit" value="submit"></s:submit>
</s:form>

<form action="myAction" method="post">
    <input type="text" name="username"/>
    <input type="text" name="password"/>
    <input type="submit" name="submit"/>
</form> 
```

google了一下，还没有得到满意的答复，请多多指教

我知道它添加了一些额外的东西，比如标签或其他东西，这对我来说很好，但我想知道它是否对性能或任何特定于请求对象的东西有任何作用，其他任何东西只是避免程序员的额外输入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T03:34:31.373

有不同类型的 Struts 2 标签。

表单标签尤其有用，但它们的功能完全取决于所使用的 Struts 2 主题。`"simple"`除了标准的 HTML 标记之外，该主题几乎没有提供任何好处。默认`"xhtml"`主题发出表格行和一些样式。自定义主题实现您想要的任何功能。无论主题如何，底层 JSP 源都不需要更改。

主要优点是：

*   验证错误消息
*   表格展示/造型
*   框架集成（例如，从操作中自动填充的值）

还有一组 Dojo（非常不推荐）和 jQuery 标签，它们在自定义标签中封装了大量的 JavaScript 功能，这使得简单的动态功能*非常*简单。

还有非视图标签，例如`<s:iterator>`等。它们的一些功能是 JSTL 的副本（`<c:forEach>`在迭代器标签的情况下）。在这种情况下，当功能重叠时，使用 S2 标签并没有太多好处。

一些标签没有 JSTL 模拟，例如`<s:merge>`或`<s:sort>`. ，是否适合视图层的功能是一个不同的讨论。一些提供与 Struts 2 其他方面的集成，如 I18N（例如，`<s:text>`）。有些人了解 Struts 2 配置（例如，`<s:url>`）。

*任何*自定义标记的目的都是为了简化视图层编程（例如，JSP）。S2 提供了很多标签来帮助解决这个问题。有些是简单和通用的（非 UI 标签），而 UI 标签是使用 FreeMarker 实现的并且是高度可定制的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T21:18:49.240

在这个特定的例子中，不是很多，但好处是它在解析时被替换为 HTML，并且它被替换的内容是可定制的*。*您可以定义一个标准表单模板，并`<s:form>`用它替换。

换句话说，它（理论上）是标准化网站行为并尽量减少打字。

**更新：** Steven 指出了一个更有价值的原因，Struts 可以智能地填充和更新`<s:form>`字段，例如在提交错误后留下填写的表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-30T04:58:27.367

Struts 纯粹使用 JAVA！因此，即使程序员不了解 HTML/JAVASCRIPT，他仍然可以使用 struts 的内置标签来解决问题。Struts 还提供了内置的验证工具，就像 Javascript 一样。

# ruby-on-rails - Rails 在评估 nil.each 时发生错误

> ID：13905532
> 
> 赞同：0
> 
> 时间：2012-12-16T21:14:51.443
> 
> 标签：ruby-on-rails

我正在为名为 wostatuses 的表添加第二个索引文件。第一个索引 (index.html.erb) 工作正常。但是，第二个索引 (index2.html.erb) 在行上得到“评估 nil.each 时发生错误”：

```
<% @wostatuses.each do |wostatus| %> 
```

控制器具有：

```
class WostatusesController < ApplicationController
# GET /wostatuses
# GET /wostatuses.json
def index
  @wostatuses = Wostatus.order("position")

  respond_to do |format|
    format.html # index.html.erb
    format.json { render json: @wostatuses }
  end
 end 
```

index.html.erb 和 index2.html.erb 有：

```
 <% @wostatuses.each do |wostatus| %> 
```

在路线中，我有：

```
 get "wostatuses/index"
  get "wostatuses/index2" 
```

谢谢您的帮助！！

更新 -

```
<% Wostatus.find_each do |wostatus| %> worked!!!! 
```

但是，我需要 wostatus.position 排序的记录。我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:43:53.410

您必须使用与**index1**相同的代码在控制器中为**index2**执行操作。您还可以创建一个具有通用功能的方法，并在两个操作中使用该方法，以便编写可重用的代码。

# sublimetext2 - ST2 默认 (OSX).sublime-keymap:5:5 解析错误

> ID：13905535
> 
> 赞同：0
> 
> 时间：2012-12-16T21:15:05.143
> 
> 标签：sublimetext2

保存默认 ST2 键盘映射文件时出现此错误。有没有办法获得一个没有这个问题的新键盘映射文件？

错误是：`Error trying to parse file: Unexpected character, expected a comma or closing bracket in ~/Library/Application Support/Sublime Text 2/Packages/User/Default (OSX).sublime-keymap:5:5`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T18:24:05.200

听起来您已经为默认值添加了一个额外的右括号。您应该能够从“原始包”中复制“原始”版本的键盘映射。

# websocket - Safari 后台运行时 iOS 上的 Socket.IO 中断

> ID：13905536
> 
> 赞同：1
> 
> 时间：2012-12-16T21:15:09.337
> 
> 标签：websocket, mobile-safari, socket.io

我有一个使用 Socket.IO 支持 WebSocket 的移动 Web 应用程序，它运行良好，除非我按下主页按钮然后返回 Safari。如果我通过转到另一个应用程序来后台运行 Safari，然后再返回到它，则 WebSocket 连接将不再起作用。

注意：转到 Safari 中的不同选项卡然后返回不会破坏 WebSocket——我实际上必须离开 Safari 应用程序。

尝试通过套接字发送消息时，我的 Web 控制台上没有出现任何错误，它只是不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T13:39:56.093

当应用程序在 iOS 中被“最小化”时，它不仅仅是将应用程序放在后台，而且更重要的是，它缓存应用程序，实际上停止处理它，以节省电池并防止任何后台应用程序工作和做“坏事” ”。

这就是它中断连接的原因，这是 iOS 的正常行为。

要恢复会话，您的服务器端应用程序逻辑应该实现会话并能够在新连接上恢复它（如果它不久前关闭）。

有关信息，Android 库存浏览器将保持连接，但会冻结 JS 的处理，因此如果您的应用程序实现超时，它将在您的服务器识别为无响应后丢弃 Android 客户端。转到另一个选项卡也会降低 JS 的性能，这样会减慢定时函数和回调的内部堆栈，并且不要期望它们以与您专注于选项卡时相同的频率运行。

# java - jlabel 上的图标获取 jlabel 的大小

> ID：13905539
> 
> 赞同：1
> 
> 时间：2012-12-16T21:15:29.300
> 
> 标签：java, swing, icons, jlabel

我正在使用带有摇摆图标的 Jlabel。我从我的计算机中选择了一张图像作为图标，但我找不到让它自动调整为 Jlabel 大小的方法。因为我想要的图像比 Jlabel 的大小要大得多，所以我只看到了其中的一小部分。有什么办法可以解决这个问题，这样我就不需要在将每个图像导入到项目之前调整它的大小了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T21:17:26.350

可能是您的[`LayoutManger`](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)/ 缺乏干扰，因为`JLabel`应该根据显示的内容返回正确的大小。

请发布[SSCCE](http://sscce.org)以显示具体问题。

尽管仍然需要缩放大图像，但这是我通常使用的一个不错的方法：

```
public static BufferedImage scaleImage(int w, int h, BufferedImage img) throws Exception {
    BufferedImage bi;
    bi = new BufferedImage(w, h, BufferedImage.TRANSLUCENT);
    Graphics2D g2d = (Graphics2D) bi.createGraphics();
    g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
    g2d.addRenderingHints(new RenderingHints(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY));
    g2d.drawImage(img, 0, 0, w, h, null);
    g2d.dispose();
    return bi;
} 
```

这是一个例子：

![在此处输入图像描述](../Images/ac3692ba2aa235580e8067f3ea0a8aa5.png)

```
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.RenderingHints;
import java.awt.image.BufferedImage;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.SwingUtilities;

public class Test {

    public Test() {
        initComponents();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Test();
            }
        });
    }

    private void initComponents() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        BufferedImage img = null;
        try {
            BufferedImage tmp = ImageIO.read(new URL("http://photos.appleinsider.com/12.08.30-Java.jpg"));
            img = scaleImage(200, 200, tmp);
        } catch (Exception ex) {
            ex.printStackTrace();
        }

        JLabel label = new JLabel(new ImageIcon((Image) img));
        frame.add(label);
        frame.pack();
        frame.setVisible(true);
    }

    public static BufferedImage scaleImage(int w, int h, BufferedImage img) throws Exception {
        BufferedImage bi;
        bi = new BufferedImage(w, h, BufferedImage.TRANSLUCENT);
        Graphics2D g2d = (Graphics2D) bi.createGraphics();
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2d.addRenderingHints(new RenderingHints(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY));
        g2d.drawImage(img, 0, 0, w, h, null);
        g2d.dispose();
        return bi;
    }
} 
```

# ios - 删除我项目中的照片

> ID：13905540
> 
> 赞同：0
> 
> 时间：2012-12-16T21:15:32.010
> 
> 标签：ios, objective-c, photolibrary

我了解我无法以编程方式从我的应用程序中删除照片。因为苹果写我们只能添加照片

> 要将静止图像保存到用户的“已保存照片”相册，请使用 UIImageWriteToSavedPhotosAlbum 函数。要将电影保存到用户的“已保存照片”相册，请使用 UISaveVideoAtPathToSavedPhotosAlbum 函数。

但是我发现项目中有照片的项目，所以我可以通过单击删除图标从这个应用程序中删除照片（但它仍然会崩溃=））[项目](https://github.com/gdavis/FGallery-iPhone "项目")

现在我只看到两种方法：

1.  将照片保存在我的项目文件夹中，然后我可以随心所欲地使用它。我可以做吗？我觉得没有=(
2.  从我的应用程序中打开标准照片应用程序（打开方式...），但我阅读了一些关于它的线程，我明白这是不可能的。这是正确的？
3.  更新！我在下面写了这一点。我可以在我的应用程序中创建指向照片库中照片的链接吗？然后，如果我想从我的应用程序中删除照片，我会删除链接，所以我不会在我的应用程序中看到照片，但它仍然留在照片库中。有可能吗？

所以经过我所有的搜索，我还没有找到解决方案。他们有一些方法可以解决我的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T13:35:07.627

在 Youtube 上我找到了[下一个视频](http://www.youtube.com/watch?v=TP5NghkLY0M)，我知道我可以将照片保存到文档目录。这是视频中的下一个代码

```
UIImage *image = [info objectForKey:UIImagePickerControllerOriginalImage];
NSData *data = UIImagePNGRepresentation (image);
NSString *myGrabbedImage = @"myGrabbedImage.png";
NSArray *path = NSSearchPathForDirectoriesInDomainns (NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentDirectory = [path objectAtIndex:0];
NSString *fullPathToFile = [documentDirectory stringByAppendingPathComponent:myGrabbedImage];
[data writeToFile:fullPathToFile atomically:YES]; 
```

所以我知道将照片从照片库保存到我的阵列中很简单，然后从阵列中打开照片。而且我可以通过从我的阵列中删除照片来简单地删除照片。好的，但现在我有两个问题：

> 1.  如何区分将保存在阵列中的照片？如果我将在照片库中分配同一张照片，它会保存一些时间 - 这不好。
> 2.  所以它只适用于PNG图像？

PS对不起，如果这个问题非常新，但我的大脑在整天搜索后爆炸了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:25:59.297

可以拍摄相机照片并获取 a`UIImage`并将其写入您的应用程序拥有的文件夹中。您无法将其写入您的应用程序空间，因为您只有读取权限。您的问题选择的文件夹是 Documents 文件夹。看看[这里](http://www.wmdeveloper.com/2010/09/save-and-load-uiimage-in-documents.html?m=1)。

# visual-studio-2010 - C# 编译器允许接口代替泛型派生版本？

> ID：13905542
> 
> 赞同：2
> 
> 时间：2012-12-16T21:15:51.357
> 
> 标签：visual-studio-2010, c#-4.0, .net-2.0

我对编译器无法理解的一些行为感到有些困惑。我已将其简化为以下代码示例：

```
 public interface IFoo { }
    public interface IBar<T> : IFoo { }
    public delegate void DHandler<T>(IBar<T> arg);

    public static class Demo
    {
        static void Garply<T>(DHandler<T> handler) { }

        public static void DoStuffWithInt()
        {
            Garply<int>(Handler);
        }

        static void Handler(IFoo arg) { }
    } 
```

我的问题是我不希望代码编译，但确实如此。我不希望它编译，因为在签名中`DHandler<int>`需要，但是方法声明了，但事实*并非如此*（尽管反之亦然）。因此不是 a ，因此它的委托不能用作调用的参数。`IBar<int>``Handler``IFoo` *`IBar<int>``Handler``DHandler<int>``Garply<int>`*

 *如果我更改代码以读取`Handler(IBar<int> arg)`它会编译。如果我将其更改为阅读`Handler(IBar<string> arg)`，则不会。这两种行为都符合我的预期。

提示这个问题的实际问题是，当签名为 时`Handler(IBar<int> arg)`，编译器抱怨我需要显式指定`Garply`调用的类型参数。在这个例子中微不足道，但在实际代码中，这将是一个真正的麻烦。我很困惑，因为 to 的参数`Garply`是一个带有签名的方法`(IBar<int> arg)`，所以它的委托将是 a `DHandler<int>`，所以选择的`Garply<T>`将是明确的`Garply<int>`。但显然编译器看到了歧义。它正在调查，这导致我遇到上述难题，我只能猜测编译器可能在想“好吧，令杰森惊讶的是，我已经接受了 an `IFoo`，`IBar<T>`所以`T`必须指定 a 让我知道我应该把它编译为`IBar<T>`而不是`IFoo`“。这可以解释为什么它需要类型参数。但是任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-16T21:23:11.243

这是在 C# 2 中引入的*委托变体。**这*与在 C# 4 中引入的*通用变体不同。*

这是一个更简单的例子：

```
delegate void Foo(string x);    

class Test
{
    static void Main()
    {
        Foo foo = Bar;
    }

    static void Bar(object y) {}
} 
```

关键是我们可以从该方法创建一个`Foo`委托的实例，因为只要给定了*any*就可以工作。当一个委托被调用时，它总是提供一个引用，并且有一个从到的引用转换。所以如果我有：`Bar``Bar` *`object``Foo``string``string``object`*

 *```
Foo f = ...;
f("fred"); 
```

...那个电话*总是*适合`Bar`.

同样，在您的情况下，`Garply<T>`使用 with进行*的任何调用肯定*`handler`是对的有效调用- 因此编译器很乐意创建适当的实例。*`Handler``DHandler<T>`*

 *`Handler`仅接受 an时的问题`IBar<int>`是编译器在推断类型参数时不会对参数使用可能的方法组转换。这是一个类型推断肯定*会*更强大的领域，并且确实在 C# 3 和 C# 4 之间进行了改进——在一个非常相似的领域，尽管我永远记不起细节。***

# android - Android Lint 要求将字符串翻译成许多我不在应用程序中使用的语言

> ID：13905544
> 
> 赞同：16
> 
> 时间：2012-12-16T21:16:09.790
> 
> 标签：android, eclipse, adt, lint

> **可能重复：**
> [Lint：如何忽略“<key> 未翻译为 <language>”错误？](https://stackoverflow.com/questions/11443996/lint-how-to-ignore-key-is-not-translated-in-language-errors)

我遇到了奇怪的问题。

当我尝试导出签名的应用程序时，我看到了类似的错误

```
"app_name" is not translated in af, am, ar, be, bg, ca, cs, da, de, el, en-rGB, es, es-rUS, et, fa, fi, fr, hi, hr, hu, in, it, iw, ja, ko, lt, lv, ms, nb, nl, pl, pt, pt-rPT, ro, ru, sk, sl, sr, sv, sw, th, tl, tr,  uk, vi, zh-rCN, zh-rTW, zu 
```

也许是因为我使用 Maps API v2。

除了禁用 lint 检查之外，这个问题有什么解决方案吗？

# php - php + mysql，插槽切换

> ID：13905547
> 
> 赞同：0
> 
> 时间：2012-12-16T21:16:29.100
> 
> 标签：php, mysql

好吧，所以我正在制作一个基于网络的 rpg 宠物小精灵，它一直都很好，除了我需要将存储在插槽 (0) 中的口袋妖怪切换到你的盒子上的插槽 1 的部分。团队。我已经想通了，它会将存储在插槽 0 中的口袋妖怪切换到您团队的插槽 1，但它仅适用于插槽 0 列表中的第一个（插槽设置为 0 的多个）我希望我正在制作感觉我需要它，以便我可以单击您盒子中任何口袋妖怪下的提交，它会将那个发送到插槽 1 这是我到目前为止的代码：

```
 <?php
include 'core/database/connect.php';
include 'core/init.php';
protect_page();
include 'includes/overall/header.php';
?>

<div id="middle">
<div class="post">
<div class="postheader">
<h1>Your Box</h1>
</div>
<div class="postcontent">
<p>
<center>

<?php
if (isset($_POST['slot1'])) {

session_start();

// here we grab the pokemon in slot 1 
$sql66 = "SELECT * FROM user_pokemon WHERE
belongsto='".$_SESSION['username']."'
AND (slot='1')";
$result66 = mysql_query($sql66) or die(mysql_error());
$poke66 = mysql_fetch_array($result66);

$sql55 = "SELECT * FROM user_pokemon WHERE
belongsto='".$_SESSION['username']."'
AND (slot='0')";
$result55 = mysql_query($sql55) or die(mysql_error());
$poke55 = mysql_fetch_array($result55);

$_SESSION['idpoke5'] = $poke55['id'] ;

$_SESSION['idpoke6'] = $poke66['id'] ;

if(mysql_num_rows($result66)==0){
echo "no pokemon in slot 6 so we will drag the pokemon from slot 5 into slot 6 ";

} else {
$result666 = mysql_query("UPDATE user_pokemon SET slot=slot-1 WHERE id =  '{$_SESSION['idpoke6']}'")
or die(mysql_error());
header( 'Location: index.php' ) ;

}

if(mysql_num_rows($result55)==0){
echo "no pokemon in slot 5";

} else {

$result5done = mysql_query("UPDATE user_pokemon SET slot=slot+1 WHERE id =  '{$_SESSION['idpoke5']}'")
or die(mysql_error());
}

?>

<?php

 echo "Your pokemon has been moved";
 }
$result = mysql_query("SELECT * FROM user_pokemon WHERE belongsto='".  $_SESSION{'username'}."'AND (slot='0')");
while($row = mysql_fetch_array($result))
{   
$sql2 = "SELECT * FROM pokemon WHERE name='".$row['pokemon']."'";
$result2 = mysql_query($sql2) or die(mysql_error());
$battle_get2 = mysql_fetch_array($result2);

echo '<img src="pokemon/'.$row['type'] .''.$battle_get2['pic'].'" border=0><p></p>
</a>' ; 
echo $row['pokemon'];
?>
<p></p>
<?php
echo "Level:";
echo $row ['level'];
?>
<p><form name="slot1" action="" method="post">
<div align="center">
<input type="submit" value="slot1" name="slot1">
</div>
</form> </p>
<?php
echo "Gender:";
echo $row['gender'];
echo "<br />";
}
?>
</center>
</p>
</div>
<div class="postfooter"></div>
</div> 
```

我知道我不太擅长解释它，但非常感谢一些帮助:)

# google-docs - 如果另一个单元格包含某个“单词”，如何求和

> ID：13905565
> 
> 赞同：2
> 
> 时间：2012-12-16T21:18:58.170
> 
> 标签：google-docs, google-sheets

我有一个这种格式的销售表列

```
------------------------------------------------
|     A   |      B    |    C       |   D       |   
------------------------------------------------
|  type  |   Cost     | card fee   |    Total  |
------------------------------------------------
| cash   | 10.00      | 0.00       | 10.00     |
------------------------------------------------
| visa   | 10.00      | 0.50       | 10.50     |
------------------------------------------------ 
```

我目前手动将值放在 B 和 C 中，然后 (D) 将总计

我想要做的是让 cardfee (C) 列仅在 (A) 为 = 'visa' 的情况下计算总和 B*5% 但如果其他任何 (C) 可以为空白或 0.00

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T21:23:40.607

试试 IF 函数 =IF (condition, if_true, else_value)

```
=IF(A2 = "visa", B2*0.05, 0.00) 
```

# autohotkey - 一个桌面监视器，用于监视桌面（屏幕）的变化（达到阈值）并相应地发出警报

> ID：13905566
> 
> 赞同：1
> 
> 时间：2012-12-16T21:19:01.907
> 
> 标签：autohotkey

基本上我想要一个“叮！” 任何时候“一些变化”（如下载完成，一些对话框完成，shell命令返回等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T20:57:23.277

制作屏幕截图，然后定期拍摄新的屏幕截图，并使用 Imagesearch 功能将其与第一个屏幕截图进行比较

[http://www.ghisler.ch/wiki/index.php/AutoHotkey:_Make_a_Screenshot_of_the_current_Window_with_Irfanview](http://www.ghisler.ch/wiki/index.php/AutoHotkey:_Make_a_Screenshot_of_the_current_Window_with_Irfanview)

[http://www.autohotkey.com/docs/commands/ImageSearch.htm](http://www.autohotkey.com/docs/commands/ImageSearch.htm)

您还可以使用 WinGet 和 List 选项制作一个计时器来计算显示窗口的数量。

# ios - 计算 UITextField 基线位置

> ID：13905572
> 
> 赞同：11
> 
> 时间：2012-12-16T21:19:36.800
> 
> 标签：ios, uitextfield, baseline

我正在尝试以编程方式将 的实例的基线`UITextField`与`UIButton`. 我目前正在以与[此处](https://stackoverflow.com/questions/4542473/any-way-to-bottom-align-uilabels-with-dissimilar-fonts/4543653#4543653)描述的类似方式处理此计算，但`UITextField`内容可能存在偏移。任何想法我怎样才能获得文本位置`UITextField`甚至更好，有没有更简单的方法来对齐基线？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-24T21:48:37.073

根据我的经验`UITextField`，与`UIButton`. 无论如何，您可以找出两个控件中的确切文本框：

```
let textField = UITextField()
//... size the field, e.g. textField.sizeToFit()

let button = UIButton()
//... size the button, e.g. button.sizeToFit()

// Compute the target offset between tops (frame.origin.y).
let buttonBox = button.contentRectForBounds(button.bounds)
let buttonBaseline = buttonBox.origin.y + button.titleLabel!.font.ascender

let textFieldBox = textField.textRectForBounds(textField.bounds)
let textFieldBaseline = textFieldBox.origin.y + textField.font!.ascender

let offset = buttonBaseline - textFieldBaseline

//... position button, e.g., button.frame = CGRect(...)

textField.frame = CGRect(
    origin: CGPoint(x: button.frame.maxX, y: button.frame.origin.y + offset),
    size: textField.bounds.size) 
```

[![不同字体大小的对齐示例](../Images/fecc3d61ab4663251f5a585afb1f0798.png)](https://i.stack.imgur.com/bgN3O.png)

# javascript - 通过 HTML5 文件阅读器在本地读取大图像作为缩略图

> ID：13905578
> 
> 赞同：6
> 
> 时间：2012-12-16T21:20:26.453
> 
> 标签：javascript, html, thumbnails, filereader

我正在尝试将本地图像加载为缩略图，如此[处](http://www.html5rocks.com/en/tutorials/file/dndfiles/)所述。我的代码如下。

这适用于小图像。但是，当您尝试加载更大的图像（例如 4mb）时，会有很大的延迟。有没有办法优化这个？

谢谢

### html

```
<input type="file" id="files" name="files[]" multiple />
<output id="list"></output> 
```

### Javascript

```
<script>
function handleFileSelect(evt) {
var files = evt.target.files; // FileList object

// Loop through the FileList and render image files as thumbnails.
for (var i = 0, f; f = files[i]; i++) {

  // Only process image files.
  if (!f.type.match('image.*')) {
    continue;
  }

  var reader = new FileReader();

  // Closure to capture the file information.
  reader.onload = (function(theFile) {
    return function(e) {
      // Render thumbnail.
      var span = document.createElement('span');
      span.innerHTML = ['<img class="thumb" src="', e.target.result,
                        '" title="', escape(theFile.name), '"/>'].join('');
      document.getElementById('list').insertBefore(span, null);
    };
  })(f);

  // Read in the image file as a data URL.
  reader.readAsDataURL(f);
}
}

  document.getElementById('files').addEventListener('change', handleFileSelect, false);
</script> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-25T14:54:50.573

当您在主 UI 线程中运行涉及在巨大 blob 中操作非流式数据的东西时，总会有延迟。延迟不是来自读取数据，而是在浏览器 UI 中解码和显示图像，因为这涉及在 CPU 和 GPU 内存中推动大型像素阵列的同步 UI 操作。这是因为`<img>`在实际图像数据大小（宽 * 高）的块中分配和移动内存，这对于大图像来说是非常大的量，并且不必要的细节将其推送到 GPU 以仅在屏幕上显示（导致几毫秒）。

您很可能通过在阅读图像时将图像缩小到可显示的大小来优化您的用例

*   使用纯 Javascript JPEG 解码器，其中主事件循环以块的形式读取文件并将块发布到 WebWorker 后台线程进行解码。一个示例解码器库[https://github.com/notmasteryet/jpgjs/blob/master/jpg.js](https://github.com/notmasteryet/jpgjs/blob/master/jpg.js)

*   分配一个`<canvas>`元素，WebWorker 在其中逐步发布结果像素。此画布元素不需要匹配实际图像大小（见下文）

*   [此外，您还可以在使用纯 Javascript http://www.grantgalitz.org/image_resize/](http://www.grantgalitz.org/image_resize/)阅读它们时缩小 WebWorker 中的图像- 减少将像素推送到 GPU 的需要，因为您不会将大图像放在首先将监视器作为 1:1 像素映射

*   WebWorker 和主线程可以使用无副本传输对象来推送数据[https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers#Passing_data_by_transferring_.C2.A0ownership_%28transferable_objects%29](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers#Passing_data_by_transferring_.C2.A0ownership_%28transferable_objects%29)

然而，尽管这里描述的解决方案近乎完美，但要实现这一点需要具备高级 Javascript 技能，并且该解决方案不会与旧版兼容（阅读：Microsoft）。

# jquery - 隐藏/显示：无法获取链接以在展开后也成为关闭按钮

> ID：13905579
> 
> 赞同：0
> 
> 时间：2012-12-16T21:20:31.667
> 
> 标签：jquery, hide, show

我在页面顶部有一个链接，它扩展了一个文本和一个关闭按钮，但我也希望它本身的链接在这个 jQuery 代码中也可以作为一个关闭按钮。

这是 Jsfiddle [http://jsfiddle.net/lamberta/hqwep/](http://jsfiddle.net/lamberta/hqwep/)

我认为这是 jQuery 的方式？

```
$(".close a, .closeTop a").on("click", function() { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T22:08:18.267

[**工作演示**](http://jsfiddle.net/4zyT3/1/)

代码：

```
$(function() {
    var el = $('.test').hide();

    $('.closeTop a, .close a').click(function(e) {
        var currInd = el.eq($(this).closest('li').index());
        currInd.stop().slideToggle(400);
        el.not(currInd).stop().slideUp(400);
        return false;
    });
});​ 
```

# mysql - 注释/记录 .sql 文件的约定

> ID：13905580
> 
> 赞同：1
> 
> 时间：2012-12-16T21:20:34.337
> 
> 标签：mysql, comment-conventions

你们如何评论/记录您的 .sql 文件？是否有类似于 javadoc 之类的约定？在 facebook、twitter、google 等大型数据库密集型应用程序中通常会执行什么操作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:24:56.207

我的回答是，随着评论过时，我基本上已经停止发表评论，然后可能会产生误导，甚至比没有评论更糟糕。

我现在尝试使我的对象（表、列、存储过程等）名称尽可能有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:28:35.087

我见过的 Javadoc 之类的 SQL 没有注释约定。不过，这将是向 Doxygen 人提出的一个很好的问题。

另一方面，一些 RDBMS 允许这样做：

```
COMMENT ON TABLE table_name IS 'This is a comment';
COMMENT ON COLUMN table_name.column_name IS 'This is a great column'; 
```

这更符合整个 RDBMS 的理念——一切都与数据有关。不过，我不知道有任何系统会生成很好的文档。另外，我认为这还不是标准的。

我不认为 MySQL 会以这种方式进行评论，但 Oracle 和 PostgreSQL 会这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T21:28:26.967

我不知道任何标准或工具。但我在开头使用注释块，有时会解释复杂的子句

# php - php中的ftp相对路径

> ID：13905583
> 
> 赞同：0
> 
> 时间：2012-12-16T21:20:46.830
> 
> 标签：php, codeigniter, ftp, relative-path

我有一个问题，我不知道如何解决。让我解释一下...

目录结构：

```
-/public_html/lab/
-/public_html/lab/upload.php
-/public_html/lab/plugins/ 
```

我真的是php + ftp的新手，但我认为FTP不使用“绝对根路径”（/home/user/public_html/），而是根据相关用户使用“绝对用户路径”（/ public_html），对吧？

好吧，在`upload.php`我的代码中，FTP 类将文件临时存储在upload.php 所在的同一文件夹（/public_html/lab/）中，然后尝试将其移动到`/public_html/lab/plugins/`文件夹中。

FTP 类接收您要移动文件的路径。但是，我不想通过绝对路径，我想避免这种情况：

```
ftp->move('the-file.zip', '/public_html/lab/plugins/'); 
```

我想做这样的事情：

```
ftp->move('the-file.zip', '../plugins/'); 
```

但是上面的代码看起来是无效的。那么，我怎样才能重现这个结果呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T10:49:28.783

您可以使用 php 相对路径来将文件移动到您的 FTP 位置

```
$_SERVER['DOCUMENT_ROOT'] ."/lab/plugins/" ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:42:05.000

[考虑通过upload.php 中的move_uploaded_file](http://us2.php.net/manual/en/function.move-uploaded-file.php)移动文件，而不是为两个不同主机之间的通信而设计的FTP ：

```
move_uploaded_file($_FILES['uploaded']['tmp_name'],'./plugins/'.$_FILES['uploaded']['name']); 
```

通过 PHP 脚本上传文件后，临时文件将在 $_FILES[$inputFieldName]['tmp_name'] 下的[_FILES 超全局中可用。](http://php.net/manual/en/reserved.variables.files.php)如果您使用我给出的示例，请务必在之前清除“名称”属性，因为它会允许客户端注入并在应用程序中留下巨大的安全漏洞。

# c# - DropDownListFor 用于验证有问题的复杂模型

> ID：13905584
> 
> 赞同：2
> 
> 时间：2012-12-16T21:20:52.257
> 
> 标签：c#, asp.net-mvc-3, validation, razor, dropdownlistfor

我在输入表单中有其他字段和下拉列表。他们都验证得很好。即使没有正确验证前端的两个元素仍然可以正确地在帖子中绑定模型。我不完全确定他们为什么不验证。这是设置：

视图模型

```
public class DataVM
{
 //Widgets used, populated from database
 public List<Widget> Widgets { get; set; } 

 //Contains data to populate a dropdown with
 public GenericSelectList Containers { get; set; }

 //This will hold the relation between the widget and container
 //where widget is the local id, and container foreign id
 public List<NestedDictionary> WidgetContainers { get; set; }
}

public class NestedDictionary
{
    [RegularExpression("/^[1-9][0-9]*$/")]
    [Required]//This is not being enforced
    public int? ForeignId { get; set; }

    public int LocalId { get; set; }
} 
```

看法

```
@for (int i = 0; i < Model.Widgets.Count; i++)
{
 @Html.Hidden("WidgetContainers["+i+"].LocalId", Model.Widgets.ElementAt(i).WidgetId)
 <div>
  <div>
   <span>Container Used</span><hr />
  </div>
  <div class="editor-field">
   @Html.DropDownListFor(
    m => m.WidgetContainers.ElementAt(i).ForeignId,
    new SelectList(
     Model.Containers.Values,
     "Id",
     "DisplayFields",
     0
    ),
    " - Select A Container - "
   )
   <br />@Html.ValidationMessageFor(model => model.WidgetContainers.ElementAt(i).ForeignId)
  </div>
 </div>
} 
```

一切都显示得很好。它是交互式的，值是正确的。发布时，正确的数据将传递到正确的位置。但是，如果没有选择 Container，那么 post 就很好了，值为`0`pass。这里有点不知所措。任何想法为什么验证在客户端不起作用？

**编辑**

这是隐藏输入的渲染 html 和 select 元素

隐：

```
<input id="WidgetContainers_0__LocalId" type="hidden" value="39" name="WidgetContainers[0].LocalId"> 
```

选择：

```
<select name="ForeignId" id="ForeignId" class="valid"> 
```

显然，选择应该定义不同的属性。

**编辑#2**

如果我使用

```
m => m.WidgetContainers[i].ForeignId, 
```

然后我得到

```
<select id="WidgetContainers_0__ForeignId" name="WidgetContainers[0].ForeignId" class="valid"> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-16T22:01:52.597

因为它根本不为空。如果您希望客户端验证正常工作，您应该允许它`ForeignId`为空而不是`0` 当您首先创建 DropDown 时

```
new SelectList(
 Model.Containers.Values,
 "Id",
 "DisplayFields",
 0 // Don't set this default value
) 
```

# bash - 在 Jenkins 中为 Maven 生成的 JAR 文件添加后缀

> ID：13905587
> 
> 赞同：0
> 
> 时间：2012-12-16T21:21:30.280
> 
> 标签：bash, shell, maven, jenkins, rename

我想为 Maven 在 Jenkins 中创建的 JAR 文件添加一个后缀。Maven生成的文件名为CommandsEX-*.jar，星号是版本号所在的位置。很容易在 Shell/Bash 中简单地重命名它，方法是：

```
mv target/CommandsEX-*.jar target/CommandsEX-random-name.jar 
```

但是文件名可以更改，目前是 CommandsEX-2.0.jar。所以基本上有一种方法可以获取您在使用 mv 时更改名称的文件的当前文件名，或者可能完全是另一种方式。

我会用它来添加一个后缀，它是来自 Jenkins 的 $BUILD_ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:29:01.077

您可以在 Maven 中通过指定`classifier`.

[http://maven.apache.org/pom.html#Maven_Coordinates](http://maven.apache.org/pom.html#Maven_Coordinates)

# c++ - 将大型数据集硬编码为可执行文件？

> ID：13905588
> 
> 赞同：5
> 
> 时间：2012-12-16T21:21:43.863
> 
> 标签：c++

我想将大量数据（不同长度的整数数组、文本字符串库等）直接硬编码到可执行文件中，因此没有其他文件。

我的问题是，在 C++ 中执行此操作的最实用和最有组织的方法是什么？就头文件或源文件而言，我会将数据放在哪里？我应该使用什么结构？

我意识到这不是处理数据的公认方式。但请幽默！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-16T22:04:26.347

对于 C++ 和 C，您可以使用头文件来放置这些变量的声明，然后将实际的初始化代码放入 .c（或 .cc）文件中。C 和 C++ 都有不错的初始化语法。例如：

我的数据.h：

```
extern int x;
extern int a[10];
extern unsigned char *s; 
```

我的数据.c：

```
#include "mydata.h"
int x = 123;
int a[10] = {1,2,3,4,5,6,7,8,9,10};
unsigned char *s = "mystring"; 
```

那么 main.c 将有：

```
#include "mydata.h"
#include <stdio.h>

int main(const int argc, char *argv[])
{
  printf("%d, %d, %s\n", x,a[5],s);
} 
```

测试运行如下所示：

```
$gcc -o main main.c mydata.c
$ ./main 
123, 6, mystring 
```

现在，要真正组织起来，可以编写 Perl/Python/PHP 脚本来从您的数据源生成这样的格式文件，例如 CSV 文件的 SQL 数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T22:17:02.490

试试这个：

[http://sourceforge.net/projects/bin2obj/](http://sourceforge.net/projects/bin2obj/)

将您的数据转换为 OBJ 并链接到您的项目。

# r - 需要帮助根据 R 中的标准过滤矩阵

> ID：13905593
> 
> 赞同：0
> 
> 时间：2012-12-16T21:22:11.563
> 
> 标签：r, matrix

我是 R 新手，所以我请求你的帮助。假设我有以下矩阵。

```
mat <- matrix(c(2,4,2,8, 1,4,11,9), 4)
dimnames(mat)[[2]] <- c("x", "y")
dimnames(mat)[[1]] <- c("a", "b", "c", "d")
mat
  x y
a 2 1
b 4 4
c 2 11
d 8 9 
```

我想基本上过滤矩阵，以便新矩阵只包含平均值为 5 或更高的行。因此在“mat”中，“a”和“b”行将不符合此条件并被删除，新矩阵如下所示。任何帮助，将不胜感激！

```
mat
  x y
c 2 11
d 8 9 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-17T00:43:10.573

```
mat[ rowMeans(mat) < 5 , ]   # rowMeans is much faster than the apply method 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T21:24:44.617

对于原始问题，您要选择最小值 >= 5 的行。 `apply`with`min`将找到每行的最小值，以用于选择。请注意，使用的矩阵不再与问题匹配。

```
> mat1[apply(mat1, 1, min) >= 5,,drop=FALSE]
  x y
c 7 8 
```

对于已编辑的问题，使用平均值：

```
> mat[apply(mat, 1, mean) >= 5,,drop=FALSE]
  x  y
c 2 11
d 8  9 
```

# in-app-billing - 订阅的应用内计费

> ID：13905598
> 
> 赞同：2
> 
> 时间：2012-12-16T21:22:53.590
> 
> 标签：in-app-billing, subscriptions

我打算在 Google play 上销售一个带有订阅模式的 android 应用程序，如下所示

*   1.99/月（包括 30 天免费试用。第一个计费日期设置为今天+30）-19.99/年（包括 60 天免费试用。第一个计费日期设置为今天+60）

我已经实现了这个定价的逻辑，并且应用程序运行良好。

现在，我想为那些报告使用该应用程序问题的客户提供额外的 30 天免费服务。为了做到这一点，我想只更新下一个计费日期。google play 是否允许使用 google play 服务器端 api 进行此类更新？如果是，我可能只是为和管理员开发一个控制台应用程序，为报告问题的特定客户添加 30 天到下一个计费日期。

有人可以帮助我，如果这种方法有效，并为我提供服务器端 API 的链接和显示如何使用的示例？或者，有人可以建议一种替代方法来满足这一要求

斯里尼瓦斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T09:43:48.107

似乎并非如此。根据[Google Play Android Developer API v1](https://developers.google.com/android-publisher/v1/)，您只有 2 种方法可用于与 Playstore 服务器通信：

**cancel** - 取消用户的订阅购买。订阅在到期前一直有效。 **get** - 检查用户的订阅购买是否有效并返回其到期时间。

总的来说，谷歌不允许你篡改用户的订阅。如果不使用您自己的服务器，我并没有真正看到解决问题的方法，您可以自己管理订阅，只需向 Google 服务器询问真正的到期日期。

# android - src 包消失

> ID：13905603
> 
> 赞同：0
> 
> 时间：2012-12-16T21:23:16.323
> 
> 标签：android, eclipse

我从Windows邮件窗口的eclipse src文件夹中拖动我的包以通过邮件发送，但是拖动后的包变成白色，里面的所有java都消失了！！怎么了！我在任何地方都找不到它们。我尝试重新启动 Eclipse。

# django - 将数据发送到 Django 模板

> ID：13905604
> 
> 赞同：1
> 
> 时间：2012-12-16T21:23:16.873
> 
> 标签：django, django-templates, django-views

我的网站的一部分，其 URL 模式以固定字符串**管理**开头，例如：'example.com/manage/post'、'example.com/manage/user' 要求与用户关联的某些信息显示在属于的每个页面上到网站的这一部分。

我是否必须在每个视图方法中返回此信息才能这样做？

此信息不在用户配置文件中维护。它在用户配置文件之外的模型中维护。此模型与用户配置文件之间存在多对一关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:25:48.163

您是在谈论查看页面的用户吗？如果是这样，只需将以下内容添加到`TEMPLATE_CONTEXT_PROCESSORS`您的`settings.py`.

```
'django.contrib.auth.context_processors.auth' 
```

这将使您可以访问当前用户作为`user`在所有模板中调用的变量。

# android - Android水平滑动顶部菜单

> ID：13905606
> 
> 赞同：0
> 
> 时间：2012-12-16T21:23:25.737
> 
> 标签：android, android-viewpager

我正在尝试创建一个类似于 Google Play 商店中的水平滑动面板。

但是，我只希望顶部菜单面板本身是可滑动的，下面的内容（这是一个 ListView）不应被滑动，列表的数据根据​​用户滑动到的菜单图标重新加载。

有谁知道我怎么能做到这一点？我一直在阅读 ViewPager（我认为这是 Google Play 商店正在使用的），但它似乎是在滑动整个页面，而不仅仅是面板本身。

非常感谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:13:28.880

[在这里](http://blog.peterkuterna.net/2011/09/viewpager-meets-swipey-tabs.html)找到了一篇讨论这个“SwipeyTabs”的博文

示例的完整代码可以在[http://code.google.com/p/android-playground/下载](http://code.google.com/p/android-playground/)

# android - Android Fragments - 我怎样才能保留数据？

> ID：13905607
> 
> 赞同：1
> 
> 时间：2012-12-16T21:23:29.967
> 
> 标签：android, android-fragments

我正在使用带有多个片段的 ViewPager。（标签导航+滑动）。在我的第一个 ListFragment 中，我使用自定义适配器显示数据列表。

问题是，当切换到 Tab #3 然后返回时，我的 ArrayList 的大小为 0。

如何将 Fragment 的所有数据保存在内存中？我不想再从数据库中读取它，我想要的是当返回这个片段时，一切都应该保持不变......

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T12:45:29.523

在[片段指南](http://developer.android.com/guide/topics/fundamentals/fragments.html)FragmentList 示例中，您可以找到：

```
 @Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        outState.putInt("curChoice", mCurCheckPosition);
    } 
```

您以后可以像这样使用它：

```
 @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        if (savedInstanceState != null) {
            // Restore last state for checked position.
            mCurCheckPosition = savedInstanceState.getInt("curChoice", 0);
        }
} 
```

我是 Fragments 的初学者，但它似乎解决了您的问题；）在片段从回栈返回后调用**onActivityCreated 。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:26:51.097

你可以：

1.  在容器活动中托管数据并从片段访问数据
2.  使用应用程序类中托管的单例对象/某些类

但请记住，每当您的进程被杀死时，无论如何您都会丢失数据。如果您希望数据在多个进程生成中持久存在，则需要将其存储到 sqllite / 某种持久性中。

# html - 如何使css下拉菜单成为下拉菜单

> ID：13905612
> 
> 赞同：2
> 
> 时间：2012-12-16T21:23:54.957
> 
> 标签：html, css, drop-down-menu, stylesheet

我仍在处理我的页脚。所以我想要一个应该下拉到顶部的语言选择器。所以我试图找到一种方法来列出它们，但我不知道该怎么做！一切都会列出缺点。

HTML结构是这样的：

```
<div id="legals">
    <div id="list2">
    <span class="down">text large</span>
         <ul class="nav2">
        <li><a href="/one">one</a></li>
        <li>|</li>
        <li><a href="/two">two</a></li>
        <li>|</li>
        <li><a href="/three">three</a></li>
        <li>|</li>
        <li>select:</li>
          </ul>
              <ul class="flag"> -->here it starts
                <li id="1"> -->just an image of a flag. when hover this, the divs below should be visible
                    <ul class="drop_down">
                           <div> -->as an container for the flags and label
                               <li id="en"></li>-->shows just an image<a href="#">one</a> -->will be the link 
                           </div>
                           <div>
                       <li id="fr"></li><a href="#">two</a>
                           </div>
                           <div>
                       <li id="pl"></li><a href="#">three</a>
                           </div> 
                        </ul>
                </li>
               </ul>
      </div>
</div> 
```

对于 CSS：

```
.footer #legals #list2 .flag {
    width: 20px;
    height: 10px;
    margin-top: 14px;
    margin-left: 8px;
    float: left;
    display: inline-block;
    border: 1px solid #ccc;
}
.footer #legals #list2 .flag:hover {
    border: 1px solid #fff;
}
.footer #legals #list2 .flag li{
    width: 20px;
    height: 10px;
    display: inline-block;
    float:left;
    background-image:url(../images/flags.png);
}
.footer #legals #list2 .flag #en{   
    background-position: -40px;
}

/*HOVERSETTINGS*/
.footer #legals #list2 .flag li .drop_down{
    display:none;
}

.footer #legals #list2 .flag li .drop_down div{ 
    width: 100px;
    height: 16px;
    border-top: 1px solid #9fce23;
    border-bottom: 1px solid #9fce23;
    background-color: #f23;
        display:block;
}
.footer #legals #list2 .flag li .drop_down div li{
    width: 20px;
    height: 10px;
    background-image:url(../images/flags.png);
    background-repeat: no-repeat;
    border: 1px solid #ccc;
    margin-top: 1px;
}
.footer #legals #list2 .flag li .drop_down div:hover{
    color: #fff;    
}
.footer #legals #list2 .flag li .drop_down div a{
    font-family: Arial, Helvetica, sans-serif;
    font-size: 12px;
    color: #ccc;
    font-weight:bolder;
    text-align: left;
    margin-left: 10px;  
} 
```

因此，如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:42:11.617

你可以试试这样的[http://jsfiddle.net/ZG2BL/](http://jsfiddle.net/ZG2BL/)

这个想法是，将下拉菜单设置为，`li`并将**下拉**菜单设置为并给它一个正的底部值，这样它就会显示在父级上方`ul``position:relative;``ul``position:absolute;``li`

我必须说你有很多不必要的代码。例如，不需要包含`li`元素`div`等。你也不能有数字ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:32:35.970

制作下拉菜单真的*很难*，因为 HTML/CSS 是从上到下工作的，要制作下拉菜单，您必须确切知道菜单有多大。

幸运的是，有一些技巧可以解决这个问题。我刚想出了一个有点复杂但应该可以正常工作的方法：

1.  制作下拉菜单
2.  使用 CSS 将整个菜单旋转 180 度。
3.  确保枢轴点设置正确，以便使用菜单栏 (?) 的中间作为旋转点进行旋转。
4.  将所有菜单项旋转 180 度以确保文本没有倒置。

就像我说的，它有点复杂，但它应该可以工作。将项目旋转​​ 180 度将强制 CSS 从下到上工作，因此您不必对任何高度进行硬编码。

当然，还有更简单的 JavaScript 替代方案，但如果你理解我刚刚写的内容，这个 CSS hack 应该很容易实现。

# iphone - self.navigationItem.rightBarButtonItem 与 self.navigationController.navigationItem.rightBarButtonItem

> ID：13905618
> 
> 赞同：3
> 
> 时间：2012-12-16T21:24:24.953
> 
> 标签：iphone, ios, ipad, uinavigationcontroller, uinavigationitem

我对使用`self.navigationItem.rightBarButtonItem`and有点困惑`self.navigationController.navigationItem.rightBarButtonItem`。

哪一个是正确的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-16T21:35:04.930

第一个，即`self.navigationItem.rightBarButtonItem`。

每个视图控制器都有一个关联的导航项。这是导航栏中显示的内容。因此，您要操作的是当前视图控制器的导航项。如果您操作了导航控制器的导航项，那么这将显示导航控制器（也是视图控制器）本身是否显示在另一个导航控制器中。

# jsp - JSP 上具有相对路径的 SSL（基本）

> ID：13905619
> 
> 赞同：0
> 
> 时间：2012-12-16T21:24:29.263
> 
> 标签：jsp, ssl, relative-path, servlet-filters, relative-url

如何让 SSL 与 JSP 页面上的相对路径一起工作。无论我是在表单中调用 servlet 还是只是链接到单独的页面，有没有办法保证路径“/foo.do”或“/foo.jsp”会自动转到[https:/ /www.mydomain.com/foo.do](https://www.mydomain.com/foo.do)？

我看到的选项只是对路径进行硬编码（不可取）或使用过滤器在传输过程中重写 url。但是，我在网上搜索并没有真正找到该功能的现有 servlet，让我相信这不是最好的方法。

# java - sqlite查询未在android中执行

> ID：13905625
> 
> 赞同：0
> 
> 时间：2012-12-16T21:25:06.313
> 
> 标签：java, android, sqlite

我有以下方法要查询数据库

```
public String getCurrentMonthTotal() {
        String totalSum = "0.00";       
        Calendar cal = Calendar.getInstance();      
        int currentMonth = cal.get(Calendar.MONTH);
        Cursor cursor = database.query("expenses",
                new String[] { "SUM(\"amount\")" }, "expensemonth="
                        + currentMonth, null, null, null, null);
        if (cursor.moveToFirst()) {
            while (!cursor.isAfterLast()) {
                totalSum = cursor.getString(cursor.getColumnIndex("amount"));
                // do what ever you want here
                cursor.moveToNext();
            }
        }
        cursor.close();
        return totalSum;
    } 
```

但是应用程序在达到这一点时会崩溃。任何想法为什么？

Logcat 跟踪

```
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.app.ActivityThread.access$600(ActivityThread.java:130)
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.os.Looper.loop(Looper.java:137)
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.app.ActivityThread.main(ActivityThread.java:4745)
12-17 02:46:37.893: E/AndroidRuntime(837):  at java.lang.reflect.Method.invokeNative(Native Method)
12-17 02:46:37.893: E/AndroidRuntime(837):  at java.lang.reflect.Method.invoke(Method.java:511)
12-17 02:46:37.893: E/AndroidRuntime(837):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-17 02:46:37.893: E/AndroidRuntime(837):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-17 02:46:37.893: E/AndroidRuntime(837):  at dalvik.system.NativeStart.main(Native Method)
12-17 02:46:37.893: E/AndroidRuntime(837): Caused by: java.lang.NullPointerException
12-17 02:46:37.893: E/AndroidRuntime(837):  at com.technowizsol.easyexpensemanager.ExpenseList.onCreate(ExpenseList.java:21)
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.app.Activity.performCreate(Activity.java:5008)
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
12-17 02:46:37.893: E/AndroidRuntime(837):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
12-17 02:46:37.893: E/AndroidRuntime(837):  ... 11 more
12-17 02:49:03.202: E/Trace(885): error opening trace file: No such file or directory (2)
12-17 02:49:04.003: D/gralloc_goldfish(885): Emulator without GPU emulation detected. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:26:41.620

如果没有 LogCat 错误，我们只需要猜测......但这感觉不对：

```
totalSum = cursor.getString(cursor.getColumnIndex("amount")); 
```

我不认为 Sum 列被命名为“amount”，并且您不需要一行循环。尝试：

```
if (cursor.moveToFirst()) {
    totalSum = cursor.getString(0); // You can use getInt()
} 
```

# iphone - Cocos2d CCActionManager 恢复所有动作

> ID：13905630
> 
> 赞同：0
> 
> 时间：2012-12-16T21:26:10.233
> 
> 标签：iphone, xcode, cocos2d-iphone

这一直把我逼到墙上！我确信会有一个 UBER 简单的答案，但我就是想不通！

使用 CCActionManager，我已成功暂停当前在屏幕上运行的所有操作。我的问题是，如何让它们再次运行？

PS，我尝试过 pauseTarget:self，但由于某种原因它不会停止当前正在运行的所有操作？

这是我的代码：

```
 if (backOrNot == NO) {
Pencil = [CCSprite spriteWithFile:@"Pencil.png"];
Pencil.position = ccp(MainChar.position.x, MainChar.position.y + 10);
id action = [CCMoveTo actionWithDuration:3 position:ccp(Pencil.position.x, 550)];
    [action setTag:4];
[Pencil runAction:action];
[self addChild:Pencil z:2 tag:4];
NSLog(@"Pencil Shot!");
    [[CCActionManager sharedManager] resumeTarget:self];
}
else{
    [[CCActionManager sharedManager] pauseAllRunningActions];
} 
```

当我进入 Pause 或 backOrNot 返回 YES 时，我试图停止所有 Pencils（其中有很多）。

**编辑：**

这个问题很容易解决；我的意思是暂停工作。对于所有想知道的人，您可以这样做：

```
[[CCDirector sharedDirector]pause]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:38:48.980

你是对的，有一个简单的答案！:)

暂停所有操作会返回一个带有暂停操作的 NSMutableSet：

```
CCActionManager* am = [CCActionManager sharedManager];
NSSet* pausedActions = [am pauseAllRunningActions]; 
```

稍后您可以从集合中取消暂停那些暂停的操作：

```
[am resumeTargets:pausedActions];
pausedActions = nil; 
```

确保在恢复后对（非 ARC：retain）pausedActions 和 nil（非 ARC：release 和 nil）pausedActions 使用强引用。集合的内容仅在操作恢复之前有效，如果您保留集合，则操作完成后不会解除分配。

pauseTarget:self 将起作用，如果您运行 [self pauseSchedulerAndActions] ，这就是 CCNode 类正在使用的东西，这绝对有效。

# data-structures - 各种数据结构的最坏情况

> ID：13905631
> 
> 赞同：0
> 
> 时间：2012-12-16T21:26:17.633
> 
> 标签：data-structures

我正在编译一个列表，以提高对不同数据结构的操作效率。到目前为止，我有这个：

![效率](../Images/05b2e88c8d056e5acefa41d053d5027e.png)

我不太确定我在这里为作为链表的队列和作为链表的堆栈提供了什么。任何人都可以对这个问题有任何见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:44:38.037

唯一的错误是`Pop`for`Queue as Linked List with pointer to front`应该是`O(1)`.

为了完整起见，列出操作的复杂性可能是值得的，例如搜索任何元素、删除任何元素、按索引获取、按索引删除等。

**队列为链表（指向前面的指针）：**

*Push：*你需要在末尾插入一个元素，但是你只有一个指向开头的指针，所以你需要遍历所有元素才能到达末尾。

```
current = head
while (current.next != null)
  current = current.next
current.next = newItem 
```

*Pop：*您需要删除开头的元素，因此您只需将指向开头的指针重新分配给第二个元素即可。

```
removedItem = head
head = head.next 
```

**队列为链表（指向前后的指针）：**

*Push：*你需要在末尾插入一个元素，并且你有一个指向末尾的指针，所以你可以在恒定时间内添加它。

```
tail.next = newItem
tail = newItem 
```

*Pop：*与单链表的 pop 相同。

```
removedItem = head
head = head.next 
```

**堆栈为链表：**

*Push：*在开头插入一个项目，很容易在恒定时间内完成。

```
newItem.next = head
head = newItem 
```

*弹出：*删除第一项，容易在恒定时间内完成。

```
removedItem = head
head = head.next 
```

**堆栈为数组：**

*Push：*在最后一个索引处插入item，很容易在恒定时间内完成。

```
last = last+1
array[last] = newItem 
```

*弹出：*删除最后一个索引的项目，容易在恒定时间内完成。

```
removedItem = array[last]
last = last-1 
```

# if-statement - 新版本的if，它在做什么？

> ID：13905633
> 
> 赞同：0
> 
> 时间：2012-12-16T21:26:18.983
> 
> 标签：if-statement, scheme, conditional

我被要求解释具有特定输入的函数的输出，但我不明白该函数是如何工作的。它应该是 if 的新版本，但在我看来，它似乎什么也没做。

```
(define (if-2 a b c)
    (cond (a b)
    (else c))) 
```

对我来说，这看起来总是会打印 b 但我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T02:57:24.937

看来您对表格不熟悉`cond`。它是这样工作的：

```
(cond
  ((<predicate1> <args>) <actions>)
    ;^^-- this form evaluates to true or false. 
    ;  If true, we do <actions>, if not we move on to the next predicate.
  ((<predicate2> <args>) <actions>) ; We can have however many predicates we wish
  (else ;<-- else is always true.  This is our catch-all.
    <actions>)) 
```

以下是您的代码，其中一些变量已重命名。

```
(define (if-2 predicate arg1 arg2)
    (cond
      (predicate arg1)
      (else arg2))) 
```

要弄清楚为什么它总是返回`arg1`您的测试，请回想一下，Scheme 将所有内容都视为真，除了显式的假符号（通常`#f`）和空列表`'()`。

因此，当您调用`(if-2 > 2 3)`cond 形式时，评估结果如下：

```
(cond
  (> 2)
  ;^---- `>` is not the empty list, so it evals to #t 
  (else 3)) 
```

然后因为`cond`返回它发现与真值相关联的第一件事，所以你得到 2 回来。

要按`if-2`预期工作，您需要以不同的方式调用它，例如`(if-2 (> 3 2) 'yep! 'nope!)`将返回，`'yep!`因为 3 大于 2。

# java - SWT ScrollableComposite 填充文字，想水平换行垂直滚动

> ID：13905636
> 
> 赞同：1
> 
> 时间：2012-12-16T21:26:42.757
> 
> 标签：java, layout, swt

我`ScrolledComposite`有一套占据我外壳的整个区域，并且我在`RowLayout`里面有多个水平标签。我想这样做，以便在调整窗口大小时，文本总是会一直到达，但现在它只是保持原来的宽度。最重要的是，文本似乎在换行之前位于滚动条的后面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T08:46:37.843

我认为你需要的是一个[`GridLayout`](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fswt%2Flayout%2FGridLayout.html). 使用网格布局，您可以使控件与父级一起重新调整大小。您可以将标签划分为相等的空间或不同的空间。

在每个标签上设置`widthHint`并使它们水平填充。每当调整大小时，它们都会填满父级。

# python - 集合中的 union() 和 update() 与其他之间的区别？

> ID：13905640
> 
> 赞同：27
> 
> 时间：2012-12-16T21:27:47.813
> 
> 标签：python, set, set-operations

Python 集有以下方法：

```
s.union(t)  s | t   new set with elements from both s and t

s.update(t) s |= t  return set s with elements added from t 
```

同样，还有这些：

```
s.intersection_update(t)    s &= t  return set s keeping only elements also found in t

s.intersection(t)   s & t   new set with elements common to s and t 
```

依此类推，适用于所有标准的关系代数运算。

这里到底有什么区别？我看到它说 update() 版本返回 s 而不是新的集合，但是如果我写`x = s.update(t)`，这是否意味着`id(x) == id(s)`？它们现在是否引用同一个对象？

为什么要实现这两组方法？它似乎没有添加任何重要的功能。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-12-16T21:29:37.107

它们*非常*不同。一组更改*就地*的集合，而另一组则单独保留原始集合，并返回一个*副本*。

```
>>> s = {1, 2, 3}
>>> news = s | {4}
>>> s
set([1, 2, 3])
>>> news
set([1, 2, 3, 4]) 
```

请注意如何`s`保持不变。

```
>>> s.update({4})
>>> s
set([1, 2, 3, 4]) 
```

现在我改变了`s`自己。另请注意，`.update()`似乎没有返回任何东西；它没有返回`s`给调用者，Python 解释器没有回显一个值。

就地更改对象的方法永远不会在 Python 中返回原始对象。它们的返回值总是`None`相反（从不回显）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T21:30:52.213

这些`_update`方法就地修改集合并返回无。没有`update`返回新对象的方法。您几乎可以肯定不想这样做`x = s.update(t)`，因为它将设置`x`为无。

```
>>> x = set([1, 2])
>>> x.intersection(set([2, 3]))
set([2])
>>> x
set([1, 2])
>>> x.intersection_update(set([2, 3]))
>>> x
set([2])
>>> x = x.intersection_update(set([2, 3]))
>>> print x
None 
```

这些方法添加的功能`_update`是修改现有集合的能力。如果您在多个对象之间共享一个集合，您可能需要修改现有集合，以便共享它的其他对象可以看到更改。如果您只是创建一个新集合，其他对象将不会知道它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T21:33:02.840

看起来文档没有以最清晰的方式说明它，但`set.update`根本没有**返回**任何东西（相当于返回`None`），也没有`set.intersection_update`。像`list.append`or `list.extend`or `dict.update`，他们修改容器就地。

```
In [1]: set('abba')
Out[1]: set(['a', 'b'])

In [2]: set('abba').update(set('c'))

In [3]: 
```

编辑：实际上，[文档](http://docs.python.org/2/library/stdtypes.html#set-types-set-frozenset)并没有说明您在问题中显示的内容。他们说：

> 更新集合，添加所有其他元素。

和

> 更新集合，只保留其中找到的元素和所有其他元素。

# android - 传递 Extras 和屏幕旋转

> ID：13905641
> 
> 赞同：0
> 
> 时间：2012-12-16T21:27:48.733
> 
> 标签：android, android-activity, rotation, extras

这类问题会定期出现。抱歉，如果之前已经介绍过，但我是新手，找不到合适的答案。它处理类和活动之间通信的正确实现。

我做了一个画廊应用程序。它有 3 个主要活动：`Main`一个，使用模式搜索文件名；一个`Thumb`，将与模式匹配的所有图像显示为网格视图中的缩略图，以及一个`Photo`活动，当您单击`Thumbs`. 我通过文件名（一个数组）和网格视图中单击的拇指的（一个）传递给`Photo`活动。`Intent``position``int`

这第三个`Photo`活动只有一个视图： a `TouchImageView`，我根据您在图像上的短按位置（左、右或中间）调整了上一个/下一个切换和缩放。此外，我添加了一个 longclick 监听器`Photo`来显示 EXIF 信息。

事情正在工作，但我对实施不满意......有些事情不对。

我遇到的问题之一是，如果我单击图像右侧以查看`Photo`活动中的下一个，它会正常切换 ( `position++`)，但是在旋转设备时会`position`出现原始设备。

正在发生的事情是`Photo`在旋转图像时被破坏，并且由于某种原因它再次重新启动，而不服从`super.onCreate(savedInstanceState)`，再次加载 Extras（`position`唯一更改`Photo`，而不是父活动）。

我尝试使用`startActivityForResult`而不是`startActivity`，但失败了......

当然，我可以做一些人为的事情来保存`position`数据，但是应该有一些我不了解活动如何工作的“概念性”，我想正确地做到这一点。

有人可以解释一下我做错了什么，这是实现我想要的最佳方法，为什么？

非常感谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T21:46:31.610

试试这个代码来存储活动的值

```
Long value;

protected void onSaveInstanceState(Bundle onOrientChange) {
    super.onSaveInstanceState(onOrientChange);
    onOrientChange.putLong("myValue", value);  
} 
```

并恢复 onCreate() 中的值：

```
public void onCreate(Bundle onOrientChange) {
  if (onOrientChange!= null){
   value = onOrientChange.getLong("myValue");
  }
} 
```

通常你恢复你的状态在`onCreate()`. 也可以恢复它`onRestoreInstanceState()`，但不是很常见。(`onRestoreInstanceState()`在之后调用`onStart()`，而`onCreate()`在之前调用`onStart()`。

使用 put 方法将值存储在`onSaveInstanceState()`

# sql-server - 触发总是回滚事务

> ID：13905644
> 
> 赞同：0
> 
> 时间：2012-12-16T21:28:23.477
> 
> 标签：sql-server, tsql

我有这样的触发器 - 当具有这样名称的设备（总是一个元素）已经在表中时，它应该回滚。但触发器总是用 message 回滚事务`such equipment already exist`。什么时候设备在桌子上，什么时候不在。问题是什么？

```
CREATE trigger [dbo].[ut_TEquipment]
on [dbo].[TEquipment]
for insert
as
begin

declare @var nvarchar(30)
select @var = name from inserted
print @var

if (@var in (select name from TEquipment))
begin
    raiserror('Such equipment already exist',10,1)
    rollback transaction
end

declare @amount int
declare @free int

 select @amount = x.amount from inserted as x 

 select @free = y.free from TEquipWarehouse as y,inserted as x
 where y.ideqwhs = x.ideqwhs

if (@free - @amount) <= 0
begin
raiserror('Free space in this warehouse is not enough!',10,1)
rollback transaction
end
else 
begin
update TEquipWarehouse
set free = capacity - amount
from inserted as x
    where idwhstype = x.ideqwhs 
end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:38:48.847

定义为`FOR`在导致它的 SQL 之后发生的触发器。因此，从您的事务的角度来看，该行已经在表中。如果要通过触发器执行此操作，则需要使用`INSTEAD OF`. `UNIQUE`但是，在 name 列上定义约束会容易得多。

`inserted`您还应该考虑插入触发器在表中可以有多行。例如：

```
Insert Into TEquipment (Name) Values (N'Test'), (N'Test'); 
```

将显示两行

这是[一个](http://sqlfiddle.com/#!6/f707e/1)显示不同触发行为的示例

要使用`FOR`触发器执行此操作，您需要执行以下操作：

[http://sqlfiddle.com/#!6/7d51d/1](http://sqlfiddle.com/#!6/7d51d/1)

不过，我不确定它是否会处理多个并发事务。

# c - 在需要随机访问时改进随机内存访问

> ID：13905645
> 
> 赞同：2
> 
> 时间：2012-12-16T21:28:24.227
> 
> 标签：c, caching, cuda, gpgpu, dynamic-programming

## 我在做什么的基本概念

完整的联盟结构形成问题/组合拍卖。

给定一组 N 个代理，这组代理的不相交子集产生最佳结果。

例如`Agents = {a,b}`及其值

*   `{a} = 2`
*   `{b} = 3`
*   `{a,b} = 4`

在这种情况下， 的联合会`{{a},{b}} = 5`给出最好的结果，它是 的成对不相交子集`{a,b}`。

所以简而言之，问题是关于拆分一个集合并检查是否有任何拆分总和大于原始集合。（这部分在生成拆分和我如何表示我的数据方面做得很好。）

我如何表示数据基本上是一个值数组，其中索引是集合配置（集合表示为整数）。

对于上面的例子：

`int val[4] = {0,2,3,4}`在哪里设置

*   `{a} = 01 = index 1`
*   `{b} = 10 = index 2`
*   `{a,b} = 11 = index 3`

因此该集合充当值数组中的索引。

问题是这提供了随机内存访问，给定大量`2^n`需要考虑值的代理。

## 跳过内存访问问题

例如，在 20 个代理的环境中，给定两个元素的集合，元素 `10000000000000000001`的值`10000000000000000000`是 1048575 个索引，`00000000000000000001`距内存 4194300 字节，表示 32767 个 128 字节距离的缓存线。因此，可怕的访问模式。

我尝试寻找的解决方案涉及根据基数/汉明权重对索引进行排序：

[基于汉明权重的索引](https://stackoverflow.com/questions/13542794/hamming-weight-based-indexing)

[确定两个整数之间的字典距离](https://stackoverflow.com/questions/13554747/determin-the-lexicographic-distance-between-two-integers)

遭受算术开销，我的计算将掩盖随机访问的惩罚。特别是[基于 Hamming 权重的索引](https://stackoverflow.com/questions/13542794/hamming-weight-based-indexing)，因为它使用许多相关计算，这些计算会被序列化并阻塞线程。

作为最后的手段，我再次在这里问，当您的解决方案依赖于随机访问或者它是一种无助的状态时，是否有任何方法（我知道合并，这对于这个问题很难做到）来改善访问时间？

目前，我的指令重播开销约为 45%，因此更改块大小不会产生显着的结果。是的，我尝试通过计算每个线程的多个联盟来隐藏延迟，这在一定程度上起作用。

# matlab - 获取给定纬度和经度的大陆

> ID：13905646
> 
> 赞同：1
> 
> 时间：2012-12-16T21:28:25.303
> 
> 标签：matlab, coordinates, gis

我想要某些代码，以便给定纬度和经度作为输入，我想得到它所属的大陆？我知道我可以手动读取坐标，然后从地图上看到。但是有没有更简单的方法呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-08-01T08:19:07.680

我已经完成了这段代码只是为了获得大陆。这不是 100% 准确的，但对于大多数地区来说都相当不错。

我这样做是为了按照 PVsyst 的要求来识别大陆，所以我区分了澳大利亚和太平洋，但这很容易改变：

如果您不想区分澳大利亚和太平洋，只需删除澳大利亚部分（LatAus、LonAus，将其从 contientIndex 和大陆列表中删除）。

[![在此处输入图像描述](../Images/fe430f6982b70ccb6bdc64cdc44a1d0f.png)](https://i.stack.imgur.com/m2fO5.png)

```
function Continent = GetContinent(Lat,Lon,plotTrueFalse)

LatNAm = [90       90  78.13   57.5  15  15  1.25  1.25  51  60    60];
LonNAm = [-168.75 -10 -10     -37.5 -30 -75 -82.5 -105  -180 -180 -168.75];
LatNA2 = [51    51  60];
LonNA2 = [166.6 180 180];

LatSAm = [1.25   1.25  15  15 -60 -60];
LonSAm = [-105 -82.5  -75 -30 -30 -105];

LatEur = [90   90  42.5 42.5 40.79 41 40.55 40.40 40.05 39.17 35.46 33   38  35.42 28.25 15  57.5  78.13];
LonEur = [-10 77.5 48.8 30   28.81 29 27.31 26.75 26.36 25.19 27.91 27.5 10 -10  -13   -30 -37.5 -10];

LatAfr = [15  28.25 35.42 38 33   31.74 29.54 27.78 11.3 12.5 -60 -60];
LonAfr = [-30 -13   -10 10 27.5 34.58 34.92 34.46 44.3 52    75 -30];

LatAus = [-11.88 -10.27 -10 -30    -52.5 -31.88];
LonAus = [110      140  145 161.25 142.5  110];

LatAsi = [90   42.5 42.5 40.79 41 40.55 40.4  40.05 39.17 35.46 33   31.74 29.54 27.78 11.3 12.5 -60 -60 -31.88 -11.88 -10.27 33.13 51    60  90];
LonAsi = [77.5 48.8 30   28.81 29 27.31 26.75 26.36 25.19 27.91 27.5 34.58 34.92 34.46 44.3 52   75  110  110   110    140    140   166.6 180 180];
LatAs2 = [90    90      60      60];
LonAs2 = [-180 -168.75 -168.75 -180];

LatAnt = [-60 -60 -90 -90];
LonAnt = [-180 180 180 -180];

inNAm         = inpolygon(Lat,Lon,LatNAm,LonNAm) + inpolygon(Lat,Lon,LatNA2,LonNA2);
inEur         = inpolygon(Lat,Lon,LatEur,LonEur);
[inSAm,onSAm] = inpolygon(Lat,Lon,LatSAm,LonSAm);
[inAfr,onAfr] = inpolygon(Lat,Lon,LatAfr,LonAfr);
[inAus,onAus] = inpolygon(Lat,Lon,LatAus,LonAus);
[inAsi,onAsi] = inpolygon(Lat,Lon,LatAsi,LonAsi);
[inAs2,onAs2] = inpolygon(Lat,Lon,LatAs2,LonAs2);

ContinentIndex  = 1 +(inAfr||onAfr)*1 + (inAus||onAus)*2 + (inAsi||onAsi||inAs2||onAs2)*3 + inEur*4 + inNAm*5 + (inSAm||onSAm)*6;
ContinentList   = {'Pacific','Africa','Australia','Asia','Europe','North_America','South_America'};

Continent       = ContinentList{ContinentIndex};
%% If you want to show the figure, set plotTrueFalse to true or to ~=0.
if plotTrueFalse
    geoshow('landareas.shp', 'FaceColor', [1 1 1]);
    axis([-180 180 -90 90])
    set(gca,'xtick',-180:15:180,'ytick',-90:15:90)
    grid on;
    hold on;
    patch(LonNAm,LatNAm,'r');
    patch(LonNA2,LatNA2,'r');
    patch(LonSAm,LatSAm,'g');
    patch(LonEur,LatEur,'b');
    patch(LonAfr,LatAfr,'k');
    patch(LonAus,LatAus,[1 0.5 0]);
    patch(LonAsi,LatAsi,'y');
    patch(LonAs2,LatAs2,'y');
    patch(LonAnt,LatAnt,[0 1 1]);
    alpha(0.5);
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T06:47:34.507

您可以使用 Google 地理编码 API。假设我们要搜索 latitude = 22, longitude = 77（落在亚洲），你可以运行这段代码：

```
 url = 'http://maps.googleapis.com/maps/api/geocode/json?latlng=22,77&sensor=true';
  urlread(url) 
```

这将返回一些详细信息，您还可以在其中获得该纬度、经度所在的国家/地区。现在您可以在查找表中查找该国家/地区。您将需要创建此查找表（或下载它）。

我从这个答案中提供的一个创建了这样一个查找表：[https ://stackoverflow.com/a/1283168/845528](https://stackoverflow.com/a/1283168/845528)

完整的代码在这里：

```
 str = {'AD','Europe';'AE','Asia';'AF','Asia';'AG','North America';'AI','North America';'AL','Europe';'AM','Asia';'AN','North America';'AO','Africa';'AQ','Antarctica';'AR','South America';'AS','Australia';'AT','Europe';'AU','Australia';'AW','North America';'AZ','Asia';'BA','Europe';'BB','North America';'BD','Asia';'BE','Europe';'BF','Africa';'BG','Europe';'BH','Asia';'BI','Africa';'BJ','Africa';'BM','North America';'BN','Asia';'BO','South America';'BR','South America';'BS','North America';'BT','Asia';'BW','Africa';'BY','Europe';'BZ','North America';'CA','North America';'CC','Asia';'CD','Africa';'CF','Africa';'CG','Africa';'CH','Europe';'CI','Africa';'CK','Australia';'CL','South America';'CM','Africa';'CN','Asia';'CO','South America';'CR','North America';'CU','North America';'CV','Africa';'CX','Asia';'CY','Asia';'CZ','Europe';'DE','Europe';'DJ','Africa';'DK','Europe';'DM','North America';'DO','North America';'DZ','Africa';'EC','South America';'EE','Europe';'EG','Africa';'EH','Africa';'ER','Africa';'ES','Europe';'ET','Africa';'FI','Europe';'FJ','Australia';'FK','South America';'FM','Australia';'FO','Europe';'FR','Europe';'GA','Africa';'GB','Europe';'GD','North America';'GE','Asia';'GF','South America';'GG','Europe';'GH','Africa';'GI','Europe';'GL','North America';'GM','Africa';'GN','Africa';'GP','North America';'GQ','Africa';'GR','Europe';'GS','Antarctica';'GT','North America';'GU','Australia';'GW','Africa';'GY','South America';'HK','Asia';'HN','North America';'HR','Europe';'HT','North America';'HU','Europe';'ID','Asia';'IE','Europe';'IL','Asia';'IM','Europe';'IN','Asia';'IO','Asia';'IQ','Asia';'IR','Asia';'IS','Europe';'IT','Europe';'JE','Europe';'JM','North America';'JO','Asia';'JP','Asia';'KE','Africa';'KG','Asia';'KH','Asia';'KI','Australia';'KM','Africa';'KN','North America';'KP','Asia';'KR','Asia';'KW','Asia';'KY','North America';'KZ','Asia';'LA','Asia';'LB','Asia';'LC','North America';'LI','Europe';'LK','Asia';'LR','Africa';'LS','Africa';'LT','Europe';'LU','Europe';'LV','Europe';'LY','Africa';'MA','Africa';'MC','Europe';'MD','Europe';'ME','Europe';'MG','Africa';'MH','Australia';'MK','Europe';'ML','Africa';'MM','Asia';'MN','Asia';'MO','Asia';'MP','Australia';'MQ','North America';'MR','Africa';'MS','North America';'MT','Europe';'MU','Africa';'MV','Asia';'MW','Africa';'MX','North America';'MY','Asia';'MZ','Africa';'NA','Africa';'NC','Australia';'NE','Africa';'NF','Australia';'NG','Africa';'NI','North America';'NL','Europe';'NO','Europe';'NP','Asia';'NR','Australia';'NU','Australia';'NZ','Australia';'OM','Asia';'PA','North America';'PE','South America';'PF','Australia';'PG','Australia';'PH','Asia';'PK','Asia';'PL','Europe';'PM','North America';'PN','Australia';'PR','North America';'PS','Asia';'PT','Europe';'PW','Australia';'PY','South America';'QA','Asia';'RE','Africa';'RO','Europe';'RS','Europe';'RU','Europe';'RW','Africa';'SA','Asia';'SB','Australia';'SC','Africa';'SD','Africa';'SE','Europe';'SG','Asia';'SH','Africa';'SI','Europe';'SJ','Europe';'SK','Europe';'SL','Africa';'SM','Europe';'SN','Africa';'SO','Africa';'SR','South America';'ST','Africa';'SV','North America';'SY','Asia';'SZ','Africa';'TC','North America';'TD','Africa';'TF','Antarctica';'TG','Africa';'TH','Asia';'TJ','Asia';'TK','Australia';'TM','Asia';'TN','Africa';'TO','Australia';'TR','Asia';'TT','North America';'TV','Australia';'TW','Asia';'TZ','Africa';'UA','Europe';'UG','Africa';'US','North America';'UY','South America';'UZ','Asia';'VC','North America';'VE','South America';'VG','North America';'VI','North America';'VN','Asia';'VU','Australia';'WF','Australia';'WS','Australia';'YE','Asia';'YT','Africa';'ZA','Africa';'ZM','Africa';'ZW','Africa'};
    url = 'http://maps.googleapis.com/maps/api/geocode/json?latlng=22,77&sensor=true';
    queryResult = urlread(url)
    countryName = queryResult(672:673);
    strfind(cellstr(str), countryName);
    continent = str(find(strcmp(countryName, str)), 2) 
```

# java - 如何修复 Netbeans 7.2.1 无法正确构建/编译？

> ID：13905651
> 
> 赞同：1
> 
> 时间：2012-12-16T21:28:41.950
> 
> 标签：java, netbeans

我有一个类，然后当我编辑然后构建 Netbeans 时，它不会识别出我在运行时更改了代码。当使用调试模式时，它不会让我在我的新代码上设置断点，并且就像旧代码仍然存在一样。我已经单独编译了这个类，对整个项目使用构建，对整个项目使用构建和清理，重新启动 netbeans，重新启动计算机。除了重新创建整个项目之外，是否有人对此进行了修复（这是不合理的，因为该项目已退出大型并被其他项目使用）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T17:09:44.780

尝试重命名课程。有时它是重命名的问题（小写/大写）。

或者将该类移动到另一个包中。吉尔卡

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T20:26:23.117

问题是项目（A）被添加到另一个项目（B）的库中。
在主项目（Main）中，B 在 A 之前被添加到库中，所以在运行时，由于我没有重建 B，它使用的是旧的 A 代码。

我通过从 Main 的库中删除 B 的引用并从 B 的库中删除 A 的引用来解决此问题，因为 Main 不需要这些引用才能正常运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-29T14:20:27.810

重命名课程对我有用。Netbeans 不明白他必须先编译一个类，然后再编译另一个。经过几次重命名（然后返回），它起作用了！

# google-chrome - chrome 中的非 2 次幂纹理渲染警告

> ID：13905652
> 
> 赞同：7
> 
> 时间：2012-12-16T21:28:51.027
> 
> 标签：google-chrome, textures, webgl

页面： http: [//nps.netarteria.pl/gallery/](http://nps.netarteria.pl/gallery/) 我正在关注本教程：[https](https://developer.mozilla.org/en-US/docs/WebGL/Animating_textures_in_WebGL) ://developer.mozilla.org/en-US/docs/WebGL/Animating_textures_in_WebGL但我的 chrome（在检查模式下）显示了这一点警告：`58RENDER WARNING: texture bound to texture unit 0 is not renderable. It maybe non-power-of-2 and have incompatible texture filtering or is not 'texture complete'`。但是我**正在**使用正确的过滤（非mipmap），所以我不确定出了什么问题。还要注意两个视频中像素的底线 - 它被拉伸了，我不确定这是否相关。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-23T18:49:32.780

我对视频纹理也有同样的问题。您需要做的是避免在纹理不是默认启用的 2 的幂时使用 mipmap：

```
_tmpTex.generateMipmaps = false;
_tmpTex.minFilter = THREE.LinearFilter;
_tmpTex.magFilter = THREE.LinearFilter; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T11:28:08.583

如果您的纹理不是 2 号大小的 pow，请不要在该纹理缩小器方法上使用（或禁用）mippmapping。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-22T00:38:23.953

将 gman 的评论放入答案中（它对我有用）：

确保在渲染图像之前加载图像并调用 `texImage2D'。

# php - XML 到 CSV = 无效参数

> ID：13905653
> 
> 赞同：0
> 
> 时间：2012-12-16T21:28:52.990
> 
> 标签：php, xml, parsing

您好，我有以下从远程站点返回的 xml 结果

```
<ResultSet totalResultsAvailable="1">
  <Product orderNo="5321" partNo="A2345" truckable="1">
  <Manufacturer id="22">WIDGET 4 U</Manufacturer>
  <Model id="356">ACME 500</Model>
  <Years>95-98</Years>
  <ProductType id="23" categoryID="4">Cool Red Widgest</ProductType>
  <Material id="6">shiny stuff</Material>
  <PartNo>A2345</PartNo>
  <Code/>
</Product>
</ResultSet> 
```

我只是试图提取 xml 结果并使用以下代码放入一个新的 csv 文件中：

但我得到错误：警告：

```
Invalid argument supplied for foreach() in /home/myServer/public_html/xmlParser2.php on line 14 
```

这是我的代码：

```
<?
echo 'Write XML to CSV';
$basenameLong ='http://thisIsTheURLto.com/myFeed/?key=123456789&mode=getProducts;
$fileNameCSV = 'xmlParseContent.csv';

$feedContent = '';    
echo '<br/>Starting......';     
$feedContent = file_get_contents($basenameLong);

$fh = fopen($fileNameCSV, 'w+'); //create new CSV file if not exists else append

foreach($feedContent->ResultSet->Product as $product) {

    fputcsv($f, get_object_vars($product),',','"');
}
fclose($fh);

?> 
```

我知道这段代码非常基本，但你能帮我找到问题吗？我是新手，我没有看到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:37:06.753

这一行是错误的：

```
fputcsv($f, get_object_vars($product),',','"'); 
```

如果您想输入空白值，请尝试这样做：

```
fputcsv($f, get_object_vars($product),'','',''); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T12:19:29.573

您的问题是您从不解析 XML 文件。替换`file_get_contents`为`simplexml_load_file`它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T12:35:56.537

使用 PHP 将 XML 转换为 CSV 相当容易，至少在我目前遇到的情况下是这样。就我而言，如果我可以简单地将结构化 XML 数据转换为 CSV 数据，那将节省大量工作。通常，我只想转换原始 XML 文档的特定 xpath 中的数据。下面的 PHP 函数将加载一个 XML 文件并将指定 xpath 中的元素转换为简单的 csv 数据。

```
function xml2csv ($xmlFile, $xPath) {

    // Load the XML file
    $xml = simplexml_load_file($xmlFile);

    // Jump to the specified xpath
    $path = $xml->xpath($xPath);

    // Loop through the specified xpath
    foreach($path as $item) {

        // Loop through the elements in this xpath
        foreach($item as $key => $value) {

            $csvData .= '"' . trim($value) . '"' . ',';

        }

        // Trim off the extra comma
        $csvData = trim($csvData, ',');

        // Add an LF
        $csvData .= "\n";

    }

    // Return the CSV data
    return $csvData;

} 
```

# c# - 消失的代码？

> ID：13905659
> 
> 赞同：1
> 
> 时间：2012-12-16T21:29:20.793
> 
> 标签：c#, events, datagridview, designer

我正在开发一个项目，我想根据 dataGridView 中的选择加载信息。我在表单的设计器中创建了一个 dataGridView 并添加了这一行：

```
this.dataGridView1.SelectionChanged += methodToBeCalled; 
```

这一切都很好，但我有一个讨厌的问题。大多数情况下，当我启动我的应用程序时，选择一行后什么都没有发生。然后，当我查看我的代码时，这行代码已经完全消失了。

首先我认为有人在我的代码上提交了一些代码，但即使我不更新它也会消失。

消失的代码可能是什么原因（错误/视觉工作室设计）？我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-16T21:32:02.363

你把它放在 .designer.cs 文件中对吗？这是错误的。它必须放在屏幕后面的正常代码中。.designer 文件可以在系统需要时重新生成。

# android - 意图标志 - 如何启动一个新的活动实例并关闭其他活动实例

> ID：13905660
> 
> 赞同：7
> 
> 时间：2012-12-16T21:29:34.537
> 
> 标签：android, android-intent, flags

我对意图标志不是很熟悉，所以请多多包涵。

我正在做一个应用程序，它在 ViewPager 中显示数据库中的内容。*我还有一个小部件，它不时拉出一个随机行并显示它。现在，当我单击它时，我会进入一个显示相同内容的活动，现在我可以对其采取行动。*

一切正常，但是当我已经运行了一个活动然后单击小部件时，它似乎创建了一个新实例，因为当我按下后退按钮时，我没有退出应用程序，而是被带到前一个实例或其他东西。

**有没有办法启动一个新的活动实例，如果有一些以前的实例运行关闭它们，使用标志？**

我玩过 CLEAR_TOP 之类的东西，但老实说我不知道​​我在做什么。

谢谢！

//编辑

Intent.FLAG_ACTIVITY_CLEAR_TOP 似乎没有做任何事情。Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP 似乎将前一个带到顶部而忽略了新的或其他东西。也许让我换个说法，我从启动器图标开始活动，然后按主页按钮并单击小部件，它应该会打开一个新实例，其中 ViewPager.setCurrentItem 设置正确的页面（与小部件中相同）。如果之前没有运行主要活动，一切都很好，但如果它正在运行，则完成它。

```
MyWidgetProvider extends AppWidgetProvider

@Override
public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
    Log.d("MainActivity", "MyWidgetProvider # onUpdate");

    for (int i = 0; i < appWidgetIds.length; i++) {
        int appWidgetId = appWidgetIds[i];

        Intent intent = new Intent(context, MainActivity.class);
        intent.putExtra("from_widget", true);
        //intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);
        PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);

        RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
        views.setOnClickPendingIntent(R.id.widget_container, pendingIntent);

        appWidgetManager.updateAppWidget(appWidgetId, views);
    }

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-17T10:24:19.007

有几种方法可以做到这一点。如果要创建一个新实例并关闭当前实例（假设它位于活动堆栈的顶部），则需要设置`Intent.FLAG_ACTIVITY_CLEAR_TOP`.

另一种选择是重用相同的活动实例，如果它已经在堆栈的顶部。在这种情况下，您需要同时**设置** `Intent.FLAG_ACTIVITY_CLEAR_TOP`和`Intent.FLAG_ACTIVITY_SINGLE_TOP`。如果您这样做，Android 将不会创建该 Activity 的另一个实例，而是会调用`onNewIntent()`您的 Activity 以传递新的 Intent。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-17T10:30:44.777

标记其他关闭，

```
Intent.FLAG_ACTIVITY_CLEAR_TOP 
```

并标记新实例，

```
Intent.FLAG_ACTIVITY_NEW_TASK 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-10T05:52:44.020

我的要求是使用新实例启动活动（AbcActivity）并关闭相同活动（AbcActivity）的任何其他实例（如果有），并关闭顶部的其他活动（如果有）。对我有用的解决方案是：

```
startActivity(new Intent(MainActivity.this,AbcActivity.class)
            .addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK)); 
```

# c++ - 如何获取 GDI 句柄列表

> ID：13905661
> 
> 赞同：9
> 
> 时间：2012-12-16T21:29:34.430
> 
> 标签：c++, c, windows, winapi, gdi

我正在尝试使用 DLL 注入方法编写显示另一个程序使用的位图的应用程序，并且我想获取它正在使用的 GDI 句柄的这个特定进程列表（类似于 GDIView.exe 实用程序中的列表）。我找到了有关 NtQuerySystemInformation 函数的文章，但此描述仅适用于内核对象的句柄。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-23T15:56:36.117

这是一个控制台应用程序代码，它转储给定进程标识符的所有 GDI 句柄。它应该为 32 位或 64 位应用程序以及在 64 位操作系统上运行的 32 位应用程序编译和工作正常。它使用了很多未记录的函数，所以不要依赖它 :-) 共享 GDI 表的结构归功于[冯源](http://www.fengyuan.com/)的原创作品。（我不得不为 WOW64 改编它）。

以下是在记事本（64 位）进程上运行时的示例输出：

```
[C:\Temp\EnumGdi\Debug]EnumGdi.exe 5916
DC handle:0xF20105DB
Bitmap handle:0xDF05118B
Font handle:0xDC0A19E0
Font handle:0xAB0A1A62
DC handle:0xA3011A63
Region handle:0xAF041B7B
Brush handle:0x11101C5B
Font handle:0x280A1CA1
Font handle:0xBB0A1D13
Bitmap handle:0xA3051DD8
Font handle:0xB40A1DDC
Region handle:0x3A041EE4
Brush handle:0x0B101F04
Region handle:0xC6041F3D
Font handle:0x2C0A2384
Brush handle:0xBA1024DA 
```

枚举Gdi.cpp：

```
#include "stdafx.h"
#include "enumgdi.h"

int _tmain(int argc, _TCHAR* argv[])
{   
    if (argc < 2)
    {
        printf("Format is EnumGdi <process id>\n");
        return 0;
    }

    // get process identifier
    DWORD dwId = _wtoi(argv[1]);

    // open the process
    HANDLE hProcess = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, FALSE, dwId);
    DWORD err = 0;
    if (hProcess == NULL)
    {
        printf("OpenProcess %u failed\n", dwId);
        err = GetLastError();
        return -1;
    }

    // determine if 64 or 32-bit processor
    SYSTEM_INFO si;
    GetNativeSystemInfo(&si);

    // NOTE: as this is undocumented, it *may vary* depending on bitness (32/64) and on Windows version.
    // use WinDbg "dt ntdll!_PEB" command and search for GdiSharedHandleTable offset to find the truth out
    DWORD GdiSharedHandleTableOffset  = si.wProcessorArchitecture == PROCESSOR_ARCHITECTURE_AMD64 ? 0xF8 : 0x94;
    DWORD tableCount = 16384; // count of GDI table cells

    // determine if this process is running on WOW64
    BOOL wow;
    IsWow64Process(GetCurrentProcess(), &wow);

    // read basic info to get PEB address, we only need the beginning of PEB
    DWORD pebSize = GdiSharedHandleTableOffset + 8;
    LPBYTE peb = (LPBYTE)malloc(pebSize);
    ZeroMemory(peb, pebSize);

    if (wow)
    {
        // we're running as a 32-bit process in a 64-bit process
        PROCESS_BASIC_INFORMATION_WOW64 pbi;
        ZeroMemory(&pbi, sizeof(pbi));

        // get process information from 64-bit world
        _NtQueryInformationProcess query = (_NtQueryInformationProcess)GetProcAddress(GetModuleHandleA("ntdll.dll"), "NtWow64QueryInformationProcess64");
        err = query(hProcess, 0, &pbi, sizeof(pbi), NULL);
        if (err != 0)
        {
            printf("NtWow64QueryInformationProcess64 failed\n");
            CloseHandle(hProcess);
            return -1;
        }

        // read PEB from 64-bit address space
        _NtWow64ReadVirtualMemory64 read = (_NtWow64ReadVirtualMemory64)GetProcAddress(GetModuleHandleA("ntdll.dll"), "NtWow64ReadVirtualMemory64");
        err = read(hProcess, pbi.PebBaseAddress, peb, pebSize, NULL);
        if (err != 0)
        {
            printf("NtWow64ReadVirtualMemory64 PEB failed\n");
            CloseHandle(hProcess);
            return -1;
        }

        // get GDI table ptr from PEB
        GDICELL_WOW64* gdiTable = (GDICELL_WOW64*)*(LPVOID*)(peb + GdiSharedHandleTableOffset); // address in remote process adress space
        if (gdiTable == NULL)
        {
            printf("GDI32.DLL is not loaded in the process\n");
            CloseHandle(hProcess);
            return -1;
        }
        free(peb);
        DWORD tableSize = sizeof(GDICELL_WOW64) * tableCount; // size of GDI table
        GDICELL_WOW64* table = (GDICELL_WOW64*)malloc(tableSize); // local table copied over to our address space

        // copy GDI table
        err = read(hProcess, gdiTable, table, tableSize, NULL);
        if (err != 0)
        {
            printf("NtWow64ReadVirtualMemory64 GdiTable failed\n");
            free(table);
            CloseHandle(hProcess);
            return -1;
        }

        for(DWORD i = 0; i < tableCount; i++)
        {
            GDICELL_WOW64 cell = table[i];
            if (cell.wProcessId != dwId)
                continue;

            HGDIOBJ gdiHandle = (HGDIOBJ)((cell.wUpper << 16) + i);
            WORD type = cell.wType & 0x7F;
            switch(type)
            {
                case 1:
                    printf("DC handle:0x%08X\n", gdiHandle );
                    break;

                case 4:
                    printf("Region handle:0x%08X\n", gdiHandle);
                    break;

                case 5:
                    printf("Bitmap handle:0x%08X\n", gdiHandle);
                    break;

                case 8:
                    printf("Palette handle:0x%08X\n", gdiHandle);
                    break;

                case 10:
                    printf("Font handle:0x%08X\n", gdiHandle);
                    break;

                case 16:
                    printf("Brush handle:0x%08X\n", gdiHandle);
                    break;

                case 48:
                    printf("Pen handle:0x%08X\n", gdiHandle);
                    break;

                default:
                    printf("Unknown type handle:0x%08X\n", gdiHandle);
                    break;
            }
        }
        free(table);
    }
    else
    {
        // we're running as a 32-bit process in a 32-bit OS, or as a 64-bit process in a 64-bit OS
        PROCESS_BASIC_INFORMATION pbi;
        ZeroMemory(&pbi, sizeof(pbi));

        // get process information
        _NtQueryInformationProcess query = (_NtQueryInformationProcess)GetProcAddress(GetModuleHandleA("ntdll.dll"), "NtQueryInformationProcess");
        err = query(hProcess, 0, &pbi, sizeof(pbi), NULL);
        if (err != 0)
        {
            printf("NtQueryInformationProcess failed\n");
            CloseHandle(hProcess);
            return -1;
        }

        // read PEB
        _NtReadVirtualMemory read = (_NtReadVirtualMemory)GetProcAddress(GetModuleHandleA("ntdll.dll"), "NtReadVirtualMemory");
        err = read(hProcess, pbi.PebBaseAddress, peb, pebSize, NULL);
        if (err != 0)
        {
            printf("NtReadVirtualMemory PEB failed\n");
            CloseHandle(hProcess);
            return -1;
        }

        // get GDI table ptr
        GDICELL* gdiTable = (GDICELL*)*(LPVOID*)(peb + GdiSharedHandleTableOffset); // address in remote process adress space
        if (gdiTable == NULL)
        {
            printf("GDI32.DLL is not loaded in the process\n");
            CloseHandle(hProcess);
            return -1;
        }
        free(peb);

        DWORD tableSize = sizeof(GDICELL) * tableCount; // size of GDI table
        GDICELL* table = (GDICELL*)malloc(tableSize); // local table copied over to our address space

        // read GDI table
        err = read(hProcess, gdiTable, table, tableSize, NULL);
        if (err != 0)
        {
            printf("NtReadVirtualMemory GdiTable failed\n");
            free(table);
            CloseHandle(hProcess);
            return -1;
        }

        for(DWORD i = 0; i < tableCount; i++)
        {
            GDICELL cell = table[i];
            if (cell.wProcessId != dwId)
                continue;

            HGDIOBJ gdiHandle = (HGDIOBJ)((cell.wUpper << 16) + i);
            WORD type = cell.wType & 0x7F;
            switch(type)
            {
                case 1:
                    printf("DC handle:0x%08X\n", gdiHandle );
                    break;

                case 4:
                    printf("Region handle:0x%08X\n", gdiHandle);
                    break;

                case 5:
                    printf("Bitmap handle:0x%08X\n", gdiHandle);
                    break;

                case 8:
                    printf("Palette handle:0x%08X\n", gdiHandle);
                    break;

                case 10:
                    printf("Font handle:0x%08X\n", gdiHandle);
                    break;

                case 16:
                    printf("Brush handle:0x%08X\n", gdiHandle);
                    break;

                case 48:
                    printf("Pen handle:0x%08X\n", gdiHandle);
                    break;

                default:
                    printf("Unknown type handle:0x%08X\n", gdiHandle);
                    break;
            }
        }
        free(table);
    }
    CloseHandle(hProcess);
} 
```

枚举Gdi.h：

```
#pragma once
#include "stdafx.h"

// defines a GDI CELL
typedef struct
{
    LPVOID pKernelAddress;
    USHORT wProcessId;
    USHORT wCount;
    USHORT wUpper;
    USHORT wType;
    LPVOID pUserAddress;
} GDICELL;

// defines a GDI CELL for WOW64
typedef struct
{
    PVOID64 pKernelAddress;
    USHORT wProcessId;
    USHORT wCount;
    USHORT wUpper;
    USHORT wType;
    PVOID64 pUserAddress;
} GDICELL_WOW64;

// NtQueryInformationProcess for pure 32 and 64-bit processes
typedef NTSTATUS (NTAPI *_NtQueryInformationProcess)(
    IN HANDLE ProcessHandle,
    ULONG ProcessInformationClass,
    OUT PVOID ProcessInformation,
    IN ULONG ProcessInformationLength,
    OUT PULONG ReturnLength OPTIONAL
    );

typedef NTSTATUS (NTAPI *_NtReadVirtualMemory)(
    IN HANDLE ProcessHandle,
    IN PVOID BaseAddress,
    OUT PVOID Buffer,
    IN SIZE_T Size,
    OUT PSIZE_T NumberOfBytesRead);

// NtQueryInformationProcess for 32-bit process on WOW64
typedef NTSTATUS (NTAPI *_NtWow64ReadVirtualMemory64)(
    IN HANDLE ProcessHandle,
    IN PVOID64 BaseAddress,
    OUT PVOID Buffer,
    IN ULONG64 Size,
    OUT PULONG64 NumberOfBytesRead);

// PROCESS_BASIC_INFORMATION for pure 32 and 64-bit processes
typedef struct _PROCESS_BASIC_INFORMATION {
    PVOID Reserved1;
    PVOID PebBaseAddress;
    PVOID Reserved2[2];
    ULONG_PTR UniqueProcessId;
    PVOID Reserved3;
} PROCESS_BASIC_INFORMATION;

// PROCESS_BASIC_INFORMATION for 32-bit process on WOW64
// The definition is quite funky, as we just lazily doubled sizes to match offsets...
typedef struct _PROCESS_BASIC_INFORMATION_WOW64 {
    PVOID Reserved1[2];
    PVOID64 PebBaseAddress;
    PVOID Reserved2[4];
    ULONG_PTR UniqueProcessId[2];
    PVOID Reserved3[2];
} PROCESS_BASIC_INFORMATION_WOW64; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-16T21:42:40.633

首先，您必须定义“GDI 句柄”的确切含义以及为什么需要了解它们，因为有不同类型的句柄。

从技术上讲，有 3 种主要类型的手柄：

*   内核句柄。示例：文件句柄、同步对象（事件、互斥锁等）、文件映射等。
*   用户句柄。示例：`HWND`, `HDC`, `HICON`, 桌面手柄等。
*   GDI 句柄。示例：`HBITMAP`, `HGDIOBJ`（子类型是`HRGN`,`HPEN`等等）。

特别是有些人混淆了用户和 GDI 句柄。不是每个人都知道`HDC`用于绘图的实际上**不是**GDI 句柄。

从实现的角度来看，用户句柄和 GDI 句柄之间存在很大差异。用户句柄是系统范围的，它们在内核中进行管理。因此有机会在内核模式下收集有关它们的所有信息。OTOH GDI 句柄是特定于进程的。一些 GDI 对象纯粹在用户模式下进行管理（例如区域和 DIB）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-13T13:16:13.070

```
Compilable and Buildable
//Lets name it GDIInquiry.cpp
    #pragma once
    #include "stdafx.h"
    #include "StdAfx.h"
    #include <tchar.h>
    #include <stdio.h>
    #include <malloc.h>
    #include <dbghelp.h>
    #include <shlwapi.h>
    #include <ShlObj.h>
    #include "GDIInquiry.h"

    int _tmain(int argc, _TCHAR* argv[])
    {
        if (argc < 2)
        {
            printf("Format is EnumGdi <process id>\n");
            system("pause");
            return 0;
        }

        // get process identifier
        DWORD dwId = _wtoi(argv[1]);

        // open the process
        HANDLE hProcess = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, FALSE, dwId);
        DWORD err = 0;
        if (hProcess == NULL)
        {
            printf("OpenProcess %u failed\n", dwId);
            err = GetLastError();
            system("pause");
            return -1;
        }

        // determine if 64 or 32-bit processor
        SYSTEM_INFO si;
        GetNativeSystemInfo(&si);

        // NOTE: as this is undocumented, it *may vary* depending on bitness (32/64) and on Windows version.
        // use WinDbg "dt ntdll!_PEB" command and search for GdiSharedHandleTable offset to find the truth out
        DWORD GdiSharedHandleTableOffset = si.wProcessorArchitecture == PROCESSOR_ARCHITECTURE_AMD64 ? 0xF8 : 0x94;
        DWORD tableCount = 16384; // count of GDI table cells

        // determine if this process is running on WOW64
        BOOL wow;
        IsWow64Process(GetCurrentProcess(), &wow);

        // read basic info to get PEB address, we only need the beginning of PEB
        DWORD pebSize = GdiSharedHandleTableOffset + 8;
        LPBYTE peb = (LPBYTE)malloc(pebSize);
        ZeroMemory(peb, pebSize);

        int nDCHandle, nRegionHandle, nBitmapHandle, nPaletteHandle, nFontHandle, nPenHandle, nBrushHandle, nOtherHandle;
        nDCHandle = nRegionHandle = nBitmapHandle = nPaletteHandle = nFontHandle = nPenHandle = nBrushHandle = nOtherHandle = 0;

        if (wow)
        {
            // we're running as a 32-bit process in a 64-bit process
            PROCESS_BASIC_INFORMATION_WOW64 pbi;
            ZeroMemory(&pbi, sizeof(pbi));

            // get process information from 64-bit world
            _NtQueryInformationProcess query = (_NtQueryInformationProcess)GetProcAddress(GetModuleHandleA("ntdll.dll"), "NtWow64QueryInformationProcess64");
            err = query(hProcess, 0, &pbi, sizeof(pbi), NULL);
            if (err != 0)
            {
                printf("NtWow64QueryInformationProcess64 failed\n");
                CloseHandle(hProcess);
                system("pause");
                return -1;
            }

            // read PEB from 64-bit address space
            _NtWow64ReadVirtualMemory64 read = (_NtWow64ReadVirtualMemory64)GetProcAddress(GetModuleHandleA("ntdll.dll"), "NtWow64ReadVirtualMemory64");
            err = read(hProcess, pbi.PebBaseAddress, peb, pebSize, NULL);
            if (err != 0)
            {
                printf("NtWow64ReadVirtualMemory64 PEB failed\n");
                CloseHandle(hProcess);
                system("pause");
                return -1;
            }

            // get GDI table ptr from PEB
            GDICELL_WOW64* gdiTable = (GDICELL_WOW64*)*(LPVOID*)(peb + GdiSharedHandleTableOffset); // address in remote process adress space
            if (gdiTable == NULL)
            {
                printf("GDI32.DLL is not loaded in the process\n");
                CloseHandle(hProcess);
                system("pause");
                return -1;
            }
            free(peb);
            DWORD tableSize = sizeof(GDICELL_WOW64)* tableCount; // size of GDI table
            GDICELL_WOW64* table = (GDICELL_WOW64*)malloc(tableSize); // local table copied over to our address space

            // copy GDI table
            err = read(hProcess, gdiTable, table, tableSize, NULL);
            if (err != 0)
            {
                printf("NtWow64ReadVirtualMemory64 GdiTable failed\n");
                free(table);
                CloseHandle(hProcess);
                system("pause");
                return -1;
            }

            for (DWORD i = 0; i < tableCount; i++)
            {
                GDICELL_WOW64 cell = table[i];
                if (cell.wProcessId != dwId)
                    continue;

                HGDIOBJ gdiHandle = (HGDIOBJ)((cell.wUpper << 16) + i);
                WORD type = cell.wType & 0x7F;
                switch (type)
                {
                case 1:
                    //printf("DC handle:0x%08X\n", gdiHandle);
                    nDCHandle++;
                    break;

                case 4:
                    //printf("Region handle:0x%08X\n", gdiHandle);
                    nRegionHandle++;
                    break;

                case 5:
                    //printf("Bitmap handle:0x%08X\n", gdiHandle);
                    nBitmapHandle++;
                    break;

                case 8:
                    //printf("Palette handle:0x%08X\n", gdiHandle);
                    nPaletteHandle++;
                    break;

                case 10:
                    //printf("Font handle:0x%08X\n", gdiHandle);
                    nFontHandle++;
                    break;

                case 16:
                    //printf("Brush handle:0x%08X\n", gdiHandle);
                    nPenHandle++;
                    break;

                case 48:
                    //printf("Pen handle:0x%08X\n", gdiHandle);
                    nBrushHandle++;
                    break;

                default:
                    //printf("Unknown type handle:0x%08X\n", gdiHandle);
                    nOtherHandle++;
                    break;
                }
            }
            free(table);
        }
        else
        {
            // we're running as a 32-bit process in a 32-bit OS, or as a 64-bit process in a 64-bit OS
            PROCESS_BASIC_INFORMATION pbi;
            ZeroMemory(&pbi, sizeof(pbi));

            // get process information
            _NtQueryInformationProcess query = (_NtQueryInformationProcess)GetProcAddress(GetModuleHandleA("ntdll.dll"), "NtQueryInformationProcess");
            err = query(hProcess, 0, &pbi, sizeof(pbi), NULL);
            if (err != 0)
            {
                printf("NtQueryInformationProcess failed\n");
                CloseHandle(hProcess);
                system("pause");
                return -1;
            }

            // read PEB
            _NtReadVirtualMemory read = (_NtReadVirtualMemory)GetProcAddress(GetModuleHandleA("ntdll.dll"), "NtReadVirtualMemory");
            err = read(hProcess, pbi.PebBaseAddress, peb, pebSize, NULL);
            if (err != 0)
            {
                printf("NtReadVirtualMemory PEB failed\n");
                CloseHandle(hProcess);
                system("pause");
                return -1;
            }

            // get GDI table ptr
            GDICELL* gdiTable = (GDICELL*)*(LPVOID*)(peb + GdiSharedHandleTableOffset); // address in remote process adress space
            if (gdiTable == NULL)
            {
                printf("GDI32.DLL is not loaded in the process\n");
                CloseHandle(hProcess);
                system("pause");
                return -1;
            }
            free(peb);

            DWORD tableSize = sizeof(GDICELL)* tableCount; // size of GDI table
            GDICELL* table = (GDICELL*)malloc(tableSize); // local table copied over to our address space

            // read GDI table
            err = read(hProcess, gdiTable, table, tableSize, NULL);
            if (err != 0)
            {
                printf("NtReadVirtualMemory GdiTable failed\n");
                free(table);
                CloseHandle(hProcess);
                system("pause");
                return -1;
            }

            for (DWORD i = 0; i < tableCount; i++)
            {
                GDICELL cell = table[i];
                if (cell.wProcessId != dwId)
                    continue;

                HGDIOBJ gdiHandle = (HGDIOBJ)((cell.wUpper << 16) + i);
                WORD type = cell.wType & 0x7F;
                switch (type)
                {
                case 1:
                    //printf("DC handle:0x%08X\n", gdiHandle);
                    nDCHandle++;
                    break;

                case 4:
                    //printf("Region handle:0x%08X\n", gdiHandle);
                    nRegionHandle++;
                    break;

                case 5:
                    //printf("Bitmap handle:0x%08X\n", gdiHandle);
                    nBitmapHandle++;
                    break;

                case 8:
                    //printf("Palette handle:0x%08X\n", gdiHandle);
                    nPaletteHandle++;
                    break;

                case 10:
                    //printf("Font handle:0x%08X\n", gdiHandle);
                    nFontHandle++;
                    break;

                case 16:
                    //printf("Brush handle:0x%08X\n", gdiHandle);
                    nPenHandle++;
                    break;

                case 48:
                    //printf("Pen handle:0x%08X\n", gdiHandle);
                    nBrushHandle++;
                    break;

                default:
                    //printf("Unknown type handle:0x%08X\n", gdiHandle);
                    nOtherHandle++;
                    break;
                }
            }
            free(table);
        }
        CloseHandle(hProcess);
        int nTotalGDI = nDCHandle + nRegionHandle + nBitmapHandle + nPaletteHandle + nFontHandle + nPenHandle + nBrushHandle + nOtherHandle;
        printf("Bitmap:%d\n", nBitmapHandle);
        printf("Brush:%d\n", nPenHandle);
        printf("DeviceContext:%d\n", nDCHandle);
        printf("Font:%d\n", nFontHandle);
        printf("Palette:%d\n", nPaletteHandle);
        printf("Pen:%d\n", nBrushHandle);
        printf("Region:\%d\n", nRegionHandle);
        printf("Unknown:%d\n", nOtherHandle);
        printf("GDITotal:%d\n", nTotalGDI);
        return 1;
    } 
```

和 GDIInquiry.h 代码如下

```
#pragma once
#include "stdafx.h"
#include "Winternl.h"
// defines a GDI CELL
typedef struct
{
    LPVOID pKernelAddress;
    USHORT wProcessId;
    USHORT wCount;
    USHORT wUpper;
    USHORT wType;
    LPVOID pUserAddress;
} GDICELL;

// defines a GDI CELL for WOW64
typedef struct
{
    PVOID64 pKernelAddress;
    USHORT wProcessId;
    USHORT wCount;
    USHORT wUpper;
    USHORT wType;
    PVOID64 pUserAddress;
} GDICELL_WOW64;

// NtQueryInformationProcess for pure 32 and 64-bit processes
typedef NTSTATUS(NTAPI *_NtQueryInformationProcess)(
    IN HANDLE ProcessHandle,
    ULONG ProcessInformationClass,
    OUT PVOID ProcessInformation,
    IN ULONG ProcessInformationLength,
    OUT PULONG ReturnLength OPTIONAL
    );

typedef NTSTATUS(NTAPI *_NtReadVirtualMemory)(
    IN HANDLE ProcessHandle,
    IN PVOID BaseAddress,
    OUT PVOID Buffer,
    IN SIZE_T Size,
    OUT PSIZE_T NumberOfBytesRead);

// NtQueryInformationProcess for 32-bit process on WOW64
typedef NTSTATUS(NTAPI *_NtWow64ReadVirtualMemory64)(
    IN HANDLE ProcessHandle,
    IN PVOID64 BaseAddress,
    OUT PVOID Buffer,
    IN ULONG64 Size,
    OUT PULONG64 NumberOfBytesRead);

// PROCESS_BASIC_INFORMATION for pure 32 and 64-bit processes
/*typedef struct
{
PVOID Reserved1;
PVOID PebBaseAddress;
PVOID Reserved2[2];
ULONG_PTR UniqueProcessId;
PVOID Reserved3;
}PROCESS_BASIC_INFORMATION;*/

// PROCESS_BASIC_INFORMATION for 32-bit process on WOW64
// The definition is quite funky, as we just lazily doubled sizes to match offsets...
typedef struct PROCESS_BASIC_INFORMATION_WOW64
{
    PVOID Reserved1[2];
    PVOID64 PebBaseAddress;
    PVOID Reserved2[4];
    ULONG_PTR UniqueProcessId[2];
    PVOID Reserved3[2];
}PROCESS_BASIC_INFORMATION_WOW64; 
```

结束

```
Run commands:
..\..\GDIInquiry\Debug GDIInquiry.exe PID

Sample Output:
cmd
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

..\..\GDIInquiry\Debug>GDIInquiry.exe 6772
Bitmap:302
Brush:139
DeviceContext:133
Font:75
Palette:1
Pen:0
Region:11
Unknown:0
GDITotal:661 
```

# architecture - 架构：具有节点容错能力的分布式数据处理

> ID：13905665
> 
> 赞同：0
> 
> 时间：2012-12-16T21:30:24.813
> 
> 标签：architecture, queue, distributed-computing, system-design

我有很多需要频繁重复处理的数据/作业（数万）。要处理的作业存储在 SQL Server 2012 (Web Ed) 数据库中，该数据库会频繁更新新作业和/或可能会从中删除作业。

样本：

```
Id     |  WorkItem
1      |  Copy X to Y
2      |  Ping stackoverflow.com
3      |  Verify backupset
4      |  Send an email 
```

我的目标是将作业处理分布在多个节点上，既是出于性能原因，也是为了确保即使节点出现故障也能处理作业。

两个考虑：

*   我需要确保所有作业最终都由*某个*节点执行，并且随着作业被添加到数据库驱动的队列中，这种情况会不断发生。
*   我希望所有节点都进行一些工作，并防止单个节点获取大部分工作，因此实施某种循环似乎是有意义的。

因为整个系统需要抵抗节点故障，所以我不能真正将工作“分配”给节点，因为我不知道怎么了正常的，什么不是。我最初的想法是让每个节点从数据库中“获取”一个或多个作业，处理它们，然后将数据返回到 SQL 数据库。但是，接下来会出现一些问题：

*   节点需要知道其他节点已经在处理什么，因此作业不会被错误地处理两次。这意味着需要将作业标记为正在处理。
*   其中许多作业非常小，但需要非常频繁地执行（可能每 10-30 秒一次）。不断更新谁在处理作业然后释放作业，然后再次处理似乎是主要的数据库开销。
*   如果一个节点在处理过程中死亡会发生什么？有没有办法从中恢复？

解决这个问题最有效的方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:45:50.453

您可能需要尝试 SQL Server 的最佳配置（不是专家）......但基本方案如下：

*   有 5 个列来管理作业处理
    一个称为 DONEUNTIL 的列，它在您的处理节点死亡时充当故障保护……它基本上是一个“估计的处理完成时间点”……
    第二个称为 NODEID，其中包含 NODE 处理的 ID那份工作。
    第三个称为 DONE，一旦作业完成，就会设置为 1。
    第四个称为 CREATED，其中包含将作业放入表中时的时间戳。
    第五个称为JOBID，它是主键。

*   通过将 DONEUNTIL 和 NODEID 设置为 NULL，让每个节点经常清理 DONEUNTIL 已通过且 DONE != 1 的所有作业

*   当一个节点准备好接受下一个作业时，它只选择最旧的 CREATED 在 NODEID 和 DONE 中具有 NULL 的 JOBID ！= 1
    然后在开始处理之前适当地更新 DONEUNTIL 和 NODEID。
    完成处理后，它会更新 DONE = 1。

您可以使用上述的变体——比如拥有工作优先级、重试计数器等，或者将“工作管理信息”放入单独的表格等。

这个方案工作得很好......如果你有很多工作，将 DONE=1 的工作移动到存档表中可能是有意义的......这样你的工作表只包含活动工作（等待处理或正在处理) 这应该保持它顺利运行......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:15:24.470

你肯定需要使用队列机制——Sql Server 有一个内置的队列机制，称为 Sql Service Broker。

# ruby-on-rails-3 - 如何从 ajax 成功调用 JQuery 小部件函数？

> ID：13905666
> 
> 赞同：0
> 
> 时间：2012-12-16T21:30:29.947
> 
> 标签：ruby-on-rails-3, jquery, google-maps-api-3, jquery-widgets

我正在尝试从 ajax 调用的成功节点调用小部件函数，但是，我没有成功。

我的应用程序允许用户在 googlemaps 上添加一些带有一些描述的标记。它使用 JQuery-addresspicker 小部件和 Rails。我添加了一个负责添加标记的函数，它显示一个带有描述文本区域的表单和一个提交信息的按钮。因此，在用户提交后，应用程序调用一个 Ajax 函数来存储用户的数据，如果成功，我想调用另一个小部件函数，例如，仅用于关闭 InfoWindow。

问题是，我不知道如何从成功的 Ajax 节点调用另一个小部件函数。

```
JQuery-addresspicker.js
.
.
.

_addFormListener: function(map, marker) {
    var form = $(".add-form").clone().show();
    var infoWindowContent = form[0];
    var infoWindow = new google.maps.InfoWindow({
        content: infoWindowContent
    });

    google.maps.event.addListener(marker, "click", function() {
        infoWindow.open(map, this);
    });

    form.submit(function (event){
       event.preventDefault();

       var description = $("textarea[name=description]", this).val();
       var latitude    = marker.getPosition().lat();
       var longitude   = marker.getPosition().lng();

       var data = {
         description    : description,
         latitude       : latitude,
         longitude      : longitude
       };

       $.ajax({
        type : "POST",
        url  : "/places",
        data: {place: data},
        beforeSend: function(x) {
            x.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))
        },
        success: function(x) {
            this._closeFormFields(); // Not working!
        }
       });
    });
},

_cleanFormFields: function() {
  console.log("testing");
}
.
.

PlacesController
def create
@place = Place.new(params[:place])

if @place.save
  redirect_to places_path
else
  render :status => 422
end 
```

结尾

浏览器的控制台引发“未捕获的类型错误：对象 [对象窗口] 没有方法 '_cleanFormFields'

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T16:22:29.777

这里的问题是*this*的范围- ajax 调用覆盖*this*以引用 ajax 调用对象并且您丢失了小部件引用。

要解决此问题，只需添加一个变量来存储对小部件的引用，例如

```
 form.submit(function (event){
   event.preventDefault();

   var description = $("textarea[name=description]", this).val();
   var latitude    = marker.getPosition().lat();
   var longitude   = marker.getPosition().lng();

   var data = {
     description    : description,
     latitude       : latitude,
     longitude      : longitude
   };

   //new widget reference var (this here still refers to the widget)
   var widget = this;

   $.ajax({
    type : "POST",
    url  : "/places",
    data: {place: data},
    beforeSend: function(x) {
        x.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))
    },
    success: function(x) {
        //now use the var widget here
        widget._closeFormFields(); // Works!
    }
   });
}); 
```

# schema.org - Schema.org - 我应该为出租车经纪人网站使用哪个 Itemscope？

> ID：13905668
> 
> 赞同：-1
> 
> 时间：2012-12-16T21:30:40.510
> 
> 标签：schema.org

我们正在运营一个网站，人们可以在该网站上预订世界许多地方的机场出租车接送服务。洛杉矶、罗马、伦敦等

为了在 schema.org 之后标记我们的 html，itemscope [http://schema.org/TravelAgency](http://schema.org/TravelAgency)看起来太笼统了

我们应该将哪个 Itemscope 用于出租车经纪人网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T09:07:17.093

您可以尝试使用： itemscope itemtype="http://schema.org/TravelAgency" 然后添加一个带有 itemprop="additionalType" href="http://www.productontology.org/id/Taxicab" 的链接

# matlab - 阅读 dxf Matlab，

> ID：13905669
> 
> 赞同：1
> 
> 时间：2012-12-16T21:30:43.160
> 
> 标签：matlab, autocad

我想在 matlab 中阅读 dxf。谁能给我推荐一些链接。DXF 包含 3d（**圆弧**、直线、折线）、圆、圆柱等。

我从 matlab 文件中心尝试了 f_LectDxf.m，但它只能读取圆弧的中心、开始和结束角度。

以下组代码适用于弧实体。

![在此处输入图像描述](../Images/d8effb5ff1876c2a418407fa41d5bc83.png)

***如何使用这些知识获得弧的起点和终点。***

附上很小的一部分（只是弧线）

![在此处输入图像描述](../Images/d8fa15c9d71a0f1dbf1e08ad24246e35.png).

# ruby-on-rails-3 - Rails 3 关联急切负载与相反关联

> ID：13905673
> 
> 赞同：2
> 
> 时间：2012-12-16T21:31:49.810
> 
> 标签：ruby-on-rails-3, associations, eager-loading

我有这样的关联模型：

```
class Batch
  has_many :logs

class Log
  belongs_to :batch 
```

我正在使用包含来加载带有日志的批次：

```
b = Batch.includes(:logs) 
```

哪个运行 2 按预期选择（批次和日志）。

然后我做

```
b.first.logs.first.batch 
```

这会触发对批次的另一个选择，即使它们已经实际加载。我想通过执行 include(:logs => :batch) 来“修复”它，但我仍然认为这里有问题，因为相同的批次被加载了两次。是什么赋予了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:38:58.203

You can fix this with the :inverse_of setting, which lets ActiveRecord know that the two associations are the inverse of each other.

```
class Batch
  has_many :logs, :inverse_of => :batch
end

class Log
  belongs_to :batch, :inverse_of => :logs
end 
```

# android - Apple OS 上的地图坐标

> ID：13905674
> 
> 赞同：-2
> 
> 时间：2012-12-16T21:31:54.877
> 
> 标签：android, ipad, dictionary, coordinates

> **可能重复：**
> [iOS 和 Android 上的 GPS 位置](https://stackoverflow.com/questions/11956423/gps-location-on-ios-and-android)

我正在为 iPad 创建一个应用程序，并希望在飞行过程中每 5 秒记录一次纬度、经度和高度坐标。

有人可以让我知道如何在苹果和安卓编程中实现这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T00:40:51.813

CoreLocation 是用于获取这些详细信息的 iOS 框架，它基于行进距离的概念，而不是“每 x 分钟定位一次”。所以你设置你的 CLLocationManager，告诉它你希望多久收到一次通知（即设置一个 100 米的距离过滤器），然后设置一个委托。当新的位置事件到达时，将调用委托回调。

这里有更多详细信息 - 前往并阅读 iOS 开发人员中心@developer.apple.com/ios 上提供的位置感知编程指南。

# jquery - 如何将图片base64发送到服务器

> ID：13905681
> 
> 赞同：1
> 
> 时间：2012-12-16T21:32:54.630
> 
> 标签：jquery, asp.net, ajax, base64, image-uploading

我使用 base64 编码来动态显示图像（通过选择图像）。

```
<img style="width: 412px;" src="data:image/gif;base64,R0lGODlhwAAAAXAAACH5BAEAAPwALA 
```

如何将图像发送到服务器？通过 $.ajax() 并且没有回发。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:39:41.700

```
$.ajax({
    type: 'POST', //or get
    url : 'urlToMyServer.aspx',
    data: { img : $('img').attr('src') }
}); 
```

如果 B64 真的不是很长，就按常规方式发送？

# css - CSS 图像大小调整（使用宽度和高度）在 Chrome 和 Firefox 中有所不同

> ID：13905682
> 
> 赞同：0
> 
> 时间：2012-12-16T21:32:54.803
> 
> 标签：css, google-chrome, firefox, resize, width

我有点困惑。我尝试使用 CSS 调整图像大小。在 Safari 和 Chrome 中，图像会调整大小，而在 IE 和 Firefox 中，它会保持原始大小但会裁剪。我需要更改什么才能在 FF 和 IE 中调整其大小？CSS 如下所示：

```
body {
    background-color:black;
    width: 100%;
    height: 100%;
}

#image1 {
    background-image: url(img/myimage.png);
    background-size: 100% 100%;
    position: absolute;
    width: 532px;
    height: 250px;
    top: 100px;
    left: 100px;
} 
```

和身体：

```
<body> <div id='image1'></div> </body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T08:07:43.177

我还在 Firefox (17.0.1 -- OSX) 中尝试过你的代码。

有和没有

```
<!DOCTYPE html> 
```

图像实际上按预期调整大小。

我猜你应该检查你的 CSS 中的拼写错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:33:16.213

尝试固定背景位置，然后将其添加到您的 html 中。

`<img src="img/myimage.png" alt="background image" id="image1" />`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T22:12:25.663

我认为您在中缺少 % 或 px

```
background-size: 100% 100; 
```

我已经在 Chrome、IE 和 Firefox 中测试[了这个 jsfiddle ，结果很好。](http://jsfiddle.net/Hh5Mn/)我还添加了 no-repeat，以防需要放大较小的图像。

# c# - 如何在 WPF 的 setter 中阻止赋值

> ID：13905690
> 
> 赞同：1
> 
> 时间：2012-12-16T21:34:19.890
> 
> 标签：c#, wpf, mvvm

例如，我有这样的属性：

```
private string foobar;

    public string Foobar
    {
        get
        {
            return this.foobar;
        }

        set
        {
            if (value != this.foobar)
            {
                // here I want to check if value is correct
                if(value != something)
                {
                   this.foobar = value;
                   this.NotifyPropertyChanged("Foobar");
                 }
                 else
                 {
                    value = null;
                    this.foobar = null;
                    this.NotifyPropertyChanged("Foobar");
                 }
            }
        }
    } 
```

属性已绑定 (MVVM) 到 Listview : `SelectedItem="{Binding Foobar, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}` 。

并且当用户更改列表中的值时，选定项会更改并在 setter 中设置值。我的代码是好的，当用户选择了不正确的值时，值和 foobar null 被分配。但在 WPF 中仍然显示选定的值。当我在 getter 中设置断点时，我可以看到它也返回 null。如何刷新 WPF 以清除列表视图中的选定值？它应该像一开始一样是空的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:51:41.960

您的代码的问题是您想要覆盖通过在 setter 方法中绑定分配的值。这将不起作用，因为控件不会在下一个属性更改时更新，原因很简单，它通过设置属性调用了它。要对您的值实施验证，请尝试[这种](http://msdn.microsoft.com/en-us/library/ms753962.aspx)内置机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T14:56:05.347

我更喜欢使用 IDataErrorInfo 并且不使用属性设置器逻辑。主要优点是您的视图模型和视图中的属性值始终相同，并且您的视图模型具有值是否正常的信息。

# sql - 从CJ Date的《SQL与关系理论》谈关系理论

> ID：13905691
> 
> 赞同：3
> 
> 时间：2012-12-16T21:34:26.933
> 
> 标签：sql, relational-algebra

我被困在“SQL 和关系理论”一书的某一点上，它与关系属性可以采用的类型有关。问题是这样的：

> *关系属性可以是任何类型的规则有例外，其中一个是如果关系 R 是 T 类型，则 R 的属性本身不能是 T 类型。*

为什么？是不是因为关系 R 将属于“关系 [名称]”类型，所以属性不能属于这种类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T02:06:28.990

这是因为定义这样的关系会立即创建无限递归，甚至在您尝试将任何数据放入其中之前。关系的标题必须是有限的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T05:12:42.480

考虑这样的事情：

```
create table address {
    id int,
    name varchar(20),
    details address -- the address relation has an attribute that is another of itself
} 
```

该*定义*将无限递归。

# php - 仅在分页的第一页中才重新加载页面

> ID：13905692
> 
> 赞同：0
> 
> 时间：2012-12-16T21:34:57.523
> 
> 标签：php, javascript, jquery, ajax

我有这个 jquery 代码，ajax，它可以帮助我做一些分页。

现在，我从一个只打印了一些信息的 php 文件中获取数据。

索引文件是这个：

```
<script type="text/javascript">
    $(document).ready(function(){
        function loading_show(){
            $('#loading').html("<img src='images/loading.gif'/>").fadeIn('fast');
        }
        function loading_hide(){
            $('#loading').fadeOut('fast');
        }                
        function loadData(page){
            loading_show();                    
            $.ajax
            ({
                type: "POST",
                url: "load_data.php",
                data: "page="+page,
                success: function(msg)
                {
                    $("#container").ajaxComplete(function(event, request, settings)
                    {
                        loading_hide();
                        $("#container").html(msg);
                    });
                }
            });
        }
        loadData(1);  // For first time page load default results
        $('#container .pagination li.active').live('click',function(){
            var page = $(this).attr('p');
            loadData(page);

        });           

        });
    });
</script> 
```

我想要做的是，我只想在第一页上重新加载页面，我的意思是，在分页中我们有类似的东西：

```
<- 1 2 3 4 5 6 7 -> 
```

只有当我在第一页时，我才想重新加载内容而不刷新。有人可以帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:48:32.690

Try

```
$('#container .pagination li.active').live('click',function(){
     var page = $(this).attr('p');
     if(page == 1)
         loadData(page);

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T02:06:34.863

```
$('#container .pagination li.active').live('click',function(){
     var page = $(this).attr('p');

     if(page === 1){
         setTimeout(function(){
             loadData(page);
     }, 2000);

    }
}); 
```

这是与已经发布的解决方案类似的解决方案，但在 2 秒后执行。将第二个参数（毫秒）更改为您想要的任何值。

# objective-c - Anagram 算法目标 C

> ID：13905698
> 
> 赞同：1
> 
> 时间：2012-12-16T21:35:57.680
> 
> 标签：objective-c, algorithm, anagram

我已经编写了以下代码来检查 anagram 想知道这是完美的吗？有没有更好的方法在目标 C 中实现相同的

```
-(BOOL) findAnagram :(NSString *) string1 :(NSString *) string2
{
    int len = string1.length;
    if (len != string2.length)
    {
        return false;
    }

    for (int i=0; i < len; i++)
    {
        int h = 0;
        int q = 0;
        for (int k = 0;  k < len ; k ++)
        {
            if ([string1 characterAtIndex:i] == [string1 characterAtIndex:k])
            {
                h++;
            }
            if ([string1 characterAtIndex:i] == [string2 characterAtIndex:k])
            {
                q++;
            }
        }

        if (h!=q)
        {
            return false;
        }
    }
    return TRUE;
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-16T21:58:23.310

O(n ^ 2) 算法的性能比你的更好，它是 O(n) 算法：

```
BOOL anagrams(NSString *a, NSString *b)
{
    if (a.length != b.length)
        return NO;

    NSCountedSet *aSet = [[NSCountedSet alloc] init];
    NSCountedSet *bSet = [[NSCountedSet alloc] init];

    for (int i = 0; i < a.length; i++)
    {
        [aSet addObject:@([a characterAtIndex:i])];
        [bSet addObject:@([b characterAtIndex:i])];
    }

    return [aSet isEqual:bSet];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:48:56.473

You want to know if two strings contain exactly the same characters? Easiest way would probably be to sort both of them and compare the sorted version.

Another way would be to count the number of appearances of each letter (how many As, how many Bs, and so forth), then compare those counts.

(Note: The second way is just a variation of the first one, it's one efficient way to sort a string)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T21:49:44.407

It looks fine to me. But the code style is slightly odd. I would write it like this:

```
- (BOOL)isStringAnagram:(NSString *)string1 ofString:(NSString *)string2 {
    int len = string1.length;
    if (len != string2.length) {
        return NO;
    }

    for (int i=0; i < len; i++) {
        int h = 0;
        int q = 0;
        for (int k = 0;  k < len; k++) {
            if ([string1 characterAtIndex:i] == [string1 characterAtIndex:k]) {
                h++;
            }
            if ([string1 characterAtIndex:i] == [string2 characterAtIndex:k]) {
                q++;
            }
        }

        if (h != q) {
            return NO;
        }
    }

    return YES;
} 
```

The main issue I have is with the method name. While it's possible to have parameters that have nothing before them in the name, it is not advisable. i.e. you had `findAnagram::` as the name whereas I've used `isStringAnagram:ofString:`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-03T09:03:43.967

这是对@zmbq 排序和比较建议的实现。

您应该考虑删除空格和不区分大小写的要求。

```
- (BOOL)isAnagram:(NSString *)leftString and:(NSString *)rightString {
  NSString *trimmedLeft = [[leftString stringByReplacingOccurrencesOfString:@" " withString:@""] lowercaseString];
  NSString *trimmedRight = [[rightString stringByReplacingOccurrencesOfString:@" " withString:@""] lowercaseString];
  return [[self stringToCharArraySorted:trimmedLeft] isEqual:[self stringToCharArraySorted:trimmedRight]];
}

- (NSArray *)stringToCharArraySorted:(NSString *)string {
  NSMutableArray *array = [[NSMutableArray alloc] init];
  for (int i = 0 ; i < string.length ; i++) {
    [array addObject:@([string characterAtIndex:i])];
  }
  return [[array sortedArrayUsingSelector:@selector(compare:)] copy];
} 
```

像这样称呼

```
BOOL isAnagram = [self isAnagram:@"A BC" and:@"cba"]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-25T16:25:15.947

磨坊算法的另一个运行：

```
- (BOOL) testForAnagramWithStrings:(NSString *)stringA andStringB: (NSString *)stringB{

    stringA = [stringA lowercaseString];

     stringB = [stringB lowercaseString];

     int counter = 0;

     for (int i=0; i< stringA.length; i++){

         for (int j=0; j<stringB.length;j++){

             if ([stringA characterAtIndex:i]==[stringB characterAtIndex:j]){

                 counter++;

             }

         }

     }

     if (counter!= stringA.length){

         return false;
     }

     return true;

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-13T13:02:42.203

检查以下检查 Anagram 字符串的方法。

```
-(BOOL)checkAnagramString:(NSString*)string1 WithAnotherString:(NSString*)string2{

  NSCountedSet *countSet1=[[NSCountedSet alloc]init];
  NSCountedSet *countSet2=[[NSCountedSet alloc]init];

  if (string1.length!=string2.length) {
    NSLog(@"NOT ANAGRAM String");
    return NO;
  }

  for (int i=0; i<string1.length; i++) {
      [countSet1 addObject:@([string1 characterAtIndex:i])];
      [countSet2 addObject:@([string2 characterAtIndex:i])];
  }

  if ([countSet1 isEqual:countSet2]) {
    NSLog(@"ANAGRAM String");
    return YES;
  } else {
    NSLog(@"NOT ANAGRAM String");
    return NO;
  }

} 
```

# jquery - 粘性导航不会在短页面上滚动

> ID：13905700
> 
> 赞同：3
> 
> 时间：2012-12-16T21:36:02.480
> 
> 标签：jquery, html, css

我正在为花店开发一个网站，目前正在测试和完善它。一个长期存在的问题是导航栏，它应该在用户滚动过去时粘在页面顶部。这适用于较长的页面，但在屏幕分辨率较小且导航“溢出”超过页面滚动末尾的短页面上不起作用 - 当导航使用 jQuery 和 position:fixed 时，页面跳转回用户滚动过去后的顶部。（例如参见[http://efbeta.nzrailphotos.co.nz/products/teddies/](http://efbeta.nzrailphotos.co.nz/products/teddies/)）。我该如何解决这个问题，以便：

*   当页面内容短于导航栏时，导航栏无法修复
*   导航栏在短页面上滚动

```
function sticky_relocate()
{
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top)
    $('nav').addClass('stick')
  else
    $('nav').removeClass('stick'); 
}
$(function()
{
  $(window).scroll(sticky_relocate);
  sticky_relocate();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:53:22.610

我认为名为 StickyJS 的 Jquery 插件可以帮助您：[http ://stickyjs.com](http://stickyjs.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:56:54.613

您的最小页面高度需要至少与完全展开的导航栏一样高。尝试将#container 样式设置为最小高度。

# matlab - 求解非线性方程

> ID：13905701
> 
> 赞同：1
> 
> 时间：2012-12-16T21:36:07.510
> 
> 标签：matlab, equation, equation-solving

我想在 MATLAB 中求解两个非线性方程，所以我做了以下操作：

我脚本的一部分

```
c=[A\u;A\v];
% parts of code are omitted.
x0=[1;1];
sol= fsolve(@myfunc,x0); 
```

`myfunc`功能如下

```
function F = myfunc(x)

  F=[ x(1)*c(1)+x(2)*c(2)+x(1)*x(2)*c(3)+c(4)-ii;

     x(1)*c(5)+x(2)*c(6)+x(1)*x(2)*c(7)+c(8)-jj];

end 
```

我有两个未知数`x(1)`和`x(2)`

我的问题是每次调用时如何将值（，，，`c`）`ii`传递`jj`给？`myfunc`

或如何克服此错误`Undefined function or method 'c' for input arguments of type 'double'.`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:50:37.120

编辑：之前的答案是虚假的，根本没有贡献。因此已被删除。这是正确的方法。

在您的主代码中创建一个系数向量`c,ii,jj`和一个虚拟函数句柄`f_d`

```
coeffs = [c,ii,jj];
f_d = @(x0) myfunc(x0,coeffs);      % f_d considers x0 as variables
sol = fsolve(f_d,x0); 
```

使您的函数`myfunc`能够接受 2 个变量，`x0`并且`coeffs`

```
function F = myfunc(x, coeffs)
c = coeffs(1:end-2);
ii = coeffs(end-1);
jj = coeffs(end);

F(1) = x(1)*c(1)+x(2)*c(2)+x(1)*x(2)*c(3)+c(4)-ii;
F(2) = x(1)*c(5)+x(2)*c(6)+x(1)*x(2)*c(7)+c(8)-jj; 
```

我认为这应该解决 x0(1) 和 x0(2)。

编辑：谢谢Eitan_T。上面已经进行了更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T06:56:44.023

如果函数句柄不是您想要的，我更喜欢另一种选择。

说我有这个功能：

```
function y = i_have_a_root( x, a )
    y = a*x^2;
end 
```

您可以通过如下调用来传递您的初始猜测`x`和值：`a``fsolve`

```
a = 5;
x0 = 0;
root = fsolve('i_have_a_root',x0,[],a); 
```

注意：`[]`保留给`fsolve`您可能想要使用的选项。有关参数的信息，请参阅[此处](http://www.mathworks.com/help/optim/ug/fsolve.html)`fsolve`文档中的第二次调用。`options`

# c++ - 抽象基类中的静态常量变量

> ID：13905704
> 
> 赞同：1
> 
> 时间：2012-12-16T21:37:01.593
> 
> 标签：c++, class, inheritance, abstract-class

我有一个抽象基类，它用于派生一些类。这些类的某些属性在所有类之间共享，并且这些属性应该是不可修改的。

为了在所有 10 个类之间共享一个变量，我将其设为静态。

```
class ABC{
public:
  static int *anArray;
  int index;
  static int tot_index;
  virtual void print()=0;
  ABC(){index=tot_index++;};
  virtual ~ABC(){};
}; 
```

这很好用， tot_index 将包含实例化的类的数量，并且索引是每个类的唯一标识符。

我遇到的问题是 *anArray 和派生类的数量是在运行时设置的，并且在实例化类之后我不想修改这些值。

我有点困惑：

1) 我应该在哪里设置 *anArray 值？只是在派生类的一些随机中？

2) 如果一个变量应该是不可修改的，那么我应该将它设置为 const。但是如果我不知道编译时的值是什么，我该如何将它设置为 const？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:21:56.603

有一些模式可以实现这一点，而不是使用静态变量。

最容易实现（尽管由于多种原因不是最好的）是将共享变量放在单例基类中（参考：GoF 单例模式）。

另一个更漂亮的解决方案可能是一些工厂模式，比如 GoF 抽象工厂。

编辑：另外，对于文档的评论，请参阅： http: [//www.parashift.com/c++-faq/static-init-order-on-first-use.html](http://www.parashift.com/c++-faq/static-init-order-on-first-use.html)

:)

# php - 加密和解密电子邮件地址PHP的最短方法

> ID：13905708
> 
> 赞同：0
> 
> 时间：2012-12-16T21:37:27.353
> 
> 标签：php

我正在寻找有关使用 PHP 加密和解密电子邮件地址的最佳方法的一些指导。

原因：

我在我的网站上设置了一个推荐脚本，它在 URL 中有一个 GET 变量，表示使用 base64_encode() 转换的电子邮件地址。我遇到的唯一问题是我得到了一个非常长的 URL 链接。不一定适合分享。我有没有更好的替代方法来生成更短的 URL 链接，而不是使用 base64_encode() 和 base64_decode()？

我得到了什么： http: [//www.domain.com/r/ ?r=dGhlam9yZGFuZ2FtZUBzYmNnbG9iYWwubmV0](http://www.domain.com/r/?r=dGhlam9yZGFuZ2FtZUBzYmNnbG9iYWwubmV0)

基本上，有没有更简单的方法来缩短没有数据库的 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:44:11.807

创建一个表电子邮件。

```
Create table emails(
id int auto_increment,
val varchar(260), -- email field
); 
```

现在将您的电子邮件放在此表中。并使用 id 作为推荐链接。所以会变成

```
http://www.domain.com/r/?r=3 
```

当你得到 时`$_GET['r']`，对其进行**清理**并从 db 获取相关的电子邮件。

# postgresql - PostgreSQL 将大型 csv 文件加载到表中的问题

> ID：13905712
> 
> 赞同：7
> 
> 时间：2012-12-16T21:37:52.700
> 
> 标签：postgresql, csv

在我的设置中，尝试将大型 csv 文件加载到表中时，PostgreSQL 9.2.2 似乎出错了。

csv 文件的大小约为 9GB

这是我用来进行批量加载的 SQL 语句：

```
copy chunksBase (chunkId, Id, chunk, chunkType) from path-to-csv.csv' delimiters ',' csv 
```

这是几分钟后我得到的错误：

```
pg.ProgrammingError: ERROR:  out of memory
DETAIL:  Cannot enlarge string buffer containing 1073723635 bytes by 65536 more bytes.
CONTEXT:  COPY chunksbase, line 47680536 
```

我认为缓冲区不能分配超过 1GB，这让我认为这可能是 postgresql.conf 问题。

这是 postgresql.conf 中未注释的行：

```
bash-3.2# cat postgresql.conf | perl -pe 's/^[ \t]*//' | grep -v '^#' | sed '/^$/d'
log_timezone = 'US/Central'
datestyle = 'iso, mdy'
timezone = 'US/Central'
lc_messages = 'en_US.UTF-8'         # locale for system error message
lc_monetary = 'en_US.UTF-8'         # locale for monetary formatting
lc_numeric = 'en_US.UTF-8'          # locale for number formatting
lc_time = 'en_US.UTF-8'             # locale for time formatting
default_text_search_config = 'pg_catalog.english'
default_statistics_target = 50 # pgtune wizard 2012-12-02
maintenance_work_mem = 768MB # pgtune wizard 2012-12-02
constraint_exclusion = on # pgtune wizard 2012-12-02
checkpoint_completion_target = 0.9 # pgtune wizard 2012-12-02
effective_cache_size = 9GB # pgtune wizard 2012-12-02
work_mem = 72MB # pgtune wizard 2012-12-02
wal_buffers = 8MB # pgtune wizard 2012-12-02
checkpoint_segments = 16 # pgtune wizard 2012-12-02
shared_buffers = 3GB # pgtune wizard 2012-12-02
max_connections = 80 # pgtune wizard 2012-12-02
bash-3.2# 
```

没有明确将缓冲区设置为 1GB。

这里发生了什么？即使解决方案是增加 postgresql.conf 中的缓冲区，为什么 postgres 似乎尝试在单个复制调用上将整个 csv 文件批量加载到 ram 中？有人会认为加载大型 csv 文件是一项常见任务；我不能成为第一个遇到这个问题的人；所以我想postgres会处理分块的大容量负载，这样一开始就永远不会达到缓冲区限制。

作为一种解决方法，我将 csv 拆分为较小的文件，然后为每个文件调用 copy。这似乎工作正常。但这并不是一个特别令人满意的解决方案，因为现在我必须维护要加载到 postgres 中的每个大型 csv 的拆分版本。必须有一种更合适的方法将大型 csv 文件批量加载到 postgres 中。

EDIT1：我正在确保 csv 文件没有以任何方式出现格式错误。我通过尝试将所有拆分的 csv 文件加载到 postgres 中来做到这一点。如果都可以加载，那么这表明这里的问题不太可能是由于 csv 文件格式错误。我已经发现了一些问题。尚不确定这些问题是否会在尝试加载大型 csv 时导致字符串缓冲区错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-17T04:46:38.507

原来是一个格式错误的 csv 文件。

我将大 csv 分成更小的块（每个块有 100 万行）并开始将每个块加载到 postgres 中。

我开始收到更多信息错误：

```
pg.ProgrammingError: ERROR:  invalid byte sequence for encoding "UTF8": 0x00
CONTEXT:  COPY chunksbase, line 15320779

pg.ProgrammingError: ERROR:  invalid byte sequence for encoding "UTF8": 0xe9 0xae 0x22
CONTEXT:  COPY chunksbase, line 369513

pg.ProgrammingError: ERROR:  invalid byte sequence for encoding "UTF8": 0xed 0xaf 0x80
CONTEXT:  COPY chunksbase, line 16602 
```

在数亿行中，共有 5 行带有无效的 utf8 字节序列。删除这些行后，9GB 的大 csv 加载得很好。

最初加载大文件时得到无效的字节序列错误会很好。但至少一旦我开始隔离问题，它们就会出现。

请注意，最初加载大文件时错误中提到的行号与加载较小的 csv 子集文件时发现的编码错误无关。初始行号是文件中恰好发生 1GB 数据的点，因此它与 1GB 缓冲区分配错误有关。但是，那个错误与真正的问题无关......

# arrays - 这是实现 NSImage 数组的适当方式吗？

> ID：13905716
> 
> 赞同：0
> 
> 时间：2012-12-16T21:38:33.840
> 
> 标签：arrays, cocoa, view, nsview, nsimage

我有一系列想在应用程序中使用的图像。我想要做的是将它们存储在 NSArray 中，以便在 drawRect: 函数中轻松识别。

我创建了一个 .plist 文件，其中详细说明了一个 NSDictionary，其中的键只是升序整数值，以及对应于图像文件名的值。这允许我遍历字典并将一系列 NSImage 对象添加到数组中。我在这里使用了一个 for 循环，因为顺序很重要，并且快速枚举并不能保证从字典中读取时的执行顺序！

目前我正在做以下事情：（这是在 NSView 的子类中）

```
@property (strong) NSDictionary *imageNamesDict;
@property (strong) NSMutableArray *imageArray;
...

// in init method:

    _imageNamesDict = [[NSDictionary alloc] initWithContentsOfFile:@"imageNames.plist"];

    _imageArray = [[NSMutableArray alloc] initWithCapacity:[_imageNamesDict count]];

    for (int i=0; i<_imageNamesDict.count; i++) {
        NSString *key = [NSString stringWithFormat:@"%d", i];
        [_imageArray addObject:[NSImage imageNamed:[_imageNamesDict objectForKey:key]];
    }

// When I want to draw a particular image in drawRect:

    int imageToDraw = 1;

    // Get a pointer to the necessary image:
    NSImage *theImage = [_imageArray objectAtIndex:imageToDraw];

   // Draw the image
    NSRect theRect = NSMakeRect (100,100, 0, 0);
    [theImage drawInRect:theRect fromRect:NSZeroRect operation:NSCompositeCopy fraction:1.0]; 
```

这一切似乎都可以正常工作，但有一个怪癖。我注意到在绘制显示时会出现少量延迟，但仅在第一次绘制新图像时才会出现。一旦每个图像至少被看到一次，我就可以重新绘制任何想要的图像，而不会出现任何延迟。

是我没有正确加载图像，还是有什么方法可以在我创建要添加到 for 循环的对象时预先缓存每个图像？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T23:07:53.023

假设您已经克服了评论中指出的“... NSMutableDictionary 而不是 NSMutableArray ...”问题，那么您正在正确加载图像。

您所描述的滞后是因为`[NSImage imageNamed: ]`没有完成绘制图像所需的**所有**工作，所以这发生在您的第一次绘制时。

当您将图像添加到数组时，您可以通过将图像绘制到屏幕外缓冲区来消除滞后，例如：

```
// Create an offscreen buffer to draw in.
newImage = [[NSImage alloc] initWithSize:imageRect.size];
[newImage lockFocus];

for (int i=0; i<_imageNamesDict.count; i++) {
    NSString *key = [NSString stringWithFormat:@"%d", i];
    NSImage *theImage = [NSImage imageNamed:[_imageNamesDict objectForKey:key]];
    [_imageArray addObject: theImage];
    [theImage drawInRect:imageRect fromRect:NSZeroRect operation:NSCompositeCopy fraction:1.0];
}
[newImage unlockFocus];
[newImage release]; 
```

# c++ - c ++最大数字类型

> ID：13905717
> 
> 赞同：2
> 
> 时间：2012-12-16T21:38:35.233
> 
> 标签：c++

> **可能的重复：**
> [int、long 等的大小](https://stackoverflow.com/questions/589575/size-of-int-long-etc)
> [`long` 是否保证至少为 32 位？](https://stackoverflow.com/questions/4329777/is-long-guaranteed-to-be-at-least-32-bits)

我想找出我的计算机的每种数据类型的最大值。代码是：

```
int main() {
    using namespace std;
    cout << numeric_limits<int>::max() << endl;
    cout << numeric_limits<long>::max() << endl;
    cout << numeric_limits<long long>::max() << endl;

    return 0;
} 
```

打印：

```
2147483647
2147483647
9223372036854775807 
```

问题1：为什么`int`和`long`一样？

问题2：以上输出来自64位的VS2010。我的 c++ 程序是否以 64 位运行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-16T21:45:30.560

> 问题1：为什么int和long是一样的？

由于各种原因（方便），机器架构支持的整数大小往往是 2 的幂。大多数现代处理器本机可以处理 8、16、32 和 64 位整数。但是，有五种常用的整数类型：`char`、`short`、`int`、`long`和`long long`。所以它们中的两个必须具有相同的大小。

*   在大多数 16 位平台上，`int`并且`short`都是 16 位。

*   在大多数 32 位平台上，`int`并且`long`都是 32 位的。

*   在大多数 64 位平台上，`long`并且`long long`都是 64 位的。有一个例外...

> 问题2：以上输出来自64位的VS2010。我的 c++ 程序是否以 64 位运行？

从这些数据中无法判断。Windows 是一个平台，其中32 位`long`和`int`64 位程序具有相同的大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T21:44:06.330

它们的输出相同，因为在 Visual Studio 中，两者`int`都是`long`有符号的 32 位整数。无论您是构建 64 位还是 32 位二进制文​​件，这都是正确的（Windows 64 位遵循[LLP64 模型](http://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models)）

由于 Visual Studio 上 32 位和 64 位之间的大小`int`并`long`没有变化，因此无法从您提供的数据中判断您正在构建哪个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T21:49:10.567

The maximum value of a given type is compiler dependant. The C++ standard does not state anything about a long having to be a specific number of bits etc.

However what is does state is that:

```
1 = sizeof(char)<=sizeof(short)<=sizeof(int)<=sizeof(long)<=sizeof(long long) 
```

If you are looking to use a specific sized integer, I would suggest including "inttypes.h" and using the int_8t, int16_t, int32_t, int64_t, etc...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T22:33:47.920

根据 C++ 标准，long 至少需要与 int 一样大。这意味着 long 也可以与 int 具有相同的大小，这意味着 long 和 int 相同类型（有符号或无符号）的最小值和最大值可以相等。

更多信息（不仅仅是关于 long 和 int，还有其他类型）：[https ://stackoverflow.com/a/271132/13760](https://stackoverflow.com/a/271132/13760)

这里有一些更有趣的读物：[`long` 是否保证至少为 32 位？](https://stackoverflow.com/questions/4329777/is-long-guaranteed-to-be-at-least-32-bits)

就问题 2 而言，您需要检查您的项目设置，看看您是在构建 Win32 还是 x64 可执行文件。

# css - 设置自定义引导按钮颜色

> ID：13905718
> 
> 赞同：1
> 
> 时间：2012-12-16T21:38:46.057
> 
> 标签：css, twitter-bootstrap, less

因此在 variables.less 中定义了 Bootstrap 按钮颜色：

```
@btnPrimaryBackground:              @linkColor;
@btnPrimaryBackgroundHighlight:     spin(@btnPrimaryBackground, 20%);

@btnInfoBackground:                 #5bc0de;
@btnInfoBackgroundHighlight:        #2f96b4;

@btnSuccessBackground:              #62c462;
@btnSuccessBackgroundHighlight:     #51a351;

@btnWarningBackground:              lighten(@orange, 15%);
@btnWarningBackgroundHighlight:     @orange;

@btnDangerBackground:               #ee5f5b;
@btnDangerBackgroundHighlight:      #bd362f;

@btnInverseBackground:              #444;
@btnInverseBackgroundHighlight:     @grayDarker; 
```

*背景*和*backgroundHighlight*的十六进制代码中是否存在一些逻辑（即十六进制代码之间的特定颜色差异），或者它们是否是根据某人“看起来不错”的设计观点任意设置的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:43:58.460

您可以看到它是专门设计的。但是您可以使用具有 5% 或 10% 值的 lighten() 或 darken() mixins 来设置高光。但是同样的方式你可以用一种颜色制作整个按钮:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-26T23:44:01.747

我从 Bootstrap 的源代码中获取了相关的 LESS 代码来生成一个`btn-purple`类。渐变等与默认按钮非常相似。您只需要更改`@backgroundColor`并`@backgroundColorHighlight`在下面的 LESS 代码中更改颜色。

```
// Gradient Bar Colors for buttons and alerts
.gradientBar(@primaryColor, @secondaryColor, @textColor: #fff, @textShadow: 0 -1px 0 rgba(0,0,0,.25)) {
    color: @textColor;
    text-shadow: @textShadow;
    #gradient > .vertical(@primaryColor, @secondaryColor);
    border-color: @secondaryColor @secondaryColor darken(@secondaryColor, 15%);
    border-color: rgba(0,0,0,.1) rgba(0,0,0,.1) fadein(rgba(0,0,0,.1), 15%);
}

// Gradients
#gradient {
    .horizontal(@startColor: #555, @endColor: #333) {
        background-color: @endColor;
        background-image: -moz-linear-gradient(left, @startColor, @endColor); // FF 3.6+
        background-image: -webkit-gradient(linear, 0 0, 100% 0, from(@startColor), to(@endColor)); // Safari 4+, Chrome 2+
        background-image: -webkit-linear-gradient(left, @startColor, @endColor); // Safari 5.1+, Chrome 10+
        background-image: -o-linear-gradient(left, @startColor, @endColor); // Opera 11.10
        background-image: linear-gradient(to right, @startColor, @endColor); // Standard, IE10
        background-repeat: repeat-x;
        filter: e(%("progid:DXImageTransform.Microsoft.gradient(startColorstr='%d', endColorstr='%d', GradientType=1)",argb(@startColor),argb(@endColor))); // IE9 and down
    }
    .vertical(@startColor: #555, @endColor: #333) {
        background-color: mix(@startColor, @endColor, 60%);
        background-image: -moz-linear-gradient(top, @startColor, @endColor); // FF 3.6+
        background-image: -webkit-gradient(linear, 0 0, 0 100%, from(@startColor), to(@endColor)); // Safari 4+, Chrome 2+
        background-image: -webkit-linear-gradient(top, @startColor, @endColor); // Safari 5.1+, Chrome 10+
        background-image: -o-linear-gradient(top, @startColor, @endColor); // Opera 11.10
        background-image: linear-gradient(to bottom, @startColor, @endColor); // Standard, IE10
        background-repeat: repeat-x;
        filter: e(%("progid:DXImageTransform.Microsoft.gradient(startColorstr='%d', endColorstr='%d', GradientType=0)",argb(@startColor),argb(@endColor))); // IE9 and down
    }
    .directional(@startColor: #555, @endColor: #333, @deg: 45deg) {
        background-color: @endColor;
        background-repeat: repeat-x;
        background-image: -moz-linear-gradient(@deg, @startColor, @endColor); // FF 3.6+
        background-image: -webkit-linear-gradient(@deg, @startColor, @endColor); // Safari 5.1+, Chrome 10+
        background-image: -o-linear-gradient(@deg, @startColor, @endColor); // Opera 11.10
        background-image: linear-gradient(@deg, @startColor, @endColor); // Standard, IE10
    }
    .horizontal-three-colors(@startColor: #00b3ee, @midColor: #7a43b6, @colorStop: 50%, @endColor: #c3325f) {
        background-color: mix(@midColor, @endColor, 80%);
        background-image: -webkit-gradient(left, linear, 0 0, 0 100%, from(@startColor), color-stop(@colorStop, @midColor), to(@endColor));
        background-image: -webkit-linear-gradient(left, @startColor, @midColor @colorStop, @endColor);
        background-image: -moz-linear-gradient(left, @startColor, @midColor @colorStop, @endColor);
        background-image: -o-linear-gradient(left, @startColor, @midColor @colorStop, @endColor);
        background-image: linear-gradient(to right, @startColor, @midColor @colorStop, @endColor);
        background-repeat: no-repeat;
        filter: e(%("progid:DXImageTransform.Microsoft.gradient(startColorstr='%d', endColorstr='%d', GradientType=0)",argb(@startColor),argb(@endColor))); // IE9 and down, gets no color-stop at all for proper fallback
    }

    .vertical-three-colors(@startColor: #00b3ee, @midColor: #7a43b6, @colorStop: 50%, @endColor: #c3325f) {
        background-color: mix(@midColor, @endColor, 80%);
        background-image: -webkit-gradient(linear, 0 0, 0 100%, from(@startColor), color-stop(@colorStop, @midColor), to(@endColor));
        background-image: -webkit-linear-gradient(@startColor, @midColor @colorStop, @endColor);
        background-image: -moz-linear-gradient(top, @startColor, @midColor @colorStop, @endColor);
        background-image: -o-linear-gradient(@startColor, @midColor @colorStop, @endColor);
        background-image: linear-gradient(@startColor, @midColor @colorStop, @endColor);
        background-repeat: no-repeat;
        filter: e(%("progid:DXImageTransform.Microsoft.gradient(startColorstr='%d', endColorstr='%d', GradientType=0)",argb(@startColor),argb(@endColor))); // IE9 and down, gets no color-stop at all for proper fallback
    }
    .radial(@innerColor: #555, @outerColor: #333) {
        background-color: @outerColor;
        background-image: -webkit-gradient(radial, center center, 0, center center, 460, from(@innerColor), to(@outerColor));
        background-image: -webkit-radial-gradient(circle, @innerColor, @outerColor);
        background-image: -moz-radial-gradient(circle, @innerColor, @outerColor);
        background-image: -o-radial-gradient(circle, @innerColor, @outerColor);
        background-repeat: no-repeat;
    }
    .striped(@color: #555, @angle: 45deg) {
        background-color: @color;
        background-image: -webkit-gradient(linear, 0 100%, 100% 0, color-stop(.25, rgba(255,255,255,.15)), color-stop(.25, transparent), color-stop(.5, transparent), color-stop(.5, rgba(255,255,255,.15)), color-stop(.75, rgba(255,255,255,.15)), color-stop(.75, transparent), to(transparent));
        background-image: -webkit-linear-gradient(@angle, rgba(255,255,255,.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.15) 50%, rgba(255,255,255,.15) 75%, transparent 75%, transparent);
        background-image: -moz-linear-gradient(@angle, rgba(255,255,255,.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.15) 50%, rgba(255,255,255,.15) 75%, transparent 75%, transparent);
        background-image: -o-linear-gradient(@angle, rgba(255,255,255,.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.15) 50%, rgba(255,255,255,.15) 75%, transparent 75%, transparent);
        background-image: linear-gradient(@angle, rgba(255,255,255,.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.15) 50%, rgba(255,255,255,.15) 75%, transparent 75%, transparent);
    }
}
// Reset filters for IE
.reset-filter() {
    filter: e(%("progid:DXImageTransform.Microsoft.gradient(enabled = false)"));
}

.buttonBackground(@startColor, @endColor, @textColor: #fff, @textShadow: 0 -1px 0 rgba(0,0,0,.25)) {
    // gradientBar will set the background to a pleasing blend of these, to support IE<=9
    .gradientBar(@startColor, @endColor, @textColor, @textShadow);
    *background-color: @endColor; /* Darken IE7 buttons by default so they stand out more given they won't have borders */
    .reset-filter();

      // in these cases the gradient won't cover the background, so we override
    &:hover, &:focus, &:active, &.active, &.disabled, &[disabled] {
        color: @textColor;
        background-color: @endColor;
        *background-color: darken(@endColor, 5%);
        background-position: 0 -15px;
    }

    // IE 7 + 8 can't handle box-shadow to show active, so we darken a bit ourselves
    &:active,
    &.active {
        background-color: darken(@endColor, 10%) e("\9");
    }
}

// Provide *some* extra contrast for those who can get it
.btn-purple.active {
    color: rgba(255,255,255,.75);
}

// Set the backgrounds
// -------------------------
@backgroundColor: lighten(#7a43b6, 10%);
@backgroundColorHighlight: darken(#7a43b6, 5%);
.btn-purple {
    .buttonBackground(@backgroundColor, @backgroundColorHighlight);
} 
```

# c# - UDP 消息被防火墙阻止，尽管端口异常

> ID：13905724
> 
> 赞同：0
> 
> 时间：2012-12-16T21:39:47.597
> 
> 标签：c#, .net, sockets, udp, firewall

我在基于 C# .NET 套接字的应用程序的发送端运行了这段代码：

```
const int port = 1110;
System.Net.Sockets.UdpClient udp = null;

udp = new System.Net.Sockets.UdpClient(host, port);
...
byte[] data = m.Serialize();
udp.Send(data, data.Length); 
```

我在接收端运行了这段代码：

```
System.Net.IPEndPoint replyAddress = new System.Net.IPEndPoint(
    System.Net.IPAddress.Any, port);
while ((udp != null) && (udp.Available > 0))
{
   ...
} 
```

**我在 UDP 端口 1110 的接收端添加了一个例外（Windows 7）防火墙。但是，除非**我完全禁用防火墙，否则接收端代码永远不会进入 while 循环。为什么1110端口异常不生效？使用 Microsoft 网络监视器，我可以看到试图进入端口 1110 的消息，其描述如下`UDP:SrcPort = 1082, DstPort = 1110, Length = 11`（我认为网络监视器会看到本地网络上的所有消息，而不仅仅是那些通过防火墙并发往本地系统的消息），但是除非我完全禁用防火墙，否则我的应用程序永远不会收到它们。

我怎样才能弄清楚这里发生了什么或修复它？我可以在循环内设置断点，让对方发送数据，当我禁用防火墙的那一刻，我命中了断点，所以我知道流量可以通过，但是防火墙的某些东西阻止了它。我的防火墙异常如下所示：

## 一般的

*   启用：真
*   行动：允许连接

## 计划和服务

*   所有满足指定条件的程序
*   适用于所有计划和服务

## 电脑

*   （未选中且为空）仅允许来自这些计算机的连接
*   （未选中且为空）跳过此规则以获取来自这些计算机的连接

## 协议和端口

*   协议类型：UDP
*   协议编号：17
*   本地端口：特定端口
*   端口：1110
*   远程端口：所有端口

## 范围

*   本地IP地址：任何IP地址
*   远程IP地址：任何IP地址

## 先进的

*   指定适用此规则的配置文件：域、私有、公共（全部选中）
*   边遍历：允许边遍历

## 用户

*   授权用户：（未选中且为空）仅允许来自这些用户的连接
*   例外：（未选中且为空）为来自这些用户的连接跳过此规则

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:49:01.123

After further searching of the firewall rules I discovered there was another rule to explicitly block the receiving program based on its path. When Windows pops up a message about a program wanting network access, I guess you have to be careful about how you respond. I intended to temporarily disallow access or cancel the operation (I hadn't intended to run the program yet at the time). But once my response was taken, Windows added a rule to permanently block all access by that program. Deleting those rules allowed the UDP communication to get through the firewall as expected.

# ruby - 如何使用 Ruby 脚本避免 EOFError？

> ID：13905728
> 
> 赞同：0
> 
> 时间：2012-12-16T21:40:38.473
> 
> 标签：ruby, file-io, io, append

我有一个 Ruby 脚本 (1.9.2p290)，我试图在其中调用多个 URL，然后将这些 URL 中的信息附加到文件中。问题是我不断收到文件结束错误 - EOFError。我正在尝试做的一个例子是：

```
require "open-uri"
proxy_uri = URI.parse("http://IP:PORT")
somefile = File.open("outputlist.txt", 'a')

(1..100).each do |num|
  page = open('SOMEURL' + num, :proxy => proxy_uri).read
  pattern = "<img"   
  tags = page.scan(pattern)
  output << tags.length
end
somefile.puts output
somefile.close 
```

我不知道为什么我不断收到此文件结尾错误，或者我如何避免收到该错误。我认为这可能与我正在调用的 URL 有关（基于此处的一些对话：[What is an EOFError in Ruby file I/O?](https://stackoverflow.com/questions/1272394/what-is-an-eoferror-in-ruby-file-o)），但我不确定为什么这会影响 I/O或导致文件结束错误。

关于我在这里可能做错了什么或如何让它发挥作用的任何想法？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T02:20:38.597

您编写文件的方式不是惯用的 Ruby。这应该会更好：

```
(1..100).each do |num|
  page = open('SOMEURL' + num, :proxy => proxy_uri).read
  pattern = "<img"   
  tags = page.scan(pattern)
  output << tags.length
end

File.open("outputlist.txt", 'a') do |fo|
  fo.puts output
end 
```

我怀疑该文件已被关闭，因为它已被打开，然后在处理 100 页时未写入。如果这需要一段时间，我可以理解为什么他们会关闭它以避免应用程序用完所有文件句柄。以 Ruby 方式编写它会在写入后立即自动关闭文件，避免人为地保持句柄打开。

其次，与其使用简单的模式匹配来尝试定位图像标签，不如使用真正的 HTML 解析器。处理速度几乎没有差异，但可能更准确。

代替：

```
page = open('SOMEURL' + num, :proxy => proxy_uri).read
pattern = "<img"   
tags = page.scan(pattern)
output << tags.length 
```

和：

```
require 'nokogiri'

doc = Nokogiri::HTML(open('SOMEURL' + num, :proxy => proxy_uri))
output << doc.search('img').size 
```

# python - 如何在 Django 中建模这种关系？

> ID：13905731
> 
> 赞同：0
> 
> 时间：2012-12-16T21:41:12.817
> 
> 标签：python, django

我正在尝试建立一个模型，并且正在努力解决如何处理特定关系。有两个对象；人，带有姓名、电子邮件地址等，以及运动，带有姓名、位置等。

我拥有的关系是将玩家映射到运动的单独对象。有一个额外的字段用于特定于这项运动的球员信息。我想有另一个关系，指定一个（可选的）人，它是一项运动的球员的代理。

代理将使得指定的人能够充当玩家（可能在有限的时间内）。例如，假设玩家 A 正在管理 Soccer，并且要去度假两周。他们希望一个人代表他们行事，发送通知，通知其他玩家游戏等。

在 SQL 中，我有一个包含 a `player_id`、 a`sport_id`和另一个`player_id`字段的表，这些字段可能为 null（以及到期日期和其他字段）。

但是，我似乎无法弄清楚如何在 Django 模型中指定它。这是我到目前为止所拥有的：

```
"""Indicates people who are registered for a type of event.

They can have a unique nickname for each event, if desired.
In addition, they can select a proxy for them, who can act in
thier behalf for this event."""

nickname = models.CharField(max_length=30)
event_type = models.ForeignKey(EventType, related_name='+')
person = models.ForeignKey(Person, related_name='+')
proxy = models.OneToOneField(Person, related_name='+') # ?????
proxy_expires = models.DateField(null=True, blank=True) 
```

这似乎使代理成为必填字段，这不是我想要的。关于我如何使用代理的约束进行建模的任何建议都是可选的，每人每项运动一个代理。

谢谢！

# c# - 如何获取选定的行 ID 并将其用于 LINQ 中的删除查询？

> ID：13905732
> 
> 赞同：1
> 
> 时间：2012-12-16T21:41:15.433
> 
> 标签：c#, linq

我在 DataGridView 中有数据，我想通过选择从中删除一行。我在保存删除查询的表单上有一个按钮 DELETE

`var note = (from n in dataCont.Past_Notes where n.ID == ? select n).First();`

如果我在代码中手动指定一个 ID，它会完美运行。（问号在哪里）

但我不想这样。如何获取所选行的索引，然后删除该行？

```
 private void button2_Click(object sender, EventArgs e)
 {
     Past_Sticky_NotesDataContext dataCont = new Past_Sticky_NotesDataContext();

     var note = (from n in dataCont.Past_Notes
                 where n.ID == ?
                 select n).First();

     dataCont.Past_Notes.DeleteOnSubmit(note);
     dataCont.SubmitChanges();
 } 
```

我*必须*使用 LINQ 查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:48:43.653

You need to Set `DataGridView.MultiSelect=false` and `DataGridView.SelectionMode = FullRowSelect.` then `your_dataGridView_name.SelectedRows[0]` - this will return selected row. Then you get value of id cell in your row `selectedRow.Cells[your_id_index]`. And use it in LINQ query
**Edit**
Or you can use another property to get your selectedRow index `datagridview.CurrentCell.RowIndex`

# android - android sherlock actionbar menu 选中的带有下划线的菜单项，颜色变化

> ID：13905737
> 
> 赞同：2
> 
> 时间：2012-12-16T21:41:58.277
> 
> 标签：android, menu

我正在使用 ActionBarSherlock，我有如图所示的 ActionBar：

![在此处输入图像描述](../Images/ae1cd1cef61c0948af5f00d17fef71a4.png)

我想将蓝色更改为绿色，并且我希望所选的菜单项带有下划线（如图所示）。

我的 main_menu.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
<item
    android:id="@+id/item0"
    android:showAsAction="always"
    android:title="@string/menu_item0">
</item>
<item
    android:id="@+id/item1"
    android:showAsAction="always"
    android:title="@string/menu_item1">
</item>
<item
    android:id="@+id/item2"
    android:showAsAction="always"
    android:title="@string/menu_item2">
</item>
<item
    android:id="@+id/action_overflow"
    android:icon="@drawable/ic_action_overflow"
    android:showAsAction="always">
    <menu>
        <item android:id="@+id/contact" android:title="@string/submenu_0"/>
        <item android:id="@+id/info" android:title="@string/submenu_1"/>
        <item android:id="@+id/exit" android:title="@string/submenu_2"/>
    </menu>
</item>
</menu> 
```

我该怎么做？在哪个文件中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T17:35:49.583

不确定您是否仍然需要帮助，但要更改操作栏 sherlock (abs) 中操作栏上的下划线，您只需将操作栏的背景替换为具有可拉伸顶部部分和底部的颜色（如果您在 abs 示例代码中搜索“ad_tab_unselected_holo.png”，您可以使用它并更改图像中的颜色）。

然后，您需要添加此 png 并将以下内容添加到您的 style.xml 中（请注意，我们正在更改 android:background 和 background 以实现向后兼容性）。

```
<style name="CustomTheme" parent="Theme.Sherlock">    
    <item name="android:actionBarStyle">@style/Widget.Styled.ActionBar</item>
</style>

<style name="Widget.Styled.ActionBar" parent="Widget.Sherlock.Light.ActionBar">
    <item name="android:background">@drawable/ad_tab_unselected_holo</item>
    <item name="background">@drawable/ad_tab_unselected_holo</item>
</style> 
```

然后只需将清单中的这种样式应用于您的活动，如下所示；

```
<activity
   android:label="@string/an_activity"
   android:name="com.sample.TestActivity"            
   android:theme="@style/CustomTheme"/> 
```

# python - 从类定义中的列表理解访问类变量

> ID：13905741
> 
> 赞同：216
> 
> 时间：2012-12-16T21:42:22.617
> 
> 标签：python, python-3.x, scope, list-comprehension, python-internals

您如何从类定义中的列表理解访问其他类变量？以下在 Python 2 中有效，但在 Python 3 中失败：

```
class Foo:
    x = 5
    y = [x for i in range(1)] 
```

Python 3.2 给出了错误：

```
NameError: global name 'x' is not defined 
```

尝试`Foo.x`也不行。关于如何在 Python 3 中执行此操作的任何想法？

一个稍微复杂的激励示例：

```
from collections import namedtuple
class StateDatabase:
    State = namedtuple('State', ['name', 'capital'])
    db = [State(*args) for args in [
        ['Alabama', 'Montgomery'],
        ['Alaska', 'Juneau'],
        # ...
    ]] 
```

在这个例子中，`apply()`这本来是一个不错的解决方法，但遗憾的是它已从 Python 3 中删除。

* * *

## 回答 #1

> 赞同：306
> 
> 时间：2012-12-17T12:11:56.840

*类范围和列表、集合或字典推导以及生成器表达式不混合。*

## 为什么；或者，关于这个的官方说法

在 Python 3 中，列表推导式被赋予了它们自己的适当范围（局部命名空间），以防止它们的局部变量溢出到周围的范围内（请参阅[列表推导式即使在推导范围后重新绑定名称。对吗？](https://stackoverflow.com/q/4198906)）。当在模块或函数中使用这样的列表推导时，这很棒，但在类中，作用域*有点奇怪*。

这记录在[pep 227](http://www.python.org/dev/peps/pep-0227/)中：

> 类范围内的名称不可访问。名称在最里面的封闭函数范围内解析。如果类定义出现在嵌套范围链中，则解析过程会跳过类定义。

并在[`class`复合语句文档](http://docs.python.org/3/reference/compound_stmts.html#class-definitions)中：

> 然后使用新创建的本地名称空间和原始全局名称空间在新的执行框架中执行该类的套件（请参阅[*命名和绑定部分）。*](http://docs.python.org/3/reference/executionmodel.html#naming)（通常，套件只包含函数定义。）当类的套件完成执行时，**它的执行帧被丢弃，但它的本地命名空间被保存**。[[4]](http://docs.python.org/3/reference/compound_stmts.html#id8)然后使用基类的继承列表和属性字典的保存的本地名称空间创建一个类对象。

强调我的；执行框架是临时范围。

因为作用域被重新用作类对象的属性，所以允许它用作非局部作用域也会导致未定义的行为；`x`例如，如果一个被称为嵌套范围变量的类方法也进行操作，会发生什么情况`Foo.x`？更重要的是，这对 的子类意味着什么`Foo`？Python*必须*以不同的方式对待类范围，因为它与函数范围非常不同。

最后但同样重要的是，执行模型文档中链接的[命名和绑定](http://docs.python.org/3/reference/executionmodel.html#naming)部分明确提到了类范围：

> 类块中定义的名称范围仅限于类块；它没有扩展到方法的代码块——这包括理解和生成器表达式，因为它们是使用函数范围实现的。这意味着以下将失败：
> 
> ```
> class A:
>      a = 42
>      b = list(a + i for i in range(10)) 
> ```

因此，总结一下：您不能从包含在该范围内的函数、列表推导或生成器表达式访问类范围；他们的行为就好像那个范围不存在一样。在 Python 2 中，列表推导式是使用快捷方式实现的，但在 Python 3 中，它们有自己的函数范围（因为它们一直都应该拥有），因此您的示例中断了。无论 Python 版本如何，其他理解类型都有自己的范围，因此在 Python 2 中使用 set 或 dict 理解的类似示例会中断。

```
# Same error, in Python 2 or 3
y = {x: x for i in range(1)} 
```

## （小）例外；或者，为什么一部分仍然*可以*工作

无论 Python 版本如何，理解或生成器表达式的一部分都在周围范围内执行。那将是最外层可迭代的表达式。在您的示例中，它是`range(1)`：

```
y = [x for i in range(1)]
#               ^^^^^^^^ 
```

因此，`x`在该表达式中使用不会引发错误：

```
# Runs fine
y = [i for i in range(x)] 
```

这仅适用于最外层的可迭代；如果一个理解有多个`for`子句，则内部子句的迭代`for`在理解的范围内进行评估：

```
# NameError
y = [i for i in range(1) for j in range(x)]
#      ^^^^^^^^^^^^^^^^^ -----------------
#      outer loop        inner, nested loop 
```

做出此设计决策是为了在创建生成器表达式的最外层可迭代对象时抛出错误，或者当最外层可迭代对象结果不是可迭代时，在 genexp 创建时而不是迭代时抛出错误。理解共享此行为以保持一致性。

## 在引擎盖下看；或者，比你想要的更详细

[`dis`您可以使用模块](http://docs.python.org/3/library/dis.html)看到这一切。我在以下示例中使用 Python 3.3，因为它添加了[限定名称](http://docs.python.org/3/whatsnew/3.3.html#pep-3155-qualified-name-for-classes-and-functions)，可以整齐地标识我们要检查的代码对象。生成的字节码在其他功能上与 Python 3.2 相同。

为了*创建*一个类，Python 基本上采用了构成类主体的整个套件（因此所有内容都比行缩进一层`class <name>:`），并像执行函数一样执行它：

```
>>> import dis
>>> def foo():
...     class Foo:
...         x = 5
...         y = [x for i in range(1)]
...     return Foo
... 
>>> dis.dis(foo)
  2           0 LOAD_BUILD_CLASS     
              1 LOAD_CONST               1 (<code object Foo at 0x10a436030, file "<stdin>", line 2>) 
              4 LOAD_CONST               2 ('Foo') 
              7 MAKE_FUNCTION            0 
             10 LOAD_CONST               2 ('Foo') 
             13 CALL_FUNCTION            2 (2 positional, 0 keyword pair) 
             16 STORE_FAST               0 (Foo) 

  5          19 LOAD_FAST                0 (Foo) 
             22 RETURN_VALUE 
```

第一个`LOAD_CONST`是为类体加载一个代码对象`Foo`，然后将它变成一个函数，并调用它。然后使用该调用的*结果*来创建类的命名空间，其`__dict__`. 到现在为止还挺好。

这里要注意的是字节码包含一个嵌套的代码对象；在 Python 中，类定义、函数、推导和生成器都表示为代码对象，其中不仅包含字节码，还包含表示局部变量、常量、取自全局变量的变量和取自嵌套范围的变量的结构。编译后的字节码指的是那些结构，python 解释器知道如何访问给定的字节码。

这里要记住的重要一点是 Python 在编译时创建这些结构。该`class`套件是一个`<code object Foo at 0x10a436030, file "<stdin>", line 2>`已编译的代码对象 ( )。

让我们检查创建类体本身的代码对象；代码对象有一个`co_consts`结构：

```
>>> foo.__code__.co_consts
(None, <code object Foo at 0x10a436030, file "<stdin>", line 2>, 'Foo')
>>> dis.dis(foo.__code__.co_consts[1])
  2           0 LOAD_FAST                0 (__locals__) 
              3 STORE_LOCALS         
              4 LOAD_NAME                0 (__name__) 
              7 STORE_NAME               1 (__module__) 
             10 LOAD_CONST               0 ('foo.<locals>.Foo') 
             13 STORE_NAME               2 (__qualname__) 

  3          16 LOAD_CONST               1 (5) 
             19 STORE_NAME               3 (x) 

  4          22 LOAD_CONST               2 (<code object <listcomp> at 0x10a385420, file "<stdin>", line 4>) 
             25 LOAD_CONST               3 ('foo.<locals>.Foo.<listcomp>') 
             28 MAKE_FUNCTION            0 
             31 LOAD_NAME                4 (range) 
             34 LOAD_CONST               4 (1) 
             37 CALL_FUNCTION            1 (1 positional, 0 keyword pair) 
             40 GET_ITER             
             41 CALL_FUNCTION            1 (1 positional, 0 keyword pair) 
             44 STORE_NAME               5 (y) 
             47 LOAD_CONST               5 (None) 
             50 RETURN_VALUE 
```

上面的字节码创建了类体。该函数被执行并且生成的`locals()`命名空间，包含`x`并`y`用于创建类（除了它不起作用，因为`x`没有定义为全局）。注意，存入`5`后`x`，会加载另一个代码对象；这就是列表理解；它被包裹在一个函数对象中，就像类体一样；创建的函数接受一个位置参数，`range(1)`用于其循环代码的迭代器，强制转换为迭代器。如字节码所示，`range(1)`在类范围内进行评估。

从中可以看出，函数或生成器的代码对象与推导式的代码对象之间的唯一区别是后者在父代码对象执行时*立即执行；*字节码只是动态地创建一个函数并通过几个小步骤执行它。

Python 2.x 在那里使用内联字节码，这里是 Python 2.7 的输出：

```
 2           0 LOAD_NAME                0 (__name__)
              3 STORE_NAME               1 (__module__)

  3           6 LOAD_CONST               0 (5)
              9 STORE_NAME               2 (x)

  4          12 BUILD_LIST               0
             15 LOAD_NAME                3 (range)
             18 LOAD_CONST               1 (1)
             21 CALL_FUNCTION            1
             24 GET_ITER            
        >>   25 FOR_ITER                12 (to 40)
             28 STORE_NAME               4 (i)
             31 LOAD_NAME                2 (x)
             34 LIST_APPEND              2
             37 JUMP_ABSOLUTE           25
        >>   40 STORE_NAME               5 (y)
             43 LOAD_LOCALS         
             44 RETURN_VALUE 
```

没有加载代码对象，而是`FOR_ITER`内联运行循环。所以在 Python 3.x 中，列表生成器被赋予了它自己的合适的代码对象，这意味着它有自己的作用域。

但是，当解释器首次加载模块或脚本时，理解与其余的 python 源代码一起编译，并且编译器*不*认为类套件是有效范围。列表推导中的任何引用变量都必须递归地查看类定义*周围的范围。*如果编译器未找到该变量，则将其标记为全局变量。列表理解代码对象的反汇编显示`x`确实作为全局加载：

```
>>> foo.__code__.co_consts[1].co_consts
('foo.<locals>.Foo', 5, <code object <listcomp> at 0x10a385420, file "<stdin>", line 4>, 'foo.<locals>.Foo.<listcomp>', 1, None)
>>> dis.dis(foo.__code__.co_consts[1].co_consts[2])
  4           0 BUILD_LIST               0 
              3 LOAD_FAST                0 (.0) 
        >>    6 FOR_ITER                12 (to 21) 
              9 STORE_FAST               1 (i) 
             12 LOAD_GLOBAL              0 (x) 
             15 LIST_APPEND              2 
             18 JUMP_ABSOLUTE            6 
        >>   21 RETURN_VALUE 
```

这块字节码加载传入的第一个参数（`range(1)`迭代器），就像 Python 2.x 版本`FOR_ITER`用来循环它并创建它的输出一样。

如果我们`x`在`foo`函数中定义，`x`将是一个单元格变量（单元格指的是嵌套范围）：

```
>>> def foo():
...     x = 2
...     class Foo:
...         x = 5
...         y = [x for i in range(1)]
...     return Foo
... 
>>> dis.dis(foo.__code__.co_consts[2].co_consts[2])
  5           0 BUILD_LIST               0 
              3 LOAD_FAST                0 (.0) 
        >>    6 FOR_ITER                12 (to 21) 
              9 STORE_FAST               1 (i) 
             12 LOAD_DEREF               0 (x) 
             15 LIST_APPEND              2 
             18 JUMP_ABSOLUTE            6 
        >>   21 RETURN_VALUE 
```

将`LOAD_DEREF`间接`x`从代码对象单元格对象加载：

```
>>> foo.__code__.co_cellvars               # foo function `x`
('x',)
>>> foo.__code__.co_consts[2].co_cellvars  # Foo class, no cell variables
()
>>> foo.__code__.co_consts[2].co_consts[2].co_freevars  # Refers to `x` in foo
('x',)
>>> foo().y
[2] 
```

实际引用从当前帧数据结构中查找值，这些数据结构是从函数对象的`.__closure__`属性初始化的。由于为理解代码对象创建的函数再次被丢弃，我们无法检查该函数的闭包。要查看实际的闭包，我们必须检查嵌套函数：

```
>>> def spam(x):
...     def eggs():
...         return x
...     return eggs
... 
>>> spam(1).__code__.co_freevars
('x',)
>>> spam(1)()
1
>>> spam(1).__closure__
>>> spam(1).__closure__[0].cell_contents
1
>>> spam(5).__closure__[0].cell_contents
5 
```

所以，总结一下：

*   列表推导式在 Python 3 中拥有自己的代码对象，函数、生成器或推导式的代码对象之间没有区别；理解代码对象被包装在一个临时函数对象中并立即调用。
*   代码对象是在编译时创建的，任何非局部变量都被标记为全局变量或自由变量，基于代码的嵌套范围。类主体*不*被视为查找这些变量的范围。
*   在执行代码时，Python 只需要查看全局变量或当前执行对象的闭包。由于编译器没有将类主体包含在范围内，因此不考虑临时函数命名空间。

## 一种解决方法；或者，该怎么办

如果要为`x`变量创建显式作用域，例如在函数中，*则可以*使用类作用域变量进行列表推导：

```
>>> class Foo:
...     x = 5
...     def y(x):
...         return [x for i in range(1)]
...     y = y(x)
... 
>>> Foo.y
[5] 
```

`y`可以直接调用“临时”函数；我们用它的返回值替换它。*解析时*考虑其范围`x`：

```
>>> foo.__code__.co_consts[1].co_consts[2]
<code object y at 0x10a5df5d0, file "<stdin>", line 4>
>>> foo.__code__.co_consts[1].co_consts[2].co_cellvars
('x',) 
```

当然，阅读您的代码的人会对此有些摸不着头脑；你可能想在那里放一个大评论，解释你为什么这样做。

最好的解决方法是只使用`__init__`来创建一个实例变量：

```
def __init__(self):
    self.y = [self.x for i in range(1)] 
```

并避免所有令人头疼的问题，以及解释自己的问题。对于您自己的具体示例，我什至不会将其存储`namedtuple`在课堂上；要么直接使用输出（根本不存储生成的类），要么使用全局：

```
from collections import namedtuple
State = namedtuple('State', ['name', 'capital'])

class StateDatabase:
    db = [State(*args) for args in [
       ('Alabama', 'Montgomery'),
       ('Alaska', 'Juneau'),
       # ...
    ]] 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-01-24T22:25:15.093

在我看来，这是 Python 3 的一个缺陷。我希望他们能改变它。

旧方式（适用于 2.7，抛出`NameError: name 'x' is not defined`3+）：

```
class A:
    x = 4
    y = [x+i for i in range(1)] 
```

*注意：简单地确定它的范围并`A.x`不能解决它*

新方式（适用于 3+）：

```
class A:
    x = 4
    y = (lambda x=x: [x+i for i in range(1)])() 
```

因为语法太难看，我通常只在构造函数中初始化我的所有类变量

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-08-05T02:53:29.373

接受的答案提供了很好的信息，但这里似乎还有其他一些问题——列表理解和生成器表达式之间的差异。我玩过的一个演示：

```
class Foo:

    # A class-level variable.
    X = 10

    # I can use that variable to define another class-level variable.
    Y = sum((X, X))

    # Works in Python 2, but not 3.
    # In Python 3, list comprehensions were given their own scope.
    try:
        Z1 = sum([X for _ in range(3)])
    except NameError:
        Z1 = None

    # Fails in both.
    # Apparently, generator expressions (that's what the entire argument
    # to sum() is) did have their own scope even in Python 2.
    try:
        Z2 = sum(X for _ in range(3))
    except NameError:
        Z2 = None

    # Workaround: put the computation in lambda or def.
    compute_z3 = lambda val: sum(val for _ in range(3))

    # Then use that function.
    Z3 = compute_z3(X)

    # Also worth noting: here I can refer to XS in the for-part of the
    # generator expression (Z4 works), but I cannot refer to XS in the
    # inner-part of the generator expression (Z5 fails).
    XS = [15, 15, 15, 15]
    Z4 = sum(val for val in XS)
    try:
        Z5 = sum(XS[i] for i in range(len(XS)))
    except NameError:
        Z5 = None

print(Foo.Z1, Foo.Z2, Foo.Z3, Foo.Z4, Foo.Z5) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-15T11:03:39.363

由于最外面的迭代器是在周围范围内评估的，我们可以使用[`zip`](https://docs.python.org/3/library/functions.html#zip)with[`itertools.repeat`](https://docs.python.org/3/library/itertools.html#itertools.repeat)将依赖项传递到理解的范围：

```
import itertools as it

class Foo:
    x = 5
    y = [j for i, j in zip(range(3), it.repeat(x))] 
```

还可以`for`在理解中使用嵌套循环，并将依赖项包含在最外层的可迭代对象中：

```
class Foo:
    x = 5
    y = [j for j in (x,) for i in range(3)] 
```

对于OP的具体示例：

```
from collections import namedtuple
import itertools as it

class StateDatabase:
    State = namedtuple('State', ['name', 'capital'])
    db = [State(*args) for State, args in zip(it.repeat(State), [
        ['Alabama', 'Montgomery'],
        ['Alaska', 'Juneau'],
        # ...
    ])] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-30T12:00:12.023

这是 Python 中的一个错误。理解被宣传为等同于 for 循环，但在类中并非如此。至少在 Python 3.6.6 之前，在类中使用的推导中，只有推导之外的一个变量可以在推导内部访问，并且它必须用作最外层的迭代器。在函数中，此范围限制不适用。

为了说明为什么这是一个错误，让我们回到最初的例子。这失败了：

```
class Foo:
    x = 5
    y = [x for i in range(1)] 
```

但这有效：

```
def Foo():
    x = 5
    y = [x for i in range(1)] 
```

该限制在参考指南中[本节](https://docs.python.org/3/reference/executionmodel.html#resolution-of-names)的末尾进行了说明。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-12T20:37:40.810

我花了很多时间来理解为什么这是一个特性，而不是一个错误。

考虑简单的代码：

```
a = 5
def myfunc():
    print(a) 
```

由于 myfunc() 中没有定义“a”，因此范围会扩大并且代码将执行。

现在考虑类中的相同代码。它**不能**工作，因为这会完全弄乱访问类实例中的数据。您永远不会知道，您是在访问基类还是实例中的变量。

列表推导只是相同效果的一个子案例。

# php - 我无法确定此脚本中的错误位置。尝试添加验证后出现错误

> ID：13905747
> 
> 赞同：-1
> 
> 时间：2012-12-16T21:43:07.863
> 
> 标签：php, html

我无法确定此脚本中的错误位置。尝试添加验证后出现错误。

我才刚刚开始用 php 编码，所以请原谅 ;)

错误读取 Parse error: syntax error, unexpected end of file in C:\xampp\htdocs\index.php 在第 84 行

请帮忙：（

```
 <?php

    ini_set('display_errors', 'On');
    error_reporting(E_ALL | E_STRICT);
        //debugging^

        function p($array) {
            echo '<pre>';
            print_r($array);
            echo '</pre>';
        }

        $con = mysql_connect("localhost","root","password1");
        if (! $con) {
            die('Could not connect: ');
        }

        mysql_select_db("inimaxedwards", $con);
        $result = mysql_query("SELECT * FROM wishlist");

        echo "<table border='1' width=600px>
        <tr>
        <th>Item</th>
        <th>Cost</th>
        <th>Website</th>
        </tr>";

        while($row = mysql_fetch_array($result)) { //p($row);
            echo "<tr>";
            echo "<td>" . $row['Item'] . "</td>";
            echo "<td>" . $row['Cost'] . "</td>";
            echo "<td>" . $row['Website'] . "</td>";
            echo "</tr>";
        }

//validation below

$itemErr = $costErr = $websitErr;

if ($_SERVER["REQUEST_METHOD"] == "POST") {

    if (empty($_POST["item"])) {

        $itemErr = "You need to enter an item";

if ($_SERVER["REQUEST_METHOD"] == "POST") {

    if (empty($_POST["cost"])) {

        $costErr = "How much is the item?";

if ($_SERVER["REQUEST_METHOD"] == "POST") {

    if (empty($_POST["website"])) {

        $websiteErr = "Please provide a link for item!";

}

            echo "</table>";
            mysql_close($con);

        ?>

        <form action="insert.php" method="post">
            Item: <input type="text" name="item">
            Cost: <input type="text" name="cost">
            Website: <input type="text" name="website">
            <input type="submit">

        </form>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:48:08.077

Unless there's a mistake in pasting, then you have a few missing closing curly brackets.

Try:

```
if ($_SERVER["REQUEST_METHOD"] == "POST") {

   if (empty($_POST["item"]))
      $itemErr = "You need to enter an item";

   if (empty($_POST["cost"]))
      $costErr = "How much is the item?";

   if (empty($_POST["website"]))
      $websiteErr = "Please provide a link for item!";
} 
```

# c# - C# MongoDb 查询和使用底层 JSON

> ID：13905752
> 
> 赞同：0
> 
> 时间：2012-12-16T21:44:04.553
> 
> 标签：c#, javascript, mongodb, migration, mongodb-.net-driver

希望这是一个简单的方法，但不确定它是否会像网上的信息表明您在不使用强类型模型的情况下无法查询。

为了给场景提供一些背景知识，我有一个客户端 javascript 应用程序，它在本地创建和存储模型（本地存储）。然而，有一个 Web 服务 (ASP MVC) 可以通过授权用户发送模型，它会验证并持久化它。

现在的问题是，随着客户端应用程序的更新，模型往往会发生变化，可以将其想象为数据库迁移脚本，但带有模型。但是它们都有版本和迁移脚本，因此系统将允许加载保存的（客户端）旧模型，然后更新到最新版本并重新保存。

所以客户端很好地处理了不同的版本模型，我相信你们都想知道 mongodb/c# 问题在哪里，所以它来了。

在服务器端，验证标准始终针对给定时间的模型的最新版本。因此，如果最新的客户端模型版本是 2.3，那么服务器端将是相同的，并且会正确验证它。

所以此时假设我保存我的客户端模型@版本 3.1，服务器验证版本 3.1 并将其持久化到 MongoDB。然后我走了一年，回来的时候客户端版本是5.1，而且我已经格式化了我的电脑，所以我没有本地数据，所以我去下载它，但是5.1的模型与3.1版。服务端不具备迁移数据的能力，但是我们知道数据在进入数据库的时候是有效的，所以数据库中的json没有理由不能发送到客户端，到时候会自动迁移它加载到内存中（然后重新保存在客户端上）。现在由于代表最新版本（5.1）的服务器模型，我想它要么例外，要么只是填写它可以填写的内容，并默认模型中的其余变量。

因此，由于所有查询都针对我知道永远不会更改的 2 个字段（AccountId、PersistedId），我看不出有任何理由为什么我无法在没有强类型对象的情况下查询 MongoDB 对象以取回原始 BSON 文档，然后调用 ToJson( ) 在该 BSON 文档上并发送回客户端。那么有没有什么方法可以读取数据而不必使用强类型呢？所以我可以验证写入并在那里使用强类型模型，但是在提取数据时我只想查询原始 BSON？

希望这是有道理的，即使它是冗长的，只是想给出上下文以避免“你为什么不能使用强类型模型？” 等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T15:26:13.947

因此，您可以使用原始 BsonDocuments 进行查询。这些是无类型的，但可以使用类型化模型创建。也许这是一种妥协？

```
var queryDocument = Query<Person>.Eq(p => p.Name, "Jack");
// { "name" : "Jack" } 
```

否则，如果您打算让您的版本以这种方式工作，则没有神奇的子弹来处理模式迁移。这是所有数据库堆栈的问题。[我们在序列化教程](http://www.mongodb.org/display/DOCS/CSharp+Driver+Serialization+Tutorial#CSharpDriverSerializationTutorial-HandlingSchemaChanges)中编写了一些文档来处理它。

# objective-c - UIImageView 没有设置图像

> ID：13905756
> 
> 赞同：0
> 
> 时间：2012-12-16T21:44:34.803
> 
> 标签：objective-c, ios

我试图`UIImageView`从一个segue设置一个，由于某种原因，图像没有被设置。这`.h`是我的类的子类文件`UIViewController`

```
@interface PhotoDisplayViewController : UIViewController
@property (weak, nonatomic) IBOutlet UIImageView *photoView;
-(void)setPhoto:(UIImage *)photo;
@end 
```

这是setPhoto

```
-(void)setPhoto:(UIImage *)photo{
    NSLog(@"PHOTO %@", photo);
    _photoView.image = photo;
    NSLog(@"MYPHOTO %@", _photoView.image);
} 
```

当我从准备 segue 调用 setPhoto 时，我在控制台中看到了这个

```
2012-12-16 13:26:22.129 TestApp[2183:907] PHOTO <UIImage: 0x1fd7cd80>
2012-12-16 13:26:22.130 TestApp[2183:907] MYPHOTO (null) 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T21:48:22.230

看起来`_photoView`大概是`nil`。加载笔尖时可能未设置。确保您已在 IB 中正确连接它。或者您可能正在调用 -setPhoto: 在视图加载之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T23:41:24.463

我建议您更改`weak`为`strong`并查看此链接。

[Objective-C - 弱属性 - getter autoreleases（自动引用计数）](https://stackoverflow.com/questions/8148551/objective-c-weak-property-getter-autoreleases-automatic-reference-counting)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-24T13:20:09.900

我认为您将`setPhoto:`方法称为如下。在这种情况下，首先调用 setPhoto:，然后在 PhotoDisplayViewController 中调用 viewDidLoad 方法。这就是 photoView 为零的原因。实际上应该在 PhotoDisplayViewController 中调用 viewDidLoad 方法。所以你应该稍微改变一下代码。

```
-(void)someActionMethod{
          [self performSegueWithIdentifier:yourIdentifier sender:nil];
 }
 -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
            if ([[segue identifier] isEqualToString:yourIdentifier]) {
                photoDisplayVC = [segue destinationViewController];//photoDisplayVC is a object of         PhotoDisplayViewController
                 [photoDisplayVC setPhoto:imageObject];
 } 
```

更改代码：在这种情况下，首先调用 viewDidLoad 方法，然后在 PhotoDisplayViewController 中调用 setPhoto: 方法。然后你会得到图像。

```
-(void)someActionMethod{
  [self performSegueWithIdentifier:yourIdentifier sender:nil];
 [photoDisplayVC setPhoto:imageObject];
   }
  -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
                if ([[segue identifier] isEqualToString:yourIdentifier]) {
                    photoDisplayVC = [segue destinationViewController];//photoDisplayVC is a object of         PhotoDisplayViewController

     } 
```

我想这会对你有所帮助。

# jquery - 根据选中的复选框选择相关的隐藏值

> ID：13905758
> 
> 赞同：0
> 
> 时间：2012-12-16T21:44:39.760
> 
> 标签：jquery

我想知道是否有人可以帮助我。我想根据从列表中选择的复选框生成一串用户 ID。

我目前的代码是：

```
<fieldset id="engineers" data-role="controlgroup">
@foreach (var item in Model.Maintenance_Team_List)
{
<label><input type="checkbox" name="Username"     />
@item.Username</label>@Html.Hidden("Booked_Engineer_ID",item.UserID)
}
</fieldset> 
```

我尝试使用 jquery 检查是否选中了每个用户名复选框。从那里我试图找到它对应的booked_engineer_id。

```
var listed = $('#Username input:checked').each(function () {
        $("#engineer_div").find('#Booked_Engineer_ID').text();
    }); 
```

然而，这似乎没有选择任何东西。我正在寻找一个简单的输出，例如 23,10,11,1，其中这些值表示所选复选框booked_engineer_id 隐藏字段中的值。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:47:15.480

首先，要获取输入字段的值，您应该使用`val()`而不是`text()`.

但更重要的是你的算法会做一些奇怪的事情。我想你想得到这样的东西：

```
var listed = [];
$('input[name=Username]:checked').each(function (index, element) {
     var id = $(element).parent('label').next('input[name=Booked_Engineer_ID]').val();
     listed.push(id);
});
var simpleOutput = listed.join(); 
```

**更新：**

在像你这样的情况下，我最好建议使用数据属性而不是隐藏字段：

```
<fieldset id="engineers" data-role="controlgroup">
@foreach (var item in Model.Maintenance_Team_List)
{
    <label>
        <input type="checkbox" data-userId="@item.UserID" />
        @item.Username
    </label>
}
</fieldset> 
```

和脚本：

```
var listed = [];
$('#engineers input:checked').each(function () {
     var id = $(this).data("userId");
     listed.push(id);
});
var simpleOutput = listed.join(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T11:25:56.280

我无法让上面的代码正常工作，但它促使我朝着正确的方向前进并产生以下结果：

```
var listed = [];
    $('input[name=Username]:checked').each(function () {

        var ID = $(this).parent().next().val();
        listed.push(ID)
    });

    var SimpleOutput = listed.join(); 
```

喜欢 jquery 链接。

# html - 相对于父容器宽度的水平居中文本？

> ID：13905761
> 
> 赞同：1
> 
> 时间：2012-12-16T21:45:02.057
> 
> 标签：html, css

我正在尝试将一些文本水平居中在 div 中。

CSS：

```
#parent {
      background-color: #eee;
      height: 48px;
      text-align: center;
}
#colLeft {
      background-color: #ff8b8b;
      height: 48px;
      display: inline;
      float: left;
}
#colRight {
      background-color: #c3d0ff;
      height: 48px;
      display: inline;
      float: right;
} 
```

HTML：

```
<div id="parent" style="width:100%">
      <div id="colLeft">left left left left</div>
      Title
      <div id="colRight">right</div>
 </div>

 <div style="width:100%; text-align:center">
      Title - this one is really centered.
 </div> 
```

但是考虑到`#colLeft`占用的空间，文本“标题”似乎居中，因此相对于浏览器宽度而言，它并没有真正居中。

有没有一种方法可以让文本真正居中，无论`#colLeft`占用多少空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:59:26.347

这不是真的推荐，但你可以做这样的事情[JS Fiddle](http://jsfiddle.net/Rb6en/)。

```
#parent {
      background-color: #eee;
      height: 48px;
      text-align: center;
}
#colLeft {
      background-color: #ff8b8b;
      height: 48px;
      display: inline;
      float: left;
}
#colRight {
      background-color: #c3d0ff;
      height: 48px;
      display: inline;
      float: right;
}
.title{
    position: absolute;
    width: 100px;
    left: 50%;
    margin-left: -50px;
}

<div id="parent" style="width:100%">
      <div id="colLeft">left left left left</div>
    <div class="title">Title</div>
      <div id="colRight">right</div>
 </div>

 <div style="width:100%; text-align:center">Title - this one is really centered.</div>​ 
```

你做标题`position:absolute`。给它一个宽度。`left: 50%`. `margin-left:`减去宽度的一半。它将保持中心位置。但我真的不建议这样做......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T22:02:42.243

如果你用这样的 div 包围 Title：

```
<div style="position: absolute;left: 50%">Title</div> 
```

你很擅长 Webkit。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T22:23:29.927

```
<div align="left" style="border:5px solid white; text-align:center; position:relative">

<div align="left" style="border:4px solid brown; float:left; width:100px; position:absolute"><span>left</span></div>
<div align="left" style="border:4px solid brown; right:0; width:200px; position:absolute"><span>right</span></div>

<span>really centered</span></div> 
```

# php - Joomla 和 Drupal 中允许的内存大小已耗尽

> ID：13905763
> 
> 赞同：0
> 
> 时间：2012-12-16T21:45:26.473
> 
> 标签：php, drupal, joomla, content-management-system, out-of-memory

我正在尝试使用 Joomla 建立一个网站，这是我在访问*localhost*后得到的错误（在成功安装过程之后）：

```
Fatal error: Allowed memory size of 8388608 bytes exhausted (tried to allocate 98304 bytes) in [...]\default_item.php on line 77 
```

使用 Drupal 时也会发生同样的事情（尽管在安装之前）。我已经尝试过更改`php.ini`（在 Joomla 本身给出的位置，所以它是正确的。有趣的是，localhost 上的网站*不起作用*，而*localhost/administrator*上的管理面板工作，这就是我从中获取文件位置的地方）看起来像这样：

```
memory_limit = 512M 
```

我还尝试放入`ini_set('memory_limit', '512M');`错误指示的脚本并释放我的一些 RAM，但仍然 - 没有成功。

我使用 WebServ，它使用 Apache 2.2.6 和 PHP 5.2.5。

我还能做些什么来解决这个问题？

**编辑：**

[phpinfo() 的输出；对于 Joomla](http://pastebin.com/A85J2vFr)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T05:14:46.667

`ini_set('memory_limit', '-1');`覆盖默认的[PHP 内存限制](http://php.net/manual/en/ini.core.php#ini.memory-limit)。

顺便提一下，寻找永无止境的循环。它可能导致错误。

# php - MySQL/PHP 检索一个项目在第二个表中出现的次数

> ID：13905764
> 
> 赞同：0
> 
> 时间：2012-12-16T21:45:28.000
> 
> 标签：php, mysql, codeigniter

第一次来这里 ...

我在 MySQL 中有一个问题：

我有一个表“产品”，其中包含一些字段，如产品 ID、项目代码、标签、价格……。还有第二个表“库存”，其中包含一些与第一个字段相同的字段。“itemcode”字段是比较两个表最容易的。

产品从每个“项目代码”项目中只有一个外观。然而，库存有它们多次。

我需要做的：我需要输出“产品”中的每个“项目代码”出现在“库存”中的次数。最好的方法是什么？

例子

```
products
  itemcode
  AA2244G
  AB2245G
  AC2246G
  AD2247G
  AE2248G

inventory
  itemcode
  AA2244G
  AA2244G
  AB2245G
  AC2246G
  AC2246G
  AC2246G
  AE2248G

Output
 AA2244G 2x
 AB2245G 1x
 AC2246G 3x
 AD2247G 0x
 AE2248G 1x 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:49:06.007

```
SELECT  a.itemcode, CONCAT(COUNT(b.itemcode), 'x') totalCount
FROM    products a 
        LEFT JOIN inventory b
            ON a.itemcode = b.itemcode
GROUP BY a.itemcode 
```

*   [SQLFiddle Demo Link](http://sqlfiddle.com/#!2/3492b/3)

# php - 当它已经在检查一个会话时，如何添加另一个检查设置？

> ID：13905767
> 
> 赞同：1
> 
> 时间：2012-12-16T21:45:42.540
> 
> 标签：php, session

我想知道如何对设置的会话进行第二次“检查”。我目前正在使用此代码：

```
<?php
session_start();
require_once("../user/connect.php");
include "getn.php";
if($_SESSION['username'] != 'RBLXDev') {
die('lol failure');
}
?> 
```

我当前的用户名是`RBLXDev`，但我想让它检查当前用户名（存储在名为 username 的会话中）是否类似于“waffle_”。我相信您`and`在 PHP 中的语句是 ||，但我不知道如何添加到该代码中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T22:01:30.670

您可以在语句中使用任何[逻辑运算符](http://us3.php.net/manual/en/language.operators.logical.php)`if`来执行 2 次或更多检查 -

使用或 / || -

```
if($_SESSION['username'] != 'RBLXDev' or $_SESSION['username'] != '...') { }
if($_SESSION['username'] != 'RBLXDev' || $_SESSION['username'] != '...') { } 
```

使用 and / && -

```
if($_SESSION['username'] != 'RBLXDev' and $_SESSION['username'] != '...') { }
if($_SESSION['username'] != 'RBLXDev' && $_SESSION['username'] != '...') { } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:03:00.120

欢迎来到 SO！

```
if($_SESSION['username'] != 'RBLXDev' && $_SESSION['username'] != 'waffle_') 
```

请阅读[php 的逻辑运算符](http://php.net/manual/en/language.operators.logical.php)。

# sql - SQL 拆分函数和导入的数据

> ID：13905768
> 
> 赞同：0
> 
> 时间：2012-12-16T21:45:44.993
> 
> 标签：sql, sql-server-2008

好的，我有一个数据库表，其中数据被我鄙视的这个可怕的小程序转储，但目前无法更改。它有商家数据、名称、地址和一组用竖线分隔的类别。我需要的是一种干净的方式来将它们分开，所以我为每个商家/类别对设置一行。从那里，我可以轻松地将其放入新的数据结构中。这需要在短时间内是一个可重复的过程。我意识到最佳解决方案是摆脱这种结构，但我绞尽脑汁想弄清楚如何在 sql 中干净地做到这一点。

我已经在数据库中有一个函数，它将分割一个分隔的字符串并返回一个表。

这是在 sql server 2008 中，顺便说一句。

编辑（为清楚起见_基本上，以下可能是商家（附加类别 - 为简单起见，对其他字段进行了编辑。在此处使用逗号作为字段分隔符）。

```
Jimbo's Bait Shoppe, Bait|Sports Gear|Sandwiches 
```

我需要的是：

```
Jimbo's Bait Shoppe, Bait
Jimbo's Bait Shoppe, Sports Gear
Jimbo's Bait Shoppe, Sandwiches 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T23:20:20.330

如果您已经编写了一个拆分字符串并返回表的函数，则可以使用触发器。

在“可怕”程序吐出数据的表上的 INSERT 上创建一个触发器。然后触发器将获取未格式化的数据并填充两个干净的表（我认为在您的情况下，您应该有两个表：一个是商家，另一个是产品，使用 MerchantID 使用一对多关系链接）。

在这种情况下，您可以将带有未格式化数据的表用作“脏”表。您可以在“可怕的”程序导入文件后立即进行清理。

如果您需要有关触发器的帮助，请发表评论

# php - PHP从mysqli查询结果创建一个数组

> ID：13905770
> 
> 赞同：0
> 
> 时间：2012-12-16T21:45:49.250
> 
> 标签：php, arrays, mysqli, fetch

我有将 mysqli 查询的结果存储在数组中的代码，但我想通过仅将一列的结果存储在数组中来使代码更高级。这是我的代码：

```
// Create array of devices that match the current unit in array $unitsarray
$result = $mysqli->query("SELECT * FROM `department devices` WHERE unit LIKE $unit");

//Fetch all rows in result and store them in an array $rows
$rows = array();
while($row = $result->fetch_row()) {
    $rows[] = $row;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T21:52:37.813

例如：如果您想要第 x 列，您只需从数据库中获取第 x 列，您是否尝试更改查询；

```
$result = $mysqli->query("SELECT x FROM `department devices` WHERE unit LIKE $unit"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T23:20:04.377

使您的代码“更高级”的是：

1.  接受'->fetch_assoc()`总是返回一个列数组
2.  编写您自己的数据库处理程序来处理您想要的那种结果集转换。

后者称为*抽象*，是编写代码库的主要原因。

# c - 打印链接列表（打印更多应有的内容）

> ID：13905772
> 
> 赞同：0
> 
> 时间：2012-12-16T21:45:49.363
> 
> 标签：c, list, output

这些是功能

```
//printList for Debugging
void printList(letterListT *head){
    letterListT *temp = head;
    while(temp != NULL){
        printf("%c ", temp->letter);
    temp = temp->nxt;
    }
}  

//Add the Specified Letter by Creating a New Node in the Letter List defined
void addLetter(letterListT *letListHead, char letter){
    letterListT *newNode;
    newNode = (letterListT *)malloc(sizeof(letterListT));

    newNode->letter = letter;

    newNode->nxt = letListHead->nxt;
    letListHead->nxt = newNode;
} 
```

这些主要是：

```
unusedLetList = (letterListT *)malloc(sizeof(letterListT));
unusedLetList->nxt = NULL;

for(i=122; i>=97; i--){ //ascii codes for z to a
addLetter(unusedLetList, i);
}

//printlists Test
printList(unusedLetList); 
```

这是输出...

```
p a b c d e f g h i j k l m n o p q r s t u v w x y z 
```

我的问题是……这个“p”是从哪里来的？！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-16T21:49:39.517

The list head node.

```
unusedLetList = (letterListT *)malloc(sizeof(letterListT));
unusedLetList->nxt = NULL; 
```

You create a head node here, and then add each letter after the head node. The head node has an uninitialized `->letter` field. It could be anything; it happens to be `p`.

# c - 在 C 语言中，如何使用 libcurl 将 HTTP 响应读入字符串？

> ID：13905774
> 
> 赞同：13
> 
> 时间：2012-12-16T21:46:12.240
> 
> 标签：c, string, libcurl, httpresponse

我有作业需要以某种方式比较两个 HTTP 响应。我正在用 C 语言编写它，并使用 libcurl 使事情变得更容易。我正在调用使用 libcurl 执行 HTTP 请求和来自另一个函数的响应的函数，并且我想将 HTTP 响应作为`char *`. 到目前为止，这是我的代码（它崩溃了）：

```
#include <stdio.h>
#include <curl/curl.h>
#include <string.h>

size_t write_data(void *ptr, size_t size, size_t nmemb, void *stream) {
    size_t written;
    written = fwrite(ptr, size, nmemb, stream);
    return written;
}

char *handle_url(void) {
    CURL *curl;
    char *fp;
    CURLcode res;
    char *url = "http://www.yahoo.com";
    curl = curl_easy_init();
    if (curl) {
        curl_easy_setopt(curl, CURLOPT_URL, url);
        curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_data);
        curl_easy_setopt(curl, CURLOPT_WRITEDATA, fp);
        res = curl_easy_perform(curl);
        if(res != CURLE_OK)
                fprintf(stderr, "curl_easy_perform() failed: %s\n",   curl_easy_strerror(res));

        curl_easy_cleanup(curl);

        //printf("\n%s", fp);
    }
    return fp;
} 
```

这个解决方案[C libcurl get output into a string](https://stackoverflow.com/questions/2329571/c-libcurl-get-output-into-a-string?rq=1)有效，但在我的情况下不行，因为我只想将字符串返回给调用函数。

有任何想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-16T22:17:30.620

为你修好了。您需要处理`write_data()`多次调用该函数的情况，并为其传递正确类型的参数。您还需要跟踪您拥有的结构有多大，以便分配足够的内存。

`printf`我在函数中留下了一个调试，`write_data`以帮助您了解它是如何工作的。

```
#include <stdio.h>
#include <curl/curl.h>
#include <string.h>
#include <stdlib.h>

struct url_data {
    size_t size;
    char* data;
};

size_t write_data(void *ptr, size_t size, size_t nmemb, struct url_data *data) {
    size_t index = data->size;
    size_t n = (size * nmemb);
    char* tmp;

    data->size += (size * nmemb);

#ifdef DEBUG
    fprintf(stderr, "data at %p size=%ld nmemb=%ld\n", ptr, size, nmemb);
#endif
    tmp = realloc(data->data, data->size + 1); /* +1 for '\0' */

    if(tmp) {
        data->data = tmp;
    } else {
        if(data->data) {
            free(data->data);
        }
        fprintf(stderr, "Failed to allocate memory.\n");
        return 0;
    }

    memcpy((data->data + index), ptr, n);
    data->data[data->size] = '\0';

    return size * nmemb;
}

char *handle_url(char* url) {
    CURL *curl;

    struct url_data data;
    data.size = 0;
    data.data = malloc(4096); /* reasonable size initial buffer */
    if(NULL == data.data) {
        fprintf(stderr, "Failed to allocate memory.\n");
        return NULL;
    }

    data.data[0] = '\0';

    CURLcode res;

    curl = curl_easy_init();
    if (curl) {
        curl_easy_setopt(curl, CURLOPT_URL, url);
        curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_data);
        curl_easy_setopt(curl, CURLOPT_WRITEDATA, &data);
        res = curl_easy_perform(curl);
        if(res != CURLE_OK) {
                fprintf(stderr, "curl_easy_perform() failed: %s\n",  
                        curl_easy_strerror(res));
        }

        curl_easy_cleanup(curl);

    }
    return data.data;
}

int main(int argc, char* argv[]) {
    char* data;

    if(argc < 2) {
        fprintf(stderr, "Must provide URL to fetch.\n");
        return 1;
    }
    data = handle_url(argv[1]);

    if(data) {
        printf("%s\n", data);
        free(data);
    }

    return 0;
} 
```

注意：编译`gcc -o test test.c -lcurl`（假设您粘贴到`test.c`）。用于`gcc -o test test.c -lcurl -DDEBUG`查看测试`printf()`调用。

免责声明：这是丑陋、快速而肮脏的代码。可能有错误。请在[此处查看更强大、注释更好的示例](http://curl.haxx.se/libcurl/c/getinmemory.html)。

# ios - Release Update for unreleased App in iTunes Connect

> ID：13905778
> 
> 赞同：1
> 
> 时间：2012-12-16T21:46:56.727
> 
> 标签：ios, app-store, app-store-connect

I have an approved App in iTunes Connect which is not yet released (release date set to December 20th).

I decided to change a few things so I submitted an update, now this update has been approved as well and is "Pending Developer Release".

If I release the update now will the app become visible on the App Store, even though the release date under "rights and pricing" is set to December 20th?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:54:22.147

It won't go live until the 20th December. 'Pending Developer Release' is just a staging area until you approve that it's OK to override the original release.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:05:51.193

Do they both have the same bundle name? If so, can you delete the first one and only have the second one that you want anyways?

# php - Facebook PHP SDK getUser 与 Facebook 上的画布应用程序一起使用，但在移动站点中它不起作用

> ID：13905780
> 
> 赞同：1
> 
> 时间：2012-12-16T21:47:15.337
> 
> 标签：php, facebook, authentication

我已经制作了一个完美运行的 Facebook 应用程序，所以现在我正在尝试设置一个移动应用程序。我使用文档中描述的此代码来检查用户是否已登录，如果用户已登录，则将信息转发。

这是我正在使用的代码：

```
<?php 
session_start();

// Include facebook PHP SDK
 require_once("lib/facebook.php");

// Configure the facebook object
$config = array();
$config['appId'] = 'APP_ID';
$config['secret'] = 'APP_SECRET';
$config['cookie'] = true;
$config['fileUpload'] = true;

$app_id = 'APP_ID';
$canvas_page = "https://hadadmin.yourwebhosting.com/mixit/mobile/";

     $location = "https://www.facebook.com/dialog/oauth?client_id=" 
        . $app_id . "&redirect_uri=" . urlencode($canvas_page) . "&scope=publish_stream,email,create_event,rsvp_event,user_events,friends_events";

    // initialize the facebook oject
  $facebook = new Facebook($config);

    // Get Facebook User
    $fbID = $facebook->getUser();

    // Get the current access token
    $access_token = $facebook->getAccessToken();

    // check if we have valid user
if ($fbID) {
    try {
        // Proceed knowing you have a logged in user who's authenticated.
        $fb_user_profile = $facebook->api('/me');   

    } catch (FacebookApiException $e) {
        $fbID = NULL;
        // seems we don't have enough permissions
        // we use javascript to redirect user instead of header() due to Facebook bug
        print '<script language="javascript" type="text/javascript"> top.location.href="'. $location .'"; </script>';

        // kill the code so nothing else will happen before user gives us permissions
        die();
    } 

} else {
    // seems our user hasn't logged in, redirect him to a FB login page

print '<script language="javascript" type="text/javascript"> top.location.href="'. $location .'"; </script>';

  // kill the code so nothing else will happen before user gives us permissions
   die();
} 
```

我已经搜索过所有类似问题的解决方案都没有工作（即getUser返回0）getUser返回0就像在其他帖子中一样，但就像我说的那样，当我不使用移动网站时它工作正常，应用程序.facebook.com/MYAPP 和[https://hadadmin.yourwebhosting.com/mixit/](https://hadadmin.yourwebhosting.com/mixit/)也在工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:05:31.553

`getUser`通过 javascript SDK 或通过`signed_request`（用于画布和页面选项卡）使用 cookie 设置。

由于您在移动网站上，并且如果它是第一个用户连接，那么您将没有 cookie，显然也没有`signed_request`. 因此，您需要使用 javascript SDK 通过方法中的设置或调用`status`来设置 Facebook 连接。然后，您可以请求您的服务器（cookie 将与同一域上的任何 ajax 请求一起发送）。`true``init``getLoginStatus`

**编辑后：** 据我所知，您在这里的跨域通信有问题。请务必使用有效`channel`文件正确设置 facebook。对于 IE，设置 P3P 标头，这将有很大帮助。对 Safari 来说，这简直是一项艰巨的工作，但是 google 一下“跨域通信”，你会发现很多解决方案。但如果 Facebook SDK 设置正确，这些就不是必需的。

希望这有帮助！

# javascript - 为什么我的 li 被忽略了？

> ID：13905781
> 
> 赞同：1
> 
> 时间：2012-12-16T21:47:22.610
> 
> 标签：javascript, jquery, html

[http://jsfiddle.net/uGyTB/](http://jsfiddle.net/uGyTB/)

```
var s = $("<li><a href='index.html'><h3>hello</h3></a></li>");
alert(s.html());​ 
```

显示未创建 li 元素。为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-16T21:48:45.853

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:04:55.793

在一个 HTML 文档中，`.html()`可以用来获取任何元素的内容。如果选择器表达式匹配多个元素，则只有第一个匹配项才会返回其 HTML 内容。考虑这段代码：

```
$('div.demo-container').html(); 
```

为了检索以下内容，它必须是文档中第一个带有 class="demo-container" 的内容：

```
<div class="demo-container">
  <div class="demo-box">Demonstration Box</div>
</div> 
```

结果将如下所示：

```
<div class="demo-box">Demonstration Box</div> 
```

# php - php://temp 将其复制到文件中？

> ID：13905783
> 
> 赞同：1
> 
> 时间：2012-12-16T21:47:39.453
> 
> 标签：php, file, copy

`php://temp`我有一些使用...创建 tmp 文件的代码

出于调试目的和学习目的，我想保存/复制到定义的文件中。那么有什么简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:55:53.683

您可以在处理大文件时使用`stream_get_contents`或`fwrite`

```
//Somecode wrting to temp
$tmp = fopen('php://temp', 'r+');
fwrite($tmp, 'test');
rewind($tmp);

// Read and save to log.txt 
file_put_contents("log.txt",stream_get_contents($tmp)); 
```

大文件实现

```
set_time_limit(0);

$file = "log.txt";
$final = fopen($file, "w+");

while ( ! feof($tmp) ) {
    fwrite($final, fgets($tmp));
}

fclose($tmp);
fclose($final); 
```

# java - Java 集 > 到字符串[][]

> ID：13905785
> 
> 赞同：1
> 
> 时间：2012-12-16T21:48:06.137
> 
> 标签：java, string, set

如何将 a 转换`Set<Set<String>>`为 a `String[][]`？我已经尝试过`.toArray(new String[0])`，但这似乎并没有奏效。

谢谢！基督教

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T21:51:32.293

For each `Set<String> s` in the outer set, convert `s` to `String[]` and add it to your Array of arrays.

I don't know any built in way to create n-dimensional arrays from nested collections.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T21:51:48.447

Loop through the set and create the array

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-17T05:01:40.130

试试下面的代码，它可以工作

```
package com.rais;

import java.util.HashSet;
import java.util.Set;

/**
 * @author Rais.Alam
 * @date Dec 17, 2012
 */
public class SetClient
{

    /**
     * @param args
     */
    public static void main(String[] args)
    {

        Set<Set<String>> myArray = new HashSet<Set<String>>();

        Set<String> arr1 = new HashSet<String>();
        Set<String> arr2 = new HashSet<String>();
        Set<String> arr3 = new HashSet<String>();

        arr1.add("a-1");
        arr1.add("a-2");
        arr1.add("a-3");

        arr2.add("b-1");
        arr2.add("b-2");
        arr2.add("b-3");

        arr3.add("c-1");
        arr3.add("c-2");
        arr3.add("c-3");
        arr3.add("c-4");
        arr3.add("c-5");

        myArray.add(arr1);
        myArray.add(arr2);
        myArray.add(arr3);

        String[][] outputArray = convertSetOfSetToArray(myArray);

        for (String[] outerArr : outputArray)
        {
            for (String value : outerArr)
            {
                if (value != null)
                {
                    System.out.println(value);
                }
            }
        }

    }

    public static String[][] convertSetOfSetToArray(Set<Set<String>> myArray)
    {
        int secondArraySize = 0;

        /*
         * Looping array to get the size.
         */
        for (Set<String> innerSet : myArray)
        {
            if (innerSet.size() > secondArraySize)
            {
                secondArraySize = innerSet.size();
            }
        }
        // Declaring and initializing String arrays;
        String[][] outputArray = new String[myArray.size()][secondArraySize];

        int firstIndex = 0;
        int secondIndex = 0;

        for (Set<String> innerSet : myArray)
        {
            for (String value : innerSet)
            {
                outputArray[firstIndex][secondIndex] = value;
                secondIndex++;
            }
            secondIndex = 0;
            firstIndex++;
        }

        return outputArray;
    }

} 
```

# mysql - Expression mysql NOW() in Doctrine QueryBuilder

> ID：13905788
> 
> 赞同：30
> 
> 时间：2012-12-16T21:48:17.783
> 
> 标签：mysql, doctrine, doctrine-orm, doctrine-query

How to use the expression mysql NOW() in doctrine querybuilder?

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-12-17T01:24:27.883

在 Doctrine2 中，您必须使用以下内容之一而不是`NOW()`.
这个：

```
CURRENT_TIMESTAMP() 
```

或者：

```
...
createQuery(...'WHERE x.date = :now')
->setParameter('now', new \DateTime('now'))
... 
```

如果您只想要时间或日期，请使用其中之一： `CURRENT_TIME()`和`CURRENT_DATE()`

[文档可以在这里找到](https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/dql-doctrine-query-language.html#functions-operators-aggregates)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-10-19T12:08:24.460

使用查询生成器，它看起来像这样：

```
$qb
    ->select('B')
    ->from('RandomBundle:Banana', 'B')
    ->where(
        $qb->expr()->gt('B.expiresAt', ':now')
    )
    ->setParameter('now', '\'CURRENT_TIMESTAMP()\''); 
```

注意：要使函数正常工作，**需要**在参数集上加上额外的引号`CURRENT_TIMESTAMP()`。

或者干脆

```
$qb
    ->select('B')
    ->from('RandomBundle:Banana', 'B')
    ->where(
        $qb->expr()->gt('B.expiresAt', 'CURRENT_TIMESTAMP()')
    ); 
```

# c++ - Faster way to read file than boost::file_mapping?

> ID：13905789
> 
> 赞同：1
> 
> 时间：2012-12-16T21:48:18.523
> 
> 标签：c++, windows, file, memory, io

I'm writing a latency-sensitive app which reads a text file upon initialisation. I have profiled and re-written all my algorithms such that 85% of my execution time is from the lines:

```
boost::interprocess::file_mapping file(Path, read_only);
boost::interprocess::mapped_region data(file, read_only); 
```

I am writing this on windows- is there any faster way to map a file into memory? Portability is not a concern.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T22:22:34.320

您可以只使用 Win32 的本机功能，但我认为您不会节省很多，因为 boost 不会增加很多开销：

```
OFSTRUCT ofStruct;
ofStruct.cBytes=sizeof (OFSTRUCT);
HANDLE file=(HANDLE)OpenFile(fileName, &ofStruct, OF_READ); 
if (file==INVALID_HANDLE_VALUE) 
  handle errors
else {
  HANDLE map=CreateFileMapping(file, NULL, PAGE_READONLY, 0, 0, 0);
  if (map==INVALID_HANDLE_VALUE) 
    handle errors
  else {
    const char *p=(const char *)MapViewOfFile(map, FILE_MAP_READ, 0, 0, 0));
    if (p) {
      // enjoy using p to read access file contents.
    }
    // close all that handles now...
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T22:49:50.037

如果文件很小，只需使用标准 Win32 CreateFile()/ReadFile() API 打开并将它们读入内存。

如果您按顺序使用每个文件（或者可以按照您的方式排列代码），则应指定 FILE_FLAG_SEQUENTIAL_SCAN。这是文件/缓存子系统积极预读的提示。对于小文件，文件可能会在您第一次调用 ReadFile() 之前被读入缓存。

**编辑**：根据要求，这是一个片段，说明使用 Win32 API 将文件内容读入字节向量：

```
void ReadFileIntoBuffer( const std::wstring& fileName, std::vector< uint8_t >& output )
{
    HANDLE hFile( INVALID_HANDLE_VALUE );
    try 
    {
        // Open the file.
        hFile = CreateFile( filename.c_str(), 
                                 GENERIC_READ,
                                 FILE_SHARE_READ,
                                 NULL,
                                 OPEN_EXISTING, 
                                 FILE_FLAG_SEQUENTIAL_SCAN,
                                 NULL );
        if( INVALID_HANDLE_VALUE != hFile )
            throw std::runtime_error( "Failed to open file." );

        // Fetch size
        LARGE_INTEGER fileSize;
        if( !GetFileSizeEx( hFile, &fileSize ) );
            throw std::runtime_error( "GetFileSizeEx() failed." );

        // Resize output buffer.
        output.resize( fileSize.LowPart );

        // Read the file contents.
        ULONG bytesRead;
        if( !ReadFile( hFile, &output[0], fileSize.LowPart, &bytesRead, NULL ) )
            throw std::runtime_error( "ReadFile() failed." );

        // Recover resources.
        CloseHandle( hFile );
    }
    catch( std::exception& ) 
    {
        // Dump the error.
        std::cout << e.what() << " GetLastError() = " << GetLastError() << std::endl;

        // Recover resources.
        if( INVALID_HANDLE_VALUE != hFile )
            CloseHandle( hFile );

        throw;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T22:28:41.960

我建议放弃文件映射的想法。

FM 是一个复杂的结构，会增加一些开销。普通缓存读取还涉及与物理设备的重要交互。您可以进行无缓冲读取。可能接下来要问的是你真正想要什么样的 IO - 文件有多大？是顺序的吗？是在网络上吗？您可以选择硬件，还是在客户的机器上？

# jquery - Binding dynamic data to multiple axis Flot Graph

> ID：13905804
> 
> 赞同：1
> 
> 时间：2012-12-16T21:49:11.723
> 
> 标签：jquery, dynamic, flot

I am working on Flot- dynamic data and multiple axis graph. Having issue with binding of data with Y2-axis, I am able to bind the data to the graph if it is a static graph but when I try to do the binding with dynamic data for some reason data is always binding to default y-axis only and second y-axis is not reflecting anything. Please adivse, how to resolve this problem. Here is my code below.

```
<div id="placeholder" style="width:600px;height:300px;"></div> 

<script type="text/javascript"> 

var xVal = 0; 

var inputdata = [[], []]; 

var options = { xaxes: [{}], 
yaxes: [{}, { show: 

true, position: "right"}] 
}

var plot = $.plot($("#placeholder"), [{ data: inputdata[0], label: "series 1" }, { data: inputdata[1], label: "series 2", yaxis: 2}], options); 

function getData() { 

// This could be an ajax call back. 

var yVal1 = Math.floor(Math.random() * 11); 

var yVal2 = Math.floor(Math.random() * 11); 

var datum1 = [xVal, yVal1]; 

var datum2 = [xVal, yVal2]; 
inputdata[0].push(datum1);

inputdata[1].push(datum2);

if (inputdata[0].length > 10) { 
inputdata[0] = inputdata[0].splice(1);

inputdata[1] = inputdata[1].splice(1);

}

xVal++;

//alert("inputdata :" + inputdata); 
plot.setData(inputdata);

plot.setupGrid();

plot.draw();

//alert("plot.getAxes() " + plot.getAx ); 
}

setInterval(getData, 1000);

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T16:57:46.040

当您第一次调用 flot 时，您正在使用以下数据：

```
[{ data: inputdata[0], label: "series 1" }, 
 { data: inputdata[1], label: "series 2", yaxis: 2}
] 
```

在您的`getData`函数中，您生成的数据只是数组，没有标签，也没有 yaxis 值。这将覆盖您为第二个数据数组指定的内容。相反，在您的`getData`函数中，重现整个系列对象：

```
function getData() {
   //your code here

   plot.setData(    [{ data: inputdata[0], label: "series 1" }, 
                     { data: inputdata[1], label: "series 2", yaxis: 2}
                    ] 
   );
   plot.setupGrid();
   plot.draw();
} 
```

这里有一个工作示例：http: [//jsfiddle.net/ryleyb/hqeGg/](http://jsfiddle.net/ryleyb/hqeGg/)

# php - 防止 PHP 对象自动转换

> ID：13905806
> 
> 赞同：0
> 
> 时间：2012-12-16T21:49:36.437
> 
> 标签：php, object, casting

```
 class Foo 
{
    public $var ;

    function __construct($value) 
    {
         $this->var = $value ;
    }
}
$myFoo = new Foo('hello');
echo $myFoo->var . '<br>' ; // output : hello
// Question : how  can I prevent another programer from accidentaly doing the following
$myFoo = 4 ;
echo $myFoo ; // output : 4 
```

我的问题在评论中//问题：...

我希望我的同事能够将值分配给 $myFoo 仅使用 $myFoo->var （或类 Foo 中可用的任何公共突变体）

谢谢你

**编辑：** 对于声称不可能的用户，SPL_Types PECL 扩展能够（在一定程度上）实现这一点，例如[http://php.net/manual/en/class.splint.php](http://php.net/manual/en/class.splint.php)或[http ://blog.felixdv.com/2008/01/09/spl_types-in-php-and-strong-typing/](http://blog.felixdv.com/2008/01/09/spl_types-in-php-and-strong-typing/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T21:56:47.170

你不能用任何弱类型语言来做到这一点。如果你有将这个变量作为参数的函数，你可以在 PHP 中使用类型提示，否则你不能阻止人们重新分配他们的变量。

即使对于强类型语言也是如此。如果程序员创建了一个类的两个实例，则没有机制可以阻止他们将不同的实例分配给相同类型的变量。

发生这种情况的唯一方法是程序员显式使用*常量*而不是*变量*（例如`final`在 Java 或`val`Scala 中使用类似的东西），但是，无论哪种方式，您都无法在任何语言中控制它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:32:52.077

您无法阻止更改类中的类型，但如果您将其设为受保护或私有，然后添加 setVariable() 方法（其中 Variable 是您的变量名），您可以控制输入。就像是：

```
class myClass {
    protected $integer = 0;
    public function setInteger($new_value)
    {
        if (!is_int($new_value)) {
             throw new RuntimeException('Cannot assign non-integer value to myClass::$integer');
        }
        $this->integer = $new_value;
    }
    public function getInteger()
    {
        return $this->integer;
    }
}

// Now, outside of the class, the $integer property can only be changed using setInteger()
$class = new myClass;
$class->setInteger('dog'); // Uncaught Runtime exception ...
$class->setInteger(5);
echo $class->getInteger(); // 5 
```

该函数的另一个版本将接受字符串数字并将它们转换为整数：

```
 public function setInteger($new_value)
    {
        if (!is_numeric($new_value)) {
             throw new RuntimeException('Cannot assign non-integer value to myClass::$integer');
        }
        $this->integer = (int) $new_value;
    }
$class->setInteger('5'); // 5 
```

# css - CSS - 将相邻选择器与 nth-of-type 结合使用

> ID：13905813
> 
> 赞同：2
> 
> 时间：2012-12-16T21:50:09.370
> 
> 标签：css, css-selectors

我想要做的是在标题标签之后每隔四个 DIV 选择一次。这是我正在使用的代码的基本概念。

```
<div class="view-content"> 

   <h3>The Heading</h3> 
   <div></div>  
   <div></div>
   <div></div>
   <div>Trying to select this DIV</div>

   <h3>The Heading</h3> 
   <div></div>  
   <div></div>
   <div></div>

   <h3>The Heading</h3> 
   <div></div>  
   <div></div>
   <div></div>
   <div>Trying to select this DIV</div>  
   <div></div>
   <div></div>
   <div></div>
   <div>Trying to select this DIV</div>

</div><!-- .view-content --> 
```

我正在使用 Drupal，所以我仅限于编写 CSS 来安排内容。我试图选择每四个 DIV 的原因是因为一行有四个 DIV，我想从一行的第四个（也是最后一个）DIV 中删除右边距。有些行只有一个或两个 DIV，而其他行有十个或更多。

我最初编写的 CSS（似乎不起作用）是：

```
div.view-content h3 + div:nth-of-type(4n) {
margin-right: 0px;
} 
```

也许我想太多了，或者也许没有办法做到这一点。无论哪种方式，请帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:12:39.550

不幸的是，使用 CSS3 似乎[没有很好的通用方法](https://stackoverflow.com/a/9988264/139010)。从此处发布的其他答案中汲取灵感，您可以将其用于有限数量的元素：

```
div.view-content h3 + div+div+div+div,
div.view-content h3 + div+div+div+div + div+div+div+div,
div.view-content h3 + div+div+div+div + div+div+div+div + div+div+div+div /*etc*/ {
    margin-right: 0px;
} 
```

[http://cssdesk.com/Ty7Gf](http://cssdesk.com/Ty7Gf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:51:07.330

`h3 + div + div + div + div{background-color:red;}`

或匹配您的：

```
div.view-content h3 + div + div + div + div {
   margin-right: 0px;
} 
```

# php - 更新功能向我显示了 mysql/php 中的错误

> ID：13905814
> 
> 赞同：0
> 
> 时间：2012-12-16T21:50:36.560
> 
> 标签：php, mysql, sql

我的代码在更新部分有错误，它向我显示了这个错误：你的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '( reqdate= '2012-12-17',lat1= '26.18355762868919',long1= '50.30387832641602',lat' 附近使用正确的语法

这是我关于更新的代码：

```
if(mysql_fetch_array($query1))
{
$datex = strtotime(date('Y-m-d H:i:s'))+36000;
$time = date('H:i:s', $datex);
$date=date('Y-m-d', $datex);
$result=mysql_query("SELECT * FROM sensorusers  WHERE uid='$uid'");

mysql_query("UPDATE requests SET ( reqdate= '$date',lat1= '$lat1',long1= '$lng1',lat2= '$lat2',long2='$lng2',lat3='$lat3',long3='$lng3',lat4='$lat4',long4='$lng4',inout='$type',time='$time') WHERE  sid= '$drivers'") or die(mysql_error());

$Alpha  = @mysql_query($query2,$db); //Execute Query

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T21:51:54.943

只需删除括号，它肯定会执行，例如

```
UPDATE requests 
SET   reqdate = '$date',
      lat1    = '$lat1',
      long1   = '$lng1',
      lat2    ='$lat2', 
      long2   = '$lng2', 
      lat3    = '$lat3',
      long3   = '$lng3',
      lat4    = '$lat4',
      long4   = '$lng4',
      `inout` = '$type',    // << RESERVED KEYWORD
      time    = '$time' 
WHERE  sid    = '$drivers' 
```

`INOUT`是一个**[保留的关键字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)**。您应该使用反引号将其转义。

请注意，此代码易受攻击`SQL Injection`，请阅读下面的文章以了解如何防止它，

*   [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T21:52:54.147

### 语法错误

删除 SQL 中的`(`and `)`。

```
mysql_query("UPDATE requests SET `reqdate` = '$date',lat1= '$lat1',long1= '$lng1',lat2= '$lat2',long2='$lng2',lat3='$lat3',long3='$lng3',lat4='$lat4',long4='$lng4',inout='$type',time='$time' WHERE  sid= '$drivers'") or die(mysql_error()); 
```

另外，考虑使用`PDO`or`mysqli_*`函数而不是`mysql_*`函数。

# hibernate - Spring 3 + Hibernate + JPA + Spring Security 3.1

> ID：13905823
> 
> 赞同：0
> 
> 时间：2012-12-16T21:51:47.450
> 
> 标签：hibernate, jpa, spring-mvc, heroku, spring-security

I am currently have trouble with implementing Spring 3 + Hibernate + JPA + Spring Security 3.1 solution.

Here is my web.xml

```
 <?xml version="1.0" encoding="UTF-8"?>
       <web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com    /xml/ns/javaee/web-app_2_5.xsd"
 xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns  /javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">

<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath:security-context.xml</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<!-- <listener>
    <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
</listener> -->

<servlet>
    <servlet-name>spring</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:applicationContext.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

Here is my Application Context

```
 <?xml  version="1.0" encoding="UTF-8"?>
 <beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    xmlns:jdbc="http://www.springframework.org/schema/jdbc"
xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                       http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc.xsd
                       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
                       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
                       http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd">

<context:annotation-config />
<context:component-scan base-package="com.muuves.reservosity" />

<mvc:annotation-driven />
<bean id="tilesConfigurer"
    class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
    <property name="definitions">
        <list>
            <value>/WEB-INF/tiles/tiles.xml</value>
        </list>
    </property>
</bean>

<bean class="org.springframework.web.servlet.view.tiles2.TilesViewResolver">
    <property name="viewClass"
        value="org.springframework.web.servlet.view.tiles2.TilesView" />
</bean>

<tx:annotation-driven />

<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
    <property name="dataSource" ref="dataSource" />

</bean>

<beans profile="prod">
    <bean class="java.net.URI" id="dbUrl">
        <constructor-arg value="#{systemEnvironment['CLEARDB_DATABASE_URL']}" />
    </bean>

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
        <property name="url"
            value="#{ 'jdbc:mysql://' + @dbUrl.getHost() + @dbUrl.getPath() }" />
        <property name="username" value="#{ @dbUrl.getUserInfo().split(':')[0] }" />
        <property name="password" value="#{ @dbUrl.getUserInfo().split(':')[1] }" />
    </bean>

    <bean id="entityManagerFactory"
        class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
        </property>
        <property name="jpaProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <!-- change this to 'verify' before running as a production app -->
                <prop key="hibernate.hbm2ddl.auto">update</prop>
                <prop key="hibernate.connection.pool_size">10</prop>
                <prop key="hibernate.current_session_context_class">thread</prop>
            </props>
        </property>
    </bean>
</beans> 
```

Here is my security-context

```
 <?xml version="1.0" encoding="UTF-8"?>
  <beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:security="http://www.springframework.org/schema/security"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/beans
                       http://www.springframework.org/schema/beans/spring-beans.xsd
                       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
                       http://www.springframework.org/schema/security
                       http://www.springframework.org/schema/security/spring-security-3.1.xsd">
<security:global-method-security
    secured-annotations="enabled" />

<security:http auto-config='true'>
    <security:intercept-url pattern="/welcome*"
        access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <security:intercept-url pattern="/secure/**"
        access="ROLE_USER" requires-channel="https" />
    <security:intercept-url pattern="/**" access="ROLE_USER"
        requires-channel="any" />
</security:http>

<!-- <security:authentication-manager> <security:authentication-provider> 
    <security:user-service> <security:user name="mkyong" password="123456" authorities="ROLE_USER" 
    /> </security:user-service> </security:authentication-provider> </security:authentication-manager> -->

<bean id="AccessService"  class="com.muuves.reservosity.service.AccessService" />

<security:authentication-manager> <security:authentication-provider 
    user-service-ref="AccessService"> <security:password-encoder hash="md5" /> 
    </security:authentication-provider> </security:authentication-manager> 
```

```
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import java.util.logging.Logger;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

import org.springframework.dao.DataAccessException;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.transaction.annotation.Transactional;

import com.muuves.reservosity.model.Company_Details;

@Transactional(readOnly = true)
@Service
public class AccessService implements UserDetailsService{

private final static Logger LOG = Logger.getLogger(AccessService.class.getName()); 

@PersistenceContext
EntityManager em;

@Override
public UserDetails loadUserByUsername(String username)   throws DataAccessException{
    LOG.info("loadUserByUsername");
    LOG.info(username);
    Company_Details domainUser = em.find(Company_Details.class, 1);
    LOG.info(username);
    LOG.info(domainUser.getEmail());
    LOG.info(domainUser.getPassword());
    boolean enabled = true;
    boolean accountNonExpired = true;
    boolean credentialsNonExpired = true;
    boolean accountNonLocked = true;

    return new User("ahobbsy@gmail.com", "test1234", enabled, accountNonExpired,
            credentialsNonExpired, accountNonLocked,
            getAuthorities(1));
}

/**
 * Retrieves a collection of {@link GrantedAuthority} based on a numerical
 * role
 * 
 * @param role
 *            the numerical role
 * @return a collection of {@link GrantedAuthority

 */
public Collection<? extends GrantedAuthority> getAuthorities(Integer role) {
    List<GrantedAuthority> authList = getGrantedAuthorities(getRoles(role));
    return authList;
}

/**
 * Converts a numerical role to an equivalent list of roles
 * 
 * @param role
 *            the numerical role
 * @return list of roles as as a list of {@link String}
 */
public List<String> getRoles(Integer role) {
    List<String> roles = new ArrayList<String>();

    if (role.intValue() == 1) {
        roles.add("ROLE_USER");
        roles.add("ROLE_ADMIN");

    } else if (role.intValue() == 2) {
        roles.add("ROLE_USER");
    }

    return roles;
}

/**
 * Wraps {@link String} roles to {@link SimpleGrantedAuthority} objects
 * 
 * @param roles
 *            {@link String} of roles
 * @return list of granted authorities
 */
public static List<GrantedAuthority> getGrantedAuthorities(
        List<String> roles) {
    List<GrantedAuthority> authorities = new ArrayList<GrantedAuthority>();
    for (String role : roles) {
        authorities.add(new SimpleGrantedAuthority(role));
    }
    return authorities;
} 
```

}

Here is my WEB-INF/persistent.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
         version="2.0">

<persistence-unit name="dataSource" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider> 
</persistence-unit>

</persistence> 
```

Here's my pom.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org   /2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org  /xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>com.example</groupId>
<artifactId>spring-hibernate-template</artifactId>
<packaging>war</packaging>
<version>0.0.1-SNAPSHOT</version>

<properties>
    <org.springframework.version>3.1.1.RELEASE</org.springframework.version>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
</properties>

<dependencies>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>javax.servlet-api</artifactId>
        <version>3.0.1</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>taglibs</groupId>
        <artifactId>standard</artifactId>
        <version>1.1.2</version>
    </dependency>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency>
    <dependency>
        <groupId>org.hsqldb</groupId>
        <artifactId>hsqldb</artifactId>
        <version>2.2.8</version>
    </dependency>
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.20</version>
    </dependency>
    <dependency>
        <groupId>commons-dbcp</groupId>
        <artifactId>commons-dbcp</artifactId>
        <version>1.4</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>3.6.10.Final</version>
    </dependency>
    <dependency>
        <groupId>com.github.jsimone</groupId>
        <artifactId>webapp-runner</artifactId>
        <version>7.0.27.1</version>
        <scope>provided</scope>
    </dependency>

    <!-- Tiles dependency -->
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-core</artifactId>
        <version>2.2.1</version>
    </dependency>

    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-jsp</artifactId>
        <version>2.2.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-api</artifactId>
        <version>2.2.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-servlet</artifactId>
        <version>2.2.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-template</artifactId>
        <version>2.2.1</version>
    </dependency>

    <!-- Security -->
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-core</artifactId>
        <version>3.1.3.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-web</artifactId>
        <version>3.1.3.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-config</artifactId>
        <version>3.1.3.RELEASE</version>
    </dependency>
</dependencies>

<build>
    <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>
        <plugin>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.2</version>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <version>2.4</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>copy</goal>
                    </goals>
                    <configuration>
                        <artifactItems>
                            <artifactItem>
                                <groupId>com.github.jsimone</groupId>
                                <artifactId>webapp-runner</artifactId>
                                <version>7.0.27.1</version>
                                   <destFileName>webapp-runner.jar</destFileName>
                            </artifactItem>
                        </artifactItems>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

Don't know why its not working, not sure why I have to create a id for AccessService as I thought it would pick it up by its Annotation!!! Seriously lost with this and have tried so many different examples on the web it would be great if somebody could help me out!!

I have Spring, hibernate and JPA working, i have Spring, hibernate and JPA and hardcoded spring security implementation

```
 <security:authentication-manager> <security:authentication-provider> 
 <security:user-service> <security:user name="mkyong" password="123456"  authorities="ROLE_USER" /> 
   </security:user-service> 
 </security:authentication-provider> </security:authentication-manager> 
```

I can't link up the implementation of hibernate and spring security

Thanks

Andrew

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T06:23:05.833

我在 mp 应用程序中使用 Spring + Hibernate + JPA + Spring Security，并通过将问题分解为小步骤来使其工作。这是我推荐的。

*   第 1 步：在您的应用程序中使用 Spring 配置 JPA 和 Hiberante 使其正常工作，当您在发布这些问题时遇到问题
*   第 2 步：让 spring security 工作并在遇到配置时发布特定问题。

回答一个狭隘的特定问题比回答一般问题要容易得多。

# r - 使用 data.table 创建一列回归系数

> ID：13905825
> 
> 赞同：4
> 
> 时间：2012-12-16T21:51:48.957
> 
> 标签：r, data.table

我正在努力解决似乎应该是我在[这里](https://stackoverflow.com/questions/13867855/ddply-slow-when-used-to-aggregate-by-date-over-factor-variable)问过的上一个问题的简单扩展。

我正在尝试汇总（a）一系列日期和（b）一个因子变量。样本数据可能是：

```
Brand    Day     Rev     RVP              
  A      1        2535.00  195.00 
  B      1        1785.45  43.55 
  C      1        1730.87  32.66 
  A      2        920.00   230.00
  B      2        248.22   48.99 
  C      3        16466.00 189.00      
  A      1        2535.00  195.00 
  B      3        1785.45  43.55 
  C      3        1730.87  32.66 
  A      4        920.00   230.00
  B      5        248.22   48.99 
  C      4        16466.00 189.00 
```

感谢有用的建议，我想出了如何使用 data.table 找到品牌在几天内的平均收入：

```
new_df<-df[,(mean(Rev)), by=list(Brand,Day)] 
```

现在，我想创建一个新表，其中有一列列出了每个品牌的 Rev by Day 的 OLS 回归的系数估计值。我试图这样做如下：

```
new_df2<-df[,(lm(Rev~Day)), by=list(Brand)] 
```

这似乎不太对劲。想法？我敢肯定，我错过了一些明显的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-16T22:42:21.113

你有几个选择。

您可以将整个模型对象保存为 data.table 中的列表

```
models <- df[,   list(model  = list(lm(Rev ~ Day))),by = Brand]

models
   Brand model
1:     A  <lm>
2:     B  <lm>
3:     C  <lm>

# look at the models
models[,print(model[[1]]),by= Brand]

Call:
lm(formula = Rev ~ Day)

Coefficients:
(Intercept)          Day  
     2804.2       -538.3  

Call:
lm(formula = Rev ~ Day)

Coefficients:
(Intercept)          Day  
     1741.5       -263.5  

Call:
lm(formula = Rev ~ Day)

Coefficients:
(Intercept)          Day  
      -3698         4653 
```

您可以保存系数

```
models[, {coefs <- coef(model[[1]])
      list(coefs = coefs, name = names(coefs))}, by = Brand]
##     Brand      coefs        name
## 1:     A  2804.1667 (Intercept)
## 2:     A  -538.3333         Day
## 3:     B  1741.5291 (Intercept)
## 4:     B  -263.5251         Day
## 5:     C -3697.8621 (Intercept)
## 6:     C  4653.1989         Day 
```

或者您可以只提取模型列表

```
 models[,model] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-16T22:42:41.157

我认为这就是你想要的：

```
new_df2<-df[,(lm(Rev~Day)$coefficients[["Day"]]), by=list(Brand)] 
```

`lm`返回一个完整的模型对象，您需要深入研究它以从可以变成一列的每个组中获取单个值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-17T00:17:00.057

```
> DF <- read.table(text="Brand    Day     Rev     RVP              
+   A      1        2535.00  195.00 
+   B      1        1785.45  43.55 
+   C      1        1730.87  32.66 
+   A      2        920.00   230.00
+   B      2        248.22   48.99 
+   C      3        16466.00 189.00      
+   A      1        2535.00  195.00 
+   B      3        1785.45  43.55 
+   C      3        1730.87  32.66 
+   A      4        920.00   230.00
+   B      5        248.22   48.99 
+   C      4        16466.00 189.00", header=TRUE)
> DT <- data.table(DF)
> Mod.tbl<-DT[, list(mod=list(lm(Rev~Day))), by=list(Brand)]
> Mod.tbl[ , coef(mod[[1]])["Day"], by= Brand]
   Brand           V1
1:     A -538.3333333
2:     B -263.5251429
3:     C 4653.1989474 
```

# sql-server - SQL Server Management Studio - 从触发器打印未显示

> ID：13905828
> 
> 赞同：1
> 
> 时间：2012-12-16T21:52:07.770
> 
> 标签：sql-server, tsql, printing, triggers

我对 Management Studio 的行为感到困惑。我创建了一个简单的测试触发器（更新操作），它应该向消息选项卡显示消息（打印），但没有消息选项卡出现，我看不到任何输出。如果我执行任何其他查询没关系，我可以看到结果选项卡和消息选项卡。触发器本身可以工作（数据正在更改）。

这是我的代码：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER TRIGGER [dbo].[Trigger1]
ON [dbo].[TestTable]
FOR UPDATE
AS
    PRINT ('YAHOOOOO!!!') /* can't see this message */
    UPDATE TestTable
    SET    TestData = 'testitem'
    WHERE  (TestId = 2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:11:46.673

2个问题

1.  您的触发器将导致“递归过多”错误，因为它尝试更新表（在触发器内），该表再次调用触发器，然后尝试更新表，然后调用触发器......无限期（理论上）。实际上，SQL Server 在检测到错误后将其杀死。

2.  “编辑前 200 行”是一项特殊功能，它有自己的消息窗口，因此您看不到任何输出。您需要在新的查询窗口中运行您的代码。

在新的查询窗口中，重新定义触发器，如下所示：

```
ALTER TRIGGER [dbo].[Trigger1]
ON [dbo].[TestTable]
FOR UPDATE
AS
    PRINT 'YAHOOOOO!!!'; /* can't see this message */
GO 
```

然后，自行运行此 UPDATE 语句。

```
UPDATE TestTable
SET    TestData = 'testitem'
WHERE  TestId = 2; 
```

*注意：去掉多余的括号。*

# prolog - Prolog - 拉丁方解

> ID：13905832
> 
> 赞同：3
> 
> 时间：2012-12-16T21:52:41.930
> 
> 标签：prolog, clpfd, latin-square

我正在尝试在 Prolog 中编写一个程序来找到一个大小为 N 的拉丁方。

我现在有这个：

```
delete(X, [X|T], T).
delete(X, [H|T], [H|S]) :-
   delete(X, T, S).

permutation([], []).
permutation([H|T], R) :-
   permutation(T, X),
   delete(H, R, X).

latinSqaure([_]).
latinSquare([A,B|T], N) :-
   permutation(A,B),
   isSafe(A,B),
   latinSquare([B|T]).

isSafe([], []).
isSafe([H1|T1], [H2|T2]) :- 
   H1 =\= H2, 
   isSafe(T1, T2). 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T23:03:55.133

使用 SWI-Prolog 库：

```
:- module(latin_square, [latin_square/2]).
:- use_module(library(clpfd), [transpose/2]).

latin_square(N, S) :-
    numlist(1, N, Row),
    length(Rows, N),
    maplist(copy_term(Row), Rows),
    maplist(permutation, Rows, S),
    transpose(S, T),
    maplist(valid, T).

valid([X|T]) :-
    memberchk(X, T), !, fail.
valid([_|T]) :- valid(T).
valid([_]). 
```

测试：

```
?- aggregate(count,S^latin_square(4,S),C).
C = 576. 
```

**编辑**您的代码，一旦更正删除拼写错误，它就是一个*验证器*，而不是一个生成器，但是（正如 ssBarBee 在已删除的评论中所指出的那样），它存在缺陷，因为缺少对不相邻行的测试。这里是更正的代码

```
delete(X, [X|T], T).
delete(X, [H|T], [H|S]) :-
    delete(X, T, S).

permutation([], []).
permutation([H|T], R):-
    permutation(T, X),
    delete(H, R, X).

latinSquare([_]).
latinSquare([A,B|T]) :-
    permutation(A,B),
    isSafe(A,B),
    latinSquare([B|T]).

isSafe([], []).
isSafe([H1|T1], [H2|T2]) :-
    H1 =\= H2,
    isSafe(T1, T2). 
```

和一些测试

```
?- latinSquare([[1,2,3],[2,3,1],[3,2,1]]).
false.

?- latinSquare([[1,2,3],[2,3,1],[3,1,2]]).
true .

?- latinSquare([[1,2,3],[2,3,1],[1,2,3]]).
true . 
```

注意最后一次测试它是错误的，应该`false`改为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-19T09:11:45.340

像@CapelliC 一样，我建议为此使用 CLP(FD) 约束，这些约束在所有严肃的 Prolog 系统中都可用。

事实上，考虑更普遍地使用约束，以从约束传播中受益。

例如：

```
:- use_module(library(clpfd)).

latin_square(N, Rows, Vs) :-
        length(Rows, N),
        maplist(same_length(Rows), Rows),
        maplist(all_distinct, Rows),
        transpose(Rows, Cols),
        maplist(all_distinct, Cols),
        append(Rows, Vs),
        Vs ins 1..N. 
```

例如，计算 的所有解决方案`N = 4`：

```
?- findall(., (latin_square(4,_,Vs),labeling([ff],Vs)), Ls), 长度(Ls, L)。
L = 576 ,
LS = [...]。

```

CLP(FD) 版本比其他版本快得多。

请注意，将核心关系与实际搜索分开是一种很好的做法`labeling/2`。这使您可以快速看到核心关系也终止于较大的`N`：

```
?- latin_square(20, _, _), 假的。
错误的。

```

因此，我们直接看到 this 终止，因此 this 加上任何后续搜索`labeling/2`都可以保证找到所有解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-20T10:03:18.763

我有更好的解决方案，@CapelliC 代码对于 N 长度大于 5 的正方形需要很长时间。

```
:- use_module(library(clpfd)).

make_square(0,_,[]) :- !.
make_square(I,N,[Row|Rest]) :-
   length(Row,N),
   I1 is I - 1,
   make_square(I1,N,Rest).

 all_different_in_row([]) :- !.
 all_different_in_row([Row|Rest]) :-
    all_different(Row),
    all_different_in_row(Rest).

all_different_in_column(Square) :-
   transpose(Square,TSquare),
   all_different_in_row(TSquare).   

all_different_in_column1([[]|_]) :- !.
all_different_in_column1(Square) :-
   maplist(column,Square,Column,Rest),
   all_different(Column),
   all_different_in_column1(Rest).

   latin_square(N,Square) :-
   make_square(N,N,Square),
   append(Square,AllVars),
   AllVars ins 1..N,
   all_different_in_row(Square),
   all_different_in_column(Square),
   labeling([ff],AllVars). 
```

# php - 在zend中更改菜单栏

> ID：13905843
> 
> 赞同：0
> 
> 时间：2012-12-16T21:54:13.720
> 
> 标签：php, zend-framework, menubar

嗨，

我已经设法在 Zend Framework 中制作了一个顶部菜单栏，并将代码放置在 中`layouts/scripts/layout.phtml`，并且我有以下项目：`Item1`, `Item2`, `Item3`, `Login`, `Register`. 我想要的是，当有人登录时，要更改最后两个元素`Login`，`Register`用`Logout`. 有人可以帮我做点什么吗？我读了一些关于占位符的东西，但我并不清楚它们。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T02:15:01.840

由于听起来您正在`Zend_Navigation`为菜单使用视图脚本（而不是 ），因此在以下内容中包含如下检查应该相对简单`layouts/scripts/layout.phtml`：

```
// Render your static menu elements
// render, render

// Now handle the dynamic part
if (!Zend_Auth::getInstance()->hasIdentity()){
    // Render the `Register` and `Login` links.
} else {
    // Render your `Logout` link.
} 
```

# c# - 我正在使用 PdfSharp 并且找不到类 BeginBox 它在哪里？

> ID：13905849
> 
> 赞同：15
> 
> 时间：2012-12-16T21:56:01.053
> 
> 标签：c#, pdfsharp

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Diagnostics;
using System.IO;
using System.Drawing;
using PdfSharp;
using PdfSharp.Drawing;
using PdfSharp.Pdf;
using PdfSharp.Pdf.IO;

namespace Lightnings_Extractor
{
    class PDF
    {
        public PDF()
        {
            // Create a new PDF document
            PdfDocument document = new PdfDocument();
            document.Info.Title = "Created with PDFsharp";

            // Create an empty page
            PdfPage page = document.AddPage(); 
            // Get an XGraphics object for drawing
            XGraphics gfx = XGraphics.FromPdfPage(page); 
            // Create a font
            XFont font = new XFont("Verdana", 20, XFontStyle.BoldItalic); 
            // Draw the text
            gfx.DrawString("Hello, World!", font, XBrushes.Black,
            new XRect(0, 0, page.Width, page.Height),
            XStringFormats.Center); 
            // Save the document...
            const string filename = @"d:\HelloWorld.pdf";
            document.Save(filename);
            // ...and start a viewer.
            Process.Start(filename);
        }

        private void DrawImage(XGraphics gfx, int number)
        {
        }
    }
} 
```

我正在从这个链接中获取样本：[http](http://www.pdfsharp.net/wiki/Graphics-sample.ashx) ://www.pdfsharp.net/wiki/Graphics-sample.ashx 那里有一个样本：以原始大小绘制图像

```
void DrawImage(XGraphics gfx, int number)
{
  BeginBox(gfx, number, "DrawImage (original)");

  XImage image = XImage.FromFile(jpegSamplePath);

  // Left position in point
  double x = (250 - image.PixelWidth * 72 / image.HorizontalResolution) / 2;
  gfx.DrawImage(image, x, 0);

  EndBox(gfx);
} 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-16T21:59:44.740

`BeginBox`并且是[在示例页面底部](http://www.pdfsharp.net/wiki/Graphics-sample.ashx#Draw_the_box_around_the_samples_29)`EndBox`定义的辅助方法。

请注意，这些方法仅用于创建周围的框，可能不是实现您真正想要的功能所需的（在这种情况下，以原始大小绘制图像）。所以我会从代码中删除这两行。

```
public void BeginBox(XGraphics gfx, int number, string title)
{
  const int dEllipse = 15;
  XRect rect = new XRect(0, 20, 300, 200);
  if (number % 2 == 0)
    rect.X = 300 - 5;
  rect.Y = 40 + ((number - 1) / 2) * (200 - 5);
  rect.Inflate(-10, -10);
  XRect rect2 = rect;
  rect2.Offset(this.borderWidth, this.borderWidth);
  gfx.DrawRoundedRectangle(new XSolidBrush(this.shadowColor), rect2, new XSize(dEllipse + 8, dEllipse + 8));
  XLinearGradientBrush brush = new XLinearGradientBrush(rect, this.backColor, this.backColor2, XLinearGradientMode.Vertical);
  gfx.DrawRoundedRectangle(this.borderPen, brush, rect, new XSize(dEllipse, dEllipse));
  rect.Inflate(-5, -5);

  XFont font = new XFont("Verdana", 12, XFontStyle.Regular);
  gfx.DrawString(title, font, XBrushes.Navy, rect, XStringFormats.TopCenter);

  rect.Inflate(-10, -5);
  rect.Y += 20;
  rect.Height -= 20;

  this.state = gfx.Save();
  gfx.TranslateTransform(rect.X, rect.Y);
}

public void EndBox(XGraphics gfx)
{
  gfx.Restore(this.state);
} 
```

# jquery - 使用咖啡脚本的 Rails jQuery 自动完成

> ID：13905850
> 
> 赞同：0
> 
> 时间：2012-12-16T21:56:03.183
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, jquery-ui, coffeescript

我正在尝试使用 jquery UI 自动完成工作，但它似乎没有被触发。

hashtag.js.coffee 正在加载到 application.js 中。控制台中也没有抛出错误

**hashtag.js.coffee**

```
$('.swag_text_field').autocomplete
source: ['foo', 'food', 'four'] 
```

**看法**

```
<%= form_tag hashtags_path, class: "search-form", remote: true do %>
            <div class="input-prepend input-append">
            <span class="add-on swag">#</span>

            <%= text_field_tag :hashtag, nil, class: "span4 swag_text_field", id:"appendedPrependedInput" %>

            <%= submit_tag "VS!", class: "btn add-on-right swag_button" %>
            <% end %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T22:19:09.607

原来咖啡脚本是空白敏感的。

```
 jQuery ->
        $('.swag_text_field').autocomplete
            source: ['foo', 'food', 'four'] 
```

# clojure - Church 数字的阶乘函数

> ID：13905851
> 
> 赞同：4
> 
> 时间：2012-12-16T21:56:11.493
> 
> 标签：clojure, lambda, functional-programming, factorial, y-combinator

[我正在尝试实现Lambda-calculus, Combinators and Functional Programming](https://rads.stackoverflow.com/amzn/click/com/0521114292)一书中描述的阶乘 lambda 表达式

它的描述方式是：

```
fact = (Y)λf.λn.(((is-zero)n)one)((multiply)n)(f)(predecessor)n
Y = λy.(λx.(y)(x)x)λx.(y)(x)x 
```

在哪里

```
(x)y is equivalent to (x y) and
(x)(y)z is equivalent to (x (y x)) and
λx.x is equivalent to (fn [x] x) 
```

和`is-zero`, `one`,`multiply`和`predecessor`是为标准教会数字定义的。实际定义[在这里](http://pastie.org/5541183)。

我将其翻译为以下内容

```
(defn Y-mine [y]        ;  (defn Y-rosetta [y]              
  ((fn [x] (y (x x)))   ;    ((fn [f] (f f))                
    (fn [x]             ;     (fn [f]                       
      (y                ;       (y (fn [& args]             
        (x x)))))       ;            (apply (f f) args)))))) 
```

和

```
(def fac-mine                                ; (def fac-rosetta
  (fn [f]                                    ;      (fn [f]
    (fn [n]                                  ;        (fn [n]
      (is-zero n                             ;          (if (zero? n)
        one                                  ;            1
        (multiply n (f (predecessor n))))))) ;            (* n (f (dec n))))))) 
```

注释掉的版本是[Rosetta 代码](http://rosettacode.org/wiki/Y_combinator#Clojure)中的等效 fac 和 Y 函数。

**问题一：**

我从其他地方的阅读中了解到`Y-rosetta`β-减少到`Y-mine`. 在这种情况下，为什么最好使用那个而不是另一个？

**问题2：**

即使我使用`Y-rosetta`. 我尝试时收到 StackOverflowError

```
((Y-rosetta fac-mine) two) 
```

尽管

```
((Y-rosetta fac-rosetta) 2) 
```

工作正常。

无人看管的递归发生在哪里？

我怀疑这与`if`表单在 clojure 中的工作方式有关，这并不完全等同于我的`is-zero`实现。但我自己无法找到错误。

谢谢。

**更新：**

考虑到@amalloy 的回答，我`fac-mine`稍作改变以采取懒惰的论点。我对clojure不是很熟悉，所以这可能不是正确的方法。但是，基本上，我`is-zero`采用匿名零参数函数并评估它返回的任何内容。

```
(def lazy-one (fn [] one))
(defn lazy-next-term [n f]
  (fn []
    (multiply n (f (predecessor n)))))

(def fac-mine                       
  (fn [f]                           
    (fn [n]                         
      ((is-zero n                   
        lazy-one                    
        (lazy-next-term n f)))))) 
```

我现在收到一条错误消息：

```
=> ((Y-rosetta fac-mine) two)
ArityException Wrong number of args (1) passed to: core$lazy-next-term$fn  clojure.lang.AFn.throwArity (AFn.java:437) 
```

考虑到`lazy-next-term`总是用`n`and调用这似乎真的很奇怪`f`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T00:41:26.433

的主体`fac-mine`看起来不对：它调用`(is-zero n one)`副作用，然后无条件调用`(multiply n (f (predecessor n)))`. 大概你想要一个有条件的选择（虽然我不明白为什么这不会抛出一个异常，给定你的定义`is-zero`）。

# ios - 如何获得顶部视图控制器的标题？

> ID：13905852
> 
> 赞同：2
> 
> 时间：2012-12-16T21:56:18.543
> 
> 标签：ios, uiviewcontroller, title, visible

我想获取顶部视图控制器的标题，以便可以将其与字符串进行比较，并根据此比较采取适当的措施。我目前正在执行以下操作，但标题始终返回为 null。

```
UIViewController *viewController = self.viewController.homeViewController;

while (viewController.presentedViewController) 
    viewController = viewController.presentedViewController;

NSLog(@"top viewController title %@", viewController.navigationItem.title); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T22:07:46.237

尝试这个：

```
NSLog(@"%@", self.viewController.homeViewController.title); 
```

该`title`属性应该是视图控制器本身的属性。

# c++ - 3D 游戏中的关卡编辑器和事件编辑器

> ID：13905856
> 
> 赞同：2
> 
> 时间：2012-12-16T21:57:25.160
> 
> 标签：c++, scripting

我一直在阅读，但我找不到具体的答案。我正在编写一个 3d 游戏，该游戏需要在关卡设计和脚本事件方面具有更高级别的编辑视图。与其说是关卡设计，不如说是能够导入角色和事件，还有更可视化的 IDE 游戏开发程序（Unity、游戏制造商、RPG 制造商）。我将如何实现这一目标？我假设它需要一个脚本集成，首先，允许实时编辑，例如使用 Lua 或 C#（我将主要用 C++ 进行编程）。而且我还想知道这是与主应用程序分开设计的东西。Aka，无论您在此编辑器中设计什么，您都可以将其“导出”为主游戏程序可读的形式。

# php - 在 PHP 5.5 中生成密码哈希并设置成本选项

> ID：13905857
> 
> 赞同：18
> 
> 时间：2012-12-16T21:57:32.867
> 
> 标签：php, passwords, bcrypt, php-password-hash

我知道 PHP 5.5 处于 alpha 阶段，但我正在制作的这个类只是提前制作，以通过使用 function_exists() 来利用它的散列功能。

我查看了[`password_hash`](http://php.net/password_hash)文档。第三个参数是 $options 目前支持两个选项，'salt' 和 'cost'。

它声明如下：

> cost，表示应该使用的算法成本。这些值的示例可以在 crypt() 页面上找到。

当我转到 crypt() 页面时，它提供的文档是：

> 使用盐的河豚散列如下：“$2a$”、“$2x$”或“$2y$”、两位数的成本参数、“$”和字母表中的 22 位数字“./0-9A-Za” -z”。在 salt 中使用超出此范围的字符将导致 crypt() 返回零长度字符串。两位数的成本参数是底层基于 Blowfish 的散列算法的迭代计数的以 2 为底的对数，必须在 04-31 范围内，超出此范围的值将导致 crypt() 失败。5.3.7 之前的 PHP 版本仅支持“$2a$”作为 salt 前缀：PHP 5.3.7 引入了新前缀以修复 Blowfish 实现中的安全漏洞。请参阅 » 本文档以获取有关安全修复的完整详细信息，但总而言之，开发人员仅针对 PHP 5.3。

我似乎无法理解这一点。它说 PHP 5.3.7 和更高版本应该使用 $2y$，但是我用什么成本值来获得那个，它是最好的选择吗？他们提供的示例使用了 7 的值，但根据上述它可以上升到 31，使用say 4 与 say 31 有什么区别？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-17T10:30:55.163

该函数`password_hash()`只是该函数的一个包装器`crypt()`，应该使它更容易正确使用。它负责生成安全的随机盐，并提供良好的默认值。

使用此功能的最简单方法是：

```
$hash = password_hash($password, PASSWORD_DEFAULT); 
```

这意味着，该函数将使用 BCrypt（算法`2y`）对密码进行哈希处理，生成随机盐，并使用默认成本（目前为 10）。这些都是很好的默认值，特别是我**不会**生成你自己的盐，在那里很容易出错。

如果您想更改成本参数，您可以这样做：

```
$hash = password_hash($password, PASSWORD_BCRYPT, ["cost" => 11]); 
```

将成本参数增加 1，计算哈希值所需的时间加倍。成本参数是迭代次数的对数（以 2 为底），这意味着：

```
$iterations = 2 ^ $cost; 
```

编辑：

I missed the point, that you want to generate your own class. For PHP version 5.3.7 and later, there exists a [compatibility pack](https://github.com/ircmaxell/password_compat/blob/master/lib/password.php), from the same author that made the `password_hash()` function. You can either use this code directly, or look at the well crafted implementation. For PHP versions before 5.3.7 there is no support for `crypt` with `2y`, the unicode aware BCrypt algorithm. You can instead use `2a`, which is the best alternative for earlier PHP versions. I did an [example](http://www.martinstoeckli.ch/php/php.html#bcrypt) with a lot of comments, maybe you want to have a look at it too.

P.S. The expressions "salt" and "cost factor" are used correctly in `password_hash()`, the crypt() function though, uses the word salt for all crypt parameters together, that's a bit misleading.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T22:39:59.077

免责声明：这是 PHP *5.3.10*，但它似乎与您的描述并没有什么不同。

成本适用于计算成本。当您增加成本值时，哈希密码需要更长的时间

```
function blowfish_salt($cost)
{
    $chars = './ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    $salt = sprintf('$2y$%02d$', $cost);
    for ($i = 0; $i < 22; ++$i)
        $salt .= $chars[rand(0,63)];

    return $salt;
}

$password = 'My perfect password';
$cost = $argv[1];
$salt = blowfish_salt($cost);
$hash = crypt($password, $salt); 
```

当我在我的（旧）机器上运行它时

```
php mycrypt.php 10 
```

它立即返回（~0.2 秒），而

```
php mycrypt.php 16 
```

大约需要 5.2 秒。

# ios - 不正确的 Popover 大小 - 在 Popover 中的 Navigation Controller 下显示 UITableViews 时

> ID：13905858
> 
> 赞同：0
> 
> 时间：2012-12-16T21:57:41.403
> 
> 标签：ios, ipad, uinavigationcontroller, uitableview, uipopovercontroller

我正在编写一个 iPad 应用程序，该应用程序具有在 UIPopoverController 内的导航控制器下显示的 UITableViews。

当我在我的应用程序的主视图控制器中选择一个按钮时，会显示弹出框。弹出窗口打开显示第一个 TableViewController，它有两行 (UITableViewCells) - 第一行是“搜索”，第二行是“高级设置”。在初始显示时，弹出框的大小刚好足以显示两行。

我已经对第一个 TableViewController 的 didSelectRowAtIndexPath 进行了编码，这样当我选择“搜索”时，它会将第二个 TableViewController 推送到 NavigationViewController 上。下一个 View Controller 允许用户执行搜索，然后搜索结果会填充到其 tableview 中。）这个（搜索结果）table view controller 的大小足以容纳搜索返回的所有行。因此，在显示搜索 tableview 控制器时，搜索弹出框会变得更长。

当我取消搜索（或点击导航栏中的后退按钮）时，弹出框返回显示第一个表格视图控制器（只有两行的那个）。然而，这个第一个表视图控制器现在具有更长的尺寸。换句话说，弹出框不会将自身调整回两行表，而是保持第二个（搜索结果）表视图控制器的大小（因此它现在有两行“搜索”和“高级设置”加上一个数字空行）

我的问题是：如何在此实现中获取层次结构中的每个表视图控制器（即表视图控制器显示在导航控制器下的弹出窗口中）单独调整大小并在用户导航返回时返回其原始大小和向前。可能有一个简单的解决方案，但它逃脱了我！感谢有人能指出我的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-03T17:56:11.277

由于上述解决方案不再起作用，这里有一个更流行的（Swift）替代方案。

您可以将popovercontroller 传递给您的destinationViewControllers。然后在 viewWillAppear() 中调用 preferredContentSizeDidChangeForChildContentContainer ，弹出框会自动调整大小。

```
override func viewWillAppear(animated: Bool) {
    super.viewWillAppear(animated)
    if let ppc = popoverController  {
        ppc.preferredContentSizeDidChangeForChildContentContainer(self)
    }
} 
```

如果它不起作用，请确保您正确实施了preferredContentSize。例如，用单个部分计算 tableViewController 的大小，如下所示：

```
override var preferredContentSize: CGSize {
    get {
        let sectionFrame    = self.tableView.rectForSection(0)
        let titleOnTop      = self.navigationController!.navigationBar.frame.height
        let height          = sectionFrame.height + titleOnTop
        return CGSize(width: super.preferredContentSize.width, height: height)
    }
    set { super.preferredContentSize = newValue }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T21:24:55.770

我从用户@krasnyk 的以下 StackOverflow 帖子中实现了答案：

[带有嵌入式导航控制器的弹出框不考虑后导航的大小](https://stackoverflow.com/questions/2752394/popover-with-embedded-navigation-controller-doesnt-respect-size-on-back-nav?rq=1)

一个变化对我来说效果很好......

基本上添加了上述帖子中详述的相同功能，但进行了一次修改（我在 PopupController 的视图层次结构中硬编码了每个 VC 的大小）

我引用此函数在 ViewDidLoad 和 ViewDidAppear 函数中为我的 PopoverController 中显示的 VC 链中的每个 VC 设置正确的弹出框大小。

```
- (void) correctPopoverContentSize {
    //
    // removed the following line from the original code in above post as it did not
    // work for me 
    //      CGSize currentSetSizeForPopover = self.contentSizeForViewInPopover; 

    CGSize currentSetSizeForPopover = CGSizeMake(320.0f, 180.0f);
    CGSize fakeMomentarySize = CGSizeMake(currentSetSizeForPopover.width - 1.0f,    
           currentSetSizeForPopover.height - 1.0f);
    self.contentSizeForViewInPopover = fakeMomentarySize;
    self.contentSizeForViewInPopover = currentSetSizeForPopover;
} 
```

# java - 如何在不创建实例的情况下访问类中的特定组件/方法

> ID：13905860
> 
> 赞同：1
> 
> 时间：2012-12-16T21:57:52.197
> 
> 标签：java, oop

我有一堂课`GuiApplication`和一堂课`ImageHandler`。GUI 可以通过`ImageHandler`一个名为的类使用（以及图像），该类`Crawler`为 GUI 可以使用的方法提供外观。

有一个单独的类`StartUp`，它有一个 main 方法，唯一要做的就是创建一个实例`GuiApplication`（所以基本上它会启动程序）。

在我的 GUI 中，有一个`JTextPane`用作记录器：某些操作和事件将显示在那里。使用来自我的 GUI 中其他地方的输出，我可以轻松地更新它的值。但是，当有来自我的域类中的输出时，例如`ImageHandler`，我无能为力。

当意外的图像 URL 通过我的阅读器时，有一个`Try-Catch`块可以防止我的程序崩溃，当它发生时，我想在文本窗格中显示它（“错误：无法读取文件 xxx”）。

但是，我没有看到一种将其传达给我的 GUI 的优雅方式：我无法创建实例，因为这会创建一个新的 GUI，而且我认为通过`StartUp`文件接近我的 GUI 也不是好习惯。

我正在考虑在一个可以在整个项目中访问的不同类中定义变量，但我首先想要一些意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:24:13.850

实际的方法是抛出一个 RuntimeException，它不需要更改方法的签名。在 GUI 中捕捉它并执行 JOptionPane.showMessageDialog。

另一种方法是使用事件处理程序扩展 ImageHandler 的 API，并安装一个调用 GuiApplication JOptionPane.showMessageDialog 的消息处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:39:13.197

想到的一个选项是回调：将某个接口的实例（可以是匿名类）传递给执行工作的方法，当发生错误时它会调用该方法。

# python - 主管作为非 root 用户

> ID：13905861
> 
> 赞同：3
> 
> 时间：2012-12-16T21:58:05.783
> 
> 标签：python, debian, supervisord

我一直试图让主管以非 root 用户身份运行，但一次又一次遇到问题。我读得越多，看起来主管就越是以root身份运行。

我什至在某处读到，如果主管以 root 身份运行，则只能在主管下以自己的用户身份运行子进程。

我的问题是，是否有可能让主管以非 root 用户身份运行，并且仍然以非 root 用户身份启动子进程。其次，除了创建用户并在 supervisor.conf 中设置用户之外，我还有什么需要做的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-16T22:05:29.137

为了能够以与正在运行的用户*不同*`supervisord`的用户身份运行任何子进程，您*必须*`supervisord`以 root身份运行。

当您`supervisord`以 root 以外的用户身份运行时，它*不能*在另一个用户下运行子进程。这是 UNIX 进程安全限制。

# java - opengl3中的立方体纹理

> ID：13905862
> 
> 赞同：0
> 
> 时间：2012-12-16T21:58:06.490
> 
> 标签：java, opengl, textures, texture-mapping, opengl-3

只是做我的计算机图形作业——将纹理（具有不同数字的 600x400 位图）放在一个立方体上以形成一个合适的骰子。我设法使用“经典”纹理映射来做到这一点：创建 verices 并为其添加相应的纹理坐标：

```
int arrayindex = 0;
float xpos = 0.0f;
float xposEnd = 0.32f;
float ypos = 0.0f;
float yposEnd = 0.49f;
int count = 0;
void quad( int a, int b, int c, int d ) {
    colors[arrayindex] = vertex_colors[a];
    points[arrayindex] = vertices[a];
    tex_coord[arrayindex] = new Point2(xpos, ypos);
    arrayindex++;
    colors[arrayindex] = vertex_colors[b];
    points[arrayindex] = vertices[b];
    tex_coord[arrayindex] = new Point2(xpos, yposEnd);
    arrayindex++;
    colors[arrayindex] = vertex_colors[c];
    points[arrayindex] = vertices[c];
    tex_coord[arrayindex] = new Point2(xposEnd, yposEnd);
    arrayindex++;
    colors[arrayindex] = vertex_colors[a];
    points[arrayindex] = vertices[a];
    tex_coord[arrayindex] = new Point2(xpos, ypos);
    arrayindex++;
    colors[arrayindex] = vertex_colors[c];
    points[arrayindex] = vertices[c];
    tex_coord[arrayindex] = new Point2(xposEnd, yposEnd);
    arrayindex++;
    colors[arrayindex] = vertex_colors[d];
    points[arrayindex] = vertices[d]; 
    tex_coord[arrayindex] = new Point2(xposEnd, ypos);
    arrayindex++;
    xpos = xpos + 0.34f;
    xposEnd = xpos + 0.32f;
    count++;
    if (count == 3) {
        xpos = 0.0f;
        xposEnd = 0.33f;
        ypos = 0.51f;
        yposEnd = 1.0f;
    }
}

void colorcube() {
    quad( 1, 0, 3, 2 );
    quad( 2, 3, 7, 6 );
    quad( 3, 0, 4, 7 );
    quad( 6, 5, 1, 2 );
    quad( 5, 4, 0, 1 );
    quad( 4, 5, 6, 7 );

    pointsBuf = VectorMath.toBuffer(points);
    colorsBuf = VectorMath.toBuffer(colors);
    texcoord = VectorMath.toBuffer(tex_coord);
} 
```

将所有这些东西传递给着色器并将它们放在一起。

但是查看幻灯片我注意到这种方法应该是“pre opengl3”。有没有其他方法可以做这些事情？

在讲座示例中，我注意到将它放在顶点着色器中，但它只是用于简单的 2d 平面，而不是 3d 立方体

```
tex_coords = vec2(vPosition.x+0.5,vPosition.z+0.5); 
```

然后传递给片段着色器以创建纹理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:11:17.997

> 但是查看幻灯片我注意到这种方法应该是“pre opengl3”。

我认为您的幻灯片指的是旧的即时模式。在即时模式下，每个顶点及其属性通过调用立即绘制它们的函数发送到 OpenGL。

但是，在您的代码中，您正在使用顶点数据初始化缓冲区。然后，这个缓冲区*可以*作为一个整体传递给 OpenGL，并通过一个 OpenGL 调用作为一个批次绘制。我写了“*可能*”，因为您的问题中没有一个 OpenGL 调用。

# php - APC 何时删除旧条目？

> ID：13905863
> 
> 赞同：3
> 
> 时间：2012-12-16T21:58:13.140
> 
> 标签：php, garbage-collection, apc

我正在努力寻找 APC 清除其旧条目的方式的任何逻辑。特别是对于用户条目，我注意到碎片迅速增加到意想不到的水平。

虽然 apc.ttl 和 apc.user_ttl 设置为 3600，但我注意到 APC 缓存中有很多旧条目没有被清除。我反复增加了 APC 的内存大小，但这只会让它在达到 100% 碎片之前持续更长时间。

那么，为什么会发生这种情况？实际上我会认为这是 APC 中的一个错误，它只是不正常的行为。我希望一些 APC 进程不时清除旧条目。

此外，是否可以得出结论，最好为 PHP 使用另一个缓存系统，并且只使用 APC 作为操作码缓存（缺少清理不是问题）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:12:51.360

如果要确保删除旧值。您需要明确删除它。

我在我的应用程序中使用了 APC 和 memcached 的组合。APC 提供操作码缓存以及缓存可能保持不变的本地数据（如配置文件）。所有其他对象都使用某种通读逻辑缓存在 memcached 中。（如果数据更改则清除）

当我发布新版本时，我重新启动 APC（如果它是一个单独的进程，则通过 apache 或 php）。这将清除 APC 缓存，并且配置文件将在不久后重新加载。如果对象发生了足够大的变化以在加载旧缓存数据时引起问题，我将重新启动 memcached。

# asp.net-mvc - ASP.NET MVC 3: RouteExistingFiles = true 似乎没有效果

> ID：13905864
> 
> 赞同：12
> 
> 时间：2012-12-16T21:58:13.537
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我试图了解 RouteExistingFiles 的工作原理。所以我创建了一个新的 MVC 3 互联网项目（MVC 4 的行为方式相同）并将 HTMLPage.html 文件放入我项目的 Content 文件夹。现在我转到 Global.Asax 文件并编辑了 RegisterRoutes 函数，它看起来像这样：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.RouteExistingFiles = true; //Look for routes before looking if a static file exists

    routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new {controller = "Home", action = "Index", id = UrlParameter.Optional} // Parameter defaults
            );
    } 
```

现在，当我请求 localhost:XXXX/Content/HTMLPage.html 时，它应该给我一个错误，因为没有“内容”控制器，并且请求肯定会达到默认模式。但相反，我看到的是我的 HTMLPage。我在这里做错了什么？

更新：我想我将不得不放弃。即使我要添加这样的路线：

```
routes.MapRoute("", "Content/{*anything}", new {controller = "Home", action = "Index"}); 
```

它仍然向我显示 HTMLPage 的内容。当我请求像 ~/Content/HTMLPage 这样的 url 时，我按预期获得了索引页面，但是当我添加像 .html 或 .txt 这样的文件扩展名时，会显示内容（如果文件不存在，则会显示 404 错误） . 如果有人可以在 VS2012 中检查这一点，请告诉我你得到了什么结果。谢谢你。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-02-12T10:12:20.280

要为静态文件启用路由，您必须执行以下步骤。

在 RouteConfig.cs 中为现有文件启用路由

```
routes.RouteExistingFiles = true; 
```

为您的路径添加路线（确保专用路径高于通用路径）

```
routes.MapRoute(
            name: "staticFileRoute",
            url: "Public/{file}/",
            defaults: new { controller = "Home", action = "SomeAction" }
        ); 
```

接下来配置您的应用程序，以便对静态文件的请求由“TransferRequestHandler”处理。在 webconfig 下的 system.webServer>handlers 添加以下条目。

```
<add name="MyCustomUrlHandler2" path="Public/*" verb="GET" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" /> 
```

根据您的要求，“路径”的值可以更通用或更具体。但我更喜欢它总是根据自己的需要非常具体。保持非常通用将阻止其他站点特定资源的服务，例如 .js 或 css 文件。例如，如果上面设置为 path="*"，那么即使是负责页面外观的 css（在内容文件夹内）也将在控制器的操作中结束。你不会喜欢的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-15T12:04:41.760

Visual Studio 2012 使用 IIS Express。您需要告诉 IIS 在将磁盘文件请求传递到 MVC 路由系统之前不要拦截它们。您需要将`preCondition`属性设置为配置文件中的空字符串：

```
<add name="UrlRoutingModule-4.0" type="System.Web.Routing.UrlRoutingModule" 
     preCondition="" /> 
```

在 Win7/8 中，您可以在此路径上找到配置文件：`%userprofile%\Documents\IISExpress\config\applicationhost.config`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-16T22:03:40.573

如果`RouteExistingFiles`没有路径，它不会阻止文件被查看，它只是在检查文件是否存在之前检查路径。如果没有匹配的路由，它会继续检查是否有匹配的文件。

# direct2d - 是否可以始终绘制 1 像素（与设备无关）线 direct2d？

> ID：13905867
> 
> 赞同：1
> 
> 时间：2012-12-16T21:58:39.490
> 
> 标签：direct2d, sharpdx

我在渲染目标上使用 DrawLine 函数，并且希望始终绘制一条（与设备无关）像素粗的线。

我的问题是我有一个变换，它的水平和垂直尺寸大不相同，看来我只能为这些尺寸之一缩放 strokeWidth。

我可以将变换设置为标识，并使用矩阵变换点将每个点转换为我的设备独立坐标，从而获得正确的结果，但工作并没有被卸载到 GPU。

有没有办法做到这一点，以便我可以让渲染目标上的转换完成工作？

我正在使用 C# 中的 SharpDX，但我很乐意翻译任何 c++ 答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T18:40:00.673

您应该能够利用转换`ID2D1RenderTarget`是绝对的这一事实。没有推送/弹出系统，您始终可以将转换设置为单位矩阵。有了这些知识，您应该能够 1）创建您想要的几何图形，2）通过渲染目标上的矩阵对其进行转换（`ID2D1Factory::CreateTransformedGeometry()`尽管您是正确的，这不是硬件加速的），3）设置渲染目标的转换为单位矩阵，4) 绘制具有 1px 笔划宽度的几何图形，5) 将原始转换恢复到渲染目标上。

此外，Win8 附带的 Direct2D 版本具有一些功能，可以让您始终使用 1px 宽的线进行绘制，而不管变换如何。您创建一个笔触样式并`D2D1_STROKE_TRANSFORM_TYPE_HAIRLINE`为 transformType 指定。

# java - 从字符串中获取资源id

> ID：13905868
> 
> 赞同：0
> 
> 时间：2012-12-16T21:58:48.733
> 
> 标签：java, android, integer, android-resources

> **可能重复：**
> [以编程方式访问资源名称](https://stackoverflow.com/questions/6999866/access-a-resource-name-programmatically)

我正在尝试使用字符串设置可绘制的 id，但它不起作用..

所以我尝试了这个：

```
String NoteString = "R.drawable.notebackground".toString();

remoteviews.setImageViewResource(R.id.backgroundImage, context.getResources().getIdentifier(NoteString, "drawable", "com.example.MY-PACKAGE-NAME")); 
```

但图像没有出现。

如果我这样说它有效：

```
remoteviews.setImageViewResource(R.id.backgroundImage, R.drawable.notebackground); 
```

怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T22:03:49.357

```
remoteviews.setImageViewResource(R.id.backgroundImage, getResources().getIdentifier(imageFilename, "drawable", getPackageName())); 
```

# java - 使用 MediaPlayer 流作为声源设置 Android 闹钟

> ID：13905869
> 
> 赞同：1
> 
> 时间：2012-12-16T21:59:05.863
> 
> 标签：java, android, media-player, android-alarms

我正在编写一个 Android 应用程序，它可以播放实时 Shoutcast 流等。是否可以构建一个功能，让用户可以使用 Shoutcast 流作为警报的声源来设置警报？我已经在这里和其他地方搜索过答案，但没有运气，所以我将不胜感激任何关于如何实现这一目标的指针或高级建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T23:09:17.897

查看[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)类以及[DatePicker](http://developer.android.com/reference/android/widget/DatePicker.html)和[TimePicker](http://developer.android.com/reference/android/widget/TimePicker.html)类。

在他们三个之间，你应该能够做你想做的事。

# retro-computing - Mac OS Classic 运行时是否有一些参考资料？

> ID：13905871
> 
> 赞同：3
> 
> 时间：2012-12-16T21:59:20.657
> 
> 标签：retro-computing, mac-classic

我正在研究 Mac OS Classic 运行时的实现，以便再次在 OS X 上运行 Classic 程序。该项目包括一个 PowerPC 仿真器、一个 PEF 可执行链接器以及调用本机 (x86) 代码的可能性。

模拟器和链接器似乎运行良好，所以我将注意力转移到（重新）实现 Mac OS Classic 库上。我目前正在尝试用我的“模拟器”运行 MPW 工具；在 Apple 从其服务器中提取 MPW Shell 并在 SheepShaver 中运行它之前的几个小时，我获取了一份 MPW Shell 的副本，我编译了您的通用“Hello World！”。程序，我能够成功运行它。

但是，就兼容性而言，这差不多。当我尝试运行 Unmangle 程序时，我发现它正在尝试访问`_IntEnv`和`__NubAt3`，两个 StdCLib 导出的全局变量，显然没有文档。（谷歌仍然有一些苹果邮件列表结果，用于 Mac OS X 早期的链接问题；必应和雅虎都没有结果。）

我发现缺乏文档特别令人不安。我有时可以通过 Classic 头文件猜测全局变量的布局，甚至可以猜测它们在反汇编程序中的使用方式，但这并不是很有效，没有什么可以告诉我我做对了。

即使我得到了大部分 StdCLib 的正确性，在某些时候我仍然需要有关其他库的文档。

在哪里可以找到有关 Mac OS Classic 运行时的文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T08:07:09.480

[在Apple 经典的 Mac 开发人员文档的](http://developer.apple.com/legacy/mac/library/documentation/macos8/mac8.html)剩余部分中，您可能仍然可以找到一些相关的 Inside Macintosh 卷。

# c# - 按下标题栏中的帮助按钮时如何打开 html 文件（C# windows 窗体）

> ID：13905877
> 
> 赞同：0
> 
> 时间：2012-12-16T21:59:48.083
> 
> 标签：c#, paint

嗨，我正在做一个绘画程序，我试图让标题栏中的帮助按钮打开一个 html 文件。我在按 F1 时已经这样做了，但是在按标题栏中的帮助按钮时我需要这样做。有人能帮我吗？

Visual Studio 2010 中的 Windows 窗体 C#

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:07:07.110

像这样的东西应该工作。

```
public Form1()
{
    InitializeComponent();

    // Min/Max have to be disabled to show "?" button
    MinimizeBox = false;
    MaximizeBox = false;

    HelpButton = true;
    HelpButtonClicked += new CancelEventHandler(Form1_HelpButtonClicked);
}

void Form1_HelpButtonClicked(object sender, CancelEventArgs e)
{
    Help.ShowHelp(this, @"my help html\chm file");
} 
```

# node.js - 将 socket.io 命名空间分离到单独的文件中

> ID：13905879
> 
> 赞同：6
> 
> 时间：2012-12-16T22:00:03.903
> 
> 标签：node.js, namespaces, express, socket.io

我编写了两个相对较大的 socket.io 应用程序，一个用于玩游戏，另一个用于聊天，我将它们分成两个命名空间。

我现在想将它们从我的主文件中`app.js`移到某个命名空间目录中，并在我的快速应用程序中要求它们，从而保留所有功能。

我将如何解决这个问题，或者有什么方法可以以其他方式获得我想要做的事情的效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T14:32:05.403

为了使用单独的文件，您需要在 node.js 中使用模块并使用 require 来加载它们。

模块具有特殊的结构和语法，以便能够调用模块函数并与之交互。

在此处阅读模块：[http ://nodejs.org/docs/latest/api/modules.html](http://nodejs.org/docs/latest/api/modules.html)

如果您需要与模块内部的函数、对象和数据进行交互，那么重新构建应用程序的架构可能需要做很多工作。

从开发的最初阶段，在应用程序的架构和技术设计过程中，您就必须注意这一点。

要使用相同的套接字，您必须在需要子模块的父模块中对其进行初始化，并将套接字应用程序句柄传递给这些子节点，以便他们能够使用它。

实现它的最糟糕和直接的选择，并且绝对不是商业世界的选择，是加载 js 文件内容，然后 eval() 它。但请记住 - 这绝对不推荐，在商业世界中你永远不应该使用它。

# ms-access - MS Access：从登录表单表中获取信息并传递到另一个表单

> ID：13905883
> 
> 赞同：1
> 
> 时间：2012-12-16T22:00:56.623
> 
> 标签：ms-access, global-variables, vba

嗨，我有一个登录表单，要求用户输入用户名，然后输入密码。用户名和密码在表格中核对，然后允许-不允许用户访问填写另一个表格。

在表格中有关于人名、电子邮件等的信息。在我的第二个表格中，我希望个人信息已经显示，这样他们就不必填写了。基本上，通过登录表格并打开另一个表格，它会识别该人是谁，并将自动填写他们的详细信息。谢谢

肯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T17:30:31.537

你有几个选择。您可以使用 OpenArgs 打开第二个表单，该表单引用登录时人员的 ID 或姓名。

语法是（[http://msdn.microsoft.com/en-us/library/office/ff820845.aspx](http://msdn.microsoft.com/en-us/library/office/ff820845.aspx)）：

```
 DoCmd.OpenForm(FormName, View, FilterName, WhereCondition, DataMode, WindowMode, OpenArgs) 
```

所以：

```
 DoCmd.OpenForm "MyForm",,,,,,Me.ID 
```

第二种形式然后可以使用 OpenArg 查找或 DlookUp ( [http://msdn.microsoft.com/en-us/library/bb148913(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/bb148913(v=office.12).aspx) ) 表中的记录，例如，您可以将文本框设置为：

```
 =DlookUp("Email","MyTable","ID=" & Me.OpenArgs) 
```

您可以打开绑定到 users 表的第二个表单并使用 Where 参数：

```
 DoCmd.OpenForm "MyForm",,,"ID=" & Me.ID 
```

这将是最好的，但它确实取决于绑定表或查询。

最后，您可以隐藏登录表单并引用文本框中的控件：

```
 =Forms!MyLogIn!txtEmail 
```

# css - 元素上的径向框阴影

> ID：13905885
> 
> 赞同：7
> 
> 时间：2012-12-16T22:01:03.983
> 
> 标签：css, radial-gradients

有没有办法创建一个从矩形`div`元素以圆形辐射的盒子阴影？所以就像一个规则的阴影，除了圆形。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-07-13T18:59:55.030

严格来说——不。box-shadow 与分配给它的对象的形状相关联。

也就是说 - 假设您的代码允许嵌套 div 元素 - 您可以通过将包装 div 设置为带有阴影的圆形以及带有矩形元素的内部内容 div 来有效地做到这一点。

```
.wrapper {
  /* Equal width and height create a perfect square */
  width: 300px;
  height: 300px;
  /* Adding a border-radius of 1/2 width or height (same value) */
  /* turns that square into a circle */
  border-radius: 150px;
  /* Apply your box-shadow styles, which inherit the round .wrapper shape */
  box-shadow: 0px 0px 200px #444444;
}

.content {
  /* Apply .content styles as needed; */
  /* will display on top of the round shadow */
  background-color: yellow;
}
```

```
<div class="wrapper">
  <div class="content">Content Here</div>
</div>
```

# linux - 从现在开始 5 秒后运行命令 `at`

> ID：13905886
> 
> 赞同：26
> 
> 时间：2012-12-16T22:01:22.757
> 
> 标签：linux, bash, scheduled-tasks

作为一个稍微复杂的脚本的一部分，我需要告诉服务器运行模拟。通常，我会通过`ssh user@server 'simulation/script'`. 但是，这样做会使 ssh 会话保持活动状态，直到`'simulation/script'`完成，这对我来说是不可取的。

我最近了解了该`at`命令，它似乎很适合我的问题。
我现在要做的是 ssh 进入我的服务器，并且`at`我的模拟脚本在 5 秒内运行（对于关闭 ssh 连接来说已经足够了）。因此，一旦 ssh 连接在 5 秒内关闭，服务器将开始模拟，而无需 ssh 连接保持活动状态。

我遇到的问题是`at`“从现在开始 5 秒”安排工作所需的时间表达式

我尝试了以下时间表达式，所有这些都给我错误：

```
now + 5 seconds
now + 5 sec
now + 5 s
now + 5seconds
now + 5sec
now + 5 s
now+5sec
now+5seconds
now+5s 
```

我怎样才能让我`at`“从现在开始 5 秒”运行我的命令？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2016-09-02T12:53:23.110

“at”没有亚分钟分辨率，但你可以伪造它：

```
echo "sleep 5 ; COMMAND" | at now 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-16T22:05:12.913

at没有*秒数*：

`man at`说过 ：

> *   日期的指定必须遵循时间的指定。您还可以给出像 now + count 时间单位这样的时间，其中时间单位可以是分钟、小时、天或周，您可以通过在今天加上时间后缀来告诉 at 今天运行作业，明天运行作业用明天作为时间的后缀。

因此`at`，您可以使用`sleep`我认为的而不是 。

看`man 1 sleep`

* * *

如果您想在`ssh user@server 'simulation/script'`不等待的情况下运行，只需执行以下操作：

```
ssh user@server 'simulation/script' & 
```

该命令将在后台运行。

此外，正如 Rawkode 所说，`nohup`将在这方面有所帮助。

所以最后：

```
nohup ssh user@server 'simulation/script' & 
```

使用 nohup，您可以退出终端并让`ssh`进程处于活动状态。

* * *

`EDIT`：如果要运行`ssh`命令并关闭连接：

```
ssh user@server 'simulation/script &' 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-12-16T22:09:51.860

`at`不使用秒，只使用分钟/小时/天

你可以做的是在你的脚本之前加上`nohup`，这将确保当你断开你的 SSH 会话时脚本不会被杀死。

`ssh server 'nohup yourscript.sh &'`

**注意：**刚刚玩过上述操作后，必须手动终止 SSH 连接。

另一种选择是`screen`

`screen -d -m yourscript.sh`

这将启动一个分离的`screen`进程，您可以在以后随时重新附加该进程。

**注意：**我已经使用以下脚本和命令对此进行了测试，并且效果很好。

**SSH 命令**

`ssh server.com 'screen -d -m ~/myscript.sh'`

**脚本文件**

```
#!/bin/sh
sleep 10
echo "hello world" > /tmp/hello
exit; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-02-05T13:51:37.893

请注意：在 中`man at`，我看到有一个`-t`开关，它将接受带有秒数的日期时间 - 但不幸的是，秒数将被截断：

```
$ date; date --date="now +10 seconds" +"%m%d%H%M.%S"; echo "logger AAAA" | at -t $(date --date="now +5 seconds" +"%Y%m%d%H%M.%S")
Thu Feb  5 14:45:57 CET 2015
02051446.07
warning: commands will be executed using /bin/sh
job 8 at Thu Feb  5 14:46:00 2015 
```

...因此该作业实际上可能是在过去安排的（也用于`logger`系统日志，因为它看起来不像回显到终端的标准输出可以从这里工作）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-02T12:41:17.107

我认为这样做更容易：

```
sleep n && command 
```

其中`n`是秒数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-21T12:40:27.643

除了后台脚本之外，重定向 stdin/stdout/stderr 将允许 SSH 会话在执行后台命令后立即关闭：

```
ssh hostname "/path/to/script </dev/null >/dev/null 2>/dev/null &" 
```

来源：[https](https://serverfault.com/a/36436/138334) ://serverfault.com/a/36436/138334 。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-07-05T09:29:55.990

你可以使用 sleep 命令来做到这一点：

```
bash -c 'sleep 5 ; echo "test"' & 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-10-07T15:28:14.097

我今天遇到了同样的问题，但我能够使用它来解决它`nohup`

`nohup bash -c 'sleep 5 && at now -f script-name.sh'`

# python - `cimport` 导致交互式 Python 解释器出错

> ID：13905891
> 
> 赞同：7
> 
> 时间：2012-12-16T22:01:59.340
> 
> 标签：python, import, syntax-error, cython, cimport

在 Python 解释器中运行`cimport cython`或运行`cimport numpy`会导致以下错误：

```
cimport cython
  File "<interactive input>", line 1
    cimport cython
                 ^
SyntaxError: invalid syntax 
```

是环境变量路径问题吗？或者它不应该在解释器中运行？请帮忙。我花了几天时间试图摆脱这个错误。（顺便说一句，编译使用...的 .pyx 文件时我没有收到错误`cimport numpy`）谢谢！奥列格

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-23T21:12:08.443

Cython 是 Python 语言的超集；它不是 Python 模块。它具有与 Python 非常相似的语法，但添加了与标准 Python 解释器不兼容的附加语法和功能，例如 CPython（这可能是您正在使用的）。Cython 生成 C 或 C++ 代码，这些代码可以编译成可以导入 CPython 的模块。

您需要在运行 Cython 程序之前对其进行编译。请参阅此处的文档：http: [//docs.cython.org/src/quickstart/build.html](http://docs.cython.org/src/quickstart/build.html)

一旦你编译了你的模块，你就不需要`cimport`它了——只需做一个常规的`import`. CPython 无法识别该`cimport`命令，因此会出现 SyntaxError。

# python - 无法访问文件

> ID：13905892
> 
> 赞同：-1
> 
> 时间：2012-12-16T22:02:05.133
> 
> 标签：python

我有一个问题，即使文件存在并且我可以手动访问它，我也无法使用 python 访问文件。以下代码是问题所在：

```
f = '~/backup/backup_20121216.log'
text = open(f, "rb").read()
print text 
```

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:05:49.263

这行得通吗？

```
import os

path = '~/backup/backup_20121216.log'
path = os.path.expanduser(path)
with open(path, 'rb') as fp:
    text = fp.read()
print text 
```

# java - Java - 当变量等于字符串时，如果语句不捕获

> ID：13905898
> 
> 赞同：1
> 
> 时间：2012-12-16T22:02:44.630
> 
> 标签：java, string, if-statement, char

> **可能重复：**
> [如何比较 Java 中的字符串？](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)

**（这可能是重复的，我不知道`.equals`。我很抱歉。）**

当我决定制作一个 4 字符的字符串生成器时，我今天在 Java 中搞砸了。我让程序生成我定义的所有可能的字符组合。这不是一个项目，我只是想看看这是否可能。我的问题在于字符串检查。我会先发布代码。

```
String text = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
char[] chars = text.toCharArray();
String name = "Mike";
String pass;

outerLoop:
for (int a = 0; a < chars.length; a ++) {
    for (int b = 26; b < chars.length; b++) {
        for (int c = 26; c < chars.length; c++) {
            for (int d = 26; d < chars.length; d++) {
                pass = chars[a]+""+chars[b]+""+chars[c]+""+chars[d];
                System.out.println(pass);
                if (pass == name){
                    System.out.print("password");
                    break outerLoop;
                }
            }
        }
    }
} 
```

嵌套`if`将检查是否`pass`等于 Mike。如果是，那么它会打印密码并打破 for 循环。

*   这`pass = chars[a]...`是正确的方法吗？当我在没有 的情况下对其进行测试时`if`，我将其打印出来并正确打印了所有组合。它确实打印了`Mike`，但没有在`if`.
*   我还更改了嵌套`for`循环，因此它们以小写字母开头，因为当我进行较小的更改时程序需要一段时间才能运行。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-16T22:03:22.253

```
 if (pass == name){ 
```

应该

```
 if (pass.equals(name)){ 
```

使用[**String.equals()**](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#equals%28java.lang.Object%29)方法检查字符串是否相等。`==`运算符只是检查两个引用变量是否引用同一个对象。**equals()**方法检查两个字符串是否有意义地相等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:05:31.867

应使用 equals() 比较字符串

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T22:08:54.410

这每天至少出现一次。应该有一个专门针对它的“关闭问题”选项。不过，又来了……

`==`运算符测试两个操作数是否是同*一个实例*。

该`.equals()`方法比较两个操作数的*值*，但前提是类已经实现了这个方法（`String`确实如此），否则它的行为与`==`（`Object`类实现它的方式）相同。

# mysql - mysql中的批量更新列

> ID：13905902
> 
> 赞同：0
> 
> 时间：2012-12-16T22:03:21.487
> 
> 标签：mysql, sql

我有一个表，其中有一个名为“backfill_target”的列，其值为 1，但我需要将所有 300 行的值更改为 20，我该怎么做？

编辑：

这是我的表格的简化版本

```
ID|name |backfill_target|first_record|second_record
0 | test| 1             |52          |54 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T22:07:40.707

尝试，

```
UPDATE tableName 
SET backfill_target = 20
WHERE backfill_target = 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T22:05:25.047

假设您要更新每一行。

```
UPDATE table SET backfill_target = 20 
```

# css - 我的页脚不会保持固定 - Wordpress

> ID：13905905
> 
> 赞同：1
> 
> 时间：2012-12-16T22:03:28.640
> 
> 标签：css, wordpress, sticky-footer

我正在为一个朋友对 wordpress 主题进行大量修改。我有很多关于页脚停留在页面底部的问题，而不是不断向上移动并留下空白。

网址： [http ://design.jarethmusic.com/about/](http://design.jarethmusic.com/about/)

HTML (页脚.php)

```
<?php global $woo_options; ?>
    <?php
        $total = 4;
        if ( isset( $woo_options['woo_footer_sidebars'] ) ) { $total = $woo_options['woo_footer_sidebars']; }
        if ( ( woo_active_sidebar( 'footer-1' ) ||
               woo_active_sidebar( 'footer-2' ) ||
               woo_active_sidebar( 'footer-3' ) ||
               woo_active_sidebar( 'footer-4' ) ) && $total > 0 ) {

    ?>

    <div id="footer-widgets">
        <div class="col-full col-<?php echo $total; ?>">

        <?php $i = 0; while ( $i < $total ) { $i++; ?>
            <?php if ( woo_active_sidebar( 'footer-' . $i ) ) { ?>

        <div class="block footer-widget-<?php echo $i; ?>">
            <?php woo_sidebar( 'footer-' . $i ); ?>
        </div>

            <?php } ?>
        <?php } ?>

        <div class="fix"></div>
        </div>
    </div><!-- /#footer-widgets  -->
    <?php } ?>
<div class="push"></div>
    <div id="footer">
        <div class="col-full">

        <div id="copyright" class="col-left">
        <?php if( isset( $woo_options['woo_footer_left'] ) && $woo_options['woo_footer_left'] == 'true' ) {

                echo stripslashes( $woo_options['woo_footer_left_text'] );

        } else { ?>
            <p><?php bloginfo(); ?> &copy; <?php echo date( 'Y' ); ?>. <?php _e( 'All Rights Reserved.', 'woothemes' ); ?></p>
        <?php } ?>
        </div>

        <div id="credit" class="col-right">
        <?php if( isset( $woo_options['woo_footer_right'] ) && $woo_options['woo_footer_right'] == 'true' ) {

            echo stripslashes( $woo_options['woo_footer_right_text'] );

        } else { ?>
            <p><?php _e( 'Powered by' ); ?> <a href="http://www.wordpress.org">WordPress</a> and <a href="http://www.woothemes.com">WooThemes. </a> <?php _e( 'Designed and edited by' ); ?> <a href="http://johns-webdesign.com/">John Brown.</a></p>
        <?php } ?>

        </div></div>
    </div><!-- /#footer  -->
</div><!-- /#wrapper -->
<?php wp_footer(); ?>
<?php woo_foot(); ?>
</body>
</html> 
```

CSS

```
#footer{padding: 30px 0 20px; background: url(images/bg-ripple-footer.png) repeat top left; color:#999;}
#footer p {}
#footer a { color: #ffffff; }
#footer #credit img{vertical-align:middle;}
#footer #credit span{display:none;}

#footer-widgets { margin-bottom: -5px; background: url(images/bg-ripple-footer-widgets.png) repeat top left; padding:10px 0; height:60px; }
#footer-widgets .block { padding:20px 10px 0 10px; float:left; }
#footer-widgets .col-1 .block { width:100%; padding-left:0; }
#footer-widgets .col-2 .block { width:420px; padding-left: 20px; }
#footer-widgets .col-3 .block { width:270px; padding-left: 16px;  }
#footer-widgets .col-4 .block { width:200px; padding-left: 10px;  } 
```

我希望我能在你的帮助下彻底解决这个问题。约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:07:56.207

不要在你的 CSS 中添加这个：

```
#content {
min-height: 700px;
} 
```

您需要内容区域的最小高度才能将页脚“推”到页面底部。如果内容区域是包装器内部的一小部分，页脚将不会位于页面底部。

旁注：一个非常有用的工具是使用 Chrome 浏览器。它有一个内置的类似萤火虫的扩展，可以让您在更新网页的同时检查网页元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T22:29:50.907

按照这个小教程设法解决了我的问题：

[http://mystrd.at/modern-clean-css-sticky-footer/](http://mystrd.at/modern-clean-css-sticky-footer/)

归功于 mfreitas 的链接。

另外，关于在这方面帮助过我的其他人。谢谢约翰

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T22:05:21.650

### 采用`position: fixed;`

使用此 CSS 更新您的代码：

```
#footer {position: fixed;} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T22:13:20.680

`position: absolute;`在您的 CSS 中用于页脚

# c# - WPF 中 XmlDataProvider 的自定义源

> ID：13905910
> 
> 赞同：1
> 
> 时间：2012-12-16T22:03:54.250
> 
> 标签：c#, xml

我的应用程序中有以下内容。配置文件

```
 <appSettings>
  <add key="Path" value="C:\Users\dave\Desktop\dave"/>
   </appSettings> 
```

在我的 XAML 文件中，XmlDataProvider 如下：

```
<XmlDataProvider x:Name="Data" Source= "setting.xml" XPath="Product" /> 
```

我想将源指向路径。

一如既往的任何帮助都非常感谢。

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-04T15:36:28.030

试试这样：

```
<XmlDataProvider x:Name="Data" Source= "pack://siteoforigin:,,,/setting.xml" XPath="Product" /> 
```

setting.xml 必须在您的主文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T23:31:07.407

如果您不介意在代码中包含属性，则可以`StringFormat`在 xaml中使用

```
public string MyPath
{
    get { return ConfigurationManager.AppSettings["Path"]; }
}

<XmlDataProvider x:Name="Data" Source="{Binding Path=MyPath, StringFormat={}{0}\\Settings.xml}" XPath="Product" /> 
```

返回：“C:\Users\dave\Desktop\dave\Settings.xml”

# android - 应用小部件中的 getAssets

> ID：13905911
> 
> 赞同：0
> 
> 时间：2012-12-16T22:04:06.530
> 
> 标签：android

我的应用程序小部件使用数据库，它预加载在资产目录中，该活动在首次运行时将其复制到数据库目录。

但如果在此之前插入小部件，则会引发异常，因为数据库尚不存在。

无论如何，小部件检查文件，如果它不存在，从资产中获取它并复制它而不是活动？！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:10:59.667

我真的推荐用于在[应用`SQLiteAssetHelper`程序中打包数据库](https://github.com/jgilfelt/android-sqlite-asset-helper)。然后，您可以像往常一样使用`getReadableDatabase()`/ ，如果需要，您可以透明地从资产中解压缩您的数据库。`getWriteableDatabase()``SQLiteAssetHelper`

话虽如此，如果您确定要自己执行此操作，请调用传入`getAssets()`的.`Context``onUpdate()``AppWidgetProvider`

请注意，`onUpdate()`您的 of`AppWidgetProvider`在主应用程序线程上被调用，所以就像您（希望）在后台线程中执行活动数据库 I/O 一样，您应该对您的应用程序小部件执行相同的操作。应用程序小部件的典型解决方案是让工作由`IntentService`start by完成`onUpdate()`。

# c# - 如何从 c# 创建 wordpress 帖子？

> ID：13905912
> 
> 赞同：-1
> 
> 时间：2012-12-16T22:04:13.733
> 
> 标签：c#, wordpress, post

我想用 c# 在 wordpress 中自动创建帖子，每个帖子应该有一个或两个图像自动上传。哪种方法最简单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:43:44.643

基本上你有两个选择：

1.  通过 C# 操作 Wordpress 数据库
2.  在 Wordpress 站点中使用服务以允许通过 RESTful API 进行操作。为此，您可以使用这个 wordpress 插件：[http ://wordpress.org/extend/plugins/json-api/other_notes/](http://wordpress.org/extend/plugins/json-api/other_notes/)

# ssh - 私人网站的绝对安全访问

> ID：13905919
> 
> 赞同：0
> 
> 时间：2012-12-16T22:05:05.110
> 
> 标签：ssh, ssl-certificate, mediawiki, intranet

我计划在 debian（SELinux）上为我所有重要的家庭文档运行一个私人媒体 wiki 服务器。

我希望能够使用笔记本电脑、平板电脑甚至像 LPS 这样的 live-CD 从外部安全地访问它。在我看来，如果我只向云提供 SSH 并通过隧道进入，我将拥有最小的攻击面，甚至可能包含端口敲击以防止随意检测。我将向一组已知且基本不变的用户提供内容。带宽效率并不是一个真正的因素，因为并发连接很少见。

**是否有更安全的方式来访问 Web 服务器？**政府似乎真的很喜欢使用智能卡，虽然我不知道怎么用。客户端浏览器证书呢？尤比奇？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T07:22:20.693

最安全的解决方案可能是使用虚拟专用网络，以便根本无法联系服务器，除非通过类似 SSH 的协议。一个像样的路由器应该支持这一点；您可以在[SuperUser](https://superuser.com/)获得更多帮助。

# python - 将整数转换为数字列表

> ID：13905936
> 
> 赞同：61
> 
> 时间：2012-12-16T22:06:02.647
> 
> 标签：python, list, integer, type-conversion

`integer`将 a 转换为 a的最快和最干净的方法是`list`什么？

例如，更改`132`为`[1,3,2]`和。我有一个变量，它是一个，我希望能够比较各个数字，所以我认为将它变成一个列表是最好的，因为我可以轻松地将列表元素转换回 int 以进行数字操作。`23``[2,3]``int``int(number[0])``int(number[1])`

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-12-16T22:07:10.963

先将整数转换为字符串，然后使用`map`应用于`int`其上：

```
>>> num = 132
>>> map(int, str(num))    #note, This will return a map object in python 3.
[1, 3, 2] 
```

或使用列表理解：

```
>>> [int(x) for x in str(num)]
[1, 3, 2] 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-06-28T23:39:50.927

> 此页面上已经提到了一些很棒的方法，但是对于使用哪种方法似乎有点模糊。因此，我添加了一些测量，以便您可以更轻松地自己决定：

* * *

*大量使用（用于开销）`1111111111111122222222222222222333333333333333333333`*

# **使用`map(int, str(num))`：**

```
import timeit

def method():
    num = 1111111111111122222222222222222333333333333333333333
    return map(int, str(num))

print(timeit.timeit("method()", setup="from __main__ import method", number=10000) 
```

*输出：`0.018631496999999997`*

# **使用列表理解：**

导入时间

```
def method():
    num = 1111111111111122222222222222222333333333333333333333
    return [int(x) for x in str(num)]

print(timeit.timeit("method()", setup="from __main__ import method", number=10000)) 
```

*输出：`0.28403817900000006`*

***取自[此答案的代码](https://stackoverflow.com/questions/13905936/converting-integer-to-list-in-python/13905946#13905946)***

结果表明，第一种涉及内置方法的方法比列表理解要快得多。

# **“数学方法”：**

```
import timeit

def method():
    q = 1111111111111122222222222222222333333333333333333333
    ret = []
    while q != 0:
        q, r = divmod(q, 10) # Divide by 10, see the remainder
        ret.insert(0, r) # The remainder is the first to the right digit
    return ret

print(timeit.timeit("method()", setup="from __main__ import method", number=10000)) 
```

*输出：`0.38133582499999996`*

***取自[此答案的代码](https://stackoverflow.com/questions/13905936/converting-integer-to-list-in-python/13906149#13906149)***

# **该`list(str(123))`方法（不提供正确的输出）：**

```
import timeit

def method():
    return list(str(1111111111111122222222222222222333333333333333333333))

print(timeit.timeit("method()", setup="from __main__ import method", number=10000)) 
```

*输出：`0.028560138000000013`*

***取自[此答案的代码](https://stackoverflow.com/questions/13905936/converting-integer-to-list-in-python/13905990#13905990)***

# **Duberly González Molinari 的回答：**

```
import timeit

def method():
    n = 1111111111111122222222222222222333333333333333333333
    l = []
    while n != 0:
        l = [n % 10] + l
        n = n // 10
    return l

print(timeit.timeit("method()", setup="from __main__ import method", number=10000)) 
```

*输出：`0.37039988200000007`*

***取自[此答案的代码](https://stackoverflow.com/questions/13905936/converting-integer-to-list-in-python/45377577#45377577)***

# **评论：**

在所有情况下，这`map(int, str(num))`是最快的方法（因此可能是最好的方法）。列表理解是第二快的（但使用的方法`map(int, str(num))`可能是两者中最可取的。

那些重新发明轮子的东西很有趣，但在实际使用中可能并不那么理想。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-16T22:33:59.513

最短最好的方法已经回答了，但是我首先想到的是数学方法，所以这里是：

```
def intlist(n):
    q = n
    ret = []
    while q != 0:
        q, r = divmod(q, 10) # Divide by 10, see the remainder
        ret.insert(0, r) # The remainder is the first to the right digit
    return ret

print intlist(3)
print '-'
print intlist(10)
print '--'
print intlist(137) 
```

这只是另一种有趣的方法，您绝对不必在实际用例中使用这样的东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-05-01T11:50:49.540

```
>>>list(map(int, str(number)))  #number is a given integer 
```

它返回数字的所有数字的列表。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-07-28T15:45:55.823

```
n = int(raw_input("n= "))

def int_to_list(n):
    l = []
    while n != 0:
        l = [n % 10] + l
        n = n // 10
    return l

print int_to_list(n) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-16T22:11:59.437

`list`在转换为字符串的数字上使用：

```
In [1]: [int(x) for x in list(str(123))]
Out[2]: [1, 2, 3] 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-10-14T22:13:28.713

如果你有一个这样的字符串：'123456'，并且你想要一个这样的整数列表：[1,2,3,4,5,6]，使用这个：

```
>>>s = '123456'    
>>>list1 = [int(i) for i in list(s)]
>>>print(list1)

[1,2,3,4,5,6] 
```

或者如果你想要一个这样的字符串列表：['1','2','3','4','5','6']，使用这个：

```
>>>s = '123456'    
>>>list1 = list(s)
>>>print(list1)

['1','2','3','4','5','6'] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-04T20:39:44.223

### 您可以使用：

首先转换字符串中的值以对其进行迭代，每个值都可以转换为整数`value = 12345`

`l = [ int(item) for item in str(value) ]`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-07-28T17:07:58.313

通过循环它可以通过以下方式完成:)

```
num1= int(input('Enter the number'))
sum1 = num1 #making a alt int to store the value of the orginal so it wont be affected
y = [] #making a list 
while True:
    if(sum1==0):#checking if the number is not zero so it can break if it is
        break
    d = sum1%10 #last number of your integer is saved in d
    sum1 = int(sum1/10) #integer is now with out the last number ie.4320/10 become 432
    y.append(d) # appending the last number in the first place

y.reverse()#as last is in first , reversing the number to orginal form
print(y) 
```

答案变成

```
Enter the number2342
[2, 3, 4, 2] 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-06-04T18:46:33.137

```
num = list(str(100))
index = len(num)
while index > 0:
    index -= 1
    num[index] = int(num[index])
print(num) 
```

它打印`[1, 0, 0]`对象。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2021-10-13T19:39:41.150

```
num = 123
print(num)
num = list(str(num))
num = [int(i) for i in num]
print(num) 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2021-07-23T06:25:11.563

将整数作为输入并将其转换为数字列表。

代码：

```
num = int(input())
print(list(str(num))) 
```

使用 156789 输出：

```
>>> ['1', '5', '6', '7', '8', '9'] 
```

# c# - 使用 System.Net.Mail 时没有验证功能

> ID：13905940
> 
> 赞同：0
> 
> 时间：2012-12-16T22:06:18.513
> 
> 标签：c#, asp.net

似乎当我在联系页面后面的代码中配置我的电子邮件设置时，验证控件不再起作用。我需要字段验证和正则表达式验证来验证电子邮件地址。在我插入要求我使用 System.Net.Mail 的电子邮件配置之前，验证适用于点击事件。这是后面的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Mail;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class Contact : System.Web.UI.Page
{
protected void Page_Load(object sender, EventArgs e)
{

}
protected void Button1_Click(object sender, EventArgs e)
{
    MailMessage mail = new MailMessage();
    mail.To.Add("email@gmail.com");
    mail.From = new MailAddress(EmailAddressTextBox.Text);
    mail.Subject = SubjectTextBox.Text;

    mail.Body = "email address: " + EmailAddressTextBox.Text + "<br />" + MessageTextBox.Text;

    mail.IsBodyHtml = true;
    SmtpClient smtp = new SmtpClient();
    smtp.Host = "smtp.gmail.com"; //Or Your SMTP Server Address  
    smtp.Credentials = new System.Net.NetworkCredential
         ("email@gmail.com", "password");
    //Or your Smtp Email ID and Password  
    smtp.EnableSsl = true;
    smtp.Port = 587;
    smtp.Send(mail);

    EmailAddressTextBox.Text = String.Empty;
    SubjectTextBox.Text = String.Empty;
    MessageTextBox.Text = String.Empty;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:46:36.110

您忘记`Page.IsValid`在`Button1_Click`.

# mysql - 按非标准天数计算天数结束

> ID：13905941
> 
> 赞同：0
> 
> 时间：2012-12-16T22:06:28.497
> 
> 标签：mysql, datetime

我正在尝试计算一天内发生的事件，这本身很容易：

```
SELECT date(time),COUNT(DISTINCT comment)
FROM data
GROUP BY date(time) 
```

但我需要在下午 4 点设置一天结束。所以下午 4 点之前的所有评论都是第 N 天，下午 4 点之后的新闻是第 N+1 天。这不是一个全球性的事情，所以我宁愿不改变整个程序的时区等等。也许我可以以某种方式将时区应用于这个查询或填充时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:17:07.107

```
SELECT
  DATE_ADD(date(time),
    INTERVAL case when time(time)>='16:00:00' then 1 else 0 end DAY) as day,
    COUNT(DISTINCT comment)
FROM data
GROUP BY day 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T22:18:29.910

你有没有试过这个：

```
SELECT date(time + INTERVAL 8 HOUR) as day, COUNT(DISTINCT comment)
FROM data
GROUP BY day 
```

您希望您的日子在下午 4 点或提前 8 小时结束，因此，我们将 8 小时添加到`time`，迫使日期在下午 4 点翻转。

# php - Codeigniter - 传递多个值来查看

> ID：13905942
> 
> 赞同：2
> 
> 时间：2012-12-16T22:07:02.227
> 
> 标签：php, codeigniter, activerecord, view, controller

好的，所以通常我这样做不会有问题，而且会相当简单，但这次不是那么多。

这是我的控制器中的相关代码：

```
// In order to properly build the form url, we need to include the
                // category and product to the view
                $this->data = array(
                        'category' => $category,
                        'product' => $product
                        );

                // Load the product model and get editable values from the database
                $this->load->model('productadmin/products_model');
                $productInformation = $this->products_model->get_product_data($product);

                // Modular code! Use variable-variables to prevent having to write multiple lines of code
                // when we start returning more information from the data
                foreach ( $productInformation as $variable => $value )
                {
                    $this->data[$variable] = $value;
                } 
```

现在，理想情况下，我应该能够访问 $product、$category 以及从 products 模型返回的任何变量。做一个 print_r，我得到以下信息：

```
Array ( [category] => 1 [product] => 1 [0] => Array ( [id] => 1 [product_name] => Duff ) ) 
```

请注意 foreach 语句生成的内容如何包含在它自己的数组中。最简单的解决方案是知道如何从视图中访问第二个数组，只需传递`$this->data`.

如果这不可行，我可以改变什么来在数据数组中分配模型的关联值而不在其中创建另一个数组？

该模型只是从 get_where 语句返回键值对。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:13:20.823

在将数据传递给视图之前，您应该为数据使用关联数组。尝试更改此行：

```
foreach ( $productInformation as $variable => $value )
{
  $this->data[$variable] = $value;
} 
```

有了这个：

```
foreach ( $productInformation as $variable => $value )
{
  $this->data['product_information'][$variable] = $value;
} 
```

然后在您的视图中，您可以使用`$product_information`变量访问您的产品信息。

注意：我假设您使用以下方法将数据传递给视图：

```
$this->load->view('your_view', $this->data); 
```

# performance - 使用查找表或左/右位移以获得 2 整数的幂是否更快？

> ID：13905943
> 
> 赞同：1
> 
> 时间：2012-12-16T22:07:04.533
> 
> 标签：performance, x86, bit-manipulation

假设我想用第 N 位设置构建位掩码。我有 N 作为整数。

哪个更好？`1 << N`还是查找表（指针算术加法）？

我的猜测是，单个位移操作比内存查找更快，并且只有一次高速缓存热，LUT 才有战斗机会。但是，如果是这种情况，那么为什么 LUT 通常是位旋转问题中最快的解决方案？仅仅是因为我们这些天在我们的 CPU 中拥有巨大的缓存吗？

让我用我最关心 x86-64 上的这个操作这一事实来限定这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-16T22:12:53.930

位移总是比查找表或计算快得多。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2014-06-30T11:58:36.427

你确定吗？我运行了这个 VB 程序，结果有点变化，但查找通常比位移快，并且比空时间高不了多少。这可能是因为缓存的原因，所以很难从这里一概而论。

我从随机移位值中得到了类似的结果，但当然随机数生成所花费的时间比其他任何事情都长。

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
Dim SW As New Stopwatch()
Dim TimeShift As Long
Dim TimeLookUp As Long
Dim Timenull As Long
Dim i As Integer
Dim j As Integer
Dim Bit As UInteger
Dim R As New Random()
Dim total As UInteger
Dim S = New System.Text.StringBuilder()

total = 0
SW.Start()
j = 0
For i = 1 To RepCount
  Bit = CUInt(1) << (j And 31)
  j += 1
  'Bit = 1 << (R.Next(31))
  total = total Or Bit
Next
SW.Stop()
TimeShift = SW.ElapsedMilliseconds

SW.Reset()
SW.Start()
For i = 1 To RepCount
  Bit = Bits(j And 31)
  j += 1
  'Bit = Bits(R.Next(31))
  total = total Or Bit
Next
SW.Stop()
TimeLookUp = SW.ElapsedMilliseconds

SW.Reset()
SW.Start()
For i = 1 To RepCount
  total = total Or (j And 31)
  j += 1
Next
SW.Stop()
Timenull = SW.ElapsedMilliseconds

If Stopwatch.IsHighResolution Then
  S.Append("High")
Else
  S.Append("Low")

End If
S.Append(" frequency clock")
S.AppendLine()
S.Append("Shift time= " & TimeShift & " ms")
S.AppendLine()
S.Append("Lookup time= " & TimeLookUp & " ms")
S.AppendLine()
S.Append("Null time=" & Timenull & " ms")
S.AppendLine()
S.Append("Total= " & total.ToString)

MsgBox(S.ToString)
End Sub
End Class 
```

# matlab - MATLAB 是否支持命名参数？

> ID：13905945
> 
> 赞同：12
> 
> 时间：2012-12-16T22:07:07.233
> 
> 标签：matlab

> **可能重复：**
> [Matlab 中的默认参数](https://stackoverflow.com/questions/795823/default-arguments-in-matlab)
> [如何在 MATLAB 中处理函数参数的名称/值对](https://stackoverflow.com/questions/2775263/how-to-deal-with-name-value-pairs-of-function-arguments-in-matlab)

如果您需要创建一个带有可选参数音调的函数怎么办。有没有办法在命名传递的参数以提高可读性时调用该函数：

```
foo(123, and=456) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-16T22:20:48.793

在 Matlab 中执行此操作的类似方法是具有名称/值对：

```
foo(123,'and',456,'something',[1 2 3]) 
```

有关如何处理它们，请参阅[此问题](https://stackoverflow.com/questions/2775263/how-to-deal-with-name-value-pairs-of-function-arguments-in-matlab)的答案。

# php - MySQL 选择错误

> ID：13905947
> 
> 赞同：-2
> 
> 时间：2012-12-16T22:07:15.310
> 
> 标签：php, mysql, select

我是 PHP 的初学者。当我开始我的第一个 SQL 查询时，我遇到了这个问题：

> 页面上的数据库查询失败：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '['id']}' 附近使用正确的语法

有我的 SELECT 命令：

```
$page_set = mysql_query(
    "SELECT * FROM pages WHERE subject_id  = {[$subject'id']}", $connection
); 
```

我检查了我所有的数据库表，一切都是正确的。此查询有效：

```
$page_set = mysql_query("SELECT * FROM pages" ,$connection) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:08:53.273

尝试这样的事情：

```
$page_set = mysql_query("SELECT * FROM pages WHERE subject_id = '" . $subject['id'] . "'", $connection); 
```

这假设 id 是 $subject 数组中的一个项目，我猜这就是你在这里要做的。我认为您不需要那些花括号“{”，但您可能需要在 where 子句中的值周围加上单引号。

此外，如果这不起作用，请尝试回显正在运行的 sql 命令，您应该能够看到问题（或在您的问题中发布 SQL 命令）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T22:09:11.627

试试这个，

```
$page_set = mysql_query("SELECT * FROM pages WHERE subject_id = '" . $subject['id'] . "'", $connection); 
```

请注意，此代码易受攻击`SQL Injection`，请阅读下面的文章以了解如何防止它，

*   [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T22:09:26.883

```
$page_set = mysql_query("SELECT * FROM pages WHERE subject_id = {$subject['id']}", $connection); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T22:13:37.300

以上所有方法都可以，但我更喜欢自己的最干净的方法是：

```
$page_set = mysql_query("SELECT * FROM pages WHERE subject_id = '".$subject['id']."'", $connection); 
```

或者我给你的建议，作为初学者：

```
$subject_id = $subject['id'];
$page_set = mysql_query("SELECT * FROM pages WHERE subject_id = '$subject_id'", $connection); 
```

我建议你使用我写的第二种方法。这是最好和最干净的做法。

注意：请注意 mysql_ 扩展名已正式贬值。您应该使用 mysqli 或 PDO。(http://nl3.php.net/manual/en/function.mysql-query.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-16T22:14:56.643

那不是您的 SELECT 命令。那是一个 PHP mysql_query 命令。首先创建 SQL，然后用它查询数据库：

```
$sql = "SELECT * FROM pages WHERE subject_id  = {[$subject'id']}";
$page_set = mysql_query($sql, $connection); 
```

如果您随后遇到错误，您可以输出`$sql`并检查它的外观。与错误消息进行比较并修复 SQL 查询的构建。

如果您正在寻找如何完成变量输出的灵感，[请参阅现有答案](https://stackoverflow.com/a/13899571/367456)。

如果您使用 PDO 而不是已弃用（长期过时，不再受支持）的`mysql_*`功能，事情会变得更容易。尤其是参数化查询将帮助您构建 SQL 命令，这些`mysql_*`功能甚至不支持！

有关教程，请参阅：[MySQL 开发人员的 PDO 教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-16T22:19:38.707

展望未来，在一个单独的变量中构造您的查询字符串，如下所示：

```
$sql = "SELECT * FROM pages WHERE subject_id  = {[$subject'id']}"; 
```

然后像这样运行查询：

```
$res = mysql_query($sql); 
```

如果你这样做，你可以看到完全解析的查询字符串，如下所示：

```
if (!$res) die("FAIL: $sql BECAUSE: " . mysql_error()); 
```

您*必须*测试 mysql_query() 的结果值——它不是黑匣子；由于您无法控制的原因，它可能而且将会失败。当故障发生时，您希望识别它并处理错误情况。

Siedbar 注意：mysql 扩展现在已被 PHP 弃用，因此您可能希望为当前/未来的工作选择 PDO 或 MySQLi。

如果您是 PHP 新手，这是一本非常好的书，可以帮助您入门： [http ://www.sitepoint.com/books/phpmysql5/](http://www.sitepoint.com/books/phpmysql5/)

# c - 具有非确定性输出的 C fork and pipe 程序

> ID：13905948
> 
> 赞同：-1
> 
> 时间：2012-12-16T22:07:22.270
> 
> 标签：c, signals, posix, fork, pipe

让我们考虑下面的代码（请不要写，有命名问题，结构问题等，我也知道这一点）。编写它是为了为其 3 个孩子写出随机生成的 x、y、z 和 r（和 pid）数字，但经常发生它只打印两个/一个“得到这个...”行，我不知道， 为什么。你能解释一下，问题是什么，或者更正我的代码吗？

```
#include <stdlib.h> 
#include <stdio.h>
#include <sys/types.h> //fork
#include <sys/stat.h>
#include <unistd.h>
#include <string.h>
#include <fcntl.h> //lock
#include <signal.h>
#include <time.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/msg.h>
#include <sys/shm.h>
#include <sys/wait.h>
#include "sys/ipc.h"
#include "sys/sem.h"

int child;
int cs[3];
int fd[2];
int t;
int parent;
int child;

void okay(int sign)
{
  t = 0;
}

void rr(int sign)
{
  char b[50];
  while(read(fd[0], &b, 50)<0) sleep(0.5);
  printf("Got this: %s \n", b);
}

void ch(int argc, char** argv)
{
  printf("Mypid: %i\n", getpid());
  close(fd[0]);
  while(t==1) sleep(1);
  srand((unsigned)time(NULL)); // init
  int x,y,z,r,pid;
  x = rand() % 101; y = rand() % 101; z = rand() % 101; r = rand() % 101;
  pid = getpid();
  char b[50];
  sprintf(b, "%i %i %i %i %i", pid, x, y, z, r);
  while(write(fd[1], b, 50)<0) sleep(0.2);
  kill(parent, SIGUSR2);
  close(fd[1]);
}

int main(int argc, char** argv)
{
  if(argc < 4)
  {
    printf("Too few args!\n");
    return 0;
  }
  pipe(fd);
  t = 1;
  parent = getpid();
  signal(SIGUSR1, okay);
  child = fork();
  if(child < 0) perror("FORK");
  if(child > 0)
  {
    cs[0] = child;

    child = fork();
    if(child < 0) perror("FORK");
    if(child > 0)
    {

      cs[1] = child;

      child = fork();
      if(child < 0) perror("FORK");
      if(child > 0)
      {
        cs[2] = child; // MAIN
        printf("%i %i %i\n", cs[0], cs[1], cs[2]);
        close(fd[1]);
        signal(SIGUSR2, rr);
        kill(cs[0], SIGUSR1); kill(cs[1], SIGUSR1); kill(cs[2], SIGUSR1);
        int status;

            waitpid(cs[0], &status, 0);
            waitpid(cs[1], &status, 0);
            waitpid(cs[2], &status, 0);
            close(fd[0]);

      }else
      { // ch 3
        ch(argc, argv);
      }   

    }else
    { // ch 2
      ch(argc, argv);
    }  

  }else
  { // ch 1
    ch(argc, argv);
  }
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T22:21:09.253

## 重写的答案

即使使用各种修改版本的代码，我也能够获得所描述的行为。例如，我从带有诊断功能的代码版本中得到的一个跟踪是：

```
14607 at work
Children: 14608 14609 14610
Children signalled
Child 14609: signal 30 - setting t to 0
Child 14608: signal 30 - setting t to 0
Child 14610: signal 30 - setting t to 0
Child 14609: at work
Child 14610: at work
Child 14608: at work
Child 14609: sending 14609 65 24 97 0
Child 14609: exiting
Child 14610: sending 14610 87 17 23 57
Adult 14607: signal 31 - reading input
Child 14610: exiting
Child 14608: sending 14608 5 89 95 8
Child 14608: exiting
Adult 14607: got <<14609 65 24 97 0>>
Adult 14607: signal 31 - reading input
Adult 14607: got <<14610 87 17 23 57>>
Child 1 ended
Child 2 ended
Child 3 ended
14607 exiting 
```

您可以看到父级从 14609 和 14610 获取数据，但不是从 14608 获取数据。我将其归因于信号的使用。它们对于 IPC 来说是一个非常糟糕的机制。而且，在这种情况下，他们似乎对时间不可靠。这是使用`sigaction()`and`sa.sa_mask`值设置为阻止所有信号 ( `sigfillset(&sa.sa_mask)`) 的代码。

但是，实际上没有任何需要使用从孩子返回给父母的信号。我已将信号处理程序保留在适当的位置，以便父级通知子级进行编织，但将其简化为简单地将`volatile sig_atomic_t`变量的值（`t`按名称，仍然）从 ​​1 更改为 0。表达式是“使用”信号编号参数（`sign`在代码中调用）；当我在 Mac OS X 10.7.5 上使用 GCC 4.7.1 进行编译时，它避免了警告：

```
gcc -O3 -g -std=c99 -Wall -Wextra -Wmissing-prototypes -Wstrict-prototypes \
    pipes-13905948.c -o pipes-13905948 
```

种子`srand()`将时间与进程的 PID 混合以从每个子进程中提供不同的值（单独使用 PID 也可以做到这一点）。我将原始文件中的 16 个标题（包括两次重复）删除为 7 个。我已将其删除`rr()`，因为父级不再响应来自子级的信号。我已经重组了代码`main()`所以它不会跳出页面的 RHS。该代码包括有关正在发生的事情的大量诊断。如果大多数消息都打印了 PID 作为消息的一部分，则在处理这样的多个进程时会很有帮助。我使用“成人”而不是“父母”，因此输出与标记为“儿童”的行整齐对齐。请注意，信号处理程序是在孩子分叉之前设置的。在多 CPU 机器上，无法保证进程将执行的顺序，因此将信号设置留到分叉之后是不明智的，最坏的情况是可能导致意外死亡。

信号处理程序中的读取被替换为读取中的父代码`main()`；这是处理输入的更令人满意的方式。您的目标应该是尽可能少地使用信号处理程序。C 标准不能可靠地支持更多：

> ISO/IEC 9899:2011 §7.14.1`signal`功能
> 
> ¶5 如果信号的出现不是调用`abort`or`raise`函数的结果，则如果信号处理程序引用具有静态或线程存储持续时间的任何对象，该对象不是无锁原子对象，则行为未定义，而不是通过赋值到声明为 的对象`volatile sig_atomic_t`，或者信号处理程序调用标准库中的任何函数，而不是`abort`函数、`_Exit`函数、 `quick_exit`函数或`signal`函数，其第一个参数等于与导致调用的信号对应的信号编号处理程序。

POSIX 更为宽松，但您仍然需要非常小心在信号处理程序中执行的操作，并且您应该尽可能少地在信号处理程序中执行操作。

这些更改导致此代码：

```
#include <signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/wait.h>
#include <time.h>
#include <unistd.h>

static int fd[2];
static volatile sig_atomic_t t = 1;
static int parent;

static void okay(int sign)
{
    t = (sign == 0);
}

static void ch(void)
{
    int pid = getpid();
    printf("Child %i: at work\n", pid);
    close(fd[0]);
    while (t == 1)
    {
        printf("Child %d: pausing on t\n", pid);
        pause();
    }
    srand((unsigned)time(NULL) ^ pid);
    int x = rand() % 101;
    int y = rand() % 101;
    int z = rand() % 101;
    int r = rand() % 101;
    char b[50];
    sprintf(b, "%i %i %i %i %i", pid, x, y, z, r);
    printf("Child %d: sending %s\n", pid, b);
    while (write(fd[1], b, strlen(b)) < 0)
        printf("Child %d: write failed\n", pid);

    close(fd[1]);
    printf("Child %d: exiting\n", pid);
    exit(0);
}

int main(void)
{
    int cs[3];
    pipe(fd);
    parent = getpid();
    printf("%d at work\n", parent);

    struct sigaction sa;
    sa.sa_flags = 0;
    sigfillset(&sa.sa_mask);

    sa.sa_handler = okay;
    sigaction(SIGUSR1, &sa, 0);

    if ((cs[0] = fork()) < 0)
        perror("fork 1");
    else if (cs[0] == 0)
        ch();
    else if ((cs[1] = fork()) < 0)
        perror("fork 2");
    else if (cs[1] == 0)
        ch();
    else if ((cs[2] = fork()) < 0)
        perror("fork 3");
    else if (cs[2] == 0)
        ch();
    else
    {
        printf("Children: %i %i %i\n", cs[0], cs[1], cs[2]);
        close(fd[1]);

        kill(cs[0], SIGUSR1);
        kill(cs[1], SIGUSR1);
        kill(cs[2], SIGUSR1);
        printf("Children signalled\n");

        char buffer[64];
        int nbytes;
        while ((nbytes = read(fd[0], buffer, sizeof(buffer)-1)) > 0)
        {
            buffer[nbytes] = '\0';
            printf("Adult %d: read <<%s>>\n", parent, buffer);
        }

        int status;
        waitpid(cs[0], &status, 0);
        printf("Child 1 ended\n");
        waitpid(cs[1], &status, 0);
        printf("Child 2 ended\n");
        waitpid(cs[2], &status, 0);
        printf("Child 3 ended\n");
        close(fd[0]);
    }
    printf("%d exiting\n", (int)getpid());
    return 0;
} 
```

代码在错误处理上仍然不稳定；有很多未经检查的系统调用和未报告的结果（如子状态）。我不相信在失败时重试写入，但代码从未被执行过。

这是代码修订版的痕迹。

```
15745 at work
Children: 15746 15747 15748
Children signalled
Child 15746: at work
Child 15746: sending 15746 63 4 70 89
Child 15748: at work
Child 15746: exiting
Child 15747: at work
Adult 15745: read <<15746 63 4 70 89>>
Child 15748: sending 15748 44 0 99 37
Child 15748: exiting
Child 15747: sending 15747 3 69 68 97
Adult 15745: read <<15748 44 0 99 37>>
Child 15747: exiting
Adult 15745: read <<15747 3 69 68 97>>
Child 1 ended
Child 2 ended
Child 3 ended
15745 exiting 
```

有几次，我得到了如下输入：

```
Adult 15734: read <<15736 83 95 64 2915737 42 63 66 89>> 
```

这将进程 15736 和 15737 的输出组合成单个读取结果。我对此不满意；AFAIK，读取应该将单独子项的原子写入作为单独的消息。在没有进一步研究的情况下，我将把它归结为 Mac OS X 的一个怪癖。

* * *

## 原始答案

由于您使用的是`signal()`而不是`sigaction()`，因此您的信号处理程序可能会在调用信号处理程序之前重置为 SIGDFL。您可以`okay()`通过添加以下内容来解决此问题：

```
void okay(int sign)
{
    signal(sign, okay);
    t = 0;
} 
```

您可以通过检查处理程序中的返回值来监控这是否是一个问题`signal()`。

~~您的其余代码当前未使用`t`（尽管它设置为`1`in `main()`）。~~（*观察不准！*）

您可以通过更多的打印操作使您的调试更容易。您可以使用循环来杀死和收集您的孩子（尽管可以像您所做的那样写出循环；但是不要将三个函数调用放在一行上）。

# javascript - 禁止为触摸屏设备加载 j avascript

> ID：13905949
> 
> 赞同：1
> 
> 时间：2012-12-16T22:07:23.490
> 
> 标签：javascript

我正在使用 tinyscrollbar 来替换我的 Web 应用程序桌面版本上的标准滚动条。这样做的主要原因是我在所有桌面浏览器中都有一致且漂亮的设计。在 android、移动 ios 设备和 windows 移动设备上，我只想使用本机滚动器。这意味着我不想包含我的滚动 css 或它的 javascript。如果有人对此有任何经验，那将非常有帮助。我担心 Windows 8 机器，因为它们是台式机和平板电脑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T22:17:57.030

对于条件加载，我建议[Yepnope](http://yepnopejs.com/)，它是 Modernizr 中使用的脚本加载器[（](http://modernizr.com/docs/#load)因此，如果您使用 Modernizr，它可能已经存在）。

```
Modernizr.load({
  test : Modernizr.touch,
  nope : 'slick-scroller.js'
}); 
```

# c# - DataGridview 不在不同的计算机上显示数据

> ID：13905961
> 
> 赞同：0
> 
> 时间：2012-12-16T22:08:34.427
> 
> 标签：c#, winforms, .net-4.0, datagridview

我创建了一个基于 SQLite DB 的小型应用程序。它使用 3 个绑定到 BindingList<> 的网格来显示来自对象的数据。

数据绑定是这样生成的：

```
skillDataGridView.AutoGenerateColumns = false;
skillDataGridView.DataSource = (BindingList<ISkill>)character.Skills;
skillDataGridView.Columns["skillvalue"].ReadOnly = false; 
```

和

```
public interface ISkill : INotifyPropertyChanged, IModifyableValueItem, IXPCostingItem, IDBItem
{
    string Attribute { get; }
}

public interface IModifyableValueItem
{
    string Name { get; }
    int Value { get; set; }
}

public interface IXPCostingItem
{
    int ExperienceCost { get; }
} 
```

这适用于我的电脑 - 完美无缺。现在我创建了一个发布版本。这也适用于我的计算机，但如果我的朋友在他的计算机上运行它，它会将行添加到网格视图中，但它们不包含数据，就好像数据绑定不起作用一样。这怎么可能发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T12:03:36.250

这不是一个真正的答案 - 但如果我更改为 .NET Framework 4.5，它也可以在其他计算机上运行。

# c# - 如何从包含 C# 中的数组的列表中获取直接值

> ID：13905963
> 
> 赞同：0
> 
> 时间：2012-12-16T22:08:38.553
> 
> 标签：c#, arrays, list, get

如何从包含数组的列表中获取直接值？

嘿伙计们，我想直接从包含数组的列表中获取某个值

```
 List<int[]> myList = new List<int[]>();
 myList.Add( new int[2] { 10, 11 } ); 
```

我很清楚使用 foreach 循环来得到这个

```
foreach ( int[] p in mylist)
      console.write(p[0]); 
```

我确实想使用像 list[0] 这样的表达式来检索这个单个数据以获取整数列表

谢谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-16T22:11:13.587

您的问题很不清楚，但是如果您知道数组中的数组索引，则可以使用：

```
int value = myList[listIndex][arrayIndex]; 
```

实际上，这只是在做：

```
int[] array = myList[listIndex];
int value = array[arrayIndex]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T22:24:51.663

我不完全确定你的意思。. .

它看起来像一个二维数组：myList [列表中数组的位置] [选定数组中项目的位置]。这是因为列表是通用容器，重载的括号运算符将返回特定类型（在本例中为数组），然后您可以再次使用括号来引用数组中包含的项目。

您编写的代码片段实际上只迭代列表中的第一项 foreach 数组（这是故意的）？

本质上，您需要 2 条信息，除非您只想要每个列表中的第一项（位置 0），在这种情况下，您将创建一个新的容器类，实现 IList 接口并重载括号运算符，如下所示：

```
 public int this[int index]
    {
        get
        {
            return myList[index][0];
        }
        set
        {
            myList[index][0] = value;
        }
    } 
```

# jquery - 在滚动结束时停止 Keypress 事件

> ID：13905964
> 
> 赞同：1
> 
> 时间：2012-12-16T22:08:39.740
> 
> 标签：jquery, scroll, keypress, scrollto

我正在使用scrollTo 插件创建一个长的垂直页面，您可以在单击或按键时滚动到每个新帖子。

这是布局：

```
<div id="wrap">
    <div class="entry"></div>
    <div class="entry"></div>
    <div class="entry"></div>
    <div class="entry"></div>
</div>

<div id="controls">
    <span class="prev">UP</div>
    <span class="next">DOWN</div>
</div> 
```

这是jQuery：

```
function scrollToPosition(element) {
    if (element !== undefined) {
        $('html, body').scrollTo(element, 500, {
            margin: true
        }); 
    }
}
$(function() {
    var posts = $('.entry');
    var position = 0;
    var next = $('.next');
    var prev = $('.prev').hide();
    next.click(function(evt) {
        prev.fadeIn();
        scrollToPosition(posts[position += 1]);
        if (position === posts.length - 1) {
            next.fadeOut();
        }
    });
    prev.click(function(evt) {   
        next.fadeIn();
        scrollToPosition(posts[position -= 1]);
        if (position === 0) {
            prev.fadeOut();
        }
    });
});
$(document).keydown(function(e){
    e.preventDefault();    
    if (e.keyCode == 40) { 
       $('.next').click();
    }
    else if (e.keyCode == 38) { 
       $('.prev').click();
    }
}); 
```

除了使用按键时，一切都有效。如果我击中（下一个）5 次，一旦你触底。我必须打 (Prev) 5 次，再加上 1 次才能真正上去。我知道为什么会发生这种情况背后的逻辑，但我不知道阻止它的解决方案。我需要指示按键结束。

谢谢

--

最终代码：

```
 $(function() {
    var posts = $('.folio');
    var position = 0;
    var next = $('.next');
    var prev = $('.prev').hide();
    next.click(function(evt) {
        prev.fadeIn();
        scrollToPosition(posts[position += 1]);
        if (position === posts.length - 1) {
            next.fadeOut();
        }
    });
    prev.click(function(evt) {   
        next.fadeIn();
        scrollToPosition(posts[position -= 1]);
        if (position === 0) {
            prev.fadeOut();
        }
    });
    $(document).keydown(function(e) {
        if (e.which == 40 && next.is(":visible")) {
            next.click();
            return false
        } else if (e.keyCode == 38 && prev.is(":visible")) {
            prev.click();
            return false
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T23:25:52.517

只需检查 keydown 事件中下一个/上一个的可见性：

```
if (e.which == 40 && next.is(":visible")) { ... 
```

# android - Android：当应用程序未运行时接收推送通知

> ID：13905970
> 
> 赞同：3
> 
> 时间：2012-12-16T22:08:53.950
> 
> 标签：android, service, push-notification

我希望在我的应用程序中实现推送通知。我已经从应用程序的上下文中发送了通知，但我希望用户在应用程序未运行时接收通知。例如，当您有新消息时，您会收到 Twitter 或 Facebook 通知，但 Facebook 应用程序未打开或运行。我将从服务器读取数据。当服务器发出消息时，我希望用户收到通知，无论应用程序是否打开。我看过`Service`但找不到任何有希望的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T22:16:34.767

在您的应用中实施[Google Cloud Messaging 。](http://developer.android.com/google/gcm/index.html)这是通过谷歌服务发送推送通知来实现的，谷歌服务在安卓设备上几乎总是处于活动状态。然后，这些服务会将通知广播到您的应用，您可以在从 Google 服务收到数据后处理和使用这些数据。

# python - 使用 python urlopen 进行 url 查询

> ID：13905972
> 
> 赞同：0
> 
> 时间：2012-12-16T22:09:13.903
> 
> 标签：python, http, url

也用于url`urlopen`查询似乎很明显。我尝试的是：

```
import urllib2
query='http://www.onvista.de/aktien/snapshot.html?ID_OSI=86627'
f = urllib2.urlopen(query)
s = f.read()
f.close() 
```

但是，对于这个特定的 url 查询，当在我的浏览器中输入这个查询时，它会因为 HTTP 错误 403 被禁止而失败。此外，当使用[http://www.httpquery.com/](http://www.httpquery.com/)提交查询时，它也可以工作。

您对如何正确使用 Python 来获取正确响应有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T22:13:13.197

看起来它需要 cookie ......（你可以用 urllib2 来做），但如果你这样做，一个更简单的方法是使用[请求](http://docs.python-requests.org/en/latest/)

```
import requests
session = requests.session()
r = session.get('http://www.onvista.de/aktien/snapshot.html?ID_OSI=86627') 
```

这通常是在 Python 中检索 URL 的一种更容易且压力更小的方法。

`requests`将自动为您存储和重复使用 cookie。在这里创建会话有点矫枉​​过正，但当您需要将数据提交到登录页面等时很有用......

**使用 urllib2 类似于**

```
import urllib2, cookielib

cookies = cookielib.CookieJar()
opener = urllib2.build_opener( urllib2.HTTPCookieProcessor(cookies) )
data = opener.open('url').read() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T22:20:49.933

看来 urllib2 默认用户代理已被主机禁止。您可以简单地提供自己的用户代理字符串：

```
import urllib2
url = 'http://www.onvista.de/aktien/snapshot.html?ID_OSI=86627'
request = urllib2.Request(url, headers={"User-Agent" : "MyUserAgent"})
contents = urllib2.urlopen(request).read()
print contents 
```

# python - openerp 报告语法

> ID：13905975
> 
> 赞同：2
> 
> 时间：2012-12-16T22:09:30.543
> 
> 标签：python, report, openerp, tryton

我一直在努力尝试在 openerp 中模仿在 Tryton 中找到的关于 Health GNU 模块的报告。在他们的报告文件夹中有一个**report.odt**文件，与 openerp 中的任何 sxw 报告非常相似，但有一些例外。例如，代替 openERP 的：

`[[repeatIn(objects,'test')]]`

我们有一个开始和结束标签，**用于**制作前面的例子：

`<FOR EACH="TEST IN OBJECTS"> .... </FOR>`

如何在传统的 sxw 报告中模仿以下内容：

`<for each="case in test.critearea">`
`<if test="case.excluded==0">` #this 在表之外
`...values in table...` #table 从这里开始
`</if>`
`<for>`
，匹配时基本上排除一整行。
使用熟悉的语法，例如`[[ case.excluded==False ]]`没用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-17T08:27:26.163

tryton 报告系统基于[relatorio lib](http://relatorio.openhex.org/)并使用您发现的 odt/ods。如果你想使用类似的东西，你必须使用[Aeroo](https://launchpad.net/aeroo)（以前的[report_openoffice](https://launchpad.net/report-openoffice)）。它与 RML 的东西不兼容。

这种方法比 openerp 的内部方法要理智得多，并且会大大提高您的“报告效率”。您也可以考虑使用允许您以 HTML 格式编写报告的[report_webkit 。](http://apps.openerp.com/addon/621?filter=%7B%22order_by%22%3a%20%22click_counter%20desc%22%7D&page=2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T22:28:09.387

在第一个表格单元格中，这有效：
`[[((case.excluded == False) or removeParentNode('blockTable')) and '']][[case.name]]`
虽然我仍然想知道是否有更合乎逻辑的方式而不是破坏整个创建的块表，特别是因为我将试图弄清楚如何在删除时不留下空行父节点'blocktable'。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-18T02:49:21.823

您可以迭代由报告的相关 .py 文件中定义的函数生成的列表。

只需在插件上查找示例，其中有很多，例如：

> account/report/account_aged_pa​​rtner_balance.rml: [[ repeatIn(get_lines(data['form']), 'partner') ]]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T04:13:02.427

由于 的内容`[[...]]`只是 python 代码，您可以在迭代之前使用[列表综合](http://www.python.org/dev/peps/pep-0202/)来过滤掉内容。所以代替这个：

```
[[repeatIn(cases,'case')]] 
```

尝试这个：

```
[[repeatIn([c for c in cases where not case.excluded], 'case']) 
```

或者你可以使用内置的过滤器（）：

```
[[repeatIn(filter(lambda c: not c.excluded, cases), 'case'])]] 
```

# android - 第二次充气时出现 Android 地图 v2 错误

> ID：13905977
> 
> 赞同：5
> 
> 时间：2012-12-16T22:09:57.563
> 
> 标签：android, android-mapview

我正在尝试在我的应用程序中使用新的 android 地图。

我有一个 FragmentActivity 布局包含（除其他外）：

```
<LinearLayout a:id="@+id/fragment_container"
    a:layout_width="fill_parent"
    a:layout_height="100dp"
    a:layout_weight="1"/> 
```

它还有一个按钮，可以使用（主要从示例项目复制）更改此片段：

```
if (condition) {
    fragment = new Fragment1();
} else {
    fragment = new LocationFragment();
}
FragmentManager fragmentManager = getSupportFragmentManager();
FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
fragmentTransaction.replace(R.id.fragment_container, fragment);
fragmentTransaction.commit(); 
```

和 LocationFragment 是：

```
public class LocationFragment extends SupportMapFragment{
private GoogleMap mMap;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
                         Bundle savedInstanceState) {
    super.onCreateView(inflater, container, savedInstanceState);
    view = inflater.inflate(R.layout.map_fragment, container, false);
    setUpMapIfNeeded();
    return view;
}

@Override
public void onResume() {
    super.onResume();
    setUpMapIfNeeded();
}

private void setUpMapIfNeeded() {
    // Do a null check to confirm that we have not already instantiated the map.
    if (mMap == null) {
        // Try to obtain the map from the SupportMapFragment.
        mMap = ((SupportMapFragment)  getActivity().getSupportFragmentManager().findFragmentById(R.id.map))
                .getMap();
        // Check if we were successful in obtaining the map.
        if (mMap != null) {
            setUpMap();
        }
    }
}

private void setUpMap() {
    mMap.addMarker(new MarkerOptions().position(new LatLng(60.02532, 30.370552)).title(getString(R.string.map_current_location)));
}
} 
```

xml布局是：

```
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
      android:id="@+id/map"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      class="com.google.android.gms.maps.SupportMapFragment"/> 
```

问题是当我们第二次用 LocationFragment 替换 Fragment 时，android 无法从 xml 膨胀。它在线崩溃：

```
view = inflater.inflate(R.layout.map_fragment, container, false); 
```

除了：

```
12-17 01:47:31.209: ERROR/AndroidRuntime(4679): FATAL EXCEPTION: main
    android.view.InflateException: Binary XML file line #4: Error inflating class fragment
    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:587)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:386)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
    at my.package.LocationFragment.onCreateView(LocationFragment.java:29)
    ... 
```

而且我不知道如何解决它。我认为这可能与您不能使用多个地图视图的旧问题有关（在 android map v1 上找到问题）。但是在 v2 和片段支持的情况下，它必须是用地图片段替换片段容器的方法，对吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-29T12:18:30.733

Remove your mapview fragment into onDestroyView method.

```
Fragment fragment = (getFragmentManager().findFragmentById(R.id.mapview));
FragmentTransaction ft = getActivity().getSupportFragmentManager().beginTransaction();
ft.remove(fragment);
ft.commit(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-16T22:16:57.297

你正在扩展`SupportMapFragment`. 这很好，尽管我不确定这种模式会有多普遍（这有点太新了）。

但是，`SupportMapFragment` *它是*一个片段，并且*知道*如何显示地图。在大多数情况下，您不应该`onCreateView()`覆盖，当然也不应该覆盖并尝试*扩展*`onCreateView()`包含`<fragment>`指向.*`SupportMapFragment`*

这是一个使用`SupportMapFragment`Maps V2 库[的示例应用程序。](https://github.com/commonsguy/cw-omnibus/tree/master/MapsV2/Basic)该*活动*加载具有以下内容的布局`SupportMapFragment`：

```
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/map"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  class="com.google.android.gms.maps.SupportMapFragment"/> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-19T04:05:03.980

我没有扩展 SupportMapFragment ，而只是将其包含在使用 XML 的（常规）片段中，如上述答案中一样，但我得到了相同的结果... android.view.InflateException: Binary XML file line #4: Error inflating class when自发布以来，我第二次尝试为包含的片段充气。

我解决了这个问题，不是从 XML 中膨胀 MapFragment，而是在包含的片段 XML 中使用 FragmentLayout 留下一个占位符，然后在运行时以编程方式添加这个 MapFragment。完美运行。

包含片段 XML 看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <!-- This is commented out because it crashed on second inflate.
    <fragment
        android:id="@+id/mapFragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginBottom="60dp"
        class="com.google.android.gms.maps.SupportMapFragment" />
    -->

    <FrameLayout
            android:id="@+id/mapFragmentHole"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginBottom="60dp"
            android:layout_gravity="center_vertical|center_horizontal" /> 
    .
    .
    . 
```

然后在我的包含片段 java 代码中，我执行以下操作。这还展示了如何在 MapFragment 出现之前使用 GoogleMapOptions 对其进行配置。

```
_view = inflater.inflate(R.layout.fragment_map, container, false);

GoogleMapOptions gmo = (new GoogleMapOptions()).zoomControlsEnabled(false).rotateGesturesEnabled(false);
mapFragment = SupportMapFragment.newInstance(gmo);
FragmentTransaction fragmentTransaction = getFragmentManager()
        .beginTransaction();
fragmentTransaction.add(R.id.mapFragmentHole, mapFragment);
fragmentTransaction.commit(); 
```

在上面的代码中，mapFragment 是一个成员变量，所以我可以稍后访问它以获取 GoogleMap 对象，就像这样......

```
GoogleMap map = mapFragment.getMap(); 
```

但是，如果您在 onCreateView 中膨胀并执行 MapFragment 切换，您将无法在同一方法中获得有效的 GoogleMap 对象，因此您必须等到稍后再用数据填充地图。在我的代码中，我启动了一个后台线程来从我的 onCreateView 方法加载数据。加载数据后，它会在 UiThread 上调用一个方法来用工件填充地图。

希望这可以帮助。祝你好运！

-M。

# css - Opera 中的 CSS 边距

> ID：13905986
> 
> 赞同：-1
> 
> 时间：2012-12-16T22:11:42.527
> 
> 标签：css, opera, css-selectors

我在[这个网站](http://healinghands.vtable.us/)上工作，我在小部件区域绿色容器中的上双引号有问题。在所有浏览器中看起来都不错（即使在 IE7 和 IE8 中），但在 Opera 中，边距或填充发生了一些事情，因此它不合适。有人可以帮我理解这个吗！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T23:30:57.910

我会尝试删除`margin-top`from `.textwidget #testimonial`（您的风格中的第 1652 行）并将其移至`.textwidget`课堂。（使用 Opera 蜻蜓在 10 秒内找到它）。

# python - ImportError：没有名为 _sqlite3 的模块使用 Python 2.7

> ID：13905989
> 
> 赞同：2
> 
> 时间：2012-12-16T22:11:56.377
> 
> 标签：python, django, sqlite

我已经编译了 python 2.7 和 django 1.3。使用 django 时，我发现它报告了..

```
ImportError: No module named _sqlite3 
```

我确保安装并重新编译了所有正确的 sqlite 包，但仍然没有乐趣。

```
[root@monty Python-2.7.3]# rpm -qa | grep sql
sqlite-devel-3.3.6-5
postgresql-libs-8.1.23-6.el5_8
sqlite-3.3.6-5
python-sqlite-1.1.7-1.2.1
sqlite-devel-3.3.6-5
sqlite-3.3.6-5
python-sqlite2-2.6.3-1.el5.rf
postgresql-libs-8.1.23-6.el5_8 
```

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-17T06:20:32.657

安装

```
sqlite-devel 
```

更重要的是重建 Python。

# java - Java 等效于未捕获异常的 coredump

> ID：13905996
> 
> 赞同：5
> 
> 时间：2012-12-16T22:13:10.653
> 
> 标签：java, error-handling, crash-dumps

Linux coredump 或 Windows minidump 的 Java 等价物是什么？我读过关于堆转储的内容，它看起来像我想要的，但是如何在未捕获的异常上（自动）触发它们？

我知道未捕获的异常处理程序，并且我已经在使用它来打印异常+堆栈跟踪并终止整个应用程序（否则线程死亡并且应用程序继续运行？嗯？）我还发现[了这篇](https://blogs.oracle.com/sundararajan/entry/programmatically_dumping_heap_from_java)关于如何记录堆的帖子从代码中转储，但是如果我从未处理的异常处理程序中执行此操作，Java 已经捕获了异常并且堆栈跟踪（和参数）消失了。

我遇到了`-XX:+HeapDumpOnOutOfMemoryError`似乎可以满足我需要的标志，不幸的是仅针对内存不足的异常，而不针对其他未捕获的异常。

到目前为止，这是我唯一能够摆脱谷歌的东西。目前我正在使用带有异常断点的附加调试器，但这是不切实际的，因为它也会在处理的异常上中断，所以它不能在无人监督的情况下使用。

**[动机更新]**

我希望能够检查堆栈跟踪的参数和局部变量，以找出导致异常的原因。它通常是空引用异常或失败的断言，我不能总是从行号猜测到底出了什么问题。在 C/C++ 中，我习惯于使用 coredump/minidump 崩溃，然后进一步检查实际导致崩溃的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T05:32:57.730

如果您不使用 JNI 并调用本机代码，则很难破坏 JVM 的内存，异常不需要堆转储或核心转储。

在 Java 世界中，抛出异常的代码应该为阅读异常的人提供足够的信息，以便能够确定问题的原因。有时这不会发生，处理它的正确方法是修改异常抛出代码以在异常中提供更多信息或将某些内容记录到日志文件中。

如果抛出异常的代码不受您的控制并且您无权访问源代码，那么您可以使用 AspectJ 来编织一些关于该方法抛出异常的建议，然后您可以检查函数参数方面并记录它们。但是在您进行路由 aspectJ / 字节代码编织之前，您可能想查看您尝试理解的代码是否使用 log4j 或其他具有调试日志记录级别的日志框架，这可能会包含您正在寻找的信息。

您可能想看看 Google Guava Open Source Library，它有一个很好的关于 Pre conidtions 的部分，您可以使用它来验证参数并获取有关问题原因的更多上下文。[http://code.google.com/p/guava-libraries/wiki/PreconditionsExplained](http://code.google.com/p/guava-libraries/wiki/PreconditionsExplained)

您还想查看[http://www.slf4j.org/](http://www.slf4j.org/)，它有一个很好的日志记录 API，您可以使用它来记录有关您遇到的问题的信息。

你也可以在eclipse中做条件断点，这允许你让断点只在某些情况下执行。[http://wiki.eclipse.org/FAQ_How_do_I_set_a_conditional_breakpoint%3F](http://wiki.eclipse.org/FAQ_How_do_I_set_a_conditional_breakpoint%3F)

另一个要使用的工具是 jvisiual vm，它允许您连接到实时虚拟机并找出有关虚拟机内部发生的很多信息，例如所有线程在哪里，如果有的话是死锁，GC 正在做什么，以及您可以用它触发堆转储，然后查询它们并查看堆转储中特定对象的状态。[http://docs.oracle.com/javase/7/docs/technotes/guides/visualvm/index.html](http://docs.oracle.com/javase/7/docs/technotes/guides/visualvm/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:23:18.047

我不认为堆转储是您正在寻找的。这只是堆的转储，打开该开关的原因是，如果您遇到 OOM 异常，您可能想要调查的一件事是内存的用途，以便您可以找到您的泄漏（或其他问题）。

这正是您想要使用它们的目的吗？也许有一种替代但更好的方法来满足您在 java 中的需求。我认为我从来没有需要像 java 的核心或小型转储之类的东西。除了我希望有一种方法可以调用 abort() 只是为了能够研究代码如何最终到达它的位置的情况除外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-17T05:49:08.547

Oracle 的这篇博客描述了如何以编程方式进行堆转储：

[https://blogs.oracle.com/sundararajan/entry/programmatically_dumping_heap_from_java](https://blogs.oracle.com/sundararajan/entry/programmatically_dumping_heap_from_java)

它本质上使用热点`com.sun.management.HotSpotDiagnosticMXBean`及其`dumpHeap()`方法。它可能只适用于 Oracle/Sun JVM，并且不能保证它会在遥远的将来运行。

然而，困难的部分是，一旦你有了这个堆转储，如何从中获取有用的信息。我想你会从找到新抛出的异常对象开始，然后从那里开始。堆转储不会帮助您处理方法参数和局部变量值，因为堆转储中不会出现原语和引用。