# StackOverflow 问答 14677000-14677999

# r - 在 Windows 命令终端中启动 R

> ID：14677005
> 
> 赞同：12
> 
> 时间：2013-02-03T20:35:35.957
> 
> 标签：r

我不知道如何在 Windows 命令终端中启动 R。我在输入,后运行`cmd`以打开命令提示符，并尝试我发现的其他可能性，但我有一个错误：. 我安装了 R，我的桌面上有一个快捷方式，我可以将它用作 RGui，但我看到人们使用 R 的方式与命令行中的 python 类似。`R``rcmd``start R``'R' is not recognized as an internal or external command`

我有 32 位 Windows 7。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-03T20:38:39.740

如果它在您的路径类型上：

```
R.exe 
```

让它在你的道路上：

**开始/计算机/系统属性/高级系统设置/环境变量/在下框选择路径/编辑**

然后添加 R 的位置，我的位置，`C:\R\R-2.15.1\bin`但默认情况下它可能在程序文件中。

这是我的变量值的样子：

```
C:\R\R-2.15.1\bin\i386;C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\gcc-4.6.3\bin;C:\Rtools\MinGW\bin;C:\R\bin;C:\Perl64\bin; C:\Program Files (x86)\MiKTeX 2.8\miktex\bin;C:\Program Files (x86)\HP SimplePass 2012\x64;C:\Program Files (x86)\HP SimplePass 2012\;C:\Program Files\Common Files\Microsoft Shared\Windows Live;C:\Program Files (x86)\Common Files\Microsoft Shared\Windows Live;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files (x86)\Common Files\Roxio Shared\DLLShared\;C:\Program Files (x86)\Common Files\Roxio Shared\DLLShared\;C:\Program Files (x86)\Common Files\Roxio Shared\12.0\DLLShared\;C:\Program Files (x86)\Windows Live\Shared;C:\Program Files (x86)\Intel\Services\IPT\;C:\Program Files (x86)\Pandoc\bin;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\gs\gs9.06\bin;C:\Program Files (x86)\LibreOffice 3.5\URE\bin;C:\Program Files (x86)\MiKTeX 2.9\miktex\bin\; C:\Users\trinker\rubytools\bin 
```

然后单击确定三次。现在启动一个新的命令提示符，应该可以访问 R.exe。

# java - 无法从 Parts[] 转换为 Parts

> ID：14677009
> 
> 赞同：-1
> 
> 时间：2013-02-03T20:35:49.057
> 
> 标签：java, type-mismatch

首先，让我解释一下我要做什么。在java中，我正在创建一个与我在vb6中制作的高中cca程序之一相关的游戏（已经很好地提交了），但我仅限于我可以在其中做的事情，所以我正在工作用java。名为 Parts 的类的代码是这样开始的：

```
public class Parts implements Cloneable{
    public static Parts[] PartsList = new Parts[4096];
    public static HashMap<Integer,Boolean> ArrayList = new HashMap<Integer,Boolean>();
    protected boolean PartConstructerCalled = false;
    public int partTextureIndex;
    public final int partID;
    protected float partStat;
    protected String partConversion;
    private String partName;
    /**
     * To get everything started.
     */
    public static void Init_Parts(){}
    public Object clone() throws CloneNotSupportedException{
        return super.clone();
    }
    /**
    * Call this to create a new part.
    * Game crashes if an id you give is already used.
    * @param id Id to give to the part.
    */
    public Parts(int id, int textureid)
    {
        this.PartConstructerCalled = true;
        if(PartsList[id] != null){
            Variables.HackLog.severe("Part id of " + id + " is already used.");
            String partname = PartsList[id].getPartName();
            if(partname != "Un-named"){
                throw new IllegalArgumentException("id " + String.valueOf(id) + " was trying to take up part id of " + id + " which is already taken up by "+PartsList[id].getPartName() + ".");
            }else{
                    throw new IllegalArgumentException("id " + String.valueOf(id) + " was trying to take up part id of " + id + " which is already used.");
                }
        }else{
            this.partID = id;
            this.partName = "Un-named";
            this.partTextureIndex = textureid;
                PartsList[id] = this;
                ArrayList.put(id, false);
        }
    }
} 
```

好的，这是 Parts.java 中的一些代码，但主要是展示我需要修复的内容。MainParts.java 是我想要发生但不是代码的地方（同样，两个代码片段都不是完整代码）：

```
public class MainParts extends Parts{
    public static Parts[] CPU = CreatePartArray(1,1,4,"CPU");
    public static final float[] CPUStats = {1.28f,2.0f,3.36f,5.0f};
    public static final Parts Memory = new MainParts(2,2).setPartName("Memory").setPartStat(10.0f).setPartConversion("GB");
    public static final Parts Fan = new MainParts(3,3).setPartName("Fan").setPartStat(2.0f).setPartConversion("CPUs/Fan");
    public static void Init_MainParts(){
        Parts.Init_Parts();
        setPartArrayStat(CPUStats,CPU);
        setPartArrayConversion("GHz",CPU);
        Variables.HackLog.info("Parts initialized.");
    }
    public MainParts(int id, int textureid) {
        super(id, textureid);
    }
    /**
     *  This creates an array of a new part with the same id, still crashes if you create a single part or an array part with same id later on.
     *  @param id The id to give to new part
     *  @param texture The texture index to assign to part
     *  @param size The size of the array
     *  @param name To give to the array
     *  @return
     */
    public static Parts[] CreatePartArray(int id, int texture,int size,String name)
    {
        if(PartsList[id] != null){
            Variables.HackLog.severe("Part id of " + id + " is already used.");
            String partname = PartsList[id].getPartName();
            if(partname != "Un-named"){
                throw new IllegalArgumentException("id " + String.valueOf(id) + " was trying to take up part id of " + id + " which is already taken up by "+PartsList[id].getPartName() + ".");
            }else{
                throw new IllegalArgumentException("id " + String.valueOf(id) + " was trying to take up part id of " + id + " which is already used.");
            }
        }else{
            Parts temp = new MainParts(id,texture);
            Parts[] array = new Parts[1];
            Parts[] rarray = Arrays.copyOf(array, array.length + size);
            rarray[1] = temp;
            for(int i=2;i<rarray.length;i++){
                try{
                    rarray[i]=(MainParts)temp.clone();
                }catch(Exception e){
                    e.printStackTrace();
                }
            }
            PartsList[id] = rarray[1]; //Here is what works but not what I wanted.
            ArrayList.put(id, true);
            setPartArrayName(name,rarray);
            return rarray;
        }
    }
} 
```

这就是我希望它看起来但不起作用的样子：

```
public class MainParts extends Parts{
    public static Parts[] CPU = CreatePartArray(1,1,4,"CPU");
    public static final float[] CPUStats = {1.28f,2.0f,3.36f,5.0f};
    public static final Parts Memory = new MainParts(2,2).setPartName("Memory").setPartStat(10.0f).setPartConversion("GB");
    public static final Parts Fan = new MainParts(3,3).setPartName("Fan").setPartStat(2.0f).setPartConversion("CPUs/Fan");
    public static void Init_MainParts(){
        Parts.Init_Parts();
        setPartArrayStat(CPUStats,CPU);
        setPartArrayConversion("GHz",CPU);
        Variables.HackLog.info("Parts initialized.");
    }
    public MainParts(int id, int textureid) {
        super(id, textureid);
    }
    /**
     *  This creates an array of a new part with the same id, still crashes if you create a single part or an array part with same id later on.
     *  @param id The id to give to new part
     *  @param texture The texture index to assign to part
     *  @param size The size of the array
     *  @param name To give to the array
     *  @return
     */
    public static Parts[] CreatePartArray(int id, int texture,int size,String name)
    {
        if(PartsList[id] != null){
            Variables.HackLog.severe("Part id of " + id + " is already used.");
            String partname = PartsList[id].getPartName();
            if(partname != "Un-named"){
                throw new IllegalArgumentException("id " + String.valueOf(id) + " was trying to take up part id of " + id + " which is already taken up by "+PartsList[id].getPartName() + ".");
            }else{
                throw new IllegalArgumentException("id " + String.valueOf(id) + " was trying to take up part id of " + id + " which is already used.");
            }
        }else{
            Parts temp = new MainParts(id,texture);
            Parts[] array = new Parts[1];
            Parts[] rarray = Arrays.copyOf(array, array.length + size);
            rarray[1] = temp;
            for(int i=2;i<rarray.length;i++){
                try{
                    rarray[i]=(MainParts)temp.clone();
                }catch(Exception e){
                    e.printStackTrace();
                }
            }
            PartsList[id] = (Parts)rarray; //This is what I want it to look like but sadly, errors :(
            ArrayList.put(id, true);
            setPartArrayName(name,rarray);
            return rarray;
        }
    }
} 
```

对于我希望它看起来像的那个给出了这个错误：

```
Type mismatch: cannot convert from Parts[] to Parts 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:43:35.820

`rarray``Parts[]`是**Parts 对象数组的**类型。您正在尝试将其转换为单个`Parts`对象。你怎么看它可以做到？例如，您可以从数组中获取一些元素并将其分配给某个`Parts`对象`PartsList[id] = rarray[0]`。但这只是一个例子，我真的不知道你想在这里分配什么。

# c# - C# WinForms - 如何制作锁定主窗体的窗体

> ID：14677018
> 
> 赞同：1
> 
> 时间：2013-02-03T20:36:46.603
> 
> 标签：c#, winforms

我想制作一个表单，在打开时将用户锁定为仅使用该表单，直到关闭。

我在许多具有“设置”的程序中看到了这一点。您打开新表单，如果您尝试返回旧表单，新表单会弹出并发出哔哔声。

只是想知道，这到底是什么名字，只是我不必将其称为“锁定主窗体的窗体”吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T20:37:50.813

您需要使用[ShowDialog](http://msdn.microsoft.com/en-us/library/c7ykbedk.aspx)方法来执行此操作。这将锁定您想要的父表单。下面是一些示例代码，将向您展示如何执行此操作（它所做的只是检查`textbox`form2 中的 a 内容，该内容显示为模式对话框以防止使用父表单：

```
public void ShowMyDialogBox()
{
   Form2 testDialog = new Form2();

   // Show testDialog as a modal dialog and determine if DialogResult = OK.
   if (testDialog.ShowDialog(this) == DialogResult.OK)
   {
      // Read the contents of testDialog's TextBox.
      this.txtResult.Text = testDialog.TextBox1.Text;
   }
   else
   {
      this.txtResult.Text = "Cancelled";
   }
   testDialog.Dispose();
} 
```

从这里复制的示例代码：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.form.showdialog (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.showdialog%28v=vs.71%29.aspx)

# javascript - 在纯 Javascript 中使用选择器模拟 jQuery “on”

> ID：14677019
> 
> 赞同：18
> 
> 时间：2013-02-03T20:36:46.973
> 
> 标签：javascript, dom-events

我会在纯 Javascript 中模拟 jQuery[`.on( events , selector , data)`](http://api.jquery.com/on/) 方法的主要功能。

例如

```
$(document).on('click','.button',function() {
   console.log("jquery onclick"); 
}); 
```

我认为制作这样的东西就足够了

```
document.addEventListener('click',function(e) {
    if(e.target.className == 'button2') {
         console.log("It works");   
    }
}); 
```

但是，当我有这个 html 结构时：

```
<button class="button2">Hello <span>World</span></button> 
```

`span`当元素`e.target`上触发 click 事件时，我的脚本不起作用，因为`span`. （对于这个问题，我忽略了具有多个类的元素的复杂性以及跨浏览器兼容性）

[jQuery](https://github.com/jquery/jquery/blob/master/src/event.js#L708)的源代码读起来并不简单，我也不明白它是如何工作的（因为 jQuery 中的第一段代码适用于我的 html 结构）。

我需要这个方法，因为我的 html 是动态的，并且这个类的按钮被创建、删除和重新创建了很多次。我不想每次都添加听众。

如果可能的话，我会避免包含 jquery 库。

那么，我能做到吗？

这里是用于测试的[jsFiddle](http://jsfiddle.net/wT4qu/)。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2017-04-28T14:04:16.980

**2017 年更新**：[当前的 DOM 标准，例如`closest`](https://developer.mozilla.org/en-US/docs/Web/API/Element/closest)意味着现在要容易得多。

```
const addEventForChild = function(parent, eventName, childSelector, cb){      
  parent.addEventListener(eventName, function(event){
    const clickedElement = event.target,
    matchingChild = clickedElement.closest(childSelector)
    if (matchingChild) cb(matchingChild)
  })
}; 
```

要使用它：

```
addEventForChild(parent, 'click', '.child', function(childElement){
  console.log('Woo click!', childElement)
}) 
```

这是一个[jsfiddle](https://jsfiddle.net/xchfuhpb/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-03T20:43:52.477

这实际上非常简单。你在正确的轨道上，但它并不完全在那里。

这是我使用的功能：

```
window.addEvent = function(elem,type,callback) {
    var evt = function(e) {
        e = e || window.event;
        return callback.call(elem,e);
    }, cb = function(e) {return evt(e);};
    if( elem.addEventListener) {
        elem.addEventListener(type,cb,false);
    }
    else if( elem.attachEvent) {
        elem.attachEvent("on"+type,cb);
    }
    return elem;
};
window.findParent = function(child,filter,root) {
    do {
        if( filter(child)) return child;
        if( root && child == root) return false;
    } while(child = child.parentNode);
    return false;
};
window.hasClass = function(elem,cls) {
    if( !('className' in elem)) return;
    return !!elem.className.match(new RegExp("\\b"+cls+"\\b"));
}; 
```

这`window.findParent`是整个事情的核心，当我向您展示如何附加所需的`on`侦听器时，您可以看到：

```
window.addEvent(document.body,"click",function(e) {
    var s = window.findParent(e.srcElement || e.target,function(elm) {
        return window.hasClass(elm,"button");
    },this);
    if( s) {
        console.log("It works!");
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-08T18:24:36.280

简单而简短的代码：

```
function onEvt(type, callback) {
    if (document.attachEvent) {
        document.attachEvent("on" + type, function (e) {
            callback(e.target);
        });
    } else {
        document.addEventListener(type, function (e) {
            callback(e.target);
        }, false);
    }
} 
```

像这样调用函数：

```
onEvt('click', function(elem){ // click, mouseover etc...
    // for class
    if(elem.classList.contains('classname')){
        // do stuff
    }
    // for attribute
    if(elem.hasAttribute('target')){
        // do stuff
    }
}); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-06-09T11:39:26.257

[您可以通过链接](https://gist.github.com/Machy8/1b0e3cd6c61f140a6b520269acdd645f)在 github 上使用函数 Marchy8或通过执行以下操作来扩展它。

首先创建 $() 选择器函数：

```
function $(selector) {
    return selector;
}

HTMLElement = typeof (HTMLElement) != "undefined" ? HTMLElement : Element;
String.prototype.on = function(type, callback){
    var selector = this;
    document.body.addEventListener(type, function (event) {
        if (event.target.matches(selector)) {
            callback.call(event.target);
        }
    });
}

$(".test").on("click", function(e) {
    console.log(this.innerHTML);
    this.style.color = "red";
});
```

```
<div class="test">Click Here</div>
<div class="test">Click Here-1</div>
```

# java - 递归地反转短语

> ID：14677020
> 
> 赞同：1
> 
> 时间：2013-02-03T20:36:52.260
> 
> 标签：java, string, recursion

我最近接到一个任务，要求我创建一个程序，该程序使用递归（在 Java 中）反转输入短语并输出它。例如，给定输入“THIS IS A SENTENCE”，程序将输出“SENTENCE A IS THIS”。

但是，分配还指出，除了递归函数内的单个本地字符串变量外，我不能使用任何存储或 Java 集合。因此，Java 堆栈将保存输入中的所有单词。

我遇到的问题是正确实现递归。在本地声明一个字符串变量会覆盖我之前存储在其中的任何值，所以我不确定如何在不中断递归调用的情况下实现一个局部变量。如果有人能指出我正确的方向，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:44:14.570

这看起来是正确的逻辑，除了 else 块需要返回一个值而不是简单地将它存储在局部变量中

```
return reversePhrase(scanner) + string; 
```

您可能还想添加一个空格：

```
return reversePhrase(scanner) + " " + string; 
```

# html - 多个背景和：有效 - 最短解决方案/干解决方案？

> ID：14677022
> 
> 赞同：2
> 
> 时间：2013-02-03T20:37:26.553
> 
> 标签：html, css, validation

我有一个带有一些输入字段的表单。这些输入字段有一个渐变作为背景分配，如下所示：

```
input {
    background: #00b7ea;
    background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAwYjdlYSIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDllYzMiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
    background: -moz-linear-gradient(top,  #00b7ea 0%, #009ec3 100%);
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#00b7ea), color-stop(100%,#009ec3));
    background: -webkit-linear-gradient(top,  #00b7ea 0%,#009ec3 100%);
    background: -o-linear-gradient(top,  #00b7ea 0%,#009ec3 100%);
    background: -ms-linear-gradient(top,  #00b7ea 0%,#009ec3 100%);
    background: linear-gradient(to bottom,  #00b7ea 0%,#009ec3 100%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00b7ea', endColorstr='#009ec3',GradientType=0 );
} 
```

现在，当该字段被验证为 时`:valid`，我想添加一个表示一切正常的符号。通常我会尝试使用伪元素`:before`，`:after`但在这种情况下不会。`:before`并`:after`在元素内呈现，并且由于不允许输入字段包含任何其他元素，我找不到正确定位它们的方法。
所以我必须将指标显示为背景图像，这导致该代码：

```
input {
    background: #00b7ea;
    background: url(../images/ok.png), url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAwYjdlYSIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDllYzMiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
    background: url(../images/ok.png), -moz-linear-gradient(top,  #00b7ea 0%, #009ec3 100%);
    background: url(../images/ok.png), -webkit-gradient(linear, left top, left bottom, color-stop(0%,#00b7ea), color-stop(100%,#009ec3));
    background: url(../images/ok.png), -webkit-linear-gradient(top,  #00b7ea 0%,#009ec3 100%);
    background: url(../images/ok.png), -o-linear-gradient(top,  #00b7ea 0%,#009ec3 100%);
    background: url(../images/ok.png), -ms-linear-gradient(top,  #00b7ea 0%,#009ec3 100%);
    background: linear-gradient(to bottom,  #00b7ea 0%,#009ec3 100%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00b7ea', endColorstr='#009ec3',GradientType=0 );
} 
```

现在，尽管此解决方案有效，但我重复了背景代码，以便解决方案不是很干燥。你能想象出任何其他好的解决方案来解决这个问题吗？有什么我不知道的最佳实践吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T10:07:13.880

您可以将附加图像（ok.png）设置为不是背景图像，而是设置为边框图像

```
input:valid {
    border-image: url(../images/ok.png);
} 
```

不过，不确定是否支持旧版浏览器

# c - 在计算和分配中使用条件

> ID：14677027
> 
> 赞同：1
> 
> 时间：2013-02-03T20:38:17.150
> 
> 标签：c

最近，我开始使用如下表达式：

```
res += (i + n / i) * !(n % i); 
```

在我假设的地方，它`!(n % i)`的值总是 1 或 0，因此可以直接用于计算，而不是编写冗长的 if 语句，如

```
if(!(n % i))
    res += (i + n / i); 
```

如果您想知道，这些行取自我编写的用于计算数字的适当除数之和的函数`n`：

```
unsigned int sum_of_divisors(unsigned int n)
{
    unsigned int res = 1;

    unsigned int i;
    for(i = 2; i < sqrt(n); ++i)
            res += (i + n / i) * !(n % i);
    res += i * (i * i == n);

    return res;
} 
```

我的问题是，**这段代码是否保证按照我预期的方式运行？**这个（乘法与条件跳转）的大致性​​能影响是什么？如果合适的话，编译器会这样做吗？

**编辑**：请注意，我并不特别关心实际代码的性能。我只是想知道，出于纯粹的专业兴趣，两者中哪一个会表现得更好，为什么，以及编译器将如何处理每种情况。

至于我这样写的原因，它很适合我的大脑:)

这很难描述，但至少在某些情况下，我对乘以 1 或 0 而不是三元运算符或 if 语句有更好的感觉。

谢谢，安迪

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:53:21.563

是的，编译器保证按照您期望的方式运行。

不，它不会使您的代码更快，除非编译器质量非常低。编译器应该大致等效地处理这两个版本的代码，并选择它认为最好的方式来执行条件逻辑。

顺便说一句，*原则上*，`!`运算符是一个条件分支。一些实现（cpu archs）可能有办法优化它而不需要真正的程序计数器分支，但相同的方法适用于大多数条件。

请注意，从优化的角度来看，您的代码可能有*一种“更好”的方式。*书面：

```
res += (i + n / i) * !(n % i); 
```

`res`您已授予编译器在两个代码路径中写入的权限。在表格中：

```
if(!(n % i))
    res += (i + n / i); 
```

`res`如果条件为真，编译器只能写入。如果`res`是本地的并且它的地址没有泄露，编译器可以确定无论如何执行多余的写入是安全的，但是如果地址`res`在函数之外是可见的，编译器必须假设其他线程可能能够访问它并且代码路径不在`res`抽象机中修改的代码不能在生成的代码中修改它（因为它们可能没有持有安全修改它所必需的锁）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T20:41:34.067

我认为“何时优化”没有一个通用的答案。我个人对此主题的看法是，在直接要求执行之前，所有优化都为时过早。哎呀，有时我会等待被多次询问（只是为了安全起见，有人*真的*需要它）。

除此之外，第一条语句也可以写成：

```
res += (n % i) ? 0 : (i + n / i); 
```

就目前而言，乘法和否定使其难以理解。

### 编辑

> 这段代码是否保证按照我预期的方式运行

如果第一部分（与 0 或 1 相乘的部分）有副作用（比如有人在做 ++），它可能会导致细微的错误。就像我说的，只使用最自然的形式，以后担心速度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T20:52:26.813

运算符将`!`始终评估为 0 或 1，因此您的假设是正确的。

至于性能影响，任何值得称道的优化编译器都应该为`if`语句或三元运算符生成相同的（或等效的，性能方面的）代码。如果有疑问，请检查程序集输出（`-S`如果使用 gcc，则为开关）或对代码进行基准测试。

# r - 有没有办法在 R 中声明函数参数类型？

> ID：14677029
> 
> 赞同：4
> 
> 时间：2013-02-03T20:38:27.423
> 
> 标签：r, function, parameters, introspection

如果一个包中有函数声明。参数声明时没有类型，只有在运行时调用函数时才能计算出来。

有没有办法描述 R 函数参数类型，以便这些描述可用于静态分析？

用例：IDE 的自省。

==== 编辑 ====

*   注释？
*   元描述符？
*   等等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:43:40.273

通常不是，`R`是动态类型的，这可能是一个很大的优势或负担。当然，任何对象`R`都有一种类型，这些通常可以被强制（或强制转换），但我认为这不是你要问的。您可能希望查看类系统 ( `?class`) 以了解某些方法。但通常，由函数编写器在使用输入值之前检查它们。此外，您可能会发现这篇[论文](http://r.cs.purdue.edu/pub/ecoop12.pdf)很有趣。

检查一下`?browseEnv`，也许驱动它的代码可能对您的项目感兴趣。还是[RStudio](http://rstudio.org)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-16T17:30:46.430

R 包`assertthat`( [https://cran.r-project.org/web/packages/assertthat/index.html](https://cran.r-project.org/web/packages/assertthat/index.html) ) 在这方面提供了一些帮助。它适用`testthat`于在需要打字的包中进行测试。

# r - ggplot2 中的箭头（）不再受支持

> ID：14677035
> 
> 赞同：8
> 
> 时间：2013-02-03T20:38:57.737
> 
> 标签：r, ggplot2, r-grid

在新机器和 ggplot2 上安装 R 2.15.2。这个最新版本的 R 不再支持 grid 包，但 ggplot2 使用 grid 作为`arrow()`函数，如这些示例中所示。

[http://docs.ggplot2.org/current/geom_segment.html](http://docs.ggplot2.org/current/geom_segment.html)

一直无法找到解决方法。有什么建议么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-03T20:50:07.120

也许您认为由于[其 CRAN 页面上](http://cran.r-project.org/web/packages/grid/index.html)`grid`显示的消息而不再受支持？但是，如果写到*Package 'grid' 已从 CRAN 存储库中删除*，那是因为它现在是基础 R 发行版的一部分，如[Paul Murrell 的](http://www.stat.auckland.ac.nz/~paul/grid/grid.html)[页面](http://www.stat.auckland.ac.nz/~paul/grid/grid.html)所述。*[`grid`](http://www.stat.auckland.ac.nz/~paul/grid/grid.html)*

 *因此`library(grid)`，该`arrow`功能应该可以正常工作。

一些混淆可能是由于`grid`以前版本的自动加载`ggplot`（使`grid`功能对用户可见/可访问）；现在它是通过 NAMESPACE 导入来引用的，因此`grid`如果您想使用`grid`函数（或查看它们的帮助页面），则需要显式加载。*

# twitter-bootstrap - 如何在字段模板中翻译@elements.infos

> ID：14677039
> 
> 赞同：0
> 
> 时间：2013-02-03T20:39:18.607
> 
> 标签：twitter-bootstrap, playframework-2.0

我正在寻找一种将“必需”消息翻译成葡萄牙语或任何我想要的 html 的方法，例如添加一个图标，对此有什么建议吗？

这是我正在使用的字段模板：

```
<div class="clearfix @if(elements.hasErrors) {error} control-group">

    <label class="control-label" for="@elements.id">@elements.label</label>

    <div class="input controls">

        @elements.input

        <span class="help-inline">@elements.infos.mkString(", ")</span> 

        <span class="errors badge badge-important">@elements.errors.mkString(", ")</span>

    </div>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:58:51.017

您可以将 @elements.infos 包装在一个`Messages()`调用中：

```
<span class="help-inline">@elements.infos.map(i => Messages(i)).mkString(", ")</span> 
```

或者如果您在谈论 Play 的默认`required`消息，那么您必须`error.required`在`messages`文件中指定（尽管我不确定这是否真的适用于 2.0.x）。

# c# - 如何获取当前正在执行的 DLL 的位置？2号

> ID：14677044
> 
> 赞同：1
> 
> 时间：2013-02-03T20:39:31.963
> 
> 标签：c#, plugins, dll, .net-assembly, absolute-path

我已经搜索了论坛，并且存在很多关于上述问题的答案。但是，在我的情况下，我从软件插件中引用了一个 dll。似乎这使情况变得更加复杂，而且我找到的解决方案都没有返回正确的位置。

我尝试了以下方法：

```
Print(AppDomain.CurrentDomain.BaseDirectory); // returns C:\Program Files\TheOtherSoftware\System\
System.Type MyDLLsNameType = null;
Assembly a = System.Reflection.Assembly.GetExecutingAssembly();
foreach (AssemblyName an in a.GetReferencedAssemblies() )
{
  Print(an.Name); // finds various names including MyDLLsName
  Print(an.CodeBase);  // this is null
  if (an.Name == "MyDLLsName"){
    MyDLLsNameType = an.GetType();
  }
}
Print(System.Reflection.Assembly.GetAssembly(MyDLLsNameType).Location); // this returns  "C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorlib.dll" 
```

* * *

作为旁注：我想这样做是因为我想摆脱需要用户在特定位置安装软件的各种绝对路径。当根驱动器未命名为“C”时，该软件甚至崩溃了。鉴于我在编码方面没有太多经验，因此很高兴听到一些有关如何处理此类问题的建议。

# javascript - Firefox 扩展 SQLite - 更新/删除查询

> ID：14677046
> 
> 赞同：0
> 
> 时间：2013-02-03T20:39:46.143
> 
> 标签：javascript, sqlite, firefox-addon

在我的 Firefox 扩展中，我正在尝试进行更新声明，但我得到了这个错误

`Error: Component returned failure code: 0x80630001 (NS_ERROR_STORAGE_BUSY) [mozIStorageConnection.executeSimpleSQL]`

插入/选择语句工作正常，但更新和删除不起作用。

代码：

```
Components.utils.import("resource://gre/modules/Services.jsm");
Components.utils.import("resource://gre/modules/FileUtils.jsm");
...
this.dbFile = FileUtils.getFile("ProfD", [Source.globalValue.DB_NAME+".sqlite"]);
this.db = Services.storage.openDatabase(this.dbFile);
...
/* #1 */
var statement = this.db.createStatement('UPDATE articles SET isRead="true" WHERE id= :row_id');
statement.params.row_id = 6643098;
statement.executeAsync(); //no errors. Nothing happening - only CPU 100% Load
//statement.execute();  //getting that  error 

/* #2 */
this.db.executeSimpleSQL('UPDATE articles SET isRead="true" WHERE id=6643098'); //getting that  error 
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T11:19:32.277

好的，我想通了。重新启动后，它开始像它必须的那样工作。

# php - Windows 7 chmod 中的文件权限

> ID：14677047
> 
> 赞同：0
> 
> 时间：2013-02-03T20:39:46.087
> 
> 标签：php, joomla, chmod

`images`我在 joomla的文件夹下创建了一个子文件夹。当我尝试`images`通过浏览器访问文件夹时，我什么也看不到，但如果我尝试访问子文件夹，`http://localhost/joomla/images/downloads`则显示目录列表或文件可见。

现在我也想知道如何隐藏子文件夹中的文件。我知道它是如何通过 ftp 软件完成的，但不知道如何在 Windows 7 中完成它。类似于 linux 中的 chmod

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:32:35.503

Joomla 在其所有目录中都有空白*index.html*文件，如果有人试图访问特定文件夹，他们将看到一个空白屏幕，而不是文件树。因此，创建一个空白*index.html*文件并将其上传到您希望隐藏文件名的文件夹

# objective-c - 什么是自动释放池？

> ID：14677049
> 
> 赞同：69
> 
> 时间：2013-02-03T20:39:55.897
> 
> 标签：objective-c, object, release, autorelease, nsautoreleasepool

> **可能重复：**
> [为什么使用自动释放池？](https://stackoverflow.com/questions/6394735/why-use-autorelease-pool)

`@autoreleasepool{...}`所有的 Objective-C 起始页面都会在主函数声明下打开一条默认语句。但是这个声明实际上在做什么？新的 Objective-C 自动释放对象并且删除该行对程序没有任何改变。这个命令真的有必要吗？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2013-02-03T20:58:16.763

该`@autoreleasepool`语句执行与以前相同的工作，而不是使用[NSAutoreleasePool](https://developer.apple.com/documentation/foundation/nsautoreleasepool)类。NSAutoreleasePool 的工作方式有点奇怪，因为创建它会在整个应用程序中产生影响；`@autoreleasepool`创建一个范围区域，并使其更清楚池内的内容以及它何时耗尽（当它超出范围时）。根据苹果的说法，它也更有效率。

自动释放池的概念很简单，每当一个对象实例被标记为自动释放（例如`NSString* str = [[[NSString alloc] initWithString:@"hello"] autorelease];`）时，它在那个时刻的保留计数就会+1，但是在运行循环结束时，池被耗尽，然后任何标记为 autorelease 的对象的保留计数都会减少。这是一种在您准备任何可以为自己保留对象的同时保留对象的方法。

使用 ARC，虽然`autorelease`开发人员不使用该方法，但管理 ARC 的底层系统会为您插入该方法。（**请记住：** ARC 所做的只是插入`retain`，`release`并`autorelease`在适当的时间呼叫您）。因此，现有的 AutoreleasePool 概念需要保留。

如果您删除自动释放池，您的对象将开始泄漏

> 在引用计数环境中，Cocoa 期望有一个始终可用的自动释放池。如果池不可用，则自动释放的对象不会被释放，并且您会泄漏内存。在这种情况下，您的程序通常会记录适当的警告消息。

# drupal-7 - Drupal：搜索移动应用的自定义内容类型

> ID：14677053
> 
> 赞同：0
> 
> 时间：2013-02-03T20:40:11.400
> 
> 标签：drupal-7, drupal-search

我需要在 drupal 中搜索内容（节点）。内容类型是自定义的，包含许多字段，例如位置、网址、电子邮件、地址等。我尝试编写自己的查询，但结果并不令人满意。我也尝试使用“node_search_execute”，但它不适用于多个关键字，就像如果有一个标题为“Books”的项目 node_search_execute 不适用于“book”。

是否有一个好的模块可以用来从我的网络服务中获取结果，或者我应该尝试使用我的查询来使其工作。

注意：我需要将结果返回到移动应用程序。

谁能指导我做正确的事情！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T10:42:57.200

一种方法是创建一个 MyIsam 类型的新表。不要更改现有的表类型，因为它会破坏关系。

现在要么在添加/编辑时将数据添加到表中，要么使用 cron 服务来更新此表。对此执行全文搜索以获得结果。

或者

使用多个查询来获取数据，然后返回搜索结果。（这种方法可能效率不高，但会奏效）。

# java - java程序有问题

> ID：14677054
> 
> 赞同：2
> 
> 时间：2013-02-03T20:40:13.573
> 
> 标签：java

我有一个**华氏**类，它应该从主类中获取一个数字并将其转换为摄氏度。一切正常，但转换部分。我做了一个我调用的方法，以便可以转换数字，但是每当程序运行时，它都会给我 -0.0 或 0.0（无论数字是多少）我知道负数部分是正确的，但我只需要它显示实际转换的数字。

自从我完成任何类型的 java 编程以来已经整整一年了，我仍然是一个初学者。我查阅了 java 文档以进行复习，并编写了简单的简单程序以重新回到游戏中，但我迷路了有了这个。请任何输入都会有所帮助

这是主要课程

```
public class test { 
  public static void main (String[] args) {
    double t = 100;

    Fahrenheit temp = new Fahrenheit(t);

    temp.convert();

  }
} 
```

和华氏等级

```
public class Fahrenheit{

 private double tempF = 0;

 public Fahrenheit (double inputTemp){
    tempF = inputTemp;
 }

public double convert () {

    double c = 5/9*(tempF-32);

    System.out.println(c );
    return c;
 }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:41:59.920

```
double c = 5/9*(tempF-32); 
```

在上面的行中，您正在执行整数除法 - `5 / 9`，其结果是`0`。因此你得到了`0.0`.

您可以将`numerator`或之一更改`denominator`为`double value`： -

```
double c = 5.0 / 9 * (tempF-32); 
```

或者，先做乘法： -

```
double c = 5 * (tempF-32) / 9 ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:58:17.270

```
 double c = 5/9*(tempF-32); 
```

在上面的行中，您正在执行整数除法 5 / 9，其结果为 0。

您还可以使用：

```
double c = (double)5/9*(tempF-32); 
```

或者

```
double c = 5.0 / 9 * (tempF-32); 
```

# java - Java 数组不起作用

> ID：14677055
> 
> 赞同：-1
> 
> 时间：2013-02-03T20:40:14.013
> 
> 标签：java, arrays

创建一个代码，用户可以在其中输入他们想要的座位数量，即行。当我只为一行执行程序时，它运行良好。我不知道为什么它现在不起作用。喜欢0的想法。如果有人可以帮助解决这个问题，我将不胜感激。

只有一行的代码在第一行之后。

注意：如果我之前不清楚，当程序运行时，它只会询问座位数量，其他一切都只是崩溃/不起作用。我真的不知道如何解决这个问题。

**Java应用程序1**

```
package javaapplication1;
import java.util.*;

/**
 *
 * @author ziyue
 */
public class JavaApplication1 {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args)throws Exception {
        Scanner input = new Scanner(System.in);
        System.out.println("Enter the amount of people in your group, up to 6");
        int num = input.nextInt();

        System.out.println("Please enter the desiered row, A-E. Enter capitals.");
        String ROW = input.nextLine();

         int[] r = {};        
         int[] RowA = {0,0,1,1,1,0,0,0,0,0};
         int[] RowB = {0,0,1,1,1,0,0,0,0,0};
         int[] RowC = {0,0,1,1,1,0,0,0,0,0};
         int[] RowD = {0,0,1,1,1,0,0,0,0,0};
         int[] RowE = {0,0,1,1,1,0,0,0,0,0};                           
         int highest = num - 1;         
         String available = "";
         String booking = " ";

         if ("A".equals(ROW)) {
            r = RowA;
         }
         if ("B".equals(ROW)) {
            r = RowB;
         }         
         if ("C".equals(ROW)) {
            r = RowC;
         }         
         if ("D".equals(ROW)) {
            r = RowD;
         }         
         if ("E".equals(ROW)) {
            r = RowE;
         }         

         for (int i = 0; i < r.length; i++) {
             if (r[i] == 0) {
                 available = available + (i + 1);

             }

             if (available.length() > booking.length()) {
                 booking = available;

             }else if (r[i] == 1) {
                 available = "";

             }
         }                           
            if (num <= booking.length()) {
            char low = booking.charAt(0);
            char high = booking.charAt(highest);
            System.out.println("There are seats one the row " + ROW + "from " + low + " - " + high + ".");
        } else {
            System.out.println("The desired seat amount is not available. The maximum amount on Row is " + booking.length());
        }
    }

} 
```

**Java应用程序2**

```
package javaapplication2;

import java.util.*;

public class JavaApplication2 {

    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        System.out.println("Enter the amount of people in your group, up to 6");
        int num = input.nextInt();

        if (num > 6) {
            System.out.println("You have exceeded the maximum amount of people allowed.");

        }

        int highest = num - 1;

        String available = "";
        String booking = " ";

        int[] RowA = {0, 0, 1, 0, 0, 0, 1, 0, 0, 1};

        for (int i = 0; i < RowA.length; i++) {
            if (RowA[i] == 0) {
                available = available + (i + 1);

            }

            if (available.length() > booking.length()) {
                booking = available;

            } else if (RowA[i] == 1) {
                available = "";

            }
        }

        if (num <= booking.length()) {
            char low = booking.charAt(0);
            char high = booking.charAt(highest);
            System.out.println("There are seats from " + low + " - " + high + ".");
        } else {
            System.out.println("The desired seat amount is not available. The maximum amount on Row is " + booking.length());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:57:31.483

问题是您的输入不正确。您假设数字和字母在不同的行上，但这不是您输入的内容。

```
System.out.println("Enter the amount of people in your group, up to 6");
int num = input.nextInt();
// discard the rest of the first line and 
// expect the next input to be on the next line.
input.nextLine(); 

System.out.println("Please enter the desiered row, A-E. Enter capitals.");
String ROW = input.nextLine(); 
```

如果您不丢弃第一行的结尾，ROW 将包含您在第一行的数字之后键入的内容。

如果您在调试器中单步执行代码，您会发现 ROW 不是您所期望的，从而节省了您分配的时间。

# javascript - 通过将 a.localeCompare(b) 切换到 (ab?1:0))

> ID：14677060
> 
> 赞同：50
> 
> 时间：2013-02-03T20:40:57.033
> 
> 标签：javascript, google-chrome, sorting

通过从

```
myArray.sort(function (a, b) {
  return a.name.localeCompare(b.name);
}); 
```

至

```
myArray.sort(function (a, b) {
  return (a.name < b.name ? -1 : (a.name > b.name ? 1 : 0));
}); 
```

我能够将在 Chrome 中对约 1700 个元素数组进行排序的时间从 1993 毫秒缩短到 5 毫秒。几乎是 400 倍的加速。不幸的是，这是以正确排序非英语字符串为代价的。

显然，当我尝试进行排序时，我的 UI 不能阻塞 2 秒。我能做些什么来避免极其缓慢的 localeCompare 但仍保持对本地化字符串的支持？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2018-09-17T14:22:53.113

[通过预先声明collat​​or](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Collator/Collator)对象并使用它的 compare 方法，可以获得很大的性能改进。例如：

```
const collator = new Intl.Collator('en', { numeric: true, sensitivity: 'base' });
arrayOfObjects.sort((a, b) => {
  return collator.compare(a.name, b.name);
}); 
```

注意：如果元素是浮动的，这将无法正常工作。请参阅此处的说明：[Intl.Collat​​or and natural sort with numeric options sorts wrong with decimal numbers](https://stackoverflow.com/questions/40107588/intl-collator-and-natural-sort-with-numeric-option-sorts-incorrectly-with-decima)

这是比较这 3 种方法的基准脚本：

```
const arr = [];
for (let i = 0; i < 2000; i++) {
  arr.push(`test-${Math.random()}`);
}

const arr1 = arr.slice();
const arr2 = arr.slice();
const arr3 = arr.slice();

console.time('#1 - localeCompare');
arr1.sort((a, b) => a.localeCompare(
  b,
  undefined, {
    numeric: true,
    sensitivity: 'base'
  }
));
console.timeEnd('#1 - localeCompare');

console.time('#2 - collator');
const collator = new Intl.Collator('en', {
  numeric: true,
  sensitivity: 'base'
});
arr2.sort((a, b) => collator.compare(a, b));
console.timeEnd('#2 - collator');

console.time('#3 - non-locale');
arr3.sort((a, b) => (a < b ? -1 : (a > b ? 1 : 0)));
console.timeEnd('#3 - non-locale');
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-09-10T21:35:06.587

我在处理 /mostly/ 拉丁字符时发现的一种有效方法是在两个字符串都匹配特定正则表达式时使用运算符。例如：`/^[\w-.\s,]*$/`

如果两个字符串都匹配表达式，它会快得多，而且在最坏的情况下，它似乎比盲目调用 localeCompare 稍微慢一些。

此处示例：http: [//jsperf.com/operator-vs-localecompage/11](http://jsperf.com/operator-vs-localecompage/11)

更新：似乎 Intl.Collat​​or 目前是全面性能的最佳选择：[https ://jsperf.com/operator-vs-localecompage/22](https://jsperf.com/operator-vs-localecompage/22)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-24T21:38:10.457

如果不查看您正在排序的数据，很难知道最快的排序。但是 jsperf 有很多很好的测试显示排序类型之间的性能差异：http: [//jsperf.com/javascript-sort/45](http://jsperf.com/sort-algorithms/31) [http://jsperf.com/sort-algorithms/31](http://jsperf.com/javascript-sort/45)

然而，这些都没有考虑本地化字符串，我想没有简单的方法来对本地化字符串进行排序，而 localeCompare 可能是最好的解决方案。

查看 mozilla 的参考资料说：“在比较大量字符串时，例如在对大型数组进行排序时，最好创建一个 Intl.Collat​​or 对象并使用其 compare 属性提供的函数。” [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare)

但是转到 Intl.Collat​​or 参考它表明不支持 firefox/safari [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Collat ​​or](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Collator)

您可以尝试使用 localCompare 上的一些选项来提高性能。但我刚刚做了一个更改灵敏度级别的快速测试，似乎它不会提高性能：

```
list.sort(function(a, b) {
  return a.localeCompare(b, {sensitivity:'base'});
}); 
```

[http://jsperf.com/sort-locale-strings](http://jsperf.com/sort-locale-strings)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-24T11:57:13.617

尝试分两步对其进行排序：

1.  与运营商：正如你所说，它会快400倍
2.  然后使用`localCompare()`: 这现在要做的比较更少，因为数组大部分是排序的。

注意：我认为这`localCompare()`将主要用至少 1 个不是英文的字符串来调用。所以使用 2 个英文字符串的调用次数`localCompare()`应该会大大减少。

这是代码：

```
myArray.sort(function(a, b) {
  return (a.name < b.name ? -1 : (a.name > b.name ? 1 : 0));
});

myArray.sort(function(a, b) {
  return a.name.localeCompare(b.name);
}); 
```

该解决方案具有简短且易于使用的优点。如果数组主要包含英文字符串，这将是有效的。您拥有的非英语字符串越多，第一种类型的用处就越少。但是由于很容易添加到您的脚本中，因此也很容易看出这种方法是否值得。

现在，如果我是你，我也会使用，因为据说它比你有很多比较[`Intl.Collator`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Collator)要快得多。[`localCompare()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2014-08-26T05:34:24.967

我不知道你还在寻找解决这个问题的方法

```
// Defaulted to ascending
// 1 asc | -1 desc
var direction = 1; 
myArray.sort(function (a, b) {
  return a.name.localeCompare(b.name) === 1 ? direction : -1 * direction;
}); 
```

我`=== 1`在您的代码中添加了一个检查，这个改进的性能提高了 400 倍，这意味着两者都有相当的性能数字。

具有 localeCompare arr 大小的性能编号：3200 10 次重复的平均时间：60 毫秒

使用 > 方法的性能数字。平均耗时 55 毫秒

# javascript - element.className 不会仅在 for-loop JavaScript 中更改我的类名

> ID：14677061
> 
> 赞同：0
> 
> 时间：2013-02-03T20:40:57.710
> 
> 标签：javascript

我正在努力使用这个功能，但是当它在 for 循环中时，我似乎无法让它工作。

当它不在循环内时，它会更改我的类名。

有小费吗 ？

这是该功能起作用的时候。

```
 function addDiceEvent() {
           var diceClass = document.getElementsByClassName("dice")[0];
           diceClass.className = "dice-two";

           } 
```

但是由于有很多类名为 dice 我需要用一个循环来改变它们。

有了这段代码，就没有魔法了。

```
function addDiceEvent() {
       var diceClass = document.getElementsByClassName("dice");
                 for(var i = 0; i<diceClass.length; i++){
         diceClass.className = "dice-two";              

       }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:42:37.740

将其更改为`diceClass[i].className = "dice-two";`在第一件`diceClass`中是一个特定元素，在第二件中是整个元素数组。

此外，我强烈建议考虑使用 jQuery，它会是单行的。

# java - java - 如何在运行时访问Java程序的内存变量？

> ID：14677072
> 
> 赞同：0
> 
> 时间：2013-02-03T20:42:04.683
> 
> 标签：java, global-variables, memory-access

> 我在eclipse中运行一个java*爬虫程序。*我没有启用调试器。

爬行完成后，我正在打印一些*变量。*但是爬虫需要很*长时间*才能完成，所以我不知道什么时候会打印这些变量。

我想在*爬虫运行*时访问这些变量，我不想停止它，因为它已经运行了一段时间。我如何访问这些变量？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:07:08.437

> 该程序已运行 1.5 天。我现在不想停下来使用调试器或 println

如果您无法更改正在运行的进程的代码（这是开发人员忘记提及的重要细节），您唯一的选择是使用 VisualVM 等触发堆转储。这将为您提供整个 JVM，但其中将是您的 HashTable。

# java - 对象数组的空指针异常

> ID：14677075
> 
> 赞同：0
> 
> 时间：2013-02-03T20:42:12.740
> 
> 标签：java, arrays, nullpointerexception

我不熟悉使用对象数组，但无法弄清楚我做错了什么以及为什么我不断收到 Null 指针异常。我正在尝试使用一组设置为打开或关闭的聚光灯对象创建一个剧院类。但是 - 每当我调用这个数组时，我都会得到一个空指针异常。

```
package theatreLights;

public class TheatreSpotlightApp {

public static void main(String[] args) {

    Theatre theTheatre = new Theatre(8);

    System.out.println("element 5 " + theTheatre.arrayOfSpotlights[5].toString());

}

}

package theatreLights;

public class Theatre {

spotlight[] arrayOfSpotlights;

public Theatre(int N){

  arrayOfSpotlights =  new spotlight[N];

    for (int i = 0; i < arrayOfSpotlights.length; i++) { 
        arrayOfSpotlights[i].turnOn();          
    }

}
}

package theatreLights;

public class spotlight {
int state;

public  spotlight(){    
    state = 0;  
}

public void turnOn(){
    state = 1;  
}

void turnOff(){ 
    state = 0;
}

public String toString(){
    String stringState = "";
    if(state == 0){
        stringState = "is off";

    }
    else if(state==1){
        stringState = "is on";
    }

    return stringState;

}
} 
```

我必须在创建数组时做一些基本的错误，但无法弄清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:47:47.107

代替

```
arrayOfSpotlights[i].turnOn(); 
```

和

```
arrayOfSpotLights[i] = new Spotlight();
arrayOfSpotlights[i].turnOn(); 
```

线

```
arrayOfSpotlights =  new spotlight[N]; 
```

将创建一系列聚光灯。然而，它不会用聚光灯填充这个数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T20:47:19.400

当您执行“arrayOfSpotlights = new Spotlight[N];”时 您初始化一个长度为 N 的数组，您还需要初始化其中的每个对象：

```
for i=0; i<N; i++
    arrayOfSpotlights[i] = new spotlight();
    arrayOfSpotlights[i].turnOn(); 
```

希望我是对的:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T20:48:30.517

您不是在创建聚光灯对象。

```
arrayOfSpotlights =  new spotlight[N]; 
```

这只是创建了一组对聚光灯的引用，而不是被引用的对象。

简单的解决方案是

```
for (int i = 0; i < arrayOfSpotlights.length; i++) { 
    arrayOfSpotlights[i] = new spotlight();
    arrayOfSpotlights[i].turnOn();          
} 
```

顺便说一句，您应该使用`TitleCase`类名。

你可以这样写你的类，而不使用像 0 和 1 这样的神秘代码

```
public class Spotlight {
    private String state;

    public Spotlight() {
        turnOff();
    }

    public void turnOn() {
        state = "on";  
    }

    void turnOff() { 
        state = "off";
    }

    public String toString() {
        return "is " + state;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T20:59:04.780

您声明了数组`arrayOfSpotlights`，但没有初始化数组的成员（所以它们是`null`- 你得到了异常）。

将其更改为：

```
public class Theatre {
    spotlight[] arrayOfSpotlights;

    public Theatre(int N){

      arrayOfSpotlights =  new spotlight[N];

        for (int i = 0; i < arrayOfSpotlights.length; i++) { 
            arrayOfSpotlights[i]=new spotlight();
            arrayOfSpotlights[i].turnOn();          
        }

    } 
} 
```

它应该可以工作。

# ios - 带有 NSFetchedResultsController 的 UITableView 不会第二次加载

> ID：14677076
> 
> 赞同：7
> 
> 时间：2013-02-03T20:42:20.603
> 
> 标签：ios, objective-c, uitableview, core-data, nsfetchedresultscontroller

**更新 3**这些是第一次使用空数据存储运行后的日志。

```
2013-02-07 20:57:06.708 Five Hundred Things[14763:c07] mainMOC = <NSManagedObjectContext: 0x7475a90>
2013-02-07 20:57:06.711 Five Hundred Things[14763:1303] Import started
2013-02-07 20:57:06.712 Five Hundred Things[14763:1303] backgroundMOC = <NSManagedObjectContext: 0x8570070>
2013-02-07 20:57:06.717 Five Hundred Things[14763:c07] FRC fetch performed
2013-02-07 20:57:06.718 Five Hundred Things[14763:c07] numberOfSectionsInTableView returns 1
2013-02-07 20:57:06.720 Five Hundred Things[14763:c07] numberOfSectionsInTableView returns 1
2013-02-07 20:57:06.720 Five Hundred Things[14763:c07] numberOfRowsInSection returns 0
2013-02-07 20:57:06.728 Five Hundred Things[14763:1303] call contextDidSave
2013-02-07 20:57:06.736 Five Hundred Things[14763:1303] call contextDidSave
2013-02-07 20:57:06.736 Five Hundred Things[14763:c07] numberOfSectionsInTableView returns 1
2013-02-07 20:57:06.737 Five Hundred Things[14763:c07] numberOfSectionsInTableView returns 1
2013-02-07 20:57:06.737 Five Hundred Things[14763:c07] numberOfRowsInSection returns 5
2013-02-07 20:57:06.758 Five Hundred Things[14763:1303] call contextDidSave
2013-02-07 20:57:06.759 Five Hundred Things[14763:1303] Refresh complete
2013-02-07 20:57:06.759 Five Hundred Things[14763:c07] numberOfSectionsInTableView returns 1
2013-02-07 20:57:06.760 Five Hundred Things[14763:c07] numberOfSectionsInTableView returns 1
2013-02-07 20:57:06.761 Five Hundred Things[14763:c07] numberOfRowsInSection returns 5 
```

请注意，执行 FRC fetch 时，section 中的行数为 0，但在第二个 contextDidSave 之后，它变为 5 以匹配数据存储中的类别数。

在崩溃的第二次运行中，以下是日志：

```
2013-02-07 21:01:11.578 Five Hundred Things[14800:c07] mainMOC = <NSManagedObjectContext: 0x8225650>
2013-02-07 21:01:11.581 Five Hundred Things[14800:1303] Import started
2013-02-07 21:01:11.582 Five Hundred Things[14800:1303] backgroundMOC = <NSManagedObjectContext: 0x7439850>
2013-02-07 21:01:11.592 Five Hundred Things[14800:c07] FRC fetch performed
2013-02-07 21:01:11.594 Five Hundred Things[14800:c07] cat = Attraction
2013-02-07 21:01:11.594 Five Hundred Things[14800:c07] cat = Beverage
2013-02-07 21:01:11.595 Five Hundred Things[14800:c07] cat = Entertainment
2013-02-07 21:01:11.595 Five Hundred Things[14800:c07] cat = Hotel
2013-02-07 21:01:11.596 Five Hundred Things[14800:c07] cat = Restaurant
2013-02-07 21:01:11.597 Five Hundred Things[14800:c07] numberOfSectionsInTableView returns 1
2013-02-07 21:01:11.598 Five Hundred Things[14800:c07] numberOfSectionsInTableView returns 1
2013-02-07 21:01:11.599 Five Hundred Things[14800:c07] numberOfRowsInSection returns 0
2013-02-07 21:01:11.602 Five Hundred Things[14800:1303] call contextDidSave
2013-02-07 21:01:11.610 Five Hundred Things[14800:1303] call contextDidSave 
```

FRC 被初始化，然后立即记录类别以显示它们确实在 FRC 中。但是，该部分中的行数为 0，并且永远不会更新。相反，该应用程序会因下面的堆栈而崩溃。

在第三次和后续运行中，日志如下所示：

```
2013-02-07 21:03:55.560 Five Hundred Things[14815:c07] mainMOC = <NSManagedObjectContext: 0x8128860>
2013-02-07 21:03:55.563 Five Hundred Things[14815:1e03] Import started
2013-02-07 21:03:55.564 Five Hundred Things[14815:1e03] backgroundMOC = <NSManagedObjectContext: 0x822b5d0>
2013-02-07 21:03:55.569 Five Hundred Things[14815:c07] FRC fetch performed
2013-02-07 21:03:55.571 Five Hundred Things[14815:c07] cat = Attraction
2013-02-07 21:03:55.572 Five Hundred Things[14815:c07] cat = Beverage
2013-02-07 21:03:55.572 Five Hundred Things[14815:c07] cat = Entertainment
2013-02-07 21:03:55.573 Five Hundred Things[14815:c07] cat = Hotel
2013-02-07 21:03:55.573 Five Hundred Things[14815:c07] cat = Restaurant
2013-02-07 21:03:55.574 Five Hundred Things[14815:c07] numberOfSectionsInTableView returns 1
2013-02-07 21:03:55.576 Five Hundred Things[14815:c07] numberOfSectionsInTableView returns 1
2013-02-07 21:03:55.576 Five Hundred Things[14815:c07] numberOfRowsInSection returns 5
2013-02-07 21:03:55.581 Five Hundred Things[14815:1e03] call contextDidSave
2013-02-07 21:03:55.592 Five Hundred Things[14815:1e03] call contextDidSave
2013-02-07 21:03:55.593 Five Hundred Things[14815:c07] numberOfSectionsInTableView returns 1
2013-02-07 21:03:55.594 Five Hundred Things[14815:c07] numberOfSectionsInTableView returns 1
2013-02-07 21:03:55.595 Five Hundred Things[14815:c07] numberOfRowsInSection returns 5
2013-02-07 21:03:55.606 Five Hundred Things[14815:1e03] call contextDidSave
2013-02-07 21:03:55.606 Five Hundred Things[14815:1e03] Refresh complete 
```

这就是行为在第二次运行时的样子；数据已经在存储中，节中的行数返回 5，并且类别立即出现在表视图中。

* * *

**更新 2**这是主线程的堆栈跟踪，这是发生崩溃的地方。由于它发生在主线程上，我认为它与 UITableView 有关。我没有在 UITableView 中使用 NSDictionary 或 NSMutableDictionary。我现在的想法是`numberOfRowsInSection`在第二次运行时返回 0 会导致问题，但我不确定如何解决它。它在第三次运行时返回正确的数字（5 和我正在使用的数据），并且似乎在第一次运行时正确填充了数据存储，所以我很困惑为什么在第二次运行时它返回 0 而没有不更新。

```
frame #0: 0x013ede52 libobjc.A.dylib`objc_exception_throw
frame #1: 0x020330de CoreFoundation`-[__NSDictionaryM setObject:forKey:] + 158
frame #2: 0x01211d7a CoreData`-[NSFetchedResultsController(PrivateMethods) _preprocessUpdatedObjects:insertsInfo:deletesInfo:updatesInfo:sectionsWithDeletes:newSectionNames:treatAsRefreshes:] + 1994
frame #3: 0x01212ed7 CoreData`-[NSFetchedResultsController(PrivateMethods) _managedObjectContextDidChange:] + 2455
frame #4: 0x00b9e4f9 Foundation`__57-[NSNotificationCenter addObserver:selector:name:object:]_block_invoke_0 + 40
frame #5: 0x0200a0c5 CoreFoundation`___CFXNotificationPost_block_invoke_0 + 85
frame #6: 0x01f64efa CoreFoundation`_CFXNotificationPost + 2122
frame #7: 0x00ad2bb2 Foundation`-[NSNotificationCenter postNotificationName:object:userInfo:] + 98
frame #8: 0x01125163 CoreData`-[NSManagedObjectContext(_NSInternalNotificationHandling) _postObjectsDidChangeNotificationWithUserInfo:] + 83
frame #9: 0x011bed2f CoreData`-[NSManagedObjectContext(_NSInternalChangeProcessing) _createAndPostChangeNotification:withDeletions:withUpdates:withRefreshes:] + 367
frame #10: 0x01121128 CoreData`-[NSManagedObjectContext(_NSInternalChangeProcessing) _postRefreshedObjectsNotificationAndClearList] + 136
frame #11: 0x0111f8c0 CoreData`-[NSManagedObjectContext(_NSInternalChangeProcessing) _processRecentChanges:] + 80
frame #12: 0x0111f869 CoreData`-[NSManagedObjectContext processPendingChanges] + 41
frame #13: 0x010f3e38 CoreData`_performRunLoopAction + 280
frame #14: 0x01f78afe CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 30
frame #15: 0x01f78a3d CoreFoundation`__CFRunLoopDoObservers + 381
frame #16: 0x01f567c2 CoreFoundation`__CFRunLoopRun + 1106
frame #17: 0x01f55f44 CoreFoundation`CFRunLoopRunSpecific + 276
frame #18: 0x01f55e1b CoreFoundation`CFRunLoopRunInMode + 123
frame #19: 0x01f0a7e3 GraphicsServices`GSEventRunModal + 88
frame #20: 0x01f0a668 GraphicsServices`GSEventRun + 104
frame #21: 0x00021ffc UIKit`UIApplicationMain + 1211
frame #22: 0x000022dd Five Hundred Things`main(argc=1, argv=0xbffff31c) + 141 at main.m:16
frame #23: 0x00002205 Five Hundred Things`start + 53 
```

* * *

**更新：**我设法得到了一个实际的崩溃，而不是没有响应。

> *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“*** setObjectForKey：对象不能为 nil（键：_ContentChange_OldIndexPathKey）”

[这个 SO question](https://stackoverflow.com/questions/3669505/need-help-fast-coredata-error)是我能找到的最接近错误的问题，但它讨论的是 nil 而不是 key 的值。它看起来像是在将类别保存到核心数据存储时发生的，但所有类别都有值。

实体 Category 包含 category_id - Integer 16 category_name - String

它与实体 Thing 有一对多的关系，但是代码的这个特定部分对这种关系没有做任何事情；它只是设置 category_id 和 category_name。稍后在导入（在有问题的 MOC 保存之后）是设置关系的时候。

导入操作中有问题的代码：

```
//import categories

    NSString *categoryPath = [[NSBundle mainBundle] pathForResource:@"category" ofType:@"json"];

    NSData *categoryData = [NSData dataWithContentsOfFile:categoryPath];

    NSDictionary *categoryResults = [NSJSONSerialization
                                     JSONObjectWithData:categoryData
                                     options:NSJSONReadingMutableLeaves
                                     error:&error];

    NSEntityDescription *categoryEntity = [NSEntityDescription entityForName:@"Category"
                                              inManagedObjectContext:context];

    NSMutableArray *categories = [[NSMutableArray alloc] init];

    NSString *categoryPredicateString = [NSString stringWithFormat: @"category_id == $CATEGORY_ID"];

    NSPredicate *categoryPredicate = [NSPredicate predicateWithFormat:categoryPredicateString];

    for (NSDictionary *categoryKey in categoryResults){

        NSFetchRequest *categoryFetchRequest = [[NSFetchRequest alloc] init];

        [categoryFetchRequest setEntity:categoryEntity];

        NSNumber *categoryID = [NSNumber numberWithInt:[[categoryKey objectForKey:@"category_id"] integerValue]];

        [categories addObject:categoryID];

        NSDictionary *categoryVariables = [NSDictionary dictionaryWithObject:categoryID forKey:@"CATEGORY_ID"];

        NSPredicate *catSubPredicate = [categoryPredicate predicateWithSubstitutionVariables:categoryVariables];

        [categoryFetchRequest setPredicate:catSubPredicate];

        NSArray *categoryArray = [[NSArray alloc] init];
        categoryArray = [context executeFetchRequest:categoryFetchRequest error:&error];

        Category *categoryObject = [categoryArray lastObject];
        NSNumber *categoryNum = [categoryObject valueForKey:@"category_id"];
        NSInteger categoryInt = [categoryNum integerValue];

        if (categoryInt != [[categoryKey objectForKey:@"category_id"] integerValue]){
            categoryObject = [NSEntityDescription
                              insertNewObjectForEntityForName:@"Category"
                              inManagedObjectContext:context];
            categoryObject.category_id = [NSNumber numberWithInt:[[categoryKey objectForKey:@"category_id"] intValue]];
        }
        if (categoryObject.category_name != [categoryKey objectForKey:@"category"]){
            categoryObject.category_name = [categoryKey objectForKey:@"category"];
        }

    }

    //Remove unneeded Categories from Core Data Store

    NSFetchRequest *removeUnusedCategories = [[NSFetchRequest alloc] init];
    [removeUnusedCategories setEntity:categoryEntity];
    NSArray *fetchedCategories = [context executeFetchRequest:removeUnusedCategories error:&error];

    for (Category *fetchedCategory in fetchedCategories){
        if (![categories containsObject:fetchedCategory.category_id]){
            [context deleteObject:fetchedCategory];
            NSLog(@"Object deleted");
        }
    }

    if (![context save:&error]) {
        NSLog(@"Whoops, couldn't save: %@", [error localizedDescription]);
    } 
```

发生在后台 MOC 上，`[context save]`并通过通知中心同步到主 MOC（在应用程序委托中）。它侦听`NSManagedObjectContextDidSaveNotification`并`mergeChangesFromContextDidSaveNotification:`在主 MOC 上运行。

第一次运行和第三次运行完美。它总是发生在第二次运行。

* * *

我在一个 iOS 项目上使用 Core Data，到目前为止它运行良好，除了一个问题。

该应用程序从 JSON 文件填充核心数据存储，并且初始 UITableViewController 加载了应有的动画。但是，应用程序第二次启动时，初始 UITableView 是空白的。我检查了多个地方，当第二次启动开始时，数据在核心数据存储中，但没有调用 UITableView 或 NSFetchedResultsController 方法。

在第一次启动时，section 中的行数返回 0，但在加载 Core Data 存储后返回 5。在第二次启动时，节中的行数（只有一节）返回 0 并且不更新。在第三次和所有后续启动中，该部分中的行数将返回 5。

UITableView`cellForRowAtIndexPath`和 NSFetchedResultsController 的`didChangeObject`方法都不会在应用程序的第二次启动时被调用。UITableViewController 是`UITableViewDelegate`、`UITableViewDataSource`和`NSFetchedResultsControllerDelegate`。

正如核心数据指南中所建议的，应用程序委托和表视图控制器共享一个托管对象上下文，而数据加载是在另一个线程的后台 MOC 上完成的。当上下文的保存方法通过`mergeChangesFromContextDidSaveNotification:`.

为了重现，我从模拟器中删除了应用程序，运行一次，数据库填充并且应用程序正确显示。我停止应用程序并再次运行，但没有任何显示。我停止该应用程序并第三次运行它并正确显示。

除了第二次启动应用程序之外，所有这些似乎都正常工作。第一次和第三次工作正常。我错过了什么？

至于我的代码，我不知道该放什么。让我们从 UITableViewController 的实现开始。

```
@implementation FTWTMasterViewController

@synthesize managedObjectContext;
@synthesize categoryController = _categoryController;
@synthesize catLocViewController;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (NSFetchedResultsController *)categoryController {
    if (_categoryController != nil) {
        return _categoryController;
    }

    NSLog(@"tableview MOC = %@", self.managedObjectContext);

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Category" inManagedObjectContext:self.managedObjectContext];
    [fetchRequest setEntity:entity];

    NSSortDescriptor *sort = [[NSSortDescriptor alloc]
                              initWithKey:@"category_name" ascending:YES];
    [fetchRequest setSortDescriptors:[NSArray arrayWithObject:sort]];

    [fetchRequest setFetchBatchSize:20];

    NSFetchedResultsController *theFetchedResultsController =
    [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest
                                        managedObjectContext:self.managedObjectContext
                                          sectionNameKeyPath:nil
                                                   cacheName:@"CategoryTable"];
    _categoryController = theFetchedResultsController;
    _categoryController.delegate = self;

    return _categoryController;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.tableView.dataSource = self;
    self.tableView.delegate = self;

    NSError *error;
    if (![[self categoryController] performFetch:&error]) {
        // Update to handle the error appropriately.
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        exit(-1);  // Fail
    }

    NSLog(@"Fetch called");

    self.title = @"Categories";
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    NSLog(@"number of sections = %lu", (unsigned long)[[self.categoryController sections] count]);
    return [[self.categoryController sections] count];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    id  sectionInfo =
        [[_categoryController sections] objectAtIndex:section];

    NSLog(@"numberOfObjects = %lu", (unsigned long)[sectionInfo numberOfObjects]);
    return [sectionInfo numberOfObjects];
}

- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath {
    Category *category = [_categoryController objectAtIndexPath:indexPath];
    cell.textLabel.text = category.category_name;
    NSLog(@"config cell %@", category.category_name);
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"tableView setup");
    static NSString *CellIdentifier = @"categoryCell";

    UITableViewCell *cell =
    [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Set up the cell...
    [self configureCell:cell atIndexPath:indexPath];

    return cell;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    Category *aCategory = [self.categoryController objectAtIndexPath:indexPath];

    if (self.catLocViewController == nil){
        FTWTCatLocationViewController *aCatLocController = [[FTWTCatLocationViewController alloc] init];
        self.catLocViewController = aCatLocController;
    }

    self.catLocViewController.selectedCat = aCategory;
    aCategory = nil;

    self.catLocViewController.managedObjectContext = self.managedObjectContext;

    [self.navigationController pushViewController:self.catLocViewController animated:YES];

    self.catLocViewController = nil;
}

#pragma mark - Fetched results controller delegate
- (void)controllerWillChangeContent:(NSFetchedResultsController *)controller {
    // The fetch controller is about to start sending change notifications, so prepare the table view for updates.
    [self.tableView beginUpdates];
}

- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type newIndexPath:(NSIndexPath *)newIndexPath {

    NSLog(@"didChangeObject");

    UITableView *tableView = self.tableView;

    switch(type) {

        case NSFetchedResultsChangeInsert:
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeUpdate:
            [self configureCell:[tableView cellForRowAtIndexPath:indexPath] atIndexPath:indexPath];
            break;

        case NSFetchedResultsChangeMove:
            [tableView deleteRowsAtIndexPaths:[NSArray
                                               arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
            [tableView insertRowsAtIndexPaths:[NSArray
                                               arrayWithObject:newIndexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
}

- (void)controller:(NSFetchedResultsController *)controller didChangeSection:(id )sectionInfo atIndex:(NSUInteger)sectionIndex forChangeType:(NSFetchedResultsChangeType)type {

    switch(type) {

        case NSFetchedResultsChangeInsert:
            [self.tableView insertSections:[NSIndexSet indexSetWithIndex:sectionIndex] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [self.tableView deleteSections:[NSIndexSet indexSetWithIndex:sectionIndex] withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
}

- (void)controllerDidChangeContent:(NSFetchedResultsController *)controller {
    // The fetch controller has sent all current change notifications, so tell the table view to process all updates.
    [self.tableView endUpdates];
}

@end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T22:44:18.527

与我在上面的评论中所假设的相反，如果`sectionNameKeyPath`指定 a 来创建表格视图部分（我可以使用测试程序重现这一点），也会发生相同的效果。

当应用程序第一次启动时，会发生以下情况：

1.  创建了一个持久存储文件“appname.sqlite”。
2.  使用参数集创建表视图的获取结果控制器`cacheName`，以便创建节缓存文件。此时，所有部分都是空的。
3.  创建了一个后台 MOC，它从资源文件中读取一些 JSON 数据并将对象添加到上下文中。
4.  后台 MOC 被保存。

（顺便说一句。缓存文件是

```
 Library/Caches/<bundle-id>/.CoreDataCaches/SectionInfoCaches/<tablename>/sectionInfo 
```

在应用程序包中。）

当应用程序第二次启动时，获取的结果控制器会检查部分信息缓存是否仍然有效或必须重新创建。根据文档，它比较了持久存储文件和部分缓存文件的修改时间。

现在有趣的部分：如果（在第一次运行中）存储文件的创建（步骤 1）和保存更新的上下文（步骤 4）*发生在同一秒内*，那么存储文件的修改日期*不会*在步骤中更改4！！

因此，节缓存文件仍被视为有效*且未重新创建*。由于所有部分都是空的（在步骤 2 中），因此 FRC 使用此缓存信息并仅显示空部分。

后台 MOC 再次启动并保存上下文。现在商店文件有一个新的修改日期，因此在应用程序的第三次运行中可以正确显示部分和行。

为了确认我的“理论”，我在第一次和第二次运行之间手动“触摸”了存储文件以强制更改修改日期。然后正确显示所有部分和行。

（我只在 iPhone Simulator 中测试过。我不知道 HFS+ 文件系统是否通常具有修改日期的 1 秒分辨率，或者 SQLite 是否在这里做了一些特殊的事情。我稍后会尝试调查。）

*结论：*如果存储文件的创建和保存修改的数据发生在同一秒内，则可能不会在必要时重新生成节信息缓存文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-04T06:07:44.613

我遇到了同样的问题。当我加载数据时，第一次加载很好。当我重新启动我的应用程序时，数据从表中消失了。这些是我的计数：

`self.fetchedResultsController.fetchedObjects`: 8
`[self.fetchedResultsController.sections count]`: 1
`[self.fetchedResultsController.sections[0] numberOfObjects]`: 0

我有能力在 UI 中更改排序，在更改排序然后再次更改回来后，问题消失了，这肯定指向缓存问题。

打电话

```
[NSFetchedResultsController deleteCacheWithName:nil]; 
```

将删除所有缓存。

我也最终选择暂时不缓存。我不认为我会在我的数据库中为这些表存储数万条记录，所以我不确定缓存是否会有所改善。设置`cacheName`为`nil`将阻止对`NSFetchedResultsController`.

```
self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest
                                                                    managedObjectContext:self.context
                                                                      sectionNameKeyPath:sectionIdentifier
                                                                               cacheName:nil]; 
```

# php - 为不同的浏览器设置不同的登录表单？

> ID：14677077
> 
> 赞同：-1
> 
> 时间：2013-02-03T20:42:29.697
> 
> 标签：php, html

有人可以帮帮我吗。我很难让表单仅在 Firefox 中显示和正确运行。每个其他浏览器都可以正常工作。

但我想尝试在 php 中设置一个规则来说明 chrome，ie 等是否这样做，如果 firefox 这样做。

我在下面尝试了这一点，当使用 ie 和 chrome 等时，登录表单按预期出现，但使用 firefox 时没有显示登录表单。没有错误信息。

```
<div id="login">
    <?
    if (preg_match('/Chrome|Opera|Safari|MSIE 8.0/', $_SERVER['HTTP_USER_AGENT'])) { ?>

      <?php
        if (!logged_in()) {
            ?>

      <form id="myform" action="login.php" method="post" class="loginform">

    Email
      <input type="text" name="email" maxlength="30" />

    Password
    <input type="password" name="password" maxlength="30" />

    <input type="image" src="../PTB1/assets/img/icons/loginarrow1.png" name="submit" class="loginbutton" />

                </form>

               <?php
        }
        if (logged_in()) {
            ?>

                 Logged in as, <?php echo $_SESSION['email'] ?>. <a href="dashboard.php">Dashboard</a>, <a href="logout.php">Logout</a> |&nbsp;&nbsp;&nbsp;&nbsp;<div class="login_settings" id="login_settings"></div>
    <?php
        }

    else if (preg_match('/Firefox/', $_SERVER['HTTP_USER_AGENT'])) { 

        if (!logged_in()) {
            ?>

      <form action="login.php" rel="shadowbox;height=300;width=500" method="post" >

                    <div class="row email">
                        <input type="email" id="email" name="email" placeholder="Email" value="<?php echo htmlentities($email); ?>" />
                    </div>

                    <div class="row password">
                        <input type="password" id="password" name="password" placeholder="Password" value="<?php echo htmlentities($email); ?>" />
                    </div>
                    <input type="submit" name="submit" value="Login >"  />
                </form>

               <?php
        }
        if (logged_in()) {
            ?>

                 Logged in as, <?php echo $_SESSION['email'] ?>. <a href="dashboard.php">Dashboard</a>, <a href="logout.php">Logout</a> |&nbsp;&nbsp;&nbsp;&nbsp;<div class="login_settings" id="login_settings"></div> 

    <?  

    } } }
    ?>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:50:56.220

我对您的代码的理解是，您正试图检测浏览器是否是 Firefox，以便您可以使用该`placeholder`属性和其他 HTML5 表单功能。

这不仅是一个可怕的想法（IE10 和 Chrome 都支持`placeholder`，而且我相信 Opera 也支持），而且`placeholder`无论如何它都是对该属性的不恰当使用。

相反，只需使用这种形式：

```
<form action="login.php" method="post">
  <div class="row email">
    Email:
    <input type="email" id="email" name="email" placeholder="john.smith@example.com" />
  </div>
  <div class="row password">
    Password:
    <input type="password" id="password" name="password" placeholder="Password" />
  </div>
  <input type="submit" name="submit" value="Login &gt;" />
</form> 
```

毕竟，放置一个可能不受支持的属性并没有什么坏处，它只是被忽略了。

# java - UnsatisfiedLinkError：java.library.path 中没有 j3dcore-ogl

> ID：14677079
> 
> 赞同：4
> 
> 时间：2013-02-03T20:42:45.707
> 
> 标签：java, eclipse, exception, java-3d, unsatisfiedlinkerror

我在 Eclipse 中有一个项目，当我单击运行时在 ide 中运行得非常好，但我需要将它导出到一个也可以正常工作的可运行 jar 文件中。但是当我尝试运行它时，它会抛出一个异常：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: no j3dcore-ogl in java.library.path
    at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1856)
    at java.lang.Runtime.loadLibrary0(Runtime.java:845)
    at java.lang.System.loadLibrary(System.java:1084)
    at javax.media.j3d.NativePipeline$1.run(NativePipeline.java:231)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.media.j3d.NativePipeline.loadLibrary(NativePipeline.java:200)
    at javax.media.j3d.NativePipeline.loadLibraries(NativePipeline.java:157)
    at javax.media.j3d.MasterControl.loadLibraries(MasterControl.java:987)
    at javax.media.j3d.VirtualUniverse.<clinit>(VirtualUniverse.java:299)
    at javax.media.j3d.GraphicsConfigTemplate3D.getBestConfiguration(GraphicsConfigTemplate3D.java:321)
    at java.awt.GraphicsDevice.getBestConfiguration(GraphicsDevice.java:207)
    at com.sun.j3d.exp.swing.JCanvas3D.<init>(JCanvas3D.java:228)
    at com.sun.j3d.exp.swing.JCanvas3D.<init>(JCanvas3D.java:178)
    at mainproject.MainPanel.<init>(MainPanel.java:72)
    at mainproject.MainWindow.<init>(MainWindow.java:42)
    at mainproject.MainWindow.main(MainWindow.java:23) 
```

我已经在谷歌上搜索了 2 天，结果很多，没有任何帮助。我通过去导出它`file->export->java->Runnable jar file->i bubble extract required libraries into generated jar`，选择正确的配置，将文件保存在指定的文件夹中，然后保存就好了。或者至少我是这么认为的。`java.library.path`转到.so，但是当`jre lib folder`我在eclipse中运行它时，它转到j3d的.so，我尝试使用更改它`System.setProperty`但没有成功。我有一种感觉是问题所在，但是当我试图解决它时，什么也没发生。我正在使用最新的`java3d library (1.5.2 I believe)`。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-04-03T13:09:46.753

如果我设置 export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib/jni 它可以工作。

# c# - 使用额外信息扩展 Visual Studio 2012 测试资源管理器

> ID：14677080
> 
> 赞同：8
> 
> 时间：2013-02-03T20:43:01.583
> 
> 标签：c#, visual-studio-2012

作为一些研究的一部分，我正在为 Microsoft Visual Studio 单元测试框架编写一个具有自定义测试类型的扩展，如此处[所述](http://blogs.msdn.com/b/vstsqualitytools/archive/2009/09/04/extending-the-visual-studio-unit-test-type-part-1.aspx)。我已经创建了一个自定义属性，但我想在测试资源管理器中显示一些关于从我的自定义属性执行的测试的附加信息。

我还想知道是否有任何方法可以显示过去执行的所有单元测试的信息（因此来自我的自定义属性，也来自默认的 Visual Studio 单元测试框架属性）。所以我可以在图表等中显示这些测试的信息。

有人知道实现这一目标的好方法吗？

**更新 1** 我的意思是这样的：

![在此处输入图像描述](../Images/3d2a6f3abd097b7a0f4b85aa967cd57a.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T17:56:13.127

您是否尝试在测试资源管理器中显示测试的其他特征？如果是这样，您可以使用 Visual Studio 2012 Update 1 中添加的“按特征分组”（参考[http://blogs.msdn.com/b/somasegar/archive/2012/11/26/visual-studio的详细信息-2012-update-1-now-available.aspx](http://blogs.msdn.com/b/somasegar/archive/2012/11/26/visual-studio-2012-update-1-now-available.aspx)，从[http://www.microsoft.com/en-us/download/details.aspx?id=35774](http://www.microsoft.com/en-us/download/details.aspx?id=35774)下载）。

简而言之，你可以用类似的东西来装饰你的测试

```
 [TestMethod]
    [TestCategory("SpecialTestType")]
    [TestProperty("XXX","YYY")]
    public void TestMethod1()
    {
    } 
```

再次发现此测试后，选择“Group By Traits”（TextExplorer 工具窗口中的工具栏）将根据您的特征（例如 SpecialTestType、XXX）对测试进行分组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-22T09:28:10.743

Console.WriteLine 完成了这项工作...用户可以单击“输出”并查看输出...

# mysql - 连接两列中具有相同值的两行

> ID：14677081
> 
> 赞同：1
> 
> 时间：2013-02-03T20:43:05.363
> 
> 标签：mysql, sql

这是我的桌子的打印屏幕图像。

![在此处输入图像描述](../Images/9cced5750a86abe6ffa622c4f91615e3.png)

我有一个名为“table”的 MySQL 表。当我`SELECT * FROM table`在while循环中写“”时，我想获得一次相同的“fikraNo”和“maddeNo”值。但如果 fikraNo 和 maddeNo 具有相同的值，则必须加入“icerik”。例如，当我想从表中获取所有值时，输出必须是这样的：

```
1   1   174     Lorem ipsum dolor sit amet, consectetur adipiscing...
2   2   174     1500'lerden beri kullanılan standart Lorem Ipsum...
3   3   174     Nullam mollis accumsan quam eget aliquet. Ut sit a...
4   1   135     Phasellus ac massa neque. Nunc blandit, nibh sit a...
5   2   135     Nulla id placerat odio. Fusce quis porttitor dui. ...
6   0   135     Vestibulum elit neque, ultrices ac consequat vitae...
7   1   134     Etiam dignissim, lacus sed faucibus auctor, felis ...
8   2   134     Vestibulum rhoncus ultricies arcu id feugiat. Null...
9   1   133     Donec sit amet nunc urna. Vivamus id dui velit, ac...
10  0   133     Maecenas aliquet pellentesque egestas. Vestibulum ...
11  0   109     armut dalda kız balkonda sallanır vay vay...
12  1   109     Duis consequat luctus rhoncus. Etiam ante lectus, ...
14  3   116     Lorem ipsum dolor sit amet, consectetur adipiscing...
15  0   2       This is the first item in the first field.
16  0   2       And this is the second item in second field. 
```

你能帮我吗，我该如何处理？最好的祝福。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:49:34.570

您需要一个聚合函数将 s 连接在一起`icerik`，如果您还想显示最小 id，您还需要一个聚合函数来获得它。

这应该做的工作：

```
SELECT MIN(id),
       fikraNo,
       maddeNo,
       GROUP_CONCAT(icerik ORDER BY id DESC SEPARATOR ' ')
FROM `table`
GROUP BY fikraNo, maddeNo 
```

在这里演示： [http ://sqlfiddle.com/#!2/ad7c93/1](http://sqlfiddle.com/#!2/ad7c93/1)

# vb.net - Visual Studio - VB.Net - 抛出堆栈错误

> ID：14677086
> 
> 赞同：0
> 
> 时间：2013-02-03T20:43:32.867
> 
> 标签：vb.net

我正在尝试更多地了解编程语言。我正在使用以下代码使用递归。我让它运行，直到抛出堆栈异常。在不捕获错误和/或防御性编码以防止这种深度递归的情况下： - 当此例程运行时，我是否可以进行调整以释放任何堆栈空间？

Module Module1 Private var As Integer = 1

```
Sub Main()
    Take1(var)
End Sub

Public Function Take1(p1 As Integer) As Integer
    p1 = p1 + 1
    Console.Write(p1 & vbCrLf)
    Take1 = Nothing
    Call Take2(p1)
End Function

Public Function Take2(p1 As Integer) As Integer
    p1 = p1 + 1
    Console.Write(p1 & vbCrLf)
    Take2 = Nothing
    Call Take1(p1)
End Function 
```

端模块

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:19:58.177

您的代码导致无限递归。请参阅此处描述此内容的链接：http: [//msdn.microsoft.com/en-us/library/system.stackoverflowexception.aspx](http://msdn.microsoft.com/en-us/library/system.stackoverflowexception.aspx)

该链接说从 .NET 2.0 开始，您无法使用 try-catch 块捕获此类异常，并给出了不这样做的充分理由。

# iphone - 如何使用两个数据源对 UITableView 内容进行排序

> ID：14677093
> 
> 赞同：0
> 
> 时间：2013-02-03T20:44:03.397
> 
> 标签：iphone, objective-c, sorting, uitableview

您好我有以下问题：

我正在编写游戏，每次玩家完成分数时都会提交。所以我有两个数据源：分数和模式。我想将这些高分分为 4 个部分，即我拥有的 4 种模式。在这些部分中，它应该按分数排序（最高的在顶部）。

然而我得到了这个代码：

```
- (NSFetchedResultsController *)fetchedResultsController{
if (_fetchedResultsController != nil) {
    return _fetchedResultsController;
}

NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
// Edit the entity name as appropriate.
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Event" inManagedObjectContext:self.managedObjectContext];
[fetchRequest setEntity:entity];

// Set the batch size to a suitable number.
[fetchRequest setFetchBatchSize:20];

// Edit the sort key as appropriate.
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"score" ascending:NO];
NSArray *sortDescriptors = @[sortDescriptor];

[fetchRequest setSortDescriptors:sortDescriptors];

// Edit the section name key path and cache name if appropriate.
// nil for section name key path means "no sections".
NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:@"Master"];
aFetchedResultsController.delegate = self;
self.fetchedResultsController = aFetchedResultsController;

_fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:@"mode" cacheName:nil];
_fetchedResultsController.delegate = self;
[_fetchedResultsController performFetch:nil];

NSError *error = nil;
if (![self.fetchedResultsController performFetch:&error]) {
     // Replace this implementation with code to handle the error appropriately.
     // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
}

return _fetchedResultsController;} 
```

但我得到的只是一个非常随机的排序。第一次成功，但玩了几局后就搞砸了！我的模式是：10,20,30,60（秒） 左边的金色徽章显示它应该在哪个部分进行排序。希望有人能帮助我。

[iPhone 截图](http://i.stack.imgur.com/FXSXh.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:25:53.273

您需要为模式和分数添加另一个排序描述符。

您需要先按模式排序，然后按分数排序。当您当前按分数排序并按名称分区时，您将获得...

```
Mode 1:
- Score 100
- Score 99
Mode 2:
- Score 80
Mode 1:
- Score 70
etc... 
```

像这样更改您的排序描述符代码...

```
NSSortDescriptor *modeSD = [[NSSortDescriptor alloc] initWithKey:@"mode" ascending:YES];
NSSortDescriptor *scoreSD = [[NSSortDescriptor alloc] initWithKey:@"score" ascending:NO];
NSArray *sortDescriptors = @[modeSD, scoreSD];

[fetchRequest setSortDescriptors:sortDescriptors]; 
```

那应该为你排序（双关语非常有意;-)）

如果您想要四个单独的部分，那么您的 NSFRC 将如下所示...

```
// note the section name key path
NSFetchedResultsController *nsfrc = [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:self.managedObjectContext sectionNameKeyPath:@"mode" cacheName:nil]; 
```

然后，这会将数据拆分为部分和行。

节数是`[[nsfrc allSections] count];`

等等...

# python - 读取文件并加入 numpy 数组中的两列

> ID：14677096
> 
> 赞同：1
> 
> 时间：2013-02-03T20:44:32.087
> 
> 标签：python, datetime, numpy, genfromtxt

我有一个文本数据，例如：
`16/12/2006;17:24:00;1.000;17.000`
第一列是日期，第二列是时间，剩下的只是一些浮点数。现在我正在阅读文件，例如：

```
np.genfromtxt(path,
              dtype=(np.datetime64, np.datetime64, np.float16, np.float16),
              delimiter=';',
              converters = {0: lambda x: datetime.datetime.strptime(x, "%d/%m/%Y"),
                            1: lambda x: datetime.datetime.strptime(x, "%H:%M:%S")}) 
```

这会导致非常基本的问题，即第二列的默认日期设置为 1900 年 1 月 1 日。有没有办法在读取文件时或读取文件后结合前两列的日期和时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:29:16.360

您可以使用普通的 Python 命令阅读它并自己创建连接字段。然后，如果需要，您可以在其上运行转换器：

```
from datetime import datetime

fp = open("test.dat", "r")
lines = [ line.split(";") for line in fp.readlines() ]
fp.close()
fulldates = [ " ".join(line[0:2]) for line in lines if len(line) > 1 ]
converted = [ datetime.strptime(date, "%d/%m/%Y %H:%M:%S")
              for date in fulldates ] 
```

该列表`fulldates`将包含连接数据+时间字段的列表。该列表`converted`将包含初始化的日期时间对象。（我添加`if len(line) > 1`过滤器只是为了处理文件中最终的空行。如果您的文件不包含任何内容，则可以省略它。）

# android - 什么 Android 布局允许包装块/按钮 - 而不是奇怪的拉伸？

> ID：14677097
> 
> 赞同：1
> 
> 时间：2013-02-03T20:44:34.273
> 
> 标签：android, android-layout

我想找到合适的布局来包装按钮而不是奇怪的拉伸。

一些例子是我得到的：

![无效换行](../Images/235b696c64fc9f3d10fe732824735980.png)

我想要实现的目标：

![有效换行](../Images/42f22655d7ae0674ee7152c3ec8f67d9.png)

请帮助并解释在 Android 中是否有可能在 HTML5 中很容易 - 我在考虑 ScrollView 但不确定是否需要。我搜索了很多页面，但没有找到好的解决方案，并认为这是微不足道的，但不知道答案。

这是当前代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button"
        tools:ignore="HardcodedText" />

    <Button
        android:id="@+id/btn_goHome"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_toRightOf="@+id/button1"
        android:text="@string/button_go_home" />

    <Button
        android:id="@+id/btn_openEmails"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_toRightOf="@+id/btn_goHome"
        android:text="@string/button_open_emails" />

    <Button
        android:id="@+id/btn_openTests"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_toRightOf="@+id/btn_openEmails"
        android:text="Open tests" />

    <ScrollView
        android:id="@+id/scrollView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/btn_openTests"
        android:layout_centerHorizontal="true" >

        <LinearLayout
            android:id="@+id/list1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:divider="?android:dividerHorizontal"
            android:orientation="vertical"
            android:paddingLeft="16dp"
            android:paddingRight="16dp"
            android:showDividers="middle" >

        </LinearLayout>
    </ScrollView>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:19:57.827

我会推荐`FlowLayout`这个人自己创造的 - Romain Guy。我认为它会做你想要的。

这是实现：[Android Layouts.zip](https://docs.google.com/file/d/0B_VKZCqEnHblNDdiY2UxODgtYWNhNS00MmU4LWE4NDMtZjQ1OWI5MDMxZTVh/edit?num=50&sort=name&layout=list&pli=1#)

这是他的原始帖子：[我怎样才能在 Android 中做类似 FlowLayout 的事情？](https://stackoverflow.com/q/4474237/1820695)

可以在这里找到另一种实现：[Android 中的 FlowLayout](http://nishantvnair.wordpress.com/2010/09/28/flowlayout-in-android/)

最后，您在 GitHub 上有一个使用 BSD 许可证的实现：[ApmeM / android-flowlayout](https://github.com/ApmeM/android-flowlayout)。有一些屏幕截图和文档可以让你快速上手。

# clojure - ClojureScript 中函数调用结果的方法定义

> ID：14677098
> 
> 赞同：2
> 
> 时间：2013-02-03T20:44:38.003
> 
> 标签：clojure, clojurescript

这是用于 Knockout 的 JS 示例：

```
function AppViewModel() {
    this.firstName = ko.observable('Bob');
    this.lastName = ko.observable('Smith');
    this.fullName = ko.computed(function() {
        return this.firstName() + " " + this.lastName();
    }, this);
} 
```

如果您不熟悉 KO，则每个字段`AppViewModel`都将成为一个函数（即`ko.observable`，每个字段`ko.computed`都返回一个函数。还要注意这`fullName`取决于两个函数。

如何将其重写为 ClojureScript？

要尝试的一件事是：

```
(deftype AppViewModel [firstName lastName]
  Object
  (fullName [this] (.computed js/ko (str (firstName) " " (lastName)))))

(defn my-model [first last]
  (AppViewModel. 
    (.observable js/ko "Bob") 
    (.observable js/ko "Smith"))) 
```

但它不起作用，因为它`fullName`变成了一个调用`ko.computed`. 也就是说，它编译为：

```
my_namespace.AppViewModel.prototype.fullName = function() {
  return ko.computed([cljs.core.str(this.firstName.call(null)), cljs.core.str(" "), cljs.core.str(this.lastName.call(null))].join(""))
}; 
```

如何在 ClojureScript 中处理它？

再次注意`fullName`on`this`和`firstName`/的依赖关系`lastName`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T04:51:55.653

试试这个：

```
(defn my-model [first last]
  (let [fname (.observable js/ko first)
        lname (.observable js/ko last)
        full-name (.computed js/ko #(str (fname) " " (lname)))] 
        (js-obj "firstName" fname
                "lastName" lname
                "fullName" full-name))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T22:04:36.170

重复@Ankur 的回答，您似乎还可以执行以下操作：

```
 (deftype AppViewModel [firstName lastName fullName])

  (defn my-model [first last]
    (AppViewModel. 
      (.observable js/ko "Bob") 
      (.observable js/ko "Smith")
      (.computed js/ko (str (firstName) " " (lastName))))) 
```

# c# - 如何将元组的两个整数值合并为一个以存储在 Hashset 中？

> ID：14677100
> 
> 赞同：0
> 
> 时间：2013-02-03T20:44:42.603
> 
> 标签：c#, tuples, hashset

我有两种这样的方法

```
HashSet<Tuple<int,int>> _xyPairs = new HashSet<Tuple<int,int>>();
private void SetTravelled(int x, int y, bool travelled)
{
    var t = new Tuple<int, int>(x, y);

    if (travelled)
        _xyPairs.Add(t);
    else
        _xyPairs.Remove(t);
}

private bool HaveTravelled(int x, int y)
{
    return _xyPairs.Contains(new Tuple<int, int>(x, y));
} 
```

我不太介意第一种方法，因为它不经常被调用。然而，第二种方法被非常频繁地调用。所以我必须一遍又一遍地创建新的元组。

有没有办法将两个整数组合成一个哈希集的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:54:00.293

如果您有迹象表明元组实际上给您带来了问题，您可以尝试将两个 32 位整数组合成一个 64 位整数：

```
HashSet<long> _xyPairs = new HashSet<long>();

private void SetTravelled(int x, int y, bool travelled)
{
    var t = Combine(x, y)
    ...

private bool HaveTravelled(int x, int y)
{
    return _xyPairs.Contains(Combine(x, y));
}

private static long Combine(int x, int y)
{
    return (long)(((ulong)x) | ((ulong)y) << 32);
} 
```

# android - 如何根据背景决定使用哪个图标？

> ID：14677101
> 
> 赞同：1
> 
> 时间：2013-02-03T20:44:45.813
> 
> 标签：android

我下载了一些免费图标并创建了一个通知。起初我以为有些东西坏了，但后来我意识到我使用的图标与背景颜色相同。

我下载的包包括几个版本，如“holo_dark”和“holo_light”。我认为这与不同 android 版本或用户可自定义设置中的主题有关。

在这种情况下确定使用哪个图标的预期方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:02:08.860

这些图标特定于您将在 android 应用程序中使用的主题。您必须在应用程序中识别主题，然后为您的主题使用特定的图标集。

为了更清楚，您可以参考[Android Asset Studio ActionBar 和 Tab Icon Generator](http://android-ui-utils.googlecode.com/hg/asset-studio/dist/icons-actionbar.html#source.space.trim=1&source.space.pad=0&name=example&theme=light)并查看为不同主题生成的图标的差异。

此外，本文对于了解[样式和主题](http://developer.android.com/guide/topics/ui/themes.html)在 Android 中的工作方式非常有用。

# python - 进行条件 django 查询的更好方法

> ID：14677104
> 
> 赞同：0
> 
> 时间：2013-02-03T20:44:48.627
> 
> 标签：python, mysql, django

有没有更好的方法来执行以下操作：

```
 if column_sort == 'size':
        if sort == 'desc':
            results = results.order_by('-size')
        else:
            results = results.order_by('size')
    elif column_sort == 'modified':
        if sort == 'desc':
            results = results.order_by('-last_modified')
        else:
            results = results.order_by('last_modified')
    else:
        if sort == 'desc':
            results = results.order_by('-path')
        else:
            results = results.order_by('path')
    results = results[:100] 
```

例如，一种反转查询顺序的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:52:08.343

你只写一次代码怎么样？

```
valid_column_sorts = ['size', 'last_modified', 'path']

if column_sort in valid_column_sorts:
    if sort == 'desc':
        column_sort = '-' + column_sort
    results = results.order_by(column_sort) 
```

哦，是的，我看到排序字段和值之间存在一些差异，在这种情况下，您需要一个简单的映射，例如`results.order_by(col_map[column_sort])`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:54:25.593

更好的方法是使用 dict 来映射 的值`column_sort`：

```
d = {'size': 'size',
     'modified': 'last_modified',
     #... add more items as needed
    } 
```

现在您只需要调用字典，如果字典中的值不在，则`get`使用第二个参数指定默认值：`column_sort`

```
orderby = d.get(column_sort, "path") 
```

对于`sort`变量，只需根据需要添加`'-'`：

```
orderby = '-' + orderby if sort == "desc" else orderby 
```

现在只需执行它：

```
results = results.order_by(orderby) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T20:53:56.087

这应该是：

```
columns = dict(size='size', modified='last_modified')
column_sort = columns.get(column_sort, 'path')
order = lambda v: '-' if v == 'desc' else ''
results.order_by(order(sort) + column_sort) 
```

它会将用户指定的列名转换为您的架构，并假定默认值为“路径”。

# c++ - 如何设置默认g++？

> ID：14677108
> 
> 赞同：1
> 
> 时间：2013-02-03T20:45:00.983
> 
> 标签：c++, g++, version, default

我的主机已经安装了 c++11 和 g++ 4.7.2（我被告知），但我们无法弄清楚如何将 4.7.2 设置为默认值，因为`g++ --version`我仍然说我是 4.1.2。

Stack 向我展示了我无法[对整数的多维向量进行排序？](https://stackoverflow.com/questions/14669533/sort-multidimensional-vector-of-ints?lq=1)没有[cc1plus: error: unrecognized command line option "-std=c++11" with g++](https://stackoverflow.com/questions/14674597/cc1plus-error-unrecognized-command-line-option-std-c11-with-g)，但我遇到的所有设置默认值的答案似乎都不起作用。

**CentOS 5.9**

我正在使用 CentOS 5.9，我不知道这是否是问题，但我尝试`g++-4.7`了[如何将 g++ 编译器的版本从 4.1.2 更改为 4.5](https://stackoverflow.com/questions/2916502/how-to-change-version-of-g-compiler-from-4-1-2-to-4-5)`g++-4.7.2`？, 但 SSH 说and for both ( for .2). 如果我在前面放一个空格，它会说。`sudo: apt-get: command not found``-bash: g++-4.7: command not found` `.2``-4.7``g++: unrecognized option '-4.7'`

[我在这里](https://stackoverflow.com/a/14674646/1382306)尝试了我最后一个 c++ q 的 A 中建议的解决方案，命令执行没有错误，但没有返回任何内容，并且`g++ --version`仍然给出：

```
g++ (GCC) 4.1.2 20080704 (Red Hat 4.1.2-54)
Copyright (C) 2006 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

**海合会？**

我在很多链接上都看到过这与 g++ 相关联，但我什至不知道它是什么，而且我害怕尝试[这个](https://askubuntu.com/questions/26498/choose-gcc-and-g-version)以防止损坏我的系统。

我的主人说这是他们支持的极限，所以我完全靠自己。另外，请理解我一两周前才开始使用 C++，对 linux 一无所知。

请帮忙！提前谢谢了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:54:59.817

当您有多个提供类似功能的应用程序时，选择首选应用程序的官方机制是`update-alternatives`.

尝试使用这个：

```
 sudo update-alternatives --config g++ 
```

如果您安装了多个版本的 gcc，它将为您提供将其中一个设为默认版本的选项。

有时，没有安装替代品 - 可能是包维护者遗漏了。您可以通过手动安装来修复它，如下所示：

```
 sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.4 20 
```

* * *

`g++`或者，您可以直接`gcc`从您的. [在此答案](https://stackoverflow.com/questions/13365348/is-it-possible-to-build-aosp-project-gingerbread-in-kubuntu12-04-xubuntu/13415103#13415103)中查看更多详细信息。`~/bin``$HOME/bin``PATH`

# mysql - Ruby 连接到 MySQL

> ID：14677109
> 
> 赞同：0
> 
> 时间：2013-02-03T20:45:12.883
> 
> 标签：mysql, ruby, rubygems

我想使用[开源代码](http://geeqe.googlecode.com/svn/trunk/scripts/load.rb)将 Stack Overflow 数据导入我的 MySQL 数据库：

```
if ARGV.size != 5
  puts "Usage load.rb Usage load.rb <XML file path> <db host> <db user> <db pass> <db name>"
  exit 1
end

my = Mysql::new(ARGV[1], ARGV[2], ARGV[3], ARGV[4])

puts "Loading badges"

parser = XML::SaxParser.file(ARGV[0] + '/badges.xml')
parser.callbacks = BadgeCallbacks.new(my)
parser.parse 
```

我收到以下错误：

```
load.rb:129:in `new': Can't connect to local MySQL server through socket '/opt/local/var/run/mysql5/mysqld.sock' (2) (Mysql::Error)
    from load.rb:129:in `<main>'
mac@localhost:[~/rubycode]$ruby load.rb '~/rubycode/stackoverflow_1' 'localhost' 'test' 'test' 'stackflow'
load.rb:129:in `new': Can't connect to local MySQL server through socket '/opt/local/var/run/mysql5/mysqld.sock' (2) (Mysql::Error)
    from load.rb:129:in `<main>' 
```

我确实使用 RVM 安装了 MySQL gem。

# sax - 使用 Batik 检查 SVG 上传

> ID：14677112
> 
> 赞同：0
> 
> 时间：2013-02-03T20:45:26.147
> 
> 标签：sax, batik

我尝试检查上传的 SVG 图形并寻找图像元素以读取 href 属性。我正在使用**Batik 1.7**搜索相应的元素。通过使用`'getElementsByTagName' / 'getElementsByTagNameNS'`我只得到一个空列表。这是我的代码：

```
try{
    String parser = XMLResourceDescriptor.getXMLParserClassName();
    SAXSVGDocumentFactory f = new SAXSVGDocumentFactory(parser);
    SVGDocument doc = f.createSVGDocument(null, upload.getInputStream());
    NodeList list = doc.getElementsByTagNameNS("http://www.w3.org/2000/svg", "image");
}
catch(Exception e){
} 
```

那么我在这里缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:58:35.433

事实上，我什么都没错过，尽管返回的 NodeList 将是长度为 -1 的市场，只要检索到某些项目或查询长度。所以可以说调试器并不总是说实话。

# amazon-s3 - 使用 get_contents_to_filename 需要哪些角色权限？

> ID：14677113
> 
> 赞同：2
> 
> 时间：2013-02-03T20:45:30.013
> 
> 标签：amazon-s3, boto

我最近设置了一个 IAM 角色来访问具有以下策略的存储桶：

```
{
  "Statement": [
    {
      "Sid": "Stmt1359923112752",
      "Action": [
        "s3:*"
      ],
      "Effect": "Allow",
      "Resource": [
        "arn:aws:s3:::<BUCKET_NAME>"
      ]
    }
  ]
} 
```

虽然我可以很好地列出存储桶的内容，但当我调用`get_contents_to_filename`特定键时，我会收到`boto.exception.S3ResponseError: S3ResponseError: 403 Forbidden`异常。

是否需要添加角色权限才能从 S3 获取密钥？我检查了单个密钥的权限，似乎没有明确禁止其他用户访问的内容；只有一个权限授予所有者完全权限。

为了完整起见，我验证了删除上面的角色策略会完全阻止对存储桶的访问，因此应用的策略不是问题。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:51:29.523

您必须向存储桶中的对象授予权限，而不仅仅是对存储桶。所以你的资源必须是`arn:aws:s3:::<bucketname>/*`. 这匹配每个对象。

不幸的是，这与存储桶本身不匹配。因此，您要么需要授予与存储桶相关的权限`arn:aws:s3:::<bucketname>`和对象权限`arn:aws:s3:::<bucketname>/*`，要么只授予`arn:aws:s3:::<bucketname>*`. 尽管在后一种情况下，授予名为*fred*的存储桶的权限也会授予名为*freddy*的存储桶相同的权限。

# ruby-on-rails-3 - Heroku 部署的应用程序出现 Sendgrid 错误而没有日志信息

> ID：14677116
> 
> 赞同：1
> 
> 时间：2013-02-03T20:46:06.117
> 
> 标签：ruby-on-rails-3, heroku, sendgrid

我的应用程序有一个联系页面，用户可以在其中输入他们的姓名/电子邮件/主题/内容并向我发送消息。我正在使用 Heroku 的 Sendgrid 插件，并认为我几乎做对了所有事情。我有这个在我的

emails_controller.rb

```
if @email.save
  ContactMailer.contact_message(@email).deliver
  flash.now[:success] = "Your email has sent! I'll try to get back to you shortly."
  render :new
else
  flash.now[:error] = "Please correct the highlighted errors and try again."
  render :new
end 
```

（这里的想法是记录每封电子邮件并将其发送给我）。

我的配置/初始化程序/mail.rb

```
# SendGrid Settings
ActionMailer::Base.smtp_settings = {
  :address        => 'smtp.sendgrid.net',
  :port           => '587',
  :authentication => :plain,
  :enable_starttls_auto => true,
  :user_name      => ENV['SENDGRID_USERNAME'],
  :password       => ENV['SENDGRID_PASSWORD'],
  :domain         => 'myappname.com'
}
ActionMailer::Base.delivery_method = :smtp 
```

然后，为了更好地衡量，遵循其他人在 sendgrid 支持问题中所做的事情。配置/环境/production.rb：

```
config.action_mailer.default_url_options = { :host => 'myappname.com' } 
```

我的contact_email.html.erb：

```
class Contact < ActionMailer::Base
  default from: "unimportant@example.com"

  def contact_message(email)
    @name = email.name
    @address = email.address
    @subject = email.subject
    @content = email.content
    mail(:to => ENV['EMAIL_ADDRESS'], :subject => @subject)
  end

end 
```

我通过添加了所有必要的环境变量

```
heroku config:add EMAIL_ADDRESS=blah@blah.com
heroku config:add SENDGRID_USERNAME=blah 
```

但是，当我推到 heroku 并尝试给自己发送一封电子邮件时，它给了我“我们很抱歉。出了点问题”的死亡屏幕，并且日志（在我看来）完全没用。

这是从我上次推送到 heroku 并尝试向自己发送电子邮件时开始的日志。任何想法可能出了什么问题？

```
2013-02-03T20:34:18+00:00 heroku[router]: at=info method=GET path=/ host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=7ms service=201ms status=304 bytes=0
2013-02-03T20:34:18+00:00 heroku[router]: at=info method=GET path=/assets/application-cd9c41b78562d03bb04bcaaa585b31e8.js host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=1ms service=11ms status=200 bytes=125507
2013-02-03T20:34:19+00:00 heroku[router]: at=info method=GET path=/assets/pig3-b2d5155bd2811a87cafec6a447459580.png host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=1ms service=4ms status=200 bytes=3010
2013-02-03T20:34:19+00:00 heroku[router]: at=info method=GET path=/assets/github-e8c3b3f49b0cc737afe9b3cd6e9ab159.png host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=1ms service=4ms status=200 bytes=3687
2013-02-03T20:34:19+00:00 heroku[router]: at=info method=GET path=/assets/odesk2-38dadc2e6b0e94aa6c6766df301716bc.png host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=1ms connect=2ms service=4ms status=200 bytes=3932
2013-02-03T20:34:19+00:00 heroku[router]: at=info method=GET path=/assets/star-02718a47b29575c2d7a0e75ac8bebf4d.png host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=2ms service=4ms status=200 bytes=3104
2013-02-03T20:34:19+00:00 heroku[router]: at=info method=GET path=/assets/empty_star-9bf002077eafec40cf239068f7d4d1ca.png host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=1ms service=43ms status=200 bytes=3072
2013-02-03T20:34:23+00:00 heroku[router]: at=info method=GET path=/emails/new host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=1ms service=119ms status=200 bytes=3022
2013-02-03T20:34:23+00:00 heroku[router]: at=info method=GET path=/assets/application-74fd2354261a1131b26861b47bef1d87.css host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=2ms service=4ms status=304 bytes=0
2013-02-03T20:34:19+00:00 heroku[router]: at=info method=GET path=/assets/headshot-767c8913c7af4fc97cb8e15881884f0e.png host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=4ms connect=6ms service=11ms status=200 bytes=146892
2013-02-03T20:34:39+00:00 heroku[router]: at=info method=POST path=/emails host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=7ms service=131ms status=500 bytes=643
2013-02-03T20:34:39+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=<appname>-2591.herokuapp.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=1ms connect=3ms service=5ms status=200 bytes=0 
```

此外，我确实添加了 Sendgrid（按照 Heroku 的说明），并且 Sendgrid 用户界面显示未发送任何电子邮件。我最后一次尝试这个时，以下行似乎是 heroku 日志中唯一一个在我尝试发送另一条消息时带有相关时间戳的行。不是很有帮助：

```
2013-02-04T18:15:45+00:00 heroku[router]: at=info method=GET path=/contact host=myappname.com fwd=69.181.104.85 dyno=web.1 queue=0 wait=0ms connect=2ms service=334ms status=200 bytes=3695 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T18:59:40.380

由于它没有显示在您的 SendGrid 仪表板上，我猜您的凭据在应用程序中是错误的。如果您键入`heroku config`，您是否看到`SENDGRID_USERNAME`并`SENDGRID_PASSWORD`正确设置？

此外，您可能想尝试将传递错误设置为显示在您的配置文件中。

```
config.action_mailer.raise_delivery_errors = true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:24:28.927

澄清一下，您无法访问 SendGrid 网站上的帐户设置，因为 Heroku 已将其锁定。您可以直接从 Heroku 界面调整这些相同的设置。

# matlab - 如何在MATLAB中每次为每100个数字分隔矩阵的每一列

> ID：14677119
> 
> 赞同：1
> 
> 时间：2013-02-03T20:46:20.060
> 
> 标签：matlab, matrix, calculated-columns

在 MATLAB 中，我有一个包含 80000*20 个数字的矩阵。我想计算第 1 列中的前 100 个数字（0-100）、第 1 列中的下一个（第二个）100 个数字（101-200）、第 1 列中的第三个 100 个数字（201）的平均值、最大值和最小值-300) 等。对所有列都相同。我想我需要一个循环来分离矩阵，因为矩阵的大尺寸。我怎样才能做到这一点？

例如：矩阵：

A1 A2 A3 A4 A5

B1 B2 B3 B4 B5

C1 C2 C3 C4 C5

D1 D2 D3 D4 D5

E1 E2 E3 E4 E5

F1 F2 F3 F4 F5

然后我想要 A1 B1 C1 的平均值、最小值和最大值以及 D1 E1 F1 的平均值、最小值和最大值。第 2 列 (A2 B2 C2) 和 (D2 E2 F2),3,4,5,6..等类似

问候，

文森特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:31:11.560

这是另一种不使用单元的无循环解决方案。

```
% M is the 80000x20 matrix
rows_per_dataset = 100;
rows_in_solution = size(M,1)/rows_per_dataset;

% flatten out the matrix so each column is one dataset
M_grouped = reshape(M,rows_per_dataset,rows_in_solution*size(M,2));
means = mean(M_grouped);
means = reshape(means,rows_in_solution,size(M,2));
% the value in each row and column is the mean of the corresponding dataset
% in the original data 
```

然而，对于足够大的数据集，将数据复制到临时变量是低效的，基于循环的解决方案更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:02:46.963

这是两种可能的解决方案的示例。一个使用循环。另一个将您的矩阵转换为元胞数组，使用 对元胞数组执行操作`cellfun`，然后将答案转换回矩阵。

```
%# Build random matrix X
T = 12;
N = 3;
X = randi(100, T, N);

%# Set the number of elements in each mean, min, and max calculation
K = 4;

%# Determine the number of groups
L = T / K;
if mod(L, 1) ~= 0; error('Number of rows not integer divisible by number of elements per group'); end

%# Loop based solution
Soln1 = nan(L, N);
for k = 1:K-1
    Soln1(k, :) = mean(X(k * K - K + 1:k * K, :));
end

%# Loop-less solution
CellOfMat = mat2cell(X, K * ones(L, 1), N);
Soln2 = cellfun(@mean, CellOfMat, 'UniformOutput', 0);
Soln2 = cell2mat(Soln2); 
```

我已经完成了`mean`上面示例中的函数的解决方案。替换这些函数后，`max`和的情况就很简单了。`min`

# unit-testing - 使用健身与自动化集成测试的优势是什么？

> ID：14677120
> 
> 赞同：3
> 
> 时间：2013-02-03T20:46:23.180
> 
> 标签：unit-testing, automated-tests, acceptance-testing

使用健身与自动化集成测试的优势是什么？当旨在提供经过全面测试的解决方案时，我正在努力了解 Fitness 的确切位置*。*当然，如果开发人员对他们的代码进行了单元和集成测试，那么这就足够了。为什么团队需要重复集成测试工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:53:09.630

敏捷环境中的测试用例主要有四种类型：

1) 自动化单元测试（例如，使用 J-unit）；

2) 自动特征验证测试（例如，使用 Fitnesse）；

3) 自动化功能/回归测试（例如，使用 Selenium 或 QuickTestPro）；

4) 人工测试。

对于类型 1-3，当然有指定的自动化测试用例。对于类型 4，测试用例往往是逻辑（或高级）测试用例，这需要测试人员具备更高水平的技能和领域知识。此外，往往会发生大量基于经验的测试，例如探索性测试、缺陷分类测试等。

[请参阅此处](http://www.rbcs-us.com/blog/2012/06/08/test-plans-and-test-cases-in-agilescrum/)的 RBCS 博客：

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T20:49:49.487

使用健身的主要原因是如果您要让非技术人员编写测试。例如，假设我们必须支持大量不同的佣金支付方式。非技术人员可以制作电子表格，显示一个花花公子赚取一定数量的面团，询问系统他们应该获得多少佣金，然后断言计算是正确的。

就个人而言，我发现 FIT 带来的麻烦多于其价值。我认为如果制造商认真并制作了一些工具来设置和配置它，它可能是一个非常引人注目的工具。

但主要的是，只有在您确定您将有很多业务规则类型的东西来验证 BA 甚至客户可以直接参与时才使用它。这不是为了断言轨道常数正在被正确计算。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T20:49:05.773

健身应该让业务分析师更容易拥有和运行测试。开发人员创建夹具；业务分析师提供数据并确认测试通过。

以我的经验，业务分析师既没有背景也没有兴趣做这样的事情。

体能测试更像是集成测试。它们可能涉及多个组件。单元测试应该由开发人员对单个组件进行。因此得名“单位”。

我更喜欢单元测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-27T13:24:45.453

这个问题暗示了一种错误的二分法；FitNesse*是*一个自动化的集成测试解决方案。只是测试（打算）被创建为 wiki 页面中的标记。

我目前正在使用它作为我的集成测试解决方案；[我使用命令行](http://www.fitnesse.org/FitNesse.UserGuide.AdministeringFitNesse.ControllingFitNesseFromTheCommandLine)运行所有集成测试。测试也可以通过 JUnit 或 REST API（需要运行 FitNesse 服务器）来运行。

[正如 Rob 在他们的回答中提到](https://stackoverflow.com/a/14677148/173497)的那样，设置和配置并不（非常）容易，但我并没有觉得它太难。我对 Rob 的说法提出异议，即“这不是为了断言轨道常数正在被正确计算。”；事实上，它完全可以用于此目的。

我遇到了这个问题，因为我正在寻找使用或使用过 Fit 或 FitNesse 进行*单元*测试的人的评估。我想到这个想法的原因是，作为一名开发人员，我发现以 FitNesse wiki 页面的形式理解一组测试比理解代码文件要容易得多。

下面是我的一个项目中的测试页示例。这些测试是集成测试，但我想不出为什么这对于单元测试也不起作用。测试代码并没有什么特别之处，它会阻止单元被测试。

![示例 FitNesse 测试页面](../Images/6368aa0b4ffc34288c20abc9e38dba2b.png)

# mysql - 多个数据库条目还是一个带有数组的条目？

> ID：14677121
> 
> 赞同：2
> 
> 时间：2013-02-03T20:46:28.687
> 
> 标签：mysql, arrays

```
 CREATE TABLE IF NOT EXISTS `user_words` (
      `id` int(15) NOT NULL AUTO_INCREMENT,
      `user` int(15) NOT NULL,
      `word` int(15) NOT NULL,
      PRIMARY KEY (`_id`)
    ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS `words` (
      `words_id` int(15) NOT NULL AUTO_INCREMENT,
      `words_word` VARCHAR(15) NOT NULL,
      PRIMARY KEY (`words_id`)
    ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1; 
```

我有上面的表，它当前为每个用户存储单词，所以结果可能是这样的：

```
1 - 1 - 1
1 - 1 - 2
1 - 1 - 3 
```

现在字位链接到字表 word=words_id

我想知道这是最好的方法还是说有

```
CREATE TABLE IF NOT EXISTS `user_words` (
  `id` int(15) NOT NULL AUTO_INCREMENT,
  `user` int(15) NOT NULL,
  `word` TEXT NOT NULL,
  PRIMARY KEY (`_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1;

1 - 1 - 1 2 3 
```

并使用数组在文本字段中获取 3 个结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T12:41:01.470

If you know you only have 3 words, i would just put the word in to the user tables in one or 3 extra fields and not use these tables at all.

If you need to maintain a words table, you should use this connection table that you are using. So the first one is the way to go !

# php - 如何向我的 prestashop 添加新的块框？

> ID：14677125
> 
> 赞同：0
> 
> 时间：2013-02-03T20:46:50.510
> 
> 标签：php, prestashop

我需要添加一个新的块框，在 prestashop 中的“联系人”框上方。它确实需要一些逻辑（数据库），我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:30:19.277

您正在寻找创建一个新模块： [http ://doc.prestashop.com/display/PS15/Creating+a+PrestaShop+module](http://doc.prestashop.com/display/PS15/Creating+a+PrestaShop+module)

# javascript - spin.js 似乎不起作用/出现

> ID：14677127
> 
> 赞同：2
> 
> 时间：2013-02-03T20:47:05.977
> 
> 标签：javascript, jquery, html, css, spin.js

我正在尝试使用 spin.js 库来显示加载动画。但是，离开[spin.js 开发人员示例](http://fgnass.github.com/spin.js/)，我似乎无法让它工作/出现；当我在 Firefox 中打开我的 html 文件时，空的 div 标记很明显。

这是我的代码（spinnertest.html）：

```
<html>
<head>
    <script src="spin.min.js">
        var opts = {
          lines: 13, // The number of lines to draw
          length: 7, // The length of each line
          width: 4, // The line thickness
          radius: 10, // The radius of the inner circle
          corners: 1, // Corner roundness (0..1)
          rotate: 0, // The rotation offset
          color: '#000', // #rgb or #rrggbb
          speed: 1, // Rounds per second
          trail: 60, // Afterglow percentage
          shadow: false, // Whether to render a shadow
          hwaccel: false, // Whether to use hardware acceleration
          className: 'spinner', // The CSS class to assign to the spinner
          zIndex: 2e9, // The z-index (defaults to 2000000000)
          top: 'auto', // Top position relative to parent in px
          left: 'auto' // Left position relative to parent in px
        };
        var target = document.getElementById("spinner");
        var spinner = new Spinner(opts).spin(target);
    </script>
</head>
<body>
    <div id="spinner">
    </div>
</body> 
```

**感兴趣的人的工作代码（需要同一目录中的 jquery-1.9.0.min.js 和 spin.min.js）：**

```
<html>
<head>
    <script type="text/javascript" src="spin.min.js"></script>
    <script type="text/javascript" src="jquery-1.9.0.min.js"></script>
    <script type="text/javascript">
        $(function() {
            var opts = {
              lines: 13, // The number of lines to draw
              length: 7, // The length of each line
              width: 4, // The line thickness
              radius: 10, // The radius of the inner circle
              corners: 1, // Corner roundness (0..1)
              rotate: 0, // The rotation offset
              color: '#000', // #rgb or #rrggbb
              speed: 1, // Rounds per second
              trail: 60, // Afterglow percentage
              shadow: false, // Whether to render a shadow
              hwaccel: false, // Whether to use hardware acceleration
              className: 'spinner', // The CSS class to assign to the spinner
              zIndex: 2e9, // The z-index (defaults to 2000000000)
              top: 'auto', // Top position relative to parent in px
              left: 'auto' // Left position relative to parent in px
            };
            var target = document.getElementById("spinner");
            var spinner = new Spinner(opts).spin(target);
        });
    </script>
</head>
<body>
    <div id="spinner">
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T21:04:40.303

我不相信`script`带有 src 属性的标签内的代码会执行。如果您将代码更改为以下内容，它可以工作吗？

```
<script type="text/javascript" src="spin.min.js"></script>
<script type="text/javascript">
  $(document).ready(function () {
    var opts = ...
    ...
    // all the code that you currently have between <script> and
    // </script> goes here
  });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:49:33.093

您必须将其初始化为 DOM 就绪状态，否则`target`将为`null`. 您还应该将包含脚本放在单独的`script`标记中。

使用 jquery...

```
$(function() {
  var target = document.getElementById("spinner");
  var spinner = new Spinner(opts).spin(target);
}); 
```

# java - 将“2013 年 2 月 1 日星期五”转换为“2013-02-01”

> ID：14677129
> 
> 赞同：5
> 
> 时间：2013-02-03T20:47:29.873
> 
> 标签：java, date, simpledateformat

如何在 Java 中执行此转换？

目前，我正在做：

```
public static String formatDate(String strDateToFormat) {
    try {
        SimpleDateFormat sdfSource = new SimpleDateFormat("EEEE, MMMM DD, YYYY");
        Date date = sdfSource.parse(strDateToFormat);
        SimpleDateFormat sdfDestination = new SimpleDateFormat("yyyy-MM-dd");
        return sdfDestination.format(date);
    } catch (ParseException pe) {
        System.err.println("Parse Exception : " + pe);
    }

    return null;
} 
```

但是，这会导致格式不正确。它给了我以下输出：

```
Friday, February 1, 2013 > 2013-01-04
Thursday, January 31, 2013 > 2013-01-03 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-03T20:48:58.420

您`DD`在解析部分使用，即一年中的某一天。你想要`dd`。您可能还想要`yyyy`(year) 而不是`YYYY`(week year)。（在大多数情况下，它们的值相同，但并非总是如此。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T20:54:34.750

您在解析部分使用 DD，即一年中的某一天。你想要 dd 代替。在 yyyy 中也更改 YYYY。

您可以在此处找到所有模式。

[http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-06-08T17:13:50.420

您的代码有***两个主要问题***，现有答案已经解决了其中一个问题。第二个***甚至更危险***的问题是，不使用`Locale`with `SimpleDateFormat`，这是一种 -`Locale`敏感类型。由于您的日期时间字符串是英文的，请确保使用`Locale.ENGLISH`或其他一些英文- `Locale`。因此，正确的初始化将是：

```
SimpleDateFormat sdfSource = new SimpleDateFormat("EEEE, MMMM d, y", Locale.ENGLISH); 
```

选中[Never use SimpleDateFormat or DateTimeFormatter without a Locale](https://stackoverflow.com/a/65544056/10819573)以了解更多信息。另外，请注意一个单一`d`的，用于解析，可以同时满足月份日期的一位数和两位数表示。同样，一个单一的`y`可以同时满足两位数和四位数的年份表示。

## 切换到现代日期时间 API

请注意，`java.util`日期时间 API 及其格式化 API`SimpleDateFormat`已过时且容易出错。建议完全停止使用它们并切换到2014 年 3 月随 Java SE 8 发布的[现代日期时间 API](https://www.oracle.com/technical-resources/articles/java/jf14-Date-Time.html) ^(* 。)

## 使用`java.time`现代日期时间 API 的解决方案

```
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.Locale;

public class Main {
    public static void main(String[] args) {
        String input = "Friday, February 1, 2013";
        DateTimeFormatter dtf = DateTimeFormatter.ofPattern("EEEE, MMMM d, u", Locale.ENGLISH);
        LocalDate date = LocalDate.parse(input, dtf);
        System.out.println(date);
    }
} 
```

**输出：**

```
2013-02-01 
```

[`ONLINE DEMO`](https://ideone.com/1gVJPq)

**一些注意事项：**

1.  在这里，您可以使用`y`代替，`u`但[我更喜欢`u`使用`y`](https://stackoverflow.com/a/65928023/10819573).
2.  为[`LocalDate#toString`](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html#toString--)您提供`String`[ISO-8601 格式]，这与您所期望的格式完全相同。因此，您无需`LocalDate`显式格式化即可获得`String`此格式的 a。

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关现代日期时间 API 的更多信息。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，您可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和您的 Android API 工作level 仍然不符合 Java-8，请[通过 deugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)检查 Java 8+ APIs 。)

# c++ - 这里到底发生了什么？

> ID：14677133
> 
> 赞同：0
> 
> 时间：2013-02-03T20:48:18.277
> 
> 标签：c++, bit-manipulation, bitwise-operators, bitwise-and

```
for (int i = 7; i >= 0;i--) {
    cout << ((c >> i) & 1); 
```

这需要一个 char, c 并打印出它的二进制文件。这是如何工作的，特别是第二行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:51:02.123

它分别取位置 7 到 0 的位，即从左到右的位，并为每个位写出 1 或 0。`& 1`用于在将第 i 位右移后隔离它`i`。

例子：

给定 char 'A'，等价于`0x41`或`01000001`二进制：

```
010000001 >> 7 ==> 0  ==> & 1 ==> 0
010000001 >> 6 ==> 01  ==> & 1 ==> 1
010000001 >> 5 ==> 010  ==> & 1 ==> 0
010000001 >> 4 ==> 0100  ==> & 1 ==> 0
010000001 >> 3 ==> 01000  ==> & 1 ==> 0
010000001 >> 2 ==> 010000  ==> & 1 ==> 0
010000001 >> 1 ==> 0100000  ==> & 1 ==> 0
010000001 >> 0 ==> 01000001  ==> & 1 ==> 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:51:58.513

它正在将下一位从 char c 向右移动。如果设置了该位，则与 1 的 AND 将返回结果 1，否则返回 0。

# javascript - 无法在动态插入的内容中单击

> ID：14677134
> 
> 赞同：0
> 
> 时间：2013-02-03T20:48:25.530
> 
> 标签：javascript, google-maps-api-3

我有一个动态插入谷歌地图的表格。但是我无法单击任何输入。我相信我需要在某处添加一个听众，但我不确定。

[小提琴](http://jsfiddle.net/duEEt/1/)

```
 function googlemap() {

    // google map coordinates
    var posY = 37.765700,
        posX = -122.449134,
        location = new google.maps.LatLng(posY,posX),

        // offset location
        posY = posY + 0.055;
        offsetlocation = new google.maps.LatLng(posY,posX);

    var mapOptions = {
        panControl: false,
        zoomControl: false,
        mapTypeControl: false,
        scaleControl: false,
        streetViewControl: false,
        overviewMapControl: false,
        draggable: true,
        disableDoubleClickZoom: false,
        scrollwheel: false,
        zoom: 12,
        center: offsetlocation,
        // ROADMAP; SATELLITE; HYBRID; TERRAIN;
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    overlay.prototype = new google.maps.OverlayView();

    // create overlay marker
    overlay.prototype.onAdd = function() {

        blip = document.createElement('div'),
        pulse = document.createElement('div');
        blip.className = 'blip';
        pulse.className = 'pulse';

        // createa dialog and grab contents from #mapcontents
        boxText = document.createElement("div");
        boxText.className = "dialog";
        mapContents = $('#mapcontents').html();
        boxText.innerHTML = mapContents;
        $('#mapcontents').remove();
        blip.appendChild(boxText);

        // append 'blip' marker
        this.getPanes().overlayLayer.appendChild(blip).appendChild(pulse);
    }

    // update blip positioning when zoomed
    overlay.prototype.draw = function(){

        var overlayProjection = this.getProjection(),
            bounds = new google.maps.LatLngBounds(location, location),
            sw = overlayProjection.fromLatLngToDivPixel(bounds.getSouthWest()),
            ne = overlayProjection.fromLatLngToDivPixel(bounds.getNorthEast());

        blip.style.left = sw.x + 'px';
        blip.style.top = ne.y + 'px';

        // shift nav into view by resizing header
        var w = $('.dialog').width(),
            w = (w / 2) + 25,
            w = '-' + w + 'px';

            h = $('.dialog').height(),
            h = (h) + 100,
            h = '-' + h + 'px';

        $('.dialog').css({
            'margin-top' : h,
            'margin-left' : w
        });

    };

    var map = new google.maps.Map(document.getElementsByClassName('map')[0], mapOptions);

    // explicitly call setMap on this overlay
    function overlay(map) {
        this.setMap(map);
    }

    // center map when window resizes
    google.maps.event.addDomListener(window, 'resize', function() { map.setCenter(location) });

    // center map when zoomed
    google.maps.event.addListener(map, 'zoom_changed', function() { map.setCenter(location) });

    // I have nfi what I'm doing but I think this click listener is part of the solution.
    google.maps.event.addListener('.dialog', 'click', function() {

        alert('ok');
    });

    // process contact form
    google.maps.event.addListener(map, 'domready', function() {

        $('button').click(function(e) {
            (e).preventDefault();

            alert('ok');

            return false;

            var name    = $(".contactform input[name='name']"),
                email   = $(".contactform input[name='email']"),
                message = $(".contactform textarea[name='message']"),
                error = false;

            // clear validation errors
            $('#contact input, #contact textarea').removeClass('error');

            if(name.val().length < 1)
                name.addClass("error");

            if(!/^[a-zA-Z0-9._+-]+@[a-zA-Z0-9-]+\.[a-zA-Z]{2,4}(\.[a-zA-Z]{2,3})?(\.[a-zA-Z]{2,3})?$/.test(email.val()))
                email.addClass("error");

            if(message.val().length < 1)
                message.addClass("error");

            // if error class exists
            if($(".error").length) return false;

            $(this).attr('disabled', true).prepend('<i class="load animate-spin"></i>');

            $.ajax({
                type: "post",
                dataType: "json",
                url: "lib/sendmail.php",
                data: $("#contactform").serialize()
            })
            .always(function(data) {

                $('h5').animate({opacity:0},function(){
                        $('h5').text("Email Sent!!")
                    .animate({opacity:1});
                });

                $('.contactform').animate({opacity:0},function(){
                        $('.contactform').html("<p class='success'>Thank You for your form submission. We will respond as soon as possible.</p>")
                    .animate({opacity:1});
                })

            });

        });

        return false;
    });

    // add overlay
    overlay = new overlay(map);
} 
```

知道为什么我不能点击输入吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:44:05.563

您只需要阻止`mousedown`地图事件的传播即可使输入可点击：

```
google.maps.event.addDomListener(blip, 'mousedown', function (e) {
    e.cancelBubble = true;
    if(e.stopPropogation) {
        e.stopPropagation();
    }
}); 
```

你可以做同样的事情`dbclick`来防止地图缩放：http: [//jsfiddle.net/gfKWz/1/](http://jsfiddle.net/gfKWz/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:03:57.160

所有这些输入的点击事件都很好，首先这里的问题是你的代码永远不会执行，因为没有`domready`-event`google.maps.Map`

改变这个：

```
google.maps.event.addListener(map, 'domready', function () { 
```

进入这个：

```
google.maps.event.addListenerOnce(map, 'tilesloaded', function () { 
```

用于观察您可能使用的事件`$.on()`，例如：

```
$(map.getDiv()).on('click','button',function (e) {/*some code*/}); 
```

演示：http: [**//jsfiddle.net/doktormolle/jcfDu/**](http://jsfiddle.net/doktormolle/jcfDu/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T20:58:49.280

您的事件必须添加到`onAdd`函数中。

目前，事件处理程序是在元素之前创建的。所以它不会捕捉到对这个特定元素的点击。

[http://jsfiddle.net/NeekGerd/duEEt/4/](http://jsfiddle.net/NeekGerd/duEEt/4/)

或者您可以为覆盖的绑定创建一个新函数，只是为了干净代码：

```
overlay.prototype.onAdd = function() {

    [...]

    this.bindings();
}

overlay.prototype.bindings = function(){
   $("button").on("click",function(){
     alert("Click");
     return false;
   }
} 
```

现在我对你的输入问题没有真正的解决方案。也许通过将`mousedown`事件重新附加到它们，并强制它们`focus()`：

```
$("input,textarea").on("mousedown",function(){$(this).focus();}); 
```

与您的复选框相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T21:27:47.563

您使用`$('button').click`which 在按钮出现在 dom 之前触发。`.click()`将处理程序绑定到 dom 上的所有当前元素。

更好地使用`$('button').on('click', function(){});`它将单击事件处理程序绑定到页面上所有当前*和将来*的按钮实例。如果您在页面上动态添加内容，这将特别方便。通过ajax或其他方式。

[在此处http://api.jquery.com/on/](http://api.jquery.com/on/)阅读有关 jQuery .on() 的更多信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-03T21:51:44.160

另一方面，既然您使用 jQuery，为什么不一直使用它呢？

就像你可以这样做：

```
$('#mapcontents')
    .clone()
    .wrap('<div class="dialog" />')
    .wrap('<div class="blip />')
    .appendTo( *selector* ); 
```

为了快速构建一些 html 并将其附加到所选元素。比您获得的 DOM 代码更具可读性（因此更易于维护）。因为无论如何你已经使用了 jQuery。

# vb.net - 初始化多个变量并赋值给vb.net

> ID：14677155
> 
> 赞同：3
> 
> 时间：2013-02-03T20:50:11.760
> 
> 标签：vb.net, visual-studio-2010, variables

在 vb.net 中有执行此操作的选项

```
Dim a, b, c As Single, x, y As Double, i As Integer 
```

你也可以

```
Dim myString = String.empty 
```

有没有办法像第一个示例一样初始化和分配多个变量，但将分配用作第二个示例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T21:06:14.740

我在 VS 2008 中对其进行了测试，但我认为 Dim 语句的语法从那以后没有改变。如果初始化它们，则必须为每个变量指定类型

```
Dim a As Single = 1, b As Single = 2, x As Double = 5.5, y As Double = 7.5 
```

或者您可以让 VB 推断类型并使用类型字符（此处`!`为`Single`）：

```
Dim a = 1!, b = 2!, c = 3!, x = 5.5, y = 7.5, i = 100 
```

通过将光标悬停在 VS 中的变量上，您将看到类型被正确推断为`Single`、`Double`和`Integer`。您也可以`F`用于单身。请参阅：[常量和文字数据类型 (Visual Basic)](http://msdn.microsoft.com/en-us/library/dzy06xhf%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-13T04:38:10.970

我刚刚在一行中检查了此代码中的多个控件声明。编译成功，窗口出现。这是一个非常大的项目的一部分。** `Dim DllNumber As New TextBox,DllMethod As New TextBox,LoopBox As New TextBox` ** kvinvisibleguy

# git - git本地存储库目录结构的约定是什么

> ID：14677158
> 
> 赞同：1
> 
> 时间：2013-02-03T20:50:17.077
> 
> 标签：git

这是我的git目录结构

```
~/git/ProjectA/.git
~/git/ProjectA/ProjectA
~/git/ProjectB/.git
~/git/ProjectB/ProjectB 
```

这是约定还是做类似的事情更可取？

```
~/git/myRepo/.git
~/git/myRepo/ProjectA
~/git/myRepo/ProjectB 
```

或者

```
~/git/.git
~/git/ProjectA
~/git/ProjectB 
```

还是完全不同的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:54:05.597

本身没有约定，但有理由使用版本控制一次对单个项目进行版本控制，除非它们是更大项目的子项目。

也就是说，您现在的操作方式符合每个 repo 一个项目的“约定”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:54:18.027

简单的答案：取决于您是否要使用子模块。如果你这样做了，那么子目录将包含你必须进入和推拉的完整项目。

如果你的父项目有一堆依赖的子项目，例如一个核心项目有你的领域类，然后是一个构建所有组件的 ui 项目，等等，然后把这些东西放到子目录中。它们仍然可以是单独的项目。

如果您有现有项目并希望将它们合并到一个项目中，请参阅我前段时间提出的这个问题（得到了一些非常好的回应）：[如何将 Git 项目迁移为一个带有子项目的项目](https://stackoverflow.com/questions/6118261/how-to-migrate-git-projects-to-be-one-project-with-subprojects)

# ruby-on-rails - 对 ajax GET 的响应中的 JRuby/tomcat 404 错误

> ID：14677162
> 
> 赞同：0
> 
> 时间：2013-02-03T20:50:28.940
> 
> 标签：ruby-on-rails, tomcat, jruby

此问题似乎特定于 JRuby ajax 请求的路由。我的页面发送了一个在 rails 开发模式下运行良好的 ajax GET。通过 warbler 移动到 tomcat 时，**请求正确生成**，但 tomcat 响应 404 错误。

换句话说，routes.rb`get '/sector/method'`中的行足以`http://localhost:3000/sector/method`由 Webrick 处理，但如果我将端口更改为 8080 (tomcat)，我会得到一个`HTTP status 404 The requested resource (/sector/method) is not available`.

显然，需要告诉 tomcat 处理 GET 是可以的，即使没有找到相应的文件。正确的？修复？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:08:22.693

您确定您的请求指向正确的地址吗？如果应用程序正常工作，那么 GETs 不可能不工作。请尝试将请求直接放入浏览器并检查...

# php - 如何将可扩展的长轮询服务器与 PHP 集成？

> ID：14677174
> 
> 赞同：1
> 
> 时间：2013-02-03T20:52:07.873
> 
> 标签：php, python, apache, comet, long-polling

可以这么说，我被“招募”来帮助处理当前使用 PHP 和 Apache 服务器编写的 Web 项目。我们想集成一个实时（或至少非常接近它的）聊天功能。可扩展性是一个明确的问题，这种类型的工作绝对不是我的典型。

我所读到的关于创建这样一个聊天功能的所有内容都需要使用“长轮询”，这样服务器就不会迅速超载，甚至崩溃。PHP 和 Apache 不利于实现这样的功能，所以我探索了一些替代方案，例如 Twisted Python。

该网站大约有大约 7,000 行 PHP（即，很难直接为整个事情切换语言），所以我的问题是，在尝试集成 python 并设置一个单独的服务器？或者，这是一种非常糟糕的方法吗？还有其他更适合的选择吗？（遗憾的是，我发现的许多 PHP Comet 甚至 AJAX 解决方案都无法扩展。注意，不一定需要 Apache 服务器；但是，使用的任何服务器都必须与 PHP 和 Python 等一起使用，缺少有单独的服务器。）

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:00:05.357

我会在服务器上使用 Tornado 来编写聊天应用程序。客户端服务器通信然后可以通过 websockets。如果您在客户端使用 SockJS，您还可以通过长轮询支持较旧的浏览器。有很多使用 Tornado 编写的聊天客户端示例。上手非常简单，并且具有极好的可扩展性。像这样的聊天服务器可以为数千个客户端提供服务，而不会显示任何明显的 CPU 活动。

这是一个例子，可能有点过度设计[https://github.com/diggidanne/websocket-chat/blob/master/server.py](https://github.com/diggidanne/websocket-chat/blob/master/server.py)

# jquery - 选中/取消选中复选框

> ID：14677176
> 
> 赞同：1
> 
> 时间：2013-02-03T20:52:14.940
> 
> 标签：jquery

我试图这样做一个小时，我尝试了各种例子，但反应都一样：

```
$('body').append('<div id="allchecks">checkBoxes:<br />');
$('#allchecks').append('<input id="mcheck" type="checkbox"/>mainCheck<hr />');

for (var i = 0; i < 9; i++) {
    $('#allchecks').append('<input class="regCheck" type="checkbox" />regularCheck<br />');
}
$('#allchecks').append('</div>');

$('#mcheck').click(function () {
    if ($('#mcheck').is(':checked')) {
        $('.regCheck').attr('checked', 'checked');
    } else {
        $('.regCheck').removeAttr('checked');
    }
}); 
```

前 2 次尝试有效，但第二次尝试后无效。如果我在 2 次尝试后查看源代码，则会出现“ attr('checked', 'checked') ”并且还会出现“ removeAttr('checked') ”。

但不是视觉的。

有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:53:41.250

您应该使用[`.prop()`](http://api.jquery.com/prop/)布尔值：

```
$('#mcheck').click(function () {
    if ($('#mcheck').is(':checked')) {
        $('.regCheck').prop('checked', true);
    } else {
        $('.regCheck').prop('checked', false);
    }
}); 
```

* * *

这是同一件事的一个更短的版本：

```
$('#mcheck').click(function () {
    $('.regCheck').prop('checked', this.checked);
}); 
```

* * *

**PS**请学会[缓存你的元素](http://www.stoimen.com/blog/2010/06/19/speed-up-the-jquery-code-selectors-cache/)，而不是不断地遍历 DOM。此外，您可能想要使用`change`事件，而不是`click`.

# jquery - 使用 javascript 更改默认边框后焦点不起作用

> ID：14677187
> 
> 赞同：1
> 
> 时间：2013-02-03T20:53:49.570
> 
> 标签：jquery, css, focus

基本上我有一个表格。在表单上方，我有一个链接到表单的链接。当有人单击锚点时，它会更改表单输入的 css 以使其具有红色边框。我还设置了一个计时器以在几秒钟后恢复原始边框颜色。问题是，在所有这些过程发生之后，当有人单击输入时， :focus 不再起作用。（ :focus 用于使边框颜色变深）。顺便说一句，我正在使用 jQuery。

我怎样才能避免这种情况发生？我希望 :focus 即使在应用锚后也能正常发生。这是小提琴链接[http://jsfiddle.net/LSpm8/](http://jsfiddle.net/LSpm8/)这是代码：

**JS**

```
$("#anchor").click(
    function () {
        clearTimeout($.data(this, 'timer'));
        $("#form input").css({
            'border': '1px solid red'
        });
        $.data(this, 'timer', setTimeout($.proxy(function() {
            $("#form input").css({
                'border': '1px solid #CCC'
            });
        }, this), 1800));
    }
); 
```

**CSS**

```
input { border: 1px solid #CCC; }
input:focus { border: 1px solid #000; } 
```

**HTML**

```
<a href="#form" id="anchor">Link</a>
<form id="form">
    <input type="text" />
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:57:31.230

当 jquery 应用一种样式时，它是内联插入的。从本质上防止任何样式表影响元素。尝试清除边界`border: ''`。

[http://jsfiddle.net/LSpm8/1/](http://jsfiddle.net/LSpm8/1/)

```
$("#anchor").click(
    function () {
        clearTimeout($.data(this, 'timer'));
        $("#form input").css({
            'border': '1px solid red'
        });
        $.data(this, 'timer', setTimeout($.proxy(function() {
            $("#form input").css({
                'border': ''
            });
        }, this), 1800));
    }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:01:52.217

如果您像这样使用**!important**它应该可以解决您的问题：

```
input:focus { border: 1px solid #000!important; } 
```

这将防止 jQuery 内联过度编写它。这是它的一个小提琴 - [http://jsfiddle.net/yasEB/](http://jsfiddle.net/yasEB/)

# clojure - 如何在 clojure 中需要许多子命名空间？

> ID：14677188
> 
> 赞同：8
> 
> 时间：2013-02-03T20:53:50.690
> 
> 标签：clojure, namespaces

我的命名空间目前开始：

```
(ns web.site
  (:require ring.adapter.jetty)

  (:require ring.middleware.reload)
  (:require ring.middleware.stacktrace)
  (:require ring.middleware.params)
  (:require ring.middleware.keyword-params)
  (:require ring.middleware.nested-params)
  (:require ring.middleware.multipart-params)
  (:require ring.middleware.cookies)
  (:require ring.middleware.session)
  (:require ring.middleware.session.cookie)
  (:require ring.middleware.flash)
  (:require ring.middleware.resource)
  (:require ring.middleware.file-info)) 
```

这里显然存在一定的冗余。如何删除它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-03T20:58:33.163

尝试

```
(:require [ring.middleware reload stacktrace params keyword-params]) 
```

# python - 在 C 中嵌入 Python：尝试在 Python 代码调用的 C 回调中调用 Python 代码时出错

> ID：14677190
> 
> 赞同：6
> 
> 时间：2013-02-03T20:53:56.460
> 
> 标签：python, c, python-2.7

我有一些调用 Python 函数的 C 代码。这个 Python 函数接受一个地址并使用 WINFUNCTYPE 最终将其转换为 Python 可以调用的函数。作为参数发送给 Python 函数的 C 函数最终将调用另一个 Python 函数。正是在这最后一步导致崩溃。所以简而言之，我从 C -> Python -> C -> Python 开始。最后一个 C -> Python 导致崩溃。我一直试图理解这个问题，但我一直无法理解。

有人可以指出我的问题吗？

使用 Visual Studio 2010 编译并使用参数“c:\...\crash.py”和“func1”运行的 C 代码：

```
#include <stdlib.h>
#include <stdio.h>

#include <Python.h>

PyObject* py_lib_mod_dict; //borrowed

void __stdcall cfunc1()
{
    PyObject* py_func;
    PyObject* py_ret;
    int size;
    PyGILState_STATE gil_state;

    gil_state = PyGILState_Ensure();
    printf("Hello from cfunc1!\n");

    size = PyDict_Size(py_lib_mod_dict);
    printf("The dictionary has %d items!\n", size);
    printf("Calling with GetItemString\n");
    py_func = PyDict_GetItemString(py_lib_mod_dict, "func2"); //fails here when cfunc1 is called via callback... will not even go to the next line!
    printf("Done with GetItemString\n");
    py_ret = PyObject_CallFunction(py_func, 0);

    if (py_ret)
    {
        printf("PyObject_CallFunction from cfunc1 was successful!\n");
        Py_DECREF(py_ret);
    }
    else
        printf("PyObject_CallFunction from cfunc1 failed!\n");

    printf("Goodbye from cfunc1!\n");
    PyGILState_Release(gil_state);
}

int wmain(int argc, wchar_t** argv)
{
    PyObject* py_imp_str;
    PyObject* py_imp_handle;
    PyObject* py_imp_dict; //borrowed
    PyObject* py_imp_load_source; //borrowed
    PyObject* py_dir; //stolen
    PyObject* py_lib_name; //stolen
    PyObject* py_args_tuple;
    PyObject* py_lib_mod;
    PyObject* py_func;
    PyObject* py_ret;

    Py_Initialize();

    //import our python script
    py_dir = PyUnicode_FromWideChar(argv[1], wcslen(argv[1]));
    py_imp_str = PyString_FromString("imp");
    py_imp_handle = PyImport_Import(py_imp_str);
    py_imp_dict = PyModule_GetDict(py_imp_handle); //borrowed
    py_imp_load_source = PyDict_GetItemString(py_imp_dict, "load_source"); //borrowed
    py_lib_name = PyUnicode_FromWideChar(argv[2], wcslen(argv[2]));

    py_args_tuple = PyTuple_New(2);
    PyTuple_SetItem(py_args_tuple, 0, py_lib_name); //stolen
    PyTuple_SetItem(py_args_tuple, 1, py_dir); //stolen

    py_lib_mod = PyObject_CallObject(py_imp_load_source, py_args_tuple);
    py_lib_mod_dict = PyModule_GetDict(py_lib_mod); //borrowed

    printf("Calling cfunc1 from main!\n");
    cfunc1();

    py_func = PyDict_GetItem(py_lib_mod_dict, py_lib_name);
    py_ret = PyObject_CallFunction(py_func, "(I)", &cfunc1);

    if (py_ret)
    {
        printf("PyObject_CallFunction from wmain was successful!\n");
        Py_DECREF(py_ret);
    }
    else
        printf("PyObject_CallFunction from wmain failed!\n");

    Py_DECREF(py_imp_str);
    Py_DECREF(py_imp_handle);
    Py_DECREF(py_args_tuple);
    Py_DECREF(py_lib_mod);

    Py_Finalize();

    fflush(stderr);
    fflush(stdout);
    return 0;
} 
```

Python代码：

```
from ctypes import *

def func1(cb):
    print "Hello from func1!"
    cb_proto = WINFUNCTYPE(None)
    print "C callback: " + hex(cb)
    call_me = cb_proto(cb)
    print "Calling callback from func1."
    call_me()
    print "Goodbye from func1!"

def func2():
    print "Hello and goodbye from func2!" 
```

输出：

```
Calling cfunc1 from main!
Hello from cfunc1!
The dictionary has 88 items!
Calling with GetItemString
Done with GetItemString
Hello and goodbye from func2!
PyObject_CallFunction from cfunc1 was successful!
Goodbye from cfunc1!
Hello from func1!
C callback: 0x1051000
Calling callback from func1.
Hello from cfunc1!
The dictionary has 88 items!
Calling with GetItemString
PyObject_CallFunction from wmain failed! 
```

我在末尾添加了 PyErr_Print() ，结果如下：

```
Traceback (most recent call last):
  File "C:\Programming\crash.py", line 9, in func1
    call_me()
WindowsError: exception: access violation writing 0x0000000C 
```

编辑：修复了 abarnert 指出的错误。输出不受影响。
编辑：在解决错误的代码中添加（在 cfunc1 中获取 GIL 锁）。再次感谢阿巴纳特。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T23:39:08.170

问题是这段代码：

```
py_func = PyDict_GetItemString(py_lib_mod_dict, "func2"); //fails here when cfunc1 is called via callback... will not even go to the next line!
printf("Done with GetItemString\n");
py_ret = PyObject_CallFunction(py_func, 0);

Py_DECREF(py_func); 
```

正如[文档](http://docs.python.org/2/c-api/dict.html#PyDict_GetItemString)所说，`PyDict_GetItemString`返回一个借来的参考。所以，你第一次在这里调用时，你借用了引用，然后去引用它，导致它被销毁。下次你打电话时，你会得到垃圾，并尝试调用它。

因此，要修复它，只需删除`Py_DECREF(py_func)`（或在行`Py_INCREF(py_func)`后添加`pyfunc =`）。

实际上，你通常会得到一个特殊的“死”对象，所以你可以很容易地测试它：在行之后和行之后`PyObject_Print(py_func, stdout)`，你可能会看到第一次、第二次和第三次（你不会看到第四个，因为它会在你到达那里之前崩溃）。`py_func =``Py_DECREF``<function func2 at 0x10b9f1230>``<refcnt 0 at 0x10b9f1230>`

我没有方便的 Windows 框，但是将`wmain`, `wchar_t`, `PyUnicode_FromWideChar`,`WINFUNCTYPE`等更改为`main`, `char`, `PyString_FromString`,`CFUNCTYPE`等，我能够构建和运行您的代码，但我在同一个地方崩溃了......并且修复工作.

还有……你不应该把 GIL 放在里面`cfunc1`吗？我不经常写这样的代码，所以也许我错了。而且我不会因为代码原样而崩溃。显然，产生一个线程来运行`cfunc1` *确实会*崩溃，并且`PyGILState_Ensure`/`Release`解决了该崩溃……但这并不能证明您在单线程情况下需要任何东西。所以也许这无关紧要……但如果你在修复第一个崩溃后再次崩溃（在线程情况下，我的看起来像`Fatal Python error: PyEval_SaveThread: NULL tstate`），请调查一下。

顺便说一句，如果您是 Python 扩展和嵌入的新手：大量无法解释的崩溃，就像这个一样，是由手动引用计数错误引起的。这就是诸如`boost::python`等之类的东西存在的原因。并不是说用普通的 C API 就不可能把它弄好，只是它很容易出错，而且你必须习惯于调试这样的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T01:58:21.187

abarnert 的回答提供了正确的调用函数，但解释让我感到困扰，所以我早早回家并四处寻找。

在开始解释之前，我想提一下，当我说 GIL 时，我严格指的是互斥锁、信号量或 Global Interpreter Lock 用来进行线程同步的任何东西。这不包括 Python 在获取和释放 GIL 之前/之后所做的任何其他内务处理。

单线程程序不会初始化 GIL，因为您从不调用 PyEval_InitThreads()。因此没有 GIL。即使发生了锁定，也没关系，因为它是单线程的。但是，获取和释放 GIL 的函数除了获取/释放 GIL 之外，还会做一些有趣的事情，比如弄乱线程状态。关于 WINFUNCTYPE 对象的文档明确指出它在跳转到 C 之前释放 GIL。因此，当在 Python 中调用 C 回调时，我怀疑调用了 PyEval_SaveThread() 之类的东西（可能是错误的，因为它只是假设在线程中调用至少根据我的理解操作）。这将释放 GIL（如果存在）并将线程状态设置为 NULL，但是在单线程 Python 程序中没有 GIL，因此，它真正所做的只是将线程状态设置为 NULL。这会导致 C 回调中的大多数 Python 函数严重失败。

真正调用 PyGILState_Ensure/Release 的唯一好处是告诉 Python 在运行和执行操作之前将线程状态设置为有效的状态。没有要获取的 GIL（未初始化，因为我从未调用 PyEval_InitThreads()）。

测试我的理论：在主函数中，我使用 PyThreadState_Swap(NULL) 来获取线程状态对象的副本。我在回调期间恢复它，一切正常。如果我将线程状态保持为 null，即使没有执行 Python -> C 回调，我也会遇到几乎相同的访问冲突。在 cfunc1 内部，我恢复了线程状态，并且在 Python -> C 回调期间 cfunc1 本身不再有问题。

当 cfunc1 返回 Python 代码时会出现问题，但这可能是因为我弄乱了线程状态，而 WINFUNCTYPE 对象期待完全不同的东西。如果您在返回时保持线程状态而不将其设置回 null，则 Python 只会坐在那里，什么也不做。如果将其恢复为 null，它会崩溃。但是，它确实成功执行了 cfunc1，所以我不确定我是否太在意。

我最终可能会在 Python 源代码中四处寻找以 100% 确定，但我确信足以满足。

# jpa - 玻璃鱼@PersistenceContext

> ID：14677192
> 
> 赞同：1
> 
> 时间：2013-02-03T20:54:05.830
> 
> 标签：jpa, glassfish, eclipselink

我使用 Eclipse 在我的 JSF 项目中有 ollowing persistence.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="EnglishOnline" transaction-type="JTA">
        <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
        <class>org.englishonline.persistence.User</class>
        <properties>
            <property name="eclipselink.ddl-generation" value="create-tables" />
            <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/englishonline" />
            <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver" />
            <property name="javax.persistence.jdbc.user" value="root" />
            <property name="javax.persistence.jdbc.password" value="porcelainbus" />
        </properties>
    </persistence-unit>
</persistence> 
```

同时我有以下Backing bean：

```
import java.util.Date;

import org.englishonline.persistence.*;
import javax.faces.bean.*;
import javax.persistence.*;

@ManagedBean
@RequestScoped
public class Login {    

    @PersistenceContext(unitName="EnglishOnline")
    private EntityManager em;
    private String login = null;
    private String password = null;

    public String getLogin() {
        return login;
    }
    public void setLogin(String login) {
        this.login = login;
    }
    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }

    public String performLogin() {
        if (login.equals(password)) {

            EntityTransaction tx = em.getTransaction();
            User user = new User();
            user.setBirthdate(new Date());
            user.setLogin(login);
            user.setPassword(password);
            user.setName("Bobby");
            user.setRegistrationdate(new Date());
            user.setSex(Sex.MALE);
            tx.begin();
            em.persist(user);
            tx.commit();

            return null;            
        } else {
            return null;
        }

    }

} 
```

但是当我尝试在我的应用程序中提交按钮时，服务器日志给出了这个：

```
 WARNING: RAR5117 : Failed to obtain/create connection from connection pool [ DerbyPool ]. Reason : com.sun.appserv.connectors.internal.api.PoolingException: Connection could not be allocated because: java.net.ConnectException : Connection to localhost port 1527  Connection refused: connect.
    WARNING: RAR5114 : Error allocating connection : [Error in allocating a connection. Cause: Connection could not be allocated because: java.net.ConnectException : Connection refused: connect.]
    SEVERE: Local Exception Stack: 
    Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.0.v20110604-r9504): org.eclipse.persistence.exceptions.DatabaseException
    Internal Exception: java.sql.SQLException: Error in allocating a connection. Cause: Connection could not be allocated because: java.net.ConnectException : Connection refused: connect.
    Error Code: 0
        at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:309)
        at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:135)
        at org.eclipse.persistence.sessions.DatasourceLogin.connectToDatasource(DatasourceLogin.java:162)
        at org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.loginAndDetectDatasource(DatabaseSessionImpl.java:582)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryProvider.login(EntityManagerFactoryProvider.java:206)
        at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:472)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryDelegate.getDatabaseSession(EntityManagerFactoryDelegate.java:188)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryDelegate.createEntityManagerImpl(EntityManagerFactoryDelegate.java:277)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManagerImpl(EntityManagerFactoryImpl.java:290)
        at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:275)
        at com.sun.enterprise.container.common.impl.EntityManagerWrapper._getDelegate(EntityManagerWrapper.java:218)
        at com.sun.enterprise.container.common.impl.EntityManagerWrapper.getTransaction(EntityManagerWrapper.java:857)
        at org.englishonline.backing.Login.performLogin(Login.java:34)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at com.sun.el.parser.AstValue.invoke(AstValue.java:234)
        at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:297)
        at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
        at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
        at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
        at javax.faces.component.UICommand.broadcast(UICommand.java:315)
        at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
        at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
        at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
        at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
        at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
        at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
        at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)
        at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)
        at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:330)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
        at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:174)
        at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:828)
        at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:725)
        at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1019)
        at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
        at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
        at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
        at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
        at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
        at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
        at java.lang.Thread.run(Thread.java:662)
    Caused by: java.sql.SQLException: Error in allocating a connection. Cause: Connection could not be allocated because: java.net.ConnectException : Ошибка соединения с сервером localhost на порту 1527 с сообщением Connection refused: connect.
        at com.sun.gjc.spi.base.DataSource.getConnection(DataSource.java:151)
        at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:132)
        ... 52 more
    Caused by: javax.resource.spi.ResourceAllocationException: Error in allocating a connection. Cause: Connection could not be allocated because: java.net.ConnectException : Ошибка соединения с сервером localhost на порту 1527 с сообщением Connection refused: connect.
        at com.sun.enterprise.connectors.ConnectionManagerImpl.internalGetConnection(ConnectionManagerImpl.java:307)
        at com.sun.enterprise.connectors.ConnectionManagerImpl.allocateConnection(ConnectionManagerImpl.java:190)
        at com.sun.enterprise.connectors.ConnectionManagerImpl.allocateConnection(ConnectionManagerImpl.java:165)
        at com.sun.enterprise.connectors.ConnectionManagerImpl.allocateConnection(ConnectionManagerImpl.java:160)
        at com.sun.gjc.spi.base.DataSource.getConnection(DataSource.java:145)
        ... 53 more 
```

JPA 提供者什么也不做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T13:47:11.783

您将事务类型指定为需要 JTA 数据源的 JTA。如果您希望指定 jdbc.url 并直接控制事务而不是使用 JTA，您将需要使用“resource_local”。

# c++ - 使用 strcat 的堆损坏

> ID：14677195
> 
> 赞同：2
> 
> 时间：2013-02-03T20:54:10.253
> 
> 标签：c++

我的弱点之一是在 C++ 中有效地使用字符，这是我现在正在尝试做的。我的游戏中有一个玩家类，在玩家类中，我创建了一个显示各种信息的 playerCard 对象。这适用于播放器对象的单个实例（即播放器播放器），但是当我尝试将播放器对象推回向量时，一切都会出错。

基本上，程序会继续运行，但播放器不会渲染到屏幕上。当我退出程序时，当 main 尝试返回 MSG 时出现断点错误。关于断点的评论如下：

```
 /*
     * If this ASSERT fails, a bad pointer has been passed in. It may be
     * totally bogus, or it may have been allocated from another heap.
     * The pointer MUST come from the 'local' heap.
     */
    _ASSERTE(_CrtIsValidHeapPointer(pUserData)); 
```

我已将错误定位到此处

```
 strcat(nameCard, nameChar);
    strcat(nameCard, genderChar);
    strcat(nameCard, ageChar);
    strcat(nameCard, cashHeldChar);
    strcat(nameCard, productWantedChar); 
```

在 playerCard 类中，因为当我将其注释掉时，我没有收到错误消息。这是完整的 playerCard 类（同样，它很混乱，可能是错误的处理方式，但我正在尝试使用字符/字符串等来解决问题）#include "Headers.h";

```
class Playercard{

private:

    RECT textbox;
    LPD3DXFONT font;

    std::string nameStr;
    std::string genderStr;
    std::string ageStr;
    std::string cashHeldStr;
    std::string prodWantedStr;

    char nameCard[1000];

public:

    Playercard()
    {
    }

    void load(char* name, bool male, int age, double cash, char* prod)
    {

        if(male)
        {
            genderStr = "Gender: Male\n";
        }
        else
        {
            genderStr = "Gender: Female\n";
        }

        nameStr = "Name: " + static_cast<std::ostringstream*>( &(std::ostringstream() << name))->str() + "\n";
        ageStr = "Age: " + static_cast<std::ostringstream*>( &(std::ostringstream() << age))->str() + "\n";
        cashHeldStr = "Cash Held: " + static_cast<std::ostringstream*>( &(std::ostringstream() << cash))->str() + "\n";
        prodWantedStr = "Product Wanted: " + static_cast<std::ostringstream*>( &(std::ostringstream() << prod))->str() + "\n";

        char * nameChar = new char [nameStr.length()+1];
        char * genderChar = new char [genderStr.length()+1];
        char * ageChar = new char [ageStr.length()+1];
        char * cashHeldChar = new char [cashHeldStr.length()+1];
        char * productWantedChar = new char [prodWantedStr.length()+1];

        strcpy(nameChar, nameStr.c_str());
        strcpy(genderChar, genderStr.c_str());
        strcpy(ageChar, ageStr.c_str());
        strcpy(cashHeldChar, cashHeldStr.c_str());
        strcpy(productWantedChar, prodWantedStr.c_str());

        strcat(nameCard, nameChar);
        strcat(nameCard, genderChar);
        strcat(nameCard, ageChar);
        strcat(nameCard, cashHeldChar);
        strcat(nameCard, productWantedChar);

        diagFile.open("Diag.txt");
        diagFile.write("Test", 100);
        diagFile.close();
    }

    void setUp(int L, int T, int R, int B)
    {
        SetRect(&textbox, L,T,R,B);
    }

    void draw()
    {
        font->DrawTextA(d3dSprite, nameCard, -1, &textbox, DT_LEFT, D3DCOLOR_XRGB(255, 255, 255));
    }

    LPCSTR plCard()
    {
        return nameCard;
    }
}; 
```

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:00:58.583

你`nameCard`的未初始化。将第一个替换为`strcat`，`strcpy`或使用零字符串对其进行初始化。

现在，`std::string`独家使用怎么样？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T21:11:38.820

您的主要问题是`nameCard`未初始化。`strcat`需要一个以 null 结尾的字符串来发挥它的魔力，并且不能保证其中的第一个或任何一个字符`nameCard`是 null。

但是，C 字符串是不必要的。只是`std::string`一直使用。更改`nameCard`为字符串后，我将更`load`改为（不包括文件写入）：

```
void load(const std::string &name, bool male, int age, double cash, const std::string &prod)
{
    nameStr = "Name: " + name + "\n";
    genderStr = "Gender: " + (male ? "Male" : "Female") + "\n";
    ageStr = "Age: " + std::to_string(age) + "\n";
    cashHeldStr = "Cash Held: " + std::to_string(cash) + "\n";
    prodWantedStr = "Product Wanted: " + prod + "\n";

    nameCard = nameStr + genderStr + ageStr + cashHeldStr + prodWantedStr;
} 
```

我实际上只是创建`nameCard`一个数据成员，删除其他成员，然后使用它：

```
nameCard.clear();
nameCard += "Name: " + name + "\n";
//add on other parts 
```

除此之外，使`plCard()`return a`std::string`和 in `draw()`，使用`nameCard.c_str()`。我希望这能更清楚地说明你可以用字符串做什么。

但是请注意，那`std::to_string`是 C++11。C++03有两种常见的解决方案：

```
std::string str = boost::lexical_cast<std::string>(someNumber); 
```

或者

```
std::ostringstream oss;
oss << someNumber;
std::string str = oss.str(); 
```

我发现三行比单行或两行更具可读性。

# batch-file - 在 VBScript 中替换 %~dp0

> ID：14677199
> 
> 赞同：4
> 
> 时间：2013-02-03T20:54:25.500
> 
> 标签：batch-file, vbscript

我在我的 VBScript 中找不到任何东西来替换 %~dp0

```
On error resume next
Set shell= createobject("WSCRIPT.SHELL")
Shell.run "%~dp0test.bat", vbhide 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T21:04:00.373

```
Set fso = CreateObject("Scripting.FileSystemObject")
GetTheParent = fso.GetParentFolderName(Wscript.ScriptFullName) 
```

取自这里：

*   [如何获得工作驱动器和目录？](http://www.visualbasicscript.com/how-to-get-working-drive-and-directory-m1248.aspx)

要在脚本中使用获得的值，请在需要其值的地方添加对变量的引用。例如：

```
Shell.run GetTheParent & "\test.bat", vbhide 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-24T10:45:58.077

这应该有效。

```
 set objShell = Createobject("wscript.shell")
    strPath = Left(WScript.ScriptFullName, Len(WScript.ScriptFullName) - Len(WScript.ScriptName))
    Shell.run strPath & "test.bat", vbhide 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:09:56.237

要获取执行 .VBS 所在的文件夹：

```
type dp0.vbs
Option Explicit
Dim oFS : Set oFS = CreateObject("Scripting.FileSystemObject")
WScript.Echo "WScript.ScriptFullName", WScript.ScriptFullName
WScript.Echo "oFS.GetParentFolderName(WScript.ScriptFullName)", oFS.GetParentFolderName(WScript.ScriptFullName
)

cscript dp0.vbs
WScript.ScriptFullName E:\trials\SoTrials\answers\tools\jscript\ijs\dp0.vbs
oFS.GetParentFolderName(WScript.ScriptFullName) E:\trials\SoTrials\answers\tools\jscript\ijs 
```

# python - 为什么 pip 试图安装 ctypes？

> ID：14677208
> 
> 赞同：1
> 
> 时间：2013-02-03T20:55:03.203
> 
> 标签：python, pip, distutils

我尝试创建一个简单的小包并将其上传到 PyPi。但是，当我尝试安装它时，pip 会尝试下载并安装 ctypes（并且编译失败..）：

```
(dev) C:\work\dev>pip install --upgrade dosbox-screen
Downloading/unpacking dosbox-screen
  Running setup.py egg_info for package dosbox-screen
Downloading/unpacking ctypes (from dosbox-screen)
  Running setup.py egg_info for package ctypes
    warning: no files found matching 'MANIFEST'
    warning: no files found matching 'NEWS.txt'
    warning: no files found matching 'ctypes\.CTYPES_DEVEL'
Downloading/unpacking colorama (from dosbox-screen)
  Running setup.py egg_info for package colorama
Installing collected packages: dosbox-screen, ctypes, colorama
  Running setup.py install for dosbox-screen
  Running setup.py install for ctypes
    building '_ctypes' extension
    error: Unable to find vcvarsall.bat
    Complete output from command C:\work\dev\Scripts\python.exe -.. 
```

我在虚拟环境中使用 Python 2.6.6，所以应该已经满足任何 ctypes 要求：

```
(dev) C:\work\dev>python
Python 2.6.6 (r266:84297, Aug 24 2010, 18:46:32) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import ctypes
>>> ctypes.__file__
'c:\\python26\\Lib\\ctypes\\__init__.pyc' 
```

我的 setup.py 文件的第一个版本将其列为要求，但当前版本没有：

```
setup(
    name='dosbox-screen',
    version='0.0.3',
    requires=['colorama'],
    install_requires=['colorama'],
    ... 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:22:34.643

你上传新版本了吗？看起来 pip 正在安装您提到的旧版本（使用 ctypes dep）。尝试传递 -v 参数以获得更详细的输出。

# orchardcms - 在 Orchard CMS 中，如何在用户登录、注销和创建配置文件后设置重定向 URL？

> ID：14677209
> 
> 赞同：1
> 
> 时间：2013-02-03T20:55:15.707
> 
> 标签：orchardcms, profile, orchardcms-1.6

我的网站有一个 Orchard CMS，需要帮助在用户登录、注销和创建新配置文件后重定向用户。我正在使用 Orchard 管理页面中的“个人资料”模块。

目前，我认为代码会将用户发送到他们在点击“登录”链接之前所在的最后一页。与“退出”相同。我希望人们在登录、注销并创建新注册后被重定向到主页。

我相当肯定它存在于以下文件`Core\Shapes\Views\User.cshtml`中。有人可以解释如何编辑它（如果这实际上是正确的编辑）以将用户重定向到主页？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T09:29:06.500

我想简单的方法是在你的模块中实现 IUserEventHandler 。创建一个类 LogInRedirect 并实现一个方法 LoggedIn。像这样：

```
using System.Web.Mvc;
using Orchard.Mvc;
using Orchard.Security;
using Orchard.Users.Events;

namespace Orchard.Users {
    public class LogInRedirect : IUserEventHandler
    {
        private readonly IHttpContextAccessor _httpContext;
        public LoggedOutRedirect( IHttpContextAccessor httpContext )
        {
            _httpContext = httpContext;
        }

        public void LoggedIn( IUser user )
        {
            UrlHelper urlHelper = new UrlHelper( _httpContext.Current().Request.RequestContext );
            _httpContext.Current().Response.Redirect( urlHelper.RequestContext.HttpContext.Request.ApplicationPath + "/yourController/yourAction" );
        }

        public void Creating( UserContext context ) { }
        public void Created( UserContext context ) { }
        public void AccessDenied( IUser user ) { }
        public void ChangedPassword( IUser user ) { }
        public void SentChallengeEmail( IUser user ) { }
        public void ConfirmedEmail( IUser user ) { }
        public void Approved( IUser user ) { }
        public void LoggedOut( IUser user ){ }
    }
} 
```

# c# - Windows phone 7 列表框损坏的数据

> ID：14677212
> 
> 赞同：1
> 
> 时间：2013-02-03T20:55:24.377
> 
> 标签：c#, xaml, listbox, windows-phone

我正在尝试通过具有`TextBlock`绑定的 ListBox 中的 Web 服务显示信息。我一直在网上研究这个问题，似乎无法解决这个问题。我的数据库表确实保存了正确的数据。最后，我有一个页面，它提供了完全相同的功能/方法，并显示了正确的数据。我真的被这个问题困扰着，希望你们中的一个可以帮忙！

我无法上传我的 ListBox 的屏幕截图，但我会尽力在这里说明它！

> 采购订单（标题）
> 
> 采购订单编号：1 (ListItem) 状态：已接受 (ListItem)
> 
> -----显示第一行后出现损坏的数据-----
> 
> 采购订单号：0
> 
> 采购订单号：0
> 
> - - 结尾 - -

请注意，我的第一行显示正确的数据，而其他数据都已损坏。但是，在实现搜索功能时，我能够正确查看数据库中的现有数据。（未损坏）。

采购订单.aspx：

```
<controls:PivotItem Header="Purchase Order" FontSize="18">
            <ScrollViewer VerticalScrollBarVisibility="Visible">
                <ListBox x:Name="ListBoxPurchaseOrder" Margin="20,42,38,0" d:LayoutOverrides="VerticalAlignment">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Vertical">
                                <TextBlock Text="{Binding purchaseOrderID, StringFormat='Purchase Order No: \{0\}'}" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}" FontSize="38" />
                                <TextBlock Text="{Binding status, StringFormat='Status: \{0\}'}" TextWrapping="Wrap" Margin="12,-6,12,0" Style="{StaticResource PhoneTextSubtleStyle}"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </ScrollViewer>
        </controls:PivotItem> 
```

PurchaseOrder.aspx.cs：

```
public PO()
{
    load();
    InitializeComponent();
}

bool success = false;

Session.PurchaseOrder session = new Session.PurchaseOrder();

private void load()
{
    InitializeComponent();
    IfsRetailerClient myClient = new IfsRetailerClient();
    myClient.getPurchaseOrder1Completed += new EventHandler<getPurchaseOrder1CompletedEventArgs>(myClient_getPurchaseOrder1Completed);
    myClient.getPurchaseOrder1Async();
}

void myClient_getPurchaseOrder1Completed(object sender, getPurchaseOrder1CompletedEventArgs e)
{
    ListBoxPurchaseOrder.ItemsSource = e.Result;
} 
```

Web 服务文件，IfsRetailer.cs：

```
[OperationContract]
List<Payment> getPayment(); 
```

fsRetailer.cs：

```
DatabaseEntities db = new DatabaseEntities();
public List<Payment> getPayment()
{
    return db.Payments.ToList();
} 
```

# php - 使用 PHP 更新数据库中现有库存水平和价格的数组值

> ID：14677214
> 
> 赞同：0
> 
> 时间：2013-02-03T20:55:57.270
> 
> 标签：php, mysql, sql, arrays, records

当用户可以购买产品时，我正在创建一个网站。我已经创建了该网站的管理员端，并尝试创建一个页面，管理员在登录后可以更新 myphpadmin 数据库中某个产品的库存水平。到目前为止，我已经设法将代码更新到我的数据库中但不更新到所选产品的阶段。相反，它创造了库存水平和价格的新记录。我使用以下命令携带了上一页中的产品 ID：

```
echo "<input type=hidden name=h_prodid value=".$stockid.">"; 
```

因此，当管理员单击更新链接时，他们会到达包含该特定产品当前详细信息的页面。然后他们输入一个或两个值来更新这个特定的产品，但当前一条新记录被插入到数据库中，而不是更新现有的。请看下面的代码。

```
<?php

session_start();

include("db.php");

//create a variable called $pagename which contains the actual name of the page
$pagename="Product Update Confirmation";

//call in the style sheet called ystylesheet.css to format the page as defined in the style sheet
echo "<link rel=stylesheet type=text/css href=mystylesheet.css>";

//display window title
echo "<title>".$pagename."</title>";
//include head layout 
include("adminheadlayout.html");

//display the name of the site and the date dynamically. See uk.php.net
echo date ('l d F Y H:i:s');
echo "<p></p>";

include ("detectlogin.php");

//display name of the page
echo "<h2>".$pagename."</h2>";

//Capture the details entered in the form using the $_POST superglobal variable
//Store these details into a set of new variables
$newprice=$_POST['p_priceupdate'];
$newquantity=$_POST['p_quantityupdate'];
$prodid=$_POST['h_prodid'];

//If any of the variables is empty
if (!$newprice and !$newquantity)
{
echo "<br>Please enter a value for price and/or quantity ";
echo "<br>Go back to <a href=editstock.php>Edit Stock details</a>";
}
else
{
if (!$newprice or !$newquantity)
{
    //insert a new record in the order table to generate a new order number. 
    //store the id of the user who is placing the order as well as the current date and time
    $productupdateSQL="insert into Products (prodPrice, proQuantity, prodId)
    values ('".$newprice."', '".$newquantity."', '".$prodid."')";
    $exeproductupdateSQL=mysql_query($productupdateSQL);
    echo "<p strong>Stock level updated successfully!";
}

//if a database error is returned, display an order error message
else
{
echo "<p>Sorry there has been an error with your product update";
echo "Go back to <a href=editstock.php>Edit Stock Details</a>";
}
}
//include head layout
include("footlayout.html");
?> 
```

任何想法将不胜感激。我几乎在那里但是找不到与这种特定类型的问题有关的任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:37:39.230

您的脚本只包含一个 INSERT 查询，没有 UPDATE 查询，因此它永远不会更新现有记录

**警告** 您的代码非常不安全，使用过时的 mysql_ 函数并且根本不转义值。因此，该代码易受 SQL 注入攻击。SQL 注入可能导致私有数据暴露和数据丢失！在这里阅读： [http ://www.unixwiz.net/techtips/sql-injection.html](http://www.unixwiz.net/techtips/sql-injection.html)

# python - 字符串作为字节 python3

> ID：14677215
> 
> 赞同：1
> 
> 时间：2013-02-03T20:56:04.687
> 
> 标签：python, string, byte, python-3.2

假设我得到了字符串（应该是一个字节）：

```
"b'YzJGNVltYzJGNVltOTBlbk5oZVdKdmRIcHpZWGxpYjNSNmMyRjVZbTkwZW5OaGVXSnZkSHB6WVhsaWIzUjZjMkY1WW05MGVnOTBlblJsYzNRPXNheWJvdHo='" 
```

我想解码它，但它说它必须以字节为单位，所以我必须以某种方式把它变成这个

```
b'YzJGNVltYzJGNVltOTBlbk5oZVdKdmRIcHpZWGxpYjNSNmMyRjVZbTkwZW5OaGVXSnZkSHB6WVhsaWIzUjZjMkY1WW05MGVnOTBlblJsYzNRPXNheWJvdHo=' 
```

我正在开发一个聊天客户端，当它发送数据（字节）时，它会在通过服务器时以某种方式变成一个字符串，当它到达另一端时，它无法解码

ps：是ENCRYPT，解码会给出随机数和字母，客户端会解密

哦，而且，我真的不知道“=”符号是否应该存在，当我在我和我的朋友之间的测试中获得数据时，我得到了它就像那个字符串（顶部的那个）错误说它必须是字节。

客户端中的部分代码（就一行给大家看，其余保密）：

```
base64.b64decode(that_string).decode('ascii') 
```

它主要使用ascii，所以我认为这是对的，对吧？

更多信息：

```
base64.b64encode(message.encode('ascii')) 
```

这里的消息是用于获取从另一端发送的字符串

```
Room.message(str(secretEncrypt(par, codes()))) 
```

我不知道我是怎么想念这个的，它在发送之前先将它 str =.= 好吧，它仍然需要将它转换为字节，我是怎么做到的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:07:53.130

以下非常有效

```
>>> import base64
>>> s = "Hello StackOwerflow!"
>>> b = s.encode()
>>> c = base64.b64encode(b)
>>> c
b'SGVsbG8gU3RhY2tPd2VyZmxvdyE='
>>> b1 = base64.b64decode(c) 
>>> b1
b'Hello StackOwerflow!'
>>> b1.decode()
'Hello StackOwerflow!' 
```

展示如何编码字符串

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T21:55:01.397

问题在这里：

```
Room.message(str(secretEncrypt(par, codes()))) 
```

`secretEncrypt(...)`返回字节，但随后您执行`str(b"thereturnvalue")`的操作不*符合*您的要求：

```
>>> my_bytes = b"abc"
>>> type(my_bytes)
<class 'bytes'>
>>> str(my_bytes)
"b'abc'"
>>> type(str(my_bytes))
<class 'str'> 
```

它将你的字节的字符串表示（`repr`）放入一个字符串中，这就是为什么你的字符串以`b"`

如何最好地解决这个问题取决于周围的代码.. 要么：

*   如果`secretEncrypt`函数返回字节，则`Room.message`也接受字节（并删除`str(...)`强制转换）。
*   使`secretEncrypt`返回一个字符串，消除对`str(...)`演员表的需要
*   Least elegant solution: decode the bytes returned from `secretEncrypt`, turning it into a string. Something like this:

    ```
    encrypted = secretEncrypt(par, codes())
    Room.message(encrypted.decode("whatever-encoder-was-used")) 
    ```

    Where `whatever-encoding-was-used` is the text encoding (likely `utf-8` or `ascii`, but it is impossible to tell without seeing the rest of your code)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T10:38:54.360

and i was right, no need to over think it

the string:

```
"b'YzJGNVltYzJGNVltOTBlbk5oZVdKdmRIcHpZWGxpYjNSNmMyRjVZbTkwZW5OaGVXSnZkSHB6WVhsaWIzUjZjMkY1WW05MGVnOTBlblJsYzNRPXNheWJvdHo='" 
```

just need to be split, eg:

```
string = "b'YzJGNVltYzJGNVltOTBlbk5oZVdKdmRIcHpZWGxpYjNSNmMyRjVZbTkwZW5OaGVXSnZkSHB6WVhsaWIzUjZjMkY1WW05MGVnOTBlblJsYzNRPXNheWJvdHo='"
string = string.split("'")[1] 
```

and that would get me a string without the b':

```
"YzJGNVltYzJGNVltOTBlbk5oZVdKdmRIcHpZWGxpYjNSNmMyRjVZbTkwZW5OaGVXSnZkSHB6WVhsaWIzUjZjMkY1WW05MGVnOTBlblJsYzNRPXNheWJvdHo=" 
```

then i just need to bytes it:

```
string = bytes(string, "ascii") 
```

which would get me the b' outside the string:

```
b"YzJGNVltYzJGNVltOTBlbk5oZVdKdmRIcHpZWGxpYjNSNmMyRjVZbTkwZW5OaGVXSnZkSHB6WVhsaWIzUjZjMkY1WW05MGVnOTBlblJsYzNRPXNheWJvdHo=" 
```

ps: to everyone out there who say things about cracking my code, it got randoms mumbo jumbo things with the id dump into it, if you manage to crack it, it not much use and anyway, it just a chat client for a mini chatroom games for kids

# java - 如何从java中的特定XML元素中检索

> ID：14677216
> 
> 赞同：0
> 
> 时间：2013-02-03T20:56:06.350
> 
> 标签：java, xml

我可以在我的方法中添加什么行代码，它只会修改标记名“位置”，因为它在名为“地址”的节点下包含特定信息？因此，如果我更新“颜色”或“大小”，那么我可以告诉节点列表：“仅当它在“地址”中包含 123 Main Street 时才更改这些值。我尝试了所有类型的“相等等”注意：我创建我使用 object.getAddress 作为我要检查的变量的对象。XML 有 50 个条目：

```
<location>
    <address>123 Main Street</address>
    <color>red</color>
    <size>large</size>
</location>

public void changeValue(Document doc, String oldValue, String NewValue) throws         Exception {
    Element root = doc.getDocumentElement();
    NodeList childNodes = root.getElementsByTagName("location");
    for (int i = 0; i < childNodes.getLength(); i++) {
        NodeList subChildNodes = childNodes.item(i).getChildNodes();
        for (int j = 0; j < subChildNodes.getLength(); j++) {
            try {
                if (subChildNodes.item(j).getTextContent().equals(oldValue)) {
                    subChildNodes.item(j).setTextContent(NewValue);
                }
            } catch (Exception e) {
            }
        }
    }
    File file = new File("XMLDatabase.xml");
    save(file, doc);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:45:58.867

我希望这有帮助！

```
for (int i = 0; i < childNodes.getLength(); i++) {
        NodeList subChildNodes = childNodes.item(i).getChildNodes();
        for (int j = 0; j < subChildNodes.getLength(); j++) {
            try {
                if (subChildNodes.item(j).getTextContent().equals("123 Main Street")) {
                    int temp=j;
                    subChildNodes.item(temp).setTextContent("value you want to set");
                    subChildNodes.item(temp+2).setTextContent("value you want to set");
                    subChildNodes.item(temp+4).setTextContent("value you want to set");
                }
            } catch (Exception e) {
            }
        }
} 
```

# java - 没有在某些值上输入 if-else 分支

> ID：14677217
> 
> 赞同：-1
> 
> 时间：2013-02-03T20:56:08.353
> 
> 标签：java

我对这个java作业有点麻烦。我对这项编程工作还是很陌生。我无法让程序执行以下操作：科学家以千克为单位测量物体的质量，以牛顿为单位测量其重量。如果你知道一个物体的质量，你可以用下面的公式计算它的重量，以牛顿为单位：

重量 = 质量 X 9.8

编写一个程序，要求用户输入一个物体的质量，然后计算它的重量。如果对象的重量超过 1000 牛顿，则显示一条消息，指示它太重。如果对象的重量小于 10 牛顿，则显示一条消息，指示对象太轻。

这是我到目前为止所写的：

```
import java.util.Scanner;

public class MassandWeight{

    public static void main(String[] args) {

        Scanner keyboard = new Scanner(System.in);

        double mass;

        System.out.print("Please enter the object's mass: ");
        mass = keyboard.nextDouble();

        // Convert the mass to weight using the following expression:
        double weight = (mass * 9.8);

        if (weight >= 10 && weight <= 1000)
            System.out.println("The weight of the object is " + weight + ".");

        else if (weight > 1001)
            System.out.println("The object's weight is too heavy.");

        else if (weight < 9)
            System.out.println("The object's weight is too light.");
    }
} 
```

所以一切都很好！我真的为自己能走到这一步感到自豪。但是，当我输入“1”时，我没有得到任何回复。其他一切都很好。如果您需要更多信息，请告诉我。谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T21:01:17.847

您正在检查`weight`(-∞, 9)、[10, 1000] 和 (1001, +∞) 的值。这意味着您缺少 [9 和 10) 和 (1000, 1001] 中的值。如果您输入`1`，`weight`则将是`9.8`并且您将丢失它。

这是您`if`的 s 应该看起来的样子，而不是：

```
if (weight >=10 && weight <= 1000) ...      
else if (weight > 1000) ...
else if (weight < 10) ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:58:37.530

因为是作业，所以我不会把它全部讲出来......但是检查你的 if/else......也许在最后放一个 else，这样你就可以看到你的 else if 没有捕捉到的场景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:02:23.690

当您输入**1**时，**权重 = (1* 9.8) = 9.8**

你有3个条件：

**1- 重量 >=10 && 重量 <= 1000**

**2- 重量 > 1001**

**3- 重量 < 9**

所以**9.8**不符合这个条件

你`else {}`最后需要

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T21:03:50.993

检查最后一个 else 语句。它不检查是否小于10。当权重> 9 && < 10 时，不执行任何语句（输入1 设置权重为9.8）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-03T21:07:21.057

你必须改变

```
else if (weight < 9) 
```

至

```
else if (weight < 10) 
```

和

```
else if (weight > 1001) 
```

至

```
else if (weight > 1000) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-03T21:12:36.040

*我以保证*路径执行的方式编写这样的 else-if 语句。考虑以下：

```
if (weight < 10) {
  // too light
} else if (weight > 1000) {
  // too heavy
} else {
  // just right - this MUST be the case if
  // the previous branches are not selected
} 
```

使用这样的方法可以帮助我减少编程错误并通过*消除重复*比较来提高可重构性。我也发现它更容易阅读。

请参阅[TDWTF：但是……任何事情都可能发生！](http://thedailywtf.com/Articles/ButAnything-Can-Happen!.aspx)对于重复比较的极端变态：发布的代码并没有那么糟糕，但在我看来，它存在同样的基本缺陷。

# java - 一个项目怎么可能在eclipse中编译，但是javac抛出编译器错误？

> ID：14677219
> 
> 赞同：3
> 
> 时间：2013-02-03T20:56:22.500
> 
> 标签：java, eclipse, compiler-errors

为学校做一个小组项目，当我在命令行中运行 javac 时，以下行会引发错误。

```
Object result = engine.eval(equation); //evaluate the arithmetic expression
cellValue = (double) result; // <-- This throws a compiler error (obviously) 
```

但是由于某种原因，这在我的队友正在使用的 eclipse 中编译和工作（！）。我自己试了一下确认，因为我不敢相信。

```
ScriptEngine engine = manager.getEngineByName("JavaScript"); 
```

engine 是一个 ScriptEngine，如果这完全相关的话。我一生都无法弄清楚 eclipse 的编译器是如何允许编译将 a`Object`直接转换为`double`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T21:04:19.617

可能您的朋友正在使用另一种版本的 Java 语言。`Object`to （原始类型）的`double`转换在 Java 7 中似乎是合法的，但在 Java 6 中却不是。您可以让您的朋友在 Eclipse 中更改他们的项目设置或将您的编译器更新到版本 7。

请注意，转换`Object`为`Double`（类）在两个版本中都有效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-03T21:26:40.803

似乎允许的转换已在 Java 5 和 7 之间进行了扩展。在[Java Language Specification, 3rd edition (for Java 5 and 6) 中](http://docs.oracle.com/javase/specs/jls/se5.0/html/conversions.html#5.5)：

> 可以通过拆箱转换（第 5.1.8 节）将引用类型的值强制转换为原始类型。
> 
> 拆箱转换将引用类型的值转换为原始类型的对应值。具体来说，以下 8 种转换称为拆箱转换：
> 
> *   从布尔类型到布尔类型
> *   从字节类型到字节类型
> *   从字符型到字符型
> *   从短类型到短类型
> *   从 Integer 类型到 int 类型
> *   从 Long 类型到 long 类型
> *   从浮点型到浮点型
> *   从 Double 类型到 double 类型

所以在 Java 5 和 6 中，强制转换`Object`为`double`是不合法的。

[Java 语言规范，Java SE 7 版](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.5)写道：

> The following tables enumerate which conversions are used in certain casting conversions. Each conversion is signified by a symbol:
> 
> ⇓ signifies narrowing reference conversion (§5.1.6)
> 
> ⊔ signifies unboxing conversion (§5.1.8)

and the following table says a cast from Object to double to be

> ⇓,⊔</p>

i.e. a cast from `Object` to `double` is a cast to `Double` followed by an unboxing conversion to `double`.

It is therefore very likely that your team mates are compiling for Java 7, while you are compiling for Java 6.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T21:04:11.127

允许的转换在[JLS #5.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.5)中有详细说明。特别是，允许​​这种转换：

> *   缩小参考转换（第 5.1.6 节）可选地后跟取消装箱转换（第 5.1.8 节）或未经检查的转换（第 5.1.9 节）

在您的情况下，如果`cellValue`是双精度，`Object`则允许进行转换，并将尝试转换`Object`到然后将to`Double`拆箱。`Double``double`

# c++ - 鲁棒的线段匹配

> ID：14677220
> 
> 赞同：0
> 
> 时间：2013-02-03T20:56:22.947
> 
> 标签：c++, pattern-matching, computational-geometry

在 2D 线段匹配中可以应用什么类型的约束？

我有具有不同长度和方向的二维线段。这些线段位于给定线段附近和周围（让我说这是参考线段）。我想为参考线段找到最匹配的线段。主要问题是没有任何线段代表与该参考线 100% 相等的长度和方向，因为参考的方向比其他线略有变化。目前，我尝试了线段之间的距离和它们之间的参考和角度。但我仍然无法获得给定参考的最佳匹配线段。

所以我正在寻找额外的稳健约束。

提前致谢。（这不是作业，拜托）（因为我需要自动化，所以我输入了 C++）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T13:49:48.413

您需要某种错误函数，它描述了一个段与您的参考段的匹配程度。例如，您可以获取端点距离的总和，或者以某种方式考虑线段的方向。误差函数的质量还取决于您拥有的数据类型。您可能在方向上有很大的变化，而在尺寸上可能有很小的变化，或者相反。一个好的误差函数对于相等的对象返回 0 并且稳定增长，对象越不同。

# javascript - Web Audio API 分析器节点 getByteFrequencyData 返回空白数组

> ID：14677221
> 
> 赞同：5
> 
> 时间：2013-02-03T20:56:27.837
> 
> 标签：javascript, audio, signal-processing, html5-audio, web-audio-api

我正在尝试使用从分析器节点访问 FFT 数据，`analyser.getByteFrequencyData(array)`但它似乎返回一个空白数组：

```
var array = new Uint8Array(analyser.frequencyBinCount);
analyser.getByteFrequencyData(array); 
```

但是 using`analyser.getFloatFrequencyData(array)`返回一个数据数组：

```
var array = new Float32Array(analyser.frequencyBinCount);
analyser.getFloatFrequencyData(array); 
```

我正在使用如下信号链：

`Source`-> `Analyser`-> `ScriptProcessor`->`Context Destination`

那么为什么我不能得到字节形式的频率数据呢？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:21:14.670

在没有看到更多代码的情况下，我最好的猜测是您将 minDecibels 和 maxDecibels 设置为超出您通过分析仪抽取的数据的范围，因此它被归零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-03T23:03:40.477

你们中的一个人在播放开始之前获得数据的几率是多少，所以还没有什么可读取的？`getByteFrequencyData`如果是这种情况，请在播放开始后尝试调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-04T10:45:49.233

检查是否`smoothingTimeConstant`设置为`1`. 如果是这样，`getFloatFrequencyData`总是返回一个零数组。

# java - 为什么我的 Java 拆分方法会导致打印空行？

> ID：14677223
> 
> 赞同：1
> 
> 时间：2013-02-03T20:57:17.420
> 
> 标签：java, split, string, println

我正在从学校做一个简短的作业，由于某种原因，两个相邻的分隔符导致打印一个空行。如果它们之间有空格但没有空格，我会理解这一点。我错过了一些简单的东西吗？我希望每个令牌一次打印一行而不打印`~.`

```
public class SplitExample
{
    public static void main(String[] args)
    {
        String asuURL = "www.public.asu.edu/~JohnSmith/CSE205";
        String[] words = new String[6];
        words = asuURL.split("[./~]");
        for(int i = 0; i < words.length; i++)
        {
            System.out.println(words[i]);
        }
    }
}//end SplitExample 
```

编辑：下面的所需输出

```
www
public
asu
edu
JohnSmith
CSE205 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:58:56.167

> 如果它们之间有空格，我会理解这一点，但没有

是的，它们之间没有空格，但是它们之间有一个空字符串。实际上，每对字符之间都有空字符串。

这就是为什么当您的分隔符彼此相邻时，拆分将在它们之间获得空字符串。

> 我希望每个令牌一次打印一行而不打印`~.`

那你为什么要包含`/`在你的分隔符中？`[./~]`表示匹配`.`，或`/`，或`~`。拆分它们也不会打印`/`. 如果您只想拆分`~.`，那么只需在字符类中使用它们 - `[.~]`。但同样，它并不是很清楚，你到底想要什么输出。可能您可以为当前输入发布预期的输出。

* * *

好像你正在分裂`.`,`/`和`/~`。在这种情况下，您不能在此处使用字符类。您可以使用此模式进行拆分：-

```
String[] words = asuURL.split("[.]|/~?"); 
```

这将拆分： - `.`，`/~`或`/`（因为`~`是可选的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T21:07:04.567

你认为唾液会产生什么？/ 和 ~ 之间是什么？是的，没错，有一个空字符串（“”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:02:26.323

之间没有字符，`/~`因此当您拆分这些字符时，您应该期望看到一个空白字符串。

我怀疑你不需要分裂`~`，事实上我也不会分裂`.`。

# ruby - 在 Ubuntu 12.10 上安装 Nokogiri (1.5.2) 时出现问题

> ID：14677228
> 
> 赞同：3
> 
> 时间：2013-02-03T20:57:56.567
> 
> 标签：ruby, ubuntu, gem, nokogiri

我正在运行 Ubuntu 12.10，并且当我运行命令时：

```
bundle install 
```

我得到：

```
Installing nokogiri (1.5.2) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

/usr/bin/ruby1.9.1 extconf.rb 
extconf.rb:10: Use RbConfig instead of obsolete and deprecated Config.
checking for libxml/parser.h... yes
checking for libxslt/xslt.h... yes
checking for libexslt/exslt.h... yes
checking for iconv_open() in iconv.h... yes
checking for xmlParseDoc() in -lxml2... yes
checking for xsltParseStylesheetDoc() in -lxslt... yes
checking for exsltFuncRegister() in -lexslt... yes
checking for xmlHasFeature()... yes
checking for xmlFirstElementChild()... yes
checking for xmlRelaxNGSetParserStructuredErrors()... yes
checking for xmlRelaxNGSetParserStructuredErrors()... yes
checking for xmlRelaxNGSetValidStructuredErrors()... yes
checking for xmlSchemaSetValidStructuredErrors()... yes
checking for xmlSchemaSetParserStructuredErrors()... yes
creating Makefile

make
compiling xml_processing_instruction.c
compiling xml_node.c
compiling html_entity_lookup.c
compiling xml_syntax_error.c
compiling xml_document.c
xml_document.c: In function ‘set_encoding’:
xml_document.c:159:12: warning: cast discards ‘__attribute__((const))’ qualifier from pointer target type [-Wcast-qual]
xml_document.c: In function ‘canonicalize’:
xml_document.c:505:15: warning: cast discards ‘__attribute__((const))’ qualifier from pointer target type [-Wcast-qual]
compiling xml_encoding_handler.c
compiling xml_namespace.c
xml_namespace.c: In function ‘prefix’:
xml_namespace.c:14:13: warning: variable ‘doc’ set but not used [-Wunused-but-set-variable]
xml_namespace.c: In function ‘href’:
xml_namespace.c:33:13: warning: variable ‘doc’ set but not used [-Wunused-but-set-variable]
compiling xml_entity_decl.c
compiling xml_attribute_decl.c
compiling xml_comment.c
compiling xml_dtd.c
compiling xml_xpath_context.c
xml_xpath_context.c: In function ‘xpath_generic_exception_handler’:
xml_xpath_context.c:189:3: error: format not a string literal and no format arguments [-Werror=format-security]
cc1: some warnings being treated as errors
make: *** [xml_xpath_context.o] Error 1

Gem files will remain installed in /home/site/.bundler/tmp/19240/gems/nokogiri-1.5.2 for inspection.
Results logged to /home/site/.bundler/tmp/19240/gems/nokogiri-1.5.2/ext/nokogiri/gem_make.out
An error occured while installing nokogiri (1.5.2), and Bundler cannot continue.
Make sure that `gem install nokogiri -v '1.5.2'` succeeds before bundling. 
```

当我运行时：

```
gem install nokogiri -v '1.5.2' 
```

我得到：

```
site@ubuntu:~/Documents/shopqi$ gem install nokogiri -v '1.5.2'
malloc_limit=60000000 (8000000)
free_min=50000 (4096)
Building native extensions.  This could take a while...
Successfully installed nokogiri-1.5.2
1 gem installed
Installing ri documentation for nokogiri-1.5.2...
Installing RDoc documentation for nokogiri-1.5.2...
site@ubuntu:~/Documents/shopqi$ 
```

没有错误，但如果我再试`bundle install`一次，我会收到没有安装 Nokogiri 的错误。

运行 sudo gem install nokogiri -v '1.5.2' 后 gem_make.out 的内容是：

```
/usr/bin/ruby1.9.1 extconf.rb
extconf.rb:10: Use RbConfig instead of obsolete and deprecated Config.
checking for libxml/parser.h... yes
checking for libxslt/xslt.h... yes
checking for libexslt/exslt.h... yes
checking for iconv_open() in iconv.h... yes
checking for xmlParseDoc() in -lxml2... yes
checking for xsltParseStylesheetDoc() in -lxslt... yes
checking for exsltFuncRegister() in -lexslt... yes
checking for xmlHasFeature()... yes
checking for xmlFirstElementChild()... yes
checking for xmlRelaxNGSetParserStructuredErrors()... yes
checking for xmlRelaxNGSetParserStructuredErrors()... yes
checking for xmlRelaxNGSetValidStructuredErrors()... yes
checking for xmlSchemaSetValidStructuredErrors()... yes
checking for xmlSchemaSetParserStructuredErrors()... yes
creating Makefile

make
compiling xml_processing_instruction.c
compiling xml_node.c
compiling html_entity_lookup.c
compiling xml_syntax_error.c
compiling xml_document.c
xml_document.c: In function ‘set_encoding’:
xml_document.c:159:12: warning: cast discards ‘__attribute__((const))’ qualifier from pointer target type [-Wcast-qual]
xml_document.c: In function ‘canonicalize’:
xml_document.c:505:15: warning: cast discards ‘__attribute__((const))’ qualifier from pointer target type [-Wcast-qual]
compiling xml_encoding_handler.c
compiling xml_namespace.c
xml_namespace.c: In function ‘prefix’:
xml_namespace.c:14:13: warning: variable ‘doc’ set but not used [-Wunused-but-set-variable]
xml_namespace.c: In function ‘href’:
xml_namespace.c:33:13: warning: variable ‘doc’ set but not used [-Wunused-but-set-variable]
compiling xml_entity_decl.c
compiling xml_attribute_decl.c
compiling xml_comment.c
compiling xml_dtd.c
compiling xml_xpath_context.c
xml_xpath_context.c: In function ‘xpath_generic_exception_handler’:
xml_xpath_context.c:189:3: error: format not a string literal and no format arguments [-Werror=format-security]
cc1: some warnings being treated as errors
make: *** [xml_xpath_context.o] Error 1 
```

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-03T21:21:19.250

先试试这个：

```
$  apt-get install libxml2-dev libxslt1-dev 
```

此外，如果您使用的是 rvm，请执行以下操作：

```
$ rvm requirements 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T11:11:03.443

Ubuntu 12.10 采用 Debian 的强化包装器，其中包括一组导致此编译错误的 GCC 的默认标志。我们已经在 Nokogiri 1.5.4 及更高版本中解决了这个问题，因此您需要升级或找到自己的解决方法。

[有关Debian 强化的信息，](http://wiki.debian.org/Hardening#DEB_BUILD_HARDENING_FORMAT_.28gcc.2BAC8-g.2B-.2B-_-Wformat_-Wformat-security_-Werror.3Dformat-security.29)请参见此处。

[有关Nokogiri 团队使用的解决方案的详细信息，](https://github.com/sparklemotion/nokogiri/issues/680)请参见此处。

# android - 无法上传 APK，因为找不到 AndroidManifest.xml 而失败

> ID：14677232
> 
> 赞同：1
> 
> 时间：2013-02-03T20:58:32.630
> 
> 标签：android, xml, eclipse, upload, apk

我已经在 google play 上创建了我的应用程序，当我提交 APK 时，我收到了这个错误：

```
Upload failed

Your APK cannot be analyzed using 'aapt dump badging'. Error output:

Failed to run aapt dump badging:
ERROR: dump failed because no AndroidManifest.xml found 
```

我的项目中显然有一个 AndroidManifest.xml 文件，我也将我的 .apk 压缩为 .zip，我不知道出了什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-02T13:30:37.240

拉胡尔是对的，我也在与谷歌留下的所有地雷作斗争，但由于他的洞察力，我设法完成了第 3 步。

我必须补充一点，JDK7 用户必须使用 jarsigner 更改加密算法和密钥大小：

1) jarsigner -verbose -sigalg MD5withRSA -digestalg SHA1 –keystore mykeystore myApp.apk mykey

2) keytool -genkey -alias mykeystore -keyalg RSA -keysize 1024 -sigalg MD5withRSA -keystore mykey –validity 36500

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:54:02.697

在将 .apk 上传到 Play 商店之前有几个步骤

1.使用生成私钥

```
keytool -genkey -v -keystore my-release-key.keystore
-alias alias_name -keyalg RSA -keysize 2048 -validity 10000 
```

2.在发布模式下编译应用程序：右键单击项目，然后选择**Android 工具**，然后**导出未签名的应用程序包**，给出要保存 .apk 的位置。这里保存成功后，eclipse会提示你下一步做什么？

3.现在使用第一步生成的私钥对您的应用程序进行签名

```
jarsigner -verbose -sigalg MD5withRSA -digestalg SHA1 -keystore my-release-key.keystore
your_app_name.apk alias_name 
```

`jarsigner`如果您的 my-release-key.kestore 和 your_app_name.apk 不在同一位置，则在此步骤中可能会引发错误。

`zipalign`4.使用工具对齐你的包

```
zipalign -v 4 your_project_name-unaligned.apk your_project_name.apk 
```

[在 developer.android.com 上解释得很清楚](http://developer.android.com/tools/publishing/app-signing.html)

# c++ - 如何读取文件目录

> ID：14677235
> 
> 赞同：0
> 
> 时间：2013-02-03T20:58:38.980
> 
> 标签：c++

我正在用 C++ 编写一个程序，它将处理大量（数千）个 PPM 图像，这些图像都存储在同一目录中。但是，我首先需要读取像素值。它们是标准命名空间中的内置函数还是我可以导入的库，它允许我一次读取所有文件，而无需假设我已经使用某种循环结构知道文件名？如果有什么不同，我会在 Mac 上编写程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:41:46.513

为了避免包含`boost::filesystem`所需的依赖项，我最终实现了这个功能：

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <stdexcept>

//include headers required for directory traversal
#if defined(_WIN32)
    //disable useless stuff before adding windows.h
    #define WIN32_LEAN_AND_MEAN
    #include <windows.h>
#else
    #include "dirent.h"
#endif

/**
Traverses the provided directory (non-recursively) and extracts the absolute paths to all the files in it.

Doesn't support non-ASCII file names.

@param directory the absolute path to the directory
@return a vector of file names (including extension)
*/
std::vector<std::string> Filesystem::GetFilesInDirectory(const std::string &directory)
{
    std::vector<std::string> output;

#if defined(_WIN32)

    //select all files
    std::string tempDirectory = directory + "*";

    //initialize the WIN32_FIND_DATA structure
    WIN32_FIND_DATA directoryHandle = {0};

    //set the directory
    std::wstring wideString = std::wstring(tempDirectory.begin(), tempDirectory.end());
    LPCWSTR directoryPath = wideString.c_str();

    //iterate over all files
    HANDLE handle = FindFirstFile(directoryPath, &directoryHandle);
    while(INVALID_HANDLE_VALUE != handle)
    {
        //skip non-files
        if (!(directoryHandle.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY))
        {
            //convert from WCHAR to std::string
            size_t size = wcslen(directoryHandle.cFileName);
            std::vector<char> buffer;
            buffer.resize(2 * size + 2);
            size_t convertedCharacters = 0;
            wcstombs_s(&convertedCharacters, buffer.data(), 2 * size + 2, directoryHandle.cFileName, _TRUNCATE);
            //trim the null characters (ASCII characters won't fill the vector, since they require fewer bytes)
            //convertedCharacters includes the null character, which we want to discard
            std::string file(buffer.begin(), buffer.begin() + convertedCharacters - 1);

            //add the absolute file path
            output.emplace_back(file);
        }

        if(false == FindNextFile(handle, &directoryHandle)) break;
    }

    //close the handle
    FindClose(handle);

#else

    DIR *directoryHandle = opendir(directory.c_str());
    if (NULL != directoryHandle)
    {
        dirent *entry = readdir(directoryHandle);
        while (NULL != entry)
        {
            //skip directories and select only files (hopefully)
            //if ((DT_DIR != entry->d_type) && (DT_UNKNOWN == entry->d_type))
            if (DT_REG == entry->d_type)
            {
                output.emplace_back(entry->d_name);
            }

            //go to next entry
            entry = readdir(directoryHandle);
        }
        closedir(directoryHandle);
    }

#endif

    return output;
} 
```

我对上述不灵活/大部分无用/依赖于平台的代码并不感到非常自豪，如果可能的话，我肯定会选择 BOOST。顺便说一句，它没有在 MAC 上测试过，所以请让我知道它是否有效。

# javascript - 部署到 Heroku 时的 JS 问题

> ID：14677238
> 
> 赞同：0
> 
> 时间：2013-02-03T20:58:54.127
> 
> 标签：javascript, jquery, heroku, twitter-bootstrap

我正在使用 rails 3.2.3 并且刚刚以与正常方式相同的方式将应用程序部署到 heroku，尽管这次我的 Jquery/javascript 似乎存在问题。我的下拉菜单不起作用，我的另一个插件也不起作用，但我的 flexslider 可以（由 JS 提供支持）。在控制台中查看似乎所有 js 都已编译到一个文件中，但我收到此错误

```
TypeError: $ is not a function 
```

该应用程序位于[http://rocky-fortress-7573.herokuapp.com/](http://rocky-fortress-7573.herokuapp.com/)，也许对 JS 有更多了解的人可以看到发生了什么？一切都在本地正常运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:01:26.453

jQuery 不包含在您的页面中。将以下内容添加到您的`<head>`:

```
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script> 
```

# c++ - 如何读取Point向量的向量 - c++

> ID：14677240
> 
> 赞同：0
> 
> 时间：2013-02-03T20:58:59.663
> 
> 标签：c++, exception, opencv, vector

我有一个向量的向量`Point`（称为，由(OpenCV)的函数`squares`返回）。`findSquares()``squares.cpp`

我想对存储在 Point 向量中的四个点的 x 和 y 坐标求平均值（用 c++ 语言）。

我试图这样做：

```
 vector <Point> coordinates(4);

    for ( int i = 0; i<squares.size();i++) {

        coordinates[0].x += squares[i][0].x;
        coordinates[0].y += squares[i][0].y;

        coordinates[1].x += squares[i][1].x;
        coordinates[1].y += squares[i][1].y;

        coordinates[2].x += squares[i][2].x;
        coordinates[2].y += squares[i][2].y;

        coordinates[3].x += squares[i][3].x;
        coordinates[3].y += squares[i][3].y;
    } 
    if(squares.size() !=0){
        for( int j=0; j<4; j++) {
            coordinates[j].x /= squares.size();
            coordinates[j].y /= squares.size();
        }
    } 
```

但我得到了这个例外：

![在此处输入图像描述](../Images/d47080fa220f7f81bbd3fdf4b31b3a16.png)

我以错误的方式读取 Point 向量的向量元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:31:34.063

注意以下代码：

```
if (squares.size() !=0){
    for( int j=0; j<4; j++) {
        coordinates[j].x /= squares.size();
        coordinates[j].y /= squares.size();
    }
} 
```

**此代码块可能在大于 0 但小于 4`coordinates[j].x`时崩溃。`squares.size()`**

想象一下它`squares.size()`是 2。你认为当它变成 2时会在`for`循环中发生什么？`j`除法将变为`coordinates[2].x /= squares.size();`，它试图访问向量中不存在的位置，从而导致崩溃。**请记住**：如果数组的大小为 2，则向量的有效索引为 0 和 1，因此 2 超出范围。

这是您的代码中的一个问题，可能是导致崩溃的原因。要修复它，请将您的循环更新为：

```
 for (int j = 0; j < squares.size(); j++) { 
```

如果崩溃继续发生，则问题出在代码中的其他地方。

# php - Zend 框架配置文件 JSON

> ID：14677244
> 
> 赞同：0
> 
> 时间：2013-02-03T20:59:34.147
> 
> 标签：php, json, zend-framework2

目前我正在学习ZF2。在通过“入门”时，我看到模块的每个配置文件都充满了 PHP 数组。文档中的一个示例：

```
<?php
return array(
    'controllers' => array(
        'invokables' => array(
            'Album\Controller\Album' => 'Album\Controller\AlbumController',
        ),
    ),

    // The following section is new and should be added to your file
    'router' => array(
        'routes' => array(
            'album' => array(
                'type'    => 'segment',
                'options' => array(
                    'route'    => '/album[/:action][/:id]',
                    'constraints' => array(
                        'action' => '[a-zA-Z][a-zA-Z0-9_-]*',
                        'id'     => '[0-9]+',
                    ),
                    'defaults' => array(
                        'controller' => 'Album\Controller\Album',
                        'action'     => 'index',
                    ),
                ),
            ),
        ),
    ),

    'view_manager' => array(
        'template_path_stack' => array(
            'album' => __DIR__ . '/../view',
        ),
    ),
); 
```

带有数组的数组。实际上我知道，该数组只是函数的名称，它更像是带有键/值对的映射。

Zend MODS 之一指出我们可以将 JSON 用于配置文件： http: [//framework.zend.com/manual/2.0/en/user-guide/routing-and-controllers.html#comment-696979913](http://framework.zend.com/manual/2.0/en/user-guide/routing-and-controllers.html#comment-696979913)

有没有人可以为初学者提供例子？我真的更喜欢对这些文件配置使用 JSON 格式而不是数组/映射，但我在 ZF 主页上找不到它。或者也许我不应该这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:47:36.503

我会尝试修改文件中的`getConfig()`函数`Module.php`：

```
return \Zend\Config\Factory::fromFile(__DIR__ . '/config/module.config.json', false); 
```

# web-scraping - iMacro - 设置变量 + SaveAs CSV

> ID：14677247
> 
> 赞同：3
> 
> 时间：2013-02-03T20:59:36.053
> 
> 标签：web-scraping, imacros

我正在为我的 iMacro 脚本的 2 个部分寻求帮助...

```
Part1 - Variable 
```

我单击页面的以下行以访问我需要从中提取的页面。

第一个链接

```
TAG POS=**8** TYPE=A FORM=NAME:xxyy ATTR=HREF:https://aaa.aaaa.com/en/administration/xxxx.jsp?reqID=h* 
```

第二个链接

```
TAG POS=**9** TYPE=A FORM=NAME:xxyy ATTR=HREF:https://aaa.aaaa.com/en/administration/xxxx.jsp?reqID=h* 
```

标签 pos 是变量，我怎样才能得到这个，以便在循环运行时，宏将选择屏幕上的下一个值（即选择 8、9、10）？有些屏幕有 100 多个可供点击的链接。

**第 2 部分 - 保存 CSV 文件**

我的文件中有 saveas 行。但是我怎样才能使它只`csv`创建一个文件（即使宏运行了 50 次）？此外，有没有办法`CSV`从 iMacros 格式化文件，以便每次新运行都从另一行开始（目前，所有数据都提取到多列的第 1 行。）

先感谢您，

亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:20:45.910

这将满足您的要求。它将循环宏并每次在宏中设置新的位置编号。

1)

```
 var macro;

    macro ="CODE:";
    macro +="TAG POS={{number}} TYPE=A FORM=NAME:xxyy ATTR=HREF:https://aaa.aaaa.com/en/administration/xxxx.jsp?reqID=h*"+"\n";

for(var i=1;i<100;i++)
{

iimSet("number",i)
iimPlay(macro)

} 
```

对于第二部分的解决方案，您将需要 JavaScript 脚本。第一部分是声明宏，第二部分是启动宏，第三部分是将提取的文本保存到文件中的函数。每次运行它都会保存在新行中。

2)

```
var macroExtractSomething;

macroExtractSomething ="CODE:";
macroExtractSomething +="TAG POS=1 TYPE=DIV ATTR=CLASS:some_class_of_some_div EXTRACT=TXT"+"\n";

iimPlay(macroExtractSomething)
var extracted_text=iimGetLastExtract();

WriteFile("C:\\some_folder\\some_file.csv",extracted)

  //This function writes string into a file. It will also create file on that location
    function WriteFile(path,string)
    {

    //import FileUtils.jsm
    Components.utils.import("resource://gre/modules/FileUtils.jsm");
    //declare file
    var file = new FileUtils.File(path);

    //declare file path
    file.initWithPath(path);

    //if it exists move on if not create it
    if (!file.exists())
    {
    file.create(file.NORMAL_FILE_TYPE, 0666);
    }

    var charset = 'EUC-JP';
    var fileStream = Components.classes['@mozilla.org/network/file-output-stream;1']
    .createInstance(Components.interfaces.nsIFileOutputStream);
    fileStream.init(file, 18, 0x200, false);
    var converterStream = Components
    .classes['@mozilla.org/intl/converter-output-stream;1']
    .createInstance(Components.interfaces.nsIConverterOutputStream);
    converterStream.init(fileStream, charset, string.length,
    Components.interfaces.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);

    //write file to location
    converterStream.writeString("\r\n"+string);
    converterStream.close();
    fileStream.close();

    } 
```

# javascript - 防止在父 div 上调用 javascript 回调

> ID：14677257
> 
> 赞同：0
> 
> 时间：2013-02-03T21:01:11.310
> 
> 标签：javascript, jquery, google-chrome, callback, userscripts

我正在开发一个应该是跨浏览器兼容的用户脚本，这可以解释为什么我没有以正常方式做事。该脚本显示一个名为 box 的浮动 div，它是一个 jQuery 对象。点击函数如下所示：

```
box.click(function(event) {
    set_visible(false);
}); 
```

set_visible 函数只是做一个`box.fadeOut(500);`

在父 div 中，我创建了一个菜单，不使用 jQuery，而是使用类似这样的函数数组创建普通的旧 javaScript（我尝试使用 jQuery 重写此函数，但在使数组函数工作时遇到了一些问题）：

```
function doGMMenu() {
    if( !GM_falsifiedMenuCom.length ) { return; }
    var mdiv = document.createElement('div');
    for( var i = 0; GM_falsifiedMenuCom[i]; i++) {
        var bing;
        mdiv.appendChild(bing = document.createElement('a'));
        bing.setAttribute('href','#');
        bing.onclick = new Function('GM_falsifiedMenuCom['+i+'][1](arguments[0]); return false;');
        bing.appendChild(document.createTextNode(GM_falsifiedMenuCom[i][0]));
        if (i+1<GM_falsifiedMenuCom.length)
            mdiv.appendChild(document.createTextNode('\u00A0\u00A0|\u00A0\u00A0'));
    }
    status.contents().append(mdiv);
} 
```

这是显示选项菜单的第一个数组函数的示例：

```
 function() { DisplaySlideMenu(true); } 
```

我的问题是，当我单击链接时，会显示选项菜单，但也会调用父 div 的 box.click 函数，当我不想这样做时会隐藏它。添加锚点 .onclick 函数后，您可以看到最后一个条目是`return false;`，但这不会阻止 .click 事件传播到父 div。有什么办法可以防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:31:09.687

```
box.click(function(event) {
    event.stopImmediatePropagation();
    event.stopPropagation();
    set_visible(false);
}); 
```

# linux - 在linux中根据文件中的文本拆分大文件的最快方法

> ID：14677260
> 
> 赞同：6
> 
> 时间：2013-02-03T21:01:17.937
> 
> 标签：linux, bash, sed, awk

我有一个包含 10 年数据的大文件。我想将其拆分为每个包含 1 年数据的文件。

文件中的数据格式如下：

GBPUSD,20100201,000200,1.5969,1.5969,1.5967,1.5967,4 GBPUSD,20100201,000300,1.5967,1.5967,1.5960,1.5962,4

字符 8-11 包含年份。我想将其用作最后带有 .txt 的文件名。所以 2011.txt、2012.txt 等

该文件包含大约 400 万行。

我正在使用 Ubuntu Linux

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T21:05:40.293

这是一种使用方法`awk`：

```
awk '{ print > substr($0,8,4) ".txt" }' file 
```

如果第一个字段的长度可以变化，您可能更喜欢：

```
awk -F, '{ print > substr($2,0,4) ".txt" }' file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:17:22.147

我认为这应该从命令行工作：

`YEARS=`cat FILE | sed -e 's/^.......//' -e 's/\(....\).*$/\1/' | sort | uniq` ; for Y in $YEARS ; do echo Processing $Y... ; egrep '^.......'$Y FILE > $Y.txt ; done`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:45:07.737

最好通读一次文件，然后将每一行写入文件应该去的地方。所以@steve 使用 AWK 的解决方案是一个很好的解决方案。

`grep`您可以使用适当的正则表达式来解决此问题：`^.......2010`仅匹配`2010`年份位置的行。然后一个shell脚本可以循环多年并继续运行`grep`，如下所示：

```
for year in 2010 2011 2012; do
    grep "^.......$year" datafile > $year.txt
done 
```

但它并不优雅，因为它每年读取一次整个源文件。

这是与 AWK 一起使用的 Python 解决方案。

```
import sys

def next_line():
    if len(sys.argv) == 1:
        for line in sys.stdin:
            yield line
    else:
        for name in sys.argv[1:]:
            with open(name) as f:
                for line in f:
                    yield line

_open_files = {}
def output(fname, line):
    if fname not in _open_files:
        _open_files[fname] = open(fname, "w")
    _open_files[fname].write(line)

for line in next_line():
    year = line[7:11]
    fname = year + ".txt"
    output(fname, line) 
```

AWK 肯定会因为简洁而获胜。我必须实现一个函数`next_line()`来提供一个服务，该服务依次提供每个文件的源代码行，或者如果您没有指定文件，则提供标准输入；使用 AWK，您可以免费获得。我必须实现一个函数`output()`，让你只提供一个文件名和一个字符串并编写输出，但使用 AWK 你可以免费获得。

如果您的问题不会变得更复杂，您可以使用 AWK 解决方案，但如果您希望随着时间的推移添加更多的花里胡哨，那么 Python 解决方案可能会得到回报。（这就是我喜欢 Python 的原因……一旦你使用它，无论你需要做什么，都很容易扩展它。）

# javascript - 我的 xhr 被切断的 ajax xmlhttprequest post 方法是否有任何数据限制大小？

> ID：14677265
> 
> 赞同：4
> 
> 时间：2013-02-03T21:01:39.290
> 
> 标签：javascript, html, ajax, xmlhttprequest

我正在尝试使用 ajax xmlhttprequest post 方法将一些 html 数据发送到 php 脚本。但由于某种原因，我的 XHR POST REQUEST 被切断，并非所有数据都传输到我的 doit.php 脚本。然而，来自 textarea 表单的相同 html 数据通过普通表单发布方法正确传递给 doit.php 脚本！你们能帮我解决这个问题并能够通过 xhr 请求传递这个 html 数据吗？

```
 var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
        document.getElementById("myDiv").innerHTML=xmlhttp.responseText;
        }
      }
    xmlhttp.open("POST","http://www.mysite.com/doit.php?Name=test&Id=12345",true);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send("outputtext="+siteContents); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T21:36:30.617

我认为您还应该对您的*siteContents*字符串进行编码URIComponent [() ：](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent)

 *```
xmlhttp.send("outputtext=" + encodeURIComponent(siteContents)); 
```

这是因为 POST 变量由 & 号 ( `&`) 分隔。问题可能是您的字符串还包含一个＆符号，它将被解释为新 POST 变量的开头。

如果您在 PHP 脚本中输出所有收到的 POST 变量，您可以轻松地检查这一点：

```
var_dump($_POST); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:03:02.223

由于 URL 中的问号和名称/值对，这对我来说似乎是一个 GET 请求：

```
http://www.mysite.com/doit.php?Name=test&Id=12345 
```

以下是使用 AJAX 发出 POST 请求的方法：

[http://www.javascriptkit.com/dhtmltutors/ajaxgetpost2.shtml](http://www.javascriptkit.com/dhtmltutors/ajaxgetpost2.shtml)*

# c# - 编辑由 simpleMembership 系统创建的默认表

> ID：14677268
> 
> 赞同：2
> 
> 时间：2013-02-03T21:01:51.443
> 
> 标签：c#, asp.net, asp.net-mvc

我正在学习 MVC4 默认项目文件。

我正在尝试在默认的 UserProfile 表中添加一个新列，但它对我不起作用。该列已添加到编辑器中，但我只能将表另存为另一个 .sql 脚本扩展文件。

因此我关注这篇文章

[http://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/](http://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/)

`public string UserEmail(){get;set;}`并在 UserProfile 类中添加了一个属性

然后我重新运行`"update-database -verbose"` 但我得到了错误

> 数据库中已经有一个名为“UserProfile”的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:22:38.580

使用 Entity Framework 5 和数据库迁移，每次在您的案例中向模型添加属性`Model being UserProfile`并添加`public string UserEmail(){ get; set; }`时，您必须`Update-Database -Force`在包管理器控制台中执行以更新您的数据库，否则您将收到上述错误。还要确保在执行此操作时选择了正确的项目。当您使用它时，在您的`Configuaration.cs`集合中`AutomaticMigrationsEnabled = true;`这在开发过程中很好，但一旦您即将部署到生产环境，请将其设置为 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:17:54.270

我认为默认用户配置文件仍在 AccountsModels.cs 中（在模型目录中），并且不允许有 2 个具有相同名称的类。为“class UserProfile”执行 CTRL F，如果找不到 2，请尝试添加 -Force 标志。

# git - 使用 git 拥有一个远程测试存储库

> ID：14677271
> 
> 赞同：0
> 
> 时间：2013-02-03T21:01:58.257
> 
> 标签：git, unit-testing, repository, git-bare

在我目前的设置中，我的开发服务器有一堆裸 git 存储库，我和其他一些用户从中推送。但是，现在，我想在服务器本身上集成 PHPUnit 测试。

我最初的想法是在每个 repo 中都有一个名为 的子目录`tests`，然后让[VisualPHPUnit](https://github.com/NSinopoli/VisualPHPUnit "VisualPHPUnit")之类的东西运行测试，这样我就可以通过服务器的“网站”查看结果。但是，由于远程存储库是裸露的，我不能完全告诉 VPHPU 去寻找测试目录——因为它们实际上并不存在。

有没有更好的做事方式？我在想也许有另一个存储库，其中包含所有项目的测试，只是让它不是裸露的——但这违反了 git 标准并且可能会破坏东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:33:33.593

我认为您最好设置[Jenkins](http://jenkins-ci.org/)或[QuickBuild](http://www.pmease.com/features/)。Jenkins 是开源的，而 QuickBuild 不是。但 QuickBuild 确实有免费版本，我发现它比前者更可靠。两者都允许您检查源代码、运行测试并发布结果。从长远来看，它可以让您做更多事情，例如打包您的产品以进行部署。

如果你一心想要让你当前的想法生效，你需要一个 post-receive 钩子，它会在某处签出代码，针对签出运行测试，并将结果发布到已知位置。不过，您需要考虑一些事情。例如，您想测试每个分支吗？只有一个吗？post-receive 钩子会告诉你所有正在更新的分支，所以如果你只想测试，你可能需要过滤`master`。Pro Git 有一些关于[钩子](http://git-scm.com/book/en/Customizing-Git-Git-Hooks)以及如何自定义它们的信息。

我会避免使用裸存储库。您将不得不处理诸如推入裸存储库之类的事情，这是不受欢迎的。我认为最后，您真的希望 Jenkins 或 QuickBuild 帮助您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:13:21.750

我建议使用 gerrit 管理您的远程 git 存储库[并](http://code.google.com/p/gerrit/)设置[jenkins以使用](https://jenkins-ci.org/)[gerrit 插件](https://wiki.jenkins-ci.org/display/JENKINS/Gerrit+Trigger)运行所有自动测试。

这样你将更改推送到 gerrit，gerrit 会通知 jenkins，jenkins 会在新推送的代码上运行所有测试。现在 gerrit 打开一个评论，展示测试的变化和结果。然后，当 jenkins 满意并且更改看起来很正常时，您将更改合并到官方分支，另一个开发人员可以从中再次获取它。

这个过程可能看起来有点复杂，但它确保只有成功测试的代码才会驻留在你的存储库中，如果你破坏了任何测试，你可以确定你破坏了它。- 这就是自动测试的重点。;)

# ruby-on-rails - 让 imgkit + 回形针 + s3 工作。回形针无法识别“快照”

> ID：14677274
> 
> 赞同：4
> 
> 时间：2013-02-03T21:02:15.257
> 
> 标签：ruby-on-rails, ruby, amazon-s3, paperclip, imgkit

编辑：一个问题是我需要做 r = Resource.where(id: 3).first #<== 我之前没有 .first

我正在尝试使用 imgkit + paperclip + s3 获取 URL 的快照。我能够获取快照，并将它们成功上传到回形针。例如，本文底部的 IRB 会话成功地将指定 URL 的快照上传到我的 S3 存储桶。

但是，我正在尝试显示图像，但我总是得到一个 missing.png 图像。我在下面给出的 IRB 会话中进行了实验，发现了一些有趣的东西。我认为我没有正确保存 resource.snapshot，因为如果我在不同的变量名下找到资源（查看下面的 IRB 会话），我将无法再次获取该 url。

我只想知道如何获取上传到 S3 的图像的 url。

我运行了“rails 生成回形针资源快照”，然后成功运行了“rake db:migrate”。

宝石文件：

```
# IMGKit for site thumbnails
gem "imgkit", "~> 1.3.7"

# Amazon S3 storage
gem 'aws-sdk', '~> 1.3.4'

# Paperclip for file uploads
gem "paperclip", :git => "git://github.com/thoughtbot/paperclip.git" 
```

在我的 resource.rb 模型中：

```
attr_accessible :snapshot
  has_attached_file :snapshot,
                    :storage => :s3,
                    :s3_credentials => "#{Rails.root}/config/s3.yml" 
```

这是我的 IRB 会议：

```
128-110-88-73:KnowledgeThief dainewinters$ rails c
    Loading development environment (Rails 3.2.11)
    irb(main):001:0> r = Resource.first
      Resource Load (0.9ms)  SELECT "resources".* FROM "resources" LIMIT 1
    => nil
    irb(main):002:0> r = Resource.first
      Resource Load (1.1ms)  SELECT "resources".* FROM "resources" LIMIT 1
    => #<Resource id: 1, link: "http://cm.dce.harvard.edu/2012/01/13836/publication...", title: "Harvard CS61 - Computer Systems", description: "Harvard's version of CS4400\. Topics include assembl...", user_id: nil, created_at: "2013-02-03 20:36:01", updated_at: "2013-02-03 20:36:01", youtubeID: nil, media_type: "video", snapshot_file_name: nil, snapshot_content_type: nil, snapshot_file_size: nil, snapshot_updated_at: nil>
    irb(main):003:0> url = r.link
    => "http://cm.dce.harvard.edu/2012/01/13836/publicationListing.shtml"
    irb(main):004:0> url = PostRank::URI.clean(r.link)
    => "http://cm.dce.harvard.edu/2012/01/13836/publicationListing.shtml"
    irb(main):005:0> side_size = 300
    => 300
    irb(main):006:0> crop_side_size = 300
    => 300
    irb(main):007:0> kit = IMGKit.new(url, :quality => 50,
    irb(main):008:1*                           :width   => side_size,
    irb(main):009:1*                           :height  => side_size,
    irb(main):010:1*                           "crop-w" => crop_side_size,
    irb(main):011:1*                           "crop-h" => crop_side_size,
    irb(main):012:1*                           "zoom"   => 0.35,
    irb(main):013:1*                           "disable-smart-width" => true,
    irb(main):014:1*                           "load-error-handling" => "ignore")
    => #<IMGKit:0x007fa11599adc8 @options={:quality=>50, :width=>300, :height=>300, "crop-w"=>300, "crop-h"=>300, "zoom"=>0.35, "disable-smart-width"=>true, "load-error-handling"=>"ignore"}, @stylesheets=[], @source=http://cm.dce.harvard.edu/2012/01/13836/publicationListing.shtml>
    irb(main):015:0> img = kit.to_img(:jpg)
    => "\xFF\xD8\xFF\xE0\x00\x10JFIF\x00\x01\x01\x01..."
    irb(main):016:0> r.id
    => 1
    irb(main):017:0> r.object_id
    => 70164904582860
    irb(main):018:0> file = Tempfile.new(["resource_snapshot_#{r.id}
    irb(main):019:2" ", 'jpg'], 'tmp', :encoding => 'ascii-8bit')
    => #<File:/Users/dainewinters/rails/KnowledgeThief/tmp/resource_snapshot_1
    20130203-28526-1fpqdwljpg>
    irb(main):020:0> file.write(img)
    => 9756
    irb(main):021:0> file.flush
    => #<File:/Users/dainewinters/rails/KnowledgeThief/tmp/resource_snapshot_1
    20130203-28526-1fpqdwljpg>
    irb(main):022:0> r.snapshot
    => /snapshots/original/missing.png
    irb(main):023:0> r.snapshot = file
    => #<File:/Users/dainewinters/rails/KnowledgeThief/tmp/resource_snapshot_1
    20130203-28526-1fpqdwljpg>
    irb(main):024:0> r.snapshot
    => http://s3.amazonaws.com/knowledgethief-dev/resources/snapshots/000/000/001/original/resource_snapshot_1%0A20130203-28526-1fpqdwljpg?1359924148
    irb(main):025:0> r.save!
       (0.2ms)  BEGIN
       (0.9ms)  UPDATE "resources" SET "snapshot_file_name" = 'resource_snapshot_1
    20130203-28526-1fpqdwljpg', "snapshot_content_type" = 'image/jpeg', "snapshot_file_size" = 9756, "snapshot_updated_at" = '2013-02-03 20:42:28.408205', "updated_at" = '2013-02-03 20:42:35.031108' WHERE "resources"."id" = 1
       (0.8ms)  COMMIT
    => true
    irb(main):026:0> r
    => #<Resource id: 1, link: "http://cm.dce.harvard.edu/2012/01/13836/publication...", title: "Harvard CS61 - Computer Systems", description: "Harvard's version of CS4400\. Topics include assembl...", user_id: nil, created_at: "2013-02-03 20:36:01", updated_at: "2013-02-03 20:42:35", youtubeID: nil, media_type: "video", snapshot_file_name: "resource_snapshot_1\n20130203-28526-1fpqdwljpg", snapshot_content_type: "image/jpeg", snapshot_file_size: 9756, snapshot_updated_at: "2013-02-03 20:42:28">
    irb(main):027:0> r.snapshot
    => http://s3.amazonaws.com/knowledgethief-dev/resources/snapshots/000/000/001/original/resource_snapshot_1%0A20130203-28526-1fpqdwljpg?1359924148
    irb(main):028:0> file.unlink
    => nil
    irb(main):029:0> r.snapshot
    => http://s3.amazonaws.com/knowledgethief-dev/resources/snapshots/000/000/001/original/resource_snapshot_1%0A20130203-28526-1fpqdwljpg?1359924148
    irb(main):030:0> r.snapshot.url
    => "http://s3.amazonaws.com/knowledgethief-dev/resources/snapshots/000/000/001/original/resource_snapshot_1%0A20130203-28526-1fpqdwljpg?1359924148"
    irb(main):031:0> r2 = Resource.first
      Resource Load (2.3ms)  SELECT "resources".* FROM "resources" LIMIT 1
    => #<Resource id: 2, link: "http://www.codeschool.com/courses/try-git", title: "Try Git", description: "A great introduction to Git, a popular version cont...", user_id: nil, created_at: "2013-02-03 20:36:01", updated_at: "2013-02-03 20:36:01", youtubeID: nil, media_type: "interactive course", snapshot_file_name: nil, snapshot_content_type: nil, snapshot_file_size: nil, snapshot_updated_at: nil>
    irb(main):032:0> r2
    => #<Resource id: 2, link: "http://www.codeschool.com/courses/try-git", title: "Try Git", description: "A great introduction to Git, a popular version cont...", user_id: nil, created_at: "2013-02-03 20:36:01", updated_at: "2013-02-03 20:36:01", youtubeID: nil, media_type: "interactive course", snapshot_file_name: nil, snapshot_content_type: nil, snapshot_file_size: nil, snapshot_updated_at: nil>
    irb(main):033:0> r2.snapshot
    => /snapshots/original/missing.png
    irb(main):034:0> r
    => #<Resource id: 1, link: "http://cm.dce.harvard.edu/2012/01/13836/publication...", title: "Harvard CS61 - Computer Systems", description: "Harvard's version of CS4400\. Topics include assembl...", user_id: nil, created_at: "2013-02-03 20:36:01", updated_at: "2013-02-03 20:42:35", youtubeID: nil, media_type: "video", snapshot_file_name: "resource_snapshot_1\n20130203-28526-1fpqdwljpg", snapshot_content_type: "image/jpeg", snapshot_file_size: 9756, snapshot_updated_at: "2013-02-03 20:42:28">
    irb(main):035:0> r2 = Resource.where(id: 1)
      Resource Load (0.6ms)  SELECT "resources".* FROM "resources" WHERE "resources"."id" = 1
    => [#<Resource id: 1, link: "http://cm.dce.harvard.edu/2012/01/13836/publication...", title: "Harvard CS61 - Computer Systems", description: "Harvard's version of CS4400\. Topics include assembl...", user_id: nil, created_at: "2013-02-03 20:36:01", updated_at: "2013-02-03 20:42:35", youtubeID: nil, media_type: "video", snapshot_file_name: "resource_snapshot_1\n20130203-28526-1fpqdwljpg", snapshot_content_type: "image/jpeg", snapshot_file_size: 9756, snapshot_updated_at: "2013-02-03 20:42:28">]
    irb(main):036:0> r2
    => [#<Resource id: 1, link: "http://cm.dce.harvard.edu/2012/01/13836/publication...", title: "Harvard CS61 - Computer Systems", description: "Harvard's version of CS4400\. Topics include assembl...", user_id: nil, created_at: "2013-02-03 20:36:01", updated_at: "2013-02-03 20:42:35", youtubeID: nil, media_type: "video", snapshot_file_name: "resource_snapshot_1\n20130203-28526-1fpqdwljpg", snapshot_content_type: "image/jpeg", snapshot_file_size: 9756, snapshot_updated_at: "2013-02-03 20:42:28">]
    irb(main):037:0> r2.snapshot
    NoMethodError: undefined method `snapshot' for #<ActiveRecord::Relation:0x007fa115d42b88>
        from /Users/dainewinters/.rbenv/versions/1.9.3-p327-perf/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/relation/delegation.rb:45:in `method_missing'
        from (irb):37
        from /Users/dainewinters/.rbenv/versions/1.9.3-p327-perf/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/commands/console.rb:47:in `start'
        from /Users/dainewinters/.rbenv/versions/1.9.3-p327-perf/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/commands/console.rb:8:in `start'
        from /Users/dainewinters/.rbenv/versions/1.9.3-p327-perf/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/commands.rb:41:in `<top (required)>'
        from script/rails:12:in `require'
        from script/rails:12:in `<main>'
    irb(main):038:0> r2.snapshot_file_name
    NoMethodError: undefined method `snapshot_file_name' for #<ActiveRecord::Relation:0x007fa115d42b88>
        from /Users/dainewinters/.rbenv/versions/1.9.3-p327-perf/lib/ruby/gems/1.9.1/gems/activerecord-3.2.11/lib/active_record/relation/delegation.rb:45:in `method_missing'
        from (irb):38
        from /Users/dainewinters/.rbenv/versions/1.9.3-p327-perf/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/commands/console.rb:47:in `start'
        from /Users/dainewinters/.rbenv/versions/1.9.3-p327-perf/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/commands/console.rb:8:in `start'
        from /Users/dainewinters/.rbenv/versions/1.9.3-p327-perf/lib/ruby/gems/1.9.1/gems/railties-3.2.11/lib/rails/commands.rb:41:in `<top (required)>'
        from script/rails:12:in `require'
        from script/rails:12:in `<main>'
    irb(main):039:0> r2
    => [#<Resource id: 1, link: "http://cm.dce.harvard.edu/2012/01/13836/publication...", title: "Harvard CS61 - Computer Systems", description: "Harvard's version of CS4400\. Topics include assembl...", user_id: nil, created_at: "2013-02-03 20:36:01", updated_at: "2013-02-03 20:42:35", youtubeID: nil, media_type: "video", snapshot_file_name: "resource_snapshot_1\n20130203-28526-1fpqdwljpg", snapshot_content_type: "image/jpeg", snapshot_file_size: 9756, snapshot_updated_at: "2013-02-03 20:42:28">]
    irb(main):040:0> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:03:43.917

事实证明，我做的一切都是对的，除了：

```
r = Resource.where(id: 3) 
```

需要是

```
r = Resource.where(id: 3).first 
```

因为第一个返回一个数组。

# css - 带有 TransformOrigin 的 GWT setProperty

> ID：14677275
> 
> 赞同：0
> 
> 时间：2013-02-03T21:02:18.760
> 
> 标签：css, gwt, attributes

我想将以下样式应用于元素：

```
 style = "transform-origin: top left;" 
```

我想在 GWT 中使用

```
element.getStyle().setProperty("TransformOrigin", myValue); 
```

其中“myValue”是一个字符串。哪个值应该采用“myValue”来最终应用“左上角”属性？

我找不到有关 GWT 的 TransformOrigin 属性的任何文档！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T11:13:04.733

此解决方案适用于所有主流浏览器：

```
 String[] engines = new String[]{"","webkit","ms","Moz","O","khtml"};      
 String value = "0 0";
 String name = "TransformOrigin";
    for( String prefix : engines ) {
        element.getStyle().setProperty( prefix+name, value);
    } 
```

# javascript - textarea 是必填字段吗？

> ID：14677279
> 
> 赞同：0
> 
> 时间：2013-02-03T21:02:25.890
> 
> 标签：javascript, html, forms, textarea

我正在构建一个大型表格，用于编制我们客户（喜剧演员）的旅游日程。[看到这里。](http://www.standupexperts.com/avails-test2.html)

每当我删除底部较大的文本区域时，表单就会停止工作，即。提交按钮不做任何事情。

任何人为什么会发生这种情况？谢谢。

我不确切知道什么会有所帮助，但这是包含表单的 div 的代码：

```
<div class="info-avails">       

<form action="http://www.standupexperts.com/cgi-sys/formmail.pl" method="post" name="hgmailer" >
<input type="hidden" name="recipient" value="adam@standupexperts.com">
 <input type="hidden" name="subject" value="FormMail E-Mail">

                    <p> Name:<span style="color:white">X-</span>  <input type="text" name="name" size="20" value="">
                    <span style="color:white">X.X</span>Email: <input type="text" name="email" size="30" value=""><br />
                    Cell #: <span style="color:white">X.</span><input type="text" name="cell" size="20" value="">
                    Address:<span style="color:white">X</span><input type="text" name="address" size="30" value=""><br />
                    Website: <input type="text" name="website" size="20" value="">
                    Video Link:<input type="text" name="videolink" size="30" value=""><br />
                <!--    Tell us about your event. <br />  <textarea name="comment" cols="40" rows="6"></textarea> <br /> -->

                    </p>

            <div class="avails-method">
    <h3>
    Our avails method
    </h3>

If you cannot use the form below, you can <a href="mailto:adam.comedycaravan@gmail.com">email your schedule</a>. Use our notation system if you want your avails entered sooner.    

<a href="http://www.mediafire.com/file/wqyo8tpwq536048/2013_Comedy_Caravan_Avails_Sheet.doc">
                    Download</a> our 2013 avails sheet.
                    <br /><br />
For routing purposes, we want to know the dates you are NOT available and what state you'll be on those dates. <br /><br />

Below, <em>an X is already placed on open/available weeks</em>. For booked dates, please enter days booked and the state.

Example:<ul>
    <li>12-3: X (open)</li>
    <li>12-10: X 11-14 NC (open except the 10th thru 14th of Dec in NC)</li>
    <li>12-17: 19 OH, 22 IN (open except for the 19th of Dec in OH and the 22nd in IN)</li>
    <li>We are unable to work with <em>just</em> the day of the week (3/11: Thurs-Sun)</li>
    </ul>

                    </div> 
        <br class="clear" />                
    <h4>
    2013 Avails/Schedule
    </h4>

    <div class="year2013">
        <div class="jan-apr">

    1/07: <input type="text" name="1/07__" size="20" value="X"><br />
    1/14: <input type="text" name="1/14__" size="20" value="X"><br />    
    1/21: <input type="text" name="1/21__" size="20" value="X"><br />
    1/28: <input type="text" name="1/28__" size="20" value="X"><br />
    2/04: <input type="text" name="2/04__" size="20" value="X"><br />
    2/11: <input type="text" name="2/11__" size="20" value="X"><br />
    2/18: <input type="text" name="2/18__" size="20" value="X"><br />
    2/25: <input type="text" name="2/25__" size="20" value="X"><br />
    3/04: <input type="text" name="3/04__" size="20" value="X"><br />
    3/11: <input type="text" name="3/11__" size="20" value="X"><br />
    3/18: <input type="text" name="3/18__" size="20" value="X"><br />
    3/25: <input type="text" name="3/25__" size="20" value="X"><br />
    4/01: <input type="text" name="4/01__" size="20" value="X"><br />
    4/08: <input type="text" name="4/08__" size="20" value="X"><br />
    4/15: <input type="text" name="4/15__" size="20" value="X"><br />
    4/22: <input type="text" name="4/22__" size="20" value="X"><br />
    4/29: <input type="text" name="4/29__" size="20" value="X"><br />
    </div>
    <div class="may-aug">
    5/06: <input type="text" name="5/06__" size="20" value="X"><br />
    5/13: <input type="text" name="5/13__" size="20" value="X"><br />
    5/20: <input type="text" name="5/20__" size="20" value="X"><br />
    5/27: <input type="text" name="5/27__" size="20" value="X"><br />
    6/03: <input type="text" name="6/03__" size="20" value="X"><br />
    6/10: <input type="text" name="6/10__" size="20" value="X"><br />
    6/17: <input type="text" name="6/17__" size="20" value="X"><br />
    6/24: <input type="text" name="6/24__" size="20" value="X"><br />
    7/01: <input type="text" name="7/01__" size="20" value="X"><br />
    7/08: <input type="text" name="7/08__" size="20" value="X"><br />
    7/15: <input type="text" name="7/15__" size="20" value="X"><br />
    7/22: <input type="text" name="7/22__" size="20" value="X"><br />
    7/29: <input type="text" name="7/29__" size="20" value="X"><br />
    8/05: <input type="text" name="8/05__" size="20" value="X"><br />
    8/12: <input type="text" name="8/12__" size="20" value="X"><br />
    8/19: <input type="text" name="8/19__" size="20" value="X"><br />
    8/26: <input type="text" name="8/26__" size="20" value="X"><br />
    </div>
    <div class="sept-dec">
    9/02: <input type="text" name="9/02__" size="20" value="X"><br />
    9/09: <input type="text" name="9/09__" size="20" value="X"><br />
    9/16: <input type="text" name="9/16__" size="20" value="X"><br />
    9/23: <input type="text" name="9/23__" size="20" value="X"><br />
    9/30: <input type="text" name="9/30__" size="20" value="X"><br />
    10/07: <input type="text" name="10/07__" size="19" value="X"><br />
    10/14: <input type="text" name="10/14__" size="19" value="X"><br />
    10/21: <input type="text" name="10/21__" size="19" value="X"><br />
    10/28: <input type="text" name="10/28__" size="19" value="X"><br />
    11/04: <input type="text" name="11/04__" size="19" value="X"><br />
    11/11: <input type="text" name="11/11__" size="19" value="X"><br />
    11/18: <input type="text" name="11/18__" size="19" value="X"><br />
    11/25: <input type="text" name="11/25__" size="19" value="X"><br />
    12/02: <input type="text" name="12/02__" size="19" value="X"><br />
    12/09: <input type="text" name="12/09__" size="19" value="X"><br />
    12/16: <input type="text" name="12/16__" size="19" value="X"><br />
    12/23: <input type="text" name="12/23__" size="19" value="X"><br />
    NYE:<span style="color:white">..</span>   <input type="text" name="NYE__" size="19" value="X"><br />
    </div>
    </div><br class="clear" /> 
    <div class="commentsection">
    Anything else you want to add?<br />
    <textarea name="comment" cols="50" rows="6"></textarea>
    <input type="button" value="SUBMIT" onclick="hgsubmit();" >
    <input type="hidden" name="redirect" value="http://www.standupexperts.com">
  </div>
</form>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:12:44.613

```
 else if (/\S+/.test(document.hgmailer.comment.value) == false)
   alert ("Your email content is needed."); 
```

如果从表单中删除 textarea，则`document.hgmailer.comment`不再存在，因此`.value`会导致错误。所以，如果你想删除 textarea，你还必须从你的 JavaScript 中删除这个检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:13:27.983

formmail.pl 可能需要一个注释字段，否则提交将失败验证并被忽略。

现在理想情况下，您将修改 formmail.pl 以使该注释字段成为可选字段。您还可以删除文本区域并将其替换为一个`<input type="hidden" name="comment" value="" />`字段，该字段将在每次提交时包含一个空的评论字段。

~~###*有点跑题*了### 从表面上看，这个设置对我来说不是很安全。如果没有足够的安全性，这种形式最终可能会被垃圾邮件发送者滥用。主要问题是目标电子邮件地址是从垃圾邮件发送者可以轻松修改的隐藏变量发送的。主题和内容也来自形式。除非 formmail.pl 有一些反垃圾邮件措施，并且配置正确，否则最好添加安全性或使用不同的脚本。~~

没关系，我检查了一下，它只通过电子邮件发送本地地址，因此垃圾邮件的可能性很小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:17:09.700

在上面的 html 中，如果您将提交按钮`<input>`从 button 更改为 submit.it 不会停止。也可以在`firebug`chrome 或 chrome中尝试`element inspector`。

改变

```
<input type="button" value="SUBMIT" onclick="hgsubmit();" > 
```

至

```
<input type="submit" value="SUBMIT" onclick="hgsubmit();" > 
```

还编辑 javascript 以防止两次服务器请求。让 html 标记来做这些事情。

# haskell - 密码函数 :: [(Int,Char)] -> [String]

> ID：14677281
> 
> 赞同：0
> 
> 时间：2013-02-03T21:02:31.677
> 
> 标签：haskell

我想要一个带有签名 :: [(Int,Char)] -> [String] 的函数，它接受每个 Char 并根据相应对中的整数值将它们组合成一个字符串列表......

IE。

```
[(0,'A'),(1,'B'),(2,'C'),(3,'D'),(0,'E'),(1,'F'),(2,'G'),(3,'H'),(0,'I'),(1,'J'),(2,'K'),(3,'L'),(0,'M'),(1,'N'),(2,'O'),(3,'P')] 
```

应该生成列表：["MIEA","NJFB","OKGC","PLHD"]

我试过了：

```
toList :: [(Int,Char)] -> Int -> [String]
toList [] a = []
toList (x:xs) a = [snd(x) | n <-[0..(a-1)], fst(x) == n]:toList xs a 
```

但这只是给了我：

```
["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P"] 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:10:35.743

您需要按索引对输入进行排序，然后将所有具有相同索引的对分组。类似下一个：

```
map (reverse . map snd) $ groupBy ((==) `on` fst) $ sortBy (compare `on` fst) $ input 
```

无`$`运算符：

```
import Data.List
import Data.Function

toList :: [(Int, Char)] -> [String]
toList input = map (reverse . map snd) grouped
  where
  sorted = sortBy (compare `on` fst) input    -- sorted by the index
  grouped = groupBy ((==) `on` fst) sorted    -- grouped by the index 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T07:33:03.487

现在我的作业截止日期已经过去，我可以包括我的整个问题......该功能被要求将模拟的“图片”顺时针旋转 90 度。我想出的解决方案（使用简单的 Haskell 代码，因为这是我们的第一个任务）如下。虽然它适用于简单的“方形”字符串列表，但它似乎不适用于更多矩形列表......不知道为什么。

```
{- The function rotate90 rotates a "picture" (List of Strings) through
   90 degrees clockwise and prints the list to the standard output device
   using the printPicture function defined in the Thompson Picture.hs file.
-}

-- the following String list is a sample used to test implementation:
pic :: [String]
pic = [ "ABCD", "EFGH", "IJKL", "MNOP", "QRST" ]

rotate90 :: [String] -> IO ()
rotate90 aPic   = printPicture(convertToPic (listPairs aPic (maxOfList(widthOfLines aPic))     ((maxOfList(widthOfLines aPic))*(length(aPic)))) ([0..((maxOfList(widthOfLines aPic))-1)]))

-- takes a picture, the width and the number of Chars in a rectangle
-- bounding the picture (area) and converts it to a list of pairs with
-- an address and Char as per the cypher algorithm:
-- address = floor of (area -1)/ width
listPairs :: [String] -> Int -> Int -> [(Int,Char)]
listPairs [] w area = []
listPairs aPic w area   = [ (((n-1)`mod`w),(aPic!!(floor(fromIntegral(n-1)/(fromIntegral(w))))!!((n-1)`mod`w))) | n <- [1..area] ]

-- takes a list of tuples (pairs) and an Int which is the width of the input picture
-- it retunrs a list of Strings that correspond to the groupings of the pairs.
convertToPic :: [(Int,Char)] -> [Int] -> [String]
convertToPic [] (y:ys)  = []
convertToPic somePair []    = []
convertToPic somePair (y:ys)= reverse([ snd(x) | x <- somePair, ((fst(x)) == y)]):(convertToPic somePair ys)

-- takes a list of Int and returns the maximum value from the list as an Int
maxOfList :: [Int] -> Int
maxOfList []        = 0
maxOfList (x:xs)        = max x (maxOfList xs)

-- takes a list of type String and returns a list of Int of the length of each string
widthOfLines :: [String] -> [Int]
widthOfLines []     = []
widthOfLines (x:xs)     = (length x):(widthOfLines xs)

-- definition from Thompson (textbook) picture.hs file
printPicture :: [String] -> IO ()
printPicture = putStr . concat . map (++"\n") 
```

# javascript - JqPlot 图太宽

> ID：14677282
> 
> 赞同：1
> 
> 时间：2013-02-03T21:02:33.203
> 
> 标签：javascript, html, width, jqplot

我正在使用 JqPlot 并且对图形的宽度有疑问。这是显示时的图形图像：

![分区图像](../Images/c397fd2f897d27b858c8b77935bcaa2b.png)

图表有点太宽了。我能帮我把它的宽度缩小一点吗？这是DIV代码：

```
<div id="box6">
<div class="extrawidechartbox">
    <div id="totalTakings" style="margin: 20px 0; width:1000px; height:500px;"></div>
    <table style='width: 1000px; margin: 0 20px'> 
                <thead> 
                <tr> 
                    <th>Select</th> 
                    <th>Day</th>                
                </tr> 
                </thead> 
                <tbody> 

    <? //print_r($takingsArray); ?>         
    <tr>
        <td width='30'><input type='checkbox' name='day_name0' class='daycheck' value='0' <? echo ($takingsArray[0]=='no data')?' disabled ':''; ?>></td>
        <td align='left' width='80' class='day'><a href='#' style='color:#329dd5;font-weight:bold'>Week Totals</a></td>
    </tr>
    <tr>
        <td width='30'><input type='checkbox' name='day_name1' class='daycheck' value='1' checked <? echo ($takingsArray[1]=='no data')?' disabled ':''; ?>></td>
        <td align='left' width='80' class='day'><a href='#' style='color:#0d8e17;font-weight:bold'>Monday</a></td>
    </tr>
    <tr>
        <td width='30'><input type='checkbox' name='day_name2' class='daycheck' value='2' checked <? echo ($takingsArray[2]=='no data')?' disabled ':''; ?>></td>
        <td align='left' width='80' class='day'><a href='#' style='color:#f47320;font-weight:bold'>Tuesday</a></td>
    </tr>
    <tr>
        <td width='30'><input type='checkbox' name='day_name3' class='daycheck' value='3' checked <? echo ($takingsArray[3]=='no data')?' disabled ':''; ?>></td>
        <td align='left' width='80' class='day'><a href='#' style='color:#7678ab;font-weight:bold'>Wednesday</a></td>
    </tr>
    <tr>
        <td width='30'><input type='checkbox' name='day_name4' class='daycheck' value='4' checked <? echo ($takingsArray[4]=='no data')?' disabled ':''; ?>></td>
        <td align='left' width='80' class='day'><a href='#' style='color:#ecd77e;font-weight:bold'>Thursday</a></td>
    </tr>
    <tr>
        <td width='30'><input type='checkbox' name='day_name5' class='daycheck' value='5' checked <? echo ($takingsArray[5]=='no data')?' disabled ':''; ?>></td>
        <td align='left' width='80' class='day'><a href='#' style='color:#84b586;font-weight:bold'>Friday</a></td>
    </tr>
    <tr>
        <td width='30'><input type='checkbox' name='day_name6' class='daycheck' value='6' checked <? echo ($takingsArray[6]=='no data')?' disabled ':''; ?>></td>
        <td align='left' width='80' class='day'><a href='#' style='color:#bc8b7c;font-weight:bold'>Saturday</a></td>
    </tr>
    <tr>
        <td width='30'><input type='checkbox' name='day_name7' class='daycheck' value='7' checked <? echo ($takingsArray[7]=='no data')?' disabled ':''; ?>></td>
        <td align='left' width='80' class='day'><a href='#' style='color:#015253;font-weight:bold'>Sunday</a></td>
    </tr>
    </tbody> 
    </table>        
</div> 
```

```
div id="totalTakings" is the code that actually contains the graph. 
```

这应该很简单，但我找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T08:04:50.603

您可以应用特定的图表大小。我在这里提出了一个关于这个主题的问题：[JqPlot：为不包括 y 轴标签的图形区域设置固定高度值](https://stackoverflow.com/questions/11229577/jqplot-set-a-fix-height-value-for-the-graph-area-not-including-y-axe-labels)

解决方案是使用精确的图表大小重新绘制，如下所示：

```
var w = parseInt($(".jqplot-yaxis").width(), 10) + parseInt($("#chart").width(), 10);
var h = parseInt($(".jqplot-title").height(), 10) + parseInt($(".jqplot-xaxis").height(), 10) + parseInt($("#chart").height(), 10);
$("#chart").width(w).height(h);
plot.replot(); 
```

# php - 在表单提交时生成过期 URL

> ID：14677284
> 
> 赞同：1
> 
> 时间：2013-02-03T21:02:39.333
> 
> 标签：php, amazon-s3, form-submit

我编写了一个小的 PHP 代码，它为存储在我的 S3 帐户上的文件生成一个过期 URL。我现在拥有代码的方式我相信它设置了页面加载的到期时间（处理 PHP 时）。

我需要到期时间才能开始提交表单（我使用表单按钮作为下载按钮，操作设置为下载 url）。

因此，当有人点击下载时，会生成链接并设置到期时间。

我想我需要从 action="" 表单调用链接生成代码，但不知道我会怎么做？

我的代码如下：

```
<?php
                // Grab the file url
                $file_url = get_post_meta($post->ID, 'file_url', true);
                // Grab just the filename with extension
                $file = basename($file_url); 

                // AWS details                  
                $accessKey = "<REMOVED>";
                $secretKey = "<REMOVED>";
                $bucket = "media.themixtapesite.com";

                // Set expiry time
                $timestamp = strtotime("+30 seconds");
                $strtosign = "GET\n\n\n$timestamp\n/$bucket/$item";

                // Generate Signature
                $signature = urlencode(base64_encode(hash_hmac("sha1", utf8_encode($strtosign), $secretKey, true)));

                // Create new S3 Expiry URL
                $download_url = "http://$bucket/$file?AWSAccessKeyId=$accessKey&Expires=$timestamp&Signature=$signature";
                ?>

                <?php if (is_user_logged_in()) { ?>
                <div class="download_button_div">

<?php echo '<form method="post" action="'.$download_url.'" class="download_button_div">'; ?>

<!--Download counter-->
                    <input type="hidden" name="download_counter" value="<?php (int)$download_count = get_post_meta($post->ID, 'download_counter', true);
    $download_count++;
    update_post_meta($post->ID, 'download_counter', $download_count); ?>">
                    <button type='submit' class='download_button'>Download</button>
                    </form>
                    </div>
                    <?php } else { ?> 
```

一如既往，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T21:42:31.233

当他们单击链接（提交表单）时，您可以执行同步 ajax 请求以获取新签名。

您需要将此 JavaScript 放在表单页面上。

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript">
var form = null;
$(document).ready(function(){
    $('form.download_button_div').submit(function(){
        form = $(this);
        var ival = form.children('[name=item]').val();
        $.ajax('ajax_sig.php', { type:'POST', async:false, dataType:'json', data:{'itm':ival}, success:function(data){
            form.prop('action', form.prop('action').replace(/Signature=.+$/, 'Signature='+data.sig));
        } });
        return true;
    });
});
</script> 
```

您需要使用表单中的 $item 添加此隐藏输入。

```
<input type="hidden" name="item" value="<?php echo $item; ?>" /> 
```

您将需要制作 ajax_sig.php 页面。

```
<?php
// Item from ajax request
$item = $_POST['itm'];

// AWS details                  
$secretKey = "<REMOVED>";
$bucket = "media.themixtapesite.com";

// Set expiry time
$timestamp = strtotime("+30 seconds");
$strtosign = "GET\n\n\n$timestamp\n/$bucket/$item";

// Generate Signature
$signature = urlencode(base64_encode(hash_hmac("sha1", utf8_encode($strtosign), $secretKey, true)));

// Ajax result
$result = array('itm'=>$item, 'sig'=>$signature);
echo json_encode($result);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T11:10:28.640

我打算给出一个更复杂的解决方案，但我想到了一个更简单的方法。将到期时间设置为 +300（给他们 5 分钟左右的时间来完成表格）。您将检查目标页面上的签名。如果信号不好，那么您就不要提供文件。如果 sig 是好的，那么你检查当前时间是否超过了到期时间。如果是这样，那么不要提供文件。

# scala - Scala控制台不起作用，IntelliJ

> ID：14677285
> 
> 赞同：44
> 
> 时间：2013-02-03T21:02:41.073
> 
> 标签：scala, ide, console, intellij-idea

我做了所有的偏好工作，安装了 scala，除此之外一切正常，我只是无法在控制台窗口中测试 scala 类。

在教程中，我看到他们只是在 scala> 后面输入了一些东西，但它不起作用，我可以在下面输入一些随机的东西，当我按下回车键时它不会做任何事情。

你们能帮帮我吗？我将非常感谢。干杯

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2013-02-20T11:13:51.617

在 IntelliJ Community Edition 的 Scala 控制台上键入后。点击`Ctrl`+`Enter`而不是 enter 来执行。

我花了一段时间来解决它:)

> > > [IntelliJ 和使用 Scala 工作表](https://confluence.jetbrains.com/display/IntelliJIDEA/Working+with+Scala+Worksheet)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-04-13T15:51:56.527

如果您希望控制台在您按 Enter 时执行，请转到`Preferences > Keymap > Plug-ins > Scala`，然后右键单击`ScalaConsole.Execute`。在第一个框中选择`Add Bookmark`并按 Enter。然后单击`Apply`，然后单击`OK`。 ![在此处输入图像描述](../Images/2d45dadf16cbc03c5eda25a4576d1305.png)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-03-28T15:49:29.507

完成输入后，您必须在 Mac OS X 上按 ⌘-Enter。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-23T21:20:02.517

我想最好将消息从“输入表达式以对其进行评估”更改。到“输入表达式并按 Ctrl + Enter 对它们进行评估。”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-28T07:15:53.443

只需将 scala 源添加到 $PATH ，它应该可以从 CMD / Idea Terminal 获得/调用

# shell - “expect”匹配“send”字符串，为什么？

> ID：14677286
> 
> 赞同：2
> 
> 时间：2013-02-03T21:02:44.997
> 
> 标签：shell, terminal, tcl, expect

我发现在**发送**命令匹配来自**发送**命令的数据之后的**期望**命令。

 ****让我们看看，*my.sh*：

```
#!/bin/sh
read line
echo ok 
```

*my.exp*（有些代码是多余的，我模拟 DejaGNU 测试框架...）：

```
set passn 0
proc pass {msg} { global passn; incr passn; send_user "PASS: $msg\n" }
set failn 0
proc fail {msg} { global failn; incr failn; send_user "FAIL: $msg\n" }
proc check {} {
    global passn failn;
    send_user "TOTOAL: [expr $passn + $failn], PASSED: $passn, FAIL: $failn\n"
    if {$failn == 0} { exit 0 } { exit 1 }
}

set timeout 1

spawn ./my.sh

send hello\n
expect {
    -ex hello {
        send_user "~$expect_out(0,string)~\n"
        pass hello
    }
    default { fail hello }
}
expect {
    -ex ok { pass ok }
    default { fail ok }
}

check 
```

运行时*期望 my.exp*我得到：

```
生成 ./my.sh
你好
~你好~
通过：你好
好的
通过：好的
总计：2，通过：2，失败：0

```

我不明白为什么*你好*匹配！请告诉我。我已经重读了：

*   [http://expect.sourceforge.net/FAQ.html](http://expect.sourceforge.net/FAQ.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T21:17:24.997

`expect`适用于 [伪终端设备](http://linux.die.net/man/7/pty)。它们很像普通终端：除非您禁用 echo（使用 expect 的 `stty`命令），否则您发送的任何内容也将作为您的“终端输出”（即 expect 的输入）可见。

`stty_init`expect 使用变量来设置新创建的伪终端。如果添加`set stty_init -echo`到 的开头 `my.exp`，测试将开始失败。****

# python - 大数据多处理

> ID：14677287
> 
> 赞同：24
> 
> 时间：2013-02-03T21:02:57.020
> 
> 标签：python, multiprocessing, generator

我正在使用`multiprocessing.Pool()`并行化一些繁重的计算。

目标函数返回大量数据（一个巨大的列表）。我的内存快用完了。

如果没有`multiprocessing`，我只需将目标函数更改为生成器，通过`yield`一个接一个地生成结果元素，因为它们是计算出来的。

我知道多处理不支持生成器——它等待整个输出并立即返回，对吗？没有屈服。有没有办法让`Pool`工作人员在数据可用时立即生成数据，而无需在 RAM 中构建整个结果数组？

简单的例子：

```
def target_fnc(arg):
   result = []
   for i in xrange(1000000):
       result.append('dvsdbdfbngd') # <== would like to just use yield!
   return result

def process_args(some_args):
    pool = Pool(16)
    for result in pool.imap_unordered(target_fnc, some_args):
        for element in result:
            yield element 
```

这是 Python 2.7。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-03T21:21:07.723

这听起来像是队列的理想用例：http: [//docs.python.org/2/library/multiprocessing.html#exchanging-objects-between-processes](http://docs.python.org/2/library/multiprocessing.html#exchanging-objects-between-processes)

只需将您的结果从池中的工作人员中输入队列，然后将它们摄取到主服务器中。

请注意，除非您排空队列的速度几乎与工作人员填充队列的速度一样快，否则您仍然可能会遇到内存压力问题。您可以限制队列大小（队列中可以容纳的最大对象数），在这种情况下，池中的工作人员将阻塞`queue.put`语句，直到队列中有可用空间。这将对内存使用设置上限。 *但*如果你这样做，可能是时候重新考虑是否需要池化和/或使用更少的工人是否有意义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T22:46:28.430

根据您的描述，听起来您对处理传入的数据并没有那么感兴趣，而是避免将一百万个元素`list`传回。

有一种更简单的方法：只需将数据放入文件中即可。例如：

```
def target_fnc(arg):
    fd, path = tempfile.mkstemp(text=True)
    with os.fdopen(fd) as f:
        for i in xrange(1000000):
            f.write('dvsdbdfbngd\n')
    return path

def process_args(some_args):
    pool = Pool(16)
    for result in pool.imap_unordered(target_fnc, some_args):
        with open(result) as f:
            for element in f:
                yield element 
```

显然，如果您的结果可以包含换行符，或者不是字符串等，您将希望使用`csv`文件 a`numpy`等而不是简单的文本文件，但想法是相同的。

话虽如此，即使这更简单，一次处理数据块通常也有好处，因此`Queue`如果有缺点（分别，需要一种方法来分解任务，或者必须能够像生成数据一样快地使用数据）不是交易破坏者。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-03T22:33:24.693

如果你的任务可以以块的形式返回数据……它们可以分解成更小的任务，每个任务都返回一个块吗？显然，这并不总是可能的。如果不是，则必须使用其他一些机制（如`Queue`Loren Abrams 建议的 a ）。但是当它*是*时，由于其他原因，它可能是一个更好的解决方案，以及解决这个问题。

以你的例子，这当然是可行的。例如：

```
def target_fnc(arg, low, high):
   result = []
   for i in xrange(low, high):
       result.append('dvsdbdfbngd') # <== would like to just use yield!
   return result

def process_args(some_args):
    pool = Pool(16)
    pool_args = []
    for low in in range(0, 1000000, 10000):
        pool_args.extend(args + [low, low+10000] for args in some_args)
    for result in pool.imap_unordered(target_fnc, pool_args):
        for element in result:
            yield element 
```

`zip`（如果您愿意，您当然可以用嵌套理解或and替换循环`flatten`。）

所以，如果`some_args`是`[1, 2, 3]`，你会得到 300 个任务——<code>[[1, 0, 10000], [2, 0, 10000], [3, 0, 10000], [1, 10000, 20000], ...] , 每个只返回 10000 个元素而不是 1000000。

# mysql - 如何使表中的字段引用 MySQL/MariaDB 中的另一个表？

> ID：14677288
> 
> 赞同：4
> 
> 时间：2013-02-03T21:02:57.530
> 
> 标签：mysql

假设我正在建立一个只有 2 个表的小型数据库：提要和提要项。

在一个表中，我将存储提要名称和 url，并将 ID 作为唯一键。

在第二个表中，我想存储一些来自提要项目的信息（例如：日期、标题、项目的 url 和提要名称）。但我不想存储提要名称，而是将此提要字段引用到第一个表中该提要的 ID。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T21:29:26.593

这是如何实现您的要求的快速示例...

```
CREATE TABLE IF NOT EXISTS `feeds` (
  `Feed_ID` int(11) NOT NULL,
  `Feed_Name` varchar(32) NOT NULL,
  `Feed_Url` varchar(255) NOT NULL,
  PRIMARY KEY (`Feed_ID`)
)

CREATE TABLE IF NOT EXISTS `feeditems` (
  `FeedItem_ID` int(11) NOT NULL,
  `Feed_ID` int(11) NOT NULL,
  `FeedItem_Date` datetime NOT NULL,
  `FeedItem_Title` varchar(255) NOT NULL,
  `FeedItem_Url` varchar(255) NOT NULL,
  `FeedItem_Name` varchar(255) NOT NULL,
  PRIMARY KEY (`FeedItem_ID`),
  FOREIGN KEY (`Feed_ID`) REFERENCES `feeds`(`Feed_ID`)
                      ON DELETE CASCADE
) 
```

# extjs - Ext.chart.Chart (ext-js 4) 中的自定义提示

> ID：14677290
> 
> 赞同：1
> 
> 时间：2013-02-03T21:03:18.447
> 
> 标签：extjs, tooltip

我想重现这样的东西（就 而言`Ext.chart.Tip`）：

![垂直线提示](../Images/da157391ed177c55c7e8f4a0a0db126d.png)

在*ext-js 4*中。问题是我不知道从哪里开始。实现这一结果的最有效方法是什么？

# javascript - 在 Phonegap 中使用 JQuery 调用基于 SOAP 的 Web 服务

> ID：14677298
> 
> 赞同：0
> 
> 时间：2013-02-03T21:04:21.393
> 
> 标签：javascript, android, html, jquery, cordova

我有一个关于通过**Jquery**调用网络服务的大问题。

我现在正在开发一个与**Android 应用**程序相同的**phonegap 应用**程序。我必须调用一个网络服务并从那里获取数据。我试图以我的方式解决它，但我没有找到合适的解决方案。

 **我的**网络服务**是**使用 SOAP 在 .NET**中构建的。现在我想**使用 jquery 通过我的 HTML 页面**调用该 Web 服务。所以，请帮我解决这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T05:19:42.850

这是我从研究中获得的一些链接

[谷歌群phonegap群讨论](https://groups.google.com/forum/#!topic/phonegap/i1iyoWRqu0k)

[黑莓支持论坛](http://supportforums.blackberry.com/t5/Web-and-WebWorks-Development/How-to-call-soap-based-web-service-in-phone-gap/td-p/1909183)

[另一个谷歌小组讨论](https://groups.google.com/forum/?fromgroups=#!topic/phonegap/3xzY5B7cXPk)

以下是一些堆栈溢出问题的答案，可能可以解决您的问题，

[如何在 iPhone 中使用 PhoneGap 调用基于 SOAP 的 Web 服务？](https://stackoverflow.com/questions/5974295/how-call-soap-based-web-service-using-phonegap-in-iphone)

[如何在 Android 中使用 PhoneGap 和 jQuery 调用基于 SOAP 的 Web 服务？](https://stackoverflow.com/questions/7383265/how-call-soap-based-web-service-using-phonegap-and-jquery-in-android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T08:58:40.280

您可以使用 XMLHttpRequest 与外部域连接这是示例代码

```
 function connectXml()
        {
     var request = new XMLHttpRequest();
             var wsUrl="http://www.somedomain.com/servicexml"
     request.open("POST", wsUrl, true);
     request.onreadystatechange = function() {
     if (request.readyState == 4) {
     if (request.status == 200 || request.status == 0) {
     var data = request.responseText;

                alert(request.responseText);
                }}}} 
```

注意：在 config.xml 中授予对域的访问权限，例如：access origin="http://somedmain.com"。在 AndroidManifest.xml 中添加用户 INTERNET 权限 eg:"uses-permission android:name="android.permission.INTERNET"/uses-permission"**

# qt - 在 Qt 中使用 OpenGL 时出现链接器错误

> ID：14677304
> 
> 赞同：3
> 
> 时间：2013-02-03T21:04:50.680
> 
> 标签：qt, visual-c++, opengl, linker

我正在尝试将 OpenGL 与 Qt 一起使用。我在关注这个例子： http: [//qt-project.org/doc/qt-5.0/qtgui/openglwindow.html](http://qt-project.org/doc/qt-5.0/qtgui/openglwindow.html)使用 Qt 5 build for msvc2012。最后我收到以下错误：

1.  错误 LNK2019：未解析的外部符号 _ *imp* _glClear@4 在函数“public: virtual void __thiscall OpenGLWindow::render(void)”(?render@OpenGLWindow@@UAEXXZ) D:\Documents\Code\Qt Projects\qttest2\qttest2 中引用\openglwindow.obj qttest2
2.  错误 LNK2001：无法解析的外部符号*_imp* _glClear@4 D:\Documents\Code\Qt Projects\qttest2\qttest2\trianglewindow.obj qttest2
3.  错误 LNK2019：未解析的外部符号 _ *imp* _glDrawArrays@12 在函数“public: virtual void __thiscall TriangleWindow::render(void)”(?render@TriangleWindow@@UAEXXZ) D:\Documents\Code\Qt Projects\qttest2\qttest2 中引用\trianglewindow.obj qttest2
4.  错误 LNK2019：未解析的外部符号 _ *imp* _glViewport@16 在函数“public: virtual void __thiscall TriangleWindow::render(void)”(?render@TriangleWindow@@UAEXXZ) D:\Documents\Code\Qt Projects\qttest2\qttest2 中引用\trianglewindow.obj qttest2
5.  错误 LNK1120：3 个未解析的外部 D:\Documents\Code\Qt Projects\qttest2\Win32\Debug\qttest2.exe qttest2

我可以看到它与 OpenGL 函数的链接有关，但我对链接知之甚少。

即使我从 OpenGLWindow 示例中复制源代码，我也会收到错误消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:32:42.637

您必须添加`opengl32.lib`到链接库列表。在 QtCreator .pro 文件中添加 OpenGL 模块应该可以解决问题

```
QT += opengl 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T22:22:23.730

您是否在 pro 文件中添加了 OpenGL 模块，如下所示：

```
QT += opengl 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-31T11:59:33.947

如果您使用 Qt 5，则在项目文件 (*.pro) 中添加下一个库

```
LIBS += -LD:\Qt\5.5\mingw492_32\lib\libQt5OpenGL.a -lopengl32 
```

`D:\Qt\5.5\mingw492_32\lib\libQt5OpenGL.a`是路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-08T19:44:06.800

在linux环境[mesa]库安装可以解决这个问题。[lib32-mesa，OpenGL 规范的开源实现]

```
[pacman -S mesa ]       *Arch Linux 
[apt-get install mesa]  *ubuntu/Mint/Raspbian 
```

# python - 从 numpy 数组中提取数据

> ID：14677306
> 
> 赞同：0
> 
> 时间：2013-02-03T21:04:58.337
> 
> 标签：python, numpy

我有一个使用 numpy.loadtxt 制作的 numpy ndarray。我想根据第三列中的条件从中提取一整行。比如：如果 array[2][i] 满足我的条件，那么也得到 array[0][i] 和 array [1][i]。我是 python 的新手，以及所有 numpy 功能，所以我正在寻找最好的方法来做到这一点。理想情况下，我想一次拉 2 行，但我不会总是有偶数行，所以我想这是个问题

```
import numpy as np

'''
Created on Jan 27, 2013

@author:
'''
class Volume:

    f ='/Users/Documents/workspace/findMinMax/crapc.txt'
    m = np.loadtxt(f, unpack=True, usecols=(1,2,3), ndmin = 2)

    maxZ = max(m[2])
    minZ = min(m[2])
    print("Maximum Z value: " + str(maxZ))
    print("Minimum Z value: " + str(minZ))

    zIncrement = .5
    steps = maxZ/zIncrement
    currentStep = .5
    b = []

    for i in m[2]:#here is my problem
         while currentStep < steps: 
            if m[2][i] < currentStep and m[2][i] > currentStep - zIncrement:
                b.append(m[2][i]) 
            if len(b) < 2:
                currentStep + zIncrement

                print(b) 
```

这是我在java中做的一些代码，这是我想要的一般想法：

```
while( e < a.length - 1){
for(int i = 0; i < a.length - 1; i++){
        if(a[i][2] < stepSize && a[i][2] > stepSize - 2){

            x.add(a[i][0]);
            y.add(a[i][1]);
            z.add(a[i][2]);
        }
        if(x.size()  < 1){
            stepSize += 1;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:28:20.213

首先，您可能不想将代码放在该类定义中......

```
import numpy as np

def main():
    m = np.random.random((3, 4))
    mask = (m[2] > 0.5) & (m[2] < 0.8)  # put your conditions here
                                        # instead of 0.5 and 0.8 you can use
                                        # an array if you like
    m[:, mask]

if __name__ == '__main__':
    main() 
```

`mask`是一个布尔数组，`m[:, mask]`是你想要的数组

m[2] 是 m 的第三行。如果您键入`m[2] + 2`，您将获得一个带有旧值 + 2 的新数组。`m[2] > 0.5`创建一个带有布尔值的数组。最好用 ipython (www.ipython.org) 试试这些东西

在表达式`m[:, mask]`中，`:`意思是“获取所有行”，掩码描述了应该包含哪些列。

**更新**

下次尝试:-)

```
for i in range(0, len(m), 2):
    two_rows = m[i:i+2] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T20:51:21.037

如果你可以把你的条件写成一个简单的函数

```
def condition(value):
    # return True or False depending on value 
```

那么你可以像这样选择你的子数组：

```
cond = condition(a[2])
subarray0 = a[0,cond]
subarray1 = a[1,cond] 
```

# zend-framework - 卸载并重新安装 wamp 后无法访问 Zend 项目

> ID：14677307
> 
> 赞同：0
> 
> 时间：2013-02-03T21:04:59.803
> 
> 标签：zend-framework, wamp, wampserver

我错误地卸载了 WAMP，然后下载并重新安装了一个新的相同版本。查看 WAMP 目录后，我可以看到我的数据库仍然完好无损（我认为），我可以通过 MYSQL 客户端访问它们。但是我无法像意外卸载之前那样访问我的项目。我的项目是 Zend。我在新的 PHP 安装上设置了 PHP include_path 以指向 ZendFramework 库文件夹和 WAMP“www”文件夹。我重新创建了新的 APACHE v-hosts 来指向旧项目。这些是我记得到目前为止所做的配置。

所以我无法像在旧 WAMP 上那样访问我的 zend 项目。我觉得这是一个配置问题，因为所有项目文件和目录似乎都是完整的，就像 MYSQL 文件/目录一样。我不断得到

```
The requested URL /xyz/ was not found on this server 
```

编辑：我只能访问这些项目的主页，但不能访问其他页面/子文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T04:56:26.760

也许你有 apache 配置的问题，找到 http.conf/httpd.conf。在 http.conf 文件中找到该条目，并确保“AllowOverride”和“Options”值设置为“All”（默认情况下这些设置为 None）。您可以按照此[链接](http://thiranjith.com/2010/09/14/how-to-setup-zend-framework-with-apache-on-windows/)移至第 4 步。 apache 配置，这可能对您有所帮助。

# c++ - 有没有办法在项目中创建完整的包含和继承图？

> ID：14677308
> 
> 赞同：0
> 
> 时间：2013-02-03T21:05:00.427
> 
> 标签：c++, doxygen

我需要获取所有类的继承图并包含项目中所有文件的图。doxygen 有什么功能可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:15:33.740

您使用的是 doxywizard 还是命令行？如果您使用适当的命令行选项从项目的根目录运行它，它应该生成包含。我不记得那些是什么，但你可以看看文档： http: [//www.doxygen.nl/manual/index.html](http://www.doxygen.nl/manual/index.html)

通常，默认值就是您所需要的。如果您不熟悉 doxygen，请安装其中一个 GUI。

# sublimetext2 - 撤消单个 select_lines

> ID：14677311
> 
> 赞同：4
> 
> 时间：2013-02-03T21:05:37.993
> 
> 标签：sublimetext2, sublimetext

现在我有以下映射来选择向前的行：

`{ "keys": ["ctrl+alt+down"] , "command": "select_lines", "args": {"forward": true} }`

我想 ctrl+alt+up 简单地撤消最后一个 ctrl+alt+down。软撤消不太奏效。如果您快速选择多行，则撤消会取消选择所有行，而不是仅选择最后一行。

如果没有开箱即用的方法来做到这一点，那么也许我可以将 ctrl+alt+up 映射到一组取消选择当前行并将光标向上移动的击键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T00:58:05.890

这种行为也困扰了我很多，所以我刚刚去写了这个：[https ://github.com/kizu/undo_select_lines#readme](https://github.com/kizu/undo_select_lines#readme)

这会覆盖特定上下文中的“软撤消”操作，因此它实际上会“撤消”单个`select_lines`.

唯一的缺点是不会重做，历史会有点脏，但不管它是否有效。

因此，如果您没有在键绑定中覆盖软撤消，请通过 git 在您的包中安装此命令：

`git clone git://github.com/kizu/undo_select_lines.git`

或者在[那里](https://github.com/kizu/undo_select_lines/tags)下载。

会为你解决这个问题。否则，请查看它是如何在源代码中实现的，因此您应该替换“软撤消”的键绑定。

# javascript - jQuery - 许多切换滑块，当时只有一个可见

> ID：14677314
> 
> 赞同：1
> 
> 时间：2013-02-03T21:05:51.263
> 
> 标签：javascript, jquery

我在一个页面中有四个 jquery 滑块，其中包含以下脚本：

```
$(document).ready(function(){
  $("#information").click(function(){
    $("#information_show").slideToggle("medium");
  });
});

$(document).ready(function(){
  $("#menu").click(function(){
    $("#menu_slide").slideToggle("medium");
  });
});

$(document).ready(function(){
  $("#books").click(function(){
    $("#books_toggle").slideToggle("medium");
  });
});

$(document).ready(function(){
  $("#content").click(function(){
    $("#content_div").slideToggle("medium");
  });
}); 
```

因此，例如，当我单击 div 时`#information`，它`#information_toggle`是可见的。如果有任何方法可以使滑块一次只显示一个，我会很高兴。

示例：当点击 时`#books`，`#books_toogle`显示。现在当点击节目时`#menu`，`#menu_slide`同时`#menu_slide`节目`#books_toggle`自动切换/关闭。所以一次只会显示一个隐藏的 div。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:09:58.677

虽然它应该发布在 CodeReview(imho) 上，但你可以这样做：

```
$(document).ready(function () {
    var last, last2;
    $("#information").click(function () {
        $("#information_show").slideToggle("medium");
        if (last != '#information_show' && last != last2) $(last).slideToggle("medium");
        last2 = last;
        last = '#information_show';
    });
    $("#menu").click(function () {
        $("#menu_slide").slideToggle("medium");
        if (last != '#menu_slide' && last != last2) $(last).slideToggle("medium");
        last2 = last;
        last = '#menu_slide';
    });
    $("#books").click(function () {
        $("#books_toggle").slideToggle("medium");
        if (last != '#books_toggle' && last != last2) $(last).slideToggle("medium");
        last2 = last;
        last = '#books_toggle';
    });
    $("#content").click(function () {
        $("#content_div").slideToggle("medium");
        if (last != '#content_div' && last != last2) $(last).slideToggle("medium");
        last2 = last;
        last = '#content_div';
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:12:26.990

查看您的 html 会有所帮助，但很容易以一种丑陋的方式做到这一点：

```
$("#information").click(function(){
    $("#information_show").slideToggle();
    $("menu_slide, books_toggle, content_div").slideUp();
}); 
```

然而，一个更漂亮的方法是使用类：

```
$(".slider").on('click', function () {
    var $assocDiv = $(".slider_show").eq($(this).index));
    $assocDiv.slideToggle();
    $(".slider_show").not($assocDiv).slideUp();      
}); 
```

无论如何，你只需要一个`$(document).ready`，它可以写成`$(`，并且`'medium'`已经是默认的动画速度。

# ios - 如何阅读 plist

> ID：14677318
> 
> 赞同：1
> 
> 时间：2013-02-03T21:06:24.807
> 
> 标签：ios, objective-c, if-statement, plist

我是新手`objective C`，我想阅读一个 plist，而不是说字符串是否有这个值，做这个和这个。

我试过这个：

```
NSString *filePath = @"E/eg.plist";  
NSMutableDictionary* plistDict = [[NSMutableDictionary alloc] 
                                  initWithContentsOfFile:filePath];
NSString *value;value = [plistDict 
objectForKey:@"lang"];
if (NSString *value = @"1") {
     mySwitch3.on = YES;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T21:15:07.430

这是您获取给定键的值并将其与另一个字符串进行比较的方式。

```
NSMutableDictionary *plistDict = [[NSMutableDictionary alloc] initWithContentsOfFile:filePath];
NSString *value = [plistDict objectForKey:@"lang"];
if ([value isEqualToString:@"1"]) {
    mySwitch3.on = YES;
} 
```

有关 Objective-C 的更多信息：[学习 Objective-C A Primer](https://developer.apple.com/library/mac/#referencelibrary/GettingStarted/Learning_Objective-C_A_Primer/)

和 Plist 编程：[PropertyLists](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/PropertyLists/Introduction/Introduction.html)

# ios - Xcode 从@2x 版本创建的非视网膜图像的质量如何？

> ID：14677319
> 
> 赞同：3
> 
> 时间：2013-02-03T21:06:49.690
> 
> 标签：ios, xcode, image, retina-display

由于我被告知当我的项目中只有@2x 表单时，Xcode 会自动将图像缩小到非视网膜，因此似乎没有必要创建另一个图像。这让我创建了没有非视网膜图像的应用程序。

但是最近我讨论了这个问题，并被告知如果我不单独保存非视网膜图像，图像的质量（在非视网膜设备上）将不会那么好。

这是真的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T21:16:26.087

是的，确实如此，质量不会那么好，但出于其他一些原因，仅使用 @2x 也不是一个好主意。

1.  视网膜图像的简单调整大小可能不是保持图像语义的最佳方式。例如，一个图标在@2x 中的正确尺寸可能看起来很棒，但是当尺寸减小时，很难区分图标是什么。这样，您的常规大小的图像可能是一个稍微不同的图标，它的分辨率较低，但更容易确定其含义。

2.  图像在使用时保存在内存中。@2x 图像的分辨率是普通图像的 4 倍，因此将占用大约 x4 的内存。iPad 1 和 3GS 等设备（具有非视网膜显示屏）的内存量有限，而且没有多少空闲空间。因此，视网膜图像将占用更多可用内存，您的应用程序/设备将无法正常运行。

3.  与第 1 点类似，但为使@2x 图像正确适合 1x 屏幕而进行的调整大小非常幼稚，并且没有执行任何采样以使图像看起来不错。例如，当缩小图像时，图像可能非常混叠和粗糙。如果您有一个从@2x 版本派生的常规图像文件，您可以执行自己的采样和分辨率降低方法，以确保它看起来像您想要的那样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T21:18:51.963

对于我们的 iOS 应用程序，我们有一个（过分）痴迷的设计师，他花了很多时间独立地为视网膜和非视网膜分辨率设计资产，我问他为什么他在每个方面都花这么多时间，而不是基本上“缩小/放大”。他有一些很好的观点，**“如果你想让你的资产在视网膜和非视网膜上看起来都很好，你需要一个人来对你的资产路径/轮廓做出明智的决定”**。

以一个 57x57 的按钮或图标为例，它有一个 2 像素的外边框、一个 4 像素的白色内边框和一个阴影。如果您只是将其缩放到 114x114，那么这些边框的“路径”或线条将缩放到 4px 和 8px，这可能会导致两个问题

*   在新尺寸下，4px 和 8px 可能**太厚了**，您需要查看资产并确定 3px 和 5px 可能更有意义
*   角落的抗锯齿可能不再正确，它们可能太厚或太薄

他向我展示了如果你只是放大/缩小资产的样子，而他实际上花时间对其进行微调，这是一个非常显着的差异。[他的很多观点都在这篇文章](http://bjango.com/articles/designingforretina2/)中得到了很好的总结

# html - firefox html登录表单问题？

> ID：14677320
> 
> 赞同：0
> 
> 时间：2013-02-03T21:07:01.357
> 
> 标签：html, firefox

我需要帮助，我正在尝试解决这个问题，但我不知道问题是什么。

基本上我有这个登录表单：

```
<form id="myform" action="login.php" method="post" class="loginform">

Email
  <input type="email" name="email" maxlength="30" placeholder="john.smith@example.com" />

Password
<input type="password" name="password" maxlength="30" placeholder="*****" />

<input type="image" src="../PTB1/assets/img/icons/loginarrow1.png" name="submit" class="loginbutton"/>

            </form> 
```

它适用于除 Firefox 之外的所有浏览器。

出于某种原因，我将其缩小到用于提交按钮的图像，因为如果我使用下面的这个表单，那么 firefox 可以正常工作并登录，但它与上面的那个不一样。有什么想法有什么问题吗？谢谢。

```
 <form action="login.php" method="post">

    Email:
    <input type="email" id="email" name="email" placeholder="john.smith@example.com" />

    Password:
    <input type="password" id="password" name="password" placeholder="Password" />
    <input type="submit" name="submit" value="Login &gt;" />

</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:13:08.293

[http://www.onenaught.com/posts/382/firefox-4-change-input-type-image-only-submits-x-and-y-not-name](http://www.onenaught.com/posts/382/firefox-4-change-input-type-image-only-submits-x-and-y-not-name)这可能回答你的问题吗？您是否正在寻找提交名称以处理您的请求？

# asp.net-mvc - 我什么时候将我的特定数据访问逻辑放在我的 MVC 模型中？

> ID：14677323
> 
> 赞同：0
> 
> 时间：2013-02-03T21:07:06.447
> 
> 标签：asp.net-mvc, entity-framework, model-view-controller, separation-of-concerns

开箱即用，当您使用 Entity Framework 在 MVC 中创建控制器时，您将获得将数据拉入控制器以显示到视图中的基本 Get 语句。例如：

```
 public ActionResult Index()
    {
        var capsules = db.capsules.ToList();
        return View(capsules);
    } 
```

我理解它的方式，编写 MVC 代码的最佳方式是将您的数据特定逻辑放入模型项目中。然后，控制器在您拥有逻辑的任何模型类中调用该方法，检索数据，然后将其发送到视图。上面的例子只是简单地检索一个胶囊列表——非常基本。我没有创建一个特殊的“CapsuleModelContext”类来处理胶囊检索操作，因为它正在我的 edmx 文件中处理。

我想这一切都归结为我是否应该在控制器或模型的上下文类中实例化 dbContext 的问题。开箱即用，dbContext 在控制器内部实例化。对这里的最佳实践有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T22:03:40.040

请区分您的**领域模型**和**视图模型**。您的视图模型*不负责持久化数据*。您的视图模型只是作为实体的容器存在，这些实体可以传入和传出您的视图。很简单，它们是视图的模型——而不是视图旨在操作的持久数据。

考虑到这一点，您应该使用**控制器**与您用来操作持久数据的任何实体进行交互（无论是存储库还是 - 更直接地 - 数据库上下文）。视图模型用作将数据从**视图**传递到**控制器**的媒介，控制器又将字段映射到它所属的任何业务实体，并与您选择的持久性方法进行交互。视图模型和您的业务实体模型应该相互不了解。

您的视图模型应该包含的唯一逻辑（理想情况下应该保持在最低限度）是显然只特定于该视图模型本身的逻辑。

我发布了对类似问题的另一个答案，它展示了它在实践中的工作原理：

[TextBoxFor() 不生成验证标记](https://stackoverflow.com/questions/14531644/textboxfor-not-generating-validation-markup/14531849#14531849)

# ios - 强制 iOS 重新计算滑动菜单所需的窗口大小

> ID：14677325
> 
> 赞同：1
> 
> 时间：2013-02-03T21:07:16.717
> 
> 标签：ios, css, mobile

所以我以前在移动浏览器上看到过这个问题，通常只是忽略它。当您拥有一个元素（我认为它的位置并不重要）并将其移出可视区域时，移动浏览器（在我的测试用例 safari 中）添加了滚动到它的能力。我正在制作一个与 mashable.com 网站上几乎相同的滑出菜单。基本上，菜单在主要内容后面是 z-indexed。在点击菜单按钮时，主要内容会向右转换 CSS 以显示菜单。然而，在它滑回之后，iOS 会“记住”屏幕外有一个元素，并且仍然允许用户向右滚动，即使那里什么也没有。

有没有办法（我假设通过 javascript）强制移动浏览器重新计算可视区域或元素所在的位置。一些我可以触发的事件之类的。我一辈子都无法摆脱这个问题。菜单正常工作。我目前的“修复”是防止在触摸移动时向左滑动事件的默认行为。然而，使用这种方法可能会阻止我做我计划的其他事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T14:16:07.547

我通过将内容设置为 99.9% 宽度来解决它，并在几毫秒后再次删除宽度。

```
// on closing menu:
if(panel==='closing'){
    $("#content").css('width','99.9%');
    setTimeout(function() {
        $("#content").css('width','');
    },100);
} 
```

# asp.net - 无效的回发或回调参数

> ID：14677328
> 
> 赞同：4
> 
> 时间：2013-02-03T21:07:43.770
> 
> 标签：asp.net, windows, iis

这是错误

> 无效的回发或回调参数。使用配置或页面中的 <%@ Page EnableEventValidation="true" %> 启用事件验证。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用 ClientScriptManager.RegisterForEventValidation 方法注册回发或回调数据以进行验证。

我也经常得到这些

> 此页面的状态信息无效，可能已损坏。

我已经阅读了大约 20 个其他“无效回发或回调参数”问题和答案，我认为我的问题不属于任何常见类别：

*   动态客户端创建或更改 ASP.NET 不知道的控件
*   用户提交代码或代码位，例如“<”和“>”字符
*   在每个 Page_Load 事件中绑定数据而不明智地使用 if (!IsPostBack)
*   错误的 AJAX CascadingDropDown 扩展器
*   俄罗斯人试图入侵您的网站（！）
*   拨号用户的间歇性问题 (!)
*   ASP.NET 版本之间的不匹配，例如同时使用 ASP.NET 1.1 和 2.0 的服务器场

我认为我的问题与此列表中的最后一个问题最相似。

在表单回发时，我在我的 2 Microsoft Azure Web 服务器负载平衡测试环境中间歇性地（但经常）遇到错误。

我注意到当其中一个服务器生成的页面被回发到另一个时，就会出现问题。当我取消负载平衡（仅访问一台服务器）时，问题就消失了。

我在一个 Web 服务器上使用 Win Server 2008 R2 (IIS7.5)，在另一个 Web 服务器上使用 Win Server 2012 (IIS8)（我对 2008 很熟悉，对 2012 很警惕，但我想学习，所以我选择运行其中一个每个人都可以对冲我的赌注，以防您想知道）。

2008 机器运行 ASP.NET 版本“4.0.30319.272 **”**，2012 机器运行“4.0.30319.18010 **”**，但显然 IIS 版本不同。

但它们都在运行 ASP.NET 4.0。.NET 应该使底层操作系统透明，对吗？所以我不太确定这是导致问题的原因。

重新构建一台服务器以使它们相同将是一件苦差事，如果 ASP.NET 的细微差异不是问题的原因，则宁愿避免它！

那么两个服务器在回发时不接受彼此的表单还有其他原因吗？仅供参考，我已经在两台服务器上的 web.config 中添加了一个条目，以修复我遇到的“视图状态 MAC 验证失败”错误。

或者我可以做任何配置更改以使服务器更兼容？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:32:32.960

所以我花了半天的时间重新构建我的网络“农场”并让两台服务器都是 2008R2，问题就消失了！

我的（暂定）结论是，服务器 2008R2 与 2012 上的 .NET 4.0.30319... 版本之间的视图状态处理之间的差异（包括完全不同的`__EVENTVALIDATION`格式）是问题的原因。

我不能确定这一点，因为我设置 2012 服务器的方式可能与 2008R2 服务器不同。但是，在构建 2012 服务器时，我相当严格地遵循了我编写的 2008R2 构建文档，因此，以及我花了 2 天时间修补构建以使其工作，提高了我的信心，我没有错过一些明显的东西。

故事的寓意（大约 80% 的置信度）：不要在 ASP.NET 部署中混合服务器版本，即使 .NET 的版本相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-24T18:57:18.677

我有同样的问题农场系统。我测试了几种解决方案，并且有效的是：

*   在一个系统上生成 machineKey，然后复制到另一个系统。（我在几个论坛中找到了这个解决方案，但它本身不起作用）
*   把同类型的兼容性。对我来说，它是“Framework45”。（从此配置开始工作）。

例子：

```
<system.web>
...
<machineKey compatibilityMode="Framework45" decryptionKey="808A25F38661B8799CFD5B6FC5CF73D2988F5786CE46075D" validationKey="B75D59843CA111DF8596FCF865D9C0459B63B6ED474D4B23FD63A5F3A5AB18560A0D2A162191EC3354650CB37B174DDE187B29D424FC5CF60EFDA567BA64D3A3" />
...
</system.web> 
```

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2013-02-04T11:01:34.770

尝试在您的页面指令中添加以下内容 -

```
<%@ Page EnableEventValidation="false" %> 
```

# ruby-on-rails - 无法在 Rails 中更改自定义时间戳字段

> ID：14677329
> 
> 赞同：0
> 
> 时间：2013-02-03T21:07:44.363
> 
> 标签：ruby-on-rails, sqlite, rails-activerecord

我最近在我的数据库中添加了一个名为`created_at_user_time`（最初没有值）的列，它应该包含一个时区转换的 created_at 时间戳。我制作了一个快速脚本，该脚本应该进行转换并将其保存在新列中。然而，在我完成后，我注意到原来的时间戳刚刚被复制到新的时间戳中。我决定在 Rails 控制台中进行调查并得到以下信息。

```
1.9.3p194 :002 > user.time_zone
=> "Central Time (US & Canada)"
1.9.3p194 :003 > test = user.orders.first
1.9.3p194 :004 > test.created_at
=> Wed, 02 Jan 2013 02:02:54 UTC +00:00 
1.9.3p194 :006 > newstamp = test.created_at.in_time_zone("#{user.time_zone}")
=> Tue, 01 Jan 2013 20:02:54 CST -06:00 
1.9.3p194 :008 > test.created_at_user_time = newstamp
=> Tue, 01 Jan 2013 20:02:54 CST -06:00 

#ok, now lets save and check it

1.9.3p194 :009 > test.save
(0.4ms)  begin transaction
(0.1ms)  commit transaction
=> true 

1.9.3p194 :010 > test = user.orders.first
1.9.3p194 :011 > test.created_at_user_time
=> Wed, 02 Jan 2013 02:02:54 UTC +00:00 
```

有人对如何正确执行此操作有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:16:15.173

我会说这将返回相同的时间但具有不同的时区，但最后它直到相同的时间戳：

```
newstamp = test.created_at.in_time_zone 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T07:55:09.777

正如 MiGro 指出的那样，仅使用该`.in_time_zone`方法只会更改时间戳在文本中的显示方式，而实际上并不会更改值。为了更改值，我从转换后的时间值中获取偏移量并将其添加到原始时间，从而使我能够按正确的日期对订单进行分组（请参阅我之前的问题[Modify created_at in query before grouping by date ）。](https://stackoverflow.com/questions/14412360/modify-created-at-in-query-before-grouping-by-date)

```
 test_order = user.order.first 
 orig_time = test_order.created_at
 conv_time = orig_time.in_time_zone(user.time_zone)
 offset = conv_time.utc_offset
 order.created_at_in_user_time = orig_time + offset 
```

# ios - 在内部应用程序的情况下访问客户端 ios 应用程序崩溃报告

> ID：14677332
> 
> 赞同：1
> 
> 时间：2013-02-03T21:08:15.417
> 
> 标签：ios, client, remote-access, crash-reports, xcode-organizer

我开发了一个 iPad 内部应用程序。我把它交给客户测试。他正在使用它，它有时会崩溃。现在，我知道如何在我的测试 ipad 设备上获取崩溃报告。转到管理器并找到我的测试 iPad 的设备日志，在那里我可以看到我的崩溃报告。但是我如何获得客户的 iPad 崩溃报告？更多的问题来了。如果您需要更多信息，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:37:40.587

请参阅[技术问答 1747](http://developer.apple.com/library/ios/#qa/qa1747/_index.html)。

让此人将其 iOS 设备与 iTunes 同步。崩溃报告可以在该页面上显示的文件夹中找到。

另一种选择是将[plcrashreporter](https://www.plcrashreporter.org)集成到您的应用程序中。然后，您可以实现一项功能，允许您的应用从应用内通过电子邮件发送崩溃报告。

# python - 使用 Scrapy 写入多个文件

> ID：14677341
> 
> 赞同：6
> 
> 时间：2013-02-03T21:09:02.057
> 
> 标签：python, web-scraping, scrapy

我正在用 Scrapy 抓取一个网站，并希望将结果分成两部分。通常我这样称呼Scrapy：

```
$ scrapy crawl articles -o articles.json
$ scrapy crawl authors  -o  authors.json 
```

两只蜘蛛完全独立，完全不交流。此设置适用于较小的网站，但较大的网站的作者太多，我无法像这样抓取。

我如何让`articles`蜘蛛告诉`authors`蜘蛛要抓取哪些页面并维护这个两个文件结构？理想情况下，我宁愿不将作者 URL 写入文件，然后与其他蜘蛛一起读回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T18:52:08.717

我最终为作者刮板使用了命令行参数：

```
class AuthorSpider(BaseSpider):
    ...

    def __init__(self, articles):
        self.start_urls = []

        for line in articles:
            article = json.loads(line)
            self.start_urls.append(data['author_url']) 
```

然后，我添加了[Scrapy 文档](http://doc.scrapy.org/en/latest/topics/item-pipeline.html#duplicates-filter)中概述的重复管道：

```
from scrapy import signals
from scrapy.exceptions import DropItem

class DuplicatesPipeline(object):
    def __init__(self):
        self.ids_seen = set()

    def process_item(self, item, spider):
        if item['id'] in self.ids_seen:
            raise DropItem("Duplicate item found: %s" % item)
        else:
            self.ids_seen.add(item['id'])
            return item 
```

最后，我将文章 JSON 行文件传递到命令中：

```
$ scrapy crawl authors -o authors.json -a articles=articles.json 
```

这不是一个很好的解决方案，但它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T10:40:18.060

一切都取决于您的业务逻辑，但这是我的建议

我假设每篇文章都应该有一个作者/作者。

那么为什么要多次爬取同一页面来获取文章和作者呢？

所以我认为你的爬虫应该只爬取应该包含作者的文章，所以用一个刮刀同时提取文章和作者，并使用 Scrapy[管道](http://doc.scrapy.org/en/latest/topics/item-pipeline.html)编写多个可以分离文章和作者的 json 文件。

还有一点是对于非常大的数据 json 不建议使用[jsonlines](http://doc.scrapy.org/en/latest/topics/feed-exports.html)

# c# - 实体框架中的泛型

> ID：14677344
> 
> 赞同：1
> 
> 时间：2013-02-03T21:09:45.093
> 
> 标签：c#, entity-framework, linq-to-entities

我正面临有关实体框架的难题。使用 mvc 4 和实体框架 5.0，我正在开发一个现有应用程序的插件，该应用程序具有以下表名：

```
dbo.company1_contact
dbo.company1_product
dbo.company2_contact
dbo.company2_product 
```

..

一个用户通常只能访问公司一或公司二，我想支持所有公司的用户。这需要一种通用的方法。

所以我创建了两个 edmx 文件，一个用于公司 1，一个用于公司 2，使用相同的实体和上下文名称。导致类如

```
Entities.Company1.Contact
Entities.Company1.Product
Entities.Company2.Contact
Entities.Company2.Product 
```

和两个上下文类：

```
Entities.Company1.Company1Entities
Entities.Company2.Company2Entities 
```

这不足以以通用方式使用它，因为例如，控制器需要一个存储库变量，例如：

```
private Company1Entities db = new Company1Entities() 
```

对于公司 2，这将是

```
private Company2Entities db = new Company2Entities() 
```

通用方法是使用接口 ICompanyEntities 和工厂来获取正确的存储库。但是 - 上下文类中包含的 DbSet 属性可能具有相同的名称，它们的类型不同。具体来说，例如在上下文类中设置的产品现在定义为

```
DbSet<Entities.Company1.Product> Products  {} 
```

相对

```
DbSet<Entities.Company2.Product> Products  {} 
```

所以我修改了 T4 模板为每种类型生成一个接口，让每个实体实现该接口，并生成每个上下文类作为包含具有该接口的 dbset，例如

```
public interface IRepository {} 
public interface IContact {} 
public interface IProduct {} 
```

对于每家公司：

```
public class Product : IProduct {} 
```

在上下文类中：

```
public class Company1Entities : DbContext, IRepository 
{
    ...

    public DbSet<IProduct> Products { get; set; }
    public DbSet<IContact> Contacts { get; set; }
} 
```

这编译得很好，我希望问题得到解决。但是实体框架严重阻塞了它，所以我不得不完全回滚。

然后我尝试对 db 变量使用 dynamic 关键字，但 linq 不会接受。有人可以解释我如何解决这个问题吗？我开始觉得实体框架不可能做到这一点，除非我将控制器编写为部分控制器并为每个公司实现一个控制器，只包含声明 db 变量的行。这是我真的不想做的事情，我宁愿完全复制控制器类。有解决方案，通用方法吗？我在这里错过了什么吗？帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:22:43.317

因为它们都是完全相同的模型，所以您可以对两者使用相同的上下文。只需根据客户的不同加载数据。在构造函数中取一个指示表前缀的值，然后覆盖该`OnModelCreating`方法以在表映射上设置该前缀。

```
public class GenericEntities : DbContext, IRepository 
{
    //...

    private string TablePrefix { get; set; }

    public GenericEntities(string tablePrefix)
    {
        this.TablePrefix = tablePrefix;
    }

    public DbSet<Product> Products { get; set; }
    public DbSet<Contact> Contacts { get; set; }

    public override OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Product>.ToTable(TablePrefix + "_product");
        modelBuilder.Entity<Customer>.ToTable(TablePrefix + "_customer");
    }
} 
```

**重要编辑：** [默认配置](http://msdn.microsoft.com/en-us/library/system.data.entity.dbcontext.onmodelcreating%28v=vs.103%29.aspx)将在您的应用程序中第一次创建 GenericEntities 时缓存您的模型，并且您永远不会创建模型的两个版本。解决这个问题的最简单/最快的方法是为每个客户端创建一个 GenericEntities 的子类，以便它们分别缓存。长期使用*许多*客户端，您需要实现自己的缓存方案（基于表前缀而不是实体类类型）。

```
public class Customer1Entities : GenericEntities
{
    public Customer1Entities() : base("customer1") {}
}

public class Customer2Entities : GenericEntities
{
    public Customer2Entities() : base("customer2") {}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T22:03:39.767

just.another.programmer 的答案是正确的，但不适用于我的情况，因为我使用的是数据库优先。相反，我现在使用 T4 生成通用实体，为每个实体和公司创建代码，例如

```
IQueryable<GenericCustomer> Customers 
{
    get
    {
        return from c in db.Customers1
                select new GenericCustomer() 
                { Name = c.Name, ... }
    }
} 
```

这解决了我的大部分问题。

# r - ggplot2 绘制的点多于数据框中的点，geom_point + facet_grid

> ID：14677352
> 
> 赞同：3
> 
> 时间：2013-02-03T21:10:38.757
> 
> 标签：r, ggplot2

我有一些数据，正在尝试制作带有抖动点叠加的箱线图。我的问题在于要点，所以我们会坚持下去。

这是数据：

```
> dput(test)
structure(list(var1 = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 
4L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 6L, 6L, 6L, 6L, 
6L, 6L, 6L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 8L, 8L, 8L, 8L, 8L, 8L, 
8L, 9L, 9L, 9L, 9L, 9L, 9L, 9L), .Label = c("A", "B", "C", "D", 
"E", "F", "G", "H", "I"), class = "factor"), var2 = structure(c(1L, 
2L, 3L, 4L, 5L, 6L, 7L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 1L, 2L, 3L, 
4L, 5L, 6L, 7L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 1L, 2L, 3L, 4L, 5L, 
6L, 7L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 
1L, 2L, 3L, 4L, 5L, 6L, 7L, 1L, 2L, 3L, 4L, 5L, 6L, 7L), .Label = c("V1", 
"V2", "V3", "V4", "V5", "V6", "V7"), class = "factor"), response1 = c(5L, 
6L, 5L, 5L, 5L, 5L, 4L, 6L, 6L, 5L, 5L, 6L, 6L, 4L, 1L, 1L, NA, 
1L, NA, NA, 1L, 1L, 1L, NA, 1L, NA, NA, 1L, 5L, 5L, 4L, 5L, 3L, 
2L, 3L, 1L, 1L, NA, 1L, NA, NA, 1L, NA, NA, 2L, NA, 3L, 1L, NA, 
NA, NA, 4L, NA, 4L, 5L, NA, NA, NA, 1L, NA, 1L, 1L, NA), response2 = c(2L, 
2L, 2L, 2L, 2L, 2L, 4L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 5L, 5L, NA, 
5L, NA, NA, 5L, 5L, 5L, NA, 5L, NA, NA, 5L, 5L, 5L, 5L, 5L, 5L, 
5L, 5L, 5L, 5L, NA, 5L, NA, NA, 5L, NA, NA, 5L, NA, 5L, 5L, NA, 
NA, NA, 5L, NA, 5L, 5L, NA, NA, NA, 5L, NA, 5L, 5L, NA), response3 = c(4L, 
5L, 1L, 1L, 4L, 1L, 1L, 4L, 5L, 1L, 1L, 5L, NA, 1L, 4L, NA, NA, 
NA, 3L, 2L, NA, 4L, NA, NA, NA, 3L, NA, NA, 4L, NA, 1L, NA, 3L, 
NA, 2L, 4L, NA, NA, NA, NA, NA, NA, NA, 2L, 1L, 1L, NA, NA, 1L, 
NA, 3L, 1L, NA, NA, NA, 1L, NA, 3L, 1L, NA, NA, NA, 1L)), .Names = c("var1", 
"var2", "response1", "response2", "response3"), class = "data.frame", row.names = c(NA, 
-63L)) 
```

我曾经`reshape2`融化我的数据以对绘图命令进行刻面/简化：

```
library(reshape2)
test_melted <- melt(test, id.var = c("var1", "var2"), na.rm = T) 
```

这是我创建的情节：

```
library(ggplot2)
p <- ggplot(test_melted, aes(x = var1, y = value)) + geom_point()
p <- p + facet_grid(~variable) + coord_flip()
p <- p + geom_jitter(position = position_jitter(width=0.2, height = 0.2))
p 
```

这产生了这个：

![在此处输入图像描述](../Images/e2dfea2555d2634a138a8320bebbb10b.png)

看起来很正常，但后来我注意到每个方面/因素级别的分数似乎比应有的要多。我缩小到只有一个级别`var1`

```
test_subset <- test_melted[test_melted$var1 == "E", ]

nrow(test_subset)
[1] 18

summary(test_subset)
      var1    var2        variable     value  
 E      :18   V1:3   response1:7   Min.   :1  
 A      : 0   V2:2   response2:7   1st Qu.:3  
 B      : 0   V3:3   response3:4   Median :5  
 C      : 0   V4:2                 Mean   :4  
 D      : 0   V5:3                 3rd Qu.:5  
 F      : 0   V6:2                 Max.   :5  
 (Other): 0   V7:3 
```

所以，我们应该总共绘制 18 个点（7 代表`response1`，7 代表`response2`，4 代表`response3`。让我们试试吧：

```
p <- ggplot(test_subset, aes(x = var1, y = value)) + geom_point()
p <- p + facet_grid(~variable) + coord_flip()
p <- p + geom_jitter(position = position_jitter(width=0.2, height = 0.2))
p 
```

![在此处输入图像描述](../Images/204318cec80da2e41b9fb7cd9a7288fd.png)

我数了`response1`刻面 11 个点，8 英寸`response2`和 8 英寸`response3`。

这一定是我想念的愚蠢的东西。我已经用点图做了很多刻面，但从未发生过这种情况（或从未注意到！）。

我尝试过的事情

*   移除`coord_flip()`
*   `test_subset <- droplevels(test_subset)`以防空因子水平弄乱了某些东西
*   玩`facet_grid(~variable)`vs. `facet_grid(.~variable)`vs. `facet_grid(variable~)`vs.`facet_grid(variable~.)`

最后一点，根据我是否分面，我得到不同数量的分数。使用刻面，我得到`11 + 8 + 8 = 27`，如果我删除`facet_grid(~variable)`，我得到 23。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:26:01.517

问题不是由于刻面，而是由于在您的情节中使用了两个几何图形。所以`geom_point`将把你的点都画在一个地方，然后`geom_jitter`在随机的位置再次画出来。这就是为什么您可以在每个图中看到更多点。

如果您删除呼叫`geom_point`一切都恢复正常：

```
p <- ggplot(test_subset, aes(x = var1, y = value))
p <- p + facet_grid(~variable) + coord_flip()
p <- p + geom_jitter(position = position_jitter(width=0.2, height = 0.2))
p 
```

![在此处输入图像描述](../Images/c57161efe96c65c571c0ba35631b8dfe.png)

# erlang - 在模块中定义 Erlang 记录

> ID：14677355
> 
> 赞同：0
> 
> 时间：2013-02-03T21:11:17.393
> 
> 标签：erlang, record

我可以通过以下方式在 erl shell 上定义一条记录：

```
129> rd(person, {name=""}).
person
130> #person {}.
#person{name = []}
131> #person {name="dummy"}.
#person{name = "dummy"} 
```

但我不确定如何在模块中定义和使用记录。当我创建 my_module.erl 时：

```
-module(my_module).

-record(person, {name, phone, address}).

#person {name="dummy"}. 
```

...并尝试编译，我得到：

```
132> c(my_module).          
my_module.erl:5: syntax error before: '#'
my_module.erl:3: Warning: record person is unused
error 
```

文档说 rd 在 shell 中使用，因为记录在编译时可用，而不是运行时可用。所以我假设我不需要在模块定义中使用 rd 。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T14:03:48.493

如果你想在多个模块中使用一条记录，你可以把它放在一个头文件中（例如`foo.hrl`）：

```
-record(foo, {bar, baz}). 
```

然后，您可以将头文件包含在您需要的模块中：

```
-include_lib("path/to/foo.hrl") 
```

通常这些头文件被放入`include`你的应用程序的目录中。

**编辑**：我从[文档](http://www.erlang.org/doc/reference_manual/macros.html)中引用：

> `include_lib`类似于`include`，但不应指出绝对文件。相反，第一个路径组件（可能在变量替换之后）被假定为应用程序的名称。例子：
> 
> ```
> -include_lib("kernel/include/file.hrl"). 
> ```

所以，看来我写的其实*更*适合`include`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T21:37:24.277

您已经正确定义了它，但是记录只能在函数内部使用（当它在模块内部时）。

所以添加类似的东西

`test_record() -> #person{name="dummy"}.`

然后你可以看到 Erlang shell 的结果

`my_module:test_record()`

# python - PyInstaller在制作二进制文件时找不到libpython2.7.so？

> ID：14677359
> 
> 赞同：7
> 
> 时间：2013-02-03T21:11:55.683
> 
> 标签：python, python-2.7, python-module, pyinstaller

我正在尝试在 Linux 上使用 PyInstaller 2.0 制作 Python 脚本的二进制版本。当我运行时：

```
$ python pyinstaller.py myscript.py 
```

我得到错误：

```
8907 INFO: Looking for Python library libpython2.7.so
Traceback (most recent call last):
...
  File "pyinstaller.py", line 91, in <module>
    raise IOError("Python library not found!")
IOError: Python library not found! 
```

如何解决这个问题？

我在用：

Linux #98-Ubuntu x86_64 GNU/Linux

使用 python 2.7。系统上还有其他 Python，但我将其设置为：

```
alias python="python2.7" 
```

在我正在使用的服务器中，只有python 2.7`/usr/lib/python2.6`并且没有`/usr/lib/python2.7`，但我经常使用 python 2.7 并且是功能性的，等等。所以我不明白为什么找到它的库会是一个问题。有一个`/usr/local/lib/libpython2.7.a`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T00:03:00.247

> 在我使用的服务器中，只有 /usr/lib/python2.6 而不是 /usr/lib/python2.7 但是我经常使用 python 2.7 并且是功能性的等等，所以我不明白为什么找到它的库将是一个问题。有一个/usr/local/lib/libpython2.7.a。

如果没有`libpython2.7.so`，当然要找到那个库是个问题。

您能够使用 Python 解释器的原因可能是它是静态链接的。

有两种方法可以解决这个问题。

首先，您可以为您的 Python 2.7 安装共享库。如果你使用的是旧版本的 Ubuntu，比如 Python 2.6，并且你从`python2.7`包中安装了 2.7，这应该只是安装`libpython2.7`.

如果您从其他来源获得了 2.7，那么 Ubuntu`libpython2.7`软件包显然无法工作——或者它可以通过安装第二个`python2.7`. 无论哪种方式，都不要这样做。要么为现有的 2.7 获取 Python 的其余部分，要么卸载该 2.7 并使用 Ubuntu 软件包。（对于某些 Python 发行版，“获取其余部分”是不可能的，因为如果您安装共享库，您将获得动态链接的 Python 可执行文件而不是静态链接的可执行文件。在这种情况下，您几乎必须卸载并重新安装。）

其次，您可以使用`PyInstaller`'s static-lib 支持。有关详细信息，请参阅[票 420](http://www.pyinstaller.org/ticket/420)，但简单的想法是，如果启用此功能，并且 PyInstaller 认为您的平台应该有一个`libpython2.7.so`但找不到它，它将寻找一个`libpython2.7.a`并静态链接它。上次我需要这个时，它没有检入主干。快速浏览一下工单，看起来该补丁现在已包含在内，但在默认`PyInstaller`构建中被禁用，并且里程碑设置为 3.0，因此，您可能仍需要手动构建`PyInstaller`才能使其正常工作。

最后一件事：您可能*确实*有 libpython2.7.so，但它只是安装在某个奇怪的地方`/opt/python27/lib`或其他`/opt/python27`地方，在您的路径上没有任何位置，但`/usr/local/bin/python27`可以找到它，因为它明确构建用于从`/opt/python27`. 这种事情往往只对使用 MacPorts 或 Fink 的 Mac 用户来说是个问题，而不是 Linux 用户，但这并非不可能。`/usr/local/bin/python27`如果您认为这可能是问题，您可以查看 dl 表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-16T15:06:39.617

正如@abarnert 已经说过的那样，问题似乎是python的静态编译。为了解决这个问题，需要重新编译python，但这次添加标志**--enable-shared**：

```
 [root@machine ~]# ./configure --prefix=/usr/local --enable-shared
    [root@machine ~]# make && make altinstall 
```

完成此操作后，您将在 /usr/local/lib 路径下找到请求的库 ( **libpython2.7.so.1.0** )，因此不要忘记将该文件夹添加到 $LD_LIBRARY_PATH 环境变量中：

```
 [root@machine tmp]$ export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-15T09:00:24.267

有 2 个选项： libpython*.so 在您的系统上存在或不存在。您可以通过从根目录开始的任何查找实用程序来检查它。如果文件已经存在但 PyInstaller 仍然找不到：最通用的建议是打开 PyInstaller 代码并找到负责找到该库的模块。它可以用简单的编辑器来完成。然后转到此模块并编辑他以了解您的特定系统有什么问题。代码很简单而且为时过早——你需要大约 5 分钟才能理解其中的原因。就我而言，我只是将 LD_LIBRARY_PATH=/usr/local/lib 添加到我的用户配置文件 (.bash_profile) 中，并确保此 *.so 文件在其中。如果文件不在您的系统上或者您的版本不正确：只需重新安装 python。

# java - 具有空数据和源文件的 ListModel 中的 ZK NullPointerException：内联评估：``

> ID：14677361
> 
> 赞同：0
> 
> 时间：2013-02-03T21:11:57.863
> 
> 标签：java, listbox, zk

嗨，伙计们，我对 ZK 很陌生，我收到 2 个错误，如果出现此错误，请指导我，抱歉，对于非新手来说非常容易。这是代码。

```
public void createItem(Listbox list) 
{          
    BindingListModelList model=(BindingListModelList)list.getModel();       
    System.out.println((list==null));//prints false
    System.out.println((model==null));//prints true             
    if(model==null){ list.setModel(new ListModelList());System.out.println("After Set New Model: "+(list.getModel()==null));//prints true}      
    model=(BindingListModelList)list.getModel();
    System.out.println((model==null));//prints true
    model.add(getMeridaManager().createNewMeridaItem(list));//throws NPE
}   

public void loadGrid(Listbox list)
{
    //here i load the model but when is a empty ALL arrayList throws exception on createItem(Listbox list) 

    java.util.List<DianaMerida>all = meridaManager.getAllMeridas();
    BindingListModelList rl=new BindingListModelList(all,false);        
    list.setModel(rl);
} 
```

如果 .zul 当我使用过去的代码时。我想知道是否是一个空集合，我如何通过示例将新项目添加到模型中，稍后再添加新记录。

2个问题我在zul中有以下代码。

```
checkbox id="isclosecheckbox" checked="@{d.c03}"     onCheck="myClass.checkBoxListener2(datebox1);"
datebox id="datebox1" cols="10" format="short" mold="rounded" 
```

但是当单击复选框并`myClass.checkBoxListener2(datebox1);`调用该方法时，我收到以下错误。

> 03/02/2013 04:30:41 PM org.zkoss.zk.ui.impl.UiEngineImpl handleError:1280 GRAVE: >>org.zkoss.zk.ui.UiException: 源文件: 内联评估: `. . . '' : Undefined argument: datebox1 : at Line: 300 : in file: inline evaluation of:`
> . . . '' : ( datebox1 )
> 
> > > 源文件：内联评估：`. . . '' : Undefined argument: datebox1 : at Line: 300 : in file: inline evaluation of:`
> > > . . . '' : ( datebox1 )

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T06:02:39.540

如果您使用的是 MVVM 架构，您可以像这样在列表框中添加一个新项目。

```
 <?page title="new page title" contentType="text/html;charset=UTF-8"?>
<zk>
    <window title="new page title" border="normal"
        viewModel="@id('vm') @init('com.team.MyListbox')" apply="org.zkoss.bind.BindComposer">
        <button label="AddItem" onClick="@command('addNewItem')"></button>
        <listbox model="@bind(vm.dataList)">
            <listhead>
                <listheader value="A"></listheader>
                <listheader value="B"></listheader>
                <listheader value="C"></listheader>

            </listhead>
            <template name="model" var="mymodel">
                <listitem>
                    <listcell>

                        <textbox value="@bind(mymodel.a)" />
                    </listcell>
                    <listcell>
                        <label value="@bind(mymodel.b)" />

                    </listcell>
                    <listcell>
                        <label value="@bind(mymodel.c)" />

                    </listcell>
                </listitem>
            </template>
        </listbox>
    </window>
</zk> 
```

而 Java 代码或 ViewModel 是...

```
package com.team;

import java.util.ArrayList;
import java.util.List;

import org.zkoss.bind.annotation.AfterCompose;
import org.zkoss.bind.annotation.Command;
import org.zkoss.bind.annotation.ContextParam;
import org.zkoss.bind.annotation.ContextType;
import org.zkoss.bind.annotation.NotifyChange;
import org.zkoss.zk.ui.Component;

public class MyListbox {

    private List<Data> dataList;

    @AfterCompose
    public void afterCompose(@ContextParam(ContextType.VIEW) Component view) {
        try {
            dataList = new ArrayList<Data>();
            Data data;
            data = new Data("a1", "b1", "c1");
            dataList.add(data);
            data = new Data("a2", "b2", "c2");
            dataList.add(data);
            data = new Data("a3", "b3", "c3");
            dataList.add(data);
        } catch (Exception e) {

        }
    }

    @Command
    @NotifyChange("dataList")
    public void addNewItem(){
        Data data = new Data("", "", "");
        dataList.add(data);
    }
    public List<Data> getDataList() {
        return dataList;
    }

    public void setDataList(List<Data> dataList) {
        this.dataList = dataList;
    }

    public class Data {
        String a;
        String b;
        String c;
        public String getA() {
            return a;
        }
        public String getB() {
            return b;
        }
        public String getC() {
            return c;
        }
        public void setA(String a) {
            this.a = a;
        }
        public void setB(String b) {
            this.b = b;
        }
        public void setC(String c) {
            this.c = c;
        }
        public Data(String a, String b, String c) {
            super();
            this.a = a;
            this.b = b;
            this.c = c;
        }

    }
} 
```

对于您的复选框问题，您可以在 zul 中使用类似这样的代码..

```
<checkbox checked="@bind(vm.checkboxValue)" onCheck="@command('checkboxClicked'  /> 
```

在这里，我将复选框值与此变量绑定

> 复选框值

任何人都点击我正在调用方法的复选框

> 复选框单击

我可以在哪里执行我的业务逻辑

# php - sql UPDATE row::leave current value if input empty

> ID：14677362
> 
> 赞同：1
> 
> 时间：2013-02-03T21:12:02.483
> 
> 标签：php, sql, database

我是新手，我不确定这是一个 php 问题还是一个 sql，但我有一个没有必填字段的表单，在提交时它会更新数据库行中的列。目前，当提交表单时，如果输入为空，它会使用空白空间更新相应的列并删除曾经存在的值。我想弄清楚的是如何在表单提交时做到这一点，如果输入值为空，它不会更新数据库列。

```
if ( isset($_POST['submit']) ) {
    $user = $_SESSION['user_name'];
    $signature = $mysqli->real_escape_string($_POST['signature']);
    $skype = $mysqli->real_escape_string($_POST['skype']);
    $facebook = $mysqli->real_escape_string($_POST['facebook']);

    $insert = $mysqli->query("
    UPDATE users 
    SET u_signature='$signature', u_skype='$skype', u_facebook='$facebook' 
    WHERE u_name='$user'
    ") or die ($mysqli->error); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:26:02.587

```
<?php
if ( isset($_POST['submit']) ) {

    $user = $_SESSION['user_name'];
    $signature = mysql_real_escape_string($_POST['signature']);
    $skype = mysql_real_escape_string($_POST['skype']);
    $facebook = mysql_real_escape_string($_POST['facebook']);
    if(!empty($signature)){
     $update_fields[] = "u_signature='$signature'";
    }
    if(!empty($skype)){
     $update_fields[] = "u_skype='$skype'";
    }
    if(!empty($facebook)){
     $update_fields[] = "u_facebook='$facebook'";
    }
    if(count($update_fields) > 0){
      $nonempty_fields = implode(", ", $update_fields);
      $insert = mysql_query("
      UPDATE users 
      SET $nonempty_fields
      WHERE u_name='$user'
      ") or die(mysql_error());
    }
    else{
     echo "must not update the db because all required fields are empty";
    }

}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:15:43.163

默认情况下，您可以在输入中包含旧数据，因此如果没有更改任何数据，则只是再次插入旧数据。否则：

```
$q_vars = "UPDATE users SET ";
if(!empty($signature))
{
$q_vars .= "signature = $signature ";
} 
```

但如果不是最后一个，则使用数组 + foreach 添加逗号。

# regex - 如何在 Perl 正则表达式中仅捕获第一次出现

> ID：14677363
> 
> 赞同：1
> 
> 时间：2013-02-03T21:12:24.900
> 
> 标签：regex, perl, regex-greedy

我第一次使用 Perl（使用 TextWrangler），需要正则表达式方面的帮助！

我有一大串物种名称、DNA 和其他文本。我想提取以下内容：

```
Homo sapiens
Pongo abelii
Macaca mulatta 
```

现在，我已经定义了 $string 并且有这个命令（对不起，如果我没有使用正确的术语，我是一个新手）：

```
while($string =~ m/(Homo sapiens|Pongo abelii|Macaca mulatta)/g)
{
    print "$1\n";
} 
```

这是我得到的输出：

```
Homo sapiens

Homo sapiens

Pongo abelii

Macaca mulatta

Homo sapiens

Homo sapiens

Homo sapiens

Homo sapiens

Homo sapiens

Homo sapiens 
```

我如何获得*每个*物种名称中的一个？这让我快疯了！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:19:20.440

这比您告诉我们的要多，或者您可以这样做：

```
print "Homo sapiens\nPongo abelii\nMacaca mulatta\n"; 
```

但要回答你的问题：

```
my %seen;
while($string =~ m/(Homo sapiens|Pongo abelii|Macaca mulatta)/g)
{
    print "$1\n" unless $seen{$1}++;
} 
```

或者，更复杂的是，跟踪您正在寻找的内容并在找到所有内容后停止：

```
my %not_found = ( 'Homo sapiens' => 1, 'Pongo abelii' => 1, 'Macaca mulatta' => 1 );
while ( %not_found && $string =~ /(@{[ join( '|', map quotemeta, sort { length $b <=> length $a } keys %not_found) ]})/g ) {
    print "$1\n";
    delete $not_found{$1};
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:16:27.920

从正则表达式的末尾删除`g`修饰符。这代表“全球”，将匹配所有；没有它，只有第一个匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:25:28.613

基本上，您想删除重复项，因此请使用标准代码来执行此操作。

```
my %seen;
while ($string =~ /(Homo sapiens|Pongo abelii|Macaca mulatta)/g) {
    print "$1\n" if !$seen{$1}++;
} 
```

# python - Django 错误：“AccessInit：哈希冲突：1 和 1 都为 3。”

> ID：14677364
> 
> 赞同：1
> 
> 时间：2013-02-03T21:12:26.593
> 
> 标签：python, django

我正在使用 Eclipse Indigo 运行 Python 2.7 和 Django 1.5。我的项目运行良好，直到我愚蠢地玩弄了我的环境变量。在某些时候，我开始收到以下错误：

```
AccessInit: hash collision: 3 for both 1 and 1. 
```

从那以后，我一直无法让 Django 服务器再次工作。尝试加载 url 时，服务器会抛出异常并关闭。我尝试将文件复制到一个新项目中，重新配置环境变量，无论我能想到什么。好像我弄坏了什么。有谁知道这个错误可能与什么有关？我发现它只在 PIL 的上下文中提到，它没有安装在我的计算机上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T12:46:14.937

阅读[这篇博文](http://jaredforsyth.com/blog/2010/apr/28/accessinit-hash-collision-3-both-1-and-1/)

TL; DR - 更改您的 Python 代码以使用该`from PIL import`语法。

# xslt - xslt 2.0 可变元素节点集处理

> ID：14677367
> 
> 赞同：1
> 
> 时间：2013-02-03T21:12:37.797
> 
> 标签：xslt, tomcat

我正在尝试将 xml 转换为新结构，然后在转换中处理新结构。我的问题是让新结构可用作节点集。我在 webapp 的库中使用 Tomcat 6 和 saxon9he。为了测试新结构的可用性，我创建了以下 xsl。

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet version="2.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output method="xml" omit-xml-declaration="no" indent="yes" encoding="UTF-8"/>

<xsl:include href="nodeTest.xsl"/>
<xsl:variable name="theDoc"> 
  <doc>
    <source>from</source>
    <source>here</source>
    <target>to</target>
    <target>there</target>
  </doc>
</xsl:variable>

<xsl:template match="/">
  <xsl:variable name="result1">
    <xsl:call-template name="createLinks">
    <xsl:with-param name="doc" select="$theDoc/doc/*"/>
    </xsl:call-template>
  </xsl:variable>
input:
<xsl:value-of select="$theDoc/doc/*"/>
output:
<xsl:value-of select="$result1"/>
</xsl:template>

</xsl:stylesheet> 
```

我希望变量 theDoc 将包含一个有效的节点集，并且 createLinks 模板会将它作为一个节点集来处理。这是 createlInks 模板；

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" > 

<xsl:template match="node()" mode="makeLink"> 
  <xsl:param name="theSource" select="'source'"/>
  <xsl:param name="theTarget" select="'target'"/>
  <xsl:param name="theUsage" select="'usage'"/>
  <xsl:element name="link" >
  <xsl:element name="usage" ><xsl:value-of select="$theUsage"/></xsl:element>
  <xsl:element name="source" ><xsl:value-of select="$theSource"/></xsl:element>
  <xsl:element name="target" ><xsl:value-of select="$theTarget"/></xsl:element>
  </xsl:element>    
</xsl:template>

<xsl:template name="createLinks">
<xsl:param name="doc" select="*"/>
the input doc:
<xsl:value-of select="$doc"/>
<xsl:copy>
  <xsl:element name="Links">
        <xsl:apply-templates mode="makeLink" select=".">
      <xsl:with-param name="theUsage" select="'link from source to target'"/>
      <xsl:with-param name="theSource" select="$doc/source/*"/>
      <xsl:with-param name="theTarget" select="$doc/target/*"/>
        </xsl:apply-templates>
  </xsl:element>
   </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

执行时，结果如下所示；

```
<?xml version="1.0" encoding="UTF-8"?>
input:
from here to there
output:

the input doc:
fromheretotherelink from source to target 
```

很明显theDoc 不是一个节点集。我的理解是 xslt 2.0 标准将 theDoc 作为节点集，而不是结果树片段。如何更改这些简单的 xsls 以将 theDoc 的内容作为节点集处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:55:37.167

我不清楚你是如何得出结论的：

“很明显theDoc不是一个节点集。我的理解是xslt 2.0标准将theDoc作为一个节点集，而不是一个结果树片段。我怎样才能改变这些简单的xsls来处理theDoc的内容作为一个节点集？”

这里的第一个问题是您使用的是 XSLT 1.0 数据模型术语。在 2.0 中，没有节点集，只有序列，也没有结果树片段之类的东西。

$theDoc 的值是一个文档节点。此文档节点有一个名为 doc 的子元素，它又具有四个子元素，分别为 source、source、result 和 result。

当你这样做时：

```
<xsl:value-of select="$doc"/> 
```

它输出这个文档节点的字符串值，它是后代文本节点的串联，即`fromheretothere`。

当你这样做时：

```
<xsl:value-of select="$result1"/> 
```

你输出 $result1 的字符串值，它本身就是一个文档节点；这个文档节点有一个子节点叫做link，它有3个子节点，分别叫做usage、source和target；使用元素有文本内容“从源到目标的链接”，源和目标元素都是空的。它们为空的原因是表达式`$doc/source/*`并`$doc/target/*`没有选择；他们什么都不选择，因为 $doc 有一个名为 doc 的孩子；源和目标元素是它的孙子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:21:31.353

您的 XSLT 中有几个问题会阻止它按预期工作。第一个是使用**xsl:value-of**来显示变量值的地方。例如

```
<xsl:value-of select="$doc"/> 
```

这只会显示节点集的文本值。您应该在这里真正使用**xsl:copy-of**来返回节点的副本。

```
<xsl:copy-of select="$doc" /> 
```

尝试用 xsl:copy-of 替换所有出现的xsl **:** **value-of**以了解您的情况。

 **其次，当您调用“makelink”模板时，您的参数存在问题

```
<xsl:with-param name="theSource" select="$doc/source/*"/>
<xsl:with-param name="theTarget" select="$doc/target/*"/> 
```

* 将匹配**源**元素和**目标**元素的子元素，但它们没有子元素，只有子文本节点（元素是节点，但并非所有节点都是元素！）。你可能想这样做....

```
<xsl:with-param name="theSource" select="$doc/source"/>
<xsl:with-param name="theTarget" select="$doc/target"/> 
```

事实上，即使这样也行不通，因为您调用模板的方式

```
<xsl:call-template name="createLinks">
    <xsl:with-param name="doc" select="$theDoc/doc/*"/>
</xsl:call-template> 
```

以这种方式调用它意味着**源**和**目标**是顶级元素。你可能想这样做......

```
 <xsl:call-template name="createLinks">
     <xsl:with-param name="doc" select="$theDoc/doc"/>
 </xsl:call-template> 
```**

# ios - UISearchBar 动画问题

> ID：14677369
> 
> 赞同：1
> 
> 时间：2013-02-03T21:12:45.117
> 
> 标签：ios, objective-c, uisearchbar, uisearchdisplaycontroller

我正在尝试`UISearchBar`在它变得活跃时进行扩展。

我遇到的问题是，搜索栏仅在用户在其中输入至少 2 个字符后才会扩展。在此之前，它已固定到位。我`searchBar.alpha =0.7;`在其中添加了一个并且有效，因此一旦用户触摸搜索栏，似乎就会调用此方法

```
- (void)searchDisplayControllerDidBeginSearch : (UISearchDisplayController *)controller
{
    [UIView animateWithDuration:0.2 animations:^{
        self.searchBar.frame = CGRectMake(0,10,250,self.searchBar.frame.size.height);
        // self.searchBar.frame = CGRectMake(70, 10, 250, 40);
        searchBar.alpha =0.7;
        [searchBar layoutSubviews];            
    }];    
} 
```

不确定我设置的方式是否有问题。这是我所拥有的：

在`.h`：

```
@property (weak, nonatomic) IBOutlet UISearchBar *searchBar; 
```

在`.m`：

```
@synthesize searchBar; 
```

并在`StoryBoard`：

![在此处输入图像描述](../Images/1d7da2a65e3dc80bfad76e652db596f3.png)

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:25:28.797

尝试使 UISearchBar ( `UISearchBarDelegate`) 的类委托并将您的动画代码粘贴到`- (BOOL)searchBarShouldBeginEditing:(UISearchBar *)searchBar`方法实现中。我认为它应该有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:52:24.807

我在为 UISearchBar 大小和位置设置动画时遇到了类似的问题，结果证明该问题与 iOS 6 中的自动布局有关。我的代码中的动画块与您的完全相同，只是我从 - (void)searchBarTextDidBeginEditing 调用它： (UISearchBar *) 搜索栏。

我通过在我的搜索栏子类中`searchBar.frame`被覆盖的日志找到了。`layoutSubviews`此问答解释了“layoutSubviews”在 iOS 6 上的行为方式有何不同（[选择退出单个视图的自动布局？](https://stackoverflow.com/questions/12788769/opting-out-of-auto-layout-for-a-single-view)）

基于此，如果您正在为 iOS 6 构建，动画 UISearchBar 框架的选项似乎是禁用自动布局或以编程方式实例化 UISearchBar。我选择了后者，它奏效了。

PS：如果您要禁用自动布局，您可以为整个情节提要或仅禁用 .xib （更多内容：[在 iOS 6 中启用自动布局，同时保持与 iOS 5 向后兼容](https://stackoverflow.com/questions/12411980/enabling-auto-layout-in-ios-6-while-remaining-backwards-compatible-with-ios-5)）

希望这可以帮助。

# ruby-on-rails-3 - Rails - 渲染：content_type 没有效果

> ID：14677376
> 
> 赞同：3
> 
> 时间：2013-02-03T21:13:20.727
> 
> 标签：ruby-on-rails-3, heroku, rss, mime-types, scraper

我正在开发一个 Ruby/Rails 应用程序，它会抓取另一个网站并使用数据呈现 RSS 提要。

因为这个应用程序是在 Heroku 上构建的，所以我通过控制器生成 RSS 提要，而不是将其转储到文件系统并将其作为资产提供。

但是，当我设置`render :content_type`哈希时，没有效果。响应的内容类型保持不变`text/plain`。

`news`*[FeedController](https://github.com/freen/ubuwebrss/blob/master/app/controllers/feed_controller.rb)*上的操作

```
def news
  do_scrape
  @posts = UbuEntry.all(:order => "created_at DESC", :limit => 400)
  render :layout => false, :content_type => Mime::RSS
end 
```

完整[路线.rb](https://github.com/freen/ubuwebrss/blob/master/config/routes.rb)

```
UbuWebRSS::Application.routes.draw do
  root :to => 'index#index'
  scope :format => true, :constraints => { :format => 'rss' } do
    get 'feed/news' => 'feed#news'
  end
end 
```

您可以在此处查看实时结果：

[http://www.ubuwebrss.com/feed/news.rss](http://www.ubuwebrss.com/feed/news.rss)

以及完整的源代码：

[https://github.com/freen/ubuwebrss/](https://github.com/freen/ubuwebrss/)

我在 Google 和 StackOverflow 上环顾四周，但不清楚我做错了什么。

有小费吗？谢谢！

**供参考：**

视图脚本：[/app/views/feed/news.rss.builder](https://github.com/freen/ubuwebrss/blob/master/app/views/feed/news.rss.builder)：

```
xml.instruct! :xml, :version => "1.0" 
xml.rss :version => "2.0" do
  xml.channel do
    xml.title "UbuWeb"
    xml.description "UbuWeb is a completely independent resource dedicated to all strains of the avant-garde, ethnopoetics, and outsider arts."
    xml.link 'http://www.ubu.com'

    for post in @posts
      xml.item do
        xml.title post.title

        description = post.description.to_s
        unless description.empty?
          # Manually add description for custom HTML sanitizing
          description = @sanitizer_basic.clean(description)
          xml << " " * 6
          xml << "<description><![CDATA[" + description + "]]></description>\n"
        end

        xml.pubDate post.created_at.to_s(:rfc822)
        xml.link post.href
        xml.guid post.href
      end
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T00:10:47.493

似乎它在这里返回了正确的内容类型（带有`curl -i <url>`）：

```
HTTP/1.1 200 OK 
Server: nginx
Date: Mon, 04 Feb 2013 00:10:05 GMT
Content-Type: application/rss+xml; charset=utf-8
Content-Length: 121890
Connection: keep-alive
X-Ua-Compatible: IE=Edge,chrome=1
Etag: "74ebbfe3182fef13d8a737580453f688"
Cache-Control: max-age=0, private, must-revalidate
X-Request-Id: 9377e469ffad158b2480a3f6b2f2866c
X-Runtime: 0.748709
X-Rack-Cache: miss 
```

可能是 Chrome 而不是您的应用程序中的错误。

# linux - 修改拥塞控制窗口值

> ID：14677377
> 
> 赞同：3
> 
> 时间：2013-02-03T21:13:21.077
> 
> 标签：linux, tcp, packet, cwnd, congestion-control

对于我的研究，我想手动控制 TCP 的拥塞控制窗口大小。

当测试网络上发生分段/确认丢失时，我想明确阻止窗口减少。

这可能吗？

我一直在寻找使用 Python、Netem 和 Scapy 的方法。我可以访问 windows 和 linux (ubuntu 12)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T21:07:09.907

在 2.6.33 以上的内核上，您可以尝试

```
ip route change default via x.x.x.x initcwnd new-val initrwnd new-val 
```

也看看[这个](http://fasterdata.es.net/host-tuning/linux/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-12T09:09:59.733

这对我有用。根据您的要求将以下内容添加到 /etc/sysctl.conf 文件中

```
#Maximum Socket Receive Buffer
net.core.rmem_max = 33554432

#Maximum Socket Send Buffer
net.core.wmem_max = 33554432 
```

运行“sysctl -p”申请。

# silverlight - 从 silverlight 调用 WSO2DSS 数据服务（跨域调用）

> ID：14677378
> 
> 赞同：1
> 
> 时间：2013-02-03T21:13:27.143
> 
> 标签：silverlight, cross-domain, wso2, wso2dss

我需要从 silverlight 跨域调用数据服务（在 WSO2DSS 中创建）。

我知道 Web 服务器的根目录中必须有特定的 crossdomain.xml 文件。

但我不知道如何将此文件存储在 WSO2DSS 的 Web 服务器根目录中。

# jquery - 如何使类似的文章/内容出现在指定的滚动点上？

> ID：14677380
> 
> 赞同：1
> 
> 时间：2013-02-03T21:13:32.827
> 
> 标签：jquery, scroll, appearance

如今在很多网站上，当我向下滚动并到达指定点时，我会看到这些推荐框，其中突然出现一框内容，并显示某种类似的文章或推荐。

我会对制作此功能的过程感兴趣。我对推荐系统或类似的东西不感兴趣，我只对在指定滚动点显示内容框的技术感兴趣。

那里有脚本还是我必须自己弄清楚并编写脚本？可能是某种 Jquery 吗？

我将不胜感激有关此问题的任何消息。

我正在寻找的一个很好的参考是经济学人的网站，您点击一篇文章，向下滚动并在右下角出现类似的文章。

这是随机文章的参考链接，该功能完美运行： http: [//www.economist.com/news/leaders/21571136-politicians-both-right-and-left-could-learn-nordic-countries-next -超模](http://www.economist.com/news/leaders/21571136-politicians-both-right-and-left-could-learn-nordic-countries-next-supermodel)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:15:38.710

我相信你想使用scrollTop。[http://api.jquery.com/scrollTop/](http://api.jquery.com/scrollTop/)基本上你寻找滚动位置并在它到达某个点时做一些事情。

这是一个小提琴：粗略的演示。

[http://jsfiddle.net/YtGrf/](http://jsfiddle.net/YtGrf/)

```
$('#test').scroll(function(){
    var loc = $(this).scrollTop();
    if(loc > 150) {
        alert('fire');
    }
}); 
```

# web-services - Web服务登录系统

> ID：14677381
> 
> 赞同：0
> 
> 时间：2013-02-03T21:13:36.447
> 
> 标签：web-services, login, axis2

我正在尝试使用 Web 服务创建登录系统，（我正在使用axis2）。

我已经创建了一个数据库，其中有一个带有用户和 pass(binary(20)) 的表。我将密码的SHA1保存在pass字段中。

```
CREATE TABLE users(user varchar(15),pass binary(20));
INSERT into users (user,password) values ("user",UMHEX(SHA1("mypassword")) 
```

我的问题是：

1.  我应该将密码发送到我的 Web 服务，然后创建 SHA1 以检查信息是否正确。还是将密码的 SHA1 尽快发送到 Web 服务？

2.  我已经测试了必发网络服务，它使用带有会话令牌的登录系统，这比：总是发送用户和密码/SHA1，不是吗？

    2.1。生成会话令牌的最佳方法是什么？

    2.2 我需要将打开的“会话令牌”保存在一个表中，也许在用户表中，不是吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T09:30:53.047

首先，您不应该通过网络发送明确的密码，它很容易被黑客入侵。

所以你可以做的是 SHA 它并将其发送到 Web 服务，登录过程将检查并生成会话令牌并从 API 返回。

# format - 站点地图格式

> ID：14677383
> 
> 赞同：-1
> 
> 时间：2013-02-03T21:14:13.680
> 
> 标签：format, sitemap

在 sitemaps.org 中说，对于位于服务器 URL [https://example.com/catalog/page1.php上的](https://example.com/catalog/page1.php)[http://example.com/catalog/](http://example.com/catalog/)的 sitemap.xml无效（因为列出的所有 URL在站点地图中必须使用相同的协议）

站点地图的以下代码是否有效？

```
 <?xml version="1.0" encoding="UTF-8"?>  
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">  
    <url>  
        <loc>http://www.example.com/</loc>  
        <changefreq>daily</changefreq>  
    </url>  
    <url>  
        <loc>http://www.example.com/index.php/software/</loc>  
        <changefreq>daily</changefreq>  
    </url>  
</urlset> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T15:50:47.843

使用以下扭结进行验证：

[http://www.xml-sitemaps.com/validate-xml-sitemap.html](http://www.xml-sitemaps.com/validate-xml-sitemap.html)

# php - Zend_Http_Client：如何“不下载大文件”

> ID：14677386
> 
> 赞同：0
> 
> 时间：2013-02-03T21:14:36.473
> 
> 标签：php, zend-framework, frameworks, zend-http-client

我有使用 Zend_Http_Client 的 PHP 脚本。

脚本做两件事：

*   “扩展”缩短的网址 + 获取 MIME 类型的网址
*   获取 text/html url 的 HTML 内容

我使用这个简单的代码：

```
$client = new Zend_Http_Client($url);
$response = $client->request('GET');
$headers = $response->getHeaders();
$body = $response->getBody(); 
```

除了 URL 包含 100Mb MP3 文件的情况外，一切正常。我只需要 HTML 内容，不需要 MP3。所以我想将 Zend_Http_Client 配置为“不要下载超过 2Mb 的文件”。可能吗？

是的，我可以发出 2 个请求 - 第一个是获取 URL 的 MIME，如果 MIME=text/html，第二个是获取 HTML，但是发出 2 个不同的请求太昂贵了。

所以，问题：当已经下载的内容重量超过2Mb时，如何检查下载内容的大小并停止下载而不出错？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:56:51.683

如果您遵循协议，最佳实践是先发送 HEAD 请求，检查预期的内容类型和大小，然后发送 GET 请求。但是，这对您来说可能还不够，并且可能并非所有服务器都支持。

或者，您可以使用流响应支持在实际下载正文之前中止下载。[请参见http://framework.zend.com/manual/1.12/en/zend.http.client.advanced.html#zend.http.client.streaming](http://framework.zend.com/manual/1.12/en/zend.http.client.advanced.html#zend.http.client.streaming)的示例 #11

# ruby-on-rails - Rails，距离邮政编码范围内的所有邮政编码

> ID：14677388
> 
> 赞同：4
> 
> 时间：2013-02-03T21:14:56.377
> 
> 标签：ruby-on-rails, ruby-on-rails-3, zipcode

我试图找出：给定一个邮政编码，该邮政编码 X 英里半径内的所有邮政编码是什么。

* * *

我找到了一些解决方案，我在下面发布了这些解决方案，但我想知道是否有专门针对 Rails 或 Ruby 的更好解决方案（换句话说，gem、gist 等）。我发现的 Ruby 解决方案已经有几年的历史了，所以现在似乎有更好的解决方案可用。

理想情况下，我想要的东西只需要一个字符串“11026”并生成字符串作为输出，而不必创建 AR 模型或过于广泛地处理数据库。

[Geocoder](http://www.rubygeocoder.com/)似乎没有明确地这样做...... [Geokit](http://geokit.rubyforge.org/)也没有。我不知道这些宝石是否有一个简单的解决方法。

* * *

类似的解决方案：

[查找邮政编码指定距离内的所有邮政编码](https://stackoverflow.com/questions/7762248/find-all-zipcodes-within-specified-distance-of-a-zipcode)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-09T15:32:34.687

这个 API 让它变得非常简单 - [http://www.zipcodeapi.com/API#radiusSql](http://www.zipcodeapi.com/API#radiusSql)。格式是

```
http://www.zipcodeapi.com/rest/<api_key>/radius.<format>/<zip_code>/<distance>/<units> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:38:46.863

[Sql-wise，有人已经在这里](https://stackoverflow.com/questions/8343673/postgres-find-zip-codes-near-specific-zip-code)问过类似的问题。实现起来有点简单，并且会给你足够好的结果来测试你的规范。

否则，如果您可以找到每个 zip 都有 lat/long 的库，那么从地理接近度的角度来看它会很容易。然后，您应该寻找 Postgresql 邻近搜索。查找更多信息：http: [//www.boutell.com/zipcodes/](http://www.boutell.com/zipcodes/)和[http://www.geopostcodes.com/](http://www.geopostcodes.com/)

# ios - 检测从 iOS 谷歌 Chrome 浏览器安装的本机应用程序

> ID：14677389
> 
> 赞同：0
> 
> 时间：2013-02-03T21:15:00.537
> 
> 标签：ios, google-chrome

我正在尝试在我的网页上检测我未实现的本机应用程序，并且Safari Mobile有一个[解决方案。](https://stackoverflow.com/questions/1108693/is-it-possible-to-register-a-httpdomain-based-url-scheme-for-iphone-apps-like/1109200#1109200)解决方案提到了两种方法

1.  检测 appInstalled cookie：我的网页不能假设每个应用在安装应用或用户删除历史记录后都放置了 appInstalled cookie；因此，我的网页无法使用此方法。

2.  使用 javascript setTimeout 显示一个后备页面，当它实际上可以超时而无需转到本机应用程序时。这在 Safari 上完美运行；但是，Chrome 将忽略超时并显示未找到未处理的自定义方案的页面（即未安装应用程序）

有没有办法检测安装在 iOS Chrome 上的本机应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T00:51:42.360

回答这个问题：

[如何从 Chrome for iOS 打开带有后备的应用程序 URL](https://stackoverflow.com/questions/11298205/how-can-i-open-app-url-with-fallback-from-chrome-for-ios?rq=1)

根据上面链接中 ajwillia.ms 的上述回答，这里是在尝试从 Chrome for iOS 中打开本机应用程序时显示后备页面的功能。

```
// url is your app custom scheme.
// fallback is theaddress of fallback page.
// assumption: you are sure this is executing in Chrome for iOS.
function redirectTo_chrome_ios(url, fallback)
{
    //open a new tab to open the native app
    my_window = window.open(url, "_blank");
    //close the tab after some time 
    setTimeout(function(){ my_window.close(); }, 500);
    //redirect to fallback page regardless
    window.location = fallback;
} 
```

# python - 查询：为什么我的正则表达式代码没有读取所有字符？

> ID：14677397
> 
> 赞同：1
> 
> 时间：2013-02-03T21:15:50.173
> 
> 标签：python, regex, web-scraping

我有以下描述我想使用我的程序报废。

`<hr>`通过接触美国空军的职能、部署和就业行动，为 AFROTC 学员提供多达 13 个实际领导和专业培训选项。外语和文化沉浸也可用/可能，但总体重点仍然是领导力发展和实习。所有计划都在选定的空军基地和美国和国外的其他地点进行。`<br>`

我有以下代码：

```
findDescription = re.findall('<hr>(.*?)(?:<strong>|<br>)', coursePage) 
```

我得到以下输出：

['通过接触美国空军的职能、部署和就业行动，为 AFROTC 学员提供多达 13 个实际领导力和专业培训选项。\xc2\xa0 外语和文化沉浸也可用/可能，但总体重点仍然是领导力发展和实习。 \xc2\xa0 在选定的空军基地和美国和国外的其他地点进行的所有计划。']

为什么我`\xc2\xa0`在这里得到奇怪的东西？我的代码也被引号绊倒了`"`。坦率地说，我相信`.`我的正则表达式代码中的句点应该接受所有字符串。出了什么问题？

我感谢任何快速提示。我在星期五才听说正则表达式，我已经取得了巨大的进步，但是这个真的让我绊倒了几个小时。

热烈的问候， GeekyOmega

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T21:18:55.467

\xC2\xA0 是 Unicode 字符 0xA0 的 UTF-8 编码，通常写为   在 html 文件中。

# php - 从子页面帖子中检索值并重建父页面

> ID：14677400
> 
> 赞同：0
> 
> 时间：2013-02-03T21:16:15.147
> 
> 标签：php, javascript

我正在调用子页面并发布表格。尝试根据在子页面中输入的值刷新和重建父页面。我无法在父页面中看到子发布的值。

从父页面提交子项时填充预期值 $_POST['test_2']。我没有在父页面中看到子页面发布的值。请参阅下面的代码示例。感谢您的帮助。如果有任何其他更好的方法可以访问子页面提交的值并使用这些子页面值重建父页面，请告诉我。

父页面是：Example1Parent.php

```
<html>
<head>
<body>
<h1> Welcome Parent </h1>
<div id="dateDiv"></div>
<form method=post action='' name=f1>
<table border=0 cellpadding=0 cellspacing=0 width=550>
<tr>
<td ><font size=2 face='Verdana'>Refresh upon Search</font>
<input type=hidden name='p_name2' id=n2 size='8'> 
<input type=button 
onClick=window.open("Example1Child.php","Ratting","width=550,height=170,left=150,top=200,toolbar=0,status=0,"); value="Advanced Search">
<?php
echo '<br> Welcome ';
if (!isset($_POST['test_2'])) echo "<br> t_test2 : it does not exists! ";
?>
</td></tr> 
</table>
</form>
</body>
</html> 
```

子页面是：Example1Child.php

```
 <html>
 <head>
 <title>ChildForm</title>

 <SCRIPT language=JavaScript>
 <!-- 
 function win(){
 window.opener.location.href="Example1Parent.php";
 self.close();
 //-->
 }
</SCRIPT>
</head>
<body>
<h1> Welcome to Child </h1>
<form name="child"  id="child"  METHOD="POST" action=''>
<input type="text" id="test_2" name="test_2" value="ENTER DATA TO PARENT PAGE">
<INPUT TYPE="SUBMIT" onClick="win();" value="SEND VALUE TO PARENT">
</form>

</body> 
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:45:40.507

正如 tmuguet 提到的，您可能想要创建一种不同的方法，因为这是一种相当古老的方法。现在有一天，您可以使用弹出窗口/模态框等来获取值，然后使用 js/ajax 或诸如此类的东西更新页面。

我猜你正试图通过 js 通过窗口传递值，因为你打开窗口打开一个干净的链接（没有传递的值，即使你在表单方法中有'POST'），你可以使用类似的东西以下，但它只会给你 GET 值

```
<SCRIPT language=JavaScript>
<!-- 
    function win(){
        val = document.getElementById('test_2').value;//you will most likely need to encode this value if it has special characters
        window.opener.location.href="Example1Parent.php?test_2=" + val;
        self.close();
//-->
}
</SCRIPT> 
```

您正在寻找的是类似[Window.open 并通过 post 方法问题传递参数](https://stackoverflow.com/a/3951843/1700963)

```
<form id="child" method="post" action="Example1Parent.php" target="Parent">
    <!-- <form name="child"  id="child"  METHOD="POST" action=''> -->
    <input type="text" id="test_2" name="test_2" value="ENTER DATA TO PARENT PAGE">
    <INPUT TYPE="SUBMIT" onClick="win();" value="SEND VALUE TO PARENT">
</form>

<script type="text/javascript">
    function win(){
        var f = document.getElementById('child');
        f.test_2.value =  document.getElementById('test_2').value;
        window.open('Example1Parent.php', 'Parent');
        f.submit();
        self.close();
    }
</script> 
```

**我没有测试过这个脚本**

您可能想`var_dump($_POST)`在您的 Example1Parent.php 文件中执行一个以查看是否`f.test_2.value`转换为`$_POST['test_2']`

# python - Scipy Bodgy 曲线拟合

> ID：14677401
> 
> 赞同：1
> 
> 时间：2013-02-03T21:16:21.047
> 
> 标签：python, curve-fitting

我使用未校准的指南针在现场收集了简单的调查数据。意识到这个问题，在现场，将一个好的罗盘与未校准的罗盘进行了比较，并记录了 11 个方位的差异。该图显示差异非常接近 sin 函数。我希望将多项式（3 次）拟合到这个结果函数中，以使用未校准的罗盘来校正测量数据。我的曲线拟合程序产生的拟合曲线很差。谁能看到有什么问题？

```
import numpy as np
import scipy
import pylab
correctCompass=\
np.array([134.4,112.6,069.7,051.1,352.5,314.6,218.3,258.2,237.8,186.5,153.7])
errorCompass=\
np.array([131.6,108.9,065.6,047.0,349.8,314.0,284.6,262.7,243.4,189.8,153.2])
# sort compass values
for i in range(0,11):
   for j in range(i+1,11):
       if correctCompass[i] > correctCompass[j]:
          tmp=correctCompass[j]
          correctCompass[j]=correctCompass[i]
          correctCompass[i]=tmp
          tmp=errorCompass[j]
          errorCompass[j]=errorCompass[i]
          errorCompass[i]=tmp

diff = correctCompass - errorCompass + 15.0
height=diff.max() + 16.0
polycoeffs = scipy.polyfit(correctCompass, diff, 3)

# fit the data with a polynomial
yfit = scipy.polyval(polycoeffs,correctCompass)

pylab.plot(correctCompass, diff, 'k.')
pylab.plot(correctCompass, yfit, 'r-')

pylab.axis([0,360,-10.0,height])
pylab.show() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:49:24.087

`polyfit`工作正常，问题是`diff`降低拟合的一个负面因素，但当您将 yaxis 的最低值设置为 -10 时，这并没有显示在您的图中

```
diff = array([ 19.1,  19.1,  18.7,  17.8,  15.5,  11.7, -51.3,   9.4,  10.5, 15.6,  17.7]) 
```

如果您发表评论`pylab.axis([0,360,-10.0,height])`，您会看到“问题”

此外，您可以使用以下三行替换两个嵌套的 for 循环，从而改进代码并使代码更具可读性：

```
sort = np.argsort(correctCompass)
correctCompass = correctCompass[sort]
errorCompass = errorCompass[sort] 
```

# xcode - cocos2d中如何防止精灵做360翻转

> ID：14677402
> 
> 赞同：0
> 
> 时间：2013-02-03T21:16:20.893
> 
> 标签：xcode, cocos2d-iphone, rotation, sprite

所以基本上我有一个炮塔，我使用它旋转它以面对屏幕上的点击位置

```
[CCRotateTo actionWithDuration:duration angle:angle]; 
```

它在 90% 的时间内都有效，但有时我正在旋转的精灵会突然进行 360 度翻转，我不知道为什么，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:14:24.873

好的，我发现这是 cocos2d rotateto 类的错误，此链接帮助纠正了它 [http://www.cocos2d-iphone.org/forum/topic/56028](http://www.cocos2d-iphone.org/forum/topic/56028)

# java - 生成非 Eclipse 依赖的 ant 文件

> ID：14677406
> 
> 赞同：0
> 
> 时间：2013-02-03T21:16:34.050
> 
> 标签：java, eclipse, ant

**已解决（见下文）**

我在 Github 上有一个 Java 项目，我已经将它导入 Eclipse Juno 没有问题。在 Eclipse 中生成自动 ant 文件也不是问题。但是，当我将 build.xml 推送到 Github 存储库并将更新的存储库克隆到另一台机器并尝试运行 ant 时，不会创建 jar。

似乎没有办法在 Eclipse 中生成独立**于 Eclipse**的**ant**文件。这种印象对吗？我需要手动编辑 ant 文件吗？

这是一个超级简单的项目，一个文件定义了对象类型，另一个是单元测试。

```
src/main/Main.java
src/test/MainTest.java 
```

自动生成的 build.xml 如下所示：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir="." default="build" name="example">
    <property environment="env"/>
    <property name="junit.output.dir" value="junit"/>
    <property name="debuglevel" value="source,lines,vars"/>
    <property name="target" value="1.6"/>
    <property name="source" value="1.6"/>
    <path id="example.classpath">
        <pathelement location="bin"/>
        <pathelement location="../../../../usr/share/java/junit-4.8.2/junit-4.8.2.jar"/>
    </path>
    <target name="init">
        <mkdir dir="bin"/>
        <copy includeemptydirs="false" todir="bin">
            <fileset dir="src">
  ...... [edited]
 <target name ="makejar" description="Create a jar for the project">
    <jar jarfile="example.jar" includes="*.class" basedir="bin"/>
  </target>
</project> 
```

**通过手工制作一个非常简单的ant文件解决了问题：**

```
<?xml version="1.0"?>
<project name="example" default="main" basedir=".">

<property name="src.dir" location="src" />
<property name="build.dir" location="build" />

<target name="clean">
<delete dir="${build.dir}" />
</target>

<target name="makedir">
<mkdir dir="${build.dir}" />
</target>

<target name="compile" depends="clean, makedir">
<javac srcdir="${src.dir}" destdir="${build.dir}">
</javac>

</target>

<target name="jar" depends="compile">
<jar destfile="example.jar" basedir="${build.dir}">
<manifest>
<attribute name="Main-Class" value="main.Main" />
</manifest>
</jar>
</target>

<target name="main" depends="compile, jar">
<description>Main target</description>
</target>

</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:42:54.330

好的 - 如果您只是运行，则查看您的构建文件，`ant`您将获得默认目标`build`。

然后这将调用（基于依赖）：

`build-subprojects`- 什么也没做

`build-project`- 调用`init`将除java文件之外的所有内容复制`src`到`bin`目录中，然后回显一条消息，然后调用`javac`

没有目标`makejar`被调用的地方。您是否尝试过发布：

`ant`

接着

`ant makejar`

你当然可以通过像这样在构建文件中`makejar`依赖来定义它们`build`

```
<target name ="makejar" depends="build"description="Create a jar for the project">
    <jar jarfile="example.jar" includes="*.class" basedir="bin"/>
</target> 
```

但是我很难看到这个构建文件在其他地方是如何正确运行的。

# java - 一次在 Mockito 中连续两次调用方法？

> ID：14677408
> 
> 赞同：0
> 
> 时间：2013-02-03T21:17:00.383
> 
> 标签：java, junit, mockito

当我使用 Mockito 编写单元测试时，我经常会发现我在一个注入的模拟对象上调用了一个 getter，然后从返回的对象中调用一个方法。

到目前为止，我已经做了这样的事情：

```
 @Mock
    private Randomizer r;
    @Mock
    private Random random;
    @InjectMocks
    private NodeGenerator ng = new NodeGenerator();

    @Test
    public void nodeIsDuplicate() {

        when(r.getRandom()).thenReturn(random);
        when(random.nextInt(2)).thenReturn(1);
        [...]
    } 
```

但是，不得不模拟随机性并为它设置第二个时间似乎是一种浪费。有没有办法让我的 when 语句更像：

```
when(r.getRandom().nextInt(2)).thenReturn(1); 
```

无需模拟随机数，所以我可以只用我的 Randomizer 模拟在一条线上完成所有操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T21:21:32.380

你想要 Mockito 的[One liner stubs](http://docs.mockito.googlecode.com/hg/latest/org/mockito/Mockito.html#24)。

编辑：

经过仔细检查，这可能不是您正在寻找的内容，但它可以为您减少一些样板代码。

正如评论所暗示的那样，您正在寻找的 Wat 确实是[deep stubs](http://docs.mockito.googlecode.com/hg/latest/org/mockito/Mockito.html#RETURNS_DEEP_STUBS)。

对于您的示例，它将是：

```
Randomizer randomizer = mock(Randomizer.class, RETURNS_DEEP_STUBS);

when(randomizer.getRandom().nextInt(2)).thenReturn(1); 
```

# php - 谷歌地图与 php

> ID：14677416
> 
> 赞同：-1
> 
> 时间：2013-02-03T21:17:38.927
> 
> 标签：php, google-maps

我按照[本指南](https://developers.google.com/maps/articles/phpsqlajax_v3)使用 php 设置了谷歌地图脚本。

我复制了所有内容，按照他们所说的创建了表格并插入了记录。当我检查[xml 的输出时，](http://imrip.interhost.co.il/test/phpsqlajax_genxml3.php)一切都很好。当我[查看地图](http://imrip.interhost.co.il/test/phpsqlajax_map_v3.html)时，我看不到位置。

我没有提供代码，因为它是我附加的链接中代码的副本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:30:39.433

您在脚本中使用了错误的路径：

```
downloadUrl("phpsqlajax_genxml.php" 
```

但它必须是：

```
downloadUrl("phpsqlajax_genxml3.php"
//----------------------------^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:32:55.093

检查您的加载函数并确保传递给下载 url 函数时的 php 文件名正确

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-22T17:06:18.703

```
//.php create this form and paste it don't forget float datatype your attribute value in the database
//controller.php is when the action performed on controller.php when the user enter submit button
$action = (isset($_GET['action']) && $_GET['action'] != '') ? $_GET['action'] : ''; 
```

switch ($action) { case 'add' : doInsert(); 休息;

```
case 'edit' :
doEdit();
break;

case 'delete' :
doDelete();
break;

case 'photos' :
doupdateimage();
break;

case 'picture' :
UploadImage();
break;
}
function doInsert(){
    if(isset($_POST['save'])){
    if ( $_POST['LATITUDE'] == "" || $_POST['LONGITUDE'] == "" {
        $messageStats = false;
        message("All field is required!","error");
        redirect('index.php?view=add');
    }else{  
        $branch = New Branch();
        $branch->LATITUDE                       = $_POST["LATITUDE"];
        $branch->LONGITUDE                      = $_POST["LONGITUDE"];
        $branch->create();
        message("New Location created successfully!", "success");
        redirect("index.php");

    }
    }

}
//to control your navigation or your action add this code in to index.php 
$view = (isset($_GET['view']) && $_GET['view'] != '') ? $_GET['view'] : '';
$header=$view;
$title="Branch";
switch ($view) {
case 'list' :
    $content    = 'list.php';       
    break;

case 'add' :
    $content    = 'add.php';        
    break;

case 'edit' :
    $content    = 'edit.php';       
    break;
  case 'view' :
    $content    = 'view.php';       
    break;

default :
    $content    = 'list.php'; 
```

} ?> //add.php 找到您的纬度和经度位置编号并添加所需的字段纬度：

```
 <div class="col-md-8">
                     <input class="form-control input-sm" id="LATITUDE" name="LATITUDE" placeholder=
                        "latitude." type="text" value="" autocomplete="none">
                  </div>
                </div>
              </div>
<div class="form-group">
                <div class="col-md-8">
                  <label class="col-md-4 control-label" for=
                  "LONGTIUDE">Longtiude:</label>

                  <div class="col-md-8">
                     <input class="form-control input-sm" id="BRANCHCONTACTNO" name="LONGTIUDE" placeholder=
                        "Longtiude" type="text" value="" autocomplete="none">
                  </div>
                </div>
              </div> 
```

// view.php 添加这个以显示来自数据库的数据 Google Map LocationLATITUDE;?>,LONGITUDE; ?>&输出=嵌入">

# c++ - 如何将目录中具有完整路径的所有文件传递给 execv 中的参数数组？

> ID：14677418
> 
> 赞同：0
> 
> 时间：2013-02-03T21:17:47.533
> 
> 标签：c++, stdvector, execvp

我正在尝试读取给定目录中的所有文件（图片）并将其传递给 execv。我想启动帧缓冲图像查看器 (fbi)。

现在，当我从图片所在的目录启动它时，它可以工作。我如何操作矢量，使其不仅包含文件名，还包含路径+文件名？

```
int startSlideshow (char* pathtoFBI) {
pid_t fbiPid;

fbiPid = fork();

if (fbiPid == 0) {
    /* this is the child process */
    DIR *pictureDirectory;
    struct dirent *dir;
    int i = 0;
    vector<char*> argVector;
    char pDirectory[] = "/home/pi/bilder/";
    argVector.push_back(pathtoFBI);         /* first Argument is Program name */
    pictureDirectory = opendir(pDirectory);
    if (pictureDirectory){
        while ((dir = readdir(pictureDirectory)) != NULL) {
            i++;
            if (i > 2) {            /* first element is "." second is ".." */
                argVector.push_back(dir->d_name);
            }
        }
        //i -= 2;

    } else ERREXIT("reading picture directory");

    closedir(pictureDirectory);

    argVector.push_back(NULL);
    char** fbiArgv = &argVector[0];
    execvp(pathtoFBI, fbiArgv);         /* pid is taken over by fbi */
    _exit(EXIT_FAILURE);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:41:59.357

给定您的代码，您只需将 pDirectory 添加到每个文件名：

```
--- c1.cc       2013-02-04 02:35:47.000000000 +0400
+++ c2.cc       2013-02-04 02:39:03.000000000 +0400
@@ -8,7 +8,7 @@
     DIR *pictureDirectory;
     struct dirent *dir;
     int i = 0;
-    vector<char*> argVector;
+    vector<char*> argVector; vector<string> fpVector;
     char pDirectory[] = "/home/pi/bilder/";
     argVector.push_back(pathtoFBI);         /* first Argument is Program name */
     pictureDirectory = opendir(pDirectory);
@@ -16,7 +16,8 @@
         while ((dir = readdir(pictureDirectory)) != NULL) {
             i++;
             if (i > 2) {            /* first element is "." second is ".." */
-                argVector.push_back(dir->d_name);
+                fpVector.push_back(string(pDirectory) + dir->d_name);
+                argVector.push_back((char*) fpVector.back().c_str());
             }
         }
         //i -= 2; 
```

更一般地说，有 Boost Filesystem 的[absolute](http://www.boost.org/doc/libs/1_52_0/libs/filesystem/doc/reference.html#absolute)和[canonical](http://www.boost.org/doc/libs/1_52_0/libs/filesystem/doc/reference.html#canonical)。

# mysql - 使用 INNER JOIN 时出现模棱两可的错误

> ID：14677421
> 
> 赞同：2
> 
> 时间：2013-02-03T21:18:23.970
> 
> 标签：mysql, sql, oracle, oracle11g

我正在尝试从 depts 表中选择 deptno、dname 并将其与 emp 表连接以选择 empno 和 ename。然后我想按部门名称对它们进行分组，按 deptno 升序排序。
加入这两个表时，我不断得到“deptno”是模棱两可的。但这是加入表格的共同点。我的错误可能与任何有用的建议

```
SELECT deptno, dname, empno, ename
FROM dept INNER JOIN emp
ON dept.deptno = emp.deptno
GROUP BY dname
ORDER BY deptno ASC; 
```

感谢您提供任何有用的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T21:26:42.543

歧义来自`deptno`字段，该字段同时出现在表格`dept`和`emp`表格中。为避免它使用限定名称或别名。

```
SELECT D.deptno, dname, empno, ename
FROM dept D
    INNER JOIN emp E
        ON D.deptno = E.deptno
GROUP BY dname
ORDER BY D.deptno ASC; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T21:19:27.040

```
SELECT dept.deptno, dname, empno, ename FROM dept INNER JOIN emp ON dept.deptno = emp.deptno   
GROUP BY dname ORDER BY dept.deptno ASC; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T21:26:42.493

问题是您在两个表中都有，但您没有指定在and`deptno`中返回哪个表：`SELECT``ORDER BY`

```
SELECT dept.deptno, dname, empno, ename
FROM dept 
INNER JOIN emp
  ON dept.deptno = emp.deptno
GROUP BY dname
ORDER BY dept.deptno ASC; 
```

或者

```
SELECT emp.deptno, dname, empno, ename
FROM dept 
INNER JOIN emp
  ON dept.deptno = emp.deptno
GROUP BY dname
ORDER BY emp.deptno ASC; 
```

如果您没有为 指定表`deptno`，那么您将收到此错误消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T21:27:43.847

尝试这个

```
 SELECT dept.deptno, dname, empno, ename
 FROM dept INNER JOIN emp
 ON dept.deptno = emp.deptno
 GROUP BY dname
 ORDER BY dept.deptno ASC; 
```

# playframework-2.0 - 昆德拉用cassandra1.1.9和play framework2.0.4

> ID：14677426
> 
> 赞同：1
> 
> 时间：2013-02-03T21:18:53.583
> 
> 标签：playframework-2.0, cassandra, kundera

[我在 [ https://github.com/firekat/play-kundera]](https://github.com/firekat/play-kundera]) ( [https://github.com/firekat/play-kundera](https://github.com/firekat/play-kundera) )上尝试了 kundera cassandra over java play framework 2.0.4 示例。
我有异常..异常堆栈跟踪
`2013-02-03 22:56:35,201 - [ERROR] - from com.impetus.kundera.persistence.PersistenceValidator in play-akka.actor.actions-dispatcher-9 class models.User is not a JPA managed object as we couldn't find metadata for it. This object can't be persisted 2013-02-03 22:56:35,230 - [ERROR] - from application in play-akka.actor.actions-dispatcher-9 ! @6d86e1m37 - Internal server error, for request [GET /user/create/:Emin] ->`

`play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[KunderaException: java.lang.IllegalArgumentException: Entity object is invalid, operation failed. Please check previous log message for details]] at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:134) [play_2.9.1.jar:2.0.4] at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:115) [play_2.9.1.jar:2.0.4] at akka.actor.Actor$class.apply(Actor.scala:318) [akka-actor.jar:2.0.2] at play.core.ActionInvoker.apply(Invoker.scala:113) [play_2.9.1.jar:2.0.4] at akka.actor.ActorCell.invoke(ActorCell.scala:626) [akka-actor.jar:2.0.2] at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:197) [akka-actor.jar:2.0.2] at akka.dispatch.Mailbox.run(Mailbox.scala:179) [akka-actor.jar:2.0.2] at akka.dispatch.ForkJoinExecutorConfigurator$MailboxExecutionTask.exec(AbstractDispatcher.scala:516) [akka-actor.jar:2.0.2] at akka.jsr166y.ForkJoinTask.doExec(ForkJoinTask.java:259) [akka-actor.jar:2.0.2] at akka.jsr166y.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:975) [akka-actor.jar:2.0.2] at akka.jsr166y.ForkJoinPool.runWorker(ForkJoinPool.java:1479) [akka-actor.jar:2.0.2] at akka.jsr166y.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:104) [akka-actor.jar:2.0.2] Caused by: com.impetus.kundera.KunderaException: java.lang.IllegalArgumentException: Entity object is invalid, operation failed. Please check previous log message for details at com.impetus.kundera.persistence.EntityManagerImpl.persist(EntityManagerImpl.java:220) ~[kundera-core-2.3.jar:na] at controllers.KunderaApp.createUser(KunderaApp.java:26) ~[classes/:na] at Routes$$anonfun$routes$1$$anonfun$apply$5$$anonfun$apply$6.apply(routes_routing.scala:56) ~[classes/:na] at Routes$$anonfun$routes$1$$anonfun$apply$5$$anonfun$apply$6.apply(routes_routing.scala:56) ~[classes/:na] at play.core.Router$HandlerInvoker$$anon$5$$anon$1.invocation(Router.scala:1090) ~[play_2.9.1.jar:2.0.4] at play.core.j.JavaAction$$anon$1.call(JavaAction.scala:33) ~[play_2.9.1.jar:2.0.4] at play.db.jpa.TransactionalAction$1.apply(TransactionalAction.java:19) ~[play_2.9.1.jar:2.0.4] at play.db.jpa.TransactionalAction$1.apply(TransactionalAction.java:17) ~[play_2.9.1.jar:2.0.4] at play.db.jpa.JPA.withTransaction(JPA.java:104) ~[play_2.9.1.jar:2.0.4] at play.db.jpa.TransactionalAction.call(TransactionalAction.java:14) ~[play_2.9.1.jar:2.0.4] at play.core.j.JavaAction$class.apply(JavaAction.scala:74) ~[play_2.9.1.jar:2.0.4] at play.core.Router$HandlerInvoker$$anon$5$$anon$1.apply(Router.scala:1089) ~[play_2.9.1.jar:2.0.4] at play.core.ActionInvoker$$anonfun$receive$1$$anonfun$6.apply(Invoker.scala:126) ~[play_2.9.1.jar:2.0.4] at play.core.ActionInvoker$$anonfun$receive$1$$anonfun$6.apply(Invoker.scala:126) ~[play_2.9.1.jar:2.0.4] at play.utils.Threads$.withContextClassLoader(Threads.scala:17) ~[play_2.9.1.jar:2.0.4] at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:125) [play_2.9.1.jar:2.0.4] ... 11 common frames omitted Caused by: java.lang.IllegalArgumentException: Entity object is invalid, operation failed. Please check previous log message for details at com.impetus.kundera.persistence.PersistenceDelegator.persist(PersistenceDelegator.java:146) ~[kundera-core-2.3.jar:na] at com.impetus.kundera.persistence.EntityManagerImpl.persist(EntityManagerImpl.java:214) ~[kundera-core-2.3.jar:na] ... 26 common frames omitted`
你可能认为我创建了我的键空间和列族。这就是我在 cassandra -cli 中所做的，我检查了它是否正常工作，我可以通过 -cli
[screenshoot http://c1302.hizliresim.com/16/3/jqzdp.png插入数据](http://c1302.hizliresim.com/16/3/jqzdp.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T12:43:58.467

根据错误：

play.core.ActionInvoker$$anonfun$receive$1$$anon$1: 执行异常 [[PersistenceLoaderException: com.impetus.kundera.utils.InvalidConfigurationException: Duplicate persistence-units for name: cassandra_pu. 验证您的 persistence.xml 文件]] at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:82) [play_2.9.1.jar:2.0] at play.core.ActionInvoker$$anonfun$receive$1 .apply(Invoker.scala:63) [play_2.9.1.jar:2.0] at akka.actor.Actor$class.apply(Actor.scala:290) [akka-actor.jar:2.0] at play.core.ActionInvoker .apply(Invoker.scala:61) [play_2.9.1.jar:2.0] 在 akka.actor.ActorCell.invoke(ActorCell.scala:617) [akka-actor.jar:2.0] 在 akka.dispatch.Mailbox.processMailbox (Mailbox.scala:179) [akka-actor.jar:2.0] 在 akka.dispatch.Mailbox.run(Mailbox.scala:161) [akka-actor.jar:2.0] 在 akka.dispatch。 **引起：com.impetus.kundera.loader.PersistenceLoaderException：com.impetus.kundera.utils.InvalidConfigurationException：名称重复的持久性单元：cassandra_pu。验证您的 persistence.xml 文件** 在 com.impetus.kundera.configure.PersistenceUnitConfiguration.configure(PersistenceUnitConfiguration.java:103) ~[kundera-cassandra-2.2.1-jar-with-dependencies.jar:na] 在 com.impetus.kundera.configure.Configurator。配置（Configurator.java:64）~[kundera-cassandra-2.2.1-jar-with-dependencies.jar:na] at com.impetus.kundera.KunderaPersistence.initializeKundera（KunderaPersistence.java:103）~[kundera-cassandra -2.2.1-jar-with-dependencies.jar:na] 在 com.impetus.kundera.KunderaPersistence.createEntityManagerFactory(KunderaPersistence.java:81) ~[kundera-cassandra-2.2.1-jar-with-dependencies.jar: na] 在 javax.persistence.Persistence.createEntityManagerFactory（未知来源）~[kundera-cassandra-2.2.1-jar-with-dependencies.jar:na] 在 javax.persistence.Persistence.createEntityManagerFactory（未知来源）~[kundera-卡桑德拉-2.2。1-jar-with-dependencies.jar:na]

====================================我建议你在（META-INF/persistence .xml) 并尝试运行它。

-维维克

# wolfram-mathematica - 复杂表达式的简化

> ID：14677428
> 
> 赞同：0
> 
> 时间：2013-02-03T21:19:02.480
> 
> 标签：wolfram-mathematica

前几天我想简化以下表达式：

```
a Conjugate[a]//FullSimplify 
```

伟大的！我们得到的答案是 Abs[a]^2。现在我尝试了这样的事情：

```
a b Conjugate[a]//FullSimplify (*a Conjugate[a] b will return the same output*) 
```

不幸的是，它没有被简化。LeafCount 比 Abs[a]^2 b 更喜欢未简化的表达式。ComplexityFunction 应该能够解决这个问题： [ComplexityFunction](http://reference.wolfram.com/mathematica/ref/ComplexityFunction.html)

我使用了上面链接中提供的功能：

```
f[e_] := StringLength[ToString[InputForm[e]]]
FullSimplify[a Conjugate[a] b, ComplexityFunction -> f] 
```

而且我仍然得到不需要的形式。

有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T00:15:53.570

我刚刚从 StackExchange 的问题中了解到这[一点](https://mathematica.stackexchange.com/questions/19855/simplify-sinx-x-to-sincx)。你可以这样做：

```
f[expr_]:=expr/.x_*Conjugate[x_]:>Abs[x]^2
Simplify[a Conjugate[a] b,TransformationFunctions->{Automatic,f},ComplexityFunction->(StringLength[ToString[InputForm[#]]]&)] 
```

它会给`b Abs[a]^2`。

# c# - 如何在 WinForms c# 中为精灵设置动画以实现弹丸运动？

> ID：14677429
> 
> 赞同：0
> 
> 时间：2013-02-03T21:19:03.927
> 
> 标签：c#, sprite, simulation, physics, motion

我已经开发了抛丸运动物理学背后的算法。我**唯一**的问题是在表格上绘图。我将如何从头开始实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:33:34.717

这个问题有点太笼统了，但只是为了说明一下，我认为您可能想要创建一个`PictureBox`控件并在其上绘制，而不是在具有您的控件和设置的实际表单上。

例如，以下是您如何为图片框创建`Graphics`对象，然后在其上[画一条线： 在 PictureBox 上从父级画一条线](https://stackoverflow.com/questions/8947119/draw-a-line-on-picturebox-from-parent)

现在，我相信您的模拟实际上应该在新计算的 (x,y) 和先前计算的之间画线，以便绘制一条完整的线而不是点，这可能会发生在一个循环中，其中你改变`t`（时间）的间隔。

# java - 我在android java中找不到错误

> ID：14677430
> 
> 赞同：-3
> 
> 时间：2013-02-03T21:19:10.313
> 
> 标签：java, android

我正在尝试将 SimpleCursorAdapter 与 listView 一起使用，但我无法管理它。我厌倦了寻找我找不到的错误。感谢您的帮助。

这是java代码。

```
public class ButceGetirenListView extends ListActivity {

    ListView listLiewGetiren;
    TextView textButceGetirList1;
    TextView textButceGetirList2;
    SimpleCursorAdapter adapter;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.butcegetir);

        listLiewGetiren=(ListView)findViewById(R.id.list);

        String[] from=new String[25];
        from[0]="asa";
        from[1]="deneme";

        int[] to={R.id.textButceGetirList1,R.id.textButceGetirList2};

        adapter=new SimpleCursorAdapter(this, R.layout.butcegetirlist, null, from, to, 0);
        listLiewGetiren.setAdapter(adapter);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.butcegiris_xml, menu);
        return true;
    }

    public boolean onOptionsItemSelected(MenuItem item) {

        switch (item.getItemId()) {
        case R.id.birinciSayfa:
             Intent intent = new Intent(ButceGetirenListView.this, Butcegiris.class);
            startActivity(intent);          return true;

        case R.id.ikinciSayfa:

            Intent intent1 = new Intent(ButceGetirenListView.this, Butcehesapla.class);
            startActivity(intent1);
            return true;

        }
        return false;
    }
    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
    }
} 
```

这是错误日志；

```
02-03 20:48:10.922: E/AndroidRuntime(441): FATAL EXCEPTION: main
02-03 20:48:10.922: E/AndroidRuntime(441): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.deitel.btc/com.deitel.btc.ButceGetirenListView}: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.os.Handler.dispatchMessage(Handler.java:99)
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.os.Looper.loop(Looper.java:123)
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.app.ActivityThread.main(ActivityThread.java:4627)
02-03 20:48:10.922: E/AndroidRuntime(441):  at java.lang.reflect.Method.invokeNative(Native Method)
02-03 20:48:10.922: E/AndroidRuntime(441):  at java.lang.reflect.Method.invoke(Method.java:521)
02-03 20:48:10.922: E/AndroidRuntime(441):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
02-03 20:48:10.922: E/AndroidRuntime(441):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
02-03 20:48:10.922: E/AndroidRuntime(441):  at dalvik.system.NativeStart.main(Native Method)
02-03 20:48:10.922: E/AndroidRuntime(441): Caused by: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.app.ListActivity.onContentChanged(ListActivity.java:245)
02-03 20:48:10.922: E/AndroidRuntime(441):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:201)
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.app.Activity.setContentView(Activity.java:1647)
02-03 20:48:10.922: E/AndroidRuntime(441):  at com.deitel.btc.ButceGetirenListView.onCreate(ButceGetirenListView.java:31)
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-03 20:48:10.922: E/AndroidRuntime(441):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
02-03 20:48:10.922: E/AndroidRuntime(441):  ... 11 more 
```

和butcegetir xml；

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:gravity="center" >

    <TextView
        android:id="@+id/listView"
        android:text="@string/titleButceGetir"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="15dp"
        android:gravity="center"
        android:padding="15dp" >

    </TextView>
    <ListView
        android:id="@+id/list"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="15dp"
        android:gravity="center"
        android:padding="15dp" > 
    </ListView>

</LinearLayout> 
```

和 butcegetirlist xml；

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/textButceGetirList1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="left"
        android:layout_weight="1"
        android:text="@string/stringButceGetirList1" />

    <TextView
        android:id="@+id/textButceGetirList2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="right"
        android:layout_weight="1"
        android:text="@string/stringButceGetirList2" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:21:35.640

看看你的 LogCat 异常：

```
Caused by: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list' 
```

您当前正在创建自己的`list`ID（通过使用`@+id`）而不是使用 Android 的（在 下`@android:id`）。

在您的 XML 中，更改`android:id="@+id/list"`为：

```
android:id="@android:id/list" 
```

然后，在您的 Java 文件中，更改`findViewById(R.id.list)`为：

```
findViewById(android.R.id.list) 
```

# facebook - 如何获取 facebook 的（静态）访问令牌

> ID：14677433
> 
> 赞同：4
> 
> 时间：2013-02-03T21:19:40.993
> 
> 标签：facebook, facebook-graph-api

我有一个将访问 FB Graph Api 的后端服务器。作为对 FB Graph Api 的请求的一部分，我想提供访问令牌。

我想知道如何以及在哪里可以生成这样一个永不过期的（静态）访问令牌。请注意，我不是为已登录的用户调用 api，而只是为我们的后端服务器调用 api。

请注意，我们有一个 Facebook 页面，所以如果我们能够为这个“帐户”生成一个访问令牌，我认为这就足够了，但是在哪里/如何做到这一点。

我们正在为 Twitter 做类似的事情，但我们只是创建一个应用程序，并生成访问令牌。完美运行。

# apache-flex - 私有属性的名称 [Binable] 生成

> ID：14677438
> 
> 赞同：0
> 
> 时间：2013-02-03T21:20:24.357
> 
> 标签：apache-flex, data-binding, actionscript

我的 ActionScript 类中有一个可绑定的公共属性，我想访问由 [Bindable] 标记生成的私有 var。

例如，如果我声明：

```
[Bindable] public var yummyTime:String = "abcdefghij"; 
```

在运行时，它将值存储在一个名为`_719695190yummyTime`. 有谁知道我怎么能预测这个名字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:36:48.090

即使你可以预测那个名字；您将无法在编译时访问它，因为您会收到未定义变量的编译器错误。为什么需要访问它？

我怀疑你想做的任何事情都可以通过将你的公共变量定义扩展为定义了 Bindable 事件的 get/set 方法来完成。像这样：

```
private var _yummyTime : String = 'abcdefghij'
[Bindable(event='yummyTimeChanged'] 
public function get yummyTime():String{
 return _yummyTime;
}

public function set yummyTime(value:String):void{
 _yummyTime = value;
 dispatchEvent(new Event('yummyTimeChanged'));
} 
```

然后在您的组件中，您将拥有私有变量 _yummyTime 和公共变量 yummyTime。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:45:44.107

这个：

```
[Bindable] public var yummyTime:String; 
```

和写法一样：

```
 private var _yummyTime:String;
 [Bindable]
 public function get yummyTime():String
 {
     return _yummyTime;
 }   
 public function set yummyTime(value:String):void
 {
     _yummyTime = value;
 } 
```

在第二个代码片段中，您刚刚明确写出了私有变量的 getter 和 setter。

另请注意，[Bindable] 标签在 setter 函数中添加了一个特殊检查，如下所示：

```
 private var _yummyTime:String;
    [Bindable(event="yummyTimeChange")]
    public function get yummyTime():String
    {
        return _yummyTime;
    }

    public function set yummyTime(value:String):void
    {
        if( _yummyTime !== value)
        {
            _yummyTime = value;
            dispatchEvent(new Event("yummyTimeChange"));
        }
    } 
```

如果您不希望检查**if( _yummyTime !== value)**您可以在 [Bindable] 标记中添加自定义事件名称，就像我给出的最后一个示例一样，只是不要写出检查。

# java - 如何从 JTidy 中删除所有输出？

> ID：14677439
> 
> 赞同：2
> 
> 时间：2013-02-03T21:20:44.503
> 
> 标签：java, xml, jtidy

我正在使用 JTidy 清理一些 XML，如下所示：

```
Tidy tidy = new Tidy();
tidy.setXmlOut(true);
tidy.setShowWarnings(false);
tidy.parse(new FileInputStream(strStrippedHTMLPath), new FileOutputStream(strXMLPath)); 
```

问题是它总是输出以下内容：

```
InputStream: Document content looks like HTML 4.01
5 warnings, no errors were found! 
```

我怎样才能防止它输出任何东西？我试过：

```
tidy.setShowErrors(0);
tidy.setQuiet(true);
tidy.setErrout(null); 
```

，如此处所示[，](https://stackoverflow.com/questions/6213764/how-to-remove-the-warnings-in-jtidy-in-java)但这也不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:25:24.000

好吧，总是有：

```
PrintStream oldErr = System.err();
ByteArrayOutputStream baos = new ByteArrayOutputStream();
PrintStream newErr = new PrintStream(boas);
System.setErr(newErr);
tidy.parse(...);
System.setErr(oldErr); 
```

最好使用某种 Null 输出流（显然 Apache Commons 有这样的野兽）。但它的要点是一样的。

当然，这有点小题大做……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-10T06:36:36.007

而不是`tidy.setErrout(null);` 使用`tidy.setErrout(new PrintWriter(new ByteArrayOutputStream()));` 这似乎对我有用。

# jquery - Ruby on Rails $.ajax({dataType: 'script'}) 使用 respond_to format.js 和 format.json 提交表单

> ID：14677442
> 
> 赞同：2
> 
> 时间：2013-02-03T21:21:08.207
> 
> 标签：jquery, ruby-on-rails, json

我有一个通过 ajax 提交的表单。如果表单成功提交，页面将重定向到别处。如果表单失败，我会使用部分 (.js.erb) 和内联错误重新呈现表单。

这很好用。

我遇到的问题是我希望在页面重新呈现时必须将某种类型的 json 响应/数据发送回 application.js。只是，我不确定这是否可能。

//application.js

```
$(document).on('click','#sumbit_div',function(e) {
$.ajax({
   url: '/create',
   type: 'post',
   dataType: 'script',
   data: $('#the_form').serialize(),
   cache: false,
   success: function(xhr,data) {
     console.log('success');
   },
   error: function(data) {
     console.log('error')
     console.log(data.value_from_format_json);
   },
});
}); 
```

//在控制器中创建动作。

```
rescue ActiveRecord::RecordInvalid => e

respond_to do |format|
format.json {render :json => { :status => 403,:success => false }}  
format.js
end 
```

我认识到即使提交失败也是 .ajax 响应中的成功。我可以处理之后如何处理。现在我只想知道我是否能完成我所追求的。

最后一点是这是在 Rails 2.3 上（仍在升级过程中）。但我有所有 jquery 库（rails.js/jquery.js/etc）更新以使用 ujs。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:25:17.857

你不应该向 application.js*发送*数据，而应该让 application.js从你的 DOM 中*拉取数据。*让您的 create.js.erb 修改 DOM，以便 application.js 捕获它。

或者更好的是，从你的 create.js.erb 调用你想要的函数，传递你想要的参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:26:10.217

我想您需要将 dataType 更改为 json 以获得“json”响应或“js”以获得 js 响应。

# c++ - 如何计算具有 n 位小数的浮点数

> ID：14677448
> 
> 赞同：31
> 
> 时间：2013-02-03T21:21:40.673
> 
> 标签：c++, formatting, cout

> **可能重复：**
> [如何使用 cout 以全精度打印双精度值？](https://stackoverflow.com/questions/554063/how-do-i-print-a-double-value-with-full-precision-using-cout)

```
float a = 175.;
   cout << a; 
```

如果我运行前面的代码，我只会得到 175，我怎么能用（例如）3 个小数位来计算这个数字，即使它们是零.. 我怎样才能打印“175.000”？！

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-02-03T21:27:30.470

你需要[`std::fixed`](http://en.cppreference.com/w/cpp/io/manip/fixed)和[`std::setprecision`](http://en.cppreference.com/w/cpp/io/manip/setprecision)：

```
 std::cout << std::fixed << std::setprecision(3) << a; 
```

这些需要以下标题：

```
#include <iomanip> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T21:24:26.967

尝试`setprecision`：

```
cout.setf(ios::fixed);
cout << setprecision(3) << a << endl; 
```

# c# - 解析 Web 服务的结果

> ID：14677450
> 
> 赞同：0
> 
> 时间：2013-02-03T21:21:49.680
> 
> 标签：c#, parsing, service, deserialization

我有一个 Web 服务，在调用它并获取结果后，我无法将结果放入对象数组中。

我正在使用 C# 代码并寻找一种反序列化这些结果的方法，希望有人可以帮助或告诉我应该走的路。

注意：单引号被替换为`\u2019`所以是否有一个特殊字符 unicode 表可以在返回的结果中找到以便我可以替换它们？

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:42:28.933

我使用 JavaScriptSerializer 处理 JSON 数据。（通常，我会添加我从 TekPub 了解到的[自定义转换器，以将 DateTimes 格式化为一个不错的字符串。）](https://github.com/tekpub/mvc3/blob/master/Source/VidPub.Web/App/Infrastructure/ExpandoObjectConverter.cs)

它真的很容易使用：

```
 using (var web = new WebClient())
    {
        var url = "http://[fill in your url here]";
        var jsonStr = web.DownloadString(url);
        var serializer = new JavaScriptSerializer();

        IDictionary<string, object> objGraph = (IDictionary<string, object>)serializer.DeserializeObject(jsonStr);

        Console.WriteLine(objGraph["has_next"]);
        Console.WriteLine(((Object[])objGraph["object_list"]).Length);
    } 
```

在示例代码中，我将结果作为动态对象处理，但如果您知道结构，则可以将结果映射回类型化对象。

# javascript - 如何替换脚本元素？

> ID：14677460
> 
> 赞同：2
> 
> 时间：2013-02-03T21:23:14.363
> 
> 标签：javascript

我想删除一个脚本元素并将其替换为不同的元素。可以说你

```
<html>
<head>
<script src="default.js">
</head> 
```

我想要做的是删除 default.js 并单击按钮将其替换为 new.js 。我知道您可以创建这样的脚本：

```
var new_scr=document.createElement('script'); 
new_scr.src="new.js"; 
document.getElementsByTagName('head')[0].appendChild(new_scr); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-01-14T12:10:17.913

只是偶然发现了这一点，并认为我会为所有不再使用 JQuery 的人记下一个香草解决方案。

```
 const newScript = document.createElement('script')
  const oldScript = document.querySelector('script[src*="default"]')
  newScript.src = 'new.js'
  oldScript.parentNode.insertBefore(newScript, oldScript.nextSibling)
  oldScript.parentNode.removeChild(oldScript) 
```

就像其他答案概述了替换脚本的唯一方法是找到它，在它之后放置一个新的，然后删除原来的。

享受 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:49:04.313

您可以为脚本标签设置 id 并根据 id 更改内容，而不是用新的替换它。

或以下可能对您有用的代码块。

```
var $jsRef = $('<script type="text/javascript" >').appendTo(document.body);
$jsRef.attr("src","jsFileName.js");

// You can also add content like this
$jsRef.append(content);

// You can change the js file name or content the same way
$jsRef.attr("src","newJSFileName.js");

// Changing the content like this
$jsRef.empty();
$jsRef.append(content); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:25:09.050

我不认为你可以“替换”它。在您的 javascript 有机会替换它之前，代码将在页面加载时被解析。因此，即使您加载其他内容，该 javascript 也将已经在运行，即在内存中。我可能有点离谱，但我不认为你可以“替换”一个脚本，除非你真的覆盖了它建立的项目。

# c++ - 从 C++ 运行命令

> ID：14677464
> 
> 赞同：-4
> 
> 时间：2013-02-03T21:24:04.073
> 
> 标签：c++, linux, command-line

要在 Linux 中从 C++ 获取 cpu 信息，我只需使用：

> if (!system("cat /proc/cpuinfo")) cout << "错误" << endl;

更新：问题是我没有输出

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:25:39.270

它告诉您`system`返回一个值，而您没有检查它，因此（在这种情况下）如果`system`失败，您将不知道它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T21:27:41.680

假设您想在 Linux 上以编程方式获取有关 CPU 的信息（而不仅仅是`/proc/cpuinfo`在*标准输出*终端上显示，就像您的调用`system`那样），您应该更好地阅读文件`/proc/cpuinfo`，例如

```
 ifstream fcp("/proc/cpuinfo");
  std::string lin;
  while (!fcp.eof()) {
     lin = fcp.getline ();
     // parse appropriately the file fcp, e.g.
     if (lin.find("vendor_id") >= 0) 
       // do something useful 
```

上面的代码片段不完整。您必须完成它才能从`/proc/cpuinfo`您真正想要的信息中提取。

当然，您可以通过其他方式阅读（`/proc/cpuinfo`例如`fopen`，，à la C）....如果您真的想阅读某些命令的输出（在您的情况下它是无用的）考虑`fgets``sscanf``popen`

[只需调用uname(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/uname.2.html)系统调用（它提供的信息远少于） ，您可能会很高兴`/proc/cpuinfo`。

* * *

谷歌搜索*cpufreq*或*cpufrequtils*给出了[这个](https://docs.google.com/viewer?a=v&q=cache%3amafyVZXA5NQJ%3apublib.boulder.ibm.com/infocenter/lnxinfo/v3r0m0/topic/liaai/cpufreq/liaai-cpufreq_pdf.pdf%20&hl=fr&pid=bl&srcid=ADGEEShgawrpTTCM60Zq2URdRADq2dk4eUj4NjCWs9AYcMQI54-YDd8UkciAf3wrxkrXM2AaUCRD5-lxQ8uLFihSE6T4M5QMfdU90mAPA0f6XRYc44gr9EytmkJXGD0zZRzPeFlXLlUH&sig=AHIEtbSq3LGZkpcBGvd0Usw3CrZ7W-2r4A)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T21:26:01.997

该函数返回一个值，指示调用是否成功。

您的程序忽略了这个值，这可能会导致潜在的问题。

这就是您收到编译器警告的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T21:28:02.787

这是一个编译器警告，告诉您您的代码可能不是您*想要*编写的。`system`C++ 中的函数返回一个值，该`int`值*通常*包含您运行的命令的状态代码`system`。

在这种情况下，如果该数字不是 0（即`if(system("cat /proc/cpuinfo") != 0)`），您可能需要进行错误处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T20:13:33.237

Linux 有一个独特的 open 函数`popen`，它允许您连接到终端命令的标准输出。

您可以使用以下代码读取终端命令的任何输出：

```
FILE *pF = popen(aCmd, "r");

if(!pF)
{
    return "ERROR";
}

char cChar = '\0';
std::string rtnStr = "";

while(!feof(pF))
{
    cChar = fgetc(pF);

    if(cChar == '\n')
    {
        break;
    }

    rtnStr += cChar;
} 
```

并使用命令`cat /proc/cpuinfo`获取 CPU 信息。您还可以在`| grep`后面添加诸如“MHz”、“型号”或“核心”之类的内容以获取详细信息。

# laravel - Laravel 4：如何从 Laravel 3 安装 Meido 表单和 HTML 端口

> ID：14677468
> 
> 赞同：-1
> 
> 时间：2013-02-03T21:24:45.223
> 
> 标签：laravel, composer-php, laravel-4

我想在 Laravel 4 中使用 Form 和 HTML 类，所以我去了 Meido 的 GitHub 页面获取[HTML](https://github.com/meido/html)和[Form](https://github.com/meido/form)端口。我按照信中的指示进行了操作。我将这些行添加到我的应用程序的提供程序中：

```
'Meido\Form\FormServiceProvider',
'Meido\HTML\HTMLServiceProvider', 
```

我将这些行添加到我的别名中：

```
'Form' => 'Meido\Form\FormFacade',
'HTML' => 'Meido\HTML\HTMLFacade', 
```

这是`composer.json'

```
{
    "require": {
        "laravel/framework": "4.0.*",
        "meido/form": "1.1.*",
         "meido/html": "1.1.*"
    },
    "autoload": {
        "classmap": [
            "app/commands",
            "app/controllers",
            "app/models",
            "app/database/migrations",
            "app/tests/TestCase.php"
        ]
    },
    "minimum-stability": "dev"
} 
```

`composer install`我按照指示跑了。作曲家让我跑，我就跑`update`了。Composer 更新了许多依赖项，包括 Laravel 4 的一些核心。我的应用程序现在完全崩溃了。我只是在任何页面上都出现白屏。我没有收到任何错误消息来调试问题。甚至视图源都是空白的。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:35:59.797

Laravel 4 仍在开发中，我发现如果不重新安装某些文件，更新的依赖项将无法始终正常工作。

受此影响的主要文件将是：

/app/config/app.php /start.php

我建议从存储库中获取这些文件的新副本并在您的项目中替换它们，然后使用 composer 再次更新并重新生成您的自动加载文件（composer dump-autoload）。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T02:26:41.793

尝试运行`composer dump-autoload`，看看问题是否消失。

我有一个名为[Laravel 4 Powerpack](https://github.com/laravelbook/laravel4-powerpack)的包——它将许多 L3 辅助类（HTML、Form、Str）组合到一个包中。github页面上提供了详细的安装说明。

为了让一个新的应用程序加快速度，我还创建了[Laravel 4 入门模板](https://github.com/laravelbook/laravel4-starter)——它结合了 Powerpack 和 Ardent O/RM 增强器。

尽管 L4 处于第二个测试阶段，但它仍在进行大量的积极开发。运行“作曲家更新”后，我发现我的应用程序不时损坏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T15:05:58.450

对于其他观看此内容的人，您可以使用 git 通过恢复为标签来轻松修复它。

```
git tag -l 
```

寻找你想要的标签（在我的例子中是 v4.0.0-BETA3。）

```
git checkout v4.0.0-BETA3 
```

这将使您处于“分离头”状态，因此如果您想继续，您需要创建一个新分支：

git checkout -b v4.0.0-BETA3

那个特定的标签对我有用。

# java - Java 将 10 读取为 2 个字符，如何更改

> ID：14677469
> 
> 赞同：1
> 
> 时间：2013-02-03T21:24:59.217
> 
> 标签：java, arrays, char

该程序在`int`数组不需要数到 10 时有效。我的问题是将`charat`10 读取为两个不同的字符，它们是。我怎样才能为 10 破例？例如下面的程序，当你输入 5 个人时，程序从 6-1 打印出来，因为 1 是从 10 的第一个字符读取的。当你输入 6 时，`charat`是读取 0，所以它打印出来6-0。

```
package javaapplication2;

import java.util.*;

public class JavaApplication2 {

    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        System.out.println("Enter the amount of people in your group, up to 6");
        int num = input.nextInt();

        if (num > 6) {
            System.out.println("You have exceeded the maximum amount of people allowed.");
        }

        int highest = num - 1;
        String available = "";
        String booking = " ";
        int[] RowA = {0, 0, 1, 1, 1, 0, 0, 0, 0, 0};

        for (int i = 0; i < RowA.length; i++) {
            if (RowA[i] == 0) {
                available = available + (i + 1);
            }
            if (available.length() > booking.length()) {
                booking = available;
                System.out.println(booking);
            } else if (RowA[i] == 1) {
                available = "";
            }
        }

        if (num <= booking.length()) {
            char low = booking.charAt(0);
            char high = booking.charAt(highest);
            System.out.println("There are seats from " + low + " - " + high + ".");
        } else {
            System.out.println("The desired seat amount is not available. The maximum amount on Row is " + booking.length());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:32:47.100

如果您使用的是输入字符串：

由于 booking 是一个字符串，因此使用子字符串将 low 和 high 的值捕获为整数会更方便。例如像这样：

```
if (num <= booking.length()) {
    int lineIndex = booking.indexOf("-");
    if (lineIndex < 0)
        lineIndex = booking.indexOf("/");

    int low = Integer.parseInt(booking.substring(0, lineIndex);
    int high = Integer.parseInt(booking.substring(lineIndex+1, booking.length());
} 
```

System.out.println() 将以它们现在的形式正确解析整数。额外的检查是为了防止您使用的分隔符号不仅仅是“-”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:48:32.233

所以你正在做的是一种叫做原始痴迷的代码味道。您正在使用字符串，而应该使用更复杂的数据类型，例如集合或数组：

```
import java.util.*;

public class JavaApplication2 {

    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        System.out.println("Enter the amount of people in your group, up to 6");
        int num = input.nextInt();

        if (num > 6) {
            System.out.println("You have exceeded the maximum amount of people allowed.");
        }

        int highest = num - 1;
        ArrayList<Integer> available = new ArrayList<Integer>();
        Integer[] booking = new Integer[0];
        int[] RowA = {0, 0, 1, 1, 1, 0, 0, 0, 0, 0};

        for (int i = 0; i < RowA.length; i++) {
            if (RowA[i] == 0) {
                available.add(i + 1);
            }
            if (available.size() > booking.length) {
                booking = available.toArray(booking);
                System.out.println(Arrays.toString(booking));
            } else if (RowA[i] == 1) {
                available.clear();
            }
        }

        if (num <= booking.length) {
            int low = booking[0];
            int high = booking[highest];
            System.out.println("There are seats from " + low + " - " + high + ".");
        } else {
            System.out.println("The desired seat amount is not available. The maximum amount on Row is " + booking.length);
        }
    }
} 
```

使用集合和数组意味着您不必担心`charAt`小数位数，因为您实际上是在操作`int`和`Integer`类型 - 这将自行跟踪它们的小数。

# xcode - 如何从 Three20 的 TTThumbsViewConroller 中删除底部灰色条？

> ID：14677470
> 
> 赞同：0
> 
> 时间：2013-02-03T21:25:08.160
> 
> 标签：xcode, uinavigationbar, thumbnails, three20, ttthumbsviewcontroller

我正在使用 Three20 查看相册中的图片缩略图。一切正常，但我无法删除导航栏底部的灰色栏。谁知道怎么去掉这个栏？

![在此处输入图像描述](../Images/c6dd09fd3215821c7c2de46fcaed0326.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T04:48:32.140

解决了。必须禁用 tableView 中的部分。感谢 Shizam，我正在尝试 AQGridView 作为替代方案。

# ios - 创建具有多个对象/层的视图

> ID：14677479
> 
> 赞同：-3
> 
> 时间：2013-02-03T21:25:32.110
> 
> 标签：ios, ios5, uiview, uiviewcontroller

我正在寻找有关如何在代码中创建复杂视图的教程。

例如，视图的背景图像，带有按钮的多个子视图。

有没有关于如何完成这个的教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:39:23.930

您应该阅读[iOS 中的 View Controller Programming Guide](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html#//apple_ref/doc/uid/TP40007457-CH1-SW1)以及[UIView 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-DontLinkElementID_1)。

可以通过使用给 UIView 对象多个子视图

```
- (void)addSubview:(UIView *)view 
```

UIView 对象的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:41:53.780

您可以使用 addSubview：

```
UIView *view =[[UIView alloc] initWithFrame:CGRectMake(0, 0, 320,200)];
UIImageView *imgV =[[UIImageView alloc] initWithFrame:CGRectMake(0,0,320,460)];
UIButton *btn1 =[[UIButton alloc] initWithFrame:CGRectMake(0, 0, 100,75)];

imgV.image = [UIImage imageNamed:@"background.png"];
[btn1 setTitle:@"Btn" forState:UIControlStateNormal];
[btn1 addTarget:self action:@selector(myAction:) forControlEvents:UIControlEventTouchUpInside];

[view addSubview:imgV];
[view addSubview:btn1];

[self.view addSubview:view]; 
```

这将创建一个带有背景图像和按钮的视图，如果您理解这个概念，那么您可以添加任意数量的对象。

# r - 在R中重新排列多个矩阵的形状

> ID：14677485
> 
> 赞同：4
> 
> 时间：2013-02-03T21:25:48.027
> 
> 标签：r, csv, dataset, social-networking, import-from-csv

这是一个双管**R**问题。我有一个数据集文件夹（在 .csv 中），需要在分析之前对其进行更改。每个数据集都是一个 1X10 矩阵，如：

```
1 2 3 4 5 6 7 8 9 10 
```

并需要将其转换为以下 5X5 矩阵，在对角线上插入 1：

```
1
1 1 
2 3 1
4 5 6 1
7 8 9 10 1 
```

如何对文件夹中的多个文件完成这种转换？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T21:55:10.403

试试这个：

```
dir.in  <- "aaa"  # replace with your own input dir
dir.out <- "bbb"  # replace with your own output dir

files.in  <- list.files(dir.in, full.names = TRUE)
files.out <- file.path(dir.out, basename(files.in))

data.in <- lapply(files.in, scan, sep = ",")

mat.out <- lapply(data.in, function(x){ M <- diag(1, 5)
                                        M[upper.tri(M)] <- x
                                        t(M) })

mapply(write.csv, mat.out, files.out, col.names = FALSE, row.names = FALSE) 
```

# google-chrome - 使用 CSS 变换后模糊文本：scale(); 在铬

> ID：14677490
> 
> 赞同：161
> 
> 时间：2013-02-03T21:26:05.043
> 
> 标签：google-chrome, css, webkit, transform, css-animations

似乎最近对 Google Chrome 进行了更新，导致在执行`transform: scale()`. 具体来说，我正在这样做：

```
@-webkit-keyframes bounceIn {
  0% {
    opacity: 0;
    -webkit-transform: scale(.3);
  }

  50% {
    opacity: 1;
    -webkit-transform: scale(1.05);
  }

  70% {
    -webkit-transform: scale(.9);
  }

  100% {
    -webkit-transform: scale(1);
  }
} 
```

如果您在 Chrome 中访问[http://rourkery.com](http://rourkery.com)，您应该会在主文本区域看到问题。它以前没有这样做，它似乎不会影响其他 webkit 浏览器（如 Safari）。还有其他一些关于人们在 3d 变换中遇到类似问题的帖子，但找不到任何关于 2d 变换的信息。

任何想法将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2013-06-02T00:24:37.350

我多次遇到这个问题，似乎有两种解决方法（如下所示）。您可以使用这些属性中的任何一个来修复渲染，或同时使用这两个属性。

隐藏的背面可见性解决了这个问题，因为它将动画简化为对象的正面，而默认状态是正面和背面。

```
backface-visibility: hidden; 
```

TranslateZ 也可以使用，因为它是一种为动画添加硬件加速的技巧。

```
transform: translateZ(0); 
```

这两个属性都解决了您遇到的问题，但有些人也喜欢添加

```
-webkit-font-smoothing: subpixel-antialiased; 
```

对他们的动画对象。我发现它可以改变网络字体的呈现，但也可以随意尝试这种方法。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2019-01-07T22:21:00.823

After trying everything else here with no luck, what finally fixed this issue for me was **removing** the `will-change: transform;` property. For some reason it caused horribly blurry looking scaling in Chrome, but not Firefox.

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2016-12-05T20:51:30.633

为了改善模糊，特别是。在 Chrome 上，尝试这样做：

```
transform: perspective(1px) translateZ(0);
backface-visibility: hidden; 
```

**更新：** [透视](https://developer.mozilla.org/en-US/docs/Web/CSS/perspective)增加了用户和 z 平面之间的距离，这在技术上缩放了对象，使模糊看起来“永久”。以上`perspective(1px)`就像*鸭带*，因为我们正在匹配我们试图解决的模糊性。使用下面的 css 可能会更好：

```
transform: translateZ(0);
backface-visibility: hidden; 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2017-02-03T22:46:01.910

我发现调整比例有一点帮助。

使用`scale(1.048)`over`(1.05)`似乎可以更好地近似全像素字体大小，从而减少子像素模糊。

我还使用`translateZ(0)`了这似乎调整了 Chrome 在变换动画中的最后舍入步骤。这对我的悬停使用来说是一个加分项，因为它提高了速度并减少了视觉噪音。然而，对于 onclick 函数，我不会使用它，因为转换后的字体看起来不那么脆。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2015-02-28T19:56:59.263

代替

```
transform: scale(1.5); 
```

使用

```
zoom : 150%; 
```

修复了 Chrome 中的文本模糊问题。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-03-31T10:34:04.887

这一定是 Chrome 的错误（版本 56.0.2924.87），但下面修复了我在控制台（'.0'）中更改 css 属性时的模糊性。我会报告的。

```
filter: blur(.0px) 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-12-10T18:25:21.067

桑德尔斯带领我找到答案。除了`filter: scale`不存在，但`filter: blur`确实存在。

将下一个声明应用于看起来模糊的元素（在我的情况下，它们位于转换后的元素内）：

```
backface-visibility: hidden;    
-webkit-filter: blur(0); 
```

它*几乎*完美地工作。“*几乎*”是因为我正在使用过渡，而在过渡时，元素看起来并不完美，但一旦过渡完成，它们就会完美。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-11-29T08:27:43.600

我发现，问题以任何方式发生在相对变换上。translateX(50%)、scale(1.1) 或其他。提供绝对值总是有效的（不会产生模糊的文本（ures））。

这里提到的解决方案都不起作用，我认为还没有解决方案（在我写这篇文章时使用 Chrome 62.0.3202.94）。

在我的情况下`transform: translateY(-50%) translateX(-50%)`会导致模糊（我想使对话框居中）。

为了达到更多“绝对”值，我必须将十进制值设置为`transform: translateY(-50.09%) translateX(-50.09%)`.

**笔记**

我很确定，这个值在不同的屏幕尺寸上会有所不同。我只是想分享我的经验，以防它对某人有所帮助。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2020-01-23T10:24:30.503

我有着同样的问题。我使用以下方法解决了这个问题：

```
.element {
  display: table
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-01-04T17:10:02.537

在我的情况下，以下代码导致字体模糊：

```
-webkit-transform: translate(-50%,-50%);
transform: translate(-50%,-50%); 
```

并且只是添加缩放属性为我修复了它。玩缩放，以下对我有用：

```
zoom: 97%; 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-10-06T03:37:53.357

我找到了一个更好更干净的解决方案：

```
.element{
 transform:scale(0.5) 
 transform-origin: 100% 0;
} 
```

或者

```
.element{
 transform:scale(0.5) 
 transform-origin: 0% 0;
} 
```

感谢这篇文章： [使用变换防止模糊渲染：比例](https://stackoverflow.com/questions/29037176/preventing-blurry-rendering-with-transform-scale/29037803)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-09-30T07:17:25.440

`zoom: 101%;`当您无法使用缩放 + 比例组合时，请尝试用于复杂设计。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-12-16T20:29:48.853

**2019 年更新**
Chrome 显示错误仍未修复，尽管不是顾客的错，但本网站提供的全部建议都无法解决该问题。我可以同意，我徒劳地尝试了其中的每一个：只有 1 个接近，这就是 css 规则：filter:blur(0); 这消除了容器 1px 的移动，但不能解决容器本身及其可能具有的任何内容的模糊显示错误。

**现实是这样的：这个问题实际上没有解决办法，所以这里有一个针对流动网站的解决方法**

**案例**
我目前正在开发一个流畅的网站，并有 3 个 div，所有这些 div 都以悬停效果为中心，并在宽度和位置上共享百分比值。Chrome 错误发生在设置为 left:50% 的中心容器上；和变换：translateX(-50%); 一个共同的设定。

**示例：**首先是 HTML...

```
<div id="box1" class="box">
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry"s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.
</div>

<div id="box2" class="box">
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry"s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.
</div>

<div id="box3" class="box">
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry"s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.
</div> 
```

**这是发生 Chrome 错误的 CSS ......**

```
*{margin:0; padding:0; border:0; outline:0; box-sizing:border-box;  background:#505050;}
.box {position:absolute; border:1px solid #fff; border-radius:10px; width:26%; background:#8e1515; padding:25px; top:20px; font-size:12pt; color:#fff; overflow:hidden; text-align:center; transition:0.5s ease-in-out;}
.box:hover {background:#191616;}
.box:active {background:#191616;}
.box:focus {background:#191616;}
#box1 {left:5%;}
#box2 {left:50%; transform:translateX(-50%);} /* Bugged */
#box3 {right:5%;} 
```

**这是固定的CSS...**

```
*{margin:0; padding:0; border:0; outline:0; box-sizing:border-box;  background:#505050;}
.box {position:absolute; border:1px solid #fff; border-radius:10px; width:26%; background:#8e1515; padding:25px; top:20px; font-size:12pt; color:#fff; overflow:hidden; text-align:center; transition:0.5s ease-in-out;}
.box:hover {background:#191616;}
.box:active {background:#191616;}
.box:focus {background:#191616;}
#box1 {left:5%;}
#box2 {left:37%;} /* Fixed */
#box3 {right:5%;} 
```

**[错误的小提琴： https :](https://jsfiddle.net/m9bgrunx/2/) **//jsfiddle.net/m9bgrunx/2/**
**固定的小提琴：** [https ://jsfiddle.net/uoc6e2dm/2/](https://jsfiddle.net/uoc6e2dm/2/)**

 **正如您所看到的，对 CSS 的少量调整应该会减少或消除使用变换进行定位的要求。这也适用于固定宽度的网站以及流动的网站。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2019-03-20T02:10:36.993

我刚刚在 Chrome 上发现的模糊变换（translate3d，scaleX）的另一个尝试是将元素设置为“**显示：内联表**；”。在某些情况下（在 X 轴上），它似乎强制像素舍入。

我读到 Chrome 下的亚像素定位是有意的，开发人员不会修复它。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-05-26T09:53:33.803

我已经从这些答案中尝试了很多示例，不幸的是，`Version 81.0.4044.138` 我添加到转换元素中的 Chrome 没有任何帮助

```
 transform-origin: 50% 50%; 
```

这个

```
 transform-origin: 51% 51%; 
```

它对我有帮助

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-04-08T21:08:55.753

当我使用`transform: translate(-50%,-50%)`.

好吧，我真的尝试了很多解决方法，例如：

```
transform: perspective(1px); 
```

```
filter: blur(0); 
```

```
transform: translateZ(0); 
```

```
backface-visibility: hidden; 
```

这些都没有对我有用。

最后，我使元素的高度和宽度变得均匀。它为我解决了这个问题！！！

**注意：**这可能取决于用例。但肯定值得一试！

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-02-05T16:58:10.663

以上都不适合我。

当我添加透视图时它起作用了

即从

`transform : translate3d(-10px,-20px,0) scale3d(0.7,0.7, 1)`

我改成

`transform : perspective(1px) translate3d(-10px,-20px,0) scale3d(0.7,0.7, 1)`

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2020-03-10T16:36:02.343

我的解决方案是：

显示：初始；

然后脆脆的

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2021-06-30T21:16:21.140

这对我有用：

`body { perspective: 1px; }`

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2017-07-28T15:32:39.923

以上都不适合我。我有这个弹出窗口动画：

```
@keyframes pulse {
  from {
    transform: scale3d(1, 1, 1);
  }
  50% {
    transform: scale3d(1.05, 1.05, 1.05);
  }
  to {
    transform: scale3d(1, 1, 1);
  }
} 
```

在我的情况下，应用此规则后模糊效果消失了： `-webkit-perspective: 1000;`即使它在 Chrome 检查器中被标记为未使用。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2019-06-21T15:40:06.050

我使用了所有答案的组合，这最终对我有用：

```
.modal .modal--transition {
  display: inline-table;
  transform: perspective(1px) scale(1) translateZ(0);
  backface-visibility: hidden;
  -webkit-font-smoothing: subpixel-antialiased;
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2021-09-23T13:19:47.503

我有一个 div，它有一个小的透视偏移，以提供微妙的 3D 效果。div 中的文字模糊不清，我在这里尝试了所有建议，但均无济于事。

奇怪的是，我发现设置“过滤器：继承；” 在文本元素上大大提高了清晰度。虽然我不明白为什么。

这是我的代码以防万一：

html:

```
<div id="NavContainer">
    <div id="Nav">
        <label>Title</label>
        <nav>
            <a href="/">home</a>
            <a href="/link1">link1</a>
            <a href="/link2">link2</a>
        </nav>
    </div>
</div> 
```

CSS：

```
 #NavContainer {
        position: absolute;
        z-index: 1;
        top: 0;
        left: 20px;
        right: 20px;
        perspective: 80vw;
        perspective-origin: top center;
    }

    #Nav {
        text-align: right;
        transform: rotateX(-5deg);
    }

        #Nav > nav > a,
        #Nav > label {
            display: inline-block;
            filter: inherit;
        }

        #Nav > label {
            float: left;
            font-weight: bold;
        } 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2019-02-25T09:44:59.987

我从我的代码中删除了这个 - `transform-style: preserve-3d;` 并添加了这个-`transform: perspective(1px) translateZ(0);`

模糊消失了！

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-06-05T06:46:42.223

我通过添加以下内容来解决我的问题：

```
transform: perspective(-1px) 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2017-03-15T11:50:00.483

重要的是要补充一点，如果正在翻译的元素的高度为奇数像素，则会出现此问题。因此，如果您可以控制元素的高度，将其设置为偶数将使内容看起来清晰

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2019-03-15T09:01:54.583

对于合唱：

我在这里尝试了所有建议。但没有奏效。我的大学找到了一个很好的解决方案，效果更好：

**你不应该超过 1.0**

并包括`translateZ(0)`在悬停但不在非悬停/初始位置。

例子：

```
a {
    transition: all 500ms cubic-bezier(0.165, 0.840, 0.440, 1.000);
    transform: scale(0.8, 0.8);
}

a:hover {
    transform: translateZ(0)scale(1.0, 1.0);
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-06-25T15:57:25.163

所以。我尝试了上述所有解决方案，但没有任何效果。但！

我的 React App 的 index.html 中有一个 modal-root div。如果有必要，我会在其中渲染一个模态组件（.modal）。首先，我将模态本身固定，使其位于左上角 50% 并应用过渡（-50%，-50%）使其居中。

如果 Chrome 浏览器的缩放比例不是 100%，我放大和缩小并注意到模态内容的模糊。可能是 110% 或 90-80-75 等百分比，没关系。除了 100% 缩放之外，它真的很模糊和丑陋。

所以我决定摆脱我之前的整个基于过渡的解决方案，以使 .modal 元素的子元素居中。

我将我的模态根定位固定，使其从左上角到右下角为 0，因此它始终为 100vh 和 wv。然后我把它做成了一个 flex-container 并通过 align-items 和 justify-content 居中定位它的孩子。

但！总有一个但是。modal-root 默认有一个 z-index: -1。如果打开模式，我决定以编程方式将其更改为 59。我还应用了一个叠加层，使页面的其余部分更暗，即 .overlay，它的 z-index 为 60。实际的模态内容 (.modal) 的 z-index 为 61。

我还想在该元素出现时为它的入口设置动画，所以我在玩边距，而不是对其应用任何类型的过渡。这是一个立方体动画，它在动画中以合适的百分比处理该边距顶部，但最后它是边距顶部 0，没有过渡属性。

不得不返工组件有点遗憾，但经过测试它工作得很好。

概括：

*   最高父容器固定，覆盖整个页面
*   设置最高父容器的 z-index -1 或 [custom-value] 取决于想要与模态交互（模态是打开的）
*   如果模式关闭，将容器的 z-index 设置为 -1
*   使容器成为弹性容器并将其子容器放置在中心
*   通过边距值而不是过渡来为孩子设置动画

我希望它可以对你们中的一些人有所帮助:)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-12-20T11:55:18.340

尝试在动画块上使用缩放值。就我而言，缩放：99.6%；完全修复了模糊的文字。但是例如，99.7% 的值文本仍然是模糊的，所以在每种情况下这个值可能会有所不同。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-05-25T20:52:01.927

在 Chrome 74.0.3729.169（截至 2019 年 5 月 25 日）中，似乎没有任何修复因转换导致的某些浏览器缩放级别发生的模糊。即使是简单`TransformY(50px)`的元素也会模糊。这不会出现在当前版本的 Firefox、Edge 或 Safari 中，而且似乎也不会出现在所有缩放级别。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-05-22T06:44:11.623

仅使用 css 将很难解决。

所以我用jquery解决了它。

这是我的 CSS。

```
.trY {
   top: 50%;
   transform: translateY(-50%);
}

.trX {
   left: 50%;
   transform: translateX(-50%);
}

.trXY {
   top: 50%;
   left: 50%;
   transform: translate(-50%, -50%);
} 
```

这是我的jQuery。

```
function tr_init() {
$(".trY, .trX, .trXY").each(function () {
    if ($(this).outerWidth() % 2 != 0) {
        var fixed_width = Math.ceil($(this).outerWidth() / 2) * 2;
        $(this).css("width", fixed_width);
    }
    if ($(this).outerHeight() % 2 != 0) {
        var fixed_height = Math.ceil($(this).outerHeight() / 2) * 2;
        $(this).css("height", fixed_height);
    }
})} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2017-07-13T09:42:23.090

对我来说，问题是我的元素正在使用`transformStyle: preserve-3d`. 我意识到该应用程序实际上并不需要它，并且将其删除可以解决模糊问题。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2020-06-02T09:38:29.813

只是为了增加修复热潮，将 {border:1px solid #???} 放在看起来很糟糕的对象周围为我解决了这个问题。如果您有稳定的背景颜色，请考虑这一点。这太愚蠢了，没有人想过要提我猜，嗯嗯。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2021-01-30T19:48:01.313

就我而言，错误在于动画被设置为动画元素（SVG）的父 div。父 div 有一些疯狂的宽度，比如 466.667px。将其设置为奇数将无济于事。但是：用动画定位 SVG 本身（而不是父容器）。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2021-05-21T18:43:12.880

对于将来阅读的任何人：就我而言，问题是我添加了：

```
perspective: 2500px; 
```

到父元素。删除此属性解决了该问题。

* * *

## 回答 #35

> 赞同：-2
> 
> 时间：2015-07-31T10:03:42.457

你可以使用 css`filter`来解决这个问题。

```
.element {
    filter: blur(0);
} 
```

关于vendor-prefix，请自行处理。`-webkit-filter`, `-ms-filter`. 细节在这里 [http://browser.colla.me/show/css_transformation_scale_cause_blurring](http://browser.colla.me/show/css_transformation_scale_cause_blurring)**

# c# - 节点的内部文本忽略子级的内部文本

> ID：14677492
> 
> 赞同：3
> 
> 时间：2013-02-03T21:26:29.357
> 
> 标签：c#, xpath, html-agility-pack

如果这听起来太简单以至于在这里被问到，请原谅我，但由于这是我使用 html-agility-pack 的第一天，我无法找到一种方法来选择节点的内部文本，它是节点的直接子节点并忽略子节点的内部文本。

例如

```
<div id="div1">
   <div class="h1"> this needs to be selected
   <small> and not this</small>
   </div>
</div> 
```

目前我正在尝试这个

```
HtmlDocument page = new HtmlWeb().Load(url);
var s = page.DocumentNode.SelectSingleNode("//div[@id='div1']//div[@class='h1']");
string selText = s.innerText; 
```

它返回整个文本（例如，需要选择这个而不是这个）。有什么建议么？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T03:40:41.413

如果在其`div`子项之前和之后有文本，则可能有多个文本节点。正如我[在这里](https://stackoverflow.com/a/14624054/1945651)同样指出的那样，我认为获取节点的所有直接文本内容的最佳方法是执行以下操作：

```
HtmlDocument page = new HtmlWeb().Load(url);
var nodes = page.DocumentNode.SelectNodes("//div[@id='div1']//div[@class='h1']/text()");

StringBuilder sb  = new StringBuilder();
foreach(var node in nodes)
{
   sb.Append(node.InnerText);
}

string content = sb.ToString(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T23:35:42.793

您可以使用该`/text()`选项直接获取特定标记下的所有文本节点。如果您只需要第一个，请添加`[1]`：

```
page.LoadHtml(text);
var s = page.DocumentNode.SelectSingleNode("//div[@id='div1']//div[@class='h1']/text()[1]");
string selText = s.InnerText; 
```

# templates - C ++如何对顺序二进制文件中的记录进行排序并读出？

> ID：14677500
> 
> 赞同：0
> 
> 时间：2013-02-03T21:27:12.053
> 
> 标签：templates, sorting, file-io, stack, binary-search-tree

这是我收到的一个示例问题。

```
You are given files containing templates for a StackType, a QueueType, and a
BinarySearchTreeType.  There is also a file called Record.h that holds the
declarations and definitions for a Record class that contains information about a
student. All function bodies are given except for the overloading of the 
operators “&lt;” and “&gt;”. 

Write a main program, sort.cpp, that takes a squential binary file called 
Student.dat that contains records of the given class, then prints it out ordered 
by student ID. You may use all or none of the templates given to you. 
```

我不完全确定这是在问什么。最快和最简单的方法是什么？我认为最简单或最快的方法是应用快速排序或合并排序。您能否发布一些示例代码。

# javascript - 循环遍历表以返回 Google Analytics 电子商务中 _addItem() 的交易信息

> ID：14677507
> 
> 赞同：1
> 
> 时间：2013-02-03T21:27:46.517
> 
> 标签：javascript, jquery, google-analytics

我正在尝试设置电子商务网站的收据页面，以将电子商务数据推送回 Google Analytics。我坚持使用 sku、名称、价格和购买的每件商品的数量来填充 _addItem() 方法。

对于收据上的每个项目，我需要以下内容：

```
_addItem(transactionId, sku, name, price, quantity) 
```

我的收据页面使用产品数据生成下表。如何使用 Javascript 或 jQuery 循环遍历此表以返回每个项目的以下内容？收据上的物品数量没有限制。

```
<div id="receipt_detail">
   <table class="list_container" width="98%" cellspacing="0" cellpadding="4" >
     <tr class="list_heading">
        <td align="left"  nowrap >SKU</td>
        <td align="left"  nowrap >Description</td>
        <td align="left"  nowrap >Qty</td>
        <td align="right"  nowrap >Price</td>
        <td align="right"  nowrap >Extended</td>
     </tr>
     <tr class="list">
        <td align="left"  nowrap >1234</td>
        <td align="left"  nowrap >Widget 1</td>
        <td align="left"  nowrap >1</td>
        <td align="right"  nowrap > $            0.25</td>
        <td align="right"  nowrap > $            0.25</td>
     </tr>
     <tr class="listodd">
        <td align="left"  nowrap >5678</td>
        <td align="left"  nowrap >Widget 2</td>
        <td align="left"  nowrap >1</td>
        <td align="right"  nowrap > $            0.10</td>
        <td align="right"  nowrap > $            0.10</td>
     </tr>
   </table>
</div> 
```

我已经覆盖了 transcationId（这很容易）。其余的让我难住了。我是 Javascript 新手，因此非常感谢任何和所有帮助。

谷歌关于电子商务跟踪代码的开发者文档在[这里](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiEcommerce#_gat.GA_Tracker_._addItem)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:15:32.637

您将不得不填写一些空白，但这里有一些代码可以从表中提取值并填充 GA 代码：

```
<script language="JavaScript" type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-11111-1']); // your account # here

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

/* you proved no details or examples of where to get any of this, so this is
   the GA manual example */
_gaq.push(['_addTrans',
  '1234',           // transaction ID - required
  'Womens Apparel', // affiliation or store name
  '28.28',          // total - required
  '1.29',           // tax
  '15.00',          // shipping
  'San Jose',       // city
  'California',     // state or province
  'USA'             // country
]);

/* scrape the html you provided and add values to _addItem */
$(document).ready(function() {
  $('div#receipt_detail tr.list,.listodd').each(function() {
    var info = [];
    $(this).find('td').each(function() {
      info.push($(this).html().replace(/^\s*\$\s*/,''));      
    });
    _gaq.push(['_addItem',
      '1234',                // transaction ID 
      info[0]||'no sku',     // SKU/code - required
      info[1]||'no product', // product name
      'category',            // category or variation
      info[3]||'0',          // unit price - required
      info[2]||'1'           // quantity - required
    ]);
  });
  _gaq.push(['_trackTrans']);
});

</script> 
```

**注意：**这并不是跟踪交易的好方法。与其尝试从页面中抓取您的系统显然已经动态输出的值，不如使用服务器端代码更直接地向 js 公开必要的值，最好只使用服务器端代码动态填充 GA 代码。

# windows-8 - TFS Check-In 未提交无错误说明

> ID：14677515
> 
> 赞同：0
> 
> 时间：2013-02-03T21:29:00.707
> 
> 标签：windows-8, visual-studio-2012, vpn

我对使用源代码管理和使用 Team Foundation Server 还是很陌生。

这个问题似乎与这篇文章类似：（但在不同的平台和版本的 Visual Studio 上）

[Visual Studio 不跟踪更改或从源代码管理中签出文件](https://stackoverflow.com/questions/5294509/visual-studio-isnt-tracking-changes-or-checking-out-files-from-source-control#_=_)

我从我的家用电脑 (XP SP3 - Pro) 连接到我的工作电脑 (WIN8 - Enterprise)。

注意：为了解决网络级别身份验证 (NLA) 的问题（可能相关也可能不相关），我执行了以下步骤：[在 Windows XP Service Pack 3 上启用网络级别身份验证以通过远程桌面访问 Server 2008](https://support.soundenterprises.com/?_m=knowledgebase&_a=viewarticle&kbarticleid=221)

问题是，当我“签入”我的更改时......他们没有提交。在源代码管理资源管理器窗口中，我看到“待更改”列仍显示“添加”。对于我的任何解决方案文件夹或文件，“上次签入”列中没有任何值。我最初创建 Team Foundation 项目时生成了一个“构建过程模板”文件夹，该文件夹在“上次签入”列中具有日期时间值类型。

**...没关系，我刚刚发现了“解决方案”。**似乎**评论“登记”是登记过程中未指明的要求**。在“团队资源管理器”窗口 -> 范围内的“待更改”中添加了评论。

***如果在 VS2012 中的某处指出，请将其作为答案发布，我会这样标记。***任何其他相关信息也将受到赞赏，例如是否存在影响此签入过程行为的设置区域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:39:44.193

签入时要求评论实际上是团队项目级别的选项。

去：

*   团队
*   团队项目设置
*   源代码控制...
*   签入政策选项卡。

如果不需要，您可以从那里删除该策略。

# node.js - 使用 express 进行奇怪的行为路由

> ID：14677523
> 
> 赞同：1
> 
> 时间：2013-02-03T21:30:09.637
> 
> 标签：node.js, mongodb, express, mongoose

这是代码：

```
app.get('/:id', function (req, res){

  usermodel.findOne({ user: req.params.id }, function (err, user1){

    console.log(user1);

    if (req.session.user != user1.user) { 
       usermodel.findOne({ user: req.session.user, 
                           follow: user1.id }, function (err, user) {
           if (user != null) {
                 res.render('profile.ejs', {
                     user: user1,
                     ses: req.session.user,
                     foll: true
                 });
           } else {
                res.render('profile.ejs', { 
                     user: user1,
                     ses: req.session.user,
                     foll: false
                 });
           }
      });
    } else {
        res.render('profile.ejs', {
            user: user1,
            ses: req.session.user
        })
    }
  });
}); 
```

这是猫鼬模式：

```
var userschema = new mongoose.Schema({
  user: String,
  follow: [String],
  followers: [String]
}); 
```

此代码实际上有效，但仅在本地有效。我已经将它更新到我的 VPS，但它不起作用。我尝试访问例如`http://www.xxxx.com/foo`我收到`console.log()`输出，但页面未加载，正在加载 2 分钟，并且浏览器返回错误。

基本上代码检查 URL 中指定的用户是否是 req.session.user 中的用户，如果不是，我们检查`_id`URL 中指定的用户是否在 的后续数组中`req.session.user`，并附加结果，我们在变量中发送一个值`foll`。如果为真，则表示`req.session.user`正在关注指定的用户，如果为假，则不是。

在本地它可以工作，但我不知道为什么我的 VPS 不能工作！对此有什么解决方案...？

谢谢提前！

# c# - FormatException 计算 ListView 中列的总和

> ID：14677525
> 
> 赞同：0
> 
> 时间：2013-02-03T21:30:36.480
> 
> 标签：c#

我有一个问题，`listview`我无法计算特定列的总和。

在我的项目中，我正在从 excel 文件中读取一些信息到 . `ListView`，然后通过执行一些操作来处理这些信息。

现在，当我阅读信息时，`ListView`我无法计算特定列的总和，函数是：-

```
private void button12_Click(object sender, EventArgs e)
{

    int iSum = 0;
    foreach (ListViewItem o in this.lsvMain.Items )
    {
        iSum = iSum + Convert.ToInt16(o.SubItems[8].Text);
        textBox1.Text = iSum.ToString();
    } 
```

出现错误消息：**FormatException 未处理（输入字符串的格式不正确）。**它指示 (iSum..) 行。

没有任何字符串，所有信息都是整数！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:34:18.310

我猜你有以下问题之一：

```
int aNumber = Convert.ToInt16("15.6"); //throws format exception because of decimal value
int anotherNumber = Convert.ToInt16(""); //throws format exception because there is nothing to convert
int yetAnotherNumber = Convert.ToInt16("-23.00"); //throws format exception because of .00 
```

我猜您正在读取 excel 文件中的数字并保留它们的字符串表示形式。

如果该列的格式为数字，我猜所有数字都表示为“X.00”或类似的，因此会导致您的**FormatException**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:52:14.120

当您尝试`Parse`（或`Convert`）将某些东西发送到时，您会收到该错误`Integer`，而`Integer`.

例如

```
var anIntegerValue = Convert.ToInt16("a"); 
```

将导致异常：

> FormatException：输入字符串的格式不正确。

将调试器附加到您的程序并检查您从列表框中检索的值。它会让你大吃一惊:)。

Daniel 提出的示例将导致同样的问题。`int.Parse()`or `Int32.Parse`or or `Convert.Int16`or`Convert.Int32`都将导致相同的异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:43:46.090

```
private void button12_Click(object sender, EventArgs e)
{
    int sum = 0;

    foreach (ListViewItem o in lsvMain.Items)
    {
        int value;
        if (int.TryParse(o.SubItems[8].Text, out value))
            sum += value;
    }

    textBox1.Text = sum.ToString();
} 
```

# jsf-2 - 如何更改 p:selectOneMenu 中的项目标签

> ID：14677533
> 
> 赞同：0
> 
> 时间：2013-02-03T21:31:55.733
> 
> 标签：jsf-2, primefaces

我有一个`p:selectOneMenu`真`itemValue`/假（**布尔值**），但我想显示是/否而不是真/假。

```
<p:selectOneListbox value="#{tstMB.value}" converter="#{tstConverter}">
    <f:selectItem itemLabel="" itemValue=""/>
    <f:selectItems value="#{tstMB.valueLst}"  var="tst" 
                              itemLabel="#{tst.status}" itemValue="#{tst}"/>
</p:selectOneListbox> 
```

在上面的代码中`tst.status`返回真/假，但我想显示是/否之类的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:39:50.713

也许改变：

```
itemLabel="#{tst.status}" 
```

到：

```
itemLabel="#{tst.status ? 'Yes' : 'No'}" 
```

会有所帮助。

当然，如果您的应用程序是本地化的，请使用一些本地化字符串来代替这些字符串常量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:40:09.097

在类中编写另一个方法，它是 的类型`tst`，假设`getDisplayStatus`您返回 Yes/No 而不是 true/false。
然后你替换`itemLabel="#{tst.status}"`为`itemLabel="#{tst.displayStatus}"`

# github - 为什么 Github 上的 CL repos 这么少？

> ID：14677539
> 
> 赞同：0
> 
> 时间：2013-02-03T21:32:28.497
> 
> 标签：github, lisp, common-lisp

CL 项目通常使用其他东西（如 Haskell 项目）还是社区真的那么小？

[https://github.com/languages/Common%20Lisp/most_watched](https://github.com/languages/Common%20Lisp/most_watched)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T21:39:01.817

提供对 Common Lisp 库的访问的项目是[Quicklisp](http://www.quicklisp.org)。请参阅[库列表](http://www.quicklisp.org/beta/releases.html)。

对于托管项目，另请参阅：[common-lisp.net](http://common-lisp.net)。还有sourceforge和其他...

# html - 在 HTML5 中做 Frameset 的推荐方法

> ID：14677542
> 
> 赞同：1
> 
> 时间：2013-02-03T21:32:47.540
> 
> 标签：html, frame, frameset

我正在尝试在 ASP.NET MVC 中创建一个页面，该页面的顶部是我的网站内容，底部是另一个网站的内容。我的意思的一个例子可以在[http://freewebfiles.com/Site.aspx?url=http://www.soundfilesonline.com](http://freewebfiles.com/Site.aspx?url=http://www.soundfilesonline.com)看到。

但是，该站点使用框架集和`<frame>`标签。我的理解是，这些构造现在已被弃用，如果不是简单地过时的话。

那么现在推荐的方法是什么，这几乎意味着我应该如何在 HTML5 中做到这一点？

*补充一点，如果我能做到这一点，有谁知道如何使出现在底部框架中的站点成为活动站点？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:35:58.363

A`<frame>`在 HTML 5 中已经过时，但 an`<iframe>`不是。你可以在`iframe`里面放一个精心设计的`div`，以获得或多或少相同的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:08:40.993

我使用对象`<iframe>`内部做了同样的事情`<div>`。对于调整大小效果，您可以使用拆分器：http: [//methvin.com/splitter/](http://methvin.com/splitter/)或[http://krikus.com/js/splitter/](http://krikus.com/js/splitter/)

# php - Preg_replace 多行（php）

> ID：14677543
> 
> 赞同：0
> 
> 时间：2013-02-03T21:32:47.840
> 
> 标签：php, regex, preg-replace

> **可能重复：**
> [如何使用 preg_replace 替换多行文本](https://stackoverflow.com/questions/2101409/how-to-replace-text-over-multiple-lines-using-preg-replace)

我正在尝试从文件中读取一些文本，而不是替换一些模式。如果我尝试从一个字符串中替换模式，它可以工作，但如果文件中有多个这样的字符串，它就不起作用。

$this->session->set_flashdata('error_message', 'Naslovna vrstica je bila uspešno shranjena');

这是我试图用这一行替换替换的文本示例，但如果文件中还有其他这样的行，但它们都匹配单独，则不行。

```
$content = file_get_contents("C:\Users\Borut\\test.txt");
$pattern="/^.*session->set_flashdata\((.*),(.*)\);$/";
$replacement="\$_SESSION[$1]=$2"; 
```

这是我的代码。如上所示，如何替换多个字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:44:46.430

你想要的修饰符是`m`. [你可以在这里](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)找到所有修饰符 也就是说，最简单和更好的正则表达式解决方案是

```
"/\$this->session->set_flashdata\((.*?),\s*(.*?)\);/" 
```

注意怎么有一个？在每个中的 .* 之后。这是为了停止与您的贪婪匹配。`^`另请注意，删除and后也不需要修饰符`$`

# python - 带有 Django 表单的 Upvote 和 Downvote 按钮

> ID：14677548
> 
> 赞同：3
> 
> 时间：2013-02-03T21:34:07.340
> 
> 标签：python, django, django-forms

我想为评论制作upvote 和downvote 按钮，但我想要django.contrib.comments.forms.CommentSecurityForm 给我的所有表单输入以确保表单是安全的。那有必要吗？如果是这样，我如何制作一个带有 upvote 和 downvote 按钮的表单类？自定义复选框样式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:49:04.093

我建议，您使用单独的视图登录进行上下投票。

像这样的东西`/upvote/{{comment.pk|urlize}}`

然后编写一个适用于此 url 的视图。用 PK 找到用户正在尝试赞成/反对投票的评论，然后编写必要条件以检查用户是否有权执行该操作，然后最终执行该操作。

我希望这有帮助

# android - 使用加速度计（陀螺仪？）在二维空间中绘图

> ID：14677549
> 
> 赞同：2
> 
> 时间：2013-02-03T21:34:07.677
> 
> 标签：android, accelerometer, physics, gyroscope

我正在尝试创建一个应用程序来跟踪设备在 2D 空间中的移动。在网上做了研究后，我发现一种方法是两次集成线性加速度，但错误很可怕。

这个问题有什么解决办法吗？我希望能够向上移动我的手机，这将导致在屏幕上绘制一条垂直线，以缩放手机移动的距离。然后，如果我将手机向左移动，将绘制水平线 - 有效地允许我使用手机的移动在屏幕上绘图。

**这完全可以做到吗？如果是这样，我应该朝着什么方向发展？我不知道从哪里开始...**

编辑：有关该项目的更多信息：

我正在尝试制作一个可以跟踪腿部/手臂运动的运动应用程序：例如，当您进行腹部仰卧起坐并且手机通过臂带连接到您的脚踝时。

该应用程序将跟踪腿部的重复运动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:47:00.227

不幸的是，这些手机中的加速度计远不及实现惯性测量单元所需的加速度计。最大的问题是，由于您要进行两次积分，因此积分总是带有一个常数积分(x,dx) = x^2/2 +c，这个常数使这变得困难。更糟糕的是，你得到了两次，一次是在积分时获得速度，一次是为了获得位置。

我在商业内部测量单元中看到的一种解决此问题的方法称为零速度零点，这是您使用其他一些数据源来告诉它何时停止设备运动的地方，以便您可以将速度归零. 例如，我看到一个项目在鞋子上放置了一个惯性测量单元，只要它检测到鞋子放在地上，它就会将速度归零，从而大大提高了准确性。您可能可以使用相机或其他东西来确定这一点，但是我还没有看到它完成。如果您想开始搞砸这个，那么您是一个了不起的人，我很想听听结果如何。

编辑：我应该澄清我上面提到的常数是错误累积的地方。如果您可以将速度归零，那么您会定期从存储的当前速度中删除累积的误差。位置上的误差还是会累积，但是这样可以让它在相对静止的时候不会漂移，这可能使它可以通过绘制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:49:12.833

除了将加速度积分两次之外，我别无他法。

此外，我认为，如果您不了解设备中可能存在的其他传感器（例如，在我的一台设备上，我有 7（七）个与设备可能接收的各种物理信号相关的传感器），这是不可能的。

除此之外，请记住传感器数据是嘈杂的，几乎总是*必须*进行预过滤。例如，您可以使用最后 10 个样本的几何平均值。这应该通过为积分函数提供更平滑的输入数据来降低您的错误。

# javascript - 根据变量更改图像源

> ID：14677550
> 
> 赞同：0
> 
> 时间：2013-02-03T21:34:11.690
> 
> 标签：javascript, html, image

有没有办法使用基于变量的 javascript 来更改 HTML 图像的来源？我在想这样的事情：

```
var image = 1;

if(image=1) {
    document.getElementById('myImage').src = "images/one.png";
} else if(image=2) {
    document.getElementById('myImage').src = "images/two.png";
} else {
    window.alert("You have a weird variable value");
} 
```

请告诉我如何使用 if...then 或 switch 语句使其工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:37:26.570

`=`是一个任务。赋值语句评估为自身。所以`if(image=1)`意味着“将 1 分配给图像，那么如果 1 为真……”。（`1`始终为真值）。

要比较两个值，请使用`===`（或者`==`如果您想键入 munging）。

```
if (image === 1) { 
```

和

```
} else if (image === 2) { 
```

# php - PHP中未定义的变量

> ID：14677552
> 
> 赞同：-3
> 
> 时间：2013-02-03T21:34:25.313
> 
> 标签：php, undefined

我正在努力使用面向 MYSQL 的 PDO，在 PHP 中使用 OO 编码生成一个体面的注册、登录和注销。

我收到错误消息：

> 注意：未定义的变量：第 34 行 D:\xampp\htdocs\dan\classes\DB.class.php 中的 db
> 
> 致命错误：在第 34 行对 D:\xampp\htdocs\dan\classes\DB.class.php 中的非对象调用成员函数 query()

这是我的数据库类文件..

```
class DB {

protected $db_name = 'test';
protected $db_user = 'root';
protected $db_pass = '' ;
protected $db_host = 'localhost';

//***************** OPEN connection to database *****************
// Ensure called on every page that needs db connection
public function connect() {
    try {
        // Call PDO class
        $db = new PDO('mysql:host='.$this->db_host.';dbname='.$this->db_name, $this->db_user, $this->db_pass);
    }
    catch(PDOException $e) {
        // If error, nice error message here
        echo $e->getMessage();
    }
    return true;
}

//******** SELECT rows from database *****************
// Returns a full row or rows from $table using $where as the where clause
// Return value is associative array with column names as keys
public function select($table, $where)
{
    $query = $db->query('SELECT * FROM $table WHERE $where');
    $result = $query->fetchAll(PDO::FETCH_ASSOC);
    $num_rows = $result->rowCount();

    // if only one result, return that single result
    if($num_rows == 1)
        {return $result[0];}

    // but if numerous results, return the array
    return $result;
}

//*********** UPDATE a row in database *****************
// Takes array of data, where keys in array are column names
// Value is the data to be inserted into columns
// $table is the name of the table and $where is the SQL WHERE clause
public function update($data, $table, $where) {
    foreach ($data as $column => $value) {
        $sql = "UPDATE $table SET $column = $value WHERE $where";
        try{
            $db->query($sql);
        }
        catch(PDOException $ex){
            echo "error, ".$ex->getMessage();
        }
    }
    return true;
}

//***************** INSERT a new row into database *****************
// Takes array of data, keys in array are column names
// Values are data to be inserted into columns
// $table is the name of table
public function insert($data, $table) {
    $columns = "";
    $values = "";

    foreach ($data as $column => $value) {
        $columns .= ($columns == "") ? "" : ", ";
        $columns .= $column;
        $values .= ($values == "") ? "" : ", ";
        $values .= $value;
    }

    $sql = "INSERT INTO $table ($columns) VALUES ($values)";
    try{
        $db->query($sql);
    }
    catch(PDOException $ex){
        echo "error, ".$ex->getMessage();
    }

    // return the ID of the user in the database
    return $db->lastInsertId();
}

} 
```

这是我的用户类：

```
// User.class.php
// User object represents a person

require_once 'DB.class.php'; // note: outside of class

class User {
public $id;
public $username;
public $hashedPassword;
public $email;
public $joinDate;

// Constructor is called whenever new object is created
// Takes an associative array with db row as argument, keys are columns in table
function __construct($data) {
    $this->id                   = (isset($data['id']))          ? $data['id']           : "";
    $this->username             = (isset($data['username']))    ? $data['username']     : "";
    $this->hashedPassword   = (isset($data['password']))    ? $data['password'] : "";
    $this->email                = (isset($data['email']))       ? $data['email']        : "";
    $this->joinDate         = (isset($data['joinDate']))    ? $data['joinDate'] : "";
}

public function save($isNewUser = FALSE) {
    // create new db object
    $db = new DB();

    // if the user is already registered, just an update
    if(!$isNewUser) {
        // set the data array
        $data = array(
        "username"  => "'$this->username'",
        "password"  => "'$this->hashedPassword'",
        "email"         => "'$this->email'"
        );

        // update the row in database
        $db->update($data, 'users', 'id = ' . $this->id);
    }
    // if user being registered
    else {
        $data = array(
        "username"  => "'$this->username'",
        "password"  => "'$this->hashedPassword'",
        "email"         => "'$this->email'",
        "join_date"  => "'".date("Y-m-d H:i:s",time())."'"
        );

        $this->id = $db->insert($data, 'users');
        $this->joinDate = time();
    }
    return true;
}

} // end of class 
```

这是我的 UserTools 类：

```
// UserTools.class.php

require_once 'User.class.php';
require_once 'DB.class.php';

class UserTools {

// Log in user (REQUIRES DB)
// First checks if username and password match row in db
// If yes, set session vars and store user object within
public function login($username, $password)
{
    $db = new DB();
    $db->connect();

    // need to change to PREPARE!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    $hashedPassword = md5($password);
    $result = $db->query("SELECT * FROM users WHERE username = '$username' AND password = '$hashedPassword'");

    if($result->rowCount() == 1)
    {
        $_SESSION['user'] = serialize(new User($result));
        $_SESSION['login_time'] = time();
        $_SESSION['logged_in'] = 1;
        return TRUE;
    }
    else
    {
        return FALSE;
    }
}

// Log the user out (destroy session vars)
public function logout() {
    unset($_SESSION['user']);
    unset($_SESSION['login_time']);
    unset($_SESSION['logged_in']);
    session_destroy();
}

// Check if username exists (called during registration)  (REQUIRES DB)
public function CheckUsernameExists($username) {
    $db = new DB();
    $db->connect();
    // CHANGE TO PREPARE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    $result = $db->select("users","username=".$username);

    if(($result->rowCount()) == 0)
    {
        return FALSE;
    }
    else
    {
        return TRUE;
    }
}

// Get a user
// Returns a User object, takes user id as input
public function get($id) {
    // unsure if to delete the following:
    $db = new DB();
    $db->connect();
    $result = $db->select('users', "id = $id");
    return new User($result);
}

} // end of class 
```

请告诉我哪里出错了。我显然不理解面向对象的编码，即使是在一个又一个例子又一个例子又一个例子之后。

我只想创建一个有效的注册系统，并且采用模块化、OO 风格的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T21:38:53.860

`db`当您在 DB 类中创建它时，它在本地范围内。您希望它在类范围内（即类变量）。`$db`将您的 DB 类更改`$this->db`为将其放入类范围并通过所有类函数使用它。

# command-line - 从 JConsole 执行命令行

> ID：14677553
> 
> 赞同：2
> 
> 时间：2013-02-03T21:34:41.130
> 
> 标签：command-line, j

我最近发现了通过 JConsole.exe 而不是 J.exe 来运行各种脚本的乐趣。通常会有明显的性能提升。

但是，有时我需要使用`wd winexec`（例如调用 ad-hoc 程序）并且在控制台中，`11!:0`( `wd`) 支持不可用。

有没有办法将命令从 JConsole.exe 发送到常规的 Windows 命令行解释器？或者也许是一种解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:35:58.467

您可以尝试任务脚本。有关文档，请参阅脚本本身。
J6: `~system/packages/misc/task.ijs'`,
J7:`~system/main/task.ijs`

它包含实用程序，例如`fork_jtask_`, `spawn_jtask_`,`shell_jtask_`

您可以使用以下方法在两个版本中加载脚本：`require 'task'`

# apache - Godaddy runny 的新服务器真的很慢

> ID：14677558
> 
> 赞同：-1
> 
> 时间：2013-02-03T21:35:19.443
> 
> 标签：apache, apache2

我昨天从 Godaddy 购买了一台新的专用服务器。网站页面加载速度非常慢。我有 16 GB 的 Ram 和 i7 处理器。我正在尝试针对高流量 10K+ 活跃用户优化我的 Apache 服务器。这是旧设置和新设置：

```
OLD:
<IfModule mpm_prefork_module>
    StartServers          5
    MinSpareServers       5
    MaxSpareServers      10
    MaxClients          150
    MaxRequestsPerChild   0
</IfModule>

New:
<IfModule mpm_prefork_module>
    StartServers          5
    MinSpareServers       5
    MaxSpareServers      10
    MaxClients         2500
    ServerLimit        2500
    MaxRequestsPerChild   0
    KeepAlive On
    MaxKeepAliveRequests 100
    KeepAliveTimeout 3
    Timeout 30
</IfModule> 
```

解决我的问题的最佳设置是什么。注意该网站是基于 php mysqli 应用程序。此外，每页大约有 3 到 5 张图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:33:55.970

看看[这个页面](http://linuxstuffs.wordpress.com/apache-optimization/)——我一直用它作为参考。

我还强烈建议您在启动并运行 apache 的基准测试工具后试一试。留意几天的流量摄入并相应地调整设置。每个设置都不同 - 您运行的应用程序可以使用可变数量的内存。也许最常用的页面是低资源页面？也许人们在单页上花费了大量时间？这都是有条件的。

祝你好运！

# symfony - 起始页和登录成功后的页面

> ID：14677559
> 
> 赞同：2
> 
> 时间：2013-02-03T21:35:34.617
> 
> 标签：symfony, fosuserbundle

我正在尝试为使用 FOSUser Bundle 的网站设置正确的结构。目前，启动页面；

...app_dev.php 是主要的起始页面..

当用户登录时，

登录页面也以 ...app_dev.php 的形式打开..

```
_welcome:
    pattern:  /
    defaults: { _controller: MyUserBundle:Welcome:index } 
```

我希望初始页面和登录页面具有不同的页面..我在哪里设置用户登录后打开的页面..例如，在成功登录后，我希望页面例如; app_dev.php/老师

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:42:26.103

您需要配置 default_target_path

```
# app/config/security.yml
security:
    firewalls:
        main:
            form_login:
                default_target_path: /settings 
```

见[这里](http://symfony.com/doc/current/cookbook/security/form_login.html#changing-the-default-page)。

# ruby - Rackup：无法加载此类文件“sinatra”

> ID：14677560
> 
> 赞同：4
> 
> 时间：2013-02-03T21:35:36.230
> 
> 标签：ruby, sinatra, rack

我已经安装了 sinatra gem `irb`，如果我输入，

```
require 'sinatra' 
```

它返回`true`。

但是当我这样做时

```
rackup -d config.ru 
```

它告诉我

```
nil
Exception `LoadError' at /usr/local/lib/ruby/1.9.1/rubygems/custom_require.rb:36 - cannot load such file -- sinatra 
```

* * *

这是我的`config.ru`

```
require './app'

set :environment, ENV['RACK_ENV'].to_sym
set :app_file,     'app.rb'
disable :run

run Sinatra::Application 
```

`app.rb`

```
require 'rubygems'
require 'sinatra'

get '' do
   'Hello World'
end 
```

我不知道出了什么问题。

* * *

```
$ which ruby
/usr/local/bin/ruby
$ which rackup
/usr/local/bin/rackup
$ ruby -v
ruby 1.9.3p374 (2013-01-15 revision 38858) [x86_64-linux]
$ rackup -v
Rack 1.2 (Release: 1.5) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:09:57.000

我认为这只是设置`-d`选项的详细输出。服务器是否实际启动（在产生大量输出之后）？

正在发生的事情是这样的。[使用`-d`将 Ruby 的`$DEBUG`标志设置为`true`](https://github.com/rack/rack/blob/1.5.1/lib/rack/server.rb#L239). 然后，Rack 尝试通过 加载应用程序`config.ru`，然后加载您的`app.rb`. 中的第一件事`app.rb`是`require 'sinatra'`。

Rubygems 用`require`自己的方法替换了原来的方法。当您调用`require`它时，它会[尝试使用现有的加载路径和原始`require`方法](https://github.com/ruby/ruby/blob/v1_9_3_374/lib/rubygems/custom_require.rb#L36)正常加载文件。如果尚未加载 gem，这将引发 LoadError，[Rubygems](https://github.com/ruby/ruby/blob/v1_9_3_374/lib/rubygems/custom_require.rb#L57)在加载 gem 之前会捕获该错误。

设置`$DEBUG`标志后，即使异常已被抢救和处理，Ruby 也会在引发异常时生成消息，这就是您所看到的。

`-d`为了避免这种情况，只需在您的调用中省略标志`rackup`（也许启用警告`-w`会为您提供足够详细的输出，而不会让您陷入太多细节）。

如果服务器没有启动，那么这将是一个不同的问题，而不是找不到 Sinatra。如果是这种情况，您需要检查输出的其余部分以获取线索。

（请注意，我最初认为发生了其他事情，这就是我在他的评论中提出的问题。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-13T08:51:46.997

这绝对是加载路径的问题。无论如何尝试通过[RVM](https://rvm.io/)和 Bundler 设置所需的 ruby​​ 和 gems。它确保 Ruby 解释器和加载路径是一致的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-05T18:47:02.443

我的猜测是你的 rackup 脚本是一个安装在 diff ruby​​1.9x vm 中的“rack”gem 的 binstub

可能是 ruby​​1.9.2 的早期版本，所以它看不到安装的 sinatra

我会在命令行上尝试“which rackup”

# javascript - 如果包含表单标记，jquery 将无法识别选项列表文本

> ID：14677567
> 
> 赞同：1
> 
> 时间：2013-02-03T21:36:03.743
> 
> 标签：javascript, jquery, html, forms

我正在尝试使用 jquery 将选定的选项文本发送到 url，但是每当我将表单包装在`<form></form>`标签之间时，它就会停止工作并发送值而不是文本。如果我删除表单标签，它会按照我期望的方式运行。

我想知道是否有任何方法可以在不排除表单标签的情况下使其工作

谢谢！

```
<form>
    <select name="brand" id="brand" class="update">

        <option value="">Seleccionar</option>

        <?php if (!empty($list)) { ?>

            <?php foreach($list as $row) { ?>

                <option value="<?php echo $row['id']; ?>">

                    <?php echo $row['name']; ?>

                </option>

            <?php } ?>

        <?php } ?>

    </select>

    <select name="model" id="model" class="update" disabled="disabled">
        <option value="">----</option>
    </select>

    <select name="size" id="size" class="update" disabled="disabled">
        <option value="">----</option>
    </select>

    <input type="submit" value="Search" id="submit">

</form>

    </div>
    </div>
    <script src="js/jquery-1.6.4.min.js" type="text/javascript"></script>

    <script src="js/core.js" type="text/javascript"></script>

    <script type="text/javascript">
      $(document).ready(function(){
       $('#submit').click(function(){
        var brand = $('#brand option:selected').text();
        var model = $('#model option:selected').text();
        var size = $('#size option:selected').text();
        location.href ='index.php?s='+brand+'+'+model+'+'+size+'';
       });
      });
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:37:46.953

表单正在提交，您需要防止：

```
$(document).ready(function(){
   $('#submit').click(function(e){
    e.preventDefault();
    var brand = $('#brand option:selected').text();
    var model = $('#model option:selected').text();
    var size = $('#size option:selected').text();
    location.href ='index.php?s='+brand+'+'+model+'+'+size+'';
   });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:37:19.250

您需要`false`从事件处理程序返回以防止表单提交发生。

只需添加

```
return false; 
```

在末尾。（您也可以按照 adeneo 的回答所说的去做；任何一个都应该工作。）

# java - 关于 OpenGL VBO 的问题

> ID：14677570
> 
> 赞同：0
> 
> 时间：2013-02-03T21:36:18.257
> 
> 标签：java, opengl, lwjgl, vbo

我目前正在尝试制作一个具有立方体地形的基本游戏，类似于 Minecraft 经典。我的第一个问题：

如何在 VBO 中存储多维数据集列表，然后在更改该数据时重建列表？我目前渲染这样的立方体：

```
vertices = BufferUtils.createFloatBuffer(3 * 4 * 6);
    vertices.put(new float[] {
            -1.0f, -1.0f, 1.0f,
            1.0f, -1.0f, 1.0f,
            1.0f, 1.0f, 1.0f,
            -1.0f, 1.0f, 1.0f,

            -1.0f, -1.0f, -1.0f,
            -1.0f, 1.0f, -1.0f,
            1.0f, 1.0f, -1.0f,
            1.0f, -1.0f, -1.0f,

            -1.0f, 1.0f, -1.0f,
            -1.0f, 1.0f, 1.0f,
            1.0f, 1.0f, 1.0f,
            1.0f, 1.0f, -1.0f,

            -1.0f, -1.0f, -1.0f,
            1.0f, -1.0f, -1.0f,
            1.0f, -1.0f, 1.0f,
            -1.0f, -1.0f, 1.0f,

            1.0f, -1.0f, -1.0f,
            1.0f, 1.0f, -1.0f,
            1.0f, 1.0f, 1.0f,
            1.0f, -1.0f, 1.0f,

            -1.0f, -1.0f, -1.0f,
            -1.0f, -1.0f, 1.0f,
            -1.0f, 1.0f, 1.0f,
            -1.0f, 1.0f, -1.0f});
    vertices.rewind();

    vertexBufferID = createVBOID();
    bufferData(vertexBufferID, vertices);

         public static int createVBOID() {
        if (GLContext.getCapabilities().GL_ARB_vertex_buffer_object) {
            IntBuffer buffer = BufferUtils.createIntBuffer(1);
            ARBVertexBufferObject.glGenBuffersARB(buffer);
            return buffer.get(0);
        }
        return 0;
    }

 public static void bufferData(int id, FloatBuffer buffer) {
        ARBVertexBufferObject.glBindBufferARB(ARBVertexBufferObject.GL_ARRAY_BUFFER_ARB, id);
        ARBVertexBufferObject.glBufferDataARB(ARBVertexBufferObject.GL_ARRAY_BUFFER_ARB, buffer, ARBVertexBufferObject.GL_DYNAMIC_DRAW_ARB);
    } 

public void renderGL() {
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glClearColor(0.0f, 0.0f, 0.0f, 0.5f);
    glViewport(0, 0, Display.getWidth(), Display.getHeight());
    glLoadIdentity();

    glRotatef(xrot, 1.0f, 0.0f, 0.0f);
    glRotatef(yrot, 0.f, 1.0f, 0.0f);
    glTranslated(-xpos, -ypos - 19, -zpos - 5);

    glEnableClientState(GL_VERTEX_ARRAY);
    ARBVertexBufferObject.glBindBufferARB(ARBVertexBufferObject.GL_ARRAY_BUFFER_ARB, vertexBufferID);
    glVertexPointer(3, GL_FLOAT, 0, 0);

    for (int y = 0; y < 16; y++) {
        for (int x = 0; x < 16; x++) {
            for (int z = 0; z < 16; z++) {
                glPushMatrix();
                glTranslatef(x, y, z);
                glDrawArrays(GL_QUADS, 0, 24);
                glPopMatrix();
            }
        }

    }
    glDisableClientState(GL_VERTEX_ARRAY);
} 
```

我知道我需要使用`glMapBuffer`和`glUnMapBuffer`修改 VBO，但是如何存储立方体并在需要时将其移除？我应该使用 ArrayList 吗？另外，有人告诉我我渲染立方体的方式是错误的，因为每个人都说我只用新坐标渲染一个立方体。他们说我的顶点数据保持不变，这是什么意思？

所以基本上我的问题是，1.如何使用数组来保存立方体列表并将它们加载到 VBO 中，然后删除一些立方体？2\. 我怎样才能改变我的顶点数据，以便我渲染不同的立方体，而不是一遍又一遍地渲染一个立方体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-13T15:19:37.777

1.  正如 antonijn 所写，您可以将 1 个立方体作为 VBO 并转换其模型视图矩阵
    *   翻译有时较慢（当立方体太多时）。
    *   翻译甚至可以在着色器内部通过一些统一的偏移量来完成，这比矩阵翻译快一点
2.  更快的方法是在 VBO 中拥有所有的立方体
    *   它浪费内存，但立方体没有那么大（仅限 6 个面）
3.  我会将多维数据集永久存储在 CPU 可访问内存中
    *   当场景更改时，将其复制到 VBO 进行渲染。
    *   不要在 CPU<->GPU 之间来回传输数据
    *   仅将数据从 CPU 复制到 GPU。
4.  也最好使用非索引 VBO（drawarrays 不是 drawelements）
    *   索引不是很好支持
    *   经常会减慢速度，甚至在坏驱动程序上崩溃

代码请看这里：[https](https://stackoverflow.com/a/18672821/2521214) ://stackoverflow.com/a/18672821/2521214 但该帖子使用 VAO+VBO 用于 GLSL 目的，因此如果您不使用 GLSL，则需要进行一些更改。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-03T22:00:23.340

大多数情况下，您有场景的 CPU 表示（在您的情况下是立方体列表）和 GPU 表示（即顶点缓冲区等）

在您的情况下，立方体仅由其位置定义。它们都具有相同的大小等等。以下是一些如何渲染多个立方体的选项：

1.  在顶点着色器中定义一个统一的位置变量并将其添加到顶点位置。如果不使用着色器，请将偏移量指定为模型视图矩阵中的平移矩阵。使用不同的矩阵/偏移多次渲染相同的顶点缓冲区。

2.  让 GPU 在其几何着色器中创建立方体。因此，您只需指定立方体在顶点缓冲区中的位置。当您映射一个顶点缓冲区时，您将获得一个指向数据的指针，您可以将新数据复制到其中。

3.  使用实例化。为着色器提供一组位置并以实例化模式渲染立方体。使用实例 id 来确定偏移向量。

# c++ - 汇编程序 push rdi, pop rdi around function call

> ID：14677574
> 
> 赞同：2
> 
> 时间：2013-02-03T21:36:47.663
> 
> 标签：c++, assembly, 64-bit, x86-64

在 C++ 中调用函数时 push rdi 和 pop rdi 的目的是什么？VS2010，x64，调试，无优化

C++

```
int calc()
{
    return 8 + 7;
} 
```

拆卸：

```
int calc()
{
000000013F0B1020  push        rdi  
    return 8 + 7;
000000013F0B1022  mov         eax,0Fh  
}
000000013F0B1027  pop         rdi  
000000013F0B1028  ret 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T22:21:14.267

它没有任何目的。这是未优化代码的常见工件。代码生成器发出`push edi`指令以预期必须执行加法。必须在函数调用之间保留 EDI 寄存器。但后来，发现添加可以在编译时执行。

摆脱这样的无关代码需要[“窥视孔优化”](http://en.wikipedia.org/wiki/Peephole_optimizer)。但是调试版本中没有启用该优化。要知道真正的代码是什么样子，您必须打开优化器，最好通过构建发布版本来完成。它实际上会完全消除该功能，您可以通过以下方式阻止它：

```
__declspec(noline) int calc()
{
    return 8 + 7;
} 
```

在发布版本中产生：

```
 return 8 + 7;
000007F7038E1000  mov         eax,0Fh  
000007F7038E1005  ret 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T21:58:25.797

你听说过“caller-save”和“callee-save”寄存器吗？

由于您的 CPU 只有少量有限数量的寄存器，因此调用者/被调用函数通常不可能始终使用不同的寄存器。如果调用者函数和被调用函数都想使用同一个寄存器，这意味着调用者中的值必须在调用之前/之后保存/恢复。

保存/恢复寄存器值可以由调用者或被调用者完成 - 这样做是一个约定问题。“调用者保存”寄存器的好处是，如果调用者知道调用后它不需要寄存器 XYZ 中的值，它可以省略保存/恢复操作。“被调用者保存”寄存器的好处是，如果被调用者知道它不会修改寄存器 XYZ 中的值，它可以省略保存/恢复操作。

我猜您的编译器将 RDI 视为被调用者保存寄存器，但不会省略不必要的保存/恢复操作，除非您打开了编译器优化。（如果有人知道这是不正确的，请发布另一个答案！）

**更新：**我发现了一篇关于 x86 调用约定的文章：[http ://en.wikipedia.org/wiki/X86_calling_conventions](http://en.wikipedia.org/wiki/X86_calling_conventions)

似乎证实了大多数调用约定，RDI 将被调用者保存。这并不能解释为什么它没有推送和弹出所有其他被调用者保存寄存器。也许这里还有其他事情发生。

# java - 使用 Java 小程序获取页面的 html 源代码

> ID：14677575
> 
> 赞同：0
> 
> 时间：2013-02-03T21:36:49.443
> 
> 标签：java

我知道在 Python 之类的脚本语言中这是可能的，但我知道 Java 小程序无法访问除自己的服务器之外的其他服务器。

我不知道/认为我可以签署这个小程序。有没有办法使用 PHP 来完成我想要完成的事情？

我也知道这段代码会去 google.com

```
import java.applet.*;
import java.awt.*;
import java.net.*;
import java.awt.event.*;

public class tesURL extends Applet implements ActionListener{

  public void init(){
  String link_Text = "google";
  Button b = new Button(link_Text);
  b.addActionListener(this);
  add(b);
  }

  public void actionPerformed(ActionEvent ae){
  //get the button label
  Button source = (Button)ae.getSource();

  String link = "http://www."+source.getLabel()+".com";
  try
  {
  AppletContext a = getAppletContext();
  URL u = new URL(link);
//  a.showDocument(u,"_blank");
//  _blank to open page in new window  
  a.showDocument(u,"_self");
  }
  catch (MalformedURLException e){
  System.out.println(e.getMessage());
  }
  }
} 
```

这是假设 source.getLabel() 是“谷歌”

但是我将如何获得该页面的源 html？

源 html 是动态的，每隔几秒或几毫秒更新一次。但是，html 也更新了，所以我仍然可以直接从 html 中读取动态内容。我已经在 vb.net 中这样做了，但现在我需要将它移植到 Java，但我不知道如何访问页面的 html 源；这就是我问的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:00:27.973

`AppletContext.showDocument`在浏览器中打开一个页面，很像 HTML 中的超链接或 JavaScript 中的类似调用。在*同源策略*下，如果该页面来自不同的站点，您将无权访问该页面，即使该页面位于 iframe 中。

如果您要直接阅读其中的内容，某些站点可能具有`crossdomain.xml`允许访问的策略文件`java.net.URL`。但是，www.google.com 似乎使用了一种受限制的形式，我认为 Java 插件目前不支持这种形式。

有人可能会建议对您的小程序进行签名，这会关闭 Java 的“沙盒”安全功能。然后，您需要说服您的用户相信您发布安全签名代码的能力。

# python - 需要经常更新 Web 应用程序中的图表，我应该使用什么技术？

> ID：14677576
> 
> 赞同：0
> 
> 时间：2013-02-03T21:36:56.650
> 
> 标签：python, web-applications, graph

我有一些 Python 代码，我想开始尝试将其转换为 Web 应用程序（不确定我将使用什么框架，但它将是基于 Python 的）。这个想法是用户输入一堆数字，并在输入每个数字后更新图表。

目前我正在用 python + matplotlib 做这个。我最初的想法是每次用户输入新数字时重新渲染图像的 jpg，但这似乎有点重。

我想知道，将动态图合并到我的 Web 应用程序中应该看什么技术？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:45:53.033

为每个数字重新生成一个 jpeg 将非常繁重。

Javascript 提供了许多非常高质量的免费图形库： [http ://webdesignledger.com/resources/13-useful-javascript-solutions-for-charts-and-graphs](http://webdesignledger.com/resources/13-useful-javascript-solutions-for-charts-and-graphs)

除了上面的链接之外，还有大量关于 javascript 图形库的堆栈溢出帖子。

如果您需要使用 python 处理每个用户输入，那么我会考虑使用 ajax。它可能是这样的：

1.  用户输入一个数字
2.  browser/javascript 向您的 python 应用程序发出 ajax 请求
3.  python处理并返回适当的数据
4.  浏览器收到响应并更新 JS 图表

# shell - sudo shell 脚本 mkdir

> ID：14677583
> 
> 赞同：2
> 
> 时间：2013-02-03T21:37:29.517
> 
> 标签：shell, sudo, mkdir

myscript.sh 是

```
#/!bin/sh
mkdir -p $1
cp -p a.txt ./$1
cp b.txt /usr 
```

如果我使用 sudo ./myscript.sh 调用它，则目录 $1 归 root 所有，因此用户无法修改 a.txt（这是一个问题）。我可以将脚本更改为

```
#/!bin/sh
mkdir -p $1
cp -p a.txt ./$1
sudo cp b.txt /usr 
```

并仅使用 ./myscript.sh 调用，但我觉得这是不好的做法。在一般情况下如何进行，我不认识用户，所以 chown 没有帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:57:44.380

你应该添加这一行

```
chmod ug+rw a.txt 
```

有了这个，用户将拥有对“a.txt”的读/写权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:45:13.407

`SUDO_USER`环境变量由`sudo`调用的用户名设置`sudo`。您可以将其用于`chown`.

作为不良做法，您不检查任何内容，并且您的`$1`参数替换对于带有空格的文件名会被破坏。如果这无关紧要，你应该关心其余的吗？

# java - 在数组中排序

> ID：14677584
> 
> 赞同：-1
> 
> 时间：2013-02-03T21:37:33.210
> 
> 标签：java, sorting

我正在研究一个简单的数据库（使用字符串数组），它可以只存储一些基本信息，如人名、生日等……如果我想按生日对人进行排序，我该怎么做那？

我想我要问的问题是如何访问单个信息部分。从一个数组元素。据我了解，每个数组元素只能存储 -one 类型和 -one 一条信息。我基本上为数组中的每个元素都安装了特定格式的单个字符串。如果有人能给出一个非常基本的方法来解决这个问题，那对我会有很大的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T21:41:35.163

```
public class Person implements Comparable<Person> {
    private String name;

    public Person(String name) { this.name = name; }

    public int compareTo(Person p) {
        return this.name.compareTo(p.name);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T21:40:58.457

我建议您创建一个`Person`类来存储有关单个人的所有信息。然后创建一个对象数组`Person`并创建一个`Comparator`对象，该对象定义要在 中使用的顺序`Arrays.sort()`。如果您不明白这里的某些内容，请从 google 搜索开始，然后再提出更多问题！

# javascript - Highchart 刻度间隔

> ID：14677589
> 
> 赞同：5
> 
> 时间：2013-02-03T21:38:12.673
> 
> 标签：javascript, highcharts, pchart

我似乎无法弄清楚如何正确设置我的刻度间隔。
需要在 X 轴上有一个小时刻度。
数据以分钟为单位。

Javascript：

```
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'spline'
            },
            title: {
                text: 'Temperature Today'
            },
            xAxis: {
                type: "datetime",
                categories: time,
                dateTimeLabelFormats: {
                    day: '%h'
                },
                minTickInterval: 24 * 36000000 * 1000,
            },
            yAxis: {
                title: {
                    text: 'Temperature'
                },
                minorGridLineWidth: 0,
                gridLineWidth: 0,
                alternateGridColor: null
            },
            tooltip: {
                formatter: function() {
                        return ''+
                        Highcharts.dateFormat('%e. %b %Y, %H:00', this.x) +': '+ this.y;
                }
            },
            plotOptions: {
                spline: {
                    lineWidth: 4,
                    states: {
                        hover: {
                            lineWidth: 5
                        }
                    },
                    marker: {
                        enabled: false,
                        states: {
                            hover: {
                                enabled: true,
                                symbol: 'circle',
                                radius: 5,
                                lineWidth: 1
                            }
                        }
                    },
                }
            },
            series: [{
                name: 'Asen',
                data: temp
            }]
            ,
            navigation: {
                menuItemStyle: {
                    fontSize: '6px'
                }
            }
        });
    });

}); 
```

数据数组：

```
temp = [-4.39,-4.39,-4.33,-4.33,-4.33,-4.33,-4.33]
time = [1359910725000,1359910786000,1359910848000,1359910908000,1359910968000,1359911028000,1359911089000,1359911150000] 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-04T08:38:17.447

首先，删除 xAxis 上的 'categories' 属性，这在日期时间轴上没有任何意义。请注意，日期时间轴基于毫秒，因此一小时的间隔表示为 3600 * 1000。请参阅[API highcharts，tickInterval](http://api.highcharts.com/highcharts#xAxis.tickInterval)

将此配置用于 xAxis。

```
xAxis: {
        type: "datetime",    
        dateTimeLabelFormats: {
            day: '%H'
        },
        tickInterval: 3600 * 1000
}, 
```

[有关JS Bin](http://jsbin.com/ehebut/1/edit)的工作演示，请参见此处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T08:37:24.077

您应该使用带有值的tickInterval：3600 * 1000

# mysql - Prepared Statement查询语法错误

> ID：14677590
> 
> 赞同：0
> 
> 时间：2013-02-03T21:38:16.197
> 
> 标签：mysql

请谁能告诉我为什么这`stored procedure`不起作用，我做错了什么。它不断给出语法错误。

`puserid and plimit`是过程中传递的参数。

```
DECLARE uid BIGINT;
DECLARE rangee TINYINT;
SET @uid    = puserid;
SET @rangee = plimit * 15;

PREPARE STMT FROM 
'IF((SELECT count(type) from notificationrecievers nr where 
nr.status=0 and nr.recieverid=?) = 0) THEN
select nr.type,n.senderid,n.postid,u.name,nr.status
 from 
 user u,notifications n,notificationrecievers nr where 
 nr.recieverid=? and u.userid=n.senderid   and
 nr.notificationid=n.notid order by n.notid desc
limit 15 OFFSET ?;
ELSE
select nr.type,n.senderid,n.postid,u.name,nr.status
 from 
 user u,notifications n,notificationrecievers nr where 
 nr.recieverid=? and u.userid=n.senderid   and nr.status=0 and
 nr.notificationid=n.notid order by n.notid desc;
END IF;';

EXECUTE STMT USING @uid,@uid,@rangee,@uid; 
```

这是我得到的错误。

```
Error Code: 1064\. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF((SELECT count(type) from notificationrecievers nr where nr.status=0 and nr.r' at line 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T08:31:38.047

您只能在准备好的语句中使用 DML。你可以做这样的事情

```
IF condition THEN
  set @q = 'your query text'
ELSE
  set @q = 'another query'
END IF;

PREPARE stmt FROM @q
EXECUTE stmt using ...
DEALLOCATE PREPARE stmt 
```

您可以在评估您的条件之前执行一些查询。希望能帮助到你

# c - 通过套接字发送的字符

> ID：14677591
> 
> 赞同：0
> 
> 时间：2013-02-03T21:38:29.147
> 
> 标签：c, network-programming

这个问题纯属理论，而不是关于正确的做法，但我们是否需要将 char 'x' 转换为网络格式？我在所有情况下都很感兴趣：总是/有时/从不我个人认为我应该，但我需要确定的是，比你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:41:53.903

不，char 是单字节值，所以字节序无关紧要

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T21:46:16.083

正如你所想的那样（endianess、ntohs ntohl 等），不。

不太基本，我应该提出一个非网络绑定警告：任何未附加其编码的字符串都是不可读的。

假设您正在发送/存储，无论是否通过网络，字符串“Français”和“ç”都必须使用字符编码进行编码。未指定字符编码意味着如果您使用 utf8 对其进行编码，则它可以读取为“FranÃ§ais”，但您的读者认为它是 latin1。

所以你有两个解决方案：

*   为您的应用程序写下一个规范，以仅使用相同的字符编码
*   将元数据放在标头上，指定未来字符串的编码（如 HTTP）。

# jquery - AJAX 内容加载器仅适用于我的一半链接

> ID：14677593
> 
> 赞同：1
> 
> 时间：2013-02-03T21:38:37.837
> 
> 标签：jquery, html, ajax

我正在使用 AJAX 内容加载器从我的所有 HTML 页面中引入一个 div 的站点上工作。它适用于我`#menu`部分的链接，但不适用于我的`#thumbs`部分。

即使我将链接切换到相反的部分，它们也只能`#menu`在`#thumbs`. 我花了几个小时看这个并切换东西，但仍然无法弄清楚！

我已经尝试使用`#thumbs a`, `#thumbs`, `#t1 a, #t2 a, #t3 a, #t4 a, #t5 a, #t6 a`, etc 等等，但仍然没有！

到目前为止，您可以在这里看到完整的网站：http: [//www.sarahubbarddesign.com/BP%20SITE-SHD/index.html](http://www.sarahubbarddesign.com/BP%20SITE-SHD/index.html) 任何帮助表示赞赏！

```
<div id="header">
        <div id="logo">
            <img src="images/borealis_photo_logo.jpg" alt=""/>
        </div>
        <div id="menu">
            <div class="menuContact"><a href="contact_bp.html" id="mC">Contact</a></div>
            <div class="menuAbout"><a href="about_bp.html" id="mA">About</a></div>
            <div class="menuHome"><a href="index.html" id="mH">Home</a></div>
    </div>
</div> 
```

```
<div id="content">
    <div id="mainImage">
        <img src="images/homeImage.jpg" alt=""/>
    </div>
    <div id="thumbs">
        <div id="t1"><a href="portfolio1_bp.html" id="p2"><img id="i1" src="images/thumbs/portThumb_snort.jpg" alt="" /></a></div>
        <div id="t2"><a href="portfolio2_bp.html" id="p2"><img id="i2" src="images/thumbs/portThumb_horse.jpg" alt="" /></a></div>
        <div id="t3"><a href="portfolio3_bp.html" id="p3"><img id="i3" src="images/thumbs/portThumb_pets.jpg" alt="" /></a></div>
        <div id="t4"><a href="portfolio4_bp.html" id="p4"><img id="i4" src="images/thumbs/portThumb_ppl.jpg" alt="" /></a></div>
        <div id="t5"><a href="portfolio5_bp.html" id="p5"><img id="i5" src="images/thumbs/portThumb_places.jpg" alt="" /></a></div>
        <div id="t6"><a href="portfolio6_bp.html" id="p6"><img id="i6" src="images/thumbs/portThumb_things.jpg" alt="" /></a></div>
    </div><!--END THUMBS DIV-->

//NEW-- LOAD CONTENT IN MAINIMAGE DIV AND CHANGE URL       
    var hash = window.location.hash.substr(1);
    var href = $("#menu a, #thumbs a").each(function(){
        var href = $(this).attr('href');
        if(hash==href.substr(0,href.length-5)){
            var toLoad = hash+'.html #mainImage';
            $('#mainImage').load(toLoad)
        }
    });
    $("#menu a, #thumbs a").click(function(){             
        var toLoad = $(this).attr('href')+' #mainImage';
        $('#mainImage').fadeOut("fast",loadContent);
        window.location.hash = $(this).attr('href').substr(0,$(this).attr('href').length-5);
        function loadContent() {
            $('#mainImage').load(toLoad,'',showNewContent())
        }
        function showNewContent() {
            //Slider();
            $('#mainImage').fadeIn("1000");
            //Slider();
        }
        return false;
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:57:38.373

我认为链接标签上没有触发点击事件，因为它看起来在鼠标悬停时被隐藏。就像蛮力回答一样尝试

```
$("#thumbs div").click(function(){             
        var toLoad = $(this).children('a').attr('href')+' #mainImage';
        $('#mainImage').fadeOut("fast",loadContent);
        window.location.hash = $(this).children('a').attr('href').substr(0,$(this).children('a').attr('href').length-5);
        function loadContent() {
            $('#mainImage').load(toLoad,'',showNewContent())
        }
        function showNewContent() {
            //Slider();
            $('#mainImage').fadeIn("1000");
            //Slider();
        }
        return false;
    }); 
```

并从前一个选择器中删除 '#thumbs a'。您还可以发布在拇指上处理鼠标的CSS吗？

# android - android动画冻结

> ID：14677598
> 
> 赞同：1
> 
> 时间：2013-02-03T21:38:56.790
> 
> 标签：android

我有一个包含 12 个图像的动画，显示为加载图像。它本身就可以正常工作，但是当我使用我的 httpClient 类从在线数据库中获取内容时，它会完全冻结，当内容完成获取时，您可以看到动画在不同的图像上停止。

如何在从数据库中获取内容时加载图像？

这是一些代码：

班级成员：

```
ImageView loading;
AnimationDrawable loadAnimation; 
```

创建：

```
 LinearLayout main = (LinearLayout) findViewById(R.id.loading);
    loading = new ImageView(this);
    loading.setImageResource(R.drawable.loading);
    loadAnimation = (AnimationDrawable)loading.getDrawable();
    main.addView(loading); 
```

在获取内容之前，我使用它来启动动画：

```
loadAnimation.start(); 
```

当它完成获取时：

```
loadAnimation.stop(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:46:58.477

发生这种情况的原因是您正在主线程上执行数据库操作，这会在您的阻塞代码执行时冻结 UI。为避免这种情况，您需要在不同的线程中执行这些操作。查看使用[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)以查看如何异步下载文件的示例。

在您的情况下，启动动画`onPreExecute()`并停止在`onPostExecute()`.

# jquery - 在jQuery中添加类/数据中断悬停功能

> ID：14677600
> 
> 赞同：1
> 
> 时间：2013-02-03T21:39:09.863
> 
> 标签：jquery, hover, addclass

我希望有人能告诉我为什么向 div 添加一个类会破坏我已经应用于该 div 的悬停功能？我正在使用 maphighlight 并拥有它，以便地图的当前部分突出显示，但是一旦此功能运行，工具提示就会停止工作，对于我来说，我无法弄清楚为什么。我尝试在函数中重新添加 mapTooltip 类，但这似乎没有任何区别，也没有通过 counties 变量应用工具提示。任何帮助将不胜感激。

代码：

```
$(document).ready(function() {
var counties = $('area[id]').map(function() {
    return $(this).attr('href');
}).get().join(", ");
var county;

$('.map').maphilight({fillColor: 'd20a36'});
$('#list').hide();

    $('.mapTooltip').hover(function(){
            var title = $(this).attr('aTitle');
            $('<p class="tooltip"></p>')
            .text(title)
            .appendTo('body')
            .fadeIn('normal');

    }, function() {
            $('.tooltip').remove();
    }).mousemove(function(e) {
            var mousex = e.pageX + 10; //Get X coordinates
            var mousey = e.pageY - 50; //Get Y coordinates
            $('.tooltip')
            .css({ top: mousey, left: mousex })
    });

$(counties).click(function() {
    county = 'lists.html ' + $(this).attr('href');
    var currentcounty = $(this).attr('href');
    $('#list').fadeIn('slow');
    $('#list').load (county)
    if (!$(this).hasClass('selected')) {
        $(this).data('maphilight', { alwaysOn: true }).trigger('alwaysOn.maphilight');
        $('.selected').data('maphilight', { alwaysOn: false } ).trigger('alwaysOn.maphilight');
        $(counties).removeClass('selected');
        $(this).addClass('selected');
    };
    });
}); 
```

# c - 使用外部变量的 C/CUDA 实现会产生链接器错误（未解析的外部符号）

> ID：14677601
> 
> 赞同：0
> 
> 时间：2013-02-03T21:39:13.093
> 
> 标签：c, visual-c++, cuda

我有一个 C 项目，我想使用 CUDA 模块来提升它。但不知何故，无法解析外部定义的变量。我正在使用 Microsoft Visual C++ 2010 Express 和 CUDA Toolkit 5.0。

以下显示了我的最小（非）工作示例：

主.c：

```
#include "main.h"
#include <stdio.h>
#include "cuda_test.cu"

int main( int argc, const char* argv[] )
{
    testfunc();
    return 1;
} 
```

主.h：

```
#ifndef main_h
#define main_h

extern float PI;

#endif 
```

测试文件.c：

```
#include "main.h"

float PI = 3; 
```

cuda_test.cu：

```
#include "main.h"
#include <stdio.h>

void testfunc()
{
    printf("Hello from cudafile: %E", PI);
} 
```

这会产生以下错误：

```
1>------ Build started: Project: cuda_min, Configuration: Debug Win32 ------
1>cuda_test.cu.obj : error LNK2001: unresolved external symbol "float PI" (?PI@@3MA)
1>D:\Backup\diplomarbeit\cuda_xanthos\cuda_min\Debug\cuda_min.exe : fatal error LNK1120: 1 unresolved externals
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

将变量 PI 传递给函数 testfunc 时，我得到了所需的行为。这就是我在我的项目中所做的（它实际上使用了 CUDA 设备），但我真的不想将大约 20 个变量传递给我的函数。

我想我缺少 nvcc 的一些设置...

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T01:02:39.993

`.cu`被编译和链接为`.cpp`，而不是`.c`。因此，您可以将`.c`文件重命名为`.cpp`，或`extern "C"`在`.cu`文件中使用。

# c++ - 如何创建在封闭类之外定义的嵌套类的实例？

> ID：14677602
> 
> 赞同：2
> 
> 时间：2013-02-03T21:39:22.687
> 
> 标签：c++

如果我定义一个嵌套类，然后创建一个这样的实例：

```
class A  
{   
    class B  
    {  
        ...
    };
    B b; 
}; 
```

一切都好。但是如果我只是在 A 内部声明 B 并在外部定义它，我就无法创建 B 的实例，可能是因为编译器不知道 B 的实例需要多少空间。但是当您在另一个类中定义一个类时，代码的可读性并不高。有没有办法使这项工作？

```
class A  
{
    class B;
    B b;
};
class A::B
{
    ...
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:45:22.547

当您使用类类型作为成员时，需要知道具体类。这就是为什么您的第二种情况不起作用的原因。一种解决方法是使用指向`B`：

```
#include <memory>
class A  
{
    class B;
    std::unique_ptr<B> b;
};
class A::B
{    
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:45:21.960

很简单，只需定义类 B，然后在 A 中定义它的一个实例。

```
class B
{
}
class A
{
   B memberB;
} 
```

或者您可以转发声明它：

```
class B;
class A
{
   B memberB;
}
class B
{
} 
```

真正的嵌套类很少需要，而且根本不是很有用。

# ruby - 如何在不添加额外换行符的情况下从用户接收数据

> ID：14677605
> 
> 赞同：0
> 
> 时间：2013-02-03T21:39:36.810
> 
> 标签：ruby, newline, gets, chomp

我正在尝试创建一个按字母顺序排列用户单词条目的程序。但是，对用户条目的检查表明，ruby 出于某种原因为每个单词添加了换行符。例如，如果我输入 Dog, Cat, Rabbit 程序返回 ["Cat\n", "Dog\n", "Rabbit\n"] 我如何防止这种情况发生？

```
 words = []
    puts "Enter a word: "
      until (word = gets).to_s.chomp.empty?
        puts "Enter a word: "
        words << word
      end

    puts words.sort.inspect 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:42:13.177

将您的代码更改为：

```
until (word = gets.chomp).empty? 
```

你现在这样做的方式：

```
(word = gets).to_s.chomp.empty? 
```

`gets`来自键盘输入的字符串，但直到用户按下它才会返回到您的代码中`Return`，这会在 Windows 上添加换行符或回车符 + 换行符。

`to_s`没有必要，因为您已经从键盘获取值作为字符串。

`chomp``gets`如果您希望所有输入都没有尾随换行符或换行符/回车符，则需要绑定。在测试`empty?`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-08T16:49:02.190

Ruby 2.4 对此有一个解决方案：

```
input = gets(chomp: true)
# "abc" 
```

# java - 如何更改按钮操作侦听器中的静态布尔变量？

> ID：14677609
> 
> 赞同：0
> 
> 时间：2013-02-03T21:39:51.210
> 
> 标签：java, actionlistener, static-variables

```
public class Main
{
  private static boolean SaH=false,LaE=false;

  public static void main(String[] args{
    //other code
    choice1.addActionListener(
            new ActionListener() {
                public void actionPerformed(ActionEvent e) {                        
                     SaH = true;
                     frame.dispose();
                }
            }
        );

   if (SaH==true)
   {
      // more code 
```

`dispose()`当我运行程序时，框架通过该方法消失；但它不会进入 if 语句（`SaH`没有改变）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T22:06:50.197

它看起来像 Java。语句 if (SaH==true) 在 java 程序加载时执行，因为它在 main 方法中。如果要在 dispose() 方法之后执行它，则创建一个新方法并在 actionListener 中的 dispose() 之后直接调用该方法

# salt - 如何从数据库中去除盐？

> ID：14677610
> 
> 赞同：-3
> 
> 时间：2013-02-03T21:39:53.723
> 
> 标签：salt

好的，我正在尝试用 C# 在我的网站上创建一个登录表单，它有 md5 + salt .. 问题是盐。md5 我可以工作，但盐不起作用。我制作了一个获取用户名、用户组 ID 等的 php。我已经删除了数据库中的大量 salt 实例，它要么破坏了登录，要么什么也没做。我想知道是否有一种简单的方法可以去除盐分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T08:05:38.460

你认为盐的用途是什么？如果您可以轻松删除它，添加它的原因是什么？您真的应该花几分钟时间阅读有关[密码散列](http://www.martinstoeckli.ch/hash/en/index.php)的教程。

MD5 不是散列密码的合适选择，因为它太快了。现在的普通硬件每秒可以计算 8 Giga MD5 值，这使得暴力破解太容易了。而是使用慢速密钥派生函数，如 BCrypt 或 PBKDF2。

要回答您的问题，您需要存储的盐来验证用户输入的密码。如果用户输入密码进行登录，您使用与计算数据库中存储密码相同的盐值计算哈希值，然后您可以比较哈希值。

# algorithm - 霍夫曼最小方差编码

> ID：14677612
> 
> 赞同：2
> 
> 时间：2013-02-03T21:40:04.887
> 
> 标签：algorithm, compression, proof, huffman-code

众所周知，具有最小方差的霍夫曼代码是可取的。我已经浏览了整个波兰语/英语互联网，这就是我发现的：要构建具有最小方差的霍夫曼代码，您需要使用以下方法之一打破联系（当然节点的概率是最重要的）：

*   选择代表最短树的节点
*   选择最早创建的节点（考虑在开始时创建的叶子）。

问题是，我找不到任何这些方法正确性的证据。有人可以证明这些吗？

我很乐意澄清任何事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-08-01T04:59:58.107

一些系统比“当有平局时，做出最小化树的最大深度的选择”具有更强的约束——它们对树的最大深度设置了一个硬限制（[长度限制，也称为最小方差 Huffman编码](https://en.wikipedia.org/wiki/Huffman_coding#Length-limited_Huffman_coding/minimum_variance_Huffman_coding)）：

*   “不管有没有平局，构建一个最大深度最多为16步的树，因此最大码字长度为16位”（如[JPEG图像压缩中使用的霍夫曼](https://en.wikibooks.org/wiki/JPEG_-_Idea_and_Practice/The_Huffman_coding)编码）（[Jpeg霍夫曼编码程序](https://stackoverflow.com/questions/9115155/jpeg-huffman-coding-procedure)）

*   “无论有没有平局，构建一个最大深度最多为 15 步的树，因此最大码字长度为 15 位”（如[DEFLATE 中使用](https://zlib.net/feldspar.html)的[Huffman 码和 gzip 中使用的 Huffman 码](https://www.daylight.com/meetings/mug00/Sayle/gzip2/tsld008.htm)

*   “不管有没有平局，构建一个最大深度最多为12步的树，因此最大码字长度为12位”（[“Huff0使用12位限制。”](https://github.com/JoernEngel/joernblog/blob/master/engel_coding.md)）

我的理解是，人们已经开发了几种[启发式算法来限制霍夫曼码字长度](http://cbloomrants.blogspot.com/2018/04/engel-coding-and-length-limited-huffman.html)，这些算法可以正常工作，但是[启发式算法并不总是能提供最好的压缩](https://fastcompression.blogspot.com/2015/07/huffman-revisited-part-3-depth-limited.html)。

有几个人提到“最佳长度限制霍夫曼码”，显然存在不止一种算法来找到它们：

*   Lawrence L. Larmore 和 Daniel S. Hirschberg。[“最佳长度限制霍夫曼码的快速算法”](https://www.ics.uci.edu/~dan/pubs/LenLimHuff.pdf)
*   [“最佳长度限制霍夫曼码”](https://shodhganga.inflibnet.ac.in/bitstream/10603/187253/9/09_chapter%204.pdf)
*   [“最佳长度限制霍夫曼码的快速算法”](https://dl.acm.org/citation.cfm?id=79150)

# android - 为什么我的 9patch 会在某些设备上投射阴影/伪影，而在其他设备上却不行？

> ID：14677614
> 
> 赞同：0
> 
> 时间：2013-02-03T21:40:51.400
> 
> 标签：android, nine-patch

根据设备的不同，我的 9patch 表现不同。理想情况下，它看起来像这样：

![良好的矩阵](../Images/ea1ad7dc9bc1d09ff6f021a4b50c44ed.png)

这是我在 Nexus 4 上得到的结果。但是，在 Nexus 7 上，我得到的是：

![坏矩阵](../Images/3548e5215ae1cd452220af7da304ef06.png)

它可以正确拉伸，但是应该透明的部分有阴影。draw9patch.bat 表示没有坏补丁，并且可以正确拉伸。这两种设备的分辨率不同（xhdpi 和 hdpi），但我确保在两个文件夹（drawable-xhdpi 和 drawable-hdpi）中都包含相同的 9patch。

![矩阵9补丁](../Images/9d6a227910de53c5defde18085572bc7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:25:38.883

在四个边中的任何一个上设置非像素时，我曾经遇到过 9patch 的问题。

我看到在您的 9patch 中，您只使用一个像素来绘制一些定义可拉伸补丁和内容区域的线条。尝试在 9patch 的顶部、左侧和右侧使用多个像素。

# algorithm - 检查排序数组上的算法

> ID：14677620
> 
> 赞同：2
> 
> 时间：2013-02-03T21:41:31.880
> 
> 标签：algorithm, big-o, analysis

我有一个排序的长度数组，`n`我正在使用线性搜索将我的值与数组中的每个元素进行比较，然后我对大小数组执行线性搜索`n/2`，然后对大小等进行线性搜索`n/4`，`n/8`直到我对长度为 1 的数组。在这种情况下，n 是 2 的幂，执行的比较次数是多少？

不确定此响应是否正确，但我认为比较的次数是

> T(2 ^n ) = (n/2) +(n/4) + ... + 1。

我这样做的原因是因为你必须遍历每一个元素，然后继续添加它，但我仍然不确定。如果有人能引导我完成这个，我将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T21:45:07.120

您在问题中设置的重复出现有点偏离，因为如果 n 是输入的长度，那么您不会用 2 ^n表示输入的长度。相反，您可以将其写为 n = 2 ^k以选择 k。一旦你有了这个，那么你可以做这样的数学：

*   一半数组的大小为 2 ^k / 2 = 2 ^(k-1)
*   四分之一数组的大小为 2 ^k / 4 = 2 ^(k-2)
*   ...

如果你总结所有这些值，你会得到以下结果：

> 2 ^k + 2 ^(k-1) + 2 ^(k-2) + ... + 2 + 1 = 2 ^(k+1) - 1

您可以通过多种方式证明这一点：您可以使用归纳法，或者使用几何级数之和的公式等。这在计算机科学中经常出现，因此值得留心记忆。

这意味着如果 n = 2 ^k，您的算法会及时运行

> 2 ^(k+1) - 1 = 2(2 ^k ) - 1 = 2n - 1

所以运行时间是 2n - 1，也就是 Θ(n)。

希望这可以帮助！

# c++ - C 和 C++ 可执行文件之间的区别？

> ID：14677622
> 
> 赞同：2
> 
> 时间：2013-02-03T21:41:40.507
> 
> 标签：c++, c, executable, binaries

我知道 C 和 C++ 程序之间的源代码存在差异——这**不是**我要问的。

我也知道这会因 CPU 和操作系统而异，具体取决于编译器。

我正在自学 C++，并且我看到了许多对两种语言都可以使用的库的引用。这让我开始思考——两种语言的二进制可执行文件之间是否存在显着差异？

对于两者都可以轻松使用的库，我认为它们必须在可执行级别上相似。

在很多情况下，人们可以检查可执行文件并判断它是由 C 还是 C++ 源代码创建的？或者二进制文件会非常相似吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T21:51:02.437

在大多数情况下，是的，这很容易。以下是我经常看到的一些线索，很容易记住它们：

1.  C++ 程序通常会以至少一些已损坏的可见符号结束。
2.  C++ 程序通常至少会调用*一些*虚函数，这通常与您通常在 C 中看到的代码截然不同。
3.  许多 C++ 编译器实现了 C++ 调用约定，特别考虑将`this`指针传递给 C++ 成员函数。同样，由于`this`指针在 C 中根本不存在，因此您很少会看到直接模拟（尽管在某些情况下，它们会使用相同的约定来传递其他指针，因此您需要小心这个）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T21:53:17.170

可执行文件就是可执行文件，无论它是用什么语言编写的。如果它是为目标体系结构构建的，它将在该体系结构上运行。

C 和 C++ 编译代码之间的（可以说）最重要的区别，以及与可以*链接*到 C 和 C++ 可执行文件的库相关的一个，是[名称修改。](http://en.wikipedia.org/wiki/Name_mangling) 基本上：当一个库被编译时，它会导出一组符号（函数名、导出的变量等），链接到该库的可执行文件可以使用这些符号。这些符号是如何*命名的*是相当特定于编译器/链接器的，如果后续的可执行文件使用不兼容约定的链接器链接，则符号将无法正确解析。此外，C 和 C++ 的约定略有不同。上面链接的维基百科文章有更多细节；可以说，在头文件中声明导出符号时，您通常会看到如下结构：

```
#ifdef __cplusplus
extern "C" {
#endif

/* exported declarations here */

#ifdef __cplusplus
}
#endif 
```

`__cplusplus`是仅在编译 C++ 代码时定义的预处理器宏。这里的想法是，当在 C++ 中使用头文件时，编译器被指示使用 C 命名导出符号的方式（在 " `extern "C" { /* foo */ }`" 块内，因此库可以在 C 和 C++ 中正确链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T22:14:37.800

我*想*我可以通过读取反汇编的二进制代码来判断是 C++ 还是 C [对于我熟悉的处理器架构，x86、x86_64 和 ARM]。但实际上，并没有太大区别，您必须看起来很难确定。

要寻找的标志是“间接调用”( `function pointer calls via a table`) 和`this`-pointers。尽管 C 可以有`pointer to struct`参数并且经常使用函数指针，但它通常不是以 C++ 的方式设置的。此外，有时您会注意到，编译器采用指向结构的指针并添加一个小的偏移量——这将删除继承类的外层。这也可以在 C 中发生，但不会那么普遍/独特。

只看二进制文件[除非你可以“在你的头脑中进行拆卸”会更难——尤其是如果它被剥离了符号——这就像那个可以告诉你旧黑胶唱片上的古典音乐是什么的人在轨道上[隐藏标签] - 大多数人都无法做到，即使他们“很好”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T21:45:56.097

在实践中，C 程序（或 C++ 程序）很少只是纯标准 C（或 C++）（例如 C99 标准没有扫描目录的意思）。所以程序使用额外的库。

在 Linux 上，大多数二进制文件都是动态链接的。使用`ldd`命令查找。

如果二进制文件链接到`stdc++`库，则源代码可能是 C++。

如果仅`libc.so`链接库，则源代码可能只有 C（但您可以静态链接`libstdc++.a`库）。

您还可以使用处理二进制文件的工具（例如Linux 上的`objdump`, `readelf`, `strings`, `nm`....）来查找有关它们的更多信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-03T21:53:48.997

C 和 C++ 编译器生成的代码通常是相同的代码。有两个重要的区别：

*   名称修饰：每个函数和全局变量在编译时都成为一个*符号。*在 C 语言中，这些符号的名称与源代码中的名称相同。在 C++ 中，它们被稍微修改以允许多态代码
*   调用约定：如果您在 C++ 中调用方法，则 this 指针作为隐藏的第一个参数传递。其他约定也可能不同，例如 C 中不存在的按引用调用

您可以使用这样的块来让 C++ 编译器生成与 C 兼容的代码：

```
extern "C" {
    /* code */
} 
```

# wordpress - WordPress page.php 不显示帖子

> ID：14677625
> 
> 赞同：0
> 
> 时间：2013-02-03T21:42:04.227
> 
> 标签：wordpress

如果我将此代码添加到侧边栏，我将无法在 page.php 中显示任何内容，我尝试重置查询但没有结果。

```
<?php
    $args = array(
            'post_type' => 'post',
            'kalba' => 'lt',
            'posts_per_page' => 7
                 );

$new_query = new WP_Query();
$new_query->query($args);
?>

<?php if ($new_query->have_posts()) : ?> 
<?php while ($new_query->have_posts()) : the_post(); ?>
<?php $new_query->the_post();?>     

<a href="<?php the_permalink(); ?>"><?php the_title(); ?></a>
<div class="sidebar-line"></div>
<?php endwhile; ?>
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T05:29:00.370

弄糊涂了你正在使用

```
'kalba' => 'lt', 
```

在你的论点中。wp_query 没有任何这样的论点“kalba”

也许你可以尝试改变你的论点

```
$args = array(
            'post_type' => 'post',
            'posts_per_page' => 7
                 ); 
```

像这样..希望它工作正常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T17:32:25.620

在循环之前我添加`<?php rewind_posts(); ?>`以及它何时工作。

# javascript - 嵌套函数中的函数上下文（“this”）

> ID：14677627
> 
> 赞同：6
> 
> 时间：2013-02-03T21:42:14.887
> 
> 标签：javascript

当您在 Javascript 中调用顶级函数时，函数内的*this*关键字引用默认对象（如果在浏览器中，则为窗口）。我的理解是，这是将函数作为方法调用的一种特殊情况，因为默认情况下它是在窗口上调用的（如 John Resig 的书，JavaScript Ninja 的秘密，第 49 页中所述）。事实上，以下代码中的两个调用都是相同的。

```
function func() {
  return this;
}

// invoke as a top-level function
console.log(func() === window); // true

// invoke as a method of window
console.log(window.func() === window); // true 
```

到目前为止一切顺利......现在这是我不明白的部分：

当一个函数嵌套在另一个函数中并在没有指定要调用的对象的情况下被调用时，函数内部的*this*关键字也指的是 window。但是不能在窗口上调用内部函数（参见下面的代码）。

```
function outerFunc() {
  function innerFunc() {
    return this;
  }

  // invoke without window.* - OK
  console.log(innerFunc() === window); // true

  // invoke on window
  //window.innerFunc(); - error (window has no such method)
  console.log(window.innerFunc) // undefined
}

outerFunc(); 
```

嵌套函数在窗口上不可用是完全有道理的，因为它毕竟是嵌套的......但是我不明白为什么 this 关键字指的是窗口，就好像函数是在窗口上调用的一样。我在这里想念什么？

**编辑**

以下是以下优秀答案的摘要以及我的一些后续研究。

*   说“正常”调用函数与将其作为*window*的方法调用是一样的，这是不正确的。只有在全局定义函数时，这才是正确的。

*   函数上下文（*this*关键字的值）不取决于函数的定义位置/方式，而是取决于调用它的方式。

*   假设代码没有在严格模式下运行，“正常”调用函数会将函数上下文设置为窗口（在浏览器中运行时，或在其他环境中运行相应的全局对象）。

*   上述规则的一个例外是使用*bind*来创建函数。在这种情况下，即使“正常”调用该函数，它也可能具有除*window*之外的上下文。也就是说，在这种情况下，上下文取决于您如何创建函数，而不是如何调用它。虽然严格来说这并不准确，因为*bind*创建了一个新函数，该函数使用*apply*内部调用给定函数。该新函数的上下文仍将由调用它的方式确定，但它通过使用*apply*屏蔽了它在内部调用的函数的上下文。

通过“正常”调用，我指的是以下简单的调用方式：

`myFunction();`

为了完成图片，这里简要介绍了其他调用方式和相应的上下文：

*   作为对象（方法）的属性——上下文就是对象

*   使用 apply 或 call - 明确指定上下文

*   使用*new*运算符（作为构造函数） - 上下文是一个新创建的对象

如有必要，请随时更新上述内容，以使有类似问题的人受益。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:46:02.530

您可以使用 调用范围内的任何函数`functionName()`。由于您没有在对象上调用它，它将在默认对象 ( `window`) 的上下文中调用。`undefined`（IIRC，如果您处于严格模式，它将在上下文中调用）。

上下文的默认对象与定义函数的位置或函数出现的范围无关。它只是默认对象。

如果函数是对象的属性，则可以将其调用为`reference.to.object.function()`，它将在上下文中调用，`object`而不是默认对象。

其他改变上下文的东西是`new`关键字和`apply`, `call`, 和`bind`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:46:50.693

在 JavaScript 中，当在没有显式上下文的情况下调用函数时，上下文就是全局对象。对于 Web 浏览器，全局对象是`window`.

此外，JavaScript 具有函数作用域，因此函数内的任何变量或函数都不能在该函数之外的作用域中访问。这就是你无法访问的原因`window.innerFunc`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:48:45.450

一个函数是否嵌套在另一个函数中与调用该函数时的值无关`this`。唯一重要的是：

*   如果通过遍历对象的属性“找到”该函数，则 的值`this`将是对该对象的引用：

    ```
    someObject.prop( whatever ); 
    ```

    函数的声明方式无关紧要。

*   如果您使用`call()`或`apply()`调用一个函数，那么 的值`this`将从您使用的任何一个函数的第一个参数中获取。

*   如果您已经为函数创建了一个绑定包装器`bind()`，那么 的值`this`将在`bind()`被调用时根据请求而定。

*   如果您将函数作为构造函数调用`new`，`this`则将引用新创建的对象实例。

*   否则，`this`要么是对全局上下文的引用，要么是`undefined`（在“严格”模式下或在符合 ES5 的运行时）。

当然，定义函数的代码中的“位置”确实很重要，因为范围包括它包含的任何符号，并且无论如何获得对它的引用，这些符号都可用于函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T21:49:09.063

它不依赖于函数的声明位置，而是它的调用方式：

```
var obj = {
   f: function() {
       return this;
   }
}

var f = obj.f;

console.log(obj.f()) // obj
console.log(f()) // window/default obj 
```

或者换句话说。语法`obj.f()`用 执行函数，`this=obj`而用`f()`执行函数`this=window`。在 JavaScript 中，调用者指定`this`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-03T21:54:06.520

当您`func`在全局范围内定义时，它实际上被分配为`window`对象的属性。也就是说，该`window`对象包含所有全局范围的变量。(*) 因此，`func`和`window.func`代表相同的事物。`innerFunc`在函数范围内定义，在该范围之外不可用。因此，`window.innerFunc`是（仍然）`undefined`。

但是，`this`上下文取决于您*调用*函数的方式。当您调用类似的方法`obj.method()`时，`this`上下文设置为`obj`. 另一方面，您也可以自己调用该方法：

```
var f = obj.func;
f(); // in this call: this === window 
```

在这种情况下，您没有在对象上调用函数，因此`this`上下文设置为默认值。然而，默认值是*全局范围*，如上所述，这由`window`.

您始终可以`this`通过使用`Function.prototype.call()`或`Function.prototype.apply()`将`this`上下文作为第一个参数来覆盖上下文。例如：

```
var f = obj.func;
f.call(obj); // in this call: this == obj 
```

(*) 请注意，这只适用于在浏览器中运行的 JavaScript。在其他环境中，这可能会有所不同。例如，在 Node.js 中，`GLOBAL`变量包含全局范围。

# c# - 如何获取 XML 模式验证失败位置的 XPath（或节点）？

> ID：14677631
> 
> 赞同：8
> 
> 时间：2013-02-03T21:42:45.497
> 
> 标签：c#, .net, linq-to-xml, xmldocument, xml-validation

我正在使用[XDocument.Validate](http://msdn.microsoft.com/en-us/library/bb340331.aspx)（它的功能似乎与 XmlDocument.Validate 相同）针对 XSD 验证 XML 文档 - 这很好用并且我被告知验证错误。

[但是，在ValidationEventHandler](http://msdn.microsoft.com/en-us/library/system.xml.schema.validationeventhandler.aspx)（和 XmlSchemaException）中似乎 [可靠地] 公开了一些信息，例如：

*   错误消息（即“‘X’属性无效 - 根据其数据类型‘Z’，值‘Y’无效 - 模式约束失败”），
*   严重性

我*想要*的是获得验证失败的“失败的 XPath”（这是有意义的）：也就是说，我想要获得与 XML 文档相关的失败（而不是 XML 文本）。

有没有办法从中获取“失败的 XPath”信息`XDocument.Validate`？如果不是，是否可以通过另一种 XML 验证方法（例如`XmlValidatingReader`¹ ）获得“失败的 XPath” ？

* * *

背景：

XML 将通过从 JSON 到 XML 的自动转换（通过 JSON.NET）作为数据发送到我的 Web 服务。因此，*我开始处理 XDocument 数据*¹而不是文本，由于原始 JSON 数据，文本没有保证顺序。由于我不想进入的原因，REST 客户端基本上是 XML 文档上的 HTML 表单字段的包装器，服务器上的验证分两部分进行 - XML 模式验证和业务规则验证。

在业务规则验证中，很容易为未能符合一致性的字段返回“XPath”，该字段可用于指示客户端上的失败字段。我想将此扩展到 XSD 模式验证，它负责基本的结构验证，更重要的是，基本的“数据类型”和属性的“存在”。然而，由于所需的自动过程（即突出显示适当的失败字段）和源转换，原始文本消息和源行/列号本身并不是很有用。

* * *

这是验证代码的片段：

```
// Start with an XDocument object - created from JSON.NET conversion
XDocument doc = GetDocumentFromWebServiceRequest();

// Load XSD    
var reader = new StringReader(EmbeddedResourceAccess.ReadResource(xsdName));
var xsd = XmlReader.Create(reader, new XmlReaderSettings());
var schemas = new XmlSchemaSet();
schemas.Add("", xsd);

// Validate
doc.Validate(schemas, (sender, args) => {
  // Process validation (not parsing!) error,
  // but how to get the "failing XPath"?
}); 
```

* * *

更新：我[在验证 XDocument 时发现捕获架构信息，](https://stackoverflow.com/questions/7858926/capture-schema-information-when-validating-xdocument)它链接到[“在文档验证期间访问 XML 架构信息”](http://geekswithblogs.net/.NETonMyMind/archive/2006/05/02/76957.aspx)（[缓存](http://webcache.googleusercontent.com/search?q=cache:9LdkX7vRit0J:geekswithblogs.net/.NETonMyMind/archive/2006/05/02/76957.aspx+Accessing+XML+Schema+Information+During+Document+Validation)），我从中确定了两件事：

1.  XmlSchemaException 可以专门化为具有 SourceObject 属性的 XmlSchemaValidationException - 但是，这[在](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschemavalidationexception.aspx)*验证期间始终返回 null*：“当验证 XmlReader 对象在验证期间抛出 XmlSchemaValidationException 时，SourceObject 属性的值为 null”。

2.  我可以通读文档（通过`XmlReader.Read`）并在验证回调之前“记住”路径。虽然这在初始测试中“似乎有效”（没有 ValidationCallback），但对我来说感觉很不雅 - 但我几乎找不到其他东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T06:20:25.523

验证事件的发送者是事件的来源。因此，您可以在网络上搜索为节点获取 XPath 的代码（例如，[生成 XPath 表达式](http://blogs.msdn.com/b/ericwhite/archive/2007/04/28/generating-an-xpath-expression-to-find-a-linq-to-xml-node.aspx)）并为事件源生成 XPath：

```
doc.Validate(schemas, (sender, args) => {
  if (sender is XObject)
  { 
     xpath = ((XObject)sender).GetXPath();
  }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-10T09:10:21.557

拿着 ：-）

```
var xpath = new Stack<string>();

var settings = new XmlReaderSettings
               {
                   ValidationType = ValidationType.Schema,
                   ValidationFlags = XmlSchemaValidationFlags.ReportValidationWarnings,
               };
MyXmlValidationError error = null;
settings.ValidationEventHandler += (sender, args) => error = ValidationCallback(sender, args);
foreach (var schema in schemas)
{
    settings.Schemas.Add(schema);
}

using (var reader = XmlReader.Create(xmlDocumentStream, settings))
{
    // validation
    while (reader.Read())
    {
        if (reader.NodeType == XmlNodeType.Element)
        {
            xpath.Push(reader.Name);
        }

        if (error != null)
        {
            // set "failing XPath"
            error.XPath = xpath.Reverse().Aggregate(string.Empty, (x, y) => x + "/" + y);

            // your error with XPath now

            error = null;
        }

        if (reader.NodeType == XmlNodeType.EndElement ||
            (reader.NodeType == XmlNodeType.Element && reader.IsEmptyElement))
        {
            xpath.Pop();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T23:02:36.003

我不知道 API，但我的猜测是否定的，您无法获得 xpath，因为验证可能被实现为有限状态机。状态可能不会转换为 xpath，或者当它对多个元素有效且找到的元素不在预期集合中时，xpath 不存在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-06T06:40:16.240

终于以这种方式成功了！

当我使用 XmlReader.Create(xmlStream, settings) 和 xmlRdr.Read() 验证 XML 时，我捕获了 ValidationEventHandler 的发送者并发现它是 {System.Xml.XsdValidatingReader} 的对象，所以我将发送者转移到xmlreader 对象，XMLReader 类中有一些函数可以帮助您找到错误属性的父节点。

有一点需要注意，当我使用 XMLReader.MoveToElement() 时，验证函数会卡在错误属性中的循环中，所以我使用了 MoveToAtrribute(AttributeName)，然后使用 MoveToNextAttribute 来避免卡在循环中，也许有是更优雅的处理方式。

事不宜迟，下面是我的代码。

```
public string XMLValidation(string XMLString, string SchemaPath)
    {
        string error = string.Empty;
        MemoryStream xmlStream = new MemoryStream(Encoding.UTF8.GetBytes(XMLString));

        XmlSchemaSet schemas = new XmlSchemaSet();
        schemas.Add(null, SchemaPath);

        XmlReaderSettings settings = new XmlReaderSettings();
        settings.ValidationType = ValidationType.Schema;
        settings.Schemas.Add(schemas);

        settings.ValidationEventHandler += new ValidationEventHandler(delegate(object sender, ValidationEventArgs e)
        {
            switch (e.Severity)
            {
                case XmlSeverityType.Error:
                    XmlReader senRder = (XmlReader)sender;
                    if (senRder.NodeType == XmlNodeType.Attribute)
                    {//when error occurs in an attribute,get its parent element name
                        string attrName = senRder.Name;
                        senRder.MoveToElement();
                        error += string.Format("ERROR:ElementName'{0}':{1}{2}", senRder.Name, e.Message, Environment.NewLine);
                        senRder.MoveToAttribute(attrName);
                    }
                    else
                    {
                        error += string.Format("ERROR:ElementName'{0}':{1}{2}", senRder.Name, e.Message, Environment.NewLine);
                    }
                    break;
                case XmlSeverityType.Warning:
                    break;
            }
        });
        XmlReader xmlRdr = XmlReader.Create(xmlStream, settings);
        while (xmlRdr.Read()) ;
        return error;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-26T09:47:58.780

或者，您可以使用[如何从 C# 中的行号和列号查找 XML 节点中的代码？](https://stackoverflow.com/questions/9226108/how-to-find-an-xml-node-from-a-line-and-column-number-in-c)使用 获取失败节点`args.Exception.LineNumber`，`args.Exception.LinePosition`然后根据需要导航 XML 文档，以提供有关哪些数据导致验证失败的更多信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-05T15:30:02.077

如果像我一样，您正在使用“XmlDocument.Validate(ValidationEventHandler validationEventHandler)”方法来验证您的 XML：

```
// Errors and alerts collection
private ICollection<string> errors = new List<String>();

// Open xml and validate
...
{
    // Create XMLFile for validation
    XmlDocument XMLFile = new XmlDocument();

    // Validate the XML file
    XMLFile.Validate(ValidationCallBack);
}

// Manipulator of errors occurred during validation
private void ValidationCallBack(object sender, ValidationEventArgs args)
{
    if (args.Severity == XmlSeverityType.Warning)
    {
        errors.Add("Alert: " + args.Message + " (Path: " + GetPath(args) + ")");
    }
    else if (args.Severity == XmlSeverityType.Error)
    {
        errors.Add("Error: " + args.Message + " (Path: " + GetPath(args) + ")");
    }
} 
```

秘诀是获取“args”参数的“Exception”属性数据。这样做：

```
// Return this parent node
private string GetPath(ValidationEventArgs args)
{
    var tagProblem =((XmlElement)((XmlSchemaValidationException)args.Exception).SourceObject);
    return iterateParentNode(tagProblem.ParentNode) + "/" +tagProblem.Name;
}

private string iterateParentNode(XmlNode args)
{
    var node = args.ParentNode;

    if (args.ParentNode.NodeType == XmlNodeType.Element)
    {
        return interateParentNode(node) + @"/" + args.Name;
    }
    return "";
} 
```

# networking - 生成唯一和随机 IP 地址的工具

> ID：14677632
> 
> 赞同：0
> 
> 时间：2013-02-03T21:42:45.600
> 
> 标签：networking, ip

我正在寻找生成随机和唯一 IP 地址以用于测试目的的脚本/工具。我发现了一些
1\. 生成少于 100 个随机 IP 的在线工具和
2\. 生成任意数量的 IP 但不确定它们是否唯一的脚本。我正在寻找一种可以生成一些 10K 唯一和随机 IP 地址的工具。

对这种技术有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:46:14.227

使用非保证随机生成一百万，然后执行以下操作：

```
cat results | sort -u | head -10000 > unique_results 
```

# iphone - 在 UIView 中一起动画图像和文本视图数组

> ID：14677633
> 
> 赞同：0
> 
> 时间：2013-02-03T21:42:49.517
> 
> 标签：iphone, ios6

我想在uiview中将imageview和textview数组一起动画。

现在我正在单独动画图像视图和单独的文本视图，这看起来不太好。

```
UIView *baseView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 430)];

 baseView.backgroundColor = [UIColor colorWithRed:255.0/255.0 green:252.0/255.0 blue:199.0/255.0 alpha:1.0];

[self.view addSubview:baseView];

 self.imageView = [[UIImageView alloc] initWithFrame:CGRectMake(60, 30, 200, 200)];

self.imageView.animationImages = [NSArray arrayWithObjects:
                             [UIImage imageNamed:@"1.png"],
                             [UIImage imageNamed:@"2.png"],
                            [UIImage imageNamed:@"3.png"],
                                  [UIImage imageNamed:@"4.png"],
                                  [UIImage imageNamed:@"5.png"],
                             nil];

// all frames will execute in 25 seconds

self.imageView.animationDuration = 20;

 [self.imageView startAnimating];

 [baseView addSubview:self.imageView];

  self.textView = [[UITextView alloc] initWithFrame:CGRectMake(10, 250, 300, 200)];

self.textView.textColor = [UIColor brownColor];

 myArray = [[NSMutableArray alloc] initWithObjects:@"string1", @"string2", @"string3", @"string4", @"string5", ...., nil];

[NSTimer scheduledTimerWithTimeInterval:2.5
                                 target:self
                               selector:@selector(updateText:)
                               userInfo:nil
                                repeats:YES];

 [baseView addSubview: self.textView];

- (void)updateText:(NSTimer *)theTimer
{
if (index < [myArray count])
{
    self.textView.text = [self.myArray objectAtIndex:index];
    index++;
}
else
    index = 0;

[timer invalidate];
} 
```

我如何在 UIView 中同时为图像视图和文本视图设置动画。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:56:02.987

这个怎么样，
在你的 .h

```
NSArray *imgsArray;
NSArray *myArray;
int indx;
NSTimer *timer; 
```

开始你的动画

```
-(void)start{
 imgsArray = [NSArray arrayWithObjects:[UIImage imageNamed:@"1.png"],[UIImage imageNamed:@"2.png"],
                      [UIImage imageNamed:@"3.png"],[UIImage imageNamed:@"4.png"],
                      [UIImage imageNamed:@"5.png"],nil];

 myArray = [[NSMutableArray alloc] initWithObjects:@"string1", @"string2", @"string3", @"string4", @"string5", nil];

timer = [NSTimer scheduledTimerWithTimeInterval:2.5
                                 target:self
                               selector:@selector(updateText:)
                               userInfo:nil
                                repeats:YES];
}

- (void)updateText:(NSTimer *)theTimer
{
    if (indx < myArray.count)
    {
        self.textView.text = [self.myArray objectAtIndex:indx];
        self.imageView.image = [self.imgsArray objectAtIndex:indx];
        indx++;
    }
    else
        indx = 0;

} 
```

# wordpress - 自定义移动主题

> ID：14677636
> 
> 赞同：0
> 
> 时间：2013-02-03T21:43:08.657
> 
> 标签：wordpress

好的，

所以我自己想出了如何用 Artisteer 模板制作移动网站。

基本上，我将工作表更改为 100% 流体宽度，最小 300 像素，一列，去掉菜单并用垂直菜单替换它，去掉大部分块或将它们放在垂直菜单下，使一切变小更简单。较小的字体，去掉了除 3px 之外的大部分填充，使标题更短，使垂直菜单栏足够高，可以用手指按下，等等。我的新的移动友好网站看起来很棒。

那么现在怎么办？我是否将其导出为 WordPress 主题，然后为每个网站安装两次 WordPress？

还是将其导出为 html，使用重定向 WordPress 插件，添加 RSS 提要？

嗯...我想我可以尝试 html，但无论如何我都会喜欢一些反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:52:31.077

您绝对不希望安装两次 Wordpress... 将管理开销加倍、重复内容等 - 不是要走的路。

最简单的方式 IMO - 实际上，这是一些商业移动主题开发人员推荐的方式 - 是使用像[http://wordpress.org/extend/plugins/mobile-theme-switcher/](http://wordpress.org/extend/plugins/mobile-theme-switcher/)这样的插件，它只是检测用户代理客户端的设备，如果它是移动设备，则切换到您的移动主题。所以一个 Wordpress 安装，两个主题。

我知道推荐插件并不是真正的方式:) - 如果需要，您可以随时查看代码并将其直接集成到您的主题中。

# c++ - 在 c++ builder 中将控件添加到 StringGrid

> ID：14677637
> 
> 赞同：1
> 
> 时间：2013-02-03T21:43:09.007
> 
> 标签：c++, c++builder

我想在 c++ 构建器中为 stringGrid 的每一行添加复选框。据我所知，特定列的每个单元格都不可能拥有自己的子控件。所以我该怎么做

```
for (int i = 1; i < this->StringGrid1->RowCount; i++) {
    this->StringGrid1->Cells[0][i]=IntToStr(i);
    TCheckBox *l=new TCheckBox(this->StringGrid1);
    l->Name="label"+IntToStr(i);
    l->Caption="OK";
    l->Visible=true;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:12:15.933

从**技术上讲**，可以将子控件放在 a 中`TStringGrid`（您的示例代码只是缺少一个`l->Parent = StringGrid1`赋值），但是管理这样的控件并不容易，尤其是在网格可滚动的情况下。

更好的解决方案是所有者绘制网格，通过切换到 a`TDrawGrid`并使用其`OnDrawCell`事件，因此您可以调用 Win32 API[`DrawFrameControl()`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162480.aspx)或[`DrawThemeBackground()`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773289.aspx)函数将复选框图像绘制到网格上。然后，您可以使用单独的数组/列表来跟踪复选框“状态”，并根据`OnMouse...`需要使用网格的事件来切换这些“状态”，`Invalidate()`每当复选框更改“状态”时调用网格的方法，以便您可以触发重绘显示它。但是如果你走这条路，你最好切换到虚拟 ListView 或虚拟 TreeView 而不是使用网格。

另一种解决方案是切换到将`TListView`其`ViewStyle`属性设置为`vsReport`mode 并将其`CheckBoxes`属性设置为 true 的 a。

# ruby - 注销后 RVM 设置丢失

> ID：14677639
> 
> 赞同：1
> 
> 时间：2013-02-03T21:43:30.450
> 
> 标签：ruby, macos

我在 OS X 上安装了 RVM 和 Ruby。我使用以下方法设置默认版本：

```
rvm use 1.9.3-p194 --default 
```

但这仅适用于当前的终端会话。当我开始一个新会话时，`ruby -v`返回我系统的 Ruby 版本。

有什么提示吗？

**UPD**

```
macbook:~ mighter$ rvm info

ruby-1.9.3-p194:

  system:
    uname:       "Darwin macbook.local 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64"
    system:      "osx/10.8/x86_64"
    bash:        "/bin/bash => GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin12)"
    zsh:         "/bin/zsh => zsh 4.3.11 (i386-apple-darwin12.0)"

  rvm:
    version:      "rvm 1.18.5 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]"
    updated:      "1 hour 22 minutes 16 seconds ago"

  ruby:
    interpreter:  "ruby"
    version:      "1.9.3p194"
    date:         "2012-04-20"
    platform:     "x86_64-darwin12.2.0"
    patchlevel:   "2012-04-20 revision 35410"
    full_version: "ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin12.2.0]"

  homes:
    gem:          "/usr/local/rvm/gems/ruby-1.9.3-p194"
    ruby:         "/usr/local/rvm/rubies/ruby-1.9.3-p194"

  binaries:
    ruby:         "/usr/local/rvm/rubies/ruby-1.9.3-p194/bin/ruby"
    irb:          "/usr/local/rvm/rubies/ruby-1.9.3-p194/bin/irb"
    gem:          "/usr/local/rvm/rubies/ruby-1.9.3-p194/bin/gem"
    rake:         "/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin/rake"

  environment:
    PATH:         "/usr/local/rvm/gems/ruby-1.9.3-p194/bin:/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin:/usr/local/rvm/rubies/ruby-1.9.3-p194/bin:/usr/local/rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/git/bin"
    GEM_HOME:     "/usr/local/rvm/gems/ruby-1.9.3-p194"
    GEM_PATH:     "/usr/local/rvm/gems/ruby-1.9.3-p194:/usr/local/rvm/gems/ruby-1.9.3-p194@global"
    MY_RUBY_HOME: "/usr/local/rvm/rubies/ruby-1.9.3-p194"
    IRBRC:        "/usr/local/rvm/rubies/ruby-1.9.3-p194/.irbrc"
    RUBYOPT:      ""
    gemset:       "" 
```

**登录后：**

```
macbook:~ mighter$ rvm info

system:

  system:
    uname:       "Darwin macbook.local 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64"
    system:      "osx/10.8/x86_64"
    bash:        "/bin/bash => GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin12)"
    zsh:         "/bin/zsh => zsh 4.3.11 (i386-apple-darwin12.0)"

  rvm:
    version:      "rvm 1.18.5 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]"
    updated:      "1 hour 21 minutes 18 seconds ago"

  homes:
    gem:          "not set"
    ruby:         "not set"

  binaries:
    ruby:         "/usr/bin/ruby"
    irb:          "/usr/bin/irb"
    gem:          "/usr/bin/gem"
    rake:         "/usr/bin/rake"

  environment:
    PATH:         "/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/git/bin:/usr/local/rvm/bin"
    GEM_HOME:     ""
    GEM_PATH:     ""
    MY_RUBY_HOME: ""
    IRBRC:        ""
    RUBYOPT:      ""
    gemset:       "" 
```

**UPD2**

```
macbook:~ mighter$ cat .bashrc 

PATH=$PATH:/usr/local/rvm/bin # Add RVM to PATH for scripting
macbook:~ mighter$ cat .bash_profile 

[[ -s "/usr/local/rvm/scripts/rvm" ]] && source "/usr/local/rvm/scripts/rvm" # Load RVM into a shell session *as a function* 
```

**UPD3**

```
/usr/local/rvm/scripts/rvm
#!/usr/bin/env bash

# rvm : Ruby enVironment Manager
# https://rvm.io
# https://github.com/wayneeseguin/rvm

# also duplicated in scripts/base
__rvm_has_opt()
{
  {
    [[ -n "${ZSH_VERSION}"  ]] && setopt | grep "^${1}$" >/dev/null 2>&1
  } ||
  {
    [[ -n "${BASH_VERSION}" ]] && [[ ":$SHELLOPTS:" =~ ":${1}:" ]]
  } ||
  return 1
}

# Do not allow sourcing RVM in `sh` - it's not supported
# return 0 to exit from sourcing this script without breaking sh
if __rvm_has_opt "posix"
then return 0
fi

# TODO: Alter the variable names to make sense
\export HOME rvm_prefix rvm_user_install_flag rvm_path
HOME="${HOME%%+(\/)}" # Remove trailing slashes if they exist on HOME

[[ -n "${rvm_stored_umask:-}" ]] || export rvm_stored_umask=$(umask)
if (( ${rvm_ignore_rvmrc:=0} == 0 ))
then
  rvm_rvmrc_files=("/etc/rvmrc" "$HOME/.rvmrc")
  if [[ -n "${rvm_prefix:-}" ]] && ! [[ "$HOME/.rvmrc" -ef "${rvm_prefix}/.rvmrc" ]]
     then rvm_rvmrc_files+=( "${rvm_prefix}/.rvmrc" )
  fi

  for rvmrc in "${rvm_rvmrc_files[@]}"
  do
    if [[ -f "$rvmrc" ]]
    then
      if GREP_OPTIONS="" \grep '^\s*rvm .*$' "$rvmrc" >/dev/null 2>&1
      then
        printf "%b" "
Error:
        $rvmrc is for rvm settings only.
        rvm CLI may NOT be called from within $rvmrc.
        Skipping the loading of $rvmrc"
        return 1
      else
        source "$rvmrc"
      fi
    fi
  done
  unset rvm_rvmrc_files
fi

# detect rvm_path if not set
if [[ -z "${rvm_path:-}" ]]
then
  if (( UID == 0 ))
  then
    if (( ${rvm_user_install_flag:-0} == 0 ))
    then
      rvm_user_install_flag=0
      rvm_prefix="/usr/local"
      rvm_path="${rvm_prefix}/rvm"
    else
      rvm_user_install_flag=1
      rvm_prefix="$HOME"
      rvm_path="${rvm_prefix}/.rvm"
    fi
  else
    if [[ -d "$HOME/.rvm" && -s "$HOME/.rvm/scripts/rvm" ]]
    then
      rvm_user_install_flag=1
      rvm_prefix="$HOME"
      rvm_path="${rvm_prefix}/.rvm"
    else
      rvm_user_install_flag=0
      rvm_prefix="/usr/local"
      rvm_path="${rvm_prefix}/rvm"
    fi
  fi
else
  # remove trailing slashes, btw. %%/ <- does not work as expected
  rvm_path="${rvm_path%%+(\/)}"
fi

# guess rvm_prefix if not set
if [[ -z "${rvm_prefix}" ]]
then
  rvm_prefix=$( dirname $rvm_path )
fi

# guess rvm_user_install_flag if not set
if [[ -z "${rvm_user_install_flag}" ]]
then
  if [[ "${rvm_prefix}" == "${HOME}" ]]
  then
    rvm_user_install_flag=1
  else
    rvm_user_install_flag=0
  fi
fi

export rvm_loaded_flag
if [[ -n "${BASH_VERSION:-}" || -n "${ZSH_VERSION:-}" ]] &&
  typeset -f rvm >/dev/null 2>&1
then
  rvm_loaded_flag=1
else
  rvm_loaded_flag=0
fi

if (( ${rvm_loaded_flag:=0} == 0 )) || (( ${rvm_reload_flag:=0} == 1 ))
then
  if [[ -n "${rvm_path}" && -d "$rvm_path" ]]
  then
    true ${rvm_scripts_path:="$rvm_path/scripts"}

    if [[ -f "$rvm_scripts_path/base" ]]
    then
      source "$rvm_scripts_path/base"
    else
      printf "%b" "WARNING:
      Could not source '$rvm_scripts_path/base' as file does not exist.
      RVM will likely not work as expected.\n"
    fi

    __rvm_ensure_is_a_function
    __rvm_setup

    export rvm_version
    rvm_version="$(cat "$rvm_path/VERSION") ($(cat "$rvm_path/RELEASE" 2>/dev/null))"

    alias rvm-restart="rvm_reload_flag=1 source '${rvm_scripts_path:-${rvm_path}/scripts}/rvm'"

    if ! builtin command -v ruby >/dev/null 2>&1 ||
      builtin command -v ruby | GREP_OPTIONS="" \grep -v "${rvm_path}" >/dev/null ||
      builtin command -v ruby | GREP_OPTIONS="" \grep "${rvm_path}/bin/ruby$" >/dev/null
    then
      if [[ -s "$rvm_environments_path/default" && "${rvm_action}" != "switch" ]]
      then
        source "$rvm_environments_path/default"
      elif [[ -s "$rvm_path/environments/default" ]]
      then
        source "$rvm_path/environments/default"
      fi
    fi

    # Makes sure rvm_bin_path is in PATH atleast once.
    __rvm_conditionally_add_bin_path

    if (( ${rvm_reload_flag:=0} == 1 ))
    then
      [[ "${rvm_auto_reload_flag:-0}" == 2 ]] || printf "%b" 'RVM reloaded!\n'
      # make sure we clean env on reload
      __rvm_env_loaded=1
      unset __rvm_project_rvmrc_lock
    fi

    rvm_loaded_flag=1
  else
    printf "%b" "\n\$rvm_path ($rvm_path) does not exist."
  fi
  unset rvm_prefix_needs_trailing_slash rvm_gems_cache_path \
    rvm_gems_path rvm_project_rvmrc_default rvm_gemset_separator rvm_reload_flag
else
  source "${rvm_scripts_path:="$rvm_path/scripts"}/initialize"
  __rvm_setup
fi

if [[ -t 0 && ${rvm_project_rvmrc:-1} -gt 0 ]] &&
  rvm_is_a_shell_function no_warning &&
  ! __function_on_stack __rvm_project_rvmrc &&
  typeset -f __rvm_project_rvmrc >/dev/null 2>&1
then
  # Reload the rvmrc, use promptless ensuring shell processes does not
  # prompt if .rvmrc trust value is not stored.
  rvm_promptless=1 __rvm_project_rvmrc
  rvm_hook=after_cd
  source "${rvm_scripts_path:-${rvm_path}/scripts}/hook"
fi

__rvm_teardown 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:02:18.917

您可能没有`rvm`在您的个人资料中包含该脚本。如果您以前安装过`rvm`它，可能会加载错误的文件，它们的位置与历史版本略有不同，但在重要方面发生了变化。

[安装文档](https://rvm.io/rvm/install/)建议：

```
echo "source $HOME/.rvm/scripts/rvm" >> ~/.bash_profile 
```

当然，如果您没有使用`bash`或`.bash_profile`由于某种原因没有被加载，这可能是您的问题的原因。

如果您已经完成了 root 安装，`rvm`则需要将该行调整为 include`/usr/local/scripts/rvm`或安装位置，然后进行更改`/etc/bash_profile`。

# git - git：重置后分支消失

> ID：14677643
> 
> 赞同：1
> 
> 时间：2013-02-03T21:44:03.693
> 
> 标签：git, branch, reset

这是我所做的：

我将其合并`kernel_common/android-3.0`到我的主要[本地分支](http://github.com/android/kernel_common/tree/android-3.0)中。

然后我想重置到Linux 3.0.13，所以我查阅了历史，发现[了这个](https://github.com/android/kernel_common/commits/android-3.0?page=63)

问题是，Android 提交在重置时显示为未跟踪的更改（也就是我丢失了所有提交）。

![](../Images/6538254128fe0d3853757034c9b6ac4e.png)

**请参见上图，当我重置为黄色提交时，我会“松开”蓝色提交，反之亦然。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:07:08.140

那是完全正确的。

黄色提交不包含蓝色提交，反之亦然。

重置只会使您分支指向新的提交，即它将仅包含该时间点的代码，并且对以后的合并一无所知。

如果您想拥有一个将蓝色状态与黄色状态相结合的新状态，只需合并这些提交：

```
git checkout -b mybranch $blue_SHA1
git merge $yellow_SHA1 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-04T17:27:56.070

我终于明白了：`git reset`对 Android 提交做了一个然后合并了 Linux 提交。

谢谢！

# android - android.provider.CallLog.Date 比较失败

> ID：14677645
> 
> 赞同：0
> 
> 时间：2013-02-03T21:44:24.403
> 
> 标签：android

当我在没有该比较的情况下执行以下代码时，它可以工作，但是通过该比较它会失败。

***感谢 Oleg Vaskevich，用他的观点更新了代码。日期范围是 1-31，不像月份 0-11 和 Date(int,int,int) 替换为 Date(long)***

编辑代码

```
Calendar cal = Calendar.getInstance();
    cal.add(Calendar.MONTH, -1);

    int month = cal.get(Calendar.MONTH);
    int year = cal.get(Calendar.YEAR);
    int day=cal.get(Calendar.DATE); // for dynamic reset rates

    callSince.setText("since(dd/mm/yyyy) :" + day + "/" + (month+1) + "/"  + year );
        // month+1 because month {0-11}

    Date resetDateDate = new Date(cal.getTimeInMillis());

    Calendar resetDateCal = Calendar.getInstance();
    resetDateCal.setTime(resetDateDate);
    String resetDate = String.valueOf(resetDateCal.getTimeInMillis());

    /*
     * CALL INCOMING
     */

    projection = new String[] {CallLog.Calls.DURATION };
    selection = CallLog.Calls.TYPE + "=? AND " + CallLog.Calls.DATE + " >=?" ;
    selectionArgs = new String[] { (String.valueOf(CallLog.Calls.INCOMING_TYPE)) , (resetDate) };

    try
    {
        Cursor cIn = getContentResolver().query(CallLog.Calls.CONTENT_URI, projection, selection, selectionArgs, sortOrder);
        startManagingCursor(cIn); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:50:26.660

您可以在此处看到从一月减去 1 的结果是 -1，而不是十二月。要解决此问题，请使用[`java.util.Calendar`](http://developer.android.com/reference/java/util/Calendar.html)类的方法`add()`来处理滚动正确的字段。例如：

```
myCalendar.add(Calendar.MONTH, -1); 
```

只有在您使用完日历后，您才能检索日历的实际字段。

# ruby-on-rails - respond_with ArgumentError（提供了 Nil 位置。无法构建 URI。）：

> ID：14677646
> 
> 赞同：21
> 
> 时间：2013-02-03T21:44:42.230
> 
> 标签：ruby-on-rails

我有一个控制器，它为所有 RESTful 操作、索引、创建、更新等响应 JSON，

```
class QuestionsController

 respond_to :json

   def index
     respond_with Question.all
   end

end 
```

但是，我在控制器中还有其他操作。例如，在一种方法中，它检查响应是否正确，然后尝试返回具有布尔值 true 或 false 的变量

```
respond_with correct_response  #either true or false 
```

但是，这给了我错误

```
ArgumentError (Nil location provided. Can't build URI.): 
```

我还希望使用多个值来响应其他方法。在 Sinatra 中，您可以这样做以响应 json

```
{:word => session[:word], :correct_guess => correct_guess, :incorrect_guesses => session[:incorrect_guesses], :win => win}.to_json 
```

我将如何在 Rails 中做到这一点？

所以，两个问题，写这个的正确方法是什么

```
respond_with correct_response 
```

以及如何以类似于我在 Sinatra 应用程序中展示的示例的方式响应多个值。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-03T22:02:14.123

你想要[`ActionController::Base#render`](http://apidock.com/rails/ActionController/Base/render)，没有`respond_with`。做你想要在这里实现的正确方法是：

```
render json: {word: session[:word], correct_guess: correct_guess, incorrect_guesses: session[:incorrect_guesses], win: win} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-01-14T05:51:58.480

`respond_with`在这种情况下实际上是可以的——它只是碰巧为你做了一些魔法，并且依赖于访问它需要的信息；看看 Rails 4.1.9 的[actionpack/lib/action_controller/metal/responder.rb](https://github.com/rails/rails/blob/v4.1.9/actionpack/lib/action_controller/metal/responder.rb)。

在您的情况下，`ArgumentError (Nil location provided. Can't build URI.)`实际上是在说真话-它试图从`location`标头设置中确定要使用的 URL，但无法弄清楚。如果你给它一个，我敢打赌你可以让你的代码工作：

```
class QuestionsController
  respond_to :json

  def index
    respond_with Question.all, location: questions_url
  end
end 
```

# php - 如何计算论坛中的“上次访问”

> ID：14677648
> 
> 赞同：0
> 
> 时间：2013-02-03T21:44:49.177
> 
> 标签：php, forums

我已经编写了自己的讨论软件（它工作得非常好），但是我们的一位用户要求我将“自我上次访问以来”的讨论标记为新的。（目前，我们只是将过去 24 小时内更新的任何讨论项目标记为新的。）所以...

**如何计算用户“上次访问”的日期/时间？**

*   用户可能保持登录状态，所以我不能使用“最后登录”时间：因为这可能是过去几周或几个月的时间。
*   如果我在每次页面加载时更新用户记录，那么“自从我上次访问以来”将是“自从我上次加载页面以来”，这显然是行不通的。

论坛软件计算“上次访问”日期/时间的典型方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:54:02.463

我们坚持用户对帖子的“观点”。视图将帖子与用户和时间戳相关联。当用户加载页面时，该页面上显示的任何帖子都会被标记为已被该用户查看（如果尚未查看）。然后，新帖子只是用户尚未看到的帖子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:52:51.273

您可以查看自上次页面加载以来是几个小时，还是一天。

# php - $.ajax 和 php 的进度条

> ID：14677649
> 
> 赞同：1
> 
> 时间：2013-02-03T21:44:57.477
> 
> 标签：php, jquery, progress-bar

我正在尝试制作一个与 $.ajax(jquery) 和 php 一起用于文件上传器的进度条，但我不知道如何组装它。我知道有一个使用 jQuery UI 的进度条；但是，它只是在接收值时发生变化。这就是重点。如何获得上传字节的动态值？

顺便说一句，这是我的代码：

* * *

fx_file.js

```
/*This function gets Data from the form and send it to server*/
function fiEnviarDatos2(){
    $("form#data").click(function(){
            /*Some DOM'S animations*/
    });

    $("form#data").submit(function(){

    var formData = new FormData($(this)[0]);

    $.ajax({
        url: "PHP/Core/Archivos/upload.php",
                    type: 'POST',
                    data: formData,
                    async: false,
                    success: function (data) {

                        /*After actions**/

                    },
                    progress:function(data){
                        alert(data);
                    },
                    cache: false,
                    contentType: false,
                    processData: false
    });
return false;
});` 
```

* * *

上传.php

* * *

```
<?php include ("Class_upload.php");

 /*Variables*/
$i=0;
$archivos=0;

/*Contains numbers of file sent*/
$archivos=((count($_FILES,1)-6)/5);

/*Contains the user's session name*/
session_start();
$sUsuario=$_SESSION['usuario'];

/*Use the information of each file to create a new class Upload*/
for($i=0;$i<$archivos;$i++){

    /*FileSize*/
    $tamaArchivo = $_FILES['formUploader']['size'][$i];

    /*Filename*/
    $nombArchivo = strtolower($_FILES['formUploader']['name'][$i]);

    /*Filetemp*/
    $tmpArchivo = $_FILES['formUploader']['tmp_name'][$i];

    /*It creates class Upload*/
    $archivo_subir=new Upload($nombArchivo,$tamaArchivo,$tmpArchivo,$sUsuario);

    /*It validates each file and returns a status*/
    $estatus=$archivo_subir->enviarData();

    /*Returns if file's been uploaded or not*/
    $resultFile=$archivo_subir->resultFile($estatus);
    echo "<br>";
    if($estatus>0){
        echo "<div class='resultDeny'>".$resultFile."</div>";
    }else{
        if($resultFile=="ServerError"){
            echo "<div class='resultServer'>".$resultFile."</div>";
        }else{
            echo "<div class='resultSuccess'>".$resultFile."</div>";
        }

    }

} 
```

* * *

我希望我能从你们那里得到一些帮助，伙计们。我知道你们都是专家。我是 jquery 和 php 的新手；然而，我已经看到了“他们的力量在一起”，我想了解更多关于他们的信息。

谢谢大家。

PDT：对不起，我的英语不是我的母语。JQ & PHP 将。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:56:36.700

看看这个页面： [http ://www.johnboy.com/php-upload-progress-bar/](http://www.johnboy.com/php-upload-progress-bar/)

[http://www.johnboy.com/php-upload-progress-bar/upload_frame.phps](http://www.johnboy.com/php-upload-progress-bar/upload_frame.phps) 基本上

```
 function(data)    //return information back from jQuery's get request
        {
            $('#progress_container').fadeIn(100);    //fade in progress bar    
            $('#progress_bar').width(data +"%");    //set width of progress bar based on the $status value (set at the top of this page)
            $('#progress_completed').html(parseInt(data) +"%");    //display the % completed within the progress bar
        }
    )},500); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T16:48:14.690

经过几乎一整天的调查，我实现了我想要的。

我发现这个插件叫做 JQUERY Form Plugin。[http://malsup.com/jquery/form/][1]

也许你们中的一些人已经使用过它。它具有几乎所有必要的选项来构建进度条并在提交表单之前和之后引入代码。

所以，检查一下。也许有人觉得它有用

顺便说一句，这就是我的代码现在的样子

**accountUser.html**

* * *

```
<html>
//...

...//
<style>

 form { display: block; margin: 20px auto; background: #eee; border-radius: 10px; padding: 15px }
.progress { position:relative; width:400px; border: 1px solid #ddd; padding: 1px; border-radius: 3px; margin-top:-200px }
.bar { background-image:url(Imagenes/index/pbar-ani.gif); width:0%; height:20px; border-    radius: 3px; }
.percent { position:absolute; display:inline-block; top:3px; left:48%; }

</style>

<script language="javascript" src="Scripts/jquery_min_1.8.js"></script>
<script language="javascript" src="Scripts/fx_file.js"></script>
<script language="javascript" src="Scripts/jquery.form.js"></script>

//...

..//
<form  action="#" method="post" enctype="multipart/form-data" id="formu">
    <input name="formUploader[]" type="file" multiple id="archivo"/>
   <input class="button" type="submit" alt="Upload" value="Subir" id="btn_cargar"/>
</form>

<div class="progress">
    <div class="bar"></div >
    <div class="percent">0%</div >
</div>

//...

..//
</html> 
```

**fx_file.js**

* * *

```
$(document).ready(function() { 

        // prepare Options Object 
        var bar = $('.bar');
        var percent = $('.percent');
        var status = $('#status');

        var options = { 
            url:  "upload.php", 
            type: 'POST',
            uploadProgress: function(event, position, total, percentComplete) {
                var percentVal = percentComplete + '%';
                $(bar).animate({width:percentVal});
                percent.html(percentVal);

            },
            success: function(data){

                    //After actions

            }
        }; 
        // bind 'formu' and provide a simple callback function 
       $('#formu').ajaxForm(options);
}); 
```

**上传.php**

* * *

```
<?php include ("Class_upload.php");

/*Variables*/
$i=0;
$archivos=0;

/*Contains numbers of file sent*/
$archivos=((count($_FILES,1)-6)/5);

/*Contains the user's session name*/
session_start();
$sUsuario=$_SESSION['usuario'];

/*Use the information of each file to create a new class Upload*/
for($i=0;$i<$archivos;$i++){

      /*FileSize*/
      $tamaArchivo = $_FILES['formUploader']['size'][$i];

      /*Filename*/
      $nombArchivo = strtolower($_FILES['formUploader']['name'][$i]);

      /*Filetemp*/
      $tmpArchivo = $_FILES['formUploader']['tmp_name'][$i];

      /*It creates class Upload*/
      $archivo_subir=new Upload($nombArchivo,$tamaArchivo,$tmpArchivo,$sUsuario);

      /*It validates each file and returns a status*/
      $estatus=$archivo_subir->enviarData();

      /*Returns if file's been uploaded or not*/
      $resultFile=$archivo_subir->resultFile($estatus);
      echo "<br>";

      if($estatus>0){
            echo "<div class='resultDeny'>".$resultFile."</div>";
      }else{
         if($resultFile=="ServerError"){
            echo "<div class='resultServer'>".$resultFile."</div>";
         }else{
            echo "<div class='resultSuccess'>".$resultFile."</div>";
         }

      }

}//End For

<?php> 
```

# mysql - 具有包含指向本地文件的链接的列的数据库架构

> ID：14677653
> 
> 赞同：0
> 
> 时间：2013-02-03T21:45:18.650
> 
> 标签：mysql, database, database-schema

我需要一个可以包含人名、性别、IdNum 和照片的数据库。前三个参数很简单，但第三个参数：照片，对我来说有点挑战。我想要一个命令，以便它可以存储指向照片在用户文件系统上的任何位置的链接，而不是使用 BLOB 数据类型。我只需要关于如何最好地做到这一点的建议。想一想用户必须输入他/她的 IdNum 并且所有其他信息都显示在屏幕上的表单。他们的姓名、性别、IdNum 和照片。沿着这条线的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:49:36.923

链接只不过是一个字符串。所以使用 VARCHAR 类型就可以了。

也许你应该改进你的问题。

# javascript - 缩略图区域需要 jquery 滑块

> ID：14677656
> 
> 赞同：5
> 
> 时间：2013-02-03T21:45:25.633
> 
> 标签：javascript, php, jquery, wordpress, jquery-ui-slider

我正在做一个项目[http://www.node.au.com](http://www.node.au.com)。在主页中，您可以看到很多图像，我需要做的是为具有多个图像的图像放置一个滑块，以便用户无需单击该特定图像具有多个图像的图像即可看到它就像在[http://themes.swiftpsd.com/clique/](http://themes.swiftpsd.com/clique/)中一样，当鼠标悬停在图像上时，我需要与上述参考链接中相同的图像标题。我搜索了它，但找不到它。

这是我的代码

```
 <ul id="fdgSlides">
<?php if(get_post_meta($post->ID, 'two2_project_featured_image',true)==1){
    $showFeat = false; } else { $showFeat = true; } $nvideoshtml5 = 1; $naudios = 1; 

$images = two2_get_project_media('thumbnail','large_slideshow',$showFeat);     
    if(count($images)>0){ foreach($images as $image){ ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-03T07:46:11.783

我认为 nivoslider 可以帮助你很多。 [Nivoslider 网站](http://dev7studios.com/nivo-slider/)

这是一个与 wordpress 集成的 wordpress 插件[HERE](http://wordpress.org/plugins/wp-nivo-slider/)

这是一个将其与 wordpress [HERE](http://www.blogohblog.com/how-to-integrate-nivo-slider-into-wordpress/)完全集成的教程。

希望对你有帮助:)

# c - OpenCV 代码示例错误

> ID：14677660
> 
> 赞同：0
> 
> 时间：2013-02-03T21:45:51.687
> 
> 标签：c, opencv, runtime-error

我编写了以下代码示例，它应该创建一个外观奇特的渐变并将其保存到用户指定的文件中：

```
#include <stdio.h>
#include <cv.h>
#include <highgui.h>

static IplImage *image = 0;

void main() {
   char path[1024];
   int x, y;
   CvScalar scalar;

   scanf("%s", path);
   image = cvCreateImage(cvSize(640,480),IPL_DEPTH_8U,1);

   for (y = 0; y < 480; y++) {
      for (x = 0; x < 640; x++) {
         scalar = cvGet2D(image, x, y);
         scalar.val[0]=(unsigned char)(x + y);
         cvSet2D(image, x, y, scalar);
      }
   }

   cvSaveImage(path, image, 0);
} 
```

我使用：编译它`gcc opencv.c -o opencv `pkg-config --libs --cflags opencv` -lm`，一切似乎都很好。但是，在运行时（输入：“sample.png”），我收到以下错误：

```
OpenCV 错误：在 cvPtr2D，文件 /builddir/build/BUILD/OpenCV-2.3.1/modules/core/src/array.cpp，第 1797 行中，其中一个参数的值超出范围（索引超出范围）
在抛出 'cv::Exception' 的实例后调用终止
  什么（）：/builddir/build/BUILD/OpenCV-2.3.1/modules/core/src/array.cpp:1797：错误：（-211）索引超出函数cvPtr2D的范围

中止（核心转储）

```

请问有什么帮助吗？提前致谢！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T22:12:29.260

cvGet2D 和 cvSet2D 使用 [row,column] 约定，就像 opencv 中的许多其他函数一样。

进一步阅读： [http ://www.cs.iit.edu/~agam/cs512/lect-notes/opencv-intro/](http://www.cs.iit.edu/~agam/cs512/lect-notes/opencv-intro/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:12:33.177

`cvGet2D`and函数将`cvSet2D`行作为第一个参数，将列作为第二个参数：您的 x 和 y 参数反了。因此，您将离开图像。调用应该是：

```
cvGet2D(image, y, x); 
```

# mongodb - mongodb优化聚合查询的方式

> ID：14677674
> 
> 赞同：0
> 
> 时间：2013-02-03T21:47:01.227
> 
> 标签：mongodb, performance, data-modeling, nosql

我在我的项目中使用 MongoDB 进行统计和数据分析。我的目标是设计具有最佳性能和可扩展性的数据。

假设我有几家商店和每家商店的独特产品列表。我需要查询一些关于产品的数据，计算一些基本的统计数据（仅限窗帘店）。

从性能的角度来看，哪种方式更好：在里面有一个 Shop 文档和一个产品列表，然后只根据这个文档进行查询。

或者更好的是对其中的所有商店的所有产品进行单独的集合，然后为该集合构建查询？

* * *

也许是问题本身：mongodb 是否可以像通过许多文档一样以如此高效的方式查询一个文档的正文。

* * *

**UPD 1：** 现在让我们假设产品本身非常小（Id、Price、Name、Count）并且数量有限。（所以我确定每家商店不会超过1000种产品）

**UPD2** 还让我们假设我不想为了查看目的而读取该数据库，只是为了统计。（卖了多少，哪个最有趣，什么组等等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:59:04.037

与所有这些问题一样，主要决定因素之一是数据大小和增长。

您每家商店的数据量会超过 16 兆吗？从商店可以拥有多少商品以及可以将多少数据归因于单个商品来判断，我会非常快。

我的意思是想象一个产品有多少个字段：

*   产品编号
*   描述
*   价格
*   选项
*   货币
*   简介
*   库存单位
*   条形码（或其他）

其中一些字段会很大，例如，产品的描述可能会很大。

但是，如果碰巧这是一个非常简单的应用程序，并且您正在寻找可以完全包含在单个数据行中的产品以及永远不会超过 5-8,000 件商品的商店，那么您可以使用以下子文档做得更好排序：

```
{
    _id: ObjectId(),
    shop_name: 'toys r us',
    items: [
        { p_id: ObjectId(), price: '1000000', currency: 'GBP', description: 'fkf' }
    ]
} 
```

不过，子文档并非没有代价。假设您有一个只有一个子文档的文档，10 天内有 100 个，20 天后有 1000 个。

不断增长的文档造成的碎片化可能非常严重。这会降低你的表现。不仅你的性能会成为一个问题，而且修复碎片也不是一件好事，然后在应用程序逻辑中解决它就更难了。

要了解有关 MongoDB 在内部实际工作的更多信息，您可以查看此演示文稿：[http ://www.10gen.com/presentations/storage-engine-internals](http://www.10gen.com/presentations/storage-engine-internals)

至于对子文档的查询，它确实需要在 MongoDB 端做一些额外的工作，但如果您设置正确，它仍然很便宜（比多次往返便宜）。

根据我上面提供的信息，我个人会选择两个系列，但我不知道你的场景的真实程度......

### 编辑

> UPD 1：现在让我们假设产品本身非常小（Id、Price、Name、Count）并且数量有限。（所以我确定每家商店不会超过1000种产品）

好的，所以您的文档很小，每个可能只有几个字节。在这种情况下，您可能可以在此处使用具有 2 个大小分配功能的子文档来弥补一些碎片：[http ://docs.mongodb.org/manual/reference/command/collMod/#usePowerOf2Sizes](http://docs.mongodb.org/manual/reference/command/collMod/#usePowerOf2Sizes)

这可以创建一个高性能的操作，仍然 1 到 1000 个子文档可能会导致碎片，但是这些碎片应该在它们出现时由较小的“新”商店文档填充。

> UPD2 还让我们假设我不想为了查看目的而读取该数据库，只是为了统计。（卖了多少，哪个最有趣，什么组等等）

因此，每个商店，使用子文档，您可以轻松获得每个商店的总销售额，例如：

```
db.shops.aggregate([
    // Match shop id 1
    {$match: {_id: 1}},

    // unwind the products for that shop
    {$unwind: '$products'},

    // Group back up by shop id and total amount sold
    {$group: {_id: '$_id', total_sold: {$sum: '$products.sold'}}}
]) 
```

使用新的聚合框架（从 2.1 版开始）：[http ://docs.mongodb.org/manual/applications/aggregation/](http://docs.mongodb.org/manual/applications/aggregation/)

因此，子文档也可以像查询两个单独的集合一样简单。

# php - 计算哪些键是数字的数组元素

> ID：14677677
> 
> 赞同：3
> 
> 时间：2013-02-03T21:47:20.630
> 
> 标签：php, arrays

我有一个很奇怪的数组：

```
Array
(
   [title] => title
   [weight] => 0
   [0] => Text1
   [1] => Text2
   [additional] => Info
} 
```

如何计算哪些键是数字的数组元素（仅）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-03T21:53:15.393

```
$data = array(
    'title' => 'title',
    'weight' => 0,
    0 => 'Text1',
    1 => 'Text2',
    'additional' => 'Info'
);

$keyCount = count(
    array_filter(
        array_keys($data),
        'is_numeric'
    )
);

var_dump($keyCount); 
```

**编辑**

从 PHP 5.6.0 版开始，您可以使用

```
$keyCount = count(
    array_filter($data, 'is_numeric', ARRAY_FILTER_USE_KEY)
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T21:50:52.217

应该很简单：

```
$i = 0;
foreach  ($arr as $k => $v) {
    if (is_numeric($k))
        $i++;
} 
```

# android - 如何在列中显示长文本？

> ID：14677680
> 
> 赞同：0
> 
> 时间：2013-02-03T21:48:02.670
> 
> 标签：android, textview, multiple-columns

我有一个很长的文本，我想在列中显示它，就像在报纸上一样。有没有办法做到这一点，自定义 text.layout？或者我真的需要自己在构建的文本视图中剪切文本？

[编辑] 我确实知道如何并排显示 textview（线性布局等），我实际上是从一个我想在列中显示的大字符串开始的。我放弃了 webview 和 css 的想法（对于已知的性能问题）。然后我想知道除了剪切我的文本是否还有其他方法，使用以下代码：

```
int height    = textView.getHeight();
int scrollY   = textView.getScrollY();
Layout staticLayout = textView.getLayout();

int lastVisibleLineNumber  = staticLayout.getLineForVertical(scrollY+height);
int start = staticLayout.getLineEnd(lastVisibleLineNumber);
int end = staticLayout.getLineEnd(textView.getLineCount()-1);
String textToDisplayIntOtherView = textView.getText().toString().substring(start, end); 
```

我可以简单地在列中显示我的文本，自定义 Text.layout 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:50:22.253

```
<TextView
    android:id="@+id/first_txt"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:textSize="30dp"
    android:width="100dip"
    android:textColor="#ffffff"
    android:text="first column" />

<TextView
    android:id="@+id/second_txt"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@+id/first_txt"
    android:textSize="20dp"
    android:width="100dip"
    android:textColor="#0481ab"
    android:text="second column"/> 
```

如果可以使用指定宽度 android:width="100dip" 自定义多行中每个 textview 的宽度

# mysql - 使用特定条件选择 SQL 中的所有行

> ID：14677683
> 
> 赞同：0
> 
> 时间：2013-02-03T21:48:34.603
> 
> 标签：mysql, sql

我正在处理一个相当复杂的`SQL`声明。这是我所在的位置：

```
 SELECT  c.category
              FROM master_cat as c
        LEFT JOIN
            (
                SELECT cat_id, user_id COUNT(cat_id) favoriteCat
                FROM ratings
                GROUP BY user_id
            ) a ON a.cat_id= c.cat_id
        LEFT JOIN users AS u  
            ON  u.user_id AND a.user_id

WHERE u.username = '{$user}' LIMIT 1 
```

这种说法是不完整的。我在这里缺少一张中间桌子。 `cat_id`实际上不在`ratings`. 但是`items_id`来自一个名为的表`items`，并且`cat_id`也在该表中。

所以我想做的是：

```
SELECT rating FROM ??? GROUP BY cat_id where u.user=$user 
```

我唯一能想到的可能是另一个 LEFT 加入`items`inside `favoriteCat`，但我不确定这是否允许。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:44:51.680

我想多了，这是我的最终解决方案：

```
SELECT  c.category,   count(r.rating) AS totalCount
FROM ratings as r
LEFT JOIN items AS i
   ON i.items_id = r.item_id
LEFT JOIN users AS u
   ON u.user_id = r.user_id
LEFT JOIN master_cat AS c
   ON c.cat_id = i.cat_id
WHERE  r.user_id = '{$user_id}'
GROUP BY c.category
ORDER BY totalCount DESC 
```

# html - Firefox 中的 requestAnimationFrame 闪烁问题

> ID：14677684
> 
> 赞同：4
> 
> 时间：2013-02-03T21:48:43.590
> 
> 标签：html, firefox, canvas, requestanimationframe

我正在尝试在画布上沿对角线方向制作一个圆圈。我正在使用 requestanimationframe。它在所有浏览器中都能顺利运行，但在 Firefox 中却不行。动画进行时会不断闪烁。请有人告诉我我做错了什么。我需要在Firefox中以至少合理的速度平滑动画。

这是我的简单代码，也许有人可以指出我在这里缺少的东西..：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<style>
/*html { background: #000; }*/
</style>

<title>Test</title>
</head>

<body>
<script type="text/javascript">

    window.requestAnimFrame = (function(){
      return  window.requestAnimationFrame       || 
              window.webkitRequestAnimationFrame || 
              window.mozRequestAnimationFrame    || 
              window.oRequestAnimationFrame      || 
              window.msRequestAnimationFrame     || 
              function(/* function */ callback, /* DOMElement */ element){
                window.setTimeout(callback, 1000 / 60);
              };
    })();

window.cancelRequestAnimFrame = ( function() {
    return window.cancelAnimationFrame          ||
        window.webkitCancelRequestAnimationFrame    ||
        window.mozCancelRequestAnimationFrame       ||
        window.oCancelRequestAnimationFrame     ||
        window.msCancelRequestAnimationFrame        ||
        clearTimeout
} )();  

var canvas, context, toggle;
var ctr = 0;
var request;

var x = 10;
var y = 10;

init();
animate();

function init() {

    canvas = document.createElement( 'canvas' );
    canvas.width = 512;
    canvas.height = 512;

    context = canvas.getContext( '2d' );

    document.body.appendChild( canvas );

}

function animate() {

    request = requestAnimFrame( animate );
    draw();

}

function draw() {

  context.clearRect(0,0,canvas.width,canvas.height);
  y+=2;
  x+=2;

  context.beginPath();
  context.arc(x, y, 3, 0, 2 * Math.PI, false);
  context.fillStyle = 'green';
  context.fill();
  context.lineWidth = 5;
  context.strokeStyle = '#003300';
  context.stroke();

    //cancelRequestAnimFrame(request); 

}

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T09:25:37.787

您的代码中有两件事需要修改：

**首先**尝试新的`requestAnimationFrame`polyfill。

```
(function() {
    var lastTime = 0;
    var vendors = ['ms', 'moz', 'webkit', 'o'];
    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
        window.cancelRequestAnimationFrame = window[vendors[x]+
          'CancelRequestAnimationFrame'];
    }

    if (!window.requestAnimationFrame)
        window.requestAnimationFrame = function(callback, element) {
            var currTime = new Date().getTime();
            var timeToCall = Math.max(0, 16 - (currTime - lastTime));
            var id = window.setTimeout(function() { callback(currTime + timeToCall); }, 
              timeToCall);
            lastTime = currTime + timeToCall;
            return id;
        };

    if (!window.cancelAnimationFrame)
        window.cancelAnimationFrame = function(id) {
            clearTimeout(id);
        };
}()) 
```

如需深入解释，请阅读本文： http: [//my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating](http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating)

第二**个**是您需要计算一个时间戳和下一个时间戳之间的增量。您正在使用一个固定值，每次渲染迭代都会增加一个。因为您的浏览器跟不上它可能会跳过一两帧的速度。这样你就可以顺利度过。

这是计算增量时间的方式：

```
end = Date.now();
delta = ( end - start ) / 1000.0 * 60;
end = start; 
```

[http://jsfiddle.net/p5c6c/1/](http://jsfiddle.net/p5c6c/1/)

# python - Python：递归函数后打印新行

> ID：14677685
> 
> 赞同：0
> 
> 时间：2013-02-03T21:48:44.970
> 
> 标签：python, recursion

我正在写一个树遍历方法。输出需要在一行上。但是，当方法完成后，我想插入一个换行符。有什么方法可以在函数内执行此操作，还是必须从外部调用它？

现在我有：

```
def postorder_transversal(self):
    if self.node == None:
        return 0
    for child in self.children:
        child.postorder_transversal()
    print self.node, 
```

关于如何改变它的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:52:40.907

您可以像这样在函数内部执行此操作：

```
def postorder_transversal(self, add_newline=True):
    if self.node == None:
        return 0
    for child in self.children:
        child.postorder_transversal(add_newline=False)
    print self.node,
    if add_newline:
        print 
```

虽然在外面做可能更干净。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T21:53:36.380

您可以将深度作为参数传递：

```
def postorder_transversal(self, depth=0):
    if self.node == None:
        return 0

    for child in self.children:
        child.postorder_transversal(depth=depth + 1)

    print self.node,

    if depth == 0:
        print 
```

并具有以下`print`功能：

```
from __future__ import print_function

def postorder_transversal(self, depth=0):
    if self.node == None:
        return 0

    for child in self.children:
        child.postorder_transversal(depth=depth + 1)

    print(self.node, end='\n' * (depth == 0)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T21:50:31.223

在此函数退出递归后，它将打印一堆节点。之后，在标准输出中添加一个换行符。所以是的，在外面。

# objective-c - 如果应用程序必须与 mac os x 10.5 及更高版本兼容，我可以不使用 ARC 吗？

> ID：14677689
> 
> 赞同：-1
> 
> 时间：2013-02-03T21:49:06.297
> 
> 标签：objective-c, cocoa

> **可能重复：**
> [如何在启用 ARC 的情况下部署到 Snow Leopard](https://stackoverflow.com/questions/7696201/how-to-deploy-to-snow-leopard-with-arc-enabled)

引用 Hillegas Book on Cocoa Programming for Max OS X 的内存管理章节

在 Mac OS 10.7 和 iOS 5 中引入的新解决方案是自动引用计数，通常称为 ARC。ARC 依赖于原始的保留计数机制，但有一个转折：编译器为您管理保留计数的簿记。

我正在编写一个必须与 10.5 及更高版本兼容的 Max OS X 应用程序，直到 10.8。因此，基于上述内容，我的理解是，如果 ARC 在 10.7 中引入，这是否意味着如果我在 ARC 的 10.7 平台上构建我的应用程序，该应用程序将无法在 10.5 和 10.6 上运行？因为 ARC 功能是在 10.7 中引入的

如果应用程序必须与 10.5/6/7/8 兼容，我应该使用什么内存管理

还有一点可能很重要，我的后端主要是 C++（我知道我必须自己管理 C++ 内存，而不是依赖于 ARC）和 Objective-C 的前端

我的开发平台是 10.7 Lion / Xcode 4.3

请高人指点一下。

**编辑** 从评论中我了解到 ARC 也依赖于运行时支持，这基本上意味着它不适合我的情况。无论如何，10.5也不支持它，所以我应该进行手动内存管理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:24:05.260

我会选择MRR。

ARC 的任何部分在 10.6 之前的 OS X 版本上不可用。清零弱引用需要 10.7。

[在此处](https://developer.apple.com/library/mac/releasenotes/ObjectiveC/ObjCAvailabilityIndex/)查看 Apple ARC 可用性矩阵。

> The Snow Leopard version of Xcode 4.2 doesn’t support ARC at all on OS X, because it doesn’t include the 10.7 SDK. Xcode 4.2 for Snow Leopard does support ARC for iOS though, and Xcode 4.2 for Lion supports both OS X and iOS. This means you need a Lion system to build an ARC application that runs on Snow Leopard.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:51:17.047

ARC 是一个 SDK 功能，只要您使用 10.7+ SDK 进行编译，大多数功能都可以在较旧的操作系统上使用。

相关：[如何在启用 ARC 的情况下部署到 Snow Leopard](https://stackoverflow.com/questions/7696201/how-to-deploy-to-snow-leopard-with-arc-enabled)

> 虽然可以使用 ARC 构建在 Mac OS X 10.6 和 iOS 4 上运行的程序，但在这些操作系统上无法使用归零弱引用。所有弱引用都必须在这里 __unsafe_unretained。因为非归零弱引用非常危险，所以在我看来，这种限制显着降低了 ARC 在这些操作系统上的吸引力。

哦，仅在 10.6 及更高版本上。不支持豹。

# backbone.js - 骨干模型 - 在运行时提取名称

> ID：14677693
> 
> 赞同：1
> 
> 时间：2013-02-03T21:49:18.083
> 
> 标签：backbone.js, coffeescript, hamlc

我需要能够在运行时从主干视图中提取主干模型的名称，以编写通用视图，然后编写模板代码。也就是说：我需要从传递给视图的模型中获取“ClassName”，然后从中获取前三个字符并将其传递给模板。

有没有简单的方法来做到这一点？

谢谢。

巴拉特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:57:36.473

By `ClassName`，您是指您引用模型的名称，例如`User`in `new User();`？

如果是这样，不幸的是这是不可能的，因为你给模型类的名字只是一个变量名，而不是模型声明的一部分。考虑：

```
var Foo = Backbone.Model.extend({});
var Bar = Foo; 
```

是`ClassName` `Foo`或`Bar`？

相反，只需给每个模型一个`name`属性：

```
var Foo = Backbone.Model.extend({
  name:"Foo"
}); 
```

通过这种方式，您可以通过`modelInstance.name`或轻松获取模型名称`ModelClass.prototype.name`。

# java - 如何在 REST 中实现粗粒度乐观锁？

> ID：14677696
> 
> 赞同：8
> 
> 时间：2013-02-03T21:49:25.970
> 
> 标签：java, rest, optimistic-locking

我通过将 GET 中的版本号传回给 PUT 调用，为我的 REST 资源实现了乐观锁定，这些资源具有与数据库表的一对一映射。如果在我执行 GET 和 PUT 之间数据库中的版本号发生了变化，那么就发生了乐观锁异常。很简单的设计。

现在，我如何对映射到多个数据库表的复合 REST 资源执行相同的操作？我不想传回多个版本字段（一个用于与复合资源相关的每个数据表）。复合资源的一个简单示例是 /FooBar，其中 /Foo 和 /Bar 是非复合资源。

我基本上是在寻找 Fowler 粗粒度锁定模式的 REST 实现示例：[http ://martinfowler.com/eaaCatalog/coarseGrainedLock.html](http://martinfowler.com/eaaCatalog/coarseGrainedLock.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T15:50:33.447

这就是[ETag 标头](http://en.wikipedia.org/wiki/HTTP_ETag)的设计目的。实现它的一种非常常见的方法是生成响应负载，对其进行哈希处理（它不必是安全的，只是低冲突），然后使用该哈希作为 ETag 的值。请注意，这种方法不知道有多少来源参与产生响应。

然后，客户端将收到的[ETag](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-p4-conditional-21#section-2.3)在[If-Match](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-p4-conditional-21#section-3.1)标头中发回，服务器可以使用该标头检查请求的新鲜度。

# file - 如何隐藏ftp连接信息

> ID：14677697
> 
> 赞同：0
> 
> 时间：2013-02-03T21:49:28.143
> 
> 标签：file, ftp, operating-system, client-server

在 Windows 操作系统中，我们可以使用文件中的 ftp 命令作为 ftp.exe 的参数，如下所示：

```
ftp -s:filename 
```

参数文件名可以包含密码、用户名……和其他明显的命令。

是否有替代方法或任何其他 ftp 工具可以接受加密的参数文件。（至少对用户名和密码进行加密）以隐藏客户端的连接信息。

* * *

现在我将在代码中生成临时参数文件名（纯文本），然后执行 ftp -s:filename 最后删除文件名。

但是有什么工具可以接受加密的连接预设文件吗？

# jquery - jQuery：如何使隐藏的 div 从右上角显示

> ID：14677702
> 
> 赞同：2
> 
> 时间：2013-02-03T21:49:51.730
> 
> 标签：jquery, drop-down-menu, offset

请检查这个 jsfiddle，当我单击标记锚时，我希望标记菜单（div）出现在锚元素旁边，但从右上而不是左上，我尝试过使用偏移量，但我没有到目前为止成功。

这是代码：

HTML：

```
 <div id="tag-menu"></div>
 <span class="edit-tags-wrapper" style="float:right;">
   <a rel="tag" title="show questions tagged 'jquery'" class="post-tag" href="#">jquery</a>
<a rel="tag" title="show questions tagged 'animation'" class="post-tag" href="#">animation</a>
<a rel="tag" title="show questions tagged 'tags'" class="post-tag" href="#">tags</a>
<a rel="tag" title="" class="post-tag" href="#">stackoverflow</a> 
```

JS：

```
 $('a.post-tag').click(function(){
  var $this = $(this);
  var offset = $this.offset(); 
  var myPos = {X:offset.left, Y:offset.top+26}; 
  $('#tag-menu').css({left:myPos.X, top:myPos.Y, width:300, height:200}).toggle();
}); 
```

CSS：

```
 .post-tag{
     background:#e0eaf1;
     border-right:1px solid #3E6D8E;
     border-bottom:1px solid #3E6D8E;
     padding:2px 5px;
     color:#4a6b82;
    }
    .post-tag{
     text-decoration:none;
    }

    .post-tag:hover{
     background:#3E6D8E;
     color:#fff;
    }

    #tag-menu{
     background:#666;
     position:absolute;
     display:none;
     box-shadow:0 2px 3px #000;
     border-radius:5px;
    } 
```

或者您可以签出 JSFIDDLE 来运行它：

[http://jsfiddle.net/EBergman/xfVaT/](http://jsfiddle.net/EBergman/xfVaT/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:59:28.203

`**[LIVE DEMO](http://jsfiddle.net/xfVaT/3/)**`

```
$('a.post-tag').click(function(){

  var $this = $(this);
  var offset = $this.offset();
  var thisW = $(this).outerWidth(); 
  var myPos = {X:offset.left+thisW-300, Y:offset.top+26}; 
  $('#tag-menu').css({left:myPos.X, top:myPos.Y, width:300, height:200}).toggle();
}); 
```

您需要考虑菜单宽度和按钮`outerWidth()`，只需执行以下操作即可使其工作：`X:offset.left + thisW - 300`

快乐编码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:54:31.517

**更新**

用于`$(window).width()`了解屏幕尺寸

[http://jsfiddle.net/xfVaT/4/](http://jsfiddle.net/xfVaT/4/)

```
$('a.post-tag').click(function(){
  var $this = $(this);
  var offset = $this.offset(); 
  var menuWidth = 300;
  var menuHeight = 200;
  var myPos = {X:$(window).width() - menuWidth, Y:offset.top+26}; 
  $('#tag-menu').css({left:myPos.X, top:myPos.Y, width:menuWidth, height:menuHeight}).toggle();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T22:02:02.690

您专门修复了左侧的#tag-menu。

```
$('#tag-menu').css({left:myPos.X, top:myPos.Y, width:300, height:200}).toggle(); 
```

如何正确修复它？

```
$('#tag-menu').css({right:myPos.X+300, top:myPos.Y, width:300, height:200}).toggle(); 
```

# cilk - 在 cilk 中使用结构时出现语法错误

> ID：14677708
> 
> 赞同：1
> 
> 时间：2013-02-03T21:50:41.120
> 
> 标签：cilk

在尝试编译我的 cilk 程序时，我遇到了一个奇怪的语法错误。也许我错过了一些基本的东西，那就是 cilk 的怪癖。每当我使用结构（如下面的代码）时，程序都会产生语法错误。当我取出cilk关键字并正常编译+运行程序时，不会出现此错误。

其他一些可能会提供一些见解的注释是，如果我不尝试分配给结构中的任何变量（如大小），它编译得很好，错误总是显示在结构行下方的行号，但它那个特定的行是什么并不重要，正如我之前提到的，当结构方面被取出时，它编译得很好。

```
typedef struct StackStruct{
        int size;
        Link *head;
        Link *tail;
        Link *prev;
} Stack;

cilk void Iter_tsp(Tour *tour){
        Stack *my_stack = (Stack *)malloc(sizeof(Stack));
        my_stack->size = 1;
        ....
} 
```

# azure - 了解如何在 Azure 中为角色中的应用提供服务

> ID：14677714
> 
> 赞同：1
> 
> 时间：2013-02-03T21:51:17.743
> 
> 标签：azure, azure-web-roles, azure-worker-roles

我工作的公司正在寻求开发一些针对云的应用程序。

*   托管在 Azure Web 角色中的 ASP.NET Web Api 应用程序。
*   托管在 Azure 辅助角色中的 Windows Server 类型的应用程序。

我们对 Web 或云开发完全陌生，想了解以下内容：

在为消费者提供服务时，是否为所有人提供相同的应用程序实例，是每个请求一个，还是创建多个角色并将其提供给消费者？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:34:48.453

> 向消费者提供服务时，是否向所有人提供相同的应用程序实例？

这取决于您要求 Azure 在多少个实例上运行您的应用程序。如果您只部署到 1 个实例，那么它当然是响应所有请求的同一个实例。但是，如果您部署到多个实例，请求将被负载平衡，这意味着您无法保证来自同一用户的多个请求将由同一实例处理。

当您问这个问题时，可能是因为您可能想在运行实例的机器上存储本地数据。但是，这不是一个好主意。Windows Azure 可以随时拆除您的实例并在完全不同的机器上启动您的应用程序。他们称之为“修复”，因为它通常是因为 Windows Azure 试图提供帮助并避免任何可能意味着您的实例停机的潜在问题。但是，如果您的机器由于某种原因锁定或发生其他不好的事情，也会发生这种情况。这个修复过程意味着不属于您的部署包的任何内容都将丢失。因此，例如，如果您正在登录到磁盘上的文件，那么如果 Azure “修复”您的实例，该日志将会丢失。

> 是每个请求一个，还是创建多个角色并提供给消费者？

我不完全确定你在这里的意思，所以我会猜测并冒险错误地解释你的问题。我的猜测是您在询问每个用户请求是否会有一个实例。不，只有您决定的实例数量。请记住，您必须为每个正在运行的实例付费，因此运行的实例数量由您决定是公平的。

当您将应用程序打包并准备好部署到 Windows Azure 时，您可以决定要运行的每个角色的实例数。您在部署包中设置此数量，以便在部署包时，Azure 将自动启动请求数量的实例。但是，您可以在部署后即时更改每个角色的运行实例数。这使您可以在几分钟内扩展更多实例。

我希望这会有所帮助，并且我正确理解了您的问题。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:15:23.550

Azure 云服务中的 Azure Web 和 Worker 角色至少部署在一个实例（托管 VM）上。Azure 允许您调整大小（内存、CPU）和缩放（实例数量）。Azure 实际上允许您动态扩展，即按需添加更多实例。您按小时为部署的实例的大小和数量付费。

例如，一个云服务可以有一个工作者角色（后台处理）实例和多个 Web 角色实例。多个实例在负载均衡器后面处理，客户端不知道它们正在使用什么实例（所有实例都是平等创建的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T08:09:39.603

Azure 角色实例是具有某些特定负载的 VM。

例如，在您的服务中，您声明需要三个“前端”Web 角色实例和两个“后端”工作者角色实例。当 Azure 部署您的服务时，它会启动五个 VM，其中三个将运行“前端”有效负载并启动 IIS，其中两个将运行“后端”有效负载并且没有启动 IIS。

现在，除非您要求 Azure 更改该配置，否则无论收到什么请求和发生什么负载，它都会保持不变。您有五个具有 3+2 配置的 VM。要更改配置，您需要采取一些措施。

有两种方法可以更改配置。您可以使用管理门户或外部程序来更改其中一个或两个角色的“实例计数”。您还可以添加自动缩放代码，这些代码将收集指标并发出 Management API 请求以更改“实例计数”。无论哪种方式，当“实例计数”上升时，Azure 会启动更多具有相同负载的 VM，而当它下降时，它会停止一些 VM。

# rsa - 在 .NET 或 BouncyCastle 中确定证书密钥类型（RSA 与 EC）？

> ID：14677715
> 
> 赞同：1
> 
> 时间：2013-02-03T21:51:28.050
> 
> 标签：rsa, bouncycastle, elliptic-curve

目前我们有一个例程，它在给定证书（并且它是私钥）的情况下对字节 [] 进行签名。但是，证书/密钥的类型被硬编码为“带有 RSA 密钥的证书”。该代码是：

```
public byte[] Sign(byte[] bytesToSign, bool fOAEP, X509Certificate2 certificate)
{
    using (RSACryptoServiceProvider provider = new RSACryptoServiceProvider())
    {
        // HACK: Round-trip the key to XML and back, to get provider type working
        // as 'Microsoft Enhanced RSA and AES Cryptographic Provider' (for  
        // SHA256/SHA512 signing hash) instead of 'Microsoft Enhanced 
        // Cryptographic Provider v1.0' (that limits us to SHA1)
        string publicKeyXml = certificate.PrivateKey.ToXmlString(true);
        provider.FromXmlString(publicKeyXml);

        // We use the private key to sign.
        return provider.SignData(bytesToSign, CryptoConfig.MapNameToOID("SHA512"));
    }
} 
```

我们想让它更加灵活，如果证书使用 RSA 密钥，我们以一种方式处理它，但如果它使用 EC 密钥，那么我们以不同的方式处理它。基本上，加密服务提供者类型将是不同的类型。

所以核心问题是：

*   给定带有公钥+私钥的证书（用于签名）或仅带有公钥的证书（用于验证），您如何确定证书使用的密钥类型？

我对标准 .NET 库甚至 BouncyCastle.Org 库持开放态度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T08:51:45.443

您可以通过 certificate.PublicKey.Oid 检查密钥类型（算法）。在这里您可以看到 Microsoft OID 支持：http: [//msdn.microsoft.com/en-us/library/ff635835.aspx](http://msdn.microsoft.com/en-us/library/ff635835.aspx) 其他 OID 可以在 oid-info.com 查看

# android - 处理一个被推送到前台的 Activity

> ID：14677718
> 
> 赞同：0
> 
> 时间：2013-02-03T21:51:41.510
> 
> 标签：android, android-activity

> **可能重复：**
> [监听 ActivityManager 事件？](https://stackoverflow.com/questions/2272168/listen-to-activitymanager-events)

是否可以立即知道（不是通过间隔列出/迭代后台服务中的进程）哪个应用程序（以及哪个活动）已被推到前面，也许使用某种广播信息？我想在全球范围内了解哪个应用程序被推到了最前面，而不仅仅是我的应用程序中的活动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:57:18.313

看起来不可能，至少在不修改 Android 源代码的情况下是不可能的。看一下源码[`ApplicationsProvider`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/4.0.1_r1/com/android/providers/applications/ApplicationsProvider.java)。

这是一个类似的问题：[Listen to ActivityManager events?](https://stackoverflow.com/questions/2272168/listen-to-activitymanager-events)

# perl - perl eval 没有捕捉到错误

> ID：14677720
> 
> 赞同：2
> 
> 时间：2013-02-03T21:51:44.237
> 
> 标签：perl, exception, try-catch, eval

'eval' 块捕获 'die' 尝试。但在下面的代码中，它未能捕获“未初始化值”异常。

perl 代码 -

```
#!/usr/bin/perl
package poc::template;

use strict;
use warnings;
use Log::Log4perl;

my $log_conf = "../conf/log4perl.conf";
Log::Log4perl::init($log_conf);
my $logger = Log::Log4perl->get_logger();

sub doSome {
    $logger->info('doing something');
    my $add = $ARGV[0] + 4;
}

#main
$logger->info('start');
eval { doSome(); };
if ($@) {
    $logger->info('error');
}
$logger->info('stop'); 
```

这是日志配置-

```
log4perl.rootLogger              = DEBUG, SCREEN
log4perl.appender.SCREEN         = Log::Log4perl::Appender::Screen
log4perl.appender.SCREEN.stderr  = 0
log4perl.appender.SCREEN.layout  = Log::Log4perl::Layout::PatternLayout
log4perl.appender.SCREEN.layout.ConversionPattern = %d [%M:%L] %p  %F{2} - %m%n 
```

这是脚本输出 -

```
2013/02/03 16:47:02 [main:::18] INFO  template\POCTemplate.pl - start
Use of uninitialized value $ARGV[0] in addition (+) at /POCPerl/template/POCTemplate.pl line 14.
2013/02/03 16:47:02 [poc::template::doSome:13] INFO  template\POCTemplate.pl - doing something
2013/02/03 16:47:02 [main:::23] INFO  template\POCTemplate.pl - stop 
```

这个 eval 块不应该捕获那个异常吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T21:53:03.227

不，这是一个警告，而不是例外。

你可以这样做：

```
use warnings 'FATAL' => 'all'; 
```

使所有 perl 生成的警告异常（在给定的词法范围内）。

# php - 如何使用 XPath 获取这些值

> ID：14677722
> 
> 赞同：3
> 
> 时间：2013-02-03T21:51:50.120
> 
> 标签：php, xpath

**HTML**

```
<table id='dg' border='0'  class="Table">
  <tr>
    <td class='text'>id.</td>
    <td class='text'>file</td>
    <td class='text'>alt</td>
  </tr>
  <tr>
    <td class='text'><input name='somename[]' type='hidden' value='1234'>
      1</td>
    <td class='text'><a href='#' onClick="javascript:openPopWindow('../../somefile.jpg');" ><img src='cms_thumb.php?imgsrc=somefile2.jpg' border='0' ></a></td>
    <td class='text'><input type='text' name='title[]' value='Value 1'></td>
  </tr>
  <tr>
    <td class='text'><input name='somename[]2' type='hidden' value='2345'>
      2</td>
    <td class='text'><a href='#' onClick="javascript:openPopWindow('../../somefile2.jpg');" ><img src='thumb.php?imgsrc=somefile2.jpg' border='0' ></a></td>
    <td class='text'><input type='text' name='title[]' value='Value 2'></td>
  </tr>
</table> 
```

**客观的**

需要获取 img src 文件名并获取 name=title[] 的输入字段的值

**到目前为止我有什么**

```
$dom = new DOMDocument;
$dom->loadHTML($html);
$xpath = new DOMXpath($dom);

foreach ($dom->getElementsByTagName('tr') as $node) { 
    $img = $xpath->query('//img')->item(0); 
    $img = str_replace("\'","",$img->getAttribute('src'));
    $img = str_replace("cms_thumb.php?imgsrc=","",$img);
    echo $img.'<br>';
} 
```

$img 只包含第一张图片而不是其他图片

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:05:53.103

将 context 参数[`DOMXPath::query()`](http://php.net/manual/en/domxpath.query.php)与相对查询一起使用并检查 img 和 input 元素是否存在（在您的第一个表行中不是这种情况）：

```
$dom = new DOMDocument;
$dom->loadHTML($html);
$xpath = new DOMXpath($dom);

foreach ($dom->getElementsByTagName('tr') as $node) { 
    $img = $xpath->query('.//img', $node)->item(0);
    $input = $xpath->query('.//input[@name="title[]"]', $node)->item(0);
    if ($img && $input) {
        echo $img->getAttribute('src'), ' - ';
        echo $input->getAttribute('value'), '<br>';
    }
} 
```

这将搜索每个表格行中任意位置的第一个元素`<img>`和元素。`<input name="title[]">`如果表结构总是如上所示，您可以使用更明确的 XPath 优化脚本：

```
$dom = new DOMDocument;
$dom->loadHTML($html);
$xpath = new DOMXpath($dom);

$table = $dom->getElementById('dg');
$images = $xpath->query('tr/td/a/img', $table);
$inputs = $xpath->query('tr/td/input[@name="title[]"]', $table); 
```

要获取属性，请并行迭代`$images`，`$inputs`例如使用[`MultipleIterator`](http://php.net/MultipleIterator)：

```
$iterator = new MultipleIterator();
$iterator->attachIterator(new IteratorIterator($images));
$iterator->attachIterator(new IteratorIterator($inputs));
foreach ($iterator as $items) {
    $src = $items[0]->getAttribute('src');
    $value = $items[1]->getAttribute('value');
    echo $src, ' - ', $value, '<br>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:19:38.790

尝试：

```
$html = <<<HTML
<table id='dg' border='0'  class="Table">
  <tr>
    <td class='text'>id.</td>
    <td class='text'>file</td>
    <td class='text'>alt</td>
  </tr>
  <tr>
    <td class='text'><input name='somename[]' type='hidden' value='1234'>
      1</td>
    <td class='text'><a href='#' onClick="javascript:openPopWindow('../../somefile.jpg');" ><img src='cms_thumb.php?imgsrc=somefile2.jpg' border='0' ></a></td>
    <td class='text'><input type='text' name='title[]' value='Value 1'></td>
  </tr>
  <tr>
    <td class='text'><input name='somename[]2' type='hidden' value='2345'>
      2</td>
    <td class='text'><a href='#' onClick="javascript:openPopWindow('../../somefile2.jpg');" ><img src='thumb.php?imgsrc=somefile2.jpg' border='0' ></a></td>
    <td class='text'><input type='text' name='title[]' value='Value 2'></td>
  </tr>
</table>
HTML;

$doc = new DOMDocument();
$doc->loadHTML($html);

foreach($doc->getElementsByTagName("td") as $td){
    foreach($td->getElementsByTagName("img") as $img){
        $arr_img[] = array(
            "img" => $img->getAttribute("src"),
        );
    }
    foreach($td->getElementsByTagName("input") as $name){
        if ($name->getAttribute("name")==="title[]"){
            $arr_value[] = array(
                "value" => $name->getAttribute("value")
            );
        }
    }
}

var_dump($arr_img); // In this array will be img src's
var_dump($arr_value); // In this array will be values of input elements which name equal to title[] 
```

`var_dump`输出将是 =>

```
array(2) {
  [0]=>
  array(1) {
    ["img"]=>
    string(34) "cms_thumb.php?imgsrc=somefile2.jpg"
  }
  [1]=>
  array(1) {
    ["img"]=>
    string(30) "thumb.php?imgsrc=somefile2.jpg"
  }
}

array(2) {
  [0]=>
  array(1) {
    ["value"]=>
    string(7) "Value 1"
  }
  [1]=>
  array(1) {
    ["value"]=>
    string(7) "Value 2"
  }
} 
```

# ruby-on-rails - 圆日期到 Ruby 十年的第一年

> ID：14677724
> 
> 赞同：1
> 
> 时间：2013-02-03T21:51:51.283
> 
> 标签：ruby-on-rails, ruby, date

在 Rails 中，我有一个保存在实例变量中的日期。我需要抓住它之前十年的开始。如果 `@date.year= 1968`那时我需要返回`1960`。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T21:54:37.960

您可以通过多种方式做到这一点。如建议的那样，您始终可以使用整数除法来除数并截断余数。所以`1968/10`返回`196`，如果你乘以它`10`，它会给你`1960`。或者简单地说，

```
@date.year = @date.year/10 * 10
@date.year 
=> 1960 
```

我更喜欢使用模运算的方法。如果你这样做`@date.year % 10`，如果你除以它会返回余数，`10`然后你可以像这样从年份中减去：

```
@date.year = @date.year - (@date.year % 10)
@date.year 
=> 1960 
```

我更喜欢后者的原因是因为整数除法截断余数对于查看您的代码的每个人来说可能不是显而易见的事情。但是，模算术在所有编程语言中的工作方式通常相同。

请记住，如果您尝试更改日期，则需要使用适当的[方法](http://api.rubyonrails.org/classes/Date.html#method-i-change)。

```
@date.change(:year => 1960) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T21:54:46.707

只需除以和乘以整数：试试`@date.year/10*10`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T21:54:34.563

将整数除以 10，然后乘以 10。

```
1.9.3-p286 :001 > 1855/10
 => 185 
1.9.3-p286 :002 > 185 * 10
 => 1850 
```

这有效的原因（在 Ruby 和 C/C++、Python 以及可能的许多其他语言中）是整数除法总是会截断余数。但是，如果您要除以浮点，则情况并非如此。

# .htaccess - 为特定文件或 url 设置过期标头

> ID：14677728
> 
> 赞同：4
> 
> 时间：2013-02-03T21:52:11.650
> 
> 标签：.htaccess

我的网站上有一些 vimeo 和 youtube 视频，为 css 文件生成了很多 http 请求。

具体到：

```
http://a.vimeocdn.com/p/1.4.28/css/player.core.opt.css 
```

和

```
http://s.ytimg.com/yts/cssbin/www-embed-vflOkLJfy.css 
```

我想为这些文件创建过期标题，但不是我的所有 CSS。（所以 ExpiresByType text/css “access plus 1 week” 不是我要找的）

这可能吗？如何？

# java - 由于 org.xml.sax.SAXParseException 导致错误

> ID：14677734
> 
> 赞同：2
> 
> 时间：2013-02-03T21:52:43.380
> 
> 标签：java, android, xml, ant

我有这个问题：

这是我的 AndroidManifest.xml （这是我在看到错误之前编辑的唯一文件）：

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest android:versionCode="2"
          android:versionName="1.1"
          package="it.ptia.appsender"
          xmlns:android="http://schemas.android.com/apk/res/android">
    <uses-permission android:name="android.permission.WRITE_MEDIA_STORAGE"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
  <uses-sdk android:minSdkVersion="3"
            android:targetSdkVersion="14" />
  <supports-screens android:largeScreens="true"
                    android:normalScreens="true"
                    android:smallScreens="false" />
  <application android:icon="@drawable/share_blue"
               android:label="Condividi app">

      <meta-data android:name="android.app.default_searchable" android:value=".SearchableActivity" /> 
    <activity android:label="Condividi app"
              android:name=".Launchalot">
      <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
      </intent-filter>
    </activity>
      <activity android:label="Condividi app" android:name=".SearchableActivity" > 
                <intent-filter >
                       <action android:name="android.intent.action.VIEW" />
                    </intent-filter> 
                <meta-data
                       android:name="android.app.searchable"
                       android:resource="@xml/searchable" /> 
             </activity> 
    </application>
    </manifest> 
```

这是 ant debug (linux) 错误。我正在使用linux ubuntu，我以前从未见过它。：

```
 [gettype] [Fatal Error] :26:5: Element type "activity" must be followed by either attribute specifications, ">" or "/>".

BUILD FAILED
/home/edoardo/Script/android-sdk-linux/tools/ant/build.xml:388: org.xml.sax.SAXParseException; lineNumber: 26; columnNumber: 5; Element type "activity" must be followed by either attribute specifications, ">" or "/>".
    at org.apache.xerces.parsers.DOMParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.DocumentBuilderImpl.parse(Unknown Source)
    at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:463)
    at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:510)
    at com.android.ant.GetTypeTask.execute(GetTypeTask.java:85)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:390)
    at org.apache.tools.ant.Target.performTasks(Target.java:411)
    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
    at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
    at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
    at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
    at org.apache.tools.ant.Main.runBuild(Main.java:809)
    at org.apache.tools.ant.Main.startAnt(Main.java:217)
    at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
    at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)
--------------- linked to ------------------
javax.xml.xpath.XPathExpressionException
    at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:468)
    at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:510)
    at com.android.ant.GetTypeTask.execute(GetTypeTask.java:85)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:390)
    at org.apache.tools.ant.Target.performTasks(Target.java:411)
    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
    at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
    at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
    at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
    at org.apache.tools.ant.Main.runBuild(Main.java:809)
    at org.apache.tools.ant.Main.startAnt(Main.java:217)
    at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
    at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)
Caused by: org.xml.sax.SAXParseException; lineNumber: 26; columnNumber: 5; Element type "activity" must be followed by either attribute specifications, ">" or "/>".
    at org.apache.xerces.parsers.DOMParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.DocumentBuilderImpl.parse(Unknown Source)
    at com.sun.org.apache.xpath.internal.jaxp.XPathImpl.evaluate(XPathImpl.java:463)
    ... 18 more 
```

问题是什么？

# iphone - Apple 推送通知 - 从开发人员变为生产。做什么？

> ID：14677736
> 
> 赞同：0
> 
> 时间：2013-02-03T21:52:57.387
> 
> 标签：iphone, xcode, push

本周我会将我的应用程序提交到 Appstore。我已经用我的开发者证书在多台设备上测试了推送通知服务。一切正常。

那么接下来的步骤是什么？

1.  生成分发配置文件并下载到 xcode。
2.  下载 Production-Push-Certificate 并生成 pem 文件。
3.  使用 gateway.push.apple.com
4.  ?

非常感谢！克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T01:35:03.587

生成您的生产推送证书，然后生成您的分发配置文件。当您想向生产用户发送推送通知时，请使用生产证书将 JSON 有效负载发送到 gateway.push.apple.com。

# c# - 获取联系人缩略图

> ID：14677744
> 
> 赞同：3
> 
> 时间：2013-02-03T21:53:37.423
> 
> 标签：c#, windows-8

当我使用 Live Client Auth sdk 时，我可以获得当前登录用户的缩略图的 url。如何获得用户联系人的等效缩略图？

我知道`contact`返回的`new ContactPicker().PickSingleContactAsync()`有一个`GetThumbnailAsync`方法，但它返回一个位图，我宁愿只使用 url。那可能吗？有没有办法获取任意电子邮件的个人资料图片？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T20:04:54.390

> 我知道 new ContactPicker().PickSingleContactAsync() 返回的联系人有一个 GetThumbnailAsync 方法，但它返回一个位图，我宁愿只使用 url。那可能吗？

否。请参阅文档[http://msdn.microsoft.com/en-us/library/windows/apps/br224875.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/br224875.aspx)

> 有没有办法获取任意电子邮件的个人资料图片？

其他人似乎已经解决了这个问题。[在https://stackoverflow.com/a/12082001/2012977](https://stackoverflow.com/a/12082001/2012977)检查答案

# android - android - 使用 setX、setPadding 或补间动画滑动 ListView？

> ID：14677757
> 
> 赞同：5
> 
> 时间：2013-02-03T21:54:48.757
> 
> 标签：android, listview, android-animation, slide, tween

在不涉及太多细节的情况下，我希望能够以`ListView`类似于 GMail 中的“滑动存档”功能的方式“滑动”元素。我对 onTouchListener 和所有这些都很好，我的问题是关于幻灯片动画。

首先想到的两件事是..

```
view.setPadding(slideOffset, 0, 0, 0); 
```

和..

```
view.setX(slideOffset); 
```

前者*非常*黄油，即使在模拟器上也是如此。
后者在我的 Galaxy Nexus 上有点笨拙。

**我的问题：**
*无论我尝试了什么，正确的方法是什么？
为什么`setX`不那么光滑`setPadding`？
一种方法是否比另一种更符合 Android 最佳实践？
补间翻译动画是一种选择吗？如果是这样，你能提供一个简短的例子来指出我正确的方向吗？

**编辑：**
为了清楚起见，我附上了我试图模仿的效果的图像。

![在此处输入图像描述](../Images/b5bace3c2e078349ba3248d09ae739cf.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-17T13:16:49.610

查看 AndroidDev 上发布的[3](https://www.youtube.com/playlist?list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0)个[devBytes](https://www.youtube.com/user/androiddevelopers)：

*   [https://www.youtube.com/watch?v=8MIfSxgsHIs&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=12](https://www.youtube.com/watch?v=8MIfSxgsHIs&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=12)
*   [https://www.youtube.com/watch?v=NewCSg2JKLk&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=11](https://www.youtube.com/watch?v=NewCSg2JKLk&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=11)
*   [https://www.youtube.com/watch?v=NewCSg2JKLk&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=11](https://www.youtube.com/watch?v=NewCSg2JKLk&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=11)
*   [https://www.youtube.com/watch?v=YCHNAi9kJI4&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=4](https://www.youtube.com/watch?v=YCHNAi9kJI4&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=4)
*   [https://www.youtube.com/watch?v=PeuVuoa13S8&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=3](https://www.youtube.com/watch?v=PeuVuoa13S8&list=PLWz5rJ2EKKc_XOgcRukSoKKjewFJZrKV0&index=3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T01:37:55.217

我很确定 setX() 速度较慢，因为它会影响其父母。更改视图的 X 时，每次更新值时都会调用父级的 onLayout/onMeasure。那是因为child的X值可能会导致parent上的其他item移动，所以parent需要自己重绘。

您可以通过扩展 ViewGroup 并在这些方法上写入日志来轻松测试这一点。然后，您可以使用两种方法，填充与 setX，看看会发生什么。

您是否要为项目设置动画？还是您希望用户像在 Gmail 上一样移动它？您可以使用 ObjectAnimator 来处理项目的“X”值。结合您的项目的“硬件层”，它将创造更流畅的体验。您可以在此处找到有关如何执行此操作的更多详细信息：http: [//developer.android.com/guide/topics/graphics/hardware-accel.html](http://developer.android.com/guide/topics/graphics/hardware-accel.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T01:43:33.617

是的，如果你的目标是更高的 API，ViewPropertyAnimator 可能是一个很好的解决方案。如果您必须支持较低的 API，我对实现的思考过程将是（我自己并没有亲自实现，但这应该对性能有好处）：

1.  在您的触摸处理程序中，一旦您确定用户正在“滑动”，请将 View 的可见性设置为 INVISIBLE，并将绘图缓存存储到单独的位图中 (Bitmap bmp = myView.getDrawingCache();)

2.  在与视图相同的位置绘制该位图，并使用 Canvas translate 方法根据用户触摸点的 x 位置移动位置。

3.  用户放手后，翻译回来（最好用动画平滑），回收位图，并将视图设置回 VISIBLE。

# ios - phonegap 构建通用推送插件 - 没有有效的 aps 环境

> ID：14677760
> 
> 赞同：2
> 
> 时间：2013-02-03T21:54:59.247
> 
> 标签：ios, cordova, push-notification

我试图为我的应用程序使用通用推送。它适用于android，但在ios上我收到错误消息：没有有效的aps-environment

1.  我在苹果配置文件中添加了对推送通知的支持
2.  我在启用推送后创建并下载了配置文件
3.  我`<key>aps-environment</key>`在mobileprovision
4.  我已经在手机上安装了移动设备和应用程序
5.  我已经检查并测试了每个解决方案

我的 config.xml

```
 <?xml version="1.0" encoding="UTF-8" ?>
    <widget xmlns = "http://www.w3.org/ns/widgets"
        xmlns:gap = "http://phonegap.com/ns/1.0"
        id        = "---.-------.-----"
        versionCode="10" 
        version   = "1.1.0">

    <!-- versionCode is optional and Android only -->

    <name>PhoneGap push Example</name>

    <description>
        An example for phonegap build docs. 
    </description>

   <author href="http://-----------" email="---------------">------</author>
<access origin="*" />

<!--DEVICE FEATURES ACCESS--> 
<feature name="http://api.phonegap.com/1.0/camera"/>
<feature name="http://api.phonegap.com/1.0/file"/>
<feature name="http://api.phonegap.com/1.0/geolocation"/>
<feature name="http://api.phonegap.com/1.0/media"/>
<feature name="http://api.phonegap.com/1.0/network"/>
<feature name="http://api.phonegap.com/1.0/notification"/>

<gap:plugin name="GenericPush" /> <!-- latest release -->
</widget> 
```

我的js

```
 <script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
    <script type="text/javascript" charset="utf-8" src="jquery_1.5.2.min.js"></script>
    <script type="text/javascript" src="PushNotification.js"></script>

    <script type="text/javascript">
        var pushNotification;         
        function onDeviceReady() {
            $("#app-status-ul").append('<li>deviceready event received</li>');

            pushNotification = window.plugins.pushNotification;
            if (device.platform == 'android' || device.platform == 'Android') {
                pushNotification.register(successHandler, errorHandler, {"senderID":"661780372179","ecb":"onNotificationGCM"});
            } else {
                pushNotification.register(tokenHandler, errorHandler, {"badge":"true","sound":"true","alert":"true","ecb":"onNotificationAPN"});
            }
        }

        // handle APNS notifications for iOS
        function onNotificationAPN(event) {
            if (event.alert) {
                $("#app-status-ul").append('<li>push-notification: ' + event.alert + '</li>');
                navigator.notification.alert(event.alert);
            }

            if (event.sound) {
                var snd = new Media(event.sound);
                snd.play();
            }

            if (event.badge) {
                pushNotification.setApplicationIconBadgeNumber(successHandler, event.badge);
            }
        }

        // handle GCM notifications for Android
        function onNotificationGCM(e) {
            $("#app-status-ul").append('<li>EVENT -> RECEIVED:' + e.event + '</li>');

            switch( e.event )
            {
                case 'registered':
                if ( e.regid.length > 0 )
                {
                    $("#app-status-ul").append('<li>REGISTERED -> REGID:' + e.regid + "</li>");
                    // Your GCM push server needs to know the regID before it can push to this device
                    // here is where you might want to send it the regID for later use.
                    console.log("regID = " + regID);
                }
                break;

                case 'message':
                $("#app-status-ul").append('<li>MESSAGE -> MSG: ' + e.message + '</li>');
                $("#app-status-ul").append('<li>MESSAGE -> MSGCNT: ' + e.msgcnt + '</li>');
                break;

                case 'error':
                $("#app-status-ul").append('<li>ERROR -> MSG:' + e.msg + '</li>');
                break;

                default:
                $("#app-status-ul").append('<li>EVENT -> Unknown, an event was received and we do not know what it is</li>');
                break;
            }
        }

        function tokenHandler (result) {
            $("#app-status-ul").append('<li>token: '+ result +'</li>');
            // Your iOS push server needs to know the token before it can push to this device
            // here is where you might want to send it the token for later use.
        }

        function successHandler (result) {
            $("#app-status-ul").append('<li>success:'+ result +'</li>');
        }

        function errorHandler (error) {
            $("#app-status-ul").append('<li>error:'+ error +'</li>');
        }

        document.addEventListener('deviceready', onDeviceReady, true);

     </script>

    <div id="app-status-div">
        <ul id="app-status-ul">
            <li>Cordova PushNotification Plugin Demo</li>
        </ul>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T23:29:22.360

根据 Phonegap Build 社区论坛，您需要使用分发条款证书才能进行 APS 注册：http: [//community.phonegap.com/nitobi/topics/ios_problem_with_push_notification_plugin_for_phonegap_build](http://community.phonegap.com/nitobi/topics/ios_problem_with_push_notification_plugin_for_phonegap_build)

有的人转产证后就成功了。但是，我有同样的问题，仍然无法使用生产证书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-05T13:05:57.277

经过长时间的研究和反复试验。我发现我需要使用：在 IOS（临时配置文件）和推送服务器上（生产 aps 证书和密钥）

# sql-server - 如何更正 T-SQL 语法错误？

> ID：14677762
> 
> 赞同：0
> 
> 时间：2013-02-03T21:55:04.070
> 
> 标签：sql-server, sql-server-2008

我尝试使用 SQL Server 2008 进行计算列，但在附近出现语法错误`>`：

```
Select
   *, 
   AverageCost = case Quantity 
                    when > 0 then (TotalCost / Quantity) 
                    else null 
                 end 
from ProductTable; 
```

谁能告诉我有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:57:26.690

数量必须在 then 之后

```
Select *, AverageCost = 
case when Quantity > 0 then (TotalCost / Quantity) else null end from ProductTable; 
```

# python - 在 OpenCV + Python 中计算汽车

> ID：14677763
> 
> 赞同：0
> 
> 时间：2013-02-03T21:55:05.320
> 
> 标签：python, video, image-processing, opencv, computer-vision

我遇到了这个我需要解决但我不能解决的大/简单的问题。我想做的是计算高速公路上的汽车，我实际上可以检测到移动的汽车并将边界框放在它们上面......但是当我试着数一数，我根本数不过来。我尝试创建一个变量（nCars）并在程序每次创建边界框时递增，但这似乎会递增很多次。问题是：计算移动的汽车/物体的最佳方法是什么？

PS：我不知道这是不是一个愚蠢的问题，但我要疯了....谢谢你所做的一切（：我是新来的，但我知道这个网站有一段时间了（：太棒了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T10:47:00.980

我猜您正在检测每一帧中的汽车，并在每次检测到汽车时创建一个新的边界框。这将解释变量的许多增量。

您必须找到一种方法来确定在一帧中检测到的汽车是否与前一帧中的汽车相同（如果您在前一帧中检测到汽车）。您可以通过简单地比较两帧之间的边界框距离来实现这一点；如果距离小于阈值，则可以说它与前一帧是同一辆车。这样您就可以跟踪汽车。

当检测到的汽车离开相机的视野（退出框架）时，您可以增加计数器变量。

我在这里提出的跟踪程序非常简单，尝试搜索“对象跟踪”看看你还能使用什么（也许看看 OpenCV 的 KLT 跟踪）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:30:02.423

您应该使用 sqlite 数据库来存储汽车的信息。

# c - （作业）如何将 C 字符串从一个指针放入另一个指针的内存地址？

> ID：14677772
> 
> 赞同：1
> 
> 时间：2013-02-03T21:56:01.120
> 
> 标签：c, pointers, c-strings

好的，首先我是 C 新手，并且对指针（Java 程序员）非常陌生，所以请保持温和。对于这个类，我只允许使用 Syscalls，所以没有 stdio。

该函数接收一个 C 字符串作为 void* 的输入，另一个 void* 指向我需要将其添加到的内存区域。无论出于何种原因，它都没有正确地放入新位置。

```
*(char*)ptr = (char*)data; 
```

ptr 是一个 void* 并且是我想要将字符串写入到的内存中的位置，而 data 是一个 void* 是我想要在那里写入的字符串。

如果我打印出这两个值，我会在打印 (char*) 数据时得到正确的字符串，但在打印 (char*)ptr 时我只会得到一个垃圾字符。如果我将上面的行更改为：

```
*(char*)ptr = *(char*)data; 
```

然后只有字符串的第一个字符进入内存。

我究竟做错了什么？

谢谢。

完整来源：

```
#include <stdlib.h>
#include <unistd.h>

#define F_first         1 //First call to function, allocate amount of memory specified by data
#define F_last          2 //last call to function, free memory area
#define F_data_int      3 //void* arg points to integer data
#define F_data_char     4 //void* arg points to character string
#define F_data_float    5 //void* arg points to float data
#define F_print         6 //print the accumulated values in memory

#define Ptr_offset      32 //the amount of extra data I'm setting aside to store info about how much total data is allocated and how much of that area is being used

void* f( int code, void* mem, void* data )
{
    size_t totalSize = 500;
    size_t dataSize = 0;
    size_t availableSize = 0;
    size_t neededSize = 0;
    void* ptr;

    if( code == F_first )
    {

        if( mem != NULL )
        {
            exit(1);
        }

        if( data != NULL )
        {
            totalSize = (size_t)data + Ptr_offset;
            mem = malloc( totalSize );

        }else{
            totalSize += Ptr_offset;
            mem = malloc( totalSize );
        }

        dataSize = 0;
    }
    else if( code == F_last )
    {
        if( mem == NULL )
        {
            exit(1);
        }
        else
        {
            free( mem );
        }

    }
    else if( code == F_data_int )
    {
        dataSize = *(int*)(mem + (Ptr_offset/2));
        totalSize = *(int*)mem;
        availableSize = totalSize - dataSize;
        neededSize = sizeof(*(int*)data);

        if( neededSize >= availableSize )
        {
            totalSize = neededSize * 2;
            mem = realloc(mem, totalSize);
        }

        ptr = mem + Ptr_offset + dataSize;
        *(int*)ptr = *(int*)data;

        ptr = mem + Ptr_offset/2;
        *(int*)ptr = dataSize+sizeof(*(int*)data);

    }
    else if( code == F_data_char )
    {
        dataSize = *(int*)(mem + (Ptr_offset/2));
        totalSize = *(int*)mem;
        availableSize = totalSize - dataSize;
        neededSize = sizeof(*(char*)data);

        if( neededSize >= availableSize )
        {
            totalSize = neededSize * 2;
            mem = realloc(mem, totalSize);
        }

        ptr = mem + Ptr_offset + dataSize;
        strcpy(ptr, data);

        printf("\n chardata: %s \n charptr: %s \n", (char*)data, (char*)ptr);

        ptr = mem + Ptr_offset/2;
        *(int*)ptr = dataSize+sizeof(*(char*)data);

    }else if( code == F_data_float )
    {
        dataSize = *(int*)(mem + (Ptr_offset/2));
        totalSize = *(int*)mem;
        availableSize = totalSize - dataSize;
        neededSize = sizeof(*(float*)data);

        if( neededSize >= availableSize )
        {
            totalSize = neededSize * 2;
            mem = realloc(mem, totalSize);
        }

        ptr = mem + Ptr_offset + dataSize;
        *(float*)ptr = *(float*)data;

        ptr = mem + Ptr_offset/2;
        *(int*)ptr = dataSize+sizeof(*(float*)data);

    }else if( code == F_print )
    {
        ptr = mem + Ptr_offset/2;
        write(1, ptr, *(int*)mem);
    }

    if(mem != NULL)
    {
        *(int*)mem = totalSize;
    }

    return mem;
}

int main( void )
{
    int i_a;
    float f_a;

    void* m;
    int* i;
    float* fl;

    fl = &f_a;
    i = &i_a;

    m = f( F_first, 0, (void*)300 );
    m = f( F_data_char, m, (void*)"Systems programming class has " );

    f_a = 69.7;
    m = f( F_data_float, m, (void*)fl );
    m = f( F_data_char, m, (void*)"registered " );
    m = f( F_data_char, m, (void*)"students in a " );
    m = f( F_data_char, m, (void*)"classroom of " );

    i_a = 70;
    m = f( F_data_int, m, (void*)i );
    m = f( F_data_char, m, (void*)"\n" );

    m = f( F_print, m, 0 );

    m = f(F_last, m, 0);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:58:18.480

使用`strcpy`或其更安全的变体`strncpy`来复制字符串。您不能在 C 中分配数组。

```
strcpy(ptr, data); 
```

关于您的代码：

```
*(char*)ptr = (char*)data; 
```

这不是有效的 C，`=`运算符的左侧有 type `char`，右侧有 type `char *`。您不能将 a 分配`char *`给 a `char`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:39:24.860

如果您希望分配给在函数外部声明的对象，则需要将指针传递给该对象。这是因为被调用的函数接收到它传递的任何对象的副本，而不是实际对象。例如：

```
void incorrect(char c) { c = 42; }
void corrected(char *c) { *c = 42; }
int main(void) {
    char c = 0;
    incorrect(c); // As is demonstrated by printing the integer value of c, incorrect doesn't get the job done
    printf("c after incorrect: %d\n", c);
    corrected(&c);
    printf("c after corrected: %d\n", c);
} 
```

请注意在代码中`corrected(&c);`我如何将指针传递给我希望更改的对象。您在哪里将指针传递给您要更改的对象？

让我们扩展它以分配给一个指针：

```
void assign(char **ptr, char *newval) { *ptr = newval; }
int main(void) {
    char *ptr = NULL;
    assign(&ptr, malloc(42));
    assert(ptr != NULL); // One would assume ptr has changed.
} 
```

同样，请注意 &ptr 是指向我希望更改的对象的指针。让我们扩展它以分配给 a 指向的指针`void *`：

```
void assign(void *ptr, char *newval) { *(char **)ptr = newval; }
int main(void) {
    char *ptr = NULL;
    assign(&ptr, malloc(42));
    assert(ptr != NULL); // One would assume ptr has changed.
} 
```

ptr 丢失了它的类型信息，但我仍在传递 &ptr ，它是指向我希望更改的对象的指针。为了改变它，我需要将`void *`back 转换为 a `char **`，取消引用`char **`形成我可以分配的左值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T22:44:25.973

如果您为不同的功能创建了单独的功能，这将有所帮助，因为您现在拥有难以遵循的代码。

您不会将分配的内存初始化为 0，然后继续从中读取总数等。

用于`calloc`分配或`memset`使用 0

如果您改为创建一个描述缓冲区内存布局的结构，也会有所帮助。这样你就不需要摆弄偏移量。

例如

```
struct foo
{
  size_t totalSize;
  size_t currentSize;
  ...   
  char buf[];
};

mem = calloc( 1, sizeof( struct foo ) + bufSize); 
```

# c++ - 类不被识别？

> ID：14677773
> 
> 赞同：0
> 
> 时间：2013-02-03T21:56:02.140
> 
> 标签：c++, sfml

一个类中有一个类，它有一个 Text 的成员，但是给了我这些错误：

```
Error   1   error C2146: syntax error : missing ';' before identifier 'text'    
Error   2   error C4430: missing type specifier - int assumed. Note: C++ does not support default-int 
```

它们都在struct MenuItem 中的文本行上。

这是 Menu.h：这是 MenuItem 所在的位置

```
#pragma once

#include <SFML/Window.hpp>
#include <SFML/Graphics.hpp>
#include <Source/Text/Text.h>
#include <list>

class Menu {

    public:
        static enum MenuResult { Exit, Options, Back, ChangeResolution, Play, Nothing };

        MenuResult showMMenu(sf::RenderWindow &window);
        MenuResult showOMenu(sf::RenderWindow &window);
        MenuResult highlightButton(MenuResult menuresult);

        struct MenuItem {
            public:
                Text text;
                sf::FloatRect buttonrect;
                static void highlightRectOutline(sf::RenderWindow &window, Text text, sf::Color color);
                MenuResult action;
        };

    private:
        MenuResult getMenuResponse(sf::RenderWindow &window);
        MenuResult handleClick(int x, int y);
        MenuResult handleButtonHover(sf::RenderWindow &window, int x, int y);
        std::list<MenuItem> menuItems;

}; 
```

Text.h：这是 MenuItem 获取文本的地方。

```
#pragma once

#include <SFML/Window.hpp>
#include <SFML/Graphics.hpp>

enum style { bold, italic, underlined };

class Text {

    public: 
        void create(sf::RenderWindow &window,
                    char* string, 
                    char* fontpath, 
                    float positionx, 
                    float positiony,
                    unsigned int size,
                    style textstyle,
                    sf::Color color);

        sf::FloatRect getRect();
        static float getHeight();
        static float getWidth();

        bool operator==(Text t);
        bool operator!=(Text t);

        void setString(sf::RenderWindow &window, char* string);
        sf::String getString();

        void setFont(sf::RenderWindow &window, char* fontpath);
        sf::Font getFont();

        void setPosition(sf::RenderWindow &window, float x, float y);
        static sf::Vector2f getPosition();  

        void setScale(sf::RenderWindow &window, float x, float y);
        sf::Vector2f getScale();

        void setColor(sf::RenderWindow &window, int red, int green, int blue, int alpha);
        sf::Vector3i getColor();

    private:
        static sf::Text text;
        sf::Font font;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:00:07.060

这一行，在`Text.h`：

```
static sf::Text text; 
```

`Text`没有在`sf`命名空间中声明，所以这个名字不存在。

它应该是：

```
static Text text; 
```

# indexing - 站点地图 xmlns 和“字符集”属性

> ID：14677776
> 
> 赞同：0
> 
> 时间：2013-02-03T21:56:33.353
> 
> 标签：indexing, sitemap, xml-namespaces

我的前 2 行 sitemap.xml 是：

```
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"> 
```

关键字 xmlns 有什么作用？它是干什么用的？我应该在那里输入什么以在谷歌中建立索引。

我还在验证结果中收到警告：“text/xml”文档缺少“charset”属性。

这是什么意思以及如何纠正它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T06:38:55.183

我相信您用来验证站点地图的站点正在使用已弃用的站点地图架构。

```
<?xml version="1.0" encoding="utf-8" ?>
<sitemap xml:base="http://www.barbrastreisand.com/" lang="en" type="text/html" charset="iso-8859-1" xmlns="http://standard-sitemap.org/2007/ns"></sitemap> 
```

最新的使用：

```
<?xml version="1.0" encoding="utf-8" ?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"></urlset> 
```

# ios - 当 UIImagePicker 呈现视图时检测设备旋转

> ID：14677778
> 
> 赞同：1
> 
> 时间：2013-02-03T21:56:39.640
> 
> 标签：ios, uiimagepickercontroller

我正在使用`UIImagePickerController`课程，我的按钮在相机覆盖中。

我想像 Apple 的 Camera.app 那样根据设备方向动态调整相机按钮的方向。我知道这`UIImagePickerController`只是纵向模式，不应该被子类化。不过，我希望能够捕获和响应设备旋转 viewController 事件。

有什么干净的方法可以做到这一点吗？一旦呈现了选取器，呈现的 viewController`UIImagePickerController`就不再响应事件。

关于这个主题似乎有一些相关的[问题](https://stackoverflow.com/questions/12818748/how-do-you-tell-whether-uiimagepickercontroller-cameraoverlayview-will-rotate-or)，但没有一个可以澄清我想要做的事情是否可行。`UIImagePickerController`更令人困惑的是， iOS 版本之间的功能似乎存在一些差异。我正在 iOS6/iPhone4 上开发它，但希望与 iOS5 兼容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T10:49:17.267

这是一个干净的方法，在 iPhone4s/iOS5.1 和 iPhone3G/iOS6.1 上测试

我正在使用 Apple 的[PhotoPicker](https://developer.apple.com/library/ios/#samplecode/PhotoPicker/Introduction/Intro.html)示例并进行一些小改动。我希望您可以为您的项目调整这种方法。基本思想是每次轮换时使用通知来触发一个方法。如果该方法在叠加层的视图控制器中，它可以在显示 imagePicker 时继续操作叠加层。

`OverlayViewController.m`将此添加到`initWithNibName`

```
 [[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
    NSNotificationCenter* notificationCenter = [NSNotificationCenter defaultCenter];
    [notificationCenter addObserver:self
                           selector:@selector(didChangeOrientation)
                               name:@"UIDeviceOrientationDidChangeNotification"
                             object:nil]; 
```

这些通知会在 pickerController 显示时继续发送。所以这里，在overlay的view controller中，你可以继续玩这个界面，例如：

```
- (void) didChangeOrientation
{
    if (UIDeviceOrientationIsPortrait([[UIDevice currentDevice] orientation])) {
        self.cancelButton.image =[UIImage imageNamed:@"portait_image.png"];
    } else {
        self.cancelButton.image =[UIImage imageNamed:@"landscape_image.png"];
    }
} 
```

您将需要终止通知并在以下位置删除观察者`viewDidUnload`：

```
[[UIDevice currentDevice] endGeneratingDeviceOrientationNotifications];
[[NSNotificationCenter defaultCenter] removeObserver:self]; 
```

请注意这个应用程序的设计方式：overlayViewController 就像 imagePickerController 的包装器一样。所以你*通过*overlayViewController调用imagePicker：

```
 [self presentModalViewController:self.overlayViewController.imagePickerController animated:YES]; 
```

overlayViewController 充当 imagePickerController 的委托，并且反过来具有将信息传递回调用视图控制器的委托方法。

另一种方法是根本不使用 UIImagePickerController，而是使用[AVFoundation 媒体捕获](https://developer.apple.com/library/IOS/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html#//apple_ref/doc/uid/TP40010188-CH5-SW2)，它可以让您对拍照过程进行更细粒度的控制，但代价是（稍微）更大的复杂性。

# jquery - jQuery 在回调函数中使用闭包来操作 $getJSON 数据

> ID：14677779
> 
> 赞同：1
> 
> 时间：2013-02-03T21:56:44.630
> 
> 标签：jquery, callback, closures

这真的让我：

```
for(var i=0; i<10; i++) {
   (function(x) {     //use a closure to hold the "i" value
       request(arg[x], function(n) {
          //do something with the data returned from $getJSON
          console.log(n);
       });
   })(i)  //is this syntax correct?
}

function request(argX, callback) {    //is this syntax correct?
     $getJSON(parameter) { 
         //get request result
         ... 
     }
     callback(); //after request() function is completed, trigger the callback function
                 //is this syntax right? 

} 
```

我使用回调函数的原因是因为我想从 getJSON 操作结果，所以我需要等待请求函数完成。

我还需要将回调函数与循环索引“i”值绑定。

我已经玩了很长时间的语法，但是为什么控制台日志没有返回任何内容？在 $getJSON 完成之前，似乎从未执行或执行过回调函数。

我需要专家的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:07:17.497

ajax 调用完成后，您需要执行回调函数：

```
for(var i=0; i<10; i++) {
   (function(x) {
       request(arg[x], function(n) {
          console.log(n);
       });
   })(i);
}

function request(argX, callback) {
     $.getJSON('/url/json/', callback); //reference callback function
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T22:08:02.203

该`getJSON`调用是异步的，因此您将`callback`在响应到达之前调用该函数。

此外，在调用`getJSON`. 结果到达后也不会调用其中的代码，它只是一个单独的块，在调用之后以及结果到达之前运行。

将回调函数作为参数放入调用中`getJSON`：

```
function request(argX, callback) {
  $getJSON(parameter, callback);
} 
```

# javascript - 操作系统和 javascript/HTML5 可以访问本地存储吗？

> ID：14677780
> 
> 赞同：6
> 
> 时间：2013-02-03T21:56:44.050
> 
> 标签：javascript, windows, html, dom, local-storage

当浏览器关闭使用操作系统时，我想阅读浏览器的“本地存储”！

我想将客户端数据保存在本地存储中，然后关闭浏览器和互联网，然后让操作系统程序（Windows exe）访问和分析该数据，然后将新数据写入该本地存储区域，以便当浏览器重新启动新的数据在本地存储中。

这应该是可能的，因为我的操作系统（即 Windows）可以读取可以从浏览器“文件”中删除 cookie ......所以大概一旦我知道本地存储“文件”的格式，那么操作系统就是它所有文件的老板，所以它应该能够改变它们！

那么：我如何使用“客户端 .exe 程序”读取和写入 JavaScript/HTML5/DOM“本地存储”？

**失败：**操作系统是否可以通过其他方式将简单数据传入（和传出）浏览器？

显然这一切既有巨大的潜在力量，也有巨大的潜在危险！

只有真正的操作系统可以安全地与之交互，浏览器才能成为**“未来的虚拟操作系统” ！**

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T22:06:49.213

当然，*具有适当权限的*本地应用程序可以访问磁盘上的任何文件。但是，真正的问题是打开该文件后如何处理它？

考虑以下：

*   每个浏览器（Chrome、Firefox、IE、Opera）都可能以自己的专有格式存储本地存储数据。您必须对这些格式进行逆向工程。
*   由于这些格式是实现细节（不是记录在案的 API），因此它们很可能会更改。这会破坏您的应用程序和/或损坏用户数据。
*   如果您在浏览器打开时修改这些数据文件（即使相关页面未打开），会发生什么情况？浏览器不希望它们的数据文件从它们下面发生变化，因此您可能会看到奇怪的行为。

所有这一切都说明这是一个非常糟糕的主意。你在搞乱别人应用程序的内部；这是一个很大的禁忌。

您是否考虑过另一种方法？当我遇到类似的问题时，我只是在我的应用程序中实现了一个非常简单的 HTTP 服务器，它绑定到 127.0.0.1 上的特定端口。

使用 XHR 和适当的 CORS 标头，您的基于浏览器的应用程序可以以安全的方式与您的桌面应用程序通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T02:56:04.040

这里有一些其他的方法：

*   在您的应用程序中嵌入 Web 浏览器控件。Web 浏览器控件可以很容易地窥视页面，并且页面可以很容易地窥视本地存储。Web 浏览器控件主要是指Internet Explorer。
*   您可以通过操作可执行文件的名称将网页中的参数传递到已启动的可执行文件（甚至是批处理文件）中。（当用户下载程序时，使用`application/bat`as`Content-Type`邀请操作系统运行您的程序。）
*   从浏览器启动的[ClickOnce程序可以很容易地从网页](http://en.wikipedia.org/wiki/ClickOnce)*接收*数据。
*   您可以在您的程序（[AutoIt](http://en.wikipedia.org/wiki/AutoIt)、[AutoHotKey](http://en.wikipedia.org/wiki/AutoHotkey)）中使用自动化来复制/粘贴到您网页上的某个字段。您可以通过标题找到窗口，因为您可以控制网页端的标题。您甚至可以自动打开浏览器，将其导航到将本地存储转储到文本字段的页面，并聚焦该字段。
*   ActiveX 控件（祝你好运）

对于 OS X 或 Linux，我不能说类似的技巧。

# ios - 解析 NSArray 以获取 CLLocation 信息

> ID：14677783
> 
> 赞同：-3
> 
> 时间：2013-02-03T21:57:14.477
> 
> 标签：cllocationmanager, nspredicate, ios, objective-c, nsarray, cllocationmanager

我的 iOS 应用程序使用 Apple[在此处](https://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html)提供的信息来获取有关我的用户的各种位置信息。[cllocationmanager](/questions/tagged/cllocationmanager "显示标记为“cllocationmanager”的问题")提供了一种方法，用于在每次基于某些参数更改时获取有关用户的位置信息：

```
- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations 
```

这个方法非常棒，它返回了我需要的所有数据，但是它将它作为一个 NSArray 中的单个值返回：

> <+37.33069626,-122.02967106> +/- 10.00m（速度 3.62 mps / 路线 82.41）@ 2/3/13，下午 4:42:58 东部标准时间

这包含了我需要的所有信息（顺便说一下，*课程*变量代表什么），但我不知道如何将它变成更可用的形式。通过可用的形式，我的意思是坐标、时间、速度等都在单独的 NSString / NSDictionary / NSArray 值中。**如何将单个 NSArray 值（如上所示）拆分为不同的部分？**

我尝试在这里使用[nspredicate](/questions/tagged/nspredicate "显示标记为“nspredicate”的问题")拆分单个 NSArray 值，但我只能让 NSPredicate 返回一个布尔值。

我已经尝试使用该`componentsJoinedByString`方法拆分它，但是它只能用一个字符串拆分数组值，并且没有一个字符串可以一致地拆分每个值。

关于如何拆分通过 CLLocationManager 提供给我的 iOS 应用程序的数据的任何建议？是否有可以以更可用的形式检索/拆分相同数据的方法或函数。

## 编辑

看来我和其他人都有误解。我曾认为该`CLLocation`对象是一个具有一个值的 NSArray 对象。但是，正如我在评论中了解到的（谢谢@holex），事实并非如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:04:00.763

根据文档的[这一部分](https://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CLLocationManagerDelegate_Protocol/CLLocationManagerDelegate/CLLocationManagerDelegate.html#//apple_ref/occ/intfm/CLLocationManagerDelegate/locationManager%3adidUpdateLocations%3a)，该数组包含 CLLocations 对象。因此，只需检索和处理它们。

```
for (CLLocation *location in locations) {
  NSLog(@"Latitude: %f, Longitude: %f", location.coordinate.latitude, location.coordinate.longitude);
} 
```

# forms - 实例化部分类

> ID：14677784
> 
> 赞同：1
> 
> 时间：2013-02-03T21:57:14.787
> 
> 标签：forms, class, partial

所以我的项目中有两门课，一门课上写着

```
namespace WindowsApplication13
{
    partial class Form1 
```

其中一个是说：

```
namespace WindowsApplication13
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            string text1, text2, text3, text4;
            InitializeComponent();
            text1 = textBox1.Text;
            text2 = textBox2.Text;
            text3 = textBox3.Text;
            text4 = textBox4.Text;
        }
    }
} 
```

}

那么我如何在我的 Class1 中实例化后者呢？

我努力了

```
Form1 : Form f1 = new Form1 : Form(); 
```

和

```
Form1 f1 = new Form1(); 
```

和

```
Form f1 = new Form(); 
```

但是它们都不起作用，因为当我尝试从 Form1 获取变量时：Form，我只是收到错误“WindowsApplication13.Form1”不包含“text1”的定义。

对不起，如果这篇文章是凌乱的或做得不好。如果需要，我可以在评论中解释更多。谢谢！

编辑：对不起，如果Form f1 = new Form，我知道语法，我只是在写这个时忘记了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:01:42.710

我认为这应该是 C#？如果是这样，您将声明一个变量并像这样实例化该类：

```
Form1 form = new Form1(); 
```

`Form1 : Form`是类*声明*的一部分，表明它继承自`Form`. 您不需要它作为变量声明的一部分。

（我们不知道有什么问题`text1`——你没有告诉我们任何关于它是如何声明的或者你是如何尝试使用它的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:01:38.930

声明变量的正确语法是

```
Form1 varName = new Form1(); 
```

`Form1`是您的班级名称；它是部分的事实并没有任何区别。

如果您想访问表单中的控件，您需要先将其公开。（或者，更好的是，将其隐藏在公开您需要的功能的公共属性后面）

# cocoa - 使用 CoreData 为 NSOutlineView 设置 NSTreeCcontroller

> ID：14677790
> 
> 赞同：2
> 
> 时间：2013-02-03T21:57:37.440
> 
> 标签：cocoa, core-data, cocoa-bindings, nsoutlineview, nstreecontroller

**我的模型如下所示：**

![模型](../Images/141ac6af704d50f6dfb3fb867edaaa97.png)

**在我的测试项目中，我有以下两种方法：**

```
- (void) addChildWithName:(NSString*)name toParent:(Item*)parent
{
    static NSUInteger count = 1;

    Item*   childItem;

    childItem = [NSEntityDescription insertNewObjectForEntityForName:@"Item" inManagedObjectContext:[self managedObjectContext]];
    [childItem setName:[NSString stringWithFormat:@"%@ %lu", name, count]];
    [childItem setParent:parent];

    count++;
}

- (void)windowControllerDidLoadNib:(NSWindowController *)aController
{
    [super windowControllerDidLoadNib:aController];
    // Add any code here that needs to be executed once the windowController has loaded the document's window.

    Item*   rootItem;

    rootItem = [NSEntityDescription insertNewObjectForEntityForName:@"Item" inManagedObjectContext:[self managedObjectContext]];
    [rootItem setName:@"rootItem"];

    [self addChildWithName:@"rootChild" toParent:rootItem];
    [self addChildWithName:@"rootChild" toParent:rootItem];
    [self addChildWithName:@"rootChild" toParent:rootItem];
    [self addChildWithName:@"rootChild" toParent:rootItem];
    [self addChildWithName:@"rootChild" toParent:rootItem];
} 
```

**这会产生一个大纲视图，如下所示：**

![结果](../Images/f5db802bf831bdfcdd2d8c84e3166a99.png)

对于 xib 中的树控制器对象，我已将 Children Key Path 设置为“children”。托管对象上下文 (moc) 绑定到文件所有者 moc。我的大纲视图的表列的值绑定到 NSTreeController 的排列对象，模型键路径为“名称”。

如您所见，当子项只应出现在根项下时，我得到了子项的重复条目。

我究竟做错了什么？

示例项目位于[示例项目链接](http://ericgorr.net/cocoadev/outlineview.zip)。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:05:42.737

您的数组控制器需要一个“获取谓词”来仅在属性为 nil`Item`时选择对象，使用.`parent``parent == nil`

# popup - IE9：箭头键在弹出窗口的文本区域字段中不起作用

> ID：14677795
> 
> 赞同：0
> 
> 时间：2013-02-03T21:57:54.163
> 
> 标签：popup, internet-explorer-9, textarea, arrow-keys

我们只是在 IE9 上测试我们的应用程序，我发现一个关于弹出窗口文本区域中箭头键行为的问题。

两个箭头键无法正常工作：

1) 左箭头键 - 当我们在文本字段中输入一些多行文本并尝试在最后一行移动左箭头键时。在该行上重复向左箭头移动会导致光标向左然后回到同一行的末尾。它不会移动到上一行的最后一行（如预期的那样）。

2) 向上箭头键 - 当我们在文本字段中输入一些多行文本并尝试使用向上箭头键移动到上一行时。这没用。

如果有人可以帮助我，那就太好了。

提前致谢 ：）。

问候

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-10-07T03:48:50.817

我在其他论坛上看到了很多关于此的帖子，并且在我们在工作中使用的基于 Web 的应用程序中遇到了一些问题。这似乎与 IE9 和 ieSpell 相关联有些奇怪。

虽然有些论坛说按 F7 可以解决问题，但实际上并不能解决问题，而且似乎没有任何可以接受的永久解决方案。有人说转储您的浏览历史记录，其他人说在 IE 选项中关闭插入符号浏览。

一般来说，有很多建议可以解决这个问题，但没有一个可以真正解决它。

# asp.net - 是否可以在也运行 Django 的 apache 服务器中安装单声道？

> ID：14677799
> 
> 赞同：0
> 
> 时间：2013-02-03T21:58:28.140
> 
> 标签：asp.net, django, apache, mono

我对 apache 网络托管非常陌生，因为我的经验主要是编写托管在 Windows 机器上的 ASP .Net。我很快就会为一个客户启动一个新项目，在他们的 Fedora Web 服务器上，他们已经有 3 个其他网站在 Apache 上的 Django 框架下运行。

我正在寻找在 ASP .Net 中编写这个新应用程序，因此正在寻找在服务器上安装单声道以便我可以运行它。我已经查看了 mono 文档，但我不想开始在他们的服务器上安装它，以防它弄乱在 Django 上运行的现有站点。任何人都可以给我任何建议吗？

# android - Delivery Intent 的 pdu 中是否包含接收短信的人的电话号码？

> ID：14677801
> 
> 赞同：1
> 
> 时间：2013-02-03T21:58:38.170
> 
> 标签：android, pdu

我正在尝试从这样的交付广播接收器`Intent`中的 PDU 中找出接收短信的人的电话号码`onReceive()`

```
@Override
public void onReceive(Context context, Intent intent) {
    ThizLog.d(TAG, "Inside onReceive");
    Bundle bundle = intent.getExtras();
    Object[] messages = (Object[]) bundle.get("pdus");
    SmsMessage[] sms = new SmsMessage[messages.length];

    for (int n = 0; n < messages.length; n++) {
        sms[n] = SmsMessage.createFromPdu((byte[]) messages[n]);
    }
    for (SmsMessage msg : sms) {
        // Verify if the message came from our known sender
        ThizLog.d(TAG,"!!! " + msg.getOriginatingAddress());

    }
    switch (getResultCode()) {
        case Activity.RESULT_OK:
            // SMS delivered
            break;
        case Activity.RESULT_CANCELED:
            /*
            *  SMS not delivered, show SMS_NOT_DELIVERED_MESSAGE
            */
            Toast toast = Toast.makeText(context, SMS_NOT_DELIVERED_MESSAGE, Toast.LENGTH_LONG);
            // shows toast on left top corner increase the zero value to
            // slide it right and down
            //toast.setGravity(Gravity.TOP | Gravity.LEFT, 0, 0);
            toast.show();
            break;
    }
} 
```

但这导致了以下错误

```
02-04 03:19:34.008: E/AndroidRuntime(21881): FATAL EXCEPTION: main
02-04 03:19:34.008: E/AndroidRuntime(21881): java.lang.RuntimeException: Unable to start receiver com.abc.mnp.xyz.DeliveredSMSReceiver: java.lang.NullPointerException
02-04 03:19:34.008: E/AndroidRuntime(21881):    at android.app.ActivityThread.handleReceiver(ActivityThread.java:2827)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at android.app.ActivityThread.access$3200(ActivityThread.java:126)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2088)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at android.os.Looper.loop(Looper.java:123)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at android.app.ActivityThread.main(ActivityThread.java:4633)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at java.lang.reflect.Method.invokeNative(Native Method)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at java.lang.reflect.Method.invoke(Method.java:521)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at dalvik.system.NativeStart.main(Native Method)
02-04 03:19:34.008: E/AndroidRuntime(21881): Caused by: java.lang.NullPointerException
02-04 03:19:34.008: E/AndroidRuntime(21881):    at com.abc.mnp.xyz.DeliveredSMSReceiver.onReceive(DeliveredSMSReceiver.java:37)
02-04 03:19:34.008: E/AndroidRuntime(21881):    at android.app.ActivityThread.handleReceiver(ActivityThread.java:2816)
02-04 03:19:34.008: E/AndroidRuntime(21881):    ... 10 more 
```

有可能，Android 的原生 SMS 应用程序可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T18:39:22.333

我认为您没有从收到的意图中正确获取 pdu。它将是额外键“pdu”下的单个 pdu，而不是数组。

尝试这个：

```
public void onReceive(Context context, Intent intent) {
    String pdu=intent.getStringExtra("pdu");

    ...
} 
```

# mysql - 如何按流派或类别组织我的页面？我应该使用mysql数据库吗？

> ID：14677803
> 
> 赞同：0
> 
> 时间：2013-02-03T21:58:55.817
> 
> 标签：mysql, database, organization

我对 mySQL DB 的概念非常陌生，不确定这是否是我组织网站内容所需要的。我正在建立一个拥有电影数据库的网站，我希望能够按类型、类别、年份等划分电影......其中一些电影有多种类型和类别，我不知道如何组织内容和标签。

我正在寻找的一个例子可能是这样的： [http ://www.thelonelyisland.com/videos](http://www.thelonelyisland.com/videos)

我真的很想知道我是否应该使用 mySQL 数据库，或者是否有另一种过滤内容的方法。我为这个问题的天真道歉，但我到处看了看，不知道我在做什么！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:10:21.173

使用数据库肯定是最好的选择。这是一个基本布局：

从电影表开始：ID_movie、名称、年份等。

流派表：ID_genre，名称。

类别表：ID_category，名称。

电影与流派/类别有多对多的关系。所以你需要一个电影和流派/类别之间的桥梁表。在此表中，您将拥有电影和流派/类别之间的组合。

movies_genre 表：ID_movies、ID_genre

电影类别表：ID_movies、ID_category

这是用于创建表结构和示例数据的 SQL 查询：

```
CREATE TABLE movie(
  id_movie INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(50),
  release_date DATETIME
  );

CREATE TABLE genre(
  id_genre INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(50)
  );

CREATE TABLE category(
  id_category INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(50)
  );

CREATE TABLE movie_genre (
  ID_movie_genre INT AUTO_INCREMENT PRIMARY KEY,
  ID_movie INT,
  ID_genre INT,
  UNIQUE (ID_movie,ID_genre),
  INDEX (ID_movie,ID_genre)
  );

CREATE TABLE movie_category (
  ID_movie INT,
  ID_category INT
  );

INSERT INTO movie (name, release_date) VALUES 
('Transformers 3 Dark of the moon','2012-01-01'), 
('Harry potter and the deathly hallows 2','2011-01-01'), 
('Pirates of the caribbean. On stranger tides', '2012-01-01');

INSERT INTO genre (name) VALUES ('Action'), ('Fantasy'), ('Comedy');

INSERT INTO movie_genre(id_movie, id_genre) VALUES (1,1), (2,1),(2,2),(3,2),(3,1); 
```

[SQL 小提琴演示](http://www.sqlfiddle.com/#!2/ea4d9/1)

回应以下评论。如果您只想拥有年份，则可以将 release_date 更改为年份。一种方法是将它们转换为字符串值（Year VARCHAR(4) 而不是 release_date DATETIME）。此外，我在桥表中包含唯一性和索引。索引将加快您的查询时间。

下面您将找到一个示例查询，该查询将从电影编号 2 中检索名称和流派。 SELECT m.name AS Movie, g.name AS Genre FROM (movie AS m left JOIN movie_genre AS mg ON mg.id_movie = m.id_movie)加入流派 AS g ON g.id_genre = mg.ID_genre WHERE m.id_movie = 2;

# java - 使用 JUNIT4 进行调试：eclipse 在断点处“停止”但实际上仍在运行

> ID：14677808
> 
> 赞同：0
> 
> 时间：2013-02-03T21:59:16.360
> 
> 标签：java, eclipse, junit, breakpoints, skip

我正在使用 Eclipse Juno 调试 java 类，同时使用 junit 进行测试，但调试器一直表现不佳。我将到达我想要的断点，并且变量值看起来一切正常，但是在我的控制台中，我稍后在代码中设置的所有打印语句都弹出，就好像我正在单步执行它一样！

*（注意：如果我只是简单地运行它，它们的打印速度不会像通常那样快，并且与正常输出相比，输出本身有点乱码）。*

不知何故，代码在没有我按下按钮的情况下执行。如果我尝试单步执行，我对代码和变量的看法是正确的，但是一旦 Eclipse 认为程序已经完成，调试就会停止。

我可能应该提到的是，我最近在笔记本电脑上安装了 Fedora，所以我很久没有在上面运行 eclipse，这是我第一次尝试 junit。我是否可能需要为我的调试器下载一些东西？

# android - 将微调器项目的颜色更改为 2 种颜色

> ID：14677810
> 
> 赞同：0
> 
> 时间：2013-02-03T21:59:30.113
> 
> 标签：android, android-spinner, android-dialogfragment

我已经用两个列表填充了我的**Spinner**，它出现在**DialogFragment中 -** *list1*和*list2*。我希望列表以两种不同的颜色显示：在下拉列表中，list1 为蓝色，list2 为红色。我怎样才能动态地实现这一点？

```
public class AlertDialogFragment extends DialogFragment {

@Override
public Dialog onCreateDialog(Bundle savedInstanceState) {
    // Use the Builder class for convenient dialog construction
    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
    LayoutInflater inflater = getActivity().getLayoutInflater();

    View view = inflater.inflate(R.layout.dialog, null);

    Spinner spin;
    spin = (Spinner)view.findViewById(R.id.spinner1);

    List<String> list = new ArrayList<String>();
    list.add("Material 1");
    list.add("Material 2");
    list.add("Material 3");
    list.add("Material 4");
    list.add("Material 5");
    list.add("Material 6");

    //Second List
    List<String> list2 = new ArrayList<String>();
    list2.add("Mat 7");
    list2.add("Mat 8");
    list2.add("Mat 9");

    //Combined List
    List<String> listCombine = new ArrayList<String>();
    listCombine.addAll(list);
    listCombine.addAll(list2);

    ArrayAdapter<String> dataAdapter = new ArrayAdapter<String>(getActivity(),
            android.R.layout.simple_spinner_item, listCombine); 

    dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

    spin.setAdapter(dataAdapter);

    builder
    .setTitle("Title")
    .setView(view)
    .setPositiveButton("Add", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                   // FIRE ZE MISSILES!
               }
           })
           .setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                   // User cancelled the dialog
               }
           });
    // Create the AlertDialog object and return it
    return builder.create();
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:18:38.663

最可靠的方法是创建一个自定义适配器以使用两种不同的布局：一种红色和一种蓝色。您将需要覆盖这三个方法：

*   [`getViewTypeCount()`](https://developer.android.com/reference/android/widget/BaseAdapter.html#getViewTypeCount%28%29)返回 2 以告诉适配器期望两个不同的行布局。
*   [`getItemViewType()`](https://developer.android.com/reference/android/widget/BaseAdapter.html#getItemViewType%28int%29)返回此行是在第一个列表中还是在第二个列表中。
*   [`getDropDownView()`](https://developer.android.com/reference/android/widget/BaseAdapter.html#getDropDownView%28int,%20android.view.View,%20android.view.ViewGroup%29)调用`getItemViewType()`和使用适当的布局。

或者您可以自行覆盖`getDropDownView()`以更改适当的颜色。

# ruby-on-rails - 部分在 Heroku 上工作的语言环境

> ID：14677812
> 
> 赞同：0
> 
> 时间：2013-02-03T21:59:42.383
> 
> 标签：ruby-on-rails, ruby, heroku, internationalization

我在 Heroku 上部署了我的应用程序，它是用 Ruby on Rails 编写的。我在 config/application.rb 中进行了以下配置来读取 locales 目录：

```
# The default locale is :en and all translations from config/locales/*.rb,yml are auto loaded.
config.i18n.load_path += Dir[Rails.root.join('my', 'locales', '*.{rb,yml}').to_s]
config.i18n.load_path += Dir[Rails.root.join('config', 'locales', '**', '*.{rb,yml}')]
config.i18n.default_locale = :pt 
```

目录结构如下：

```
config
    locales
        defaults
            en.yml
            pt.yml
        models
            my_model
                en.yml
                py.yml
            my_model_2
                en.yml
                py.yml
            ...
        views
            my_view_1
                en.yml
                py.yml
            my_view_2
                en.yml
                py.yml
            ... 
```

只有存储在 defaults/pt.yml 的语言环境有效。

在我的开发环境中，所有文件都在工作。

有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T01:53:52.937

缺少的只是配置中的调用`to_s`：

```
config.i18n.load_path += 
  Dir[Rails.root.join('config', 'locales', '**', '*.{rb,yml}')] 
```

应该：

```
config.i18n.load_path += 
  Dir[Rails.root.join('config', 'locales', '**', '*.{rb,yml}').to_s] 
```

# php - 在向下滚动事件后执行 MySQL 查询

> ID：14677813
> 
> 赞同：0
> 
> 时间：2013-02-03T21:59:47.390
> 
> 标签：php, javascript, html, mysql

当用户继续触发向下滚动事件到浏览器底部时，我想实现加载更多结果。如果我的查询有 20 行结果，我想最初加载 5 个结果，当用户向下滚动时，他/她应该能够再看到 5 个结果......这将一直持续到所有结果都被加载并显示.

这是我尝试过的代码，这只会让我显示更多结果一次：谁能帮助我？

**Javascript：**

```
$.get('load_second.php', function(data) {
$('#result').append(data);
}); 
```

**HTML**

```
<div id='result'></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:03:31.280

插入页面变量。最初，此变量应为 1。使用此变量检索下一页并在每次请求时将其增加一。

```
var page = 1;

$.get('load_data.php?page=' + page, function(data) {
   page += 1;
   $('#result').append(data);
}); 
```

# objective-c - 即使静音按钮打开，如何播放音频？

> ID：14677816
> 
> 赞同：2
> 
> 时间：2013-02-03T22:00:08.953
> 
> 标签：objective-c, uibutton, avfoundation, avaudioplayer, avaudiosession

点击按钮时，我正在尝试播放音频文件。

如果我单步执行我的代码，它可以工作，但如果我只是点击按钮，则不会播放任何声音。

这是我的代码：

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil];
AVAudioPlayer * player;
NSString * path = [[NSBundle mainBundle] pathForResource:@"soundOne" ofType:@"mp3"];
NSURL * url = [NSURL fileURLWithPath:path];
player = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
[player play]; 
```

这是播放音频的适当方式吗？没有任何内容被标记为已弃用。

我还在调试器中看到了这条消息：

```
AudioQueue: request to trim 0 + 2690 = 2690 frames from buffer containing 1152 frames 
```

编辑：

此代码有效。

```
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"soundOne"
                                                     ofType:@"mp3"];
NSURL *fileURL = [[NSURL alloc] initFileURLWithPath:filePath];
self.audioPlayer = [[AVAudioPlayer alloc]
                    initWithContentsOfURL:fileURL error:nil];
[self.audioPlayer prepareToPlay];
self.audioPlayer.currentTime = 0;
[self.audioPlayer play]; 
```

**如何在静音按钮打开的情况下播放音频？**

这是我为此尝试过的代码：

```
CFStringRef state;
UInt32 propertySize = sizeof(CFStringRef);
OSStatus audioStatus = AudioSessionGetProperty(kAudioSessionProperty_AudioRoute, &propertySize, &state);
if (audioStatus == kAudioSessionNoError) {
    //NSLog(@"audio route: %@", state);
    return (CFStringGetLength(state) <+ 0);
}
return NO; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T23:48:47.443

在你打电话之前坚持这个：

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:&error];
[[AVAudioSession sharedInstance] setActive:YES error:&error]; 
```

那应该这样做。

# php - preg_replace 不替换值

> ID：14677817
> 
> 赞同：0
> 
> 时间：2013-02-03T22:00:21.833
> 
> 标签：php

我写了一个函数来从url中去除参数，函数看起来像这样

```
function remove_it($c_link){

        $regex = array();
        $award = array();

        $regex[] = '/[\?&](?<name>sa)=(?<value>[^&=]+)/';
        $regex[] = '/[\?&](?<name>ei)=(?<value>[^&=]+)/';
        $regex[] = '/[\?&](?<name>ved)=(?<value>[^&=]+)/';
        $regex[] = '/[\?&](?<name>usg)=(?<value>[^&=]+)/';

        foreach($regex as $remove){

            $c_link = preg_replace($remove,'',$c_link);

        }

        return $c_link;

    } 
```

当我使用这样的 testurl

```
$test = 'http://forum.gofeminin.de/forum/dietetique/__f2955_dietetique-Diatpillen.html&sa=U&ei=8doOUa6HOsfKtAaDpICIBQ&ved=0CB0QFjAA&usg=AFQjCNEcFS48QvteNkSNcszXv5RG6VUe2g'; 
```

醒来很完美。现在我想在我的代码中使用它。所以我打电话来处理我的数据，它不会影响字符串。我使用 print_r 来查看字符串是否看起来很奇怪，但它只是像 $test 中的 1:1

```
$TEST-> http://forum.gofeminin.de/forum/dietetique/__f2955_dietetique-Diatpillen.html&sa=U&ei=C9wOUZuvCoeQtQavpoHoDg&ved=0CB0QFjAA&usg=AFQjCNHkRBKRpZXZX7idJ6YmSG0AIxtOdw
print_r-> http://forum.gofeminin.de/forum/dietetique/__f2955_dietetique-Diatpillen.html&sa=U&ei=C9wOUZuvCoeQtQavpoHoDg&ved=0CB0QFjAA&usg=AFQjCNHkRBKRpZXZX7idJ6YmSG0AIxtOdw 
```

由于我使用了我所知道的所有调试方法，我真的不知道应该从哪里开始搜索......任何指针？

我做了antoher testrun，并将所有数据保存在一个数组中，稍后我想剥离1个url的参数。这里的测试代码：

```
 echo '<pre>';
    print_r($test).'</br>';
    echo remove_it($test[0]);
    echo '</pre>';
    break; 
```

输出是这样的：

```
Array
(
    [0] => http://forum.gofeminin.de/forum/dietetique/__f2955_dietetique-Diatpillen.html&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CDUQFjAA&usg=AFQjCNGgMS-nHM2JY_PkIt7C_RT2dr9bUw
    [1] => http://www.fitforfun.de/abnehmen/gesund-essen/diaetpillen/diaetpillen-appetitzuegler_aid_2100.html&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CEEQFjAB&usg=AFQjCNG60KJy3wLR8DnLm9gKQEn-uR6l3w
    [2] => http://www.stern.de/ernaehrung/uebergewicht-abnehmen/diaetpillen-check-welche-mittel-machen-duenn-das-abc-der-schlankmacher-615772.html&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CEYQFjAC&usg=AFQjCNGLzi5UMG4g5INDkeBdMpENgY4gHg
    [3] => http://getslim.de/diaetpillen-im-test&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CEoQFjAD&usg=AFQjCNEcZnpSlVVxLgskK9DfhBF9AHGC2w
    [4] => http://www.br.de/fernsehen/bayerisches-fernsehen/sendungen/gesundheit/themenuebersicht/medizin/schlankheitspillen-diaet-tabletten100.html&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CFQQFjAE&usg=AFQjCNHujKjdfNsOkarYf6MwHCPODcISjw
    [5] => http://www.diaetpillenvergleich.de/beste-diatpillen/&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CFoQFjAF&usg=AFQjCNFBgbYjgutHJfp-eQztXTsKYk7rTw
    [6] => http://www.diaetpillen-online.de/&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CF4QFjAG&usg=AFQjCNF083onO0rkMuQjY0tEIhhdSM4Igg
    [7] => http://diaet.erdbeerlounge.de/Diaetpillen/&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CGIQFjAH&usg=AFQjCNFhNr-gsFxK1-vfjhnC1A5qQi1ZjQ
    [8] => http://diaet.erdbeerlounge.de/abnehmen-forum/Diaetpillen-_t2698848s1&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CGcQFjAI&usg=AFQjCNHhHY3zUnJtwF6-HV-DbsxaVUFxsg
    [9] => http://www.gutefrage.net/tag/diaetpillen/1&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CG0QFjAJ&usg=AFQjCNHPYODXZA1Sa2rs6ItnUWTOYkJj3w
)
http://forum.gofeminin.de/forum/dietetique/__f2955_dietetique-Diatpillen.html&sa=U&ei=LOIOUaqQGITntQbmmIHYBQ&ved=0CDUQFjAA&usg=AFQjCNGgMS-nHM2JY_PkIt7C_RT2dr9bUw 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:33:44.037

我制作了测试数组，它对我有用。看来您的代码很好，而其他地方有问题。

尝试将函数输入用双引号括起来。

```
remove_it("$test[0]"); 
```

# c# - 从 gridview 数据中删除特殊字符

> ID：14677820
> 
> 赞同：0
> 
> 时间：2013-02-03T22:00:35.140
> 
> 标签：c#, gridview, alphanumeric

我有一个`gridview` `object`用于绑定到`datasource`. 如果`selectedIndexChanging`发生`gridview`，我想将 中显示的数据`gridview`带入`textboxes`表格中。但是，当数据包含诸如 &'"" 之类的字母数字字符时，每当我输入字母数字字符时，网格中的数据就会显示 ;amp、#S 等以及所有其他奇怪的字符。`textboxes`有没有办法防止这些字符在从网格中获取数据时弹出？我到目前为止的代码：

protected void grdActions_SelectedIndexChanged（对象发送者，EventArgs e）{

```
 int selectedRow1 = grdActions.SelectedRow.RowIndex;
            hdnIndexNo.Value = grdActions.Rows[selectedRow1].Cells[1].Text;
            ddlActionType.SelectedValue = grdActions.Rows[selectedRow1].Cells[3].Text;

            if (grdActions.Rows[selectedRow1].Cells[4].Text == null || grdActions.Rows[selectedRow1].Cells[4].Text == string.Empty || grdActions.Rows[selectedRow1].Cells[4].Text == "&nbsp;")
            {
                txtDetails.Text = string.Empty;
            }
            else
            {
                txtDetails.Text = grdActions.Rows[selectedRow1].Cells[4].Text;
            }

            if (grdActions.Rows[selectedRow1].Cells[5].Text == null || grdActions.Rows[selectedRow1].Cells[5].Text == string.Empty || grdActions.Rows[selectedRow1].Cells[5].Text == "&nbsp;")
            {
                txtCompletedDate.Text = string.Empty;
            }
            else
            {
                txtCompletedDate.Text = Convert.ToDateTime(grdActions.Rows[selectedRow1].Cells[5].Text).ToString("dd-MMM-yyyy");
            }

            ddlActionOwner.SelectedValue = grdActions.Rows[selectedRow1].Cells[7].Text;

            if (grdActions.Rows[selectedRow1].Cells[8].Text == null || grdActions.Rows[selectedRow1].Cells[8].Text == string.Empty || grdActions.Rows[selectedRow1].Cells[8].Text == "&nbsp;")
            {
                txtAssignedTo.Text = string.Empty;
            }
            else
            {
                txtAssignedTo.Text = grdActions.Rows[selectedRow1].Cells[8].Text;
            }

            if (grdActions.Rows[selectedRow1].Cells[9].Text == null || grdActions.Rows[selectedRow1].Cells[9].Text == string.Empty || grdActions.Rows[selectedRow1].Cells[9].Text == "&nbsp;")
            {
                lblComments.Visible = false;
                txtComments.Visible = false;
            }
            else
            {
                lblComments.Visible = true;
                txtComments.Visible = true;
                txtComments.Text = grdActions.Rows[selectedRow1].Cells[9].Text;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:46:07.290

在将数据从网格视图传输到文本框时，我使用了 Server.HTMLDecode()。这确保在将所有特殊字符发送回表单上的文本框之前将其删除

# android - 收到的 GCM 消息显示乱码

> ID：14677821
> 
> 赞同：4
> 
> 时间：2013-02-03T22:00:52.777
> 
> 标签：android, encode, google-cloud-messaging

我在 Google App Engine 上部署了一个 Servlet，它的作用是向 GCM 发布广播消息。Android 客户端将从 GCM 接收该广播消息。Servlet使用以下代码片段扩展了**BaseServlet 。**

```
@Override
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws IOException {
  //when receiving a gcm broadcast request, send message to GCM
  Builder mb = new Message.Builder();
  mb.addData("message", "The message to send");
  Message message = mb.build();
  sender.sendNoRetry(message, regIds);
  ...
} 
```

当“要发送的消息”是英文时，一切都很好。但是如果将“要发送的消息”换成中文等其他语言，Android客户端会收到一串乱码。在 Android 客户端上，我使用一个类扩展 GCMBaseIntentService 来处理 GCM 广播。

```
@Override
protected void onMessage(Context context, Intent intent) {

        String message = "";
        message = intent.getStringExtra("message")!=null ? intent.getStringExtra("message") : "";
        doNotify(message);
} 
```

我试图重新编码消息，但不起作用。

```
message = new String(message.getBytes("ISO-8859-1"), "UTF-8"); 
```

对这个问题有任何想法吗？我需要你的帮助，谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T22:33:08.917

试试[URLEncoder](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html)

```
mb.addData("message", URLEncoder.encode("世界","UTF-8"); 
```

另外一个选项：

```
mb.addData("message", new StringEntity("世界", "UTF-8"); 
```

查看 GCM 的源代码：com.google.android.gcm.server.Sender 后，它使用 HttpPost 作为 json，而 Java 在内部使用 UTF-16，因此在您发布之前，您需要对其进行正确编码。
正如评论所述，在客户端解码字符串

```
String yourAwesomeUnicodeString=URLDecoder.decode(intent.getStringExtra("message"),"UTF-8"); 
```

# javascript - 谷歌图表个别条形颜色

> ID：14677824
> 
> 赞同：3
> 
> 时间：2013-02-03T22:01:10.620
> 
> 标签：javascript, google-visualization

我已经阅读了许多关于此的其他问题，并尝试了提供的每个代码示例，但没有一个工作。我需要为每个条设置单独的颜色，这是我传递给图表的数据：

```
var data = google.visualization.arrayToDataTable([
    ['Month', 'Count'],
    ['January 2009', 10],
    ['February 2009', 20],
    ['March 2009', 10],
    ['April 2009', 20],
    ['May 2009', 10],
    ['June 2009', 20],
    ['July 2009', 10],
    ['August 2009', 20],
    ['September 2009', 10],
    ['October 2009', 20],
    ['November 2009', 10],
    ['December 2009', 20]
]); 
```

我已经尝试过[Google Chart 建议的设置数据的方法，每个条的颜色不同，](https://stackoverflow.com/questions/6375248/google-chart-diferent-color-for-each-bar?rq=1)但这似乎不适用于 X 轴上的字符串值。

我将如何获得字符串 X 值、数字 Y 值并单独设置颜色？

理想情况下，我还想为每个条显式设置颜色，而不仅仅是传递一组颜色，这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T00:29:34.197

一种方法是为每组数据创建不同的系列。所以不要像这样设置你的数据：

```
var data = google.visualization.arrayToDataTable([
    ['Month', 'Count'],
    ['January 2009', 10],
    ['February 2009', 20],
    ['March 2009', 10],
    ['April 2009', 20],
    ['May 2009', 10],
    ['June 2009', 20],
    ['July 2009', 10],
    ['August 2009', 20],
    ['September 2009', 10],
    ['October 2009', 20],
    ['November 2009', 10],
    ['December 2009', 20]
]); 
```

您为每组数据添加一个单独的列，如下所示：

```
var data = google.visualization.arrayToDataTable([
    ['Month', 'Jan', 'Feb', 'Mar', 'Apr'],
    ['January 2009', 10, null, null, null],
    ['February 2009', null, 20, null, null],
    ['March 2009', null, null, 10, null],
    ['April 2009', null, null, null, 20],
]); 
```

这将使每个系列具有不同的颜色（它还将使图例中的每个系列和单个项目，根据您的应用程序可能不吸引人，也可能不吸引人）。

您可以编写一个 for 循环来遍历原始数据并自动添加空值，如下所示：

```
 for (var i = 0; i < rawData.getNumberOfRows(); i++) {
    data.addColumn('string', rawData.getFormattedValue(i, 0));
  };

  for (var j = 0; j < rawData.getNumberOfColumns() - 2; j++) {
    data.addRow();
    data.setValue(j, 0, rawData.getColumnLabel(j + 1));
    for (var i = 0; i < rawData.getNumberOfRows(); i++) {
      data.setValue(j, i + 1, rawData.getValue(i, j+1));
    };
  }; 
```

添加一列将添加所有“空”值，然后您可以根据需要设置数据值。如果不以这种相对尴尬的方式（添加所有额外的系列）进行操作，就无法为 API 中的各种系列着色。

如果您不想这样做，最好的办法是深入研究 SVG 并找出如何使用 CSS 来操作 SVG（但是这会导致浏览器与 IE 的兼容性问题）。

# mysql - 使用mysql的全部或全部/事务语句

> ID：14677827
> 
> 赞同：2
> 
> 时间：2013-02-03T22:01:53.363
> 
> 标签：mysql, bash, shell

我在 shell 脚本中有以下两个语句：

```
 32 /usr/local/mysql/bin/mysql -u root files -e "TRUNCATE path"
 33 /usr/local/mysql/bin/mysql -u root files -e "
 34     LOAD DATA INFILE '/tmp/files.txt'
 35     INTO TABLE path
 36     FIELDS TERMINATED BY ','
 37       (size, @d2, @d3, @d4, @d5, path)
 38     SET last_modified=str_to_date(CONCAT(@d2, ',', @d3, ',', @d4, ',', @d5), '%b,%d,%T,%Y');"
 39 } 
```

我将如何使从第 32 行和第 32 行开始的命令要么都工作要么都失败（事务）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:04:57.857

你需要的是一笔[交易](http://dev.mysql.com/doc/refman/5.5/en/commit.html)：

```
BEGIN;
LOAD DATA INFILE ...;
SET ...;
COMMIT; 
```

除非您`COMMIT`进行事务处理，否则数据库不会加载这些行或更新列。

请注意，[某些操作不能在 MySQL 中“事务化”](http://dev.mysql.com/doc/refman/5.5/en/implicit-commit.html)，这包括模式更改以及`TRUNCATE TABLE`. 无论您的意图如何，某些语句都会强制提交，因此在尝试创建事务时要小心避免这些语句。

# php - 在我检查以确保存在文件后，表格未附加文件

> ID：14677830
> 
> 赞同：-1
> 
> 时间：2013-02-03T22:02:14.310
> 
> 标签：php, forms, email, attachment

我正在制作一个提交备注并上传文件并将其作为附件通过电子邮件发送的表单。我遇到的问题是，如果我不附加文件，PHP 不知道要附加什么。所以为了解决这个问题，我改变了

```
 $mail->AddAttachment($_FILES['file']['tmp_name'], $_FILES['file']['name']);      // attachment 
```

到：

```
if($file != "")
      {
      $mail->AddAttachment($_FILES['file']['tmp_name'], $_FILES['file']['name']);      // attachment
      } 
```

现在，即使我放入附件，它也不会提交附件，我该如何解决这个问题？

完整代码：

```
<title>Success</title>
 <?php
    require_once '../PHPMailer_5.2.2/class.phpmailer.php';

$name = $_POST['name'] ;
$email = $_POST['email'] ;
$phone = $_POST['phone'] ;
$gender = $_POST['gender'] ;
$recipientname = $_POST['recipientname'] ;
$hobbies = $_POST['hobbies'] ;
$age = $_POST['age'] ;
$school = $_POST['school'] ;
$pet = $_POST['pet'] ;
$hair = $_POST['hair'] ;
$eye = $_POST['eye'] ;
$food = $_POST['food'] ;
$drink = $_POST['drink'] ;
$sport = $_POST['sport'] ;
$schoolsubject = $_POST['schoolsubject'] ;
$teacher = $_POST['teacher'] ;
$strengths = $_POST['strengths'] ;
$animal = $_POST['animal'] ;
$superpower = $_POST['superpower'] ;
$fears = $_POST['fears'] ;
$skills = $_POST['skills'] ;
$dedication = $_POST['dedication'] ;
$friend = $_POST['friend'] ;
$otherinfo = $_POST['otherinfo'] ;
$file = $_POST['file'] ;

$body = "Name: $name
Email: $email
Gender: $gender
Recipient's name: $recipientname
Hobbies: $hobbies
Age: $age
School: $school
Pet Info: $pet
Hair Color: $hair
Eye Color: $eye
Favorite Food: $food
Favorite Drink $drink
Favorite Sport: $sport
Favorite School Subject: $schoolsubject
Favorite Teacher: $teacher
Strengths: $strengths
Favorite Animal: $animal
Favorite Superpower/Why: $superpower
Fears/Challenged: $fears
Skills: $skills
Dedication: $dedication
Best Friend Info: $friend
Other Information: $otherinfo";

    $mail = new PHPMailer(true); //defaults to using php "mail()"; the true param means it will throw exceptions on errors, which we need to catch

    try {
      $mail->AddAddress('***@****.com', 'Michael');
      $mail->SetFrom($email, $name);
      $mail->AddReplyTo($email, $name);
      $mail->Subject = "Message From Legendmaker Customer: $name";
      $mail->Body = $body;

      $mail->Send();
      echo "Story Request Sent Successfully</p>\n";
      echo "<img src='/images/knight-success.png' alt='success' width='429' height='791' />"; 
      echo "Your request will be processed soon. Once your request has been processed you will receive an email. </p>\n";
    } catch (phpmailerException $e) {
      echo $e->errorMessage(); //Pretty error messages from PHPMailer
    } catch (Exception $e) {
      echo $e->getMessage(); //Boring error messages from anything else!
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:36:37.733

$_POST['file'] 似乎与它没有任何关系。

我会删除它并放入：

```
if ($_FILES['file']['size']) {
    ...
} 
```

那行得通吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:06:11.197

检查是否`$_POST['file']`等于`""`不是检查用户是否上传文件的有效方法。你想要类似[is_uploaded_file](http://www.php.net/is_uploaded_file)的东西。

# android - OnCreate 而不是 OnResume/OnRestart？

> ID：14677835
> 
> 赞同：3
> 
> 时间：2013-02-03T22:02:25.660
> 
> 标签：android, oncreate, onresume, application-restart

我有一些活动，比如说活动 A、B 和 C。在活动 AI 中，通过带有 的菜单调用 B `onOptionsItemSelected`：

```
Intent main = new Intent (this, MainActivity.class);
this.startActivity(main); 
```

现在，当我在 B 活动中时，我可以以相同的方式调用 A 一个（使用 Intent 和 startactivity）：我如何处理它来调用A`OnResume`的`OnRestart`方法而不是方法`OnCreate`？

我正在记录它，每当我从一个活动转移到另一个活动时，它总是调用该`OnCreate`方法：我能做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:03:32.907

在 manifest.xml 中将您的 Activity A 配置为“singleTask”或“singleInstance”。然后，当您从 Activity B 调用 Activity A 时（假设 Activity A 已经像您描述的那样实例化），Acitivity A 的 onResume() 将被触发而不是 onCreate() 。这种配置有缺点，因此请阅读[此](http://developer.android.com/guide/topics/manifest/activity-element.html)内容。

清单示例：

```
<activity android:name=".YourActivityA"     
        android:configChanges="keyboardHidden|orientation"      
        android:launchMode="singleTask"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:06:59.653

您无法控制是否直接调用 OnCreate/OnResume/OnRestart 方法。它基于先前的活动是否仍在内存中。

[http://developer.android.com/guide/components/activities.html](http://developer.android.com/guide/components/activities.html) [http://developer.android.com/images/activity_lifecycle.png](http://developer.android.com/images/activity_lifecycle.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T22:09:02.130

> 我正在记录它，每当我从一个活动转移到另一个活动时，它总是调用 OnCreate 方法：我能做什么？

要从活动 B 返回到活动 A，如果您使用：

*   `startActivity()`，那么 A`onCreate()`将始终被调用。
*   `finish()`, 那么 A`onCreate()`可能会或可能不会被调用。（这取决于 A 是否被您或操作系统破坏。）

# php - AJAX/JQUERY 不更新 MySQL 行

> ID：14677838
> 
> 赞同：0
> 
> 时间：2013-02-03T22:02:56.413
> 
> 标签：php, jquery, mysql, ajax, textarea

我目前正在尝试在用户单击其他地方时更新文本区域。我不精通 AJAX 和 Jquery。但是，该脚本似乎没有更新数据库中的行。

Jquery/文本区域：

```
<textarea id="<?php echo $item_id; ?>_textarea"><?php echo $notes; ?></textarea>
    <script type="text/javascript">
    $('<?php echo $item_id; ?>_textarea').on('blur',function () {
var notesVal = $(this).val(), id = $(this).data('id');        
var itemVal = <?php echo $item_id; ?>;
$.ajax({
     type: "POST",
     url: "updateNotes.php",
     data: {notes:notesVal , id:id, itemId:itemVal},
     success: function(msg) {
         $('#'+id).html(msg);
     }
 })
});
</script> 
```

updateNotes.php：

```
<?php

include('db_connect.php');
include('order_functions.php');

$email = $_SESSION['username'];

$cartId = getcartid($mysqli, $email);
$notes = $_POST['notes'];
$itemID = $_POST['itemId'];

$query = "UPDATE `rel` SET `notes` = '$notes' WHERE `cart_id` = '$cartId' && `id_item` = '$itemID'";
$result = $mysqli->query($query) or die($mysqli->error.__LINE__);

if(result) {
return "Notes Updated"; 
```

} ?>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:37:08.590

您忘记了 php 代码中最后一个 if 语句中的 $ 并且您应该使用“echo”（或类似的）而不是“return”，因为您不在函数中。

```
<?php

include('db_connect.php');
include('order_functions.php');

$email = $_SESSION['username'];

$cartId = getcartid($mysqli, $email);
$notes = $_POST['notes'];
$itemID = $_POST['itemId'];

$query = "UPDATE `rel` SET `notes` = '$notes' WHERE `cart_id` = '$cartId' && `id_item` = '$itemID'";
$result = $mysqli->query($query) or die($mysqli->error.__LINE__);

if($result) {
    echo "Notes Updated";
}
?> 
```

您的 html/javascript-code 有点错误。这就是我猜你希望它工作的方式：

```
<div id="<?php echo $item_id; ?>_div">
    <textarea id="<?php echo $item_id; ?>_textarea" data-id="<?php echo $item_id; ?>"><?php echo htmlentities($notes); ?></textarea>
</div>

$('#<?php echo $item_id; ?>_textarea').on('blur', function () { // don't forget # to select by id

    var id = $(this).data('id'); // Get the id-data-attribute
    var val = $(this).val();
    $.ajax({
        type: "POST",
        url: "updateNotes.php",
        data: {
            notes: val, // value of the textarea we are hooking the blur-event to
            itemId: id // Id of the item stored on the data-id
        },
        success: function (msg) {
            $('#' + id + '_div').html(msg); //Changes the textarea to the text sent by the server
        }
    });
}); 
```

祝你好运

# php - 只有一页带有get requests php的正确方法是什么？

> ID：14677841
> 
> 赞同：0
> 
> 时间：2013-02-03T22:03:22.070
> 
> 标签：php, mysql, get

例如，我有 viewpost.php，它是根据需要设置的，我只需要在其中更改 div 中的内容。

例如，我将不得不做 viewpost.php?id=1,2,3 等。但是我应该使用 index.php?action=viewpost&id=1 做所有关于 index.php 的事情吗？

然后，我是使用 if 语句，还是使用这些 get 请求与我的数据库进行通信？

总的来说，无论如何我都打算使用 modrewrite，但我对设置从一个或几个 php 文件加载多个页面的正确方法一无所知。

我有一个模板，我只需要使用数据库数据填充它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:08:35.100

index.php?action=viewpost&id=1 索引中的这段代码：

```
if(isset($_GET['action']) && isset($_GET['id']))
{
$id = $_GET['id'];
if($action == "viewpost")
{
// action is viewpost
if(!ctype_digit($id))
{
// id isnt digit
die();
}
else
{
// viewpost 
include('viewpost.php');
}
} 
```

**viewpost.php 可能看起来像：** 只是为了确保在直接访问 viewpost.php 时不会发生任何不良情况，如果 viewpost.php 存在，您可以在 url 中看到，或者只是在此处进行安全性 (!ctype_digit($_GET['id'] ))

```
 // since its already been secured with !ctype_digit, we can run queries right away
$q_findPost = mysqli_query($mysqli, "SELECT * FROM posts WHERE id=$id");
$r = mysqli_fetch_assoc($q_findPost);
// div stuff 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:09:33.160

最简单的方法是像这样非常基本的东西（虽然不是很安全）

```
$page = $_GET["action"];
if($page == null)
{
        $page = "main";
}

if (file_exists("content/$page.php"))
{
        include ("content/$page.php");
}
else
{
        include ("includes/404.php");
} 
```

更好的解决方案是使用[http://www.smarty.net/](http://www.smarty.net/)之类的东西来处理模板和内容加载。稍微复杂一些，但如果您在做一个非常简单的网站之外的任何事情，则很可能值得付出额外的努力。

# ajax - 有没有办法在带有 @ResponseBody 注释的方法中添加 cookie？

> ID：14677842
> 
> 赞同：3
> 
> 时间：2013-02-03T22:03:28.597
> 
> 标签：ajax, web-applications, spring-mvc, cookies, annotations

我基于 Spring MVC 构建我的 Web 应用程序，并在尝试在处理 ajax 请求的方法中添加 cookie 时遇到问题。

我意识到带有@ResponseBody 的方法（在我的示例中它返回一个字符串值）不会创建“真实”响应并且添加的cookie 会丢失。

有什么方法可以在 Spring MVC 中通过 ajax 调用的方法中添加 cookie（因此使用 @ResponseBody 进行注释）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T05:15:56.463

您可以使用以下签名来执行此操作

```
@ResponseBody
public String x((HttpServletRequest request, HttpServletResponse response){
    Cookie userCookie = new Cookie("<name>", "<valie>");
    //set other cookie properties
    response.addCookie(userCookie);

    return "xxx";
} 
```

# algorithm - 算法的复杂性：为什么要“约”？

> ID：14677850
> 
> 赞同：2
> 
> 时间：2013-02-03T22:04:00.667
> 
> 标签：algorithm, complexity-theory, time-complexity

我正在研究数值分析，我可以读到算法的复杂度为“大约 n^2/2”。

我知道复杂性与写/读/乘/求和操作有关，但我不明白为什么“大约”而不是“精确”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:08:14.877

在算法分析中，通常只通过显性增长项来描述算法的增长率。例如，如果算法的实际运行时间为 n ² /2 + 13n + 1，那么随着 n 变大（例如，n > 50），几乎所有运行时间都由 n ² /2 项解释，并且非常其他两个术语贡献很小。

在大部分计算机科学中，算法是使用大 O 表示法来描述的，它完全丢弃了除主要增长项之外的所有内容，甚至丢弃了所有常数因子。在数值计算中，通常只是保持主要增长项及其常数因子，因为对于大输入，该项几乎决定了所有运行时间。不过，常数因子对于比较不同的算法仍然很有用。

简而言之 - 人们*可以获得*精确的分析，但对于大型问题来说它不是很有用。占主导地位的增长术语真的很重要。

希望这可以帮助！

# php - 使用保留字符 (-,@) 和索引 (0) 命名访问 PHP 对象

> ID：14677851
> 
> 赞同：1
> 
> 时间：2013-02-03T22:04:08.917
> 
> 标签：php, object, character, json, reserved

在 PHP 中弄清楚了如何使用 {name-with-reserved-chars} 表示法在 JSON 解码后访问对象数据，但我在路径中也有索引值（如 [0]）。尽管我尝试改变模式，但我尝试添加索引值并没有返回任何结果。这是一个基于大型 JSON 对象的示例：

```
["ops:world-patent-data"]["exchange-documents"]["exchange-document"]
[0]["bibliographic-data"]["publication-reference"]["document-id"][0].date.$ 
```

我的尝试一无所获：

```
print $result->{'ops:world-patent-data'}->{'exchange-documents'}->{'exchange-document'}->
      {0}->{'bibliographic-data'}->{'publication-reference'}->{'document-id'}->{0}->date; 
```

想知道如何在路径中放置 0 和 1 索引...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:31:15.407

当反序列化一个实际的 JSON**列表**（即，不是一个对象，而是一个具有数字索引的实际数组；类似`[1,2,3,...]`or `[{...},{...},...]`）时，PHP 的`parse_json`函数会构建一个具有数字索引的相应 PHP 数组（另一方面，它将 JSON**对象**映射到`stdClass`类——除非你使用函数的参数`$assoc`）`parse_json`。

因此，因为您访问的是数组而不是对象，所以您的代码可能必须如下所示：

```
print $result->{'ops:world-patent-data'}->{'exchange-documents'}->
    {'exchange-document'}[0]->{'bibliographic-data'}->{'publication-reference'}->
    {'document-id'}[0]->date; 
```

使用该`$assoc`参数可能会更容易，强制`json_decode`将整个 JSON 对象映射到关联数组，还允许您使用方括号表示法进行对象访问。

# java - 如何拦截私有方法

> ID：14677852
> 
> 赞同：0
> 
> 时间：2013-02-03T22:04:23.927
> 
> 标签：java, interceptor, cglib

有人可以解释一些模拟库（如 power mock）如何为私有方法创建代理。我对**cglib**进行了一些研究，但找不到**拦截私有方法调用**的方法。我特别想了解可用于拦截私有方法的任何**低级库或核心 Java 技术。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:13:21.733

您不需要这样拦截呼叫。只需（！）在方法的开头插入您的代码。（需要对其余代码进行一些修改。）可以在类加载时通过 Java 代理 API 重写代码。

有了这个，IMO 测试你最好分成更小的班级，你的接缝是免费的。

# java - 调整数组数组的大小

> ID：14677854
> 
> 赞同：0
> 
> 时间：2013-02-03T22:04:47.733
> 
> 标签：java, arrays, resizable

我正在尝试创建一个布尔方法来调整我的数组大小，如果扩大则返回 true，否则返回 false 缩小！这是我到目前为止所做的，请帮助我，我不知道剩下的事情是什么:)

```
public class StringArray implements InterfaceStringArray{

String[] strArray; // create an array & store value
private int nElems =0;  // number of elements
final int ARRAY_MAX = 100;

    StringArray bubbleSort= new StringArray();     // create bubbleSort object
    StringArray selectSort = new StringArray();    // create selectSort object
    StringArray insertSort = new StringArray();   // create insertSort object

public void initialize (int arrSize) { //initializes an array of size=arrSize
    strArray = new String [arrSize]; 
}

public int getSize() { //returns the current array size
    return strArray.length;
}

public boolean resize(int newSize) { //returns true if successful (widening), false if narrowing
    String[] newArray = new String[ strArray.length * 2];

    for ( int x=0; x < strArray.length; x++){ // Load array
        if (newArray[x].equals(strArray[x]) )
        return true;
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:01:23.220

好的，即使使用 ArrayList < String > 会更好地完成您的任务，我还是会尝试坚持您当前的实现并重新编写**resize()**方法。

```
/*
 *  A method to resize the array.
 *  @param  : newSize - new required size of array
 *  @return : true if widening, false if narrowing
 *
 */
public boolean resize(int newSize) { 

    boolean toReturn = true;

    // if narrowing or the size isn't being changed, return value changes to false; 
    if ( newSize <= strArray.length ){
         toReturn = false;
    }

    String[] newArray = new String[newSize];

    // yes, Java allows creating zero-sized arrays

    if(newSize != 0){

       // copying from old array to new one; it doesn't matter if this is narrowing 
       // or widening, everything that fits in will be copied
       System.arraycopy(strArray,0,newArray,0,newSize);

       // copying pointer to newArray to the variable where strArray used to be
       strArray = newArray;

    }
    return(toReturn);

} 
```

您当前的实现与您的目标完全不同。首先，您将数组大小加倍，而不是使用参数 newSize 设置它。其次，您的方法是这样进行的：

*   创建一个双倍大小的数组；
*   遍历主数组，并在每一步中比较 strArray 中的 String 和 newArray 中的 String；
*   一旦位置 x 上的字符串相等，则返回 true；
*   如果都不相等，则返回 false；

注意：它总是返回 false，因为 newArray 是空的。

一些关于 ArrayLists 的阅读：

*   [docs.oracle.com](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/ArrayList.html)；
*   [http://web.cs.dal.ca/~sedgwick/ArrayList.html](http://web.cs.dal.ca/~sedgwick/ArrayList.html)
*   [javarevisited.blogspot.ru](http://javarevisited.blogspot.ru/2011/05/example-of-arraylist-in-java-tutorial.html) ;
*   集合/CreatinganArrayList.htm">http://www.java2s.com/Tutorial/Java/0140_Collections/CreatinganArrayList.htm
*   [http://www.tutorialspoint.com/java/java_arraylist_class.htm](http://www.tutorialspoint.com/java/java_arraylist_class.htm)；

不幸的是，我所知道的关于 Java 的最好的书都是用捷克语写的，所以除非你说那种语言，否则我无法提供任何建议......

# facebook - Facebook 在画布下运行时不显示身份验证

> ID：14677855
> 
> 赞同：1
> 
> 时间：2013-02-03T22:04:57.093
> 
> 标签：facebook, facebook-graph-api, authentication

我有一个网站已经与 Facebook 登录集成，使用服务器端身份验证。

我有一个问题要把它变成在 Facebook 下运行的应用程序。

**问题是 Facebook 根本不显示身份验证页面**

因此，我什至没有真正进入服务器身份验证过程。

现在，该应用程序正在我的本地计算机上运行。

我的应用程序被定义为 Facebook 应用程序：（仅出于站点安全目的在 localhost 之前添加空白）

*   画布网址：http://localhost:4300/fbopt/
*   安全画布 URL：https://localhost:4303/fbopt/"

[在沙盒中运行时会出现同样的问题，没有安全 URL]

我有一个带有“转到应用程序”按钮的“粉丝页面”。按下按钮将我带到 URL：https://apps.facebook.com/[appid]/?fb_source=timeline

浏览器开始加载带有框架的页面。较低的框架向我提供的 URL 发出 POST 请求。

我的应用程序将页面重定向到以下 URL：

https://www.facebook.com/dialog/oauth?client_id=[appid]&redirect_uri=https://localhost:4303/fbopt/hook&scope=email,user_location,user_birthday

我希望 Facebook 能够显示具有所需权限的应用程序身份验证表单。

不幸的是，这不会发生。*框架内显示一个空页面，HTML 是空的！*

我看到（从 Chrome 网络调试器）确实访问了 URL，但响应是 HTTP 200 状态（不是错误），但没有响应数据。相反，得到

X-Frame-选项：拒绝

响应标头 - 在帧内渲染被拒绝！为什么？

在 Facebook 框架结构之外“手动”加载上面的 URL 时，我确实获得了具有正确权限的身份验证屏幕。

我想知道让它与画布一起工作缺少什么。

关于我应该添加什么或如何调试此类问题的任何提示 - 将不胜感激。

谢谢，麦克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:28:33.607

看起来我的根本问题是我试图重定向整个页面，而不是进行框架重定向。

从这里开始： [空白画布 => '拒绝显示文档，因为 X-Frame-Options 禁止显示。'](https://stackoverflow.com/questions/9100916/blank-canvas-refused-to-display-document-because-display-forbidden-by-x-fram)

去了这里： [https ://developers.facebook.com/docs/howtos/login/login-for-canvas/](https://developers.facebook.com/docs/howtos/login/login-for-canvas/)

它说：

因为您的应用程序是在 iframe 中加载的，所以返回 302 以将用户重定向到登录对话框将不成功。相反，您必须通过设置 Javascript window.top.location 属性进行重定向，这会导致父窗口重定向到登录对话框 URL

这可能是我的主要错误。

最大限度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:55:01.230

你`iframe`的应用里有吗？发送`X-Frame-Options`内容`DENY`是 Facebook 对抗点击劫持的方式。更多信息：

[http://darklaunch.com/2010/11/09/facebook-s-anti-clickjacking-techniques](http://darklaunch.com/2010/11/09/facebook-s-anti-clickjacking-techniques)

[大约 2 周后，将 iframe 添加到 facebook 不再起作用](https://stackoverflow.com/questions/8226505/adding-an-iframe-to-facebook-does-not-work-anymore-since-2-weeks)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-13T15:17:43.617

我有同样的问题。302 重定向有效，因为我使用了很多，但您不能出于任何原因重定向到 facebook 域。如果您愿意，可以通过 javascript 进行顶部重定向。我所做的是创建了一个接受 url 的 html，并将其加载到 top.location，然后重定向回 apps.facebook.com。使用 X-frame 很可能是因为您有一个 AntiForgeryToken（如果使用 .net），因为这会在标题中插入 xframe sameorigin。您可以使用禁用此功能

```
AntiForgeryConfig.SuppressXFrameOptionsHeader = true; 
```

# jquery - 如何 jquery onclick 将文本附加到 TINYMCE 文本区域的末尾

> ID：14677856
> 
> 赞同：1
> 
> 时间：2013-02-03T22:04:56.957
> 
> 标签：jquery

我正在尝试单击页面中的一个单词，该单词将在`<textarea>`. 我在普通文本区域上工作正常，但在 TinyMce 中找不到正确的方法。

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">  </script>

<Idea2>Idea2</Idea2>

<script language="JavaScript" type="text/JavaScript">
$('Idea2').click(function() { 
$('#DiscussionX1').val($('#DiscussionX1').val()+'\n\r newCharter'); 

});
</script> 
```

我在下面被告知这将是我需要的东西，但是我不知道如何将它部署到我的代码中。

```
 $('.mceContentBody').tinymce().execCommand('mceInsertContent',false); 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:18:17.533

```
 $('.mceContentBody').tinymce().execCommand(
        'mceInsertContent', 
        false, 
        {
         'value': 'newCharterOrWhateverHere', 
         'anothervalue' :'forTheSakeOfCompleteness'
        }
 );

 function mceInsertContent(object) {
      // get content of the current textarea and add the new value you want
      var content = tinyMCE.activeEditor.getContent({format : 'raw'}) + object.value;
      tinyMCE.activeEditor.setContent(content, {format : 'raw'});
 } 
```

# ios - 程序化自动布局、约束和 UIView 运行时

> ID：14677862
> 
> 赞同：1
> 
> 时间：2013-02-03T22:05:37.717
> 
> 标签：ios, uiview, constraints, autolayout

在阅读 Apple 的 View Programming Guide 时，很明显他们没有针对约束对其进行更新。所以有几个问题：

1.  这里的许多帖子都谈到在初始化新 UIView 或将其设置为 CGRectZero 或其他等效项时不使用 -initWithFrame。那你会怎么处理呢？：

    ```
    -(id)initWithFrame:(CGRect)frame
    {
        self = [super initWithFrame:frame];
        if (self){

        //Set up rounded rectangle ivar
        CGRect frame = [self bounds];
        CGFloat radius = frame.size.height / 2;
        _rectPath = [UIBezierPath bezierPathWithRoundedRect:frame cornerRadius:radius];
        } 
    } 
    ```

    然后将绘图代码放入drawRect:中。我发现没有框架就无法正确初始化。（显然，我正在初始化这个 UIView 并立即设置约束但没有立即设置框架）。此代码集的 frame = (0,0,0,0) 因为尚未计算约束。

    如果我们不把这段代码放在init中，我们会把它放在哪里？另外，我认为在 init 的视图中初始化我们需要的所有东西是一种很好的做法。

    所以这导致了问题......

2.  何时在运行时周期中调用 -updateConstraints 以及视图何时使用这些约束计算其边界？我注意到在-layoutSubviews 之后视图真的不知道它的边界是什么。如果 UIView 仅设置了约束，那么在此之前是否还有其他地方知道它的边界？

很抱歉所有问题，但它们似乎都有关联。谢谢你的样子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:22:55.213

您的框架问题与自动布局无关。视图大小一直在变化。它几乎与对象实例化期间不同。您需要在 drawRect*期间*创建/计算路径的大小以适应当前大小，而不是在您第一次创建视图时。

您应该设置的唯一对象`init`是您的类的其余部分依赖于存在于特定状态的属性和/或 ivars。

# javascript - 数值误差的选择

> ID：14677865
> 
> 赞同：-1
> 
> 时间：2013-02-03T22:05:57.340
> 
> 标签：javascript, selection

我试图确定总数等于多少，然后做与每个选择有关的工作。我的第一个选择是如果总数是 2、3 或 12，那么你输了。如果是 7 或 11，你就输了。任何其他的点都是成立的。首先我的代码看起来像这样，但每一次，它都会去别的地方。总数是通过使用此函数加在一起的 2 个随机数来计算的：

```
 Math.floor(Math.random()*6+1); 
```

```
function game()
 {
if(total==2 || total==3 || total==12)
    {
        alert("You lose. Please start a New Round");
    }
if(total==7 || total==11)
    {
        var temp= 2 * bet;
        alert("You win $" + temp);
    }   
else 
    {
        alert("Point Established. Roll again.");
        var point=total;
        setTimeout(rolldice2,3000);
    }
 } 
```

然后我把它改成这样：

```
 function game()

 {
if(total==2 , 3 , 12)
    {
        alert("You lose. Please start a New Round");
        return;
    }
if(total==7 , 11)
    {
        var temp= 2 * bet;
        alert("You win $" + temp);
        return;
    }   
else 
    {
        alert("Point Established. Roll again.");
        var point=total;
        setTimeout(rolldice2,3000);
    }
 } 
```

但它只是说无论如何你都会输。然后我终于拿出了回报。它只做前两个，而不是别的。我希望能够选择一个——取决于变量总数等于什么——然后执行它的工作，然后离开这个函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:12:12.137

在您的情况下`total`，变量是`undefined`

传递`total`给你的函数并做一个`switch`声明

```
 function game(total)
 {
    switch(total)
    {
        case 2 : 
        case 3 :
        case 12 : {
                    alert("You lose. Please start a New Round");
                    return;
                  }
        case 7 : 
        case 11 :
                 {
                    var temp= 2 * bet;
                    alert("You win $" + temp);
                    return;
                 }   
        default : 
                {
                    alert("Point Established. Roll again.");
                    var point=total;
                    setTimeout(rolldice2,3000);
                }
    }
 } 
```

# multithreading - excel vba中的并发和多线程

> ID：14677866
> 
> 赞同：1
> 
> 时间：2013-02-03T22:06:09.843
> 
> 标签：multithreading, excel, vba, concurrency

所以我在网上搜索，我得到的大多数答案都说 Excel 中没有并发。但是有些帖子说 EXCEL 2007 提供了多线程以加快计算速度。我真的很困惑，这可能吗？

在我的工作簿中，有一些单元格是使用用户定义的函数计算的。这些单元每秒通过 RTD 服务器更新一次。那么这是否意味着这些函数看起来是并行重新计算的，但实际上 Excel 只是按顺序调度它们呢？计算机是否具有多个内核是否会有所不同？

事实上，如果这些函数是按顺序运行的，那么下面的两个函数是等价的吗？在性能和速度方面。

1)

```
cell1 = userFunc(1, switch1)
cell2 = userFunc(2, switch2)
cell3 = userFunc(2, switch3) 
```

和 2)

```
cell = func()

where func() is

public function
        if(switch1)  call userfunc1
        if(switch2)  call userfunc2
        ....

end function 
```

让我们假设对功能进行了所有必要的调整。我的意思是，第一个会更快吗？

非常感谢！！！

更新：因此，如果 VBA 中没有真正的并发性，这是否意味着函数被顺序调用并且可以访问共享全局变量而不会出现锁定问题？我有一个几乎每个函数都使用的 API 对象，所以我可以共享它而不是每次使用它时都对其进行初始化吗？这个对象只是一个用来调用一些静态函数的API，对象本身没有任何修改或任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T10:55:33.110

是的 Excel 2007 及更高版本支持使用多个内核的多线程计算，但正如 Tim 所说 - 使用 VBA 编写多线程 UDF 是不可能的。

为了获得良好的 UDF 性能，您确实需要使用 XLL 接口并利用多线程。

您可以使用 Excel DNA（免费）或 Addin Express（收费）在 .NET C# 或 VB.Net 中创建多线程 XLL UDF。
VSTO 不支持 UDF，.Net 自动化 UDF 非常慢
对于 C++ XLL UDF，我推荐 Planatech XLL+。

# perl - 如何在测试运行中包含多个（但不是全部）Perl 测试文件？

> ID：14677867
> 
> 赞同：1
> 
> 时间：2013-02-03T22:06:10.373
> 
> 标签：perl, unit-testing, makefile

我正在使用 ExtUtils::MakeMaker 来管理我的一个 Perl 库。测试框架以通常的方式设置，`./t`目录中有几个测试文件。

如果我想运行目录中的*所有*测试`./t`，我运行`make test`.

如果我想在目录中的*单个*文件中运行测试`./t`，我运行`make TEST_FILES=./t/test01.t test`.

如何在*两个*（或更多）测试文件中运行所有测试？我试过`make TEST_FILES=./t/test01.t,./t/test02.t test`了，但这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T04:48:59.457

使用空格分隔文件；使用引号将空格绑定到`TEST_FILES`作业。

```
make test TEST_FILES="t/test01.t t/test02.t" 
```

如果所有测试都具有相似的名称，您通常也可以使用 shell 通配符指定它们

```
make test TEST_FILES=t/test0[12].t 
```

# regex - Perl 正则表达式删除除最后一次出现之外的所有内容

> ID：14677871
> 
> 赞同：2
> 
> 时间：2013-02-03T22:06:35.210
> 
> 标签：regex, perl

我正在尝试使用命令行“重命名”来更改一些包含多个句点的文件名。例如：`this.is.a.file.name.txt`

环顾四周后，我发现了一些几乎可以让我到达那里的例子，但我似乎无法让它按要求工作。不用说，我是一个非常熟悉正则表达式的初学者。

我试过这个：

```
rename -v -n 's/\.(.+?)(?=\.)//' this.is.a.file.name.txt 
```

结果是：

```
this.a.file.name.txt 
```

我试图修改以下资源中的示例，但我被卡住了。 [PHP正则表达式：选择除最后一次出现的所有](https://stackoverflow.com/questions/7718905/php-regex-select-all-except-last-occurrence) [正则表达式不替换最后一次出现的匹配项](https://stackoverflow.com/questions/7175859/regex-not-replacing-the-last-occurrence-of-a-match)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T22:28:34.953

由于几个原因，您的正则表达式不太正确。首先，您要替换空字符串的内容应该只是句点，而您正在从句点匹配下一个句点的所有内容并将其删除。另外，你只做一次。

您想要的正则表达式是`/\.(?=.*\.)//g`，它表示匹配一个句点，然后是任意数量的字符的零宽度断言和另一个句点，并尽可能多地执行此操作。

# php - 我怎样才能阅读这个 JSON？

> ID：14677878
> 
> 赞同：0
> 
> 时间：2013-02-03T22:07:19.977
> 
> 标签：php, json

我正在尝试阅读 twitch.tv API，但出了点问题。

这是我作为响应得到的 JSON 数据：http: [//pastebin.com/uzx4LXJg](http://pastebin.com/uzx4LXJg)

这是PHP代码。

```
$curl = curl_init();    
curl_setopt($curl, CURLOPT_URL, "https://api.twitch.tv/kraken/streams?game=League+of+Legends");
curl_setopt($curl, CURLOPT_HEADER, FALSE); 
curl_setopt($curl, CURLOPT_NOBODY, FALSE); 
curl_setopt($curl, CURLOPT_REFERER,""); 
curl_setopt($curl, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']); 
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true); 

$response = curl_exec($curl);
$json_array = json_decode($response, true);

echo $json_array['streams']['viewers'] . 'aaa'; 
```

它只显示“aaa”。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T22:08:42.853

`steams`是一个对象数组，而不是单个对象。您需要选择一个索引（或使用 for 循环）。

# c# - C# 从网络摄像头捕获图像

> ID：14677880
> 
> 赞同：15
> 
> 时间：2013-02-03T22:07:27.887
> 
> 标签：c#, image, file, webcam, capture

过去两天我一直在寻找一种使用 C# 从网络摄像头捕获图像的方法。我是 C# 的新手，我不想使用外部第三方库，所以我找到了两种不错的方法，但似乎都返回几乎相同的错误。我无法让它们中的任何一个工作，所以如果你帮助我让其中一个运行或帮助我找到替代方案，那就太好了。

所以我发现的第一种方法是使用 Windows WIA。我找到了以下代码：

```
CommonDialogClass dialog = new CommonDialogClass();
Device camera = dialog.ShowSelectDevice(WiaDeviceType.CameraDeviceType, true, false);
        // take the photo 
Item item = camera.ExecuteCommand(CommandID.wiaCommandTakePicture);
ImageFile image = (ImageFile)item.Transfer(FormatID.wiaFormatJPEG);
        // filename and saving 
image.SaveFile("Test.jpg"); 
```

这段代码似乎正是我正在寻找的，但我无法让它运行，因为我在第二行收到以下错误：

```
Exception from HRESULT: 0x80210015 
```

我发现的第二种方法是使用带有以下示例的 Avicap32.dll：

```
http://www.timvw.be/wp-content/code/csharp/testavicap32.zip 
```

但我正在使用这段代码：

```
Image image = ((CaptureDevice)cboDevices.SelectedItem).Capture();
image.Save(@"c:\capture.png", ImageFormat.Png); 
```

以下异常： NullReferenceException：对象引用未设置为对象的实例。

我认为这两种解决方案都引起了问题，因为他们找不到我的相机，但我可以在 Skype 中使用我的相机而没有任何问题。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-08-24T19:13:20.917

我尝试了多种方法，对我来说最简单的方法是 Emgu.cv(nuget package)。

```
 VideoCapture capture = new VideoCapture(); //create a camera capture
        Bitmap image = capture.QueryFrame().Bitmap; //take a picture 
```

就是这样（从 API 版本 3.3.0 开始）

**旧 API 方法**

```
 Capture capture = new Capture(); //create a camera captue
        Bitmap image = capture.QueryFrame().Bitmap; //take a picture 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-03T22:19:22.490

*   WIA 用于静止图像，它是一种“与扫描仪配合使用的 API”；`0x80210015`是[`WIA_S_NO_DEVICE_AVAILABLE`](http://alax.info/blog/1383)
*   AVICAP32 API 名称是“Video for Windows”，它确实已被弃用和过时，它可能会奏效（兼容性仍然存在）但很有可能它会让你无处可去

与网络摄像头配合使用的 API 包括：

*   直接秀
*   媒体基金会

两者都是本机 API，您可能很难直接从 C# 代码接口它们，但是使用[DirectShow.NET](http://directshownet.sourceforge.net/)（尤其是）和 Media Foundation.NET，您有托管代码的包装器。您可以在此处找到有关使用 DirectShow.NET 的更多信息：

*   [使用 DirectShow.NET 从网络摄像头捕获帧](https://stackoverflow.com/questions/7750879/capturing-frames-from-webcam-using-directshow-net)
*   [DirectShow 库 - 如何使用 directshow 库捕获图像而不在 PictureBox 或 Panel 上显示网络摄像头实时图像](https://stackoverflow.com/questions/13295667/directshow-library-how-to-capture-image-using-directshow-library-without-showing/13300324#13300324)
*   [从网络摄像头获取图像](https://stackoverflow.com/questions/12726880/get-image-from-webcam/12727085#12727085)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-31T21:23:36.853

我推荐[Aforge.net 框架](http://www.aforgenet.com/framework/)。

它能够实现示例项目中使用的[videoCaptureDevice 类：](http://www.aforgenet.com/framework/docs/html/f4d3c2ba-605c-f066-f969-68260ce5e141.htm) [Snapshot Maker 示例](http://www.aforgenet.com/framework/samples/video.html)以快速创建图像捕获对话框。它比 [DirectShow 库慢一点 - 如何使用 directshow 库捕获图像而不在 PictureBox 或面板上显示网络摄像头实时图像，](https://stackoverflow.com/questions/13295667/directshow-library-how-to-capture-image-using-directshow-library-without-showing/13300324#13300324)但它很稳定，并且是从支持的设备设置视频和图像分辨率的简单方法。

我遇到的唯一问题是 VideoCaptureDevice.SimulateTrigger() 使用 bacjground 线程从视频源创建图像并在事件中返回图像。如果将返回的图像放在 UI 线程上的 winform 控件上，则需要委托方法以防止跨线程问题。

从 Aforge.net 源[SVN 链接](http://aforge.googlecode.com/svn/trunk/)获取 Snapshot Maker 项目的源代码。

# c++ - 复制构造函数只需进行一项更改：我可以获得默认的复制构造函数来完成其余的工作吗？

> ID：14677882
> 
> 赞同：1
> 
> 时间：2013-02-03T22:07:32.723
> 
> 标签：c++

假设我有一个包含一些字段的结构，我可能会弄乱它们（添加、删除）。

```
struct Something
{
 int number;
 int stuff[4];

 //... many other things

 Something(const Something& something, int newnumber) : number(newnumber)
 {
  //is there any way to default the rest to copy?
 }
}; 
```

我没有声明一个复制构造函数（使用默认值），所以它显然可以处理任何基本情况（没有指针等）。但是，我也希望能够通过改变一件事来复制我的结构。这意味着我需要填写一个包含所有要复制的内容的初始化列表，并在每次我的结构内容更改时更改它。即使我未声明的复制构造函数可以方便地处理更改而无需我的干预。

有什么办法可以利用默认的复制构造函数，这样我就不必在每次弄乱我的结构内容时更改我的“一次更改复制”构造函数？

编辑：构造函数委托导致这些错误：

```
Something(const Something& something, int newnumber) : Something(something), number(newnumber) {} 
```

对委托构造函数的调用应是唯一的成员初始化器
“编号”：已初始化

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:10:24.077

不幸的是，不，除非您将默认构造代码分解为一个单独的函数，并从该函数和复制构造函数中调用它。

但是，构造委托[在 c++11](http://en.wikipedia.org/wiki/C++11#Object_construction_improvement)中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T03:33:31.777

> 对委托构造函数的调用应该是唯一的成员初始化器

您不能这样做，因为默认构造函数已经初始化`number`，因此您将初始化`number`两次。你能做的最好的就是在ctor体内移动 number(newnumber) ，即`number = newnumber;`。作为一般规则，您应该将逻辑放在具有大多数参数的构造函数中，并将所有其他构造函数委托给它（尽管在您的示例中这可能是不可能的）。

# asp.net-mvc - Automapper 缺少类型映射配置或不支持的映射 - 错误

> ID：14677889
> 
> 赞同：112
> 
> 时间：2013-02-03T22:08:19.323
> 
> 标签：asp.net-mvc, automapper

实体模型

```
public partial class Categoies
{
    public Categoies()
    {
        this.Posts = new HashSet<Posts>();
    }

    public int Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public Nullable<int> PositionId { get; set; }

    public virtual CategoryPositions CategoryPositions { get; set; }
    public virtual ICollection<Posts> Posts { get; set; }
} 
```

查看模型

```
public class CategoriesViewModel
{
    public int Id { get; set; }

    [Required(ErrorMessage = "{0} alanı boş bırakılmamalıdır!")]
    [Display(Name = "Kategori Adı")]
    public string Name { get; set; }

    [Display(Name = "Kategori Açıklama")]
    public string Description { get; set; }

    [Display(Name = "Kategori Pozisyon")]
    [Required(ErrorMessage="{0} alanı boş bırakılmamalıdır!")]
    public int PositionId { get; set; }
} 
```

创建地图

```
Mapper.CreateMap<CategoriesViewModel, Categoies>()
            .ForMember(c => c.CategoryPositions, option => option.Ignore())
            .ForMember(c => c.Posts, option => option.Ignore()); 
```

地图

```
[HttpPost]
public ActionResult _EditCategory(CategoriesViewModel viewModel)
{
    using (NewsCMSEntities entity = new NewsCMSEntities())
    {
        if (ModelState.IsValid)
        {
            try
            {
                category = entity.Categoies.Find(viewModel.Id);
                AutoMapper.Mapper.Map<CategoriesViewModel, Categoies>(viewModel, category);
                //category = AutoMapper.Mapper.Map<CategoriesViewModel, Categoies>(viewModel);
                //AutoMapper.Mapper.Map(viewModel, category);
                entity.SaveChanges();

                // Veritabanı işlemleri başarılı ise yönlendirilecek sayfayı 
                // belirleyip ajax-post-success fonksiyonuna gönder.
                return Json(new { url = Url.Action("Index") });
            }
            catch (Exception ex)
            {

            }
        }

        // Veritabanı işlemleri başarısız ise modeli tekrar gönder.
        ViewBag.Positions = new SelectList(entity.CategoryPositions.ToList(), "Id", "Name");
        return PartialView(viewModel);
    }
} 
```

错误

> 缺少类型映射配置或不支持的映射。映射类型：CategoriesViewModel - > Categoies_7314E98C41152985A4218174DDDF658046BC82AB0ED9E1F0440514D79052F84D NewsCMS.Areas.Admin.Models.CategoriesViewModel - > System.Data.Entity.DynamicProxies.Categoies_7314E98C41152985A4218174DDDF658046BC82AB0ED9E1F0440514D79052F84D
> 
> 目标路径：Categoies_7314E98C41152985A4218174DDDF658046BC82AB0ED9E1F0440514D79052F84D
> 
> 源值：NewsCMS.Areas.Admin.Models.CategoriesViewModel

我错过了什么？我试图找到，但我看不到问题。

**更新**

我在 Global.asax 的 application_start 中指定

```
protected void Application_Start()
{
    InitializeAutoMapper.Initialize();
} 
```

初始化类

```
public static class InitializeAutoMapper
{
    public static void Initialize()
    {
        CreateModelsToViewModels();
        CreateViewModelsToModels();
    }

    private static void CreateModelsToViewModels()
    {
        Mapper.CreateMap<Categoies, CategoriesViewModel>();
    }

    private static void CreateViewModelsToModels()
    {
        Mapper.CreateMap<CategoriesViewModel, Categoies>()
            .ForMember(c => c.CategoryPositions, option => option.Ignore())
            .ForMember(c => c.Posts, option => option.Ignore());
    }
} 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-02-03T22:48:08.783

您在哪里指定了映射代码（CreateMap）？参考：[我在哪里配置 AutoMapper？](http://automapper.readthedocs.io/en/latest/Getting-started.html#where-do-i-configure-automapper)

> 如果您使用的是静态 Mapper 方法，则每个 AppDomain 只应进行一次配置。这意味着放置配置代码的最佳位置是在应用程序启动中，例如用于 ASP.NET 应用程序的 Global.asax 文件。

如果在调用 Map 方法之前没有注册配置，您将收到`Missing type map configuration or unsupported mapping.`

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2014-11-13T11:54:18.113

在您的类`AutoMapper`配置文件中，您需要为您的实体和视图模型创建一个映射。

### ViewModel 到域模型映射：

这通常在`AutoMapper/DomainToViewModelMappingProfile`

在`Configure()`中，添加一行

```
Mapper.CreateMap<YourEntityViewModel, YourEntity>(); 
```

### 域模型到 ViewModel 映射：

在`ViewModelToDomainMappingProfile`中，添加：

```
Mapper.CreateMap<YourEntity, YourEntityViewModel>(); 
```

* * *

[要点示例](https://gist.github.com/Pierry/a0ca1ca54a7b63cf2104)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-02-03T23:10:36.557

注意`Categoies_7314E98C41152985A4218174DDDF658046BC82AB0ED9E1F0440514D79052F84D`异常中的类？那是一个实体框架代理。我建议您处理您的 EF 上下文，以确保您的所有对象都从数据库中急切加载并且不存在此类代理：

```
[HttpPost]
public ActionResult _EditCategory(CategoriesViewModel viewModel)
{
    Categoies category = null;
    using (var ctx = new MyentityFrameworkContext())
    {
        category = ctx.Categoies.Find(viewModel.Id);
    }
    AutoMapper.Mapper.Map<CategoriesViewModel, Categoies>(viewModel, category);
    //category = AutoMapper.Mapper.Map<CategoriesViewModel, Categoies>(viewModel, category);
    entity.SaveChanges();
} 
```

如果实体检索是在数据访问层内执行的（这当然是正确的方法），请确保在从 DAL 返回实例之前处置 EF 上下文。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2020-11-05T18:23:27.793

我试图将 IEnumerable 映射到对象。这就是我得到这个错误的方式。也许它有帮助。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-07-22T22:16:46.390

我这样做是为了消除错误：

```
Mapper.CreateMap<FacebookUser, ProspectModel>();
prospect = Mapper.Map(prospectFromDb, prospect); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-09-05T20:43:19.540

我在 .Net Core 中遇到了同样的问题。因为我的基础 dto 类（我将它作为 automapper 程序集的启动类型）在不同的项目中。Automapper 试图在基类项目中搜索配置文件。但我的 dto 在不同的项目中。我移动了我的基类。并且问题解决了。这可能对某些人有所帮助。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-02-03T23:35:11.313

我找到了解决方案，谢谢大家的回复。

```
category = (Categoies)AutoMapper.Mapper.Map(viewModel, category, typeof(CategoriesViewModel), typeof(Categoies)); 
```

但是，我已经不知道原因了。我无法完全理解。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-10-20T13:14:25.910

检查您的 Global.asax.cs 文件并确保该行存在

```
 AutoMapperConfig.Configure(); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2020-10-08T14:19:32.003

就我而言，我创建了地图，但缺少 ReverseMap 函数。添加它消除了错误。

```
 private static void RegisterServices(ContainerBuilder bldr)
      {
         var config = new MapperConfiguration(cfg =>
         {
            cfg.AddProfile(new CampMappingProfile());
         });
         ...
       }

      public CampMappingProfile()
      {
         CreateMap<Talk, TalkModel>().ReverseMap();
         ...
      } 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-06-12T00:16:48.283

我知道这是一个相当古老的问题，但我发现正确的解决方案是我没有声明程序集属性。

我的代码是：

```
using AutoMapper;
...

namespace [...].Controllers
{
    public class HousingTenureTypesController : LookupController<HousingTenureType, LookupTypeModel>
    {
        Mapper.CreateMap<HousingTenureType, LookupTypeModel>().ReverseMap();
    }
    ...
} 
```

通过在我的命名空间声明之前添加以下行来解决此问题：

```
[assembly: WebActivatorEx.PreApplicationStartMethod(typeof(HousingTenureTypesController), "AutoMapperStart")] 
```

完整的代码是：

```
using AutoMapper;
...

[assembly: WebActivatorEx.PreApplicationStartMethod(typeof(HousingTenureTypesController), "AutoMapperStart")]

namespace [...].Controllers
{
    public class HousingTenureTypesController : LookupController<HousingTenureType, LookupTypeModel>
    {
        Mapper.CreateMap<HousingTenureType, LookupTypeModel>().ReverseMap();
    }
    ...
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-11-15T11:43:26.527

从 AutoMapper v.3 更新到 v.5 后，我们遇到了同样的错误。

最终我们发现目标类具有类型为 IDictionary<string, object> 的 Property，并且在同一类型的 Profile 映射中是有效的。

有下一个可能的解决方案：

1.  更新到更高版本。在 v.6 中，该错误消失了。
2.  或者忽略映射中的那个道具。
3.  或者使用方法`Mapper.Map<IFooDto>(foo) instead of Mapper.Map(foo, fooDto).`

我们的配置文件就像使用接口作为目标：

```
public class FooProfile : Profile
{
    public FooProfile()
    {
        CreateMap<Foo, IFooDto>()
            .ConstructUsing(foo => new FooDto());
    }
} 
```

另外我应该提到，在从 v.3 更新到更高版本的过程中，与旧版本相比，我们遇到了许多错误和差异，以及对我们有帮助的：

*   每次检查下一个版本是否会修复错误；
*   仔细检查现有的映射配置。它可能有旧的隐藏错误，例如在没有设置器的情况下映射到属性或现有的重复映射等。并且可能是旧版本允许这样做，而新版本则不允许。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-12-21T12:41:19.043

将 Automapper 升级到版本 6.2.2。它帮助了我

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2019-09-16T20:37:56.003

我创建了一个新的 AutomapperProfile 类。它扩展了 Profile。我们的解决方案中有 100 多个项目。许多项目都有一个 AutomapperProfile 类，但这个对于现有项目来说是新的。但是，我确实找到了必须做的事情来为我们解决这个问题。有一个绑定项目。在初始化中有以下代码：

```
var mappingConfig = new List<Action<IConfiguration>>();

// Initialize the Automapper Configuration for all Known Assemblies
mappingConfig.AddRange( new List<Action<IConfiguration>>
{
   ConfigureProfilesInAssemblyOfType<Application.Administration.AutomapperProfile>,
   //... 
```

我必须添加 ConfigureProfilesInAssemblyOfType< *MyNewNamespace* .AutomapperProfile>

请注意，ConfigureProfilesInAssemblyOfType 如下所示：

```
 private static void ConfigureProfilesInAssemblyOfType<T>( IConfiguration configuration )
    {
        var log = LogProvider.Get( typeof (AutomapperConfiguration) );

        // The Automapper Profile Type
        var automapperProfileType = typeof (Profile);

        // The Assembly containing the type
        var assembly = typeof (T).Assembly;
        log.Debug( "Scanning " + assembly.FullName );

        // Configure any Profile classes found in the assembly containing the type.
        assembly.GetTypes()
            .Where( automapperProfileType.IsAssignableFrom ).ToList()
            .ForEach( x =>
            {
                log.Debug( "Adding Profile '" + x.FullName + "'" );
                configuration.AddProfile( Activator.CreateInstance( x ) as Profile );
            } );
    } 
```

最好的问候，-杰夫

# php - 使用 Mod Rewrite 重写地址？

> ID：14677892
> 
> 赞同：0
> 
> 时间：2013-02-03T22:08:34.953
> 
> 标签：php, .htaccess, mod-rewrite

我有以下格式：

```
mydomain.com/whois.php?domain=google&ext=com&option=whois 
```

我想使用 mod-rewrite 新地址，例如：

```
mydomian.com/google.com 
```

我使用这条线，但不起作用：

```
RewriteRule ^([a-zA-Z0-9]*).([a-zA-Z0-9]+) whois.php?domain=$1&ext=$2&option=whois [L] 
```

请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:13:29.057

您需要在 .htaccess 文件中使用它

```
RewriteEngine on
RewriteRule ^([a-z0-9-]+)\.([a-z]+)(\.([a-z]{2}))?$ /whois.php?domain=$1&tld=$2&co=$4&option=whois [NC,L] 
```

请注意，我对您的正则表达式和变量名称进行了一些更改。ext 现在是 tld（顶级域，例如 com）

*   `/`在 whois.php 之前添加。将 .htaccess 文件与 whois.php 放在同一文件夹中。
*   添加的变量`co`（国家域）可能有也可能没有值。
*   `NC`使正则表达式与标志不区分大小写。
*   摆脱了`A-Z`，因为它现在不区分大小写。
*   用 .转义了点 ( `.`) `\`。
*   添加`-`到域中可能的字符。
*   从 更改`*`为`+`域中的字符数，因为您希望至少有 1 个字符，对吗？
*   摆脱`0-9`了顶级域名和国家域名。

**更新**

如果您不希望更改 whois.php 中的 URL 变量以反映我建议的更改，那么我提供了这个新行，它应该可以在不更改 whois.php 的情况下工作

```
RewriteRule ^([a-z0-9-]+)\.([a-z]+)(\.[a-z]{2})?$ /whois.php?domain=$1&ext=$2$3&option=whois [NC,L] 
```

# git - git push 和输入密码的问题

> ID：14677896
> 
> 赞同：3
> 
> 时间：2013-02-03T22:07:52.137
> 
> 标签：git, bitbucket

我刚刚在 bitbucket 上设置了一个帐户，并第一次尝试导入我的存储库。

我输入这个命令：

git push -u origin --all

然后提示我输入密码。当我点击输入时，插入了一个新行，没有任何反应。我还可以在屏幕上看到我的密码。例如，如果我的密码是“mypassword”，这就是我运行命令后的样子，按回车键，输入密码并按回车键：

![在此处输入图像描述](../Images/d4aba3afa9f6ae7a0be8ad4f04808aa3.png)

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-22T16:55:37.337

哦，这篇文章很老了，但是，

设置远程存储库时尝试使用：

```
git remote set-url origin https://username@bitbucket.org/username/repo.git 
```

代替：

```
git remote add origin https://username@bitbucket.org/username/repo.git 
```

它对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:10:05.557

如果您尝试从现有的 bitbucket 存储库中获取代码，则需要运行以下命令：

`git clone https://<your-user-name>@bitbucket.org/<your-user-name>/<project-name>.git`

但是，如果您尝试从本地 git 存储库将代码推送到您的 bitbucket a/c，请参阅此处以获取更多帮助：[从现有项目导入代码](https://confluence.atlassian.com/display/BITBUCKET/Importing+code+from+an+existing+project)

查看“**将现有的未版本化代码项目导入空存储库**”部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T05:07:50.957

如果您像我一样在 bitbucket 上使用 ssh 身份验证时遇到问题；这就是我修复它的方法。Bitbucket 希望我可以从文档中收集到的每个用户都有自己的单独 ssh 密钥。

使用您的默认方法专门为 bitbucket 创建一个新的 ssh 密钥（我们将调用 ssh 密钥“id_pub_my_user_name.pub”）并在 ~/.ssh/config 中放置类似以下内容：

```
# bitbucket user - my_user_name
Host bitbucket.org
  HostName bitbucket.org
  User my_user_name
  IdentityFile ~/.ssh/id_rsa_my_user_name 
```

如果您现在在终端中输入：

```
ssh -T git@bitbucket.org 
```

它现在将显示您已通过身份验证，您可以愉快地从那里继续。

# c# - 使用数据集加载组合框并加载默认值

> ID：14677899
> 
> 赞同：0
> 
> 时间：2013-02-03T22:09:06.173
> 
> 标签：c#, winforms

我正在用 C# 创建一个 Windows 窗体应用程序，并且正在从 asp.net 窗体应用程序中翻译它。我遇到了一个我似乎无法得到答案的差异。我已经加载了一个包含数据集中项目的组合框，但我希望第一个项目说 Select... 或类似的东西，而不是只显示数据集中的第一个项目。在 asp.net 中，我只想说

```
ddSelected.Items.Insert(0, "Select..."); 
```

但是在这里我得到一个错误：设置 DataSource 属性时无法修改 Items 集合。

如何在 C# 中为 Windows 窗体执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:28:40.717

此解决方案可能会为您指明正确的方向，但这完全取决于您的`DataSource`对象类型。

想象这样一个场景：

```
 BindingList<string> myList = new BindingList<string>();
    myList.Add("Mark");
    myList.Add("Joe");
    myList.Add("Kelly");
    myList.Add("Susan");
    comboBox1.DataSource = myList; 
```

您所要做的就是更新您的 myList 并且`ComboBox`项目将更新：

```
 myList.Insert(0, "Select..."); 
```

请注意，这将与 a 无缝协作，[`BindingList`](http://msdn.microsoft.com/en-us/library/ms132679.aspx)因为它实现了[`IRaiseItemChangedEvents`](http://msdn.microsoft.com/en-us/library/System.ComponentModel.IRaiseItemChangedEvents.aspx).

如果您的底层证券`DataSource`是一个诸如 an 之类的对象`ArrayList`，那么为了“刷新”这些`ComboBox`项目，您需要执行以下操作：

```
 comboBox1.DataSource = null;
    comboBox1.DataSource = myList; 
```

这是因为`ArrayList`该类本身不会引发事件来通知任何绑定控件集合已更改。

1.  更新您的基础数据源。
2.  **如有必要，**通过设置更新您的`ComboBox` `Datasource`属性`null`并返回到您的基础数据源。

# sqlite - Sinatra 在填充 SQLite 表后请求超时

> ID：14677901
> 
> 赞同：1
> 
> 时间：2013-02-03T22:09:39.563
> 
> 标签：sqlite, sinatra, datamapper

我现在正试图调试这个几个小时，但我没有取得任何进展。我使用 DataMapper 作为 ORM，使用 SQLite 作为数据库系统：

```
DataMapper.setup(:default, 'sqlite:db.sqlite') 
```

我有两个模型`User`和`Game`. 当我向第一个模型添加字段时，一切正常。一旦我添加一个字段`Game`（通过 Sinatra 路由或 IRB），所有对 Sinatra 的 HTTP 请求都会超时。所有这些，包括静态资产。我仍然可以通过 IRB ( `Game.all`) 访问所有数据库信息。

当我清空数据库 ( `DataMapper.auto_migrate!`) 并重新启动服务器 (shotgun + Thin) 时，一切都恢复正常了。

我知道这可能很难回答，但没有任何错误，而且我不知道如何调试它，所以如果你们能指出我正确的方向，我将不胜感激。

* * *

那是`Game`模型：

```
class Game
  include DataMapper::Resource

  property :id, Serial
  property :active, Boolean, default: true
  property :players, Object

  property :name, String, required: true
  property :size, Integer
  property :filled_size, Integer, default: 1
end 
```

也许我正在使用 SQLite 不支持的某种类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:22:02.420

我终于解决了这个问题！

我将我的应用程序推送到heroku，看看它是否是一些本地问题。当应用程序在 heroku 上崩溃时，我得到了一个堆栈跟踪作为我的 AJAX 请求的响应，但我没有在本地得到一个（应该是相反的，我知道）。问题是我正在调用`to_json`DataMapper 模型。我现在正在使用[dm-serializer](https://github.com/datamapper/dm-serializer)，它工作正常。

# jpa - JPA 递归左外连接

> ID：14677905
> 
> 赞同：1
> 
> 时间：2013-02-03T22:10:11.987
> 
> 标签：jpa, many-to-many, jpql, recursive-query

我有一个实体`Status`，它（除其他外）与其自身具有多对多关系，代表“可能的下一个状态”。

这个想法是能够创建状态之间转换的“地图”。

现在，我正在尝试生成一个尚未链接到给定状态的状态列表，以填充“链接到此状态”表单中的组合框（换句话说，我想要那些可以链接的状态） .

到目前为止，我已经找到了 25 种不这样做的方法。:)

好的，所以很多人都在询问更多细节——我认为就合理的数据库设计而言，有些事情是理所当然的（实际上它们对于答案并不重要）。

a) 所有状态都有一个且只有一个 KEY 列，即它们的主键。

b) 状态通过连接表相互“连接”，该连接表有 2 个外键，都是状态的主键。

c) 如果我有状态 A、B、C 和 D - 并且我已经将状态 B 和 C 链接到 A，所以我有：A -> B 和 A -> C 目的是找到这些状态存在在状态表中，尚未连接到“A”。当我说“A”时，我的意思是作为参数给出的状态。所以，如果我正在查看状态 A，我希望所有未连接到“A”的人。如果我正在查看状态 CI，则无论它们是否连接到不同的状态，都希望所有未连接到状态 C 的人。

任何帮助，将不胜感激。我不是在逐字寻找确切的查询，而是在寻找“可以完成的方式”。我会很容易地弄清楚如何在我的特定数据库设计中应用该原则，但我找不到要应用的“原则”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T08:51:48.480

```
select notLinkedStatus from Status notLinkedStatus
where notLinkedStatus.id not in
    (select linkedStatus.id from Status status
     inner join status.linkedStatuses linkedStatus
     where status.id = :theStatusId) 
```

# ruby-on-rails - 在rails中使用form_tag的回形针

> ID：14677908
> 
> 赞同：2
> 
> 时间：2013-02-03T22:10:35.643
> 
> 标签：ruby-on-rails, paperclip

我正在尝试让回形针与 rails 应用程序一起使用，但到目前为止还没有成功。请帮我这样做；我在下面包含了我认为相关的信息，并将回答问题。

它将上传照片的名称保存到数据库中，并且似乎有一个路径：

```
[13] pry(main)> Order.last
  Order Load (0.3ms)  SELECT "orders".* FROM "orders" ORDER BY "orders"."id" DESC LIMIT 1
=> #<Order id: 22, quantity: 13, created_at: "2013-02-03 21:47:46", updated_at: "2013-02-03 21:47:46", user_id: 8, drawing_file_name: "friends.jpg", drawing_content_type: nil, drawing_file_size: nil, drawing_updated_at: nil>
[14] pry(main)> Order.last.drawing
  Order Load (0.2ms)  SELECT "orders".* FROM "orders" ORDER BY "orders"."id" DESC LIMIT 1
=> /system/orders/drawings/000/000/022/original/friends.jpg 
```

然而：

*   我在该路径下、我的系统上或应用程序文件中找不到任何内容
*   [从像这样](https://stackoverflow.com/questions/4221076/paperclip-not-saving-no-errors)的其他答案来看，我从表单传递的参数哈希似乎应该有更多的内容；现在只是一个字符串名称，看起来太短了

    ```
    [2] pry(#<OrdersController>)> params
     => {"utf8"=>"✓", "authenticity_token"=>"eTInEukPQ84uIw3TPIdI+u0zo49dQlY68gxrodIoPdA=", "quantity_field"=>"34", "drawing_field"=>["friends.jpg"], "supplier_list"=>["1", "2"], "commit"=>"Create order", "multipart"=>"true", "action"=>"create", "controller"=>"orders"} 
    ```

订单.rb

```
class Order < ActiveRecord::Base
  attr_accessible :quantity, :drawing
  has_attached_file :drawing,
                                    :url => "/:attachment/:id/:style/:basename.:extension",
                                    :path => ":rails_root/public/:attachment/:id/:style/:basename.:extension" 
```

_form.html.erb

```
<%= form_tag :action => 'create', :controller => 'orders', :multipart => true do %>

....

<div>
  <%= file_field :order, :drawing %>
  <%= label_tag :drawing, 'Attach drawing here' %>
</div>

<%= submit_tag "Create order", :disable_with => "Creating..." %> 
```

订单控制器.rb

```
def create

#binding.pry

@order = Order.new#(params[:order])
@order.quantity = params[:quantity_field]
@order.user_id = current_user.id
@order.drawing = params[:order][:drawing]
did_order_save = @order.save

.... 
```

当我尝试下新订单时，我得到：

```
 Started POST "/orders?multipart=true" for 127.0.0.1 at 2013-02-05 20:07:20 -0800
Processing by OrdersController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"eTInEukPQ84uIw3TPIdI+u0zo49dQlY68gxrodIoPdA=", "quantity_field"=>"334", "order"=>{"drawing"=>"profileBox.png"}, "supplier_list"=>["1"], "commit"=>"Create order", "multipart"=>"true"}
  User Load (0.2ms)  SELECT "users".* FROM "users" WHERE "users"."remember_token" = 'kGRbFvLaYseFaHvRR6sy6w' LIMIT 1
Completed 500 Internal Server Error in 19882ms

Paperclip::AdapterRegistry::NoHandlerError (No handler found for "profileBox.png"):
  app/controllers/orders_controller.rb:54:in `create' 
```

我已经安装了回形针/imagemagick，已经完成了迁移并确认了 drawing_file_name 等在数据库中，并且已经重新启动了服务器。

# android - 如何修复这个涉及线程的 Android 内存泄漏？

> ID：14677913
> 
> 赞同：8
> 
> 时间：2013-02-03T22:10:58.210
> 
> 标签：android, memory-leaks

所以我发现，随着我`MAT`不断创造多个`Threads``surfaceCreate`

不过，我认为我需要这些线程，但是`ViewThread`当用户浏览我的应用程序时，这种方法会导致多个实例，这是内存泄漏。

如何重新组织创建和处理线程的方式，以免发生这种情况，或者如何阻止泄漏的发生？

```
@Override
public void surfaceCreated(SurfaceHolder holder) {
    loading=false;
    if (!mThread.isAlive()){
        mThread = new ViewThread(this);
        mThread.setMenuRunning(true);
        mThread.start();
    }
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {

    if (mThread.isAlive()){ 
        mThread.setMenuRunning(false);
    }
} 
```

`Career`我五次打开并离开游戏的活动，这就是显示在`MAT`

![泄漏](../Images/3976de775cf8b7b09a3dcef7e3cb48eb.png)

编辑：从那以后，我发现依赖于`surfaceDestroyed`我的线程的破坏是不可靠的。我现在从不同的方法调用适当的线程破坏调用，触发`onPause`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T08:22:37.777

您应该使用 Wea​​kReference 来引用您线程中的职业。这样，当没有更多对职业的硬引用时，引用将被清除。

您可以通过右键单击职业并选择 Path To GC Roots 来跟踪 MAT 中的所有引用，然后使用所有引用。这将向您显示内存中保留的对象的路径。确保在完成活动后清除这些引用，或者使用 Wea​​kReferences 让 GC 自动清除它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T02:28:44.193

在内部`surfaceDestroyed`，您应该*等待*以确保线程在返回之前停止。

您可以参考[这个问题](https://stackoverflow.com/questions/7227624/android-surfaceview-threads-and-memory-leaks)，了解更多详情

```
@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    boolean retry = true;
    mThread.setRunning(false);
    while (retry) {
        try {
            mThread.join();
            retry = false;
        } catch (InterruptedException e) {
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T06:26:31.227

所以我通过评论一行来修复它：

```
@Override
public void surfaceCreated(SurfaceHolder holder) {
    loading=false;
    if (!mThread.isAlive()){
        //mThread = new ViewThread(this);
        mThread.setMenuRunning(true);
        mThread.start();
    }
} 
```

这也与答案`WeakReference`和`SurfaceDestroyed`答案结合在一起。稍后我将对其进行测试，并确定是否只是删除了那一行，还是那一行与弱引用的组合，或其他事情，然后授予答案

# c - 如何计时事件

> ID：14677916
> 
> 赞同：0
> 
> 时间：2013-02-03T22:11:49.900
> 
> 标签：c, sockets, tcp

处理定时事件的最佳实践是什么`C`？我正在查看的场景是，如果我在一秒钟内没有收到来自服务器的响应，我需要将数据从客户端重新发送到服务器。

代码会很好，但对概念的解释会更有价值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:21:58.663

大多数操作系统都有某种形式的计时器。在 Linux/Unix/Posix 你有[`alarm`](http://linux.die.net/man/2/alarm)，在 Windows 有[`SetTimer`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms644906%28v=vs.85%29.aspx)

因此，基本上，您发送一条消息，并将计时器设置为您希望得到回复的时间 - 1 秒、10 秒、30 秒 - 任何对您的情况有意义的时间。

如果您收到回复，则取消计时器，并执行您计划对回复执行的任何其他操作。如果在计时器触发之前没有回复到达，则再次发送[这可能意味着“发出信号量或标志”以再次发送，而不是在计时器的处理程序中实际执行此操作]。

对于其他操作系统，您必须告诉我们您正在查看的内容，但大多数操作系统都有某种机制来处理“告诉我 X 时间已过”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:20:40.710

这需要客户端和服务器之间的事先同步。此外，您必须有一个用于事件管理的库。[计时器和 I/O 事件管理器库](http://www.corpit.ru/mjt/event.html)中提到了此类库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T02:55:28.667

如果您的程序使用非阻塞 I/O 并在 select() 或 poll() 内部进行阻塞，则这些函数有一个可选的 timeout 参数，可让您指定 select()/poll() 调用应在即使没有发生 I/O 事件，也已经过了一定的时间。您可以使用该功能让您的程序每隔一段时间执行一项操作。

# user-interface - RPG Maker XP 使用了什么小部件工具包？

> ID：14677918
> 
> 赞同：-1
> 
> 时间：2013-02-03T22:12:04.000
> 
> 标签：user-interface, widget

我想创建一些看起来与 RPG maker 看起来完全一样的东西，有人知道他们使用了什么小部件工具包吗？

[![一只忙碌的猫](../Images/6edc94cefcbce5bf57b416f484fba71e.png)](https://i.stack.imgur.com/jwxDv.gif)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:17:07.777

为什么不问他们？他们甚至可能会说出来。

# .net - 如何在 mysql 社区服务器上创建数据库？

> ID：14677922
> 
> 赞同：0
> 
> 时间：2013-02-03T22:12:16.743
> 
> 标签：.net, mysql

我刚刚安装了 .NET 连接器和 MySql 社区服务器，以便创建一个基于通过 LAN 连接到服务器的应用程序。

在我的计算机上运行服务器并键入后，`status`我看不到数据库名称。
我要做的是创建一个`myDb`内部包含 2 个表的数据库`users`，`tasks`并且我需要在每个表上添加一些列。

如何以及创建数据库、表和列的最简单方法是什么，是否有用于执行此操作的 GUI？

![在此处输入图像描述](../Images/ad102fbfbd7e49fab975bf09a07fce30.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:30:06.083

通过 GUI 完成此操作的最简单方法是下载并安装[MySQL Workbench](http://dev.mysql.com/downloads/workbench/)`SCHEMA` ，然后在其中创建表。

# vba - 如何格式化突出显示的文本

> ID：14677923
> 
> 赞同：0
> 
> 时间：2013-02-03T22:12:19.167
> 
> 标签：vba

我在 ms-word 2007 中使用宏

我必须找到双字母。例如：苹果中的PP，访问中的cc和ss（来自“aa，bb，cc，dd，ee，ff，gg，hh，ii，jj，kk，ll，mm，nn，oo，pp，qq，rr ,ss,tt,uu,vv,ww,xx,yy,zz") 并将上述双字母字体格式化为比例 - 75% ,间距 - 扩展 ,By - 0.5pt

我有 vb 代码来突出显示双字母，但我没有代码来选择并将上述双字母字体格式化为比例 - 75%，间距 - 扩展，按 - 0.5pt

```
Sub Macro_test()
'
' Macro_alphabet Macro
'
'
Application.ScreenUpdating = False
Dim StrFnd As String, Rng As Range, i As Long
StrFnd = "aa,bb,cc,dd,ee,ff,gg,hh,ii,jj,kk,ll,mm,nn,oo,pp,qq,rr,ss,tt,uu,vv,ww,xx,yy,zz"
For i = 0 To UBound(Split(StrFnd, ","))
  Set Rng = ActiveDocument.Range
  With Rng.Find
    .ClearFormatting
    .text = Split(StrFnd, ",")(i)
    .Replacement.ClearFormatting
    .Replacement.Highlight = True
    .Replacement.text = "^&"
    .Forward = True
    .Wrap = wdFindContinue
    .Format = True
    .MatchCase = False
    .MatchWholeWord = False
    .MatchWildcards = False
    .MatchSoundsLike = False
    .MatchAllWordForms = False
    .Execute Replace:=wdReplaceAll
    Selection.Range.HighlightColorIndex = wdNoHighlight
  End With
Next
Set Rng = Nothing
Application.ScreenUpdating = True
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:35:18.103

正如 PeterL 所提到的，您可以只录制一个宏。

这是它的样子

```
 With Selection.Font
            .Spacing = 0.5
            .Scaling = 75
        End With 
```

您可能需要将 ths 稍微修改为“with rng.font”或类似内容以匹配您的选择方法。

# node.js - 为nodejs配置xampp

> ID：14677925
> 
> 赞同：0
> 
> 时间：2013-02-03T22:12:28.677
> 
> 标签：node.js

为什么我在 Apache Web 服务器上看到以下页面

显示页面的代码？

```
http://localhost/main.js 
```

我安装[Windows 安装程序](http://nodejs.org/#download)。

我正在运行命令提示符中编写的所有代码但是这段代码在浏览器中看不到

换句话说，

如何在浏览器中运行 nodejs 代码？

* * *

更新，

我的代码：

```
var http = require('http');
http.createServer(function (req, res) {
    res.writeHead(200, {
        'Content-Type': 'text/plain'
    });
    res.end('Hello World\n');
}).listen(1337, '127.0.0.1');
console.log('Server running at http://127.0.0.1:1337/'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:19:58.883

首先.. Apache 与节点无关。

通过运行启动 main.js 文件`node main.js`，然后导航到节点服务器正在运行的位置（假设 main.js 实际上创建了一个 Web 服务器）。检查 main.js 中的端口和主机名。应该是这样的：`http://localhost:8000`

# perl - Catalyst::Plugin::Authentication 更改用户名字段

> ID：14677929
> 
> 赞同：1
> 
> 时间：2013-02-03T22:12:58.337
> 
> 标签：perl, authentication, catalyst

我在我的[Catalyst应用程序中使用](http://www.catalystframework.org/)[Catalyst::Plugin::Authentication](https://metacpan.org/module/Catalyst::Plugin::Authentication)进行用户身份验证，并且我希望能够更改它在验证用户时使用的用户名字段（当前默认为用户名）。这是我目前的设置：

```
#used for user authentication 
__PACKAGE__->config(
    authentication => {
    default_realm => 'users',
    realms        => {
        users => {
            credential => {
               class          => 'Password',
               password_field => 'password',
               password_type  => 'self_check'
            },  
        store => {
           class         => 'DBIx::Class',
           user_model    => 'DB::User',
           role_relation => 'roles',
           role_field    => 'name',
        }   
      }
    }
  }    
); 
```

如您所见，有一个选项可以设置密码字段的名称，只需设置`password_field`. 我尝试使用与 相同的东西`username_field`，但它没有用。我查看了文档，但似乎找不到任何内容。有谁知道我可以做到这一点的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T14:39:54.020

[Catalyst::Authentication::Store::DBIx::Class](https://metacpan.org/module/Catalyst::Authentication::Store::DBIx::Class)人的引述：

> **id_field**
> 
> 在大多数情况下，不需要设置此配置变量，因为 Catalyst::Authentication::Store::DBIx::Class 将自行确定用户表的主键。如果您需要覆盖默认值，或者您的用户表有多个主键，那么 id_field 应该包含应该用于恢复用户的列名。此列中的给定值应对应于数据库中的单个用户。

所以你必须这样做：

```
store => {
           class         => 'DBIx::Class',
           user_model    => 'DB::User',
           role_relation => 'roles',
           role_field    => 'name',
           id_field      => 'name_of_user'  # A new name of column in your DB
        } 
```

比我必须使用用户的新列名调用身份验证方法：

```
$c->authenticate( { name_of_user => $user, password => $password } ); 
```

就这样！

# macos - 使用通配符在 .zshrc 中获取多个文件

> ID：14677936
> 
> 赞同：16
> 
> 时间：2013-02-03T22:13:57.423
> 
> 标签：macos, terminal, alias, zsh

我通过“oh my zsh”使用 z shell。我想从我的 .zshrc 文件中获取多个别名文件，以便让事情井井有条。我已经为别名文件添加了前缀，`.alias_`因此我可以通过通配符加载它们。但是，调用`source ~/.alias_*`只加载第一个文件。如何编写脚本以获取多个文件？

文件名示例： `.alias_git`, `.alias_local`, `.alias_server`...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-04T04:33:48.170

## 选项1

您可以使用 for 循环：

```
for file in ~/.alias_*; do
    source "$file"
done 
```

## 选项 2

另一种选择是构建一个包含您想要获取的所有文件的数组，然后使用 for 循环遍历该数组。

```
typeset -a aliases

aliases+="~/.alias_foo"
aliases+="~/.aliases_bar"
# etc...

for file in $aliases[@]; do
    if [[ -a "$file" ]]; then
        source "$file"
    fi
done 
```

这实际上可以非常有效地进行[组织良好的 zshrc 设置](https://github.com/seebi/zshrc/blob/master/zshrc)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T06:03:43.323

一种更加 ZSH 特定的方式（需要`setopt EXTENDED_GLOB`）：

```
alias_src=(
.alias_git
.alias_local
.alias_server
)
for f ($^alias_src(.N)) source $f
unset alias_src 
```

前缀`^`具有将后续 glob 修饰符分别应用于数组的每个元素的效果。

尾随`(.N)`具有以下效果：

*   `.`: 只匹配文件
*   `N`:temporary `setopt NULL_GLOB`，这意味着只有实际存在的数组元素保留在数组中

# c# - 将 WM_CLOSE 发送到 C# 应用程序意外工作

> ID：14677937
> 
> 赞同：2
> 
> 时间：2013-02-03T22:14:04.057
> 
> 标签：c#, c++, winapi, sendmessage

使用 WM_CLOSE 消息关闭 C# 应用程序时，我遇到了意外行为。在我的场景中，我需要确保 C# 应用程序在其 MSI 安装包运行时关闭。MSI 对此没有适当的操作，因此我正在编写一个自定义操作 DLL，该 DLL 嵌入到 MSI 包中并公开 EnsureApplicationClosed 函数。DLL相关代码如下：

```
#include "stdafx.h"
#include <iostream>
#include <vector>
#include <string>
#include "TlHelp32.h"

std::vector<DWORD> processesList;

//This method is the main point of interest
BOOL CALLBACK enumWindowsProc(__in HWND hWnd, __in LPARAM lParam)
{
    if(processesList.size()==0) return FALSE;
    DWORD processId;
    GetWindowThreadProcessId(hWnd, &processId);
    int index=0;
    while(index<processesList.size())
    {
        if(processesList.at(index)==processId)
        {
            //Remove process id from the list
            processesList.erase(processesList.begin()+index);
            //Should close main windows of the process found.
            SendMessage(hWnd, WM_CLOSE, (LPARAM)0, (WPARAM)0);
        }
        else
        {
            index++;
        }
    }
    return TRUE;
}
std::vector<DWORD> FindProcessesId(const LPCWSTR processName)
{
    std::vector<DWORD> result;

    PROCESSENTRY32 processInfo;
    processInfo.dwSize = sizeof(processInfo);

    HANDLE processesSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);
    if ( processesSnapshot == INVALID_HANDLE_VALUE ) return result;

    Process32First(processesSnapshot, &processInfo);
    if (wcscmp(processName, processInfo.szExeFile)==0)
    {
        result.push_back(processInfo.th32ProcessID);
    }

    while ( Process32Next(processesSnapshot, &processInfo) )
    {
        if ( wcscmp(processName, processInfo.szExeFile)==0 )
        {
            result.push_back(processInfo.th32ProcessID);
        }
    }

    CloseHandle(processesSnapshot);
    return result;
}
void InnerEnsureApplicationClosed(const LPCWSTR processName)
{
    processesList=FindProcessesId(processName);
    BOOL enumeratingWindowsSucceeded = ::EnumWindows( enumWindowsProc, NULL );
}
//Function exported by the DLL
UINT __stdcall EnsureApplicationClosed ( MSIHANDLE hModule )
{
    InnerEnsureApplicationClosed(L"SomeApplication.exe");
    return ERROR_SUCCESS;
} 
```

我正在使用简单的控制台应用程序来测试这个 dll：

```
#include "stdafx.h"
#include <SomeApplicationCustomActions.h>

int _tmain(int argc, _TCHAR* argv[])
{
    EnsureApplicationClosed(NULL);
    return 0;
} 
```

C# 应用程序在大多数情况下对用户是不可见的，因为它应该只显示来自第三方应用程序的通知。这就是它具有自定义 FormClosing 处理程序的原因：

```
private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
{
   Console.Beep();
   if (e.CloseReason != CloseReason.WindowsShutDown && e.CloseReason!= CloseReason.TaskManagerClosing)
   {
       e.Cancel = true;
       this.Hide();
   }
} 
```

我正在使用 SendMessage(hWnd, WM_CLOSE, (LPARAM)0, (WPARAM)0) 关闭 C# 应用程序。当收到此 WM_CLOSE 消息时，需要检查 TaskManagerClosing 关闭原因，因为我发现 SendMessage(hWnd, WM_CLOSE, (LPARAM)0, (WPARAM)0) 在 C# 应用程序中产生 TaskManagerClosing 关闭原因。Console.Beep() 用于测试以产生声音信号，因此我可以听到输入了处理程序代码。

这个问题只有在我第二次运行 DLL 测试应用程序时才有效。当我第一次运行测试应用程序时，我没有听到声音信号并且 C# 进程保留在任务管理器中。所以不会触发 C# 应用程序的 FormClosing 事件。我试图用 PostMessage 替换 SendMessage 但没有成功。GetLastError() 在这两种情况下总是返回 18。有没有人遇到过同样的问题并知道如何解决？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:22:56.040

玩了一整天后，我找到了发生此问题的原因。自定义动作 DLL 没问题。问题来自 .NET ListView 控件。如果表单的 Visible 属性在 Shown 事件处理程序中设置为 false，并且如果表单上有 ListView 控件，则它对第一次从另一个应用程序发送的 WM_CLOSE 消息免疫。WM_CLOSE 只是没有出现在 WndProc 方法中。我已经通过覆盖表单的 SetVisibleCore 来修复它，但无论如何这个问题看起来很奇怪，并且似乎是 .NET 中的一个错误。

# java - Spring Data JPA - 使用自定义 id / 主键保存新实体

> ID：14677939
> 
> 赞同：10
> 
> 时间：2013-02-03T22:14:13.517
> 
> 标签：java, spring, spring-data-jpa

简而言之，我的问题是如何使用 Spring data JPA 保存具有预设主键（而不是 null）的实体。

为了解释，考虑一个名为 的简单实体类`Customer`。请记住，id 没有设置为自动递增，它必须是自定义的唯一值。这只是一个小例子。我需要我的实际表中的 id 是自定义唯一的，比如用户名。

```
@Entity
@Table(name = "customer")
public class Customer implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @Basic(optional = false)
    @Column(name = "cust_id", nullable = false)
    private Integer custId;

    @Column(name = "first_name", length = 30)
    private String firstName;

    @Column(name = "last_name", length = 30)
    private String lastName;

    //getter, setters 
} 
```

而且，我有`CustomerRepository`一个

```
@Repository
public interface CustomerRepository extends JpaRepository<Customer, Integer> {
} 
```

现在，我想我必须插入一条 id 为 101 的新客户记录。预期的方式是：

```
Customer customer = new Customer();
customer.setCustId(101);
customer.setFirstName("Some");
customer.setLastName("Name");

repository.save(customer); 
```

但是，它`repository.save()`不会插入 id 为 101 的新客户。那么，我应该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T22:33:34.693

如果您处于活动事务中，请始终记住显式调用刷新或确保事务已提交，然后再独立检查数据库以确保已进行更改。

# bash - 给定两个目录，我怎么知道哪些子目录不同？

> ID：14677943
> 
> 赞同：0
> 
> 时间：2013-02-03T22:14:38.630
> 
> 标签：bash, directory, compare, diff, patch

我有两个目录，`directory`和`directory.original`. 我想知道哪些子目录不同以从每个不同的目录创建补丁而不是一个大补丁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:14:38.630

我发现这可能不是更优雅的方式，当您尝试修补一些源代码时效果很好：

```
diff -qr directory directory.original | cut -d' ' -f2 | xargs dirname | uniq 
```

让我们研究一下这段代码：

*   `diff -qr dir dir.original`: 将两个目录与​​简要标志 ( `-q`) 进行比较，这使得 diff 不会输出实际的 diff，而只是发布文件。这`-r`是使差异递归到其子目录中。

*   `cut -d' ' -f2`：的默认输出`diff -qr`是这样的：

    > `Files dir/file1 and dir.original/file1 differ`
    > 
    > `Files dir/sub-dir/file2 and dir.original/sub-dir/file2 differ`
    > 
    > `Files dir/sub-dir/file3 and dir.original/sub-dir/file3 differ`

    使用`cut`命令选择分隔符为空格 ( `-d' '`)，然后选择第二个字段，在本例中为`dir/file1`。

*   `xargs dirname`：为每个“行”运行`dirname`命令，以便您可以删除文件名。现在您有了`dir`, `dir/sub-dir`, `dir/sub-dir`（因为该子目录中有 2 个不同的文件）。

*   `uniq`: 如果有多个不同的（子）目录，只列出一个。

实际创建补丁时必须小心，记住不应该`-r`在根 ( `dir/`) 上使用标志，因为您将创建一个大补丁。

```
directories=$(diff -qr directory directory.original | cut -d' ' -f2 | xargs dirname | uniq)
for dir in $directories; do
  subdirectory=$(basename $dir)
  echo "+ $dir"
  diff -Naur directory.original/$subdirectory directory/$subdirectory > ${$subdirectory}.patch
done 
```

# javascript - Internet Explorer 不会在选择框中加载值

> ID：14677946
> 
> 赞同：1
> 
> 时间：2013-02-03T22:14:52.527
> 
> 标签：javascript, jquery, html, ajax

不知何故，IE 不会加载我使用 Ajax 更新的选择框中的值，但其他浏览器会这样做。

HTML：

```
<form id="auto_form" action="index.php?page=confirm_user" method="post">
    Year: 
        <select id="auto_year" name="auto_year">
            <option>Select option..</option>
%year%
        </select>
                    <br />
    <span id="auto_brand_title" style="display:none;">Brand:</span>
        <select id="auto_brand" style="display:none;" name="auto_brand" onchange="">
        </select>
                    <br />
    <span id="auto_model_title" style="display:none;">Model: </span>
        <select id="auto_model" style="display:none;" name="auto_model">
        </select>
                    <br />
            <!--Start extra choices-->
            <span id="auto_bodywork_title" style="display:none;">Bodywork: </span>
                <select id="auto_bodywork" style="display:none;" name="auto_bodywork">
                </select>
                            <br />
            <span id="auto_doors_title" style="display:none;">Doors: </span>
                <select id="auto_doors" style="display:none;" name="auto_doors">
                </select>
                            <br />
            <span id="auto_fuel_title" style="display:none;">Fuel: </span>
                <select id="auto_fuel" style="display:none;" name="auto_fuel">
                </select>
                            <br />
            <span id="auto_gearbox_title" style="display:none;">Gear Box: </span>
                <select id="auto_gearbox" style="display:none;" name="auto_gearbox">
                </select>
            <!--End extra choices-->
                    <br />
    <span id="auto_type_title" style="display:none;">Type: </span>
        <select id="auto_type" style="display:none;" name="auto_type">
        </select>
                    <br />
    <span id="auto_uitvoering_title" style="display:none;">Uitvoering: </span>
        <select id="auto_uitvoering" style="display:none;" name="auto_uitvoering">
        </select> 
```

jQuery：

```
 $("#auto_year").change(function(){
       updateField(this.value, 'auto_brand', 1, 2, this.parentNode.id), resetBelow(0,'auto'), show('auto_brand');
    });

    $("#auto_brand").change(function(){
       updateField(this.value, 'auto_model', 2, 3, this.parentNode.id), resetBelow(1,'auto'), show('auto_model');
    });

    $("#auto_model").change(function(){
       updateField(this.value, 'auto_bodywork', 3, 4, this.parentNode.id), resetBelow(2,'auto'), show('auto_bodywork');
    });

    $("#auto_bodywork").change(function(){
       updateField(this.value, 'auto_doors', 4, 5, this.parentNode.id), resetBelow(3,'auto'), show('auto_doors');
    });

    $("#auto_doors").change(function(){
       updateField(this.value, 'auto_fuel', 5, 6, this.parentNode.id), resetBelow(4,'auto'), show('auto_fuel');
    });

    $("#auto_fuel").change(function(){
       updateField(this.value, 'auto_gearbox', 6, 7, this.parentNode.id), resetBelow(5,'auto'), show('auto_gearbox');
    });

    $("#auto_gearbox").change(function(){
       updateField(this.value, 'auto_type', 7, 8, this.parentNode.id), resetBelow(6,'auto'), show('auto_type');
    });

    $("#auto_type").change(function(){
       updateField(this.value, 'auto_uitvoering', 8, 9, this.parentNode.id), resetBelow(7,'auto'), show('auto_uitvoering');
    });

    $("#auto_uitvoering").change(function(){
       updateField(this.value, '', 9, 10, this.parentNode.id), resetBelow(8,'auto');
    }); 
```

阿贾克斯功能：

```
function updateField(str, id, prevvalue, value, vehicletype)
{
if (str=="")
  {
  document.getElementById(id).innerHTML="";
  return;
  } 
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById(id).innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","inc/form_rest.php?q="+str+"&prevvalue="+prevvalue+"&value="+value+"&vehicletype="+vehicletype,true);
xmlhttp.send();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:29:54.820

在您的 .change() 调用中，尝试使用 $(this).val() 而不是 this.value。在 ie 中，事件是在窗口对象而不是实际元素本身上调用的，这会影响“this”的范围。$(this) 应该为你规范化 this，因为它现在是一个 jQuery 对象，你必须使用 jQuery 函数而不是原生 js 属性，因此需要 .val()。

另外，我强烈建议使用 $.ajax() 而不是自己尝试处理跨浏览器调用。使用 jQuery 的一半目的是克服跨浏览器的噩梦。如果您要在页面上加载它，请继续将您的所有脚本编写为 jQuery。

# eclipse - 如何在 Eclipse Joomla 开发项目中设置 EGit 以在 GitHub 上托管的第三方模块上工作？

> ID：14677947
> 
> 赞同：2
> 
> 时间：2013-02-03T22:14:54.630
> 
> 标签：eclipse, joomla, github, egit, eclipse-pdt

我是 Git/GitHub 的新手。我在新安装的 Joomla 实例上有一个 Eclipse Indigo Joomla 2.5 工作区。我可以启动一个 http 请求，在 Joomla 代码的某处设置断点，然后在调试会话中开始单步执行代码。所以，工作环境！

我想为托管在 GitHub 上的第三方 Joomla 模块做出贡献。如何从 GitHub 存储库克隆模块的代码并开始对其进行改进。如果可能的话，我还计划稍后从同一个工作区处理其他第三方模块或插件。

我关心的是：如何设置 EGit，以便我可以在同一个工作区中拥有多个独立的本地 Git 存储库，并独立地添加、分支、合并、推送它们？感谢您的回答 ！

让-皮埃尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T08:14:20.877

> 如何从 GitHub 存储库中克隆模块的代码并开始对其进行改进

您需要先[分叉它](https://help.github.com/articles/fork-a-repo)，然后[发出一些拉取请求](https://stackoverflow.com/a/14681796/6309)。

您可以在 Eclipse 工作区中添加每个存储库（请参阅[手动添加存储库](http://wiki.eclipse.org/EGit/User_Guide#Adding_a_Repository_manually)）。
但是，您需要管理分支并推送每个存储库。

我还建议为每个 repo 添加[原始上游 repo](https://stackoverflow.com/a/9257901/6309)的远程地址：

![上游回购](../Images/9562b234b89f08302e672cd3aa94f1f2.png)

这样，您可以轻松地将您的工作重新建立在您已分叉的最新原始 repo 之上。

# grails - 您使用动态 Groovy 功能 做什么？

> ID：14677955
> 
> 赞同：0
> 
> 时间：2013-02-03T22:16:18.553
> 
> 标签：grails, groovy

在开发 Grails 应用程序时，我没有进行任何元类编程或（明确地）利用 Groovy 的任何动态特性。我觉得我错过了。您能否举例说明您在 Grails 项目中何时/何时/如何使用 Groovy 的动态特性（您是否向域中添加方法，例如控制器）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T12:04:13.487

不是 Grails 项目，但我在 JBoss Seam 项目中工作了两年，其中包含大量 Groovy 代码。我们通常有一些服务类，其第一个参数方法通常是模型类。通过类别，它们变得真正面向对象：

```
class InvoiceService {
  static void sendToWs(Invoice invoice, wsEndpoint) {
    // neat stuff
  }

  static void validate(Invoice invoice) throws InvoiceValidationException {
    // more neat stuff
  }

  static InternationalInvoice buildInternationalInvoice(Invoice invoice) {
    // builds new object
  }
}

def invoice = new Invoice()

use(InvoiceService) {
  invoice.validate()
  invoice.sendToWs endpoint
} 
```

我相信这同样适用于 Grails。

我们还构建了很多位置文本文件，并且我们在类别下使用了很多 groovy 方法：

```
class PositionalFormatCategory {
  static String pad(String value, Integer times) {
    value.trim().padRight times, " "
  }
  static String pad(BigDecimal value, Integer times) {
    value.toString().padLeft times, " "
  }
} 
```

但是Groovy 在解析/编写XML 方面确实令人震惊。我们有一个模型类，必须转换为 4 种不同的 XML 格式

```
class XmlFormat1 {
  ServiceInvoice invoice

  String toXml() {
    new StreamingMarkupBuilder().bind {
      xml {
        price invoice.value
        date invoice.creationDate
        invoice.items.each { item ->
          invoiceItem {
            price item.price
            quantity item.qty
          }
        }
      }
    }
  }
} 
```

我们使用元编程来挂钩一个小的 lib 方法，该方法连接到一个可能已关闭的 rest 服务（我不记得 lib 名称）。我们使用它来定义超时，否则它会花一整天时间而不会失败：

```
def oldConnect = RestConn.metaClass.&connect
RestConn.metaClass.connect = {
  try {
    delegate.setTimeout 5000
    oldConnect()
  } catch (TimeoutException t) {
    throw new BusinessException("Timeout connecting to the server")
  }
} 
```

难以击败:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T10:48:36.297

我使用元编程功能使处理应用程序级别的事情变得更容易。

EG 我们有一个搜索引擎，它需要在创建/更新时对事物进行索引，并且还需要一些动态查找器方法来从索引中获取内容。

```
class SearchableClass {
    static searchable = ['foo']

    String foo
}
def searchService = [ search:{ Class clazz, Map opts, String query ->  // This would be a real service
    // doSearch
    query.collect { it }
} ]

def searchBindService = [ bindSearch:{ Class clazz ->  // This would be a real service
    clazz.metaClass.static.with {
        search = searchService.search.curry(clazz, [:])
        searchOne = { String q ->
            searchService.search(clazz, [:], q).take(1)
        }
    }
} ]

[SearchableClass, String, Map, List].findAll { // Only get things that have the 'searchable' static prop
    try {
        it.searchable != null
    }catch(e){ }
}.each searchBindService.bindSearch

assert ["q", "u", "e", "r", "y"] == SearchableClass.search('query')
assert ["q"] == SearchableClass.searchOne('query') 
```

# ruby-on-rails - Rails Relationship: Referencing the same table twice within a many-to-many relationship

> ID：14677957
> 
> 赞同：0
> 
> 时间：2013-02-03T22:16:24.547
> 
> 标签：ruby-on-rails, has-many-through, rails-activerecord, has-and-belongs-to-many

I'm pretty new to rails and trying to figure out relationships.

The data I'm trying to model is as follows: An Event is a gathering where people play games. An Event is recorded in multiple Videos. A Video contains multiple GameSets. A GameSet has two Players, player_one and player_two.

Because an Event has many Videos, and a Video has many GameSets, I feel like I should be able to declare a has_many :through relationship to get straight from an Event to GameSets. Also, I should be able to go straight from a player to all of the GameSets that he has participated in.

Here's what I have:

```
class Event < ActiveRecord::Base
  attr_accessible :event_date, :event_name, :event_number, :city, :state, :game_sets, :videos
  has_many :videos
  has_many :game_sets, :through => :videos
end

class Video < ActiveRecord::Base
  attr_accessible :name, :url, :event, :game_sets
  belongs_to :event
  has_many :game_sets
end

class GameSet < ActiveRecord::Base
  attr_accessible :player_one, :player_two, :video
  belongs_to :video
  has_one :player_one, :class_name => "Player"
  has_one :player_two, :class_name => "Player"
end

class Player < ActiveRecord::Base
  attr_accessible :first_name, :handle, :home_city, :home_state, :last_name, :tag
  has_and_belongs_to_many :game_sets
end 
```

But when I try to execute code like:

```
GameSet.find_by_id(1).player_one 
```

I get the following exception.

```
?[1m?[36mGameSet Load (0.0ms)?[0m  ?[1mSELECT "game_sets".* FROM "game_sets" WHERE "game_sets"."id" = 1 LIMIT 1?[0m  ?[1m?[35mPlayer Load (1.0ms)
?[0m  SELECT "players".* FROM "players" WHERE "players"."game_set_id" = 1 LIMIT 1SQLite3::SQLException: no such column: players.game_set_id: SELECT  "players".* FROM "players"  WHERE "players"."game_set_id" = 1 LIMIT 1ActiveRecord::StatementInvalid: SQLite3::SQLException: no such column: players.game_set_id: SELECT  "players".* FROM "players"  WHERE "players"."game_set_id"= 1 LIMIT 1 
```

I can't for the life of me figure out what it is I'm doing wrong. Any help is appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:21:21.207

Your relationships between GameSet and its players are wrong. Assuming you have two integer columns with the ids for player_one and player_two, the relationship should be belongs_to instead of has_one. Otherwise, it would mean that it's Player that has a game_set_id to link back to GameSet.

# javascript - 看似随机忽略行的功能

> ID：14677959
> 
> 赞同：1
> 
> 时间：2013-02-03T22:16:28.177
> 
> 标签：javascript, jquery

我正在研究一个`div`包含多个`article`元素的 html 结构。在按下按钮时，一些 jquery 从服务器获取新`article`元素的内容，将其替换为模板，并将其附加到`div`. 另一个函数删除所有元素，类`deletenext`获取顶部元素，选择`article:first`并将`deletenext`类添加到它 - 这个类隐藏在 css 中，但可以恢复。

这些与按键相关联。

该设置在没有 AJAX 部分的情况下完美运行 - 我可以通过从控制台调用函数或使用按键来滚动元素。当我只包括 AJAX 部分时，它也很有效。

`func1();func2`但是，当我从控制台或按键中同时使用调用 as 时，我遇到了问题 - 通常 ajax 只运行，并且 div 不断变长，但偶尔，看似随机的 delete 函数会删除几行。单独调用任一函数，或者从控制台调用都可以正常工作，只要不在同一运行中即可。顺序好像不重要，所以好像不是同步问题（`scrollDown`都是同步函数，应该没关系）

相关代码如下所示。

```
function scrollDown(callbackck) {
    $('article.deletenext:first').remove();
    $('.content article:first').addClass("deletenext");
};
function scrollUp() {
    $('.content article.deletenext').removeClass("deletenext");
}
function loadNext() {
    $.getJSON('test.json', function (data) {
        $('.content').append("<article><h1>" + data.title + "</h1><section class='articlecontent'>" + data.content + "<section></article>");
    });
};
$(document).bind('keydown', function(e) {
    if (e.keyCode == 75) {
        scrollUp();
    }
    else if (e.keyCode == 74) {
        scrollDown();
        loadNext();
    };
    return false;
}); 
```

# javascript - 向 Angular 指令提供数据（来自文件或数据库）

> ID：14677960
> 
> 赞同：1
> 
> 时间：2013-02-03T22:16:29.463
> 
> 标签：javascript, angularjs, angularjs-directive

我正在尝试确定正确的方式或 Angular 方式来为构建 DOM 的指令提供数据。作为我的示例，我正在尝试从文件中获取 JSON 数据以使用 jsTree 构建树。问题是在数据到达时而不是事先构建树。

`$watch`我已经通过在我的`treeData`控制器中解决了这个问题。如果我不这样做`$watch`，树将使用一个空数组作为输入来构造，稍后，Angular 将更新引用以填充数据。但我觉得这是错误的做法，因为在最初构建树后数据不会改变。

这是我的代码

应用程序.js：

```
var app = angular.module('jsTreeApp', ['ngResource']);

var TestCtrl = function($scope, Data) {
  $scope.treeData = Data.getTreeData();
}

app.directive('jstree', function() {
  return function(scope, element) {
    scope.$watch('treeData.data', function() {
      $(element).jstree({
        "json_data" : scope.treeData,
        "plugins" : [ "themes", "json_data" ]
      });
    })
  }
});

app.factory('Data', function($resource) {
  return $resource('/data/treeData.json', {}, {
    getTreeData: { method: 'GET', isArray: false }
  })
}) 
```

索引.html：

```
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>jsTreeAngular</title>
</head>
<body>

<div ng-controller="TestCtrl" ng-app="jsTreeApp">
  <div jstree></div>
</div>

<script src="lib/angular/angular.js"></script>
<script src="lib/angular/angular-resource.js"></script>
<script src="js/app.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script src="lib/jstree/jquery.jstree.js"></script>
</body>
</html> 
```

对正确的方法有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:27:37.460

我认为使用 $watch 没有问题，因为您绑定它，您需要一些方法来查看数据是否已填充并对其采取行动。

我在这里看到的问题是“treeData”的来源并不明显，这可能会使其他开发人员感到困惑。

相反，我要做的是定义一个隔离范围并使用 treeData 传递一个属性，这样您就可以保持松散耦合，而不必担心在控制器中更改“treeData”的名称。

您可以像这样定义隔离范围：

```
app.directive('jstree', function() {

  return {
      scope: {
             treeData: "="
             }, 
      link: function(scope, element) {
         scope.$watch('treeData.data', function() {
           $(element).jstree({
             "json_data" : scope.treeData,
             "plugins" : [ "themes", "json_data" ]
           });
         })
       }
    }
}); 
```

# iphone - ios应用程序中的公式如何创建它

> ID：14677962
> 
> 赞同：-3
> 
> 时间：2013-02-03T22:17:00.597
> 
> 标签：iphone, objective-c

拜托，我这里有这个公式：

```
=((r/100/12)*amt)/(1-((1+(r/100/12)^(-period))) 
```

有人可以帮助我如何将其转换为目标 c 的公式吗？我需要最终公式..

我用什么：

```
double int_ = ([Norma_value floatValue]/100)/12;
double months = -[kohezgjatja_value floatValue];
double r1 = pow(int_, months);
double pt1 = 1 + r1;
double pt2 = 1- pt1;

double pmt = ([shuma_value floatValue]* int_)/pt2;

balanca.text = [NSString stringWithFormat:@"%.02f €",pmt]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:23:59.750

您编写的公式应该在目标 c 中工作，除了`^`部分。

要`x ^ y`在目标 c 中实现，您可以使用：

```
pow(x,y) 
```

看看这个问题作为 pow 的参考：[How to raise a double value by power of 12?](https://stackoverflow.com/questions/1816055/how-to-raise-a-double-value-by-power-of-12)

# mysql - ssh & shell & mysql 中的条件命令

> ID：14677966
> 
> 赞同：2
> 
> 时间：2013-02-03T22:17:53.110
> 
> 标签：mysql, linux, bash, shell, unix

我在执行 a 的 shell 脚本中有以下命令`mysql dump`，然后通过 ssh 将该 SQL 文件加载到远程数据库中，然后更新时间戳。

```
1\. mysqldump -u root files path | gzip -9 > $SQL_FILE
2\. cat $SQL_FILE | ssh -i ~/metadata.pem ubuntu@1.2.3.4 
    "zcat | mysql -u 'root' -h 1.2.3.4 metadata"
3\. TIMESTAMP=`date "+%Y-%m-%d-%T"`
4\. mysql -u 'root' -h 1.2.3.4 metadata -e "UPDATE path_last_updated SET timestamp=DEFAULT" 
```

有什么办法可以改进上述命令。例如，如果第 2 行失败（例如，由于连接问题），但第 4 行成功，会发生什么情况？

我如何使第 4 行运行以第 2 行的成功为条件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:36:19.413

您可以将所有内容链接在一个块中：

```
mysqldump -u root files path |
    gzip -9 |
     ssh -i ~/metadata.pem ubuntu@1.2.3.4 "zcat |\
                   mysql -u 'root' -h 1.2.3.4 metadata"  &&
    mysql -u 'root' -h 1.2.3.4 metadata -e "
        UPDATE path_last_updated SET timestamp=DEFAULT" 
```

因此，如果之前出现故障，则不会执行最后一个 mysql 命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:24:39.767

可以`$?`用于获取最后一条命令的返回码，如果不为0，则失败。

或者您可以使用`&&`例如：`cmd1 && cmd2`。

`set -e`或者，如果发生错误，您可以使用停止脚本。

# javascript - 将 mp3 文件发送到 MVC3 应用程序并存储在 sql server 中

> ID：14677969
> 
> 赞同：0
> 
> 时间：2013-02-03T22:18:28.790
> 
> 标签：javascript, sql-server, asp.net-mvc-3, cordova

我有一个包含 mp3 文件的 PhoneGap 应用程序，我将它们的路径放在一个变量中——使用 JS

后端是使用 c# 的带有 SQL 服务器的 MVC3 应用程序

* * *

我的问题是如何使用 javascript 从我的应用程序将文件发送到后端，然后将其存储在 sql server 中？

我对使用 js 很陌生，非常感谢一些指导！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:21:03.840

您可以使用标准 HTML 表单在服务器上上传文件。我最近有[`answered a similar question`](https://stackoverflow.com/questions/14675185/upload-image-in-form-and-show-it-on-mvc-4/14675240#14675240)关于在 ASP.NET MVC 中上传文件。

如果您想在客户端上使用 javascript，您可以查看一些现有的 javascript 文件上传插件，例如[`Uploadify`](http://www.uploadify.com/)和[`Fine Uploader`](http://fineuploader.com/). 它们允许您提供额外的用户体验，例如显示上传文件进度。

就将上传的文件存储到 SQL 服务器而言，您可以在数据库中有一个`varbinary(max)`或[`FILESTREAM`](http://technet.microsoft.com/en-us/library/bb933993%28v=sql.105%29.aspx)列，您可以在其中存储上传的文件位。查询关系数据库可以使用普通的旧[`ADO.NET`](http://msdn.microsoft.com/en-us/library/e80y5yhx.aspx)框架或使用 ORM 框架来实现[`Entity Framework`](http://msdn.microsoft.com/en-US/data/ef)，例如。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:24:40.707

如果您想在客户端上使用 javascript，您可以查看一些可通过 Google 获得的 javascript 文件上传插件。

至于存储在数据库中，您可以将 MP3 数据本身存储在 varbinary(max) 或 FILESTREAM 字段中。

就我个人而言，我不会将它存储在文件系统中并将路径放入 varchar 字段中。通过这样做，它避免了通过数据库服务器获取所有数据的额外开销。然后代码可以只使用普通的文件 IO 方法。

# css - 在底部定位框上浮动文本

> ID：14677970
> 
> 赞同：0
> 
> 时间：2013-02-03T22:18:29.303
> 
> 标签：css, css-float

我想编写 html+css 代码以实现如附图所示的结果：![在此处输入图像描述](../Images/a6629eee3578b9dd492d54dcaf947cc1.png).

我的意思是带有文本和箭头框的编码部分。仅放置绝对位置不是答案，因为我需要文本围绕箭头框浮动。有没有办法做到这一点？

我已经尝试将各种浮点数放在带有文本的框和 paragraf 标记上。在 paragraf 标记之前、之后和中放置箭头框。还尝试在箭头框上使用垂直对齐和位置。

小提琴玩：http: [//jsfiddle.net/K2S5y/1/](http://jsfiddle.net/K2S5y/1/)

```
<div class="content">
<p>Lorem ipsum dolor sit amet enim. Etiam ullamcorper. Suspendisse a pellentesque dui, non felis. Maecenas males elit lectus felis, malesuada ultricies. Curabitur et ligula.</p>
<div class="arrowMore">arr</div>                
</div>

.content{width:170px;height:170px;border:1px solid red;}
.arrowMore{background:blue;width:70px;height:70px;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:38:44.757

使用 clear:both ex。

```
<div style="float:left; width:300px">
    <img/>
</div>

<div style="float:left; width:300px">
    Text text text
</div>

<div style="clear:both"></div> 
```

您可以在此处查看实时示例： [http ://webdesign.about.com/od/examples/l/bl-css-float-examples.htm#floating](http://webdesign.about.com/od/examples/l/bl-css-float-examples.htm#floating)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:46:21.883

```
#arrow {
  float: right;
}

/* then possibly  */
#arrow:after {
  content: ' ';
  display: block;
  clear: both;
} 
```

# javascript - Leaflet 中多个事件的单个事件处理程序

> ID：14677974
> 
> 赞同：9
> 
> 时间：2013-02-03T22:18:52.213
> 
> 标签：javascript, jquery, openstreetmap, leaflet

是否可以以这种方式为多个事件创建触发器？

```
map.on('click, dragstart, zoomstart', eventHandler); 
```

如果不是，为多个事件触发相同事件处理程序的下一个最佳方法是什么？

```
map.on('click', eventHandler);
map.on('dragstart', eventHandler);
map.on('zoomstart', eventHandler); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-03T22:23:20.383

有可能，只需删除逗号：

```
map.on('click dragstart zoomstart', eventHandler);

function eventHandler(e) {
    console.log(e.type); //shows event type, i.e. "click", "dragstart" etc.
} 
```

# objective-c - CARemoteLayer*/IOSurfaceRef + NSView

> ID：14677975
> 
> 赞同：1
> 
> 时间：2013-02-03T22:19:01.610
> 
> 标签：objective-c, cocoa, plugins, calayer, nsview

我正在构建一个基于视图的插件架构，其中我有一个单独的插件进程，并希望为每个插件分配一个`NSView`. 我已经研究过`CARemoteLayerServer/Client`和`IOSurfaceRef`使用，但它们都只允许一个绘图视图。一个插件的视图可能有很多子视图，并且可以像它是主应用程序的一部分一样接收事件。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T05:38:25.887

没有办法`NSView`直接跨流程边界进行交互。也就是说，`CARemoteLayerServer`支持层树，而不仅仅是单个层。这意味着您的 UI 肯定需要使用层来构建，但`NSView`在事件处理方面仍然很有用。

客户端和服务器都可以在它们自己的内部包含共享远程层，`NSViews`因为您可以创建一个层托管`NSView`并将共享层分配给它。然后`NSView`可以拦截鼠标和键盘事件，这些事件可以通过 XPC 连接传递给其他进程，以供其自己`NSView`（包含共享层）进行解释。我不完全确定这会有多快，因为我自己没有尝试过，但我认为它几乎与与普通视图交互一样即时。

如果您有兴趣更多地使用远程层，有一个很好的[示例项目](https://github.com/krevis/RemoteLayerDemo)以及随附的 SO[帖子](https://stackoverflow.com/questions/9293409/can-caremotelayerserver-and-caremotelayerclient-be-used-between-processes)，您可以查看

# android - 列表视图动画

> ID：14677977
> 
> 赞同：1
> 
> 时间：2013-02-03T22:19:21.593
> 
> 标签：android, listview, animation, android-listview, android-animation

我有一个类别的 ListView（主列表）。此列表中的每个类别都有一个子类别列表（多个级别）。单击任何主列表项时，将使用所选项目的子类别列表重新填充同一列表。我想将动画应用于此功能，即当单击主列表项时，列表将遍历到屏幕左侧，同时具有重新填充数据的相同列表从右侧进入。

那么谁能告诉我是否可以同时将两个不同的动画应用于同一个视图？

我能想到的解决方法之一是有一个虚拟列表并维护两个列表视图之间的数据。还有其他解决方法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:44:39.200

听起来您想在两个 ListView[片段](http://developer.android.com/guide/components/fragments.html)之间使用过渡动画。为此，请`setTransition()`在提交片段事务之前调用。

对相关问题的[回答](https://stackoverflow.com/questions/4932462/animate-the-transition-between-fragments)提供了更详细的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-05T17:45:33.877

这是创建 lisview 并在 listview 项目中添加动画的示例代码。请按照简单的步骤创建列表视图项目动画。第 1 步：创建列表视图，然后创建简单的 ArrayList 以在列表视图中设置，将值添加到 Arraylist。

```
ArrayList<String> items=new  ArrayList<>();
listView=(ListView)findViewById(R.id.listview);
for(int i=0;i<100;i++){
items.add("Item "+i);
} 
```

第 2 步：创建视图以使用 baseAdapter 将项目设置到列表视图中。

```
LayoutInflater inflater = getLayoutInflater();
view = inflater.inflate(R.layout.list_adapter, parent, false);
TextView itemName=(TextView)view.findViewById(R.id.itemName);
itemName.setText(items.get(position)); 
```

第三步：在 res 文件夹下创建 anim 文件夹，并添加需要的 .xml 文件。

第4步：最后，创建动画并在listview适配器视图中设置动画。

```
Animation animation = null;
animation = AnimationUtils.loadAnimation(getApplicationContext(), R.anim.wave);
animation.setDuration(200);
view.startAnimation(animation);
animation = null; 
```

更多详情请参考本站：http://velmuruganandroidcoding.blogspot.in/2014/08/listview-item-animation-in-android.html

# unity3d - 复合对撞机触发器

> ID：14677981
> 
> 赞同：0
> 
> 时间：2013-02-03T22:19:34.350
> 
> 标签：unity3d

我有一个父对象，它有四个子立方体。父级有刚体，没有碰撞器。四个立方体只有对撞机，触发标签设置为真。我想处理父对象中的冲突。但是，它没有用。我知道使用 onCollisionEnter 可能有效，但我必须使用触发器。有人可以给我一些想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-16T18:54:15.290

触发碰撞器无法使用 OnColliderEnter，因为物体会通过它们而不是碰撞。如果您希望检测对象何时进入触发对撞机，请改用 OnTriggerEnter。 [https://docs.unity3d.com/ScriptReference/Collider.OnTriggerEnter.html](https://docs.unity3d.com/ScriptReference/Collider.OnTriggerEnter.html)

但是，如果您希望保留触发器碰撞器并使其仅与特定类型的对象发生碰撞，则可以添加第二组不是触发器的碰撞器，并使用图层来区分哪些对象可以与它们碰撞以及哪些对象可以通过。然后你可以去 Edit->Project Settings->Physics 并在 Layer Collision Matrix 的底部配置哪些层可以相互碰撞。 [https://docs.unity3d.com/Manual/LayerBasedCollision.html](https://docs.unity3d.com/Manual/LayerBasedCollision.html)

# java - 如何在鼠标单击时将字符串绘制到小程序屏幕？

> ID：14677985
> 
> 赞同：-2
> 
> 时间：2013-02-03T22:20:15.350
> 
> 标签：java, applet, awt, java-2d, mouselistener

**编辑：**好的，所以我现在在朋友的帮助下设法让它工作。=)

* * *

我目前正在创建一个 Java 小程序。小程序的工作原理是从用户那里获取文本输入，并在他们按下回车键时将其显示到屏幕上。这是我的程序目前正在运行的点。我想知道是否有一种方法可以让我在点击鼠标时绘制文本输入/字符串，在鼠标点击点。

非常感谢任何可以帮助我的人。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T23:57:14.597

> 我想知道是否有一种方法可以让我在点击鼠标时绘制文本输入/字符串，在鼠标点击点。

答：是的……

我这样回答会不会很失礼……？

这是一个相对简单的过程，具体取决于您要实现的目标...

此示例仅用于`Graphics#drawString`将文本呈现给自定义组件。同样，您可以只在指定点的组件标签处，但这是另一个蠕虫罐头。

![在此处输入图像描述](../Images/1f62b0612bb2f26d334d06ce259b5b40.png)

```
public class TestDrawText {

    public static void main(String[] args) {
        new TestDrawText();
    }

    public TestDrawText() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class TestPane extends JPanel {

        private Point textPoint;

        public TestPane() {
            addMouseListener(new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    textPoint = e.getPoint();
                    repaint();
                }
            });
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g); 
            if (textPoint != null) {
                FontMetrics fm = g.getFontMetrics();
                g.drawString("You clicked at " + textPoint.x + "x" + textPoint.y, textPoint.x, textPoint.y + fm.getAscent());
            }
        }

    }

} 
```

查看

*   [如何编写鼠标监听器](http://docs.oracle.com/javase/tutorial/uiswing/events/mouselistener.html)
*   [执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)

了解更多信息。

# ffmpeg - 使用 ffmpeg 将 rtmp 流传输到 png

> ID：14677987
> 
> 赞同：1
> 
> 时间：2013-02-03T22:20:26.110
> 
> 标签：ffmpeg

我正在寻找一种解决方案，将来自 FMS/AMS 服务器的实时 rtmp 流转换为通过 http @5fps 的 png/jpeg 图像流。可能吗 。有人可以提出一个可靠的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:53:16.387

或许这

```
#!/bin/sh

foo=(
  'rtmp://server.com/app'
  'playpath=mp4:foo.mp4'
  'swfUrl=http://bar.com/baz.swf'
  'live=1'
)

ffmpeg -i "${foo[*]}" -r 1 a%d.png &

while sleep 1
do
  ls -I a.png | xargs -I % mv % a.png
done 
```

ffmpeg 将每秒输出一个数字 png ( `a1.png` `a2.png` `a3.png`)。`a.png`然后 Bash 将每秒复制最新的一个并删除其余的。这会给你一个不断更新的`a.png`。

# javascript - JSON 解析 Titanium.App.Properties 字符串

> ID：14677988
> 
> 赞同：0
> 
> 时间：2013-02-03T22:20:33.487
> 
> 标签：javascript, database, json, titanium

在应用程序中，使用 TideSDK 制作；我将一个全局变量（我知道很震惊）分配给存储在 Titanium.App.Properties 中的字符串的 JSON 解析：

```
var workbookArray = JSON.parse(Titanium.App.Properties.getString('workbookArray')); 
```

workbookArray 是一个对象数组。

然后在卸载页面时，我为 Titanium.App.Properties 字符串分配了 workbookArray 的值，该值可能已被使用该应用程序的人更改：

```
Titanium.App.Properties.setString('workbookArray', JSON.stringify(workbookArray)); 
```

但是，每次打开应用程序时，我都会被告知 JSON 无法解析第一个代码片段（初始化 workbookArray）。

除了这个问题，我不希望长期使用应用程序属性 API 来满足我的存储需求，我希望我可以将 indexedDB 与钛一起使用。SQL 是一种选择，但在涉及对象时有点混乱。对于数据库解决方案还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T13:04:00.870

尝试 getList 和 setList

[http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.App.Properties](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.App.Properties)

列表中存储了什么？

# c++ - 片段着色器在不同的计算机上执行不同

> ID：14677992
> 
> 赞同：1
> 
> 时间：2013-02-03T22:20:54.940
> 
> 标签：c++, opengl, graphics, glsl

当我在我的计算机上运行该程序时，它完全按照我的预期工作。但是，当我尝试在我的校园实验室计算机上运行它时，片段着色器是各种奇怪的。

现在它只是一个简单的 Phong 光照计算，在原点有一个点光源。然而，在实验室计算机上，它看起来更像是 cel shading 和手电筒之间的某种奇怪的结合。我运行 ATI 显卡，而实验室计算机运行 NVIDIA。阴影在 Mac 上也按预期工作（不知道显卡）。

NVIDIA 卡最高支持 OpenGL 3.1，尽管我在这个 Linux 发行版上以 2.1 运行它。我已经尝试将着色器版本限制为 1.2 (GLSL)，以及许多其他内容，但它们获得了相同的结果。最奇怪的是，当我进行顶点着色而不是像素着色时，两台计算机上的结果都是一样的……我已经用尽了关于如何解决这个问题的想法。

这是顶点着色器：

```
#version 120

  attribute vec2 aTexCoord;
  attribute vec3 aPosition;
  attribute vec3 aNormal;
  attribute vec3 camLoc;
  attribute float mat;

  varying vec3 vColor;
  varying vec2 vTexCoord;
  varying vec3 normals;
  varying vec3 lightPos;
  varying vec3 camPos;
  varying float material;

uniform mat4 uProjMatrix;
uniform mat4 uViewMatrix;
uniform mat4 uModelMatrix;
uniform mat4 uNormMatrix;

uniform vec3 uLight;
uniform vec3 uColor;

void main()
{
  //set up object position in world space
  vec4 vPosition = uModelMatrix * vec4(aPosition, 1.0);
  vPosition = uViewMatrix * vPosition;
  vPosition = uProjMatrix * vPosition;
  gl_Position = vPosition;

  //set up light vector in world space
  vec4 vLight = vec4(uLight, 1.0) * uViewMatrix;
  lightPos = vLight.xyz - vPosition.xyz;

  //set up normal vector in world space
  normals = (vec4(aNormal,1.0) * uNormMatrix).xyz;

  //set up view vector in world space
  camPos = camLoc.xyz - vPosition.xyz;

  //set up material shininess
  material = mat;

  //pass color and vertex
  vColor = uColor;
  vTexCoord = aTexCoord;
} 
```

和片段着色器：

```
#version 120

  varying vec3 lightPos;
  varying vec3 normals;
  varying vec3 camPos;
  varying vec2 vTexCoord;
  varying vec3 vColor;
  varying float material;

uniform sampler2D uTexUnit;

uniform mat4 uProjMatrix;
uniform mat4 uViewMatrix;
uniform mat4 uModelMatrix;

void main(void) 
{
  float diffuse;
  float diffuseRed, diffuseBlue, diffuseGreen;
  float specular;
  float specRed, specBlue, specGreen;
  vec3 lightColor = vec3(0.996, 0.412, 0.706); //color of light (HOT PINK) **UPDATE WHEN CHANGED**
  vec4 L; //light vector
  vec4 N; //normal vector
  vec4 V; //view vector
  vec4 R; //reflection vector
  vec4 H; //halfway vector
  float red;
  float green;
  float blue;
  vec4 texColor1 = texture2D(uTexUnit, vTexCoord);

      //diffuse calculations
        L = vec4(normalize(lightPos),0.0);
        N = vec4(normalize(normals),0.0);
        N = uModelMatrix * N;

        //calculate RGB of diffuse light
        diffuse = max(dot(N,L),0.0);
        diffuseRed = diffuse*lightColor[0];
        diffuseBlue = diffuse*lightColor[1];
        diffuseGreen = diffuse*lightColor[2];

      //specular calculations
        V = vec4(normalize(camPos),0.0);
        V = uModelMatrix * V;

        R = vec4(-1.0 * L.x, -1.0 * L.y, -1.0 * L.z, 0.0);
        float temp = 2.0*dot(L,N);
        vec3 tempR = vec3(temp * N.x, temp * N.y, temp * N.z);
        R = vec4(R.x + tempR.x, R.y + tempR.y, R.z + tempR.z, 0.0);
        R = normalize(R);

        H = normalize(L + V);

        specular = dot(H,R);
        specular = pow(specular,material);
        specRed = specular*lightColor[0];
        specBlue = specular*lightColor[1];
        specGreen = specular*lightColor[2];

      //set new colors
        //textures
        red = texColor1[0]*diffuseRed + texColor1[0]*specRed*0.7 + texColor1[0]*.05;
        green = texColor1[1]*diffuseBlue + texColor1[1]*specBlue*0.7 + texColor1[1]*.05;
        blue = texColor1[2]*diffuseGreen + texColor1[2]*specGreen*0.7 + texColor1[2]*.05;

        //colors
        red = vColor[0]*diffuseRed + vColor[0]*specRed*0.7 + vColor[0]*.05;
        green = vColor[1]*diffuseBlue + vColor[1]*specBlue*0.7 + vColor[1]*.05;
        blue = vColor[2]*diffuseGreen + vColor[2]*specGreen*0.7 + vColor[2]*.05;

      gl_FragColor = vec4(red, green, blue, 1.0);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T02:10:12.420

您的代码在很多很多方面看起来都是错误的。

下面的代码是错误的。该评论具有误导性（它在剪辑空间中，而不是世界空间中）。但是主要的问题是你`vPosition`在使用剪辑空间坐标时会覆盖它，就好像它在这部分之后几行的视图空间中一样。

```
//set up object position in world space
vec4 vPosition = uModelMatrix * vec4(aPosition, 1.0);
vPosition = uViewMatrix * vPosition;
vPosition = uProjMatrix * vPosition;
gl_Position = vPosition; 
```

下面的代码也是错误的。首先你需要`matrix * vector`，不是`vector * matrix`。而且，评论说*世界空间*，但您`vLight`在*视图空间*中计算并添加*剪辑空间*`vPosition`中的内容！

 *```
//set up light vector in world space
vec4 vLight = vec4(uLight, 1.0) * uViewMatrix;
lightPos = vLight.xyz - vPosition.xyz; 
```

再次在这里，`matrix * vector`：

```
//set up normal vector in world space
normals = (vec4(aNormal,1.0) * uNormMatrix).xyz; 
```

现在这是什么？`camPos`是在世界坐标中计算的，但是您应用将模型空间转换为世界空间的模型矩阵。

```
//specular calculations
V = vec4(normalize(camPos),0.0);
V = uModelMatrix * V; 
```

我不知道为什么你的着色器在不同的计算机上表现不同，但我很确定这些计算机中没有一个显示任何接近预期结果的东西。

你**真的**需要再次阅读你的着色器，每次你看到一个向量时，问问自己“这个向量在什么坐标空间中是有意义的？” 每次你看到一个矩阵时，问问自己“这个矩阵从什么坐标空间转换到什么坐标空间？”</p>*

# java - 如何创建具有两个键（键对、值）的 HashMap？

> ID：14677993
> 
> 赞同：132
> 
> 时间：2013-02-03T22:20:57.333
> 
> 标签：java, hash, hashmap, hashcode

我有一个二维整数数组。我希望将它们放入 HashMap 中。但我想根据数组索引访问 HashMap 中的元素。就像是：

对于 A[2][5]，`map.get(2,5)`它返回与该键关联的值。但是如何使用一对键创建一个 hashMap 呢？或者一般来说，多个键：`Map<((key1, key2,..,keyN), Value)`以我可以使用 get(key1,key2,...keyN) 访问元素的方式。

**编辑：发布问题 3 年后，我想添加更多内容**

我遇到了另一种方式`NxN matrix`。

数组索引，`i`并且可以通过以下方式`j`表示为单个：`key`

```
int key = i * N + j;
//map.put(key, a[i][j]); // queue.add(key); 
```

并且可以通过`key`以下方式检索索引：

```
int i = key / N;
int j = key % N; 
```

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2013-02-03T22:25:35.787

有几种选择：

# 2 维

## 地图地图

```
Map<Integer, Map<Integer, V>> map = //...
//...

map.get(2).get(5); 
```

## 包装键对象

```
public class Key {

    private final int x;
    private final int y;

    public Key(int x, int y) {
        this.x = x;
        this.y = y;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof Key)) return false;
        Key key = (Key) o;
        return x == key.x && y == key.y;
    }

    @Override
    public int hashCode() {
        int result = x;
        result = 31 * result + y;
        return result;
    }

} 
```

实施`equals()`和`hashCode()`在这里至关重要。然后你只需使用：

```
Map<Key, V> map = //... 
```

和：

```
map.get(new Key(2, 5)); 
```

## [`Table`](https://github.com/google/guava/wiki/NewCollectionTypesExplained#table)来自番石榴

```
Table<Integer, Integer, V> table = HashBasedTable.create();
//...

table.get(2, 5); 
```

`Table`使用下面*的地图*。

# N 维

请注意，特殊`Key`类是唯一可以扩展到 n 维的方法。您还可以考虑：

```
Map<List<Integer>, V> map = //... 
```

但从性能的角度来看，这很糟糕，可读性和正确性也很糟糕（没有简单的方法来强制执行列表大小）。

也许看看你有元组和类的Scala （用单行`case`替换整个类）。`Key`

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2014-11-17T21:02:29.990

当您创建自己的密钥对对象时，您应该面对一些事情。

首先，您应该了解实现`hashCode()`和`equals()`. 您将需要这样做。

其次，在实施时`hashCode()`，请确保您了解它是如何工作的。给定的用户示例

```
public int hashCode() {
    return this.x ^ this.y;
} 
```

实际上是您可以做的最糟糕的实现之一。原因很简单：你有很多相等的哈希值！并且`hashCode()`应该返回往往很少见的 int 值，最好是唯一的。使用这样的东西：

```
public int hashCode() {
  return (X << 16) + Y;
} 
```

这速度很快，并为 -2^16 和 2^16-1（-65536 到 65535）之间的键返回唯一的哈希值。这几乎适用于任何情况。很少你会超出这个界限。

第三，在实现时`equals()`还要知道它的用途并注意如何创建密钥，因为它们是对象。通常你会做不必要的 if 语句，因为你总是会得到相同的结果。

如果您像这样创建密钥：`map.put(new Key(x,y),V);`您将永远不会比较密钥的引用。因为每次您想要访问地图时，您都会执行类似`map.get(new Key(x,y));`. 因此，您`equals()`不需要像`if (this == obj)`. 它**永远不会**发生。

而不是`if (getClass() != obj.getClass())`在您`equals()`更好地使用`if (!(obj instanceof this))`. 它甚至对子类也有效。

所以你唯一需要比较的是X和Y。所以`equals()`在这种情况下最好的实现是：

```
public boolean equals (final Object O) {
  if (!(O instanceof Key)) return false;
  if (((Key) O).X != X) return false;
  if (((Key) O).Y != Y) return false;
  return true;
} 
```

所以最后你的关键类是这样的：

```
public class Key {

  public final int X;
  public final int Y;

  public Key(final int X, final int Y) {
    this.X = X;
    this.Y = Y;
  }

  public boolean equals (final Object O) {
    if (!(O instanceof Key)) return false;
    if (((Key) O).X != X) return false;
    if (((Key) O).Y != Y) return false;
    return true;
  }

  public int hashCode() {
    return (X << 16) + Y;
  }

} 
```

您可以提供维度索引`X`和`Y`公共访问级别，因为它们是最终的并且不包含敏感信息。我不能 100 %确定`private`在**将**`Object`.`Key`

如果你想知道决赛，我将任何东西声明为 final，它的值是在实例化时设置的并且永远不会改变 - 因此是一个对象常量。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-03T22:25:36.083

您不能拥有一个包含多个键的哈希映射，但您可以拥有一个以多个参数作为键的对象。

创建一个名为 Index 的对象，该对象采用 x 和 y 值。

```
public class Index {

    private int x;
    private int y;

    public Index(int x, int y) {
        this.x = x;
        this.y = y;
    }

    @Override
    public int hashCode() {
        return this.x ^ this.y;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        Index other = (Index) obj;
        if (x != other.x)
            return false;
        if (y != other.y)
            return false;
        return true;
    }
} 
```

然后让你`HashMap<Index, Value>`得到你的结果。:)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-11-25T08:33:41.917

在通用集合[MultiKeyMap中实现](https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/map/MultiKeyMap.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-03T22:24:10.717

两种可能。要么使用组合键：

```
class MyKey {
    int firstIndex;
    int secondIndex;
    // important: override hashCode() and equals()
} 
```

或地图地图：

```
Map<Integer, Map<Integer, Integer>> myMap; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-03T22:25:10.153

使用 a`Pair`作为 的键`HashMap`。JDK 没有 Pair，但您可以使用 3rd 方库，例如[http://commons.apache.org/lang](http://commons.apache.org/lang)或编写自己的 Pair taype。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-08-02T03:50:20.173

Java 7+ 包含一个新[`Map.Entry<K,V>`](https://docs.oracle.com/javase/7/docs/api/java/util/Map.Entry.html)类，您可以将其用作地图的键（或集合的条目）。它还包含一种`Map.entry(K k, V v)`轻松创建新`Map.Entry`对象的方法。

用法：

```
Map<Map.Entry<Integer,Integer>, Integer> map = new HashMap<>();
map.put(Map.entry(1, 2), 0); 
```

[`Pair<K, V>`](https://docs.oracle.com/javase/9/docs/api/javafx/util/Pair.html)javafx.util中也有

```
Map<Pair<Integer,Integer>, Integer> map = new HashMap<>();
map.put(new Pair(1, 2), 0); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-24T19:58:53.420

你可以像这样创建你的关键对象：

公共类 MapKey {

```
public  Object key1;
public Object key2;

public Object getKey1() {
    return key1;
}

public void setKey1(Object key1) {
    this.key1 = key1;
}

public Object getKey2() {
    return key2;
}

public void setKey2(Object key2) {
    this.key2 = key2;
}

public boolean equals(Object keyObject){

    if(keyObject==null)
        return false;

    if (keyObject.getClass()!= MapKey.class)
        return false;

    MapKey key = (MapKey)keyObject;

    if(key.key1!=null && this.key1==null)
        return false;

    if(key.key2 !=null && this.key2==null)
        return false;

    if(this.key1==null && key.key1 !=null)
        return false;

    if(this.key2==null && key.key2 !=null)
        return false;

    if(this.key1==null && key.key1==null && this.key2 !=null && key.key2 !=null)
        return this.key2.equals(key.key2);

    if(this.key2==null && key.key2==null && this.key1 !=null && key.key1 !=null)
        return this.key1.equals(key.key1);

    return (this.key1.equals(key.key1) && this.key2.equals(key2));
}

public int hashCode(){
    int key1HashCode=key1.hashCode();
    int key2HashCode=key2.hashCode();
    return key1HashCode >> 3 + key2HashCode << 5;
} 
```

}

这样做的好处是：它将始终确保您也涵盖了 Equals 的所有场景。

**注意**：您的 key1 和 key2 应该是不可变的。只有这样你才能构造一个稳定的关键对象。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-03T22:24:40.103

创建一个代表复合键的值类，例如：

```
class Index2D {
  int first, second;

  // overrides equals and hashCode properly here
} 
```

注意覆盖`equals()`和`hashCode()`正确。如果这看起来工作量很大，您可能会考虑一些现成的通用容器，例如`Pair`apache commons 等提供的。

这里也有许多[类似的问题](https://stackoverflow.com/q/6768963/149138)，还有其他想法，例如使用 Guava's [Table](http://docs.guava-libraries.googlecode.com/git-history/v14.0/javadoc/com/google/common/collect/Table.html)，尽管允许键具有不同的类型，在您的情况下这可能是过度的（在内存使用和复杂性方面），因为我知道您的键都是整数。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-02-03T22:29:54.210

如果它们是两个整数，您可以尝试一个快速而肮脏的技巧：`Map<String, ?>`将键用作`i+"#"+j`.

如果 key与try`i+"#"+j`相同。`j+"#"+i``min(i,j)+"#"+max(i,j)`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-05-25T13:33:49.987

我们可以创建一个类来传递多个键或值，并且该类的对象可以用作映射中的参数。

```
import java.io.BufferedReader; 
import java.io.FileReader;
import java.io.IOException;
import java.util.*;

 public class key1 {
    String b;
    String a;
    key1(String a,String b)
    {
        this.a=a;
        this.b=b;
    }
  }

public class read2 {

private static final String FILENAME = "E:/studies/JAVA/ReadFile_Project/nn.txt";

public static void main(String[] args) {

    BufferedReader br = null;
    FileReader fr = null;
    Map<key1,String> map=new HashMap<key1,String>();
    try {

        fr = new FileReader(FILENAME);
        br = new BufferedReader(fr);

        String sCurrentLine;

        br = new BufferedReader(new FileReader(FILENAME));

        while ((sCurrentLine = br.readLine()) != null) {
            String[] s1 = sCurrentLine.split(",");
            key1 k1 = new key1(s1[0],s1[2]);
            map.put(k1,s1[2]);
        }
        for(Map.Entry<key1,String> m:map.entrySet()){  
            key1 key = m.getKey();
            String s3 = m.getValue();
               System.out.println(key.a+","+key.b+" : "+s3);  
              }  
  //            }   
        } catch (IOException e) {

        e.printStackTrace();

    } finally {

        try {

            if (br != null)
                br.close();

            if (fr != null)
                fr.close();

        } catch (IOException ex) {

            ex.printStackTrace();

        }

    }

    }

 } 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-12-14T12:56:04.033

您也可以为此使用**guava Table**实现。

表表示一个特殊的映射，其中可以以组合方式指定两个键来引用单个值。它类似于创建地图的地图。

```
//create a table
  Table<String, String, String> employeeTable = HashBasedTable.create();

  //initialize the table with employee details
  employeeTable.put("IBM", "101","Mahesh");
  employeeTable.put("IBM", "102","Ramesh");
  employeeTable.put("IBM", "103","Suresh");

  employeeTable.put("Microsoft", "111","Sohan");
  employeeTable.put("Microsoft", "112","Mohan");
  employeeTable.put("Microsoft", "113","Rohan");

  employeeTable.put("TCS", "121","Ram");
  employeeTable.put("TCS", "122","Shyam");
  employeeTable.put("TCS", "123","Sunil");

  //get Map corresponding to IBM
  Map<String,String> ibmEmployees =  employeeTable.row("IBM"); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-08-20T09:30:51.647

您可以从以下链接下载它： [https ://github.com/VVS279/DoubleKeyHashMap/blob/master/src/com/virtualMark/doubleKeyHashMap/DoubleKeyHashMap.java](https://github.com/VVS279/DoubleKeyHashMap/blob/master/src/com/virtualMark/doubleKeyHashMap/DoubleKeyHashMap.java)

[https://github.com/VVS279/DoubleKeyHashMap](https://github.com/VVS279/DoubleKeyHashMap)

您可以使用双键：值哈希图，

```
 DoubleKeyHashMap<Integer, Integer, String> doubleKeyHashMap1 = new 
   DoubleKeyHashMap<Integer, Integer, String>();

   DoubleKeyHashMap<String, String, String> doubleKeyHashMap2 = new 
   DoubleKeyHashMap<String, String, String>(); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-12-21T19:59:49.540

使用 org.apache.commons.lang3.tuple.Pair 非常简单；

```
 Map<String, Pair<String, Integer>> map= new HashMap<>(); 
   map.put("key", Pair.of("a", 1)); 
   int value = map.get("key").getRight(); 
```

# c++ - std::function 与模板

> ID：14677997
> 
> 赞同：175
> 
> 时间：2013-02-03T22:21:08.420
> 
> 标签：c++, templates, c++11, std-function

感谢 C++11，我们收到了`std::function`函子包装系列。不幸的是，我一直只听到关于这些新增功能的坏消息。最受欢迎的是它们非常慢。我对其进行了测试，与模板相比，它们确实很糟糕。

```
#include <iostream>
#include <functional>
#include <string>
#include <chrono>

template <typename F>
float calc1(F f) { return -1.0f * f(3.3f) + 666.0f; }

float calc2(std::function<float(float)> f) { return -1.0f * f(3.3f) + 666.0f; }

int main() {
    using namespace std::chrono;

    const auto tp1 = system_clock::now();
    for (int i = 0; i < 1e8; ++i) {
        calc1([](float arg){ return arg * 0.5f; });
    }
    const auto tp2 = high_resolution_clock::now();

    const auto d = duration_cast<milliseconds>(tp2 - tp1);  
    std::cout << d.count() << std::endl;
    return 0;
} 
```

111 毫秒与 1241 毫秒。我认为这是因为模板可以很好地内联，而`function`s 通过虚拟调用覆盖内部。

正如我所见，模板显然存在问题：

*   它们必须作为标题提供，这不是您在将库作为封闭代码发布时可能不希望做的事情，
*   `extern template`除非引入类似策略，否则它们可能会使编译时间更长，
*   没有（至少我知道）表达模板需求（概念，任何人？）的干净方式，禁止评论描述预期的函子类型。

因此，我是否可以假设`function`s 可以用作传递函子的*事实上*的标准，并且在期望高性能的地方应该使用模板？

* * *

编辑：

*我的编译器是没有*CTP的 Visual Studio 2012 。

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2013-02-03T22:50:10.990

一般来说，如果您面临的*设计*情况让您有选择的余地，请**使用模板**。我强调了*设计*这个词，因为我认为你需要关注的是用例`std::function`和模板之间的区别，它们是非常不同的。

一般来说，模板的选择只是更广泛原则的一个实例：*尝试在编译时指定尽可能多的约束*。理由很简单：如果您可以在程序生成之前发现错误或类型不匹配，那么您就不会向您的客户发送有缺陷的程序。

此外，正如您正确指出的那样，对模板函数的调用是静态解析的（即在编译时），因此编译器具有优化并可能内联代码的所有必要信息（如果调用是通过虚表）。

是的，模板支持确实不完美，C++11 还缺乏对概念的支持；但是，我不知道如何`std::function`在这方面拯救你。`std::function`不是模板的替代品，而是用于无法使用模板的设计情况的工具。

**当您需要在运行时**通过调用遵循特定签名但其具体类型在编译时未知的可调用对象来解决调用时，就会出现一个这样的用例。当您有一组可能*不同类型*的回调，但您需要*统一调用*时，通常会出现这种情况；注册回调的类型和数量在运行时根据程序的状态和应用程序逻辑确定。其中一些回调可能是函子，一些可能是普通函数，一些可能是将其他函数绑定到某些参数的结果。

`std::function`并且`std::bind`还提供了一种在 C++ 中启用*函数式编程*的自然习惯用法，其中函数被视为对象并自然地柯里化并组合以生成其他函数。虽然这种组合也可以通过模板来实现，但类似的设计情况通常与需要在运行时确定组合可调用对象的类型的用例一起出现。

最后，还有其他情况`std::function`是不可避免的，例如，如果你想编写[递归 lambdas](https://stackoverflow.com/questions/14531993/can-lambda-functions-be-recursive/14532044#14532044)；然而，我认为这些限制更多是由技术限制决定的，而不是由概念上的区别决定的。

总而言之，**专注于设计**并尝试了解这两种结构的概念用例是什么。如果你以你所做的方式将它们进行比较，你就是在强迫他们进入一个他们可能不属于的领域。

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2013-02-22T01:42:58.903

Andy Prowl has nicely covered design issues. This is, of course, very important, but I believe the original question concerns more performance issues related to `std::function`.

First of all, a quick remark on the measurement technique: The 11ms obtained for `calc1` has no meaning at all. Indeed, looking at the generated assembly (or debugging the assembly code), one can see that VS2012's optimizer is clever enough to realize that the result of calling `calc1` is independent of the iteration and moves the call out of the loop:

```
for (int i = 0; i < 1e8; ++i) {
}
calc1([](float arg){ return arg * 0.5f; }); 
```

Furthermore, it realises that calling `calc1` has no visible effect and drops the call altogether. Therefore, the 111ms is the time that the empty loop takes to run. (I'm surprised that the optimizer has kept the loop.) So, be careful with time measurements in loops. This is not as simple as it might seem.

As it has been pointed out, the optimizer has more troubles to understand `std::function` and doesn't move the call out of the loop. So 1241ms is a fair measurement for `calc2`.

Notice that, `std::function` is able to store different types of callable objects. Hence, it must perform some type-erasure magic for the storage. Generally, this implies a dynamic memory allocation (by default through a call to `new`). It's well known that this is a quite costly operation.

The standard (20.8.11.2.1/5) encorages implementations to avoid the dynamic memory allocation for small objects which, thankfully, VS2012 does (in particular, for the original code).

To get an idea of how much slower it can get when memory allocation is involved, I've changed the lambda expression to capture three `float`s. This makes the callable object too big to apply the small object optimization:

```
float a, b, c; // never mind the values
// ...
calc2([a,b,c](float arg){ return arg * 0.5f; }); 
```

For this version, the time is approximately 16000ms (compared to 1241ms for the original code).

Finally, notice that the lifetime of the lambda encloses that of the `std::function`. In this case, rather than storing a copy of the lambda, `std::function` could store a "reference" to it. By "reference" I mean a `std::reference_wrapper` which is easily build by functions `std::ref` and `std::cref`. More precisely, by using:

```
auto func = [a,b,c](float arg){ return arg * 0.5f; };
calc2(std::cref(func)); 
```

the time decreases to approximately 1860ms.

I wrote about that a while ago:

[http://www.drdobbs.com/cpp/efficient-use-of-lambda-expressions-and/232500059](http://www.drdobbs.com/cpp/efficient-use-of-lambda-expressions-and/232500059)

As I said in the article, the arguments don't quite apply for VS2010 due to its poor support to C++11\. At the time of the writing, only a beta version of VS2012 was available but its support for C++11 was already good enough for this matter.

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-02-23T20:17:07.117

## 使用 Clang，两者之间没有性能差异

使用 clang (3.2, trunk 166872)（Linux 上的 -O2），**这两种情况的二进制文件实际上是相同的**。

-我会在帖子结束时回来clang。但首先，gcc 4.7.2：

已经有很多见解了，但我想指出，由于内联等原因，calc1 和 calc2 的计算结果不一样。例如比较所有结果的总和：

```
float result=0;
for (int i = 0; i < 1e8; ++i) {
  result+=calc2([](float arg){ return arg * 0.5f; });
} 
```

用 calc2 变成

```
1.71799e+10, time spent 0.14 sec 
```

而使用 calc1 它变成

```
6.6435e+10, time spent 5.772 sec 
```

这是速度差异的约 40 倍，值的约 4 倍。第一个差异比 OP 发布的内容（使用 Visual Studio）大得多。实际上打印出结尾的值也是一个好主意，以防止编译器删除没有可见结果的代码（as-if 规则）。Cassio Neri 在他的回答中已经说过了。注意结果有多么不同——在比较执行不同计算的代码的速度因子时应该小心。

**此外，公平地说，比较重复计算 f(3.3) 的各种方法可能并不那么有趣。如果输入是恒定的，则不应处于循环中。（优化器很容易注意到）**

如果我向 calc1 和 2 添加用户提供的值参数，则 calc1 和 calc2 之间的速度因子从 40 下降到 5！使用 Visual Studio，差异接近 2 倍，而使用 clang 则没有差异（见下文）。

此外，由于乘法速度很快，因此谈论减速因素通常不是那么有趣。一个更有趣的问题是，你的函数有多小，这些调用是实际程序中的瓶颈吗？

## 铛：

当我在示例代码的 calc1 和 calc2 之间切换时，Clang（我使用 3.2）实际上生成了*相同的二进制文件（发布在下面）。*对于问题中发布的原始示例，两者也是相同的，但根本不需要时间（如上所述，循环只是完全删除）。在我修改后的示例中，使用 -O2：

执行的秒数（最好的 3 秒）：

```
clang:        calc1:           1.4 seconds
clang:        calc2:           1.4 seconds (identical binary)

gcc 4.7.2:    calc1:           1.1 seconds
gcc 4.7.2:    calc2:           6.0 seconds

VS2012 CTPNov calc1:           0.8 seconds 
VS2012 CTPNov calc2:           2.0 seconds 

VS2015 (14.0.23.107) calc1:    1.1 seconds 
VS2015 (14.0.23.107) calc2:    1.5 seconds 

MinGW (4.7.2) calc1:           0.9 seconds
MinGW (4.7.2) calc2:          20.5 seconds 
```

所有二进制文件的计算结果都是相同的，并且所有测试都在同一台机器上执行。如果有更深入的 clang 或 VS 知识的人可以评论可能已经完成的优化，那将会很有趣。

## 我修改后的测试代码：

```
#include <functional>
#include <chrono>
#include <iostream>

template <typename F>
float calc1(F f, float x) { 
  return 1.0f + 0.002*x+f(x*1.223) ; 
}

float calc2(std::function<float(float)> f,float x) { 
  return 1.0f + 0.002*x+f(x*1.223) ; 
}

int main() {
    using namespace std::chrono;

    const auto tp1 = high_resolution_clock::now();

    float result=0;
    for (int i = 0; i < 1e8; ++i) {
      result=calc1([](float arg){ 
          return arg * 0.5f; 
        },result);
    }
    const auto tp2 = high_resolution_clock::now();

    const auto d = duration_cast<milliseconds>(tp2 - tp1);  
    std::cout << d.count() << std::endl;
    std::cout << result<< std::endl;
    return 0;
} 
```

**更新：**

添加了vs2015。我还注意到在 calc1,calc2 中有 double->float 转换。删除它们并不会改变 Visual Studio 的结论（两者都快得多，但比例大致相同）。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-02-03T22:50:01.050

不同不一样。

它比较慢，因为它做了模板不能做的事情。特别是，它允许您调用可以使用给定参数类型调用的**任何**函数，并且其返回类型可以**从相同的代码**转换为给定的返回类型。

```
void eval(const std::function<int(int)>& f) {
    std::cout << f(3);
}

int f1(int i) {
    return i;
}

float f2(double d) {
    return d;
}

int main() {
    std::function<int(int)> fun(f1);
    eval(fun);
    fun = f2;
    eval(fun);
    return 0;
} 
```

请注意，**相同**的函数对象`fun`被传递给对 的两个调用`eval`。它具有两种**不同的**功能。

如果您不需要这样做，那么您不**应该**使用`std::function`.

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-02-21T19:46:31.890

您在这里已经有了一些很好的答案，所以我不会反驳它们，简而言之，将 std::function 与模板进行比较就像将虚函数与函数进行比较。您永远不应该“更喜欢”虚函数而不是函数，而是在适合问题时使用虚函数，将决策从编译时转移到运行时。这个想法是，您不必使用定制的解决方案（如跳转表）来解决问题，而是使用能让编译器更好地为您优化的东西。如果您使用标准解决方案，它还可以帮助其他程序员。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-03-05T01:42:09.703

该答案旨在为现有答案集做出贡献，我认为这是对 std::function 调用的运行时成本更有意义的基准。

应该识别 std::function 机制提供的内容：任何可调用实体都可以转换为具有适当签名的 std::function。假设您有一个库，该库将曲面拟合到由 z = f(x,y) 定义的函数，您可以将其编写为接受 a `std::function<double(double,double)>`，并且库的用户可以轻松地将任何可调用实体转换为该函数；无论是普通函数、类实例的方法、lambda，还是 std::bind 支持的任何东西。

与模板方法不同，这无需针对不同情况重新编译库函数即可工作；因此，对于每个额外的情况，几乎不需要额外的编译代码。实现这一点一直是可能的，但它过去需要一些笨拙的机制，并且库的用户可能需要围绕他们的函数构建一个适配器才能使其工作。std::function 自动构造所需的任何适配器，以获得所有情况下的公共*运行时*调用接口，这是一个非常强大的新功能。

在我看来，就性能而言，这是 std::function 最重要的用例：我对在构造一次 std::function 后多次调用它的成本感兴趣，它需要是编译器无法通过知道实际调用的函数来优化调用的情况（即，您需要将实现隐藏在另一个源文件中以获得正确的基准）。

我在下面进行了测试，类似于 OP；但主要变化是：

1.  每个 case 循环 10 亿次，但 std::function 对象只构造一次。通过查看输出代码，我发现在构造实际的 std::function 调用时调用了“operator new”（可能不是在优化它们时）。
2.  测试被分成两个文件以防止不希望的优化
3.  我的情况是： (a) 函数是内联的 (b) 函数由普通函数指针传递 (c) 函数是包装为 std::function 的兼容函数 (d) 函数是与 std:: 兼容的不兼容函数绑定，包装为 std::function

我得到的结果是：

*   案例（a）（内联）1.3 nsec

*   所有其他情况：3.3 纳秒。

情况 (d) 往往会稍微慢一些，但差异（大约 0.05 纳秒）被噪声吸收了。

结论是 std::function 与使用函数指针的开销（在调用时）相当，即使对实际函数进行了简单的“绑定”调整。内联比其他方法快 2 ns，但这是一个预期的权衡，因为内联是唯一在运行时“硬连线”的情况。

当我在同一台机器上运行 johan-lundberg 的代码时，我看到每个循环大约 39 纳秒，但那里的循环还有很多，包括 std::function 的实际构造函数和析构函数，这可能相当高因为它涉及新建和删除。

-O2 gcc 4.8.1，到 x86_64 目标（核心 i5）。

请注意，代码被分成两个文件，以防止编译器在调用它们的地方扩展函数（除了打算这样做的一种情况）。

----- 第一个源文件 --------------

```
#include <functional>

// simple funct
float func_half( float x ) { return x * 0.5; }

// func we can bind
float mul_by( float x, float scale ) { return x * scale; }

//
// func to call another func a zillion times.
//
float test_stdfunc( std::function<float(float)> const & func, int nloops ) {
    float x = 1.0;
    float y = 0.0;
    for(int i =0; i < nloops; i++ ){
        y += x;
        x = func(x);
    }
    return y;
}

// same thing with a function pointer
float test_funcptr( float (*func)(float), int nloops ) {
    float x = 1.0;
    float y = 0.0;
    for(int i =0; i < nloops; i++ ){
        y += x;
        x = func(x);
    }
    return y;
}

// same thing with inline function
float test_inline(  int nloops ) {
    float x = 1.0;
    float y = 0.0;
    for(int i =0; i < nloops; i++ ){
        y += x;
        x = func_half(x);
    }
    return y;
} 
```

----- 第二个源文件 -------------

```
#include <iostream>
#include <functional>
#include <chrono>

extern float func_half( float x );
extern float mul_by( float x, float scale );
extern float test_inline(  int nloops );
extern float test_stdfunc( std::function<float(float)> const & func, int nloops );
extern float test_funcptr( float (*func)(float), int nloops );

int main() {
    using namespace std::chrono;

    for(int icase = 0; icase < 4; icase ++ ){
        const auto tp1 = system_clock::now();

        float result;
        switch( icase ){
         case 0:
            result = test_inline( 1e9);
            break;
         case 1:
            result = test_funcptr( func_half, 1e9);
            break;
         case 2:
            result = test_stdfunc( func_half, 1e9);
            break;
         case 3:
            result = test_stdfunc( std::bind( mul_by, std::placeholders::_1, 0.5), 1e9);
            break;
        }
        const auto tp2 = high_resolution_clock::now();

        const auto d = duration_cast<milliseconds>(tp2 - tp1);  
        std::cout << d.count() << std::endl;
        std::cout << result<< std::endl;
    }
    return 0;
} 
```

对于那些感兴趣的人，这里是编译器为使“mul_by”看起来像一个 float(float) 而构建的适配器 - 当调用创建为 bind(mul_by,_1,0.5) 的函数时，这是“调用”的：

```
movq    (%rdi), %rax                ; get the std::func data
movsd   8(%rax), %xmm1              ; get the bound value (0.5)
movq    (%rax), %rdx                ; get the function to call (mul_by)
cvtpd2ps    %xmm1, %xmm1        ; convert 0.5 to 0.5f
jmp *%rdx                       ; jump to the func 
```

（所以如果我在绑定中写了 0.5f 可能会快一点...）请注意，'x' 参数到达 %xmm0 并停留在那里。

这是在调用 test_stdfunc 之前构造函数的区域中的代码 - 通过 c++filt 运行：

```
movl    $16, %edi
movq    $0, 32(%rsp)
call    operator new(unsigned long)      ; get 16 bytes for std::function
movsd   .LC0(%rip), %xmm1                ; get 0.5
leaq    16(%rsp), %rdi                   ; (1st parm to test_stdfunc) 
movq    mul_by(float, float), (%rax)     ; store &mul_by  in std::function
movl    $1000000000, %esi                ; (2nd parm to test_stdfunc)
movsd   %xmm1, 8(%rax)                   ; store 0.5 in std::function
movq    %rax, 16(%rsp)                   ; save ptr to allocated mem

   ;; the next two ops store pointers to generated code related to the std::function.
   ;; the first one points to the adaptor I showed above.

movq    std::_Function_handler<float (float), std::_Bind<float (*(std::_Placeholder<1>, double))(float, float)> >::_M_invoke(std::_Any_data const&, float), 40(%rsp)
movq    std::_Function_base::_Base_manager<std::_Bind<float (*(std::_Placeholder<1>, double))(float, float)> >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation), 32(%rsp)

call    test_stdfunc(std::function<float (float)> const&, int) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-08-18T03:59:48.653

我发现您的结果非常有趣，因此我进行了一些挖掘以了解发生了什么。首先，正如许多其他人所说，如果没有计算结果影响程序的状态，编译器只会优化它。其次，有一个常数 3.3 作为回调的武器，我怀疑还会有其他优化。考虑到这一点，我稍微更改了您的基准代码。

```
template <typename F>
float calc1(F f, float i) { return -1.0f * f(i) + 666.0f; }
float calc2(std::function<float(float)> f, float i) { return -1.0f * f(i) + 666.0f; }
int main() {
    const auto tp1 = system_clock::now();
    for (int i = 0; i < 1e8; ++i) {
        t += calc2([&](float arg){ return arg * 0.5f + t; }, i);
    }
    const auto tp2 = high_resolution_clock::now();
} 
```

鉴于我使用 gcc 4.8 -O3 编译的代码的这种更改，并且 calc1 的时间为 330ms，calc2 的时间为 2702。所以使用模板快了 8 倍，这个数字在我看来是可疑的，8 的幂的速度通常表明编译器已经向量化了一些东西。当我查看为模板版本生成的代码时，它显然是矢量化的

```
.L34:
cvtsi2ss        %edx, %xmm0
addl    $1, %edx
movaps  %xmm3, %xmm5
mulss   %xmm4, %xmm0
addss   %xmm1, %xmm0
subss   %xmm0, %xmm5
movaps  %xmm5, %xmm0
addss   %xmm1, %xmm0
cvtsi2sd        %edx, %xmm1
ucomisd %xmm1, %xmm2
ja      .L37
movss   %xmm0, 16(%rsp) 
```

std::function 版本不是。这对我来说很有意义，因为使用模板，编译器肯定知道函数在整个循环中永远不会改变，但是传入的 std::function 可能会改变，因此不能向量化。

这导致我尝试其他方法，看看是否可以让编译器在 std::function 版本上执行相同的优化。我没有传入函数，而是将 std::function 作为全局变量，并调用它。

```
float calc3(float i) {  return -1.0f * f2(i) + 666.0f; }
std::function<float(float)> f2 = [](float arg){ return arg * 0.5f; };

int main() {
    const auto tp1 = system_clock::now();
    for (int i = 0; i < 1e8; ++i) {
        t += calc3([&](float arg){ return arg * 0.5f + t; }, i);
    }
    const auto tp2 = high_resolution_clock::now();
} 
```

在这个版本中，我们看到编译器现在以相同的方式对代码进行了矢量化，我得到了相同的基准测试结果。

*   模板：330ms
*   标准::函数：2702ms
*   全局 std::function: 330ms

所以我的结论是 std::function 与模板仿函数的原始速度几乎相同。然而，它使优化器的工作变得更加困难。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-06-01T23:30:56.560

如果您使用**模板**而不是`std::function`在**C++20**中，您实际上可以使用可变参数模板编写自己的**概念**（[受 Hendrik Niemeyer 关于 C++20 概念的讨论的启发](https://www.youtube.com/watch?v=N_kPd2OK1L8)）：

```
template<class Func, typename Ret, typename... Args>
concept functor = std::regular_invocable<Func, Args...> && 
                  std::same_as<std::invoke_result_t<Func, Args...>, Ret>; 
```

然后，您可以将其用作**`functor<Ret, Args...> F>`**返回`Ret`值和`Args...`可变参数输入参数的位置。比如`functor<double,int> F`比如

```
template <functor<double,int> F>
auto CalculateSomething(F&& f, int const arg) {
  return f(arg)*f(arg);
} 
```

需要一个仿函数作为模板参数，该参数必须重载`()`运算符，并具有`double`返回值和一个类型的输入参数`int`。类似`functor<double>`的还有一个返回类型的函子，`double`它不接受任何输入参数。

[在这里试试！](https://wandbox.org/permlink/sxIRBBSFqgML5ezq)

您还可以将它与**可变参数函数**一起使用，例如

```
template <typename... Args, functor<double, Args...> F>
auto CalculateSomething(F&& f, Args... args) {
  return f(args...)*f(args...);
} 
```

[在这里试试！](https://wandbox.org/permlink/59Vxa8o6EQwNTatY)